VERSION E05

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:1    
        1        1        /*M* DDA$UPDATE - UPDATE DO ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME:  DDA$UPDATE
       10       10             PURPOSE:  UPDATE BREAKPOINTS AND ATTACHMENTS             */
       11       11        /*D* NAME:  DDA$UPDATE
       12       12             CALL:  CALL DDA$UPDATE ALTRET(ERROR);
       13       13             INPUT: S_D.DO$ POINTS TO UPDATE FRAME
       14       14             DESCRIPTION:  DOES UPDATE OF BREAKPOINTS AND ATTACHMENTS */
       15       15
       16       16        DDA$UPDATE: PROC ALTRET;
       17       17
       18       18        /* Includes */
       19       19        %INCLUDE CP_6;
       20      100        %INCLUDE XUH_MACRO_C;
       21      184        %INCLUDE DD_SD_M;
       22     1520        %S_D;
       23     2838        %INCLUDE DD_ERR_C;
       24     3235        %INCLUDE DD_PSUBS_C;
       25     3710        %INCLUDE DD_SUBS_C;
       26     3981        %INCLUDE DD$BASED;
       27     5284        %UPDATE$CMD(STCLASS="BASED(DO$)");
       28     5299        %FIXCOM(NAME="F$XCM");
       29     5315        %FIXCOM(NAME="SAVE_FIXCOM",STCLASS=AUTO);
       30     5331        %AT_FIRST;
       31     5359        %F$DCB;
       32     5416
       33     5417        /* Local auto */
       34     5418    1   DCL DO$ PTR;
       35     5419    1   DCL SCMD$ PTR;
       36     5420    1   DCL BUF$ PTR;
       37     5421    1   DCL M$DELT$ PTR;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:2    
       38     5422    1   DCL TEXT$ PTR;
       39     5423    1   DCL FATT$ PTR;
       40     5424    1   DCL SCMD_TEXT$ PTR;
       41     5425    1   DCL NO_OF_ATTACHMENTS UBIN;
       42     5426    1   DCL SIZE UBIN;
       43     5427    1   DCL ATTACH_SIZE UBIN;
       44     5428    1   DCL SIZE_READ SBIN;
       45     5429    1   DCL IX UBIN;
       46     5430    1   DCL SCMD_SIZE UBIN;
       47     5431    1   DCL SAVE_SCMD_SIZE UBIN;
       48     5432    1   DCL SCMD_NO UBIN;
       49     5433    1   DCL ATTACHMENT_NO UBIN;
       50     5434    1   DCL CONTINUE BIT(1) ALIGNED;
       51     5435    1   DCL SET_ATTACH BIT(1) ALIGNED;
       52     5436    1   DCL ACT_CHAR CHAR(1) ALIGNED;
       53     5437    1   DCL SCMD$CHAR CHAR(2) CALIGNED;
       54     5438    1   DCL SAVE_SCMD_TEXT CHAR(260) CALIGNED;
       55     5439    1   DCL SAVE_VARCOM(0:100) UBIN WORD ALIGNED;
       56     5440    1   DCL SAVE_VARCOM_SIZE UBIN;
       57     5441    1   DCL CCMD UBIN;
       58     5442    1   DCL FPRG BIT(1) ALIGNED;
       59     5443
       60     5444        /* Based */
       61     5445    1   DCL BUFF$ER CHAR(SIZE) BASED(BUF$);
       62     5446    1   DCL 1 TEXT$C BASED(TEXT$),
       63     5447    1         2 SIZE UBIN(9) UNAL,
       64     5448    1         2 TEXT CHAR(TEXT$C.SIZE);
       65     5449    1   DCL SCMD$TEXT CHAR(SCMD_SIZE) BASED(SCMD_TEXT$);
       66     5450
       67     5451        /* Symref */
       68     5452    1   DCL D_M$DELT# UBIN SYMREF;
       69     5453        /* Fpt's - auto */
       70     5454        %FPT_READ(FPTN=FPTREAD,
       71     5455                  STCLASS=);
       72     5494        %FPT_SINPUT(FPTN=FPTSINPUT,
       73     5495                    STCLASS=);
       74     5532
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:3    
       75     5533        /* Constant */
       76     5534        %FPT_READ(FPTN=FPT_READ,
       77     5535                  STCLASS=CONSTANT);
       78     5574        %FPT_SINPUT(FPTN=FPT_SINPUT,
       79     5575                    STCLASS=CONSTANT);
       80     5612    1   DCL ACTABL (0:2) CHAR(1) UNAL CONSTANT
       81     5613    1        INIT( /* Type 0 */ BITASC('015'O), /* C/r */
       82     5614    1              /* Type 1 */ BITASC('012'O), /* L/f */
       83     5615    1                    /* Type 2 */ '^' );
       84     5616    1   DCL ACHARS REDEF ACTABL CHAR(3);
       85     5617
       86     5618        /* External routines */
       87     5619    1   DCL DDA$KILL1 ENTRY;
       88     5620    1   DCL DDA$SHOW1 ENTRY(2);
       89     5621    1   DCL DDQ$WRITE ENTRY(2);
       90     5622    1   DCL DDS$SCAN1 ENTRY ALTRET;
       91     5623    1   DCL DDE$ERROR ENTRY;
       92     5624    1   DCL DFA$KILL1 ENTRY(3);
       93     5625    1   DCL DFA$SET_AT ENTRY(3) ALTRET;
       94     5626    1   DCL DUE$ERRMSG ENTRY;
       95     5627        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:4    
       96     5628        /* Initialization */
       97     5629    1        BUF$ = ADDR(S_D.OUTPUT);
       98     5630    1        SIZE = LENGTHC(S_D.OUTPUT);
       99     5631    1        BUFF$ER = ' ';
      100     5632    1        FPTREAD = FPT_READ;
      101     5633    1        FPTREAD.V_ = VECTOR( FPTREAD.V );
      102     5634    1        FPTREAD.BUF_ = VECTOR( BUFF$ER );
      103     5635    1        FPTREAD.V.DCB# = D_M$DELT#;
      104     5636    1        FPTREAD.V.DVBYTE.REREAD# = '1'B;
      105     5637    1        FPTSINPUT = FPT_SINPUT;
      106     5638    1        FPTSINPUT.V_ = VECTOR( FPTSINPUT.V );
      107     5639    1        FPTSINPUT.BUF_ = VECTOR( BUFF$ER );
      108     5640    1        M$DELT$ = DCBADDR( D_M$DELT# );
      109     5641    1        SET_ATTACH = '0'B;
      110     5642    1        DO$ = S_D.DO$;
      111     5643
      112     5644    2        DO CASE (UPDATE$CMD.UPDATE#);
      113     5645    2          CASE ( 610 );              /* C@UPDATE1 */
      114     5646    2             IF UPDATE$CMD.ATTACH_AT_TIME
      115     5647    3             THEN DO;
      116     5648    3                  SCMD_NO = UPDATE$CMD.ID_FROM;
      117     5649    3                  CONTINUE = '1'B;
      118     5650    4                  DO WHILE ((SCMD_NO > 0) AND (SCMD_NO <= 99)) AND CONTINUE;
      119     5651                                                /* Point to stored directive */
      120     5652    4                       SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));
      121     5653                                      /* Make sure stored directive is still around */
      122     5654    4                       IF SCMD$ -> F$XCM.CMD = 0
      123     5655    5                       THEN DO;
      124     5656    5                            S_D.ERROR_HICHAR = SCMD_NO;
      125     5657    5                            S_D.ERROR = 256; /* E@CANT_UPDATE */
      126     5658    5                            CALL DDE$ERROR;
      127     5659    5                            CONTINUE = '0'B;
      128     5660    5                          END;
      129     5661    5                       ELSE DO;
      130     5662    5                            CALL BINCHAR (SCMD$CHAR, SCMD_NO);
      131     5663    5                            CALL CONCAT (S_D.OUTPUT, 'Stored Directive #', SCMD$CHAR);
      132     5664    5                            CALL DDQ$WRITE (ADDR(S_D.OUTPUT), LENGTHC(
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:5    
              5664                                     'Stored Directive #') + LENGTHC(SCMD$CHAR));
      133     5665    5                            CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);
      134     5666    5                            IF SET_ATTACH
      135     5667    5                            THEN CALL DO_ATTACHMENTS (NO_OF_ATTACHMENTS, IX) ALTRET (
              5667                                     ALT);
      136     5668    5                            ELSE CALL DO_ATTACHMENTS (0, IX) ALTRET (ALT);
      137     5669    5                            IF NOT SET_ATTACH
      138     5670    5                            THEN SCMD_NO = SCMD_NO + 1;
      139     5671    5                            IF (IX = 0) AND (SCMD_NO >= UPDATE$CMD.ID_TO)
      140     5672    5                            THEN CONTINUE = '0'B;
      141     5673    5                          END;
      142     5674    4                     END;
      143     5675    3                END;
      144     5676    3             ELSE DO;
      145     5677    3                  SCMD_NO = UPDATE$CMD.ID_FROM;
      146     5678    3                  CONTINUE = '1'B;
      147     5679    4                  DO WHILE ((SCMD_NO > 0) AND (SCMD_NO <= 99)) AND CONTINUE;
      148     5680                                                /* Point to stored directive */
      149     5681    4                       SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));
      150     5682                                      /* Make sure stored directive is still around */
      151     5683    4                       IF SCMD$ -> F$XCM.CMD = 0
      152     5684    5                       THEN DO;
      153     5685    5                            S_D.ERROR_HICHAR = SCMD_NO;
      154     5686    5                            S_D.ERROR = 256; /* E@CANT_UPDATE */
      155     5687    5                            CALL DDE$ERROR;
      156     5688    5                            CONTINUE = '0'B;
      157     5689    5                          END;
      158     5690    5                       ELSE DO;
      159     5691                                                /* Get size of stored directive */
      160     5692    5                            SCMD_SIZE = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI) ->
              5692                                     AT_FIRST.TEXT_SIZE;
      161     5693    5                            IF SCMD_SIZE > 256
      162     5694    6                            THEN DO;
      163     5695    6                                 S_D.ERROR = 259; /* E@SCMD_GREATER256 */
      164     5696    6                                 CALL DDE$ERROR;
      165     5697    6                                 CALL DO_ATTACHMENTS (0, IX) ALTRET (ALT);
      166     5698    6                               END;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:6    
      167     5699    6                            ELSE DO;
      168     5700    6                                 BUFF$ER = ' ';
      169     5701    6                                 CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);
      170     5702    6                                 CALL BINCHAR (SCMD$CHAR, SCMD_NO);
      171     5703    6                                 CALL SAVE_SCMD;
      172     5704    6                                 FPTSINPUT.BUF_.BOUND = SCMD_SIZE - 1;
      173     5705    6                                 CALL M$SINPUT (FPTSINPUT) ALTRET (ARET0);
      174     5706    6                                 CALL M$READ (FPTREAD) ALTRET (ARET0);
      175     5707    6                                 SIZE_READ = M$DELT$ -> F$DCB.ARS#;
      176     5708    6                                 ACT_CHAR = M$DELT$ -> F$DCB.EOMCHAR#;
      177     5709    6                                 CALL REPLACE_TEXT (0, BUF$, SIZE_READ, SCMD_NO, '1'B)
              5709                                          ALTRET (DELBUG);
      178     5710                                                /* Check activation character */
      179     5711    6                                 CALL INDEX (IX, ACT_CHAR, ACHARS) ALTRET (UNKACT1);
      180     5712    7                                 DO WHILE ('0'B);
      181     5713    7   UNKACT1:                           ;
      182     5714    7                                      IX = 3;
      183     5715    7                                    END;
      184     5716    7                                 DO CASE (IX);
      185     5717    7                                   CASE (0,1); /* C/r, l/f */
      186     5718    7                                      IF (IX = 0) AND (SCMD_NO >= UPDATE$CMD.ID_TO)
      187     5719    7                                      THEN CONTINUE = '0'B;
      188     5720    7                                      ELSE SCMD_NO = SCMD_NO + 1;
      189     5721    7                                   CASE (2); /* ^ */
      190     5722    7                                      SCMD_NO = SCMD_NO - 1;
      191     5723    7                                   CASE (ELSE);
      192     5724    7                                      S_D.ERROR = 257; /* E@ACT_IGNORED_LF */
      193     5725    7                                      CALL DDE$ERROR;
      194     5726    7                                      SCMD_NO = SCMD_NO + 1;
      195     5727    7                                   END;
      196     5728    6                               END;
      197     5729    5                          END;
      198     5730    4                     END;
      199     5731    3                END;
      200     5732    2          CASE ( 611 );              /* C@UPDATE2 */
      201     5733    2             CONTINUE = '1'B;
      202     5734    2             SCMD_NO = UPDATE$CMD.ID_FROM;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:7    
      203     5735    2             ATTACHMENT_NO = UPDATE$CMD.ATTACHMENT#;
      204     5736    3             DO WHILE (CONTINUE);
      205     5737                                                /* Point to stored directive */
      206     5738    3                  SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));
      207     5739                                      /* Make sure stored directive is still around */
      208     5740    3                  IF SCMD$ -> F$XCM.CMD = 0
      209     5741    4                  THEN DO;
      210     5742    4                       S_D.ERROR_HICHAR = SCMD_NO;
      211     5743    4                       S_D.ERROR = 256; /* E@CANTUPDATE */
      212     5744    4                       GOTO ALT;
      213     5745    4                     END;
      214     5746    4                  ELSE DO;
      215     5747    4                       CALL BINCHAR (SCMD$CHAR, SCMD_NO);
      216     5748    4                       CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);
      217     5749    4                       CALL SAVE_SCMD;
      218     5750    4                       CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);
      219     5751    4                       BUFF$ER = ' ';
      220     5752    4                       CALL GET_ATTACHMENT (ATTACHMENT_NO, ATTACH_SIZE, BUF$, SIZE)
              5752                                ALTRET (NO_ATTACH);
      221     5753    4                       FPTSINPUT.BUF_.BOUND = ATTACH_SIZE - 1;
      222     5754    4                       CALL M$SINPUT (FPTSINPUT) ALTRET (ARET0);
      223     5755    4                       CALL M$READ (FPTREAD) ALTRET (ARET0);
      224     5756    4                       SIZE_READ = M$DELT$ -> F$DCB.ARS#;
      225     5757    4                       ACT_CHAR = M$DELT$ -> F$DCB.EOMCHAR#;
      226     5758    4                       CALL REPLACE_TEXT (ATTACHMENT_NO, BUF$, SIZE_READ, SCMD_NO, '0'B
              5758                                ) ALTRET (DELBUG);
      227     5759                                                /* Check activation character */
      228     5760    4                       CALL INDEX (IX, ACT_CHAR, ACHARS) ALTRET (UNKACT2);
      229     5761    5                       DO WHILE ('0'B);
      230     5762    5   UNKACT2:                 ;
      231     5763    5                            IX = 3;
      232     5764    5                          END;
      233     5765    5                       DO CASE (IX);
      234     5766    5                         CASE (0);         /* C/r */
      235     5767    5                            CONTINUE = '0'B;
      236     5768    5                         CASE (1);         /* L/f */
      237     5769    5                            ATTACHMENT_NO = ATTACHMENT_NO + 1;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:8    
      238     5770    5                            IF ATTACHMENT_NO > NO_OF_ATTACHMENTS
      239     5771    6                            THEN DO;
      240     5772    6                                 ATTACHMENT_NO = 0;
      241     5773    6                                 SCMD_NO = SCMD_NO +1;
      242     5774    6                               END;
      243     5775    5                         CASE (2);         /* ^ */
      244     5776    5                            IF (ATTACHMENT_NO = 0) AND (SCMD_NO ~=0)
      245     5777    6                            THEN DO;
      246     5778    6                                 SCMD_NO = SCMD_NO - 1;
      247     5779    6                                 SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM
              5779                                          ));
      248     5780    6                                 CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);
      249     5781    6                                 ATTACHMENT_NO = NO_OF_ATTACHMENTS;
      250     5782    6                               END;
      251     5783    5                            ELSE IF SCMD_NO = 0
      252     5784    5                                 THEN CONTINUE = '0'B;
      253     5785    5                                 ELSE ATTACHMENT_NO = ATTACHMENT_NO - 1;
      254     5786    5                         CASE (ELSE);
      255     5787    5                            S_D.ERROR = 258; /* E@ACT_IGNORED_CR */
      256     5788    5                            CALL DDE$ERROR;
      257     5789    5                            CONTINUE = '0'B;
      258     5790    5                         END;
      259     5791    4                     END;
      260     5792    3                END;
      261     5793    2          CASE ( 612 );              /* C@UPDATE3 */
      262     5794    2             SCMD_NO = UPDATE$CMD.ID_FROM;
      263     5795    2             ATTACHMENT_NO = UPDATE$CMD.ATTACHMENT#;
      264     5796                                                /* Point to stored directive */
      265     5797    2             SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));
      266     5798                                      /* Make sure stored directive is still around */
      267     5799    2             IF SCMD$ -> F$XCM.CMD = 0
      268     5800    3             THEN DO;
      269     5801    3                  S_D.ERROR_HICHAR = SCMD_NO;
      270     5802    3                  S_D.ERROR = 256; /* E@CANT_UPDATE */
      271     5803    3                  GOTO ALT;
      272     5804    3                END;
      273     5805    2             CALL BINCHAR (SCMD$CHAR, SCMD_NO);
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:9    
      274     5806    2             CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);
      275     5807    2             CALL SAVE_SCMD;
      276     5808    2             IF UPDATE$CMD.ATTACHMENT
      277     5809    3             THEN DO;
      278     5810    3                  CALL GET_ATTACHMENT (ATTACHMENT_NO, ATTACH_SIZE, BUF$, SIZE) ALTRET (
              5810                           NO_ATTACH);
      279     5811    3                  TEXT$ = UPDATE$CMD.ASYM$;
      280     5812    3                  IF (ATTACHMENT_NO = 0) AND (TEXT$C.SIZE = 0)
      281     5813    4                  THEN DO;
      282     5814    4                       S_D.KILL1 = SCMD_NO;
      283     5815    4                       CCMD = S_D.FIXCOM.CMD(SCMD_NO);
      284     5816    4                       FPRG = S_D.FIXCOM.FPRG(SCMD_NO);
      285     5817    4                       IF FPRG
      286     5818    4                       THEN CALL DFA$KILL1('1'B, CCMD, '1'B);
      287     5819    5                       ELSE DO;
      288     5820    5                            IF CCMD = 30 /* C_OA */
      289     5821    5                            THEN S_D.ONABORT = 0;
      290     5822    5                            IF CCMD = 32 /* C_OE */
      291     5823    5                            THEN S_D.ONEXIT = 0;
      292     5824    5                            IF CCMD = 53 /* C_ONCALLS */
      293     5825    5                            THEN S_D.ONCALLS = 0;
      294     5826    5                            IF CCMD = 54 /* C_ONNODES */
      295     5827    5                            THEN S_D.ONNODES = 0;
      296     5828    5                            CALL DDA$KILL1;
      297     5829    5                          END;
      298     5830    4                     END;
      299     5831    4                  ELSE DO;
      300     5832    4                       SCMD_TEXT$ = PINCRC(TEXT$, 1);
      301     5833    4                       SCMD_SIZE = TEXT$C.SIZE;
      302     5834    4                       CALL REPLACE_TEXT (ATTACHMENT_NO, SCMD_TEXT$, SCMD_SIZE, SCMD_NO
              5834                                , '0'B) ALTRET (DELBUG);
      303     5835    4                     END;
      304     5836    3                END;
      305     5837    3             ELSE DO;
      306     5838                                                /* Point to text of stored directive */
      307     5839    3                  FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);
      308     5840    3                  SCMD_TEXT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:10   
      309     5841    3                  SCMD_SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;
      310     5842    3                  CALL CONCAT (BUFF$ER, SUBSTR(SCMD$TEXT, 0, SCMD_SIZE), ';',
      311     5843    3                    SUBSTR(UPDATE$CMD.ASYM$ -> TEXT$C.TEXT, 0, UPDATE$CMD.ASYM$ ->
              5843                             TEXT$C.SIZE - 1));
      312     5844    3                  SCMD_SIZE = SCMD_SIZE + LENGTHC(';') + UPDATE$CMD.ASYM$ -> TEXT$C.
              5844                           SIZE;
      313     5845    3                  CALL REPLACE_TEXT (ATTACHMENT_NO, BUF$, SCMD_SIZE, SCMD_NO, '1'B)
              5845                           ALTRET (DELBUG);
      314     5846    3                END;
      315     5847    2          END;
      316     5848
      317     5849    1   RET: RETURN;
      318     5850
      319     5851    1   ARET0: CALL DUE$ERRMSG;
      320     5852    1        GOTO RET;
      321     5853    1   DELBUG: S_D.ERROR = 502;           /* E@DELBUG */
      322     5854    1        CALL DDE$ERROR;
      323     5855    1        GOTO RET;
      324     5856    1   NO_ATTACH: S_D.ERROR = 260; /* E@NO_ATTACHMENT */
      325     5857
      326     5858    1   ALT: ALTRETURN;
      327     5859
      328     5860        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:11   
      329     5861        /*D* NAME:    GET_NO_ATTACH
      330     5862             CALL:    CALL GET_NO_ATTACH (ATT#);
      331     5863             INPUT:   SCMD$ POINTS TO STORED DIRECTIVE
      332     5864             OUTPUT:  ATT# IS THE NUMBER OF ATTACHMENTS STORED DIRECTIVE HAS
      333     5865             SCRATCH: LOCAL AUTO
      334     5866             DESCRIPTION:  RETURN THE NUMBER OF ATTACHMENTS STORED DIRECTIVE
      335     5867                      HAS.  ZERO MEANS NO ATTACHMENTS.                */
      336     5868
      337     5869    1   GET_NO_ATTACH: PROC (ATT#);
      338     5870
      339     5871        /* Parameters */
      340     5872    2   DCL ATT# UBIN;
      341     5873
      342     5874        /* Auto */
      343     5875    2   DCL FATT$ PTR;
      344     5876    2   DCL ATT$ PTR;
      345     5877    2   DCL ATT_SIZE UBIN;
      346     5878    2   DCL START UBIN;
      347     5879    2   DCL SEMI_POSITION UBIN;
      348     5880    2   DCL GOT_SEMI BIT(1) ALIGNED;
      349     5881
      350     5882        /* Based */
      351     5883    2   DCL CHAR$ATT CHAR(ATT_SIZE) BASED;
      352     5884
      353     5885                                 /* Point to first attachment of stored directive */
      354     5886    2        FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);
      355     5887    2        IF FATT$ -> AT_FIRST.ATT_OFFSET = 0
      356     5888    2        THEN ATT# = 0;                     /* No attachments */
      357     5889    3        ELSE DO;                           /* Count number of attachments */
      358     5890    3             ATT# = 1;
      359     5891    3             ATT_SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;
      360     5892                                                /* Point to text of stored directive */
      361     5893    3             ATT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);
      362     5894    3             START = FATT$ -> AT_FIRST.ATT_OFFSET;
      363     5895    3             GOT_SEMI = '1'B;
      364     5896    4             DO WHILE (GOT_SEMI);
      365     5897    4                  CALL INDEX (SEMI_POSITION, ';', ATT$ -> CHAR$ATT, START) ALTRET (
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:12   
              5897                           NO_SEMI);
      366     5898    4                  ATT# = ATT# + 1;
      367     5899    4                  START = SEMI_POSITION + 1;
      368     5900    5                  DO WHILE ('0'B);
      369     5901    5   NO_SEMI:            GOT_SEMI = '0'B;
      370     5902    5                     END;
      371     5903    4                END;
      372     5904    3           END;
      373     5905
      374     5906    2        RETURN;
      375     5907
      376     5908    2   END GET_NO_ATTACH;
      377     5909        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:13   
      378     5910        /*D* NAME:     GET_ATTACHMENT
      379     5911             CALL:     CALL GET_ATTACHMENT (ATT#, ATT_SIZE, BUF$, BUF_SIZE) ALTRET (ERROR);
      380     5912             INPUT:    ATT# IS ATTACHMENT NUMBER WANT TEXT OF
      381     5913                       BUF$ IS POINTER TO BUFFER WHERE TEXT SHOULD BE PLACED
      382     5914                       BUF_SIZE IS SIZE OF BUFFER POINTED TO BY BUF$
      383     5915                       SCMD$ POINTS TO STORED DIRECTIVE
      384     5916             OUTPUT:   ATT_SIZE IS SIZE OF TEXT OF ATTACHMENT
      385     5917             SCRATCH:  LOCAL AUTO
      386     5918             DESCRIPTION:  GET ATT# OF STORED COMMMAND POINTED TO BY SCMD$.
      387     5919                       PUT THE TEXT IN THE BUFFER POINTED TO BY BUF$ AND
      388     5920                       SIZE OF THE TEXT IS RETURNED IN ATT_SIZE.             */
      389     5921
      390     5922    1   GET_ATTACHMENT: PROC (ATT#, ATT_SIZE, BUF$, BUF_SIZE) ALTRET;
      391     5923
      392     5924        /* Paramenters */
      393     5925    2   DCL ATT# UBIN;
      394     5926    2   DCL ATT_SIZE UBIN;
      395     5927    2   DCL BUF$ PTR;
      396     5928    2   DCL BUF_SIZE UBIN;
      397     5929
      398     5930        /* Auto */
      399     5931    2   DCL FATT$ PTR;
      400     5932    2   DCL TEXT$ PTR;
      401     5933    2   DCL K SBIN;
      402     5934    2   DCL START UBIN;
      403     5935    2   DCL SEMI_POSITION SBIN;
      404     5936    2   DCL POSITION UBIN;
      405     5937    2   DCL SIZE UBIN;
      406     5938
      407     5939        /* Based */
      408     5940    2   DCL TEXT$ATT CHAR(BUF_SIZE) BASED(BUF$);
      409     5941    2   DCL CHAR$ATT CHAR(SIZE) BASED;
      410     5942
      411     5943                                 /* Point to first attachment of stored directive */
      412     5944    2        FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);
      413     5945                                                /* Point to text of stored directive */
      414     5946    2        TEXT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:14   
      415     5947    2        SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;
      416     5948    2        SEMI_POSITION = -1;
      417     5949    2        K = -1;
      418     5950    3        DO UNTIL (K = ATT#);
      419     5951    3             K = K + 1;
      420     5952    3             START = SEMI_POSITION + 1;
      421     5953    3             CALL INDEX (SEMI_POSITION, ';', TEXT$ -> CHAR$ATT, START) ALTRET (NO_SEMI)
              5953                      ;
      422     5954    3           END;
      423     5955    2        IF K = 0
      424     5956    3        THEN DO;
      425     5957    3             CALL INDEX (POSITION, SUBSTR(TEXT$ -> CHAR$ATT, 0, 1), '0123456789', 0);
      426     5958    3             IF POSITION = LENGTHC('0123456789')
      427     5959    4             THEN DO;
      428     5960    4                  ATT_SIZE = SEMI_POSITION - START;
      429     5961    4                  TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);
      430     5962    4                END;
      431     5963    4             ELSE DO;
      432     5964    4                  CALL INDEX (POSITION, ' ', TEXT$ -> CHAR$ATT, 0);
      433     5965    4                  ATT_SIZE = SEMI_POSITION - (POSITION + 1);
      434     5966    4                  TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, POSITION + 1, ATT_SIZE);
      435     5967    4                END;
      436     5968    3           END;
      437     5969    3        ELSE DO;
      438     5970    3             ATT_SIZE = SEMI_POSITION - START;
      439     5971    3             TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);
      440     5972    3           END;
      441     5973    3        DO WHILE ('0'B);
      442     5974    3   NO_SEMI:  ;
      443     5975    3             IF K = ATT#
      444     5976    4             THEN DO;
      445     5977    4                  IF K = 0
      446     5978    5                  THEN DO;
      447     5979    5                       CALL INDEX (POSITION, SUBSTR(TEXT$ -> CHAR$ATT, 0, 1),
              5979                                '0123456789', 0);
      448     5980    5                       IF POSITION = LENGTHC('0123456789')
      449     5981    6                       THEN DO;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:15   
      450     5982    6                            ATT_SIZE = SIZE - START;
      451     5983    6                            TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);
      452     5984    6                          END;
      453     5985    6                       ELSE DO;
      454     5986    6                            CALL INDEX (POSITION, ' ', TEXT$ -> CHAR$ATT, 0);
      455     5987    6                            ATT_SIZE = SIZE - (SEMI_POSITION + 1);
      456     5988    6                            TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, POSITION + 1, ATT_SIZE
              5988                                     );
      457     5989    6                          END;
      458     5990    5                     END;
      459     5991    5                  ELSE DO;
      460     5992    5                       ATT_SIZE = SIZE - START;
      461     5993    5                       TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);
      462     5994    5                     END;
      463     5995    4                END;
      464     5996    3             ELSE ALTRETURN;
      465     5997    3           END;
      466     5998
      467     5999    2        RETURN;
      468     6000
      469     6001    2   END GET_ATTACHMENT;
      470     6002        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:16   
      471     6003        /*D* NAME:    GET_STORED_COMMAND
      472     6004             CALL:    CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, BUF_SIZE);
      473     6005             INPUT:   BUF$ POINTS TO BUFFER WHERE TEXT SHOULD BE PLACED
      474     6006                      BUF_SIZE IS SIZE OF BUFFER POINTED TO BY BUF$
      475     6007                      SCMD$ POINTS TO STORED DIRECTIVE
      476     6008             OUTPUT:  SCMD_SIZE IS SIZE OF TEXT PLACED IN BUFFER
      477     6009             SCRATCH: LOCAL AUTO
      478     6010             DESCRIPTION:  PUTS ENTIRE TEXT OF STORED DIRECTIVE POINTED TO BY
      479     6011                      SCMD$ IN BUFFER AND SCMD_SIZE IS SET TO SIZE OF TEXT
      480     6012                      PLACED IN BUFFER                                       */
      481     6013
      482     6014    1   GET_STORED_COMMAND: PROC (SCMD_SIZE, BUF$, BUF_SIZE);
      483     6015
      484     6016        /* Parameters */
      485     6017    2   DCL SCMD_SIZE UBIN;
      486     6018    2   DCL BUF$ PTR;
      487     6019    2   DCL BUF_SIZE UBIN;
      488     6020
      489     6021        /* Auto */
      490     6022    2   DCL SIZE UBIN;
      491     6023    2   DCL FATT$ PTR;
      492     6024    2   DCL TEXT$ PTR;
      493     6025    2   DCL START UBIN;
      494     6026    2   DCL POSITION UBIN;
      495     6027
      496     6028        /* Based */
      497     6029    2   DCL TEXT$CMD CHAR(BUF_SIZE) BASED(BUF$);
      498     6030    2   DCL CHAR$CMD CHAR(SIZE) BASED;
      499     6031
      500     6032    2        S_D.SHOW1 = SCMD_NO;
      501     6033    2        CALL DDA$SHOW1('0'B , SCMD_SIZE);
      502     6034
      503     6035    2        RETURN;
      504     6036
      505     6037    2   END GET_STORED_COMMAND;
      506     6038        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:17   
      507     6039        /*D* NAME:    REPLACE_TEXT
      508     6040           CALL:    CALL REPLACE_TEXT (ATT#, BUF$, TEXT_SIZE, SCMD#, ENTIRE) ALTRET (ERROR);
      509     6041             INPUT:   ATT# IS THE ATTACHMENT NUMBER TO BE REPLACED
      510     6042                      BUF$ IS A POINTER TO BUFFER CONTAINING REPLACEMENT TEXT
      511     6043                      TEXT_SIZE IS SIZE OF REPLACEMENT TEXT
      512     6044                      SCMD$ POINTS TO THE STORED DIRECTIVE
      513     6045                      SCMD# IS STORED DIRECTIVE NUMBER
      514     6046                      ENTIRE IS SET IF THE ENTIRE STORED DIRECTIVE IS TO BE
      515     6047                       REPLACED BY THE REPLACEMENT TEXT
      516     6048             OUTPUT:  NEW STORED DIRECTIVE BUILD VIA SCAN
      517     6049             SCRATCH: LOCAL AUTO
      518     6050             DESCRIPTION:  REPLACES ATTACHMENT OF STORED DIRECTIVE WITH REPLACEMENT
      519     6051                      TEXT, KILLS THE OLD STORED DIRECTIVE, CALLS DDS$SCAN1 TO
      520     6052                      BUILD NEW STORED DIRECTIVE.                              */
      521     6053
      522     6054    1   REPLACE_TEXT: PROC (ATT#, BUF$, TEXT_SIZE, SCMD#, ENTIRE) ALTRET;
      523     6055
      524     6056        /* Parameters */
      525     6057    2   DCL ATT# UBIN;
      526     6058    2   DCL BUF$ PTR;
      527     6059    2   DCL TEXT_SIZE UBIN;
      528     6060    2   DCL SCMD# UBIN;
      529     6061    2   DCL ENTIRE BIT(1) ALIGNED;
      530     6062
      531     6063        /* Auto */
      532     6064    2   DCL SCMD$CHAR CHAR(2);
      533     6065    2   DCL FATT$ PTR;
      534     6066    2   DCL TEXT$ PTR;
      535     6067    2   DCL SIZE UBIN;
      536     6068    2   DCL START UBIN;
      537     6069    2   DCL SEMI_POSITION SBIN;
      538     6070    2   DCL K SBIN;
      539     6071    2   DCL CCMD UBIN;
      540     6072
      541     6073        /* Based */
      542     6074    2   DCL REPL$TEXT CHAR(TEXT_SIZE) BASED(BUF$);
      543     6075    2   DCL CHAR$ATT CHAR(SIZE) BASED;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:18   
      544     6076
      545     6077    2        CALL BINCHAR (SCMD$CHAR, SCMD#);
      546     6078    2        IF ENTIRE
      547     6079    3        THEN DO;
      548     6080    3             S_D.INPUT = REPL$TEXT;
      549     6081    3             S_D.NCHARS = TEXT_SIZE;
      550     6082    3           END;
      551     6083    3        ELSE DO;
      552     6084                                 /* Point to first attachment of stored directive */
      553     6085    3             FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);
      554     6086                                                /* Point to text of stored directive */
      555     6087    3             TEXT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);
      556     6088                                                /* Get size of text */
      557     6089    3             SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;
      558     6090                                                /* Find attachment ATT# */
      559     6091    3             SEMI_POSITION = -1;
      560     6092    3             K = -1;
      561     6093    4             DO UNTIL (K = ATT#);
      562     6094    4                  K = K + 1;
      563     6095    4                  START = SEMI_POSITION + 1;
      564     6096    4                  CALL INDEX (SEMI_POSITION, ';', TEXT$ -> CHAR$ATT, START) ALTRET (
              6096                           NO_SEMI);
      565     6097    4                END;
      566     6098    3             IF K = 0
      567     6099    4             THEN DO;                      /* Breakpoint itself */
      568     6100    4                  IF TEXT_SIZE = 0
      569     6101    5                  THEN DO;
      570     6102    5                       CCMD = S_D.FIXCOM.CMD(SCMD#);
      571     6103    5                       IF CCMD ~= 0
      572     6104    6                       THEN DO;
      573     6105    6                            S_D.KILL1 = SCMD#;
      574     6106    6                            FPRG = S_D.FIXCOM.FPRG(SCMD#);
      575     6107    6                            IF FPRG
      576     6108    6                            THEN CALL DFA$KILL1('1'B, CCMD, '1'B);
      577     6109    7                            ELSE DO;
      578     6110    7                                 IF CCMD = 30 /* C_OA */
      579     6111    7                                 THEN S_D.ONABORT = 0;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:19   
      580     6112    7                                 IF CCMD = 32 /* C_OE */
      581     6113    7                                 THEN S_D.ONEXIT = 0;
      582     6114    7                                 IF CCMD = 53 /* C_ONCALLS */
      583     6115    7                                 THEN S_D.ONCALLS = 0;
      584     6116    7                                 IF CCMD = 54 /* C_ONNODES */
      585     6117    7                                 THEN S_D.ONNODES = 0;
      586     6118    7                                 CALL DDA$KILL1;
      587     6119    7                               END;
      588     6120    6                            GOTO RET;
      589     6121    6                          END;
      590     6122    6                       ELSE DO;
      591     6123    6                            S_D.ERROR = 502; /* E@DELBUG */
      592     6124    6                            ALTRETURN;
      593     6125    6                          END;
      594     6126    5                     END;
      595     6127    4                  CALL CONCAT (S_D.INPUT, REPL$TEXT,
      596     6128    4                    SUBSTR(TEXT$ -> CHAR$ATT, SEMI_POSITION, SIZE - SEMI_POSITION));
      597     6129    4                  S_D.NCHARS = TEXT_SIZE + (SIZE - SEMI_POSITION);
      598     6130    4                END;
      599     6131    4             ELSE DO;                      /* An attachment */
      600     6132    4                  IF TEXT_SIZE = 0
      601     6133    5                  THEN DO;
      602     6134    5                       CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0, START),
      603     6135    5                         REPL$TEXT, SUBSTR(TEXT$ -> CHAR$ATT, SEMI_POSITION + 1, SIZE -
              6135                                  (SEMI_POSITION + 1)));
      604     6136    5                       S_D.NCHARS = START + TEXT_SIZE + (SIZE - (SEMI_POSITION + 1));
      605     6137    5                     END;
      606     6138    5                  ELSE DO;
      607     6139    5                       CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0, START),
      608     6140    5                         REPL$TEXT, SUBSTR(TEXT$ -> CHAR$ATT, SEMI_POSITION, SIZE -
              6140                                  SEMI_POSITION));
      609     6141    5                       S_D.NCHARS = START + TEXT_SIZE + (SIZE - SEMI_POSITION);
      610     6142    5                     END;
      611     6143    4                END;
      612     6144    4             DO WHILE ('0'B);
      613     6145    4   NO_SEMI:       ;
      614     6146    4                  IF K = ATT#
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:20   
      615     6147    5                  THEN DO;
      616     6148    5                       IF K = 0
      617     6149    6                       THEN DO;
      618     6150    6                            IF TEXT_SIZE = 0
      619     6151    7                            THEN DO;
      620     6152    7                                 CCMD = S_D.FIXCOM.CMD(SCMD#);
      621     6153    7                                 IF CCMD ~= 0
      622     6154    8                                 THEN DO;
      623     6155    8                                      S_D.KILL1 = SCMD#;
      624     6156    8                                      IF CCMD = 30 /* C_OA */
      625     6157    8                                      THEN S_D.ONABORT = 0;
      626     6158    8                                      IF CCMD = 32 /* C_OE */
      627     6159    8                                      THEN S_D.ONEXIT = 0;
      628     6160    8                                      IF CCMD = 53 /* C_ONCALLS */
      629     6161    8                                      THEN S_D.ONCALLS = 0;
      630     6162    8                                      IF CCMD = 54 /* C_ONNODES */
      631     6163    8                                      THEN S_D.ONNODES = 0;
      632     6164    8                                      CALL DDA$KILL1;
      633     6165    8                                      GOTO RET;
      634     6166    8                                    END;
      635     6167    8                                 ELSE DO;
      636     6168    8                                      S_D.ERROR = 502; /* E@DELBUG */
      637     6169    8                                      ALTRETURN;
      638     6170    8                                    END;
      639     6171    7                               END;
      640     6172    6                            S_D.INPUT = REPL$TEXT;
      641     6173    6                            S_D.NCHARS = TEXT_SIZE;
      642     6174    6                          END;
      643     6175    6                       ELSE DO;
      644     6176    6                            IF TEXT_SIZE = 0
      645     6177    7                            THEN DO;
      646     6178    7                                 CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0,
              6178                                          START - 1));
      647     6179    7                                 S_D.NCHARS = START-1;
      648     6180    7                               END;
      649     6181    7                            ELSE DO;
      650     6182    7                                 CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0,
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:21   
              6182                                          START), REPL$TEXT);
      651     6183    7                                 S_D.NCHARS = START + TEXT_SIZE;
      652     6184    7                               END;
      653     6185    6                          END;
      654     6186    5                     END;
      655     6187    5                  ELSE DO;
      656     6188    5                       S_D.ERROR = 502; /* E@DELBUG */
      657     6189    5                       ALTRETURN;
      658     6190    5                     END;
      659     6191    4                END;
      660     6192    3           END;
      661     6193
      662     6194                                                /* Kill original stored directive */
      663     6195    2        CCMD = S_D.FIXCOM.CMD(SCMD#);
      664     6196    2        IF CCMD ~= 0
      665     6197    3        THEN DO;
      666     6198    3             S_D.KILL1 = SCMD#;
      667     6199    3             FPRG = S_D.FIXCOM.FPRG(SCMD#);
      668     6200    3             IF FPRG
      669     6201    3             THEN CALL DFA$KILL1('1'B, CCMD, '1'B);
      670     6202    4             ELSE DO;
      671     6203    4                  IF CCMD = 30           /* C_OA */
      672     6204    4                  THEN S_D.ONABORT = 0;
      673     6205    4                  IF CCMD = 32           /* C_OE */
      674     6206    4                  THEN S_D.ONEXIT = 0;
      675     6207    4                  IF CCMD = 53      /* C_ONCALLS */
      676     6208    4                  THEN S_D.ONCALLS = 0;
      677     6209    4                  IF CCMD = 54      /* C_ONNODES */
      678     6210    4                  THEN S_D.ONNODES = 0;
      679     6211    4                  CALL DDA$KILL1;
      680     6212    4                END;
      681     6213    3           END;
      682     6214    3        ELSE DO;
      683     6215    3             S_D.ERROR = 502;         /* E@DELBUG */
      684     6216    3             ALTRETURN;
      685     6217    3           END;
      686     6218    2        IF SIZE_READ = 0
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:22   
      687     6219    2        THEN GOTO RET;
      688     6220                            /* Call scan to have stored directive parsed and rebuilt */
      689     6221    2        CALL DDS$SCAN1 ALTRET (RESTORE_SAVED);
      690     6222    2   RET: ;
      691     6223    2        RETURN;
      692     6224
      693     6225    2   RESTORE_SAVED: ;
      694     6226    2        S_D.ERROR = 262;        /* E@SCMD_ERRORED */
      695     6227    2        CALL DDE$ERROR;
      696     6228    2        S_D.OUTPUT = S_D.INPUT;
      697     6229    2        CALL DDQ$WRITE (ADDR(S_D.OUTPUT), S_D.NCHARS);
      698     6230    2        S_D.ERROR = 261;       /* E@SCMD_RESTORED */
      699     6231    2        CALL DDE$ERROR;
      700     6232    2        CALL RESTORE_SCMD;
      701     6233    2        RETURN;
      702     6234
      703     6235    2   END REPLACE_TEXT;
      704     6236        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:23   
      705     6237        /*D* NAME:    DO_ATTACHMENTS
      706     6238             CALL:    CALL DO_ATTACHMENTS (J, ACT) ALTRET (ERROR);
      707     6239             INPUT:   J IS ATTACHMENT NUMBER TO START AT
      708     6240                      ACT IS CODE FOR THE ACTIVATION CHARACTER
      709     6241                      NO_OF_ATTACHMENTS IS SET TO NUMBER OF ATTACHMENTS FOR
      710     6242                       FOR THE CURRENT STORED DIRECTIVE
      711     6243             OUTPUT:  EACH ATTACHMENT IS PUT IN REREAD BUFFER THEN REPLACED
      712     6244                       IN THE STORED DIRECTIVE WITH THE NEW TEXT
      713     6245             SCRATCH: LOCAL AUTO
      714     6246             DESCRIPTION:  FOR EACH ATTACHMENT ZERO TO NO_OF_ATTACHMENTS,
      715     6247                      PUT THE ATTACHMENT IN THE REREAD BUFFER AND THEN REPLACE
      716     6248                      THE ATTACHMENT WITH THE NEW TEXT.                      */
      717     6249
      718     6250    1   DO_ATTACHMENTS: PROC (J, ACT) ALTRET;
      719     6251
      720     6252        /* Parameters */
      721     6253    2   DCL J UBIN;
      722     6254    2   DCL ACT UBIN;
      723     6255
      724     6256        /* Auto */
      725     6257    2   DCL I UBIN;
      726     6258    2   DCL CONTINUE BIT(1) ALIGNED;
      727     6259
      728     6260    2        SET_ATTACH = '0'B;
      729     6261    2        CONTINUE = '1'B;
      730     6262    2        IF ADDR(J) = ADDR(NIL)
      731     6263    2        THEN I = 0;
      732     6264    2        ELSE I = J;
      733     6265    3        DO WHILE (CONTINUE) AND (I <= NO_OF_ATTACHMENTS);
      734     6266    3             CALL BINCHAR (SCMD$CHAR, SCMD_NO);
      735     6267    3             CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);
      736     6268    3             CALL CONCAT (SAVE_SCMD_TEXT, SUBSTR(BUFF$ER, 0, SCMD_SIZE));
      737     6269    3             SAVE_SCMD_SIZE = SCMD_SIZE;
      738     6270    3             BUFF$ER = ' ';
      739     6271    3             CALL GET_ATTACHMENT (I, ATTACH_SIZE, BUF$, SIZE) ALTRET (DELBUG);
      740     6272    3             FPTSINPUT.BUF_.BOUND = ATTACH_SIZE - 1;
      741     6273    3             CALL M$SINPUT (FPTSINPUT) ALTRET (ARET0);
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:24   
      742     6274    3             CALL M$READ (FPTREAD) ALTRET (ARET0);
      743     6275    3             SIZE_READ = M$DELT$ -> F$DCB.ARS#;
      744     6276    3             ACT_CHAR = M$DELT$ -> F$DCB.EOMCHAR#;
      745     6277    3             CALL REPLACE_TEXT (I, BUF$, SIZE_READ, SCMD_NO, '0'B) ALTRET (DELBUG);
      746     6278                                                /* Check activation character */
      747     6279    3             CALL INDEX (IX, ACT_CHAR, ACHARS) ALTRET (UNKACT);
      748     6280    4             DO WHILE ('0'B);
      749     6281    4   UNKACT:        ;
      750     6282    4                  IX = 3;
      751     6283    4                END;
      752     6284    3             ACT = IX;
      753     6285    4             DO CASE (IX);
      754     6286    4               CASE (0);                   /* C/r */
      755     6287    4                  CONTINUE = '0'B;
      756     6288    4               CASE (1);                   /* L/f */
      757     6289    4                  I = I + 1;
      758     6290    4               CASE (2);                   /* ^ */
      759     6291    4                  IF I = 0
      760     6292    5                  THEN DO;
      761     6293    5                       SCMD_NO = SCMD_NO - 1;
      762     6294    5                       SET_ATTACH = '1'B;
      763     6295    5                     END;
      764     6296    4                  ELSE I = I - 1;
      765     6297    4               CASE (ELSE);
      766     6298    4                  S_D.ERROR = 257; /* E@ACT_IGNORED_LF */
      767     6299    4                  CALL DDE$ERROR;
      768     6300    4                  I = I + 1;
      769     6301    4               END;
      770     6302    3             CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);
      771     6303    3           END;
      772     6304
      773     6305    2        RETURN;
      774     6306
      775     6307    2   DELBUG: S_D.ERROR = 502;           /* E@DELBUG */
      776     6308    2        CALL DDE$ERROR;
      777     6309    2        RETURN;
      778     6310
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:25   
      779     6311    2   ARET0: CALL DUE$ERRMSG;
      780     6312    2        ALTRETURN;
      781     6313
      782     6314    2   END DO_ATTACHMENTS;
      783     6315
      784     6316        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:26   
      785     6317    1   SAVE_SCMD: PROC;
      786     6318        /* Auto */
      787     6319    2   DCL I UBIN;
      788     6320    2   DCL UBIN36 UBIN(36) BASED;
      789     6321
      790     6322    2        SAVE_FIXCOM = S_D.FIXCOM(SCMD_NO);
      791     6323    2        SAVE_VARCOM_SIZE = S_D.FIXCOM.TAL(SCMD_NO);
      792     6324    3        DO I = 0 TO SAVE_VARCOM_SIZE - 1;
      793     6325    3             SAVE_VARCOM(I) = PINCRW(S_D.VARCOM$, S_D.FIXCOM.FAI(SCMD_NO)+I) -> UBIN36;
      794     6326    3           END;
      795     6327    2   END SAVE_SCMD;
      796     6328        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:27   
      797     6329    1   RESTORE_SCMD: PROC;
      798     6330        /* Auto */
      799     6331    2   DCL I UBIN;
      800     6332    2   DCL UBIN36 UBIN(36) BASED;
      801     6333    2   DCL TFPRG$ PTR;
      802     6334    2   DCL RES CHAR(8) CALIGNED;
      803     6335    2   DCL RES_SIZE UBIN;
      804     6336    2   DCL FATT$ PTR;
      805     6337        /* Includes and based structures */
      806     6338        %FPRG$CONTEXT;
      807     6401
      808     6402    2        S_D.FIXCOM(SCMD_NO) = SAVE_FIXCOM;
      809     6403    2        S_D.FIXCOM.FAI(SCMD_NO) = POFFW(S_D.VARNEXT$, S_D.VARCOM$);
      810     6404    3        DO I = 0 TO SAVE_VARCOM_SIZE - 1;
      811     6405    3             S_D.VARNEXT$ -> UBIN36 = SAVE_VARCOM(I);
      812     6406    3             S_D.VARNEXT$ = PINCRW(S_D.VARNEXT$, 1);
      813     6407    3           END;
      814     6408    2        TFPRG$ = S_D.FPRG_CONTEXT$;
      815     6409    2        IF TFPRG$ = ADDR(NIL)
      816     6410    2        THEN GOTO RET;
      817     6411    2        RES = S_D.FIXCOM.FPRG_RES(SCMD_NO);
      818     6412    2        RES_SIZE = S_D.FIXCOM.FPRG_RES_SIZE(SCMD_NO);
      819     6413    3        DO WHILE (SUBSTR(RES, 0, RES_SIZE) ~= SUBSTR(TFPRG$->FPRG$CONTEXT.RES,
      820     6414    3          0, TFPRG$->FPRG$CONTEXT.RES_SIZE));
      821     6415    3             TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
      822     6416    3             IF TFPRG$ = ADDR(NIL)
      823     6417    3             THEN GOTO FPRG_ERR;
      824     6418    3           END;
      825     6419    2        I = 1;
      826     6420    3        DO WHILE (TFPRG$->FPRG$CONTEXT.FIXCOM_INDEX(I) ~= 0
      827     6421    3          AND I <= 20);
      828     6422    3             I = I + 1;
      829     6423    3           END;
      830     6424    2        IF I > 20
      831     6425    3        THEN DO;
      832     6426    3             S_D.ERROR = 288;  /* E@TOOMANYBKPNTS */
      833     6427    3             GOTO ALTRT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:28   
      834     6428    3           END;
      835     6429    2        TFPRG$ -> FPRG$CONTEXT.FIXCOM_INDEX(I) = SCMD_NO;
      836     6430    2        FATT$ = PINCRW(S_D.VARCOM$, S_D.FIXCOM.FAI(SCMD_NO));
      837     6431    2        CALL DFA$SET_AT(I, FATT$ -> AT_FIRST.BYPASS_COUNT, SCMD_NO) ALTRET(ALTRT);
      838     6432    2        RETURN;
      839     6433
      840     6434    2   FPRG_ERR: ;
      841     6435    2        S_D.ERROR = 502;              /* E@DELBUG */
      842     6436
      843     6437    2   ALTRT: ;
      844     6438    2        CALL DDE$ERROR;
      845     6439    2   RET: ;
      846     6440    2        RETURN;
      847     6441    2   END RESTORE_SCMD;
      848     6442
      849     6443    1   END DDA$UPDATE;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:29   
--  Include file information  --

   DD$BASED.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDA$UPDATE.

   Procedure DDA$UPDATE requires 1611 words for executable code.
   Procedure DDA$UPDATE requires 252 words of local(AUTO) storage.

    No errors detected in file DDA$UPDATE.:E05TSI    .

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:30   

 Object Unit name= DDA$UPDATE                                 File name= DDA$UPDATE.:E05TOU
 UTS= JUL 29 '97 13:40:00.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     31     37  DDA$UPDATE
    2   Proc  even  none  1611   3113  DDA$UPDATE
    3  RoData even  none     9     11  DDA$UPDATE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        0  DDA$UPDATE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 DDE$ERROR
         yes           Std       2 DDQ$WRITE
         yes           Std       3 DFA$KILL1
         yes           Std       0 DUE$ERRMSG
         yes           Std       0 DDA$KILL1
         yes           Std       2 DDA$SHOW1
 yes     yes           Std       0 DDS$SCAN1
 yes     yes           Std       3 DFA$SET_AT
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:31   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    S_D$                                  D_M$DELT#
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:32   


        1        1        /*M* DDA$UPDATE - UPDATE DO ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCC,DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME:  DDA$UPDATE
       10       10             PURPOSE:  UPDATE BREAKPOINTS AND ATTACHMENTS             */
       11       11        /*D* NAME:  DDA$UPDATE
       12       12             CALL:  CALL DDA$UPDATE ALTRET(ERROR);
       13       13             INPUT: S_D.DO$ POINTS TO UPDATE FRAME
       14       14             DESCRIPTION:  DOES UPDATE OF BREAKPOINTS AND ATTACHMENTS */
       15       15
       16       16        DDA$UPDATE: PROC ALTRET;

     16  2 000000   000000 700200 xent  DDA$UPDATE   TSX0  ! X66_AUTO_0
         2 000001   000374 000000                    ZERO    252,0

       17       17
       18       18        /* Includes */
       19       19        %INCLUDE CP_6;
       20      100        %INCLUDE XUH_MACRO_C;
       21      184        %INCLUDE DD_SD_M;
       22     1520        %S_D;
       23     2838        %INCLUDE DD_ERR_C;
       24     3235        %INCLUDE DD_PSUBS_C;
       25     3710        %INCLUDE DD_SUBS_C;
       26     3981        %INCLUDE DD$BASED;
       27     5284        %UPDATE$CMD(STCLASS="BASED(DO$)");
       28     5299        %FIXCOM(NAME="F$XCM");
       29     5315        %FIXCOM(NAME="SAVE_FIXCOM",STCLASS=AUTO);
       30     5331        %AT_FIRST;
       31     5359        %F$DCB;
       32     5416
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:33   
       33     5417        /* Local auto */
       34     5418    1   DCL DO$ PTR;
       35     5419    1   DCL SCMD$ PTR;
       36     5420    1   DCL BUF$ PTR;
       37     5421    1   DCL M$DELT$ PTR;
       38     5422    1   DCL TEXT$ PTR;
       39     5423    1   DCL FATT$ PTR;
       40     5424    1   DCL SCMD_TEXT$ PTR;
       41     5425    1   DCL NO_OF_ATTACHMENTS UBIN;
       42     5426    1   DCL SIZE UBIN;
       43     5427    1   DCL ATTACH_SIZE UBIN;
       44     5428    1   DCL SIZE_READ SBIN;
       45     5429    1   DCL IX UBIN;
       46     5430    1   DCL SCMD_SIZE UBIN;
       47     5431    1   DCL SAVE_SCMD_SIZE UBIN;
       48     5432    1   DCL SCMD_NO UBIN;
       49     5433    1   DCL ATTACHMENT_NO UBIN;
       50     5434    1   DCL CONTINUE BIT(1) ALIGNED;
       51     5435    1   DCL SET_ATTACH BIT(1) ALIGNED;
       52     5436    1   DCL ACT_CHAR CHAR(1) ALIGNED;
       53     5437    1   DCL SCMD$CHAR CHAR(2) CALIGNED;
       54     5438    1   DCL SAVE_SCMD_TEXT CHAR(260) CALIGNED;
       55     5439    1   DCL SAVE_VARCOM(0:100) UBIN WORD ALIGNED;
       56     5440    1   DCL SAVE_VARCOM_SIZE UBIN;
       57     5441    1   DCL CCMD UBIN;
       58     5442    1   DCL FPRG BIT(1) ALIGNED;
       59     5443
       60     5444        /* Based */
       61     5445    1   DCL BUFF$ER CHAR(SIZE) BASED(BUF$);
       62     5446    1   DCL 1 TEXT$C BASED(TEXT$),
       63     5447    1         2 SIZE UBIN(9) UNAL,
       64     5448    1         2 TEXT CHAR(TEXT$C.SIZE);
       65     5449    1   DCL SCMD$TEXT CHAR(SCMD_SIZE) BASED(SCMD_TEXT$);
       66     5450
       67     5451        /* Symref */
       68     5452    1   DCL D_M$DELT# UBIN SYMREF;
       69     5453        /* Fpt's - auto */
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:34   
       70     5454        %FPT_READ(FPTN=FPTREAD,
       71     5455                  STCLASS=);
       72     5494        %FPT_SINPUT(FPTN=FPTSINPUT,
       73     5495                    STCLASS=);
       74     5532
       75     5533        /* Constant */
       76     5534        %FPT_READ(FPTN=FPT_READ,
       77     5535                  STCLASS=CONSTANT);
       78     5574        %FPT_SINPUT(FPTN=FPT_SINPUT,
       79     5575                    STCLASS=CONSTANT);
       80     5612    1   DCL ACTABL (0:2) CHAR(1) UNAL CONSTANT
       81     5613    1        INIT( /* Type 0 */ BITASC('015'O), /* C/r */
       82     5614    1              /* Type 1 */ BITASC('012'O), /* L/f */
       83     5615    1                    /* Type 2 */ '^' );
       84     5616    1   DCL ACHARS REDEF ACTABL CHAR(3);
       85     5617
       86     5618        /* External routines */
       87     5619    1   DCL DDA$KILL1 ENTRY;
       88     5620    1   DCL DDA$SHOW1 ENTRY(2);
       89     5621    1   DCL DDQ$WRITE ENTRY(2);
       90     5622    1   DCL DDS$SCAN1 ENTRY ALTRET;
       91     5623    1   DCL DDE$ERROR ENTRY;
       92     5624    1   DCL DFA$KILL1 ENTRY(3);
       93     5625    1   DCL DFA$SET_AT ENTRY(3) ALTRET;
       94     5626    1   DCL DUE$ERRMSG ENTRY;
       95     5627        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:35   
       96     5628        /* Initialization */
       97     5629    1        BUF$ = ADDR(S_D.OUTPUT);

   5629  2 000002   000000 236000 xsym               LDQ     S_D$
         2 000003   005335 036003                    ADLQ    2781,DU
         2 000004   200013 756100                    STQ     BUF$,,AUTO

       98     5630    1        SIZE = LENGTHC(S_D.OUTPUT);

   5630  2 000005   004000 235007                    LDA     2048,DL
         2 000006   200021 755100                    STA     SIZE,,AUTO

       99     5631    1        BUFF$ER = ' ';

   5631  2 000007   200013 470500                    LDP0    BUF$,,AUTO
         2 000010   000000 620005                    EAX0    0,AL
         2 000011   040140 100400                    MLR     fill='040'O
         2 000012   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000013   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      100     5632    1        FPTREAD = FPT_READ;

   5632  2 000014   000100 100400                    MLR     fill='000'O
         2 000015   000000 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
         2 000016   200306 000070                    ADSC9   FPTREAD,,AUTO            cn=0,n=56

      101     5633    1        FPTREAD.V_ = VECTOR( FPTREAD.V );

   5633  2 000017   000000 235000 3                  LDA     0
         2 000020   200370 452500                    STP2    FATT$+2,,AUTO
         2 000021   200370 236100                    LDQ     FATT$+2,,AUTO
         2 000022   000316 036003                    ADLQ    206,DU
         2 000023   200306 757100                    STAQ    FPTREAD,,AUTO

      102     5634    1        FPTREAD.BUF_ = VECTOR( BUFF$ER );

   5634  2 000024   200021 235100                    LDA     SIZE,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:36   
         2 000025   000020 735000                    ALS     16
         2 000026   000140 135007                    SBLA    96,DL
         2 000027   200013 236100                    LDQ     BUF$,,AUTO
         2 000030   200312 757100                    STAQ    FPTREAD+4,,AUTO

      103     5635    1        FPTREAD.V.DCB# = D_M$DELT#;

   5635  2 000031   000000 720000 xsym               LXL0    D_M$DELT#
         2 000032   200316 740100                    STX0    FPTREAD+8,,AUTO

      104     5636    1        FPTREAD.V.DVBYTE.REREAD# = '1'B;

   5636  2 000033   100000 236003                    LDQ     32768,DU
         2 000034   200321 256100                    ORSQ    FPTREAD+11,,AUTO

      105     5637    1        FPTSINPUT = FPT_SINPUT;

   5637  2 000035   000100 100400                    MLR     fill='000'O
         2 000036   000016 000040 1                  ADSC9   FPT_SINPUT               cn=0,n=32
         2 000037   200324 000040                    ADSC9   FPTSINPUT,,AUTO          cn=0,n=32

      106     5638    1        FPTSINPUT.V_ = VECTOR( FPTSINPUT.V );

   5638  2 000040   000001 235000 3                  LDA     1
         2 000041   200370 452500                    STP2    FATT$+2,,AUTO
         2 000042   200370 236100                    LDQ     FATT$+2,,AUTO
         2 000043   000332 036003                    ADLQ    218,DU
         2 000044   200324 757100                    STAQ    FPTSINPUT,,AUTO

      107     5639    1        FPTSINPUT.BUF_ = VECTOR( BUFF$ER );

   5639  2 000045   200021 235100                    LDA     SIZE,,AUTO
         2 000046   000020 735000                    ALS     16
         2 000047   000140 135007                    SBLA    96,DL
         2 000050   200013 236100                    LDQ     BUF$,,AUTO
         2 000051   200330 757100                    STAQ    FPTSINPUT+4,,AUTO

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:37   
      108     5640    1        M$DELT$ = DCBADDR( D_M$DELT# );

   5640  2 000052   000002 470400 3                  LDP0    2
         2 000053   000000 471500                    LDP1    0,,PR0
         2 000054   100000 236110                    LDQ     0,X0,PR1
         2 000055   200014 756100                    STQ     M$DELT$,,AUTO

      109     5641    1        SET_ATTACH = '0'B;

   5641  2 000056   200032 450100                    STZ     SET_ATTACH,,AUTO

      110     5642    1        DO$ = S_D.DO$;

   5642  2 000057   000000 473400 xsym               LDP3    S_D$
         2 000060   300031 236100                    LDQ     25,,PR3
         2 000061   200011 756100                    STQ     DO$,,AUTO

      111     5643
      112     5644    2        DO CASE (UPDATE$CMD.UPDATE#);

   5644  2 000062   200011 474500                    LDP4    DO$,,AUTO
         2 000063   400000 236100                    LDQ     0,,PR4
         2 000064   177777 376007                    ANQ     65535,DL
         2 000065   001142 136007                    SBLQ    610,DL
         2 000066   000003 116007                    CMPQ    3,DL
         2 000067   000071 602006 2                  TNC     s:5644+7,QL
         2 000070   001216 710000 2                  TRA     RET
         2 000071   000074 710000 2                  TRA     s:5646
         2 000072   000456 710000 2                  TRA     s:5733
         2 000073   000713 710000 2                  TRA     s:5794

      113     5645    2          CASE ( 610 );              /* C@UPDATE1 */

      114     5646    2             IF UPDATE$CMD.ATTACH_AT_TIME

   5646  2 000074   400000 236100                    LDQ     0,,PR4
         2 000075   400000 316007                    CANQ    -131072,DL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:38   
         2 000076   000231 600000 2                  TZE     s:5677

      115     5647    3             THEN DO;

      116     5648    3                  SCMD_NO = UPDATE$CMD.ID_FROM;

   5648  2 000077   400001 236100                    LDQ     1,,PR4
         2 000100   000033 772000                    QRL     27
         2 000101   200027 756100                    STQ     SCMD_NO,,AUTO

      117     5649    3                  CONTINUE = '1'B;

   5649  2 000102   400000 236003                    LDQ     -131072,DU
         2 000103   200031 756100                    STQ     CONTINUE,,AUTO

      118     5650    4                  DO WHILE ((SCMD_NO > 0) AND (SCMD_NO <= 99)) AND CONTINUE;

   5650  2 000104   000222 710000 2                  TRA     s:5674

      119     5651                                                /* Point to stored directive */
      120     5652    4                       SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));

   5652  2 000105   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000106   000006 402003                    MPY     6,DU
         2 000107   001212 036003                    ADLQ    650,DU
         2 000110   000000 036000 xsym               ADLQ    S_D$
         2 000111   200012 756100                    STQ     SCMD$,,AUTO

      121     5653                                      /* Make sure stored directive is still around */
      122     5654    4                       IF SCMD$ -> F$XCM.CMD = 0

   5654  2 000112   200012 470500                    LDP0    SCMD$,,AUTO
         2 000113   000000 236100                    LDQ     0,,PR0
         2 000114   777000 316003                    CANQ    -512,DU
         2 000115   000130 601000 2                  TNZ     s:5662

      123     5655    5                       THEN DO;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:39   

      124     5656    5                            S_D.ERROR_HICHAR = SCMD_NO;

   5656  2 000116   000000 471400 xsym               LDP1    S_D$
         2 000117   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000120   104753 755100                    STA     2539,,PR1

      125     5657    5                            S_D.ERROR = 256; /* E@CANT_UPDATE */

   5657  2 000121   000400 236007                    LDQ     256,DL
         2 000122   100013 756100                    STQ     11,,PR1

      126     5658    5                            CALL DDE$ERROR;

   5658  2 000123   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000124   000000 701000 xent               TSX1    DDE$ERROR
         2 000125   000000 011000                    NOP     0

      127     5659    5                            CONTINUE = '0'B;

   5659  2 000126   200031 450100                    STZ     CONTINUE,,AUTO

      128     5660    5                          END;

   5660  2 000127   000222 710000 2                  TRA     s:5674

      129     5661    5                       ELSE DO;

      130     5662    5                            CALL BINCHAR (SCMD$CHAR, SCMD_NO);

   5662  2 000130   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000131   000044 773000                    LRL     36
         2 000132   200370 757100                    STAQ    FATT$+2,,AUTO
         2 000133   000100 301500                    BTD
         2 000134   200370 000010                    NDSC9   FATT$+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000135   200034 030002                    NDSC9   SCMD$CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=2

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:40   
      131     5663    5                            CALL CONCAT (S_D.OUTPUT, 'Stored Directive #', SCMD$CHAR);

   5663  2 000136   000000 471400 xsym               LDP1    S_D$
         2 000137   040100 100400                    MLR     fill='040'O
         2 000140   000027 000022 1                  ADSC9   ACTABL+1                 cn=0,n=18
         2 000141   105335 000022                    ADSC9   2781,,PR1                cn=0,n=18
         2 000142   040100 100500                    MLR     fill='040'O
         2 000143   200034 000002                    ADSC9   SCMD$CHAR,,AUTO          cn=0,n=2
         2 000144   105341 403756                    ADSC9   2785,,PR1                cn=2,n=2030

      132     5664    5                            CALL DDQ$WRITE (ADDR(S_D.OUTPUT), LENGTHC(
              5664                                     'Stored Directive #') + LENGTHC(SCMD$CHAR));

   5664  2 000145   000000 236000 xsym               LDQ     S_D$
         2 000146   005335 036003                    ADLQ    2781,DU
         2 000147   200370 756100                    STQ     FATT$+2,,AUTO
         2 000150   000004 236000 3                  LDQ     4
         2 000151   200373 756100                    STQ     FATT$+5,,AUTO
         2 000152   200370 630500                    EPPR0   FATT$+2,,AUTO
         2 000153   200372 450500                    STP0    FATT$+4,,AUTO
         2 000154   200372 630500                    EPPR0   FATT$+4,,AUTO
         2 000155   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000156   000000 701000 xent               TSX1    DDQ$WRITE
         2 000157   000000 011000                    NOP     0

      133     5665    5                            CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);

   5665  2 000160   200020 630500                    EPPR0   NO_OF_ATTACHMENTS,,AUTO
         2 000161   200343 450500                    STP0    CONTINUE+3,,AUTO
         2 000162   001236 701000 2                  TSX1    GET_NO_ATTACH
         2 000163   000000 011000                    NOP     0

      134     5666    5                            IF SET_ATTACH

   5666  2 000164   200032 234100                    SZN     SET_ATTACH,,AUTO
         2 000165   000175 605000 2                  TPL     s:5668

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:41   
      135     5667    5                            THEN CALL DO_ATTACHMENTS (NO_OF_ATTACHMENTS, IX) ALTRET (
              5667                                     ALT);

   5667  2 000166   200024 630500                    EPPR0   IX,,AUTO
         2 000167   200336 450500                    STP0    I+1,,AUTO
         2 000170   200020 631500                    EPPR1   NO_OF_ATTACHMENTS,,AUTO
         2 000171   200335 451500                    STP1    FPTSINPUT+9,,AUTO
         2 000172   002451 701000 2                  TSX1    DO_ATTACHMENTS
         2 000173   001235 702000 2                  TSX2    ALT
         2 000174   000203 710000 2                  TRA     s:5669

      136     5668    5                            ELSE CALL DO_ATTACHMENTS (0, IX) ALTRET (ALT);

   5668  2 000175   200024 630500                    EPPR0   IX,,AUTO
         2 000176   200336 450500                    STP0    I+1,,AUTO
         2 000177   000005 236000 3                  LDQ     5
         2 000200   200335 756100                    STQ     FPTSINPUT+9,,AUTO
         2 000201   002451 701000 2                  TSX1    DO_ATTACHMENTS
         2 000202   001235 702000 2                  TSX2    ALT

      137     5669    5                            IF NOT SET_ATTACH

   5669  2 000203   200032 234100                    SZN     SET_ATTACH,,AUTO
         2 000204   000210 604000 2                  TMI     s:5671

      138     5670    5                            THEN SCMD_NO = SCMD_NO + 1;

   5670  2 000205   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000206   000001 035007                    ADLA    1,DL
         2 000207   200027 755100                    STA     SCMD_NO,,AUTO

      139     5671    5                            IF (IX = 0) AND (SCMD_NO >= UPDATE$CMD.ID_TO)

   5671  2 000210   200024 235100                    LDA     IX,,AUTO
         2 000211   000222 601000 2                  TNZ     s:5674
         2 000212   200011 470500                    LDP0    DO$,,AUTO
         2 000213   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:42   
         2 000214   000022 772000                    QRL     18
         2 000215   000777 376007                    ANQ     511,DL
         2 000216   200027 116100                    CMPQ    SCMD_NO,,AUTO
         2 000217   000221 600000 2                  TZE     s:5672
         2 000220   000222 603000 2                  TRC     s:5674

      140     5672    5                            THEN CONTINUE = '0'B;

   5672  2 000221   200031 450100                    STZ     CONTINUE,,AUTO

      141     5673    5                          END;

      142     5674    4                     END;

   5674  2 000222   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000223   000230 600000 2                  TZE     s:5675
         2 000224   000144 115007                    CMPA    100,DL
         2 000225   000230 603000 2                  TRC     s:5675
         2 000226   200031 234100                    SZN     CONTINUE,,AUTO
         2 000227   000105 604000 2                  TMI     s:5652

      143     5675    3                END;

   5675  2 000230   001216 710000 2                  TRA     RET

      144     5676    3             ELSE DO;

      145     5677    3                  SCMD_NO = UPDATE$CMD.ID_FROM;

   5677  2 000231   400001 236100                    LDQ     1,,PR4
         2 000232   000033 772000                    QRL     27
         2 000233   200027 756100                    STQ     SCMD_NO,,AUTO

      146     5678    3                  CONTINUE = '1'B;

   5678  2 000234   400000 236003                    LDQ     -131072,DU
         2 000235   200031 756100                    STQ     CONTINUE,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:43   

      147     5679    4                  DO WHILE ((SCMD_NO > 0) AND (SCMD_NO <= 99)) AND CONTINUE;

   5679  2 000236   000447 710000 2                  TRA     s:5730

      148     5680                                                /* Point to stored directive */
      149     5681    4                       SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));

   5681  2 000237   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000240   000006 402003                    MPY     6,DU
         2 000241   001212 036003                    ADLQ    650,DU
         2 000242   000000 036000 xsym               ADLQ    S_D$
         2 000243   200012 756100                    STQ     SCMD$,,AUTO

      150     5682                                      /* Make sure stored directive is still around */
      151     5683    4                       IF SCMD$ -> F$XCM.CMD = 0

   5683  2 000244   200012 470500                    LDP0    SCMD$,,AUTO
         2 000245   000000 236100                    LDQ     0,,PR0
         2 000246   777000 316003                    CANQ    -512,DU
         2 000247   000262 601000 2                  TNZ     s:5692

      152     5684    5                       THEN DO;

      153     5685    5                            S_D.ERROR_HICHAR = SCMD_NO;

   5685  2 000250   000000 471400 xsym               LDP1    S_D$
         2 000251   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000252   104753 755100                    STA     2539,,PR1

      154     5686    5                            S_D.ERROR = 256; /* E@CANT_UPDATE */

   5686  2 000253   000400 236007                    LDQ     256,DL
         2 000254   100013 756100                    STQ     11,,PR1

      155     5687    5                            CALL DDE$ERROR;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:44   
   5687  2 000255   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000256   000000 701000 xent               TSX1    DDE$ERROR
         2 000257   000000 011000                    NOP     0

      156     5688    5                            CONTINUE = '0'B;

   5688  2 000260   200031 450100                    STZ     CONTINUE,,AUTO

      157     5689    5                          END;

   5689  2 000261   000447 710000 2                  TRA     s:5730

      158     5690    5                       ELSE DO;

      159     5691                                                /* Get size of stored directive */
      160     5692    5                            SCMD_SIZE = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI) ->
              5692                                     AT_FIRST.TEXT_SIZE;

   5692  2 000262   000002 720100                    LXL0    2,,PR0
         2 000263   000000 471400 xsym               LDP1    S_D$
         2 000264   104622 473500                    LDP3    2450,,PR1
         2 000265   300006 236110                    LDQ     6,X0,PR3
         2 000266   777777 376007                    ANQ     -1,DL
         2 000267   200025 756100                    STQ     SCMD_SIZE,,AUTO

      161     5693    5                            IF SCMD_SIZE > 256

   5693  2 000270   000401 116007                    CMPQ    257,DL
         2 000271   000306 602000 2                  TNC     s:5700

      162     5694    6                            THEN DO;

      163     5695    6                                 S_D.ERROR = 259; /* E@SCMD_GREATER256 */

   5695  2 000272   000403 235007                    LDA     259,DL
         2 000273   100013 755100                    STA     11,,PR1

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:45   
      164     5696    6                                 CALL DDE$ERROR;

   5696  2 000274   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000275   000000 701000 xent               TSX1    DDE$ERROR
         2 000276   000000 011000                    NOP     0

      165     5697    6                                 CALL DO_ATTACHMENTS (0, IX) ALTRET (ALT);

   5697  2 000277   200024 630500                    EPPR0   IX,,AUTO
         2 000300   200336 450500                    STP0    I+1,,AUTO
         2 000301   000005 236000 3                  LDQ     5
         2 000302   200335 756100                    STQ     FPTSINPUT+9,,AUTO
         2 000303   002451 701000 2                  TSX1    DO_ATTACHMENTS
         2 000304   001235 702000 2                  TSX2    ALT

      166     5698    6                               END;

   5698  2 000305   000447 710000 2                  TRA     s:5730

      167     5699    6                            ELSE DO;

      168     5700    6                                 BUFF$ER = ' ';

   5700  2 000306   200013 474500                    LDP4    BUF$,,AUTO
         2 000307   200021 720100                    LXL0    SIZE,,AUTO
         2 000310   040140 100400                    MLR     fill='040'O
         2 000311   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000312   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      169     5701    6                                 CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);

   5701  2 000313   200021 633500                    EPPR3   SIZE,,AUTO
         2 000314   200345 453500                    STP3    @BUF$+1,,AUTO
         2 000315   200013 634500                    EPPR4   BUF$,,AUTO
         2 000316   200344 454500                    STP4    @ATT#+1,,AUTO
         2 000317   200025 635500                    EPPR5   SCMD_SIZE,,AUTO
         2 000320   200343 455500                    STP5    CONTINUE+3,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:46   
         2 000321   001571 701000 2                  TSX1    GET_STORED_COMMAND
         2 000322   000000 011000                    NOP     0

      170     5702    6                                 CALL BINCHAR (SCMD$CHAR, SCMD_NO);

   5702  2 000323   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000324   000044 773000                    LRL     36
         2 000325   200370 757100                    STAQ    FATT$+2,,AUTO
         2 000326   000100 301500                    BTD
         2 000327   200370 000010                    NDSC9   FATT$+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000330   200034 030002                    NDSC9   SCMD$CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=2

      171     5703    6                                 CALL SAVE_SCMD;

   5703  2 000331   002676 701000 2                  TSX1    SAVE_SCMD
         2 000332   000000 011000                    NOP     0

      172     5704    6                                 FPTSINPUT.BUF_.BOUND = SCMD_SIZE - 1;

   5704  2 000333   200025 236100                    LDQ     SCMD_SIZE,,AUTO
         2 000334   000001 136007                    SBLQ    1,DL
         2 000335   000020 736000                    QLS     16
         2 000336   200330 676100                    ERQ     FPTSINPUT+4,,AUTO
         2 000337   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000340   200330 656100                    ERSQ    FPTSINPUT+4,,AUTO

      173     5705    6                                 CALL M$SINPUT (FPTSINPUT) ALTRET (ARET0);

   5705  2 000341   200324 630500                    EPPR0   FPTSINPUT,,AUTO
         2 000342   560013 713400                    CLIMB   alt,+57355
         2 000343   401000 401760                    pmme    nvectors=3
         2 000344   001217 702000 2                  TSX2    ARET0

      174     5706    6                                 CALL M$READ (FPTREAD) ALTRET (ARET0);

   5706  2 000345   200306 630500                    EPPR0   FPTREAD,,AUTO
         2 000346   440000 713400                    CLIMB   alt,read
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:47   
         2 000347   401400 401760                    pmme    nvectors=4
         2 000350   001217 702000 2                  TSX2    ARET0

      175     5707    6                                 SIZE_READ = M$DELT$ -> F$DCB.ARS#;

   5707  2 000351   200014 470500                    LDP0    M$DELT$,,AUTO
         2 000352   000000 235100                    LDA     0,,PR0
         2 000353   200023 755100                    STA     SIZE_READ,,AUTO

      176     5708    6                                 ACT_CHAR = M$DELT$ -> F$DCB.EOMCHAR#;

   5708  2 000354   000003 236100                    LDQ     3,,PR0
         2 000355   000033 736000                    QLS     27
         2 000356   000006 276000 3                  ORQ     6
         2 000357   200033 756100                    STQ     ACT_CHAR,,AUTO

      177     5709    6                                 CALL REPLACE_TEXT (0, BUF$, SIZE_READ, SCMD_NO, '1'B)
              5709                                          ALTRET (DELBUG);

   5709  2 000360   000007 236000 3                  LDQ     7
         2 000361   200347 756100                    STQ     @SCMD#+1,,AUTO
         2 000362   200027 631500                    EPPR1   SCMD_NO,,AUTO
         2 000363   200346 451500                    STP1    @TEXT_SIZE+1,,AUTO
         2 000364   200023 633500                    EPPR3   SIZE_READ,,AUTO
         2 000365   200345 453500                    STP3    @BUF$+1,,AUTO
         2 000366   200013 634500                    EPPR4   BUF$,,AUTO
         2 000367   200344 454500                    STP4    @ATT#+1,,AUTO
         2 000370   000005 236000 3                  LDQ     5
         2 000371   200343 756100                    STQ     CONTINUE+3,,AUTO
         2 000372   001606 701000 2                  TSX1    REPLACE_TEXT
         2 000373   001223 702000 2                  TSX2    DELBUG

      178     5710                                                /* Check activation character */
      179     5711    6                                 CALL INDEX (IX, ACT_CHAR, ACHARS) ALTRET (UNKACT1);

   5711  2 000374   000100 124400                    SCM     mask='000'O
         2 000375   000026 000003 1                  ADSC9   ACTABL                   cn=0,n=3
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:48   
         2 000376   200033 000001                    ADSC9   ACT_CHAR,,AUTO           cn=0,n=1
         2 000377   200024 000100                    ARG     IX,,AUTO
         2 000400   000402 606400 2                  TTN     UNKACT1

      180     5712    7                                 DO WHILE ('0'B);

   5712  2 000401   000404 710000 2                  TRA     s:5716

   5711  2 000402                       UNKACT1      null
      181     5713    7   UNKACT1:                           ;
      182     5714    7                                      IX = 3;

   5714  2 000402   000003 235007                    LDA     3,DL
         2 000403   200024 755100                    STA     IX,,AUTO

      183     5715    7                                    END;

      184     5716    7                                 DO CASE (IX);

   5716  2 000404   200024 235100                    LDA     IX,,AUTO
         2 000405   000003 115007                    CMPA    3,DL
         2 000406   000410 602005 2                  TNC     s:5716+4,AL
         2 000407   000436 710000 2                  TRA     s:5724
         2 000410   000413 710000 2                  TRA     s:5718
         2 000411   000413 710000 2                  TRA     s:5718
         2 000412   000432 710000 2                  TRA     s:5722

      185     5717    7                                   CASE (0,1); /* C/r, l/f */

      186     5718    7                                      IF (IX = 0) AND (SCMD_NO >= UPDATE$CMD.ID_TO)

   5718  2 000413   000000 115003                    CMPA    0,DU
         2 000414   000426 601000 2                  TNZ     s:5720
         2 000415   200011 470500                    LDP0    DO$,,AUTO
         2 000416   000001 236100                    LDQ     1,,PR0
         2 000417   000022 772000                    QRL     18
         2 000420   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:49   
         2 000421   200027 116100                    CMPQ    SCMD_NO,,AUTO
         2 000422   000424 600000 2                  TZE     s:5719
         2 000423   000426 603000 2                  TRC     s:5720

      187     5719    7                                      THEN CONTINUE = '0'B;

   5719  2 000424   200031 450100                    STZ     CONTINUE,,AUTO
         2 000425   000447 710000 2                  TRA     s:5730

      188     5720    7                                      ELSE SCMD_NO = SCMD_NO + 1;

   5720  2 000426   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000427   000001 036007                    ADLQ    1,DL
         2 000430   200027 756100                    STQ     SCMD_NO,,AUTO
         2 000431   000447 710000 2                  TRA     s:5730

      189     5721    7                                   CASE (2); /* ^ */

      190     5722    7                                      SCMD_NO = SCMD_NO - 1;

   5722  2 000432   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000433   000001 136007                    SBLQ    1,DL
         2 000434   200027 756100                    STQ     SCMD_NO,,AUTO
         2 000435   000447 710000 2                  TRA     s:5730

      191     5723    7                                   CASE (ELSE);

      192     5724    7                                      S_D.ERROR = 257; /* E@ACT_IGNORED_LF */

   5724  2 000436   000401 236007                    LDQ     257,DL
         2 000437   000000 470400 xsym               LDP0    S_D$
         2 000440   000013 756100                    STQ     11,,PR0

      193     5725    7                                      CALL DDE$ERROR;

   5725  2 000441   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000442   000000 701000 xent               TSX1    DDE$ERROR
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:50   
         2 000443   000000 011000                    NOP     0

      194     5726    7                                      SCMD_NO = SCMD_NO + 1;

   5726  2 000444   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000445   000001 035007                    ADLA    1,DL
         2 000446   200027 755100                    STA     SCMD_NO,,AUTO

      195     5727    7                                   END;

      196     5728    6                               END;

      197     5729    5                          END;

      198     5730    4                     END;

   5730  2 000447   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000450   000455 600000 2                  TZE     s:5731
         2 000451   000144 115007                    CMPA    100,DL
         2 000452   000455 603000 2                  TRC     s:5731
         2 000453   200031 234100                    SZN     CONTINUE,,AUTO
         2 000454   000237 604000 2                  TMI     s:5681

      199     5731    3                END;

   5731  2 000455   001216 710000 2                  TRA     RET

      200     5732    2          CASE ( 611 );              /* C@UPDATE2 */

      201     5733    2             CONTINUE = '1'B;

   5733  2 000456   400000 236003                    LDQ     -131072,DU
         2 000457   200031 756100                    STQ     CONTINUE,,AUTO

      202     5734    2             SCMD_NO = UPDATE$CMD.ID_FROM;

   5734  2 000460   400001 236100                    LDQ     1,,PR4
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:51   
         2 000461   000033 772000                    QRL     27
         2 000462   200027 756100                    STQ     SCMD_NO,,AUTO

      203     5735    2             ATTACHMENT_NO = UPDATE$CMD.ATTACHMENT#;

   5735  2 000463   400001 236100                    LDQ     1,,PR4
         2 000464   000011 772000                    QRL     9
         2 000465   000777 376007                    ANQ     511,DL
         2 000466   200030 756100                    STQ     ATTACHMENT_NO,,AUTO

      204     5736    3             DO WHILE (CONTINUE);

   5736  2 000467   200031 234100                    SZN     CONTINUE,,AUTO
         2 000470   001216 605000 2                  TPL     RET

      205     5737                                                /* Point to stored directive */
      206     5738    3                  SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));

   5738  2 000471   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000472   000006 402003                    MPY     6,DU
         2 000473   001212 036003                    ADLQ    650,DU
         2 000474   000000 036000 xsym               ADLQ    S_D$
         2 000475   200012 756100                    STQ     SCMD$,,AUTO

      207     5739                                      /* Make sure stored directive is still around */
      208     5740    3                  IF SCMD$ -> F$XCM.CMD = 0

   5740  2 000476   200012 470500                    LDP0    SCMD$,,AUTO
         2 000477   000000 236100                    LDQ     0,,PR0
         2 000500   777000 316003                    CANQ    -512,DU
         2 000501   000510 601000 2                  TNZ     s:5747

      209     5741    4                  THEN DO;

      210     5742    4                       S_D.ERROR_HICHAR = SCMD_NO;

   5742  2 000502   000000 471400 xsym               LDP1    S_D$
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:52   
         2 000503   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000504   104753 755100                    STA     2539,,PR1

      211     5743    4                       S_D.ERROR = 256; /* E@CANTUPDATE */

   5743  2 000505   000400 236007                    LDQ     256,DL
         2 000506   100013 756100                    STQ     11,,PR1

      212     5744    4                       GOTO ALT;

   5744  2 000507   001235 710000 2                  TRA     ALT

      213     5745    4                     END;
      214     5746    4                  ELSE DO;

      215     5747    4                       CALL BINCHAR (SCMD$CHAR, SCMD_NO);

   5747  2 000510   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000511   000044 773000                    LRL     36
         2 000512   200370 757100                    STAQ    FATT$+2,,AUTO
         2 000513   000100 301500                    BTD
         2 000514   200370 000010                    NDSC9   FATT$+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000515   200034 030002                    NDSC9   SCMD$CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=2

      216     5748    4                       CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);

   5748  2 000516   200021 631500                    EPPR1   SIZE,,AUTO
         2 000517   200345 451500                    STP1    @BUF$+1,,AUTO
         2 000520   200013 633500                    EPPR3   BUF$,,AUTO
         2 000521   200344 453500                    STP3    @ATT#+1,,AUTO
         2 000522   200025 634500                    EPPR4   SCMD_SIZE,,AUTO
         2 000523   200343 454500                    STP4    CONTINUE+3,,AUTO
         2 000524   001571 701000 2                  TSX1    GET_STORED_COMMAND
         2 000525   000000 011000                    NOP     0

      217     5749    4                       CALL SAVE_SCMD;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:53   
   5749  2 000526   002676 701000 2                  TSX1    SAVE_SCMD
         2 000527   000000 011000                    NOP     0

      218     5750    4                       CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);

   5750  2 000530   200020 630500                    EPPR0   NO_OF_ATTACHMENTS,,AUTO
         2 000531   200343 450500                    STP0    CONTINUE+3,,AUTO
         2 000532   001236 701000 2                  TSX1    GET_NO_ATTACH
         2 000533   000000 011000                    NOP     0

      219     5751    4                       BUFF$ER = ' ';

   5751  2 000534   200013 470500                    LDP0    BUF$,,AUTO
         2 000535   200021 720100                    LXL0    SIZE,,AUTO
         2 000536   040140 100400                    MLR     fill='040'O
         2 000537   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000540   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      220     5752    4                       CALL GET_ATTACHMENT (ATTACHMENT_NO, ATTACH_SIZE, BUF$, SIZE)
              5752                                ALTRET (NO_ATTACH);

   5752  2 000541   200021 630500                    EPPR0   SIZE,,AUTO
         2 000542   200346 450500                    STP0    @TEXT_SIZE+1,,AUTO
         2 000543   200013 631500                    EPPR1   BUF$,,AUTO
         2 000544   200345 451500                    STP1    @BUF$+1,,AUTO
         2 000545   200022 633500                    EPPR3   ATTACH_SIZE,,AUTO
         2 000546   200344 453500                    STP3    @ATT#+1,,AUTO
         2 000547   200030 634500                    EPPR4   ATTACHMENT_NO,,AUTO
         2 000550   200343 454500                    STP4    CONTINUE+3,,AUTO
         2 000551   001326 701000 2                  TSX1    GET_ATTACHMENT
         2 000552   001232 702000 2                  TSX2    NO_ATTACH

      221     5753    4                       FPTSINPUT.BUF_.BOUND = ATTACH_SIZE - 1;

   5753  2 000553   200022 236100                    LDQ     ATTACH_SIZE,,AUTO
         2 000554   000001 136007                    SBLQ    1,DL
         2 000555   000020 736000                    QLS     16
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:54   
         2 000556   200330 676100                    ERQ     FPTSINPUT+4,,AUTO
         2 000557   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000560   200330 656100                    ERSQ    FPTSINPUT+4,,AUTO

      222     5754    4                       CALL M$SINPUT (FPTSINPUT) ALTRET (ARET0);

   5754  2 000561   200324 630500                    EPPR0   FPTSINPUT,,AUTO
         2 000562   560013 713400                    CLIMB   alt,+57355
         2 000563   401000 401760                    pmme    nvectors=3
         2 000564   001217 702000 2                  TSX2    ARET0

      223     5755    4                       CALL M$READ (FPTREAD) ALTRET (ARET0);

   5755  2 000565   200306 630500                    EPPR0   FPTREAD,,AUTO
         2 000566   440000 713400                    CLIMB   alt,read
         2 000567   401400 401760                    pmme    nvectors=4
         2 000570   001217 702000 2                  TSX2    ARET0

      224     5756    4                       SIZE_READ = M$DELT$ -> F$DCB.ARS#;

   5756  2 000571   200014 470500                    LDP0    M$DELT$,,AUTO
         2 000572   000000 235100                    LDA     0,,PR0
         2 000573   200023 755100                    STA     SIZE_READ,,AUTO

      225     5757    4                       ACT_CHAR = M$DELT$ -> F$DCB.EOMCHAR#;

   5757  2 000574   000003 236100                    LDQ     3,,PR0
         2 000575   000033 736000                    QLS     27
         2 000576   000006 276000 3                  ORQ     6
         2 000577   200033 756100                    STQ     ACT_CHAR,,AUTO

      226     5758    4                      CALL REPLACE_TEXT (ATTACHMENT_NO, BUF$, SIZE_READ, SCMD_NO, '0'B
              5758                                ) ALTRET (DELBUG);

   5758  2 000600   000005 236000 3                  LDQ     5
         2 000601   200347 756100                    STQ     @SCMD#+1,,AUTO
         2 000602   200027 631500                    EPPR1   SCMD_NO,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:55   
         2 000603   200346 451500                    STP1    @TEXT_SIZE+1,,AUTO
         2 000604   200023 633500                    EPPR3   SIZE_READ,,AUTO
         2 000605   200345 453500                    STP3    @BUF$+1,,AUTO
         2 000606   200013 634500                    EPPR4   BUF$,,AUTO
         2 000607   200344 454500                    STP4    @ATT#+1,,AUTO
         2 000610   200030 635500                    EPPR5   ATTACHMENT_NO,,AUTO
         2 000611   200343 455500                    STP5    CONTINUE+3,,AUTO
         2 000612   001606 701000 2                  TSX1    REPLACE_TEXT
         2 000613   001223 702000 2                  TSX2    DELBUG

      227     5759                                                /* Check activation character */
      228     5760    4                       CALL INDEX (IX, ACT_CHAR, ACHARS) ALTRET (UNKACT2);

   5760  2 000614   000100 124400                    SCM     mask='000'O
         2 000615   000026 000003 1                  ADSC9   ACTABL                   cn=0,n=3
         2 000616   200033 000001                    ADSC9   ACT_CHAR,,AUTO           cn=0,n=1
         2 000617   200024 000100                    ARG     IX,,AUTO
         2 000620   000622 606400 2                  TTN     UNKACT2

      229     5761    5                       DO WHILE ('0'B);

   5761  2 000621   000624 710000 2                  TRA     s:5765

   5760  2 000622                       UNKACT2      null
      230     5762    5   UNKACT2:                 ;
      231     5763    5                            IX = 3;

   5763  2 000622   000003 235007                    LDA     3,DL
         2 000623   200024 755100                    STA     IX,,AUTO

      232     5764    5                          END;

      233     5765    5                       DO CASE (IX);

   5765  2 000624   200024 235100                    LDA     IX,,AUTO
         2 000625   000003 115007                    CMPA    3,DL
         2 000626   000630 602005 2                  TNC     s:5765+4,AL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:56   
         2 000627   000701 710000 2                  TRA     s:5787
         2 000630   000633 710000 2                  TRA     s:5767
         2 000631   000635 710000 2                  TRA     s:5769
         2 000632   000650 710000 2                  TRA     s:5776

      234     5766    5                         CASE (0);         /* C/r */

      235     5767    5                            CONTINUE = '0'B;

   5767  2 000633   200031 450100                    STZ     CONTINUE,,AUTO
         2 000634   000710 710000 2                  TRA     s:5792

      236     5768    5                         CASE (1);         /* L/f */

      237     5769    5                            ATTACHMENT_NO = ATTACHMENT_NO + 1;

   5769  2 000635   200030 236100                    LDQ     ATTACHMENT_NO,,AUTO
         2 000636   000001 036007                    ADLQ    1,DL
         2 000637   200030 756100                    STQ     ATTACHMENT_NO,,AUTO

      238     5770    5                            IF ATTACHMENT_NO > NO_OF_ATTACHMENTS

   5770  2 000640   200020 116100                    CMPQ    NO_OF_ATTACHMENTS,,AUTO
         2 000641   000710 602000 2                  TNC     s:5792
         2 000642   000710 600000 2                  TZE     s:5792

      239     5771    6                            THEN DO;

      240     5772    6                                 ATTACHMENT_NO = 0;

   5772  2 000643   200030 450100                    STZ     ATTACHMENT_NO,,AUTO

      241     5773    6                                 SCMD_NO = SCMD_NO +1;

   5773  2 000644   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000645   000001 036007                    ADLQ    1,DL
         2 000646   200027 756100                    STQ     SCMD_NO,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:57   

      242     5774    6                               END;

   5774  2 000647   000710 710000 2                  TRA     s:5792

      243     5775    5                         CASE (2);         /* ^ */

      244     5776    5                            IF (ATTACHMENT_NO = 0) AND (SCMD_NO ~=0)

   5776  2 000650   200030 236100                    LDQ     ATTACHMENT_NO,,AUTO
         2 000651   000672 601000 2                  TNZ     s:5783
         2 000652   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000653   000672 600000 2                  TZE     s:5783

      245     5777    6                            THEN DO;

      246     5778    6                                 SCMD_NO = SCMD_NO - 1;

   5778  2 000654   000001 135007                    SBLA    1,DL
         2 000655   200027 755100                    STA     SCMD_NO,,AUTO

      247     5779    6                                SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM
              5779                                          ));

   5779  2 000656   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000657   000006 402003                    MPY     6,DU
         2 000660   001212 036003                    ADLQ    650,DU
         2 000661   000000 036000 xsym               ADLQ    S_D$
         2 000662   200012 756100                    STQ     SCMD$,,AUTO

      248     5780    6                                 CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);

   5780  2 000663   200020 630500                    EPPR0   NO_OF_ATTACHMENTS,,AUTO
         2 000664   200343 450500                    STP0    CONTINUE+3,,AUTO
         2 000665   001236 701000 2                  TSX1    GET_NO_ATTACH
         2 000666   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:58   
      249     5781    6                                 ATTACHMENT_NO = NO_OF_ATTACHMENTS;

   5781  2 000667   200020 235100                    LDA     NO_OF_ATTACHMENTS,,AUTO
         2 000670   200030 755100                    STA     ATTACHMENT_NO,,AUTO

      250     5782    6                               END;

   5782  2 000671   000710 710000 2                  TRA     s:5792

      251     5783    5                            ELSE IF SCMD_NO = 0

   5783  2 000672   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000673   000676 601000 2                  TNZ     s:5785

      252     5784    5                                 THEN CONTINUE = '0'B;

   5784  2 000674   200031 450100                    STZ     CONTINUE,,AUTO
         2 000675   000710 710000 2                  TRA     s:5792

      253     5785    5                                 ELSE ATTACHMENT_NO = ATTACHMENT_NO - 1;

   5785  2 000676   000001 136007                    SBLQ    1,DL
         2 000677   200030 756100                    STQ     ATTACHMENT_NO,,AUTO
         2 000700   000710 710000 2                  TRA     s:5792

      254     5786    5                         CASE (ELSE);

      255     5787    5                            S_D.ERROR = 258; /* E@ACT_IGNORED_CR */

   5787  2 000701   000402 236007                    LDQ     258,DL
         2 000702   000000 470400 xsym               LDP0    S_D$
         2 000703   000013 756100                    STQ     11,,PR0

      256     5788    5                            CALL DDE$ERROR;

   5788  2 000704   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000705   000000 701000 xent               TSX1    DDE$ERROR
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:59   
         2 000706   000000 011000                    NOP     0

      257     5789    5                            CONTINUE = '0'B;

   5789  2 000707   200031 450100                    STZ     CONTINUE,,AUTO

      258     5790    5                         END;

      259     5791    4                     END;

      260     5792    3                END;

   5792  2 000710   200031 234100                    SZN     CONTINUE,,AUTO
         2 000711   000471 604000 2                  TMI     s:5738
         2 000712   001216 710000 2                  TRA     RET

      261     5793    2          CASE ( 612 );              /* C@UPDATE3 */

      262     5794    2             SCMD_NO = UPDATE$CMD.ID_FROM;

   5794  2 000713   400001 236100                    LDQ     1,,PR4
         2 000714   000033 772000                    QRL     27
         2 000715   200027 756100                    STQ     SCMD_NO,,AUTO

      263     5795    2             ATTACHMENT_NO = UPDATE$CMD.ATTACHMENT#;

   5795  2 000716   400001 236100                    LDQ     1,,PR4
         2 000717   000011 772000                    QRL     9
         2 000720   000777 376007                    ANQ     511,DL
         2 000721   200030 756100                    STQ     ATTACHMENT_NO,,AUTO

      264     5796                                                /* Point to stored directive */
      265     5797    2             SCMD$ = PINCRW(ADDR(S_D.FIXCOM), SCMD_NO * SIZEW(F$XCM));

   5797  2 000722   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 000723   000006 402003                    MPY     6,DU
         2 000724   001212 036003                    ADLQ    650,DU
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:60   
         2 000725   000000 036000 xsym               ADLQ    S_D$
         2 000726   200012 756100                    STQ     SCMD$,,AUTO

      266     5798                                      /* Make sure stored directive is still around */
      267     5799    2             IF SCMD$ -> F$XCM.CMD = 0

   5799  2 000727   200012 475500                    LDP5    SCMD$,,AUTO
         2 000730   500000 236100                    LDQ     0,,PR5
         2 000731   777000 316003                    CANQ    -512,DU
         2 000732   000740 601000 2                  TNZ     s:5805

      268     5800    3             THEN DO;

      269     5801    3                  S_D.ERROR_HICHAR = SCMD_NO;

   5801  2 000733   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000734   304753 755100                    STA     2539,,PR3

      270     5802    3                  S_D.ERROR = 256; /* E@CANT_UPDATE */

   5802  2 000735   000400 236007                    LDQ     256,DL
         2 000736   300013 756100                    STQ     11,,PR3

      271     5803    3                  GOTO ALT;

   5803  2 000737   001235 710000 2                  TRA     ALT

      272     5804    3                END;
      273     5805    2             CALL BINCHAR (SCMD$CHAR, SCMD_NO);

   5805  2 000740   200027 235100                    LDA     SCMD_NO,,AUTO
         2 000741   000044 773000                    LRL     36
         2 000742   200370 757100                    STAQ    FATT$+2,,AUTO
         2 000743   000100 301500                    BTD
         2 000744   200370 000010                    NDSC9   FATT$+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 000745   200034 030002                    NDSC9   SCMD$CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=2

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:61   
      274     5806    2             CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);

   5806  2 000746   200021 636500                    EPPR6   SIZE,,AUTO
         2 000747   200345 456500                    STP6    @BUF$+1,,AUTO
         2 000750   200013 637500                    EPPR7   BUF$,,AUTO
         2 000751   200344 457500                    STP7    @ATT#+1,,AUTO
         2 000752   200025 630500                    EPPR0   SCMD_SIZE,,AUTO
         2 000753   200343 450500                    STP0    CONTINUE+3,,AUTO
         2 000754   001571 701000 2                  TSX1    GET_STORED_COMMAND
         2 000755   000000 011000                    NOP     0

      275     5807    2             CALL SAVE_SCMD;

   5807  2 000756   002676 701000 2                  TSX1    SAVE_SCMD
         2 000757   000000 011000                    NOP     0

      276     5808    2             IF UPDATE$CMD.ATTACHMENT

   5808  2 000760   200011 470500                    LDP0    DO$,,AUTO
         2 000761   000000 236100                    LDQ     0,,PR0
         2 000762   200000 316007                    CANQ    65536,DL
         2 000763   001110 600000 2                  TZE     s:5839

      277     5809    3             THEN DO;

      278     5810    3                 CALL GET_ATTACHMENT (ATTACHMENT_NO, ATTACH_SIZE, BUF$, SIZE) ALTRET (
              5810                           NO_ATTACH);

   5810  2 000764   200021 631500                    EPPR1   SIZE,,AUTO
         2 000765   200346 451500                    STP1    @TEXT_SIZE+1,,AUTO
         2 000766   200013 633500                    EPPR3   BUF$,,AUTO
         2 000767   200345 453500                    STP3    @BUF$+1,,AUTO
         2 000770   200022 634500                    EPPR4   ATTACH_SIZE,,AUTO
         2 000771   200344 454500                    STP4    @ATT#+1,,AUTO
         2 000772   200030 635500                    EPPR5   ATTACHMENT_NO,,AUTO
         2 000773   200343 455500                    STP5    CONTINUE+3,,AUTO
         2 000774   001326 701000 2                  TSX1    GET_ATTACHMENT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:62   
         2 000775   001232 702000 2                  TSX2    NO_ATTACH

      279     5811    3                  TEXT$ = UPDATE$CMD.ASYM$;

   5811  2 000776   200011 470500                    LDP0    DO$,,AUTO
         2 000777   000002 236100                    LDQ     2,,PR0
         2 001000   200015 756100                    STQ     TEXT$,,AUTO

      280     5812    3                  IF (ATTACHMENT_NO = 0) AND (TEXT$C.SIZE = 0)

   5812  2 001001   200030 235100                    LDA     ATTACHMENT_NO,,AUTO
         2 001002   001064 601000 2                  TNZ     s:5832
         2 001003   200015 471500                    LDP1    TEXT$,,AUTO
         2 001004   000100 101500                    MRL     fill='000'O
         2 001005   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001006   200370 000004                    ADSC9   FATT$+2,,AUTO            cn=0,n=4
         2 001007   200370 236100                    LDQ     FATT$+2,,AUTO
         2 001010   000000 116003                    CMPQ    0,DU
         2 001011   001064 601000 2                  TNZ     s:5832

      281     5813    4                  THEN DO;

      282     5814    4                       S_D.KILL1 = SCMD_NO;

   5814  2 001012   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 001013   000000 473400 xsym               LDP3    S_D$
         2 001014   300063 756100                    STQ     51,,PR3

      283     5815    4                       CCMD = S_D.FIXCOM.CMD(SCMD_NO);

   5815  2 001015   000006 402007                    MPY     6,DL
         2 001016   301212 236106                    LDQ     650,QL,PR3
         2 001017   000033 772000                    QRL     27
         2 001020   200304 756100                    STQ     CCMD,,AUTO

      284     5816    4                       FPRG = S_D.FIXCOM.FPRG(SCMD_NO);

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:63   
   5816  2 001021   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 001022   000006 402007                    MPY     6,DL
         2 001023   301212 236106                    LDQ     650,QL,PR3
         2 001024   000020 736000                    QLS     16
         2 001025   400000 376003                    ANQ     -131072,DU
         2 001026   200305 756100                    STQ     FPRG,,AUTO

      285     5817    4                       IF FPRG

   5817  2 001027   200305 234100                    SZN     FPRG,,AUTO
         2 001030   001043 605000 2                  TPL     s:5820

      286     5818    4                       THEN CALL DFA$KILL1('1'B, CCMD, '1'B);

   5818  2 001031   000007 236000 3                  LDQ     7
         2 001032   200372 756100                    STQ     FATT$+4,,AUTO
         2 001033   200304 634500                    EPPR4   CCMD,,AUTO
         2 001034   200371 454500                    STP4    FATT$+3,,AUTO
         2 001035   200370 756100                    STQ     FATT$+2,,AUTO
         2 001036   200370 630500                    EPPR0   FATT$+2,,AUTO
         2 001037   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001040   000000 701000 xent               TSX1    DFA$KILL1
         2 001041   000000 011000                    NOP     0
         2 001042   001216 710000 2                  TRA     RET

      287     5819    5                       ELSE DO;

      288     5820    5                            IF CCMD = 30 /* C_OA */

   5820  2 001043   200304 235100                    LDA     CCMD,,AUTO
         2 001044   000036 115007                    CMPA    30,DL
         2 001045   001047 601000 2                  TNZ     s:5822

      289     5821    5                            THEN S_D.ONABORT = 0;

   5821  2 001046   304744 450100                    STZ     2532,,PR3

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:64   
      290     5822    5                            IF CCMD = 32 /* C_OE */

   5822  2 001047   000040 115007                    CMPA    32,DL
         2 001050   001052 601000 2                  TNZ     s:5824

      291     5823    5                            THEN S_D.ONEXIT = 0;

   5823  2 001051   304746 450100                    STZ     2534,,PR3

      292     5824    5                            IF CCMD = 53 /* C_ONCALLS */

   5824  2 001052   000065 115007                    CMPA    53,DL
         2 001053   001055 601000 2                  TNZ     s:5826

      293     5825    5                            THEN S_D.ONCALLS = 0;

   5825  2 001054   304745 450100                    STZ     2533,,PR3

      294     5826    5                            IF CCMD = 54 /* C_ONNODES */

   5826  2 001055   000066 115007                    CMPA    54,DL
         2 001056   001060 601000 2                  TNZ     s:5828

      295     5827    5                            THEN S_D.ONNODES = 0;

   5827  2 001057   304747 450100                    STZ     2535,,PR3

      296     5828    5                            CALL DDA$KILL1;

   5828  2 001060   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001061   000000 701000 xent               TSX1    DDA$KILL1
         2 001062   000000 011000                    NOP     0

      297     5829    5                          END;

      298     5830    4                     END;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:65   
   5830  2 001063   001216 710000 2                  TRA     RET

      299     5831    4                  ELSE DO;

      300     5832    4                       SCMD_TEXT$ = PINCRC(TEXT$, 1);

   5832  2 001064   200015 236100                    LDQ     TEXT$,,AUTO
         2 001065   200000 036007                    ADLQ    65536,DL
         2 001066   200017 756100                    STQ     SCMD_TEXT$,,AUTO

      301     5833    4                       SCMD_SIZE = TEXT$C.SIZE;

   5833  2 001067   200015 471500                    LDP1    TEXT$,,AUTO
         2 001070   000100 101500                    MRL     fill='000'O
         2 001071   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001072   200025 000004                    ADSC9   SCMD_SIZE,,AUTO          cn=0,n=4

      302     5834    4                      CALL REPLACE_TEXT (ATTACHMENT_NO, SCMD_TEXT$, SCMD_SIZE, SCMD_NO
              5834                                , '0'B) ALTRET (DELBUG);

   5834  2 001073   000005 236000 3                  LDQ     5
         2 001074   200347 756100                    STQ     @SCMD#+1,,AUTO
         2 001075   200027 633500                    EPPR3   SCMD_NO,,AUTO
         2 001076   200346 453500                    STP3    @TEXT_SIZE+1,,AUTO
         2 001077   200025 634500                    EPPR4   SCMD_SIZE,,AUTO
         2 001100   200345 454500                    STP4    @BUF$+1,,AUTO
         2 001101   200017 635500                    EPPR5   SCMD_TEXT$,,AUTO
         2 001102   200344 455500                    STP5    @ATT#+1,,AUTO
         2 001103   200030 636500                    EPPR6   ATTACHMENT_NO,,AUTO
         2 001104   200343 456500                    STP6    CONTINUE+3,,AUTO
         2 001105   001606 701000 2                  TSX1    REPLACE_TEXT
         2 001106   001223 702000 2                  TSX2    DELBUG

      303     5835    4                     END;

      304     5836    3                END;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:66   
   5836  2 001107   001216 710000 2                  TRA     RET

      305     5837    3             ELSE DO;

      306     5838                                                /* Point to text of stored directive */
      307     5839    3                  FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);

   5839  2 001110   200012 471500                    LDP1    SCMD$,,AUTO
         2 001111   100002 720100                    LXL0    2,,PR1
         2 001112   000000 473400 xsym               LDP3    S_D$
         2 001113   304622 474500                    LDP4    2450,,PR3
         2 001114   400000 635510                    EPPR5   0,X0,PR4
         2 001115   200016 455500                    STP5    FATT$,,AUTO

      308     5840    3                  SCMD_TEXT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);

   5840  2 001116   500006 236100                    LDQ     6,,PR5
         2 001117   000022 772000                    QRL     18
         2 001120   000020 736000                    QLS     16
         2 001121   200016 036100                    ADLQ    FATT$,,AUTO
         2 001122   200017 756100                    STQ     SCMD_TEXT$,,AUTO

      309     5841    3                  SCMD_SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;

   5841  2 001123   500006 236100                    LDQ     6,,PR5
         2 001124   777777 376007                    ANQ     -1,DL
         2 001125   200025 756100                    STQ     SCMD_SIZE,,AUTO

      310     5842    3                  CALL CONCAT (BUFF$ER, SUBSTR(SCMD$TEXT, 0, SCMD_SIZE), ';',

   5842  2 001126   000002 476500                    LDP6    2,,PR0
         2 001127   000100 101500                    MRL     fill='000'O
         2 001130   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         2 001131   200370 000002                    ADSC9   FATT$+2,,AUTO            cn=0,n=2
         2 001132   200370 220100                    LDX0    FATT$+2,,AUTO
         2 001133   000002 477500                    LDP7    2,,PR0
         2 001134   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:67   
         2 001135   700000 000001                    ADSC9   0,,PR7                   cn=0,n=1
         2 001136   200371 000002                    ADSC9   FATT$+3,,AUTO            cn=0,n=2
         2 001137   200371 221100                    LDX1    FATT$+3,,AUTO
         2 001140   777777 622011                    EAX2    -1,X1
         2 001141   200017 477500                    LDP7    SCMD_TEXT$,,AUTO
         2 001142   000000 623006                    EAX3    0,QL
         2 001143   200013 470500                    LDP0    BUF$,,AUTO
         2 001144   200021 724100                    LXL4    SIZE,,AUTO
         2 001145   040140 100540                    MLR     fill='040'O
         2 001146   700000 000013                    ADSC9   0,,PR7                   cn=0,n=*X3
         2 001147   000000 000014                    ADSC9   0,,PR0                   cn=0,n=*X4
         2 001150   200021 236100                    LDQ     SIZE,,AUTO
         2 001151   200025 136100                    SBLQ    SCMD_SIZE,,AUTO
         2 001152   001171 604400 2                  TMOZ    s:5844
         2 001153   200013 470500                    LDP0    BUF$,,AUTO
         2 001154   000000 623006                    EAX3    0,QL
         2 001155   200025 235100                    LDA     SCMD_SIZE,,AUTO
         2 001156   040145 100400                    MLR     fill='040'O
         2 001157   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 001160   000000 000013                    ADSC9   0,A,PR0                  cn=0,n=*X3
         2 001161   000001 116007                    CMPQ    1,DL
         2 001162   001171 604400 2                  TMOZ    s:5844
         2 001163   777777 623006                    EAX3    -1,QL
         2 001164   200013 470500                    LDP0    BUF$,,AUTO
         2 001165   200025 235100                    LDA     SCMD_SIZE,,AUTO
         2 001166   040145 100540                    MLR     fill='040'O
         2 001167   600000 200012                    ADSC9   0,,PR6                   cn=1,n=*X2
         2 001170   000000 200013                    ADSC9   0,A,PR0                  cn=1,n=*X3

      311     5843    3                    SUBSTR(UPDATE$CMD.ASYM$ -> TEXT$C.TEXT, 0, UPDATE$CMD.ASYM$ ->
              5843                             TEXT$C.SIZE - 1));
      312     5844    3                  SCMD_SIZE = SCMD_SIZE + LENGTHC(';') + UPDATE$CMD.ASYM$ -> TEXT$C.
              5844                           SIZE;

   5844  2 001171   200011 470500                    LDP0    DO$,,AUTO
         2 001172   000002 474500                    LDP4    2,,PR0
         2 001173   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:68   
         2 001174   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 001175   200370 000004                    ADSC9   FATT$+2,,AUTO            cn=0,n=4
         2 001176   200370 236100                    LDQ     FATT$+2,,AUTO
         2 001177   200025 036100                    ADLQ    SCMD_SIZE,,AUTO
         2 001200   000001 036007                    ADLQ    1,DL
         2 001201   200025 756100                    STQ     SCMD_SIZE,,AUTO

      313     5845    3                  CALL REPLACE_TEXT (ATTACHMENT_NO, BUF$, SCMD_SIZE, SCMD_NO, '1'B)
              5845                           ALTRET (DELBUG);

   5845  2 001202   000007 236000 3                  LDQ     7
         2 001203   200347 756100                    STQ     @SCMD#+1,,AUTO
         2 001204   200027 634500                    EPPR4   SCMD_NO,,AUTO
         2 001205   200346 454500                    STP4    @TEXT_SIZE+1,,AUTO
         2 001206   200025 636500                    EPPR6   SCMD_SIZE,,AUTO
         2 001207   200345 456500                    STP6    @BUF$+1,,AUTO
         2 001210   200013 637500                    EPPR7   BUF$,,AUTO
         2 001211   200344 457500                    STP7    @ATT#+1,,AUTO
         2 001212   200030 630500                    EPPR0   ATTACHMENT_NO,,AUTO
         2 001213   200343 450500                    STP0    CONTINUE+3,,AUTO
         2 001214   001606 701000 2                  TSX1    REPLACE_TEXT
         2 001215   001223 702000 2                  TSX2    DELBUG

      314     5846    3                END;

      315     5847    2          END;

      316     5848
      317     5849    1   RET: RETURN;

   5849  2 001216   000000 702200 xent  RET          TSX2  ! X66_ARET

      318     5850
      319     5851    1   ARET0: CALL DUE$ERRMSG;

   5851  2 001217   000002 631400 xsym  ARET0        EPPR1   B_VECTNIL+2
         2 001220   000000 701000 xent               TSX1    DUE$ERRMSG
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:69   
         2 001221   000000 011000                    NOP     0

      320     5852    1        GOTO RET;

   5852  2 001222   001216 710000 2                  TRA     RET

      321     5853    1   DELBUG: S_D.ERROR = 502;           /* E@DELBUG */

   5853  2 001223   000766 235007       DELBUG       LDA     502,DL
         2 001224   000000 470400 xsym               LDP0    S_D$
         2 001225   000013 755100                    STA     11,,PR0

      322     5854    1        CALL DDE$ERROR;

   5854  2 001226   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001227   000000 701000 xent               TSX1    DDE$ERROR
         2 001230   000000 011000                    NOP     0

      323     5855    1        GOTO RET;

   5855  2 001231   001216 710000 2                  TRA     RET

      324     5856    1   NO_ATTACH: S_D.ERROR = 260; /* E@NO_ATTACHMENT */

   5856  2 001232   000404 235007       NO_ATTACH    LDA     260,DL
         2 001233   000000 470400 xsym               LDP0    S_D$
         2 001234   000013 755100                    STA     11,,PR0

      325     5857
      326     5858    1   ALT: ALTRETURN;

   5858  2 001235   000000 702200 xent  ALT          TSX2  ! X66_AALT

      327     5859
      328     5860        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:70   
      329     5861        /*D* NAME:    GET_NO_ATTACH
      330     5862             CALL:    CALL GET_NO_ATTACH (ATT#);
      331     5863             INPUT:   SCMD$ POINTS TO STORED DIRECTIVE
      332     5864             OUTPUT:  ATT# IS THE NUMBER OF ATTACHMENTS STORED DIRECTIVE HAS
      333     5865             SCRATCH: LOCAL AUTO
      334     5866             DESCRIPTION:  RETURN THE NUMBER OF ATTACHMENTS STORED DIRECTIVE
      335     5867                      HAS.  ZERO MEANS NO ATTACHMENTS.                */
      336     5868
      337     5869    1   GET_NO_ATTACH: PROC (ATT#);

   5869  2 001236   200342 741300       GET_NO_ATTA* STX1  ! CONTINUE+2,,AUTO

      338     5870
      339     5871        /* Parameters */
      340     5872    2   DCL ATT# UBIN;
      341     5873
      342     5874        /* Auto */
      343     5875    2   DCL FATT$ PTR;
      344     5876    2   DCL ATT$ PTR;
      345     5877    2   DCL ATT_SIZE UBIN;
      346     5878    2   DCL START UBIN;
      347     5879    2   DCL SEMI_POSITION UBIN;
      348     5880    2   DCL GOT_SEMI BIT(1) ALIGNED;
      349     5881
      350     5882        /* Based */
      351     5883    2   DCL CHAR$ATT CHAR(ATT_SIZE) BASED;
      352     5884
      353     5885                                 /* Point to first attachment of stored directive */
      354     5886    2        FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);

   5886  2 001237   200012 470500                    LDP0    SCMD$,,AUTO
         2 001240   000002 720100                    LXL0    2,,PR0
         2 001241   000000 471400 xsym               LDP1    S_D$
         2 001242   104622 473500                    LDP3    2450,,PR1
         2 001243   300000 634510                    EPPR4   0,X0,PR3
         2 001244   200344 454500                    STP4    FATT$,,AUTO

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:71   
      355     5887    2        IF FATT$ -> AT_FIRST.ATT_OFFSET = 0

   5887  2 001245   400007 222100                    LDX2    7,,PR4
         2 001246   001252 601000 2                  TNZ     s:5890

      356     5888    2        THEN ATT# = 0;                     /* No attachments */

   5888  2 001247   200343 475500                    LDP5    @ATT#,,AUTO
         2 001250   500000 450100                    STZ     0,,PR5
         2 001251   001324 710000 2                  TRA     s:5906

      357     5889    3        ELSE DO;                           /* Count number of attachments */

      358     5890    3             ATT# = 1;

   5890  2 001252   000001 235007                    LDA     1,DL
         2 001253   200343 475500                    LDP5    @ATT#,,AUTO
         2 001254   500000 755100                    STA     0,,PR5

      359     5891    3             ATT_SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;

   5891  2 001255   400006 236100                    LDQ     6,,PR4
         2 001256   777777 376007                    ANQ     -1,DL
         2 001257   200346 756100                    STQ     ATT_SIZE,,AUTO

      360     5892                                                /* Point to text of stored directive */
      361     5893    3             ATT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);

   5893  2 001260   400006 236100                    LDQ     6,,PR4
         2 001261   000022 772000                    QRL     18
         2 001262   000020 736000                    QLS     16
         2 001263   200344 036100                    ADLQ    FATT$,,AUTO
         2 001264   200345 756100                    STQ     ATT$,,AUTO

      362     5894    3             START = FATT$ -> AT_FIRST.ATT_OFFSET;

   5894  2 001265   400007 236100                    LDQ     7,,PR4
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:72   
         2 001266   000022 772000                    QRL     18
         2 001267   200347 756100                    STQ     START,,AUTO

      363     5895    3             GOT_SEMI = '1'B;

   5895  2 001270   400000 236003                    LDQ     -131072,DU
         2 001271   200351 756100                    STQ     GOT_SEMI,,AUTO

      364     5896    4             DO WHILE (GOT_SEMI);

   5896  2 001272   200351 234100                    SZN     GOT_SEMI,,AUTO
         2 001273   001324 605000 2                  TPL     s:5906

      365     5897    4                  CALL INDEX (SEMI_POSITION, ';', ATT$ -> CHAR$ATT, START) ALTRET (
              5897                           NO_SEMI);

   5897  2 001274   200346 236100                    LDQ     ATT_SIZE,,AUTO
         2 001275   200347 136100                    SBLQ    START,,AUTO
         2 001276   200370 756100                    STQ     FATT$+2,,AUTO
         2 001277   200347 236100                    LDQ     START,,AUTO
         2 001300   200345 470500                    LDP0    ATT$,,AUTO
         2 001301   200370 720100                    LXL0    FATT$+2,,AUTO
         2 001302   200347 235100                    LDA     START,,AUTO
         2 001303   000000 124545                    SCM     mask='000'O
         2 001304   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 001305   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 001306   200350 000100                    ARG     SEMI_POSITION,,AUTO
         2 001307   200350 056100                    ASQ     SEMI_POSITION,,AUTO
         2 001310   001321 606400 2                  TTN     NO_SEMI

      366     5898    4                  ATT# = ATT# + 1;

   5898  2 001311   200343 471500                    LDP1    @ATT#,,AUTO
         2 001312   100000 235100                    LDA     0,,PR1
         2 001313   000001 035007                    ADLA    1,DL
         2 001314   100000 755100                    STA     0,,PR1

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:73   
      367     5899    4                  START = SEMI_POSITION + 1;

   5899  2 001315   200350 236100                    LDQ     SEMI_POSITION,,AUTO
         2 001316   000001 036007                    ADLQ    1,DL
         2 001317   200347 756100                    STQ     START,,AUTO

      368     5900    5                  DO WHILE ('0'B);

   5900  2 001320   001322 710000 2                  TRA     s:5903

      369     5901    5   NO_SEMI:            GOT_SEMI = '0'B;

   5901  2 001321   200351 450100       NO_SEMI      STZ     GOT_SEMI,,AUTO

      370     5902    5                     END;

      371     5903    4                END;

   5903  2 001322   200351 234100                    SZN     GOT_SEMI,,AUTO
         2 001323   001274 604000 2                  TMI     s:5897

      372     5904    3           END;

      373     5905
      374     5906    2        RETURN;

   5906  2 001324   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 001325   000001 702211                    TSX2  ! 1,X1

      375     5907
      376     5908    2   END GET_NO_ATTACH;
      377     5909        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:74   
      378     5910        /*D* NAME:     GET_ATTACHMENT
      379     5911             CALL:     CALL GET_ATTACHMENT (ATT#, ATT_SIZE, BUF$, BUF_SIZE) ALTRET (ERROR);
      380     5912             INPUT:    ATT# IS ATTACHMENT NUMBER WANT TEXT OF
      381     5913                       BUF$ IS POINTER TO BUFFER WHERE TEXT SHOULD BE PLACED
      382     5914                       BUF_SIZE IS SIZE OF BUFFER POINTED TO BY BUF$
      383     5915                       SCMD$ POINTS TO STORED DIRECTIVE
      384     5916             OUTPUT:   ATT_SIZE IS SIZE OF TEXT OF ATTACHMENT
      385     5917             SCRATCH:  LOCAL AUTO
      386     5918             DESCRIPTION:  GET ATT# OF STORED COMMMAND POINTED TO BY SCMD$.
      387     5919                       PUT THE TEXT IN THE BUFFER POINTED TO BY BUF$ AND
      388     5920                       SIZE OF THE TEXT IS RETURNED IN ATT_SIZE.             */
      389     5921
      390     5922    1   GET_ATTACHMENT: PROC (ATT#, ATT_SIZE, BUF$, BUF_SIZE) ALTRET;

   5922  2 001326   200342 741300       GET_ATTACHM* STX1  ! CONTINUE+2,,AUTO

      391     5923
      392     5924        /* Paramenters */
      393     5925    2   DCL ATT# UBIN;
      394     5926    2   DCL ATT_SIZE UBIN;
      395     5927    2   DCL BUF$ PTR;
      396     5928    2   DCL BUF_SIZE UBIN;
      397     5929
      398     5930        /* Auto */
      399     5931    2   DCL FATT$ PTR;
      400     5932    2   DCL TEXT$ PTR;
      401     5933    2   DCL K SBIN;
      402     5934    2   DCL START UBIN;
      403     5935    2   DCL SEMI_POSITION SBIN;
      404     5936    2   DCL POSITION UBIN;
      405     5937    2   DCL SIZE UBIN;
      406     5938
      407     5939        /* Based */
      408     5940    2   DCL TEXT$ATT CHAR(BUF_SIZE) BASED(BUF$);
      409     5941    2   DCL CHAR$ATT CHAR(SIZE) BASED;
      410     5942
      411     5943                                 /* Point to first attachment of stored directive */
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:75   
      412     5944    2        FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);

   5944  2 001327   200012 470500                    LDP0    SCMD$,,AUTO
         2 001330   000002 720100                    LXL0    2,,PR0
         2 001331   000000 471400 xsym               LDP1    S_D$
         2 001332   104622 473500                    LDP3    2450,,PR1
         2 001333   300000 634510                    EPPR4   0,X0,PR3
         2 001334   200347 454500                    STP4    FATT$,,AUTO

      413     5945                                                /* Point to text of stored directive */
      414     5946    2        TEXT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);

   5946  2 001335   400006 236100                    LDQ     6,,PR4
         2 001336   000022 772000                    QRL     18
         2 001337   000020 736000                    QLS     16
         2 001340   200347 036100                    ADLQ    FATT$,,AUTO
         2 001341   200350 756100                    STQ     TEXT$,,AUTO

      415     5947    2        SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;

   5947  2 001342   400006 236100                    LDQ     6,,PR4
         2 001343   777777 376007                    ANQ     -1,DL
         2 001344   200355 756100                    STQ     SIZE,,AUTO

      416     5948    2        SEMI_POSITION = -1;

   5948  2 001345   000001 335007                    LCA     1,DL
         2 001346   200353 755100                    STA     SEMI_POSITION,,AUTO

      417     5949    2        K = -1;

   5949  2 001347   200351 755100                    STA     K,,AUTO

      418     5950    3        DO UNTIL (K = ATT#);

      419     5951    3             K = K + 1;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:76   
   5951  2 001350   200351 054100                    AOS     K,,AUTO

      420     5952    3             START = SEMI_POSITION + 1;

   5952  2 001351   200353 235100                    LDA     SEMI_POSITION,,AUTO
         2 001352   000001 035007                    ADLA    1,DL
         2 001353   200352 755100                    STA     START,,AUTO

      421     5953    3            CALL INDEX (SEMI_POSITION, ';', TEXT$ -> CHAR$ATT, START) ALTRET (NO_SEMI)
              5953                      ;

   5953  2 001354   200355 236100                    LDQ     SIZE,,AUTO
         2 001355   200352 136100                    SBLQ    START,,AUTO
         2 001356   200370 756100                    STQ     FATT$+2,,AUTO
         2 001357   200352 236100                    LDQ     START,,AUTO
         2 001360   200350 470500                    LDP0    TEXT$,,AUTO
         2 001361   200370 720100                    LXL0    FATT$+2,,AUTO
         2 001362   000000 124545                    SCM     mask='000'O
         2 001363   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 001364   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 001365   200353 000100                    ARG     SEMI_POSITION,,AUTO
         2 001366   200353 056100                    ASQ     SEMI_POSITION,,AUTO
         2 001367   001465 606400 2                  TTN     NO_SEMI

      422     5954    3           END;

   5954  2 001370   200343 471500                    LDP1    @ATT#,,AUTO
         2 001371   200351 236100                    LDQ     K,,AUTO
         2 001372   001350 604000 2                  TMI     s:5951
         2 001373   100000 116100                    CMPQ    0,,PR1
         2 001374   001350 601000 2                  TNZ     s:5951

      423     5955    2        IF K = 0

   5955  2 001375   000000 116003                    CMPQ    0,DU
         2 001376   001450 601000 2                  TNZ     s:5970

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:77   
      424     5956    3        THEN DO;

      425     5957    3             CALL INDEX (POSITION, SUBSTR(TEXT$ -> CHAR$ATT, 0, 1), '0123456789', 0);

   5957  2 001377   000100 124400                    SCM     mask='000'O
         2 001400   000034 000012 1                  ADSC9   ACTABL+6                 cn=0,n=10
         2 001401   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 001402   200354 000100                    ARG     POSITION,,AUTO

      426     5958    3             IF POSITION = LENGTHC('0123456789')

   5958  2 001403   200354 235100                    LDA     POSITION,,AUTO
         2 001404   000012 115007                    CMPA    10,DL
         2 001405   001424 601000 2                  TNZ     s:5964

      427     5959    4             THEN DO;

      428     5960    4                  ATT_SIZE = SEMI_POSITION - START;

   5960  2 001406   200353 236100                    LDQ     SEMI_POSITION,,AUTO
         2 001407   200352 136100                    SBLQ    START,,AUTO
         2 001410   200344 473500                    LDP3    @ATT_SIZE,,AUTO
         2 001411   300000 756100                    STQ     0,,PR3

      429     5961    4                  TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);

   5961  2 001412   200345 474500                    LDP4    @BUF$,,AUTO
         2 001413   400000 475500                    LDP5    0,,PR4
         2 001414   200346 476500                    LDP6    @BUF_SIZE,,AUTO
         2 001415   600000 720100                    LXL0    0,,PR6
         2 001416   300000 721100                    LXL1    0,,PR3
         2 001417   200352 235100                    LDA     START,,AUTO
         2 001420   040140 100545                    MLR     fill='040'O
         2 001421   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         2 001422   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0

      430     5962    4                END;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:78   

   5962  2 001423   001464 710000 2                  TRA     s:5973

      431     5963    4             ELSE DO;

      432     5964    4                  CALL INDEX (POSITION, ' ', TEXT$ -> CHAR$ATT, 0);

   5964  2 001424   200355 720100                    LXL0    SIZE,,AUTO
         2 001425   000000 124540                    SCM     mask='000'O
         2 001426   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 001427   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001430   200354 000100                    ARG     POSITION,,AUTO

      433     5965    4                  ATT_SIZE = SEMI_POSITION - (POSITION + 1);

   5965  2 001431   200353 236100                    LDQ     SEMI_POSITION,,AUTO
         2 001432   200354 136100                    SBLQ    POSITION,,AUTO
         2 001433   000001 136007                    SBLQ    1,DL
         2 001434   200344 473500                    LDP3    @ATT_SIZE,,AUTO
         2 001435   300000 756100                    STQ     0,,PR3

      434     5966    4                  TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, POSITION + 1, ATT_SIZE);

   5966  2 001436   200345 474500                    LDP4    @BUF$,,AUTO
         2 001437   400000 475500                    LDP5    0,,PR4
         2 001440   200346 476500                    LDP6    @BUF_SIZE,,AUTO
         2 001441   600000 721100                    LXL1    0,,PR6
         2 001442   300000 722100                    LXL2    0,,PR3
         2 001443   200354 235100                    LDA     POSITION,,AUTO
         2 001444   040140 100545                    MLR     fill='040'O
         2 001445   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2
         2 001446   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1

      435     5967    4                END;

      436     5968    3           END;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:79   
   5968  2 001447   001464 710000 2                  TRA     s:5973

      437     5969    3        ELSE DO;

      438     5970    3             ATT_SIZE = SEMI_POSITION - START;

   5970  2 001450   200353 236100                    LDQ     SEMI_POSITION,,AUTO
         2 001451   200352 136100                    SBLQ    START,,AUTO
         2 001452   200344 473500                    LDP3    @ATT_SIZE,,AUTO
         2 001453   300000 756100                    STQ     0,,PR3

      439     5971    3             TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);

   5971  2 001454   200345 474500                    LDP4    @BUF$,,AUTO
         2 001455   400000 475500                    LDP5    0,,PR4
         2 001456   200346 476500                    LDP6    @BUF_SIZE,,AUTO
         2 001457   600000 720100                    LXL0    0,,PR6
         2 001460   300000 721100                    LXL1    0,,PR3
         2 001461   040140 100545                    MLR     fill='040'O
         2 001462   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         2 001463   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0

      440     5972    3           END;

      441     5973    3        DO WHILE ('0'B);

   5973  2 001464   001567 710000 2                  TRA     s:5999

   5969  2 001465                       NO_SEMI      null
      442     5974    3   NO_SEMI:  ;
      443     5975    3             IF K = ATT#

   5975  2 001465   200343 470500                    LDP0    @ATT#,,AUTO
         2 001466   200351 236100                    LDQ     K,,AUTO
         2 001467   001565 604000 2                  TMI     s:5996
         2 001470   000000 116100                    CMPQ    0,,PR0
         2 001471   001565 601000 2                  TNZ     s:5996
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:80   

      444     5976    4             THEN DO;

      445     5977    4                  IF K = 0

   5977  2 001472   000000 116003                    CMPQ    0,DU
         2 001473   001546 601000 2                  TNZ     s:5992

      446     5978    5                  THEN DO;

      447     5979    5                       CALL INDEX (POSITION, SUBSTR(TEXT$ -> CHAR$ATT, 0, 1),
              5979                                '0123456789', 0);

   5979  2 001474   200350 471500                    LDP1    TEXT$,,AUTO
         2 001475   000100 124400                    SCM     mask='000'O
         2 001476   000034 000012 1                  ADSC9   ACTABL+6                 cn=0,n=10
         2 001477   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001500   200354 000100                    ARG     POSITION,,AUTO

      448     5980    5                       IF POSITION = LENGTHC('0123456789')

   5980  2 001501   200354 235100                    LDA     POSITION,,AUTO
         2 001502   000012 115007                    CMPA    10,DL
         2 001503   001522 601000 2                  TNZ     s:5986

      449     5981    6                       THEN DO;

      450     5982    6                            ATT_SIZE = SIZE - START;

   5982  2 001504   200355 236100                    LDQ     SIZE,,AUTO
         2 001505   200352 136100                    SBLQ    START,,AUTO
         2 001506   200344 473500                    LDP3    @ATT_SIZE,,AUTO
         2 001507   300000 756100                    STQ     0,,PR3

      451     5983    6                            TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);

   5983  2 001510   200345 474500                    LDP4    @BUF$,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:81   
         2 001511   400000 475500                    LDP5    0,,PR4
         2 001512   200346 476500                    LDP6    @BUF_SIZE,,AUTO
         2 001513   600000 720100                    LXL0    0,,PR6
         2 001514   300000 721100                    LXL1    0,,PR3
         2 001515   200352 235100                    LDA     START,,AUTO
         2 001516   040140 100545                    MLR     fill='040'O
         2 001517   100000 000011                    ADSC9   0,A,PR1                  cn=0,n=*X1
         2 001520   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0

      452     5984    6                          END;

   5984  2 001521   001567 710000 2                  TRA     s:5999

      453     5985    6                       ELSE DO;

      454     5986    6                            CALL INDEX (POSITION, ' ', TEXT$ -> CHAR$ATT, 0);

   5986  2 001522   200355 720100                    LXL0    SIZE,,AUTO
         2 001523   000000 124540                    SCM     mask='000'O
         2 001524   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 001525   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001526   200354 000100                    ARG     POSITION,,AUTO

      455     5987    6                            ATT_SIZE = SIZE - (SEMI_POSITION + 1);

   5987  2 001527   200355 236100                    LDQ     SIZE,,AUTO
         2 001530   200353 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 001531   000001 136007                    SBLQ    1,DL
         2 001532   200344 473500                    LDP3    @ATT_SIZE,,AUTO
         2 001533   300000 756100                    STQ     0,,PR3

      456     5988    6                           TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, POSITION + 1, ATT_SIZE
              5988                                     );

   5988  2 001534   200345 474500                    LDP4    @BUF$,,AUTO
         2 001535   400000 475500                    LDP5    0,,PR4
         2 001536   200346 476500                    LDP6    @BUF_SIZE,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:82   
         2 001537   600000 721100                    LXL1    0,,PR6
         2 001540   300000 722100                    LXL2    0,,PR3
         2 001541   200354 235100                    LDA     POSITION,,AUTO
         2 001542   040140 100545                    MLR     fill='040'O
         2 001543   100000 200012                    ADSC9   0,A,PR1                  cn=1,n=*X2
         2 001544   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1

      457     5989    6                          END;

      458     5990    5                     END;

   5990  2 001545   001567 710000 2                  TRA     s:5999

      459     5991    5                  ELSE DO;

      460     5992    5                       ATT_SIZE = SIZE - START;

   5992  2 001546   200355 236100                    LDQ     SIZE,,AUTO
         2 001547   200352 136100                    SBLQ    START,,AUTO
         2 001550   200344 471500                    LDP1    @ATT_SIZE,,AUTO
         2 001551   100000 756100                    STQ     0,,PR1

      461     5993    5                       TEXT$ATT = SUBSTR(TEXT$ -> CHAR$ATT, START, ATT_SIZE);

   5993  2 001552   200345 473500                    LDP3    @BUF$,,AUTO
         2 001553   300000 474500                    LDP4    0,,PR3
         2 001554   200346 475500                    LDP5    @BUF_SIZE,,AUTO
         2 001555   500000 720100                    LXL0    0,,PR5
         2 001556   100000 721100                    LXL1    0,,PR1
         2 001557   200350 476500                    LDP6    TEXT$,,AUTO
         2 001560   200352 235100                    LDA     START,,AUTO
         2 001561   040140 100545                    MLR     fill='040'O
         2 001562   600000 000011                    ADSC9   0,A,PR6                  cn=0,n=*X1
         2 001563   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      462     5994    5                     END;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:83   
      463     5995    4                END;

   5995  2 001564   001567 710000 2                  TRA     s:5999

      464     5996    3             ELSE ALTRETURN;

   5996  2 001565   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 001566   000000 702211                    TSX2  ! 0,X1

      465     5997    3           END;

      466     5998
      467     5999    2        RETURN;

   5999  2 001567   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 001570   000001 702211                    TSX2  ! 1,X1

      468     6000
      469     6001    2   END GET_ATTACHMENT;
      470     6002        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:84   
      471     6003        /*D* NAME:    GET_STORED_COMMAND
      472     6004             CALL:    CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, BUF_SIZE);
      473     6005             INPUT:   BUF$ POINTS TO BUFFER WHERE TEXT SHOULD BE PLACED
      474     6006                      BUF_SIZE IS SIZE OF BUFFER POINTED TO BY BUF$
      475     6007                      SCMD$ POINTS TO STORED DIRECTIVE
      476     6008             OUTPUT:  SCMD_SIZE IS SIZE OF TEXT PLACED IN BUFFER
      477     6009             SCRATCH: LOCAL AUTO
      478     6010             DESCRIPTION:  PUTS ENTIRE TEXT OF STORED DIRECTIVE POINTED TO BY
      479     6011                      SCMD$ IN BUFFER AND SCMD_SIZE IS SET TO SIZE OF TEXT
      480     6012                      PLACED IN BUFFER                                       */
      481     6013
      482     6014    1   GET_STORED_COMMAND: PROC (SCMD_SIZE, BUF$, BUF_SIZE);

   6014  2 001571   200342 741300       GET_STORED_* STX1  ! CONTINUE+2,,AUTO

      483     6015
      484     6016        /* Parameters */
      485     6017    2   DCL SCMD_SIZE UBIN;
      486     6018    2   DCL BUF$ PTR;
      487     6019    2   DCL BUF_SIZE UBIN;
      488     6020
      489     6021        /* Auto */
      490     6022    2   DCL SIZE UBIN;
      491     6023    2   DCL FATT$ PTR;
      492     6024    2   DCL TEXT$ PTR;
      493     6025    2   DCL START UBIN;
      494     6026    2   DCL POSITION UBIN;
      495     6027
      496     6028        /* Based */
      497     6029    2   DCL TEXT$CMD CHAR(BUF_SIZE) BASED(BUF$);
      498     6030    2   DCL CHAR$CMD CHAR(SIZE) BASED;
      499     6031
      500     6032    2        S_D.SHOW1 = SCMD_NO;

   6032  2 001572   200027 235100                    LDA     SCMD_NO,,AUTO
         2 001573   000000 470400 xsym               LDP0    S_D$
         2 001574   000064 755100                    STA     52,,PR0
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:85   

      501     6033    2        CALL DDA$SHOW1('0'B , SCMD_SIZE);

   6033  2 001575   200343 236100                    LDQ     @SCMD_SIZE,,AUTO
         2 001576   000005 235000 3                  LDA     5
         2 001577   200370 757100                    STAQ    FATT$+2,,AUTO
         2 001600   200370 630500                    EPPR0   FATT$+2,,AUTO
         2 001601   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001602   000000 701000 xent               TSX1    DDA$SHOW1
         2 001603   000000 011000                    NOP     0

      502     6034
      503     6035    2        RETURN;

   6035  2 001604   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 001605   000001 702211                    TSX2  ! 1,X1

      504     6036
      505     6037    2   END GET_STORED_COMMAND;
      506     6038        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:86   
      507     6039        /*D* NAME:    REPLACE_TEXT
      508     6040           CALL:   CALL REPLACE_TEXT (ATT#, BUF$, TEXT_SIZE, SCMD#, ENTIRE) ALTRET (ERROR);
      509     6041             INPUT:   ATT# IS THE ATTACHMENT NUMBER TO BE REPLACED
      510     6042                      BUF$ IS A POINTER TO BUFFER CONTAINING REPLACEMENT TEXT
      511     6043                      TEXT_SIZE IS SIZE OF REPLACEMENT TEXT
      512     6044                      SCMD$ POINTS TO THE STORED DIRECTIVE
      513     6045                      SCMD# IS STORED DIRECTIVE NUMBER
      514     6046                      ENTIRE IS SET IF THE ENTIRE STORED DIRECTIVE IS TO BE
      515     6047                       REPLACED BY THE REPLACEMENT TEXT
      516     6048             OUTPUT:  NEW STORED DIRECTIVE BUILD VIA SCAN
      517     6049             SCRATCH: LOCAL AUTO
      518     6050             DESCRIPTION:  REPLACES ATTACHMENT OF STORED DIRECTIVE WITH REPLACEMENT
      519     6051                      TEXT, KILLS THE OLD STORED DIRECTIVE, CALLS DDS$SCAN1 TO
      520     6052                      BUILD NEW STORED DIRECTIVE.                              */
      521     6053
      522     6054    1   REPLACE_TEXT: PROC (ATT#, BUF$, TEXT_SIZE, SCMD#, ENTIRE) ALTRET;

   6054  2 001606   200342 741300       REPLACE_TEXT STX1  ! CONTINUE+2,,AUTO

      523     6055
      524     6056        /* Parameters */
      525     6057    2   DCL ATT# UBIN;
      526     6058    2   DCL BUF$ PTR;
      527     6059    2   DCL TEXT_SIZE UBIN;
      528     6060    2   DCL SCMD# UBIN;
      529     6061    2   DCL ENTIRE BIT(1) ALIGNED;
      530     6062
      531     6063        /* Auto */
      532     6064    2   DCL SCMD$CHAR CHAR(2);
      533     6065    2   DCL FATT$ PTR;
      534     6066    2   DCL TEXT$ PTR;
      535     6067    2   DCL SIZE UBIN;
      536     6068    2   DCL START UBIN;
      537     6069    2   DCL SEMI_POSITION SBIN;
      538     6070    2   DCL K SBIN;
      539     6071    2   DCL CCMD UBIN;
      540     6072
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:87   
      541     6073        /* Based */
      542     6074    2   DCL REPL$TEXT CHAR(TEXT_SIZE) BASED(BUF$);
      543     6075    2   DCL CHAR$ATT CHAR(SIZE) BASED;
      544     6076
      545     6077    2        CALL BINCHAR (SCMD$CHAR, SCMD#);

   6077  2 001607   200346 470500                    LDP0    @SCMD#,,AUTO
         2 001610   000000 235100                    LDA     0,,PR0
         2 001611   000044 773000                    LRL     36
         2 001612   200370 757100                    STAQ    FATT$+2,,AUTO
         2 001613   000100 301500                    BTD
         2 001614   200370 000010                    NDSC9   FATT$+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 001615   200350 030002                    NDSC9   SCMD$CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=2

      546     6078    2        IF ENTIRE

   6078  2 001616   200347 471500                    LDP1    @ENTIRE,,AUTO
         2 001617   100000 234100                    SZN     0,,PR1
         2 001620   001634 605000 2                  TPL     s:6085

      547     6079    3        THEN DO;

      548     6080    3             S_D.INPUT = REPL$TEXT;

   6080  2 001621   200344 473500                    LDP3    @BUF$,,AUTO
         2 001622   300000 474500                    LDP4    0,,PR3
         2 001623   200345 475500                    LDP5    @TEXT_SIZE,,AUTO
         2 001624   500000 720100                    LXL0    0,,PR5
         2 001625   000000 476400 xsym               LDP6    S_D$
         2 001626   040100 100540                    MLR     fill='040'O
         2 001627   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         2 001630   600610 000400                    ADSC9   392,,PR6                 cn=0,n=256

      549     6081    3             S_D.NCHARS = TEXT_SIZE;

   6081  2 001631   500000 235100                    LDA     0,,PR5
         2 001632   600065 755100                    STA     53,,PR6
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:88   

      550     6082    3           END;

   6082  2 001633   002317 710000 2                  TRA     s:6195

      551     6083    3        ELSE DO;

      552     6084                                 /* Point to first attachment of stored directive */
      553     6085    3             FATT$ = PINCRW(S_D.VARCOM$, SCMD$ -> F$XCM.FAI);

   6085  2 001634   200012 473500                    LDP3    SCMD$,,AUTO
         2 001635   300002 720100                    LXL0    2,,PR3
         2 001636   000000 474400 xsym               LDP4    S_D$
         2 001637   404622 475500                    LDP5    2450,,PR4
         2 001640   500000 636510                    EPPR6   0,X0,PR5
         2 001641   200351 456500                    STP6    FATT$,,AUTO

      554     6086                                                /* Point to text of stored directive */
      555     6087    3             TEXT$ = PINCRC(FATT$, FATT$ -> AT_FIRST.TEXT_OFFSET);

   6087  2 001642   600006 236100                    LDQ     6,,PR6
         2 001643   000022 772000                    QRL     18
         2 001644   000020 736000                    QLS     16
         2 001645   200351 036100                    ADLQ    FATT$,,AUTO
         2 001646   200352 756100                    STQ     TEXT$,,AUTO

      556     6088                                                /* Get size of text */
      557     6089    3             SIZE = FATT$ -> AT_FIRST.TEXT_SIZE;

   6089  2 001647   600006 236100                    LDQ     6,,PR6
         2 001650   777777 376007                    ANQ     -1,DL
         2 001651   200353 756100                    STQ     SIZE,,AUTO

      558     6090                                                /* Find attachment ATT# */
      559     6091    3             SEMI_POSITION = -1;

   6091  2 001652   000001 335007                    LCA     1,DL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:89   
         2 001653   200355 755100                    STA     SEMI_POSITION,,AUTO

      560     6092    3             K = -1;

   6092  2 001654   200356 755100                    STA     K,,AUTO

      561     6093    4             DO UNTIL (K = ATT#);

      562     6094    4                  K = K + 1;

   6094  2 001655   200356 054100                    AOS     K,,AUTO

      563     6095    4                  START = SEMI_POSITION + 1;

   6095  2 001656   200355 235100                    LDA     SEMI_POSITION,,AUTO
         2 001657   000001 035007                    ADLA    1,DL
         2 001660   200354 755100                    STA     START,,AUTO

      564     6096    4                  CALL INDEX (SEMI_POSITION, ';', TEXT$ -> CHAR$ATT, START) ALTRET (
              6096                           NO_SEMI);

   6096  2 001661   200353 236100                    LDQ     SIZE,,AUTO
         2 001662   200354 136100                    SBLQ    START,,AUTO
         2 001663   200370 756100                    STQ     FATT$+2,,AUTO
         2 001664   200354 236100                    LDQ     START,,AUTO
         2 001665   200352 470500                    LDP0    TEXT$,,AUTO
         2 001666   200370 720100                    LXL0    FATT$+2,,AUTO
         2 001667   000000 124545                    SCM     mask='000'O
         2 001670   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 001671   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 001672   200355 000100                    ARG     SEMI_POSITION,,AUTO
         2 001673   200355 056100                    ASQ     SEMI_POSITION,,AUTO
         2 001674   002164 606400 2                  TTN     NO_SEMI

      565     6097    4                END;

   6097  2 001675   200343 471500                    LDP1    @ATT#,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:90   
         2 001676   200356 236100                    LDQ     K,,AUTO
         2 001677   001655 604000 2                  TMI     s:6094
         2 001700   100000 116100                    CMPQ    0,,PR1
         2 001701   001655 601000 2                  TNZ     s:6094

      566     6098    3             IF K = 0

   6098  2 001702   000000 116003                    CMPQ    0,DU
         2 001703   002027 601000 2                  TNZ     s:6132

      567     6099    4             THEN DO;                      /* Breakpoint itself */

      568     6100    4                  IF TEXT_SIZE = 0

   6100  2 001704   200345 473500                    LDP3    @TEXT_SIZE,,AUTO
         2 001705   300000 235100                    LDA     0,,PR3
         2 001706   001772 601000 2                  TNZ     s:6127

      569     6101    5                  THEN DO;

      570     6102    5                       CCMD = S_D.FIXCOM.CMD(SCMD#);

   6102  2 001707   200346 474500                    LDP4    @SCMD#,,AUTO
         2 001710   400000 236100                    LDQ     0,,PR4
         2 001711   000003 402007                    MPY     3,DL
         2 001712   000001 736000                    QLS     1
         2 001713   000000 475400 xsym               LDP5    S_D$
         2 001714   501212 236106                    LDQ     650,QL,PR5
         2 001715   000033 772000                    QRL     27
         2 001716   200357 756100                    STQ     CCMD,,AUTO

      571     6103    5                       IF CCMD ~= 0

   6103  2 001717   001766 600000 2                  TZE     s:6123

      572     6104    6                       THEN DO;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:91   
      573     6105    6                            S_D.KILL1 = SCMD#;

   6105  2 001720   400000 235100                    LDA     0,,PR4
         2 001721   500063 755100                    STA     51,,PR5

      574     6106    6                            FPRG = S_D.FIXCOM.FPRG(SCMD#);

   6106  2 001722   400000 236100                    LDQ     0,,PR4
         2 001723   000003 402007                    MPY     3,DL
         2 001724   000001 736000                    QLS     1
         2 001725   501212 236106                    LDQ     650,QL,PR5
         2 001726   000020 736000                    QLS     16
         2 001727   400000 376003                    ANQ     -131072,DU
         2 001730   200305 756100                    STQ     FPRG,,AUTO

      575     6107    6                            IF FPRG

   6107  2 001731   200305 234100                    SZN     FPRG,,AUTO
         2 001732   001745 605000 2                  TPL     s:6110

      576     6108    6                            THEN CALL DFA$KILL1('1'B, CCMD, '1'B);

   6108  2 001733   000007 236000 3                  LDQ     7
         2 001734   200372 756100                    STQ     FATT$+4,,AUTO
         2 001735   200357 636500                    EPPR6   CCMD,,AUTO
         2 001736   200371 456500                    STP6    FATT$+3,,AUTO
         2 001737   200370 756100                    STQ     FATT$+2,,AUTO
         2 001740   200370 630500                    EPPR0   FATT$+2,,AUTO
         2 001741   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001742   000000 701000 xent               TSX1    DFA$KILL1
         2 001743   000000 011000                    NOP     0
         2 001744   001765 710000 2                  TRA     s:6120

      577     6109    7                            ELSE DO;

      578     6110    7                                 IF CCMD = 30 /* C_OA */

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:92   
   6110  2 001745   200357 235100                    LDA     CCMD,,AUTO
         2 001746   000036 115007                    CMPA    30,DL
         2 001747   001751 601000 2                  TNZ     s:6112

      579     6111    7                                 THEN S_D.ONABORT = 0;

   6111  2 001750   504744 450100                    STZ     2532,,PR5

      580     6112    7                                 IF CCMD = 32 /* C_OE */

   6112  2 001751   000040 115007                    CMPA    32,DL
         2 001752   001754 601000 2                  TNZ     s:6114

      581     6113    7                                 THEN S_D.ONEXIT = 0;

   6113  2 001753   504746 450100                    STZ     2534,,PR5

      582     6114    7                                 IF CCMD = 53 /* C_ONCALLS */

   6114  2 001754   000065 115007                    CMPA    53,DL
         2 001755   001757 601000 2                  TNZ     s:6116

      583     6115    7                                 THEN S_D.ONCALLS = 0;

   6115  2 001756   504745 450100                    STZ     2533,,PR5

      584     6116    7                                 IF CCMD = 54 /* C_ONNODES */

   6116  2 001757   000066 115007                    CMPA    54,DL
         2 001760   001762 601000 2                  TNZ     s:6118

      585     6117    7                                 THEN S_D.ONNODES = 0;

   6117  2 001761   504747 450100                    STZ     2535,,PR5

      586     6118    7                                 CALL DDA$KILL1;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:93   
   6118  2 001762   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001763   000000 701000 xent               TSX1    DDA$KILL1
         2 001764   000000 011000                    NOP     0

      587     6119    7                               END;

      588     6120    6                            GOTO RET;

   6120  2 001765   002407 710000 2                  TRA     RET

      589     6121    6                          END;
      590     6122    6                       ELSE DO;

      591     6123    6                            S_D.ERROR = 502; /* E@DELBUG */

   6123  2 001766   000766 235007                    LDA     502,DL
         2 001767   500013 755100                    STA     11,,PR5

      592     6124    6                            ALTRETURN;

   6124  2 001770   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 001771   000000 702211                    TSX2  ! 0,X1

      593     6125    6                          END;
      594     6126    5                     END;
      595     6127    4                  CALL CONCAT (S_D.INPUT, REPL$TEXT,

   6127  2 001772   200344 474500                    LDP4    @BUF$,,AUTO
         2 001773   400000 475500                    LDP5    0,,PR4
         2 001774   300000 720100                    LXL0    0,,PR3
         2 001775   200353 236100                    LDQ     SIZE,,AUTO
         2 001776   200355 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 001777   000000 476400 xsym               LDP6    S_D$
         2 002000   040100 100540                    MLR     fill='040'O
         2 002001   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         2 002002   600610 000400                    ADSC9   392,,PR6                 cn=0,n=256
         2 002003   200370 756100                    STQ     FATT$+2,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:94   
         2 002004   000000 636010                    EAQ     0,X0
         2 002005   000022 772000                    QRL     18
         2 002006   000400 116007                    CMPQ    256,DL
         2 002007   002022 603000 2                  TRC     s:6129
         2 002010   200371 740100                    STX0    FATT$+3,,AUTO
         2 002011   777377 620010                    EAX0    -257,X0
         2 002012   777777 660003                    ERX0    -1,DU
         2 002013   200370 721100                    LXL1    FATT$+2,,AUTO
         2 002014   200355 235100                    LDA     SEMI_POSITION,,AUTO
         2 002015   200371 236100                    LDQ     FATT$+3,,AUTO
         2 002016   000022 772000                    QRL     18
         2 002017   040146 100545                    MLR     fill='040'O
         2 002020   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         2 002021   600610 000010                    ADSC9   392,Q,PR6                cn=0,n=*X0

      596     6128    4                    SUBSTR(TEXT$ -> CHAR$ATT, SEMI_POSITION, SIZE - SEMI_POSITION));
      597     6129    4                  S_D.NCHARS = TEXT_SIZE + (SIZE - SEMI_POSITION);

   6129  2 002022   200353 236100                    LDQ     SIZE,,AUTO
         2 002023   200355 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 002024   300000 036100                    ADLQ    0,,PR3
         2 002025   600065 756100                    STQ     53,,PR6

      598     6130    4                END;

   6130  2 002026   002163 710000 2                  TRA     s:6144

      599     6131    4             ELSE DO;                      /* An attachment */

      600     6132    4                  IF TEXT_SIZE = 0

   6132  2 002027   200345 473500                    LDP3    @TEXT_SIZE,,AUTO
         2 002030   300000 235100                    LDA     0,,PR3
         2 002031   002110 601000 2                  TNZ     s:6139

      601     6133    5                  THEN DO;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:95   
      602     6134    5                       CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0, START),

   6134  2 002032   200344 474500                    LDP4    @BUF$,,AUTO
         2 002033   400000 475500                    LDP5    0,,PR4
         2 002034   300000 720100                    LXL0    0,,PR3
         2 002035   200353 236100                    LDQ     SIZE,,AUTO
         2 002036   200355 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 002037   200354 721100                    LXL1    START,,AUTO
         2 002040   000000 476400 xsym               LDP6    S_D$
         2 002041   040100 100540                    MLR     fill='040'O
         2 002042   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         2 002043   600610 000400                    ADSC9   392,,PR6                 cn=0,n=256
         2 002044   200370 756100                    STQ     FATT$+2,,AUTO
         2 002045   200354 236100                    LDQ     START,,AUTO
         2 002046   000400 116007                    CMPQ    256,DL
         2 002047   002077 603000 2                  TRC     s:6136
         2 002050   777377 622006                    EAX2    -257,QL
         2 002051   777777 662003                    ERX2    -1,DU
         2 002052   040146 100540                    MLR     fill='040'O
         2 002053   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         2 002054   600610 000012                    ADSC9   392,Q,PR6                cn=0,n=*X2
         2 002055   000000 636010                    EAQ     0,X0
         2 002056   000022 772000                    QRL     18
         2 002057   200354 036100                    ADLQ    START,,AUTO
         2 002060   000400 116007                    CMPQ    256,DL
         2 002061   002077 603000 2                  TRC     s:6136
         2 002062   200371 756100                    STQ     FATT$+3,,AUTO
         2 002063   000000 636010                    EAQ     0,X0
         2 002064   000022 772000                    QRL     18
         2 002065   200354 036100                    ADLQ    START,,AUTO
         2 002066   200370 720100                    LXL0    FATT$+2,,AUTO
         2 002067   777777 623010                    EAX3    -1,X0
         2 002070   200371 724100                    LXL4    FATT$+3,,AUTO
         2 002071   777377 624014                    EAX4    -257,X4
         2 002072   777777 664003                    ERX4    -1,DU
         2 002073   200355 235100                    LDA     SEMI_POSITION,,AUTO
         2 002074   040146 100545                    MLR     fill='040'O
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:96   
         2 002075   000000 200013                    ADSC9   0,A,PR0                  cn=1,n=*X3
         2 002076   600610 000014                    ADSC9   392,Q,PR6                cn=0,n=*X4

      603     6135    5                        REPL$TEXT, SUBSTR(TEXT$ -> CHAR$ATT, SEMI_POSITION + 1, SIZE -
              6135                                  (SEMI_POSITION + 1)));
      604     6136    5                       S_D.NCHARS = START + TEXT_SIZE + (SIZE - (SEMI_POSITION + 1));

   6136  2 002077   200354 236100                    LDQ     START,,AUTO
         2 002100   300000 036100                    ADLQ    0,,PR3
         2 002101   200370 756100                    STQ     FATT$+2,,AUTO
         2 002102   200353 236100                    LDQ     SIZE,,AUTO
         2 002103   200355 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 002104   200370 036100                    ADLQ    FATT$+2,,AUTO
         2 002105   000001 136007                    SBLQ    1,DL
         2 002106   600065 756100                    STQ     53,,PR6

      605     6137    5                     END;

   6137  2 002107   002163 710000 2                  TRA     s:6144

      606     6138    5                  ELSE DO;

      607     6139    5                       CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0, START),

   6139  2 002110   200344 474500                    LDP4    @BUF$,,AUTO
         2 002111   400000 475500                    LDP5    0,,PR4
         2 002112   300000 720100                    LXL0    0,,PR3
         2 002113   200353 236100                    LDQ     SIZE,,AUTO
         2 002114   200355 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 002115   200354 721100                    LXL1    START,,AUTO
         2 002116   000000 476400 xsym               LDP6    S_D$
         2 002117   040100 100540                    MLR     fill='040'O
         2 002120   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         2 002121   600610 000400                    ADSC9   392,,PR6                 cn=0,n=256
         2 002122   200370 756100                    STQ     FATT$+2,,AUTO
         2 002123   200354 236100                    LDQ     START,,AUTO
         2 002124   000400 116007                    CMPQ    256,DL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:97   
         2 002125   002154 603000 2                  TRC     s:6141
         2 002126   777377 622006                    EAX2    -257,QL
         2 002127   777777 662003                    ERX2    -1,DU
         2 002130   040146 100540                    MLR     fill='040'O
         2 002131   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         2 002132   600610 000012                    ADSC9   392,Q,PR6                cn=0,n=*X2
         2 002133   000000 636010                    EAQ     0,X0
         2 002134   000022 772000                    QRL     18
         2 002135   200354 036100                    ADLQ    START,,AUTO
         2 002136   000400 116007                    CMPQ    256,DL
         2 002137   002154 603000 2                  TRC     s:6141
         2 002140   200371 756100                    STQ     FATT$+3,,AUTO
         2 002141   000000 636010                    EAQ     0,X0
         2 002142   000022 772000                    QRL     18
         2 002143   200354 036100                    ADLQ    START,,AUTO
         2 002144   200371 720100                    LXL0    FATT$+3,,AUTO
         2 002145   777377 620010                    EAX0    -257,X0
         2 002146   777777 660003                    ERX0    -1,DU
         2 002147   200370 723100                    LXL3    FATT$+2,,AUTO
         2 002150   200355 235100                    LDA     SEMI_POSITION,,AUTO
         2 002151   040146 100545                    MLR     fill='040'O
         2 002152   000000 000013                    ADSC9   0,A,PR0                  cn=0,n=*X3
         2 002153   600610 000010                    ADSC9   392,Q,PR6                cn=0,n=*X0

      608     6140    5                         REPL$TEXT, SUBSTR(TEXT$ -> CHAR$ATT, SEMI_POSITION, SIZE -
              6140                                  SEMI_POSITION));
      609     6141    5                       S_D.NCHARS = START + TEXT_SIZE + (SIZE - SEMI_POSITION);

   6141  2 002154   200354 236100                    LDQ     START,,AUTO
         2 002155   300000 036100                    ADLQ    0,,PR3
         2 002156   200370 756100                    STQ     FATT$+2,,AUTO
         2 002157   200353 236100                    LDQ     SIZE,,AUTO
         2 002160   200355 136100                    SBLQ    SEMI_POSITION,,AUTO
         2 002161   200370 036100                    ADLQ    FATT$+2,,AUTO
         2 002162   600065 756100                    STQ     53,,PR6

      610     6142    5                     END;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:98   

      611     6143    4                END;

      612     6144    4             DO WHILE ('0'B);

   6144  2 002163   002317 710000 2                  TRA     s:6195

   6139  2 002164                       NO_SEMI      null
      613     6145    4   NO_SEMI:       ;
      614     6146    4                  IF K = ATT#

   6146  2 002164   200343 470500                    LDP0    @ATT#,,AUTO
         2 002165   200356 236100                    LDQ     K,,AUTO
         2 002166   002312 604000 2                  TMI     s:6188
         2 002167   000000 116100                    CMPQ    0,,PR0
         2 002170   002312 601000 2                  TNZ     s:6188

      615     6147    5                  THEN DO;

      616     6148    5                       IF K = 0

   6148  2 002171   000000 116003                    CMPQ    0,DU
         2 002172   002250 601000 2                  TNZ     s:6176

      617     6149    6                       THEN DO;

      618     6150    6                            IF TEXT_SIZE = 0

   6150  2 002173   200345 471500                    LDP1    @TEXT_SIZE,,AUTO
         2 002174   100000 235100                    LDA     0,,PR1
         2 002175   002236 601000 2                  TNZ     s:6172

      619     6151    7                            THEN DO;

      620     6152    7                                 CCMD = S_D.FIXCOM.CMD(SCMD#);

   6152  2 002176   200346 473500                    LDP3    @SCMD#,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:99   
         2 002177   300000 236100                    LDQ     0,,PR3
         2 002200   000003 402007                    MPY     3,DL
         2 002201   000001 736000                    QLS     1
         2 002202   000000 474400 xsym               LDP4    S_D$
         2 002203   401212 236106                    LDQ     650,QL,PR4
         2 002204   000033 772000                    QRL     27
         2 002205   200357 756100                    STQ     CCMD,,AUTO

      621     6153    7                                 IF CCMD ~= 0

   6153  2 002206   002232 600000 2                  TZE     s:6168

      622     6154    8                                 THEN DO;

      623     6155    8                                      S_D.KILL1 = SCMD#;

   6155  2 002207   300000 235100                    LDA     0,,PR3
         2 002210   400063 755100                    STA     51,,PR4

      624     6156    8                                      IF CCMD = 30 /* C_OA */

   6156  2 002211   200357 236100                    LDQ     CCMD,,AUTO
         2 002212   000036 116007                    CMPQ    30,DL
         2 002213   002215 601000 2                  TNZ     s:6158

      625     6157    8                                      THEN S_D.ONABORT = 0;

   6157  2 002214   404744 450100                    STZ     2532,,PR4

      626     6158    8                                      IF CCMD = 32 /* C_OE */

   6158  2 002215   000040 116007                    CMPQ    32,DL
         2 002216   002220 601000 2                  TNZ     s:6160

      627     6159    8                                      THEN S_D.ONEXIT = 0;

   6159  2 002217   404746 450100                    STZ     2534,,PR4
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:100  

      628     6160    8                                      IF CCMD = 53 /* C_ONCALLS */

   6160  2 002220   000065 116007                    CMPQ    53,DL
         2 002221   002223 601000 2                  TNZ     s:6162

      629     6161    8                                      THEN S_D.ONCALLS = 0;

   6161  2 002222   404745 450100                    STZ     2533,,PR4

      630     6162    8                                      IF CCMD = 54 /* C_ONNODES */

   6162  2 002223   000066 116007                    CMPQ    54,DL
         2 002224   002226 601000 2                  TNZ     s:6164

      631     6163    8                                      THEN S_D.ONNODES = 0;

   6163  2 002225   404747 450100                    STZ     2535,,PR4

      632     6164    8                                      CALL DDA$KILL1;

   6164  2 002226   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002227   000000 701000 xent               TSX1    DDA$KILL1
         2 002230   000000 011000                    NOP     0

      633     6165    8                                      GOTO RET;

   6165  2 002231   002407 710000 2                  TRA     RET

      634     6166    8                                    END;
      635     6167    8                                 ELSE DO;

      636     6168    8                                      S_D.ERROR = 502; /* E@DELBUG */

   6168  2 002232   000766 235007                    LDA     502,DL
         2 002233   400013 755100                    STA     11,,PR4

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:101  
      637     6169    8                                      ALTRETURN;

   6169  2 002234   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 002235   000000 702211                    TSX2  ! 0,X1

      638     6170    8                                    END;
      639     6171    7                               END;
      640     6172    6                            S_D.INPUT = REPL$TEXT;

   6172  2 002236   200344 473500                    LDP3    @BUF$,,AUTO
         2 002237   300000 474500                    LDP4    0,,PR3
         2 002240   100000 720100                    LXL0    0,,PR1
         2 002241   000000 475400 xsym               LDP5    S_D$
         2 002242   040100 100540                    MLR     fill='040'O
         2 002243   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         2 002244   500610 000400                    ADSC9   392,,PR5                 cn=0,n=256

      641     6173    6                            S_D.NCHARS = TEXT_SIZE;

   6173  2 002245   100000 235100                    LDA     0,,PR1
         2 002246   500065 755100                    STA     53,,PR5

      642     6174    6                          END;

   6174  2 002247   002317 710000 2                  TRA     s:6195

      643     6175    6                       ELSE DO;

      644     6176    6                            IF TEXT_SIZE = 0

   6176  2 002250   200345 471500                    LDP1    @TEXT_SIZE,,AUTO
         2 002251   100000 235100                    LDA     0,,PR1
         2 002252   002266 601000 2                  TNZ     s:6182

      645     6177    7                            THEN DO;

      646     6178    7                                 CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0,
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:102  
              6178                                          START - 1));

   6178  2 002253   200354 720100                    LXL0    START,,AUTO
         2 002254   777777 621010                    EAX1    -1,X0
         2 002255   200352 473500                    LDP3    TEXT$,,AUTO
         2 002256   000000 474400 xsym               LDP4    S_D$
         2 002257   040100 100540                    MLR     fill='040'O
         2 002260   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         2 002261   400610 000400                    ADSC9   392,,PR4                 cn=0,n=256

      647     6179    7                                 S_D.NCHARS = START-1;

   6179  2 002262   200354 235100                    LDA     START,,AUTO
         2 002263   000001 135007                    SBLA    1,DL
         2 002264   400065 755100                    STA     53,,PR4

      648     6180    7                               END;

   6180  2 002265   002317 710000 2                  TRA     s:6195

      649     6181    7                            ELSE DO;

      650     6182    7                                 CALL CONCAT (S_D.INPUT, SUBSTR(TEXT$ -> CHAR$ATT, 0,
              6182                                          START), REPL$TEXT);

   6182  2 002266   200344 473500                    LDP3    @BUF$,,AUTO
         2 002267   300000 474500                    LDP4    0,,PR3
         2 002270   100000 720100                    LXL0    0,,PR1
         2 002271   200352 475500                    LDP5    TEXT$,,AUTO
         2 002272   200354 721100                    LXL1    START,,AUTO
         2 002273   000000 476400 xsym               LDP6    S_D$
         2 002274   040100 100540                    MLR     fill='040'O
         2 002275   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1
         2 002276   600610 000400                    ADSC9   392,,PR6                 cn=0,n=256
         2 002277   200354 236100                    LDQ     START,,AUTO
         2 002300   000400 116007                    CMPQ    256,DL
         2 002301   002307 603000 2                  TRC     s:6183
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:103  
         2 002302   777377 622006                    EAX2    -257,QL
         2 002303   777777 662003                    ERX2    -1,DU
         2 002304   040146 100540                    MLR     fill='040'O
         2 002305   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         2 002306   600610 000012                    ADSC9   392,Q,PR6                cn=0,n=*X2

      651     6183    7                                 S_D.NCHARS = START + TEXT_SIZE;

   6183  2 002307   100000 036100                    ADLQ    0,,PR1
         2 002310   600065 756100                    STQ     53,,PR6

      652     6184    7                               END;

      653     6185    6                          END;

      654     6186    5                     END;

   6186  2 002311   002317 710000 2                  TRA     s:6195

      655     6187    5                  ELSE DO;

      656     6188    5                       S_D.ERROR = 502; /* E@DELBUG */

   6188  2 002312   000766 235007                    LDA     502,DL
         2 002313   000000 471400 xsym               LDP1    S_D$
         2 002314   100013 755100                    STA     11,,PR1

      657     6189    5                       ALTRETURN;

   6189  2 002315   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 002316   000000 702211                    TSX2  ! 0,X1

      658     6190    5                     END;
      659     6191    4                END;

      660     6192    3           END;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:104  
      661     6193
      662     6194                                                /* Kill original stored directive */
      663     6195    2        CCMD = S_D.FIXCOM.CMD(SCMD#);

   6195  2 002317   200346 470500                    LDP0    @SCMD#,,AUTO
         2 002320   000000 236100                    LDQ     0,,PR0
         2 002321   000003 402007                    MPY     3,DL
         2 002322   000001 736000                    QLS     1
         2 002323   000000 471400 xsym               LDP1    S_D$
         2 002324   101212 236106                    LDQ     650,QL,PR1
         2 002325   000033 772000                    QRL     27
         2 002326   200357 756100                    STQ     CCMD,,AUTO

      664     6196    2        IF CCMD ~= 0

   6196  2 002327   002376 600000 2                  TZE     s:6215

      665     6197    3        THEN DO;

      666     6198    3             S_D.KILL1 = SCMD#;

   6198  2 002330   000000 235100                    LDA     0,,PR0
         2 002331   100063 755100                    STA     51,,PR1

      667     6199    3             FPRG = S_D.FIXCOM.FPRG(SCMD#);

   6199  2 002332   000000 236100                    LDQ     0,,PR0
         2 002333   000003 402007                    MPY     3,DL
         2 002334   000001 736000                    QLS     1
         2 002335   101212 236106                    LDQ     650,QL,PR1
         2 002336   000020 736000                    QLS     16
         2 002337   400000 376003                    ANQ     -131072,DU
         2 002340   200305 756100                    STQ     FPRG,,AUTO

      668     6200    3             IF FPRG

   6200  2 002341   200305 234100                    SZN     FPRG,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:105  
         2 002342   002355 605000 2                  TPL     s:6203

      669     6201    3             THEN CALL DFA$KILL1('1'B, CCMD, '1'B);

   6201  2 002343   000007 236000 3                  LDQ     7
         2 002344   200372 756100                    STQ     FATT$+4,,AUTO
         2 002345   200357 633500                    EPPR3   CCMD,,AUTO
         2 002346   200371 453500                    STP3    FATT$+3,,AUTO
         2 002347   200370 756100                    STQ     FATT$+2,,AUTO
         2 002350   200370 630500                    EPPR0   FATT$+2,,AUTO
         2 002351   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002352   000000 701000 xent               TSX1    DFA$KILL1
         2 002353   000000 011000                    NOP     0
         2 002354   002402 710000 2                  TRA     s:6218

      670     6202    4             ELSE DO;

      671     6203    4                  IF CCMD = 30           /* C_OA */

   6203  2 002355   200357 235100                    LDA     CCMD,,AUTO
         2 002356   000036 115007                    CMPA    30,DL
         2 002357   002361 601000 2                  TNZ     s:6205

      672     6204    4                  THEN S_D.ONABORT = 0;

   6204  2 002360   104744 450100                    STZ     2532,,PR1

      673     6205    4                  IF CCMD = 32           /* C_OE */

   6205  2 002361   000040 115007                    CMPA    32,DL
         2 002362   002364 601000 2                  TNZ     s:6207

      674     6206    4                  THEN S_D.ONEXIT = 0;

   6206  2 002363   104746 450100                    STZ     2534,,PR1

      675     6207    4                  IF CCMD = 53      /* C_ONCALLS */
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:106  

   6207  2 002364   000065 115007                    CMPA    53,DL
         2 002365   002367 601000 2                  TNZ     s:6209

      676     6208    4                  THEN S_D.ONCALLS = 0;

   6208  2 002366   104745 450100                    STZ     2533,,PR1

      677     6209    4                  IF CCMD = 54      /* C_ONNODES */

   6209  2 002367   000066 115007                    CMPA    54,DL
         2 002370   002372 601000 2                  TNZ     s:6211

      678     6210    4                  THEN S_D.ONNODES = 0;

   6210  2 002371   104747 450100                    STZ     2535,,PR1

      679     6211    4                  CALL DDA$KILL1;

   6211  2 002372   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002373   000000 701000 xent               TSX1    DDA$KILL1
         2 002374   000000 011000                    NOP     0

      680     6212    4                END;

      681     6213    3           END;

   6213  2 002375   002402 710000 2                  TRA     s:6218

      682     6214    3        ELSE DO;

      683     6215    3             S_D.ERROR = 502;         /* E@DELBUG */

   6215  2 002376   000766 235007                    LDA     502,DL
         2 002377   100013 755100                    STA     11,,PR1

      684     6216    3             ALTRETURN;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:107  

   6216  2 002400   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 002401   000000 702211                    TSX2  ! 0,X1

      685     6217    3           END;
      686     6218    2        IF SIZE_READ = 0

   6218  2 002402   200023 235100                    LDA     SIZE_READ,,AUTO
         2 002403   002407 600000 2                  TZE     RET

      687     6219    2        THEN GOTO RET;
      688     6220                            /* Call scan to have stored directive parsed and rebuilt */
      689     6221    2        CALL DDS$SCAN1 ALTRET (RESTORE_SAVED);

   6221  2 002404   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002405   000000 701000 xent               TSX1    DDS$SCAN1
         2 002406   002411 702000 2                  TSX2    RESTORE_SAVED

   6218  2 002407                       RET          null
      690     6222    2   RET: ;
      691     6223    2        RETURN;

   6223  2 002407   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 002410   000001 702211                    TSX2  ! 1,X1

   6218  2 002411                       RESTORE_SAV* null
      692     6224
      693     6225    2   RESTORE_SAVED: ;
      694     6226    2        S_D.ERROR = 262;        /* E@SCMD_ERRORED */

   6226  2 002411   000406 235007                    LDA     262,DL
         2 002412   000000 470400 xsym               LDP0    S_D$
         2 002413   000013 755100                    STA     11,,PR0

      695     6227    2        CALL DDE$ERROR;

   6227  2 002414   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:108  
         2 002415   000000 701000 xent               TSX1    DDE$ERROR
         2 002416   000000 011000                    NOP     0

      696     6228    2        S_D.OUTPUT = S_D.INPUT;

   6228  2 002417   000000 470400 xsym               LDP0    S_D$
         2 002420   040100 100500                    MLR     fill='040'O
         2 002421   000610 000400                    ADSC9   392,,PR0                 cn=0,n=256
         2 002422   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      697     6229    2        CALL DDQ$WRITE (ADDR(S_D.OUTPUT), S_D.NCHARS);

   6229  2 002423   000000 236000 xsym               LDQ     S_D$
         2 002424   005335 036003                    ADLQ    2781,DU
         2 002425   200370 756100                    STQ     FATT$+2,,AUTO
         2 002426   000000 236000 xsym               LDQ     S_D$
         2 002427   000065 036003                    ADLQ    53,DU
         2 002430   200373 756100                    STQ     FATT$+5,,AUTO
         2 002431   200370 631500                    EPPR1   FATT$+2,,AUTO
         2 002432   200372 451500                    STP1    FATT$+4,,AUTO
         2 002433   200372 630500                    EPPR0   FATT$+4,,AUTO
         2 002434   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002435   000000 701000 xent               TSX1    DDQ$WRITE
         2 002436   000000 011000                    NOP     0

      698     6230    2        S_D.ERROR = 261;       /* E@SCMD_RESTORED */

   6230  2 002437   000405 235007                    LDA     261,DL
         2 002440   000000 470400 xsym               LDP0    S_D$
         2 002441   000013 755100                    STA     11,,PR0

      699     6231    2        CALL DDE$ERROR;

   6231  2 002442   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002443   000000 701000 xent               TSX1    DDE$ERROR
         2 002444   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:109  
      700     6232    2        CALL RESTORE_SCMD;

   6232  2 002445   002736 701000 2                  TSX1    RESTORE_SCMD
         2 002446   000000 011000                    NOP     0

      701     6233    2        RETURN;

   6233  2 002447   200342 221300                    LDX1  ! CONTINUE+2,,AUTO
         2 002450   000001 702211                    TSX2  ! 1,X1

      702     6234
      703     6235    2   END REPLACE_TEXT;
      704     6236        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:110  
      705     6237        /*D* NAME:    DO_ATTACHMENTS
      706     6238             CALL:    CALL DO_ATTACHMENTS (J, ACT) ALTRET (ERROR);
      707     6239             INPUT:   J IS ATTACHMENT NUMBER TO START AT
      708     6240                      ACT IS CODE FOR THE ACTIVATION CHARACTER
      709     6241                      NO_OF_ATTACHMENTS IS SET TO NUMBER OF ATTACHMENTS FOR
      710     6242                       FOR THE CURRENT STORED DIRECTIVE
      711     6243             OUTPUT:  EACH ATTACHMENT IS PUT IN REREAD BUFFER THEN REPLACED
      712     6244                       IN THE STORED DIRECTIVE WITH THE NEW TEXT
      713     6245             SCRATCH: LOCAL AUTO
      714     6246             DESCRIPTION:  FOR EACH ATTACHMENT ZERO TO NO_OF_ATTACHMENTS,
      715     6247                      PUT THE ATTACHMENT IN THE REREAD BUFFER AND THEN REPLACE
      716     6248                      THE ATTACHMENT WITH THE NEW TEXT.                      */
      717     6249
      718     6250    1   DO_ATTACHMENTS: PROC (J, ACT) ALTRET;

   6250  2 002451   200334 741300       DO_ATTACHME* STX1  ! FPTSINPUT+8,,AUTO

      719     6251
      720     6252        /* Parameters */
      721     6253    2   DCL J UBIN;
      722     6254    2   DCL ACT UBIN;
      723     6255
      724     6256        /* Auto */
      725     6257    2   DCL I UBIN;
      726     6258    2   DCL CONTINUE BIT(1) ALIGNED;
      727     6259
      728     6260    2        SET_ATTACH = '0'B;

   6260  2 002452   200032 450100                    STZ     SET_ATTACH,,AUTO

      729     6261    2        CONTINUE = '1'B;

   6261  2 002453   400000 236003                    LDQ     -131072,DU
         2 002454   200340 756100                    STQ     CONTINUE,,AUTO

      730     6262    2        IF ADDR(J) = ADDR(NIL)

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:111  
   6262  2 002455   200335 236100                    LDQ     @J,,AUTO
         2 002456   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002457   002462 601000 2                  TNZ     s:6264

      731     6263    2        THEN I = 0;

   6263  2 002460   200337 450100                    STZ     I,,AUTO
         2 002461   002465 710000 2                  TRA     s:6265

      732     6264    2        ELSE I = J;

   6264  2 002462   200335 470500                    LDP0    @J,,AUTO
         2 002463   000000 235100                    LDA     0,,PR0
         2 002464   200337 755100                    STA     I,,AUTO

      733     6265    3        DO WHILE (CONTINUE) AND (I <= NO_OF_ATTACHMENTS);

   6265  2 002465   002652 710000 2                  TRA     s:6303

      734     6266    3             CALL BINCHAR (SCMD$CHAR, SCMD_NO);

   6266  2 002466   200027 235100                    LDA     SCMD_NO,,AUTO
         2 002467   000044 773000                    LRL     36
         2 002470   200370 757100                    STAQ    FATT$+2,,AUTO
         2 002471   000100 301500                    BTD
         2 002472   200370 000010                    NDSC9   FATT$+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 002473   200034 030002                    NDSC9   SCMD$CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=2

      735     6267    3             CALL GET_STORED_COMMAND (SCMD_SIZE, BUF$, SIZE);

   6267  2 002474   200021 630500                    EPPR0   SIZE,,AUTO
         2 002475   200345 450500                    STP0    @TEXT_SIZE,,AUTO
         2 002476   200013 631500                    EPPR1   BUF$,,AUTO
         2 002477   200344 451500                    STP1    @BUF$,,AUTO
         2 002500   200025 633500                    EPPR3   SCMD_SIZE,,AUTO
         2 002501   200343 453500                    STP3    @ATT#,,AUTO
         2 002502   001571 701000 2                  TSX1    GET_STORED_COMMAND
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:112  
         2 002503   000000 011000                    NOP     0

      736     6268    3             CALL CONCAT (SAVE_SCMD_TEXT, SUBSTR(BUFF$ER, 0, SCMD_SIZE));

   6268  2 002504   200013 470500                    LDP0    BUF$,,AUTO
         2 002505   200025 720100                    LXL0    SCMD_SIZE,,AUTO
         2 002506   040100 100540                    MLR     fill='040'O
         2 002507   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 002510   200035 000404                    ADSC9   SAVE_SCMD_TEXT,,AUTO     cn=0,n=260

      737     6269    3             SAVE_SCMD_SIZE = SCMD_SIZE;

   6269  2 002511   200025 235100                    LDA     SCMD_SIZE,,AUTO
         2 002512   200026 755100                    STA     SAVE_SCMD_SIZE,,AUTO

      738     6270    3             BUFF$ER = ' ';

   6270  2 002513   200021 721100                    LXL1    SIZE,,AUTO
         2 002514   040140 100400                    MLR     fill='040'O
         2 002515   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002516   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      739     6271    3             CALL GET_ATTACHMENT (I, ATTACH_SIZE, BUF$, SIZE) ALTRET (DELBUG);

   6271  2 002517   200021 630500                    EPPR0   SIZE,,AUTO
         2 002520   200346 450500                    STP0    @SCMD#,,AUTO
         2 002521   200013 631500                    EPPR1   BUF$,,AUTO
         2 002522   200345 451500                    STP1    @TEXT_SIZE,,AUTO
         2 002523   200022 633500                    EPPR3   ATTACH_SIZE,,AUTO
         2 002524   200344 453500                    STP3    @BUF$,,AUTO
         2 002525   200337 634500                    EPPR4   I,,AUTO
         2 002526   200343 454500                    STP4    @ATT#,,AUTO
         2 002527   001326 701000 2                  TSX1    GET_ATTACHMENT
         2 002530   002661 702000 2                  TSX2    DELBUG

      740     6272    3             FPTSINPUT.BUF_.BOUND = ATTACH_SIZE - 1;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:113  
   6272  2 002531   200022 236100                    LDQ     ATTACH_SIZE,,AUTO
         2 002532   000001 136007                    SBLQ    1,DL
         2 002533   000020 736000                    QLS     16
         2 002534   200330 676100                    ERQ     FPTSINPUT+4,,AUTO
         2 002535   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002536   200330 656100                    ERSQ    FPTSINPUT+4,,AUTO

      741     6273    3             CALL M$SINPUT (FPTSINPUT) ALTRET (ARET0);

   6273  2 002537   200324 630500                    EPPR0   FPTSINPUT,,AUTO
         2 002540   560013 713400                    CLIMB   alt,+57355
         2 002541   401000 401760                    pmme    nvectors=3
         2 002542   002671 702000 2                  TSX2    ARET0

      742     6274    3             CALL M$READ (FPTREAD) ALTRET (ARET0);

   6274  2 002543   200306 630500                    EPPR0   FPTREAD,,AUTO
         2 002544   440000 713400                    CLIMB   alt,read
         2 002545   401400 401760                    pmme    nvectors=4
         2 002546   002671 702000 2                  TSX2    ARET0

      743     6275    3             SIZE_READ = M$DELT$ -> F$DCB.ARS#;

   6275  2 002547   200014 470500                    LDP0    M$DELT$,,AUTO
         2 002550   000000 235100                    LDA     0,,PR0
         2 002551   200023 755100                    STA     SIZE_READ,,AUTO

      744     6276    3             ACT_CHAR = M$DELT$ -> F$DCB.EOMCHAR#;

   6276  2 002552   000003 236100                    LDQ     3,,PR0
         2 002553   000033 736000                    QLS     27
         2 002554   000006 276000 3                  ORQ     6
         2 002555   200033 756100                    STQ     ACT_CHAR,,AUTO

      745     6277    3             CALL REPLACE_TEXT (I, BUF$, SIZE_READ, SCMD_NO, '0'B) ALTRET (DELBUG);

   6277  2 002556   000005 236000 3                  LDQ     5
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:114  
         2 002557   200347 756100                    STQ     @ENTIRE,,AUTO
         2 002560   200027 631500                    EPPR1   SCMD_NO,,AUTO
         2 002561   200346 451500                    STP1    @SCMD#,,AUTO
         2 002562   200023 633500                    EPPR3   SIZE_READ,,AUTO
         2 002563   200345 453500                    STP3    @TEXT_SIZE,,AUTO
         2 002564   200013 634500                    EPPR4   BUF$,,AUTO
         2 002565   200344 454500                    STP4    @BUF$,,AUTO
         2 002566   200337 635500                    EPPR5   I,,AUTO
         2 002567   200343 455500                    STP5    @ATT#,,AUTO
         2 002570   001606 701000 2                  TSX1    REPLACE_TEXT
         2 002571   002661 702000 2                  TSX2    DELBUG

      746     6278                                                /* Check activation character */
      747     6279    3             CALL INDEX (IX, ACT_CHAR, ACHARS) ALTRET (UNKACT);

   6279  2 002572   000100 124400                    SCM     mask='000'O
         2 002573   000026 000003 1                  ADSC9   ACTABL                   cn=0,n=3
         2 002574   200033 000001                    ADSC9   ACT_CHAR,,AUTO           cn=0,n=1
         2 002575   200024 000100                    ARG     IX,,AUTO
         2 002576   002600 606400 2                  TTN     UNKACT

      748     6280    4             DO WHILE ('0'B);

   6280  2 002577   002602 710000 2                  TRA     s:6284

   6279  2 002600                       UNKACT       null
      749     6281    4   UNKACT:        ;
      750     6282    4                  IX = 3;

   6282  2 002600   000003 235007                    LDA     3,DL
         2 002601   200024 755100                    STA     IX,,AUTO

      751     6283    4                END;

      752     6284    3             ACT = IX;

   6284  2 002602   200336 470500                    LDP0    @ACT,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:115  
         2 002603   200024 235100                    LDA     IX,,AUTO
         2 002604   000000 755100                    STA     0,,PR0

      753     6285    4             DO CASE (IX);

   6285  2 002605   200024 236100                    LDQ     IX,,AUTO
         2 002606   000003 116007                    CMPQ    3,DL
         2 002607   002611 602006 2                  TNC     s:6285+4,QL
         2 002610   002635 710000 2                  TRA     s:6298
         2 002611   002614 710000 2                  TRA     s:6287
         2 002612   002616 710000 2                  TRA     s:6289
         2 002613   002622 710000 2                  TRA     s:6291

      754     6286    4               CASE (0);                   /* C/r */

      755     6287    4                  CONTINUE = '0'B;

   6287  2 002614   200340 450100                    STZ     CONTINUE,,AUTO
         2 002615   002646 710000 2                  TRA     s:6302

      756     6288    4               CASE (1);                   /* L/f */

      757     6289    4                  I = I + 1;

   6289  2 002616   200337 235100                    LDA     I,,AUTO
         2 002617   000001 035007                    ADLA    1,DL
         2 002620   200337 755100                    STA     I,,AUTO
         2 002621   002646 710000 2                  TRA     s:6302

      758     6290    4               CASE (2);                   /* ^ */

      759     6291    4                  IF I = 0

   6291  2 002622   200337 235100                    LDA     I,,AUTO
         2 002623   002632 601000 2                  TNZ     s:6296

      760     6292    5                  THEN DO;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:116  

      761     6293    5                       SCMD_NO = SCMD_NO - 1;

   6293  2 002624   200027 235100                    LDA     SCMD_NO,,AUTO
         2 002625   000001 135007                    SBLA    1,DL
         2 002626   200027 755100                    STA     SCMD_NO,,AUTO

      762     6294    5                       SET_ATTACH = '1'B;

   6294  2 002627   400000 236003                    LDQ     -131072,DU
         2 002630   200032 756100                    STQ     SET_ATTACH,,AUTO

      763     6295    5                     END;

   6295  2 002631   002646 710000 2                  TRA     s:6302

      764     6296    4                  ELSE I = I - 1;

   6296  2 002632   000001 135007                    SBLA    1,DL
         2 002633   200337 755100                    STA     I,,AUTO
         2 002634   002646 710000 2                  TRA     s:6302

      765     6297    4               CASE (ELSE);

      766     6298    4                  S_D.ERROR = 257; /* E@ACT_IGNORED_LF */

   6298  2 002635   000401 235007                    LDA     257,DL
         2 002636   000000 471400 xsym               LDP1    S_D$
         2 002637   100013 755100                    STA     11,,PR1

      767     6299    4                  CALL DDE$ERROR;

   6299  2 002640   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002641   000000 701000 xent               TSX1    DDE$ERROR
         2 002642   000000 011000                    NOP     0

      768     6300    4                  I = I + 1;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:117  

   6300  2 002643   200337 235100                    LDA     I,,AUTO
         2 002644   000001 035007                    ADLA    1,DL
         2 002645   200337 755100                    STA     I,,AUTO

      769     6301    4               END;

      770     6302    3             CALL GET_NO_ATTACH (NO_OF_ATTACHMENTS);

   6302  2 002646   200020 630500                    EPPR0   NO_OF_ATTACHMENTS,,AUTO
         2 002647   200343 450500                    STP0    @ATT#,,AUTO
         2 002650   001236 701000 2                  TSX1    GET_NO_ATTACH
         2 002651   000000 011000                    NOP     0

      771     6303    3           END;

   6303  2 002652   200340 234100                    SZN     CONTINUE,,AUTO
         2 002653   002657 605000 2                  TPL     s:6305
         2 002654   200020 236100                    LDQ     NO_OF_ATTACHMENTS,,AUTO
         2 002655   200337 116100                    CMPQ    I,,AUTO
         2 002656   002466 603000 2                  TRC     s:6266

      772     6304
      773     6305    2        RETURN;

   6305  2 002657   200334 221300                    LDX1  ! FPTSINPUT+8,,AUTO
         2 002660   000001 702211                    TSX2  ! 1,X1

      774     6306
      775     6307    2   DELBUG: S_D.ERROR = 502;           /* E@DELBUG */

   6307  2 002661   000766 235007       DELBUG       LDA     502,DL
         2 002662   000000 470400 xsym               LDP0    S_D$
         2 002663   000013 755100                    STA     11,,PR0

      776     6308    2        CALL DDE$ERROR;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:118  
   6308  2 002664   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002665   000000 701000 xent               TSX1    DDE$ERROR
         2 002666   000000 011000                    NOP     0

      777     6309    2        RETURN;

   6309  2 002667   200334 221300                    LDX1  ! FPTSINPUT+8,,AUTO
         2 002670   000001 702211                    TSX2  ! 1,X1

      778     6310
      779     6311    2   ARET0: CALL DUE$ERRMSG;

   6311  2 002671   000002 631400 xsym  ARET0        EPPR1   B_VECTNIL+2
         2 002672   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002673   000000 011000                    NOP     0

      780     6312    2        ALTRETURN;

   6312  2 002674   200334 221300                    LDX1  ! FPTSINPUT+8,,AUTO
         2 002675   000000 702211                    TSX2  ! 0,X1

      781     6313
      782     6314    2   END DO_ATTACHMENTS;
      783     6315
      784     6316        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:119  
      785     6317    1   SAVE_SCMD: PROC;

   6317  2 002676   200334 741300       SAVE_SCMD    STX1  ! FPTSINPUT+8,,AUTO

      786     6318        /* Auto */
      787     6319    2   DCL I UBIN;
      788     6320    2   DCL UBIN36 UBIN(36) BASED;
      789     6321
      790     6322    2        SAVE_FIXCOM = S_D.FIXCOM(SCMD_NO);

   6322  2 002677   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 002700   000030 402007                    MPY     24,DL
         2 002701   000000 470400 xsym               LDP0    S_D$
         2 002702   000100 100506                    MLR     fill='000'O
         2 002703   001212 000030                    ADSC9   650,Q,PR0                cn=0,n=24
         2 002704   200003 000030                    ADSC9   SAVE_FIXCOM,,AUTO        cn=0,n=24

      791     6323    2        SAVE_VARCOM_SIZE = S_D.FIXCOM.TAL(SCMD_NO);

   6323  2 002705   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 002706   000006 402007                    MPY     6,DL
         2 002707   001212 236106                    LDQ     650,QL,PR0
         2 002710   777777 376007                    ANQ     -1,DL
         2 002711   200303 756100                    STQ     SAVE_VARCOM_SIZE,,AUTO

      792     6324    3        DO I = 0 TO SAVE_VARCOM_SIZE - 1;

   6324  2 002712   200335 450100                    STZ     I,,AUTO
         2 002713   002731 710000 2                  TRA     s:6326+3

      793     6325    3            SAVE_VARCOM(I) = PINCRW(S_D.VARCOM$, S_D.FIXCOM.FAI(SCMD_NO)+I) -> UBIN36;

   6325  2 002714   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 002715   000006 402007                    MPY     6,DL
         2 002716   000000 470400 xsym               LDP0    S_D$
         2 002717   001214 236106                    LDQ     652,QL,PR0
         2 002720   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:120  
         2 002721   200335 036100                    ADLQ    I,,AUTO
         2 002722   004622 471500                    LDP1    2450,,PR0
         2 002723   200335 720100                    LXL0    I,,AUTO
         2 002724   100000 235106                    LDA     0,QL,PR1
         2 002725   200136 755110                    STA     SAVE_VARCOM,X0,AUTO

      794     6326    3           END;

   6326  2 002726   200335 236100                    LDQ     I,,AUTO
         2 002727   000001 036007                    ADLQ    1,DL
         2 002730   200335 756100                    STQ     I,,AUTO
         2 002731   200335 236100                    LDQ     I,,AUTO
         2 002732   200303 116100                    CMPQ    SAVE_VARCOM_SIZE,,AUTO
         2 002733   002714 602000 2                  TNC     s:6325

      795     6327    2   END SAVE_SCMD;

   6327  2 002734   200334 221300                    LDX1  ! FPTSINPUT+8,,AUTO
         2 002735   000001 702211                    TSX2  ! 1,X1

      796     6328        %EJECT;
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:121  
      797     6329    1   RESTORE_SCMD: PROC;

   6329  2 002736   200360 741300       RESTORE_SCMD STX1  ! CCMD+1,,AUTO

      798     6330        /* Auto */
      799     6331    2   DCL I UBIN;
      800     6332    2   DCL UBIN36 UBIN(36) BASED;
      801     6333    2   DCL TFPRG$ PTR;
      802     6334    2   DCL RES CHAR(8) CALIGNED;
      803     6335    2   DCL RES_SIZE UBIN;
      804     6336    2   DCL FATT$ PTR;
      805     6337        /* Includes and based structures */
      806     6338        %FPRG$CONTEXT;
      807     6401
      808     6402    2        S_D.FIXCOM(SCMD_NO) = SAVE_FIXCOM;

   6402  2 002737   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 002740   000030 402007                    MPY     24,DL
         2 002741   000000 470400 xsym               LDP0    S_D$
         2 002742   000106 100500                    MLR     fill='000'O
         2 002743   200003 000030                    ADSC9   SAVE_FIXCOM,,AUTO        cn=0,n=24
         2 002744   001212 000030                    ADSC9   650,Q,PR0                cn=0,n=24

      809     6403    2        S_D.FIXCOM.FAI(SCMD_NO) = POFFW(S_D.VARNEXT$, S_D.VARCOM$);

   6403  2 002745   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 002746   000006 402007                    MPY     6,DL
         2 002747   000000 620006                    EAX0    0,QL
         2 002750   004622 236100                    LDQ     2450,,PR0
         2 002751   000022 772000                    QRL     18
         2 002752   200370 756100                    STQ     FATT$+2,,AUTO
         2 002753   000033 236100                    LDQ     27,,PR0
         2 002754   000022 772000                    QRL     18
         2 002755   200370 136100                    SBLQ    FATT$+2,,AUTO
         2 002756   000000 621006                    EAX1    0,QL
         2 002757   001214 441110                    SXL1    652,X0,PR0

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:122  
      810     6404    3        DO I = 0 TO SAVE_VARCOM_SIZE - 1;

   6404  2 002760   200361 450100                    STZ     I,,AUTO
         2 002761   002775 710000 2                  TRA     s:6407+3

      811     6405    3             S_D.VARNEXT$ -> UBIN36 = SAVE_VARCOM(I);

   6405  2 002762   000000 470400 xsym               LDP0    S_D$
         2 002763   000033 471500                    LDP1    27,,PR0
         2 002764   200361 720100                    LXL0    I,,AUTO
         2 002765   200136 235110                    LDA     SAVE_VARCOM,X0,AUTO
         2 002766   100000 755100                    STA     0,,PR1

      812     6406    3             S_D.VARNEXT$ = PINCRW(S_D.VARNEXT$, 1);

   6406  2 002767   000033 236100                    LDQ     27,,PR0
         2 002770   000001 036003                    ADLQ    1,DU
         2 002771   000033 756100                    STQ     27,,PR0

      813     6407    3           END;

   6407  2 002772   200361 235100                    LDA     I,,AUTO
         2 002773   000001 035007                    ADLA    1,DL
         2 002774   200361 755100                    STA     I,,AUTO
         2 002775   200361 236100                    LDQ     I,,AUTO
         2 002776   200303 116100                    CMPQ    SAVE_VARCOM_SIZE,,AUTO
         2 002777   002762 602000 2                  TNC     s:6405

      814     6408    2        TFPRG$ = S_D.FPRG_CONTEXT$;

   6408  2 003000   000076 236100                    LDQ     62,,PR0
         2 003001   200362 756100                    STQ     TFPRG$,,AUTO

      815     6409    2        IF TFPRG$ = ADDR(NIL)

   6409  2 003002   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003003   003111 600000 2                  TZE     RET
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:123  

      816     6410    2        THEN GOTO RET;
      817     6411    2        RES = S_D.FIXCOM.FPRG_RES(SCMD_NO);

   6411  2 003004   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 003005   000030 402007                    MPY     24,DL
         2 003006   040100 100506                    MLR     fill='040'O
         2 003007   001215 000010                    ADSC9   653,Q,PR0                cn=0,n=8
         2 003010   200363 000010                    ADSC9   RES,,AUTO                cn=0,n=8

      818     6412    2        RES_SIZE = S_D.FIXCOM.FPRG_RES_SIZE(SCMD_NO);

   6412  2 003011   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 003012   000006 402007                    MPY     6,DL
         2 003013   001217 235106                    LDA     655,QL,PR0
         2 003014   200365 755100                    STA     RES_SIZE,,AUTO

      819     6413    3        DO WHILE (SUBSTR(RES, 0, RES_SIZE) ~= SUBSTR(TFPRG$->FPRG$CONTEXT.RES,

   6413  2 003015   003023 710000 2                  TRA     s:6418

      820     6414    3          0, TFPRG$->FPRG$CONTEXT.RES_SIZE));
      821     6415    3             TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

   6415  2 003016   200362 470500                    LDP0    TFPRG$,,AUTO
         2 003017   000000 236100                    LDQ     0,,PR0
         2 003020   200362 756100                    STQ     TFPRG$,,AUTO

      822     6416    3             IF TFPRG$ = ADDR(NIL)

   6416  2 003021   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003022   003103 600000 2                  TZE     FPRG_ERR

      823     6417    3             THEN GOTO FPRG_ERR;
      824     6418    3           END;

   6418  2 003023   200362 470500                    LDP0    TFPRG$,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:124  
         2 003024   000004 720100                    LXL0    4,,PR0
         2 003025   200365 721100                    LXL1    RES_SIZE,,AUTO
         2 003026   040140 106540                    CMPC    fill='040'O
         2 003027   200363 000011                    ADSC9   RES,,AUTO                cn=0,n=*X1
         2 003030   000002 000010                    ADSC9   2,,PR0                   cn=0,n=*X0
         2 003031   003016 601000 2                  TNZ     s:6415

      825     6419    2        I = 1;

   6419  2 003032   000001 235007                    LDA     1,DL
         2 003033   200361 755100                    STA     I,,AUTO

      826     6420    3        DO WHILE (TFPRG$->FPRG$CONTEXT.FIXCOM_INDEX(I) ~= 0

   6420  2 003034   003040 710000 2                  TRA     s:6423

      827     6421    3          AND I <= 20);
      828     6422    3             I = I + 1;

   6422  2 003035   200361 235100                    LDA     I,,AUTO
         2 003036   000001 035007                    ADLA    1,DL
         2 003037   200361 755100                    STA     I,,AUTO

      829     6423    3           END;

   6423  2 003040   200362 470500                    LDP0    TFPRG$,,AUTO
         2 003041   000034 235105                    LDA     28,AL,PR0
         2 003042   003046 600000 2                  TZE     s:6424
         2 003043   200361 235100                    LDA     I,,AUTO
         2 003044   000025 115007                    CMPA    21,DL
         2 003045   003035 602000 2                  TNC     s:6422

      830     6424    2        IF I > 20

   6424  2 003046   200361 235100                    LDA     I,,AUTO
         2 003047   000025 115007                    CMPA    21,DL
         2 003050   003055 602000 2                  TNC     s:6429
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:125  

      831     6425    3        THEN DO;

      832     6426    3             S_D.ERROR = 288;  /* E@TOOMANYBKPNTS */

   6426  2 003051   000440 236007                    LDQ     288,DL
         2 003052   000000 471400 xsym               LDP1    S_D$
         2 003053   100013 756100                    STQ     11,,PR1

      833     6427    3             GOTO ALTRT;

   6427  2 003054   003106 710000 2                  TRA     ALTRT

      834     6428    3           END;
      835     6429    2        TFPRG$ -> FPRG$CONTEXT.FIXCOM_INDEX(I) = SCMD_NO;

   6429  2 003055   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 003056   000034 756105                    STQ     28,AL,PR0

      836     6430    2        FATT$ = PINCRW(S_D.VARCOM$, S_D.FIXCOM.FAI(SCMD_NO));

   6430  2 003057   200027 236100                    LDQ     SCMD_NO,,AUTO
         2 003060   000006 402007                    MPY     6,DL
         2 003061   000000 471400 xsym               LDP1    S_D$
         2 003062   101214 720106                    LXL0    652,QL,PR1
         2 003063   104622 473500                    LDP3    2450,,PR1
         2 003064   300000 634510                    EPPR4   0,X0,PR3
         2 003065   200366 454500                    STP4    FATT$,,AUTO

      837     6431    2        CALL DFA$SET_AT(I, FATT$ -> AT_FIRST.BYPASS_COUNT, SCMD_NO) ALTRET(ALTRT);

   6431  2 003066   200027 635500                    EPPR5   SCMD_NO,,AUTO
         2 003067   200372 455500                    STP5    FATT$+4,,AUTO
         2 003070   200366 236100                    LDQ     FATT$,,AUTO
         2 003071   000004 036003                    ADLQ    4,DU
         2 003072   200371 756100                    STQ     FATT$+3,,AUTO
         2 003073   200361 636500                    EPPR6   I,,AUTO
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:126  
         2 003074   200370 456500                    STP6    FATT$+2,,AUTO
         2 003075   200370 630500                    EPPR0   FATT$+2,,AUTO
         2 003076   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003077   000000 701000 xent               TSX1    DFA$SET_AT
         2 003100   003106 702000 2                  TSX2    ALTRT

      838     6432    2        RETURN;

   6432  2 003101   200360 221300                    LDX1  ! CCMD+1,,AUTO
         2 003102   000001 702211                    TSX2  ! 1,X1

   6430  2 003103                       FPRG_ERR     null
      839     6433
      840     6434    2   FPRG_ERR: ;
      841     6435    2        S_D.ERROR = 502;              /* E@DELBUG */

   6435  2 003103   000766 235007                    LDA     502,DL
         2 003104   000000 470400 xsym               LDP0    S_D$
         2 003105   000013 755100                    STA     11,,PR0

   6435  2 003106                       ALTRT        null
      842     6436
      843     6437    2   ALTRT: ;
      844     6438    2        CALL DDE$ERROR;

   6438  2 003106   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003107   000000 701000 xent               TSX1    DDE$ERROR
         2 003110   000000 011000                    NOP     0

   6435  2 003111                       RET          null
      845     6439    2   RET: ;
      846     6440    2        RETURN;

   6440  2 003111   200360 221300                    LDX1  ! CCMD+1,,AUTO
         2 003112   000001 702211                    TSX2  ! 1,X1

FPT_READ
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:127  
 Sect OctLoc
   1     000   000005 777640   000010 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     010   000000 400000   000000 000000   000000 000000   000000 000000    ................
   1     014   000000 000000   000000 000000                                    ........

FPT_SINPUT
 Sect OctLoc
   1     016   000001 777640   000024 006000   000000 177640   000000 006014    ................
   1     022   000000 17764*   000000 006014   000000 400000   000000 000000    ................

ACTABL
 Sect OctLoc
   1     026   015012 136***                                                    ..^.

(unnamed)
 Sect OctLoc
   1     027   123164 157162   145144 040104   151162 145143   164151 166145    Stored Directive
   1     033   040043 040040   060061 062063   064065 066067   070071 040040     #  0123456789

(unnamed)
 Sect OctLoc
   3     000   000005 777640   000001 777640   000000 006003   000000 000024    ................
   3     004   000003 006000   000002 006000   000040 040040   000030 006000    .........   ....
   3     010   073040 040040                                                    ;
      847     6441    2   END RESTORE_SCMD;
      848     6442
      849     6443    1   END DDA$UPDATE;

PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:128  
--  Include file information  --

   DD$BASED.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDA$UPDATE.

   Procedure DDA$UPDATE requires 1611 words for executable code.
   Procedure DDA$UPDATE requires 252 words of local(AUTO) storage.

    No errors detected in file DDA$UPDATE.:E05TSI    .
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:129  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:130  
          MINI XREF LISTING

ACHARS
      5616**DCL      5711>>CALLBLT  5760>>CALLBLT  6279>>CALLBLT
ACT IN PROCEDURE DO_ATTACHMENTS
      6254**DCL      6250--PROC     6284<<ASSIGN
ACTABL
      5612**DCL      5616--REDEF
ACT_CHAR
      5436**DCL      5708<<ASSIGN   5711>>CALLBLT  5757<<ASSIGN   5760>>CALLBLT  6276<<ASSIGN   6279>>CALLBLT
ALT
      5858**LABEL    5667--CALLALT  5668--CALLALT  5697--CALLALT  5744--GOTO     5803--GOTO
ALTRT IN PROCEDURE RESTORE_SCMD
      6435**LABEL    6427--GOTO     6431--CALLALT
ARET0
      5851**LABEL    5705--CALLALT  5706--CALLALT  5754--CALLALT  5755--CALLALT
ARET0 IN PROCEDURE DO_ATTACHMENTS
      6311**LABEL    6273--CALLALT  6274--CALLALT
ATT# IN PROCEDURE GET_ATTACHMENT
      5925**DCL      5922--PROC     5950>>DOUNTIL  5975>>IF
ATT# IN PROCEDURE GET_NO_ATTACH
      5872**DCL      5869--PROC     5888<<ASSIGN   5890<<ASSIGN   5898<<ASSIGN   5898>>ASSIGN
ATT# IN PROCEDURE REPLACE_TEXT
      6057**DCL      6054--PROC     6093>>DOUNTIL  6146>>IF
ATT$ IN PROCEDURE GET_NO_ATTACH
      5876**DCL      5893<<ASSIGN   5897>>CALLBLT
ATTACHMENT_NO
      5433**DCL      5735<<ASSIGN   5752<>CALL     5758<>CALL     5769<<ASSIGN   5769>>ASSIGN   5770>>IF
      5772<<ASSIGN   5776>>IF       5781<<ASSIGN   5785<<ASSIGN   5785>>ASSIGN   5795<<ASSIGN   5810<>CALL
      5812>>IF       5834<>CALL     5845<>CALL
ATTACH_SIZE
      5427**DCL      5752<>CALL     5753>>ASSIGN   5810<>CALL     6271<>CALL     6272>>ASSIGN
ATT_SIZE IN PROCEDURE GET_ATTACHMENT
      5926**DCL      5922--PROC     5960<<ASSIGN   5961>>ASSIGN   5965<<ASSIGN   5966>>ASSIGN   5970<<ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:131  
      5971>>ASSIGN   5982<<ASSIGN   5983>>ASSIGN   5987<<ASSIGN   5988>>ASSIGN   5992<<ASSIGN   5993>>ASSIGN
ATT_SIZE IN PROCEDURE GET_NO_ATTACH
      5877**DCL      5883--IMP-SIZ  5891<<ASSIGN   5897>>CALLBLT
AT_FIRST.ATT_OFFSET
      5356**DCL      5887>>IF       5894>>ASSIGN
AT_FIRST.BYPASS_COUNT
      5351**DCL      6431<>CALL
AT_FIRST.TEXT_OFFSET
      5354**DCL      5840>>ASSIGN   5893>>ASSIGN   5946>>ASSIGN   6087>>ASSIGN
AT_FIRST.TEXT_SIZE
      5355**DCL      5692>>ASSIGN   5841>>ASSIGN   5891>>ASSIGN   5947>>ASSIGN   6089>>ASSIGN
AT_FIRST.UNUSED
      5336**DCL      5337--REDEF    5341--REDEF
BUF$
      5420**DCL      5445--IMP-PTR  5629<<ASSIGN   5631>>ASSIGN   5634>>ASSIGN   5639>>ASSIGN   5700>>ASSIGN
      5701<>CALL     5709<>CALL     5748<>CALL     5751>>ASSIGN   5752<>CALL     5758<>CALL     5806<>CALL
      5810<>CALL     5842>>CALLBLT  5845<>CALL     6267<>CALL     6268>>CALLBLT  6270>>ASSIGN   6271<>CALL
      6277<>CALL
BUF$ IN PROCEDURE GET_ATTACHMENT
      5927**DCL      5922--PROC     5940--IMP-PTR  5961>>ASSIGN   5966>>ASSIGN   5971>>ASSIGN   5983>>ASSIGN
      5988>>ASSIGN   5993>>ASSIGN
BUF$ IN PROCEDURE GET_STORED_COMMAND
      6018**DCL      6014--PROC     6029--IMP-PTR
BUF$ IN PROCEDURE REPLACE_TEXT
      6058**DCL      6054--PROC     6074--IMP-PTR  6080>>ASSIGN   6127>>CALLBLT  6134>>CALLBLT  6139>>CALLBLT
      6172>>ASSIGN   6182>>CALLBLT
BUFF$ER
      5445**DCL      5631<<ASSIGN   5634--ASSIGN   5639--ASSIGN   5700<<ASSIGN   5751<<ASSIGN   5842<<CALLBLT
      6268>>CALLBLT  6270<<ASSIGN
BUF_SIZE IN PROCEDURE GET_ATTACHMENT
      5928**DCL      5922--PROC     5940--IMP-SIZ  5961>>ASSIGN   5966>>ASSIGN   5971>>ASSIGN   5983>>ASSIGN
      5988>>ASSIGN   5993>>ASSIGN
BUF_SIZE IN PROCEDURE GET_STORED_COMMAND
      6019**DCL      6014--PROC     6029--IMP-SIZ
CCMD
      5441**DCL      5815<<ASSIGN   5818<>CALL     5820>>IF       5822>>IF       5824>>IF       5826>>IF
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:132  
CCMD IN PROCEDURE REPLACE_TEXT
      6071**DCL      6102<<ASSIGN   6103>>IF       6108<>CALL     6110>>IF       6112>>IF       6114>>IF
      6116>>IF       6152<<ASSIGN   6153>>IF       6156>>IF       6158>>IF       6160>>IF       6162>>IF
      6195<<ASSIGN   6196>>IF       6201<>CALL     6203>>IF       6205>>IF       6207>>IF       6209>>IF
CHAR$ATT IN PROCEDURE GET_ATTACHMENT
      5941**DCL      5953>>CALLBLT  5957>>CALLBLT  5961>>ASSIGN   5964>>CALLBLT  5966>>ASSIGN   5971>>ASSIGN
      5979>>CALLBLT  5983>>ASSIGN   5986>>CALLBLT  5988>>ASSIGN   5993>>ASSIGN
CHAR$ATT IN PROCEDURE GET_NO_ATTACH
      5883**DCL      5897>>CALLBLT
CHAR$ATT IN PROCEDURE REPLACE_TEXT
      6075**DCL      6096>>CALLBLT  6127>>CALLBLT  6134>>CALLBLT  6134>>CALLBLT  6139>>CALLBLT  6139>>CALLBLT
      6178>>CALLBLT  6182>>CALLBLT
CONTINUE
      5434**DCL      5649<<ASSIGN   5650>>DOWHILE  5659<<ASSIGN   5672<<ASSIGN   5678<<ASSIGN   5679>>DOWHILE
      5688<<ASSIGN   5719<<ASSIGN   5733<<ASSIGN   5736>>DOWHILE  5767<<ASSIGN   5784<<ASSIGN   5789<<ASSIGN
CONTINUE IN PROCEDURE DO_ATTACHMENTS
      6258**DCL      6261<<ASSIGN   6265>>DOWHILE  6287<<ASSIGN
DDA$KILL1
      5619**DCL-ENT  5828--CALL     6118--CALL     6164--CALL     6211--CALL
DDA$SHOW1
      5620**DCL-ENT  6033--CALL
DDE$ERROR
      5623**DCL-ENT  5658--CALL     5687--CALL     5696--CALL     5725--CALL     5788--CALL     5854--CALL
      6227--CALL     6231--CALL     6299--CALL     6308--CALL     6438--CALL
DDQ$WRITE
      5621**DCL-ENT  5664--CALL     6229--CALL
DDS$SCAN1
      5622**DCL-ENT  6221--CALL
DELBUG
      5853**LABEL    5709--CALLALT  5758--CALLALT  5834--CALLALT  5845--CALLALT
DELBUG IN PROCEDURE DO_ATTACHMENTS
      6307**LABEL    6271--CALLALT  6277--CALLALT
DFA$KILL1
      5624**DCL-ENT  5818--CALL     6108--CALL     6201--CALL
DFA$SET_AT
      5625**DCL-ENT  6431--CALL
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:133  
DO$
      5418**DCL      5285--IMP-PTR  5642<<ASSIGN   5644>>DOCASE   5646>>IF       5648>>ASSIGN   5671>>IF
      5677>>ASSIGN   5718>>IF       5734>>ASSIGN   5735>>ASSIGN   5794>>ASSIGN   5795>>ASSIGN   5808>>IF
      5811>>ASSIGN   5842>>CALLBLT  5842>>CALLBLT  5842>>CALLBLT  5844>>ASSIGN
DO_ATTACHMENTS
      6250**PROC     5667--CALL     5668--CALL     5697--CALL
DUE$ERRMSG
      5626**DCL-ENT  5851--CALL     6311--CALL
D_M$DELT#
      5452**DCL      5635>>ASSIGN   5640--ASSIGN
ENTIRE IN PROCEDURE REPLACE_TEXT
      6061**DCL      6054--PROC     6078>>IF
F$DCB.ACTPOS
      5392**DCL      5392--REDEF
F$DCB.ARS#
      5366**DCL      5366--REDEF    5707>>ASSIGN   5756>>ASSIGN   6275>>ASSIGN
F$DCB.ATTR
      5385**DCL      5386--REDEF
F$DCB.BORROW
      5400**DCL      5400--REDEF    5400--REDEF    5400--REDEF
F$DCB.DCBNAME.L
      5414**DCL      5414--IMP-SIZ
F$DCB.EOMCHAR#
      5370**DCL      5370--REDEF    5708>>ASSIGN   5757>>ASSIGN   6276>>ASSIGN
F$DCB.FLDID
      5395**DCL      5395--REDEF
F$DCB.FORM$
      5389**DCL      5389--REDEF
F$DCB.FSECT
      5405**DCL      5405--REDEF
F$DCB.FSN#
      5382**DCL      5382--REDEF    5382--REDEF    5383--REDEF
F$DCB.HEADER$
      5388**DCL      5388--REDEF
F$DCB.IXTNSIZE#
      5386**DCL      5386--REDEF
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:134  
F$DCB.LASTSTA$
      5375**DCL      5375--REDEF
F$DCB.LVL
      5401**DCL      5401--REDEF
F$DCB.NAME#.C
      5376**DCL      5376--REDEF
F$DCB.NOEOF
      5398**DCL      5398--REDEF
F$DCB.NRECS#
      5387**DCL      5387--REDEF
F$DCB.NRECX
      5406**DCL      5406--REDEF
F$DCB.OHDR
      5398**DCL      5398--REDEF
F$DCB.ORG#
      5381**DCL      5381--REDEF
F$DCB.PRECNO
      5404**DCL      5404--REDEF
F$DCB.RCSZ
      5410**DCL      5410--REDEF
F$DCB.RES#
      5377**DCL      5377--REDEF
F$DCB.SETX
      5389**DCL      5389--REDEF
F$DCB.TAB$
      5389**DCL      5389--REDEF
F$DCB.TDA
      5403**DCL      5404--REDEF
F$DCB.WSN#
      5377**DCL      5377--REDEF
F$XCM
      5300**DCL      5652--ASSIGN   5681--ASSIGN   5738--ASSIGN   5779--ASSIGN   5797--ASSIGN
F$XCM.CMD
      5301**DCL      5654>>IF       5683>>IF       5740>>IF       5799>>IF
F$XCM.FAI
      5311**DCL      5692>>ASSIGN   5839>>ASSIGN   5886>>ASSIGN   5944>>ASSIGN   6085>>ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:135  
FATT$
      5423**DCL      5839<<ASSIGN   5840>>ASSIGN   5840>>ASSIGN   5841>>ASSIGN
FATT$ IN PROCEDURE GET_ATTACHMENT
      5931**DCL      5944<<ASSIGN   5946>>ASSIGN   5946>>ASSIGN   5947>>ASSIGN
FATT$ IN PROCEDURE GET_NO_ATTACH
      5875**DCL      5886<<ASSIGN   5887>>IF       5891>>ASSIGN   5893>>ASSIGN   5893>>ASSIGN   5894>>ASSIGN
FATT$ IN PROCEDURE REPLACE_TEXT
      6065**DCL      6085<<ASSIGN   6087>>ASSIGN   6087>>ASSIGN   6089>>ASSIGN
FATT$ IN PROCEDURE RESTORE_SCMD
      6336**DCL      6430<<ASSIGN   6431>>CALL
FPRG
      5442**DCL      5816<<ASSIGN   5817>>IF       6106<<ASSIGN   6107>>IF       6199<<ASSIGN   6200>>IF
FPRG$CONTEXT.FIXCOM_INDEX IN PROCEDURE RESTORE_SCMD
      6379**DCL      6420>>DOWHILE  6429<<ASSIGN
FPRG$CONTEXT.NEXT$ IN PROCEDURE RESTORE_SCMD
      6340**DCL      6415>>ASSIGN
FPRG$CONTEXT.RES IN PROCEDURE RESTORE_SCMD
      6359**DCL      6413>>DOWHILE
FPRG$CONTEXT.RES_SIZE IN PROCEDURE RESTORE_SCMD
      6361**DCL      6413>>DOWHILE
FPRG_ERR IN PROCEDURE RESTORE_SCMD
      6430**LABEL    6417--GOTO
FPTREAD
      5472**DCL      5632<<ASSIGN   5706<>CALL     5755<>CALL     6274<>CALL
FPTREAD.BUF_
      5474**DCL      5634<<ASSIGN
FPTREAD.STATION_
      5475**DCL      5476--REDEF
FPTREAD.V
      5476**DCL      5633--ASSIGN
FPTREAD.V.DCB#
      5476**DCL      5635<<ASSIGN
FPTREAD.V.DVBYTE.REREAD#
      5487**DCL      5487--REDEF    5636<<ASSIGN
FPTREAD.V.INDX#
      5485**DCL      5485--REDEF
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:136  
FPTREAD.V_
      5472**DCL      5633<<ASSIGN
FPTSINPUT
      5511**DCL      5637<<ASSIGN   5705<>CALL     5754<>CALL     6273<>CALL
FPTSINPUT.BUF_
      5518**DCL      5639<<ASSIGN
FPTSINPUT.BUF_.BOUND
      5518**DCL      5704<<ASSIGN   5753<<ASSIGN   6272<<ASSIGN
FPTSINPUT.V
      5523**DCL      5638--ASSIGN
FPTSINPUT.V_
      5513**DCL      5638<<ASSIGN
FPT_READ
      5552**DCL      5632>>ASSIGN
FPT_READ.STATION_
      5555**DCL      5556--REDEF
FPT_READ.V
      5556**DCL      5552--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      5567**DCL      5567--REDEF
FPT_READ.V.INDX#
      5565**DCL      5565--REDEF
FPT_SINPUT
      5591**DCL      5637>>ASSIGN
FPT_SINPUT.V
      5603**DCL      5593--DCLINIT
GET_ATTACHMENT
      5922**PROC     5752--CALL     5810--CALL     6271--CALL
GET_NO_ATTACH
      5869**PROC     5665--CALL     5750--CALL     5780--CALL     6302--CALL
GET_STORED_COMMAND
      6014**PROC     5701--CALL     5748--CALL     5806--CALL     6267--CALL
GOT_SEMI IN PROCEDURE GET_NO_ATTACH
      5880**DCL      5895<<ASSIGN   5896>>DOWHILE  5901<<ASSIGN
I IN PROCEDURE DO_ATTACHMENTS
      6257**DCL      6263<<ASSIGN   6264<<ASSIGN   6265>>DOWHILE  6271<>CALL     6277<>CALL     6289<<ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:137  
      6289>>ASSIGN   6291>>IF       6296<<ASSIGN   6296>>ASSIGN   6300<<ASSIGN   6300>>ASSIGN
I IN PROCEDURE RESTORE_SCMD
      6331**DCL      6404<<DOINDEX  6405>>ASSIGN   6419<<ASSIGN   6420>>DOWHILE  6420>>DOWHILE  6422<<ASSIGN
      6422>>ASSIGN   6424>>IF       6429>>ASSIGN   6431<>CALL
I IN PROCEDURE SAVE_SCMD
      6319**DCL      6324<<DOINDEX  6325>>ASSIGN   6325>>ASSIGN
IX
      5429**DCL      5667<>CALL     5668<>CALL     5671>>IF       5697<>CALL     5711<<CALLBLT  5714<<ASSIGN
      5716>>DOCASE   5718>>IF       5760<<CALLBLT  5763<<ASSIGN   5765>>DOCASE   6279<<CALLBLT  6282<<ASSIGN
      6284>>ASSIGN   6285>>DOCASE
J IN PROCEDURE DO_ATTACHMENTS
      6253**DCL      6250--PROC     6262--IF       6264>>ASSIGN
K IN PROCEDURE GET_ATTACHMENT
      5933**DCL      5949<<ASSIGN   5950>>DOUNTIL  5951<<ASSIGN   5951>>ASSIGN   5955>>IF       5975>>IF
      5977>>IF
K IN PROCEDURE REPLACE_TEXT
      6070**DCL      6092<<ASSIGN   6093>>DOUNTIL  6094<<ASSIGN   6094>>ASSIGN   6098>>IF       6146>>IF
      6148>>IF
M$DELT$
      5421**DCL      5640<<ASSIGN   5707>>ASSIGN   5708>>ASSIGN   5756>>ASSIGN   5757>>ASSIGN   6275>>ASSIGN
      6276>>ASSIGN
M$READ
        29**DCL-ENT  5706--CALL     5755--CALL     6274--CALL
M$SINPUT
        55**DCL-ENT  5705--CALL     5754--CALL     6273--CALL
NO_ATTACH
      5856**LABEL    5752--CALLALT  5810--CALLALT
NO_OF_ATTACHMENTS
      5425**DCL      5665<>CALL     5667<>CALL     5750<>CALL     5770>>IF       5780<>CALL     5781>>ASSIGN
      6265>>DOWHILE  6302<>CALL
NO_SEMI IN PROCEDURE GET_ATTACHMENT
      5969**LABEL    5953--CALLALT
NO_SEMI IN PROCEDURE GET_NO_ATTACH
      5901**LABEL    5897--CALLALT
NO_SEMI IN PROCEDURE REPLACE_TEXT
      6139**LABEL    6096--CALLALT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:138  
POSITION IN PROCEDURE GET_ATTACHMENT
      5936**DCL      5957<<CALLBLT  5958>>IF       5964<<CALLBLT  5965>>ASSIGN   5966>>ASSIGN   5979<<CALLBLT
      5980>>IF       5986<<CALLBLT  5988>>ASSIGN
REPL$TEXT IN PROCEDURE REPLACE_TEXT
      6074**DCL      6080>>ASSIGN   6127>>CALLBLT  6134>>CALLBLT  6139>>CALLBLT  6172>>ASSIGN   6182>>CALLBLT
REPLACE_TEXT
      6054**PROC     5709--CALL     5758--CALL     5834--CALL     5845--CALL     6277--CALL
RES IN PROCEDURE RESTORE_SCMD
      6334**DCL      6411<<ASSIGN   6413>>DOWHILE
RESTORE_SAVED IN PROCEDURE REPLACE_TEXT
      6218**LABEL    6221--CALLALT
RESTORE_SCMD
      6329**PROC     6232--CALL
RES_SIZE IN PROCEDURE RESTORE_SCMD
      6335**DCL      6412<<ASSIGN   6413>>DOWHILE
RET
      5849**LABEL    5852--GOTO     5855--GOTO
RET IN PROCEDURE REPLACE_TEXT
      6218**LABEL    6120--GOTO     6165--GOTO     6219--GOTO
RET IN PROCEDURE RESTORE_SCMD
      6435**LABEL    6410--GOTO
SAVE_FIXCOM
      5316**DCL      6322<<ASSIGN   6402>>ASSIGN
SAVE_SCMD
      6317**PROC     5703--CALL     5749--CALL     5807--CALL
SAVE_SCMD_SIZE
      5431**DCL      6269<<ASSIGN
SAVE_SCMD_TEXT
      5438**DCL      6268<<CALLBLT
SAVE_VARCOM
      5439**DCL      6325<<ASSIGN   6405>>ASSIGN
SAVE_VARCOM_SIZE
      5440**DCL      6323<<ASSIGN   6324>>DOINDEX  6404>>DOINDEX
SCMD# IN PROCEDURE REPLACE_TEXT
      6060**DCL      6054--PROC     6077>>CALLBLT  6102>>ASSIGN   6105>>ASSIGN   6106>>ASSIGN   6152>>ASSIGN
      6155>>ASSIGN   6195>>ASSIGN   6198>>ASSIGN   6199>>ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:139  
SCMD$
      5419**DCL      5652<<ASSIGN   5654>>IF       5681<<ASSIGN   5683>>IF       5692>>ASSIGN   5738<<ASSIGN
      5740>>IF       5779<<ASSIGN   5797<<ASSIGN   5799>>IF       5839>>ASSIGN   5886>>ASSIGN   5944>>ASSIGN
      6085>>ASSIGN
SCMD$CHAR
      5437**DCL      5662<<CALLBLT  5663>>CALLBLT  5664--CALL     5702<<CALLBLT  5747<<CALLBLT  5805<<CALLBLT
      6266<<CALLBLT
SCMD$CHAR IN PROCEDURE REPLACE_TEXT
      6064**DCL      6077<<CALLBLT
SCMD$TEXT
      5449**DCL      5842>>CALLBLT
SCMD_NO
      5432**DCL      5648<<ASSIGN   5650>>DOWHILE  5650>>DOWHILE  5652>>ASSIGN   5656>>ASSIGN   5662>>CALLBLT
      5670<<ASSIGN   5670>>ASSIGN   5671>>IF       5677<<ASSIGN   5679>>DOWHILE  5679>>DOWHILE  5681>>ASSIGN
      5685>>ASSIGN   5702>>CALLBLT  5709<>CALL     5718>>IF       5720<<ASSIGN   5720>>ASSIGN   5722<<ASSIGN
      5722>>ASSIGN   5726<<ASSIGN   5726>>ASSIGN   5734<<ASSIGN   5738>>ASSIGN   5742>>ASSIGN   5747>>CALLBLT
      5758<>CALL     5773<<ASSIGN   5773>>ASSIGN   5776>>IF       5778<<ASSIGN   5778>>ASSIGN   5779>>ASSIGN
      5783>>IF       5794<<ASSIGN   5797>>ASSIGN   5801>>ASSIGN   5805>>CALLBLT  5814>>ASSIGN   5815>>ASSIGN
      5816>>ASSIGN   5834<>CALL     5845<>CALL     6032>>ASSIGN   6266>>CALLBLT  6277<>CALL     6293<<ASSIGN
      6293>>ASSIGN   6322>>ASSIGN   6323>>ASSIGN   6325>>ASSIGN   6402>>ASSIGN   6403>>ASSIGN   6411>>ASSIGN
      6412>>ASSIGN   6429>>ASSIGN   6430>>ASSIGN   6431<>CALL
SCMD_SIZE
      5430**DCL      5449--IMP-SIZ  5692<<ASSIGN   5693>>IF       5701<>CALL     5704>>ASSIGN   5748<>CALL
      5806<>CALL     5833<<ASSIGN   5834<>CALL     5841<<ASSIGN   5842>>CALLBLT  5842>>CALLBLT  5844<<ASSIGN
      5844>>ASSIGN   5845<>CALL     6267<>CALL     6268>>CALLBLT  6269>>ASSIGN
SCMD_SIZE IN PROCEDURE GET_STORED_COMMAND
      6017**DCL      6014--PROC     6033<>CALL
SCMD_TEXT$
      5424**DCL      5449--IMP-PTR  5832<<ASSIGN   5834<>CALL     5840<<ASSIGN   5842>>CALLBLT
SEMI_POSITION IN PROCEDURE GET_ATTACHMENT
      5935**DCL      5948<<ASSIGN   5952>>ASSIGN   5953<<CALLBLT  5960>>ASSIGN   5965>>ASSIGN   5970>>ASSIGN
      5987>>ASSIGN
SEMI_POSITION IN PROCEDURE GET_NO_ATTACH
      5879**DCL      5897<<CALLBLT  5899>>ASSIGN
SEMI_POSITION IN PROCEDURE REPLACE_TEXT
      6069**DCL      6091<<ASSIGN   6095>>ASSIGN   6096<<CALLBLT  6127>>CALLBLT  6127>>CALLBLT  6129>>ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:140  
      6134>>CALLBLT  6134>>CALLBLT  6136>>ASSIGN   6139>>CALLBLT  6139>>CALLBLT  6141>>ASSIGN
SET_ATTACH
      5435**DCL      5641<<ASSIGN   5666>>IF       5669>>IF       6260<<ASSIGN   6294<<ASSIGN
SIZE
      5426**DCL      5445--IMP-SIZ  5630<<ASSIGN   5631>>ASSIGN   5634>>ASSIGN   5639>>ASSIGN   5700>>ASSIGN
      5701<>CALL     5748<>CALL     5751>>ASSIGN   5752<>CALL     5806<>CALL     5810<>CALL     5842>>CALLBLT
      6267<>CALL     6268>>CALLBLT  6270>>ASSIGN   6271<>CALL
SIZE IN PROCEDURE GET_ATTACHMENT
      5937**DCL      5941--IMP-SIZ  5947<<ASSIGN   5953>>CALLBLT  5957>>CALLBLT  5961>>ASSIGN   5964>>CALLBLT
      5966>>ASSIGN   5971>>ASSIGN   5979>>CALLBLT  5982>>ASSIGN   5983>>ASSIGN   5986>>CALLBLT  5987>>ASSIGN
      5988>>ASSIGN   5992>>ASSIGN   5993>>ASSIGN
SIZE IN PROCEDURE GET_STORED_COMMAND
      6022**DCL      6030--IMP-SIZ
SIZE IN PROCEDURE REPLACE_TEXT
      6067**DCL      6075--IMP-SIZ  6089<<ASSIGN   6096>>CALLBLT  6127>>CALLBLT  6127>>CALLBLT  6129>>ASSIGN
      6134>>CALLBLT  6134>>CALLBLT  6134>>CALLBLT  6136>>ASSIGN   6139>>CALLBLT  6139>>CALLBLT  6139>>CALLBLT
      6141>>ASSIGN   6178>>CALLBLT  6182>>CALLBLT
SIZE_READ
      5428**DCL      5707<<ASSIGN   5709<>CALL     5756<<ASSIGN   5758<>CALL     6218>>IF       6275<<ASSIGN
      6277<>CALL
START IN PROCEDURE GET_ATTACHMENT
      5934**DCL      5952<<ASSIGN   5953>>CALLBLT  5960>>ASSIGN   5961>>ASSIGN   5970>>ASSIGN   5971>>ASSIGN
      5982>>ASSIGN   5983>>ASSIGN   5992>>ASSIGN   5993>>ASSIGN
START IN PROCEDURE GET_NO_ATTACH
      5878**DCL      5894<<ASSIGN   5897>>CALLBLT  5899<<ASSIGN
START IN PROCEDURE REPLACE_TEXT
      6068**DCL      6095<<ASSIGN   6096>>CALLBLT  6134>>CALLBLT  6136>>ASSIGN   6139>>CALLBLT  6141>>ASSIGN
      6178>>CALLBLT  6179>>ASSIGN   6182>>CALLBLT  6183>>ASSIGN
S_D.CURRENT_CHANNEL
      2472**DCL      2474--REDEF
S_D.DEBUGA
      1624**DCL      1626--REDEF
S_D.DO$
      1575**DCL      5642>>ASSIGN
S_D.EIS
      2582**DCL      2611--REDEF
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:141  
S_D.ERROR
      1553**DCL      5657<<ASSIGN   5686<<ASSIGN   5695<<ASSIGN   5724<<ASSIGN   5743<<ASSIGN   5787<<ASSIGN
      5802<<ASSIGN   5853<<ASSIGN   5856<<ASSIGN   6123<<ASSIGN   6168<<ASSIGN   6188<<ASSIGN   6215<<ASSIGN
      6226<<ASSIGN   6230<<ASSIGN   6298<<ASSIGN   6307<<ASSIGN   6426<<ASSIGN   6435<<ASSIGN
S_D.ERROR_HICHAR
      2166**DCL      5656<<ASSIGN   5685<<ASSIGN   5742<<ASSIGN   5801<<ASSIGN
S_D.FIXCOM
      1978**DCL      5652--ASSIGN   5681--ASSIGN   5738--ASSIGN   5779--ASSIGN   5797--ASSIGN   6322>>ASSIGN
      6402<<ASSIGN
S_D.FIXCOM.CMD
      1980**DCL      5815>>ASSIGN   6102>>ASSIGN   6152>>ASSIGN   6195>>ASSIGN
S_D.FIXCOM.FAI
      1990**DCL      6325>>ASSIGN   6403<<ASSIGN   6430>>ASSIGN
S_D.FIXCOM.FPRG
      1985**DCL      5816>>ASSIGN   6106>>ASSIGN   6199>>ASSIGN
S_D.FIXCOM.FPRG_RES
      1991**DCL      6411>>ASSIGN
S_D.FIXCOM.FPRG_RES_SIZE
      1992**DCL      6412>>ASSIGN
S_D.FIXCOM.TAL
      1987**DCL      6323>>ASSIGN
S_D.FPRG_CONTEXT$
      1664**DCL      6408>>ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      2515**DCL      2516--REDEF    2530--REDEF
S_D.INPUT
      1787**DCL      6080<<ASSIGN   6127<<CALLBLT  6134<<CALLBLT  6139<<CALLBLT  6172<<ASSIGN   6178<<CALLBLT
      6182<<CALLBLT  6228>>ASSIGN
S_D.JDE
      2129**DCL      2130--REDEF
S_D.KILL1
      1642**DCL      5814<<ASSIGN   6105<<ASSIGN   6155<<ASSIGN   6198<<ASSIGN
S_D.L$.VALUE
      1682**DCL      1688--REDEF    1696--REDEF    1699--REDEF    1702--REDEF    1705--REDEF
S_D.L$.VALUE.L
      1683**DCL      1684--REDEF    1685--REDEF
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:142  
S_D.L6_MESSAGE_BUF
      2536**DCL      2538--REDEF
S_D.NCHARS
      1646**DCL      6081<<ASSIGN   6129<<ASSIGN   6136<<ASSIGN   6141<<ASSIGN   6173<<ASSIGN   6179<<ASSIGN
      6183<<ASSIGN   6229<>CALL
S_D.ONABORT
      2152**DCL      5821<<ASSIGN   6111<<ASSIGN   6157<<ASSIGN   6204<<ASSIGN
S_D.ONCALLS
      2154**DCL      5825<<ASSIGN   6115<<ASSIGN   6161<<ASSIGN   6208<<ASSIGN
S_D.ONEXIT
      2156**DCL      5823<<ASSIGN   6113<<ASSIGN   6159<<ASSIGN   6206<<ASSIGN
S_D.ONNODES
      2158**DCL      5827<<ASSIGN   6117<<ASSIGN   6163<<ASSIGN   6210<<ASSIGN
S_D.OUTPUT
      2502**DCL      2504--REDEF    5629--ASSIGN   5630--ASSIGN   5663<<CALLBLT  5664--CALL     6228<<ASSIGN
      6229--CALL
S_D.REMOTE_MSG.FNCC
      2521**DCL      2522--REDEF
S_D.REMOTE_MSG.STXC
      2517**DCL      2518--REDEF
S_D.REMOTE_MSG.SUBFNCC
      2525**DCL      2526--REDEF
S_D.SHOW1
      1644**DCL      6032<<ASSIGN
S_D.SV
      1581**DCL      1602--REDEF
S_D.VARCOM$
      1993**DCL      5692>>ASSIGN   5839>>ASSIGN   5886>>ASSIGN   5944>>ASSIGN   6085>>ASSIGN   6325>>ASSIGN
      6403>>ASSIGN   6430>>ASSIGN
S_D.VARNEXT$
      1579**DCL      6403>>ASSIGN   6405>>ASSIGN   6406<<ASSIGN   6406>>ASSIGN
S_D$
      2833**DCL      1529--IMP-PTR  5629>>ASSIGN   5642>>ASSIGN   5652>>ASSIGN   5656>>ASSIGN   5657>>ASSIGN
      5663>>CALLBLT  5664>>CALL     5681>>ASSIGN   5685>>ASSIGN   5686>>ASSIGN   5692>>ASSIGN   5695>>ASSIGN
      5724>>ASSIGN   5738>>ASSIGN   5742>>ASSIGN   5743>>ASSIGN   5779>>ASSIGN   5787>>ASSIGN   5797>>ASSIGN
      5801>>ASSIGN   5802>>ASSIGN   5814>>ASSIGN   5815>>ASSIGN   5816>>ASSIGN   5821>>ASSIGN   5823>>ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:143  
      5825>>ASSIGN   5827>>ASSIGN   5839>>ASSIGN   5853>>ASSIGN   5856>>ASSIGN   5886>>ASSIGN   5944>>ASSIGN
      6032>>ASSIGN   6080>>ASSIGN   6081>>ASSIGN   6085>>ASSIGN   6102>>ASSIGN   6105>>ASSIGN   6106>>ASSIGN
      6111>>ASSIGN   6113>>ASSIGN   6115>>ASSIGN   6117>>ASSIGN   6123>>ASSIGN   6127>>CALLBLT  6129>>ASSIGN
      6134>>CALLBLT  6136>>ASSIGN   6139>>CALLBLT  6141>>ASSIGN   6152>>ASSIGN   6155>>ASSIGN   6157>>ASSIGN
      6159>>ASSIGN   6161>>ASSIGN   6163>>ASSIGN   6168>>ASSIGN   6172>>ASSIGN   6173>>ASSIGN   6178>>CALLBLT
      6179>>ASSIGN   6182>>CALLBLT  6183>>ASSIGN   6188>>ASSIGN   6195>>ASSIGN   6198>>ASSIGN   6199>>ASSIGN
      6204>>ASSIGN   6206>>ASSIGN   6208>>ASSIGN   6210>>ASSIGN   6215>>ASSIGN   6226>>ASSIGN   6228>>ASSIGN
      6228>>ASSIGN   6229>>CALL     6229>>CALL     6230>>ASSIGN   6298>>ASSIGN   6307>>ASSIGN   6322>>ASSIGN
      6323>>ASSIGN   6325>>ASSIGN   6325>>ASSIGN   6402>>ASSIGN   6403>>ASSIGN   6403>>ASSIGN   6403>>ASSIGN
      6405>>ASSIGN   6406>>ASSIGN   6406>>ASSIGN   6408>>ASSIGN   6411>>ASSIGN   6412>>ASSIGN   6426>>ASSIGN
      6430>>ASSIGN   6430>>ASSIGN   6435>>ASSIGN
TEXT$
      5422**DCL      5446--IMP-PTR  5811<<ASSIGN   5812>>IF       5832>>ASSIGN   5833>>ASSIGN
TEXT$ IN PROCEDURE GET_ATTACHMENT
      5932**DCL      5946<<ASSIGN   5953>>CALLBLT  5957>>CALLBLT  5961>>ASSIGN   5964>>CALLBLT  5966>>ASSIGN
      5971>>ASSIGN   5979>>CALLBLT  5983>>ASSIGN   5986>>CALLBLT  5988>>ASSIGN   5993>>ASSIGN
TEXT$ IN PROCEDURE REPLACE_TEXT
      6066**DCL      6087<<ASSIGN   6096>>CALLBLT  6127>>CALLBLT  6134>>CALLBLT  6134>>CALLBLT  6139>>CALLBLT
      6139>>CALLBLT  6178>>CALLBLT  6182>>CALLBLT
TEXT$ATT IN PROCEDURE GET_ATTACHMENT
      5940**DCL      5961<<ASSIGN   5966<<ASSIGN   5971<<ASSIGN   5983<<ASSIGN   5988<<ASSIGN   5993<<ASSIGN
TEXT$C.SIZE
      5447**DCL      5448--IMP-SIZ  5812>>IF       5833>>ASSIGN   5842>>CALLBLT  5842>>CALLBLT  5844>>ASSIGN
TEXT$C.TEXT
      5448**DCL      5842>>CALLBLT
TEXT_SIZE IN PROCEDURE REPLACE_TEXT
      6059**DCL      6054--PROC     6074--IMP-SIZ  6080>>ASSIGN   6081>>ASSIGN   6100>>IF       6127>>CALLBLT
      6129>>ASSIGN   6132>>IF       6134>>CALLBLT  6136>>ASSIGN   6139>>CALLBLT  6141>>ASSIGN   6150>>IF
      6172>>ASSIGN   6173>>ASSIGN   6176>>IF       6182>>CALLBLT  6183>>ASSIGN
TFPRG$ IN PROCEDURE RESTORE_SCMD
      6333**DCL      6408<<ASSIGN   6409>>IF       6413>>DOWHILE  6413>>DOWHILE  6415<<ASSIGN   6415>>ASSIGN
      6416>>IF       6420>>DOWHILE  6429>>ASSIGN
UBIN36 IN PROCEDURE RESTORE_SCMD
      6332**DCL      6405<<ASSIGN
UBIN36 IN PROCEDURE SAVE_SCMD
      6320**DCL      6325>>ASSIGN
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:144  
UNKACT IN PROCEDURE DO_ATTACHMENTS
      6279**LABEL    6279--CALLALT
UNKACT1
      5711**LABEL    5711--CALLALT
UNKACT2
      5760**LABEL    5760--CALLALT
UPDATE$CMD.ASYM$
      5297**DCL      5811>>ASSIGN   5842>>CALLBLT  5842>>CALLBLT  5842>>CALLBLT  5844>>ASSIGN
UPDATE$CMD.ATTACHMENT
      5289**DCL      5808>>IF
UPDATE$CMD.ATTACHMENT#
      5293**DCL      5735>>ASSIGN   5795>>ASSIGN
UPDATE$CMD.ATTACH_AT_TIME
      5288**DCL      5646>>IF
UPDATE$CMD.ID_FROM
      5291**DCL      5648>>ASSIGN   5677>>ASSIGN   5734>>ASSIGN   5794>>ASSIGN
UPDATE$CMD.ID_TO
      5292**DCL      5671>>IF       5718>>IF
UPDATE$CMD.UPDATE#
      5290**DCL      5644>>DOCASE
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:145  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:146  
              MINI UREF LISTING

CHAR$CMD IN PROCEDURE GET_STORED_COMMAND   6030**DCL
DDA$UPDATE      16**PROC
FATT$ IN PROCEDURE GET_STORED_COMMAND   6023**DCL
M$ACCT      45**DCL-ENT
M$ACTIVATE      48**DCL-ENT
M$ALIB      41**DCL-ENT
M$ASUSER      43**DCL-ENT
M$ATTACH      50**DCL-ENT
M$BADPP      68**DCL-ENT
M$CGCTL      49**DCL-ENT
M$CGINFO      49**DCL-ENT
M$CHECK      30**DCL-ENT
M$CHGUNIT      88**DCL-ENT
M$CLOSE      28**DCL-ENT
M$CLRSTK      86**DCL-ENT
M$CMDVAR      97**DCL-ENT
M$CONFIG      58**DCL-ENT
M$CORRES      33**DCL-ENT
M$CPEXIT      42**DCL-ENT
M$CVM      66**DCL-ENT
M$CVOL      31**DCL-ENT
M$DCLFLD      58**DCL-ENT
M$DEACTIVATE      48**DCL-ENT
M$DELREC      30**DCL-ENT
M$DEQ      95**DCL-ENT
M$DETACH      50**DCL-ENT
M$DEVICE      32**DCL-ENT
M$DISPLAY      95**DCL-ENT
M$DISPRES      35**DCL-ENT
M$DLIB      41**DCL-ENT
M$DRIBBLE      58**DCL-ENT
M$DRTN      86**DCL-ENT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:147  
M$DSUSER      43**DCL-ENT
M$ENQ      94**DCL-ENT
M$EOM      53**DCL-ENT
M$ERASE      59**DCL-ENT
M$ERR      40**DCL-ENT
M$ERRMSG      91**DCL-ENT
M$EVENT      83**DCL-ENT
M$EXHUME      92**DCL-ENT
M$EXIT      40**DCL-ENT
M$EXTEND      32**DCL-ENT
M$FDP      64**DCL-ENT
M$FDS      63**DCL-ENT
M$FEBOOT      56**DCL-ENT
M$FECTL      57**DCL-ENT
M$FEDUMP      56**DCL-ENT
M$FID      91**DCL-ENT
M$FINDPROC      45**DCL-ENT
M$FSUSER      43**DCL-ENT
M$FVP      65**DCL-ENT
M$FWCG      49**DCL-ENT
M$GBPL      69**DCL-ENT
M$GDDL      65**DCL-ENT
M$GDP      64**DCL-ENT
M$GDS      63**DCL-ENT
M$GETDCB      34**DCL-ENT
M$GETMOUSE      74**DCL-ENT
M$GETPM      75**DCL-ENT
M$GJOB      93**DCL-ENT
M$GLINEATTR      53**DCL-ENT
M$GOODPP      68**DCL-ENT
M$GPLATEN      61**DCL-ENT
M$GPROMPT      60**DCL-ENT
M$GTRMATTR      54**DCL-ENT
M$GTRMCTL      52**DCL-ENT
M$GTRMTAB      55**DCL-ENT
M$GVP      64**DCL-ENT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:148  
M$HELP      91**DCL-ENT
M$INT      83**DCL-ENT
M$INTRTN      44**DCL-ENT
M$IOQ      79**DCL-ENT
M$JOBSTATS      93**DCL-ENT
M$KEYIN      33**DCL-ENT
M$LDEV      28**DCL-ENT
M$LDTRC      41**DCL-ENT
M$LIMIT      34**DCL-ENT
M$LINES      33**DCL-ENT
M$LINK      40**DCL-ENT
M$MADMUCK      36**DCL-ENT
M$MAKUSER      67**DCL-ENT
M$MBS      35**DCL-ENT
M$MDFFLD      59**DCL-ENT
M$MERC      84**DCL-ENT
M$MERCS      85**DCL-ENT
M$MIRROR      79**DCL-ENT
M$MONINFO      96**DCL-ENT
M$MPL      69**DCL-ENT
M$NODEINFO      60**DCL-ENT
M$NXTUSR      94**DCL-ENT
M$OCMSG      92**DCL-ENT
M$OLAY      40**DCL-ENT
M$OPEN      28**DCL-ENT
M$PAS      69**DCL-ENT
M$PATHCON      92**DCL-ENT
M$PDS      63**DCL-ENT
M$PFIL      30**DCL-ENT
M$PLATEN      54**DCL-ENT
M$PRECORD      32**DCL-ENT
M$PROCNAME      45**DCL-ENT
M$PROFILE      56**DCL-ENT
M$PROMPT      52**DCL-ENT
M$RACST      36**DCL-ENT
M$RDSYSLOG      77**DCL-ENT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:149  
M$RELDCB      34**DCL-ENT
M$RELRES      35**DCL-ENT
M$RELSTARF      37**DCL-ENT
M$REM      37**DCL-ENT
M$RENV      84**DCL-ENT
M$REQUIRE      36**DCL-ENT
M$RETRY      85**DCL-ENT
M$RETRYS      85**DCL-ENT
M$REW      31**DCL-ENT
M$RLSFLD      59**DCL-ENT
M$RPRIV      87**DCL-ENT
M$RSPP      66**DCL-ENT
M$RSWITCH      88**DCL-ENT
M$RUE      94**DCL-ENT
M$SAD      67**DCL-ENT
M$SAVE      43**DCL-ENT
M$SCON      44**DCL-ENT
M$SCREECH      42**DCL-ENT
M$SENV      84**DCL-ENT
M$SETFMA      28**DCL-ENT
M$SETFP      57**DCL-ENT
M$SLCFLD      60**DCL-ENT
M$SMOUSE      74**DCL-ENT
M$SMPRT      66**DCL-ENT
M$SPRIV      87**DCL-ENT
M$SSC      67**DCL-ENT
M$SSWITCH      87**DCL-ENT
M$STATE      96**DCL-ENT
M$STD      68**DCL-ENT
M$STIMER      82**DCL-ENT
M$STLPP      65**DCL-ENT
M$STRAP      82**DCL-ENT
M$STRMATTR      54**DCL-ENT
M$STRMCTL      52**DCL-ENT
M$STRMTAB      55**DCL-ENT
M$SYMBIO      93**DCL-ENT
PL6.E3A0      #001=DDA$UPDATE File=DDA$UPDATE.:E05TSI                            TUE 07/29/97 13:40 Page:150  
M$SYSCON      79**DCL-ENT
M$SYSID      97**DCL-ENT
M$TDCLOSE      78**DCL-ENT
M$TDIO      78**DCL-ENT
M$TDOPEN      77**DCL-ENT
M$TDREQCPU      78**DCL-ENT
M$TEMPWROC      72**DCL-ENT
M$TIME      95**DCL-ENT
M$TRAP      82**DCL-ENT
M$TRMISC      57**DCL-ENT
M$TRMPRG      53**DCL-ENT
M$TRTN      86**DCL-ENT
M$TRUNC      29**DCL-ENT
M$TTIMER      82**DCL-ENT
M$UC      52**DCL
M$UMPL      69**DCL-ENT
M$UNFID      91**DCL-ENT
M$UNLATCH      48**DCL-ENT
M$UNSHARE      45**DCL-ENT
M$USRFIELD      88**DCL-ENT
M$VIRTUAL      63**DCL-ENT
M$WAIT      86**DCL-ENT
M$WEOF      31**DCL-ENT
M$WRITE      29**DCL-ENT
M$WRSYSLOG      77**DCL-ENT
M$XCON      83**DCL-ENT
M$XCONRTN      44**DCL-ENT
M$XEQTIME      96**DCL-ENT
M$XFLUSH      37**DCL-ENT
M$XMOUSE      74**DCL-ENT
M$XXX      40**DCL-ENT
M$YC      42**DCL-ENT
POSITION IN PROCEDURE GET_STORED_COMMAND   6026**DCL
START IN PROCEDURE GET_STORED_COMMAND   6025**DCL
TEXT$ IN PROCEDURE GET_STORED_COMMAND   6024**DCL
TEXT$CMD IN PROCEDURE GET_STORED_COMMAND   6029**DCL
