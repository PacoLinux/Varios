VERSION E05

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:1    
        1        1        /*M* DDA$DO DELTA DO ROUTINE MODULE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DDA$DO
       10       10             PURPOSE: TO PERFORM THE ENCODED COMMAND THAT IT RECEIVES.
       11       11             DESCRIPTION:
       12       12             REFERENCE: DELTA FUNCTIONAL SPEC AF Section 17.6 #0065C-0.
       13       13        */
       14       14        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:2    
       15       15        /*F* NAME: DDA$DO
       16       16             PURPOSE: TO PERFORM THE ENCODED COMMAND THAT IT RECEIVES.
       17       17             DESCRIPTION:
       18       18             REFERENCE: DELTA FUNCTIONAL SPEC AF Section 17.6 #0065C-0.
       19       19        */
       20       20        /**/
       21       21        DDA$DO: PROC ALTRET;
       22       22    1   DCL CODE UBIN(36);
       23       23    1   DCL NOGO_BIT BIT(1) ALIGNED;
       24       24    1   DCL I UBIN;
       25       25    1   DCL II UBIN;
       26       26    1   DCL TYPE UBIN;
       27       27    1   DCL USR# UBIN;
       28       28    1   DCL LS# UBIN;
       29       29    1   DCL CPU# UBIN;
       30       30    1   DCL LOWX UBIN;
       31       31    1   DCL HIGX UBIN;
       32       32    1   DCL OPEN BIT(1) ALIGNED;
       33       33    1   DCL CLOSED BIT(1) ALIGNED;
       34       34    1   DCL ADDRESS UBIN;
       35       35    1   DCL DESC# UBIN;
       36       36    1   DCL SEG UBIN;
       37       37    1   DCL NOT_IS BIT(1) ALIGNED;
       38       38    1   DCL DCB# SBIN;
       39       39    1   DCL DCB$ PTR;
       40       40    1   DCL TEMP$ PTR;
       41       41    1   DCL TEMP1 REDEF TEMP$ UBIN(36) ALIGNED;
       42       42    1   DCL 1 TEMP1B REDEF TEMP$ ALIGNED,
       43       43    1         2 * UBIN(4) UNAL,
       44       44    1         2 B1 UBIN(8) UNAL,
       45       45    1         2 B2 UBIN(8) UNAL,
       46       46    1         2 B3 UBIN(8) UNAL,
       47       47    1         2 B4 UBIN(8) UNAL;
       48       48    1   DCL TEMP2 UBIN(36) ALIGNED;
       49       49    1   DCL 1 TEMP2B REDEF TEMP2 ALIGNED,
       50       50    1         2 * BIT(1) UNAL,
       51       51    1         2 B1 UBIN(8) UNAL,
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:3    
       52       52    1         2 * BIT(1) UNAL,
       53       53    1         2 B2 UBIN(8) UNAL,
       54       54    1         2 * BIT(1) UNAL,
       55       55    1         2 B3 UBIN(8) UNAL,
       56       56    1         2 * BIT(1) UNAL,
       57       57    1         2 B4 UBIN(8) UNAL;
       58       58    1   DCL BUF$ PTR;
       59       59    1   DCL PTR_SAD_SKEL PTR;
       60       60    1   DCL 1 PTR_SAD REDEF PTR_SAD_SKEL,
       61       61    1         2 * BIT(24) UNAL,
       62       62    1         2 PT,
       63       63    1           3 * BIT(2) UNAL,
       64       64    1           3 LS UBIN(10) UNAL;
       65       65    1   DCL NO_COMMANDS BIT(1);
       66       66    1   DCL FID_ASN UBIN BYTE ALIGNED;
       67       67    1   DCL RES CHAR(8);
       68       68    1   DCL RES_SIZE UBIN;
       69       69    1   DCL DCBNO UBIN;
       70       70    1   DCL FID_RES CHAR(4);
       71       71    1   DCL TSIZE UBIN;
       72       72    1   DCL TFPRG$ PTR;
       73       73    1   DCL PTFPRG$ PTR;
       74       74    1   DCL DFPRG$ PTR;
       75       75    1   DCL DO$ PTR;
       76       76    1   DCL FATT$ PTR;
       77       77    1   DCL EDEF$ PTR;
       78       78    1   DCL UBIN36 UBIN BASED;
       79       79    1   DCL FPRG_IC UBIN;
       80       80    1   DCL FAULT UBIN;
       81       81    1   DCL TOBREL UBIN;
       82       82        %INCLUDE B$OBJECT_C;
       83     3512        %B$EDEF;
       84     3582        %SUB_CST;
       85     3598        %SUB_LINKFLAGS;
       86     3607        %B$TREE_TABLE(NODE_NAME="B$TREE_NODE(0:0)");
       87     3665        %B$TREE_TABLE (HDR_NAME=B$TREEHDR,NODE_NAME="B$NODE(0:0)");
       88     3723        %INCLUDE DD$DITEM;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:4    
       12+    3826             %LIST;
       13+    3827    1        DCL SDD$ PTR;
       14+    3828    1        DCL ZITEM$ PTR;
       15+    3829    1        DCL SDD_L6$ PTR;
       16+    3830    1        DCL ZITEM_L6$ PTR;
       89     4404        %INCLUDE DD$BASED;                      /* BASED STRUCTURES */
       90     5707        %FIXCOM (NAME="F$XCM",STCLASS=BASED);
       91     5723        %AT_FIRST;
       92     5751        %WHEN_FIRST (NAME=WHEN, STCLASS="BASED(FATT$)");
       93     5788        %ALL_ATTACH;
       94     5803        %DOO (STCLASS=BASED);
       95     5818        %DISPLAY;
       96     5829        %GO (NAME=GO$CMD);
       97     5849        %FORMAT$CMD;
       98     5861        %PROMPT$CMD;
       99     5874        %SHOW$CMD;
      100     5896        %TR$CMD;
      101     5912        %XEQ$CMD;
      102     5926        %RUM$CMD;
      103     5950        %DEF$CMD;
      104     5964        %LET$CMD;
      105     6014        %DUMP$CMD;
      106     6044        %MACTIVE$CMD;
      107     6063        %MODIFY$CMD;
      108     6079        %EVAL$CMD;
      109     6094        %KEEP$CMD;
      110     6113        %HIST$CMD;
      111     6126        %ACTIVE$CMD;
      112     6139        %USE$CMD;
      113     6162        %TEXT$C;
      114     6167        %FIND$CMD;
      115     6193        %REPORT$CMD;
      116     6209        %ALIB$CMD;
      117     6221        %ANLZ$CMD;
      118     6244        %UNFID$CMD;
      119     6262        %NAME$CMD;
      120     6276        %UNSHARE$CMD;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:5    
      121     6288        %DEBUG$CMD;
      122     6311        %FPRG$CONTEXT;
      123     6374        %QUIT$CMD;
      124     6386        %QUIT$CMD (NAME=STOP$CMD);
      125     6398        %SCHEMA$CMD;
      126     6414        %LCT$CMD;
      127     6428        %INCLUDE DU_SCODE_C;
      128     6441        %INCLUDE DF_EQUS_E;
      129     6454        %INCLUDE GD_EQUS_E;
      130     6615        %INCLUDE G_LCP6_E;
      131     6873        %INCLUDE DD_DEBUG_C;
      132     6894        %INCLUDE GD$MSG_M;
      133     7058        %GD$MSG(FPTN=GD$MSG_HOST, STCLASS="BASED(S_D_HOST_MESSAGE$)", L6=NO);
      134     7214        %GD$MSG(FPTN=GD$MSG, STCLASS="BASED(S_D_L6_MESSAGE$)",L6=YES,L6PTR="UBIN(32) UNAL");
      135     7370        %INCLUDE DD_REPORT_R;
      136     7379    1   DCL DD_XOU$ PTR SYMREF;
      137     7380    1   DCL DX_DIC BIT(1) SYMREF;
      138     7381    1   DCL DCTX_CR UBIN SYMREF;
      139     7382    1   DCL DCTX_ME UBIN SYMREF;
      140     7383    1   DCL DCTX_MT UBIN SYMREF;
      141     7384    1   DCL DCTX_NO UBIN SYMREF;
      142     7385    1   DCL DCTX_LP UBIN SYMREF;
      143     7386    1   DCL DCTX_PATCH UBIN SYMREF;
      144     7387    1   DCL IN_DEV UBIN SYMREF;
      145     7388    1   DCL OUT_DEV UBIN SYMREF;
      146     7389    1   DCL ECHO_DEV UBIN SYMREF;
      147     7390    1   DCL OUT_DEV_SAVE UBIN SYMREF;
      148     7391    1   DCL D_XDELTA BIT(1) SYMREF;
      149     7392    1   DCL IRM_NOKP_SCR UBIN SYMREF;
      150     7393    1   DCL MIS$ PTR SYMREF;
      151     7394    1   DCL SAD$ PTR SYMREF;
      152     7395    1   DCL D_M$LM# UBIN SYMREF;
      153     7396    1   DCL B$ROS$ PTR SYMREF;
      154     7397    1   DCL DD_FPRGSEG$ PTR SYMREF;
      155     7398        %INCLUDE B$ROSEG;
      156     7461        %INCLUDE XUH_MACRO_C;
      157     7545        %INCLUDE DD_SD_M;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:6    
      158     8881        %S_D;
      159    10199        %S_D_PTRS;
      160    10236        %INCLUDE XU_MACRO_C;
      161    13342        %INCLUDE DD_KNODES_D;
      162    13558        %NODE_DEFS;
      163    13947        %INCLUDE IR_DATA_M;
      164    14111        %INCLUDE DD$DA;
      165    14192        %INCLUDE DD_SUBS_C;                     /* DELTA %SUBS */
      166    14463        %INCLUDE DD_ERR_C;
      167    14860        %INCLUDE DD_PSUBS_C;
      168    15335        %INCLUDE CP_6;
      169    15416        %INCLUDE CP_6_SUBS;
      170    15956        %INCLUDE B_ERRORS_C;
      171    17083        %INCLUDE B$JIT;
      172    17373        %B$ALIBF;
      173    17377    1   DCL B$JIT$ PTR SYMREF;
      174    17378        %B$TCB;
      175    17381        %B$XCON;
      176    17391        %B$EXCFR;
      177    17409        %B$ALT;
      178    17417        %SUB_EXC;
      179    17464        %SUB_ECCDELTA;
      180    17501        %F$DCB;
      181    17558    1   DCL B$TCB$ PTR SYMREF;
      182    17559    1   DCL DDA$DEF        ENTRY       ALTRET;
      183    17560    1   DCL DDA$DISP       ENTRY       ALTRET;
      184    17561    1   DCL DDA$DOATTACH   ENTRY       ALTRET;
      185    17562    1   DCL DDA$DUMP_DO    ENTRY          ALTRET;
      186    17563    1   DCL DDA$EVAL       ENTRY       ALTRET;
      187    17564    1   DCL DDA$FIND       ENTRY       ALTRET;
      188    17565    1   DCL DDA$GO         ENTRY       ALTRET;
      189    17566    1   DCL DDA$HIST       ENTRY;
      190    17567    1   DCL DDA$IF         ENTRY(1)    ALTRET;
      191    17568    1   DCL DDA$KEEP       ENTRY;
      192    17569    1   DCL DDA$KILL       ENTRY;
      193    17570    1   DCL DDA$KILL1      ENTRY;
      194    17571    1   DCL DDA$LET        ENTRY       ALTRET;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:7    
      195    17572    1   DCL DDA$MACTIVE    ENTRY(0)    ALTRET;
      196    17573    1   DCL DDA$MOD        ENTRY       ALTRET;
      197    17574    1   DCL DDA$NAME       ENTRY       ALTRET;
      198    17575    1   DCL DDA$PLUGH      ENTRY;
      199    17576    1   DCL DDA$RESET_PATCH_SPACE ENTRY;
      200    17577    1   DCL DDA$SHOW       ENTRY;
      201    17578    1   DCL DDA$STEP       ENTRY(1)    ALTRET;
      202    17579    1   DCL DDA$STEP_MORE  ENTRY(1)    ALTRET;
      203    17580    1   DCL DDA$STORE      ENTRY       ALTRET;
      204    17581    1   DCL DDA$TRACE      ENTRY;
      205    17582    1   DCL DDA$TRACEON    ENTRY;
      206    17583    1   DCL DDA$UPDATE     ENTRY       ALTRET;
      207    17584    1   DCL DDA$USER_DO    ENTRY       ALTRET;
      208    17585    1   DCL DDA$XEQ        ENTRY       ALTRET;
      209    17586    1   DCL DDE$ERROR      ENTRY;
      210    17587    1   DCL DDF$FIND_PEDEF ENTRY(2) ALTRET;
      211    17588    1   DCL DDK$EVAL       ENTRY(6)    ALTRET;
      212    17589    1   DCL DDM$GETMEM     ENTRY(3)    ALTRET;
      213    17590    1   DCL DDM$PUTMEM     ENTRY(3)    ALTRET;
      214    17591    1   DCL DDQ$WRITE      ENTRY(2);
      215    17592    1   DCL DDR$BINTXT     ENTRY(4);
      216    17593    1   DCL DDR$REPORT     ENTRY(1);
      217    17594    1   DCL DDS$EQCS#      ENTRY(1)    ALTRET;
      218    17595    1   DCL DDS$ES_INQ     ENTRY(1)    ALTRET;
      219    17596    1   DCL DDS$EUTREE     ENTRY(0)    ALTRET;
      220    17597    1   DCL DDS$PD_SRCH    ENTRY(2)    ALTRET;
      221    17598    1   DCL DDS$SET_C2D    ENTRY(0)    ALTRET;
      222    17599    1   DCL DDS$SET_Q2C    ENTRY(0)    ALTRET;
      223    17600    1   DCL DDS$SET_Q2T    ENTRY(0)    ALTRET;
      224    17601    1   DCL DDS$SET_Q2X    ENTRY(0)    ALTRET;
      225    17602    1   DCL DDS$SET_T2Q    ENTRY(0)    ALTRET;
      226    17603    1   DCL DDT$TRACEOFF   ENTRY;
      227    17604    1   DCL DFA$DFMT       ENTRY       ALTRET;
      228    17605    1   DCL DFA$DLCT       ENTRY        ALTRET;
      229    17606    1   DCL DFA$DUMP ENTRY ALTRET;
      230    17607    1   DCL DFA$FPRG       ENTRY(1);
      231    17608    1   DCL DFA$GET_FPRG_DCB ENTRY(1);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:8    
      232    17609    1   DCL DFA$GO         ENTRY(1)    ALTRET;
      233    17610    1   DCL DFA$KEEP       ENTRY       ALTRET;
      234    17611    1   DCL DFA$KILL_DELTA ENTRY;
      235    17612    1   DCL DFA$KILL_FPRG  ENTRY(1);
      236    17613    1   DCL DFA$KILL1      ENTRY(3);
      237    17614    1   DCL DFA$LET        ENTRY        ALTRET;
      238    17615    1   DCL DFA$MLCT       ENTRY        ALTRET;
      239    17616    1   DCL DFA$MLCT_ACTIVE ENTRY       ALTRET;
      240    17617    1   DCL DFA$PLUGH      ENTRY;
      241    17618    1   DCL DFA$QUIT       ENTRY(1)    ALTRET;
      242    17619    1   DCL DFA$SET_AT     ENTRY(3)    ALTRET;
      243    17620    1   DCL DFA$SETUP_FPRG ENTRY(4)    ALTRET;
      244    17621    1   DCL DFA$STEP       ENTRY(2)    ALTRET;
      245    17622    1   DCL DFA$STOP_FPRGS ENTRY(2)    ALTRET;
      246    17623    1   DCL DFA$TSA        ENTRY ALTRET;
      247    17624    1   DCL DFA$TRACE      ENTRY;
      248    17625    1   DCL DFA$TRACE_REPORT ENTRY ALTRET;
      249    17626    1   DCL DFA$UNFID      ENTRY       ALTRET;
      250    17627    1   DCL DFA$USE        ENTRY;
      251    17628    1   DCL DFQ$WRITE_FD   ENTRY(1)    ALTRET;
      252    17629    1   DCL DFQ$READ_FD    ENTRY(2)    ALTRET;
      253    17630    1   DCL DFR$EVENTRPT   ENTRY(1);
      254    17631    1   DCL DFR$REPORT     ENTRY(1);
      255    17632    1   DCL DUA$ALIB       ENTRY(2)    ALTRET;
      256    17633    1   DCL DUA$ANLZ       ENTRY       ALTRET;
      257    17634    1   DCL DUA$DELETE     ENTRY(0);
      258    17635    1   DCL DUA$EXITDELTA  ENTRY;
      259    17636    1   DCL DUA$HELP       ENTRY;
      260    17637    1   DCL DUA$KILL_ANLZ  ENTRY(0)    ALTRET;
      261    17638    1   DCL DUA$KILL_RUM   ENTRY(0);
      262    17639    1   DCL DUA$LIST       ENTRY(0);
      263    17640    1   DCL DUA$OUTPUT     ENTRY(4)    ALTRET;
      264    17641    1   DCL DUA$PMD        ENTRY(0);
      265    17642    1   DCL DUA$READ       ENTRY(1)    ALTRET;
      266    17643    1   DCL DUA$RUM        ENTRY(0);
      267    17644    1   DCL DUA$UNFID      ENTRY(3)    ALTRET;
      268    17645    1   DCL DUD$MINI       ENTRY(1);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:9    
      269    17646    1   DCL DUE$ERRMSG     ENTRY;
      270    17647    1   DCL DUE$GERRMSG     ENTRY;
      271    17648    1   DCL DUI$INIT_HOST   ENTRY;
      272    17649    1   DCL DUI$INIT_L6     ENTRY;
      273    17650    1   DCL DUI$RU_ACCESS   ENTRY ALTRET;
      274    17651    1   DCL DUL$USE        ENTRY(4)    ALTRET;
      275    17652    1   DCL DXA$QUIT       ENTRY       ALTRET;
      276    17653    1   DCL DXA$TBOOT      ENTRY;
      277    17654    1   DCL DXA$DBOOT      ENTRY;
      278    17655    1   DCL DXA$USE        ENTRY(0);
      279    17656    1   DCL DXC$EOP        ENTRY;
      280    17657    1   DCL DXC$MINI       ENTRY;
      281    17658        %FPT_SCREECH(FPTN=SNAP_MESSAGE,STCLASS=SYMREF READONLY);
      282    17672        %VLP_SCODE(FPTN=SC_MESSAGE, STCLASS=SYMREF READONLY);
      283    17733        %FPT_GETDCB(FPTN=FPT_GETDCB,STCLASS=SYMREF);
      284    17748        %FPT_OPEN(FPTN=FPT_OPEN,FUN=IN,STCLASS=CONSTANT,XONLY=YES);
      285    17857        %FPT_OPEN(FPTN=FPTOPEN,STCLASS=);
      286    17966        %VLP_SN(FPTN=VLP_SN,
      287    17967                STCLASS=,
      288    17968                N=1);
      289    17981        %VLP_NAME(FPTN=VLP_NAME,
      290    17982                  STCLASS=,
      291    17983                  LEN=31);
      292    18010        %VLP_ACCT(FPTN=VLP_ACCT,
      293    18011                  STCLASS=);
      294    18024        %VLP_PASS(FPTN=VLP_PASS,
      295    18025                  STCLASS=);
      296    18038        %VLP_WSN(FPTN=VLP_WSN, STCLASS=AUTO);
      297    18051        %VLP_NAME (FPTN=VLP_MONNAME, STCLASS=CONSTANT,
      298    18052                  NAME='M:FEP');
      299    18079        %VLP_ACCT (FPTN=VLP_SYSACCT, STCLASS=CONSTANT,
      300    18080                  ACCT=':SYS');
      301    18093        %FPT_WAIT(FPTN=FPT_WAIT,UNITS=2,STCLASS=CONSTANT SYMDEF);
      302    18107        %FPT_WAIT(FPTN=FPTWAIT,STCLASS=);
      303    18121        %FPT_GETDCB(FPTN=FPTGETDCB,
      304    18122                    STCLASS=);
      305    18137        %VLP_SETSTA(FPTN=VLP_SETSTA,STCLASS=AUTO);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:10   
      306    18165        %VLP_NODENAME(FPTN=VLP_NODENAME,STCLASS=AUTO);
      307    18178        %VLR_FID(FPTN=VLR_FID,STCLASS=AUTO);
      308    18197        %FPT_FID(FPTN=FPT_FID,
      309    18198                 STCLASS=CONSTANT);
      310    18221        %FPT_FID(FPTN=FPTFID,STCLASS=);
      311    18244        %FPT_RELDCB(FPTN=FPT_RELDCB,
      312    18245                    STCLASS=SYMREF);
      313    18259        %FPT_RELDCB(FPTN=FPTRELDCB,
      314    18260                    STCLASS=);
      315    18274        %FPT_CLOSE (FPTN=FPT_CLOSE, STCLASS=SYMREF);
      316    18316        %FPT_CLOSE (FPTN=FPT$CLOSE, STCLASS=AUTO);
      317    18358        %FPT_DRTN (FPTN=FPT$DRTN, STCLASS=BASED);
      318    18382        %VLR_FPRG_FID(FPTN=VLR_FPRG_FID,STCLASS=AUTO);
      319    18390        %FPT_EOM (FPTN=FPT_EOM,STCLASS=SYMREF);
      320    18420        %FPT_SAD (FPTN=FPT_SAD, STCLASS=CONSTANT);
      321    18435        %FPT_SAD (FPTN=FPT$SAD, STCLASS=AUTO);
      322    18450        %FPT_UNSHARE (FPTN=FPT_UNSHARE,
      323    18451                      STCLASS=CONSTANT,
      324    18452                      PROG=NO,
      325    18453                      LIB=NO);
      326    18468        %FPT_UNSHARE (FPTN=FPT$UNSHARE,
      327    18469                      STCLASS=);
      328    18484        %FPT_SSC (FPTN=FPT_SSC, STCLASS=CONSTANT,
      329    18485                  FLAGS="'0'B");
      330    18501        %FPT_SSC (FPTN=FPT$SSC, STCLASS=AUTO);
      331    18517        %COMPILERIDSUBS;
      332    18533        %FPT_CLOSE(FPTN=FPT_CLOSE_DBG, STCLASS=CONSTANT);
      333    18575        %FPT_CLOSE(FPTN=FPTCLOSE_DBG, STCLASS=);
      334    18617        %FPT_OPEN(FPTN=FPT_OPEN_DBG,
      335    18618                  STCLASS=CONSTANT,
      336    18619                  XONLY=YES,
      337    18620                  NAME=DBG_NAME,
      338    18621                  ACCT=DBG_ACCT,
      339    18622                  ASN=COMGROUP,
      340    18623                  SCRUB=YES,
      341    18624                  FUN=UPDATE,
      342    18625                  SHARE=ALL,
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:11   
      343    18626                  CTG=YES);
      344    18735        %FPT_OPEN(FPTN=FPT_OPEN_FANLZ,
      345    18736                  XONLY=YES,
      346    18737                  ORG=FPRG,
      347    18738                  ASN=DEVICE,
      348    18739                  SCRUB=YES,
      349    18740                  FUN=CREATE,
      350    18741                  STCLASS=CONSTANT);
      351    18850        %FPT_SETFP(FPTN=FPT_SETFP,
      352    18851                   STCLASS=CONSTANT);
      353    18864        %FPT_SETFP(FPTN=FPTSETFP,
      354    18865                   STCLASS=);
      355    18878        %VLP_FPRG(FPTN=HANDLER_FPRG,
      356    18879                  STCLASS=CONSTANT,
      357    18880                  NAME='DELTA_FPRG',
      358    18881                  ACCT=':SYS');
      359    18902        %VLP_NAME(FPTN=DBG_NAME,
      360    18903                  STCLASS=CONSTANT,
      361    18904                  NAME='FECG');
      362    18931        %VLP_ACCT(FPTN=DBG_ACCT,
      363    18932                  STCLASS=CONSTANT,
      364    18933                  ACCT=':SYS');
      365    18946        %INCLUDE KF$MSG_C;
      366    19013        %INCLUDE KF$MSG_SUBS;
      367    19059        %KF$MSG_EXCLDCB(NAME=KF$MSG);
      368    19065        %FPT_READ(FPTN=FPT_READ_DBG,
      369    19066                  STCLASS=CONSTANT,
      370    19067                  TRANS=YES);
      371    19106        %FPT_READ(FPTN=FPTREAD_DBG, STCLASS=);
      372    19145        %FPT_WRITE(FPTN=FPT_WRITE_DBG,
      373    19146                   STCLASS=CONSTANT,
      374    19147                   TRANS=YES);
      375    19178        %FPT_WRITE(FPTN=FPTWRITE_DBG,STCLASS=);
      376    19209        %VLP_STATION(FPTN=FROG_STATION,
      377    19210                     STCLASS=CONSTANT,
      378    19211                     STATION='FROG');
      379    19238        %FPT_TRMATTR(FPTN=TRM_DBG,
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:12   
      380    19239                     STCLASS=CONSTANT,
      381    19240                     TRMATTR=VLP_TRMATTR);
      382    19265        %FPT_TRMATTR(FPTN=TRMDBG, STCLASS=);
      383    19290        %VLP_TRMATTR(STCLASS=CONSTANT,
      384    19291                     PARITY=NONE);
      385    19329        %FPT_EOM(FPTN=FPT_EOM_DBG,
      386    19330                 STCLASS=CONSTANT,
      387    19331                 EOMTABLE=REMOTEEOM);
      388    19361        %FPT_EOM(FPTN=FPTEOM_DBG, STCLASS=);
      389    19391    1   DCL REMOTEEOM (0:7) BIT(36) CONSTANT
      390    19392    1        INIT('0'B*2, '02'O, '0'B*3, '02'O, '0'B);
      391    19393        %FPT_TRMCTL(FPTN=CTL_DBG,
      392    19394                    STCLASS=CONSTANT,
      393    19395                    TRMCTL=VLP_TRMCTL);
      394    19422        %FPT_TRMCTL(FPTN=CTLDBG, STCLASS=);
      395    19449        %VLP_TRMCTL(FPTN=VLP_TRMCTL,
      396    19450                    STCLASS=CONSTANT,
      397    19451                    ACTONTRN=YES,
      398    19452                    DISPINPUT=NO);
      399    19492        %FPT_PROMPT(FPTN=FPT_PROMPT_DBG,
      400    19493                    STCLASS=CONSTANT,
      401    19494                    PROMPT=AT,
      402    19495                    VFC=YES);
      403    19523        %FPT_PROMPT(FPTN=FPTPROMPT_DBG, STCLASS=);
      404    19551    1   DCL AT CHAR(1) CONSTANT INIT('@');
      405    19552    1   DCL MSG$ PTR;
      406    19553        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:13   
      407    19554        /*D* NAME: DDA$DO
      408    19555             CALL: CALL DDA$DO ALTRET(USERGO)
      409    19556             DESCRIPTION:
      410    19557                  DDA$DO is called by DDA$DELTA, and DDA$DOATTACH to
      411    19558                  perform an encoded directive.  The directive is either
      412    19559                  a stored directive is S_D.VARCOM$->VARCOM, or an immediate directive
      413    19560                  in S_D.DIRCOM.  S_D.DO$ is set to point at the directive
      414    19561                  before entry to DDA$DO.  The actual function of each
      415    19562                  DELTA directive is performed by code in DDA$DO, or in
      416    19563                  a routine called by DDA$DO.  Note that while stored directives
      417    19564                  (AT, ON NODE, etc.) are stored away in VARCOM by DDS$SCAN,
      418    19565                  the attachments are performed here.
      419    19566
      420    19567                  When adding a directive to DELTA, the code to perform it,
      421    19568                  or a call to a module which performs it, must be placed here.
      422    19569
      423    19570                  DDA$DO will call DDA$IF to test for a true condition on each
      424    19571                  directive that allows a condition.  DDA$DO should not altret
      425    19572                  unless DDA$GO has been called during the processing of a
      426    19573                  directive.  This is very important.  An altret by DDA$DO
      427    19574                  is the signal for DDA$DELTA to transfer control to the
      428    19575                  user (or monitor if XDELTA).
      429    19576
      430    19577        */
      431    19578    1        S_D.DO_CALLED = '1'B;
      432    19579    1        CODE = S_D.DO$->ALL_ATTACH.CMD;
      433    19580    1        IF CODE ~= 12 AND CODE ~= 80 AND CODE ~= 81 /* C_HELP, C_QMARK1, C_QMARK2 */
      434    19581    1        THEN S_D.HELPING = '0'B;
      435    19582    1        S_D.ERROR = 0;
      436    19583    1        S_D.STEP = '0'B;
      437    19584    1        S_D.STOP = '0'B;
      438    19585    2        DO CASE(CODE);
      439    19586    2          CASE(1);                  /* ABBREV */
      440    19587    2             S_D.ERROR = 503;         /* E@NOTIMP */
      441    19588    2          CASE(19, 50, 51, 52);
      442    19589                                           /* C_ACTIVE, INACTIVE, SILENT, UNSILENT */
      443    19590    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(ACTIVE$CMD));
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:14   
      444    19591    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
      445    19592    2             IF NOGO_BIT THEN RETURN;
      446    19593                            /* Make sure there is a stored command in range specified */
      447    19594    2             I = S_D.DO$ -> ACTIVE$CMD.ID_FROM;
      448    19595    2             NO_COMMANDS = '1'B;
      449    19596    3             DO WHILE (NO_COMMANDS) AND
      450    19597    3               (I <= S_D.DO$ -> ACTIVE$CMD.ID_TO);
      451    19598    3                  IF S_D.FIXCOM.CMD(I) ~= 0
      452    19599    3                  THEN NO_COMMANDS = '0'B;
      453    19600    3                  I = I + 1;
      454    19601    3                END;
      455    19602    2             IF NO_COMMANDS
      456    19603    3             THEN DO;
      457    19604    4                  DO CASE (S_D.DO$ -> ACTIVE$CMD.CMD);
      458    19605    4                    CASE (19, 50); /* C_ACTIVE, C_INACTIVE */
      459    19606    4                       S_D.ERROR = 247; /* E@NO_STORED_COMMANDS */
      460    19607    4                    CASE (51, 52); /* C_SILENT, C_UNSILENT */
      461    19608    4                       S_D.ERROR = 248; /* E@NO_SUCH_BREAKPOINTS */
      462    19609    4                    CASE (ELSE);
      463    19610    4                       S_D.ERROR = 502; /* E@DELBUG */
      464    19611    4                    END;
      465    19612    3                  GOTO ERR;
      466    19613    3                END;
      467    19614    3             ELSE DO;
      468    19615    4                  DO I = S_D.DO$->ACTIVE$CMD.ID_FROM TO S_D.DO$->ACTIVE$CMD.ID_TO   ;
      469    19616    4                       IF S_D.FIXCOM.CMD(I) = 45 /* C_SAVE */
      470    19617    4                       THEN GOTO AISU_END;
      471    19618    4                       IF S_D.DO$->ACTIVE$CMD.CMD = 19
      472    19619    5                       THEN DO;
      473    19620    5                            S_D.FIXCOM.INACTIVE(I) = '0'B; /* C_ACTIVE */
      474    19621    5                            IF S_D.FIXCOM.FPRG(I)
      475    19622    6                            THEN DO;
      476    19623                  /* Find the correct FPRG context and set up the breakpoint entry */
      477    19624    6                                 TFPRG$ = S_D.FPRG_CONTEXT$;
      478    19625    6                                 IF TFPRG$ = ADDR(NIL)
      479    19626    6                                 THEN GOTO FPRG_ERR;
      480    19627    6                                 RES = S_D.FIXCOM.FPRG_RES(I);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:15   
      481    19628    6                                 RES_SIZE = S_D.FIXCOM.FPRG_RES_SIZE(I);
      482    19629    7                                 DO WHILE (SUBSTR(RES, 0, RES_SIZE) ~= SUBSTR(TFPRG$->
             19629                                          FPRG$CONTEXT.RES,
      483    19630    7                                   0, TFPRG$->FPRG$CONTEXT.RES_SIZE));
      484    19631    7                                      TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
      485    19632    7                                      IF TFPRG$ = ADDR(NIL)
      486    19633    7                                      THEN GOTO FPRG_ERR;
      487    19634    7                                    END;
      488    19635    6                                 II = 1;
      489    19636    7                                 DO WHILE (TFPRG$->FPRG$CONTEXT.FIXCOM_INDEX(II) ~= 0
      490    19637    7                                   AND II <= 20);
      491    19638    7                                      II = II + 1;
      492    19639    7                                    END;
      493    19640    6                                 IF II > 20
      494    19641    7                                 THEN DO;
      495    19642    7                                      S_D.ERROR = 288; /* E@TOOMANYBKPNTS */
      496    19643    7                                      GOTO ERR;
      497    19644    7                                    END;
      498    19645    6                                 TFPRG$ -> FPRG$CONTEXT.FIXCOM_INDEX(II) = I;
      499    19646    6                                 FATT$ = PINCRW(S_D.VARCOM$, S_D.FIXCOM.FAI(I));
      500    19647    6                                 CALL DFA$SET_AT (II, FATT$ -> AT_FIRST.BYPASS_COUNT, I
             19647                                          ) ALTRET(NOGO);
      501    19648    6                               END;
      502    19649    5                          END;
      503    19650    4                       ELSE IF S_D.DO$->ACTIVE$CMD.CMD = 50 /*C_INACTIVE*/
      504    19651    5                            THEN DO;
      505    19652    5                                 IF S_D.IXFIX = I
      506    19653    6                                 THEN DO;
      507    19654    6                                      S_D.FAULTCMD$ = ADDR(NIL);
      508    19655    6                                      S_D.ENTRYCMD$ = ADDR(NIL);
      509    19656    6                                    END;
      510    19657    5                                 IF S_D.FIXCOM.FPRG(I)
      511    19658    6                                 THEN DO;
      512    19659    6                                      S_D.KILL1 = I;
      513    19660    6                                      CALL DFA$KILL1('1'B, S_D.FIXCOM.CMD(I), '0'B);
      514    19661    6                                    END;
      515    19662    5                                 S_D.FIXCOM.INACTIVE(I) = '1'B;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:16   
      516    19663    5                                 IF S_D.FIXCOM.CMD(I) = 67 /* C_WHEN */
      517    19664    6                                 THEN DO;
      518    19665    6                                      FATT$ = PINCRW(S_D.VARCOM$,S_D.FIXCOM.FAI(I));
      519    19666    7                                      IF S_D.OVERLAID THEN DO;
      520    19667    7                                           IF S_D.B$TREE$->B$TREE_NODE.FLGS.NOW_IN(
             19667                                                    FATT$->AT_FIRST.NODE)
      521    19668    7                                           THEN S_D.FIXCOM.NOT_IN(I) = '0'B;
      522    19669    8                                           ELSE DO;
      523    19670    8                                                S_D.FIXCOM.NOT_IN(I) = '1'B;
      524    19671    8                                                GOTO ENDREST;
             19671                                                         /* NOT IN, NOTHING ELSE TO DO */
      525    19672    8                                              END;
      526    19673    7                                         END;
      527    19674    6                                      IF S_D.FIXCOM.INACTIVE(I) THEN GOTO ENDREST;
      528    19675    6                                      FPT$SSC.V.VPNO# = WHEN.START_PAGE;
      529    19676    6                                      FPT$SSC.V.NUMPGS# = 1+ WHEN.END_PAGE - WHEN.
             19676                                               START_PAGE;
      530    19677    6                                      CALL M$SSC (FPT$SSC) ALTRET(ERRMSG);
      531    19678    6                                    END;
      532    19679    5   ENDREST:                      ;
      533    19680    5                               END;
      534    19681    4                            ELSE IF S_D.DO$->ACTIVE$CMD.CMD = 51
      535    19682    4                                 THEN S_D.FIXCOM.SILENT(I) = '1'B; /* C_SILENT */
      536    19683    4                                 ELSE S_D.FIXCOM.SILENT(I) = '0'B; /* UNSILENT */
      537    19684    4                       IF S_D.FIXCOM.CMD(I) = 53
      538    19685    4                       THEN IF S_D.DO$->ACTIVE$CMD.CMD = 19 /*C_ACTIVE*/
      539    19686    4                              AND S_D.TR$INFO.ACTIVE = '0'B
      540    19687    4                            THEN CALL DDA$TRACEON;
      541    19688    4                            ELSE IF S_D.DO$->ACTIVE$CMD.CMD = 50 /*C_INAVTIVE*/
      542    19689    4                                   AND S_D.TR$INFO.ACTIVE = '1'B
      543    19690    4                                 THEN CALL DDT$TRACEOFF;
      544    19691    4                                 ELSE ;
      545    19692    4   AISU_END:
      546    19693    4                     END;                  /* DO I */
      547    19694    3                END;
      548    19695    2          CASE(58);                    /* ALIB */
      549    19696    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:17   
      550    19697    2             THEN GOTO NOTIMPFPRG;
      551    19698    2             IF NOT S_D.ALIB
      552    19699    3             THEN DO;
      553    19700    3                  S_D.ERROR = 238;  /* E@CANTALIB */
      554    19701    3                  GOTO ERR;
      555    19702    3                END;
      556    19703    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALIB$CMD ) );
      557    19704    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
      558    19705    2             IF NOGO_BIT THEN RETURN;
      559    19706    2             IF S_D.DO$ -> ALIB$CMD.CODE = 85 AND S_D.LAST_ERROR='0'B /* C@RETURN */
      560    19707    2             THEN I = 2/*ALIB_RET*/;
      561    19708    2             ELSE I = 1/*ALIB_ALT*/;
      562    19709    2             IF S_D.DO$ -> ALIB$CMD.SUBCODE = 53 /* C@KEEP */
      563    19710    2             THEN NOT_IS = '1'B;
      564    19711    2             ELSE NOT_IS = '0'B;
      565    19712    2             IF S_D.GHOST1
      566    19713    3             THEN DO;
      567    19714    3                  BUF$ = ADDR( S_D.OUTPUT );
      568    19715    3                  S_D.OUTPUT = ' ';
      569    19716    3                  CALL DDQ$WRITE( BUF$, 4 );
      570    19717    3                  IF S_D.RUM_TOTAL_ERRORS = 0
      571    19718    4                  THEN DO;
      572    19719    4                       S_D.OUTPUT = '**** NO Total RUM errors encountered.';
      573    19720    4                       CALL DDQ$WRITE( BUF$, LENGTHC(
             19720                                '**** NO Total RUM errors encountered.' ) );
      574    19721    4                     END;
      575    19722    4                  ELSE DO;
      576    19723    4                       S_D.OUTPUT = '**** 00000 Total RUM errors encountered.';
      577    19724    4                       CALL BINCHAR( SUBSTR( S_D.OUTPUT, 5, 5 ), S_D.RUM_TOTAL_ERRORS )
             19724                                ;
      578    19725    4                       CALL DDQ$WRITE( BUF$, LENGTHC(
             19725                                '**** 00000 Total RUM errors encountered.' ) );
      579    19726    4                     END;
      580    19727    3                  S_D.OUTPUT = ' ';
      581    19728    3                  CALL DDQ$WRITE( BUF$, 4 );
      582    19729    3                  CALL DDQ$WRITE( BUF$, 4 );
      583    19730    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:18   
      584    19731    2             CALL DUA$ALIB( I, NOT_IS ) ALTRET( ERR );
      585    19732    2             IF S_D.S$TEP.ACTIVE
      586    19733    2             THEN CALL DDA$STEP_MORE ALTRET(ERR);
      587    19734    2             ELSE CALL DDA$GO ALTRET(NOGO);
      588    19735    2             ALTRETURN;
      589    19736    2          CASE(74);                  /* ALTVAR */
      590    19737    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DEF$CMD ) );
      591    19738    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
      592    19739    2             IF NOGO_BIT THEN RETURN;
      593    19740    2             S_D.XSCH = '0'B;
      594    19741    2             CALL DDS$SET_Q2T;
      595    19742    2             IF S_D.DO$ -> DEF$CMD.ALTVAR
      596    19743    2             THEN S_D.XOU_NAME = S_D.DO$ -> DEF$CMD.TEXTC;
      597    19744    2             CALL DDS$PD_SRCH( ADDR( S_D.XOU_NAME ), TEMP$ ) ALTRET( GOTXOU );
      598    19745    3             DO WHILE ( '0'B );
      599    19746    3   GOTXOU:
      600    19747    3                  CALL DDS$EQCS#( POFFW( TEMP$, S_D.EDEF$ ) / SIZEW( B$EDEF ) ) ALTRET(
             19747                           NOXOU );
      601    19748    3                  CALL DDS$SET_Q2X ALTRET( NOXOU );
      602    19749    3                END;
      603    19750    2   NOXOU:
      604    19751    2             CALL DDS$SET_T2Q;
      605    19752    2             IF ( NOT S_D.XSCH.OK )
      606    19753    3             THEN DO;
      607    19754    3                  S_D.ERROR_SYM$ = ADDR( S_D.DO$ -> DEF$CMD.TEXTC );
      608    19755    3                  S_D.ERROR = 167; /* E@NO_ALTVAR */
      609    19756    3                  GOTO ERR;
      610    19757    3                END;
      611    19758    2          CASE(59);                    /*C_ANLZ*/
      612    19759    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(ANLZ$CMD));
      613    19760    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
      614    19761    2             IF NOGO_BIT THEN RETURN;
      615    19762    2             IF S_D.DO$ -> ANLZ$CMD.FANLZ
      616    19763    3             THEN DO;
      617    19764    3                  IF S_D.RUM THEN CALL DUA$KILL_RUM;
      618    19765    3                  IF S_D.ANLZ THEN CALL DUA$KILL_ANLZ;
      619    19766    3                  IF S_D.DEBUG_CMD AND S_D.DEBUG_CMD_CONTEXT$ ~= ADDR(NIL)
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:19   
      620    19767    4                  THEN DO;
      621    19768    4                       S_D.CURRENT_FPRG_CONTEXT$ = S_D.DEBUG_CMD_CONTEXT$;
      622    19769    4                       CALL DFA$KILL_DELTA;
      623    19770    4                     END;
      624    19771    3                  IF S_D.DBGFEPDCB = 0
      625    19772    4                  THEN DO;
      626    19773    4                       CALL DFA$GET_FPRG_DCB(DCBNO);
      627    19774    4                       S_D.DBGFEPDCB = DCBNO;
      628    19775    4                     END;
      629    19776    4                  ELSE DO;
      630    19777    4                       IF DCBADDR(S_D.DBGFEPDCB) -> F$DCB.FCD#
      631    19778    5                       THEN DO;
      632    19779    5                            FPTCLOSE_DBG = FPT_CLOSE_DBG;
      633    19780    5                            FPTCLOSE_DBG.V_ = VECTOR(FPTCLOSE_DBG.V);
      634    19781    5                            FPTCLOSE_DBG.V.DCB# = S_D.DBGFEPDCB;
      635    19782    5                            CALL M$CLOSE (FPTCLOSE_DBG) ALTRET(ERRMSG);
      636    19783    5                          END;
      637    19784    4                       DCBNO = S_D.DBGFEPDCB;
      638    19785    4                     END;
      639    19786    3                  RES = S_D.DO$ -> ANLZ$CMD.RES.RES#;
      640    19787    3                  RES_SIZE = 4;
      641    19788    3                  FPTOPEN = FPT_OPEN_FANLZ;
      642    19789    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);
      643    19790    3                  FPTOPEN.V.DCB# = DCBNO;
      644    19791    3                  FPTOPEN.V.EVENT# = DCBNO;
      645    19792    3                  FPTOPEN.V.RES# = S_D.DO$ -> ANLZ$CMD.RES.RES#;
      646    19793    3                  CALL M$OPEN(FPTOPEN) ALTRET(ERRMSG);
      647    19794    3                  FPTSETFP = FPT_SETFP;
      648    19795    3                  FPTSETFP.V_ = VECTOR(FPTSETFP.V);
      649    19796    3                  FPTSETFP.V.DCB# = DCBNO;
      650    19797    3                  FPTSETFP.FPRG_ = VECTOR(HANDLER_FPRG);
      651    19798    3                  CALL M$SETFP(FPTSETFP) ALTRET(ERRMSG);
      652    19799    3                  FPTOPEN = FPT_OPEN;
      653    19800    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);
      654    19801    3                  FPTOPEN.NAME_ = VECTOR(VLP_NAME);
      655    19802    3                  FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);
      656    19803    3                  FPTOPEN.V.ASN# = %FILE#;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:20   
      657    19804    3                  IF S_D.DO$ ->ANLZ$CMD.FIDSCH.SIZE = 0
      658    19805    4                  THEN DO;
      659    19806    4                       FPTOPEN.NAME_ = VECTOR(VLP_MONNAME);
      660    19807    4                       FPTOPEN.ACCT_ = VECTOR(VLP_SYSACCT);
      661    19808    4                     END;
      662    19809    4                  ELSE DO;
      663    19810    4                       FPTFID = FPT_FID;
      664    19811    4                       FPTFID.V_ = VECTOR(FPTFID.V);
      665    19812    4                       FPTFID.NAME_ = VECTOR(VLP_NAME);
      666    19813    4                       FPTFID.ACCT_ = VECTOR(VLP_ACCT);
      667    19814    4                       FPTFID.PASS_ = VECTOR(VLP_PASS);
      668    19815    4                       FPTFID.SN_ = VECTOR(VLP_SN);
      669    19816    4                       FPTFID.WSN_ = VECTOR(VLP_WSN);
      670    19817    4                       FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);
      671    19818    4                       FPTFID.RESULTS_ = VECTOR(VLR_FID);
      672    19819    4                       FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->ANLZ$CMD.FIDSCH.TEXT,
      673    19820    4                         0, S_D.DO$->ANLZ$CMD.FIDSCH.SIZE));
      674    19821    4                       CALL M$FID(FPTFID) ALTRET(ERRMSG);
      675    19822    4                       IF ~VLR_FID.ACCT
      676    19823    4                       THEN VLP_ACCT.ACCT# = B$JIT$ -> B$JIT.FACCN;
      677    19824    4                     END;
      678    19825    3                  IF S_D.SCHEMADCB = 0
      679    19826    4                  THEN DO;
      680    19827    4                       CALL DFA$GET_FPRG_DCB (DCBNO);
      681    19828    4                       S_D.SCHEMADCB = DCBNO;
      682    19829    4                       S_D.LMDCB = DCBNO;
      683    19830    4                     END;
      684    19831    4                  ELSE DO;
      685    19832    4                       IF DCBADDR(S_D.SCHEMADCB) -> F$DCB.FCD#
      686    19833    5                       THEN DO;
      687    19834    5                            FPT$CLOSE = FPT_CLOSE;
      688    19835    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);
      689    19836    5                            FPT$CLOSE.V.DCB# = S_D.SCHEMADCB;
      690    19837    5                            CALL M$CLOSE (FPT$CLOSE) ALTRET(ERRMSG);
      691    19838    5                          END;
      692    19839    4                       S_D.LMDCB = S_D.SCHEMADCB;
      693    19840    4                     END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:21   
      694    19841    3                  FPTOPEN.V.DCB# = S_D.LMDCB;
      695    19842    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);
      696    19843                                                /* Allocate context */
      697    19844    3                  IF SUBSTR(DCBADDR(S_D.LMDCB) -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'
      698    19845    3                  THEN S_D.RUM_FEP = '1'B;
      699    19846    3                  ELSE S_D.RUM_FEP = '0'B;
      700    19847    3                  CALL DFA$SETUP_FPRG(S_D.DBGFEPDCB, RES, RES_SIZE, '1'B);
      701    19848    3                  S_D.DEBUG_CMD = '1'B;
      702    19849    3                  S_D.DEBUG_CMD_CONTEXT$ = S_D.CURRENT_FPRG_CONTEXT$;
      703    19850    3                  S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA = '0'B;
      704    19851    3                  S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.FANLZ = '1'B;
      705    19852    3                  TFPRG$ = S_D.CURRENT_FPRG_CONTEXT$;
      706    19853    3                  IF S_D.STAND_ALONE AND
      707    19854    3                    NOT S_D.EOM AND
      708    19855    3                    NOT S_D.BATCH
      709    19856    4                  THEN DO;
      710    19857    4                       CALL M$EOM (FPT_EOM) ALTRET(NOEOM2);
      711    19858    4                       S_D.EOM = '1'B;
      712    19859    5                       DO WHILE ( '0'B );
      713    19860    5   NOEOM2:
      714    19861    5                            IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0
      715    19862    5                            THEN GOTO ERRMSG;
      716    19863    5                          END;
      717    19864    4                     END;
      718    19865    3                  S_D.FIRST_TIME = '1'B;
      719    19866    3                  GOTO DO_EVENT;
      720    19867    3                END;
      721    19868    2             ELSE CALL DUA$ANLZ ALTRET(ERR);
      722    19869    2          CASE(2);                      /* AT */
      723    19870    2             S_D.ERROR = 502;         /* E@DELBUG - SHOULDN'T GET HERE */
      724    19871    2             CALL DDE$ERROR;
      725    19872    2          CASE(3);                   /* BREAK */
      726    19873    2             IF S_D.ALIB
      727    19874    3             THEN DO;
      728    19875    3                  S_D.ERROR = 265; /* E@CANTBRKALIB */
      729    19876    3                  GOTO ERR;
      730    19877    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:22   
      731    19878    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      732    19879    3             THEN DO;
      733    19880    3                  GD$MSG = '0'B;
      734    19881    3                  GD$MSG.FNC = %GD#RQSBREAK;
      735    19882    3                  CALL DFQ$WRITE_FD (S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERRMSG);
      736    19883    3                  FPTWAIT = FPT_WAIT;
      737    19884    3                  FPTWAIT.V_ = VECTOR(FPTWAIT.V);
      738    19885    3                  CALL M$WAIT(FPTWAIT);
      739    19886    3                  CALL DFQ$READ_FD (S_D.CURRENT_FPRG_CONTEXT$, '1'B)
      740    19887    4                  WHENALTRETURN DO;
      741    19888    4                       ALTRETURN;
      742    19889    4                     END;
      743    19890    3                  IF GD$MSG.FNC = %GD#RSPNOBREAKCONTROL
      744    19891    4                  THEN DO;
      745    19892    4                       S_D.ERROR = 93; /* E@NO_BREAK */
      746    19893    4                       GOTO ERR;
      747    19894    4                     END;
      748    19895    3                  S_D.STEP_L6 = '0'B;
      749    19896    3                  UNWIND TO S_D.DO_MESSAGE;
      750    19897    3                END;
      751    19898    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALL_ATTACH ) );
      752    19899    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
      753    19900    2             S_D.DRTN$->FPT$DRTN.V.ECC# = 2; /* HONOR USERS BREAK CONTROL */
      754    19901    2             CALL DDA$GO ALTRET (NOXCON);
      755    19902    2             ALTRETURN;
      756    19903    2          CASE( 21 );                /* C_BYPASS */
      757    19904    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
      758    19905    3             THEN DO;
      759    19906    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
      760    19907    4                  THEN DO;
      761    19908    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
      762    19909    4                       GOTO ERR;
      763    19910    4                     END;
      764    19911    3                END;
      765    19912    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
      766    19913    3                  THEN DO;
      767    19914    3                       S_D.ERROR = 502;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:23   
      768    19915    3                       CALL DDE$ERROR;
      769    19916    3                       GOTO ERR1;
      770    19917    3                     END;
      771    19918    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));
      772    19919    2             CALL DDA$IF( NOGO_BIT ) ALTRET(ERR);
      773    19920    2             IF NOGO_BIT THEN RETURN;
      774    19921    2             S_D.BYPASS = '1'B;
      775    19922    2             S_D.BYPASS_SAVE = S_D.BYPASS;
      776    19923    2          CASE (41);                  /* C_CACHE */
      777    19924    2             S_D.L6_CACHE = '1'B;
      778    19925    2          CASE (15);                   /* C_COPY */
      779    19926    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));
      780    19927    2             CALL DDA$IF (NOGO_BIT) ALTRET (ERR);
      781    19928    2             IF NOGO_BIT THEN RETURN;
      782    19929    2             S_D.COPY = '1'B;
      783    19930    2          CASE(82);                   /* CRASH */
      784    19931    2             GD$MSG = '0'B;
      785    19932    2             GD$MSG.FNC = %GD#RQSCRASH;
      786    19933    2             CALL DFQ$WRITE_FD (S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERRMSG);
      787    19934    2             TFPRG$ = S_D.CURRENT_FPRG_CONTEXT$;
      788    19935    2             GOTO DO_EVENT;
      789    19936    2          CASE(78);                   /* DBOOT */
      790    19937    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALL_ATTACH ) );
      791    19938    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
      792    19939    2             IF NOGO_BIT THEN RETURN;
      793    19940    2             CALL DXA$DBOOT;
      794    19941    2          CASE(89);                   /* DEBUG */
      795    19942    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( S_D.DO$ -> DEBUG$CMD ) );
      796    19943    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
      797    19944    2             IF NOGO_BIT THEN RETURN;
      798    19945    2             IF S_D.DEBUG_CMD AND S_D.DEBUG_CMD_CONTEXT$ ~= ADDR(NIL)
      799    19946    3             THEN DO;
      800    19947    3                  S_D.CURRENT_FPRG_CONTEXT$ = S_D.DEBUG_CMD_CONTEXT$;
      801    19948    3                  CALL DFA$KILL_DELTA;
      802    19949    3                END;
      803    19950    2             IF S_D.DO$ -> DEBUG$CMD.CG OR
      804    19951    2               S_D.DO$ -> DEBUG$CMD.TPACCT OR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:24   
      805    19952    2               S_D.DO$ -> DEBUG$CMD.SYSID
      806    19953    3             THEN DO;
      807    19954    3                  FPTOPEN = FPT_OPEN;
      808    19955    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);
      809    19956    3                  FPTOPEN.V.RES# = 'FE  ';
      810    19957    3                  IF S_D.DO$ -> DEBUG$CMD.CG OR S_D.DO$ -> DEBUG$CMD.TPACCT
      811    19958    4                  THEN DO;
      812    19959    4                       FPTOPEN.SN_ = VECTOR(VLP_SN);
      813    19960    4                       FPTOPEN.NAME_ = VECTOR(VLP_NAME);
      814    19961    4                       FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);
      815    19962    4                       FPTOPEN.PASS_ = VECTOR(VLP_PASS);
      816    19963    4                       FPTOPEN.SETSTA_ = VECTOR(VLP_SETSTA);
      817    19964    4                       FPTOPEN.V.ORG# = %DBGCG#;
      818    19965    4                       FPTOPEN.V.FUN# = %UPDATE#;
      819    19966    4                       IF S_D.DO$ -> DEBUG$CMD.TPACCT
      820    19967    5                       THEN DO;
      821    19968    5                            VLP_NAME.L# = S_D.DO$ -> DEBUG$CMD.CG_FID.SIZE;
      822    19969    5                            VLP_NAME.NAME# = S_D.DO$ -> DEBUG$CMD.CG_FID.TEXT;
      823    19970    5                            VLP_ACCT.ACCT# = S_D.DO$ -> DEBUG$CMD.CG_FID.TEXT;
      824    19971    5                            VLP_SN.SN#(0) = ' ';
      825    19972    5                          END;
      826    19973    5                       ELSE DO;
      827    19974                                           /* Make sure a valid CG fid was specified */
      828    19975    5                            FPTFID = FPT_FID;
      829    19976    5                            FPTFID.V_ = VECTOR(FPTFID.V);
      830    19977    5                            FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->DEBUG$CMD.CG_FID.
             19977                                     TEXT,
      831    19978    5                              0, S_D.DO$->DEBUG$CMD.CG_FID.SIZE));
      832    19979    5                            FPTFID.NAME_ = VECTOR(VLP_NAME);
      833    19980    5                            FPTFID.RES_ = VECTOR(FID_RES);
      834    19981    5                            FPTFID.RESULTS_ = VECTOR(VLR_FID);
      835    19982    5                            FPTFID.ACCT_ = VECTOR(VLP_ACCT);
      836    19983    5                            FPTFID.ASN_ = VECTOR(FID_ASN);
      837    19984    5                            FPTFID.PASS_ = VECTOR(VLP_PASS);
      838    19985    5                            FPTFID.SN_ = VECTOR(VLP_SN);
      839    19986    5                            CALL M$FID (FPTFID)
      840    19987    6                            WHENALTRETURN DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:25   
      841    19988    6                                 S_D.ERROR = 275; /* E@NOTCGFID */
      842    19989    6                                 GOTO ERR;
      843    19990    6                               END;
      844    19991    5                            IF FID_ASN ~= %COMGROUP#
      845    19992    6                            THEN DO;
      846    19993    6                                 S_D.ERROR = 275; /* E@NOTCGFID */
      847    19994    6                                 GOTO ERR;
      848    19995    6                               END;
      849    19996    5                            IF ~VLR_FID.ACCT
      850    19997    5                            THEN VLP_ACCT.ACCT# = B$JIT$ -> B$JIT.FACCN;
      851    19998    5                          END;
      852    19999                                                /* Set up station */
      853    20000    4                       VLP_SETSTA.MYSTATION# = SUBSTR(S_D.DO$->DEBUG$CMD.STATION_FID.
             20000                                TEXT,
      854    20001    4                         0, S_D.DO$->DEBUG$CMD.STATION_FID.SIZE);
      855    20002    4                       RES = S_D.DO$ -> DEBUG$CMD.STATION_FID.TEXT;
      856    20003    4                       RES_SIZE = S_D.DO$ -> DEBUG$CMD.STATION_FID.SIZE;
      857    20004    4                     END;
      858    20005    3                  IF S_D.DO$ -> DEBUG$CMD.SYSID
      859    20006    4                  THEN DO;
      860    20007    4                       FPTOPEN.V.ORG# = %DBGSYSID#;
      861    20008    4                       FPTOPEN.V.FUN# = %UPDATE#;
      862    20009    4                       FPTOPEN.V.DBGSYSID# = S_D.DO$ -> DEBUG$CMD.SYSID#;
      863    20010    4                       FPTOPEN.NODENAME_ = VECTOR(VLP_NODENAME);
      864    20011    4                       VLP_NODENAME.NODENAME# = SUBSTR(S_D.DO$->DEBUG$CMD.STATION_FID.
             20011                                TEXT,
      865    20012    4                         0, S_D.DO$->DEBUG$CMD.STATION_FID.SIZE);
      866    20013    4                       I = S_D.DO$ -> DEBUG$CMD.SYSID#;
      867    20014    4                       RES = 'S:';
      868    20015    4                       CALL DDR$BINTXT(ADDR(SUBSTR(RES,2)), I, %UINT_FMT, RES_SIZE);
      869    20016    4                       RES_SIZE = RES_SIZE + 2;
      870    20017    4                     END;
      871    20018                                                /* Get a DCB */
      872    20019    3                  CALL DFA$GET_FPRG_DCB (DCBNO);
      873    20020    3                  FPTOPEN.V.DCB# = DCBNO;
      874    20021    3                  FPTOPEN.V.EVENT# = DCBNO;
      875    20022                                      /* Call M$OPEN to get a connection to the FPRG */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:26   
      876    20023    3                  CALL M$OPEN (FPTOPEN)
      877    20024    4                  WHENALTRETURN DO;
      878    20025    4                       CALL DUE$ERRMSG;
      879    20026    4                       IF DCBADDR(DCBNO)->F$DCB.FCD#
      880    20027    5                       THEN DO;            /* CLOSE IT */
      881    20028    5                            FPT$CLOSE = FPT_CLOSE;
      882    20029    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);
      883    20030    5                            FPT$CLOSE.V.DCB# = DCBNO;
      884    20031    5                            CALL M$CLOSE (FPT$CLOSE)
      885    20032    6                            WHENALTRETURN DO;
      886    20033    6                                 CALL DUE$ERRMSG;
      887    20034    6                               END;
      888    20035    5                          END;
      889    20036                                                /* Release the DCB */
      890    20037    4                       FPTRELDCB = FPT_RELDCB;
      891    20038    4                       FPTRELDCB.V_ = VECTOR(FPTRELDCB.V);
      892    20039    4                       FPTRELDCB.V.DCB# = DCBNO;
      893    20040    4                       CALL M$RELDCB (FPTRELDCB)
      894    20041    5                       WHENALTRETURN DO;
      895    20042    5                            CALL DUE$ERRMSG;
      896    20043    5                          END;
      897    20044    4                       RETURN;
      898    20045    4                     END;
      899    20046                                                /* Set up context for this FPRG */
      900    20047    3                  S_D.DEBUG_CMD = '1'B;
      901    20048    3                  CALL DFA$SETUP_FPRG (DCBNO, RES, RES_SIZE) ALTRET(NOGO);
      902    20049    3                  S_D.DEBUG_CMD_CONTEXT$ = S_D.CURRENT_FPRG_CONTEXT$;
      903    20050    3                END;
      904    20051    2             IF S_D.DO$ -> DEBUG$CMD.FEP
      905    20052    3             THEN DO;
      906    20053                                                /* Get a DCB if need one */
      907    20054    3                  IF S_D.DBGFEPDCB = 0
      908    20055    4                  THEN DO;
      909    20056    4                       CALL DFA$GET_FPRG_DCB(DCBNO);
      910    20057    4                       S_D.DBGFEPDCB = DCBNO;
      911    20058    4                     END;
      912    20059    4                  ELSE DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:27   
      913    20060    4                       IF DCBADDR(S_D.DBGFEPDCB) -> F$DCB.FCD#
      914    20061    5                       THEN DO;
      915    20062    5                            FPTCLOSE_DBG = FPT_CLOSE_DBG;
      916    20063    5                            FPTCLOSE_DBG.V_ = VECTOR(FPTCLOSE_DBG.V);
      917    20064    5                            FPTCLOSE_DBG.V.DCB# = S_D.DBGFEPDCB;
      918    20065    5                            CALL M$CLOSE (FPTCLOSE_DBG) ALTRET(ERRMSG);
      919    20066    5                          END;
      920    20067    4                       DCBNO = S_D.DBGFEPDCB;
      921    20068    4                     END;
      922    20069                                                /* Open Remote debug */
      923    20070    3                  FPTOPEN = FPT_OPEN_DBG;
      924    20071    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);
      925    20072    3                  FPTOPEN.V.DCB# = DCBNO;
      926    20073    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);
      927    20074    3                  S_D.HOST_MESSAGE_BUF.C = ' ';
      928    20075    3                  MSG$ = ADDR(S_D.HOST_MESSAGE_BUF.C);
      929    20076    3                  MSG$ -> KF$MSG.MSG_ID = %KF_MSGC_EXCLDCB#;
      930    20077    3                  MSG$ -> KF$MSG.STATION = S_D.DO$ -> DEBUG$CMD.STATION_FID.TEXT;
      931    20078    3                  FPTWRITE_DBG = FPT_WRITE_DBG;
      932    20079    3                  FPTWRITE_DBG.BUF_ = VECTOR(S_D.HOST_MESSAGE_BUF.C);
      933    20080    3                  FPTWRITE_DBG.V_ = VECTOR(FPTWRITE_DBG.V);
      934    20081    3                  FPTWRITE_DBG.V.DCB# = DCBNO;
      935    20082    3                  FPTWRITE_DBG.STATION_ = VECTOR(FROG_STATION);
      936    20083    3                  CALL M$WRITE(FPTWRITE_DBG) ALTRET(ERRMSG);
      937    20084    3                  FPTREAD_DBG = FPT_READ_DBG;
      938    20085    3                  FPTREAD_DBG.BUF_ = VECTOR(S_D.HOST_MESSAGE_BUF.C);
      939    20086    3                  FPTREAD_DBG.V_ = VECTOR(FPTREAD_DBG.V);
      940    20087    3                  FPTREAD_DBG.V.DCB# = DCBNO;
      941    20088    3                  FPTREAD_DBG.STATION_ = VECTOR(FROG_STATION);
      942    20089    3                  CALL M$READ (FPTREAD_DBG) ALTRET(ERRMSG);
      943    20090    3                  IF MSG$ -> KF$MSG.MSG_SUBC ~= %KF_EXCLRSP_OK#
      944    20091    4                  THEN DO;
      945    20092    4                       IF MSG$ -> KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOTOK#
      946    20093    4                       THEN S_D.ERROR = 326; /* E@STATIONINUSE */
      947    20094    4                       IF MSG$ -> KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOSTA#
      948    20095    4                       THEN S_D.ERROR = 327; /* E@NOSUCHSTATION */
      949    20096    4                       FPTCLOSE_DBG = FPT_CLOSE_DBG;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:28   
      950    20097    4                       FPTCLOSE_DBG.V_ = VECTOR(FPTCLOSE_DBG.V);
      951    20098    4                       FPTCLOSE_DBG.V.DCB# = S_D.DBGFEPDCB;
      952    20099    4                       CALL M$CLOSE (FPTCLOSE_DBG) ALTRET(ERRMSG);
      953    20100    4                       GOTO ERR;
      954    20101    4                     END;
      955    20102                                                /* Set up schema */
      956    20103    3                  FPTOPEN = FPT_OPEN;
      957    20104    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);
      958    20105    3                  FPTOPEN.NAME_ = VECTOR(VLP_NAME);
      959    20106    3                  FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);
      960    20107    3                  FPTOPEN.V.ASN# = %FILE#;
      961    20108    3                  IF S_D.DO$ -> DEBUG$CMD.CG_FID.SIZE = 0
      962    20109    4                  THEN DO;
      963    20110    4                       FPTOPEN.NAME_ = VECTOR(VLP_MONNAME);
      964    20111    4                       FPTOPEN.ACCT_ = VECTOR(VLP_SYSACCT);
      965    20112    4                     END;
      966    20113    4                  ELSE DO;
      967    20114    4                       FPTFID = FPT_FID;
      968    20115    4                       FPTFID.V_ = VECTOR(FPTFID.V);
      969    20116    4                       FPTFID.NAME_ = VECTOR(VLP_NAME);
      970    20117    4                       FPTFID.ACCT_ = VECTOR(VLP_ACCT);
      971    20118    4                       FPTFID.PASS_ = VECTOR(VLP_PASS);
      972    20119    4                       FPTFID.SN_ = VECTOR(VLP_SN);
      973    20120    4                       FPTFID.WSN_ = VECTOR(VLP_WSN);
      974    20121    4                       FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);
      975    20122    4                       FPTFID.RESULTS_ = VECTOR(VLR_FID);
      976    20123    4                       FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->DEBUG$CMD.CG_FID.TEXT,
      977    20124    4                         0, S_D.DO$->DEBUG$CMD.CG_FID.SIZE));
      978    20125    4                       CALL M$FID(FPTFID) ALTRET(ERRMSG);
      979    20126    4                       IF ~VLR_FID.ACCT
      980    20127    4                       THEN VLP_ACCT.ACCT# = B$JIT$ -> B$JIT.FACCN;
      981    20128    4                     END;
      982    20129    3                  IF S_D.SCHEMADCB = 0
      983    20130    4                  THEN DO;
      984    20131    4                       CALL DFA$GET_FPRG_DCB (DCBNO);
      985    20132    4                       S_D.SCHEMADCB = DCBNO;
      986    20133    4                       S_D.LMDCB = DCBNO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:29   
      987    20134    4                     END;
      988    20135    4                  ELSE DO;
      989    20136    4                       IF DCBADDR(S_D.SCHEMADCB) -> F$DCB.FCD#
      990    20137    5                       THEN DO;
      991    20138    5                            FPT$CLOSE = FPT_CLOSE;
      992    20139    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);
      993    20140    5                            FPT$CLOSE.V.DCB# = S_D.SCHEMADCB;
      994    20141    5                            CALL M$CLOSE (FPT$CLOSE) ALTRET(ERRMSG);
      995    20142    5                          END;
      996    20143    4                       S_D.LMDCB = S_D.SCHEMADCB;
      997    20144    4                     END;
      998    20145    3                  FPTOPEN.V.DCB# = S_D.LMDCB;
      999    20146    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);
     1000    20147                                                /* Allocate context */
     1001    20148    3                  IF SUBSTR(DCBADDR(S_D.LMDCB) -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'
     1002    20149    3                  THEN S_D.RUM_FEP = '1'B;
     1003    20150    3                  ELSE S_D.RUM_FEP = '0'B;
     1004    20151    3                  RES = S_D.DO$ -> DEBUG$CMD.STATION_FID.TEXT;
     1005    20152    3                  RES_SIZE = S_D.DO$ -> DEBUG$CMD.STATION_FID.SIZE;
     1006    20153    3                  CALL DFA$SETUP_FPRG(S_D.DBGFEPDCB, RES, RES_SIZE, '1'B);
     1007    20154    3                  S_D.DEBUG_CMD = '1'B;
     1008    20155    3                  TFPRG$ = S_D.CURRENT_FPRG_CONTEXT$;
     1009    20156                                                /* set up debug station */
     1010    20157    3                  TRMDBG = TRM_DBG;
     1011    20158    3                  TRMDBG.V_ = VECTOR(TRMDBG.V);
     1012    20159    3                  TRMDBG.V.DCB# = S_D.DBGFEPDCB;
     1013    20160    3                  TRMDBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);
     1014    20161    3                  CALL M$STRMATTR (TRMDBG) ALTRET(ERRMSG);
     1015    20162    3                  FPTEOM_DBG = FPT_EOM_DBG;
     1016    20163    3                  FPTEOM_DBG.V_ = VECTOR(FPTEOM_DBG.V);
     1017    20164    3                  FPTEOM_DBG.V.DCB# = S_D.DBGFEPDCB;
     1018    20165    3                  FPTEOM_DBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);
     1019    20166    3                  CALL M$EOM (FPTEOM_DBG) ALTRET(ERRMSG);
     1020    20167    3                  CTLDBG = CTL_DBG;
     1021    20168    3                  CTLDBG.V_ = VECTOR(CTLDBG.V);
     1022    20169    3                  CTLDBG.V.DCB# = S_D.DBGFEPDCB;
     1023    20170    3                  CTLDBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:30   
     1024    20171    3                  CALL M$STRMCTL (CTLDBG) ALTRET(ERRMSG);
     1025    20172    3                  FPTPROMPT_DBG = FPT_PROMPT_DBG;
     1026    20173    3                  FPTPROMPT_DBG.V_ = VECTOR(FPTPROMPT_DBG.V);
     1027    20174    3                  FPTPROMPT_DBG.V.DCB# = S_D.DBGFEPDCB;
     1028    20175    3                  FPTPROMPT_DBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);
     1029    20176    3                  CALL M$PROMPT (FPTPROMPT_DBG) ALTRET(ERRMSG);
     1030    20177    3                  GD$MSG = '0'B;
     1031    20178    3                  GD$MSG.FNC = %GD#RQSCONTROL;
     1032    20179    3                  CALL DFQ$WRITE_FD (TFPRG$) ALTRET(ERRMSG);
     1033    20180    3                  IF S_D.STAND_ALONE AND
     1034    20181    3                    NOT S_D.EOM AND
     1035    20182    3                    NOT S_D.BATCH
     1036    20183    4                  THEN DO;
     1037    20184    4                       CALL M$EOM (FPT_EOM) ALTRET(NOEOM1);
     1038    20185    4                       S_D.EOM = '1'B;
     1039    20186    5                       DO WHILE ( '0'B );
     1040    20187    5   NOEOM1:
     1041    20188    5                            IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0
     1042    20189    5                            THEN GOTO ERRMSG;
     1043    20190    5                          END;
     1044    20191    4                     END;
     1045    20192    3                  S_D.FIRST_TIME = '1'B;
     1046    20193    3                  GOTO DO_EVENT;
     1047    20194    3                END;
     1048    20195    2             ELSE S_D.DEBUGF = BITBIN( S_D.DO$ -> DEBUG$CMD.OPTIONS );
     1049    20196    2             IF S_D.STAND_ALONE AND
     1050    20197    2               NOT S_D.EOM AND
     1051    20198    2               NOT S_D.BATCH
     1052    20199    3             THEN DO;
     1053    20200    3                  CALL M$EOM (FPT_EOM) ALTRET(NOEOM);
     1054    20201    3                  S_D.EOM = '1'B;
     1055    20202    4                  DO WHILE ( '0'B );
     1056    20203    4   NOEOM:
     1057    20204    4                       IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0
     1058    20205    4                       THEN GOTO ERRMSG;
     1059    20206    4                     END;
     1060    20207    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:31   
     1061    20208    2          CASE( 63 );                /* C_DELETE */
     1062    20209    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1063    20210    2             THEN GOTO NOTIMPFPRG;
     1064    20211    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1065    20212    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1066    20213    2             IF NOGO_BIT THEN RETURN;
     1067    20214    2             CALL DUA$DELETE;
     1068    20215    2          CASE(4);                     /* DEF */
     1069    20216                                                /* POINT TO IFSPEC */
     1070    20217    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1071    20218    3             THEN DO;
     1072    20219    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1073    20220    4                  THEN DO;
     1074    20221    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1075    20222    4                       GOTO ERR;
     1076    20223    4                     END;
     1077    20224    3                END;
     1078    20225    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1079    20226    3                  THEN DO;
     1080    20227    3                       S_D.ERROR = 502;
     1081    20228    3                       CALL DDE$ERROR;
     1082    20229    3                       GOTO ERR1;
     1083    20230    3                     END;
     1084    20231    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DEF$CMD));
     1085    20232    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1086    20233    2             IF NOGO_BIT THEN RETURN;
     1087    20234    2             CALL DDA$DEF ALTRET(ERR);
     1088    20235    2          CASE( 37 );                   /* C_DIC */
     1089    20236    2             IF D_XDELTA THEN DX_DIC = '1'B;
     1090    20237    2             ELSE S_D.DEBUG = '0'B;
     1091    20238    2          CASE(60);                    /* DLCT */
     1092    20239    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(LCT$CMD));
     1093    20240    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1094    20241    2             IF NOGO_BIT THEN RETURN;
     1095    20242    2             CALL DFA$DLCT ALTRET(ERR);
     1096    20243    2          CASE(5);                      /* DO */
     1097    20244    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:32   
     1098    20245    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1099    20246    2             IF NOGO_BIT THEN RETURN;
     1100    20247    2             CALL DDA$USER_DO ALTRET(NOGO);
     1101    20248    2             ALTRETURN;
     1102    20249    2          CASE(6);                 /* DISPLAY */
     1103    20250                                                /* POINT S_D.D$ TO IFSPEC */
     1104    20251    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DISPLAY));
     1105    20252    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1106    20253    2             IF NOGO_BIT THEN RETURN;
     1107    20254    2             CALL DDA$DISP ALTRET(ERR);
     1108    20255    2          CASE(7);                    /* DUMP */
     1109    20256    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1110    20257    3             THEN DO;
     1111    20258    3                  S_D.ERROR = 502;
     1112    20259    3                  CALL DDE$ERROR;
     1113    20260    3                  GOTO ERR1;
     1114    20261    3                END;
     1115    20262    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DUMP$CMD));
     1116    20263    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1117    20264    2             IF NOGO_BIT THEN RETURN;
     1118    20265    2             IF S_D.DO$->DUMP$CMD.FID.SIZE>0 AND NOT S_D.DO$->DUMP$CMD.DEST
     1119    20266    2             THEN CALL DFA$DFMT ALTRET(ERR);
     1120    20267    3             ELSE DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );
     1121    20268    3               CASE ( %HOST );
     1122    20269    3                  CALL DDA$DUMP_DO ALTRET(ERR);
     1123    20270    3               CASE ( %L6 );
     1124    20271    3                  CALL DFA$DUMP ALTRET ( ERR );
     1125    20272    3               CASE ( ELSE );
     1126    20273    3                  S_D.ERROR = 502;    /* E@DELBUG */
     1127    20274    3                  ALTRETURN;
     1128    20275    3               END;
     1129    20276    2          CASE(33);                    /* ECHO */
     1130    20277    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1131    20278    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1132    20279    2             IF NOGO_BIT THEN RETURN;
     1133    20280    2             IF NOT D_XDELTA THEN S_D.ECHO = '1'B;
     1134    20281    2             ELSE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:33   
     1135    20282    2                  CALL SETDCTX( ECHO_DEV );
     1136    20283    2          CASE(35);                     /*C_EOM*/
     1137    20284    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));
     1138    20285    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);
     1139    20286    2             IF NOGO_BIT THEN RETURN;
     1140    20287    2             IF ( NOT D_XDELTA ) AND ( NOT S_D.BATCH )
     1141    20288    3             THEN DO;
     1142    20289    3                  CALL M$EOM (FPT_EOM) ALTRET(ERRMSG);
     1143    20290    3                  S_D.EOM = '1'B;
     1144    20291    3                END;
     1145    20292    2          CASE (86);                 /*C_ERRFID*/
     1146    20293    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));
     1147    20294    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);
     1148    20295    2             IF NOGO_BIT THEN RETURN;
     1149    20296    2             FPTFID = FPT_FID;
     1150    20297    2             FPTFID.V_ = VECTOR(FPTFID.V);
     1151    20298    2             FPTFID.NAME_ = VECTOR(S_D.ERRFID);
     1152    20299    2             FPTFID.ACCT_ = VECTOR(S_D.ERRACCT);
     1153    20300    2             FPTFID.PASS_ = VECTOR(S_D.ERRPASS);
     1154    20301    2             FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->RUM$CMD.FID.TEXT,0,S_D.DO$->
             20301                      RUM$CMD.FID.SIZE));
     1155    20302    2             FPTFID.SN_ = VECTOR(VLP_SN);
     1156    20303    2             FPTFID.WSN_ = VECTOR(VLP_WSN);
     1157    20304    2             FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);
     1158    20305    2             FPTFID.RESULTS_ = VECTOR(VLR_FID);
     1159    20306    2             CALL M$FID (FPTFID) ALTRET (ERRMSG);
     1160    20307    2          CASE(8);                    /* EVAL */
     1161    20308    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1162    20309    3             THEN DO;
     1163    20310    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1164    20311    4                  THEN DO;
     1165    20312    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1166    20313    4                       GOTO ERR;
     1167    20314    4                     END;
     1168    20315    3                END;
     1169    20316    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1170    20317    3                  THEN DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:34   
     1171    20318    3                       S_D.ERROR = 502;
     1172    20319    3                       CALL DDE$ERROR;
     1173    20320    3                       GOTO ERR1;
     1174    20321    3                     END;
     1175    20322    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(EVAL$CMD));
     1176    20323    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1177    20324    2             IF NOGO_BIT THEN RETURN;
     1178    20325    2             CALL DDA$EVAL ALTRET(ERR);
     1179    20326    2          CASE ( 76 );                 /* C_EXIT */
     1180    20327    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1181    20328    2             THEN GOTO NOTIMPFPRG;
     1182    20329    2             IF S_D.ALIB
     1183    20330    3             THEN DO;
     1184    20331    3                  S_D.ERROR = 270; /* E@CANTEXITALIB */
     1185    20332    3                  GOTO ERR;
     1186    20333    3                END;
     1187    20334    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
     1188    20335    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1189    20336    2             IF NOGO_BIT THEN RETURN;
     1190    20337    2             TEMP$ = B$TCB$->B$TCB.STK$;
     1191    20338    2             IF NOT S_D.LINK_ENTRY
     1192    20339    2               AND NOT(TEMP$->B$EXCFR.ECC = %ECC_XCON#
     1193    20340    2               AND TEMP$->B$XCON.RNST='0'B
     1194    20341    2               AND TEMP$->B$XCON.CECCB.LNK)
     1195    20342    2               AND NOT(TEMP$->B$EXCFR.ECC = %ECC_EXCRTN#
     1196    20343    2               AND TEMP$->B$EXCFR.SUBC = %SC_XCONXIT#
     1197    20344    2               AND TEMP$->B$XCON.CECCB ~= '000000000'B)
     1198    20345                                                /* EXIT is legal only
     1199    20346                                                 if current RU was entered via M$LINK
     1200    20347                                       or if this is an M$EXIT for M$LDTRC or M$SAVE */
     1201    20348    3             THEN DO;
     1202    20349    3                  S_D.ERROR = 158;  /*E@CANTEXIT*/
     1203    20350    3                  GOTO ERR;
     1204    20351    3                END;
     1205    20352    2             S_D.DRTN$->FPT$DRTN.V.ECC# = 3; /* SIMULATE XCON */
     1206    20353    2             CALL DDA$GO ALTRET (NOXCON);
     1207    20354    2             S_D.E$XIT = '1'B;             /* SET EXIT FLAG FOR DDA$DELTA */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:35   
     1208    20355    2             ALTRETURN;
     1209    20356    2          CASE(10);                    /* FIND */
     1210    20357    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1211    20358    2             THEN GOTO NOTIMPFPRG;
     1212    20359    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1213    20360    3             THEN DO;
     1214    20361    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1215    20362    4                  THEN DO;
     1216    20363    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1217    20364    4                       GOTO ERR;
     1218    20365    4                     END;
     1219    20366    3                END;
     1220    20367    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1221    20368    3                  THEN DO;
     1222    20369    3                       S_D.ERROR = 502;
     1223    20370    3                       CALL DDE$ERROR;
     1224    20371    3                       GOTO ERR1;
     1225    20372    3                     END;
     1226    20373    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(FIND$CMD));
     1227    20374    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);
     1228    20375    2             IF NOGO_BIT THEN RETURN;
     1229    20376    2             CALL DDA$FIND ALTRET(ERR);
     1230    20377    2          CASE(16);                  /* C_FORMAT */
     1231    20378    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(FORMAT$CMD));
     1232    20379    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1233    20380    2             IF NOGO_BIT THEN RETURN;
     1234    20381    2             IF S_D.DO$->FORMAT$CMD.TYPE = 61 /*C@MODIFY*/
     1235    20382    2             THEN S_D.FMT_DEFAULT = S_D.DO$->FORMAT$CMD.FORMAT;
     1236    20383    2             ELSE IF S_D.DO$->FORMAT$CMD.TYPE = 60 /*C@EVAL*/
     1237    20384    2                  THEN S_D.EFMT_DEFAULT = S_D.DO$->FORMAT$CMD.FORMAT;
     1238    20385    3                  ELSE DO;
     1239    20386    3                       S_D.ERROR = 502; /*E@DELBUG*/
     1240    20387    3                       GOTO ERR;
     1241    20388    3                     END;
     1242    20389    2          CASE(11);                    /* GOTO */
     1243    20390    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(GO$CMD));
     1244    20391    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:36   
     1245    20392    2             IF NOGO_BIT THEN RETURN;
     1246    20393    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.GOPOS
     1247    20394    3             THEN DO;
     1248    20395    3                  S_D.ERROR = 217; /*E@CANTGOALIB*/
     1249    20396    3                  GOTO ERR;
     1250    20397    3                END;
     1251    20398    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.TRAP AND S_D.DO$->GO$CMD.STEP
     1252    20399    3             THEN DO;
     1253    20400    3                  S_D.ERROR = 268; /* E@CANTGOTSALIB */
     1254    20401    3                  GOTO ERR;
     1255    20402    3                END;
     1256    20403    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.TRAP
     1257    20404    3             THEN DO;
     1258    20405    3                  S_D.ERROR = 266; /* E@CANTGOTRPALIB */
     1259    20406    3                  GOTO ERR;
     1260    20407    3                END;
     1261    20408    2             IF S_D.DO$ -> GO$CMD.TRAP AND S_D.DO$ -> GO$CMD.STEP AND
     1262    20409    2               S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1263    20410    3             THEN DO;
     1264    20411    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1265    20412    4                  THEN DO;
     1266    20413    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1267    20414    4                       GOTO ERR;
     1268    20415    4                     END;
     1269    20416    3                END;
     1270    20417    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1271    20418    3                  THEN DO;
     1272    20419    3                       S_D.ERROR = 502;
     1273    20420    3                       CALL DDE$ERROR;
     1274    20421    3                       GOTO ERR1;
     1275    20422    3                     END;
     1276    20423    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.STEP
     1277    20424    3             THEN DO;
     1278    20425    3                  S_D.ERROR = 267; /* E@CANTGOSTPALIB */
     1279    20426    3                  GOTO ERR;
     1280    20427    3                END;
     1281    20428    2             IF S_D.FPRG_CONTEXT$ ~= ADDR(NIL) AND
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:37   
     1282    20429    2               S_D.DO$ -> GO$CMD.ALL AND
     1283    20430    2               S_D.DO$ -> GO$CMD.TRAP
     1284    20431    3             THEN DO;
     1285    20432    3                  S_D.ERROR = 279; /* E@CANTGOTRAPFPRG */
     1286    20433    3                  GOTO ERR;
     1287    20434    3                END;
     1288    20435    2             IF S_D.FPRG_CONTEXT$ ~= ADDR(NIL) AND
     1289    20436    2               S_D.DO$ -> GO$CMD.ALL AND
     1290    20437    2               S_D.DO$ -> GO$CMD.STEP
     1291    20438    3             THEN DO;
     1292    20439    3                  S_D.ERROR = 280; /* E@CANTGOSTEPFPRG */
     1293    20440    3                  GOTO ERR;
     1294    20441    3                END;
     1295    20442    2             S_D.STEP_L6 = '0'B;
     1296    20443    2             IF S_D.DO$ -> GO$CMD.TRAP AND
     1297    20444    2               S_D.DO$ -> GO$CMD.GOPOS
     1298    20445    3             THEN DO;
     1299    20446    3                  S_D.GOTRAPPOS = '1'B;
     1300    20447    3                  S_D.GOTRAP_POSITION = S_D.DO$ -> GO$CMD.POSITION;
     1301    20448    3                END;
     1302    20449    2             ELSE S_D.GOTRAPPOS = '0'B;
     1303    20450    3             IF S_D.PATCH THEN DO;
     1304    20451    3                  S_D.PATCH = '0'B;
     1305    20452    3                  S_D.PADDR = 0;
     1306    20453        /* SET THE ECHO TO ME AFTER ALL MONITOR PATCHES HAVE BEEN APPLIED */
     1307    20454    3                  ECHO_DEV = DCTX_ME;
     1308    20455    3                  CALL DXC$EOP;            /* WRITE THE MONITOR */
     1309    20456    3                END;
     1310    20457    2             IF S_D.DO$ -> GO$CMD.HOST OR
     1311    20458    2               (S_D.DO$ -> GO$CMD.ALL AND
     1312    20459    2               S_D.FPRG_CONTEXT$ = ADDR(NIL))
     1313    20460    3             THEN DO;
     1314    20461    3                  IF S_D.DO$ -> GO$CMD.GOPOS
     1315    20462    4                  THEN DO;
     1316    20463    4                       S_D.SAVEIC = S_D.DO$->GO$CMD.POSITION;
     1317    20464    4                       S_D.FAULTCMD$ = ADDR(NIL);
     1318    20465    4                     END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:38   
     1319    20466    3   GOHOST:
     1320    20467    4                  IF S_D.DO$->GO$CMD.TRAP THEN DO;
     1321    20468    4                       IF S_D.SV.DELENT = 0
     1322    20469    5                       THEN DO;
     1323    20470    5                            S_D.ERROR = 100; /*E@NO_TRAP*/
     1324    20471    5                            GOTO ERR;
     1325    20472    5                          END;
     1326    20473    5                       ELSE DO;
     1327    20474    5                            IF D_XDELTA
     1328    20475    6                            THEN DO;
     1329    20476    6                                 S_D.RETURNN = 1/*RET_LTRAD*/;
     1330    20477    6                                 S_D.SAVEIC = S_D.GOIC;
             20477                                          /* Put back the unaltered fault ic */
     1331    20478    6                               END;
     1332    20479    6                            ELSE DO;
     1333    20480    6                                 S_D.DRTN$->FPT$DRTN.V.SETECC# = '0'B;
     1334    20481    6                                 S_D.FAULTCMD$ = ADDR(NIL);
     1335    20482                                                /* WE DON'T NEED TO DO ANY FANCY STUFF,
     1336    20483                                           'CAUSE WE AREN'T GOING TO SAVEIC ANYWAY */
     1337    20484    6                               END;
     1338    20485    5                          END;
     1339    20486    4                     END;
     1340    20487    3                  DO$ = S_D.DO$;
     1341    20488    4                  IF S_D.DO$->GO$CMD.STEP THEN DO;
     1342    20489    4                       S_D.S$TEP.CUR_COUNT = 1; /* STEP ONLY ONCE */
     1343    20490    4                       CALL DDA$STEP_MORE ALTRET(ERR);
     1344    20491    4                     END;
     1345    20492    3                  ELSE IF S_D.S$TEP.ACTIVE THEN
     1346    20493    3                            CALL DDA$STEP_MORE ALTRET(ERR);
             20493                                     /* CONTINUE INTERRUPTED STEP */
     1347    20494    3                       ELSE CALL DDA$GO ALTRET(NOGO);
     1348    20495    3                  IF DO$ -> GO$CMD.HOST AND
     1349    20496    3                    S_D.FPRG_CONTEXT$ ~= ADDR(NIL)
     1350    20497    3                  THEN CALL REPORT_STOPPED;
     1351    20498    3                  CALL DDA$RESET_PATCH_SPACE;
     1352    20499    3                  ALTRETURN;
     1353    20500    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:39   
     1354    20501    2             IF (S_D.DO$ -> GO$CMD.ALL AND
     1355    20502    2               S_D.FPRG_CONTEXT$ ~= ADDR(NIL))
     1356    20503    3             THEN DO;
     1357    20504    3                  TFPRG$ = S_D.FPRG_CONTEXT$;
     1358    20505    4                  DO WHILE (TFPRG$ ~= ADDR(NIL));
     1359    20506    4                       IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED AND
     1360    20507    4                         TFPRG$ -> FPRG$CONTEXT.READ_FD = '0'B
     1361    20508    5                       THEN DO;
     1362    20509    5                            S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;
     1363    20510    5                            CALL DFA$GO('1'B) ALTRET(NOGO);
     1364    20511    5                          END;
     1365    20512    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     1366    20513    4                     END;
     1367    20514    3                  CALL DDA$RESET_PATCH_SPACE;
     1368    20515    3                  IF S_D.DEBUG_CMD
     1369    20516    3                  THEN GOTO WAIT_SEARCH;
     1370    20517    3                  CALL DFA$KILL_FPRG;
     1371    20518    3                  TFPRG$ = S_D.FPRG_CONTEXT$;
     1372    20519    4                  DO WHILE(TFPRG$ ~= ADDR(NIL));
     1373    20520    4                       IF TFPRG$ -> FPRG$CONTEXT.READ_FD
     1374    20521    4                       THEN GOTO DO_EVENT;
     1375    20522    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     1376    20523    4                     END;
     1377    20524    3                  GOTO GOHOST;
     1378    20525    3                END;
     1379    20526    2             IF S_D.DO$ -> GO$CMD.FPRG
     1380    20527    3             THEN DO;
     1381    20528    3                  RES = S_D.DO$ -> GO$CMD.FPRG_RES;
     1382    20529    3                  IF S_D.FPRG_CONTEXT$ = ADDR(NIL)
     1383    20530    4                  THEN DO;
     1384    20531    4                       S_D.ERROR = 281; /* E@NOFPRGGO */
     1385    20532    4                       GOTO ERR;
     1386    20533    4                     END;
     1387    20534    3                  TFPRG$ = S_D.FPRG_CONTEXT$;
     1388    20535    4                  DO WHILE (TFPRG$ -> FPRG$CONTEXT.RES ~= RES);
     1389    20536    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     1390    20537    4                       IF TFPRG$ = ADDR(NIL)
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:40   
     1391    20538    5                       THEN DO;
     1392    20539    5                            S_D.ERROR = 278; /* E@NOFPRG */
     1393    20540    5                            GOTO ERR;
     1394    20541    5                          END;
     1395    20542    4                     END;
     1396    20543    3                  S_D.CURRENT_FPRG_CONTEXT$ =TFPRG$;
     1397    20544    3                  IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED OR
     1398    20545    3                    TFPRG$ -> FPRG$CONTEXT.STATE = %ATEXIT
     1399    20546    3                  THEN CALL DFA$GO('1'B) ALTRET(NOGO);
     1400    20547    4                  ELSE DO;
     1401    20548    4                       S_D.ERROR = 282; /* E@FPRGNOTSTOPPED */
     1402    20549    4                       GOTO ERR;
     1403    20550    4                     END;
     1404    20551    3                  CALL DDA$RESET_PATCH_SPACE;
     1405    20552    3                  IF S_D.DEBUG_CMD
     1406    20553    3                  THEN GOTO WAIT_SEARCH;
     1407    20554    3                  CALL DFA$KILL_FPRG;
     1408    20555    3                  CALL REPORT_STOPPED;
     1409    20556    3                  IF S_D.DO$ -> GO$CMD.STEP
     1410    20557    4                  THEN DO;
     1411    20558                                                /* Do an implicit WAIT */
     1412    20559    4                       GOTO WAIT_SEARCH;
     1413    20560    4                     END;
     1414    20561    3                  CALL DDR$REPORT(28/*R_STOP*/);
     1415    20562    3                END;
     1416    20563    2          CASE(12, 80, 81); /* HELP, QMARK1, QMARK2 */
     1417    20564    2             IF D_XDELTA
     1418    20565    3             THEN DO;
     1419    20566    3                  S_D.ERROR = 173; /* E@HELP_XDELTA */
     1420    20567    3                  GOTO ERR;
     1421    20568    3                END;
     1422    20569    2             CALL DUA$HELP;
     1423    20570    2          CASE(13);                 /* HISTORY */
     1424    20571    2             S_D.D$=PINCRW(S_D.DO$, SIZEW(HIST$CMD));
     1425    20572    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);
     1426    20573    2             IF NOGO_BIT THEN RETURN;
     1427    20574    2             CALL DDA$HIST;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:41   
     1428    20575    2          CASE(17, 71);          /* C_IGNORE, C_TRAP */
     1429    20576    2             S_D.D$=PINCRW(S_D.DO$, SIZEW(KEEP$CMD));
     1430    20577    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1431    20578    2             IF NOGO_BIT THEN RETURN;
     1432    20579    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1433    20580    2             THEN CALL DDA$KEEP;      /* IT ALL BECOMES CLEAR WHEN YOU REMEMBER
     1434    20581                                           THAT KEEP/TRAP/IGNORE ARE A MATCHED SET,
     1435    20582                                           BUT KEEP IN USER DELTA AND KEEP IN XDELTA
     1436    20583                                           MEAN TWO DIFFERENT THINGS */
     1437    20584    2             ELSE CALL DFA$KEEP ALTRET(NOGO);
     1438    20585    2          CASE(20);                    /* KILL */
     1439    20586    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SHOW$CMD));
     1440    20587    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1441    20588    2             IF NOGO_BIT THEN RETURN;
     1442    20589    2             CALL  DDA$KILL;
     1443    20590    2          CASE(22);                    /* KEEP */
     1444    20591    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
     1445    20592    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1446    20593    2             IF NOGO_BIT THEN RETURN;
     1447    20594                                           /* REMEMBER THE KEEP TYPE (ALL, NONE, MON) */
     1448    20595    2             IF D_XDELTA
     1449    20596    3             THEN DO;
     1450    20597    3                  S_D.K$EEP.TYPE = S_D.DO$->DOO.ID;
     1451    20598    3                  IF S_D.K$EEP.TYPE = 4 OR /* KEEP_SCREECH */
     1452    20599    3                    S_D.K$EEP.TYPE = 3 OR /* KEEP_MON */
     1453    20600    3                    S_D.K$EEP.TYPE = 1 /* KEEP_ALL */
     1454    20601    3                  THEN PINCRW(MIS$, IRM_NOKP_SCR)->UBIN36 = 0;
     1455    20602    3                  ELSE PINCRW(MIS$, IRM_NOKP_SCR)->UBIN36 = 1;
     1456    20603    3                END;
     1457    20604    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1458    20605    2                  THEN CALL DDA$KEEP;
     1459    20606    2                  ELSE CALL DFA$KEEP ALTRET(NOGO);
     1460    20607    2          CASE(27);                     /* LET  */
     1461    20608    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(LET$CMD));
     1462    20609    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1463    20610    2             IF NOGO_BIT THEN RETURN;
     1464    20611    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:42   
     1465    20612    2             THEN CALL DDA$LET  ALTRET(ERR);
     1466    20613    2             ELSE CALL DFA$LET  ALTRET(ERR);
     1467    20614    2          CASE( 62 );                  /* C_LIST */
     1468    20615    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1469    20616    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1470    20617    2             IF NOGO_BIT THEN RETURN;
     1471    20618    2             CALL DUA$LIST;
     1472    20619    2          CASE(70);                    /* MINI */
     1473    20620    2             IF D_XDELTA THEN CALL DXC$MINI;
     1474    20621    3             ELSE DO;
     1475    20622    3                  CALL DUD$MINI;
     1476    20623    3                  S_D.PROMPT_SIZE = 0;
     1477    20624    3                END;
     1478    20625    2          CASE( 29 );               /* MACTIVE */
     1479    20626    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( MACTIVE$CMD ) );
     1480    20627    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1481    20628    2             IF NOGO_BIT THEN RETURN;
     1482    20629    2             IF S_D.MLCT
     1483    20630    2             THEN CALL DFA$MLCT_ACTIVE ALTRET(ERR);
     1484    20631    2             ELSE CALL DDA$MACTIVE ALTRET(ERR);
     1485    20632    2          CASE( 56 );                 /* C_RANGE */
     1486    20633    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));
     1487    20634    2             CALL DDA$IF( NOGO_BIT ) ALTRET(ERR);
     1488    20635    2             IF NOGO_BIT THEN RETURN;
     1489    20636    2             S_D.RANGE = S_D.DO$->DOO.ID;
     1490    20637    2          CASE(28, 38);      /* MODIFY, MODIFYDW */
     1491    20638    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1492    20639    3             THEN DO;
     1493    20640    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1494    20641    4                  THEN DO;
     1495    20642    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1496    20643    4                       GOTO ERR;
     1497    20644    4                     END;
     1498    20645    3                END;
     1499    20646    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1500    20647    3                  THEN DO;
     1501    20648    3                       S_D.ERROR = 502;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:43   
     1502    20649    3                       CALL DDE$ERROR;
     1503    20650    3                       GOTO ERR1;
     1504    20651    3                     END;
     1505    20652    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(MODIFY$CMD));
     1506    20653    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1507    20654    2             IF NOGO_BIT THEN RETURN;
     1508    20655    2             CALL DDA$MOD  ALTRET(ERR);
     1509    20656    2          CASE(65);                    /* MLCT */
     1510    20657    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(LCT$CMD));
     1511    20658    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1512    20659    2             IF NOGO_BIT THEN RETURN;
     1513    20660    2             CALL DFA$MLCT ALTRET(ERR);
     1514    20661    2          CASE(91);                    /* NAME */
     1515    20662    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(NAME$CMD));
     1516    20663    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1517    20664    2             IF NOGO_BIT THEN RETURN;
     1518    20665    2             CALL DDA$NAME ALTRET(ERR);
     1519    20666    2          CASE(30);                      /* OA */
     1520    20667    2             S_D.ERROR = 502;         /* E@DELBUG */
     1521    20668    2             CALL DDE$ERROR;
     1522    20669    2          CASE(31);                      /* ON CALL */
     1523    20670    2             S_D.ERROR = 502;         /* E@DELBUG - SHOULDN'T GET HERE */
     1524    20671    2             CALL DDE$ERROR;
     1525    20672    2          CASE(32);                      /* OE */
     1526    20673    2             S_D.ERROR = 502;         /* E@DELUG */
     1527    20674    2             CALL DDE$ERROR;
     1528    20675    2          CASE(34);                     /* ONN */
     1529    20676    2             S_D.ERROR = 502;         /* E@DELBUG */
     1530    20677    2             CALL DDE$ERROR;
     1531    20678    2          CASE(36);                  /* OUTPUT */
     1532    20679    2             IF D_XDELTA
     1533    20680    3             THEN DO;
     1534    20681    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
     1535    20682    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1536    20683    3                  IF NOGO_BIT THEN RETURN;
     1537    20684    3                  CALL SETDCTX( OUT_DEV );
     1538    20685    3                  OUT_DEV_SAVE = OUT_DEV;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:44   
     1539    20686    3                END;
     1540    20687    3             ELSE DO;
     1541    20688    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(RUM$CMD));
     1542    20689    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1543    20690    3                  IF NOGO_BIT THEN RETURN;
     1544    20691    3                  CODE = S_D.DO$ -> RUM$CMD.CODE;
     1545    20692    3                  CALL DUA$OUTPUT( S_D.DO$ -> RUM$CMD.FID, CODE ); /* Ignore altret */
     1546    20693    3                END;
     1547    20694    2          CASE( 73 );                   /* C_PMD */
     1548    20695    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1549    20696    2             THEN GOTO NOTIMPFPRG;
     1550    20697    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1551    20698    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1552    20699    2             IF NOGO_BIT THEN RETURN;
     1553    20700    2             CALL DUA$PMD;
     1554    20701    2          CASE(25);                  /* C_PROMPT */
     1555    20702    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(PROMPT$CMD));
     1556    20703    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);
     1557    20704    2             IF NOGO_BIT THEN RETURN;
     1558    20705    2             S_D.UPROMPT = S_D.DO$ -> PROMPT$CMD.TEXTC.TEXT;
     1559    20706    2             S_D.UPROMPT_SIZE = S_D.DO$ -> PROMPT$CMD.TEXTC.SIZE;
     1560    20707    2             S_D.PROMPT_SIZE = 0;          /* Indicate prompt has been changed */
     1561    20708    2          CASE(88);                 /* PROTECT */
     1562    20709    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALL_ATTACH ) );
     1563    20710    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1564    20711    2             IF NOGO_BIT THEN RETURN;
     1565    20712    2             S_D.PROTECT = '1'B;
     1566    20713    2          CASE(24);                   /*C_PLUGH*/
     1567    20714    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1568    20715    3             THEN DO;
     1569    20716    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1570    20717    4                  THEN DO;
     1571    20718    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1572    20719    4                       GOTO ERR;
     1573    20720    4                     END;
     1574    20721    3                END;
     1575    20722    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:45   
     1576    20723    3                  THEN DO;
     1577    20724    3                       S_D.ERROR = 502;
     1578    20725    3                       CALL DDE$ERROR;
     1579    20726    3                       GOTO ERR1;
     1580    20727    3                     END;
     1581    20728    2             S_D.D$=PINCRW(S_D.DO$, SIZEW(DOO));
     1582    20729    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1583    20730    2             IF NOGO_BIT THEN RETURN;
     1584    20731    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1585    20732    2             THEN CALL DDA$PLUGH;
     1586    20733    2             ELSE CALL DFA$PLUGH;
     1587    20734    2          CASE(39);                    /* QUIT */
     1588    20735    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
     1589    20736    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1590    20737    2             IF NOGO_BIT THEN RETURN;
     1591    20738    2             IF D_XDELTA THEN CALL DXA$QUIT ALTRET(RECOVERY_IN_PROGRESS);
     1592    20739    3             ELSE DO;
     1593    20740    3                  IF S_D.RUM THEN CALL DUA$KILL_RUM; /* Close files */
     1594    20741    3                  IF S_D.ANLZ THEN CALL DUA$KILL_ANLZ; /* Close files */
     1595    20742    3                  IF S_D.DO$ -> QUIT$CMD.FPRG
     1596    20743    4                  THEN DO;
     1597    20744    4                       IF S_D.FPRG_CONTEXT$ = ADDR(NIL)
     1598    20745    5                       THEN DO;
     1599    20746    5                            S_D.ERROR = 278; /* E@NOFPRG */
     1600    20747    5                            GOTO ERR;
     1601    20748    5                          END;
     1602    20749    4                       TFPRG$ = S_D.FPRG_CONTEXT$;
     1603    20750    5                       DO WHILE (SUBSTR(TFPRG$->FPRG$CONTEXT.RES, 0, TFPRG$->
             20750                                FPRG$CONTEXT.RES_SIZE) ~=
     1604    20751    5                         S_D.DO$ -> QUIT$CMD.FPRG_RES);
     1605    20752    5                            TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     1606    20753    5                            IF TFPRG$ = ADDR(NIL)
     1607    20754    6                            THEN DO;
     1608    20755    6                                 S_D.ERROR = 278; /* E@NOFPRG */
     1609    20756    6                                 GOTO ERR;
     1610    20757    6                               END;
     1611    20758    5                          END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:46   
     1612    20759    4                       IF TFPRG$ -> FPRG$CONTEXT.STATE = %RUNNING
     1613    20760    5                       THEN DO;
     1614    20761    5                            S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB# = TFPRG$ -> FPRG$CONTEXT.
             20761                                     DCBNO;
     1615    20762    5                            S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# = '1'B;
     1616    20763    5                            CALL M$DRTN (S_D.DRTN$ -> FPT$DRTN) ALTRET(ERRMSG);
     1617    20764    5                            S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB# = 0;
     1618    20765    5                            S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# = '0'B;
     1619    20766    5                            CALL DFQ$READ_FD (TFPRG$, '0'B) ALTRET(ERRMSG);
     1620    20767    5                          END;
     1621    20768    4                       CALL DFA$QUIT (TFPRG$)
     1622    20769    5                       WHENALTRETURN DO;
     1623    20770    5                            IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$LDSC
     1624    20771    5                            THEN GOTO ERRMSG;
     1625    20772    5                          END;
     1626    20773    4                       S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;
     1627    20774    4                       TFPRG$->FPRG$CONTEXT.FANLZ = '1'B; /* Suppress KDEL msg */
     1628    20775    4                       CALL DFA$KILL_DELTA;
     1629    20776    4                     END;
     1630    20777    4                  ELSE DO;
     1631    20778    4                       IF S_D.FPRG_CONTEXT$ ~= ADDR(NIL)
     1632    20779    5                       THEN DO;
     1633    20780    5                            CALL DFA$STOP_FPRGS('1'B)
     1634    20781    6                            WHENALTRETURN DO;
     1635    20782    6                                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$LDSC
     1636    20783    6                                 THEN GOTO NOGO;
     1637    20784    6                               END;
     1638    20785    6                            DO WHILE (S_D.FPRG_CONTEXT$ ~= ADDR(NIL));
     1639    20786    6                                 S_D.CURRENT_FPRG_CONTEXT$ = S_D.FPRG_CONTEXT$;
     1640    20787    6                                 CALL DFA$QUIT (S_D.FPRG_CONTEXT$);
     1641    20788    6   /* Suppress KDEL msg */       S_D.FPRG_CONTEXT$->FPRG$CONTEXT.FANLZ = '1'B;
     1642    20789    6                                 CALL DFA$KILL_DELTA;
     1643    20790    6                               END;
     1644    20791    5                          END;
     1645    20792    4                       CALL DUA$EXITDELTA; /* EXIT NOW, DON'T CALL DDA$GO */
     1646    20793    4                     END;
     1647    20794    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:47   
     1648    20795    2          CASE( 72 );                   /* C_RUM */
     1649    20796    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( RUM$CMD ) );
     1650    20797    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1651    20798    2             IF NOGO_BIT THEN RETURN;
     1652    20799    2             CALL DUA$RUM;
     1653    20800    2          CASE(42);                    /* READ */
     1654    20801    2             IF D_XDELTA
     1655    20802    3             THEN DO;
     1656    20803    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
     1657    20804    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1658    20805    3                  IF NOGO_BIT THEN RETURN;
     1659    20806    3                  CALL SETDCTX( IN_DEV );
     1660    20807    3                  IF IN_DEV = DCTX_ME
     1661    20808    3                  THEN OUT_DEV = OUT_DEV_SAVE;
     1662    20809    4                  ELSE DO;
     1663    20810    4                       OUT_DEV_SAVE = OUT_DEV;
     1664    20811    4                       OUT_DEV = ECHO_DEV;
     1665    20812    4                     END;
     1666    20813    3                END;
     1667    20814    3             ELSE DO;
     1668    20815    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(RUM$CMD));
     1669    20816    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1670    20817    3                  IF NOGO_BIT THEN RETURN;
     1671    20818    3                  CALL DUA$READ( S_D.DO$ -> RUM$CMD ); /* Ignore altret */
     1672    20819    3                END;
     1673    20820    2          CASE( 55 );                /* C_REPORT */
     1674    20821    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( REPORT$CMD ) );
     1675    20822    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1676    20823    2             IF NOGO_BIT THEN RETURN;
     1677    20824    2             IF S_D.DO$ -> REPORT$CMD.COMPILER_SPF
     1678    20825    3             THEN DO;
     1679    20826    3                  LOWX = S_D.DO$ -> REPORT$CMD.COMPILER - 550; /* C@COMPILER_FIRST */
     1680    20827    3                  HIGX = LOWX;
     1681    20828    3                END;
     1682    20829    3             ELSE DO;
     1683    20830    3                  LOWX = 0;
     1684    20831    3                  HIGX = %(563 - 550); /* C@COMPILER_LAST, C@COMPILER_FIRST */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:48   
     1685    20832    3                END;
     1686    20833    3             DO I = LOWX TO HIGX;
     1687    20834    3                  IF S_D.DO$ -> REPORT$CMD.DEFAULT
     1688    20835    4                  THEN DO;
     1689    20836    4                       S_D.REPORT_FLAGS.OFFSET( I ) = DD_REPORT_FLAGS.OFFSET( I );
     1690    20837    4                       S_D.REPORT_FLAGS.LINE( I ) = DD_REPORT_FLAGS.LINE( I );
     1691    20838    4                       S_D.REPORT_FLAGS.TYPE( I ) = DD_REPORT_FLAGS.TYPE( I );
     1692    20839    4                     END;
     1693    20840    4                  ELSE DO;
     1694    20841    4                       S_D.REPORT_FLAGS.OFFSET( I ) = S_D.DO$ -> REPORT$CMD.OFFSET;
     1695    20842    4                       S_D.REPORT_FLAGS.LINE( I ) = S_D.DO$ -> REPORT$CMD.LINE;
     1696    20843    4                       S_D.REPORT_FLAGS.TYPE( I ) = S_D.DO$ -> REPORT$CMD.TYPE;
     1697    20844    4                     END;
     1698    20845    3                END;
     1699    20846    2          CASE(43);                  /* SCHEMA */
     1700    20847    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SCHEMA$CMD));
     1701    20848    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1702    20849    2             IF NOGO_BIT THEN RETURN;
     1703    20850    2             S_D.SCHEMA = '1'B;
     1704    20851    2             IF S_D.DO$ -> SCHEMA$CMD.GOTFID
     1705    20852    3             THEN DO;
     1706    20853    3                  FPTOPEN = FPT_OPEN;
     1707    20854    3                  IF S_D.RUM
     1708    20855    4                  THEN DO;
     1709    20856    4                       S_D.ERROR = 212; /* E_BADCMD_RUM */
     1710    20857    4                       GOTO ERR;
     1711    20858    4                     END;
     1712    20859    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);
     1713    20860    3                  FPTOPEN.SN_ = VECTOR(VLP_SN);
     1714    20861    3                  FPTOPEN.NAME_ = VECTOR(VLP_NAME);
     1715    20862    3                  FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);
     1716    20863    3                  FPTOPEN.PASS_ = VECTOR(VLP_PASS);
     1717    20864    3                  FPTOPEN.WSN_ = VECTOR(VLP_WSN);
     1718    20865    3                  FPTFID = FPT_FID;
     1719    20866    3                  FPTFID.V_ = VECTOR(FPTFID.V);
     1720    20867    3                  FPTFID.NAME_ = VECTOR(VLP_NAME);
     1721    20868    3                  FPTFID.ACCT_ = VECTOR(VLP_ACCT);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:49   
     1722    20869    3                  FPTFID.PASS_ = VECTOR(VLP_PASS);
     1723    20870    3                  FPTFID.SN_ = VECTOR(VLP_SN);
     1724    20871    3                  FPTFID.WSN_ = VECTOR(VLP_WSN);
     1725    20872    3                  FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);
     1726    20873    3                  FPTFID.RESULTS_ = VECTOR(VLR_FID);
     1727    20874    3                  FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->SCHEMA$CMD.FID.TEXT,
     1728    20875    3                    0, S_D.DO$->SCHEMA$CMD.FID.SIZE));
     1729    20876    3                  CALL M$FID (FPTFID) ALTRET(ERRMSG);
     1730    20877    3                  IF NOT VLR_FID.ACCT
     1731    20878    3                  THEN VLP_ACCT.ACCT# = ' ';
     1732    20879    3                  IF S_D.SCHEMADCB = 0
     1733    20880    4                  THEN DO;
     1734    20881    4                       FPTGETDCB = FPT_GETDCB;
     1735    20882    4                       FPTGETDCB.V_ = VECTOR(FPTGETDCB.V);
     1736    20883    4                       FPTGETDCB.DCBNUM_ = VECTOR(S_D.LMDCB);
     1737    20884    4                       CALL M$GETDCB (FPTGETDCB) ALTRET(ERRMSG);
     1738    20885    4                       S_D.SCHEMADCB = S_D.LMDCB;
     1739    20886    4                     END;
     1740    20887    4                  ELSE DO;
     1741    20888    4                       IF DCBADDR(S_D.SCHEMADCB) -> F$DCB.FCD#
     1742    20889    5                       THEN DO;
     1743    20890    5                            FPT$CLOSE = FPT_CLOSE;
     1744    20891    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);
     1745    20892    5                            FPT$CLOSE.V.DCB# = S_D.SCHEMADCB;
     1746    20893    5                            CALL M$CLOSE (FPT$CLOSE) ALTRET(ERRMSG);
     1747    20894    5                          END;
     1748    20895    4                       S_D.LMDCB = S_D.SCHEMADCB;
     1749    20896    4                     END;
     1750    20897    3                  FPTOPEN.V.DCB# = S_D.LMDCB;
     1751    20898    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);
     1752    20899    3                  IF SUBSTR(DCBADDR(S_D.LMDCB) -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'
     1753    20900    3                  THEN S_D.RUM_FEP = '1'B;
     1754    20901    3                  ELSE S_D.RUM_FEP = '0'B;
     1755    20902    3                END;
     1756    20903    2   SCHEMA:   IF S_D.DO$ -> SCHEMA$CMD.GOTPOS
     1757    20904    2             THEN I = S_D.DO$ -> SCHEMA$CMD.POSITION;
     1758    20905    3             ELSE DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:50   
     1759    20906    3                  I = S_D.SAVEIC;
     1760    20907    3                  IF NOT S_D.DO$ -> SCHEMA$CMD.GOTFID
     1761    20908    3                  THEN GOTO SCHEMA1;
     1762    20909    3                  TOBREL = POFFW( S_D.SCHSEG$, S_D.SCHSEG_BEGIN$ );
     1763    20910    3                  IF TOBREL > 0
     1764    20911    3                  THEN CALL DDM$PUTMEM( S_D_SEG$, TOBREL ) ALTRET( NORELS_D );
     1765    20912    3                  S_D.SCHSEG$ = S_D.SCHSEG_BEGIN$;
     1766    20913    3                  IF S_D.SCHEMADCB ~= 0
     1767    20914    3                  THEN S_D.LMDCB = S_D.SCHEMADCB;
     1768    20915    3                  ELSE IF S_D.RUM
     1769    20916    3                       THEN S_D.LMDCB = S_D.RUMDCB;
     1770    20917    3                       ELSE S_D.LMDCB = D_M$LM#;
     1771    20918    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1772    20919    4                  THEN DO;
     1773    20920    4                       CALL DUI$INIT_HOST;
     1774    20921    4                     END;
     1775    20922    4                  ELSE DO;
     1776    20923    4                       IF NOT S_D.RUM
     1777    20924    5                       THEN DO;
     1778    20925    5                            CALL DFA$SETUP_FPRG;
     1779    20926    5                          END;
     1780    20927    4                       CALL DUI$INIT_L6;
     1781    20928    4                     END;
     1782    20929    3                  CALL DUI$RU_ACCESS
     1783    20930    4                  WHENALTRETURN DO;
     1784    20931    4                       CALL DDE$ERROR;
     1785    20932    4                       GOTO NOGO;
     1786    20933    4                     END;
     1787    20934    3                END;
     1788    20935    2   SCHEMA1:
     1789    20936    2             CALL DDS$ES_INQ( I );         /* Ignore altret */
     1790    20937    2             CALL DDS$SET_Q2C;
     1791    20938    2             CALL DDS$SET_C2D;
     1792    20939    2          CASE(66);                 /* SELCHAN */
     1793    20940    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SHOW$CMD));
     1794    20941    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1795    20942    2             IF NOGO_BIT THEN RETURN;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:51   
     1796    20943    2             S_D.CURRENT_CHANNEL = S_D.DO$ -> LCT$CMD.CHAN#;
     1797    20944    2          CASE(44);                    /* SHOW */
     1798    20945    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SHOW$CMD));
     1799    20946    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1800    20947    2             IF NOGO_BIT THEN RETURN;
     1801    20948    2             CALL DDA$SHOW;
     1802    20949    2          CASE(85);                  /* STATUS */
     1803    20950    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(ALL_ATTACH));
     1804    20951    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1805    20952    2             IF NOGO_BIT THEN RETURN;
     1806    20953    2             S_D.STATUS = '1'B;
     1807    20954    2          CASE(57);                    /* STEP */
     1808    20955    2             IF S_D.ALIB THEN
     1809    20956    2                  IF NOT (B$JIT.JUNK & %JJ_UDELTA#)
     1810    20957    3                  THEN DO;
     1811    20958    3                       S_D.ERROR = 218; /*E@CANTSTEPALIB*/
     1812    20959    3                       GOTO ERR;
     1813    20960    3                     END;
     1814    20961    2                  ELSE IF B$TCB$->B$TCB.STK$->B$ALIBF.WHO ~= %SC_AUSR#
     1815    20962    3                       THEN DO;
     1816    20963    3                            S_D.ERROR = 222; /* E@CANTSTEPSHARED */
     1817    20964    3                            GOTO ERR;
     1818    20965    3                          END;
     1819    20966    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1820    20967    3             THEN DO;
     1821    20968    3                  CALL DDA$STEP ALTRET(ERR);
     1822    20969    3                  CALL DDA$RESET_PATCH_SPACE;
     1823    20970    3                  ALTRETURN;
     1824    20971    3                END;
     1825    20972    2             ELSE IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.STATE = %STOPPED
     1826    20973    2                  THEN CALL DFA$STEP ALTRET(RECOVERY_IN_PROGRESS);
     1827    20974    3                  ELSE DO;
     1828    20975    3                       S_D.ERROR = 344; /* E@FPRGRUNNING */
     1829    20976    3                       GOTO ERR;
     1830    20977    3                     END;
     1831    20978    2          CASE( 83 );                  /* C_STOP */
     1832    20979    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:52   
     1833    20980    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1834    20981    2             IF NOGO_BIT THEN RETURN;
     1835    20982    2             IF S_D.DO$->STOP$CMD.FPRG
     1836    20983    3             THEN DO;
     1837    20984    3                  TFPRG$ = S_D.FPRG_CONTEXT$;
     1838    20985    3                  PTFPRG$ = TFPRG$;
     1839    20986    4                  DO WHILE (SUBSTR(TFPRG$->FPRG$CONTEXT.RES, 0, TFPRG$->FPRG$CONTEXT.
             20986                           RES_SIZE) ~=
     1840    20987    4                    S_D.DO$ -> STOP$CMD.FPRG_RES);
     1841    20988    4                       PTFPRG$ = TFPRG$;
     1842    20989    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     1843    20990    4                       IF TFPRG$ = ADDR(NIL)
     1844    20991    5                       THEN DO;
     1845    20992    5                            S_D.ERROR = 278; /* E@NOFPRG */
     1846    20993    5                            GOTO ERR;
     1847    20994    5                          END;
     1848    20995    4                     END;
     1849    20996    3                  CALL DFA$STOP_FPRGS (,TFPRG$);
     1850    20997    3                END;
     1851    20998    2             ELSE
     1852    20999    2                  CALL DFA$STOP_FPRGS;
     1853    21000    2          CASE(18);                   /* STORE */
     1854    21001    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1855    21002    2             THEN GOTO NOTIMPFPRG;
     1856    21003    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1857    21004    3             THEN DO;
     1858    21005    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE
     1859    21006    4                  THEN DO;
     1860    21007    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */
     1861    21008    4                       GOTO ERR;
     1862    21009    4                     END;
     1863    21010    3                END;
     1864    21011    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)
     1865    21012    3                  THEN DO;
     1866    21013    3                       S_D.ERROR = 502;
     1867    21014    3                       CALL DDE$ERROR;
     1868    21015    3                       GOTO ERR1;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:53   
     1869    21016    3                     END;
     1870    21017    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(FIND$CMD));
     1871    21018    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);
     1872    21019    2             IF NOGO_BIT THEN RETURN;
     1873    21020    2             CALL DDA$STORE ALTRET(ERR);
     1874    21021    2          CASE(45);                    /* C_SAVE */
     1875    21022    2             S_D.ERROR = 502;         /* E@DELBUG */
     1876    21023    2             CALL DDE$ERROR;
     1877    21024    2          CASE(77);                     /* SAD */
     1878    21025    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1879    21026    2             THEN GOTO NOTIMPFPRG;
     1880    21027    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1881    21028    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1882    21029    2             IF NOGO_BIT THEN RETURN;
     1883    21030    2             FPT$SAD = FPT_SAD;
     1884    21031    2             FPT$SAD.V_ = VECTOR(FPT$SAD.V);
     1885    21032    2             PTR_SAD_SKEL = SAD$;          /* get SEGID from $SAD */
     1886    21033    2             FPT$SAD.V.USERSID# = PTR_SAD.PT;
     1887    21034    2             PTR_SAD.PT.LS = S_D.DO$->DOO.ID;
     1888    21035    2             FPT$SAD.V.MONSID# = PTR_SAD.PT;
     1889    21036    2             CALL M$SAD (FPT$SAD) ALTRET(SAD_OOPS);
     1890    21037    2             S_D.SAD = S_D.DO$ -> DOO.ID;
     1891    21038    2          CASE(79);                  /* SYNTAX */
     1892    21039    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1893    21040    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1894    21041    2             IF NOGO_BIT THEN RETURN;
     1895    21042    2             IF S_D.DO$ -> DOO.ID = 0
     1896    21043    2             THEN S_D.SYNTAX = S_D.SYNTAX_DEFAULT;
     1897    21044    2             ELSE S_D.SYNTAX = S_D.DO$ -> DOO.ID - 550; /* C@COMPILER_FIRST */
     1898    21045    2             TEMP$ = DD_COMPNODE$( S_D.SYNTAX );
     1899    21046    3             DO I=0 TO SIZEW(DD$COMP_NODE_PTR$)-1;
     1900    21047    3                  DD_COMP_NODE_PTR$(I) -> DD_NODE.SUBNDS$(0) = TEMP$ ->
             21047                           DD$COMP_NODE_PTR$(I);
     1901    21048    3                END;
     1902    21049    2          CASE(61);                   /*C_TBOOT*/
     1903    21050    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));
     1904    21051    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:54   
     1905    21052    2             IF NOGO_BIT THEN RETURN;
     1906    21053    2             CALL DXA$TBOOT;
     1907    21054    2          CASE(26);                       /* TRACE (CALLS,OFF,TRANSFER) */
     1908    21055    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(TR$CMD));
     1909    21056    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1910    21057    2             IF NOGO_BIT THEN RETURN;
     1911    21058    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
     1912    21059    2             THEN CALL DDA$TRACE;
     1913    21060    2             ELSE CALL DFA$TRACE;
     1914    21061    2          CASE(84);                     /* FORMAT TSA */
     1915    21062    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     1916    21063    2             IF NOGO_BIT THEN RETURN;
     1917    21064    2             CALL DFA$TSA ALTRET (ERR);
     1918    21065    2          CASE(87);                   /* C_UNFID */
     1919    21066    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ));
     1920    21067    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1921    21068    3             THEN DO;
     1922    21069    3                  CALL DFA$UNFID ALTRET(ERR);
     1923    21070    3                END;
     1924    21071    3             ELSE DO;
     1925    21072    3                  CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     1926    21073    3                  IF NOGO_BIT THEN RETURN;
     1927    21074    4                  IF S_D.DO$->UNFID$CMD.K13 THEN DO;
     1928    21075    4                       LOWX = S_D.DO$->UNFID$CMD.ID_FROM;
     1929    21076    4                       HIGX = S_D.DO$->UNFID$CMD.ID_TO;
     1930    21077    4                       OPEN = S_D.DO$->UNFID$CMD.OPEN;
     1931    21078    4                       CLOSED = S_D.DO$->UNFID$CMD.CLOSED;
     1932    21079    5                       DO DCB# = LOWX TO HIGX;
     1933    21080    6                            IF LOWX = HIGX THEN DO;
     1934    21081    7                                 IF DCB# > B$ROS$->B$ROSEG.NUMDCBS THEN DO;
     1935    21082    7                                      S_D.ERROR = 183;
     1936    21083    7                                      GOTO ERR;
     1937    21084    7                                    END;
     1938    21085    7                                 IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#) = ADDR(NIL)
             21085                                          THEN DO;
     1939    21086    7                                      S_D.ERROR = 184;
     1940    21087    7                                      GOTO ERR;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:55   
     1941    21088    7                                    END;
     1942    21089    6                               END;
     1943    21090    5                            IF DCB# <= B$ROS$->B$ROSEG.NUMDCBS
     1944    21091    5                            THEN IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#) ~= ADDR(NIL
             21091                                     )
     1945    21092    5                                 THEN CALL DUA$UNFID(DCB#, OPEN, CLOSED) ALTRET(ERR);
     1946    21093    5                          END;
     1947    21094    4                     END;
     1948    21095    4                  ELSE DO;
     1949    21096    4                       HIGX = B$ROS$->B$ROSEG.NUMDCBS;
     1950    21097    5                       DO DCB# = 0 TO HIGX;
     1951    21098    5                            IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#) ~= ADDR(NIL)
             21098                                     THEN
     1952    21099    5                                 IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#)->F$DCB.
             21099                                          DCBNAME.N =
     1953    21100    5                                   SUBSTR(S_D.DO$->UNFID$CMD.DCBN.C,0,S_D.DO$->
             21100                                            UNFID$CMD.DCBN.L) THEN EXIT;
     1954    21101    5                          END;
     1955    21102    5                       IF DCB# > HIGX THEN DO;
     1956    21103    5                            S_D.ERROR = 183;
     1957    21104    5                            GOTO ERR;
     1958    21105    5                          END;
     1959    21106    4                       CALL DUA$UNFID (DCB#) ALTRET (ERR);
     1960    21107    4                     END;
     1961    21108    3                END;
     1962    21109    2          CASE(90);                 /* C_UNSHARE */
     1963    21110    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );
     1964    21111    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     1965    21112    3             THEN DO;
     1966    21113    3                  GD$MSG = '0'B;
     1967    21114    3                  IF S_D.DO$ -> UNSHARE$CMD.PROGRAM AND
     1968    21115    3                    S_D.DO$ -> UNSHARE$CMD.LIBRARY
     1969    21116    3                  THEN GD$MSG.FNC = %GD#RQSUNSHAREALL;
     1970    21117    3                  ELSE IF S_D.DO$ -> UNSHARE$CMD.PROGRAM
     1971    21118    3                       THEN GD$MSG.FNC = %GD#RQSUNSHAREPROG;
     1972    21119    3                       ELSE IF S_D.DO$ -> UNSHARE$CMD.LIBRARY
     1973    21120    3                            THEN GD$MSG.FNC = %GD#RQSUNSHARELIB;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:56   
     1974    21121    3                  CALL DFQ$WRITE_FD(S_D.CURRENT_FPRG_CONTEXT$)
     1975    21122    4                  WHENALTRETURN DO;
     1976    21123    4                       CALL DUE$ERRMSG;
     1977    21124    4                     END;
     1978    21125    3                  CALL DFQ$READ_FD(S_D.CURRENT_FPRG_CONTEXT$, '0'B)
     1979    21126    4                  WHENALTRETURN DO;
     1980    21127    4                       CALL DUE$ERRMSG;
     1981    21128    4                     END;
     1982    21129    3                  IF GD$MSG.FNC ~= %GD#RSPACK
     1983    21130    4                  THEN DO;
     1984    21131    4                       IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA
     1985    21132    5                       THEN DO;
     1986    21133    5                            TEMP1 = BITBIN(GD$MSG.ERROR_D.ERRCODE);
     1987    21134    5                            TEMP2B.B1 = TEMP1B.B1;
     1988    21135    5                            TEMP2B.B2 = TEMP1B.B2;
     1989    21136    5                            TEMP2B.B3 = TEMP1B.B3;
     1990    21137    5                            TEMP2B.B4 = TEMP1B.B4;
     1991    21138    5                            S_D.JDE = TEMP2;
     1992    21139    5                          END;
     1993    21140    4                       ELSE S_D.JDE = BITBIN(GD$MSG_HOST.ERROR_D.ERRCODE);
     1994    21141    4                       CALL DUE$GERRMSG;
     1995    21142    4                     END;
     1996    21143    3                  IF S_D.DO$ -> UNSHARE$CMD.LIBRARY
     1997    21144    3                  THEN S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.SHARED = '0'B;
     1998    21145    3                  RETURN;
     1999    21146    3                END;
     2000    21147    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     2001    21148    2             IF NOGO_BIT THEN RETURN;
     2002    21149    2             FPT$UNSHARE = FPT_UNSHARE;
     2003    21150    2             FPT$UNSHARE.V_ = VECTOR( FPT$UNSHARE.V );
     2004    21151    2             IF S_D.DO$ -> UNSHARE$CMD.PROGRAM
     2005    21152    3             THEN DO;
     2006    21153    3                  FPT$UNSHARE.V.FLGS.PROG# = '1'B;
     2007    21154    3                  CALL M$UNSHARE( FPT$UNSHARE ) ALTRET( UNSHPROG );
     2008    21155    4                  DO WHILE ( '0'B );
     2009    21156    4   UNSHPROG:           CALL DUE$ERRMSG;
     2010    21157    4                     END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:57   
     2011    21158    3                END;
     2012    21159    2             FPT$UNSHARE.V.FLGS.PROG# = '0'B;
     2013    21160    2             IF S_D.DO$ -> UNSHARE$CMD.LIBRARY
     2014    21161    3             THEN DO;
     2015    21162    3                  FPT$UNSHARE.V.FLGS.LIB# = '1'B;
     2016    21163    3                  CALL M$UNSHARE( FPT$UNSHARE ) ALTRET( UNSHLIB );
     2017    21164    4                  DO WHILE ( '0'B );
     2018    21165    4   UNSHLIB:            CALL DUE$ERRMSG;
     2019    21166    4                     END;
     2020    21167    3                END;
     2021    21168    2          CASE ( 75 );               /* C_UPDATE */
     2022    21169    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(ACTIVE$CMD));
     2023    21170    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     2024    21171    2             IF NOGO_BIT THEN RETURN;
     2025    21172    2             CALL DDA$UPDATE ALTRET(ERR);
     2026    21173    2          CASE(64);                     /* USE */
     2027    21174    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( USE$CMD ) );
     2028    21175    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );
     2029    21176    2             IF NOGO_BIT THEN RETURN;
     2030    21177    2             TYPE = S_D.DO$ -> USE$CMD.TYPE;
     2031    21178    2             IF D_XDELTA
     2032    21179    3             THEN DO;
     2033    21180    3                  CALL DXA$USE;
     2034    21181    3                END;
     2035    21182    2             ELSE IF S_D.FPRG AND
     2036    21183    2                    (S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA OR
     2037    21184    2                    S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.FANLZ) AND
     2038    21185    2                    TYPE ~= 9    /* USE_SECTION */
     2039    21186    3                  THEN DO;
     2040    21187    3                       CALL DFA$USE;
     2041    21188    3                     END;
     2042    21189    2                  ELSE IF TYPE = 6 /* USE_NODE */ AND
     2043    21190    2                         NOT S_D.FPRG
     2044    21191    3                       THEN DO;
     2045    21192    3                            S_D.NODE = S_D.DO$ -> USE$CMD.NODE;
     2046    21193    3                            CALL DDS$EUTREE;
     2047    21194    3                            S_D.TREE$ = S_D.UTREE$;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:58   
     2048    21195    3                            S_D.UNODE.USENODE = S_D.NODE;
     2049    21196    3                            I = S_D.B$TREE$ -> B$NODE.PADDR( S_D.NODE );
     2050    21197    3                            CALL DDS$ES_INQ (I); /* ignore altret */
     2051    21198    3                            CALL DDS$SET_Q2C;
     2052    21199    3                          END;
     2053    21200    2                       ELSE IF S_D.ANLZ_FILE
     2054    21201    3                            THEN DO;
     2055    21202    3                                 LS# = S_D.DO$->USE$CMD.LS;
     2056    21203    3                                 USR# = S_D.DO$->USE$CMD.USERNO;
     2057    21204    3                                 CPU# = DA.CURCPU;
     2058    21205    3                                 IF TYPE = 4 AND USR# = 0 THEN USR# = DA.CURUSR;
     2059    21206    3                                 IF TYPE = 5 OR TYPE = 0
     2060    21207    3                                 THEN IF TYPE = 0 AND S_D.DO$->USE$CMD.SUBTYPE = 7
     2061    21208    4                                      THEN DO;
     2062    21209    4                                           CPU# = S_D.DO$->USE$CMD.PTA;
     2063    21210    4                                           CALL DUL$USE (TYPE, DA.CURUSR, CPU#, 0)
             21210                                                    ALTRET(ERR);
     2064    21211    4                                         END;
     2065    21212    3                                      ELSE CALL DUL$USE (0, DA.CURUSR, DA.CURCPU, 0)
             21212                                               ALTRET(ERR);
     2066    21213    3                                 ELSE CALL DUL$USE (TYPE, USR#, DA.CURCPU, LS#) ALTRET(
             21213                                          ERR);
     2067    21214    3                               END;        /* IF ANLZ_FILE */
     2068    21215    2                            ELSE IF S_D.ANLZ
     2069    21216    3                                 THEN DO;
     2070    21217    3                                      S_D.ERROR = 503; /*E@NOTIMP*/
     2071    21218    3                                      GOTO ERR;
     2072    21219    3                                    END;
     2073    21220    2                                 ELSE      /* USE FOR USER DELTA */
     2074    21221    2                                      IF S_D.DO$ -> USE$CMD.HOST
     2075    21222    3                                      THEN DO;
     2076    21223    3                                           IF NOT S_D.DEBUG_CMD
     2077    21224    4                                           THEN DO;
     2078    21225    4                                                CALL DFA$KILL_FPRG;
     2079    21226    4                                                CALL DDR$REPORT(28/*R_STOP*/);
     2080    21227    4                                              END;
     2081    21228    3                                         END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:59   
     2082    21229    2                                      ELSE IF S_D.DO$ -> USE$CMD.FPRG
     2083    21230    3                                           THEN DO;
     2084    21231    3                                                RES = S_D.DO$ -> USE$CMD.FPRG_RES;
     2085    21232    3                                                IF S_D.FPRG_CONTEXT$ = ADDR(NIL)
     2086    21233    4                                                THEN DO;
     2087    21234    4                                                     S_D.ERROR = 319; /* E@NOFPRGUSE */
     2088    21235    4                                                     GOTO ERR;
     2089    21236    4                                                   END;
     2090    21237    3                                                TFPRG$ = S_D.FPRG_CONTEXT$;
     2091    21238    4                                                DO WHILE (TFPRG$ -> FPRG$CONTEXT.RES ~=
             21238                                                         RES);
     2092    21239    4                                                     TFPRG$ = TFPRG$ -> FPRG$CONTEXT.
             21239                                                              NEXT$;
     2093    21240    4                                                     IF TFPRG$ = ADDR(NIL)
     2094    21241    5                                                     THEN DO;
     2095    21242    5                                                          S_D.ERROR = 278;
             21242                                                                   /* E@NOFPRG */
     2096    21243    5                                                          GOTO ERR;
     2097    21244    5                                                        END;
     2098    21245    4                                                   END;
     2099    21246    3                                                S_D.CURRENT_FPRG_CONTEXT$ =TFPRG$;
     2100    21247    3                                                IF TFPRG$ -> FPRG$CONTEXT.READ_FD =
             21247                                                         '1'B
     2101    21248    3                                                THEN GOTO DO_READ;
     2102    21249    3                                                IF TFPRG$ -> FPRG$CONTEXT.STATE ~= %
             21249                                                         STOPPED AND
     2103    21250    3                                                  TFPRG$ -> FPRG$CONTEXT.STATE ~= %
             21250                                                           ATEXIT
     2104    21251    4                                                THEN DO;
     2105    21252    4                                                     S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# =
             21252                                                              '1'B;
     2106    21253    4                                                     S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB#
             21253                                                              = TFPRG$ -> FPRG$CONTEXT.DCBNO
             21253                                                              ;
     2107    21254    4                                                     CALL M$DRTN (S_D.DRTN$ -> FPT$DRTN
             21254                                                              ) ALTRET(ERR);
     2108    21255    4                                                     TFPRG$ -> FPRG$CONTEXT.STATE = %
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:60   
             21255                                                              STOPPED;
     2109    21256    4   DO_READ:
     2110    21257    4                                                     S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# =
             21257                                                              '0'B;
     2111    21258    4                                                     S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB#
             21258                                                              = 0;
     2112    21259    4                                                     S_D.DRTN$ -> FPT$DRTN.FPRG_FID_ =
             21259                                                              VECTOR(NIL);
     2113    21260    4                                                     IF TFPRG$ -> FPRG$CONTEXT.READ_FD
             21260                                                              = '1'B
     2114    21261    4                                                     THEN TFPRG$ -> FPRG$CONTEXT.
             21261                                                              READ_FD = '0'B;
     2115    21262    4                                                     CALL DFQ$READ_FD(TFPRG$, '0'B)
             21262                                                              ALTRET(ERR);
     2116    21263    4                                                     IF GD$MSG.FNC ~= %FPRG_BRKRSP# AND
     2117    21264    4                                                       GD$MSG.BRKRSP.BRK# ~= (%
             21264                                                                G_HOST_INT# + (%GD#MAXBRKNUM
             21264                                                                + 1))
     2118    21265    5                                                     THEN DO;
     2119    21266    5                                                          IF TFPRG$ -> FPRG$CONTEXT.
             21266                                                                   XDELTA AND
     2120    21267    5                                                            GD$MSG.FNC = %GD#RSPBADMSG
     2121    21268    6                                                          THEN DO;
     2122    21269    6                                                               S_D.ERROR = 330;
             21269                                                                        /* E@BADMSG */
     2123    21270    6                                                               GOTO ERR;
     2124    21271    6                                                             END;
     2125    21272    5                                                          REMEMBER NEVER IN S_D.
             21272                                                                   SCREECH_IC;
     2126    21273    5                                                          CALL M$SCREECH (SNAP_MESSAGE)
             21273                                                                   ALTRET(NEVER);
     2127    21274    5   NEVER:                                                 ;
     2128    21275    5                                                        END;
     2129    21276    4                                                     FPRG_IC = GD$MSG.BRKRSP.ADR$;
     2130    21277    4                                                     S_D.FAULT = GD$MSG.BRKRSP.BRK# - (
             21277                                                              %GD#MAXBRKNUM + 1);
     2131    21278    4                                                     TFPRG$ -> FPRG$CONTEXT.ADDRESS =
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:61   
             21278                                                              FPRG_IC;
     2132    21279    4                                                   END;
     2133    21280    3                                                CALL DDA$RESET_PATCH_SPACE;
     2134    21281    3                                                CALL DFA$FPRG(TFPRG$ -> FPRG$CONTEXT.
             21281                                                         ADDRESS);
     2135    21282    3                                                CALL DFR$REPORT(%R_FPRG_STOP);
     2136    21283    3                                              END;
     2137    21284    2                                           ELSE IF TYPE = 9 /* USE_SECTION */
     2138    21285    3                                                THEN DO;
     2139    21286    3                                                     CALL RESTORE_USE;
     2140    21287    3                                                     S_D.RUM_FEP_USE = S_D.DO$ ->
             21287                                                              USE$CMD.SECTION;
     2141    21288    3                                                     IF S_D.DO$ -> USE$CMD.SECTION = 0
     2142    21289    3                                                     THEN GOTO MONIS;
     2143    21290    4                                                     DO CASE(S_D.DO$ -> USE$CMD.SECTION
             21290                                                              );
     2144    21291    4                                                       CASE(630); /* C@MONENT */
     2145    21292    4                                                          S_D.GOT@ = S_D.MONENT.GOT@;
     2146    21293    4                                                          S_D.DEFINED@ = S_D.MONENT.
             21293                                                                   DEFINED@;
     2147    21294    4                                                          S_D.NEXT@ = S_D.MONENT.NEXT@;
     2148    21295    4                                                          S_D.RSPACE@ = S_D.MONENT.
             21295                                                                   RSPACE@;
     2149    21296    4                                                          S_D.HEAD@ = S_D.MONENT.HEAD@;
     2150    21297    4                                                          S_D.HIGH@ = S_D.MONENT.HIGH@;
     2151    21298    4                                                          S_D.GOT# = S_D.MONENT.GOT#;
     2152    21299    4                                                          S_D.DEFINED# = S_D.MONENT.
             21299                                                                   DEFINED#;
     2153    21300    4                                                          S_D.NEXT# = S_D.MONENT.NEXT#;
     2154    21301    4                                                          S_D.RSPACE# = S_D.MONENT.
             21301                                                                   RSPACE#;
     2155    21302    4                                                          S_D.HEAD# = S_D.MONENT.HEAD#;
     2156    21303    4                                                          S_D.HIGH# = S_D.MONENT.HIGH#;
     2157    21304    4                                                       CASE(631); /* C@MONIS */
     2158    21305    4   MONIS:                                                 ;
     2159    21306    4                                                          S_D.GOT@ = S_D.MONIS.GOT@;
     2160    21307    4                                                          S_D.DEFINED@ = S_D.MONIS.
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:62   
             21307                                                                   DEFINED@;
     2161    21308    4                                                          S_D.NEXT@ = S_D.MONIS.NEXT@;
     2162    21309    4                                                          S_D.RSPACE@ = S_D.MONIS.
             21309                                                                   RSPACE@;
     2163    21310    4                                                          S_D.HEAD@ = S_D.MONIS.HEAD@;
     2164    21311    4                                                          S_D.HIGH@ = S_D.MONIS.HIGH@;
     2165    21312    4                                                          S_D.GOT# = S_D.MONIS.GOT#;
     2166    21313    4                                                          S_D.DEFINED# = S_D.MONIS.
             21313                                                                   DEFINED#;
     2167    21314    4                                                          S_D.NEXT# = S_D.MONIS.NEXT#;
     2168    21315    4                                                          S_D.RSPACE# = S_D.MONIS.
             21315                                                                   RSPACE#;
     2169    21316    4                                                          S_D.HEAD# = S_D.MONIS.HEAD#;
     2170    21317    4                                                          S_D.HIGH# = S_D.MONIS.HIGH#;
     2171    21318    4                                                       CASE(632); /* C@FD */
     2172    21319    4                                                          S_D.GOT@ = S_D.FD.GOT@;
     2173    21320    4                                                          S_D.DEFINED@ = S_D.FD.
             21320                                                                   DEFINED@;
     2174    21321    4                                                          S_D.NEXT@ = S_D.FD.NEXT@;
     2175    21322    4                                                          S_D.RSPACE@ = S_D.FD.RSPACE@;
     2176    21323    4                                                          S_D.HEAD@ = S_D.FD.HEAD@;
     2177    21324    4                                                          S_D.HIGH@ = S_D.FD.HIGH@;
     2178    21325    4                                                          S_D.GOT# = S_D.FD.GOT#;
     2179    21326    4                                                          S_D.DEFINED# = S_D.FD.
             21326                                                                   DEFINED#;
     2180    21327    4                                                          S_D.NEXT# = S_D.FD.NEXT#;
     2181    21328    4                                                          S_D.RSPACE# = S_D.FD.RSPACE#;
     2182    21329    4                                                          S_D.HEAD# = S_D.FD.HEAD#;
     2183    21330    4                                                          S_D.HIGH# = S_D.FD.HIGH#;
     2184    21331    4                                                       CASE(633); /* C@BF */
     2185    21332    4                                                          S_D.GOT@ = S_D.BF.GOT@;
     2186    21333    4                                                          S_D.DEFINED@ = S_D.BF.
             21333                                                                   DEFINED@;
     2187    21334    4                                                          S_D.NEXT@ = S_D.BF.NEXT@;
     2188    21335    4                                                          S_D.RSPACE@ = S_D.BF.RSPACE@;
     2189    21336    4                                                          S_D.HEAD@ = S_D.BF.HEAD@;
     2190    21337    4                                                          S_D.HIGH@ = S_D.BF.HIGH@;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:63   
     2191    21338    4                                                          S_D.GOT# = S_D.BF.GOT#;
     2192    21339    4                                                          S_D.DEFINED# = S_D.BF.
             21339                                                                   DEFINED#;
     2193    21340    4                                                          S_D.NEXT# = S_D.BF.NEXT#;
     2194    21341    4                                                          S_D.RSPACE# = S_D.BF.RSPACE#;
     2195    21342    4                                                          S_D.HEAD# = S_D.BF.HEAD#;
     2196    21343    4                                                          S_D.HIGH# = S_D.BF.HIGH#;
     2197    21344    4                                                       END;
     2198    21345    3                                                   END;
     2199    21346    3                                                ELSE DO; /* Must be USE CURRENT */
     2200    21347    3                                                     S_D.TREE$ = S_D.MTREE$;
     2201    21348    3                                                     S_D.NODE = S_D.UNODE.CURRENT;
     2202    21349    3                                                     I = S_D.SAVEIC;
     2203    21350    3                                                     CALL DDS$ES_INQ( I );
             21350                                                              /* Ignore altret */
     2204    21351    3                                                     CALL DDS$SET_Q2C;
     2205    21352    3                                                   END;
     2206    21353    2          CASE(40);                    /* WAIT */
     2207    21354    2             IF S_D.FPRG_CONTEXT$ = ADDR(NIL)
     2208    21355    3             THEN DO;
     2209    21356    3                  S_D.ERROR = 277; /* E@NOFPRGSWAIT */
     2210    21357    3                  GOTO ERR;
     2211    21358    3                END;
     2212    21359    2   WAIT_SEARCH:
     2213    21360    2             FPTWAIT = FPT_WAIT;
     2214    21361    2             FPTWAIT.V_ = VECTOR(FPTWAIT.V);
     2215    21362    2             TFPRG$ = S_D.FPRG_CONTEXT$;
     2216    21363    3             DO WHILE (TFPRG$ -> FPRG$CONTEXT.READ_FD = '0'B AND
     2217    21364    3               TFPRG$ -> FPRG$CONTEXT.XDELTA = '0'B);
     2218    21365    3                  TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     2219    21366    3                  IF TFPRG$ = ADDR(NIL)
     2220    21367    4                  THEN DO;
     2221    21368    4                       CALL M$WAIT(FPTWAIT);
     2222    21369    4                       GOTO WAIT_SEARCH;
     2223    21370    4                     END;
     2224    21371    3                END;
     2225    21372    2   DO_EVENT: ;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:64   
     2226    21373    2             TFPRG$ -> FPRG$CONTEXT.READ_FD = '1'B;
     2227    21374    2             S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;
     2228    21375    2             ALTRETURN;
     2229    21376    2          CASE(67);                    /* WHEN */
     2230    21377    2             S_D.ERROR = 502;         /* E@DELBUG */
     2231    21378    2             CALL DDE$ERROR;
     2232    21379    2          CASE(9);                    /* C_XCON */
     2233    21380    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     2234    21381    3             THEN DO;
     2235    21382    3                  GD$MSG = '0'B;
     2236    21383    3                  GD$MSG.FNC = %GD#RQSXCON;
     2237    21384    3                  CALL DFQ$WRITE_FD(S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERRMSG);
     2238    21385    3                  FPTWAIT = FPT_WAIT;
     2239    21386    3                  FPTWAIT.V_ = VECTOR(FPTWAIT.V);
     2240    21387    3                  CALL M$WAIT(FPTWAIT);
     2241    21388    3                  CALL DFQ$READ_FD(S_D.CURRENT_FPRG_CONTEXT$, '1'B)
     2242    21389    4                  WHENALTRETURN DO;
     2243    21390    4                       ALTRETURN;
     2244    21391    4                     END;
     2245    21392    3                  IF GD$MSG.FNC = %GD#RSPNOXCONCONTROL
     2246    21393    4                  THEN DO;
     2247    21394    4                       S_D.ERROR = 92; /* E@NO_CONTROL */
     2248    21395    4                       GOTO ERR;
     2249    21396    4                     END;
     2250    21397    3                  S_D.STEP_L6 = '0'B;
     2251    21398    3                  UNWIND TO S_D.DO_MESSAGE;
     2252    21399    3                END;
     2253    21400    3             ELSE DO;
     2254    21401    3                  IF S_D.ALIB
     2255    21402    4                  THEN DO;
     2256    21403    4                       S_D.ERROR = 269; /* E@CANTXCONALIB */
     2257    21404    4                       GOTO ERR;
     2258    21405    4                     END;
     2259    21406    3                  S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));
     2260    21407    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
     2261    21408    3                  IF NOGO_BIT THEN RETURN;
     2262    21409    3                  S_D.DRTN$->FPT$DRTN.V.ECC# = 3; /* SIMULATE XCON */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:65   
     2263    21410    3                  CALL DDA$GO ALTRET (NOXCON);
     2264    21411    3                  ALTRETURN;
     2265    21412    3                END;
     2266    21413    2          CASE(68);                     /* XEQ */
     2267    21414    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
     2268    21415    2             THEN GOTO NOTIMPFPRG;
     2269    21416    2             IF S_D.ALIB
     2270    21417    3             THEN DO;
     2271    21418    3                  S_D.ERROR = 246; /* E@CANTXEQALIB */
     2272    21419    3                  GOTO ERR;
     2273    21420    3                END;
     2274    21421    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(XEQ$CMD));
     2275    21422    2             CALL DDA$XEQ ALTRET(ERR);
     2276    21423    2             ALTRETURN;
     2277    21424    2          CASE(ELSE);                      /* UNKNOWN COMMAND */
     2278    21425    2             S_D.ERROR = 502;         /* E@DELBUG */
     2279    21426    2             CALL DDE$ERROR;
     2280    21427    2          END;
     2281    21428                                                /**/
     2282    21429    1   NOGO: ;
     2283    21430    1        IF S_D.ERROR = 503            /* E@NOTIMP */
     2284    21431    1        THEN CALL DDE$ERROR;
     2285    21432    1        RETURN;
     2286    21433    1   NOXCON: S_D.DRTN$->FPT$DRTN.V.ECC# = 90; /* KEEP USER FROM ENTERING */
     2287    21434                                           /* EXIT ROUTINE WHEN HE DOESN'T EXPECT IT */
     2288    21435    1        S_D.DRTN$->FPT$DRTN.V.SETECC# = '1'B;
     2289    21436    1   ERR:
     2290    21437    1        IF S_D.DRTN$ ~= ADDR(NIL)
     2291    21438    2        THEN DO;
     2292    21439    2             S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# = '0'B;
     2293    21440    2             S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB# = 0;
     2294    21441    2             S_D.DRTN$ -> FPT$DRTN.FPRG_FID_ = VECTOR(NIL);
     2295    21442    2           END;
     2296    21443    1        CALL DDE$ERROR;
     2297    21444    1   ERR1: ;
     2298    21445    1        S_D.STOP = '1'B;         /* TELL ONE AND ALL THAT AN ATTACHEMENT FAILED */
     2299    21446    1        RETURN;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:66   
     2300    21447    1   RECOVERY_IN_PROGRESS: ;
     2301    21448    1        IF NOT S_D.DEBUG_CMD
     2302    21449    1        THEN CALL DDA$GO ALTRET(NOGO);     /* Reset break points and stuff */
     2303    21450    1        ALTRETURN;                         /* Tell DDA$DELTA to keep on truck'n */
     2304    21451    1   SAD_OOPS:
     2305    21452    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR# = %E$BADSAD /* E$BADSAD */
     2306    21453    1        THEN S_D.ERROR = 179;        /*E@BAD_SAD*/
     2307    21454    1        ELSE S_D.ERROR = 178;       /*E@CANT_SAD*/
     2308    21455    1        GOTO ERR;
     2309    21456    1   FPRG_ERR: ;
     2310    21457    1        S_D.ERROR = 502;
     2311    21458    1        GOTO ERR;
     2312    21459    1   NOTIMPFPRG: ;
     2313    21460    1        S_D.ERROR = 331;       /* E@CMDNOTSUPPORT */
     2314    21461    1        GOTO ERR;
     2315    21462    1   NORELS_D: ;
     2316    21463    1        S_D.ERROR = 516;              /* E@RELS_D */
     2317    21464    1        GOTO ERR;
     2318    21465    1   ERRMSG:
     2319    21466    1        CALL DUE$ERRMSG;
     2320    21467    1        RETURN;
     2321    21468        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:67   
     2322    21469    1   SETDCTX: PROC( WHICH_ONE );
     2323    21470                                                /**/
     2324    21471    2   DCL WHICH_ONE UBIN;
     2325    21472                                                /**/
     2326    21473    3        DO CASE( S_D.DO$->DOO.ID );
     2327    21474    3          CASE ( 515 );                   /* C@NO */
     2328    21475    3             WHICH_ONE = DCTX_NO;
     2329    21476    3          CASE ( 516 );                   /* C@ME */
     2330    21477    3             WHICH_ONE = DCTX_ME;
     2331    21478    3          CASE ( 517 );                   /* C@CR */
     2332    21479    3             IF S_D.PATCH
     2333    21480    3             THEN WHICH_ONE = DCTX_PATCH;
     2334    21481    3             ELSE WHICH_ONE = DCTX_CR;
     2335    21482    3          CASE ( 518 );                 /* C@TAPE - MT */
     2336    21483    3             WHICH_ONE = DCTX_MT;
     2337    21484    3          CASE ( 519 );                   /* C@LP */
     2338    21485    3             WHICH_ONE = DCTX_LP;
     2339    21486    3          CASE ( 520 );                /* C@PATCH */
     2340    21487    3             WHICH_ONE = DCTX_PATCH;
     2341    21488    3          END;
     2342    21489                                                /**/
     2343    21490    2        RETURN;
     2344    21491                                                /**/
     2345    21492    2   END SETDCTX;
     2346    21493                                                /**/
     2347    21494        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:68   
     2348    21495    1   REPORT_STOPPED: PROC;
     2349    21496                                                /**/
     2350    21497                                                /* Report status of all stopped FPRGs */
     2351    21498    2        TFPRG$ = S_D.FPRG_CONTEXT$;
     2352    21499    3        DO WHILE (TFPRG$ ~= ADDR(NIL));
     2353    21500    3             IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED OR
     2354    21501    3               TFPRG$ -> FPRG$CONTEXT.STATE = %ATEXIT
     2355    21502    4             THEN DO;
     2356    21503    4                  S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;
     2357    21504    4                  CALL DFA$FPRG(TFPRG$ -> FPRG$CONTEXT.ADDRESS);
     2358    21505    4                  IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED
     2359    21506    4                  THEN CALL DFR$REPORT(%R_FPRG_STOP);
     2360    21507    4                  ELSE CALL DFR$REPORT(%R_FPRG_ATEXIT);
     2361    21508    4                  CALL DFA$KILL_FPRG;
     2362    21509    4                END;
     2363    21510    3             TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;
     2364    21511    3           END;
     2365    21512                                                /**/
     2366    21513    2   END REPORT_STOPPED;
     2367    21514                                                /**/
     2368    21515    1   RESTORE_USE: PROC;
     2369    21516
     2370    21517    2        IF S_D.RUM_FEP_USE = 0
     2371    21518    2        THEN GOTO MONIS;
     2372    21519    3        DO CASE(S_D.RUM_FEP_USE);
     2373    21520    3          CASE(630);                  /* C@MONENT */
     2374    21521    3             S_D.MONENT.GOT@ = S_D.GOT@;
     2375    21522    3             S_D.MONENT.NEXT@ = S_D.NEXT@;
     2376    21523    3             S_D.MONENT.RSPACE@ = S_D.RSPACE@;
     2377    21524    3             S_D.MONENT.HEAD@ = S_D.HEAD@;
     2378    21525    3             S_D.MONENT.HIGH@ = S_D.HIGH@;
     2379    21526    3             S_D.MONENT.GOT# = S_D.GOT#;
     2380    21527    3             S_D.MONENT.NEXT# = S_D.NEXT#;
     2381    21528    3             S_D.MONENT.RSPACE# = S_D.RSPACE#;
     2382    21529    3             S_D.MONENT.HEAD# = S_D.HEAD#;
     2383    21530    3             S_D.MONENT.HIGH# = S_D.HIGH#;
     2384    21531    3          CASE(631);                   /* C@MONENT */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:69   
     2385    21532    3   MONIS:    ;
     2386    21533    3             S_D.MONIS.GOT@ = S_D.GOT@;
     2387    21534    3             S_D.MONIS.NEXT@ = S_D.NEXT@;
     2388    21535    3             S_D.MONIS.RSPACE@ = S_D.RSPACE@;
     2389    21536    3             S_D.MONIS.HEAD@ = S_D.HEAD@;
     2390    21537    3             S_D.MONIS.HIGH@ = S_D.HIGH@;
     2391    21538    3             S_D.MONIS.GOT# = S_D.GOT#;
     2392    21539    3             S_D.MONIS.NEXT# = S_D.NEXT#;
     2393    21540    3             S_D.MONIS.RSPACE# = S_D.RSPACE#;
     2394    21541    3             S_D.MONIS.HEAD# = S_D.HEAD#;
     2395    21542    3             S_D.MONIS.HIGH# = S_D.HIGH#;
     2396    21543    3          CASE(632);                      /* C@MONENT */
     2397    21544    3             S_D.FD.GOT@ = S_D.GOT@;
     2398    21545    3             S_D.FD.NEXT@ = S_D.NEXT@;
     2399    21546    3             S_D.FD.RSPACE@ = S_D.RSPACE@;
     2400    21547    3             S_D.FD.HEAD@ = S_D.HEAD@;
     2401    21548    3             S_D.FD.HIGH@ = S_D.HIGH@;
     2402    21549    3             S_D.FD.GOT# = S_D.GOT#;
     2403    21550    3             S_D.FD.NEXT# = S_D.NEXT#;
     2404    21551    3             S_D.FD.RSPACE# = S_D.RSPACE#;
     2405    21552    3             S_D.FD.HEAD# = S_D.HEAD#;
     2406    21553    3             S_D.FD.HIGH# = S_D.HIGH#;
     2407    21554    3          CASE(633);                      /* C@MONENT */
     2408    21555    3             S_D.BF.GOT@ = S_D.GOT@;
     2409    21556    3             S_D.BF.NEXT@ = S_D.NEXT@;
     2410    21557    3             S_D.BF.RSPACE@ = S_D.RSPACE@;
     2411    21558    3             S_D.BF.HEAD@ = S_D.HEAD@;
     2412    21559    3             S_D.BF.HIGH@ = S_D.HIGH@;
     2413    21560    3             S_D.BF.GOT# = S_D.GOT#;
     2414    21561    3             S_D.BF.NEXT# = S_D.NEXT#;
     2415    21562    3             S_D.BF.RSPACE# = S_D.RSPACE#;
     2416    21563    3             S_D.BF.HEAD# = S_D.HEAD#;
     2417    21564    3             S_D.BF.HIGH# = S_D.HIGH#;
     2418    21565    3          END;
     2419    21566    2   END RESTORE_USE;
     2420    21567    1   END DDA$DO;
     2421    21568        %EOD;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:70   

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:71   
--  Include file information  --

   KF$MSG_SUBS.:E05TOU  is referenced.
   KF$MSG_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$DA.:E05TOU  cannot be made into a system file and is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   DD_KNODES_D.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   DD_REPORT_R.:E05TOU  cannot be made into a system file and is referenced.
   GD$MSG_M.:E05TOU  is referenced.
   DD_DEBUG_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GD_EQUS_E.:E05TOU  is referenced.
   DF_EQUS_E.:E05TOU  is referenced.
   DU_SCODE_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDA$DO.

   Procedure DDA$DO requires 5169 words for executable code.
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:72   
   Procedure DDA$DO requires 360 words of local(AUTO) storage.

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:73   

 Object Unit name= DDA$DO                                     File name= DDA$DO.:E05TOU
 UTS= JUL 29 '97 13:23:27.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    401    621  DDA$DO
    2   Proc  even  none  5169  12061  DDA$DO
    3  RoData even  none    51     63  DDA$DO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        0  DDA$DO

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     76  FPT_WAIT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:74   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DDA$IF
         yes           Std       0 DUA$KILL_RUM
 yes     yes           Std       4 DFA$SETUP_FPRG
 yes     yes           Std       4 DUA$OUTPUT
         yes           Std       0 DDA$KEEP
 yes     yes           Std       0 DFA$MLCT_ACTIVE
 yes     yes           Std       0 DDA$NAME
 yes     yes           Std       3 DUA$UNFID
 yes     yes           Std       3 DFA$SET_AT
         yes           Std       3 DFA$KILL1
 yes     yes           Std       2 DDS$PD_SRCH
 yes     yes           Std       2 DFQ$READ_FD
 yes     yes           Std       0 DDA$EVAL
         yes           Std       0 DXC$MINI
 yes     yes           Std       1 DFA$QUIT
 yes     yes           Std       3 DDM$PUTMEM
         yes           Std       0 DUA$EXITDELTA
         yes           Std       1 DFR$REPORT
 yes     yes           Std       0 DDA$DEF
         yes           Std       0 DUA$RUM
         yes           Std       0 DFA$TRACE
 yes     yes           Std       0 DFA$DFMT
 yes     yes           Std       0 DFA$TSA
         yes           Std       0 DDA$TRACEON
 yes     yes           Std       1 DDA$STEP_MORE
 yes     yes           Std       0 DDA$DUMP_DO
         yes           Std       1 DDR$REPORT
         yes           Std       0 DDA$HIST
         yes           Std       0 DUA$LIST
 yes     yes           Std       0 DFA$UNFID
 yes     yes           Std       0 DDA$STORE
 yes     yes           Std       0 DDS$SET_C2D
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:75   
 yes     yes           Std       0 DDS$EUTREE
         yes           Std       0 DDA$SHOW
 yes     yes           Std       0 DDS$SET_T2Q
 yes     yes           Std       0 DUA$KILL_ANLZ
         yes           Std       0 DUE$GERRMSG
 yes     yes           Std       0 DFA$MLCT
         yes           Std       2 DDQ$WRITE
         yes           Std       0 DUA$PMD
 yes     yes           Std       0 DDS$SET_Q2C
         yes           Std       0 DUE$ERRMSG
 yes     yes           Std       0 DDA$FIND
         yes           Std       0 DDA$RESET_PATCH_SPACE
 yes     yes           Std       1 DFA$GO
 yes     yes           Std       1 DUA$READ
 yes     yes           Std       0 DFA$KEEP
         yes           Std       0 DDA$TRACE
 yes     yes           Std       0 DDS$SET_Q2X
         yes           Std       1 DFA$GET_FPRG_DCB
 yes     yes           Std       0 DFA$DUMP
 yes     yes           Std       4 DUL$USE
 yes     yes           Std       0 DDA$LET
         yes           Std       0 DXC$EOP
 yes     yes           Std       2 DFA$STEP
 yes     yes           Std       1 DDS$ES_INQ
         yes           Std       0 DDT$TRACEOFF
 yes     yes           Std       2 DUA$ALIB
 yes     yes           Std       0 DDA$GO
 yes     yes           Std       1 DFQ$WRITE_FD
 yes     yes           Std       0 DXA$QUIT
         yes           Std       0 DUA$DELETE
         yes           Std       0 DUI$INIT_HOST
         yes           Std       0 DUA$HELP
 yes     yes           Std       0 DFA$LET
 yes     yes           Std       0 DDS$SET_Q2T
 yes     yes           Std       1 DDS$EQCS#
         yes           Std       0 DXA$DBOOT
         yes           Std       1 DFA$KILL_FPRG
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:76   
         yes           Std       0 DDE$ERROR
         yes           Std       4 DDR$BINTXT
 yes     yes           Std       0 DDA$USER_DO
         yes           Std       0 DUI$INIT_L6
 yes     yes           Std       1 DDA$STEP
 yes     yes           Std       0 DDA$DISP
         yes           Std       0 DDA$KILL
 yes     yes           Std       0 DDA$MOD
         yes           Std       0 DFA$PLUGH
 yes     yes           Std       2 DFA$STOP_FPRGS
 yes     yes           Std       0 DFA$DLCT
 yes     yes           Std       0 DDA$MACTIVE
         yes           Std       0 DXA$TBOOT
         yes           Std       0 DFA$KILL_DELTA
 yes     yes           Std       0 DUA$ANLZ
         yes           Std       0 DXA$USE
         yes           Std       1 DUD$MINI
 yes     yes           Std       0 DUI$RU_ACCESS
         yes           Std       0 DDA$PLUGH
         yes           Std       0 DFA$USE
 yes     yes           Std       0 DDA$UPDATE
         yes           Std       1 DFA$FPRG
 yes     yes           Std       0 DDA$XEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       nStd      0 X66_AUNWIND
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:77   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    DD_REPORT_FLAGS                       DX_DIC                                DCTX_CR
     DCTX_ME                               DCTX_MT                               DCTX_NO
     DCTX_LP                               DCTX_PATCH                            IN_DEV
     OUT_DEV                               ECHO_DEV                              OUT_DEV_SAVE
     D_XDELTA                              IRM_NOKP_SCR                          MIS$
     SAD$                                  D_M$LM#                               B$ROS$
r    S_D$                             r    S_D_SEG$                         r    S_D_HOST_MESSAGE$
r    S_D_L6_MESSAGE$                  r    DD_COMPNODE$                     r    DD_COMP_NODE_PTR$
     DD_ANLZSEG$                           M$UC                                  B$JIT$
     B$TCB$                           r    SNAP_MESSAGE                          FPT_GETDCB
     FPT_RELDCB                            FPT_CLOSE                             FPT_EOM
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:78   


        1        1        /*M* DDA$DO DELTA DO ROUTINE MODULE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DDA$DO
       10       10             PURPOSE: TO PERFORM THE ENCODED COMMAND THAT IT RECEIVES.
       11       11             DESCRIPTION:
       12       12             REFERENCE: DELTA FUNCTIONAL SPEC AF Section 17.6 #0065C-0.
       13       13        */
       14       14        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:79   
       15       15        /*F* NAME: DDA$DO
       16       16             PURPOSE: TO PERFORM THE ENCODED COMMAND THAT IT RECEIVES.
       17       17             DESCRIPTION:
       18       18             REFERENCE: DELTA FUNCTIONAL SPEC AF Section 17.6 #0065C-0.
       19       19        */
       20       20        /**/
       21       21        DDA$DO: PROC ALTRET;

     21  2 000000   000000 700200 xent  DDA$DO       TSX0  ! X66_AUTO_0
         2 000001   000550 000000                    ZERO    360,0

       22       22    1   DCL CODE UBIN(36);
       23       23    1   DCL NOGO_BIT BIT(1) ALIGNED;
       24       24    1   DCL I UBIN;
       25       25    1   DCL II UBIN;
       26       26    1   DCL TYPE UBIN;
       27       27    1   DCL USR# UBIN;
       28       28    1   DCL LS# UBIN;
       29       29    1   DCL CPU# UBIN;
       30       30    1   DCL LOWX UBIN;
       31       31    1   DCL HIGX UBIN;
       32       32    1   DCL OPEN BIT(1) ALIGNED;
       33       33    1   DCL CLOSED BIT(1) ALIGNED;
       34       34    1   DCL ADDRESS UBIN;
       35       35    1   DCL DESC# UBIN;
       36       36    1   DCL SEG UBIN;
       37       37    1   DCL NOT_IS BIT(1) ALIGNED;
       38       38    1   DCL DCB# SBIN;
       39       39    1   DCL DCB$ PTR;
       40       40    1   DCL TEMP$ PTR;
       41       41    1   DCL TEMP1 REDEF TEMP$ UBIN(36) ALIGNED;
       42       42    1   DCL 1 TEMP1B REDEF TEMP$ ALIGNED,
       43       43    1         2 * UBIN(4) UNAL,
       44       44    1         2 B1 UBIN(8) UNAL,
       45       45    1         2 B2 UBIN(8) UNAL,
       46       46    1         2 B3 UBIN(8) UNAL,
       47       47    1         2 B4 UBIN(8) UNAL;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:80   
       48       48    1   DCL TEMP2 UBIN(36) ALIGNED;
       49       49    1   DCL 1 TEMP2B REDEF TEMP2 ALIGNED,
       50       50    1         2 * BIT(1) UNAL,
       51       51    1         2 B1 UBIN(8) UNAL,
       52       52    1         2 * BIT(1) UNAL,
       53       53    1         2 B2 UBIN(8) UNAL,
       54       54    1         2 * BIT(1) UNAL,
       55       55    1         2 B3 UBIN(8) UNAL,
       56       56    1         2 * BIT(1) UNAL,
       57       57    1         2 B4 UBIN(8) UNAL;
       58       58    1   DCL BUF$ PTR;
       59       59    1   DCL PTR_SAD_SKEL PTR;
       60       60    1   DCL 1 PTR_SAD REDEF PTR_SAD_SKEL,
       61       61    1         2 * BIT(24) UNAL,
       62       62    1         2 PT,
       63       63    1           3 * BIT(2) UNAL,
       64       64    1           3 LS UBIN(10) UNAL;
       65       65    1   DCL NO_COMMANDS BIT(1);
       66       66    1   DCL FID_ASN UBIN BYTE ALIGNED;
       67       67    1   DCL RES CHAR(8);
       68       68    1   DCL RES_SIZE UBIN;
       69       69    1   DCL DCBNO UBIN;
       70       70    1   DCL FID_RES CHAR(4);
       71       71    1   DCL TSIZE UBIN;
       72       72    1   DCL TFPRG$ PTR;
       73       73    1   DCL PTFPRG$ PTR;
       74       74    1   DCL DFPRG$ PTR;
       75       75    1   DCL DO$ PTR;
       76       76    1   DCL FATT$ PTR;
       77       77    1   DCL EDEF$ PTR;
       78       78    1   DCL UBIN36 UBIN BASED;
       79       79    1   DCL FPRG_IC UBIN;
       80       80    1   DCL FAULT UBIN;
       81       81    1   DCL TOBREL UBIN;
       82       82        %INCLUDE B$OBJECT_C;
       83     3512        %B$EDEF;
       84     3582        %SUB_CST;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:81   
       85     3598        %SUB_LINKFLAGS;
       86     3607        %B$TREE_TABLE(NODE_NAME="B$TREE_NODE(0:0)");
       87     3665        %B$TREE_TABLE (HDR_NAME=B$TREEHDR,NODE_NAME="B$NODE(0:0)");
       88     3723        %INCLUDE DD$DITEM;
       12+    3826             %LIST;
       13+    3827    1        DCL SDD$ PTR;
       14+    3828    1        DCL ZITEM$ PTR;
       15+    3829    1        DCL SDD_L6$ PTR;
       16+    3830    1        DCL ZITEM_L6$ PTR;
       89     4404        %INCLUDE DD$BASED;                      /* BASED STRUCTURES */
       90     5707        %FIXCOM (NAME="F$XCM",STCLASS=BASED);
       91     5723        %AT_FIRST;
       92     5751        %WHEN_FIRST (NAME=WHEN, STCLASS="BASED(FATT$)");
       93     5788        %ALL_ATTACH;
       94     5803        %DOO (STCLASS=BASED);
       95     5818        %DISPLAY;
       96     5829        %GO (NAME=GO$CMD);
       97     5849        %FORMAT$CMD;
       98     5861        %PROMPT$CMD;
       99     5874        %SHOW$CMD;
      100     5896        %TR$CMD;
      101     5912        %XEQ$CMD;
      102     5926        %RUM$CMD;
      103     5950        %DEF$CMD;
      104     5964        %LET$CMD;
      105     6014        %DUMP$CMD;
      106     6044        %MACTIVE$CMD;
      107     6063        %MODIFY$CMD;
      108     6079        %EVAL$CMD;
      109     6094        %KEEP$CMD;
      110     6113        %HIST$CMD;
      111     6126        %ACTIVE$CMD;
      112     6139        %USE$CMD;
      113     6162        %TEXT$C;
      114     6167        %FIND$CMD;
      115     6193        %REPORT$CMD;
      116     6209        %ALIB$CMD;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:82   
      117     6221        %ANLZ$CMD;
      118     6244        %UNFID$CMD;
      119     6262        %NAME$CMD;
      120     6276        %UNSHARE$CMD;
      121     6288        %DEBUG$CMD;
      122     6311        %FPRG$CONTEXT;
      123     6374        %QUIT$CMD;
      124     6386        %QUIT$CMD (NAME=STOP$CMD);
      125     6398        %SCHEMA$CMD;
      126     6414        %LCT$CMD;
      127     6428        %INCLUDE DU_SCODE_C;
      128     6441        %INCLUDE DF_EQUS_E;
      129     6454        %INCLUDE GD_EQUS_E;
      130     6615        %INCLUDE G_LCP6_E;
      131     6873        %INCLUDE DD_DEBUG_C;
      132     6894        %INCLUDE GD$MSG_M;
      133     7058        %GD$MSG(FPTN=GD$MSG_HOST, STCLASS="BASED(S_D_HOST_MESSAGE$)", L6=NO);
      134     7214       %GD$MSG(FPTN=GD$MSG, STCLASS="BASED(S_D_L6_MESSAGE$)",L6=YES,L6PTR="UBIN(32) UNAL");
      135     7370        %INCLUDE DD_REPORT_R;
      136     7379    1   DCL DD_XOU$ PTR SYMREF;
      137     7380    1   DCL DX_DIC BIT(1) SYMREF;
      138     7381    1   DCL DCTX_CR UBIN SYMREF;
      139     7382    1   DCL DCTX_ME UBIN SYMREF;
      140     7383    1   DCL DCTX_MT UBIN SYMREF;
      141     7384    1   DCL DCTX_NO UBIN SYMREF;
      142     7385    1   DCL DCTX_LP UBIN SYMREF;
      143     7386    1   DCL DCTX_PATCH UBIN SYMREF;
      144     7387    1   DCL IN_DEV UBIN SYMREF;
      145     7388    1   DCL OUT_DEV UBIN SYMREF;
      146     7389    1   DCL ECHO_DEV UBIN SYMREF;
      147     7390    1   DCL OUT_DEV_SAVE UBIN SYMREF;
      148     7391    1   DCL D_XDELTA BIT(1) SYMREF;
      149     7392    1   DCL IRM_NOKP_SCR UBIN SYMREF;
      150     7393    1   DCL MIS$ PTR SYMREF;
      151     7394    1   DCL SAD$ PTR SYMREF;
      152     7395    1   DCL D_M$LM# UBIN SYMREF;
      153     7396    1   DCL B$ROS$ PTR SYMREF;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:83   
      154     7397    1   DCL DD_FPRGSEG$ PTR SYMREF;
      155     7398        %INCLUDE B$ROSEG;
      156     7461        %INCLUDE XUH_MACRO_C;
      157     7545        %INCLUDE DD_SD_M;
      158     8881        %S_D;
      159    10199        %S_D_PTRS;
      160    10236        %INCLUDE XU_MACRO_C;
      161    13342        %INCLUDE DD_KNODES_D;
      162    13558        %NODE_DEFS;
      163    13947        %INCLUDE IR_DATA_M;
      164    14111        %INCLUDE DD$DA;
      165    14192        %INCLUDE DD_SUBS_C;                     /* DELTA %SUBS */
      166    14463        %INCLUDE DD_ERR_C;
      167    14860        %INCLUDE DD_PSUBS_C;
      168    15335        %INCLUDE CP_6;
      169    15416        %INCLUDE CP_6_SUBS;
      170    15956        %INCLUDE B_ERRORS_C;
      171    17083        %INCLUDE B$JIT;
      172    17373        %B$ALIBF;
      173    17377    1   DCL B$JIT$ PTR SYMREF;
      174    17378        %B$TCB;
      175    17381        %B$XCON;
      176    17391        %B$EXCFR;
      177    17409        %B$ALT;
      178    17417        %SUB_EXC;
      179    17464        %SUB_ECCDELTA;
      180    17501        %F$DCB;
      181    17558    1   DCL B$TCB$ PTR SYMREF;
      182    17559    1   DCL DDA$DEF        ENTRY       ALTRET;
      183    17560    1   DCL DDA$DISP       ENTRY       ALTRET;
      184    17561    1   DCL DDA$DOATTACH   ENTRY       ALTRET;
      185    17562    1   DCL DDA$DUMP_DO    ENTRY          ALTRET;
      186    17563    1   DCL DDA$EVAL       ENTRY       ALTRET;
      187    17564    1   DCL DDA$FIND       ENTRY       ALTRET;
      188    17565    1   DCL DDA$GO         ENTRY       ALTRET;
      189    17566    1   DCL DDA$HIST       ENTRY;
      190    17567    1   DCL DDA$IF         ENTRY(1)    ALTRET;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:84   
      191    17568    1   DCL DDA$KEEP       ENTRY;
      192    17569    1   DCL DDA$KILL       ENTRY;
      193    17570    1   DCL DDA$KILL1      ENTRY;
      194    17571    1   DCL DDA$LET        ENTRY       ALTRET;
      195    17572    1   DCL DDA$MACTIVE    ENTRY(0)    ALTRET;
      196    17573    1   DCL DDA$MOD        ENTRY       ALTRET;
      197    17574    1   DCL DDA$NAME       ENTRY       ALTRET;
      198    17575    1   DCL DDA$PLUGH      ENTRY;
      199    17576    1   DCL DDA$RESET_PATCH_SPACE ENTRY;
      200    17577    1   DCL DDA$SHOW       ENTRY;
      201    17578    1   DCL DDA$STEP       ENTRY(1)    ALTRET;
      202    17579    1   DCL DDA$STEP_MORE  ENTRY(1)    ALTRET;
      203    17580    1   DCL DDA$STORE      ENTRY       ALTRET;
      204    17581    1   DCL DDA$TRACE      ENTRY;
      205    17582    1   DCL DDA$TRACEON    ENTRY;
      206    17583    1   DCL DDA$UPDATE     ENTRY       ALTRET;
      207    17584    1   DCL DDA$USER_DO    ENTRY       ALTRET;
      208    17585    1   DCL DDA$XEQ        ENTRY       ALTRET;
      209    17586    1   DCL DDE$ERROR      ENTRY;
      210    17587    1   DCL DDF$FIND_PEDEF ENTRY(2) ALTRET;
      211    17588    1   DCL DDK$EVAL       ENTRY(6)    ALTRET;
      212    17589    1   DCL DDM$GETMEM     ENTRY(3)    ALTRET;
      213    17590    1   DCL DDM$PUTMEM     ENTRY(3)    ALTRET;
      214    17591    1   DCL DDQ$WRITE      ENTRY(2);
      215    17592    1   DCL DDR$BINTXT     ENTRY(4);
      216    17593    1   DCL DDR$REPORT     ENTRY(1);
      217    17594    1   DCL DDS$EQCS#      ENTRY(1)    ALTRET;
      218    17595    1   DCL DDS$ES_INQ     ENTRY(1)    ALTRET;
      219    17596    1   DCL DDS$EUTREE     ENTRY(0)    ALTRET;
      220    17597    1   DCL DDS$PD_SRCH    ENTRY(2)    ALTRET;
      221    17598    1   DCL DDS$SET_C2D    ENTRY(0)    ALTRET;
      222    17599    1   DCL DDS$SET_Q2C    ENTRY(0)    ALTRET;
      223    17600    1   DCL DDS$SET_Q2T    ENTRY(0)    ALTRET;
      224    17601    1   DCL DDS$SET_Q2X    ENTRY(0)    ALTRET;
      225    17602    1   DCL DDS$SET_T2Q    ENTRY(0)    ALTRET;
      226    17603    1   DCL DDT$TRACEOFF   ENTRY;
      227    17604    1   DCL DFA$DFMT       ENTRY       ALTRET;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:85   
      228    17605    1   DCL DFA$DLCT       ENTRY        ALTRET;
      229    17606    1   DCL DFA$DUMP ENTRY ALTRET;
      230    17607    1   DCL DFA$FPRG       ENTRY(1);
      231    17608    1   DCL DFA$GET_FPRG_DCB ENTRY(1);
      232    17609    1   DCL DFA$GO         ENTRY(1)    ALTRET;
      233    17610    1   DCL DFA$KEEP       ENTRY       ALTRET;
      234    17611    1   DCL DFA$KILL_DELTA ENTRY;
      235    17612    1   DCL DFA$KILL_FPRG  ENTRY(1);
      236    17613    1   DCL DFA$KILL1      ENTRY(3);
      237    17614    1   DCL DFA$LET        ENTRY        ALTRET;
      238    17615    1   DCL DFA$MLCT       ENTRY        ALTRET;
      239    17616    1   DCL DFA$MLCT_ACTIVE ENTRY       ALTRET;
      240    17617    1   DCL DFA$PLUGH      ENTRY;
      241    17618    1   DCL DFA$QUIT       ENTRY(1)    ALTRET;
      242    17619    1   DCL DFA$SET_AT     ENTRY(3)    ALTRET;
      243    17620    1   DCL DFA$SETUP_FPRG ENTRY(4)    ALTRET;
      244    17621    1   DCL DFA$STEP       ENTRY(2)    ALTRET;
      245    17622    1   DCL DFA$STOP_FPRGS ENTRY(2)    ALTRET;
      246    17623    1   DCL DFA$TSA        ENTRY ALTRET;
      247    17624    1   DCL DFA$TRACE      ENTRY;
      248    17625    1   DCL DFA$TRACE_REPORT ENTRY ALTRET;
      249    17626    1   DCL DFA$UNFID      ENTRY       ALTRET;
      250    17627    1   DCL DFA$USE        ENTRY;
      251    17628    1   DCL DFQ$WRITE_FD   ENTRY(1)    ALTRET;
      252    17629    1   DCL DFQ$READ_FD    ENTRY(2)    ALTRET;
      253    17630    1   DCL DFR$EVENTRPT   ENTRY(1);
      254    17631    1   DCL DFR$REPORT     ENTRY(1);
      255    17632    1   DCL DUA$ALIB       ENTRY(2)    ALTRET;
      256    17633    1   DCL DUA$ANLZ       ENTRY       ALTRET;
      257    17634    1   DCL DUA$DELETE     ENTRY(0);
      258    17635    1   DCL DUA$EXITDELTA  ENTRY;
      259    17636    1   DCL DUA$HELP       ENTRY;
      260    17637    1   DCL DUA$KILL_ANLZ  ENTRY(0)    ALTRET;
      261    17638    1   DCL DUA$KILL_RUM   ENTRY(0);
      262    17639    1   DCL DUA$LIST       ENTRY(0);
      263    17640    1   DCL DUA$OUTPUT     ENTRY(4)    ALTRET;
      264    17641    1   DCL DUA$PMD        ENTRY(0);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:86   
      265    17642    1   DCL DUA$READ       ENTRY(1)    ALTRET;
      266    17643    1   DCL DUA$RUM        ENTRY(0);
      267    17644    1   DCL DUA$UNFID      ENTRY(3)    ALTRET;
      268    17645    1   DCL DUD$MINI       ENTRY(1);
      269    17646    1   DCL DUE$ERRMSG     ENTRY;
      270    17647    1   DCL DUE$GERRMSG     ENTRY;
      271    17648    1   DCL DUI$INIT_HOST   ENTRY;
      272    17649    1   DCL DUI$INIT_L6     ENTRY;
      273    17650    1   DCL DUI$RU_ACCESS   ENTRY ALTRET;
      274    17651    1   DCL DUL$USE        ENTRY(4)    ALTRET;
      275    17652    1   DCL DXA$QUIT       ENTRY       ALTRET;
      276    17653    1   DCL DXA$TBOOT      ENTRY;
      277    17654    1   DCL DXA$DBOOT      ENTRY;
      278    17655    1   DCL DXA$USE        ENTRY(0);
      279    17656    1   DCL DXC$EOP        ENTRY;
      280    17657    1   DCL DXC$MINI       ENTRY;
      281    17658        %FPT_SCREECH(FPTN=SNAP_MESSAGE,STCLASS=SYMREF READONLY);
      282    17672        %VLP_SCODE(FPTN=SC_MESSAGE, STCLASS=SYMREF READONLY);
      283    17733        %FPT_GETDCB(FPTN=FPT_GETDCB,STCLASS=SYMREF);
      284    17748        %FPT_OPEN(FPTN=FPT_OPEN,FUN=IN,STCLASS=CONSTANT,XONLY=YES);
      285    17857        %FPT_OPEN(FPTN=FPTOPEN,STCLASS=);
      286    17966        %VLP_SN(FPTN=VLP_SN,
      287    17967                STCLASS=,
      288    17968                N=1);
      289    17981        %VLP_NAME(FPTN=VLP_NAME,
      290    17982                  STCLASS=,
      291    17983                  LEN=31);
      292    18010        %VLP_ACCT(FPTN=VLP_ACCT,
      293    18011                  STCLASS=);
      294    18024        %VLP_PASS(FPTN=VLP_PASS,
      295    18025                  STCLASS=);
      296    18038        %VLP_WSN(FPTN=VLP_WSN, STCLASS=AUTO);
      297    18051        %VLP_NAME (FPTN=VLP_MONNAME, STCLASS=CONSTANT,
      298    18052                  NAME='M:FEP');
      299    18079        %VLP_ACCT (FPTN=VLP_SYSACCT, STCLASS=CONSTANT,
      300    18080                  ACCT=':SYS');
      301    18093        %FPT_WAIT(FPTN=FPT_WAIT,UNITS=2,STCLASS=CONSTANT SYMDEF);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:87   
      302    18107        %FPT_WAIT(FPTN=FPTWAIT,STCLASS=);
      303    18121        %FPT_GETDCB(FPTN=FPTGETDCB,
      304    18122                    STCLASS=);
      305    18137        %VLP_SETSTA(FPTN=VLP_SETSTA,STCLASS=AUTO);
      306    18165        %VLP_NODENAME(FPTN=VLP_NODENAME,STCLASS=AUTO);
      307    18178        %VLR_FID(FPTN=VLR_FID,STCLASS=AUTO);
      308    18197        %FPT_FID(FPTN=FPT_FID,
      309    18198                 STCLASS=CONSTANT);
      310    18221        %FPT_FID(FPTN=FPTFID,STCLASS=);
      311    18244        %FPT_RELDCB(FPTN=FPT_RELDCB,
      312    18245                    STCLASS=SYMREF);
      313    18259        %FPT_RELDCB(FPTN=FPTRELDCB,
      314    18260                    STCLASS=);
      315    18274        %FPT_CLOSE (FPTN=FPT_CLOSE, STCLASS=SYMREF);
      316    18316        %FPT_CLOSE (FPTN=FPT$CLOSE, STCLASS=AUTO);
      317    18358        %FPT_DRTN (FPTN=FPT$DRTN, STCLASS=BASED);
      318    18382        %VLR_FPRG_FID(FPTN=VLR_FPRG_FID,STCLASS=AUTO);
      319    18390        %FPT_EOM (FPTN=FPT_EOM,STCLASS=SYMREF);
      320    18420        %FPT_SAD (FPTN=FPT_SAD, STCLASS=CONSTANT);
      321    18435        %FPT_SAD (FPTN=FPT$SAD, STCLASS=AUTO);
      322    18450        %FPT_UNSHARE (FPTN=FPT_UNSHARE,
      323    18451                      STCLASS=CONSTANT,
      324    18452                      PROG=NO,
      325    18453                      LIB=NO);
      326    18468        %FPT_UNSHARE (FPTN=FPT$UNSHARE,
      327    18469                      STCLASS=);
      328    18484        %FPT_SSC (FPTN=FPT_SSC, STCLASS=CONSTANT,
      329    18485                  FLAGS="'0'B");
      330    18501        %FPT_SSC (FPTN=FPT$SSC, STCLASS=AUTO);
      331    18517        %COMPILERIDSUBS;
      332    18533        %FPT_CLOSE(FPTN=FPT_CLOSE_DBG, STCLASS=CONSTANT);
      333    18575        %FPT_CLOSE(FPTN=FPTCLOSE_DBG, STCLASS=);
      334    18617        %FPT_OPEN(FPTN=FPT_OPEN_DBG,
      335    18618                  STCLASS=CONSTANT,
      336    18619                  XONLY=YES,
      337    18620                  NAME=DBG_NAME,
      338    18621                  ACCT=DBG_ACCT,
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:88   
      339    18622                  ASN=COMGROUP,
      340    18623                  SCRUB=YES,
      341    18624                  FUN=UPDATE,
      342    18625                  SHARE=ALL,
      343    18626                  CTG=YES);
      344    18735        %FPT_OPEN(FPTN=FPT_OPEN_FANLZ,
      345    18736                  XONLY=YES,
      346    18737                  ORG=FPRG,
      347    18738                  ASN=DEVICE,
      348    18739                  SCRUB=YES,
      349    18740                  FUN=CREATE,
      350    18741                  STCLASS=CONSTANT);
      351    18850        %FPT_SETFP(FPTN=FPT_SETFP,
      352    18851                   STCLASS=CONSTANT);
      353    18864        %FPT_SETFP(FPTN=FPTSETFP,
      354    18865                   STCLASS=);
      355    18878        %VLP_FPRG(FPTN=HANDLER_FPRG,
      356    18879                  STCLASS=CONSTANT,
      357    18880                  NAME='DELTA_FPRG',
      358    18881                  ACCT=':SYS');
      359    18902        %VLP_NAME(FPTN=DBG_NAME,
      360    18903                  STCLASS=CONSTANT,
      361    18904                  NAME='FECG');
      362    18931        %VLP_ACCT(FPTN=DBG_ACCT,
      363    18932                  STCLASS=CONSTANT,
      364    18933                  ACCT=':SYS');
      365    18946        %INCLUDE KF$MSG_C;
      366    19013        %INCLUDE KF$MSG_SUBS;
      367    19059        %KF$MSG_EXCLDCB(NAME=KF$MSG);
      368    19065        %FPT_READ(FPTN=FPT_READ_DBG,
      369    19066                  STCLASS=CONSTANT,
      370    19067                  TRANS=YES);
      371    19106        %FPT_READ(FPTN=FPTREAD_DBG, STCLASS=);
      372    19145        %FPT_WRITE(FPTN=FPT_WRITE_DBG,
      373    19146                   STCLASS=CONSTANT,
      374    19147                   TRANS=YES);
      375    19178        %FPT_WRITE(FPTN=FPTWRITE_DBG,STCLASS=);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:89   
      376    19209        %VLP_STATION(FPTN=FROG_STATION,
      377    19210                     STCLASS=CONSTANT,
      378    19211                     STATION='FROG');
      379    19238        %FPT_TRMATTR(FPTN=TRM_DBG,
      380    19239                     STCLASS=CONSTANT,
      381    19240                     TRMATTR=VLP_TRMATTR);
      382    19265        %FPT_TRMATTR(FPTN=TRMDBG, STCLASS=);
      383    19290        %VLP_TRMATTR(STCLASS=CONSTANT,
      384    19291                     PARITY=NONE);
      385    19329        %FPT_EOM(FPTN=FPT_EOM_DBG,
      386    19330                 STCLASS=CONSTANT,
      387    19331                 EOMTABLE=REMOTEEOM);
      388    19361        %FPT_EOM(FPTN=FPTEOM_DBG, STCLASS=);
      389    19391    1   DCL REMOTEEOM (0:7) BIT(36) CONSTANT
      390    19392    1        INIT('0'B*2, '02'O, '0'B*3, '02'O, '0'B);
      391    19393        %FPT_TRMCTL(FPTN=CTL_DBG,
      392    19394                    STCLASS=CONSTANT,
      393    19395                    TRMCTL=VLP_TRMCTL);
      394    19422        %FPT_TRMCTL(FPTN=CTLDBG, STCLASS=);
      395    19449        %VLP_TRMCTL(FPTN=VLP_TRMCTL,
      396    19450                    STCLASS=CONSTANT,
      397    19451                    ACTONTRN=YES,
      398    19452                    DISPINPUT=NO);
      399    19492        %FPT_PROMPT(FPTN=FPT_PROMPT_DBG,
      400    19493                    STCLASS=CONSTANT,
      401    19494                    PROMPT=AT,
      402    19495                    VFC=YES);
      403    19523        %FPT_PROMPT(FPTN=FPTPROMPT_DBG, STCLASS=);
      404    19551    1   DCL AT CHAR(1) CONSTANT INIT('@');
      405    19552    1   DCL MSG$ PTR;
      406    19553        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:90   
      407    19554        /*D* NAME: DDA$DO
      408    19555             CALL: CALL DDA$DO ALTRET(USERGO)
      409    19556             DESCRIPTION:
      410    19557                  DDA$DO is called by DDA$DELTA, and DDA$DOATTACH to
      411    19558                  perform an encoded directive.  The directive is either
      412    19559                  a stored directive is S_D.VARCOM$->VARCOM, or an immediate directive
      413    19560                  in S_D.DIRCOM.  S_D.DO$ is set to point at the directive
      414    19561                  before entry to DDA$DO.  The actual function of each
      415    19562                  DELTA directive is performed by code in DDA$DO, or in
      416    19563                  a routine called by DDA$DO.  Note that while stored directives
      417    19564                  (AT, ON NODE, etc.) are stored away in VARCOM by DDS$SCAN,
      418    19565                  the attachments are performed here.
      419    19566
      420    19567                  When adding a directive to DELTA, the code to perform it,
      421    19568                  or a call to a module which performs it, must be placed here.
      422    19569
      423    19570                  DDA$DO will call DDA$IF to test for a true condition on each
      424    19571                  directive that allows a condition.  DDA$DO should not altret
      425    19572                  unless DDA$GO has been called during the processing of a
      426    19573                  directive.  This is very important.  An altret by DDA$DO
      427    19574                  is the signal for DDA$DELTA to transfer control to the
      428    19575                  user (or monitor if XDELTA).
      429    19576
      430    19577        */
      431    19578    1        S_D.DO_CALLED = '1'B;

  19578  2 000002   400000 236003                    LDQ     -131072,DU
         2 000003   000000 470400 xsym               LDP0    S_D$
         2 000004   005315 756100                    STQ     2765,,PR0

      432    19579    1        CODE = S_D.DO$->ALL_ATTACH.CMD;

  19579  2 000005   000031 471500                    LDP1    25,,PR0
         2 000006   100000 236100                    LDQ     0,,PR1
         2 000007   000033 772000                    QRL     27
         2 000010   200003 756100                    STQ     CODE,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:91   
      433    19580    1        IF CODE ~= 12 AND CODE ~= 80 AND CODE ~= 81 /* C_HELP, C_QMARK1, C_QMARK2 */

  19580  2 000011   000014 116007                    CMPQ    12,DL
         2 000012   000020 600000 2                  TZE     s:19582
         2 000013   000120 116007                    CMPQ    80,DL
         2 000014   000020 600000 2                  TZE     s:19582
         2 000015   000121 116007                    CMPQ    81,DL
         2 000016   000020 600000 2                  TZE     s:19582

      434    19581    1        THEN S_D.HELPING = '0'B;

  19581  2 000017   005252 450100                    STZ     2730,,PR0

      435    19582    1        S_D.ERROR = 0;

  19582  2 000020   000013 450100                    STZ     11,,PR0

      436    19583    1        S_D.STEP = '0'B;

  19583  2 000021   000722 450100                    STZ     466,,PR0

      437    19584    1        S_D.STOP = '0'B;

  19584  2 000022   000050 450100                    STZ     40,,PR0

      438    19585    2        DO CASE(CODE);

  19585  2 000023   000134 116007                    CMPQ    92,DL
         2 000024   000026 602006 2                  TNC     s:19585+3,QL
         2 000025   011442 710000 2                  TRA     s:21425
         2 000026   011442 710000 2                  TRA     s:21425
         2 000027   000162 710000 2                  TRA     s:19587
         2 000030   001664 710000 2                  TRA     s:19870
         2 000031   001672 710000 2                  TRA     s:19873
         2 000032   003571 710000 2                  TRA     s:20217
         2 000033   003667 710000 2                  TRA     s:20244
         2 000034   003707 710000 2                  TRA     s:20251
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:92   
         2 000035   003727 710000 2                  TRA     s:20256
         2 000036   004177 710000 2                  TRA     s:20308
         2 000037   011304 710000 2                  TRA     s:21380
         2 000040   004337 710000 2                  TRA     s:20357
         2 000041   004452 710000 2                  TRA     s:20390
         2 000042   005145 710000 2                  TRA     s:20564
         2 000043   005156 710000 2                  TRA     s:20571
         2 000044   011442 710000 2                  TRA     s:21425
         2 000045   002063 710000 2                  TRA     s:19926
         2 000046   004411 710000 2                  TRA     s:20378
         2 000047   005176 710000 2                  TRA     s:20576
         2 000050   007340 710000 2                  TRA     s:21001
         2 000051   000165 710000 2                  TRA     s:19590
         2 000052   005226 710000 2                  TRA     s:20586
         2 000053   002006 710000 2                  TRA     s:19904
         2 000054   005246 710000 2                  TRA     s:20591
         2 000055   011442 710000 2                  TRA     s:21425
         2 000056   005771 710000 2                  TRA     s:20714
         2 000057   005723 710000 2                  TRA     s:20702
         2 000060   007567 710000 2                  TRA     s:21055
         2 000061   005324 710000 2                  TRA     s:20608
         2 000062   005461 710000 2                  TRA     s:20638
         2 000063   005410 710000 2                  TRA     s:20626
         2 000064   005570 710000 2                  TRA     s:20667
         2 000065   005576 710000 2                  TRA     s:20670
         2 000066   005604 710000 2                  TRA     s:20673
         2 000067   004014 710000 2                  TRA     s:20277
         2 000070   005612 710000 2                  TRA     s:20676
         2 000071   004043 710000 2                  TRA     s:20284
         2 000072   005620 710000 2                  TRA     s:20679
         2 000073   003640 710000 2                  TRA     s:20236
         2 000074   005461 710000 2                  TRA     s:20638
         2 000075   006050 710000 2                  TRA     s:20735
         2 000076   011226 710000 2                  TRA     s:21354
         2 000077   002060 710000 2                  TRA     s:19924
         2 000100   006317 710000 2                  TRA     s:20801
         2 000101   006514 710000 2                  TRA     s:20847
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:93   
         2 000102   007145 710000 2                  TRA     s:20945
         2 000103   007412 710000 2                  TRA     s:21022
         2 000104   011442 710000 2                  TRA     s:21425
         2 000105   011442 710000 2                  TRA     s:21425
         2 000106   011442 710000 2                  TRA     s:21425
         2 000107   011442 710000 2                  TRA     s:21425
         2 000110   000165 710000 2                  TRA     s:19590
         2 000111   000165 710000 2                  TRA     s:19590
         2 000112   000165 710000 2                  TRA     s:19590
         2 000113   011442 710000 2                  TRA     s:21425
         2 000114   011442 710000 2                  TRA     s:21425
         2 000115   006400 710000 2                  TRA     s:20821
         2 000116   005437 710000 2                  TRA     s:20633
         2 000117   007205 710000 2                  TRA     s:20955
         2 000120   000663 710000 2                  TRA     s:19696
         2 000121   001166 710000 2                  TRA     s:19759
         2 000122   003647 710000 2                  TRA     s:20239
         2 000123   007547 710000 2                  TRA     s:21050
         2 000124   005354 710000 2                  TRA     s:20615
         2 000125   003546 710000 2                  TRA     s:20209
         2 000126   010325 710000 2                  TRA     s:21174
         2 000127   005530 710000 2                  TRA     s:20657
         2 000130   007124 710000 2                  TRA     s:20940
         2 000131   011276 710000 2                  TRA     s:21377
         2 000132   011423 710000 2                  TRA     s:21414
         2 000133   011442 710000 2                  TRA     s:21425
         2 000134   005374 710000 2                  TRA     s:20620
         2 000135   005176 710000 2                  TRA     s:20576
         2 000136   006277 710000 2                  TRA     s:20796
         2 000137   005700 710000 2                  TRA     s:20695
         2 000140   001062 710000 2                  TRA     s:19737
         2 000141   010305 710000 2                  TRA     s:21169
         2 000142   004246 710000 2                  TRA     s:20327
         2 000143   007420 710000 2                  TRA     s:21025
         2 000144   002126 710000 2                  TRA     s:19937
         2 000145   007477 710000 2                  TRA     s:21039
         2 000146   005145 710000 2                  TRA     s:20564
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:94   
         2 000147   005145 710000 2                  TRA     s:20564
         2 000150   002103 710000 2                  TRA     s:19931
         2 000151   007254 710000 2                  TRA     s:20979
         2 000152   007617 710000 2                  TRA     s:21062
         2 000153   007165 710000 2                  TRA     s:20950
         2 000154   004074 710000 2                  TRA     s:20293
         2 000155   007634 710000 2                  TRA     s:21066
         2 000156   005751 710000 2                  TRA     s:20709
         2 000157   002146 710000 2                  TRA     s:19942
         2 000160   010043 710000 2                  TRA     s:21110
         2 000161   005550 710000 2                  TRA     s:20662

      439    19586    2          CASE(1);                  /* ABBREV */

      440    19587    2             S_D.ERROR = 503;         /* E@NOTIMP */

  19587  2 000162   000767 235007                    LDA     503,DL
         2 000163   000013 755100                    STA     11,,PR0
         2 000164   011447 710000 2                  TRA     NOGO

      441    19588    2          CASE(19, 50, 51, 52);

      442    19589                                           /* C_ACTIVE, INACTIVE, SILENT, UNSILENT */
      443    19590    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(ACTIVE$CMD));

  19590  2 000165   000031 236100                    LDQ     25,,PR0
         2 000166   000003 036003                    ADLQ    3,DU
         2 000167   000044 756100                    STQ     36,,PR0

      444    19591    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  19591  2 000170   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 000171   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 000172   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 000173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000174   000000 701000 xent               TSX1    DDA$IF
         2 000175   011466 702000 2                  TSX2    ERR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:95   

      445    19592    2             IF NOGO_BIT THEN RETURN;

  19592  2 000176   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 000177   000201 605000 2                  TPL     s:19594

  19592  2 000200   000000 702200 xent               TSX2  ! X66_ARET

      446    19593                            /* Make sure there is a stored command in range specified */
      447    19594    2             I = S_D.DO$ -> ACTIVE$CMD.ID_FROM;

  19594  2 000201   000000 470400 xsym               LDP0    S_D$
         2 000202   000031 471500                    LDP1    25,,PR0
         2 000203   100001 236100                    LDQ     1,,PR1
         2 000204   000033 772000                    QRL     27
         2 000205   200005 756100                    STQ     I,,AUTO

      448    19595    2             NO_COMMANDS = '1'B;

  19595  2 000206   400000 236003                    LDQ     -131072,DU
         2 000207   200031 756100                    STQ     NO_COMMANDS,,AUTO

      449    19596    3             DO WHILE (NO_COMMANDS) AND

  19596  2 000210   000223 710000 2                  TRA     s:19601

      450    19597    3               (I <= S_D.DO$ -> ACTIVE$CMD.ID_TO);
      451    19598    3                  IF S_D.FIXCOM.CMD(I) ~= 0

  19598  2 000211   200005 236100                    LDQ     I,,AUTO
         2 000212   000006 402007                    MPY     6,DL
         2 000213   000000 470400 xsym               LDP0    S_D$
         2 000214   001212 236106                    LDQ     650,QL,PR0
         2 000215   777000 316003                    CANQ    -512,DU
         2 000216   000220 600000 2                  TZE     s:19600

      452    19599    3                  THEN NO_COMMANDS = '0'B;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:96   

  19599  2 000217   200031 450100                    STZ     NO_COMMANDS,,AUTO

      453    19600    3                  I = I + 1;

  19600  2 000220   200005 235100                    LDA     I,,AUTO
         2 000221   000001 035007                    ADLA    1,DL
         2 000222   200005 755100                    STA     I,,AUTO

      454    19601    3                END;

  19601  2 000223   200031 234100                    SZN     NO_COMMANDS,,AUTO
         2 000224   000233 605000 2                  TPL     s:19602
         2 000225   000031 471500                    LDP1    25,,PR0
         2 000226   100001 236100                    LDQ     1,,PR1
         2 000227   000022 772000                    QRL     18
         2 000230   000777 376007                    ANQ     511,DL
         2 000231   200005 116100                    CMPQ    I,,AUTO
         2 000232   000211 603000 2                  TRC     s:19598

      455    19602    2             IF NO_COMMANDS

  19602  2 000233   200031 234100                    SZN     NO_COMMANDS,,AUTO
         2 000234   000317 605000 2                  TPL     s:19615

      456    19603    3             THEN DO;

      457    19604    4                  DO CASE (S_D.DO$ -> ACTIVE$CMD.CMD);

  19604  2 000235   000031 471500                    LDP1    25,,PR0
         2 000236   100000 236100                    LDQ     0,,PR1
         2 000237   000033 772000                    QRL     27
         2 000240   000023 136007                    SBLQ    19,DL
         2 000241   000042 116007                    CMPQ    34,DL
         2 000242   000244 602006 2                  TNC     s:19604+7,QL
         2 000243   000314 710000 2                  TRA     s:19610
         2 000244   000306 710000 2                  TRA     s:19606
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:97   
         2 000245   000314 710000 2                  TRA     s:19610
         2 000246   000314 710000 2                  TRA     s:19610
         2 000247   000314 710000 2                  TRA     s:19610
         2 000250   000314 710000 2                  TRA     s:19610
         2 000251   000314 710000 2                  TRA     s:19610
         2 000252   000314 710000 2                  TRA     s:19610
         2 000253   000314 710000 2                  TRA     s:19610
         2 000254   000314 710000 2                  TRA     s:19610
         2 000255   000314 710000 2                  TRA     s:19610
         2 000256   000314 710000 2                  TRA     s:19610
         2 000257   000314 710000 2                  TRA     s:19610
         2 000260   000314 710000 2                  TRA     s:19610
         2 000261   000314 710000 2                  TRA     s:19610
         2 000262   000314 710000 2                  TRA     s:19610
         2 000263   000314 710000 2                  TRA     s:19610
         2 000264   000314 710000 2                  TRA     s:19610
         2 000265   000314 710000 2                  TRA     s:19610
         2 000266   000314 710000 2                  TRA     s:19610
         2 000267   000314 710000 2                  TRA     s:19610
         2 000270   000314 710000 2                  TRA     s:19610
         2 000271   000314 710000 2                  TRA     s:19610
         2 000272   000314 710000 2                  TRA     s:19610
         2 000273   000314 710000 2                  TRA     s:19610
         2 000274   000314 710000 2                  TRA     s:19610
         2 000275   000314 710000 2                  TRA     s:19610
         2 000276   000314 710000 2                  TRA     s:19610
         2 000277   000314 710000 2                  TRA     s:19610
         2 000300   000314 710000 2                  TRA     s:19610
         2 000301   000314 710000 2                  TRA     s:19610
         2 000302   000314 710000 2                  TRA     s:19610
         2 000303   000306 710000 2                  TRA     s:19606
         2 000304   000311 710000 2                  TRA     s:19608
         2 000305   000311 710000 2                  TRA     s:19608

      458    19605    4                    CASE (19, 50); /* C_ACTIVE, C_INACTIVE */

      459    19606    4                       S_D.ERROR = 247; /* E@NO_STORED_COMMANDS */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:98   

  19606  2 000306   000367 235007                    LDA     247,DL
         2 000307   000013 755100                    STA     11,,PR0
         2 000310   000316 710000 2                  TRA     s:19612

      460    19607    4                    CASE (51, 52); /* C_SILENT, C_UNSILENT */

      461    19608    4                       S_D.ERROR = 248; /* E@NO_SUCH_BREAKPOINTS */

  19608  2 000311   000370 235007                    LDA     248,DL
         2 000312   000013 755100                    STA     11,,PR0
         2 000313   000316 710000 2                  TRA     s:19612

      462    19609    4                    CASE (ELSE);

      463    19610    4                       S_D.ERROR = 502; /* E@DELBUG */

  19610  2 000314   000766 235007                    LDA     502,DL
         2 000315   000013 755100                    STA     11,,PR0

      464    19611    4                    END;

      465    19612    3                  GOTO ERR;

  19612  2 000316   011466 710000 2                  TRA     ERR

      466    19613    3                END;
      467    19614    3             ELSE DO;

      468    19615    4                  DO I = S_D.DO$->ACTIVE$CMD.ID_FROM TO S_D.DO$->ACTIVE$CMD.ID_TO   ;

  19615  2 000317   000031 471500                    LDP1    25,,PR0
         2 000320   100001 236100                    LDQ     1,,PR1
         2 000321   000033 772000                    QRL     27
         2 000322   200005 756100                    STQ     I,,AUTO
         2 000323   000653 710000 2                  TRA     AISU_END+3

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:99   
      469    19616    4                       IF S_D.FIXCOM.CMD(I) = 45 /* C_SAVE */

  19616  2 000324   200005 236100                    LDQ     I,,AUTO
         2 000325   000006 402007                    MPY     6,DL
         2 000326   000000 470400 xsym               LDP0    S_D$
         2 000327   001212 236106                    LDQ     650,QL,PR0
         2 000330   777000 376003                    ANQ     -512,DU
         2 000331   055000 116003                    CMPQ    23040,DU
         2 000332   000650 600000 2                  TZE     AISU_END

      470    19617    4                       THEN GOTO AISU_END;
      471    19618    4                       IF S_D.DO$->ACTIVE$CMD.CMD = 19

  19618  2 000333   000031 471500                    LDP1    25,,PR0
         2 000334   100000 236100                    LDQ     0,,PR1
         2 000335   777000 376003                    ANQ     -512,DU
         2 000336   023000 116003                    CMPQ    9728,DU
         2 000337   000454 601000 2                  TNZ     s:19650

      472    19619    5                       THEN DO;

      473    19620    5                            S_D.FIXCOM.INACTIVE(I) = '0'B; /* C_ACTIVE */

  19620  2 000340   200005 236100                    LDQ     I,,AUTO
         2 000341   000006 402007                    MPY     6,DL
         2 000342   000000 620006                    EAX0    0,QL
         2 000343   000000 236000 3                  LDQ     0
         2 000344   001212 356110                    ANSQ    650,X0,PR0

      474    19621    5                            IF S_D.FIXCOM.FPRG(I)

  19621  2 000345   200005 236100                    LDQ     I,,AUTO
         2 000346   000006 402007                    MPY     6,DL
         2 000347   001212 236106                    LDQ     650,QL,PR0
         2 000350   000002 316003                    CANQ    2,DU
         2 000351   000617 600000 2                  TZE     s:19684

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:100  
      475    19622    6                            THEN DO;

      476    19623                  /* Find the correct FPRG context and set up the breakpoint entry */
      477    19624    6                                 TFPRG$ = S_D.FPRG_CONTEXT$;

  19624  2 000352   000076 236100                    LDQ     62,,PR0
         2 000353   200041 756100                    STQ     TFPRG$,,AUTO

      478    19625    6                                 IF TFPRG$ = ADDR(NIL)

  19625  2 000354   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000355   011537 600000 2                  TZE     FPRG_ERR

      479    19626    6                                 THEN GOTO FPRG_ERR;
      480    19627    6                                 RES = S_D.FIXCOM.FPRG_RES(I);

  19627  2 000356   200005 236100                    LDQ     I,,AUTO
         2 000357   000030 402007                    MPY     24,DL
         2 000360   040100 100506                    MLR     fill='040'O
         2 000361   001215 000010                    ADSC9   653,Q,PR0                cn=0,n=8
         2 000362   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

      481    19628    6                                 RES_SIZE = S_D.FIXCOM.FPRG_RES_SIZE(I);

  19628  2 000363   200005 236100                    LDQ     I,,AUTO
         2 000364   000006 402007                    MPY     6,DL
         2 000365   001217 235106                    LDA     655,QL,PR0
         2 000366   200035 755100                    STA     RES_SIZE,,AUTO

      482    19629    7                                 DO WHILE (SUBSTR(RES, 0, RES_SIZE) ~= SUBSTR(TFPRG$->
             19629                                          FPRG$CONTEXT.RES,

  19629  2 000367   000375 710000 2                  TRA     s:19634

      483    19630    7                                   0, TFPRG$->FPRG$CONTEXT.RES_SIZE));
      484    19631    7                                      TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:101  
  19631  2 000370   200041 470500                    LDP0    TFPRG$,,AUTO
         2 000371   000000 236100                    LDQ     0,,PR0
         2 000372   200041 756100                    STQ     TFPRG$,,AUTO

      485    19632    7                                      IF TFPRG$ = ADDR(NIL)

  19632  2 000373   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000374   011537 600000 2                  TZE     FPRG_ERR

      486    19633    7                                      THEN GOTO FPRG_ERR;
      487    19634    7                                    END;

  19634  2 000375   200041 470500                    LDP0    TFPRG$,,AUTO
         2 000376   000004 720100                    LXL0    4,,PR0
         2 000377   200035 721100                    LXL1    RES_SIZE,,AUTO
         2 000400   040140 106540                    CMPC    fill='040'O
         2 000401   200033 000011                    ADSC9   RES,,AUTO                cn=0,n=*X1
         2 000402   000002 000010                    ADSC9   2,,PR0                   cn=0,n=*X0
         2 000403   000370 601000 2                  TNZ     s:19631

      488    19635    6                                 II = 1;

  19635  2 000404   000001 235007                    LDA     1,DL
         2 000405   200006 755100                    STA     II,,AUTO

      489    19636    7                                 DO WHILE (TFPRG$->FPRG$CONTEXT.FIXCOM_INDEX(II) ~= 0

  19636  2 000406   000412 710000 2                  TRA     s:19639

      490    19637    7                                   AND II <= 20);
      491    19638    7                                      II = II + 1;

  19638  2 000407   200006 235100                    LDA     II,,AUTO
         2 000410   000001 035007                    ADLA    1,DL
         2 000411   200006 755100                    STA     II,,AUTO

      492    19639    7                                    END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:102  

  19639  2 000412   200041 470500                    LDP0    TFPRG$,,AUTO
         2 000413   000034 235105                    LDA     28,AL,PR0
         2 000414   000420 600000 2                  TZE     s:19640
         2 000415   200006 235100                    LDA     II,,AUTO
         2 000416   000025 115007                    CMPA    21,DL
         2 000417   000407 602000 2                  TNC     s:19638

      493    19640    6                                 IF II > 20

  19640  2 000420   200006 235100                    LDA     II,,AUTO
         2 000421   000025 115007                    CMPA    21,DL
         2 000422   000427 602000 2                  TNC     s:19645

      494    19641    7                                 THEN DO;

      495    19642    7                                      S_D.ERROR = 288; /* E@TOOMANYBKPNTS */

  19642  2 000423   000440 236007                    LDQ     288,DL
         2 000424   000000 471400 xsym               LDP1    S_D$
         2 000425   100013 756100                    STQ     11,,PR1

      496    19643    7                                      GOTO ERR;

  19643  2 000426   011466 710000 2                  TRA     ERR

      497    19644    7                                    END;
      498    19645    6                                 TFPRG$ -> FPRG$CONTEXT.FIXCOM_INDEX(II) = I;

  19645  2 000427   200005 236100                    LDQ     I,,AUTO
         2 000430   000034 756105                    STQ     28,AL,PR0

      499    19646    6                                 FATT$ = PINCRW(S_D.VARCOM$, S_D.FIXCOM.FAI(I));

  19646  2 000431   200005 236100                    LDQ     I,,AUTO
         2 000432   000006 402007                    MPY     6,DL
         2 000433   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:103  
         2 000434   001214 720106                    LXL0    652,QL,PR0
         2 000435   004622 471500                    LDP1    2450,,PR0
         2 000436   100000 633510                    EPPR3   0,X0,PR1
         2 000437   200045 453500                    STP3    FATT$,,AUTO

      500    19647    6                                CALL DFA$SET_AT (II, FATT$ -> AT_FIRST.BYPASS_COUNT, I
             19647                                          ) ALTRET(NOGO);

  19647  2 000440   200005 634500                    EPPR4   I,,AUTO
         2 000441   200544 454500                    STP4    @WHICH_ONE+3,,AUTO
         2 000442   200045 236100                    LDQ     FATT$,,AUTO
         2 000443   000004 036003                    ADLQ    4,DU
         2 000444   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 000445   200006 635500                    EPPR5   II,,AUTO
         2 000446   200542 455500                    STP5    @WHICH_ONE+1,,AUTO
         2 000447   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 000450   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000451   000000 701000 xent               TSX1    DFA$SET_AT
         2 000452   011447 702000 2                  TSX2    NOGO

      501    19648    6                               END;

      502    19649    5                          END;

  19649  2 000453   000617 710000 2                  TRA     s:19684

      503    19650    4                       ELSE IF S_D.DO$->ACTIVE$CMD.CMD = 50 /*C_INACTIVE*/

  19650  2 000454   062000 116003                    CMPQ    25600,DU
         2 000455   000602 601000 2                  TNZ     s:19681

      504    19651    5                            THEN DO;

      505    19652    5                                 IF S_D.IXFIX = I

  19652  2 000456   000015 236100                    LDQ     13,,PR0
         2 000457   000465 604000 2                  TMI     s:19657
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:104  
         2 000460   200005 116100                    CMPQ    I,,AUTO
         2 000461   000465 601000 2                  TNZ     s:19657

      506    19653    6                                 THEN DO;

      507    19654    6                                      S_D.FAULTCMD$ = ADDR(NIL);

  19654  2 000462   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000463   000004 756100                    STQ     4,,PR0

      508    19655    6                                      S_D.ENTRYCMD$ = ADDR(NIL);

  19655  2 000464   005203 756100                    STQ     2691,,PR0

      509    19656    6                                    END;

      510    19657    5                                 IF S_D.FIXCOM.FPRG(I)

  19657  2 000465   200005 236100                    LDQ     I,,AUTO
         2 000466   000006 402007                    MPY     6,DL
         2 000467   001212 236106                    LDQ     650,QL,PR0
         2 000470   000002 316003                    CANQ    2,DU
         2 000471   000510 600000 2                  TZE     s:19662

      511    19658    6                                 THEN DO;

      512    19659    6                                      S_D.KILL1 = I;

  19659  2 000472   200005 235100                    LDA     I,,AUTO
         2 000473   000063 755100                    STA     51,,PR0

      513    19660    6                                      CALL DFA$KILL1('1'B, S_D.FIXCOM.CMD(I), '0'B);

  19660  2 000474   000001 236000 3                  LDQ     1
         2 000475   200544 756100                    STQ     @WHICH_ONE+3,,AUTO
         2 000476   200005 236100                    LDQ     I,,AUTO
         2 000477   000006 402003                    MPY     6,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:105  
         2 000500   001212 036003                    ADLQ    650,DU
         2 000501   000000 036000 xsym               ADLQ    S_D$
         2 000502   000002 235000 3                  LDA     2
         2 000503   200542 757100                    STAQ    @WHICH_ONE+1,,AUTO
         2 000504   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 000505   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000506   000000 701000 xent               TSX1    DFA$KILL1
         2 000507   000000 011000                    NOP     0

      514    19661    6                                    END;

      515    19662    5                                 S_D.FIXCOM.INACTIVE(I) = '1'B;

  19662  2 000510   200005 236100                    LDQ     I,,AUTO
         2 000511   000006 402007                    MPY     6,DL
         2 000512   000000 470400 xsym               LDP0    S_D$
         2 000513   000000 620006                    EAX0    0,QL
         2 000514   000400 236003                    LDQ     256,DU
         2 000515   001212 256110                    ORSQ    650,X0,PR0

      516    19663    5                                 IF S_D.FIXCOM.CMD(I) = 67 /* C_WHEN */

  19663  2 000516   200005 236100                    LDQ     I,,AUTO
         2 000517   000006 402007                    MPY     6,DL
         2 000520   001212 236106                    LDQ     650,QL,PR0
         2 000521   777000 376003                    ANQ     -512,DU
         2 000522   103000 116003                    CMPQ    34304,DU
         2 000523   000601 601000 2                  TNZ     ENDREST

      517    19664    6                                 THEN DO;

      518    19665    6                                      FATT$ = PINCRW(S_D.VARCOM$,S_D.FIXCOM.FAI(I));

  19665  2 000524   200005 236100                    LDQ     I,,AUTO
         2 000525   000006 402007                    MPY     6,DL
         2 000526   001214 720106                    LXL0    652,QL,PR0
         2 000527   004622 471500                    LDP1    2450,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:106  
         2 000530   100000 633510                    EPPR3   0,X0,PR1
         2 000531   200045 453500                    STP3    FATT$,,AUTO

      519    19666    7                                      IF S_D.OVERLAID THEN DO;

  19666  2 000532   004764 234100                    SZN     2548,,PR0
         2 000533   000556 605000 2                  TPL     s:19674

      520    19667    7                                           IF S_D.B$TREE$->B$TREE_NODE.FLGS.NOW_IN(
             19667                                                    FATT$->AT_FIRST.NODE)

  19667  2 000534   004767 474500                    LDP4    2551,,PR0
         2 000535   300003 236100                    LDQ     3,,PR3
         2 000536   000022 772000                    QRL     18
         2 000537   000006 402007                    MPY     6,DL
         2 000540   400001 234106                    SZN     1,QL,PR4
         2 000541   000550 605000 2                  TPL     s:19670

      521    19668    7                                           THEN S_D.FIXCOM.NOT_IN(I) = '0'B;

  19668  2 000542   200005 236100                    LDQ     I,,AUTO
         2 000543   000006 402007                    MPY     6,DL
         2 000544   000000 620006                    EAX0    0,QL
         2 000545   000003 236000 3                  LDQ     3
         2 000546   001212 356110                    ANSQ    650,X0,PR0
         2 000547   000556 710000 2                  TRA     s:19674

      522    19669    8                                           ELSE DO;

      523    19670    8                                                S_D.FIXCOM.NOT_IN(I) = '1'B;

  19670  2 000550   200005 236100                    LDQ     I,,AUTO
         2 000551   000006 402007                    MPY     6,DL
         2 000552   000000 620006                    EAX0    0,QL
         2 000553   000100 236003                    LDQ     64,DU
         2 000554   001212 256110                    ORSQ    650,X0,PR0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:107  
      524    19671    8                                                GOTO ENDREST;
             19671                                                         /* NOT IN, NOTHING ELSE TO DO */

  19671  2 000555   000601 710000 2                  TRA     ENDREST

      525    19672    8                                              END;
      526    19673    7                                         END;
      527    19674    6                                      IF S_D.FIXCOM.INACTIVE(I) THEN GOTO ENDREST;

  19674  2 000556   200005 236100                    LDQ     I,,AUTO
         2 000557   000006 402007                    MPY     6,DL
         2 000560   001212 236106                    LDQ     650,QL,PR0
         2 000561   000400 316003                    CANQ    256,DU
         2 000562   000601 601000 2                  TNZ     ENDREST

      528    19675    6                                      FPT$SSC.V.VPNO# = WHEN.START_PAGE;

  19675  2 000563   300020 220100                    LDX0    16,,PR3
         2 000564   200365 440100                    SXL0    FPT$SSC+3,,AUTO

      529    19676    6                                      FPT$SSC.V.NUMPGS# = 1+ WHEN.END_PAGE - WHEN.
             19676                                               START_PAGE;

  19676  2 000565   300020 236100                    LDQ     16,,PR3
         2 000566   000022 772000                    QRL     18
         2 000567   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 000570   300020 236100                    LDQ     16,,PR3
         2 000571   777777 376007                    ANQ     -1,DL
         2 000572   200542 136100                    SBLQ    @WHICH_ONE+1,,AUTO
         2 000573   000001 621006                    EAX1    1,QL
         2 000574   200365 741100                    STX1    FPT$SSC+3,,AUTO

      530    19677    6                                      CALL M$SSC (FPT$SSC) ALTRET(ERRMSG);

  19677  2 000575   200362 630500                    EPPR0   FPT$SSC,,AUTO
         2 000576   430013 713400                    CLIMB   alt,+12299
         2 000577   400000 401760                    pmme    nvectors=1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:108  
         2 000600   011552 702000 2                  TSX2    ERRMSG

      531    19678    6                                    END;

  19675  2 000601                       ENDREST      null
      532    19679    5   ENDREST:                      ;
      533    19680    5                               END;

  19680  2 000601   000617 710000 2                  TRA     s:19684

      534    19681    4                            ELSE IF S_D.DO$->ACTIVE$CMD.CMD = 51

  19681  2 000602   063000 116003                    CMPQ    26112,DU
         2 000603   000612 601000 2                  TNZ     s:19683

      535    19682    4                                 THEN S_D.FIXCOM.SILENT(I) = '1'B; /* C_SILENT */

  19682  2 000604   200005 236100                    LDQ     I,,AUTO
         2 000605   000006 402007                    MPY     6,DL
         2 000606   000000 620006                    EAX0    0,QL
         2 000607   000200 236003                    LDQ     128,DU
         2 000610   001212 256110                    ORSQ    650,X0,PR0
         2 000611   000617 710000 2                  TRA     s:19684

      536    19683    4                                 ELSE S_D.FIXCOM.SILENT(I) = '0'B; /* UNSILENT */

  19683  2 000612   200005 236100                    LDQ     I,,AUTO
         2 000613   000006 402007                    MPY     6,DL
         2 000614   000000 620006                    EAX0    0,QL
         2 000615   000004 236000 3                  LDQ     4
         2 000616   001212 356110                    ANSQ    650,X0,PR0

      537    19684    4                       IF S_D.FIXCOM.CMD(I) = 53

  19684  2 000617   200005 236100                    LDQ     I,,AUTO
         2 000620   000006 402007                    MPY     6,DL
         2 000621   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:109  
         2 000622   001212 236106                    LDQ     650,QL,PR0
         2 000623   777000 376003                    ANQ     -512,DU
         2 000624   065000 116003                    CMPQ    27136,DU
         2 000625   000650 601000 2                  TNZ     AISU_END

      538    19685    4                       THEN IF S_D.DO$->ACTIVE$CMD.CMD = 19 /*C_ACTIVE*/

  19685  2 000626   000031 471500                    LDP1    25,,PR0
         2 000627   100000 236100                    LDQ     0,,PR1
         2 000630   777000 376003                    ANQ     -512,DU
         2 000631   023000 116003                    CMPQ    9728,DU
         2 000632   000641 601000 2                  TNZ     s:19688
         2 000633   004630 234100                    SZN     2456,,PR0
         2 000634   000641 604000 2                  TMI     s:19688

      539    19686    4                              AND S_D.TR$INFO.ACTIVE = '0'B
      540    19687    4                            THEN CALL DDA$TRACEON;

  19687  2 000635   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000636   000000 701000 xent               TSX1    DDA$TRACEON
         2 000637   000000 011000                    NOP     0
         2 000640   000650 710000 2                  TRA     AISU_END

      541    19688    4                            ELSE IF S_D.DO$->ACTIVE$CMD.CMD = 50 /*C_INAVTIVE*/

  19688  2 000641   062000 116003                    CMPQ    25600,DU
         2 000642   000650 601000 2                  TNZ     AISU_END
         2 000643   004630 234100                    SZN     2456,,PR0
         2 000644   000650 605000 2                  TPL     AISU_END

      542    19689    4                                   AND S_D.TR$INFO.ACTIVE = '1'B
      543    19690    4                                 THEN CALL DDT$TRACEOFF;

  19690  2 000645   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000646   000000 701000 xent               TSX1    DDT$TRACEOFF
         2 000647   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:110  
      544    19691    4                                 ELSE ;
      545    19692    4   AISU_END:
      546    19693    4                     END;                  /* DO I */

  19693  2 000650   200005 235100       AISU_END     LDA     I,,AUTO
         2 000651   000001 035007                    ADLA    1,DL
         2 000652   200005 755100                    STA     I,,AUTO
         2 000653   000000 470400 xsym               LDP0    S_D$
         2 000654   000031 471500                    LDP1    25,,PR0
         2 000655   100001 236100                    LDQ     1,,PR1
         2 000656   000022 772000                    QRL     18
         2 000657   000777 376007                    ANQ     511,DL
         2 000660   200005 116100                    CMPQ    I,,AUTO
         2 000661   000324 603000 2                  TRC     s:19616

      547    19694    3                END;

  19694  2 000662   011447 710000 2                  TRA     NOGO

      548    19695    2          CASE(58);                    /* ALIB */

      549    19696    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  19696  2 000663   006714 235100                    LDA     3532,,PR0
         2 000664   000002 115007                    CMPA    2,DL
         2 000665   011543 600000 2                  TZE     NOTIMPFPRG

      550    19697    2             THEN GOTO NOTIMPFPRG;
      551    19698    2             IF NOT S_D.ALIB

  19698  2 000666   005134 234100                    SZN     2652,,PR0
         2 000667   000673 604000 2                  TMI     s:19703

      552    19699    3             THEN DO;

      553    19700    3                  S_D.ERROR = 238;  /* E@CANTALIB */

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:111  
  19700  2 000670   000356 235007                    LDA     238,DL
         2 000671   000013 755100                    STA     11,,PR0

      554    19701    3                  GOTO ERR;

  19701  2 000672   011466 710000 2                  TRA     ERR

      555    19702    3                END;
      556    19703    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALIB$CMD ) );

  19703  2 000673   000031 236100                    LDQ     25,,PR0
         2 000674   000003 036003                    ADLQ    3,DU
         2 000675   000044 756100                    STQ     36,,PR0

      557    19704    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  19704  2 000676   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 000677   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 000700   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 000701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000702   000000 701000 xent               TSX1    DDA$IF
         2 000703   011466 702000 2                  TSX2    ERR

      558    19705    2             IF NOGO_BIT THEN RETURN;

  19705  2 000704   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 000705   000707 605000 2                  TPL     s:19706

  19705  2 000706   000000 702200 xent               TSX2  ! X66_ARET

      559    19706    2             IF S_D.DO$ -> ALIB$CMD.CODE = 85 AND S_D.LAST_ERROR='0'B /* C@RETURN */

  19706  2 000707   000000 470400 xsym               LDP0    S_D$
         2 000710   000031 471500                    LDP1    25,,PR0
         2 000711   100001 236100                    LDQ     1,,PR1
         2 000712   777000 376003                    ANQ     -512,DU
         2 000713   125000 116003                    CMPQ    43520,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:112  
         2 000714   000722 601000 2                  TNZ     s:19708
         2 000715   005234 235100                    LDA     2716,,PR0
         2 000716   000722 601000 2                  TNZ     s:19708

      560    19707    2             THEN I = 2/*ALIB_RET*/;

  19707  2 000717   000002 235007                    LDA     2,DL
         2 000720   200005 755100                    STA     I,,AUTO
         2 000721   000724 710000 2                  TRA     s:19709

      561    19708    2             ELSE I = 1/*ALIB_ALT*/;

  19708  2 000722   000001 235007                    LDA     1,DL
         2 000723   200005 755100                    STA     I,,AUTO

      562    19709    2             IF S_D.DO$ -> ALIB$CMD.SUBCODE = 53 /* C@KEEP */

  19709  2 000724   100001 236100                    LDQ     1,,PR1
         2 000725   000777 376003                    ANQ     511,DU
         2 000726   000065 116003                    CMPQ    53,DU
         2 000727   000733 601000 2                  TNZ     s:19711

      563    19710    2             THEN NOT_IS = '1'B;

  19710  2 000730   400000 236003                    LDQ     -131072,DU
         2 000731   200022 756100                    STQ     NOT_IS,,AUTO
         2 000732   000734 710000 2                  TRA     s:19712

      564    19711    2             ELSE NOT_IS = '0'B;

  19711  2 000733   200022 450100                    STZ     NOT_IS,,AUTO

      565    19712    2             IF S_D.GHOST1

  19712  2 000734   000605 234100                    SZN     389,,PR0
         2 000735   001037 605000 2                  TPL     s:19731

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:113  
      566    19713    3             THEN DO;

      567    19714    3                  BUF$ = ADDR( S_D.OUTPUT );

  19714  2 000736   000000 236000 xsym               LDQ     S_D$
         2 000737   005335 036003                    ADLQ    2781,DU
         2 000740   200027 756100                    STQ     BUF$,,AUTO

      568    19715    3                  S_D.OUTPUT = ' ';

  19715  2 000741   040100 100400                    MLR     fill='040'O
         2 000742   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000743   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      569    19716    3                  CALL DDQ$WRITE( BUF$, 4 );

  19716  2 000744   000005 236000 3                  LDQ     5
         2 000745   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 000746   200027 631500                    EPPR1   BUF$,,AUTO
         2 000747   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 000750   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 000751   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000752   000000 701000 xent               TSX1    DDQ$WRITE
         2 000753   000000 011000                    NOP     0

      570    19717    3                  IF S_D.RUM_TOTAL_ERRORS = 0

  19717  2 000754   000000 470400 xsym               LDP0    S_D$
         2 000755   000515 235100                    LDA     333,,PR0
         2 000756   000773 601000 2                  TNZ     s:19723

      571    19718    4                  THEN DO;

      572    19719    4                       S_D.OUTPUT = '**** NO Total RUM errors encountered.';

  19719  2 000757   040100 100400                    MLR     fill='040'O
         2 000760   000571 000045 1                  ADSC9   AT+1                     cn=0,n=37
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:114  
         2 000761   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      573    19720    4                       CALL DDQ$WRITE( BUF$, LENGTHC(
             19720                                '**** NO Total RUM errors encountered.' ) );

  19720  2 000762   000007 236000 3                  LDQ     7
         2 000763   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 000764   200027 631500                    EPPR1   BUF$,,AUTO
         2 000765   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 000766   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 000767   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000770   000000 701000 xent               TSX1    DDQ$WRITE
         2 000771   000000 011000                    NOP     0

      574    19721    4                     END;

  19721  2 000772   001013 710000 2                  TRA     s:19727

      575    19722    4                  ELSE DO;

      576    19723    4                       S_D.OUTPUT = '**** 00000 Total RUM errors encountered.';

  19723  2 000773   040100 100400                    MLR     fill='040'O
         2 000774   000603 000050 1                  ADSC9   AT+11                    cn=0,n=40
         2 000775   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      577    19724    4                      CALL BINCHAR( SUBSTR( S_D.OUTPUT, 5, 5 ), S_D.RUM_TOTAL_ERRORS )
             19724                                ;

  19724  2 000776   000044 773000                    LRL     36
         2 000777   200542 757100                    STAQ    @WHICH_ONE+1,,AUTO
         2 001000   000100 301500                    BTD
         2 001001   200542 000010                    NDSC9   @WHICH_ONE+1,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         2 001002   005336 230005                    NDSC9   2782,,PR0                cn=1,s=nosgn,sf=0,n=5

      578    19725    4                       CALL DDQ$WRITE( BUF$, LENGTHC(
             19725                                '**** 00000 Total RUM errors encountered.' ) );
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:115  

  19725  2 001003   000011 236000 3                  LDQ     9
         2 001004   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 001005   200027 631500                    EPPR1   BUF$,,AUTO
         2 001006   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 001007   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001010   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001011   000000 701000 xent               TSX1    DDQ$WRITE
         2 001012   000000 011000                    NOP     0

      579    19726    4                     END;

      580    19727    3                  S_D.OUTPUT = ' ';

  19727  2 001013   000000 470400 xsym               LDP0    S_D$
         2 001014   040100 100400                    MLR     fill='040'O
         2 001015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001016   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      581    19728    3                  CALL DDQ$WRITE( BUF$, 4 );

  19728  2 001017   000005 236000 3                  LDQ     5
         2 001020   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 001021   200027 631500                    EPPR1   BUF$,,AUTO
         2 001022   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 001023   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001025   000000 701000 xent               TSX1    DDQ$WRITE
         2 001026   000000 011000                    NOP     0

      582    19729    3                  CALL DDQ$WRITE( BUF$, 4 );

  19729  2 001027   000005 236000 3                  LDQ     5
         2 001030   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 001031   200027 630500                    EPPR0   BUF$,,AUTO
         2 001032   200542 450500                    STP0    @WHICH_ONE+1,,AUTO
         2 001033   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:116  
         2 001034   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001035   000000 701000 xent               TSX1    DDQ$WRITE
         2 001036   000000 011000                    NOP     0

      583    19730    3                END;

      584    19731    2             CALL DUA$ALIB( I, NOT_IS ) ALTRET( ERR );

  19731  2 001037   200022 630500                    EPPR0   NOT_IS,,AUTO
         2 001040   200543 450500                    STP0    @WHICH_ONE+2,,AUTO
         2 001041   200005 631500                    EPPR1   I,,AUTO
         2 001042   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 001043   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001044   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001045   000000 701000 xent               TSX1    DUA$ALIB
         2 001046   011466 702000 2                  TSX2    ERR

      585    19732    2             IF S_D.S$TEP.ACTIVE

  19732  2 001047   000000 470400 xsym               LDP0    S_D$
         2 001050   005276 234100                    SZN     2750,,PR0
         2 001051   001056 605000 2                  TPL     s:19734

      586    19733    2             THEN CALL DDA$STEP_MORE ALTRET(ERR);

  19733  2 001052   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001053   000000 701000 xent               TSX1    DDA$STEP_MORE
         2 001054   011466 702000 2                  TSX2    ERR
         2 001055   001061 710000 2                  TRA     s:19735

      587    19734    2             ELSE CALL DDA$GO ALTRET(NOGO);

  19734  2 001056   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001057   000000 701000 xent               TSX1    DDA$GO
         2 001060   011447 702000 2                  TSX2    NOGO

      588    19735    2             ALTRETURN;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:117  

  19735  2 001061   000000 702200 xent               TSX2  ! X66_AALT

      589    19736    2          CASE(74);                  /* ALTVAR */

      590    19737    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DEF$CMD ) );

  19737  2 001062   000031 236100                    LDQ     25,,PR0
         2 001063   000012 036003                    ADLQ    10,DU
         2 001064   000044 756100                    STQ     36,,PR0

      591    19738    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  19738  2 001065   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 001066   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 001067   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001070   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001071   000000 701000 xent               TSX1    DDA$IF
         2 001072   011466 702000 2                  TSX2    ERR

      592    19739    2             IF NOGO_BIT THEN RETURN;

  19739  2 001073   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 001074   001076 605000 2                  TPL     s:19740

  19739  2 001075   000000 702200 xent               TSX2  ! X66_ARET

      593    19740    2             S_D.XSCH = '0'B;

  19740  2 001076   000000 470400 xsym               LDP0    S_D$
         2 001077   000100 100400                    MLR     fill='000'O
         2 001100   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001101   000751 000034                    ADSC9   489,,PR0                 cn=0,n=28

      594    19741    2             CALL DDS$SET_Q2T;

  19741  2 001102   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:118  
         2 001103   000000 701000 xent               TSX1    DDS$SET_Q2T
         2 001104   000000 011000                    NOP     0

      595    19742    2             IF S_D.DO$ -> DEF$CMD.ALTVAR

  19742  2 001105   000000 470400 xsym               LDP0    S_D$
         2 001106   000031 471500                    LDP1    25,,PR0
         2 001107   100001 234100                    SZN     1,,PR1
         2 001110   001114 605000 2                  TPL     s:19744

      596    19743    2             THEN S_D.XOU_NAME = S_D.DO$ -> DEF$CMD.TEXTC;

  19743  2 001111   000100 100500                    MLR     fill='000'O
         2 001112   100002 000040                    ADSC9   2,,PR1                   cn=0,n=32
         2 001113   001021 000040                    ADSC9   529,,PR0                 cn=0,n=32

      597    19744    2             CALL DDS$PD_SRCH( ADDR( S_D.XOU_NAME ), TEMP$ ) ALTRET( GOTXOU );

  19744  2 001114   000000 236000 xsym               LDQ     S_D$
         2 001115   001021 036003                    ADLQ    529,DU
         2 001116   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 001117   200025 631500                    EPPR1   TEMP$,,AUTO
         2 001120   200545 451500                    STP1    @WHICH_ONE+4,,AUTO
         2 001121   200542 633500                    EPPR3   @WHICH_ONE+1,,AUTO
         2 001122   200544 453500                    STP3    @WHICH_ONE+3,,AUTO
         2 001123   200544 630500                    EPPR0   @WHICH_ONE+3,,AUTO
         2 001124   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001125   000000 701000 xent               TSX1    DDS$PD_SRCH
         2 001126   001130 702000 2                  TSX2    GOTXOU

      598    19745    3             DO WHILE ( '0'B );

  19745  2 001127   001152 710000 2                  TRA     NOXOU

      599    19746    3   GOTXOU:
      600    19747    3                 CALL DDS$EQCS#( POFFW( TEMP$, S_D.EDEF$ ) / SIZEW( B$EDEF ) ) ALTRET(
             19747                           NOXOU );
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:119  

  19747  2 001130   000000 470400 xsym  GOTXOU       LDP0    S_D$
         2 001131   001042 236100                    LDQ     546,,PR0
         2 001132   000022 772000                    QRL     18
         2 001133   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 001134   200025 236100                    LDQ     TEMP$,,AUTO
         2 001135   000022 772000                    QRL     18
         2 001136   200542 136100                    SBLQ    @WHICH_ONE+1,,AUTO
         2 001137   000002 506007                    DIV     2,DL
         2 001140   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 001141   200543 631500                    EPPR1   @WHICH_ONE+2,,AUTO
         2 001142   200544 451500                    STP1    @WHICH_ONE+3,,AUTO
         2 001143   200544 630500                    EPPR0   @WHICH_ONE+3,,AUTO
         2 001144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001145   000000 701000 xent               TSX1    DDS$EQCS#
         2 001146   001152 702000 2                  TSX2    NOXOU

      601    19748    3                  CALL DDS$SET_Q2X ALTRET( NOXOU );

  19748  2 001147   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001150   000000 701000 xent               TSX1    DDS$SET_Q2X
         2 001151   001152 702000 2                  TSX2    NOXOU

      602    19749    3                END;

      603    19750    2   NOXOU:
      604    19751    2             CALL DDS$SET_T2Q;

  19751  2 001152   000002 631400 xsym  NOXOU        EPPR1   B_VECTNIL+2
         2 001153   000000 701000 xent               TSX1    DDS$SET_T2Q
         2 001154   000000 011000                    NOP     0

      605    19752    2             IF ( NOT S_D.XSCH.OK )

  19752  2 001155   000000 470400 xsym               LDP0    S_D$
         2 001156   000751 234100                    SZN     489,,PR0
         2 001157   011447 604000 2                  TMI     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:120  

      606    19753    3             THEN DO;

      607    19754    3                  S_D.ERROR_SYM$ = ADDR( S_D.DO$ -> DEF$CMD.TEXTC );

  19754  2 001160   000031 471500                    LDP1    25,,PR0
         2 001161   100002 633500                    EPPR3   2,,PR1
         2 001162   000032 453500                    STP3    26,,PR0

      608    19755    3                  S_D.ERROR = 167; /* E@NO_ALTVAR */

  19755  2 001163   000247 235007                    LDA     167,DL
         2 001164   000013 755100                    STA     11,,PR0

      609    19756    3                  GOTO ERR;

  19756  2 001165   011466 710000 2                  TRA     ERR

      610    19757    3                END;
      611    19758    2          CASE(59);                    /*C_ANLZ*/

      612    19759    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(ANLZ$CMD));

  19759  2 001166   000031 236100                    LDQ     25,,PR0
         2 001167   000042 036003                    ADLQ    34,DU
         2 001170   000044 756100                    STQ     36,,PR0

      613    19760    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  19760  2 001171   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 001172   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 001173   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001175   000000 701000 xent               TSX1    DDA$IF
         2 001176   011466 702000 2                  TSX2    ERR

      614    19761    2             IF NOGO_BIT THEN RETURN;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:121  

  19761  2 001177   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 001200   001202 605000 2                  TPL     s:19762

  19761  2 001201   000000 702200 xent               TSX2  ! X66_ARET

      615    19762    2             IF S_D.DO$ -> ANLZ$CMD.FANLZ

  19762  2 001202   000000 470400 xsym               LDP0    S_D$
         2 001203   000031 471500                    LDP1    25,,PR0
         2 001204   100001 236100                    LDQ     1,,PR1
         2 001205   040000 316003                    CANQ    16384,DU
         2 001206   001660 600000 2                  TZE     s:19868

      616    19763    3             THEN DO;

      617    19764    3                  IF S_D.RUM THEN CALL DUA$KILL_RUM;

  19764  2 001207   004755 234100                    SZN     2541,,PR0
         2 001210   001214 605000 2                  TPL     s:19765

  19764  2 001211   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001212   000000 701000 xent               TSX1    DUA$KILL_RUM
         2 001213   000000 011000                    NOP     0

      618    19765    3                  IF S_D.ANLZ THEN CALL DUA$KILL_ANLZ;

  19765  2 001214   000000 470400 xsym               LDP0    S_D$
         2 001215   004756 234100                    SZN     2542,,PR0
         2 001216   001222 605000 2                  TPL     s:19766

  19765  2 001217   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001220   000000 701000 xent               TSX1    DUA$KILL_ANLZ
         2 001221   000000 011000                    NOP     0

      619    19766    3                  IF S_D.DEBUG_CMD AND S_D.DEBUG_CMD_CONTEXT$ ~= ADDR(NIL)

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:122  
  19766  2 001222   000000 470400 xsym               LDP0    S_D$
         2 001223   004665 234100                    SZN     2485,,PR0
         2 001224   001234 605000 2                  TPL     s:19771
         2 001225   004666 236100                    LDQ     2486,,PR0
         2 001226   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001227   001234 600000 2                  TZE     s:19771

      620    19767    4                  THEN DO;

      621    19768    4                       S_D.CURRENT_FPRG_CONTEXT$ = S_D.DEBUG_CMD_CONTEXT$;

  19768  2 001230   000102 756100                    STQ     66,,PR0

      622    19769    4                       CALL DFA$KILL_DELTA;

  19769  2 001231   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001232   000000 701000 xent               TSX1    DFA$KILL_DELTA
         2 001233   000000 011000                    NOP     0

      623    19770    4                     END;

      624    19771    3                  IF S_D.DBGFEPDCB = 0

  19771  2 001234   000000 470400 xsym               LDP0    S_D$
         2 001235   005007 235100                    LDA     2567,,PR0
         2 001236   001251 601000 2                  TNZ     s:19777

      625    19772    4                  THEN DO;

      626    19773    4                       CALL DFA$GET_FPRG_DCB(DCBNO);

  19773  2 001237   200036 631500                    EPPR1   DCBNO,,AUTO
         2 001240   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 001241   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001243   000000 701000 xent               TSX1    DFA$GET_FPRG_DCB
         2 001244   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:123  

      627    19774    4                       S_D.DBGFEPDCB = DCBNO;

  19774  2 001245   000000 470400 xsym               LDP0    S_D$
         2 001246   200036 235100                    LDA     DCBNO,,AUTO
         2 001247   005007 755100                    STA     2567,,PR0

      628    19775    4                     END;

  19775  2 001250   001300 710000 2                  TRA     s:19786

      629    19776    4                  ELSE DO;

      630    19777    4                       IF DCBADDR(S_D.DBGFEPDCB) -> F$DCB.FCD#

  19777  2 001251   000012 471400 3                  LDP1    10
         2 001252   100000 473500                    LDP3    0,,PR1
         2 001253   005007 720100                    LXL0    2567,,PR0
         2 001254   300000 474510                    LDP4    0,X0,PR3
         2 001255   400031 236100                    LDQ     25,,PR4
         2 001256   020000 316007                    CANQ    8192,DL
         2 001257   001275 600000 2                  TZE     s:19784

      631    19778    5                       THEN DO;

      632    19779    5                            FPTCLOSE_DBG = FPT_CLOSE_DBG;

  19779  2 001260   000100 100400                    MLR     fill='000'O
         2 001261   000150 000170 1                  ADSC9   FPT_CLOSE_DBG            cn=0,n=120
         2 001262   200366 000170                    ADSC9   FPTCLOSE_DBG,,AUTO       cn=0,n=120

      633    19780    5                            FPTCLOSE_DBG.V_ = VECTOR(FPTCLOSE_DBG.V);

  19780  2 001263   000013 235000 3                  LDA     11
         2 001264   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001265   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001266   000420 036003                    ADLQ    272,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:124  
         2 001267   200366 757100                    STAQ    FPTCLOSE_DBG,,AUTO

      634    19781    5                            FPTCLOSE_DBG.V.DCB# = S_D.DBGFEPDCB;

  19781  2 001270   200420 740100                    STX0    FPTCLOSE_DBG+26,,AUTO

      635    19782    5                            CALL M$CLOSE (FPTCLOSE_DBG) ALTRET(ERRMSG);

  19782  2 001271   200366 630500                    EPPR0   FPTCLOSE_DBG,,AUTO
         2 001272   450001 713400                    CLIMB   alt,close
         2 001273   406000 401760                    pmme    nvectors=13
         2 001274   011552 702000 2                  TSX2    ERRMSG

      636    19783    5                          END;

      637    19784    4                       DCBNO = S_D.DBGFEPDCB;

  19784  2 001275   000000 470400 xsym               LDP0    S_D$
         2 001276   005007 235100                    LDA     2567,,PR0
         2 001277   200036 755100                    STA     DCBNO,,AUTO

      638    19785    4                     END;

      639    19786    3                  RES = S_D.DO$ -> ANLZ$CMD.RES.RES#;

  19786  2 001300   000031 471500                    LDP1    25,,PR0
         2 001301   040100 100500                    MLR     fill='040'O
         2 001302   100002 000004                    ADSC9   2,,PR1                   cn=0,n=4
         2 001303   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

      640    19787    3                  RES_SIZE = 4;

  19787  2 001304   000004 236007                    LDQ     4,DL
         2 001305   200035 756100                    STQ     RES_SIZE,,AUTO

      641    19788    3                  FPTOPEN = FPT_OPEN_FANLZ;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:125  
  19788  2 001306   000100 100400                    MLR     fill='000'O
         2 001307   000300 000350 1                  ADSC9   FPT_OPEN_FANLZ           cn=0,n=232
         2 001310   200056 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

      642    19789    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);

  19789  2 001311   000014 235000 3                  LDA     12
         2 001312   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001313   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001314   000122 036003                    ADLQ    82,DU
         2 001315   200056 757100                    STAQ    FPTOPEN,,AUTO

      643    19790    3                  FPTOPEN.V.DCB# = DCBNO;

  19790  2 001316   200036 720100                    LXL0    DCBNO,,AUTO
         2 001317   200122 740100                    STX0    FPTOPEN+36,,AUTO

      644    19791    3                  FPTOPEN.V.EVENT# = DCBNO;

  19791  2 001320   200036 235100                    LDA     DCBNO,,AUTO
         2 001321   200143 755100                    STA     FPTOPEN+53,,AUTO

      645    19792    3                  FPTOPEN.V.RES# = S_D.DO$ -> ANLZ$CMD.RES.RES#;

  19792  2 001322   000031 471500                    LDP1    25,,PR0
         2 001323   100002 236100                    LDQ     2,,PR1
         2 001324   200126 756100                    STQ     FPTOPEN+40,,AUTO

      646    19793    3                  CALL M$OPEN(FPTOPEN) ALTRET(ERRMSG);

  19793  2 001325   200056 630500                    EPPR0   FPTOPEN,,AUTO
         2 001326   450000 713400                    CLIMB   alt,open
         2 001327   410400 401760                    pmme    nvectors=18
         2 001330   011552 702000 2                  TSX2    ERRMSG

      647    19794    3                  FPTSETFP = FPT_SETFP;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:126  
  19794  2 001331   000100 100400                    MLR     fill='000'O
         2 001332   000372 000060 1                  ADSC9   FPT_SETFP                cn=0,n=48
         2 001333   200424 000060                    ADSC9   FPTSETFP,,AUTO           cn=0,n=48

      648    19795    3                  FPTSETFP.V_ = VECTOR(FPTSETFP.V);

  19795  2 001334   000013 235000 3                  LDA     11
         2 001335   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001336   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001337   000434 036003                    ADLQ    284,DU
         2 001340   200424 757100                    STAQ    FPTSETFP,,AUTO

      649    19796    3                  FPTSETFP.V.DCB# = DCBNO;

  19796  2 001341   200036 720100                    LXL0    DCBNO,,AUTO
         2 001342   200434 740100                    STX0    FPTSETFP+8,,AUTO

      650    19797    3                  FPTSETFP.FPRG_ = VECTOR(HANDLER_FPRG);

  19797  2 001343   000016 237000 3                  LDAQ    14
         2 001344   200430 757100                    STAQ    FPTSETFP+4,,AUTO

      651    19798    3                  CALL M$SETFP(FPTSETFP) ALTRET(ERRMSG);

  19798  2 001345   200424 630500                    EPPR0   FPTSETFP,,AUTO
         2 001346   560021 713400                    CLIMB   alt,+57361
         2 001347   401400 401760                    pmme    nvectors=4
         2 001350   011552 702000 2                  TSX2    ERRMSG

      652    19799    3                  FPTOPEN = FPT_OPEN;

  19799  2 001351   000100 100400                    MLR     fill='000'O
         2 001352   000000 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         2 001353   200056 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

      653    19800    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:127  
  19800  2 001354   000014 235000 3                  LDA     12
         2 001355   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001356   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001357   000122 036003                    ADLQ    82,DU
         2 001360   200056 757100                    STAQ    FPTOPEN,,AUTO

      654    19801    3                  FPTOPEN.NAME_ = VECTOR(VLP_NAME);

  19801  2 001361   000015 235000 3                  LDA     13
         2 001362   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001363   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001364   000154 036003                    ADLQ    108,DU
         2 001365   200064 757100                    STAQ    FPTOPEN+6,,AUTO

      655    19802    3                  FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);

  19802  2 001366   000020 235000 3                  LDA     16
         2 001367   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001370   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001371   000164 036003                    ADLQ    116,DU
         2 001372   200102 757100                    STAQ    FPTOPEN+20,,AUTO

      656    19803    3                  FPTOPEN.V.ASN# = %FILE#;

  19803  2 001373   000001 236007                    LDQ     1,DL
         2 001374   200123 552104                    STBQ    FPTOPEN+37,'04'O,AUTO

      657    19804    3                  IF S_D.DO$ ->ANLZ$CMD.FIDSCH.SIZE = 0

  19804  2 001375   000000 470400 xsym               LDP0    S_D$
         2 001376   000031 471500                    LDP1    25,,PR0
         2 001377   100022 236100                    LDQ     18,,PR1
         2 001400   777000 316003                    CANQ    -512,DU
         2 001401   001407 601000 2                  TNZ     s:19810

      658    19805    4                  THEN DO;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:128  
      659    19806    4                       FPTOPEN.NAME_ = VECTOR(VLP_MONNAME);

  19806  2 001402   000022 237000 3                  LDAQ    18
         2 001403   200064 757100                    STAQ    FPTOPEN+6,,AUTO

      660    19807    4                       FPTOPEN.ACCT_ = VECTOR(VLP_SYSACCT);

  19807  2 001404   000020 237000 3                  LDAQ    16
         2 001405   200102 757100                    STAQ    FPTOPEN+20,,AUTO

      661    19808    4                     END;

  19808  2 001406   001507 710000 2                  TRA     s:19825

      662    19809    4                  ELSE DO;

      663    19810    4                       FPTFID = FPT_FID;

  19810  2 001407   000100 100400                    MLR     fill='000'O
         2 001410   000104 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 001411   200240 000140                    ADSC9   FPTFID,,AUTO             cn=0,n=96

      664    19811    4                       FPTFID.V_ = VECTOR(FPTFID.V);

  19811  2 001412   000013 235000 3                  LDA     11
         2 001413   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001414   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001415   000264 036003                    ADLQ    180,DU
         2 001416   200240 757100                    STAQ    FPTFID,,AUTO

      665    19812    4                       FPTFID.NAME_ = VECTOR(VLP_NAME);

  19812  2 001417   000015 235000 3                  LDA     13
         2 001420   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001421   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001422   000154 036003                    ADLQ    108,DU
         2 001423   200244 757100                    STAQ    FPTFID+4,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:129  

      666    19813    4                       FPTFID.ACCT_ = VECTOR(VLP_ACCT);

  19813  2 001424   000020 235000 3                  LDA     16
         2 001425   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001426   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001427   000164 036003                    ADLQ    116,DU
         2 001430   200246 757100                    STAQ    FPTFID+6,,AUTO

      667    19814    4                       FPTFID.PASS_ = VECTOR(VLP_PASS);

  19814  2 001431   000020 235000 3                  LDA     16
         2 001432   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001433   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001434   000166 036003                    ADLQ    118,DU
         2 001435   200250 757100                    STAQ    FPTFID+8,,AUTO

      668    19815    4                       FPTFID.SN_ = VECTOR(VLP_SN);

  19815  2 001436   000013 235000 3                  LDA     11
         2 001437   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001440   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001441   000150 036003                    ADLQ    104,DU
         2 001442   200252 757100                    STAQ    FPTFID+10,,AUTO

      669    19816    4                       FPTFID.WSN_ = VECTOR(VLP_WSN);

  19816  2 001443   000020 235000 3                  LDA     16
         2 001444   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001445   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001446   000170 036003                    ADLQ    120,DU
         2 001447   200254 757100                    STAQ    FPTFID+12,,AUTO

      670    19817    4                       FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);

  19817  2 001450   177640 235007                    LDA     65440,DL
         2 001451   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:130  
         2 001452   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001453   000024 036000 3                  ADLQ    20
         2 001454   200256 757100                    STAQ    FPTFID+14,,AUTO

      671    19818    4                       FPTFID.RESULTS_ = VECTOR(VLR_FID);

  19818  2 001455   000025 235000 3                  LDA     21
         2 001456   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001457   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001460   000226 036003                    ADLQ    150,DU
         2 001461   200262 757100                    STAQ    FPTFID+18,,AUTO

      672    19819    4                       FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->ANLZ$CMD.FIDSCH.TEXT,

  19819  2 001462   000031 471500                    LDP1    25,,PR0
         2 001463   100022 236100                    LDQ     18,,PR1
         2 001464   000033 772000                    QRL     27
         2 001465   000064 737000                    LLS     52
         2 001466   000140 135007                    SBLA    96,DL
         2 001467   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 001470   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001471   000026 036000 3                  ADLQ    22
         2 001472   200242 757100                    STAQ    FPTFID+2,,AUTO

      673    19820    4                         0, S_D.DO$->ANLZ$CMD.FIDSCH.SIZE));
      674    19821    4                       CALL M$FID(FPTFID) ALTRET(ERRMSG);

  19821  2 001473   200240 630500                    EPPR0   FPTFID,,AUTO
         2 001474   420001 713400                    CLIMB   alt,+8193
         2 001475   404400 401760                    pmme    nvectors=10
         2 001476   011552 702000 2                  TSX2    ERRMSG

      675    19822    4                       IF ~VLR_FID.ACCT

  19822  2 001477   200226 236100                    LDQ     VLR_FID,,AUTO
         2 001500   000001 736000                    QLS     1
         2 001501   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:131  
         2 001502   400000 676003                    ERQ     -131072,DU
         2 001503   001507 600000 2                  TZE     s:19825

      676    19823    4                       THEN VLP_ACCT.ACCT# = B$JIT$ -> B$JIT.FACCN;

  19823  2 001504   000000 470400 xsym               LDP0    B$JIT$
         2 001505   000006 237100                    LDAQ    6,,PR0
         2 001506   200164 757100                    STAQ    VLP_ACCT,,AUTO

      677    19824    4                     END;

      678    19825    3                  IF S_D.SCHEMADCB = 0

  19825  2 001507   000000 470400 xsym               LDP0    S_D$
         2 001510   004705 235100                    LDA     2501,,PR0
         2 001511   001525 601000 2                  TNZ     s:19832

      679    19826    4                  THEN DO;

      680    19827    4                       CALL DFA$GET_FPRG_DCB (DCBNO);

  19827  2 001512   200036 631500                    EPPR1   DCBNO,,AUTO
         2 001513   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 001514   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001515   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001516   000000 701000 xent               TSX1    DFA$GET_FPRG_DCB
         2 001517   000000 011000                    NOP     0

      681    19828    4                       S_D.SCHEMADCB = DCBNO;

  19828  2 001520   000000 470400 xsym               LDP0    S_D$
         2 001521   200036 235100                    LDA     DCBNO,,AUTO
         2 001522   004705 755100                    STA     2501,,PR0

      682    19829    4                       S_D.LMDCB = DCBNO;

  19829  2 001523   004774 755100                    STA     2556,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:132  

      683    19830    4                     END;

  19830  2 001524   001554 710000 2                  TRA     s:19841

      684    19831    4                  ELSE DO;

      685    19832    4                       IF DCBADDR(S_D.SCHEMADCB) -> F$DCB.FCD#

  19832  2 001525   000012 471400 3                  LDP1    10
         2 001526   100000 473500                    LDP3    0,,PR1
         2 001527   004705 720100                    LXL0    2501,,PR0
         2 001530   300000 474510                    LDP4    0,X0,PR3
         2 001531   400031 236100                    LDQ     25,,PR4
         2 001532   020000 316007                    CANQ    8192,DL
         2 001533   001551 600000 2                  TZE     s:19839

      686    19833    5                       THEN DO;

      687    19834    5                            FPT$CLOSE = FPT_CLOSE;

  19834  2 001534   000100 100400                    MLR     fill='000'O
         2 001535   000000 000170 xsym               ADSC9   FPT_CLOSE                cn=0,n=120
         2 001536   200274 000170                    ADSC9   FPT$CLOSE,,AUTO          cn=0,n=120

      688    19835    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);

  19835  2 001537   000013 235000 3                  LDA     11
         2 001540   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001541   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001542   000326 036003                    ADLQ    214,DU
         2 001543   200274 757100                    STAQ    FPT$CLOSE,,AUTO

      689    19836    5                            FPT$CLOSE.V.DCB# = S_D.SCHEMADCB;

  19836  2 001544   200326 740100                    STX0    FPT$CLOSE+26,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:133  
      690    19837    5                            CALL M$CLOSE (FPT$CLOSE) ALTRET(ERRMSG);

  19837  2 001545   200274 630500                    EPPR0   FPT$CLOSE,,AUTO
         2 001546   450001 713400                    CLIMB   alt,close
         2 001547   406000 401760                    pmme    nvectors=13
         2 001550   011552 702000 2                  TSX2    ERRMSG

      691    19838    5                          END;

      692    19839    4                       S_D.LMDCB = S_D.SCHEMADCB;

  19839  2 001551   000000 470400 xsym               LDP0    S_D$
         2 001552   004705 235100                    LDA     2501,,PR0
         2 001553   004774 755100                    STA     2556,,PR0

      693    19840    4                     END;

      694    19841    3                  FPTOPEN.V.DCB# = S_D.LMDCB;

  19841  2 001554   004774 720100                    LXL0    2556,,PR0
         2 001555   200122 740100                    STX0    FPTOPEN+36,,AUTO

      695    19842    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);

  19842  2 001556   200056 630500                    EPPR0   FPTOPEN,,AUTO
         2 001557   450000 713400                    CLIMB   alt,open
         2 001560   410400 401760                    pmme    nvectors=18
         2 001561   011552 702000 2                  TSX2    ERRMSG

      696    19843                                                /* Allocate context */
      697    19844    3                  IF SUBSTR(DCBADDR(S_D.LMDCB) -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'

  19844  2 001562   000012 470400 3                  LDP0    10
         2 001563   000000 471500                    LDP1    0,,PR0
         2 001564   000000 473400 xsym               LDP3    S_D$
         2 001565   304774 720100                    LXL0    2556,,PR3
         2 001566   100000 474510                    LDP4    0,X0,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:134  
         2 001567   040000 106500                    CMPC    fill='040'O
         2 001570   400010 200005                    ADSC9   8,,PR4                   cn=1,n=5
         2 001571   000615 000005 1                  ADSC9   AT+21                    cn=0,n=5
         2 001572   001576 601000 2                  TNZ     s:19846

      698    19845    3                  THEN S_D.RUM_FEP = '1'B;

  19845  2 001573   400000 236003                    LDQ     -131072,DU
         2 001574   307017 756100                    STQ     3599,,PR3
         2 001575   001577 710000 2                  TRA     s:19847

      699    19846    3                  ELSE S_D.RUM_FEP = '0'B;

  19846  2 001576   307017 450100                    STZ     3599,,PR3

      700    19847    3                  CALL DFA$SETUP_FPRG(S_D.DBGFEPDCB, RES, RES_SIZE, '1'B);

  19847  2 001577   000002 236000 3                  LDQ     2
         2 001600   200545 756100                    STQ     @WHICH_ONE+4,,AUTO
         2 001601   200035 635500                    EPPR5   RES_SIZE,,AUTO
         2 001602   200544 455500                    STP5    @WHICH_ONE+3,,AUTO
         2 001603   200033 636500                    EPPR6   RES,,AUTO
         2 001604   200543 456500                    STP6    @WHICH_ONE+2,,AUTO
         2 001605   000000 236000 xsym               LDQ     S_D$
         2 001606   005007 036003                    ADLQ    2567,DU
         2 001607   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 001610   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001611   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 001612   000000 701000 xent               TSX1    DFA$SETUP_FPRG
         2 001613   000000 011000                    NOP     0

      701    19848    3                  S_D.DEBUG_CMD = '1'B;

  19848  2 001614   400000 236003                    LDQ     -131072,DU
         2 001615   000000 470400 xsym               LDP0    S_D$
         2 001616   004665 756100                    STQ     2485,,PR0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:135  
      702    19849    3                  S_D.DEBUG_CMD_CONTEXT$ = S_D.CURRENT_FPRG_CONTEXT$;

  19849  2 001617   000102 236100                    LDQ     66,,PR0
         2 001620   004666 756100                    STQ     2486,,PR0

      703    19850    3                  S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA = '0'B;

  19850  2 001621   000102 471500                    LDP1    66,,PR0
         2 001622   000027 236000 3                  LDQ     23
         2 001623   100001 356100                    ANSQ    1,,PR1

      704    19851    3                  S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.FANLZ = '1'B;

  19851  2 001624   000102 471500                    LDP1    66,,PR0
         2 001625   001000 236003                    LDQ     512,DU
         2 001626   100001 256100                    ORSQ    1,,PR1

      705    19852    3                  TFPRG$ = S_D.CURRENT_FPRG_CONTEXT$;

  19852  2 001627   000102 236100                    LDQ     66,,PR0
         2 001630   200041 756100                    STQ     TFPRG$,,AUTO

      706    19853    3                  IF S_D.STAND_ALONE AND

  19853  2 001631   004624 234100                    SZN     2452,,PR0
         2 001632   001654 605000 2                  TPL     s:19865
         2 001633   004752 234100                    SZN     2538,,PR0
         2 001634   001654 604000 2                  TMI     s:19865
         2 001635   004625 234100                    SZN     2453,,PR0
         2 001636   001654 604000 2                  TMI     s:19865

      707    19854    3                    NOT S_D.EOM AND
      708    19855    3                    NOT S_D.BATCH
      709    19856    4                  THEN DO;

      710    19857    4                       CALL M$EOM (FPT_EOM) ALTRET(NOEOM2);

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:136  
  19857  2 001637   000000 630400 xsym               EPPR0   FPT_EOM
         2 001640   560003 713400                    CLIMB   alt,+57347
         2 001641   401000 401760                    pmme    nvectors=3
         2 001642   001647 702000 2                  TSX2    NOEOM2

      711    19858    4                       S_D.EOM = '1'B;

  19858  2 001643   400000 236003                    LDQ     -131072,DU
         2 001644   000000 470400 xsym               LDP0    S_D$
         2 001645   004752 756100                    STQ     2538,,PR0

      712    19859    5                       DO WHILE ( '0'B );

  19859  2 001646   001654 710000 2                  TRA     s:19865

      713    19860    5   NOEOM2:
      714    19861    5                            IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0

  19861  2 001647   000000 470400 xsym  NOEOM2       LDP0    B$TCB$
         2 001650   000000 471500                    LDP1    0,,PR0
         2 001651   100102 236100                    LDQ     66,,PR1
         2 001652   000007 316007                    CANQ    7,DL
         2 001653   011552 601000 2                  TNZ     ERRMSG

      715    19862    5                            THEN GOTO ERRMSG;
      716    19863    5                          END;

      717    19864    4                     END;

      718    19865    3                  S_D.FIRST_TIME = '1'B;

  19865  2 001654   400000 236003                    LDQ     -131072,DU
         2 001655   000000 470400 xsym               LDP0    S_D$
         2 001656   006725 756100                    STQ     3541,,PR0

      719    19866    3                  GOTO DO_EVENT;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:137  
  19866  2 001657   011267 710000 2                  TRA     DO_EVENT

      720    19867    3                END;
      721    19868    2             ELSE CALL DUA$ANLZ ALTRET(ERR);

  19868  2 001660   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001661   000000 701000 xent               TSX1    DUA$ANLZ
         2 001662   011466 702000 2                  TSX2    ERR
         2 001663   011447 710000 2                  TRA     NOGO

      722    19869    2          CASE(2);                      /* AT */

      723    19870    2             S_D.ERROR = 502;         /* E@DELBUG - SHOULDN'T GET HERE */

  19870  2 001664   000766 235007                    LDA     502,DL
         2 001665   000013 755100                    STA     11,,PR0

      724    19871    2             CALL DDE$ERROR;

  19871  2 001666   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001667   000000 701000 xent               TSX1    DDE$ERROR
         2 001670   000000 011000                    NOP     0
         2 001671   011447 710000 2                  TRA     NOGO

      725    19872    2          CASE(3);                   /* BREAK */

      726    19873    2             IF S_D.ALIB

  19873  2 001672   005134 234100                    SZN     2652,,PR0
         2 001673   001677 605000 2                  TPL     s:19878

      727    19874    3             THEN DO;

      728    19875    3                  S_D.ERROR = 265; /* E@CANTBRKALIB */

  19875  2 001674   000411 235007                    LDA     265,DL
         2 001675   000013 755100                    STA     11,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:138  

      729    19876    3                  GOTO ERR;

  19876  2 001676   011466 710000 2                  TRA     ERR

      730    19877    3                END;
      731    19878    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  19878  2 001677   006714 235100                    LDA     3532,,PR0
         2 001700   000002 115007                    CMPA    2,DL
         2 001701   001765 601000 2                  TNZ     s:19898

      732    19879    3             THEN DO;

      733    19880    3                  GD$MSG = '0'B;

  19880  2 001702   000000 473400 xsym               LDP3    S_D_L6_MESSAGE$
         2 001703   003100 060400                    CSL     bolr='003'O
         2 001704   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 001705   300000 004720                    BDSC    0,,PR3                   by=0,bit=0,n=2512

      734    19881    3                  GD$MSG.FNC = %GD#RQSBREAK;

  19881  2 001706   300000 236100                    LDQ     0,,PR3
         2 001707   000030 376000 3                  ANQ     24
         2 001710   062000 276003                    ORQ     25600,DU
         2 001711   300000 756100                    STQ     0,,PR3

      735    19882    3                  CALL DFQ$WRITE_FD (S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERRMSG);

  19882  2 001712   000000 236000 xsym               LDQ     S_D$
         2 001713   000102 036003                    ADLQ    66,DU
         2 001714   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 001715   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001716   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001717   000000 701000 xent               TSX1    DFQ$WRITE_FD
         2 001720   011552 702000 2                  TSX2    ERRMSG
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:139  

      736    19883    3                  FPTWAIT = FPT_WAIT;

  19883  2 001721   000100 100400                    MLR     fill='000'O
         2 001722   000076 000030 1                  ADSC9   FPT_WAIT                 cn=0,n=24
         2 001723   200172 000030                    ADSC9   FPTWAIT,,AUTO            cn=0,n=24

      737    19884    3                  FPTWAIT.V_ = VECTOR(FPTWAIT.V);

  19884  2 001724   000020 235000 3                  LDA     16
         2 001725   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 001726   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 001727   000176 036003                    ADLQ    126,DU
         2 001730   200172 757100                    STAQ    FPTWAIT,,AUTO

      738    19885    3                  CALL M$WAIT(FPTWAIT);

  19885  2 001731   200172 630500                    EPPR0   FPTWAIT,,AUTO
         2 001732   020006 713400                    CLIMB   8198
         2 001733   400400 401760                    pmme    nvectors=2

      739    19886    3                  CALL DFQ$READ_FD (S_D.CURRENT_FPRG_CONTEXT$, '1'B)

  19886  2 001734   000002 236000 3                  LDQ     2
         2 001735   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 001736   000000 236000 xsym               LDQ     S_D$
         2 001737   000102 036003                    ADLQ    66,DU
         2 001740   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 001741   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001742   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001743   000000 701000 xent               TSX1    DFQ$READ_FD
         2 001744   001746 702000 2                  TSX2    s:19888
         2 001745   001747 710000 2                  TRA     s:19890

      740    19887    4                  WHENALTRETURN DO;

      741    19888    4                       ALTRETURN;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:140  

  19888  2 001746   000000 702200 xent               TSX2  ! X66_AALT

      742    19889    4                     END;
      743    19890    3                  IF GD$MSG.FNC = %GD#RSPNOBREAKCONTROL

  19890  2 001747   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 001750   000000 236100                    LDQ     0,,PR0
         2 001751   776000 376003                    ANQ     -1024,DU
         2 001752   146000 116003                    CMPQ    52224,DU
         2 001753   001760 601000 2                  TNZ     s:19895

      744    19891    4                  THEN DO;

      745    19892    4                       S_D.ERROR = 93; /* E@NO_BREAK */

  19892  2 001754   000135 235007                    LDA     93,DL
         2 001755   000000 471400 xsym               LDP1    S_D$
         2 001756   100013 755100                    STA     11,,PR1

      746    19893    4                       GOTO ERR;

  19893  2 001757   011466 710000 2                  TRA     ERR

      747    19894    4                     END;
      748    19895    3                  S_D.STEP_L6 = '0'B;

  19895  2 001760   000000 471400 xsym               LDP1    S_D$
         2 001761   105274 450100                    STZ     2748,,PR1

      749    19896    3                  UNWIND TO S_D.DO_MESSAGE;

  19896  2 001762   106770 237300                    LDAQ  ! 3576,,PR1
         2 001763   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 001764   000000 000200                    ZERO    0,128

      750    19897    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:141  
      751    19898    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALL_ATTACH ) );

  19898  2 001765   000031 236100                    LDQ     25,,PR0
         2 001766   000002 036003                    ADLQ    2,DU
         2 001767   000044 756100                    STQ     36,,PR0

      752    19899    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  19899  2 001770   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 001771   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 001772   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 001773   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001774   000000 701000 xent               TSX1    DDA$IF
         2 001775   011466 702000 2                  TSX2    ERR

      753    19900    2             S_D.DRTN$->FPT$DRTN.V.ECC# = 2; /* HONOR USERS BREAK CONTROL */

  19900  2 001776   000000 470400 xsym               LDP0    S_D$
         2 001777   004704 471500                    LDP1    2500,,PR0
         2 002000   000002 220003                    LDX0    2,DU
         2 002001   100013 440100                    SXL0    11,,PR1

      754    19901    2             CALL DDA$GO ALTRET (NOXCON);

  19901  2 002002   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002003   000000 701000 xent               TSX1    DDA$GO
         2 002004   011457 702000 2                  TSX2    NOXCON

      755    19902    2             ALTRETURN;

  19902  2 002005   000000 702200 xent               TSX2  ! X66_AALT

      756    19903    2          CASE( 21 );                /* C_BYPASS */

      757    19904    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  19904  2 002006   000101 234100                    SZN     65,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:142  
         2 002007   002022 605000 2                  TPL     s:19912
         2 002010   000102 236100                    LDQ     66,,PR0
         2 002011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002012   002022 600000 2                  TZE     s:19912

      758    19905    3             THEN DO;

      759    19906    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  19906  2 002013   000102 473500                    LDP3    66,,PR0
         2 002014   300001 236100                    LDQ     1,,PR3
         2 002015   200000 316003                    CANQ    65536,DU
         2 002016   002035 600000 2                  TZE     s:19918

      760    19907    4                  THEN DO;

      761    19908    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  19908  2 002017   000465 235007                    LDA     309,DL
         2 002020   000013 755100                    STA     11,,PR0

      762    19909    4                       GOTO ERR;

  19909  2 002021   011466 710000 2                  TRA     ERR

      763    19910    4                     END;
      764    19911    3                END;
      765    19912    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  19912  2 002022   000101 234100                    SZN     65,,PR0
         2 002023   002035 605000 2                  TPL     s:19918
         2 002024   000102 236100                    LDQ     66,,PR0
         2 002025   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002026   002035 601000 2                  TNZ     s:19918

      766    19913    3                  THEN DO;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:143  
      767    19914    3                       S_D.ERROR = 502;

  19914  2 002027   000766 235007                    LDA     502,DL
         2 002030   000013 755100                    STA     11,,PR0

      768    19915    3                       CALL DDE$ERROR;

  19915  2 002031   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002032   000000 701000 xent               TSX1    DDE$ERROR
         2 002033   000000 011000                    NOP     0

      769    19916    3                       GOTO ERR1;

  19916  2 002034   011506 710000 2                  TRA     ERR1

      770    19917    3                     END;
      771    19918    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));

  19918  2 002035   000031 236100                    LDQ     25,,PR0
         2 002036   000002 036003                    ADLQ    2,DU
         2 002037   000044 756100                    STQ     36,,PR0

      772    19919    2             CALL DDA$IF( NOGO_BIT ) ALTRET(ERR);

  19919  2 002040   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 002041   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 002042   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002043   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002044   000000 701000 xent               TSX1    DDA$IF
         2 002045   011466 702000 2                  TSX2    ERR

      773    19920    2             IF NOGO_BIT THEN RETURN;

  19920  2 002046   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 002047   002051 605000 2                  TPL     s:19921

  19920  2 002050   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:144  

      774    19921    2             S_D.BYPASS = '1'B;

  19921  2 002051   400000 236003                    LDQ     -131072,DU
         2 002052   000000 470400 xsym               LDP0    S_D$
         2 002053   001032 756100                    STQ     538,,PR0

      775    19922    2             S_D.BYPASS_SAVE = S_D.BYPASS;

  19922  2 002054   001032 236100                    LDQ     538,,PR0
         2 002055   400000 376003                    ANQ     -131072,DU
         2 002056   000074 756100                    STQ     60,,PR0
         2 002057   011447 710000 2                  TRA     NOGO

      776    19923    2          CASE (41);                  /* C_CACHE */

      777    19924    2             S_D.L6_CACHE = '1'B;

  19924  2 002060   400000 236003                    LDQ     -131072,DU
         2 002061   005245 756100                    STQ     2725,,PR0
         2 002062   011447 710000 2                  TRA     NOGO

      778    19925    2          CASE (15);                   /* C_COPY */

      779    19926    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));

  19926  2 002063   000031 236100                    LDQ     25,,PR0
         2 002064   000002 036003                    ADLQ    2,DU
         2 002065   000044 756100                    STQ     36,,PR0

      780    19927    2             CALL DDA$IF (NOGO_BIT) ALTRET (ERR);

  19927  2 002066   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 002067   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 002070   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002072   000000 701000 xent               TSX1    DDA$IF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:145  
         2 002073   011466 702000 2                  TSX2    ERR

      781    19928    2             IF NOGO_BIT THEN RETURN;

  19928  2 002074   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 002075   002077 605000 2                  TPL     s:19929

  19928  2 002076   000000 702200 xent               TSX2  ! X66_ARET

      782    19929    2             S_D.COPY = '1'B;

  19929  2 002077   400000 236003                    LDQ     -131072,DU
         2 002100   000000 470400 xsym               LDP0    S_D$
         2 002101   004742 756100                    STQ     2530,,PR0
         2 002102   011447 710000 2                  TRA     NOGO

      783    19930    2          CASE(82);                   /* CRASH */

      784    19931    2             GD$MSG = '0'B;

  19931  2 002103   000000 473400 xsym               LDP3    S_D_L6_MESSAGE$
         2 002104   003100 060400                    CSL     bolr='003'O
         2 002105   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 002106   300000 004720                    BDSC    0,,PR3                   by=0,bit=0,n=2512

      785    19932    2             GD$MSG.FNC = %GD#RQSCRASH;

  19932  2 002107   300000 236100                    LDQ     0,,PR3
         2 002110   000030 376000 3                  ANQ     24
         2 002111   044000 276003                    ORQ     18432,DU
         2 002112   300000 756100                    STQ     0,,PR3

      786    19933    2             CALL DFQ$WRITE_FD (S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERRMSG);

  19933  2 002113   000000 236000 xsym               LDQ     S_D$
         2 002114   000102 036003                    ADLQ    66,DU
         2 002115   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:146  
         2 002116   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002120   000000 701000 xent               TSX1    DFQ$WRITE_FD
         2 002121   011552 702000 2                  TSX2    ERRMSG

      787    19934    2             TFPRG$ = S_D.CURRENT_FPRG_CONTEXT$;

  19934  2 002122   000000 470400 xsym               LDP0    S_D$
         2 002123   000102 236100                    LDQ     66,,PR0
         2 002124   200041 756100                    STQ     TFPRG$,,AUTO

      788    19935    2             GOTO DO_EVENT;

  19935  2 002125   011267 710000 2                  TRA     DO_EVENT

      789    19936    2          CASE(78);                   /* DBOOT */

      790    19937    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALL_ATTACH ) );

  19937  2 002126   000031 236100                    LDQ     25,,PR0
         2 002127   000002 036003                    ADLQ    2,DU
         2 002130   000044 756100                    STQ     36,,PR0

      791    19938    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  19938  2 002131   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 002132   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 002133   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002134   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002135   000000 701000 xent               TSX1    DDA$IF
         2 002136   011466 702000 2                  TSX2    ERR

      792    19939    2             IF NOGO_BIT THEN RETURN;

  19939  2 002137   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 002140   002142 605000 2                  TPL     s:19940

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:147  
  19939  2 002141   000000 702200 xent               TSX2  ! X66_ARET

      793    19940    2             CALL DXA$DBOOT;

  19940  2 002142   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002143   000000 701000 xent               TSX1    DXA$DBOOT
         2 002144   000000 011000                    NOP     0
         2 002145   011447 710000 2                  TRA     NOGO

      794    19941    2          CASE(89);                   /* DEBUG */

      795    19942    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( S_D.DO$ -> DEBUG$CMD ) );

  19942  2 002146   000031 236100                    LDQ     25,,PR0
         2 002147   000026 036003                    ADLQ    22,DU
         2 002150   000044 756100                    STQ     36,,PR0

      796    19943    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  19943  2 002151   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 002152   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 002153   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002155   000000 701000 xent               TSX1    DDA$IF
         2 002156   011466 702000 2                  TSX2    ERR

      797    19944    2             IF NOGO_BIT THEN RETURN;

  19944  2 002157   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 002160   002162 605000 2                  TPL     s:19945

  19944  2 002161   000000 702200 xent               TSX2  ! X66_ARET

      798    19945    2             IF S_D.DEBUG_CMD AND S_D.DEBUG_CMD_CONTEXT$ ~= ADDR(NIL)

  19945  2 002162   000000 470400 xsym               LDP0    S_D$
         2 002163   004665 234100                    SZN     2485,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:148  
         2 002164   002174 605000 2                  TPL     s:19950
         2 002165   004666 236100                    LDQ     2486,,PR0
         2 002166   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002167   002174 600000 2                  TZE     s:19950

      799    19946    3             THEN DO;

      800    19947    3                  S_D.CURRENT_FPRG_CONTEXT$ = S_D.DEBUG_CMD_CONTEXT$;

  19947  2 002170   000102 756100                    STQ     66,,PR0

      801    19948    3                  CALL DFA$KILL_DELTA;

  19948  2 002171   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002172   000000 701000 xent               TSX1    DFA$KILL_DELTA
         2 002173   000000 011000                    NOP     0

      802    19949    3                END;

      803    19950    2             IF S_D.DO$ -> DEBUG$CMD.CG OR

  19950  2 002174   000000 470400 xsym               LDP0    S_D$
         2 002175   000031 471500                    LDP1    25,,PR0
         2 002176   100001 236100                    LDQ     1,,PR1
         2 002177   002000 316007                    CANQ    1024,DL
         2 002200   002205 601000 2                  TNZ     s:19954
         2 002201   001000 316007                    CANQ    512,DL
         2 002202   002205 601000 2                  TNZ     s:19954
         2 002203   004000 316007                    CANQ    2048,DL
         2 002204   002641 600000 2                  TZE     s:20051

      804    19951    2               S_D.DO$ -> DEBUG$CMD.TPACCT OR
      805    19952    2               S_D.DO$ -> DEBUG$CMD.SYSID
      806    19953    3             THEN DO;

      807    19954    3                  FPTOPEN = FPT_OPEN;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:149  
  19954  2 002205   000100 100400                    MLR     fill='000'O
         2 002206   000000 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         2 002207   200056 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

      808    19955    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);

  19955  2 002210   000014 235000 3                  LDA     12
         2 002211   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002212   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002213   000122 036003                    ADLQ    82,DU
         2 002214   200056 757100                    STAQ    FPTOPEN,,AUTO

      809    19956    3                  FPTOPEN.V.RES# = 'FE  ';

  19956  2 002215   000617 236000 1                  LDQ     AT+23
         2 002216   200126 756100                    STQ     FPTOPEN+40,,AUTO

      810    19957    3                  IF S_D.DO$ -> DEBUG$CMD.CG OR S_D.DO$ -> DEBUG$CMD.TPACCT

  19957  2 002217   000031 471500                    LDP1    25,,PR0
         2 002220   100001 236100                    LDQ     1,,PR1
         2 002221   002000 316007                    CANQ    1024,DL
         2 002222   002225 601000 2                  TNZ     s:19959
         2 002223   001000 316007                    CANQ    512,DL
         2 002224   002443 600000 2                  TZE     s:20005

      811    19958    4                  THEN DO;

      812    19959    4                       FPTOPEN.SN_ = VECTOR(VLP_SN);

  19959  2 002225   000013 235000 3                  LDA     11
         2 002226   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002227   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002230   000150 036003                    ADLQ    104,DU
         2 002231   200060 757100                    STAQ    FPTOPEN+2,,AUTO

      813    19960    4                       FPTOPEN.NAME_ = VECTOR(VLP_NAME);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:150  

  19960  2 002232   000015 235000 3                  LDA     13
         2 002233   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002234   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002235   000154 036003                    ADLQ    108,DU
         2 002236   200064 757100                    STAQ    FPTOPEN+6,,AUTO

      814    19961    4                       FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);

  19961  2 002237   000020 235000 3                  LDA     16
         2 002240   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002241   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002242   000164 036003                    ADLQ    116,DU
         2 002243   200102 757100                    STAQ    FPTOPEN+20,,AUTO

      815    19962    4                       FPTOPEN.PASS_ = VECTOR(VLP_PASS);

  19962  2 002244   000020 235000 3                  LDA     16
         2 002245   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002246   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002247   000166 036003                    ADLQ    118,DU
         2 002250   200066 757100                    STAQ    FPTOPEN+8,,AUTO

      816    19963    4                       FPTOPEN.SETSTA_ = VECTOR(VLP_SETSTA);

  19963  2 002251   000031 235000 3                  LDA     25
         2 002252   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002253   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002254   000210 036003                    ADLQ    136,DU
         2 002255   200062 757100                    STAQ    FPTOPEN+4,,AUTO

      817    19964    4                       FPTOPEN.V.ORG# = %DBGCG#;

  19964  2 002256   025000 236007                    LDQ     10752,DL
         2 002257   200124 552110                    STBQ    FPTOPEN+38,'10'O,AUTO

      818    19965    4                       FPTOPEN.V.FUN# = %UPDATE#;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:151  

  19965  2 002260   001000 236007                    LDQ     512,DL
         2 002261   200123 552110                    STBQ    FPTOPEN+37,'10'O,AUTO

      819    19966    4                       IF S_D.DO$ -> DEBUG$CMD.TPACCT

  19966  2 002262   000031 471500                    LDP1    25,,PR0
         2 002263   100001 236100                    LDQ     1,,PR1
         2 002264   001000 316007                    CANQ    512,DL
         2 002265   002305 600000 2                  TZE     s:19975

      820    19967    5                       THEN DO;

      821    19968    5                            VLP_NAME.L# = S_D.DO$ -> DEBUG$CMD.CG_FID.SIZE;

  19968  2 002266   100005 236100                    LDQ     5,,PR1
         2 002267   000011 736000                    QLS     9
         2 002270   200154 552140                    STBQ    VLP_NAME,'40'O,AUTO

      822    19969    5                            VLP_NAME.NAME# = S_D.DO$ -> DEBUG$CMD.CG_FID.TEXT;

  19969  2 002271   000031 471500                    LDP1    25,,PR0
         2 002272   040100 100500                    MLR     fill='040'O
         2 002273   100005 400037                    ADSC9   5,,PR1                   cn=2,n=31
         2 002274   200154 200037                    ADSC9   VLP_NAME,,AUTO           cn=1,n=31

      823    19970    5                            VLP_ACCT.ACCT# = S_D.DO$ -> DEBUG$CMD.CG_FID.TEXT;

  19970  2 002275   000031 471500                    LDP1    25,,PR0
         2 002276   040100 100500                    MLR     fill='040'O
         2 002277   100005 400010                    ADSC9   5,,PR1                   cn=2,n=8
         2 002300   200164 000010                    ADSC9   VLP_ACCT,,AUTO           cn=0,n=8

      824    19971    5                            VLP_SN.SN#(0) = ' ';

  19971  2 002301   040100 100400                    MLR     fill='040'O
         2 002302   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:152  
         2 002303   200151 000006                    ADSC9   VLP_SN+1,,AUTO           cn=0,n=6

      825    19972    5                          END;

  19972  2 002304   002423 710000 2                  TRA     s:20000

      826    19973    5                       ELSE DO;

      827    19974                                           /* Make sure a valid CG fid was specified */
      828    19975    5                            FPTFID = FPT_FID;

  19975  2 002305   000100 100400                    MLR     fill='000'O
         2 002306   000104 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 002307   200240 000140                    ADSC9   FPTFID,,AUTO             cn=0,n=96

      829    19976    5                            FPTFID.V_ = VECTOR(FPTFID.V);

  19976  2 002310   000013 235000 3                  LDA     11
         2 002311   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002312   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002313   000264 036003                    ADLQ    180,DU
         2 002314   200240 757100                    STAQ    FPTFID,,AUTO

      830    19977    5                            FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->DEBUG$CMD.CG_FID.
             19977                                     TEXT,

  19977  2 002315   000031 471500                    LDP1    25,,PR0
         2 002316   100005 220100                    LDX0    5,,PR1
         2 002317   000777 360003                    ANX0    511,DU
         2 002320   000000 635010                    EAA     0,X0
         2 002321   000002 771000                    ARL     2
         2 002322   000140 135007                    SBLA    96,DL
         2 002323   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 002324   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002325   000032 036000 3                  ADLQ    26
         2 002326   200242 757100                    STAQ    FPTFID+2,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:153  
      831    19978    5                              0, S_D.DO$->DEBUG$CMD.CG_FID.SIZE));
      832    19979    5                            FPTFID.NAME_ = VECTOR(VLP_NAME);

  19979  2 002327   000015 235000 3                  LDA     13
         2 002330   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002331   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002332   000154 036003                    ADLQ    108,DU
         2 002333   200244 757100                    STAQ    FPTFID+4,,AUTO

      833    19980    5                            FPTFID.RES_ = VECTOR(FID_RES);

  19980  2 002334   777640 235007                    LDA     -96,DL
         2 002335   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002336   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002337   000037 036003                    ADLQ    31,DU
         2 002340   200260 757100                    STAQ    FPTFID+16,,AUTO

      834    19981    5                            FPTFID.RESULTS_ = VECTOR(VLR_FID);

  19981  2 002341   000025 235000 3                  LDA     21
         2 002342   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002343   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002344   000226 036003                    ADLQ    150,DU
         2 002345   200262 757100                    STAQ    FPTFID+18,,AUTO

      835    19982    5                            FPTFID.ACCT_ = VECTOR(VLP_ACCT);

  19982  2 002346   000020 235000 3                  LDA     16
         2 002347   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002350   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002351   000164 036003                    ADLQ    116,DU
         2 002352   200246 757100                    STAQ    FPTFID+6,,AUTO

      836    19983    5                            FPTFID.ASN_ = VECTOR(FID_ASN);

  19983  2 002353   777640 235007                    LDA     -96,DL
         2 002354   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:154  
         2 002355   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002356   000032 036003                    ADLQ    26,DU
         2 002357   200256 757100                    STAQ    FPTFID+14,,AUTO

      837    19984    5                            FPTFID.PASS_ = VECTOR(VLP_PASS);

  19984  2 002360   000020 235000 3                  LDA     16
         2 002361   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002362   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002363   000166 036003                    ADLQ    118,DU
         2 002364   200250 757100                    STAQ    FPTFID+8,,AUTO

      838    19985    5                            FPTFID.SN_ = VECTOR(VLP_SN);

  19985  2 002365   000013 235000 3                  LDA     11
         2 002366   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002367   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002370   000150 036003                    ADLQ    104,DU
         2 002371   200252 757100                    STAQ    FPTFID+10,,AUTO

      839    19986    5                            CALL M$FID (FPTFID)

  19986  2 002372   200240 630500                    EPPR0   FPTFID,,AUTO
         2 002373   420001 713400                    CLIMB   alt,+8193
         2 002374   404400 401760                    pmme    nvectors=10
         2 002375   002377 702000 2                  TSX2    s:19988
         2 002376   002403 710000 2                  TRA     s:19991

      840    19987    6                            WHENALTRETURN DO;

      841    19988    6                                 S_D.ERROR = 275; /* E@NOTCGFID */

  19988  2 002377   000423 235007                    LDA     275,DL
         2 002400   000000 470400 xsym               LDP0    S_D$
         2 002401   000013 755100                    STA     11,,PR0

      842    19989    6                                 GOTO ERR;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:155  

  19989  2 002402   011466 710000 2                  TRA     ERR

      843    19990    6                               END;
      844    19991    5                            IF FID_ASN ~= %COMGROUP#

  19991  2 002403   200032 236100                    LDQ     FID_ASN,,AUTO
         2 002404   777000 376003                    ANQ     -512,DU
         2 002405   004000 116003                    CMPQ    2048,DU
         2 002406   002413 600000 2                  TZE     s:19996

      845    19992    6                            THEN DO;

      846    19993    6                                 S_D.ERROR = 275; /* E@NOTCGFID */

  19993  2 002407   000423 235007                    LDA     275,DL
         2 002410   000000 470400 xsym               LDP0    S_D$
         2 002411   000013 755100                    STA     11,,PR0

      847    19994    6                                 GOTO ERR;

  19994  2 002412   011466 710000 2                  TRA     ERR

      848    19995    6                               END;
      849    19996    5                            IF ~VLR_FID.ACCT

  19996  2 002413   200226 236100                    LDQ     VLR_FID,,AUTO
         2 002414   000001 736000                    QLS     1
         2 002415   400000 376003                    ANQ     -131072,DU
         2 002416   400000 676003                    ERQ     -131072,DU
         2 002417   002423 600000 2                  TZE     s:20000

      850    19997    5                            THEN VLP_ACCT.ACCT# = B$JIT$ -> B$JIT.FACCN;

  19997  2 002420   000000 470400 xsym               LDP0    B$JIT$
         2 002421   000006 237100                    LDAQ    6,,PR0
         2 002422   200164 757100                    STAQ    VLP_ACCT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:156  

      851    19998    5                          END;

      852    19999                                                /* Set up station */
      853    20000    4                       VLP_SETSTA.MYSTATION# = SUBSTR(S_D.DO$->DEBUG$CMD.STATION_FID.
             20000                                TEXT,

  20000  2 002423   000000 470400 xsym               LDP0    S_D$
         2 002424   000031 471500                    LDP1    25,,PR0
         2 002425   100003 236100                    LDQ     3,,PR1
         2 002426   000033 772000                    QRL     27
         2 002427   000000 620006                    EAX0    0,QL
         2 002430   040100 100540                    MLR     fill='040'O
         2 002431   100003 200010                    ADSC9   3,,PR1                   cn=1,n=*X0
         2 002432   200210 000010                    ADSC9   VLP_SETSTA,,AUTO         cn=0,n=8

      854    20001    4                         0, S_D.DO$->DEBUG$CMD.STATION_FID.SIZE);
      855    20002    4                       RES = S_D.DO$ -> DEBUG$CMD.STATION_FID.TEXT;

  20002  2 002433   000031 471500                    LDP1    25,,PR0
         2 002434   040100 100500                    MLR     fill='040'O
         2 002435   100003 200010                    ADSC9   3,,PR1                   cn=1,n=8
         2 002436   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

      856    20003    4                       RES_SIZE = S_D.DO$ -> DEBUG$CMD.STATION_FID.SIZE;

  20003  2 002437   000031 471500                    LDP1    25,,PR0
         2 002440   100003 236100                    LDQ     3,,PR1
         2 002441   000033 772000                    QRL     27
         2 002442   200035 756100                    STQ     RES_SIZE,,AUTO

      857    20004    4                     END;

      858    20005    3                  IF S_D.DO$ -> DEBUG$CMD.SYSID

  20005  2 002443   000031 471500                    LDP1    25,,PR0
         2 002444   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:157  
         2 002445   004000 316007                    CANQ    2048,DL
         2 002446   002524 600000 2                  TZE     s:20019

      859    20006    4                  THEN DO;

      860    20007    4                       FPTOPEN.V.ORG# = %DBGSYSID#;

  20007  2 002447   026000 236007                    LDQ     11264,DL
         2 002450   200124 552110                    STBQ    FPTOPEN+38,'10'O,AUTO

      861    20008    4                       FPTOPEN.V.FUN# = %UPDATE#;

  20008  2 002451   001000 236007                    LDQ     512,DL
         2 002452   200123 552110                    STBQ    FPTOPEN+37,'10'O,AUTO

      862    20009    4                       FPTOPEN.V.DBGSYSID# = S_D.DO$ -> DEBUG$CMD.SYSID#;

  20009  2 002453   000031 471500                    LDP1    25,,PR0
         2 002454   100001 220100                    LDX0    1,,PR1
         2 002455   200144 740100                    STX0    FPTOPEN+54,,AUTO

      863    20010    4                       FPTOPEN.NODENAME_ = VECTOR(VLP_NODENAME);

  20010  2 002456   000020 235000 3                  LDA     16
         2 002457   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002460   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002461   000224 036003                    ADLQ    148,DU
         2 002462   200110 757100                    STAQ    FPTOPEN+26,,AUTO

      864    20011    4                       VLP_NODENAME.NODENAME# = SUBSTR(S_D.DO$->DEBUG$CMD.STATION_FID.
             20011                                TEXT,

  20011  2 002463   000031 471500                    LDP1    25,,PR0
         2 002464   100003 236100                    LDQ     3,,PR1
         2 002465   000033 772000                    QRL     27
         2 002466   000000 621006                    EAX1    0,QL
         2 002467   040100 100540                    MLR     fill='040'O
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:158  
         2 002470   100003 200011                    ADSC9   3,,PR1                   cn=1,n=*X1
         2 002471   200224 000010                    ADSC9   VLP_NODENAME,,AUTO       cn=0,n=8

      865    20012    4                         0, S_D.DO$->DEBUG$CMD.STATION_FID.SIZE);
      866    20013    4                       I = S_D.DO$ -> DEBUG$CMD.SYSID#;

  20013  2 002472   000031 471500                    LDP1    25,,PR0
         2 002473   100001 236100                    LDQ     1,,PR1
         2 002474   000022 772000                    QRL     18
         2 002475   200005 756100                    STQ     I,,AUTO

      867    20014    4                       RES = 'S:';

  20014  2 002476   040100 100400                    MLR     fill='040'O
         2 002477   000620 000002 1                  ADSC9   AT+24                    cn=0,n=2
         2 002500   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

      868    20015    4                       CALL DDR$BINTXT(ADDR(SUBSTR(RES,2)), I, %UINT_FMT, RES_SIZE);

  20015  2 002501   200543 452500                    STP2    @WHICH_ONE+2,,AUTO
         2 002502   200543 236100                    LDQ     @WHICH_ONE+2,,AUTO
         2 002503   000033 036000 3                  ADLQ    27
         2 002504   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 002505   200035 631500                    EPPR1   RES_SIZE,,AUTO
         2 002506   200547 451500                    STP1    @WHICH_ONE+6,,AUTO
         2 002507   000034 236000 3                  LDQ     28
         2 002510   200546 756100                    STQ     @WHICH_ONE+5,,AUTO
         2 002511   200005 633500                    EPPR3   I,,AUTO
         2 002512   200545 453500                    STP3    @WHICH_ONE+4,,AUTO
         2 002513   200542 634500                    EPPR4   @WHICH_ONE+1,,AUTO
         2 002514   200544 454500                    STP4    @WHICH_ONE+3,,AUTO
         2 002515   200544 630500                    EPPR0   @WHICH_ONE+3,,AUTO
         2 002516   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 002517   000000 701000 xent               TSX1    DDR$BINTXT
         2 002520   000000 011000                    NOP     0

      869    20016    4                       RES_SIZE = RES_SIZE + 2;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:159  

  20016  2 002521   200035 235100                    LDA     RES_SIZE,,AUTO
         2 002522   000002 035007                    ADLA    2,DL
         2 002523   200035 755100                    STA     RES_SIZE,,AUTO

      870    20017    4                     END;

      871    20018                                                /* Get a DCB */
      872    20019    3                  CALL DFA$GET_FPRG_DCB (DCBNO);

  20019  2 002524   200036 630500                    EPPR0   DCBNO,,AUTO
         2 002525   200542 450500                    STP0    @WHICH_ONE+1,,AUTO
         2 002526   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002527   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002530   000000 701000 xent               TSX1    DFA$GET_FPRG_DCB
         2 002531   000000 011000                    NOP     0

      873    20020    3                  FPTOPEN.V.DCB# = DCBNO;

  20020  2 002532   200036 720100                    LXL0    DCBNO,,AUTO
         2 002533   200122 740100                    STX0    FPTOPEN+36,,AUTO

      874    20021    3                  FPTOPEN.V.EVENT# = DCBNO;

  20021  2 002534   200036 235100                    LDA     DCBNO,,AUTO
         2 002535   200143 755100                    STA     FPTOPEN+53,,AUTO

      875    20022                                      /* Call M$OPEN to get a connection to the FPRG */
      876    20023    3                  CALL M$OPEN (FPTOPEN)

  20023  2 002536   200056 630500                    EPPR0   FPTOPEN,,AUTO
         2 002537   450000 713400                    CLIMB   alt,open
         2 002540   410400 401760                    pmme    nvectors=18
         2 002541   002543 702000 2                  TSX2    s:20025
         2 002542   002621 710000 2                  TRA     s:20047

      877    20024    4                  WHENALTRETURN DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:160  

      878    20025    4                       CALL DUE$ERRMSG;

  20025  2 002543   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002544   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002545   000000 011000                    NOP     0

      879    20026    4                       IF DCBADDR(DCBNO)->F$DCB.FCD#

  20026  2 002546   000012 470400 3                  LDP0    10
         2 002547   000000 471500                    LDP1    0,,PR0
         2 002550   200036 720100                    LXL0    DCBNO,,AUTO
         2 002551   100000 473510                    LDP3    0,X0,PR1
         2 002552   300031 236100                    LDQ     25,,PR3
         2 002553   020000 316007                    CANQ    8192,DL
         2 002554   002576 600000 2                  TZE     s:20037

      880    20027    5                       THEN DO;            /* CLOSE IT */

      881    20028    5                            FPT$CLOSE = FPT_CLOSE;

  20028  2 002555   000100 100400                    MLR     fill='000'O
         2 002556   000000 000170 xsym               ADSC9   FPT_CLOSE                cn=0,n=120
         2 002557   200274 000170                    ADSC9   FPT$CLOSE,,AUTO          cn=0,n=120

      882    20029    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);

  20029  2 002560   000013 235000 3                  LDA     11
         2 002561   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002562   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002563   000326 036003                    ADLQ    214,DU
         2 002564   200274 757100                    STAQ    FPT$CLOSE,,AUTO

      883    20030    5                            FPT$CLOSE.V.DCB# = DCBNO;

  20030  2 002565   200326 740100                    STX0    FPT$CLOSE+26,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:161  
      884    20031    5                            CALL M$CLOSE (FPT$CLOSE)

  20031  2 002566   200274 630500                    EPPR0   FPT$CLOSE,,AUTO
         2 002567   450001 713400                    CLIMB   alt,close
         2 002570   406000 401760                    pmme    nvectors=13
         2 002571   002573 702000 2                  TSX2    s:20033
         2 002572   002576 710000 2                  TRA     s:20037

      885    20032    6                            WHENALTRETURN DO;

      886    20033    6                                 CALL DUE$ERRMSG;

  20033  2 002573   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002574   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002575   000000 011000                    NOP     0

      887    20034    6                               END;

      888    20035    5                          END;

      889    20036                                                /* Release the DCB */
      890    20037    4                       FPTRELDCB = FPT_RELDCB;

  20037  2 002576   000100 100400                    MLR     fill='000'O
         2 002577   000000 000020 xsym               ADSC9   FPT_RELDCB               cn=0,n=16
         2 002600   200270 000020                    ADSC9   FPTRELDCB,,AUTO          cn=0,n=16

      891    20038    4                       FPTRELDCB.V_ = VECTOR(FPTRELDCB.V);

  20038  2 002601   000020 235000 3                  LDA     16
         2 002602   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002603   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002604   000272 036003                    ADLQ    186,DU
         2 002605   200270 757100                    STAQ    FPTRELDCB,,AUTO

      892    20039    4                       FPTRELDCB.V.DCB# = DCBNO;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:162  
  20039  2 002606   200036 720100                    LXL0    DCBNO,,AUTO
         2 002607   200272 740100                    STX0    FPTRELDCB+2,,AUTO

      893    20040    4                       CALL M$RELDCB (FPTRELDCB)

  20040  2 002610   200270 630500                    EPPR0   FPTRELDCB,,AUTO
         2 002611   460003 713400                    CLIMB   alt,+24579
         2 002612   400000 401760                    pmme    nvectors=1
         2 002613   002615 702000 2                  TSX2    s:20042
         2 002614   002620 710000 2                  TRA     s:20044

      894    20041    5                       WHENALTRETURN DO;

      895    20042    5                            CALL DUE$ERRMSG;

  20042  2 002615   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002616   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002617   000000 011000                    NOP     0

      896    20043    5                          END;

      897    20044    4                       RETURN;

  20044  2 002620   000000 702200 xent               TSX2  ! X66_ARET

      898    20045    4                     END;
      899    20046                                                /* Set up context for this FPRG */
      900    20047    3                  S_D.DEBUG_CMD = '1'B;

  20047  2 002621   400000 236003                    LDQ     -131072,DU
         2 002622   000000 470400 xsym               LDP0    S_D$
         2 002623   004665 756100                    STQ     2485,,PR0

      901    20048    3                  CALL DFA$SETUP_FPRG (DCBNO, RES, RES_SIZE) ALTRET(NOGO);

  20048  2 002624   200035 631500                    EPPR1   RES_SIZE,,AUTO
         2 002625   200544 451500                    STP1    @WHICH_ONE+3,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:163  
         2 002626   200033 633500                    EPPR3   RES,,AUTO
         2 002627   200543 453500                    STP3    @WHICH_ONE+2,,AUTO
         2 002630   200036 634500                    EPPR4   DCBNO,,AUTO
         2 002631   200542 454500                    STP4    @WHICH_ONE+1,,AUTO
         2 002632   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002633   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002634   000000 701000 xent               TSX1    DFA$SETUP_FPRG
         2 002635   011447 702000 2                  TSX2    NOGO

      902    20049    3                  S_D.DEBUG_CMD_CONTEXT$ = S_D.CURRENT_FPRG_CONTEXT$;

  20049  2 002636   000000 470400 xsym               LDP0    S_D$
         2 002637   000102 236100                    LDQ     66,,PR0
         2 002640   004666 756100                    STQ     2486,,PR0

      903    20050    3                END;

      904    20051    2             IF S_D.DO$ -> DEBUG$CMD.FEP

  20051  2 002641   000031 471500                    LDP1    25,,PR0
         2 002642   100001 236100                    LDQ     1,,PR1
         2 002643   010000 316007                    CANQ    4096,DL
         2 002644   003520 600000 2                  TZE     s:20195

      905    20052    3             THEN DO;

      906    20053                                                /* Get a DCB if need one */
      907    20054    3                  IF S_D.DBGFEPDCB = 0

  20054  2 002645   005007 235100                    LDA     2567,,PR0
         2 002646   002661 601000 2                  TNZ     s:20060

      908    20055    4                  THEN DO;

      909    20056    4                       CALL DFA$GET_FPRG_DCB(DCBNO);

  20056  2 002647   200036 633500                    EPPR3   DCBNO,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:164  
         2 002650   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 002651   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 002652   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002653   000000 701000 xent               TSX1    DFA$GET_FPRG_DCB
         2 002654   000000 011000                    NOP     0

      910    20057    4                       S_D.DBGFEPDCB = DCBNO;

  20057  2 002655   000000 470400 xsym               LDP0    S_D$
         2 002656   200036 235100                    LDA     DCBNO,,AUTO
         2 002657   005007 755100                    STA     2567,,PR0

      911    20058    4                     END;

  20058  2 002660   002710 710000 2                  TRA     s:20070

      912    20059    4                  ELSE DO;

      913    20060    4                       IF DCBADDR(S_D.DBGFEPDCB) -> F$DCB.FCD#

  20060  2 002661   000012 473400 3                  LDP3    10
         2 002662   300000 474500                    LDP4    0,,PR3
         2 002663   005007 720100                    LXL0    2567,,PR0
         2 002664   400000 475510                    LDP5    0,X0,PR4
         2 002665   500031 236100                    LDQ     25,,PR5
         2 002666   020000 316007                    CANQ    8192,DL
         2 002667   002705 600000 2                  TZE     s:20067

      914    20061    5                       THEN DO;

      915    20062    5                            FPTCLOSE_DBG = FPT_CLOSE_DBG;

  20062  2 002670   000100 100400                    MLR     fill='000'O
         2 002671   000150 000170 1                  ADSC9   FPT_CLOSE_DBG            cn=0,n=120
         2 002672   200366 000170                    ADSC9   FPTCLOSE_DBG,,AUTO       cn=0,n=120

      916    20063    5                            FPTCLOSE_DBG.V_ = VECTOR(FPTCLOSE_DBG.V);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:165  

  20063  2 002673   000013 235000 3                  LDA     11
         2 002674   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002675   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002676   000420 036003                    ADLQ    272,DU
         2 002677   200366 757100                    STAQ    FPTCLOSE_DBG,,AUTO

      917    20064    5                            FPTCLOSE_DBG.V.DCB# = S_D.DBGFEPDCB;

  20064  2 002700   200420 740100                    STX0    FPTCLOSE_DBG+26,,AUTO

      918    20065    5                            CALL M$CLOSE (FPTCLOSE_DBG) ALTRET(ERRMSG);

  20065  2 002701   200366 630500                    EPPR0   FPTCLOSE_DBG,,AUTO
         2 002702   450001 713400                    CLIMB   alt,close
         2 002703   406000 401760                    pmme    nvectors=13
         2 002704   011552 702000 2                  TSX2    ERRMSG

      919    20066    5                          END;

      920    20067    4                       DCBNO = S_D.DBGFEPDCB;

  20067  2 002705   000000 470400 xsym               LDP0    S_D$
         2 002706   005007 235100                    LDA     2567,,PR0
         2 002707   200036 755100                    STA     DCBNO,,AUTO

      921    20068    4                     END;

      922    20069                                                /* Open Remote debug */
      923    20070    3                  FPTOPEN = FPT_OPEN_DBG;

  20070  2 002710   000100 100400                    MLR     fill='000'O
         2 002711   000206 000350 1                  ADSC9   FPT_OPEN_DBG             cn=0,n=232
         2 002712   200056 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

      924    20071    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:166  
  20071  2 002713   000014 235000 3                  LDA     12
         2 002714   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002715   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002716   000122 036003                    ADLQ    82,DU
         2 002717   200056 757100                    STAQ    FPTOPEN,,AUTO

      925    20072    3                  FPTOPEN.V.DCB# = DCBNO;

  20072  2 002720   200036 720100                    LXL0    DCBNO,,AUTO
         2 002721   200122 740100                    STX0    FPTOPEN+36,,AUTO

      926    20073    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);

  20073  2 002722   200056 630500                    EPPR0   FPTOPEN,,AUTO
         2 002723   450000 713400                    CLIMB   alt,open
         2 002724   410400 401760                    pmme    nvectors=18
         2 002725   011552 702000 2                  TSX2    ERRMSG

      927    20074    3                  S_D.HOST_MESSAGE_BUF.C = ' ';

  20074  2 002726   000000 470400 xsym               LDP0    S_D$
         2 002727   040100 100400                    MLR     fill='040'O
         2 002730   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002731   006435 000472                    ADSC9   3357,,PR0                cn=0,n=314

      928    20075    3                  MSG$ = ADDR(S_D.HOST_MESSAGE_BUF.C);

  20075  2 002732   000000 236000 xsym               LDQ     S_D$
         2 002733   006435 036003                    ADLQ    3357,DU
         2 002734   200536 756100                    STQ     MSG$,,AUTO

      929    20076    3                  MSG$ -> KF$MSG.MSG_ID = %KF_MSGC_EXCLDCB#;

  20076  2 002735   200536 471500                    LDP1    MSG$,,AUTO
         2 002736   011000 236003                    LDQ     4608,DU
         2 002737   100000 552140                    STBQ    0,'40'O,PR1

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:167  
      930    20077    3                  MSG$ -> KF$MSG.STATION = S_D.DO$ -> DEBUG$CMD.STATION_FID.TEXT;

  20077  2 002740   000031 473500                    LDP3    25,,PR0
         2 002741   040100 100500                    MLR     fill='040'O
         2 002742   300003 200010                    ADSC9   3,,PR3                   cn=1,n=8
         2 002743   100000 400010                    ADSC9   0,,PR1                   cn=2,n=8

      931    20078    3                  FPTWRITE_DBG = FPT_WRITE_DBG;

  20078  2 002744   000100 100400                    MLR     fill='000'O
         2 002745   000452 000060 1                  ADSC9   FPT_WRITE_DBG            cn=0,n=48
         2 002746   200456 000060                    ADSC9   FPTWRITE_DBG,,AUTO       cn=0,n=48

      932    20079    3                  FPTWRITE_DBG.BUF_ = VECTOR(S_D.HOST_MESSAGE_BUF.C);

  20079  2 002747   000035 235000 3                  LDA     29
         2 002750   000000 236000 xsym               LDQ     S_D$
         2 002751   006435 036003                    ADLQ    3357,DU
         2 002752   200462 757100                    STAQ    FPTWRITE_DBG+4,,AUTO

      933    20080    3                  FPTWRITE_DBG.V_ = VECTOR(FPTWRITE_DBG.V);

  20080  2 002753   000013 235000 3                  LDA     11
         2 002754   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 002755   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 002756   000466 036003                    ADLQ    310,DU
         2 002757   200456 757100                    STAQ    FPTWRITE_DBG,,AUTO

      934    20081    3                  FPTWRITE_DBG.V.DCB# = DCBNO;

  20081  2 002760   200036 720100                    LXL0    DCBNO,,AUTO
         2 002761   200466 740100                    STX0    FPTWRITE_DBG+8,,AUTO

      935    20082    3                  FPTWRITE_DBG.STATION_ = VECTOR(FROG_STATION);

  20082  2 002762   000036 237000 3                  LDAQ    30
         2 002763   200464 757100                    STAQ    FPTWRITE_DBG+6,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:168  

      936    20083    3                  CALL M$WRITE(FPTWRITE_DBG) ALTRET(ERRMSG);

  20083  2 002764   200456 630500                    EPPR0   FPTWRITE_DBG,,AUTO
         2 002765   440001 713400                    CLIMB   alt,write
         2 002766   401400 401760                    pmme    nvectors=4
         2 002767   011552 702000 2                  TSX2    ERRMSG

      937    20084    3                  FPTREAD_DBG = FPT_READ_DBG;

  20084  2 002770   000100 100400                    MLR     fill='000'O
         2 002771   000434 000070 1                  ADSC9   FPT_READ_DBG             cn=0,n=56
         2 002772   200440 000070                    ADSC9   FPTREAD_DBG,,AUTO        cn=0,n=56

      938    20085    3                  FPTREAD_DBG.BUF_ = VECTOR(S_D.HOST_MESSAGE_BUF.C);

  20085  2 002773   000035 235000 3                  LDA     29
         2 002774   000000 236000 xsym               LDQ     S_D$
         2 002775   006435 036003                    ADLQ    3357,DU
         2 002776   200444 757100                    STAQ    FPTREAD_DBG+4,,AUTO

      939    20086    3                  FPTREAD_DBG.V_ = VECTOR(FPTREAD_DBG.V);

  20086  2 002777   000040 235000 3                  LDA     32
         2 003000   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003001   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003002   000450 036003                    ADLQ    296,DU
         2 003003   200440 757100                    STAQ    FPTREAD_DBG,,AUTO

      940    20087    3                  FPTREAD_DBG.V.DCB# = DCBNO;

  20087  2 003004   200036 720100                    LXL0    DCBNO,,AUTO
         2 003005   200450 740100                    STX0    FPTREAD_DBG+8,,AUTO

      941    20088    3                  FPTREAD_DBG.STATION_ = VECTOR(FROG_STATION);

  20088  2 003006   000036 237000 3                  LDAQ    30
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:169  
         2 003007   200446 757100                    STAQ    FPTREAD_DBG+6,,AUTO

      942    20089    3                  CALL M$READ (FPTREAD_DBG) ALTRET(ERRMSG);

  20089  2 003010   200440 630500                    EPPR0   FPTREAD_DBG,,AUTO
         2 003011   440000 713400                    CLIMB   alt,read
         2 003012   401400 401760                    pmme    nvectors=4
         2 003013   011552 702000 2                  TSX2    ERRMSG

      943    20090    3                  IF MSG$ -> KF$MSG.MSG_SUBC ~= %KF_EXCLRSP_OK#

  20090  2 003014   200536 470500                    LDP0    MSG$,,AUTO
         2 003015   000000 236100                    LDQ     0,,PR0
         2 003016   000777 376003                    ANQ     511,DU
         2 003017   000001 116003                    CMPQ    1,DU
         2 003020   003056 600000 2                  TZE     s:20103

      944    20091    4                  THEN DO;

      945    20092    4                       IF MSG$ -> KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOTOK#

  20092  2 003021   000000 236100                    LDQ     0,,PR0
         2 003022   000777 316003                    CANQ    511,DU
         2 003023   003027 601000 2                  TNZ     s:20094

      946    20093    4                       THEN S_D.ERROR = 326; /* E@STATIONINUSE */

  20093  2 003024   000506 235007                    LDA     326,DL
         2 003025   000000 471400 xsym               LDP1    S_D$
         2 003026   100013 755100                    STA     11,,PR1

      947    20094    4                       IF MSG$ -> KF$MSG.MSG_SUBC = %KF_EXCLRSP_NOSTA#

  20094  2 003027   000000 236100                    LDQ     0,,PR0
         2 003030   000777 376003                    ANQ     511,DU
         2 003031   000002 116003                    CMPQ    2,DU
         2 003032   003036 601000 2                  TNZ     s:20096
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:170  

      948    20095    4                       THEN S_D.ERROR = 327; /* E@NOSUCHSTATION */

  20095  2 003033   000507 235007                    LDA     327,DL
         2 003034   000000 471400 xsym               LDP1    S_D$
         2 003035   100013 755100                    STA     11,,PR1

      949    20096    4                       FPTCLOSE_DBG = FPT_CLOSE_DBG;

  20096  2 003036   000100 100400                    MLR     fill='000'O
         2 003037   000150 000170 1                  ADSC9   FPT_CLOSE_DBG            cn=0,n=120
         2 003040   200366 000170                    ADSC9   FPTCLOSE_DBG,,AUTO       cn=0,n=120

      950    20097    4                       FPTCLOSE_DBG.V_ = VECTOR(FPTCLOSE_DBG.V);

  20097  2 003041   000013 235000 3                  LDA     11
         2 003042   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003043   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003044   000420 036003                    ADLQ    272,DU
         2 003045   200366 757100                    STAQ    FPTCLOSE_DBG,,AUTO

      951    20098    4                       FPTCLOSE_DBG.V.DCB# = S_D.DBGFEPDCB;

  20098  2 003046   000000 471400 xsym               LDP1    S_D$
         2 003047   105007 720100                    LXL0    2567,,PR1
         2 003050   200420 740100                    STX0    FPTCLOSE_DBG+26,,AUTO

      952    20099    4                       CALL M$CLOSE (FPTCLOSE_DBG) ALTRET(ERRMSG);

  20099  2 003051   200366 630500                    EPPR0   FPTCLOSE_DBG,,AUTO
         2 003052   450001 713400                    CLIMB   alt,close
         2 003053   406000 401760                    pmme    nvectors=13
         2 003054   011552 702000 2                  TSX2    ERRMSG

      953    20100    4                       GOTO ERR;

  20100  2 003055   011466 710000 2                  TRA     ERR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:171  

      954    20101    4                     END;
      955    20102                                                /* Set up schema */
      956    20103    3                  FPTOPEN = FPT_OPEN;

  20103  2 003056   000100 100400                    MLR     fill='000'O
         2 003057   000000 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         2 003060   200056 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

      957    20104    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);

  20104  2 003061   000014 235000 3                  LDA     12
         2 003062   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003063   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003064   000122 036003                    ADLQ    82,DU
         2 003065   200056 757100                    STAQ    FPTOPEN,,AUTO

      958    20105    3                  FPTOPEN.NAME_ = VECTOR(VLP_NAME);

  20105  2 003066   000015 235000 3                  LDA     13
         2 003067   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003070   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003071   000154 036003                    ADLQ    108,DU
         2 003072   200064 757100                    STAQ    FPTOPEN+6,,AUTO

      959    20106    3                  FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);

  20106  2 003073   000020 235000 3                  LDA     16
         2 003074   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003075   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003076   000164 036003                    ADLQ    116,DU
         2 003077   200102 757100                    STAQ    FPTOPEN+20,,AUTO

      960    20107    3                  FPTOPEN.V.ASN# = %FILE#;

  20107  2 003100   000001 236007                    LDQ     1,DL
         2 003101   200123 552104                    STBQ    FPTOPEN+37,'04'O,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:172  

      961    20108    3                  IF S_D.DO$ -> DEBUG$CMD.CG_FID.SIZE = 0

  20108  2 003102   000000 471400 xsym               LDP1    S_D$
         2 003103   100031 473500                    LDP3    25,,PR1
         2 003104   300005 236100                    LDQ     5,,PR3
         2 003105   000777 316003                    CANQ    511,DU
         2 003106   003114 601000 2                  TNZ     s:20114

      962    20109    4                  THEN DO;

      963    20110    4                       FPTOPEN.NAME_ = VECTOR(VLP_MONNAME);

  20110  2 003107   000022 237000 3                  LDAQ    18
         2 003110   200064 757100                    STAQ    FPTOPEN+6,,AUTO

      964    20111    4                       FPTOPEN.ACCT_ = VECTOR(VLP_SYSACCT);

  20111  2 003111   000020 237000 3                  LDAQ    16
         2 003112   200102 757100                    STAQ    FPTOPEN+20,,AUTO

      965    20112    4                     END;

  20112  2 003113   003215 710000 2                  TRA     s:20129

      966    20113    4                  ELSE DO;

      967    20114    4                       FPTFID = FPT_FID;

  20114  2 003114   000100 100400                    MLR     fill='000'O
         2 003115   000104 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 003116   200240 000140                    ADSC9   FPTFID,,AUTO             cn=0,n=96

      968    20115    4                       FPTFID.V_ = VECTOR(FPTFID.V);

  20115  2 003117   000013 235000 3                  LDA     11
         2 003120   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:173  
         2 003121   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003122   000264 036003                    ADLQ    180,DU
         2 003123   200240 757100                    STAQ    FPTFID,,AUTO

      969    20116    4                       FPTFID.NAME_ = VECTOR(VLP_NAME);

  20116  2 003124   000015 235000 3                  LDA     13
         2 003125   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003126   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003127   000154 036003                    ADLQ    108,DU
         2 003130   200244 757100                    STAQ    FPTFID+4,,AUTO

      970    20117    4                       FPTFID.ACCT_ = VECTOR(VLP_ACCT);

  20117  2 003131   000020 235000 3                  LDA     16
         2 003132   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003133   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003134   000164 036003                    ADLQ    116,DU
         2 003135   200246 757100                    STAQ    FPTFID+6,,AUTO

      971    20118    4                       FPTFID.PASS_ = VECTOR(VLP_PASS);

  20118  2 003136   000020 235000 3                  LDA     16
         2 003137   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003140   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003141   000166 036003                    ADLQ    118,DU
         2 003142   200250 757100                    STAQ    FPTFID+8,,AUTO

      972    20119    4                       FPTFID.SN_ = VECTOR(VLP_SN);

  20119  2 003143   000013 235000 3                  LDA     11
         2 003144   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003145   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003146   000150 036003                    ADLQ    104,DU
         2 003147   200252 757100                    STAQ    FPTFID+10,,AUTO

      973    20120    4                       FPTFID.WSN_ = VECTOR(VLP_WSN);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:174  

  20120  2 003150   000020 235000 3                  LDA     16
         2 003151   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003152   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003153   000170 036003                    ADLQ    120,DU
         2 003154   200254 757100                    STAQ    FPTFID+12,,AUTO

      974    20121    4                       FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);

  20121  2 003155   177640 235007                    LDA     65440,DL
         2 003156   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003157   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003160   000024 036000 3                  ADLQ    20
         2 003161   200256 757100                    STAQ    FPTFID+14,,AUTO

      975    20122    4                       FPTFID.RESULTS_ = VECTOR(VLR_FID);

  20122  2 003162   000025 235000 3                  LDA     21
         2 003163   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003164   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003165   000226 036003                    ADLQ    150,DU
         2 003166   200262 757100                    STAQ    FPTFID+18,,AUTO

      976    20123    4                       FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->DEBUG$CMD.CG_FID.TEXT,

  20123  2 003167   100031 473500                    LDP3    25,,PR1
         2 003170   300005 220100                    LDX0    5,,PR3
         2 003171   000777 360003                    ANX0    511,DU
         2 003172   000000 635010                    EAA     0,X0
         2 003173   000002 771000                    ARL     2
         2 003174   000140 135007                    SBLA    96,DL
         2 003175   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003176   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003177   000032 036000 3                  ADLQ    26
         2 003200   200242 757100                    STAQ    FPTFID+2,,AUTO

      977    20124    4                         0, S_D.DO$->DEBUG$CMD.CG_FID.SIZE));
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:175  
      978    20125    4                       CALL M$FID(FPTFID) ALTRET(ERRMSG);

  20125  2 003201   200240 630500                    EPPR0   FPTFID,,AUTO
         2 003202   420001 713400                    CLIMB   alt,+8193
         2 003203   404400 401760                    pmme    nvectors=10
         2 003204   011552 702000 2                  TSX2    ERRMSG

      979    20126    4                       IF ~VLR_FID.ACCT

  20126  2 003205   200226 236100                    LDQ     VLR_FID,,AUTO
         2 003206   000001 736000                    QLS     1
         2 003207   400000 376003                    ANQ     -131072,DU
         2 003210   400000 676003                    ERQ     -131072,DU
         2 003211   003215 600000 2                  TZE     s:20129

      980    20127    4                       THEN VLP_ACCT.ACCT# = B$JIT$ -> B$JIT.FACCN;

  20127  2 003212   000000 470400 xsym               LDP0    B$JIT$
         2 003213   000006 237100                    LDAQ    6,,PR0
         2 003214   200164 757100                    STAQ    VLP_ACCT,,AUTO

      981    20128    4                     END;

      982    20129    3                  IF S_D.SCHEMADCB = 0

  20129  2 003215   000000 470400 xsym               LDP0    S_D$
         2 003216   004705 235100                    LDA     2501,,PR0
         2 003217   003233 601000 2                  TNZ     s:20136

      983    20130    4                  THEN DO;

      984    20131    4                       CALL DFA$GET_FPRG_DCB (DCBNO);

  20131  2 003220   200036 631500                    EPPR1   DCBNO,,AUTO
         2 003221   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 003222   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003223   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:176  
         2 003224   000000 701000 xent               TSX1    DFA$GET_FPRG_DCB
         2 003225   000000 011000                    NOP     0

      985    20132    4                       S_D.SCHEMADCB = DCBNO;

  20132  2 003226   000000 470400 xsym               LDP0    S_D$
         2 003227   200036 235100                    LDA     DCBNO,,AUTO
         2 003230   004705 755100                    STA     2501,,PR0

      986    20133    4                       S_D.LMDCB = DCBNO;

  20133  2 003231   004774 755100                    STA     2556,,PR0

      987    20134    4                     END;

  20134  2 003232   003262 710000 2                  TRA     s:20145

      988    20135    4                  ELSE DO;

      989    20136    4                       IF DCBADDR(S_D.SCHEMADCB) -> F$DCB.FCD#

  20136  2 003233   000012 471400 3                  LDP1    10
         2 003234   100000 473500                    LDP3    0,,PR1
         2 003235   004705 720100                    LXL0    2501,,PR0
         2 003236   300000 474510                    LDP4    0,X0,PR3
         2 003237   400031 236100                    LDQ     25,,PR4
         2 003240   020000 316007                    CANQ    8192,DL
         2 003241   003257 600000 2                  TZE     s:20143

      990    20137    5                       THEN DO;

      991    20138    5                            FPT$CLOSE = FPT_CLOSE;

  20138  2 003242   000100 100400                    MLR     fill='000'O
         2 003243   000000 000170 xsym               ADSC9   FPT_CLOSE                cn=0,n=120
         2 003244   200274 000170                    ADSC9   FPT$CLOSE,,AUTO          cn=0,n=120

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:177  
      992    20139    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);

  20139  2 003245   000013 235000 3                  LDA     11
         2 003246   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003247   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003250   000326 036003                    ADLQ    214,DU
         2 003251   200274 757100                    STAQ    FPT$CLOSE,,AUTO

      993    20140    5                            FPT$CLOSE.V.DCB# = S_D.SCHEMADCB;

  20140  2 003252   200326 740100                    STX0    FPT$CLOSE+26,,AUTO

      994    20141    5                            CALL M$CLOSE (FPT$CLOSE) ALTRET(ERRMSG);

  20141  2 003253   200274 630500                    EPPR0   FPT$CLOSE,,AUTO
         2 003254   450001 713400                    CLIMB   alt,close
         2 003255   406000 401760                    pmme    nvectors=13
         2 003256   011552 702000 2                  TSX2    ERRMSG

      995    20142    5                          END;

      996    20143    4                       S_D.LMDCB = S_D.SCHEMADCB;

  20143  2 003257   000000 470400 xsym               LDP0    S_D$
         2 003260   004705 235100                    LDA     2501,,PR0
         2 003261   004774 755100                    STA     2556,,PR0

      997    20144    4                     END;

      998    20145    3                  FPTOPEN.V.DCB# = S_D.LMDCB;

  20145  2 003262   004774 720100                    LXL0    2556,,PR0
         2 003263   200122 740100                    STX0    FPTOPEN+36,,AUTO

      999    20146    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);

  20146  2 003264   200056 630500                    EPPR0   FPTOPEN,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:178  
         2 003265   450000 713400                    CLIMB   alt,open
         2 003266   410400 401760                    pmme    nvectors=18
         2 003267   011552 702000 2                  TSX2    ERRMSG

     1000    20147                                                /* Allocate context */
     1001    20148    3                  IF SUBSTR(DCBADDR(S_D.LMDCB) -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'

  20148  2 003270   000012 470400 3                  LDP0    10
         2 003271   000000 471500                    LDP1    0,,PR0
         2 003272   000000 473400 xsym               LDP3    S_D$
         2 003273   304774 720100                    LXL0    2556,,PR3
         2 003274   100000 474510                    LDP4    0,X0,PR1
         2 003275   040000 106500                    CMPC    fill='040'O
         2 003276   400010 200005                    ADSC9   8,,PR4                   cn=1,n=5
         2 003277   000615 000005 1                  ADSC9   AT+21                    cn=0,n=5
         2 003300   003304 601000 2                  TNZ     s:20150

     1002    20149    3                  THEN S_D.RUM_FEP = '1'B;

  20149  2 003301   400000 236003                    LDQ     -131072,DU
         2 003302   307017 756100                    STQ     3599,,PR3
         2 003303   003305 710000 2                  TRA     s:20151

     1003    20150    3                  ELSE S_D.RUM_FEP = '0'B;

  20150  2 003304   307017 450100                    STZ     3599,,PR3

     1004    20151    3                  RES = S_D.DO$ -> DEBUG$CMD.STATION_FID.TEXT;

  20151  2 003305   300031 475500                    LDP5    25,,PR3
         2 003306   040100 100500                    MLR     fill='040'O
         2 003307   500003 200010                    ADSC9   3,,PR5                   cn=1,n=8
         2 003310   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

     1005    20152    3                  RES_SIZE = S_D.DO$ -> DEBUG$CMD.STATION_FID.SIZE;

  20152  2 003311   300031 475500                    LDP5    25,,PR3
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:179  
         2 003312   500003 236100                    LDQ     3,,PR5
         2 003313   000033 772000                    QRL     27
         2 003314   200035 756100                    STQ     RES_SIZE,,AUTO

     1006    20153    3                  CALL DFA$SETUP_FPRG(S_D.DBGFEPDCB, RES, RES_SIZE, '1'B);

  20153  2 003315   000002 236000 3                  LDQ     2
         2 003316   200545 756100                    STQ     @WHICH_ONE+4,,AUTO
         2 003317   200035 635500                    EPPR5   RES_SIZE,,AUTO
         2 003320   200544 455500                    STP5    @WHICH_ONE+3,,AUTO
         2 003321   200033 636500                    EPPR6   RES,,AUTO
         2 003322   200543 456500                    STP6    @WHICH_ONE+2,,AUTO
         2 003323   000000 236000 xsym               LDQ     S_D$
         2 003324   005007 036003                    ADLQ    2567,DU
         2 003325   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 003326   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003327   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003330   000000 701000 xent               TSX1    DFA$SETUP_FPRG
         2 003331   000000 011000                    NOP     0

     1007    20154    3                  S_D.DEBUG_CMD = '1'B;

  20154  2 003332   400000 236003                    LDQ     -131072,DU
         2 003333   000000 470400 xsym               LDP0    S_D$
         2 003334   004665 756100                    STQ     2485,,PR0

     1008    20155    3                  TFPRG$ = S_D.CURRENT_FPRG_CONTEXT$;

  20155  2 003335   000102 236100                    LDQ     66,,PR0
         2 003336   200041 756100                    STQ     TFPRG$,,AUTO

     1009    20156                                                /* set up debug station */
     1010    20157    3                  TRMDBG = TRM_DBG;

  20157  2 003337   000100 100400                    MLR     fill='000'O
         2 003340   000476 000040 1                  ADSC9   TRM_DBG                  cn=0,n=32
         2 003341   200472 000040                    ADSC9   TRMDBG,,AUTO             cn=0,n=32
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:180  

     1011    20158    3                  TRMDBG.V_ = VECTOR(TRMDBG.V);

  20158  2 003342   000020 235000 3                  LDA     16
         2 003343   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003344   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003345   000500 036003                    ADLQ    320,DU
         2 003346   200472 757100                    STAQ    TRMDBG,,AUTO

     1012    20159    3                  TRMDBG.V.DCB# = S_D.DBGFEPDCB;

  20159  2 003347   005007 720100                    LXL0    2567,,PR0
         2 003350   200500 740100                    STX0    TRMDBG+6,,AUTO

     1013    20160    3                  TRMDBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);

  20160  2 003351   000020 235000 3                  LDA     16
         2 003352   200041 236100                    LDQ     TFPRG$,,AUTO
         2 003353   000002 036003                    ADLQ    2,DU
         2 003354   200474 757100                    STAQ    TRMDBG+2,,AUTO

     1014    20161    3                  CALL M$STRMATTR (TRMDBG) ALTRET(ERRMSG);

  20161  2 003355   200472 630500                    EPPR0   TRMDBG,,AUTO
         2 003356   560006 713400                    CLIMB   alt,+57350
         2 003357   401000 401760                    pmme    nvectors=3
         2 003360   011552 702000 2                  TSX2    ERRMSG

     1015    20162    3                  FPTEOM_DBG = FPT_EOM_DBG;

  20162  2 003361   000100 100400                    MLR     fill='000'O
         2 003362   000520 000050 1                  ADSC9   FPT_EOM_DBG              cn=0,n=40
         2 003363   200502 000050                    ADSC9   FPTEOM_DBG,,AUTO         cn=0,n=40

     1016    20163    3                  FPTEOM_DBG.V_ = VECTOR(FPTEOM_DBG.V);

  20163  2 003364   000013 235000 3                  LDA     11
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:181  
         2 003365   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003366   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003367   000510 036003                    ADLQ    328,DU
         2 003370   200502 757100                    STAQ    FPTEOM_DBG,,AUTO

     1017    20164    3                  FPTEOM_DBG.V.DCB# = S_D.DBGFEPDCB;

  20164  2 003371   000000 470400 xsym               LDP0    S_D$
         2 003372   005007 720100                    LXL0    2567,,PR0
         2 003373   200510 740100                    STX0    FPTEOM_DBG+6,,AUTO

     1018    20165    3                  FPTEOM_DBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);

  20165  2 003374   000020 235000 3                  LDA     16
         2 003375   200041 236100                    LDQ     TFPRG$,,AUTO
         2 003376   000002 036003                    ADLQ    2,DU
         2 003377   200504 757100                    STAQ    FPTEOM_DBG+2,,AUTO

     1019    20166    3                  CALL M$EOM (FPTEOM_DBG) ALTRET(ERRMSG);

  20166  2 003400   200502 630500                    EPPR0   FPTEOM_DBG,,AUTO
         2 003401   560003 713400                    CLIMB   alt,+57347
         2 003402   401000 401760                    pmme    nvectors=3
         2 003403   011552 702000 2                  TSX2    ERRMSG

     1020    20167    3                  CTLDBG = CTL_DBG;

  20167  2 003404   000100 100400                    MLR     fill='000'O
         2 003405   000542 000040 1                  ADSC9   CTL_DBG                  cn=0,n=32
         2 003406   200514 000040                    ADSC9   CTLDBG,,AUTO             cn=0,n=32

     1021    20168    3                  CTLDBG.V_ = VECTOR(CTLDBG.V);

  20168  2 003407   000020 235000 3                  LDA     16
         2 003410   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003411   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003412   000522 036003                    ADLQ    338,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:182  
         2 003413   200514 757100                    STAQ    CTLDBG,,AUTO

     1022    20169    3                  CTLDBG.V.DCB# = S_D.DBGFEPDCB;

  20169  2 003414   000000 470400 xsym               LDP0    S_D$
         2 003415   005007 720100                    LXL0    2567,,PR0
         2 003416   200522 740100                    STX0    CTLDBG+6,,AUTO

     1023    20170    3                  CTLDBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);

  20170  2 003417   000020 235000 3                  LDA     16
         2 003420   200041 236100                    LDQ     TFPRG$,,AUTO
         2 003421   000002 036003                    ADLQ    2,DU
         2 003422   200516 757100                    STAQ    CTLDBG+2,,AUTO

     1024    20171    3                  CALL M$STRMCTL (CTLDBG) ALTRET(ERRMSG);

  20171  2 003423   200514 630500                    EPPR0   CTLDBG,,AUTO
         2 003424   560000 713400                    CLIMB   alt,+57344
         2 003425   401000 401760                    pmme    nvectors=3
         2 003426   011552 702000 2                  TSX2    ERRMSG

     1025    20172    3                  FPTPROMPT_DBG = FPT_PROMPT_DBG;

  20172  2 003427   000100 100400                    MLR     fill='000'O
         2 003430   000556 000050 1                  ADSC9   FPT_PROMPT_DBG           cn=0,n=40
         2 003431   200524 000050                    ADSC9   FPTPROMPT_DBG,,AUTO      cn=0,n=40

     1026    20173    3                  FPTPROMPT_DBG.V_ = VECTOR(FPTPROMPT_DBG.V);

  20173  2 003432   000013 235000 3                  LDA     11
         2 003433   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 003434   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 003435   000532 036003                    ADLQ    346,DU
         2 003436   200524 757100                    STAQ    FPTPROMPT_DBG,,AUTO

     1027    20174    3                  FPTPROMPT_DBG.V.DCB# = S_D.DBGFEPDCB;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:183  

  20174  2 003437   000000 470400 xsym               LDP0    S_D$
         2 003440   005007 720100                    LXL0    2567,,PR0
         2 003441   200532 740100                    STX0    FPTPROMPT_DBG+6,,AUTO

     1028    20175    3                  FPTPROMPT_DBG.STATION_ = VECTOR(TFPRG$ -> FPRG$CONTEXT.RES);

  20175  2 003442   000020 235000 3                  LDA     16
         2 003443   200041 236100                    LDQ     TFPRG$,,AUTO
         2 003444   000002 036003                    ADLQ    2,DU
         2 003445   200526 757100                    STAQ    FPTPROMPT_DBG+2,,AUTO

     1029    20176    3                  CALL M$PROMPT (FPTPROMPT_DBG) ALTRET(ERRMSG);

  20176  2 003446   200524 630500                    EPPR0   FPTPROMPT_DBG,,AUTO
         2 003447   560002 713400                    CLIMB   alt,+57346
         2 003450   401000 401760                    pmme    nvectors=3
         2 003451   011552 702000 2                  TSX2    ERRMSG

     1030    20177    3                  GD$MSG = '0'B;

  20177  2 003452   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 003453   003100 060400                    CSL     bolr='003'O
         2 003454   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 003455   000000 004720                    BDSC    0,,PR0                   by=0,bit=0,n=2512

     1031    20178    3                  GD$MSG.FNC = %GD#RQSCONTROL;

  20178  2 003456   000000 236100                    LDQ     0,,PR0
         2 003457   000030 376000 3                  ANQ     24
         2 003460   032000 276003                    ORQ     13312,DU
         2 003461   000000 756100                    STQ     0,,PR0

     1032    20179    3                  CALL DFQ$WRITE_FD (TFPRG$) ALTRET(ERRMSG);

  20179  2 003462   200041 631500                    EPPR1   TFPRG$,,AUTO
         2 003463   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:184  
         2 003464   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003466   000000 701000 xent               TSX1    DFQ$WRITE_FD
         2 003467   011552 702000 2                  TSX2    ERRMSG

     1033    20180    3                  IF S_D.STAND_ALONE AND

  20180  2 003470   000000 470400 xsym               LDP0    S_D$
         2 003471   004624 234100                    SZN     2452,,PR0
         2 003472   003514 605000 2                  TPL     s:20192
         2 003473   004752 234100                    SZN     2538,,PR0
         2 003474   003514 604000 2                  TMI     s:20192
         2 003475   004625 234100                    SZN     2453,,PR0
         2 003476   003514 604000 2                  TMI     s:20192

     1034    20181    3                    NOT S_D.EOM AND
     1035    20182    3                    NOT S_D.BATCH
     1036    20183    4                  THEN DO;

     1037    20184    4                       CALL M$EOM (FPT_EOM) ALTRET(NOEOM1);

  20184  2 003477   000000 630400 xsym               EPPR0   FPT_EOM
         2 003500   560003 713400                    CLIMB   alt,+57347
         2 003501   401000 401760                    pmme    nvectors=3
         2 003502   003507 702000 2                  TSX2    NOEOM1

     1038    20185    4                       S_D.EOM = '1'B;

  20185  2 003503   400000 236003                    LDQ     -131072,DU
         2 003504   000000 470400 xsym               LDP0    S_D$
         2 003505   004752 756100                    STQ     2538,,PR0

     1039    20186    5                       DO WHILE ( '0'B );

  20186  2 003506   003514 710000 2                  TRA     s:20192

     1040    20187    5   NOEOM1:
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:185  
     1041    20188    5                            IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0

  20188  2 003507   000000 470400 xsym  NOEOM1       LDP0    B$TCB$
         2 003510   000000 471500                    LDP1    0,,PR0
         2 003511   100102 236100                    LDQ     66,,PR1
         2 003512   000007 316007                    CANQ    7,DL
         2 003513   011552 601000 2                  TNZ     ERRMSG

     1042    20189    5                            THEN GOTO ERRMSG;
     1043    20190    5                          END;

     1044    20191    4                     END;

     1045    20192    3                  S_D.FIRST_TIME = '1'B;

  20192  2 003514   400000 236003                    LDQ     -131072,DU
         2 003515   000000 470400 xsym               LDP0    S_D$
         2 003516   006725 756100                    STQ     3541,,PR0

     1046    20193    3                  GOTO DO_EVENT;

  20193  2 003517   011267 710000 2                  TRA     DO_EVENT

     1047    20194    3                END;
     1048    20195    2             ELSE S_D.DEBUGF = BITBIN( S_D.DO$ -> DEBUG$CMD.OPTIONS );

  20195  2 003520   100002 235100                    LDA     2,,PR1
         2 003521   000053 755100                    STA     43,,PR0

     1049    20196    2             IF S_D.STAND_ALONE AND

  20196  2 003522   004624 234100                    SZN     2452,,PR0
         2 003523   011447 605000 2                  TPL     NOGO
         2 003524   004752 234100                    SZN     2538,,PR0
         2 003525   011447 604000 2                  TMI     NOGO
         2 003526   004625 234100                    SZN     2453,,PR0
         2 003527   011447 604000 2                  TMI     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:186  

     1050    20197    2               NOT S_D.EOM AND
     1051    20198    2               NOT S_D.BATCH
     1052    20199    3             THEN DO;

     1053    20200    3                  CALL M$EOM (FPT_EOM) ALTRET(NOEOM);

  20200  2 003530   000000 630400 xsym               EPPR0   FPT_EOM
         2 003531   560003 713400                    CLIMB   alt,+57347
         2 003532   401000 401760                    pmme    nvectors=3
         2 003533   003540 702000 2                  TSX2    NOEOM

     1054    20201    3                  S_D.EOM = '1'B;

  20201  2 003534   400000 236003                    LDQ     -131072,DU
         2 003535   000000 470400 xsym               LDP0    S_D$
         2 003536   004752 756100                    STQ     2538,,PR0

     1055    20202    4                  DO WHILE ( '0'B );

  20202  2 003537   011447 710000 2                  TRA     NOGO

     1056    20203    4   NOEOM:
     1057    20204    4                       IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0

  20204  2 003540   000000 470400 xsym  NOEOM        LDP0    B$TCB$
         2 003541   000000 471500                    LDP1    0,,PR0
         2 003542   100102 236100                    LDQ     66,,PR1
         2 003543   000007 316007                    CANQ    7,DL
         2 003544   011552 601000 2                  TNZ     ERRMSG

     1058    20205    4                       THEN GOTO ERRMSG;
     1059    20206    4                     END;

     1060    20207    3                END;

  20207  2 003545   011447 710000 2                  TRA     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:187  

     1061    20208    2          CASE( 63 );                /* C_DELETE */

     1062    20209    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  20209  2 003546   006714 235100                    LDA     3532,,PR0
         2 003547   000002 115007                    CMPA    2,DL
         2 003550   011543 600000 2                  TZE     NOTIMPFPRG

     1063    20210    2             THEN GOTO NOTIMPFPRG;
     1064    20211    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  20211  2 003551   000031 236100                    LDQ     25,,PR0
         2 003552   000002 036003                    ADLQ    2,DU
         2 003553   000044 756100                    STQ     36,,PR0

     1065    20212    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20212  2 003554   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 003555   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003556   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003557   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003560   000000 701000 xent               TSX1    DDA$IF
         2 003561   011466 702000 2                  TSX2    ERR

     1066    20213    2             IF NOGO_BIT THEN RETURN;

  20213  2 003562   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 003563   003565 605000 2                  TPL     s:20214

  20213  2 003564   000000 702200 xent               TSX2  ! X66_ARET

     1067    20214    2             CALL DUA$DELETE;

  20214  2 003565   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003566   000000 701000 xent               TSX1    DUA$DELETE
         2 003567   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:188  
         2 003570   011447 710000 2                  TRA     NOGO

     1068    20215    2          CASE(4);                     /* DEF */

     1069    20216                                                /* POINT TO IFSPEC */
     1070    20217    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  20217  2 003571   000101 234100                    SZN     65,,PR0
         2 003572   003605 605000 2                  TPL     s:20225
         2 003573   000102 236100                    LDQ     66,,PR0
         2 003574   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003575   003605 600000 2                  TZE     s:20225

     1071    20218    3             THEN DO;

     1072    20219    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  20219  2 003576   000102 473500                    LDP3    66,,PR0
         2 003577   300001 236100                    LDQ     1,,PR3
         2 003600   200000 316003                    CANQ    65536,DU
         2 003601   003620 600000 2                  TZE     s:20231

     1073    20220    4                  THEN DO;

     1074    20221    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  20221  2 003602   000465 235007                    LDA     309,DL
         2 003603   000013 755100                    STA     11,,PR0

     1075    20222    4                       GOTO ERR;

  20222  2 003604   011466 710000 2                  TRA     ERR

     1076    20223    4                     END;
     1077    20224    3                END;
     1078    20225    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:189  
  20225  2 003605   000101 234100                    SZN     65,,PR0
         2 003606   003620 605000 2                  TPL     s:20231
         2 003607   000102 236100                    LDQ     66,,PR0
         2 003610   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003611   003620 601000 2                  TNZ     s:20231

     1079    20226    3                  THEN DO;

     1080    20227    3                       S_D.ERROR = 502;

  20227  2 003612   000766 235007                    LDA     502,DL
         2 003613   000013 755100                    STA     11,,PR0

     1081    20228    3                       CALL DDE$ERROR;

  20228  2 003614   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003615   000000 701000 xent               TSX1    DDE$ERROR
         2 003616   000000 011000                    NOP     0

     1082    20229    3                       GOTO ERR1;

  20229  2 003617   011506 710000 2                  TRA     ERR1

     1083    20230    3                     END;
     1084    20231    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DEF$CMD));

  20231  2 003620   000031 236100                    LDQ     25,,PR0
         2 003621   000012 036003                    ADLQ    10,DU
         2 003622   000044 756100                    STQ     36,,PR0

     1085    20232    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20232  2 003623   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 003624   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003625   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003626   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003627   000000 701000 xent               TSX1    DDA$IF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:190  
         2 003630   011466 702000 2                  TSX2    ERR

     1086    20233    2             IF NOGO_BIT THEN RETURN;

  20233  2 003631   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 003632   003634 605000 2                  TPL     s:20234

  20233  2 003633   000000 702200 xent               TSX2  ! X66_ARET

     1087    20234    2             CALL DDA$DEF ALTRET(ERR);

  20234  2 003634   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003635   000000 701000 xent               TSX1    DDA$DEF
         2 003636   011466 702000 2                  TSX2    ERR
         2 003637   011447 710000 2                  TRA     NOGO

     1088    20235    2          CASE( 37 );                   /* C_DIC */

     1089    20236    2             IF D_XDELTA THEN DX_DIC = '1'B;

  20236  2 003640   000000 234000 xsym               SZN     D_XDELTA
         2 003641   003645 605000 2                  TPL     s:20237

  20236  2 003642   400000 236003                    LDQ     -131072,DU
         2 003643   000000 756000 xsym               STQ     DX_DIC
         2 003644   011447 710000 2                  TRA     NOGO

     1090    20237    2             ELSE S_D.DEBUG = '0'B;

  20237  2 003645   004732 450100                    STZ     2522,,PR0
         2 003646   011447 710000 2                  TRA     NOGO

     1091    20238    2          CASE(60);                    /* DLCT */

     1092    20239    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(LCT$CMD));

  20239  2 003647   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:191  
         2 003650   000004 036003                    ADLQ    4,DU
         2 003651   000044 756100                    STQ     36,,PR0

     1093    20240    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20240  2 003652   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 003653   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003654   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003655   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003656   000000 701000 xent               TSX1    DDA$IF
         2 003657   011466 702000 2                  TSX2    ERR

     1094    20241    2             IF NOGO_BIT THEN RETURN;

  20241  2 003660   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 003661   003663 605000 2                  TPL     s:20242

  20241  2 003662   000000 702200 xent               TSX2  ! X66_ARET

     1095    20242    2             CALL DFA$DLCT ALTRET(ERR);

  20242  2 003663   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003664   000000 701000 xent               TSX1    DFA$DLCT
         2 003665   011466 702000 2                  TSX2    ERR
         2 003666   011447 710000 2                  TRA     NOGO

     1096    20243    2          CASE(5);                      /* DO */

     1097    20244    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  20244  2 003667   000031 236100                    LDQ     25,,PR0
         2 003670   000002 036003                    ADLQ    2,DU
         2 003671   000044 756100                    STQ     36,,PR0

     1098    20245    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20245  2 003672   200004 633500                    EPPR3   NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:192  
         2 003673   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003674   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003675   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003676   000000 701000 xent               TSX1    DDA$IF
         2 003677   011466 702000 2                  TSX2    ERR

     1099    20246    2             IF NOGO_BIT THEN RETURN;

  20246  2 003700   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 003701   003703 605000 2                  TPL     s:20247

  20246  2 003702   000000 702200 xent               TSX2  ! X66_ARET

     1100    20247    2             CALL DDA$USER_DO ALTRET(NOGO);

  20247  2 003703   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003704   000000 701000 xent               TSX1    DDA$USER_DO
         2 003705   011447 702000 2                  TSX2    NOGO

     1101    20248    2             ALTRETURN;

  20248  2 003706   000000 702200 xent               TSX2  ! X66_AALT

     1102    20249    2          CASE(6);                 /* DISPLAY */

     1103    20250                                                /* POINT S_D.D$ TO IFSPEC */
     1104    20251    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DISPLAY));

  20251  2 003707   000031 236100                    LDQ     25,,PR0
         2 003710   000002 036003                    ADLQ    2,DU
         2 003711   000044 756100                    STQ     36,,PR0

     1105    20252    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20252  2 003712   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 003713   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003714   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:193  
         2 003715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003716   000000 701000 xent               TSX1    DDA$IF
         2 003717   011466 702000 2                  TSX2    ERR

     1106    20253    2             IF NOGO_BIT THEN RETURN;

  20253  2 003720   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 003721   003723 605000 2                  TPL     s:20254

  20253  2 003722   000000 702200 xent               TSX2  ! X66_ARET

     1107    20254    2             CALL DDA$DISP ALTRET(ERR);

  20254  2 003723   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003724   000000 701000 xent               TSX1    DDA$DISP
         2 003725   011466 702000 2                  TSX2    ERR
         2 003726   011447 710000 2                  TRA     NOGO

     1108    20255    2          CASE(7);                    /* DUMP */

     1109    20256    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  20256  2 003727   000101 234100                    SZN     65,,PR0
         2 003730   003742 605000 2                  TPL     s:20262
         2 003731   000102 236100                    LDQ     66,,PR0
         2 003732   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003733   003742 601000 2                  TNZ     s:20262

     1110    20257    3             THEN DO;

     1111    20258    3                  S_D.ERROR = 502;

  20258  2 003734   000766 235007                    LDA     502,DL
         2 003735   000013 755100                    STA     11,,PR0

     1112    20259    3                  CALL DDE$ERROR;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:194  
  20259  2 003736   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003737   000000 701000 xent               TSX1    DDE$ERROR
         2 003740   000000 011000                    NOP     0

     1113    20260    3                  GOTO ERR1;

  20260  2 003741   011506 710000 2                  TRA     ERR1

     1114    20261    3                END;
     1115    20262    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DUMP$CMD));

  20262  2 003742   000031 236100                    LDQ     25,,PR0
         2 003743   000024 036003                    ADLQ    20,DU
         2 003744   000044 756100                    STQ     36,,PR0

     1116    20263    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20263  2 003745   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 003746   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 003747   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 003750   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003751   000000 701000 xent               TSX1    DDA$IF
         2 003752   011466 702000 2                  TSX2    ERR

     1117    20264    2             IF NOGO_BIT THEN RETURN;

  20264  2 003753   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 003754   003756 605000 2                  TPL     s:20265

  20264  2 003755   000000 702200 xent               TSX2  ! X66_ARET

     1118    20265    2             IF S_D.DO$->DUMP$CMD.FID.SIZE>0 AND NOT S_D.DO$->DUMP$CMD.DEST

  20265  2 003756   000000 470400 xsym               LDP0    S_D$
         2 003757   000031 471500                    LDP1    25,,PR0
         2 003760   100004 236100                    LDQ     4,,PR1
         2 003761   777000 316003                    CANQ    -512,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:195  
         2 003762   003772 600000 2                  TZE     s:20267
         2 003763   100001 236100                    LDQ     1,,PR1
         2 003764   100000 316003                    CANQ    32768,DU
         2 003765   003772 601000 2                  TNZ     s:20267

     1119    20266    2             THEN CALL DFA$DFMT ALTRET(ERR);

  20266  2 003766   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003767   000000 701000 xent               TSX1    DFA$DFMT
         2 003770   011466 702000 2                  TSX2    ERR
         2 003771   011447 710000 2                  TRA     NOGO

     1120    20267    3             ELSE DO CASE ( S_D.ONE_TO_TWO.EXEC_DOMAIN );

  20267  2 003772   006714 235100                    LDA     3532,,PR0
         2 003773   000003 115007                    CMPA    3,DL
         2 003774   003776 602005 2                  TNC     s:20267+4,AL
         2 003775   004011 710000 2                  TRA     s:20273
         2 003776   004011 710000 2                  TRA     s:20273
         2 003777   004001 710000 2                  TRA     s:20269
         2 004000   004005 710000 2                  TRA     s:20271

     1121    20268    3               CASE ( %HOST );

     1122    20269    3                  CALL DDA$DUMP_DO ALTRET(ERR);

  20269  2 004001   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004002   000000 701000 xent               TSX1    DDA$DUMP_DO
         2 004003   011466 702000 2                  TSX2    ERR
         2 004004   011447 710000 2                  TRA     NOGO

     1123    20270    3               CASE ( %L6 );

     1124    20271    3                  CALL DFA$DUMP ALTRET ( ERR );

  20271  2 004005   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004006   000000 701000 xent               TSX1    DFA$DUMP
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:196  
         2 004007   011466 702000 2                  TSX2    ERR
         2 004010   011447 710000 2                  TRA     NOGO

     1125    20272    3               CASE ( ELSE );

     1126    20273    3                  S_D.ERROR = 502;    /* E@DELBUG */

  20273  2 004011   000766 236007                    LDQ     502,DL
         2 004012   000013 756100                    STQ     11,,PR0

     1127    20274    3                  ALTRETURN;

  20274  2 004013   000000 702200 xent               TSX2  ! X66_AALT

     1128    20275    3               END;

     1129    20276    2          CASE(33);                    /* ECHO */

     1130    20277    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  20277  2 004014   000031 236100                    LDQ     25,,PR0
         2 004015   000002 036003                    ADLQ    2,DU
         2 004016   000044 756100                    STQ     36,,PR0

     1131    20278    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20278  2 004017   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004020   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004021   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004023   000000 701000 xent               TSX1    DDA$IF
         2 004024   011466 702000 2                  TSX2    ERR

     1132    20279    2             IF NOGO_BIT THEN RETURN;

  20279  2 004025   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004026   004030 605000 2                  TPL     s:20280
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:197  

  20279  2 004027   000000 702200 xent               TSX2  ! X66_ARET

     1133    20280    2             IF NOT D_XDELTA THEN S_D.ECHO = '1'B;

  20280  2 004030   000000 234000 xsym               SZN     D_XDELTA
         2 004031   004036 604000 2                  TMI     s:20282

  20280  2 004032   400000 236003                    LDQ     -131072,DU
         2 004033   000000 470400 xsym               LDP0    S_D$
         2 004034   004743 756100                    STQ     2531,,PR0
         2 004035   011447 710000 2                  TRA     NOGO

     1134    20281    2             ELSE
     1135    20282    2                  CALL SETDCTX( ECHO_DEV );

  20282  2 004036   000041 236000 3                  LDQ     33
         2 004037   200541 756100                    STQ     MSG$+3,,AUTO
         2 004040   011556 701000 2                  TSX1    SETDCTX
         2 004041   000000 011000                    NOP     0
         2 004042   011447 710000 2                  TRA     NOGO

     1136    20283    2          CASE(35);                     /*C_EOM*/

     1137    20284    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));

  20284  2 004043   000031 236100                    LDQ     25,,PR0
         2 004044   000002 036003                    ADLQ    2,DU
         2 004045   000044 756100                    STQ     36,,PR0

     1138    20285    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);

  20285  2 004046   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004047   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004050   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004051   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004052   000000 701000 xent               TSX1    DDA$IF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:198  
         2 004053   011466 702000 2                  TSX2    ERR

     1139    20286    2             IF NOGO_BIT THEN RETURN;

  20286  2 004054   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004055   004057 605000 2                  TPL     s:20287

  20286  2 004056   000000 702200 xent               TSX2  ! X66_ARET

     1140    20287    2             IF ( NOT D_XDELTA ) AND ( NOT S_D.BATCH )

  20287  2 004057   000000 234000 xsym               SZN     D_XDELTA
         2 004060   011447 604000 2                  TMI     NOGO
         2 004061   000000 470400 xsym               LDP0    S_D$
         2 004062   004625 234100                    SZN     2453,,PR0
         2 004063   011447 604000 2                  TMI     NOGO

     1141    20288    3             THEN DO;

     1142    20289    3                  CALL M$EOM (FPT_EOM) ALTRET(ERRMSG);

  20289  2 004064   000000 630400 xsym               EPPR0   FPT_EOM
         2 004065   560003 713400                    CLIMB   alt,+57347
         2 004066   401000 401760                    pmme    nvectors=3
         2 004067   011552 702000 2                  TSX2    ERRMSG

     1143    20290    3                  S_D.EOM = '1'B;

  20290  2 004070   400000 236003                    LDQ     -131072,DU
         2 004071   000000 470400 xsym               LDP0    S_D$
         2 004072   004752 756100                    STQ     2538,,PR0

     1144    20291    3                END;

  20291  2 004073   011447 710000 2                  TRA     NOGO

     1145    20292    2          CASE (86);                 /*C_ERRFID*/
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:199  

     1146    20293    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));

  20293  2 004074   000031 236100                    LDQ     25,,PR0
         2 004075   000002 036003                    ADLQ    2,DU
         2 004076   000044 756100                    STQ     36,,PR0

     1147    20294    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);

  20294  2 004077   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004100   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004101   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004103   000000 701000 xent               TSX1    DDA$IF
         2 004104   011466 702000 2                  TSX2    ERR

     1148    20295    2             IF NOGO_BIT THEN RETURN;

  20295  2 004105   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004106   004110 605000 2                  TPL     s:20296

  20295  2 004107   000000 702200 xent               TSX2  ! X66_ARET

     1149    20296    2             FPTFID = FPT_FID;

  20296  2 004110   000100 100400                    MLR     fill='000'O
         2 004111   000104 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 004112   200240 000140                    ADSC9   FPTFID,,AUTO             cn=0,n=96

     1150    20297    2             FPTFID.V_ = VECTOR(FPTFID.V);

  20297  2 004113   000013 235000 3                  LDA     11
         2 004114   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 004115   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 004116   000264 036003                    ADLQ    180,DU
         2 004117   200240 757100                    STAQ    FPTFID,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:200  
     1151    20298    2             FPTFID.NAME_ = VECTOR(S_D.ERRFID);

  20298  2 004120   000015 235000 3                  LDA     13
         2 004121   000000 236000 xsym               LDQ     S_D$
         2 004122   006747 036003                    ADLQ    3559,DU
         2 004123   200244 757100                    STAQ    FPTFID+4,,AUTO

     1152    20299    2             FPTFID.ACCT_ = VECTOR(S_D.ERRACCT);

  20299  2 004124   000020 235000 3                  LDA     16
         2 004125   000000 236000 xsym               LDQ     S_D$
         2 004126   006757 036003                    ADLQ    3567,DU
         2 004127   200246 757100                    STAQ    FPTFID+6,,AUTO

     1153    20300    2             FPTFID.PASS_ = VECTOR(S_D.ERRPASS);

  20300  2 004130   000020 235000 3                  LDA     16
         2 004131   000000 236000 xsym               LDQ     S_D$
         2 004132   006761 036003                    ADLQ    3569,DU
         2 004133   200250 757100                    STAQ    FPTFID+8,,AUTO

     1154    20301    2             FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->RUM$CMD.FID.TEXT,0,S_D.DO$->
             20301                      RUM$CMD.FID.SIZE));

  20301  2 004134   000000 470400 xsym               LDP0    S_D$
         2 004135   000031 471500                    LDP1    25,,PR0
         2 004136   100010 236100                    LDQ     8,,PR1
         2 004137   000033 772000                    QRL     27
         2 004140   000064 737000                    LLS     52
         2 004141   000140 135007                    SBLA    96,DL
         2 004142   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 004143   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 004144   000042 036000 3                  ADLQ    34
         2 004145   200242 757100                    STAQ    FPTFID+2,,AUTO

     1155    20302    2             FPTFID.SN_ = VECTOR(VLP_SN);

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:201  
  20302  2 004146   000013 235000 3                  LDA     11
         2 004147   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 004150   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 004151   000150 036003                    ADLQ    104,DU
         2 004152   200252 757100                    STAQ    FPTFID+10,,AUTO

     1156    20303    2             FPTFID.WSN_ = VECTOR(VLP_WSN);

  20303  2 004153   000020 235000 3                  LDA     16
         2 004154   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 004155   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 004156   000170 036003                    ADLQ    120,DU
         2 004157   200254 757100                    STAQ    FPTFID+12,,AUTO

     1157    20304    2             FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);

  20304  2 004160   177640 235007                    LDA     65440,DL
         2 004161   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 004162   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 004163   000024 036000 3                  ADLQ    20
         2 004164   200256 757100                    STAQ    FPTFID+14,,AUTO

     1158    20305    2             FPTFID.RESULTS_ = VECTOR(VLR_FID);

  20305  2 004165   000025 235000 3                  LDA     21
         2 004166   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 004167   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 004170   000226 036003                    ADLQ    150,DU
         2 004171   200262 757100                    STAQ    FPTFID+18,,AUTO

     1159    20306    2             CALL M$FID (FPTFID) ALTRET (ERRMSG);

  20306  2 004172   200240 630500                    EPPR0   FPTFID,,AUTO
         2 004173   420001 713400                    CLIMB   alt,+8193
         2 004174   404400 401760                    pmme    nvectors=10
         2 004175   011552 702000 2                  TSX2    ERRMSG
         2 004176   011447 710000 2                  TRA     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:202  

     1160    20307    2          CASE(8);                    /* EVAL */

     1161    20308    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  20308  2 004177   000101 234100                    SZN     65,,PR0
         2 004200   004213 605000 2                  TPL     s:20316
         2 004201   000102 236100                    LDQ     66,,PR0
         2 004202   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004203   004213 600000 2                  TZE     s:20316

     1162    20309    3             THEN DO;

     1163    20310    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  20310  2 004204   000102 473500                    LDP3    66,,PR0
         2 004205   300001 236100                    LDQ     1,,PR3
         2 004206   200000 316003                    CANQ    65536,DU
         2 004207   004226 600000 2                  TZE     s:20322

     1164    20311    4                  THEN DO;

     1165    20312    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  20312  2 004210   000465 235007                    LDA     309,DL
         2 004211   000013 755100                    STA     11,,PR0

     1166    20313    4                       GOTO ERR;

  20313  2 004212   011466 710000 2                  TRA     ERR

     1167    20314    4                     END;
     1168    20315    3                END;
     1169    20316    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  20316  2 004213   000101 234100                    SZN     65,,PR0
         2 004214   004226 605000 2                  TPL     s:20322
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:203  
         2 004215   000102 236100                    LDQ     66,,PR0
         2 004216   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004217   004226 601000 2                  TNZ     s:20322

     1170    20317    3                  THEN DO;

     1171    20318    3                       S_D.ERROR = 502;

  20318  2 004220   000766 235007                    LDA     502,DL
         2 004221   000013 755100                    STA     11,,PR0

     1172    20319    3                       CALL DDE$ERROR;

  20319  2 004222   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004223   000000 701000 xent               TSX1    DDE$ERROR
         2 004224   000000 011000                    NOP     0

     1173    20320    3                       GOTO ERR1;

  20320  2 004225   011506 710000 2                  TRA     ERR1

     1174    20321    3                     END;
     1175    20322    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(EVAL$CMD));

  20322  2 004226   000031 236100                    LDQ     25,,PR0
         2 004227   000002 036003                    ADLQ    2,DU
         2 004230   000044 756100                    STQ     36,,PR0

     1176    20323    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20323  2 004231   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004232   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004233   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004235   000000 701000 xent               TSX1    DDA$IF
         2 004236   011466 702000 2                  TSX2    ERR

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:204  
     1177    20324    2             IF NOGO_BIT THEN RETURN;

  20324  2 004237   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004240   004242 605000 2                  TPL     s:20325

  20324  2 004241   000000 702200 xent               TSX2  ! X66_ARET

     1178    20325    2             CALL DDA$EVAL ALTRET(ERR);

  20325  2 004242   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004243   000000 701000 xent               TSX1    DDA$EVAL
         2 004244   011466 702000 2                  TSX2    ERR
         2 004245   011447 710000 2                  TRA     NOGO

     1179    20326    2          CASE ( 76 );                 /* C_EXIT */

     1180    20327    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  20327  2 004246   006714 235100                    LDA     3532,,PR0
         2 004247   000002 115007                    CMPA    2,DL
         2 004250   011543 600000 2                  TZE     NOTIMPFPRG

     1181    20328    2             THEN GOTO NOTIMPFPRG;
     1182    20329    2             IF S_D.ALIB

  20329  2 004251   005134 234100                    SZN     2652,,PR0
         2 004252   004256 605000 2                  TPL     s:20334

     1183    20330    3             THEN DO;

     1184    20331    3                  S_D.ERROR = 270; /* E@CANTEXITALIB */

  20331  2 004253   000416 235007                    LDA     270,DL
         2 004254   000013 755100                    STA     11,,PR0

     1185    20332    3                  GOTO ERR;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:205  
  20332  2 004255   011466 710000 2                  TRA     ERR

     1186    20333    3                END;
     1187    20334    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  20334  2 004256   000031 236100                    LDQ     25,,PR0
         2 004257   000002 036003                    ADLQ    2,DU
         2 004260   000044 756100                    STQ     36,,PR0

     1188    20335    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20335  2 004261   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004262   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004263   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004265   000000 701000 xent               TSX1    DDA$IF
         2 004266   011466 702000 2                  TSX2    ERR

     1189    20336    2             IF NOGO_BIT THEN RETURN;

  20336  2 004267   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004270   004272 605000 2                  TPL     s:20337

  20336  2 004271   000000 702200 xent               TSX2  ! X66_ARET

     1190    20337    2             TEMP$ = B$TCB$->B$TCB.STK$;

  20337  2 004272   000000 470400 xsym               LDP0    B$TCB$
         2 004273   000001 236100                    LDQ     1,,PR0
         2 004274   200025 756100                    STQ     TEMP$,,AUTO

     1191    20338    2             IF NOT S_D.LINK_ENTRY

  20338  2 004275   000000 471400 xsym               LDP1    S_D$
         2 004276   105140 234100                    SZN     2656,,PR1
         2 004277   004325 604000 2                  TMI     s:20352
         2 004300   200025 473500                    LDP3    TEMP$,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:206  
         2 004301   300000 720100                    LXL0    0,,PR3
         2 004302   000003 100003                    CMPX0   3,DU
         2 004303   004312 601000 2                  TNZ     s:20338+13
         2 004304   300101 236100                    LDQ     65,,PR3
         2 004305   777000 316003                    CANQ    -512,DU
         2 004306   004312 601000 2                  TNZ     s:20338+13
         2 004307   300100 236100                    LDQ     64,,PR3
         2 004310   010000 316003                    CANQ    4096,DU
         2 004311   004325 601000 2                  TNZ     s:20352
         2 004312   000140 100003                    CMPX0   96,DU
         2 004313   004322 601000 2                  TNZ     s:20349
         2 004314   300100 721100                    LXL1    64,,PR3
         2 004315   000006 101003                    CMPX1   6,DU
         2 004316   004322 601000 2                  TNZ     s:20349
         2 004317   300100 236100                    LDQ     64,,PR3
         2 004320   777000 316003                    CANQ    -512,DU
         2 004321   004325 601000 2                  TNZ     s:20352

     1192    20339    2               AND NOT(TEMP$->B$EXCFR.ECC = %ECC_XCON#
     1193    20340    2               AND TEMP$->B$XCON.RNST='0'B
     1194    20341    2               AND TEMP$->B$XCON.CECCB.LNK)
     1195    20342    2               AND NOT(TEMP$->B$EXCFR.ECC = %ECC_EXCRTN#
     1196    20343    2               AND TEMP$->B$EXCFR.SUBC = %SC_XCONXIT#
     1197    20344    2               AND TEMP$->B$XCON.CECCB ~= '000000000'B)
     1198    20345                                                /* EXIT is legal only
     1199    20346                                                 if current RU was entered via M$LINK
     1200    20347                                       or if this is an M$EXIT for M$LDTRC or M$SAVE */
     1201    20348    3             THEN DO;

     1202    20349    3                  S_D.ERROR = 158;  /*E@CANTEXIT*/

  20349  2 004322   000236 235007                    LDA     158,DL
         2 004323   100013 755100                    STA     11,,PR1

     1203    20350    3                  GOTO ERR;

  20350  2 004324   011466 710000 2                  TRA     ERR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:207  

     1204    20351    3                END;
     1205    20352    2             S_D.DRTN$->FPT$DRTN.V.ECC# = 3; /* SIMULATE XCON */

  20352  2 004325   104704 473500                    LDP3    2500,,PR1
         2 004326   000003 220003                    LDX0    3,DU
         2 004327   300013 440100                    SXL0    11,,PR3

     1206    20353    2             CALL DDA$GO ALTRET (NOXCON);

  20353  2 004330   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004331   000000 701000 xent               TSX1    DDA$GO
         2 004332   011457 702000 2                  TSX2    NOXCON

     1207    20354    2             S_D.E$XIT = '1'B;             /* SET EXIT FLAG FOR DDA$DELTA */

  20354  2 004333   400000 236003                    LDQ     -131072,DU
         2 004334   000000 470400 xsym               LDP0    S_D$
         2 004335   005137 756100                    STQ     2655,,PR0

     1208    20355    2             ALTRETURN;

  20355  2 004336   000000 702200 xent               TSX2  ! X66_AALT

     1209    20356    2          CASE(10);                    /* FIND */

     1210    20357    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  20357  2 004337   006714 235100                    LDA     3532,,PR0
         2 004340   000002 115007                    CMPA    2,DL
         2 004341   011543 600000 2                  TZE     NOTIMPFPRG

     1211    20358    2             THEN GOTO NOTIMPFPRG;
     1212    20359    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  20359  2 004342   000101 234100                    SZN     65,,PR0
         2 004343   004356 605000 2                  TPL     s:20367
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:208  
         2 004344   000102 236100                    LDQ     66,,PR0
         2 004345   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004346   004356 600000 2                  TZE     s:20367

     1213    20360    3             THEN DO;

     1214    20361    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  20361  2 004347   000102 473500                    LDP3    66,,PR0
         2 004350   300001 236100                    LDQ     1,,PR3
         2 004351   200000 316003                    CANQ    65536,DU
         2 004352   004371 600000 2                  TZE     s:20373

     1215    20362    4                  THEN DO;

     1216    20363    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  20363  2 004353   000465 235007                    LDA     309,DL
         2 004354   000013 755100                    STA     11,,PR0

     1217    20364    4                       GOTO ERR;

  20364  2 004355   011466 710000 2                  TRA     ERR

     1218    20365    4                     END;
     1219    20366    3                END;
     1220    20367    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  20367  2 004356   000101 234100                    SZN     65,,PR0
         2 004357   004371 605000 2                  TPL     s:20373
         2 004360   000102 236100                    LDQ     66,,PR0
         2 004361   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004362   004371 601000 2                  TNZ     s:20373

     1221    20368    3                  THEN DO;

     1222    20369    3                       S_D.ERROR = 502;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:209  

  20369  2 004363   000766 235007                    LDA     502,DL
         2 004364   000013 755100                    STA     11,,PR0

     1223    20370    3                       CALL DDE$ERROR;

  20370  2 004365   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004366   000000 701000 xent               TSX1    DDE$ERROR
         2 004367   000000 011000                    NOP     0

     1224    20371    3                       GOTO ERR1;

  20371  2 004370   011506 710000 2                  TRA     ERR1

     1225    20372    3                     END;
     1226    20373    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(FIND$CMD));

  20373  2 004371   000031 236100                    LDQ     25,,PR0
         2 004372   000005 036003                    ADLQ    5,DU
         2 004373   000044 756100                    STQ     36,,PR0

     1227    20374    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);

  20374  2 004374   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004375   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004376   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004377   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004400   000000 701000 xent               TSX1    DDA$IF
         2 004401   011466 702000 2                  TSX2    ERR

     1228    20375    2             IF NOGO_BIT THEN RETURN;

  20375  2 004402   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004403   004405 605000 2                  TPL     s:20376

  20375  2 004404   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:210  
     1229    20376    2             CALL DDA$FIND ALTRET(ERR);

  20376  2 004405   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004406   000000 701000 xent               TSX1    DDA$FIND
         2 004407   011466 702000 2                  TSX2    ERR
         2 004410   011447 710000 2                  TRA     NOGO

     1230    20377    2          CASE(16);                  /* C_FORMAT */

     1231    20378    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(FORMAT$CMD));

  20378  2 004411   000031 236100                    LDQ     25,,PR0
         2 004412   000002 036003                    ADLQ    2,DU
         2 004413   000044 756100                    STQ     36,,PR0

     1232    20379    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20379  2 004414   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004415   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004416   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004417   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004420   000000 701000 xent               TSX1    DDA$IF
         2 004421   011466 702000 2                  TSX2    ERR

     1233    20380    2             IF NOGO_BIT THEN RETURN;

  20380  2 004422   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004423   004425 605000 2                  TPL     s:20381

  20380  2 004424   000000 702200 xent               TSX2  ! X66_ARET

     1234    20381    2             IF S_D.DO$->FORMAT$CMD.TYPE = 61 /*C@MODIFY*/

  20381  2 004425   000000 470400 xsym               LDP0    S_D$
         2 004426   000031 471500                    LDP1    25,,PR0
         2 004427   100001 236100                    LDQ     1,,PR1
         2 004430   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:211  
         2 004431   075000 116003                    CMPQ    31232,DU
         2 004432   004440 601000 2                  TNZ     s:20383

     1235    20382    2             THEN S_D.FMT_DEFAULT = S_D.DO$->FORMAT$CMD.FORMAT;

  20382  2 004433   100001 236100                    LDQ     1,,PR1
         2 004434   000022 772000                    QRL     18
         2 004435   000777 376007                    ANQ     511,DL
         2 004436   000723 756100                    STQ     467,,PR0
         2 004437   011447 710000 2                  TRA     NOGO

     1236    20383    2             ELSE IF S_D.DO$->FORMAT$CMD.TYPE = 60 /*C@EVAL*/

  20383  2 004440   074000 116003                    CMPQ    30720,DU
         2 004441   004447 601000 2                  TNZ     s:20386

     1237    20384    2                  THEN S_D.EFMT_DEFAULT = S_D.DO$->FORMAT$CMD.FORMAT;

  20384  2 004442   100001 236100                    LDQ     1,,PR1
         2 004443   000022 772000                    QRL     18
         2 004444   000777 376007                    ANQ     511,DL
         2 004445   004736 756100                    STQ     2526,,PR0
         2 004446   011447 710000 2                  TRA     NOGO

     1238    20385    3                  ELSE DO;

     1239    20386    3                       S_D.ERROR = 502; /*E@DELBUG*/

  20386  2 004447   000766 235007                    LDA     502,DL
         2 004450   000013 755100                    STA     11,,PR0

     1240    20387    3                       GOTO ERR;

  20387  2 004451   011466 710000 2                  TRA     ERR

     1241    20388    3                     END;
     1242    20389    2          CASE(11);                    /* GOTO */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:212  

     1243    20390    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(GO$CMD));

  20390  2 004452   000031 236100                    LDQ     25,,PR0
         2 004453   000005 036003                    ADLQ    5,DU
         2 004454   000044 756100                    STQ     36,,PR0

     1244    20391    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20391  2 004455   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 004456   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 004457   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 004460   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004461   000000 701000 xent               TSX1    DDA$IF
         2 004462   011466 702000 2                  TSX2    ERR

     1245    20392    2             IF NOGO_BIT THEN RETURN;

  20392  2 004463   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 004464   004466 605000 2                  TPL     s:20393

  20392  2 004465   000000 702200 xent               TSX2  ! X66_ARET

     1246    20393    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.GOPOS

  20393  2 004466   000000 470400 xsym               LDP0    S_D$
         2 004467   005134 234100                    SZN     2652,,PR0
         2 004470   004500 605000 2                  TPL     s:20398
         2 004471   000031 471500                    LDP1    25,,PR0
         2 004472   100001 236100                    LDQ     1,,PR1
         2 004473   400000 316007                    CANQ    -131072,DL
         2 004474   004500 600000 2                  TZE     s:20398

     1247    20394    3             THEN DO;

     1248    20395    3                  S_D.ERROR = 217; /*E@CANTGOALIB*/

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:213  
  20395  2 004475   000331 235007                    LDA     217,DL
         2 004476   000013 755100                    STA     11,,PR0

     1249    20396    3                  GOTO ERR;

  20396  2 004477   011466 710000 2                  TRA     ERR

     1250    20397    3                END;
     1251    20398    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.TRAP AND S_D.DO$->GO$CMD.STEP

  20398  2 004500   005134 234100                    SZN     2652,,PR0
         2 004501   004513 605000 2                  TPL     s:20403
         2 004502   000031 471500                    LDP1    25,,PR0
         2 004503   100001 236100                    LDQ     1,,PR1
         2 004504   100000 316007                    CANQ    32768,DL
         2 004505   004513 600000 2                  TZE     s:20403
         2 004506   200000 316007                    CANQ    65536,DL
         2 004507   004513 600000 2                  TZE     s:20403

     1252    20399    3             THEN DO;

     1253    20400    3                  S_D.ERROR = 268; /* E@CANTGOTSALIB */

  20400  2 004510   000414 235007                    LDA     268,DL
         2 004511   000013 755100                    STA     11,,PR0

     1254    20401    3                  GOTO ERR;

  20401  2 004512   011466 710000 2                  TRA     ERR

     1255    20402    3                END;
     1256    20403    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.TRAP

  20403  2 004513   005134 234100                    SZN     2652,,PR0
         2 004514   004524 605000 2                  TPL     s:20408
         2 004515   000031 471500                    LDP1    25,,PR0
         2 004516   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:214  
         2 004517   100000 316007                    CANQ    32768,DL
         2 004520   004524 600000 2                  TZE     s:20408

     1257    20404    3             THEN DO;

     1258    20405    3                  S_D.ERROR = 266; /* E@CANTGOTRPALIB */

  20405  2 004521   000412 235007                    LDA     266,DL
         2 004522   000013 755100                    STA     11,,PR0

     1259    20406    3                  GOTO ERR;

  20406  2 004523   011466 710000 2                  TRA     ERR

     1260    20407    3                END;
     1261    20408    2             IF S_D.DO$ -> GO$CMD.TRAP AND S_D.DO$ -> GO$CMD.STEP AND

  20408  2 004524   000031 471500                    LDP1    25,,PR0
         2 004525   100001 236100                    LDQ     1,,PR1
         2 004526   100000 316007                    CANQ    32768,DL
         2 004527   004546 600000 2                  TZE     s:20417
         2 004530   200000 316007                    CANQ    65536,DL
         2 004531   004546 600000 2                  TZE     s:20417
         2 004532   000101 234100                    SZN     65,,PR0
         2 004533   004546 605000 2                  TPL     s:20417
         2 004534   000102 236100                    LDQ     66,,PR0
         2 004535   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004536   004546 600000 2                  TZE     s:20417

     1262    20409    2               S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)
     1263    20410    3             THEN DO;

     1264    20411    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  20411  2 004537   000102 473500                    LDP3    66,,PR0
         2 004540   300001 236100                    LDQ     1,,PR3
         2 004541   200000 316003                    CANQ    65536,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:215  
         2 004542   004561 600000 2                  TZE     s:20423

     1265    20412    4                  THEN DO;

     1266    20413    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  20413  2 004543   000465 235007                    LDA     309,DL
         2 004544   000013 755100                    STA     11,,PR0

     1267    20414    4                       GOTO ERR;

  20414  2 004545   011466 710000 2                  TRA     ERR

     1268    20415    4                     END;
     1269    20416    3                END;
     1270    20417    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  20417  2 004546   000101 234100                    SZN     65,,PR0
         2 004547   004561 605000 2                  TPL     s:20423
         2 004550   000102 236100                    LDQ     66,,PR0
         2 004551   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004552   004561 601000 2                  TNZ     s:20423

     1271    20418    3                  THEN DO;

     1272    20419    3                       S_D.ERROR = 502;

  20419  2 004553   000766 235007                    LDA     502,DL
         2 004554   000013 755100                    STA     11,,PR0

     1273    20420    3                       CALL DDE$ERROR;

  20420  2 004555   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004556   000000 701000 xent               TSX1    DDE$ERROR
         2 004557   000000 011000                    NOP     0

     1274    20421    3                       GOTO ERR1;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:216  

  20421  2 004560   011506 710000 2                  TRA     ERR1

     1275    20422    3                     END;
     1276    20423    2             IF S_D.ALIB AND S_D.DO$->GO$CMD.STEP

  20423  2 004561   005134 234100                    SZN     2652,,PR0
         2 004562   004571 605000 2                  TPL     s:20428
         2 004563   100001 236100                    LDQ     1,,PR1
         2 004564   200000 316007                    CANQ    65536,DL
         2 004565   004571 600000 2                  TZE     s:20428

     1277    20424    3             THEN DO;

     1278    20425    3                  S_D.ERROR = 267; /* E@CANTGOSTPALIB */

  20425  2 004566   000413 235007                    LDA     267,DL
         2 004567   000013 755100                    STA     11,,PR0

     1279    20426    3                  GOTO ERR;

  20426  2 004570   011466 710000 2                  TRA     ERR

     1280    20427    3                END;
     1281    20428    2             IF S_D.FPRG_CONTEXT$ ~= ADDR(NIL) AND

  20428  2 004571   000076 236100                    LDQ     62,,PR0
         2 004572   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004573   004604 600000 2                  TZE     s:20435
         2 004574   100001 236100                    LDQ     1,,PR1
         2 004575   040000 316007                    CANQ    16384,DL
         2 004576   004604 600000 2                  TZE     s:20435
         2 004577   100000 316007                    CANQ    32768,DL
         2 004600   004604 600000 2                  TZE     s:20435

     1282    20429    2               S_D.DO$ -> GO$CMD.ALL AND
     1283    20430    2               S_D.DO$ -> GO$CMD.TRAP
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:217  
     1284    20431    3             THEN DO;

     1285    20432    3                  S_D.ERROR = 279; /* E@CANTGOTRAPFPRG */

  20432  2 004601   000427 235007                    LDA     279,DL
         2 004602   000013 755100                    STA     11,,PR0

     1286    20433    3                  GOTO ERR;

  20433  2 004603   011466 710000 2                  TRA     ERR

     1287    20434    3                END;
     1288    20435    2             IF S_D.FPRG_CONTEXT$ ~= ADDR(NIL) AND

  20435  2 004604   000076 236100                    LDQ     62,,PR0
         2 004605   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004606   004617 600000 2                  TZE     s:20442
         2 004607   100001 236100                    LDQ     1,,PR1
         2 004610   040000 316007                    CANQ    16384,DL
         2 004611   004617 600000 2                  TZE     s:20442
         2 004612   200000 316007                    CANQ    65536,DL
         2 004613   004617 600000 2                  TZE     s:20442

     1289    20436    2               S_D.DO$ -> GO$CMD.ALL AND
     1290    20437    2               S_D.DO$ -> GO$CMD.STEP
     1291    20438    3             THEN DO;

     1292    20439    3                  S_D.ERROR = 280; /* E@CANTGOSTEPFPRG */

  20439  2 004614   000430 235007                    LDA     280,DL
         2 004615   000013 755100                    STA     11,,PR0

     1293    20440    3                  GOTO ERR;

  20440  2 004616   011466 710000 2                  TRA     ERR

     1294    20441    3                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:218  
     1295    20442    2             S_D.STEP_L6 = '0'B;

  20442  2 004617   005274 450100                    STZ     2748,,PR0

     1296    20443    2             IF S_D.DO$ -> GO$CMD.TRAP AND

  20443  2 004620   100001 236100                    LDQ     1,,PR1
         2 004621   100000 316007                    CANQ    32768,DL
         2 004622   004632 600000 2                  TZE     s:20449
         2 004623   400000 316007                    CANQ    -131072,DL
         2 004624   004632 600000 2                  TZE     s:20449

     1297    20444    2               S_D.DO$ -> GO$CMD.GOPOS
     1298    20445    3             THEN DO;

     1299    20446    3                  S_D.GOTRAPPOS = '1'B;

  20446  2 004625   400000 236003                    LDQ     -131072,DU
         2 004626   006721 756100                    STQ     3537,,PR0

     1300    20447    3                  S_D.GOTRAP_POSITION = S_D.DO$ -> GO$CMD.POSITION;

  20447  2 004627   100002 235100                    LDA     2,,PR1
         2 004630   006722 755100                    STA     3538,,PR0

     1301    20448    3                END;

  20448  2 004631   004633 710000 2                  TRA     s:20450

     1302    20449    2             ELSE S_D.GOTRAPPOS = '0'B;

  20449  2 004632   006721 450100                    STZ     3537,,PR0

     1303    20450    3             IF S_D.PATCH THEN DO;

  20450  2 004633   004754 234100                    SZN     2540,,PR0
         2 004634   004644 605000 2                  TPL     s:20457
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:219  

     1304    20451    3                  S_D.PATCH = '0'B;

  20451  2 004635   004754 450100                    STZ     2540,,PR0

     1305    20452    3                  S_D.PADDR = 0;

  20452  2 004636   004765 450100                    STZ     2549,,PR0

     1306    20453        /* SET THE ECHO TO ME AFTER ALL MONITOR PATCHES HAVE BEEN APPLIED */
     1307    20454    3                  ECHO_DEV = DCTX_ME;

  20454  2 004637   000000 235000 xsym               LDA     DCTX_ME
         2 004640   000000 755000 xsym               STA     ECHO_DEV

     1308    20455    3                  CALL DXC$EOP;            /* WRITE THE MONITOR */

  20455  2 004641   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004642   000000 701000 xent               TSX1    DXC$EOP
         2 004643   000000 011000                    NOP     0

     1309    20456    3                END;

     1310    20457    2             IF S_D.DO$ -> GO$CMD.HOST OR

  20457  2 004644   000000 470400 xsym               LDP0    S_D$
         2 004645   000031 471500                    LDP1    25,,PR0
         2 004646   100001 236100                    LDQ     1,,PR1
         2 004647   020000 316007                    CANQ    8192,DL
         2 004650   004656 601000 2                  TNZ     s:20461
         2 004651   040000 316007                    CANQ    16384,DL
         2 004652   004756 600000 2                  TZE     s:20501
         2 004653   000076 236100                    LDQ     62,,PR0
         2 004654   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004655   004756 601000 2                  TNZ     s:20501

     1311    20458    2               (S_D.DO$ -> GO$CMD.ALL AND
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:220  
     1312    20459    2               S_D.FPRG_CONTEXT$ = ADDR(NIL))
     1313    20460    3             THEN DO;

     1314    20461    3                  IF S_D.DO$ -> GO$CMD.GOPOS

  20461  2 004656   100001 236100                    LDQ     1,,PR1
         2 004657   400000 316007                    CANQ    -131072,DL
         2 004660   004665 600000 2                  TZE     GOHOST

     1315    20462    4                  THEN DO;

     1316    20463    4                       S_D.SAVEIC = S_D.DO$->GO$CMD.POSITION;

  20463  2 004661   100002 235100                    LDA     2,,PR1
         2 004662   000002 755100                    STA     2,,PR0

     1317    20464    4                       S_D.FAULTCMD$ = ADDR(NIL);

  20464  2 004663   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 004664   000004 756100                    STQ     4,,PR0

     1318    20465    4                     END;

     1319    20466    3   GOHOST:
     1320    20467    4                  IF S_D.DO$->GO$CMD.TRAP THEN DO;

  20467  2 004665   000000 470400 xsym  GOHOST       LDP0    S_D$
         2 004666   000031 471500                    LDP1    25,,PR0
         2 004667   100001 236100                    LDQ     1,,PR1
         2 004670   100000 316007                    CANQ    32768,DL
         2 004671   004713 600000 2                  TZE     s:20487

     1321    20468    4                       IF S_D.SV.DELENT = 0

  20468  2 004672   000037 235100                    LDA     31,,PR0
         2 004673   004677 601000 2                  TNZ     s:20474

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:221  
     1322    20469    5                       THEN DO;

     1323    20470    5                            S_D.ERROR = 100; /*E@NO_TRAP*/

  20470  2 004674   000144 235007                    LDA     100,DL
         2 004675   000013 755100                    STA     11,,PR0

     1324    20471    5                            GOTO ERR;

  20471  2 004676   011466 710000 2                  TRA     ERR

     1325    20472    5                          END;
     1326    20473    5                       ELSE DO;

     1327    20474    5                            IF D_XDELTA

  20474  2 004677   000000 234000 xsym               SZN     D_XDELTA
         2 004700   004706 605000 2                  TPL     s:20480

     1328    20475    6                            THEN DO;

     1329    20476    6                                 S_D.RETURNN = 1/*RET_LTRAD*/;

  20476  2 004701   000001 235007                    LDA     1,DL
         2 004702   000012 755100                    STA     10,,PR0

     1330    20477    6                                 S_D.SAVEIC = S_D.GOIC;
             20477                                          /* Put back the unaltered fault ic */

  20477  2 004703   000001 235100                    LDA     1,,PR0
         2 004704   000002 755100                    STA     2,,PR0

     1331    20478    6                               END;

  20478  2 004705   004713 710000 2                  TRA     s:20487

     1332    20479    6                            ELSE DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:222  

     1333    20480    6                                 S_D.DRTN$->FPT$DRTN.V.SETECC# = '0'B;

  20480  2 004706   004704 473500                    LDP3    2500,,PR0
         2 004707   000043 236000 3                  LDQ     35
         2 004710   300013 356100                    ANSQ    11,,PR3

     1334    20481    6                                 S_D.FAULTCMD$ = ADDR(NIL);

  20481  2 004711   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 004712   000004 756100                    STQ     4,,PR0

     1335    20482                                                /* WE DON'T NEED TO DO ANY FANCY STUFF,
     1336    20483                                           'CAUSE WE AREN'T GOING TO SAVEIC ANYWAY */
     1337    20484    6                               END;

     1338    20485    5                          END;

     1339    20486    4                     END;

     1340    20487    3                  DO$ = S_D.DO$;

  20487  2 004713   000031 236100                    LDQ     25,,PR0
         2 004714   200044 756100                    STQ     DO$,,AUTO

     1341    20488    4                  IF S_D.DO$->GO$CMD.STEP THEN DO;

  20488  2 004715   000031 471500                    LDP1    25,,PR0
         2 004716   100001 236100                    LDQ     1,,PR1
         2 004717   200000 316007                    CANQ    65536,DL
         2 004720   004727 600000 2                  TZE     s:20492

     1342    20489    4                       S_D.S$TEP.CUR_COUNT = 1; /* STEP ONLY ONCE */

  20489  2 004721   000001 235007                    LDA     1,DL
         2 004722   005307 755100                    STA     2759,,PR0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:223  
     1343    20490    4                       CALL DDA$STEP_MORE ALTRET(ERR);

  20490  2 004723   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004724   000000 701000 xent               TSX1    DDA$STEP_MORE
         2 004725   011466 702000 2                  TSX2    ERR

     1344    20491    4                     END;

  20491  2 004726   004740 710000 2                  TRA     s:20495

     1345    20492    3                  ELSE IF S_D.S$TEP.ACTIVE THEN

  20492  2 004727   005276 234100                    SZN     2750,,PR0
         2 004730   004735 605000 2                  TPL     s:20494

     1346    20493    3                            CALL DDA$STEP_MORE ALTRET(ERR);
             20493                                     /* CONTINUE INTERRUPTED STEP */

  20493  2 004731   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004732   000000 701000 xent               TSX1    DDA$STEP_MORE
         2 004733   011466 702000 2                  TSX2    ERR
         2 004734   004740 710000 2                  TRA     s:20495

     1347    20494    3                       ELSE CALL DDA$GO ALTRET(NOGO);

  20494  2 004735   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004736   000000 701000 xent               TSX1    DDA$GO
         2 004737   011447 702000 2                  TSX2    NOGO

     1348    20495    3                  IF DO$ -> GO$CMD.HOST AND

  20495  2 004740   200044 470500                    LDP0    DO$,,AUTO
         2 004741   000001 236100                    LDQ     1,,PR0
         2 004742   020000 316007                    CANQ    8192,DL
         2 004743   004752 600000 2                  TZE     s:20498
         2 004744   000000 471400 xsym               LDP1    S_D$
         2 004745   100076 236100                    LDQ     62,,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:224  
         2 004746   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004747   004752 600000 2                  TZE     s:20498

     1349    20496    3                    S_D.FPRG_CONTEXT$ ~= ADDR(NIL)
     1350    20497    3                  THEN CALL REPORT_STOPPED;

  20497  2 004750   011634 701000 2                  TSX1    REPORT_STOPPED
         2 004751   000000 011000                    NOP     0

     1351    20498    3                  CALL DDA$RESET_PATCH_SPACE;

  20498  2 004752   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004753   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 004754   000000 011000                    NOP     0

     1352    20499    3                  ALTRETURN;

  20499  2 004755   000000 702200 xent               TSX2  ! X66_AALT

     1353    20500    3                END;
     1354    20501    2             IF (S_D.DO$ -> GO$CMD.ALL AND

  20501  2 004756   100001 236100                    LDQ     1,,PR1
         2 004757   040000 316007                    CANQ    16384,DL
         2 004760   005036 600000 2                  TZE     s:20526
         2 004761   000076 236100                    LDQ     62,,PR0
         2 004762   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004763   005036 600000 2                  TZE     s:20526

     1355    20502    2               S_D.FPRG_CONTEXT$ ~= ADDR(NIL))
     1356    20503    3             THEN DO;

     1357    20504    3                  TFPRG$ = S_D.FPRG_CONTEXT$;

  20504  2 004764   200041 756100                    STQ     TFPRG$,,AUTO

     1358    20505    4                  DO WHILE (TFPRG$ ~= ADDR(NIL));
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:225  

  20505  2 004765   005007 710000 2                  TRA     s:20513

     1359    20506    4                       IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED AND

  20506  2 004766   200041 470500                    LDP0    TFPRG$,,AUTO
         2 004767   000001 236100                    LDQ     1,,PR0
         2 004770   000777 376003                    ANQ     511,DU
         2 004771   000002 116003                    CMPQ    2,DU
         2 004772   005004 601000 2                  TNZ     s:20512
         2 004773   000001 234100                    SZN     1,,PR0
         2 004774   005004 604000 2                  TMI     s:20512

     1360    20507    4                         TFPRG$ -> FPRG$CONTEXT.READ_FD = '0'B
     1361    20508    5                       THEN DO;

     1362    20509    5                            S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;

  20509  2 004775   200041 236100                    LDQ     TFPRG$,,AUTO
         2 004776   000000 471400 xsym               LDP1    S_D$
         2 004777   100102 756100                    STQ     66,,PR1

     1363    20510    5                            CALL DFA$GO('1'B) ALTRET(NOGO);

  20510  2 005000   000002 630400 3                  EPPR0   2
         2 005001   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005002   000000 701000 xent               TSX1    DFA$GO
         2 005003   011447 702000 2                  TSX2    NOGO

     1364    20511    5                          END;

     1365    20512    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  20512  2 005004   200041 470500                    LDP0    TFPRG$,,AUTO
         2 005005   000000 236100                    LDQ     0,,PR0
         2 005006   200041 756100                    STQ     TFPRG$,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:226  
     1366    20513    4                     END;

  20513  2 005007   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005010   004766 601000 2                  TNZ     s:20506

     1367    20514    3                  CALL DDA$RESET_PATCH_SPACE;

  20514  2 005011   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005012   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 005013   000000 011000                    NOP     0

     1368    20515    3                  IF S_D.DEBUG_CMD

  20515  2 005014   000000 470400 xsym               LDP0    S_D$
         2 005015   004665 234100                    SZN     2485,,PR0
         2 005016   011234 604000 2                  TMI     WAIT_SEARCH

     1369    20516    3                  THEN GOTO WAIT_SEARCH;
     1370    20517    3                  CALL DFA$KILL_FPRG;

  20517  2 005017   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005020   000000 701000 xent               TSX1    DFA$KILL_FPRG
         2 005021   000000 011000                    NOP     0

     1371    20518    3                  TFPRG$ = S_D.FPRG_CONTEXT$;

  20518  2 005022   000000 470400 xsym               LDP0    S_D$
         2 005023   000076 236100                    LDQ     62,,PR0
         2 005024   200041 756100                    STQ     TFPRG$,,AUTO

     1372    20519    4                  DO WHILE(TFPRG$ ~= ADDR(NIL));

  20519  2 005025   005033 710000 2                  TRA     s:20523

     1373    20520    4                       IF TFPRG$ -> FPRG$CONTEXT.READ_FD

  20520  2 005026   200041 470500                    LDP0    TFPRG$,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:227  
         2 005027   000001 234100                    SZN     1,,PR0
         2 005030   011267 604000 2                  TMI     DO_EVENT

     1374    20521    4                       THEN GOTO DO_EVENT;
     1375    20522    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  20522  2 005031   000000 236100                    LDQ     0,,PR0
         2 005032   200041 756100                    STQ     TFPRG$,,AUTO

     1376    20523    4                     END;

  20523  2 005033   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005034   005026 601000 2                  TNZ     s:20520

     1377    20524    3                  GOTO GOHOST;

  20524  2 005035   004665 710000 2                  TRA     GOHOST

     1378    20525    3                END;
     1379    20526    2             IF S_D.DO$ -> GO$CMD.FPRG

  20526  2 005036   100001 236100                    LDQ     1,,PR1
         2 005037   010000 316007                    CANQ    4096,DL
         2 005040   011447 600000 2                  TZE     NOGO

     1380    20527    3             THEN DO;

     1381    20528    3                  RES = S_D.DO$ -> GO$CMD.FPRG_RES;

  20528  2 005041   040100 100500                    MLR     fill='040'O
         2 005042   100003 000010                    ADSC9   3,,PR1                   cn=0,n=8
         2 005043   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

     1382    20529    3                  IF S_D.FPRG_CONTEXT$ = ADDR(NIL)

  20529  2 005044   000076 236100                    LDQ     62,,PR0
         2 005045   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:228  
         2 005046   005052 601000 2                  TNZ     s:20534

     1383    20530    4                  THEN DO;

     1384    20531    4                       S_D.ERROR = 281; /* E@NOFPRGGO */

  20531  2 005047   000431 235007                    LDA     281,DL
         2 005050   000013 755100                    STA     11,,PR0

     1385    20532    4                       GOTO ERR;

  20532  2 005051   011466 710000 2                  TRA     ERR

     1386    20533    4                     END;
     1387    20534    3                  TFPRG$ = S_D.FPRG_CONTEXT$;

  20534  2 005052   200041 756100                    STQ     TFPRG$,,AUTO

     1388    20535    4                  DO WHILE (TFPRG$ -> FPRG$CONTEXT.RES ~= RES);

  20535  2 005053   200041 471500                    LDP1    TFPRG$,,AUTO
         2 005054   040100 106500                    CMPC    fill='040'O
         2 005055   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         2 005056   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8
         2 005057   005076 600000 2                  TZE     s:20543

     1389    20536    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  20536  2 005060   200041 470500                    LDP0    TFPRG$,,AUTO
         2 005061   000000 236100                    LDQ     0,,PR0
         2 005062   200041 756100                    STQ     TFPRG$,,AUTO

     1390    20537    4                       IF TFPRG$ = ADDR(NIL)

  20537  2 005063   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005064   005071 601000 2                  TNZ     s:20542

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:229  
     1391    20538    5                       THEN DO;

     1392    20539    5                            S_D.ERROR = 278; /* E@NOFPRG */

  20539  2 005065   000426 235007                    LDA     278,DL
         2 005066   000000 470400 xsym               LDP0    S_D$
         2 005067   000013 755100                    STA     11,,PR0

     1393    20540    5                            GOTO ERR;

  20540  2 005070   011466 710000 2                  TRA     ERR

     1394    20541    5                          END;
     1395    20542    4                     END;

  20542  2 005071   200041 470500                    LDP0    TFPRG$,,AUTO
         2 005072   040100 106500                    CMPC    fill='040'O
         2 005073   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         2 005074   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8
         2 005075   005060 601000 2                  TNZ     s:20536

     1396    20543    3                  S_D.CURRENT_FPRG_CONTEXT$ =TFPRG$;

  20543  2 005076   000000 470400 xsym               LDP0    S_D$
         2 005077   000102 756100                    STQ     66,,PR0

     1397    20544    3                  IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED OR

  20544  2 005100   200041 471500                    LDP1    TFPRG$,,AUTO
         2 005101   100001 236100                    LDQ     1,,PR1
         2 005102   000777 376003                    ANQ     511,DU
         2 005103   000002 116003                    CMPQ    2,DU
         2 005104   005107 600000 2                  TZE     s:20546
         2 005105   000004 116003                    CMPQ    4,DU
         2 005106   005114 601000 2                  TNZ     s:20548

     1398    20545    3                    TFPRG$ -> FPRG$CONTEXT.STATE = %ATEXIT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:230  
     1399    20546    3                  THEN CALL DFA$GO('1'B) ALTRET(NOGO);

  20546  2 005107   000002 630400 3                  EPPR0   2
         2 005110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005111   000000 701000 xent               TSX1    DFA$GO
         2 005112   011447 702000 2                  TSX2    NOGO
         2 005113   005117 710000 2                  TRA     s:20551

     1400    20547    4                  ELSE DO;

     1401    20548    4                       S_D.ERROR = 282; /* E@FPRGNOTSTOPPED */

  20548  2 005114   000432 235007                    LDA     282,DL
         2 005115   000013 755100                    STA     11,,PR0

     1402    20549    4                       GOTO ERR;

  20549  2 005116   011466 710000 2                  TRA     ERR

     1403    20550    4                     END;
     1404    20551    3                  CALL DDA$RESET_PATCH_SPACE;

  20551  2 005117   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005120   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 005121   000000 011000                    NOP     0

     1405    20552    3                  IF S_D.DEBUG_CMD

  20552  2 005122   000000 470400 xsym               LDP0    S_D$
         2 005123   004665 234100                    SZN     2485,,PR0
         2 005124   011234 604000 2                  TMI     WAIT_SEARCH

     1406    20553    3                  THEN GOTO WAIT_SEARCH;
     1407    20554    3                  CALL DFA$KILL_FPRG;

  20554  2 005125   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005126   000000 701000 xent               TSX1    DFA$KILL_FPRG
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:231  
         2 005127   000000 011000                    NOP     0

     1408    20555    3                  CALL REPORT_STOPPED;

  20555  2 005130   011634 701000 2                  TSX1    REPORT_STOPPED
         2 005131   000000 011000                    NOP     0

     1409    20556    3                  IF S_D.DO$ -> GO$CMD.STEP

  20556  2 005132   000000 470400 xsym               LDP0    S_D$
         2 005133   000031 471500                    LDP1    25,,PR0
         2 005134   100001 236100                    LDQ     1,,PR1
         2 005135   200000 316007                    CANQ    65536,DL
         2 005136   005140 600000 2                  TZE     s:20561

     1410    20557    4                  THEN DO;

     1411    20558                                                /* Do an implicit WAIT */
     1412    20559    4                       GOTO WAIT_SEARCH;

  20559  2 005137   011234 710000 2                  TRA     WAIT_SEARCH

     1413    20560    4                     END;
     1414    20561    3                  CALL DDR$REPORT(28/*R_STOP*/);

  20561  2 005140   000045 630400 3                  EPPR0   37
         2 005141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005142   000000 701000 xent               TSX1    DDR$REPORT
         2 005143   000000 011000                    NOP     0

     1415    20562    3                END;

  20562  2 005144   011447 710000 2                  TRA     NOGO

     1416    20563    2          CASE(12, 80, 81); /* HELP, QMARK1, QMARK2 */

     1417    20564    2             IF D_XDELTA
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:232  

  20564  2 005145   000000 234000 xsym               SZN     D_XDELTA
         2 005146   005152 605000 2                  TPL     s:20569

     1418    20565    3             THEN DO;

     1419    20566    3                  S_D.ERROR = 173; /* E@HELP_XDELTA */

  20566  2 005147   000255 235007                    LDA     173,DL
         2 005150   000013 755100                    STA     11,,PR0

     1420    20567    3                  GOTO ERR;

  20567  2 005151   011466 710000 2                  TRA     ERR

     1421    20568    3                END;
     1422    20569    2             CALL DUA$HELP;

  20569  2 005152   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005153   000000 701000 xent               TSX1    DUA$HELP
         2 005154   000000 011000                    NOP     0
         2 005155   011447 710000 2                  TRA     NOGO

     1423    20570    2          CASE(13);                 /* HISTORY */

     1424    20571    2             S_D.D$=PINCRW(S_D.DO$, SIZEW(HIST$CMD));

  20571  2 005156   000031 236100                    LDQ     25,,PR0
         2 005157   000003 036003                    ADLQ    3,DU
         2 005160   000044 756100                    STQ     36,,PR0

     1425    20572    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);

  20572  2 005161   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005162   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005163   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005164   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:233  
         2 005165   000000 701000 xent               TSX1    DDA$IF
         2 005166   011466 702000 2                  TSX2    ERR

     1426    20573    2             IF NOGO_BIT THEN RETURN;

  20573  2 005167   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005170   005172 605000 2                  TPL     s:20574

  20573  2 005171   000000 702200 xent               TSX2  ! X66_ARET

     1427    20574    2             CALL DDA$HIST;

  20574  2 005172   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005173   000000 701000 xent               TSX1    DDA$HIST
         2 005174   000000 011000                    NOP     0
         2 005175   011447 710000 2                  TRA     NOGO

     1428    20575    2          CASE(17, 71);          /* C_IGNORE, C_TRAP */

     1429    20576    2             S_D.D$=PINCRW(S_D.DO$, SIZEW(KEEP$CMD));

  20576  2 005176   000031 236100                    LDQ     25,,PR0
         2 005177   000005 036003                    ADLQ    5,DU
         2 005200   000044 756100                    STQ     36,,PR0

     1430    20577    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20577  2 005201   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005202   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005203   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005204   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005205   000000 701000 xent               TSX1    DDA$IF
         2 005206   011466 702000 2                  TSX2    ERR

     1431    20578    2             IF NOGO_BIT THEN RETURN;

  20578  2 005207   200004 234100                    SZN     NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:234  
         2 005210   005212 605000 2                  TPL     s:20579

  20578  2 005211   000000 702200 xent               TSX2  ! X66_ARET

     1432    20579    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  20579  2 005212   000000 470400 xsym               LDP0    S_D$
         2 005213   006714 235100                    LDA     3532,,PR0
         2 005214   000001 115007                    CMPA    1,DL
         2 005215   005222 601000 2                  TNZ     s:20584

     1433    20580    2             THEN CALL DDA$KEEP;      /* IT ALL BECOMES CLEAR WHEN YOU REMEMBER

  20580  2 005216   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005217   000000 701000 xent               TSX1    DDA$KEEP
         2 005220   000000 011000                    NOP     0
         2 005221   011447 710000 2                  TRA     NOGO

     1434    20581                                           THAT KEEP/TRAP/IGNORE ARE A MATCHED SET,
     1435    20582                                           BUT KEEP IN USER DELTA AND KEEP IN XDELTA
     1436    20583                                           MEAN TWO DIFFERENT THINGS */
     1437    20584    2             ELSE CALL DFA$KEEP ALTRET(NOGO);

  20584  2 005222   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005223   000000 701000 xent               TSX1    DFA$KEEP
         2 005224   011447 702000 2                  TSX2    NOGO
         2 005225   011447 710000 2                  TRA     NOGO

     1438    20585    2          CASE(20);                    /* KILL */

     1439    20586    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SHOW$CMD));

  20586  2 005226   000031 236100                    LDQ     25,,PR0
         2 005227   000036 036003                    ADLQ    30,DU
         2 005230   000044 756100                    STQ     36,,PR0

     1440    20587    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:235  

  20587  2 005231   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005232   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005233   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005235   000000 701000 xent               TSX1    DDA$IF
         2 005236   011466 702000 2                  TSX2    ERR

     1441    20588    2             IF NOGO_BIT THEN RETURN;

  20588  2 005237   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005240   005242 605000 2                  TPL     s:20589

  20588  2 005241   000000 702200 xent               TSX2  ! X66_ARET

     1442    20589    2             CALL  DDA$KILL;

  20589  2 005242   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005243   000000 701000 xent               TSX1    DDA$KILL
         2 005244   000000 011000                    NOP     0
         2 005245   011447 710000 2                  TRA     NOGO

     1443    20590    2          CASE(22);                    /* KEEP */

     1444    20591    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  20591  2 005246   000031 236100                    LDQ     25,,PR0
         2 005247   000002 036003                    ADLQ    2,DU
         2 005250   000044 756100                    STQ     36,,PR0

     1445    20592    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20592  2 005251   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005252   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005253   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005254   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005255   000000 701000 xent               TSX1    DDA$IF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:236  
         2 005256   011466 702000 2                  TSX2    ERR

     1446    20593    2             IF NOGO_BIT THEN RETURN;

  20593  2 005257   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005260   005262 605000 2                  TPL     s:20595

  20593  2 005261   000000 702200 xent               TSX2  ! X66_ARET

     1447    20594                                           /* REMEMBER THE KEEP TYPE (ALL, NONE, MON) */
     1448    20595    2             IF D_XDELTA

  20595  2 005262   000000 234000 xsym               SZN     D_XDELTA
         2 005263   005310 605000 2                  TPL     s:20604

     1449    20596    3             THEN DO;

     1450    20597    3                  S_D.K$EEP.TYPE = S_D.DO$->DOO.ID;

  20597  2 005264   000000 470400 xsym               LDP0    S_D$
         2 005265   000031 471500                    LDP1    25,,PR0
         2 005266   100001 236100                    LDQ     1,,PR1
         2 005267   000022 772000                    QRL     18
         2 005270   004626 756100                    STQ     2454,,PR0

     1451    20598    3                  IF S_D.K$EEP.TYPE = 4 OR /* KEEP_SCREECH */

  20598  2 005271   000004 116007                    CMPQ    4,DL
         2 005272   005277 600000 2                  TZE     s:20601
         2 005273   000003 116007                    CMPQ    3,DL
         2 005274   005277 600000 2                  TZE     s:20601
         2 005275   000001 116007                    CMPQ    1,DL
         2 005276   005303 601000 2                  TNZ     s:20602

     1452    20599    3                    S_D.K$EEP.TYPE = 3 OR /* KEEP_MON */
     1453    20600    3                    S_D.K$EEP.TYPE = 1 /* KEEP_ALL */
     1454    20601    3                  THEN PINCRW(MIS$, IRM_NOKP_SCR)->UBIN36 = 0;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:237  

  20601  2 005277   000000 473400 xsym               LDP3    MIS$
         2 005300   000000 720000 xsym               LXL0    IRM_NOKP_SCR
         2 005301   300000 450110                    STZ     0,X0,PR3
         2 005302   011447 710000 2                  TRA     NOGO

     1455    20602    3                  ELSE PINCRW(MIS$, IRM_NOKP_SCR)->UBIN36 = 1;

  20602  2 005303   000001 235007                    LDA     1,DL
         2 005304   000000 473400 xsym               LDP3    MIS$
         2 005305   000000 720000 xsym               LXL0    IRM_NOKP_SCR
         2 005306   300000 755110                    STA     0,X0,PR3

     1456    20603    3                END;

  20603  2 005307   011447 710000 2                  TRA     NOGO

     1457    20604    2             ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  20604  2 005310   000000 470400 xsym               LDP0    S_D$
         2 005311   006714 235100                    LDA     3532,,PR0
         2 005312   000001 115007                    CMPA    1,DL
         2 005313   005320 601000 2                  TNZ     s:20606

     1458    20605    2                  THEN CALL DDA$KEEP;

  20605  2 005314   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005315   000000 701000 xent               TSX1    DDA$KEEP
         2 005316   000000 011000                    NOP     0
         2 005317   011447 710000 2                  TRA     NOGO

     1459    20606    2                  ELSE CALL DFA$KEEP ALTRET(NOGO);

  20606  2 005320   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005321   000000 701000 xent               TSX1    DFA$KEEP
         2 005322   011447 702000 2                  TSX2    NOGO
         2 005323   011447 710000 2                  TRA     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:238  

     1460    20607    2          CASE(27);                     /* LET  */

     1461    20608    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(LET$CMD));

  20608  2 005324   000031 236100                    LDQ     25,,PR0
         2 005325   000022 036003                    ADLQ    18,DU
         2 005326   000044 756100                    STQ     36,,PR0

     1462    20609    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20609  2 005327   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005330   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005331   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005332   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005333   000000 701000 xent               TSX1    DDA$IF
         2 005334   011466 702000 2                  TSX2    ERR

     1463    20610    2             IF NOGO_BIT THEN RETURN;

  20610  2 005335   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005336   005340 605000 2                  TPL     s:20611

  20610  2 005337   000000 702200 xent               TSX2  ! X66_ARET

     1464    20611    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  20611  2 005340   000000 470400 xsym               LDP0    S_D$
         2 005341   006714 235100                    LDA     3532,,PR0
         2 005342   000001 115007                    CMPA    1,DL
         2 005343   005350 601000 2                  TNZ     s:20613

     1465    20612    2             THEN CALL DDA$LET  ALTRET(ERR);

  20612  2 005344   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005345   000000 701000 xent               TSX1    DDA$LET
         2 005346   011466 702000 2                  TSX2    ERR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:239  
         2 005347   011447 710000 2                  TRA     NOGO

     1466    20613    2             ELSE CALL DFA$LET  ALTRET(ERR);

  20613  2 005350   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005351   000000 701000 xent               TSX1    DFA$LET
         2 005352   011466 702000 2                  TSX2    ERR
         2 005353   011447 710000 2                  TRA     NOGO

     1467    20614    2          CASE( 62 );                  /* C_LIST */

     1468    20615    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  20615  2 005354   000031 236100                    LDQ     25,,PR0
         2 005355   000002 036003                    ADLQ    2,DU
         2 005356   000044 756100                    STQ     36,,PR0

     1469    20616    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20616  2 005357   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005360   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005361   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005363   000000 701000 xent               TSX1    DDA$IF
         2 005364   011466 702000 2                  TSX2    ERR

     1470    20617    2             IF NOGO_BIT THEN RETURN;

  20617  2 005365   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005366   005370 605000 2                  TPL     s:20618

  20617  2 005367   000000 702200 xent               TSX2  ! X66_ARET

     1471    20618    2             CALL DUA$LIST;

  20618  2 005370   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005371   000000 701000 xent               TSX1    DUA$LIST
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:240  
         2 005372   000000 011000                    NOP     0
         2 005373   011447 710000 2                  TRA     NOGO

     1472    20619    2          CASE(70);                    /* MINI */

     1473    20620    2             IF D_XDELTA THEN CALL DXC$MINI;

  20620  2 005374   000000 234000 xsym               SZN     D_XDELTA
         2 005375   005402 605000 2                  TPL     s:20622

  20620  2 005376   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005377   000000 701000 xent               TSX1    DXC$MINI
         2 005400   000000 011000                    NOP     0
         2 005401   011447 710000 2                  TRA     NOGO

     1474    20621    3             ELSE DO;

     1475    20622    3                  CALL DUD$MINI;

  20622  2 005402   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005403   000000 701000 xent               TSX1    DUD$MINI
         2 005404   000000 011000                    NOP     0

     1476    20623    3                  S_D.PROMPT_SIZE = 0;

  20623  2 005405   000000 470400 xsym               LDP0    S_D$
         2 005406   005147 450100                    STZ     2663,,PR0

     1477    20624    3                END;

  20624  2 005407   011447 710000 2                  TRA     NOGO

     1478    20625    2          CASE( 29 );               /* MACTIVE */

     1479    20626    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( MACTIVE$CMD ) );

  20626  2 005410   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:241  
         2 005411   000003 036003                    ADLQ    3,DU
         2 005412   000044 756100                    STQ     36,,PR0

     1480    20627    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20627  2 005413   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005414   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005415   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005416   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005417   000000 701000 xent               TSX1    DDA$IF
         2 005420   011466 702000 2                  TSX2    ERR

     1481    20628    2             IF NOGO_BIT THEN RETURN;

  20628  2 005421   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005422   005424 605000 2                  TPL     s:20629

  20628  2 005423   000000 702200 xent               TSX2  ! X66_ARET

     1482    20629    2             IF S_D.MLCT

  20629  2 005424   000000 470400 xsym               LDP0    S_D$
         2 005425   005323 234100                    SZN     2771,,PR0
         2 005426   005433 605000 2                  TPL     s:20631

     1483    20630    2             THEN CALL DFA$MLCT_ACTIVE ALTRET(ERR);

  20630  2 005427   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005430   000000 701000 xent               TSX1    DFA$MLCT_ACTIVE
         2 005431   011466 702000 2                  TSX2    ERR
         2 005432   011447 710000 2                  TRA     NOGO

     1484    20631    2             ELSE CALL DDA$MACTIVE ALTRET(ERR);

  20631  2 005433   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005434   000000 701000 xent               TSX1    DDA$MACTIVE
         2 005435   011466 702000 2                  TSX2    ERR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:242  
         2 005436   011447 710000 2                  TRA     NOGO

     1485    20632    2          CASE( 56 );                 /* C_RANGE */

     1486    20633    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));

  20633  2 005437   000031 236100                    LDQ     25,,PR0
         2 005440   000002 036003                    ADLQ    2,DU
         2 005441   000044 756100                    STQ     36,,PR0

     1487    20634    2             CALL DDA$IF( NOGO_BIT ) ALTRET(ERR);

  20634  2 005442   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005443   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005444   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005445   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005446   000000 701000 xent               TSX1    DDA$IF
         2 005447   011466 702000 2                  TSX2    ERR

     1488    20635    2             IF NOGO_BIT THEN RETURN;

  20635  2 005450   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005451   005453 605000 2                  TPL     s:20636

  20635  2 005452   000000 702200 xent               TSX2  ! X66_ARET

     1489    20636    2             S_D.RANGE = S_D.DO$->DOO.ID;

  20636  2 005453   000000 470400 xsym               LDP0    S_D$
         2 005454   000031 471500                    LDP1    25,,PR0
         2 005455   100001 236100                    LDQ     1,,PR1
         2 005456   000022 772000                    QRL     18
         2 005457   001031 756100                    STQ     537,,PR0
         2 005460   011447 710000 2                  TRA     NOGO

     1490    20637    2          CASE(28, 38);      /* MODIFY, MODIFYDW */

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:243  
     1491    20638    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  20638  2 005461   000101 234100                    SZN     65,,PR0
         2 005462   005475 605000 2                  TPL     s:20646
         2 005463   000102 236100                    LDQ     66,,PR0
         2 005464   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005465   005475 600000 2                  TZE     s:20646

     1492    20639    3             THEN DO;

     1493    20640    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  20640  2 005466   000102 473500                    LDP3    66,,PR0
         2 005467   300001 236100                    LDQ     1,,PR3
         2 005470   200000 316003                    CANQ    65536,DU
         2 005471   005510 600000 2                  TZE     s:20652

     1494    20641    4                  THEN DO;

     1495    20642    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  20642  2 005472   000465 235007                    LDA     309,DL
         2 005473   000013 755100                    STA     11,,PR0

     1496    20643    4                       GOTO ERR;

  20643  2 005474   011466 710000 2                  TRA     ERR

     1497    20644    4                     END;
     1498    20645    3                END;
     1499    20646    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  20646  2 005475   000101 234100                    SZN     65,,PR0
         2 005476   005510 605000 2                  TPL     s:20652
         2 005477   000102 236100                    LDQ     66,,PR0
         2 005500   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005501   005510 601000 2                  TNZ     s:20652
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:244  

     1500    20647    3                  THEN DO;

     1501    20648    3                       S_D.ERROR = 502;

  20648  2 005502   000766 235007                    LDA     502,DL
         2 005503   000013 755100                    STA     11,,PR0

     1502    20649    3                       CALL DDE$ERROR;

  20649  2 005504   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005505   000000 701000 xent               TSX1    DDE$ERROR
         2 005506   000000 011000                    NOP     0

     1503    20650    3                       GOTO ERR1;

  20650  2 005507   011506 710000 2                  TRA     ERR1

     1504    20651    3                     END;
     1505    20652    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(MODIFY$CMD));

  20652  2 005510   000031 236100                    LDQ     25,,PR0
         2 005511   000002 036003                    ADLQ    2,DU
         2 005512   000044 756100                    STQ     36,,PR0

     1506    20653    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20653  2 005513   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005514   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005515   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005517   000000 701000 xent               TSX1    DDA$IF
         2 005520   011466 702000 2                  TSX2    ERR

     1507    20654    2             IF NOGO_BIT THEN RETURN;

  20654  2 005521   200004 234100                    SZN     NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:245  
         2 005522   005524 605000 2                  TPL     s:20655

  20654  2 005523   000000 702200 xent               TSX2  ! X66_ARET

     1508    20655    2             CALL DDA$MOD  ALTRET(ERR);

  20655  2 005524   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005525   000000 701000 xent               TSX1    DDA$MOD
         2 005526   011466 702000 2                  TSX2    ERR
         2 005527   011447 710000 2                  TRA     NOGO

     1509    20656    2          CASE(65);                    /* MLCT */

     1510    20657    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(LCT$CMD));

  20657  2 005530   000031 236100                    LDQ     25,,PR0
         2 005531   000004 036003                    ADLQ    4,DU
         2 005532   000044 756100                    STQ     36,,PR0

     1511    20658    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20658  2 005533   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005534   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005535   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005536   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005537   000000 701000 xent               TSX1    DDA$IF
         2 005540   011466 702000 2                  TSX2    ERR

     1512    20659    2             IF NOGO_BIT THEN RETURN;

  20659  2 005541   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005542   005544 605000 2                  TPL     s:20660

  20659  2 005543   000000 702200 xent               TSX2  ! X66_ARET

     1513    20660    2             CALL DFA$MLCT ALTRET(ERR);

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:246  
  20660  2 005544   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005545   000000 701000 xent               TSX1    DFA$MLCT
         2 005546   011466 702000 2                  TSX2    ERR
         2 005547   011447 710000 2                  TRA     NOGO

     1514    20661    2          CASE(91);                    /* NAME */

     1515    20662    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(NAME$CMD));

  20662  2 005550   000031 236100                    LDQ     25,,PR0
         2 005551   000013 036003                    ADLQ    11,DU
         2 005552   000044 756100                    STQ     36,,PR0

     1516    20663    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20663  2 005553   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005554   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005555   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005556   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005557   000000 701000 xent               TSX1    DDA$IF
         2 005560   011466 702000 2                  TSX2    ERR

     1517    20664    2             IF NOGO_BIT THEN RETURN;

  20664  2 005561   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005562   005564 605000 2                  TPL     s:20665

  20664  2 005563   000000 702200 xent               TSX2  ! X66_ARET

     1518    20665    2             CALL DDA$NAME ALTRET(ERR);

  20665  2 005564   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005565   000000 701000 xent               TSX1    DDA$NAME
         2 005566   011466 702000 2                  TSX2    ERR
         2 005567   011447 710000 2                  TRA     NOGO

     1519    20666    2          CASE(30);                      /* OA */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:247  

     1520    20667    2             S_D.ERROR = 502;         /* E@DELBUG */

  20667  2 005570   000766 235007                    LDA     502,DL
         2 005571   000013 755100                    STA     11,,PR0

     1521    20668    2             CALL DDE$ERROR;

  20668  2 005572   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005573   000000 701000 xent               TSX1    DDE$ERROR
         2 005574   000000 011000                    NOP     0
         2 005575   011447 710000 2                  TRA     NOGO

     1522    20669    2          CASE(31);                      /* ON CALL */

     1523    20670    2             S_D.ERROR = 502;         /* E@DELBUG - SHOULDN'T GET HERE */

  20670  2 005576   000766 235007                    LDA     502,DL
         2 005577   000013 755100                    STA     11,,PR0

     1524    20671    2             CALL DDE$ERROR;

  20671  2 005600   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005601   000000 701000 xent               TSX1    DDE$ERROR
         2 005602   000000 011000                    NOP     0
         2 005603   011447 710000 2                  TRA     NOGO

     1525    20672    2          CASE(32);                      /* OE */

     1526    20673    2             S_D.ERROR = 502;         /* E@DELUG */

  20673  2 005604   000766 235007                    LDA     502,DL
         2 005605   000013 755100                    STA     11,,PR0

     1527    20674    2             CALL DDE$ERROR;

  20674  2 005606   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:248  
         2 005607   000000 701000 xent               TSX1    DDE$ERROR
         2 005610   000000 011000                    NOP     0
         2 005611   011447 710000 2                  TRA     NOGO

     1528    20675    2          CASE(34);                     /* ONN */

     1529    20676    2             S_D.ERROR = 502;         /* E@DELBUG */

  20676  2 005612   000766 235007                    LDA     502,DL
         2 005613   000013 755100                    STA     11,,PR0

     1530    20677    2             CALL DDE$ERROR;

  20677  2 005614   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005615   000000 701000 xent               TSX1    DDE$ERROR
         2 005616   000000 011000                    NOP     0
         2 005617   011447 710000 2                  TRA     NOGO

     1531    20678    2          CASE(36);                  /* OUTPUT */

     1532    20679    2             IF D_XDELTA

  20679  2 005620   000000 234000 xsym               SZN     D_XDELTA
         2 005621   005645 605000 2                  TPL     s:20688

     1533    20680    3             THEN DO;

     1534    20681    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  20681  2 005622   000031 236100                    LDQ     25,,PR0
         2 005623   000002 036003                    ADLQ    2,DU
         2 005624   000044 756100                    STQ     36,,PR0

     1535    20682    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20682  2 005625   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005626   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:249  
         2 005627   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005630   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005631   000000 701000 xent               TSX1    DDA$IF
         2 005632   011466 702000 2                  TSX2    ERR

     1536    20683    3                  IF NOGO_BIT THEN RETURN;

  20683  2 005633   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005634   005636 605000 2                  TPL     s:20684

  20683  2 005635   000000 702200 xent               TSX2  ! X66_ARET

     1537    20684    3                  CALL SETDCTX( OUT_DEV );

  20684  2 005636   000046 236000 3                  LDQ     38
         2 005637   200541 756100                    STQ     MSG$+3,,AUTO
         2 005640   011556 701000 2                  TSX1    SETDCTX
         2 005641   000000 011000                    NOP     0

     1538    20685    3                  OUT_DEV_SAVE = OUT_DEV;

  20685  2 005642   000000 235000 xsym               LDA     OUT_DEV
         2 005643   000000 755000 xsym               STA     OUT_DEV_SAVE

     1539    20686    3                END;

  20686  2 005644   011447 710000 2                  TRA     NOGO

     1540    20687    3             ELSE DO;

     1541    20688    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(RUM$CMD));

  20688  2 005645   000031 236100                    LDQ     25,,PR0
         2 005646   000030 036003                    ADLQ    24,DU
         2 005647   000044 756100                    STQ     36,,PR0

     1542    20689    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:250  

  20689  2 005650   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005651   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005652   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005653   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005654   000000 701000 xent               TSX1    DDA$IF
         2 005655   011466 702000 2                  TSX2    ERR

     1543    20690    3                  IF NOGO_BIT THEN RETURN;

  20690  2 005656   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005657   005661 605000 2                  TPL     s:20691

  20690  2 005660   000000 702200 xent               TSX2  ! X66_ARET

     1544    20691    3                  CODE = S_D.DO$ -> RUM$CMD.CODE;

  20691  2 005661   000000 470400 xsym               LDP0    S_D$
         2 005662   000031 471500                    LDP1    25,,PR0
         2 005663   100001 236100                    LDQ     1,,PR1
         2 005664   000011 772000                    QRL     9
         2 005665   000777 376007                    ANQ     511,DL
         2 005666   200003 756100                    STQ     CODE,,AUTO

     1545    20692    3                  CALL DUA$OUTPUT( S_D.DO$ -> RUM$CMD.FID, CODE ); /* Ignore altret */

  20692  2 005667   200003 633500                    EPPR3   CODE,,AUTO
         2 005670   200543 453500                    STP3    @WHICH_ONE+2,,AUTO
         2 005671   100010 634500                    EPPR4   8,,PR1
         2 005672   200542 454500                    STP4    @WHICH_ONE+1,,AUTO
         2 005673   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005674   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005675   000000 701000 xent               TSX1    DUA$OUTPUT
         2 005676   000000 011000                    NOP     0

     1546    20693    3                END;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:251  
  20693  2 005677   011447 710000 2                  TRA     NOGO

     1547    20694    2          CASE( 73 );                   /* C_PMD */

     1548    20695    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  20695  2 005700   006714 235100                    LDA     3532,,PR0
         2 005701   000002 115007                    CMPA    2,DL
         2 005702   011543 600000 2                  TZE     NOTIMPFPRG

     1549    20696    2             THEN GOTO NOTIMPFPRG;
     1550    20697    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  20697  2 005703   000031 236100                    LDQ     25,,PR0
         2 005704   000002 036003                    ADLQ    2,DU
         2 005705   000044 756100                    STQ     36,,PR0

     1551    20698    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20698  2 005706   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005707   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005710   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005711   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005712   000000 701000 xent               TSX1    DDA$IF
         2 005713   011466 702000 2                  TSX2    ERR

     1552    20699    2             IF NOGO_BIT THEN RETURN;

  20699  2 005714   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005715   005717 605000 2                  TPL     s:20700

  20699  2 005716   000000 702200 xent               TSX2  ! X66_ARET

     1553    20700    2             CALL DUA$PMD;

  20700  2 005717   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 005720   000000 701000 xent               TSX1    DUA$PMD
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:252  
         2 005721   000000 011000                    NOP     0
         2 005722   011447 710000 2                  TRA     NOGO

     1554    20701    2          CASE(25);                  /* C_PROMPT */

     1555    20702    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(PROMPT$CMD));

  20702  2 005723   000031 236100                    LDQ     25,,PR0
         2 005724   000012 036003                    ADLQ    10,DU
         2 005725   000044 756100                    STQ     36,,PR0

     1556    20703    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);

  20703  2 005726   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005727   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005730   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005731   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005732   000000 701000 xent               TSX1    DDA$IF
         2 005733   011466 702000 2                  TSX2    ERR

     1557    20704    2             IF NOGO_BIT THEN RETURN;

  20704  2 005734   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005735   005737 605000 2                  TPL     s:20705

  20704  2 005736   000000 702200 xent               TSX2  ! X66_ARET

     1558    20705    2             S_D.UPROMPT = S_D.DO$ -> PROMPT$CMD.TEXTC.TEXT;

  20705  2 005737   000000 470400 xsym               LDP0    S_D$
         2 005740   000031 471500                    LDP1    25,,PR0
         2 005741   040100 100500                    MLR     fill='040'O
         2 005742   100002 200030                    ADSC9   2,,PR1                   cn=1,n=24
         2 005743   005160 000030                    ADSC9   2672,,PR0                cn=0,n=24

     1559    20706    2             S_D.UPROMPT_SIZE = S_D.DO$ -> PROMPT$CMD.TEXTC.SIZE;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:253  
  20706  2 005744   100002 236100                    LDQ     2,,PR1
         2 005745   000033 772000                    QRL     27
         2 005746   005166 756100                    STQ     2678,,PR0

     1560    20707    2             S_D.PROMPT_SIZE = 0;          /* Indicate prompt has been changed */

  20707  2 005747   005147 450100                    STZ     2663,,PR0
         2 005750   011447 710000 2                  TRA     NOGO

     1561    20708    2          CASE(88);                 /* PROTECT */

     1562    20709    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( ALL_ATTACH ) );

  20709  2 005751   000031 236100                    LDQ     25,,PR0
         2 005752   000002 036003                    ADLQ    2,DU
         2 005753   000044 756100                    STQ     36,,PR0

     1563    20710    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20710  2 005754   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 005755   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 005756   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 005757   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005760   000000 701000 xent               TSX1    DDA$IF
         2 005761   011466 702000 2                  TSX2    ERR

     1564    20711    2             IF NOGO_BIT THEN RETURN;

  20711  2 005762   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 005763   005765 605000 2                  TPL     s:20712

  20711  2 005764   000000 702200 xent               TSX2  ! X66_ARET

     1565    20712    2             S_D.PROTECT = '1'B;

  20712  2 005765   400000 236003                    LDQ     -131072,DU
         2 005766   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:254  
         2 005767   005254 756100                    STQ     2732,,PR0
         2 005770   011447 710000 2                  TRA     NOGO

     1566    20713    2          CASE(24);                   /*C_PLUGH*/

     1567    20714    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  20714  2 005771   000101 234100                    SZN     65,,PR0
         2 005772   006005 605000 2                  TPL     s:20722
         2 005773   000102 236100                    LDQ     66,,PR0
         2 005774   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005775   006005 600000 2                  TZE     s:20722

     1568    20715    3             THEN DO;

     1569    20716    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  20716  2 005776   000102 473500                    LDP3    66,,PR0
         2 005777   300001 236100                    LDQ     1,,PR3
         2 006000   200000 316003                    CANQ    65536,DU
         2 006001   006020 600000 2                  TZE     s:20728

     1570    20717    4                  THEN DO;

     1571    20718    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

  20718  2 006002   000465 235007                    LDA     309,DL
         2 006003   000013 755100                    STA     11,,PR0

     1572    20719    4                       GOTO ERR;

  20719  2 006004   011466 710000 2                  TRA     ERR

     1573    20720    4                     END;
     1574    20721    3                END;
     1575    20722    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:255  
  20722  2 006005   000101 234100                    SZN     65,,PR0
         2 006006   006020 605000 2                  TPL     s:20728
         2 006007   000102 236100                    LDQ     66,,PR0
         2 006010   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006011   006020 601000 2                  TNZ     s:20728

     1576    20723    3                  THEN DO;

     1577    20724    3                       S_D.ERROR = 502;

  20724  2 006012   000766 235007                    LDA     502,DL
         2 006013   000013 755100                    STA     11,,PR0

     1578    20725    3                       CALL DDE$ERROR;

  20725  2 006014   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006015   000000 701000 xent               TSX1    DDE$ERROR
         2 006016   000000 011000                    NOP     0

     1579    20726    3                       GOTO ERR1;

  20726  2 006017   011506 710000 2                  TRA     ERR1

     1580    20727    3                     END;
     1581    20728    2             S_D.D$=PINCRW(S_D.DO$, SIZEW(DOO));

  20728  2 006020   000031 236100                    LDQ     25,,PR0
         2 006021   000002 036003                    ADLQ    2,DU
         2 006022   000044 756100                    STQ     36,,PR0

     1582    20729    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20729  2 006023   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006024   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006025   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006026   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006027   000000 701000 xent               TSX1    DDA$IF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:256  
         2 006030   011466 702000 2                  TSX2    ERR

     1583    20730    2             IF NOGO_BIT THEN RETURN;

  20730  2 006031   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006032   006034 605000 2                  TPL     s:20731

  20730  2 006033   000000 702200 xent               TSX2  ! X66_ARET

     1584    20731    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  20731  2 006034   000000 470400 xsym               LDP0    S_D$
         2 006035   006714 235100                    LDA     3532,,PR0
         2 006036   000001 115007                    CMPA    1,DL
         2 006037   006044 601000 2                  TNZ     s:20733

     1585    20732    2             THEN CALL DDA$PLUGH;

  20732  2 006040   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006041   000000 701000 xent               TSX1    DDA$PLUGH
         2 006042   000000 011000                    NOP     0
         2 006043   011447 710000 2                  TRA     NOGO

     1586    20733    2             ELSE CALL DFA$PLUGH;

  20733  2 006044   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006045   000000 701000 xent               TSX1    DFA$PLUGH
         2 006046   000000 011000                    NOP     0
         2 006047   011447 710000 2                  TRA     NOGO

     1587    20734    2          CASE(39);                    /* QUIT */

     1588    20735    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  20735  2 006050   000031 236100                    LDQ     25,,PR0
         2 006051   000002 036003                    ADLQ    2,DU
         2 006052   000044 756100                    STQ     36,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:257  

     1589    20736    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20736  2 006053   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006054   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006055   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006057   000000 701000 xent               TSX1    DDA$IF
         2 006060   011466 702000 2                  TSX2    ERR

     1590    20737    2             IF NOGO_BIT THEN RETURN;

  20737  2 006061   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006062   006064 605000 2                  TPL     s:20738

  20737  2 006063   000000 702200 xent               TSX2  ! X66_ARET

     1591    20738    2             IF D_XDELTA THEN CALL DXA$QUIT ALTRET(RECOVERY_IN_PROGRESS);

  20738  2 006064   000000 234000 xsym               SZN     D_XDELTA
         2 006065   006072 605000 2                  TPL     s:20740

  20738  2 006066   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006067   000000 701000 xent               TSX1    DXA$QUIT
         2 006070   011512 702000 2                  TSX2    RECOVERY_IN_PROGRESS
         2 006071   011447 710000 2                  TRA     NOGO

     1592    20739    3             ELSE DO;

     1593    20740    3                  IF S_D.RUM THEN CALL DUA$KILL_RUM; /* Close files */

  20740  2 006072   000000 470400 xsym               LDP0    S_D$
         2 006073   004755 234100                    SZN     2541,,PR0
         2 006074   006100 605000 2                  TPL     s:20741

  20740  2 006075   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006076   000000 701000 xent               TSX1    DUA$KILL_RUM
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:258  
         2 006077   000000 011000                    NOP     0

     1594    20741    3                  IF S_D.ANLZ THEN CALL DUA$KILL_ANLZ; /* Close files */

  20741  2 006100   000000 470400 xsym               LDP0    S_D$
         2 006101   004756 234100                    SZN     2542,,PR0
         2 006102   006106 605000 2                  TPL     s:20742

  20741  2 006103   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006104   000000 701000 xent               TSX1    DUA$KILL_ANLZ
         2 006105   000000 011000                    NOP     0

     1595    20742    3                  IF S_D.DO$ -> QUIT$CMD.FPRG

  20742  2 006106   000000 470400 xsym               LDP0    S_D$
         2 006107   000031 471500                    LDP1    25,,PR0
         2 006110   100001 234100                    SZN     1,,PR1
         2 006111   006227 605000 2                  TPL     s:20778

     1596    20743    4                  THEN DO;

     1597    20744    4                       IF S_D.FPRG_CONTEXT$ = ADDR(NIL)

  20744  2 006112   000076 236100                    LDQ     62,,PR0
         2 006113   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006114   006120 601000 2                  TNZ     s:20749

     1598    20745    5                       THEN DO;

     1599    20746    5                            S_D.ERROR = 278; /* E@NOFPRG */

  20746  2 006115   000426 235007                    LDA     278,DL
         2 006116   000013 755100                    STA     11,,PR0

     1600    20747    5                            GOTO ERR;

  20747  2 006117   011466 710000 2                  TRA     ERR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:259  

     1601    20748    5                          END;
     1602    20749    4                       TFPRG$ = S_D.FPRG_CONTEXT$;

  20749  2 006120   200041 756100                    STQ     TFPRG$,,AUTO

     1603    20750    5                       DO WHILE (SUBSTR(TFPRG$->FPRG$CONTEXT.RES, 0, TFPRG$->
             20750                                FPRG$CONTEXT.RES_SIZE) ~=

  20750  2 006121   006133 710000 2                  TRA     s:20758

     1604    20751    5                         S_D.DO$ -> QUIT$CMD.FPRG_RES);
     1605    20752    5                            TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  20752  2 006122   200041 470500                    LDP0    TFPRG$,,AUTO
         2 006123   000000 236100                    LDQ     0,,PR0
         2 006124   200041 756100                    STQ     TFPRG$,,AUTO

     1606    20753    5                            IF TFPRG$ = ADDR(NIL)

  20753  2 006125   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006126   006133 601000 2                  TNZ     s:20758

     1607    20754    6                            THEN DO;

     1608    20755    6                                 S_D.ERROR = 278; /* E@NOFPRG */

  20755  2 006127   000426 235007                    LDA     278,DL
         2 006130   000000 470400 xsym               LDP0    S_D$
         2 006131   000013 755100                    STA     11,,PR0

     1609    20756    6                                 GOTO ERR;

  20756  2 006132   011466 710000 2                  TRA     ERR

     1610    20757    6                               END;
     1611    20758    5                          END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:260  

  20758  2 006133   200041 470500                    LDP0    TFPRG$,,AUTO
         2 006134   000004 720100                    LXL0    4,,PR0
         2 006135   000000 471400 xsym               LDP1    S_D$
         2 006136   100031 473500                    LDP3    25,,PR1
         2 006137   040100 106540                    CMPC    fill='040'O
         2 006140   000002 000010                    ADSC9   2,,PR0                   cn=0,n=*X0
         2 006141   300002 000010                    ADSC9   2,,PR3                   cn=0,n=8
         2 006142   006122 601000 2                  TNZ     s:20752

     1612    20759    4                       IF TFPRG$ -> FPRG$CONTEXT.STATE = %RUNNING

  20759  2 006143   000001 236100                    LDQ     1,,PR0
         2 006144   000777 376003                    ANQ     511,DU
         2 006145   000001 116003                    CMPQ    1,DU
         2 006146   006200 601000 2                  TNZ     s:20768

     1613    20760    5                       THEN DO;

     1614    20761    5                           S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB# = TFPRG$ -> FPRG$CONTEXT.
             20761                                     DCBNO;

  20761  2 006147   104704 474500                    LDP4    2500,,PR1
         2 006150   000001 720100                    LXL0    1,,PR0
         2 006151   400014 440100                    SXL0    12,,PR4

     1615    20762    5                            S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# = '1'B;

  20762  2 006152   104704 470500                    LDP0    2500,,PR1
         2 006153   000020 236003                    LDQ     16,DU
         2 006154   000013 256100                    ORSQ    11,,PR0

     1616    20763    5                            CALL M$DRTN (S_D.DRTN$ -> FPT$DRTN) ALTRET(ERRMSG);

  20763  2 006155   104704 470500                    LDP0    2500,,PR1
         2 006156   410017 713400                    CLIMB   alt,+4111
         2 006157   402000 401760                    pmme    nvectors=5
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:261  
         2 006160   011552 702000 2                  TSX2    ERRMSG

     1617    20764    5                            S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB# = 0;

  20764  2 006161   000000 470400 xsym               LDP0    S_D$
         2 006162   004704 471500                    LDP1    2500,,PR0
         2 006163   000000 220003                    LDX0    0,DU
         2 006164   100014 440100                    SXL0    12,,PR1

     1618    20765    5                            S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# = '0'B;

  20765  2 006165   004704 471500                    LDP1    2500,,PR0
         2 006166   000047 236000 3                  LDQ     39
         2 006167   100013 356100                    ANSQ    11,,PR1

     1619    20766    5                            CALL DFQ$READ_FD (TFPRG$, '0'B) ALTRET(ERRMSG);

  20766  2 006170   000001 236000 3                  LDQ     1
         2 006171   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 006172   200041 631500                    EPPR1   TFPRG$,,AUTO
         2 006173   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 006174   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006175   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 006176   000000 701000 xent               TSX1    DFQ$READ_FD
         2 006177   011552 702000 2                  TSX2    ERRMSG

     1620    20767    5                          END;

     1621    20768    4                       CALL DFA$QUIT (TFPRG$)

  20768  2 006200   200041 630500                    EPPR0   TFPRG$,,AUTO
         2 006201   200542 450500                    STP0    @WHICH_ONE+1,,AUTO
         2 006202   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006203   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006204   000000 701000 xent               TSX1    DFA$QUIT
         2 006205   006207 702000 2                  TSX2    s:20770
         2 006206   006215 710000 2                  TRA     s:20773
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:262  

     1622    20769    5                       WHENALTRETURN DO;

     1623    20770    5                            IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$LDSC

  20770  2 006207   000000 470400 xsym               LDP0    B$TCB$
         2 006210   000000 471500                    LDP1    0,,PR0
         2 006211   100102 236100                    LDQ     66,,PR1
         2 006212   377770 376007                    ANQ     131064,DL
         2 006213   000140 116007                    CMPQ    96,DL
         2 006214   011552 601000 2                  TNZ     ERRMSG

     1624    20771    5                            THEN GOTO ERRMSG;
     1625    20772    5                          END;

     1626    20773    4                       S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;

  20773  2 006215   200041 236100                    LDQ     TFPRG$,,AUTO
         2 006216   000000 470400 xsym               LDP0    S_D$
         2 006217   000102 756100                    STQ     66,,PR0

     1627    20774    4                       TFPRG$->FPRG$CONTEXT.FANLZ = '1'B; /* Suppress KDEL msg */

  20774  2 006220   200041 471500                    LDP1    TFPRG$,,AUTO
         2 006221   001000 236003                    LDQ     512,DU
         2 006222   100001 256100                    ORSQ    1,,PR1

     1628    20775    4                       CALL DFA$KILL_DELTA;

  20775  2 006223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006224   000000 701000 xent               TSX1    DFA$KILL_DELTA
         2 006225   000000 011000                    NOP     0

     1629    20776    4                     END;

  20776  2 006226   011447 710000 2                  TRA     NOGO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:263  
     1630    20777    4                  ELSE DO;

     1631    20778    4                       IF S_D.FPRG_CONTEXT$ ~= ADDR(NIL)

  20778  2 006227   000076 236100                    LDQ     62,,PR0
         2 006230   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006231   006273 600000 2                  TZE     s:20792

     1632    20779    5                       THEN DO;

     1633    20780    5                            CALL DFA$STOP_FPRGS('1'B)

  20780  2 006232   000002 630400 3                  EPPR0   2
         2 006233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006234   000000 701000 xent               TSX1    DFA$STOP_FPRGS
         2 006235   006237 702000 2                  TSX2    s:20782
         2 006236   006245 710000 2                  TRA     s:20785

     1634    20781    6                            WHENALTRETURN DO;

     1635    20782    6                                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$LDSC

  20782  2 006237   000000 470400 xsym               LDP0    B$TCB$
         2 006240   000000 471500                    LDP1    0,,PR0
         2 006241   100102 236100                    LDQ     66,,PR1
         2 006242   377770 376007                    ANQ     131064,DL
         2 006243   000140 116007                    CMPQ    96,DL
         2 006244   011447 601000 2                  TNZ     NOGO

     1636    20783    6                                 THEN GOTO NOGO;
     1637    20784    6                               END;

     1638    20785    6                            DO WHILE (S_D.FPRG_CONTEXT$ ~= ADDR(NIL));

  20785  2 006245   006267 710000 2                  TRA     s:20790

     1639    20786    6                                 S_D.CURRENT_FPRG_CONTEXT$ = S_D.FPRG_CONTEXT$;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:264  

  20786  2 006246   000000 470400 xsym               LDP0    S_D$
         2 006247   000076 236100                    LDQ     62,,PR0
         2 006250   000102 756100                    STQ     66,,PR0

     1640    20787    6                                 CALL DFA$QUIT (S_D.FPRG_CONTEXT$);

  20787  2 006251   000000 236000 xsym               LDQ     S_D$
         2 006252   000076 036003                    ADLQ    62,DU
         2 006253   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 006254   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006256   000000 701000 xent               TSX1    DFA$QUIT
         2 006257   000000 011000                    NOP     0

     1641    20788    6   /* Suppress KDEL msg */       S_D.FPRG_CONTEXT$->FPRG$CONTEXT.FANLZ = '1'B;

  20788  2 006260   000000 470400 xsym               LDP0    S_D$
         2 006261   000076 471500                    LDP1    62,,PR0
         2 006262   001000 236003                    LDQ     512,DU
         2 006263   100001 256100                    ORSQ    1,,PR1

     1642    20789    6                                 CALL DFA$KILL_DELTA;

  20789  2 006264   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006265   000000 701000 xent               TSX1    DFA$KILL_DELTA
         2 006266   000000 011000                    NOP     0

     1643    20790    6                               END;

  20790  2 006267   000000 470400 xsym               LDP0    S_D$
         2 006270   000076 236100                    LDQ     62,,PR0
         2 006271   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006272   006246 601000 2                  TNZ     s:20786

     1644    20791    5                          END;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:265  
     1645    20792    4                       CALL DUA$EXITDELTA; /* EXIT NOW, DON'T CALL DDA$GO */

  20792  2 006273   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006274   000000 701000 xent               TSX1    DUA$EXITDELTA
         2 006275   000000 011000                    NOP     0

     1646    20793    4                     END;

     1647    20794    3                END;

  20794  2 006276   011447 710000 2                  TRA     NOGO

     1648    20795    2          CASE( 72 );                   /* C_RUM */

     1649    20796    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( RUM$CMD ) );

  20796  2 006277   000031 236100                    LDQ     25,,PR0
         2 006300   000030 036003                    ADLQ    24,DU
         2 006301   000044 756100                    STQ     36,,PR0

     1650    20797    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20797  2 006302   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006303   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006304   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006305   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006306   000000 701000 xent               TSX1    DDA$IF
         2 006307   011466 702000 2                  TSX2    ERR

     1651    20798    2             IF NOGO_BIT THEN RETURN;

  20798  2 006310   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006311   006313 605000 2                  TPL     s:20799

  20798  2 006312   000000 702200 xent               TSX2  ! X66_ARET

     1652    20799    2             CALL DUA$RUM;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:266  

  20799  2 006313   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 006314   000000 701000 xent               TSX1    DUA$RUM
         2 006315   000000 011000                    NOP     0
         2 006316   011447 710000 2                  TRA     NOGO

     1653    20800    2          CASE(42);                    /* READ */

     1654    20801    2             IF D_XDELTA

  20801  2 006317   000000 234000 xsym               SZN     D_XDELTA
         2 006320   006354 605000 2                  TPL     s:20815

     1655    20802    3             THEN DO;

     1656    20803    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  20803  2 006321   000031 236100                    LDQ     25,,PR0
         2 006322   000002 036003                    ADLQ    2,DU
         2 006323   000044 756100                    STQ     36,,PR0

     1657    20804    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20804  2 006324   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006325   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006326   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006327   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006330   000000 701000 xent               TSX1    DDA$IF
         2 006331   011466 702000 2                  TSX2    ERR

     1658    20805    3                  IF NOGO_BIT THEN RETURN;

  20805  2 006332   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006333   006335 605000 2                  TPL     s:20806

  20805  2 006334   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:267  
     1659    20806    3                  CALL SETDCTX( IN_DEV );

  20806  2 006335   000050 236000 3                  LDQ     40
         2 006336   200541 756100                    STQ     MSG$+3,,AUTO
         2 006337   011556 701000 2                  TSX1    SETDCTX
         2 006340   000000 011000                    NOP     0

     1660    20807    3                  IF IN_DEV = DCTX_ME

  20807  2 006341   000000 236000 xsym               LDQ     IN_DEV
         2 006342   000000 116000 xsym               CMPQ    DCTX_ME
         2 006343   006347 601000 2                  TNZ     s:20810

     1661    20808    3                  THEN OUT_DEV = OUT_DEV_SAVE;

  20808  2 006344   000000 235000 xsym               LDA     OUT_DEV_SAVE
         2 006345   000000 755000 xsym               STA     OUT_DEV
         2 006346   011447 710000 2                  TRA     NOGO

     1662    20809    4                  ELSE DO;

     1663    20810    4                       OUT_DEV_SAVE = OUT_DEV;

  20810  2 006347   000000 235000 xsym               LDA     OUT_DEV
         2 006350   000000 755000 xsym               STA     OUT_DEV_SAVE

     1664    20811    4                       OUT_DEV = ECHO_DEV;

  20811  2 006351   000000 235000 xsym               LDA     ECHO_DEV
         2 006352   000000 755000 xsym               STA     OUT_DEV

     1665    20812    4                     END;

     1666    20813    3                END;

  20813  2 006353   011447 710000 2                  TRA     NOGO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:268  
     1667    20814    3             ELSE DO;

     1668    20815    3                  S_D.D$ = PINCRW(S_D.DO$,SIZEW(RUM$CMD));

  20815  2 006354   000031 236100                    LDQ     25,,PR0
         2 006355   000030 036003                    ADLQ    24,DU
         2 006356   000044 756100                    STQ     36,,PR0

     1669    20816    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20816  2 006357   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006360   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006361   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006363   000000 701000 xent               TSX1    DDA$IF
         2 006364   011466 702000 2                  TSX2    ERR

     1670    20817    3                  IF NOGO_BIT THEN RETURN;

  20817  2 006365   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006366   006370 605000 2                  TPL     s:20818

  20817  2 006367   000000 702200 xent               TSX2  ! X66_ARET

     1671    20818    3                  CALL DUA$READ( S_D.DO$ -> RUM$CMD ); /* Ignore altret */

  20818  2 006370   000000 470400 xsym               LDP0    S_D$
         2 006371   000031 471500                    LDP1    25,,PR0
         2 006372   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 006373   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006374   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006375   000000 701000 xent               TSX1    DUA$READ
         2 006376   000000 011000                    NOP     0

     1672    20819    3                END;

  20819  2 006377   011447 710000 2                  TRA     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:269  

     1673    20820    2          CASE( 55 );                /* C_REPORT */

     1674    20821    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( REPORT$CMD ) );

  20821  2 006400   000031 236100                    LDQ     25,,PR0
         2 006401   000002 036003                    ADLQ    2,DU
         2 006402   000044 756100                    STQ     36,,PR0

     1675    20822    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20822  2 006403   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006404   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006405   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006407   000000 701000 xent               TSX1    DDA$IF
         2 006410   011466 702000 2                  TSX2    ERR

     1676    20823    2             IF NOGO_BIT THEN RETURN;

  20823  2 006411   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006412   006414 605000 2                  TPL     s:20824

  20823  2 006413   000000 702200 xent               TSX2  ! X66_ARET

     1677    20824    2             IF S_D.DO$ -> REPORT$CMD.COMPILER_SPF

  20824  2 006414   000000 470400 xsym               LDP0    S_D$
         2 006415   000031 471500                    LDP1    25,,PR0
         2 006416   100001 236100                    LDQ     1,,PR1
         2 006417   400000 316007                    CANQ    -131072,DL
         2 006420   006427 600000 2                  TZE     s:20830

     1678    20825    3             THEN DO;

     1679    20826    3                  LOWX = S_D.DO$ -> REPORT$CMD.COMPILER - 550; /* C@COMPILER_FIRST */

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:270  
  20826  2 006421   100001 236100                    LDQ     1,,PR1
         2 006422   000022 772000                    QRL     18
         2 006423   001046 136007                    SBLQ    550,DL
         2 006424   200013 756100                    STQ     LOWX,,AUTO

     1680    20827    3                  HIGX = LOWX;

  20827  2 006425   200014 756100                    STQ     HIGX,,AUTO

     1681    20828    3                END;

  20828  2 006426   006432 710000 2                  TRA     s:20833

     1682    20829    3             ELSE DO;

     1683    20830    3                  LOWX = 0;

  20830  2 006427   200013 450100                    STZ     LOWX,,AUTO

     1684    20831    3                  HIGX = %(563 - 550); /* C@COMPILER_LAST, C@COMPILER_FIRST */

  20831  2 006430   000015 235007                    LDA     13,DL
         2 006431   200014 755100                    STA     HIGX,,AUTO

     1685    20832    3                END;

     1686    20833    3             DO I = LOWX TO HIGX;

  20833  2 006432   200013 235100                    LDA     LOWX,,AUTO
         2 006433   200005 755100                    STA     I,,AUTO
         2 006434   006510 710000 2                  TRA     s:20845+3

     1687    20834    3                  IF S_D.DO$ -> REPORT$CMD.DEFAULT

  20834  2 006435   000000 470400 xsym               LDP0    S_D$
         2 006436   000031 471500                    LDP1    25,,PR0
         2 006437   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:271  
         2 006440   200000 316007                    CANQ    65536,DL
         2 006441   006462 600000 2                  TZE     s:20841

     1688    20835    4                  THEN DO;

     1689    20836    4                       S_D.REPORT_FLAGS.OFFSET( I ) = DD_REPORT_FLAGS.OFFSET( I );

  20836  2 006442   200005 720100                    LXL0    I,,AUTO
         2 006443   000000 236010 xsym               LDQ     DD_REPORT_FLAGS,X0
         2 006444   005214 676110                    ERQ     2700,X0,PR0
         2 006445   400000 376003                    ANQ     -131072,DU
         2 006446   005214 656110                    ERSQ    2700,X0,PR0

     1690    20837    4                       S_D.REPORT_FLAGS.LINE( I ) = DD_REPORT_FLAGS.LINE( I );

  20837  2 006447   200005 720100                    LXL0    I,,AUTO
         2 006450   000000 236010 xsym               LDQ     DD_REPORT_FLAGS,X0
         2 006451   005214 676110                    ERQ     2700,X0,PR0
         2 006452   200000 376003                    ANQ     65536,DU
         2 006453   005214 656110                    ERSQ    2700,X0,PR0

     1691    20838    4                       S_D.REPORT_FLAGS.TYPE( I ) = DD_REPORT_FLAGS.TYPE( I );

  20838  2 006454   200005 720100                    LXL0    I,,AUTO
         2 006455   000000 236010 xsym               LDQ     DD_REPORT_FLAGS,X0
         2 006456   005214 676110                    ERQ     2700,X0,PR0
         2 006457   100000 376003                    ANQ     32768,DU
         2 006460   005214 656110                    ERSQ    2700,X0,PR0

     1692    20839    4                     END;

  20839  2 006461   006505 710000 2                  TRA     s:20845

     1693    20840    4                  ELSE DO;

     1694    20841    4                       S_D.REPORT_FLAGS.OFFSET( I ) = S_D.DO$ -> REPORT$CMD.OFFSET;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:272  
  20841  2 006462   200005 720100                    LXL0    I,,AUTO
         2 006463   000024 736000                    QLS     20
         2 006464   005214 676110                    ERQ     2700,X0,PR0
         2 006465   400000 376003                    ANQ     -131072,DU
         2 006466   005214 656110                    ERSQ    2700,X0,PR0

     1695    20842    4                       S_D.REPORT_FLAGS.LINE( I ) = S_D.DO$ -> REPORT$CMD.LINE;

  20842  2 006467   000031 471500                    LDP1    25,,PR0
         2 006470   200005 720100                    LXL0    I,,AUTO
         2 006471   100001 236100                    LDQ     1,,PR1
         2 006472   000024 736000                    QLS     20
         2 006473   005214 676110                    ERQ     2700,X0,PR0
         2 006474   200000 376003                    ANQ     65536,DU
         2 006475   005214 656110                    ERSQ    2700,X0,PR0

     1696    20843    4                       S_D.REPORT_FLAGS.TYPE( I ) = S_D.DO$ -> REPORT$CMD.TYPE;

  20843  2 006476   000031 471500                    LDP1    25,,PR0
         2 006477   200005 720100                    LXL0    I,,AUTO
         2 006500   100001 236100                    LDQ     1,,PR1
         2 006501   000024 736000                    QLS     20
         2 006502   005214 676110                    ERQ     2700,X0,PR0
         2 006503   100000 376003                    ANQ     32768,DU
         2 006504   005214 656110                    ERSQ    2700,X0,PR0

     1697    20844    4                     END;

     1698    20845    3                END;

  20845  2 006505   200005 235100                    LDA     I,,AUTO
         2 006506   000001 035007                    ADLA    1,DL
         2 006507   200005 755100                    STA     I,,AUTO
         2 006510   200014 236100                    LDQ     HIGX,,AUTO
         2 006511   200005 116100                    CMPQ    I,,AUTO
         2 006512   006435 603000 2                  TRC     s:20834
         2 006513   011447 710000 2                  TRA     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:273  

     1699    20846    2          CASE(43);                  /* SCHEMA */

     1700    20847    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SCHEMA$CMD));

  20847  2 006514   000031 236100                    LDQ     25,,PR0
         2 006515   000022 036003                    ADLQ    18,DU
         2 006516   000044 756100                    STQ     36,,PR0

     1701    20848    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20848  2 006517   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 006520   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 006521   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 006522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006523   000000 701000 xent               TSX1    DDA$IF
         2 006524   011466 702000 2                  TSX2    ERR

     1702    20849    2             IF NOGO_BIT THEN RETURN;

  20849  2 006525   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 006526   006530 605000 2                  TPL     s:20850

  20849  2 006527   000000 702200 xent               TSX2  ! X66_ARET

     1703    20850    2             S_D.SCHEMA = '1'B;

  20850  2 006530   400000 236003                    LDQ     -131072,DU
         2 006531   000000 470400 xsym               LDP0    S_D$
         2 006532   000052 756100                    STQ     42,,PR0

     1704    20851    2             IF S_D.DO$ -> SCHEMA$CMD.GOTFID

  20851  2 006533   000031 471500                    LDP1    25,,PR0
         2 006534   100001 236100                    LDQ     1,,PR1
         2 006535   040000 316007                    CANQ    16384,DL
         2 006536   007004 600000 2                  TZE     SCHEMA
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:274  

     1705    20852    3             THEN DO;

     1706    20853    3                  FPTOPEN = FPT_OPEN;

  20853  2 006537   000100 100400                    MLR     fill='000'O
         2 006540   000000 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         2 006541   200056 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

     1707    20854    3                  IF S_D.RUM

  20854  2 006542   004755 234100                    SZN     2541,,PR0
         2 006543   006547 605000 2                  TPL     s:20859

     1708    20855    4                  THEN DO;

     1709    20856    4                       S_D.ERROR = 212; /* E_BADCMD_RUM */

  20856  2 006544   000324 235007                    LDA     212,DL
         2 006545   000013 755100                    STA     11,,PR0

     1710    20857    4                       GOTO ERR;

  20857  2 006546   011466 710000 2                  TRA     ERR

     1711    20858    4                     END;
     1712    20859    3                  FPTOPEN.V_ = VECTOR(FPTOPEN.V);

  20859  2 006547   000014 235000 3                  LDA     12
         2 006550   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006551   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006552   000122 036003                    ADLQ    82,DU
         2 006553   200056 757100                    STAQ    FPTOPEN,,AUTO

     1713    20860    3                  FPTOPEN.SN_ = VECTOR(VLP_SN);

  20860  2 006554   000013 235000 3                  LDA     11
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:275  
         2 006555   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006556   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006557   000150 036003                    ADLQ    104,DU
         2 006560   200060 757100                    STAQ    FPTOPEN+2,,AUTO

     1714    20861    3                  FPTOPEN.NAME_ = VECTOR(VLP_NAME);

  20861  2 006561   000015 235000 3                  LDA     13
         2 006562   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006563   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006564   000154 036003                    ADLQ    108,DU
         2 006565   200064 757100                    STAQ    FPTOPEN+6,,AUTO

     1715    20862    3                  FPTOPEN.ACCT_ = VECTOR(VLP_ACCT);

  20862  2 006566   000020 235000 3                  LDA     16
         2 006567   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006570   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006571   000164 036003                    ADLQ    116,DU
         2 006572   200102 757100                    STAQ    FPTOPEN+20,,AUTO

     1716    20863    3                  FPTOPEN.PASS_ = VECTOR(VLP_PASS);

  20863  2 006573   000020 235000 3                  LDA     16
         2 006574   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006575   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006576   000166 036003                    ADLQ    118,DU
         2 006577   200066 757100                    STAQ    FPTOPEN+8,,AUTO

     1717    20864    3                  FPTOPEN.WSN_ = VECTOR(VLP_WSN);

  20864  2 006600   000020 235000 3                  LDA     16
         2 006601   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006602   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006603   000170 036003                    ADLQ    120,DU
         2 006604   200110 757100                    STAQ    FPTOPEN+26,,AUTO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:276  
     1718    20865    3                  FPTFID = FPT_FID;

  20865  2 006605   000100 100400                    MLR     fill='000'O
         2 006606   000104 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 006607   200240 000140                    ADSC9   FPTFID,,AUTO             cn=0,n=96

     1719    20866    3                  FPTFID.V_ = VECTOR(FPTFID.V);

  20866  2 006610   000013 235000 3                  LDA     11
         2 006611   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006612   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006613   000264 036003                    ADLQ    180,DU
         2 006614   200240 757100                    STAQ    FPTFID,,AUTO

     1720    20867    3                  FPTFID.NAME_ = VECTOR(VLP_NAME);

  20867  2 006615   000015 235000 3                  LDA     13
         2 006616   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006617   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006620   000154 036003                    ADLQ    108,DU
         2 006621   200244 757100                    STAQ    FPTFID+4,,AUTO

     1721    20868    3                  FPTFID.ACCT_ = VECTOR(VLP_ACCT);

  20868  2 006622   000020 235000 3                  LDA     16
         2 006623   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006624   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006625   000164 036003                    ADLQ    116,DU
         2 006626   200246 757100                    STAQ    FPTFID+6,,AUTO

     1722    20869    3                  FPTFID.PASS_ = VECTOR(VLP_PASS);

  20869  2 006627   000020 235000 3                  LDA     16
         2 006630   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006631   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006632   000166 036003                    ADLQ    118,DU
         2 006633   200250 757100                    STAQ    FPTFID+8,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:277  

     1723    20870    3                  FPTFID.SN_ = VECTOR(VLP_SN);

  20870  2 006634   000013 235000 3                  LDA     11
         2 006635   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006636   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006637   000150 036003                    ADLQ    104,DU
         2 006640   200252 757100                    STAQ    FPTFID+10,,AUTO

     1724    20871    3                  FPTFID.WSN_ = VECTOR(VLP_WSN);

  20871  2 006641   000020 235000 3                  LDA     16
         2 006642   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006643   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006644   000170 036003                    ADLQ    120,DU
         2 006645   200254 757100                    STAQ    FPTFID+12,,AUTO

     1725    20872    3                  FPTFID.ASN_ = VECTOR(FPTOPEN.V.ASN#);

  20872  2 006646   177640 235007                    LDA     65440,DL
         2 006647   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006650   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006651   000024 036000 3                  ADLQ    20
         2 006652   200256 757100                    STAQ    FPTFID+14,,AUTO

     1726    20873    3                  FPTFID.RESULTS_ = VECTOR(VLR_FID);

  20873  2 006653   000025 235000 3                  LDA     21
         2 006654   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006655   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006656   000226 036003                    ADLQ    150,DU
         2 006657   200262 757100                    STAQ    FPTFID+18,,AUTO

     1727    20874    3                  FPTFID.TEXTFID_ = VECTOR(SUBSTR(S_D.DO$->SCHEMA$CMD.FID.TEXT,

  20874  2 006660   000031 471500                    LDP1    25,,PR0
         2 006661   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:278  
         2 006662   000033 772000                    QRL     27
         2 006663   000064 737000                    LLS     52
         2 006664   000140 135007                    SBLA    96,DL
         2 006665   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 006666   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006667   000051 036000 3                  ADLQ    41
         2 006670   200242 757100                    STAQ    FPTFID+2,,AUTO

     1728    20875    3                    0, S_D.DO$->SCHEMA$CMD.FID.SIZE));
     1729    20876    3                  CALL M$FID (FPTFID) ALTRET(ERRMSG);

  20876  2 006671   200240 630500                    EPPR0   FPTFID,,AUTO
         2 006672   420001 713400                    CLIMB   alt,+8193
         2 006673   404400 401760                    pmme    nvectors=10
         2 006674   011552 702000 2                  TSX2    ERRMSG

     1730    20877    3                  IF NOT VLR_FID.ACCT

  20877  2 006675   200226 236100                    LDQ     VLR_FID,,AUTO
         2 006676   200000 316003                    CANQ    65536,DU
         2 006677   006703 601000 2                  TNZ     s:20879

     1731    20878    3                  THEN VLP_ACCT.ACCT# = ' ';

  20878  2 006700   000035 235000 xsym               LDA     B_VECTNIL+29
         2 006701   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 006702   200164 757100                    STAQ    VLP_ACCT,,AUTO

     1732    20879    3                  IF S_D.SCHEMADCB = 0

  20879  2 006703   000000 470400 xsym               LDP0    S_D$
         2 006704   004705 235100                    LDA     2501,,PR0
         2 006705   006732 601000 2                  TNZ     s:20888

     1733    20880    4                  THEN DO;

     1734    20881    4                       FPTGETDCB = FPT_GETDCB;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:279  

  20881  2 006706   000100 100400                    MLR     fill='000'O
         2 006707   000000 000040 xsym               ADSC9   FPT_GETDCB               cn=0,n=32
         2 006710   200200 000040                    ADSC9   FPTGETDCB,,AUTO          cn=0,n=32

     1735    20882    4                       FPTGETDCB.V_ = VECTOR(FPTGETDCB.V);

  20882  2 006711   000020 235000 3                  LDA     16
         2 006712   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006713   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006714   000206 036003                    ADLQ    134,DU
         2 006715   200200 757100                    STAQ    FPTGETDCB,,AUTO

     1736    20883    4                       FPTGETDCB.DCBNUM_ = VECTOR(S_D.LMDCB);

  20883  2 006716   777640 235007                    LDA     -96,DL
         2 006717   000000 236000 xsym               LDQ     S_D$
         2 006720   004774 036003                    ADLQ    2556,DU
         2 006721   200204 757100                    STAQ    FPTGETDCB+4,,AUTO

     1737    20884    4                       CALL M$GETDCB (FPTGETDCB) ALTRET(ERRMSG);

  20884  2 006722   200200 630500                    EPPR0   FPTGETDCB,,AUTO
         2 006723   460002 713400                    CLIMB   alt,+24578
         2 006724   401000 401760                    pmme    nvectors=3
         2 006725   011552 702000 2                  TSX2    ERRMSG

     1738    20885    4                       S_D.SCHEMADCB = S_D.LMDCB;

  20885  2 006726   000000 470400 xsym               LDP0    S_D$
         2 006727   004774 235100                    LDA     2556,,PR0
         2 006730   004705 755100                    STA     2501,,PR0

     1739    20886    4                     END;

  20886  2 006731   006761 710000 2                  TRA     s:20897

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:280  
     1740    20887    4                  ELSE DO;

     1741    20888    4                       IF DCBADDR(S_D.SCHEMADCB) -> F$DCB.FCD#

  20888  2 006732   000012 471400 3                  LDP1    10
         2 006733   100000 473500                    LDP3    0,,PR1
         2 006734   004705 720100                    LXL0    2501,,PR0
         2 006735   300000 474510                    LDP4    0,X0,PR3
         2 006736   400031 236100                    LDQ     25,,PR4
         2 006737   020000 316007                    CANQ    8192,DL
         2 006740   006756 600000 2                  TZE     s:20895

     1742    20889    5                       THEN DO;

     1743    20890    5                            FPT$CLOSE = FPT_CLOSE;

  20890  2 006741   000100 100400                    MLR     fill='000'O
         2 006742   000000 000170 xsym               ADSC9   FPT_CLOSE                cn=0,n=120
         2 006743   200274 000170                    ADSC9   FPT$CLOSE,,AUTO          cn=0,n=120

     1744    20891    5                            FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);

  20891  2 006744   000013 235000 3                  LDA     11
         2 006745   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 006746   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 006747   000326 036003                    ADLQ    214,DU
         2 006750   200274 757100                    STAQ    FPT$CLOSE,,AUTO

     1745    20892    5                            FPT$CLOSE.V.DCB# = S_D.SCHEMADCB;

  20892  2 006751   200326 740100                    STX0    FPT$CLOSE+26,,AUTO

     1746    20893    5                            CALL M$CLOSE (FPT$CLOSE) ALTRET(ERRMSG);

  20893  2 006752   200274 630500                    EPPR0   FPT$CLOSE,,AUTO
         2 006753   450001 713400                    CLIMB   alt,close
         2 006754   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:281  
         2 006755   011552 702000 2                  TSX2    ERRMSG

     1747    20894    5                          END;

     1748    20895    4                       S_D.LMDCB = S_D.SCHEMADCB;

  20895  2 006756   000000 470400 xsym               LDP0    S_D$
         2 006757   004705 235100                    LDA     2501,,PR0
         2 006760   004774 755100                    STA     2556,,PR0

     1749    20896    4                     END;

     1750    20897    3                  FPTOPEN.V.DCB# = S_D.LMDCB;

  20897  2 006761   004774 720100                    LXL0    2556,,PR0
         2 006762   200122 740100                    STX0    FPTOPEN+36,,AUTO

     1751    20898    3                  CALL M$OPEN (FPTOPEN) ALTRET(ERRMSG);

  20898  2 006763   200056 630500                    EPPR0   FPTOPEN,,AUTO
         2 006764   450000 713400                    CLIMB   alt,open
         2 006765   410400 401760                    pmme    nvectors=18
         2 006766   011552 702000 2                  TSX2    ERRMSG

     1752    20899    3                  IF SUBSTR(DCBADDR(S_D.LMDCB) -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'

  20899  2 006767   000012 470400 3                  LDP0    10
         2 006770   000000 471500                    LDP1    0,,PR0
         2 006771   000000 473400 xsym               LDP3    S_D$
         2 006772   304774 720100                    LXL0    2556,,PR3
         2 006773   100000 474510                    LDP4    0,X0,PR1
         2 006774   040000 106500                    CMPC    fill='040'O
         2 006775   400010 200005                    ADSC9   8,,PR4                   cn=1,n=5
         2 006776   000615 000005 1                  ADSC9   AT+21                    cn=0,n=5
         2 006777   007003 601000 2                  TNZ     s:20901

     1753    20900    3                  THEN S_D.RUM_FEP = '1'B;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:282  

  20900  2 007000   400000 236003                    LDQ     -131072,DU
         2 007001   307017 756100                    STQ     3599,,PR3
         2 007002   007004 710000 2                  TRA     SCHEMA

     1754    20901    3                  ELSE S_D.RUM_FEP = '0'B;

  20901  2 007003   307017 450100                    STZ     3599,,PR3

     1755    20902    3                END;

     1756    20903    2   SCHEMA:   IF S_D.DO$ -> SCHEMA$CMD.GOTPOS

  20903  2 007004   000000 470400 xsym  SCHEMA       LDP0    S_D$
         2 007005   000031 471500                    LDP1    25,,PR0
         2 007006   100001 236100                    LDQ     1,,PR1
         2 007007   100000 316007                    CANQ    32768,DL
         2 007010   007015 600000 2                  TZE     s:20906

     1757    20904    2             THEN I = S_D.DO$ -> SCHEMA$CMD.POSITION;

  20904  2 007011   100001 236100                    LDQ     1,,PR1
         2 007012   000020 772000                    QRL     16
         2 007013   200005 756100                    STQ     I,,AUTO
         2 007014   007107 710000 2                  TRA     SCHEMA1

     1758    20905    3             ELSE DO;

     1759    20906    3                  I = S_D.SAVEIC;

  20906  2 007015   000002 235100                    LDA     2,,PR0
         2 007016   200005 755100                    STA     I,,AUTO

     1760    20907    3                  IF NOT S_D.DO$ -> SCHEMA$CMD.GOTFID

  20907  2 007017   100001 236100                    LDQ     1,,PR1
         2 007020   040000 316007                    CANQ    16384,DL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:283  
         2 007021   007107 600000 2                  TZE     SCHEMA1

     1761    20908    3                  THEN GOTO SCHEMA1;
     1762    20909    3                  TOBREL = POFFW( S_D.SCHSEG$, S_D.SCHSEG_BEGIN$ );

  20909  2 007022   000043 236100                    LDQ     35,,PR0
         2 007023   000022 772000                    QRL     18
         2 007024   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 007025   001034 236100                    LDQ     540,,PR0
         2 007026   000022 772000                    QRL     18
         2 007027   200542 136100                    SBLQ    @WHICH_ONE+1,,AUTO
         2 007030   200051 756100                    STQ     TOBREL,,AUTO

     1763    20910    3                  IF TOBREL > 0

  20910  2 007031   007042 600000 2                  TZE     s:20912

     1764    20911    3                  THEN CALL DDM$PUTMEM( S_D_SEG$, TOBREL ) ALTRET( NORELS_D );

  20911  2 007032   200051 631500                    EPPR1   TOBREL,,AUTO
         2 007033   200543 451500                    STP1    @WHICH_ONE+2,,AUTO
         2 007034   000052 236000 3                  LDQ     42
         2 007035   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 007036   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 007040   000000 701000 xent               TSX1    DDM$PUTMEM
         2 007041   011546 702000 2                  TSX2    NORELS_D

     1765    20912    3                  S_D.SCHSEG$ = S_D.SCHSEG_BEGIN$;

  20912  2 007042   000000 470400 xsym               LDP0    S_D$
         2 007043   000043 236100                    LDQ     35,,PR0
         2 007044   001034 756100                    STQ     540,,PR0

     1766    20913    3                  IF S_D.SCHEMADCB ~= 0

  20913  2 007045   004705 235100                    LDA     2501,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:284  
         2 007046   007051 600000 2                  TZE     s:20915

     1767    20914    3                  THEN S_D.LMDCB = S_D.SCHEMADCB;

  20914  2 007047   004774 755100                    STA     2556,,PR0
         2 007050   007060 710000 2                  TRA     s:20918

     1768    20915    3                  ELSE IF S_D.RUM

  20915  2 007051   004755 234100                    SZN     2541,,PR0
         2 007052   007056 605000 2                  TPL     s:20917

     1769    20916    3                       THEN S_D.LMDCB = S_D.RUMDCB;

  20916  2 007053   004776 235100                    LDA     2558,,PR0
         2 007054   004774 755100                    STA     2556,,PR0
         2 007055   007060 710000 2                  TRA     s:20918

     1770    20917    3                       ELSE S_D.LMDCB = D_M$LM#;

  20917  2 007056   000000 235000 xsym               LDA     D_M$LM#
         2 007057   004774 755100                    STA     2556,,PR0

     1771    20918    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  20918  2 007060   006714 235100                    LDA     3532,,PR0
         2 007061   000001 115007                    CMPA    1,DL
         2 007062   007067 601000 2                  TNZ     s:20923

     1772    20919    4                  THEN DO;

     1773    20920    4                       CALL DUI$INIT_HOST;

  20920  2 007063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007064   000000 701000 xent               TSX1    DUI$INIT_HOST
         2 007065   000000 011000                    NOP     0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:285  
     1774    20921    4                     END;

  20921  2 007066   007077 710000 2                  TRA     s:20929

     1775    20922    4                  ELSE DO;

     1776    20923    4                       IF NOT S_D.RUM

  20923  2 007067   004755 234100                    SZN     2541,,PR0
         2 007070   007074 604000 2                  TMI     s:20927

     1777    20924    5                       THEN DO;

     1778    20925    5                            CALL DFA$SETUP_FPRG;

  20925  2 007071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007072   000000 701000 xent               TSX1    DFA$SETUP_FPRG
         2 007073   000000 011000                    NOP     0

     1779    20926    5                          END;

     1780    20927    4                       CALL DUI$INIT_L6;

  20927  2 007074   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007075   000000 701000 xent               TSX1    DUI$INIT_L6
         2 007076   000000 011000                    NOP     0

     1781    20928    4                     END;

     1782    20929    3                  CALL DUI$RU_ACCESS

  20929  2 007077   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007100   000000 701000 xent               TSX1    DUI$RU_ACCESS
         2 007101   007103 702000 2                  TSX2    s:20931
         2 007102   007107 710000 2                  TRA     SCHEMA1

     1783    20930    4                  WHENALTRETURN DO;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:286  

     1784    20931    4                       CALL DDE$ERROR;

  20931  2 007103   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007104   000000 701000 xent               TSX1    DDE$ERROR
         2 007105   000000 011000                    NOP     0

     1785    20932    4                       GOTO NOGO;

  20932  2 007106   011447 710000 2                  TRA     NOGO

     1786    20933    4                     END;
     1787    20934    3                END;

     1788    20935    2   SCHEMA1:
     1789    20936    2             CALL DDS$ES_INQ( I );         /* Ignore altret */

  20936  2 007107   200005 630500       SCHEMA1      EPPR0   I,,AUTO
         2 007110   200542 450500                    STP0    @WHICH_ONE+1,,AUTO
         2 007111   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007113   000000 701000 xent               TSX1    DDS$ES_INQ
         2 007114   000000 011000                    NOP     0

     1790    20937    2             CALL DDS$SET_Q2C;

  20937  2 007115   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007116   000000 701000 xent               TSX1    DDS$SET_Q2C
         2 007117   000000 011000                    NOP     0

     1791    20938    2             CALL DDS$SET_C2D;

  20938  2 007120   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007121   000000 701000 xent               TSX1    DDS$SET_C2D
         2 007122   000000 011000                    NOP     0
         2 007123   011447 710000 2                  TRA     NOGO

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:287  
     1792    20939    2          CASE(66);                 /* SELCHAN */

     1793    20940    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SHOW$CMD));

  20940  2 007124   000031 236100                    LDQ     25,,PR0
         2 007125   000036 036003                    ADLQ    30,DU
         2 007126   000044 756100                    STQ     36,,PR0

     1794    20941    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20941  2 007127   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007130   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007131   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007133   000000 701000 xent               TSX1    DDA$IF
         2 007134   011466 702000 2                  TSX2    ERR

     1795    20942    2             IF NOGO_BIT THEN RETURN;

  20942  2 007135   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007136   007140 605000 2                  TPL     s:20943

  20942  2 007137   000000 702200 xent               TSX2  ! X66_ARET

     1796    20943    2             S_D.CURRENT_CHANNEL = S_D.DO$ -> LCT$CMD.CHAN#;

  20943  2 007140   000000 470400 xsym               LDP0    S_D$
         2 007141   000031 471500                    LDP1    25,,PR0
         2 007142   100002 235100                    LDA     2,,PR1
         2 007143   005321 755100                    STA     2769,,PR0
         2 007144   011447 710000 2                  TRA     NOGO

     1797    20944    2          CASE(44);                    /* SHOW */

     1798    20945    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(SHOW$CMD));

  20945  2 007145   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:288  
         2 007146   000036 036003                    ADLQ    30,DU
         2 007147   000044 756100                    STQ     36,,PR0

     1799    20946    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20946  2 007150   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007151   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007152   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007153   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007154   000000 701000 xent               TSX1    DDA$IF
         2 007155   011466 702000 2                  TSX2    ERR

     1800    20947    2             IF NOGO_BIT THEN RETURN;

  20947  2 007156   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007157   007161 605000 2                  TPL     s:20948

  20947  2 007160   000000 702200 xent               TSX2  ! X66_ARET

     1801    20948    2             CALL DDA$SHOW;

  20948  2 007161   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007162   000000 701000 xent               TSX1    DDA$SHOW
         2 007163   000000 011000                    NOP     0
         2 007164   011447 710000 2                  TRA     NOGO

     1802    20949    2          CASE(85);                  /* STATUS */

     1803    20950    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(ALL_ATTACH));

  20950  2 007165   000031 236100                    LDQ     25,,PR0
         2 007166   000002 036003                    ADLQ    2,DU
         2 007167   000044 756100                    STQ     36,,PR0

     1804    20951    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  20951  2 007170   200004 633500                    EPPR3   NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:289  
         2 007171   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007172   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007174   000000 701000 xent               TSX1    DDA$IF
         2 007175   011466 702000 2                  TSX2    ERR

     1805    20952    2             IF NOGO_BIT THEN RETURN;

  20952  2 007176   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007177   007201 605000 2                  TPL     s:20953

  20952  2 007200   000000 702200 xent               TSX2  ! X66_ARET

     1806    20953    2             S_D.STATUS = '1'B;

  20953  2 007201   400000 236003                    LDQ     -131072,DU
         2 007202   000000 470400 xsym               LDP0    S_D$
         2 007203   006746 756100                    STQ     3558,,PR0
         2 007204   011447 710000 2                  TRA     NOGO

     1807    20954    2          CASE(57);                    /* STEP */

     1808    20955    2             IF S_D.ALIB THEN

  20955  2 007205   005134 234100                    SZN     2652,,PR0
         2 007206   007226 605000 2                  TPL     s:20966

     1809    20956    2                  IF NOT (B$JIT.JUNK & %JJ_UDELTA#)

  20956  2 007207   000000 473400 xsym               LDP3    B$JIT$
         2 007210   300315 220100                    LDX0    205,,PR3
         2 007211   200000 360003                    ANX0    65536,DU
         2 007212   007216 601000 2                  TNZ     s:20961

     1810    20957    3                  THEN DO;

     1811    20958    3                       S_D.ERROR = 218; /*E@CANTSTEPALIB*/
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:290  

  20958  2 007213   000332 235007                    LDA     218,DL
         2 007214   000013 755100                    STA     11,,PR0

     1812    20959    3                       GOTO ERR;

  20959  2 007215   011466 710000 2                  TRA     ERR

     1813    20960    3                     END;
     1814    20961    2                  ELSE IF B$TCB$->B$TCB.STK$->B$ALIBF.WHO ~= %SC_AUSR#

  20961  2 007216   000000 474400 xsym               LDP4    B$TCB$
         2 007217   400001 475500                    LDP5    1,,PR4
         2 007220   500100 236100                    LDQ     64,,PR5
         2 007221   777000 316003                    CANQ    -512,DU
         2 007222   007226 600000 2                  TZE     s:20966

     1815    20962    3                       THEN DO;

     1816    20963    3                            S_D.ERROR = 222; /* E@CANTSTEPSHARED */

  20963  2 007223   000336 235007                    LDA     222,DL
         2 007224   000013 755100                    STA     11,,PR0

     1817    20964    3                            GOTO ERR;

  20964  2 007225   011466 710000 2                  TRA     ERR

     1818    20965    3                          END;
     1819    20966    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  20966  2 007226   006714 235100                    LDA     3532,,PR0
         2 007227   000001 115007                    CMPA    1,DL
         2 007230   007240 601000 2                  TNZ     s:20972

     1820    20967    3             THEN DO;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:291  
     1821    20968    3                  CALL DDA$STEP ALTRET(ERR);

  20968  2 007231   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007232   000000 701000 xent               TSX1    DDA$STEP
         2 007233   011466 702000 2                  TSX2    ERR

     1822    20969    3                  CALL DDA$RESET_PATCH_SPACE;

  20969  2 007234   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007235   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 007236   000000 011000                    NOP     0

     1823    20970    3                  ALTRETURN;

  20970  2 007237   000000 702200 xent               TSX2  ! X66_AALT

     1824    20971    3                END;
     1825    20972    2             ELSE IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.STATE = %STOPPED

  20972  2 007240   000102 473500                    LDP3    66,,PR0
         2 007241   300001 236100                    LDQ     1,,PR3
         2 007242   000777 376003                    ANQ     511,DU
         2 007243   000002 116003                    CMPQ    2,DU
         2 007244   007251 601000 2                  TNZ     s:20975

     1826    20973    2                  THEN CALL DFA$STEP ALTRET(RECOVERY_IN_PROGRESS);

  20973  2 007245   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007246   000000 701000 xent               TSX1    DFA$STEP
         2 007247   011512 702000 2                  TSX2    RECOVERY_IN_PROGRESS
         2 007250   011447 710000 2                  TRA     NOGO

     1827    20974    3                  ELSE DO;

     1828    20975    3                       S_D.ERROR = 344; /* E@FPRGRUNNING */

  20975  2 007251   000530 235007                    LDA     344,DL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:292  
         2 007252   000013 755100                    STA     11,,PR0

     1829    20976    3                       GOTO ERR;

  20976  2 007253   011466 710000 2                  TRA     ERR

     1830    20977    3                     END;
     1831    20978    2          CASE( 83 );                  /* C_STOP */

     1832    20979    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  20979  2 007254   000031 236100                    LDQ     25,,PR0
         2 007255   000002 036003                    ADLQ    2,DU
         2 007256   000044 756100                    STQ     36,,PR0

     1833    20980    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  20980  2 007257   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007260   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007261   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007262   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007263   000000 701000 xent               TSX1    DDA$IF
         2 007264   011466 702000 2                  TSX2    ERR

     1834    20981    2             IF NOGO_BIT THEN RETURN;

  20981  2 007265   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007266   007270 605000 2                  TPL     s:20982

  20981  2 007267   000000 702200 xent               TSX2  ! X66_ARET

     1835    20982    2             IF S_D.DO$->STOP$CMD.FPRG

  20982  2 007270   000000 470400 xsym               LDP0    S_D$
         2 007271   000031 471500                    LDP1    25,,PR0
         2 007272   100001 234100                    SZN     1,,PR1
         2 007273   007334 605000 2                  TPL     s:20999
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:293  

     1836    20983    3             THEN DO;

     1837    20984    3                  TFPRG$ = S_D.FPRG_CONTEXT$;

  20984  2 007274   000076 236100                    LDQ     62,,PR0
         2 007275   200041 756100                    STQ     TFPRG$,,AUTO

     1838    20985    3                  PTFPRG$ = TFPRG$;

  20985  2 007276   200042 756100                    STQ     PTFPRG$,,AUTO

     1839    20986    4                  DO WHILE (SUBSTR(TFPRG$->FPRG$CONTEXT.RES, 0, TFPRG$->FPRG$CONTEXT.
             20986                           RES_SIZE) ~=

  20986  2 007277   007313 710000 2                  TRA     s:20995

     1840    20987    4                    S_D.DO$ -> STOP$CMD.FPRG_RES);
     1841    20988    4                       PTFPRG$ = TFPRG$;

  20988  2 007300   200041 236100                    LDQ     TFPRG$,,AUTO
         2 007301   200042 756100                    STQ     PTFPRG$,,AUTO

     1842    20989    4                       TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  20989  2 007302   200041 470500                    LDP0    TFPRG$,,AUTO
         2 007303   000000 236100                    LDQ     0,,PR0
         2 007304   200041 756100                    STQ     TFPRG$,,AUTO

     1843    20990    4                       IF TFPRG$ = ADDR(NIL)

  20990  2 007305   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 007306   007313 601000 2                  TNZ     s:20995

     1844    20991    5                       THEN DO;

     1845    20992    5                            S_D.ERROR = 278; /* E@NOFPRG */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:294  

  20992  2 007307   000426 235007                    LDA     278,DL
         2 007310   000000 470400 xsym               LDP0    S_D$
         2 007311   000013 755100                    STA     11,,PR0

     1846    20993    5                            GOTO ERR;

  20993  2 007312   011466 710000 2                  TRA     ERR

     1847    20994    5                          END;
     1848    20995    4                     END;

  20995  2 007313   200041 470500                    LDP0    TFPRG$,,AUTO
         2 007314   000004 720100                    LXL0    4,,PR0
         2 007315   000000 471400 xsym               LDP1    S_D$
         2 007316   100031 473500                    LDP3    25,,PR1
         2 007317   040100 106540                    CMPC    fill='040'O
         2 007320   000002 000010                    ADSC9   2,,PR0                   cn=0,n=*X0
         2 007321   300002 000010                    ADSC9   2,,PR3                   cn=0,n=8
         2 007322   007300 601000 2                  TNZ     s:20988

     1849    20996    3                  CALL DFA$STOP_FPRGS (,TFPRG$);

  20996  2 007323   200041 634500                    EPPR4   TFPRG$,,AUTO
         2 007324   200543 454500                    STP4    @WHICH_ONE+2,,AUTO
         2 007325   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007326   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 007327   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007330   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 007331   000000 701000 xent               TSX1    DFA$STOP_FPRGS
         2 007332   000000 011000                    NOP     0

     1850    20997    3                END;

  20997  2 007333   011447 710000 2                  TRA     NOGO

     1851    20998    2             ELSE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:295  
     1852    20999    2                  CALL DFA$STOP_FPRGS;

  20999  2 007334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007335   000000 701000 xent               TSX1    DFA$STOP_FPRGS
         2 007336   000000 011000                    NOP     0
         2 007337   011447 710000 2                  TRA     NOGO

     1853    21000    2          CASE(18);                   /* STORE */

     1854    21001    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  21001  2 007340   006714 235100                    LDA     3532,,PR0
         2 007341   000002 115007                    CMPA    2,DL
         2 007342   011543 600000 2                  TZE     NOTIMPFPRG

     1855    21002    2             THEN GOTO NOTIMPFPRG;
     1856    21003    2             IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ ~= ADDR(NIL)

  21003  2 007343   000101 234100                    SZN     65,,PR0
         2 007344   007357 605000 2                  TPL     s:21011
         2 007345   000102 236100                    LDQ     66,,PR0
         2 007346   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 007347   007357 600000 2                  TZE     s:21011

     1857    21004    3             THEN DO;

     1858    21005    3                  IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.INTERPRETIVE

  21005  2 007350   000102 473500                    LDP3    66,,PR0
         2 007351   300001 236100                    LDQ     1,,PR3
         2 007352   200000 316003                    CANQ    65536,DU
         2 007353   007372 600000 2                  TZE     s:21017

     1859    21006    4                  THEN DO;

     1860    21007    4                       S_D.ERROR = 309; /* E@NOT_INTERPRETIVE */

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:296  
  21007  2 007354   000465 235007                    LDA     309,DL
         2 007355   000013 755100                    STA     11,,PR0

     1861    21008    4                       GOTO ERR;

  21008  2 007356   011466 710000 2                  TRA     ERR

     1862    21009    4                     END;
     1863    21010    3                END;
     1864    21011    2             ELSE IF S_D.FPRG AND S_D.CURRENT_FPRG_CONTEXT$ = ADDR(NIL)

  21011  2 007357   000101 234100                    SZN     65,,PR0
         2 007360   007372 605000 2                  TPL     s:21017
         2 007361   000102 236100                    LDQ     66,,PR0
         2 007362   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 007363   007372 601000 2                  TNZ     s:21017

     1865    21012    3                  THEN DO;

     1866    21013    3                       S_D.ERROR = 502;

  21013  2 007364   000766 235007                    LDA     502,DL
         2 007365   000013 755100                    STA     11,,PR0

     1867    21014    3                       CALL DDE$ERROR;

  21014  2 007366   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007367   000000 701000 xent               TSX1    DDE$ERROR
         2 007370   000000 011000                    NOP     0

     1868    21015    3                       GOTO ERR1;

  21015  2 007371   011506 710000 2                  TRA     ERR1

     1869    21016    3                     END;
     1870    21017    2             S_D.D$ = PINCRW(S_D.DO$, SIZEW(FIND$CMD));

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:297  
  21017  2 007372   000031 236100                    LDQ     25,,PR0
         2 007373   000005 036003                    ADLQ    5,DU
         2 007374   000044 756100                    STQ     36,,PR0

     1871    21018    2             CALL DDA$IF (NOGO_BIT) ALTRET(ERR);

  21018  2 007375   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007376   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007377   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007400   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007401   000000 701000 xent               TSX1    DDA$IF
         2 007402   011466 702000 2                  TSX2    ERR

     1872    21019    2             IF NOGO_BIT THEN RETURN;

  21019  2 007403   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007404   007406 605000 2                  TPL     s:21020

  21019  2 007405   000000 702200 xent               TSX2  ! X66_ARET

     1873    21020    2             CALL DDA$STORE ALTRET(ERR);

  21020  2 007406   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007407   000000 701000 xent               TSX1    DDA$STORE
         2 007410   011466 702000 2                  TSX2    ERR
         2 007411   011447 710000 2                  TRA     NOGO

     1874    21021    2          CASE(45);                    /* C_SAVE */

     1875    21022    2             S_D.ERROR = 502;         /* E@DELBUG */

  21022  2 007412   000766 235007                    LDA     502,DL
         2 007413   000013 755100                    STA     11,,PR0

     1876    21023    2             CALL DDE$ERROR;

  21023  2 007414   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:298  
         2 007415   000000 701000 xent               TSX1    DDE$ERROR
         2 007416   000000 011000                    NOP     0
         2 007417   011447 710000 2                  TRA     NOGO

     1877    21024    2          CASE(77);                     /* SAD */

     1878    21025    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  21025  2 007420   006714 235100                    LDA     3532,,PR0
         2 007421   000002 115007                    CMPA    2,DL
         2 007422   011543 600000 2                  TZE     NOTIMPFPRG

     1879    21026    2             THEN GOTO NOTIMPFPRG;
     1880    21027    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  21027  2 007423   000031 236100                    LDQ     25,,PR0
         2 007424   000002 036003                    ADLQ    2,DU
         2 007425   000044 756100                    STQ     36,,PR0

     1881    21028    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  21028  2 007426   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007427   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007430   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007432   000000 701000 xent               TSX1    DDA$IF
         2 007433   011466 702000 2                  TSX2    ERR

     1882    21029    2             IF NOGO_BIT THEN RETURN;

  21029  2 007434   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007435   007437 605000 2                  TPL     s:21030

  21029  2 007436   000000 702200 xent               TSX2  ! X66_ARET

     1883    21030    2             FPT$SAD = FPT_SAD;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:299  
  21030  2 007437   000100 100400                    MLR     fill='000'O
         2 007440   000134 000020 1                  ADSC9   FPT_SAD                  cn=0,n=16
         2 007441   200352 000020                    ADSC9   FPT$SAD,,AUTO            cn=0,n=16

     1884    21031    2             FPT$SAD.V_ = VECTOR(FPT$SAD.V);

  21031  2 007442   000020 235000 3                  LDA     16
         2 007443   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 007444   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 007445   000354 036003                    ADLQ    236,DU
         2 007446   200352 757100                    STAQ    FPT$SAD,,AUTO

     1885    21032    2             PTR_SAD_SKEL = SAD$;          /* get SEGID from $SAD */

  21032  2 007447   000000 236000 xsym               LDQ     SAD$
         2 007450   200030 756100                    STQ     PTR_SAD_SKEL,,AUTO

     1886    21033    2             FPT$SAD.V.USERSID# = PTR_SAD.PT;

  21033  2 007451   200030 236100                    LDQ     PTR_SAD_SKEL,,AUTO
         2 007452   000022 736000                    QLS     18
         2 007453   200354 752130                    STCQ    FPT$SAD+2,'30'O,AUTO

     1887    21034    2             PTR_SAD.PT.LS = S_D.DO$->DOO.ID;

  21034  2 007454   000000 470400 xsym               LDP0    S_D$
         2 007455   000031 471500                    LDP1    25,,PR0
         2 007456   100001 236100                    LDQ     1,,PR1
         2 007457   000022 772000                    QRL     18
         2 007460   200030 676100                    ERQ     PTR_SAD_SKEL,,AUTO
         2 007461   001777 376007                    ANQ     1023,DL
         2 007462   200030 656100                    ERSQ    PTR_SAD_SKEL,,AUTO

     1888    21035    2             FPT$SAD.V.MONSID# = PTR_SAD.PT;

  21035  2 007463   200030 236100                    LDQ     PTR_SAD_SKEL,,AUTO
         2 007464   200354 752103                    STCQ    FPT$SAD+2,'03'O,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:300  

     1889    21036    2             CALL M$SAD (FPT$SAD) ALTRET(SAD_OOPS);

  21036  2 007465   200352 630500                    EPPR0   FPT$SAD,,AUTO
         2 007466   430015 713400                    CLIMB   alt,+12301
         2 007467   400000 401760                    pmme    nvectors=1
         2 007470   011521 702000 2                  TSX2    SAD_OOPS

     1890    21037    2             S_D.SAD = S_D.DO$ -> DOO.ID;

  21037  2 007471   000000 470400 xsym               LDP0    S_D$
         2 007472   000031 471500                    LDP1    25,,PR0
         2 007473   100001 236100                    LDQ     1,,PR1
         2 007474   000022 772000                    QRL     18
         2 007475   005255 756100                    STQ     2733,,PR0
         2 007476   011447 710000 2                  TRA     NOGO

     1891    21038    2          CASE(79);                  /* SYNTAX */

     1892    21039    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  21039  2 007477   000031 236100                    LDQ     25,,PR0
         2 007500   000002 036003                    ADLQ    2,DU
         2 007501   000044 756100                    STQ     36,,PR0

     1893    21040    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  21040  2 007502   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007503   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007504   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007505   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007506   000000 701000 xent               TSX1    DDA$IF
         2 007507   011466 702000 2                  TSX2    ERR

     1894    21041    2             IF NOGO_BIT THEN RETURN;

  21041  2 007510   200004 234100                    SZN     NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:301  
         2 007511   007513 605000 2                  TPL     s:21042

  21041  2 007512   000000 702200 xent               TSX2  ! X66_ARET

     1895    21042    2             IF S_D.DO$ -> DOO.ID = 0

  21042  2 007513   000000 470400 xsym               LDP0    S_D$
         2 007514   000031 471500                    LDP1    25,,PR0
         2 007515   100001 220100                    LDX0    1,,PR1
         2 007516   007522 601000 2                  TNZ     s:21044

     1896    21043    2             THEN S_D.SYNTAX = S_D.SYNTAX_DEFAULT;

  21043  2 007517   005253 235100                    LDA     2731,,PR0
         2 007520   005235 755100                    STA     2717,,PR0
         2 007521   007526 710000 2                  TRA     s:21045

     1897    21044    2             ELSE S_D.SYNTAX = S_D.DO$ -> DOO.ID - 550; /* C@COMPILER_FIRST */

  21044  2 007522   100001 236100                    LDQ     1,,PR1
         2 007523   000022 772000                    QRL     18
         2 007524   001046 136007                    SBLQ    550,DL
         2 007525   005235 756100                    STQ     2717,,PR0

     1898    21045    2             TEMP$ = DD_COMPNODE$( S_D.SYNTAX );

  21045  2 007526   005235 720100                    LXL0    2717,,PR0
         2 007527   000000 236010 xsym               LDQ     DD_COMPNODE$,X0
         2 007530   200025 756100                    STQ     TEMP$,,AUTO

     1899    21046    3             DO I=0 TO SIZEW(DD$COMP_NODE_PTR$)-1;

  21046  2 007531   200005 450100                    STZ     I,,AUTO
         2 007532   007543 710000 2                  TRA     s:21048+3

     1900    21047    3                  DD_COMP_NODE_PTR$(I) -> DD_NODE.SUBNDS$(0) = TEMP$ ->
             21047                           DD$COMP_NODE_PTR$(I);
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:302  

  21047  2 007533   200005 720100                    LXL0    I,,AUTO
         2 007534   000000 470410 xsym               LDP0    DD_COMP_NODE_PTR$,X0
         2 007535   200025 471500                    LDP1    TEMP$,,AUTO
         2 007536   100000 236110                    LDQ     0,X0,PR1
         2 007537   000001 756100                    STQ     1,,PR0

     1901    21048    3                END;

  21048  2 007540   200005 235100                    LDA     I,,AUTO
         2 007541   000001 035007                    ADLA    1,DL
         2 007542   200005 755100                    STA     I,,AUTO
         2 007543   200005 235100                    LDA     I,,AUTO
         2 007544   000014 115007                    CMPA    12,DL
         2 007545   007533 602000 2                  TNC     s:21047
         2 007546   011447 710000 2                  TRA     NOGO

     1902    21049    2          CASE(61);                   /*C_TBOOT*/

     1903    21050    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(DOO));

  21050  2 007547   000031 236100                    LDQ     25,,PR0
         2 007550   000002 036003                    ADLQ    2,DU
         2 007551   000044 756100                    STQ     36,,PR0

     1904    21051    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  21051  2 007552   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007553   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007554   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007555   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007556   000000 701000 xent               TSX1    DDA$IF
         2 007557   011466 702000 2                  TSX2    ERR

     1905    21052    2             IF NOGO_BIT THEN RETURN;

  21052  2 007560   200004 234100                    SZN     NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:303  
         2 007561   007563 605000 2                  TPL     s:21053

  21052  2 007562   000000 702200 xent               TSX2  ! X66_ARET

     1906    21053    2             CALL DXA$TBOOT;

  21053  2 007563   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007564   000000 701000 xent               TSX1    DXA$TBOOT
         2 007565   000000 011000                    NOP     0
         2 007566   011447 710000 2                  TRA     NOGO

     1907    21054    2          CASE(26);                       /* TRACE (CALLS,OFF,TRANSFER) */

     1908    21055    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(TR$CMD));

  21055  2 007567   000031 236100                    LDQ     25,,PR0
         2 007570   000011 036003                    ADLQ    9,DU
         2 007571   000044 756100                    STQ     36,,PR0

     1909    21056    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  21056  2 007572   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007573   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007574   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007575   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007576   000000 701000 xent               TSX1    DDA$IF
         2 007577   011466 702000 2                  TSX2    ERR

     1910    21057    2             IF NOGO_BIT THEN RETURN;

  21057  2 007600   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007601   007603 605000 2                  TPL     s:21058

  21057  2 007602   000000 702200 xent               TSX2  ! X66_ARET

     1911    21058    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:304  
  21058  2 007603   000000 470400 xsym               LDP0    S_D$
         2 007604   006714 235100                    LDA     3532,,PR0
         2 007605   000001 115007                    CMPA    1,DL
         2 007606   007613 601000 2                  TNZ     s:21060

     1912    21059    2             THEN CALL DDA$TRACE;

  21059  2 007607   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007610   000000 701000 xent               TSX1    DDA$TRACE
         2 007611   000000 011000                    NOP     0
         2 007612   011447 710000 2                  TRA     NOGO

     1913    21060    2             ELSE CALL DFA$TRACE;

  21060  2 007613   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007614   000000 701000 xent               TSX1    DFA$TRACE
         2 007615   000000 011000                    NOP     0
         2 007616   011447 710000 2                  TRA     NOGO

     1914    21061    2          CASE(84);                     /* FORMAT TSA */

     1915    21062    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  21062  2 007617   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007620   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007621   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007623   000000 701000 xent               TSX1    DDA$IF
         2 007624   011466 702000 2                  TSX2    ERR

     1916    21063    2             IF NOGO_BIT THEN RETURN;

  21063  2 007625   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007626   007630 605000 2                  TPL     s:21064

  21063  2 007627   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:305  
     1917    21064    2             CALL DFA$TSA ALTRET (ERR);

  21064  2 007630   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007631   000000 701000 xent               TSX1    DFA$TSA
         2 007632   011466 702000 2                  TSX2    ERR
         2 007633   011447 710000 2                  TRA     NOGO

     1918    21065    2          CASE(87);                   /* C_UNFID */

     1919    21066    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ));

  21066  2 007634   000031 236100                    LDQ     25,,PR0
         2 007635   000002 036003                    ADLQ    2,DU
         2 007636   000044 756100                    STQ     36,,PR0

     1920    21067    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  21067  2 007637   006714 235100                    LDA     3532,,PR0
         2 007640   000002 115007                    CMPA    2,DL
         2 007641   007646 601000 2                  TNZ     s:21072

     1921    21068    3             THEN DO;

     1922    21069    3                  CALL DFA$UNFID ALTRET(ERR);

  21069  2 007642   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 007643   000000 701000 xent               TSX1    DFA$UNFID
         2 007644   011466 702000 2                  TSX2    ERR

     1923    21070    3                END;

  21070  2 007645   011447 710000 2                  TRA     NOGO

     1924    21071    3             ELSE DO;

     1925    21072    3                  CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:306  
  21072  2 007646   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 007647   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 007650   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007651   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007652   000000 701000 xent               TSX1    DDA$IF
         2 007653   011466 702000 2                  TSX2    ERR

     1926    21073    3                  IF NOGO_BIT THEN RETURN;

  21073  2 007654   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 007655   007657 605000 2                  TPL     s:21074

  21073  2 007656   000000 702200 xent               TSX2  ! X66_ARET

     1927    21074    4                  IF S_D.DO$->UNFID$CMD.K13 THEN DO;

  21074  2 007657   000000 470400 xsym               LDP0    S_D$
         2 007660   000031 471500                    LDP1    25,,PR0
         2 007661   100001 236100                    LDQ     1,,PR1
         2 007662   400000 316007                    CANQ    -131072,DL
         2 007663   007765 600000 2                  TZE     s:21096

     1928    21075    4                       LOWX = S_D.DO$->UNFID$CMD.ID_FROM;

  21075  2 007664   100001 236100                    LDQ     1,,PR1
         2 007665   000033 772000                    QRL     27
         2 007666   200013 756100                    STQ     LOWX,,AUTO

     1929    21076    4                       HIGX = S_D.DO$->UNFID$CMD.ID_TO;

  21076  2 007667   100001 236100                    LDQ     1,,PR1
         2 007670   000022 772000                    QRL     18
         2 007671   000777 376007                    ANQ     511,DL
         2 007672   200014 756100                    STQ     HIGX,,AUTO

     1930    21077    4                       OPEN = S_D.DO$->UNFID$CMD.OPEN;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:307  
  21077  2 007673   100001 236100                    LDQ     1,,PR1
         2 007674   000024 736000                    QLS     20
         2 007675   400000 376003                    ANQ     -131072,DU
         2 007676   200015 756100                    STQ     OPEN,,AUTO

     1931    21078    4                       CLOSED = S_D.DO$->UNFID$CMD.CLOSED;

  21078  2 007677   100001 236100                    LDQ     1,,PR1
         2 007700   000023 736000                    QLS     19
         2 007701   400000 376003                    ANQ     -131072,DU
         2 007702   200016 756100                    STQ     CLOSED,,AUTO

     1932    21079    5                       DO DCB# = LOWX TO HIGX;

  21079  2 007703   200013 235100                    LDA     LOWX,,AUTO
         2 007704   200023 755100                    STA     DCB#,,AUTO
         2 007705   007760 710000 2                  TRA     s:21093+1

     1933    21080    6                            IF LOWX = HIGX THEN DO;

  21080  2 007706   200013 236100                    LDQ     LOWX,,AUTO
         2 007707   200014 116100                    CMPQ    HIGX,,AUTO
         2 007710   007733 601000 2                  TNZ     s:21090

     1934    21081    7                                 IF DCB# > B$ROS$->B$ROSEG.NUMDCBS THEN DO;

  21081  2 007711   000000 470400 xsym               LDP0    B$ROS$
         2 007712   000002 236100                    LDQ     2,,PR0
         2 007713   000022 772000                    QRL     18
         2 007714   200023 116100                    CMPQ    DCB#,,AUTO
         2 007715   007722 605000 2                  TPL     s:21085

     1935    21082    7                                      S_D.ERROR = 183;

  21082  2 007716   000267 235007                    LDA     183,DL
         2 007717   000000 471400 xsym               LDP1    S_D$
         2 007720   100013 755100                    STA     11,,PR1
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:308  

     1936    21083    7                                      GOTO ERR;

  21083  2 007721   011466 710000 2                  TRA     ERR

     1937    21084    7                                    END;
     1938    21085    7                                IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#) = ADDR(NIL)
             21085                                          THEN DO;

  21085  2 007722   000000 471500                    LDP1    0,,PR0
         2 007723   200023 720100                    LXL0    DCB#,,AUTO
         2 007724   100000 236110                    LDQ     0,X0,PR1
         2 007725   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 007726   007733 601000 2                  TNZ     s:21090

     1939    21086    7                                      S_D.ERROR = 184;

  21086  2 007727   000270 235007                    LDA     184,DL
         2 007730   000000 473400 xsym               LDP3    S_D$
         2 007731   300013 755100                    STA     11,,PR3

     1940    21087    7                                      GOTO ERR;

  21087  2 007732   011466 710000 2                  TRA     ERR

     1941    21088    7                                    END;
     1942    21089    6                               END;
     1943    21090    5                            IF DCB# <= B$ROS$->B$ROSEG.NUMDCBS

  21090  2 007733   000000 470400 xsym               LDP0    B$ROS$
         2 007734   000002 236100                    LDQ     2,,PR0
         2 007735   000022 772000                    QRL     18
         2 007736   200023 116100                    CMPQ    DCB#,,AUTO
         2 007737   007757 604000 2                  TMI     s:21093

     1944    21091    5                           THEN IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#) ~= ADDR(NIL
             21091                                     )
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:309  

  21091  2 007740   000000 471500                    LDP1    0,,PR0
         2 007741   200023 720100                    LXL0    DCB#,,AUTO
         2 007742   100000 236110                    LDQ     0,X0,PR1
         2 007743   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 007744   007757 600000 2                  TZE     s:21093

     1945    21092    5                                 THEN CALL DUA$UNFID(DCB#, OPEN, CLOSED) ALTRET(ERR);

  21092  2 007745   200016 633500                    EPPR3   CLOSED,,AUTO
         2 007746   200544 453500                    STP3    @WHICH_ONE+3,,AUTO
         2 007747   200015 631500                    EPPR1   OPEN,,AUTO
         2 007750   200543 451500                    STP1    @WHICH_ONE+2,,AUTO
         2 007751   200023 634500                    EPPR4   DCB#,,AUTO
         2 007752   200542 454500                    STP4    @WHICH_ONE+1,,AUTO
         2 007753   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 007754   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 007755   000000 701000 xent               TSX1    DUA$UNFID
         2 007756   011466 702000 2                  TSX2    ERR

     1946    21093    5                          END;

  21093  2 007757   200023 054100                    AOS     DCB#,,AUTO
         2 007760   200014 236100                    LDQ     HIGX,,AUTO
         2 007761   007706 604000 2                  TMI     s:21080
         2 007762   200023 116100                    CMPQ    DCB#,,AUTO
         2 007763   007706 605000 2                  TPL     s:21080

     1947    21094    4                     END;

  21094  2 007764   011447 710000 2                  TRA     NOGO

     1948    21095    4                  ELSE DO;

     1949    21096    4                       HIGX = B$ROS$->B$ROSEG.NUMDCBS;

  21096  2 007765   000000 473400 xsym               LDP3    B$ROS$
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:310  
         2 007766   300002 236100                    LDQ     2,,PR3
         2 007767   000022 772000                    QRL     18
         2 007770   200014 756100                    STQ     HIGX,,AUTO

     1950    21097    5                       DO DCB# = 0 TO HIGX;

  21097  2 007771   200023 450100                    STZ     DCB#,,AUTO
         2 007772   010020 710000 2                  TRA     s:21101+1

     1951    21098    5                            IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#) ~= ADDR(NIL)
             21098                                     THEN

  21098  2 007773   000000 470400 xsym               LDP0    B$ROS$
         2 007774   000000 471500                    LDP1    0,,PR0
         2 007775   200023 720100                    LXL0    DCB#,,AUTO
         2 007776   100000 236110                    LDQ     0,X0,PR1
         2 007777   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 010000   010017 600000 2                  TZE     s:21101

     1952    21099    5                                 IF B$ROS$->B$ROSEG.DCBPTR$->B$RODCB$(DCB#)->F$DCB.
             21099                                          DCBNAME.N =

  21099  2 010001   100000 473510                    LDP3    0,X0,PR1
         2 010002   300140 236100                    LDQ     96,,PR3
         2 010003   000033 772000                    QRL     27
         2 010004   000037 376007                    ANQ     31,DL
         2 010005   000000 474400 xsym               LDP4    S_D$
         2 010006   400031 475500                    LDP5    25,,PR4
         2 010007   000000 621006                    EAX1    0,QL
         2 010010   500002 236100                    LDQ     2,,PR5
         2 010011   000033 772000                    QRL     27
         2 010012   000000 622006                    EAX2    0,QL
         2 010013   040140 106540                    CMPC    fill='040'O
         2 010014   300140 200011                    ADSC9   96,,PR3                  cn=1,n=*X1
         2 010015   500002 200012                    ADSC9   2,,PR5                   cn=1,n=*X2
         2 010016   010024 600000 2                  TZE     s:21102

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:311  
     1953    21100    5                                   SUBSTR(S_D.DO$->UNFID$CMD.DCBN.C,0,S_D.DO$->
             21100                                            UNFID$CMD.DCBN.L) THEN EXIT;
     1954    21101    5                          END;

  21101  2 010017   200023 054100                    AOS     DCB#,,AUTO
         2 010020   200014 236100                    LDQ     HIGX,,AUTO
         2 010021   007773 604000 2                  TMI     s:21098
         2 010022   200023 116100                    CMPQ    DCB#,,AUTO
         2 010023   007773 605000 2                  TPL     s:21098

     1955    21102    5                       IF DCB# > HIGX THEN DO;

  21102  2 010024   200014 236100                    LDQ     HIGX,,AUTO
         2 010025   010034 604000 2                  TMI     s:21106
         2 010026   200023 116100                    CMPQ    DCB#,,AUTO
         2 010027   010034 605000 2                  TPL     s:21106

     1956    21103    5                            S_D.ERROR = 183;

  21103  2 010030   000267 235007                    LDA     183,DL
         2 010031   000000 470400 xsym               LDP0    S_D$
         2 010032   000013 755100                    STA     11,,PR0

     1957    21104    5                            GOTO ERR;

  21104  2 010033   011466 710000 2                  TRA     ERR

     1958    21105    5                          END;
     1959    21106    4                       CALL DUA$UNFID (DCB#) ALTRET (ERR);

  21106  2 010034   200023 630500                    EPPR0   DCB#,,AUTO
         2 010035   200542 450500                    STP0    @WHICH_ONE+1,,AUTO
         2 010036   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010040   000000 701000 xent               TSX1    DUA$UNFID
         2 010041   011466 702000 2                  TSX2    ERR

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:312  
     1960    21107    4                     END;

     1961    21108    3                END;

  21108  2 010042   011447 710000 2                  TRA     NOGO

     1962    21109    2          CASE(90);                 /* C_UNSHARE */

     1963    21110    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( DOO ) );

  21110  2 010043   000031 236100                    LDQ     25,,PR0
         2 010044   000002 036003                    ADLQ    2,DU
         2 010045   000044 756100                    STQ     36,,PR0

     1964    21111    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  21111  2 010046   006714 235100                    LDA     3532,,PR0
         2 010047   000002 115007                    CMPA    2,DL
         2 010050   010224 601000 2                  TNZ     s:21147

     1965    21112    3             THEN DO;

     1966    21113    3                  GD$MSG = '0'B;

  21113  2 010051   000000 473400 xsym               LDP3    S_D_L6_MESSAGE$
         2 010052   003100 060400                    CSL     bolr='003'O
         2 010053   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 010054   300000 004720                    BDSC    0,,PR3                   by=0,bit=0,n=2512

     1967    21114    3                  IF S_D.DO$ -> UNSHARE$CMD.PROGRAM AND

  21114  2 010055   000031 471500                    LDP1    25,,PR0
         2 010056   100001 234100                    SZN     1,,PR1
         2 010057   010070 605000 2                  TPL     s:21117
         2 010060   100001 236100                    LDQ     1,,PR1
         2 010061   200000 316003                    CANQ    65536,DU
         2 010062   010070 600000 2                  TZE     s:21117
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:313  

     1968    21115    3                    S_D.DO$ -> UNSHARE$CMD.LIBRARY
     1969    21116    3                  THEN GD$MSG.FNC = %GD#RQSUNSHAREALL;

  21116  2 010063   300000 236100                    LDQ     0,,PR3
         2 010064   000030 376000 3                  ANQ     24
         2 010065   072000 276003                    ORQ     29696,DU
         2 010066   300000 756100                    STQ     0,,PR3
         2 010067   010106 710000 2                  TRA     s:21121

     1970    21117    3                  ELSE IF S_D.DO$ -> UNSHARE$CMD.PROGRAM

  21117  2 010070   100001 234100                    SZN     1,,PR1
         2 010071   010077 605000 2                  TPL     s:21119

     1971    21118    3                       THEN GD$MSG.FNC = %GD#RQSUNSHAREPROG;

  21118  2 010072   300000 236100                    LDQ     0,,PR3
         2 010073   000030 376000 3                  ANQ     24
         2 010074   076000 276003                    ORQ     31744,DU
         2 010075   300000 756100                    STQ     0,,PR3
         2 010076   010106 710000 2                  TRA     s:21121

     1972    21119    3                       ELSE IF S_D.DO$ -> UNSHARE$CMD.LIBRARY

  21119  2 010077   100001 236100                    LDQ     1,,PR1
         2 010100   200000 316003                    CANQ    65536,DU
         2 010101   010106 600000 2                  TZE     s:21121

     1973    21120    3                            THEN GD$MSG.FNC = %GD#RQSUNSHARELIB;

  21120  2 010102   300000 236100                    LDQ     0,,PR3
         2 010103   000030 376000 3                  ANQ     24
         2 010104   074000 276003                    ORQ     30720,DU
         2 010105   300000 756100                    STQ     0,,PR3

     1974    21121    3                  CALL DFQ$WRITE_FD(S_D.CURRENT_FPRG_CONTEXT$)
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:314  

  21121  2 010106   000000 236000 xsym               LDQ     S_D$
         2 010107   000102 036003                    ADLQ    66,DU
         2 010110   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 010111   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010113   000000 701000 xent               TSX1    DFQ$WRITE_FD
         2 010114   010116 702000 2                  TSX2    s:21123
         2 010115   010121 710000 2                  TRA     s:21125

     1975    21122    4                  WHENALTRETURN DO;

     1976    21123    4                       CALL DUE$ERRMSG;

  21123  2 010116   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010117   000000 701000 xent               TSX1    DUE$ERRMSG
         2 010120   000000 011000                    NOP     0

     1977    21124    4                     END;

     1978    21125    3                  CALL DFQ$READ_FD(S_D.CURRENT_FPRG_CONTEXT$, '0'B)

  21125  2 010121   000001 236000 3                  LDQ     1
         2 010122   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 010123   000000 236000 xsym               LDQ     S_D$
         2 010124   000102 036003                    ADLQ    66,DU
         2 010125   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 010126   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010127   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 010130   000000 701000 xent               TSX1    DFQ$READ_FD
         2 010131   010133 702000 2                  TSX2    s:21127
         2 010132   010136 710000 2                  TRA     s:21129

     1979    21126    4                  WHENALTRETURN DO;

     1980    21127    4                       CALL DUE$ERRMSG;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:315  
  21127  2 010133   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010134   000000 701000 xent               TSX1    DUE$ERRMSG
         2 010135   000000 011000                    NOP     0

     1981    21128    4                     END;

     1982    21129    3                  IF GD$MSG.FNC ~= %GD#RSPACK

  21129  2 010136   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 010137   000000 236100                    LDQ     0,,PR0
         2 010140   776000 376003                    ANQ     -1024,DU
         2 010141   106000 116003                    CMPQ    35840,DU
         2 010142   010213 600000 2                  TZE     s:21143

     1983    21130    4                  THEN DO;

     1984    21131    4                       IF S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA

  21131  2 010143   000000 471400 xsym               LDP1    S_D$
         2 010144   100102 473500                    LDP3    66,,PR1
         2 010145   300001 236100                    LDQ     1,,PR3
         2 010146   002000 316003                    CANQ    1024,DU
         2 010147   010203 600000 2                  TZE     s:21140

     1985    21132    5                       THEN DO;

     1986    21133    5                            TEMP1 = BITBIN(GD$MSG.ERROR_D.ERRCODE);

  21133  2 010150   000000 235100                    LDA     0,,PR0
         2 010151   000001 236100                    LDQ     1,,PR0
         2 010152   000030 773000                    LRL     24
         2 010153   000053 376000 3                  ANQ     43
         2 010154   200025 756100                    STQ     TEMP$,,AUTO

     1987    21134    5                            TEMP2B.B1 = TEMP1B.B1;

  21134  2 010155   200025 236100                    LDQ     TEMP$,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:316  
         2 010156   000003 736000                    QLS     3
         2 010157   200026 676100                    ERQ     TEMP2,,AUTO
         2 010160   377000 376003                    ANQ     130560,DU
         2 010161   200026 656100                    ERSQ    TEMP2,,AUTO

     1988    21135    5                            TEMP2B.B2 = TEMP1B.B2;

  21135  2 010162   200025 236100                    LDQ     TEMP$,,AUTO
         2 010163   000002 736000                    QLS     2
         2 010164   200026 676100                    ERQ     TEMP2,,AUTO
         2 010165   000377 376003                    ANQ     255,DU
         2 010166   200026 656100                    ERSQ    TEMP2,,AUTO

     1989    21136    5                            TEMP2B.B3 = TEMP1B.B3;

  21136  2 010167   200025 236100                    LDQ     TEMP$,,AUTO
         2 010170   000001 736000                    QLS     1
         2 010171   200026 676100                    ERQ     TEMP2,,AUTO
         2 010172   377000 376007                    ANQ     130560,DL
         2 010173   200026 656100                    ERSQ    TEMP2,,AUTO

     1990    21137    5                            TEMP2B.B4 = TEMP1B.B4;

  21137  2 010174   200025 236100                    LDQ     TEMP$,,AUTO
         2 010175   200026 676100                    ERQ     TEMP2,,AUTO
         2 010176   000377 376007                    ANQ     255,DL
         2 010177   200026 656100                    ERSQ    TEMP2,,AUTO

     1991    21138    5                            S_D.JDE = TEMP2;

  21138  2 010200   200026 235100                    LDA     TEMP2,,AUTO
         2 010201   104733 755100                    STA     2523,,PR1

     1992    21139    5                          END;

  21139  2 010202   010210 710000 2                  TRA     s:21141

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:317  
     1993    21140    4                       ELSE S_D.JDE = BITBIN(GD$MSG_HOST.ERROR_D.ERRCODE);

  21140  2 010203   000000 474400 xsym               LDP4    S_D_HOST_MESSAGE$
         2 010204   400000 235100                    LDA     0,,PR4
         2 010205   400001 236100                    LDQ     1,,PR4
         2 010206   000022 773000                    LRL     18
         2 010207   104733 756100                    STQ     2523,,PR1

     1994    21141    4                       CALL DUE$GERRMSG;

  21141  2 010210   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010211   000000 701000 xent               TSX1    DUE$GERRMSG
         2 010212   000000 011000                    NOP     0

     1995    21142    4                     END;

     1996    21143    3                  IF S_D.DO$ -> UNSHARE$CMD.LIBRARY

  21143  2 010213   000000 470400 xsym               LDP0    S_D$
         2 010214   000031 471500                    LDP1    25,,PR0
         2 010215   100001 236100                    LDQ     1,,PR1
         2 010216   200000 316003                    CANQ    65536,DU
         2 010217   010223 600000 2                  TZE     s:21145

     1997    21144    3                  THEN S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.SHARED = '0'B;

  21144  2 010220   000102 473500                    LDP3    66,,PR0
         2 010221   000054 236000 3                  LDQ     44
         2 010222   300001 356100                    ANSQ    1,,PR3

     1998    21145    3                  RETURN;

  21145  2 010223   000000 702200 xent               TSX2  ! X66_ARET

     1999    21146    3                END;
     2000    21147    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:318  
  21147  2 010224   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 010225   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 010226   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010230   000000 701000 xent               TSX1    DDA$IF
         2 010231   011466 702000 2                  TSX2    ERR

     2001    21148    2             IF NOGO_BIT THEN RETURN;

  21148  2 010232   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 010233   010235 605000 2                  TPL     s:21149

  21148  2 010234   000000 702200 xent               TSX2  ! X66_ARET

     2002    21149    2             FPT$UNSHARE = FPT_UNSHARE;

  21149  2 010235   000100 100400                    MLR     fill='000'O
         2 010236   000140 000020 1                  ADSC9   FPT_UNSHARE              cn=0,n=16
         2 010237   200356 000020                    ADSC9   FPT$UNSHARE,,AUTO        cn=0,n=16

     2003    21150    2             FPT$UNSHARE.V_ = VECTOR( FPT$UNSHARE.V );

  21150  2 010240   000020 235000 3                  LDA     16
         2 010241   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 010242   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 010243   000360 036003                    ADLQ    240,DU
         2 010244   200356 757100                    STAQ    FPT$UNSHARE,,AUTO

     2004    21151    2             IF S_D.DO$ -> UNSHARE$CMD.PROGRAM

  21151  2 010245   000000 470400 xsym               LDP0    S_D$
         2 010246   000031 471500                    LDP1    25,,PR0
         2 010247   100001 234100                    SZN     1,,PR1
         2 010250   010263 605000 2                  TPL     s:21159

     2005    21152    3             THEN DO;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:319  
     2006    21153    3                  FPT$UNSHARE.V.FLGS.PROG# = '1'B;

  21153  2 010251   002000 236003                    LDQ     1024,DU
         2 010252   200360 256100                    ORSQ    FPT$UNSHARE+2,,AUTO

     2007    21154    3                  CALL M$UNSHARE( FPT$UNSHARE ) ALTRET( UNSHPROG );

  21154  2 010253   200356 630500                    EPPR0   FPT$UNSHARE,,AUTO
         2 010254   400025 713400                    CLIMB   alt,+21
         2 010255   400000 401760                    pmme    nvectors=1
         2 010256   010260 702000 2                  TSX2    UNSHPROG

     2008    21155    4                  DO WHILE ( '0'B );

  21155  2 010257   010263 710000 2                  TRA     s:21159

     2009    21156    4   UNSHPROG:           CALL DUE$ERRMSG;

  21156  2 010260   000002 631400 xsym  UNSHPROG     EPPR1   B_VECTNIL+2
         2 010261   000000 701000 xent               TSX1    DUE$ERRMSG
         2 010262   000000 011000                    NOP     0

     2010    21157    4                     END;

     2011    21158    3                END;

     2012    21159    2             FPT$UNSHARE.V.FLGS.PROG# = '0'B;

  21159  2 010263   000027 236000 3                  LDQ     23
         2 010264   200360 356100                    ANSQ    FPT$UNSHARE+2,,AUTO

     2013    21160    2             IF S_D.DO$ -> UNSHARE$CMD.LIBRARY

  21160  2 010265   000000 470400 xsym               LDP0    S_D$
         2 010266   000031 471500                    LDP1    25,,PR0
         2 010267   100001 236100                    LDQ     1,,PR1
         2 010270   200000 316003                    CANQ    65536,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:320  
         2 010271   011447 600000 2                  TZE     NOGO

     2014    21161    3             THEN DO;

     2015    21162    3                  FPT$UNSHARE.V.FLGS.LIB# = '1'B;

  21162  2 010272   001000 236003                    LDQ     512,DU
         2 010273   200360 256100                    ORSQ    FPT$UNSHARE+2,,AUTO

     2016    21163    3                  CALL M$UNSHARE( FPT$UNSHARE ) ALTRET( UNSHLIB );

  21163  2 010274   200356 630500                    EPPR0   FPT$UNSHARE,,AUTO
         2 010275   400025 713400                    CLIMB   alt,+21
         2 010276   400000 401760                    pmme    nvectors=1
         2 010277   010301 702000 2                  TSX2    UNSHLIB

     2017    21164    4                  DO WHILE ( '0'B );

  21164  2 010300   011447 710000 2                  TRA     NOGO

     2018    21165    4   UNSHLIB:            CALL DUE$ERRMSG;

  21165  2 010301   000002 631400 xsym  UNSHLIB      EPPR1   B_VECTNIL+2
         2 010302   000000 701000 xent               TSX1    DUE$ERRMSG
         2 010303   000000 011000                    NOP     0

     2019    21166    4                     END;

     2020    21167    3                END;

  21167  2 010304   011447 710000 2                  TRA     NOGO

     2021    21168    2          CASE ( 75 );               /* C_UPDATE */

     2022    21169    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(ACTIVE$CMD));

  21169  2 010305   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:321  
         2 010306   000003 036003                    ADLQ    3,DU
         2 010307   000044 756100                    STQ     36,,PR0

     2023    21170    2             CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  21170  2 010310   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 010311   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 010312   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010313   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010314   000000 701000 xent               TSX1    DDA$IF
         2 010315   011466 702000 2                  TSX2    ERR

     2024    21171    2             IF NOGO_BIT THEN RETURN;

  21171  2 010316   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 010317   010321 605000 2                  TPL     s:21172

  21171  2 010320   000000 702200 xent               TSX2  ! X66_ARET

     2025    21172    2             CALL DDA$UPDATE ALTRET(ERR);

  21172  2 010321   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010322   000000 701000 xent               TSX1    DDA$UPDATE
         2 010323   011466 702000 2                  TSX2    ERR
         2 010324   011447 710000 2                  TRA     NOGO

     2026    21173    2          CASE(64);                     /* USE */

     2027    21174    2             S_D.D$ = PINCRW( S_D.DO$, SIZEW( USE$CMD ) );

  21174  2 010325   000031 236100                    LDQ     25,,PR0
         2 010326   000006 036003                    ADLQ    6,DU
         2 010327   000044 756100                    STQ     36,,PR0

     2028    21175    2             CALL DDA$IF( NOGO_BIT ) ALTRET( ERR );

  21175  2 010330   200004 633500                    EPPR3   NOGO_BIT,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:322  
         2 010331   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 010332   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010333   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010334   000000 701000 xent               TSX1    DDA$IF
         2 010335   011466 702000 2                  TSX2    ERR

     2029    21176    2             IF NOGO_BIT THEN RETURN;

  21176  2 010336   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 010337   010341 605000 2                  TPL     s:21177

  21176  2 010340   000000 702200 xent               TSX2  ! X66_ARET

     2030    21177    2             TYPE = S_D.DO$ -> USE$CMD.TYPE;

  21177  2 010341   000000 470400 xsym               LDP0    S_D$
         2 010342   000031 471500                    LDP1    25,,PR0
         2 010343   100001 236100                    LDQ     1,,PR1
         2 010344   000022 772000                    QRL     18
         2 010345   200007 756100                    STQ     TYPE,,AUTO

     2031    21178    2             IF D_XDELTA

  21178  2 010346   000000 234000 xsym               SZN     D_XDELTA
         2 010347   010354 605000 2                  TPL     s:21182

     2032    21179    3             THEN DO;

     2033    21180    3                  CALL DXA$USE;

  21180  2 010350   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010351   000000 701000 xent               TSX1    DXA$USE
         2 010352   000000 011000                    NOP     0

     2034    21181    3                END;

  21181  2 010353   011447 710000 2                  TRA     NOGO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:323  

     2035    21182    2             ELSE IF S_D.FPRG AND

  21182  2 010354   000101 234100                    SZN     65,,PR0
         2 010355   010373 605000 2                  TPL     s:21189
         2 010356   000102 473500                    LDP3    66,,PR0
         2 010357   300001 236100                    LDQ     1,,PR3
         2 010360   002000 316003                    CANQ    1024,DU
         2 010361   010364 601000 2                  TNZ     s:21182+8
         2 010362   300001 430100                    FSZN    1,,PR3
         2 010363   010373 605000 2                  TPL     s:21189
         2 010364   200007 235100                    LDA     TYPE,,AUTO
         2 010365   000011 115007                    CMPA    9,DL
         2 010366   010373 600000 2                  TZE     s:21189

     2036    21183    2                    (S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.XDELTA OR
     2037    21184    2                    S_D.CURRENT_FPRG_CONTEXT$ -> FPRG$CONTEXT.FANLZ) AND
     2038    21185    2                    TYPE ~= 9    /* USE_SECTION */
     2039    21186    3                  THEN DO;

     2040    21187    3                       CALL DFA$USE;

  21187  2 010367   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010370   000000 701000 xent               TSX1    DFA$USE
         2 010371   000000 011000                    NOP     0

     2041    21188    3                     END;

  21188  2 010372   011447 710000 2                  TRA     NOGO

     2042    21189    2                  ELSE IF TYPE = 6 /* USE_NODE */ AND

  21189  2 010373   200007 235100                    LDA     TYPE,,AUTO
         2 010374   000006 115007                    CMPA    6,DL
         2 010375   010432 601000 2                  TNZ     s:21200
         2 010376   000101 234100                    SZN     65,,PR0
         2 010377   010432 604000 2                  TMI     s:21200
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:324  

     2043    21190    2                         NOT S_D.FPRG
     2044    21191    3                       THEN DO;

     2045    21192    3                            S_D.NODE = S_D.DO$ -> USE$CMD.NODE;

  21192  2 010400   100002 235100                    LDA     2,,PR1
         2 010401   004706 755100                    STA     2502,,PR0

     2046    21193    3                            CALL DDS$EUTREE;

  21193  2 010402   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010403   000000 701000 xent               TSX1    DDS$EUTREE
         2 010404   000000 011000                    NOP     0

     2047    21194    3                            S_D.TREE$ = S_D.UTREE$;

  21194  2 010405   000000 470400 xsym               LDP0    S_D$
         2 010406   004763 236100                    LDQ     2547,,PR0
         2 010407   004761 756100                    STQ     2545,,PR0

     2048    21195    3                            S_D.UNODE.USENODE = S_D.NODE;

  21195  2 010410   004706 235100                    LDA     2502,,PR0
         2 010411   004760 755100                    STA     2544,,PR0

     2049    21196    3                            I = S_D.B$TREE$ -> B$NODE.PADDR( S_D.NODE );

  21196  2 010412   004767 471500                    LDP1    2551,,PR0
         2 010413   004706 236100                    LDQ     2502,,PR0
         2 010414   000006 402007                    MPY     6,DL
         2 010415   100003 236106                    LDQ     3,QL,PR1
         2 010416   000022 772000                    QRL     18
         2 010417   200005 756100                    STQ     I,,AUTO

     2050    21197    3                            CALL DDS$ES_INQ (I); /* ignore altret */

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:325  
  21197  2 010420   200005 633500                    EPPR3   I,,AUTO
         2 010421   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 010422   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010423   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010424   000000 701000 xent               TSX1    DDS$ES_INQ
         2 010425   000000 011000                    NOP     0

     2051    21198    3                            CALL DDS$SET_Q2C;

  21198  2 010426   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010427   000000 701000 xent               TSX1    DDS$SET_Q2C
         2 010430   000000 011000                    NOP     0

     2052    21199    3                          END;

  21199  2 010431   011447 710000 2                  TRA     NOGO

     2053    21200    2                       ELSE IF S_D.ANLZ_FILE

  21200  2 010432   005052 234100                    SZN     2602,,PR0
         2 010433   010543 605000 2                  TPL     s:21215

     2054    21201    3                            THEN DO;

     2055    21202    3                                 LS# = S_D.DO$->USE$CMD.LS;

  21202  2 010434   100001 236100                    LDQ     1,,PR1
         2 010435   000011 772000                    QRL     9
         2 010436   000777 376007                    ANQ     511,DL
         2 010437   200011 756100                    STQ     LS#,,AUTO

     2056    21203    3                                 USR# = S_D.DO$->USE$CMD.USERNO;

  21203  2 010440   100002 235100                    LDA     2,,PR1
         2 010441   200010 755100                    STA     USR#,,AUTO

     2057    21204    3                                 CPU# = DA.CURCPU;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:326  

  21204  2 010442   000000 473400 xsym               LDP3    DD_ANLZSEG$
         2 010443   300035 235100                    LDA     29,,PR3
         2 010444   200012 755100                    STA     CPU#,,AUTO

     2058    21205    3                                 IF TYPE = 4 AND USR# = 0 THEN USR# = DA.CURUSR;

  21205  2 010445   200007 235100                    LDA     TYPE,,AUTO
         2 010446   000004 115007                    CMPA    4,DL
         2 010447   010454 601000 2                  TNZ     s:21206
         2 010450   200010 235100                    LDA     USR#,,AUTO
         2 010451   010454 601000 2                  TNZ     s:21206

  21205  2 010452   300034 235100                    LDA     28,,PR3
         2 010453   200010 755100                    STA     USR#,,AUTO

     2059    21206    3                                 IF TYPE = 5 OR TYPE = 0

  21206  2 010454   200007 235100                    LDA     TYPE,,AUTO
         2 010455   000005 115007                    CMPA    5,DL
         2 010456   010461 600000 2                  TZE     s:21207
         2 010457   000000 115003                    CMPA    0,DU
         2 010460   010525 601000 2                  TNZ     s:21213

     2060    21207    3                                 THEN IF TYPE = 0 AND S_D.DO$->USE$CMD.SUBTYPE = 7

  21207  2 010461   000000 115003                    CMPA    0,DU
         2 010462   010507 601000 2                  TNZ     s:21212
         2 010463   100001 236100                    LDQ     1,,PR1
         2 010464   777000 376007                    ANQ     -512,DL
         2 010465   007000 116007                    CMPQ    3584,DL
         2 010466   010507 601000 2                  TNZ     s:21212

     2061    21208    4                                      THEN DO;

     2062    21209    4                                           CPU# = S_D.DO$->USE$CMD.PTA;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:327  
  21209  2 010467   100002 235100                    LDA     2,,PR1
         2 010470   200012 755100                    STA     CPU#,,AUTO

     2063    21210    4                                           CALL DUL$USE (TYPE, DA.CURUSR, CPU#, 0)
             21210                                                    ALTRET(ERR);

  21210  2 010471   000001 236000 3                  LDQ     1
         2 010472   200545 756100                    STQ     @WHICH_ONE+4,,AUTO
         2 010473   200012 631500                    EPPR1   CPU#,,AUTO
         2 010474   200544 451500                    STP1    @WHICH_ONE+3,,AUTO
         2 010475   000000 236000 xsym               LDQ     DD_ANLZSEG$
         2 010476   000034 036003                    ADLQ    28,DU
         2 010477   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 010500   200007 634500                    EPPR4   TYPE,,AUTO
         2 010501   200542 454500                    STP4    @WHICH_ONE+1,,AUTO
         2 010502   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010503   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 010504   000000 701000 xent               TSX1    DUL$USE
         2 010505   011466 702000 2                  TSX2    ERR

     2064    21211    4                                         END;

  21211  2 010506   011447 710000 2                  TRA     NOGO

     2065    21212    3                                      ELSE CALL DUL$USE (0, DA.CURUSR, DA.CURCPU, 0)
             21212                                               ALTRET(ERR);

  21212  2 010507   000001 236000 3                  LDQ     1
         2 010510   200545 756100                    STQ     @WHICH_ONE+4,,AUTO
         2 010511   000000 236000 xsym               LDQ     DD_ANLZSEG$
         2 010512   000035 036003                    ADLQ    29,DU
         2 010513   200544 756100                    STQ     @WHICH_ONE+3,,AUTO
         2 010514   000000 236000 xsym               LDQ     DD_ANLZSEG$
         2 010515   000034 036003                    ADLQ    28,DU
         2 010516   000001 235000 3                  LDA     1
         2 010517   200542 757100                    STAQ    @WHICH_ONE+1,,AUTO
         2 010520   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:328  
         2 010521   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 010522   000000 701000 xent               TSX1    DUL$USE
         2 010523   011466 702000 2                  TSX2    ERR
         2 010524   011447 710000 2                  TRA     NOGO

     2066    21213    3                                ELSE CALL DUL$USE (TYPE, USR#, DA.CURCPU, LS#) ALTRET(
             21213                                          ERR);

  21213  2 010525   200011 634500                    EPPR4   LS#,,AUTO
         2 010526   200545 454500                    STP4    @WHICH_ONE+4,,AUTO
         2 010527   000000 236000 xsym               LDQ     DD_ANLZSEG$
         2 010530   000035 036003                    ADLQ    29,DU
         2 010531   200544 756100                    STQ     @WHICH_ONE+3,,AUTO
         2 010532   200010 631500                    EPPR1   USR#,,AUTO
         2 010533   200543 451500                    STP1    @WHICH_ONE+2,,AUTO
         2 010534   200007 635500                    EPPR5   TYPE,,AUTO
         2 010535   200542 455500                    STP5    @WHICH_ONE+1,,AUTO
         2 010536   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010537   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 010540   000000 701000 xent               TSX1    DUL$USE
         2 010541   011466 702000 2                  TSX2    ERR

     2067    21214    3                               END;        /* IF ANLZ_FILE */

  21214  2 010542   011447 710000 2                  TRA     NOGO

     2068    21215    2                            ELSE IF S_D.ANLZ

  21215  2 010543   004756 234100                    SZN     2542,,PR0
         2 010544   010550 605000 2                  TPL     s:21221

     2069    21216    3                                 THEN DO;

     2070    21217    3                                      S_D.ERROR = 503; /*E@NOTIMP*/

  21217  2 010545   000767 236007                    LDQ     503,DL
         2 010546   000013 756100                    STQ     11,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:329  

     2071    21218    3                                      GOTO ERR;

  21218  2 010547   011466 710000 2                  TRA     ERR

     2072    21219    3                                    END;
     2073    21220    2                                 ELSE      /* USE FOR USER DELTA */
     2074    21221    2                                      IF S_D.DO$ -> USE$CMD.HOST

  21221  2 010550   100003 234100                    SZN     3,,PR1
         2 010551   010564 605000 2                  TPL     s:21229

     2075    21222    3                                      THEN DO;

     2076    21223    3                                           IF NOT S_D.DEBUG_CMD

  21223  2 010552   004665 234100                    SZN     2485,,PR0
         2 010553   011447 604000 2                  TMI     NOGO

     2077    21224    4                                           THEN DO;

     2078    21225    4                                                CALL DFA$KILL_FPRG;

  21225  2 010554   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010555   000000 701000 xent               TSX1    DFA$KILL_FPRG
         2 010556   000000 011000                    NOP     0

     2079    21226    4                                                CALL DDR$REPORT(28/*R_STOP*/);

  21226  2 010557   000045 630400 3                  EPPR0   37
         2 010560   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010561   000000 701000 xent               TSX1    DDR$REPORT
         2 010562   000000 011000                    NOP     0

     2080    21227    4                                              END;

     2081    21228    3                                         END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:330  

  21228  2 010563   011447 710000 2                  TRA     NOGO

     2082    21229    2                                      ELSE IF S_D.DO$ -> USE$CMD.FPRG

  21229  2 010564   100003 236100                    LDQ     3,,PR1
         2 010565   200000 316003                    CANQ    65536,DU
         2 010566   011000 600000 2                  TZE     s:21284

     2083    21230    3                                           THEN DO;

     2084    21231    3                                                RES = S_D.DO$ -> USE$CMD.FPRG_RES;

  21231  2 010567   040100 100500                    MLR     fill='040'O
         2 010570   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         2 010571   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8

     2085    21232    3                                                IF S_D.FPRG_CONTEXT$ = ADDR(NIL)

  21232  2 010572   000076 236100                    LDQ     62,,PR0
         2 010573   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 010574   010600 601000 2                  TNZ     s:21237

     2086    21233    4                                                THEN DO;

     2087    21234    4                                                    S_D.ERROR = 319; /* E@NOFPRGUSE */

  21234  2 010575   000477 235007                    LDA     319,DL
         2 010576   000013 755100                    STA     11,,PR0

     2088    21235    4                                                     GOTO ERR;

  21235  2 010577   011466 710000 2                  TRA     ERR

     2089    21236    4                                                   END;
     2090    21237    3                                                TFPRG$ = S_D.FPRG_CONTEXT$;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:331  
  21237  2 010600   200041 756100                    STQ     TFPRG$,,AUTO

     2091    21238    4                                               DO WHILE (TFPRG$ -> FPRG$CONTEXT.RES ~=
             21238                                                         RES);

  21238  2 010601   200041 471500                    LDP1    TFPRG$,,AUTO
         2 010602   040100 106500                    CMPC    fill='040'O
         2 010603   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         2 010604   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8
         2 010605   010624 600000 2                  TZE     s:21246

     2092    21239    4                                                     TFPRG$ = TFPRG$ -> FPRG$CONTEXT.
             21239                                                              NEXT$;

  21239  2 010606   200041 470500                    LDP0    TFPRG$,,AUTO
         2 010607   000000 236100                    LDQ     0,,PR0
         2 010610   200041 756100                    STQ     TFPRG$,,AUTO

     2093    21240    4                                                     IF TFPRG$ = ADDR(NIL)

  21240  2 010611   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 010612   010617 601000 2                  TNZ     s:21245

     2094    21241    5                                                     THEN DO;

     2095    21242    5                                                          S_D.ERROR = 278;
             21242                                                                   /* E@NOFPRG */

  21242  2 010613   000426 235007                    LDA     278,DL
         2 010614   000000 470400 xsym               LDP0    S_D$
         2 010615   000013 755100                    STA     11,,PR0

     2096    21243    5                                                          GOTO ERR;

  21243  2 010616   011466 710000 2                  TRA     ERR

     2097    21244    5                                                        END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:332  
     2098    21245    4                                                   END;

  21245  2 010617   200041 470500                    LDP0    TFPRG$,,AUTO
         2 010620   040100 106500                    CMPC    fill='040'O
         2 010621   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         2 010622   200033 000010                    ADSC9   RES,,AUTO                cn=0,n=8
         2 010623   010606 601000 2                  TNZ     s:21239

     2099    21246    3                                                S_D.CURRENT_FPRG_CONTEXT$ =TFPRG$;

  21246  2 010624   000000 470400 xsym               LDP0    S_D$
         2 010625   000102 756100                    STQ     66,,PR0

     2100    21247    3                                                IF TFPRG$ -> FPRG$CONTEXT.READ_FD =
             21247                                                         '1'B

  21247  2 010626   200041 471500                    LDP1    TFPRG$,,AUTO
         2 010627   100001 234100                    SZN     1,,PR1
         2 010630   010656 604000 2                  TMI     DO_READ

     2101    21248    3                                                THEN GOTO DO_READ;
     2102    21249    3                                                IF TFPRG$ -> FPRG$CONTEXT.STATE ~= %
             21249                                                         STOPPED AND

  21249  2 010631   100001 236100                    LDQ     1,,PR1
         2 010632   000777 376003                    ANQ     511,DU
         2 010633   000002 116003                    CMPQ    2,DU
         2 010634   010761 600000 2                  TZE     s:21280
         2 010635   000004 116003                    CMPQ    4,DU
         2 010636   010761 600000 2                  TZE     s:21280

     2103    21250    3                                                  TFPRG$ -> FPRG$CONTEXT.STATE ~= %
             21250                                                           ATEXIT
     2104    21251    4                                                THEN DO;

     2105    21252    4                                                    S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# =
             21252                                                              '1'B;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:333  

  21252  2 010637   004704 473500                    LDP3    2500,,PR0
         2 010640   000020 236003                    LDQ     16,DU
         2 010641   300013 256100                    ORSQ    11,,PR3

     2106    21253    4                                                     S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB#
             21253                                                             = TFPRG$ -> FPRG$CONTEXT.DCBNO
             21253                                                              ;

  21253  2 010642   004704 471500                    LDP1    2500,,PR0
         2 010643   200041 473500                    LDP3    TFPRG$,,AUTO
         2 010644   300001 720100                    LXL0    1,,PR3
         2 010645   100014 440100                    SXL0    12,,PR1

     2107    21254    4                                                    CALL M$DRTN (S_D.DRTN$ -> FPT$DRTN
             21254                                                              ) ALTRET(ERR);

  21254  2 010646   004704 471500                    LDP1    2500,,PR0
         2 010647   100000 630500                    EPPR0   0,,PR1
         2 010650   410017 713400                    CLIMB   alt,+4111
         2 010651   402000 401760                    pmme    nvectors=5
         2 010652   011466 702000 2                  TSX2    ERR

     2108    21255    4                                                     TFPRG$ -> FPRG$CONTEXT.STATE = %
             21255                                                              STOPPED;

  21255  2 010653   200041 470500                    LDP0    TFPRG$,,AUTO
         2 010654   000002 236003                    LDQ     2,DU
         2 010655   000001 552120                    STBQ    1,'20'O,PR0

     2109    21256    4   DO_READ:
     2110    21257    4                                                    S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# =
             21257                                                              '0'B;

  21257  2 010656   000000 470400 xsym  DO_READ      LDP0    S_D$
         2 010657   004704 471500                    LDP1    2500,,PR0
         2 010660   000047 236000 3                  LDQ     39
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:334  
         2 010661   100013 356100                    ANSQ    11,,PR1

     2111    21258    4                                                     S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB#
             21258                                                              = 0;

  21258  2 010662   004704 471500                    LDP1    2500,,PR0
         2 010663   000000 220003                    LDX0    0,DU
         2 010664   100014 440100                    SXL0    12,,PR1

     2112    21259    4                                                     S_D.DRTN$ -> FPT$DRTN.FPRG_FID_ =
             21259                                                              VECTOR(NIL);

  21259  2 010665   004704 471500                    LDP1    2500,,PR0
         2 010666   000056 237000 3                  LDAQ    46
         2 010667   100010 757100                    STAQ    8,,PR1

     2113    21260    4                                                     IF TFPRG$ -> FPRG$CONTEXT.READ_FD
             21260                                                              = '1'B

  21260  2 010670   200041 471500                    LDP1    TFPRG$,,AUTO
         2 010671   100001 234100                    SZN     1,,PR1
         2 010672   010675 605000 2                  TPL     s:21262

     2114    21261    4                                                     THEN TFPRG$ -> FPRG$CONTEXT.
             21261                                                              READ_FD = '0'B;

  21261  2 010673   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 010674   100001 356100                    ANSQ    1,,PR1

     2115    21262    4                                                     CALL DFQ$READ_FD(TFPRG$, '0'B)
             21262                                                              ALTRET(ERR);

  21262  2 010675   000001 236000 3                  LDQ     1
         2 010676   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 010677   200041 631500                    EPPR1   TFPRG$,,AUTO
         2 010700   200542 451500                    STP1    @WHICH_ONE+1,,AUTO
         2 010701   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:335  
         2 010702   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 010703   000000 701000 xent               TSX1    DFQ$READ_FD
         2 010704   011466 702000 2                  TSX2    ERR

     2116    21263    4                                                    IF GD$MSG.FNC ~= %FPRG_BRKRSP# AND

  21263  2 010705   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 010706   000000 236100                    LDQ     0,,PR0
         2 010707   776000 376003                    ANQ     -1024,DU
         2 010710   132000 116003                    CMPQ    46080,DU
         2 010711   010742 600000 2                  TZE     NEVER
         2 010712   000002 236100                    LDQ     2,,PR0
         2 010713   000055 376000 3                  ANQ     45
         2 010714   000060 116000 3                  CMPQ    48
         2 010715   010742 600000 2                  TZE     NEVER

     2117    21264    4                                                       GD$MSG.BRKRSP.BRK# ~= (%
             21264                                                               G_HOST_INT# + (%GD#MAXBRKNUM
             21264                                                                + 1))
     2118    21265    5                                                     THEN DO;

     2119    21266    5                                                          IF TFPRG$ -> FPRG$CONTEXT.
             21266                                                                   XDELTA AND

  21266  2 010716   200041 471500                    LDP1    TFPRG$,,AUTO
         2 010717   100001 236100                    LDQ     1,,PR1
         2 010720   002000 316003                    CANQ    1024,DU
         2 010721   010732 600000 2                  TZE     s:21272
         2 010722   000000 236100                    LDQ     0,,PR0
         2 010723   776000 376003                    ANQ     -1024,DU
         2 010724   140000 116003                    CMPQ    49152,DU
         2 010725   010732 601000 2                  TNZ     s:21272

     2120    21267    5                                                            GD$MSG.FNC = %GD#RSPBADMSG
     2121    21268    6                                                          THEN DO;

     2122    21269    6                                                               S_D.ERROR = 330;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:336  
             21269                                                                        /* E@BADMSG */

  21269  2 010726   000512 235007                    LDA     330,DL
         2 010727   000000 473400 xsym               LDP3    S_D$
         2 010730   300013 755100                    STA     11,,PR3

     2123    21270    6                                                               GOTO ERR;

  21270  2 010731   011466 710000 2                  TRA     ERR

     2124    21271    6                                                             END;
     2125    21272    5                                                          REMEMBER NEVER IN S_D.
             21272                                                                   SCREECH_IC;

  21272  2 010732   010742 635000 2                  EAA     NEVER
         2 010733   000000 473400 xsym               LDP3    S_D$
         2 010734   305250 452500                    STP2    2728,,PR3
         2 010735   305251 755100                    STA     2729,,PR3

     2126    21273    5                                                         CALL M$SCREECH (SNAP_MESSAGE)
             21273                                                                   ALTRET(NEVER);

  21273  2 010736   000000 630400 xsym               EPPR0   SNAP_MESSAGE
         2 010737   400013 713400                    CLIMB   alt,+11
         2 010740   401000 401760                    pmme    nvectors=3
         2 010741   010742 702000 2                  TSX2    NEVER

  21268  2 010742                       NEVER        null
     2127    21274    5   NEVER:                                                 ;
     2128    21275    5                                                        END;

     2129    21276    4                                                     FPRG_IC = GD$MSG.BRKRSP.ADR$;

  21276  2 010742   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 010743   000000 235100                    LDA     0,,PR0
         2 010744   000001 236100                    LDQ     1,,PR0
         2 010745   000030 773000                    LRL     24
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:337  
         2 010746   000053 376000 3                  ANQ     43
         2 010747   200047 756100                    STQ     FPRG_IC,,AUTO

     2130    21277    4                                                    S_D.FAULT = GD$MSG.BRKRSP.BRK# - (
             21277                                                              %GD#MAXBRKNUM + 1);

  21277  2 010750   000002 236100                    LDQ     2,,PR0
         2 010751   000014 772000                    QRL     12
         2 010752   177777 376007                    ANQ     65535,DL
         2 010753   000025 136007                    SBLQ    21,DL
         2 010754   000000 471400 xsym               LDP1    S_D$
         2 010755   100030 756100                    STQ     24,,PR1

     2131    21278    4                                                     TFPRG$ -> FPRG$CONTEXT.ADDRESS =
             21278                                                              FPRG_IC;

  21278  2 010756   200041 473500                    LDP3    TFPRG$,,AUTO
         2 010757   200047 235100                    LDA     FPRG_IC,,AUTO
         2 010760   300005 755100                    STA     5,,PR3

     2132    21279    4                                                   END;

     2133    21280    3                                                CALL DDA$RESET_PATCH_SPACE;

  21280  2 010761   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 010762   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 010763   000000 011000                    NOP     0

     2134    21281    3                                                CALL DFA$FPRG(TFPRG$ -> FPRG$CONTEXT.
             21281                                                         ADDRESS);

  21281  2 010764   200041 236100                    LDQ     TFPRG$,,AUTO
         2 010765   000005 036003                    ADLQ    5,DU
         2 010766   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 010767   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 010770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010771   000000 701000 xent               TSX1    DFA$FPRG
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:338  
         2 010772   000000 011000                    NOP     0

     2135    21282    3                                                CALL DFR$REPORT(%R_FPRG_STOP);

  21282  2 010773   000061 630400 3                  EPPR0   49
         2 010774   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 010775   000000 701000 xent               TSX1    DFR$REPORT
         2 010776   000000 011000                    NOP     0

     2136    21283    3                                              END;

  21283  2 010777   011447 710000 2                  TRA     NOGO

     2137    21284    2                                           ELSE IF TYPE = 9 /* USE_SECTION */

  21284  2 011000   000011 115007                    CMPA    9,DL
         2 011001   011206 601000 2                  TNZ     s:21347

     2138    21285    3                                                THEN DO;

     2139    21286    3                                                     CALL RESTORE_USE;

  21286  2 011002   011711 701000 2                  TSX1    RESTORE_USE
         2 011003   000000 011000                    NOP     0

     2140    21287    3                                                     S_D.RUM_FEP_USE = S_D.DO$ ->
             21287                                                              USE$CMD.SECTION;

  21287  2 011004   000000 470400 xsym               LDP0    S_D$
         2 011005   000031 471500                    LDP1    25,,PR0
         2 011006   100002 235100                    LDA     2,,PR1
         2 011007   005275 755100                    STA     2749,,PR0

     2141    21288    3                                                     IF S_D.DO$ -> USE$CMD.SECTION = 0

  21288  2 011010   100002 235100                    LDA     2,,PR1
         2 011011   011057 600000 2                  TZE     MONIS
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:339  

     2142    21289    3                                                     THEN GOTO MONIS;
     2143    21290    4                                                    DO CASE(S_D.DO$ -> USE$CMD.SECTION
             21290                                                              );

  21290  2 011012   001166 135007                    SBLA    630,DL
         2 011013   000004 115007                    CMPA    4,DL
         2 011014   011016 602005 2                  TNC     s:21290+4,AL
         2 011015   011447 710000 2                  TRA     NOGO
         2 011016   011022 710000 2                  TRA     s:21292
         2 011017   011057 710000 2                  TRA     MONIS
         2 011020   011114 710000 2                  TRA     s:21319
         2 011021   011151 710000 2                  TRA     s:21332

     2144    21291    4                                                       CASE(630); /* C@MONENT */

     2145    21292    4                                                          S_D.GOT@ = S_D.MONENT.GOT@;

  21292  2 011022   007020 236100                    LDQ     3600,,PR0
         2 011023   400000 376003                    ANQ     -131072,DU
         2 011024   005054 756100                    STQ     2604,,PR0

     2146    21293    4                                                          S_D.DEFINED@ = S_D.MONENT.
             21293                                                                   DEFINED@;

  21293  2 011025   007025 236100                    LDQ     3605,,PR0
         2 011026   400000 376003                    ANQ     -131072,DU
         2 011027   005060 756100                    STQ     2608,,PR0

     2147    21294    4                                                         S_D.NEXT@ = S_D.MONENT.NEXT@;

  21294  2 011030   007021 235100                    LDA     3601,,PR0
         2 011031   005055 755100                    STA     2605,,PR0

     2148    21295    4                                                          S_D.RSPACE@ = S_D.MONENT.
             21295                                                                   RSPACE@;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:340  
  21295  2 011032   007022 235100                    LDA     3602,,PR0
         2 011033   005056 755100                    STA     2606,,PR0

     2149    21296    4                                                         S_D.HEAD@ = S_D.MONENT.HEAD@;

  21296  2 011034   007023 235100                    LDA     3603,,PR0
         2 011035   005057 755100                    STA     2607,,PR0

     2150    21297    4                                                         S_D.HIGH@ = S_D.MONENT.HIGH@;

  21297  2 011036   007024 235100                    LDA     3604,,PR0
         2 011037   005133 755100                    STA     2651,,PR0

     2151    21298    4                                                          S_D.GOT# = S_D.MONENT.GOT#;

  21298  2 011040   007026 236100                    LDQ     3606,,PR0
         2 011041   400000 376003                    ANQ     -131072,DU
         2 011042   005061 756100                    STQ     2609,,PR0

     2152    21299    4                                                          S_D.DEFINED# = S_D.MONENT.
             21299                                                                   DEFINED#;

  21299  2 011043   007033 236100                    LDQ     3611,,PR0
         2 011044   400000 376003                    ANQ     -131072,DU
         2 011045   005065 756100                    STQ     2613,,PR0

     2153    21300    4                                                         S_D.NEXT# = S_D.MONENT.NEXT#;

  21300  2 011046   007027 235100                    LDA     3607,,PR0
         2 011047   005062 755100                    STA     2610,,PR0

     2154    21301    4                                                          S_D.RSPACE# = S_D.MONENT.
             21301                                                                   RSPACE#;

  21301  2 011050   007030 235100                    LDA     3608,,PR0
         2 011051   005063 755100                    STA     2611,,PR0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:341  
     2155    21302    4                                                         S_D.HEAD# = S_D.MONENT.HEAD#;

  21302  2 011052   007031 235100                    LDA     3609,,PR0
         2 011053   005064 755100                    STA     2612,,PR0

     2156    21303    4                                                         S_D.HIGH# = S_D.MONENT.HIGH#;

  21303  2 011054   007032 235100                    LDA     3610,,PR0
         2 011055   005136 755100                    STA     2654,,PR0
         2 011056   011447 710000 2                  TRA     NOGO

     2157    21304    4                                                       CASE(631); /* C@MONIS */

  21303  2 011057                       MONIS        null
     2158    21305    4   MONIS:                                                 ;
     2159    21306    4                                                          S_D.GOT@ = S_D.MONIS.GOT@;

  21306  2 011057   007034 236100                    LDQ     3612,,PR0
         2 011060   400000 376003                    ANQ     -131072,DU
         2 011061   005054 756100                    STQ     2604,,PR0

     2160    21307    4                                                          S_D.DEFINED@ = S_D.MONIS.
             21307                                                                   DEFINED@;

  21307  2 011062   007041 236100                    LDQ     3617,,PR0
         2 011063   400000 376003                    ANQ     -131072,DU
         2 011064   005060 756100                    STQ     2608,,PR0

     2161    21308    4                                                          S_D.NEXT@ = S_D.MONIS.NEXT@;

  21308  2 011065   007035 235100                    LDA     3613,,PR0
         2 011066   005055 755100                    STA     2605,,PR0

     2162    21309    4                                                          S_D.RSPACE@ = S_D.MONIS.
             21309                                                                   RSPACE@;

  21309  2 011067   007036 235100                    LDA     3614,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:342  
         2 011070   005056 755100                    STA     2606,,PR0

     2163    21310    4                                                          S_D.HEAD@ = S_D.MONIS.HEAD@;

  21310  2 011071   007037 235100                    LDA     3615,,PR0
         2 011072   005057 755100                    STA     2607,,PR0

     2164    21311    4                                                          S_D.HIGH@ = S_D.MONIS.HIGH@;

  21311  2 011073   007040 235100                    LDA     3616,,PR0
         2 011074   005133 755100                    STA     2651,,PR0

     2165    21312    4                                                          S_D.GOT# = S_D.MONIS.GOT#;

  21312  2 011075   007042 236100                    LDQ     3618,,PR0
         2 011076   400000 376003                    ANQ     -131072,DU
         2 011077   005061 756100                    STQ     2609,,PR0

     2166    21313    4                                                          S_D.DEFINED# = S_D.MONIS.
             21313                                                                   DEFINED#;

  21313  2 011100   007047 236100                    LDQ     3623,,PR0
         2 011101   400000 376003                    ANQ     -131072,DU
         2 011102   005065 756100                    STQ     2613,,PR0

     2167    21314    4                                                          S_D.NEXT# = S_D.MONIS.NEXT#;

  21314  2 011103   007043 235100                    LDA     3619,,PR0
         2 011104   005062 755100                    STA     2610,,PR0

     2168    21315    4                                                          S_D.RSPACE# = S_D.MONIS.
             21315                                                                   RSPACE#;

  21315  2 011105   007044 235100                    LDA     3620,,PR0
         2 011106   005063 755100                    STA     2611,,PR0

     2169    21316    4                                                          S_D.HEAD# = S_D.MONIS.HEAD#;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:343  

  21316  2 011107   007045 235100                    LDA     3621,,PR0
         2 011110   005064 755100                    STA     2612,,PR0

     2170    21317    4                                                          S_D.HIGH# = S_D.MONIS.HIGH#;

  21317  2 011111   007046 235100                    LDA     3622,,PR0
         2 011112   005136 755100                    STA     2654,,PR0
         2 011113   011447 710000 2                  TRA     NOGO

     2171    21318    4                                                       CASE(632); /* C@FD */

     2172    21319    4                                                          S_D.GOT@ = S_D.FD.GOT@;

  21319  2 011114   007050 236100                    LDQ     3624,,PR0
         2 011115   400000 376003                    ANQ     -131072,DU
         2 011116   005054 756100                    STQ     2604,,PR0

     2173    21320    4                                                          S_D.DEFINED@ = S_D.FD.
             21320                                                                   DEFINED@;

  21320  2 011117   007055 236100                    LDQ     3629,,PR0
         2 011120   400000 376003                    ANQ     -131072,DU
         2 011121   005060 756100                    STQ     2608,,PR0

     2174    21321    4                                                          S_D.NEXT@ = S_D.FD.NEXT@;

  21321  2 011122   007051 235100                    LDA     3625,,PR0
         2 011123   005055 755100                    STA     2605,,PR0

     2175    21322    4                                                         S_D.RSPACE@ = S_D.FD.RSPACE@;

  21322  2 011124   007052 235100                    LDA     3626,,PR0
         2 011125   005056 755100                    STA     2606,,PR0

     2176    21323    4                                                          S_D.HEAD@ = S_D.FD.HEAD@;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:344  
  21323  2 011126   007053 235100                    LDA     3627,,PR0
         2 011127   005057 755100                    STA     2607,,PR0

     2177    21324    4                                                          S_D.HIGH@ = S_D.FD.HIGH@;

  21324  2 011130   007054 235100                    LDA     3628,,PR0
         2 011131   005133 755100                    STA     2651,,PR0

     2178    21325    4                                                          S_D.GOT# = S_D.FD.GOT#;

  21325  2 011132   007056 236100                    LDQ     3630,,PR0
         2 011133   400000 376003                    ANQ     -131072,DU
         2 011134   005061 756100                    STQ     2609,,PR0

     2179    21326    4                                                          S_D.DEFINED# = S_D.FD.
             21326                                                                   DEFINED#;

  21326  2 011135   007063 236100                    LDQ     3635,,PR0
         2 011136   400000 376003                    ANQ     -131072,DU
         2 011137   005065 756100                    STQ     2613,,PR0

     2180    21327    4                                                          S_D.NEXT# = S_D.FD.NEXT#;

  21327  2 011140   007057 235100                    LDA     3631,,PR0
         2 011141   005062 755100                    STA     2610,,PR0

     2181    21328    4                                                         S_D.RSPACE# = S_D.FD.RSPACE#;

  21328  2 011142   007060 235100                    LDA     3632,,PR0
         2 011143   005063 755100                    STA     2611,,PR0

     2182    21329    4                                                          S_D.HEAD# = S_D.FD.HEAD#;

  21329  2 011144   007061 235100                    LDA     3633,,PR0
         2 011145   005064 755100                    STA     2612,,PR0

     2183    21330    4                                                          S_D.HIGH# = S_D.FD.HIGH#;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:345  

  21330  2 011146   007062 235100                    LDA     3634,,PR0
         2 011147   005136 755100                    STA     2654,,PR0
         2 011150   011447 710000 2                  TRA     NOGO

     2184    21331    4                                                       CASE(633); /* C@BF */

     2185    21332    4                                                          S_D.GOT@ = S_D.BF.GOT@;

  21332  2 011151   007064 236100                    LDQ     3636,,PR0
         2 011152   400000 376003                    ANQ     -131072,DU
         2 011153   005054 756100                    STQ     2604,,PR0

     2186    21333    4                                                          S_D.DEFINED@ = S_D.BF.
             21333                                                                   DEFINED@;

  21333  2 011154   007071 236100                    LDQ     3641,,PR0
         2 011155   400000 376003                    ANQ     -131072,DU
         2 011156   005060 756100                    STQ     2608,,PR0

     2187    21334    4                                                          S_D.NEXT@ = S_D.BF.NEXT@;

  21334  2 011157   007065 235100                    LDA     3637,,PR0
         2 011160   005055 755100                    STA     2605,,PR0

     2188    21335    4                                                         S_D.RSPACE@ = S_D.BF.RSPACE@;

  21335  2 011161   007066 235100                    LDA     3638,,PR0
         2 011162   005056 755100                    STA     2606,,PR0

     2189    21336    4                                                          S_D.HEAD@ = S_D.BF.HEAD@;

  21336  2 011163   007067 235100                    LDA     3639,,PR0
         2 011164   005057 755100                    STA     2607,,PR0

     2190    21337    4                                                          S_D.HIGH@ = S_D.BF.HIGH@;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:346  
  21337  2 011165   007070 235100                    LDA     3640,,PR0
         2 011166   005133 755100                    STA     2651,,PR0

     2191    21338    4                                                          S_D.GOT# = S_D.BF.GOT#;

  21338  2 011167   007072 236100                    LDQ     3642,,PR0
         2 011170   400000 376003                    ANQ     -131072,DU
         2 011171   005061 756100                    STQ     2609,,PR0

     2192    21339    4                                                          S_D.DEFINED# = S_D.BF.
             21339                                                                   DEFINED#;

  21339  2 011172   007077 236100                    LDQ     3647,,PR0
         2 011173   400000 376003                    ANQ     -131072,DU
         2 011174   005065 756100                    STQ     2613,,PR0

     2193    21340    4                                                          S_D.NEXT# = S_D.BF.NEXT#;

  21340  2 011175   007073 235100                    LDA     3643,,PR0
         2 011176   005062 755100                    STA     2610,,PR0

     2194    21341    4                                                         S_D.RSPACE# = S_D.BF.RSPACE#;

  21341  2 011177   007074 235100                    LDA     3644,,PR0
         2 011200   005063 755100                    STA     2611,,PR0

     2195    21342    4                                                          S_D.HEAD# = S_D.BF.HEAD#;

  21342  2 011201   007075 235100                    LDA     3645,,PR0
         2 011202   005064 755100                    STA     2612,,PR0

     2196    21343    4                                                          S_D.HIGH# = S_D.BF.HIGH#;

  21343  2 011203   007076 235100                    LDA     3646,,PR0
         2 011204   005136 755100                    STA     2654,,PR0

     2197    21344    4                                                       END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:347  

     2198    21345    3                                                   END;

  21345  2 011205   011447 710000 2                  TRA     NOGO

     2199    21346    3                                                ELSE DO; /* Must be USE CURRENT */

     2200    21347    3                                                     S_D.TREE$ = S_D.MTREE$;

  21347  2 011206   004762 236100                    LDQ     2546,,PR0
         2 011207   004761 756100                    STQ     2545,,PR0

     2201    21348    3                                                     S_D.NODE = S_D.UNODE.CURRENT;

  21348  2 011210   004757 235100                    LDA     2543,,PR0
         2 011211   004706 755100                    STA     2502,,PR0

     2202    21349    3                                                     I = S_D.SAVEIC;

  21349  2 011212   000002 235100                    LDA     2,,PR0
         2 011213   200005 755100                    STA     I,,AUTO

     2203    21350    3                                                     CALL DDS$ES_INQ( I );
             21350                                                              /* Ignore altret */

  21350  2 011214   200005 633500                    EPPR3   I,,AUTO
         2 011215   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 011216   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 011217   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011220   000000 701000 xent               TSX1    DDS$ES_INQ
         2 011221   000000 011000                    NOP     0

     2204    21351    3                                                     CALL DDS$SET_Q2C;

  21351  2 011222   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011223   000000 701000 xent               TSX1    DDS$SET_Q2C
         2 011224   000000 011000                    NOP     0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:348  

     2205    21352    3                                                   END;

  21352  2 011225   011447 710000 2                  TRA     NOGO

     2206    21353    2          CASE(40);                    /* WAIT */

     2207    21354    2             IF S_D.FPRG_CONTEXT$ = ADDR(NIL)

  21354  2 011226   000076 236100                    LDQ     62,,PR0
         2 011227   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 011230   011234 601000 2                  TNZ     WAIT_SEARCH

     2208    21355    3             THEN DO;

     2209    21356    3                  S_D.ERROR = 277; /* E@NOFPRGSWAIT */

  21356  2 011231   000425 235007                    LDA     277,DL
         2 011232   000013 755100                    STA     11,,PR0

     2210    21357    3                  GOTO ERR;

  21357  2 011233   011466 710000 2                  TRA     ERR

     2211    21358    3                END;
     2212    21359    2   WAIT_SEARCH:
     2213    21360    2             FPTWAIT = FPT_WAIT;

  21360  2 011234   000100 100400       WAIT_SEARCH  MLR     fill='000'O
         2 011235   000076 000030 1                  ADSC9   FPT_WAIT                 cn=0,n=24
         2 011236   200172 000030                    ADSC9   FPTWAIT,,AUTO            cn=0,n=24

     2214    21361    2             FPTWAIT.V_ = VECTOR(FPTWAIT.V);

  21361  2 011237   000020 235000 3                  LDA     16
         2 011240   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 011241   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:349  
         2 011242   000176 036003                    ADLQ    126,DU
         2 011243   200172 757100                    STAQ    FPTWAIT,,AUTO

     2215    21362    2             TFPRG$ = S_D.FPRG_CONTEXT$;

  21362  2 011244   000000 470400 xsym               LDP0    S_D$
         2 011245   000076 236100                    LDQ     62,,PR0
         2 011246   200041 756100                    STQ     TFPRG$,,AUTO

     2216    21363    3             DO WHILE (TFPRG$ -> FPRG$CONTEXT.READ_FD = '0'B AND

  21363  2 011247   011261 710000 2                  TRA     s:21371

     2217    21364    3               TFPRG$ -> FPRG$CONTEXT.XDELTA = '0'B);
     2218    21365    3                  TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  21365  2 011250   200041 470500                    LDP0    TFPRG$,,AUTO
         2 011251   000000 236100                    LDQ     0,,PR0
         2 011252   200041 756100                    STQ     TFPRG$,,AUTO

     2219    21366    3                  IF TFPRG$ = ADDR(NIL)

  21366  2 011253   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 011254   011261 601000 2                  TNZ     s:21371

     2220    21367    4                  THEN DO;

     2221    21368    4                       CALL M$WAIT(FPTWAIT);

  21368  2 011255   200172 630500                    EPPR0   FPTWAIT,,AUTO
         2 011256   020006 713400                    CLIMB   8198
         2 011257   400400 401760                    pmme    nvectors=2

     2222    21369    4                       GOTO WAIT_SEARCH;

  21369  2 011260   011234 710000 2                  TRA     WAIT_SEARCH

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:350  
     2223    21370    4                     END;
     2224    21371    3                END;

  21371  2 011261   200041 470500                    LDP0    TFPRG$,,AUTO
         2 011262   000001 234100                    SZN     1,,PR0
         2 011263   011267 604000 2                  TMI     DO_EVENT
         2 011264   000001 236100                    LDQ     1,,PR0
         2 011265   002000 316003                    CANQ    1024,DU
         2 011266   011250 600000 2                  TZE     s:21365

  21365  2 011267                       DO_EVENT     null
     2225    21372    2   DO_EVENT: ;
     2226    21373    2             TFPRG$ -> FPRG$CONTEXT.READ_FD = '1'B;

  21373  2 011267   200041 470500                    LDP0    TFPRG$,,AUTO
         2 011270   400000 236003                    LDQ     -131072,DU
         2 011271   000001 256100                    ORSQ    1,,PR0

     2227    21374    2             S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;

  21374  2 011272   200041 236100                    LDQ     TFPRG$,,AUTO
         2 011273   000000 470400 xsym               LDP0    S_D$
         2 011274   000102 756100                    STQ     66,,PR0

     2228    21375    2             ALTRETURN;

  21375  2 011275   000000 702200 xent               TSX2  ! X66_AALT

     2229    21376    2          CASE(67);                    /* WHEN */

     2230    21377    2             S_D.ERROR = 502;         /* E@DELBUG */

  21377  2 011276   000766 235007                    LDA     502,DL
         2 011277   000013 755100                    STA     11,,PR0

     2231    21378    2             CALL DDE$ERROR;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:351  
  21378  2 011300   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011301   000000 701000 xent               TSX1    DDE$ERROR
         2 011302   000000 011000                    NOP     0
         2 011303   011447 710000 2                  TRA     NOGO

     2232    21379    2          CASE(9);                    /* C_XCON */

     2233    21380    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  21380  2 011304   006714 235100                    LDA     3532,,PR0
         2 011305   000002 115007                    CMPA    2,DL
         2 011306   011372 601000 2                  TNZ     s:21401

     2234    21381    3             THEN DO;

     2235    21382    3                  GD$MSG = '0'B;

  21382  2 011307   000000 473400 xsym               LDP3    S_D_L6_MESSAGE$
         2 011310   003100 060400                    CSL     bolr='003'O
         2 011311   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 011312   300000 004720                    BDSC    0,,PR3                   by=0,bit=0,n=2512

     2236    21383    3                  GD$MSG.FNC = %GD#RQSXCON;

  21383  2 011313   300000 236100                    LDQ     0,,PR3
         2 011314   000030 376000 3                  ANQ     24
         2 011315   050000 276003                    ORQ     20480,DU
         2 011316   300000 756100                    STQ     0,,PR3

     2237    21384    3                  CALL DFQ$WRITE_FD(S_D.CURRENT_FPRG_CONTEXT$) ALTRET(ERRMSG);

  21384  2 011317   000000 236000 xsym               LDQ     S_D$
         2 011320   000102 036003                    ADLQ    66,DU
         2 011321   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 011322   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 011323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011324   000000 701000 xent               TSX1    DFQ$WRITE_FD
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:352  
         2 011325   011552 702000 2                  TSX2    ERRMSG

     2238    21385    3                  FPTWAIT = FPT_WAIT;

  21385  2 011326   000100 100400                    MLR     fill='000'O
         2 011327   000076 000030 1                  ADSC9   FPT_WAIT                 cn=0,n=24
         2 011330   200172 000030                    ADSC9   FPTWAIT,,AUTO            cn=0,n=24

     2239    21386    3                  FPTWAIT.V_ = VECTOR(FPTWAIT.V);

  21386  2 011331   000020 235000 3                  LDA     16
         2 011332   200542 452500                    STP2    @WHICH_ONE+1,,AUTO
         2 011333   200542 236100                    LDQ     @WHICH_ONE+1,,AUTO
         2 011334   000176 036003                    ADLQ    126,DU
         2 011335   200172 757100                    STAQ    FPTWAIT,,AUTO

     2240    21387    3                  CALL M$WAIT(FPTWAIT);

  21387  2 011336   200172 630500                    EPPR0   FPTWAIT,,AUTO
         2 011337   020006 713400                    CLIMB   8198
         2 011340   400400 401760                    pmme    nvectors=2

     2241    21388    3                  CALL DFQ$READ_FD(S_D.CURRENT_FPRG_CONTEXT$, '1'B)

  21388  2 011341   000002 236000 3                  LDQ     2
         2 011342   200543 756100                    STQ     @WHICH_ONE+2,,AUTO
         2 011343   000000 236000 xsym               LDQ     S_D$
         2 011344   000102 036003                    ADLQ    66,DU
         2 011345   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 011346   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 011347   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 011350   000000 701000 xent               TSX1    DFQ$READ_FD
         2 011351   011353 702000 2                  TSX2    s:21390
         2 011352   011354 710000 2                  TRA     s:21392

     2242    21389    4                  WHENALTRETURN DO;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:353  
     2243    21390    4                       ALTRETURN;

  21390  2 011353   000000 702200 xent               TSX2  ! X66_AALT

     2244    21391    4                     END;
     2245    21392    3                  IF GD$MSG.FNC = %GD#RSPNOXCONCONTROL

  21392  2 011354   000000 470400 xsym               LDP0    S_D_L6_MESSAGE$
         2 011355   000000 236100                    LDQ     0,,PR0
         2 011356   776000 376003                    ANQ     -1024,DU
         2 011357   154000 116003                    CMPQ    55296,DU
         2 011360   011365 601000 2                  TNZ     s:21397

     2246    21393    4                  THEN DO;

     2247    21394    4                       S_D.ERROR = 92; /* E@NO_CONTROL */

  21394  2 011361   000134 235007                    LDA     92,DL
         2 011362   000000 471400 xsym               LDP1    S_D$
         2 011363   100013 755100                    STA     11,,PR1

     2248    21395    4                       GOTO ERR;

  21395  2 011364   011466 710000 2                  TRA     ERR

     2249    21396    4                     END;
     2250    21397    3                  S_D.STEP_L6 = '0'B;

  21397  2 011365   000000 471400 xsym               LDP1    S_D$
         2 011366   105274 450100                    STZ     2748,,PR1

     2251    21398    3                  UNWIND TO S_D.DO_MESSAGE;

  21398  2 011367   106770 237300                    LDAQ  ! 3576,,PR1
         2 011370   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 011371   000000 000200                    ZERO    0,128

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:354  
     2252    21399    3                END;
     2253    21400    3             ELSE DO;

     2254    21401    3                  IF S_D.ALIB

  21401  2 011372   005134 234100                    SZN     2652,,PR0
         2 011373   011377 605000 2                  TPL     s:21406

     2255    21402    4                  THEN DO;

     2256    21403    4                       S_D.ERROR = 269; /* E@CANTXCONALIB */

  21403  2 011374   000415 235007                    LDA     269,DL
         2 011375   000013 755100                    STA     11,,PR0

     2257    21404    4                       GOTO ERR;

  21404  2 011376   011466 710000 2                  TRA     ERR

     2258    21405    4                     END;
     2259    21406    3                  S_D.D$ = PINCRW(S_D.DO$, SIZEW(DOO));

  21406  2 011377   000031 236100                    LDQ     25,,PR0
         2 011400   000002 036003                    ADLQ    2,DU
         2 011401   000044 756100                    STQ     36,,PR0

     2260    21407    3                  CALL DDA$IF(NOGO_BIT) ALTRET(ERR);

  21407  2 011402   200004 633500                    EPPR3   NOGO_BIT,,AUTO
         2 011403   200542 453500                    STP3    @WHICH_ONE+1,,AUTO
         2 011404   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 011405   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011406   000000 701000 xent               TSX1    DDA$IF
         2 011407   011466 702000 2                  TSX2    ERR

     2261    21408    3                  IF NOGO_BIT THEN RETURN;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:355  
  21408  2 011410   200004 234100                    SZN     NOGO_BIT,,AUTO
         2 011411   011413 605000 2                  TPL     s:21409

  21408  2 011412   000000 702200 xent               TSX2  ! X66_ARET

     2262    21409    3                  S_D.DRTN$->FPT$DRTN.V.ECC# = 3; /* SIMULATE XCON */

  21409  2 011413   000000 470400 xsym               LDP0    S_D$
         2 011414   004704 471500                    LDP1    2500,,PR0
         2 011415   000003 220003                    LDX0    3,DU
         2 011416   100013 440100                    SXL0    11,,PR1

     2263    21410    3                  CALL DDA$GO ALTRET (NOXCON);

  21410  2 011417   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011420   000000 701000 xent               TSX1    DDA$GO
         2 011421   011457 702000 2                  TSX2    NOXCON

     2264    21411    3                  ALTRETURN;

  21411  2 011422   000000 702200 xent               TSX2  ! X66_AALT

     2265    21412    3                END;
     2266    21413    2          CASE(68);                     /* XEQ */

     2267    21414    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  21414  2 011423   006714 235100                    LDA     3532,,PR0
         2 011424   000002 115007                    CMPA    2,DL
         2 011425   011543 600000 2                  TZE     NOTIMPFPRG

     2268    21415    2             THEN GOTO NOTIMPFPRG;
     2269    21416    2             IF S_D.ALIB

  21416  2 011426   005134 234100                    SZN     2652,,PR0
         2 011427   011433 605000 2                  TPL     s:21421

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:356  
     2270    21417    3             THEN DO;

     2271    21418    3                  S_D.ERROR = 246; /* E@CANTXEQALIB */

  21418  2 011430   000366 235007                    LDA     246,DL
         2 011431   000013 755100                    STA     11,,PR0

     2272    21419    3                  GOTO ERR;

  21419  2 011432   011466 710000 2                  TRA     ERR

     2273    21420    3                END;
     2274    21421    2             S_D.D$ = PINCRW(S_D.DO$,SIZEW(XEQ$CMD));

  21421  2 011433   000031 236100                    LDQ     25,,PR0
         2 011434   000002 036003                    ADLQ    2,DU
         2 011435   000044 756100                    STQ     36,,PR0

     2275    21422    2             CALL DDA$XEQ ALTRET(ERR);

  21422  2 011436   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011437   000000 701000 xent               TSX1    DDA$XEQ
         2 011440   011466 702000 2                  TSX2    ERR

     2276    21423    2             ALTRETURN;

  21423  2 011441   000000 702200 xent               TSX2  ! X66_AALT

     2277    21424    2          CASE(ELSE);                      /* UNKNOWN COMMAND */

     2278    21425    2             S_D.ERROR = 502;         /* E@DELBUG */

  21425  2 011442   000766 235007                    LDA     502,DL
         2 011443   000013 755100                    STA     11,,PR0

     2279    21426    2             CALL DDE$ERROR;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:357  
  21426  2 011444   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011445   000000 701000 xent               TSX1    DDE$ERROR
         2 011446   000000 011000                    NOP     0

     2280    21427    2          END;

  21421  2 011447                       NOGO         null
     2281    21428                                                /**/
     2282    21429    1   NOGO: ;
     2283    21430    1        IF S_D.ERROR = 503            /* E@NOTIMP */

  21430  2 011447   000000 470400 xsym               LDP0    S_D$
         2 011450   000013 235100                    LDA     11,,PR0
         2 011451   000767 115007                    CMPA    503,DL
         2 011452   011456 601000 2                  TNZ     s:21432

     2284    21431    1        THEN CALL DDE$ERROR;

  21431  2 011453   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011454   000000 701000 xent               TSX1    DDE$ERROR
         2 011455   000000 011000                    NOP     0

     2285    21432    1        RETURN;

  21432  2 011456   000000 702200 xent               TSX2  ! X66_ARET

     2286    21433    1   NOXCON: S_D.DRTN$->FPT$DRTN.V.ECC# = 90; /* KEEP USER FROM ENTERING */

  21433  2 011457   000000 470400 xsym  NOXCON       LDP0    S_D$
         2 011460   004704 471500                    LDP1    2500,,PR0
         2 011461   000132 220003                    LDX0    90,DU
         2 011462   100013 440100                    SXL0    11,,PR1

     2287    21434                                           /* EXIT ROUTINE WHEN HE DOESN'T EXPECT IT */
     2288    21435    1        S_D.DRTN$->FPT$DRTN.V.SETECC# = '1'B;

  21435  2 011463   004704 471500                    LDP1    2500,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:358  
         2 011464   200000 236003                    LDQ     65536,DU
         2 011465   100013 256100                    ORSQ    11,,PR1

     2289    21436    1   ERR:
     2290    21437    1        IF S_D.DRTN$ ~= ADDR(NIL)

  21437  2 011466   000000 470400 xsym  ERR          LDP0    S_D$
         2 011467   004704 236100                    LDQ     2500,,PR0
         2 011470   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 011471   011503 600000 2                  TZE     s:21443

     2291    21438    2        THEN DO;

     2292    21439    2             S_D.DRTN$ -> FPT$DRTN.V.WAKE_FD# = '0'B;

  21439  2 011472   004704 471500                    LDP1    2500,,PR0
         2 011473   000047 236000 3                  LDQ     39
         2 011474   100013 356100                    ANSQ    11,,PR1

     2293    21440    2             S_D.DRTN$ -> FPT$DRTN.V.FPRG_DCB# = 0;

  21440  2 011475   004704 471500                    LDP1    2500,,PR0
         2 011476   000000 220003                    LDX0    0,DU
         2 011477   100014 440100                    SXL0    12,,PR1

     2294    21441    2             S_D.DRTN$ -> FPT$DRTN.FPRG_FID_ = VECTOR(NIL);

  21441  2 011500   004704 471500                    LDP1    2500,,PR0
         2 011501   000056 237000 3                  LDAQ    46
         2 011502   100010 757100                    STAQ    8,,PR1

     2295    21442    2           END;

     2296    21443    1        CALL DDE$ERROR;

  21443  2 011503   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011504   000000 701000 xent               TSX1    DDE$ERROR
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:359  
         2 011505   000000 011000                    NOP     0

  21443  2 011506                       ERR1         null
     2297    21444    1   ERR1: ;
     2298    21445    1        S_D.STOP = '1'B;         /* TELL ONE AND ALL THAT AN ATTACHEMENT FAILED */

  21445  2 011506   400000 236003                    LDQ     -131072,DU
         2 011507   000000 470400 xsym               LDP0    S_D$
         2 011510   000050 756100                    STQ     40,,PR0

     2299    21446    1        RETURN;

  21446  2 011511   000000 702200 xent               TSX2  ! X66_ARET

  21445  2 011512                       RECOVERY_IN* null
     2300    21447    1   RECOVERY_IN_PROGRESS: ;
     2301    21448    1        IF NOT S_D.DEBUG_CMD

  21448  2 011512   000000 470400 xsym               LDP0    S_D$
         2 011513   004665 234100                    SZN     2485,,PR0
         2 011514   011520 604000 2                  TMI     s:21450

     2302    21449    1        THEN CALL DDA$GO ALTRET(NOGO);     /* Reset break points and stuff */

  21449  2 011515   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011516   000000 701000 xent               TSX1    DDA$GO
         2 011517   011447 702000 2                  TSX2    NOGO

     2303    21450    1        ALTRETURN;                         /* Tell DDA$DELTA to keep on truck'n */

  21450  2 011520   000000 702200 xent               TSX2  ! X66_AALT

     2304    21451    1   SAD_OOPS:
     2305    21452    1        IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR# = %E$BADSAD /* E$BADSAD */

  21452  2 011521   000000 470400 xsym  SAD_OOPS     LDP0    B$TCB$
         2 011522   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:360  
         2 011523   100102 236100                    LDQ     66,,PR1
         2 011524   377770 376007                    ANQ     131064,DL
         2 011525   011570 116007                    CMPQ    4984,DL
         2 011526   011533 601000 2                  TNZ     s:21454

     2306    21453    1        THEN S_D.ERROR = 179;        /*E@BAD_SAD*/

  21453  2 011527   000263 235007                    LDA     179,DL
         2 011530   000000 473400 xsym               LDP3    S_D$
         2 011531   300013 755100                    STA     11,,PR3
         2 011532   011536 710000 2                  TRA     s:21455

     2307    21454    1        ELSE S_D.ERROR = 178;       /*E@CANT_SAD*/

  21454  2 011533   000262 235007                    LDA     178,DL
         2 011534   000000 473400 xsym               LDP3    S_D$
         2 011535   300013 755100                    STA     11,,PR3

     2308    21455    1        GOTO ERR;

  21455  2 011536   011466 710000 2                  TRA     ERR

  21452  2 011537                       FPRG_ERR     null
     2309    21456    1   FPRG_ERR: ;
     2310    21457    1        S_D.ERROR = 502;

  21457  2 011537   000766 235007                    LDA     502,DL
         2 011540   000000 470400 xsym               LDP0    S_D$
         2 011541   000013 755100                    STA     11,,PR0

     2311    21458    1        GOTO ERR;

  21458  2 011542   011466 710000 2                  TRA     ERR

  21457  2 011543                       NOTIMPFPRG   null
     2312    21459    1   NOTIMPFPRG: ;
     2313    21460    1        S_D.ERROR = 331;       /* E@CMDNOTSUPPORT */
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:361  

  21460  2 011543   000513 235007                    LDA     331,DL
         2 011544   000013 755100                    STA     11,,PR0

     2314    21461    1        GOTO ERR;

  21461  2 011545   011466 710000 2                  TRA     ERR

  21460  2 011546                       NORELS_D     null
     2315    21462    1   NORELS_D: ;
     2316    21463    1        S_D.ERROR = 516;              /* E@RELS_D */

  21463  2 011546   001004 235007                    LDA     516,DL
         2 011547   000000 470400 xsym               LDP0    S_D$
         2 011550   000013 755100                    STA     11,,PR0

     2317    21464    1        GOTO ERR;

  21464  2 011551   011466 710000 2                  TRA     ERR

     2318    21465    1   ERRMSG:
     2319    21466    1        CALL DUE$ERRMSG;

  21466  2 011552   000002 631400 xsym  ERRMSG       EPPR1   B_VECTNIL+2
         2 011553   000000 701000 xent               TSX1    DUE$ERRMSG
         2 011554   000000 011000                    NOP     0

     2320    21467    1        RETURN;

  21467  2 011555   000000 702200 xent               TSX2  ! X66_ARET

     2321    21468        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:362  
     2322    21469    1   SETDCTX: PROC( WHICH_ONE );

  21469  2 011556   200540 741300       SETDCTX      STX1  ! MSG$+2,,AUTO

     2323    21470                                                /**/
     2324    21471    2   DCL WHICH_ONE UBIN;
     2325    21472                                                /**/
     2326    21473    3        DO CASE( S_D.DO$->DOO.ID );

  21473  2 011557   000000 470400 xsym               LDP0    S_D$
         2 011560   000031 471500                    LDP1    25,,PR0
         2 011561   100001 236100                    LDQ     1,,PR1
         2 011562   000022 772000                    QRL     18
         2 011563   001003 136007                    SBLQ    515,DL
         2 011564   000006 116007                    CMPQ    6,DL
         2 011565   011567 602006 2                  TNC     s:21473+8,QL
         2 011566   011632 710000 2                  TRA     s:21490
         2 011567   011575 710000 2                  TRA     s:21475
         2 011570   011601 710000 2                  TRA     s:21477
         2 011571   011605 710000 2                  TRA     s:21479
         2 011572   011617 710000 2                  TRA     s:21483
         2 011573   011623 710000 2                  TRA     s:21485
         2 011574   011627 710000 2                  TRA     s:21487

     2327    21474    3          CASE ( 515 );                   /* C@NO */

     2328    21475    3             WHICH_ONE = DCTX_NO;

  21475  2 011575   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011576   000000 235000 xsym               LDA     DCTX_NO
         2 011577   300000 755100                    STA     0,,PR3
         2 011600   011632 710000 2                  TRA     s:21490

     2329    21476    3          CASE ( 516 );                   /* C@ME */

     2330    21477    3             WHICH_ONE = DCTX_ME;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:363  
  21477  2 011601   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011602   000000 235000 xsym               LDA     DCTX_ME
         2 011603   300000 755100                    STA     0,,PR3
         2 011604   011632 710000 2                  TRA     s:21490

     2331    21478    3          CASE ( 517 );                   /* C@CR */

     2332    21479    3             IF S_D.PATCH

  21479  2 011605   004754 234100                    SZN     2540,,PR0
         2 011606   011613 605000 2                  TPL     s:21481

     2333    21480    3             THEN WHICH_ONE = DCTX_PATCH;

  21480  2 011607   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011610   000000 235000 xsym               LDA     DCTX_PATCH
         2 011611   300000 755100                    STA     0,,PR3
         2 011612   011632 710000 2                  TRA     s:21490

     2334    21481    3             ELSE WHICH_ONE = DCTX_CR;

  21481  2 011613   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011614   000000 235000 xsym               LDA     DCTX_CR
         2 011615   300000 755100                    STA     0,,PR3
         2 011616   011632 710000 2                  TRA     s:21490

     2335    21482    3          CASE ( 518 );                 /* C@TAPE - MT */

     2336    21483    3             WHICH_ONE = DCTX_MT;

  21483  2 011617   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011620   000000 235000 xsym               LDA     DCTX_MT
         2 011621   300000 755100                    STA     0,,PR3
         2 011622   011632 710000 2                  TRA     s:21490

     2337    21484    3          CASE ( 519 );                   /* C@LP */

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:364  
     2338    21485    3             WHICH_ONE = DCTX_LP;

  21485  2 011623   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011624   000000 235000 xsym               LDA     DCTX_LP
         2 011625   300000 755100                    STA     0,,PR3
         2 011626   011632 710000 2                  TRA     s:21490

     2339    21486    3          CASE ( 520 );                /* C@PATCH */

     2340    21487    3             WHICH_ONE = DCTX_PATCH;

  21487  2 011627   200541 473500                    LDP3    @WHICH_ONE,,AUTO
         2 011630   000000 235000 xsym               LDA     DCTX_PATCH
         2 011631   300000 755100                    STA     0,,PR3

     2341    21488    3          END;

     2342    21489                                                /**/
     2343    21490    2        RETURN;

  21490  2 011632   200540 221300                    LDX1  ! MSG$+2,,AUTO
         2 011633   000001 702211                    TSX2  ! 1,X1

     2344    21491                                                /**/
     2345    21492    2   END SETDCTX;
     2346    21493                                                /**/
     2347    21494        %EJECT;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:365  
     2348    21495    1   REPORT_STOPPED: PROC;

  21495  2 011634   200540 741300       REPORT_STOP* STX1  ! MSG$+2,,AUTO

     2349    21496                                                /**/
     2350    21497                                                /* Report status of all stopped FPRGs */
     2351    21498    2        TFPRG$ = S_D.FPRG_CONTEXT$;

  21498  2 011635   000000 470400 xsym               LDP0    S_D$
         2 011636   000076 236100                    LDQ     62,,PR0
         2 011637   200041 756100                    STQ     TFPRG$,,AUTO

     2352    21499    3        DO WHILE (TFPRG$ ~= ADDR(NIL));

  21499  2 011640   011705 710000 2                  TRA     s:21511

     2353    21500    3             IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED OR

  21500  2 011641   200041 470500                    LDP0    TFPRG$,,AUTO
         2 011642   000001 236100                    LDQ     1,,PR0
         2 011643   000777 376003                    ANQ     511,DU
         2 011644   000002 116003                    CMPQ    2,DU
         2 011645   011650 600000 2                  TZE     s:21503
         2 011646   000004 116003                    CMPQ    4,DU
         2 011647   011702 601000 2                  TNZ     s:21510

     2354    21501    3               TFPRG$ -> FPRG$CONTEXT.STATE = %ATEXIT
     2355    21502    4             THEN DO;

     2356    21503    4                  S_D.CURRENT_FPRG_CONTEXT$ = TFPRG$;

  21503  2 011650   200041 236100                    LDQ     TFPRG$,,AUTO
         2 011651   000000 471400 xsym               LDP1    S_D$
         2 011652   100102 756100                    STQ     66,,PR1

     2357    21504    4                  CALL DFA$FPRG(TFPRG$ -> FPRG$CONTEXT.ADDRESS);

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:366  
  21504  2 011653   000005 036003                    ADLQ    5,DU
         2 011654   200542 756100                    STQ     @WHICH_ONE+1,,AUTO
         2 011655   200542 630500                    EPPR0   @WHICH_ONE+1,,AUTO
         2 011656   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011657   000000 701000 xent               TSX1    DFA$FPRG
         2 011660   000000 011000                    NOP     0

     2358    21505    4                  IF TFPRG$ -> FPRG$CONTEXT.STATE = %STOPPED

  21505  2 011661   200041 470500                    LDP0    TFPRG$,,AUTO
         2 011662   000001 236100                    LDQ     1,,PR0
         2 011663   000777 376003                    ANQ     511,DU
         2 011664   000002 116003                    CMPQ    2,DU
         2 011665   011673 601000 2                  TNZ     s:21507

     2359    21506    4                  THEN CALL DFR$REPORT(%R_FPRG_STOP);

  21506  2 011666   000061 630400 3                  EPPR0   49
         2 011667   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011670   000000 701000 xent               TSX1    DFR$REPORT
         2 011671   000000 011000                    NOP     0
         2 011672   011677 710000 2                  TRA     s:21508

     2360    21507    4                  ELSE CALL DFR$REPORT(%R_FPRG_ATEXIT);

  21507  2 011673   000062 630400 3                  EPPR0   50
         2 011674   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 011675   000000 701000 xent               TSX1    DFR$REPORT
         2 011676   000000 011000                    NOP     0

     2361    21508    4                  CALL DFA$KILL_FPRG;

  21508  2 011677   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 011700   000000 701000 xent               TSX1    DFA$KILL_FPRG
         2 011701   000000 011000                    NOP     0

     2362    21509    4                END;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:367  

     2363    21510    3             TFPRG$ = TFPRG$ -> FPRG$CONTEXT.NEXT$;

  21510  2 011702   200041 470500                    LDP0    TFPRG$,,AUTO
         2 011703   000000 236100                    LDQ     0,,PR0
         2 011704   200041 756100                    STQ     TFPRG$,,AUTO

     2364    21511    3           END;

  21511  2 011705   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 011706   011641 601000 2                  TNZ     s:21500

     2365    21512                                                /**/
     2366    21513    2   END REPORT_STOPPED;

  21513  2 011707   200540 221300                    LDX1  ! MSG$+2,,AUTO
         2 011710   000001 702211                    TSX2  ! 1,X1

     2367    21514                                                /**/
     2368    21515    1   RESTORE_USE: PROC;

  21515  2 011711   200540 741300       RESTORE_USE  STX1  ! MSG$+2,,AUTO

     2369    21516
     2370    21517    2        IF S_D.RUM_FEP_USE = 0

  21517  2 011712   000000 470400 xsym               LDP0    S_D$
         2 011713   005275 235100                    LDA     2749,,PR0
         2 011714   011754 600000 2                  TZE     MONIS

     2371    21518    2        THEN GOTO MONIS;
     2372    21519    3        DO CASE(S_D.RUM_FEP_USE);

  21519  2 011715   001166 135007                    SBLA    630,DL
         2 011716   000004 115007                    CMPA    4,DL
         2 011717   011721 602005 2                  TNC     s:21519+4,AL
         2 011720   012060 710000 2                  TRA     s:21566
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:368  
         2 011721   011725 710000 2                  TRA     s:21521
         2 011722   011754 710000 2                  TRA     MONIS
         2 011723   012003 710000 2                  TRA     s:21544
         2 011724   012032 710000 2                  TRA     s:21555

     2373    21520    3          CASE(630);                  /* C@MONENT */

     2374    21521    3             S_D.MONENT.GOT@ = S_D.GOT@;

  21521  2 011725   005054 236100                    LDQ     2604,,PR0
         2 011726   400000 376003                    ANQ     -131072,DU
         2 011727   007020 756100                    STQ     3600,,PR0

     2375    21522    3             S_D.MONENT.NEXT@ = S_D.NEXT@;

  21522  2 011730   005055 235100                    LDA     2605,,PR0
         2 011731   007021 755100                    STA     3601,,PR0

     2376    21523    3             S_D.MONENT.RSPACE@ = S_D.RSPACE@;

  21523  2 011732   005056 235100                    LDA     2606,,PR0
         2 011733   007022 755100                    STA     3602,,PR0

     2377    21524    3             S_D.MONENT.HEAD@ = S_D.HEAD@;

  21524  2 011734   005057 235100                    LDA     2607,,PR0
         2 011735   007023 755100                    STA     3603,,PR0

     2378    21525    3             S_D.MONENT.HIGH@ = S_D.HIGH@;

  21525  2 011736   005133 235100                    LDA     2651,,PR0
         2 011737   007024 755100                    STA     3604,,PR0

     2379    21526    3             S_D.MONENT.GOT# = S_D.GOT#;

  21526  2 011740   005061 236100                    LDQ     2609,,PR0
         2 011741   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:369  
         2 011742   007026 756100                    STQ     3606,,PR0

     2380    21527    3             S_D.MONENT.NEXT# = S_D.NEXT#;

  21527  2 011743   005062 235100                    LDA     2610,,PR0
         2 011744   007027 755100                    STA     3607,,PR0

     2381    21528    3             S_D.MONENT.RSPACE# = S_D.RSPACE#;

  21528  2 011745   005063 235100                    LDA     2611,,PR0
         2 011746   007030 755100                    STA     3608,,PR0

     2382    21529    3             S_D.MONENT.HEAD# = S_D.HEAD#;

  21529  2 011747   005064 235100                    LDA     2612,,PR0
         2 011750   007031 755100                    STA     3609,,PR0

     2383    21530    3             S_D.MONENT.HIGH# = S_D.HIGH#;

  21530  2 011751   005136 235100                    LDA     2654,,PR0
         2 011752   007032 755100                    STA     3610,,PR0
         2 011753   012060 710000 2                  TRA     s:21566

     2384    21531    3          CASE(631);                   /* C@MONENT */

  21530  2 011754                       MONIS        null
     2385    21532    3   MONIS:    ;
     2386    21533    3             S_D.MONIS.GOT@ = S_D.GOT@;

  21533  2 011754   005054 236100                    LDQ     2604,,PR0
         2 011755   400000 376003                    ANQ     -131072,DU
         2 011756   007034 756100                    STQ     3612,,PR0

     2387    21534    3             S_D.MONIS.NEXT@ = S_D.NEXT@;

  21534  2 011757   005055 235100                    LDA     2605,,PR0
         2 011760   007035 755100                    STA     3613,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:370  

     2388    21535    3             S_D.MONIS.RSPACE@ = S_D.RSPACE@;

  21535  2 011761   005056 235100                    LDA     2606,,PR0
         2 011762   007036 755100                    STA     3614,,PR0

     2389    21536    3             S_D.MONIS.HEAD@ = S_D.HEAD@;

  21536  2 011763   005057 235100                    LDA     2607,,PR0
         2 011764   007037 755100                    STA     3615,,PR0

     2390    21537    3             S_D.MONIS.HIGH@ = S_D.HIGH@;

  21537  2 011765   005133 235100                    LDA     2651,,PR0
         2 011766   007040 755100                    STA     3616,,PR0

     2391    21538    3             S_D.MONIS.GOT# = S_D.GOT#;

  21538  2 011767   005061 236100                    LDQ     2609,,PR0
         2 011770   400000 376003                    ANQ     -131072,DU
         2 011771   007042 756100                    STQ     3618,,PR0

     2392    21539    3             S_D.MONIS.NEXT# = S_D.NEXT#;

  21539  2 011772   005062 235100                    LDA     2610,,PR0
         2 011773   007043 755100                    STA     3619,,PR0

     2393    21540    3             S_D.MONIS.RSPACE# = S_D.RSPACE#;

  21540  2 011774   005063 235100                    LDA     2611,,PR0
         2 011775   007044 755100                    STA     3620,,PR0

     2394    21541    3             S_D.MONIS.HEAD# = S_D.HEAD#;

  21541  2 011776   005064 235100                    LDA     2612,,PR0
         2 011777   007045 755100                    STA     3621,,PR0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:371  
     2395    21542    3             S_D.MONIS.HIGH# = S_D.HIGH#;

  21542  2 012000   005136 235100                    LDA     2654,,PR0
         2 012001   007046 755100                    STA     3622,,PR0
         2 012002   012060 710000 2                  TRA     s:21566

     2396    21543    3          CASE(632);                      /* C@MONENT */

     2397    21544    3             S_D.FD.GOT@ = S_D.GOT@;

  21544  2 012003   005054 236100                    LDQ     2604,,PR0
         2 012004   400000 376003                    ANQ     -131072,DU
         2 012005   007050 756100                    STQ     3624,,PR0

     2398    21545    3             S_D.FD.NEXT@ = S_D.NEXT@;

  21545  2 012006   005055 235100                    LDA     2605,,PR0
         2 012007   007051 755100                    STA     3625,,PR0

     2399    21546    3             S_D.FD.RSPACE@ = S_D.RSPACE@;

  21546  2 012010   005056 235100                    LDA     2606,,PR0
         2 012011   007052 755100                    STA     3626,,PR0

     2400    21547    3             S_D.FD.HEAD@ = S_D.HEAD@;

  21547  2 012012   005057 235100                    LDA     2607,,PR0
         2 012013   007053 755100                    STA     3627,,PR0

     2401    21548    3             S_D.FD.HIGH@ = S_D.HIGH@;

  21548  2 012014   005133 235100                    LDA     2651,,PR0
         2 012015   007054 755100                    STA     3628,,PR0

     2402    21549    3             S_D.FD.GOT# = S_D.GOT#;

  21549  2 012016   005061 236100                    LDQ     2609,,PR0
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:372  
         2 012017   400000 376003                    ANQ     -131072,DU
         2 012020   007056 756100                    STQ     3630,,PR0

     2403    21550    3             S_D.FD.NEXT# = S_D.NEXT#;

  21550  2 012021   005062 235100                    LDA     2610,,PR0
         2 012022   007057 755100                    STA     3631,,PR0

     2404    21551    3             S_D.FD.RSPACE# = S_D.RSPACE#;

  21551  2 012023   005063 235100                    LDA     2611,,PR0
         2 012024   007060 755100                    STA     3632,,PR0

     2405    21552    3             S_D.FD.HEAD# = S_D.HEAD#;

  21552  2 012025   005064 235100                    LDA     2612,,PR0
         2 012026   007061 755100                    STA     3633,,PR0

     2406    21553    3             S_D.FD.HIGH# = S_D.HIGH#;

  21553  2 012027   005136 235100                    LDA     2654,,PR0
         2 012030   007062 755100                    STA     3634,,PR0
         2 012031   012060 710000 2                  TRA     s:21566

     2407    21554    3          CASE(633);                      /* C@MONENT */

     2408    21555    3             S_D.BF.GOT@ = S_D.GOT@;

  21555  2 012032   005054 236100                    LDQ     2604,,PR0
         2 012033   400000 376003                    ANQ     -131072,DU
         2 012034   007064 756100                    STQ     3636,,PR0

     2409    21556    3             S_D.BF.NEXT@ = S_D.NEXT@;

  21556  2 012035   005055 235100                    LDA     2605,,PR0
         2 012036   007065 755100                    STA     3637,,PR0

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:373  
     2410    21557    3             S_D.BF.RSPACE@ = S_D.RSPACE@;

  21557  2 012037   005056 235100                    LDA     2606,,PR0
         2 012040   007066 755100                    STA     3638,,PR0

     2411    21558    3             S_D.BF.HEAD@ = S_D.HEAD@;

  21558  2 012041   005057 235100                    LDA     2607,,PR0
         2 012042   007067 755100                    STA     3639,,PR0

     2412    21559    3             S_D.BF.HIGH@ = S_D.HIGH@;

  21559  2 012043   005133 235100                    LDA     2651,,PR0
         2 012044   007070 755100                    STA     3640,,PR0

     2413    21560    3             S_D.BF.GOT# = S_D.GOT#;

  21560  2 012045   005061 236100                    LDQ     2609,,PR0
         2 012046   400000 376003                    ANQ     -131072,DU
         2 012047   007072 756100                    STQ     3642,,PR0

     2414    21561    3             S_D.BF.NEXT# = S_D.NEXT#;

  21561  2 012050   005062 235100                    LDA     2610,,PR0
         2 012051   007073 755100                    STA     3643,,PR0

     2415    21562    3             S_D.BF.RSPACE# = S_D.RSPACE#;

  21562  2 012052   005063 235100                    LDA     2611,,PR0
         2 012053   007074 755100                    STA     3644,,PR0

     2416    21563    3             S_D.BF.HEAD# = S_D.HEAD#;

  21563  2 012054   005064 235100                    LDA     2612,,PR0
         2 012055   007075 755100                    STA     3645,,PR0

     2417    21564    3             S_D.BF.HIGH# = S_D.HIGH#;
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:374  

  21564  2 012056   005136 235100                    LDA     2654,,PR0
         2 012057   007076 755100                    STA     3646,,PR0

     2418    21565    3          END;

     2419    21566    2   END RESTORE_USE;

  21566  2 012060   000001 702211                    TSX2  ! 1,X1

FPT_OPEN
 Sect OctLoc
   1     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     044*  000000 000042   000000 002000   252525 000000   000040 252520    ..."......... ..
   1     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     060   255000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     070   000000 000000   ****** ******                                    ........

VLP_MONNAME
 Sect OctLoc
   1     072   005115 072106   105120 ******                                    .M:FEP..

VLP_SYSACCT
 Sect OctLoc
   1     074   072123 131123   040040 040040                                    :SYS

FPT_WAIT
 Sect OctLoc
   1     076   000001 777640   000102 006000   000000 177640   000000 006014    .....B..........
   1     102   000000 000002   000000 000001                                    ........

FPT_FID
 Sect OctLoc
   1     104   000003 777640   000130 006000   000000 177640   000000 006014    .....X..........
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:375  
   1     110   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     130*  777000 000000   000000 000000   000000 000000   ****** ******    ................

FPT_SAD
 Sect OctLoc
   1     134   000001 777640   000136 006000   000000 000000   ****** ******    .....^..........

FPT_UNSHARE
 Sect OctLoc
   1     140   000001 777640   000142 006000   000000 000000   000000 000000    .....b..........

FPT_SSC
 Sect OctLoc
   1     144   000001 777640   000146 006000   000000 000000   000000 000000    .....f..........

FPT_CLOSE_DBG
 Sect OctLoc
   1     150   000003 777640   000202 006000   000000 177640   000000 006014    ................
   1     154   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     200*  000000 177640   000000 006014   000000 000000   000000 000040    ...............
   1     204   000220 000000   000000 000000                                    ........

FPT_OPEN_DBG
 Sect OctLoc
   1     206   000025 777640   000252 006000   000000 177640   000000 006014    ................
   1     212   000000 177640   000000 006014   000001 177640   000430 006000    ................
   1     216   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     232*  000001 777640   000432 006000   000000 177640   000000 006014    ................
   1     236   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     252*  000000 400112   000000 001004   252525 000000   000040 252520    ...J......... ..
   1     256   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     262   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     266   255000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     272   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     276   000000 000000   ****** ******                                    ........

FPT_OPEN_FANLZ
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:376  
 Sect OctLoc
   1     300   000025 777640   000344 006000   000000 177640   000000 006014    ................
   1     304   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     344*  000000 400042   000000 003003   252525 012000   000040 252520    ..."......... ..
   1     350   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     354   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     360   255000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     364   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     370   000000 000000   ****** ******                                    ........

FPT_SETFP
 Sect OctLoc
   1     372   000003 777640   000402 006000   000000 177640   000000 006014    ................
   1     376   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     402   000000 400000   000000 000000   000000 000000   000000 000000    ................

HANDLER_FPRG
 Sect OctLoc
   1     406   000000 040040   040040 040040   012104 105114   124101 137106    ..      .DELTA_F
   1     412   120122 107040   040040 040040   040040 040040   040040 040040    PRG
   1     416   040040 040040   040040 040040   072123 131123   040040 040040            :SYS
   1     422   040040 040040   040040 040040   001040 040040   040040 040040            .
   1     426   040040 040040

DBG_NAME
 Sect OctLoc
   1     430   004106 105103   107*** ******                                    .FECG...

DBG_ACCT
 Sect OctLoc
   1     432   072123 131123   040040 040040                                    :SYS

FPT_READ_DBG
 Sect OctLoc
   1     434   000005 777640   000444 006000   000000 177640   000000 006014    ................
   1     440   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     444   000000 400000   000000 000000   000000 000000   020000 000000    ................
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:377  
   1     450   000000 000000   000000 000000                                    ........

FPT_WRITE_DBG
 Sect OctLoc
   1     452   000003 777640   000462 006000   000000 177640   000000 006014    ................
   1     456   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     462   000000 400400   000000 000000   000000 000000   020000 000000    ................

FROG_STATION
 Sect OctLoc
   1     466   106122 117107   040040 040040   040040 040040   040040 040040    FROG
   1     472   001000 000000   000000 000000   000000 000000   000000 000000    ................

TRM_DBG
 Sect OctLoc
   1     476   000001 777640   000504 006000   000000 177640   000000 006014    ................
   1     502   000011 777640   000506 006000   000000 000000   000000 000000    ................

VLP_TRMATTR
 Sect OctLoc
   1     506   125125 125125   120125 125377   377377 377137   040040 040040    UUUUPUU...._
   1     512   040040 040040   040040 040040   040040 040040   377377 177377                ....
   1     516   377377 377377   377377 377377                                    ........

FPT_EOM_DBG
 Sect OctLoc
   1     520   000003 777640   000526 006000   000000 177640   000000 006014    ................
   1     524   000007 777640   000532 006000   000000 000000   000000 000000    ................
   1     530   001000 000000   000000 000000                                    ........

REMOTEEOM
 Sect OctLoc
   1     532   000000 000000   000000 000000   020000 000000   000000 000000    ................
   1     536   000000 000000   000000 000000   020000 000000   000000 000000    ................

CTL_DBG
 Sect OctLoc
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:378  
   1     542   000001 777640   000550 006000   000000 177640   000000 006014    ................
   1     546   000003 777640   000552 006000   000000 000000   000000 000000    ................

VLP_TRMCTL
 Sect OctLoc
   1     552   125025 125225   125125 377377   125157 377377   377377 125177    U.U.UU..Uo....U.

FPT_PROMPT_DBG
 Sect OctLoc
   1     556   000003 777640   000564 006000   000000 177640   000000 006014    ................
   1     562   000000 177640   000570 006000   000000 000000   000000 000000    ................
   1     566   100000 000000   000000 000000                                    @.......

AT
 Sect OctLoc
   1     570   100*** ******                                                    @...

(unnamed)
 Sect OctLoc
   1     571   052052 052052   040116 117040   124157 164141   154040 122125    **** NO Total RU
   1     575   115040 145162   162157 162163   040145 156143   157165 156164    M errors encount
   1     601   145162 145144   056040 040040   052052 052052   040060 060060    ered.   **** 000
   1     605   060060 040124   157164 141154   040122 125115   040145 162162    00 Total RUM err
   1     611   157162 163040   145156 143157   165156 164145   162145 144056    ors encountered.
   1     615   115072 106105   120040 040040   106105 040040   123072 040040    M:FEP   FE  S:

(unnamed)
 Sect OctLoc
   3     000   777377 777777   000002 006000   000030 006000   777677 777777    ................
   3     004   777577 777777   000006 006000   000000 000045   000006 006000    ...........%....
   3     010   000000 000050   000010 006000   000000 006003   000003 777640    ...(............
   3     014   000025 777640   000007 777640   000021 777640   000406 006000    ................
   3     020   000001 777640   000074 006000   000001 377640   000072 006000    .....<.......:..
   3     024   000123 600000   000011 777640   000022 200000   775777 777777    .S..............
   3     030   001777 777777   000013 777640   000005 400000   000033 400000    ................
   3     034   000004 006000   000116 377640   000007 777640   000466 006000    .....N..........
   3     040   000005 777640   000000 006000   000010 200000   577777 777777    ................
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:379  
   3     044   000000 000034   000044 006000   000000 006000   777757 777777    .....$..........
   3     050   000000 006000   000002 200000   000000 006000   037777 777777    ................
   3     054   767777 777777   001777 770000   000000 177640   000000 006014    ................
   3     060   000001 140000   000005 006000   000014 006000                    ..`.........
     2420    21567    1   END DDA$DO;
     2421    21568        %EOD;

PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:380  
--  Include file information  --

   KF$MSG_SUBS.:E05TOU  is referenced.
   KF$MSG_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD$DA.:E05TOU  cannot be made into a system file and is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   DD_KNODES_D.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   DD_REPORT_R.:E05TOU  cannot be made into a system file and is referenced.
   GD$MSG_M.:E05TOU  is referenced.
   DD_DEBUG_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GD_EQUS_E.:E05TOU  is referenced.
   DF_EQUS_E.:E05TOU  is referenced.
   DU_SCODE_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DDA$DO.

   Procedure DDA$DO requires 5169 words for executable code.
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:381  
   Procedure DDA$DO requires 360 words of local(AUTO) storage.
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:382  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:383  
          MINI XREF LISTING

ACTIVE$CMD
      6127**DCL     19590--ASSIGN  21169--ASSIGN
ACTIVE$CMD.CMD
      6128**DCL     19604>>DOCASE  19618>>IF      19650>>IF      19681>>IF      19685>>IF      19688>>IF
ACTIVE$CMD.ID_FROM
      6131**DCL     19594>>ASSIGN  19615>>DOINDEX
ACTIVE$CMD.ID_TO
      6132**DCL     19596>>DOWHILE 19615>>DOINDEX
AISU_END
     19693**LABEL   19617--GOTO
ALIB$CMD
      6210**DCL     19703--ASSIGN
ALIB$CMD.CODE
      6214**DCL     19706>>IF
ALIB$CMD.SUBCODE
      6215**DCL     19709>>IF
ALL_ATTACH
      5789**DCL     19898--ASSIGN  19937--ASSIGN  20709--ASSIGN  20950--ASSIGN
ALL_ATTACH.CMD
      5790**DCL     19579>>ASSIGN
ALL_ATTACH.UNUSED
      5793**DCL      5794--REDEF    5798--REDEF
ANLZ$CMD
      6222**DCL     19759--ASSIGN
ANLZ$CMD.FANLZ
      6229**DCL     19762>>IF
ANLZ$CMD.FID
      6234**DCL      6237--REDEF
ANLZ$CMD.FIDSCH.SIZE
      6241**DCL     19804>>IF      19819>>ASSIGN
ANLZ$CMD.FIDSCH.TEXT
      6242**DCL     19819--ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:384  
ANLZ$CMD.RES.RES#
      6238**DCL     19786>>ASSIGN  19792>>ASSIGN
AT
     19551**DCL     19517--DCLINIT
AT_FIRST.BYPASS_COUNT
      5743**DCL     19647<>CALL
AT_FIRST.NODE
      5739**DCL     19667>>IF
AT_FIRST.UNUSED
      5728**DCL      5729--REDEF    5733--REDEF
B$ALIBF.WHO
     17374**DCL     20961>>IF
B$ALT.CODE
     17411**DCL     17411--REDEF   17412--REDEF   17412--REDEF
B$ALT.ERR.CODE
     17413**DCL     20770>>IF      20782>>IF
B$ALT.ERR.ERR#
     17413**DCL     17413--REDEF   21452>>IF
B$ALT.ERR.SEV
     17413**DCL     19861>>IF      20188>>IF      20204>>IF
B$ALT.EVID
     17412**DCL     17412--REDEF   17412--REDEF
B$EDEF
      3513**DCL     19747--CALL
B$EDEF.OU
      3530**DCL      3536--REDEF
B$EXCFR.ASL
     17392**DCL     17392--REDEF
B$EXCFR.ECC
     17392**DCL     20338>>IF      20338>>IF
B$EXCFR.ERR.ERR#
     17406**DCL     17406--REDEF
B$EXCFR.EVID
     17405**DCL     17405--REDEF   17406--REDEF
B$EXCFR.IR
     17393**DCL     17393--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:385  
B$EXCFR.PREVSZ
     17392**DCL     17392--REDEF
B$EXCFR.SUBC
     17404**DCL     17404--REDEF   17405--REDEF   17405--REDEF   20338>>IF
B$JIT.CPFLAGS1.SLEAZE
     17191**DCL     17191--REDEF
B$JIT.ERR.MID
     17098**DCL     17098--REDEF
B$JIT.FACCN
     17097**DCL     19823>>ASSIGN  19997>>ASSIGN  20127>>ASSIGN
B$JIT.JRESPEAK
     17259**DCL     17260--REDEF
B$JIT.JUNK
     17297**DCL     20956>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
     17368**DCL     17368--REDEF   17369--REDEF
B$JIT.PNR
     17272**DCL     17272--REDEF
B$JIT.TSLINE
     17366**DCL     17367--REDEF
B$JIT$
     17377**DCL     17092--IMP-PTR 19823>>ASSIGN  19997>>ASSIGN  20127>>ASSIGN  20956>>IF
B$NODE.PADDR
      3712**DCL     21196>>ASSIGN
B$RODCB$
      7445**DCL     21085>>IF      21091>>IF      21098>>IF      21099>>IF      21099>>IF
B$ROS$
      7396**DCL     21081>>IF      21085>>IF      21090>>IF      21091>>IF      21096>>ASSIGN  21098>>IF
     21099>>IF      21099>>IF
B$ROSEG.DCBPTR$
      7409**DCL     21085>>IF      21091>>IF      21098>>IF      21099>>IF      21099>>IF
B$ROSEG.NUMDCBS
      7411**DCL     21081>>IF      21090>>IF      21096>>ASSIGN
B$TCB.ALT$
     17379**DCL     19861>>IF      20188>>IF      20204>>IF      20770>>IF      20782>>IF      21452>>IF
B$TCB.STK$
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:386  
     17379**DCL     20337>>ASSIGN  20961>>IF
B$TCB$
     17558**DCL     19861>>IF      20188>>IF      20204>>IF      20337>>ASSIGN  20770>>IF      20782>>IF
     20961>>IF      21452>>IF
B$TREE_NODE.FLGS.NOW_IN
      3630**DCL     19667>>IF
B$XCON.CECCB
     17382**DCL     20338>>IF
B$XCON.CECCB.LNK
     17382**DCL     20338>>IF
B$XCON.ERR.ERR#
     17388**DCL     17388--REDEF
B$XCON.LIMIT.MEM
     17386**DCL     17386--REDEF
B$XCON.RNST
     17383**DCL     20338>>IF
BUF$
        58**DCL     19714<<ASSIGN  19716<>CALL    19720<>CALL    19725<>CALL    19728<>CALL    19729<>CALL
CLOSED
        33**DCL     21078<<ASSIGN  21092<>CALL
CODE
        22**DCL     19579<<ASSIGN  19580>>IF      19580>>IF      19580>>IF      19585>>DOCASE  20691<<ASSIGN
     20692<>CALL
CPU#
        29**DCL     21204<<ASSIGN  21209<<ASSIGN  21210<>CALL
CTLDBG
     19438**DCL     20167<<ASSIGN  20171<>CALL
CTLDBG.STATION_
     19442**DCL     20170<<ASSIGN
CTLDBG.V
     19446**DCL     20168--ASSIGN
CTLDBG.V.DCB#
     19446**DCL     20169<<ASSIGN
CTLDBG.V_
     19440**DCL     20168<<ASSIGN
CTL_DBG
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:387  
     19411**DCL     20167>>ASSIGN
CTL_DBG.V
     19419**DCL     19413--DCLINIT
DA.CURCPU
     14190**DCL     21204>>ASSIGN  21212<>CALL    21213<>CALL
DA.CURUSR
     14189**DCL     21205>>ASSIGN  21210<>CALL    21212<>CALL
DBG_ACCT
     18944**DCL     18696--DCLINIT
DBG_NAME
     18929**DCL     18692--DCLINIT
DCB#
        38**DCL     21079<<DOINDEX 21081>>IF      21085>>IF      21090>>IF      21091>>IF      21092<>CALL
     21097<<DOINDEX 21098>>IF      21099>>IF      21099>>IF      21102>>IF      21106<>CALL
DCBNO
        69**DCL     19773<>CALL    19774>>ASSIGN  19784<<ASSIGN  19790>>ASSIGN  19791>>ASSIGN  19796>>ASSIGN
     19827<>CALL    19828>>ASSIGN  19829>>ASSIGN  20019<>CALL    20020>>ASSIGN  20021>>ASSIGN  20026--IF
     20030>>ASSIGN  20039>>ASSIGN  20048<>CALL    20056<>CALL    20057>>ASSIGN  20067<<ASSIGN  20072>>ASSIGN
     20081>>ASSIGN  20087>>ASSIGN  20131<>CALL    20132>>ASSIGN  20133>>ASSIGN
DCTX_CR
      7381**DCL     21481>>ASSIGN
DCTX_LP
      7385**DCL     21485>>ASSIGN
DCTX_ME
      7382**DCL     20454>>ASSIGN  20807>>IF      21477>>ASSIGN
DCTX_MT
      7383**DCL     21483>>ASSIGN
DCTX_NO
      7384**DCL     21475>>ASSIGN
DCTX_PATCH
      7386**DCL     21480>>ASSIGN  21487>>ASSIGN
DD$COMP_NODE_PTR$
     13567**DCL     21046--DOINDEX 21047>>ASSIGN
DDA$DEF
     17559**DCL-ENT 20234--CALL
DDA$DISP
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:388  
     17560**DCL-ENT 20254--CALL
DDA$DUMP_DO
     17562**DCL-ENT 20269--CALL
DDA$EVAL
     17563**DCL-ENT 20325--CALL
DDA$FIND
     17564**DCL-ENT 20376--CALL
DDA$GO
     17565**DCL-ENT 19734--CALL    19901--CALL    20353--CALL    20494--CALL    21410--CALL    21449--CALL
DDA$HIST
     17566**DCL-ENT 20574--CALL
DDA$IF
     17567**DCL-ENT 19591--CALL    19704--CALL    19738--CALL    19760--CALL    19899--CALL    19919--CALL
     19927--CALL    19938--CALL    19943--CALL    20212--CALL    20232--CALL    20240--CALL    20245--CALL
     20252--CALL    20263--CALL    20278--CALL    20285--CALL    20294--CALL    20323--CALL    20335--CALL
     20374--CALL    20379--CALL    20391--CALL    20572--CALL    20577--CALL    20587--CALL    20592--CALL
     20609--CALL    20616--CALL    20627--CALL    20634--CALL    20653--CALL    20658--CALL    20663--CALL
     20682--CALL    20689--CALL    20698--CALL    20703--CALL    20710--CALL    20729--CALL    20736--CALL
     20797--CALL    20804--CALL    20816--CALL    20822--CALL    20848--CALL    20941--CALL    20946--CALL
     20951--CALL    20980--CALL    21018--CALL    21028--CALL    21040--CALL    21051--CALL    21056--CALL
     21062--CALL    21072--CALL    21147--CALL    21170--CALL    21175--CALL    21407--CALL
DDA$KEEP
     17568**DCL-ENT 20580--CALL    20605--CALL
DDA$KILL
     17569**DCL-ENT 20589--CALL
DDA$LET
     17571**DCL-ENT 20612--CALL
DDA$MACTIVE
     17572**DCL-ENT 20631--CALL
DDA$MOD
     17573**DCL-ENT 20655--CALL
DDA$NAME
     17574**DCL-ENT 20665--CALL
DDA$PLUGH
     17575**DCL-ENT 20732--CALL
DDA$RESET_PATCH_SPACE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:389  
     17576**DCL-ENT 20498--CALL    20514--CALL    20551--CALL    20969--CALL    21280--CALL
DDA$SHOW
     17577**DCL-ENT 20948--CALL
DDA$STEP
     17578**DCL-ENT 20968--CALL
DDA$STEP_MORE
     17579**DCL-ENT 19733--CALL    20490--CALL    20493--CALL
DDA$STORE
     17580**DCL-ENT 21020--CALL
DDA$TRACE
     17581**DCL-ENT 21059--CALL
DDA$TRACEON
     17582**DCL-ENT 19687--CALL
DDA$UPDATE
     17583**DCL-ENT 21172--CALL
DDA$USER_DO
     17584**DCL-ENT 20247--CALL
DDA$XEQ
     17585**DCL-ENT 21422--CALL
DDE$ERROR
     17586**DCL-ENT 19871--CALL    19915--CALL    20228--CALL    20259--CALL    20319--CALL    20370--CALL
     20420--CALL    20649--CALL    20668--CALL    20671--CALL    20674--CALL    20677--CALL    20725--CALL
     20931--CALL    21014--CALL    21023--CALL    21378--CALL    21426--CALL    21431--CALL    21443--CALL
DDM$PUTMEM
     17590**DCL-ENT 20911--CALL
DDQ$WRITE
     17591**DCL-ENT 19716--CALL    19720--CALL    19725--CALL    19728--CALL    19729--CALL
DDR$BINTXT
     17592**DCL-ENT 20015--CALL
DDR$REPORT
     17593**DCL-ENT 20561--CALL    21226--CALL
DDS$EQCS#
     17594**DCL-ENT 19747--CALL
DDS$ES_INQ
     17595**DCL-ENT 20936--CALL    21197--CALL    21350--CALL
DDS$EUTREE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:390  
     17596**DCL-ENT 21193--CALL
DDS$PD_SRCH
     17597**DCL-ENT 19744--CALL
DDS$SET_C2D
     17598**DCL-ENT 20938--CALL
DDS$SET_Q2C
     17599**DCL-ENT 20937--CALL    21198--CALL    21351--CALL
DDS$SET_Q2T
     17600**DCL-ENT 19741--CALL
DDS$SET_Q2X
     17601**DCL-ENT 19748--CALL
DDS$SET_T2Q
     17602**DCL-ENT 19751--CALL
DDT$TRACEOFF
     17603**DCL-ENT 19690--CALL
DD_ANLZSEG$
     14118**DCL     14119--IMP-PTR 21204>>ASSIGN  21205>>ASSIGN  21210>>CALL    21212>>CALL    21212>>CALL
     21213>>CALL
DD_COMPNODE$
     13565**DCL     21045>>ASSIGN
DD_COMP_NODE_PTR$
     13566**DCL     21047>>ASSIGN
DD_NODE.SUBNDS$
     13746**DCL     21047<<ASSIGN
DD_REPORT_FLAGS.LINE
      7378**DCL     20837>>ASSIGN
DD_REPORT_FLAGS.OFFSET
      7378**DCL     20836>>ASSIGN
DD_REPORT_FLAGS.TYPE
      7378**DCL     20838>>ASSIGN
DEBUG$CMD
      6289**DCL     19942--ASSIGN
DEBUG$CMD.CG
      6297**DCL     19950>>IF      19957>>IF
DEBUG$CMD.CG_FID.SIZE
      6308**DCL     19968>>ASSIGN  19977>>ASSIGN  20108>>IF      20123>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:391  
DEBUG$CMD.CG_FID.TEXT
      6309**DCL     19969>>ASSIGN  19970>>ASSIGN  19977--ASSIGN  20123--ASSIGN
DEBUG$CMD.FEP
      6295**DCL     20051>>IF
DEBUG$CMD.OPTARRY
      6302**DCL      6303--REDEF
DEBUG$CMD.OPTIONS
      6303**DCL     20195>>ASSIGN
DEBUG$CMD.STATION_FID.SIZE
      6305**DCL     20000>>ASSIGN  20003>>ASSIGN  20011>>ASSIGN  20152>>ASSIGN
DEBUG$CMD.STATION_FID.TEXT
      6306**DCL     20000>>ASSIGN  20002>>ASSIGN  20011>>ASSIGN  20077>>ASSIGN  20151>>ASSIGN
DEBUG$CMD.SYSID
      6296**DCL     19950>>IF      20005>>IF
DEBUG$CMD.SYSID#
      6293**DCL     20009>>ASSIGN  20013>>ASSIGN
DEBUG$CMD.TPACCT
      6298**DCL     19950>>IF      19957>>IF      19966>>IF
DEF$CMD
      5951**DCL     19737--ASSIGN  20231--ASSIGN
DEF$CMD.ALTVAR
      5955**DCL     19742>>IF
DEF$CMD.TEXTC
      5960**DCL     19743>>ASSIGN  19754--ASSIGN
DFA$DFMT
     17604**DCL-ENT 20266--CALL
DFA$DLCT
     17605**DCL-ENT 20242--CALL
DFA$DUMP
     17606**DCL-ENT 20271--CALL
DFA$FPRG
     17607**DCL-ENT 21281--CALL    21504--CALL
DFA$GET_FPRG_DCB
     17608**DCL-ENT 19773--CALL    19827--CALL    20019--CALL    20056--CALL    20131--CALL
DFA$GO
     17609**DCL-ENT 20510--CALL    20546--CALL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:392  
DFA$KEEP
     17610**DCL-ENT 20584--CALL    20606--CALL
DFA$KILL1
     17613**DCL-ENT 19660--CALL
DFA$KILL_DELTA
     17611**DCL-ENT 19769--CALL    19948--CALL    20775--CALL    20789--CALL
DFA$KILL_FPRG
     17612**DCL-ENT 20517--CALL    20554--CALL    21225--CALL    21508--CALL
DFA$LET
     17614**DCL-ENT 20613--CALL
DFA$MLCT
     17615**DCL-ENT 20660--CALL
DFA$MLCT_ACTIVE
     17616**DCL-ENT 20630--CALL
DFA$PLUGH
     17617**DCL-ENT 20733--CALL
DFA$QUIT
     17618**DCL-ENT 20768--CALL    20787--CALL
DFA$SETUP_FPRG
     17620**DCL-ENT 19847--CALL    20048--CALL    20153--CALL    20925--CALL
DFA$SET_AT
     17619**DCL-ENT 19647--CALL
DFA$STEP
     17621**DCL-ENT 20973--CALL
DFA$STOP_FPRGS
     17622**DCL-ENT 20780--CALL    20996--CALL    20999--CALL
DFA$TRACE
     17624**DCL-ENT 21060--CALL
DFA$TSA
     17623**DCL-ENT 21064--CALL
DFA$UNFID
     17626**DCL-ENT 21069--CALL
DFA$USE
     17627**DCL-ENT 21187--CALL
DFQ$READ_FD
     17629**DCL-ENT 19886--CALL    20766--CALL    21125--CALL    21262--CALL    21388--CALL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:393  
DFQ$WRITE_FD
     17628**DCL-ENT 19882--CALL    19933--CALL    20179--CALL    21121--CALL    21384--CALL
DFR$REPORT
     17631**DCL-ENT 21282--CALL    21506--CALL    21507--CALL
DISPLAY
      5819**DCL     20251--ASSIGN
DO$
        75**DCL     20487<<ASSIGN  20495>>IF
DOO
      5804**DCL     19918--ASSIGN  19926--ASSIGN  20211--ASSIGN  20244--ASSIGN  20277--ASSIGN  20284--ASSIGN
     20293--ASSIGN  20334--ASSIGN  20591--ASSIGN  20615--ASSIGN  20633--ASSIGN  20681--ASSIGN  20697--ASSIGN
     20728--ASSIGN  20735--ASSIGN  20803--ASSIGN  20979--ASSIGN  21027--ASSIGN  21039--ASSIGN  21050--ASSIGN
     21066--ASSIGN  21110--ASSIGN  21406--ASSIGN
DOO.ID
      5808**DCL     20597>>ASSIGN  20636>>ASSIGN  21034>>ASSIGN  21037>>ASSIGN  21042>>IF      21044>>ASSIGN
     21473>>DOCASE
DO_EVENT
     21365**LABEL   19866--GOTO    19935--GOTO    20193--GOTO    20521--GOTO
DO_READ
     21257**LABEL   21248--GOTO
DUA$ALIB
     17632**DCL-ENT 19731--CALL
DUA$ANLZ
     17633**DCL-ENT 19868--CALL
DUA$DELETE
     17634**DCL-ENT 20214--CALL
DUA$EXITDELTA
     17635**DCL-ENT 20792--CALL
DUA$HELP
     17636**DCL-ENT 20569--CALL
DUA$KILL_ANLZ
     17637**DCL-ENT 19765--CALL    20741--CALL
DUA$KILL_RUM
     17638**DCL-ENT 19764--CALL    20740--CALL
DUA$LIST
     17639**DCL-ENT 20618--CALL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:394  
DUA$OUTPUT
     17640**DCL-ENT 20692--CALL
DUA$PMD
     17641**DCL-ENT 20700--CALL
DUA$READ
     17642**DCL-ENT 20818--CALL
DUA$RUM
     17643**DCL-ENT 20799--CALL
DUA$UNFID
     17644**DCL-ENT 21092--CALL    21106--CALL
DUD$MINI
     17645**DCL-ENT 20622--CALL
DUE$ERRMSG
     17646**DCL-ENT 20025--CALL    20033--CALL    20042--CALL    21123--CALL    21127--CALL    21156--CALL
     21165--CALL    21466--CALL
DUE$GERRMSG
     17647**DCL-ENT 21141--CALL
DUI$INIT_HOST
     17648**DCL-ENT 20920--CALL
DUI$INIT_L6
     17649**DCL-ENT 20927--CALL
DUI$RU_ACCESS
     17650**DCL-ENT 20929--CALL
DUL$USE
     17651**DCL-ENT 21210--CALL    21212--CALL    21213--CALL
DUMP$CMD
      6015**DCL     20262--ASSIGN
DUMP$CMD.DEST
      6021**DCL     20265>>IF
DUMP$CMD.FID.SIZE
      6036**DCL     20265>>IF
DXA$DBOOT
     17654**DCL-ENT 19940--CALL
DXA$QUIT
     17652**DCL-ENT 20738--CALL
DXA$TBOOT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:395  
     17653**DCL-ENT 21053--CALL
DXA$USE
     17655**DCL-ENT 21180--CALL
DXC$EOP
     17656**DCL-ENT 20455--CALL
DXC$MINI
     17657**DCL-ENT 20620--CALL
DX_DIC
      7380**DCL     20236<<ASSIGN
D_M$LM#
      7395**DCL     20917>>ASSIGN
D_XDELTA
      7391**DCL     20236>>IF      20280>>IF      20287>>IF      20474>>IF      20564>>IF      20595>>IF
     20620>>IF      20679>>IF      20738>>IF      20801>>IF      21178>>IF
ECHO_DEV
      7389**DCL     20282<>CALL    20454<<ASSIGN  20811>>ASSIGN
ENDREST
     19675**LABEL   19671--GOTO    19674--GOTO
ERR
     21437**LABEL   19591--CALLALT 19612--GOTO    19643--GOTO    19701--GOTO    19704--CALLALT 19731--CALLALT
     19733--CALLALT 19738--CALLALT 19756--GOTO    19760--CALLALT 19868--CALLALT 19876--GOTO    19893--GOTO
     19899--CALLALT 19909--GOTO    19919--CALLALT 19927--CALLALT 19938--CALLALT 19943--CALLALT 19989--GOTO
     19994--GOTO    20100--GOTO    20212--CALLALT 20222--GOTO    20232--CALLALT 20234--CALLALT 20240--CALLALT
     20242--CALLALT 20245--CALLALT 20252--CALLALT 20254--CALLALT 20263--CALLALT 20266--CALLALT 20269--CALLALT
     20271--CALLALT 20278--CALLALT 20285--CALLALT 20294--CALLALT 20313--GOTO    20323--CALLALT 20325--CALLALT
     20332--GOTO    20335--CALLALT 20350--GOTO    20364--GOTO    20374--CALLALT 20376--CALLALT 20379--CALLALT
     20387--GOTO    20391--CALLALT 20396--GOTO    20401--GOTO    20406--GOTO    20414--GOTO    20426--GOTO
     20433--GOTO    20440--GOTO    20471--GOTO    20490--CALLALT 20493--CALLALT 20532--GOTO    20540--GOTO
     20549--GOTO    20567--GOTO    20572--CALLALT 20577--CALLALT 20587--CALLALT 20592--CALLALT 20609--CALLALT
     20612--CALLALT 20613--CALLALT 20616--CALLALT 20627--CALLALT 20630--CALLALT 20631--CALLALT 20634--CALLALT
     20643--GOTO    20653--CALLALT 20655--CALLALT 20658--CALLALT 20660--CALLALT 20663--CALLALT 20665--CALLALT
     20682--CALLALT 20689--CALLALT 20698--CALLALT 20703--CALLALT 20710--CALLALT 20719--GOTO    20729--CALLALT
     20736--CALLALT 20747--GOTO    20756--GOTO    20797--CALLALT 20804--CALLALT 20816--CALLALT 20822--CALLALT
     20848--CALLALT 20857--GOTO    20941--CALLALT 20946--CALLALT 20951--CALLALT 20959--GOTO    20964--GOTO
     20968--CALLALT 20976--GOTO    20980--CALLALT 20993--GOTO    21008--GOTO    21018--CALLALT 21020--CALLALT
     21028--CALLALT 21040--CALLALT 21051--CALLALT 21056--CALLALT 21062--CALLALT 21064--CALLALT 21069--CALLALT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:396  
     21072--CALLALT 21083--GOTO    21087--GOTO    21092--CALLALT 21104--GOTO    21106--CALLALT 21147--CALLALT
     21170--CALLALT 21172--CALLALT 21175--CALLALT 21210--CALLALT 21212--CALLALT 21213--CALLALT 21218--GOTO
     21235--GOTO    21243--GOTO    21254--CALLALT 21262--CALLALT 21270--GOTO    21357--GOTO    21395--GOTO
     21404--GOTO    21407--CALLALT 21419--GOTO    21422--CALLALT 21455--GOTO    21458--GOTO    21461--GOTO
     21464--GOTO
ERR1
     21443**LABEL   19916--GOTO    20229--GOTO    20260--GOTO    20320--GOTO    20371--GOTO    20421--GOTO
     20650--GOTO    20726--GOTO    21015--GOTO
ERRMSG
     21466**LABEL   19677--CALLALT 19782--CALLALT 19793--CALLALT 19798--CALLALT 19821--CALLALT 19837--CALLALT
     19842--CALLALT 19862--GOTO    19882--CALLALT 19933--CALLALT 20065--CALLALT 20073--CALLALT 20083--CALLALT
     20089--CALLALT 20099--CALLALT 20125--CALLALT 20141--CALLALT 20146--CALLALT 20161--CALLALT 20166--CALLALT
     20171--CALLALT 20176--CALLALT 20179--CALLALT 20189--GOTO    20205--GOTO    20289--CALLALT 20306--CALLALT
     20763--CALLALT 20766--CALLALT 20771--GOTO    20876--CALLALT 20884--CALLALT 20893--CALLALT 20898--CALLALT
     21384--CALLALT
EVAL$CMD
      6080**DCL     20322--ASSIGN
F$DCB.ACTPOS
     17534**DCL     17534--REDEF
F$DCB.ARS#
     17508**DCL     17508--REDEF
F$DCB.ATTR
     17527**DCL     17528--REDEF
F$DCB.BORROW
     17542**DCL     17542--REDEF   17542--REDEF   17542--REDEF
F$DCB.DCBNAME.L
     17556**DCL     17556--IMP-SIZ 21099>>IF
F$DCB.DCBNAME.N
     17556**DCL     21099>>IF
F$DCB.EOMCHAR#
     17512**DCL     17512--REDEF
F$DCB.FCD#
     17521**DCL     19777>>IF      19832>>IF      20026>>IF      20060>>IF      20136>>IF      20888>>IF
F$DCB.FLDID
     17537**DCL     17537--REDEF
F$DCB.FORM$
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:397  
     17531**DCL     17531--REDEF
F$DCB.FSECT
     17547**DCL     17547--REDEF
F$DCB.FSN#
     17524**DCL     17524--REDEF   17524--REDEF   17525--REDEF
F$DCB.HEADER$
     17530**DCL     17530--REDEF
F$DCB.IXTNSIZE#
     17528**DCL     17528--REDEF
F$DCB.LASTSTA$
     17517**DCL     17517--REDEF
F$DCB.LVL
     17543**DCL     17543--REDEF
F$DCB.NAME#.C
     17518**DCL     17518--REDEF   19844>>IF      20148>>IF      20899>>IF
F$DCB.NOEOF
     17540**DCL     17540--REDEF
F$DCB.NRECS#
     17529**DCL     17529--REDEF
F$DCB.NRECX
     17548**DCL     17548--REDEF
F$DCB.OHDR
     17540**DCL     17540--REDEF
F$DCB.ORG#
     17523**DCL     17523--REDEF
F$DCB.PRECNO
     17546**DCL     17546--REDEF
F$DCB.RCSZ
     17552**DCL     17552--REDEF
F$DCB.RES#
     17519**DCL     17519--REDEF
F$DCB.SETX
     17531**DCL     17531--REDEF
F$DCB.TAB$
     17531**DCL     17531--REDEF
F$DCB.TDA
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:398  
     17545**DCL     17546--REDEF
F$DCB.WSN#
     17519**DCL     17519--REDEF
FATT$
        76**DCL      5752--IMP-PTR 19646<<ASSIGN  19647>>CALL    19665<<ASSIGN  19667>>IF      19675>>ASSIGN
     19676>>ASSIGN  19676>>ASSIGN
FID_ASN
        66**DCL     19983--ASSIGN  19991>>IF
FID_RES
        70**DCL     19980--ASSIGN
FIND$CMD
      6168**DCL     20373--ASSIGN  21017--ASSIGN
FORMAT$CMD
      5850**DCL     20378--ASSIGN
FORMAT$CMD.FORMAT
      5855**DCL     20382>>ASSIGN  20384>>ASSIGN
FORMAT$CMD.TYPE
      5854**DCL     20381>>IF      20383>>IF
FPRG$CONTEXT.ADDRESS
      6336**DCL     21278<<ASSIGN  21281<>CALL    21504<>CALL
FPRG$CONTEXT.DCBNO
      6329**DCL     20761>>ASSIGN  21253>>ASSIGN
FPRG$CONTEXT.FANLZ
      6326**DCL     19851<<ASSIGN  20774<<ASSIGN  20788<<ASSIGN  21182>>IF
FPRG$CONTEXT.FIXCOM_INDEX
      6352**DCL     19636>>DOWHILE 19645<<ASSIGN
FPRG$CONTEXT.INTERPRETIVE
      6317**DCL     19906>>IF      20219>>IF      20310>>IF      20361>>IF      20411>>IF      20640>>IF
     20716>>IF      21005>>IF
FPRG$CONTEXT.NEXT$
      6313**DCL     19631>>ASSIGN  20512>>ASSIGN  20522>>ASSIGN  20536>>ASSIGN  20752>>ASSIGN  20989>>ASSIGN
     21239>>ASSIGN  21365>>ASSIGN  21510>>ASSIGN
FPRG$CONTEXT.READ_FD
      6315**DCL     20506>>IF      20520>>IF      21247>>IF      21260>>IF      21261<<ASSIGN  21363>>DOWHILE
     21373<<ASSIGN
FPRG$CONTEXT.RES
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:399  
      6332**DCL     19629>>DOWHILE 20160--ASSIGN  20165--ASSIGN  20170--ASSIGN  20175--ASSIGN  20535>>DOWHILE
     20750>>DOWHILE 20986>>DOWHILE 21238>>DOWHILE
FPRG$CONTEXT.RES_SIZE
      6334**DCL     19629>>DOWHILE 20750>>DOWHILE 20986>>DOWHILE
FPRG$CONTEXT.SHARED
      6323**DCL     21144<<ASSIGN
FPRG$CONTEXT.STATE
      6327**DCL     20506>>IF      20544>>IF      20544>>IF      20759>>IF      20972>>IF      21249>>IF
     21249>>IF      21255<<ASSIGN  21500>>IF      21500>>IF      21505>>IF
FPRG$CONTEXT.XDELTA
      6325**DCL     19850<<ASSIGN  21131>>IF      21182>>IF      21266>>IF      21363>>DOWHILE
FPRG_ERR
     21452**LABEL   19626--GOTO    19633--GOTO
FPRG_IC
        79**DCL     21276<<ASSIGN  21278>>ASSIGN
FPT$CLOSE
     18339**DCL     19834<<ASSIGN  19837<>CALL    20028<<ASSIGN  20031<>CALL    20138<<ASSIGN  20141<>CALL
     20890<<ASSIGN  20893<>CALL
FPT$CLOSE.SN_
     18339**DCL     18339--REDEF
FPT$CLOSE.UTL_
     18340**DCL     18340--REDEF
FPT$CLOSE.V
     18344**DCL     19835--ASSIGN  20029--ASSIGN  20139--ASSIGN  20891--ASSIGN
FPT$CLOSE.V.DCB#
     18345**DCL     19836<<ASSIGN  20030<<ASSIGN  20140<<ASSIGN  20892<<ASSIGN
FPT$CLOSE.V.EXPIRE#
     18354**DCL     18354--REDEF
FPT$CLOSE.V.TYPE#
     18352**DCL     18352--REDEF
FPT$CLOSE.V.XTNSIZE#
     18349**DCL     18349--REDEF   18351--REDEF
FPT$CLOSE.V_
     18339**DCL     19835<<ASSIGN  20029<<ASSIGN  20139<<ASSIGN  20891<<ASSIGN
FPT$DRTN
     18369**DCL     20763<>CALL    21254<>CALL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:400  
FPT$DRTN.FPRG_FID_
     18370**DCL     21259<<ASSIGN  21441<<ASSIGN
FPT$DRTN.V.ECC#
     18379**DCL     19900<<ASSIGN  20352<<ASSIGN  21409<<ASSIGN  21433<<ASSIGN
FPT$DRTN.V.FPRG_DCB#
     18380**DCL     20761<<ASSIGN  20764<<ASSIGN  21253<<ASSIGN  21258<<ASSIGN  21440<<ASSIGN
FPT$DRTN.V.IR#
     18371**DCL     18371--REDEF
FPT$DRTN.V.SETECC#
     18374**DCL     20480<<ASSIGN  21435<<ASSIGN
FPT$DRTN.V.WAKE_FD#
     18378**DCL     20762<<ASSIGN  20765<<ASSIGN  21252<<ASSIGN  21257<<ASSIGN  21439<<ASSIGN
FPT$SAD
     18446**DCL     21030<<ASSIGN  21036<>CALL
FPT$SAD.V
     18446**DCL     21031--ASSIGN
FPT$SAD.V.MONSID#
     18447**DCL     21035<<ASSIGN
FPT$SAD.V.USERSID#
     18446**DCL     21033<<ASSIGN
FPT$SAD.V_
     18446**DCL     21031<<ASSIGN
FPT$SSC
     18512**DCL     19677<>CALL
FPT$SSC.V.NUMPGS#
     18514**DCL     19676<<ASSIGN
FPT$SSC.V.VPNO#
     18514**DCL     19675<<ASSIGN
FPT$UNSHARE
     18480**DCL     21149<<ASSIGN  21154<>CALL    21163<>CALL
FPT$UNSHARE.V
     18480**DCL     21150--ASSIGN
FPT$UNSHARE.V.FLGS.LIB#
     18481**DCL     21162<<ASSIGN
FPT$UNSHARE.V.FLGS.PROG#
     18481**DCL     21153<<ASSIGN  21159<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:401  
FPT$UNSHARE.V_
     18480**DCL     21150<<ASSIGN
FPTCLOSE_DBG
     18598**DCL     19779<<ASSIGN  19782<>CALL    20062<<ASSIGN  20065<>CALL    20096<<ASSIGN  20099<>CALL
FPTCLOSE_DBG.SN_
     18598**DCL     18598--REDEF
FPTCLOSE_DBG.UTL_
     18599**DCL     18599--REDEF
FPTCLOSE_DBG.V
     18603**DCL     19780--ASSIGN  20063--ASSIGN  20097--ASSIGN
FPTCLOSE_DBG.V.DCB#
     18604**DCL     19781<<ASSIGN  20064<<ASSIGN  20098<<ASSIGN
FPTCLOSE_DBG.V.EXPIRE#
     18613**DCL     18613--REDEF
FPTCLOSE_DBG.V.TYPE#
     18611**DCL     18611--REDEF
FPTCLOSE_DBG.V.XTNSIZE#
     18608**DCL     18608--REDEF   18610--REDEF
FPTCLOSE_DBG.V_
     18598**DCL     19780<<ASSIGN  20063<<ASSIGN  20097<<ASSIGN
FPTEOM_DBG
     19379**DCL     20162<<ASSIGN  20166<>CALL
FPTEOM_DBG.STATION_
     19383**DCL     20165<<ASSIGN
FPTEOM_DBG.V
     19387**DCL     20163--ASSIGN
FPTEOM_DBG.V.DCB#
     19387**DCL     20164<<ASSIGN
FPTEOM_DBG.V_
     19381**DCL     20163<<ASSIGN
FPTFID
     18232**DCL     19810<<ASSIGN  19821<>CALL    19975<<ASSIGN  19986<>CALL    20114<<ASSIGN  20125<>CALL
     20296<<ASSIGN  20306<>CALL    20865<<ASSIGN  20876<>CALL
FPTFID.ACCT_
     18233**DCL     19813<<ASSIGN  19982<<ASSIGN  20117<<ASSIGN  20299<<ASSIGN  20868<<ASSIGN
FPTFID.ASN_
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:402  
     18235**DCL     19817<<ASSIGN  19983<<ASSIGN  20121<<ASSIGN  20304<<ASSIGN  20872<<ASSIGN
FPTFID.NAME_
     18233**DCL     19812<<ASSIGN  19979<<ASSIGN  20116<<ASSIGN  20298<<ASSIGN  20867<<ASSIGN
FPTFID.PASS_
     18233**DCL     19814<<ASSIGN  19984<<ASSIGN  20118<<ASSIGN  20300<<ASSIGN  20869<<ASSIGN
FPTFID.RESULTS_
     18235**DCL     19818<<ASSIGN  19981<<ASSIGN  20122<<ASSIGN  20305<<ASSIGN  20873<<ASSIGN
FPTFID.RES_
     18235**DCL     19980<<ASSIGN
FPTFID.SN_
     18234**DCL     19815<<ASSIGN  19985<<ASSIGN  20119<<ASSIGN  20302<<ASSIGN  20870<<ASSIGN
FPTFID.TEXTFID_
     18232**DCL     19819<<ASSIGN  19977<<ASSIGN  20123<<ASSIGN  20301<<ASSIGN  20874<<ASSIGN
FPTFID.V
     18236**DCL     19811--ASSIGN  19976--ASSIGN  20115--ASSIGN  20297--ASSIGN  20866--ASSIGN
FPTFID.V_
     18232**DCL     19811<<ASSIGN  19976<<ASSIGN  20115<<ASSIGN  20297<<ASSIGN  20866<<ASSIGN
FPTFID.WSN_
     18234**DCL     19816<<ASSIGN  20120<<ASSIGN  20303<<ASSIGN  20871<<ASSIGN
FPTGETDCB
     18133**DCL     20881<<ASSIGN  20884<>CALL
FPTGETDCB.DCBNUM_
     18133**DCL     20883<<ASSIGN
FPTGETDCB.V
     18134**DCL     20882--ASSIGN
FPTGETDCB.V_
     18133**DCL     20882<<ASSIGN
FPTOPEN
     17922**DCL     19788<<ASSIGN  19793<>CALL    19799<<ASSIGN  19842<>CALL    19954<<ASSIGN  20023<>CALL
     20070<<ASSIGN  20073<>CALL    20103<<ASSIGN  20146<>CALL    20853<<ASSIGN  20898<>CALL
FPTOPEN.ACCT_
     17926**DCL     19802<<ASSIGN  19807<<ASSIGN  19961<<ASSIGN  20106<<ASSIGN  20111<<ASSIGN  20862<<ASSIGN
FPTOPEN.ACSVEH_
     17924**DCL     17925--REDEF
FPTOPEN.ALTKEYS_
     17930**DCL     17931--REDEF   17931--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:403  
FPTOPEN.HDR_
     17929**DCL     17930--REDEF
FPTOPEN.NAME_
     17923**DCL     19801<<ASSIGN  19806<<ASSIGN  19960<<ASSIGN  20105<<ASSIGN  20110<<ASSIGN  20861<<ASSIGN
FPTOPEN.NODENAME_
     17928**DCL     20010<<ASSIGN
FPTOPEN.PASS_
     17924**DCL     19962<<ASSIGN  20863<<ASSIGN
FPTOPEN.SETSTA_
     17923**DCL     19963<<ASSIGN
FPTOPEN.SN_
     17922**DCL     19959<<ASSIGN  20860<<ASSIGN
FPTOPEN.TAB_
     17928**DCL     17929--REDEF
FPTOPEN.UHL_
     17922**DCL     17923--REDEF   17923--REDEF
FPTOPEN.V
     17931**DCL     19789--ASSIGN  19800--ASSIGN  19955--ASSIGN  20071--ASSIGN  20104--ASSIGN  20859--ASSIGN
FPTOPEN.V.ASN#
     17941**DCL     19803<<ASSIGN  19817--ASSIGN  20107<<ASSIGN  20121--ASSIGN  20304--ASSIGN  20872--ASSIGN
FPTOPEN.V.DBGSYSID#
     17962**DCL     20009<<ASSIGN
FPTOPEN.V.DCB#
     17931**DCL     19790<<ASSIGN  19841<<ASSIGN  20020<<ASSIGN  20072<<ASSIGN  20145<<ASSIGN  20897<<ASSIGN
FPTOPEN.V.EVENT#
     17961**DCL     19791<<ASSIGN  20021<<ASSIGN
FPTOPEN.V.FSN#
     17962**DCL     17962--REDEF   17962--REDEF
FPTOPEN.V.FUN#
     17941**DCL     19965<<ASSIGN  20008<<ASSIGN
FPTOPEN.V.ORG#
     17942**DCL     19964<<ASSIGN  20007<<ASSIGN
FPTOPEN.V.RES#
     17946**DCL     19792<<ASSIGN  19956<<ASSIGN
FPTOPEN.V_
     17922**DCL     19789<<ASSIGN  19800<<ASSIGN  19955<<ASSIGN  20071<<ASSIGN  20104<<ASSIGN  20859<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:404  
FPTOPEN.WSN_
     17928**DCL     17928--REDEF   20864<<ASSIGN
FPTPROMPT_DBG
     19539**DCL     20172<<ASSIGN  20176<>CALL
FPTPROMPT_DBG.STATION_
     19543**DCL     20175<<ASSIGN
FPTPROMPT_DBG.V
     19547**DCL     20173--ASSIGN
FPTPROMPT_DBG.V.DCB#
     19547**DCL     20174<<ASSIGN
FPTPROMPT_DBG.V_
     19541**DCL     20173<<ASSIGN
FPTREAD_DBG
     19123**DCL     20084<<ASSIGN  20089<>CALL
FPTREAD_DBG.BUF_
     19125**DCL     20085<<ASSIGN
FPTREAD_DBG.STATION_
     19126**DCL     19127--REDEF   20088<<ASSIGN
FPTREAD_DBG.V
     19127**DCL     20086--ASSIGN
FPTREAD_DBG.V.DCB#
     19127**DCL     20087<<ASSIGN
FPTREAD_DBG.V.DVBYTE.REREAD#
     19138**DCL     19138--REDEF
FPTREAD_DBG.V.INDX#
     19136**DCL     19136--REDEF
FPTREAD_DBG.V_
     19123**DCL     20086<<ASSIGN
FPTRELDCB
     18271**DCL     20037<<ASSIGN  20040<>CALL
FPTRELDCB.V
     18271**DCL     20038--ASSIGN
FPTRELDCB.V.DCB#
     18271**DCL     20039<<ASSIGN
FPTRELDCB.V_
     18271**DCL     20038<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:405  
FPTSETFP
     18874**DCL     19794<<ASSIGN  19798<>CALL
FPTSETFP.FPRG_
     18874**DCL     19797<<ASSIGN
FPTSETFP.V
     18875**DCL     19795--ASSIGN
FPTSETFP.V.DCB#
     18875**DCL     19796<<ASSIGN
FPTSETFP.V_
     18874**DCL     19795<<ASSIGN
FPTWAIT
     18118**DCL     19883<<ASSIGN  19885<>CALL    21360<<ASSIGN  21368<>CALL    21385<<ASSIGN  21387<>CALL
FPTWAIT.V
     18119**DCL     19884--ASSIGN  21361--ASSIGN  21386--ASSIGN
FPTWAIT.V_
     18118**DCL     19884<<ASSIGN  21361<<ASSIGN  21386<<ASSIGN
FPTWRITE_DBG
     19195**DCL     20078<<ASSIGN  20083<>CALL
FPTWRITE_DBG.BUF_
     19195**DCL     20079<<ASSIGN
FPTWRITE_DBG.STATION_
     19197**DCL     19197--REDEF   20082<<ASSIGN
FPTWRITE_DBG.V
     19198**DCL     20080--ASSIGN
FPTWRITE_DBG.V.DCB#
     19198**DCL     20081<<ASSIGN
FPTWRITE_DBG.V.DVBYTE.VFC#
     19204**DCL     19204--REDEF
FPTWRITE_DBG.V_
     19195**DCL     20080<<ASSIGN
FPT_CLOSE
     18297**DCL     19834>>ASSIGN  20028>>ASSIGN  20138>>ASSIGN  20890>>ASSIGN
FPT_CLOSE.SN_
     18297**DCL     18297--REDEF
FPT_CLOSE.UTL_
     18298**DCL     18298--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:406  
FPT_CLOSE.V.EXPIRE#
     18312**DCL     18312--REDEF
FPT_CLOSE.V.TYPE#
     18310**DCL     18310--REDEF
FPT_CLOSE.V.XTNSIZE#
     18307**DCL     18307--REDEF   18309--REDEF
FPT_CLOSE_DBG
     18556**DCL     19779>>ASSIGN  20062>>ASSIGN  20096>>ASSIGN
FPT_CLOSE_DBG.SN_
     18556**DCL     18556--REDEF
FPT_CLOSE_DBG.UTL_
     18557**DCL     18557--REDEF
FPT_CLOSE_DBG.V
     18561**DCL     18556--DCLINIT
FPT_CLOSE_DBG.V.EXPIRE#
     18571**DCL     18571--REDEF
FPT_CLOSE_DBG.V.TYPE#
     18569**DCL     18569--REDEF
FPT_CLOSE_DBG.V.XTNSIZE#
     18566**DCL     18566--REDEF   18568--REDEF
FPT_EOM
     18408**DCL     19857<>CALL    20184<>CALL    20200<>CALL    20289<>CALL
FPT_EOM_DBG
     19349**DCL     20162>>ASSIGN
FPT_EOM_DBG.V
     19357**DCL     19351--DCLINIT
FPT_FID
     18209**DCL     19810>>ASSIGN  19975>>ASSIGN  20114>>ASSIGN  20296>>ASSIGN  20865>>ASSIGN
FPT_FID.V
     18213**DCL     18209--DCLINIT
FPT_GETDCB
     17744**DCL     20881>>ASSIGN
FPT_OPEN
     17813**DCL     19799>>ASSIGN  19954>>ASSIGN  20103>>ASSIGN  20853>>ASSIGN
FPT_OPEN.ACSVEH_
     17815**DCL     17816--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:407  
FPT_OPEN.ALTKEYS_
     17821**DCL     17822--REDEF   17822--REDEF
FPT_OPEN.HDR_
     17820**DCL     17821--REDEF
FPT_OPEN.TAB_
     17819**DCL     17820--REDEF
FPT_OPEN.UHL_
     17813**DCL     17814--REDEF   17814--REDEF
FPT_OPEN.V
     17822**DCL     17813--DCLINIT
FPT_OPEN.V.FSN#
     17853**DCL     17853--REDEF   17853--REDEF
FPT_OPEN.WSN_
     17819**DCL     17819--REDEF
FPT_OPEN_DBG
     18691**DCL     20070>>ASSIGN
FPT_OPEN_DBG.ACSVEH_
     18693**DCL     18694--REDEF
FPT_OPEN_DBG.ALTKEYS_
     18699**DCL     18700--REDEF   18700--REDEF
FPT_OPEN_DBG.HDR_
     18698**DCL     18699--REDEF
FPT_OPEN_DBG.TAB_
     18697**DCL     18698--REDEF
FPT_OPEN_DBG.UHL_
     18691**DCL     18692--REDEF   18692--REDEF
FPT_OPEN_DBG.V
     18700**DCL     18691--DCLINIT
FPT_OPEN_DBG.V.FSN#
     18731**DCL     18731--REDEF   18731--REDEF
FPT_OPEN_DBG.WSN_
     18697**DCL     18697--REDEF
FPT_OPEN_FANLZ
     18806**DCL     19788>>ASSIGN
FPT_OPEN_FANLZ.ACSVEH_
     18808**DCL     18809--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:408  
FPT_OPEN_FANLZ.ALTKEYS_
     18814**DCL     18815--REDEF   18815--REDEF
FPT_OPEN_FANLZ.HDR_
     18813**DCL     18814--REDEF
FPT_OPEN_FANLZ.TAB_
     18812**DCL     18813--REDEF
FPT_OPEN_FANLZ.UHL_
     18806**DCL     18807--REDEF   18807--REDEF
FPT_OPEN_FANLZ.V
     18815**DCL     18806--DCLINIT
FPT_OPEN_FANLZ.V.FSN#
     18846**DCL     18846--REDEF   18846--REDEF
FPT_OPEN_FANLZ.WSN_
     18812**DCL     18812--REDEF
FPT_PROMPT_DBG
     19511**DCL     20172>>ASSIGN
FPT_PROMPT_DBG.V
     19519**DCL     19513--DCLINIT
FPT_READ_DBG
     19084**DCL     20084>>ASSIGN
FPT_READ_DBG.STATION_
     19087**DCL     19088--REDEF
FPT_READ_DBG.V
     19088**DCL     19084--DCLINIT
FPT_READ_DBG.V.DVBYTE.REREAD#
     19099**DCL     19099--REDEF
FPT_READ_DBG.V.INDX#
     19097**DCL     19097--REDEF
FPT_RELDCB
     18256**DCL     20037>>ASSIGN
FPT_SAD
     18431**DCL     21030>>ASSIGN
FPT_SAD.V
     18431**DCL     18431--DCLINIT
FPT_SETFP
     18860**DCL     19794>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:409  
FPT_SETFP.V
     18861**DCL     18860--DCLINIT
FPT_SSC.V
     18496**DCL     18496--DCLINIT
FPT_UNSHARE
     18464**DCL     21149>>ASSIGN
FPT_UNSHARE.V
     18464**DCL     18464--DCLINIT
FPT_WAIT
     18104**DCL     19883>>ASSIGN  21360>>ASSIGN  21385>>ASSIGN
FPT_WAIT.V
     18105**DCL     18104--DCLINIT
FPT_WRITE_DBG
     19164**DCL     20078>>ASSIGN
FPT_WRITE_DBG.STATION_
     19166**DCL     19166--REDEF
FPT_WRITE_DBG.V
     19167**DCL     19164--DCLINIT
FPT_WRITE_DBG.V.DVBYTE.VFC#
     19173**DCL     19173--REDEF
FROG_STATION
     19223**DCL     20082--ASSIGN  20088--ASSIGN
FROG_STATION.MSGIDXT
     19233**DCL     19236--REDEF
GD$MSG
      7231**DCL     19880<<ASSIGN  19931<<ASSIGN  20177<<ASSIGN  21113<<ASSIGN  21382<<ASSIGN
GD$MSG.BRKRQS.IF$CONST.SIZE
      7282**DCL      7282--REDEF
GD$MSG.BRKRQS.IF$CONST.TEXT
      7282**DCL      7283--REDEF    7283--REDEF    7284--REDEF    7285--REDEF
GD$MSG.BRKRSP.ADR$
      7295**DCL     21276>>ASSIGN
GD$MSG.BRKRSP.BRK#
      7296**DCL      7296--REDEF   21263>>IF      21277>>ASSIGN
GD$MSG.BRKRSP.USER#
      7296**DCL      7296--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:410  
GD$MSG.ERROR_D.ERRCODE
      7237**DCL     21133>>ASSIGN
GD$MSG.FNC
      7231**DCL     19881<<ASSIGN  19890>>IF      19932<<ASSIGN  20178<<ASSIGN  21116<<ASSIGN  21118<<ASSIGN
     21120<<ASSIGN  21129>>IF      21263>>IF      21266>>IF      21383<<ASSIGN  21392>>IF
GD$MSG.LETMEM_D.VALUE.SIZE
      7254**DCL      7254--REDEF
GD$MSG.LETMEM_D.VALUE.TEXT
      7255**DCL      7255--REDEF    7255--REDEF    7256--REDEF    7257--REDEF
GD$MSG.MESSAGE
      7236**DCL      7236--REDEF    7237--REDEF    7237--REDEF    7238--REDEF    7249--REDEF    7262--REDEF
      7267--REDEF    7274--REDEF    7290--REDEF    7295--REDEF    7301--REDEF    7302--REDEF    7331--REDEF
      7333--REDEF    7344--REDEF    7351--REDEF    7363--REDEF
GD$MSG.SUBFNC
      7231**DCL      7231--REDEF    7235--REDEF
GD$MSG.TSA.I
      7303**DCL      7303--REDEF
GD$MSG.TSA.S
      7305**DCL      7305--REDEF
GD$MSG.USERQS.ASDT$
      7331**DCL      7331--REDEF    7332--REDEF
GD$MSG_HOST.BRKRQS.IF$CONST.SIZE
      7126**DCL      7126--REDEF
GD$MSG_HOST.BRKRQS.IF$CONST.TEXT
      7126**DCL      7127--REDEF    7127--REDEF    7128--REDEF    7129--REDEF
GD$MSG_HOST.BRKRSP.BRK#
      7140**DCL      7140--REDEF
GD$MSG_HOST.BRKRSP.USER#
      7140**DCL      7140--REDEF
GD$MSG_HOST.ERROR_D.ERRCODE
      7081**DCL     21140>>ASSIGN
GD$MSG_HOST.LETMEM_D.VALUE.SIZE
      7098**DCL      7098--REDEF
GD$MSG_HOST.LETMEM_D.VALUE.TEXT
      7099**DCL      7099--REDEF    7099--REDEF    7100--REDEF    7101--REDEF
GD$MSG_HOST.MESSAGE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:411  
      7080**DCL      7080--REDEF    7081--REDEF    7081--REDEF    7082--REDEF    7093--REDEF    7106--REDEF
      7111--REDEF    7118--REDEF    7134--REDEF    7139--REDEF    7145--REDEF    7146--REDEF    7175--REDEF
      7177--REDEF    7188--REDEF    7195--REDEF    7207--REDEF
GD$MSG_HOST.SUBFNC
      7075**DCL      7075--REDEF    7079--REDEF
GD$MSG_HOST.TSA.I
      7147**DCL      7147--REDEF
GD$MSG_HOST.TSA.S
      7149**DCL      7149--REDEF
GD$MSG_HOST.USERQS.ASDT$
      7175**DCL      7175--REDEF    7176--REDEF
GO$CMD
      5830**DCL     20390--ASSIGN
GO$CMD.ALL
      5838**DCL     20428>>IF      20435>>IF      20457>>IF      20501>>IF
GO$CMD.FPRG
      5840**DCL     20526>>IF
GO$CMD.FPRG_RES
      5846**DCL     20528>>ASSIGN
GO$CMD.GOPOS
      5835**DCL     20393>>IF      20443>>IF      20461>>IF
GO$CMD.HOST
      5839**DCL     20457>>IF      20495>>IF
GO$CMD.POSITION
      5845**DCL     20447>>ASSIGN  20463>>ASSIGN
GO$CMD.STEP
      5836**DCL     20398>>IF      20408>>IF      20423>>IF      20435>>IF      20488>>IF      20556>>IF
GO$CMD.TRAP
      5837**DCL     20398>>IF      20403>>IF      20408>>IF      20428>>IF      20443>>IF      20467>>IF
GOHOST
     20467**LABEL   20524--GOTO
GOTXOU
     19747**LABEL   19744--CALLALT
HANDLER_FPRG
     18892**DCL     19797--ASSIGN
HIGX
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:412  
        31**DCL     20827<<ASSIGN  20831<<ASSIGN  20833>>DOINDEX 21076<<ASSIGN  21079>>DOINDEX 21080>>IF
     21096<<ASSIGN  21097>>DOINDEX 21102>>IF
HIST$CMD
      6114**DCL     20571--ASSIGN
I
        24**DCL     19594<<ASSIGN  19596>>DOWHILE 19598>>IF      19600<<ASSIGN  19600>>ASSIGN  19615<<DOINDEX
     19616>>IF      19620>>ASSIGN  19621>>IF      19627>>ASSIGN  19628>>ASSIGN  19645>>ASSIGN  19646>>ASSIGN
     19647<>CALL    19652>>IF      19657>>IF      19659>>ASSIGN  19660>>CALL    19662>>ASSIGN  19663>>IF
     19665>>ASSIGN  19668>>ASSIGN  19670>>ASSIGN  19674>>IF      19682>>ASSIGN  19683>>ASSIGN  19684>>IF
     19707<<ASSIGN  19708<<ASSIGN  19731<>CALL    20013<<ASSIGN  20015<>CALL    20833<<DOINDEX 20836>>ASSIGN
     20836>>ASSIGN  20837>>ASSIGN  20837>>ASSIGN  20838>>ASSIGN  20838>>ASSIGN  20841>>ASSIGN  20842>>ASSIGN
     20843>>ASSIGN  20904<<ASSIGN  20906<<ASSIGN  20936<>CALL    21046<<DOINDEX 21047>>ASSIGN  21047>>ASSIGN
     21196<<ASSIGN  21197<>CALL    21349<<ASSIGN  21350<>CALL
II
        25**DCL     19635<<ASSIGN  19636>>DOWHILE 19636>>DOWHILE 19638<<ASSIGN  19638>>ASSIGN  19640>>IF
     19645>>ASSIGN  19647<>CALL
IN_DEV
      7387**DCL     20806<>CALL    20807>>IF
IRM_NOKP_SCR
      7392**DCL     20601>>ASSIGN  20602>>ASSIGN
KEEP$CMD
      6095**DCL     20576--ASSIGN
KEEP$CMD.L6_OPTIONS
      6102**DCL      6103--REDEF
KEEP$CMD.OPTARRY
      6109**DCL      6110--REDEF
KF$MSG.MSG_ID
     19061**DCL     20076<<ASSIGN
KF$MSG.MSG_SUBC
     19062**DCL     20090>>IF      20092>>IF      20094>>IF
KF$MSG.STATION
     19063**DCL     20077<<ASSIGN
LCT$CMD
      6415**DCL     20239--ASSIGN  20657--ASSIGN
LCT$CMD.CHAN#
      6425**DCL     20943>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:413  
LCT$CMD.LCT#
      6424**DCL      6425--REDEF
LET$CMD
      5965**DCL     20608--ASSIGN
LET$CMD.CONS.TANT
      5985**DCL      5986--REDEF
LET$CMD.P.ADR
      5996**DCL      6000--REDEF
LET$CMD.TEXTC
      5974**DCL      5982--REDEF    5988--REDEF    5993--REDEF    6007--REDEF
LET$CMD.TEXTC.SIZE
      5975**DCL      5976--REDEF
LET$CMD.TEXTC.TEXT
      5977**DCL      5978--REDEF    5979--REDEF
LOWX
        30**DCL     20826<<ASSIGN  20827>>ASSIGN  20830<<ASSIGN  20833>>DOINDEX 21075<<ASSIGN  21079>>DOINDEX
     21080>>IF
LS#
        28**DCL     21202<<ASSIGN  21213<>CALL
M$CLOSE
     15344**DCL-ENT 19782--CALL    19837--CALL    20031--CALL    20065--CALL    20099--CALL    20141--CALL
     20893--CALL
M$DRTN
     15402**DCL-ENT 20763--CALL    21254--CALL
M$EOM
     15369**DCL-ENT 19857--CALL    20166--CALL    20184--CALL    20200--CALL    20289--CALL
M$FID
     15407**DCL-ENT 19821--CALL    19986--CALL    20125--CALL    20306--CALL    20876--CALL
M$GETDCB
     15350**DCL-ENT 20884--CALL
M$OPEN
     15344**DCL-ENT 19793--CALL    19842--CALL    20023--CALL    20073--CALL    20146--CALL    20898--CALL
M$PROMPT
     15368**DCL-ENT 20176--CALL
M$READ
     15345**DCL-ENT 20089--CALL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:414  
M$RELDCB
     15350**DCL-ENT 20040--CALL
M$SAD
     15383**DCL-ENT 21036--CALL
M$SCREECH
     15358**DCL-ENT 21273--CALL
M$SETFP
     15373**DCL-ENT 19798--CALL
M$SSC
     15383**DCL-ENT 19677--CALL
M$STRMATTR
     15370**DCL-ENT 20161--CALL
M$STRMCTL
     15368**DCL-ENT 20171--CALL
M$UNSHARE
     15361**DCL-ENT 21154--CALL    21163--CALL
M$WAIT
     15402**DCL-ENT 19885--CALL    21368--CALL    21387--CALL
M$WRITE
     15345**DCL-ENT 20083--CALL
MACTIVE$CMD
      6045**DCL     20626--ASSIGN
MACTIVE$CMD.FORMAT
      6058**DCL      6059--REDEF
MIS$
      7393**DCL     20601>>ASSIGN  20602>>ASSIGN
MODIFY$CMD
      6064**DCL     20652--ASSIGN
MONIS
     21303**LABEL   21289--GOTO
MONIS IN PROCEDURE RESTORE_USE
     21530**LABEL   21518--GOTO
MSG$
     19552**DCL     20075<<ASSIGN  20076>>ASSIGN  20077>>ASSIGN  20090>>IF      20092>>IF      20094>>IF
NAME$CMD
      6263**DCL     20662--ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:415  
NEVER
     21268**LABEL   21272--REMEMBR 21273--CALLALT
NOEOM
     20204**LABEL   20200--CALLALT
NOEOM1
     20188**LABEL   20184--CALLALT
NOEOM2
     19861**LABEL   19857--CALLALT
NOGO
     21421**LABEL   19647--CALLALT 19734--CALLALT 20048--CALLALT 20247--CALLALT 20494--CALLALT 20510--CALLALT
     20546--CALLALT 20584--CALLALT 20606--CALLALT 20783--GOTO    20932--GOTO    21449--CALLALT
NOGO_BIT
        23**DCL     19591<>CALL    19592>>IF      19704<>CALL    19705>>IF      19738<>CALL    19739>>IF
     19760<>CALL    19761>>IF      19899<>CALL    19919<>CALL    19920>>IF      19927<>CALL    19928>>IF
     19938<>CALL    19939>>IF      19943<>CALL    19944>>IF      20212<>CALL    20213>>IF      20232<>CALL
     20233>>IF      20240<>CALL    20241>>IF      20245<>CALL    20246>>IF      20252<>CALL    20253>>IF
     20263<>CALL    20264>>IF      20278<>CALL    20279>>IF      20285<>CALL    20286>>IF      20294<>CALL
     20295>>IF      20323<>CALL    20324>>IF      20335<>CALL    20336>>IF      20374<>CALL    20375>>IF
     20379<>CALL    20380>>IF      20391<>CALL    20392>>IF      20572<>CALL    20573>>IF      20577<>CALL
     20578>>IF      20587<>CALL    20588>>IF      20592<>CALL    20593>>IF      20609<>CALL    20610>>IF
     20616<>CALL    20617>>IF      20627<>CALL    20628>>IF      20634<>CALL    20635>>IF      20653<>CALL
     20654>>IF      20658<>CALL    20659>>IF      20663<>CALL    20664>>IF      20682<>CALL    20683>>IF
     20689<>CALL    20690>>IF      20698<>CALL    20699>>IF      20703<>CALL    20704>>IF      20710<>CALL
     20711>>IF      20729<>CALL    20730>>IF      20736<>CALL    20737>>IF      20797<>CALL    20798>>IF
     20804<>CALL    20805>>IF      20816<>CALL    20817>>IF      20822<>CALL    20823>>IF      20848<>CALL
     20849>>IF      20941<>CALL    20942>>IF      20946<>CALL    20947>>IF      20951<>CALL    20952>>IF
     20980<>CALL    20981>>IF      21018<>CALL    21019>>IF      21028<>CALL    21029>>IF      21040<>CALL
     21041>>IF      21051<>CALL    21052>>IF      21056<>CALL    21057>>IF      21062<>CALL    21063>>IF
     21072<>CALL    21073>>IF      21147<>CALL    21148>>IF      21170<>CALL    21171>>IF      21175<>CALL
     21176>>IF      21407<>CALL    21408>>IF
NORELS_D
     21460**LABEL   20911--CALLALT
NOTIMPFPRG
     21457**LABEL   19697--GOTO    20210--GOTO    20328--GOTO    20358--GOTO    20696--GOTO    21002--GOTO
     21026--GOTO    21415--GOTO
NOT_IS
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:416  
        37**DCL     19710<<ASSIGN  19711<<ASSIGN  19731<>CALL
NOXCON
     21433**LABEL   19901--CALLALT 20353--CALLALT 21410--CALLALT
NOXOU
     19751**LABEL   19747--CALLALT 19748--CALLALT
NO_COMMANDS
        65**DCL     19595<<ASSIGN  19596>>DOWHILE 19599<<ASSIGN  19602>>IF
OPEN
        32**DCL     21077<<ASSIGN  21092<>CALL
OUT_DEV
      7388**DCL     20684<>CALL    20685>>ASSIGN  20808<<ASSIGN  20810>>ASSIGN  20811<<ASSIGN
OUT_DEV_SAVE
      7390**DCL     20685<<ASSIGN  20808>>ASSIGN  20810<<ASSIGN
PROMPT$CMD
      5862**DCL     20702--ASSIGN
PROMPT$CMD.TEXTC.SIZE
      5871**DCL     20706>>ASSIGN
PROMPT$CMD.TEXTC.TEXT
      5872**DCL     20705>>ASSIGN
PTFPRG$
        73**DCL     20985<<ASSIGN  20988<<ASSIGN
PTR_SAD.PT
        62**DCL     21033>>ASSIGN  21035>>ASSIGN
PTR_SAD.PT.LS
        64**DCL     21034<<ASSIGN
PTR_SAD_SKEL
        59**DCL        60--REDEF   21032<<ASSIGN
QUIT$CMD.FPRG
      6379**DCL     20742>>IF
QUIT$CMD.FPRG_RES
      6384**DCL     20750>>DOWHILE
RECOVERY_IN_PROGRESS
     21445**LABEL   20738--CALLALT 20973--CALLALT
REMOTEEOM
     19391**DCL     19355--DCLINIT
REPORT$CMD
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:417  
      6194**DCL     20821--ASSIGN
REPORT$CMD.COMPILER
      6198**DCL     20826>>ASSIGN
REPORT$CMD.COMPILER_SPF
      6199**DCL     20824>>IF
REPORT$CMD.DEFAULT
      6200**DCL     20834>>IF
REPORT$CMD.LINE
      6202**DCL     20842>>ASSIGN
REPORT$CMD.OFFSET
      6201**DCL     20841>>ASSIGN
REPORT$CMD.TYPE
      6203**DCL     20843>>ASSIGN
REPORT_STOPPED
     21495**PROC    20497--CALL    20555--CALL
RES
        67**DCL     19627<<ASSIGN  19629>>DOWHILE 19786<<ASSIGN  19847<>CALL    20002<<ASSIGN  20014<<ASSIGN
     20015--CALL    20048<>CALL    20151<<ASSIGN  20153<>CALL    20528<<ASSIGN  20535>>DOWHILE 21231<<ASSIGN
     21238>>DOWHILE
RESTORE_USE
     21515**PROC    21286--CALL
RES_SIZE
        68**DCL     19628<<ASSIGN  19629>>DOWHILE 19787<<ASSIGN  19847<>CALL    20003<<ASSIGN  20015<>CALL
     20016<<ASSIGN  20016>>ASSIGN  20048<>CALL    20152<<ASSIGN  20153<>CALL
RUM$CMD
      5927**DCL     20688--ASSIGN  20796--ASSIGN  20815--ASSIGN  20818<>CALL
RUM$CMD.CODE
      5936**DCL     20691>>ASSIGN
RUM$CMD.FID
      5946**DCL     20692<>CALL
RUM$CMD.FID.SIZE
      5947**DCL     20301>>ASSIGN
RUM$CMD.FID.TEXT
      5948**DCL     20301--ASSIGN
RUM$CMD.GOTUTS
      5931**DCL      5932--REDEF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:418  
RUM$CMD.UTS
      5940**DCL      5941--REDEF
SAD$
      7394**DCL     21032>>ASSIGN
SAD_OOPS
     21452**LABEL   21036--CALLALT
SCHEMA$CMD
      6399**DCL     20847--ASSIGN
SCHEMA$CMD.FID.SIZE
      6411**DCL     20874>>ASSIGN
SCHEMA$CMD.FID.TEXT
      6412**DCL     20874--ASSIGN
SCHEMA$CMD.GOTFID
      6405**DCL     20851>>IF      20907>>IF
SCHEMA$CMD.GOTPOS
      6404**DCL     20903>>IF
SCHEMA$CMD.POSITION
      6403**DCL     20904>>ASSIGN
SCHEMA1
     20936**LABEL   20908--GOTO
SETDCTX
     21469**PROC    20282--CALL    20684--CALL    20806--CALL
SHOW$CMD
      5875**DCL     20586--ASSIGN  20940--ASSIGN  20945--ASSIGN
SNAP_MESSAGE
     17669**DCL     21273<>CALL
STOP$CMD.FPRG
      6391**DCL     20982>>IF
STOP$CMD.FPRG_RES
      6396**DCL     20986>>DOWHILE
S_D.ALIB
      9637**DCL     19698>>IF      19873>>IF      20329>>IF      20393>>IF      20398>>IF      20403>>IF
     20423>>IF      20955>>IF      21401>>IF      21416>>IF
S_D.ANLZ
      9533**DCL     19765>>IF      20741>>IF      21215>>IF
S_D.ANLZ_FILE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:419  
      9597**DCL     21200>>IF
S_D.B$TREE$
      9553**DCL     19667>>IF      21196>>ASSIGN
S_D.BATCH
      9360**DCL     19853>>IF      20180>>IF      20196>>IF      20287>>IF
S_D.BF.DEFINED#
     10112**DCL     21339>>ASSIGN
S_D.BF.DEFINED@
     10100**DCL     21333>>ASSIGN
S_D.BF.GOT#
     10102**DCL     21338>>ASSIGN  21560<<ASSIGN
S_D.BF.GOT@
     10090**DCL     21332>>ASSIGN  21555<<ASSIGN
S_D.BF.HEAD#
     10108**DCL     21342>>ASSIGN  21563<<ASSIGN
S_D.BF.HEAD@
     10096**DCL     21336>>ASSIGN  21558<<ASSIGN
S_D.BF.HIGH#
     10110**DCL     21343>>ASSIGN  21564<<ASSIGN
S_D.BF.HIGH@
     10098**DCL     21337>>ASSIGN  21559<<ASSIGN
S_D.BF.NEXT#
     10104**DCL     21340>>ASSIGN  21561<<ASSIGN
S_D.BF.NEXT@
     10092**DCL     21334>>ASSIGN  21556<<ASSIGN
S_D.BF.RSPACE#
     10106**DCL     21341>>ASSIGN  21562<<ASSIGN
S_D.BF.RSPACE@
     10094**DCL     21335>>ASSIGN  21557<<ASSIGN
S_D.BYPASS
      9313**DCL     19921<<ASSIGN  19922>>ASSIGN
S_D.BYPASS_SAVE
      9021**DCL     19922<<ASSIGN
S_D.COPY
      9509**DCL     19929<<ASSIGN
S_D.CURRENT_CHANNEL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:420  
      9833**DCL      9835--REDEF   20943<<ASSIGN
S_D.CURRENT_FPRG_CONTEXT$
      9033**DCL     19768<<ASSIGN  19849>>ASSIGN  19850>>ASSIGN  19851>>ASSIGN  19852>>ASSIGN  19882<>CALL
     19886<>CALL    19904>>IF      19906>>IF      19912>>IF      19933<>CALL    19934>>ASSIGN  19947<<ASSIGN
     20049>>ASSIGN  20155>>ASSIGN  20217>>IF      20219>>IF      20225>>IF      20256>>IF      20308>>IF
     20310>>IF      20316>>IF      20359>>IF      20361>>IF      20367>>IF      20408>>IF      20411>>IF
     20417>>IF      20509<<ASSIGN  20543<<ASSIGN  20638>>IF      20640>>IF      20646>>IF      20714>>IF
     20716>>IF      20722>>IF      20773<<ASSIGN  20786<<ASSIGN  20972>>IF      21003>>IF      21005>>IF
     21011>>IF      21121<>CALL    21125<>CALL    21131>>IF      21144>>ASSIGN  21182>>IF      21182>>IF
     21246<<ASSIGN  21374<<ASSIGN  21384<>CALL    21388<>CALL    21503<<ASSIGN
S_D.D$
      8971**DCL     19590<<ASSIGN  19703<<ASSIGN  19737<<ASSIGN  19759<<ASSIGN  19898<<ASSIGN  19918<<ASSIGN
     19926<<ASSIGN  19937<<ASSIGN  19942<<ASSIGN  20211<<ASSIGN  20231<<ASSIGN  20239<<ASSIGN  20244<<ASSIGN
     20251<<ASSIGN  20262<<ASSIGN  20277<<ASSIGN  20284<<ASSIGN  20293<<ASSIGN  20322<<ASSIGN  20334<<ASSIGN
     20373<<ASSIGN  20378<<ASSIGN  20390<<ASSIGN  20571<<ASSIGN  20576<<ASSIGN  20586<<ASSIGN  20591<<ASSIGN
     20608<<ASSIGN  20615<<ASSIGN  20626<<ASSIGN  20633<<ASSIGN  20652<<ASSIGN  20657<<ASSIGN  20662<<ASSIGN
     20681<<ASSIGN  20688<<ASSIGN  20697<<ASSIGN  20702<<ASSIGN  20709<<ASSIGN  20728<<ASSIGN  20735<<ASSIGN
     20796<<ASSIGN  20803<<ASSIGN  20815<<ASSIGN  20821<<ASSIGN  20847<<ASSIGN  20940<<ASSIGN  20945<<ASSIGN
     20950<<ASSIGN  20979<<ASSIGN  21017<<ASSIGN  21027<<ASSIGN  21039<<ASSIGN  21050<<ASSIGN  21055<<ASSIGN
     21066<<ASSIGN  21110<<ASSIGN  21169<<ASSIGN  21174<<ASSIGN  21406<<ASSIGN  21421<<ASSIGN
S_D.DBGFEPDCB
      9585**DCL     19771>>IF      19774<<ASSIGN  19777--IF      19781>>ASSIGN  19784>>ASSIGN  19847<>CALL
     20054>>IF      20057<<ASSIGN  20060--IF      20064>>ASSIGN  20067>>ASSIGN  20098>>ASSIGN  20153<>CALL
     20159>>ASSIGN  20164>>ASSIGN  20169>>ASSIGN  20174>>ASSIGN
S_D.DEBUG
      9488**DCL     20237<<ASSIGN
S_D.DEBUGA
      8985**DCL      8987--REDEF
S_D.DEBUGF
      8987**DCL     20195<<ASSIGN
S_D.DEBUG_CMD
      9405**DCL     19766>>IF      19848<<ASSIGN  19945>>IF      20047<<ASSIGN  20154<<ASSIGN  20515>>IF
     20552>>IF      21223>>IF      21448>>IF
S_D.DEBUG_CMD_CONTEXT$
      9407**DCL     19766>>IF      19768>>ASSIGN  19849<<ASSIGN  19945>>IF      19947>>ASSIGN  20049<<ASSIGN
S_D.DEFINED#
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:421  
      9619**DCL     21299<<ASSIGN  21313<<ASSIGN  21326<<ASSIGN  21339<<ASSIGN
S_D.DEFINED@
      9609**DCL     21293<<ASSIGN  21307<<ASSIGN  21320<<ASSIGN  21333<<ASSIGN
S_D.DO$
      8936**DCL     19579>>ASSIGN  19590>>ASSIGN  19594>>ASSIGN  19596>>DOWHILE 19604>>DOCASE  19615>>DOINDEX
     19615>>DOINDEX 19618>>IF      19650>>IF      19681>>IF      19685>>IF      19688>>IF      19703>>ASSIGN
     19706>>IF      19709>>IF      19737>>ASSIGN  19742>>IF      19743>>ASSIGN  19754>>ASSIGN  19759>>ASSIGN
     19762>>IF      19786>>ASSIGN  19792>>ASSIGN  19804>>IF      19819>>ASSIGN  19819>>ASSIGN  19898>>ASSIGN
     19918>>ASSIGN  19926>>ASSIGN  19937>>ASSIGN  19942>>ASSIGN  19942>>ASSIGN  19950>>IF      19950>>IF
     19950>>IF      19957>>IF      19957>>IF      19966>>IF      19968>>ASSIGN  19969>>ASSIGN  19970>>ASSIGN
     19977>>ASSIGN  19977>>ASSIGN  20000>>ASSIGN  20000>>ASSIGN  20002>>ASSIGN  20003>>ASSIGN  20005>>IF
     20009>>ASSIGN  20011>>ASSIGN  20011>>ASSIGN  20013>>ASSIGN  20051>>IF      20077>>ASSIGN  20108>>IF
     20123>>ASSIGN  20123>>ASSIGN  20151>>ASSIGN  20152>>ASSIGN  20195>>ASSIGN  20211>>ASSIGN  20231>>ASSIGN
     20239>>ASSIGN  20244>>ASSIGN  20251>>ASSIGN  20262>>ASSIGN  20265>>IF      20265>>IF      20277>>ASSIGN
     20284>>ASSIGN  20293>>ASSIGN  20301>>ASSIGN  20301>>ASSIGN  20322>>ASSIGN  20334>>ASSIGN  20373>>ASSIGN
     20378>>ASSIGN  20381>>IF      20382>>ASSIGN  20383>>IF      20384>>ASSIGN  20390>>ASSIGN  20393>>IF
     20398>>IF      20398>>IF      20403>>IF      20408>>IF      20408>>IF      20423>>IF      20428>>IF
     20428>>IF      20435>>IF      20435>>IF      20443>>IF      20443>>IF      20447>>ASSIGN  20457>>IF
     20457>>IF      20461>>IF      20463>>ASSIGN  20467>>IF      20487>>ASSIGN  20488>>IF      20501>>IF
     20526>>IF      20528>>ASSIGN  20556>>IF      20571>>ASSIGN  20576>>ASSIGN  20586>>ASSIGN  20591>>ASSIGN
     20597>>ASSIGN  20608>>ASSIGN  20615>>ASSIGN  20626>>ASSIGN  20633>>ASSIGN  20636>>ASSIGN  20652>>ASSIGN
     20657>>ASSIGN  20662>>ASSIGN  20681>>ASSIGN  20688>>ASSIGN  20691>>ASSIGN  20692>>CALL    20697>>ASSIGN
     20702>>ASSIGN  20705>>ASSIGN  20706>>ASSIGN  20709>>ASSIGN  20728>>ASSIGN  20735>>ASSIGN  20742>>IF
     20750>>DOWHILE 20796>>ASSIGN  20803>>ASSIGN  20815>>ASSIGN  20818>>CALL    20821>>ASSIGN  20824>>IF
     20826>>ASSIGN  20834>>IF      20841>>ASSIGN  20842>>ASSIGN  20843>>ASSIGN  20847>>ASSIGN  20851>>IF
     20874>>ASSIGN  20874>>ASSIGN  20903>>IF      20904>>ASSIGN  20907>>IF      20940>>ASSIGN  20943>>ASSIGN
     20945>>ASSIGN  20950>>ASSIGN  20979>>ASSIGN  20982>>IF      20986>>DOWHILE 21017>>ASSIGN  21027>>ASSIGN
     21034>>ASSIGN  21037>>ASSIGN  21039>>ASSIGN  21042>>IF      21044>>ASSIGN  21050>>ASSIGN  21055>>ASSIGN
     21066>>ASSIGN  21074>>IF      21075>>ASSIGN  21076>>ASSIGN  21077>>ASSIGN  21078>>ASSIGN  21099>>IF
     21099>>IF      21110>>ASSIGN  21114>>IF      21114>>IF      21117>>IF      21119>>IF      21143>>IF
     21151>>IF      21160>>IF      21169>>ASSIGN  21174>>ASSIGN  21177>>ASSIGN  21192>>ASSIGN  21202>>ASSIGN
     21203>>ASSIGN  21207>>IF      21209>>ASSIGN  21221>>IF      21229>>IF      21231>>ASSIGN  21287>>ASSIGN
     21288>>IF      21290>>DOCASE  21406>>ASSIGN  21421>>ASSIGN  21473>>DOCASE
S_D.DO_CALLED
      9822**DCL     19578<<ASSIGN
S_D.DO_MESSAGE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:422  
     10002**DCL     19896>>UNWIND  21398>>UNWIND
S_D.DRTN$
      9438**DCL     19900>>ASSIGN  20352>>ASSIGN  20480>>ASSIGN  20761>>ASSIGN  20762>>ASSIGN  20763>>CALL
     20764>>ASSIGN  20765>>ASSIGN  21252>>ASSIGN  21253>>ASSIGN  21254>>CALL    21257>>ASSIGN  21258>>ASSIGN
     21259>>ASSIGN  21409>>ASSIGN  21433>>ASSIGN  21435>>ASSIGN  21437>>IF      21439>>ASSIGN  21440>>ASSIGN
     21441>>ASSIGN
S_D.E$XIT
      9643**DCL     20354<<ASSIGN
S_D.ECHO
      9511**DCL     20280<<ASSIGN
S_D.EDEF$
      9329**DCL     19747>>CALL
S_D.EFMT_DEFAULT
      9501**DCL     20384<<ASSIGN
S_D.EIS
      9943**DCL      9972--REDEF
S_D.ENTRYCMD$
      9685**DCL     19655<<ASSIGN
S_D.EOM
      9525**DCL     19853>>IF      19858<<ASSIGN  20180>>IF      20185<<ASSIGN  20196>>IF      20201<<ASSIGN
     20290<<ASSIGN
S_D.ERRACCT
      9991**DCL     20299--ASSIGN
S_D.ERRFID
      9987**DCL     20298--ASSIGN
S_D.ERROR
      8914**DCL     19582<<ASSIGN  19587<<ASSIGN  19606<<ASSIGN  19608<<ASSIGN  19610<<ASSIGN  19642<<ASSIGN
     19700<<ASSIGN  19755<<ASSIGN  19870<<ASSIGN  19875<<ASSIGN  19892<<ASSIGN  19908<<ASSIGN  19914<<ASSIGN
     19988<<ASSIGN  19993<<ASSIGN  20093<<ASSIGN  20095<<ASSIGN  20221<<ASSIGN  20227<<ASSIGN  20258<<ASSIGN
     20273<<ASSIGN  20312<<ASSIGN  20318<<ASSIGN  20331<<ASSIGN  20349<<ASSIGN  20363<<ASSIGN  20369<<ASSIGN
     20386<<ASSIGN  20395<<ASSIGN  20400<<ASSIGN  20405<<ASSIGN  20413<<ASSIGN  20419<<ASSIGN  20425<<ASSIGN
     20432<<ASSIGN  20439<<ASSIGN  20470<<ASSIGN  20531<<ASSIGN  20539<<ASSIGN  20548<<ASSIGN  20566<<ASSIGN
     20642<<ASSIGN  20648<<ASSIGN  20667<<ASSIGN  20670<<ASSIGN  20673<<ASSIGN  20676<<ASSIGN  20718<<ASSIGN
     20724<<ASSIGN  20746<<ASSIGN  20755<<ASSIGN  20856<<ASSIGN  20958<<ASSIGN  20963<<ASSIGN  20975<<ASSIGN
     20992<<ASSIGN  21007<<ASSIGN  21013<<ASSIGN  21022<<ASSIGN  21082<<ASSIGN  21086<<ASSIGN  21103<<ASSIGN
     21217<<ASSIGN  21234<<ASSIGN  21242<<ASSIGN  21269<<ASSIGN  21356<<ASSIGN  21377<<ASSIGN  21394<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:423  
     21403<<ASSIGN  21418<<ASSIGN  21425<<ASSIGN  21430>>IF      21453<<ASSIGN  21454<<ASSIGN  21457<<ASSIGN
     21460<<ASSIGN  21463<<ASSIGN
S_D.ERROR_SYM$
      8938**DCL     19754<<ASSIGN
S_D.ERRPASS
      9993**DCL     20300--ASSIGN
S_D.FAULT
      8934**DCL     21277<<ASSIGN
S_D.FAULTCMD$
      8900**DCL     19654<<ASSIGN  20464<<ASSIGN  20481<<ASSIGN
S_D.FD.DEFINED#
     10087**DCL     21326>>ASSIGN
S_D.FD.DEFINED@
     10075**DCL     21320>>ASSIGN
S_D.FD.GOT#
     10077**DCL     21325>>ASSIGN  21549<<ASSIGN
S_D.FD.GOT@
     10065**DCL     21319>>ASSIGN  21544<<ASSIGN
S_D.FD.HEAD#
     10083**DCL     21329>>ASSIGN  21552<<ASSIGN
S_D.FD.HEAD@
     10071**DCL     21323>>ASSIGN  21547<<ASSIGN
S_D.FD.HIGH#
     10085**DCL     21330>>ASSIGN  21553<<ASSIGN
S_D.FD.HIGH@
     10073**DCL     21324>>ASSIGN  21548<<ASSIGN
S_D.FD.NEXT#
     10079**DCL     21327>>ASSIGN  21550<<ASSIGN
S_D.FD.NEXT@
     10067**DCL     21321>>ASSIGN  21545<<ASSIGN
S_D.FD.RSPACE#
     10081**DCL     21328>>ASSIGN  21551<<ASSIGN
S_D.FD.RSPACE@
     10069**DCL     21322>>ASSIGN  21546<<ASSIGN
S_D.FIRST_TIME
      9926**DCL     19865<<ASSIGN  20192<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:424  
S_D.FIXCOM.CMD
      9341**DCL     19598>>IF      19616>>IF      19660<>CALL    19663>>IF      19684>>IF
S_D.FIXCOM.FAI
      9351**DCL     19646>>ASSIGN  19665>>ASSIGN
S_D.FIXCOM.FPRG
      9346**DCL     19621>>IF      19657>>IF
S_D.FIXCOM.FPRG_RES
      9352**DCL     19627>>ASSIGN
S_D.FIXCOM.FPRG_RES_SIZE
      9353**DCL     19628>>ASSIGN
S_D.FIXCOM.INACTIVE
      9342**DCL     19620<<ASSIGN  19662<<ASSIGN  19674>>IF
S_D.FIXCOM.NOT_IN
      9344**DCL     19668<<ASSIGN  19670<<ASSIGN
S_D.FIXCOM.SILENT
      9343**DCL     19682<<ASSIGN  19683<<ASSIGN
S_D.FMT_DEFAULT
      9169**DCL     20382<<ASSIGN
S_D.FPRG
      9031**DCL     19904>>IF      19912>>IF      20217>>IF      20225>>IF      20256>>IF      20308>>IF
     20316>>IF      20359>>IF      20367>>IF      20408>>IF      20417>>IF      20638>>IF      20646>>IF
     20714>>IF      20722>>IF      21003>>IF      21011>>IF      21182>>IF      21189>>IF
S_D.FPRG_CONTEXT$
      9025**DCL     19624>>ASSIGN  20428>>IF      20435>>IF      20457>>IF      20495>>IF      20501>>IF
     20504>>ASSIGN  20518>>ASSIGN  20529>>IF      20534>>ASSIGN  20744>>IF      20749>>ASSIGN  20778>>IF
     20785>>DOWHILE 20786>>ASSIGN  20787<>CALL    20788>>ASSIGN  20984>>ASSIGN  21232>>IF      21237>>ASSIGN
     21354>>IF      21362>>ASSIGN  21498>>ASSIGN
S_D.GHOST1
      9140**DCL     19712>>IF
S_D.GOIC
      8894**DCL     20477>>ASSIGN
S_D.GOT#
      9611**DCL     21298<<ASSIGN  21312<<ASSIGN  21325<<ASSIGN  21338<<ASSIGN  21526>>ASSIGN  21538>>ASSIGN
     21549>>ASSIGN  21560>>ASSIGN
S_D.GOT@
      9601**DCL     21292<<ASSIGN  21306<<ASSIGN  21319<<ASSIGN  21332<<ASSIGN  21521>>ASSIGN  21533>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:425  
     21544>>ASSIGN  21555>>ASSIGN
S_D.GOTRAPPOS
      9918**DCL     20446<<ASSIGN  20449<<ASSIGN
S_D.GOTRAP_POSITION
      9920**DCL     20447<<ASSIGN
S_D.HEAD#
      9617**DCL     21302<<ASSIGN  21316<<ASSIGN  21329<<ASSIGN  21342<<ASSIGN  21529>>ASSIGN  21541>>ASSIGN
     21552>>ASSIGN  21563>>ASSIGN
S_D.HEAD@
      9607**DCL     21296<<ASSIGN  21310<<ASSIGN  21323<<ASSIGN  21336<<ASSIGN  21524>>ASSIGN  21536>>ASSIGN
     21547>>ASSIGN  21558>>ASSIGN
S_D.HELPING
      9736**DCL     19581<<ASSIGN
S_D.HIGH#
      9641**DCL     21303<<ASSIGN  21317<<ASSIGN  21330<<ASSIGN  21343<<ASSIGN  21530>>ASSIGN  21542>>ASSIGN
     21553>>ASSIGN  21564>>ASSIGN
S_D.HIGH@
      9635**DCL     21297<<ASSIGN  21311<<ASSIGN  21324<<ASSIGN  21337<<ASSIGN  21525>>ASSIGN  21537>>ASSIGN
     21548>>ASSIGN  21559>>ASSIGN
S_D.HOST_MESSAGE_BUF.C
      9893**DCL     20074<<ASSIGN  20075--ASSIGN  20079--ASSIGN  20085--ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      9876**DCL      9877--REDEF    9891--REDEF
S_D.IXFIX
      8918**DCL     19652>>IF
S_D.JDE
      9490**DCL      9491--REDEF   21138<<ASSIGN  21140<<ASSIGN
S_D.K$EEP.TYPE
      9363**DCL     20597<<ASSIGN  20598>>IF      20598>>IF      20598>>IF
S_D.KILL1
      9003**DCL     19659<<ASSIGN
S_D.L$.VALUE
      9043**DCL      9049--REDEF    9057--REDEF    9060--REDEF    9063--REDEF    9066--REDEF
S_D.L$.VALUE.L
      9044**DCL      9045--REDEF    9046--REDEF
S_D.L6_CACHE
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:426  
      9728**DCL     19924<<ASSIGN
S_D.L6_MESSAGE_BUF
      9897**DCL      9899--REDEF
S_D.LAST_ERROR
      9708**DCL     19706>>IF
S_D.LINK_ENTRY
      9645**DCL     20338>>IF
S_D.LMDCB
      9563**DCL     19829<<ASSIGN  19839<<ASSIGN  19841>>ASSIGN  19844--IF      20133<<ASSIGN  20143<<ASSIGN
     20145>>ASSIGN  20148--IF      20883--ASSIGN  20885>>ASSIGN  20895<<ASSIGN  20897>>ASSIGN  20899--IF
     20914<<ASSIGN  20916<<ASSIGN  20917<<ASSIGN
S_D.MLCT
      9840**DCL     20629>>IF
S_D.MONENT.DEFINED#
     10037**DCL     21299>>ASSIGN
S_D.MONENT.DEFINED@
     10025**DCL     21293>>ASSIGN
S_D.MONENT.GOT#
     10027**DCL     21298>>ASSIGN  21526<<ASSIGN
S_D.MONENT.GOT@
     10015**DCL     21292>>ASSIGN  21521<<ASSIGN
S_D.MONENT.HEAD#
     10033**DCL     21302>>ASSIGN  21529<<ASSIGN
S_D.MONENT.HEAD@
     10021**DCL     21296>>ASSIGN  21524<<ASSIGN
S_D.MONENT.HIGH#
     10035**DCL     21303>>ASSIGN  21530<<ASSIGN
S_D.MONENT.HIGH@
     10023**DCL     21297>>ASSIGN  21525<<ASSIGN
S_D.MONENT.NEXT#
     10029**DCL     21300>>ASSIGN  21527<<ASSIGN
S_D.MONENT.NEXT@
     10017**DCL     21294>>ASSIGN  21522<<ASSIGN
S_D.MONENT.RSPACE#
     10031**DCL     21301>>ASSIGN  21528<<ASSIGN
S_D.MONENT.RSPACE@
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:427  
     10019**DCL     21295>>ASSIGN  21523<<ASSIGN
S_D.MONIS.DEFINED#
     10062**DCL     21313>>ASSIGN
S_D.MONIS.DEFINED@
     10050**DCL     21307>>ASSIGN
S_D.MONIS.GOT#
     10052**DCL     21312>>ASSIGN  21538<<ASSIGN
S_D.MONIS.GOT@
     10040**DCL     21306>>ASSIGN  21533<<ASSIGN
S_D.MONIS.HEAD#
     10058**DCL     21316>>ASSIGN  21541<<ASSIGN
S_D.MONIS.HEAD@
     10046**DCL     21310>>ASSIGN  21536<<ASSIGN
S_D.MONIS.HIGH#
     10060**DCL     21317>>ASSIGN  21542<<ASSIGN
S_D.MONIS.HIGH@
     10048**DCL     21311>>ASSIGN  21537<<ASSIGN
S_D.MONIS.NEXT#
     10054**DCL     21314>>ASSIGN  21539<<ASSIGN
S_D.MONIS.NEXT@
     10042**DCL     21308>>ASSIGN  21534<<ASSIGN
S_D.MONIS.RSPACE#
     10056**DCL     21315>>ASSIGN  21540<<ASSIGN
S_D.MONIS.RSPACE@
     10044**DCL     21309>>ASSIGN  21535<<ASSIGN
S_D.MTREE$
      9543**DCL     21347>>ASSIGN
S_D.NEXT#
      9613**DCL     21300<<ASSIGN  21314<<ASSIGN  21327<<ASSIGN  21340<<ASSIGN  21527>>ASSIGN  21539>>ASSIGN
     21550>>ASSIGN  21561>>ASSIGN
S_D.NEXT@
      9603**DCL     21294<<ASSIGN  21308<<ASSIGN  21321<<ASSIGN  21334<<ASSIGN  21522>>ASSIGN  21534>>ASSIGN
     21545>>ASSIGN  21556>>ASSIGN
S_D.NODE
      9442**DCL     21192<<ASSIGN  21195>>ASSIGN  21196>>ASSIGN  21348<<ASSIGN
S_D.ONE_TO_TWO.EXEC_DOMAIN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:428  
      9908**DCL     19696>>IF      19878>>IF      20209>>IF      20267>>DOCASE  20327>>IF      20357>>IF
     20579>>IF      20604>>IF      20611>>IF      20695>>IF      20731>>IF      20918>>IF      20966>>IF
     21001>>IF      21025>>IF      21058>>IF      21067>>IF      21111>>IF      21380>>IF      21414>>IF
S_D.OUTPUT
      9863**DCL      9865--REDEF   19714--ASSIGN  19715<<ASSIGN  19719<<ASSIGN  19723<<ASSIGN  19724<<CALLBLT
     19727<<ASSIGN
S_D.OVERLAID
      9547**DCL     19666>>IF
S_D.PADDR
      9549**DCL     20452<<ASSIGN
S_D.PATCH
      9529**DCL     20450>>IF      20451<<ASSIGN  21479>>IF
S_D.PROMPT_SIZE
      9659**DCL     20623<<ASSIGN  20707<<ASSIGN
S_D.PROTECT
      9740**DCL     20712<<ASSIGN
S_D.RANGE
      9311**DCL     20636<<ASSIGN
S_D.REMOTE_MSG.FNCC
      9882**DCL      9883--REDEF
S_D.REMOTE_MSG.STXC
      9878**DCL      9879--REDEF
S_D.REMOTE_MSG.SUBFNCC
      9886**DCL      9887--REDEF
S_D.REPORT_FLAGS.LINE
      9703**DCL     20837<<ASSIGN  20842<<ASSIGN
S_D.REPORT_FLAGS.OFFSET
      9702**DCL     20836<<ASSIGN  20841<<ASSIGN
S_D.REPORT_FLAGS.TYPE
      9704**DCL     20838<<ASSIGN  20843<<ASSIGN
S_D.RETURNN
      8912**DCL     20476<<ASSIGN
S_D.RSPACE#
      9615**DCL     21301<<ASSIGN  21315<<ASSIGN  21328<<ASSIGN  21341<<ASSIGN  21528>>ASSIGN  21540>>ASSIGN
     21551>>ASSIGN  21562>>ASSIGN
S_D.RSPACE@
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:429  
      9605**DCL     21295<<ASSIGN  21309<<ASSIGN  21322<<ASSIGN  21335<<ASSIGN  21523>>ASSIGN  21535>>ASSIGN
     21546>>ASSIGN  21557>>ASSIGN
S_D.RUM
      9531**DCL     19764>>IF      20740>>IF      20854>>IF      20915>>IF      20923>>IF
S_D.RUMDCB
      9567**DCL     20916>>ASSIGN
S_D.RUM_FEP
     10013**DCL     19845<<ASSIGN  19846<<ASSIGN  20149<<ASSIGN  20150<<ASSIGN  20900<<ASSIGN  20901<<ASSIGN
S_D.RUM_FEP_USE
      9781**DCL     21287<<ASSIGN  21517>>IF      21519>>DOCASE
S_D.RUM_TOTAL_ERRORS
      9114**DCL     19717>>IF      19724>>CALLBLT
S_D.S$TEP.ACTIVE
      9785**DCL     19732>>IF      20492>>IF
S_D.S$TEP.CUR_COUNT
      9809**DCL     20489<<ASSIGN
S_D.SAD
      9742**DCL     21037<<ASSIGN
S_D.SAVEIC
      8896**DCL     20463<<ASSIGN  20477<<ASSIGN  20906>>ASSIGN  21349>>ASSIGN
S_D.SCHEMA
      8983**DCL     20850<<ASSIGN
S_D.SCHEMADCB
      9440**DCL     19825>>IF      19828<<ASSIGN  19832--IF      19836>>ASSIGN  19839>>ASSIGN  20129>>IF
     20132<<ASSIGN  20136--IF      20140>>ASSIGN  20143>>ASSIGN  20879>>IF      20885<<ASSIGN  20888--IF
     20892>>ASSIGN  20895>>ASSIGN  20913>>IF      20914>>ASSIGN
S_D.SCHSEG$
      9317**DCL     20909>>ASSIGN  20912<<ASSIGN
S_D.SCHSEG_BEGIN$
      8969**DCL     20909>>ASSIGN  20912>>ASSIGN
S_D.SCREECH_IC
      9734**DCL     21272<<REMEMBR
S_D.STAND_ALONE
      9358**DCL     19853>>IF      20180>>IF      20196>>IF
S_D.STATUS
      9985**DCL     20953<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:430  
S_D.STEP
      9167**DCL     19583<<ASSIGN
S_D.STEP_L6
      9779**DCL     19895<<ASSIGN  20442<<ASSIGN  21397<<ASSIGN
S_D.STOP
      8979**DCL     19584<<ASSIGN  21445<<ASSIGN
S_D.SV
      8942**DCL      8963--REDEF
S_D.SV.DELENT
      8950**DCL     20468>>IF
S_D.SYNTAX
      9714**DCL     21043<<ASSIGN  21044<<ASSIGN  21045>>ASSIGN
S_D.SYNTAX_DEFAULT
      9738**DCL     21043>>ASSIGN
S_D.TR$INFO.ACTIVE
      9369**DCL     19685>>IF      19688>>IF
S_D.TREE$
      9541**DCL     21194<<ASSIGN  21347<<ASSIGN
S_D.UNODE.CURRENT
      9537**DCL     21348>>ASSIGN
S_D.UNODE.USENODE
      9539**DCL     21195<<ASSIGN
S_D.UPROMPT
      9669**DCL     20705<<ASSIGN
S_D.UPROMPT_SIZE
      9671**DCL     20706<<ASSIGN
S_D.UTREE$
      9545**DCL     21194>>ASSIGN
S_D.VARCOM$
      9354**DCL     19646>>ASSIGN  19665>>ASSIGN
S_D.XOU_NAME
      9307**DCL     19743<<ASSIGN  19744--CALL
S_D.XSCH
      9219**DCL     19740<<ASSIGN
S_D.XSCH.OK
      9221**DCL     19752>>IF
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:431  
S_D$
     10194**DCL      8890--IMP-PTR 19578>>ASSIGN  19579>>ASSIGN  19581>>ASSIGN  19582>>ASSIGN  19583>>ASSIGN
     19584>>ASSIGN  19587>>ASSIGN  19590>>ASSIGN  19590>>ASSIGN  19594>>ASSIGN  19596>>DOWHILE 19598>>IF
     19604>>DOCASE  19606>>ASSIGN  19608>>ASSIGN  19610>>ASSIGN  19615>>DOINDEX 19615>>DOINDEX 19616>>IF
     19618>>IF      19620>>ASSIGN  19621>>IF      19624>>ASSIGN  19627>>ASSIGN  19628>>ASSIGN  19642>>ASSIGN
     19646>>ASSIGN  19646>>ASSIGN  19650>>IF      19652>>IF      19654>>ASSIGN  19655>>ASSIGN  19657>>IF
     19659>>ASSIGN  19660>>CALL    19662>>ASSIGN  19663>>IF      19665>>ASSIGN  19665>>ASSIGN  19666>>IF
     19667>>IF      19668>>ASSIGN  19670>>ASSIGN  19674>>IF      19681>>IF      19682>>ASSIGN  19683>>ASSIGN
     19684>>IF      19685>>IF      19685>>IF      19688>>IF      19688>>IF      19696>>IF      19698>>IF
     19700>>ASSIGN  19703>>ASSIGN  19703>>ASSIGN  19706>>IF      19706>>IF      19709>>IF      19712>>IF
     19714>>ASSIGN  19715>>ASSIGN  19717>>IF      19719>>ASSIGN  19723>>ASSIGN  19724>>CALLBLT 19724>>CALLBLT
     19727>>ASSIGN  19732>>IF      19737>>ASSIGN  19737>>ASSIGN  19740>>ASSIGN  19742>>IF      19743>>ASSIGN
     19743>>ASSIGN  19744>>CALL    19747>>CALL    19752>>IF      19754>>ASSIGN  19754>>ASSIGN  19755>>ASSIGN
     19759>>ASSIGN  19759>>ASSIGN  19762>>IF      19764>>IF      19765>>IF      19766>>IF      19766>>IF
     19768>>ASSIGN  19768>>ASSIGN  19771>>IF      19774>>ASSIGN  19777>>IF      19781>>ASSIGN  19784>>ASSIGN
     19786>>ASSIGN  19792>>ASSIGN  19804>>IF      19819>>ASSIGN  19819>>ASSIGN  19825>>IF      19828>>ASSIGN
     19829>>ASSIGN  19832>>IF      19836>>ASSIGN  19839>>ASSIGN  19839>>ASSIGN  19841>>ASSIGN  19844>>IF
     19845>>ASSIGN  19846>>ASSIGN  19847>>CALL    19848>>ASSIGN  19849>>ASSIGN  19849>>ASSIGN  19850>>ASSIGN
     19851>>ASSIGN  19852>>ASSIGN  19853>>IF      19853>>IF      19853>>IF      19858>>ASSIGN  19865>>ASSIGN
     19870>>ASSIGN  19873>>IF      19875>>ASSIGN  19878>>IF      19882>>CALL    19886>>CALL    19892>>ASSIGN
     19895>>ASSIGN  19896>>UNWIND  19898>>ASSIGN  19898>>ASSIGN  19900>>ASSIGN  19904>>IF      19904>>IF
     19906>>IF      19908>>ASSIGN  19912>>IF      19912>>IF      19914>>ASSIGN  19918>>ASSIGN  19918>>ASSIGN
     19921>>ASSIGN  19922>>ASSIGN  19922>>ASSIGN  19924>>ASSIGN  19926>>ASSIGN  19926>>ASSIGN  19929>>ASSIGN
     19933>>CALL    19934>>ASSIGN  19937>>ASSIGN  19937>>ASSIGN  19942>>ASSIGN  19942>>ASSIGN  19942>>ASSIGN
     19945>>IF      19945>>IF      19947>>ASSIGN  19947>>ASSIGN  19950>>IF      19950>>IF      19950>>IF
     19957>>IF      19957>>IF      19966>>IF      19968>>ASSIGN  19969>>ASSIGN  19970>>ASSIGN  19977>>ASSIGN
     19977>>ASSIGN  19988>>ASSIGN  19993>>ASSIGN  20000>>ASSIGN  20000>>ASSIGN  20002>>ASSIGN  20003>>ASSIGN
     20005>>IF      20009>>ASSIGN  20011>>ASSIGN  20011>>ASSIGN  20013>>ASSIGN  20047>>ASSIGN  20049>>ASSIGN
     20049>>ASSIGN  20051>>IF      20054>>IF      20057>>ASSIGN  20060>>IF      20064>>ASSIGN  20067>>ASSIGN
     20074>>ASSIGN  20075>>ASSIGN  20077>>ASSIGN  20079>>ASSIGN  20085>>ASSIGN  20093>>ASSIGN  20095>>ASSIGN
     20098>>ASSIGN  20108>>IF      20123>>ASSIGN  20123>>ASSIGN  20129>>IF      20132>>ASSIGN  20133>>ASSIGN
     20136>>IF      20140>>ASSIGN  20143>>ASSIGN  20143>>ASSIGN  20145>>ASSIGN  20148>>IF      20149>>ASSIGN
     20150>>ASSIGN  20151>>ASSIGN  20152>>ASSIGN  20153>>CALL    20154>>ASSIGN  20155>>ASSIGN  20159>>ASSIGN
     20164>>ASSIGN  20169>>ASSIGN  20174>>ASSIGN  20180>>IF      20180>>IF      20180>>IF      20185>>ASSIGN
     20192>>ASSIGN  20195>>ASSIGN  20195>>ASSIGN  20196>>IF      20196>>IF      20196>>IF      20201>>ASSIGN
     20209>>IF      20211>>ASSIGN  20211>>ASSIGN  20217>>IF      20217>>IF      20219>>IF      20221>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:432  
     20225>>IF      20225>>IF      20227>>ASSIGN  20231>>ASSIGN  20231>>ASSIGN  20237>>ASSIGN  20239>>ASSIGN
     20239>>ASSIGN  20244>>ASSIGN  20244>>ASSIGN  20251>>ASSIGN  20251>>ASSIGN  20256>>IF      20256>>IF
     20258>>ASSIGN  20262>>ASSIGN  20262>>ASSIGN  20265>>IF      20265>>IF      20267>>DOCASE  20273>>ASSIGN
     20277>>ASSIGN  20277>>ASSIGN  20280>>ASSIGN  20284>>ASSIGN  20284>>ASSIGN  20287>>IF      20290>>ASSIGN
     20293>>ASSIGN  20293>>ASSIGN  20298>>ASSIGN  20299>>ASSIGN  20300>>ASSIGN  20301>>ASSIGN  20301>>ASSIGN
     20308>>IF      20308>>IF      20310>>IF      20312>>ASSIGN  20316>>IF      20316>>IF      20318>>ASSIGN
     20322>>ASSIGN  20322>>ASSIGN  20327>>IF      20329>>IF      20331>>ASSIGN  20334>>ASSIGN  20334>>ASSIGN
     20338>>IF      20349>>ASSIGN  20352>>ASSIGN  20354>>ASSIGN  20357>>IF      20359>>IF      20359>>IF
     20361>>IF      20363>>ASSIGN  20367>>IF      20367>>IF      20369>>ASSIGN  20373>>ASSIGN  20373>>ASSIGN
     20378>>ASSIGN  20378>>ASSIGN  20381>>IF      20382>>ASSIGN  20382>>ASSIGN  20383>>IF      20384>>ASSIGN
     20384>>ASSIGN  20386>>ASSIGN  20390>>ASSIGN  20390>>ASSIGN  20393>>IF      20393>>IF      20395>>ASSIGN
     20398>>IF      20398>>IF      20398>>IF      20400>>ASSIGN  20403>>IF      20403>>IF      20405>>ASSIGN
     20408>>IF      20408>>IF      20408>>IF      20408>>IF      20411>>IF      20413>>ASSIGN  20417>>IF
     20417>>IF      20419>>ASSIGN  20423>>IF      20423>>IF      20425>>ASSIGN  20428>>IF      20428>>IF
     20428>>IF      20432>>ASSIGN  20435>>IF      20435>>IF      20435>>IF      20439>>ASSIGN  20442>>ASSIGN
     20443>>IF      20443>>IF      20446>>ASSIGN  20447>>ASSIGN  20447>>ASSIGN  20449>>ASSIGN  20450>>IF
     20451>>ASSIGN  20452>>ASSIGN  20457>>IF      20457>>IF      20457>>IF      20461>>IF      20463>>ASSIGN
     20463>>ASSIGN  20464>>ASSIGN  20467>>IF      20468>>IF      20470>>ASSIGN  20476>>ASSIGN  20477>>ASSIGN
     20477>>ASSIGN  20480>>ASSIGN  20481>>ASSIGN  20487>>ASSIGN  20488>>IF      20489>>ASSIGN  20492>>IF
     20495>>IF      20501>>IF      20501>>IF      20504>>ASSIGN  20509>>ASSIGN  20515>>IF      20518>>ASSIGN
     20526>>IF      20528>>ASSIGN  20529>>IF      20531>>ASSIGN  20534>>ASSIGN  20539>>ASSIGN  20543>>ASSIGN
     20548>>ASSIGN  20552>>IF      20556>>IF      20566>>ASSIGN  20571>>ASSIGN  20571>>ASSIGN  20576>>ASSIGN
     20576>>ASSIGN  20579>>IF      20586>>ASSIGN  20586>>ASSIGN  20591>>ASSIGN  20591>>ASSIGN  20597>>ASSIGN
     20597>>ASSIGN  20598>>IF      20598>>IF      20598>>IF      20604>>IF      20608>>ASSIGN  20608>>ASSIGN
     20611>>IF      20615>>ASSIGN  20615>>ASSIGN  20623>>ASSIGN  20626>>ASSIGN  20626>>ASSIGN  20629>>IF
     20633>>ASSIGN  20633>>ASSIGN  20636>>ASSIGN  20636>>ASSIGN  20638>>IF      20638>>IF      20640>>IF
     20642>>ASSIGN  20646>>IF      20646>>IF      20648>>ASSIGN  20652>>ASSIGN  20652>>ASSIGN  20657>>ASSIGN
     20657>>ASSIGN  20662>>ASSIGN  20662>>ASSIGN  20667>>ASSIGN  20670>>ASSIGN  20673>>ASSIGN  20676>>ASSIGN
     20681>>ASSIGN  20681>>ASSIGN  20688>>ASSIGN  20688>>ASSIGN  20691>>ASSIGN  20692>>CALL    20695>>IF
     20697>>ASSIGN  20697>>ASSIGN  20702>>ASSIGN  20702>>ASSIGN  20705>>ASSIGN  20705>>ASSIGN  20706>>ASSIGN
     20706>>ASSIGN  20707>>ASSIGN  20709>>ASSIGN  20709>>ASSIGN  20712>>ASSIGN  20714>>IF      20714>>IF
     20716>>IF      20718>>ASSIGN  20722>>IF      20722>>IF      20724>>ASSIGN  20728>>ASSIGN  20728>>ASSIGN
     20731>>IF      20735>>ASSIGN  20735>>ASSIGN  20740>>IF      20741>>IF      20742>>IF      20744>>IF
     20746>>ASSIGN  20749>>ASSIGN  20750>>DOWHILE 20755>>ASSIGN  20761>>ASSIGN  20762>>ASSIGN  20763>>CALL
     20764>>ASSIGN  20765>>ASSIGN  20773>>ASSIGN  20778>>IF      20785>>DOWHILE 20786>>ASSIGN  20786>>ASSIGN
     20787>>CALL    20788>>ASSIGN  20796>>ASSIGN  20796>>ASSIGN  20803>>ASSIGN  20803>>ASSIGN  20815>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:433  
     20815>>ASSIGN  20818>>CALL    20821>>ASSIGN  20821>>ASSIGN  20824>>IF      20826>>ASSIGN  20834>>IF
     20836>>ASSIGN  20837>>ASSIGN  20838>>ASSIGN  20841>>ASSIGN  20841>>ASSIGN  20842>>ASSIGN  20842>>ASSIGN
     20843>>ASSIGN  20843>>ASSIGN  20847>>ASSIGN  20847>>ASSIGN  20850>>ASSIGN  20851>>IF      20854>>IF
     20856>>ASSIGN  20874>>ASSIGN  20874>>ASSIGN  20879>>IF      20883>>ASSIGN  20885>>ASSIGN  20885>>ASSIGN
     20888>>IF      20892>>ASSIGN  20895>>ASSIGN  20895>>ASSIGN  20897>>ASSIGN  20899>>IF      20900>>ASSIGN
     20901>>ASSIGN  20903>>IF      20904>>ASSIGN  20906>>ASSIGN  20907>>IF      20909>>ASSIGN  20909>>ASSIGN
     20912>>ASSIGN  20912>>ASSIGN  20913>>IF      20914>>ASSIGN  20914>>ASSIGN  20915>>IF      20916>>ASSIGN
     20916>>ASSIGN  20917>>ASSIGN  20918>>IF      20923>>IF      20940>>ASSIGN  20940>>ASSIGN  20943>>ASSIGN
     20943>>ASSIGN  20945>>ASSIGN  20945>>ASSIGN  20950>>ASSIGN  20950>>ASSIGN  20953>>ASSIGN  20955>>IF
     20958>>ASSIGN  20963>>ASSIGN  20966>>IF      20972>>IF      20975>>ASSIGN  20979>>ASSIGN  20979>>ASSIGN
     20982>>IF      20984>>ASSIGN  20986>>DOWHILE 20992>>ASSIGN  21001>>IF      21003>>IF      21003>>IF
     21005>>IF      21007>>ASSIGN  21011>>IF      21011>>IF      21013>>ASSIGN  21017>>ASSIGN  21017>>ASSIGN
     21022>>ASSIGN  21025>>IF      21027>>ASSIGN  21027>>ASSIGN  21034>>ASSIGN  21037>>ASSIGN  21037>>ASSIGN
     21039>>ASSIGN  21039>>ASSIGN  21042>>IF      21043>>ASSIGN  21043>>ASSIGN  21044>>ASSIGN  21044>>ASSIGN
     21045>>ASSIGN  21050>>ASSIGN  21050>>ASSIGN  21055>>ASSIGN  21055>>ASSIGN  21058>>IF      21066>>ASSIGN
     21066>>ASSIGN  21067>>IF      21074>>IF      21075>>ASSIGN  21076>>ASSIGN  21077>>ASSIGN  21078>>ASSIGN
     21082>>ASSIGN  21086>>ASSIGN  21099>>IF      21099>>IF      21103>>ASSIGN  21110>>ASSIGN  21110>>ASSIGN
     21111>>IF      21114>>IF      21114>>IF      21117>>IF      21119>>IF      21121>>CALL    21125>>CALL
     21131>>IF      21138>>ASSIGN  21140>>ASSIGN  21143>>IF      21144>>ASSIGN  21151>>IF      21160>>IF
     21169>>ASSIGN  21169>>ASSIGN  21174>>ASSIGN  21174>>ASSIGN  21177>>ASSIGN  21182>>IF      21182>>IF
     21182>>IF      21189>>IF      21192>>ASSIGN  21192>>ASSIGN  21194>>ASSIGN  21194>>ASSIGN  21195>>ASSIGN
     21195>>ASSIGN  21196>>ASSIGN  21196>>ASSIGN  21200>>IF      21202>>ASSIGN  21203>>ASSIGN  21207>>IF
     21209>>ASSIGN  21215>>IF      21217>>ASSIGN  21221>>IF      21223>>IF      21229>>IF      21231>>ASSIGN
     21232>>IF      21234>>ASSIGN  21237>>ASSIGN  21242>>ASSIGN  21246>>ASSIGN  21252>>ASSIGN  21253>>ASSIGN
     21254>>CALL    21257>>ASSIGN  21258>>ASSIGN  21259>>ASSIGN  21269>>ASSIGN  21272>>REMEMBR 21277>>ASSIGN
     21287>>ASSIGN  21287>>ASSIGN  21288>>IF      21290>>DOCASE  21292>>ASSIGN  21292>>ASSIGN  21293>>ASSIGN
     21293>>ASSIGN  21294>>ASSIGN  21294>>ASSIGN  21295>>ASSIGN  21295>>ASSIGN  21296>>ASSIGN  21296>>ASSIGN
     21297>>ASSIGN  21297>>ASSIGN  21298>>ASSIGN  21298>>ASSIGN  21299>>ASSIGN  21299>>ASSIGN  21300>>ASSIGN
     21300>>ASSIGN  21301>>ASSIGN  21301>>ASSIGN  21302>>ASSIGN  21302>>ASSIGN  21303>>ASSIGN  21303>>ASSIGN
     21306>>ASSIGN  21306>>ASSIGN  21307>>ASSIGN  21307>>ASSIGN  21308>>ASSIGN  21308>>ASSIGN  21309>>ASSIGN
     21309>>ASSIGN  21310>>ASSIGN  21310>>ASSIGN  21311>>ASSIGN  21311>>ASSIGN  21312>>ASSIGN  21312>>ASSIGN
     21313>>ASSIGN  21313>>ASSIGN  21314>>ASSIGN  21314>>ASSIGN  21315>>ASSIGN  21315>>ASSIGN  21316>>ASSIGN
     21316>>ASSIGN  21317>>ASSIGN  21317>>ASSIGN  21319>>ASSIGN  21319>>ASSIGN  21320>>ASSIGN  21320>>ASSIGN
     21321>>ASSIGN  21321>>ASSIGN  21322>>ASSIGN  21322>>ASSIGN  21323>>ASSIGN  21323>>ASSIGN  21324>>ASSIGN
     21324>>ASSIGN  21325>>ASSIGN  21325>>ASSIGN  21326>>ASSIGN  21326>>ASSIGN  21327>>ASSIGN  21327>>ASSIGN
     21328>>ASSIGN  21328>>ASSIGN  21329>>ASSIGN  21329>>ASSIGN  21330>>ASSIGN  21330>>ASSIGN  21332>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:434  
     21332>>ASSIGN  21333>>ASSIGN  21333>>ASSIGN  21334>>ASSIGN  21334>>ASSIGN  21335>>ASSIGN  21335>>ASSIGN
     21336>>ASSIGN  21336>>ASSIGN  21337>>ASSIGN  21337>>ASSIGN  21338>>ASSIGN  21338>>ASSIGN  21339>>ASSIGN
     21339>>ASSIGN  21340>>ASSIGN  21340>>ASSIGN  21341>>ASSIGN  21341>>ASSIGN  21342>>ASSIGN  21342>>ASSIGN
     21343>>ASSIGN  21343>>ASSIGN  21347>>ASSIGN  21347>>ASSIGN  21348>>ASSIGN  21348>>ASSIGN  21349>>ASSIGN
     21354>>IF      21356>>ASSIGN  21362>>ASSIGN  21374>>ASSIGN  21377>>ASSIGN  21380>>IF      21384>>CALL
     21388>>CALL    21394>>ASSIGN  21397>>ASSIGN  21398>>UNWIND  21401>>IF      21403>>ASSIGN  21406>>ASSIGN
     21406>>ASSIGN  21409>>ASSIGN  21414>>IF      21416>>IF      21418>>ASSIGN  21421>>ASSIGN  21421>>ASSIGN
     21425>>ASSIGN  21430>>IF      21433>>ASSIGN  21435>>ASSIGN  21437>>IF      21439>>ASSIGN  21440>>ASSIGN
     21441>>ASSIGN  21445>>ASSIGN  21448>>IF      21453>>ASSIGN  21454>>ASSIGN  21457>>ASSIGN  21460>>ASSIGN
     21463>>ASSIGN  21473>>DOCASE  21479>>IF      21498>>ASSIGN  21503>>ASSIGN  21517>>IF      21519>>DOCASE
     21521>>ASSIGN  21521>>ASSIGN  21522>>ASSIGN  21522>>ASSIGN  21523>>ASSIGN  21523>>ASSIGN  21524>>ASSIGN
     21524>>ASSIGN  21525>>ASSIGN  21525>>ASSIGN  21526>>ASSIGN  21526>>ASSIGN  21527>>ASSIGN  21527>>ASSIGN
     21528>>ASSIGN  21528>>ASSIGN  21529>>ASSIGN  21529>>ASSIGN  21530>>ASSIGN  21530>>ASSIGN  21533>>ASSIGN
     21533>>ASSIGN  21534>>ASSIGN  21534>>ASSIGN  21535>>ASSIGN  21535>>ASSIGN  21536>>ASSIGN  21536>>ASSIGN
     21537>>ASSIGN  21537>>ASSIGN  21538>>ASSIGN  21538>>ASSIGN  21539>>ASSIGN  21539>>ASSIGN  21540>>ASSIGN
     21540>>ASSIGN  21541>>ASSIGN  21541>>ASSIGN  21542>>ASSIGN  21542>>ASSIGN  21544>>ASSIGN  21544>>ASSIGN
     21545>>ASSIGN  21545>>ASSIGN  21546>>ASSIGN  21546>>ASSIGN  21547>>ASSIGN  21547>>ASSIGN  21548>>ASSIGN
     21548>>ASSIGN  21549>>ASSIGN  21549>>ASSIGN  21550>>ASSIGN  21550>>ASSIGN  21551>>ASSIGN  21551>>ASSIGN
     21552>>ASSIGN  21552>>ASSIGN  21553>>ASSIGN  21553>>ASSIGN  21555>>ASSIGN  21555>>ASSIGN  21556>>ASSIGN
     21556>>ASSIGN  21557>>ASSIGN  21557>>ASSIGN  21558>>ASSIGN  21558>>ASSIGN  21559>>ASSIGN  21559>>ASSIGN
     21560>>ASSIGN  21560>>ASSIGN  21561>>ASSIGN  21561>>ASSIGN  21562>>ASSIGN  21562>>ASSIGN  21563>>ASSIGN
     21563>>ASSIGN  21564>>ASSIGN  21564>>ASSIGN
S_D_HOST_MESSAGE$
     10230**DCL      7075--IMP-PTR 21140>>ASSIGN
S_D_L6_MESSAGE$
     10231**DCL      7231--IMP-PTR 19880>>ASSIGN  19881>>ASSIGN  19890>>IF      19931>>ASSIGN  19932>>ASSIGN
     20177>>ASSIGN  20178>>ASSIGN  21113>>ASSIGN  21116>>ASSIGN  21118>>ASSIGN  21120>>ASSIGN  21129>>IF
     21133>>ASSIGN  21263>>IF      21263>>IF      21266>>IF      21276>>ASSIGN  21277>>ASSIGN  21382>>ASSIGN
     21383>>ASSIGN  21392>>IF
S_D_SEG$
     10208**DCL     20911<>CALL
TEMP$
        40**DCL        41--REDEF      42--REDEF   19744<>CALL    19747>>CALL    20337<<ASSIGN  20338>>IF
     20338>>IF      20338>>IF      20338>>IF      20338>>IF      20338>>IF      21045<<ASSIGN  21047>>ASSIGN
TEMP1
        41**DCL     21133<<ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:435  
TEMP1B.B1
        44**DCL     21134>>ASSIGN
TEMP1B.B2
        45**DCL     21135>>ASSIGN
TEMP1B.B3
        46**DCL     21136>>ASSIGN
TEMP1B.B4
        47**DCL     21137>>ASSIGN
TEMP2
        48**DCL        49--REDEF   21138>>ASSIGN
TEMP2B.B1
        51**DCL     21134<<ASSIGN
TEMP2B.B2
        53**DCL     21135<<ASSIGN
TEMP2B.B3
        55**DCL     21136<<ASSIGN
TEMP2B.B4
        57**DCL     21137<<ASSIGN
TEXT$C.SIZE
      6164**DCL      6165--IMP-SIZ
TFPRG$
        72**DCL     19624<<ASSIGN  19625>>IF      19629>>DOWHILE 19629>>DOWHILE 19631<<ASSIGN  19631>>ASSIGN
     19632>>IF      19636>>DOWHILE 19645>>ASSIGN  19852<<ASSIGN  19934<<ASSIGN  20155<<ASSIGN  20160>>ASSIGN
     20165>>ASSIGN  20170>>ASSIGN  20175>>ASSIGN  20179<>CALL    20504<<ASSIGN  20505>>DOWHILE 20506>>IF
     20506>>IF      20509>>ASSIGN  20512<<ASSIGN  20512>>ASSIGN  20518<<ASSIGN  20519>>DOWHILE 20520>>IF
     20522<<ASSIGN  20522>>ASSIGN  20534<<ASSIGN  20535>>DOWHILE 20536<<ASSIGN  20536>>ASSIGN  20537>>IF
     20543>>ASSIGN  20544>>IF      20544>>IF      20749<<ASSIGN  20750>>DOWHILE 20750>>DOWHILE 20752<<ASSIGN
     20752>>ASSIGN  20753>>IF      20759>>IF      20761>>ASSIGN  20766<>CALL    20768<>CALL    20773>>ASSIGN
     20774>>ASSIGN  20984<<ASSIGN  20985>>ASSIGN  20986>>DOWHILE 20986>>DOWHILE 20988>>ASSIGN  20989<<ASSIGN
     20989>>ASSIGN  20990>>IF      20996<>CALL    21237<<ASSIGN  21238>>DOWHILE 21239<<ASSIGN  21239>>ASSIGN
     21240>>IF      21246>>ASSIGN  21247>>IF      21249>>IF      21249>>IF      21253>>ASSIGN  21255>>ASSIGN
     21260>>IF      21261>>ASSIGN  21262<>CALL    21266>>IF      21278>>ASSIGN  21281>>CALL    21362<<ASSIGN
     21363>>DOWHILE 21363>>DOWHILE 21365<<ASSIGN  21365>>ASSIGN  21366>>IF      21373>>ASSIGN  21374>>ASSIGN
     21498<<ASSIGN  21499>>DOWHILE 21500>>IF      21500>>IF      21503>>ASSIGN  21504>>CALL    21505>>IF
     21510<<ASSIGN  21510>>ASSIGN
TOBREL
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:436  
        81**DCL     20909<<ASSIGN  20910>>IF      20911<>CALL
TR$CMD
      5897**DCL     21055--ASSIGN
TRMDBG
     19280**DCL     20157<<ASSIGN  20161<>CALL
TRMDBG.STATION_
     19284**DCL     20160<<ASSIGN
TRMDBG.V
     19288**DCL     20158--ASSIGN
TRMDBG.V.DCB#
     19288**DCL     20159<<ASSIGN
TRMDBG.V_
     19282**DCL     20158<<ASSIGN
TRM_DBG
     19255**DCL     20157>>ASSIGN
TRM_DBG.V
     19263**DCL     19257--DCLINIT
TYPE
        26**DCL     21177<<ASSIGN  21182>>IF      21189>>IF      21205>>IF      21206>>IF      21206>>IF
     21207>>IF      21210<>CALL    21213<>CALL    21284>>IF
UBIN36
        78**DCL     20601<<ASSIGN  20602<<ASSIGN
UNFID$CMD.CLOSED
      6252**DCL     21078>>ASSIGN
UNFID$CMD.DCBN.C
      6260**DCL     21099>>IF
UNFID$CMD.DCBN.L
      6259**DCL     21099>>IF
UNFID$CMD.ID_FROM
      6249**DCL     21075>>ASSIGN
UNFID$CMD.ID_TO
      6250**DCL     21076>>ASSIGN
UNFID$CMD.K13
      6251**DCL     21074>>IF
UNFID$CMD.OPEN
      6253**DCL     21077>>ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:437  
UNSHARE$CMD.LIBRARY
      6282**DCL     21114>>IF      21119>>IF      21143>>IF      21160>>IF
UNSHARE$CMD.PROGRAM
      6281**DCL     21114>>IF      21117>>IF      21151>>IF
UNSHLIB
     21165**LABEL   21163--CALLALT
UNSHPROG
     21156**LABEL   21154--CALLALT
USE$CMD
      6140**DCL     21174--ASSIGN
USE$CMD.BASE
      6150**DCL      6151--REDEF    6152--REDEF    6153--REDEF    6154--REDEF    6155--REDEF    6156--REDEF
USE$CMD.FPRG
      6158**DCL     21229>>IF
USE$CMD.FPRG_RES
      6160**DCL     21231>>ASSIGN
USE$CMD.HOST
      6157**DCL     21221>>IF
USE$CMD.LS
      6146**DCL     21202>>ASSIGN
USE$CMD.NODE
      6152**DCL     21192>>ASSIGN
USE$CMD.PTA
      6153**DCL     21209>>ASSIGN
USE$CMD.SECTION
      6154**DCL     21287>>ASSIGN  21288>>IF      21290>>DOCASE
USE$CMD.SUBTYPE
      6145**DCL      6146--REDEF   21207>>IF
USE$CMD.TYPE
      6144**DCL     21177>>ASSIGN
USE$CMD.USERNO
      6151**DCL     21203>>ASSIGN
USR#
        27**DCL     21203<<ASSIGN  21205>>IF      21205<<ASSIGN  21213<>CALL
VLP_ACCT
     18022**DCL     19802--ASSIGN  19813--ASSIGN  19961--ASSIGN  19982--ASSIGN  20106--ASSIGN  20117--ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:438  
     20862--ASSIGN  20868--ASSIGN
VLP_ACCT.ACCT#
     18022**DCL     19823<<ASSIGN  19970<<ASSIGN  19997<<ASSIGN  20127<<ASSIGN  20878<<ASSIGN
VLP_MONNAME
     18077**DCL     19806--ASSIGN  20110--ASSIGN
VLP_NAME
     18008**DCL     19801--ASSIGN  19812--ASSIGN  19960--ASSIGN  19979--ASSIGN  20105--ASSIGN  20116--ASSIGN
     20861--ASSIGN  20867--ASSIGN
VLP_NAME.L#
     18008**DCL     19968<<ASSIGN
VLP_NAME.NAME#
     18008**DCL     19969<<ASSIGN
VLP_NODENAME
     18176**DCL     20010--ASSIGN
VLP_NODENAME.NODENAME#
     18176**DCL     20011<<ASSIGN
VLP_PASS
     18036**DCL     19814--ASSIGN  19962--ASSIGN  19984--ASSIGN  20118--ASSIGN  20863--ASSIGN  20869--ASSIGN
VLP_SETSTA
     18149**DCL     19963--ASSIGN
VLP_SETSTA.MYSTATION#
     18153**DCL     20000<<ASSIGN
VLP_SN
     17979**DCL     19815--ASSIGN  19959--ASSIGN  19985--ASSIGN  20119--ASSIGN  20302--ASSIGN  20860--ASSIGN
     20870--ASSIGN
VLP_SN.SN#
     17979**DCL     19971<<ASSIGN
VLP_SYSACCT
     18091**DCL     19807--ASSIGN  20111--ASSIGN
VLP_TRMATTR
     19308**DCL     19261--DCLINIT
VLP_TRMCTL
     19469**DCL     19417--DCLINIT
VLP_TRMCTL.BREAKCOUNT
     19480**DCL     19481--REDEF
VLP_WSN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:439  
     18049**DCL     19816--ASSIGN  20120--ASSIGN  20303--ASSIGN  20864--ASSIGN  20871--ASSIGN
VLR_FID
     18189**DCL     19818--ASSIGN  19981--ASSIGN  20122--ASSIGN  20305--ASSIGN  20873--ASSIGN
VLR_FID.ACCT
     18189**DCL     19822>>IF      19996>>IF      20126>>IF      20877>>IF
WAIT_SEARCH
     21360**LABEL   20516--GOTO    20553--GOTO    20559--GOTO    21369--GOTO
WHEN.END_PAGE
      5786**DCL     19676>>ASSIGN
WHEN.START_PAGE
      5785**DCL     19675>>ASSIGN  19676>>ASSIGN
WHEN.U.APT
      5758**DCL      5759--REDEF
WHEN.UNUSED
      5756**DCL      5757--REDEF
WHICH_ONE IN PROCEDURE SETDCTX
     21471**DCL     21469--PROC    21475<<ASSIGN  21477<<ASSIGN  21480<<ASSIGN  21481<<ASSIGN  21483<<ASSIGN
     21485<<ASSIGN  21487<<ASSIGN
XEQ$CMD
      5913**DCL     21421--ASSIGN
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:440  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:441  
              MINI UREF LISTING

ADDRESS      34**DCL
B$ROAVAIL    7448**DCL
B$TREEHDR    3666**DCL
B$TREE_HEADER    3608**DCL
DCB$      39**DCL
DDA$DO      21**PROC
DDA$DOATTACH   17561**DCL-ENT
DDA$KILL1   17570**DCL-ENT
DDF$FIND_PEDEF   17587**DCL-ENT
DDK$EVAL   17588**DCL-ENT
DDM$GETMEM   17589**DCL-ENT
DD_FPRGSEG$    7397**DCL
DD_HOST_NODE_PTR$   13562**DCL
DD_INSTR_CONT   13586**DCL
DD_L6X_NODE_PTR$   13564**DCL
DD_L6_NODE_PTR$   13563**DCL
DD_MODE_NODE_PTR$   13561**DCL
DD_XOU$    7379**DCL
DESC#      35**DCL
DFA$TRACE_REPORT   17625**DCL-ENT
DFPRG$      74**DCL
DFR$EVENTRPT   17630**DCL-ENT
EDEF$      77**DCL
F$XCM    5708**DCL
FAULT      80**DCL
M$ACCT   15361**DCL-ENT
M$ACTIVATE   15364**DCL-ENT
M$ALIB   15357**DCL-ENT
M$ASUSER   15359**DCL-ENT
M$ATTACH   15366**DCL-ENT
M$BADPP   15384**DCL-ENT
M$CGCTL   15365**DCL-ENT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:442  
M$CGINFO   15365**DCL-ENT
M$CHECK   15346**DCL-ENT
M$CHGUNIT   15404**DCL-ENT
M$CLRSTK   15402**DCL-ENT
M$CMDVAR   15413**DCL-ENT
M$CONFIG   15374**DCL-ENT
M$CORRES   15349**DCL-ENT
M$CPEXIT   15358**DCL-ENT
M$CVM   15382**DCL-ENT
M$CVOL   15347**DCL-ENT
M$DCLFLD   15374**DCL-ENT
M$DEACTIVATE   15364**DCL-ENT
M$DELREC   15346**DCL-ENT
M$DEQ   15411**DCL-ENT
M$DETACH   15366**DCL-ENT
M$DEVICE   15348**DCL-ENT
M$DISPLAY   15411**DCL-ENT
M$DISPRES   15351**DCL-ENT
M$DLIB   15357**DCL-ENT
M$DRIBBLE   15374**DCL-ENT
M$DSUSER   15359**DCL-ENT
M$ENQ   15410**DCL-ENT
M$ERASE   15375**DCL-ENT
M$ERR   15356**DCL-ENT
M$ERRMSG   15407**DCL-ENT
M$EVENT   15399**DCL-ENT
M$EXHUME   15408**DCL-ENT
M$EXIT   15356**DCL-ENT
M$EXTEND   15348**DCL-ENT
M$FDP   15380**DCL-ENT
M$FDS   15379**DCL-ENT
M$FEBOOT   15372**DCL-ENT
M$FECTL   15373**DCL-ENT
M$FEDUMP   15372**DCL-ENT
M$FINDPROC   15361**DCL-ENT
M$FSUSER   15359**DCL-ENT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:443  
M$FVP   15381**DCL-ENT
M$FWCG   15365**DCL-ENT
M$GBPL   15385**DCL-ENT
M$GDDL   15381**DCL-ENT
M$GDP   15380**DCL-ENT
M$GDS   15379**DCL-ENT
M$GETMOUSE   15390**DCL-ENT
M$GETPM   15391**DCL-ENT
M$GJOB   15409**DCL-ENT
M$GLINEATTR   15369**DCL-ENT
M$GOODPP   15384**DCL-ENT
M$GPLATEN   15377**DCL-ENT
M$GPROMPT   15376**DCL-ENT
M$GTRMATTR   15370**DCL-ENT
M$GTRMCTL   15368**DCL-ENT
M$GTRMTAB   15371**DCL-ENT
M$GVP   15380**DCL-ENT
M$HELP   15407**DCL-ENT
M$INT   15399**DCL-ENT
M$INTRTN   15360**DCL-ENT
M$IOQ   15395**DCL-ENT
M$JOBSTATS   15409**DCL-ENT
M$KEYIN   15349**DCL-ENT
M$LDEV   15344**DCL-ENT
M$LDTRC   15357**DCL-ENT
M$LIMIT   15350**DCL-ENT
M$LINES   15349**DCL-ENT
M$LINK   15356**DCL-ENT
M$MADMUCK   15352**DCL-ENT
M$MAKUSER   15383**DCL-ENT
M$MBS   15351**DCL-ENT
M$MDFFLD   15375**DCL-ENT
M$MERC   15400**DCL-ENT
M$MERCS   15401**DCL-ENT
M$MIRROR   15395**DCL-ENT
M$MONINFO   15412**DCL-ENT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:444  
M$MPL   15385**DCL-ENT
M$NODEINFO   15376**DCL-ENT
M$NXTUSR   15410**DCL-ENT
M$OCMSG   15408**DCL-ENT
M$OLAY   15356**DCL-ENT
M$PAS   15385**DCL-ENT
M$PATHCON   15408**DCL-ENT
M$PDS   15379**DCL-ENT
M$PFIL   15346**DCL-ENT
M$PLATEN   15370**DCL-ENT
M$PRECORD   15348**DCL-ENT
M$PROCNAME   15361**DCL-ENT
M$PROFILE   15372**DCL-ENT
M$RACST   15352**DCL-ENT
M$RDSYSLOG   15393**DCL-ENT
M$RELRES   15351**DCL-ENT
M$RELSTARF   15353**DCL-ENT
M$REM   15353**DCL-ENT
M$RENV   15400**DCL-ENT
M$REQUIRE   15352**DCL-ENT
M$RETRY   15401**DCL-ENT
M$RETRYS   15401**DCL-ENT
M$REW   15347**DCL-ENT
M$RLSFLD   15375**DCL-ENT
M$RPRIV   15403**DCL-ENT
M$RSPP   15382**DCL-ENT
M$RSWITCH   15404**DCL-ENT
M$RUE   15410**DCL-ENT
M$SAVE   15359**DCL-ENT
M$SCON   15360**DCL-ENT
M$SENV   15400**DCL-ENT
M$SETFMA   15344**DCL-ENT
M$SINPUT   15371**DCL-ENT
M$SLCFLD   15376**DCL-ENT
M$SMOUSE   15390**DCL-ENT
M$SMPRT   15382**DCL-ENT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:445  
M$SPRIV   15403**DCL-ENT
M$SSWITCH   15403**DCL-ENT
M$STATE   15412**DCL-ENT
M$STD   15384**DCL-ENT
M$STIMER   15398**DCL-ENT
M$STLPP   15381**DCL-ENT
M$STRAP   15398**DCL-ENT
M$STRMTAB   15371**DCL-ENT
M$SYMBIO   15409**DCL-ENT
M$SYSCON   15395**DCL-ENT
M$SYSID   15413**DCL-ENT
M$TDCLOSE   15394**DCL-ENT
M$TDIO   15394**DCL-ENT
M$TDOPEN   15393**DCL-ENT
M$TDREQCPU   15394**DCL-ENT
M$TEMPWROC   15388**DCL-ENT
M$TIME   15411**DCL-ENT
M$TRAP   15398**DCL-ENT
M$TRMISC   15373**DCL-ENT
M$TRMPRG   15369**DCL-ENT
M$TRTN   15402**DCL-ENT
M$TRUNC   15345**DCL-ENT
M$TTIMER   15398**DCL-ENT
M$UC   15368**DCL
M$UMPL   15385**DCL-ENT
M$UNFID   15407**DCL-ENT
M$UNLATCH   15364**DCL-ENT
M$USRFIELD   15404**DCL-ENT
M$VIRTUAL   15379**DCL-ENT
M$WEOF   15347**DCL-ENT
M$WRSYSLOG   15393**DCL-ENT
M$XCON   15399**DCL-ENT
M$XCONRTN   15360**DCL-ENT
M$XEQTIME   15412**DCL-ENT
M$XFLUSH   15353**DCL-ENT
M$XMOUSE   15390**DCL-ENT
PL6.E3A0      #001=DDA$DO File=DDA$DO.:E05TSI                                    TUE 07/29/97 13:23 Page:446  
M$XXX   15356**DCL-ENT
M$YC   15358**DCL-ENT
SCHEMA   20903**LABEL
SC_MESSAGE   17687**DCL
SDD$    3827**DCL
SDD_L6$    3829**DCL
SEG      36**DCL
S_D_ACCESS$   10209**DCL
S_D_ANLZ$   10211**DCL
S_D_ASTACKOFF$   10210**DCL
S_D_BREAK$   10212**DCL
S_D_DO_SCAN$   10213**DCL
S_D_ERROR$   10214**DCL
S_D_FAULTCMD$$   10215**DCL
S_D_FAULTINS$$   10216**DCL
S_D_GOIC$   10217**DCL
S_D_GO_MODE$   10218**DCL
S_D_HW_PTB_UNITS$   10234**DCL
S_D_HW_RES_MEM$   10232**DCL
S_D_HW_WSQ0PT$   10233**DCL
S_D_IPRFLT$   10220**DCL
S_D_IXFIX$   10219**DCL
S_D_REM_ACCESS$   10221**DCL
S_D_REM_DISKBOOT$   10223**DCL
S_D_REM_DO_SCAN$   10222**DCL
S_D_RETURNN$   10224**DCL
S_D_SAD$   10225**DCL
S_D_SAVEIC$   10226**DCL
S_D_TCB$$   10227**DCL
S_D_UREG$$   10228**DCL
S_D_USS$$   10229**DCL
TSIZE      71**DCL
VLR_FPRG_FID   18387**DCL
ZITEM$    3828**DCL
ZITEM_L6$    3830**DCL

PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:447  
     2422        1        /*T***********************************************************/
     2423        2        /*T*                                                         */
     2424        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2425        4        /*T*                                                         */
     2426        5        /*T***********************************************************/
     2427        6        DDA$RESET_PATCH_SPACE: PROC;
     2428        7        %INCLUDE XUH_MACRO_C;
     2429       91        %INCLUDE DD_SD_M;
     2430     1427        %S_D;
     2431     2745                                                /* Mark patch space as undefined */
     2432     2746    1        S_D.DEFINED@ = '0'B;
     2433     2747    1        S_D.DEFINED# = '0'B;
     2434     2748    1        S_D.MONIS.DEFINED@ = '0'B;
     2435     2749    1        S_D.MONIS.DEFINED# = '0'B;
     2436     2750    1        S_D.MONENT.DEFINED@ = '0'B;
     2437     2751    1        S_D.MONENT.DEFINED# = '0'B;
     2438     2752    1        S_D.BF.DEFINED@ = '0'B;
     2439     2753    1        S_D.BF.DEFINED# = '0'B;
     2440     2754    1        S_D.FD.DEFINED@ = '0'B;
     2441     2755    1        S_D.FD.DEFINED# = '0'B;
     2442     2756    1        RETURN;
     2443     2757    1   END DDA$RESET_PATCH_SPACE;
     2444     2758        %EOD;

PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:448  
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$RESET_PATCH_SPACE.

   Procedure DDA$RESET_PATCH_SPACE requires 14 words for executable code.
   Procedure DDA$RESET_PATCH_SPACE requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:449  

 Object Unit name= DDA$RESET_PATCH_SPACE                      File name= DDA$DO.:E05TOU
 UTS= JUL 29 '97 13:26:22.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    14     16  DDA$RESET_PATCH_SPACE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        0  DDA$RESET_PATCH_SPACE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:450  


     2422        1        /*T***********************************************************/
     2423        2        /*T*                                                         */
     2424        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2425        4        /*T*                                                         */
     2426        5        /*T***********************************************************/
     2427        6        DDA$RESET_PATCH_SPACE: PROC;

      6  0 000000   000000 700200 xent  DDA$RESET_P* TSX0  ! X66_AUTO_0
         0 000001   000004 000000                    ZERO    4,0

     2428        7        %INCLUDE XUH_MACRO_C;
     2429       91        %INCLUDE DD_SD_M;
     2430     1427        %S_D;
     2431     2745                                                /* Mark patch space as undefined */
     2432     2746    1        S_D.DEFINED@ = '0'B;

   2746  0 000002   000000 470400 xsym               LDP0    S_D$
         0 000003   005060 450100                    STZ     2608,,PR0

     2433     2747    1        S_D.DEFINED# = '0'B;

   2747  0 000004   005065 450100                    STZ     2613,,PR0

     2434     2748    1        S_D.MONIS.DEFINED@ = '0'B;

   2748  0 000005   007041 450100                    STZ     3617,,PR0

     2435     2749    1        S_D.MONIS.DEFINED# = '0'B;

   2749  0 000006   007047 450100                    STZ     3623,,PR0

     2436     2750    1        S_D.MONENT.DEFINED@ = '0'B;

   2750  0 000007   007025 450100                    STZ     3605,,PR0

     2437     2751    1        S_D.MONENT.DEFINED# = '0'B;
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:451  

   2751  0 000010   007033 450100                    STZ     3611,,PR0

     2438     2752    1        S_D.BF.DEFINED@ = '0'B;

   2752  0 000011   007071 450100                    STZ     3641,,PR0

     2439     2753    1        S_D.BF.DEFINED# = '0'B;

   2753  0 000012   007077 450100                    STZ     3647,,PR0

     2440     2754    1        S_D.FD.DEFINED@ = '0'B;

   2754  0 000013   007055 450100                    STZ     3629,,PR0

     2441     2755    1        S_D.FD.DEFINED# = '0'B;

   2755  0 000014   007063 450100                    STZ     3635,,PR0

     2442     2756    1        RETURN;

   2756  0 000015   000000 702200 xent               TSX2  ! X66_ARET
     2443     2757    1   END DDA$RESET_PATCH_SPACE;
     2444     2758        %EOD;

PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:452  
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$RESET_PATCH_SPACE.

   Procedure DDA$RESET_PATCH_SPACE requires 14 words for executable code.
   Procedure DDA$RESET_PATCH_SPACE requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:453  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:454  
          MINI XREF LISTING

S_D.BF.DEFINED#
      2658**DCL      2753<<ASSIGN
S_D.BF.DEFINED@
      2646**DCL      2752<<ASSIGN
S_D.CURRENT_CHANNEL
      2379**DCL      2381--REDEF
S_D.DEBUGA
      1531**DCL      1533--REDEF
S_D.DEFINED#
      2165**DCL      2747<<ASSIGN
S_D.DEFINED@
      2155**DCL      2746<<ASSIGN
S_D.EIS
      2489**DCL      2518--REDEF
S_D.FD.DEFINED#
      2633**DCL      2755<<ASSIGN
S_D.FD.DEFINED@
      2621**DCL      2754<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      2422**DCL      2423--REDEF    2437--REDEF
S_D.JDE
      2036**DCL      2037--REDEF
S_D.L$.VALUE
      1589**DCL      1595--REDEF    1603--REDEF    1606--REDEF    1609--REDEF    1612--REDEF
S_D.L$.VALUE.L
      1590**DCL      1591--REDEF    1592--REDEF
S_D.L6_MESSAGE_BUF
      2443**DCL      2445--REDEF
S_D.MONENT.DEFINED#
      2583**DCL      2751<<ASSIGN
S_D.MONENT.DEFINED@
      2571**DCL      2750<<ASSIGN
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:455  
S_D.MONIS.DEFINED#
      2608**DCL      2749<<ASSIGN
S_D.MONIS.DEFINED@
      2596**DCL      2748<<ASSIGN
S_D.OUTPUT
      2409**DCL      2411--REDEF
S_D.REMOTE_MSG.FNCC
      2428**DCL      2429--REDEF
S_D.REMOTE_MSG.STXC
      2424**DCL      2425--REDEF
S_D.REMOTE_MSG.SUBFNCC
      2432**DCL      2433--REDEF
S_D.SV
      1488**DCL      1509--REDEF
S_D$
      2740**DCL      1436--IMP-PTR  2746>>ASSIGN   2747>>ASSIGN   2748>>ASSIGN   2749>>ASSIGN   2750>>ASSIGN
      2751>>ASSIGN   2752>>ASSIGN   2753>>ASSIGN   2754>>ASSIGN   2755>>ASSIGN
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:456  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDA$RESET_PATCH_SPACE File=DDA$DO.:E05TSI                     TUE 07/29/97 13:26 Page:457  
              MINI UREF LISTING

DDA$RESET_PATCH_SPACE       6**PROC

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:458  
     2445        1        /*T***********************************************************/
     2446        2        /*T*                                                         */
     2447        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2448        4        /*T*                                                         */
     2449        5        /*T***********************************************************/
     2450        6        /**/
     2451        7        /*D*  NAME:  DDA$DOATTACH
     2452        8              CALL:  CALL DDA$DOATTACH ALTRET(USERGO)
     2453        9              INPUT:   S_D.DO$ IS A POINTER TO THE FIRST ATTACHMENT,
     2454       10                       OR IT IS NIL IF THERE ARE NO TEXT ATTACHMENTS.
     2455       11             DESCRIPTION:  WITHIN THE CONTROLLING LOOP, EACH ATTACHMENT
     2456       12                           IS POINTED TO WITH DO$.  DDA$DO IS CALLED.
     2457       13                          IF A 'GO' IS ENCOUNTERED WITHIN THE ATTACHMENT
     2458       14                          LIST, CONTROL RETURNS TO THE USER (VIA ALTRET).
     2459       15                          IF NO 'GO' IS ENCOUNTED, THEN THE STOP FLAG IS
     2460       16                          CHECKED TO DETERMINE WHETHER TO RETURN TO THE USER OR
     2461       17                          OR THE SCANNER.  NOTE THAT THE STOP FLAG IS:
     2462       18                          1) SET TO A DEFAULT CONDITION APPROPRIATE TO THE
     2463       19                             METHOD OF ENTRY TO DELTA (USERFAULT OR STORED
     2464       20                             COMMAND) AND MODE (BATCH OR ON_LINE).  THIS IS
     2465       21                          DONE IN THE 'DO FIRST ATTACHMENT' ROUTINES.
     2466       22                          2) SET IF A 'STOP' COMMAND IS ISSUED.
     2467       23                           */
     2468       24        DDA$DOATTACH: PROC ALTRET;
     2469       25        %INCLUDE XUH_MACRO_C;
     2470      109        %INCLUDE DD_SD_M;
     2471     1445        %S_D;
     2472     2763        %INCLUDE DD_SUBS_C;
     2473     3034        %INCLUDE DD$BASED;
     2474     4337        %FIXCOM (NAME=FXCM);
     2475     4353        %ALL_ATTACH;
     2476     4368    1   DCL SAVEFAULT$ PTR;
     2477     4369    1   DCL SAVE_REM_DO_SCAN REMEMBER DALIGNED;
     2478     4370    1   DCL SAVE_DO_SCAN BIT(1) ALIGNED;
     2479     4371    1   DCL MUST_RESTORE BIT(1);
     2480     4372    1   DCL ATT$ PTR;
     2481     4373    1   DCL ATT_OFFSET UBIN;
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:459  
     2482     4374        %AT_FIRST;
     2483     4402    1   DCL D_XDELTA BIT(1) SYMREF;
     2484     4403    1   DCL DDS$SCAN2 ENTRY(0) ALTRET;
     2485     4404    1   DCL DDA$DO ENTRY ALTRET;
     2486     4405    1   DCL DDB$BREAK ENTRY ALTRET;
     2487     4406    1   DCL DDR$REPORT ENTRY(1);
     2488     4407                                           /* IF THERE ARE NO ATTACHMENTS, RETURN */
     2489     4408    1        IF S_D.DO$ = ADDR(NIL) THEN GOTO END_LIST;
     2490     4409                            /* THERE ARE ATTACHMENTS.  BUILD POINTER TO THE END OF THE
     2491     4410                            LAST ONE */
     2492     4411    1        S_D.DO_ATTACH = S_D.DO_ATTACH + 1;
     2493     4412    1        ATT$ = S_D.DO$;
     2494     4413    1        ATT_OFFSET = ATT$ -> AT_FIRST.ATT_OFFSET;
     2495     4414    1        SAVE_REM_DO_SCAN = S_D.REM_DO_SCAN;
     2496     4415    1        SAVE_DO_SCAN = S_D.DO_SCAN;
     2497     4416    1        REMEMBER S_FAULT IN S_D.REM_DO_SCAN;
     2498     4417    1        S_D.DO_SCAN = '1'B;
     2499     4418    1        MUST_RESTORE = '0'B;
     2500     4419    2        DO WHILE ( ATT_OFFSET < ATT$ -> AT_FIRST.TEXT_SIZE );
     2501     4420    2             S_D.ACMDS$ = PINCRC( ATT$, ATT$ -> AT_FIRST.TEXT_OFFSET );
     2502     4421    2             S_D.ACMDS_SIZE = ATT$ -> AT_FIRST.TEXT_SIZE;
     2503     4422    2             S_D.ACMDS_OFF = ATT_OFFSET;
     2504     4423    2             CALL DDS$SCAN2 ALTRET( END_LIST1 );
     2505     4424    2             ATT_OFFSET = S_D.ACMDS_OFF;
     2506     4425    2             S_D.DO$ = ADDR( S_D.DIRCOM );
     2507     4426                                 /* If we are processing a list of attachments via DO,
     2508     4427                                 and the current frame is a GO, save FAULTCMD$ and put
     2509     4428                                 ENTRYCMD$ in its place.  This is so DDA$GO will see
     2510     4429                                 the entry command, and not a DO frame.  ENTRYCMD$ must
     2511     4430                                 be setup by DDA$DELTA on all calls to DOATTACH. */
     2512     4431    2             IF (S_D.DO$->ALL_ATTACH.CMD = C_GOTO) AND
     2513     4432    2               (S_D.FAULTCMD$ ~= PINCRW(ADDR(S_D.FIXCOM),SIZEW(FXCM)*S_D.IXFIX) )
     2514     4433    3             THEN DO;
     2515     4434    3                  SAVEFAULT$ = S_D.FAULTCMD$;
     2516     4435    3                  S_D.FAULTCMD$ = S_D.ENTRYCMD$;
     2517     4436    3                  MUST_RESTORE = '1'B;
     2518     4437    3                END;
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:460  
     2519     4438    2             ELSE MUST_RESTORE = '0'B;
     2520     4439    2             CALL DDA$DO ALTRET(USERGO);
     2521     4440    2   NEXT_ATTACH: ;
     2522     4441    2             IF MUST_RESTORE THEN S_D.FAULTCMD$ = SAVEFAULT$;
     2523     4442    3             DO WHILE ( '0'B );
     2524     4443    3   END_LIST1:     S_D.STOP = '1'B;         /* An attachment failed */
     2525     4444    3                END;
     2526     4445    2             IF S_D.STOP THEN GOTO END_LIST;
     2527     4446    2             CALL DDB$BREAK ALTRET(END_LIST);
     2528     4447    2           END;
     2529     4448    1   END_LIST:
     2530     4449    1        S_D.DO_ATTACH = S_D.DO_ATTACH - 1;
     2531     4450    1        S_D.REM_DO_SCAN = SAVE_REM_DO_SCAN;
     2532     4451    1        S_D.DO_SCAN = SAVE_DO_SCAN;
     2533     4452    1        RETURN;
     2534     4453    1   USERGO:
     2535     4454    1        IF MUST_RESTORE THEN S_D.FAULTCMD$ = SAVEFAULT$;
     2536     4455    1        S_D.DO_SCAN = '0'B;
     2537     4456    1        S_D.DO_ATTACH = S_D.DO_ATTACH - 1;
     2538     4457    1        UNWIND TO S_D.REM_USERGO;
     2539     4458    1   S_FAULT: ;
     2540     4459    2        IF D_XDELTA THEN DO;
     2541     4460    2             CALL DDR$REPORT(R_SFAULT);
     2542     4461    2           END;                  /* FAULTS ARE PRINTED BY DEX$TRAP IN uDELTA */
     2543     4462    1        GOTO NEXT_ATTACH;
     2544     4463    1   END DDA$DOATTACH;

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:461  
--  Include file information  --

   DD$BASED.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$DOATTACH.

   Procedure DDA$DOATTACH requires 124 words for executable code.
   Procedure DDA$DOATTACH requires 10 words of local(AUTO) storage.

    No errors detected in file DDA$DO.:E05TSI    .

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:462  

 Object Unit name= DDA$DOATTACH                               File name= DDA$DO.:E05TOU
 UTS= JUL 29 '97 13:26:35.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   124    174  DDA$DOATTACH
    1  RoData even  none     1      1  DDA$DOATTACH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        0  DDA$DOATTACH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 DDS$SCAN2
 yes     yes           Std       0 DDA$DO
 yes     yes           Std       0 DDB$BREAK
         yes           Std       1 DDR$REPORT
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AUNWIND
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:463  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  D_XDELTA                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:464  


     2445        1        /*T***********************************************************/
     2446        2        /*T*                                                         */
     2447        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2448        4        /*T*                                                         */
     2449        5        /*T***********************************************************/
     2450        6        /**/
     2451        7        /*D*  NAME:  DDA$DOATTACH
     2452        8              CALL:  CALL DDA$DOATTACH ALTRET(USERGO)
     2453        9              INPUT:   S_D.DO$ IS A POINTER TO THE FIRST ATTACHMENT,
     2454       10                       OR IT IS NIL IF THERE ARE NO TEXT ATTACHMENTS.
     2455       11             DESCRIPTION:  WITHIN THE CONTROLLING LOOP, EACH ATTACHMENT
     2456       12                           IS POINTED TO WITH DO$.  DDA$DO IS CALLED.
     2457       13                          IF A 'GO' IS ENCOUNTERED WITHIN THE ATTACHMENT
     2458       14                          LIST, CONTROL RETURNS TO THE USER (VIA ALTRET).
     2459       15                          IF NO 'GO' IS ENCOUNTED, THEN THE STOP FLAG IS
     2460       16                          CHECKED TO DETERMINE WHETHER TO RETURN TO THE USER OR
     2461       17                          OR THE SCANNER.  NOTE THAT THE STOP FLAG IS:
     2462       18                          1) SET TO A DEFAULT CONDITION APPROPRIATE TO THE
     2463       19                             METHOD OF ENTRY TO DELTA (USERFAULT OR STORED
     2464       20                             COMMAND) AND MODE (BATCH OR ON_LINE).  THIS IS
     2465       21                          DONE IN THE 'DO FIRST ATTACHMENT' ROUTINES.
     2466       22                          2) SET IF A 'STOP' COMMAND IS ISSUED.
     2467       23                           */
     2468       24        DDA$DOATTACH: PROC ALTRET;

     24  0 000000   000000 700200 xent  DDA$DOATTACH TSX0  ! X66_AUTO_0
         0 000001   000012 000000                    ZERO    10,0

     2469       25        %INCLUDE XUH_MACRO_C;
     2470      109        %INCLUDE DD_SD_M;
     2471     1445        %S_D;
     2472     2763        %INCLUDE DD_SUBS_C;
     2473     3034        %INCLUDE DD$BASED;
     2474     4337        %FIXCOM (NAME=FXCM);
     2475     4353        %ALL_ATTACH;
     2476     4368    1   DCL SAVEFAULT$ PTR;
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:465  
     2477     4369    1   DCL SAVE_REM_DO_SCAN REMEMBER DALIGNED;
     2478     4370    1   DCL SAVE_DO_SCAN BIT(1) ALIGNED;
     2479     4371    1   DCL MUST_RESTORE BIT(1);
     2480     4372    1   DCL ATT$ PTR;
     2481     4373    1   DCL ATT_OFFSET UBIN;
     2482     4374        %AT_FIRST;
     2483     4402    1   DCL D_XDELTA BIT(1) SYMREF;
     2484     4403    1   DCL DDS$SCAN2 ENTRY(0) ALTRET;
     2485     4404    1   DCL DDA$DO ENTRY ALTRET;
     2486     4405    1   DCL DDB$BREAK ENTRY ALTRET;
     2487     4406    1   DCL DDR$REPORT ENTRY(1);
     2488     4407                                           /* IF THERE ARE NO ATTACHMENTS, RETURN */
     2489     4408    1        IF S_D.DO$ = ADDR(NIL) THEN GOTO END_LIST;

   4408  0 000002   000000 470400 xsym               LDP0    S_D$
         0 000003   000031 236100                    LDQ     25,,PR0
         0 000004   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000005   000136 600000 0                  TZE     END_LIST

     2490     4409                            /* THERE ARE ATTACHMENTS.  BUILD POINTER TO THE END OF THE
     2491     4410                            LAST ONE */
     2492     4411    1        S_D.DO_ATTACH = S_D.DO_ATTACH + 1;

   4411  0 000006   000512 235100                    LDA     330,,PR0
         0 000007   000001 035007                    ADLA    1,DL
         0 000010   000512 755100                    STA     330,,PR0

     2493     4412    1        ATT$ = S_D.DO$;

   4412  0 000011   200010 756100                    STQ     ATT$,,AUTO

     2494     4413    1        ATT_OFFSET = ATT$ -> AT_FIRST.ATT_OFFSET;

   4413  0 000012   200010 471500                    LDP1    ATT$,,AUTO
         0 000013   100007 236100                    LDQ     7,,PR1
         0 000014   000022 772000                    QRL     18
         0 000015   200011 756100                    STQ     ATT_OFFSET,,AUTO
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:466  

     2495     4414    1        SAVE_REM_DO_SCAN = S_D.REM_DO_SCAN;

   4414  0 000016   000022 237100                    LDAQ    18,,PR0
         0 000017   200004 757100                    STAQ    SAVE_REM_DO_SCAN,,AUTO

     2496     4415    1        SAVE_DO_SCAN = S_D.DO_SCAN;

   4415  0 000020   000017 236100                    LDQ     15,,PR0
         0 000021   400000 376003                    ANQ     -131072,DU
         0 000022   200006 756100                    STQ     SAVE_DO_SCAN,,AUTO

     2497     4416    1        REMEMBER S_FAULT IN S_D.REM_DO_SCAN;

   4416  0 000023   000165 635000 0                  EAA     S_FAULT
         0 000024   000022 452500                    STP2    18,,PR0
         0 000025   000023 755100                    STA     19,,PR0

     2498     4417    1        S_D.DO_SCAN = '1'B;

   4417  0 000026   400000 236003                    LDQ     -131072,DU
         0 000027   000017 756100                    STQ     15,,PR0

     2499     4418    1        MUST_RESTORE = '0'B;

   4418  0 000030   200007 450100                    STZ     MUST_RESTORE,,AUTO

     2500     4419    2        DO WHILE ( ATT_OFFSET < ATT$ -> AT_FIRST.TEXT_SIZE );

   4419  0 000031   100006 236100                    LDQ     6,,PR1
         0 000032   777777 376007                    ANQ     -1,DL
         0 000033   200011 116100                    CMPQ    ATT_OFFSET,,AUTO
         0 000034   000136 602000 0                  TNC     END_LIST
         0 000035   000136 600000 0                  TZE     END_LIST

     2501     4420    2             S_D.ACMDS$ = PINCRC( ATT$, ATT$ -> AT_FIRST.TEXT_OFFSET );

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:467  
   4420  0 000036   200010 470500                    LDP0    ATT$,,AUTO
         0 000037   000006 236100                    LDQ     6,,PR0
         0 000040   000022 772000                    QRL     18
         0 000041   000020 736000                    QLS     16
         0 000042   200010 036100                    ADLQ    ATT$,,AUTO
         0 000043   000000 471400 xsym               LDP1    S_D$
         0 000044   100510 756100                    STQ     328,,PR1

     2502     4421    2             S_D.ACMDS_SIZE = ATT$ -> AT_FIRST.TEXT_SIZE;

   4421  0 000045   000006 236100                    LDQ     6,,PR0
         0 000046   777777 376007                    ANQ     -1,DL
         0 000047   100511 756100                    STQ     329,,PR1

     2503     4422    2             S_D.ACMDS_OFF = ATT_OFFSET;

   4422  0 000050   200011 235100                    LDA     ATT_OFFSET,,AUTO
         0 000051   100507 755100                    STA     327,,PR1

     2504     4423    2             CALL DDS$SCAN2 ALTRET( END_LIST1 );

   4423  0 000052   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000053   000000 701000 xent               TSX1    DDS$SCAN2
         0 000054   000117 702000 0                  TSX2    END_LIST1

     2505     4424    2             ATT_OFFSET = S_D.ACMDS_OFF;

   4424  0 000055   000000 470400 xsym               LDP0    S_D$
         0 000056   000507 235100                    LDA     327,,PR0
         0 000057   200011 755100                    STA     ATT_OFFSET,,AUTO

     2506     4425    2             S_D.DO$ = ADDR( S_D.DIRCOM );

   4425  0 000060   000000 236000 xsym               LDQ     S_D$
         0 000061   001046 036003                    ADLQ    550,DU
         0 000062   000031 756100                    STQ     25,,PR0

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:468  
     2507     4426                                 /* If we are processing a list of attachments via DO,
     2508     4427                                 and the current frame is a GO, save FAULTCMD$ and put
     2509     4428                                 ENTRYCMD$ in its place.  This is so DDA$GO will see
     2510     4429                                 the entry command, and not a DO frame.  ENTRYCMD$ must
     2511     4430                                 be setup by DDA$DELTA on all calls to DOATTACH. */
     2512     4431    2             IF (S_D.DO$->ALL_ATTACH.CMD = C_GOTO) AND

   4431  0 000063   000031 471500                    LDP1    25,,PR0
         0 000064   100000 236100                    LDQ     0,,PR1
         0 000065   777000 376003                    ANQ     -512,DU
         0 000066   013000 116003                    CMPQ    5632,DU
         0 000067   000105 601000 0                  TNZ     s:4438
         0 000070   000015 236100                    LDQ     13,,PR0
         0 000071   000006 402003                    MPY     6,DU
         0 000072   001212 036003                    ADLQ    650,DU
         0 000073   000000 036000 xsym               ADLQ    S_D$
         0 000074   000004 116100                    CMPQ    4,,PR0
         0 000075   000105 600000 0                  TZE     s:4438

     2513     4432    2               (S_D.FAULTCMD$ ~= PINCRW(ADDR(S_D.FIXCOM),SIZEW(FXCM)*S_D.IXFIX) )
     2514     4433    3             THEN DO;

     2515     4434    3                  SAVEFAULT$ = S_D.FAULTCMD$;

   4434  0 000076   000004 236100                    LDQ     4,,PR0
         0 000077   200003 756100                    STQ     SAVEFAULT$,,AUTO

     2516     4435    3                  S_D.FAULTCMD$ = S_D.ENTRYCMD$;

   4435  0 000100   005203 236100                    LDQ     2691,,PR0
         0 000101   000004 756100                    STQ     4,,PR0

     2517     4436    3                  MUST_RESTORE = '1'B;

   4436  0 000102   400000 236003                    LDQ     -131072,DU
         0 000103   200007 756100                    STQ     MUST_RESTORE,,AUTO

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:469  
     2518     4437    3                END;

   4437  0 000104   000106 710000 0                  TRA     s:4439

     2519     4438    2             ELSE MUST_RESTORE = '0'B;

   4438  0 000105   200007 450100                    STZ     MUST_RESTORE,,AUTO

     2520     4439    2             CALL DDA$DO ALTRET(USERGO);

   4439  0 000106   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000107   000000 701000 xent               TSX1    DDA$DO
         0 000110   000150 702000 0                  TSX2    USERGO

   4435  0 000111                       NEXT_ATTACH  null
     2521     4440    2   NEXT_ATTACH: ;
     2522     4441    2             IF MUST_RESTORE THEN S_D.FAULTCMD$ = SAVEFAULT$;

   4441  0 000111   200007 234100                    SZN     MUST_RESTORE,,AUTO
         0 000112   000116 605000 0                  TPL     s:4442

   4441  0 000113   200003 236100                    LDQ     SAVEFAULT$,,AUTO
         0 000114   000000 470400 xsym               LDP0    S_D$
         0 000115   000004 756100                    STQ     4,,PR0

     2523     4442    3             DO WHILE ( '0'B );

   4442  0 000116   000122 710000 0                  TRA     s:4445

     2524     4443    3   END_LIST1:     S_D.STOP = '1'B;         /* An attachment failed */

   4443  0 000117   400000 236003       END_LIST1    LDQ     -131072,DU
         0 000120   000000 470400 xsym               LDP0    S_D$
         0 000121   000050 756100                    STQ     40,,PR0

     2525     4444    3                END;

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:470  
     2526     4445    2             IF S_D.STOP THEN GOTO END_LIST;

   4445  0 000122   000000 470400 xsym               LDP0    S_D$
         0 000123   000050 234100                    SZN     40,,PR0
         0 000124   000136 604000 0                  TMI     END_LIST

     2527     4446    2             CALL DDB$BREAK ALTRET(END_LIST);

   4446  0 000125   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000126   000000 701000 xent               TSX1    DDB$BREAK
         0 000127   000136 702000 0                  TSX2    END_LIST

     2528     4447    2           END;

   4447  0 000130   200010 470500                    LDP0    ATT$,,AUTO
         0 000131   000006 236100                    LDQ     6,,PR0
         0 000132   777777 376007                    ANQ     -1,DL
         0 000133   200011 116100                    CMPQ    ATT_OFFSET,,AUTO
         0 000134   000136 600000 0                  TZE     END_LIST
         0 000135   000036 603000 0                  TRC     s:4420

     2529     4448    1   END_LIST:
     2530     4449    1        S_D.DO_ATTACH = S_D.DO_ATTACH - 1;

   4449  0 000136   000000 470400 xsym  END_LIST     LDP0    S_D$
         0 000137   000512 235100                    LDA     330,,PR0
         0 000140   000001 135007                    SBLA    1,DL
         0 000141   000512 755100                    STA     330,,PR0

     2531     4450    1        S_D.REM_DO_SCAN = SAVE_REM_DO_SCAN;

   4450  0 000142   200004 237100                    LDAQ    SAVE_REM_DO_SCAN,,AUTO
         0 000143   000022 757100                    STAQ    18,,PR0

     2532     4451    1        S_D.DO_SCAN = SAVE_DO_SCAN;

   4451  0 000144   200006 236100                    LDQ     SAVE_DO_SCAN,,AUTO
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:471  
         0 000145   400000 376003                    ANQ     -131072,DU
         0 000146   000017 756100                    STQ     15,,PR0

     2533     4452    1        RETURN;

   4452  0 000147   000000 702200 xent               TSX2  ! X66_ARET

     2534     4453    1   USERGO:
     2535     4454    1        IF MUST_RESTORE THEN S_D.FAULTCMD$ = SAVEFAULT$;

   4454  0 000150   200007 234100       USERGO       SZN     MUST_RESTORE,,AUTO
         0 000151   000155 605000 0                  TPL     s:4455

   4454  0 000152   200003 236100                    LDQ     SAVEFAULT$,,AUTO
         0 000153   000000 470400 xsym               LDP0    S_D$
         0 000154   000004 756100                    STQ     4,,PR0

     2536     4455    1        S_D.DO_SCAN = '0'B;

   4455  0 000155   000000 470400 xsym               LDP0    S_D$
         0 000156   000017 450100                    STZ     15,,PR0

     2537     4456    1        S_D.DO_ATTACH = S_D.DO_ATTACH - 1;

   4456  0 000157   000512 235100                    LDA     330,,PR0
         0 000160   000001 135007                    SBLA    1,DL
         0 000161   000512 755100                    STA     330,,PR0

     2538     4457    1        UNWIND TO S_D.REM_USERGO;

   4457  0 000162   005232 237300                    LDAQ  ! 2714,,PR0
         0 000163   000000 700200 xent               TSX0  ! X66_AUNWIND
         0 000164   000000 000200                    ZERO    0,128

   4457  0 000165                       S_FAULT      null
     2539     4458    1   S_FAULT: ;
     2540     4459    2        IF D_XDELTA THEN DO;
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:472  

   4459  0 000165   000000 234000 xsym               SZN     D_XDELTA
         0 000166   000173 605000 0                  TPL     s:4462

     2541     4460    2             CALL DDR$REPORT(R_SFAULT);

   4460  0 000167   000000 630400 1                  EPPR0   0
         0 000170   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000171   000000 701000 xent               TSX1    DDR$REPORT
         0 000172   000000 011000                    NOP     0

     2542     4461    2           END;                  /* FAULTS ARE PRINTED BY DEX$TRAP IN uDELTA */

     2543     4462    1        GOTO NEXT_ATTACH;

   4462  0 000173   000111 710000 0                  TRA     NEXT_ATTACH

(unnamed)
 Sect OctLoc
   1     000   000012 006000                                                    ....
     2544     4463    1   END DDA$DOATTACH;

PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:473  
--  Include file information  --

   DD$BASED.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$DOATTACH.

   Procedure DDA$DOATTACH requires 124 words for executable code.
   Procedure DDA$DOATTACH requires 10 words of local(AUTO) storage.

    No errors detected in file DDA$DO.:E05TSI    .
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:474  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:475  
          MINI XREF LISTING

ALL_ATTACH.CMD
      4355**DCL      4431>>IF
ALL_ATTACH.UNUSED
      4358**DCL      4359--REDEF    4363--REDEF
ATT$
      4372**DCL      4412<<ASSIGN   4413>>ASSIGN   4419>>DOWHILE  4420>>ASSIGN   4420>>ASSIGN   4421>>ASSIGN
ATT_OFFSET
      4373**DCL      4413<<ASSIGN   4419>>DOWHILE  4422>>ASSIGN   4424<<ASSIGN
AT_FIRST.ATT_OFFSET
      4399**DCL      4413>>ASSIGN
AT_FIRST.TEXT_OFFSET
      4397**DCL      4420>>ASSIGN
AT_FIRST.TEXT_SIZE
      4398**DCL      4419>>DOWHILE  4421>>ASSIGN
AT_FIRST.UNUSED
      4379**DCL      4380--REDEF    4384--REDEF
DDA$DO
      4404**DCL-ENT  4439--CALL
DDB$BREAK
      4405**DCL-ENT  4446--CALL
DDR$REPORT
      4406**DCL-ENT  4460--CALL
DDS$SCAN2
      4403**DCL-ENT  4423--CALL
D_XDELTA
      4402**DCL      4459>>IF
END_LIST
      4449**LABEL    4408--GOTO     4445--GOTO     4446--CALLALT
END_LIST1
      4443**LABEL    4423--CALLALT
FXCM
      4338**DCL      4431--IF
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:476  
MUST_RESTORE
      4371**DCL      4418<<ASSIGN   4436<<ASSIGN   4438<<ASSIGN   4441>>IF       4454>>IF
NEXT_ATTACH
      4435**LABEL    4462--GOTO
SAVEFAULT$
      4368**DCL      4434<<ASSIGN   4441>>ASSIGN   4454>>ASSIGN
SAVE_DO_SCAN
      4370**DCL      4415<<ASSIGN   4451>>ASSIGN
SAVE_REM_DO_SCAN
      4369**DCL      4414<<ASSIGN   4450>>ASSIGN
S_D.ACMDS$
      1668**DCL      4420<<ASSIGN
S_D.ACMDS_OFF
      1666**DCL      4422<<ASSIGN   4424>>ASSIGN
S_D.ACMDS_SIZE
      1670**DCL      4421<<ASSIGN
S_D.CURRENT_CHANNEL
      2397**DCL      2399--REDEF
S_D.DEBUGA
      1549**DCL      1551--REDEF
S_D.DIRCOM
      1901**DCL      4425--ASSIGN
S_D.DO$
      1500**DCL      4408>>IF       4412>>ASSIGN   4425<<ASSIGN   4431>>IF
S_D.DO_ATTACH
      1672**DCL      4411<<ASSIGN   4411>>ASSIGN   4449<<ASSIGN   4449>>ASSIGN   4456<<ASSIGN   4456>>ASSIGN
S_D.DO_SCAN
      1486**DCL      4415>>ASSIGN   4417<<ASSIGN   4451<<ASSIGN   4455<<ASSIGN
S_D.EIS
      2507**DCL      2536--REDEF
S_D.ENTRYCMD$
      2249**DCL      4435>>ASSIGN
S_D.FAULTCMD$
      1464**DCL      4431>>IF       4434>>ASSIGN   4435<<ASSIGN   4441<<ASSIGN   4454<<ASSIGN
S_D.FIXCOM
      1903**DCL      4431--IF
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:477  
S_D.HOST_MESSAGE_BUF_REMOTE
      2440**DCL      2441--REDEF    2455--REDEF
S_D.IXFIX
      1482**DCL      4431>>IF
S_D.JDE
      2054**DCL      2055--REDEF
S_D.L$.VALUE
      1607**DCL      1613--REDEF    1621--REDEF    1624--REDEF    1627--REDEF    1630--REDEF
S_D.L$.VALUE.L
      1608**DCL      1609--REDEF    1610--REDEF
S_D.L6_MESSAGE_BUF
      2461**DCL      2463--REDEF
S_D.OUTPUT
      2427**DCL      2429--REDEF
S_D.REMOTE_MSG.FNCC
      2446**DCL      2447--REDEF
S_D.REMOTE_MSG.STXC
      2442**DCL      2443--REDEF
S_D.REMOTE_MSG.SUBFNCC
      2450**DCL      2451--REDEF
S_D.REM_DO_SCAN
      1490**DCL      4414>>ASSIGN   4416<<REMEMBR  4450<<ASSIGN
S_D.REM_USERGO
      2270**DCL      4457>>UNWIND
S_D.STOP
      1543**DCL      4443<<ASSIGN   4445>>IF
S_D.SV
      1506**DCL      1527--REDEF
S_D$
      2758**DCL      1454--IMP-PTR  4408>>IF       4411>>ASSIGN   4411>>ASSIGN   4412>>ASSIGN   4414>>ASSIGN
      4415>>ASSIGN   4416>>REMEMBR  4417>>ASSIGN   4420>>ASSIGN   4421>>ASSIGN   4422>>ASSIGN   4424>>ASSIGN
      4425>>ASSIGN   4425>>ASSIGN   4431>>IF       4431>>IF       4431>>IF       4431>>IF       4434>>ASSIGN
      4435>>ASSIGN   4435>>ASSIGN   4441>>ASSIGN   4443>>ASSIGN   4445>>IF       4449>>ASSIGN   4449>>ASSIGN
      4450>>ASSIGN   4451>>ASSIGN   4454>>ASSIGN   4455>>ASSIGN   4456>>ASSIGN   4456>>ASSIGN   4457>>UNWIND
S_FAULT
      4457**LABEL    4416--REMEMBR
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:478  
USERGO
      4454**LABEL    4439--CALLALT
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:479  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DDA$DOATTACH File=DDA$DO.:E05TSI                              TUE 07/29/97 13:26 Page:480  
              MINI UREF LISTING

DDA$DOATTACH      24**PROC
