VERSION A06

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:1    
        1        1        /*M* X9WE$IO_ERROR  -- Handles error messages and status codes      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*-----------*/
        9        9        X9WE$IO_ERROR:         PROC (FAB, ALT_RET) ALTRET;
       10       10        /*-----------*/
       11       11
       12       12            %INCLUDE B_ERRORS_C;
       13     1138            %INCLUDE X8A_SYS_FILE;
       14     7408            %INCLUDE X8A_ERRCOM;
       15     7497            %INCLUDE X8A_LIBCOM;
       16     7717            %INCLUDE X9A_FAB;
       17     7904            %INCLUDE X9A_IO;
       18     8054            %INCLUDE X9A_LIB_IO;
       19     8438            %DCL_FAB;
       20     8560            %USE_BLOCK (@NAME = USE_BLOCK);
       21     8567
       22     8568    1       DCL M$DO               DCB;
       23     8569    1       DCL ERROR_BUFFER       CHAR(120)  STATIC;
       24     8570    1       DCL ERROR#             UBIN WORD;
       25     8571    1       DCL IO_STATUS          CHAR(2) BASED (FAB.IO_STATUS$);
       26     8572    1       DCL ALT_RET            BIT(1) ALIGNED;
       27     8573    1       DCL NAME_LENGTH        SBIN WORD;
       28     8574    1       DCL X8ER$ERROR         ENTRY(3);
       29     8575    1       DCL X9MA$ALLOCATE      ENTRY(2);
       30     8576
       31     8577            %FPT_ERRMSG (FPTN=ERR_MSG, OUTDCB1 = M$DO, BUF = ERROR_BUFFER,
       32     8578                         VFC = 'a');
       33     8605
       34     8606        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:2    
       35     8607    1       DCB$ = DCBADDR (FAB.DCB_NUM);
       36     8608
       37     8609    1       IF FAB.B.FAST_SEQUENTIAL THEN
       38     8610    1         ERROR# = FAB.XSA.ERR.CODE;
       39     8611    1       ELSE
       40     8612    1         ERROR# = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR.CODE;
       41     8613
       42     8614    2       DO CASE (ERROR#);
       43     8615
       44     8616    2         CASE (%E$EOF);
       45     8617    2           IO_STATUS = %END_OF_FILE;
       46     8618    2           IF ALT_RET THEN
       47     8619    2             ALTRETURN;
       48     8620    2           ELSE
       49     8621    2             CALL SYSTEM_ERROR_MESSAGE;
       50     8622
       51     8623    2         CASE (%E$DUPKEY);
       52     8624    2           IO_STATUS = %DUPLICATE_KEY;
       53     8625    2           IF ALT_RET THEN
       54     8626    2             ALTRETURN;
       55     8627    2           ELSE
       56     8628    2             CALL SYSTEM_ERROR_MESSAGE;
       57     8629
       58     8630    2         CASE (%E$NEWREC);
       59     8631    2           IO_STATUS = %NO_RANDOM_RECORD;
       60     8632    2           IF ALT_RET THEN
       61     8633    2             ALTRETURN;
       62     8634    2           ELSE
       63     8635    2             CALL SYSTEM_ERROR_MESSAGE;
       64     8636
       65     8637    2         CASE (%E$OLDREC);
       66     8638    2           IO_STATUS = %DUPLICATE_KEY;
       67     8639    2           IF ALT_RET THEN
       68     8640    2             ALTRETURN;
       69     8641    2           ELSE
       70     8642    2             CALL SYSTEM_ERROR_MESSAGE;
       71     8643        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:3    
       72     8644    2         CASE (%E$KEYORDER);
       73     8645    2           IO_STATUS = %SEQUENCE_ERROR;
       74     8646    2           IF ALT_RET THEN
       75     8647    2             ALTRETURN;
       76     8648    2           ELSE
       77     8649    2             CALL SYSTEM_ERROR_MESSAGE;
       78     8650
       79     8651    2         CASE (%E$FILLIM);
       80     8652    2           IF FAB.LAST_IO = %WRITE THEN
       81     8653    2             IO_STATUS = %EXTERNAL_BOUNDARY_REACHED;
       82     8654    2           ELSE
       83     8655    2             IO_STATUS = %NO_RANDOM_RECORD;
       84     8656    2           IF ALT_RET THEN
       85     8657    2             ALTRETURN;
       86     8658    2           ELSE
       87     8659    2             CALL SYSTEM_ERROR_MESSAGE;
       88     8660
       89     8661        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:4    
       90     8662    2         CASE (%E$NOREC);
       91     8663    2           IF FAB.B.SHARED_INDEX_ALT    AND         /*#35064*/ /*#24102*/
       92     8664    2              FAB.LAST_IO = %READ_NEXT      THEN               /*#35064*/
       93     8665    3             DO;
       94     8666    3               RETURN;
       95     8667    3             END;
       96     8668
       97     8669    2         CASE (%E$NOKEY);
       98     8670    2           IF FAB.B.SHARED_INDEX_ALT    AND        /*#35064*/ /*#24102*/
       99     8671    2              FAB.LAST_IO = %READ_NEXT     THEN                /*#35064*/
      100     8672    3             DO;
      101     8673    3               RETURN;                                         /*#32658*/
      102     8674    3             END;
      103     8675    2           ELSE
      104     8676    3             DO;
      105     8677    3               IO_STATUS = %NO_RANDOM_RECORD;
      106     8678    3               IF ALT_RET THEN
      107     8679    3                 ALTRETURN;
      108     8680    3               ELSE
      109     8681    3                 CALL SYSTEM_ERROR_MESSAGE;
      110     8682    3             END;
      111     8683        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:5    
      112     8684    2         CASE (%E$LD);
      113     8685
      114     8686    2           IO_STATUS = %BAD_LENGTH;
      115     8687
      116     8688    2         CASE (%E$DCBOPEN);
      117     8689    2           FAB.FILE_STATUS = %FILE_OPEN;
      118     8690
      119     8691    2         CASE (%E$NOFILE);
      120     8692    2           IF FAB.B.OPTIONAL_FILE THEN
      121     8693    3             DO;
      122     8694    3               IO_STATUS = %OPT_FILE_NOT_PRES;
      123     8695    3               FAB.FILE_STATUS = %FILE_NOT_PRESENT;
      124     8696    3             END;
      125     8697    2           ELSE
      126     8698    3             DO;
      127     8699    3               IO_STATUS = %NO_FILE;
      128     8700    3               FAB.FILE_STATUS = %FILE_NOT_PRESENT;
      129     8701    3               CALL SYSTEM_ERROR_MESSAGE;
      130     8702    3             END;
      131     8703
      132     8704    2         CASE (ELSE);
      133     8705    2           IO_STATUS = %IMPLEMENTOR_DEFINED ;
      134     8706    2           CALL SYSTEM_ERROR_MESSAGE;
      135     8707
      136     8708    2       END; /* CASE */
      137     8709    1       RETURN;
      138     8710        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:6    
      139     8711        /*------------------*/
      140     8712    1   SYSTEM_ERROR_MESSAGE:         PROC;
      141     8713        /*------------------*/
      142     8714
      143     8715    2       CALL USE_PROC
      144     8716    2       WHENALTRETURN
      145     8717    3       DO;
      146     8718    3         ERR_MSG.CODE_ = VECTOR (B$TCB$-> B$TCB.ALT$-> B$ALT.ERR);
      147     8719    3         ERR_MSG.V.DCB# = FAB.DCB_NUM;
      148     8720    3         CALL M$ERRMSG (ERR_MSG);
      149     8721    3         SPECIAL_ERR_MSG = ' ';
      150     8722    3         CALL X8ER$ERROR (%SPECIAL_MSG, SPECIAL_ERR_MSG);
      151     8723    3         CALL M$XXX;
      152     8724    3       END;
      153     8725
      154     8726    2     END SYSTEM_ERROR_MESSAGE;  /* proc */
      155     8727
      156     8728        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:7    
      157     8729        /*------------------*/
      158     8730    1   X9WE$IO_ERROR_STATUS:         ENTRY (FAB, ALT_RET) ALTRET;
      159     8731        /*------------------*/
      160     8732
      161     8733    1       DCB$ = DCBADDR (FAB.DCB_NUM);
      162     8734
      163     8735    2       DO SELECT (IO_STATUS);
      164     8736
      165     8737    2         SELECT (%NOT_OPEN_INPUT);
      166     8738
      167     8739    2           CALL USE_PROC
      168     8740    2           WHENALTRETURN
      169     8741    3             DO;
      170     8742    3               NAME_LENGTH = M$XX.DCBNAME.L;
      171     8743    3               CALL X8ER$ERROR (%IO_NOT_OPEN_INPUT, M$XX.DCBNAME.N,
      172     8744    3                                                    NAME_LENGTH   );
      173     8745    3               CALL M$XXX;
      174     8746    3             END;
      175     8747
      176     8748    2         SELECT (%NOT_OPEN_OUTPUT);
      177     8749
      178     8750    2           CALL USE_PROC
      179     8751    2           WHENALTRETURN
      180     8752    3             DO;
      181     8753    3               NAME_LENGTH = M$XX.DCBNAME.L;
      182     8754    3               CALL X8ER$ERROR (%IO_NOT_OPEN_OUTPUT, M$XX.DCBNAME.N,
      183     8755    3                                                     NAME_LENGTH   );
      184     8756    3               CALL M$XXX;
      185     8757    3             END;
      186     8758
      187     8759    2         SELECT (%NOT_OPEN_IO);
      188     8760
      189     8761    2           CALL USE_PROC
      190     8762    2           WHENALTRETURN
      191     8763    3             DO;
      192     8764    3               NAME_LENGTH = M$XX.DCBNAME.L;
      193     8765    3               CALL X8ER$ERROR (%IO_NOT_OPEN_IO, M$XX.DCBNAME.N,
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:8    
      194     8766    3                                                 NAME_LENGTH    );
      195     8767    3               CALL M$XXX;
      196     8768    3             END;
      197     8769
      198     8770    2         SELECT (%LOCKED);
      199     8771
      200     8772    2           CALL USE_PROC
      201     8773    2           WHENALTRETURN
      202     8774    3             DO;
      203     8775    3               NAME_LENGTH = M$XX.DCBNAME.L;   /* convert ubin to sbin */
      204     8776    3               CALL X8ER$ERROR (%IO_LOCKED, M$XX.DCBNAME.N,
      205     8777    3                                                 NAME_LENGTH    );
      206     8778    3               CALL M$XXX;
      207     8779    3             END;
      208     8780
      209     8781    2         SELECT (%ATTRIBUTE_CONFLICT);
      210     8782
      211     8783    2           CALL USE_PROC
      212     8784    2           WHENALTRETURN
      213     8785    3             DO;
      214     8786    3               NAME_LENGTH = M$XX.DCBNAME.L;   /* convert ubin to sbin */
      215     8787    3               CALL X8ER$ERROR (%IO_ATTRIBUTE_CONFLICT, M$XX.DCBNAME.N,
      216     8788    3                                                        NAME_LENGTH   );
      217     8789    3               CALL M$XXX;
      218     8790    3             END;
      219     8791
      220     8792    2         SELECT (%NON_REEL_MEDIUM);
      221     8793
      222     8794    2           CALL USE_PROC
      223     8795    2           WHENALTRETURN
      224     8796    3             DO;
      225     8797    3               NAME_LENGTH = M$XX.DCBNAME.L;   /* convert ubin to sbin */
      226     8798    3               CALL X8ER$ERROR (%IO_NOT_MASS_STORAGE, M$XX.DCBNAME.N,
      227     8799    3                                                      NAME_LENGTH    );
      228     8800    3               CALL M$XXX;
      229     8801    3             END;
      230     8802
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:9    
      231     8803    2         SELECT (%NOT_OPEN);
      232     8804
      233     8805    2           CALL USE_PROC
      234     8806    2           WHENALTRETURN
      235     8807    3             DO;
      236     8808    3               NAME_LENGTH = M$XX.DCBNAME.L;
      237     8809    3               CALL X8ER$ERROR (%IO_NOT_OPEN, M$XX.DCBNAME.N,
      238     8810    3                                              NAME_LENGTH    );
      239     8811    3               CALL M$XXX;
      240     8812    3             END;
      241     8813
      242     8814    2         SELECT (%ALREADY_OPEN);
      243     8815
      244     8816    2           CALL USE_PROC
      245     8817    2           WHENALTRETURN
      246     8818    3             DO;
      247     8819    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */
      248     8820    3               CALL X8ER$ERROR (%IO_ALREADY_OPEN, M$XX.DCBNAME.N,
      249     8821    3                                                 NAME_LENGTH  );
      250     8822    3               CALL M$XXX;
      251     8823    3             END;
      252     8824
      253     8825    2         SELECT (%PRIOR_NOT_READ);
      254     8826
      255     8827    2           CALL USE_PROC
      256     8828    2           WHENALTRETURN
      257     8829    3             DO;                                              /*#34545*/
      258     8830    3               NAME_LENGTH = M$XX.DCBNAME.L; /* convert ubin to sbin */
      259     8831    3               CALL X8ER$ERROR (%IO_PRIOR_NOT_READ, M$XX.DCBNAME.N,
      260     8832    3                                                    NAME_LENGTH);
      261     8833    3               CALL M$XXX;
      262     8834    3             END;
      263     8835
      264     8836    2         SELECT (%NO_NEXT_RECORD);
      265     8837
      266     8838    2           CALL USE_PROC
      267     8839    2           WHENALTRETURN
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:10   
      268     8840    3             DO;                                               /*#34545*/
      269     8841    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */
      270     8842    3               CALL X8ER$ERROR (%IO_NO_NEXT_RECORD, M$XX.DCBNAME.N,
      271     8843    3                                                    NAME_LENGTH);
      272     8844    3               CALL M$XXX;
      273     8845    3             END;
      274     8846
      275     8847    2         SELECT (%NO_RANDOM_RECORD);
      276     8848
      277     8849    2           IF ALT_RET THEN
      278     8850    2             ALTRETURN;
      279     8851
      280     8852    2           CALL USE_PROC
      281     8853    2           WHENALTRETURN
      282     8854    3             DO;                                               /*#34545*/
      283     8855    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */
      284     8856    3               CALL X8ER$ERROR (%IO_NO_RANDOM_RECORD, M$XX.DCBNAME.N,
      285     8857    3                                                      NAME_LENGTH);
      286     8858    3               CALL M$XXX;
      287     8859    3             END;
      288     8860
      289     8861    2         SELECT (%BOUNDARY_VIOLATION);
      290     8862
      291     8863    2           CALL USE_PROC
      292     8864    2           WHENALTRETURN
      293     8865    3             DO;
      294     8866    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */
      295     8867    3               CALL X8ER$ERROR (%IO_BOUNDARY_VIOLATION, M$XX.DCBNAME.N,
      296     8868    3                                                        NAME_LENGTH);
      297     8869    3               CALL M$XXX;
      298     8870    3             END;
      299     8871
      300     8872    2         SELECT (%KEY_OVERFLOW);
      301     8873    2           IF ALT_RET THEN
      302     8874    2             ALTRETURN;
      303     8875    2           ELSE
      304     8876    2             CALL USE_PROC
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:11   
      305     8877    2               WHENALTRETURN
      306     8878    3                 DO;
      307     8879    3                   NAME_LENGTH = M$XX.DCBNAME.L; /* convert ubin to sbin */
      308     8880    3                   CALL X8ER$ERROR (%IO_KEY_OVERFLOW, M$XX.DCBNAME.N,
      309     8881    3                                                      NAME_LENGTH);
      310     8882    3                   CALL M$XXX;
      311     8883    3                 END;
      312     8884
      313     8885    2         SELECT (%END_OF_FILE);
      314     8886
      315     8887    2           IF ALT_RET THEN
      316     8888    2             ALTRETURN;
      317     8889    2           CALL USE_PROC
      318     8890    2           WHENALTRETURN
      319     8891    3             DO;
      320     8892    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */
      321     8893    3               CALL X8ER$ERROR (%IO_END_OF_FILE, M$XX.DCBNAME.N,
      322     8894    3                                                        NAME_LENGTH   );
      323     8895    3               CALL M$XXX;
      324     8896    3             END;
      325     8897
      326     8898    2         SELECT (ELSE);
      327     8899
      328     8900    2           CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WE', 4);
      329     8901
      330     8902    2       END;  /* case */
      331     8903
      332     8904        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:12   
      333     8905        /*--------*/
      334     8906    1     USE_PROC:            PROC  ALTRET;
      335     8907        /*--------*/
      336     8908
      337     8909    2       DCL USE_PROC$ EPTR;
      338     8910
      339     8911    2       DCL 1 X9OS$EXIT_BLOCK SYMREF DALIGNED,
      340     8912    2             2 REM (0:63) REMEMBER,
      341     8913    2             2 ITEM (0:63) REDEF REM,
      342     8914    2               3 TYPE SBIN,
      343     8915    2               3 PTR$ PTR,
      344     8916    2               3 EPTR$ REDEF PTR$ EPTR,
      345     8917    2             2 PREV$ PTR,
      346     8918    2             2 NEXT$ PTR;
      347     8919    2       DCL X9OS$EXIT_INDEX SBIN SYMREF;
      348     8920    2       DCL 1 EXIT$BLOCK DALIGNED BASED (EXIT_BLOCK$),
      349     8921    2             2 REM (0:63) REMEMBER,
      350     8922    2             2 ITEM (0:63) REDEF REM,
      351     8923    2               3 TYPE SBIN,
      352     8924    2               3 PTR$ PTR,
      353     8925    2               3 EPTR$ REDEF PTR$ EPTR,
      354     8926    2             2 PREV$ PTR,
      355     8927    2             2 NEXT$ PTR;
      356     8928    2       DCL EXIT_BLOCK$ PTR;
      357     8929    2       DCL I SBIN;
      358     8930        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:13   
      359     8931    2       USE_PROC$ = ENTADDR(NIL);
      360     8932
      361     8933    3       IF FAB.USE_PROC$  ~= ENTADDR(NIL) THEN DO;
      362     8934    4         IF FAB.B.USE_PROC THEN DO;
      363     8935    4           CALL X8ER$ERROR (%CALL_USE_RECURSIVE);
      364     8936    4           ALTRETURN;
      365     8937    4         END;
      366     8938    3         USE_PROC$ = FAB.USE_PROC$;
      367     8939    3       END;
      368     8940    2       ELSE
      369     8941    2         IF  FAB.USE_BLOCK$ ~= ADDR(NIL) THEN
      370     8942    2         IF  FAB.FILE_STATUS = %FILE_OPEN
      371     8943    2         OR  FAB.LAST_IO = %OPEN  THEN
      372     8944    3           DO CASE (M$XX.FUN#);
      373     8945
      374     8946    3             CASE (%IN);
      375     8947
      376     8948    3               USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.INPUT$;
      377     8949
      378     8950    3             CASE (%UPDATE);  /* I/O */
      379     8951
      380     8952    3               USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.I_O$;
      381     8953
      382     8954    3             CASE (%CREATE);  /* output or extend */
      383     8955
      384     8956    3               IF M$XX.EXIST# = %NEWFILE THEN
      385     8957    4                DO;
      386     8958    4                  USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.OUTPUT$;
      387     8959    4                END;
      388     8960    3              ELSE
      389     8961    4                DO;        /*  extend  */
      390     8962    4                  USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.EXTEND$;
      391     8963    4                END;
      392     8964
      393     8965
      394     8966    3             CASE (%CP6_DEFAULT);
      395     8967
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:14   
      396     8968    3               ALTRETURN;
      397     8969    3             CASE (ELSE);
      398     8970
      399     8971    3               CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WE', 4);
      400     8972
      401     8973    3           END;  /* case */
      402     8974    2         ELSE
      403     8975    2           ALTRETURN;
      404     8976
      405     8977    2       IF USE_PROC$ = ENTADDR(NIL) THEN
      406     8978    2         ALTRETURN;
      407     8979    2       FAB.B.USE_PROC_SAVE = LIBCOM.USE_PROC;
      408     8980    2       LIBCOM.USE_PROC = %TRUE;
      409     8981    2       FAB.B.USE_PROC = %TRUE;
      410     8982    2       IF LIBCOM.EXIT_PROG_IN_DECL THEN
      411     8983    3         DO;
      412     8984    3           EXIT_BLOCK$ = ADDR (X9OS$EXIT_BLOCK);
      413     8985    3           IF X9OS$EXIT_INDEX >= 64 THEN
      414     8986    4             DO;
      415     8987    4               I = X9OS$EXIT_INDEX;
      416     8988    5               DO WHILE I > 64;
      417     8989    5                 EXIT_BLOCK$ = EXIT$BLOCK.NEXT$;
      418     8990    5                 I = I - 64;
      419     8991    5               END;
      420     8992    4               IF I = 64 THEN
      421     8993    5                 DO;
      422     8994    5                   I = 0;
      423     8995    5                   IF EXIT$BLOCK.NEXT$ = ADDR (NIL) THEN
      424     8996    6                     DO;
      425     8997    6                       CALL X9MA$ALLOCATE (EXIT$BLOCK.NEXT$, SIZEC (X9OS$EXIT_BLOCK));
      426     8998    6                       EXIT$BLOCK.NEXT$ -> EXIT$BLOCK.PREV$ = EXIT_BLOCK$;
      427     8999    6                     END;
      428     9000    5                   EXIT_BLOCK$ = EXIT$BLOCK.NEXT$;
      429     9001    5                 END;
      430     9002    4               EXIT$BLOCK.ITEM.TYPE (I) = 0;
      431     9003    4               EXIT$BLOCK.ITEM.PTR$ (I) = ADDR (FAB);
      432     9004    4             END; /* IF X9OS$EXIT_INDEX >= 64 */
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:15   
      433     9005    3           ELSE
      434     9006    4             DO;
      435     9007    4               EXIT$BLOCK.ITEM.TYPE (X9OS$EXIT_INDEX) = 0;
      436     9008    4               EXIT$BLOCK.ITEM.PTR$ (X9OS$EXIT_INDEX) = ADDR (FAB);
      437     9009    4             END;
      438     9010    3           X9OS$EXIT_INDEX = X9OS$EXIT_INDEX + 1;
      439     9011    3         END; /* IF LIBCOM.EXIT_PROG_IN_DECL */
      440     9012    2       CALL USE_PROC$;
      441     9013    2       X9OS$EXIT_INDEX = X9OS$EXIT_INDEX - 1;
      442     9014    2       FAB.B.USE_PROC = %FALSE;
      443     9015    2       LIBCOM.USE_PROC = FAB.B.USE_PROC_SAVE;
      444     9016    2     END USE_PROC;  /* proc */
      445     9017    1   END X9WE$IO_ERROR;  /* PROC */
      446     9018        %EOD;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:16   
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
      No diagnostics issued in procedure X9WE$IO_ERROR.

   Procedure X9WE$IO_ERROR requires 837 words for executable code.
   Procedure X9WE$IO_ERROR requires 78 words of local(AUTO) storage.

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:17   

 Object Unit name= X9WE$IO_ERROR                              File name= X9WE.:X8A6TOU
 UTS= AUG 09 '97 11:06:47.60 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none    20     24  LIBCOM
    2  LblCom even  none     1      1  DEC_OR_COMMA
    3  LblCom even  none    20     24  IN_TEMP
    4  LblCom even  none     1      1  OVRCHR
    5  LblCom even  none     1      1  SELECT_TIME
    6  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    7  LblCom even  none    18     22  DSPLY_SAVE
    8  LblCom even  none     3      3  D_DATE
    9  LblCom even  none     3      3  D_TIME
   10  LblCom even  none     1      1  D_DAY
   11  LblCom even  none     2      2  C_DATE
   12  LblCom even  none     2      2  C_TIME
   13  LblCom even  none     2      2  C_DAY
   14  LblCom even  none     1      1  RTHOLD2
   15  LblCom even  none     1      1  LTHOLD2
   16  LblCom even  none     1      1  NDX2
   17  LblCom even  none     1      1  IN_LEN
   18   DCB   even  none     0      0  M$DO
   19   Data  even  none    56     70  X9WE$IO_ERROR
   20  RoData even  UTS     22     26  X9WE$IO_ERROR
   21   Proc  even  none   837   1505  X9WE$IO_ERROR
   22  RoData even  none    48     60  X9WE$IO_ERROR
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:18   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes    yes     yes      Std        2  X9WE$IO_ERROR
    21    453          yes     yes      Std        2  X9WE$IO_ERROR_STATUS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 X8ER$ERROR
         yes           Std       2 X9MA$ALLOCATE
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                M$DO
     X9OS$EXIT_BLOCK                       X9OS$EXIT_INDEX

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:19   


        1        1        /*M* X9WE$IO_ERROR  -- Handles error messages and status codes      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*-----------*/
        9        9        X9WE$IO_ERROR:         PROC (FAB, ALT_RET) ALTRET;

      9 21 000000   000000 700200 xent  X9WE$IO_ERR* TSX0  ! X66_AUTO_2
        21 000001   000116 000002                    ZERO    78,2

       10       10        /*-----------*/
       11       11
       12       12            %INCLUDE B_ERRORS_C;
       13     1138            %INCLUDE X8A_SYS_FILE;
       14     7408            %INCLUDE X8A_ERRCOM;
       15     7497            %INCLUDE X8A_LIBCOM;
       16     7717            %INCLUDE X9A_FAB;
       17     7904            %INCLUDE X9A_IO;
       18     8054            %INCLUDE X9A_LIB_IO;
       19     8438            %DCL_FAB;
       20     8560            %USE_BLOCK (@NAME = USE_BLOCK);
       21     8567
       22     8568    1       DCL M$DO               DCB;
       23     8569    1       DCL ERROR_BUFFER       CHAR(120)  STATIC;
       24     8570    1       DCL ERROR#             UBIN WORD;
       25     8571    1       DCL IO_STATUS          CHAR(2) BASED (FAB.IO_STATUS$);
       26     8572    1       DCL ALT_RET            BIT(1) ALIGNED;
       27     8573    1       DCL NAME_LENGTH        SBIN WORD;
       28     8574    1       DCL X8ER$ERROR         ENTRY(3);
       29     8575    1       DCL X9MA$ALLOCATE      ENTRY(2);
       30     8576
       31     8577            %FPT_ERRMSG (FPTN=ERR_MSG, OUTDCB1 = M$DO, BUF = ERROR_BUFFER,
       32     8578                         VFC = 'a');
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:20   
       33     8605
       34     8606        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:21   
       35     8607    1       DCB$ = DCBADDR (FAB.DCB_NUM);

   8607 21 000002   000000 470400 22                 LDP0    0
        21 000003   000000 471500                    LDP1    0,,PR0
        21 000004   200003 473500                    LDP3    @FAB,,AUTO
        21 000005   300034 220100                    LDX0    28,,PR3
        21 000006   100000 236110                    LDQ     0,X0,PR1
        21 000007   200076 756100                    STQ     DCB$,,AUTO

       36     8608
       37     8609    1       IF FAB.B.FAST_SEQUENTIAL THEN

   8609 21 000010   300032 236100                    LDQ     26,,PR3
        21 000011   000004 316003                    CANQ    4,DU
        21 000012   000020 600000 21                 TZE     s:8612

       38     8610    1         ERROR# = FAB.XSA.ERR.CODE;

   8610 21 000013   300061 236100                    LDQ     49,,PR3
        21 000014   000003 772000                    QRL     3
        21 000015   037777 376007                    ANQ     16383,DL
        21 000016   200101 756100                    STQ     ERROR#,,AUTO
        21 000017   000026 710000 21                 TRA     s:8614

       39     8611    1       ELSE
       40     8612    1         ERROR# = B$TCB$-> B$TCB.ALT$-> B$ALT.ERR.CODE;

   8612 21 000020   000000 474400 xsym               LDP4    B$TCB$
        21 000021   400000 475500                    LDP5    0,,PR4
        21 000022   500102 236100                    LDQ     66,,PR5
        21 000023   000003 772000                    QRL     3
        21 000024   037777 376007                    ANQ     16383,DL
        21 000025   200101 756100                    STQ     ERROR#,,AUTO

       41     8613
       42     8614    2       DO CASE (ERROR#);

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:22   
   8614 21 000026   000006 136007                    SBLQ    6,DL
        21 000027   000154 116007                    CMPQ    108,DL
        21 000030   000032 602006 21                 TNC     s:8614+4,QL
        21 000031   000404 710000 21                 TRA     s:8705
        21 000032   000206 710000 21                 TRA     s:8617
        21 000033   000351 710000 21                 TRA     s:8686
        21 000034   000404 710000 21                 TRA     s:8705
        21 000035   000404 710000 21                 TRA     s:8705
        21 000036   000404 710000 21                 TRA     s:8705
        21 000037   000404 710000 21                 TRA     s:8705
        21 000040   000404 710000 21                 TRA     s:8705
        21 000041   000404 710000 21                 TRA     s:8705
        21 000042   000404 710000 21                 TRA     s:8705
        21 000043   000404 710000 21                 TRA     s:8705
        21 000044   000404 710000 21                 TRA     s:8705
        21 000045   000404 710000 21                 TRA     s:8705
        21 000046   000404 710000 21                 TRA     s:8705
        21 000047   000404 710000 21                 TRA     s:8705
        21 000050   000404 710000 21                 TRA     s:8705
        21 000051   000404 710000 21                 TRA     s:8705
        21 000052   000404 710000 21                 TRA     s:8705
        21 000053   000404 710000 21                 TRA     s:8705
        21 000054   000404 710000 21                 TRA     s:8705
        21 000055   000404 710000 21                 TRA     s:8705
        21 000056   000404 710000 21                 TRA     s:8705
        21 000057   000404 710000 21                 TRA     s:8705
        21 000060   000404 710000 21                 TRA     s:8705
        21 000061   000404 710000 21                 TRA     s:8705
        21 000062   000404 710000 21                 TRA     s:8705
        21 000063   000404 710000 21                 TRA     s:8705
        21 000064   000404 710000 21                 TRA     s:8705
        21 000065   000404 710000 21                 TRA     s:8705
        21 000066   000404 710000 21                 TRA     s:8705
        21 000067   000404 710000 21                 TRA     s:8705
        21 000070   000404 710000 21                 TRA     s:8705
        21 000071   000404 710000 21                 TRA     s:8705
        21 000072   000404 710000 21                 TRA     s:8705
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:23   
        21 000073   000404 710000 21                 TRA     s:8705
        21 000074   000404 710000 21                 TRA     s:8705
        21 000075   000404 710000 21                 TRA     s:8705
        21 000076   000404 710000 21                 TRA     s:8705
        21 000077   000404 710000 21                 TRA     s:8705
        21 000100   000404 710000 21                 TRA     s:8705
        21 000101   000404 710000 21                 TRA     s:8705
        21 000102   000404 710000 21                 TRA     s:8705
        21 000103   000404 710000 21                 TRA     s:8705
        21 000104   000404 710000 21                 TRA     s:8705
        21 000105   000404 710000 21                 TRA     s:8705
        21 000106   000404 710000 21                 TRA     s:8705
        21 000107   000404 710000 21                 TRA     s:8705
        21 000110   000404 710000 21                 TRA     s:8705
        21 000111   000404 710000 21                 TRA     s:8705
        21 000112   000404 710000 21                 TRA     s:8705
        21 000113   000404 710000 21                 TRA     s:8705
        21 000114   000404 710000 21                 TRA     s:8705
        21 000115   000404 710000 21                 TRA     s:8705
        21 000116   000404 710000 21                 TRA     s:8705
        21 000117   000404 710000 21                 TRA     s:8705
        21 000120   000404 710000 21                 TRA     s:8705
        21 000121   000247 710000 21                 TRA     s:8638
        21 000122   000234 710000 21                 TRA     s:8631
        21 000123   000404 710000 21                 TRA     s:8705
        21 000124   000404 710000 21                 TRA     s:8705
        21 000125   000404 710000 21                 TRA     s:8705
        21 000126   000327 710000 21                 TRA     s:8670
        21 000127   000404 710000 21                 TRA     s:8705
        21 000130   000404 710000 21                 TRA     s:8705
        21 000131   000404 710000 21                 TRA     s:8705
        21 000132   000404 710000 21                 TRA     s:8705
        21 000133   000404 710000 21                 TRA     s:8705
        21 000134   000404 710000 21                 TRA     s:8705
        21 000135   000262 710000 21                 TRA     s:8645
        21 000136   000404 710000 21                 TRA     s:8705
        21 000137   000404 710000 21                 TRA     s:8705
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:24   
        21 000140   000404 710000 21                 TRA     s:8705
        21 000141   000404 710000 21                 TRA     s:8705
        21 000142   000404 710000 21                 TRA     s:8705
        21 000143   000404 710000 21                 TRA     s:8705
        21 000144   000275 710000 21                 TRA     s:8652
        21 000145   000404 710000 21                 TRA     s:8705
        21 000146   000404 710000 21                 TRA     s:8705
        21 000147   000404 710000 21                 TRA     s:8705
        21 000150   000404 710000 21                 TRA     s:8705
        21 000151   000404 710000 21                 TRA     s:8705
        21 000152   000320 710000 21                 TRA     s:8663
        21 000153   000404 710000 21                 TRA     s:8705
        21 000154   000404 710000 21                 TRA     s:8705
        21 000155   000221 710000 21                 TRA     s:8624
        21 000156   000404 710000 21                 TRA     s:8705
        21 000157   000404 710000 21                 TRA     s:8705
        21 000160   000404 710000 21                 TRA     s:8705
        21 000161   000404 710000 21                 TRA     s:8705
        21 000162   000404 710000 21                 TRA     s:8705
        21 000163   000404 710000 21                 TRA     s:8705
        21 000164   000404 710000 21                 TRA     s:8705
        21 000165   000404 710000 21                 TRA     s:8705
        21 000166   000404 710000 21                 TRA     s:8705
        21 000167   000404 710000 21                 TRA     s:8705
        21 000170   000356 710000 21                 TRA     s:8689
        21 000171   000404 710000 21                 TRA     s:8705
        21 000172   000404 710000 21                 TRA     s:8705
        21 000173   000404 710000 21                 TRA     s:8705
        21 000174   000404 710000 21                 TRA     s:8705
        21 000175   000404 710000 21                 TRA     s:8705
        21 000176   000404 710000 21                 TRA     s:8705
        21 000177   000404 710000 21                 TRA     s:8705
        21 000200   000404 710000 21                 TRA     s:8705
        21 000201   000404 710000 21                 TRA     s:8705
        21 000202   000404 710000 21                 TRA     s:8705
        21 000203   000404 710000 21                 TRA     s:8705
        21 000204   000404 710000 21                 TRA     s:8705
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:25   
        21 000205   000361 710000 21                 TRA     s:8692

       43     8615
       44     8616    2         CASE (%E$EOF);

       45     8617    2           IO_STATUS = %END_OF_FILE;

   8617 21 000206   300036 474500                    LDP4    30,,PR3
        21 000207   040100 100400                    MLR     fill='040'O
        21 000210   000000 000002 20                 ADSC9   0                        cn=0,n=2
        21 000211   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

       46     8618    2           IF ALT_RET THEN

   8618 21 000212   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000213   400000 234100                    SZN     0,,PR4
        21 000214   000216 605000 21                 TPL     s:8621

       47     8619    2             ALTRETURN;

   8619 21 000215   000000 702200 xent               TSX2  ! X66_AALT

       48     8620    2           ELSE
       49     8621    2             CALL SYSTEM_ERROR_MESSAGE;

   8621 21 000216   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000217   000000 011000                    NOP     0
        21 000220   000412 710000 21                 TRA     s:8709

       50     8622
       51     8623    2         CASE (%E$DUPKEY);

       52     8624    2           IO_STATUS = %DUPLICATE_KEY;

   8624 21 000221   300036 474500                    LDP4    30,,PR3
        21 000222   040100 100400                    MLR     fill='040'O
        21 000223   000001 000002 20                 ADSC9   1                        cn=0,n=2
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:26   
        21 000224   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

       53     8625    2           IF ALT_RET THEN

   8625 21 000225   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000226   400000 234100                    SZN     0,,PR4
        21 000227   000231 605000 21                 TPL     s:8628

       54     8626    2             ALTRETURN;

   8626 21 000230   000000 702200 xent               TSX2  ! X66_AALT

       55     8627    2           ELSE
       56     8628    2             CALL SYSTEM_ERROR_MESSAGE;

   8628 21 000231   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000232   000000 011000                    NOP     0
        21 000233   000412 710000 21                 TRA     s:8709

       57     8629
       58     8630    2         CASE (%E$NEWREC);

       59     8631    2           IO_STATUS = %NO_RANDOM_RECORD;

   8631 21 000234   300036 474500                    LDP4    30,,PR3
        21 000235   040100 100400                    MLR     fill='040'O
        21 000236   000002 000002 20                 ADSC9   2                        cn=0,n=2
        21 000237   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

       60     8632    2           IF ALT_RET THEN

   8632 21 000240   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000241   400000 234100                    SZN     0,,PR4
        21 000242   000244 605000 21                 TPL     s:8635

       61     8633    2             ALTRETURN;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:27   
   8633 21 000243   000000 702200 xent               TSX2  ! X66_AALT

       62     8634    2           ELSE
       63     8635    2             CALL SYSTEM_ERROR_MESSAGE;

   8635 21 000244   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000245   000000 011000                    NOP     0
        21 000246   000412 710000 21                 TRA     s:8709

       64     8636
       65     8637    2         CASE (%E$OLDREC);

       66     8638    2           IO_STATUS = %DUPLICATE_KEY;

   8638 21 000247   300036 474500                    LDP4    30,,PR3
        21 000250   040100 100400                    MLR     fill='040'O
        21 000251   000001 000002 20                 ADSC9   1                        cn=0,n=2
        21 000252   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

       67     8639    2           IF ALT_RET THEN

   8639 21 000253   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000254   400000 234100                    SZN     0,,PR4
        21 000255   000257 605000 21                 TPL     s:8642

       68     8640    2             ALTRETURN;

   8640 21 000256   000000 702200 xent               TSX2  ! X66_AALT

       69     8641    2           ELSE
       70     8642    2             CALL SYSTEM_ERROR_MESSAGE;

   8642 21 000257   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000260   000000 011000                    NOP     0
        21 000261   000412 710000 21                 TRA     s:8709

       71     8643        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:28   
       72     8644    2         CASE (%E$KEYORDER);

       73     8645    2           IO_STATUS = %SEQUENCE_ERROR;

   8645 21 000262   300036 474500                    LDP4    30,,PR3
        21 000263   040100 100400                    MLR     fill='040'O
        21 000264   000003 000002 20                 ADSC9   3                        cn=0,n=2
        21 000265   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

       74     8646    2           IF ALT_RET THEN

   8646 21 000266   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000267   400000 234100                    SZN     0,,PR4
        21 000270   000272 605000 21                 TPL     s:8649

       75     8647    2             ALTRETURN;

   8647 21 000271   000000 702200 xent               TSX2  ! X66_AALT

       76     8648    2           ELSE
       77     8649    2             CALL SYSTEM_ERROR_MESSAGE;

   8649 21 000272   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000273   000000 011000                    NOP     0
        21 000274   000412 710000 21                 TRA     s:8709

       78     8650
       79     8651    2         CASE (%E$FILLIM);

       80     8652    2           IF FAB.LAST_IO = %WRITE THEN

   8652 21 000275   300025 235100                    LDA     21,,PR3
        21 000276   000001 115007                    CMPA    1,DL
        21 000277   000305 601000 21                 TNZ     s:8655

       81     8653    2             IO_STATUS = %EXTERNAL_BOUNDARY_REACHED;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:29   
   8653 21 000300   300036 474500                    LDP4    30,,PR3
        21 000301   040100 100400                    MLR     fill='040'O
        21 000302   000004 000002 20                 ADSC9   4                        cn=0,n=2
        21 000303   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000304   000311 710000 21                 TRA     s:8656

       82     8654    2           ELSE
       83     8655    2             IO_STATUS = %NO_RANDOM_RECORD;

   8655 21 000305   300036 474500                    LDP4    30,,PR3
        21 000306   040100 100400                    MLR     fill='040'O
        21 000307   000002 000002 20                 ADSC9   2                        cn=0,n=2
        21 000310   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

       84     8656    2           IF ALT_RET THEN

   8656 21 000311   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000312   400000 234100                    SZN     0,,PR4
        21 000313   000315 605000 21                 TPL     s:8659

       85     8657    2             ALTRETURN;

   8657 21 000314   000000 702200 xent               TSX2  ! X66_AALT

       86     8658    2           ELSE
       87     8659    2             CALL SYSTEM_ERROR_MESSAGE;

   8659 21 000315   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000316   000000 011000                    NOP     0
        21 000317   000412 710000 21                 TRA     s:8709

       88     8660
       89     8661        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:30   
       90     8662    2         CASE (%E$NOREC);

       91     8663    2           IF FAB.B.SHARED_INDEX_ALT    AND         /*#35064*/ /*#24102*/

   8663 21 000320   300032 236100                    LDQ     26,,PR3
        21 000321   100000 316007                    CANQ    32768,DL
        21 000322   000412 600000 21                 TZE     s:8709
        21 000323   300025 235100                    LDA     21,,PR3
        21 000324   000007 115007                    CMPA    7,DL
        21 000325   000412 601000 21                 TNZ     s:8709

       92     8664    2              FAB.LAST_IO = %READ_NEXT      THEN               /*#35064*/
       93     8665    3             DO;

       94     8666    3               RETURN;

   8666 21 000326   000000 702200 xent               TSX2  ! X66_ARET

       95     8667    3             END;
       96     8668
       97     8669    2         CASE (%E$NOKEY);

       98     8670    2           IF FAB.B.SHARED_INDEX_ALT    AND        /*#35064*/ /*#24102*/

   8670 21 000327   300032 236100                    LDQ     26,,PR3
        21 000330   100000 316007                    CANQ    32768,DL
        21 000331   000336 600000 21                 TZE     s:8677
        21 000332   300025 235100                    LDA     21,,PR3
        21 000333   000007 115007                    CMPA    7,DL
        21 000334   000336 601000 21                 TNZ     s:8677

       99     8671    2              FAB.LAST_IO = %READ_NEXT     THEN                /*#35064*/
      100     8672    3             DO;

      101     8673    3               RETURN;                                         /*#32658*/

   8673 21 000335   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:31   

      102     8674    3             END;
      103     8675    2           ELSE
      104     8676    3             DO;

      105     8677    3               IO_STATUS = %NO_RANDOM_RECORD;

   8677 21 000336   300036 474500                    LDP4    30,,PR3
        21 000337   040100 100400                    MLR     fill='040'O
        21 000340   000002 000002 20                 ADSC9   2                        cn=0,n=2
        21 000341   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

      106     8678    3               IF ALT_RET THEN

   8678 21 000342   200004 474500                    LDP4    @ALT_RET,,AUTO
        21 000343   400000 234100                    SZN     0,,PR4
        21 000344   000346 605000 21                 TPL     s:8681

      107     8679    3                 ALTRETURN;

   8679 21 000345   000000 702200 xent               TSX2  ! X66_AALT

      108     8680    3               ELSE
      109     8681    3                 CALL SYSTEM_ERROR_MESSAGE;

   8681 21 000346   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000347   000000 011000                    NOP     0

      110     8682    3             END;

   8682 21 000350   000412 710000 21                 TRA     s:8709

      111     8683        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:32   
      112     8684    2         CASE (%E$LD);

      113     8685
      114     8686    2           IO_STATUS = %BAD_LENGTH;

   8686 21 000351   300036 474500                    LDP4    30,,PR3
        21 000352   040100 100400                    MLR     fill='040'O
        21 000353   000005 000002 20                 ADSC9   5                        cn=0,n=2
        21 000354   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000355   000412 710000 21                 TRA     s:8709

      115     8687
      116     8688    2         CASE (%E$DCBOPEN);

      117     8689    2           FAB.FILE_STATUS = %FILE_OPEN;

   8689 21 000356   000002 235007                    LDA     2,DL
        21 000357   300026 755100                    STA     22,,PR3
        21 000360   000412 710000 21                 TRA     s:8709

      118     8690
      119     8691    2         CASE (%E$NOFILE);

      120     8692    2           IF FAB.B.OPTIONAL_FILE THEN

   8692 21 000361   300032 236100                    LDQ     26,,PR3
        21 000362   200000 316003                    CANQ    65536,DU
        21 000363   000373 600000 21                 TZE     s:8699

      121     8693    3             DO;

      122     8694    3               IO_STATUS = %OPT_FILE_NOT_PRES;

   8694 21 000364   300036 474500                    LDP4    30,,PR3
        21 000365   040100 100400                    MLR     fill='040'O
        21 000366   000006 000002 20                 ADSC9   6                        cn=0,n=2
        21 000367   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:33   

      123     8695    3               FAB.FILE_STATUS = %FILE_NOT_PRESENT;

   8695 21 000370   000003 235007                    LDA     3,DL
        21 000371   300026 755100                    STA     22,,PR3

      124     8696    3             END;

   8696 21 000372   000412 710000 21                 TRA     s:8709

      125     8697    2           ELSE
      126     8698    3             DO;

      127     8699    3               IO_STATUS = %NO_FILE;

   8699 21 000373   300036 474500                    LDP4    30,,PR3
        21 000374   040100 100400                    MLR     fill='040'O
        21 000375   000007 000002 20                 ADSC9   7                        cn=0,n=2
        21 000376   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

      128     8700    3               FAB.FILE_STATUS = %FILE_NOT_PRESENT;

   8700 21 000377   000003 235007                    LDA     3,DL
        21 000400   300026 755100                    STA     22,,PR3

      129     8701    3               CALL SYSTEM_ERROR_MESSAGE;

   8701 21 000401   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000402   000000 011000                    NOP     0

      130     8702    3             END;

   8702 21 000403   000412 710000 21                 TRA     s:8709

      131     8703
      132     8704    2         CASE (ELSE);

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:34   
      133     8705    2           IO_STATUS = %IMPLEMENTOR_DEFINED ;

   8705 21 000404   300036 474500                    LDP4    30,,PR3
        21 000405   040100 100400                    MLR     fill='040'O
        21 000406   000010 000002 20                 ADSC9   8                        cn=0,n=2
        21 000407   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2

      134     8706    2           CALL SYSTEM_ERROR_MESSAGE;

   8706 21 000410   000413 701000 21                 TSX1    SYSTEM_ERROR_MESSAGE
        21 000411   000000 011000                    NOP     0

      135     8707
      136     8708    2       END; /* CASE */

      137     8709    1       RETURN;

   8709 21 000412   000000 702200 xent               TSX2  ! X66_ARET

      138     8710        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:35   
      139     8711        /*------------------*/
      140     8712    1   SYSTEM_ERROR_MESSAGE:         PROC;

   8712 21 000413   200104 741300       SYSTEM_ERRO* STX1  ! NAME_LENGTH+2,,AUTO

      141     8713        /*------------------*/
      142     8714
      143     8715    2       CALL USE_PROC

   8715 21 000414   001261 701000 21                 TSX1    USE_PROC
        21 000415   000417 702000 21                 TSX2    s:8718
        21 000416   000451 710000 21                 TRA     s:8726

      144     8716    2       WHENALTRETURN
      145     8717    3       DO;

      146     8718    3         ERR_MSG.CODE_ = VECTOR (B$TCB$-> B$TCB.ALT$-> B$ALT.ERR);

   8718 21 000417   000000 470400 xsym               LDP0    B$TCB$
        21 000420   000000 471500                    LDP1    0,,PR0
        21 000421   777640 235007                    LDA     -96,DL
        21 000422   200112 451500                    STP1    I+1,,AUTO
        21 000423   200112 236100                    LDQ     I+1,,AUTO
        21 000424   000102 036003                    ADLQ    66,DU
        21 000425   000040 757000 19                 STAQ    ERR_MSG+2

      147     8719    3         ERR_MSG.V.DCB# = FAB.DCB_NUM;

   8719 21 000426   200003 471500                    LDP1    @FAB,,AUTO
        21 000427   100034 220100                    LDX0    28,,PR1
        21 000430   000064 740000 19                 STX0    ERR_MSG+22

      148     8720    3         CALL M$ERRMSG (ERR_MSG);

   8720 21 000431   000036 630400 19                 EPPR0   ERR_MSG
        21 000432   020000 713400                    CLIMB   8192
        21 000433   405000 401760                    pmme    nvectors=11
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:36   

      149     8721    3         SPECIAL_ERR_MSG = ' ';

   8721 21 000434   040100 100400                    MLR     fill='040'O
        21 000435   000001 000001 22                 ADSC9   1                        cn=0,n=1
        21 000436   200005 000120                    ADSC9   SPECIAL_ERR_MSG,,AUTO    cn=0,n=80

      150     8722    3         CALL X8ER$ERROR (%SPECIAL_MSG, SPECIAL_ERR_MSG);

   8722 21 000437   200005 630500                    EPPR0   SPECIAL_ERR_MSG,,AUTO
        21 000440   200113 450500                    STP0    I+2,,AUTO
        21 000441   000004 236000 22                 LDQ     4
        21 000442   200112 756100                    STQ     I+1,,AUTO
        21 000443   200112 630500                    EPPR0   I+1,,AUTO
        21 000444   000002 631400 22                 EPPR1   2
        21 000445   000000 701000 xent               TSX1    X8ER$ERROR
        21 000446   000000 011000                    NOP     0

      151     8723    3         CALL M$XXX;

   8723 21 000447   000003 713400                    CLIMB   3
        21 000450   000000 401760                    pmme    nvectors=0

      152     8724    3       END;

      153     8725
      154     8726    2     END SYSTEM_ERROR_MESSAGE;  /* proc */

   8726 21 000451   200104 221300                    LDX1  ! NAME_LENGTH+2,,AUTO
        21 000452   000001 702211                    TSX2  ! 1,X1

      155     8727
      156     8728        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:37   
      157     8729        /*------------------*/
      158     8730    1   X9WE$IO_ERROR_STATUS:         ENTRY (FAB, ALT_RET) ALTRET;

   8730 21 000453   000000 700200 xent  X9WE$IO_ERR* TSX0  ! X66_AUTO_2
        21 000454   000116 000002                    ZERO    78,2

      159     8731        /*------------------*/
      160     8732
      161     8733    1       DCB$ = DCBADDR (FAB.DCB_NUM);

   8733 21 000455   000000 470400 22                 LDP0    0
        21 000456   000000 471500                    LDP1    0,,PR0
        21 000457   200003 473500                    LDP3    @FAB,,AUTO
        21 000460   300034 220100                    LDX0    28,,PR3
        21 000461   100000 236110                    LDQ     0,X0,PR1
        21 000462   200076 756100                    STQ     DCB$,,AUTO

      162     8734
      163     8735    2       DO SELECT (IO_STATUS);

   8735 21 000463   300036 474500                    LDP4    30,,PR3
        21 000464   040000 106500                    CMPC    fill='040'O
        21 000465   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000466   000011 000002 20                 ADSC9   9                        cn=0,n=2
        21 000467   000527 602000 21                 TNC     s:8735+36
        21 000470   000770 600000 21                 TZE     s:8805
        21 000471   040000 106500                    CMPC    fill='040'O
        21 000472   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000473   000012 000002 20                 ADSC9   10                       cn=0,n=2
        21 000474   000510 602000 21                 TNC     s:8735+21
        21 000475   000572 600000 21                 TZE     s:8739
        21 000476   040000 106500                    CMPC    fill='040'O
        21 000477   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000500   000013 000002 20                 ADSC9   11                       cn=0,n=2
        21 000501   001254 602000 21                 TNC     s:8900
        21 000502   000617 600000 21                 TZE     s:8750
        21 000503   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:38   
        21 000504   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000505   000014 000002 20                 ADSC9   12                       cn=0,n=2
        21 000506   001254 601000 21                 TNZ     s:8900
        21 000507   000644 710000 21                 TRA     s:8761
        21 000510   040000 106500                    CMPC    fill='040'O
        21 000511   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000512   000015 000002 20                 ADSC9   13                       cn=0,n=2
        21 000513   000522 602000 21                 TNC     s:8735+31
        21 000514   001145 600000 21                 TZE     s:8863
        21 000515   040000 106500                    CMPC    fill='040'O
        21 000516   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000517   000016 000002 20                 ADSC9   14                       cn=0,n=2
        21 000520   001254 601000 21                 TNZ     s:8900
        21 000521   001067 710000 21                 TRA     s:8838
        21 000522   040000 106500                    CMPC    fill='040'O
        21 000523   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000524   000017 000002 20                 ADSC9   15                       cn=0,n=2
        21 000525   001254 601000 21                 TNZ     s:8900
        21 000526   001042 710000 21                 TRA     s:8827
        21 000527   040000 106500                    CMPC    fill='040'O
        21 000530   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000531   000002 000002 20                 ADSC9   2                        cn=0,n=2
        21 000532   000553 602000 21                 TNC     s:8735+56
        21 000533   001114 600000 21                 TZE     s:8849
        21 000534   040000 106500                    CMPC    fill='040'O
        21 000535   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000536   000020 000002 20                 ADSC9   16                       cn=0,n=2
        21 000537   000546 602000 21                 TNC     s:8735+51
        21 000540   000716 600000 21                 TZE     s:8783
        21 000541   040000 106500                    CMPC    fill='040'O
        21 000542   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000543   000021 000002 20                 ADSC9   17                       cn=0,n=2
        21 000544   001254 601000 21                 TNZ     s:8900
        21 000545   001015 710000 21                 TRA     s:8816
        21 000546   040000 106500                    CMPC    fill='040'O
        21 000547   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000550   000022 000002 20                 ADSC9   18                       cn=0,n=2
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:39   
        21 000551   001254 601000 21                 TNZ     s:8900
        21 000552   000671 710000 21                 TRA     s:8772
        21 000553   040000 106500                    CMPC    fill='040'O
        21 000554   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000555   000000 000002 20                 ADSC9   0                        cn=0,n=2
        21 000556   000565 602000 21                 TNC     s:8735+66
        21 000557   001223 600000 21                 TZE     s:8887
        21 000560   040000 106500                    CMPC    fill='040'O
        21 000561   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000562   000023 000002 20                 ADSC9   19                       cn=0,n=2
        21 000563   001254 601000 21                 TNZ     s:8900
        21 000564   001172 710000 21                 TRA     s:8873
        21 000565   040000 106500                    CMPC    fill='040'O
        21 000566   400000 000002                    ADSC9   0,,PR4                   cn=0,n=2
        21 000567   000024 000002 20                 ADSC9   20                       cn=0,n=2
        21 000570   001254 601000 21                 TNZ     s:8900
        21 000571   000743 710000 21                 TRA     s:8794

      164     8736
      165     8737    2         SELECT (%NOT_OPEN_INPUT);

      166     8738
      167     8739    2           CALL USE_PROC

   8739 21 000572   001261 701000 21                 TSX1    USE_PROC
        21 000573   000575 702000 21                 TSX2    s:8742
        21 000574   000616 710000 21                 TRA     s:8746

      168     8740    2           WHENALTRETURN
      169     8741    3             DO;

      170     8742    3               NAME_LENGTH = M$XX.DCBNAME.L;

   8742 21 000575   200076 470500                    LDP0    DCB$,,AUTO
        21 000576   000140 236100                    LDQ     96,,PR0
        21 000577   000033 772000                    QRL     27
        21 000600   000037 376007                    ANQ     31,DL
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:40   
        21 000601   200102 756100                    STQ     NAME_LENGTH,,AUTO

      171     8743    3               CALL X8ER$ERROR (%IO_NOT_OPEN_INPUT, M$XX.DCBNAME.N,

   8743 21 000602   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 000603   200114 451500                    STP1    I+3,,AUTO
        21 000604   200076 236100                    LDQ     DCB$,,AUTO
        21 000605   000007 036000 22                 ADLQ    7
        21 000606   000010 235000 22                 LDA     8
        21 000607   200112 757100                    STAQ    I+1,,AUTO
        21 000610   200112 630500                    EPPR0   I+1,,AUTO
        21 000611   000005 631400 22                 EPPR1   5
        21 000612   000000 701000 xent               TSX1    X8ER$ERROR
        21 000613   000000 011000                    NOP     0

      172     8744    3                                                    NAME_LENGTH   );
      173     8745    3               CALL M$XXX;

   8745 21 000614   000003 713400                    CLIMB   3
        21 000615   000000 401760                    pmme    nvectors=0

      174     8746    3             END;

   8746 21 000616   001260 710000 21                 TRA     s:8902

      175     8747
      176     8748    2         SELECT (%NOT_OPEN_OUTPUT);

      177     8749
      178     8750    2           CALL USE_PROC

   8750 21 000617   001261 701000 21                 TSX1    USE_PROC
        21 000620   000622 702000 21                 TSX2    s:8753
        21 000621   000643 710000 21                 TRA     s:8757

      179     8751    2           WHENALTRETURN
      180     8752    3             DO;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:41   

      181     8753    3               NAME_LENGTH = M$XX.DCBNAME.L;

   8753 21 000622   200076 470500                    LDP0    DCB$,,AUTO
        21 000623   000140 236100                    LDQ     96,,PR0
        21 000624   000033 772000                    QRL     27
        21 000625   000037 376007                    ANQ     31,DL
        21 000626   200102 756100                    STQ     NAME_LENGTH,,AUTO

      182     8754    3               CALL X8ER$ERROR (%IO_NOT_OPEN_OUTPUT, M$XX.DCBNAME.N,

   8754 21 000627   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 000630   200114 451500                    STP1    I+3,,AUTO
        21 000631   200076 236100                    LDQ     DCB$,,AUTO
        21 000632   000007 036000 22                 ADLQ    7
        21 000633   000012 235000 22                 LDA     10
        21 000634   200112 757100                    STAQ    I+1,,AUTO
        21 000635   200112 630500                    EPPR0   I+1,,AUTO
        21 000636   000005 631400 22                 EPPR1   5
        21 000637   000000 701000 xent               TSX1    X8ER$ERROR
        21 000640   000000 011000                    NOP     0

      183     8755    3                                                     NAME_LENGTH   );
      184     8756    3               CALL M$XXX;

   8756 21 000641   000003 713400                    CLIMB   3
        21 000642   000000 401760                    pmme    nvectors=0

      185     8757    3             END;

   8757 21 000643   001260 710000 21                 TRA     s:8902

      186     8758
      187     8759    2         SELECT (%NOT_OPEN_IO);

      188     8760
      189     8761    2           CALL USE_PROC
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:42   

   8761 21 000644   001261 701000 21                 TSX1    USE_PROC
        21 000645   000647 702000 21                 TSX2    s:8764
        21 000646   000670 710000 21                 TRA     s:8768

      190     8762    2           WHENALTRETURN
      191     8763    3             DO;

      192     8764    3               NAME_LENGTH = M$XX.DCBNAME.L;

   8764 21 000647   200076 470500                    LDP0    DCB$,,AUTO
        21 000650   000140 236100                    LDQ     96,,PR0
        21 000651   000033 772000                    QRL     27
        21 000652   000037 376007                    ANQ     31,DL
        21 000653   200102 756100                    STQ     NAME_LENGTH,,AUTO

      193     8765    3               CALL X8ER$ERROR (%IO_NOT_OPEN_IO, M$XX.DCBNAME.N,

   8765 21 000654   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 000655   200114 451500                    STP1    I+3,,AUTO
        21 000656   200076 236100                    LDQ     DCB$,,AUTO
        21 000657   000007 036000 22                 ADLQ    7
        21 000660   000014 235000 22                 LDA     12
        21 000661   200112 757100                    STAQ    I+1,,AUTO
        21 000662   200112 630500                    EPPR0   I+1,,AUTO
        21 000663   000005 631400 22                 EPPR1   5
        21 000664   000000 701000 xent               TSX1    X8ER$ERROR
        21 000665   000000 011000                    NOP     0

      194     8766    3                                                 NAME_LENGTH    );
      195     8767    3               CALL M$XXX;

   8767 21 000666   000003 713400                    CLIMB   3
        21 000667   000000 401760                    pmme    nvectors=0

      196     8768    3             END;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:43   
   8768 21 000670   001260 710000 21                 TRA     s:8902

      197     8769
      198     8770    2         SELECT (%LOCKED);

      199     8771
      200     8772    2           CALL USE_PROC

   8772 21 000671   001261 701000 21                 TSX1    USE_PROC
        21 000672   000674 702000 21                 TSX2    s:8775
        21 000673   000715 710000 21                 TRA     s:8779

      201     8773    2           WHENALTRETURN
      202     8774    3             DO;

      203     8775    3               NAME_LENGTH = M$XX.DCBNAME.L;   /* convert ubin to sbin */

   8775 21 000674   200076 470500                    LDP0    DCB$,,AUTO
        21 000675   000140 236100                    LDQ     96,,PR0
        21 000676   000033 772000                    QRL     27
        21 000677   000037 376007                    ANQ     31,DL
        21 000700   200102 756100                    STQ     NAME_LENGTH,,AUTO

      204     8776    3               CALL X8ER$ERROR (%IO_LOCKED, M$XX.DCBNAME.N,

   8776 21 000701   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 000702   200114 451500                    STP1    I+3,,AUTO
        21 000703   200076 236100                    LDQ     DCB$,,AUTO
        21 000704   000007 036000 22                 ADLQ    7
        21 000705   000016 235000 22                 LDA     14
        21 000706   200112 757100                    STAQ    I+1,,AUTO
        21 000707   200112 630500                    EPPR0   I+1,,AUTO
        21 000710   000005 631400 22                 EPPR1   5
        21 000711   000000 701000 xent               TSX1    X8ER$ERROR
        21 000712   000000 011000                    NOP     0

      205     8777    3                                                 NAME_LENGTH    );
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:44   
      206     8778    3               CALL M$XXX;

   8778 21 000713   000003 713400                    CLIMB   3
        21 000714   000000 401760                    pmme    nvectors=0

      207     8779    3             END;

   8779 21 000715   001260 710000 21                 TRA     s:8902

      208     8780
      209     8781    2         SELECT (%ATTRIBUTE_CONFLICT);

      210     8782
      211     8783    2           CALL USE_PROC

   8783 21 000716   001261 701000 21                 TSX1    USE_PROC
        21 000717   000721 702000 21                 TSX2    s:8786
        21 000720   000742 710000 21                 TRA     s:8790

      212     8784    2           WHENALTRETURN
      213     8785    3             DO;

      214     8786    3               NAME_LENGTH = M$XX.DCBNAME.L;   /* convert ubin to sbin */

   8786 21 000721   200076 470500                    LDP0    DCB$,,AUTO
        21 000722   000140 236100                    LDQ     96,,PR0
        21 000723   000033 772000                    QRL     27
        21 000724   000037 376007                    ANQ     31,DL
        21 000725   200102 756100                    STQ     NAME_LENGTH,,AUTO

      215     8787    3               CALL X8ER$ERROR (%IO_ATTRIBUTE_CONFLICT, M$XX.DCBNAME.N,

   8787 21 000726   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 000727   200114 451500                    STP1    I+3,,AUTO
        21 000730   200076 236100                    LDQ     DCB$,,AUTO
        21 000731   000007 036000 22                 ADLQ    7
        21 000732   000020 235000 22                 LDA     16
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:45   
        21 000733   200112 757100                    STAQ    I+1,,AUTO
        21 000734   200112 630500                    EPPR0   I+1,,AUTO
        21 000735   000005 631400 22                 EPPR1   5
        21 000736   000000 701000 xent               TSX1    X8ER$ERROR
        21 000737   000000 011000                    NOP     0

      216     8788    3                                                        NAME_LENGTH   );
      217     8789    3               CALL M$XXX;

   8789 21 000740   000003 713400                    CLIMB   3
        21 000741   000000 401760                    pmme    nvectors=0

      218     8790    3             END;

   8790 21 000742   001260 710000 21                 TRA     s:8902

      219     8791
      220     8792    2         SELECT (%NON_REEL_MEDIUM);

      221     8793
      222     8794    2           CALL USE_PROC

   8794 21 000743   001261 701000 21                 TSX1    USE_PROC
        21 000744   000746 702000 21                 TSX2    s:8797
        21 000745   000767 710000 21                 TRA     s:8801

      223     8795    2           WHENALTRETURN
      224     8796    3             DO;

      225     8797    3               NAME_LENGTH = M$XX.DCBNAME.L;   /* convert ubin to sbin */

   8797 21 000746   200076 470500                    LDP0    DCB$,,AUTO
        21 000747   000140 236100                    LDQ     96,,PR0
        21 000750   000033 772000                    QRL     27
        21 000751   000037 376007                    ANQ     31,DL
        21 000752   200102 756100                    STQ     NAME_LENGTH,,AUTO

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:46   
      226     8798    3               CALL X8ER$ERROR (%IO_NOT_MASS_STORAGE, M$XX.DCBNAME.N,

   8798 21 000753   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 000754   200114 451500                    STP1    I+3,,AUTO
        21 000755   200076 236100                    LDQ     DCB$,,AUTO
        21 000756   000007 036000 22                 ADLQ    7
        21 000757   000022 235000 22                 LDA     18
        21 000760   200112 757100                    STAQ    I+1,,AUTO
        21 000761   200112 630500                    EPPR0   I+1,,AUTO
        21 000762   000005 631400 22                 EPPR1   5
        21 000763   000000 701000 xent               TSX1    X8ER$ERROR
        21 000764   000000 011000                    NOP     0

      227     8799    3                                                      NAME_LENGTH    );
      228     8800    3               CALL M$XXX;

   8800 21 000765   000003 713400                    CLIMB   3
        21 000766   000000 401760                    pmme    nvectors=0

      229     8801    3             END;

   8801 21 000767   001260 710000 21                 TRA     s:8902

      230     8802
      231     8803    2         SELECT (%NOT_OPEN);

      232     8804
      233     8805    2           CALL USE_PROC

   8805 21 000770   001261 701000 21                 TSX1    USE_PROC
        21 000771   000773 702000 21                 TSX2    s:8808
        21 000772   001014 710000 21                 TRA     s:8812

      234     8806    2           WHENALTRETURN
      235     8807    3             DO;

      236     8808    3               NAME_LENGTH = M$XX.DCBNAME.L;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:47   

   8808 21 000773   200076 470500                    LDP0    DCB$,,AUTO
        21 000774   000140 236100                    LDQ     96,,PR0
        21 000775   000033 772000                    QRL     27
        21 000776   000037 376007                    ANQ     31,DL
        21 000777   200102 756100                    STQ     NAME_LENGTH,,AUTO

      237     8809    3               CALL X8ER$ERROR (%IO_NOT_OPEN, M$XX.DCBNAME.N,

   8809 21 001000   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001001   200114 451500                    STP1    I+3,,AUTO
        21 001002   200076 236100                    LDQ     DCB$,,AUTO
        21 001003   000007 036000 22                 ADLQ    7
        21 001004   000024 235000 22                 LDA     20
        21 001005   200112 757100                    STAQ    I+1,,AUTO
        21 001006   200112 630500                    EPPR0   I+1,,AUTO
        21 001007   000005 631400 22                 EPPR1   5
        21 001010   000000 701000 xent               TSX1    X8ER$ERROR
        21 001011   000000 011000                    NOP     0

      238     8810    3                                              NAME_LENGTH    );
      239     8811    3               CALL M$XXX;

   8811 21 001012   000003 713400                    CLIMB   3
        21 001013   000000 401760                    pmme    nvectors=0

      240     8812    3             END;

   8812 21 001014   001260 710000 21                 TRA     s:8902

      241     8813
      242     8814    2         SELECT (%ALREADY_OPEN);

      243     8815
      244     8816    2           CALL USE_PROC

   8816 21 001015   001261 701000 21                 TSX1    USE_PROC
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:48   
        21 001016   001020 702000 21                 TSX2    s:8819
        21 001017   001041 710000 21                 TRA     s:8823

      245     8817    2           WHENALTRETURN
      246     8818    3             DO;

      247     8819    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */

   8819 21 001020   200076 470500                    LDP0    DCB$,,AUTO
        21 001021   000140 236100                    LDQ     96,,PR0
        21 001022   000033 772000                    QRL     27
        21 001023   000037 376007                    ANQ     31,DL
        21 001024   200102 756100                    STQ     NAME_LENGTH,,AUTO

      248     8820    3               CALL X8ER$ERROR (%IO_ALREADY_OPEN, M$XX.DCBNAME.N,

   8820 21 001025   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001026   200114 451500                    STP1    I+3,,AUTO
        21 001027   200076 236100                    LDQ     DCB$,,AUTO
        21 001030   000007 036000 22                 ADLQ    7
        21 001031   000026 235000 22                 LDA     22
        21 001032   200112 757100                    STAQ    I+1,,AUTO
        21 001033   200112 630500                    EPPR0   I+1,,AUTO
        21 001034   000005 631400 22                 EPPR1   5
        21 001035   000000 701000 xent               TSX1    X8ER$ERROR
        21 001036   000000 011000                    NOP     0

      249     8821    3                                                 NAME_LENGTH  );
      250     8822    3               CALL M$XXX;

   8822 21 001037   000003 713400                    CLIMB   3
        21 001040   000000 401760                    pmme    nvectors=0

      251     8823    3             END;

   8823 21 001041   001260 710000 21                 TRA     s:8902

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:49   
      252     8824
      253     8825    2         SELECT (%PRIOR_NOT_READ);

      254     8826
      255     8827    2           CALL USE_PROC

   8827 21 001042   001261 701000 21                 TSX1    USE_PROC
        21 001043   001045 702000 21                 TSX2    s:8830
        21 001044   001066 710000 21                 TRA     s:8834

      256     8828    2           WHENALTRETURN
      257     8829    3             DO;                                              /*#34545*/

      258     8830    3               NAME_LENGTH = M$XX.DCBNAME.L; /* convert ubin to sbin */

   8830 21 001045   200076 470500                    LDP0    DCB$,,AUTO
        21 001046   000140 236100                    LDQ     96,,PR0
        21 001047   000033 772000                    QRL     27
        21 001050   000037 376007                    ANQ     31,DL
        21 001051   200102 756100                    STQ     NAME_LENGTH,,AUTO

      259     8831    3               CALL X8ER$ERROR (%IO_PRIOR_NOT_READ, M$XX.DCBNAME.N,

   8831 21 001052   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001053   200114 451500                    STP1    I+3,,AUTO
        21 001054   200076 236100                    LDQ     DCB$,,AUTO
        21 001055   000007 036000 22                 ADLQ    7
        21 001056   000030 235000 22                 LDA     24
        21 001057   200112 757100                    STAQ    I+1,,AUTO
        21 001060   200112 630500                    EPPR0   I+1,,AUTO
        21 001061   000005 631400 22                 EPPR1   5
        21 001062   000000 701000 xent               TSX1    X8ER$ERROR
        21 001063   000000 011000                    NOP     0

      260     8832    3                                                    NAME_LENGTH);
      261     8833    3               CALL M$XXX;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:50   
   8833 21 001064   000003 713400                    CLIMB   3
        21 001065   000000 401760                    pmme    nvectors=0

      262     8834    3             END;

   8834 21 001066   001260 710000 21                 TRA     s:8902

      263     8835
      264     8836    2         SELECT (%NO_NEXT_RECORD);

      265     8837
      266     8838    2           CALL USE_PROC

   8838 21 001067   001261 701000 21                 TSX1    USE_PROC
        21 001070   001072 702000 21                 TSX2    s:8841
        21 001071   001113 710000 21                 TRA     s:8845

      267     8839    2           WHENALTRETURN
      268     8840    3             DO;                                               /*#34545*/

      269     8841    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */

   8841 21 001072   200076 470500                    LDP0    DCB$,,AUTO
        21 001073   000140 236100                    LDQ     96,,PR0
        21 001074   000033 772000                    QRL     27
        21 001075   000037 376007                    ANQ     31,DL
        21 001076   200102 756100                    STQ     NAME_LENGTH,,AUTO

      270     8842    3               CALL X8ER$ERROR (%IO_NO_NEXT_RECORD, M$XX.DCBNAME.N,

   8842 21 001077   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001100   200114 451500                    STP1    I+3,,AUTO
        21 001101   200076 236100                    LDQ     DCB$,,AUTO
        21 001102   000007 036000 22                 ADLQ    7
        21 001103   000032 235000 22                 LDA     26
        21 001104   200112 757100                    STAQ    I+1,,AUTO
        21 001105   200112 630500                    EPPR0   I+1,,AUTO
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:51   
        21 001106   000005 631400 22                 EPPR1   5
        21 001107   000000 701000 xent               TSX1    X8ER$ERROR
        21 001110   000000 011000                    NOP     0

      271     8843    3                                                    NAME_LENGTH);
      272     8844    3               CALL M$XXX;

   8844 21 001111   000003 713400                    CLIMB   3
        21 001112   000000 401760                    pmme    nvectors=0

      273     8845    3             END;

   8845 21 001113   001260 710000 21                 TRA     s:8902

      274     8846
      275     8847    2         SELECT (%NO_RANDOM_RECORD);

      276     8848
      277     8849    2           IF ALT_RET THEN

   8849 21 001114   200004 475500                    LDP5    @ALT_RET,,AUTO
        21 001115   500000 234100                    SZN     0,,PR5
        21 001116   001120 605000 21                 TPL     s:8852

      278     8850    2             ALTRETURN;

   8850 21 001117   000000 702200 xent               TSX2  ! X66_AALT

      279     8851
      280     8852    2           CALL USE_PROC

   8852 21 001120   001261 701000 21                 TSX1    USE_PROC
        21 001121   001123 702000 21                 TSX2    s:8855
        21 001122   001144 710000 21                 TRA     s:8859

      281     8853    2           WHENALTRETURN
      282     8854    3             DO;                                               /*#34545*/
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:52   

      283     8855    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */

   8855 21 001123   200076 470500                    LDP0    DCB$,,AUTO
        21 001124   000140 236100                    LDQ     96,,PR0
        21 001125   000033 772000                    QRL     27
        21 001126   000037 376007                    ANQ     31,DL
        21 001127   200102 756100                    STQ     NAME_LENGTH,,AUTO

      284     8856    3               CALL X8ER$ERROR (%IO_NO_RANDOM_RECORD, M$XX.DCBNAME.N,

   8856 21 001130   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001131   200114 451500                    STP1    I+3,,AUTO
        21 001132   200076 236100                    LDQ     DCB$,,AUTO
        21 001133   000007 036000 22                 ADLQ    7
        21 001134   000034 235000 22                 LDA     28
        21 001135   200112 757100                    STAQ    I+1,,AUTO
        21 001136   200112 630500                    EPPR0   I+1,,AUTO
        21 001137   000005 631400 22                 EPPR1   5
        21 001140   000000 701000 xent               TSX1    X8ER$ERROR
        21 001141   000000 011000                    NOP     0

      285     8857    3                                                      NAME_LENGTH);
      286     8858    3               CALL M$XXX;

   8858 21 001142   000003 713400                    CLIMB   3
        21 001143   000000 401760                    pmme    nvectors=0

      287     8859    3             END;

   8859 21 001144   001260 710000 21                 TRA     s:8902

      288     8860
      289     8861    2         SELECT (%BOUNDARY_VIOLATION);

      290     8862
      291     8863    2           CALL USE_PROC
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:53   

   8863 21 001145   001261 701000 21                 TSX1    USE_PROC
        21 001146   001150 702000 21                 TSX2    s:8866
        21 001147   001171 710000 21                 TRA     s:8870

      292     8864    2           WHENALTRETURN
      293     8865    3             DO;

      294     8866    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */

   8866 21 001150   200076 470500                    LDP0    DCB$,,AUTO
        21 001151   000140 236100                    LDQ     96,,PR0
        21 001152   000033 772000                    QRL     27
        21 001153   000037 376007                    ANQ     31,DL
        21 001154   200102 756100                    STQ     NAME_LENGTH,,AUTO

      295     8867    3               CALL X8ER$ERROR (%IO_BOUNDARY_VIOLATION, M$XX.DCBNAME.N,

   8867 21 001155   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001156   200114 451500                    STP1    I+3,,AUTO
        21 001157   200076 236100                    LDQ     DCB$,,AUTO
        21 001160   000007 036000 22                 ADLQ    7
        21 001161   000036 235000 22                 LDA     30
        21 001162   200112 757100                    STAQ    I+1,,AUTO
        21 001163   200112 630500                    EPPR0   I+1,,AUTO
        21 001164   000005 631400 22                 EPPR1   5
        21 001165   000000 701000 xent               TSX1    X8ER$ERROR
        21 001166   000000 011000                    NOP     0

      296     8868    3                                                        NAME_LENGTH);
      297     8869    3               CALL M$XXX;

   8869 21 001167   000003 713400                    CLIMB   3
        21 001170   000000 401760                    pmme    nvectors=0

      298     8870    3             END;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:54   
   8870 21 001171   001260 710000 21                 TRA     s:8902

      299     8871
      300     8872    2         SELECT (%KEY_OVERFLOW);

      301     8873    2           IF ALT_RET THEN

   8873 21 001172   200004 470500                    LDP0    @ALT_RET,,AUTO
        21 001173   000000 234100                    SZN     0,,PR0
        21 001174   001176 605000 21                 TPL     s:8876

      302     8874    2             ALTRETURN;

   8874 21 001175   000000 702200 xent               TSX2  ! X66_AALT

      303     8875    2           ELSE
      304     8876    2             CALL USE_PROC

   8876 21 001176   001261 701000 21                 TSX1    USE_PROC
        21 001177   001201 702000 21                 TSX2    s:8879
        21 001200   001222 710000 21                 TRA     s:8883

      305     8877    2               WHENALTRETURN
      306     8878    3                 DO;

      307     8879    3                   NAME_LENGTH = M$XX.DCBNAME.L; /* convert ubin to sbin */

   8879 21 001201   200076 470500                    LDP0    DCB$,,AUTO
        21 001202   000140 236100                    LDQ     96,,PR0
        21 001203   000033 772000                    QRL     27
        21 001204   000037 376007                    ANQ     31,DL
        21 001205   200102 756100                    STQ     NAME_LENGTH,,AUTO

      308     8880    3                   CALL X8ER$ERROR (%IO_KEY_OVERFLOW, M$XX.DCBNAME.N,

   8880 21 001206   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001207   200114 451500                    STP1    I+3,,AUTO
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:55   
        21 001210   200076 236100                    LDQ     DCB$,,AUTO
        21 001211   000007 036000 22                 ADLQ    7
        21 001212   000040 235000 22                 LDA     32
        21 001213   200112 757100                    STAQ    I+1,,AUTO
        21 001214   200112 630500                    EPPR0   I+1,,AUTO
        21 001215   000005 631400 22                 EPPR1   5
        21 001216   000000 701000 xent               TSX1    X8ER$ERROR
        21 001217   000000 011000                    NOP     0

      309     8881    3                                                      NAME_LENGTH);
      310     8882    3                   CALL M$XXX;

   8882 21 001220   000003 713400                    CLIMB   3
        21 001221   000000 401760                    pmme    nvectors=0

      311     8883    3                 END;

   8883 21 001222   001260 710000 21                 TRA     s:8902

      312     8884
      313     8885    2         SELECT (%END_OF_FILE);

      314     8886
      315     8887    2           IF ALT_RET THEN

   8887 21 001223   200004 475500                    LDP5    @ALT_RET,,AUTO
        21 001224   500000 234100                    SZN     0,,PR5
        21 001225   001227 605000 21                 TPL     s:8889

      316     8888    2             ALTRETURN;

   8888 21 001226   000000 702200 xent               TSX2  ! X66_AALT

      317     8889    2           CALL USE_PROC

   8889 21 001227   001261 701000 21                 TSX1    USE_PROC
        21 001230   001232 702000 21                 TSX2    s:8892
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:56   
        21 001231   001253 710000 21                 TRA     s:8896

      318     8890    2           WHENALTRETURN
      319     8891    3             DO;

      320     8892    3               NAME_LENGTH = M$XX.DCBNAME.L;  /* convert ubin to sbin */

   8892 21 001232   200076 470500                    LDP0    DCB$,,AUTO
        21 001233   000140 236100                    LDQ     96,,PR0
        21 001234   000033 772000                    QRL     27
        21 001235   000037 376007                    ANQ     31,DL
        21 001236   200102 756100                    STQ     NAME_LENGTH,,AUTO

      321     8893    3               CALL X8ER$ERROR (%IO_END_OF_FILE, M$XX.DCBNAME.N,

   8893 21 001237   200102 631500                    EPPR1   NAME_LENGTH,,AUTO
        21 001240   200114 451500                    STP1    I+3,,AUTO
        21 001241   200076 236100                    LDQ     DCB$,,AUTO
        21 001242   000007 036000 22                 ADLQ    7
        21 001243   000042 235000 22                 LDA     34
        21 001244   200112 757100                    STAQ    I+1,,AUTO
        21 001245   200112 630500                    EPPR0   I+1,,AUTO
        21 001246   000005 631400 22                 EPPR1   5
        21 001247   000000 701000 xent               TSX1    X8ER$ERROR
        21 001250   000000 011000                    NOP     0

      322     8894    3                                                        NAME_LENGTH   );
      323     8895    3               CALL M$XXX;

   8895 21 001251   000003 713400                    CLIMB   3
        21 001252   000000 401760                    pmme    nvectors=0

      324     8896    3             END;

   8896 21 001253   001260 710000 21                 TRA     s:8902

      325     8897
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:57   
      326     8898    2         SELECT (ELSE);

      327     8899
      328     8900    2           CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WE', 4);

   8900 21 001254   000045 630400 22                 EPPR0   37
        21 001255   000005 631400 22                 EPPR1   5
        21 001256   000000 701000 xent               TSX1    X8ER$ERROR
        21 001257   000000 011000                    NOP     0

      329     8901
      330     8902    2       END;  /* case */

   8902 21 001260   001504 710000 21                 TRA     s:9017

      331     8903
      332     8904        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:58   
      333     8905        /*--------*/
      334     8906    1     USE_PROC:            PROC  ALTRET;

   8906 21 001261   200106 741300       USE_PROC     STX1  ! NAME_LENGTH+4,,AUTO

      335     8907        /*--------*/
      336     8908
      337     8909    2       DCL USE_PROC$ EPTR;
      338     8910
      339     8911    2       DCL 1 X9OS$EXIT_BLOCK SYMREF DALIGNED,
      340     8912    2             2 REM (0:63) REMEMBER,
      341     8913    2             2 ITEM (0:63) REDEF REM,
      342     8914    2               3 TYPE SBIN,
      343     8915    2               3 PTR$ PTR,
      344     8916    2               3 EPTR$ REDEF PTR$ EPTR,
      345     8917    2             2 PREV$ PTR,
      346     8918    2             2 NEXT$ PTR;
      347     8919    2       DCL X9OS$EXIT_INDEX SBIN SYMREF;
      348     8920    2       DCL 1 EXIT$BLOCK DALIGNED BASED (EXIT_BLOCK$),
      349     8921    2             2 REM (0:63) REMEMBER,
      350     8922    2             2 ITEM (0:63) REDEF REM,
      351     8923    2               3 TYPE SBIN,
      352     8924    2               3 PTR$ PTR,
      353     8925    2               3 EPTR$ REDEF PTR$ EPTR,
      354     8926    2             2 PREV$ PTR,
      355     8927    2             2 NEXT$ PTR;
      356     8928    2       DCL EXIT_BLOCK$ PTR;
      357     8929    2       DCL I SBIN;
      358     8930        %EJECT;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:59   
      359     8931    2       USE_PROC$ = ENTADDR(NIL);

   8931 21 001262   000003 236000 22                 LDQ     3
        21 001263   200107 756100                    STQ     USE_PROC$,,AUTO

      360     8932
      361     8933    3       IF FAB.USE_PROC$  ~= ENTADDR(NIL) THEN DO;

   8933 21 001264   200003 470500                    LDP0    @FAB,,AUTO
        21 001265   000057 116100                    CMPQ    47,,PR0
        21 001266   001303 600000 21                 TZE     s:8941

      362     8934    4         IF FAB.B.USE_PROC THEN DO;

   8934 21 001267   000032 236100                    LDQ     26,,PR0
        21 001270   004000 316007                    CANQ    2048,DL
        21 001271   001300 600000 21                 TZE     s:8938

      363     8935    4           CALL X8ER$ERROR (%CALL_USE_RECURSIVE);

   8935 21 001272   000052 630400 22                 EPPR0   42
        21 001273   000050 631400 22                 EPPR1   40
        21 001274   000000 701000 xent               TSX1    X8ER$ERROR
        21 001275   000000 011000                    NOP     0

      364     8936    4           ALTRETURN;

   8936 21 001276   200106 221300                    LDX1  ! NAME_LENGTH+4,,AUTO
        21 001277   000000 702211                    TSX2  ! 0,X1

      365     8937    4         END;
      366     8938    3         USE_PROC$ = FAB.USE_PROC$;

   8938 21 001300   000057 236100                    LDQ     47,,PR0
        21 001301   200107 756100                    STQ     USE_PROC$,,AUTO

      367     8939    3       END;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:60   

   8939 21 001302   001361 710000 21                 TRA     s:8977

      368     8940    2       ELSE
      369     8941    2         IF  FAB.USE_BLOCK$ ~= ADDR(NIL) THEN

   8941 21 001303   000056 236100                    LDQ     46,,PR0
        21 001304   000053 116000 22                 CMPQ    43
        21 001305   001361 600000 21                 TZE     s:8977

      370     8942    2         IF  FAB.FILE_STATUS = %FILE_OPEN

   8942 21 001306   000026 235100                    LDA     22,,PR0
        21 001307   000002 115007                    CMPA    2,DL
        21 001310   001314 600000 21                 TZE     s:8944
        21 001311   000025 235100                    LDA     21,,PR0
        21 001312   000003 115007                    CMPA    3,DL
        21 001313   001360 601000 21                 TNZ     s:8975

      371     8943    2         OR  FAB.LAST_IO = %OPEN  THEN
      372     8944    3           DO CASE (M$XX.FUN#);

   8944 21 001314   200076 471500                    LDP1    DCB$,,AUTO
        21 001315   100032 220100                    LDX0    26,,PR1
        21 001316   000777 360003                    ANX0    511,DU
        21 001317   000004 100003                    CMPX0   4,DU
        21 001320   001322 602010 21                 TNC     s:8944+6,X0
        21 001321   001353 710000 21                 TRA     s:8971
        21 001322   001352 710000 21                 TRA     s:8968
        21 001323   001332 710000 21                 TRA     s:8952
        21 001324   001326 710000 21                 TRA     s:8948
        21 001325   001336 710000 21                 TRA     s:8956

      373     8945
      374     8946    3             CASE (%IN);

      375     8947
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:61   
      376     8948    3               USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.INPUT$;

   8948 21 001326   000056 473500                    LDP3    46,,PR0
        21 001327   300000 236100                    LDQ     0,,PR3
        21 001330   200107 756100                    STQ     USE_PROC$,,AUTO
        21 001331   001361 710000 21                 TRA     s:8977

      377     8949
      378     8950    3             CASE (%UPDATE);  /* I/O */

      379     8951
      380     8952    3               USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.I_O$;

   8952 21 001332   000056 473500                    LDP3    46,,PR0
        21 001333   300002 236100                    LDQ     2,,PR3
        21 001334   200107 756100                    STQ     USE_PROC$,,AUTO
        21 001335   001361 710000 21                 TRA     s:8977

      381     8953
      382     8954    3             CASE (%CREATE);  /* output or extend */

      383     8955
      384     8956    3               IF M$XX.EXIST# = %NEWFILE THEN

   8956 21 001336   100031 236100                    LDQ     25,,PR1
        21 001337   003000 376007                    ANQ     1536,DL
        21 001340   003000 116007                    CMPQ    1536,DL
        21 001341   001346 601000 21                 TNZ     s:8962

      385     8957    4                DO;

      386     8958    4                  USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.OUTPUT$;

   8958 21 001342   000056 473500                    LDP3    46,,PR0
        21 001343   300001 236100                    LDQ     1,,PR3
        21 001344   200107 756100                    STQ     USE_PROC$,,AUTO

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:62   
      387     8959    4                END;

   8959 21 001345   001361 710000 21                 TRA     s:8977

      388     8960    3              ELSE
      389     8961    4                DO;        /*  extend  */

      390     8962    4                  USE_PROC$ = FAB.USE_BLOCK$-> USE_BLOCK.EXTEND$;

   8962 21 001346   000056 473500                    LDP3    46,,PR0
        21 001347   300003 236100                    LDQ     3,,PR3
        21 001350   200107 756100                    STQ     USE_PROC$,,AUTO

      391     8963    4                END;

   8963 21 001351   001361 710000 21                 TRA     s:8977

      392     8964
      393     8965
      394     8966    3             CASE (%CP6_DEFAULT);

      395     8967
      396     8968    3               ALTRETURN;

   8968 21 001352   000000 702211                    TSX2  ! 0,X1

      397     8969    3             CASE (ELSE);

      398     8970
      399     8971    3               CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WE', 4);

   8971 21 001353   000045 630400 22                 EPPR0   37
        21 001354   000005 631400 22                 EPPR1   5
        21 001355   000000 701000 xent               TSX1    X8ER$ERROR
        21 001356   000000 011000                    NOP     0

      400     8972
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:63   
      401     8973    3           END;  /* case */

   8973 21 001357   001361 710000 21                 TRA     s:8977

      402     8974    2         ELSE
      403     8975    2           ALTRETURN;

   8975 21 001360   000000 702211                    TSX2  ! 0,X1

      404     8976
      405     8977    2       IF USE_PROC$ = ENTADDR(NIL) THEN

   8977 21 001361   200107 236100                    LDQ     USE_PROC$,,AUTO
        21 001362   000003 116000 22                 CMPQ    3
        21 001363   001366 601000 21                 TNZ     s:8979

      406     8978    2         ALTRETURN;

   8978 21 001364   200106 221300                    LDX1  ! NAME_LENGTH+4,,AUTO
        21 001365   000000 702211                    TSX2  ! 0,X1

      407     8979    2       FAB.B.USE_PROC_SAVE = LIBCOM.USE_PROC;

   8979 21 001366   200003 470500                    LDP0    @FAB,,AUTO
        21 001367   000022 236000 1                  LDQ     LIBCOM+18
        21 001370   000032 772000                    QRL     26
        21 001371   000032 676100                    ERQ     26,,PR0
        21 001372   001000 376007                    ANQ     512,DL
        21 001373   000032 656100                    ERSQ    26,,PR0

      408     8980    2       LIBCOM.USE_PROC = %TRUE;

   8980 21 001374   400000 236003                    LDQ     -131072,DU
        21 001375   000022 756000 1                  STQ     LIBCOM+18

      409     8981    2       FAB.B.USE_PROC = %TRUE;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:64   
   8981 21 001376   004000 236007                    LDQ     2048,DL
        21 001377   000032 256100                    ORSQ    26,,PR0

      410     8982    2       IF LIBCOM.EXIT_PROG_IN_DECL THEN

   8982 21 001400   000023 234000 1                  SZN     LIBCOM+19
        21 001401   001465 605000 21                 TPL     s:9012

      411     8983    3         DO;

      412     8984    3           EXIT_BLOCK$ = ADDR (X9OS$EXIT_BLOCK);

   8984 21 001402   000054 236000 22                 LDQ     44
        21 001403   200110 756100                    STQ     EXIT_BLOCK$,,AUTO

      413     8985    3           IF X9OS$EXIT_INDEX >= 64 THEN

   8985 21 001404   000000 235000 xsym               LDA     X9OS$EXIT_INDEX
        21 001405   000100 115007                    CMPA    64,DL
        21 001406   001455 604000 21                 TMI     s:9007

      414     8986    4             DO;

      415     8987    4               I = X9OS$EXIT_INDEX;

   8987 21 001407   200111 755100                    STA     I,,AUTO

      416     8988    5               DO WHILE I > 64;

   8988 21 001410   001421 604400 21                 TMOZ    s:8992

      417     8989    5                 EXIT_BLOCK$ = EXIT$BLOCK.NEXT$;

   8989 21 001411   200110 470500                    LDP0    EXIT_BLOCK$,,AUTO
        21 001412   000201 236100                    LDQ     129,,PR0
        21 001413   200110 756100                    STQ     EXIT_BLOCK$,,AUTO

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:65   
      418     8990    5                 I = I - 64;

   8990 21 001414   000100 336007                    LCQ     64,DL
        21 001415   200111 056100                    ASQ     I,,AUTO

      419     8991    5               END;

   8991 21 001416   200111 235100                    LDA     I,,AUTO
        21 001417   000100 115007                    CMPA    64,DL
        21 001420   001411 605400 21                 TPNZ    s:8989

      420     8992    4               IF I = 64 THEN

   8992 21 001421   001446 601000 21                 TNZ     s:9002

      421     8993    5                 DO;

      422     8994    5                   I = 0;

   8994 21 001422   200111 450100                    STZ     I,,AUTO

      423     8995    5                   IF EXIT$BLOCK.NEXT$ = ADDR (NIL) THEN

   8995 21 001423   200110 470500                    LDP0    EXIT_BLOCK$,,AUTO
        21 001424   000201 236100                    LDQ     129,,PR0
        21 001425   000053 116000 22                 CMPQ    43
        21 001426   001444 601000 21                 TNZ     s:9000

      424     8996    6                     DO;

      425     8997    6                       CALL X9MA$ALLOCATE (EXIT$BLOCK.NEXT$, SIZEC (X9OS$EXIT_BLOCK));

   8997 21 001427   000056 236000 22                 LDQ     46
        21 001430   200113 756100                    STQ     I+2,,AUTO
        21 001431   200110 236100                    LDQ     EXIT_BLOCK$,,AUTO
        21 001432   000201 036003                    ADLQ    129,DU
        21 001433   200112 756100                    STQ     I+1,,AUTO
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:66   
        21 001434   200112 630500                    EPPR0   I+1,,AUTO
        21 001435   000002 631400 22                 EPPR1   2
        21 001436   000000 701000 xent               TSX1    X9MA$ALLOCATE
        21 001437   000000 011000                    NOP     0

      426     8998    6                       EXIT$BLOCK.NEXT$ -> EXIT$BLOCK.PREV$ = EXIT_BLOCK$;

   8998 21 001440   200110 470500                    LDP0    EXIT_BLOCK$,,AUTO
        21 001441   000201 471500                    LDP1    129,,PR0
        21 001442   200110 236100                    LDQ     EXIT_BLOCK$,,AUTO
        21 001443   100200 756100                    STQ     128,,PR1

      427     8999    6                     END;

      428     9000    5                   EXIT_BLOCK$ = EXIT$BLOCK.NEXT$;

   9000 21 001444   000201 236100                    LDQ     129,,PR0
        21 001445   200110 756100                    STQ     EXIT_BLOCK$,,AUTO

      429     9001    5                 END;

      430     9002    4               EXIT$BLOCK.ITEM.TYPE (I) = 0;

   9002 21 001446   200111 235100                    LDA     I,,AUTO
        21 001447   000001 735000                    ALS     1
        21 001450   200110 470500                    LDP0    EXIT_BLOCK$,,AUTO
        21 001451   000000 450105                    STZ     0,AL,PR0

      431     9003    4               EXIT$BLOCK.ITEM.PTR$ (I) = ADDR (FAB);

   9003 21 001452   200003 236100                    LDQ     @FAB,,AUTO
        21 001453   000001 756105                    STQ     1,AL,PR0

      432     9004    4             END; /* IF X9OS$EXIT_INDEX >= 64 */

   9004 21 001454   001464 710000 21                 TRA     s:9010

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:67   
      433     9005    3           ELSE
      434     9006    4             DO;

      435     9007    4               EXIT$BLOCK.ITEM.TYPE (X9OS$EXIT_INDEX) = 0;

   9007 21 001455   000001 735000                    ALS     1
        21 001456   200110 471500                    LDP1    EXIT_BLOCK$,,AUTO
        21 001457   100000 450105                    STZ     0,AL,PR1

      436     9008    4               EXIT$BLOCK.ITEM.PTR$ (X9OS$EXIT_INDEX) = ADDR (FAB);

   9008 21 001460   000000 235000 xsym               LDA     X9OS$EXIT_INDEX
        21 001461   000001 735000                    ALS     1
        21 001462   200003 236100                    LDQ     @FAB,,AUTO
        21 001463   100001 756105                    STQ     1,AL,PR1

      437     9009    4             END;

      438     9010    3           X9OS$EXIT_INDEX = X9OS$EXIT_INDEX + 1;

   9010 21 001464   000000 054000 xsym               AOS     X9OS$EXIT_INDEX

      439     9011    3         END; /* IF LIBCOM.EXIT_PROG_IN_DECL */

      440     9012    2       CALL USE_PROC$;

   9012 21 001465   200107 220100                    LDX0    USE_PROC$,,AUTO
        21 001466   000003 631400 22                 EPPR1   3
        21 001467   000000 701010                    TSX1    0,X0
        21 001470   000000 011000                    NOP     0

      441     9013    2       X9OS$EXIT_INDEX = X9OS$EXIT_INDEX - 1;

   9013 21 001471   000001 336007                    LCQ     1,DL
        21 001472   000000 056000 xsym               ASQ     X9OS$EXIT_INDEX

      442     9014    2       FAB.B.USE_PROC = %FALSE;
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:68   

   9014 21 001473   200003 470500                    LDP0    @FAB,,AUTO
        21 001474   000057 236000 22                 LDQ     47
        21 001475   000032 356100                    ANSQ    26,,PR0

      443     9015    2       LIBCOM.USE_PROC = FAB.B.USE_PROC_SAVE;

   9015 21 001476   000032 236100                    LDQ     26,,PR0
        21 001477   000032 736000                    QLS     26
        21 001500   400000 376003                    ANQ     -131072,DU
        21 001501   000022 756000 1                  STQ     LIBCOM+18

      444     9016    2     END USE_PROC;  /* proc */

   9016 21 001502   200106 221300                    LDX1  ! NAME_LENGTH+4,,AUTO
        21 001503   000001 702211                    TSX2  ! 1,X1

      445     9017    1   END X9WE$IO_ERROR;  /* PROC */

   9017 21 001504   000000 702200 xent               TSX2  ! X66_ARET
      446     9018        %EOD;

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:69   
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
      No diagnostics issued in procedure X9WE$IO_ERROR.
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:70   

 **** Variables and constants ****

  ****  Section 001 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)   r     1 LIBCOM

  ****  Section 002 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 DEC_OR_COMMA

  ****  Section 003 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)          1 IN_TEMP

  ****  Section 004 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 OVRCHR

  ****  Section 005 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:71   
  ****  Section 006 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 NO_ADVANCE_OFFSET

  ****  Section 007 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 008 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 009 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 010 LblCom D_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 011 LblCom C_DATE

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:72   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 012 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 013 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 014 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 015 LblCom LTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 016 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:73   

     0-0-0/w SBIN              1 NDX2

  ****  Section 017 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Section 019  Data  X9WE$IO_ERROR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(120)   r     1 ERROR_BUFFER              36-0-0/d STRC(936)   r     1 ERR_MSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ALT_RET                   3-0-0/w PTR         r     1 @FAB
    *0-0-0/w BIT         r     1 ALT_RET                   76-0-0/w PTR         r     1 DCB$
   101-0-0/w UBIN        r     1 ERROR#                   110-0-0/w PTR         r     1 EXIT_BLOCK$
    *0-0-0/d STRC(2232)  r     1 FAB                      111-0-0/w SBIN        r     1 I
    31-0-0/w SBIN              1 LT                        32-0-0/c CHAR(65)          1 LTHOLD
   102-0-0/w SBIN        r     1 NAME_LENGTH               74-0-0/w SBIN              1 NDX
    75-0-0/w SBIN              1 NDX3                      53-0-0/c CHAR(65)          1 RTHOLD
     5-0-0/c CHAR(80)    r     1 SPECIAL_ERR_MSG           77-0-0/w PTR         r     1 USE$$
   100-0-0/w EPTR        r     1 USE_ENTRY$               107-0-0/w EPTR        r     1 USE_PROC$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=X9WE$IO_ERROR File=X9WE.:X8A6TSI                              SAT 08/09/97 11:06 Page:74   
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(4680)  r     1 X9OS$EXIT_BLOCK
     0-0-0/w SBIN        r     1 X9OS$EXIT_INDEX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(4680)  r     1 EXIT$BLOCK                 0-0-0/c CHAR(2)     r     1 IO_STATUS
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$UC
     0-0-0/d ASTR(3528)  r     1 M$XX                       0-0-0/w STRC(144)   r     1 USE_BLOCK
     0-0-0/w STRC(864)         1 USE_PROC


   Procedure X9WE$IO_ERROR requires 837 words for executable code.
   Procedure X9WE$IO_ERROR requires 78 words of local(AUTO) storage.

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:75   
      447        1        /*T***********************************************************/
      448        2        /*T*                                                         */
      449        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      450        4        /*T*                                                         */
      451        5        /*T***********************************************************/
      452        6        /*------------*/
      453        7        X9WE$RW_USE_PROC: PROC (FAB);
      454        8        /*------------*/
      455        9         /*P*
      456       10                NAME: X9WE$RW_USE_PROC
      457       11             PURPOSE: Invoke report writer USE procedure
      458       12         */
      459       13         /*D*
      460       14                    NAME: X9WE$RW_USE_PROC
      461       15                    CALL: CALL X9WE$RW_USE_PROC (FAB);
      462       16                   INPUT: FAB -- The FAB of the report file, or with the other
      463       17                                 entry point, the DML Information Area
      464       18             DESCRIPTION: Set LIBCOM.USE_PROC after safestoring its old value in
      465       19                          the FAB. If there is an EXIT PROGRAM statement in
      466       20                          DECLARATIVES then push an item on the stack with the
      467       21                          address of the FAB. The report writer control system
      468       22                          will do the rest.
      469       23         */
      470       24            %INCLUDE X8A_LIBCOM;
      471      244            %INCLUDE X9A_FAB;
      472      431            %DCL_FAB;
      473      553    1       DCL TYPE UBIN;
      474      554    1       DCL 1 X9OS$EXIT_BLOCK SYMREF DALIGNED,
      475      555    1             2 REM (0:63) REMEMBER,
      476      556    1             2 ITEM (0:63) REDEF REM,
      477      557    1               3 TYPE SBIN,
      478      558    1               3 PTR$ PTR,
      479      559    1               3 EPTR$ REDEF PTR$ EPTR,
      480      560    1             2 PREV$ PTR,
      481      561    1             2 NEXT$ PTR;
      482      562    1       DCL X9OS$EXIT_INDEX SBIN SYMREF;
      483      563    1       DCL 1 EXIT$BLOCK DALIGNED BASED (EXIT_BLOCK$),
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:76   
      484      564    1             2 REM (0:63) REMEMBER,
      485      565    1             2 ITEM (0:63) REDEF REM,
      486      566    1               3 TYPE SBIN,
      487      567    1               3 PTR$ PTR,
      488      568    1               3 EPTR$ REDEF PTR$ EPTR,
      489      569    1             2 PREV$ PTR,
      490      570    1             2 NEXT$ PTR;
      491      571    1       DCL EXIT_BLOCK$ PTR;
      492      572    1       DCL I SBIN;
      493      573    1       DCL X8CL$FIND_BLOCK ENTRY(2);
      494      574        %EJECT;
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:77   
      495      575    1     FAB.B.USE_PROC_SAVE = LIBCOM.USE_PROC;
      496      576    1     LIBCOM.USE_PROC = %TRUE;
      497      577    1     IF LIBCOM.EXIT_PROG_IN_DECL THEN
      498      578    2       DO;
      499      579    2         EXIT_BLOCK$ = ADDR (X9OS$EXIT_BLOCK);
      500      580    2         I = X9OS$EXIT_INDEX;
      501      581    2         IF X9OS$EXIT_INDEX >= 64 THEN
      502      582    2           CALL X8CL$FIND_BLOCK (I, EXIT_BLOCK$);
      503      583    2         EXIT$BLOCK.ITEM.TYPE (I) = 0;
      504      584    2         EXIT$BLOCK.ITEM.PTR$ (I) = ADDR (FAB);
      505      585    2         X9OS$EXIT_INDEX = X9OS$EXIT_INDEX + 1;
      506      586    2       END; /* IF LIBCOM.EXIT_PROG_IN_DECL */
      507      587    1   END X9WE$RW_USE_PROC;
      508      588        %EJECT;
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:78   

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:79   
--  Include file information  --

   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X9WE$RW_USE_PROC.

   Procedure X9WE$RW_USE_PROC requires 37 words for executable code.
   Procedure X9WE$RW_USE_PROC requires 46 words of local(AUTO) storage.

    No errors detected in file X9WE.:X8A6TSI    .

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:80   

 Object Unit name= X9WE$RW_USE_PROC                           File name= X9WE.:X8A6TOU
 UTS= AUG 09 '97 11:09:42.56 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    20     24  LIBCOM
    1  LblCom even  none     1      1  DEC_OR_COMMA
    2  LblCom even  none    20     24  IN_TEMP
    3  LblCom even  none     1      1  OVRCHR
    4  LblCom even  none     1      1  SELECT_TIME
    5  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    6  LblCom even  none    18     22  DSPLY_SAVE
    7  LblCom even  none     3      3  D_DATE
    8  LblCom even  none     3      3  D_TIME
    9  LblCom even  none     1      1  D_DAY
   10  LblCom even  none     2      2  C_DATE
   11  LblCom even  none     2      2  C_TIME
   12  LblCom even  none     2      2  C_DAY
   13  LblCom even  none     1      1  RTHOLD2
   14  LblCom even  none     1      1  LTHOLD2
   15  LblCom even  none     1      1  NDX2
   16  LblCom even  none     1      1  IN_LEN
   17   Proc  even  none    37     45  X9WE$RW_USE_PROC
   18  RoData even  none     2      2  X9WE$RW_USE_PROC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    17      0   yes            yes      Std        1  X9WE$RW_USE_PROC
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:81   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 X8CL$FIND_BLOCK
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     X9OS$EXIT_BLOCK                       X9OS$EXIT_INDEX

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:82   


      447        1        /*T***********************************************************/
      448        2        /*T*                                                         */
      449        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      450        4        /*T*                                                         */
      451        5        /*T***********************************************************/
      452        6        /*------------*/
      453        7        X9WE$RW_USE_PROC: PROC (FAB);

      7 17 000000   000000 700200 xent  X9WE$RW_USE* TSX0  ! X66_AUTO_1
        17 000001   000056 000001                    ZERO    46,1

      454        8        /*------------*/
      455        9         /*P*
      456       10                NAME: X9WE$RW_USE_PROC
      457       11             PURPOSE: Invoke report writer USE procedure
      458       12         */
      459       13         /*D*
      460       14                    NAME: X9WE$RW_USE_PROC
      461       15                    CALL: CALL X9WE$RW_USE_PROC (FAB);
      462       16                   INPUT: FAB -- The FAB of the report file, or with the other
      463       17                                 entry point, the DML Information Area
      464       18             DESCRIPTION: Set LIBCOM.USE_PROC after safestoring its old value in
      465       19                          the FAB. If there is an EXIT PROGRAM statement in
      466       20                          DECLARATIVES then push an item on the stack with the
      467       21                          address of the FAB. The report writer control system
      468       22                          will do the rest.
      469       23         */
      470       24            %INCLUDE X8A_LIBCOM;
      471      244            %INCLUDE X9A_FAB;
      472      431            %DCL_FAB;
      473      553    1       DCL TYPE UBIN;
      474      554    1       DCL 1 X9OS$EXIT_BLOCK SYMREF DALIGNED,
      475      555    1             2 REM (0:63) REMEMBER,
      476      556    1             2 ITEM (0:63) REDEF REM,
      477      557    1               3 TYPE SBIN,
      478      558    1               3 PTR$ PTR,
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:83   
      479      559    1               3 EPTR$ REDEF PTR$ EPTR,
      480      560    1             2 PREV$ PTR,
      481      561    1             2 NEXT$ PTR;
      482      562    1       DCL X9OS$EXIT_INDEX SBIN SYMREF;
      483      563    1       DCL 1 EXIT$BLOCK DALIGNED BASED (EXIT_BLOCK$),
      484      564    1             2 REM (0:63) REMEMBER,
      485      565    1             2 ITEM (0:63) REDEF REM,
      486      566    1               3 TYPE SBIN,
      487      567    1               3 PTR$ PTR,
      488      568    1               3 EPTR$ REDEF PTR$ EPTR,
      489      569    1             2 PREV$ PTR,
      490      570    1             2 NEXT$ PTR;
      491      571    1       DCL EXIT_BLOCK$ PTR;
      492      572    1       DCL I SBIN;
      493      573    1       DCL X8CL$FIND_BLOCK ENTRY(2);
      494      574        %EJECT;
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:84   
      495      575    1     FAB.B.USE_PROC_SAVE = LIBCOM.USE_PROC;

    575 17 000002   200003 470500                    LDP0    @FAB,,AUTO
        17 000003   000022 236000 0                  LDQ     LIBCOM+18
        17 000004   000032 772000                    QRL     26
        17 000005   000032 676100                    ERQ     26,,PR0
        17 000006   001000 376007                    ANQ     512,DL
        17 000007   000032 656100                    ERSQ    26,,PR0

      496      576    1     LIBCOM.USE_PROC = %TRUE;

    576 17 000010   400000 236003                    LDQ     -131072,DU
        17 000011   000022 756000 0                  STQ     LIBCOM+18

      497      577    1     IF LIBCOM.EXIT_PROG_IN_DECL THEN

    577 17 000012   000023 234000 0                  SZN     LIBCOM+19
        17 000013   000044 605000 17                 TPL     s:587

      498      578    2       DO;

      499      579    2         EXIT_BLOCK$ = ADDR (X9OS$EXIT_BLOCK);

    579 17 000014   000000 236000 18                 LDQ     0
        17 000015   200052 756100                    STQ     EXIT_BLOCK$,,AUTO

      500      580    2         I = X9OS$EXIT_INDEX;

    580 17 000016   000000 235000 xsym               LDA     X9OS$EXIT_INDEX
        17 000017   200053 755100                    STA     I,,AUTO

      501      581    2         IF X9OS$EXIT_INDEX >= 64 THEN

    581 17 000020   000100 115007                    CMPA    64,DL
        17 000021   000032 604000 17                 TMI     s:583

      502      582    2           CALL X8CL$FIND_BLOCK (I, EXIT_BLOCK$);
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:85   

    582 17 000022   200052 631500                    EPPR1   EXIT_BLOCK$,,AUTO
        17 000023   200055 451500                    STP1    I+2,,AUTO
        17 000024   200053 633500                    EPPR3   I,,AUTO
        17 000025   200054 453500                    STP3    I+1,,AUTO
        17 000026   200054 630500                    EPPR0   I+1,,AUTO
        17 000027   000001 631400 18                 EPPR1   1
        17 000030   000000 701000 xent               TSX1    X8CL$FIND_BLOCK
        17 000031   000000 011000                    NOP     0

      503      583    2         EXIT$BLOCK.ITEM.TYPE (I) = 0;

    583 17 000032   200053 235100                    LDA     I,,AUTO
        17 000033   000001 735000                    ALS     1
        17 000034   200052 470500                    LDP0    EXIT_BLOCK$,,AUTO
        17 000035   000000 450105                    STZ     0,AL,PR0

      504      584    2         EXIT$BLOCK.ITEM.PTR$ (I) = ADDR (FAB);

    584 17 000036   200053 235100                    LDA     I,,AUTO
        17 000037   000001 735000                    ALS     1
        17 000040   200003 236100                    LDQ     @FAB,,AUTO
        17 000041   200052 470500                    LDP0    EXIT_BLOCK$,,AUTO
        17 000042   000001 756105                    STQ     1,AL,PR0

      505      585    2         X9OS$EXIT_INDEX = X9OS$EXIT_INDEX + 1;

    585 17 000043   000000 054000 xsym               AOS     X9OS$EXIT_INDEX

      506      586    2       END; /* IF LIBCOM.EXIT_PROG_IN_DECL */

      507      587    1   END X9WE$RW_USE_PROC;

    587 17 000044   000000 702200 xent               TSX2  ! X66_ARET
      508      588        %EJECT;
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:86   

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:87   
--  Include file information  --

   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X9WE$RW_USE_PROC.
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:88   

 **** Variables and constants ****

  ****  Section 000 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)   r     1 LIBCOM

  ****  Section 001 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 DEC_OR_COMMA

  ****  Section 002 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)          1 IN_TEMP

  ****  Section 003 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 OVRCHR

  ****  Section 004 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:89   
  ****  Section 005 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 NO_ADVANCE_OFFSET

  ****  Section 006 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 007 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 008 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 009 LblCom D_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 010 LblCom C_DATE

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:90   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 011 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 012 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 013 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 014 LblCom LTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 015 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:91   

     0-0-0/w SBIN              1 NDX2

  ****  Section 016 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FAB                      52-0-0/w PTR         r     1 EXIT_BLOCK$
    *0-0-0/d STRC(2232)  r     1 FAB                       53-0-0/w SBIN        r     1 I
     4-0-0/w SBIN              1 LT                         5-0-0/c CHAR(65)          1 LTHOLD
    47-0-0/w SBIN              1 NDX                       50-0-0/w SBIN              1 NDX3
    26-0-0/c CHAR(65)          1 RTHOLD                    51-0-0/w UBIN              1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4680)  r     1 X9OS$EXIT_BLOCK            0-0-0/w SBIN        r     1 X9OS$EXIT_INDEX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4680)  r     1 EXIT$BLOCK

PL6.E3A0      #002=X9WE$RW_USE_PROC File=X9WE.:X8A6TSI                           SAT 08/09/97 11:09 Page:92   

   Procedure X9WE$RW_USE_PROC requires 37 words for executable code.
   Procedure X9WE$RW_USE_PROC requires 46 words of local(AUTO) storage.

    No errors detected in file X9WE.:X8A6TSI    .
