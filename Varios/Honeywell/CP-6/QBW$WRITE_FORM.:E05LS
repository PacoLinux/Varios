VERSION E05

PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:1    
        1        1        /*M* QBW$WRITE_FORM:  WRITE FR-section-record-name, or WRITE PAGE.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBW$WRITE_FORM
       10       10              PURPOSE:      Write fields within a form.
       11       11              DESCRIPTION:  Execute a WRITE_FORM op-code, whose argument is
       12       12                            a 01-level FRAME SECTION DAD (record), or a
       13       13                            IS_WRITE_PAGE flag.
       14       14        */
       15       15
       16       16        QBW$WRITE_FORM: PROC;
       17       17
       18       18        /*D*  NAME:         QBW$WRITE_FORM
       19       19              CALL:         CALL QBW$WRITE_FORM;
       20       20              PARAMETERS:   None.
       21       21              INTERFACE:    Called by QAT$TALLYHO when a WRITE_FORM op-code
       22       22                            is encountered.
       23       23                            Calls QCW$WRITE for "WRITE FR-section-record-name...",
       24       24                            calls M$DEVICE for "WRITE PAGE".
       25       25              ENVIRONMENT:  Nothing unusual.
       26       26              INPUT:        QI_1,
       27       27                            FPL rununit statis data following the op-code.
       28       28              OUTPUT:       Writes the appropriate field buffers
       29       29                            to a terminal for "WRITE FR-section-record-name...",
       30       30                            flushes field buffers of all open FORM FDs
       31       31                            (via M$DEVICE) for "WRITE PAGE".
       32       32              SCRATCH:      Various otter data.
       33       33              DESCRIPTION:  Two different actions are taken according to the
       34       34                            IS_WRITE_PAGE bit in the op-code sequence:
       35       35                            1)  For "WRITE FR-section-record-name...",
       36       36                                checks to see if the FORM to be written from is open;
       37       37                                if so, checks to see if the frame containing the record
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:2    
       38       38                                to be written is active; if this is also true, then
       39       39                                calls QCW$WRITE to write the appropriate fields
       40       40                                (see commentary in that module).
       41       41                            2)  For "WRITE PAGE",
       42       42                                calls M$DEVICE through DCBs corresponding to any
       43       43                                and all open FORM FDs.  This, in effect, "flushes"
       44       44                                the buffers for fields which were M$WRITtEn earlier,
       45       45                                and is pretty much only useful for hardcopy terminals.
       46       46        */
       47       47
       48       48          %INCLUDE LCP_6;
       49      239          %FPT_DEVICE ( FPTN = FPT@DEVICE,
       50      240                        STCLASS = AUTO );
       51      267
       52      268          %INCLUDE QG_MACRO_M;
       53      405          %QGB_ENTRIES;
       54      418          %INCLUDE QI_EQUATES_E;
       55      777          %INCLUDE QI_PERR_C;
       56      945          %INCLUDE QI_MACROS_M;
       57     6003          %QI$ALL;
       58    17116          %QI_FPTS;
       59    19161
       60    19162    1     DCL ERROR_STATUS$ PTR;
       61    19163    1     DCL FORM_FILE$ PTR;
       62    19164    1     DCL FORM_STATUS$ PTR;
       63    19165    1     DCL INSTR$ PTR;
       64    19166
       65    19167    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       66    19168    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
       67    19169    1     DCL QCF$FIND_CURRENTS ENTRY;
       68    19170    1     DCL QCW$WRITE ENTRY (1);
       69    19171    1     DCL QCU$USE_INVALID_IO ENTRY (1);
       70    19172
       71    19173          %SET LISTMAC = '1'B;
       72    19174
       73    19175          %INCLUDE QCW_WRITE_M;
       74    19210          %QCW@WRITE;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:3    
             19211            %BEGIN_MACRO ( STCLASS = STCLASS );
             19212            %SET LISTDIR = '0'B;
             19225    1     DCL 1 QCW@WRITE ALIGNED,
             19226    1           2 FRAME_START_INDEX UBIN,
             19227                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19228    1           2 FRAME_STOP_INDEX UBIN,
             19229                          /* Stopping index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19230    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19231                          /* If IS_FIELD_INDEXES_VALID, use them;
             19232                             else use all the fields in the frame.  */
             19233    1           2 FIELD_START_INDEX UBIN,
             19234                          /* Starting index into QI$GZ_FIELD table.  */
             19235    1           2 FIELD_STOP_INDEX UBIN,
             19236                          /* Stopping index into QI$GZ_FIELD table.  */
             19237    1           2 STATUS UBIN,
             19238                          /* Returned status code:  0 -> Immediate return to level 0;
             19239                                                   >0 -> Status is ok.  */
             19240    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19241                          /* Passed index for QCG$GET_FIELD processing.  */
             19248            %ENDIF;
       75    19251
       76    19252          %INCLUDE QCU_USE_M;
       77    19306          %QCU@USE;
             19307            %BEGIN_MACRO;
             19308            %SET LISTDIR = '0'B;
             19321    1     DCL 1 QCU@USE AUTO ALIGNED,
             19322    1           2 CURR_FRAME$ PTR,
             19323                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             19324    1           2 CURR_NODE$ PTR,
             19325                          /* Pointer to current node or ADDR (NIL).  */
             19326    1           2 USE_DEFAULT_IO UBIN,
             19327                          /* For USE procedures which default applies
             19328                             (see corresponding EQUs).  */
             19329    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             19330                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             19331                             save the fields within the bounds of
             19332                             FRAME_START_INDEX, FRAME_STOP_INDEX,
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:4    
             19333                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             19334                             before calling the USE procedure.  */
             19335    1           2 FRAME_START_INDEX UBIN,
             19336                          /* Foist frame of the CURRENT.FORM$
             19337                             involved with the I-O error.  */
             19338    1           2 FRAME_STOP_INDEX UBIN,
             19339                          /* Larst frame of the CURRENT.FORM$
             19340                             involved with the I-O error.  */
             19341    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19342                          /* If IS_FIELD_INDEXES_VALID, use them;
             19343                             else use all the fields in the frame.  */
             19344    1           2 FIELD_START_INDEX UBIN,
             19345                          /* Starting index into QI$GZ_FIELD
             19346                             which may have values "pushed".  */
             19347    1           2 FIELD_STOP_INDEX UBIN,
             19348                          /* Stopping index into QI$GZ_FIELD
             19349                             which may have values "pushed".  */
             19350    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19351                          /* If IS_CURSOR_POSITION_VALID, use it;
             19352                             else allow cursor to default to upper-left-most field.  */
             19353    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19354                          /* POSition of the field on which to place the cursor.  */
             19355    1           2 STATUS UBIN;
             19356                          /* Returned action code; see corresponding EQUs.  */
             19363            %ENDIF;
       78    19366
       79    19367          %SET LISTMAC = '0'B;
       80    19368        %EJECT;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:5    
       81    19369    1       INSTR$ = QI_1.INSTR$;
       82    19370    1       QI_1.INSTR$ = ADDR ( INSTR$ -> QI$OP_WRITE_FORM.NEXT_CODE@P );
       83    19371
       84    19372    1   RETRY_WHATEVER_WRITE:
       85    19373    1       QI_1.A_REG = 0;
       86    19374
       87    19375    1       IF INSTR$ -> QI$OP_WRITE_FORM.IS_WRITE_PAGE
       88    19376    1       THEN
       89    19377    1   WRITE_PAGE:
       90    19378    2         DO;
       91    19379
       92    19380    2           FPT@DEVICE = QI_FPT_DEVICE;
       93    19381    2           VBASE ( FPT@DEVICE.V_ ) = ADDR ( FPT@DEVICE.V );
       94    19382    2           FPT@DEVICE.V.PAGE = %YES;
       95    19383
       96    19384    2           FORM_FILE$ = QI_1.FILE_HEAD.FORM$;
       97    19385
       98    19386    2   WRITE_PAGE_FOR_EACH_OPEN_FORM:
       99    19387    3           DO WHILE ( FORM_FILE$ ~= ADDR (NIL) );
      100    19388
      101    19389    3             FPT@DEVICE.V.DCB# = FORM_FILE$ -> QI$FORM_FILE.DCB#;
      102    19390
      103    19391    3             CALL QGB$DEVICE ( FPT@DEVICE, QGB_PARAM )
      104    19392    3             WHENALTRETURN
      105    19393    4               DO;
      106    19394    4                 CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      107    19395    4               END;
      108    19396
      109    19397                  %DATA_ADDRESS ( THING@D = "FORM_FILE$ -> QI$FORM_FILE.STATUS_AREA@D",
      110    19398                  CHECK_FOR_INDIRECTION = NO,
      111    19399                  RESULT$ = FORM_STATUS$ );
      112    19436    3             FORM_FILE$ = FORM_STATUS$ -> QI$FORM_STATUS.FLINK$;
      113    19437
      114    19438    3           END WRITE_PAGE_FOR_EACH_OPEN_FORM;
      115    19439
      116    19440    2         END WRITE_PAGE;
      117    19441    1       ELSE
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:6    
      118    19442    1   WRITE_FORM_RECORD:
      119    19443    2         DO;
      120    19444
      121    19445                %PROC_ADDRESS ( THING@P = "INSTR$ -> QI$OP_WRITE_FORM.FORM_RECORD@P",
      122    19446                CHECK_FOR_INDIRECTION = YES,
      123    19447                RESULT$ = "QI_1.CURRENT.NODE$" );
      124    19484
      125    19485    2           CALL QCF$FIND_CURRENTS;
      126    19486
      127    19487    2           IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
      128    19488    2           THEN
      129    19489    3             DO;
      130    19490    3               QI_1.ERROR_STATUS = %E$FRAME_NOT_ACTIVE;
      131    19491    3               GOTO CHECK_USE_PROCEDURE_OR_INVALID;
      132    19492    3             END;
      133    19493
      134    19494    2           IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19494                    IS_OUTPUT
      135    19495    2           THEN
      136    19496    3             DO;
      137    19497    3               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19497                        IS_INPUT
      138    19498    3               THEN
      139    19499    3                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN_OUTPUT;
      140    19500    3               ELSE
      141    19501    3                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;
      142    19502    3               GOTO CHECK_USE_PROCEDURE_OR_INVALID;
      143    19503    3             END;
      144    19504
      145    19505    2           QCW@WRITE.FRAME_START_INDEX = QI_1.CURRENT.FRAME_INDEX;
      146    19506    2           QCW@WRITE.FRAME_STOP_INDEX = QI_1.CURRENT.FRAME_INDEX;
      147    19507    2           QCW@WRITE.IS_FIELD_INDEXES_VALID = %YES;
      148    19508    2           QCW@WRITE.FIELD_START_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.
             19508                    GZ.FIELD_START_INDEX;
      149    19509    2           QCW@WRITE.FIELD_STOP_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ
             19509                    .FIELD_STOP_INDEX;
      150    19510
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:7    
      151    19511    2           CALL QCW$WRITE ( QCW@WRITE );
      152    19512
      153    19513        /* Check return status                                                        */
      154    19514    2           IF QCW@WRITE.STATUS = %QI#USE_INVALID_RETURN
      155    19515    2           THEN
      156    19516    2             RETURN;
      157    19517
      158    19518    2           IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      159    19519    2           THEN
      160    19520    3             DO;
      161    19521
      162    19522                    %DATA_ADDRESS ( THING@D =
             19522                        "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.ERROR_STATUS@D",
      163    19523                    CHECK_FOR_INDIRECTION = NO,
      164    19524                    RESULT$ = ERROR_STATUS$ );
      165    19561
      166    19562    3               ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_WRITE_FORM_TEXT;
      167    19563
      168    19564    3             END;
      169    19565
      170    19566    2         END WRITE_FORM_RECORD;
      171    19567
      172    19568    1       RETURN;
      173    19569
      174    19570        %EJECT;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:8    
      175    19571    1   CHECK_USE_PROCEDURE_OR_INVALID:
      176    19572    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;
      177    19573    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;
      178    19574    1       QCU@USE.CURR_NODE$ = QI_1.CURRENT.FORM$;
      179    19575    1       QCU@USE.CURR_FRAME$ = ADDR (NIL);
      180    19576
      181    19577    1       CALL QCU$USE_INVALID_IO ( QCU@USE );
      182    19578
      183    19579    2       DO CASE ( QCU@USE.STATUS );
      184    19580
      185    19581    2         CASE ( %QI#USE_INVALID_RETURN );
      186    19582    2           RETURN;
      187    19583
      188    19584    2         CASE ( %QI#USE_INVALID_RETRY );
      189    19585    2           GOTO RETRY_WHATEVER_WRITE;
      190    19586
      191    19587    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );
      192    19588    2           RETURN;
      193    19589
      194    19590    2         CASE ( ELSE );
      195    19591    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      196    19592
      197    19593    2       END;
      198    19594
      199    19595    1   END QBW$WRITE_FORM;

PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:9    
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QCW_WRITE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBW$WRITE_FORM.

   Procedure QBW$WRITE_FORM requires 318 words for executable code.
   Procedure QBW$WRITE_FORM requires 52 words of local(AUTO) storage.

    No errors detected in file QBW$WRITE_FORM.:E05TSI    .

PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:10   

 Object Unit name= QBW$WRITE_FORM                             File name= QBW$WRITE_FORM.:E05TOU
 UTS= JUL 30 '97 04:58:30.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      1      1  QBW$WRITE_FORM
    1   Proc  even  none   318    13E  QBW$WRITE_FORM
    2  RoData even  none     6      6  QBW$WRITE_FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  QBW$WRITE_FORM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 QGB$DEVICE
         yes           Std       4 QCE$ERROR_M$INTERNAL
         yes           Std       4 QCE$ERROR_INTERNAL
         yes           Std       0 QCF$FIND_CURRENTS
         yes           Std       1 QCU$USE_INVALID_IO
         yes           Std       1 QCW$WRITE
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6A_ARET
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QGB_PARAM                             QI_4_CHAR_ALPHANUMERIC
     QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY                      QI_32_BIT_BINARY
     QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING                     QI_FPT_DEVICE
r    G$ROS$
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:12   


        1        1        /*M* QBW$WRITE_FORM:  WRITE FR-section-record-name, or WRITE PAGE.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBW$WRITE_FORM
       10       10              PURPOSE:      Write fields within a form.
       11       11              DESCRIPTION:  Execute a WRITE_FORM op-code, whose argument is
       12       12                            a 01-level FRAME SECTION DAD (record), or a
       13       13                            IS_WRITE_PAGE flag.
       14       14        */
       15       15
       16       16        QBW$WRITE_FORM: PROC;

     16   1 000000  D380 0000 0000  xent QBW$WRITE_FORM  LNJ,B5   X6A_AUTO_0
          1 000003       0034 0000                       DC       52,0

       17       17
       18       18        /*D*  NAME:         QBW$WRITE_FORM
       19       19              CALL:         CALL QBW$WRITE_FORM;
       20       20              PARAMETERS:   None.
       21       21              INTERFACE:    Called by QAT$TALLYHO when a WRITE_FORM op-code
       22       22                            is encountered.
       23       23                            Calls QCW$WRITE for "WRITE FR-section-record-name...",
       24       24                            calls M$DEVICE for "WRITE PAGE".
       25       25              ENVIRONMENT:  Nothing unusual.
       26       26              INPUT:        QI_1,
       27       27                            FPL rununit statis data following the op-code.
       28       28              OUTPUT:       Writes the appropriate field buffers
       29       29                            to a terminal for "WRITE FR-section-record-name...",
       30       30                            flushes field buffers of all open FORM FDs
       31       31                            (via M$DEVICE) for "WRITE PAGE".
       32       32              SCRATCH:      Various otter data.
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:13   
       33       33              DESCRIPTION:  Two different actions are taken according to the
       34       34                            IS_WRITE_PAGE bit in the op-code sequence:
       35       35                            1)  For "WRITE FR-section-record-name...",
       36       36                                checks to see if the FORM to be written from is open;
       37       37                                if so, checks to see if the frame containing the record
       38       38                                to be written is active; if this is also true, then
       39       39                                calls QCW$WRITE to write the appropriate fields
       40       40                                (see commentary in that module).
       41       41                            2)  For "WRITE PAGE",
       42       42                                calls M$DEVICE through DCBs corresponding to any
       43       43                                and all open FORM FDs.  This, in effect, "flushes"
       44       44                                the buffers for fields which were M$WRITtEn earlier,
       45       45                                and is pretty much only useful for hardcopy terminals.
       46       46        */
       47       47
       48       48          %INCLUDE LCP_6;
       49      239          %FPT_DEVICE ( FPTN = FPT@DEVICE,
       50      240                        STCLASS = AUTO );
       51      267
       52      268          %INCLUDE QG_MACRO_M;
       53      405          %QGB_ENTRIES;
       54      418          %INCLUDE QI_EQUATES_E;
       55      777          %INCLUDE QI_PERR_C;
       56      945          %INCLUDE QI_MACROS_M;
       57     6003          %QI$ALL;
       58    17116          %QI_FPTS;
       59    19161
       60    19162    1     DCL ERROR_STATUS$ PTR;
       61    19163    1     DCL FORM_FILE$ PTR;
       62    19164    1     DCL FORM_STATUS$ PTR;
       63    19165    1     DCL INSTR$ PTR;
       64    19166
       65    19167    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       66    19168    1     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
       67    19169    1     DCL QCF$FIND_CURRENTS ENTRY;
       68    19170    1     DCL QCW$WRITE ENTRY (1);
       69    19171    1     DCL QCU$USE_INVALID_IO ENTRY (1);
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:14   
       70    19172
       71    19173          %SET LISTMAC = '1'B;
       72    19174
       73    19175          %INCLUDE QCW_WRITE_M;
       74    19210          %QCW@WRITE;
             19211            %BEGIN_MACRO ( STCLASS = STCLASS );
             19212            %SET LISTDIR = '0'B;
             19225    1     DCL 1 QCW@WRITE ALIGNED,
             19226    1           2 FRAME_START_INDEX UBIN,
             19227                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19228    1           2 FRAME_STOP_INDEX UBIN,
             19229                          /* Stopping index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19230    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19231                          /* If IS_FIELD_INDEXES_VALID, use them;
             19232                             else use all the fields in the frame.  */
             19233    1           2 FIELD_START_INDEX UBIN,
             19234                          /* Starting index into QI$GZ_FIELD table.  */
             19235    1           2 FIELD_STOP_INDEX UBIN,
             19236                          /* Stopping index into QI$GZ_FIELD table.  */
             19237    1           2 STATUS UBIN,
             19238                          /* Returned status code:  0 -> Immediate return to level 0;
             19239                                                   >0 -> Status is ok.  */
             19240    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19241                          /* Passed index for QCG$GET_FIELD processing.  */
             19248            %ENDIF;
       75    19251
       76    19252          %INCLUDE QCU_USE_M;
       77    19306          %QCU@USE;
             19307            %BEGIN_MACRO;
             19308            %SET LISTDIR = '0'B;
             19321    1     DCL 1 QCU@USE AUTO ALIGNED,
             19322    1           2 CURR_FRAME$ PTR,
             19323                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             19324    1           2 CURR_NODE$ PTR,
             19325                          /* Pointer to current node or ADDR (NIL).  */
             19326    1           2 USE_DEFAULT_IO UBIN,
             19327                          /* For USE procedures which default applies
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:15   
             19328                             (see corresponding EQUs).  */
             19329    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             19330                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             19331                             save the fields within the bounds of
             19332                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             19333                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             19334                             before calling the USE procedure.  */
             19335    1           2 FRAME_START_INDEX UBIN,
             19336                          /* Foist frame of the CURRENT.FORM$
             19337                             involved with the I-O error.  */
             19338    1           2 FRAME_STOP_INDEX UBIN,
             19339                          /* Larst frame of the CURRENT.FORM$
             19340                             involved with the I-O error.  */
             19341    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19342                          /* If IS_FIELD_INDEXES_VALID, use them;
             19343                             else use all the fields in the frame.  */
             19344    1           2 FIELD_START_INDEX UBIN,
             19345                          /* Starting index into QI$GZ_FIELD
             19346                             which may have values "pushed".  */
             19347    1           2 FIELD_STOP_INDEX UBIN,
             19348                          /* Stopping index into QI$GZ_FIELD
             19349                             which may have values "pushed".  */
             19350    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19351                          /* If IS_CURSOR_POSITION_VALID, use it;
             19352                             else allow cursor to default to upper-left-most field.  */
             19353    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19354                          /* POSition of the field on which to place the cursor.  */
             19355    1           2 STATUS UBIN;
             19356                          /* Returned action code; see corresponding EQUs.  */
             19363            %ENDIF;
       78    19366
       79    19367          %SET LISTMAC = '0'B;
       80    19368        %EJECT;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:16   
       81    19369    1       INSTR$ = QI_1.INSTR$;

  19369   1 000005  EC80 0000 0006  xsym                 LDB,B6   QI_1+6
          1 000008  EFC7 0019                            STB,B6   INSTR$,AUTO

       82    19370    1       QI_1.INSTR$ = ADDR ( INSTR$ -> QI$OP_WRITE_FORM.NEXT_CODE@P );

  19370   1 00000A  DBC6 0003                            LAB,B5   3,B6
          1 00000C  DF80 0000 0006  xsym                 STB,B5   QI_1+6

       83    19371
       84    19372    1   RETRY_WHATEVER_WRITE:
       85    19373    1       QI_1.A_REG = 0;

  19373   1 00000F  8700 0000 0054  xsym RETRY_WHATEVER_*CL       QI_1+84

       86    19374
       87    19375    1       IF INSTR$ -> QI$OP_WRITE_FORM.IS_WRITE_PAGE

  19375   1 000012  ECC7 0019                            LDB,B6   INSTR$,AUTO
          1 000014  89C6 0001                            CMZ      1,B6
          1 000016  0881 004F                            BAGE     s:19443,PREL

       88    19376    1       THEN
       89    19377    1   WRITE_PAGE:
       90    19378    2         DO;

  19378   1                              WRITE_PAGE      null
       91    19379
       92    19380    2           FPT@DEVICE = QI_FPT_DEVICE;

  19380   1 000018  AB80 0000 0000  xsym WRITE_PAGE      LAB,B2   QI_FPT_DEVICE
          1 00001B  2C00                                 LDV,R2   0
          1 00001C  6C1E                                 LDV,R6   30
          1 00001D  BB87                                 LAB,B3   ,AUTO
          1 00001E  3C08                                 LDV,R3   8
          1 00001F  0008                                 MMM
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:17   

       93    19381    2           VBASE ( FPT@DEVICE.V_ ) = ADDR ( FPT@DEVICE.V );

  19381   1 000020  EBC7 000D                            LAB,B6   FPT@DEVICE+9,AUTO
          1 000022  EFC7 0005                            STB,B6   FPT@DEVICE+1,AUTO

       94    19382    2           FPT@DEVICE.V.PAGE = %YES;

  19382   1 000024  8947 000D                            LBT,'0020'X       FPT@DEVICE+9,AUTO
  19382   1 000026       0020

       95    19383
       96    19384    2           FORM_FILE$ = QI_1.FILE_HEAD.FORM$;

  19384   1 000027  DC80 0000 0070  xsym                 LDB,B5   QI_1+112
          1 00002A  DFC7 0015                            STB,B5   FORM_FILE$,AUTO

       97    19385
       98    19386    2   WRITE_PAGE_FOR_EACH_OPEN_FORM:
       99    19387    3           DO WHILE ( FORM_FILE$ ~= ADDR (NIL) );

  19387   1 00002C  0F81 0034            WRITE_PAGE_FOR_*B        s:19438,PREL

      100    19388
      101    19389    3             FPT@DEVICE.V.DCB# = FORM_FILE$ -> QI$FORM_FILE.DCB#;

  19389   1 00002E  ECC7 0015                            LDB,B6   FORM_FILE$,AUTO
          1 000030  E846 0008                            LDR,R6   8,B6
          1 000032  E7C7 000D                            STH,R6   FPT@DEVICE+9,AUTO

      102    19390
      103    19391    3             CALL QGB$DEVICE ( FPT@DEVICE, QGB_PARAM )

  19391   1 000034  DB80 0000 0000  xsym                 LAB,B5   QGB_PARAM
          1 000037  DFC7 0032                            STB,B5   QCU@USE+16,AUTO
          1 000039  CBC7 0004                            LAB,B4   FPT@DEVICE,AUTO
          1 00003B  CFC7 0030                            STB,B4   QCU@USE+14,AUTO
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:18   
          1 00003D  BBC7 0030                            LAB,B3   QCU@USE+14,AUTO
          1 00003F  CBF0 0200                            LAB,B4   512,IMO
          1 000041  E380 0000 0000  xent                 LNJ,B6   QGB$DEVICE
          1 000044       0003                            DC       s:19394,PREL
          1 000045  0F81 000A                            B        s:19417,PREL

      104    19392    3             WHENALTRETURN
      105    19393    4               DO;

      106    19394    4                 CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19394   1 000047  BB80 0000 0001  02                   LAB,B3   +1
          1 00004A  CBF0 0100                            LAB,B4   256,IMO
          1 00004C  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          1 00004F       0001                            DC       s:19417,PREL

      107    19395    4               END;

      108    19396
      109    19397                  %DATA_ADDRESS ( THING@D = "FORM_FILE$ -> QI$FORM_FILE.STATUS_AREA@D",
      110    19398                  CHECK_FOR_INDIRECTION = NO,
      111    19399                  RESULT$ = FORM_STATUS$ );

  19417   1 000050  ECC7 0015                            LDB,B6   FORM_FILE$,AUTO
          1 000052  B846 0006                            LDR,R3   6,B6
          1 000054  F853                                 LDR,R7   R3
          1 000055  6C00                                 LDV,R6   0
          1 000056  8400 0000 0000  xsym                 AID      QI_1
          1 000059  8D47 0017                            SDI      FORM_STATUS$,AUTO

      112    19436    3             FORM_FILE$ = FORM_STATUS$ -> QI$FORM_STATUS.FLINK$;

  19436   1 00005B  DCC7 0017                            LDB,B5   FORM_STATUS$,AUTO
          1 00005D  CCC5 0002                            LDB,B4   2,B5
          1 00005F  CFC7 0015                            STB,B4   FORM_FILE$,AUTO

      113    19437
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:19   
      114    19438    3           END WRITE_PAGE_FOR_EACH_OPEN_FORM;

  19438   1 000061  8DC7 0015                            CMN      FORM_FILE$,AUTO
          1 000063  09CB                                 BNE      s:19389,SPREL

      115    19439
      116    19440    2         END WRITE_PAGE;

  19440   1 000064  0F81 0099                            B        s:19568,PREL

      117    19441    1       ELSE
      118    19442    1   WRITE_FORM_RECORD:
      119    19443    2         DO;

  19443   1                              WRITE_FORM_RECO*null
      120    19444
      121    19445                %PROC_ADDRESS ( THING@P = "INSTR$ -> QI$OP_WRITE_FORM.FORM_RECORD@P",
      122    19446                CHECK_FOR_INDIRECTION = YES,
      123    19447                RESULT$ = "QI_1.CURRENT.NODE$" );

  19465   1 000066  B846 0002            WRITE_FORM_RECO*LDR,R3   2,B6
          1 000068  F853                                 LDR,R7   R3
          1 000069  6C00                                 LDV,R6   0
          1 00006A  8400 0000 0002  xsym                 AID      QI_1+2
          1 00006D  8D00 0000 0080  xsym                 SDI      QI_1+128

  19467   1 000070  DC80 0000 0080  xsym                 LDB,B5   QI_1+128
          1 000073  8985                                 CMZ      ,B5
          1 000074  0881 001C                            BAGE     s:19485,PREL

  19468   1 000076  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          1 000079  E806                                 LDR,R6   ,B6
          1 00007A  6046                                 SOR,R6   6
          1 00007B  E570 0001                            AND,R6   1,IMO
          1 00007D  B846 0002                            LDR,R3   2,B6
          1 00007F  A856                                 LDR,R2   R6
          1 000080  DCA0 0000 0000  xsym                 LDB,B5   QI_1,R2
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:20   
          1 000083  DFC7 0030                            STB,B5   QCU@USE+14,AUTO
          1 000085  F853                                 LDR,R7   R3
          1 000086  6C00                                 LDV,R6   0
          1 000087  8447 0030                            AID      QCU@USE+14,AUTO
          1 000089  8D00 0000 0080  xsym                 SDI      QI_1+128

  19472   1 00008C  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          1 00008F  8986                                 CMZ      ,B6
          1 000090  0866                                 BAL      s:19468,SPREL

      124    19484
      125    19485    2           CALL QCF$FIND_CURRENTS;

  19485   1 000091  CBF0 0000                            LAB,B4   0,IMO
          1 000093  E380 0000 0000  xent                 LNJ,B6   QCF$FIND_CURRENTS
          1 000096       0001                            DC       s:19487,PREL

      126    19486
      127    19487    2           IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  19487   1 000097  EC80 0000 007C  xsym                 LDB,B6   QI_1+124
          1 00009A  89C6 000C                            CMZ      12,B6
          1 00009C  0801 0007                            BAL      s:19494,PREL

      128    19488    2           THEN
      129    19489    3             DO;

      130    19490    3               QI_1.ERROR_STATUS = %E$FRAME_NOT_ACTIVE;

  19490   1 00009E  6C07                                 LDV,R6   7
          1 00009F  EF00 0000 008C  xsym                 STR,R6   QI_1+140

      131    19491    3               GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  19491   1 0000A2  0F81 005F                            B        s:19572,PREL

      132    19492    3             END;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:21   
      133    19493
      134    19494    2           IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19494                    IS_OUTPUT

  19494   1 0000A4  DC80 0000 0078  xsym                 LDB,B5   QI_1+120
          1 0000A7  82C5 0008                            LB,'0400'X        8,B5
          1 0000A9       0400
          1 0000AA  0501 0012                            BBT      s:19505,PREL

      135    19495    2           THEN
      136    19496    3             DO;

      137    19497    3               IF QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19497                        IS_INPUT

  19497   1 0000AC  82C5 0008                            LB,'0200'X        8,B5
  19497   1 0000AE       0200
          1 0000AF  0581 0007                            BBF      s:19501,PREL

      138    19498    3               THEN
      139    19499    3                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN_OUTPUT;

  19499   1 0000B1  6C06                                 LDV,R6   6
          1 0000B2  EF00 0000 008C  xsym                 STR,R6   QI_1+140
          1 0000B5  0F81 0005                            B        s:19502,PREL

      140    19500    3               ELSE
      141    19501    3                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;

  19501   1 0000B7  6C01                                 LDV,R6   1
          1 0000B8  EF00 0000 008C  xsym                 STR,R6   QI_1+140

      142    19502    3               GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  19502   1 0000BB  0F81 0046                            B        s:19572,PREL

      143    19503    3             END;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:22   
      144    19504
      145    19505    2           QCW@WRITE.FRAME_START_INDEX = QI_1.CURRENT.FRAME_INDEX;

  19505   1 0000BD  E800 0000 007E  xsym                 LDR,R6   QI_1+126
          1 0000C0  EF47 001B                            STR,R6   QCW@WRITE,AUTO

      146    19506    2           QCW@WRITE.FRAME_STOP_INDEX = QI_1.CURRENT.FRAME_INDEX;

  19506   1 0000C2  EF47 001C                            STR,R6   QCW@WRITE+1,AUTO

      147    19507    2           QCW@WRITE.IS_FIELD_INDEXES_VALID = %YES;

  19507   1 0000C4  8947 001D                            LBT,'8000'X       QCW@WRITE+2,AUTO
  19507   1 0000C6       8000

      148    19508    2           QCW@WRITE.FIELD_START_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.
             19508                    GZ.FIELD_START_INDEX;

  19508   1 0000C7  CC80 0000 0082  xsym                 LDB,B4   QI_1+130
          1 0000CA  D804                                 LDR,R5   ,B4
          1 0000CB  DF47 001E                            STR,R5   QCW@WRITE+3,AUTO

      149    19509    2          QCW@WRITE.FIELD_STOP_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ
             19509                    .FIELD_STOP_INDEX;

  19509   1 0000CD  C844 0001                            LDR,R4   1,B4
          1 0000CF  CF47 001F                            STR,R4   QCW@WRITE+4,AUTO

      150    19510
      151    19511    2           CALL QCW$WRITE ( QCW@WRITE );

  19511   1 0000D1  BBC7 001B                            LAB,B3   QCW@WRITE,AUTO
          1 0000D3  BFC7 0030                            STB,B3   QCU@USE+14,AUTO
          1 0000D5  BBC7 0030                            LAB,B3   QCU@USE+14,AUTO
          1 0000D7  CBF0 0100                            LAB,B4   256,IMO
          1 0000D9  E380 0000 0000  xent                 LNJ,B6   QCW$WRITE
          1 0000DC       0001                            DC       s:19514,PREL
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:23   

      152    19512
      153    19513        /* Check return status                                                        */
      154    19514    2           IF QCW@WRITE.STATUS = %QI#USE_INVALID_RETURN

  19514   1 0000DD  E847 0020                            LDR,R6   QCW@WRITE+5,AUTO
          1 0000DF  6981 0004                            BNEZ,R6  s:19518,PREL

      155    19515    2           THEN
      156    19516    2             RETURN;

  19516   1 0000E1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      157    19517
      158    19518    2           IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID

  19518   1 0000E4  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 0000E7  8286                                 LB,'4000'X        ,B6
          1 0000E8       4000
          1 0000E9  0581 0014                            BBF      s:19568,PREL

      159    19519    2           THEN
      160    19520    3             DO;

      161    19521
      162    19522                    %DATA_ADDRESS ( THING@D =
             19522                        "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.ERROR_STATUS@D",
      163    19523                    CHECK_FOR_INDIRECTION = NO,
      164    19524                    RESULT$ = ERROR_STATUS$ );

  19542   1 0000EB  B846 0003                            LDR,R3   3,B6
          1 0000ED  F853                                 LDR,R7   R3
          1 0000EE  6C00                                 LDV,R6   0
          1 0000EF  8400 0000 0000  xsym                 AID      QI_1
          1 0000F2  8D47 0013                            SDI      ERROR_STATUS$,AUTO

      165    19561
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:24   
      166    19562    3               ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_WRITE_FORM_TEXT;

  19562   1 0000F4  DB80 0000 0000  00                   LAB,B5   0
          1 0000F7  CCC7 0013                            LDB,B4   ERROR_STATUS$,AUTO
          1 0000F9  0021                                 ALR      ;
          1 0000FA       4205 0000                                ALPHANUM(0,B5,,2),;
          1 0000FC       4804 0000                                ALPHANUM(0,B4,,8,FILL)

      167    19563
      168    19564    3             END;

      169    19565
      170    19566    2         END WRITE_FORM_RECORD;

      171    19567
      172    19568    1       RETURN;

  19568   1 0000FE  437F                                 CSYNC    s:19562+9,SPREL
          1 0000FF  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      173    19569
      174    19570        %EJECT;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:25   
      175    19571    1   CHECK_USE_PROCEDURE_OR_INVALID:
      176    19572    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;

  19572   1 000102  8747 0026            CHECK_USE_PROCE*CL       QCU@USE+4,AUTO

      177    19573    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;

  19573   1 000104  8747 0027                            CL       QCU@USE+5,AUTO

      178    19574    1       QCU@USE.CURR_NODE$ = QI_1.CURRENT.FORM$;

  19574   1 000106  DC80 0000 0076  xsym                 LDB,B5   QI_1+118
          1 000109  DFC7 0024                            STB,B5   QCU@USE+2,AUTO

      179    19575    1       QCU@USE.CURR_FRAME$ = ADDR (NIL);

  19575   1 00010B  CB80 0000 0000                       LAB,B4   0
          1 00010E  CFC7 0022                            STB,B4   QCU@USE,AUTO

      180    19576
      181    19577    1       CALL QCU$USE_INVALID_IO ( QCU@USE );

  19577   1 000110  BBC7 0022                            LAB,B3   QCU@USE,AUTO
          1 000112  BFC7 0030                            STB,B3   QCU@USE+14,AUTO
          1 000114  BBC7 0030                            LAB,B3   QCU@USE+14,AUTO
          1 000116  CBF0 0100                            LAB,B4   256,IMO
          1 000118  E380 0000 0000  xent                 LNJ,B6   QCU$USE_INVALID_IO
          1 00011B       0001                            DC       s:19579,PREL

      182    19578
      183    19579    2       DO CASE ( QCU@USE.STATUS );

  19579   1 00011C  B847 002F                            LDR,R3   QCU@USE+13,AUTO
          1 00011E  3D03                                 CMV,R3   3
          1 00011F  0281 0012                            BGE      s:19591,PREL
          1 000121  A830 0000 0127  01                   LDR,R2   s:19579+11,R3
          1 000124  83A0 0000 012A  01                   JMP      s:19582,R2
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:26   
          1 000127       0000                            DC       s:19582,PREL
          1 000128       0003                            DC       s:19585,PREL
          1 000129       0005                            DC       s:19588,PREL

      184    19580
      185    19581    2         CASE ( %QI#USE_INVALID_RETURN );

      186    19582    2           RETURN;

  19582   1 00012A  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      187    19583
      188    19584    2         CASE ( %QI#USE_INVALID_RETRY );

      189    19585    2           GOTO RETRY_WHATEVER_WRITE;

  19585   1 00012D  0F81 FEE1                            B        s:19373,PREL

      190    19586
      191    19587    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );

      192    19588    2           RETURN;

  19588   1 00012F  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      193    19589
      194    19590    2         CASE ( ELSE );

      195    19591    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19591   1 000132  BB80 0000 0004  02                   LAB,B3   +4
          1 000135  CBF0 0100                            LAB,B4   256,IMO
          1 000137  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 00013A       0001                            DC       s:19595,PREL

      196    19592
      197    19593    2       END;
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:27   

      198    19594
      199    19595    1   END QBW$WRITE_FORM;

  19595   1 00013B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:28   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QCW_WRITE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBW$WRITE_FORM.
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:29   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    13-0-0/w PTR         r     1 ERROR_STATUS$             15-0-0/w PTR         r     1 FORM_FILE$
    17-0-0/w PTR         r     1 FORM_STATUS$               4-0-0/w STRC(240)   r     1 FPT@DEVICE
    19-0-0/w PTR         r     1 INSTR$                    22-0-0/w STRC(224)   r     1 QCU@USE
    1B-0-0/w STRC(112)   r     1 QCW@WRITE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 QGB_PARAM                  0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(240)   r     1 QI_FPT_DEVICE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(48)    r     1 QI$DAD                     0-0-0/c STRC(64)    r     1 QI$ERROR_STATUS
     0-0-0/w STRC(192)   r     1 QI$FORM_FILE               0-0-0/w STRC(144)   r     1 QI$FORM_STATUS
     0-0-0/w STRC(208)   r     1 QI$FRAME_STATUS            0-0-0/w STRC(48)    r     1 QI$MAJOR_STATUS
     0-0-0/w STRC(64)    r     1 QI$OP_WRITE_FORM
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER


   Procedure QBW$WRITE_FORM requires 318 words for executable code.
   Procedure QBW$WRITE_FORM requires 52 words of local(AUTO) storage.
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:30   

    No errors detected in file QBW$WRITE_FORM.:E05TSI    .
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:31   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:32   
          MINI XREF LISTING

CHECK_USE_PROCEDURE_OR_INVALID
     19572**LABEL   19491--GOTO    19502--GOTO
ERROR_STATUS$
     19162**DCL     19542<<ASSIGN  19562>>ASSIGN
FORM_FILE$
     19163**DCL     19384<<ASSIGN  19387>>DOWHILE 19389>>ASSIGN  19417>>ASSIGN  19436<<ASSIGN
FORM_STATUS$
     19164**DCL     19417<<ASSIGN  19436>>ASSIGN
FPT@DEVICE
       257**DCL     19380<<ASSIGN  19391<>CALL
FPT@DEVICE.V
       261**DCL     19381--ASSIGN
FPT@DEVICE.V.DCB#
       261**DCL     19389<<ASSIGN
FPT@DEVICE.V.PAGE
       261**DCL     19382<<ASSIGN
FPT@DEVICE.V_
       259**DCL     19381<<ASSIGN
INSTR$
     19165**DCL     19369<<ASSIGN  19370>>ASSIGN  19375>>IF      19465>>ASSIGN
QCE$ERROR_INTERNAL
     19167**DCL-ENT 19591--CALL
QCE$ERROR_M$INTERNAL
     19168**DCL-ENT 19394--CALL
QCF$FIND_CURRENTS
     19169**DCL-ENT 19485--CALL
QCU$USE_INVALID_IO
     19171**DCL-ENT 19577--CALL
QCU@USE
     19321**DCL     19577<>CALL
QCU@USE.CURR_FRAME$
     19322**DCL     19575<<ASSIGN
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:33   
QCU@USE.CURR_NODE$
     19324**DCL     19574<<ASSIGN
QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS
     19329**DCL     19573<<ASSIGN
QCU@USE.STATUS
     19355**DCL     19579>>DOCASE
QCU@USE.USE_DEFAULT_IO
     19326**DCL     19572<<ASSIGN
QCW$WRITE
     19170**DCL-ENT 19511--CALL
QCW@WRITE
     19225**DCL     19511<>CALL
QCW@WRITE.FIELD_START_INDEX
     19233**DCL     19508<<ASSIGN
QCW@WRITE.FIELD_STOP_INDEX
     19235**DCL     19509<<ASSIGN
QCW@WRITE.FRAME_START_INDEX
     19226**DCL     19505<<ASSIGN
QCW@WRITE.FRAME_STOP_INDEX
     19228**DCL     19506<<ASSIGN
QCW@WRITE.IS_FIELD_INDEXES_VALID
     19230**DCL     19507<<ASSIGN
QCW@WRITE.STATUS
     19237**DCL     19514>>IF
QGB$DEVICE
       415**DCL-ENT 19391--CALL
QGB_PARAM
     11532**DCL     19391<>CALL
QGB_PARAM.DVE.DVBYTE.VFC
     11600**DCL     11601--REDEF
QGB_PARAM.DVE.EOMCHAR
     11612**DCL     11613--REDEF
QGB_PARAM.MSG$
     11594**DCL     11595--REDEF
QGB_PARAM.UHDR$
     11619**DCL     11620--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:34   
QI$ACTIVATION_STATUS
      9358**DCL      9364--REDEF
QI$CIP
      8199**DCL      8269--REDEF
QI$CIP.CA
      8204**DCL      8208--REDEF    8211--REDEF    8214--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      8443**DCL      8468--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      8445**DCL      8450--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      8451**DCL      8454--REDEF    8457--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      8479**DCL      8495--REDEF    8503--REDEF    8511--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8480**DCL      8490--REDEF    8493--REDEF
QI$COBOL_DAD.WORD0
      8407**DCL      8408--REDEF    8422--REDEF
QI$COBOL_DAD_P_BITS.P
      8547**DCL      8553--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      8033**DCL      8034--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      8029**DCL      8032--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      8066**DCL      8067--REDEF    8068--REDEF
QI$DAD.PSEUDO_CIP
      8346**DCL      8371--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      8348**DCL      8353--REDEF
QI$DAD.PSEUDO_CIP.DATA@
      8370**DCL     19468>>ASSIGN
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      8354**DCL      8357--REDEF    8360--REDEF
QI$DAD.WORD0
      8315**DCL      8316--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:35   
QI$DAD.WORD0_FLAGS.INDIRECT
      8317**DCL     19467>>DOWHILE
QI$DAD.WORD0_FLAGS.IS_CONSTANT
      8322**DCL     19468>>ASSIGN
QI$ERROR_MESSAGE_LINE
     11707**DCL     11709--REDEF
QI$ERROR_STATUS
     11704**DCL     11706--REDEF
QI$ERROR_STATUS.TEXT
     11705**DCL     19562<<ASSIGN
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      8761**DCL      8768--REDEF
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      8781**DCL      8788--REDEF
QI$FIELD_DAD.PSEUDO_CIP
      8688**DCL      8713--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      8690**DCL      8695--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      8696**DCL      8699--REDEF    8702--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      8801**DCL      8808--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      8744**DCL      8760--REDEF    8778--REDEF    8796--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8745**DCL      8755--REDEF    8758--REDEF
QI$FIELD_DAD.WORD0
      8640**DCL      8641--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      8644**DCL      8649--REDEF
QI$FIELD_DAD_P.P
      8842**DCL      8849--REDEF
QI$FIELD_STATUS.INDICATORS
      9508**DCL      9540--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
      9512**DCL      9517--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:36   
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
      9524**DCL      9531--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
      9518**DCL      9523--REDEF
QI$FILE.WORD0
      8964**DCL      8965--REDEF
QI$FILE_STATUS.INDICATORS
      9801**DCL      9833--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
      9805**DCL      9810--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
      9817**DCL      9824--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
      9811**DCL      9816--REDEF
QI$FORM_FILE.DCB#
      9062**DCL     19389>>ASSIGN
QI$FORM_FILE.ERROR_STATUS@D
      9048**DCL     19542>>ASSIGN
QI$FORM_FILE.STATUS_AREA@D
      9056**DCL     19417>>ASSIGN
QI$FORM_FILE.USE_PROCEDURE
      9064**DCL      9071--REDEF
QI$FORM_FILE.WORD0
      9018**DCL      9019--REDEF
QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      9023**DCL     19518>>IF
QI$FORM_STATUS.FLINK$
      9893**DCL     19436>>ASSIGN
QI$FORM_STATUS.INDICATORS
      9922**DCL      9954--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
      9926**DCL      9931--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
      9938**DCL      9945--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
      9942**DCL     19497>>IF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:37   
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_OUTPUT
      9939**DCL     19494>>IF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
      9932**DCL      9937--REDEF
QI$FRAME.WORD0
      9179**DCL      9180--REDEF
QI$FRAME_STATUS.INDICATORS
     10151**DCL     10183--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     10155**DCL     10160--REDEF
QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     10153**DCL     19487>>IF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     10167**DCL     10174--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     10161**DCL     10166--REDEF
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     17033**DCL     17038--REDEF
QI$IDENTIFIER
     11710**DCL     11712--REDEF
QI$INDICATORS
      9422**DCL      9452--REDEF
QI$INDICATORS.ENABLED_FLAGS
      9428**DCL      9433--REDEF
QI$INDICATORS.OPEN_FLAGS
      9440**DCL      9447--REDEF
QI$INDICATORS.STATE_FLAGS
      9434**DCL      9439--REDEF
QI$MAJOR_NODE.WORD0
      8878**DCL      8879--REDEF
QI$MAJOR_STATUS.GZ.FIELD_START_INDEX
      9577**DCL     19508>>ASSIGN
QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX
      9579**DCL     19509>>ASSIGN
QI$MAJOR_STATUS.INDICATORS
      9601**DCL      9633--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:38   
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
      9605**DCL      9610--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
      9617**DCL      9624--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
      9611**DCL      9616--REDEF
QI$MESSAGE_TYPE
     11701**DCL     11703--REDEF
QI$MINOR_NODE.WORD0
      8921**DCL      8922--REDEF
QI$MINOR_STATUS.INDICATORS
      9694**DCL      9726--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
      9698**DCL      9703--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
      9710**DCL      9717--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
      9704**DCL      9709--REDEF
QI$OP_ACCEPT.DATANAME@P
      6109**DCL      6110--REDEF
QI$OP_CALL.EPTR$
      6281**DCL      6282--REDEF
QI$OP_CLEAR.IO_FLAGS
      6314**DCL      6317--REDEF
QI$OP_DISPLAY.FIELD_A@P
      6581**DCL      6582--REDEF
QI$OP_ENABLE.IO_FLAGS
      6668**DCL      6671--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      6761**DCL      6766--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      6995**DCL      6996--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      6997**DCL      6998--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      6993**DCL      6994--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:39   
QI$OP_OPEN.IO_FLAGS
      7555**DCL      7558--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      7593**DCL      7594--REDEF
QI$OP_WRITE_FORM.FORM_RECORD@P
      7921**DCL     19465>>ASSIGN
QI$OP_WRITE_FORM.IS_WRITE_PAGE
      7919**DCL     19375>>IF
QI$OP_WRITE_FORM.NEXT_CODE@P
      7922**DCL     19370--ASSIGN
QI$PSEUDO_CIP
      8094**DCL      8118--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      8098**DCL      8103--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      8104**DCL      8107--REDEF    8110--REDEF
QI$TERMINAL_ATTRIBUTES
      9315**DCL      9328--REDEF
QI$TRAN_FILE.WORD0
      9100**DCL      9101--REDEF
QI$TRAN_STATUS.INDICATORS
     10035**DCL     10067--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     10039**DCL     10044--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     10051**DCL     10058--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     10045**DCL     10050--REDEF
QI$VARIABLE_IDENTIFIER.LENGTH
     11714**DCL     11715--IMP-SIZ
QI_1.A_REG
     10988**DCL     19373<<ASSIGN
QI_1.BASE
     10243**DCL     10250--REDEF
QI_1.BASE.DATA$
     10244**DCL     19417>>ASSIGN  19542>>ASSIGN
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:40   
QI_1.BASE.PROC$
     10246**DCL     19465>>ASSIGN
QI_1.BASE_A$
     10250**DCL     19468>>ASSIGN
QI_1.CURRENT.FILE$
     11134**DCL     11136--REDEF   11138--REDEF
QI_1.CURRENT.FILE_STATUS$
     11140**DCL     11142--REDEF   11144--REDEF
QI_1.CURRENT.FORM$
     11136**DCL     19518>>IF      19542>>ASSIGN  19574>>ASSIGN
QI_1.CURRENT.FORM_STATUS$
     11142**DCL     19494>>IF      19497>>IF
QI_1.CURRENT.FRAME_INDEX
     11150**DCL     19505>>ASSIGN  19506>>ASSIGN
QI_1.CURRENT.FRAME_STATUS$
     11148**DCL     19487>>IF
QI_1.CURRENT.NODE$
     11153**DCL     19465<<ASSIGN  19467>>DOWHILE 19468<<ASSIGN  19468>>ASSIGN  19468>>ASSIGN
QI_1.CURRENT.NODE_STATUS$
     11155**DCL     19508>>ASSIGN  19509>>ASSIGN
QI_1.DAD
     10938**DCL     10943--REDEF
QI_1.ERROR_STATUS
     11168**DCL     19490<<ASSIGN  19499<<ASSIGN  19501<<ASSIGN
QI_1.FILE_HEAD
     11121**DCL     11128--REDEF
QI_1.FILE_HEAD.FORM$
     11122**DCL     19384>>ASSIGN
QI_1.INSTR$
     10251**DCL     19369>>ASSIGN  19370<<ASSIGN
QI_1.IS_ALL_LIT
     10944**DCL     10949--REDEF
QI_1.IS_FORM_VARIABLE
     10950**DCL     10955--REDEF
QI_1.IS_TEMP
     10956**DCL     10961--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:41   
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     11054**DCL     11079--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     11056**DCL     11061--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     11062**DCL     11065--REDEF   11068--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     11023**DCL     11024--REDEF
QI_1.OFFSET
     10962**DCL     10967--REDEF
QI_1.OP.CIP
     10323**DCL     10774--REDEF
QI_1.OP.CIP.AUX
     10689**DCL     10760--REDEF
QI_1.OP.CIP.AUX.CD
     10734**DCL     10737--REDEF   10741--REDEF   10744--REDEF
QI_1.OP.CIP.S
     10393**DCL     10464--REDEF
QI_1.OP.CIP.S.CD
     10438**DCL     10441--REDEF   10445--REDEF   10448--REDEF
QI_1.OP.CIP.T
     10541**DCL     10612--REDEF
QI_1.OP.CIP.T.CD
     10586**DCL     10589--REDEF   10593--REDEF   10596--REDEF
QI_1.OP.DATA
     10781**DCL     10785--REDEF
QI_1.OP.FILL_CHAR
     10905**DCL     10908--REDEF
QI_1.OP.INX
     10838**DCL     10842--REDEF   10843--REDEF   10847--REDEF
QI_1.OP.LEN
     10821**DCL     10825--REDEF   10826--REDEF   10830--REDEF   10831--REDEF   10835--REDEF
QI_1.OP.LEN.AUX
     10824**DCL     11725--IMP-SIZ
QI_1.OP.LEN.S
     10822**DCL     11721--IMP-SIZ
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:42   
QI_1.OP.LEN.T
     10823**DCL     11723--IMP-SIZ
QI_1.OP.PICTURE_STRING
     10891**DCL     10894--REDEF   10895--REDEF   10898--REDEF   10899--REDEF   10902--REDEF
QI_1.OP.ROUND
     10924**DCL     10925--REDEF   10926--REDEF
QI_1.OP.SRCH_VRFY_ELEMS
     10860**DCL     10863--REDEF
QI_1.OPENED_COUNT
     11129**DCL     11132--REDEF
QI_1.OTTER_SPACE
     10968**DCL     10973--REDEF
QI_1.PICTURE_STRING
     10974**DCL     10979--REDEF
QI_1.SPECIAL_NAMES
     11157**DCL     11166--REDEF
QI_1.TYPE
     10980**DCL     10985--REDEF
QI_16_BIT_BINARY
     16170**DCL     16240--REDEF
QI_16_BIT_BINARY.CB
     16189**DCL     16192--REDEF   16196--REDEF   16199--REDEF
QI_31_DIGIT_SLS_DISPLAY
     16003**DCL     16073--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     16050**DCL     16053--REDEF   16057--REDEF   16060--REDEF
QI_31_DIGIT_ST_PACKED
     16505**DCL     16575--REDEF
QI_31_DIGIT_ST_PACKED.CP
     16538**DCL     16541--REDEF   16545--REDEF   16548--REDEF
QI_32_BIT_BINARY
     16337**DCL     16407--REDEF
QI_32_BIT_BINARY.CB
     16356**DCL     16359--REDEF   16363--REDEF   16366--REDEF
QI_4_CHAR_ALPHANUMERIC
     15835**DCL     15905--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:43   
QI_4_CHAR_ALPHANUMERIC.CA
     15840**DCL     15844--REDEF   15847--REDEF   15850--REDEF
QI_ACCUMULATOR_DAD.CIP
     16848**DCL     16919--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     16879**DCL     16882--REDEF   16886--REDEF   16889--REDEF
QI_ALR.CIP
     11800**DCL     12251--REDEF
QI_ALR.CIP.AUX
     12166**DCL     12237--REDEF
QI_ALR.CIP.AUX.CA
     12169**DCL     12173--REDEF   12176--REDEF   12179--REDEF
QI_ALR.CIP.S
     11870**DCL     11941--REDEF
QI_ALR.CIP.S.CA
     11873**DCL     11877--REDEF   11880--REDEF   11883--REDEF
QI_ALR.CIP.T
     12018**DCL     12089--REDEF
QI_ALR.CIP.T.CA
     12021**DCL     12025--REDEF   12028--REDEF   12031--REDEF
QI_ALR.DATA
     12258**DCL     12262--REDEF
QI_ALR.FILL_CHAR
     12382**DCL     12385--REDEF
QI_ALR.INX
     12315**DCL     12319--REDEF   12320--REDEF   12324--REDEF
QI_ALR.LEN
     12298**DCL     12302--REDEF   12303--REDEF   12307--REDEF   12308--REDEF   12312--REDEF
QI_ALR.PICTURE_STRING
     12368**DCL     12371--REDEF   12372--REDEF   12375--REDEF   12376--REDEF   12379--REDEF
QI_ALR.ROUND
     12401**DCL     12402--REDEF   12403--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     12337**DCL     12340--REDEF
QI_FPT_DBCONTROL.V_
     17220**DCL     17220--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:44   
QI_FPT_DEVICE
     17393**DCL     19380>>ASSIGN
QI_FPT_INT.V_
     18058**DCL     18058--REDEF
QI_MAT.CIP
     15139**DCL     15590--REDEF
QI_MAT.CIP.AUX
     15505**DCL     15576--REDEF
QI_MAT.CIP.AUX.CA
     15508**DCL     15512--REDEF   15515--REDEF   15518--REDEF
QI_MAT.CIP.S
     15209**DCL     15280--REDEF
QI_MAT.CIP.S.CA
     15212**DCL     15216--REDEF   15219--REDEF   15222--REDEF
QI_MAT.CIP.T
     15357**DCL     15428--REDEF
QI_MAT.CIP.T.CA
     15360**DCL     15364--REDEF   15367--REDEF   15370--REDEF
QI_MAT.DATA
     15597**DCL     15601--REDEF
QI_MAT.DEC
     15665**DCL     15669--REDEF   15670--REDEF   15674--REDEF
QI_MAT.FILL_CHAR
     15721**DCL     15724--REDEF
QI_MAT.LEN
     15637**DCL     15641--REDEF   15642--REDEF   15646--REDEF   15647--REDEF   15651--REDEF
QI_MAT.PICTURE_STRING
     15707**DCL     15710--REDEF   15711--REDEF   15714--REDEF   15715--REDEF   15718--REDEF
QI_MAT.ROUND
     15740**DCL     15741--REDEF   15742--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     15676**DCL     15679--REDEF
QI_PICTURE_STRING
     16673**DCL     16743--REDEF
QI_PICTURE_STRING.CA
     16678**DCL     16682--REDEF   16685--REDEF   16688--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:45   
QI_SRCH_VRFY.CIP
     14470**DCL     14921--REDEF
QI_SRCH_VRFY.CIP.AUX
     14836**DCL     14907--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     14839**DCL     14843--REDEF   14846--REDEF   14849--REDEF
QI_SRCH_VRFY.CIP.S
     14540**DCL     14611--REDEF
QI_SRCH_VRFY.CIP.S.CA
     14543**DCL     14547--REDEF   14550--REDEF   14553--REDEF
QI_SRCH_VRFY.CIP.T
     14688**DCL     14759--REDEF
QI_SRCH_VRFY.CIP.T.CA
     14691**DCL     14695--REDEF   14698--REDEF   14701--REDEF
QI_SRCH_VRFY.DATA
     14928**DCL     14932--REDEF
QI_SRCH_VRFY.DEC
     14996**DCL     15000--REDEF   15001--REDEF   15005--REDEF
QI_SRCH_VRFY.FILL_CHAR
     15052**DCL     15055--REDEF
QI_SRCH_VRFY.ROUND
     15071**DCL     15072--REDEF   15073--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     15012**DCL     15015--REDEF   15016--REDEF   15019--REDEF   15020--REDEF   15023--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     14936**DCL     14940--REDEF   14941--REDEF   14945--REDEF   14946--REDEF   14950--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     15007**DCL     15010--REDEF
QI_TYPE_BINARY_TARGET.CIP
     13797**DCL     14248--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     14163**DCL     14234--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     14166**DCL     14170--REDEF   14173--REDEF   14176--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     13867**DCL     13938--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:46   
QI_TYPE_BINARY_TARGET.CIP.S.CA
     13870**DCL     13874--REDEF   13877--REDEF   13880--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     14015**DCL     14086--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     14032**DCL     14035--REDEF   14039--REDEF   14042--REDEF
QI_TYPE_BINARY_TARGET.DATA
     14255**DCL     14259--REDEF
QI_TYPE_BINARY_TARGET.DEC
     14323**DCL     14327--REDEF   14328--REDEF   14332--REDEF
QI_TYPE_BINARY_TARGET.LEN
     14295**DCL     14299--REDEF   14300--REDEF   14304--REDEF   14305--REDEF   14309--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     14365**DCL     14368--REDEF   14369--REDEF   14372--REDEF   14373--REDEF   14376--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     14398**DCL     14399--REDEF   14400--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     14384**DCL     14385--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     14334**DCL     14337--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     12465**DCL     12916--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     12831**DCL     12902--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     12834**DCL     12838--REDEF   12841--REDEF   12844--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     12535**DCL     12606--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     12580**DCL     12583--REDEF   12587--REDEF   12590--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     12683**DCL     12754--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     12686**DCL     12690--REDEF   12693--REDEF   12696--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     12923**DCL     12927--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:47   
QI_TYPE_DISPLAY_SOURCE.DEC
     12991**DCL     12995--REDEF   12996--REDEF   13000--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     12963**DCL     12967--REDEF   12968--REDEF   12972--REDEF   12973--REDEF   12977--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     13033**DCL     13036--REDEF   13037--REDEF   13040--REDEF   13041--REDEF   13044--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     13066**DCL     13067--REDEF   13068--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     13052**DCL     13053--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     13002**DCL     13005--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     13131**DCL     13582--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     13497**DCL     13568--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     13500**DCL     13504--REDEF   13507--REDEF   13510--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     13201**DCL     13272--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     13204**DCL     13208--REDEF   13211--REDEF   13214--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     13349**DCL     13420--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     13394**DCL     13397--REDEF   13401--REDEF   13404--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     13589**DCL     13593--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     13657**DCL     13661--REDEF   13662--REDEF   13666--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     13629**DCL     13633--REDEF   13634--REDEF   13638--REDEF   13639--REDEF   13643--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     13699**DCL     13702--REDEF   13703--REDEF   13706--REDEF   13707--REDEF   13710--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     13732**DCL     13733--REDEF   13734--REDEF
PL6.E3A0      #001=QBW$WRITE_FORM File=QBW$WRITE_FORM.:E05TSI                    WED 07/30/97 04:58 Page:48   
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     13718**DCL     13719--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     13668**DCL     13671--REDEF
QI_VLP_SEGMENT.BASE
     17757**DCL     17757--REDEF
QI_VLP_SEGMENT_BUFFER.BASE
     17855**DCL     17855--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     17953**DCL     17953--REDEF
QI_VLP_TRMCTL.BREAKCOUNT
     18947**DCL     18948--REDEF
QI_VLP_XBREAK.IC
     19137**DCL     19137--REDEF
QI_VLP_XBREAK.OLDIC
     19137**DCL     19138--REDEF   19138--REDEF
RETRY_WHATEVER_WRITE
     19373**LABEL   19585--GOTO
