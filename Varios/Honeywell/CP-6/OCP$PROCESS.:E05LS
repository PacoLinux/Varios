VERSION E05

PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:1    
        1        1        /*M* OCP$PROCESS  process asynchronous events */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        /*P* NAME: OCP$PROCESS
        9        9            PURPOSE: To process asynchronous events received by KEYIN.
       10       10                                                                        */
       11       11        /*
       12       12         ###    ###   ####    #   ####   ####    ###    ###   #####   ###    ###
       13       13        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #  #      #   #  #   #
       14       14        #   #  #      #   # # #   #   #  #   #  #   #  #      #      #      #
       15       15        #   #  #      ####   ###  ####   ####   #   #  #      ####    ###    ###
       16       16        #   #  #      #       # # #      # #    #   #  #      #          #      #
       17       17        #   #  #   #  #      ###  #      #  #   #   #  #   #  #      #   #  #   #
       18       18         ###    ###   #       #   #      #   #   ###    ###   #####   ###    ###
       19       19                                                                   */
       20       20        %EJECT;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:2    
       21       21        /*M* OCP$DOLIST KEYINs timed-activities routine */
       22       22        %SET LISTSUB='1'B;
       23       23        /*
       24       24         ###    ###   ####    #   ####    ###   #       ###    ###   #####
       25       25        #   #  #   #  #   #  ###  #   #  #   #  #        #    #   #    #
       26       26        #   #  #      #   # # #   #   #  #   #  #        #    #        #
       27       27        #   #  #      ####   ###  #   #  #   #  #        #     ###     #
       28       28        #   #  #      #       # # #   #  #   #  #        #        #    #
       29       29        #   #  #   #  #      ###  #   #  #   #  #        #    #   #    #
       30       30         ###    ###   #       #   ####    ###   #####   ###    ###     #
       31       31                                                                   */
       32       32                                                /**/
       33       33                                                /**/
       34       34        OCP$DOLIST: PROC;
       35       35                                                /**/
       36       36                                                /**/
       37       37    1   DCL OCW$WRITE ENTRY(5);
       38       38    1   DCL OCO$IWRITE ENTRY(8);
       39       39    1   DCL OCL$RLS ENTRY(2);
       40       40                                                /**/
       41       41                                                /**/
       42       42        %INCLUDE OCP_DATA_R;
       43       59        %INCLUDE OC$PEND;
       44      104        %INCLUDE OCI_SUBS_C;
       45      202        %INCLUDE OC_SUBS_C;
       46      933        %INCLUDE CP_6;
       47     1014        %INCLUDE OC_DAT_R;
       48     1175        %INCLUDE EL_SUBS_C;
       49     1259        %INCLUDE XUD_UTS_M;
       50     1341
       51     1342        %XUD$UTS_ENTRIES;                       /* EXPAND ROUTINE DCLS */
       52     1374
       53     1375                                                /**/
       54     1376        %OC$MESSHD (DELIM=";");
       55     1390                                                /**/
       56     1391                                                /**/
       57     1392    1   DCL I SBIN WORD STATIC;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:3    
       58     1393    1   DCL J SBIN WORD STATIC;
       59     1394                                                /**/
       60     1395    1   DCL OC_TSTAMP UBIN WORD STATIC ALIGNED;
       61     1396    1   DCL OC_MINUTES SBIN WORD STATIC ALIGNED INIT(999);
       62     1397                                                /**/
       63     1398    1   DCL MESSAGE_NUMBER UBIN WORD STATIC ALIGNED;
       64     1399                                                /**/
       65     1400    1   DCL 1 TEMP_BUF STATIC,
       66     1401    1            2 MK_VECT UBIN BYTE UNAL INIT(0),
       67     1402    1            2 * UBIN BYTE UNAL INIT(3 /* KEY_ACCTLG# */),
       68     1403    1            2 CADDR BIT(18) UNAL INIT('200000'O /* M_SYS  */),
       69     1404    1            2 TEXTC,
       70     1405    1                 3 SIZE UBIN BYTE UNAL,
       71     1406    1                 3 TEXT CHAR(20) UNAL;
       72     1407                                                /**/
       73     1408    1   DCL M$CSCG DCB;
       74     1409                                                /**/
       75     1410             %VLP_STATION       (FPTN=STA,STATION='SLUG');
       76     1437                                                /**/
       77     1438             %FPT_WRITE     (FPTN=WR_SLUG,
       78     1439                                 DCB=M$CSCG,
       79     1440                                 STATION=STA,
       80     1441                                 BUF=TEMP_BUF,
       81     1442                                 BP=YES,
       82     1443                                 WAIT=YES);
       83     1474
       84     1475             %FPT_WRSYSLOG  (FPTN=WRITE_TIMESTAMP,
       85     1476                                 TYPE=%EL_TIMESTAMP);
       86     1491                                                /**/
       87     1492    1   DCL DATE_AREA CHAR(6) STATIC;
       88     1493    1   DCL TEMP UBIN WORD;
       89     1494    1   DCL TEMP$ PTR;
       90     1495    1   DCL TIME_AREA STATIC CHAR(8) UNAL;
       91     1496    1   DCL MSG# UBIN HALF;
       92     1497    1   DCL MESS# UBIN HALF STATIC;
       93     1498    1   DCL CADDR BIT(18) STATIC;
       94     1499    1   DCL FOUND BIT(1) ALIGNED;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:4    
       95     1500                                                /**/
       96     1501             %FPT_TIME      (FPTN=GET_TIME,
       97     1502                                 SOURCE=CLOCK,
       98     1503                                 DEST=ANS,
       99     1504                                 TSTAMP=OC_TSTAMP,
      100     1505                                 DATE=DATE_AREA,
      101     1506                                 TIME=TIME_AREA);
      102     1525                                                /**/
      103     1526        %EJECT;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:5    
      104     1527                                                /**/
      105     1528        /*
      106     1529                  Begin  O C P $ D O L I S T  main
      107     1530                                                                          */
      108     1531                                                /**/
      109     1532    1        CALL M$TIME(GET_TIME);
      110     1533                                                /**/
      111     1534    1        CALL XUD$UTS_DIFF_SEC (I, OC_TSTAMP, 0);
      112     1535    1        I = MOD (I/60, 60);                /* COMPUTE MINUTE OF HOUR */
      113     1536    1        IF I ~= OC_MINUTES
      114     1537    1        THEN
      115     1538    2        DO;                      /* WE HAVENT REPORTED IN THIS
      116     1539                                                MINUTE */
      117     1540    2             CALL CHARBIN(J,SUBSTR( TIME_AREA,0,2));
      118     1541    2             IF OC_HIST_SAVE.ACTIVE
      119     1542    2                  AND
      120     1543    2                  I = OC_HIST_SAVE.MIN
      121     1544    2                  AND
      122     1545    2                  J = OC_HIST_SAVE.HOUR
      123     1546    2             THEN
      124     1547    3             DO;
      125     1548    3                  IF SUBSTR(DATE_AREA,0,1) < '7' THEN
      126     1549    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':OCHIST20',DATE_AREA);
      127     1550    3                  ELSE
      128     1551    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':OCHIST19',DATE_AREA);
      129     1552    3                  TEMP_BUF.TEXTC.SIZE = 15;
      130     1553    3                  CALL OCL$RLS(TEMP_BUF.CADDR,TEMP_BUF.TEXTC);
      131     1554    3                END;
      132     1555    2             IF OC_ACCT_SAVE.ACTIVE
      133     1556    2                  AND
      134     1557    2                  I = OC_ACCT_SAVE.MIN
      135     1558    2                  AND
      136     1559    2                  J = OC_ACCT_SAVE.HOUR
      137     1560    2             THEN
      138     1561    3             DO;
      139     1562    3                  IF SUBSTR(DATE_AREA,0,1) < '7' THEN
      140     1563    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':ACCTLG20',DATE_AREA);
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:6    
      141     1564    3                  ELSE
      142     1565    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':ACCTLG19',DATE_AREA);
      143     1566    3                  TEMP_BUF.TEXTC.SIZE = 15;
      144     1567    3                  WR_SLUG.BUF_.BOUND = 20;
      145     1568    3                  CALL M$WRITE(WR_SLUG) ALTRET(WHOOPS);
      146     1569    3   WHOOPS:        ;
      147     1570    3                END;
      148     1571    2             OC_MINUTES = I;
      149     1572    2             IF SUBSTR(TIME_AREA,2,2) = '00'
      150     1573    2             THEN
      151     1574    3             DO;
      152     1575    3                  MSG# = 390 /* HOUR_MSG# */;
      153     1576    3                  CALL M$WRSYSLOG (WRITE_TIMESTAMP)
      154     1577    3                  WHENALTRETURN
      155     1578    4                  DO;
      156     1579    4                     END;
      157     1580    3                END;
      158     1581    2             ELSE
      159     1582    2                  MSG# = 391 /* TIME_MSG# */;
      160     1583                                                /**/
      161     1584                                                /**/
      162     1585    3             DO I = 0 TO 255;              /* scan dolist */
      163     1586    3                  IF (OCP_MSGBUF_LIST.LINK(I) ~= 511)
      164     1587    3                  THEN
      165     1588    4                  DO;
      166     1589    4                       J = 0;
      167     1590    4                       TEMP = OCP_MSGBUF_LIST.LINK(I);
      168     1591    5                       DO WHILE (TEMP ~= 511);
      169     1592    5                            TEMP$ = PINCRW (OCP_MSGBUF$, TEMP * 8);
      170     1593    5                            CALL INSERT (OCP_TIMED_BUF, J, 31,
      171     1594    5                                 TEMP$ -> OCP$MSGBUF_UNIT.BUF);
      172     1595    5                            J = J + 31;
      173     1596    5                            TEMP = TEMP$ -> OCP$MSGBUF_UNIT.LINK;
      174     1597    5                          END;
      175     1598                                                /**/
      176     1599    5                       DO WHILE ((SUBSTR(OCP_TIMED_BUF,J-1,1) = ' ')
      177     1600    5                            AND
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:7    
      178     1601    5                            (J > 1));
      179     1602    5                            J = J - 1;
      180     1603    5                          END;             /* DO WHILE TRAILING BLANKS */
      181     1604                                                /**/
      182     1605    4                       CALL OCW$WRITE (OCP_TIMED_BUF, J,
      183     1606    4                            OCP_MSGBUF_LIST.CADDR(I),
      184     1607    4                            OCP_MSGBUF_LIST.WSN(I),
      185     1608    4                            ADDR(OCP_TIMED_BUF)->OC$MESSHD.MSG#);
      186     1609    4                     END;
      187     1610    3                END;
      188     1611                                                /**/
      189     1612                                                /**/
      190     1613                                           /* Check to see if there are any
      191     1614                                                pending reads we should tell
      192     1615                                                this operator about */
      193     1616    2             OC_NEXT_PEND = OC_NEXT_PEND + 1;
      194     1617    2             IF OC_NEXT_PEND >= OC_NEXT_PENDX
      195     1618    2             THEN
      196     1619    3             DO;
      197     1620    3                  OC_NEXT_PEND = 0;
      198     1621                                                /**/
      199     1622    4                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      200     1623    4                       IF OC_CONSOLE.ACTIVE(I)
      201     1624    4                       THEN
      202     1625    5                       DO;
      203     1626    5                            TEMP$ = OCP_USED_HEAD$;
      204     1627    6                            DO WHILE (~FOUND AND TEMP$ ~= ADDR(NIL));
      205     1628                                                /* If direct, check CID */
      206     1629    6                                 IF TEMP$ -> OC$PEND.CADDR & '400000'O
      207     1630    6                                 THEN
      208     1631    6                                      IF (OC_CONSOLE.CID(I)+BITBIN('400000'O)) =
      209     1632    6                                           BITBIN(TEMP$ -> OC$PEND.CADDR)
      210     1633    6                                      THEN
      211     1634    6                                           FOUND = '1'B /*TRUE#*/;
      212     1635    6                                      ELSE ;
      213     1636    6                                 ELSE      /* attribute? */
      214     1637    7                                 DO;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:8    
      215     1638    7                                      IF OC_CONSOLE.ATTR(I) & '200000'O /* M_SYS  */
      216     1639    7                                      THEN
      217     1640    7                                           GOTO PRINT_IT;
      218     1641                                                /**/
      219     1642    7                                      CADDR = TEMP$ -> OC$PEND.CADDR &
      220     1643    7                                           OC_CONSOLE.ATTR(I);
      221     1644                                                /**/
      222     1645    7                                      IF CADDR & '004000'O /* M_COMM */
      223     1646    7                                      THEN
      224     1647    7                                           GOTO PRINT_IT;
      225     1648    7                                      IF CADDR & '040000'O /* M_ADMIN */
      226     1649    7                                           AND
      227     1650    7                                           OC_CONSOLE.ATTR_INPUT(I) & '040000'O
              1650                                                    /* K_ADMIN */
      228     1651    7                                           AND
      229     1652    7                                           OC_CONSOLE.WSN(I) =
      230     1653    7                                           TEMP$ -> OC$PEND.WSN
      231     1654    7                                      THEN
      232     1655    7                                           GOTO PRINT_IT;
      233     1656                                                /**/
      234     1657    7                                      IF CADDR & '100000'O /* M_DEVC  */
      235     1658    7                                           AND
      236     1659    7                                           OC_CONSOLE.STATIONR.SECND_HALF(I)
      237     1660    7                                           = TEMP$ -> OC$PEND.DEV.TWSN
      238     1661    7                                      THEN
      239     1662    7                                           GOTO PRINT_IT;
      240     1663    7                                    END;   /* DO IF ATTR ADDRESSED */
      241     1664                                                /**/
      242     1665    6                                 TEMP$ = TEMP$ -> OC$PEND.LINK$;
      243     1666    6                               END;        /* DO WHILE */
      244     1667                                                /**/
      245     1668                                                /**/
      246     1669                                                /**/
      247     1670    6                            DO WHILE ('0'B /*FALSE#*/);
      248     1671                                                /**/
      249     1672    6   PRINT_IT:                     ;
      250     1673    6                                 MESS# = 392 /* PEND_MSG# */;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:9    
      251     1674    6                                 CALL OCO$IWRITE (
      252     1675    6                                      BINBIT (OC_CONSOLE.CID(I) +
      253     1676    6                                      BITBIN('400000'O),18),
      254     1677    6                                      MESS#, 0, 0, 0, 0, OCP_NON_STA, 0);
      255     1678    6                               END;        /* DO IF RIGHT CONSOLE */
      256     1679    5                          END;             /* DO IF CONSOLE IS ACTIVE */
      257     1680    4                     END;                  /* DO I = 0 TO MAX_CONS */
      258     1681    3                END;                       /* DO IF PEND REPORT TIME */
      259     1682                                                /**/
      260     1683                                                /**/
      261     1684                                                /**/
      262     1685                                           /* Now that the timed messages are
      263     1686                                                out of the way, check all
      264     1687                                                consoles for activity in order
      265     1688                                                to print the time on them */
      266     1689    3             DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      267     1690    3                  IF ~OC_CONSOLE.DONT_TIME(I)
      268     1691    3                  THEN
      269     1692    4                  DO;
      270     1693    4                       IF OC_CONSOLE.ACTIVE(I)
      271     1694    4                            AND
      272     1695    4                            OC_CONSOLE.TRANSAC_LAST_MIN(I)
      273     1696    4                       THEN
      274     1697    5                       DO;
      275     1698    5                            CALL OCO$IWRITE (
      276     1699    5                                 BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
      277     1700    5                                 MSG#, 0, 0, 0, 0, OCP_NON_STA,0);
      278     1701    5                            OC_CONSOLE.TRANSAC_LAST_MIN(I) = '0'B /*FALSE#*/;
      279     1702    5                          END;             /* DO IF activity */
      280     1703    4                       ELSE
      281     1704                                                /* No activity, but check if
      282     1705                                                     HOUR template */
      283     1706    4                            IF OC_CONSOLE.ACTIVE(I)
      284     1707    4                                 AND
      285     1708    4                                 MSG# = 390 /* HOUR_MSG# */
      286     1709    4                            THEN
      287     1710    5                            DO;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:10   
      288     1711    5                                 CALL OCO$IWRITE
      289     1712    5                                      (BINBIT(OC_CONSOLE.CID(I) +
      290     1713    5                                      BITBIN('400000'O), 18),
      291     1714    5                                      MSG#, 0, 0, 0, 0, OCP_NON_STA, 0);
      292     1715    5                                 OC_CONSOLE.TRANSAC_LAST_MIN(I) = '0'B /*FALSE#*/;
      293     1716    5                               END;        /* DO IF HOUR */
      294     1717    4                     END;                  /* DO I = 0 TO MAX_CONS */
      295     1718    3                END;                       /* DO IF TIME WANTED */
      296     1719    2           END;                            /* DO IF THIS IS THE MINUTE */
      297     1720                                                /**/
      298     1721                                                /**/
      299     1722                                                /**/
      300     1723    1   WHAT_AGAIN: ;
      301     1724                                                /**/
      302     1725    1        RETURN;
      303     1726    1   END OCP$DOLIST;
      304     1727        %EOD;

PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:11   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$DOLIST.

   Procedure OCP$DOLIST requires 367 words for executable code.
   Procedure OCP$DOLIST requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:12   

 Object Unit name= OCP$DOLIST                                 File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:03:35.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    58     72  OCP$DOLIST
    2   DCB   even  none     0      0  M$CSCG
    3  RoData even  UTS     13     15  OCP$DOLIST
    4   Proc  even  none   367    557  OCP$DOLIST
    5  RoData even  none    16     20  OCP$DOLIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  OCP$DOLIST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
         yes           Std       2 OCL$RLS
         yes           Std       5 OCW$WRITE
         yes           Std       8 OCO$IWRITE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     OCP_FREE_HEAD                         OCP_USED_HEAD                         OCP_USED_TAIL
r    OCP_MSGBUF$                           OCP_MSGBUF_LIST                       OCP_TIMED_BUF
     OCP_NON_STA                           M$UC                                  OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_NEXT_PEND
     OC_NEXT_PENDX                         OC_PARAM                              OC_CONSOLE$
     OC_MAXCONSOLE                         OC_DIR                                OC_INTBIT
     OC_MASK                               OC_HIST_SAVE                          OC_ACCT_SAVE
     M$CSCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:14   


        1        1        /*M* OCP$PROCESS  process asynchronous events */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        /*P* NAME: OCP$PROCESS
        9        9            PURPOSE: To process asynchronous events received by KEYIN.
       10       10                                                                        */
       11       11        /*
       12       12         ###    ###   ####    #   ####   ####    ###    ###   #####   ###    ###
       13       13        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #  #      #   #  #   #
       14       14        #   #  #      #   # # #   #   #  #   #  #   #  #      #      #      #
       15       15        #   #  #      ####   ###  ####   ####   #   #  #      ####    ###    ###
       16       16        #   #  #      #       # # #      # #    #   #  #      #          #      #
       17       17        #   #  #   #  #      ###  #      #  #   #   #  #   #  #      #   #  #   #
       18       18         ###    ###   #       #   #      #   #   ###    ###   #####   ###    ###
       19       19                                                                   */
       20       20        %EJECT;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:15   
       21       21        /*M* OCP$DOLIST KEYINs timed-activities routine */
       22       22        %SET LISTSUB='1'B;
       23       23        /*
       24       24         ###    ###   ####    #   ####    ###   #       ###    ###   #####
       25       25        #   #  #   #  #   #  ###  #   #  #   #  #        #    #   #    #
       26       26        #   #  #      #   # # #   #   #  #   #  #        #    #        #
       27       27        #   #  #      ####   ###  #   #  #   #  #        #     ###     #
       28       28        #   #  #      #       # # #   #  #   #  #        #        #    #
       29       29        #   #  #   #  #      ###  #   #  #   #  #        #    #   #    #
       30       30         ###    ###   #       #   ####    ###   #####   ###    ###     #
       31       31                                                                   */
       32       32                                                /**/
       33       33                                                /**/
       34       34        OCP$DOLIST: PROC;

     34  4 000000   000000 700200 xent  OCP$DOLIST   TSX0  ! X66_AUTO_0
         4 000001   000022 000000                    ZERO    18,0

       35       35                                                /**/
       36       36                                                /**/
       37       37    1   DCL OCW$WRITE ENTRY(5);
       38       38    1   DCL OCO$IWRITE ENTRY(8);
       39       39    1   DCL OCL$RLS ENTRY(2);
       40       40                                                /**/
       41       41                                                /**/
       42       42        %INCLUDE OCP_DATA_R;
       43       59        %INCLUDE OC$PEND;
       44      104        %INCLUDE OCI_SUBS_C;
       45      202        %INCLUDE OC_SUBS_C;
       46      933        %INCLUDE CP_6;
       47     1014        %INCLUDE OC_DAT_R;
       48     1175        %INCLUDE EL_SUBS_C;
       49     1259        %INCLUDE XUD_UTS_M;
       50     1341
       51     1342        %XUD$UTS_ENTRIES;                       /* EXPAND ROUTINE DCLS */
       52     1374
       53     1375                                                /**/
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:16   
       54     1376        %OC$MESSHD (DELIM=";");
       55     1390                                                /**/
       56     1391                                                /**/
       57     1392    1   DCL I SBIN WORD STATIC;
       58     1393    1   DCL J SBIN WORD STATIC;
       59     1394                                                /**/
       60     1395    1   DCL OC_TSTAMP UBIN WORD STATIC ALIGNED;
       61     1396    1   DCL OC_MINUTES SBIN WORD STATIC ALIGNED INIT(999);
       62     1397                                                /**/
       63     1398    1   DCL MESSAGE_NUMBER UBIN WORD STATIC ALIGNED;
       64     1399                                                /**/
       65     1400    1   DCL 1 TEMP_BUF STATIC,
       66     1401    1            2 MK_VECT UBIN BYTE UNAL INIT(0),
       67     1402    1            2 * UBIN BYTE UNAL INIT(3 /* KEY_ACCTLG# */),
       68     1403    1            2 CADDR BIT(18) UNAL INIT('200000'O /* M_SYS  */),
       69     1404    1            2 TEXTC,
       70     1405    1                 3 SIZE UBIN BYTE UNAL,
       71     1406    1                 3 TEXT CHAR(20) UNAL;
       72     1407                                                /**/
       73     1408    1   DCL M$CSCG DCB;
       74     1409                                                /**/
       75     1410             %VLP_STATION       (FPTN=STA,STATION='SLUG');
       76     1437                                                /**/
       77     1438             %FPT_WRITE     (FPTN=WR_SLUG,
       78     1439                                 DCB=M$CSCG,
       79     1440                                 STATION=STA,
       80     1441                                 BUF=TEMP_BUF,
       81     1442                                 BP=YES,
       82     1443                                 WAIT=YES);
       83     1474
       84     1475             %FPT_WRSYSLOG  (FPTN=WRITE_TIMESTAMP,
       85     1476                                 TYPE=%EL_TIMESTAMP);
       86     1491                                                /**/
       87     1492    1   DCL DATE_AREA CHAR(6) STATIC;
       88     1493    1   DCL TEMP UBIN WORD;
       89     1494    1   DCL TEMP$ PTR;
       90     1495    1   DCL TIME_AREA STATIC CHAR(8) UNAL;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:17   
       91     1496    1   DCL MSG# UBIN HALF;
       92     1497    1   DCL MESS# UBIN HALF STATIC;
       93     1498    1   DCL CADDR BIT(18) STATIC;
       94     1499    1   DCL FOUND BIT(1) ALIGNED;
       95     1500                                                /**/
       96     1501             %FPT_TIME      (FPTN=GET_TIME,
       97     1502                                 SOURCE=CLOCK,
       98     1503                                 DEST=ANS,
       99     1504                                 TSTAMP=OC_TSTAMP,
      100     1505                                 DATE=DATE_AREA,
      101     1506                                 TIME=TIME_AREA);
      102     1525                                                /**/
      103     1526        %EJECT;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:18   
      104     1527                                                /**/
      105     1528        /*
      106     1529                  Begin  O C P $ D O L I S T  main
      107     1530                                                                          */
      108     1531                                                /**/
      109     1532    1        CALL M$TIME(GET_TIME);

   1532  4 000002   000056 630400 1                  EPPR0   GET_TIME
         4 000003   020004 713400                    CLIMB   8196
         4 000004   402000 401760                    pmme    nvectors=5

      110     1533                                                /**/
      111     1534    1        CALL XUD$UTS_DIFF_SEC (I, OC_TSTAMP, 0);

   1534  4 000005   000000 630400 5                  EPPR0   0
         4 000006   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000007   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         4 000010   000000 011000                    NOP     0

      112     1535    1        I = MOD (I/60, 60);                /* COMPUTE MINUTE OF HOUR */

   1535  4 000011   000000 236000 1                  LDQ     I
         4 000012   000074 506007                    DIV     60,DL
         4 000013   000074 506007                    DIV     60,DL
         4 000014   000000 755000 1                  STA     I

      113     1536    1        IF I ~= OC_MINUTES

   1536  4 000015   000000 236000 1                  LDQ     I
         4 000016   000003 116000 1                  CMPQ    OC_MINUTES
         4 000017   000556 600000 4                  TZE     WHAT_AGAIN

      114     1537    1        THEN
      115     1538    2        DO;                      /* WE HAVENT REPORTED IN THIS

      116     1539                                                MINUTE */
      117     1540    2             CALL CHARBIN(J,SUBSTR( TIME_AREA,0,2));
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:19   

   1540  4 000020   000000 305400                    DTB
         4 000021   000052 030002 1                  NDSC9   TIME_AREA                cn=0,s=nosgn,sf=0,n=2
         4 000022   000001 000004 1                  NDSC9   J                        cn=0,s=lsgnf,sf=0,n=4

      118     1541    2             IF OC_HIST_SAVE.ACTIVE

   1541  4 000023   000000 234000 xsym               SZN     OC_HIST_SAVE
         4 000024   000065 605000 4                  TPL     s:1555
         4 000025   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000026   777777 376007                    ANQ     -1,DL
         4 000027   000000 116000 1                  CMPQ    I
         4 000030   000065 601000 4                  TNZ     s:1555
         4 000031   000000 236000 xsym               LDQ     OC_HIST_SAVE
         4 000032   000022 772000                    QRL     18
         4 000033   377777 376007                    ANQ     131071,DL
         4 000034   000001 116000 1                  CMPQ    J
         4 000035   000065 601000 4                  TNZ     s:1555

      119     1542    2                  AND
      120     1543    2                  I = OC_HIST_SAVE.MIN
      121     1544    2                  AND
      122     1545    2                  J = OC_HIST_SAVE.HOUR
      123     1546    2             THEN
      124     1547    3             DO;

      125     1548    3                  IF SUBSTR(DATE_AREA,0,1) < '7' THEN

   1548  4 000036   000050 236000 1                  LDQ     DATE_AREA
         4 000037   777000 376003                    ANQ     -512,DU
         4 000040   067000 116003                    CMPQ    28160,DU
         4 000041   000051 603000 4                  TRC     s:1551

      126     1549    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':OCHIST20',DATE_AREA);

   1549  4 000042   040000 100400                    MLR     fill='040'O
         4 000043   000000 000011 3                  ADSC9   0                        cn=0,n=9
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:20   
         4 000044   000006 200011 1                  ADSC9   TEMP_BUF+1               cn=1,n=9
         4 000045   040000 100400                    MLR     fill='040'O
         4 000046   000050 000006 1                  ADSC9   DATE_AREA                cn=0,n=6
         4 000047   000010 400013 1                  ADSC9   TEMP_BUF+3               cn=2,n=11
         4 000050   000057 710000 4                  TRA     s:1552

      127     1550    3                  ELSE
      128     1551    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':OCHIST19',DATE_AREA);

   1551  4 000051   040000 100400                    MLR     fill='040'O
         4 000052   000003 000011 3                  ADSC9   3                        cn=0,n=9
         4 000053   000006 200011 1                  ADSC9   TEMP_BUF+1               cn=1,n=9
         4 000054   040000 100400                    MLR     fill='040'O
         4 000055   000050 000006 1                  ADSC9   DATE_AREA                cn=0,n=6
         4 000056   000010 400013 1                  ADSC9   TEMP_BUF+3               cn=2,n=11

      129     1552    3                  TEMP_BUF.TEXTC.SIZE = 15;

   1552  4 000057   017000 236003                    LDQ     7680,DU
         4 000060   000006 552040 1                  STBQ    TEMP_BUF+1,'40'O

      130     1553    3                  CALL OCL$RLS(TEMP_BUF.CADDR,TEMP_BUF.TEXTC);

   1553  4 000061   000003 630400 5                  EPPR0   3
         4 000062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000063   000000 701000 xent               TSX1    OCL$RLS
         4 000064   000000 011000                    NOP     0

      131     1554    3                END;

      132     1555    2             IF OC_ACCT_SAVE.ACTIVE

   1555  4 000065   000000 234000 xsym               SZN     OC_ACCT_SAVE
         4 000066   000133 605000 4                  TPL     WHOOPS
         4 000067   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000070   777777 376007                    ANQ     -1,DL
         4 000071   000000 116000 1                  CMPQ    I
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:21   
         4 000072   000133 601000 4                  TNZ     WHOOPS
         4 000073   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         4 000074   000022 772000                    QRL     18
         4 000075   377777 376007                    ANQ     131071,DL
         4 000076   000001 116000 1                  CMPQ    J
         4 000077   000133 601000 4                  TNZ     WHOOPS

      133     1556    2                  AND
      134     1557    2                  I = OC_ACCT_SAVE.MIN
      135     1558    2                  AND
      136     1559    2                  J = OC_ACCT_SAVE.HOUR
      137     1560    2             THEN
      138     1561    3             DO;

      139     1562    3                  IF SUBSTR(DATE_AREA,0,1) < '7' THEN

   1562  4 000100   000050 236000 1                  LDQ     DATE_AREA
         4 000101   777000 376003                    ANQ     -512,DU
         4 000102   067000 116003                    CMPQ    28160,DU
         4 000103   000113 603000 4                  TRC     s:1565

      140     1563    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':ACCTLG20',DATE_AREA);

   1563  4 000104   040000 100400                    MLR     fill='040'O
         4 000105   000006 000011 3                  ADSC9   6                        cn=0,n=9
         4 000106   000006 200011 1                  ADSC9   TEMP_BUF+1               cn=1,n=9
         4 000107   040000 100400                    MLR     fill='040'O
         4 000110   000050 000006 1                  ADSC9   DATE_AREA                cn=0,n=6
         4 000111   000010 400013 1                  ADSC9   TEMP_BUF+3               cn=2,n=11
         4 000112   000121 710000 4                  TRA     s:1566

      141     1564    3                  ELSE
      142     1565    3                       CALL CONCAT(TEMP_BUF.TEXTC.TEXT,':ACCTLG19',DATE_AREA);

   1565  4 000113   040000 100400                    MLR     fill='040'O
         4 000114   000011 000011 3                  ADSC9   9                        cn=0,n=9
         4 000115   000006 200011 1                  ADSC9   TEMP_BUF+1               cn=1,n=9
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:22   
         4 000116   040000 100400                    MLR     fill='040'O
         4 000117   000050 000006 1                  ADSC9   DATE_AREA                cn=0,n=6
         4 000120   000010 400013 1                  ADSC9   TEMP_BUF+3               cn=2,n=11

      143     1566    3                  TEMP_BUF.TEXTC.SIZE = 15;

   1566  4 000121   017000 236003                    LDQ     7680,DU
         4 000122   000006 552040 1                  STBQ    TEMP_BUF+1,'40'O

      144     1567    3                  WR_SLUG.BUF_.BOUND = 20;

   1567  4 000123   000030 236000 1                  LDQ     WR_SLUG+4
         4 000124   177777 376007                    ANQ     65535,DL
         4 000125   000005 276003                    ORQ     5,DU
         4 000126   000030 756000 1                  STQ     WR_SLUG+4

      145     1568    3                  CALL M$WRITE(WR_SLUG) ALTRET(WHOOPS);

   1568  4 000127   000024 630400 1                  EPPR0   WR_SLUG
         4 000130   440001 713400                    CLIMB   alt,write
         4 000131   401400 401760                    pmme    nvectors=4
         4 000132   000133 702000 4                  TSX2    WHOOPS

   1567  4 000133                       WHOOPS       null
      146     1569    3   WHOOPS:        ;
      147     1570    3                END;

      148     1571    2             OC_MINUTES = I;

   1571  4 000133   000000 235000 1                  LDA     I
         4 000134   000003 755000 1                  STA     OC_MINUTES

      149     1572    2             IF SUBSTR(TIME_AREA,2,2) = '00'

   1572  4 000135   000052 720000 1                  LXL0    TIME_AREA
         4 000136   000014 100000 3                  CMPX0   12
         4 000137   000150 601000 4                  TNZ     s:1582
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:23   

      150     1573    2             THEN
      151     1574    3             DO;

      152     1575    3                  MSG# = 390 /* HOUR_MSG# */;

   1575  4 000140   000606 221003                    LDX1    390,DU
         4 000141   200005 741100                    STX1    MSG#,,AUTO

      153     1576    3                  CALL M$WRSYSLOG (WRITE_TIMESTAMP)

   1576  4 000142   000040 630400 1                  EPPR0   WRITE_TIMESTAMP
         4 000143   470001 713400                    CLIMB   alt,+28673
         4 000144   400400 401760                    pmme    nvectors=2
         4 000145   000147 702000 4                  TSX2    s:1580
         4 000146   000147 710000 4                  TRA     s:1580

      154     1577    3                  WHENALTRETURN
      155     1578    4                  DO;

      156     1579    4                     END;

      157     1580    3                END;

   1580  4 000147   000152 710000 4                  TRA     s:1585

      158     1581    2             ELSE
      159     1582    2                  MSG# = 391 /* TIME_MSG# */;

   1582  4 000150   000607 221003                    LDX1    391,DU
         4 000151   200005 741100                    STX1    MSG#,,AUTO

      160     1583                                                /**/
      161     1584                                                /**/
      162     1585    3             DO I = 0 TO 255;              /* scan dolist */

   1585  4 000152   000000 450000 1                  STZ     I
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:24   

      163     1586    3                  IF (OCP_MSGBUF_LIST.LINK(I) ~= 511)

   1586  4 000153   000000 235000 1                  LDA     I
         4 000154   000002 735000                    ALS     2
         4 000155   000001 236005 xsym               LDQ     OCP_MSGBUF_LIST+1,AL
         4 000156   777000 376003                    ANQ     -512,DU
         4 000157   777000 116003                    CMPQ    -512,DU
         4 000160   000242 600000 4                  TZE     s:1610

      164     1587    3                  THEN
      165     1588    4                  DO;

      166     1589    4                       J = 0;

   1589  4 000161   000001 450000 1                  STZ     J

      167     1590    4                       TEMP = OCP_MSGBUF_LIST.LINK(I);

   1590  4 000162   000001 236005 xsym               LDQ     OCP_MSGBUF_LIST+1,AL
         4 000163   000033 772000                    QRL     27
         4 000164   200003 756100                    STQ     TEMP,,AUTO

      168     1591    5                       DO WHILE (TEMP ~= 511);

   1591  4 000165   000777 116007                    CMPQ    511,DL
         4 000166   000210 600000 4                  TZE     s:1599

      169     1592    5                            TEMP$ = PINCRW (OCP_MSGBUF$, TEMP * 8);

   1592  4 000167   200003 236100                    LDQ     TEMP,,AUTO
         4 000170   000025 736000                    QLS     21
         4 000171   000000 036000 xsym               ADLQ    OCP_MSGBUF$
         4 000172   200004 756100                    STQ     TEMP$,,AUTO

      170     1593    5                            CALL INSERT (OCP_TIMED_BUF, J, 31,

PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:25   
   1593  4 000173   200004 470500                    LDP0    TEMP$,,AUTO
         4 000174   000001 235000 1                  LDA     J
         4 000175   040005 100500                    MLR     fill='040'O
         4 000176   000000 000037                    ADSC9   0,,PR0                   cn=0,n=31
         4 000177   000000 000037 xsym               ADSC9   OCP_TIMED_BUF,A          cn=0,n=31

      171     1594    5                                 TEMP$ -> OCP$MSGBUF_UNIT.BUF);
      172     1595    5                            J = J + 31;

   1595  4 000200   000037 236007                    LDQ     31,DL
         4 000201   000001 056000 1                  ASQ     J

      173     1596    5                            TEMP = TEMP$ -> OCP$MSGBUF_UNIT.LINK;

   1596  4 000202   000100 101500                    MRL     fill='000'O
         4 000203   000007 600001                    ADSC9   7,,PR0                   cn=3,n=1
         4 000204   200003 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

      174     1597    5                          END;

   1597  4 000205   200003 235100                    LDA     TEMP,,AUTO
         4 000206   000777 115007                    CMPA    511,DL
         4 000207   000167 601000 4                  TNZ     s:1592

      175     1598                                                /**/
      176     1599    5                       DO WHILE ((SUBSTR(OCP_TIMED_BUF,J-1,1) = ' ')

   1599  4 000210   000213 710000 4                  TRA     s:1603

      177     1600    5                            AND
      178     1601    5                            (J > 1));
      179     1602    5                            J = J - 1;

   1602  4 000211   000001 336007                    LCQ     1,DL
         4 000212   000001 056000 1                  ASQ     J

      180     1603    5                          END;             /* DO WHILE TRAILING BLANKS */
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:26   

   1603  4 000213   000001 235000 1                  LDA     J
         4 000214   040000 106405                    CMPC    fill='040'O
         4 000215   777777 600001 xsym               ADSC9   OCP_TIMED_BUF-1,A        cn=3,n=1
         4 000216   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000217   000222 601000 4                  TNZ     s:1605
         4 000220   000001 115007                    CMPA    1,DL
         4 000221   000211 605400 4                  TPNZ    s:1602

      181     1604                                                /**/
      182     1605    4                       CALL OCW$WRITE (OCP_TIMED_BUF, J,

   1605  4 000222   000005 236000 5                  LDQ     5
         4 000223   200014 756100                    STQ     FOUND+6,,AUTO
         4 000224   000000 236000 1                  LDQ     I
         4 000225   000024 736000                    QLS     20
         4 000226   000006 036000 5                  ADLQ    6
         4 000227   200013 756100                    STQ     FOUND+5,,AUTO
         4 000230   000000 236000 1                  LDQ     I
         4 000231   000024 736000                    QLS     20
         4 000232   000007 036000 5                  ADLQ    7
         4 000233   200012 756100                    STQ     FOUND+4,,AUTO
         4 000234   000010 237000 5                  LDAQ    8
         4 000235   200010 757100                    STAQ    FOUND+2,,AUTO
         4 000236   200010 630500                    EPPR0   FOUND+2,,AUTO
         4 000237   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000240   000000 701000 xent               TSX1    OCW$WRITE
         4 000241   000000 011000                    NOP     0

      183     1606    4                            OCP_MSGBUF_LIST.CADDR(I),
      184     1607    4                            OCP_MSGBUF_LIST.WSN(I),
      185     1608    4                            ADDR(OCP_TIMED_BUF)->OC$MESSHD.MSG#);
      186     1609    4                     END;

      187     1610    3                END;

   1610  4 000242   000000 054000 1                  AOS     I
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:27   
         4 000243   000000 235000 1                  LDA     I
         4 000244   000377 115007                    CMPA    255,DL
         4 000245   000153 604400 4                  TMOZ    s:1586

      188     1611                                                /**/
      189     1612                                                /**/
      190     1613                                           /* Check to see if there are any
      191     1614                                                pending reads we should tell
      192     1615                                                this operator about */
      193     1616    2             OC_NEXT_PEND = OC_NEXT_PEND + 1;

   1616  4 000246   000000 236000 xsym               LDQ     OC_NEXT_PEND
         4 000247   000001 036007                    ADLQ    1,DL
         4 000250   000000 756000 xsym               STQ     OC_NEXT_PEND

      194     1617    2             IF OC_NEXT_PEND >= OC_NEXT_PENDX

   1617  4 000251   000000 116000 xsym               CMPQ    OC_NEXT_PENDX
         4 000252   000421 602000 4                  TNC     s:1689

      195     1618    2             THEN
      196     1619    3             DO;

      197     1620    3                  OC_NEXT_PEND = 0;

   1620  4 000253   000000 450000 xsym               STZ     OC_NEXT_PEND

      198     1621                                                /**/
      199     1622    4                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   1622  4 000254   000001 236007                    LDQ     1,DL
         4 000255   000000 756000 1                  STQ     I
         4 000256   000415 710000 4                  TRA     s:1680+1

      200     1623    4                       IF OC_CONSOLE.ACTIVE(I)

   1623  4 000257   000000 236000 1                  LDQ     I
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:28   
         4 000260   000076 402007                    MPY     62,DL
         4 000261   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000262   000017 236106                    LDQ     15,QL,PR0
         4 000263   010000 316007                    CANQ    4096,DL
         4 000264   000414 600000 4                  TZE     s:1680

      201     1624    4                       THEN
      202     1625    5                       DO;

      203     1626    5                            TEMP$ = OCP_USED_HEAD$;

   1626  4 000265   000000 236000 xsym               LDQ     OCP_USED_HEAD
         4 000266   200004 756100                    STQ     TEMP$,,AUTO

      204     1627    6                            DO WHILE (~FOUND AND TEMP$ ~= ADDR(NIL));

   1627  4 000267   000353 710000 4                  TRA     s:1666

      205     1628                                                /* If direct, check CID */
      206     1629    6                                 IF TEMP$ -> OC$PEND.CADDR & '400000'O

   1629  4 000270   200004 470500                    LDP0    TEMP$,,AUTO
         4 000271   000002 220100                    LDX0    2,,PR0
         4 000272   400000 360003                    ANX0    -131072,DU
         4 000273   000312 600000 4                  TZE     s:1638

      207     1630    6                                 THEN
      208     1631    6                                      IF (OC_CONSOLE.CID(I)+BITBIN('400000'O)) =

   1631  4 000274   000002 236100                    LDQ     2,,PR0
         4 000275   000022 772000                    QRL     18
         4 000276   200010 756100                    STQ     FOUND+2,,AUTO
         4 000277   000000 236000 1                  LDQ     I
         4 000300   000076 402007                    MPY     62,DL
         4 000301   000000 471400 xsym               LDP1    OC_CONSOLE$
         4 000302   100012 236106                    LDQ     10,QL,PR1
         4 000303   000022 772000                    QRL     18
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:29   
         4 000304   400000 036007                    ADLQ    -131072,DL
         4 000305   200010 116100                    CMPQ    FOUND+2,,AUTO
         4 000306   000351 601000 4                  TNZ     s:1665

      209     1632    6                                           BITBIN(TEMP$ -> OC$PEND.CADDR)
      210     1633    6                                      THEN
      211     1634    6                                           FOUND = '1'B /*TRUE#*/;

   1634  4 000307   400000 236003                    LDQ     -131072,DU
         4 000310   200006 756100                    STQ     FOUND,,AUTO
         4 000311   000351 710000 4                  TRA     s:1665

      212     1635    6                                      ELSE ;
      213     1636    6                                 ELSE      /* attribute? */
      214     1637    7                                 DO;

      215     1638    7                                      IF OC_CONSOLE.ATTR(I) & '200000'O /* M_SYS  */

   1638  4 000312   000000 236000 1                  LDQ     I
         4 000313   000076 402007                    MPY     62,DL
         4 000314   000000 471400 xsym               LDP1    OC_CONSOLE$
         4 000315   100013 220106                    LDX0    11,QL,PR1
         4 000316   200000 360003                    ANX0    65536,DU
         4 000317   000363 601000 4                  TNZ     PRINT_IT

      216     1639    7                                      THEN
      217     1640    7                                           GOTO PRINT_IT;
      218     1641                                                /**/
      219     1642    7                                      CADDR = TEMP$ -> OC$PEND.CADDR &

   1642  4 000320   000002 220100                    LDX0    2,,PR0
         4 000321   100013 360106                    ANX0    11,QL,PR1
         4 000322   000055 740000 1                  STX0    CADDR

      220     1643    7                                           OC_CONSOLE.ATTR(I);
      221     1644                                                /**/
      222     1645    7                                      IF CADDR & '004000'O /* M_COMM */
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:30   

   1645  4 000323   004000 360003                    ANX0    2048,DU
         4 000324   000363 601000 4                  TNZ     PRINT_IT

      223     1646    7                                      THEN
      224     1647    7                                           GOTO PRINT_IT;
      225     1648    7                                      IF CADDR & '040000'O /* M_ADMIN */

   1648  4 000325   000055 220000 1                  LDX0    CADDR
         4 000326   040000 360003                    ANX0    16384,DU
         4 000327   000341 600000 4                  TZE     s:1657
         4 000330   100013 220106                    LDX0    11,QL,PR1
         4 000331   040000 360003                    ANX0    16384,DU
         4 000332   000341 600000 4                  TZE     s:1657
         4 000333   000000 236000 1                  LDQ     I
         4 000334   000370 402007                    MPY     248,DL
         4 000335   040100 106506                    CMPC    fill='040'O
         4 000336   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         4 000337   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         4 000340   000363 600000 4                  TZE     PRINT_IT

      226     1649    7                                           AND
      227     1650    7                                           OC_CONSOLE.ATTR_INPUT(I) & '040000'O
              1650                                                    /* K_ADMIN */
      228     1651    7                                           AND
      229     1652    7                                           OC_CONSOLE.WSN(I) =
      230     1653    7                                           TEMP$ -> OC$PEND.WSN
      231     1654    7                                      THEN
      232     1655    7                                           GOTO PRINT_IT;
      233     1656                                                /**/
      234     1657    7                                      IF CADDR & '100000'O /* M_DEVC  */

   1657  4 000341   000055 220000 1                  LDX0    CADDR
         4 000342   100000 360003                    ANX0    32768,DU
         4 000343   000351 600000 4                  TZE     s:1665
         4 000344   000000 236000 1                  LDQ     I
         4 000345   000076 402007                    MPY     62,DL
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:31   
         4 000346   100001 236106                    LDQ     1,QL,PR1
         4 000347   000007 116100                    CMPQ    7,,PR0
         4 000350   000363 600000 4                  TZE     PRINT_IT

      235     1658    7                                           AND
      236     1659    7                                           OC_CONSOLE.STATIONR.SECND_HALF(I)
      237     1660    7                                           = TEMP$ -> OC$PEND.DEV.TWSN
      238     1661    7                                      THEN
      239     1662    7                                           GOTO PRINT_IT;
      240     1663    7                                    END;   /* DO IF ATTR ADDRESSED */

      241     1664                                                /**/
      242     1665    6                                 TEMP$ = TEMP$ -> OC$PEND.LINK$;

   1665  4 000351   000000 236100                    LDQ     0,,PR0
         4 000352   200004 756100                    STQ     TEMP$,,AUTO

      243     1666    6                               END;        /* DO WHILE */

   1666  4 000353   200006 236100                    LDQ     FOUND,,AUTO
         4 000354   400000 376003                    ANQ     -131072,DU
         4 000355   400000 676003                    ERQ     -131072,DU
         4 000356   000362 600000 4                  TZE     s:1670
         4 000357   200004 236100                    LDQ     TEMP$,,AUTO
         4 000360   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000361   000270 601000 4                  TNZ     s:1629

      244     1667                                                /**/
      245     1668                                                /**/
      246     1669                                                /**/
      247     1670    6                            DO WHILE ('0'B /*FALSE#*/);

   1670  4 000362   000414 710000 4                  TRA     s:1680

   1665  4 000363                       PRINT_IT     null
      248     1671                                                /**/
      249     1672    6   PRINT_IT:                     ;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:32   
      250     1673    6                                 MESS# = 392 /* PEND_MSG# */;

   1673  4 000363   000610 220003                    LDX0    392,DU
         4 000364   000054 740000 1                  STX0    MESS#

      251     1674    6                                 CALL OCO$IWRITE (

   1674  4 000365   000000 236000 1                  LDQ     I
         4 000366   000076 402007                    MPY     62,DL
         4 000367   100012 236106                    LDQ     10,QL,PR1
         4 000370   000022 772000                    QRL     18
         4 000371   400000 036007                    ADLQ    -131072,DL
         4 000372   000022 736000                    QLS     18
         4 000373   000022 772000                    QRL     18
         4 000374   000000 621006                    EAX1    0,QL
         4 000375   200010 741100                    STX1    FOUND+2,,AUTO
         4 000376   000012 237000 5                  LDAQ    10
         4 000377   200020 757100                    STAQ    FOUND+10,,AUTO
         4 000400   000014 237000 5                  LDAQ    12
         4 000401   200016 757100                    STAQ    FOUND+8,,AUTO
         4 000402   000014 237000 5                  LDAQ    12
         4 000403   200014 757100                    STAQ    FOUND+6,,AUTO
         4 000404   000016 236000 5                  LDQ     14
         4 000405   200013 756100                    STQ     FOUND+5,,AUTO
         4 000406   200010 633500                    EPPR3   FOUND+2,,AUTO
         4 000407   200012 453500                    STP3    FOUND+4,,AUTO
         4 000410   200012 630500                    EPPR0   FOUND+4,,AUTO
         4 000411   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000412   000000 701000 xent               TSX1    OCO$IWRITE
         4 000413   000000 011000                    NOP     0

      252     1675    6                                      BINBIT (OC_CONSOLE.CID(I) +
      253     1676    6                                      BITBIN('400000'O),18),
      254     1677    6                                      MESS#, 0, 0, 0, 0, OCP_NON_STA, 0);
      255     1678    6                               END;        /* DO IF RIGHT CONSOLE */

      256     1679    5                          END;             /* DO IF CONSOLE IS ACTIVE */
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:33   

      257     1680    4                     END;                  /* DO I = 0 TO MAX_CONS */

   1680  4 000414   000000 054000 1                  AOS     I
         4 000415   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000416   000022 772000                    QRL     18
         4 000417   000000 116000 1                  CMPQ    I
         4 000420   000257 605000 4                  TPL     s:1623

      258     1681    3                END;                       /* DO IF PEND REPORT TIME */

      259     1682                                                /**/
      260     1683                                                /**/
      261     1684                                                /**/
      262     1685                                           /* Now that the timed messages are
      263     1686                                                out of the way, check all
      264     1687                                                consoles for activity in order
      265     1688                                                to print the time on them */
      266     1689    3             DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   1689  4 000421   000001 235007                    LDA     1,DL
         4 000422   000000 755000 1                  STA     I
         4 000423   000552 710000 4                  TRA     s:1718+1

      267     1690    3                  IF ~OC_CONSOLE.DONT_TIME(I)

   1690  4 000424   000000 236000 1                  LDQ     I
         4 000425   000076 402007                    MPY     62,DL
         4 000426   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000427   000017 236106                    LDQ     15,QL,PR0
         4 000430   000030 736000                    QLS     24
         4 000431   400000 376003                    ANQ     -131072,DU
         4 000432   400000 676003                    ERQ     -131072,DU
         4 000433   000551 600000 4                  TZE     s:1718

      268     1691    3                  THEN
      269     1692    4                  DO;
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:34   

      270     1693    4                       IF OC_CONSOLE.ACTIVE(I)

   1693  4 000434   000000 236000 1                  LDQ     I
         4 000435   000076 402007                    MPY     62,DL
         4 000436   000017 236106                    LDQ     15,QL,PR0
         4 000437   010000 316007                    CANQ    4096,DL
         4 000440   000504 600000 4                  TZE     s:1706
         4 000441   000000 236000 1                  LDQ     I
         4 000442   000076 402007                    MPY     62,DL
         4 000443   000017 236106                    LDQ     15,QL,PR0
         4 000444   020000 316007                    CANQ    8192,DL
         4 000445   000504 600000 4                  TZE     s:1706

      271     1694    4                            AND
      272     1695    4                            OC_CONSOLE.TRANSAC_LAST_MIN(I)
      273     1696    4                       THEN
      274     1697    5                       DO;

      275     1698    5                            CALL OCO$IWRITE (

   1698  4 000446   000000 236000 1                  LDQ     I
         4 000447   000076 402007                    MPY     62,DL
         4 000450   000012 236106                    LDQ     10,QL,PR0
         4 000451   000022 772000                    QRL     18
         4 000452   400000 036007                    ADLQ    -131072,DL
         4 000453   000022 736000                    QLS     18
         4 000454   000022 772000                    QRL     18
         4 000455   000000 620006                    EAX0    0,QL
         4 000456   200010 740100                    STX0    FOUND+2,,AUTO
         4 000457   000012 237000 5                  LDAQ    10
         4 000460   200020 757100                    STAQ    FOUND+10,,AUTO
         4 000461   000014 237000 5                  LDAQ    12
         4 000462   200016 757100                    STAQ    FOUND+8,,AUTO
         4 000463   000014 237000 5                  LDAQ    12
         4 000464   200014 757100                    STAQ    FOUND+6,,AUTO
         4 000465   200005 631500                    EPPR1   MSG#,,AUTO
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:35   
         4 000466   200013 451500                    STP1    FOUND+5,,AUTO
         4 000467   200010 633500                    EPPR3   FOUND+2,,AUTO
         4 000470   200012 453500                    STP3    FOUND+4,,AUTO
         4 000471   200012 630500                    EPPR0   FOUND+4,,AUTO
         4 000472   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000473   000000 701000 xent               TSX1    OCO$IWRITE
         4 000474   000000 011000                    NOP     0

      276     1699    5                                 BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
      277     1700    5                                 MSG#, 0, 0, 0, 0, OCP_NON_STA,0);
      278     1701    5                            OC_CONSOLE.TRANSAC_LAST_MIN(I) = '0'B /*FALSE#*/;

   1701  4 000475   000000 236000 1                  LDQ     I
         4 000476   000076 402007                    MPY     62,DL
         4 000477   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000500   000000 620006                    EAX0    0,QL
         4 000501   000017 236000 5                  LDQ     15
         4 000502   000017 356110                    ANSQ    15,X0,PR0

      279     1702    5                          END;             /* DO IF activity */

   1702  4 000503   000551 710000 4                  TRA     s:1718

      280     1703    4                       ELSE
      281     1704                                                /* No activity, but check if
      282     1705                                                     HOUR template */
      283     1706    4                            IF OC_CONSOLE.ACTIVE(I)

   1706  4 000504   000000 236000 1                  LDQ     I
         4 000505   000076 402007                    MPY     62,DL
         4 000506   000017 236106                    LDQ     15,QL,PR0
         4 000507   010000 316007                    CANQ    4096,DL
         4 000510   000551 600000 4                  TZE     s:1718
         4 000511   200005 220100                    LDX0    MSG#,,AUTO
         4 000512   000606 100003                    CMPX0   390,DU
         4 000513   000551 601000 4                  TNZ     s:1718

PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:36   
      284     1707    4                                 AND
      285     1708    4                                 MSG# = 390 /* HOUR_MSG# */
      286     1709    4                            THEN
      287     1710    5                            DO;

      288     1711    5                                 CALL OCO$IWRITE

   1711  4 000514   000000 236000 1                  LDQ     I
         4 000515   000076 402007                    MPY     62,DL
         4 000516   000012 236106                    LDQ     10,QL,PR0
         4 000517   000022 772000                    QRL     18
         4 000520   400000 036007                    ADLQ    -131072,DL
         4 000521   000022 736000                    QLS     18
         4 000522   000022 772000                    QRL     18
         4 000523   000000 621006                    EAX1    0,QL
         4 000524   200010 741100                    STX1    FOUND+2,,AUTO
         4 000525   000012 237000 5                  LDAQ    10
         4 000526   200020 757100                    STAQ    FOUND+10,,AUTO
         4 000527   000014 237000 5                  LDAQ    12
         4 000530   200016 757100                    STAQ    FOUND+8,,AUTO
         4 000531   000014 237000 5                  LDAQ    12
         4 000532   200014 757100                    STAQ    FOUND+6,,AUTO
         4 000533   200005 631500                    EPPR1   MSG#,,AUTO
         4 000534   200013 451500                    STP1    FOUND+5,,AUTO
         4 000535   200010 633500                    EPPR3   FOUND+2,,AUTO
         4 000536   200012 453500                    STP3    FOUND+4,,AUTO
         4 000537   200012 630500                    EPPR0   FOUND+4,,AUTO
         4 000540   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000541   000000 701000 xent               TSX1    OCO$IWRITE
         4 000542   000000 011000                    NOP     0

      289     1712    5                                      (BINBIT(OC_CONSOLE.CID(I) +
      290     1713    5                                      BITBIN('400000'O), 18),
      291     1714    5                                      MSG#, 0, 0, 0, 0, OCP_NON_STA, 0);
      292     1715    5                                 OC_CONSOLE.TRANSAC_LAST_MIN(I) = '0'B /*FALSE#*/;

   1715  4 000543   000000 236000 1                  LDQ     I
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:37   
         4 000544   000076 402007                    MPY     62,DL
         4 000545   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000546   000000 620006                    EAX0    0,QL
         4 000547   000017 236000 5                  LDQ     15
         4 000550   000017 356110                    ANSQ    15,X0,PR0

      293     1716    5                               END;        /* DO IF HOUR */

      294     1717    4                     END;                  /* DO I = 0 TO MAX_CONS */

      295     1718    3                END;                       /* DO IF TIME WANTED */

   1718  4 000551   000000 054000 1                  AOS     I
         4 000552   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000553   000022 772000                    QRL     18
         4 000554   000000 116000 1                  CMPQ    I
         4 000555   000424 605000 4                  TPL     s:1690

      296     1719    2           END;                            /* DO IF THIS IS THE MINUTE */

   1714  4 000556                       WHAT_AGAIN   null
      297     1720                                                /**/
      298     1721                                                /**/
      299     1722                                                /**/
      300     1723    1   WHAT_AGAIN: ;
      301     1724                                                /**/
      302     1725    1        RETURN;

   1725  4 000556   000000 702200 xent               TSX2  ! X66_ARET
      303     1726    1   END OCP$DOLIST;
      304     1727        %EOD;

PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:38   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$DOLIST.
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:39   

 **** Variables and constants ****

  ****  Section 001  Data  OCP$DOLIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    55-0-0/b BIT (18)    r     1 CADDR                     50-0-0/c CHAR(6)     r     1 DATE_AREA
    56-0-0/d STRC(432)   r     1 GET_TIME                   0-0-0/w SBIN        r     1 I
     1-0-0/w SBIN        r     1 J                         54-0-0/w UBIN(18)    r     1 MESS#
     3-0-0/w SBIN        r     1 OC_MINUTES                 2-0-0/w UBIN        r     1 OC_TSTAMP
    14-0-0/w STRC(288)   r     1 STA                        5-0-0/c STRC(225)   r     1 TEMP_BUF
    52-0-0/c CHAR(8)     r     1 TIME_AREA                 40-0-0/d STRC(288)   r     1 WRITE_TIMESTAMP
    24-0-0/d STRC(432)   r     1 WR_SLUG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w BIT         r     1 FOUND                      5-0-0/w UBIN(18)    r     1 MSG#
     3-0-0/w UBIN        r     1 TEMP                       4-0-0/w PTR         r     1 TEMP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OCP_MSGBUF$
     0-0-0/c STRC(144)   r     1 OCP_MSGBUF_LIST(0:255)
     0-0-0/c CHAR(8)     r     1 OCP_NON_STA                0-0-0/c CHAR(256)   r     1 OCP_TIMED_BUF
     0-0-0/w STRC        r     1 OCP_USED_HEAD              0-0-0/w PTR         r     1 OCP_USED_HEAD$
     0-0-0/b STRC        r     1 OC_ACCT_SAVE               0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/b STRC        r     1 OC_HIST_SAVE               0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE
     0-0-0/w UBIN        r     1 OC_NEXT_PEND               0-0-0/w UBIN        r     1 OC_NEXT_PENDX

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:40   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$CSCG                     0-0-0/c STRC(180)   r     1 OC$MESSHD
     0-0-0/w ASTR(360)   r     1 OC$PEND                    0-0-0/c STRC(288)   r     1 OCP$MSGBUF_UNIT
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCP$DOLIST requires 367 words for executable code.
   Procedure OCP$DOLIST requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:41   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:42   
          MINI XREF LISTING

CADDR
      1498**DCL      1642<<ASSIGN   1645>>IF       1648>>IF       1657>>IF
DATE_AREA
      1492**DCL      1517--DCLINIT  1518--DCLINIT  1548>>IF       1549>>CALLBLT  1551>>CALLBLT  1562>>IF
      1563>>CALLBLT  1565>>CALLBLT
FOUND
      1499**DCL      1627>>DOWHILE  1634<<ASSIGN
GET_TIME
      1517**DCL      1532<>CALL
GET_TIME.V
      1521**DCL      1517--DCLINIT
I
      1392**DCL      1534<>CALL     1535<<ASSIGN   1535>>ASSIGN   1536>>IF       1541>>IF       1555>>IF
      1571>>ASSIGN   1585<<DOINDEX  1586>>IF       1590>>ASSIGN   1605>>CALL     1605>>CALL     1622<<DOINDEX
      1623>>IF       1631>>IF       1638>>IF       1642>>ASSIGN   1648>>IF       1648>>IF       1657>>IF
      1674>>CALL     1689<<DOINDEX  1690>>IF       1693>>IF       1693>>IF       1698>>CALL     1701>>ASSIGN
      1706>>IF       1711>>CALL     1715>>ASSIGN
J
      1393**DCL      1540<<CALLBLT  1541>>IF       1555>>IF       1589<<ASSIGN   1593>>CALLBLT  1595<<ASSIGN
      1595>>ASSIGN   1599>>DOWHILE  1599>>DOWHILE  1602<<ASSIGN   1602>>ASSIGN   1605<>CALL
M$TIME
      1009**DCL-ENT  1532--CALL
M$WRITE
       943**DCL-ENT  1568--CALL
M$WRSYSLOG
       991**DCL-ENT  1576--CALL
MESS#
      1497**DCL      1673<<ASSIGN   1674<>CALL
MSG#
      1496**DCL      1575<<ASSIGN   1582<<ASSIGN   1698<>CALL     1706>>IF       1711<>CALL
OC$MESSHD.FLAGS
      1384**DCL      1385--REDEF
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:43   
OC$MESSHD.MSG#
      1379**DCL      1605<>CALL
OC$MESSHD.MSGID
      1380**DCL      1381--REDEF
OC$MESSHD.WSN
      1387**DCL      1388--REDEF
OC$PEND.CADDR
        71**DCL      1629>>IF       1631>>IF       1642>>ASSIGN
OC$PEND.DEV.TWSN
        79**DCL      1657>>IF
OC$PEND.LINK$
        68**DCL      1665>>ASSIGN
OC$PEND.SIZEB_MSG
        70**DCL        81--IMP-SIZ
OC$PEND.WSN
        76**DCL        77--REDEF    1648>>IF
OCL$RLS
        39**DCL-ENT  1553--CALL
OCO$IWRITE
        38**DCL-ENT  1674--CALL     1698--CALL     1711--CALL
OCP$MSGBUF_UNIT.BUF
        56**DCL      1593>>CALLBLT
OCP$MSGBUF_UNIT.LINK
        56**DCL      1596>>ASSIGN
OCP_FREE_HEAD
        51**DCL        52--REDEF
OCP_MSGBUF$
        54**DCL      1592>>ASSIGN
OCP_MSGBUF_FREE.B
        55**DCL        55--REDEF
OCP_MSGBUF_LIST.CADDR
        55**DCL      1605<>CALL
OCP_MSGBUF_LIST.LINK
        56**DCL      1586>>IF       1590>>ASSIGN
OCP_MSGBUF_LIST.WSN
        56**DCL      1605<>CALL
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:44   
OCP_NON_STA
        57**DCL      1674<>CALL     1698<>CALL     1711<>CALL
OCP_TIMED_BUF
        56**DCL      1593<<CALLBLT  1599>>DOWHILE  1605<>CALL     1605--CALL
OCP_USED_HEAD
        52**DCL        53--REDEF
OCP_USED_HEAD$
        53**DCL      1626>>ASSIGN
OCP_USED_TAIL
        53**DCL        53--REDEF
OCW$WRITE
        37**DCL-ENT  1605--CALL
OC_ACCT_SAVE.ACTIVE
      1173**DCL      1555>>IF
OC_ACCT_SAVE.HOUR
      1173**DCL      1555>>IF
OC_ACCT_SAVE.MIN
      1173**DCL      1555>>IF
OC_CONSOLE.ACTIVE
      1131**DCL      1623>>IF       1693>>IF       1706>>IF
OC_CONSOLE.ATTR
      1128**DCL      1128--REDEF    1638>>IF       1642>>ASSIGN
OC_CONSOLE.ATTRO
      1129**DCL      1129--REDEF
OC_CONSOLE.ATTR_INPUT
      1128**DCL      1648>>IF
OC_CONSOLE.CID
      1127**DCL      1128--REDEF    1631>>IF       1674>>CALL     1698>>CALL     1711>>CALL
OC_CONSOLE.DONT_TIME
      1132**DCL      1690>>IF
OC_CONSOLE.STATION
      1126**DCL      1126--REDEF
OC_CONSOLE.STATIONR.SECND_HALF
      1126**DCL      1657>>IF
OC_CONSOLE.TRANSAC_LAST_MIN
      1131**DCL      1693>>IF       1701<<ASSIGN   1715<<ASSIGN
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:45   
OC_CONSOLE.WSN
      1127**DCL      1648>>IF
OC_CONSOLE$
      1125**DCL      1126--IMP-PTR  1623>>IF       1631>>IF       1638>>IF       1642>>ASSIGN   1648>>IF
      1648>>IF       1657>>IF       1674>>CALL     1690>>IF       1693>>IF       1693>>IF       1698>>CALL
      1701>>ASSIGN   1706>>IF       1711>>CALL     1715>>ASSIGN
OC_DIR
      1168**DCL      1168--REDEF
OC_HIST_SAVE.ACTIVE
      1172**DCL      1541>>IF
OC_HIST_SAVE.HOUR
      1172**DCL      1541>>IF
OC_HIST_SAVE.MIN
      1172**DCL      1541>>IF
OC_INTBIT
      1168**DCL      1169--REDEF
OC_INTMSG
      1045**DCL      1058--REDEF
OC_INTMSG.FLAGS
      1052**DCL      1053--REDEF
OC_INTMSG.MESS
      1058**DCL      1058--REDEF
OC_INTMSG.MSGID
      1048**DCL      1049--REDEF
OC_INTMSG.WSN
      1055**DCL      1056--REDEF
OC_MASK
      1169**DCL      1169--REDEF
OC_MAXCONSOLE
      1125**DCL      1622>>DOINDEX  1689>>DOINDEX
OC_MESSBUF
      1060**DCL      1075--REDEF    1089--REDEF
OC_MESSBUF.FLAGS
      1067**DCL      1068--REDEF
OC_MESSBUF.MESS
      1073**DCL      1073--REDEF
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:46   
OC_MESSBUF.MSGID
      1063**DCL      1064--REDEF
OC_MESSBUF.WSN
      1070**DCL      1071--REDEF
OC_MESSBUF1.FLAGS
      1082**DCL      1083--REDEF
OC_MESSBUF1.LEN
      1088**DCL      1088--REDEF
OC_MESSBUF1.MSGID
      1078**DCL      1079--REDEF
OC_MESSBUF1.WSN
      1085**DCL      1086--REDEF
OC_MINUTES
      1396**DCL      1536>>IF       1571<<ASSIGN
OC_MSGBUFFER
      1091**DCL      1106--REDEF
OC_MSGBUFFER.FLAGS
      1098**DCL      1099--REDEF
OC_MSGBUFFER.MESS
      1104**DCL      1104--REDEF
OC_MSGBUFFER.MSGID
      1094**DCL      1095--REDEF
OC_MSGBUFFER.WSN
      1101**DCL      1102--REDEF
OC_MSGBUFFER2.FLAGS
      1113**DCL      1114--REDEF
OC_MSGBUFFER2.MSGID
      1109**DCL      1110--REDEF
OC_MSGBUFFER2.WSN
      1116**DCL      1117--REDEF
OC_NEXT_PEND
      1121**DCL      1616<<ASSIGN   1616>>ASSIGN   1617>>IF       1620<<ASSIGN
OC_NEXT_PENDX
      1122**DCL      1617>>IF
OC_PARAM
      1124**DCL      1124--REDEF
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:47   
OC_QUEUE.PARMC
      1123**DCL      1123--REDEF
OC_TSTAMP
      1395**DCL      1521--DCLINIT  1534<>CALL
PRINT_IT
      1665**LABEL    1640--GOTO     1647--GOTO     1655--GOTO     1662--GOTO
STA
      1422**DCL      1462--DCLINIT
STA.MSGIDXT
      1432**DCL      1435--REDEF
TEMP
      1493**DCL      1590<<ASSIGN   1591>>DOWHILE  1592>>ASSIGN   1596<<ASSIGN
TEMP$
      1494**DCL      1592<<ASSIGN   1593>>CALLBLT  1596>>ASSIGN   1626<<ASSIGN   1627>>DOWHILE  1629>>IF
      1631>>IF       1642>>ASSIGN   1648>>IF       1657>>IF       1665<<ASSIGN   1665>>ASSIGN
TEMP_BUF
      1400**DCL      1461--DCLINIT  1462--DCLINIT
TEMP_BUF.CADDR
      1403**DCL      1553<>CALL
TEMP_BUF.TEXTC
      1404**DCL      1553<>CALL
TEMP_BUF.TEXTC.SIZE
      1405**DCL      1552<<ASSIGN   1566<<ASSIGN
TEMP_BUF.TEXTC.TEXT
      1406**DCL      1549<<CALLBLT  1551<<CALLBLT  1563<<CALLBLT  1565<<CALLBLT
TIME_AREA
      1495**DCL      1519--DCLINIT  1520--DCLINIT  1540>>CALLBLT  1572>>IF
WHOOPS
      1567**LABEL    1568--CALLALT
WRITE_TIMESTAMP
      1487**DCL      1576<>CALL
WRITE_TIMESTAMP.V
      1487**DCL      1487--DCLINIT
WR_SLUG
      1460**DCL      1568<>CALL
WR_SLUG.BUF_.BOUND
PL6.E3A0      #001=OCP$DOLIST File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:03 Page:48   
      1460**DCL      1567<<ASSIGN
WR_SLUG.STATION_
      1462**DCL      1462--REDEF
WR_SLUG.V
      1463**DCL      1460--DCLINIT
WR_SLUG.V.DVBYTE.VFC#
      1469**DCL      1469--REDEF
XUD$UTS_DIFF_SEC
      1349**DCL-ENT  1534--CALL

PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:49   
      305        1        /*T***********************************************************/
      306        2        /*T*                                                         */
      307        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      308        4        /*T*                                                         */
      309        5        /*T***********************************************************/
      310        6        OCP$INITCONSOLE: PROC (INDEX_);
      311        7
      312        8    1   DCL INDEX_ UBIN WORD;
      313        9
      314       10        %INCLUDE CP_6;
      315       91        %INCLUDE OC_SUBS_C;
      316      822        %INCLUDE OCI_SUBS_C;
      317      920        %INCLUDE OC_DAT_R;
      318     1081
      319     1082    1        OC_CONSOLE.STATION(INDEX_) = ' ';
      320     1083    1        OC_CONSOLE.TERM_NAME(INDEX_) = ' ';
      321     1084    1        OC_CONSOLE.WSN(INDEX_) = ' ';
      322     1085    1        OC_CONSOLE.LOGON(INDEX_) = ' ';
      323     1086    1        OC_CONSOLE.LP_WSN(INDEX_) = ' ';
      324     1087    1        OC_CONSOLE.CID(INDEX_) = 0;
      325     1088    1        OC_CONSOLE.SYSID(INDEX_) = 0;
      326     1089    1        OC_CONSOLE.ATTR(INDEX_) = '0'B;
      327     1090    1        OC_CONSOLE.ATTR_INPUT_SAVE(INDEX_) = '0'B;
      328     1091    1        OC_CONSOLE.ATTRO(INDEX_) = '0'B;
      329     1092    1        OC_CONSOLE.ATTR_OUTPUT_SAVE(INDEX_) = '0'B;
      330     1093    1        OC_CONSOLE.I_DCBNUM(INDEX_) = 0;
      331     1094    1        OC_CONSOLE.X_DCBNUM(INDEX_) = 0;
      332     1095    1        OC_CONSOLE.NEXT(INDEX_) = 0;
      333     1096    1        OC_CONSOLE.FLAGS(INDEX_) = '0'B;
      334     1097    1        OC_CONSOLE.GHST(INDEX_) = '0'B;
      335     1098    1        OC_CONSOLE.GHSTRD(INDEX_) = '0'B;
      336     1099    1        OC_CONSOLE.SHIFT(INDEX_) = '0'B;
      337     1100    1        OC_CONSOLE.BKSP(INDEX_) = '0'B;
      338     1101    1        OC_CONSOLE.TRANSAC_LAST_MIN(INDEX_) = '0'B;
      339     1102    1        OC_CONSOLE.ACTIVE(INDEX_) = '0'B;
      340     1103    1        OC_CONSOLE.DONT_TIME(INDEX_) = '0'B;
      341     1104    1        OC_CONSOLE.FIRST_READ(INDEX_) = '0'B;
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:50   
      342     1105    1        OC_CONSOLE.NATLANG(INDEX_) = ' ';
      343     1106    1        OC_CONSOLE.ACCT(INDEX_) = ' ';
      344     1107    1        OC_CONSOLE.PROMPTS(INDEX_) = ' ';
      345     1108    1        OC_CONSOLE.PROFILE.COUNT(INDEX_) = 0;
      346     1109    1        OC_CONSOLE.PROFILE.TXT(INDEX_) = ' ';
      347     1110    1        OC_CONSOLE.MXPRIO(INDEX_) = 0;
      348     1111    1        OC_CONSOLE.VLR_HELP(INDEX_) = '0'B;
      349     1112    1        RETURN;
      350     1113    1   END OCP$INITCONSOLE;
      351     1114        %EOD;

PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:51   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$INITCONSOLE.

   Procedure OCP$INITCONSOLE requires 187 words for executable code.
   Procedure OCP$INITCONSOLE requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:52   

 Object Unit name= OCP$INITCONSOLE                            File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:04:18.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   187    273  OCP$INITCONSOLE
    2  RoData even  none     9     11  OCP$INITCONSOLE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  OCP$INITCONSOLE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     B_VECTNIL
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:53   


      305        1        /*T***********************************************************/
      306        2        /*T*                                                         */
      307        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      308        4        /*T*                                                         */
      309        5        /*T***********************************************************/
      310        6        OCP$INITCONSOLE: PROC (INDEX_);

      6  1 000000   000000 700200 xent  OCP$INITCON* TSX0  ! X66_AUTO_1
         1 000001   000004 000001                    ZERO    4,1

      311        7
      312        8    1   DCL INDEX_ UBIN WORD;
      313        9
      314       10        %INCLUDE CP_6;
      315       91        %INCLUDE OC_SUBS_C;
      316      822        %INCLUDE OCI_SUBS_C;
      317      920        %INCLUDE OC_DAT_R;
      318     1081
      319     1082    1        OC_CONSOLE.STATION(INDEX_) = ' ';

   1082  1 000002   200003 470500                    LDP0    @INDEX_,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000076 402007                    MPY     62,DL
         1 000005   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000006   000000 620006                    EAX0    0,QL
         1 000007   000000 621006                    EAX1    0,QL
         1 000010   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000011   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000012   100000 755110                    STA     0,X0,PR1
         1 000013   100001 756111                    STQ     1,X1,PR1

      320     1083    1        OC_CONSOLE.TERM_NAME(INDEX_) = ' ';

   1083  1 000014   000000 236100                    LDQ     0,,PR0
         1 000015   000076 402007                    MPY     62,DL
         1 000016   000000 471400 xsym               LDP1    OC_CONSOLE$
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:54   
         1 000017   000000 620006                    EAX0    0,QL
         1 000020   000000 621006                    EAX1    0,QL
         1 000021   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000022   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000023   100002 755110                    STA     2,X0,PR1
         1 000024   100003 756111                    STQ     3,X1,PR1

      321     1084    1        OC_CONSOLE.WSN(INDEX_) = ' ';

   1084  1 000025   000000 236100                    LDQ     0,,PR0
         1 000026   000076 402007                    MPY     62,DL
         1 000027   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000030   000000 620006                    EAX0    0,QL
         1 000031   000000 621006                    EAX1    0,QL
         1 000032   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000033   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000034   100004 755110                    STA     4,X0,PR1
         1 000035   100005 756111                    STQ     5,X1,PR1

      322     1085    1        OC_CONSOLE.LOGON(INDEX_) = ' ';

   1085  1 000036   000000 236100                    LDQ     0,,PR0
         1 000037   000076 402007                    MPY     62,DL
         1 000040   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000041   000000 620006                    EAX0    0,QL
         1 000042   000000 621006                    EAX1    0,QL
         1 000043   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000044   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000045   100006 755110                    STA     6,X0,PR1
         1 000046   100007 756111                    STQ     7,X1,PR1

      323     1086    1        OC_CONSOLE.LP_WSN(INDEX_) = ' ';

   1086  1 000047   000000 236100                    LDQ     0,,PR0
         1 000050   000076 402007                    MPY     62,DL
         1 000051   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000052   000000 620006                    EAX0    0,QL
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:55   
         1 000053   000000 621006                    EAX1    0,QL
         1 000054   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000055   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000056   100010 755110                    STA     8,X0,PR1
         1 000057   100011 756111                    STQ     9,X1,PR1

      324     1087    1        OC_CONSOLE.CID(INDEX_) = 0;

   1087  1 000060   000000 236100                    LDQ     0,,PR0
         1 000061   000076 402007                    MPY     62,DL
         1 000062   000000 220003                    LDX0    0,DU
         1 000063   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000064   100012 740106                    STX0    10,QL,PR1

      325     1088    1        OC_CONSOLE.SYSID(INDEX_) = 0;

   1088  1 000065   000000 236100                    LDQ     0,,PR0
         1 000066   000076 402007                    MPY     62,DL
         1 000067   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000070   100012 440106                    SXL0    10,QL,PR1

      326     1089    1        OC_CONSOLE.ATTR(INDEX_) = '0'B;

   1089  1 000071   000000 236100                    LDQ     0,,PR0
         1 000072   000076 402007                    MPY     62,DL
         1 000073   000000 221003                    LDX1    0,DU
         1 000074   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000075   100013 741106                    STX1    11,QL,PR1

      327     1090    1        OC_CONSOLE.ATTR_INPUT_SAVE(INDEX_) = '0'B;

   1090  1 000076   000000 236100                    LDQ     0,,PR0
         1 000077   000076 402007                    MPY     62,DL
         1 000100   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000101   100013 441106                    SXL1    11,QL,PR1

      328     1091    1        OC_CONSOLE.ATTRO(INDEX_) = '0'B;
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:56   

   1091  1 000102   000000 236100                    LDQ     0,,PR0
         1 000103   000076 402007                    MPY     62,DL
         1 000104   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000105   100014 741106                    STX1    12,QL,PR1

      329     1092    1        OC_CONSOLE.ATTR_OUTPUT_SAVE(INDEX_) = '0'B;

   1092  1 000106   000000 236100                    LDQ     0,,PR0
         1 000107   000076 402007                    MPY     62,DL
         1 000110   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000111   100014 441106                    SXL1    12,QL,PR1

      330     1093    1        OC_CONSOLE.I_DCBNUM(INDEX_) = 0;

   1093  1 000112   000000 236100                    LDQ     0,,PR0
         1 000113   000076 402007                    MPY     62,DL
         1 000114   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000115   100015 740106                    STX0    13,QL,PR1

      331     1094    1        OC_CONSOLE.X_DCBNUM(INDEX_) = 0;

   1094  1 000116   000000 236100                    LDQ     0,,PR0
         1 000117   000076 402007                    MPY     62,DL
         1 000120   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000121   100015 440106                    SXL0    13,QL,PR1

      332     1095    1        OC_CONSOLE.NEXT(INDEX_) = 0;

   1095  1 000122   000000 236100                    LDQ     0,,PR0
         1 000123   000076 402007                    MPY     62,DL
         1 000124   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000125   100016 740106                    STX0    14,QL,PR1

      333     1096    1        OC_CONSOLE.FLAGS(INDEX_) = '0'B;

   1096  1 000126   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:57   
         1 000127   000076 402007                    MPY     62,DL
         1 000130   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000131   100017 741106                    STX1    15,QL,PR1

      334     1097    1        OC_CONSOLE.GHST(INDEX_) = '0'B;

   1097  1 000132   000000 236100                    LDQ     0,,PR0
         1 000133   000076 402007                    MPY     62,DL
         1 000134   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000135   000000 622006                    EAX2    0,QL
         1 000136   000000 236000 2                  LDQ     0
         1 000137   100017 356112                    ANSQ    15,X2,PR1

      335     1098    1        OC_CONSOLE.GHSTRD(INDEX_) = '0'B;

   1098  1 000140   000000 236100                    LDQ     0,,PR0
         1 000141   000076 402007                    MPY     62,DL
         1 000142   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000143   000000 622006                    EAX2    0,QL
         1 000144   000001 236000 2                  LDQ     1
         1 000145   100017 356112                    ANSQ    15,X2,PR1

      336     1099    1        OC_CONSOLE.SHIFT(INDEX_) = '0'B;

   1099  1 000146   000000 236100                    LDQ     0,,PR0
         1 000147   000076 402007                    MPY     62,DL
         1 000150   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000151   000000 622006                    EAX2    0,QL
         1 000152   000002 236000 2                  LDQ     2
         1 000153   100017 356112                    ANSQ    15,X2,PR1

      337     1100    1        OC_CONSOLE.BKSP(INDEX_) = '0'B;

   1100  1 000154   000000 236100                    LDQ     0,,PR0
         1 000155   000076 402007                    MPY     62,DL
         1 000156   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000157   000000 622006                    EAX2    0,QL
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:58   
         1 000160   000003 236000 2                  LDQ     3
         1 000161   100017 356112                    ANSQ    15,X2,PR1

      338     1101    1        OC_CONSOLE.TRANSAC_LAST_MIN(INDEX_) = '0'B;

   1101  1 000162   000000 236100                    LDQ     0,,PR0
         1 000163   000076 402007                    MPY     62,DL
         1 000164   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000165   000000 622006                    EAX2    0,QL
         1 000166   000004 236000 2                  LDQ     4
         1 000167   100017 356112                    ANSQ    15,X2,PR1

      339     1102    1        OC_CONSOLE.ACTIVE(INDEX_) = '0'B;

   1102  1 000170   000000 236100                    LDQ     0,,PR0
         1 000171   000076 402007                    MPY     62,DL
         1 000172   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000173   000000 622006                    EAX2    0,QL
         1 000174   000005 236000 2                  LDQ     5
         1 000175   100017 356112                    ANSQ    15,X2,PR1

      340     1103    1        OC_CONSOLE.DONT_TIME(INDEX_) = '0'B;

   1103  1 000176   000000 236100                    LDQ     0,,PR0
         1 000177   000076 402007                    MPY     62,DL
         1 000200   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000201   000000 622006                    EAX2    0,QL
         1 000202   000006 236000 2                  LDQ     6
         1 000203   100017 356112                    ANSQ    15,X2,PR1

      341     1104    1        OC_CONSOLE.FIRST_READ(INDEX_) = '0'B;

   1104  1 000204   000000 236100                    LDQ     0,,PR0
         1 000205   000076 402007                    MPY     62,DL
         1 000206   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000207   000000 622006                    EAX2    0,QL
         1 000210   000007 236000 2                  LDQ     7
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:59   
         1 000211   100017 356112                    ANSQ    15,X2,PR1

      342     1105    1        OC_CONSOLE.NATLANG(INDEX_) = ' ';

   1105  1 000212   000000 236100                    LDQ     0,,PR0
         1 000213   000076 402007                    MPY     62,DL
         1 000214   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000215   000000 622006                    EAX2    0,QL
         1 000216   100017 236106                    LDQ     15,QL,PR1
         1 000217   000010 376000 2                  ANQ     8
         1 000220   000040 276007                    ORQ     32,DL
         1 000221   100017 756112                    STQ     15,X2,PR1

      343     1106    1        OC_CONSOLE.ACCT(INDEX_) = ' ';

   1106  1 000222   000000 236100                    LDQ     0,,PR0
         1 000223   000076 402007                    MPY     62,DL
         1 000224   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000225   000000 622006                    EAX2    0,QL
         1 000226   000000 623006                    EAX3    0,QL
         1 000227   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000230   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000231   100020 755112                    STA     16,X2,PR1
         1 000232   100021 756113                    STQ     17,X3,PR1

      344     1107    1        OC_CONSOLE.PROMPTS(INDEX_) = ' ';

   1107  1 000233   000000 236100                    LDQ     0,,PR0
         1 000234   000076 402007                    MPY     62,DL
         1 000235   000002 736000                    QLS     2
         1 000236   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000237   040106 100400                    MLR     fill='040'O
         1 000240   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000241   100022 000146                    ADSC9   18,Q,PR1                 cn=0,n=102

      345     1108    1        OC_CONSOLE.PROFILE.COUNT(INDEX_) = 0;

PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:60   
   1108  1 000242   000000 236100                    LDQ     0,,PR0
         1 000243   000076 402007                    MPY     62,DL
         1 000244   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000245   000000 622006                    EAX2    0,QL
         1 000246   000032 236000 xsym               LDQ     B_VECTNIL+26
         1 000247   100072 356112                    ANSQ    58,X2,PR1

      346     1109    1        OC_CONSOLE.PROFILE.TXT(INDEX_) = ' ';

   1109  1 000250   000000 236100                    LDQ     0,,PR0
         1 000251   000076 402007                    MPY     62,DL
         1 000252   000002 736000                    QLS     2
         1 000253   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000254   040106 100400                    MLR     fill='040'O
         1 000255   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000256   100072 200013                    ADSC9   58,Q,PR1                 cn=1,n=11

      347     1110    1        OC_CONSOLE.MXPRIO(INDEX_) = 0;

   1110  1 000257   000000 236100                    LDQ     0,,PR0
         1 000260   000076 402007                    MPY     62,DL
         1 000261   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000262   100075 450106                    STZ     61,QL,PR1

      348     1111    1        OC_CONSOLE.VLR_HELP(INDEX_) = '0'B;

   1111  1 000263   000000 236100                    LDQ     0,,PR0
         1 000264   000076 402007                    MPY     62,DL
         1 000265   000002 736000                    QLS     2
         1 000266   000000 471400 xsym               LDP1    OC_CONSOLE$
         1 000267   000106 100400                    MLR     fill='000'O
         1 000270   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000271   100054 000070                    ADSC9   44,Q,PR1                 cn=0,n=56

      349     1112    1        RETURN;

   1112  1 000272   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:61   
      350     1113    1   END OCP$INITCONSOLE;
      351     1114        %EOD;

PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:62   
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$INITCONSOLE.
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:63   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @INDEX_                   *0-0-0/w UBIN        r     1 INDEX_

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OC_CONSOLE$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCP$INITCONSOLE requires 187 words for executable code.
   Procedure OCP$INITCONSOLE requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:64   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:65   
          MINI XREF LISTING

INDEX_
         8**DCL         6--PROC     1082>>ASSIGN   1083>>ASSIGN   1084>>ASSIGN   1085>>ASSIGN   1086>>ASSIGN
      1087>>ASSIGN   1088>>ASSIGN   1089>>ASSIGN   1090>>ASSIGN   1091>>ASSIGN   1092>>ASSIGN   1093>>ASSIGN
      1094>>ASSIGN   1095>>ASSIGN   1096>>ASSIGN   1097>>ASSIGN   1098>>ASSIGN   1099>>ASSIGN   1100>>ASSIGN
      1101>>ASSIGN   1102>>ASSIGN   1103>>ASSIGN   1104>>ASSIGN   1105>>ASSIGN   1106>>ASSIGN   1107>>ASSIGN
      1108>>ASSIGN   1109>>ASSIGN   1110>>ASSIGN   1111>>ASSIGN
OC_CONSOLE.ACCT
      1038**DCL      1106<<ASSIGN
OC_CONSOLE.ACTIVE
      1037**DCL      1102<<ASSIGN
OC_CONSOLE.ATTR
      1034**DCL      1034--REDEF    1089<<ASSIGN
OC_CONSOLE.ATTRO
      1035**DCL      1035--REDEF    1091<<ASSIGN
OC_CONSOLE.ATTR_INPUT_SAVE
      1035**DCL      1090<<ASSIGN
OC_CONSOLE.ATTR_OUTPUT_SAVE
      1035**DCL      1092<<ASSIGN
OC_CONSOLE.BKSP
      1037**DCL      1100<<ASSIGN
OC_CONSOLE.CID
      1033**DCL      1034--REDEF    1087<<ASSIGN
OC_CONSOLE.DONT_TIME
      1038**DCL      1103<<ASSIGN
OC_CONSOLE.FIRST_READ
      1038**DCL      1104<<ASSIGN
OC_CONSOLE.FLAGS
      1036**DCL      1096<<ASSIGN
OC_CONSOLE.GHST
      1037**DCL      1097<<ASSIGN
OC_CONSOLE.GHSTRD
      1037**DCL      1098<<ASSIGN
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:66   
OC_CONSOLE.I_DCBNUM
      1036**DCL      1093<<ASSIGN
OC_CONSOLE.LOGON
      1033**DCL      1085<<ASSIGN
OC_CONSOLE.LP_WSN
      1033**DCL      1086<<ASSIGN
OC_CONSOLE.MXPRIO
      1071**DCL      1110<<ASSIGN
OC_CONSOLE.NATLANG
      1038**DCL      1105<<ASSIGN
OC_CONSOLE.NEXT
      1036**DCL      1095<<ASSIGN
OC_CONSOLE.PROFILE.COUNT
      1071**DCL      1108<<ASSIGN
OC_CONSOLE.PROFILE.TXT
      1071**DCL      1109<<ASSIGN
OC_CONSOLE.PROMPTS
      1038**DCL      1107<<ASSIGN
OC_CONSOLE.SHIFT
      1037**DCL      1099<<ASSIGN
OC_CONSOLE.STATION
      1032**DCL      1032--REDEF    1082<<ASSIGN
OC_CONSOLE.SYSID
      1034**DCL      1088<<ASSIGN
OC_CONSOLE.TERM_NAME
      1033**DCL      1083<<ASSIGN
OC_CONSOLE.TRANSAC_LAST_MIN
      1037**DCL      1101<<ASSIGN
OC_CONSOLE.VLR_HELP
      1055**DCL      1111<<ASSIGN
OC_CONSOLE.WSN
      1033**DCL      1084<<ASSIGN
OC_CONSOLE.X_DCBNUM
      1036**DCL      1094<<ASSIGN
OC_CONSOLE$
      1031**DCL      1032--IMP-PTR  1082>>ASSIGN   1083>>ASSIGN   1084>>ASSIGN   1085>>ASSIGN   1086>>ASSIGN
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:67   
      1087>>ASSIGN   1088>>ASSIGN   1089>>ASSIGN   1090>>ASSIGN   1091>>ASSIGN   1092>>ASSIGN   1093>>ASSIGN
      1094>>ASSIGN   1095>>ASSIGN   1096>>ASSIGN   1097>>ASSIGN   1098>>ASSIGN   1099>>ASSIGN   1100>>ASSIGN
      1101>>ASSIGN   1102>>ASSIGN   1103>>ASSIGN   1104>>ASSIGN   1105>>ASSIGN   1106>>ASSIGN   1107>>ASSIGN
      1108>>ASSIGN   1109>>ASSIGN   1110>>ASSIGN   1111>>ASSIGN
OC_DIR
      1074**DCL      1074--REDEF
OC_INTBIT
      1074**DCL      1075--REDEF
OC_INTMSG
       951**DCL       964--REDEF
OC_INTMSG.FLAGS
       958**DCL       959--REDEF
OC_INTMSG.MESS
       964**DCL       964--REDEF
OC_INTMSG.MSGID
       954**DCL       955--REDEF
OC_INTMSG.WSN
       961**DCL       962--REDEF
OC_MASK
      1075**DCL      1075--REDEF
OC_MESSBUF
       966**DCL       981--REDEF     995--REDEF
OC_MESSBUF.FLAGS
       973**DCL       974--REDEF
OC_MESSBUF.MESS
       979**DCL       979--REDEF
OC_MESSBUF.MSGID
       969**DCL       970--REDEF
OC_MESSBUF.WSN
       976**DCL       977--REDEF
OC_MESSBUF1.FLAGS
       988**DCL       989--REDEF
OC_MESSBUF1.LEN
       994**DCL       994--REDEF
OC_MESSBUF1.MSGID
       984**DCL       985--REDEF
PL6.E3A0      #002=OCP$INITCONSOLE File=OCP$PROCESS.:E05TSI                      WED 07/30/97 04:04 Page:68   
OC_MESSBUF1.WSN
       991**DCL       992--REDEF
OC_MSGBUFFER
       997**DCL      1012--REDEF
OC_MSGBUFFER.FLAGS
      1004**DCL      1005--REDEF
OC_MSGBUFFER.MESS
      1010**DCL      1010--REDEF
OC_MSGBUFFER.MSGID
      1000**DCL      1001--REDEF
OC_MSGBUFFER.WSN
      1007**DCL      1008--REDEF
OC_MSGBUFFER2.FLAGS
      1019**DCL      1020--REDEF
OC_MSGBUFFER2.MSGID
      1015**DCL      1016--REDEF
OC_MSGBUFFER2.WSN
      1022**DCL      1023--REDEF
OC_PARAM
      1030**DCL      1030--REDEF
OC_QUEUE.PARMC
      1029**DCL      1029--REDEF

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:69   
      352        1        /*M* OCP$ADDSTA KEYINs routine to logon consoles */
      353        2        /*T***********************************************************/
      354        3        /*T*                                                         */
      355        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      356        5        /*T*                                                         */
      357        6        /*T***********************************************************/
      358        7        %SET LISTSUB='1'B;
      359        8                                                /**/
      360        9        /*
      361       10         ###    ###   ####    #    ###   ####   ####    ###   #####   ###
      362       11        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #    #    #   #
      363       12        #   #  #      #   # # #   #   #  #   #  #   #  #        #    #   #
      364       13        #   #  #      ####   ###  #####  #   #  #   #   ###     #    #####
      365       14        #   #  #      #       # # #   #  #   #  #   #      #    #    #   #
      366       15        #   #  #   #  #      ###  #   #  #   #  #   #  #   #    #    #   #
      367       16         ###    ###   #       #   #   #  ####   ####    ###     #    #   #
      368       17                                                                   */
      369       18                                                /**/
      370       19                                                /**/
      371       20        OCP$ADDSTA: PROC (LPAR);
      372       21                                                /**/
      373       22                                                /**/
      374       23        %INCLUDE OC$INFO;
      375       79        %INCLUDE CP_6;
      376      160        %INCLUDE B_SEGIDS_C;
      377      699                                                /**/
      378      700                                                /**/
      379      701    1   DCL M$OCCG DCB;
      380      702    1   DCL M$CSCG DCB;
      381      703        %B$CGAURD (FPTN=LPAR,LAST=",",STCLASS=);
      382      722        %B$CGAUCI (FPTN=CNCT,LAST=",",LVL=2,STCLASS=);
      383      744        %OC$INFO  (FPTN=OCINFO,LVL=2);
      384      781    1   DCL CHAR_ CHAR(1) STATIC;
      385      782    1   DCL FLAG BIT(1) STATIC ALIGNED;
      386      783    1   DCL I UBIN WORD STATIC;
      387      784    1   DCL J UBIN WORD STATIC;
      388      785    1   DCL TOO_MANY CHAR(0) STATIC SYMDEF INIT(' Max consoles logged on');
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:70   
      389      786    1   DCL TEMP_BUF CHAR(80);
      390      787    1   DCL TEMP_SIZE UBIN WORD;
      391      788    1   DCL OCN$KEYIN ENTRY(3);
      392      789    1   DCL OCO$IWRITE ENTRY(8);
      393      790    1   DCL OCP$INITCONSOLE ENTRY(1);
      394      791    1   DCL OCL$INIT ENTRY(1);
      395      792    1   DCL OCL$WRITE_CONSOLE_REC ENTRY(5);
      396      793                                                /**/
      397      794    1   DCL TWSN_OUT CHAR(8) STATIC ALIGNED;
      398      795    1   DCL TERM_IN  CHAR(8) STATIC ALIGNED;
      399      796    1   DCL LOCAL_STATION CHAR(8) STATIC INIT('LOCAL   ');
      400      797                                                /**/
      401      798    1   DCL MSG# UBIN HALF STATIC UNAL;
      402      799        %INCLUDE OCI_SUBS_C;
      403      897                                                /**/
      404      898        %INCLUDE OC_DAT_R;
      405     1059        %INCLUDE OC_SUBS_C;
      406     1790                                                /**/
      407     1791                %VLP_STATION (FPTN=STA);
      408     1818                                                /**/
      409     1819             %FPT_ACTIVATE  (FPTN=DEACT,
      410     1820                                 DCB=M$OCCG,
      411     1821                                 STATION=STA,
      412     1822                                 DISCONNECT=YES);
      413     1845                                                /**/
      414     1846             %FPT_WRITE     (FPTN=WRITE,
      415     1847                                 DCB=M$OCCG,
      416     1848                                 STATION=STA,
      417     1849                                 BUF=TOO_MANY,
      418     1850                                 EVENT=OC_WRDN_O);
      419     1881                                                /**/
      420     1882             %FPT_EOM  (FPTN=EOM_SET,
      421     1883                            DCB=M$OCCG,
      422     1884                            STATION=STA,
      423     1885                            UTYPE=SEC,
      424     1886                            TIMEOUT=30);
      425     1916             %FPT_TRMISC    (FPTN=MAKE_BROAD,
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:71   
      426     1917                                 STATION=STA,
      427     1918                                 DCB=M$OCCG,
      428     1919                                 BROADCAST=YES);
      429     1940                                                /**/
      430     1941                                                /* Get another console table entry */
      431     1942             %FPT_GDS       (FPTN=GET_ENTRY,
      432     1943                                 FREE=YES,
      433     1944                                 RESULTS=CONS_SEG,
      434     1945                                 SEGSIZE="SIZEW(OC_CONSOLE(0))");
      435     1961                                                /**/
      436     1962             %VLP_VECTOR (FPTN=CONS_SEG,
      437     1963                                 SEGID=%DS5SID);
      438     1978                                                /**/
      439     1979             %FPT_READ      (FPTN=CS_READ,
      440     1980                                 DCB=M$CSCG,
      441     1981                                 WAIT=NO,
      442     1982                                 EVENT=OC_RDDN_C,
      443     1983                                 BUF=OC_MSGBUFFER);
      444     2022
      445     2023                                                /**/
      446     2024                                                /**/
      447     2025        /*
      448     2026             Begin O C P $ A D D S T A main
      449     2027                                                          */
      450     2028                                                /**/
      451     2029    1        FLAG = '1'B /*TRUE#*/;
      452     2030    1        IF OC_MAXCONSOLE = 0               /* FIRST CONSOLE */
      453     2031    1        THEN
      454     2032    1             CALL M$READ(CS_READ) ALTRET(OH_WELL);
      455     2033    1   OH_WELL: ;
      456     2034    1   A:
      457     2035    1        IF OC_#CONSOLES = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
              2035                 /* Max consoles logged on? */
      458     2036    1        THEN
      459     2037    2        DO;
      460     2038    2             CALL M$GDS(GET_ENTRY) ALTRET(NO_MORE);
      461     2039    2             OC_MAXCONSOLE = OC_MAXCONSOLE + 1;
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:72   
      462     2040    2             OC_CONSOLE.ATTR(OC_MAXCONSOLE) = '0'B; /* SET INACTIVE INDICATOR  */
      463     2041    2             OC_CONSOLE.ATTRO(OC_MAXCONSOLE) = '0'B;
      464     2042    2   NO_MORE:  ;
      465     2043    2             IF OC_#CONSOLES = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
      466     2044    2             THEN
      467     2045    3             DO;
      468     2046    3                  STA.STATION#=LPAR.STATION;
      469     2047    3                  CALL M$WRITE (WRITE) ALTRET (B);
      470     2048    3   B:             CALL M$DEACTIVATE (DEACT) ALTRET (C);
      471     2049    3   C:             RETURN;
      472     2050    3                END;
      473     2051    2           END;
      474     2052                                                /**/
      475     2053    1        OC_#CONSOLES = OC_#CONSOLES + 1;
      476     2054                                                /**/
      477     2055    2        DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      478     2056    2             IF OC_CONSOLE.ATTR(I) = '0'B AND OC_CONSOLE.ATTRO(I) = '0'B
      479     2057    2             THEN
      480     2058    3             DO;
      481     2059    3                  CALL OCP$INITCONSOLE(I);
      482     2060    3                  OC_CONSOLE.CID(I) = OC_CID;
      483     2061    3                  OC_CID = BITBIN (BINBIT (OC_CID + 1, 18) & '177777'O);
      484     2062    3                  OC_CONSOLE.STATION(I) = LPAR.STATION;
      485     2063    3                  OC_CONSOLE.TERM_NAME(I) = LPAR.OCINFO.TNAME;
      486     2064    3                  OC_CONSOLE.WSN(I) = LPAR.OCINFO.WSN;
      487     2065
      488     2066    3                  J = 8;
      489     2067
      490     2068    3                  CALL INDEX (J, '?', OC_CONSOLE.WSN(I));
      491     2069
      492     2070    3                  IF J = 8
      493     2071    3                  THEN
      494     2072    3                       OC_CONSOLE.LP_WSN(I) = OC_CONSOLE.WSN(I);
      495     2073    3                  ELSE
      496     2074    4                  DO;
      497     2075    4                       IF (SUBSTR(OC_CONSOLE.WSN(I),0,J) =
      498     2076    4                            SUBSTR(LOCAL_STATION,0,J))
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:73   
      499     2077    4                       THEN
      500     2078    5                       DO;
      501     2079    5                            OC_CONSOLE.LP_WSN(I) = 'LOCAL';
      502     2080    5                          END;
      503     2081
      504     2082    4                       ELSE
      505     2083    5                       DO;
      506     2084    5                            OC_CONSOLE.LP_WSN(I) =
      507     2085    5                                 OC_CONSOLE.TERM_NAME(I);
      508     2086    5                          END;
      509     2087
      510     2088    4                     END;                  /* DO IF NON-DETERMINATE */
      511     2089
      512     2090    3                  OC_CONSOLE.FIRST_READ(I) = '0'B /*FALSE#*/;
      513     2091    3                  OC_CONSOLE.I_DCBNUM(I) = 0;
      514     2092    3                  OC_CONSOLE.X_DCBNUM(I) = 0;
      515     2093    3                  OC_CONSOLE.SYSID(I) = 0;
      516     2094    3                  OC_CONSOLE.GHST (I) = '0'B /*FALSE#*/;
      517     2095    3                  OC_CONSOLE.GHSTRD(I) = '0'B /*FALSE#*/;
      518     2096    3                  OC_CONSOLE.TRANSAC_LAST_MIN(I) = '0'B /*FALSE#*/;
      519     2097    3                  IF LPAR.OCINFO.TNAME = LPAR.CNCT.WHO.ACCT
      520     2098    3                  THEN
      521     2099    3                       OC_CONSOLE.LOGON(I) = ' ';
      522     2100    3                  ELSE
      523     2101    3                       OC_CONSOLE.LOGON(I) = LPAR.CNCT.WHO.ACCT;
      524     2102                                                /**/
      525     2103    3                  OC_CONSOLE.FLAGS(I) = LPAR.CNCT.FLG;
      526     2104    3                  OC_CONSOLE.ACTIVE(I) = '1'B /*TRUE#*/;
      527     2105    3   TOO_BAD0:      ;
      528     2106                                                /**/
      529     2107                                                /**/
      530     2108    3                  OC_CONSOLE.SHIFT(I) = '0'B /*FALSE#*/;
      531     2109    3                  OC_CONSOLE.NATLANG(I) = LPAR.OCINFO.LANG;
      532     2110    3                  OC_CONSOLE.ACCT(I) = '        ';
      533     2111    3                  TEMP_BUF = LPAR.OCINFO.CMD;
      534     2112    3                  TEMP_SIZE = LPAR.OCINFO.CMDCNT;
      535     2113    3                  IF LPAR.OCINFO.CADDR ~= '0'B
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:74   
      536     2114    3                  THEN
      537     2115    4                  DO;
      538     2116    4                       OC_CONSOLE.ATTR_INPUT(I) = LPAR.OCINFO.KCADDR;
      539     2117    4                       OC_CONSOLE.ATTR_OUTPUT(I) = LPAR.OCINFO.CADDR;
      540     2118    4                     END;                  /* DO IF GOOD ADDRESS */
      541     2119    3                  ELSE
      542     2120    4                  DO;
      543     2121    4                       OC_CONSOLE.ATTR(I) = '000001'O;
      544     2122    4                       OC_CONSOLE.ATTRO(I) = '000001'O;
      545     2123    4                     END;                  /* DO IF PASSED 0 */
      546     2124    3                  OC_CONSOLE.MXPRIO(I) = LPAR.OCINFO.MXPRI;
      547     2125    3                  OC_CONSOLE.ATTR_INPUT_SAVE(I) =
      548     2126    3                       OC_CONSOLE.ATTR_INPUT(I);
      549     2127    3                  OC_CONSOLE.ATTR_OUTPUT_SAVE(I) =
      550     2128    3                       OC_CONSOLE.ATTR_OUTPUT(I);
      551     2129    3                  IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */) ~='0'B
      552     2130    3                  THEN
      553     2131    4                  DO;
      554     2132    4                       FLAG = '0'B /*FALSE#*/;
      555     2133    4                       OC_CONSOLE.DONT_TIME(I) = '1'B /*TRUE#*/;
      556     2134    4                     END;                  /* DO IF SLAVE */
      557     2135    3                  ELSE
      558     2136    3                       OC_CONSOLE.DONT_TIME(I) = '0'B /*FALSE#*/;
      559     2137                                                /**/
      560     2138                                           /* Initialize the console's
      561     2139                                                ghost_prompt table */
      562     2140    4                  DO J = 0 TO 2;
      563     2141    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->
      564     2142    4                            PROMPT_TABLE.LAST_READ(J)
      565     2143    4                            = '0'B /*FALSE#*/;
      566     2144    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->
      567     2145    4                            PROMPT_TABLE.COUNT_(J)
      568     2146    4                            = 1;
      569     2147    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->
      570     2148    4                            PROMPT_TABLE.PROMPT(J)
      571     2149    4                            = '?';
      572     2150    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:75   
      573     2151    4                            PROMPT_TABLE.SIZER(J)
      574     2152    4                            = 0;
      575     2153    4                     END;                  /* DO J = 0 TO 2 */
      576     2154    3                  IF (SUBSTR(OC_CONSOLE.STATION(I),0,2) = 'SC')
      577     2155    3                  THEN
      578     2156    4                  DO;
      579     2157    4                       OC_CONSOLE.ATTR(I) = OC_CONSOLE.ATTR(I) | '000004'O
              2157                                /* K_IOMCON */ ;
      580     2158    4                       OC_CONSOLE.ATTRO(I) = OC_CONSOLE.ATTRO(I) | '000004'O
              2158                                /* K_IOMCON */ ;
      581     2159    4                       OC_CONSOLE.SHIFT(I) = '1'B /*TRUE#*/;
      582     2160    4                       OC_CONSOLE.LOGON(I) = ' ';
      583     2161    4                     END;                  /* DO IF SYSTEM CONTROL CONSOLE */
      584     2162    3                  ELSE
      585     2163    4                  DO;
      586     2164    4                       STA.STATION# = OC_CONSOLE.STATION(I);
      587     2165    4                       CALL M$EOM (EOM_SET) ALTRET(TOO_BAD);
      588     2166    4   TOO_BAD:            ;
      589     2167    4                       IF OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */
      590     2168    4                       THEN
      591     2169    5                       DO;
      592     2170    5                          END;             /* NULL DO IF SLAVE */
      593     2171    4                       ELSE
      594     2172    5                       DO;
      595     2173                                                /** STAR 516 **/
      596     2174                                                /* Make broadcast/sendall
      597     2175                                                     legal to non-slave term
      598     2176                                                     on OCCG */
      599     2177    5                            CALL M$TRMISC (MAKE_BROAD) ALTRET (EH_AT_12);
      600     2178    5   EH_AT_12:                ;
      601     2179    5                          END;             /* DO IF SLAVE NOT SET */
      602     2180                                                /**/
      603     2181    4                     END;                  /* DO IF FEP CONS */
      604     2182    3                  OC_CONSOLE.PROFILE.COUNT(I) = 0;
      605     2183    3                  OC_CONSOLE.PROFILE.TXT(I) = ' ';
      606     2184                                                /**/
      607     2185                                                /**/
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:76   
      608     2186    3                  IF OC_FIRST_CONSOLE
      609     2187    3                  THEN
      610     2188    4                  DO;
      611     2189    4                       OC_FIRST_CONSOLE = '0'B;
      612     2190    4                       CALL OCL$INIT (2 /* FROM_OCP# */);
      613     2191    4                     END;
      614     2192                                                /**/
      615     2193    3                  IF OC_LIST
      616     2194    3                  THEN
      617     2195    3                       CALL OCL$WRITE_CONSOLE_REC (, , 1 /* ONE_CONSOLE# */, 2
              2195                                /* CONSOLE_ON# */, I);
      618     2196                                                /**/
      619     2197    3                  IF FLAG
      620     2198    3                  THEN
      621     2199    4                  DO;
      622     2200    4                       MSG# = 394 /* LOGGED_ON_MSG# */;
      623     2201    4                       CALL OCO$IWRITE (
      624     2202    4                            BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
      625     2203    4                            MSG#, '001'O, '010'O, OC_CONSOLE.TERM_NAME(I),
      626     2204    4                            0, OC_CONSOLE.STATION(I), 0);
      627     2205    4                       IF TEMP_SIZE ~= 0 THEN
      628     2206    4                            CALL OCN$KEYIN(TEMP_BUF,TEMP_SIZE,
      629     2207    4                                 OC_CONSOLE.STATION(I));
      630     2208    4                     END;                  /* DO IF NORMAL LOG_ON */
      631     2209    3                  I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      632     2210    3                END;
      633     2211    2           END;
      634     2212    1        RETURN;
      635     2213    1   END OCP$ADDSTA;
      636     2214        %EOD;

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:77   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC$INFO.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$ADDSTA.

   Procedure OCP$ADDSTA requires 498 words for executable code.
   Procedure OCP$ADDSTA requires 36 words of local(AUTO) storage.

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:78   

 Object Unit name= OCP$ADDSTA                                 File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:04:41.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$OCCG
    2   DCB   even  none     0      0  M$CSCG
    3   Data  even  none    92    134  OCP$ADDSTA
    4  RoData even  UTS      5      5  OCP$ADDSTA
    5   Proc  even  none   498    762  OCP$ADDSTA
    6  RoData even  none    17     21  OCP$ADDSTA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        1  OCP$ADDSTA

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    3      4  TOO_MANY
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:79   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 OCL$INIT
         yes           Std       5 OCL$WRITE_CONSOLE_REC
         yes           Std       3 OCN$KEYIN
         yes           Std       1 OCP$INITCONSOLE
         yes           Std       8 OCO$IWRITE
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$OCCG                                M$CSCG
     OC_INTMSG                             OC_MESSBUF                            OC_MSGBUFFER
     OC_#CONSOLES                          OC_CID                                OC_PARAM
     OC_CONSOLE$                           OC_MAXCONSOLE                         OC_DIR
     OC_INTBIT                             OC_MASK                               OC_LIST
     OC_FIRST_CONSOLE                      B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:80   


      352        1        /*M* OCP$ADDSTA KEYINs routine to logon consoles */
      353        2        /*T***********************************************************/
      354        3        /*T*                                                         */
      355        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      356        5        /*T*                                                         */
      357        6        /*T***********************************************************/
      358        7        %SET LISTSUB='1'B;
      359        8                                                /**/
      360        9        /*
      361       10         ###    ###   ####    #    ###   ####   ####    ###   #####   ###
      362       11        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #    #    #   #
      363       12        #   #  #      #   # # #   #   #  #   #  #   #  #        #    #   #
      364       13        #   #  #      ####   ###  #####  #   #  #   #   ###     #    #####
      365       14        #   #  #      #       # # #   #  #   #  #   #      #    #    #   #
      366       15        #   #  #   #  #      ###  #   #  #   #  #   #  #   #    #    #   #
      367       16         ###    ###   #       #   #   #  ####   ####    ###     #    #   #
      368       17                                                                   */
      369       18                                                /**/
      370       19                                                /**/
      371       20        OCP$ADDSTA: PROC (LPAR);

     20  5 000000   000000 700200 xent  OCP$ADDSTA   TSX0  ! X66_AUTO_1
         5 000001   000044 000001                    ZERO    36,1

      372       21                                                /**/
      373       22                                                /**/
      374       23        %INCLUDE OC$INFO;
      375       79        %INCLUDE CP_6;
      376      160        %INCLUDE B_SEGIDS_C;
      377      699                                                /**/
      378      700                                                /**/
      379      701    1   DCL M$OCCG DCB;
      380      702    1   DCL M$CSCG DCB;
      381      703        %B$CGAURD (FPTN=LPAR,LAST=",",STCLASS=);
      382      722        %B$CGAUCI (FPTN=CNCT,LAST=",",LVL=2,STCLASS=);
      383      744        %OC$INFO  (FPTN=OCINFO,LVL=2);
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:81   
      384      781    1   DCL CHAR_ CHAR(1) STATIC;
      385      782    1   DCL FLAG BIT(1) STATIC ALIGNED;
      386      783    1   DCL I UBIN WORD STATIC;
      387      784    1   DCL J UBIN WORD STATIC;
      388      785    1   DCL TOO_MANY CHAR(0) STATIC SYMDEF INIT(' Max consoles logged on');
      389      786    1   DCL TEMP_BUF CHAR(80);
      390      787    1   DCL TEMP_SIZE UBIN WORD;
      391      788    1   DCL OCN$KEYIN ENTRY(3);
      392      789    1   DCL OCO$IWRITE ENTRY(8);
      393      790    1   DCL OCP$INITCONSOLE ENTRY(1);
      394      791    1   DCL OCL$INIT ENTRY(1);
      395      792    1   DCL OCL$WRITE_CONSOLE_REC ENTRY(5);
      396      793                                                /**/
      397      794    1   DCL TWSN_OUT CHAR(8) STATIC ALIGNED;
      398      795    1   DCL TERM_IN  CHAR(8) STATIC ALIGNED;
      399      796    1   DCL LOCAL_STATION CHAR(8) STATIC INIT('LOCAL   ');
      400      797                                                /**/
      401      798    1   DCL MSG# UBIN HALF STATIC UNAL;
      402      799        %INCLUDE OCI_SUBS_C;
      403      897                                                /**/
      404      898        %INCLUDE OC_DAT_R;
      405     1059        %INCLUDE OC_SUBS_C;
      406     1790                                                /**/
      407     1791                %VLP_STATION (FPTN=STA);
      408     1818                                                /**/
      409     1819             %FPT_ACTIVATE  (FPTN=DEACT,
      410     1820                                 DCB=M$OCCG,
      411     1821                                 STATION=STA,
      412     1822                                 DISCONNECT=YES);
      413     1845                                                /**/
      414     1846             %FPT_WRITE     (FPTN=WRITE,
      415     1847                                 DCB=M$OCCG,
      416     1848                                 STATION=STA,
      417     1849                                 BUF=TOO_MANY,
      418     1850                                 EVENT=OC_WRDN_O);
      419     1881                                                /**/
      420     1882             %FPT_EOM  (FPTN=EOM_SET,
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:82   
      421     1883                            DCB=M$OCCG,
      422     1884                            STATION=STA,
      423     1885                            UTYPE=SEC,
      424     1886                            TIMEOUT=30);
      425     1916             %FPT_TRMISC    (FPTN=MAKE_BROAD,
      426     1917                                 STATION=STA,
      427     1918                                 DCB=M$OCCG,
      428     1919                                 BROADCAST=YES);
      429     1940                                                /**/
      430     1941                                                /* Get another console table entry */
      431     1942             %FPT_GDS       (FPTN=GET_ENTRY,
      432     1943                                 FREE=YES,
      433     1944                                 RESULTS=CONS_SEG,
      434     1945                                 SEGSIZE="SIZEW(OC_CONSOLE(0))");
      435     1961                                                /**/
      436     1962             %VLP_VECTOR (FPTN=CONS_SEG,
      437     1963                                 SEGID=%DS5SID);
      438     1978                                                /**/
      439     1979             %FPT_READ      (FPTN=CS_READ,
      440     1980                                 DCB=M$CSCG,
      441     1981                                 WAIT=NO,
      442     1982                                 EVENT=OC_RDDN_C,
      443     1983                                 BUF=OC_MSGBUFFER);
      444     2022
      445     2023                                                /**/
      446     2024                                                /**/
      447     2025        /*
      448     2026             Begin O C P $ A D D S T A main
      449     2027                                                          */
      450     2028                                                /**/
      451     2029    1        FLAG = '1'B /*TRUE#*/;

   2029  5 000002   400000 236003                    LDQ     -131072,DU
         5 000003   000001 756000 3                  STQ     FLAG

      452     2030    1        IF OC_MAXCONSOLE = 0               /* FIRST CONSOLE */

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:83   
   2030  5 000004   000000 220000 xsym               LDX0    OC_MAXCONSOLE
         5 000005   000012 601000 5                  TNZ     OH_WELL

      453     2031    1        THEN
      454     2032    1             CALL M$READ(CS_READ) ALTRET(OH_WELL);

   2032  5 000006   000116 630400 3                  EPPR0   CS_READ
         5 000007   440000 713400                    CLIMB   alt,read
         5 000010   401400 401760                    pmme    nvectors=4
         5 000011   000012 702000 5                  TSX2    OH_WELL

   2030  5 000012                       OH_WELL      null
      455     2033    1   OH_WELL: ;
      456     2034    1   A:
      457     2035    1        IF OC_#CONSOLES = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
              2035                 /* Max consoles logged on? */

   2035  5 000012   000000 236000 xsym  A            LDQ     OC_MAXCONSOLE
         5 000013   000022 772000                    QRL     18
         5 000014   000001 036007                    ADLQ    1,DL
         5 000015   000000 116000 xsym               CMPQ    OC_#CONSOLES
         5 000016   000063 601000 5                  TNZ     s:2053

      458     2036    1        THEN
      459     2037    2        DO;

      460     2038    2             CALL M$GDS(GET_ENTRY) ALTRET(NO_MORE);

   2038  5 000017   000106 630400 3                  EPPR0   GET_ENTRY
         5 000020   430001 713400                    CLIMB   alt,gds
         5 000021   400400 401760                    pmme    nvectors=2
         5 000022   000041 702000 5                  TSX2    NO_MORE

      461     2039    2             OC_MAXCONSOLE = OC_MAXCONSOLE + 1;

   2039  5 000023   000000 220000 xsym               LDX0    OC_MAXCONSOLE
         5 000024   000001 621010                    EAX1    1,X0
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:84   
         5 000025   000000 741000 xsym               STX1    OC_MAXCONSOLE

      462     2040    2             OC_CONSOLE.ATTR(OC_MAXCONSOLE) = '0'B; /* SET INACTIVE INDICATOR  */

   2040  5 000026   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         5 000027   000022 772000                    QRL     18
         5 000030   000076 402007                    MPY     62,DL
         5 000031   000000 220003                    LDX0    0,DU
         5 000032   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000033   000013 740106                    STX0    11,QL,PR0

      463     2041    2             OC_CONSOLE.ATTRO(OC_MAXCONSOLE) = '0'B;

   2041  5 000034   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         5 000035   000022 772000                    QRL     18
         5 000036   000076 402007                    MPY     62,DL
         5 000037   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000040   000014 740106                    STX0    12,QL,PR0

   2041  5 000041                       NO_MORE      null
      464     2042    2   NO_MORE:  ;
      465     2043    2             IF OC_#CONSOLES = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */

   2043  5 000041   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         5 000042   000022 772000                    QRL     18
         5 000043   000001 036007                    ADLQ    1,DL
         5 000044   000000 116000 xsym               CMPQ    OC_#CONSOLES
         5 000045   000063 601000 5                  TNZ     s:2053

      466     2044    2             THEN
      467     2045    3             DO;

      468     2046    3                  STA.STATION#=LPAR.STATION;

   2046  5 000046   200003 470500                    LDP0    @LPAR,,AUTO
         5 000047   040000 100500                    MLR     fill='040'O
         5 000050   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:85   
         5 000051   000021 000010 3                  ADSC9   STA                      cn=0,n=8

      469     2047    3                  CALL M$WRITE (WRITE) ALTRET (B);

   2047  5 000052   000052 630400 3                  EPPR0   WRITE
         5 000053   440001 713400                    CLIMB   alt,write
         5 000054   401400 401760                    pmme    nvectors=4
         5 000055   000056 702000 5                  TSX2    B

      470     2048    3   B:             CALL M$DEACTIVATE (DEACT) ALTRET (C);

   2048  5 000056   000032 630400 3     B            EPPR0   DEACT
         5 000057   500001 713400                    CLIMB   alt,+32769
         5 000060   401400 401760                    pmme    nvectors=4
         5 000061   000062 702000 5                  TSX2    C

      471     2049    3   C:             RETURN;

   2049  5 000062   000000 702200 xent  C            TSX2  ! X66_ARET

      472     2050    3                END;
      473     2051    2           END;
      474     2052                                                /**/
      475     2053    1        OC_#CONSOLES = OC_#CONSOLES + 1;

   2053  5 000063   000000 054000 xsym               AOS     OC_#CONSOLES

      476     2054                                                /**/
      477     2055    2        DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   2055  5 000064   000001 235007                    LDA     1,DL
         5 000065   000002 755000 3                  STA     I
         5 000066   000755 710000 5                  TRA     s:2211+3

      478     2056    2             IF OC_CONSOLE.ATTR(I) = '0'B AND OC_CONSOLE.ATTRO(I) = '0'B

   2056  5 000067   000002 236000 3                  LDQ     I
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:86   
         5 000070   000076 402007                    MPY     62,DL
         5 000071   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000072   000013 220106                    LDX0    11,QL,PR0
         5 000073   000752 601000 5                  TNZ     s:2211
         5 000074   000014 221106                    LDX1    12,QL,PR0
         5 000075   000752 601000 5                  TNZ     s:2211

      479     2057    2             THEN
      480     2058    3             DO;

      481     2059    3                  CALL OCP$INITCONSOLE(I);

   2059  5 000076   000000 630400 6                  EPPR0   0
         5 000077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000100   000000 701000 xent               TSX1    OCP$INITCONSOLE
         5 000101   000000 011000                    NOP     0

      482     2060    3                  OC_CONSOLE.CID(I) = OC_CID;

   2060  5 000102   000002 236000 3                  LDQ     I
         5 000103   000076 402007                    MPY     62,DL
         5 000104   000000 220000 xsym               LDX0    OC_CID
         5 000105   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000106   000012 740106                    STX0    10,QL,PR0

      483     2061    3                  OC_CID = BITBIN (BINBIT (OC_CID + 1, 18) & '177777'O);

   2061  5 000107   000000 236000 xsym               LDQ     OC_CID
         5 000110   000022 772000                    QRL     18
         5 000111   000001 036007                    ADLQ    1,DL
         5 000112   000022 736000                    QLS     18
         5 000113   000022 772000                    QRL     18
         5 000114   000000 620006                    EAX0    0,QL
         5 000115   177777 360003                    ANX0    65535,DU
         5 000116   000000 636010                    EAQ     0,X0
         5 000117   000022 772000                    QRL     18
         5 000120   000000 620006                    EAX0    0,QL
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:87   
         5 000121   000000 740000 xsym               STX0    OC_CID

      484     2062    3                  OC_CONSOLE.STATION(I) = LPAR.STATION;

   2062  5 000122   000002 236000 3                  LDQ     I
         5 000123   000076 402007                    MPY     62,DL
         5 000124   000002 736000                    QLS     2
         5 000125   200003 470500                    LDP0    @LPAR,,AUTO
         5 000126   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000127   040106 100500                    MLR     fill='040'O
         5 000130   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         5 000131   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=8

      485     2063    3                  OC_CONSOLE.TERM_NAME(I) = LPAR.OCINFO.TNAME;

   2063  5 000132   000002 236000 3                  LDQ     I
         5 000133   000076 402007                    MPY     62,DL
         5 000134   000002 736000                    QLS     2
         5 000135   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000136   040106 100500                    MLR     fill='040'O
         5 000137   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         5 000140   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8

      486     2064    3                  OC_CONSOLE.WSN(I) = LPAR.OCINFO.WSN;

   2064  5 000141   000002 236000 3                  LDQ     I
         5 000142   000076 402007                    MPY     62,DL
         5 000143   000002 736000                    QLS     2
         5 000144   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000145   040106 100500                    MLR     fill='040'O
         5 000146   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         5 000147   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8

      487     2065
      488     2066    3                  J = 8;

   2066  5 000150   000010 235007                    LDA     8,DL
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:88   
         5 000151   000003 755000 3                  STA     J

      489     2067
      490     2068    3                  CALL INDEX (J, '?', OC_CONSOLE.WSN(I));

   2068  5 000152   000002 236000 3                  LDQ     I
         5 000153   000370 402007                    MPY     248,DL
         5 000154   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000155   000000 124506                    SCM     mask='000'O
         5 000156   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         5 000157   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 000160   000003 000000 3                  ARG     J

      491     2069
      492     2070    3                  IF J = 8

   2070  5 000161   000003 235000 3                  LDA     J
         5 000162   000010 115007                    CMPA    8,DL
         5 000163   000177 601000 5                  TNZ     s:2075

      493     2071    3                  THEN
      494     2072    3                       OC_CONSOLE.LP_WSN(I) = OC_CONSOLE.WSN(I);

   2072  5 000164   000002 236000 3                  LDQ     I
         5 000165   000076 402007                    MPY     62,DL
         5 000166   000000 620006                    EAX0    0,QL
         5 000167   000002 236000 3                  LDQ     I
         5 000170   000370 402007                    MPY     248,DL
         5 000171   000000 635010                    EAA     0,X0
         5 000172   000020 771000                    ARL     16
         5 000173   040105 100506                    MLR     fill='040'O
         5 000174   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         5 000175   100010 000010                    ADSC9   8,A,PR1                  cn=0,n=8
         5 000176   000226 710000 5                  TRA     s:2090

      495     2073    3                  ELSE
      496     2074    4                  DO;
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:89   

      497     2075    4                       IF (SUBSTR(OC_CONSOLE.WSN(I),0,J) =

   2075  5 000177   000000 620005                    EAX0    0,AL
         5 000200   000003 721000 3                  LXL1    J
         5 000201   040040 106546                    CMPC    fill='040'O
         5 000202   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=*X0
         5 000203   000016 000011 3                  ADSC9   LOCAL_STATION            cn=0,n=*X1
         5 000204   000214 601000 5                  TNZ     s:2084

      498     2076    4                            SUBSTR(LOCAL_STATION,0,J))
      499     2077    4                       THEN
      500     2078    5                       DO;

      501     2079    5                            OC_CONSOLE.LP_WSN(I) = 'LOCAL';

   2079  5 000205   000002 236000 3                  LDQ     I
         5 000206   000076 402007                    MPY     62,DL
         5 000207   000002 736000                    QLS     2
         5 000210   040106 100400                    MLR     fill='040'O
         5 000211   000000 000005 4                  ADSC9   0                        cn=0,n=5
         5 000212   100010 000010                    ADSC9   8,Q,PR1                  cn=0,n=8

      502     2080    5                          END;

   2080  5 000213   000226 710000 5                  TRA     s:2090

      503     2081
      504     2082    4                       ELSE
      505     2083    5                       DO;

      506     2084    5                            OC_CONSOLE.LP_WSN(I) =

   2084  5 000214   000002 236000 3                  LDQ     I
         5 000215   000076 402007                    MPY     62,DL
         5 000216   000000 620006                    EAX0    0,QL
         5 000217   000002 236000 3                  LDQ     I
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:90   
         5 000220   000370 402007                    MPY     248,DL
         5 000221   000000 635010                    EAA     0,X0
         5 000222   000020 771000                    ARL     16
         5 000223   040105 100506                    MLR     fill='040'O
         5 000224   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         5 000225   100010 000010                    ADSC9   8,A,PR1                  cn=0,n=8

      507     2085    5                                 OC_CONSOLE.TERM_NAME(I);
      508     2086    5                          END;

      509     2087
      510     2088    4                     END;                  /* DO IF NON-DETERMINATE */

      511     2089
      512     2090    3                  OC_CONSOLE.FIRST_READ(I) = '0'B /*FALSE#*/;

   2090  5 000226   000002 236000 3                  LDQ     I
         5 000227   000076 402007                    MPY     62,DL
         5 000230   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000231   000000 620006                    EAX0    0,QL
         5 000232   000002 236000 6                  LDQ     2
         5 000233   100017 356110                    ANSQ    15,X0,PR1

      513     2091    3                  OC_CONSOLE.I_DCBNUM(I) = 0;

   2091  5 000234   000002 236000 3                  LDQ     I
         5 000235   000076 402007                    MPY     62,DL
         5 000236   000000 220003                    LDX0    0,DU
         5 000237   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000240   100015 740106                    STX0    13,QL,PR1

      514     2092    3                  OC_CONSOLE.X_DCBNUM(I) = 0;

   2092  5 000241   000002 236000 3                  LDQ     I
         5 000242   000076 402007                    MPY     62,DL
         5 000243   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000244   100015 440106                    SXL0    13,QL,PR1
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:91   

      515     2093    3                  OC_CONSOLE.SYSID(I) = 0;

   2093  5 000245   000002 236000 3                  LDQ     I
         5 000246   000076 402007                    MPY     62,DL
         5 000247   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000250   100012 440106                    SXL0    10,QL,PR1

      516     2094    3                  OC_CONSOLE.GHST (I) = '0'B /*FALSE#*/;

   2094  5 000251   000002 236000 3                  LDQ     I
         5 000252   000076 402007                    MPY     62,DL
         5 000253   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000254   000000 621006                    EAX1    0,QL
         5 000255   000003 236000 6                  LDQ     3
         5 000256   100017 356111                    ANSQ    15,X1,PR1

      517     2095    3                  OC_CONSOLE.GHSTRD(I) = '0'B /*FALSE#*/;

   2095  5 000257   000002 236000 3                  LDQ     I
         5 000260   000076 402007                    MPY     62,DL
         5 000261   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000262   000000 621006                    EAX1    0,QL
         5 000263   000004 236000 6                  LDQ     4
         5 000264   100017 356111                    ANSQ    15,X1,PR1

      518     2096    3                  OC_CONSOLE.TRANSAC_LAST_MIN(I) = '0'B /*FALSE#*/;

   2096  5 000265   000002 236000 3                  LDQ     I
         5 000266   000076 402007                    MPY     62,DL
         5 000267   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000270   000000 621006                    EAX1    0,QL
         5 000271   000005 236000 6                  LDQ     5
         5 000272   100017 356111                    ANSQ    15,X1,PR1

      519     2097    3                  IF LPAR.OCINFO.TNAME = LPAR.CNCT.WHO.ACCT

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:92   
   2097  5 000273   040100 106500                    CMPC    fill='040'O
         5 000274   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         5 000275   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         5 000276   000311 601000 5                  TNZ     s:2101

      520     2098    3                  THEN
      521     2099    3                       OC_CONSOLE.LOGON(I) = ' ';

   2099  5 000277   000002 236000 3                  LDQ     I
         5 000300   000076 402007                    MPY     62,DL
         5 000301   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000302   000000 621006                    EAX1    0,QL
         5 000303   000000 622006                    EAX2    0,QL
         5 000304   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000305   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000306   100006 755111                    STA     6,X1,PR1
         5 000307   100007 756112                    STQ     7,X2,PR1
         5 000310   000320 710000 5                  TRA     s:2103

      522     2100    3                  ELSE
      523     2101    3                       OC_CONSOLE.LOGON(I) = LPAR.CNCT.WHO.ACCT;

   2101  5 000311   000002 236000 3                  LDQ     I
         5 000312   000076 402007                    MPY     62,DL
         5 000313   000002 736000                    QLS     2
         5 000314   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000315   040106 100500                    MLR     fill='040'O
         5 000316   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         5 000317   100006 000010                    ADSC9   6,Q,PR1                  cn=0,n=8

      524     2102                                                /**/
      525     2103    3                  OC_CONSOLE.FLAGS(I) = LPAR.CNCT.FLG;

   2103  5 000320   000002 236000 3                  LDQ     I
         5 000321   000076 402007                    MPY     62,DL
         5 000322   000100 100500                    MLR     fill='000'O
         5 000323   000014 000001                    ADSC9   12,,PR0                  cn=0,n=1
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:93   
         5 000324   200032 000004                    ADSC9   TEMP_SIZE+2,,AUTO        cn=0,n=4
         5 000325   200032 221100                    LDX1    TEMP_SIZE+2,,AUTO
         5 000326   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000327   100017 741106                    STX1    15,QL,PR1

      526     2104    3                  OC_CONSOLE.ACTIVE(I) = '1'B /*TRUE#*/;

   2104  5 000330   000002 236000 3                  LDQ     I
         5 000331   000076 402007                    MPY     62,DL
         5 000332   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000333   000000 621006                    EAX1    0,QL
         5 000334   010000 236007                    LDQ     4096,DL
         5 000335   100017 256111                    ORSQ    15,X1,PR1

   2104  5 000336                       TOO_BAD0     null
      527     2105    3   TOO_BAD0:      ;
      528     2106                                                /**/
      529     2107                                                /**/
      530     2108    3                  OC_CONSOLE.SHIFT(I) = '0'B /*FALSE#*/;

   2108  5 000336   000002 236000 3                  LDQ     I
         5 000337   000076 402007                    MPY     62,DL
         5 000340   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000341   000000 621006                    EAX1    0,QL
         5 000342   000006 236000 6                  LDQ     6
         5 000343   100017 356111                    ANSQ    15,X1,PR1

      531     2109    3                  OC_CONSOLE.NATLANG(I) = LPAR.OCINFO.LANG;

   2109  5 000344   000002 236000 3                  LDQ     I
         5 000345   000076 402007                    MPY     62,DL
         5 000346   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000347   000000 621006                    EAX1    0,QL
         5 000350   000015 236100                    LDQ     13,,PR0
         5 000351   000011 772000                    QRL     9
         5 000352   100017 676111                    ERQ     15,X1,PR1
         5 000353   000777 376007                    ANQ     511,DL
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:94   
         5 000354   100017 656111                    ERSQ    15,X1,PR1

      532     2110    3                  OC_CONSOLE.ACCT(I) = '        ';

   2110  5 000355   000002 236000 3                  LDQ     I
         5 000356   000076 402007                    MPY     62,DL
         5 000357   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000360   000000 621006                    EAX1    0,QL
         5 000361   000000 622006                    EAX2    0,QL
         5 000362   000002 237000 4                  LDAQ    2
         5 000363   100020 755111                    STA     16,X1,PR1
         5 000364   100021 756112                    STQ     17,X2,PR1

      533     2111    3                  TEMP_BUF = LPAR.OCINFO.CMD;

   2111  5 000365   040100 100500                    MLR     fill='040'O
         5 000366   000025 000120                    ADSC9   21,,PR0                  cn=0,n=80
         5 000367   200004 000120                    ADSC9   TEMP_BUF,,AUTO           cn=0,n=80

      534     2112    3                  TEMP_SIZE = LPAR.OCINFO.CMDCNT;

   2112  5 000370   000024 235100                    LDA     20,,PR0
         5 000371   200030 755100                    STA     TEMP_SIZE,,AUTO

      535     2113    3                  IF LPAR.OCINFO.CADDR ~= '0'B

   2113  5 000372   000015 221100                    LDX1    13,,PR0
         5 000373   000407 600000 5                  TZE     s:2121

      536     2114    3                  THEN
      537     2115    4                  DO;

      538     2116    4                       OC_CONSOLE.ATTR_INPUT(I) = LPAR.OCINFO.KCADDR;

   2116  5 000374   000002 236000 3                  LDQ     I
         5 000375   000076 402007                    MPY     62,DL
         5 000376   000016 222100                    LDX2    14,,PR0
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:95   
         5 000377   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000400   100013 742106                    STX2    11,QL,PR1

      539     2117    4                       OC_CONSOLE.ATTR_OUTPUT(I) = LPAR.OCINFO.CADDR;

   2117  5 000401   000002 236000 3                  LDQ     I
         5 000402   000076 402007                    MPY     62,DL
         5 000403   000015 221100                    LDX1    13,,PR0
         5 000404   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000405   100014 741106                    STX1    12,QL,PR1

      540     2118    4                     END;                  /* DO IF GOOD ADDRESS */

   2118  5 000406   000420 710000 5                  TRA     s:2124

      541     2119    3                  ELSE
      542     2120    4                  DO;

      543     2121    4                       OC_CONSOLE.ATTR(I) = '000001'O;

   2121  5 000407   000002 236000 3                  LDQ     I
         5 000410   000076 402007                    MPY     62,DL
         5 000411   000001 222003                    LDX2    1,DU
         5 000412   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000413   100013 742106                    STX2    11,QL,PR1

      544     2122    4                       OC_CONSOLE.ATTRO(I) = '000001'O;

   2122  5 000414   000002 236000 3                  LDQ     I
         5 000415   000076 402007                    MPY     62,DL
         5 000416   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000417   100014 742106                    STX2    12,QL,PR1

      545     2123    4                     END;                  /* DO IF PASSED 0 */

      546     2124    3                  OC_CONSOLE.MXPRIO(I) = LPAR.OCINFO.MXPRI;

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:96   
   2124  5 000420   000002 236000 3                  LDQ     I
         5 000421   000076 402007                    MPY     62,DL
         5 000422   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000423   000000 621006                    EAX1    0,QL
         5 000424   000015 236100                    LDQ     13,,PR0
         5 000425   000777 376007                    ANQ     511,DL
         5 000426   000033 736000                    QLS     27
         5 000427   100075 756111                    STQ     61,X1,PR1

      547     2125    3                  OC_CONSOLE.ATTR_INPUT_SAVE(I) =

   2125  5 000430   000002 236000 3                  LDQ     I
         5 000431   000076 402007                    MPY     62,DL
         5 000432   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000433   100013 221106                    LDX1    11,QL,PR1
         5 000434   100013 441106                    SXL1    11,QL,PR1

      548     2126    3                       OC_CONSOLE.ATTR_INPUT(I);
      549     2127    3                  OC_CONSOLE.ATTR_OUTPUT_SAVE(I) =

   2127  5 000435   000002 236000 3                  LDQ     I
         5 000436   000076 402007                    MPY     62,DL
         5 000437   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000440   100014 221106                    LDX1    12,QL,PR1
         5 000441   100014 441106                    SXL1    12,QL,PR1

      550     2128    3                       OC_CONSOLE.ATTR_OUTPUT(I);
      551     2129    3                  IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */) ~='0'B

   2129  5 000442   000002 236000 3                  LDQ     I
         5 000443   000076 402007                    MPY     62,DL
         5 000444   000000 471400 xsym               LDP1    OC_CONSOLE$
         5 000445   100013 221106                    LDX1    11,QL,PR1
         5 000446   002000 361003                    ANX1    1024,DU
         5 000447   000455 600000 5                  TZE     s:2136

      552     2130    3                  THEN
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:97   
      553     2131    4                  DO;

      554     2132    4                       FLAG = '0'B /*FALSE#*/;

   2132  5 000450   000001 450000 3                  STZ     FLAG

      555     2133    4                       OC_CONSOLE.DONT_TIME(I) = '1'B /*TRUE#*/;

   2133  5 000451   000000 621006                    EAX1    0,QL
         5 000452   004000 236007                    LDQ     2048,DL
         5 000453   100017 256111                    ORSQ    15,X1,PR1

      556     2134    4                     END;                  /* DO IF SLAVE */

   2134  5 000454   000460 710000 5                  TRA     s:2140

      557     2135    3                  ELSE
      558     2136    3                       OC_CONSOLE.DONT_TIME(I) = '0'B /*FALSE#*/;

   2136  5 000455   000000 621006                    EAX1    0,QL
         5 000456   000007 236000 6                  LDQ     7
         5 000457   100017 356111                    ANSQ    15,X1,PR1

      559     2137                                                /**/
      560     2138                                           /* Initialize the console's
      561     2139                                                ghost_prompt table */
      562     2140    4                  DO J = 0 TO 2;

   2140  5 000460   000003 450000 3                  STZ     J

      563     2141    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2141  5 000461   000003 236000 3                  LDQ     J
         5 000462   000042 402007                    MPY     34,DL
         5 000463   200032 756100                    STQ     TEMP_SIZE+2,,AUTO
         5 000464   000002 236000 3                  LDQ     I
         5 000465   000370 402007                    MPY     248,DL
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:98   
         5 000466   200032 036100                    ADLQ    TEMP_SIZE+2,,AUTO
         5 000467   000011 402007                    MPY     9,DL
         5 000470   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000471   003106 060400                    CSL     bolr='003'O
         5 000472   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         5 000473   000022 000001                    BDSC    18,Q,PR0                 by=0,bit=0,n=1

      564     2142    4                            PROMPT_TABLE.LAST_READ(J)
      565     2143    4                            = '0'B /*FALSE#*/;
      566     2144    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2144  5 000474   000003 236000 3                  LDQ     J
         5 000475   000042 402007                    MPY     34,DL
         5 000476   200032 756100                    STQ     TEMP_SIZE+2,,AUTO
         5 000477   000002 236000 3                  LDQ     I
         5 000500   000370 402007                    MPY     248,DL
         5 000501   200032 036100                    ADLQ    TEMP_SIZE+2,,AUTO
         5 000502   000011 402007                    MPY     9,DL
         5 000503   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000504   003106 061400                    CSR     bolr='003'O
         5 000505   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         5 000506   000022 010010                    BDSC    18,Q,PR0                 by=0,bit=1,n=8

      567     2145    4                            PROMPT_TABLE.COUNT_(J)
      568     2146    4                            = 1;
      569     2147    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2147  5 000507   000003 236000 3                  LDQ     J
         5 000510   000042 402007                    MPY     34,DL
         5 000511   200032 756100                    STQ     TEMP_SIZE+2,,AUTO
         5 000512   000002 236000 3                  LDQ     I
         5 000513   000370 402007                    MPY     248,DL
         5 000514   200032 036100                    ADLQ    TEMP_SIZE+2,,AUTO
         5 000515   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000516   040106 100400                    MLR     fill='040'O
         5 000517   000001 000001 6                  ADSC9   1                        cn=0,n=1
         5 000520   000022 200037                    ADSC9   18,Q,PR0                 cn=1,n=31
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:99   

      570     2148    4                            PROMPT_TABLE.PROMPT(J)
      571     2149    4                            = '?';
      572     2150    4                       ADDR(OC_CONSOLE.PROMPTS(I)) ->

   2150  5 000521   000003 236000 3                  LDQ     J
         5 000522   000042 402007                    MPY     34,DL
         5 000523   200032 756100                    STQ     TEMP_SIZE+2,,AUTO
         5 000524   000002 236000 3                  LDQ     I
         5 000525   000370 402007                    MPY     248,DL
         5 000526   200032 036100                    ADLQ    TEMP_SIZE+2,,AUTO
         5 000527   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000530   000106 101400                    MRL     fill='000'O
         5 000531   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         5 000532   000032 000002                    ADSC9   26,Q,PR0                 cn=0,n=2

      573     2151    4                            PROMPT_TABLE.SIZER(J)
      574     2152    4                            = 0;
      575     2153    4                     END;                  /* DO J = 0 TO 2 */

   2153  5 000533   000003 235000 3                  LDA     J
         5 000534   000001 035007                    ADLA    1,DL
         5 000535   000003 755000 3                  STA     J
         5 000536   000003 115007                    CMPA    3,DL
         5 000537   000461 602000 5                  TNC     s:2141

      576     2154    3                  IF (SUBSTR(OC_CONSOLE.STATION(I),0,2) = 'SC')

   2154  5 000540   000002 236000 3                  LDQ     I
         5 000541   000076 402007                    MPY     62,DL
         5 000542   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000543   000000 220106                    LDX0    0,QL,PR0
         5 000544   000004 100000 4                  CMPX0   4
         5 000545   000577 601000 5                  TNZ     s:2164

      577     2155    3                  THEN
      578     2156    4                  DO;
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:100  

      579     2157    4                       OC_CONSOLE.ATTR(I) = OC_CONSOLE.ATTR(I) | '000004'O
              2157                                /* K_IOMCON */ ;

   2157  5 000546   000013 221106                    LDX1    11,QL,PR0
         5 000547   000004 261003                    ORX1    4,DU
         5 000550   000013 741106                    STX1    11,QL,PR0

      580     2158    4                       OC_CONSOLE.ATTRO(I) = OC_CONSOLE.ATTRO(I) | '000004'O
              2158                                /* K_IOMCON */ ;

   2158  5 000551   000002 236000 3                  LDQ     I
         5 000552   000076 402007                    MPY     62,DL
         5 000553   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000554   000014 220106                    LDX0    12,QL,PR0
         5 000555   000004 260003                    ORX0    4,DU
         5 000556   000014 740106                    STX0    12,QL,PR0

      581     2159    4                       OC_CONSOLE.SHIFT(I) = '1'B /*TRUE#*/;

   2159  5 000557   000002 236000 3                  LDQ     I
         5 000560   000076 402007                    MPY     62,DL
         5 000561   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000562   000000 620006                    EAX0    0,QL
         5 000563   100000 236007                    LDQ     32768,DL
         5 000564   000017 256110                    ORSQ    15,X0,PR0

      582     2160    4                       OC_CONSOLE.LOGON(I) = ' ';

   2160  5 000565   000002 236000 3                  LDQ     I
         5 000566   000076 402007                    MPY     62,DL
         5 000567   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000570   000000 620006                    EAX0    0,QL
         5 000571   000000 621006                    EAX1    0,QL
         5 000572   000035 235000 xsym               LDA     B_VECTNIL+29
         5 000573   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000574   000006 755110                    STA     6,X0,PR0
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:101  
         5 000575   000007 756111                    STQ     7,X1,PR0

      583     2161    4                     END;                  /* DO IF SYSTEM CONTROL CONSOLE */

   2161  5 000576   000623 710000 5                  TRA     EH_AT_12

      584     2162    3                  ELSE
      585     2163    4                  DO;

      586     2164    4                       STA.STATION# = OC_CONSOLE.STATION(I);

   2164  5 000577   000002 236000 3                  LDQ     I
         5 000600   000370 402007                    MPY     248,DL
         5 000601   040000 100506                    MLR     fill='040'O
         5 000602   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         5 000603   000021 000010 3                  ADSC9   STA                      cn=0,n=8

      587     2165    4                       CALL M$EOM (EOM_SET) ALTRET(TOO_BAD);

   2165  5 000604   000066 630400 3                  EPPR0   EOM_SET
         5 000605   560003 713400                    CLIMB   alt,+57347
         5 000606   401000 401760                    pmme    nvectors=3
         5 000607   000610 702000 5                  TSX2    TOO_BAD

   2164  5 000610                       TOO_BAD      null
      588     2166    4   TOO_BAD:            ;
      589     2167    4                       IF OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */

   2167  5 000610   000002 236000 3                  LDQ     I
         5 000611   000076 402007                    MPY     62,DL
         5 000612   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000613   000013 220106                    LDX0    11,QL,PR0
         5 000614   002000 360003                    ANX0    1024,DU
         5 000615   000617 600000 5                  TZE     s:2177

      590     2168    4                       THEN
      591     2169    5                       DO;
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:102  

      592     2170    5                          END;             /* NULL DO IF SLAVE */

   2170  5 000616   000623 710000 5                  TRA     EH_AT_12

      593     2171    4                       ELSE
      594     2172    5                       DO;

      595     2173                                                /** STAR 516 **/
      596     2174                                                /* Make broadcast/sendall
      597     2175                                                     legal to non-slave term
      598     2176                                                     on OCCG */
      599     2177    5                            CALL M$TRMISC (MAKE_BROAD) ALTRET (EH_AT_12);

   2177  5 000617   000100 630400 3                  EPPR0   MAKE_BROAD
         5 000620   560020 713400                    CLIMB   alt,+57360
         5 000621   400400 401760                    pmme    nvectors=2
         5 000622   000623 702000 5                  TSX2    EH_AT_12

   2177  5 000623                       EH_AT_12     null
      600     2178    5   EH_AT_12:                ;
      601     2179    5                          END;             /* DO IF SLAVE NOT SET */

      602     2180                                                /**/
      603     2181    4                     END;                  /* DO IF FEP CONS */

      604     2182    3                  OC_CONSOLE.PROFILE.COUNT(I) = 0;

   2182  5 000623   000002 236000 3                  LDQ     I
         5 000624   000076 402007                    MPY     62,DL
         5 000625   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000626   000000 620006                    EAX0    0,QL
         5 000627   000032 236000 xsym               LDQ     B_VECTNIL+26
         5 000630   000072 356110                    ANSQ    58,X0,PR0

      605     2183    3                  OC_CONSOLE.PROFILE.TXT(I) = ' ';

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:103  
   2183  5 000631   000002 236000 3                  LDQ     I
         5 000632   000370 402007                    MPY     248,DL
         5 000633   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000634   040106 100400                    MLR     fill='040'O
         5 000635   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000636   000072 200013                    ADSC9   58,Q,PR0                 cn=1,n=11

      606     2184                                                /**/
      607     2185                                                /**/
      608     2186    3                  IF OC_FIRST_CONSOLE

   2186  5 000637   000000 234000 xsym               SZN     OC_FIRST_CONSOLE
         5 000640   000646 605000 5                  TPL     s:2193

      609     2187    3                  THEN
      610     2188    4                  DO;

      611     2189    4                       OC_FIRST_CONSOLE = '0'B;

   2189  5 000641   000000 450000 xsym               STZ     OC_FIRST_CONSOLE

      612     2190    4                       CALL OCL$INIT (2 /* FROM_OCP# */);

   2190  5 000642   000010 630400 6                  EPPR0   8
         5 000643   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000644   000000 701000 xent               TSX1    OCL$INIT
         5 000645   000000 011000                    NOP     0

      613     2191    4                     END;

      614     2192                                                /**/
      615     2193    3                  IF OC_LIST

   2193  5 000646   000000 234000 xsym               SZN     OC_LIST
         5 000647   000663 605000 5                  TPL     s:2197

      616     2194    3                  THEN
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:104  
      617     2195    3                       CALL OCL$WRITE_CONSOLE_REC (, , 1 /* ONE_CONSOLE# */, 2
              2195                                /* CONSOLE_ON# */, I);

   2195  5 000650   000000 236000 6                  LDQ     0
         5 000651   200036 756100                    STQ     TEMP_SIZE+6,,AUTO
         5 000652   000012 237000 6                  LDAQ    10
         5 000653   200034 757100                    STAQ    TEMP_SIZE+4,,AUTO
         5 000654   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 000655   000001 235000 xsym               LDA     B_VECTNIL+1
         5 000656   200032 757100                    STAQ    TEMP_SIZE+2,,AUTO
         5 000657   200032 630500                    EPPR0   TEMP_SIZE+2,,AUTO
         5 000660   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000661   000000 701000 xent               TSX1    OCL$WRITE_CONSOLE_REC
         5 000662   000000 011000                    NOP     0

      618     2196                                                /**/
      619     2197    3                  IF FLAG

   2197  5 000663   000001 234000 3                  SZN     FLAG
         5 000664   000746 605000 5                  TPL     s:2209

      620     2198    3                  THEN
      621     2199    4                  DO;

      622     2200    4                       MSG# = 394 /* LOGGED_ON_MSG# */;

   2200  5 000665   000612 220003                    LDX0    394,DU
         5 000666   000020 740000 3                  STX0    MSG#

      623     2201    4                       CALL OCO$IWRITE (

   2201  5 000667   000002 236000 3                  LDQ     I
         5 000670   000076 402007                    MPY     62,DL
         5 000671   000000 470400 xsym               LDP0    OC_CONSOLE$
         5 000672   000012 236106                    LDQ     10,QL,PR0
         5 000673   000022 772000                    QRL     18
         5 000674   400000 036007                    ADLQ    -131072,DL
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:105  
         5 000675   000022 736000                    QLS     18
         5 000676   000022 772000                    QRL     18
         5 000677   000000 621006                    EAX1    0,QL
         5 000700   200032 741100                    STX1    TEMP_SIZE+2,,AUTO
         5 000701   000015 236000 6                  LDQ     13
         5 000702   200043 756100                    STQ     TEMP_SIZE+11,,AUTO
         5 000703   000002 236000 3                  LDQ     I
         5 000704   000076 402003                    MPY     62,DU
         5 000705   000000 036000 xsym               ADLQ    OC_CONSOLE$
         5 000706   200042 756100                    STQ     TEMP_SIZE+10,,AUTO
         5 000707   000015 236000 6                  LDQ     13
         5 000710   200041 756100                    STQ     TEMP_SIZE+9,,AUTO
         5 000711   000002 236000 3                  LDQ     I
         5 000712   000076 402003                    MPY     62,DU
         5 000713   000002 036003                    ADLQ    2,DU
         5 000714   000000 036000 xsym               ADLQ    OC_CONSOLE$
         5 000715   200040 756100                    STQ     TEMP_SIZE+8,,AUTO
         5 000716   000016 237000 6                  LDAQ    14
         5 000717   200036 757100                    STAQ    TEMP_SIZE+6,,AUTO
         5 000720   000020 236000 6                  LDQ     16
         5 000721   200035 756100                    STQ     TEMP_SIZE+5,,AUTO
         5 000722   200032 631500                    EPPR1   TEMP_SIZE+2,,AUTO
         5 000723   200034 451500                    STP1    TEMP_SIZE+4,,AUTO
         5 000724   200034 630500                    EPPR0   TEMP_SIZE+4,,AUTO
         5 000725   000026 631400 xsym               EPPR1   B_VECTNIL+22
         5 000726   000000 701000 xent               TSX1    OCO$IWRITE
         5 000727   000000 011000                    NOP     0

      624     2202    4                            BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
      625     2203    4                            MSG#, '001'O, '010'O, OC_CONSOLE.TERM_NAME(I),
      626     2204    4                            0, OC_CONSOLE.STATION(I), 0);
      627     2205    4                       IF TEMP_SIZE ~= 0 THEN

   2205  5 000730   200030 235100                    LDA     TEMP_SIZE,,AUTO
         5 000731   000746 600000 5                  TZE     s:2209

      628     2206    4                            CALL OCN$KEYIN(TEMP_BUF,TEMP_SIZE,
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:106  

   2206  5 000732   000002 236000 3                  LDQ     I
         5 000733   000076 402003                    MPY     62,DU
         5 000734   000000 036000 xsym               ADLQ    OC_CONSOLE$
         5 000735   200034 756100                    STQ     TEMP_SIZE+4,,AUTO
         5 000736   200030 630500                    EPPR0   TEMP_SIZE,,AUTO
         5 000737   200033 450500                    STP0    TEMP_SIZE+3,,AUTO
         5 000740   200004 631500                    EPPR1   TEMP_BUF,,AUTO
         5 000741   200032 451500                    STP1    TEMP_SIZE+2,,AUTO
         5 000742   200032 630500                    EPPR0   TEMP_SIZE+2,,AUTO
         5 000743   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000744   000000 701000 xent               TSX1    OCN$KEYIN
         5 000745   000000 011000                    NOP     0

      629     2207    4                                 OC_CONSOLE.STATION(I));
      630     2208    4                     END;                  /* DO IF NORMAL LOG_ON */

      631     2209    3                  I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   2209  5 000746   000000 235000 xsym               LDA     OC_MAXCONSOLE
         5 000747   000022 771000                    ARL     18
         5 000750   000001 035007                    ADLA    1,DL
         5 000751   000002 755000 3                  STA     I

      632     2210    3                END;

      633     2211    2           END;

   2211  5 000752   000002 235000 3                  LDA     I
         5 000753   000001 035007                    ADLA    1,DL
         5 000754   000002 755000 3                  STA     I
         5 000755   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         5 000756   000022 772000                    QRL     18
         5 000757   000002 116000 3                  CMPQ    I
         5 000760   000067 603000 5                  TRC     s:2056

      634     2212    1        RETURN;
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:107  

   2212  5 000761   000000 702200 xent               TSX2  ! X66_ARET
      635     2213    1   END OCP$ADDSTA;
      636     2214        %EOD;

PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:108  
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OC$INFO.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$ADDSTA.
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:109  

 **** Variables and constants ****

  ****  Section 003  Data  OCP$ADDSTA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   114-0-0/d STRC(72)    r     1 CONS_SEG                 116-0-0/d STRC(504)   r     1 CS_READ
    32-0-0/d STRC(576)   r     1 DEACT                     66-0-0/d STRC(360)   r     1 EOM_SET
     1-0-0/w BIT         r     1 FLAG                     106-0-0/d STRC(216)   r     1 GET_ENTRY
     2-0-0/w UBIN        r     1 I                          3-0-0/w UBIN        r     1 J
    16-0-0/c CHAR(8)     r     1 LOCAL_STATION            100-0-0/d STRC(216)   r     1 MAKE_BROAD
    20-0-0/b UBIN(18)    r     1 MSG#                      21-0-0/w STRC(288)   r     1 STA
     4-0-0/c CHAR(23)    r     1 TOO_MANY                  52-0-0/d STRC(432)   r     1 WRITE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LPAR                     *0-0-0/w STRC(1476)  r     1 LPAR
     4-0-0/c CHAR(80)    r     1 TEMP_BUF                  30-0-0/w UBIN        r     1 TEMP_SIZE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OC_#CONSOLES               0-0-0/w UBIN(18)    r     1 OC_CID
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w BIT         r     1 OC_FIRST_CONSOLE
     0-0-0/w BIT         r     1 OC_LIST                    0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE
     0-0-0/c STRC(1800)  r     1 OC_MSGBUFFER

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:110  

     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$OCCG
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)
     0-0-0/c STRC(306)   r     1 PROMPT_TABLE(0:2)


   Procedure OCP$ADDSTA requires 498 words for executable code.
   Procedure OCP$ADDSTA requires 36 words of local(AUTO) storage.
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:111  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:112  
          MINI XREF LISTING

B
      2048**LABEL    2047--CALLALT
C
      2049**LABEL    2048--CALLALT
CONS_SEG
      1974**DCL      1956--DCLINIT
CONS_SEG.W2
      1975**DCL      1976--REDEF
CS_READ
      2000**DCL      2032<>CALL
CS_READ.STATION_
      2003**DCL      2004--REDEF
CS_READ.V
      2004**DCL      2000--DCLINIT
CS_READ.V.DVBYTE.REREAD#
      2015**DCL      2015--REDEF
CS_READ.V.INDX#
      2013**DCL      2013--REDEF
DEACT
      1833**DCL      2048<>CALL
DEACT.V
      1834**DCL      1833--DCLINIT
DEACT.V.DVBYTE.REREAD#
      1836**DCL      1836--REDEF
EH_AT_12
      2177**LABEL    2177--CALLALT
EOM_SET
      1904**DCL      2165<>CALL
EOM_SET.V
      1912**DCL      1906--DCLINIT
FLAG
       782**DCL      2029<<ASSIGN   2132<<ASSIGN   2197>>IF
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:113  
GET_ENTRY
      1956**DCL      2038<>CALL
GET_ENTRY.V
      1956**DCL      1956--DCLINIT
I
       783**DCL      2055<<DOINDEX  2056>>IF       2056>>IF       2059<>CALL     2060>>ASSIGN   2062>>ASSIGN
      2063>>ASSIGN   2064>>ASSIGN   2068>>CALLBLT  2072>>ASSIGN   2072>>ASSIGN   2075>>IF       2079>>ASSIGN
      2084>>ASSIGN   2084>>ASSIGN   2090>>ASSIGN   2091>>ASSIGN   2092>>ASSIGN   2093>>ASSIGN   2094>>ASSIGN
      2095>>ASSIGN   2096>>ASSIGN   2099>>ASSIGN   2101>>ASSIGN   2103>>ASSIGN   2104>>ASSIGN   2108>>ASSIGN
      2109>>ASSIGN   2110>>ASSIGN   2116>>ASSIGN   2117>>ASSIGN   2121>>ASSIGN   2122>>ASSIGN   2124>>ASSIGN
      2125>>ASSIGN   2125>>ASSIGN   2127>>ASSIGN   2127>>ASSIGN   2129>>IF       2133>>ASSIGN   2136>>ASSIGN
      2141>>ASSIGN   2144>>ASSIGN   2147>>ASSIGN   2150>>ASSIGN   2154>>IF       2157>>ASSIGN   2157>>ASSIGN
      2158>>ASSIGN   2158>>ASSIGN   2159>>ASSIGN   2160>>ASSIGN   2164>>ASSIGN   2167>>IF       2182>>ASSIGN
      2183>>ASSIGN   2195<>CALL     2201>>CALL     2201>>CALL     2201>>CALL     2206>>CALL     2209<<ASSIGN
J
       784**DCL      2066<<ASSIGN   2068<<CALLBLT  2070>>IF       2075>>IF       2075>>IF       2140<<DOINDEX
      2141>>ASSIGN   2144>>ASSIGN   2147>>ASSIGN   2150>>ASSIGN
LOCAL_STATION
       796**DCL      2075>>IF
LPAR
       715**DCL        20--PROC
LPAR.CNCT.ATTR
       741**DCL       741--REDEF
LPAR.CNCT.FLG
       740**DCL      2103>>ASSIGN
LPAR.CNCT.WHO.ACCT
       739**DCL      2097>>IF       2101>>ASSIGN
LPAR.OCINFO.CADDR
       762**DCL      2113>>IF       2117>>ASSIGN
LPAR.OCINFO.CMD
       778**DCL      2111>>ASSIGN
LPAR.OCINFO.CMDCNT
       776**DCL      2112>>ASSIGN
LPAR.OCINFO.KCADDR
       768**DCL      2116>>ASSIGN
LPAR.OCINFO.LANG
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:114  
       764**DCL      2109>>ASSIGN
LPAR.OCINFO.MXPRI
       766**DCL      2124>>ASSIGN
LPAR.OCINFO.TNAME
       773**DCL      2063>>ASSIGN   2097>>IF
LPAR.OCINFO.WSN
       771**DCL      2064>>ASSIGN
LPAR.STATION
       719**DCL       719--REDEF    2046>>ASSIGN   2062>>ASSIGN
M$DEACTIVATE
       108**DCL-ENT  2048--CALL
M$EOM
       113**DCL-ENT  2165--CALL
M$GDS
       123**DCL-ENT  2038--CALL
M$READ
        89**DCL-ENT  2032--CALL
M$TRMISC
       117**DCL-ENT  2177--CALL
M$WRITE
        89**DCL-ENT  2047--CALL
MAKE_BROAD
      1933**DCL      2177<>CALL
MAKE_BROAD.V
      1937**DCL      1935--DCLINIT
MSG#
       798**DCL      2200<<ASSIGN   2201<>CALL
NO_MORE
      2041**LABEL    2038--CALLALT
OCL$INIT
       791**DCL-ENT  2190--CALL
OCL$WRITE_CONSOLE_REC
       792**DCL-ENT  2195--CALL
OCN$KEYIN
       788**DCL-ENT  2206--CALL
OCO$IWRITE
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:115  
       789**DCL-ENT  2201--CALL
OCP$INITCONSOLE
       790**DCL-ENT  2059--CALL
OC_#CONSOLES
      1003**DCL      2035>>IF       2043>>IF       2053<<ASSIGN   2053>>ASSIGN
OC_CID
      1004**DCL      2060>>ASSIGN   2061<<ASSIGN   2061>>ASSIGN
OC_CONSOLE
      1010**DCL      1959--DCLINIT
OC_CONSOLE.ACCT
      1016**DCL      2110<<ASSIGN
OC_CONSOLE.ACTIVE
      1015**DCL      2104<<ASSIGN
OC_CONSOLE.ATTR
      1012**DCL      1012--REDEF    2040<<ASSIGN   2056>>IF       2121<<ASSIGN   2129>>IF       2157<<ASSIGN
      2157>>ASSIGN   2167>>IF
OC_CONSOLE.ATTRO
      1013**DCL      1013--REDEF    2041<<ASSIGN   2056>>IF       2122<<ASSIGN   2158<<ASSIGN   2158>>ASSIGN
OC_CONSOLE.ATTR_INPUT
      1012**DCL      2116<<ASSIGN   2125>>ASSIGN
OC_CONSOLE.ATTR_INPUT_SAVE
      1013**DCL      2125<<ASSIGN
OC_CONSOLE.ATTR_OUTPUT
      1013**DCL      2117<<ASSIGN   2127>>ASSIGN
OC_CONSOLE.ATTR_OUTPUT_SAVE
      1013**DCL      2127<<ASSIGN
OC_CONSOLE.CID
      1011**DCL      1012--REDEF    2060<<ASSIGN   2201>>CALL
OC_CONSOLE.DONT_TIME
      1016**DCL      2133<<ASSIGN   2136<<ASSIGN
OC_CONSOLE.FIRST_READ
      1016**DCL      2090<<ASSIGN
OC_CONSOLE.FLAGS
      1014**DCL      2103<<ASSIGN
OC_CONSOLE.GHST
      1015**DCL      2094<<ASSIGN
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:116  
OC_CONSOLE.GHSTRD
      1015**DCL      2095<<ASSIGN
OC_CONSOLE.I_DCBNUM
      1014**DCL      2091<<ASSIGN
OC_CONSOLE.LOGON
      1011**DCL      2099<<ASSIGN   2101<<ASSIGN   2160<<ASSIGN
OC_CONSOLE.LP_WSN
      1011**DCL      2072<<ASSIGN   2079<<ASSIGN   2084<<ASSIGN
OC_CONSOLE.MXPRIO
      1049**DCL      2124<<ASSIGN
OC_CONSOLE.NATLANG
      1016**DCL      2109<<ASSIGN
OC_CONSOLE.PROFILE.COUNT
      1049**DCL      2182<<ASSIGN
OC_CONSOLE.PROFILE.TXT
      1049**DCL      2183<<ASSIGN
OC_CONSOLE.PROMPTS
      1016**DCL      2141--ASSIGN   2144--ASSIGN   2147--ASSIGN   2150--ASSIGN
OC_CONSOLE.SHIFT
      1015**DCL      2108<<ASSIGN   2159<<ASSIGN
OC_CONSOLE.STATION
      1010**DCL      1010--REDEF    2062<<ASSIGN   2154>>IF       2164>>ASSIGN   2201<>CALL     2206<>CALL
OC_CONSOLE.SYSID
      1012**DCL      2093<<ASSIGN
OC_CONSOLE.TERM_NAME
      1011**DCL      2063<<ASSIGN   2084>>ASSIGN   2201<>CALL
OC_CONSOLE.TRANSAC_LAST_MIN
      1015**DCL      2096<<ASSIGN
OC_CONSOLE.WSN
      1011**DCL      2064<<ASSIGN   2068>>CALLBLT  2072>>ASSIGN   2075>>IF
OC_CONSOLE.X_DCBNUM
      1014**DCL      2092<<ASSIGN
OC_CONSOLE$
      1009**DCL      1010--IMP-PTR  2040>>ASSIGN   2041>>ASSIGN   2056>>IF       2056>>IF       2060>>ASSIGN
      2062>>ASSIGN   2063>>ASSIGN   2064>>ASSIGN   2068>>CALLBLT  2072>>ASSIGN   2072>>ASSIGN   2075>>IF
      2079>>ASSIGN   2084>>ASSIGN   2084>>ASSIGN   2090>>ASSIGN   2091>>ASSIGN   2092>>ASSIGN   2093>>ASSIGN
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:117  
      2094>>ASSIGN   2095>>ASSIGN   2096>>ASSIGN   2099>>ASSIGN   2101>>ASSIGN   2103>>ASSIGN   2104>>ASSIGN
      2108>>ASSIGN   2109>>ASSIGN   2110>>ASSIGN   2116>>ASSIGN   2117>>ASSIGN   2121>>ASSIGN   2122>>ASSIGN
      2124>>ASSIGN   2125>>ASSIGN   2125>>ASSIGN   2127>>ASSIGN   2127>>ASSIGN   2129>>IF       2133>>ASSIGN
      2136>>ASSIGN   2141>>ASSIGN   2144>>ASSIGN   2147>>ASSIGN   2150>>ASSIGN   2154>>IF       2157>>ASSIGN
      2157>>ASSIGN   2158>>ASSIGN   2158>>ASSIGN   2159>>ASSIGN   2160>>ASSIGN   2164>>ASSIGN   2167>>IF
      2182>>ASSIGN   2183>>ASSIGN   2201>>CALL     2201>>CALL     2201>>CALL     2206>>CALL
OC_DIR
      1052**DCL      1052--REDEF
OC_FIRST_CONSOLE
      1058**DCL      2186>>IF       2189<<ASSIGN
OC_INTBIT
      1052**DCL      1053--REDEF
OC_INTMSG
       929**DCL       942--REDEF
OC_INTMSG.FLAGS
       936**DCL       937--REDEF
OC_INTMSG.MESS
       942**DCL       942--REDEF
OC_INTMSG.MSGID
       932**DCL       933--REDEF
OC_INTMSG.WSN
       939**DCL       940--REDEF
OC_LIST
      1055**DCL      2193>>IF
OC_MASK
      1053**DCL      1053--REDEF
OC_MAXCONSOLE
      1009**DCL      2030>>IF       2035>>IF       2039<<ASSIGN   2039>>ASSIGN   2040>>ASSIGN   2041>>ASSIGN
      2043>>IF       2055>>DOINDEX  2209>>ASSIGN
OC_MESSBUF
       944**DCL       959--REDEF     973--REDEF
OC_MESSBUF.FLAGS
       951**DCL       952--REDEF
OC_MESSBUF.MESS
       957**DCL       957--REDEF
OC_MESSBUF.MSGID
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:118  
       947**DCL       948--REDEF
OC_MESSBUF.WSN
       954**DCL       955--REDEF
OC_MESSBUF1.FLAGS
       966**DCL       967--REDEF
OC_MESSBUF1.LEN
       972**DCL       972--REDEF
OC_MESSBUF1.MSGID
       962**DCL       963--REDEF
OC_MESSBUF1.WSN
       969**DCL       970--REDEF
OC_MSGBUFFER
       975**DCL       990--REDEF    2002--DCLINIT  2003--DCLINIT
OC_MSGBUFFER.FLAGS
       982**DCL       983--REDEF
OC_MSGBUFFER.MESS
       988**DCL       988--REDEF
OC_MSGBUFFER.MSGID
       978**DCL       979--REDEF
OC_MSGBUFFER.WSN
       985**DCL       986--REDEF
OC_MSGBUFFER2.FLAGS
       997**DCL       998--REDEF
OC_MSGBUFFER2.MSGID
       993**DCL       994--REDEF
OC_MSGBUFFER2.WSN
      1000**DCL      1001--REDEF
OC_PARAM
      1008**DCL      1008--REDEF
OC_QUEUE.PARMC
      1007**DCL      1007--REDEF
OH_WELL
      2030**LABEL    2032--CALLALT
PROMPT_TABLE.COUNT_
      1050**DCL      2144<<ASSIGN
PROMPT_TABLE.LAST_READ
PL6.E3A0      #003=OCP$ADDSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:04 Page:119  
      1049**DCL      2141<<ASSIGN
PROMPT_TABLE.PROMPT
      1050**DCL      2147<<ASSIGN
PROMPT_TABLE.SIZER
      1050**DCL      2150<<ASSIGN
STA
      1803**DCL      1833--DCLINIT  1869--DCLINIT  1908--DCLINIT  1935--DCLINIT
STA.MSGIDXT
      1813**DCL      1816--REDEF
STA.STATION#
      1807**DCL      2046<<ASSIGN   2164<<ASSIGN
TEMP_BUF
       786**DCL      2111<<ASSIGN   2206<>CALL
TEMP_SIZE
       787**DCL      2112<<ASSIGN   2205>>IF       2206<>CALL
TOO_BAD
      2164**LABEL    2165--CALLALT
TOO_MANY
       785**DCL      1868--DCLINIT  1869--DCLINIT
WRITE
      1867**DCL      2047<>CALL
WRITE.STATION_
      1869**DCL      1869--REDEF
WRITE.V
      1870**DCL      1867--DCLINIT
WRITE.V.DVBYTE.VFC#
      1876**DCL      1876--REDEF

PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:120  
      637        1        /*M* OCP$DELSTA KEYINs routine to handle console logoffs */
      638        2        /*T***********************************************************/
      639        3        /*T*                                                         */
      640        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      641        5        /*T*                                                         */
      642        6        /*T***********************************************************/
      643        7        %SET LISTSUB='1'B;
      644        8                                                /**/
      645        9        /*
      646       10         ###    ###   ####    #   ####   #####  #       ###   #####   ###
      647       11        #   #  #   #  #   #  ###  #   #  #      #      #   #    #    #   #
      648       12        #   #  #      #   # # #   #   #  #      #      #        #    #   #
      649       13        #   #  #      ####   ###  #   #  ####   #       ###     #    #####
      650       14        #   #  #      #       # # #   #  #      #          #    #    #   #
      651       15        #   #  #   #  #      ###  #   #  #      #      #   #    #    #   #
      652       16         ###    ###   #       #   ####   #####  #####   ###     #    #   #
      653       17                                                                   */
      654       18                 /* procedure to remove station from KEYIN's list */
      655       19
      656       20        OCP$DELSTA: PROC (THIS_STATION);
      657       21
      658       22    1   DCL THIS_STATION CHAR(8);
      659       23
      660       24    1   DCL OCP$FINDCX ENTRY(2);
      661       25    1   DCL OCR$CREAD ENTRY(1);
      662       26    1   DCL OCL$WRITE_CONSOLE_REC ENTRY(5);
      663       27    1   DCL I UBIN WORD STATIC;
      664       28        %INCLUDE OCI_SUBS_C;
      665      126        %INCLUDE CP_6;
      666      207        %INCLUDE OC_DAT_R;
      667      368             %B$CGAURD;
      668      387                                                /**/
      669      388                                                /**/
      670      389        %INCLUDE CP_6_SUBS;
      671      929        %INCLUDE SS_SCHED_C;
      672     1162                                                /**/
      673     1163                                                /**/
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:121  
      674     1164    1   DCL M$OCCG DCB;
      675     1165                                                /**/
      676     1166             %FPT_ACTIVATE            (FPTN=DEACT,
      677     1167                                           DCB=M$OCCG,
      678     1168                                           STATION=STA,
      679     1169                                           FLUSH=YES,
      680     1170                                           DISCONNECT=YES);
      681     1193                                                /**/
      682     1194                  %VLP_STATION        (FPTN=STA);
      683     1221                                                /**/
      684     1222             %FPT_RUE       (FPTN=KILL_GHOST,
      685     1223                                 EVENT=%SS_ABRT);
      686     1237                                                /**/
      687     1238        /*
      688     1239                                                                            */
      689     1240                                                /**/
      690     1241        %EJECT;
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:122  
      691     1242                                                /**/
      692     1243                                                /**/
      693     1244        /*
      694     1245                  Begin  O C P $ D E L S T A  main
      695     1246                                                          */
      696     1247                                                /**/
      697     1248                                                /**/
      698     1249    1        I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      699     1250    1        CALL OCP$FINDCX (I,THIS_STATION);
      700     1251    1        IF I ~= OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
      701     1252    1        THEN
      702     1253    2        DO;
      703     1254    2             IF OC_LIST
      704     1255    2             THEN
      705     1256    2                  CALL OCL$WRITE_CONSOLE_REC (, , 1 /* ONE_CONSOLE# */, 0
              1256                           /* CONSOLE_OFF# */, I);
      706     1257    2             IF OC_CONSOLE.SYSID(I) ~= 0
      707     1258    2             THEN
      708     1259    3             DO;
      709     1260    3                  KILL_GHOST.V.USER# = OC_CONSOLE.SYSID(I);
      710     1261    3                  OC_CONSOLE.SYSID(I) = 0;
      711     1262    3                  OC_CONSOLE.GHST(I) = '0'B /*FALSE#*/;
      712     1263    3                  OC_CONSOLE.GHSTRD(I) = '0'B /*FALSE#*/;
      713     1264    3                  CALL M$RUE (KILL_GHOST) ALTRET (IGNORE_IT);
      714     1265    3   IGNORE_IT:     ;
      715     1266    3                  STA.STATION# = ADDR(OC_KEYINBUF)->B$CGAURD.STATION;
      716     1267    3                  CALL M$DEACTIVATE (DEACT) ALTRET (NEXT_LINE);
      717     1268    3   NEXT_LINE:     ;
      718     1269    3                END;                       /* IF A C_G ASSOCIATED */
      719     1270    2             IF OC_CONSOLE.X_DCBNUM(I) ~= 0
      720     1271    2             THEN
      721     1272    2                  CALL OCR$CREAD(I);
      722     1273    2             OC_CONSOLE.ATTR (I) = '0'B;
      723     1274    2             OC_CONSOLE.ATTRO (I) = '0'B;
      724     1275                                                /**/
      725     1276    2             OC_CONSOLE.ACTIVE(I) = '0'B /*FALSE#*/;
      726     1277    2             OC_#CONSOLES = OC_#CONSOLES - 1;
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:123  
      727     1278    2           END;                            /* IF OKAY TO DELETE */
      728     1279    1        RETURN;
      729     1280    1   END OCP$DELSTA;
      730     1281        %EOD;

PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:124  
--  Include file information  --

   SS_SCHED_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$DELSTA.

   Procedure OCP$DELSTA requires 89 words for executable code.
   Procedure OCP$DELSTA requires 10 words of local(AUTO) storage.

PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:125  

 Object Unit name= OCP$DELSTA                                 File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:05:25.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    30     36  OCP$DELSTA
    1   DCB   even  none     0      0  M$UC
    2   DCB   even  none     0      0  M$OCCG
    3   Proc  even  none    89    131  OCP$DELSTA
    4  RoData even  none     7      7  OCP$DELSTA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  OCP$DELSTA

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 OCP$FINDCX
         yes           Std       5 OCL$WRITE_CONSOLE_REC
         yes           Std       1 OCR$CREAD
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:126  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_#CONSOLES                          OC_KEYINBUF
     OC_PARAM                              OC_CONSOLE$                           OC_MAXCONSOLE
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_LIST                               M$OCCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:127  


      637        1        /*M* OCP$DELSTA KEYINs routine to handle console logoffs */
      638        2        /*T***********************************************************/
      639        3        /*T*                                                         */
      640        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      641        5        /*T*                                                         */
      642        6        /*T***********************************************************/
      643        7        %SET LISTSUB='1'B;
      644        8                                                /**/
      645        9        /*
      646       10         ###    ###   ####    #   ####   #####  #       ###   #####   ###
      647       11        #   #  #   #  #   #  ###  #   #  #      #      #   #    #    #   #
      648       12        #   #  #      #   # # #   #   #  #      #      #        #    #   #
      649       13        #   #  #      ####   ###  #   #  ####   #       ###     #    #####
      650       14        #   #  #      #       # # #   #  #      #          #    #    #   #
      651       15        #   #  #   #  #      ###  #   #  #      #      #   #    #    #   #
      652       16         ###    ###   #       #   ####   #####  #####   ###     #    #   #
      653       17                                                                   */
      654       18                 /* procedure to remove station from KEYIN's list */
      655       19
      656       20        OCP$DELSTA: PROC (THIS_STATION);

     20  3 000000   000000 700200 xent  OCP$DELSTA   TSX0  ! X66_AUTO_1
         3 000001   000012 000001                    ZERO    10,1

      657       21
      658       22    1   DCL THIS_STATION CHAR(8);
      659       23
      660       24    1   DCL OCP$FINDCX ENTRY(2);
      661       25    1   DCL OCR$CREAD ENTRY(1);
      662       26    1   DCL OCL$WRITE_CONSOLE_REC ENTRY(5);
      663       27    1   DCL I UBIN WORD STATIC;
      664       28        %INCLUDE OCI_SUBS_C;
      665      126        %INCLUDE CP_6;
      666      207        %INCLUDE OC_DAT_R;
      667      368             %B$CGAURD;
      668      387                                                /**/
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:128  
      669      388                                                /**/
      670      389        %INCLUDE CP_6_SUBS;
      671      929        %INCLUDE SS_SCHED_C;
      672     1162                                                /**/
      673     1163                                                /**/
      674     1164    1   DCL M$OCCG DCB;
      675     1165                                                /**/
      676     1166             %FPT_ACTIVATE            (FPTN=DEACT,
      677     1167                                           DCB=M$OCCG,
      678     1168                                           STATION=STA,
      679     1169                                           FLUSH=YES,
      680     1170                                           DISCONNECT=YES);
      681     1193                                                /**/
      682     1194                  %VLP_STATION        (FPTN=STA);
      683     1221                                                /**/
      684     1222             %FPT_RUE       (FPTN=KILL_GHOST,
      685     1223                                 EVENT=%SS_ABRT);
      686     1237                                                /**/
      687     1238        /*
      688     1239                                                                            */
      689     1240                                                /**/
      690     1241        %EJECT;
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:129  
      691     1242                                                /**/
      692     1243                                                /**/
      693     1244        /*
      694     1245                  Begin  O C P $ D E L S T A  main
      695     1246                                                          */
      696     1247                                                /**/
      697     1248                                                /**/
      698     1249    1        I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   1249  3 000002   000000 235000 xsym               LDA     OC_MAXCONSOLE
         3 000003   000022 771000                    ARL     18
         3 000004   000001 035007                    ADLA    1,DL
         3 000005   000000 755000 0                  STA     I

      699     1250    1        CALL OCP$FINDCX (I,THIS_STATION);

   1250  3 000006   200003 236100                    LDQ     @THIS_STATION,,AUTO
         3 000007   000000 235000 4                  LDA     0
         3 000010   200004 757100                    STAQ    @THIS_STATION+1,,AUTO
         3 000011   200004 630500                    EPPR0   @THIS_STATION+1,,AUTO
         3 000012   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000013   000000 701000 xent               TSX1    OCP$FINDCX
         3 000014   000000 011000                    NOP     0

      700     1251    1        IF I ~= OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */

   1251  3 000015   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         3 000016   000022 772000                    QRL     18
         3 000017   000001 036007                    ADLQ    1,DL
         3 000020   000000 116000 0                  CMPQ    I
         3 000021   000130 600000 3                  TZE     s:1279

      701     1252    1        THEN
      702     1253    2        DO;

      703     1254    2             IF OC_LIST

PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:130  
   1254  3 000022   000000 234000 xsym               SZN     OC_LIST
         3 000023   000037 605000 3                  TPL     s:1257

      704     1255    2             THEN
      705     1256    2                  CALL OCL$WRITE_CONSOLE_REC (, , 1 /* ONE_CONSOLE# */, 0
              1256                           /* CONSOLE_OFF# */, I);

   1256  3 000024   000000 236000 4                  LDQ     0
         3 000025   200010 756100                    STQ     @THIS_STATION+5,,AUTO
         3 000026   000002 237000 4                  LDAQ    2
         3 000027   200006 757100                    STAQ    @THIS_STATION+3,,AUTO
         3 000030   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000031   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000032   200004 757100                    STAQ    @THIS_STATION+1,,AUTO
         3 000033   200004 630500                    EPPR0   @THIS_STATION+1,,AUTO
         3 000034   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000035   000000 701000 xent               TSX1    OCL$WRITE_CONSOLE_REC
         3 000036   000000 011000                    NOP     0

      706     1257    2             IF OC_CONSOLE.SYSID(I) ~= 0

   1257  3 000037   000000 236000 0                  LDQ     I
         3 000040   000076 402007                    MPY     62,DL
         3 000041   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000042   000012 720106                    LXL0    10,QL,PR0
         3 000043   000076 600000 3                  TZE     NEXT_LINE

      707     1258    2             THEN
      708     1259    3             DO;

      709     1260    3                  KILL_GHOST.V.USER# = OC_CONSOLE.SYSID(I);

   1260  3 000044   000034 740000 0                  STX0    KILL_GHOST+2

      710     1261    3                  OC_CONSOLE.SYSID(I) = 0;

   1261  3 000045   000000 221003                    LDX1    0,DU
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:131  
         3 000046   000012 441106                    SXL1    10,QL,PR0

      711     1262    3                  OC_CONSOLE.GHST(I) = '0'B /*FALSE#*/;

   1262  3 000047   000000 236000 0                  LDQ     I
         3 000050   000076 402007                    MPY     62,DL
         3 000051   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000052   000000 620006                    EAX0    0,QL
         3 000053   000004 236000 4                  LDQ     4
         3 000054   000017 356110                    ANSQ    15,X0,PR0

      712     1263    3                  OC_CONSOLE.GHSTRD(I) = '0'B /*FALSE#*/;

   1263  3 000055   000000 236000 0                  LDQ     I
         3 000056   000076 402007                    MPY     62,DL
         3 000057   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000060   000000 620006                    EAX0    0,QL
         3 000061   000005 236000 4                  LDQ     5
         3 000062   000017 356110                    ANSQ    15,X0,PR0

      713     1264    3                  CALL M$RUE (KILL_GHOST) ALTRET (IGNORE_IT);

   1264  3 000063   000032 630400 0                  EPPR0   KILL_GHOST
         3 000064   420020 713400                    CLIMB   alt,+8208
         3 000065   400000 401760                    pmme    nvectors=1
         3 000066   000067 702000 3                  TSX2    IGNORE_IT

   1263  3 000067                       IGNORE_IT    null
      714     1265    3   IGNORE_IT:     ;
      715     1266    3                  STA.STATION# = ADDR(OC_KEYINBUF)->B$CGAURD.STATION;

   1266  3 000067   040000 100400                    MLR     fill='040'O
         3 000070   000001 000010 xsym               ADSC9   OC_KEYINBUF+1            cn=0,n=8
         3 000071   000022 000010 0                  ADSC9   STA                      cn=0,n=8

      716     1267    3                  CALL M$DEACTIVATE (DEACT) ALTRET (NEXT_LINE);

PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:132  
   1267  3 000072   000002 630400 0                  EPPR0   DEACT
         3 000073   500001 713400                    CLIMB   alt,+32769
         3 000074   401400 401760                    pmme    nvectors=4
         3 000075   000076 702000 3                  TSX2    NEXT_LINE

   1266  3 000076                       NEXT_LINE    null
      717     1268    3   NEXT_LINE:     ;
      718     1269    3                END;                       /* IF A C_G ASSOCIATED */

      719     1270    2             IF OC_CONSOLE.X_DCBNUM(I) ~= 0

   1270  3 000076   000000 236000 0                  LDQ     I
         3 000077   000076 402007                    MPY     62,DL
         3 000100   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000101   000015 720106                    LXL0    13,QL,PR0
         3 000102   000107 600000 3                  TZE     s:1273

      720     1271    2             THEN
      721     1272    2                  CALL OCR$CREAD(I);

   1272  3 000103   000000 630400 4                  EPPR0   0
         3 000104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000105   000000 701000 xent               TSX1    OCR$CREAD
         3 000106   000000 011000                    NOP     0

      722     1273    2             OC_CONSOLE.ATTR (I) = '0'B;

   1273  3 000107   000000 236000 0                  LDQ     I
         3 000110   000076 402007                    MPY     62,DL
         3 000111   000000 220003                    LDX0    0,DU
         3 000112   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000113   000013 740106                    STX0    11,QL,PR0

      723     1274    2             OC_CONSOLE.ATTRO (I) = '0'B;

   1274  3 000114   000000 236000 0                  LDQ     I
         3 000115   000076 402007                    MPY     62,DL
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:133  
         3 000116   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000117   000014 740106                    STX0    12,QL,PR0

      724     1275                                                /**/
      725     1276    2             OC_CONSOLE.ACTIVE(I) = '0'B /*FALSE#*/;

   1276  3 000120   000000 236000 0                  LDQ     I
         3 000121   000076 402007                    MPY     62,DL
         3 000122   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000123   000000 621006                    EAX1    0,QL
         3 000124   000006 236000 4                  LDQ     6
         3 000125   000017 356111                    ANSQ    15,X1,PR0

      726     1277    2             OC_#CONSOLES = OC_#CONSOLES - 1;

   1277  3 000126   000001 336007                    LCQ     1,DL
         3 000127   000000 056000 xsym               ASQ     OC_#CONSOLES

      727     1278    2           END;                            /* IF OKAY TO DELETE */

      728     1279    1        RETURN;

   1279  3 000130   000000 702200 xent               TSX2  ! X66_ARET
      729     1280    1   END OCP$DELSTA;
      730     1281        %EOD;

PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:134  
--  Include file information  --

   SS_SCHED_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$DELSTA.
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:135  

 **** Variables and constants ****

  ****  Section 000  Data  OCP$DELSTA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(576)   r     1 DEACT                      0-0-0/w UBIN        r     1 I
    32-0-0/d STRC(144)   r     1 KILL_GHOST                22-0-0/w STRC(288)   r     1 STA

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @THIS_STATION             *0-0-0/c CHAR(8)     r     1 THIS_STATION

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OC_#CONSOLES               0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/c CHAR(256)   r     1 OC_KEYINBUF                0-0-0/w BIT         r     1 OC_LIST
     0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 B$CGAURD                   0-0-0N  NULL        r     1 M$OCCG
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCP$DELSTA requires 89 words for executable code.
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:136  
   Procedure OCP$DELSTA requires 10 words of local(AUTO) storage.
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:137  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:138  
          MINI XREF LISTING

B$CGAURD.STATION
       384**DCL       384--REDEF    1266>>ASSIGN
DEACT
      1181**DCL      1267<>CALL
DEACT.V
      1182**DCL      1181--DCLINIT
DEACT.V.DVBYTE.REREAD#
      1184**DCL      1184--REDEF
I
        27**DCL      1249<<ASSIGN   1250<>CALL     1251>>IF       1256<>CALL     1257>>IF       1260>>ASSIGN
      1261>>ASSIGN   1262>>ASSIGN   1263>>ASSIGN   1270>>IF       1272<>CALL     1273>>ASSIGN   1274>>ASSIGN
      1276>>ASSIGN
IGNORE_IT
      1263**LABEL    1264--CALLALT
KILL_GHOST
      1234**DCL      1264<>CALL
KILL_GHOST.V
      1234**DCL      1234--DCLINIT
KILL_GHOST.V.USER#
      1234**DCL      1260<<ASSIGN
M$DEACTIVATE
       155**DCL-ENT  1267--CALL
M$RUE
       201**DCL-ENT  1264--CALL
NEXT_LINE
      1266**LABEL    1267--CALLALT
OCL$WRITE_CONSOLE_REC
        26**DCL-ENT  1256--CALL
OCP$FINDCX
        24**DCL-ENT  1250--CALL
OCR$CREAD
        25**DCL-ENT  1272--CALL
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:139  
OC_#CONSOLES
       312**DCL      1277<<ASSIGN   1277>>ASSIGN
OC_CONSOLE.ACTIVE
       324**DCL      1276<<ASSIGN
OC_CONSOLE.ATTR
       321**DCL       321--REDEF    1273<<ASSIGN
OC_CONSOLE.ATTRO
       322**DCL       322--REDEF    1274<<ASSIGN
OC_CONSOLE.CID
       320**DCL       321--REDEF
OC_CONSOLE.GHST
       324**DCL      1262<<ASSIGN
OC_CONSOLE.GHSTRD
       324**DCL      1263<<ASSIGN
OC_CONSOLE.STATION
       319**DCL       319--REDEF
OC_CONSOLE.SYSID
       321**DCL      1257>>IF       1260>>ASSIGN   1261<<ASSIGN
OC_CONSOLE.X_DCBNUM
       323**DCL      1270>>IF
OC_CONSOLE$
       318**DCL       319--IMP-PTR  1257>>IF       1260>>ASSIGN   1261>>ASSIGN   1262>>ASSIGN   1263>>ASSIGN
      1270>>IF       1273>>ASSIGN   1274>>ASSIGN   1276>>ASSIGN
OC_DIR
       361**DCL       361--REDEF
OC_INTBIT
       361**DCL       362--REDEF
OC_INTMSG
       238**DCL       251--REDEF
OC_INTMSG.FLAGS
       245**DCL       246--REDEF
OC_INTMSG.MESS
       251**DCL       251--REDEF
OC_INTMSG.MSGID
       241**DCL       242--REDEF
OC_INTMSG.WSN
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:140  
       248**DCL       249--REDEF
OC_KEYINBUF
       315**DCL      1266--ASSIGN
OC_LIST
       364**DCL      1254>>IF
OC_MASK
       362**DCL       362--REDEF
OC_MAXCONSOLE
       318**DCL      1249>>ASSIGN   1251>>IF
OC_MESSBUF
       253**DCL       268--REDEF     282--REDEF
OC_MESSBUF.FLAGS
       260**DCL       261--REDEF
OC_MESSBUF.MESS
       266**DCL       266--REDEF
OC_MESSBUF.MSGID
       256**DCL       257--REDEF
OC_MESSBUF.WSN
       263**DCL       264--REDEF
OC_MESSBUF1.FLAGS
       275**DCL       276--REDEF
OC_MESSBUF1.LEN
       281**DCL       281--REDEF
OC_MESSBUF1.MSGID
       271**DCL       272--REDEF
OC_MESSBUF1.WSN
       278**DCL       279--REDEF
OC_MSGBUFFER
       284**DCL       299--REDEF
OC_MSGBUFFER.FLAGS
       291**DCL       292--REDEF
OC_MSGBUFFER.MESS
       297**DCL       297--REDEF
OC_MSGBUFFER.MSGID
       287**DCL       288--REDEF
OC_MSGBUFFER.WSN
PL6.E3A0      #004=OCP$DELSTA File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:05 Page:141  
       294**DCL       295--REDEF
OC_MSGBUFFER2.FLAGS
       306**DCL       307--REDEF
OC_MSGBUFFER2.MSGID
       302**DCL       303--REDEF
OC_MSGBUFFER2.WSN
       309**DCL       310--REDEF
OC_PARAM
       317**DCL       317--REDEF
OC_QUEUE.PARMC
       316**DCL       316--REDEF
STA
      1206**DCL      1181--DCLINIT
STA.MSGIDXT
      1216**DCL      1219--REDEF
STA.STATION#
      1210**DCL      1266<<ASSIGN
THIS_STATION
        22**DCL        20--PROC     1250<>CALL

PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:142  
      731        1        /*M* OCP$OCCG KEYINs routine to process events on OCCG */
      732        2        /*T***********************************************************/
      733        3        /*T*                                                         */
      734        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      735        5        /*T*                                                         */
      736        6        /*T***********************************************************/
      737        7        %SET LISTSUB='1'B;
      738        8                                                /**/
      739        9        /*
      740       10         ###    ###   ####    #    ###    ###    ###    ###
      741       11        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #
      742       12        #   #  #      #   # # #   #   #  #      #      #
      743       13        #   #  #      ####   ###  #   #  #      #      #
      744       14        #   #  #      #       # # #   #  #      #      #  ##
      745       15        #   #  #   #  #      ###  #   #  #   #  #   #  #   #
      746       16         ###    ###   #       #    ###    ###    ###    ###
      747       17                                                                   */
      748       18                                                /**/
      749       19                                                /**/
      750       20        OCP$OCCG: PROC;                         /* routine to process events on OCCG  */
      751       21                                                /**/
      752       22                                                /**/
      753       23        %INCLUDE OCI_SUBS_C;
      754      121        %INCLUDE OC_SUBS_C;
      755      852        %INCLUDE OCP_DATA_R;
      756      869        %INCLUDE CP_6;
      757      950        %INCLUDE OC_DAT_R;
      758     1111             %B$CGAURD (STCLASS=BASED);
      759     1130             %EQU_CG;
      760     1178    1   DCL OCP$ADDSTA ENTRY(1);
      761     1179                  %VLP_STATION (FPTN=STA);
      762     1206             %FPT_ACTIVATE  (FPTN=ADD_BACK,
      763     1207                                 DCB=M$OCCG,
      764     1208                                 STATION=STA);
      765     1231                                                /**/
      766     1232             %FPT_EXTEND (FPTN=EXTND_OCCG,
      767     1233                            DCB=M$OCCG,
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:143  
      768     1234                            SIZ=50);
      769     1248                                                /**/
      770     1249             %FPT_CGINFO (FPTN=OC_CGINFO,
      771     1250                            DCB=M$OCCG,
      772     1251                            CGCP=OC_CGCP,
      773     1252                            STALIST=OC_STAS,
      774     1253                            STAFC=DUMP,
      775     1254                            STCLASS=CONSTANT);
      776     1274                                                /**/
      777     1275             %VLP_CGCP (FPTN=OC_CGCP);
      778     1318                                                /**/
      779     1319             %VLP_CGSTAL (FPTN = OC_STASB,STCLASS=BASED);
      780     1344                                                /**/
      781     1345    1   DCL OC_STAS (0:631) UBIN STATIC;
      782     1346                                                /**/
      783     1347             %FPT_CGCTL (FPTN=OC_CGCTL,
      784     1348                            DCB=M$OCCG,
      785     1349                            CGCP=OC_CGCP,
      786     1350                            STCLASS=CONSTANT);
      787     1373                                                /**/
      788     1374    1   DCL OCP$DELSTA ENTRY(1);
      789     1375    1   DCL OCP$FINDCX ENTRY(2);
      790     1376    1   DCL OCW$WRITE ENTRY(5);
      791     1377    1   DCL OCO$IWRITE ENTRY(8);
      792     1378                                                /**/
      793     1379    1   DCL M$OCCG DCB;
      794     1380    1   DCL EVENT UBIN WORD STATIC;
      795     1381    1   DCL I UBIN WORD STATIC;
      796     1382    1   DCL M_TBRK CHAR(0) STATIC INIT(' !!I''m alive');
      797     1383    1   DCL M_DOPN CHAR(0) STATIC INIT(' !!DOPN ON OCCG');
      798     1384    1   DCL M_DCLS CHAR(0) STATIC INIT(' !!DCLS ON OCCG');
      799     1385                                                /**/
      800     1386    1   DCL MSG# UBIN HALF UNAL STATIC INIT(369 /* XOFF_MSG# */);
      801     1387    1   DCL NP# UBIN BYTE UNAL STATIC INIT(1);
      802     1388
      803     1389        %EJECT;
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:144  
      804     1390                                                /**/
      805     1391                                                /**/
      806     1392        /*
      807     1393                  Begin  O C P $ O C C G  main
      808     1394                                                */
      809     1395                                                /**/
      810     1396        /*          */
      811     1397    1        EVENT = ADDR(OC_KEYINBUF)->B$CGAURD.EVENT;
      812     1398    2        DO CASE (EVENT);
      813     1399                                                /**/
      814     1400    2        CASE(%CG_DOPN#);      /* inform all system consoles of
      815     1401                                         seemingly impossible event */
      816     1402    2           CALL OCW$WRITE (M_DOPN, LENGTHC (M_DOPN), '200000'O /* M_SYS  */,
      817     1403    2                OCP_NON_STA);
      818     1404                                                /**/
      819     1405    2        CASE(%CG_DCLS#);      /* if CASE(%CG_DOPN#) happens, anything
      820     1406                                         is possible                          */
      821     1407    2           CALL OCW$WRITE (M_DCLS, LENGTHC (M_DCLS), '200000'O /* M_SYS  */,
      822     1408    2                OCP_NON_STA);
      823     1409                                                /**/
      824     1410    2        CASE(%CG_TCON#);                   /* add station to KEYIN's list */
      825     1411    2           CALL OCP$ADDSTA(OC_KEYINBUF);
      826     1412                                                /**/
      827     1413    2        CASE(%CG_TDSC#);                   /* remove station from KEYIN's list */
      828     1414    2           CALL OCP$DELSTA(ADDR(OC_KEYINBUF)->B$CGAURD.STATION);
      829     1415                                                /**/
      830     1416    2        CASE(%CG_WARN#);              /* Increase comgroup disc & memory size */
      831     1417    2           CALL M$EXTEND (EXTND_OCCG) ALTRET (KEEP_GOING);
      832     1418    2   KEEP_GOING:;
      833     1419    2           CALL M$CGINFO (OC_CGINFO) ALTRET (KEEP_GOING2);
      834     1420    2   KEEP_GOING2:;
      835     1421    2           OC_CGCP.MAXPG# = OC_CGCP.MAXPG# + 25;
      836     1422    2           CALL M$CGCTL (OC_CGCTL) ALTRET (KEEP_GOING3);
      837     1423    2   KEEP_GOING3:;
      838     1424
      839     1425    3           DO I = 0 TO ADDR(OC_STAS)->OC_STASB.FOUND#-1;
      840     1426
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:145  
      841     1427    3                IF ADDR(OC_STAS)->OC_STASB.LIST.MSGCNT#(I) > 10000
      842     1428    4                THEN DO;
      843     1429    4                     CALL OCP$DELSTA (ADDR(OC_STAS) -> OC_STASB.LIST.NAME#(I));
      844     1430    4                     CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#,
              1430                              '010000000000'O,
      845     1431    4                          ADDR(OC_STAS) -> OC_STASB.LIST.NAME#(I),
      846     1432    4                          0, '        ', 0);
      847     1433    4                   END;                    /* DO IF MSGCNT HIGH */
      848     1434    3              END;                         /* DO I */
      849     1435                                                /**/
      850     1436    2        CASE(%CG_TBRK#);              /* tell console that we're still with him */
      851     1437                                                /**/
      852     1438    2           I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      853     1439                                                /* Find this console */
      854     1440    2           STA.STATION# = OC_KEYINBUF$ -> B$CGAURD.STATION;
      855     1441    2           CALL OCP$FINDCX (I, STA.STATION#);
      856     1442    2           IF I ~= OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
      857     1443    2           THEN
      858     1444    3           DO;
      859     1445    3                IF ~OC_CONSOLE.ACTIVE(I)
      860     1446    3                THEN
      861     1447    4                DO;
      862     1448    4                     OC_CONSOLE.ACTIVE(I) = '1'B /*TRUE#*/;
      863     1449    4                     CALL M$ACTIVATE (ADD_BACK) ALTRET(EH_);
      864     1450    4   EH_ :             ;
      865     1451    4                   END;                    /* DO IF NOT ACTIVE */
      866     1452                                                /* IMPROVEMENT GOES HERE */
      867     1453                                           /* If console has a console
      868     1454                                                ghost, send break event to
      869     1455                                                console ghost */
      870     1456    3              END;                         /* DO IF FOUND */
      871     1457                                                /**/
      872     1458    2        END;
      873     1459    1        RETURN;
      874     1460    1   END OCP$OCCG;
      875     1461        %EOD;

PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:146  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$OCCG.

   Procedure OCP$OCCG requires 125 words for executable code.
   Procedure OCP$OCCG requires 12 words of local(AUTO) storage.

PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:147  

 Object Unit name= OCP$OCCG                                   File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:05:41.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   695   1267  OCP$OCCG
    2  RoData even  UTS    105    151  OCP$OCCG
    3   DCB   even  none     0      0  M$OCCG
    4   Proc  even  none   125    175  OCP$OCCG
    5  RoData even  none    22     26  OCP$OCCG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  OCP$OCCG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 OCW$WRITE
         yes           Std       1 OCP$ADDSTA
         yes           Std       1 OCP$DELSTA
         yes           Std       8 OCO$IWRITE
         yes           Std       2 OCP$FINDCX
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:148  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     OCP_FREE_HEAD                         OCP_USED_HEAD                         OCP_USED_TAIL
     OCP_NON_STA                           M$UC                                  OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_KEYINBUF
     OC_PARAM                              OC_CONSOLE$                           OC_MAXCONSOLE
     OC_KEYINBUF$                          OC_DIR                                OC_INTBIT
     OC_MASK                               M$OCCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:149  


      731        1        /*M* OCP$OCCG KEYINs routine to process events on OCCG */
      732        2        /*T***********************************************************/
      733        3        /*T*                                                         */
      734        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      735        5        /*T*                                                         */
      736        6        /*T***********************************************************/
      737        7        %SET LISTSUB='1'B;
      738        8                                                /**/
      739        9        /*
      740       10         ###    ###   ####    #    ###    ###    ###    ###
      741       11        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #
      742       12        #   #  #      #   # # #   #   #  #      #      #
      743       13        #   #  #      ####   ###  #   #  #      #      #
      744       14        #   #  #      #       # # #   #  #      #      #  ##
      745       15        #   #  #   #  #      ###  #   #  #   #  #   #  #   #
      746       16         ###    ###   #       #    ###    ###    ###    ###
      747       17                                                                   */
      748       18                                                /**/
      749       19                                                /**/
      750       20        OCP$OCCG: PROC;                         /* routine to process events on OCCG  */

     20  4 000000   000000 700200 xent  OCP$OCCG     TSX0  ! X66_AUTO_0
         4 000001   000014 000000                    ZERO    12,0

      751       21                                                /**/
      752       22                                                /**/
      753       23        %INCLUDE OCI_SUBS_C;
      754      121        %INCLUDE OC_SUBS_C;
      755      852        %INCLUDE OCP_DATA_R;
      756      869        %INCLUDE CP_6;
      757      950        %INCLUDE OC_DAT_R;
      758     1111             %B$CGAURD (STCLASS=BASED);
      759     1130             %EQU_CG;
      760     1178    1   DCL OCP$ADDSTA ENTRY(1);
      761     1179                  %VLP_STATION (FPTN=STA);
      762     1206             %FPT_ACTIVATE  (FPTN=ADD_BACK,
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:150  
      763     1207                                 DCB=M$OCCG,
      764     1208                                 STATION=STA);
      765     1231                                                /**/
      766     1232             %FPT_EXTEND (FPTN=EXTND_OCCG,
      767     1233                            DCB=M$OCCG,
      768     1234                            SIZ=50);
      769     1248                                                /**/
      770     1249             %FPT_CGINFO (FPTN=OC_CGINFO,
      771     1250                            DCB=M$OCCG,
      772     1251                            CGCP=OC_CGCP,
      773     1252                            STALIST=OC_STAS,
      774     1253                            STAFC=DUMP,
      775     1254                            STCLASS=CONSTANT);
      776     1274                                                /**/
      777     1275             %VLP_CGCP (FPTN=OC_CGCP);
      778     1318                                                /**/
      779     1319             %VLP_CGSTAL (FPTN = OC_STASB,STCLASS=BASED);
      780     1344                                                /**/
      781     1345    1   DCL OC_STAS (0:631) UBIN STATIC;
      782     1346                                                /**/
      783     1347             %FPT_CGCTL (FPTN=OC_CGCTL,
      784     1348                            DCB=M$OCCG,
      785     1349                            CGCP=OC_CGCP,
      786     1350                            STCLASS=CONSTANT);
      787     1373                                                /**/
      788     1374    1   DCL OCP$DELSTA ENTRY(1);
      789     1375    1   DCL OCP$FINDCX ENTRY(2);
      790     1376    1   DCL OCW$WRITE ENTRY(5);
      791     1377    1   DCL OCO$IWRITE ENTRY(8);
      792     1378                                                /**/
      793     1379    1   DCL M$OCCG DCB;
      794     1380    1   DCL EVENT UBIN WORD STATIC;
      795     1381    1   DCL I UBIN WORD STATIC;
      796     1382    1   DCL M_TBRK CHAR(0) STATIC INIT(' !!I''m alive');
      797     1383    1   DCL M_DOPN CHAR(0) STATIC INIT(' !!DOPN ON OCCG');
      798     1384    1   DCL M_DCLS CHAR(0) STATIC INIT(' !!DCLS ON OCCG');
      799     1385                                                /**/
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:151  
      800     1386    1   DCL MSG# UBIN HALF UNAL STATIC INIT(369 /* XOFF_MSG# */);
      801     1387    1   DCL NP# UBIN BYTE UNAL STATIC INIT(1);
      802     1388
      803     1389        %EJECT;
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:152  
      804     1390                                                /**/
      805     1391                                                /**/
      806     1392        /*
      807     1393                  Begin  O C P $ O C C G  main
      808     1394                                                */
      809     1395                                                /**/
      810     1396        /*          */
      811     1397    1        EVENT = ADDR(OC_KEYINBUF)->B$CGAURD.EVENT;

   1397  4 000002   000000 235000 xsym               LDA     OC_KEYINBUF
         4 000003   001250 755000 1                  STA     EVENT

      812     1398    2        DO CASE (EVENT);

   1398  4 000004   000012 115007                    CMPA    10,DL
         4 000005   000007 602005 4                  TNC     s:1398+3,AL
         4 000006   000174 710000 4                  TRA     EH_
         4 000007   000021 710000 4                  TRA     s:1402
         4 000010   000026 710000 4                  TRA     s:1407
         4 000011   000033 710000 4                  TRA     s:1411
         4 000012   000040 710000 4                  TRA     s:1414
         4 000013   000132 710000 4                  TRA     s:1438
         4 000014   000174 710000 4                  TRA     EH_
         4 000015   000174 710000 4                  TRA     EH_
         4 000016   000174 710000 4                  TRA     EH_
         4 000017   000174 710000 4                  TRA     EH_
         4 000020   000045 710000 4                  TRA     s:1417

      813     1399                                                /**/
      814     1400    2        CASE(%CG_DOPN#);      /* inform all system consoles of

      815     1401                                         seemingly impossible event */
      816     1402    2           CALL OCW$WRITE (M_DOPN, LENGTHC (M_DOPN), '200000'O /* M_SYS  */,

   1402  4 000021   000002 630400 5                  EPPR0   2
         4 000022   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000023   000000 701000 xent               TSX1    OCW$WRITE
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:153  
         4 000024   000000 011000                    NOP     0
         4 000025   000174 710000 4                  TRA     EH_

      817     1403    2                OCP_NON_STA);
      818     1404                                                /**/
      819     1405    2        CASE(%CG_DCLS#);      /* if CASE(%CG_DOPN#) happens, anything

      820     1406                                         is possible                          */
      821     1407    2           CALL OCW$WRITE (M_DCLS, LENGTHC (M_DCLS), '200000'O /* M_SYS  */,

   1407  4 000026   000006 630400 5                  EPPR0   6
         4 000027   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000030   000000 701000 xent               TSX1    OCW$WRITE
         4 000031   000000 011000                    NOP     0
         4 000032   000174 710000 4                  TRA     EH_

      822     1408    2                OCP_NON_STA);
      823     1409                                                /**/
      824     1410    2        CASE(%CG_TCON#);                   /* add station to KEYIN's list */

      825     1411    2           CALL OCP$ADDSTA(OC_KEYINBUF);

   1411  4 000033   000012 630400 5                  EPPR0   10
         4 000034   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000035   000000 701000 xent               TSX1    OCP$ADDSTA
         4 000036   000000 011000                    NOP     0
         4 000037   000174 710000 4                  TRA     EH_

      826     1412                                                /**/
      827     1413    2        CASE(%CG_TDSC#);                   /* remove station from KEYIN's list */

      828     1414    2           CALL OCP$DELSTA(ADDR(OC_KEYINBUF)->B$CGAURD.STATION);

   1414  4 000040   000013 630400 5                  EPPR0   11
         4 000041   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000042   000000 701000 xent               TSX1    OCP$DELSTA
         4 000043   000000 011000                    NOP     0
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:154  
         4 000044   000174 710000 4                  TRA     EH_

      829     1415                                                /**/
      830     1416    2        CASE(%CG_WARN#);              /* Increase comgroup disc & memory size */

      831     1417    2           CALL M$EXTEND (EXTND_OCCG) ALTRET (KEEP_GOING);

   1417  4 000045   000030 630400 1                  EPPR0   EXTND_OCCG
         4 000046   440005 713400                    CLIMB   alt,+16389
         4 000047   400000 401760                    pmme    nvectors=1
         4 000050   000051 702000 4                  TSX2    KEEP_GOING

   1417  4 000051                       KEEP_GOING   null
      832     1418    2   KEEP_GOING:;
      833     1419    2           CALL M$CGINFO (OC_CGINFO) ALTRET (KEEP_GOING2);

   1419  4 000051   000000 630400 2                  EPPR0   OC_CGINFO
         4 000052   500004 713400                    CLIMB   alt,+32772
         4 000053   411400 401760                    pmme    nvectors=20
         4 000054   000055 702000 4                  TSX2    KEEP_GOING2

   1417  4 000055                       KEEP_GOING2  null
      834     1420    2   KEEP_GOING2:;
      835     1421    2           OC_CGCP.MAXPG# = OC_CGCP.MAXPG# + 25;

   1421  4 000055   000042 220000 1                  LDX0    OC_CGCP+6
         4 000056   000031 621010                    EAX1    25,X0
         4 000057   000042 741000 1                  STX1    OC_CGCP+6

      836     1422    2           CALL M$CGCTL (OC_CGCTL) ALTRET (KEEP_GOING3);

   1422  4 000060   000062 630400 2                  EPPR0   OC_CGCTL
         4 000061   500003 713400                    CLIMB   alt,+32771
         4 000062   411400 401760                    pmme    nvectors=20
         4 000063   000064 702000 4                  TSX2    KEEP_GOING3

   1421  4 000064                       KEEP_GOING3  null
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:155  
      837     1423    2   KEEP_GOING3:;
      838     1424
      839     1425    3           DO I = 0 TO ADDR(OC_STAS)->OC_STASB.FOUND#-1;

   1425  4 000064   001251 450000 1                  STZ     I
         4 000065   000126 710000 4                  TRA     s:1434+3

      840     1426
      841     1427    3                IF ADDR(OC_STAS)->OC_STASB.LIST.MSGCNT#(I) > 10000

   1427  4 000066   001251 235000 1                  LDA     I
         4 000067   000003 735000                    ALS     3
         4 000070   000064 235005 1                  LDA     OC_STAS+4,AL
         4 000071   023421 115007                    CMPA    10001,DL
         4 000072   000123 602000 4                  TNC     s:1434

      842     1428    4                THEN DO;

      843     1429    4                     CALL OCP$DELSTA (ADDR(OC_STAS) -> OC_STASB.LIST.NAME#(I));

   1429  4 000073   001251 236000 1                  LDQ     I
         4 000074   000025 736000                    QLS     21
         4 000075   000014 036000 5                  ADLQ    12
         4 000076   200004 756100                    STQ     4,,AUTO
         4 000077   200004 630500                    EPPR0   4,,AUTO
         4 000100   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000101   000000 701000 xent               TSX1    OCP$DELSTA
         4 000102   000000 011000                    NOP     0

      844     1430    4                     CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#,
              1430                              '010000000000'O,

   1430  4 000103   000016 237000 5                  LDAQ    14
         4 000104   200012 757100                    STAQ    10,,AUTO
         4 000105   000017 236000 5                  LDQ     15
         4 000106   200011 756100                    STQ     9,,AUTO
         4 000107   001251 236000 1                  LDQ     I
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:156  
         4 000110   000025 736000                    QLS     21
         4 000111   000014 036000 5                  ADLQ    12
         4 000112   200010 756100                    STQ     8,,AUTO
         4 000113   000020 237000 5                  LDAQ    16
         4 000114   200006 757100                    STAQ    6,,AUTO
         4 000115   000022 237000 5                  LDAQ    18
         4 000116   200004 757100                    STAQ    4,,AUTO
         4 000117   200004 630500                    EPPR0   4,,AUTO
         4 000120   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 000121   000000 701000 xent               TSX1    OCO$IWRITE
         4 000122   000000 011000                    NOP     0

      845     1431    4                          ADDR(OC_STAS) -> OC_STASB.LIST.NAME#(I),
      846     1432    4                          0, '        ', 0);
      847     1433    4                   END;                    /* DO IF MSGCNT HIGH */

      848     1434    3              END;                         /* DO I */

   1434  4 000123   001251 235000 1                  LDA     I
         4 000124   000001 035007                    ADLA    1,DL
         4 000125   001251 755000 1                  STA     I
         4 000126   001251 236000 1                  LDQ     I
         4 000127   000060 116000 1                  CMPQ    OC_STAS
         4 000130   000066 602000 4                  TNC     s:1427
         4 000131   000174 710000 4                  TRA     EH_

      849     1435                                                /**/
      850     1436    2        CASE(%CG_TBRK#);              /* tell console that we're still with him */

      851     1437                                                /**/
      852     1438    2           I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   1438  4 000132   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000133   000022 772000                    QRL     18
         4 000134   000001 036007                    ADLQ    1,DL
         4 000135   001251 756000 1                  STQ     I

PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:157  
      853     1439                                                /* Find this console */
      854     1440    2           STA.STATION# = OC_KEYINBUF$ -> B$CGAURD.STATION;

   1440  4 000136   000000 470400 xsym               LDP0    OC_KEYINBUF$
         4 000137   040000 100500                    MLR     fill='040'O
         4 000140   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         4 000141   000000 000010 1                  ADSC9   STA                      cn=0,n=8

      855     1441    2           CALL OCP$FINDCX (I, STA.STATION#);

   1441  4 000142   000024 630400 5                  EPPR0   20
         4 000143   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000144   000000 701000 xent               TSX1    OCP$FINDCX
         4 000145   000000 011000                    NOP     0

      856     1442    2           IF I ~= OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */

   1442  4 000146   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000147   000022 772000                    QRL     18
         4 000150   000001 036007                    ADLQ    1,DL
         4 000151   001251 116000 1                  CMPQ    I
         4 000152   000174 600000 4                  TZE     EH_

      857     1443    2           THEN
      858     1444    3           DO;

      859     1445    3                IF ~OC_CONSOLE.ACTIVE(I)

   1445  4 000153   001251 236000 1                  LDQ     I
         4 000154   000076 402007                    MPY     62,DL
         4 000155   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000156   000017 236106                    LDQ     15,QL,PR0
         4 000157   000027 736000                    QLS     23
         4 000160   400000 376003                    ANQ     -131072,DU
         4 000161   400000 676003                    ERQ     -131072,DU
         4 000162   000174 600000 4                  TZE     EH_

PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:158  
      860     1446    3                THEN
      861     1447    4                DO;

      862     1448    4                     OC_CONSOLE.ACTIVE(I) = '1'B /*TRUE#*/;

   1448  4 000163   001251 236000 1                  LDQ     I
         4 000164   000076 402007                    MPY     62,DL
         4 000165   000000 620006                    EAX0    0,QL
         4 000166   010000 236007                    LDQ     4096,DL
         4 000167   000017 256110                    ORSQ    15,X0,PR0

      863     1449    4                     CALL M$ACTIVATE (ADD_BACK) ALTRET(EH_);

   1449  4 000170   000010 630400 1                  EPPR0   ADD_BACK
         4 000171   500000 713400                    CLIMB   alt,+32768
         4 000172   401400 401760                    pmme    nvectors=4
         4 000173   000174 702000 4                  TSX2    EH_

   1448  4 000174                       EH_          null
      864     1450    4   EH_ :             ;
      865     1451    4                   END;                    /* DO IF NOT ACTIVE */

      866     1452                                                /* IMPROVEMENT GOES HERE */
      867     1453                                           /* If console has a console
      868     1454                                                ghost, send break event to
      869     1455                                                console ghost */
      870     1456    3              END;                         /* DO IF FOUND */

      871     1457                                                /**/
      872     1458    2        END;

      873     1459    1        RETURN;

   1459  4 000174   000000 702200 xent               TSX2  ! X66_ARET
      874     1460    1   END OCP$OCCG;
      875     1461        %EOD;

PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:159  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$OCCG.
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:160  

 **** Variables and constants ****

  ****  Section 001  Data  OCP$OCCG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/d STRC(576)   r     1 ADD_BACK                1250-0-0/w UBIN        r     1 EVENT
    30-0-0/d STRC(144)   r     1 EXTND_OCCG              1251-0-0/w UBIN        r     1 I
  1265-0-0/b UBIN(18)    r     1 MSG#                    1261-0-0/c CHAR(15)    r     1 M_DCLS
  1255-0-0/c CHAR(15)    r     1 M_DOPN                  1266-0-0/b UBIN(9)     r     1 NP#
    34-0-0/d STRC(720)   r     1 OC_CGCP                   60-0-0/w UBIN        r     1 OC_STAS(0:631)
     0-0-0/w STRC(288)   r     1 STA

  ****  Section 002 RoData OCP$OCCG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    62-0-0/d STRC(1872)  r     1 OC_CGCTL                   0-0-0/d STRC(1800)  r     1 OC_CGINFO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)     r     1 OCP_NON_STA                0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/c CHAR(256)   r     1 OC_KEYINBUF                0-0-0/w PTR         r     1 OC_KEYINBUF$
     0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 B$CGAURD                   0-0-0N  NULL        r     1 M$OCCG
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:161  
     0-0-0/d STRC(324)   r     1 OC_STASB


   Procedure OCP$OCCG requires 125 words for executable code.
   Procedure OCP$OCCG requires 12 words of local(AUTO) storage.
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:162  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:163  
          MINI XREF LISTING

ADD_BACK
      1219**DCL      1449<>CALL
ADD_BACK.V
      1220**DCL      1219--DCLINIT
ADD_BACK.V.DVBYTE.REREAD#
      1222**DCL      1222--REDEF
B$CGAURD.EVENT
      1127**DCL      1397>>ASSIGN
B$CGAURD.STATION
      1127**DCL      1127--REDEF    1414<>CALL     1440>>ASSIGN
EH_
      1448**LABEL    1449--CALLALT
EVENT
      1380**DCL      1397<<ASSIGN   1398>>DOCASE
EXTND_OCCG
      1245**DCL      1417<>CALL
EXTND_OCCG.V
      1245**DCL      1245--DCLINIT
I
      1381**DCL      1425<<DOINDEX  1427>>IF       1429>>CALL     1430>>CALL     1438<<ASSIGN   1441<>CALL
      1442>>IF       1445>>IF       1448>>ASSIGN
KEEP_GOING
      1417**LABEL    1417--CALLALT
KEEP_GOING2
      1417**LABEL    1419--CALLALT
KEEP_GOING3
      1421**LABEL    1422--CALLALT
M$ACTIVATE
       898**DCL-ENT  1449--CALL
M$CGCTL
       899**DCL-ENT  1422--CALL
M$CGINFO
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:164  
       899**DCL-ENT  1419--CALL
M$EXTEND
       882**DCL-ENT  1417--CALL
MSG#
      1386**DCL      1430<>CALL
M_DCLS
      1384**DCL      1407<>CALL     1407--CALL
M_DOPN
      1383**DCL      1402<>CALL     1402--CALL
NP#
      1387**DCL      1430<>CALL
OCO$IWRITE
      1377**DCL-ENT  1430--CALL
OCP$ADDSTA
      1178**DCL-ENT  1411--CALL
OCP$DELSTA
      1374**DCL-ENT  1414--CALL     1429--CALL
OCP$FINDCX
      1375**DCL-ENT  1441--CALL
OCP_FREE_HEAD
       861**DCL       862--REDEF
OCP_MSGBUF_FREE.B
       865**DCL       865--REDEF
OCP_NON_STA
       867**DCL      1402<>CALL     1407<>CALL
OCP_USED_HEAD
       862**DCL       863--REDEF
OCP_USED_TAIL
       863**DCL       863--REDEF
OCW$WRITE
      1376**DCL-ENT  1402--CALL     1407--CALL
OC_CGCP
      1287**DCL      1266--DCLINIT  1362--DCLINIT
OC_CGCP.DVBYTE.REREAD#
      1301**DCL      1302--REDEF
OC_CGCP.MAXPG#
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:165  
      1293**DCL      1421<<ASSIGN   1421>>ASSIGN
OC_CGCTL
      1361**DCL      1422<>CALL
OC_CGCTL.V
      1366**DCL      1361--DCLINIT
OC_CGINFO
      1265**DCL      1419<>CALL
OC_CGINFO.V
      1270**DCL      1265--DCLINIT
OC_CONSOLE.ACTIVE
      1067**DCL      1445>>IF       1448<<ASSIGN
OC_CONSOLE.ATTR
      1064**DCL      1064--REDEF
OC_CONSOLE.ATTRO
      1065**DCL      1065--REDEF
OC_CONSOLE.CID
      1063**DCL      1064--REDEF
OC_CONSOLE.STATION
      1062**DCL      1062--REDEF
OC_CONSOLE$
      1061**DCL      1062--IMP-PTR  1445>>IF       1448>>ASSIGN
OC_DIR
      1104**DCL      1104--REDEF
OC_INTBIT
      1104**DCL      1105--REDEF
OC_INTMSG
       981**DCL       994--REDEF
OC_INTMSG.FLAGS
       988**DCL       989--REDEF
OC_INTMSG.MESS
       994**DCL       994--REDEF
OC_INTMSG.MSGID
       984**DCL       985--REDEF
OC_INTMSG.WSN
       991**DCL       992--REDEF
OC_KEYINBUF
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:166  
      1058**DCL      1397--ASSIGN   1411<>CALL     1414--CALL
OC_KEYINBUF$
      1102**DCL      1440>>ASSIGN
OC_MASK
      1105**DCL      1105--REDEF
OC_MAXCONSOLE
      1061**DCL      1438>>ASSIGN   1442>>IF
OC_MESSBUF
       996**DCL      1011--REDEF    1025--REDEF
OC_MESSBUF.FLAGS
      1003**DCL      1004--REDEF
OC_MESSBUF.MESS
      1009**DCL      1009--REDEF
OC_MESSBUF.MSGID
       999**DCL      1000--REDEF
OC_MESSBUF.WSN
      1006**DCL      1007--REDEF
OC_MESSBUF1.FLAGS
      1018**DCL      1019--REDEF
OC_MESSBUF1.LEN
      1024**DCL      1024--REDEF
OC_MESSBUF1.MSGID
      1014**DCL      1015--REDEF
OC_MESSBUF1.WSN
      1021**DCL      1022--REDEF
OC_MSGBUFFER
      1027**DCL      1042--REDEF
OC_MSGBUFFER.FLAGS
      1034**DCL      1035--REDEF
OC_MSGBUFFER.MESS
      1040**DCL      1040--REDEF
OC_MSGBUFFER.MSGID
      1030**DCL      1031--REDEF
OC_MSGBUFFER.WSN
      1037**DCL      1038--REDEF
OC_MSGBUFFER2.FLAGS
PL6.E3A0      #005=OCP$OCCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:05 Page:167  
      1049**DCL      1050--REDEF
OC_MSGBUFFER2.MSGID
      1045**DCL      1046--REDEF
OC_MSGBUFFER2.WSN
      1052**DCL      1053--REDEF
OC_PARAM
      1060**DCL      1060--REDEF
OC_QUEUE.PARMC
      1059**DCL      1059--REDEF
OC_STAS
      1345**DCL      1266--DCLINIT  1425--DOINDEX  1427--IF       1429--CALL     1430--CALL
OC_STASB.FOUND#
      1337**DCL      1425>>DOINDEX
OC_STASB.LIST.MSGCNT#
      1340**DCL      1427>>IF
OC_STASB.LIST.NAME#
      1337**DCL      1429<>CALL     1430<>CALL
STA
      1191**DCL      1219--DCLINIT
STA.MSGIDXT
      1201**DCL      1204--REDEF
STA.STATION#
      1195**DCL      1440<<ASSIGN   1441<>CALL

PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:168  
      876        1        /*M* OCP$CSCG   handle Central-System-COMGROUP events */
      877        2        /*T***********************************************************/
      878        3        /*T*                                                         */
      879        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      880        5        /*T*                                                         */
      881        6        /*T***********************************************************/
      882        7        %SET LISTSUB='1'B;
      883        8        /*
      884        9         ###    ###   ####    #    ###    ###    ###    ###
      885       10        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #
      886       11        #   #  #      #   # # #   #      #      #      #
      887       12        #   #  #      ####   ###  #       ###   #      #
      888       13        #   #  #      #       # # #          #  #      #  ##
      889       14        #   #  #   #  #      ###  #   #  #   #  #   #  #   #
      890       15         ###    ###   #       #    ###    ###    ###    ###
      891       16                                                                   */
      892       17                                                /**/
      893       18                                                /**/
      894       19        OCP$CSCG: PROC;
      895       20        %INCLUDE CP_6;
      896      101             %EQU_CG;
      897      149             %B$CGAURD;
      898      168                                                /**/
      899      169    1   DCL OCD$MARKEM ENTRY(1);
      900      170                                                /**/
      901      171        %INCLUDE OCI_SUBS_C;
      902      269                                                /**/
      903      270    1   DCL I UBIN WORD STATIC ALIGNED;
      904      271                                                /**/
      905      272    1   DCL M$CSCG DCB;
      906      273        %INCLUDE JG_GHOSTS_C;
      907      363                                                /**/
      908      364             %JG_GHOSTS (FPTN=JG_GHOSTS,
      909      365                            ARRAY=YES,
      910      366                            STCLASS=STATIC);
      911      404                                                /**/
      912      405                                                /**/
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:169  
      913      406                                                /**/
      914      407        %FPT_FWCG (FPTN=FLUSH_OUTPUT,
      915      408                   DCB=M$CSCG,
      916      409                   CRITERIA=CGMA_FLUSH,
      917      410                   SCA=SCGMA_FLUSH,
      918      411                   QSELECT=DIRECT,
      919      412                   DELETE=YES);
      920      431
      921      432        %VLP_CGMA (FPTN=CGMA_FLUSH);
      922      459
      923      460        %VLP_SCGMA (FPTN=SCGMA_FLUSH,
      924      461                    DEST=YES);
      925      478
      926      479                  %VLP_STATION (FPTN=STAT,
      927      480                                 STATION=' ');
      928      507                                                /**/
      929      508             %FPT_ACTIVATE  (FPTN=KILL_GHOST,
      930      509                                      DCB=M$CSCG,
      931      510                                 STATION=STAT,
      932      511                                      DISCONNECT=YES);
      933      534                                                /**/
      934      535             %FPT_EXTEND (FPTN=EXTND_CSCG,
      935      536                            DCB=M$CSCG,
      936      537                            SIZ=50);
      937      551                                                /**/
      938      552             %FPT_CGINFO (FPTN=CS_CGINFO,
      939      553                            DCB=M$CSCG,
      940      554                            CGCP=CS_CGCP,
      941      555                            STCLASS=CONSTANT);
      942      575                                                /**/
      943      576             %VLP_CGCP (FPTN=CS_CGCP);
      944      619                                                /**/
      945      620             %FPT_CGCTL (FPTN=CS_CGCTL,
      946      621                            DCB=M$CSCG,
      947      622                            CGCP=CS_CGCP,
      948      623                            STCLASS=CONSTANT);
      949      646                                                /**/
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:170  
      950      647        %INCLUDE OC$PEND;
      951      692        %INCLUDE OC_DAT_R;
      952      853        %INCLUDE OCP_DATA_R;
      953      870                                                /**/
      954      871    1   DCL OCP$PENDRMV ENTRY(1);
      955      872    1   DCL EVENT UBIN WORD STATIC;
      956      873    1   DCL NEXT$ PTR STATIC;
      957      874    1   DCL STA CHAR(8) UNAL STATIC;
      958      875                                                /**/
      959      876    1   DCL 1 RESTA REDEF STA,
      960      877    1            2 TEXT CHAR(4) UNAL,
      961      878    1            2 SYSID UBIN(18) UNAL,
      962      879    1            2 * BIT(1) UNAL,
      963      880    1            2 CADDR UBIN(17) UNAL;
      964      881                                                /**/
      965      882                                                /**/
      966      883        %EJECT;
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:171  
      967      884                                                /**/
      968      885        /*
      969      886                  Begin  O C P $ C S C G  main
      970      887                                                         */
      971      888    1        EVENT = ADDR(OC_MSGBUFFER)->B$CGAURD.EVENT;
      972      889    1        STA = ADDR(OC_MSGBUFFER)->B$CGAURD.STATION;
      973      890    2        DO CASE (EVENT);
      974      891                                                /**/
      975      892    2        CASE (%CG_DOPN#);                  /* DCB open to comgroup */
      976      893                                                /**/
      977      894    2           IF RESTA.TEXT = 'GHST'
      978      895    2           THEN
      979      896    3           DO;
      980      897    4                DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      981      898    4                     IF RESTA.CADDR = OC_CONSOLE.CID(I)
      982      899    4                     THEN
      983      900    5                     DO;
      984      901    5                          IF OC_CONSOLE.ACTIVE(I)
      985      902    5                          THEN
      986      903    6                          DO;
      987      904    6                               OC_CONSOLE.GHST(I) = '1'B /*TRUE#*/;
      988      905    6                               OC_CONSOLE.SYSID(I) = RESTA.SYSID;
      989      906    6                               GOTO LOGGED_IN;
      990      907    6                             END;          /* IF ACTIVE */
      991      908    5                          ELSE
      992      909    5                               GOTO KILL_GHOST;
      993      910    5                        END;               /* SETTING UP GHST */
      994      911    4                   END;                    /* DO I = 0 TO MAX_CONSOLES# */
      995      912                                                /**/
      996      913    3   KILL_GHOST:  ;
      997      914    3                STAT.STATION# = STA;
      998      915    3                CALL M$DEACTIVATE (KILL_GHOST) ALTRET (LOGGED_IN);
      999      916                                                /**/
     1000      917    3   LOGGED_IN:   ;
     1001      918                                                /**/
     1002      919    3              END;                         /* IF GHST STATION */
     1003      920                                                /**/
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:172  
     1004      921    2        CASE (%CG_WARN#);                  /* Increase disc size and comgroup */
     1005      922    2           CALL M$EXTEND (EXTND_CSCG) ALTRET (NEXT_LINE);
     1006      923    2   NEXT_LINE:;
     1007      924    2           CALL M$CGINFO (CS_CGINFO) ALTRET (NEXT_LINE2);
     1008      925    2   NEXT_LINE2:;
     1009      926    2           CS_CGCP.MAXPG# = CS_CGCP.MAXPG# + 25;
     1010      927    2           CALL M$CGCTL (CS_CGCTL) ALTRET (NEXT_LINE3);
     1011      928    2   NEXT_LINE3:;
     1012      929                                                /**/
     1013      930    2        CASE (%CG_DCLS#);             /* remove pending reads for this station */
     1014      931                                                /**/
     1015      932    2           IF RESTA.TEXT = 'GHST'
     1016      933    2           THEN
     1017      934    3           DO;
     1018      935    4                DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1019      936    4                     IF RESTA.CADDR = OC_CONSOLE.CID(I)
     1020      937    4                     THEN
     1021      938    5                     DO;
     1022      939    5                          OC_CONSOLE.GHST(I) = '0'B /*FALSE#*/;
     1023      940    5                          OC_CONSOLE.SYSID(I) = 0;
     1024      941    5                          OC_CONSOLE.GHSTRD(I) = '0'B /*FALSE#*/;
     1025      942    5                          I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
     1026      943    5                        END;               /* DO IF FOUND */
     1027      944    4                   END;                    /* DO I=0 TO MAX_CONSOLES# */
     1028      945    3              END;                         /* DO IF GHST */
     1029      946    2           NEXT$ = OCP_USED_HEAD$;
     1030      947    3           DO WHILE (NEXT$ ~= ADDR (NIL));
     1031      948    3                IF NEXT$ -> OC$PEND.STATION = STA /* found one */
     1032      949    3                THEN
     1033      950    3                     CALL OCP$PENDRMV (NEXT$);
     1034      951    3                NEXT$ = NEXT$ -> OC$PEND.LINK$;
     1035      952    3              END;                         /* WHILE (NEXT$ ~= ADDR (NIL)         */
     1036      953                                                /**/
     1037      954    3           DO I = 0 TO ((LENGTHC (JG_GHOSTS)) / 8);
     1038      955    3                IF STA = JG_GHOSTS (I)
     1039      956    3                THEN GOTO DONT_FLUSH;
     1040      957    3              END;
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:173  
     1041      958
     1042      959    2           CGMA_FLUSH.DEST# = STA;
     1043      960    2           CALL M$FWCG (FLUSH_OUTPUT) ALTRET (DONT_FLUSH);
     1044      961    2   DONT_FLUSH: ;
     1045      962                                                /**/
     1046      963    2           IF OC_ZIP
     1047      964    2           THEN
     1048      965    2                CALL OCD$MARKEM (STA);
     1049      966                                                /**/
     1050      967                                                /**/
     1051      968    2        END;                               /* CASE (EVENT)                       */
     1052      969    1        RETURN;
     1053      970    1   END OCP$CSCG;
     1054      971        %EOD;

PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:174  
--  Include file information  --

   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$CSCG.

   Procedure OCP$CSCG requires 161 words for executable code.
   Procedure OCP$CSCG requires 6 words of local(AUTO) storage.

PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:175  

 Object Unit name= OCP$CSCG                                   File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:06:00.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   162    242  OCP$CSCG
    2   DCB   even  none     0      0  M$CSCG
    3  RoData even  UTS    103    147  OCP$CSCG
    4   Proc  even  none   161    241  OCP$CSCG
    5  RoData even  none     4      4  OCP$CSCG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  OCP$CSCG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 OCP$PENDRMV
         yes           Std       1 OCD$MARKEM
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:176  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$CSCG                                OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_PARAM
     OC_CONSOLE$                           OC_MAXCONSOLE                         OC_DIR
     OC_INTBIT                             OC_MASK                               OC_ZIP
     OCP_FREE_HEAD                         OCP_USED_HEAD                         OCP_USED_TAIL
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:177  


      876        1        /*M* OCP$CSCG   handle Central-System-COMGROUP events */
      877        2        /*T***********************************************************/
      878        3        /*T*                                                         */
      879        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      880        5        /*T*                                                         */
      881        6        /*T***********************************************************/
      882        7        %SET LISTSUB='1'B;
      883        8        /*
      884        9         ###    ###   ####    #    ###    ###    ###    ###
      885       10        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #
      886       11        #   #  #      #   # # #   #      #      #      #
      887       12        #   #  #      ####   ###  #       ###   #      #
      888       13        #   #  #      #       # # #          #  #      #  ##
      889       14        #   #  #   #  #      ###  #   #  #   #  #   #  #   #
      890       15         ###    ###   #       #    ###    ###    ###    ###
      891       16                                                                   */
      892       17                                                /**/
      893       18                                                /**/
      894       19        OCP$CSCG: PROC;

     19  4 000000   000000 700200 xent  OCP$CSCG     TSX0  ! X66_AUTO_0
         4 000001   000006 000000                    ZERO    6,0

      895       20        %INCLUDE CP_6;
      896      101             %EQU_CG;
      897      149             %B$CGAURD;
      898      168                                                /**/
      899      169    1   DCL OCD$MARKEM ENTRY(1);
      900      170                                                /**/
      901      171        %INCLUDE OCI_SUBS_C;
      902      269                                                /**/
      903      270    1   DCL I UBIN WORD STATIC ALIGNED;
      904      271                                                /**/
      905      272    1   DCL M$CSCG DCB;
      906      273        %INCLUDE JG_GHOSTS_C;
      907      363                                                /**/
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:178  
      908      364             %JG_GHOSTS (FPTN=JG_GHOSTS,
      909      365                            ARRAY=YES,
      910      366                            STCLASS=STATIC);
      911      404                                                /**/
      912      405                                                /**/
      913      406                                                /**/
      914      407        %FPT_FWCG (FPTN=FLUSH_OUTPUT,
      915      408                   DCB=M$CSCG,
      916      409                   CRITERIA=CGMA_FLUSH,
      917      410                   SCA=SCGMA_FLUSH,
      918      411                   QSELECT=DIRECT,
      919      412                   DELETE=YES);
      920      431
      921      432        %VLP_CGMA (FPTN=CGMA_FLUSH);
      922      459
      923      460        %VLP_SCGMA (FPTN=SCGMA_FLUSH,
      924      461                    DEST=YES);
      925      478
      926      479                  %VLP_STATION (FPTN=STAT,
      927      480                                 STATION=' ');
      928      507                                                /**/
      929      508             %FPT_ACTIVATE  (FPTN=KILL_GHOST,
      930      509                                      DCB=M$CSCG,
      931      510                                 STATION=STAT,
      932      511                                      DISCONNECT=YES);
      933      534                                                /**/
      934      535             %FPT_EXTEND (FPTN=EXTND_CSCG,
      935      536                            DCB=M$CSCG,
      936      537                            SIZ=50);
      937      551                                                /**/
      938      552             %FPT_CGINFO (FPTN=CS_CGINFO,
      939      553                            DCB=M$CSCG,
      940      554                            CGCP=CS_CGCP,
      941      555                            STCLASS=CONSTANT);
      942      575                                                /**/
      943      576             %VLP_CGCP (FPTN=CS_CGCP);
      944      619                                                /**/
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:179  
      945      620             %FPT_CGCTL (FPTN=CS_CGCTL,
      946      621                            DCB=M$CSCG,
      947      622                            CGCP=CS_CGCP,
      948      623                            STCLASS=CONSTANT);
      949      646                                                /**/
      950      647        %INCLUDE OC$PEND;
      951      692        %INCLUDE OC_DAT_R;
      952      853        %INCLUDE OCP_DATA_R;
      953      870                                                /**/
      954      871    1   DCL OCP$PENDRMV ENTRY(1);
      955      872    1   DCL EVENT UBIN WORD STATIC;
      956      873    1   DCL NEXT$ PTR STATIC;
      957      874    1   DCL STA CHAR(8) UNAL STATIC;
      958      875                                                /**/
      959      876    1   DCL 1 RESTA REDEF STA,
      960      877    1            2 TEXT CHAR(4) UNAL,
      961      878    1            2 SYSID UBIN(18) UNAL,
      962      879    1            2 * BIT(1) UNAL,
      963      880    1            2 CADDR UBIN(17) UNAL;
      964      881                                                /**/
      965      882                                                /**/
      966      883        %EJECT;
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:180  
      967      884                                                /**/
      968      885        /*
      969      886                  Begin  O C P $ C S C G  main
      970      887                                                         */
      971      888    1        EVENT = ADDR(OC_MSGBUFFER)->B$CGAURD.EVENT;

    888  4 000002   000000 235000 xsym               LDA     OC_MSGBUFFER
         4 000003   000236 755000 1                  STA     EVENT

      972      889    1        STA = ADDR(OC_MSGBUFFER)->B$CGAURD.STATION;

    889  4 000004   040000 100400                    MLR     fill='040'O
         4 000005   000001 000010 xsym               ADSC9   OC_MSGBUFFER+1           cn=0,n=8
         4 000006   000240 000010 1                  ADSC9   STA                      cn=0,n=8

      973      890    2        DO CASE (EVENT);

    890  4 000007   000012 115007                    CMPA    10,DL
         4 000010   000012 602005 4                  TNC     s:890+3,AL
         4 000011   000240 710000 4                  TRA     s:969
         4 000012   000024 710000 4                  TRA     s:894
         4 000013   000117 710000 4                  TRA     s:932
         4 000014   000240 710000 4                  TRA     s:969
         4 000015   000240 710000 4                  TRA     s:969
         4 000016   000240 710000 4                  TRA     s:969
         4 000017   000240 710000 4                  TRA     s:969
         4 000020   000240 710000 4                  TRA     s:969
         4 000021   000240 710000 4                  TRA     s:969
         4 000022   000240 710000 4                  TRA     s:969
         4 000023   000077 710000 4                  TRA     s:922

      974      891                                                /**/
      975      892    2        CASE (%CG_DOPN#);                  /* DCB open to comgroup */

      976      893                                                /**/
      977      894    2           IF RESTA.TEXT = 'GHST'

PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:181  
    894  4 000024   000240 236000 1                  LDQ     STA
         4 000025   000146 116000 3                  CMPQ    CS_CGCTL+52
         4 000026   000240 601000 4                  TNZ     s:969

      978      895    2           THEN
      979      896    3           DO;

      980      897    4                DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

    897  4 000027   000000 450000 1                  STZ     I
         4 000030   000064 710000 4                  TRA     s:911+3

      981      898    4                     IF RESTA.CADDR = OC_CONSOLE.CID(I)

    898  4 000031   000000 236000 1                  LDQ     I
         4 000032   000076 402007                    MPY     62,DL
         4 000033   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000034   000012 236106                    LDQ     10,QL,PR0
         4 000035   000022 772000                    QRL     18
         4 000036   200004 756100                    STQ     4,,AUTO
         4 000037   000241 236000 1                  LDQ     STA+1
         4 000040   377777 376007                    ANQ     131071,DL
         4 000041   200004 116100                    CMPQ    4,,AUTO
         4 000042   000061 601000 4                  TNZ     s:911

      982      899    4                     THEN
      983      900    5                     DO;

      984      901    5                          IF OC_CONSOLE.ACTIVE(I)

    901  4 000043   000000 236000 1                  LDQ     I
         4 000044   000076 402007                    MPY     62,DL
         4 000045   000017 236106                    LDQ     15,QL,PR0
         4 000046   010000 316007                    CANQ    4096,DL
         4 000047   000070 600000 4                  TZE     KILL_GHOST

      985      902    5                          THEN
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:182  
      986      903    6                          DO;

      987      904    6                               OC_CONSOLE.GHST(I) = '1'B /*TRUE#*/;

    904  4 000050   000000 236000 1                  LDQ     I
         4 000051   000076 402007                    MPY     62,DL
         4 000052   000000 620006                    EAX0    0,QL
         4 000053   400000 236007                    LDQ     -131072,DL
         4 000054   000017 256110                    ORSQ    15,X0,PR0

      988      905    6                               OC_CONSOLE.SYSID(I) = RESTA.SYSID;

    905  4 000055   000241 221000 1                  LDX1    STA+1
         4 000056   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000057   000012 441110                    SXL1    10,X0,PR0

      989      906    6                               GOTO LOGGED_IN;

    906  4 000060   000076 710000 4                  TRA     LOGGED_IN

      990      907    6                             END;          /* IF ACTIVE */
      991      908    5                          ELSE
      992      909    5                               GOTO KILL_GHOST;
      993      910    5                        END;               /* SETTING UP GHST */
      994      911    4                   END;                    /* DO I = 0 TO MAX_CONSOLES# */

    911  4 000061   000000 235000 1                  LDA     I
         4 000062   000001 035007                    ADLA    1,DL
         4 000063   000000 755000 1                  STA     I
         4 000064   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000065   000022 772000                    QRL     18
         4 000066   000000 116000 1                  CMPQ    I
         4 000067   000031 603000 4                  TRC     s:898

    909  4 000070                       KILL_GHOST   null
      995      912                                                /**/
      996      913    3   KILL_GHOST:  ;
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:183  
      997      914    3                STAT.STATION# = STA;

    914  4 000070   000240 237000 1                  LDAQ    STA
         4 000071   000156 757000 1                  STAQ    STAT

      998      915    3                CALL M$DEACTIVATE (KILL_GHOST) ALTRET (LOGGED_IN);

    915  4 000072   000166 630400 1                  EPPR0   KILL_GHOST
         4 000073   500001 713400                    CLIMB   alt,+32769
         4 000074   401400 401760                    pmme    nvectors=4
         4 000075   000076 702000 4                  TSX2    LOGGED_IN

    914  4 000076                       LOGGED_IN    null
      999      916                                                /**/
     1000      917    3   LOGGED_IN:   ;
     1001      918                                                /**/
     1002      919    3              END;                         /* IF GHST STATION */

    919  4 000076   000240 710000 4                  TRA     s:969

     1003      920                                                /**/
     1004      921    2        CASE (%CG_WARN#);                  /* Increase disc size and comgroup */

     1005      922    2           CALL M$EXTEND (EXTND_CSCG) ALTRET (NEXT_LINE);

    922  4 000077   000206 630400 1                  EPPR0   EXTND_CSCG
         4 000100   440005 713400                    CLIMB   alt,+16389
         4 000101   400000 401760                    pmme    nvectors=1
         4 000102   000103 702000 4                  TSX2    NEXT_LINE

    922  4 000103                       NEXT_LINE    null
     1006      923    2   NEXT_LINE:;
     1007      924    2           CALL M$CGINFO (CS_CGINFO) ALTRET (NEXT_LINE2);

    924  4 000103   000000 630400 3                  EPPR0   CS_CGINFO
         4 000104   500004 713400                    CLIMB   alt,+32772
         4 000105   411400 401760                    pmme    nvectors=20
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:184  
         4 000106   000107 702000 4                  TSX2    NEXT_LINE2

    922  4 000107                       NEXT_LINE2   null
     1008      925    2   NEXT_LINE2:;
     1009      926    2           CS_CGCP.MAXPG# = CS_CGCP.MAXPG# + 25;

    926  4 000107   000220 220000 1                  LDX0    CS_CGCP+6
         4 000110   000031 621010                    EAX1    25,X0
         4 000111   000220 741000 1                  STX1    CS_CGCP+6

     1010      927    2           CALL M$CGCTL (CS_CGCTL) ALTRET (NEXT_LINE3);

    927  4 000112   000062 630400 3                  EPPR0   CS_CGCTL
         4 000113   500003 713400                    CLIMB   alt,+32771
         4 000114   411400 401760                    pmme    nvectors=20
         4 000115   000116 702000 4                  TSX2    NEXT_LINE3

    926  4 000116   000240 710000 4     NEXT_LINE3   TRA     s:969

     1011      928    2   NEXT_LINE3:;
     1012      929                                                /**/
     1013      930    2        CASE (%CG_DCLS#);             /* remove pending reads for this station */

     1014      931                                                /**/
     1015      932    2           IF RESTA.TEXT = 'GHST'

    932  4 000117   000240 236000 1                  LDQ     STA
         4 000120   000146 116000 3                  CMPQ    CS_CGCTL+52
         4 000121   000164 601000 4                  TNZ     s:946

     1016      933    2           THEN
     1017      934    3           DO;

     1018      935    4                DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

    935  4 000122   000000 450000 1                  STZ     I
         4 000123   000160 710000 4                  TRA     s:944+3
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:185  

     1019      936    4                     IF RESTA.CADDR = OC_CONSOLE.CID(I)

    936  4 000124   000000 236000 1                  LDQ     I
         4 000125   000076 402007                    MPY     62,DL
         4 000126   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000127   000012 236106                    LDQ     10,QL,PR0
         4 000130   000022 772000                    QRL     18
         4 000131   200004 756100                    STQ     4,,AUTO
         4 000132   000241 236000 1                  LDQ     STA+1
         4 000133   377777 376007                    ANQ     131071,DL
         4 000134   200004 116100                    CMPQ    4,,AUTO
         4 000135   000155 601000 4                  TNZ     s:944

     1020      937    4                     THEN
     1021      938    5                     DO;

     1022      939    5                          OC_CONSOLE.GHST(I) = '0'B /*FALSE#*/;

    939  4 000136   000000 236000 1                  LDQ     I
         4 000137   000076 402007                    MPY     62,DL
         4 000140   000000 620006                    EAX0    0,QL
         4 000141   000000 236000 5                  LDQ     0
         4 000142   000017 356110                    ANSQ    15,X0,PR0

     1023      940    5                          OC_CONSOLE.SYSID(I) = 0;

    940  4 000143   000000 221003                    LDX1    0,DU
         4 000144   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000145   000012 441110                    SXL1    10,X0,PR0

     1024      941    5                          OC_CONSOLE.GHSTRD(I) = '0'B /*FALSE#*/;

    941  4 000146   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000147   000001 236000 5                  LDQ     1
         4 000150   000017 356110                    ANSQ    15,X0,PR0

PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:186  
     1025      942    5                          I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

    942  4 000151   000000 235000 xsym               LDA     OC_MAXCONSOLE
         4 000152   000022 771000                    ARL     18
         4 000153   000001 035007                    ADLA    1,DL
         4 000154   000000 755000 1                  STA     I

     1026      943    5                        END;               /* DO IF FOUND */

     1027      944    4                   END;                    /* DO I=0 TO MAX_CONSOLES# */

    944  4 000155   000000 235000 1                  LDA     I
         4 000156   000001 035007                    ADLA    1,DL
         4 000157   000000 755000 1                  STA     I
         4 000160   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000161   000022 772000                    QRL     18
         4 000162   000000 116000 1                  CMPQ    I
         4 000163   000124 603000 4                  TRC     s:936

     1028      945    3              END;                         /* DO IF GHST */

     1029      946    2           NEXT$ = OCP_USED_HEAD$;

    946  4 000164   000000 236000 xsym               LDQ     OCP_USED_HEAD
         4 000165   000237 756000 1                  STQ     NEXT$

     1030      947    3           DO WHILE (NEXT$ ~= ADDR (NIL));

    947  4 000166   000203 710000 4                  TRA     s:952

     1031      948    3                IF NEXT$ -> OC$PEND.STATION = STA /* found one */

    948  4 000167   000237 470400 1                  LDP0    NEXT$
         4 000170   040000 106500                    CMPC    fill='040'O
         4 000171   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         4 000172   000240 000010 1                  ADSC9   STA                      cn=0,n=8
         4 000173   000200 601000 4                  TNZ     s:951
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:187  

     1032      949    3                THEN
     1033      950    3                     CALL OCP$PENDRMV (NEXT$);

    950  4 000174   000002 630400 5                  EPPR0   2
         4 000175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000176   000000 701000 xent               TSX1    OCP$PENDRMV
         4 000177   000000 011000                    NOP     0

     1034      951    3                NEXT$ = NEXT$ -> OC$PEND.LINK$;

    951  4 000200   000237 470400 1                  LDP0    NEXT$
         4 000201   000000 236100                    LDQ     0,,PR0
         4 000202   000237 756000 1                  STQ     NEXT$

     1035      952    3              END;                         /* WHILE (NEXT$ ~= ADDR (NIL)         */

    952  4 000203   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000204   000167 601000 4                  TNZ     s:948

     1036      953                                                /**/
     1037      954    3           DO I = 0 TO ((LENGTHC (JG_GHOSTS)) / 8);

    954  4 000205   000000 450000 1                  STZ     I
         4 000206   000220 710000 4                  TRA     s:957+3

     1038      955    3                IF STA = JG_GHOSTS (I)

    955  4 000207   000000 235000 1                  LDA     I
         4 000210   000001 735000                    ALS     1
         4 000211   000000 620005                    EAX0    0,AL
         4 000212   000240 237000 1                  LDAQ    STA
         4 000213   000002 117010 1                  CMPAQ   JG_GHOSTS,X0
         4 000214   000232 600000 4                  TZE     DONT_FLUSH

     1039      956    3                THEN GOTO DONT_FLUSH;
     1040      957    3              END;
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:188  

    957  4 000215   000000 235000 1                  LDA     I
         4 000216   000001 035007                    ADLA    1,DL
         4 000217   000000 755000 1                  STA     I
         4 000220   000000 235000 1                  LDA     I
         4 000221   000031 115007                    CMPA    25,DL
         4 000222   000207 602000 4                  TNC     s:955

     1041      958
     1042      959    2           CGMA_FLUSH.DEST# = STA;

    959  4 000223   000240 237000 1                  LDAQ    STA
         4 000224   000145 755000 1                  STA     CGMA_FLUSH+9
         4 000225   000146 756000 1                  STQ     CGMA_FLUSH+10

     1043      960    2           CALL M$FWCG (FLUSH_OUTPUT) ALTRET (DONT_FLUSH);

    960  4 000226   000062 630400 1                  EPPR0   FLUSH_OUTPUT
         4 000227   500005 713400                    CLIMB   alt,+32773
         4 000230   406400 401760                    pmme    nvectors=14
         4 000231   000232 702000 4                  TSX2    DONT_FLUSH

    959  4 000232                       DONT_FLUSH   null
     1044      961    2   DONT_FLUSH: ;
     1045      962                                                /**/
     1046      963    2           IF OC_ZIP

    963  4 000232   000000 234000 xsym               SZN     OC_ZIP
         4 000233   000240 605000 4                  TPL     s:969

     1047      964    2           THEN
     1048      965    2                CALL OCD$MARKEM (STA);

    965  4 000234   000003 630400 5                  EPPR0   3
         4 000235   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000236   000000 701000 xent               TSX1    OCD$MARKEM
         4 000237   000000 011000                    NOP     0
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:189  

     1049      966                                                /**/
     1050      967                                                /**/
     1051      968    2        END;                               /* CASE (EVENT)                       */

     1052      969    1        RETURN;

    969  4 000240   000000 702200 xent               TSX2  ! X66_ARET
     1053      970    1   END OCP$CSCG;
     1054      971        %EOD;

PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:190  
--  Include file information  --

   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$CSCG.
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:191  

 **** Variables and constants ****

  ****  Section 001  Data  OCP$CSCG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   134-0-0/w STRC(576)   r     1 CGMA_FLUSH               212-0-0/d STRC(720)   r     1 CS_CGCP
   236-0-0/w UBIN        r     1 EVENT                    206-0-0/d STRC(144)   r     1 EXTND_CSCG
    62-0-0/d STRC(1512)  r     1 FLUSH_OUTPUT               0-0-0/w UBIN        r     1 I
     2-0-0/d CHAR(8)     r     1 JG_GHOSTS(0:23)
   166-0-0/d STRC(576)   r     1 KILL_GHOST               237-0-0/w PTR         r     1 NEXT$
   240-0-0/c STRC(72)    r     1 RESTA                    154-0-0/d STRC(72)    r     1 SCGMA_FLUSH
   240-0-0/c CHAR(8)     r     1 STA                      156-0-0/w STRC(288)   r     1 STAT

  ****  Section 003 RoData OCP$CSCG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    62-0-0/d STRC(1872)  r     1 CS_CGCTL                   0-0-0/d STRC(1800)  r     1 CS_CGINFO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 OCP_USED_HEAD              0-0-0/w PTR         r     1 OCP_USED_HEAD$
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE
     0-0-0/c STRC(1800)  r     1 OC_MSGBUFFER               0-0-0/w BIT         r     1 OC_ZIP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 B$CGAURD                   0-0-0N  NULL        r     1 M$CSCG
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:192  
     0-0-0/w ASTR(360)   r     1 OC$PEND
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCP$CSCG requires 161 words for executable code.
   Procedure OCP$CSCG requires 6 words of local(AUTO) storage.
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:193  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:194  
          MINI XREF LISTING

B$CGAURD.EVENT
       165**DCL       888>>ASSIGN
B$CGAURD.STATION
       165**DCL       165--REDEF     889>>ASSIGN
CGMA_FLUSH
       444**DCL       423--DCLINIT
CGMA_FLUSH.DEST#
       452**DCL       959<<ASSIGN
CGMA_FLUSH.MSGIDXT
       453**DCL       456--REDEF
CS_CGCP
       588**DCL       567--DCLINIT   635--DCLINIT
CS_CGCP.DVBYTE.REREAD#
       602**DCL       603--REDEF
CS_CGCP.MAXPG#
       594**DCL       926<<ASSIGN    926>>ASSIGN
CS_CGCTL
       634**DCL       927<>CALL
CS_CGCTL.V
       639**DCL       634--DCLINIT
CS_CGINFO
       566**DCL       924<>CALL
CS_CGINFO.V
       571**DCL       566--DCLINIT
DONT_FLUSH
       959**LABEL     956--GOTO      960--CALLALT
EVENT
       872**DCL       888<<ASSIGN    890>>DOCASE
EXTND_CSCG
       548**DCL       922<>CALL
EXTND_CSCG.V
       548**DCL       548--DCLINIT
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:195  
FLUSH_OUTPUT
       423**DCL       960<>CALL
FLUSH_OUTPUT.V
       426**DCL       423--DCLINIT
I
       270**DCL       897<<DOINDEX   898>>IF        901>>IF        904>>ASSIGN    905>>ASSIGN    935<<DOINDEX
       936>>IF        939>>ASSIGN    940>>ASSIGN    941>>ASSIGN    942<<ASSIGN    954<<DOINDEX   955>>IF
JG_GHOSTS
       380**DCL       954--DOINDEX   955>>IF
KILL_GHOST
       909**LABEL     909--GOTO      915<>CALL
KILL_GHOST.V
       523**DCL       522--DCLINIT
KILL_GHOST.V.DVBYTE.REREAD#
       525**DCL       525--REDEF
LOGGED_IN
       914**LABEL     906--GOTO      915--CALLALT
M$CGCTL
        50**DCL-ENT   927--CALL
M$CGINFO
        50**DCL-ENT   924--CALL
M$DEACTIVATE
        49**DCL-ENT   915--CALL
M$EXTEND
        33**DCL-ENT   922--CALL
M$FWCG
        50**DCL-ENT   960--CALL
NEXT$
       873**DCL       946<<ASSIGN    947>>DOWHILE   948>>IF        950<>CALL      951<<ASSIGN    951>>ASSIGN
NEXT_LINE
       922**LABEL     922--CALLALT
NEXT_LINE2
       922**LABEL     924--CALLALT
NEXT_LINE3
       926**LABEL     927--CALLALT
OC$PEND.LINK$
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:196  
       656**DCL       951>>ASSIGN
OC$PEND.SIZEB_MSG
       658**DCL       669--IMP-SIZ
OC$PEND.STATION
       663**DCL       948>>IF
OC$PEND.WSN
       664**DCL       665--REDEF
OCD$MARKEM
       169**DCL-ENT   965--CALL
OCP$PENDRMV
       871**DCL-ENT   950--CALL
OCP_FREE_HEAD
       862**DCL       863--REDEF
OCP_MSGBUF_FREE.B
       866**DCL       866--REDEF
OCP_USED_HEAD
       863**DCL       864--REDEF
OCP_USED_HEAD$
       864**DCL       946>>ASSIGN
OCP_USED_TAIL
       864**DCL       864--REDEF
OC_CONSOLE.ACTIVE
       809**DCL       901>>IF
OC_CONSOLE.ATTR
       806**DCL       806--REDEF
OC_CONSOLE.ATTRO
       807**DCL       807--REDEF
OC_CONSOLE.CID
       805**DCL       806--REDEF     898>>IF        936>>IF
OC_CONSOLE.GHST
       809**DCL       904<<ASSIGN    939<<ASSIGN
OC_CONSOLE.GHSTRD
       809**DCL       941<<ASSIGN
OC_CONSOLE.STATION
       804**DCL       804--REDEF
OC_CONSOLE.SYSID
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:197  
       806**DCL       905<<ASSIGN    940<<ASSIGN
OC_CONSOLE$
       803**DCL       804--IMP-PTR   898>>IF        901>>IF        904>>ASSIGN    905>>ASSIGN    936>>IF
       939>>ASSIGN    940>>ASSIGN    941>>ASSIGN
OC_DIR
       846**DCL       846--REDEF
OC_INTBIT
       846**DCL       847--REDEF
OC_INTMSG
       723**DCL       736--REDEF
OC_INTMSG.FLAGS
       730**DCL       731--REDEF
OC_INTMSG.MESS
       736**DCL       736--REDEF
OC_INTMSG.MSGID
       726**DCL       727--REDEF
OC_INTMSG.WSN
       733**DCL       734--REDEF
OC_MASK
       847**DCL       847--REDEF
OC_MAXCONSOLE
       803**DCL       897>>DOINDEX   935>>DOINDEX   942>>ASSIGN
OC_MESSBUF
       738**DCL       753--REDEF     767--REDEF
OC_MESSBUF.FLAGS
       745**DCL       746--REDEF
OC_MESSBUF.MESS
       751**DCL       751--REDEF
OC_MESSBUF.MSGID
       741**DCL       742--REDEF
OC_MESSBUF.WSN
       748**DCL       749--REDEF
OC_MESSBUF1.FLAGS
       760**DCL       761--REDEF
OC_MESSBUF1.LEN
       766**DCL       766--REDEF
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:198  
OC_MESSBUF1.MSGID
       756**DCL       757--REDEF
OC_MESSBUF1.WSN
       763**DCL       764--REDEF
OC_MSGBUFFER
       769**DCL       784--REDEF     888--ASSIGN    889--ASSIGN
OC_MSGBUFFER.FLAGS
       776**DCL       777--REDEF
OC_MSGBUFFER.MESS
       782**DCL       782--REDEF
OC_MSGBUFFER.MSGID
       772**DCL       773--REDEF
OC_MSGBUFFER.WSN
       779**DCL       780--REDEF
OC_MSGBUFFER2.FLAGS
       791**DCL       792--REDEF
OC_MSGBUFFER2.MSGID
       787**DCL       788--REDEF
OC_MSGBUFFER2.WSN
       794**DCL       795--REDEF
OC_PARAM
       802**DCL       802--REDEF
OC_QUEUE.PARMC
       801**DCL       801--REDEF
OC_ZIP
       848**DCL       963>>IF
RESTA.CADDR
       880**DCL       898>>IF        936>>IF
RESTA.SYSID
       878**DCL       905>>ASSIGN
RESTA.TEXT
       877**DCL       894>>IF        932>>IF
SCGMA_FLUSH
       472**DCL       424--DCLINIT
STA
       874**DCL       876--REDEF     889<<ASSIGN    914>>ASSIGN    948>>IF        955>>IF        959>>ASSIGN
PL6.E3A0      #006=OCP$CSCG File=OCP$PROCESS.:E05TSI                             WED 07/30/97 04:06 Page:199  
       965<>CALL
STAT
       492**DCL       522--DCLINIT
STAT.MSGIDXT
       502**DCL       505--REDEF
STAT.STATION#
       496**DCL       914<<ASSIGN

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:200  
     1055        1        /*M* OCP$PENDRMV remove read-to-console-pending entry */
     1056        2        /*T***********************************************************/
     1057        3        /*T*                                                         */
     1058        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1059        5        /*T*                                                         */
     1060        6        /*T***********************************************************/
     1061        7        %SET LISTSUB='1'B;
     1062        8        /*
     1063        9         ###    ###   ####    #   ####   #####  #   #  ####   ####   #   #  #   #
     1064       10        #   #  #   #  #   #  ###  #   #  #      #   #  #   #  #   #  ## ##  #   #
     1065       11        #   #  #      #   # # #   #   #  #      ##  #  #   #  #   #  # # #  #   #
     1066       12        #   #  #      ####   ###  ####   ####   # # #  #   #  ####   #   #  #   #
     1067       13        #   #  #      #       # # #      #      #  ##  #   #  # #    #   #  #   #
     1068       14        #   #  #   #  #      ###  #      #      #   #  #   #  #  #   #   #   # #
     1069       15         ###    ###   #       #   #      #####  #   #  ####   #   #  #   #    #
     1070       16                                                                   */
     1071       17                                                /**/
     1072       18                                                /**/
     1073       19        OCP$PENDRMV: PROC (REMOVE$);
     1074       20    1   DCL REMOVE$ PTR;
     1075       21    1   DCL FREE$ PTR STATIC;
     1076       22    1   DCL SAVE$ PTR STATIC;
     1077       23    1   DCL NEXT$ PTR STATIC;
     1078       24    1   DCL 1 NEXT REDEF NEXT$,
     1079       25    1            2 PG# UBIN(8) UNAL,
     1080       26    1            2 * UBIN(28) UNAL;
     1081       27        %INCLUDE CP_6;
     1082      108        %INCLUDE B_SEGIDS_C;
     1083      647    1   DCL 1 DS3_VECT STATIC,
     1084      648    1            2 * BIT(60) UNAL,
     1085      649    1            2 SEGID BIT(12) INIT(%DS3SID) UNAL;
     1086      650    1   DCL 1 DS3_PTR STATIC ALIGNED,
     1087      651    1            2 * UBIN(24) UNAL INIT(0),
     1088      652    1            2 * BIT(12) UNAL INIT(%DS3SID);
     1089      653    1   DCL DS3$ REDEF DS3_PTR PTR;
     1090      654                                                /**/
     1091      655    1   DCL BYTE_COUNT STATIC UBIN WORD ALIGNED;
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:201  
     1092      656    1   DCL SUPPOSED$ PTR STATIC ALIGNED;
     1093      657    1   DCL REAL$ PTR STATIC ALIGNED;
     1094      658                                                /**/
     1095      659        %INCLUDE OC$PEND;
     1096      704             %OC$PENDING;
     1097      708                                                /**/
     1098      709                                                /**/
     1099      710        %INCLUDE OCI_SUBS_C;
     1100      808                                                /**/
     1101      809                                                /**/
     1102      810                                                /**/
     1103      811        %INCLUDE OCP_DATA_R;
     1104      828            %FPT_FDS (RESULTS=DS3_VECT,SEGSIZE=1024);
     1105      843        /*
     1106      844                                         */
     1107      845    1        FREE$ = REMOVE$;
     1108      846                                                /**/
     1109      847                                           /* If this is the first entry in
     1110      848                                                the list, it may be the only
     1111      849                                                entry...in any case, the used
     1112      850                                                head pointer must be fixed */
     1113      851    1        IF FREE$ = OCP_USED_HEAD$
     1114      852    1        THEN
     1115      853    2        DO;
     1116      854    2             IF FREE$ -> OC$PEND.LINK$ = ADDR(NIL)
     1117      855    2             THEN
     1118      856    3             DO;
     1119      857    3                  OCP_FREE_HEAD$ = DS3$;
     1120      858    3                  OCP_USED_HEAD$ = ADDR(NIL);
     1121      859    3                  OCP_USED_TAIL$ = DS3$;
     1122      860    3                  OCP_PEND_USED = 0;
     1123      861    3                END;                       /* DO IF the only entry */
     1124      862    2             ELSE
     1125      863    3             DO;
     1126      864    3                  OCP_USED_HEAD$ = OCP_USED_HEAD$ -> OC$PEND.LINK$;
     1127      865    3                END;                       /* DO IF multiple entries */
     1128      866    2           END;                            /* DO IF first in chain */
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:202  
     1129      867                                                /**/
     1130      868                                                /**/
     1131      869                                           /* The entry to be removed is down
     1132      870                                                in the chain...find it, saving
     1133      871                                                the BLINK$ to the entry before
     1134      872                                                it in the chain */
     1135      873    1        ELSE
     1136      874    2        DO;
     1137      875    2             SAVE$ = OCP_USED_HEAD$;
     1138      876    2             NEXT$ = OCP_USED_HEAD$ -> OC$PEND.LINK$;
     1139      877                                                /**/
     1140      878    3             DO WHILE (NEXT$ ~= FREE$);
     1141      879    3                  SAVE$ = NEXT$;
     1142      880    3                  NEXT$ = NEXT$ -> OC$PEND.LINK$;
     1143      881    3                END;                       /* The hunt for the entry */
     1144      882                                                /**/
     1145      883    2             IF FREE$ = OCP_USED_TAIL$     /* Special case cleanup for
     1146      884                                                     the end of the memory
     1147      885                                                     chunk used */
     1148      886    2             THEN
     1149      887    3             DO;
     1150      888    3                  OCP_PEND_USED = OCP_PEND_USED - FREE$ -> OC$PEND.SIZEW_ENTRY;
     1151      889    3                  SAVE$ -> OC$PEND.LINK$ = ADDR(NIL);
     1152      890    3                  OCP_USED_TAIL$ = SAVE$;
     1153      891    3                  OCP_FREE_HEAD$ = FREE$;
     1154      892    3                END;                       /* DO if none following me */
     1155      893    2             ELSE
     1156      894    2                  SAVE$ -> OC$PEND.LINK$ = NEXT$ -> OC$PEND.LINK$;
     1157      895                                                /**/
     1158      896    2           END;                            /* DO IF NOT FIRST IN LINE */
     1159      897                                                /**/
     1160      898                                                /**/
     1161      899    1        OCP_PEND_CLEANUP = OCP_PEND_CLEANUP + 1;
     1162      900                                                /**/
     1163      901    1        IF (OCP_PEND_CLEANUP >= OCP_PEND_CLEANUP_THRESH)
     1164      902    1             AND
     1165      903    1             (OCP_PEND_USED ~= 0)
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:203  
     1166      904    1        THEN
     1167      905    2        DO;
     1168      906                                                /**/
     1169      907                                           /* Perform garbage collection on
     1170      908                                                the remaining entries, moving
     1171      909                                                them to be one after another
     1172      910                                                starting from the beginning
     1173      911                                                of the memory segment */
     1174      912    2             OCP_PEND_CLEANUP = 0;
     1175      913                                                /**/
     1176      914                                           /* ****************************
     1177      915                                                WARNING! WARNING! WARNING!
     1178      916                                                There is a very dirty trick
     1179      917                                                performed on the next line.
     1180      918                                                SAVE$ is being set to an
     1181      919                                                address that is not in an
     1182      920                                                OC$PEND structure (LINK$)
     1183      921                                                THIS MEANS THAT THE FIRST
     1184      922                                                ENTRY IN OC$PEND MUST BE
     1185      923                                                THE FLINK$...OTHERWISE ANOTHER
     1186      924                                                METHOD OF UPDATING
     1187      925                                                     OCP_USED_HEAD$
     1188      926                                                          MUST BE FOUND!!!! */
     1189      927    2             SAVE$ = ADDR(OCP_USED_HEAD$);
     1190      928                                                /**/
     1191      929    2             SUPPOSED$ = DS3$;
     1192      930    2             REAL$ = OCP_USED_HEAD$;
     1193      931                                                /**/
     1194      932                                                /* The chain is searched. For
     1195      933                                                     each entry that does not
     1196      934                                                     fall where it is suppos-
     1197      935                                                     ed to, move it to where
     1198      936                                                     it's supposed to be, and
     1199      937                                                     update the FLINK$ in the
     1200      938                                                     preceeding entry */
     1201      939    3             DO WHILE (REAL$ ~= ADDR(NIL));
     1202      940                                                /**/
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:204  
     1203      941    3                  IF SUPPOSED$ ~= REAL$
     1204      942    3                  THEN
     1205      943    4                  DO;
     1206      944    4                       BYTE_COUNT = REAL$ -> OC$PEND.SIZEW_ENTRY *
     1207      945    4                            4 /* BYTESPERWD# */;
     1208      946    4                       SUPPOSED$ -> OC$PENDING = REAL$ -> OC$PENDING;
     1209      947    4                       SAVE$ -> OC$PEND.LINK$ = SUPPOSED$;
     1210      948    4                     END;                  /* DO IF OUT OF PLACE */
     1211      949                                                /**/
     1212      950    3                  SAVE$ = SUPPOSED$;
     1213      951    3                  REAL$ = SUPPOSED$ -> OC$PEND.LINK$;
     1214      952    3                  SUPPOSED$ = PINCRW(SUPPOSED$, SAVE$ -> OC$PEND.SIZEW_ENTRY);
     1215      953    3                END;                       /* DO WHILE MORE TO DO */
     1216      954                                                /**/
     1217      955    2             OCP_USED_TAIL$ = SAVE$;
     1218      956    2             OCP_FREE_HEAD$ = SUPPOSED$;
     1219      957    2             OCP_PEND_USED = 0;
     1220      958                                                /* Sum up the number of
     1221      959                                                     used words in the rest
     1222      960                                                     of the entries */
     1223      961    2             NEXT$ = OCP_USED_HEAD$;
     1224      962    3             DO WHILE (NEXT$ ~= ADDR(NIL));
     1225      963    3                  OCP_PEND_USED = OCP_PEND_USED + NEXT$ -> OC$PEND.SIZEW_ENTRY;
     1226      964    3                  NEXT$ = NEXT$ -> OC$PEND.LINK$;
     1227      965    3                END;                       /* DO WHILE MORE TO SUM */
     1228      966                                                /**/
     1229      967                                                /**/
     1230      968                                           /* Now attempt to free excess pages
     1231      969                                                that may be unneeded */
     1232      970    3             DO WHILE ((OCP_PEND_TOT - OCP_PEND_USED) > 1024 /* WDSPERPAGE# */);
     1233      971    3                  CALL M$FDS (FPT_FDS) ALTRET (CANT_FREE_PAGE);
     1234      972    3                  OCP_PEND_TOT = OCP_PEND_TOT - 1024 /* WDSPERPAGE# */;
     1235      973    3                END;                       /* DO WHILE MORE TO RELEASE */
     1236      974                                                /**/
     1237      975    3             DO WHILE ('0'B);
     1238      976    3   CANT_FREE_PAGE: ;
     1239      977    3                END;                       /* WHILE ALTRET */
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:205  
     1240      978    2           END;                            /* DO IF TIME TO CLEANUP */
     1241      979    1        RETURN;
     1242      980    1   END OCP$PENDRMV;
     1243      981        %EOD;

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:206  
--  Include file information  --

   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$PENDRMV.

   Procedure OCP$PENDRMV requires 134 words for executable code.
   Procedure OCP$PENDRMV requires 6 words of local(AUTO) storage.

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:207  

 Object Unit name= OCP$PENDRMV                                File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:06:23.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    16     20  OCP$PENDRMV
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   134    206  OCP$PENDRMV
    3  RoData even  none     2      2  OCP$PENDRMV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  OCP$PENDRMV

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OCP_PEND_TOT                          OCP_PEND_USED
     OCP_FREE_HEAD                         OCP_USED_HEAD                         OCP_USED_TAIL
     OCP_PEND_CLEANUP                      OCP_PEND_CLEANUP_THRESH               B_VECTNIL
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:208  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:209  


     1055        1        /*M* OCP$PENDRMV remove read-to-console-pending entry */
     1056        2        /*T***********************************************************/
     1057        3        /*T*                                                         */
     1058        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1059        5        /*T*                                                         */
     1060        6        /*T***********************************************************/
     1061        7        %SET LISTSUB='1'B;
     1062        8        /*
     1063        9         ###    ###   ####    #   ####   #####  #   #  ####   ####   #   #  #   #
     1064       10        #   #  #   #  #   #  ###  #   #  #      #   #  #   #  #   #  ## ##  #   #
     1065       11        #   #  #      #   # # #   #   #  #      ##  #  #   #  #   #  # # #  #   #
     1066       12        #   #  #      ####   ###  ####   ####   # # #  #   #  ####   #   #  #   #
     1067       13        #   #  #      #       # # #      #      #  ##  #   #  # #    #   #  #   #
     1068       14        #   #  #   #  #      ###  #      #      #   #  #   #  #  #   #   #   # #
     1069       15         ###    ###   #       #   #      #####  #   #  ####   #   #  #   #    #
     1070       16                                                                   */
     1071       17                                                /**/
     1072       18                                                /**/
     1073       19        OCP$PENDRMV: PROC (REMOVE$);

     19  2 000000   000000 700200 xent  OCP$PENDRMV  TSX0  ! X66_AUTO_1
         2 000001   000006 000001                    ZERO    6,1

     1074       20    1   DCL REMOVE$ PTR;
     1075       21    1   DCL FREE$ PTR STATIC;
     1076       22    1   DCL SAVE$ PTR STATIC;
     1077       23    1   DCL NEXT$ PTR STATIC;
     1078       24    1   DCL 1 NEXT REDEF NEXT$,
     1079       25    1            2 PG# UBIN(8) UNAL,
     1080       26    1            2 * UBIN(28) UNAL;
     1081       27        %INCLUDE CP_6;
     1082      108        %INCLUDE B_SEGIDS_C;
     1083      647    1   DCL 1 DS3_VECT STATIC,
     1084      648    1            2 * BIT(60) UNAL,
     1085      649    1            2 SEGID BIT(12) INIT(%DS3SID) UNAL;
     1086      650    1   DCL 1 DS3_PTR STATIC ALIGNED,
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:210  
     1087      651    1            2 * UBIN(24) UNAL INIT(0),
     1088      652    1            2 * BIT(12) UNAL INIT(%DS3SID);
     1089      653    1   DCL DS3$ REDEF DS3_PTR PTR;
     1090      654                                                /**/
     1091      655    1   DCL BYTE_COUNT STATIC UBIN WORD ALIGNED;
     1092      656    1   DCL SUPPOSED$ PTR STATIC ALIGNED;
     1093      657    1   DCL REAL$ PTR STATIC ALIGNED;
     1094      658                                                /**/
     1095      659        %INCLUDE OC$PEND;
     1096      704             %OC$PENDING;
     1097      708                                                /**/
     1098      709                                                /**/
     1099      710        %INCLUDE OCI_SUBS_C;
     1100      808                                                /**/
     1101      809                                                /**/
     1102      810                                                /**/
     1103      811        %INCLUDE OCP_DATA_R;
     1104      828            %FPT_FDS (RESULTS=DS3_VECT,SEGSIZE=1024);
     1105      843        /*
     1106      844                                         */
     1107      845    1        FREE$ = REMOVE$;

    845  2 000002   200003 470500                    LDP0    @REMOVE$,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   000000 756000 0                  STQ     FREE$

     1108      846                                                /**/
     1109      847                                           /* If this is the first entry in
     1110      848                                                the list, it may be the only
     1111      849                                                entry...in any case, the used
     1112      850                                                head pointer must be fixed */
     1113      851    1        IF FREE$ = OCP_USED_HEAD$

    851  2 000005   000000 116000 xsym               CMPQ    OCP_USED_HEAD
         2 000006   000027 601000 2                  TNZ     s:875

     1114      852    1        THEN
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:211  
     1115      853    2        DO;

     1116      854    2             IF FREE$ -> OC$PEND.LINK$ = ADDR(NIL)

    854  2 000007   000000 471400 0                  LDP1    FREE$
         2 000010   100000 236100                    LDQ     0,,PR1
         2 000011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000012   000023 601000 2                  TNZ     s:864

     1117      855    2             THEN
     1118      856    3             DO;

     1119      857    3                  OCP_FREE_HEAD$ = DS3$;

    857  2 000013   000005 236000 0                  LDQ     DS3_PTR
         2 000014   000000 756000 xsym               STQ     OCP_FREE_HEAD

     1120      858    3                  OCP_USED_HEAD$ = ADDR(NIL);

    858  2 000015   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000016   000000 756000 xsym               STQ     OCP_USED_HEAD

     1121      859    3                  OCP_USED_TAIL$ = DS3$;

    859  2 000017   000005 236000 0                  LDQ     DS3_PTR
         2 000020   000000 756000 xsym               STQ     OCP_USED_TAIL

     1122      860    3                  OCP_PEND_USED = 0;

    860  2 000021   000000 450000 xsym               STZ     OCP_PEND_USED

     1123      861    3                END;                       /* DO IF the only entry */

    861  2 000022   000073 710000 2                  TRA     s:899

     1124      862    2             ELSE
     1125      863    3             DO;
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:212  

     1126      864    3                  OCP_USED_HEAD$ = OCP_USED_HEAD$ -> OC$PEND.LINK$;

    864  2 000023   000000 473400 xsym               LDP3    OCP_USED_HEAD
         2 000024   300000 236100                    LDQ     0,,PR3
         2 000025   000000 756000 xsym               STQ     OCP_USED_HEAD

     1127      865    3                END;                       /* DO IF multiple entries */

     1128      866    2           END;                            /* DO IF first in chain */

    866  2 000026   000073 710000 2                  TRA     s:899

     1129      867                                                /**/
     1130      868                                                /**/
     1131      869                                           /* The entry to be removed is down
     1132      870                                                in the chain...find it, saving
     1133      871                                                the BLINK$ to the entry before
     1134      872                                                it in the chain */
     1135      873    1        ELSE
     1136      874    2        DO;

     1137      875    2             SAVE$ = OCP_USED_HEAD$;

    875  2 000027   000000 236000 xsym               LDQ     OCP_USED_HEAD
         2 000030   000001 756000 0                  STQ     SAVE$

     1138      876    2             NEXT$ = OCP_USED_HEAD$ -> OC$PEND.LINK$;

    876  2 000031   000000 471400 xsym               LDP1    OCP_USED_HEAD
         2 000032   100000 236100                    LDQ     0,,PR1
         2 000033   000002 756000 0                  STQ     NEXT$

     1139      877                                                /**/
     1140      878    3             DO WHILE (NEXT$ ~= FREE$);

    878  2 000034   000000 116000 0                  CMPQ    FREE$
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:213  
         2 000035   000045 600000 2                  TZE     s:883

     1141      879    3                  SAVE$ = NEXT$;

    879  2 000036   000002 236000 0                  LDQ     NEXT$
         2 000037   000001 756000 0                  STQ     SAVE$

     1142      880    3                  NEXT$ = NEXT$ -> OC$PEND.LINK$;

    880  2 000040   000002 470400 0                  LDP0    NEXT$
         2 000041   000000 236100                    LDQ     0,,PR0
         2 000042   000002 756000 0                  STQ     NEXT$

     1143      881    3                END;                       /* The hunt for the entry */

    881  2 000043   000000 116000 0                  CMPQ    FREE$
         2 000044   000036 601000 2                  TNZ     s:879

     1144      882                                                /**/
     1145      883    2             IF FREE$ = OCP_USED_TAIL$     /* Special case cleanup for

    883  2 000045   000000 236000 0                  LDQ     FREE$
         2 000046   000000 116000 xsym               CMPQ    OCP_USED_TAIL
         2 000047   000067 601000 2                  TNZ     s:894

     1146      884                                                     the end of the memory
     1147      885                                                     chunk used */
     1148      886    2             THEN
     1149      887    3             DO;

     1150      888    3                  OCP_PEND_USED = OCP_PEND_USED - FREE$ -> OC$PEND.SIZEW_ENTRY;

    888  2 000050   000000 470400 0                  LDP0    FREE$
         2 000051   000001 236100                    LDQ     1,,PR0
         2 000052   000022 772000                    QRL     18
         2 000053   200004 756100                    STQ     @REMOVE$+1,,AUTO
         2 000054   000000 236000 xsym               LDQ     OCP_PEND_USED
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:214  
         2 000055   200004 136100                    SBLQ    @REMOVE$+1,,AUTO
         2 000056   000000 756000 xsym               STQ     OCP_PEND_USED

     1151      889    3                  SAVE$ -> OC$PEND.LINK$ = ADDR(NIL);

    889  2 000057   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000060   000001 471400 0                  LDP1    SAVE$
         2 000061   100000 756100                    STQ     0,,PR1

     1152      890    3                  OCP_USED_TAIL$ = SAVE$;

    890  2 000062   000001 236000 0                  LDQ     SAVE$
         2 000063   000000 756000 xsym               STQ     OCP_USED_TAIL

     1153      891    3                  OCP_FREE_HEAD$ = FREE$;

    891  2 000064   000000 236000 0                  LDQ     FREE$
         2 000065   000000 756000 xsym               STQ     OCP_FREE_HEAD

     1154      892    3                END;                       /* DO if none following me */

    892  2 000066   000073 710000 2                  TRA     s:899

     1155      893    2             ELSE
     1156      894    2                  SAVE$ -> OC$PEND.LINK$ = NEXT$ -> OC$PEND.LINK$;

    894  2 000067   000002 470400 0                  LDP0    NEXT$
         2 000070   000000 236100                    LDQ     0,,PR0
         2 000071   000001 471400 0                  LDP1    SAVE$
         2 000072   100000 756100                    STQ     0,,PR1

     1157      895                                                /**/
     1158      896    2           END;                            /* DO IF NOT FIRST IN LINE */

     1159      897                                                /**/
     1160      898                                                /**/
     1161      899    1        OCP_PEND_CLEANUP = OCP_PEND_CLEANUP + 1;
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:215  

    899  2 000073   000000 235000 xsym               LDA     OCP_PEND_CLEANUP
         2 000074   000001 035007                    ADLA    1,DL
         2 000075   000000 755000 xsym               STA     OCP_PEND_CLEANUP

     1162      900                                                /**/
     1163      901    1        IF (OCP_PEND_CLEANUP >= OCP_PEND_CLEANUP_THRESH)

    901  2 000076   000000 236000 xsym               LDQ     OCP_PEND_CLEANUP
         2 000077   000000 116000 xsym               CMPQ    OCP_PEND_CLEANUP_THRESH
         2 000100   000205 602000 2                  TNC     CANT_FREE_PAGE
         2 000101   000000 235000 xsym               LDA     OCP_PEND_USED
         2 000102   000205 600000 2                  TZE     CANT_FREE_PAGE

     1164      902    1             AND
     1165      903    1             (OCP_PEND_USED ~= 0)
     1166      904    1        THEN
     1167      905    2        DO;

     1168      906                                                /**/
     1169      907                                           /* Perform garbage collection on
     1170      908                                                the remaining entries, moving
     1171      909                                                them to be one after another
     1172      910                                                starting from the beginning
     1173      911                                                of the memory segment */
     1174      912    2             OCP_PEND_CLEANUP = 0;

    912  2 000103   000000 450000 xsym               STZ     OCP_PEND_CLEANUP

     1175      913                                                /**/
     1176      914                                           /* ****************************
     1177      915                                                WARNING! WARNING! WARNING!
     1178      916                                                There is a very dirty trick
     1179      917                                                performed on the next line.
     1180      918                                                SAVE$ is being set to an
     1181      919                                                address that is not in an
     1182      920                                                OC$PEND structure (LINK$)
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:216  
     1183      921                                                THIS MEANS THAT THE FIRST
     1184      922                                                ENTRY IN OC$PEND MUST BE
     1185      923                                                THE FLINK$...OTHERWISE ANOTHER
     1186      924                                                METHOD OF UPDATING
     1187      925                                                     OCP_USED_HEAD$
     1188      926                                                          MUST BE FOUND!!!! */
     1189      927    2             SAVE$ = ADDR(OCP_USED_HEAD$);

    927  2 000104   000000 236000 3                  LDQ     0
         2 000105   000001 756000 0                  STQ     SAVE$

     1190      928                                                /**/
     1191      929    2             SUPPOSED$ = DS3$;

    929  2 000106   000005 236000 0                  LDQ     DS3_PTR
         2 000107   000007 756000 0                  STQ     SUPPOSED$

     1192      930    2             REAL$ = OCP_USED_HEAD$;

    930  2 000110   000000 236000 xsym               LDQ     OCP_USED_HEAD
         2 000111   000010 756000 0                  STQ     REAL$

     1193      931                                                /**/
     1194      932                                                /* The chain is searched. For
     1195      933                                                     each entry that does not
     1196      934                                                     fall where it is suppos-
     1197      935                                                     ed to, move it to where
     1198      936                                                     it's supposed to be, and
     1199      937                                                     update the FLINK$ in the
     1200      938                                                     preceeding entry */
     1201      939    3             DO WHILE (REAL$ ~= ADDR(NIL));

    939  2 000112   000145 710000 2                  TRA     s:953

     1202      940                                                /**/
     1203      941    3                  IF SUPPOSED$ ~= REAL$

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:217  
    941  2 000113   000007 236000 0                  LDQ     SUPPOSED$
         2 000114   000010 116000 0                  CMPQ    REAL$
         2 000115   000134 600000 2                  TZE     s:950

     1204      942    3                  THEN
     1205      943    4                  DO;

     1206      944    4                       BYTE_COUNT = REAL$ -> OC$PEND.SIZEW_ENTRY *

    944  2 000116   000010 470400 0                  LDP0    REAL$
         2 000117   000001 236100                    LDQ     1,,PR0
         2 000120   000020 772000                    QRL     16
         2 000121   000001 376000 3                  ANQ     1
         2 000122   000006 756000 0                  STQ     BYTE_COUNT

     1207      945    4                            4 /* BYTESPERWD# */;
     1208      946    4                       SUPPOSED$ -> OC$PENDING = REAL$ -> OC$PENDING;

    946  2 000123   000000 620006                    EAX0    0,QL
         2 000124   000007 471400 0                  LDP1    SUPPOSED$
         2 000125   000006 721000 0                  LXL1    BYTE_COUNT
         2 000126   000140 100540                    MLR     fill='000'O
         2 000127   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 000130   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1209      947    4                       SAVE$ -> OC$PEND.LINK$ = SUPPOSED$;

    947  2 000131   000007 236000 0                  LDQ     SUPPOSED$
         2 000132   000001 473400 0                  LDP3    SAVE$
         2 000133   300000 756100                    STQ     0,,PR3

     1210      948    4                     END;                  /* DO IF OUT OF PLACE */

     1211      949                                                /**/
     1212      950    3                  SAVE$ = SUPPOSED$;

    950  2 000134   000001 756000 0                  STQ     SAVE$
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:218  

     1213      951    3                  REAL$ = SUPPOSED$ -> OC$PEND.LINK$;

    951  2 000135   000007 470400 0                  LDP0    SUPPOSED$
         2 000136   000000 236100                    LDQ     0,,PR0
         2 000137   000010 756000 0                  STQ     REAL$

     1214      952    3                  SUPPOSED$ = PINCRW(SUPPOSED$, SAVE$ -> OC$PEND.SIZEW_ENTRY);

    952  2 000140   000001 471400 0                  LDP1    SAVE$
         2 000141   100001 220100                    LDX0    1,,PR1
         2 000142   000000 636010                    EAQ     0,X0
         2 000143   000007 036000 0                  ADLQ    SUPPOSED$
         2 000144   000007 756000 0                  STQ     SUPPOSED$

     1215      953    3                END;                       /* DO WHILE MORE TO DO */

    953  2 000145   000010 236000 0                  LDQ     REAL$
         2 000146   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000147   000113 601000 2                  TNZ     s:941

     1216      954                                                /**/
     1217      955    2             OCP_USED_TAIL$ = SAVE$;

    955  2 000150   000001 236000 0                  LDQ     SAVE$
         2 000151   000000 756000 xsym               STQ     OCP_USED_TAIL

     1218      956    2             OCP_FREE_HEAD$ = SUPPOSED$;

    956  2 000152   000007 236000 0                  LDQ     SUPPOSED$
         2 000153   000000 756000 xsym               STQ     OCP_FREE_HEAD

     1219      957    2             OCP_PEND_USED = 0;

    957  2 000154   000000 450000 xsym               STZ     OCP_PEND_USED

     1220      958                                                /* Sum up the number of
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:219  
     1221      959                                                     used words in the rest
     1222      960                                                     of the entries */
     1223      961    2             NEXT$ = OCP_USED_HEAD$;

    961  2 000155   000000 236000 xsym               LDQ     OCP_USED_HEAD
         2 000156   000002 756000 0                  STQ     NEXT$

     1224      962    3             DO WHILE (NEXT$ ~= ADDR(NIL));

    962  2 000157   000167 710000 2                  TRA     s:965

     1225      963    3                  OCP_PEND_USED = OCP_PEND_USED + NEXT$ -> OC$PEND.SIZEW_ENTRY;

    963  2 000160   000002 470400 0                  LDP0    NEXT$
         2 000161   000001 236100                    LDQ     1,,PR0
         2 000162   000022 772000                    QRL     18
         2 000163   000000 036000 xsym               ADLQ    OCP_PEND_USED
         2 000164   000000 756000 xsym               STQ     OCP_PEND_USED

     1226      964    3                  NEXT$ = NEXT$ -> OC$PEND.LINK$;

    964  2 000165   000000 236100                    LDQ     0,,PR0
         2 000166   000002 756000 0                  STQ     NEXT$

     1227      965    3                END;                       /* DO WHILE MORE TO SUM */

    965  2 000167   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000170   000160 601000 2                  TNZ     s:963

     1228      966                                                /**/
     1229      967                                                /**/
     1230      968                                           /* Now attempt to free excess pages
     1231      969                                                that may be unneeded */
     1232      970    3             DO WHILE ((OCP_PEND_TOT - OCP_PEND_USED) > 1024 /* WDSPERPAGE# */);

    970  2 000171   000200 710000 2                  TRA     s:973

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:220  
     1233      971    3                  CALL M$FDS (FPT_FDS) ALTRET (CANT_FREE_PAGE);

    971  2 000172   000012 630400 0                  EPPR0   FPT_FDS
         2 000173   430002 713400                    CLIMB   alt,fds
         2 000174   400400 401760                    pmme    nvectors=2
         2 000175   000205 702000 2                  TSX2    CANT_FREE_PAGE

     1234      972    3                  OCP_PEND_TOT = OCP_PEND_TOT - 1024 /* WDSPERPAGE# */;

    972  2 000176   002000 336007                    LCQ     1024,DL
         2 000177   000000 056000 xsym               ASQ     OCP_PEND_TOT

     1235      973    3                END;                       /* DO WHILE MORE TO RELEASE */

    973  2 000200   000000 236000 xsym               LDQ     OCP_PEND_TOT
         2 000201   000000 136000 xsym               SBLQ    OCP_PEND_USED
         2 000202   002000 116007                    CMPQ    1024,DL
         2 000203   000172 605400 2                  TPNZ    s:971

     1236      974                                                /**/
     1237      975    3             DO WHILE ('0'B);

    975  2 000204   000205 710000 2                  TRA     CANT_FREE_PAGE

    972  2 000205                       CANT_FREE_P* null
     1238      976    3   CANT_FREE_PAGE: ;
     1239      977    3                END;                       /* WHILE ALTRET */

     1240      978    2           END;                            /* DO IF TIME TO CLEANUP */

     1241      979    1        RETURN;

    979  2 000205   000000 702200 xent               TSX2  ! X66_ARET
     1242      980    1   END OCP$PENDRMV;
     1243      981        %EOD;

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:221  
--  Include file information  --

   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$PENDRMV.
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:222  

 **** Variables and constants ****

  ****  Section 000  Data  OCP$PENDRMV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w UBIN        r     1 BYTE_COUNT                 5-0-0/w PTR         r     1 DS3$
     5-0-0/w STRC        r     1 DS3_PTR                    3-0-0/b STRC(72)    r     1 DS3_VECT
    12-0-0/d STRC(216)   r     1 FPT_FDS                    0-0-0/w PTR         r     1 FREE$
     2-0-0/w PTR         r     1 NEXT$                     10-0-0/w PTR         r     1 REAL$
     1-0-0/w PTR         r     1 SAVE$                      7-0-0/w PTR         r     1 SUPPOSED$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @REMOVE$                  *0-0-0/w PTR         r     1 REMOVE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 OCP_FREE_HEAD              0-0-0/w PTR         r     1 OCP_FREE_HEAD$
     0-0-0/w UBIN        r     1 OCP_PEND_CLEANUP
     0-0-0/w UBIN        r     1 OCP_PEND_CLEANUP_THRESH
     0-0-0/w SBIN        r     1 OCP_PEND_TOT               0-0-0/w SBIN        r     1 OCP_PEND_USED
     0-0-0/w STRC        r     1 OCP_USED_HEAD              0-0-0/w PTR         r     1 OCP_USED_HEAD$
     0-0-0/w STRC        r     1 OCP_USED_TAIL              0-0-0/w PTR         r     1 OCP_USED_TAIL$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:223  
     0-0-0/w ASTR(360)   r     1 OC$PEND                    0-0-0/w ASTR(0)     r     1 OC$PENDING


   Procedure OCP$PENDRMV requires 134 words for executable code.
   Procedure OCP$PENDRMV requires 6 words of local(AUTO) storage.
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:224  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:225  
          MINI XREF LISTING

BYTE_COUNT
       655**DCL       706--IMP-SIZ   944<<ASSIGN    946>>ASSIGN    946>>ASSIGN
CANT_FREE_PAGE
       972**LABEL     971--CALLALT
DS3$
       653**DCL       857>>ASSIGN    859>>ASSIGN    929>>ASSIGN
DS3_PTR
       650**DCL       653--REDEF
DS3_VECT
       647**DCL       839--DCLINIT
FPT_FDS
       839**DCL       971<>CALL
FPT_FDS.V
       839**DCL       839--DCLINIT
FREE$
        21**DCL       845<<ASSIGN    851>>IF        854>>IF        878>>DOWHILE   883>>IF        888>>ASSIGN
       891>>ASSIGN
M$FDS
        71**DCL-ENT   971--CALL
NEXT$
        23**DCL        24--REDEF     876<<ASSIGN    878>>DOWHILE   879>>ASSIGN    880<<ASSIGN    880>>ASSIGN
       894>>ASSIGN    961<<ASSIGN    962>>DOWHILE   963>>ASSIGN    964<<ASSIGN    964>>ASSIGN
OC$PEND.LINK$
       668**DCL       854>>IF        864>>ASSIGN    876>>ASSIGN    880>>ASSIGN    889<<ASSIGN    894<<ASSIGN
       894>>ASSIGN    947<<ASSIGN    951>>ASSIGN    964>>ASSIGN
OC$PEND.SIZEB_MSG
       670**DCL       681--IMP-SIZ
OC$PEND.SIZEW_ENTRY
       669**DCL       888>>ASSIGN    944>>ASSIGN    952>>ASSIGN    963>>ASSIGN
OC$PEND.WSN
       676**DCL       677--REDEF
OC$PENDING
PL6.E3A0      #007=OCP$PENDRMV File=OCP$PROCESS.:E05TSI                          WED 07/30/97 04:06 Page:226  
       705**DCL       946<<ASSIGN    946>>ASSIGN
OCP_FREE_HEAD
       820**DCL       821--REDEF
OCP_FREE_HEAD$
       821**DCL       857<<ASSIGN    891<<ASSIGN    956<<ASSIGN
OCP_MSGBUF_FREE.B
       824**DCL       824--REDEF
OCP_PEND_CLEANUP
       826**DCL       899<<ASSIGN    899>>ASSIGN    901>>IF        912<<ASSIGN
OCP_PEND_CLEANUP_THRESH
       826**DCL       901>>IF
OCP_PEND_TOT
       820**DCL       970>>DOWHILE   972<<ASSIGN    972>>ASSIGN
OCP_PEND_USED
       820**DCL       860<<ASSIGN    888<<ASSIGN    888>>ASSIGN    901>>IF        957<<ASSIGN    963<<ASSIGN
       963>>ASSIGN    970>>DOWHILE
OCP_USED_HEAD
       821**DCL       822--REDEF
OCP_USED_HEAD$
       822**DCL       851>>IF        858<<ASSIGN    864<<ASSIGN    864>>ASSIGN    875>>ASSIGN    876>>ASSIGN
       927--ASSIGN    930>>ASSIGN    961>>ASSIGN
OCP_USED_TAIL
       822**DCL       822--REDEF
OCP_USED_TAIL$
       822**DCL       859<<ASSIGN    883>>IF        890<<ASSIGN    955<<ASSIGN
REAL$
       657**DCL       930<<ASSIGN    939>>DOWHILE   941>>IF        944>>ASSIGN    946>>ASSIGN    951<<ASSIGN
REMOVE$
        20**DCL        19--PROC      845>>ASSIGN
SAVE$
        22**DCL       875<<ASSIGN    879<<ASSIGN    889>>ASSIGN    890>>ASSIGN    894>>ASSIGN    927<<ASSIGN
       947>>ASSIGN    950<<ASSIGN    952>>ASSIGN    955>>ASSIGN
SUPPOSED$
       656**DCL       929<<ASSIGN    941>>IF        946>>ASSIGN    947>>ASSIGN    950>>ASSIGN    951>>ASSIGN
       952<<ASSIGN    952>>ASSIGN    956>>ASSIGN

PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:227  
     1244        1        /*M* OCP$FINDCX  find console index given its station */
     1245        2        /*T***********************************************************/
     1246        3        /*T*                                                         */
     1247        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1248        5        /*T*                                                         */
     1249        6        /*T***********************************************************/
     1250        7        %SET LISTSUB='1'B;
     1251        8        /*
     1252        9         ###    ###   ####    #   #####   ###   #   #  ####    ###   #   #
     1253       10        #   #  #   #  #   #  ###  #        #    #   #  #   #  #   #  #   #
     1254       11        #   #  #      #   # # #   #        #    ##  #  #   #  #       # #
     1255       12        #   #  #      ####   ###  ####     #    # # #  #   #  #        #
     1256       13        #   #  #      #       # # #        #    #  ##  #   #  #       # #
     1257       14        #   #  #   #  #      ###  #        #    #   #  #   #  #   #  #   #
     1258       15         ###    ###   #       #   #       ###   #   #  ####    ###   #   #
     1259       16                                                                   */
     1260       17                                                /**/
     1261       18        /*F* NAME:  OCP$FINDCX
     1262       19             PURPOSE:  To find the internal console index of a
     1263       20                       console given its station.
     1264       21             DESCRIPTION:  All non-empty entries of OC_CONSOLE
     1265       22                           are searched until one matching the
     1266       23                           given station is found.
     1267       24                                                               */
     1268       25        /*D* NAME:  OCP$FINDCX
     1269       26             CALL:  CALL OCP$FINDCX (INDEX_, STATION);
     1270       27             DESCRIPTION:  The OC_CONSOLE console table is searched
     1271       28                           linearly for non-empty entries (ATTR = '0'B).
     1272       29                           When a non-empty entry containing a station
     1273       30                           which matches STATION is found, INDEX_ is
     1274       31                           set equal to its index and the calling
     1275       32                           procedure RETURNed to.
     1276       33             ASSUMPTIONS:  A non-empty entry will be found which
     1277       34                           matches STATION.
     1278       35                                                                     */
     1279       36        /*S*
     1280       37             SCREECH_CODE: OCP-S$OCCANTFINDU
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:228  
     1281       38             TYPE: SCREECH
     1282       39             MESSAGE: KEYIN got a direct-addressed message for a non-existent
     1283       40                       console.
     1284       41             REMARKS: An internal routine in KEYIN has not set the flag which
     1285       42                       would indicate it was O.K. to ignore this message.
     1286       43                                                                          */
     1287       44        OCP$FINDCX: PROC (INDEX_, STATION);
     1288       45    1   DCL INDEX_ UBIN WORD;
     1289       46    1   DCL STATION CHAR(8);
     1290       47    1   DCL I UBIN WORD STATIC;
     1291       48    1   DCL OCW$WRITE ENTRY(5);
     1292       49                                                /**/
     1293       50    1   DCL ARRG_MSG STATIC CHAR(0) INIT
     1294       51    1        (' KEYIN aborting -- CANT FIND STATION XXXXXXXX');
     1295       52                                                /**/
     1296       53        %INCLUDE CP_6;
     1297      134        %INCLUDE OC_SCODE_C;
     1298      159        %INCLUDE OC_SUBS_C;
     1299      890             %FPT_SCREECH (FPTN=OCP$SCREECH,
     1300      891                                 SCODE=OCP$SCODE);
     1301      905                                                /**/
     1302      906                                                /**/
     1303      907                  %VLP_SCREECH (FPTN=OCP$SCODE,STCLASS=CONSTANT SYMDEF,
     1304      908                                 FCG=OC,
     1305      909                                 MID=P,
     1306      910                                 MON='0'B,
     1307      911                                 CODE=%S$OCCANTFINDU);
     1308      981                                                /**/
     1309      982             %FPT_WAIT      (FPTN=WAIT_IT_OUT,
     1310      983                                 UNITS=25);
     1311      997                                                /**/
     1312      998                                                /**/
     1313      999        %INCLUDE OCI_SUBS_C;
     1314     1097        %INCLUDE OC_DAT_R;
     1315     1258        /*
     1316     1259                  Begin O C P $ F I N D C X  main
     1317     1260                                         */
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:229  
     1318     1261    2        DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1319     1262    2             IF OC_CONSOLE.ATTR (I) ~= '0'B
     1320     1263    2                  OR
     1321     1264    2                  OC_CONSOLE.ATTRO (I) ~= '0'B
     1322     1265    2             THEN
     1323     1266    2                  IF OC_CONSOLE.STATION (I) = STATION
     1324     1267    2                  THEN
     1325     1268    3                  DO;
     1326     1269    3                       INDEX_ = I;
     1327     1270    3                       RETURN;
     1328     1271    3                     END;
     1329     1272    2           END;
     1330     1273                                                /**/
     1331     1274    1        IF INDEX_ = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
     1332     1275    1        THEN
     1333     1276    1             RETURN;
     1334     1277                                                /**/
     1335     1278                                           /* If we cant find a console with
     1336     1279                                                the requested station, dump it
     1337     1280                                                on the SYStem or DeLTA console
     1338     1281                                                wait a few...then screech */
     1339     1282                                                /**/
     1340     1283    1        CALL INSERT (ARRG_MSG, 37, 8, STATION);
     1341     1284    1        CALL OCW$WRITE (ARRG_MSG,
     1342     1285    1             SIZEC(ARRG_MSG),
     1343     1286    1             '020000'O /* M_DLTA  */ | '200000'O /* M_SYS  */,
     1344     1287    1             ' ');
     1345     1288    1        CALL M$WAIT (WAIT_IT_OUT);
     1346     1289                                                /**/
     1347     1290    1        CALL M$SCREECH (OCP$SCREECH);
     1348     1291    1   END OCP$FINDCX;

PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:230  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$FINDCX.

   Procedure OCP$FINDCX requires 49 words for executable code.
   Procedure OCP$FINDCX requires 6 words of local(AUTO) storage.

    No errors detected in file OCP$PROCESS.:E05TSI    .

PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:231  

 Object Unit name= OCP$FINDCX                                 File name= OCP$PROCESS.:E05TOU
 UTS= JUL 30 '97 04:06:41.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    26     32  OCP$FINDCX
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS      2      2  OCP$FINDCX
    3   Proc  even  none    49     61  OCP$FINDCX
    4  RoData even  none     6      6  OCP$FINDCX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        2  OCP$FINDCX

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      0  OCP$SCODE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 OCW$WRITE
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:232  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_PARAM                              OC_CONSOLE$
     OC_MAXCONSOLE                         OC_DIR                                OC_INTBIT
     OC_MASK                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:233  


     1244        1        /*M* OCP$FINDCX  find console index given its station */
     1245        2        /*T***********************************************************/
     1246        3        /*T*                                                         */
     1247        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1248        5        /*T*                                                         */
     1249        6        /*T***********************************************************/
     1250        7        %SET LISTSUB='1'B;
     1251        8        /*
     1252        9         ###    ###   ####    #   #####   ###   #   #  ####    ###   #   #
     1253       10        #   #  #   #  #   #  ###  #        #    #   #  #   #  #   #  #   #
     1254       11        #   #  #      #   # # #   #        #    ##  #  #   #  #       # #
     1255       12        #   #  #      ####   ###  ####     #    # # #  #   #  #        #
     1256       13        #   #  #      #       # # #        #    #  ##  #   #  #       # #
     1257       14        #   #  #   #  #      ###  #        #    #   #  #   #  #   #  #   #
     1258       15         ###    ###   #       #   #       ###   #   #  ####    ###   #   #
     1259       16                                                                   */
     1260       17                                                /**/
     1261       18        /*F* NAME:  OCP$FINDCX
     1262       19             PURPOSE:  To find the internal console index of a
     1263       20                       console given its station.
     1264       21             DESCRIPTION:  All non-empty entries of OC_CONSOLE
     1265       22                           are searched until one matching the
     1266       23                           given station is found.
     1267       24                                                               */
     1268       25        /*D* NAME:  OCP$FINDCX
     1269       26             CALL:  CALL OCP$FINDCX (INDEX_, STATION);
     1270       27             DESCRIPTION:  The OC_CONSOLE console table is searched
     1271       28                           linearly for non-empty entries (ATTR = '0'B).
     1272       29                           When a non-empty entry containing a station
     1273       30                           which matches STATION is found, INDEX_ is
     1274       31                           set equal to its index and the calling
     1275       32                           procedure RETURNed to.
     1276       33             ASSUMPTIONS:  A non-empty entry will be found which
     1277       34                           matches STATION.
     1278       35                                                                     */
     1279       36        /*S*
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:234  
     1280       37             SCREECH_CODE: OCP-S$OCCANTFINDU
     1281       38             TYPE: SCREECH
     1282       39             MESSAGE: KEYIN got a direct-addressed message for a non-existent
     1283       40                       console.
     1284       41             REMARKS: An internal routine in KEYIN has not set the flag which
     1285       42                       would indicate it was O.K. to ignore this message.
     1286       43                                                                          */
     1287       44        OCP$FINDCX: PROC (INDEX_, STATION);

     44  3 000000   000000 700200 xent  OCP$FINDCX   TSX0  ! X66_AUTO_2
         3 000001   000006 000002                    ZERO    6,2

     1288       45    1   DCL INDEX_ UBIN WORD;
     1289       46    1   DCL STATION CHAR(8);
     1290       47    1   DCL I UBIN WORD STATIC;
     1291       48    1   DCL OCW$WRITE ENTRY(5);
     1292       49                                                /**/
     1293       50    1   DCL ARRG_MSG STATIC CHAR(0) INIT
     1294       51    1        (' KEYIN aborting -- CANT FIND STATION XXXXXXXX');
     1295       52                                                /**/
     1296       53        %INCLUDE CP_6;
     1297      134        %INCLUDE OC_SCODE_C;
     1298      159        %INCLUDE OC_SUBS_C;
     1299      890             %FPT_SCREECH (FPTN=OCP$SCREECH,
     1300      891                                 SCODE=OCP$SCODE);
     1301      905                                                /**/
     1302      906                                                /**/
     1303      907                  %VLP_SCREECH (FPTN=OCP$SCODE,STCLASS=CONSTANT SYMDEF,
     1304      908                                 FCG=OC,
     1305      909                                 MID=P,
     1306      910                                 MON='0'B,
     1307      911                                 CODE=%S$OCCANTFINDU);
     1308      981                                                /**/
     1309      982             %FPT_WAIT      (FPTN=WAIT_IT_OUT,
     1310      983                                 UNITS=25);
     1311      997                                                /**/
     1312      998                                                /**/
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:235  
     1313      999        %INCLUDE OCI_SUBS_C;
     1314     1097        %INCLUDE OC_DAT_R;
     1315     1258        /*
     1316     1259                  Begin O C P $ F I N D C X  main
     1317     1260                                         */
     1318     1261    2        DO I = 0 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   1261  3 000002   000000 450000 0                  STZ     I
         3 000003   000031 710000 3                  TRA     s:1272+3

     1319     1262    2             IF OC_CONSOLE.ATTR (I) ~= '0'B

   1262  3 000004   000000 236000 0                  LDQ     I
         3 000005   000076 402007                    MPY     62,DL
         3 000006   000000 470400 xsym               LDP0    OC_CONSOLE$
         3 000007   000013 220106                    LDX0    11,QL,PR0
         3 000010   000013 601000 3                  TNZ     s:1266
         3 000011   000014 221106                    LDX1    12,QL,PR0
         3 000012   000026 600000 3                  TZE     s:1272

     1320     1263    2                  OR
     1321     1264    2                  OC_CONSOLE.ATTRO (I) ~= '0'B
     1322     1265    2             THEN
     1323     1266    2                  IF OC_CONSOLE.STATION (I) = STATION

   1266  3 000013   000000 236000 0                  LDQ     I
         3 000014   000370 402007                    MPY     248,DL
         3 000015   200004 471500                    LDP1    @STATION,,AUTO
         3 000016   040100 106506                    CMPC    fill='040'O
         3 000017   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         3 000020   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 000021   000026 601000 3                  TNZ     s:1272

     1324     1267    2                  THEN
     1325     1268    3                  DO;

     1326     1269    3                       INDEX_ = I;
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:236  

   1269  3 000022   200003 473500                    LDP3    @INDEX_,,AUTO
         3 000023   000000 235000 0                  LDA     I
         3 000024   300000 755100                    STA     0,,PR3

     1327     1270    3                       RETURN;

   1270  3 000025   000000 702200 xent               TSX2  ! X66_ARET

     1328     1271    3                     END;
     1329     1272    2           END;

   1272  3 000026   000000 235000 0                  LDA     I
         3 000027   000001 035007                    ADLA    1,DL
         3 000030   000000 755000 0                  STA     I
         3 000031   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         3 000032   000022 772000                    QRL     18
         3 000033   000000 116000 0                  CMPQ    I
         3 000034   000004 603000 3                  TRC     s:1262

     1330     1273                                                /**/
     1331     1274    1        IF INDEX_ = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */

   1274  3 000035   200003 470500                    LDP0    @INDEX_,,AUTO
         3 000036   000001 036007                    ADLQ    1,DL
         3 000037   000000 116100                    CMPQ    0,,PR0
         3 000040   000042 601000 3                  TNZ     s:1283

     1332     1275    1        THEN
     1333     1276    1             RETURN;

   1276  3 000041   000000 702200 xent               TSX2  ! X66_ARET

     1334     1277                                                /**/
     1335     1278                                           /* If we cant find a console with
     1336     1279                                                the requested station, dump it
     1337     1280                                                on the SYStem or DeLTA console
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:237  
     1338     1281                                                wait a few...then screech */
     1339     1282                                                /**/
     1340     1283    1        CALL INSERT (ARRG_MSG, 37, 8, STATION);

   1283  3 000042   200004 471500                    LDP1    @STATION,,AUTO
         3 000043   040000 100500                    MLR     fill='040'O
         3 000044   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 000045   000012 200010 0                  ADSC9   ARRG_MSG+9               cn=1,n=8

     1341     1284    1        CALL OCW$WRITE (ARRG_MSG,

   1284  3 000046   000002 630400 4                  EPPR0   2
         3 000047   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000050   000000 701000 xent               TSX1    OCW$WRITE
         3 000051   000000 011000                    NOP     0

     1342     1285    1             SIZEC(ARRG_MSG),
     1343     1286    1             '020000'O /* M_DLTA  */ | '200000'O /* M_SYS  */,
     1344     1287    1             ' ');
     1345     1288    1        CALL M$WAIT (WAIT_IT_OUT);

   1288  3 000052   000024 630400 0                  EPPR0   WAIT_IT_OUT
         3 000053   020006 713400                    CLIMB   8198
         3 000054   400400 401760                    pmme    nvectors=2

     1346     1289                                                /**/
     1347     1290    1        CALL M$SCREECH (OCP$SCREECH);

   1290  3 000055   000016 630400 0                  EPPR0   OCP$SCREECH
         3 000056   000013 713400                    CLIMB   11
         3 000057   401000 401760                    pmme    nvectors=3

     1348     1291    1   END OCP$FINDCX;

   1291  3 000060   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:238  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_SCODE_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCP$FINDCX.
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:239  

 **** Variables and constants ****

  ****  Section 000  Data  OCP$FINDCX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR(45)    r     1 ARRG_MSG                   0-0-0/w UBIN        r     1 I
    16-0-0/d STRC(216)   r     1 OCP$SCREECH               24-0-0/d STRC(216)   r     1 WAIT_IT_OUT

  ****  Section 002 RoData OCP$FINDCX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 OCP$SCODE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @INDEX_                    4-0-0/w PTR         r     1 @STATION
    *0-0-0/w UBIN        r     1 INDEX_                    *0-0-0/c CHAR(8)     r     1 STATION

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:240  
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCP$FINDCX requires 49 words for executable code.
   Procedure OCP$FINDCX requires 6 words of local(AUTO) storage.

    No errors detected in file OCP$PROCESS.:E05TSI    .
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:241  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:242  
          MINI XREF LISTING

ARRG_MSG
        50**DCL      1283<<CALLBLT  1284<>CALL     1284--CALL
I
        47**DCL      1261<<DOINDEX  1262>>IF       1262>>IF       1266>>IF       1269>>ASSIGN
INDEX_
        45**DCL        44--PROC     1269<<ASSIGN   1274>>IF
M$SCREECH
        76**DCL-ENT  1290--CALL
M$WAIT
       120**DCL-ENT  1288--CALL
OCP$SCODE
       934**DCL       902--DCLINIT
OCP$SCREECH
       902**DCL      1290<>CALL
OCW$WRITE
        48**DCL-ENT  1284--CALL
OC_CONSOLE.ATTR
      1211**DCL      1211--REDEF    1262>>IF
OC_CONSOLE.ATTRO
      1212**DCL      1212--REDEF    1262>>IF
OC_CONSOLE.CID
      1210**DCL      1211--REDEF
OC_CONSOLE.STATION
      1209**DCL      1209--REDEF    1266>>IF
OC_CONSOLE$
      1208**DCL      1209--IMP-PTR  1262>>IF       1262>>IF       1266>>IF
OC_DIR
      1251**DCL      1251--REDEF
OC_INTBIT
      1251**DCL      1252--REDEF
OC_INTMSG
      1128**DCL      1141--REDEF
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:243  
OC_INTMSG.FLAGS
      1135**DCL      1136--REDEF
OC_INTMSG.MESS
      1141**DCL      1141--REDEF
OC_INTMSG.MSGID
      1131**DCL      1132--REDEF
OC_INTMSG.WSN
      1138**DCL      1139--REDEF
OC_MASK
      1252**DCL      1252--REDEF
OC_MAXCONSOLE
      1208**DCL      1261>>DOINDEX  1274>>IF
OC_MESSBUF
      1143**DCL      1158--REDEF    1172--REDEF
OC_MESSBUF.FLAGS
      1150**DCL      1151--REDEF
OC_MESSBUF.MESS
      1156**DCL      1156--REDEF
OC_MESSBUF.MSGID
      1146**DCL      1147--REDEF
OC_MESSBUF.WSN
      1153**DCL      1154--REDEF
OC_MESSBUF1.FLAGS
      1165**DCL      1166--REDEF
OC_MESSBUF1.LEN
      1171**DCL      1171--REDEF
OC_MESSBUF1.MSGID
      1161**DCL      1162--REDEF
OC_MESSBUF1.WSN
      1168**DCL      1169--REDEF
OC_MSGBUFFER
      1174**DCL      1189--REDEF
OC_MSGBUFFER.FLAGS
      1181**DCL      1182--REDEF
OC_MSGBUFFER.MESS
      1187**DCL      1187--REDEF
PL6.E3A0      #008=OCP$FINDCX File=OCP$PROCESS.:E05TSI                           WED 07/30/97 04:06 Page:244  
OC_MSGBUFFER.MSGID
      1177**DCL      1178--REDEF
OC_MSGBUFFER.WSN
      1184**DCL      1185--REDEF
OC_MSGBUFFER2.FLAGS
      1196**DCL      1197--REDEF
OC_MSGBUFFER2.MSGID
      1192**DCL      1193--REDEF
OC_MSGBUFFER2.WSN
      1199**DCL      1200--REDEF
OC_PARAM
      1207**DCL      1207--REDEF
OC_QUEUE.PARMC
      1206**DCL      1206--REDEF
STATION
        46**DCL        44--PROC     1266>>IF       1283>>CALLBLT
WAIT_IT_OUT
       994**DCL      1288<>CALL
WAIT_IT_OUT.V
       995**DCL       994--DCLINIT
