
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:1    
        1        1        /*M*     ZIG$V_RECORD      I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_RECORD
        9        9        PURPOSE:
       10       10              To create the RC records for all the records in the
       11       11            subschema DDL and initialize them to what they should
       12       12            be.
       13       13        */
       14       14        /*
       15       15        ZZZZZ  III   GGG    $   V   V       RRRR  EEEEE  CCC   OOO  RRRR  DDDD
       16       16            Z   I   G   G  $$$  V   V       R   R E     C   C O O O R   R D   D
       17       17           Z    I   G     $ $   V   V       R   R E     C     O O O R   R D   D
       18       18          Z     I   G      $$$  V   V       RRRR  EEEE  C     O  OO RRRR  D   D
       19       19         Z      I   G  GG   $ $ V   V       R R   E     C     O   O R R   D   D
       20       20        Z       I   G   G  $$$   V V        R  R  E     C   C O   O R  R  D   D
       21       21        ZZZZZ  III   GGG    $     V         R   R EEEEE  CCC   OOO  R   R DDDD
       22       22                                      _____
       23       23        */
       24       24        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:2    
       25       25        ZIG$V_RECORD:
       26       26            PROC;
       27       27    1   DCL ZIG$HASH_IT ENTRY (8);
       28       28    1   DCL ZIG$V_SET ENTRY;
       29       29    1   DCL CUR_EXT_NAME_SEG UBIN (36) EXT;
       30       30    1   DCL WRITSF ENTRY (2);
       31       31    1   DCL READSF ENTRY (2);
       32       32    1   DCL ZIG$ADD_SI ENTRY;
       33       33    1   DCL SN_DBK UBIN (36) EXT;
       34       34        %INCLUDE ZI_ERRORS_SUBS;
       35      554        %INCLUDE ZI_SUB_LANG;
       36     2269        %INCLUDE ZIG_DIR_STRUCS;
       37     2399        %GENERAL;
       38     2523        %CONTROL_BLOCK;
       39     2631        %DESC_TYPE_9;
       40     2808        %DESC_TYPE_32;
       41     2874        %DESC_TYPE_33;
       42     2919    1   DCL IO_BUF CHAR (128) EXT;
       43     2920        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
       44     2979        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       45     3048        %INCLUDE ZIG_GENERAL;
       46     3156        %INCLUDE ZIG_TYPE_SUBS;
       47     3171        %INCLUDE ZIG_SSS;
       48     3741        %SS_GENERAL(PSTCLASS=EXT);
       49     3762        %OA(PSTCLASS=EXT);
       50     3829        %OA1(PSTCLASS=EXT);
       51     3837        %RC(PSTCLASS=EXT);
       52     3870        %RC1(PSTCLASS=EXT);
       53     3880        %DP(PSTCLASS=EXT);
       54     3894        %DP1(PSTCLASS=EXT);
       55     3902        %RS(PSTCLASS=EXT);
       56     3976        %FR(PSTCLASS=EXT);
       57     4022        %FR1(PSTCLASS=EXT);
       58     4030        %CD(PSTCLASS=EXT);
       59     4049        %SC(PSTCLASS=EXT);
       60     4076        %SC1(PSTCLASS=EXT);
       61     4086        %INCLUDE ZIG_DBA_INT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:3    
       62     4134        %INCLUDE ZI_SUB4_CAN;
       63     4791        %UWA;
       64     5126        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:4    
       65     5127    1   DCL I UBIN (36);
       66     5128    1   DCL TPTR$ PTR;
       67     5129    1   DCL L_SUBSCH_RC UBIN (36);
       68     5130    1   DCL SUCC BIT (1);
       69     5131    1   DCL CURRENT_OFF UBIN (36) EXT;
       70     5132    1   DCL STATUS UBIN (6);
       71     5133    1   DCL ERROR_FLG UBIN (36) STATIC;
       72     5134    1   DCL LAST_RC UBIN (18) EXT;
       73     5135    1   DCL LAST_FR UBIN (18) EXT;
       74     5136    1   DCL LAST_SC UBIN (18) EXT;
       75     5137    1   DCL CURRENT_CF UBIN (18) EXT;
       76     5138    1   DCL LIST_STRING CHAR (128) EXT;
       77     5139    1   DCL SOSM_DBK UBIN (36) STATIC;
       78     5140    1   DCL RC_SM BIT (1);
       79     5141    1   DCL T1PTR$ PTR;
       80     5142    1   DCL T_OFF UBIN (18);
       81     5143    1   DCL LAST_RS_INT UBIN (18);
       82     5144    1   DCL WORD36 UBIN (36) BASED;
       83     5145    1   DCL RECORD_NUM UBIN (36) EXT;
       84     5146    1   DCL SAVE_DBK UBIN (36) STATIC;
       85     5147    1   DCL SAVE_CF_DBK UBIN (36) STATIC;
       86     5148    1   DCL CF_PTR$ PTR EXT;
       87     5149    1   DCL 1 CF_STR BASED,
       88     5150    1         2 NPTR$ PTR,
       89     5151    1         2 COUNT UBIN (36),
       90     5152    1         2 STR CHAR (CF_STR.COUNT);
       91     5153    1   DCL CF_TPTR$ PTR;
       92     5154    1   DCL START_N UBIN (36) STATIC;
       93     5155    1   DCL ZERO_A UBIN (36) STATIC INIT (0);
       94     5156    1   DCL CHAR2 CHAR (2) BASED;
       95     5157    1   DCL SAVE_BUF CHAR (128) STATIC;
       96     5158    1   DCL BASED_PTR$ PTR BASED;
       97     5159    1   DCL RECORD_FOUND BIT (1) EXT;
       98     5160        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:5    
       99     5161    1   FIND_LENGTH:
      100     5162    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      101     5163    2   DCL RETURN_LENGTH UBIN (36);
      102     5164    2   DCL STRING_TO_GET CHAR (30);
      103     5165    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);
      104     5166    2       RETURN;
      105     5167    2   NOT_BLANK:
      106     5168    2       RETURN_LENGTH = 30;
      107     5169    2       RETURN;
      108     5170    2   END FIND_LENGTH;
      109     5171        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:6    
      110     5172    1   ADD_SC:
      111     5173    1       PROC;
      112     5174    2       SAVE_BUF = IO_BUF;
      113     5175    2       TYPE_300.SET_NAME = UWA.SN.SENAME;
      114     5176    2       TYPE_300.SUB_SET_NAME = UWA.SN.SENAME;
      115     5177    2       IF UWA.SN.SETYPE = %ZIG_RTYPE_SC
      116     5178    2       THEN TYPE_300.TYPE=300;
      117     5179    2       ELSE TYPE_300.TYPE=350;
      118     5180    2       TYPE_300.REF_LINE = 0;
      119     5181    2       CALL ZIG$V_SET;
      120     5182    2       SC.DEF.SNSS = '1'B;
      121     5183    2       IO_BUF = SAVE_BUF;
      122     5184    2       CALL FINDD_6('****',SOSM_DBK);
      123     5185        /*
      124     5186              Return the current of set back to the last SM or SO
      125     5187            record that we were going through not the SM or SO set
      126     5188            for the SC record that we just added.
      127     5189        */
      128     5190    2       RETURN;
      129     5191    2   END ADD_SC;
      130     5192        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:7    
      131     5193    1   FIND_CF:
      132     5194    1       PROC(DBK,FOUND);
      133     5195    2   DCL DBK UBIN (36);
      134     5196    2   DCL FOUND UBIN (36);
      135     5197    2   DCL 1 SEARCH_STR,
      136     5198    2         2 STR CHAR(2) UNAL,
      137     5199    2         2 NUM REDEF STR UBIN (18) UNAL;
      138     5200    2       SEARCH_STR.NUM = DBK;
      139     5201    2       FOUND = 0;
      140     5202    2       START_N = 0;
      141     5203    2       CF_TPTR$ = CF_PTR$;
      142     5204    3       DO WHILE (CF_TPTR$ ~= ADDR(NIL));
      143     5205    3           CALL INDEX2(I,SEARCH_STR.STR,CF_TPTR$ -> CF_STR.STR,START_N)
      144     5206    3              ALTRET(INCREMENT);
      145     5207    3           IF MOD(I,4) = 0
      146     5208    4           THEN DO;
      147     5209    4               FOUND = 1;
      148     5210    4               ADDR(CURRENT_CF) -> CHAR2 = SUBSTR(CF_TPTR$ -> CF_STR.STR,I+2,2);
      149     5211    4               RETURN;
      150     5212    4               END;
      151     5213    4           ELSE DO;
      152     5214    4               START_N = I + 1;
      153     5215    4               END;
      154     5216    4           DO WHILE ('0'B);
      155     5217    4   INCREMENT:
      156     5218    4               CF_TPTR$ = CF_TPTR$ -> CF_STR.NPTR$;
      157     5219    4               START_N = 0;
      158     5220    4               END;
      159     5221    3           END;
      160     5222    2       RETURN;
      161     5223    2   END FIND_CF;
      162     5224        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:8    
      163     5225    1       CALL FIND_LENGTH(TYPE_400.SUB_RECORD_NAME,L_SUBSCH_RC);
      164     5226    1       ALLOCATE_END = 0; /* Allocate a start of mem */
      165     5227    1       IF TYPE_400.REF_LINE ~= 0 OR
      166     5228    1          TYPE_400.RECORD_NAME = '*DBPARAM' OR
      167     5229    1          TYPE_400.RECORD_NAME = '*CALC.RC'
      168     5230    2       THEN DO;
      169     5231    2           CALL SRCHD(TYPE_400.RECORD_NAME,%ZIG_RTYPE_RC,SUCC);
      170     5232    2           IF TYPE_400.REF_LINE = 0 AND ~SUCC
      171     5233    3           THEN DO;
      172     5234    3               RECORD_FOUND = '0'B;
      173     5235    3               RETURN;
      174     5236    3               END;
      175     5237    2           IF ~SUCC
      176     5238    3           THEN DO;
      177     5239    3               CALL SET_FIELDS(1,30,TYPE_400.RECORD_NAME);
      178     5240    3               CALL ERROR(%ZIG_V_RECORD_NAME);
      179     5241        /*E*     ERROR:    ZIG-ZIG_V_RECORD_NAME-C
      180     5242        MESSAGE: The record "%U1" is not present in the schema file.
      181     5243        */
      182     5244    3               RECORD_FOUND = '0'B;
      183     5245    3               RETURN;
      184     5246    3               END;
      185     5247    2           END;
      186     5248    1       RECORD_FOUND = '1'B;
      187     5249    1       IF TYPE_400.REF_LINE ~= 0
      188     5250    2       THEN DO;
      189     5251    2           SN_DBK = UWA.DIRECT_REF;
      190     5252    2           CALL ZIG$ADD_SI;
      191     5253    2           END;
      192     5254    1       CALL FETCHNS_6('SN-SE   ') ALTRET (DBCS_ERROR);
      193     5255    1       IF UWA.RC.PSMODE = 5
      194     5256    2       THEN DO;
      195     5257    2           CALL ZIG$G_DYN_MEM_6(2,RC1$);
      196     5258    2           RC1.CSPSB = UWA.RC.PA_OFFSET;
      197     5259    2           RC1.CSPES = UWA.RC.PA_ENTRY;
      198     5260    2           END;
      199     5261    2       ELSE DO;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:9    
      200     5262    2           CALL ZIG$G_DYN_MEM_6(1,TPTR$);
      201     5263    2           RC1$ = PINCRW(TPTR$,-1);
      202     5264    2           END;
      203     5265    1       CALL ZIG$G_DYN_MEM_6(%RC_BASE_SIZE+(L_SUBSCH_RC+3)/4,RC$);
      204     5266        /*
      205     5267              RC size = number of words in subschema set name
      206     5268                      + constant (5).
      207     5269        */
      208     5270    1       CURRENT_OFF = POFFW(RC$,SSS$);
      209     5271    1       STATUS = #IN_ALIAS;
      210     5272    1       ALLOCATE_END = 1;
      211     5273    1       HASH_SCHEMA_NAME = '1'B;
      212     5274    1       CALL ZIG$HASH_IT(TYPE_400.RECORD_NAME,#ADD,ERROR_FLG,4,2,12,
      213     5275    1          TPTR$,STATUS);
      214     5276    1       ALLOCATE_END = 0;
      215     5277    1       TPTR$ -> RECORD_HASH.REF = TYPE_400.REF_LINE;
      216     5278    1       TPTR$ -> RECORD_HASH.SUB_OFF = CURRENT_OFF;
      217     5279    1       TPTR$ -> RECORD_HASH.DBK = UWA.DIRECT_REF;
      218     5280        /*
      219     5281              Initialize the record in the hash table for fast access and
      220     5282            fast finding of that name.
      221     5283              There can be not dups or errors at this point since we had
      222     5284            a successful subschema translation and we have found the RC
      223     5285            record in the schema file.
      224     5286        */
      225     5287        /*
      226     5288              Now initialize the OA record in the schema subset and
      227     5289            connect it up to the OA-RC set.
      228     5290
      229     5291            Note:
      230     5292                 The OA record allways starts a offset of 1 from SSS$
      231     5293               and OA$ always points to the only OA record.
      232     5294        */
      233     5295    1       TPTR$ = PINCRW(SSS$,LAST_RC);
      234     5296    1       RC.OARCN = TPTR$ -> RC.OARCN;
      235     5297    1       IF UWA.RC.LSIZE > OA.LRSZ
      236     5298    1       THEN OA.LRSZ = UWA.RC.LSIZE;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:10   
      237     5299    1       TPTR$ -> RC.OARCN = CURRENT_OFF;
      238     5300    1       LAST_RC = CURRENT_OFF;
      239     5301    1       LAST_FR = LAST_RC;
      240     5302    1       LAST_RS_INT = LAST_RC;
      241     5303    1       RC.DEF.TYPE = '001000000000'B;
      242     5304    1       RC.DEF.PSTO = UWA.RC.PSMODE;
      243     5305        /*
      244     5306              Start the record out with being able to erase or store it.
      245     5307            it and if everything isn't there then let the subschema erase and
      246     5308            store it. (all fields and set info there).
      247     5309        */
      248     5310        /*
      249     5311              Record in subschema.
      250     5312        */
      251     5313    1       IF UWA.RC.FIXVAR ~= 0 THEN RC.DEF.FVR = '1'B;
      252     5314    1       IF UWA.RC.KEY_PRESENT ~= 0 THEN RC.DEF.RKEY = '1'B;
      253     5315    1       IF UWA.RC.PSMODE = 5 THEN RC.DEF.CSPAC = '1'B;
      254     5316    1       RC.DEF.RNL = L_SUBSCH_RC;
      255     5317    1       RC.RCID = TYPE_400.ID_NUM * 2;
      256     5318    1       RC.RSIZ = UWA.RC.LSIZE;
      257     5319    1       RC.RCON = 16;
      258     5320    1       RC.RTYP = UWA.RC.RTYPE;
      259     5321    1       RC.RCWSO = OA.CSZ + %CUR_BASE_SIZE;
      260     5322    1       OA.CSZ = OA.CSZ + %CUR_RC;
      261     5323    1       IF RC.DEF.PSTO = 4
      262     5324    2       THEN DO;
      263     5325    2           CALL FINDNS_6('RC-SOSM ') ALTRET (DBCS_ERROR);
      264     5326    2           CALL FETCHOS_6('SC-SOSM ') ALTRET (DBCS_ERROR);
      265     5327    2           OA.CSZ = OA.CSZ + (UWA.SC.KEY_LENGTH +1+2+4+3)/4;
      266     5328    2           CALL FCURR_R_6('RC  ');
      267     5329    2           END;
      268     5330    1       RC.RNAM = TYPE_400.SUB_RECORD_NAME;
      269     5331    1       RC1.OTVL = UWA.RC.CV_OFFSET;
      270     5332    1       IF TYPE_400.REF_LINE ~= 0 AND SUB_LANGUAGE = #COBOL
      271     5333    2       THEN DO;
      272     5334    2           CALL READSF(TYPE_400.REF_LINE,DESC_TYPE_9);
      273     5335    2           IF UWA.RC.PSMODE = 1
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:11   
      274     5336    3           THEN DO;
      275     5337    3               DESC_TYPE_9.FILLG = '100'B;
      276     5338    3               DESC_TYPE_9.F_DBK = '1'B;
      277     5339    3               END;
      278     5340    3           ELSE DO;
      279     5341    3               DESC_TYPE_9.FILLG = '000'B;
      280     5342    3               DESC_TYPE_9.F_DBK = '0'B;
      281     5343    3               END;
      282     5344    2           CALL WRITSF(TYPE_400.REF_LINE,DESC_TYPE_9);
      283     5345    2           END;
      284     5346        /*
      285     5347              This is where the DATA BASE PROCEDURES things should
      286     5348            go if there is any.
      287     5349        */
      288     5350        /*
      289     5351              Now we do the hard things.
      290     5352            First the record is connected up to the sets that it
      291     5353            belongs to so when we are done with the records we will have
      292     5354            all the SC record that must be in the schema subset all ready
      293     5355            in it so a search of the records to see what sets must be
      294     5356            present will not have to be done.
      295     5357            Then we go throw all the fields that belong to that record
      296     5358            and put them in the altrenate hash table for fast access.
      297     5359        */
      298     5360    2       DO WHILE ('1'B);
      299     5361    2           CALL FINDNS_6('RC-SOSM ') ALTRET(DONE_SOSM);
      300     5362    2           SOSM_DBK = UWA.DIRECT_REF;
      301     5363    2           IF UWA.RECORD_NAME = 'SO '
      302     5364    3           THEN DO;
      303     5365    3               RC_SM = '0'B;
      304     5366    3               END;
      305     5367    3           ELSE DO;
      306     5368    3               RC_SM = '1'B;
      307     5369    3               END;
      308     5370    2           CALL FINDOS_6('SC-SOSM ') ALTRET(DBCS_ERROR);
      309     5371    2           CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERROR);
      310     5372    2           IF UWA.SN.SETYPE = %ZIG_RTYPE_SC
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:12   
      311     5373    2           THEN STATUS = #SET_DEF;
      312     5374    2           ELSE STATUS = #KEY_DEF;
      313     5375    2           ALLOCATE_END = 1;
      314     5376    2           HASH_SCHEMA_NAME = '1'B;
      315     5377    2           CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,ERROR_FLG,0,1,14,
      316     5378    2              TPTR$,STATUS);
      317     5379    2           ALLOCATE_END = 0;
      318     5380    2           IF ERROR_FLG = 0
      319     5381    3           THEN DO;
      320     5382    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*' AND SUBSTR(RC.RNAM,0,1) ~= '*'
      321     5383    4               THEN DO;
      322     5384    4                   IF RC_SM
      323     5385    5                   THEN DO;
      324     5386    5                       RC.DEF.RERS = '1'B;
      325     5387    5                       END;
      326     5388    4                   IF RC.RNAM ~= '*CALC.RC'
      327     5389    4                   THEN RC.DEF.RSTO = '1'B;
      328     5390    4                   END;
      329     5391    3               CALL ADD_SC;
      330     5392    3               TPTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;
      331     5393    3               END;
      332     5394    2           IF RC_SM
      333     5395    3           THEN DO I = 0 TO TPTR$ -> SET_HASH.NUM_SM-1;
      334     5396    3               IF TPTR$ -> SET_HASH.SM_LIST.DBK(I) = SOSM_DBK
      335     5397    4               THEN DO;
      336     5398    4                   T_OFF = TPTR$ -> SET_HASH.SM_LIST.OFFSET(I);
      337     5399    4                   TPTR$ -> SET_HASH.SM_LIST.DBK(I) = - TPTR$ ->
      338     5400    4                      SET_HASH.SM_LIST.DBK(I);
      339     5401    4                   I = 9999;
      340     5402    4                   END;
      341     5403    3               END;
      342     5404    3           ELSE DO;
      343     5405    3               IF TPTR$ -> SET_HASH.SO.DBK = SOSM_DBK
      344     5406    4               THEN DO;
      345     5407    4                   T_OFF = TPTR$ -> SET_HASH.SO.OFFSET;
      346     5408    4                   TPTR$ -> SET_HASH.SO.DBK = - TPTR$ -> SET_HASH.SO.DBK;
      347     5409    4                   I = 10000;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:13   
      348     5410    4                   END;
      349     5411    3               ELSE I = 0;
      350     5412    3               END;
      351     5413    2           IF I < 9999
      352     5414    3           THEN DO;
      353     5415    3               CALL SET_FIELDS(1,30,TYPE_400.RECORD_NAME);
      354     5416    3               CALL SET_FIELDS(2,30,UWA.SN.SENAME);
      355     5417    3               CALL ERROR(%ZIG_NO_CF_REC);
      356     5418    3               CALL ABORT;
      357     5419        /*E*     ERROR:    ZIG-ZIG_NO_CF_REC-C
      358     5420        MESSAGE: For the record "%U1" no SM record was found for
      359     5421                 the set "%U2".
      360     5422                 <<<< SOFTWARE ERROR >>>>
      361     5423        */
      362     5424    3               END;
      363     5425    2           TPTR$ = PINCRW(SSS$,T_OFF);
      364     5426    2           IF TPTR$ -> RS.DEF.VIA
      365     5427    3           THEN DO;
      366     5428    3               TPTR$ -> RS.RCRSN = RC.RCRSN;
      367     5429    3               TPTR$ -> RS.RCRSH = LAST_RC;
      368     5430    3               RC.RCRSN = T_OFF;
      369     5431    3               IF LAST_RC = LAST_RS_INT THEN LAST_RS_INT = T_OFF;
      370     5432    3               END;
      371     5433    3           ELSE DO;
      372     5434    3               T1PTR$ = PINCRW(SSS$,LAST_RS_INT);
      373     5435    3               TPTR$ -> RS.RCRSN = T1PTR$ -> RS.RCRSN;
      374     5436    3               TPTR$ -> RS.RCRSH = LAST_RC;
      375     5437    3               T1PTR$ -> RS.RCRSN = T_OFF;
      376     5438    3               LAST_RS_INT = T_OFF;
      377     5439    3               END;
      378     5440    2           TYPE_33.NUM_CON_FIELDS = 0;
      379     5441    2           T1PTR$ = PINCRW(SSS$, TPTR$ -> RS.RSSSN);
      380     5442    3           DO WHILE (T1PTR$ ~= SSS$);
      381     5443    3               TYPE_33.NUM_CON_FIELDS = TYPE_33.NUM_CON_FIELDS + 1;
      382     5444    3               T1PTR$ = PINCRW(SSS$, T1PTR$ -> RS.RSSSN);
      383     5445    3               END;
      384     5446    2           TYPE_32.NUM_CON_FIELDS = TYPE_33.NUM_CON_FIELDS;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:14   
      385     5447        /*
      386     5448            Now, write out the type 32 and 33 descriptors in the ext. name
      387     5449            segment in the subschema file for each record set relationship
      388     5450            which is in the subschema.
      389     5451        */
      390     5452    2           SC$ = PINCRW(SSS$,TPTR$ -> RS.SCRSH);
      391     5453    2           IF SC.SNAM ~= '*CALC' AND TYPE_400.REF_LINE ~= 0
      392     5454    2              AND NOT SC.DEF.SRCR
      393     5455    3           THEN DO;
      394     5456    3               IF SC.DEF.SETT = 2 OR SC.DEF.SETT = 3
      395     5457    4               THEN DO;
      396     5458    4                   TYPE_33.RECORD_NAME = RC.RCID / 2;
      397     5459    4                   TYPE_33.SUB_RECORD_NM = RC.RNAM;
      398     5460    4                   TYPE_33.KEY_NAME = SC.SCID;
      399     5461    4                   TYPE_33.SUB_KEY_NM = SC.SNAM;
      400     5462    4                   IF SC.DEF.SETT = 2 /* PRIMARY */
      401     5463    4                   THEN TYPE_33.PRIM_OR_SEC = '1'B;
      402     5464    4                   ELSE TYPE_33.PRIM_OR_SEC = '0'B;
      403     5465    4                   CALL WRITSF(CUR_EXT_NAME_SEG,TYPE_33);
      404     5466    4                   END;
      405     5467    4               ELSE DO;
      406     5468    4                   TYPE_32.RECORD_NAME = RC.RCID / 2;
      407     5469    4                   TYPE_32.SUB_RECORD_NM = RC.RNAM;
      408     5470    4                   TYPE_32.SET_NAME = SC.SCID;
      409     5471    4                   TYPE_32.SUB_SET_NM = SC.SNAM;
      410     5472    4                   TYPE_32.OWNER = ~RC_SM;
      411     5473    4                   TYPE_32.MEMBER = RC_SM;
      412     5474    4                   TYPE_32.OPTIONAL_MEM = TPTR$ -> RS.DEF.OSM;
      413     5475    4                   TYPE_32.MANUAL_MEM = TPTR$ -> RS.DEF.MSM;
      414     5476    4                   TYPE_32.MODIFY_NOT = TPTR$ -> RS.DEF.SMOD;
      415     5477    4                   CALL WRITSF(CUR_EXT_NAME_SEG,TYPE_32);
      416     5478    4                   END;
      417     5479    3               CONTROL.NUM_REC_SET_REL = CONTROL.NUM_REC_SET_REL + 1;
      418     5480    3               CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;
      419     5481    3               END;
      420     5482    2           END;
      421     5483    1   DONE_SOSM:
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:15   
      422     5484    1       IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;
      423     5485    2       DO WHILE (RC.RNAM ~= '*CALC.RC' AND RC.RNAM ~= '*DBPARAM');
      424     5486    2           CALL FETCHNS_6('RC-FR   ') ALTRET(DONE_FR);
      425     5487    2           SAVE_DBK = UWA.DIRECT_REF;
      426     5488    2           IF UWA.FR.SYN = 1 OR
      427     5489    2              UWA.FR.RPT = 1 OR UWA.FR.F_OCCURS > 0
      428     5490    3           THEN DO;
      429     5491        /*
      430     5492              This is a control field of some kind so it must be
      431     5493            connected to the record and a FR record build for this
      432     5494            field because the record is pressent in the subschema.
      433     5495              SYN FR records are not connected up in a set in the
      434     5496            RCFRN set.
      435     5497        */
      436     5498    3               CALL ZIG$G_DYN_MEM_6(1, FR1$);
      437     5499    3               CALL ZIG$G_DYN_MEM_6(6, FR$);
      438     5500    3               FR1.NLIND = SAVE_DBK;
      439     5501    3               FR.DEF.TYPE = '000000010000'B;
      440     5502    3               IF UWA.FR.SYN = 1
      441     5503    3               THEN FR.DEF.SYN = '1'B;
      442     5504    3               CURRENT_OFF = POFFW(FR$,SSS$);
      443     5505    3               FR.RCFRH = LAST_RC;
      444     5506    3               TPTR$ = PINCRW(SSS$,LAST_FR);
      445     5507    3               FR.RCFRN = TPTR$ -> FR.RCFRN;
      446     5508    3               TPTR$ -> FR.RCFRN = CURRENT_OFF;
      447     5509    3               LAST_FR = CURRENT_OFF;
      448     5510    3               FR.DEF.FUSE = UWA.FR.F_USE;
      449     5511    3               ADDR(FR.UOFST) -> WORD36 = UWA.FR.FR_FRH;
      450     5512    3               ADDR(FR.ROFST) -> WORD36 = UWA.FR.BUFFLOC;
      451     5513        /*
      452     5514              FR.UOFST - the DBK of the FR record related to this control
      453     5515                           field.
      454     5516              FR.ROFST - the DBK of this FR record in the schema file.
      455     5517        */
      456     5518    4               DO WHILE ('1'B);
      457     5519    4                   CALL FINDNS_6('FR-CFS   ') ALTRET(END_CFS);
      458     5520    4                   SAVE_CF_DBK = UWA.DIRECT_REF;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:16   
      459     5521        /*
      460     5522              Now search the hash table for the DBK that is in that CF record
      461     5523            so we can find the offset in the schema subset.
      462     5524        */
      463     5525    4                   CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);
      464     5526    4                   IF ERROR_FLG = 0
      465     5527    5                   THEN DO;
      466     5528    5                       CALL ERROR(%ZIG_NO_CF_FR);
      467     5529        /*       ERROR:    ZIG-ZIG_NO_CF_FR-C
      468     5530        MESSAGE: This CF record is not already in the schema subset from
      469     5531                 the set information.
      470     5532                 <<<< SOFTWARE ERROR >>>>
      471     5533        */
      472     5534    5                       CALL ABORT;
      473     5535    5                       END;
      474     5536    4                   T1PTR$ = PINCRW(SSS$,CURRENT_CF);
      475     5537    4                   T1PTR$ -> CD.CDSH = LAST_FR;
      476     5538    4                   T1PTR$ -> CD.CDSN = FR.CDSN;
      477     5539    4                   FR.CDSN = CURRENT_CF;
      478     5540    4                   END;
      479     5541    3   END_CFS:
      480     5542    3               CALL FCURR_R_6('FR  ');
      481     5543    4               DO WHILE ('1'B);
      482     5544    4                   CALL FINDNS_6('FR-CFR   ') ALTRET(END_CFR);
      483     5545    4                   SAVE_CF_DBK = UWA.DIRECT_REF;
      484     5546        /*
      485     5547              Now search the hash table for the DBK that is in that CF record
      486     5548            so we can find the offset in the schema subset.
      487     5549        */
      488     5550    4                   CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);
      489     5551    4                   IF ERROR_FLG = 0
      490     5552    5                   THEN DO;
      491     5553    5                       CALL ERROR(%ZIG_NO_CF_FR);
      492     5554        /*       ERROR:    ZIG-ZIG_NO_CF_FR-C
      493     5555        MESSAGE: This CF record is not already in the schema subset from
      494     5556                 the set information.
      495     5557                 <<<< SOFTWARE ERROR >>>>
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:17   
      496     5558        */
      497     5559    5                       CALL ABORT;
      498     5560    5                       END;
      499     5561    4                   T1PTR$ = PINCRW(SSS$,CURRENT_CF);
      500     5562    4                   T1PTR$ -> CD.CDRH = LAST_FR;
      501     5563    4                   T1PTR$ -> CD.CDRN = FR.CDRN;
      502     5564    4                   FR.CDRN = CURRENT_CF;
      503     5565    4                   END;
      504     5566    3   END_CFR:
      505     5567    3               IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;
      506     5568    3               END;
      507     5569    3           ELSE DO;
      508     5570    3               CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERROR);
      509     5571    3               ALLOCATE_END = 2;
      510     5572    3               STATUS = #ITEM_DEF;
      511     5573    3               HASH_SCHEMA_NAME = '1'B;
      512     5574    3               CALL ZIG$HASH_IT(UWA.SN.SENAME,#ADD_ALT_HASH,ERROR_FLG,0,RECORD_NUM,
      513     5575    3                  13,TPTR$,STATUS);
      514     5576    3               ALLOCATE_END = 0;
      515     5577    3               TPTR$ -> FIELD_HASH.DBK = SAVE_DBK;
      516     5578    3               TPTR$ -> FIELD_HASH.DBK_SN = UWA.DIRECT_REF;
      517     5579    3               END;
      518     5580    2           END;
      519     5581    1   DONE_FR:
      520     5582    1       RETURN;
      521     5583    1   DBCS_ERROR:
      522     5584    1       CALL ABORT;
      523     5585    1       RETURN;
      524     5586    1   END ZIG$V_RECORD;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:18   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_RECORD.

   Procedure ZIG$V_RECORD requires 877 words for executable code.
   Procedure ZIG$V_RECORD requires 26 words of local(AUTO) storage.

    No errors detected in file ZIG$V_RECORD.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:19   

 Object Unit name= ZIG$V_RECORD                               File name= ZIG$V_RECORD.:ZIC0TOU
 UTS= SEP 05 '97 12:23:44.12 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  CUR_EXT_NAME_SEG
    1  LblCom even  none     1      1  SN_DBK
    2  LblCom even  none    12     14  ANALS
    3  LblCom even  none    13     15  PURGE
    4  LblCom even  none    19     23  DICTS
    5  LblCom even  none    23     27  DISPS
    6  LblCom even  none    22     26  VALIDS
    7  LblCom even  none    12     14  LOCKS
    8  LblCom even  none    10     12  STRAN
    9  LblCom even  none    12     14  DTRAN
   10  LblCom even  none    16     20  SSTRANS
   11  LblCom even  none    20     24  SSGEN
   12  LblCom even  none     5      5  LANG_ALLOWED
   13  LblCom even  none     1      1  SUB_LANGUAGE
   14  LblCom even  none    16     20  HEADING_TEXT
   15  LblCom even  none    13     15  LANG_TEXT
   16  LblCom even  none     1      1  HASH_SCHEMA_NAME
   17  LblCom even  none     1      1  CURRENT_RECORD
   18  LblCom even  none    64    100  CONTROL
   19  LblCom even  none    32     40  DESC_TYPE_9
   20  LblCom even  none    33     41  TYPE_32
   21  LblCom even  none    33     41  TYPE_33
   22  LblCom even  none    32     40  IO_BUF
   23  LblCom even  none     1      1  NUM_ERROR_MSG
   24  LblCom even  none     1      1  NUM_WARN_MSG
   25  LblCom even  none     1      1  ALLOCATE_END
   26  LblCom even  none     2      2  SUBSCHEMA_KEY
   27  LblCom even  none     1      1  BUFFER$
   28  LblCom even  none     1      1  ERROR_IO
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:20   
   29  LblCom even  none     1      1  BUFFER_LEN
   30  LblCom even  none     2      2  UWA_KEY
   31  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   32  LblCom even  none     2      2  RVA_KEY
   33  LblCom even  none     2      2  IA__KEY
   34  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   35  LblCom even  none    32     40  SEARCHR_NB
   36  LblCom even  none    32     40  SEM_COM
   37  LblCom even  none    32     40  DMCL_XLATE
   38  LblCom even  none    32     40  Q2_PERCENT
   39  LblCom even  none     1      1  SSS$
   40  LblCom even  none     1      1  OA$
   41  LblCom even  none     1      1  OA1$
   42  LblCom even  none     1      1  RC$
   43  LblCom even  none     1      1  RC1$
   44  LblCom even  none     1      1  DP$
   45  LblCom even  none     1      1  DP1$
   46  LblCom even  none     1      1  RS$
   47  LblCom even  none     1      1  FR$
   48  LblCom even  none     1      1  FR1$
   49  LblCom even  none     1      1  CD$
   50  LblCom even  none     1      1  SC$
   51  LblCom even  none     1      1  SC1$
   52  LblCom even  none   656   1220  UWA
   53  LblCom even  none     1      1  CURRENT_OFF
   54   Data  even  none    38     46  ZIG$V_RECORD
   55  LblCom even  none     1      1  LAST_RC
   56  LblCom even  none     1      1  LAST_FR
   57  LblCom even  none     1      1  LAST_SC
   58  LblCom even  none     1      1  CURRENT_CF
   59  LblCom even  none    32     40  LIST_STRING
   60  LblCom even  none     1      1  RECORD_NUM
   61  LblCom even  none     1      1  CF_PTR$
   62  LblCom even  none     1      1  RECORD_FOUND
   63  RoData even  UTS     24     30  ZIG$V_RECORD
   64   Proc  even  none   877   1555  ZIG$V_RECORD
   65  RoData even  none    76    114  ZIG$V_RECORD
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:21   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    64      0   yes            yes      Std        0  ZIG$V_RECORD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 SRCHD
 yes     yes           Std       1 FETCHOS_6
         yes           Std       3 SET_FIELDS
         yes           Std       0 ZIG$ADD_SI
 yes     yes           Std       1 FETCHNS_6
         yes           Std       8 ZIG$HASH_IT
 yes     yes           Std       1 FINDNS_6
 yes     yes           Std       1 FCURR_R_6
         yes           Std       2 READSF
         yes           Std       2 WRITSF
         yes           Std       1 ERROR
         yes           Std       2 ZIG$G_DYN_MEM_6
 yes     yes           Std       1 FINDOS_6
         yes           Std       0 ABORT
         yes           Std       0 ZIG$V_SET
 yes     yes           Std       2 FINDD_6
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:22   


        1        1        /*M*     ZIG$V_RECORD      I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_RECORD
        9        9        PURPOSE:
       10       10              To create the RC records for all the records in the
       11       11            subschema DDL and initialize them to what they should
       12       12            be.
       13       13        */
       14       14        /*
       15       15        ZZZZZ  III   GGG    $   V   V       RRRR  EEEEE  CCC   OOO  RRRR  DDDD
       16       16            Z   I   G   G  $$$  V   V       R   R E     C   C O O O R   R D   D
       17       17           Z    I   G     $ $   V   V       R   R E     C     O O O R   R D   D
       18       18          Z     I   G      $$$  V   V       RRRR  EEEE  C     O  OO RRRR  D   D
       19       19         Z      I   G  GG   $ $ V   V       R R   E     C     O   O R R   D   D
       20       20        Z       I   G   G  $$$   V V        R  R  E     C   C O   O R  R  D   D
       21       21        ZZZZZ  III   GGG    $     V         R   R EEEEE  CCC   OOO  R   R DDDD
       22       22                                      _____
       23       23        */
       24       24        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:23   
       25       25        ZIG$V_RECORD:
       26       26            PROC;

     26 64 000000   000000 700200 xent  ZIG$V_RECORD TSX0  ! X66_AUTO_0
        64 000001   000032 000000                    ZERO    26,0
        64 000002   000151 710000 64                 TRA     s:5225

       27       27    1   DCL ZIG$HASH_IT ENTRY (8);
       28       28    1   DCL ZIG$V_SET ENTRY;
       29       29    1   DCL CUR_EXT_NAME_SEG UBIN (36) EXT;
       30       30    1   DCL WRITSF ENTRY (2);
       31       31    1   DCL READSF ENTRY (2);
       32       32    1   DCL ZIG$ADD_SI ENTRY;
       33       33    1   DCL SN_DBK UBIN (36) EXT;
       34       34        %INCLUDE ZI_ERRORS_SUBS;
       35      554        %INCLUDE ZI_SUB_LANG;
       36     2269        %INCLUDE ZIG_DIR_STRUCS;
       37     2399        %GENERAL;
       38     2523        %CONTROL_BLOCK;
       39     2631        %DESC_TYPE_9;
       40     2808        %DESC_TYPE_32;
       41     2874        %DESC_TYPE_33;
       42     2919    1   DCL IO_BUF CHAR (128) EXT;
       43     2920        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
       44     2979        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       45     3048        %INCLUDE ZIG_GENERAL;
       46     3156        %INCLUDE ZIG_TYPE_SUBS;
       47     3171        %INCLUDE ZIG_SSS;
       48     3741        %SS_GENERAL(PSTCLASS=EXT);
       49     3762        %OA(PSTCLASS=EXT);
       50     3829        %OA1(PSTCLASS=EXT);
       51     3837        %RC(PSTCLASS=EXT);
       52     3870        %RC1(PSTCLASS=EXT);
       53     3880        %DP(PSTCLASS=EXT);
       54     3894        %DP1(PSTCLASS=EXT);
       55     3902        %RS(PSTCLASS=EXT);
       56     3976        %FR(PSTCLASS=EXT);
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:24   
       57     4022        %FR1(PSTCLASS=EXT);
       58     4030        %CD(PSTCLASS=EXT);
       59     4049        %SC(PSTCLASS=EXT);
       60     4076        %SC1(PSTCLASS=EXT);
       61     4086        %INCLUDE ZIG_DBA_INT;
       62     4134        %INCLUDE ZI_SUB4_CAN;
       63     4791        %UWA;
       64     5126        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:25   
       65     5127    1   DCL I UBIN (36);
       66     5128    1   DCL TPTR$ PTR;
       67     5129    1   DCL L_SUBSCH_RC UBIN (36);
       68     5130    1   DCL SUCC BIT (1);
       69     5131    1   DCL CURRENT_OFF UBIN (36) EXT;
       70     5132    1   DCL STATUS UBIN (6);
       71     5133    1   DCL ERROR_FLG UBIN (36) STATIC;
       72     5134    1   DCL LAST_RC UBIN (18) EXT;
       73     5135    1   DCL LAST_FR UBIN (18) EXT;
       74     5136    1   DCL LAST_SC UBIN (18) EXT;
       75     5137    1   DCL CURRENT_CF UBIN (18) EXT;
       76     5138    1   DCL LIST_STRING CHAR (128) EXT;
       77     5139    1   DCL SOSM_DBK UBIN (36) STATIC;
       78     5140    1   DCL RC_SM BIT (1);
       79     5141    1   DCL T1PTR$ PTR;
       80     5142    1   DCL T_OFF UBIN (18);
       81     5143    1   DCL LAST_RS_INT UBIN (18);
       82     5144    1   DCL WORD36 UBIN (36) BASED;
       83     5145    1   DCL RECORD_NUM UBIN (36) EXT;
       84     5146    1   DCL SAVE_DBK UBIN (36) STATIC;
       85     5147    1   DCL SAVE_CF_DBK UBIN (36) STATIC;
       86     5148    1   DCL CF_PTR$ PTR EXT;
       87     5149    1   DCL 1 CF_STR BASED,
       88     5150    1         2 NPTR$ PTR,
       89     5151    1         2 COUNT UBIN (36),
       90     5152    1         2 STR CHAR (CF_STR.COUNT);
       91     5153    1   DCL CF_TPTR$ PTR;
       92     5154    1   DCL START_N UBIN (36) STATIC;
       93     5155    1   DCL ZERO_A UBIN (36) STATIC INIT (0);
       94     5156    1   DCL CHAR2 CHAR (2) BASED;
       95     5157    1   DCL SAVE_BUF CHAR (128) STATIC;
       96     5158    1   DCL BASED_PTR$ PTR BASED;
       97     5159    1   DCL RECORD_FOUND BIT (1) EXT;
       98     5160        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:26   
       99     5161    1   FIND_LENGTH:

   5161 64 000003   200016 741300       FIND_LENGTH  STX1  ! CF_TPTR$+2,,AUTO

      100     5162    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      101     5163    2   DCL RETURN_LENGTH UBIN (36);
      102     5164    2   DCL STRING_TO_GET CHAR (30);
      103     5165    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);

   5165 64 000004   200020 470500                    LDP0    @RETURN_LENGTH,,AUTO
        64 000005   200017 471500                    LDP1    @STRING_TO_GET,,AUTO
        64 000006   000000 124500                    SCM     mask='000'O
        64 000007   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        64 000010   000000 000001 65                 ADSC9   0                        cn=0,n=1
        64 000011   000000 000100                    ARG     0,,PR0
        64 000012   000015 606400 64                 TTN     NOT_BLANK

      104     5166    2       RETURN;

   5166 64 000013   200016 221300                    LDX1  ! CF_TPTR$+2,,AUTO
        64 000014   000001 702211                    TSX2  ! 1,X1

      105     5167    2   NOT_BLANK:
      106     5168    2       RETURN_LENGTH = 30;

   5168 64 000015   000036 235007       NOT_BLANK    LDA     30,DL
        64 000016   200020 470500                    LDP0    @RETURN_LENGTH,,AUTO
        64 000017   000000 755100                    STA     0,,PR0

      107     5169    2       RETURN;

   5169 64 000020   200016 221300                    LDX1  ! CF_TPTR$+2,,AUTO
        64 000021   000001 702211                    TSX2  ! 1,X1

      108     5170    2   END FIND_LENGTH;
      109     5171        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:27   
      110     5172    1   ADD_SC:

   5172 64 000022   200016 741300       ADD_SC       STX1  ! CF_TPTR$+2,,AUTO

      111     5173    1       PROC;
      112     5174    2       SAVE_BUF = IO_BUF;

   5174 64 000023   040000 100400                    MLR     fill='040'O
        64 000024   000000 000200 22                 ADSC9   IO_BUF                   cn=0,n=128
        64 000025   000006 000200 54                 ADSC9   SAVE_BUF                 cn=0,n=128

      113     5175    2       TYPE_300.SET_NAME = UWA.SN.SENAME;

   5175 64 000026   040000 100400                    MLR     fill='040'O
        64 000027   000427 000036 52                 ADSC9   UWA+279                  cn=0,n=30
        64 000030   000003 000036 22                 ADSC9   IO_BUF+3                 cn=0,n=30

      114     5176    2       TYPE_300.SUB_SET_NAME = UWA.SN.SENAME;

   5176 64 000031   040000 100400                    MLR     fill='040'O
        64 000032   000427 000036 52                 ADSC9   UWA+279                  cn=0,n=30
        64 000033   000013 000036 22                 ADSC9   IO_BUF+11                cn=0,n=30

      115     5177    2       IF UWA.SN.SETYPE = %ZIG_RTYPE_SC

   5177 64 000034   000424 235000 52                 LDA     UWA+276
        64 000035   000036 115007                    CMPA    30,DL
        64 000036   000042 601000 64                 TNZ     s:5179

      116     5178    2       THEN TYPE_300.TYPE=300;

   5178 64 000037   000454 236007                    LDQ     300,DL
        64 000040   000000 756000 22                 STQ     IO_BUF
        64 000041   000044 710000 64                 TRA     s:5180

      117     5179    2       ELSE TYPE_300.TYPE=350;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:28   
   5179 64 000042   000536 236007                    LDQ     350,DL
        64 000043   000000 756000 22                 STQ     IO_BUF

      118     5180    2       TYPE_300.REF_LINE = 0;

   5180 64 000044   000001 450000 22                 STZ     IO_BUF+1

      119     5181    2       CALL ZIG$V_SET;

   5181 64 000045   000001 631400 65                 EPPR1   1
        64 000046   000000 701000 xent               TSX1    ZIG$V_SET
        64 000047   000000 011000                    NOP     0

      120     5182    2       SC.DEF.SNSS = '1'B;

   5182 64 000050   000000 470400 50                 LDP0    SC$
        64 000051   020000 236007                    LDQ     8192,DL
        64 000052   000000 256100                    ORSQ    0,,PR0

      121     5183    2       IO_BUF = SAVE_BUF;

   5183 64 000053   040000 100400                    MLR     fill='040'O
        64 000054   000006 000200 54                 ADSC9   SAVE_BUF                 cn=0,n=128
        64 000055   000000 000200 22                 ADSC9   IO_BUF                   cn=0,n=128

      122     5184    2       CALL FINDD_6('****',SOSM_DBK);

   5184 64 000056   000003 630400 65                 EPPR0   3
        64 000057   000002 631400 65                 EPPR1   2
        64 000060   000000 701000 xent               TSX1    FINDD_6
        64 000061   000000 011000                    NOP     0

      123     5185        /*
      124     5186              Return the current of set back to the last SM or SO
      125     5187            record that we were going through not the SM or SO set
      126     5188            for the SC record that we just added.
      127     5189        */
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:29   
      128     5190    2       RETURN;

   5190 64 000062   200016 221300                    LDX1  ! CF_TPTR$+2,,AUTO
        64 000063   000001 702211                    TSX2  ! 1,X1

      129     5191    2   END ADD_SC;
      130     5192        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:30   
      131     5193    1   FIND_CF:

   5193 64 000064   200016 741300       FIND_CF      STX1  ! CF_TPTR$+2,,AUTO

      132     5194    1       PROC(DBK,FOUND);
      133     5195    2   DCL DBK UBIN (36);
      134     5196    2   DCL FOUND UBIN (36);
      135     5197    2   DCL 1 SEARCH_STR,
      136     5198    2         2 STR CHAR(2) UNAL,
      137     5199    2         2 NUM REDEF STR UBIN (18) UNAL;
      138     5200    2       SEARCH_STR.NUM = DBK;

   5200 64 000065   200017 470500                    LDP0    @DBK,,AUTO
        64 000066   000000 720100                    LXL0    0,,PR0
        64 000067   200021 740100                    STX0    SEARCH_STR,,AUTO

      139     5201    2       FOUND = 0;

   5201 64 000070   200020 471500                    LDP1    @FOUND,,AUTO
        64 000071   100000 450100                    STZ     0,,PR1

      140     5202    2       START_N = 0;

   5202 64 000072   000004 450000 54                 STZ     START_N

      141     5203    2       CF_TPTR$ = CF_PTR$;

   5203 64 000073   000000 236000 61                 LDQ     CF_PTR$
        64 000074   200014 756100                    STQ     CF_TPTR$,,AUTO

      142     5204    3       DO WHILE (CF_TPTR$ ~= ADDR(NIL));

   5204 64 000075   000144 710000 64                 TRA     s:5221

      143     5205    3           CALL INDEX2(I,SEARCH_STR.STR,CF_TPTR$ -> CF_STR.STR,START_N)

   5205 64 000076   200014 470500                    LDP0    CF_TPTR$,,AUTO
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:31   
        64 000077   000001 720100                    LXL0    1,,PR0
        64 000100   000000 636010                    EAQ     0,X0
        64 000101   000022 772000                    QRL     18
        64 000102   000004 136000 54                 SBLQ    START_N
        64 000103   200022 756100                    STQ     SEARCH_STR+1,,AUTO
        64 000104   000004 236000 54                 LDQ     START_N
        64 000105   200022 720100                    LXL0    SEARCH_STR+1,,AUTO
        64 000106   000004 235000 54                 LDA     START_N
        64 000107   000100 120545                    SCD
        64 000110   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=*X0
        64 000111   200021 000002                    ADSC9   SEARCH_STR,,AUTO         cn=0,n=2
        64 000112   200003 000100                    ARG     I,,AUTO
        64 000113   200003 056100                    ASQ     I,,AUTO
        64 000114   000117 607000 64                 TTF     s:5207
        64 000115   200003 054100                    AOS     I,,AUTO
        64 000116   000140 710000 64                 TRA     INCREMENT

      144     5206    3              ALTRET(INCREMENT);
      145     5207    3           IF MOD(I,4) = 0

   5207 64 000117   200003 236100                    LDQ     I,,AUTO
        64 000120   000003 376007                    ANQ     3,DL
        64 000121   000134 601000 64                 TNZ     s:5214

      146     5208    4           THEN DO;

      147     5209    4               FOUND = 1;

   5209 64 000122   000001 236007                    LDQ     1,DL
        64 000123   200020 471500                    LDP1    @FOUND,,AUTO
        64 000124   100000 756100                    STQ     0,,PR1

      148     5210    4               ADDR(CURRENT_CF) -> CHAR2 = SUBSTR(CF_TPTR$ -> CF_STR.STR,I+2,2);

   5210 64 000125   000001 720100                    LXL0    1,,PR0
        64 000126   200003 235100                    LDA     I,,AUTO
        64 000127   040000 100505                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:32   
        64 000130   000002 400002                    ADSC9   2,A,PR0                  cn=2,n=2
        64 000131   000000 000002 58                 ADSC9   CURRENT_CF               cn=0,n=2

      149     5211    4               RETURN;

   5211 64 000132   200016 221300                    LDX1  ! CF_TPTR$+2,,AUTO
        64 000133   000001 702211                    TSX2  ! 1,X1

      150     5212    4               END;
      151     5213    4           ELSE DO;

      152     5214    4               START_N = I + 1;

   5214 64 000134   200003 236100                    LDQ     I,,AUTO
        64 000135   000001 036007                    ADLQ    1,DL
        64 000136   000004 756000 54                 STQ     START_N

      153     5215    4               END;

      154     5216    4           DO WHILE ('0'B);

   5216 64 000137   000144 710000 64                 TRA     s:5221

      155     5217    4   INCREMENT:
      156     5218    4               CF_TPTR$ = CF_TPTR$ -> CF_STR.NPTR$;

   5218 64 000140   200014 470500       INCREMENT    LDP0    CF_TPTR$,,AUTO
        64 000141   000000 236100                    LDQ     0,,PR0
        64 000142   200014 756100                    STQ     CF_TPTR$,,AUTO

      157     5219    4               START_N = 0;

   5219 64 000143   000004 450000 54                 STZ     START_N

      158     5220    4               END;

      159     5221    3           END;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:33   

   5221 64 000144   200014 236100                    LDQ     CF_TPTR$,,AUTO
        64 000145   000005 116000 65                 CMPQ    5
        64 000146   000076 601000 64                 TNZ     s:5205

      160     5222    2       RETURN;

   5222 64 000147   200016 221300                    LDX1  ! CF_TPTR$+2,,AUTO
        64 000150   000001 702211                    TSX2  ! 1,X1

      161     5223    2   END FIND_CF;
      162     5224        %EJECT;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:34   
      163     5225    1       CALL FIND_LENGTH(TYPE_400.SUB_RECORD_NAME,L_SUBSCH_RC);

   5225 64 000151   200005 630500                    EPPR0   L_SUBSCH_RC,,AUTO
        64 000152   200020 450500                    STP0    @DBK+1,,AUTO
        64 000153   000006 236000 65                 LDQ     6
        64 000154   200017 756100                    STQ     CF_TPTR$+3,,AUTO
        64 000155   000003 701000 64                 TSX1    FIND_LENGTH
        64 000156   000000 011000                    NOP     0

      164     5226    1       ALLOCATE_END = 0; /* Allocate a start of mem */

   5226 64 000157   000000 450000 25                 STZ     ALLOCATE_END

      165     5227    1       IF TYPE_400.REF_LINE ~= 0 OR

   5227 64 000160   000001 235000 22                 LDA     IO_BUF+1
        64 000161   000172 601000 64                 TNZ     s:5231
        64 000162   040000 106400                    CMPC    fill='040'O
        64 000163   000003 000036 22                 ADSC9   IO_BUF+3                 cn=0,n=30
        64 000164   000001 000010 63                 ADSC9   1                        cn=0,n=8
        64 000165   000172 600000 64                 TZE     s:5231
        64 000166   040000 106400                    CMPC    fill='040'O
        64 000167   000003 000036 22                 ADSC9   IO_BUF+3                 cn=0,n=30
        64 000170   000003 000010 63                 ADSC9   3                        cn=0,n=8
        64 000171   000230 601000 64                 TNZ     s:5248

      166     5228    1          TYPE_400.RECORD_NAME = '*DBPARAM' OR
      167     5229    1          TYPE_400.RECORD_NAME = '*CALC.RC'
      168     5230    2       THEN DO;

      169     5231    2           CALL SRCHD(TYPE_400.RECORD_NAME,%ZIG_RTYPE_RC,SUCC);

   5231 64 000172   200006 630500                    EPPR0   SUCC,,AUTO
        64 000173   200024 450500                    STP0    SEARCH_STR+3,,AUTO
        64 000174   000012 237000 65                 LDAQ    10
        64 000175   200022 757100                    STAQ    SEARCH_STR+1,,AUTO
        64 000176   200022 630500                    EPPR0   SEARCH_STR+1,,AUTO
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:35   
        64 000177   000007 631400 65                 EPPR1   7
        64 000200   000000 701000 xent               TSX1    SRCHD
        64 000201   000000 011000                    NOP     0

      170     5232    2           IF TYPE_400.REF_LINE = 0 AND ~SUCC

   5232 64 000202   000001 235000 22                 LDA     IO_BUF+1
        64 000203   000212 601000 64                 TNZ     s:5237
        64 000204   200006 236100                    LDQ     SUCC,,AUTO
        64 000205   400000 376003                    ANQ     -131072,DU
        64 000206   400000 676003                    ERQ     -131072,DU
        64 000207   000212 600000 64                 TZE     s:5237

      171     5233    3           THEN DO;

      172     5234    3               RECORD_FOUND = '0'B;

   5234 64 000210   000000 450000 62                 STZ     RECORD_FOUND

      173     5235    3               RETURN;

   5235 64 000211   000000 702200 xent               TSX2  ! X66_ARET

      174     5236    3               END;
      175     5237    2           IF ~SUCC

   5237 64 000212   200006 236100                    LDQ     SUCC,,AUTO
        64 000213   400000 376003                    ANQ     -131072,DU
        64 000214   400000 676003                    ERQ     -131072,DU
        64 000215   000230 600000 64                 TZE     s:5248

      176     5238    3           THEN DO;

      177     5239    3               CALL SET_FIELDS(1,30,TYPE_400.RECORD_NAME);

   5239 64 000216   000015 630400 65                 EPPR0   13
        64 000217   000007 631400 65                 EPPR1   7
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:36   
        64 000220   000000 701000 xent               TSX1    SET_FIELDS
        64 000221   000000 011000                    NOP     0

      178     5240    3               CALL ERROR(%ZIG_V_RECORD_NAME);

   5240 64 000222   000022 630400 65                 EPPR0   18
        64 000223   000020 631400 65                 EPPR1   16
        64 000224   000000 701000 xent               TSX1    ERROR
        64 000225   000000 011000                    NOP     0

      179     5241        /*E*     ERROR:    ZIG-ZIG_V_RECORD_NAME-C
      180     5242        MESSAGE: The record "%U1" is not present in the schema file.
      181     5243        */
      182     5244    3               RECORD_FOUND = '0'B;

   5244 64 000226   000000 450000 62                 STZ     RECORD_FOUND

      183     5245    3               RETURN;

   5245 64 000227   000000 702200 xent               TSX2  ! X66_ARET

      184     5246    3               END;
      185     5247    2           END;
      186     5248    1       RECORD_FOUND = '1'B;

   5248 64 000230   400000 236003                    LDQ     -131072,DU
        64 000231   000000 756000 62                 STQ     RECORD_FOUND

      187     5249    1       IF TYPE_400.REF_LINE ~= 0

   5249 64 000232   000000 115003                    CMPA    0,DU
        64 000233   000241 600000 64                 TZE     s:5254

      188     5250    2       THEN DO;

      189     5251    2           SN_DBK = UWA.DIRECT_REF;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:37   
   5251 64 000234   000036 235000 52                 LDA     UWA+30
        64 000235   000000 755000 1                  STA     SN_DBK

      190     5252    2           CALL ZIG$ADD_SI;

   5252 64 000236   000001 631400 65                 EPPR1   1
        64 000237   000000 701000 xent               TSX1    ZIG$ADD_SI
        64 000240   000000 011000                    NOP     0

      191     5253    2           END;

      192     5254    1       CALL FETCHNS_6('SN-SE   ') ALTRET (DBCS_ERROR);

   5254 64 000241   000023 630400 65                 EPPR0   19
        64 000242   000020 631400 65                 EPPR1   16
        64 000243   000000 701000 xent               TSX1    FETCHNS_6
        64 000244   001551 702000 64                 TSX2    DBCS_ERROR

      193     5255    1       IF UWA.RC.PSMODE = 5

   5255 64 000245   000271 235000 52                 LDA     UWA+185
        64 000246   000005 115007                    CMPA    5,DL
        64 000247   000263 601000 64                 TNZ     s:5262

      194     5256    2       THEN DO;

      195     5257    2           CALL ZIG$G_DYN_MEM_6(2,RC1$);

   5257 64 000250   000025 630400 65                 EPPR0   21
        64 000251   000002 631400 65                 EPPR1   2
        64 000252   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        64 000253   000000 011000                    NOP     0

      196     5258    2           RC1.CSPSB = UWA.RC.PA_OFFSET;

   5258 64 000254   000303 720000 52                 LXL0    UWA+195
        64 000255   000000 470400 43                 LDP0    RC1$
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:38   
        64 000256   000000 740100                    STX0    0,,PR0

      197     5259    2           RC1.CSPES = UWA.RC.PA_ENTRY;

   5259 64 000257   000304 720000 52                 LXL0    UWA+196
        64 000260   000000 470400 43                 LDP0    RC1$
        64 000261   000000 440100                    SXL0    0,,PR0

      198     5260    2           END;

   5260 64 000262   000276 710000 64                 TRA     s:5265

      199     5261    2       ELSE DO;

      200     5262    2           CALL ZIG$G_DYN_MEM_6(1,TPTR$);

   5262 64 000263   200004 630500                    EPPR0   TPTR$,,AUTO
        64 000264   200023 450500                    STP0    SEARCH_STR+2,,AUTO
        64 000265   000015 236000 65                 LDQ     13
        64 000266   200022 756100                    STQ     SEARCH_STR+1,,AUTO
        64 000267   200022 630500                    EPPR0   SEARCH_STR+1,,AUTO
        64 000270   000002 631400 65                 EPPR1   2
        64 000271   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        64 000272   000000 011000                    NOP     0

      201     5263    2           RC1$ = PINCRW(TPTR$,-1);

   5263 64 000273   200004 236100                    LDQ     TPTR$,,AUTO
        64 000274   777777 036003                    ADLQ    -1,DU
        64 000275   000000 756000 43                 STQ     RC1$

      202     5264    2           END;

      203     5265    1       CALL ZIG$G_DYN_MEM_6(%RC_BASE_SIZE+(L_SUBSCH_RC+3)/4,RC$);

   5265 64 000276   200005 236100                    LDQ     L_SUBSCH_RC,,AUTO
        64 000277   000003 036007                    ADLQ    3,DL
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:39   
        64 000300   000002 772000                    QRL     2
        64 000301   000005 036007                    ADLQ    5,DL
        64 000302   200022 756100                    STQ     SEARCH_STR+1,,AUTO
        64 000303   000027 236000 65                 LDQ     23
        64 000304   200025 756100                    STQ     SEARCH_STR+4,,AUTO
        64 000305   200022 630500                    EPPR0   SEARCH_STR+1,,AUTO
        64 000306   200024 450500                    STP0    SEARCH_STR+3,,AUTO
        64 000307   200024 630500                    EPPR0   SEARCH_STR+3,,AUTO
        64 000310   000002 631400 65                 EPPR1   2
        64 000311   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        64 000312   000000 011000                    NOP     0

      204     5266        /*
      205     5267              RC size = number of words in subschema set name
      206     5268                      + constant (5).
      207     5269        */
      208     5270    1       CURRENT_OFF = POFFW(RC$,SSS$);

   5270 64 000313   000000 235000 39                 LDA     SSS$
        64 000314   000022 771000                    ARL     18
        64 000315   200022 755100                    STA     SEARCH_STR+1,,AUTO
        64 000316   000000 236000 42                 LDQ     RC$
        64 000317   000022 772000                    QRL     18
        64 000320   200022 136100                    SBLQ    SEARCH_STR+1,,AUTO
        64 000321   000000 756000 53                 STQ     CURRENT_OFF

      209     5271    1       STATUS = #IN_ALIAS;

   5271 64 000322   060000 236003                    LDQ     24576,DU
        64 000323   200007 756100                    STQ     STATUS,,AUTO

      210     5272    1       ALLOCATE_END = 1;

   5272 64 000324   000001 235007                    LDA     1,DL
        64 000325   000000 755000 25                 STA     ALLOCATE_END

      211     5273    1       HASH_SCHEMA_NAME = '1'B;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:40   

   5273 64 000326   400000 236003                    LDQ     -131072,DU
        64 000327   000000 756000 16                 STQ     HASH_SCHEMA_NAME

      212     5274    1       CALL ZIG$HASH_IT(TYPE_400.RECORD_NAME,#ADD,ERROR_FLG,4,2,12,

   5274 64 000330   200007 630500                    EPPR0   STATUS,,AUTO
        64 000331   200031 450500                    STP0    SEARCH_STR+8,,AUTO
        64 000332   200004 631500                    EPPR1   TPTR$,,AUTO
        64 000333   200030 451500                    STP1    SEARCH_STR+7,,AUTO
        64 000334   000034 237000 65                 LDAQ    28
        64 000335   200026 757100                    STAQ    SEARCH_STR+5,,AUTO
        64 000336   000036 237000 65                 LDAQ    30
        64 000337   200024 757100                    STAQ    SEARCH_STR+3,,AUTO
        64 000340   000040 237000 65                 LDAQ    32
        64 000341   200022 757100                    STAQ    SEARCH_STR+1,,AUTO
        64 000342   200022 630500                    EPPR0   SEARCH_STR+1,,AUTO
        64 000343   000030 631400 65                 EPPR1   24
        64 000344   000000 701000 xent               TSX1    ZIG$HASH_IT
        64 000345   000000 011000                    NOP     0

      213     5275    1          TPTR$,STATUS);
      214     5276    1       ALLOCATE_END = 0;

   5276 64 000346   000000 450000 25                 STZ     ALLOCATE_END

      215     5277    1       TPTR$ -> RECORD_HASH.REF = TYPE_400.REF_LINE;

   5277 64 000347   200004 470500                    LDP0    TPTR$,,AUTO
        64 000350   000001 235000 22                 LDA     IO_BUF+1
        64 000351   000011 755100                    STA     9,,PR0

      216     5278    1       TPTR$ -> RECORD_HASH.SUB_OFF = CURRENT_OFF;

   5278 64 000352   000000 236000 53                 LDQ     CURRENT_OFF
        64 000353   000012 756100                    STQ     10,,PR0

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:41   
      217     5279    1       TPTR$ -> RECORD_HASH.DBK = UWA.DIRECT_REF;

   5279 64 000354   000036 235000 52                 LDA     UWA+30
        64 000355   000013 755100                    STA     11,,PR0

      218     5280        /*
      219     5281              Initialize the record in the hash table for fast access and
      220     5282            fast finding of that name.
      221     5283              There can be not dups or errors at this point since we had
      222     5284            a successful subschema translation and we have found the RC
      223     5285            record in the schema file.
      224     5286        */
      225     5287        /*
      226     5288              Now initialize the OA record in the schema subset and
      227     5289            connect it up to the OA-RC set.
      228     5290
      229     5291            Note:
      230     5292                 The OA record allways starts a offset of 1 from SSS$
      231     5293               and OA$ always points to the only OA record.
      232     5294        */
      233     5295    1       TPTR$ = PINCRW(SSS$,LAST_RC);

   5295 64 000356   000000 236000 55                 LDQ     LAST_RC
        64 000357   777777 376003                    ANQ     -1,DU
        64 000360   000000 036000 39                 ADLQ    SSS$
        64 000361   200004 756100                    STQ     TPTR$,,AUTO

      234     5296    1       RC.OARCN = TPTR$ -> RC.OARCN;

   5296 64 000362   200004 470500                    LDP0    TPTR$,,AUTO
        64 000363   000002 220100                    LDX0    2,,PR0
        64 000364   000000 471400 42                 LDP1    RC$
        64 000365   100002 740100                    STX0    2,,PR1

      235     5297    1       IF UWA.RC.LSIZE > OA.LRSZ

   5297 64 000366   000000 470400 40                 LDP0    OA$
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:42   
        64 000367   000017 236100                    LDQ     15,,PR0
        64 000370   777777 376007                    ANQ     -1,DL
        64 000371   000306 116000 52                 CMPQ    UWA+198
        64 000372   000375 605000 64                 TPL     s:5299

      236     5298    1       THEN OA.LRSZ = UWA.RC.LSIZE;

   5298 64 000373   000306 721000 52                 LXL1    UWA+198
        64 000374   000017 441100                    SXL1    15,,PR0

      237     5299    1       TPTR$ -> RC.OARCN = CURRENT_OFF;

   5299 64 000375   000000 720000 53                 LXL0    CURRENT_OFF
        64 000376   200004 473500                    LDP3    TPTR$,,AUTO
        64 000377   300002 740100                    STX0    2,,PR3

      238     5300    1       LAST_RC = CURRENT_OFF;

   5300 64 000400   000000 740000 55                 STX0    LAST_RC

      239     5301    1       LAST_FR = LAST_RC;

   5301 64 000401   000000 740000 56                 STX0    LAST_FR

      240     5302    1       LAST_RS_INT = LAST_RC;

   5302 64 000402   200013 740100                    STX0    LAST_RS_INT,,AUTO

      241     5303    1       RC.DEF.TYPE = '001000000000'B;

   5303 64 000403   100000 236003                    LDQ     32768,DU
        64 000404   100000 752160                    STCQ    0,'60'O,PR1

      242     5304    1       RC.DEF.PSTO = UWA.RC.PSMODE;

   5304 64 000405   000000 470400 42                 LDP0    RC$
        64 000406   000271 236000 52                 LDQ     UWA+185
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:43   
        64 000407   000022 736000                    QLS     18
        64 000410   000000 676100                    ERQ     0,,PR0
        64 000411   000007 376003                    ANQ     7,DU
        64 000412   000000 656100                    ERSQ    0,,PR0

      243     5305        /*
      244     5306              Start the record out with being able to erase or store it.
      245     5307            it and if everything isn't there then let the subschema erase and
      246     5308            store it. (all fields and set info there).
      247     5309        */
      248     5310        /*
      249     5311              Record in subschema.
      250     5312        */
      251     5313    1       IF UWA.RC.FIXVAR ~= 0 THEN RC.DEF.FVR = '1'B;

   5313 64 000413   000272 235000 52                 LDA     UWA+186
        64 000414   000420 600000 64                 TZE     s:5314

   5313 64 000415   000000 470400 42                 LDP0    RC$
        64 000416   040000 236007                    LDQ     16384,DL
        64 000417   000000 256100                    ORSQ    0,,PR0

      252     5314    1       IF UWA.RC.KEY_PRESENT ~= 0 THEN RC.DEF.RKEY = '1'B;

   5314 64 000420   000301 235000 52                 LDA     UWA+193
        64 000421   000425 600000 64                 TZE     s:5315

   5314 64 000422   000000 470400 42                 LDP0    RC$
        64 000423   010000 236007                    LDQ     4096,DL
        64 000424   000000 256100                    ORSQ    0,,PR0

      253     5315    1       IF UWA.RC.PSMODE = 5 THEN RC.DEF.CSPAC = '1'B;

   5315 64 000425   000271 235000 52                 LDA     UWA+185
        64 000426   000005 115007                    CMPA    5,DL
        64 000427   000433 601000 64                 TNZ     s:5316

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:44   
   5315 64 000430   000000 470400 42                 LDP0    RC$
        64 000431   001000 236007                    LDQ     512,DL
        64 000432   000000 256100                    ORSQ    0,,PR0

      254     5316    1       RC.DEF.RNL = L_SUBSCH_RC;

   5316 64 000433   000000 470400 42                 LDP0    RC$
        64 000434   200005 236100                    LDQ     L_SUBSCH_RC,,AUTO
        64 000435   000000 752101                    STCQ    0,'01'O,PR0

      255     5317    1       RC.RCID = TYPE_400.ID_NUM * 2;

   5317 64 000436   000023 235000 22                 LDA     IO_BUF+19
        64 000437   000001 735000                    ALS     1
        64 000440   000000 621005                    EAX1    0,AL
        64 000441   000000 470400 42                 LDP0    RC$
        64 000442   000001 441100                    SXL1    1,,PR0

      256     5318    1       RC.RSIZ = UWA.RC.LSIZE;

   5318 64 000443   000306 722000 52                 LXL2    UWA+198
        64 000444   000003 742100                    STX2    3,,PR0

      257     5319    1       RC.RCON = 16;

   5319 64 000445   200000 236007                    LDQ     65536,DL
        64 000446   000003 752104                    STCQ    3,'04'O,PR0

      258     5320    1       RC.RTYP = UWA.RC.RTYPE;

   5320 64 000447   000270 236000 52                 LDQ     UWA+184
        64 000450   000003 752103                    STCQ    3,'03'O,PR0

      259     5321    1       RC.RCWSO = OA.CSZ + %CUR_BASE_SIZE;

   5321 64 000451   000000 471400 40                 LDP1    OA$
        64 000452   100017 222100                    LDX2    15,,PR1
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:45   
        64 000453   001223 623012                    EAX3    659,X2
        64 000454   000004 743100                    STX3    4,,PR0

      260     5322    1       OA.CSZ = OA.CSZ + %CUR_RC;

   5322 64 000455   100017 222100                    LDX2    15,,PR1
        64 000456   000002 624012                    EAX4    2,X2
        64 000457   100017 744100                    STX4    15,,PR1

      261     5323    1       IF RC.DEF.PSTO = 4

   5323 64 000460   000000 236100                    LDQ     0,,PR0
        64 000461   000007 376003                    ANQ     7,DU
        64 000462   000004 116003                    CMPQ    4,DU
        64 000463   000514 601000 64                 TNZ     s:5330

      262     5324    2       THEN DO;

      263     5325    2           CALL FINDNS_6('RC-SOSM ') ALTRET (DBCS_ERROR);

   5325 64 000464   000033 630400 65                 EPPR0   27
        64 000465   000020 631400 65                 EPPR1   16
        64 000466   000000 701000 xent               TSX1    FINDNS_6
        64 000467   001551 702000 64                 TSX2    DBCS_ERROR

      264     5326    2           CALL FETCHOS_6('SC-SOSM ') ALTRET (DBCS_ERROR);

   5326 64 000470   000042 630400 65                 EPPR0   34
        64 000471   000020 631400 65                 EPPR1   16
        64 000472   000000 701000 xent               TSX1    FETCHOS_6
        64 000473   001551 702000 64                 TSX2    DBCS_ERROR

      265     5327    2           OA.CSZ = OA.CSZ + (UWA.SC.KEY_LENGTH +1+2+4+3)/4;

   5327 64 000474   000324 236000 52                 LDQ     UWA+212
        64 000475   000012 036007                    ADLQ    10,DL
        64 000476   000004 506007                    DIV     4,DL
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:46   
        64 000477   000000 470400 40                 LDP0    OA$
        64 000500   200022 756100                    STQ     SEARCH_STR+1,,AUTO
        64 000501   000017 236100                    LDQ     15,,PR0
        64 000502   000022 772000                    QRL     18
        64 000503   200023 756100                    STQ     SEARCH_STR+2,,AUTO
        64 000504   200022 236100                    LDQ     SEARCH_STR+1,,AUTO
        64 000505   200023 036100                    ADLQ    SEARCH_STR+2,,AUTO
        64 000506   000000 620006                    EAX0    0,QL
        64 000507   000017 740100                    STX0    15,,PR0

      266     5328    2           CALL FCURR_R_6('RC  ');

   5328 64 000510   000043 630400 65                 EPPR0   35
        64 000511   000020 631400 65                 EPPR1   16
        64 000512   000000 701000 xent               TSX1    FCURR_R_6
        64 000513   000000 011000                    NOP     0

      267     5329    2           END;

      268     5330    1       RC.RNAM = TYPE_400.SUB_RECORD_NAME;

   5330 64 000514   000000 470400 42                 LDP0    RC$
        64 000515   000000 720100                    LXL0    0,,PR0
        64 000516   000077 360003                    ANX0    63,DU
        64 000517   040140 100400                    MLR     fill='040'O
        64 000520   000013 000036 22                 ADSC9   IO_BUF+11                cn=0,n=30
        64 000521   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0

      269     5331    1       RC1.OTVL = UWA.RC.CV_OFFSET;

   5331 64 000522   000302 721000 52                 LXL1    UWA+194
        64 000523   000000 471400 43                 LDP1    RC1$
        64 000524   100001 441100                    SXL1    1,,PR1

      270     5332    1       IF TYPE_400.REF_LINE ~= 0 AND SUB_LANGUAGE = #COBOL

   5332 64 000525   000001 235000 22                 LDA     IO_BUF+1
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:47   
        64 000526   000560 600000 64                 TZE     s:5361
        64 000527   000000 236000 13                 LDQ     SUB_LANGUAGE
        64 000530   000001 116007                    CMPQ    1,DL
        64 000531   000560 601000 64                 TNZ     s:5361

      271     5333    2       THEN DO;

      272     5334    2           CALL READSF(TYPE_400.REF_LINE,DESC_TYPE_9);

   5334 64 000532   000044 630400 65                 EPPR0   36
        64 000533   000002 631400 65                 EPPR1   2
        64 000534   000000 701000 xent               TSX1    READSF
        64 000535   000000 011000                    NOP     0

      273     5335    2           IF UWA.RC.PSMODE = 1

   5335 64 000536   000271 235000 52                 LDA     UWA+185
        64 000537   000001 115007                    CMPA    1,DL
        64 000540   000550 601000 64                 TNZ     s:5341

      274     5336    3           THEN DO;

      275     5337    3               DESC_TYPE_9.FILLG = '100'B;

   5337 64 000541   000010 236000 19                 LDQ     DESC_TYPE_9+8
        64 000542   000046 376000 65                 ANQ     38
        64 000543   000004 276007                    ORQ     4,DL
        64 000544   000010 756000 19                 STQ     DESC_TYPE_9+8

      276     5338    3               DESC_TYPE_9.F_DBK = '1'B;

   5338 64 000545   000400 236007                    LDQ     256,DL
        64 000546   000010 256000 19                 ORSQ    DESC_TYPE_9+8

      277     5339    3               END;

   5339 64 000547   000554 710000 64                 TRA     s:5344
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:48   

      278     5340    3           ELSE DO;

      279     5341    3               DESC_TYPE_9.FILLG = '000'B;

   5341 64 000550   000046 236000 65                 LDQ     38
        64 000551   000010 356000 19                 ANSQ    DESC_TYPE_9+8

      280     5342    3               DESC_TYPE_9.F_DBK = '0'B;

   5342 64 000552   000047 236000 65                 LDQ     39
        64 000553   000010 356000 19                 ANSQ    DESC_TYPE_9+8

      281     5343    3               END;

      282     5344    2           CALL WRITSF(TYPE_400.REF_LINE,DESC_TYPE_9);

   5344 64 000554   000044 630400 65                 EPPR0   36
        64 000555   000002 631400 65                 EPPR1   2
        64 000556   000000 701000 xent               TSX1    WRITSF
        64 000557   000000 011000                    NOP     0

      283     5345    2           END;

      284     5346        /*
      285     5347              This is where the DATA BASE PROCEDURES things should
      286     5348            go if there is any.
      287     5349        */
      288     5350        /*
      289     5351              Now we do the hard things.
      290     5352            First the record is connected up to the sets that it
      291     5353            belongs to so when we are done with the records we will have
      292     5354            all the SC record that must be in the schema subset all ready
      293     5355            in it so a search of the records to see what sets must be
      294     5356            present will not have to be done.
      295     5357            Then we go throw all the fields that belong to that record
      296     5358            and put them in the altrenate hash table for fast access.
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:49   
      297     5359        */
      298     5360    2       DO WHILE ('1'B);

      299     5361    2           CALL FINDNS_6('RC-SOSM ') ALTRET(DONE_SOSM);

   5361 64 000560   000033 630400 65                 EPPR0   27
        64 000561   000020 631400 65                 EPPR1   16
        64 000562   000000 701000 xent               TSX1    FINDNS_6
        64 000563   001246 702000 64                 TSX2    DONE_SOSM

      300     5362    2           SOSM_DBK = UWA.DIRECT_REF;

   5362 64 000564   000036 235000 52                 LDA     UWA+30
        64 000565   000001 755000 54                 STA     SOSM_DBK

      301     5363    2           IF UWA.RECORD_NAME = 'SO '

   5363 64 000566   040000 106400                    CMPC    fill='040'O
        64 000567   000023 000036 52                 ADSC9   UWA+19                   cn=0,n=30
        64 000570   000014 000003 63                 ADSC9   12                       cn=0,n=3
        64 000571   000574 601000 64                 TNZ     s:5368

      302     5364    3           THEN DO;

      303     5365    3               RC_SM = '0'B;

   5365 64 000572   200010 450100                    STZ     RC_SM,,AUTO

      304     5366    3               END;

   5366 64 000573   000576 710000 64                 TRA     s:5370

      305     5367    3           ELSE DO;

      306     5368    3               RC_SM = '1'B;

   5368 64 000574   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:50   
        64 000575   200010 756100                    STQ     RC_SM,,AUTO

      307     5369    3               END;

      308     5370    2           CALL FINDOS_6('SC-SOSM ') ALTRET(DBCS_ERROR);

   5370 64 000576   000042 630400 65                 EPPR0   34
        64 000577   000020 631400 65                 EPPR1   16
        64 000600   000000 701000 xent               TSX1    FINDOS_6
        64 000601   001551 702000 64                 TSX2    DBCS_ERROR

      309     5371    2           CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERROR);

   5371 64 000602   000023 630400 65                 EPPR0   19
        64 000603   000020 631400 65                 EPPR1   16
        64 000604   000000 701000 xent               TSX1    FETCHOS_6
        64 000605   001551 702000 64                 TSX2    DBCS_ERROR

      310     5372    2           IF UWA.SN.SETYPE = %ZIG_RTYPE_SC

   5372 64 000606   000424 235000 52                 LDA     UWA+276
        64 000607   000036 115007                    CMPA    30,DL
        64 000610   000614 601000 64                 TNZ     s:5374

      311     5373    2           THEN STATUS = #SET_DEF;

   5373 64 000611   020000 236003                    LDQ     8192,DU
        64 000612   200007 756100                    STQ     STATUS,,AUTO
        64 000613   000616 710000 64                 TRA     s:5375

      312     5374    2           ELSE STATUS = #KEY_DEF;

   5374 64 000614   030000 236003                    LDQ     12288,DU
        64 000615   200007 756100                    STQ     STATUS,,AUTO

      313     5375    2           ALLOCATE_END = 1;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:51   
   5375 64 000616   000001 235007                    LDA     1,DL
        64 000617   000000 755000 25                 STA     ALLOCATE_END

      314     5376    2           HASH_SCHEMA_NAME = '1'B;

   5376 64 000620   400000 236003                    LDQ     -131072,DU
        64 000621   000000 756000 16                 STQ     HASH_SCHEMA_NAME

      315     5377    2           CALL ZIG$HASH_IT(UWA.SN.SENAME,#NO_ADD,ERROR_FLG,0,1,14,

   5377 64 000622   200007 630500                    EPPR0   STATUS,,AUTO
        64 000623   200031 450500                    STP0    SEARCH_STR+8,,AUTO
        64 000624   200004 631500                    EPPR1   TPTR$,,AUTO
        64 000625   200030 451500                    STP1    SEARCH_STR+7,,AUTO
        64 000626   000052 237000 65                 LDAQ    42
        64 000627   200026 757100                    STAQ    SEARCH_STR+5,,AUTO
        64 000630   000054 237000 65                 LDAQ    44
        64 000631   200024 757100                    STAQ    SEARCH_STR+3,,AUTO
        64 000632   000056 237000 65                 LDAQ    46
        64 000633   200022 757100                    STAQ    SEARCH_STR+1,,AUTO
        64 000634   200022 630500                    EPPR0   SEARCH_STR+1,,AUTO
        64 000635   000030 631400 65                 EPPR1   24
        64 000636   000000 701000 xent               TSX1    ZIG$HASH_IT
        64 000637   000000 011000                    NOP     0

      316     5378    2              TPTR$,STATUS);
      317     5379    2           ALLOCATE_END = 0;

   5379 64 000640   000000 450000 25                 STZ     ALLOCATE_END

      318     5380    2           IF ERROR_FLG = 0

   5380 64 000641   000000 235000 54                 LDA     ERROR_FLG
        64 000642   000700 601000 64                 TNZ     s:5394

      319     5381    3           THEN DO;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:52   
      320     5382    3               IF SUBSTR(UWA.SN.SENAME,0,1) ~= '*' AND SUBSTR(RC.RNAM,0,1) ~= '*'

   5382 64 000643   000427 236000 52                 LDQ     UWA+279
        64 000644   777000 376003                    ANQ     -512,DU
        64 000645   052000 116003                    CMPQ    21504,DU
        64 000646   000673 600000 64                 TZE     s:5391
        64 000647   000000 470400 42                 LDP0    RC$
        64 000650   000000 720100                    LXL0    0,,PR0
        64 000651   000077 360003                    ANX0    63,DU
        64 000652   000005 236100                    LDQ     5,,PR0
        64 000653   777000 376003                    ANQ     -512,DU
        64 000654   052000 116003                    CMPQ    21504,DU
        64 000655   000673 600000 64                 TZE     s:5391

      321     5383    4               THEN DO;

      322     5384    4                   IF RC_SM

   5384 64 000656   200010 234100                    SZN     RC_SM,,AUTO
        64 000657   000662 605000 64                 TPL     s:5388

      323     5385    5                   THEN DO;

      324     5386    5                       RC.DEF.RERS = '1'B;

   5386 64 000660   400000 236007                    LDQ     -131072,DL
        64 000661   000000 256100                    ORSQ    0,,PR0

      325     5387    5                       END;

      326     5388    4                   IF RC.RNAM ~= '*CALC.RC'

   5388 64 000662   000000 470400 42                 LDP0    RC$
        64 000663   000000 720100                    LXL0    0,,PR0
        64 000664   000077 360003                    ANX0    63,DU
        64 000665   040000 106540                    CMPC    fill='040'O
        64 000666   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:53   
        64 000667   000003 000010 63                 ADSC9   3                        cn=0,n=8
        64 000670   000673 600000 64                 TZE     s:5391

      327     5389    4                   THEN RC.DEF.RSTO = '1'B;

   5389 64 000671   200000 236007                    LDQ     65536,DL
        64 000672   000000 256100                    ORSQ    0,,PR0

      328     5390    4                   END;

      329     5391    3               CALL ADD_SC;

   5391 64 000673   000022 701000 64                 TSX1    ADD_SC
        64 000674   000000 011000                    NOP     0

      330     5392    3               TPTR$ = ADDR(SC1.XXDPN) -> BASED_PTR$;

   5392 64 000675   000000 470400 51                 LDP0    SC1$
        64 000676   000001 236100                    LDQ     1,,PR0
        64 000677   200004 756100                    STQ     TPTR$,,AUTO

      331     5393    3               END;

      332     5394    2           IF RC_SM

   5394 64 000700   200010 234100                    SZN     RC_SM,,AUTO
        64 000701   000736 605000 64                 TPL     s:5405

      333     5395    3           THEN DO I = 0 TO TPTR$ -> SET_HASH.NUM_SM-1;

   5395 64 000702   200003 450100                    STZ     I,,AUTO
        64 000703   000731 710000 64                 TRA     s:5403+3

      334     5396    3               IF TPTR$ -> SET_HASH.SM_LIST.DBK(I) = SOSM_DBK

   5396 64 000704   200004 470500                    LDP0    TPTR$,,AUTO
        64 000705   200003 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:54   
        64 000706   000016 236110                    LDQ     14,X0,PR0
        64 000707   000021 732000                    QRS     17
        64 000710   000726 604000 64                 TMI     s:5403
        64 000711   000001 116000 54                 CMPQ    SOSM_DBK
        64 000712   000726 601000 64                 TNZ     s:5403

      335     5397    4               THEN DO;

      336     5398    4                   T_OFF = TPTR$ -> SET_HASH.SM_LIST.OFFSET(I);

   5398 64 000713   000016 721110                    LXL1    14,X0,PR0
        64 000714   377777 361003                    ANX1    131071,DU
        64 000715   200012 741100                    STX1    T_OFF,,AUTO

      337     5399    4                   TPTR$ -> SET_HASH.SM_LIST.DBK(I) = - TPTR$ ->

   5399 64 000716   000051 676000 65                 ERQ     41
        64 000717   000001 036007                    ADLQ    1,DL
        64 000720   000021 736000                    QLS     17
        64 000721   000016 676110                    ERQ     14,X0,PR0
        64 000722   000060 376000 65                 ANQ     48
        64 000723   000016 656110                    ERSQ    14,X0,PR0

      338     5400    4                      SET_HASH.SM_LIST.DBK(I);
      339     5401    4                   I = 9999;

   5401 64 000724   023417 235007                    LDA     9999,DL
        64 000725   200003 755100                    STA     I,,AUTO

      340     5402    4                   END;

      341     5403    3               END;

   5403 64 000726   200003 235100                    LDA     I,,AUTO
        64 000727   000001 035007                    ADLA    1,DL
        64 000730   200003 755100                    STA     I,,AUTO
        64 000731   200004 470500                    LDP0    TPTR$,,AUTO
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:55   
        64 000732   200003 236100                    LDQ     I,,AUTO
        64 000733   000015 116100                    CMPQ    13,,PR0
        64 000734   000704 602000 64                 TNC     s:5396
        64 000735   000761 710000 64                 TRA     s:5413

      342     5404    3           ELSE DO;

      343     5405    3               IF TPTR$ -> SET_HASH.SO.DBK = SOSM_DBK

   5405 64 000736   200004 470500                    LDP0    TPTR$,,AUTO
        64 000737   000014 236100                    LDQ     12,,PR0
        64 000740   000021 732000                    QRS     17
        64 000741   000760 604000 64                 TMI     s:5411
        64 000742   000001 116000 54                 CMPQ    SOSM_DBK
        64 000743   000760 601000 64                 TNZ     s:5411

      344     5406    4               THEN DO;

      345     5407    4                   T_OFF = TPTR$ -> SET_HASH.SO.OFFSET;

   5407 64 000744   000014 720100                    LXL0    12,,PR0
        64 000745   377777 360003                    ANX0    131071,DU
        64 000746   200012 740100                    STX0    T_OFF,,AUTO

      346     5408    4                   TPTR$ -> SET_HASH.SO.DBK = - TPTR$ -> SET_HASH.SO.DBK;

   5408 64 000747   000051 676000 65                 ERQ     41
        64 000750   000001 036007                    ADLQ    1,DL
        64 000751   000021 736000                    QLS     17
        64 000752   000014 676100                    ERQ     12,,PR0
        64 000753   000060 376000 65                 ANQ     48
        64 000754   000014 656100                    ERSQ    12,,PR0

      347     5409    4                   I = 10000;

   5409 64 000755   023420 235007                    LDA     10000,DL
        64 000756   200003 755100                    STA     I,,AUTO
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:56   

      348     5410    4                   END;

   5410 64 000757   000761 710000 64                 TRA     s:5413

      349     5411    3               ELSE I = 0;

   5411 64 000760   200003 450100                    STZ     I,,AUTO

      350     5412    3               END;

      351     5413    2           IF I < 9999

   5413 64 000761   200003 235100                    LDA     I,,AUTO
        64 000762   023417 115007                    CMPA    9999,DL
        64 000763   001003 603000 64                 TRC     s:5425

      352     5414    3           THEN DO;

      353     5415    3               CALL SET_FIELDS(1,30,TYPE_400.RECORD_NAME);

   5415 64 000764   000015 630400 65                 EPPR0   13
        64 000765   000007 631400 65                 EPPR1   7
        64 000766   000000 701000 xent               TSX1    SET_FIELDS
        64 000767   000000 011000                    NOP     0

      354     5416    3               CALL SET_FIELDS(2,30,UWA.SN.SENAME);

   5416 64 000770   000061 630400 65                 EPPR0   49
        64 000771   000007 631400 65                 EPPR1   7
        64 000772   000000 701000 xent               TSX1    SET_FIELDS
        64 000773   000000 011000                    NOP     0

      355     5417    3               CALL ERROR(%ZIG_NO_CF_REC);

   5417 64 000774   000065 630400 65                 EPPR0   53
        64 000775   000020 631400 65                 EPPR1   16
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:57   
        64 000776   000000 701000 xent               TSX1    ERROR
        64 000777   000000 011000                    NOP     0

      356     5418    3               CALL ABORT;

   5418 64 001000   000001 631400 65                 EPPR1   1
        64 001001   000000 701000 xent               TSX1    ABORT
        64 001002   000000 011000                    NOP     0

      357     5419        /*E*     ERROR:    ZIG-ZIG_NO_CF_REC-C
      358     5420        MESSAGE: For the record "%U1" no SM record was found for
      359     5421                 the set "%U2".
      360     5422                 <<<< SOFTWARE ERROR >>>>
      361     5423        */
      362     5424    3               END;

      363     5425    2           TPTR$ = PINCRW(SSS$,T_OFF);

   5425 64 001003   200012 236100                    LDQ     T_OFF,,AUTO
        64 001004   777777 376003                    ANQ     -1,DU
        64 001005   000000 036000 39                 ADLQ    SSS$
        64 001006   200004 756100                    STQ     TPTR$,,AUTO

      364     5426    2           IF TPTR$ -> RS.DEF.VIA

   5426 64 001007   200004 470500                    LDP0    TPTR$,,AUTO
        64 001010   000000 236100                    LDQ     0,,PR0
        64 001011   000040 316003                    CANQ    32,DU
        64 001012   001027 600000 64                 TZE     s:5434

      365     5427    3           THEN DO;

      366     5428    3               TPTR$ -> RS.RCRSN = RC.RCRSN;

   5428 64 001013   000000 471400 42                 LDP1    RC$
        64 001014   100002 720100                    LXL0    2,,PR1
        64 001015   000002 440100                    SXL0    2,,PR0
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:58   

      367     5429    3               TPTR$ -> RS.RCRSH = LAST_RC;

   5429 64 001016   000000 220000 55                 LDX0    LAST_RC
        64 001017   200004 470500                    LDP0    TPTR$,,AUTO
        64 001020   000003 740100                    STX0    3,,PR0

      368     5430    3               RC.RCRSN = T_OFF;

   5430 64 001021   200012 221100                    LDX1    T_OFF,,AUTO
        64 001022   100002 441100                    SXL1    2,,PR1

      369     5431    3               IF LAST_RC = LAST_RS_INT THEN LAST_RS_INT = T_OFF;

   5431 64 001023   200013 100100                    CMPX0   LAST_RS_INT,,AUTO
        64 001024   001044 601000 64                 TNZ     s:5440

   5431 64 001025   200013 741100                    STX1    LAST_RS_INT,,AUTO

      370     5432    3               END;

   5432 64 001026   001044 710000 64                 TRA     s:5440

      371     5433    3           ELSE DO;

      372     5434    3               T1PTR$ = PINCRW(SSS$,LAST_RS_INT);

   5434 64 001027   200013 236100                    LDQ     LAST_RS_INT,,AUTO
        64 001030   777777 376003                    ANQ     -1,DU
        64 001031   000000 036000 39                 ADLQ    SSS$
        64 001032   200011 756100                    STQ     T1PTR$,,AUTO

      373     5435    3               TPTR$ -> RS.RCRSN = T1PTR$ -> RS.RCRSN;

   5435 64 001033   200011 471500                    LDP1    T1PTR$,,AUTO
        64 001034   100002 720100                    LXL0    2,,PR1
        64 001035   000002 440100                    SXL0    2,,PR0
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:59   

      374     5436    3               TPTR$ -> RS.RCRSH = LAST_RC;

   5436 64 001036   000000 220000 55                 LDX0    LAST_RC
        64 001037   200004 470500                    LDP0    TPTR$,,AUTO
        64 001040   000003 740100                    STX0    3,,PR0

      375     5437    3               T1PTR$ -> RS.RCRSN = T_OFF;

   5437 64 001041   200012 221100                    LDX1    T_OFF,,AUTO
        64 001042   100002 441100                    SXL1    2,,PR1

      376     5438    3               LAST_RS_INT = T_OFF;

   5438 64 001043   200013 741100                    STX1    LAST_RS_INT,,AUTO

      377     5439    3               END;

      378     5440    2           TYPE_33.NUM_CON_FIELDS = 0;

   5440 64 001044   000025 450000 21                 STZ     TYPE_33+21

      379     5441    2           T1PTR$ = PINCRW(SSS$, TPTR$ -> RS.RSSSN);

   5441 64 001045   200004 470500                    LDP0    TPTR$,,AUTO
        64 001046   000001 722100                    LXL2    1,,PR0
        64 001047   000000 636012                    EAQ     0,X2
        64 001050   000000 036000 39                 ADLQ    SSS$
        64 001051   200011 756100                    STQ     T1PTR$,,AUTO

      380     5442    3           DO WHILE (T1PTR$ ~= SSS$);

   5442 64 001052   000000 116000 39                 CMPQ    SSS$
        64 001053   001066 600000 64                 TZE     s:5446

      381     5443    3               TYPE_33.NUM_CON_FIELDS = TYPE_33.NUM_CON_FIELDS + 1;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:60   
   5443 64 001054   000025 235000 21                 LDA     TYPE_33+21
        64 001055   000001 035007                    ADLA    1,DL
        64 001056   000025 755000 21                 STA     TYPE_33+21

      382     5444    3               T1PTR$ = PINCRW(SSS$, T1PTR$ -> RS.RSSSN);

   5444 64 001057   200011 470500                    LDP0    T1PTR$,,AUTO
        64 001060   000001 720100                    LXL0    1,,PR0
        64 001061   000000 636010                    EAQ     0,X0
        64 001062   000000 036000 39                 ADLQ    SSS$
        64 001063   200011 756100                    STQ     T1PTR$,,AUTO

      383     5445    3               END;

   5445 64 001064   000000 116000 39                 CMPQ    SSS$
        64 001065   001054 601000 64                 TNZ     s:5443

      384     5446    2           TYPE_32.NUM_CON_FIELDS = TYPE_33.NUM_CON_FIELDS;

   5446 64 001066   000025 235000 21                 LDA     TYPE_33+21
        64 001067   000026 755000 20                 STA     TYPE_32+22

      385     5447        /*
      386     5448            Now, write out the type 32 and 33 descriptors in the ext. name
      387     5449            segment in the subschema file for each record set relationship
      388     5450            which is in the subschema.
      389     5451        */
      390     5452    2           SC$ = PINCRW(SSS$,TPTR$ -> RS.SCRSH);

   5452 64 001070   200004 470500                    LDP0    TPTR$,,AUTO
        64 001071   000003 720100                    LXL0    3,,PR0
        64 001072   000000 636010                    EAQ     0,X0
        64 001073   000000 036000 39                 ADLQ    SSS$
        64 001074   000000 756000 50                 STQ     SC$

      391     5453    2           IF SC.SNAM ~= '*CALC' AND TYPE_400.REF_LINE ~= 0

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:61   
   5453 64 001075   000000 471400 50                 LDP1    SC$
        64 001076   100000 721100                    LXL1    0,,PR1
        64 001077   000077 361003                    ANX1    63,DU
        64 001100   040000 106540                    CMPC    fill='040'O
        64 001101   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        64 001102   000003 000005 63                 ADSC9   3                        cn=0,n=5
        64 001103   000560 600000 64                 TZE     s:5361
        64 001104   000001 235000 22                 LDA     IO_BUF+1
        64 001105   000560 600000 64                 TZE     s:5361
        64 001106   100000 236100                    LDQ     0,,PR1
        64 001107   004000 316007                    CANQ    2048,DL
        64 001110   000560 601000 64                 TNZ     s:5361

      392     5454    2              AND NOT SC.DEF.SRCR
      393     5455    3           THEN DO;

      394     5456    3               IF SC.DEF.SETT = 2 OR SC.DEF.SETT = 3

   5456 64 001111   100000 236100                    LDQ     0,,PR1
        64 001112   000700 376007                    ANQ     448,DL
        64 001113   000200 116007                    CMPQ    128,DL
        64 001114   001117 600000 64                 TZE     s:5458
        64 001115   000300 116007                    CMPQ    192,DL
        64 001116   001157 601000 64                 TNZ     s:5468

      395     5457    4               THEN DO;

      396     5458    4                   TYPE_33.RECORD_NAME = RC.RCID / 2;

   5458 64 001117   000000 473400 42                 LDP3    RC$
        64 001120   300001 236100                    LDQ     1,,PR3
        64 001121   777777 376007                    ANQ     -1,DL
        64 001122   000001 772000                    QRL     1
        64 001123   000001 756000 21                 STQ     TYPE_33+1

      397     5459    4                   TYPE_33.SUB_RECORD_NM = RC.RNAM;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:62   
   5459 64 001124   300000 721100                    LXL1    0,,PR3
        64 001125   000077 361003                    ANX1    63,DU
        64 001126   040000 100540                    MLR     fill='040'O
        64 001127   300005 000011                    ADSC9   5,,PR3                   cn=0,n=*X1
        64 001130   000005 000040 21                 ADSC9   TYPE_33+5                cn=0,n=32

      398     5460    4                   TYPE_33.KEY_NAME = SC.SCID;

   5460 64 001131   100002 236100                    LDQ     2,,PR1
        64 001132   777777 376007                    ANQ     -1,DL
        64 001133   000002 756000 21                 STQ     TYPE_33+2

      399     5461    4                   TYPE_33.SUB_KEY_NM = SC.SNAM;

   5461 64 001134   100000 720100                    LXL0    0,,PR1
        64 001135   000077 360003                    ANX0    63,DU
        64 001136   040000 100540                    MLR     fill='040'O
        64 001137   100003 000010                    ADSC9   3,,PR1                   cn=0,n=*X0
        64 001140   000015 000040 21                 ADSC9   TYPE_33+13               cn=0,n=32

      400     5462    4                   IF SC.DEF.SETT = 2 /* PRIMARY */

   5462 64 001141   100000 236100                    LDQ     0,,PR1
        64 001142   000700 376007                    ANQ     448,DL
        64 001143   000200 116007                    CMPQ    128,DL
        64 001144   001150 601000 64                 TNZ     s:5464

      401     5463    4                   THEN TYPE_33.PRIM_OR_SEC = '1'B;

   5463 64 001145   400000 236003                    LDQ     -131072,DU
        64 001146   000026 256000 21                 ORSQ    TYPE_33+22
        64 001147   001152 710000 64                 TRA     s:5465

      402     5464    4                   ELSE TYPE_33.PRIM_OR_SEC = '0'B;

   5464 64 001150   000066 236000 65                 LDQ     54
        64 001151   000026 356000 21                 ANSQ    TYPE_33+22
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:63   

      403     5465    4                   CALL WRITSF(CUR_EXT_NAME_SEG,TYPE_33);

   5465 64 001152   000067 630400 65                 EPPR0   55
        64 001153   000002 631400 65                 EPPR1   2
        64 001154   000000 701000 xent               TSX1    WRITSF
        64 001155   000000 011000                    NOP     0

      404     5466    4                   END;

   5466 64 001156   001237 710000 64                 TRA     s:5479

      405     5467    4               ELSE DO;

      406     5468    4                   TYPE_32.RECORD_NAME = RC.RCID / 2;

   5468 64 001157   000000 473400 42                 LDP3    RC$
        64 001160   300001 236100                    LDQ     1,,PR3
        64 001161   777777 376007                    ANQ     -1,DL
        64 001162   000001 772000                    QRL     1
        64 001163   000001 756000 20                 STQ     TYPE_32+1

      407     5469    4                   TYPE_32.SUB_RECORD_NM = RC.RNAM;

   5469 64 001164   300000 721100                    LXL1    0,,PR3
        64 001165   000077 361003                    ANX1    63,DU
        64 001166   040000 100540                    MLR     fill='040'O
        64 001167   300005 000011                    ADSC9   5,,PR3                   cn=0,n=*X1
        64 001170   000005 000040 20                 ADSC9   TYPE_32+5                cn=0,n=32

      408     5470    4                   TYPE_32.SET_NAME = SC.SCID;

   5470 64 001171   100002 236100                    LDQ     2,,PR1
        64 001172   777777 376007                    ANQ     -1,DL
        64 001173   000002 756000 20                 STQ     TYPE_32+2

      409     5471    4                   TYPE_32.SUB_SET_NM = SC.SNAM;
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:64   

   5471 64 001174   100000 720100                    LXL0    0,,PR1
        64 001175   000077 360003                    ANX0    63,DU
        64 001176   040000 100540                    MLR     fill='040'O
        64 001177   100003 000010                    ADSC9   3,,PR1                   cn=0,n=*X0
        64 001200   000015 000040 20                 ADSC9   TYPE_32+13               cn=0,n=32

      410     5472    4                   TYPE_32.OWNER = ~RC_SM;

   5472 64 001201   200010 236100                    LDQ     RC_SM,,AUTO
        64 001202   400000 376003                    ANQ     -131072,DU
        64 001203   400000 676003                    ERQ     -131072,DU
        64 001204   000004 676000 20                 ERQ     TYPE_32+4
        64 001205   400000 376003                    ANQ     -131072,DU
        64 001206   000004 656000 20                 ERSQ    TYPE_32+4

      411     5473    4                   TYPE_32.MEMBER = RC_SM;

   5473 64 001207   200010 236100                    LDQ     RC_SM,,AUTO
        64 001210   000001 772000                    QRL     1
        64 001211   000004 676000 20                 ERQ     TYPE_32+4
        64 001212   200000 376003                    ANQ     65536,DU
        64 001213   000004 656000 20                 ERSQ    TYPE_32+4

      412     5474    4                   TYPE_32.OPTIONAL_MEM = TPTR$ -> RS.DEF.OSM;

   5474 64 001214   000000 236100                    LDQ     0,,PR0
        64 001215   000022 736000                    QLS     18
        64 001216   000004 676000 20                 ERQ     TYPE_32+4
        64 001217   100000 376003                    ANQ     32768,DU
        64 001220   000004 656000 20                 ERSQ    TYPE_32+4

      413     5475    4                   TYPE_32.MANUAL_MEM = TPTR$ -> RS.DEF.MSM;

   5475 64 001221   000000 236100                    LDQ     0,,PR0
        64 001222   000022 736000                    QLS     18
        64 001223   000004 676000 20                 ERQ     TYPE_32+4
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:65   
        64 001224   040000 376003                    ANQ     16384,DU
        64 001225   000004 656000 20                 ERSQ    TYPE_32+4

      414     5476    4                   TYPE_32.MODIFY_NOT = TPTR$ -> RS.DEF.SMOD;

   5476 64 001226   000000 236100                    LDQ     0,,PR0
        64 001227   000022 736000                    QLS     18
        64 001230   000004 676000 20                 ERQ     TYPE_32+4
        64 001231   020000 376003                    ANQ     8192,DU
        64 001232   000004 656000 20                 ERSQ    TYPE_32+4

      415     5477    4                   CALL WRITSF(CUR_EXT_NAME_SEG,TYPE_32);

   5477 64 001233   000071 630400 65                 EPPR0   57
        64 001234   000002 631400 65                 EPPR1   2
        64 001235   000000 701000 xent               TSX1    WRITSF
        64 001236   000000 011000                    NOP     0

      416     5478    4                   END;

      417     5479    3               CONTROL.NUM_REC_SET_REL = CONTROL.NUM_REC_SET_REL + 1;

   5479 64 001237   000014 235000 18                 LDA     CONTROL+12
        64 001240   000001 035007                    ADLA    1,DL
        64 001241   000014 755000 18                 STA     CONTROL+12

      418     5480    3               CUR_EXT_NAME_SEG = CUR_EXT_NAME_SEG + 1;

   5480 64 001242   000000 236000 0                  LDQ     CUR_EXT_NAME_SEG
        64 001243   000001 036007                    ADLQ    1,DL
        64 001244   000000 756000 0                  STQ     CUR_EXT_NAME_SEG

      419     5481    3               END;

      420     5482    2           END;

   5482 64 001245   000560 710000 64                 TRA     s:5361
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:66   

      421     5483    1   DONE_SOSM:
      422     5484    1       IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;

   5484 64 001246   040000 106400       DONE_SOSM    CMPC    fill='040'O
        64 001247   000001 000007 52                 ADSC9   UWA+1                    cn=0,n=7
        64 001250   000015 000007 63                 ADSC9   13                       cn=0,n=7
        64 001251   001255 600000 64                 TZE     s:5485

   5484 64 001252   000001 631400 65                 EPPR1   1
        64 001253   000000 701000 xent               TSX1    ABORT
        64 001254   000000 011000                    NOP     0

      423     5485    2       DO WHILE (RC.RNAM ~= '*CALC.RC' AND RC.RNAM ~= '*DBPARAM');

   5485 64 001255   001535 710000 64                 TRA     s:5580

      424     5486    2           CALL FETCHNS_6('RC-FR   ') ALTRET(DONE_FR);

   5486 64 001256   000073 630400 65                 EPPR0   59
        64 001257   000020 631400 65                 EPPR1   16
        64 001260   000000 701000 xent               TSX1    FETCHNS_6
        64 001261   001550 702000 64                 TSX2    DONE_FR

      425     5487    2           SAVE_DBK = UWA.DIRECT_REF;

   5487 64 001262   000036 235000 52                 LDA     UWA+30
        64 001263   000002 755000 54                 STA     SAVE_DBK

      426     5488    2           IF UWA.FR.SYN = 1 OR

   5488 64 001264   000332 236000 52                 LDQ     UWA+218
        64 001265   000001 116007                    CMPQ    1,DL
        64 001266   001274 600000 64                 TZE     s:5498
        64 001267   000344 235000 52                 LDA     UWA+228
        64 001270   000001 115007                    CMPA    1,DL
        64 001271   001274 600000 64                 TZE     s:5498
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:67   
        64 001272   000345 235000 52                 LDA     UWA+229
        64 001273   001477 604400 64                 TMOZ    s:5570

      427     5489    2              UWA.FR.RPT = 1 OR UWA.FR.F_OCCURS > 0
      428     5490    3           THEN DO;

      429     5491        /*
      430     5492              This is a control field of some kind so it must be
      431     5493            connected to the record and a FR record build for this
      432     5494            field because the record is pressent in the subschema.
      433     5495              SYN FR records are not connected up in a set in the
      434     5496            RCFRN set.
      435     5497        */
      436     5498    3               CALL ZIG$G_DYN_MEM_6(1, FR1$);

   5498 64 001274   000074 630400 65                 EPPR0   60
        64 001275   000002 631400 65                 EPPR1   2
        64 001276   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        64 001277   000000 011000                    NOP     0

      437     5499    3               CALL ZIG$G_DYN_MEM_6(6, FR$);

   5499 64 001300   000077 630400 65                 EPPR0   63
        64 001301   000002 631400 65                 EPPR1   2
        64 001302   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        64 001303   000000 011000                    NOP     0

      438     5500    3               FR1.NLIND = SAVE_DBK;

   5500 64 001304   000002 720000 54                 LXL0    SAVE_DBK
        64 001305   000000 470400 48                 LDP0    FR1$
        64 001306   000000 440100                    SXL0    0,,PR0

      439     5501    3               FR.DEF.TYPE = '000000010000'B;

   5501 64 001307   000000 470400 47                 LDP0    FR$
        64 001310   002000 236003                    LDQ     1024,DU
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:68   
        64 001311   000000 752160                    STCQ    0,'60'O,PR0

      440     5502    3               IF UWA.FR.SYN = 1

   5502 64 001312   000332 235000 52                 LDA     UWA+218
        64 001313   000001 115007                    CMPA    1,DL
        64 001314   001320 601000 64                 TNZ     s:5504

      441     5503    3               THEN FR.DEF.SYN = '1'B;

   5503 64 001315   000000 470400 47                 LDP0    FR$
        64 001316   004000 236007                    LDQ     2048,DL
        64 001317   000000 256100                    ORSQ    0,,PR0

      442     5504    3               CURRENT_OFF = POFFW(FR$,SSS$);

   5504 64 001320   000000 235000 39                 LDA     SSS$
        64 001321   000022 771000                    ARL     18
        64 001322   200022 755100                    STA     SEARCH_STR+1,,AUTO
        64 001323   000000 236000 47                 LDQ     FR$
        64 001324   000022 772000                    QRL     18
        64 001325   200022 136100                    SBLQ    SEARCH_STR+1,,AUTO
        64 001326   000000 756000 53                 STQ     CURRENT_OFF

      443     5505    3               FR.RCFRH = LAST_RC;

   5505 64 001327   000000 221000 55                 LDX1    LAST_RC
        64 001330   000000 470400 47                 LDP0    FR$
        64 001331   000005 741100                    STX1    5,,PR0

      444     5506    3               TPTR$ = PINCRW(SSS$,LAST_FR);

   5506 64 001332   000000 236000 56                 LDQ     LAST_FR
        64 001333   777777 376003                    ANQ     -1,DU
        64 001334   000000 036000 39                 ADLQ    SSS$
        64 001335   200004 756100                    STQ     TPTR$,,AUTO

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:69   
      445     5507    3               FR.RCFRN = TPTR$ -> FR.RCFRN;

   5507 64 001336   200004 471500                    LDP1    TPTR$,,AUTO
        64 001337   100004 722100                    LXL2    4,,PR1
        64 001340   000004 442100                    SXL2    4,,PR0

      446     5508    3               TPTR$ -> FR.RCFRN = CURRENT_OFF;

   5508 64 001341   000000 723000 53                 LXL3    CURRENT_OFF
        64 001342   200004 471500                    LDP1    TPTR$,,AUTO
        64 001343   100004 443100                    SXL3    4,,PR1

      447     5509    3               LAST_FR = CURRENT_OFF;

   5509 64 001344   000000 743000 56                 STX3    LAST_FR

      448     5510    3               FR.DEF.FUSE = UWA.FR.F_USE;

   5510 64 001345   000343 236000 52                 LDQ     UWA+227
        64 001346   000010 736000                    QLS     8
        64 001347   000000 676100                    ERQ     0,,PR0
        64 001350   003400 376007                    ANQ     1792,DL
        64 001351   000000 656100                    ERSQ    0,,PR0

      449     5511    3               ADDR(FR.UOFST) -> WORD36 = UWA.FR.FR_FRH;

   5511 64 001352   000000 470400 47                 LDP0    FR$
        64 001353   000352 236000 52                 LDQ     UWA+234
        64 001354   000002 756100                    STQ     2,,PR0

      450     5512    3               ADDR(FR.ROFST) -> WORD36 = UWA.FR.BUFFLOC;

   5512 64 001355   000351 235000 52                 LDA     UWA+233
        64 001356   000001 755100                    STA     1,,PR0

      451     5513        /*
      452     5514              FR.UOFST - the DBK of the FR record related to this control
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:70   
      453     5515                           field.
      454     5516              FR.ROFST - the DBK of this FR record in the schema file.
      455     5517        */
      456     5518    4               DO WHILE ('1'B);

      457     5519    4                   CALL FINDNS_6('FR-CFS   ') ALTRET(END_CFS);

   5519 64 001357   000101 630400 65                 EPPR0   65
        64 001360   000020 631400 65                 EPPR1   16
        64 001361   000000 701000 xent               TSX1    FINDNS_6
        64 001362   001421 702000 64                 TSX2    END_CFS

      458     5520    4                   SAVE_CF_DBK = UWA.DIRECT_REF;

   5520 64 001363   000036 235000 52                 LDA     UWA+30
        64 001364   000003 755000 54                 STA     SAVE_CF_DBK

      459     5521        /*
      460     5522              Now search the hash table for the DBK that is in that CF record
      461     5523            so we can find the offset in the schema subset.
      462     5524        */
      463     5525    4                   CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);

   5525 64 001365   000036 236000 65                 LDQ     30
        64 001366   200020 756100                    STQ     @DBK+1,,AUTO
        64 001367   000102 236000 65                 LDQ     66
        64 001370   200017 756100                    STQ     CF_TPTR$+3,,AUTO
        64 001371   000064 701000 64                 TSX1    FIND_CF
        64 001372   000000 011000                    NOP     0

      464     5526    4                   IF ERROR_FLG = 0

   5526 64 001373   000000 235000 54                 LDA     ERROR_FLG
        64 001374   001404 601000 64                 TNZ     s:5536

      465     5527    5                   THEN DO;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:71   
      466     5528    5                       CALL ERROR(%ZIG_NO_CF_FR);

   5528 64 001375   000104 630400 65                 EPPR0   68
        64 001376   000020 631400 65                 EPPR1   16
        64 001377   000000 701000 xent               TSX1    ERROR
        64 001400   000000 011000                    NOP     0

      467     5529        /*       ERROR:    ZIG-ZIG_NO_CF_FR-C
      468     5530        MESSAGE: This CF record is not already in the schema subset from
      469     5531                 the set information.
      470     5532                 <<<< SOFTWARE ERROR >>>>
      471     5533        */
      472     5534    5                       CALL ABORT;

   5534 64 001401   000001 631400 65                 EPPR1   1
        64 001402   000000 701000 xent               TSX1    ABORT
        64 001403   000000 011000                    NOP     0

      473     5535    5                       END;

      474     5536    4                   T1PTR$ = PINCRW(SSS$,CURRENT_CF);

   5536 64 001404   000000 236000 58                 LDQ     CURRENT_CF
        64 001405   777777 376003                    ANQ     -1,DU
        64 001406   000000 036000 39                 ADLQ    SSS$
        64 001407   200011 756100                    STQ     T1PTR$,,AUTO

      475     5537    4                   T1PTR$ -> CD.CDSH = LAST_FR;

   5537 64 001410   000000 220000 56                 LDX0    LAST_FR
        64 001411   200011 470500                    LDP0    T1PTR$,,AUTO
        64 001412   000002 740100                    STX0    2,,PR0

      476     5538    4                   T1PTR$ -> CD.CDSN = FR.CDSN;

   5538 64 001413   000000 471400 47                 LDP1    FR$
        64 001414   100003 221100                    LDX1    3,,PR1
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:72   
        64 001415   000003 741100                    STX1    3,,PR0

      477     5539    4                   FR.CDSN = CURRENT_CF;

   5539 64 001416   000000 222000 58                 LDX2    CURRENT_CF
        64 001417   100003 742100                    STX2    3,,PR1

      478     5540    4                   END;

   5540 64 001420   001357 710000 64                 TRA     s:5519

      479     5541    3   END_CFS:
      480     5542    3               CALL FCURR_R_6('FR  ');

   5542 64 001421   000105 630400 65    END_CFS      EPPR0   69
        64 001422   000020 631400 65                 EPPR1   16
        64 001423   000000 701000 xent               TSX1    FCURR_R_6
        64 001424   000000 011000                    NOP     0

      481     5543    4               DO WHILE ('1'B);

      482     5544    4                   CALL FINDNS_6('FR-CFR   ') ALTRET(END_CFR);

   5544 64 001425   000106 630400 65                 EPPR0   70
        64 001426   000020 631400 65                 EPPR1   16
        64 001427   000000 701000 xent               TSX1    FINDNS_6
        64 001430   001467 702000 64                 TSX2    END_CFR

      483     5545    4                   SAVE_CF_DBK = UWA.DIRECT_REF;

   5545 64 001431   000036 235000 52                 LDA     UWA+30
        64 001432   000003 755000 54                 STA     SAVE_CF_DBK

      484     5546        /*
      485     5547              Now search the hash table for the DBK that is in that CF record
      486     5548            so we can find the offset in the schema subset.
      487     5549        */
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:73   
      488     5550    4                   CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);

   5550 64 001433   000036 236000 65                 LDQ     30
        64 001434   200020 756100                    STQ     @DBK+1,,AUTO
        64 001435   000102 236000 65                 LDQ     66
        64 001436   200017 756100                    STQ     CF_TPTR$+3,,AUTO
        64 001437   000064 701000 64                 TSX1    FIND_CF
        64 001440   000000 011000                    NOP     0

      489     5551    4                   IF ERROR_FLG = 0

   5551 64 001441   000000 235000 54                 LDA     ERROR_FLG
        64 001442   001452 601000 64                 TNZ     s:5561

      490     5552    5                   THEN DO;

      491     5553    5                       CALL ERROR(%ZIG_NO_CF_FR);

   5553 64 001443   000104 630400 65                 EPPR0   68
        64 001444   000020 631400 65                 EPPR1   16
        64 001445   000000 701000 xent               TSX1    ERROR
        64 001446   000000 011000                    NOP     0

      492     5554        /*       ERROR:    ZIG-ZIG_NO_CF_FR-C
      493     5555        MESSAGE: This CF record is not already in the schema subset from
      494     5556                 the set information.
      495     5557                 <<<< SOFTWARE ERROR >>>>
      496     5558        */
      497     5559    5                       CALL ABORT;

   5559 64 001447   000001 631400 65                 EPPR1   1
        64 001450   000000 701000 xent               TSX1    ABORT
        64 001451   000000 011000                    NOP     0

      498     5560    5                       END;

      499     5561    4                   T1PTR$ = PINCRW(SSS$,CURRENT_CF);
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:74   

   5561 64 001452   000000 236000 58                 LDQ     CURRENT_CF
        64 001453   777777 376003                    ANQ     -1,DU
        64 001454   000000 036000 39                 ADLQ    SSS$
        64 001455   200011 756100                    STQ     T1PTR$,,AUTO

      500     5562    4                   T1PTR$ -> CD.CDRH = LAST_FR;

   5562 64 001456   000000 220000 56                 LDX0    LAST_FR
        64 001457   200011 470500                    LDP0    T1PTR$,,AUTO
        64 001460   000002 440100                    SXL0    2,,PR0

      501     5563    4                   T1PTR$ -> CD.CDRN = FR.CDRN;

   5563 64 001461   000000 471400 47                 LDP1    FR$
        64 001462   100003 721100                    LXL1    3,,PR1
        64 001463   000003 441100                    SXL1    3,,PR0

      502     5564    4                   FR.CDRN = CURRENT_CF;

   5564 64 001464   000000 222000 58                 LDX2    CURRENT_CF
        64 001465   100003 442100                    SXL2    3,,PR1

      503     5565    4                   END;

   5565 64 001466   001425 710000 64                 TRA     s:5544

      504     5566    3   END_CFR:
      505     5567    3               IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;

   5567 64 001467   040000 106400       END_CFR      CMPC    fill='040'O
        64 001470   000001 000007 52                 ADSC9   UWA+1                    cn=0,n=7
        64 001471   000015 000007 63                 ADSC9   13                       cn=0,n=7
        64 001472   001535 600000 64                 TZE     s:5580

   5567 64 001473   000001 631400 65                 EPPR1   1
        64 001474   000000 701000 xent               TSX1    ABORT
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:75   
        64 001475   000000 011000                    NOP     0

      506     5568    3               END;

   5568 64 001476   001535 710000 64                 TRA     s:5580

      507     5569    3           ELSE DO;

      508     5570    3               CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERROR);

   5570 64 001477   000023 630400 65                 EPPR0   19
        64 001500   000020 631400 65                 EPPR1   16
        64 001501   000000 701000 xent               TSX1    FETCHOS_6
        64 001502   001551 702000 64                 TSX2    DBCS_ERROR

      509     5571    3               ALLOCATE_END = 2;

   5571 64 001503   000002 235007                    LDA     2,DL
        64 001504   000000 755000 25                 STA     ALLOCATE_END

      510     5572    3               STATUS = #ITEM_DEF;

   5572 64 001505   050000 236003                    LDQ     20480,DU
        64 001506   200007 756100                    STQ     STATUS,,AUTO

      511     5573    3               HASH_SCHEMA_NAME = '1'B;

   5573 64 001507   400000 236003                    LDQ     -131072,DU
        64 001510   000000 756000 16                 STQ     HASH_SCHEMA_NAME

      512     5574    3               CALL ZIG$HASH_IT(UWA.SN.SENAME,#ADD_ALT_HASH,ERROR_FLG,0,RECORD_NUM,

   5574 64 001511   200007 630500                    EPPR0   STATUS,,AUTO
        64 001512   200031 450500                    STP0    SEARCH_STR+8,,AUTO
        64 001513   200004 631500                    EPPR1   TPTR$,,AUTO
        64 001514   200030 451500                    STP1    SEARCH_STR+7,,AUTO
        64 001515   000110 237000 65                 LDAQ    72
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:76   
        64 001516   200026 757100                    STAQ    SEARCH_STR+5,,AUTO
        64 001517   000054 237000 65                 LDAQ    44
        64 001520   200024 757100                    STAQ    SEARCH_STR+3,,AUTO
        64 001521   000112 237000 65                 LDAQ    74
        64 001522   200022 757100                    STAQ    SEARCH_STR+1,,AUTO
        64 001523   200022 630500                    EPPR0   SEARCH_STR+1,,AUTO
        64 001524   000030 631400 65                 EPPR1   24
        64 001525   000000 701000 xent               TSX1    ZIG$HASH_IT
        64 001526   000000 011000                    NOP     0

      513     5575    3                  13,TPTR$,STATUS);
      514     5576    3               ALLOCATE_END = 0;

   5576 64 001527   000000 450000 25                 STZ     ALLOCATE_END

      515     5577    3               TPTR$ -> FIELD_HASH.DBK = SAVE_DBK;

   5577 64 001530   200004 470500                    LDP0    TPTR$,,AUTO
        64 001531   000002 235000 54                 LDA     SAVE_DBK
        64 001532   000013 755100                    STA     11,,PR0

      516     5578    3               TPTR$ -> FIELD_HASH.DBK_SN = UWA.DIRECT_REF;

   5578 64 001533   000036 236000 52                 LDQ     UWA+30
        64 001534   000014 756100                    STQ     12,,PR0

      517     5579    3               END;

      518     5580    2           END;

   5580 64 001535   000000 470400 42                 LDP0    RC$
        64 001536   000000 720100                    LXL0    0,,PR0
        64 001537   000077 360003                    ANX0    63,DU
        64 001540   040000 106540                    CMPC    fill='040'O
        64 001541   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        64 001542   000003 000010 63                 ADSC9   3                        cn=0,n=8
        64 001543   001550 600000 64                 TZE     DONE_FR
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:77   
        64 001544   040000 106540                    CMPC    fill='040'O
        64 001545   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        64 001546   000001 000010 63                 ADSC9   1                        cn=0,n=8
        64 001547   001256 601000 64                 TNZ     s:5486

      519     5581    1   DONE_FR:
      520     5582    1       RETURN;

   5582 64 001550   000000 702200 xent  DONE_FR      TSX2  ! X66_ARET

      521     5583    1   DBCS_ERROR:
      522     5584    1       CALL ABORT;

   5584 64 001551   000001 631400 65    DBCS_ERROR   EPPR1   1
        64 001552   000000 701000 xent               TSX1    ABORT
        64 001553   000000 011000                    NOP     0

      523     5585    1       RETURN;

   5585 64 001554   000000 702200 xent               TSX2  ! X66_ARET

ANALS
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
   4     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
   5     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
   5     024*  ****** ******   ****** ******   ****** ******                    ............
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:78   

VALIDS
 Sect OctLoc
   6     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
  10     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
  11     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_ALLOWED
 Sect OctLoc
  12     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  14     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  15     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  15     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:79   
  15     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
  15     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  16     000   0***** ******                                                    ....

CONTROL
 Sect OctLoc
  18     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  18     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  18     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     020*  040040 040040   040040 040040   040040 040040   040040 040040
  18     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  18     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  18     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
  18     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

DESC_TYPE_9
 Sect OctLoc
  19     000   000000 000160   000000 000000   000000 000000   000000 000011    ...p............
  19     004   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     020*  000000 000000   200000 000000   000000 000000   000000 000000    ................
  19     024   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     030   040040 040040   040040 040040   040040 040040   040040 040040
  19     034   040040 040040   040040 040040   040040 040040   040040 040040

TYPE_32
 Sect OctLoc
  20     000   000000 000040   000000 000000   000000 000000   000000 000040    ... ...........
  20     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  20     010   040040 040040   040040 040040   040040 040040   040040 040040
  20     024*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  20     030   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:80   
  20     040*  000000 000000                                                    ....

TYPE_33
 Sect OctLoc
  21     000   000000 000041   000000 000000   000000 000000   000000 000041    ...!...........!
  21     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  21     010   040040 040040   040040 040040   040040 040040   040040 040040
  21     024*  040040 040040   000000 000000   000000 000000   000000 000000        ............
  21     030   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     040*  000000 000000                                                    ....

IO_BUF
 Sect OctLoc
  22     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  30     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  32     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  33     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  35     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  35     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  35     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  35     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  36     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:81   
  36     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  36     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  36     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  36     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  36     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  36     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  36     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  37     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  37     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  37     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  37     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  37     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  37     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  37     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  37     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  38     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  38     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  38     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  38     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  38     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  38     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  38     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  38     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  52     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  52     004   040040 040040   040040 040040   040040 040040   040040 040040
  52     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  52     014   040040 040040   040040 040040   040040 040040   040040 040040
  52     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:82   
  52     024   040040 040040   040040 040040   040040 040040   040040 040040
  52     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  52     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  52     040   040040 040040   040040 040040   040040 040040   040040 040040
  52     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  52     050   040040 040040   040040 040040   040040 040040   040040 040040
  52     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  52     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  52     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  52     070   040040 040040   040040 040040   040040 040040   040040 040040
  52     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  52     104   040040 040040   040040 040040   040040 040040   040040 040040
  52     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  52     130   040040 040040   040040 040040   040040 040040   040040 040040
  52     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  52     140   040040 040040   040040 040040   040040 040040   040040 040040
  52     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  52     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     154   040040 040040   040040 040040   040040 040040   040040 040040
  52     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  52     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  52     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  52     174   040040 040040   040040 040040   040040 040040   040040 040040
  52     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  52     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  52     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  52     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  52     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  52     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  52     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  52     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:83   
  52     430   040040 040040   040040 040040   040040 040040   040040 040040
  52     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  52     440   040040 040040   040040 040040   040040 040040   040040 040040
  52     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  52     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  52     460   040040 040040   040040 040040   040040 040040   040040 040040
  52     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  52     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  52     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  52     504   040040 040040   040040 040040   040040 040040   040040 040040
  52     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  52     524   040040 040040   040040 040040   040040 040040   040040 040040
  52     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  52     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  52     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  52     614   040040 040040   040040 040040   040040 040040   040040 040040
  52     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  52     624   040040 040040   040040 040040   040040 040040   040040 040040
  52     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  52     664   040040 040040   040040 040040   040040 040040   040040 040040
  52     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  52     700   040040 040040   040040 040040   040040 040040   040040 040040
  52     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  52     714   040040 040040   040040 040040   040040 040040   040040 040040
  52     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  52     724   040040 040040   040040 040040   040040 040040   040040 040040
  52     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  52     744   040040 040040   040040 040040   040040 040040   040040 040040
  52     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  52    1000   040040 040040   040040 040040   040040 040040   040040 040040
  52    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  52    1040   040040 040040   040040 040040   040040 040040   040040 040040
  52    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  52    1064   040040 040040   040040 040040   040040 040040   040040 040040
  52    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:84   
  52    1120   040040 040040   040040 040040   040040 040040   040040 040040
  52    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  52    1140   040040 040040   040040 040040   040040 040040   040040 040040
  52    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  52    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  52    1154   040040 040040   040040 040040   040040 040040   040040 040040
  52    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  52    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  52    1170   040040 040040   040040 040040   040040 040040   040040 040040
  52    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  52    1204   040040 040040   040040 040040   040040 040040   040040 040040
  52    1214*  040040 040040   040040 040040   040040 040040   040040 040040

ZERO_A
 Sect OctLoc
  54     005   000000 000000                                                    ....

SAVE_BUF
 Sect OctLoc
  54     006   ****** ******   ****** ******   ****** ******   ****** ******    ................

LIST_STRING
 Sect OctLoc
  59     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
  63     000   052052 052052   052104 102120   101122 101115   052103 101114    *****DBPARAM*CAL
  63     004   103056 122103   123116 055123   105040 040040   122103 055123    C.RCSN-SE   RC-S
  63     010   117123 115040   123103 055123   117123 115040   122103 040040    OSM SC-SOSM RC
  63     014   123117 040040   060065 060062   061060 060040   122103 055106    SO  0502100 RC-F
  63     020   122040 040040   106122 055103   106123 040040   040040 040040    R   FR-CFS
  63     024   106122 040040   106122 055103   106122 040040   040040 040040    FR  FR-CFR

(unnamed)
 Sect OctLoc
  65     000   040040 040040   000000 000000   000002 000000   000000 006000        ............
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:85   
  65     004   000001 006000   000000 006014   000013 006000   000003 000000    ................
  65     010   000000 000050   000000 000001   000003 006000   000010 006000    ...(............
  65     014   000000 000036   000011 006000   000014 006000   000003 006000    ................
  65     020   000001 000000   000000 021464   000021 006000   000005 006000    ................
  65     024   000000 000002   000024 006000   000000 006000   000000 006000    ................
  65     030   000010 000000   000000 000004   000000 000014   000007 006000    ................
  65     034   000024 006000   000032 006000   000000 006000   000031 006000    ................
  65     040   000003 006000   000001 006000   000011 006000   000013 006000    ................
  65     044   000001 006000   000000 006000   777777 777770   777777 777377    ................
  65     050   000000 000016   777777 777777   000011 006000   000050 006000    .............(..
  65     054   000000 006000   000001 006000   000427 006000   000011 006000    ................
  65     060   777777 400000   000024 006000   000014 006000   000427 006000    ................
  65     064   000000 021471   000064 006000   377777 777777   000000 006000    .....4..........
  65     070   000000 006000   000000 006000   000000 006000   000017 006000    ................
  65     074   000011 006000   000000 006000   000000 000006   000076 006000    .............>..
  65     100   000000 006000   000021 006000   000003 006000   000000 021472    ................
  65     104   000103 006000   000024 006000   000025 006000   000000 000015    .C..............
  65     110   000000 006000   000107 006000   000427 006000   000024 006000    .....G..........
      524     5586    1   END ZIG$V_RECORD;

PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:86   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_RECORD.

   Procedure ZIG$V_RECORD requires 877 words for executable code.
   Procedure ZIG$V_RECORD requires 26 words of local(AUTO) storage.

    No errors detected in file ZIG$V_RECORD.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:87   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:88   
          MINI XREF LISTING

ABORT
      3069**DCL-ENT  5418--CALL     5484--CALL     5534--CALL     5559--CALL     5567--CALL     5584--CALL
ADD_SC
      5173**PROC     5391--CALL
ALLOCATE_END
      3072**DCL      5226<<ASSIGN   5272<<ASSIGN   5276<<ASSIGN   5375<<ASSIGN   5379<<ASSIGN   5571<<ASSIGN
      5576<<ASSIGN
BASED_PTR$
      5158**DCL      5392>>ASSIGN
CD.CDRH
      4045**DCL      5562<<ASSIGN
CD.CDRN
      4047**DCL      5563<<ASSIGN
CD.CDSH
      4044**DCL      5537<<ASSIGN
CD.CDSN
      4046**DCL      5538<<ASSIGN
CD$
      4032**DCL      4033--IMP-PTR
CF_PTR$
      5148**DCL      5203>>ASSIGN
CF_STR.COUNT
      5151**DCL      5152--IMP-SIZ  5205>>CALLBLT  5210>>ASSIGN
CF_STR.NPTR$
      5150**DCL      5218>>ASSIGN
CF_STR.STR
      5152**DCL      5205>>CALLBLT  5210>>ASSIGN
CF_TPTR$
      5153**DCL      5203<<ASSIGN   5204>>DOWHILE  5205>>CALLBLT  5205>>CALLBLT  5210>>ASSIGN   5210>>ASSIGN
      5218<<ASSIGN   5218>>ASSIGN
CHAR2
      5156**DCL      5210<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:89   
CONTROL.NUM_REC_SET_REL
      2599**DCL      5479<<ASSIGN   5479>>ASSIGN
CURRENT_CF
      5137**DCL      5210--ASSIGN   5536>>ASSIGN   5539>>ASSIGN   5561>>ASSIGN   5564>>ASSIGN
CURRENT_OFF
      5131**DCL      5270<<ASSIGN   5278>>ASSIGN   5299>>ASSIGN   5300>>ASSIGN   5504<<ASSIGN   5508>>ASSIGN
      5509>>ASSIGN
CUR_EXT_NAME_SEG
        29**DCL      5465<>CALL     5477<>CALL     5480<<ASSIGN   5480>>ASSIGN
DBCS_ERROR
      5584**LABEL    5254--CALLALT  5325--CALLALT  5326--CALLALT  5370--CALLALT  5371--CALLALT  5570--CALLALT
DBK IN PROCEDURE FIND_CF
      5195**DCL      5194--PROC     5200>>ASSIGN
DESC_TYPE_9
      2734**DCL      5334<>CALL     5344<>CALL
DESC_TYPE_9.FILLG
      2756**DCL      5337<<ASSIGN   5341<<ASSIGN
DESC_TYPE_9.F_DBK
      2750**DCL      5338<<ASSIGN   5342<<ASSIGN
DONE_FR
      5582**LABEL    5486--CALLALT
DONE_SOSM
      5484**LABEL    5361--CALLALT
DP$
      3882**DCL      3883--IMP-PTR
DP1$
      3896**DCL      3897--IMP-PTR
END_CFR
      5567**LABEL    5544--CALLALT
END_CFS
      5542**LABEL    5519--CALLALT
ERROR
      3061**DCL-ENT  5240--CALL     5417--CALL     5528--CALL     5553--CALL
ERROR_FLG
      5133**DCL      5274<>CALL     5377<>CALL     5380>>IF       5525<>CALL     5526>>IF       5550<>CALL
      5551>>IF       5574<>CALL
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:90   
FCURR_R_6
      4098**DCL-ENT  5328--CALL     5542--CALL
FETCHNS_6
      4101**DCL-ENT  5254--CALL     5486--CALL
FETCHOS_6
      4105**DCL-ENT  5326--CALL     5371--CALL     5570--CALL
FIELD_HASH.DBK
      2507**DCL      5577<<ASSIGN
FIELD_HASH.DBK_SN
      2508**DCL      5578<<ASSIGN
FINDD_6
      4097**DCL-ENT  5184--CALL
FINDNS_6
      4100**DCL-ENT  5325--CALL     5361--CALL     5519--CALL     5544--CALL
FINDOS_6
      4104**DCL-ENT  5370--CALL
FIND_CF
      5194**PROC     5525--CALL     5550--CALL
FIND_LENGTH
      5162**PROC     5225--CALL
FOUND IN PROCEDURE FIND_CF
      5196**DCL      5194--PROC     5201<<ASSIGN   5209<<ASSIGN
FR.CDRN
      4013**DCL      5563>>ASSIGN   5564<<ASSIGN
FR.CDSN
      4012**DCL      5538>>ASSIGN   5539<<ASSIGN
FR.DEF.FUSE
      3989**DCL      5510<<ASSIGN
FR.DEF.SYN
      3988**DCL      5503<<ASSIGN
FR.DEF.TYPE
      3982**DCL      5501<<ASSIGN
FR.FNL
      4015**DCL      4019--IMP-SIZ
FR.RCFRH
      4017**DCL      5505<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:91   
FR.RCFRN
      4016**DCL      5507<<ASSIGN   5507>>ASSIGN   5508<<ASSIGN
FR.ROFST
      3993**DCL      5512--ASSIGN
FR.UOFST
      4002**DCL      5511--ASSIGN
FR.UOFST.EIS.OFFSET
      4005**DCL      4008--REDEF
FR$
      3979**DCL      3980--IMP-PTR  5499<>CALL     5501>>ASSIGN   5503>>ASSIGN   5504>>ASSIGN   5505>>ASSIGN
      5507>>ASSIGN   5510>>ASSIGN   5511>>ASSIGN   5512>>ASSIGN   5538>>ASSIGN   5539>>ASSIGN   5563>>ASSIGN
      5564>>ASSIGN
FR1.NLIND
      4027**DCL      5500<<ASSIGN
FR1$
      4024**DCL      4025--IMP-PTR  5498<>CALL     5500>>ASSIGN
HASH_SCHEMA_NAME
      2451**DCL      5273<<ASSIGN   5376<<ASSIGN   5573<<ASSIGN
I
      5127**DCL      5205<<CALLBLT  5207>>IF       5210>>ASSIGN   5214>>ASSIGN   5395<<DOINDEX  5396>>IF
      5398>>ASSIGN   5399>>ASSIGN   5399>>ASSIGN   5401<<ASSIGN   5409<<ASSIGN   5411<<ASSIGN   5413>>IF
INCREMENT IN PROCEDURE FIND_CF
      5218**LABEL    5205--CALLALT
IO_BUF
      2919**DCL      2946--REDEF    3005--REDEF    5174>>ASSIGN   5183<<ASSIGN
LAST_FR
      5135**DCL      5301<<ASSIGN   5506>>ASSIGN   5509<<ASSIGN   5537>>ASSIGN   5562>>ASSIGN
LAST_RC
      5134**DCL      5295>>ASSIGN   5300<<ASSIGN   5301>>ASSIGN   5302>>ASSIGN   5429>>ASSIGN   5431>>IF
      5436>>ASSIGN   5505>>ASSIGN
LAST_RS_INT
      5143**DCL      5302<<ASSIGN   5431>>IF       5431<<ASSIGN   5434>>ASSIGN   5438<<ASSIGN
L_SUBSCH_RC
      5129**DCL      5225<>CALL     5265>>CALL     5316>>ASSIGN
NOT_BLANK IN PROCEDURE FIND_LENGTH
      5168**LABEL    5165--CALLALT
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:92   
OA.CSZ
      3812**DCL      5321>>ASSIGN   5322<<ASSIGN   5322>>ASSIGN   5327<<ASSIGN   5327>>ASSIGN
OA.LRSZ
      3813**DCL      5297>>IF       5298<<ASSIGN
OA.SCNAM.EIS.COUNT
      3787**DCL      3824--IMP-SIZ
OA$
      3765**DCL      3766--IMP-PTR  5297>>IF       5298>>ASSIGN   5321>>ASSIGN   5322>>ASSIGN   5322>>ASSIGN
      5327>>ASSIGN   5327>>ASSIGN
OA1$
      3831**DCL      3832--IMP-PTR
RC.DEF.CSPAC
      3854**DCL      5315<<ASSIGN
RC.DEF.FVR
      3849**DCL      5313<<ASSIGN
RC.DEF.PSTO
      3845**DCL      5304<<ASSIGN   5323>>IF
RC.DEF.RERS
      3846**DCL      5386<<ASSIGN
RC.DEF.RKEY
      3851**DCL      5314<<ASSIGN
RC.DEF.RNL
      3857**DCL      3867--IMP-SIZ  5316<<ASSIGN   5330>>ASSIGN   5382>>IF       5388>>IF       5459>>ASSIGN
      5469>>ASSIGN   5485>>DOWHILE  5485>>DOWHILE
RC.DEF.RSTO
      3847**DCL      5389<<ASSIGN
RC.DEF.TYPE
      3843**DCL      5303<<ASSIGN
RC.OARCN
      3860**DCL      5296<<ASSIGN   5296>>ASSIGN   5299<<ASSIGN
RC.RCID
      3859**DCL      5317<<ASSIGN   5458>>ASSIGN   5468>>ASSIGN
RC.RCON
      3863**DCL      5319<<ASSIGN
RC.RCRSN
      3861**DCL      5428>>ASSIGN   5430<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:93   
RC.RCWSO
      3865**DCL      5321<<ASSIGN
RC.RNAM
      3867**DCL      5330<<ASSIGN   5382>>IF       5388>>IF       5459>>ASSIGN   5469>>ASSIGN   5485>>DOWHILE
      5485>>DOWHILE
RC.RSIZ
      3862**DCL      5318<<ASSIGN
RC.RTYP
      3864**DCL      5320<<ASSIGN
RC$
      3840**DCL      3841--IMP-PTR  5265<>CALL     5270>>ASSIGN   5296>>ASSIGN   5303>>ASSIGN   5304>>ASSIGN
      5313>>ASSIGN   5314>>ASSIGN   5315>>ASSIGN   5316>>ASSIGN   5317>>ASSIGN   5318>>ASSIGN   5319>>ASSIGN
      5320>>ASSIGN   5321>>ASSIGN   5323>>IF       5330>>ASSIGN   5330>>ASSIGN   5382>>IF       5382>>IF
      5386>>ASSIGN   5388>>IF       5388>>IF       5389>>ASSIGN   5428>>ASSIGN   5430>>ASSIGN   5458>>ASSIGN
      5459>>ASSIGN   5459>>ASSIGN   5468>>ASSIGN   5469>>ASSIGN   5469>>ASSIGN   5485>>DOWHILE  5485>>DOWHILE
      5485>>DOWHILE  5485>>DOWHILE
RC1.CSPES
      3875**DCL      5259<<ASSIGN
RC1.CSPSB
      3874**DCL      5258<<ASSIGN
RC1.OTVL
      3877**DCL      5331<<ASSIGN
RC1$
      3872**DCL      3873--IMP-PTR  5257<>CALL     5258>>ASSIGN   5259>>ASSIGN   5263<<ASSIGN   5331>>ASSIGN
RC_SM
      5140**DCL      5365<<ASSIGN   5368<<ASSIGN   5384>>IF       5394>>IF       5472>>ASSIGN   5473>>ASSIGN
READSF
        31**DCL-ENT  5334--CALL
RECORD_FOUND
      5159**DCL      5234<<ASSIGN   5244<<ASSIGN   5248<<ASSIGN
RECORD_HASH.DBK
      2498**DCL      5279<<ASSIGN
RECORD_HASH.REF
      2496**DCL      5277<<ASSIGN
RECORD_HASH.SUB_OFF
      2497**DCL      5278<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:94   
RECORD_NUM
      5145**DCL      5574<>CALL
RETURN_LENGTH IN PROCEDURE FIND_LENGTH
      5163**DCL      5162--PROC     5165<<CALLBLT  5168<<ASSIGN
RS.DEF.MSM
      3918**DCL      5475>>ASSIGN
RS.DEF.OSM
      3917**DCL      5474>>ASSIGN
RS.DEF.SMOD
      3919**DCL      5476>>ASSIGN
RS.DEF.VIA
      3910**DCL      5426>>IF
RS.NPOS
      3930**DCL      3939--REDEF
RS.RCRSH
      3928**DCL      5429<<ASSIGN   5436<<ASSIGN
RS.RCRSN
      3927**DCL      5428<<ASSIGN   5435<<ASSIGN   5435>>ASSIGN   5437<<ASSIGN
RS.RSSSN
      3925**DCL      5441>>ASSIGN   5444>>ASSIGN
RS.SCRSH
      3929**DCL      5452>>ASSIGN
RS$
      3904**DCL      3905--IMP-PTR
SAVE_BUF
      5157**DCL      5174<<ASSIGN   5183>>ASSIGN
SAVE_CF_DBK
      5147**DCL      5520<<ASSIGN   5525<>CALL     5545<<ASSIGN   5550<>CALL
SAVE_DBK
      5146**DCL      5487<<ASSIGN   5500>>ASSIGN   5577>>ASSIGN
SC.DEF.SETT
      4064**DCL      5456>>IF       5456>>IF       5462>>IF
SC.DEF.SNL
      4065**DCL      4070--IMP-SIZ  5453>>IF       5461>>ASSIGN   5471>>ASSIGN
SC.DEF.SNSS
      4059**DCL      5182<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:95   
SC.DEF.SRCR
      4061**DCL      5453>>IF
SC.SCID
      4069**DCL      5460>>ASSIGN   5470>>ASSIGN
SC.SNAM
      4070**DCL      5453>>IF       5461>>ASSIGN   5471>>ASSIGN
SC$
      4052**DCL      4053--IMP-PTR  5182>>ASSIGN   5452<<ASSIGN   5453>>IF       5453>>IF       5453>>IF
      5456>>IF       5456>>IF       5460>>ASSIGN   5461>>ASSIGN   5461>>ASSIGN   5462>>IF       5470>>ASSIGN
      5471>>ASSIGN   5471>>ASSIGN
SC1.XXDPN
      4082**DCL      5392--ASSIGN
SC1$
      4078**DCL      4079--IMP-PTR  5392>>ASSIGN
SEARCH_STR.NUM IN PROCEDURE FIND_CF
      5199**DCL      5200<<ASSIGN
SEARCH_STR.STR IN PROCEDURE FIND_CF
      5198**DCL      5199--REDEF    5205>>CALLBLT
SET_FIELDS
      3064**DCL-ENT  5239--CALL     5415--CALL     5416--CALL
SET_HASH.NUM_SM
      2486**DCL      5395>>DOINDEX
SET_HASH.SM_LIST.DBK
      2488**DCL      5396>>IF       5399<<ASSIGN   5399>>ASSIGN
SET_HASH.SM_LIST.OFFSET
      2489**DCL      5398>>ASSIGN
SET_HASH.SO.DBK
      2484**DCL      5405>>IF       5408<<ASSIGN   5408>>ASSIGN
SET_HASH.SO.OFFSET
      2485**DCL      5407>>ASSIGN
SN_DBK
        33**DCL      5251<<ASSIGN
SOSM_DBK
      5139**DCL      5184<>CALL     5362<<ASSIGN   5396>>IF       5405>>IF
SRCHD
      3090**DCL-ENT  5231--CALL
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:96   
SSS$
      3760**DCL      5270>>ASSIGN   5295>>ASSIGN   5425>>ASSIGN   5434>>ASSIGN   5441>>ASSIGN   5442>>DOWHILE
      5444>>ASSIGN   5452>>ASSIGN   5504>>ASSIGN   5506>>ASSIGN   5536>>ASSIGN   5561>>ASSIGN
START_N
      5154**DCL      5202<<ASSIGN   5205>>CALLBLT  5214<<ASSIGN   5219<<ASSIGN
STATUS
      5132**DCL      5271<<ASSIGN   5274<>CALL     5373<<ASSIGN   5374<<ASSIGN   5377<>CALL     5572<<ASSIGN
      5574<>CALL
STRING_TO_GET IN PROCEDURE FIND_LENGTH
      5164**DCL      5162--PROC     5165>>CALLBLT
SUBSCHEMA_KEY
      3096**DCL      3097--REDEF
SUB_LANGUAGE
      2407**DCL      5332>>IF
SUCC
      5130**DCL      5231<>CALL     5232>>IF       5237>>IF
T1PTR$
      5141**DCL      5434<<ASSIGN   5435>>ASSIGN   5437>>ASSIGN   5441<<ASSIGN   5442>>DOWHILE  5444<<ASSIGN
      5444>>ASSIGN   5536<<ASSIGN   5537>>ASSIGN   5538>>ASSIGN   5561<<ASSIGN   5562>>ASSIGN   5563>>ASSIGN
TPTR$
      5128**DCL      5262<>CALL     5263>>ASSIGN   5274<>CALL     5277>>ASSIGN   5278>>ASSIGN   5279>>ASSIGN
      5295<<ASSIGN   5296>>ASSIGN   5299>>ASSIGN   5377<>CALL     5392<<ASSIGN   5395>>DOINDEX  5396>>IF
      5398>>ASSIGN   5399>>ASSIGN   5399>>ASSIGN   5405>>IF       5407>>ASSIGN   5408>>ASSIGN   5408>>ASSIGN
      5425<<ASSIGN   5426>>IF       5428>>ASSIGN   5429>>ASSIGN   5435>>ASSIGN   5436>>ASSIGN   5441>>ASSIGN
      5452>>ASSIGN   5474>>ASSIGN   5475>>ASSIGN   5476>>ASSIGN   5506<<ASSIGN   5507>>ASSIGN   5508>>ASSIGN
      5574<>CALL     5577>>ASSIGN   5578>>ASSIGN
TYPE_300.INFO
      3014**DCL      3015--REDEF
TYPE_300.REF_LINE
      3007**DCL      5180<<ASSIGN
TYPE_300.SET_NAME
      3009**DCL      5175<<ASSIGN
TYPE_300.SUB_SET_NAME
      3011**DCL      5176<<ASSIGN
TYPE_300.TYPE
      3006**DCL      5178<<ASSIGN   5179<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:97   
TYPE_32
      2840**DCL      5477<>CALL
TYPE_32.MANUAL_MEM
      2848**DCL      5475<<ASSIGN
TYPE_32.MEMBER
      2846**DCL      5473<<ASSIGN
TYPE_32.MODIFY_NOT
      2849**DCL      5476<<ASSIGN
TYPE_32.NUM_CON_FIELDS
      2871**DCL      5446<<ASSIGN
TYPE_32.OPTIONAL_MEM
      2847**DCL      5474<<ASSIGN
TYPE_32.OWNER
      2845**DCL      5472<<ASSIGN
TYPE_32.RECORD_NAME
      2842**DCL      5468<<ASSIGN
TYPE_32.SET_NAME
      2843**DCL      5470<<ASSIGN
TYPE_32.SUB_RECORD_NM
      2851**DCL      5469<<ASSIGN
TYPE_32.SUB_SET_NM
      2852**DCL      5471<<ASSIGN
TYPE_33
      2906**DCL      5465<>CALL
TYPE_33.KEY_NAME
      2909**DCL      5460<<ASSIGN
TYPE_33.NUM_CON_FIELDS
      2914**DCL      5440<<ASSIGN   5443<<ASSIGN   5443>>ASSIGN   5446>>ASSIGN
TYPE_33.PRIM_OR_SEC
      2915**DCL      5463<<ASSIGN   5464<<ASSIGN
TYPE_33.RECORD_NAME
      2908**DCL      5458<<ASSIGN
TYPE_33.SUB_KEY_NM
      2913**DCL      5461<<ASSIGN
TYPE_33.SUB_RECORD_NM
      2912**DCL      5459<<ASSIGN
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:98   
TYPE_400.ID_NUM
      2954**DCL      5317>>ASSIGN
TYPE_400.INFO
      2955**DCL      2956--REDEF
TYPE_400.RECORD_NAME
      2950**DCL      5227>>IF       5227>>IF       5231<>CALL     5239<>CALL     5274<>CALL     5415<>CALL
TYPE_400.REF_LINE
      2948**DCL      5227>>IF       5232>>IF       5249>>IF       5277>>ASSIGN   5332>>IF       5334<>CALL
      5344<>CALL     5453>>IF
TYPE_400.SUB_RECORD_NAME
      2952**DCL      5225<>CALL     5330>>ASSIGN
T_OFF
      5142**DCL      5398<<ASSIGN   5407<<ASSIGN   5425>>ASSIGN   5430>>ASSIGN   5431>>ASSIGN   5437>>ASSIGN
      5438>>ASSIGN
UWA.AC.CALC_NEXT
      4902**DCL      4903--REDEF
UWA.AC.CALC_PRIOR
      4911**DCL      4912--REDEF
UWA.AC.DEFAULTS
      4863**DCL      4864--REDEF
UWA.AC.FILE_CODE
      4868**DCL      4869--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      4865**DCL      4866--REDEF
UWA.DB_STATUS
      4794**DCL      5484>>IF       5567>>IF
UWA.DIRECT_REF
      4803**DCL      5251>>ASSIGN   5279>>ASSIGN   5362>>ASSIGN   5487>>ASSIGN   5520>>ASSIGN   5545>>ASSIGN
      5578>>ASSIGN
UWA.FR.BUFFLOC
      4972**DCL      5512>>ASSIGN
UWA.FR.FR_FRH
      4973**DCL      5511>>ASSIGN
UWA.FR.F_OCCURS
      4968**DCL      5488>>IF
UWA.FR.F_USE
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:99   
      4966**DCL      5510>>ASSIGN
UWA.FR.RPT
      4967**DCL      5488>>IF
UWA.FR.SYN
      4957**DCL      5488>>IF       5502>>IF
UWA.RC.CV_OFFSET
      4931**DCL      5331>>ASSIGN
UWA.RC.FIXVAR
      4923**DCL      5313>>IF
UWA.RC.KEY_PRESENT
      4930**DCL      5314>>IF
UWA.RC.LSIZE
      4935**DCL      5297>>IF       5298>>ASSIGN   5318>>ASSIGN
UWA.RC.PA_ENTRY
      4933**DCL      5259>>ASSIGN
UWA.RC.PA_OFFSET
      4932**DCL      5258>>ASSIGN
UWA.RC.PSMODE
      4922**DCL      5255>>IF       5304>>ASSIGN   5315>>IF       5335>>IF
UWA.RC.RTYPE
      4921**DCL      5320>>ASSIGN
UWA.RECORD_NAME
      4800**DCL      5363>>IF
UWA.SC.KEY_LENGTH
      4950**DCL      5327>>ASSIGN
UWA.SN.SENAME
      5021**DCL      5175>>ASSIGN   5176>>ASSIGN   5377<>CALL     5382>>IF       5416<>CALL     5574<>CALL
UWA.SN.SETYPE
      5018**DCL      5177>>IF       5372>>IF
WORD36
      5144**DCL      5511<<ASSIGN   5512<<ASSIGN
WRITSF
        30**DCL-ENT  5344--CALL     5465--CALL     5477--CALL
ZIG$ADD_SI
        32**DCL-ENT  5252--CALL
ZIG$G_DYN_MEM_6
PL6.E3A0      #001=ZIG$V_RECORD File=ZIG$V_RECORD.:ZIC0TSI                       FRI 09/05/97 12:23 Page:100  
      3071**DCL-ENT  5257--CALL     5262--CALL     5265--CALL     5498--CALL     5499--CALL
ZIG$HASH_IT
        27**DCL-ENT  5274--CALL     5377--CALL     5574--CALL
ZIG$V_SET
        28**DCL-ENT  5181--CALL
