
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:1    
        1        1        /*M*     ZIG$V_SET      I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_SET
        9        9        PURPOSE:
       10       10              To read all the type 300 descriptors and write out all the
       11       11            SC record for any set in the subschema DDL text.
       12       12
       13       13        */
       14       14        /*
       15       15        ZZZZZ  III   GGG    $   V   V        SSS  EEEEE TTTTT
       16       16            Z   I   G   G  $$$  V   V       S   S E       T
       17       17           Z    I   G     $ $   V   V       S     E       T
       18       18          Z     I   G      $$$  V   V        SSS  EEEE    T
       19       19         Z      I   G  GG   $ $ V   V           S E       T
       20       20        Z       I   G   G  $$$   V V        S   S E       T
       21       21        ZZZZZ  III   GGG    $     V          SSS  EEEEE   T
       22       22                                      _____
       23       23        */
       24       24        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:2    
       25       25        ZIG$V_SET:
       26       26            PROC;
       27       27    1   DCL ZIG$HASH_IT ENTRY (8);
       28       28    1   DCL WRITSF ENTRY (2);
       29       29    1   DCL ZIG$ADD_SI ENTRY;
       30       30    1   DCL SN_DBK UBIN (36) EXT;
       31       31        %INCLUDE ZI_ERRORS_SUBS;
       32      551        %INCLUDE ZI_SUB_LANG;
       33     2266        %INCLUDE ZIG_DIR_STRUCS;
       34     2396        %GENERAL;
       35     2520        %CONTROL_BLOCK;
       36     2628    1   DCL IO_BUF CHAR (128) EXT;
       37     2629        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       38     2698        %INCLUDE ZIG_GENERAL;
       39     2806        %INCLUDE ZIG_TYPE_SUBS;
       40     2821        %INCLUDE ZIG_SSS;
       41     3391        %SS_GENERAL(PSTCLASS=EXT);
       42     3412        %OA(PSTCLASS=EXT);
       43     3479        %OA1(PSTCLASS=EXT);
       44     3487        %SC(PSTCLASS=EXT);
       45     3514        %SC1(PSTCLASS=EXT);
       46     3524        %DP(PSTCLASS=EXT);
       47     3538        %DP1(PSTCLASS=EXT);
       48     3546        %RS(PSTCLASS=EXT);
       49     3620        %SM1(PSTCLASS=EXT);
       50     3628        %SS(PSTCLASS=EXT);
       51     3642        %CD(PSTCLASS=EXT);
       52     3661        %INCLUDE ZIG_DBA_INT;
       53     3709        %INCLUDE ZI_SUB4_CAN;
       54     4366        %UWA;
       55     4701        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:3    
       56     4702    1   DCL I UBIN (36);
       57     4703    1   DCL TPTR$ PTR;
       58     4704    1   DCL L_SUBSCH_SC UBIN (36);
       59     4705    1   DCL SUCC BIT (1);
       60     4706    1   DCL CURRENT_OFF UBIN (36) EXT;
       61     4707    1   DCL STATUS UBIN (6);
       62     4708    1   DCL ERROR_FLG UBIN (36) STATIC;
       63     4709    1   DCL LAST_SC UBIN (18) EXT;
       64     4710    1   DCL LIST_STRING CHAR (128) EXT;
       65     4711    1   DCL LARGEST_KEY UBIN (36) EXT;
       66     4712    1   DCL NUM_CF UBIN (36);
       67     4713    1   DCL NUM_SM UBIN (36);
       68     4714    1   DCL 1 LINE(0:999) EXT,
       69     4715    1         2 DBK UBIN (18) UNAL,
       70     4716    1         2 OFFSET UBIN (18) UNAL;
       71     4717    1   DCL 1 LINE_SM(0:999) REDEF LINE,
       72     4718    1         2 DBK SBIN (19) UNAL,
       73     4719    1         2 OFFSET UBIN (17) UNAL;
       74     4720        /*D*     NAME:     LINE
       75     4721              This array is what is used in other overlay levels to
       76     4722            hold the string that X$PARSE uses to parse things, and
       77     4723            to hold the list of CF and SM records for each SC record
       78     4724            so they can be put in the SC record in the in the hash
       79     4725            table.
       80     4726            Note:
       81     4727                 The limit is 1000 CF + SM records for any set.
       82     4728        */
       83     4729    1   DCL LAST_RS UBIN (36) EXT;
       84     4730    1   DCL SAVE_SC_DBK UBIN (36) STATIC;
       85     4731    1   DCL SAVE_SO_DBK UBIN (36) STATIC;
       86     4732    1   DCL WORD36 UBIN (36) BASED;
       87     4733    1   DCL LAST_SS UBIN (18) EXT;
       88     4734    1   DCL LAST_SM UBIN (18) EXT;
       89     4735    1   DCL LAST_SO UBIN (18) EXT;
       90     4736    1   DCL LAST_CF UBIN (18) EXT;
       91     4737    1   DCL OWNER_CF UBIN (18) EXT;
       92     4738    1   DCL CF_PTR$ PTR EXT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:4    
       93     4739    1   DCL 1 CF_STR BASED,
       94     4740    1         2 NPTR$ PTR,
       95     4741    1         2 COUNT UBIN (36),
       96     4742    1         2 STR CHAR (CF_STR.COUNT);
       97     4743    1   DCL STR CHAR (4000) BASED;
       98     4744        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:5    
       99     4745    1   FIND_LENGTH:
      100     4746    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      101     4747    2   DCL RETURN_LENGTH UBIN (36);
      102     4748    2   DCL STRING_TO_GET CHAR (30);
      103     4749    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);
      104     4750    2       RETURN;
      105     4751    2   NOT_BLANK:
      106     4752    2       RETURN_LENGTH = 30;
      107     4753    2       RETURN;
      108     4754    2   END FIND_LENGTH;
      109     4755        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:6    
      110     4756    1   ADD_CF:
      111     4757    1       PROC;
      112     4758    2       CALL ZIG$G_DYN_MEM_6(%CD_BASE_SIZE,CD$);
      113     4759    2       CD.DEF.TYPE = '000000000100'B;
      114     4760    2       IF UWA.C_F.SYN = 1
      115     4761    2       THEN CD.DEF.SYNC = '1'B;
      116     4762    2       IF UWA.C_F.CTRLSEQ = 1
      117     4763    2       THEN CD.DEF.CONT = '1'B;
      118     4764    2       CD.DEF.RELT = UWA.C_F.CTRLTYPE;
      119     4765    2       CD.RSCDH = OWNER_CF;
      120     4766    2       TPTR$ = PINCRW(SSS$,LAST_CF);
      121     4767    2       CURRENT_OFF = POFFW(CD$,SSS$);
      122     4768    2       CD.RSCDN = TPTR$ -> CD.RSCDN;
      123     4769    2       TPTR$ -> CD.RSCDN = CURRENT_OFF;
      124     4770    2       LAST_CF = CURRENT_OFF;
      125     4771    2       LINE.DBK(999-NUM_CF) = UWA.DIRECT_REF;
      126     4772    2       LINE.OFFSET(999-NUM_CF) = CURRENT_OFF;
      127     4773    2       NUM_CF = NUM_CF + 1;
      128     4774    2       RETURN;
      129     4775    2   END ADD_CF;
      130     4776        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:7    
      131     4777    1       CALL FIND_LENGTH(TYPE_300.SUB_SET_NAME,L_SUBSCH_SC);
      132     4778    1       ALLOCATE_END = 0; /* Allocate a start of mem */
      133     4779    1       IF TYPE_300.TYPE = 300
      134     4780    2       THEN DO;
      135     4781    2           CALL SRCHD(TYPE_300.SET_NAME,%ZIG_RTYPE_SC,SUCC);
      136     4782    2           END;
      137     4783    2       ELSE DO;
      138     4784    2           CALL SRCHD(TYPE_300.SET_NAME,%ZIG_RTYPE_KC,SUCC);
      139     4785    2           END;
      140     4786    1       IF ~SUCC
      141     4787    2       THEN DO;
      142     4788    2           CALL SET_FIELDS(1,30,TYPE_300.SET_NAME);
      143     4789    2           CALL ERROR(%ZIG_V_SET_NAME);
      144     4790        /*E*     ERROR:    ZIG-ZIG_V_SET_NAME-C
      145     4791        MESSAGE: The set "%U1" is not present in the schema file.
      146     4792        */
      147     4793    2           RETURN;
      148     4794    2           END;
      149     4795    1       IF TYPE_300.REF_LINE ~= 0
      150     4796    2       THEN DO;
      151     4797    2           SN_DBK = UWA.DIRECT_REF;
      152     4798    2           CALL ZIG$ADD_SI;
      153     4799    2           END;
      154     4800    1       CALL FETCHNS_6('SN-SE   ') ALTRET (DBCS_ERROR);
      155     4801    1       IF UWA.SC.SETTYPE = 2 OR UWA.SC.SETTYPE = 3
      156     4802    2       THEN DO;
      157     4803    2           CALL ZIG$G_DYN_MEM_6(2,SC1$);
      158     4804    2           END;
      159     4805    2       ELSE DO;
      160     4806    2           CALL ZIG$G_DYN_MEM_6(1,TPTR$);
      161     4807    2           SC1$ = PINCRW(TPTR$,-1);
      162     4808    2           END;
      163     4809    1       CALL ZIG$G_DYN_MEM_6(%SC_BASE_SIZE+(L_SUBSCH_SC+3)/4,SC$);
      164     4810        /*
      165     4811              SC size = number of words in subschema set name
      166     4812                      + constant (3).
      167     4813        */
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:8    
      168     4814    1       CURRENT_OFF = POFFW(SC$,SSS$);
      169     4815    1       SAVE_SC_DBK = UWA.DIRECT_REF;
      170     4816    1       IF TYPE_300.SET_NAME = '*CALC'
      171     4817    1       THEN OA.CLCSC = CURRENT_OFF;
      172     4818        /*
      173     4819              Put the offset to the calc set in the OA record for
      174     4820            IDS to find the calc set fast.
      175     4821        */
      176     4822        /*
      177     4823              Now initialize the OA record in the schema subset and
      178     4824            connect it up to the OA-SC set.
      179     4825
      180     4826            Note:
      181     4827                 The OA record allways starts a offset of 1 from SSS$
      182     4828               and OA$ always points to the only OA record.
      183     4829        */
      184     4830    1       TPTR$ = PINCRW(SSS$,LAST_SC);
      185     4831    1       SC.OASCN = TPTR$ -> SC.OASCN;
      186     4832    1       TPTR$ -> SC.OASCN = CURRENT_OFF;
      187     4833    1       LAST_SC = CURRENT_OFF;
      188     4834    1       SC.DEF.TYPE = '000100000000'B;
      189     4835    1       SC.DEF.SETM = UWA.SC.SETMODE;
      190     4836    1       SC.DEF.SETO = UWA.SC.SETORD;
      191     4837    1       IF TYPE_300.REF_LINE ~= 0 THEN
      192     4838    1           UWA.SC.RECSET = 1;
      193     4839    1       ELSE
      194     4840    1           IF UWA.SC.RECSET = 0 THEN
      195     4841    1               SC.DEF.SRCR = '1'B;
      196     4842    1       IF UWA.SC.ALTOWN = 1
      197     4843    1       THEN SC.DEF.ALTO = '1'B;
      198     4844    1       IF UWA.SC.SETGLO = 1
      199     4845    1       THEN SC.DEF.LG = '1'B;
      200     4846    1       SC.DEF.SETT = UWA.SC.SETTYPE;
      201     4847    1       SC.DEF.SNL = L_SUBSCH_SC;
      202     4848    1       SC.SCWSO = OA.CSZ + %CUR_BASE_SIZE;
      203     4849    1       IF SC.DEF.SETM = 2
      204     4850    2       THEN DO;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:9    
      205     4851    2           OA.CSZ = OA.CSZ + 4;
      206     4852    2           IF LARGEST_KEY < UWA.SC.KEY_LENGTH
      207     4853    2           THEN LARGEST_KEY = UWA.SC.KEY_LENGTH;
      208     4854    2           IF UWA.SC.KEY_LENGTH > OA.LPASZ
      209     4855    2           THEN OA.LPASZ = UWA.SC.KEY_LENGTH;
      210     4856    2           END;
      211     4857    2       ELSE DO;
      212     4858    2           IF SC.DEF.SETT = 2 OR SC.DEF.SETT = 3
      213     4859    3           THEN DO;
      214     4860    3               SC1.KLNG = UWA.SC.KEY_LENGTH;
      215     4861    3               SC1.IXID = UWA.SC.INDEX_ID;
      216     4862    3               OA.CSZ = OA.CSZ + 2 + (UWA.SC.KEY_LENGTH +1+2+4+3)/4;
      217     4863    3               IF LARGEST_KEY < UWA.SC.KEY_LENGTH
      218     4864    3               THEN LARGEST_KEY = UWA.SC.KEY_LENGTH;
      219     4865    3               END;
      220     4866    3           ELSE DO;
      221     4867    3               OA.CSZ = OA.CSZ + 2;
      222     4868    3               END;
      223     4869    2           END;
      224     4870        /*
      225     4871              Modify the type 300 type descriptors for the set or the key
      226     4872            that this SC is for. If type_300.ref_line ~= 0;
      227     4873        */
      228     4874    1       IF TYPE_300.REF_LINE ~= 0
      229     4875    2       THEN DO;
      230     4876    2           IF UWA.SC.SETORD = 4
      231     4877    2           THEN TYPE_300.SORT_KEY_ORDER = UWA.SC.SEQDUP;
      232     4878    2           ELSE TYPE_300.SORT_KEY_ORDER = 0;
      233     4879    2           TYPE_300.INFO = SC.DEF;
      234     4880    2           CALL WRITSF(CURRENT_RECORD,IO_BUF);
      235     4881    2           END;
      236     4882    1       SC.SCID = TYPE_300.ID_NUM;
      237     4883    1       SC.SNAM = TYPE_300.SUB_SET_NAME;
      238     4884        /*
      239     4885              Init all the SO and SM records for this set.
      240     4886            Then do all the SS and CF records for each SM record.
      241     4887        */
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:10   
      242     4888    1       CALL FETCHNS_6('SC-SOSM ') ALTRET(DBCS_ERROR);
      243     4889    1       IF UWA.RECORD_NAME ~= 'SO '
      244     4890    2       THEN DO;
      245     4891    2           CALL SET_FIELDS(1,30,UWA.RECORD_NAME);
      246     4892    2           CALL ERROR(%ZIG_RECORD_NOT_SO);
      247     4893    2           CALL ABORT;
      248     4894        /*E*     ERROR:    ZIG-ZIG_RECORD_NOT_SO-C
      249     4895        MESSAGE: The record "%U1" was found, not the SO record
      250     4896                 in the schema file.
      251     4897                 <<<< SOFTWARE ERROR >>>>
      252     4898        */
      253     4899    2           END;
      254     4900    1       SAVE_SO_DBK = UWA.DIRECT_REF;
      255     4901    1       CALL ZIG$G_DYN_MEM_6(%SO_BASE_SIZE,RS$);
      256     4902    1       RS.DEF.TYPE = '000001000000'B;
      257     4903    1       CURRENT_OFF = POFFW(RS$,SSS$);
      258     4904    1       SC.SCRSN = CURRENT_OFF;
      259     4905    1       RS.SCRSH = POFFW(SC$,SSS$);
      260     4906    1       ADDR(RS.NPOS) -> WORD36 = UWA.SO.NXTPNT;
      261     4907    1       ADDR(RS.PPOS) -> WORD36 = UWA.SO.PRIPNT;
      262     4908    1       LAST_SO = CURRENT_OFF;
      263     4909        /*
      264     4910              SO record done now the SM records.
      265     4911        */
      266     4912    1       NUM_SM = 0;
      267     4913    1       NUM_CF = 0;
      268     4914    1       LAST_RS = CURRENT_OFF;
      269     4915    2       DO WHILE ('1'B);
      270     4916    2           CALL FETCHNS_6('SC-SOSM ') ALTRET(SM_DONE);
      271     4917    2           IF UWA.RECORD_NAME ~= 'SM '
      272     4918    3           THEN DO;
      273     4919    3               CALL SET_FIELDS(1,30,UWA.RECORD_NAME);
      274     4920    3               CALL ERROR(%ZIG_RECORD_NOT_SM);
      275     4921    3               CALL ABORT;
      276     4922        /*E*     ERROR:    ZIG-ZIG_RECORD_NOT_SM-C
      277     4923        MESSAGE: The record "%U1" was not the SM record that I
      278     4924                 was looking for in the schema file.
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:11   
      279     4925                 <<<< SOFTWARE ERROR >>>>
      280     4926        */
      281     4927    3               END;
      282     4928    2           CALL ZIG$G_DYN_MEM_6(1,SM1$);
      283     4929    2           CALL ZIG$G_DYN_MEM_6(%SM_BASE_SIZE,RS$);
      284     4930    2           TPTR$ = PINCRW(SSS$,LAST_RS);
      285     4931    2           CURRENT_OFF = POFFW(RS$,SSS$);
      286     4932    2           RS.SCRSN = TPTR$ -> RS.SCRSN;
      287     4933    2           RS.SCRSH = TPTR$ -> RS.SCRSH;
      288     4934    2           TPTR$ -> RS.SCRSN = CURRENT_OFF;
      289     4935    2           LAST_RS = CURRENT_OFF;
      290     4936    2           RS.DEF.TYPE = '000000100000'B;
      291     4937    2           ADDR(RS.NPOS) -> WORD36 = UWA.SM.NXTPNT;
      292     4938    2           ADDR(RS.PPOS) -> WORD36 = UWA.SM.PRIPNT;
      293     4939    2           ADDR(RS.HPOS) -> WORD36 = UWA.SM.HDPNT;
      294     4940    2           LINE_SM.DBK(NUM_SM) = UWA.DIRECT_REF;
      295     4941    2           LINE_SM.OFFSET(NUM_SM) = CURRENT_OFF;
      296     4942    2           NUM_SM = NUM_SM + 1;
      297     4943    2           IF UWA.SM.PSMODE = 1
      298     4944    2           THEN RS.DEF.VIA = '1'B;
      299     4945    2           RS.DEF.MEMT = UWA.SC.SETMODE;
      300     4946    2           RS.DEF.IXNUM = UWA.SM.PA_MEMPNT;
      301     4947        /*
      302     4948              Put the index number of the alt index for indexed
      303     4949            areas.
      304     4950        */
      305     4951    2           IF UWA.SC.SETORD = 4
      306     4952    2           THEN RS.DEF.DORD = UWA.SC.SEQDUP;
      307     4953    2           ELSE RS.DEF.DORD = UWA.SM.SEQDUP;
      308     4954    2           IF UWA.SM.RETTYPE = 1
      309     4955    2           THEN RS.DEF.OSM = '1'B;
      310     4956    2           IF UWA.SM.INSTYPE = 1
      311     4957    2           THEN RS.DEF.MSM = '1'B;
      312     4958    2           IF UWA.SM.MEMDUP = 1
      313     4959    2           THEN RS.DEF.DUPP = '1'B;
      314     4960    2           IF UWA.SM.CALCDUP = 1
      315     4961    2           THEN RS.DEF.DUPC = '1'B;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:12   
      316     4962    2           IF RS.DEF.MEMT = 2
      317     4963    3           THEN DO;
      318     4964    3               IF UWA.SM.PAMEM = 1
      319     4965    4               THEN DO;
      320     4966    4                   CALL ZIG$G_DYN_MEM_6(1,TPTR$);
      321     4967        /*
      322     4968              Allocate more space for a pointer array set.
      323     4969        */
      324     4970    4                   ADDR(RS.CSMPP) -> WORD36 = UWA.SM.PA_MEMPNT;
      325     4971    4                   RS.DEF.MEMT = 2;
      326     4972    4                   END;
      327     4973    4               ELSE DO;
      328     4974    4                   RS.DEF.MEMT = 1;
      329     4975    4                   END;
      330     4976    3               END;
      331     4977        /*
      332     4978              Now get the SS and CF records for this set member.
      333     4979        */
      334     4980        /*
      335     4981              Note that the RS is still pointing to the SM record
      336     4982            that all the SS and CF record must be connected up to.
      337     4983        */
      338     4984    2           OWNER_CF = LAST_RS;
      339     4985    2           LAST_CF = LAST_RS;
      340     4986    3           DO WHILE (SC.SNAM ~= '*CALC');
      341     4987        /*
      342     4988              Add CD record off SM record unless it is a calc set.
      343     4989        */
      344     4990    3               CALL FETCHNS_6('SMSS-CF ') ALTRET(DONE_SM_CF);
      345     4991    3               CALL ADD_CF;
      346     4992    3               END;
      347     4993    2   DONE_SM_CF:
      348     4994    2           IF UWA.DB_STATUS ~= '0502100' AND SC.SNAM ~= '*CALC'
      349     4995    2           THEN CALL ABORT;
      350     4996    2           LAST_SM = POFFW(RS$,SSS$);
      351     4997    2           LAST_SS = LAST_SM;
      352     4998    3           DO WHILE ('1'B);
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:13   
      353     4999    3               CALL FETCHNS_6('SM-SS   ') ALTRET(DONE_SM_SS);
      354     5000    3               CALL ZIG$G_DYN_MEM_6(%SS_BASE_SIZE,SS$);
      355     5001    3               SS.DEF.TYPE = '000000001000'B;
      356     5002    3               SS.DEF.SSTP = UWA.S_S.STYP;
      357     5003    3               TPTR$ = PINCRW(SSS$,LAST_SS);
      358     5004    3               SS.RSSSN = TPTR$ -> SS.RSSSN;
      359     5005    3               CURRENT_OFF = POFFW(SS$,SSS$);
      360     5006    3               TPTR$ -> SS.RSSSN = CURRENT_OFF;
      361     5007    3               SS.SSH = UWA.S_S.SOSM_SSH;
      362     5008    3               SS.RSSSH = LAST_SM;
      363     5009    3               LAST_SS = CURRENT_OFF;
      364     5010    3               OWNER_CF = LAST_SS;
      365     5011    3               LAST_CF = LAST_SS;
      366     5012    4               DO WHILE ('1'B);
      367     5013    4                   CALL FETCHNS_6('SSSM-CF ') ALTRET(DONE_SS_CF);
      368     5014    4                   CALL ADD_CF;
      369     5015    4                   END;
      370     5016    3   DONE_SS_CF:
      371     5017    3               IF UWA.DB_STATUS ~= '0502100'
      372     5018    3               THEN CALL ABORT;
      373     5019    3               END;
      374     5020    2   DONE_SM_SS:
      375     5021    2           IF UWA.DB_STATUS ~= '0502100'
      376     5022    2           THEN CALL ABORT;
      377     5023    2           END;
      378     5024    1   SM_DONE:
      379     5025    1       IF UWA.DB_STATUS ~= '0502100'
      380     5026    1       THEN CALL ABORT;
      381     5027    1       ALLOCATE_END = 1;
      382     5028    1       IF TYPE_300.TYPE = 300
      383     5029    1       THEN I = #SET_DEF;
      384     5030    1       ELSE I = #KEY_DEF;
      385     5031    1       STATUS = #IN_ALIAS;
      386     5032    1       HASH_SCHEMA_NAME = '1'B;
      387     5033    1       CALL ZIG$HASH_IT(TYPE_300.SET_NAME,#ADD,ERROR_FLG,I,2,14+NUM_SM,
      388     5034    1          TPTR$,STATUS);
      389     5035    1       ALLOCATE_END = 0;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:14   
      390     5036    1       ADDR(SC1.XXDPN) -> WORD36 = ADDR(TPTR$) -> WORD36;
      391     5037        /*
      392     5038              Set the -1 word of the SC record to point to the information
      393     5039            in the hash table so we can get from the schema subset to the
      394     5040            hash table. Warning; the Data base procedures can not be done
      395     5041            until all the sets CF and SM records have been connected up.!!
      396     5042        */
      397     5043    1       TPTR$ -> SET_HASH.REF = TYPE_300.REF_LINE;
      398     5044    1       TPTR$ -> SET_HASH.SUB_OFF = LAST_SC;
      399     5045    1       TPTR$ -> SET_HASH.DBK = SAVE_SC_DBK;
      400     5046    1       TPTR$ -> SET_HASH.SO.DBK = SAVE_SO_DBK;
      401     5047    1       TPTR$ -> SET_HASH.SO.OFFSET = LAST_SO;
      402     5048    1       TPTR$ -> SET_HASH.NUM_SM = NUM_SM;
      403     5049    2       DO I = 0 TO NUM_SM - 1;
      404     5050    2           TPTR$ -> SET_HASH.SM_LIST(I) = LINE_SM(I);
      405     5051    2           END;
      406     5052        /*
      407     5053              Initialize the set in the hash table for fast access and
      408     5054            fast finding of that name.
      409     5055              There can be not dups or errors at this point since we had
      410     5056            a successful subschema translation and we have found the SC
      411     5057            record in the schema file.
      412     5058        */
      413     5059    1       IF NUM_CF ~= 0
      414     5060    2       THEN DO;
      415     5061    2           ALLOCATE_END = 1;
      416     5062    2           CALL ZIG$G_DYN_MEM_6(NUM_CF+2,TPTR$);
      417     5063    2           ALLOCATE_END = 0;
      418     5064    2           TPTR$ -> CF_STR.NPTR$ = CF_PTR$;
      419     5065    2           CF_PTR$ = TPTR$;
      420     5066    2           CF_PTR$ -> CF_STR.COUNT = NUM_CF * 4;
      421     5067    2           CF_PTR$ -> CF_STR.STR= SUBSTR(ADDR(LINE(1000-NUM_CF)) -> STR,0,NUM_CF*4);
      422     5068    2           END;
      423     5069        /*
      424     5070              Creat the structure for searching for the CF record in the
      425     5071            schema subset by the DBK of that CF record.
      426     5072        */
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:15   
      427     5073    1       RETURN;
      428     5074    1   DBCS_ERROR:
      429     5075    1       CALL ABORT;
      430     5076    1   END ZIG$V_SET;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:16   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_SET.

   Procedure ZIG$V_SET requires 761 words for executable code.
   Procedure ZIG$V_SET requires 24 words of local(AUTO) storage.

    No errors detected in file ZIG$V_SET.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:17   

 Object Unit name= ZIG$V_SET                                  File name= ZIG$V_SET.:ZIC0TOU
 UTS= SEP 05 '97 12:24:11.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  SN_DBK
    1  LblCom even  none    12     14  ANALS
    2  LblCom even  none    13     15  PURGE
    3  LblCom even  none    19     23  DICTS
    4  LblCom even  none    23     27  DISPS
    5  LblCom even  none    22     26  VALIDS
    6  LblCom even  none    12     14  LOCKS
    7  LblCom even  none    10     12  STRAN
    8  LblCom even  none    12     14  DTRAN
    9  LblCom even  none    16     20  SSTRANS
   10  LblCom even  none    20     24  SSGEN
   11  LblCom even  none     5      5  LANG_ALLOWED
   12  LblCom even  none     1      1  SUB_LANGUAGE
   13  LblCom even  none    16     20  HEADING_TEXT
   14  LblCom even  none    13     15  LANG_TEXT
   15  LblCom even  none     1      1  HASH_SCHEMA_NAME
   16  LblCom even  none     1      1  CURRENT_RECORD
   17  LblCom even  none    64    100  CONTROL
   18  LblCom even  none    32     40  IO_BUF
   19  LblCom even  none     1      1  NUM_ERROR_MSG
   20  LblCom even  none     1      1  NUM_WARN_MSG
   21  LblCom even  none     1      1  ALLOCATE_END
   22  LblCom even  none     2      2  SUBSCHEMA_KEY
   23  LblCom even  none     1      1  BUFFER$
   24  LblCom even  none     1      1  ERROR_IO
   25  LblCom even  none     1      1  BUFFER_LEN
   26  LblCom even  none     2      2  UWA_KEY
   27  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   28  LblCom even  none     2      2  RVA_KEY
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:18   
   29  LblCom even  none     2      2  IA__KEY
   30  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   31  LblCom even  none    32     40  SEARCHR_NB
   32  LblCom even  none    32     40  SEM_COM
   33  LblCom even  none    32     40  DMCL_XLATE
   34  LblCom even  none    32     40  Q2_PERCENT
   35  LblCom even  none     1      1  SSS$
   36  LblCom even  none     1      1  OA$
   37  LblCom even  none     1      1  OA1$
   38  LblCom even  none     1      1  SC$
   39  LblCom even  none     1      1  SC1$
   40  LblCom even  none     1      1  DP$
   41  LblCom even  none     1      1  DP1$
   42  LblCom even  none     1      1  RS$
   43  LblCom even  none     1      1  SM1$
   44  LblCom even  none     1      1  SS$
   45  LblCom even  none     1      1  CD$
   46  LblCom even  none   656   1220  UWA
   47  LblCom even  none     1      1  CURRENT_OFF
   48   Data  even  none     3      3  ZIG$V_SET
   49  LblCom even  none     1      1  LAST_SC
   50  LblCom even  none    32     40  LIST_STRING
   51  LblCom even  none     1      1  LARGEST_KEY
   52  LblCom even  none  1000   1750  LINE
   53  LblCom even  none     1      1  LAST_RS
   54  LblCom even  none     1      1  LAST_SS
   55  LblCom even  none     1      1  LAST_SM
   56  LblCom even  none     1      1  LAST_SO
   57  LblCom even  none     1      1  LAST_CF
   58  LblCom even  none     1      1  OWNER_CF
   59  LblCom even  none     1      1  CF_PTR$
   60  RoData even  UTS     16     20  ZIG$V_SET
   61   Proc  even  none   761   1371  ZIG$V_SET
   62  RoData even  none    58     72  ZIG$V_SET
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:19   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    61      0   yes            yes      Std        0  ZIG$V_SET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 SRCHD
         yes           Std       3 SET_FIELDS
         yes           Std       0 ZIG$ADD_SI
 yes     yes           Std       1 FETCHNS_6
         yes           Std       8 ZIG$HASH_IT
         yes           Std       2 WRITSF
         yes           Std       1 ERROR
         yes           Std       2 ZIG$G_DYN_MEM_6
         yes           Std       0 ABORT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:20   


        1        1        /*M*     ZIG$V_SET      I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_SET
        9        9        PURPOSE:
       10       10              To read all the type 300 descriptors and write out all the
       11       11            SC record for any set in the subschema DDL text.
       12       12
       13       13        */
       14       14        /*
       15       15        ZZZZZ  III   GGG    $   V   V        SSS  EEEEE TTTTT
       16       16            Z   I   G   G  $$$  V   V       S   S E       T
       17       17           Z    I   G     $ $   V   V       S     E       T
       18       18          Z     I   G      $$$  V   V        SSS  EEEE    T
       19       19         Z      I   G  GG   $ $ V   V           S E       T
       20       20        Z       I   G   G  $$$   V V        S   S E       T
       21       21        ZZZZZ  III   GGG    $     V          SSS  EEEEE   T
       22       22                                      _____
       23       23        */
       24       24        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:21   
       25       25        ZIG$V_SET:
       26       26            PROC;

     26 61 000000   000000 700200 xent  ZIG$V_SET    TSX0  ! X66_AUTO_0
        61 000001   000030 000000                    ZERO    24,0
        61 000002   000115 710000 61                 TRA     s:4777

       27       27    1   DCL ZIG$HASH_IT ENTRY (8);
       28       28    1   DCL WRITSF ENTRY (2);
       29       29    1   DCL ZIG$ADD_SI ENTRY;
       30       30    1   DCL SN_DBK UBIN (36) EXT;
       31       31        %INCLUDE ZI_ERRORS_SUBS;
       32      551        %INCLUDE ZI_SUB_LANG;
       33     2266        %INCLUDE ZIG_DIR_STRUCS;
       34     2396        %GENERAL;
       35     2520        %CONTROL_BLOCK;
       36     2628    1   DCL IO_BUF CHAR (128) EXT;
       37     2629        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       38     2698        %INCLUDE ZIG_GENERAL;
       39     2806        %INCLUDE ZIG_TYPE_SUBS;
       40     2821        %INCLUDE ZIG_SSS;
       41     3391        %SS_GENERAL(PSTCLASS=EXT);
       42     3412        %OA(PSTCLASS=EXT);
       43     3479        %OA1(PSTCLASS=EXT);
       44     3487        %SC(PSTCLASS=EXT);
       45     3514        %SC1(PSTCLASS=EXT);
       46     3524        %DP(PSTCLASS=EXT);
       47     3538        %DP1(PSTCLASS=EXT);
       48     3546        %RS(PSTCLASS=EXT);
       49     3620        %SM1(PSTCLASS=EXT);
       50     3628        %SS(PSTCLASS=EXT);
       51     3642        %CD(PSTCLASS=EXT);
       52     3661        %INCLUDE ZIG_DBA_INT;
       53     3709        %INCLUDE ZI_SUB4_CAN;
       54     4366        %UWA;
       55     4701        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:22   
       56     4702    1   DCL I UBIN (36);
       57     4703    1   DCL TPTR$ PTR;
       58     4704    1   DCL L_SUBSCH_SC UBIN (36);
       59     4705    1   DCL SUCC BIT (1);
       60     4706    1   DCL CURRENT_OFF UBIN (36) EXT;
       61     4707    1   DCL STATUS UBIN (6);
       62     4708    1   DCL ERROR_FLG UBIN (36) STATIC;
       63     4709    1   DCL LAST_SC UBIN (18) EXT;
       64     4710    1   DCL LIST_STRING CHAR (128) EXT;
       65     4711    1   DCL LARGEST_KEY UBIN (36) EXT;
       66     4712    1   DCL NUM_CF UBIN (36);
       67     4713    1   DCL NUM_SM UBIN (36);
       68     4714    1   DCL 1 LINE(0:999) EXT,
       69     4715    1         2 DBK UBIN (18) UNAL,
       70     4716    1         2 OFFSET UBIN (18) UNAL;
       71     4717    1   DCL 1 LINE_SM(0:999) REDEF LINE,
       72     4718    1         2 DBK SBIN (19) UNAL,
       73     4719    1         2 OFFSET UBIN (17) UNAL;
       74     4720        /*D*     NAME:     LINE
       75     4721              This array is what is used in other overlay levels to
       76     4722            hold the string that X$PARSE uses to parse things, and
       77     4723            to hold the list of CF and SM records for each SC record
       78     4724            so they can be put in the SC record in the in the hash
       79     4725            table.
       80     4726            Note:
       81     4727                 The limit is 1000 CF + SM records for any set.
       82     4728        */
       83     4729    1   DCL LAST_RS UBIN (36) EXT;
       84     4730    1   DCL SAVE_SC_DBK UBIN (36) STATIC;
       85     4731    1   DCL SAVE_SO_DBK UBIN (36) STATIC;
       86     4732    1   DCL WORD36 UBIN (36) BASED;
       87     4733    1   DCL LAST_SS UBIN (18) EXT;
       88     4734    1   DCL LAST_SM UBIN (18) EXT;
       89     4735    1   DCL LAST_SO UBIN (18) EXT;
       90     4736    1   DCL LAST_CF UBIN (18) EXT;
       91     4737    1   DCL OWNER_CF UBIN (18) EXT;
       92     4738    1   DCL CF_PTR$ PTR EXT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:23   
       93     4739    1   DCL 1 CF_STR BASED,
       94     4740    1         2 NPTR$ PTR,
       95     4741    1         2 COUNT UBIN (36),
       96     4742    1         2 STR CHAR (CF_STR.COUNT);
       97     4743    1   DCL STR CHAR (4000) BASED;
       98     4744        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:24   
       99     4745    1   FIND_LENGTH:

   4745 61 000003   200012 741300       FIND_LENGTH  STX1  ! NUM_SM+1,,AUTO

      100     4746    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      101     4747    2   DCL RETURN_LENGTH UBIN (36);
      102     4748    2   DCL STRING_TO_GET CHAR (30);
      103     4749    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);

   4749 61 000004   200014 470500                    LDP0    @RETURN_LENGTH,,AUTO
        61 000005   200013 471500                    LDP1    @STRING_TO_GET,,AUTO
        61 000006   000000 124500                    SCM     mask='000'O
        61 000007   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        61 000010   000000 000001 62                 ADSC9   0                        cn=0,n=1
        61 000011   000000 000100                    ARG     0,,PR0
        61 000012   000015 606400 61                 TTN     NOT_BLANK

      104     4750    2       RETURN;

   4750 61 000013   200012 221300                    LDX1  ! NUM_SM+1,,AUTO
        61 000014   000001 702211                    TSX2  ! 1,X1

      105     4751    2   NOT_BLANK:
      106     4752    2       RETURN_LENGTH = 30;

   4752 61 000015   000036 235007       NOT_BLANK    LDA     30,DL
        61 000016   200014 470500                    LDP0    @RETURN_LENGTH,,AUTO
        61 000017   000000 755100                    STA     0,,PR0

      107     4753    2       RETURN;

   4753 61 000020   200012 221300                    LDX1  ! NUM_SM+1,,AUTO
        61 000021   000001 702211                    TSX2  ! 1,X1

      108     4754    2   END FIND_LENGTH;
      109     4755        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:25   
      110     4756    1   ADD_CF:

   4756 61 000022   200012 741300       ADD_CF       STX1  ! NUM_SM+1,,AUTO

      111     4757    1       PROC;
      112     4758    2       CALL ZIG$G_DYN_MEM_6(%CD_BASE_SIZE,CD$);

   4758 61 000023   000003 630400 62                 EPPR0   3
        61 000024   000001 631400 62                 EPPR1   1
        61 000025   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000026   000000 011000                    NOP     0

      113     4759    2       CD.DEF.TYPE = '000000000100'B;

   4759 61 000027   000000 470400 45                 LDP0    CD$
        61 000030   000400 236003                    LDQ     256,DU
        61 000031   000000 752160                    STCQ    0,'60'O,PR0

      114     4760    2       IF UWA.C_F.SYN = 1

   4760 61 000032   000400 235000 46                 LDA     UWA+256
        61 000033   000001 115007                    CMPA    1,DL
        61 000034   000040 601000 61                 TNZ     s:4762

      115     4761    2       THEN CD.DEF.SYNC = '1'B;

   4761 61 000035   000000 470400 45                 LDP0    CD$
        61 000036   000040 236003                    LDQ     32,DU
        61 000037   000000 256100                    ORSQ    0,,PR0

      116     4762    2       IF UWA.C_F.CTRLSEQ = 1

   4762 61 000040   000403 235000 46                 LDA     UWA+259
        61 000041   000001 115007                    CMPA    1,DL
        61 000042   000046 601000 61                 TNZ     s:4764

      117     4763    2       THEN CD.DEF.CONT = '1'B;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:26   

   4763 61 000043   000000 470400 45                 LDP0    CD$
        61 000044   000020 236003                    LDQ     16,DU
        61 000045   000000 256100                    ORSQ    0,,PR0

      118     4764    2       CD.DEF.RELT = UWA.C_F.CTRLTYPE;

   4764 61 000046   000000 470400 45                 LDP0    CD$
        61 000047   000401 236000 46                 LDQ     UWA+257
        61 000050   000022 736000                    QLS     18
        61 000051   000000 676100                    ERQ     0,,PR0
        61 000052   000017 376003                    ANQ     15,DU
        61 000053   000000 656100                    ERSQ    0,,PR0

      119     4765    2       CD.RSCDH = OWNER_CF;

   4765 61 000054   000000 220000 58                 LDX0    OWNER_CF
        61 000055   000000 470400 45                 LDP0    CD$
        61 000056   000001 440100                    SXL0    1,,PR0

      120     4766    2       TPTR$ = PINCRW(SSS$,LAST_CF);

   4766 61 000057   000000 236000 57                 LDQ     LAST_CF
        61 000060   777777 376003                    ANQ     -1,DU
        61 000061   000000 036000 35                 ADLQ    SSS$
        61 000062   200004 756100                    STQ     TPTR$,,AUTO

      121     4767    2       CURRENT_OFF = POFFW(CD$,SSS$);

   4767 61 000063   000000 235000 35                 LDA     SSS$
        61 000064   000022 771000                    ARL     18
        61 000065   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 000066   000000 236000 45                 LDQ     CD$
        61 000067   000022 772000                    QRL     18
        61 000070   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 000071   000000 756000 47                 STQ     CURRENT_OFF

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:27   
      122     4768    2       CD.RSCDN = TPTR$ -> CD.RSCDN;

   4768 61 000072   200004 471500                    LDP1    TPTR$,,AUTO
        61 000073   100001 221100                    LDX1    1,,PR1
        61 000074   000001 741100                    STX1    1,,PR0

      123     4769    2       TPTR$ -> CD.RSCDN = CURRENT_OFF;

   4769 61 000075   000000 622006                    EAX2    0,QL
        61 000076   200004 471500                    LDP1    TPTR$,,AUTO
        61 000077   100001 742100                    STX2    1,,PR1

      124     4770    2       LAST_CF = CURRENT_OFF;

   4770 61 000100   000000 721000 47                 LXL1    CURRENT_OFF
        61 000101   000000 741000 57                 STX1    LAST_CF

      125     4771    2       LINE.DBK(999-NUM_CF) = UWA.DIRECT_REF;

   4771 61 000102   200010 722100                    LXL2    NUM_CF,,AUTO
        61 000103   777777 622012                    EAX2    -1,X2
        61 000104   777777 662003                    ERX2    -1,DU
        61 000105   000036 723000 46                 LXL3    UWA+30
        61 000106   001747 743012 52                 STX3    LINE+999,X2

      126     4772    2       LINE.OFFSET(999-NUM_CF) = CURRENT_OFF;

   4772 61 000107   001747 441012 52                 SXL1    LINE+999,X2

      127     4773    2       NUM_CF = NUM_CF + 1;

   4773 61 000110   200010 236100                    LDQ     NUM_CF,,AUTO
        61 000111   000001 036007                    ADLQ    1,DL
        61 000112   200010 756100                    STQ     NUM_CF,,AUTO

      128     4774    2       RETURN;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:28   
   4774 61 000113   200012 221300                    LDX1  ! NUM_SM+1,,AUTO
        61 000114   000001 702211                    TSX2  ! 1,X1

      129     4775    2   END ADD_CF;
      130     4776        %EJECT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:29   
      131     4777    1       CALL FIND_LENGTH(TYPE_300.SUB_SET_NAME,L_SUBSCH_SC);

   4777 61 000115   200005 630500                    EPPR0   L_SUBSCH_SC,,AUTO
        61 000116   200014 450500                    STP0    @STRING_TO_GET+1,,AUTO
        61 000117   000005 236000 62                 LDQ     5
        61 000120   200013 756100                    STQ     NUM_SM+2,,AUTO
        61 000121   000003 701000 61                 TSX1    FIND_LENGTH
        61 000122   000000 011000                    NOP     0

      132     4778    1       ALLOCATE_END = 0; /* Allocate a start of mem */

   4778 61 000123   000000 450000 21                 STZ     ALLOCATE_END

      133     4779    1       IF TYPE_300.TYPE = 300

   4779 61 000124   000000 235000 18                 LDA     IO_BUF
        61 000125   000454 115007                    CMPA    300,DL
        61 000126   000140 601000 61                 TNZ     s:4784

      134     4780    2       THEN DO;

      135     4781    2           CALL SRCHD(TYPE_300.SET_NAME,%ZIG_RTYPE_SC,SUCC);

   4781 61 000127   200006 630500                    EPPR0   SUCC,,AUTO
        61 000130   200020 450500                    STP0    @RETURN_LENGTH+4,,AUTO
        61 000131   000010 237000 62                 LDAQ    8
        61 000132   200016 757100                    STAQ    @RETURN_LENGTH+2,,AUTO
        61 000133   200016 630500                    EPPR0   @RETURN_LENGTH+2,,AUTO
        61 000134   000006 631400 62                 EPPR1   6
        61 000135   000000 701000 xent               TSX1    SRCHD
        61 000136   000000 011000                    NOP     0

      136     4782    2           END;

   4782 61 000137   000150 710000 61                 TRA     s:4786

      137     4783    2       ELSE DO;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:30   

      138     4784    2           CALL SRCHD(TYPE_300.SET_NAME,%ZIG_RTYPE_KC,SUCC);

   4784 61 000140   200006 630500                    EPPR0   SUCC,,AUTO
        61 000141   200020 450500                    STP0    @RETURN_LENGTH+4,,AUTO
        61 000142   000014 237000 62                 LDAQ    12
        61 000143   200016 757100                    STAQ    @RETURN_LENGTH+2,,AUTO
        61 000144   200016 630500                    EPPR0   @RETURN_LENGTH+2,,AUTO
        61 000145   000006 631400 62                 EPPR1   6
        61 000146   000000 701000 xent               TSX1    SRCHD
        61 000147   000000 011000                    NOP     0

      139     4785    2           END;

      140     4786    1       IF ~SUCC

   4786 61 000150   200006 236100                    LDQ     SUCC,,AUTO
        61 000151   400000 376003                    ANQ     -131072,DU
        61 000152   400000 676003                    ERQ     -131072,DU
        61 000153   000165 600000 61                 TZE     s:4795

      141     4787    2       THEN DO;

      142     4788    2           CALL SET_FIELDS(1,30,TYPE_300.SET_NAME);

   4788 61 000154   000016 630400 62                 EPPR0   14
        61 000155   000006 631400 62                 EPPR1   6
        61 000156   000000 701000 xent               TSX1    SET_FIELDS
        61 000157   000000 011000                    NOP     0

      143     4789    2           CALL ERROR(%ZIG_V_SET_NAME);

   4789 61 000160   000023 630400 62                 EPPR0   19
        61 000161   000021 631400 62                 EPPR1   17
        61 000162   000000 701000 xent               TSX1    ERROR
        61 000163   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:31   
      144     4790        /*E*     ERROR:    ZIG-ZIG_V_SET_NAME-C
      145     4791        MESSAGE: The set "%U1" is not present in the schema file.
      146     4792        */
      147     4793    2           RETURN;

   4793 61 000164   000000 702200 xent               TSX2  ! X66_ARET

      148     4794    2           END;
      149     4795    1       IF TYPE_300.REF_LINE ~= 0

   4795 61 000165   000001 235000 18                 LDA     IO_BUF+1
        61 000166   000174 600000 61                 TZE     s:4800

      150     4796    2       THEN DO;

      151     4797    2           SN_DBK = UWA.DIRECT_REF;

   4797 61 000167   000036 236000 46                 LDQ     UWA+30
        61 000170   000000 756000 0                  STQ     SN_DBK

      152     4798    2           CALL ZIG$ADD_SI;

   4798 61 000171   000024 631400 62                 EPPR1   20
        61 000172   000000 701000 xent               TSX1    ZIG$ADD_SI
        61 000173   000000 011000                    NOP     0

      153     4799    2           END;

      154     4800    1       CALL FETCHNS_6('SN-SE   ') ALTRET (DBCS_ERROR);

   4800 61 000174   000025 630400 62                 EPPR0   21
        61 000175   000021 631400 62                 EPPR1   17
        61 000176   000000 701000 xent               TSX1    FETCHNS_6
        61 000177   001365 702000 61                 TSX2    DBCS_ERROR

      155     4801    1       IF UWA.SC.SETTYPE = 2 OR UWA.SC.SETTYPE = 3

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:32   
   4801 61 000200   000310 235000 46                 LDA     UWA+200
        61 000201   000002 115007                    CMPA    2,DL
        61 000202   000205 600000 61                 TZE     s:4803
        61 000203   000003 115007                    CMPA    3,DL
        61 000204   000212 601000 61                 TNZ     s:4806

      156     4802    2       THEN DO;

      157     4803    2           CALL ZIG$G_DYN_MEM_6(2,SC1$);

   4803 61 000205   000027 630400 62                 EPPR0   23
        61 000206   000001 631400 62                 EPPR1   1
        61 000207   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000210   000000 011000                    NOP     0

      158     4804    2           END;

   4804 61 000211   000225 710000 61                 TRA     s:4809

      159     4805    2       ELSE DO;

      160     4806    2           CALL ZIG$G_DYN_MEM_6(1,TPTR$);

   4806 61 000212   200004 630500                    EPPR0   TPTR$,,AUTO
        61 000213   200017 450500                    STP0    @RETURN_LENGTH+3,,AUTO
        61 000214   000016 236000 62                 LDQ     14
        61 000215   200016 756100                    STQ     @RETURN_LENGTH+2,,AUTO
        61 000216   200016 630500                    EPPR0   @RETURN_LENGTH+2,,AUTO
        61 000217   000001 631400 62                 EPPR1   1
        61 000220   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000221   000000 011000                    NOP     0

      161     4807    2           SC1$ = PINCRW(TPTR$,-1);

   4807 61 000222   200004 236100                    LDQ     TPTR$,,AUTO
        61 000223   777777 036003                    ADLQ    -1,DU
        61 000224   000000 756000 39                 STQ     SC1$
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:33   

      162     4808    2           END;

      163     4809    1       CALL ZIG$G_DYN_MEM_6(%SC_BASE_SIZE+(L_SUBSCH_SC+3)/4,SC$);

   4809 61 000225   200005 236100                    LDQ     L_SUBSCH_SC,,AUTO
        61 000226   000003 036007                    ADLQ    3,DL
        61 000227   000002 772000                    QRL     2
        61 000230   000003 036007                    ADLQ    3,DL
        61 000231   200016 756100                    STQ     @RETURN_LENGTH+2,,AUTO
        61 000232   000031 236000 62                 LDQ     25
        61 000233   200021 756100                    STQ     @RETURN_LENGTH+5,,AUTO
        61 000234   200016 630500                    EPPR0   @RETURN_LENGTH+2,,AUTO
        61 000235   200020 450500                    STP0    @RETURN_LENGTH+4,,AUTO
        61 000236   200020 630500                    EPPR0   @RETURN_LENGTH+4,,AUTO
        61 000237   000001 631400 62                 EPPR1   1
        61 000240   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000241   000000 011000                    NOP     0

      164     4810        /*
      165     4811              SC size = number of words in subschema set name
      166     4812                      + constant (3).
      167     4813        */
      168     4814    1       CURRENT_OFF = POFFW(SC$,SSS$);

   4814 61 000242   000000 235000 35                 LDA     SSS$
        61 000243   000022 771000                    ARL     18
        61 000244   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 000245   000000 236000 38                 LDQ     SC$
        61 000246   000022 772000                    QRL     18
        61 000247   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 000250   000000 756000 47                 STQ     CURRENT_OFF

      169     4815    1       SAVE_SC_DBK = UWA.DIRECT_REF;

   4815 61 000251   000036 235000 46                 LDA     UWA+30
        61 000252   000001 755000 48                 STA     SAVE_SC_DBK
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:34   

      170     4816    1       IF TYPE_300.SET_NAME = '*CALC'

   4816 61 000253   040000 106400                    CMPC    fill='040'O
        61 000254   000003 000036 18                 ADSC9   IO_BUF+3                 cn=0,n=30
        61 000255   000002 000005 60                 ADSC9   2                        cn=0,n=5
        61 000256   000262 601000 61                 TNZ     s:4830

      171     4817    1       THEN OA.CLCSC = CURRENT_OFF;

   4817 61 000257   000000 620006                    EAX0    0,QL
        61 000260   000000 470400 36                 LDP0    OA$
        61 000261   000003 740100                    STX0    3,,PR0

      172     4818        /*
      173     4819              Put the offset to the calc set in the OA record for
      174     4820            IDS to find the calc set fast.
      175     4821        */
      176     4822        /*
      177     4823              Now initialize the OA record in the schema subset and
      178     4824            connect it up to the OA-SC set.
      179     4825
      180     4826            Note:
      181     4827                 The OA record allways starts a offset of 1 from SSS$
      182     4828               and OA$ always points to the only OA record.
      183     4829        */
      184     4830    1       TPTR$ = PINCRW(SSS$,LAST_SC);

   4830 61 000262   000000 236000 49                 LDQ     LAST_SC
        61 000263   777777 376003                    ANQ     -1,DU
        61 000264   000000 036000 35                 ADLQ    SSS$
        61 000265   200004 756100                    STQ     TPTR$,,AUTO

      185     4831    1       SC.OASCN = TPTR$ -> SC.OASCN;

   4831 61 000266   200004 470500                    LDP0    TPTR$,,AUTO
        61 000267   000001 720100                    LXL0    1,,PR0
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:35   
        61 000270   000000 471400 38                 LDP1    SC$
        61 000271   100001 440100                    SXL0    1,,PR1

      186     4832    1       TPTR$ -> SC.OASCN = CURRENT_OFF;

   4832 61 000272   000000 721000 47                 LXL1    CURRENT_OFF
        61 000273   200004 470500                    LDP0    TPTR$,,AUTO
        61 000274   000001 441100                    SXL1    1,,PR0

      187     4833    1       LAST_SC = CURRENT_OFF;

   4833 61 000275   000000 741000 49                 STX1    LAST_SC

      188     4834    1       SC.DEF.TYPE = '000100000000'B;

   4834 61 000276   040000 236003                    LDQ     16384,DU
        61 000277   100000 752160                    STCQ    0,'60'O,PR1

      189     4835    1       SC.DEF.SETM = UWA.SC.SETMODE;

   4835 61 000300   000000 470400 38                 LDP0    SC$
        61 000301   000311 236000 46                 LDQ     UWA+201
        61 000302   000025 736000                    QLS     21
        61 000303   000000 676100                    ERQ     0,,PR0
        61 000304   000070 376003                    ANQ     56,DU
        61 000305   000000 656100                    ERSQ    0,,PR0

      190     4836    1       SC.DEF.SETO = UWA.SC.SETORD;

   4836 61 000306   000000 470400 38                 LDP0    SC$
        61 000307   000312 236000 46                 LDQ     UWA+202
        61 000310   000016 736000                    QLS     14
        61 000311   000000 676100                    ERQ     0,,PR0
        61 000312   740000 376007                    ANQ     -16384,DL
        61 000313   000000 656100                    ERSQ    0,,PR0

      191     4837    1       IF TYPE_300.REF_LINE ~= 0 THEN
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:36   

   4837 61 000314   000001 236000 18                 LDQ     IO_BUF+1
        61 000315   000321 600000 61                 TZE     s:4840

      192     4838    1           UWA.SC.RECSET = 1;

   4838 61 000316   000001 235007                    LDA     1,DL
        61 000317   000317 755000 46                 STA     UWA+207
        61 000320   000326 710000 61                 TRA     s:4842

      193     4839    1       ELSE
      194     4840    1           IF UWA.SC.RECSET = 0 THEN

   4840 61 000321   000317 235000 46                 LDA     UWA+207
        61 000322   000326 601000 61                 TNZ     s:4842

      195     4841    1               SC.DEF.SRCR = '1'B;

   4841 61 000323   000000 470400 38                 LDP0    SC$
        61 000324   004000 236007                    LDQ     2048,DL
        61 000325   000000 256100                    ORSQ    0,,PR0

      196     4842    1       IF UWA.SC.ALTOWN = 1

   4842 61 000326   000316 235000 46                 LDA     UWA+206
        61 000327   000001 115007                    CMPA    1,DL
        61 000330   000334 601000 61                 TNZ     s:4844

      197     4843    1       THEN SC.DEF.ALTO = '1'B;

   4843 61 000331   000000 470400 38                 LDP0    SC$
        61 000332   002000 236007                    LDQ     1024,DL
        61 000333   000000 256100                    ORSQ    0,,PR0

      198     4844    1       IF UWA.SC.SETGLO = 1

   4844 61 000334   000313 235000 46                 LDA     UWA+203
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:37   
        61 000335   000001 115007                    CMPA    1,DL
        61 000336   000342 601000 61                 TNZ     s:4846

      199     4845    1       THEN SC.DEF.LG = '1'B;

   4845 61 000337   000000 470400 38                 LDP0    SC$
        61 000340   001000 236007                    LDQ     512,DL
        61 000341   000000 256100                    ORSQ    0,,PR0

      200     4846    1       SC.DEF.SETT = UWA.SC.SETTYPE;

   4846 61 000342   000000 470400 38                 LDP0    SC$
        61 000343   000310 236000 46                 LDQ     UWA+200
        61 000344   000006 736000                    QLS     6
        61 000345   000000 676100                    ERQ     0,,PR0
        61 000346   000700 376007                    ANQ     448,DL
        61 000347   000000 656100                    ERSQ    0,,PR0

      201     4847    1       SC.DEF.SNL = L_SUBSCH_SC;

   4847 61 000350   000000 470400 38                 LDP0    SC$
        61 000351   200005 236100                    LDQ     L_SUBSCH_SC,,AUTO
        61 000352   000000 752101                    STCQ    0,'01'O,PR0

      202     4848    1       SC.SCWSO = OA.CSZ + %CUR_BASE_SIZE;

   4848 61 000353   000000 470400 36                 LDP0    OA$
        61 000354   000017 220100                    LDX0    15,,PR0
        61 000355   001223 621010                    EAX1    659,X0
        61 000356   000000 471400 38                 LDP1    SC$
        61 000357   100001 741100                    STX1    1,,PR1

      203     4849    1       IF SC.DEF.SETM = 2

   4849 61 000360   100000 236100                    LDQ     0,,PR1
        61 000361   000070 376003                    ANQ     56,DU
        61 000362   000020 116003                    CMPQ    16,DU
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:38   
        61 000363   000404 601000 61                 TNZ     s:4858

      204     4850    2       THEN DO;

      205     4851    2           OA.CSZ = OA.CSZ + 4;

   4851 61 000364   000017 220100                    LDX0    15,,PR0
        61 000365   000004 622010                    EAX2    4,X0
        61 000366   000017 742100                    STX2    15,,PR0

      206     4852    2           IF LARGEST_KEY < UWA.SC.KEY_LENGTH

   4852 61 000367   000000 236000 51                 LDQ     LARGEST_KEY
        61 000370   000375 604000 61                 TMI     s:4854
        61 000371   000324 116000 46                 CMPQ    UWA+212
        61 000372   000375 605000 61                 TPL     s:4854

      207     4853    2           THEN LARGEST_KEY = UWA.SC.KEY_LENGTH;

   4853 61 000373   000324 235000 46                 LDA     UWA+212
        61 000374   000000 755000 51                 STA     LARGEST_KEY

      208     4854    2           IF UWA.SC.KEY_LENGTH > OA.LPASZ

   4854 61 000375   000023 236100                    LDQ     19,,PR0
        61 000376   000022 772000                    QRL     18
        61 000377   000324 116000 46                 CMPQ    UWA+212
        61 000400   000446 605000 61                 TPL     s:4874

      209     4855    2           THEN OA.LPASZ = UWA.SC.KEY_LENGTH;

   4855 61 000401   000324 720000 46                 LXL0    UWA+212
        61 000402   000023 740100                    STX0    19,,PR0

      210     4856    2           END;

   4856 61 000403   000446 710000 61                 TRA     s:4874
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:39   

      211     4857    2       ELSE DO;

      212     4858    2           IF SC.DEF.SETT = 2 OR SC.DEF.SETT = 3

   4858 61 000404   100000 236100                    LDQ     0,,PR1
        61 000405   000700 376007                    ANQ     448,DL
        61 000406   000200 116007                    CMPQ    128,DL
        61 000407   000412 600000 61                 TZE     s:4860
        61 000410   000300 116007                    CMPQ    192,DL
        61 000411   000443 601000 61                 TNZ     s:4867

      213     4859    3           THEN DO;

      214     4860    3               SC1.KLNG = UWA.SC.KEY_LENGTH;

   4860 61 000412   000324 720000 46                 LXL0    UWA+212
        61 000413   000000 473400 39                 LDP3    SC1$
        61 000414   300000 440100                    SXL0    0,,PR3

      215     4861    3               SC1.IXID = UWA.SC.INDEX_ID;

   4861 61 000415   000323 720000 46                 LXL0    UWA+211
        61 000416   000000 470400 39                 LDP0    SC1$
        61 000417   000000 740100                    STX0    0,,PR0

      216     4862    3               OA.CSZ = OA.CSZ + 2 + (UWA.SC.KEY_LENGTH +1+2+4+3)/4;

   4862 61 000420   000324 236000 46                 LDQ     UWA+212
        61 000421   000012 036007                    ADLQ    10,DL
        61 000422   000004 506007                    DIV     4,DL
        61 000423   000000 470400 36                 LDP0    OA$
        61 000424   200016 756100                    STQ     @RETURN_LENGTH+2,,AUTO
        61 000425   000017 236100                    LDQ     15,,PR0
        61 000426   000022 772000                    QRL     18
        61 000427   200017 756100                    STQ     @RETURN_LENGTH+3,,AUTO
        61 000430   200016 236100                    LDQ     @RETURN_LENGTH+2,,AUTO
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:40   
        61 000431   200017 036100                    ADLQ    @RETURN_LENGTH+3,,AUTO
        61 000432   000002 620006                    EAX0    2,QL
        61 000433   000017 740100                    STX0    15,,PR0

      217     4863    3               IF LARGEST_KEY < UWA.SC.KEY_LENGTH

   4863 61 000434   000000 236000 51                 LDQ     LARGEST_KEY
        61 000435   000446 604000 61                 TMI     s:4874
        61 000436   000324 116000 46                 CMPQ    UWA+212
        61 000437   000446 605000 61                 TPL     s:4874

      218     4864    3               THEN LARGEST_KEY = UWA.SC.KEY_LENGTH;

   4864 61 000440   000324 235000 46                 LDA     UWA+212
        61 000441   000000 755000 51                 STA     LARGEST_KEY

      219     4865    3               END;

   4865 61 000442   000446 710000 61                 TRA     s:4874

      220     4866    3           ELSE DO;

      221     4867    3               OA.CSZ = OA.CSZ + 2;

   4867 61 000443   000017 220100                    LDX0    15,,PR0
        61 000444   000002 622010                    EAX2    2,X0
        61 000445   000017 742100                    STX2    15,,PR0

      222     4868    3               END;

      223     4869    2           END;

      224     4870        /*
      225     4871              Modify the type 300 type descriptors for the set or the key
      226     4872            that this SC is for. If type_300.ref_line ~= 0;
      227     4873        */
      228     4874    1       IF TYPE_300.REF_LINE ~= 0
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:41   

   4874 61 000446   000001 235000 18                 LDA     IO_BUF+1
        61 000447   000472 600000 61                 TZE     s:4882

      229     4875    2       THEN DO;

      230     4876    2           IF UWA.SC.SETORD = 4

   4876 61 000450   000312 236000 46                 LDQ     UWA+202
        61 000451   000004 116007                    CMPQ    4,DL
        61 000452   000461 601000 61                 TNZ     s:4878

      231     4877    2           THEN TYPE_300.SORT_KEY_ORDER = UWA.SC.SEQDUP;

   4877 61 000453   000320 236000 46                 LDQ     UWA+208
        61 000454   000041 736000                    QLS     33
        61 000455   000025 676000 18                 ERQ     IO_BUF+21
        61 000456   300000 376003                    ANQ     98304,DU
        61 000457   000025 656000 18                 ERSQ    IO_BUF+21
        61 000460   000463 710000 61                 TRA     s:4879

      232     4878    2           ELSE TYPE_300.SORT_KEY_ORDER = 0;

   4878 61 000461   000032 236000 62                 LDQ     26
        61 000462   000025 356000 18                 ANSQ    IO_BUF+21

      233     4879    2           TYPE_300.INFO = SC.DEF;

   4879 61 000463   000000 471400 38                 LDP1    SC$
        61 000464   100000 236100                    LDQ     0,,PR1
        61 000465   000024 756000 18                 STQ     IO_BUF+20

      234     4880    2           CALL WRITSF(CURRENT_RECORD,IO_BUF);

   4880 61 000466   000033 630400 62                 EPPR0   27
        61 000467   000001 631400 62                 EPPR1   1
        61 000470   000000 701000 xent               TSX1    WRITSF
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:42   
        61 000471   000000 011000                    NOP     0

      235     4881    2           END;

      236     4882    1       SC.SCID = TYPE_300.ID_NUM;

   4882 61 000472   000023 720000 18                 LXL0    IO_BUF+19
        61 000473   000000 470400 38                 LDP0    SC$
        61 000474   000002 440100                    SXL0    2,,PR0

      237     4883    1       SC.SNAM = TYPE_300.SUB_SET_NAME;

   4883 61 000475   000000 721100                    LXL1    0,,PR0
        61 000476   000077 361003                    ANX1    63,DU
        61 000477   040140 100400                    MLR     fill='040'O
        61 000500   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        61 000501   000003 000011                    ADSC9   3,,PR0                   cn=0,n=*X1

      238     4884        /*
      239     4885              Init all the SO and SM records for this set.
      240     4886            Then do all the SS and CF records for each SM record.
      241     4887        */
      242     4888    1       CALL FETCHNS_6('SC-SOSM ') ALTRET(DBCS_ERROR);

   4888 61 000502   000035 630400 62                 EPPR0   29
        61 000503   000021 631400 62                 EPPR1   17
        61 000504   000000 701000 xent               TSX1    FETCHNS_6
        61 000505   001365 702000 61                 TSX2    DBCS_ERROR

      243     4889    1       IF UWA.RECORD_NAME ~= 'SO '

   4889 61 000506   040000 106400                    CMPC    fill='040'O
        61 000507   000023 000036 46                 ADSC9   UWA+19                   cn=0,n=30
        61 000510   000006 000003 60                 ADSC9   6                        cn=0,n=3
        61 000511   000525 600000 61                 TZE     s:4900

      244     4890    2       THEN DO;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:43   

      245     4891    2           CALL SET_FIELDS(1,30,UWA.RECORD_NAME);

   4891 61 000512   000036 630400 62                 EPPR0   30
        61 000513   000006 631400 62                 EPPR1   6
        61 000514   000000 701000 xent               TSX1    SET_FIELDS
        61 000515   000000 011000                    NOP     0

      246     4892    2           CALL ERROR(%ZIG_RECORD_NOT_SO);

   4892 61 000516   000042 630400 62                 EPPR0   34
        61 000517   000021 631400 62                 EPPR1   17
        61 000520   000000 701000 xent               TSX1    ERROR
        61 000521   000000 011000                    NOP     0

      247     4893    2           CALL ABORT;

   4893 61 000522   000024 631400 62                 EPPR1   20
        61 000523   000000 701000 xent               TSX1    ABORT
        61 000524   000000 011000                    NOP     0

      248     4894        /*E*     ERROR:    ZIG-ZIG_RECORD_NOT_SO-C
      249     4895        MESSAGE: The record "%U1" was found, not the SO record
      250     4896                 in the schema file.
      251     4897                 <<<< SOFTWARE ERROR >>>>
      252     4898        */
      253     4899    2           END;

      254     4900    1       SAVE_SO_DBK = UWA.DIRECT_REF;

   4900 61 000525   000036 235000 46                 LDA     UWA+30
        61 000526   000002 755000 48                 STA     SAVE_SO_DBK

      255     4901    1       CALL ZIG$G_DYN_MEM_6(%SO_BASE_SIZE,RS$);

   4901 61 000527   000044 630400 62                 EPPR0   36
        61 000530   000001 631400 62                 EPPR1   1
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:44   
        61 000531   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000532   000000 011000                    NOP     0

      256     4902    1       RS.DEF.TYPE = '000001000000'B;

   4902 61 000533   000000 470400 42                 LDP0    RS$
        61 000534   010000 236003                    LDQ     4096,DU
        61 000535   000000 752160                    STCQ    0,'60'O,PR0

      257     4903    1       CURRENT_OFF = POFFW(RS$,SSS$);

   4903 61 000536   000000 235000 35                 LDA     SSS$
        61 000537   000022 771000                    ARL     18
        61 000540   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 000541   000000 236000 42                 LDQ     RS$
        61 000542   000022 772000                    QRL     18
        61 000543   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 000544   000000 756000 47                 STQ     CURRENT_OFF

      258     4904    1       SC.SCRSN = CURRENT_OFF;

   4904 61 000545   000000 620006                    EAX0    0,QL
        61 000546   000000 470400 38                 LDP0    SC$
        61 000547   000002 740100                    STX0    2,,PR0

      259     4905    1       RS.SCRSH = POFFW(SC$,SSS$);

   4905 61 000550   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 000551   000000 236000 38                 LDQ     SC$
        61 000552   000022 772000                    QRL     18
        61 000553   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 000554   000000 620006                    EAX0    0,QL
        61 000555   000000 471400 42                 LDP1    RS$
        61 000556   100003 440100                    SXL0    3,,PR1

      260     4906    1       ADDR(RS.NPOS) -> WORD36 = UWA.SO.NXTPNT;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:45   
   4906 61 000557   000355 236000 46                 LDQ     UWA+237
        61 000560   100004 756100                    STQ     4,,PR1

      261     4907    1       ADDR(RS.PPOS) -> WORD36 = UWA.SO.PRIPNT;

   4907 61 000561   000356 235000 46                 LDA     UWA+238
        61 000562   100005 755100                    STA     5,,PR1

      262     4908    1       LAST_SO = CURRENT_OFF;

   4908 61 000563   000000 721000 47                 LXL1    CURRENT_OFF
        61 000564   000000 741000 56                 STX1    LAST_SO

      263     4909        /*
      264     4910              SO record done now the SM records.
      265     4911        */
      266     4912    1       NUM_SM = 0;

   4912 61 000565   200011 450100                    STZ     NUM_SM,,AUTO

      267     4913    1       NUM_CF = 0;

   4913 61 000566   200010 450100                    STZ     NUM_CF,,AUTO

      268     4914    1       LAST_RS = CURRENT_OFF;

   4914 61 000567   000000 235000 47                 LDA     CURRENT_OFF
        61 000570   000000 755000 53                 STA     LAST_RS

      269     4915    2       DO WHILE ('1'B);

      270     4916    2           CALL FETCHNS_6('SC-SOSM ') ALTRET(SM_DONE);

   4916 61 000571   000035 630400 62                 EPPR0   29
        61 000572   000021 631400 62                 EPPR1   17
        61 000573   000000 701000 xent               TSX1    FETCHNS_6
        61 000574   001205 702000 61                 TSX2    SM_DONE
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:46   

      271     4917    2           IF UWA.RECORD_NAME ~= 'SM '

   4917 61 000575   040000 106400                    CMPC    fill='040'O
        61 000576   000023 000036 46                 ADSC9   UWA+19                   cn=0,n=30
        61 000577   000007 000003 60                 ADSC9   7                        cn=0,n=3
        61 000600   000614 600000 61                 TZE     s:4928

      272     4918    3           THEN DO;

      273     4919    3               CALL SET_FIELDS(1,30,UWA.RECORD_NAME);

   4919 61 000601   000036 630400 62                 EPPR0   30
        61 000602   000006 631400 62                 EPPR1   6
        61 000603   000000 701000 xent               TSX1    SET_FIELDS
        61 000604   000000 011000                    NOP     0

      274     4920    3               CALL ERROR(%ZIG_RECORD_NOT_SM);

   4920 61 000605   000047 630400 62                 EPPR0   39
        61 000606   000021 631400 62                 EPPR1   17
        61 000607   000000 701000 xent               TSX1    ERROR
        61 000610   000000 011000                    NOP     0

      275     4921    3               CALL ABORT;

   4921 61 000611   000024 631400 62                 EPPR1   20
        61 000612   000000 701000 xent               TSX1    ABORT
        61 000613   000000 011000                    NOP     0

      276     4922        /*E*     ERROR:    ZIG-ZIG_RECORD_NOT_SM-C
      277     4923        MESSAGE: The record "%U1" was not the SM record that I
      278     4924                 was looking for in the schema file.
      279     4925                 <<<< SOFTWARE ERROR >>>>
      280     4926        */
      281     4927    3               END;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:47   
      282     4928    2           CALL ZIG$G_DYN_MEM_6(1,SM1$);

   4928 61 000614   000050 630400 62                 EPPR0   40
        61 000615   000001 631400 62                 EPPR1   1
        61 000616   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000617   000000 011000                    NOP     0

      283     4929    2           CALL ZIG$G_DYN_MEM_6(%SM_BASE_SIZE,RS$);

   4929 61 000620   000053 630400 62                 EPPR0   43
        61 000621   000001 631400 62                 EPPR1   1
        61 000622   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 000623   000000 011000                    NOP     0

      284     4930    2           TPTR$ = PINCRW(SSS$,LAST_RS);

   4930 61 000624   000000 236000 53                 LDQ     LAST_RS
        61 000625   000022 736000                    QLS     18
        61 000626   000000 036000 35                 ADLQ    SSS$
        61 000627   200004 756100                    STQ     TPTR$,,AUTO

      285     4931    2           CURRENT_OFF = POFFW(RS$,SSS$);

   4931 61 000630   000000 235000 35                 LDA     SSS$
        61 000631   000022 771000                    ARL     18
        61 000632   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 000633   000000 236000 42                 LDQ     RS$
        61 000634   000022 772000                    QRL     18
        61 000635   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 000636   000000 756000 47                 STQ     CURRENT_OFF

      286     4932    2           RS.SCRSN = TPTR$ -> RS.SCRSN;

   4932 61 000637   200004 470500                    LDP0    TPTR$,,AUTO
        61 000640   000002 220100                    LDX0    2,,PR0
        61 000641   000000 471400 42                 LDP1    RS$
        61 000642   100002 740100                    STX0    2,,PR1
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:48   

      287     4933    2           RS.SCRSH = TPTR$ -> RS.SCRSH;

   4933 61 000643   200004 470500                    LDP0    TPTR$,,AUTO
        61 000644   000003 721100                    LXL1    3,,PR0
        61 000645   100003 441100                    SXL1    3,,PR1

      288     4934    2           TPTR$ -> RS.SCRSN = CURRENT_OFF;

   4934 61 000646   000000 622006                    EAX2    0,QL
        61 000647   200004 470500                    LDP0    TPTR$,,AUTO
        61 000650   000002 742100                    STX2    2,,PR0

      289     4935    2           LAST_RS = CURRENT_OFF;

   4935 61 000651   000000 236000 47                 LDQ     CURRENT_OFF
        61 000652   000000 756000 53                 STQ     LAST_RS

      290     4936    2           RS.DEF.TYPE = '000000100000'B;

   4936 61 000653   004000 236003                    LDQ     2048,DU
        61 000654   100000 752160                    STCQ    0,'60'O,PR1

      291     4937    2           ADDR(RS.NPOS) -> WORD36 = UWA.SM.NXTPNT;

   4937 61 000655   000370 235000 46                 LDA     UWA+248
        61 000656   000000 470400 42                 LDP0    RS$
        61 000657   000004 755100                    STA     4,,PR0

      292     4938    2           ADDR(RS.PPOS) -> WORD36 = UWA.SM.PRIPNT;

   4938 61 000660   000371 235000 46                 LDA     UWA+249
        61 000661   000005 755100                    STA     5,,PR0

      293     4939    2           ADDR(RS.HPOS) -> WORD36 = UWA.SM.HDPNT;

   4939 61 000662   000372 235000 46                 LDA     UWA+250
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:49   
        61 000663   000006 755100                    STA     6,,PR0

      294     4940    2           LINE_SM.DBK(NUM_SM) = UWA.DIRECT_REF;

   4940 61 000664   200011 720100                    LXL0    NUM_SM,,AUTO
        61 000665   000036 236000 46                 LDQ     UWA+30
        61 000666   000021 736000                    QLS     17
        61 000667   000000 676010 52                 ERQ     LINE,X0
        61 000670   000055 376000 62                 ANQ     45
        61 000671   000000 656010 52                 ERSQ    LINE,X0

      295     4941    2           LINE_SM.OFFSET(NUM_SM) = CURRENT_OFF;

   4941 61 000672   000000 236000 47                 LDQ     CURRENT_OFF
        61 000673   000000 676010 52                 ERQ     LINE,X0
        61 000674   377777 376007                    ANQ     131071,DL
        61 000675   000000 656010 52                 ERSQ    LINE,X0

      296     4942    2           NUM_SM = NUM_SM + 1;

   4942 61 000676   200011 235100                    LDA     NUM_SM,,AUTO
        61 000677   000001 035007                    ADLA    1,DL
        61 000700   200011 755100                    STA     NUM_SM,,AUTO

      297     4943    2           IF UWA.SM.PSMODE = 1

   4943 61 000701   000366 236000 46                 LDQ     UWA+246
        61 000702   000001 116007                    CMPQ    1,DL
        61 000703   000706 601000 61                 TNZ     s:4945

      298     4944    2           THEN RS.DEF.VIA = '1'B;

   4944 61 000704   000040 236003                    LDQ     32,DU
        61 000705   000000 256100                    ORSQ    0,,PR0

      299     4945    2           RS.DEF.MEMT = UWA.SC.SETMODE;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:50   
   4945 61 000706   000000 470400 42                 LDP0    RS$
        61 000707   000311 236000 46                 LDQ     UWA+201
        61 000710   000022 736000                    QLS     18
        61 000711   000000 676100                    ERQ     0,,PR0
        61 000712   000007 376003                    ANQ     7,DU
        61 000713   000000 656100                    ERSQ    0,,PR0

      300     4946    2           RS.DEF.IXNUM = UWA.SM.PA_MEMPNT;

   4946 61 000714   000000 470400 42                 LDP0    RS$
        61 000715   000373 236000 46                 LDQ     UWA+251
        61 000716   000000 676100                    ERQ     0,,PR0
        61 000717   001777 376007                    ANQ     1023,DL
        61 000720   000000 656100                    ERSQ    0,,PR0

      301     4947        /*
      302     4948              Put the index number of the alt index for indexed
      303     4949            areas.
      304     4950        */
      305     4951    2           IF UWA.SC.SETORD = 4

   4951 61 000721   000312 236000 46                 LDQ     UWA+202
        61 000722   000004 116007                    CMPQ    4,DL
        61 000723   000733 601000 61                 TNZ     s:4953

      306     4952    2           THEN RS.DEF.DORD = UWA.SC.SEQDUP;

   4952 61 000724   000000 470400 42                 LDP0    RS$
        61 000725   000320 236000 46                 LDQ     UWA+208
        61 000726   000020 736000                    QLS     16
        61 000727   000000 676100                    ERQ     0,,PR0
        61 000730   600000 376007                    ANQ     -65536,DL
        61 000731   000000 656100                    ERSQ    0,,PR0
        61 000732   000741 710000 61                 TRA     s:4954

      307     4953    2           ELSE RS.DEF.DORD = UWA.SM.SEQDUP;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:51   
   4953 61 000733   000000 470400 42                 LDP0    RS$
        61 000734   000363 236000 46                 LDQ     UWA+243
        61 000735   000020 736000                    QLS     16
        61 000736   000000 676100                    ERQ     0,,PR0
        61 000737   600000 376007                    ANQ     -65536,DL
        61 000740   000000 656100                    ERSQ    0,,PR0

      308     4954    2           IF UWA.SM.RETTYPE = 1

   4954 61 000741   000361 236000 46                 LDQ     UWA+241
        61 000742   000001 116007                    CMPQ    1,DL
        61 000743   000747 601000 61                 TNZ     s:4956

      309     4955    2           THEN RS.DEF.OSM = '1'B;

   4955 61 000744   000000 470400 42                 LDP0    RS$
        61 000745   100000 236007                    LDQ     32768,DL
        61 000746   000000 256100                    ORSQ    0,,PR0

      310     4956    2           IF UWA.SM.INSTYPE = 1

   4956 61 000747   000360 236000 46                 LDQ     UWA+240
        61 000750   000001 116007                    CMPQ    1,DL
        61 000751   000755 601000 61                 TNZ     s:4958

      311     4957    2           THEN RS.DEF.MSM = '1'B;

   4957 61 000752   000000 470400 42                 LDP0    RS$
        61 000753   040000 236007                    LDQ     16384,DL
        61 000754   000000 256100                    ORSQ    0,,PR0

      312     4958    2           IF UWA.SM.MEMDUP = 1

   4958 61 000755   000362 236000 46                 LDQ     UWA+242
        61 000756   000001 116007                    CMPQ    1,DL
        61 000757   000763 601000 61                 TNZ     s:4960

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:52   
      313     4959    2           THEN RS.DEF.DUPP = '1'B;

   4959 61 000760   000000 470400 42                 LDP0    RS$
        61 000761   010000 236007                    LDQ     4096,DL
        61 000762   000000 256100                    ORSQ    0,,PR0

      314     4960    2           IF UWA.SM.CALCDUP = 1

   4960 61 000763   000364 236000 46                 LDQ     UWA+244
        61 000764   000001 116007                    CMPQ    1,DL
        61 000765   000771 601000 61                 TNZ     s:4962

      315     4961    2           THEN RS.DEF.DUPC = '1'B;

   4961 61 000766   000000 470400 42                 LDP0    RS$
        61 000767   002000 236007                    LDQ     1024,DL
        61 000770   000000 256100                    ORSQ    0,,PR0

      316     4962    2           IF RS.DEF.MEMT = 2

   4962 61 000771   000000 470400 42                 LDP0    RS$
        61 000772   000000 236100                    LDQ     0,,PR0
        61 000773   000007 376003                    ANQ     7,DU
        61 000774   000002 116003                    CMPQ    2,DU
        61 000775   001025 601000 61                 TNZ     s:4984

      317     4963    3           THEN DO;

      318     4964    3               IF UWA.SM.PAMEM = 1

   4964 61 000776   000365 235000 46                 LDA     UWA+245
        61 000777   000001 115007                    CMPA    1,DL
        61 001000   001021 601000 61                 TNZ     s:4974

      319     4965    4               THEN DO;

      320     4966    4                   CALL ZIG$G_DYN_MEM_6(1,TPTR$);
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:53   

   4966 61 001001   200004 631500                    EPPR1   TPTR$,,AUTO
        61 001002   200017 451500                    STP1    @RETURN_LENGTH+3,,AUTO
        61 001003   000016 236000 62                 LDQ     14
        61 001004   200016 756100                    STQ     @RETURN_LENGTH+2,,AUTO
        61 001005   200016 630500                    EPPR0   @RETURN_LENGTH+2,,AUTO
        61 001006   000001 631400 62                 EPPR1   1
        61 001007   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 001010   000000 011000                    NOP     0

      321     4967        /*
      322     4968              Allocate more space for a pointer array set.
      323     4969        */
      324     4970    4                   ADDR(RS.CSMPP) -> WORD36 = UWA.SM.PA_MEMPNT;

   4970 61 001011   000373 235000 46                 LDA     UWA+251
        61 001012   000000 470400 42                 LDP0    RS$
        61 001013   000007 755100                    STA     7,,PR0

      325     4971    4                   RS.DEF.MEMT = 2;

   4971 61 001014   000000 236100                    LDQ     0,,PR0
        61 001015   000056 376000 62                 ANQ     46
        61 001016   000002 276003                    ORQ     2,DU
        61 001017   000000 756100                    STQ     0,,PR0

      326     4972    4                   END;

   4972 61 001020   001025 710000 61                 TRA     s:4984

      327     4973    4               ELSE DO;

      328     4974    4                   RS.DEF.MEMT = 1;

   4974 61 001021   000000 236100                    LDQ     0,,PR0
        61 001022   000056 376000 62                 ANQ     46
        61 001023   000001 276003                    ORQ     1,DU
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:54   
        61 001024   000000 756100                    STQ     0,,PR0

      329     4975    4                   END;

      330     4976    3               END;

      331     4977        /*
      332     4978              Now get the SS and CF records for this set member.
      333     4979        */
      334     4980        /*
      335     4981              Note that the RS is still pointing to the SM record
      336     4982            that all the SS and CF record must be connected up to.
      337     4983        */
      338     4984    2           OWNER_CF = LAST_RS;

   4984 61 001025   000000 720000 53                 LXL0    LAST_RS
        61 001026   000000 740000 58                 STX0    OWNER_CF

      339     4985    2           LAST_CF = LAST_RS;

   4985 61 001027   000000 740000 57                 STX0    LAST_CF

      340     4986    3           DO WHILE (SC.SNAM ~= '*CALC');

   4986 61 001030   000000 470400 38                 LDP0    SC$
        61 001031   000000 721100                    LXL1    0,,PR0
        61 001032   000077 361003                    ANX1    63,DU
        61 001033   040000 106540                    CMPC    fill='040'O
        61 001034   000003 000011                    ADSC9   3,,PR0                   cn=0,n=*X1
        61 001035   000002 000005 60                 ADSC9   2                        cn=0,n=5
        61 001036   001054 600000 61                 TZE     DONE_SM_CF

      341     4987        /*
      342     4988              Add CD record off SM record unless it is a calc set.
      343     4989        */
      344     4990    3               CALL FETCHNS_6('SMSS-CF ') ALTRET(DONE_SM_CF);

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:55   
   4990 61 001037   000057 630400 62                 EPPR0   47
        61 001040   000021 631400 62                 EPPR1   17
        61 001041   000000 701000 xent               TSX1    FETCHNS_6
        61 001042   001054 702000 61                 TSX2    DONE_SM_CF

      345     4991    3               CALL ADD_CF;

   4991 61 001043   000022 701000 61                 TSX1    ADD_CF
        61 001044   000000 011000                    NOP     0

      346     4992    3               END;

   4992 61 001045   000000 470400 38                 LDP0    SC$
        61 001046   000000 720100                    LXL0    0,,PR0
        61 001047   000077 360003                    ANX0    63,DU
        61 001050   040000 106540                    CMPC    fill='040'O
        61 001051   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        61 001052   000002 000005 60                 ADSC9   2                        cn=0,n=5
        61 001053   001037 601000 61                 TNZ     s:4990

      347     4993    2   DONE_SM_CF:
      348     4994    2           IF UWA.DB_STATUS ~= '0502100' AND SC.SNAM ~= '*CALC'

   4994 61 001054   040000 106400       DONE_SM_CF   CMPC    fill='040'O
        61 001055   000001 000007 46                 ADSC9   UWA+1                    cn=0,n=7
        61 001056   000012 000007 60                 ADSC9   10                       cn=0,n=7
        61 001057   001072 600000 61                 TZE     s:4996
        61 001060   000000 470400 38                 LDP0    SC$
        61 001061   000000 720100                    LXL0    0,,PR0
        61 001062   000077 360003                    ANX0    63,DU
        61 001063   040000 106540                    CMPC    fill='040'O
        61 001064   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        61 001065   000002 000005 60                 ADSC9   2                        cn=0,n=5
        61 001066   001072 600000 61                 TZE     s:4996

      349     4995    2           THEN CALL ABORT;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:56   
   4995 61 001067   000024 631400 62                 EPPR1   20
        61 001070   000000 701000 xent               TSX1    ABORT
        61 001071   000000 011000                    NOP     0

      350     4996    2           LAST_SM = POFFW(RS$,SSS$);

   4996 61 001072   000000 235000 35                 LDA     SSS$
        61 001073   000022 771000                    ARL     18
        61 001074   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 001075   000000 236000 42                 LDQ     RS$
        61 001076   000022 772000                    QRL     18
        61 001077   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 001100   000000 620006                    EAX0    0,QL
        61 001101   000000 740000 55                 STX0    LAST_SM

      351     4997    2           LAST_SS = LAST_SM;

   4997 61 001102   000000 740000 54                 STX0    LAST_SS

      352     4998    3           DO WHILE ('1'B);

      353     4999    3               CALL FETCHNS_6('SM-SS   ') ALTRET(DONE_SM_SS);

   4999 61 001103   000060 630400 62                 EPPR0   48
        61 001104   000021 631400 62                 EPPR1   17
        61 001105   000000 701000 xent               TSX1    FETCHNS_6
        61 001106   001175 702000 61                 TSX2    DONE_SM_SS

      354     5000    3               CALL ZIG$G_DYN_MEM_6(%SS_BASE_SIZE,SS$);

   5000 61 001107   000062 630400 62                 EPPR0   50
        61 001110   000001 631400 62                 EPPR1   1
        61 001111   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 001112   000000 011000                    NOP     0

      355     5001    3               SS.DEF.TYPE = '000000001000'B;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:57   
   5001 61 001113   000000 470400 44                 LDP0    SS$
        61 001114   001000 236003                    LDQ     512,DU
        61 001115   000000 752160                    STCQ    0,'60'O,PR0

      356     5002    3               SS.DEF.SSTP = UWA.S_S.STYP;

   5002 61 001116   000000 470400 44                 LDP0    SS$
        61 001117   000374 236000 46                 LDQ     UWA+252
        61 001120   000022 736000                    QLS     18
        61 001121   000000 676100                    ERQ     0,,PR0
        61 001122   000007 376003                    ANQ     7,DU
        61 001123   000000 656100                    ERSQ    0,,PR0

      357     5003    3               TPTR$ = PINCRW(SSS$,LAST_SS);

   5003 61 001124   000000 236000 54                 LDQ     LAST_SS
        61 001125   777777 376003                    ANQ     -1,DU
        61 001126   000000 036000 35                 ADLQ    SSS$
        61 001127   200004 756100                    STQ     TPTR$,,AUTO

      358     5004    3               SS.RSSSN = TPTR$ -> SS.RSSSN;

   5004 61 001130   200004 470500                    LDP0    TPTR$,,AUTO
        61 001131   000001 720100                    LXL0    1,,PR0
        61 001132   000000 471400 44                 LDP1    SS$
        61 001133   100001 440100                    SXL0    1,,PR1

      359     5005    3               CURRENT_OFF = POFFW(SS$,SSS$);

   5005 61 001134   000000 235000 35                 LDA     SSS$
        61 001135   000022 771000                    ARL     18
        61 001136   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 001137   000000 236000 44                 LDQ     SS$
        61 001140   000022 772000                    QRL     18
        61 001141   200016 136100                    SBLQ    @RETURN_LENGTH+2,,AUTO
        61 001142   000000 756000 47                 STQ     CURRENT_OFF

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:58   
      360     5006    3               TPTR$ -> SS.RSSSN = CURRENT_OFF;

   5006 61 001143   000000 620006                    EAX0    0,QL
        61 001144   200004 470500                    LDP0    TPTR$,,AUTO
        61 001145   000001 440100                    SXL0    1,,PR0

      361     5007    3               SS.SSH = UWA.S_S.SOSM_SSH;

   5007 61 001146   000376 720000 46                 LXL0    UWA+254
        61 001147   100002 740100                    STX0    2,,PR1

      362     5008    3               SS.RSSSH = LAST_SM;

   5008 61 001150   000000 221000 55                 LDX1    LAST_SM
        61 001151   100002 441100                    SXL1    2,,PR1

      363     5009    3               LAST_SS = CURRENT_OFF;

   5009 61 001152   000000 722000 47                 LXL2    CURRENT_OFF
        61 001153   000000 742000 54                 STX2    LAST_SS

      364     5010    3               OWNER_CF = LAST_SS;

   5010 61 001154   000000 742000 58                 STX2    OWNER_CF

      365     5011    3               LAST_CF = LAST_SS;

   5011 61 001155   000000 742000 57                 STX2    LAST_CF

      366     5012    4               DO WHILE ('1'B);

      367     5013    4                   CALL FETCHNS_6('SSSM-CF ') ALTRET(DONE_SS_CF);

   5013 61 001156   000064 630400 62                 EPPR0   52
        61 001157   000021 631400 62                 EPPR1   17
        61 001160   000000 701000 xent               TSX1    FETCHNS_6
        61 001161   001165 702000 61                 TSX2    DONE_SS_CF
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:59   

      368     5014    4                   CALL ADD_CF;

   5014 61 001162   000022 701000 61                 TSX1    ADD_CF
        61 001163   000000 011000                    NOP     0

      369     5015    4                   END;

   5015 61 001164   001156 710000 61                 TRA     s:5013

      370     5016    3   DONE_SS_CF:
      371     5017    3               IF UWA.DB_STATUS ~= '0502100'

   5017 61 001165   040000 106400       DONE_SS_CF   CMPC    fill='040'O
        61 001166   000001 000007 46                 ADSC9   UWA+1                    cn=0,n=7
        61 001167   000012 000007 60                 ADSC9   10                       cn=0,n=7
        61 001170   001103 600000 61                 TZE     s:4999

      372     5018    3               THEN CALL ABORT;

   5018 61 001171   000024 631400 62                 EPPR1   20
        61 001172   000000 701000 xent               TSX1    ABORT
        61 001173   000000 011000                    NOP     0

      373     5019    3               END;

   5019 61 001174   001103 710000 61                 TRA     s:4999

      374     5020    2   DONE_SM_SS:
      375     5021    2           IF UWA.DB_STATUS ~= '0502100'

   5021 61 001175   040000 106400       DONE_SM_SS   CMPC    fill='040'O
        61 001176   000001 000007 46                 ADSC9   UWA+1                    cn=0,n=7
        61 001177   000012 000007 60                 ADSC9   10                       cn=0,n=7
        61 001200   000571 600000 61                 TZE     s:4916

      376     5022    2           THEN CALL ABORT;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:60   

   5022 61 001201   000024 631400 62                 EPPR1   20
        61 001202   000000 701000 xent               TSX1    ABORT
        61 001203   000000 011000                    NOP     0

      377     5023    2           END;

   5023 61 001204   000571 710000 61                 TRA     s:4916

      378     5024    1   SM_DONE:
      379     5025    1       IF UWA.DB_STATUS ~= '0502100'

   5025 61 001205   040000 106400       SM_DONE      CMPC    fill='040'O
        61 001206   000001 000007 46                 ADSC9   UWA+1                    cn=0,n=7
        61 001207   000012 000007 60                 ADSC9   10                       cn=0,n=7
        61 001210   001214 600000 61                 TZE     s:5027

      380     5026    1       THEN CALL ABORT;

   5026 61 001211   000024 631400 62                 EPPR1   20
        61 001212   000000 701000 xent               TSX1    ABORT
        61 001213   000000 011000                    NOP     0

      381     5027    1       ALLOCATE_END = 1;

   5027 61 001214   000001 235007                    LDA     1,DL
        61 001215   000000 755000 21                 STA     ALLOCATE_END

      382     5028    1       IF TYPE_300.TYPE = 300

   5028 61 001216   000000 236000 18                 LDQ     IO_BUF
        61 001217   000454 116007                    CMPQ    300,DL
        61 001220   001224 601000 61                 TNZ     s:5030

      383     5029    1       THEN I = #SET_DEF;

   5029 61 001221   000002 235007                    LDA     2,DL
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:61   
        61 001222   200003 755100                    STA     I,,AUTO
        61 001223   001226 710000 61                 TRA     s:5031

      384     5030    1       ELSE I = #KEY_DEF;

   5030 61 001224   000003 235007                    LDA     3,DL
        61 001225   200003 755100                    STA     I,,AUTO

      385     5031    1       STATUS = #IN_ALIAS;

   5031 61 001226   060000 236003                    LDQ     24576,DU
        61 001227   200007 756100                    STQ     STATUS,,AUTO

      386     5032    1       HASH_SCHEMA_NAME = '1'B;

   5032 61 001230   400000 236003                    LDQ     -131072,DU
        61 001231   000000 756000 15                 STQ     HASH_SCHEMA_NAME

      387     5033    1       CALL ZIG$HASH_IT(TYPE_300.SET_NAME,#ADD,ERROR_FLG,I,2,14+NUM_SM,

   5033 61 001232   200011 235100                    LDA     NUM_SM,,AUTO
        61 001233   000016 035007                    ADLA    14,DL
        61 001234   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 001235   200007 630500                    EPPR0   STATUS,,AUTO
        61 001236   200027 450500                    STP0    @RETURN_LENGTH+11,,AUTO
        61 001237   200004 631500                    EPPR1   TPTR$,,AUTO
        61 001240   200026 451500                    STP1    @RETURN_LENGTH+10,,AUTO
        61 001241   200016 633500                    EPPR3   @RETURN_LENGTH+2,,AUTO
        61 001242   200025 453500                    STP3    @RETURN_LENGTH+9,,AUTO
        61 001243   000027 236000 62                 LDQ     23
        61 001244   200024 756100                    STQ     @RETURN_LENGTH+8,,AUTO
        61 001245   200003 634500                    EPPR4   I,,AUTO
        61 001246   200023 454500                    STP4    @RETURN_LENGTH+7,,AUTO
        61 001247   000066 236000 62                 LDQ     54
        61 001250   200022 756100                    STQ     @RETURN_LENGTH+6,,AUTO
        61 001251   000070 237000 62                 LDAQ    56
        61 001252   200020 757100                    STAQ    @RETURN_LENGTH+4,,AUTO
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:62   
        61 001253   200020 630500                    EPPR0   @RETURN_LENGTH+4,,AUTO
        61 001254   000065 631400 62                 EPPR1   53
        61 001255   000000 701000 xent               TSX1    ZIG$HASH_IT
        61 001256   000000 011000                    NOP     0

      388     5034    1          TPTR$,STATUS);
      389     5035    1       ALLOCATE_END = 0;

   5035 61 001257   000000 450000 21                 STZ     ALLOCATE_END

      390     5036    1       ADDR(SC1.XXDPN) -> WORD36 = ADDR(TPTR$) -> WORD36;

   5036 61 001260   000000 470400 39                 LDP0    SC1$
        61 001261   200004 235100                    LDA     TPTR$,,AUTO
        61 001262   000001 755100                    STA     1,,PR0

      391     5037        /*
      392     5038              Set the -1 word of the SC record to point to the information
      393     5039            in the hash table so we can get from the schema subset to the
      394     5040            hash table. Warning; the Data base procedures can not be done
      395     5041            until all the sets CF and SM records have been connected up.!!
      396     5042        */
      397     5043    1       TPTR$ -> SET_HASH.REF = TYPE_300.REF_LINE;

   5043 61 001263   200004 471500                    LDP1    TPTR$,,AUTO
        61 001264   000001 236000 18                 LDQ     IO_BUF+1
        61 001265   100011 756100                    STQ     9,,PR1

      398     5044    1       TPTR$ -> SET_HASH.SUB_OFF = LAST_SC;

   5044 61 001266   000000 235000 49                 LDA     LAST_SC
        61 001267   000022 771000                    ARL     18
        61 001270   100012 755100                    STA     10,,PR1

      399     5045    1       TPTR$ -> SET_HASH.DBK = SAVE_SC_DBK;

   5045 61 001271   000001 235000 48                 LDA     SAVE_SC_DBK
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:63   
        61 001272   100013 755100                    STA     11,,PR1

      400     5046    1       TPTR$ -> SET_HASH.SO.DBK = SAVE_SO_DBK;

   5046 61 001273   000002 236000 48                 LDQ     SAVE_SO_DBK
        61 001274   000021 736000                    QLS     17
        61 001275   100014 676100                    ERQ     12,,PR1
        61 001276   000055 376000 62                 ANQ     45
        61 001277   100014 656100                    ERSQ    12,,PR1

      401     5047    1       TPTR$ -> SET_HASH.SO.OFFSET = LAST_SO;

   5047 61 001300   000000 236000 56                 LDQ     LAST_SO
        61 001301   000022 772000                    QRL     18
        61 001302   100014 676100                    ERQ     12,,PR1
        61 001303   377777 376007                    ANQ     131071,DL
        61 001304   100014 656100                    ERSQ    12,,PR1

      402     5048    1       TPTR$ -> SET_HASH.NUM_SM = NUM_SM;

   5048 61 001305   200011 236100                    LDQ     NUM_SM,,AUTO
        61 001306   100015 756100                    STQ     13,,PR1

      403     5049    2       DO I = 0 TO NUM_SM - 1;

   5049 61 001307   200003 450100                    STZ     I,,AUTO
        61 001310   001320 710000 61                 TRA     s:5051+3

      404     5050    2           TPTR$ -> SET_HASH.SM_LIST(I) = LINE_SM(I);

   5050 61 001311   200003 720100                    LXL0    I,,AUTO
        61 001312   000000 236010 52                 LDQ     LINE,X0
        61 001313   200004 470500                    LDP0    TPTR$,,AUTO
        61 001314   000016 756110                    STQ     14,X0,PR0

      405     5051    2           END;

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:64   
   5051 61 001315   200003 235100                    LDA     I,,AUTO
        61 001316   000001 035007                    ADLA    1,DL
        61 001317   200003 755100                    STA     I,,AUTO
        61 001320   200003 236100                    LDQ     I,,AUTO
        61 001321   200011 116100                    CMPQ    NUM_SM,,AUTO
        61 001322   001311 602000 61                 TNC     s:5050

      406     5052        /*
      407     5053              Initialize the set in the hash table for fast access and
      408     5054            fast finding of that name.
      409     5055              There can be not dups or errors at this point since we had
      410     5056            a successful subschema translation and we have found the SC
      411     5057            record in the schema file.
      412     5058        */
      413     5059    1       IF NUM_CF ~= 0

   5059 61 001323   200010 235100                    LDA     NUM_CF,,AUTO
        61 001324   001364 600000 61                 TZE     s:5073

      414     5060    2       THEN DO;

      415     5061    2           ALLOCATE_END = 1;

   5061 61 001325   000001 235007                    LDA     1,DL
        61 001326   000000 755000 21                 STA     ALLOCATE_END

      416     5062    2           CALL ZIG$G_DYN_MEM_6(NUM_CF+2,TPTR$);

   5062 61 001327   200010 235100                    LDA     NUM_CF,,AUTO
        61 001330   000002 035007                    ADLA    2,DL
        61 001331   200016 755100                    STA     @RETURN_LENGTH+2,,AUTO
        61 001332   200004 630500                    EPPR0   TPTR$,,AUTO
        61 001333   200021 450500                    STP0    @RETURN_LENGTH+5,,AUTO
        61 001334   200016 631500                    EPPR1   @RETURN_LENGTH+2,,AUTO
        61 001335   200020 451500                    STP1    @RETURN_LENGTH+4,,AUTO
        61 001336   200020 630500                    EPPR0   @RETURN_LENGTH+4,,AUTO
        61 001337   000001 631400 62                 EPPR1   1
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:65   
        61 001340   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        61 001341   000000 011000                    NOP     0

      417     5063    2           ALLOCATE_END = 0;

   5063 61 001342   000000 450000 21                 STZ     ALLOCATE_END

      418     5064    2           TPTR$ -> CF_STR.NPTR$ = CF_PTR$;

   5064 61 001343   000000 236000 59                 LDQ     CF_PTR$
        61 001344   200004 470500                    LDP0    TPTR$,,AUTO
        61 001345   000000 756100                    STQ     0,,PR0

      419     5065    2           CF_PTR$ = TPTR$;

   5065 61 001346   200004 236100                    LDQ     TPTR$,,AUTO
        61 001347   000000 756000 59                 STQ     CF_PTR$

      420     5066    2           CF_PTR$ -> CF_STR.COUNT = NUM_CF * 4;

   5066 61 001350   000000 470400 59                 LDP0    CF_PTR$
        61 001351   200010 235100                    LDA     NUM_CF,,AUTO
        61 001352   000002 735000                    ALS     2
        61 001353   000001 755100                    STA     1,,PR0

      421     5067    2           CF_PTR$ -> CF_STR.STR= SUBSTR(ADDR(LINE(1000-NUM_CF)) -> STR,0,NUM_CF*4);

   5067 61 001354   000001 720100                    LXL0    1,,PR0
        61 001355   000000 621005                    EAX1    0,AL
        61 001356   000000 235003                    LDA     0,DU
        61 001357   200010 135100                    SBLA    NUM_CF,,AUTO
        61 001360   000002 735000                    ALS     2
        61 001361   040140 100445                    MLR     fill='040'O
        61 001362   001750 000011 52                 ADSC9   LINE+1000,A              cn=0,n=*X1
        61 001363   000002 000010                    ADSC9   2,,PR0                   cn=0,n=*X0

      422     5068    2           END;
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:66   

      423     5069        /*
      424     5070              Creat the structure for searching for the CF record in the
      425     5071            schema subset by the DBK of that CF record.
      426     5072        */
      427     5073    1       RETURN;

   5073 61 001364   000000 702200 xent               TSX2  ! X66_ARET

      428     5074    1   DBCS_ERROR:
      429     5075    1       CALL ABORT;

   5075 61 001365   000024 631400 62    DBCS_ERROR   EPPR1   20
        61 001366   000000 701000 xent               TSX1    ABORT
        61 001367   000000 011000                    NOP     0

      430     5076    1   END ZIG$V_SET;

   5076 61 001370   000000 702200 xent               TSX2  ! X66_ARET

ANALS
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
   4     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
   4     024*  ****** ******   ****** ******   ****** ******                    ............

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:67   
VALIDS
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
   6     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
  10     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_ALLOWED
 Sect OctLoc
  11     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  13     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  14     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  14     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
  14     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:68   
  14     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  15     000   0***** ******                                                    ....

CONTROL
 Sect OctLoc
  17     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  17     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  17     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  17     020*  040040 040040   040040 040040   040040 040040   040040 040040
  17     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  17     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  17     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
  17     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  17     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  17     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  17     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

IO_BUF
 Sect OctLoc
  18     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  26     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  28     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  29     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:69   
 Sect OctLoc
  31     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  31     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  31     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  31     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  32     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  32     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  32     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  32     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  32     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  32     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  32     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  32     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  33     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  33     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  33     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  33     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  33     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  33     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  33     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  33     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  34     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  34     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  34     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  34     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  34     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  34     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  34     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:70   
  34     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  46     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  46     004   040040 040040   040040 040040   040040 040040   040040 040040
  46     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  46     014   040040 040040   040040 040040   040040 040040   040040 040040
  46     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  46     024   040040 040040   040040 040040   040040 040040   040040 040040
  46     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  46     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  46     040   040040 040040   040040 040040   040040 040040   040040 040040
  46     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  46     050   040040 040040   040040 040040   040040 040040   040040 040040
  46     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  46     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  46     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  46     070   040040 040040   040040 040040   040040 040040   040040 040040
  46     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  46     104   040040 040040   040040 040040   040040 040040   040040 040040
  46     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  46     130   040040 040040   040040 040040   040040 040040   040040 040040
  46     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  46     140   040040 040040   040040 040040   040040 040040   040040 040040
  46     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  46     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     154   040040 040040   040040 040040   040040 040040   040040 040040
  46     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  46     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  46     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  46     174   040040 040040   040040 040040   040040 040040   040040 040040
  46     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  46     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  46     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  46     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:71   
  46     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  46     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  46     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  46     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  46     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  46     430   040040 040040   040040 040040   040040 040040   040040 040040
  46     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  46     440   040040 040040   040040 040040   040040 040040   040040 040040
  46     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  46     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  46     460   040040 040040   040040 040040   040040 040040   040040 040040
  46     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  46     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  46     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  46     504   040040 040040   040040 040040   040040 040040   040040 040040
  46     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  46     524   040040 040040   040040 040040   040040 040040   040040 040040
  46     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  46     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  46     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  46     614   040040 040040   040040 040040   040040 040040   040040 040040
  46     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  46     624   040040 040040   040040 040040   040040 040040   040040 040040
  46     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  46     664   040040 040040   040040 040040   040040 040040   040040 040040
  46     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46     700   040040 040040   040040 040040   040040 040040   040040 040040
  46     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46     714   040040 040040   040040 040040   040040 040040   040040 040040
  46     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  46     724   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:72   
  46     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46     744   040040 040040   040040 040040   040040 040040   040040 040040
  46     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46    1000   040040 040040   040040 040040   040040 040040   040040 040040
  46    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46    1040   040040 040040   040040 040040   040040 040040   040040 040040
  46    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46    1064   040040 040040   040040 040040   040040 040040   040040 040040
  46    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  46    1120   040040 040040   040040 040040   040040 040040   040040 040040
  46    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  46    1140   040040 040040   040040 040040   040040 040040   040040 040040
  46    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  46    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  46    1154   040040 040040   040040 040040   040040 040040   040040 040040
  46    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  46    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  46    1170   040040 040040   040040 040040   040040 040040   040040 040040
  46    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  46    1204   040040 040040   040040 040040   040040 040040   040040 040040
  46    1214*  040040 040040   040040 040040   040040 040040   040040 040040

LIST_STRING
 Sect OctLoc
  50     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LINE
 Sect OctLoc
  52     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
  60     000   123116 055123   105040 040040   052103 101114   103040 040040    SN-SE   *CALC
  60     004   123103 055123   117123 115040   123117 040040   123115 040040    SC-SOSM SO  SM
  60     010   123115 123123   055103 106040   060065 060062   061060 060040    SMSS-CF 0502100
  60     014   123115 055123   123040 040040   123123 123115   055103 106040    SM-SS   SSSM-CF

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:73   
(unnamed)
 Sect OctLoc
  62     000   040040 040040   000002 000000   000000 000004   000002 006000        ............
  62     004   000000 006000   000013 006000   000003 000000   000000 000036    ................
  62     010   000003 006000   000007 006000   000000 000037   000000 000001    ................
  62     014   000003 006000   000012 006000   000013 006000   000007 006000    ................
  62     020   000003 006000   000001 000000   000000 021463   000022 006000    ................
  62     024   000000 000000   000000 006000   000000 000002   000026 006000    ................
  62     030   000000 006000   000000 006000   477777 777777   000000 006000    ................
  62     034   000000 006000   000004 006000   000013 006000   000007 006000    ................
  62     040   000023 006000   000000 021467   000041 006000   000000 000006    .........!......
  62     044   000043 006000   000000 006000   000000 021470   000046 006000    .#...........&..
  62     050   000013 006000   000000 006000   000000 000007   000052 006000    .............*..
  62     054   000000 006000   777777 400000   777770 777777   000010 006000    ................
  62     060   000014 006000   000000 000003   000061 006000   000000 006000    .........1......
  62     064   000016 006000   000010 000000   000000 006000   000000 000000    ................
  62     070   000003 006000   000024 006000                                    ........

PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:74   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_SET.

   Procedure ZIG$V_SET requires 761 words for executable code.
   Procedure ZIG$V_SET requires 24 words of local(AUTO) storage.

    No errors detected in file ZIG$V_SET.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:75   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:76   
          MINI XREF LISTING

ABORT
      2719**DCL-ENT  4893--CALL     4921--CALL     4995--CALL     5018--CALL     5022--CALL     5026--CALL
      5075--CALL
ADD_CF
      4757**PROC     4991--CALL     5014--CALL
ALLOCATE_END
      2722**DCL      4778<<ASSIGN   5027<<ASSIGN   5035<<ASSIGN   5061<<ASSIGN   5063<<ASSIGN
CD.DEF.CONT
      3649**DCL      4763<<ASSIGN
CD.DEF.RELT
      3650**DCL      4764<<ASSIGN
CD.DEF.SYNC
      3648**DCL      4761<<ASSIGN
CD.DEF.TYPE
      3647**DCL      4759<<ASSIGN
CD.RSCDH
      3655**DCL      4765<<ASSIGN
CD.RSCDN
      3654**DCL      4768<<ASSIGN   4768>>ASSIGN   4769<<ASSIGN
CD$
      3644**DCL      3645--IMP-PTR  4758<>CALL     4759>>ASSIGN   4761>>ASSIGN   4763>>ASSIGN   4764>>ASSIGN
      4765>>ASSIGN   4767>>ASSIGN   4768>>ASSIGN
CF_PTR$
      4738**DCL      5064>>ASSIGN   5065<<ASSIGN   5066>>ASSIGN   5067>>ASSIGN   5067>>ASSIGN
CF_STR.COUNT
      4741**DCL      4742--IMP-SIZ  5066<<ASSIGN   5067>>ASSIGN
CF_STR.NPTR$
      4740**DCL      5064<<ASSIGN
CF_STR.STR
      4742**DCL      5067<<ASSIGN
CURRENT_OFF
      4706**DCL      4767<<ASSIGN   4769>>ASSIGN   4770>>ASSIGN   4772>>ASSIGN   4814<<ASSIGN   4817>>ASSIGN
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:77   
      4832>>ASSIGN   4833>>ASSIGN   4903<<ASSIGN   4904>>ASSIGN   4908>>ASSIGN   4914>>ASSIGN   4931<<ASSIGN
      4934>>ASSIGN   4935>>ASSIGN   4941>>ASSIGN   5005<<ASSIGN   5006>>ASSIGN   5009>>ASSIGN
CURRENT_RECORD
      2506**DCL      4880<>CALL
DBCS_ERROR
      5075**LABEL    4800--CALLALT  4888--CALLALT
DONE_SM_CF
      4994**LABEL    4990--CALLALT
DONE_SM_SS
      5021**LABEL    4999--CALLALT
DONE_SS_CF
      5017**LABEL    5013--CALLALT
DP$
      3526**DCL      3527--IMP-PTR
DP1$
      3540**DCL      3541--IMP-PTR
ERROR
      2711**DCL-ENT  4789--CALL     4892--CALL     4920--CALL
ERROR_FLG
      4708**DCL      5033<>CALL
FETCHNS_6
      3676**DCL-ENT  4800--CALL     4888--CALL     4916--CALL     4990--CALL     4999--CALL     5013--CALL
FIND_LENGTH
      4746**PROC     4777--CALL
HASH_SCHEMA_NAME
      2448**DCL      5032<<ASSIGN
I
      4702**DCL      5029<<ASSIGN   5030<<ASSIGN   5033<>CALL     5049<<DOINDEX  5050>>ASSIGN   5050>>ASSIGN
IO_BUF
      2628**DCL      2655--REDEF    4880<>CALL
LARGEST_KEY
      4711**DCL      4852>>IF       4853<<ASSIGN   4863>>IF       4864<<ASSIGN
LAST_CF
      4736**DCL      4766>>ASSIGN   4770<<ASSIGN   4985<<ASSIGN   5011<<ASSIGN
LAST_RS
      4729**DCL      4914<<ASSIGN   4930>>ASSIGN   4935<<ASSIGN   4984>>ASSIGN   4985>>ASSIGN
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:78   
LAST_SC
      4709**DCL      4830>>ASSIGN   4833<<ASSIGN   5044>>ASSIGN
LAST_SM
      4734**DCL      4996<<ASSIGN   4997>>ASSIGN   5008>>ASSIGN
LAST_SO
      4735**DCL      4908<<ASSIGN   5047>>ASSIGN
LAST_SS
      4733**DCL      4997<<ASSIGN   5003>>ASSIGN   5009<<ASSIGN   5010>>ASSIGN   5011>>ASSIGN
LINE
      4714**DCL      4717--REDEF    5067--ASSIGN
LINE.DBK
      4715**DCL      4771<<ASSIGN
LINE.OFFSET
      4716**DCL      4772<<ASSIGN
LINE_SM
      4717**DCL      5050>>ASSIGN
LINE_SM.DBK
      4718**DCL      4940<<ASSIGN
LINE_SM.OFFSET
      4719**DCL      4941<<ASSIGN
L_SUBSCH_SC
      4704**DCL      4777<>CALL     4809>>CALL     4847>>ASSIGN
NOT_BLANK IN PROCEDURE FIND_LENGTH
      4752**LABEL    4749--CALLALT
NUM_CF
      4712**DCL      4771>>ASSIGN   4772>>ASSIGN   4773<<ASSIGN   4773>>ASSIGN   4913<<ASSIGN   5059>>IF
      5062>>CALL     5066>>ASSIGN   5067>>ASSIGN   5067>>ASSIGN
NUM_SM
      4713**DCL      4912<<ASSIGN   4940>>ASSIGN   4941>>ASSIGN   4942<<ASSIGN   4942>>ASSIGN   5033>>CALL
      5048>>ASSIGN   5049>>DOINDEX
OA.CLCSC
      3427**DCL      4817<<ASSIGN
OA.CSZ
      3462**DCL      4848>>ASSIGN   4851<<ASSIGN   4851>>ASSIGN   4862<<ASSIGN   4862>>ASSIGN   4867<<ASSIGN
      4867>>ASSIGN
OA.LPASZ
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:79   
      3470**DCL      4854>>IF       4855<<ASSIGN
OA.SCNAM.EIS.COUNT
      3437**DCL      3474--IMP-SIZ
OA$
      3415**DCL      3416--IMP-PTR  4817>>ASSIGN   4848>>ASSIGN   4851>>ASSIGN   4851>>ASSIGN   4854>>IF
      4855>>ASSIGN   4862>>ASSIGN   4862>>ASSIGN   4867>>ASSIGN   4867>>ASSIGN
OA1$
      3481**DCL      3482--IMP-PTR
OWNER_CF
      4737**DCL      4765>>ASSIGN   4984<<ASSIGN   5010<<ASSIGN
RETURN_LENGTH IN PROCEDURE FIND_LENGTH
      4747**DCL      4746--PROC     4749<<CALLBLT  4752<<ASSIGN
RS.CSMPP
      3610**DCL      4970--ASSIGN
RS.DEF.DORD
      3560**DCL      4952<<ASSIGN   4953<<ASSIGN
RS.DEF.DUPC
      3566**DCL      4961<<ASSIGN
RS.DEF.DUPP
      3564**DCL      4959<<ASSIGN
RS.DEF.IXNUM
      3567**DCL      4946<<ASSIGN
RS.DEF.MEMT
      3556**DCL      4945<<ASSIGN   4962>>IF       4971<<ASSIGN   4974<<ASSIGN
RS.DEF.MSM
      3562**DCL      4957<<ASSIGN
RS.DEF.OSM
      3561**DCL      4955<<ASSIGN
RS.DEF.TYPE
      3551**DCL      4902<<ASSIGN   4936<<ASSIGN
RS.DEF.VIA
      3554**DCL      4944<<ASSIGN
RS.HPOS
      3601**DCL      4939--ASSIGN
RS.NPOS
      3574**DCL      3583--REDEF    4906--ASSIGN   4937--ASSIGN
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:80   
RS.PPOS
      3592**DCL      4907--ASSIGN   4938--ASSIGN
RS.SCRSH
      3573**DCL      4905<<ASSIGN   4933<<ASSIGN   4933>>ASSIGN
RS.SCRSN
      3570**DCL      4932<<ASSIGN   4932>>ASSIGN   4934<<ASSIGN
RS$
      3548**DCL      3549--IMP-PTR  4901<>CALL     4902>>ASSIGN   4903>>ASSIGN   4905>>ASSIGN   4906>>ASSIGN
      4907>>ASSIGN   4929<>CALL     4931>>ASSIGN   4932>>ASSIGN   4933>>ASSIGN   4936>>ASSIGN   4937>>ASSIGN
      4938>>ASSIGN   4939>>ASSIGN   4944>>ASSIGN   4945>>ASSIGN   4946>>ASSIGN   4952>>ASSIGN   4953>>ASSIGN
      4955>>ASSIGN   4957>>ASSIGN   4959>>ASSIGN   4961>>ASSIGN   4962>>IF       4970>>ASSIGN   4971>>ASSIGN
      4974>>ASSIGN   4996>>ASSIGN
SAVE_SC_DBK
      4730**DCL      4815<<ASSIGN   5045>>ASSIGN
SAVE_SO_DBK
      4731**DCL      4900<<ASSIGN   5046>>ASSIGN
SC.DEF
      3492**DCL      4879>>ASSIGN
SC.DEF.ALTO
      3500**DCL      4843<<ASSIGN
SC.DEF.LG
      3501**DCL      4845<<ASSIGN
SC.DEF.SETM
      3494**DCL      4835<<ASSIGN   4849>>IF
SC.DEF.SETO
      3496**DCL      4836<<ASSIGN
SC.DEF.SETT
      3502**DCL      4846<<ASSIGN   4858>>IF       4858>>IF
SC.DEF.SNL
      3503**DCL      3508--IMP-SIZ  4847<<ASSIGN   4883>>ASSIGN   4986>>DOWHILE  4994>>IF
SC.DEF.SRCR
      3499**DCL      4841<<ASSIGN
SC.DEF.TYPE
      3493**DCL      4834<<ASSIGN
SC.OASCN
      3505**DCL      4831<<ASSIGN   4831>>ASSIGN   4832<<ASSIGN
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:81   
SC.SCID
      3507**DCL      4882<<ASSIGN
SC.SCRSN
      3506**DCL      4904<<ASSIGN
SC.SCWSO
      3504**DCL      4848<<ASSIGN
SC.SNAM
      3508**DCL      4883<<ASSIGN   4986>>DOWHILE  4994>>IF
SC$
      3490**DCL      3491--IMP-PTR  4809<>CALL     4814>>ASSIGN   4831>>ASSIGN   4834>>ASSIGN   4835>>ASSIGN
      4836>>ASSIGN   4841>>ASSIGN   4843>>ASSIGN   4845>>ASSIGN   4846>>ASSIGN   4847>>ASSIGN   4848>>ASSIGN
      4849>>IF       4858>>IF       4858>>IF       4879>>ASSIGN   4882>>ASSIGN   4883>>ASSIGN   4883>>ASSIGN
      4904>>ASSIGN   4905>>ASSIGN   4986>>DOWHILE  4986>>DOWHILE  4994>>IF       4994>>IF
SC1.IXID
      3518**DCL      4861<<ASSIGN
SC1.KLNG
      3519**DCL      4860<<ASSIGN
SC1.XXDPN
      3520**DCL      5036--ASSIGN
SC1$
      3516**DCL      3517--IMP-PTR  4803<>CALL     4807<<ASSIGN   4860>>ASSIGN   4861>>ASSIGN   5036>>ASSIGN
SET_FIELDS
      2714**DCL-ENT  4788--CALL     4891--CALL     4919--CALL
SET_HASH.DBK
      2479**DCL      5045<<ASSIGN
SET_HASH.NUM_SM
      2483**DCL      5048<<ASSIGN
SET_HASH.REF
      2477**DCL      5043<<ASSIGN
SET_HASH.SM_LIST
      2484**DCL      5050<<ASSIGN
SET_HASH.SO.DBK
      2481**DCL      5046<<ASSIGN
SET_HASH.SO.OFFSET
      2482**DCL      5047<<ASSIGN
SET_HASH.SUB_OFF
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:82   
      2478**DCL      5044<<ASSIGN
SM1$
      3622**DCL      3623--IMP-PTR  4928<>CALL
SM_DONE
      5025**LABEL    4916--CALLALT
SN_DBK
        30**DCL      4797<<ASSIGN
SRCHD
      2740**DCL-ENT  4781--CALL     4784--CALL
SS.DEF.SSTP
      3635**DCL      5002<<ASSIGN
SS.DEF.TYPE
      3633**DCL      5001<<ASSIGN
SS.RSSSH
      3640**DCL      5008<<ASSIGN
SS.RSSSN
      3638**DCL      5004<<ASSIGN   5004>>ASSIGN   5006<<ASSIGN
SS.SSH
      3639**DCL      5007<<ASSIGN
SS$
      3630**DCL      3631--IMP-PTR  5000<>CALL     5001>>ASSIGN   5002>>ASSIGN   5004>>ASSIGN   5005>>ASSIGN
      5007>>ASSIGN   5008>>ASSIGN
SSS$
      3410**DCL      4766>>ASSIGN   4767>>ASSIGN   4814>>ASSIGN   4830>>ASSIGN   4903>>ASSIGN   4905>>ASSIGN
      4930>>ASSIGN   4931>>ASSIGN   4996>>ASSIGN   5003>>ASSIGN   5005>>ASSIGN
STATUS
      4707**DCL      5031<<ASSIGN   5033<>CALL
STR
      4743**DCL      5067>>ASSIGN
STRING_TO_GET IN PROCEDURE FIND_LENGTH
      4748**DCL      4746--PROC     4749>>CALLBLT
SUBSCHEMA_KEY
      2746**DCL      2747--REDEF
SUCC
      4705**DCL      4781<>CALL     4784<>CALL     4786>>IF
TPTR$
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:83   
      4703**DCL      4766<<ASSIGN   4768>>ASSIGN   4769>>ASSIGN   4806<>CALL     4807>>ASSIGN   4830<<ASSIGN
      4831>>ASSIGN   4832>>ASSIGN   4930<<ASSIGN   4932>>ASSIGN   4933>>ASSIGN   4934>>ASSIGN   4966<>CALL
      5003<<ASSIGN   5004>>ASSIGN   5006>>ASSIGN   5033<>CALL     5036--ASSIGN   5043>>ASSIGN   5044>>ASSIGN
      5045>>ASSIGN   5046>>ASSIGN   5047>>ASSIGN   5048>>ASSIGN   5050>>ASSIGN   5062<>CALL     5064>>ASSIGN
      5065>>ASSIGN
TYPE_300.ID_NUM
      2663**DCL      4882>>ASSIGN
TYPE_300.INFO
      2664**DCL      2665--REDEF    4879<<ASSIGN
TYPE_300.REF_LINE
      2657**DCL      4795>>IF       4837>>IF       4874>>IF       5043>>ASSIGN
TYPE_300.SET_NAME
      2659**DCL      4781<>CALL     4784<>CALL     4788<>CALL     4816>>IF       5033<>CALL
TYPE_300.SORT_KEY_ORDER
      2694**DCL      4877<<ASSIGN   4878<<ASSIGN
TYPE_300.SUB_SET_NAME
      2661**DCL      4777<>CALL     4883>>ASSIGN
TYPE_300.TYPE
      2656**DCL      4779>>IF       5028>>IF
UWA.AC.CALC_NEXT
      4477**DCL      4478--REDEF
UWA.AC.CALC_PRIOR
      4486**DCL      4487--REDEF
UWA.AC.DEFAULTS
      4438**DCL      4439--REDEF
UWA.AC.FILE_CODE
      4443**DCL      4444--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      4440**DCL      4441--REDEF
UWA.C_F.CTRLSEQ
      4575**DCL      4762>>IF
UWA.C_F.CTRLTYPE
      4573**DCL      4764>>ASSIGN
UWA.C_F.SYN
      4572**DCL      4760>>IF
UWA.DB_STATUS
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:84   
      4369**DCL      4994>>IF       5017>>IF       5021>>IF       5025>>IF
UWA.DIRECT_REF
      4378**DCL      4771>>ASSIGN   4797>>ASSIGN   4815>>ASSIGN   4900>>ASSIGN   4940>>ASSIGN
UWA.RECORD_NAME
      4375**DCL      4889>>IF       4891<>CALL     4917>>IF       4919<>CALL
UWA.SC.ALTOWN
      4519**DCL      4842>>IF
UWA.SC.INDEX_ID
      4524**DCL      4861>>ASSIGN
UWA.SC.KEY_LENGTH
      4525**DCL      4852>>IF       4853>>ASSIGN   4854>>IF       4855>>ASSIGN   4860>>ASSIGN   4862>>ASSIGN
      4863>>IF       4864>>ASSIGN
UWA.SC.RECSET
      4520**DCL      4838<<ASSIGN   4840>>IF
UWA.SC.SEQDUP
      4521**DCL      4877>>ASSIGN   4952>>ASSIGN
UWA.SC.SETGLO
      4516**DCL      4844>>IF
UWA.SC.SETMODE
      4514**DCL      4835>>ASSIGN   4945>>ASSIGN
UWA.SC.SETORD
      4515**DCL      4836>>ASSIGN   4876>>IF       4951>>IF
UWA.SC.SETTYPE
      4513**DCL      4801>>IF       4801>>IF       4846>>ASSIGN
UWA.SM.CALCDUP
      4558**DCL      4960>>IF
UWA.SM.HDPNT
      4564**DCL      4939>>ASSIGN
UWA.SM.INSTYPE
      4554**DCL      4956>>IF
UWA.SM.MEMDUP
      4556**DCL      4958>>IF
UWA.SM.NXTPNT
      4562**DCL      4937>>ASSIGN
UWA.SM.PAMEM
      4559**DCL      4964>>IF
PL6.E3A0      #001=ZIG$V_SET File=ZIG$V_SET.:ZIC0TSI                             FRI 09/05/97 12:24 Page:85   
UWA.SM.PA_MEMPNT
      4565**DCL      4946>>ASSIGN   4970>>ASSIGN
UWA.SM.PRIPNT
      4563**DCL      4938>>ASSIGN
UWA.SM.PSMODE
      4560**DCL      4943>>IF
UWA.SM.RETTYPE
      4555**DCL      4954>>IF
UWA.SM.SEQDUP
      4557**DCL      4953>>ASSIGN
UWA.SO.NXTPNT
      4551**DCL      4906>>ASSIGN
UWA.SO.PRIPNT
      4552**DCL      4907>>ASSIGN
UWA.S_S.SOSM_SSH
      4569**DCL      5007>>ASSIGN
UWA.S_S.STYP
      4567**DCL      5002>>ASSIGN
WORD36
      4732**DCL      4906<<ASSIGN   4907<<ASSIGN   4937<<ASSIGN   4938<<ASSIGN   4939<<ASSIGN   4970<<ASSIGN
      5036<<ASSIGN   5036>>ASSIGN
WRITSF
        28**DCL-ENT  4880--CALL
ZIG$ADD_SI
        29**DCL-ENT  4798--CALL
ZIG$G_DYN_MEM_6
      2721**DCL-ENT  4758--CALL     4803--CALL     4806--CALL     4809--CALL     4901--CALL     4928--CALL
      4929--CALL     4966--CALL     5000--CALL     5062--CALL
ZIG$HASH_IT
        27**DCL-ENT  5033--CALL
