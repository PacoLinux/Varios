
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:1    
        1        1        /*M*     ZIG$DDS3     I-D-S/II   DBACS DIRECTIVE PARSER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$DDS3
        9        9        PURPOSE: TO CHECK DBACS WORDS AGAINST THE RESWORD TABLE.
       10       10                 TO MAKE SURE THAT M$PARSE DOESN'T BACKUP IN THE
       11       11                      THE STRING BEING PARSED.
       12       12                 TO GIVE A ERROR MESSAGE THRU M$ERRMSC FOR EACH
       13       13                      SYNTAX ERROR IT FIND THEN UNWIND BACK TO THE
       14       14                      THE SUB 'DRIV' .
       15       15                 TO GEWT MORE INPUT IF M$PARSE ASKS FOR IT.
       16       16        ****/
       17       17        /*****   ***/
       18       18        ZIG$DDS3:
       19       19            PROC (PARAN) ;
       20       20    1   DCL PUT_OUT_LINE ENTRY(2); /* Write out a line */
       21       21    1   DCL LIST_STRING CHAR (128) EXT;
       22       22    1   DCL NUM_CHAR_READ SBIN(36) EXT;
       23       23    1   DCL UNWIND_VAL BIT(72) SYMREF;
       24       24    1   DCL I UBIN (36);
       25       25    1   DCL ZIG$DDS2 ENTRY; /* Read thru M$SI */
       26       26    1   DCL ZIG$DDER ENTRY (1); /* Put out error */
       27       27    1   DCL ZIG$DDS4 ENTRY (1); /* Set up flags for dbacs directive */
       28       28    1   DCL X$PARSE ENTRY (1);
       29       29    1   DCL TEST_YEAR1 CHAR(6) STATIC;
       30       30    1   DCL 1 TEST_YEAR REDEF TEST_YEAR1,
       31       31    1         2 YY CHAR(2),
       32       32    1         2 MM CHAR(2),
       33       33    1         2 DD CHAR(2);
       34       34    1   DCL LINE_COUNT UBIN (36) EXT;
       35       35    1   DCL LINE CHAR (4000) EXT;
       36       36    1   DCL LAST_COUNT UBIN (36) SYMREF;
       37       37    1   DCL EOFFLG UBIN (36) EXT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:2    
       38       38    1   DCL LINE_NUM CHAR (4) EXT;
       39       39    1   DCL SAVESW BIT (1) EXT;
       40       40    1   DCL REC1 CHAR (80) EXT;
       41       41    1   DCL REC CHAR (80) EXT;
       42       42        %INCLUDE ZIG_GENERAL;
       43      150         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:3    
       44      151        /*********
       45      152                 This is the res. Word table.
       46      153        **********/
       47      154    1   DCL 1 RES_WORD STATIC,
       48      155    1         2 LENGTH_2,
       49      156    1           3 WORD1 (0:6) CHAR (11) INIT (
       50      157    1    'IN','IS','NO','OF','ON','TO'),
       51      158    1           3 ARRAY_SIZE UBIN(36) INIT (6),
       52      159    1         2 LENGTH_3,
       53      160    1           3 WORD1 (0:11) CHAR (11) INIT (
       54      161    1    'ACT','ALL','DDL','DML','END','FOR','GEN','KEY',
       55      162    1    'REF','SET','TPR'),
       56      163    1           3 ARRAY_SIZE UBIN (36) INIT (11),
       57      164    1         2 LENGTH_4,
       58      165    1           3 WORD1 (0:18) CHAR (11) INIT (
       59      166    1    'ACTS','AREA','COPY','DATA','DIAG','DICT','DISP',
       60      167    1    'DMCL','FROM','KEYS','LOCK','MODE','NAME','NULL',
       61      168    1    'PERM','SETS','THRU','XREF'),
       62      169    1           3 ARRAY_SIZE UBIN (36) INIT (18),
       63      170    1         2 LENGTH_5,
       64      171    1           3 WORD1 (0:11) CHAR (11) INIT (
       65      172    1    'ALTER','AREAS','COBOL','CROSS','DIAGS','FIELD',
       66      173    1    'LOCKS','PURGE','TITLE','TRANS','VALID'),
       67      174    1           3 ARRAY_SIZE UBIN (36) INIT (11),
       68      175    1         2 LENGTH_6,
       69      176    1           3 WORD1 (0:10) CHAR (11) INIT (
       70      177    1    'ASSIGN','FIELDS','PERMIT','PROHIB','RECORD',
       71      178    1    'RENAME','REPORT','SCHEMA','SOURCE','SYSOUT'),
       72      179    1           3 ARRAY_SIZE UBIN (36) INIT (10),
       73      180    1         2 LENGTH_7,
       74      181    1           3 WORD1 (0:11) CHAR (11) INIT (
       75      182    1    'ANALYSE','ANALYZE','DISPLAY','FORTRAN',
       76      183    1    'INCLUDE','PRIVACY','RECORDS','REPLACE','REPORTS',
       77      184    1    'STORAGE','THROUGH'),
       78      185    1           3 ARRAY_SIZE UBIN (36) INIT (11),
       79      186    1         2 LENGTH_8,
       80      187    1           3 WORD1 (0:6) CHAR (11) INIT (
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:4    
       81      188    1    'ACTIVITY','GENERATE','KEY_NAME','SET_NAME',
       82      189    1    'VALIDATE','SUPPRESS'),
       83      190    1           3 ARRAY_SIZE UBIN (36) INIT (6),
       84      191    1         2 LENGTH_9,
       85      192    1           3 WORD1 (0:9) CHAR (11) INIT (
       86      193    1    'AREA_NAME','DATA_NAME','END_DBACS',
       87      194    1    'PERMITTED','REFERENCE','RETENTION',
       88      195    1    'STRUCTURE','SUBSCHEMA','TRANSLATE'),
       89      196    1           3 ARRAY_SIZE UBIN (36) INIT (9),
       90      197    1         2 LENGTH_10,
       91      198    1           3 WORD1 (0:5) CHAR (11) INIT (
       92      199    1    'ACTIVITIES','DIAGNOSTIC','DICTIONARY',
       93      200    1    'PROHIBITED','STRUCTURES'),
       94      201    1           3 ARRAY_SIZE UBIN (36) INIT (5),
       95      202    1         2 LENGTH_11,
       96      203    1           3 WORD1 (0:2) CHAR (11) INIT (
       97      204    1    'DIAGNOSTICS','RECORD_NAME'),
       98      205    1           3 ARRAY_SIZE UBIN (36) INIT (2);
       99      206    1   DCL ONLINE BIT (1) EXT INIT ('0'B);
      100      207         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:5    
      101      208        /********************************
      102      209          The include files and mac.
      103      210        *********************************/
      104      211         %INCLUDE CP_6_SUBS;
      105      751         %INCLUDE XU_MACRO_C;
      106     3857         %INCLUDE XU_SUBS_C;
      107     3949        %INCLUDE ZI_ERRORS_SUBS;
      108     4469         %P$PCB (NAME = PCB_DBACS,STCLASS = SYMREF);
      109     4670         %PARSE$PARAM (NAME= PARAN);
      110     4751         %PARSE$OUT (NAME = OUT,STCLASS = BASED);
      111     4796         %PARSE$SYM (NAME = SYM,
      112     4797         STCLASS = BASED);
      113     4835         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:6    
      114     4836        /*************
      115     4837                This part of the program
      116     4838            check what kind of return it is.
      117     4839            PARAN.TYPE = what M$PARSE is trying to tell the program.
      118     4840        **************/
      119     4841    2       DO CASE (PARAN.TYPE);
      120     4842         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:7    
      121     4843    2       CASE (%INPUT#);
      122     4844    2           IF EOFFLG ~= 0 THEN UNWIND TO UNWIND_VAL;
      123     4845    2           CALL ZIG$DDS2; /* Read thru M$SI */
      124     4846         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:8    
      125     4847        /********
      126     4848                 Look to see if the word returned by M$PARSE
      127     4849            is a res word. If it is then reject the sucess of
      128     4850            the pressent node.
      129     4851        *********/
      130     4852    2       CASE (%SUCC#);
      131     4853    2           IF (PARAN.CODE = 50)
      132     4854    3           THEN DO;
      133     4855    4               DO CASE (PARAN.OUT$ -> OUT.SUBLK$(0) -> SYM.COUNT);
      134     4856    4               CASE (2);
      135     4857    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_2.WORD1,
      136     4858    4                      2,RES_WORD.LENGTH_2.ARRAY_SIZE);
      137     4859    4               CASE (3);
      138     4860    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_3.WORD1,
      139     4861    4                      3,RES_WORD.LENGTH_3.ARRAY_SIZE);
      140     4862    4               CASE (4);
      141     4863    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_4.WORD1,
      142     4864    4                      4,RES_WORD.LENGTH_4.ARRAY_SIZE);
      143     4865    4               CASE (5);
      144     4866    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_5.WORD1,
      145     4867    4                      5,RES_WORD.LENGTH_5.ARRAY_SIZE);
      146     4868    4               CASE (6);
      147     4869    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_6.WORD1,
      148     4870    4                      6,RES_WORD.LENGTH_6.ARRAY_SIZE);
      149     4871    4               CASE (7);
      150     4872    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_7.WORD1,
      151     4873    4                      7,RES_WORD.LENGTH_7.ARRAY_SIZE);
      152     4874    4               CASE (8);
      153     4875    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_8.WORD1,
      154     4876    4                      8,RES_WORD.LENGTH_8.ARRAY_SIZE);
      155     4877    4               CASE (9);
      156     4878    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_9.WORD1,
      157     4879    4                      9,RES_WORD.LENGTH_9.ARRAY_SIZE);
      158     4880    4               CASE (10);
      159     4881    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_10.WORD1,
      160     4882    4                      10,RES_WORD.LENGTH_10.ARRAY_SIZE);
      161     4883    4               CASE (11);
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:9    
      162     4884    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_11.WORD1,
      163     4885    4                      11,RES_WORD.LENGTH_11.ARRAY_SIZE);
      164     4886    4               CASE (ELSE);
      165     4887    4                   IF PARAN.OUT$->OUT.SUBLK$(0)->SYM.COUNT>30
      166     4888    5                   THEN DO;
      167     4889    5                       CALL ZIG$DDER1(1991);
      168     4890    5                       UNWIND TO UNWIND_VAL;
      169     4891        /*E*     ERROR:    ZIG-EZI$NAME_TO_LONG-C
      170     4892            MESSAGE:  All DBACS names must be less than or equal to
      171     4893                      30 characters; this one is too long.
      172     4894        */
      173     4895    5                       END;
      174     4896    4                   END;
      175     4897    3               END;
      176     4898    2           ELSE IF (PARAN.CODE=804 | PARAN.CODE = 805 | PARAN.CODE = 203)
      177     4899    3               THEN DO;
      178     4900    3                   TEST_YEAR1 = PARAN.OUT$ -> OUT.SUBLK$(0) -> SYM.TEXT;
      179     4901    3                   IF (TEST_YEAR.MM<'13'&TEST_YEAR.MM>'00' &
      180     4902    3                      TEST_YEAR.DD<'32' &TEST_YEAR.DD>'00' &
      181     4903    3                      TEST_YEAR.YY>'78' OR TEST_YEAR.YY<'21')
      182     4904    4                   THEN DO;
      183     4905    4                       PARAN.ACCEPT = '1'B;
      184     4906    4                       RETURN;
      185     4907    4                       END;
      186     4908    4                   ELSE DO;
      187     4909    4                       CALL ZIG$DDER1(1804);
      188     4910    4                       UNWIND TO UNWIND_VAL;
      189     4911    4                       END;
      190     4912    3                   END;
      191     4913    2               ELSE IF PARAN.CODE = 606 | PARAN.CODE=7
      192     4914         /* Set locks or privacy key */
      193     4915    3                   THEN DO;
      194     4916    3                       I= PARAN.OUT$->OUT.SUBLK$(0)->SYM.COUNT;
      195     4917    3                       IF I>12
      196     4918    4                       THEN DO;
      197     4919    4                           CALL ZIG$DDER1(EZI$LOCK_TO_LONG);
      198     4920    4                           END;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:10   
      199     4921    4                       ELSE DO;
      200     4922        /***********
      201     4923        	replace the lock that is to be displayed in
      202     4924        	the writing out of the directive with a '?'.
      203     4925        ***********/
      204     4926    4                           CALL INSERT(REC,PARAN.CHARPOS-LAST_COUNT-2-I,I+2,'?  ');
      205     4927    4                           END;
      206     4928        /*E*     ERROR:    ZIG-EZI$LOCK_TO_LONG-C
      207     4929            MESSAGE:  Lock value or key longer than 12 characters.
      208     4930                      Lock will not be set or key will be truncated.
      209     4931        */
      210     4932    3                       END;
      211     4933        /*E*     ERROR:    ZIG-EZI$DATA_NOPR-C
      212     4934                 MESSAGE:  Directive not processed.
      213     4935                           Above data was bypassed.
      214     4936        */
      215     4937        /*************
      216     4938                 This part is to handle the syntax errors in the dbacs
      217     4939            directive. It prints the message with a call to PUT_OU_ERROR
      218     4940            and the unwinds out of M$PARSE.
      219     4941        *************/
      220     4942    2       CASE (%FAIL#);
      221     4943    2           IF PARAN.CODE = 0
      222     4944    3           THEN DO;
      223     4945    3               CALL ZIG$DDER1(EZI$DATA_NOPR);
      224     4946    3               END;
      225     4947        /**********
      226     4948                 We don't even have a dbacs directive to begin parsing
      227     4949            on so we will not try in parse it.
      228     4950        ***********/
      229     4951    3           ELSE DO;
      230     4952    3               LIST_STRING = '  ';CALL LIST(LIST_STRING);
      231     4953    3               CALL ZIG$DDER1(1000+PARAN.CODE); /* Put out error */
      232     4954        /******
      233     4955                 These are now the error messages!!
      234     4956           []
      235     4957        *******/
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:11   
      236     4958        /*****   EZI$TRANS = 1001                 ***********/
      237     4959        /*E*     ERROR:    ZIG-EZI$TRANS-C
      238     4960                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      239     4961                           TRANSLATE (SCHEMA | FORTRAN | COBOL | APL | BASIC)
      240     4962        */
      241     4963        /*****   EZI$SCHEMA = 1002                 ***********/
      242     4964        /*E*     ERROR:    ZIG-EZI$SCHEMA-C
      243     4965                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      244     4966                           SCHEMA schema_name (DDL | DMCL)
      245     4967        */
      246     4968        /*E*     ERROR:    ZIG-1020-C
      247     4969        MESSAGE: Syntax error: An error in an option was found or no END
      248     4970                 at the end of the directive.
      249     4971        */
      250     4972        /*****   EZI$LANG = 1100                 ***********/
      251     4973        /*E*     ERROR:    ZIG-EZI$LANG-C
      252     4974                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      253     4975                           (APL | COBOL | FORTRAN | BASIC) SUBSCHEMA schema_name DDL
      254     4976        */
      255     4977        /*****   EZI$SCHEMA_NAME = 1101                 ***********/
      256     4978        /*E*     ERROR:    ZIG-EZI$SCHEMA_NAME-C
      257     4979                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      258     4980                           SCHEMA [NAME] [IS] schema_name
      259     4981        */
      260     4982        /*****   EZI$MODE_ALTER = 1401                 ***********/
      261     4983        /*E*     ERROR:    ZIG-EZI$MODE_ALTER-C
      262     4984                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      263     4985                           MODE [IS] ALTER
      264     4986        */
      265     4987        /*****   EZI$REPORT = 1403                 ***********/
      266     4988        /*E*     ERROR:    ZIG-EZI$REPORT-C
      267     4989                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      268     4990                           (NO | SUPPRESS) REPORT [ON] [|| DATA | STORAGE ||] STRUCTURES
      269     4991        */
      270     4992        /*****   EZI$XREF = 1301                 ***********/
      271     4993        /*E*     ERROR:    ZIG-EZI$XREF-C
      272     4994                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:12   
      273     4995                           (NO | SUPPRESS) ( XREF | CROSS REFERENCE)
      274     4996        */
      275     4997        /*****    EZI$ALLOCPGS = 1303                 ***********/
      276     4998        /*E*      ERROR:    ZIG-EZI$ALLOCPGS-C
      277     4999                  MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      278     5000                            ALLOCATE num_pages PAGES
      279     5001        */
      280     5002        /*****    EZI$ADDPGS = 1304                 ***********/
      281     5003        /*E*      ERROR:    ZIG-EZI$ADDPGS-C
      282     5004                  MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      283     5005                            ADD num_pages PAGES
      284     5006        */
      285     5007        /*****    EZI$NUMPGS = 1305                 ***********/
      286     5008        /*E*      ERROR:    ZIG-EZI$NUMPGS-C
      287     5009                  MESSAGE:  The number of pages specified must be an integer.
      288     5010        */
      289     5011        /*****   EZI$GENERATE = 1500                 ***********/
      290     5012        /*E*     ERROR:    ZIG-EZI$GENERATE-C
      291     5013                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      292     5014                      GEN/ERATE (APL | COBOL | FORTRAN | BASIC) SUBSCHEMA subscheme_name DDL
      293     5015                           SCHEMA NAME IS schema_name
      294     5016        */
      295     5017        /*****   EZI$RENAME = 1503                 ***********/
      296     5018        /*E*     ERROR:    ZIG-EZI$RENAME-C
      297     5019                 MESSAGE:  THE RENAME OPTION MUST BE FOLLOWED BY A KEYWORD
      298     5020                           THEN PAIRS OF DBACS_NAMES.
      299     5021        */
      300     5022        /*****   EZI$LOCKS = 1600                 ***********/
      301     5023        /*E*     ERROR:    ZIG-EZI$LOCKS-C
      302     5024                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      303     5025                           ASSIGN LOCKS [TO] SCHEMA schema_name
      304     5026        */
      305     5027        /*****   EZI$REPORT_LOCKS = 1603                 ***********/
      306     5028        /*E*     ERROR:    ZIG-EZI$REPORT_LOCKS-C
      307     5029                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      308     5030                           (NO | SUPRESS) REPORT [ON] LOCKS
      309     5031        */
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:13   
      310     5032        /*****   EZI$SET = 1604                 ***********/
      311     5033        /*E*     ERROR:    ZIG-EZI$SET-C
      312     5034                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      313     5035                           SET lock_name [TO] ( NULL | lock_value)
      314     5036        */
      315     5037        /*****   EZI$VALIDATE = 1700                 ***********/
      316     5038        /*E*     ERROR:    ZIG-EZI$VALIDATE-C
      317     5039                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      318     5040                           ( VALID | VALIDATE) SUBSCHEMA subschema_name
      319     5041        */
      320     5042        /*****   EZI$REPORT_P = 1702                 ***********/
      321     5043        /*E*     ERROR:    ZIG-EZI$REPORT_P-C
      322     5044                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      323     5045                           (NO | SUPRESS) REPORT [ON] [||PERMITTED | PROHIBITED |
      324     5046                           AREA | SETS | RECORDS | DBPARAN ||] DML
      325     5047        */
      326     5048        /*****   EZI$MODE_TPR = 1705                 ***********/
      327     5049        /*E*     ERROR:    ZIG-EZI$MODE_TPR-C
      328     5050                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      329     5051                           MODE [IS] TPR
      330     5052        */
      331     5053        /*****   EZI$INCLUDE = 1706                 ***********/
      332     5054        /*E*     ERROR:    ZIG-EZI$INCLUDE-C
      333     5055                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      334     5056                           INCLUDE DATA_NAMES [IN] [STRUCTURES]
      335     5057        */
      336     5058        /*****   EZI$DISPLAY = 1003                 ***********/
      337     5059        /*E*     ERROR:    ZIG-EZI$DISPLAY-C
      338     5060                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      339     5061                           DISPLAY SCHEMA schema_name (DICT|DDL|DMCL|ACTIVITIES)
      340     5062                           OR
      341     5063                           DISPLAY SUBSCHEMA subschema_name (DDL|DICT)
      342     5064                           SCHEMA [NAME] [IS] schema_name
      343     5065        */
      344     5066        /*****   EZI$FROM = 1802                 ***********/
      345     5067        /*E*     ERROR:    ZIG-EZI$FROM-C
      346     5068                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:14   
      347     5069                           FROM yymmdd [ THRU yymmdd]
      348     5070        */
      349     5071        /*****   EZI$YEAR1 = 1804                 ***********/
      350     5072        /*E*     ERROR:    ZIG-EZI$YEAR1-C
      351     5073        MESSAGE:  The year must be in the format YYMMDD where YY is greater
      352     5074                 than 80, MM is less than 13, and DD is less than 32.
      353     5075        */
      354     5076        /*****   EZI$YEAR2 = 1805                 ***********/
      355     5077        /*E*     ERROR:    ZIG-EZI$YEAR2-C
      356     5078        MESSAGE:  The year must be in the format YYMMDD where YY is greater
      357     5079                 than 80, MM is less than 13, and DD is less than 32.
      358     5080        */
      359     5081        /*****   EZI$PURGE = 1200                 ***********/
      360     5082        /*E*     ERROR:    ZIG-EZI$PURGE-C
      361     5083                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      362     5084                           PURGE SCHEMA schema_name ( DDL | DMCL | ACTIVITIES | DICTIONARY )
      363     5085                           OR
      364     5086                           PURGE SUB/SCHEMA subschema_name ACT/IVITIES
      365     5087                                SCHEMA NAME IS schema_name
      366     5088        */
      367     5089        /*****   EZI$ALL = 1953                 ***********/
      368     5090        /*E*     ERROR:    ZIG-EZI$ALL-C
      369     5091                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      370     5092                           ALL (SCHEMA | AREA | SET | KEY | RECORD | FIELD)
      371     5093        */
      372     5094        /*****   EZI$RETENTION = 1203                 ***********/
      373     5095        /*E*     ERROR:    ZIG-EZI$RETENTION-C
      374     5096                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      375     5097                           RETENTION [IS] yymmdd
      376     5098        */
      377     5099        /*****   EZI$SUB_NAME = 1204                 ***********/
      378     5100        /*E*     ERROR:    ZIG-EZI$SUB_NAME-C
      379     5101                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      380     5102                           SUBSCHEMA [NAME] [IS] (ALL | subschema_name ...)
      381     5103        */
      382     5104        /*****   EZI$COPY5 = 1501                 ***********/
      383     5105        /*E*     ERROR:    ZIG-EZI$COPY5-C
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:15   
      384     5106                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      385     5107                           COPY SOURCE [TO] "file_code"
      386     5108        */
      387     5109        /*****   EZI$COPY8 = 1803                 ***********/
      388     5110        /*E*     ERROR:    ZIG-EZI$COPY8-C
      389     5111                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      390     5112                           COPY SOURCE [TO] "file_code"
      391     5113        */
      392     5114        /*****   EZI$COPY85 = 1852                 ***********/
      393     5115        /*E*     ERROR:    ZIG-EZI$COPY85-C
      394     5116                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      395     5117                           COPY SOURCE [TO] "file_code"
      396     5118        */
      397     5119        /*****   EZI$PRIVACY4 = 1402                 ***********/
      398     5120        /*E*     ERROR:    ZIG-EZI$PRIVACY4-C
      399     5121                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      400     5122                           [PRIVACY] KEY [FOR] ALTER [IS] "privacy_key"
      401     5123        */
      402     5124        /*****   EZI$PRIVACY5 = 1504                 ***********/
      403     5125        /*E*     ERROR:    ZIG-EZI$PRIVACY5-C
      404     5126                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      405     5127                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      406     5128        */
      407     5129        /*****   EZI$PRIVACY6 = 1602                 ***********/
      408     5130        /*E*     ERROR:    ZIG-EZI$PRIVACY6-C
      409     5131                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      410     5132                           [PRIVACY] KEY [FOR] LOCKS [IS] "privacy_key"
      411     5133        */
      412     5134        /*****   EZI$PRIVACY7 = 1707                 ***********/
      413     5135        /*E*     ERROR:    ZIG-EZI$PRIVACY7-C
      414     5136                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      415     5137                           [PRIVACY] KEY [FOR] (COPY|DIAGNOSTICS) [IS] "privacy_key"
      416     5138        */
      417     5139        /*****   EZI$PRIVACY8 = 1801                 ***********/
      418     5140        /*E*     ERROR:    ZIG-EZI$PRIVACY8-C
      419     5141                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      420     5142                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:16   
      421     5143        */
      422     5144        /*****   EZI$PRIVACY85 = 1851                 ***********/
      423     5145        /*E*     ERROR:    ZIG-EZI$PRIVACY85-C
      424     5146                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      425     5147                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      426     5148        */
      427     5149        /*****   EZI$PRIVACY9 = 1901                 ***********/
      428     5150        /*E*     ERROR:    ZIG-EZI$PRIVACY9-C
      429     5151                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      430     5152                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      431     5153        */
      432     5154        /*****   EZI$PRIVACY95 = 1951                 ***********/
      433     5155        /*E*     ERROR:    ZIG-EZI$PRIVACY95-C
      434     5156                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      435     5157                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      436     5158        */
      437     5159        /*****   EZI$END = 1099                 ***********/
      438     5160        /*E*     ERROR:    ZIG-EZI$END-C
      439     5161                 MESSAGE:  It was looking for an END and did not find one
      440     5162                           so either you need an END or an option is wrong.
      441     5163        */
      442     5164        /*****   EZI$ALIAS = 1505                 ***********/
      443     5165        /*E*     ERROR:    ZIG-EZI$ALIAS-C
      444     5166                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      445     5167                           dbacs_name [TO] alias_name
      446     5168        */
      447     5169        /*E*     ERROR: ZIG-1850-C
      448     5170        MESSAGE: SYNTAX ERROR THE FORMAT IS:
      449     5171                 [DBACS] DISPLAY SUBSCHEMA subschema-name DDL
      450     5172                 SCHEMA [NAME] [IS] schema-name
      451     5173        */
      452     5174        /*E*     ERROR: ZIG-1900-C
      453     5175        MESSAGE: SYNTAX ERROR THE FORMAT IS:
      454     5176                 [DBACS] DISPLAY SUBSCHEMA subschema-name DICT
      455     5177                 SCHEMA [NAME] [IS] schema-name
      456     5178        */
      457     5179    3               END;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:17   
      458     5180        /************
      459     5181        	return to ZIG$DDS1 but don't let X$PARSE
      460     5182        	GET control again because we have a fatal error
      461     5183        	and we don't want X$PARSE to try and find a good
      462     5184        	dbacs directive when there isn't one there.
      463     5185        	(to save time bye stopping X$PARSE when we find a error).
      464     5186        ************/
      465     5187    2           UNWIND TO UNWIND_VAL;
      466     5188    2       CASE (%PRE#);
      467     5189    2           END;
      468     5190         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:18   
      469     5191        /***
      470     5192                 Subroutine to search the res. Word table.
      471     5193                   The user can't use res word as a dbacs name.
      472     5194        ********/
      473     5195    1   SEARCH_RES_WORD:
      474     5196    1       PROC (WORD1,CHAR_SIZE,ARRAY_SIZE);
      475     5197    2   DCL WORD1 (0:20) CHAR (11);
      476     5198    2   DCL CHAR_SIZE UBIN (36);
      477     5199    2   DCL ARRAY_SIZE UBIN (36);
      478     5200    2   DCL I UBIN (36);
      479     5201    2   DCL TEST_STRING CHAR (11) STATIC;
      480     5202    2       TEST_STRING = PARAN.OUT$ -> OUT.SUBLK$(0) -> SYM.TEXT;
      481     5203    3       DO I = 0 TO ARRAY_SIZE-1;
      482     5204    3           IF (SUBSTR(WORD1(I),0,CHAR_SIZE) = SUBSTR(TEST_STRING,0,CHAR_SIZE))
      483     5205    4           THEN DO;
      484     5206    4               PARAN.REJECT = '1'B;
      485     5207    4               RETURN;
      486     5208    4               END;
      487     5209    3           END;
      488     5210    2       PARAN.ACCEPT = '1'B;
      489     5211    2       RETURN;
      490     5212    2   END SEARCH_RES_WORD;
      491     5213    1   ZIG$DDER1:
      492     5214    1       PROC (PAR1);
      493     5215        /************
      494     5216                  Put out the error that X$PARSE found only
      495     5217                  after printing out the last line input so the
      496     5218                  so the message corresponse to the line printed.
      497     5219                  Set savesw show that there is no line to print out
      498     5220                  before the next read.
      499     5221        ************/
      500     5222    2   DCL PAR1 UBIN (36);
      501     5223    2       IF SAVESW
      502     5224    3       THEN DO;
      503     5225    3           CALL PUT_OUT_LINE(LINE_COUNT,REC);
      504     5226    3           LINE_COUNT=LINE_COUNT+1;
      505     5227    3           SAVESW = '0'B;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:19   
      506     5228    3           END;
      507     5229    2       CALL ERROR(PAR1);
      508     5230    2       RETURN;
      509     5231    2   END ZIG$DDER1;
      510     5232    1   END ZIG$DDS3;

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:20   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$DDS3.

   Procedure ZIG$DDS3 requires 344 words for executable code.
   Procedure ZIG$DDS3 requires 20 words of local(AUTO) storage.

    No errors detected in file ZIG$DDS3.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:21   

 Object Unit name= ZIG$DDS3                                   File name= ZIG$DDS3.:ZIC0TOU
 UTS= SEP 05 '97 11:48:40.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    32     40  LIST_STRING
    1  LblCom even  none     1      1  NUM_CHAR_READ
    2   Data  even  none   292    444  ZIG$DDS3
    3  LblCom even  none     1      1  LINE_COUNT
    4  LblCom even  none  1000   1750  LINE
    5  LblCom even  none     1      1  EOFFLG
    6  LblCom even  none     1      1  LINE_NUM
    7  LblCom even  none     1      1  SAVESW
    8  LblCom even  none    20     24  REC1
    9  LblCom even  none    20     24  REC
   10  LblCom even  none     1      1  NUM_ERROR_MSG
   11  LblCom even  none     1      1  NUM_WARN_MSG
   12  LblCom even  none     1      1  ALLOCATE_END
   13  LblCom even  none     2      2  SUBSCHEMA_KEY
   14  LblCom even  none     1      1  BUFFER$
   15  LblCom even  none     1      1  ERROR_IO
   16  LblCom even  none     1      1  BUFFER_LEN
   17  LblCom even  none     2      2  UWA_KEY
   18  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   19  LblCom even  none     2      2  RVA_KEY
   20  LblCom even  none     2      2  IA__KEY
   21  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   22  LblCom even  none    32     40  SEARCHR_NB
   23  LblCom even  none    32     40  SEM_COM
   24  LblCom even  none    32     40  DMCL_XLATE
   25  LblCom even  none    32     40  Q2_PERCENT
   26  LblCom even  none     1      1  ONLINE
   27  RoData even  UTS      7      7  ZIG$DDS3
   28   Proc  even  none   344    530  ZIG$DDS3
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:22   
   29  RoData even  none    54     66  ZIG$DDS3

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    28      0   yes            yes      Std        1  ZIG$DDS3

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 ZIG$DDS2
         yes           Std       1 LIST
         yes           Std       2 PUT_OUT_LINE
         yes           Std       1 ERROR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     UNWIND_VAL                            LAST_COUNT                            PCB_DBACS

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:23   


        1        1        /*M*     ZIG$DDS3     I-D-S/II   DBACS DIRECTIVE PARSER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$DDS3
        9        9        PURPOSE: TO CHECK DBACS WORDS AGAINST THE RESWORD TABLE.
       10       10                 TO MAKE SURE THAT M$PARSE DOESN'T BACKUP IN THE
       11       11                      THE STRING BEING PARSED.
       12       12                 TO GIVE A ERROR MESSAGE THRU M$ERRMSC FOR EACH
       13       13                      SYNTAX ERROR IT FIND THEN UNWIND BACK TO THE
       14       14                      THE SUB 'DRIV' .
       15       15                 TO GEWT MORE INPUT IF M$PARSE ASKS FOR IT.
       16       16        ****/
       17       17        /*****   ***/
       18       18        ZIG$DDS3:
       19       19            PROC (PARAN) ;

     19 28 000000   000000 700200 xent  ZIG$DDS3     TSX0  ! X66_AUTO_1
        28 000001   000024 000001                    ZERO    20,1

       20       20    1   DCL PUT_OUT_LINE ENTRY(2); /* Write out a line */
       21       21    1   DCL LIST_STRING CHAR (128) EXT;
       22       22    1   DCL NUM_CHAR_READ SBIN(36) EXT;
       23       23    1   DCL UNWIND_VAL BIT(72) SYMREF;
       24       24    1   DCL I UBIN (36);
       25       25    1   DCL ZIG$DDS2 ENTRY; /* Read thru M$SI */
       26       26    1   DCL ZIG$DDER ENTRY (1); /* Put out error */
       27       27    1   DCL ZIG$DDS4 ENTRY (1); /* Set up flags for dbacs directive */
       28       28    1   DCL X$PARSE ENTRY (1);
       29       29    1   DCL TEST_YEAR1 CHAR(6) STATIC;
       30       30    1   DCL 1 TEST_YEAR REDEF TEST_YEAR1,
       31       31    1         2 YY CHAR(2),
       32       32    1         2 MM CHAR(2),
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:24   
       33       33    1         2 DD CHAR(2);
       34       34    1   DCL LINE_COUNT UBIN (36) EXT;
       35       35    1   DCL LINE CHAR (4000) EXT;
       36       36    1   DCL LAST_COUNT UBIN (36) SYMREF;
       37       37    1   DCL EOFFLG UBIN (36) EXT;
       38       38    1   DCL LINE_NUM CHAR (4) EXT;
       39       39    1   DCL SAVESW BIT (1) EXT;
       40       40    1   DCL REC1 CHAR (80) EXT;
       41       41    1   DCL REC CHAR (80) EXT;
       42       42        %INCLUDE ZIG_GENERAL;
       43      150         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:25   
       44      151        /*********
       45      152                 This is the res. Word table.
       46      153        **********/
       47      154    1   DCL 1 RES_WORD STATIC,
       48      155    1         2 LENGTH_2,
       49      156    1           3 WORD1 (0:6) CHAR (11) INIT (
       50      157    1    'IN','IS','NO','OF','ON','TO'),
       51      158    1           3 ARRAY_SIZE UBIN(36) INIT (6),
       52      159    1         2 LENGTH_3,
       53      160    1           3 WORD1 (0:11) CHAR (11) INIT (
       54      161    1    'ACT','ALL','DDL','DML','END','FOR','GEN','KEY',
       55      162    1    'REF','SET','TPR'),
       56      163    1           3 ARRAY_SIZE UBIN (36) INIT (11),
       57      164    1         2 LENGTH_4,
       58      165    1           3 WORD1 (0:18) CHAR (11) INIT (
       59      166    1    'ACTS','AREA','COPY','DATA','DIAG','DICT','DISP',
       60      167    1    'DMCL','FROM','KEYS','LOCK','MODE','NAME','NULL',
       61      168    1    'PERM','SETS','THRU','XREF'),
       62      169    1           3 ARRAY_SIZE UBIN (36) INIT (18),
       63      170    1         2 LENGTH_5,
       64      171    1           3 WORD1 (0:11) CHAR (11) INIT (
       65      172    1    'ALTER','AREAS','COBOL','CROSS','DIAGS','FIELD',
       66      173    1    'LOCKS','PURGE','TITLE','TRANS','VALID'),
       67      174    1           3 ARRAY_SIZE UBIN (36) INIT (11),
       68      175    1         2 LENGTH_6,
       69      176    1           3 WORD1 (0:10) CHAR (11) INIT (
       70      177    1    'ASSIGN','FIELDS','PERMIT','PROHIB','RECORD',
       71      178    1    'RENAME','REPORT','SCHEMA','SOURCE','SYSOUT'),
       72      179    1           3 ARRAY_SIZE UBIN (36) INIT (10),
       73      180    1         2 LENGTH_7,
       74      181    1           3 WORD1 (0:11) CHAR (11) INIT (
       75      182    1    'ANALYSE','ANALYZE','DISPLAY','FORTRAN',
       76      183    1    'INCLUDE','PRIVACY','RECORDS','REPLACE','REPORTS',
       77      184    1    'STORAGE','THROUGH'),
       78      185    1           3 ARRAY_SIZE UBIN (36) INIT (11),
       79      186    1         2 LENGTH_8,
       80      187    1           3 WORD1 (0:6) CHAR (11) INIT (
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:26   
       81      188    1    'ACTIVITY','GENERATE','KEY_NAME','SET_NAME',
       82      189    1    'VALIDATE','SUPPRESS'),
       83      190    1           3 ARRAY_SIZE UBIN (36) INIT (6),
       84      191    1         2 LENGTH_9,
       85      192    1           3 WORD1 (0:9) CHAR (11) INIT (
       86      193    1    'AREA_NAME','DATA_NAME','END_DBACS',
       87      194    1    'PERMITTED','REFERENCE','RETENTION',
       88      195    1    'STRUCTURE','SUBSCHEMA','TRANSLATE'),
       89      196    1           3 ARRAY_SIZE UBIN (36) INIT (9),
       90      197    1         2 LENGTH_10,
       91      198    1           3 WORD1 (0:5) CHAR (11) INIT (
       92      199    1    'ACTIVITIES','DIAGNOSTIC','DICTIONARY',
       93      200    1    'PROHIBITED','STRUCTURES'),
       94      201    1           3 ARRAY_SIZE UBIN (36) INIT (5),
       95      202    1         2 LENGTH_11,
       96      203    1           3 WORD1 (0:2) CHAR (11) INIT (
       97      204    1    'DIAGNOSTICS','RECORD_NAME'),
       98      205    1           3 ARRAY_SIZE UBIN (36) INIT (2);
       99      206    1   DCL ONLINE BIT (1) EXT INIT ('0'B);
      100      207         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:27   
      101      208        /********************************
      102      209          The include files and mac.
      103      210        *********************************/
      104      211         %INCLUDE CP_6_SUBS;
      105      751         %INCLUDE XU_MACRO_C;
      106     3857         %INCLUDE XU_SUBS_C;
      107     3949        %INCLUDE ZI_ERRORS_SUBS;
      108     4469         %P$PCB (NAME = PCB_DBACS,STCLASS = SYMREF);
      109     4670         %PARSE$PARAM (NAME= PARAN);
      110     4751         %PARSE$OUT (NAME = OUT,STCLASS = BASED);
      111     4796         %PARSE$SYM (NAME = SYM,
      112     4797         STCLASS = BASED);
      113     4835         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:28   
      114     4836        /*************
      115     4837                This part of the program
      116     4838            check what kind of return it is.
      117     4839            PARAN.TYPE = what M$PARSE is trying to tell the program.
      118     4840        **************/
      119     4841    2       DO CASE (PARAN.TYPE);

   4841 28 000002   200003 470500                    LDP0    @PARAN,,AUTO
        28 000003   000000 236100                    LDQ     0,,PR0
        28 000004   000033 772000                    QRL     27
        28 000005   000005 116007                    CMPQ    5,DL
        28 000006   000010 602006 28                 TNC     s:4841+6,QL
        28 000007   000436 710000 28                 TRA     s:5189
        28 000010   000436 710000 28                 TRA     s:5189
        28 000011   000436 710000 28                 TRA     s:5189
        28 000012   000031 710000 28                 TRA     s:4853
        28 000013   000401 710000 28                 TRA     s:4943
        28 000014   000015 710000 28                 TRA     s:4844

      120     4842         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:29   
      121     4843    2       CASE (%INPUT#);

      122     4844    2           IF EOFFLG ~= 0 THEN UNWIND TO UNWIND_VAL;

   4844 28 000015   000000 235000 5                  LDA     EOFFLG
        28 000016   000025 600000 28                 TZE     s:4845

   4844 28 000017   000100 100600                    MLR   ! fill='000'O
        28 000020   000000 000010 xsym               ADSC9   UNWIND_VAL               cn=0,n=8
        28 000021   200014 000010                    ADSC9   I+2,,AUTO                cn=0,n=8
        28 000022   200014 237300                    LDAQ  ! I+2,,AUTO
        28 000023   000000 700200 xent               TSX0  ! X66_AUNWIND
        28 000024   000000 000200                    ZERO    0,128

      123     4845    2           CALL ZIG$DDS2; /* Read thru M$SI */

   4845 28 000025   000000 631400 29                 EPPR1   0
        28 000026   000000 701000 xent               TSX1    ZIG$DDS2
        28 000027   000000 011000                    NOP     0
        28 000030   000436 710000 28                 TRA     s:5189

      124     4846         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:30   
      125     4847        /********
      126     4848                 Look to see if the word returned by M$PARSE
      127     4849            is a res word. If it is then reject the sucess of
      128     4850            the pressent node.
      129     4851        *********/
      130     4852    2       CASE (%SUCC#);

      131     4853    2           IF (PARAN.CODE = 50)

   4853 28 000031   000000 720100                    LXL0    0,,PR0
        28 000032   000062 100003                    CMPX0   50,DU
        28 000033   000202 601000 28                 TNZ     s:4898

      132     4854    3           THEN DO;

      133     4855    4               DO CASE (PARAN.OUT$ -> OUT.SUBLK$(0) -> SYM.COUNT);

   4855 28 000034   000002 471500                    LDP1    2,,PR0
        28 000035   100003 473500                    LDP3    3,,PR1
        28 000036   300004 236100                    LDQ     4,,PR3
        28 000037   000033 772000                    QRL     27
        28 000040   000014 116007                    CMPQ    12,DL
        28 000041   000043 602006 28                 TNC     s:4855+7,QL
        28 000042   000165 710000 28                 TRA     s:4887
        28 000043   000165 710000 28                 TRA     s:4887
        28 000044   000165 710000 28                 TRA     s:4887
        28 000045   000057 710000 28                 TRA     s:4857
        28 000046   000066 710000 28                 TRA     s:4860
        28 000047   000075 710000 28                 TRA     s:4863
        28 000050   000104 710000 28                 TRA     s:4866
        28 000051   000113 710000 28                 TRA     s:4869
        28 000052   000122 710000 28                 TRA     s:4872
        28 000053   000131 710000 28                 TRA     s:4875
        28 000054   000140 710000 28                 TRA     s:4878
        28 000055   000147 710000 28                 TRA     s:4881
        28 000056   000156 710000 28                 TRA     s:4884

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:31   
      134     4856    4               CASE (2);

      135     4857    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_2.WORD1,

   4857 28 000057   000002 237000 29                 LDAQ    2
        28 000060   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000061   000004 236000 29                 LDQ     4
        28 000062   200007 756100                    STQ     I+3,,AUTO
        28 000063   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000064   000000 011000                    NOP     0
        28 000065   000436 710000 28                 TRA     s:5189

      136     4858    4                      2,RES_WORD.LENGTH_2.ARRAY_SIZE);
      137     4859    4               CASE (3);

      138     4860    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_3.WORD1,

   4860 28 000066   000006 237000 29                 LDAQ    6
        28 000067   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000070   000010 236000 29                 LDQ     8
        28 000071   200007 756100                    STQ     I+3,,AUTO
        28 000072   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000073   000000 011000                    NOP     0
        28 000074   000436 710000 28                 TRA     s:5189

      139     4861    4                      3,RES_WORD.LENGTH_3.ARRAY_SIZE);
      140     4862    4               CASE (4);

      141     4863    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_4.WORD1,

   4863 28 000075   000012 237000 29                 LDAQ    10
        28 000076   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000077   000014 236000 29                 LDQ     12
        28 000100   200007 756100                    STQ     I+3,,AUTO
        28 000101   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000102   000000 011000                    NOP     0
        28 000103   000436 710000 28                 TRA     s:5189
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:32   

      142     4864    4                      4,RES_WORD.LENGTH_4.ARRAY_SIZE);
      143     4865    4               CASE (5);

      144     4866    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_5.WORD1,

   4866 28 000104   000016 237000 29                 LDAQ    14
        28 000105   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000106   000020 236000 29                 LDQ     16
        28 000107   200007 756100                    STQ     I+3,,AUTO
        28 000110   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000111   000000 011000                    NOP     0
        28 000112   000436 710000 28                 TRA     s:5189

      145     4867    4                      5,RES_WORD.LENGTH_5.ARRAY_SIZE);
      146     4868    4               CASE (6);

      147     4869    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_6.WORD1,

   4869 28 000113   000022 237000 29                 LDAQ    18
        28 000114   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000115   000024 236000 29                 LDQ     20
        28 000116   200007 756100                    STQ     I+3,,AUTO
        28 000117   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000120   000000 011000                    NOP     0
        28 000121   000436 710000 28                 TRA     s:5189

      148     4870    4                      6,RES_WORD.LENGTH_6.ARRAY_SIZE);
      149     4871    4               CASE (7);

      150     4872    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_7.WORD1,

   4872 28 000122   000026 237000 29                 LDAQ    22
        28 000123   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000124   000030 236000 29                 LDQ     24
        28 000125   200007 756100                    STQ     I+3,,AUTO
        28 000126   000437 701000 28                 TSX1    SEARCH_RES_WORD
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:33   
        28 000127   000000 011000                    NOP     0
        28 000130   000436 710000 28                 TRA     s:5189

      151     4873    4                      7,RES_WORD.LENGTH_7.ARRAY_SIZE);
      152     4874    4               CASE (8);

      153     4875    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_8.WORD1,

   4875 28 000131   000032 237000 29                 LDAQ    26
        28 000132   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000133   000034 236000 29                 LDQ     28
        28 000134   200007 756100                    STQ     I+3,,AUTO
        28 000135   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000136   000000 011000                    NOP     0
        28 000137   000436 710000 28                 TRA     s:5189

      154     4876    4                      8,RES_WORD.LENGTH_8.ARRAY_SIZE);
      155     4877    4               CASE (9);

      156     4878    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_9.WORD1,

   4878 28 000140   000036 237000 29                 LDAQ    30
        28 000141   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000142   000040 236000 29                 LDQ     32
        28 000143   200007 756100                    STQ     I+3,,AUTO
        28 000144   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000145   000000 011000                    NOP     0
        28 000146   000436 710000 28                 TRA     s:5189

      157     4879    4                      9,RES_WORD.LENGTH_9.ARRAY_SIZE);
      158     4880    4               CASE (10);

      159     4881    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_10.WORD1,

   4881 28 000147   000042 237000 29                 LDAQ    34
        28 000150   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000151   000044 236000 29                 LDQ     36
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:34   
        28 000152   200007 756100                    STQ     I+3,,AUTO
        28 000153   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000154   000000 011000                    NOP     0
        28 000155   000436 710000 28                 TRA     s:5189

      160     4882    4                      10,RES_WORD.LENGTH_10.ARRAY_SIZE);
      161     4883    4               CASE (11);

      162     4884    4                   CALL SEARCH_RES_WORD(RES_WORD.LENGTH_11.WORD1,

   4884 28 000156   000046 237000 29                 LDAQ    38
        28 000157   200010 757100                    STAQ    @PAR1+1,,AUTO
        28 000160   000050 236000 29                 LDQ     40
        28 000161   200007 756100                    STQ     I+3,,AUTO
        28 000162   000437 701000 28                 TSX1    SEARCH_RES_WORD
        28 000163   000000 011000                    NOP     0
        28 000164   000436 710000 28                 TRA     s:5189

      163     4885    4                      11,RES_WORD.LENGTH_11.ARRAY_SIZE);
      164     4886    4               CASE (ELSE);

      165     4887    4                   IF PARAN.OUT$->OUT.SUBLK$(0)->SYM.COUNT>30

   4887 28 000165   000033 736000                    QLS     27
        28 000166   037000 116003                    CMPQ    15872,DU
        28 000167   000436 602000 28                 TNC     s:5189

      166     4888    5                   THEN DO;

      167     4889    5                       CALL ZIG$DDER1(1991);

   4889 28 000170   000052 236000 29                 LDQ     42
        28 000171   200007 756100                    STQ     I+3,,AUTO
        28 000172   000506 701000 28                 TSX1    ZIG$DDER1
        28 000173   000000 011000                    NOP     0

      168     4890    5                       UNWIND TO UNWIND_VAL;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:35   

   4890 28 000174   000100 100600                    MLR   ! fill='000'O
        28 000175   000000 000010 xsym               ADSC9   UNWIND_VAL               cn=0,n=8
        28 000176   200014 000010                    ADSC9   I+2,,AUTO                cn=0,n=8
        28 000177   200014 237300                    LDAQ  ! I+2,,AUTO
        28 000200   000000 700200 xent               TSX0  ! X66_AUNWIND
        28 000201   000000 000200                    ZERO    0,128

      169     4891        /*E*     ERROR:    ZIG-EZI$NAME_TO_LONG-C
      170     4892            MESSAGE:  All DBACS names must be less than or equal to
      171     4893                      30 characters; this one is too long.
      172     4894        */
      173     4895    5                       END;
      174     4896    4                   END;

      175     4897    3               END;
      176     4898    2           ELSE IF (PARAN.CODE=804 | PARAN.CODE = 805 | PARAN.CODE = 203)

   4898 28 000202   400000 221003                    LDX1    -131072,DU
        28 000203   001444 100003                    CMPX0   804,DU
        28 000204   000206 600000 28                 TZE     s:4898+4
        28 000205   000000 221003                    LDX1    0,DU
        28 000206   400000 222003                    LDX2    -131072,DU
        28 000207   001445 100003                    CMPX0   805,DU
        28 000210   000212 600000 28                 TZE     s:4898+8
        28 000211   000000 222003                    LDX2    0,DU
        28 000212   000000 636012                    EAQ     0,X2
        28 000213   200014 756100                    STQ     I+2,,AUTO
        28 000214   000000 636011                    EAQ     0,X1
        28 000215   200014 276100                    ORQ     I+2,,AUTO
        28 000216   400000 220003                    LDX0    -131072,DU
        28 000217   000000 721100                    LXL1    0,,PR0
        28 000220   000313 101003                    CMPX1   203,DU
        28 000221   000223 600000 28                 TZE     s:4898+17
        28 000222   000000 220003                    LDX0    0,DU
        28 000223   200015 756100                    STQ     I+3,,AUTO
        28 000224   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:36   
        28 000225   200016 756100                    STQ     I+4,,AUTO
        28 000226   200015 236100                    LDQ     I+3,,AUTO
        28 000227   200016 276100                    ORQ     I+4,,AUTO
        28 000230   000336 600000 28                 TZE     s:4913

      177     4899    3               THEN DO;

      178     4900    3                   TEST_YEAR1 = PARAN.OUT$ -> OUT.SUBLK$(0) -> SYM.TEXT;

   4900 28 000231   000002 471500                    LDP1    2,,PR0
        28 000232   100003 473500                    LDP3    3,,PR1
        28 000233   300004 236100                    LDQ     4,,PR3
        28 000234   000033 772000                    QRL     27
        28 000235   000000 620006                    EAX0    0,QL
        28 000236   040000 100540                    MLR     fill='040'O
        28 000237   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
        28 000240   000000 000006 2                  ADSC9   TEST_YEAR1               cn=0,n=6

      179     4901    3                   IF (TEST_YEAR.MM<'13'&TEST_YEAR.MM>'00' &

   4901 28 000241   400000 221003                    LDX1    -131072,DU
        28 000242   000000 722000 2                  LXL2    TEST_YEAR1
        28 000243   000000 102000 27                 CMPX2   0
        28 000244   000246 602000 28                 TNC     s:4901+5
        28 000245   000000 221003                    LDX1    0,DU
        28 000246   400000 223003                    LDX3    -131072,DU
        28 000247   000001 102000 27                 CMPX2   1
        28 000250   000252 600000 28                 TZE     s:4901+9
        28 000251   000253 603000 28                 TRC     s:4901+10
        28 000252   000000 223003                    LDX3    0,DU
        28 000253   000000 636013                    EAQ     0,X3
        28 000254   200014 756100                    STQ     I+2,,AUTO
        28 000255   000000 636011                    EAQ     0,X1
        28 000256   200014 376100                    ANQ     I+2,,AUTO
        28 000257   400000 220003                    LDX0    -131072,DU
        28 000260   000001 221000 2                  LDX1    TEST_YEAR1+1
        28 000261   000002 101000 27                 CMPX1   2
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:37   
        28 000262   000264 602000 28                 TNC     s:4901+19
        28 000263   000000 220003                    LDX0    0,DU
        28 000264   200015 756100                    STQ     I+3,,AUTO
        28 000265   000000 636010                    EAQ     0,X0
        28 000266   200016 756100                    STQ     I+4,,AUTO
        28 000267   200015 236100                    LDQ     I+3,,AUTO
        28 000270   200016 376100                    ANQ     I+4,,AUTO
        28 000271   400000 220003                    LDX0    -131072,DU
        28 000272   000001 223000 27                 LDX3    1
        28 000273   000001 103000 2                  CMPX3   TEST_YEAR1+1
        28 000274   000276 602000 28                 TNC     s:4901+29
        28 000275   000000 220003                    LDX0    0,DU
        28 000276   200017 756100                    STQ     I+5,,AUTO
        28 000277   000000 636010                    EAQ     0,X0
        28 000300   200020 756100                    STQ     I+6,,AUTO
        28 000301   200017 236100                    LDQ     I+5,,AUTO
        28 000302   200020 376100                    ANQ     I+6,,AUTO
        28 000303   400000 220003                    LDX0    -131072,DU
        28 000304   000003 224000 27                 LDX4    3
        28 000305   000000 104000 2                  CMPX4   TEST_YEAR1
        28 000306   000310 602000 28                 TNC     s:4901+39
        28 000307   000000 220003                    LDX0    0,DU
        28 000310   200021 756100                    STQ     I+7,,AUTO
        28 000311   000000 636010                    EAQ     0,X0
        28 000312   200022 756100                    STQ     I+8,,AUTO
        28 000313   200021 236100                    LDQ     I+7,,AUTO
        28 000314   200022 376100                    ANQ     I+8,,AUTO
        28 000315   000321 601000 28                 TNZ     s:4905
        28 000316   000000 220000 2                  LDX0    TEST_YEAR1
        28 000317   000004 100000 27                 CMPX0   4
        28 000320   000324 603000 28                 TRC     s:4909

      180     4902    3                      TEST_YEAR.DD<'32' &TEST_YEAR.DD>'00' &
      181     4903    3                      TEST_YEAR.YY>'78' OR TEST_YEAR.YY<'21')
      182     4904    4                   THEN DO;

      183     4905    4                       PARAN.ACCEPT = '1'B;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:38   

   4905 28 000321   000400 236003                    LDQ     256,DU
        28 000322   000000 256100                    ORSQ    0,,PR0

      184     4906    4                       RETURN;

   4906 28 000323   000000 702200 xent               TSX2  ! X66_ARET

      185     4907    4                       END;
      186     4908    4                   ELSE DO;

      187     4909    4                       CALL ZIG$DDER1(1804);

   4909 28 000324   000054 236000 29                 LDQ     44
        28 000325   200007 756100                    STQ     I+3,,AUTO
        28 000326   000506 701000 28                 TSX1    ZIG$DDER1
        28 000327   000000 011000                    NOP     0

      188     4910    4                       UNWIND TO UNWIND_VAL;

   4910 28 000330   000100 100600                    MLR   ! fill='000'O
        28 000331   000000 000010 xsym               ADSC9   UNWIND_VAL               cn=0,n=8
        28 000332   200014 000010                    ADSC9   I+2,,AUTO                cn=0,n=8
        28 000333   200014 237300                    LDAQ  ! I+2,,AUTO
        28 000334   000000 700200 xent               TSX0  ! X66_AUNWIND
        28 000335   000000 000200                    ZERO    0,128

      189     4911    4                       END;
      190     4912    3                   END;
      191     4913    2               ELSE IF PARAN.CODE = 606 | PARAN.CODE=7

   4913 28 000336   400000 220003                    LDX0    -131072,DU
        28 000337   000000 721100                    LXL1    0,,PR0
        28 000340   001136 101003                    CMPX1   606,DU
        28 000341   000343 600000 28                 TZE     s:4913+5
        28 000342   000000 220003                    LDX0    0,DU
        28 000343   400000 222003                    LDX2    -131072,DU
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:39   
        28 000344   000007 101003                    CMPX1   7,DU
        28 000345   000347 600000 28                 TZE     s:4913+9
        28 000346   000000 222003                    LDX2    0,DU
        28 000347   000000 636012                    EAQ     0,X2
        28 000350   200014 756100                    STQ     I+2,,AUTO
        28 000351   000000 636010                    EAQ     0,X0
        28 000352   200014 276100                    ORQ     I+2,,AUTO
        28 000353   000436 600000 28                 TZE     s:5189

      192     4914         /* Set locks or privacy key */
      193     4915    3                   THEN DO;

      194     4916    3                       I= PARAN.OUT$->OUT.SUBLK$(0)->SYM.COUNT;

   4916 28 000354   000002 471500                    LDP1    2,,PR0
        28 000355   100003 473500                    LDP3    3,,PR1
        28 000356   300004 236100                    LDQ     4,,PR3
        28 000357   000033 772000                    QRL     27
        28 000360   200004 756100                    STQ     I,,AUTO

      195     4917    3                       IF I>12

   4917 28 000361   000015 116007                    CMPQ    13,DL
        28 000362   000370 602000 28                 TNC     s:4926

      196     4918    4                       THEN DO;

      197     4919    4                           CALL ZIG$DDER1(EZI$LOCK_TO_LONG);

   4919 28 000363   000056 236000 29                 LDQ     46
        28 000364   200007 756100                    STQ     I+3,,AUTO
        28 000365   000506 701000 28                 TSX1    ZIG$DDER1
        28 000366   000000 011000                    NOP     0

      198     4920    4                           END;

   4920 28 000367   000436 710000 28                 TRA     s:5189
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:40   

      199     4921    4                       ELSE DO;

      200     4922        /***********
      201     4923        	replace the lock that is to be displayed in
      202     4924        	the writing out of the directive with a '?'.
      203     4925        ***********/
      204     4926    4                           CALL INSERT(REC,PARAN.CHARPOS-LAST_COUNT-2-I,I+2,'?  ');

   4926 28 000370   000004 236100                    LDQ     4,,PR0
        28 000371   000000 136000 xsym               SBLQ    LAST_COUNT
        28 000372   200004 136100                    SBLQ    I,,AUTO
        28 000373   200004 720100                    LXL0    I,,AUTO
        28 000374   000002 621010                    EAX1    2,X0
        28 000375   040046 100400                    MLR     fill='040'O
        28 000376   000005 000003 27                 ADSC9   5                        cn=0,n=3
        28 000377   777777 400011 9                  ADSC9   REC-1,Q                  cn=2,n=*X1

      205     4927    4                           END;

      206     4928        /*E*     ERROR:    ZIG-EZI$LOCK_TO_LONG-C
      207     4929            MESSAGE:  Lock value or key longer than 12 characters.
      208     4930                      Lock will not be set or key will be truncated.
      209     4931        */
      210     4932    3                       END;

   4932 28 000400   000436 710000 28                 TRA     s:5189

      211     4933        /*E*     ERROR:    ZIG-EZI$DATA_NOPR-C
      212     4934                 MESSAGE:  Directive not processed.
      213     4935                           Above data was bypassed.
      214     4936        */
      215     4937        /*************
      216     4938                 This part is to handle the syntax errors in the dbacs
      217     4939            directive. It prints the message with a call to PUT_OU_ERROR
      218     4940            and the unwinds out of M$PARSE.
      219     4941        *************/
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:41   
      220     4942    2       CASE (%FAIL#);

      221     4943    2           IF PARAN.CODE = 0

   4943 28 000401   000000 720100                    LXL0    0,,PR0
        28 000402   000410 601000 28                 TNZ     s:4952

      222     4944    3           THEN DO;

      223     4945    3               CALL ZIG$DDER1(EZI$DATA_NOPR);

   4945 28 000403   000060 236000 29                 LDQ     48
        28 000404   200007 756100                    STQ     I+3,,AUTO
        28 000405   000506 701000 28                 TSX1    ZIG$DDER1
        28 000406   000000 011000                    NOP     0

      224     4946    3               END;

   4946 28 000407   000430 710000 28                 TRA     s:5187

      225     4947        /**********
      226     4948                 We don't even have a dbacs directive to begin parsing
      227     4949            on so we will not try in parse it.
      228     4950        ***********/
      229     4951    3           ELSE DO;

      230     4952    3               LIST_STRING = '  ';CALL LIST(LIST_STRING);

   4952 28 000410   040000 100400                    MLR     fill='040'O
        28 000411   000006 000002 27                 ADSC9   6                        cn=0,n=2
        28 000412   000000 000200 0                  ADSC9   LIST_STRING              cn=0,n=128

   4952 28 000413   000062 630400 29                 EPPR0   50
        28 000414   000061 631400 29                 EPPR1   49
        28 000415   000000 701000 xent               TSX1    LIST
        28 000416   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:42   
      231     4953    3               CALL ZIG$DDER1(1000+PARAN.CODE); /* Put out error */

   4953 28 000417   200003 470500                    LDP0    @PARAN,,AUTO
        28 000420   000000 236100                    LDQ     0,,PR0
        28 000421   777777 376007                    ANQ     -1,DL
        28 000422   001750 036007                    ADLQ    1000,DL
        28 000423   200023 756100                    STQ     I+9,,AUTO
        28 000424   200023 631500                    EPPR1   I+9,,AUTO
        28 000425   200007 451500                    STP1    I+3,,AUTO
        28 000426   000506 701000 28                 TSX1    ZIG$DDER1
        28 000427   000000 011000                    NOP     0

      232     4954        /******
      233     4955                 These are now the error messages!!
      234     4956           []
      235     4957        *******/
      236     4958        /*****   EZI$TRANS = 1001                 ***********/
      237     4959        /*E*     ERROR:    ZIG-EZI$TRANS-C
      238     4960                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      239     4961                           TRANSLATE (SCHEMA | FORTRAN | COBOL | APL | BASIC)
      240     4962        */
      241     4963        /*****   EZI$SCHEMA = 1002                 ***********/
      242     4964        /*E*     ERROR:    ZIG-EZI$SCHEMA-C
      243     4965                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      244     4966                           SCHEMA schema_name (DDL | DMCL)
      245     4967        */
      246     4968        /*E*     ERROR:    ZIG-1020-C
      247     4969        MESSAGE: Syntax error: An error in an option was found or no END
      248     4970                 at the end of the directive.
      249     4971        */
      250     4972        /*****   EZI$LANG = 1100                 ***********/
      251     4973        /*E*     ERROR:    ZIG-EZI$LANG-C
      252     4974                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      253     4975                           (APL | COBOL | FORTRAN | BASIC) SUBSCHEMA schema_name DDL
      254     4976        */
      255     4977        /*****   EZI$SCHEMA_NAME = 1101                 ***********/
      256     4978        /*E*     ERROR:    ZIG-EZI$SCHEMA_NAME-C
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:43   
      257     4979                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      258     4980                           SCHEMA [NAME] [IS] schema_name
      259     4981        */
      260     4982        /*****   EZI$MODE_ALTER = 1401                 ***********/
      261     4983        /*E*     ERROR:    ZIG-EZI$MODE_ALTER-C
      262     4984                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      263     4985                           MODE [IS] ALTER
      264     4986        */
      265     4987        /*****   EZI$REPORT = 1403                 ***********/
      266     4988        /*E*     ERROR:    ZIG-EZI$REPORT-C
      267     4989                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      268     4990                           (NO | SUPPRESS) REPORT [ON] [|| DATA | STORAGE ||] STRUCTURES
      269     4991        */
      270     4992        /*****   EZI$XREF = 1301                 ***********/
      271     4993        /*E*     ERROR:    ZIG-EZI$XREF-C
      272     4994                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      273     4995                           (NO | SUPPRESS) ( XREF | CROSS REFERENCE)
      274     4996        */
      275     4997        /*****    EZI$ALLOCPGS = 1303                 ***********/
      276     4998        /*E*      ERROR:    ZIG-EZI$ALLOCPGS-C
      277     4999                  MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      278     5000                            ALLOCATE num_pages PAGES
      279     5001        */
      280     5002        /*****    EZI$ADDPGS = 1304                 ***********/
      281     5003        /*E*      ERROR:    ZIG-EZI$ADDPGS-C
      282     5004                  MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      283     5005                            ADD num_pages PAGES
      284     5006        */
      285     5007        /*****    EZI$NUMPGS = 1305                 ***********/
      286     5008        /*E*      ERROR:    ZIG-EZI$NUMPGS-C
      287     5009                  MESSAGE:  The number of pages specified must be an integer.
      288     5010        */
      289     5011        /*****   EZI$GENERATE = 1500                 ***********/
      290     5012        /*E*     ERROR:    ZIG-EZI$GENERATE-C
      291     5013                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      292     5014                     GEN/ERATE (APL | COBOL | FORTRAN | BASIC) SUBSCHEMA subscheme_name DDL
      293     5015                           SCHEMA NAME IS schema_name
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:44   
      294     5016        */
      295     5017        /*****   EZI$RENAME = 1503                 ***********/
      296     5018        /*E*     ERROR:    ZIG-EZI$RENAME-C
      297     5019                 MESSAGE:  THE RENAME OPTION MUST BE FOLLOWED BY A KEYWORD
      298     5020                           THEN PAIRS OF DBACS_NAMES.
      299     5021        */
      300     5022        /*****   EZI$LOCKS = 1600                 ***********/
      301     5023        /*E*     ERROR:    ZIG-EZI$LOCKS-C
      302     5024                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      303     5025                           ASSIGN LOCKS [TO] SCHEMA schema_name
      304     5026        */
      305     5027        /*****   EZI$REPORT_LOCKS = 1603                 ***********/
      306     5028        /*E*     ERROR:    ZIG-EZI$REPORT_LOCKS-C
      307     5029                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      308     5030                           (NO | SUPRESS) REPORT [ON] LOCKS
      309     5031        */
      310     5032        /*****   EZI$SET = 1604                 ***********/
      311     5033        /*E*     ERROR:    ZIG-EZI$SET-C
      312     5034                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      313     5035                           SET lock_name [TO] ( NULL | lock_value)
      314     5036        */
      315     5037        /*****   EZI$VALIDATE = 1700                 ***********/
      316     5038        /*E*     ERROR:    ZIG-EZI$VALIDATE-C
      317     5039                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      318     5040                           ( VALID | VALIDATE) SUBSCHEMA subschema_name
      319     5041        */
      320     5042        /*****   EZI$REPORT_P = 1702                 ***********/
      321     5043        /*E*     ERROR:    ZIG-EZI$REPORT_P-C
      322     5044                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      323     5045                           (NO | SUPRESS) REPORT [ON] [||PERMITTED | PROHIBITED |
      324     5046                           AREA | SETS | RECORDS | DBPARAN ||] DML
      325     5047        */
      326     5048        /*****   EZI$MODE_TPR = 1705                 ***********/
      327     5049        /*E*     ERROR:    ZIG-EZI$MODE_TPR-C
      328     5050                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      329     5051                           MODE [IS] TPR
      330     5052        */
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:45   
      331     5053        /*****   EZI$INCLUDE = 1706                 ***********/
      332     5054        /*E*     ERROR:    ZIG-EZI$INCLUDE-C
      333     5055                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      334     5056                           INCLUDE DATA_NAMES [IN] [STRUCTURES]
      335     5057        */
      336     5058        /*****   EZI$DISPLAY = 1003                 ***********/
      337     5059        /*E*     ERROR:    ZIG-EZI$DISPLAY-C
      338     5060                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      339     5061                           DISPLAY SCHEMA schema_name (DICT|DDL|DMCL|ACTIVITIES)
      340     5062                           OR
      341     5063                           DISPLAY SUBSCHEMA subschema_name (DDL|DICT)
      342     5064                           SCHEMA [NAME] [IS] schema_name
      343     5065        */
      344     5066        /*****   EZI$FROM = 1802                 ***********/
      345     5067        /*E*     ERROR:    ZIG-EZI$FROM-C
      346     5068                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      347     5069                           FROM yymmdd [ THRU yymmdd]
      348     5070        */
      349     5071        /*****   EZI$YEAR1 = 1804                 ***********/
      350     5072        /*E*     ERROR:    ZIG-EZI$YEAR1-C
      351     5073        MESSAGE:  The year must be in the format YYMMDD where YY is greater
      352     5074                 than 80, MM is less than 13, and DD is less than 32.
      353     5075        */
      354     5076        /*****   EZI$YEAR2 = 1805                 ***********/
      355     5077        /*E*     ERROR:    ZIG-EZI$YEAR2-C
      356     5078        MESSAGE:  The year must be in the format YYMMDD where YY is greater
      357     5079                 than 80, MM is less than 13, and DD is less than 32.
      358     5080        */
      359     5081        /*****   EZI$PURGE = 1200                 ***********/
      360     5082        /*E*     ERROR:    ZIG-EZI$PURGE-C
      361     5083                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      362     5084                          PURGE SCHEMA schema_name ( DDL | DMCL | ACTIVITIES | DICTIONARY )
      363     5085                           OR
      364     5086                           PURGE SUB/SCHEMA subschema_name ACT/IVITIES
      365     5087                                SCHEMA NAME IS schema_name
      366     5088        */
      367     5089        /*****   EZI$ALL = 1953                 ***********/
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:46   
      368     5090        /*E*     ERROR:    ZIG-EZI$ALL-C
      369     5091                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      370     5092                           ALL (SCHEMA | AREA | SET | KEY | RECORD | FIELD)
      371     5093        */
      372     5094        /*****   EZI$RETENTION = 1203                 ***********/
      373     5095        /*E*     ERROR:    ZIG-EZI$RETENTION-C
      374     5096                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      375     5097                           RETENTION [IS] yymmdd
      376     5098        */
      377     5099        /*****   EZI$SUB_NAME = 1204                 ***********/
      378     5100        /*E*     ERROR:    ZIG-EZI$SUB_NAME-C
      379     5101                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      380     5102                           SUBSCHEMA [NAME] [IS] (ALL | subschema_name ...)
      381     5103        */
      382     5104        /*****   EZI$COPY5 = 1501                 ***********/
      383     5105        /*E*     ERROR:    ZIG-EZI$COPY5-C
      384     5106                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      385     5107                           COPY SOURCE [TO] "file_code"
      386     5108        */
      387     5109        /*****   EZI$COPY8 = 1803                 ***********/
      388     5110        /*E*     ERROR:    ZIG-EZI$COPY8-C
      389     5111                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      390     5112                           COPY SOURCE [TO] "file_code"
      391     5113        */
      392     5114        /*****   EZI$COPY85 = 1852                 ***********/
      393     5115        /*E*     ERROR:    ZIG-EZI$COPY85-C
      394     5116                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      395     5117                           COPY SOURCE [TO] "file_code"
      396     5118        */
      397     5119        /*****   EZI$PRIVACY4 = 1402                 ***********/
      398     5120        /*E*     ERROR:    ZIG-EZI$PRIVACY4-C
      399     5121                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      400     5122                           [PRIVACY] KEY [FOR] ALTER [IS] "privacy_key"
      401     5123        */
      402     5124        /*****   EZI$PRIVACY5 = 1504                 ***********/
      403     5125        /*E*     ERROR:    ZIG-EZI$PRIVACY5-C
      404     5126                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:47   
      405     5127                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      406     5128        */
      407     5129        /*****   EZI$PRIVACY6 = 1602                 ***********/
      408     5130        /*E*     ERROR:    ZIG-EZI$PRIVACY6-C
      409     5131                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      410     5132                           [PRIVACY] KEY [FOR] LOCKS [IS] "privacy_key"
      411     5133        */
      412     5134        /*****   EZI$PRIVACY7 = 1707                 ***********/
      413     5135        /*E*     ERROR:    ZIG-EZI$PRIVACY7-C
      414     5136                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      415     5137                           [PRIVACY] KEY [FOR] (COPY|DIAGNOSTICS) [IS] "privacy_key"
      416     5138        */
      417     5139        /*****   EZI$PRIVACY8 = 1801                 ***********/
      418     5140        /*E*     ERROR:    ZIG-EZI$PRIVACY8-C
      419     5141                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      420     5142                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      421     5143        */
      422     5144        /*****   EZI$PRIVACY85 = 1851                 ***********/
      423     5145        /*E*     ERROR:    ZIG-EZI$PRIVACY85-C
      424     5146                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      425     5147                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      426     5148        */
      427     5149        /*****   EZI$PRIVACY9 = 1901                 ***********/
      428     5150        /*E*     ERROR:    ZIG-EZI$PRIVACY9-C
      429     5151                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      430     5152                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      431     5153        */
      432     5154        /*****   EZI$PRIVACY95 = 1951                 ***********/
      433     5155        /*E*     ERROR:    ZIG-EZI$PRIVACY95-C
      434     5156                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      435     5157                           [PRIVACY] KEY [FOR] DISPLAY [IS] "privacy_key"
      436     5158        */
      437     5159        /*****   EZI$END = 1099                 ***********/
      438     5160        /*E*     ERROR:    ZIG-EZI$END-C
      439     5161                 MESSAGE:  It was looking for an END and did not find one
      440     5162                           so either you need an END or an option is wrong.
      441     5163        */
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:48   
      442     5164        /*****   EZI$ALIAS = 1505                 ***********/
      443     5165        /*E*     ERROR:    ZIG-EZI$ALIAS-C
      444     5166                 MESSAGE:  SYNTAX ERROR THE FORMAT IS:
      445     5167                           dbacs_name [TO] alias_name
      446     5168        */
      447     5169        /*E*     ERROR: ZIG-1850-C
      448     5170        MESSAGE: SYNTAX ERROR THE FORMAT IS:
      449     5171                 [DBACS] DISPLAY SUBSCHEMA subschema-name DDL
      450     5172                 SCHEMA [NAME] [IS] schema-name
      451     5173        */
      452     5174        /*E*     ERROR: ZIG-1900-C
      453     5175        MESSAGE: SYNTAX ERROR THE FORMAT IS:
      454     5176                 [DBACS] DISPLAY SUBSCHEMA subschema-name DICT
      455     5177                 SCHEMA [NAME] [IS] schema-name
      456     5178        */
      457     5179    3               END;

      458     5180        /************
      459     5181        	return to ZIG$DDS1 but don't let X$PARSE
      460     5182        	GET control again because we have a fatal error
      461     5183        	and we don't want X$PARSE to try and find a good
      462     5184        	dbacs directive when there isn't one there.
      463     5185        	(to save time bye stopping X$PARSE when we find a error).
      464     5186        ************/
      465     5187    2           UNWIND TO UNWIND_VAL;

   5187 28 000430   000100 100600                    MLR   ! fill='000'O
        28 000431   000000 000010 xsym               ADSC9   UNWIND_VAL               cn=0,n=8
        28 000432   200014 000010                    ADSC9   I+2,,AUTO                cn=0,n=8
        28 000433   200014 237300                    LDAQ  ! I+2,,AUTO
        28 000434   000000 700200 xent               TSX0  ! X66_AUNWIND
        28 000435   000000 000200                    ZERO    0,128

      466     5188    2       CASE (%PRE#);

      467     5189    2           END;

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:49   
   5189 28 000436   000527 710000 28                 TRA     s:5232

      468     5190         %EJECT;
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:50   
      469     5191        /***
      470     5192                 Subroutine to search the res. Word table.
      471     5193                   The user can't use res word as a dbacs name.
      472     5194        ********/
      473     5195    1   SEARCH_RES_WORD:

   5195 28 000437   200006 741300       SEARCH_RES_* STX1  ! I+2,,AUTO

      474     5196    1       PROC (WORD1,CHAR_SIZE,ARRAY_SIZE);
      475     5197    2   DCL WORD1 (0:20) CHAR (11);
      476     5198    2   DCL CHAR_SIZE UBIN (36);
      477     5199    2   DCL ARRAY_SIZE UBIN (36);
      478     5200    2   DCL I UBIN (36);
      479     5201    2   DCL TEST_STRING CHAR (11) STATIC;
      480     5202    2       TEST_STRING = PARAN.OUT$ -> OUT.SUBLK$(0) -> SYM.TEXT;

   5202 28 000440   200003 470500                    LDP0    @PARAN,,AUTO
        28 000441   000002 471500                    LDP1    2,,PR0
        28 000442   100003 473500                    LDP3    3,,PR1
        28 000443   300004 236100                    LDQ     4,,PR3
        28 000444   000033 772000                    QRL     27
        28 000445   000000 620006                    EAX0    0,QL
        28 000446   040000 100540                    MLR     fill='040'O
        28 000447   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
        28 000450   000441 000013 2                  ADSC9   TEST_STRING              cn=0,n=11

      481     5203    3       DO I = 0 TO ARRAY_SIZE-1;

   5203 28 000451   200012 450100                    STZ     I,,AUTO
        28 000452   000475 710000 28                 TRA     s:5209+3

      482     5204    3           IF (SUBSTR(WORD1(I),0,CHAR_SIZE) = SUBSTR(TEST_STRING,0,CHAR_SIZE))

   5204 28 000453   200010 470500                    LDP0    @CHAR_SIZE,,AUTO
        28 000454   000000 720100                    LXL0    0,,PR0
        28 000455   000000 721100                    LXL1    0,,PR0
        28 000456   200012 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:51   
        28 000457   000013 402007                    MPY     11,DL
        28 000460   200007 471500                    LDP1    @WORD1,,AUTO
        28 000461   040040 106546                    CMPC    fill='040'O
        28 000462   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
        28 000463   000441 000011 2                  ADSC9   TEST_STRING              cn=0,n=*X1
        28 000464   000472 601000 28                 TNZ     s:5209

      483     5205    4           THEN DO;

      484     5206    4               PARAN.REJECT = '1'B;

   5206 28 000465   200003 473500                    LDP3    @PARAN,,AUTO
        28 000466   000200 236003                    LDQ     128,DU
        28 000467   300000 256100                    ORSQ    0,,PR3

      485     5207    4               RETURN;

   5207 28 000470   200006 221300                    LDX1  ! I+2,,AUTO
        28 000471   000001 702211                    TSX2  ! 1,X1

      486     5208    4               END;
      487     5209    3           END;

   5209 28 000472   200012 235100                    LDA     I,,AUTO
        28 000473   000001 035007                    ADLA    1,DL
        28 000474   200012 755100                    STA     I,,AUTO
        28 000475   200011 470500                    LDP0    @ARRAY_SIZE,,AUTO
        28 000476   200012 236100                    LDQ     I,,AUTO
        28 000477   000000 116100                    CMPQ    0,,PR0
        28 000500   000453 602000 28                 TNC     s:5204

      488     5210    2       PARAN.ACCEPT = '1'B;

   5210 28 000501   200003 471500                    LDP1    @PARAN,,AUTO
        28 000502   000400 236003                    LDQ     256,DU
        28 000503   100000 256100                    ORSQ    0,,PR1

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:52   
      489     5211    2       RETURN;

   5211 28 000504   200006 221300                    LDX1  ! I+2,,AUTO
        28 000505   000001 702211                    TSX2  ! 1,X1

      490     5212    2   END SEARCH_RES_WORD;
      491     5213    1   ZIG$DDER1:

   5213 28 000506   200006 741300       ZIG$DDER1    STX1  ! I+2,,AUTO

      492     5214    1       PROC (PAR1);
      493     5215        /************
      494     5216                  Put out the error that X$PARSE found only
      495     5217                  after printing out the last line input so the
      496     5218                  so the message corresponse to the line printed.
      497     5219                  Set savesw show that there is no line to print out
      498     5220                  before the next read.
      499     5221        ************/
      500     5222    2   DCL PAR1 UBIN (36);
      501     5223    2       IF SAVESW

   5223 28 000507   000000 234000 7                  SZN     SAVESW
        28 000510   000521 605000 28                 TPL     s:5229

      502     5224    3       THEN DO;

      503     5225    3           CALL PUT_OUT_LINE(LINE_COUNT,REC);

   5225 28 000511   000064 630400 29                 EPPR0   52
        28 000512   000063 631400 29                 EPPR1   51
        28 000513   000000 701000 xent               TSX1    PUT_OUT_LINE
        28 000514   000000 011000                    NOP     0

      504     5226    3           LINE_COUNT=LINE_COUNT+1;

   5226 28 000515   000000 235000 3                  LDA     LINE_COUNT
        28 000516   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:53   
        28 000517   000000 755000 3                  STA     LINE_COUNT

      505     5227    3           SAVESW = '0'B;

   5227 28 000520   000000 450000 7                  STZ     SAVESW

      506     5228    3           END;

      507     5229    2       CALL ERROR(PAR1);

   5229 28 000521   200007 630500                    EPPR0   @PAR1,,AUTO
        28 000522   000061 631400 29                 EPPR1   49
        28 000523   000000 701000 xent               TSX1    ERROR
        28 000524   000000 011000                    NOP     0

      508     5230    2       RETURN;

   5230 28 000525   200006 221300                    LDX1  ! I+2,,AUTO
        28 000526   000001 702211                    TSX2  ! 1,X1

      509     5231    2   END ZIG$DDER1;
      510     5232    1   END ZIG$DDS3;

   5232 28 000527   000000 702200 xent               TSX2  ! X66_ARET

LIST_STRING
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

RES_WORD
 Sect OctLoc
   2     002   111116 040040   040040 040040   040040 040111   123040 040040    IN         IS
   2     006   040040 040040   040040 116117   040040 040040   040040 040040          NO
   2     012   040117 106040   040040 040040   040040 040040   117116 040040     OF         ON
   2     016   040040 040040   040040 040124   117040 040040   040040 040040           TO
   2     022   040040 ******   ****** ******   ****** ******   ****** ******      ..............
   2     026   000000 000006   101103 124040   040040 040040   040040 040101    ....ACT        A
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:54   
   2     032   114114 040040   040040 040040   040040 104104   114040 040040    LL        DDL
   2     036   040040 040040   040104 115114   040040 040040   040040 040040         DML
   2     042   105116 104040   040040 040040   040040 040106   117122 040040    END        FOR
   2     046   040040 040040   040040 107105   116040 040040   040040 040040          GEN
   2     052   040113 105131   040040 040040   040040 040040   122105 106040     KEY        REF
   2     056   040040 040040   040040 040123   105124 040040   040040 040040           SET
   2     062   040040 124120   122040 040040   040040 040040   040*** ******      TPR        ...
   2     066   ****** ******   ****** ******   000000 000013   101103 124123    ............ACTS
   2     072   040040 040040   040040 040101   122105 101040   040040 040040           AREA
   2     076   040040 103117   120131 040040   040040 040040   040104 101124      COPY       DAT
   2     102   101040 040040   040040 040040   104111 101107   040040 040040    A       DIAG
   2     106   040040 040104   111103 124040   040040 040040   040040 104111       DICT       DI
   2     112   123120 040040   040040 040040   040104 115103   114040 040040    SP       DMCL
   2     116   040040 040040   106122 117115   040040 040040   040040 040113        FROM       K
   2     122   105131 123040   040040 040040   040040 114117   103113 040040    EYS       LOCK
   2     126   040040 040040   040115 117104   105040 040040   040040 040040         MODE
   2     132   116101 115105   040040 040040   040040 040116   125114 114040    NAME       NULL
   2     136   040040 040040   040040 120105   122115 040040   040040 040040          PERM
   2     142   040123 105124   123040 040040   040040 040040   124110 122125     SETS       THRU
   2     146   040040 040040   040040 040130   122105 106040   040040 040040           XREF
   2     152   040040 ******   ****** ******   ****** ******   ****** ******      ..............
   2     156   000000 000022   101114 124105   122040 040040   040040 040101    ....ALTER      A
   2     162   122105 101123   040040 040040   040040 103117   102117 114040    REAS      COBOL
   2     166   040040 040040   040103 122117   123123 040040   040040 040040         CROSS
   2     172   104111 101107   123040 040040   040040 040106   111105 114104    DIAGS      FIELD
   2     176   040040 040040   040040 114117   103113 123040   040040 040040          LOCKS
   2     202   040120 125122   107105 040040   040040 040040   124111 124114     PURGE      TITL
   2     206   105040 040040   040040 040124   122101 116123   040040 040040    E      TRANS
   2     212   040040 126101   114111 104040   040040 040040   040*** ******      VALID      ...
   2     216   ****** ******   ****** ******   000000 000013   101123 123111    ............ASSI
   2     222   107116 040040   040040 040106   111105 114104   123040 040040    GN     FIELDS
   2     226   040040 120105   122115 111124   040040 040040   040120 122117      PERMIT     PRO
   2     232   110111 102040   040040 040040   122105 103117   122104 040040    HIB     RECORD
   2     236   040040 040122   105116 101115   105040 040040   040040 122105       RENAME     RE
   2     242   120117 122124   040040 040040   040123 103110   105115 101040    PORT     SCHEMA
   2     246   040040 040040   123117 125122   103105 040040   040040 040123        SOURCE     S
   2     252   131123 117125   124040 040040   040040 ******   ****** ******    YSOUT     ......
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:55   
   2     256   ****** ******   ****** ******   000000 000012   101116 101114    ............ANAL
   2     262   131123 105040   040040 040101   116101 114131   132105 040040    YSE    ANALYZE
   2     266   040040 104111   123120 114101   131040 040040   040106 117122      DISPLAY    FOR
   2     272   124122 101116   040040 040040   111116 103114   125104 105040    TRAN    INCLUDE
   2     276   040040 040120   122111 126101   103131 040040   040040 122105       PRIVACY    RE
   2     302   103117 122104   123040 040040   040122 105120   114101 103105    CORDS    REPLACE
   2     306   040040 040040   122105 120117   122124 123040   040040 040123        REPORTS    S
   2     312   124117 122101   107105 040040   040040 124110   122117 125107    TORAGE    THROUG
   2     316   110040 040040   040*** ******   ****** ******   ****** ******    H    ...........
   2     322   000000 000013   101103 124111   126111 124131   040040 040107    ....ACTIVITY   G
   2     326   105116 105122   101124 105040   040040 113105   131137 116101    ENERATE   KEY_NA
   2     332   115105 040040   040123 105124   137116 101115   105040 040040    ME   SET_NAME
   2     336   126101 114111   104101 124105   040040 040123   125120 120122    VALIDATE   SUPPR
   2     342   105123 123040   040040 ******   ****** ******   ****** ******    ESS   ..........
   2     346   ****** ******   000000 000006   101122 105101   137116 101115    ........AREA_NAM
   2     352   105040 040104   101124 101137   116101 115105   040040 105116    E  DATA_NAME  EN
   2     356   104137 104102   101103 123040   040120 105122   115111 124124    D_DBACS  PERMITT
   2     362   105104 040040   122105 106105   122105 116103   105040 040122    ED  REFERENCE  R
   2     366   105124 105116   124111 117116   040040 123124   122125 103124    ETENTION  STRUCT
   2     372   125122 105040   040123 125102   123103 110105   115101 040040    URE  SUBSCHEMA
   2     376   124122 101116   123114 101124   105040 040***   ****** ******    TRANSLATE  .....
   2     402   ****** ******   ****** ******   000000 000011   101103 124111    ............ACTI
   2     406   126111 124111   105123 040104   111101 107116   117123 124111    VITIES DIAGNOSTI
   2     412   103040 104111   103124 111117   116101 122131   040120 122117    C DICTIONARY PRO
   2     416   110111 102111   124105 104040   123124 122125   103124 125122    HIBITED STRUCTUR
   2     422   105123 040***   ****** ******   ****** ******   ****** ******    ES .............
   2     426   000000 000005   104111 101107   116117 123124   111103 123122    ....DIAGNOSTICSR
   2     432   105103 117122   104137 116101   115105 ******   ****** ******    ECORD_NAME......
   2     436   ****** ******   ****** ******   000000 000002                    ............

LINE
 Sect OctLoc
   4     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

REC1
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:56   

REC
 Sect OctLoc
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  17     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  19     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  20     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  22     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  22     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  22     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  22     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  23     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  23     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  23     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  23     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  23     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  23     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  23     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  23     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:57   
  24     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  24     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  24     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  24     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  24     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  24     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  24     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  24     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  25     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  25     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  25     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  25     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  25     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  25     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  25     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  25     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

ONLINE
 Sect OctLoc
  26     000   0***** ******                                                    ....

(unnamed)
 Sect OctLoc
  27     000   061063 040040   060060 040040   063062 040040   067070 040040    13  00  32  78
  27     004   062061 040040   077040 040040   040040 040040                    21  ?

(unnamed)
 Sect OctLoc
  29     000   000000 000000   000000 000002   000001 006000   000026 006000    ................
  29     004   000002 006000   000000 000003   000005 006000   000070 006000    .............8..
  29     010   000027 006000   000000 000004   000011 006000   000156 006000    .............n..
  29     014   000071 006000   000000 000005   000015 006000   000220 006000    .9..............
  29     020   000157 006000   000000 000006   000021 006000   000260 006000    .o..............
  29     024   000221 006000   000000 000007   000025 006000   000322 006000    ................
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:58   
  29     030   000261 006000   000000 000010   000031 006000   000347 006000    ................
  29     034   000323 006000   000000 000011   000035 006000   000404 006000    ................
  29     040   000350 006000   000000 000012   000041 006000   000426 006000    .........!......
  29     044   000405 006000   000000 000013   000045 006000   000440 006000    .........%......
  29     050   000427 006000   000000 003707   000051 006000   000000 003414    .........)......
  29     054   000053 006000   000000 023412   000055 006000   000000 023417    .+.......-......
  29     060   000057 006000   000001 000000   000000 006000   000002 000000    ./..............
  29     064   000000 006000   000000 006000                                    ........

PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:59   
--  Include file information  --

   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$DDS3.

   Procedure ZIG$DDS3 requires 344 words for executable code.
   Procedure ZIG$DDS3 requires 20 words of local(AUTO) storage.

    No errors detected in file ZIG$DDS3.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:60   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:61   
          MINI XREF LISTING

ARRAY_SIZE IN PROCEDURE SEARCH_RES_WORD
      5199**DCL      5196--PROC     5203>>DOINDEX
CHAR_SIZE IN PROCEDURE SEARCH_RES_WORD
      5198**DCL      5196--PROC     5204>>IF       5204>>IF
EOFFLG
        37**DCL      4844>>IF
ERROR
        55**DCL-ENT  5229--CALL
I
        24**DCL      4916<<ASSIGN   4917>>IF       4926>>CALLBLT  4926>>CALLBLT
I IN PROCEDURE SEARCH_RES_WORD
      5200**DCL      5203<<DOINDEX  5204>>IF
LAST_COUNT
        36**DCL      4926>>CALLBLT
LINE_COUNT
        34**DCL      5225<>CALL     5226<<ASSIGN   5226>>ASSIGN
LIST
        70**DCL-ENT  4952--CALL
LIST_STRING
        21**DCL      4952<<ASSIGN   4952<>CALL
OUT.SUBLK$
      4790**DCL      4855>>DOCASE   4887>>IF       4900>>ASSIGN   4900>>ASSIGN   4916>>ASSIGN   5202>>ASSIGN
      5202>>ASSIGN
PAR1 IN PROCEDURE ZIG$DDER1
      5222**DCL      5214--PROC     5229<>CALL
PARAN
      4689**DCL        18--PROC
PARAN.ACCEPT
      4696**DCL      4905<<ASSIGN   5210<<ASSIGN
PARAN.CHARPOS
      4727**DCL      4926>>CALLBLT
PARAN.CODE
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:62   
      4710**DCL      4853>>IF       4898>>IF       4898>>IF       4898>>IF       4913>>IF       4913>>IF
      4943>>IF       4953>>CALL
PARAN.OUT$
      4719**DCL      4855>>DOCASE   4887>>IF       4900>>ASSIGN   4900>>ASSIGN   4916>>ASSIGN   5202>>ASSIGN
      5202>>ASSIGN
PARAN.REJECT
      4701**DCL      5206<<ASSIGN
PARAN.TYPE
      4690**DCL      4841>>DOCASE
PUT_OUT_LINE
        20**DCL-ENT  5225--CALL
REC
        41**DCL      4926<<CALLBLT  5225<>CALL
RES_WORD.LENGTH_10.ARRAY_SIZE
       201**DCL      4881<>CALL
RES_WORD.LENGTH_10.WORD1
       198**DCL      4881<>CALL
RES_WORD.LENGTH_11.ARRAY_SIZE
       205**DCL      4884<>CALL
RES_WORD.LENGTH_11.WORD1
       203**DCL      4884<>CALL
RES_WORD.LENGTH_2.ARRAY_SIZE
       158**DCL      4857<>CALL
RES_WORD.LENGTH_2.WORD1
       156**DCL      4857<>CALL
RES_WORD.LENGTH_3.ARRAY_SIZE
       163**DCL      4860<>CALL
RES_WORD.LENGTH_3.WORD1
       160**DCL      4860<>CALL
RES_WORD.LENGTH_4.ARRAY_SIZE
       169**DCL      4863<>CALL
RES_WORD.LENGTH_4.WORD1
       165**DCL      4863<>CALL
RES_WORD.LENGTH_5.ARRAY_SIZE
       174**DCL      4866<>CALL
RES_WORD.LENGTH_5.WORD1
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:63   
       171**DCL      4866<>CALL
RES_WORD.LENGTH_6.ARRAY_SIZE
       179**DCL      4869<>CALL
RES_WORD.LENGTH_6.WORD1
       176**DCL      4869<>CALL
RES_WORD.LENGTH_7.ARRAY_SIZE
       185**DCL      4872<>CALL
RES_WORD.LENGTH_7.WORD1
       181**DCL      4872<>CALL
RES_WORD.LENGTH_8.ARRAY_SIZE
       190**DCL      4875<>CALL
RES_WORD.LENGTH_8.WORD1
       187**DCL      4875<>CALL
RES_WORD.LENGTH_9.ARRAY_SIZE
       196**DCL      4878<>CALL
RES_WORD.LENGTH_9.WORD1
       192**DCL      4878<>CALL
SAVESW
        39**DCL      5223>>IF       5227<<ASSIGN
SEARCH_RES_WORD
      5196**PROC     4857--CALL     4860--CALL     4863--CALL     4866--CALL     4869--CALL     4872--CALL
      4875--CALL     4878--CALL     4881--CALL     4884--CALL
SUBSCHEMA_KEY
        90**DCL        91--REDEF
SYM.COUNT
      4827**DCL      4830--IMP-SIZ  4855>>DOCASE   4887>>IF       4900>>ASSIGN   4916>>ASSIGN   5202>>ASSIGN
SYM.TEXT
      4830**DCL      4900>>ASSIGN   5202>>ASSIGN
TEST_STRING IN PROCEDURE SEARCH_RES_WORD
      5201**DCL      5202<<ASSIGN   5204>>IF
TEST_YEAR.DD
        33**DCL      4901>>IF       4901>>IF
TEST_YEAR.MM
        32**DCL      4901>>IF       4901>>IF
TEST_YEAR.YY
        31**DCL      4901>>IF       4901>>IF
PL6.E3A0      #001=ZIG$DDS3 File=ZIG$DDS3.:ZIC0TSI                               FRI 09/05/97 11:48 Page:64   
TEST_YEAR1
        29**DCL        30--REDEF    4900<<ASSIGN
UNWIND_VAL
        23**DCL      4844>>UNWIND   4890>>UNWIND   4910>>UNWIND   5187>>UNWIND
WORD1 IN PROCEDURE SEARCH_RES_WORD
      5197**DCL      5196--PROC     5204>>IF
ZIG$DDER1
      5214**PROC     4889--CALL     4909--CALL     4919--CALL     4945--CALL     4953--CALL
ZIG$DDS2
        25**DCL-ENT  4845--CALL
