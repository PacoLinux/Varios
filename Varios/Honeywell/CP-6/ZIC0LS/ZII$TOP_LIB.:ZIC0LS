
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:1    
        1        1        /*M* ZII$TOPOLOGY Analyzes subschema for best path for retrieval.          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P* NAME:       ZII$TOPOLOGY
        8        8
        9        9             PURPOSE:     This routine is the module called by IDP to define
       10       10                          a valid path to navigate through a database using
       11       11                          information contained in the path, which is used to perform
       12       12                          legal DBCS calls to retrieve information requested in the
       13       13                          IDP DISPLAY command.
       14       14
       15       15             DESCRIPTION: IDP passes command information
       16       16                          to the Topology module describing the Display,
       17       17                          Constraint, Via, and Port items (which are in the
       18       18                          form of indices into the Subschema Tables, built
       19       19                          by the ZII$BUILD_TABLES module). If the Port was
       20       20                          zero, then Topology proceeds to make its own port
       21       21                          selection based on Display and Constraint info, else
       22       22                          Topology uses the User-supplied values for Port
       23       23                          record and selection type (Direct, Calc, Serial,
       24       24                          etc.). Topology then proceeds to use Via list info
       25       25                          to decide on a direction to take from the Port.
       26       26                          If no Via information was given, Topology takes
       27       27                          what it believes is the shortest path to records
       28       28                          containing required data items which are farthest
       29       29                          away from the port and following sets back to the
       30       30                          Port record, taking into account all data items
       31       31                          satisfied on the trip back. If there are still data
       32       32                          items left unsatisfied, then a lambda condition
       33       33                          exists and another branch from the Port is followed
       34       34                          from farthest data item to the Port as before.
       35       35                          Branches are built as required until all data items
       36       36                          are found to be in the Path.                        */
       37       37        /*D* NAME:       ZII$TOPOLOGY
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:2    
       38       38
       39       39             CALL:        Called by IDP.
       40       40
       41       41             INPUT:       DISPLAY_LIST,CONSTRAINT_LIST,ACCESS_LIST,VIA_LIST,TOPOLOGY_OPTIONS
       42       42
       43       43             OUTPUT:      PATH$_P,STATUS_CODE
       44       44
       45       45             DESCRIPTION: ZII$TOPOLOGY should be invoked by a driver routine
       46       46                          (such as IDP) which has previously called the
       47       47                          ZII$BUILD_TABLES routine in :LIB_IDSINT. Calling
       48       48                          these modules in this order is essential to correct
       49       49                          operation of ZII$TOPOLOGY since ZII$TOPOLOGY needs
       50       50                          tables built by ZII$BUILD_TABLES. Also, take care
       51       51                          NOT TO USE THE COMMON SEGMENT with the driver routine
       52       52                          since doing so will wipe out these tables.
       53       53
       54       54                              ZII$TOPOLOGY starts processing by allocating
       55       55                          space (also in the Common segment) for ten (10)
       56       56                          occurrences of the PATH_LIST. Then, if a Port
       57       57                          record has not been supplied by the driver routine,
       58       58                          SELECT_PORT is called to choose one. All
       59       59                          information about the new Port record needed
       60       60                          by ZII$TOPOLOGY and ZII$RETRIEVE is placed into
       61       61                          ACCESS_LIST.
       62       62
       63       63                              Next, COMP_DIST is called. This routine is used
       64       64                          to compute the distances of each record in the
       65       65                          subschema from the port record. These distances are
       66       66                          placed into the global structure D_TABLE.
       67       67
       68       68                              The next section takes the DISPLAY_ and
       69       69                          CONSTRAINT_ lists, which are lists of indices
       70       70                          to items in records, and builds a temporary
       71       71                          TDISPLAY_LIST, which is actually a list of the
       72       72                          associated records that own each of the items
       73       73                          listed in the DISPLAY_ and CONSTRAINT_ lists
       74       74                          (TDISPLAY_LIST contains the list of all records
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:3    
       75       75                          actually involved in the search for a path).
       76       76
       77       77                              Now the path search begins. If a VIA_LIST
       78       78                          was not null (i.e. VIA_LIST(0)~=0)) then the
       79       79                          Topology module must direct the search in the
       80       80                          direction of the first VIA_LIST entry. In order
       81       81                          to build an initial partial path towards the first
       82       82                          VIA_LIST entry, calls to OWNER_SET and MEMBER_SET
       83       83                          are made. As their names imply(?) these two internal
       84       84                          procs find a record who is owner and a record who is
       85       85                          a member of the VIA_LIST entry. Then a choice is
       86       86                          made on which record, either the owner record or
       87       87                          the member record of the set, is to be used as the
       88       88                          target of the first partial path with the criterion
       89       89                          being the closest record to the Port record is to
       90       90                          be used. Then this procedure is used until all
       91       91                          record indices in the TDISPLAY_LIST are involved in
       92       92                          the Path. If, when all records involved in the
       93       93                          search are involved in the Path, some VIA_LIST
       94       94                          entries are NOT involved in the Path, then an
       95       95                          error code is returned.
       96       96
       97       97                              If the VIA_LIST is null, then the following
       98       98                          strategy is taken:
       99       99                              Since no "direction" was given by way of
      100      100                          VIA_LIST information, the Topology module
      101      101                          finds the record (or one of the records) whose
      102      102                          distance from the Port record is the farthest
      103      103                          (if there is more than one record involved in
      104      104                          the search with the same current maximum
      105      105                          distance from the port, then logically those
      106      106                          records do not lie on the same path branch
      107      107                          and will be included in the next path iteration
      108      108                          since they are maximum distances. One special
      109      109                          case arises: when more than one record which
      110      110                          are members of the same set and are specified
      111      111                          in the TDISPLAY_LIST. A special test for this
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:4    
      112      112                          case is used to resolve the problem and both
      113      113                          (or all) members specified in the TDISPLAY_LIST
      114      114                          are included in the Path.). Once a record is
      115      115                          deemed as being "farthest" from the Port record,
      116      116                          a partial path is computed (as in the case of
      117      117                          appearing VIA_LIST entries) with a call to
      118      118                          BACK_TRACK, which starts at the record cited
      119      119                          as the farthest from the Port and includes
      120      120                          sets and records to reach the Port record.
      121      121                          Any other records cited in the TDISPLAY_LIST
      122      122                          that are now involved in the partial path
      123      123                          are extracted from the TDISPLAY_LIST. This
      124      124                          iteration is followed until the TDISPLAY_LIST
      125      125                          is exhausted.
      126      126                              Then, when the last partial path is added to
      127      127                          the total computed path, the path is compressed
      128      128                          to eliminate all non-essential redundant
      129      129                          occurrences of record indices (e.g. an
      130      130                          essential redundant occurrence is one whose
      131      131                          record happens to be an owner of a lambda
      132      132                          structure, in which case it is redundant
      133      133                          because: (1) it tells ZII$RETRIEVE that this
      134      134                          is the beginning of a new branch of a lambda
      135      135                          structure, and (2) it contains the index of
      136      136                          the new set index to follow for this branch
      137      137                          of this lambda structure.)
      138      138                              As the total Path, or PATH_LIST, expands,
      139      139                          calls to ZII$PATH_MEMORY are made as needed
      140      140                          which enlarge the Common segment by ten (10)
      141      141                          Path occurrences (30 words).
      142      142                         Once the PATH_LIST has been compressed, the
      143      143                          Topology Analysis for this query is complete and
      144      144                          control is passed to the calling routine.           */
      145      145        ZII$TOPOLOGY: PROC (DISPLAY_LIST,CANDIDATE_LIST,ACCESS_LIST,
      146      146               VIA_LIST,PATH$_P,TOPOLOGY_OPTIONS,STATUS_CODE) ALTRET;
      147      147    1   DCL ZII$COMMON$ PTR EXT;
      148      148    1   DCL 1 COMMON_REDEF REDEF ZII$COMMON$,
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:5    
      149      149    1         2 WORD_OFFSET UBIN HALF HALIGNED,
      150      150    1         2 * UBIN HALF HALIGNED;
      151      151    1   DCL TDISPLAY_LIST (0:0) UBIN BASED(ZII$COMMON$) ALIGNED;
      152      152    1   DCL DISPLAY_LIST# UBIN;
      153      153    1   DCL TDISPLAY_LIST# UBIN;
      154      154    1   DCL PATH$_P PTR;
      155      155    1   DCL PATH$ PTR;
      156      156    1   DCL REC_NO UBIN;
      157      157    1   DCL MEMORY_NEEDED UBIN AUTO;
      158      158    1   DCL ELE_FLG UBIN AUTO;
      159      159    1   DCL ILLEGAL_SETS_INCLUDED UBIN AUTO;
      160      160    1   DCL STATUS_CODE UBIN(36);
      161      161    1   DCL OWNER_REC UBIN AUTO;
      162      162    1   DCL MEMBER_REC UBIN AUTO;
      163      163    1   DCL T_DIST UBIN AUTO;
      164      164    1   DCL MEMBER_OF_LIST UBIN AUTO;
      165      165    1   DCL MEM_FLG UBIN AUTO;
      166      166    1   DCL ZER_FLG UBIN AUTO;
      167      167    1   DCL 1 VIA_ERROR CONSTANT,
      168      168    1         2 * CHAR(0) INIT(
               168                  ' Warning: Disconnected VIA list. The following sets might not be used:');
      169      169    1   DCL 1 ERR_LINE STATIC,
      170      170    1         2 * CHAR(4) INIT('    '),
      171      171    1         2 SET_FD CHAR(32);
      172      172    1   DCL LAMBDA_REC# UBIN AUTO;
      173      173    1   DCL 1 LAMBDA_RECS(0:20) ALIGNED,
      174      174    1         2 REC_NO UBIN HALF HALIGNED,
      175      175    1         2 PATH_LIST_IDX UBIN HALF HALIGNED;
      176      176    1   DCL TEMP_PORT_PATH_IDX UBIN AUTO;
      177      177    1   DCL IDX UBIN AUTO;
      178      178    1   DCL BLNK_LINE CHAR(4) INIT('    ') STATIC;
      179      179    1   DCL N UBIN AUTO;
      180      180    1   DCL I UBIN;
      181      181    1   DCL J UBIN AUTO;
      182      182    1   DCL K UBIN AUTO;
      183      183    1   DCL START_NODE UBIN AUTO;
      184      184    1   DCL CURRENT_NODE UBIN AUTO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:6    
      185      185    1   DCL TEMP_PORT UBIN AUTO;
      186      186    1   DCL TEMP_ARG UBIN AUTO;
      187      187    1   DCL MEMORY_FRAME UBIN(36) EXT;
      188      188    1   DCL M$LO DCB;
      189      189    1   DCL M$DO DCB;
      190      190        %EQU GET = 1;
      191      191        %EQU RLSE = 0;
      192      192    1   DCL DID_I BIT(1) ALIGNED;
      193      193        /**/
      194      194    1   DCL ZII$FIND_IDX ENTRY(2);
      195      195    1   DCL ZII$PATH_MEMORY ENTRY(2) ALTRET;
      196      196    1   DCL ZII$COMMON_MEMORY ENTRY(2) ALTRET;
      197      197    1   DCL ZII$PRINT_PATH ENTRY(3) ALTRET;
      198      198        /**/
      199      199        %INCLUDE CP_6;
      200      280        %INCLUDE ZI$TOP_STRUCTS;
      201      341        %D_DESC (STCLASS="EXTROOT");
      202      350        %D2_DESC (STCLASS="EXTROOT");
      203      357        %TBL_DIM_DESC (STCLASS="EXTROOT");
      204      362        %MEMBER_LIST_DESC(
      205      363         NAME=MEMBER_LIST,
      206      364         STCLASS=AUTO);
      207      372        %INCLUDE ZI$STRUCTS;
      208      444        %NAM1;
      209      473        %NAM2;
      210      487        %INCLUDE ZI$DESC;
      211     1337        %DSC_AREA;
      212     1359        %DSC_REC;
      213     1393        %DSC_SET;
      214     1435        %DSC_RFS;
      215     1480        %DSC_DESC;
      216     1488        %DSC_FLD;
      217     1603        %INCLUDE ZI$PATH_STRUCTS;
      218     1741        %DISPLAY_DESC (STCLASS=" ");
      219     1752        %CANDIDATE_DESC (STCLASS=" ");
      220     1764        %VIA_DESC (STCLASS=" ");
      221     1769        %PATH_DESC (STCLASS="BASED(PATH$)");
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:7    
      222     1809        %ACCESS_DESC (STCLASS=" ");
      223     1848        %TOPOLOGY_OPTIONS_DESC (STCLASS=" ");
      224     1854        %INCLUDE ZI_IDPERR_SUBS;
      225     1888        %VLP_VECTOR (FPTN=DUMMY_VECTOR);
      226     1903        /**/
      227     1904        %FPT_WRITE(FPTN=ERR_OUT,BUF=VIA_ERROR,DCB=M$LO);
      228     1935        %FPT_CORRES(FPTN=LO_DO,DCB1=M$LO,DCB2=M$DO);
      229     1949        /**/
      230     1950
      231     1951        /*
      232     1952          To ensure that the memory used to build tables is zeroed first,
      233     1953          scoot ZII$COMMON$ past the last group of topology tables built.
      234     1954          (In case this is the 2nd or greater display in a query.)
      235     1955        */
      236     1956    1       MEMORY_NEEDED = MEMORY_FRAME - COMMON_REDEF.WORD_OFFSET;
      237     1957    1       IF MEMORY_NEEDED > 0 THEN
      238     1958    1           ZII$COMMON$ = PINCRW(ZII$COMMON$,MEMORY_NEEDED);
      239     1959
      240     1960        /*
      241     1961          Now build the temporary list TDISPLAY_LIST from DISPLAY_LIST
      242     1962          and CONSTRAINT_LIST. TDISPLAY_LIST will contain all record
      243     1963          indices into the subschema tables built by ZII$BUILD_TABLES.
      244     1964          These record indices are only for records containing data items
      245     1965          involved in either the DISPLAY_ or CONSTRAINT_ lists.
      246     1966                                                                              */
      247     1967    1       MEMORY_NEEDED=DISPLAY_LIST.REC_NO(0)+1;
      248     1968    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,DUMMY_VECTOR) ALTRET(ER_COMMON);
      249     1969    1       DISPLAY_LIST# = DISPLAY_LIST.REC_NO(0);
      250     1970    1       TDISPLAY_LIST# = DISPLAY_LIST#;
      251     1971    2       DO N = 0 TO DISPLAY_LIST#;
      252     1972    2           TDISPLAY_LIST(N) = DISPLAY_LIST.REC_NO(N);
      253     1973    2           END;
      254     1974
      255     1975        /*
      256     1976          Select a Port record if needed.
      257     1977                                                                              */
      258     1978    1       IF ACCESS_LIST.PORT=0 THEN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:8    
      259     1979    1           IF TOPOLOGY_OPTIONS.PORTFLAG THEN
      260     1980    2           DO;
      261     1981    2               STATUS_CODE=%ZII_PORTFLAG;
      262     1982    2               ALTRETURN;
      263     1983    2               END;
      264     1984    1           ELSE
      265     1985    1               CALL SELECT_PORT;
      266     1986    1       ELSE IF ACCESS_LIST.PORT_TYPE = 0 THEN CALL SELECT_PORT;
      267     1987        /*
      268     1988          Initialize STATUS_CODE with zero.
      269     1989                                                                              */
      270     1990    1       STATUS_CODE=0;
      271     1991    1       MEMBER_OF_LIST=0;
      272     1992        /*
      273     1993          Init START_NODE (the current starting record for building partial
      274     1994          branches; initially it is the Port record) and the Port occurrence
      275     1995          in PATH_LIST, which always resides in PATH_LIST(1).
      276     1996        /*
      277     1997          Compute distances from the Port record for all records involved
      278     1998          in the subschema. If only one record in search, then don't build
      279     1999           the distances.                                                     */
      280     2000    1       CALL ZII$PATH_MEMORY(2,%GET) ALTRET(ER_COMMON);
      281     2001    1       PATH$_P=PINCRW(ZII$COMMON$,DISPLAY_LIST#+1);
      282     2002    1       PATH$=PATH$_P;
      283     2003    1       START_NODE=ACCESS_LIST.PORT;
      284     2004    1       REC_NO = 1;
      285     2005    1       PATH_LIST.REC_NO(0) = REC_NO;
      286     2006    1       PATH_LIST.REC_NO(1)=ACCESS_LIST.PORT;
      287     2007    1       PATH_LIST.SET_NO(1)=0;
      288     2008    1       PATH_LIST.OWN_NEXT(1)='0'B;
      289     2009    1       PATH_LIST.GET_IND(1)='1'B;
      290     2010    1       PATH_LIST.FIND_ATTEMPTED(1)='0'B;
      291     2011    1       PATH_LIST.REPEAT_IND(1)='0'B;
      292     2012    1       PATH_LIST.INIT_EPTR(1)=ENTADDR(NIL);
      293     2013    1       PATH_LIST.CONVERT_EPTR(1)=ENTADDR(NIL);
      294     2014    1       PATH_LIST.CONSTRAINT_EPTR(1)=ENTADDR(NIL);
      295     2015    1       CALL SET_DISPLAY_IND;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:9    
      296     2016        %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:10   
      297     2017        /*
      298     2018          If VIA_LIST(0)~=0, then Via information was supplied in the IDP
      299     2019          command DISPLAY and Topology must follow the "direction" it
      300     2020          was given. If Via information is exhausted before TDISPLAY_LIST
      301     2021          is exhausted, then all Via information has been used and the normal
      302     2022          method can be used to build the remainder of the Path to include
      303     2023          the remaining records of TDISPLAY_LIST in the Path.
      304     2024                                                                              */
      305     2025    1       TEMP_PORT_PATH_IDX = 1;
      306     2026    1       TEMP_PORT=ACCESS_LIST.PORT;
      307     2027    1       IF DISPLAY_LIST#>1 OR TDISPLAY_LIST(1) ~= ACCESS_LIST.PORT THEN
      308     2028    2       DO;
      309     2029    2           TEMP_ARG=TEMP_PORT;
      310     2030    2           CALL COMP_DIST(TEMP_ARG);
      311     2031    2           IF VIA_LIST(0)~=0 THEN
      312     2032    3           DO;
      313     2033    3               CURRENT_NODE=TEMP_PORT;
      314     2034    3               N=1;
      315     2035    4               DO WHILE (TDISPLAY_LIST#~=0);
      316     2036    5                   IF N<=VIA_LIST(0) THEN DO;
      317     2037    5                       CALL OWNER_SET(VIA_LIST(N),OWNER_REC) ALTRET(PRINT_VIA_WARN);
      318     2038    5                       CALL MEMBER_SET(VIA_LIST(N),MEMBER_LIST) ALTRET(PRINT_VIA_WARN);
      319     2039    5                       IF MEMBER_LIST.REC_NO(0)=1 THEN
      320     2040    5                           MEMBER_REC = MEMBER_LIST.REC_NO(1);
      321     2041    5                       ELSE IF N=VIA_LIST(0) THEN
      322     2042    5                               CALL PICK_A_MEMBER(MEMBER_LIST,MEMBER_REC);
      323     2043    5                           ELSE
      324     2044    5                               CALL PICK_A_MEMBER(MEMBER_LIST,MEMBER_REC,VIA_LIST(N+1))
              2044                                        ;
      325     2045    6                       IF OWNER_REC=CURRENT_NODE THEN DO;
      326     2046    6                           CALL ZII$PATH_MEMORY(1,%GET) ALTRET(ER_COMMON);
      327     2047    6                           PATH_LIST.SET_NO(REC_NO)=VIA_LIST(N);
      328     2048    6                           REC_NO=REC_NO+1;
      329     2049    6                           PATH_LIST.REC_NO(0) = REC_NO;
      330     2050    6                           PATH_LIST.REC_NO(REC_NO)=MEMBER_REC;
      331     2051    6                           PATH_LIST.SET_NO(REC_NO)=0;
      332     2052    6                           PATH_LIST.INIT_EPTR(REC_NO)=ENTADDR(NIL);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:11   
      333     2053    6                           PATH_LIST.CONSTRAINT_EPTR(REC_NO)=ENTADDR(NIL);
      334     2054    6                           PATH_LIST.CONVERT_EPTR(REC_NO)=ENTADDR(NIL);
      335     2055    6                           CALL SET_DISPLAY_IND;
      336     2056    6                           IF REC_NO > 1 THEN
      337     2057    7                           DO;
      338     2058    7                               K=1;
      339     2059    8                               DO WHILE (K<REC_NO);
      340     2060    8                                   IF PATH_LIST.REC_NO(K)=PATH_LIST.REC_NO(REC_NO) THEN
      341     2061    9                                   DO;
      342     2062    9                                       MEMBER_OF_LIST=1;
      343     2063    9                                       K=REC_NO;
      344     2064    9                                       END;
      345     2065    8                                   K=K+1;
      346     2066    8                                   END;
      347     2067    7                               IF MEMBER_OF_LIST=1 THEN
      348     2068    7                                   PATH_LIST.REPEAT_IND(REC_NO)='1'B;
      349     2069    7                               END;
      350     2070    6                           PATH_LIST.GET_IND(REC_NO)='1'B;
      351     2071    6                           CURRENT_NODE=MEMBER_REC;
      352     2072    6                           N=N+1;
      353     2073    6                           END;
      354     2074    6                       ELSE IF MEMBER_REC = CURRENT_NODE THEN DO;
      355     2075    6                               CALL ZII$PATH_MEMORY(1,%GET) ALTRET(ER_COMMON);
      356     2076    6                               PATH_LIST.SET_NO(REC_NO)=VIA_LIST(N);
      357     2077    6                               PATH_LIST.OWN_NEXT(REC_NO)='1'B;
      358     2078    6                               REC_NO=REC_NO+1;
      359     2079    6                               PATH_LIST.REC_NO(0)=REC_NO;
      360     2080    6                               PATH_LIST.REC_NO(REC_NO)=OWNER_REC;
      361     2081    6                               PATH_LIST.SET_NO(REC_NO)=0;
      362     2082    6                               PATH_LIST.GET_IND(REC_NO)='1'B;
      363     2083    6                               PATH_LIST.INIT_EPTR(REC_NO)=ENTADDR(NIL);
      364     2084    6                               PATH_LIST.CONVERT_EPTR(REC_NO)=ENTADDR(NIL);
      365     2085    6                               PATH_LIST.CONSTRAINT_EPTR(REC_NO)=ENTADDR(NIL);
      366     2086    6                               CALL SET_DISPLAY_IND;
      367     2087    6                               CURRENT_NODE=OWNER_REC;
      368     2088    6                               N=N+1;
      369     2089    6                               END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:12   
      370     2090    6                           ELSE DO;
      371     2091        /*
      372     2092          Since the current node was neither the owner nor the member of the
      373     2093          VIA set in question, use the generalized back-tracking algorithm
      374     2094          to get to the owner of the set. Then, eliminate all other VIA sets
      375     2095          included in the path by incrementing N and therefore excluding
      376     2096          them from further consideration.
      377     2097        */
      378     2098    6                               START_NODE=PATH_LIST.REC_NO(REC_NO);
      379     2099    6                               TEMP_PORT_PATH_IDX = REC_NO;
      380     2100    6                               TEMP_PORT=START_NODE;
      381     2101    6                               GOTO PRINT_VIA_WARN;
      382     2102         /* .................Comment out the unused code..............................
      383     2103
      384     2104            When (if) this gets put back in or replaced, notice that
      385     2105            the BACK_TRACK proc has been changed to BACK_TRACK_MAYBE.
      386     2106            In other words, it will not always build the branch anymore
      387     2107            for reasons expressed below, in the NORM section.
      388     2108
      389     2109            CALL BACK_TRACK(CURRENT_NODE,OWNER_REC) ALTRET(ER_COMMON);
      390     2110            CALL ELIMINATE_SETS;
      391     2111            IF STATUS_CODE=0 THEN
      392     2112            IF TOPOLOGY_OPTIONS.WARNING_CODE>0 THEN DO;
      393     2113            ILLEGAL_SETS_INCLUDED=1;
      394     2114            DO J = 1 TO REC_NO;
      395     2115            IF PATH_LIST.SET_NO(J) ~= 0  THEN DO;
      396     2116            DO K = 1 TO VIA_LIST(0);
      397     2117            IF PATH_LIST.SET_NO(J)=VIA_LIST(K) THEN DO;
      398     2118            ILLEGAL_SETS_INCLUDED=0;
      399     2119            K=VIA_LIST(0);
      400     2120            END;
      401     2121            END; /# Do K thru VIA_LIST #/
      402     2122            IF ILLEGAL_SETS_INCLUDED=1 THEN DO;
      403     2123            IF TOPOLOGY_OPTIONS.WARNING_CODE=2 THEN DO;
      404     2124            STATUS_CODE=%ZII_SETS_ABORT;
      405     2125            ALTRETURN;
      406     2126            END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:13   
      407     2127            ELSE
      408     2128            STATUS_CODE=%ZII_SETS_WARNING;
      409     2129            J=REC_NO+1;
      410     2130            END;
      411     2131            END; /# If PATH_LIST.SET_NO(J) ~= 0 #/
      412     2132            END; /# Do J = 1 thru PATH_LIST #/
      413     2133            END; /# If PATH WARN or ABORT #/
      414     2134         ...........................................................................*/
      415     2135    6                               END; /* Disconnected VIA_LIST */
      416     2136    5                       CALL NOT_PATHTBL(TDISPLAY_LIST,PATH$->PATH_LIST);
      417     2137    5                       END; /* If N <= VIA_LIST(0) */
      418     2138    4                   ELSE
      419     2139    5                   DO;
      420     2140    5                       START_NODE=PATH_LIST.REC_NO(REC_NO);
      421     2141    5                       TEMP_PORT_PATH_IDX = REC_NO;
      422     2142    5                       TEMP_PORT=START_NODE;
      423     2143    5                       GOTO NORM;
      424     2144    5                       END;
      425     2145    4                   END;
      426     2146        /*
      427     2147          Some Via sets were not used in the Path list if VIA_LIST(0)>=N;
      428     2148          Issue warning to calling program.
      429     2149        */
      430     2150    3   PRINT_VIA_WARN:;
      431     2151    3               IF N <= VIA_LIST(0) THEN
      432     2152    4               DO I = 1 TO 2; /* In case M$LO & M$DO are set to different places */
      433     2153    4                   J = N; /* Save original contents of N */
      434     2154    4                   TOPOLOGY_OPTIONS.PRINT_IND = '1'B;
      435     2155    4                   ERR_OUT.BUF_ = VECTOR(BLNK_LINE);
      436     2156    4                   CALL M$WRITE(ERR_OUT);
      437     2157    4                   ERR_OUT.BUF_ = VECTOR(VIA_ERROR);
      438     2158    4                   CALL M$WRITE(ERR_OUT);
      439     2159    4                   ERR_OUT.BUF_ = VECTOR(BLNK_LINE);
      440     2160    4                   CALL M$WRITE(ERR_OUT);
      441     2161    4                   ERR_OUT.BUF_ = VECTOR(ERR_LINE);
      442     2162    5                   DO WHILE (N <= VIA_LIST(0));
      443     2163    5                       ERR_LINE.SET_FD = NAM1.NAME.TEXT(VIA_LIST(N));
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:14   
      444     2164    5                       CALL M$WRITE(ERR_OUT);
      445     2165    5                       N = N+1;
      446     2166    5                       END;
      447     2167    4                   STATUS_CODE = 310;
      448     2168    4                   ERR_OUT.BUF_ = VECTOR(BLNK_LINE);
      449     2169    4                   CALL M$WRITE(ERR_OUT);
      450     2170    4                   CALL M$CORRES(LO_DO) ALTRET(NORM);
      451     2171    4                   ERR_OUT.V.DCB# = DCBNUM(M$DO);
      452     2172    4                   N = J;
      453     2173    4                   END;
      454     2174    3               END;
      455     2175    3           DO WHILE (TDISPLAY_LIST# > 0);
      456     2176        /*
      457     2177          If no Via information was supplied or if Via information was
      458     2178          exhausted and records still remain in TDISPLAY_LIST, then this
      459     2179          section will be executed.
      460     2180                                                                              */
      461     2181
      462     2182        /*
      463     2183          For B03 and beyond, this section also contains a kludge to
      464     2184          (hopefully) make paths built using VIA lists work. The general
      465     2185          idea is this. If we have a VIA list for a display, we will have
      466     2186          set up part of the path list by this point using the records and
      467     2187          sets indicated in the via list. As a repercussion of this, the
      468     2188          TEMP_PORT variable will no longer contain the index of the actual
      469     2189          port record but that of the last record entered in the path list.
      470     2190          This was causing problems when the path chosen was going to
      471     2191          contain a lambda structure. Unfortunately, if TEMP_PORT turned
      472     2192          out to be "below" the lambda pivot point, the possibility was
      473     2193          very high that the back tracking routine would build a bad branch
      474     2194          for retrieval purposes. E.g., if the record furthest away from
      475     2195          TEMP_PORT was connectable to TEMP_PORT via sets which involved the
      476     2196          lambda pivot record, then the branch built would back track to the
      477     2197          lambda pivot and then down a piece of a branch already built. This
      478     2198          caused a lot of excitement during retrieval. Anyway, suffice it to
      479     2199          say that the path list would easily end up unuseable in this kind
      480     2200          of situation.
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:15   
      481     2201
      482     2202          This "solution" tries to do the following. Regardless of what
      483     2203          TEMP_PORT is, we first find the record farthest away and build
      484     2204          the branch between. Then, we compare the branch just built with
      485     2205          the original branch. (If there was no via list, there won't be an
      486     2206          original branch yet.) If the branch just built has a record(s) in
      487     2207          it which is also in the original branch, then we are encountering
      488     2208          the problem mentioned above. If this is true, we mark the culprit
      489     2209          record(s) in D_TABLE, erase the new branch, go back, and find the
      490     2210          next longest branch which doesn't include any culprit records.
      491     2211          When we run out of acceptable branches (CURRENT_NODE still equals 0)
      492     2212          and there are still records left unattached, then we want to pop
      493     2213          TEMP_PORT back up the traversal tree (represented by the path list)
      494     2214          toward the port record and try again. However, we only want to back
      495     2215          up to a record which was flagged when we found lambda conflicts
      496     2216          before. These are the records which were found in the new branch
      497     2217          and also in the original (or a previously built) branch. At least
      498     2218          one of these must be a lambda pivot point. After backing up to the
      499     2219          closest one of these, we go back to the beginning of the NORM loop
      500     2220          and start over clean, recomputing distances to records not yet
      501     2221          attached from the new TEMP_PORT (i.e., rebuilding D_TABLE). This
      502     2222          method is reiterated until every required record has been attached
      503     2223          to the traversal tree (or path list). Hopefully, this will help
      504     2224          ensure that a path list will be at least theoretically useable in
      505     2225          retrieval. It may indicate nested lambda structures which cannot
      506     2226          be handled by the current retrieval mechanism, but this problem
      507     2227          should be caught later before any damage is done.
      508     2228        */
      509     2229    3   NORM:       TEMP_ARG=TEMP_PORT;
      510     2230         /*
      511     2231            Since we have a new temp port rec, we want to set (or reset)
      512     2232            these flags since they won't necessarily be true for this
      513     2233            version of the table. These may be set later if a new path
      514     2234            built is back tracking thru a (potential) lambda pivot
      515     2235            record located higher up in the traversal tree.
      516     2236         */
      517     2237    4               DO I = 0 TO TBL_DIM-1;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:16   
      518     2238    4                   D_TABLE.BELONGS_PREV_LAMBDA(I) = '0'B;
      519     2239    4                   END;
      520     2240    3               CALL COMP_DIST(TEMP_ARG);
      521     2241    3               LAMBDA_REC# = 0; /* The # of recs in the LAMBDA_RECS array */
      522     2242    4               DO WHILE (TDISPLAY_LIST#~=0 AND TEMP_ARG = TEMP_PORT);
      523     2243    4                   T_DIST=0;
      524     2244    4                   CURRENT_NODE=0;
      525     2245    4                   N=1;
      526     2246    5                   DO WHILE (N <= TDISPLAY_LIST#);
      527     2247    5                       CALL ZII$FIND_IDX(TDISPLAY_LIST(N),J);
      528     2248    5                       IF D_TABLE.DIST_FROM_PORT(J)>T_DIST AND
      529     2249    5                          NOT D_TABLE.BELONGS_PREV_LAMBDA(J) THEN
      530     2250    6                       DO;
      531     2251    6                           T_DIST=D_TABLE.DIST_FROM_PORT(J);
      532     2252    6                           CURRENT_NODE=TDISPLAY_LIST(N);
      533     2253    6                           END;
      534     2254    5                       N=N+1;
      535     2255    5                       END;
      536     2256         /*
      537     2257            If CURRENT_NODE=0 then we didn't find any more acceptable
      538     2258            branches from the current TEMP_PORT. Therefore, we want
      539     2259            to find the nearest rec which was a possible lambda pivot
      540     2260            and make it the new TEMP_PORT. I.e., pop back up the
      541     2261            traversal tree and start over again.
      542     2262         */
      543     2263    5                   IF CURRENT_NODE = 0 THEN DO;
      544     2264    5                       IF LAMBDA_REC# = 0 THEN
      545     2265    5                           GOTO ER_CANT_MAKE_PATH;
      546     2266    5                       TEMP_PORT_PATH_IDX = 0;
      547     2267    6                       DO I = 1 TO LAMBDA_REC#;
              2267                                /* IF should always be true at least once */
      548     2268    7                           IF LAMBDA_RECS.PATH_LIST_IDX(I) > TEMP_PORT_PATH_IDX THEN DO
              2268                                    ;
      549     2269    7                               TEMP_PORT_PATH_IDX = LAMBDA_RECS.PATH_LIST_IDX(I);
      550     2270    7                               TEMP_PORT = LAMBDA_RECS.REC_NO(I);
      551     2271    7                               IDX = I;
      552     2272    7                               END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:17   
      553     2273    6                           END;
      554     2274    5                       IF LAMBDA_REC# ~= IDX THEN
      555     2275    5                           LAMBDA_RECS(IDX) = LAMBDA_RECS(LAMBDA_REC#);
      556     2276    5                       LAMBDA_REC# = LAMBDA_REC# - 1;
      557     2277    5                       START_NODE = TEMP_PORT;
      558     2278    5                       END;
      559     2279    5                   ELSE DO;
      560     2280         /*
      561     2281            Else, we did find a potential branch to build. This
      562     2282            routine used to be called BACK_TRACK, but now we're
      563     2283            not always so sure. It will build the new branch in
      564     2284            the path list, but will check it before returning. If
      565     2285            the branch is unacceptable, it will be obliterated,
      566     2286            the potential lambda pivot records will be placed in
      567     2287            the LAMBDA_RECS array, and the records in the branch
      568     2288            will be flagged in D_TABLE.BELONGS_PREV_LAMBDA so that
      569     2289            we won't try to back track from any of them on the next
      570     2290            go round. DID_I just tells us whether we really built
      571     2291            the branch and saved it or whether we erased it because
      572     2292            it was bad. If we really built it, then we can safely
      573     2293            erase the records contained therein from the TDISPLAY
      574     2294            list.
      575     2295         */
      576     2296    5                       CALL BACK_TRACK_MAYBE(START_NODE,CURRENT_NODE,DID_I)
      577     2297    5                          ALTRET(ER_COMMON);
      578     2298    5                       IF DID_I = '1'B THEN
      579     2299    5                           CALL NOT_PATHTBL(TDISPLAY_LIST,PATH$->PATH_LIST);
      580     2300    5                       END;
      581     2301    4                   END;
      582     2302    3               END;
      583     2303        /*
      584     2304          In both cases, call COMPRESS_PATH to take out redundant record
      585     2305          appearances in the Path that were unseen during construction of
      586     2306          PATH_LIST.
      587     2307                                                                              */
      588     2308    2           CALL COMPRESS_PATH(PATH$->PATH_LIST);
      589     2309    2           END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:18   
      590     2310        /*
      591     2311          Check to see if this path list has more than 1 lambda structure
      592     2312          in it (nested lambdas). If so, we can't necessarily handle it
      593     2313          during retrieval, so tell him so and cancel this display.
      594     2314        */
      595     2315
      596     2316    1       N = 0;
      597     2317    2       DO I = 1 TO REC_NO-1;
      598     2318    3           DO J = I+1 TO REC_NO;
      599     2319    3               IF PATH_LIST.REC_NO(I) = PATH_LIST.REC_NO(J) THEN
      600     2320    3                   IF N=0
      601     2321    3                   THEN N = PATH_LIST.REC_NO(I);
      602     2322    4                   ELSE IF N ~= PATH_LIST.REC_NO(I) THEN DO;
      603     2323         /*
      604     2324            This indicates a nested lambda structure. However,
      605     2325            if the contained lambda structure has 2nd and higher
      606     2326            branches made up of only owners, then it should all
      607     2327            work O.K. anyway during retrieval, so let those
      608     2328            go thru.
      609     2329         */
      610     2330    4                           K=J;
      611     2331    5                           DO WHILE(PATH_LIST.SET_NO(K)~=0);
      612     2332    6                               IF NOT PATH_LIST.OWN_NEXT(K) THEN DO;
      613     2333    6                                   CALL ZII$PRINT_PATH(ACCESS_LIST,PATH_LIST,
              2333                                            DISPLAY_LIST);
      614     2334    6                                   STATUS_CODE = %ZII_NO_NESTED_LAMBDAS;
      615     2335    6                                   ALTRETURN;
      616     2336    6                                   END;
      617     2337    5                               K=K+1;
      618     2338    5                               END;
      619     2339    4                           END;
      620     2340    3               END;
      621     2341    2           END;
      622     2342    2       IF TOPOLOGY_OPTIONS.WARNING_CODE > 0 THEN DO;
      623     2343    3           DO J = 1 TO REC_NO;
      624     2344    3               ILLEGAL_SETS_INCLUDED=1;
      625     2345    4               IF PATH_LIST.SET_NO(J) ~= 0 THEN DO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:19   
      626     2346    5                   DO K = 1 TO VIA_LIST(0);
      627     2347    6                       IF PATH_LIST.SET_NO(J)=VIA_LIST(K) THEN DO;
      628     2348    6                           ILLEGAL_SETS_INCLUDED=0;
      629     2349    6                           K=VIA_LIST(0);
      630     2350    6                           END;
      631     2351    5                       END; /* Do K thru VIA_LIST */
      632     2352    5                   IF ILLEGAL_SETS_INCLUDED=1 THEN DO;
      633     2353    5                       IF TOPOLOGY_OPTIONS.WARNING_CODE=2 THEN
      634     2354    5                           STATUS_CODE=%ZII_SETS_ABORT;
      635     2355    5                       ELSE
      636     2356    5                           STATUS_CODE=%ZII_SETS_WARNING;
      637     2357    5                       J=REC_NO+1;
      638     2358    5                       END;
      639     2359    4                   END; /* If PATH_LIST.SET_NO(J) ~= 0 */
      640     2360    3               END; /* Do J = 1 thru REC_NO */
      641     2361    2           END; /* If PATH WARN or ABORT */
      642     2362        /*
      643     2363          Now print Topology analysis summary if it was requested by
      644     2364          the user via the TOPOLOGY ON command in IDP.                         */
      645     2365    1       IF TOPOLOGY_OPTIONS.PRINT_IND THEN
      646     2366    1           CALL ZII$PRINT_PATH(ACCESS_LIST,PATH_LIST,DISPLAY_LIST) ALTRET(
              2366                    ER_IMPOSSIBLE_PATH);
      647     2367    1       IF STATUS_CODE = %ZII_SETS_ABORT THEN ALTRETURN;
      648     2368    1       RETURN;
      649     2369    1   ER_COMMON:
      650     2370    1       STATUS_CODE=%ZII_NO_MEMORY;
      651     2371    1       ALTRETURN;
      652     2372    1   ER_IMPOSSIBLE_PATH:;
      653     2373    1       STATUS_CODE = %ZII_NO_NESTED_LAMBDAS;
      654     2374    1       ALTRETURN;
      655     2375    1   ER_CANT_MAKE_PATH:;
      656     2376    1       STATUS_CODE = %ZII_CANT_MAKE_PATH;
      657     2377    1       CALL ZII$PRINT_PATH(ACCESS_LIST,PATH_LIST,DISPLAY_LIST);
      658     2378    1       ALTRETURN;
      659     2379         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:20   
      660     2380    1   MEMBER_TBL: PROC(REC_IDX,IN_TBL,OUT_FLG);
      661     2381        /*
      662     2382          DESCRIPTION: This Proc takes a single index of a record in the
      663     2383                       subschema tables and compares it with all members of
      664     2384                       the list W until it either hits the end of the list,
      665     2385                       indicating that the index is not in the list, or when
      666     2386                       the same index is encountered in the list, indicating
      667     2387                       that the index is in the list.
      668     2388
      669     2389          IN:
      670     2390             REC_IDX := Single index of a record in the subschema tables.
      671     2391             IN_TBL := Table of indices of records in the subschema tables.
      672     2392
      673     2393          Out:
      674     2394              OUT_FLG := Idicator of membership: 0 = V is not in W,
      675     2395                                                 1 = V is a member of W.
      676     2396                                                                              */
      677     2397    2   DCL REC_IDX UBIN;
      678     2398    2   DCL IN_TBL (0:0) UBIN;
      679     2399    2   DCL OUT_FLG UBIN;
      680     2400    2   DCL N UBIN AUTO;
      681     2401        /**/
      682     2402    2       OUT_FLG=0;
      683     2403    2       N=1;
      684     2404    3       DO WHILE (N<=IN_TBL(0));
      685     2405    3           IF REC_IDX=IN_TBL(N) THEN
      686     2406    4           DO;
      687     2407    4               OUT_FLG=1;
      688     2408    4               N=IN_TBL(0);
      689     2409    4               END;
      690     2410    3           N=N+1;
      691     2411    3           END;
      692     2412    2       RETURN;
      693     2413    2   END MEMBER_TBL;
      694     2414         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:21   
      695     2415    1   EMPTY_TBL: PROC (IN_TBL,OUT_FLG);
      696     2416        /*
      697     2417          DESCRIPTION: This Proc determines whether a list is null.
      698     2418
      699     2419          IN:
      700     2420             IN_TBL := List of indices of records in the subschema tables.
      701     2421
      702     2422          OUT:
      703     2423              OUT_FLG := Indicator :  0 = List is null,
      704     2424                                      1 = List is not null.
      705     2425                                                                              */
      706     2426    2   DCL IN_TBL (0:0) UBIN;
      707     2427    2   DCL OUT_FLG UBIN;
      708     2428    2   DCL N UBIN AUTO;
      709     2429    2   DCL K UBIN AUTO;
      710     2430        /**/
      711     2431    2       OUT_FLG=0;
      712     2432    2       N=1;
      713     2433    3       DO WHILE (N<=IN_TBL(0));
      714     2434    3           IF IN_TBL(N)~=0 THEN
      715     2435    4           DO;
      716     2436    4               OUT_FLG=1;
      717     2437    4               RETURN;
      718     2438    4               END;
      719     2439    3           N=N+1;
      720     2440    3           END;
      721     2441    2       RETURN;
      722     2442    2   END EMPTY_TBL;
      723     2443         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:22   
      724     2444    1   BACK_TRACK_MAYBE: PROC (START_NODE,TERM_NODE,DID_I) ALTRET;
      725     2445        /*
      726     2446          DESCRIPTION: This proc is the main mechanism for finding a series
      727     2447                       of connected records between one record and another,
      728     2448                       namely START_NODE and TERM_NODE.
      729     2449          IN:
      730     2450             START_NODE := Starting node of partial branch (initially Port).
      731     2451             TERM_NODE := Node to be reached by some series of connected records.
      732     2452             PORT_RECORD := Record already cited as the Port record.
      733     2453             TDISPLAY_LIST := List containing indices of records involved
      734     2454                              in the search.
      735     2455          OUT:
      736     2456              PATH_LIST := The partial path of connected records that defines
      737     2457                           a path between START_NODE and V. There may be many partial
      738     2458                           paths (from successive calls to BACK_TRACK) and
      739     2459                           these are eventially put together in the calling
      740     2460                           routine (ZII$TOPOLOGY) to form the final Path.
      741     2461                                                                              */
      742     2462    2   DCL START_NODE UBIN;
      743     2463    2   DCL TERM_NODE UBIN;
      744     2464    2   DCL I UBIN AUTO;
      745     2465    2   DCL K UBIN AUTO;
      746     2466    2   DCL J UBIN AUTO;
      747     2467    2   DCL MAX_DIST UBIN AUTO;
      748     2468    2   DCL N UBIN AUTO;
      749     2469    2   DCL M UBIN AUTO;
      750     2470    2   DCL X UBIN AUTO;
      751     2471    2   DCL CUR_NODE UBIN AUTO;
      752     2472    2   DCL TEMP_ARG UBIN AUTO;
      753     2473    2   DCL MEM_FLG UBIN AUTO;
      754     2474    2   DCL PATH_SLOTS_NEEDED UBIN AUTO;
      755     2475    2   DCL START_OF_BRANCH UBIN AUTO;
      756     2476    2   DCL DID_I BIT(1) ALIGNED;
      757     2477    2   DCL ADD_TO_LAMBDA_RECS BIT(1) ALIGNED;
      758     2478    2   DCL SAVE_REC_NO UBIN AUTO;
      759     2479    2   DCL SET_NO UBIN;
      760     2480        /**/
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:23   
      761     2481    2   DCL ZII$FIND_D2_IDX ENTRY(3);
      762     2482    2   DCL ZII$PATH_MEMORY ENTRY(2) ALTRET;
      763     2483        /**/
      764     2484    2       IF REC_NO=1 THEN
      765     2485    2           START_OF_BRANCH=1;
      766     2486    2       ELSE
      767     2487    2           START_OF_BRANCH=REC_NO+1;
      768     2488         /* Save it in case we end up throwing this new branch away. */
      769     2489    2       SAVE_REC_NO = REC_NO;
      770     2490    2       CUR_NODE=TERM_NODE;
      771     2491    2       CALL ZII$FIND_IDX(TERM_NODE,N);
      772     2492    2       MAX_DIST=D_TABLE.DIST_FROM_PORT(N)+START_OF_BRANCH;
      773     2493    2       PATH_SLOTS_NEEDED=MAX_DIST;
      774     2494    2       CALL ZII$PATH_MEMORY(PATH_SLOTS_NEEDED,%GET) ALTRET(ER_COMMON);
      775     2495    2       PATH_LIST.REC_NO(MAX_DIST)=CUR_NODE;
      776     2496    2       REC_NO = REC_NO + 1;
      777     2497    2       PATH_LIST.REC_NO(0)=REC_NO;
      778     2498    2       PATH_LIST.FIND_ATTEMPTED(MAX_DIST)='0'B;
      779     2499    2       PATH_LIST.GET_IND(MAX_DIST)='1'B;
      780     2500    2       PATH_LIST.OWN_NEXT(MAX_DIST)='0'B;
      781     2501    2       PATH_LIST.SET_NO(MAX_DIST)=0;
      782     2502    2       PATH_LIST.INIT_EPTR(MAX_DIST)=ENTADDR(NIL);
      783     2503    2       PATH_LIST.CONVERT_EPTR(MAX_DIST)=ENTADDR(NIL);
      784     2504    2       PATH_LIST.CONSTRAINT_EPTR(MAX_DIST)=ENTADDR(NIL);
      785     2505    3       DO K=1 TO DISPLAY_LIST#;
      786     2506    3           IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(MAX_DIST)
      787     2507    3              AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      788     2508    4           DO;
      789     2509    4               PATH_LIST.DISPLAY_IND(MAX_DIST)='1'B;
      790     2510    4               K=DISPLAY_LIST#+1;
      791     2511    4               END;
      792     2512    3           END;
      793     2513    2       J=1;
      794     2514    3       DO WHILE (J + START_OF_BRANCH < MAX_DIST);
      795     2515    3           PATH_LIST.REC_NO(MAX_DIST-J)=0;
      796     2516    3           I=0;
      797     2517    4           DO WHILE (I<TBL_DIM);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:24   
      798     2518    4               IF D_TABLE.REC_NO(I)~=CUR_NODE AND
      799     2519    4                  D_TABLE.DIST_FROM_PORT(I)=((MAX_DIST-START_OF_BRANCH)-J) THEN
      800     2520    5               DO;
      801     2521    5                   TEMP_ARG=D_TABLE.REC_NO(I);
      802     2522    5                   CALL ZII$FIND_D2_IDX(TEMP_ARG,CUR_NODE,X);
      803     2523    5                   IF D2_TABLE.SET_IND(X)~=0 THEN
      804     2524    6                   DO;
      805     2525    6                       DS$=NAM1.DESC$(D2_TABLE.SET_IND(X));
      806     2526    6                       IF SET.OWNER_IDX=CUR_NODE THEN
      807     2527    7                       DO;
      808     2528    7                           SET_NO = D2_TABLE.SET_IND(X);
      809     2529    7                           CALL MEMBER_SET(SET_NO,MEMBER_LIST);
      810     2530    7                           IF MEMBER_LIST.REC_NO(0) > 1 THEN
      811     2531    7                               CALL PICK_A_MEMBER(MEMBER_LIST,TEMP_ARG);
      812     2532    7                           PATH_LIST.REC_NO(MAX_DIST-J)=TEMP_ARG;
      813     2533    7                           PATH_LIST.SET_NO(MAX_DIST-J)=SET.NAM_IDX;
      814     2534    7                           CALL MEMBER_TBL(TEMP_ARG,TDISPLAY_LIST,MEM_FLG);
      815     2535    7                           IF MEM_FLG=1 THEN
      816     2536    7                               PATH_LIST.GET_IND(MAX_DIST-J)='1'B;
      817     2537    7                           ELSE
      818     2538    7                               PATH_LIST.GET_IND(MAX_DIST-J)='0'B;
      819     2539    7                           PATH_LIST.OWN_NEXT(MAX_DIST-J)='1'B;
      820     2540    7                           PATH_LIST.FIND_ATTEMPTED(MAX_DIST-J)='0'B;
      821     2541    7                           PATH_LIST.INIT_EPTR(MAX_DIST-J)=ENTADDR(NIL);
      822     2542    7                           PATH_LIST.CONVERT_EPTR(MAX_DIST-J)=ENTADDR(NIL);
      823     2543    7                           PATH_LIST.CONSTRAINT_EPTR(MAX_DIST-J)=ENTADDR(NIL);
      824     2544    7                           REC_NO = REC_NO + 1;
      825     2545    7                           PATH_LIST.REC_NO(0)=REC_NO;
      826     2546    8                           DO K=1 TO DISPLAY_LIST#;
      827     2547    8                               IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(MAX_DIST-J)
      828     2548    8                                  AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      829     2549    9                               DO;
      830     2550    9                                   PATH_LIST.DISPLAY_IND(MAX_DIST-J)='1'B;
      831     2551    9                                   K=DISPLAY_LIST#+1;
      832     2552    9                                   END;
      833     2553    8                               END;
      834     2554    7                           CUR_NODE=TEMP_ARG;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:25   
      835     2555    7                           I = TBL_DIM;
      836     2556    7                           END;
      837     2557    6                       END;
      838     2558    5                   END;
      839     2559    4               I=I+1;
      840     2560    4               END;
      841     2561    3           IF PATH_LIST.REC_NO(MAX_DIST-J)=0 THEN
      842     2562    4           DO;
      843     2563    4               I=0;
      844     2564    5               DO WHILE (I<TBL_DIM);
      845     2565    5                   IF D_TABLE.DIST_FROM_PORT(I)=((MAX_DIST-START_OF_BRANCH)-J) THEN
      846     2566    6                   DO;
      847     2567    6                       TEMP_ARG=D_TABLE.REC_NO(I);
      848     2568    6                       CALL ZII$FIND_D2_IDX(CUR_NODE,TEMP_ARG,X);
      849     2569    6                       IF D2_TABLE.SET_IND(X)~=0 THEN
      850     2570    7                       DO;
      851     2571    7                           DS$=NAM1.DESC$(D2_TABLE.SET_IND(X));
      852     2572    7                           IF SET.OWNER_IDX=CUR_NODE THEN
      853     2573    8                           DO;
      854     2574    8                               SET_NO = D2_TABLE.SET_IND(X);
      855     2575    8                               CALL MEMBER_SET(SET_NO,MEMBER_LIST);
      856     2576    8                               IF MEMBER_LIST.REC_NO(0) > 1 THEN
      857     2577    8                                   CALL PICK_A_MEMBER(MEMBER_LIST,TEMP_ARG);
      858     2578    8                               PATH_LIST.OWN_NEXT(MAX_DIST-J)='1'B;
      859     2579    8                               END;
      860     2580    7                           ELSE
      861     2581    7                               PATH_LIST.OWN_NEXT(MAX_DIST-J)='0'B;
      862     2582    7                           PATH_LIST.REC_NO(MAX_DIST-J)=TEMP_ARG;
      863     2583    7                           PATH_LIST.SET_NO(MAX_DIST-J)=D2_TABLE.SET_IND(X);
      864     2584    7                           CALL MEMBER_TBL(TEMP_ARG,
      865     2585    7                              TDISPLAY_LIST,MEM_FLG);
      866     2586    7                           IF MEM_FLG=1 THEN
      867     2587    7                               PATH_LIST.GET_IND(MAX_DIST-J)='1'B;
      868     2588    7                           ELSE
      869     2589    7                               PATH_LIST.GET_IND(MAX_DIST-J)='0'B;
      870     2590    7                           PATH_LIST.FIND_ATTEMPTED(MAX_DIST-J)='0'B;
      871     2591    7                           PATH_LIST.INIT_EPTR(MAX_DIST-J)=ENTADDR(NIL);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:26   
      872     2592    7                           PATH_LIST.CONVERT_EPTR(MAX_DIST-J)=ENTADDR(NIL);
      873     2593    7                           PATH_LIST.CONSTRAINT_EPTR(MAX_DIST-J)=ENTADDR(NIL);
      874     2594    7                           REC_NO = REC_NO + 1;
      875     2595    7                           PATH_LIST.REC_NO(0)=REC_NO;
      876     2596    8                           DO K=1 TO DISPLAY_LIST#;
      877     2597    8                               IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(MAX_DIST-J)
      878     2598    8                                  AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      879     2599    9                               DO;
      880     2600    9                                   PATH_LIST.DISPLAY_IND(MAX_DIST-J)='1'B;
      881     2601    9                                   K=DISPLAY_LIST#+1;
      882     2602    9                                   END;
      883     2603    8                               END;
      884     2604    7                           CUR_NODE=TEMP_ARG;
      885     2605    7                           I=TBL_DIM;
      886     2606    7                           END;
      887     2607    6                       END;
      888     2608    5                   I=I+1;
      889     2609    5                   END;
      890     2610    4               END;
      891     2611    3           J=J+1;
      892     2612    3           END;
      893     2613    2       CALL ZII$FIND_IDX(START_NODE,N);
      894     2614    2       PATH_LIST.REC_NO(START_OF_BRANCH)=START_NODE;
      895     2615    2       IF START_OF_BRANCH>1 THEN
      896     2616    2           REC_NO = REC_NO + 1;
      897     2617    2       PATH_LIST.REC_NO(0)=REC_NO;
      898     2618    2       TEMP_ARG=PATH_LIST.REC_NO(START_OF_BRANCH+1);
      899     2619    2       CALL ZII$FIND_D2_IDX(START_NODE,TEMP_ARG,X);
      900     2620    2       PATH_LIST.SET_NO(START_OF_BRANCH)=D2_TABLE.SET_IND(X);
      901     2621    2       DS$=NAM1.DESC$(D2_TABLE.SET_IND(X));
      902     2622    2       IF SET.OWNER_IDX=START_NODE THEN
      903     2623    2           PATH_LIST.OWN_NEXT(START_OF_BRANCH)='0'B;
      904     2624    2       ELSE
      905     2625    2           PATH_LIST.OWN_NEXT(START_OF_BRANCH)='1'B;
      906     2626    2       PATH_LIST.GET_IND(START_OF_BRANCH)='1'B;
      907     2627    2       PATH_LIST.FIND_ATTEMPTED(START_OF_BRANCH)='0'B;
      908     2628    2       PATH_LIST.INIT_EPTR(START_OF_BRANCH)=ENTADDR(NIL);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:27   
      909     2629    2       PATH_LIST.CONVERT_EPTR(START_OF_BRANCH)=ENTADDR(NIL);
      910     2630    2       PATH_LIST.CONSTRAINT_EPTR(START_OF_BRANCH)=ENTADDR(NIL);
      911     2631    3       DO K=1 TO DISPLAY_LIST#;
      912     2632    3           IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(START_OF_BRANCH)
      913     2633    3              AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      914     2634    4           DO;
      915     2635    4               PATH_LIST.DISPLAY_IND(START_OF_BRANCH)='1'B;
      916     2636    4               K=DISPLAY_LIST#+1;
      917     2637    4               END;
      918     2638    3           END;
      919     2639    2       DID_I = '1'B;
      920     2640        /*
      921     2641          It's only necessary to see if the new branch is bad if (1) there
      922     2642          was a via list to begin with and (2) the branch just built
      923     2643          contains more than just the start node and terminal node. We know
      924     2644          the terminal node can't be also in any previous branches or it would
      925     2645          never been chosen as the terminal node. We also know that the start
      926     2646          node is not a problem. Therefore, we only need to look if there are
      927     2647          other nodes in between to complete the branch.
      928     2648        */
      929     2649    3       IF VIA_LIST(0) ~= 0 AND MAX_DIST-START_OF_BRANCH > 1 THEN DO;
      930     2650    4           DO I = START_OF_BRANCH+1 TO REC_NO-1; /* New branch */
      931     2651    5               DO J = 1 TO SAVE_REC_NO; /* Previous branch(es) */
      932     2652    5                   IF (PATH_LIST.REC_NO(I) = PATH_LIST.REC_NO(J)) AND
      933     2653    6                      (J < TEMP_PORT_PATH_IDX) THEN DO;
      934     2654    6                       ADD_TO_LAMBDA_RECS = '1'B;
      935     2655         /* We only want to add this to LAMBDA_RECS if it's not
      936     2656            there already. */
      937     2657    7                       DO K = 1 TO LAMBDA_REC#;
      938     2658    7                           IF LAMBDA_RECS.REC_NO(K) = PATH_LIST.REC_NO(I) THEN
      939     2659    7                               ADD_TO_LAMBDA_RECS = '0'B;
      940     2660    7                           END;
      941     2661    7                       IF ADD_TO_LAMBDA_RECS THEN DO;
      942     2662    7                           LAMBDA_REC# = LAMBDA_REC# + 1;
      943     2663    7                           LAMBDA_RECS.REC_NO(LAMBDA_REC#) = PATH_LIST.REC_NO(J);
      944     2664    7                           LAMBDA_RECS.PATH_LIST_IDX(LAMBDA_REC#) = J;
      945     2665    8                           DO K = START_OF_BRANCH+1 TO REC_NO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:28   
      946     2666    8                               CUR_NODE = PATH_LIST.REC_NO(K);
      947     2667    8                               CALL ZII$FIND_IDX(CUR_NODE,X);
      948     2668    8                               D_TABLE.BELONGS_PREV_LAMBDA(X) = '1'B;
      949     2669    8                               END;
      950     2670    7                           END;
      951     2671    6                       DID_I = '0'B;
      952     2672    6                       END;
      953     2673    5                   END;
      954     2674    4               END;
      955     2675         /*
      956     2676            If the new branch is a bad one, restore the path list to
      957     2677            the state it was in before we started.
      958     2678         */
      959     2679    4           IF DID_I = '0'B THEN DO;
      960     2680    4               REC_NO = SAVE_REC_NO;
      961     2681    4               PATH_LIST.REC_NO(0) = SAVE_REC_NO;
      962     2682    4               CALL ZII$PATH_MEMORY(PATH_SLOTS_NEEDED,%RLSE);
      963     2683    4               END;
      964     2684    3           END;
      965     2685    2       RETURN;
      966     2686    2   ER_COMMON:
      967     2687    2       ALTRETURN;
      968     2688    2   END BACK_TRACK_MAYBE;
      969     2689         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:29   
      970     2690    1   COMPRESS_PATH: PROC(PATH_LIST);
      971     2691        /*
      972     2692          DESCRIPTION: This proc is used to compress the Path list in order
      973     2693                       to rid it of non-essentially redundant record index
      974     2694                       appearances.
      975     2695
      976     2696          IN:
      977     2697             PATH_LIST := The structure defining the calls and directions for
      978     2698                          the Retrieval module to perform. This list appears
      979     2699                          in the ZI$PATH_STRUCTS include file.
      980     2700
      981     2701          OUT:
      982     2702              PATH_LIST := same as above but may contain fewer occurrences.
      983     2703                                                                              */
      984     2704    2   DCL I UBIN AUTO;
      985     2705    2   DCL J UBIN AUTO;
      986     2706        /**/
      987     2707        %PATH_DESC (STCLASS=" ");
      988     2747        /**/
      989     2748        /**/
      990     2749    2       I=2;
      991     2750    3       DO WHILE (I<=REC_NO);
      992     2751    3           IF PATH_LIST.REC_NO(I)=PATH_LIST.REC_NO(1) THEN
      993     2752    4           DO;
      994     2753    4               I=I+1;
      995     2754    4               J=2;
      996     2755    5               DO WHILE (PATH_LIST.REC_NO(I)=PATH_LIST.REC_NO(J));
      997     2756    5                   PATH_LIST.REC_NO(I-1)=0;
      998     2757    5                   J=J+1;
      999     2758    5                   I=I+1;
     1000     2759    5                   END;
     1001     2760    4               END;
     1002     2761    3           I=I+1;
     1003     2762    3           END;
     1004     2763    2       I=1;
     1005     2764    2       J=1;
     1006     2765    3       DO WHILE (I<=REC_NO);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:30   
     1007     2766    3           IF PATH_LIST.REC_NO(I)~=0 THEN
     1008     2767    4           DO;
     1009     2768    4               PATH_LIST.REC_NO(J)=PATH_LIST.REC_NO(I);
     1010     2769    4               PATH_LIST.SET_NO(J)=PATH_LIST.SET_NO(I);
     1011     2770    4               PATH_LIST.GET_IND(J)=PATH_LIST.GET_IND(I);
     1012     2771    4               PATH_LIST.OWN_NEXT(J)=PATH_LIST.OWN_NEXT(I);
     1013     2772    4               PATH_LIST.DISPLAY_IND(J)=PATH_LIST.DISPLAY_IND(I);
     1014     2773    4               PATH_LIST.FIND_ATTEMPTED(J)=PATH_LIST.FIND_ATTEMPTED(I);
     1015     2774    4               J=J+1;
     1016     2775    4               END;
     1017     2776    3           I=I+1;
     1018     2777    3           END;
     1019     2778    2       REC_NO=REC_NO-(I-J);
     1020     2779    2       PATH_LIST.REC_NO(0)=REC_NO;
     1021     2780    2       J=1;
     1022     2781    3       DO WHILE (J<REC_NO);
     1023     2782    3           IF PATH_LIST.REC_NO(J)=PATH_LIST.REC_NO(J+1) THEN
     1024     2783    3               PATH_LIST.REC_NO(J)=0;
     1025     2784    3           J=J+1;
     1026     2785    3           END;
     1027     2786    2       CALL NOT_PATHPT(PATH_LIST,0);
     1028     2787        /* Now fill in the Repeat indicators for all recurring lambda structure
     1029     2788           owning records. */
     1030     2789    2       PATH_LIST.REPEAT_IND(1)='0'B;
     1031     2790    2       J=2;
     1032     2791    3       DO WHILE (J<=REC_NO);
     1033     2792    3           I=1;
     1034     2793    4           DO WHILE (I<J);
     1035     2794    4               IF PATH_LIST.REC_NO(I)=PATH_LIST.REC_NO(J) THEN
     1036     2795    5               DO;
     1037     2796    5                   PATH_LIST.REPEAT_IND(J)='1'B;
     1038     2797    5                   I=J;
     1039     2798    5                   END;
     1040     2799    4               ELSE
     1041     2800    4                   PATH_LIST.REPEAT_IND(J)='0'B;
     1042     2801    4               I=I+1;
     1043     2802    4               END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:31   
     1044     2803    3           J=J+1;
     1045     2804    3           END;
     1046     2805    2       RETURN;
     1047     2806    2   END COMPRESS_PATH;
     1048     2807         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:32   
     1049     2808    1   COMP_DIST: PROC (PORT_RECORD);
     1050     2809        /*
     1051     2810          DESCRIPTION: This proc uses the Port record as input and
     1052     2811                       proceeds to compute path lengths from all other records
     1053     2812                       to the Port record. there is no value retrned but
     1054     2813                       the result of COMP_DIST is the information placed
     1055     2814                       into D_TABLE in the Common segment.
     1056     2815
     1057     2816          IN:
     1058     2817             ACCESS_LIST.PORT := Index to the record previously defined as the
     1059     2818                            Port record.
     1060     2819
     1061     2820          OUT:
     1062     2821              [None]
     1063     2822                                                                              */
     1064     2823        /**/
     1065     2824    2   DCL ZII$FIND_D2_IDX ENTRY(3);
     1066     2825        /**/
     1067     2826    2   DCL PORT_RECORD UBIN;
     1068     2827    2   DCL K UBIN AUTO;
     1069     2828    2   DCL X UBIN AUTO;
     1070     2829    2   DCL Y UBIN AUTO;
     1071     2830    2   DCL M (0:200) UBIN STATIC;
     1072     2831    2   DCL W (0:200) UBIN STATIC;
     1073     2832    2   DCL W_LENGTH UBIN AUTO;
     1074     2833    2   DCL MEM_FLG UBIN AUTO;
     1075     2834    2   DCL D2_IND UBIN AUTO;
     1076     2835    2   DCL ZER_FLG UBIN AUTO;
     1077     2836    2   DCL TEMP_ARG UBIN AUTO;
     1078     2837        /**/
     1079     2838    2       M='0'B;
     1080     2839    2       W='0'B;
     1081     2840    2       W(0)=1;
     1082     2841    2       K=0;
     1083     2842    2       W(1)=PORT_RECORD;
     1084     2843    2       MEM_FLG=0;
     1085     2844    2       ZER_FLG=1;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:33   
     1086     2845    3       DO WHILE (W(0)~=0);
     1087     2846    3           CALL UNION_MAT(M,W);
     1088     2847    3           CALL SET_DISTANCE(W,K);
     1089     2848    3           K=K+1;
     1090     2849    3           W_LENGTH=W(0);
     1091     2850    3           X=1;
     1092     2851    4           DO WHILE (X<=W_LENGTH);
     1093     2852    4               Y=0;
     1094     2853    5               DO WHILE (Y<TBL_DIM);
     1095     2854    5                   TEMP_ARG=D_TABLE.REC_NO(Y);
     1096     2855    5                   CALL MEMBER_TBL(TEMP_ARG,M,MEM_FLG);
     1097     2856    5                   IF MEM_FLG=0 THEN
     1098     2857    6                   DO;
     1099     2858    6                       TEMP_ARG=D_TABLE.REC_NO(Y);
     1100     2859    6                       CALL ZII$FIND_D2_IDX(W(X),TEMP_ARG,D2_IND);
     1101     2860    6                       IF D2_TABLE.SET_IND(D2_IND)~=0 THEN
     1102     2861    7                       DO;
     1103     2862    7                           TEMP_ARG=D_TABLE.REC_NO(Y);
     1104     2863    7                           CALL MEMBER_TBL(TEMP_ARG,W,MEM_FLG);
     1105     2864    7                           IF MEM_FLG=0 THEN
     1106     2865    8                           DO;
     1107     2866    8                               W(W(0)+1)=D_TABLE.REC_NO(Y);
     1108     2867    8                               W(0)=W(0)+1;
     1109     2868    8                               END;
     1110     2869    7                           END;
     1111     2870    6                       END;
     1112     2871    5                   Y=Y+1;
     1113     2872    5                   END;
     1114     2873    4               X=X+1;
     1115     2874    4               END;
     1116     2875    3           CALL NOT_TBL(W,M);
     1117     2876    3           END;
     1118     2877    2       RETURN;
     1119     2878         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:34   
     1120     2879    2   SET_DISTANCE: PROC (IN_TBL,DISTANCE);
     1121     2880        /*
     1122     2881          DESCRIPTION: This routine finds the matching entry of W in D_TABLE
     1123     2882                       and sets the appropriate area in the structure to the
     1124     2883                       distance K from the Port record.
     1125     2884
     1126     2885          IN:
     1127     2886             IN_TBL := List of record indices into subschema tables.
     1128     2887             DISTANCE := Current distance from Port record.
     1129     2888
     1130     2889          OUT:
     1131     2890              [None]
     1132     2891                                                                              */
     1133     2892    3   DCL IN_TBL (0:0) UBIN;
     1134     2893    3   DCL DISTANCE UBIN;
     1135     2894    3   DCL I UBIN AUTO;
     1136     2895    3   DCL J UBIN AUTO;
     1137     2896        /**/
     1138     2897    3   DCL ZII$FIND_IDX ENTRY(2);
     1139     2898        /**/
     1140     2899    3       I=1;
     1141     2900    4       DO WHILE (I<=IN_TBL(0));
     1142     2901    4           CALL ZII$FIND_IDX(IN_TBL(I),J);
     1143     2902    4           D_TABLE.DIST_FROM_PORT(J)=DISTANCE;
     1144     2903    4           I=I+1;
     1145     2904    4           END;
     1146     2905    3       RETURN;
     1147     2906    3   END SET_DISTANCE;
     1148     2907    2   END COMP_DIST;
     1149     2908         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:35   
     1150     2909    1   SELECT_PORT: PROC;
     1151     2910    2   DCL I UBIN;
     1152     2911    2   DCL J UBIN;
     1153     2912    2   DCL K UBIN;
     1154     2913    2   DCL REC_NO UBIN;
     1155     2914    2   DCL THISPX UBIN;
     1156     2915    2   DCL BESTPX UBIN;
     1157     2916    2   DCL PORT UBIN;
     1158     2917    2   DCL PORT_KEY UBIN;
     1159     2918         /* []  KEYED  SPEC.KEY  CONSTRAINT  OUT_CLASS>0
     1160     2919            1    Y       Y          Y            Y
     1161     2920            2    Y       Y          Y
     1162     2921            3    Y       Y                       Y
     1163     2922            4    Y       Y
     1164     2923            5    Y                  Y            Y
     1165     2924            6    Y                  Y
     1166     2925            7    Y                               Y
     1167     2926            8    Y
     1168     2927            9    N                  Y            Y
     1169     2928            10    N                  Y
     1170     2929            11    N                               Y
     1171     2930            12    N
     1172     2931         */
     1173     2932    2   DCL ZII$FIND_IDX ENTRY(2);
     1174     2933        %DSC_RFK;
     1175     2949         /*
     1176     2950            Attempt to use one of the port optimization candidates as a port
     1177     2951            prefering one with an OUT_CLASS>0.
     1178     2952         */
     1179     2953    2       IF CANDIDATE_LIST.REC_NO(0) ~= 0 THEN
     1180     2954    3       DO;
     1181     2955    4           DO I = 1 TO CANDIDATE_LIST.REC_NO(0);
     1182     2956    4               REC_NO = CANDIDATE_LIST.REC_NO(I);
     1183     2957    4               CALL ZII$FIND_IDX(REC_NO,J);
     1184     2958    4               IF D_TABLE.OUT_CLASS(J) ~= 0 THEN
     1185     2959    5               DO;
     1186     2960    5                   ACCESS_LIST.PORT = REC_NO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:36   
     1187     2961    5                   IF CANDIDATE_LIST.KEY_NO(I) = 0 THEN
     1188     2962    5                       ACCESS_LIST.PORT_TYPE = %CALC_ACCESS;
     1189     2963    6                   ELSE DO;
     1190     2964    6                       ACCESS_LIST.PORT_KEY = CANDIDATE_LIST.KEY_NO(I);
     1191     2965    6                       ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;
     1192     2966    6                       END;
     1193     2967    5                   CANDIDATE_LIST.KEY_NO(0) = I;
     1194     2968    5                   RETURN;
     1195     2969    5                   END;
     1196     2970    4               END;
     1197     2971    3           ACCESS_LIST.PORT = REC_NO;
     1198     2972    3           IF CANDIDATE_LIST.KEY_NO(1) = 0 THEN
     1199     2973    3               ACCESS_LIST.PORT_TYPE = %CALC_ACCESS;
     1200     2974    4           ELSE DO;
     1201     2975    4               ACCESS_LIST.PORT_KEY = CANDIDATE_LIST.KEY_NO(1);
     1202     2976    4               ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;
     1203     2977    4               END;
     1204     2978    3           CANDIDATE_LIST.KEY_NO(0) = 1;
     1205     2979    3           RETURN;
     1206     2980    3           END;
     1207     2981        /*
     1208     2982            Handle the situation where a port record was given but no
     1209     2983            access type was specified.  If there are alternate keys, take
     1210     2984            the 1st one found and make the type 'keyed'.  If not, make
     1211     2985            it 'serial'.
     1212     2986        */
     1213     2987    3       IF ACCESS_LIST.PORT ~= 0 THEN DO; /* PORT_TYPE = 0 */
     1214     2988    3           DR$ = NAM1.DESC$(ACCESS_LIST.PORT);
     1215     2989    4           IF RECORD.RFK_DSC$ ~= ADDR(NIL) THEN DO;
     1216     2990    4               ACCESS_LIST.PORT_KEY = RECORD.RFK_DSC$->RFK_DSC.KEY_IDX;
     1217     2991    4               ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;
     1218     2992    4               END;
     1219     2993    3           ELSE ACCESS_LIST.PORT_TYPE = %SERIAL_ACCESS;
     1220     2994    3           RETURN;
     1221     2995    3           END;
     1222     2996
     1223     2997         /*
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:37   
     1224     2998            Try for the best possible un-optimized port.  The choice is made
     1225     2999            from the display list in the following order.
     1226     3000            1.  A keyed record which matches a specific given key, is used
     1227     3001            in a constraint and has OUT_CLASS > 0.
     1228     3002            2.  Same but OUT_CLASS = 0.
     1229     3003            3.  A keyed record which matches a specific given key, and has
     1230     3004            OUT_CLASS > 0.
     1231     3005            4.  Same but OUT_CLASS = 0.
     1232     3006            5.  A keyed record, used in a constraint and has OUT_CLASS > 0.
     1233     3007            6.  Same but OUT_CLASS = 0.
     1234     3008            7.  A keyed record with OUT_CLASS > 0.
     1235     3009            8.  A keyed record.
     1236     3010            9.  A record used in a constraint with OUT_CLASS > 0.
     1237     3011            10.  A record used in a constraint.
     1238     3012            11.  A record with OUT_CLASS > 0.
     1239     3013            12.  The first record in the display list.
     1240     3014         */
     1241     3015    2       PORT = DISPLAY_LIST.REC_NO(1);
     1242     3016    2       BESTPX = 12;
     1243     3017    3       DO I = 1 TO DISPLAY_LIST#;
     1244     3018    3           REC_NO = DISPLAY_LIST.REC_NO(I);
     1245     3019    3           THISPX = 12;
     1246     3020    3           DR$ = NAM1.DESC$(REC_NO);
     1247     3021    3           IF RECORD.RFK_DSC$ ~= ADDR(NIL) THEN
     1248     3022    4           DO;
     1249     3023    4               THISPX = 8;
     1250     3024    4               K = RECORD.RFK_DSC$->RFK_DSC.KEY_IDX;
     1251     3025    4               IF ACCESS_LIST.PORT_KEY ~= 0 THEN
     1252     3026    5               DO;
     1253     3027    5                   DRFK$ = RECORD.RFK_DSC$;
     1254     3028    6                   DO WHILE(DRFK$ ~= ADDR(NIL) AND THISPX ~= 4);
     1255     3029    6                       IF ACCESS_LIST.PORT_KEY = RFK_DSC.KEY_IDX THEN
     1256     3030    6                           THISPX = 4;
     1257     3031    6                       DRFK$ = RFK_DSC.REC$;
     1258     3032    6                       END;
     1259     3033    5                   END;
     1260     3034    4               END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:38   
     1261     3035    3           IF THISPX < BESTPX+3 THEN
     1262     3036    4           DO;
     1263     3037    4               IF DISPLAY_LIST.IND.CONSTRAINT(I) = 1 THEN
     1264     3038    4                   THISPX = THISPX - 2;
     1265     3039    4               CALL ZII$FIND_IDX(REC_NO,J);
     1266     3040    4               IF D_TABLE.OUT_CLASS(J) ~= 0 THEN
     1267     3041    4                   THISPX = THISPX - 1;
     1268     3042    4               IF THISPX < BESTPX THEN
     1269     3043    5               DO;
     1270     3044    5                   BESTPX = THISPX;
     1271     3045    5                   PORT_KEY = K;
     1272     3046    5                   PORT = REC_NO;
     1273     3047    5                   END;
     1274     3048    4               END;
     1275     3049    3           END;
     1276     3050
     1277     3051    2       ACCESS_LIST.PORT = PORT;
     1278     3052    2       IF BESTPX > 8 THEN
     1279     3053    2           ACCESS_LIST.PORT_TYPE = %SERIAL_ACCESS;
     1280     3054    3       ELSE DO;
     1281     3055    3           ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;
     1282     3056    3           IF BESTPX > 4 THEN
     1283     3057    3               ACCESS_LIST.PORT_KEY = PORT_KEY;
     1284     3058    3           END;
     1285     3059
     1286     3060    2   END;
     1287     3061         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:39   
     1288     3062    1   OWNER_SET: PROC (SET_NO,OUT_RECNO) ALTRET;
     1289     3063        /*
     1290     3064          DESCRIPTION: This routine finds the index into the subschema tables
     1291     3065                       of the record that owns the set defined by SET_NO.
     1292     3066                       It will altreturn if the record which owns the set
     1293     3067                       is not in the subschema (index=0).
     1294     3068
     1295     3069          IN:
     1296     3070             SET_NO := Index into the subschema tables of the set for which
     1297     3071                       the owner is to be found.
     1298     3072
     1299     3073          OUT:
     1300     3074              OUT_RECNO := Index into the subschema tables of the records that
     1301     3075                           owns the above set.
     1302     3076                                                                              */
     1303     3077    2   DCL SET_NO UBIN;
     1304     3078    2   DCL OUT_RECNO UBIN;
     1305     3079        /**/
     1306     3080    2       DS$=NAM1.DESC$(SET_NO);
     1307     3081    2       OUT_RECNO=SET.OWNER_IDX;
     1308     3082    2       IF OUT_RECNO = 0 THEN
     1309     3083    2           ALTRETURN;
     1310     3084    2       RETURN;
     1311     3085    2   END OWNER_SET;
     1312     3086         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:40   
     1313     3087    1   MEMBER_SET: PROC (SET_NO,SET_MEMBERS) ALTRET;
     1314     3088        /*
     1315     3089          DESCRIPTION: This routine finds the indices of records that are
     1316     3090                       members of the set defined by SET_NO. It will
     1317     3091                       altreturn if the set has no members in this subschema.
     1318     3092
     1319     3093          IN:
     1320     3094             SET_NO       := Index into the subschema tables of the set for
     1321     3095                             which a member or members must be found.
     1322     3096
     1323     3097          OUT:
     1324     3098              SET_MEMBERS := Array of indices into the subschema tables for
     1325     3099                             records which are members of the above set. The
     1326     3100                             zeroth element is the count of members in the
     1327     3101                             array.
     1328     3102                                                                              */
     1329     3103    2   DCL SET_NO UBIN;
     1330     3104        %MEMBER_LIST_DESC(
     1331     3105         NAME=SET_MEMBERS,
     1332     3106         STCLASS=" ");
     1333     3114    2   DCL IDX UBIN;
     1334     3115    2   DCL DRFS$$ PTR;
     1335     3116        /**/
     1336     3117    2       DRFS$$=NAM1.DESC$(SET_NO)->SET.RFS_DSC$;
     1337     3118    2       SET_MEMBERS='0'B;
     1338     3119    2       IDX=1;
     1339     3120    3       DO WHILE (DRFS$$~=ADDR(NIL));
     1340     3121    3           IF DRFS$$->RFS_DSC.OWN_MEM AND IDX <= %MAX_SET_MEMBERS THEN
     1341     3122    4           DO;
     1342     3123    4               SET_MEMBERS.REC_NO(0)=SET_MEMBERS.REC_NO(0)+1;
     1343     3124    4               SET_MEMBERS.REC_NO(IDX)=DRFS$$->RFS_DSC.REC_IDX;
     1344     3125    4               IDX=IDX+1;
     1345     3126    4               END;
     1346     3127    3           DRFS$$=DRFS$$->RFS_DSC.SET$;
     1347     3128    3           END;
     1348     3129    2       IF SET_MEMBERS.REC_NO(0) = 0 THEN
     1349     3130    2           ALTRETURN;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:41   
     1350     3131    2       RETURN;
     1351     3132    2   END MEMBER_SET;
     1352     3133         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:42   
     1353     3134    1   PICK_A_MEMBER: PROC(SET_MEMBERS,BEST_MEMBER,NEXT_VIA_SET);
     1354     3135        /**/
     1355     3136        /*I*
     1356     3137                  NAME:  PICK_A_MEMBER
     1357     3138
     1358     3139               PURPOSE:  PICK_A_MEMBER chooses one record from an array of
     1359     3140                         records which are members of a particular set.
     1360     3141                         The criteria used to choose include whether the
     1361     3142                         record is involved in display, constraint, or the
     1362     3143                         next set in the via list (if one exists). The chosen
     1363     3144                         set will be used to fill a slot in the PATH_LIST by
     1364     3145                         the calling routine.
     1365     3146
     1366     3147                  CALL:  CALL PICK_A_MEMBER(member_list,best_member,next_via_set)
     1367     3148                         where
     1368     3149                               member_list is defined as an instance of the
     1369     3150                               MEMBER_LIST_DESC macro
     1370     3151
     1371     3152                               best_member is a ubin word
     1372     3153
     1373     3154                               next_via_list is a ubin word and may be
     1374     3155                               omitted from the call if none exists.
     1375     3156
     1376     3157                  DATA:  Input:
     1377     3158
     1378     3159                                  SET_MEMBERS
     1379     3160                                  NEXT_VIA_SET
     1380     3161                                  DISPLAY_LIST
     1381     3162
     1382     3163                         Output:
     1383     3164
     1384     3165                                  BEST_MEMBER
     1385     3166
     1386     3167           DESCRIPTION:  PICK_A_MEMBER receives as input: (1) an array called
     1387     3168                         SET_MEMBERS which contains indices into the
     1388     3169                         subschema tables of record types which can be
     1389     3170                         members of a particular set, and (2) NEXT_VIA_SET
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:43   
     1390     3171                         which is the index into the subschema tables of the
     1391     3172                         next set in the VIA list (if one exists). In order
     1392     3173                         to fill an entry in the PATH_LIST, one of these
     1393     3174                         member records must be chosen. In order to do this,
     1394     3175                         a weight is computed and assigned to each member.
     1395     3176                         This weight reflects how important each member is
     1396     3177                         to the display as a whole and to this particular
     1397     3178                         place in the PATH_LIST. The following criteria are
     1398     3179                         used to decide the weight of each record, in order
     1399     3180                         from most important to least important.
     1400     3181
     1401     3182                               Record involved in:
     1402     3183
     1403     3184                               Display  Constraint  Next Set in VIA List
     1404     3185                               -------  ----------  --------------------
     1405     3186
     1406     3187                         1.       Y          Y                Y
     1407     3188                         2.                  Y                Y
     1408     3189                         3.       Y                           Y
     1409     3190                         4.                                   Y
     1410     3191                         5.       Y          Y
     1411     3192                         6.                  Y
     1412     3193                         7.       Y
     1413     3194
     1414     3195                         The first record in the list with the highest
     1415     3196                         weight will be chosen. If no records fit the
     1416     3197                         above criteria, the first record in the list will
     1417     3198                         be chosen. The record chosen is placed in
     1418     3199                         the output variable BEST_MEMBER.
     1419     3200        */
     1420     3201         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:44   
     1421     3202        %MEMBER_LIST_DESC(
     1422     3203         NAME=SET_MEMBERS,
     1423     3204         STCLASS=" ");
     1424     3212    2   DCL BEST_MEMBER UBIN;
     1425     3213    2   DCL NEXT_VIA_SET UBIN;
     1426     3214    2   DCL NEXT_VIA_OWNER UBIN;
     1427     3215        %MEMBER_LIST_DESC(
     1428     3216         NAME=NEXT_VIA_MEMBERS,
     1429     3217         STCLASS=" ");
     1430     3225    2   DCL NEXT_VIA_SET_EXISTS BIT(1) ALIGNED;
     1431     3226    2   DCL PRIO UBIN;
     1432     3227    2   DCL I UBIN;
     1433     3228    2   DCL J UBIN;
     1434     3229
     1435     3230
     1436     3231    3       IF ADDR(NEXT_VIA_SET)=ADDR(NIL) THEN DO;
     1437     3232    3   END_VIA_LIST:;
     1438     3233    3           NEXT_VIA_SET_EXISTS='0'B;
     1439     3234    3           END;
     1440     3235    3       ELSE DO;
     1441     3236    3           NEXT_VIA_SET_EXISTS='1'B;
     1442     3237    3           CALL OWNER_SET(NEXT_VIA_SET,NEXT_VIA_OWNER) ALTRET(END_VIA_LIST);
     1443     3238    3           CALL MEMBER_SET(NEXT_VIA_SET,NEXT_VIA_MEMBERS) ALTRET(END_VIA_LIST);
     1444     3239    3           END;
     1445     3240
     1446     3241    3       DO I = 1 TO SET_MEMBERS.REC_NO(0);
     1447     3242    3   FIND_MEMBER:
     1448     3243    4           DO J = 1 TO DISPLAY_LIST.REC_NO(0);
     1449     3244    4               IF SET_MEMBERS.REC_NO(I) = DISPLAY_LIST.REC_NO(J) THEN
     1450     3245    5               DO;
     1451     3246    5                   SET_MEMBERS.PRIORITY(I) = DISPLAY_LIST.IND.DISPLAY(J) +
     1452     3247    5                      DISPLAY_LIST.IND.CONSTRAINT(J)*2;
     1453     3248    5                   EXIT FIND_MEMBER;
     1454     3249    5                   END;
     1455     3250    4               END;
     1456     3251    3   VIA_SET_CHECK:;
     1457     3252    3           IF NEXT_VIA_SET_EXISTS THEN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:45   
     1458     3253    4           DO;
     1459     3254    4               IF SET_MEMBERS.REC_NO(I) = NEXT_VIA_OWNER THEN
     1460     3255    4                   SET_MEMBERS.PRIORITY(I) = SET_MEMBERS.PRIORITY(I) + 10;
     1461     3256    5               ELSE DO J = 1 TO NEXT_VIA_MEMBERS.REC_NO(0);
     1462     3257    5                   IF SET_MEMBERS.REC_NO(I) = NEXT_VIA_MEMBERS.REC_NO(J) THEN
     1463     3258    5                       SET_MEMBERS.PRIORITY(I) = SET_MEMBERS.PRIORITY(I) + 10;
     1464     3259    5                   END;
     1465     3260    4               END;
     1466     3261    3           END;
     1467     3262
     1468     3263    2       BEST_MEMBER = SET_MEMBERS.REC_NO(1);
     1469     3264    2       PRIO = 0;
     1470     3265    3       DO I = 1 TO SET_MEMBERS.REC_NO(0);
     1471     3266    3           IF SET_MEMBERS.PRIORITY(I) > PRIO THEN
     1472     3267    4           DO;
     1473     3268    4               BEST_MEMBER = SET_MEMBERS.REC_NO(I);
     1474     3269    4               PRIO = SET_MEMBERS.PRIORITY(I);
     1475     3270    4               END;
     1476     3271    3           END;
     1477     3272
     1478     3273    2       RETURN;
     1479     3274
     1480     3275    2   END PICK_A_MEMBER;
     1481     3276         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:46   
     1482     3277         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:47   
     1483     3278    1   NOT_TBL: PROC (IN_TBL1,IN_TBL2);
     1484     3279        /*
     1485     3280          DESCRIPTION: This Proc compares two lists and performs the
     1486     3281                       following function:   IN_TBL1=IN_TBL1~IN_TBL2     .
     1487     3282
     1488     3283          IN:
     1489     3284             IN_TBL1 := List of indices of records in the subschema tables.
     1490     3285             IN_TBL2 := Similar to IN_TBL1.
     1491     3286
     1492     3287          OUT:
     1493     3288              IN_TBL1 := Same list as IN_TBL1 but without elements contained in IN_TBL2.
     1494     3289                                                                              */
     1495     3290    2   DCL IN_TBL1 (0:0) UBIN;
     1496     3291    2   DCL IN_TBL2 (0:0) UBIN;
     1497     3292    2   DCL I UBIN AUTO;
     1498     3293    2   DCL J UBIN AUTO;
     1499     3294    2   DCL ZER_FLG UBIN AUTO;
     1500     3295        /**/
     1501     3296    2       IF IN_TBL2(0)=0 THEN
     1502     3297    2           RETURN;
     1503     3298    2       I=1;
     1504     3299    3       DO WHILE (I<=IN_TBL1(0));
     1505     3300    3           J=1;
     1506     3301    4           DO WHILE (J<=IN_TBL2(0));
     1507     3302    4               IF IN_TBL1(I)=IN_TBL2(J) THEN
     1508     3303    4                   IN_TBL1(I)=0;
     1509     3304    4               J=J+1;
     1510     3305    4               END;
     1511     3306    3           I=I+1;
     1512     3307    3           END;
     1513     3308    2       J=1;
     1514     3309    2       I=1;
     1515     3310    3       DO WHILE (I<=IN_TBL1(0));
     1516     3311    3           IF IN_TBL1(I)~=0 THEN
     1517     3312    4           DO;
     1518     3313    5               DO;
     1519     3314    5                   IN_TBL1(J)=IN_TBL1(I);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:48   
     1520     3315    5                   IF I~=J THEN
     1521     3316    5                       IN_TBL1(I)=0;
     1522     3317    5                   J=J+1;
     1523     3318    5                   END;
     1524     3319    4               END;
     1525     3320    3           I=I+1;
     1526     3321    3           END;
     1527     3322    2       CALL EMPTY_TBL(IN_TBL1,ZER_FLG);
     1528     3323    2       IF ZER_FLG=1 THEN
     1529     3324    2           IN_TBL1(0)=J-1;
     1530     3325    2       ELSE
     1531     3326    2           IN_TBL1(0)=0;
     1532     3327    2       RETURN;
     1533     3328    2   END NOT_TBL;
     1534     3329         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:49   
     1535     3330    1   UNION_MAT: PROC (IN_TBL1,IN_TBL2);
     1536     3331        /*
     1537     3332          DESCRIPTION: This Proc takes two lists as input and performs the
     1538     3333                       following function:   IN_TBL1=IN_TBL1 (concatenated with) IN_TBL2  .
     1539     3334
     1540     3335          IN:
     1541     3336             IN_TBL1 := List of indices of records in the subschema tables.
     1542     3337             IN_TBL2 := List of record indices into the subschema tables.
     1543     3338
     1544     3339          OUT:
     1545     3340              IN_TBL1 := Same as above but concatenated with IN_TBL2.
     1546     3341                                                                              */
     1547     3342    2   DCL IN_TBL2 (0:0) UBIN;
     1548     3343    2   DCL IN_TBL1 (0:0) UBIN;
     1549     3344    2   DCL I UBIN AUTO;
     1550     3345    2   DCL J UBIN AUTO;
     1551     3346        /**/
     1552     3347        %D_DESC;
     1553     3356        %D2_DESC;
     1554     3363        %TBL_DIM_DESC;
     1555     3368        /**/
     1556     3369    2       I=IN_TBL1(0)+1;
     1557     3370    2       J=1;
     1558     3371    3       DO WHILE (J<=IN_TBL2(0));
     1559     3372    3           IN_TBL1(I)=IN_TBL2(J);
     1560     3373    3           J=J+1;
     1561     3374    3           I=I+1;
     1562     3375    3           IN_TBL1(0)=IN_TBL1(0)+1;
     1563     3376    3           END;
     1564     3377    2       RETURN;
     1565     3378    2   END UNION_MAT;
     1566     3379         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:50   
     1567     3380    1   NOT_PATHPT: PROC (PATH_LIST,IN_PT);
     1568     3381        /*
     1569     3382        DESCRIPTION: This proc takes the PATH_LIST and IN_PT as input and
     1570     3383                     performs the following function:
     1571     3384                                        PATH_LIST=PATH_LIST ~ IN_PT   .
     1572     3385
     1573     3386          IN:
     1574     3387             PATH_LIST := structure defined in ZI$PATH_STRUCTS containing
     1575     3388                          information about retrieval.
     1576     3389             IN_PT := single index of a record index into the subschema tables
     1577     3390
     1578     3391          OUT:
     1579     3392              PATH_LIST := Same as above exept all occurrences with the
     1580     3393                           same REC_NO as IN_PT are removed.
     1581     3394                                                                              */
     1582     3395    2   DCL IN_PT UBIN(18);
     1583     3396    2   DCL ZER_FLG UBIN AUTO;
     1584     3397    2   DCL I UBIN AUTO;
     1585     3398    2   DCL J UBIN AUTO;
     1586     3399        /**/
     1587     3400        %PATH_DESC (STCLASS=" ");
     1588     3440        /**/
     1589     3441    3       DO;
     1590     3442    3           I=1;
     1591     3443    4           DO WHILE (I<=REC_NO);
     1592     3444    4               IF PATH_LIST.REC_NO(I)=IN_PT THEN
     1593     3445    5               DO;
     1594     3446    5                   PATH_LIST.REC_NO(I)=0;
     1595     3447    5                   I=REC_NO;
     1596     3448    5                   END;
     1597     3449    4               I=I+1;
     1598     3450    4               END;
     1599     3451    3           I=1;
     1600     3452    3           J=1;
     1601     3453    4           DO WHILE (I<=REC_NO);
     1602     3454    4               IF PATH_LIST.REC_NO(I)~=0 THEN
     1603     3455    5               DO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:51   
     1604     3456    5                   PATH_LIST.REC_NO(J)=PATH_LIST.REC_NO(I);
     1605     3457    5                   PATH_LIST.SET_NO(J)=PATH_LIST.SET_NO(I);
     1606     3458    5                   PATH_LIST.OWN_NEXT(J)=PATH_LIST.OWN_NEXT(I);
     1607     3459    5                   PATH_LIST.GET_IND(J)=PATH_LIST.GET_IND(I);
     1608     3460    5                   PATH_LIST.FIND_ATTEMPTED(J)=PATH_LIST.FIND_ATTEMPTED(I);
     1609     3461    5                   PATH_LIST.DISPLAY_IND(J)=PATH_LIST.DISPLAY_IND(I);
     1610     3462    5                   PATH_LIST.INIT_EPTR(J)=PATH_LIST.INIT_EPTR(I);
     1611     3463    5                   PATH_LIST.CONVERT_EPTR(J)=PATH_LIST.CONVERT_EPTR(I);
     1612     3464    5                   PATH_LIST.CONSTRAINT_EPTR(J)=PATH_LIST.CONSTRAINT_EPTR(I);
     1613     3465    5                   J=J+1;
     1614     3466    5                   END;
     1615     3467    4               I=I+1;
     1616     3468    4               END;
     1617     3469    3           CALL EMPTY_PATHTBL(PATH_LIST,ZER_FLG);
     1618     3470    3           IF ZER_FLG=1 THEN
     1619     3471    3               REC_NO=J-1;
     1620     3472    3           ELSE
     1621     3473    3               REC_NO=0;
     1622     3474    3           PATH_LIST.REC_NO(0)=REC_NO;
     1623     3475    3           RETURN;
     1624     3476    3           END;
     1625     3477         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:52   
     1626     3478    2   EMPTY_PATHTBL: PROC (PATH_LIST,OUT_FLG);
     1627     3479        /*
     1628     3480          DESCRIPTION: This Proc determines if the PATH_LIST is null after
     1629     3481                       extractions are made from it.
     1630     3482
     1631     3483          IN:
     1632     3484             PATH_LIST := same as above.
     1633     3485             OUT_FLG := Indicator for null condition: 0 = List is null,
     1634     3486                                                      1 = List is not null.
     1635     3487                                                                              */
     1636     3488    3   DCL OUT_FLG UBIN;
     1637     3489    3   DCL N UBIN AUTO;
     1638     3490    3   DCL K UBIN AUTO;
     1639     3491        /**/
     1640     3492        %PATH_DESC (STCLASS=" ");
     1641     3532        /**/
     1642     3533    3       OUT_FLG=0;
     1643     3534    3       N=1;
     1644     3535    4       DO WHILE (N<=REC_NO);
     1645     3536    4           IF PATH_LIST.REC_NO(N)~=0 THEN
     1646     3537    5           DO;
     1647     3538    5               OUT_FLG=1;
     1648     3539    5               RETURN;
     1649     3540    5               END;
     1650     3541    4           N=N+1;
     1651     3542    4           END;
     1652     3543    3       RETURN;
     1653     3544    3   END EMPTY_PATHTBL;
     1654     3545    2   END NOT_PATHPT;
     1655     3546         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:53   
     1656     3547    1   NOT_PATHTBL: PROC (TDISPLAY_LIST,PATH_LIST);
     1657     3548        /*
     1658     3549          DESCRIPTION: This Proc extracts all occurrences of TDISPLAY_LIST
     1659     3550                       that correspond with PATH_LIST.REC_NOs. This routine is
     1660     3551                       used to eliminate from TDISPLAY_LIST all records that
     1661     3552                       have been covered so far by the Path. When the
     1662     3553                       TDISPLAY_LIST becomes null, processing in the Topology
     1663     3554                       module is complete.
     1664     3555
     1665     3556          IN:
     1666     3557             TDISPLAY_LIST := List of record indices into the subschema
     1667     3558                              tables.
     1668     3559             PATH_LIST := Structure defined in ZI$PATH_STRUCTS which contains
     1669     3560                          all information for retrieval.
     1670     3561
     1671     3562          OUT:
     1672     3563              TDISPLAY_LIST := same as above but all occurrences that
     1673     3564                               correspond to REC_NO in PATH_LIST are
     1674     3565                               eliminated.
     1675     3566                                                                              */
     1676     3567    2   DCL I UBIN AUTO;
     1677     3568    2   DCL J UBIN AUTO;
     1678     3569    2   DCL ZER_FLG UBIN AUTO;
     1679     3570        /**/
     1680     3571        %PATH_DESC (STCLASS=" ");
     1681     3611    2   DCL TDISPLAY_LIST(0:0) UBIN;
     1682     3612        /**/
     1683     3613    2       IF REC_NO=0 THEN
     1684     3614    2           RETURN;
     1685     3615    2       I=1;
     1686     3616    3       DO WHILE (I<=TDISPLAY_LIST#);
     1687     3617    3           J=1;
     1688     3618    4           DO WHILE (J<=REC_NO);
     1689     3619    5               IF TDISPLAY_LIST(I)=PATH_LIST.REC_NO(J) THEN DO;
     1690     3620    5                   TDISPLAY_LIST(I)=0;
     1691     3621    5                   J = REC_NO;
     1692     3622    5                   END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:54   
     1693     3623    4               J=J+1;
     1694     3624    4               END;
     1695     3625    3           I=I+1;
     1696     3626    3           END;
     1697     3627    2       J=1;
     1698     3628    3       DO I = 1 TO TDISPLAY_LIST#;
     1699     3629    3           IF TDISPLAY_LIST(I)~=0 THEN
     1700     3630    4           DO;
     1701     3631    5               IF I~=J THEN DO;
     1702     3632    5                   TDISPLAY_LIST(J)=TDISPLAY_LIST(I);
     1703     3633    5                   TDISPLAY_LIST(I)=0;
     1704     3634    5                   END;
     1705     3635    4               J=J+1;
     1706     3636    4               END;
     1707     3637    3           END;
     1708     3638    2       CALL EMPTY_TBL(TDISPLAY_LIST,ZER_FLG);
     1709     3639    2       IF ZER_FLG=1 THEN
     1710     3640    2           TDISPLAY_LIST# = J-1;
     1711     3641    2       ELSE
     1712     3642    2           TDISPLAY_LIST# = 0;
     1713     3643    2       TDISPLAY_LIST(0) = TDISPLAY_LIST#;
     1714     3644    2       RETURN;
     1715     3645    2   END NOT_PATHTBL;
     1716     3646        %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:55   
     1717     3647    1   SET_DISPLAY_IND: PROC;
     1718     3648    2   DCL J UBIN WORD;
     1719     3649        /**/
     1720     3650    3       DO J=1 TO DISPLAY_LIST#;
     1721     3651    3           IF DISPLAY_LIST.REC_NO(J) = PATH_LIST.REC_NO(REC_NO)
     1722     3652    3              AND DISPLAY_LIST.IND.DISPLAY(J) = 1 THEN
     1723     3653    4           DO;
     1724     3654    4               PATH_LIST.DISPLAY_IND(REC_NO)='1'B;
     1725     3655    4               J=DISPLAY_LIST#+1;
     1726     3656    4               END;
     1727     3657    3           END;
     1728     3658    2       RETURN;
     1729     3659    2   END SET_DISPLAY_IND;
     1730     3660         /* .................Comment out the unused code..............................
     1731     3661         %EJECT;
     1732     3662         ELIMINATE_SETS: PROC;
     1733     3663         DCL J UBIN WORD;
     1734     3664         DCL K UBIN WORD;
     1735     3665
     1736     3666            N=1;
     1737     3667            DO J=1 TO REC_NO;
     1738     3668            DO K=1 TO VIA_LIST(0);
     1739     3669            IF PATH_LIST.SET_NO(J)=VIA_LIST(K) THEN
     1740     3670            N=N+1;
     1741     3671            END;
     1742     3672            END;
     1743     3673            RETURN;
     1744     3674            END ELIMINATE_SETS;
     1745     3675         ...........................................................................*/
     1746     3676    1   END ZII$TOPOLOGY;
     1747     3677        %EOD;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:56   
--  Include file information  --

   ZI_IDPERR_SUBS.:ZIC0TOU  is referenced.
   ZI$PATH_STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$TOPOLOGY.

   Procedure ZII$TOPOLOGY requires 2556 words for executable code.
   Procedure ZII$TOPOLOGY requires 138 words of local(AUTO) storage.

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:57   

 Object Unit name= ZII$TOPOLOGY                               File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:32:34.92 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ZII$COMMON$
    1  RoData even  UTS     18     22  ZII$TOPOLOGY
    2   Data  even  none   430    656  ZII$TOPOLOGY
    3  LblCom even  none     1      1  MEMORY_FRAME
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$DO
    6   DCB   even  none     0      0  M$UC
    7  RtLbCm even  none     1      1  D_TBL$
    8  RtLbCm even  none     1      1  D2_TBL$
    9  RtLbCm even  none     1      1  TBL_DIM
   10  LblCom even  none     1      1  NAM1$
   11  LblCom even  none     1      1  NAM1_SIZ
   12  LblCom even  none     1      1  NAM1_IDX
   13  LblCom even  none     1      1  NAM2$
   14  LblCom even  none     1      1  NAM2_SIZ
   15  LblCom even  none     1      1  DESC#
   16  LblCom even  none     1      1  DA$
   17  LblCom even  none     1      1  DR$
   18  LblCom even  none     1      1  DS$
   19  LblCom even  none     1      1  DRFS$
   20  LblCom even  none     1      1  DD$
   21  LblCom even  none     1      1  DF$
   22  LblCom even  none     1      1  DRFK$
   23  LblCom even  none     1      1  D_TBL$
   24  LblCom even  none     1      1  D2_TBL$
   25  LblCom even  none     1      1  TBL_DIM
   26   Proc  even  none  2556   4774  ZII$TOPOLOGY
   27  RoData even  none    25     31  ZII$TOPOLOGY
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:58   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    26      0   yes    yes     yes      Std        7  ZII$TOPOLOGY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 ZII$COMMON_MEMORY
 yes     yes           Std       2 ZII$PATH_MEMORY
         yes           Std       2 ZII$FIND_IDX
 yes     yes           Std       3 ZII$PRINT_PATH
 yes     yes           Std       2 ZII$PATH_MEMORY
         yes           Std       3 ZII$FIND_D2_IDX
         yes           Std       3 ZII$FIND_D2_IDX
         yes           Std       2 ZII$FIND_IDX
         yes           Std       2 ZII$FIND_IDX
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$LO                                  M$DO                                  M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:59   


        1        1        /*M* ZII$TOPOLOGY Analyzes subschema for best path for retrieval.          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P* NAME:       ZII$TOPOLOGY
        8        8
        9        9             PURPOSE:     This routine is the module called by IDP to define
       10       10                          a valid path to navigate through a database using
       11       11                          information contained in the path, which is used to perform
       12       12                          legal DBCS calls to retrieve information requested in the
       13       13                          IDP DISPLAY command.
       14       14
       15       15             DESCRIPTION: IDP passes command information
       16       16                          to the Topology module describing the Display,
       17       17                          Constraint, Via, and Port items (which are in the
       18       18                          form of indices into the Subschema Tables, built
       19       19                          by the ZII$BUILD_TABLES module). If the Port was
       20       20                          zero, then Topology proceeds to make its own port
       21       21                          selection based on Display and Constraint info, else
       22       22                          Topology uses the User-supplied values for Port
       23       23                          record and selection type (Direct, Calc, Serial,
       24       24                          etc.). Topology then proceeds to use Via list info
       25       25                          to decide on a direction to take from the Port.
       26       26                          If no Via information was given, Topology takes
       27       27                          what it believes is the shortest path to records
       28       28                          containing required data items which are farthest
       29       29                          away from the port and following sets back to the
       30       30                          Port record, taking into account all data items
       31       31                          satisfied on the trip back. If there are still data
       32       32                          items left unsatisfied, then a lambda condition
       33       33                          exists and another branch from the Port is followed
       34       34                          from farthest data item to the Port as before.
       35       35                          Branches are built as required until all data items
       36       36                          are found to be in the Path.                        */
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:60   
       37       37        /*D* NAME:       ZII$TOPOLOGY
       38       38
       39       39             CALL:        Called by IDP.
       40       40
       41       41             INPUT:      DISPLAY_LIST,CONSTRAINT_LIST,ACCESS_LIST,VIA_LIST,TOPOLOGY_OPTIONS
       42       42
       43       43             OUTPUT:      PATH$_P,STATUS_CODE
       44       44
       45       45             DESCRIPTION: ZII$TOPOLOGY should be invoked by a driver routine
       46       46                          (such as IDP) which has previously called the
       47       47                          ZII$BUILD_TABLES routine in :LIB_IDSINT. Calling
       48       48                          these modules in this order is essential to correct
       49       49                          operation of ZII$TOPOLOGY since ZII$TOPOLOGY needs
       50       50                          tables built by ZII$BUILD_TABLES. Also, take care
       51       51                          NOT TO USE THE COMMON SEGMENT with the driver routine
       52       52                          since doing so will wipe out these tables.
       53       53
       54       54                              ZII$TOPOLOGY starts processing by allocating
       55       55                          space (also in the Common segment) for ten (10)
       56       56                          occurrences of the PATH_LIST. Then, if a Port
       57       57                          record has not been supplied by the driver routine,
       58       58                          SELECT_PORT is called to choose one. All
       59       59                          information about the new Port record needed
       60       60                          by ZII$TOPOLOGY and ZII$RETRIEVE is placed into
       61       61                          ACCESS_LIST.
       62       62
       63       63                              Next, COMP_DIST is called. This routine is used
       64       64                          to compute the distances of each record in the
       65       65                          subschema from the port record. These distances are
       66       66                          placed into the global structure D_TABLE.
       67       67
       68       68                              The next section takes the DISPLAY_ and
       69       69                          CONSTRAINT_ lists, which are lists of indices
       70       70                          to items in records, and builds a temporary
       71       71                          TDISPLAY_LIST, which is actually a list of the
       72       72                          associated records that own each of the items
       73       73                          listed in the DISPLAY_ and CONSTRAINT_ lists
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:61   
       74       74                          (TDISPLAY_LIST contains the list of all records
       75       75                          actually involved in the search for a path).
       76       76
       77       77                              Now the path search begins. If a VIA_LIST
       78       78                          was not null (i.e. VIA_LIST(0)~=0)) then the
       79       79                          Topology module must direct the search in the
       80       80                          direction of the first VIA_LIST entry. In order
       81       81                          to build an initial partial path towards the first
       82       82                          VIA_LIST entry, calls to OWNER_SET and MEMBER_SET
       83       83                          are made. As their names imply(?) these two internal
       84       84                          procs find a record who is owner and a record who is
       85       85                          a member of the VIA_LIST entry. Then a choice is
       86       86                          made on which record, either the owner record or
       87       87                          the member record of the set, is to be used as the
       88       88                          target of the first partial path with the criterion
       89       89                          being the closest record to the Port record is to
       90       90                          be used. Then this procedure is used until all
       91       91                          record indices in the TDISPLAY_LIST are involved in
       92       92                          the Path. If, when all records involved in the
       93       93                          search are involved in the Path, some VIA_LIST
       94       94                          entries are NOT involved in the Path, then an
       95       95                          error code is returned.
       96       96
       97       97                              If the VIA_LIST is null, then the following
       98       98                          strategy is taken:
       99       99                              Since no "direction" was given by way of
      100      100                          VIA_LIST information, the Topology module
      101      101                          finds the record (or one of the records) whose
      102      102                          distance from the Port record is the farthest
      103      103                          (if there is more than one record involved in
      104      104                          the search with the same current maximum
      105      105                          distance from the port, then logically those
      106      106                          records do not lie on the same path branch
      107      107                          and will be included in the next path iteration
      108      108                          since they are maximum distances. One special
      109      109                          case arises: when more than one record which
      110      110                          are members of the same set and are specified
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:62   
      111      111                          in the TDISPLAY_LIST. A special test for this
      112      112                          case is used to resolve the problem and both
      113      113                          (or all) members specified in the TDISPLAY_LIST
      114      114                          are included in the Path.). Once a record is
      115      115                          deemed as being "farthest" from the Port record,
      116      116                          a partial path is computed (as in the case of
      117      117                          appearing VIA_LIST entries) with a call to
      118      118                          BACK_TRACK, which starts at the record cited
      119      119                          as the farthest from the Port and includes
      120      120                          sets and records to reach the Port record.
      121      121                          Any other records cited in the TDISPLAY_LIST
      122      122                          that are now involved in the partial path
      123      123                          are extracted from the TDISPLAY_LIST. This
      124      124                          iteration is followed until the TDISPLAY_LIST
      125      125                          is exhausted.
      126      126                              Then, when the last partial path is added to
      127      127                          the total computed path, the path is compressed
      128      128                          to eliminate all non-essential redundant
      129      129                          occurrences of record indices (e.g. an
      130      130                          essential redundant occurrence is one whose
      131      131                          record happens to be an owner of a lambda
      132      132                          structure, in which case it is redundant
      133      133                          because: (1) it tells ZII$RETRIEVE that this
      134      134                          is the beginning of a new branch of a lambda
      135      135                          structure, and (2) it contains the index of
      136      136                          the new set index to follow for this branch
      137      137                          of this lambda structure.)
      138      138                              As the total Path, or PATH_LIST, expands,
      139      139                          calls to ZII$PATH_MEMORY are made as needed
      140      140                          which enlarge the Common segment by ten (10)
      141      141                          Path occurrences (30 words).
      142      142                         Once the PATH_LIST has been compressed, the
      143      143                          Topology Analysis for this query is complete and
      144      144                          control is passed to the calling routine.           */
      145      145        ZII$TOPOLOGY: PROC (DISPLAY_LIST,CANDIDATE_LIST,ACCESS_LIST,

    145 26 000000   000000 700200 xent  ZII$TOPOLOGY TSX0  ! X66_AUTO_N
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:63   
        26 000001   000212 000007                    ZERO    138,7

      146      146               VIA_LIST,PATH$_P,TOPOLOGY_OPTIONS,STATUS_CODE) ALTRET;
      147      147    1   DCL ZII$COMMON$ PTR EXT;
      148      148    1   DCL 1 COMMON_REDEF REDEF ZII$COMMON$,
      149      149    1         2 WORD_OFFSET UBIN HALF HALIGNED,
      150      150    1         2 * UBIN HALF HALIGNED;
      151      151    1   DCL TDISPLAY_LIST (0:0) UBIN BASED(ZII$COMMON$) ALIGNED;
      152      152    1   DCL DISPLAY_LIST# UBIN;
      153      153    1   DCL TDISPLAY_LIST# UBIN;
      154      154    1   DCL PATH$_P PTR;
      155      155    1   DCL PATH$ PTR;
      156      156    1   DCL REC_NO UBIN;
      157      157    1   DCL MEMORY_NEEDED UBIN AUTO;
      158      158    1   DCL ELE_FLG UBIN AUTO;
      159      159    1   DCL ILLEGAL_SETS_INCLUDED UBIN AUTO;
      160      160    1   DCL STATUS_CODE UBIN(36);
      161      161    1   DCL OWNER_REC UBIN AUTO;
      162      162    1   DCL MEMBER_REC UBIN AUTO;
      163      163    1   DCL T_DIST UBIN AUTO;
      164      164    1   DCL MEMBER_OF_LIST UBIN AUTO;
      165      165    1   DCL MEM_FLG UBIN AUTO;
      166      166    1   DCL ZER_FLG UBIN AUTO;
      167      167    1   DCL 1 VIA_ERROR CONSTANT,
      168      168    1         2 * CHAR(0) INIT(
               168                 ' Warning: Disconnected VIA list. The following sets might not be used:');
      169      169    1   DCL 1 ERR_LINE STATIC,
      170      170    1         2 * CHAR(4) INIT('    '),
      171      171    1         2 SET_FD CHAR(32);
      172      172    1   DCL LAMBDA_REC# UBIN AUTO;
      173      173    1   DCL 1 LAMBDA_RECS(0:20) ALIGNED,
      174      174    1         2 REC_NO UBIN HALF HALIGNED,
      175      175    1         2 PATH_LIST_IDX UBIN HALF HALIGNED;
      176      176    1   DCL TEMP_PORT_PATH_IDX UBIN AUTO;
      177      177    1   DCL IDX UBIN AUTO;
      178      178    1   DCL BLNK_LINE CHAR(4) INIT('    ') STATIC;
      179      179    1   DCL N UBIN AUTO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:64   
      180      180    1   DCL I UBIN;
      181      181    1   DCL J UBIN AUTO;
      182      182    1   DCL K UBIN AUTO;
      183      183    1   DCL START_NODE UBIN AUTO;
      184      184    1   DCL CURRENT_NODE UBIN AUTO;
      185      185    1   DCL TEMP_PORT UBIN AUTO;
      186      186    1   DCL TEMP_ARG UBIN AUTO;
      187      187    1   DCL MEMORY_FRAME UBIN(36) EXT;
      188      188    1   DCL M$LO DCB;
      189      189    1   DCL M$DO DCB;
      190      190        %EQU GET = 1;
      191      191        %EQU RLSE = 0;
      192      192    1   DCL DID_I BIT(1) ALIGNED;
      193      193        /**/
      194      194    1   DCL ZII$FIND_IDX ENTRY(2);
      195      195    1   DCL ZII$PATH_MEMORY ENTRY(2) ALTRET;
      196      196    1   DCL ZII$COMMON_MEMORY ENTRY(2) ALTRET;
      197      197    1   DCL ZII$PRINT_PATH ENTRY(3) ALTRET;
      198      198        /**/
      199      199        %INCLUDE CP_6;
      200      280        %INCLUDE ZI$TOP_STRUCTS;
      201      341        %D_DESC (STCLASS="EXTROOT");
      202      350        %D2_DESC (STCLASS="EXTROOT");
      203      357        %TBL_DIM_DESC (STCLASS="EXTROOT");
      204      362        %MEMBER_LIST_DESC(
      205      363         NAME=MEMBER_LIST,
      206      364         STCLASS=AUTO);
      207      372        %INCLUDE ZI$STRUCTS;
      208      444        %NAM1;
      209      473        %NAM2;
      210      487        %INCLUDE ZI$DESC;
      211     1337        %DSC_AREA;
      212     1359        %DSC_REC;
      213     1393        %DSC_SET;
      214     1435        %DSC_RFS;
      215     1480        %DSC_DESC;
      216     1488        %DSC_FLD;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:65   
      217     1603        %INCLUDE ZI$PATH_STRUCTS;
      218     1741        %DISPLAY_DESC (STCLASS=" ");
      219     1752        %CANDIDATE_DESC (STCLASS=" ");
      220     1764        %VIA_DESC (STCLASS=" ");
      221     1769        %PATH_DESC (STCLASS="BASED(PATH$)");
      222     1809        %ACCESS_DESC (STCLASS=" ");
      223     1848        %TOPOLOGY_OPTIONS_DESC (STCLASS=" ");
      224     1854        %INCLUDE ZI_IDPERR_SUBS;
      225     1888        %VLP_VECTOR (FPTN=DUMMY_VECTOR);
      226     1903        /**/
      227     1904        %FPT_WRITE(FPTN=ERR_OUT,BUF=VIA_ERROR,DCB=M$LO);
      228     1935        %FPT_CORRES(FPTN=LO_DO,DCB1=M$LO,DCB2=M$DO);
      229     1949        /**/
      230     1950
      231     1951        /*
      232     1952          To ensure that the memory used to build tables is zeroed first,
      233     1953          scoot ZII$COMMON$ past the last group of topology tables built.
      234     1954          (In case this is the 2nd or greater display in a query.)
      235     1955        */
      236     1956    1       MEMORY_NEEDED = MEMORY_FRAME - COMMON_REDEF.WORD_OFFSET;

   1956 26 000002   000000 235000 0                  LDA     ZII$COMMON$
        26 000003   000022 771000                    ARL     18
        26 000004   200206 755100                    STA     DRFS$$+2,,AUTO
        26 000005   000000 236000 3                  LDQ     MEMORY_FRAME
        26 000006   200206 136100                    SBLQ    DRFS$$+2,,AUTO
        26 000007   200016 756100                    STQ     MEMORY_NEEDED,,AUTO

      237     1957    1       IF MEMORY_NEEDED > 0 THEN

   1957 26 000010   000014 600000 26                 TZE     s:1967

      238     1958    1           ZII$COMMON$ = PINCRW(ZII$COMMON$,MEMORY_NEEDED);

   1958 26 000011   000022 736000                    QLS     18
        26 000012   000000 036000 0                  ADLQ    ZII$COMMON$
        26 000013   000000 756000 0                  STQ     ZII$COMMON$
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:66   

      239     1959
      240     1960        /*
      241     1961          Now build the temporary list TDISPLAY_LIST from DISPLAY_LIST
      242     1962          and CONSTRAINT_LIST. TDISPLAY_LIST will contain all record
      243     1963          indices into the subschema tables built by ZII$BUILD_TABLES.
      244     1964          These record indices are only for records containing data items
      245     1965          involved in either the DISPLAY_ or CONSTRAINT_ lists.
      246     1966                                                                              */
      247     1967    1       MEMORY_NEEDED=DISPLAY_LIST.REC_NO(0)+1;

   1967 26 000014   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 000015   000000 236100                    LDQ     0,,PR0
        26 000016   777777 376007                    ANQ     -1,DL
        26 000017   000001 036007                    ADLQ    1,DL
        26 000020   200016 756100                    STQ     MEMORY_NEEDED,,AUTO

      248     1968    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,DUMMY_VECTOR) ALTRET(ER_COMMON);

   1968 26 000021   000001 236000 27                 LDQ     1
        26 000022   200207 756100                    STQ     DRFS$$+3,,AUTO
        26 000023   200016 631500                    EPPR1   MEMORY_NEEDED,,AUTO
        26 000024   200206 451500                    STP1    DRFS$$+2,,AUTO
        26 000025   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 000026   000000 631400 27                 EPPR1   0
        26 000027   000000 701000 xent               TSX1    ZII$COMMON_MEMORY
        26 000030   001243 702000 26                 TSX2    ER_COMMON

      249     1969    1       DISPLAY_LIST# = DISPLAY_LIST.REC_NO(0);

   1969 26 000031   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 000032   000000 236100                    LDQ     0,,PR0
        26 000033   777777 376007                    ANQ     -1,DL
        26 000034   200012 756100                    STQ     DISPLAY_LIST#,,AUTO

      250     1970    1       TDISPLAY_LIST# = DISPLAY_LIST#;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:67   
   1970 26 000035   200013 756100                    STQ     TDISPLAY_LIST#,,AUTO

      251     1971    2       DO N = 0 TO DISPLAY_LIST#;

   1971 26 000036   200057 450100                    STZ     N,,AUTO
        26 000037   000051 710000 26                 TRA     s:1973+3

      252     1972    2           TDISPLAY_LIST(N) = DISPLAY_LIST.REC_NO(N);

   1972 26 000040   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 000041   200057 720100                    LXL0    N,,AUTO
        26 000042   000000 236110                    LDQ     0,X0,PR0
        26 000043   777777 376007                    ANQ     -1,DL
        26 000044   000000 471400 0                  LDP1    ZII$COMMON$
        26 000045   100000 756110                    STQ     0,X0,PR1

      253     1973    2           END;

   1973 26 000046   200057 235100                    LDA     N,,AUTO
        26 000047   000001 035007                    ADLA    1,DL
        26 000050   200057 755100                    STA     N,,AUTO
        26 000051   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 000052   200057 116100                    CMPQ    N,,AUTO
        26 000053   000040 603000 26                 TRC     s:1972

      254     1974
      255     1975        /*
      256     1976          Select a Port record if needed.
      257     1977                                                                              */
      258     1978    1       IF ACCESS_LIST.PORT=0 THEN

   1978 26 000054   200005 471500                    LDP1    @ACCESS_LIST,,AUTO
        26 000055   100000 220100                    LDX0    0,,PR1
        26 000056   000071 601000 26                 TNZ     s:1986

      259     1979    1           IF TOPOLOGY_OPTIONS.PORTFLAG THEN

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:68   
   1979 26 000057   200010 473500                    LDP3    @TOPOLOGY_OPTIONS,,AUTO
        26 000060   300001 234100                    SZN     1,,PR3
        26 000061   000066 605000 26                 TPL     s:1985

      260     1980    2           DO;

      261     1981    2               STATUS_CODE=%ZII_PORTFLAG;

   1981 26 000062   013574 235007                    LDA     6012,DL
        26 000063   200011 474500                    LDP4    @STATUS_CODE,,AUTO
        26 000064   400000 755100                    STA     0,,PR4

      262     1982    2               ALTRETURN;

   1982 26 000065   000000 702200 xent               TSX2  ! X66_AALT

      263     1983    2               END;
      264     1984    1           ELSE
      265     1985    1               CALL SELECT_PORT;

   1985 26 000066   003436 701000 26                 TSX1    SELECT_PORT
        26 000067   000000 011000                    NOP     0
        26 000070   000075 710000 26                 TRA     s:1990

      266     1986    1       ELSE IF ACCESS_LIST.PORT_TYPE = 0 THEN CALL SELECT_PORT;

   1986 26 000071   100001 221100                    LDX1    1,,PR1
        26 000072   000075 601000 26                 TNZ     s:1990

   1986 26 000073   003436 701000 26                 TSX1    SELECT_PORT
        26 000074   000000 011000                    NOP     0

      267     1987        /*
      268     1988          Initialize STATUS_CODE with zero.
      269     1989                                                                              */
      270     1990    1       STATUS_CODE=0;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:69   
   1990 26 000075   200011 470500                    LDP0    @STATUS_CODE,,AUTO
        26 000076   000000 450100                    STZ     0,,PR0

      271     1991    1       MEMBER_OF_LIST=0;

   1991 26 000077   200024 450100                    STZ     MEMBER_OF_LIST,,AUTO

      272     1992        /*
      273     1993          Init START_NODE (the current starting record for building partial
      274     1994          branches; initially it is the Port record) and the Port occurrence
      275     1995          in PATH_LIST, which always resides in PATH_LIST(1).
      276     1996        /*
      277     1997          Compute distances from the Port record for all records involved
      278     1998          in the subschema. If only one record in search, then don't build
      279     1999           the distances.                                                     */
      280     2000    1       CALL ZII$PATH_MEMORY(2,%GET) ALTRET(ER_COMMON);

   2000 26 000100   000004 630400 27                 EPPR0   4
        26 000101   000000 631400 27                 EPPR1   0
        26 000102   000000 701000 xent               TSX1    ZII$PATH_MEMORY
        26 000103   001243 702000 26                 TSX2    ER_COMMON

      281     2001    1       PATH$_P=PINCRW(ZII$COMMON$,DISPLAY_LIST#+1);

   2001 26 000104   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 000105   000022 736000                    QLS     18
        26 000106   000001 036003                    ADLQ    1,DU
        26 000107   000000 036000 0                  ADLQ    ZII$COMMON$
        26 000110   200007 470500                    LDP0    @PATH$_P,,AUTO
        26 000111   000000 756100                    STQ     0,,PR0

      282     2002    1       PATH$=PATH$_P;

   2002 26 000112   200014 756100                    STQ     PATH$,,AUTO

      283     2003    1       START_NODE=ACCESS_LIST.PORT;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:70   
   2003 26 000113   200005 471500                    LDP1    @ACCESS_LIST,,AUTO
        26 000114   100000 236100                    LDQ     0,,PR1
        26 000115   000022 772000                    QRL     18
        26 000116   200063 756100                    STQ     START_NODE,,AUTO

      284     2004    1       REC_NO = 1;

   2004 26 000117   000001 235007                    LDA     1,DL
        26 000120   200015 755100                    STA     REC_NO,,AUTO

      285     2005    1       PATH_LIST.REC_NO(0) = REC_NO;

   2005 26 000121   000000 620005                    EAX0    0,AL
        26 000122   200014 473500                    LDP3    PATH$,,AUTO
        26 000123   300000 740100                    STX0    0,,PR3

      286     2006    1       PATH_LIST.REC_NO(1)=ACCESS_LIST.PORT;

   2006 26 000124   100000 221100                    LDX1    0,,PR1
        26 000125   300005 741100                    STX1    5,,PR3

      287     2007    1       PATH_LIST.SET_NO(1)=0;

   2007 26 000126   000000 222003                    LDX2    0,DU
        26 000127   300005 442100                    SXL2    5,,PR3

      288     2008    1       PATH_LIST.OWN_NEXT(1)='0'B;

   2008 26 000130   000006 236000 27                 LDQ     6
        26 000131   300006 356100                    ANSQ    6,,PR3

      289     2009    1       PATH_LIST.GET_IND(1)='1'B;

   2009 26 000132   200000 236003                    LDQ     65536,DU
        26 000133   300006 256100                    ORSQ    6,,PR3

      290     2010    1       PATH_LIST.FIND_ATTEMPTED(1)='0'B;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:71   

   2010 26 000134   000007 236000 27                 LDQ     7
        26 000135   300006 356100                    ANSQ    6,,PR3

      291     2011    1       PATH_LIST.REPEAT_IND(1)='0'B;

   2011 26 000136   000010 236000 27                 LDQ     8
        26 000137   300006 356100                    ANSQ    6,,PR3

      292     2012    1       PATH_LIST.INIT_EPTR(1)=ENTADDR(NIL);

   2012 26 000140   000011 236000 27                 LDQ     9
        26 000141   300007 756100                    STQ     7,,PR3

      293     2013    1       PATH_LIST.CONVERT_EPTR(1)=ENTADDR(NIL);

   2013 26 000142   300010 756100                    STQ     8,,PR3

      294     2014    1       PATH_LIST.CONSTRAINT_EPTR(1)=ENTADDR(NIL);

   2014 26 000143   300011 756100                    STQ     9,,PR3

      295     2015    1       CALL SET_DISPLAY_IND;

   2015 26 000144   004734 701000 26                 TSX1    SET_DISPLAY_IND
        26 000145   000000 011000                    NOP     0

      296     2016        %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:72   
      297     2017        /*
      298     2018          If VIA_LIST(0)~=0, then Via information was supplied in the IDP
      299     2019          command DISPLAY and Topology must follow the "direction" it
      300     2020          was given. If Via information is exhausted before TDISPLAY_LIST
      301     2021          is exhausted, then all Via information has been used and the normal
      302     2022          method can be used to build the remainder of the Path to include
      303     2023          the remaining records of TDISPLAY_LIST in the Path.
      304     2024                                                                              */
      305     2025    1       TEMP_PORT_PATH_IDX = 1;

   2025 26 000146   000001 235007                    LDA     1,DL
        26 000147   200055 755100                    STA     TEMP_PORT_PATH_IDX,,AUTO

      306     2026    1       TEMP_PORT=ACCESS_LIST.PORT;

   2026 26 000150   200005 470500                    LDP0    @ACCESS_LIST,,AUTO
        26 000151   000000 236100                    LDQ     0,,PR0
        26 000152   000022 772000                    QRL     18
        26 000153   200065 756100                    STQ     TEMP_PORT,,AUTO

      307     2027    1       IF DISPLAY_LIST#>1 OR TDISPLAY_LIST(1) ~= ACCESS_LIST.PORT THEN

   2027 26 000154   200012 235100                    LDA     DISPLAY_LIST#,,AUTO
        26 000155   000002 115007                    CMPA    2,DL
        26 000156   000162 603000 26                 TRC     s:2029
        26 000157   000000 471400 0                  LDP1    ZII$COMMON$
        26 000160   100001 116100                    CMPQ    1,,PR1
        26 000161   001015 600000 26                 TZE     s:2316

      308     2028    2       DO;

      309     2029    2           TEMP_ARG=TEMP_PORT;

   2029 26 000162   200066 756100                    STQ     TEMP_ARG,,AUTO

      310     2030    2           CALL COMP_DIST(TEMP_ARG);

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:73   
   2030 26 000163   200066 631500                    EPPR1   TEMP_ARG,,AUTO
        26 000164   200117 451500                    STP1    MEMBER_LIST+23,,AUTO
        26 000165   003171 701000 26                 TSX1    COMP_DIST
        26 000166   000000 011000                    NOP     0

      311     2031    2           IF VIA_LIST(0)~=0 THEN

   2031 26 000167   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000170   000000 235100                    LDA     0,,PR0
        26 000171   000621 600000 26                 TZE     s:2175

      312     2032    3           DO;

      313     2033    3               CURRENT_NODE=TEMP_PORT;

   2033 26 000172   200065 236100                    LDQ     TEMP_PORT,,AUTO
        26 000173   200064 756100                    STQ     CURRENT_NODE,,AUTO

      314     2034    3               N=1;

   2034 26 000174   000001 235007                    LDA     1,DL
        26 000175   200057 755100                    STA     N,,AUTO

      315     2035    4               DO WHILE (TDISPLAY_LIST#~=0);

   2035 26 000176   200013 235100                    LDA     TDISPLAY_LIST#,,AUTO
        26 000177   000510 600000 26                 TZE     PRINT_VIA_WARN

      316     2036    5                   IF N<=VIA_LIST(0) THEN DO;

   2036 26 000200   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000201   000000 236100                    LDQ     0,,PR0
        26 000202   200057 116100                    CMPQ    N,,AUTO
        26 000203   000474 602000 26                 TNC     s:2140

      317     2037    5                       CALL OWNER_SET(VIA_LIST(N),OWNER_REC) ALTRET(PRINT_VIA_WARN);

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:74   
   2037 26 000204   200021 631500                    EPPR1   OWNER_REC,,AUTO
        26 000205   200202 451500                    STP1    @SET_NO+1,,AUTO
        26 000206   200057 236100                    LDQ     N,,AUTO
        26 000207   000022 736000                    QLS     18
        26 000210   200006 036100                    ADLQ    @VIA_LIST,,AUTO
        26 000211   200201 756100                    STQ     J+2,,AUTO
        26 000212   003745 701000 26                 TSX1    OWNER_SET
        26 000213   000510 702000 26                 TSX2    PRINT_VIA_WARN

      318     2038    5                      CALL MEMBER_SET(VIA_LIST(N),MEMBER_LIST) ALTRET(PRINT_VIA_WARN);

   2038 26 000214   200070 630500                    EPPR0   MEMBER_LIST,,AUTO
        26 000215   200202 450500                    STP0    @SET_NO+1,,AUTO
        26 000216   200057 236100                    LDQ     N,,AUTO
        26 000217   000022 736000                    QLS     18
        26 000220   200006 036100                    ADLQ    @VIA_LIST,,AUTO
        26 000221   200201 756100                    STQ     J+2,,AUTO
        26 000222   003766 701000 26                 TSX1    MEMBER_SET
        26 000223   000510 702000 26                 TSX2    PRINT_VIA_WARN

      319     2039    5                       IF MEMBER_LIST.REC_NO(0)=1 THEN

   2039 26 000224   200070 220100                    LDX0    MEMBER_LIST,,AUTO
        26 000225   000001 100003                    CMPX0   1,DU
        26 000226   000233 601000 26                 TNZ     s:2041

      320     2040    5                           MEMBER_REC = MEMBER_LIST.REC_NO(1);

   2040 26 000227   200071 235100                    LDA     MEMBER_LIST+1,,AUTO
        26 000230   000022 771000                    ARL     18
        26 000231   200022 755100                    STA     MEMBER_REC,,AUTO
        26 000232   000262 710000 26                 TRA     s:2045

      321     2041    5                       ELSE IF N=VIA_LIST(0) THEN

   2041 26 000233   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000234   200057 236100                    LDQ     N,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:75   
        26 000235   000000 116100                    CMPQ    0,,PR0
        26 000236   000250 601000 26                 TNZ     s:2044

      322     2042    5                               CALL PICK_A_MEMBER(MEMBER_LIST,MEMBER_REC);

   2042 26 000237   000012 236000 27                 LDQ     10
        26 000240   200145 756100                    STQ     @BEST_MEMBER+1,,AUTO
        26 000241   200022 631500                    EPPR1   MEMBER_REC,,AUTO
        26 000242   200144 451500                    STP1    @SET_MEMBERS+1,,AUTO
        26 000243   200070 633500                    EPPR3   MEMBER_LIST,,AUTO
        26 000244   200143 453500                    STP3    K+1,,AUTO
        26 000245   004040 701000 26                 TSX1    PICK_A_MEMBER
        26 000246   000000 011000                    NOP     0
        26 000247   000262 710000 26                 TRA     s:2045

      323     2043    5                           ELSE
      324     2044    5                              CALL PICK_A_MEMBER(MEMBER_LIST,MEMBER_REC,VIA_LIST(N+1))
              2044                                        ;

   2044 26 000250   000022 736000                    QLS     18
        26 000251   000001 036003                    ADLQ    1,DU
        26 000252   200006 036100                    ADLQ    @VIA_LIST,,AUTO
        26 000253   200145 756100                    STQ     @BEST_MEMBER+1,,AUTO
        26 000254   200022 631500                    EPPR1   MEMBER_REC,,AUTO
        26 000255   200144 451500                    STP1    @SET_MEMBERS+1,,AUTO
        26 000256   200070 633500                    EPPR3   MEMBER_LIST,,AUTO
        26 000257   200143 453500                    STP3    K+1,,AUTO
        26 000260   004040 701000 26                 TSX1    PICK_A_MEMBER
        26 000261   000000 011000                    NOP     0

      325     2045    6                       IF OWNER_REC=CURRENT_NODE THEN DO;

   2045 26 000262   200021 236100                    LDQ     OWNER_REC,,AUTO
        26 000263   200064 116100                    CMPQ    CURRENT_NODE,,AUTO
        26 000264   000400 601000 26                 TNZ     s:2074

      326     2046    6                           CALL ZII$PATH_MEMORY(1,%GET) ALTRET(ER_COMMON);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:76   

   2046 26 000265   000013 630400 27                 EPPR0   11
        26 000266   000000 631400 27                 EPPR1   0
        26 000267   000000 701000 xent               TSX1    ZII$PATH_MEMORY
        26 000270   001243 702000 26                 TSX2    ER_COMMON

      327     2047    6                           PATH_LIST.SET_NO(REC_NO)=VIA_LIST(N);

   2047 26 000271   200015 236100                    LDQ     REC_NO,,AUTO
        26 000272   000005 402007                    MPY     5,DL
        26 000273   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000274   200057 720100                    LXL0    N,,AUTO
        26 000275   000000 721110                    LXL1    0,X0,PR0
        26 000276   200014 471500                    LDP1    PATH$,,AUTO
        26 000277   100000 441106                    SXL1    0,QL,PR1

      328     2048    6                           REC_NO=REC_NO+1;

   2048 26 000300   200015 235100                    LDA     REC_NO,,AUTO
        26 000301   000001 035007                    ADLA    1,DL
        26 000302   200015 755100                    STA     REC_NO,,AUTO

      329     2049    6                           PATH_LIST.REC_NO(0) = REC_NO;

   2049 26 000303   000000 621005                    EAX1    0,AL
        26 000304   100000 741100                    STX1    0,,PR1

      330     2050    6                           PATH_LIST.REC_NO(REC_NO)=MEMBER_REC;

   2050 26 000305   200015 236100                    LDQ     REC_NO,,AUTO
        26 000306   000005 402007                    MPY     5,DL
        26 000307   200022 722100                    LXL2    MEMBER_REC,,AUTO
        26 000310   100000 742106                    STX2    0,QL,PR1

      331     2051    6                           PATH_LIST.SET_NO(REC_NO)=0;

   2051 26 000311   000000 221003                    LDX1    0,DU
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:77   
        26 000312   100000 441106                    SXL1    0,QL,PR1

      332     2052    6                           PATH_LIST.INIT_EPTR(REC_NO)=ENTADDR(NIL);

   2052 26 000313   000000 622006                    EAX2    0,QL
        26 000314   000011 236000 27                 LDQ     9
        26 000315   100002 756112                    STQ     2,X2,PR1

      333     2053    6                           PATH_LIST.CONSTRAINT_EPTR(REC_NO)=ENTADDR(NIL);

   2053 26 000316   100004 756112                    STQ     4,X2,PR1

      334     2054    6                           PATH_LIST.CONVERT_EPTR(REC_NO)=ENTADDR(NIL);

   2054 26 000317   100003 756112                    STQ     3,X2,PR1

      335     2055    6                           CALL SET_DISPLAY_IND;

   2055 26 000320   004734 701000 26                 TSX1    SET_DISPLAY_IND
        26 000321   000000 011000                    NOP     0

      336     2056    6                           IF REC_NO > 1 THEN

   2056 26 000322   200015 235100                    LDA     REC_NO,,AUTO
        26 000323   000002 115007                    CMPA    2,DL
        26 000324   000364 602000 26                 TNC     s:2070

      337     2057    7                           DO;

      338     2058    7                               K=1;

   2058 26 000325   000001 236007                    LDQ     1,DL
        26 000326   200062 756100                    STQ     K,,AUTO

      339     2059    8                               DO WHILE (K<REC_NO);

   2059 26 000327   200015 116100                    CMPQ    REC_NO,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:78   
        26 000330   000353 603000 26                 TRC     s:2067

      340     2060    8                                  IF PATH_LIST.REC_NO(K)=PATH_LIST.REC_NO(REC_NO) THEN

   2060 26 000331   200062 236100                    LDQ     K,,AUTO
        26 000332   000005 402007                    MPY     5,DL
        26 000333   200014 470500                    LDP0    PATH$,,AUTO
        26 000334   000000 220106                    LDX0    0,QL,PR0
        26 000335   200015 236100                    LDQ     REC_NO,,AUTO
        26 000336   000005 402007                    MPY     5,DL
        26 000337   000000 100106                    CMPX0   0,QL,PR0
        26 000340   000345 601000 26                 TNZ     s:2065

      341     2061    9                                   DO;

      342     2062    9                                       MEMBER_OF_LIST=1;

   2062 26 000341   000001 235007                    LDA     1,DL
        26 000342   200024 755100                    STA     MEMBER_OF_LIST,,AUTO

      343     2063    9                                       K=REC_NO;

   2063 26 000343   200015 235100                    LDA     REC_NO,,AUTO
        26 000344   200062 755100                    STA     K,,AUTO

      344     2064    9                                       END;

      345     2065    8                                   K=K+1;

   2065 26 000345   200062 235100                    LDA     K,,AUTO
        26 000346   000001 035007                    ADLA    1,DL
        26 000347   200062 755100                    STA     K,,AUTO

      346     2066    8                                   END;

   2066 26 000350   200062 236100                    LDQ     K,,AUTO
        26 000351   200015 116100                    CMPQ    REC_NO,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:79   
        26 000352   000331 602000 26                 TNC     s:2060

      347     2067    7                               IF MEMBER_OF_LIST=1 THEN

   2067 26 000353   200024 235100                    LDA     MEMBER_OF_LIST,,AUTO
        26 000354   000001 115007                    CMPA    1,DL
        26 000355   000364 601000 26                 TNZ     s:2070

      348     2068    7                                   PATH_LIST.REPEAT_IND(REC_NO)='1'B;

   2068 26 000356   200015 236100                    LDQ     REC_NO,,AUTO
        26 000357   000005 402007                    MPY     5,DL
        26 000360   200014 470500                    LDP0    PATH$,,AUTO
        26 000361   000000 620006                    EAX0    0,QL
        26 000362   040000 236003                    LDQ     16384,DU
        26 000363   000001 256110                    ORSQ    1,X0,PR0

      349     2069    7                               END;

      350     2070    6                           PATH_LIST.GET_IND(REC_NO)='1'B;

   2070 26 000364   200015 236100                    LDQ     REC_NO,,AUTO
        26 000365   000005 402007                    MPY     5,DL
        26 000366   200014 470500                    LDP0    PATH$,,AUTO
        26 000367   000000 620006                    EAX0    0,QL
        26 000370   200000 236003                    LDQ     65536,DU
        26 000371   000001 256110                    ORSQ    1,X0,PR0

      351     2071    6                           CURRENT_NODE=MEMBER_REC;

   2071 26 000372   200022 235100                    LDA     MEMBER_REC,,AUTO
        26 000373   200064 755100                    STA     CURRENT_NODE,,AUTO

      352     2072    6                           N=N+1;

   2072 26 000374   200057 235100                    LDA     N,,AUTO
        26 000375   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:80   
        26 000376   200057 755100                    STA     N,,AUTO

      353     2073    6                           END;

   2073 26 000377   000465 710000 26                 TRA     s:2136

      354     2074    6                       ELSE IF MEMBER_REC = CURRENT_NODE THEN DO;

   2074 26 000400   200022 236100                    LDQ     MEMBER_REC,,AUTO
        26 000401   200064 116100                    CMPQ    CURRENT_NODE,,AUTO
        26 000402   000453 601000 26                 TNZ     s:2098

      355     2075    6                               CALL ZII$PATH_MEMORY(1,%GET) ALTRET(ER_COMMON);

   2075 26 000403   000013 630400 27                 EPPR0   11
        26 000404   000000 631400 27                 EPPR1   0
        26 000405   000000 701000 xent               TSX1    ZII$PATH_MEMORY
        26 000406   001243 702000 26                 TSX2    ER_COMMON

      356     2076    6                               PATH_LIST.SET_NO(REC_NO)=VIA_LIST(N);

   2076 26 000407   200015 236100                    LDQ     REC_NO,,AUTO
        26 000410   000005 402007                    MPY     5,DL
        26 000411   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000412   200057 720100                    LXL0    N,,AUTO
        26 000413   000000 721110                    LXL1    0,X0,PR0
        26 000414   200014 471500                    LDP1    PATH$,,AUTO
        26 000415   100000 441106                    SXL1    0,QL,PR1

      357     2077    6                               PATH_LIST.OWN_NEXT(REC_NO)='1'B;

   2077 26 000416   000000 622006                    EAX2    0,QL
        26 000417   400000 236003                    LDQ     -131072,DU
        26 000420   100001 256112                    ORSQ    1,X2,PR1

      358     2078    6                               REC_NO=REC_NO+1;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:81   
   2078 26 000421   200015 235100                    LDA     REC_NO,,AUTO
        26 000422   000001 035007                    ADLA    1,DL
        26 000423   200015 755100                    STA     REC_NO,,AUTO

      359     2079    6                               PATH_LIST.REC_NO(0)=REC_NO;

   2079 26 000424   000000 621005                    EAX1    0,AL
        26 000425   100000 741100                    STX1    0,,PR1

      360     2080    6                               PATH_LIST.REC_NO(REC_NO)=OWNER_REC;

   2080 26 000426   200015 236100                    LDQ     REC_NO,,AUTO
        26 000427   000005 402007                    MPY     5,DL
        26 000430   200021 722100                    LXL2    OWNER_REC,,AUTO
        26 000431   100000 742106                    STX2    0,QL,PR1

      361     2081    6                               PATH_LIST.SET_NO(REC_NO)=0;

   2081 26 000432   000000 221003                    LDX1    0,DU
        26 000433   100000 441106                    SXL1    0,QL,PR1

      362     2082    6                               PATH_LIST.GET_IND(REC_NO)='1'B;

   2082 26 000434   000000 622006                    EAX2    0,QL
        26 000435   200000 236003                    LDQ     65536,DU
        26 000436   100001 256112                    ORSQ    1,X2,PR1

      363     2083    6                               PATH_LIST.INIT_EPTR(REC_NO)=ENTADDR(NIL);

   2083 26 000437   000011 236000 27                 LDQ     9
        26 000440   100002 756112                    STQ     2,X2,PR1

      364     2084    6                               PATH_LIST.CONVERT_EPTR(REC_NO)=ENTADDR(NIL);

   2084 26 000441   100003 756112                    STQ     3,X2,PR1

      365     2085    6                               PATH_LIST.CONSTRAINT_EPTR(REC_NO)=ENTADDR(NIL);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:82   

   2085 26 000442   100004 756112                    STQ     4,X2,PR1

      366     2086    6                               CALL SET_DISPLAY_IND;

   2086 26 000443   004734 701000 26                 TSX1    SET_DISPLAY_IND
        26 000444   000000 011000                    NOP     0

      367     2087    6                               CURRENT_NODE=OWNER_REC;

   2087 26 000445   200021 235100                    LDA     OWNER_REC,,AUTO
        26 000446   200064 755100                    STA     CURRENT_NODE,,AUTO

      368     2088    6                               N=N+1;

   2088 26 000447   200057 236100                    LDQ     N,,AUTO
        26 000450   000001 036007                    ADLQ    1,DL
        26 000451   200057 756100                    STQ     N,,AUTO

      369     2089    6                               END;

   2089 26 000452   000465 710000 26                 TRA     s:2136

      370     2090    6                           ELSE DO;

      371     2091        /*
      372     2092          Since the current node was neither the owner nor the member of the
      373     2093          VIA set in question, use the generalized back-tracking algorithm
      374     2094          to get to the owner of the set. Then, eliminate all other VIA sets
      375     2095          included in the path by incrementing N and therefore excluding
      376     2096          them from further consideration.
      377     2097        */
      378     2098    6                               START_NODE=PATH_LIST.REC_NO(REC_NO);

   2098 26 000453   200015 236100                    LDQ     REC_NO,,AUTO
        26 000454   000005 402007                    MPY     5,DL
        26 000455   200014 470500                    LDP0    PATH$,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:83   
        26 000456   000000 236106                    LDQ     0,QL,PR0
        26 000457   000022 772000                    QRL     18
        26 000460   200063 756100                    STQ     START_NODE,,AUTO

      379     2099    6                               TEMP_PORT_PATH_IDX = REC_NO;

   2099 26 000461   200015 235100                    LDA     REC_NO,,AUTO
        26 000462   200055 755100                    STA     TEMP_PORT_PATH_IDX,,AUTO

      380     2100    6                               TEMP_PORT=START_NODE;

   2100 26 000463   200065 756100                    STQ     TEMP_PORT,,AUTO

      381     2101    6                               GOTO PRINT_VIA_WARN;

   2101 26 000464   000510 710000 26                 TRA     PRINT_VIA_WARN

      382     2102         /* .................Comment out the unused code..............................
      383     2103
      384     2104            When (if) this gets put back in or replaced, notice that
      385     2105            the BACK_TRACK proc has been changed to BACK_TRACK_MAYBE.
      386     2106            In other words, it will not always build the branch anymore
      387     2107            for reasons expressed below, in the NORM section.
      388     2108
      389     2109            CALL BACK_TRACK(CURRENT_NODE,OWNER_REC) ALTRET(ER_COMMON);
      390     2110            CALL ELIMINATE_SETS;
      391     2111            IF STATUS_CODE=0 THEN
      392     2112            IF TOPOLOGY_OPTIONS.WARNING_CODE>0 THEN DO;
      393     2113            ILLEGAL_SETS_INCLUDED=1;
      394     2114            DO J = 1 TO REC_NO;
      395     2115            IF PATH_LIST.SET_NO(J) ~= 0  THEN DO;
      396     2116            DO K = 1 TO VIA_LIST(0);
      397     2117            IF PATH_LIST.SET_NO(J)=VIA_LIST(K) THEN DO;
      398     2118            ILLEGAL_SETS_INCLUDED=0;
      399     2119            K=VIA_LIST(0);
      400     2120            END;
      401     2121            END; /# Do K thru VIA_LIST #/
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:84   
      402     2122            IF ILLEGAL_SETS_INCLUDED=1 THEN DO;
      403     2123            IF TOPOLOGY_OPTIONS.WARNING_CODE=2 THEN DO;
      404     2124            STATUS_CODE=%ZII_SETS_ABORT;
      405     2125            ALTRETURN;
      406     2126            END;
      407     2127            ELSE
      408     2128            STATUS_CODE=%ZII_SETS_WARNING;
      409     2129            J=REC_NO+1;
      410     2130            END;
      411     2131            END; /# If PATH_LIST.SET_NO(J) ~= 0 #/
      412     2132            END; /# Do J = 1 thru PATH_LIST #/
      413     2133            END; /# If PATH WARN or ABORT #/
      414     2134         ...........................................................................*/
      415     2135    6                               END; /* Disconnected VIA_LIST */
      416     2136    5                       CALL NOT_PATHTBL(TDISPLAY_LIST,PATH$->PATH_LIST);

   2136 26 000465   200014 236100                    LDQ     PATH$,,AUTO
        26 000466   200120 756100                    STQ     J+1,,AUTO
        26 000467   000000 236000 0                  LDQ     ZII$COMMON$
        26 000470   200117 756100                    STQ     MEMBER_LIST+23,,AUTO
        26 000471   004614 701000 26                 TSX1    NOT_PATHTBL
        26 000472   000000 011000                    NOP     0

      417     2137    5                       END; /* If N <= VIA_LIST(0) */

   2137 26 000473   000506 710000 26                 TRA     s:2145

      418     2138    4                   ELSE
      419     2139    5                   DO;

      420     2140    5                       START_NODE=PATH_LIST.REC_NO(REC_NO);

   2140 26 000474   200015 236100                    LDQ     REC_NO,,AUTO
        26 000475   000005 402007                    MPY     5,DL
        26 000476   200014 471500                    LDP1    PATH$,,AUTO
        26 000477   100000 236106                    LDQ     0,QL,PR1
        26 000500   000022 772000                    QRL     18
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:85   
        26 000501   200063 756100                    STQ     START_NODE,,AUTO

      421     2141    5                       TEMP_PORT_PATH_IDX = REC_NO;

   2141 26 000502   200015 235100                    LDA     REC_NO,,AUTO
        26 000503   200055 755100                    STA     TEMP_PORT_PATH_IDX,,AUTO

      422     2142    5                       TEMP_PORT=START_NODE;

   2142 26 000504   200065 756100                    STQ     TEMP_PORT,,AUTO

      423     2143    5                       GOTO NORM;

   2143 26 000505   000623 710000 26                 TRA     NORM

      424     2144    5                       END;
      425     2145    4                   END;

   2145 26 000506   200013 235100                    LDA     TDISPLAY_LIST#,,AUTO
        26 000507   000200 601000 26                 TNZ     s:2036

   2136 26 000510                       PRINT_VIA_W* null
      426     2146        /*
      427     2147          Some Via sets were not used in the Path list if VIA_LIST(0)>=N;
      428     2148          Issue warning to calling program.
      429     2149        */
      430     2150    3   PRINT_VIA_WARN:;
      431     2151    3               IF N <= VIA_LIST(0) THEN

   2151 26 000510   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000511   000000 236100                    LDQ     0,,PR0
        26 000512   200057 116100                    CMPQ    N,,AUTO
        26 000513   000621 602000 26                 TNC     s:2175

      432     2152    4               DO I = 1 TO 2; /* In case M$LO & M$DO are set to different places */

   2152 26 000514   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:86   
        26 000515   200060 755100                    STA     I,,AUTO

      433     2153    4                   J = N; /* Save original contents of N */

   2153 26 000516   200057 235100                    LDA     N,,AUTO
        26 000517   200061 755100                    STA     J,,AUTO

      434     2154    4                   TOPOLOGY_OPTIONS.PRINT_IND = '1'B;

   2154 26 000520   200010 470500                    LDP0    @TOPOLOGY_OPTIONS,,AUTO
        26 000521   200000 236003                    LDQ     65536,DU
        26 000522   000001 256100                    ORSQ    1,,PR0

      435     2155    4                   ERR_OUT.BUF_ = VECTOR(BLNK_LINE);

   2155 26 000523   000016 237000 27                 LDAQ    14
        26 000524   000020 757000 2                  STAQ    ERR_OUT+4

      436     2156    4                   CALL M$WRITE(ERR_OUT);

   2156 26 000525   000014 630400 2                  EPPR0   ERR_OUT
        26 000526   040001 713400                    CLIMB   write
        26 000527   401400 401760                    pmme    nvectors=4

      437     2157    4                   ERR_OUT.BUF_ = VECTOR(VIA_ERROR);

   2157 26 000530   000020 237000 27                 LDAQ    16
        26 000531   000020 757000 2                  STAQ    ERR_OUT+4

      438     2158    4                   CALL M$WRITE(ERR_OUT);

   2158 26 000532   000014 630400 2                  EPPR0   ERR_OUT
        26 000533   040001 713400                    CLIMB   write
        26 000534   401400 401760                    pmme    nvectors=4

      439     2159    4                   ERR_OUT.BUF_ = VECTOR(BLNK_LINE);

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:87   
   2159 26 000535   000016 237000 27                 LDAQ    14
        26 000536   000020 757000 2                  STAQ    ERR_OUT+4

      440     2160    4                   CALL M$WRITE(ERR_OUT);

   2160 26 000537   000014 630400 2                  EPPR0   ERR_OUT
        26 000540   040001 713400                    CLIMB   write
        26 000541   401400 401760                    pmme    nvectors=4

      441     2161    4                   ERR_OUT.BUF_ = VECTOR(ERR_LINE);

   2161 26 000542   000022 237000 27                 LDAQ    18
        26 000543   000020 757000 2                  STAQ    ERR_OUT+4

      442     2162    5                   DO WHILE (N <= VIA_LIST(0));

   2162 26 000544   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000545   000000 236100                    LDQ     0,,PR0
        26 000546   200057 116100                    CMPQ    N,,AUTO
        26 000547   000573 602000 26                 TNC     s:2167

      443     2163    5                       ERR_LINE.SET_FD = NAM1.NAME.TEXT(VIA_LIST(N));

   2163 26 000550   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000551   200057 720100                    LXL0    N,,AUTO
        26 000552   000000 236110                    LDQ     0,X0,PR0
        26 000553   000012 402007                    MPY     10,DL
        26 000554   000002 736000                    QLS     2
        26 000555   000000 471400 10                 LDP1    NAM1$
        26 000556   040000 100506                    MLR     fill='040'O
        26 000557   100001 000040                    ADSC9   1,Q,PR1                  cn=0,n=32
        26 000560   000001 000040 2                  ADSC9   ERR_LINE+1               cn=0,n=32

      444     2164    5                       CALL M$WRITE(ERR_OUT);

   2164 26 000561   000014 630400 2                  EPPR0   ERR_OUT
        26 000562   040001 713400                    CLIMB   write
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:88   
        26 000563   401400 401760                    pmme    nvectors=4

      445     2165    5                       N = N+1;

   2165 26 000564   200057 235100                    LDA     N,,AUTO
        26 000565   000001 035007                    ADLA    1,DL
        26 000566   200057 755100                    STA     N,,AUTO

      446     2166    5                       END;

   2166 26 000567   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 000570   000000 236100                    LDQ     0,,PR0
        26 000571   200057 116100                    CMPQ    N,,AUTO
        26 000572   000550 603000 26                 TRC     s:2163

      447     2167    4                   STATUS_CODE = 310;

   2167 26 000573   000466 235007                    LDA     310,DL
        26 000574   200011 471500                    LDP1    @STATUS_CODE,,AUTO
        26 000575   100000 755100                    STA     0,,PR1

      448     2168    4                   ERR_OUT.BUF_ = VECTOR(BLNK_LINE);

   2168 26 000576   000016 237000 27                 LDAQ    14
        26 000577   000020 757000 2                  STAQ    ERR_OUT+4

      449     2169    4                   CALL M$WRITE(ERR_OUT);

   2169 26 000600   000014 630400 2                  EPPR0   ERR_OUT
        26 000601   040001 713400                    CLIMB   write
        26 000602   401400 401760                    pmme    nvectors=4

      450     2170    4                   CALL M$CORRES(LO_DO) ALTRET(NORM);

   2170 26 000603   000030 630400 2                  EPPR0   LO_DO
        26 000604   460000 713400                    CLIMB   alt,+24576
        26 000605   400000 401760                    pmme    nvectors=1
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:89   
        26 000606   000623 702000 26                 TSX2    NORM

      451     2171    4                   ERR_OUT.V.DCB# = DCBNUM(M$DO);

   2171 26 000607   000000 236007 xsym               LDQ     M$DO,DL
        26 000610   000000 620006                    EAX0    0,QL
        26 000611   000024 740000 2                  STX0    ERR_OUT+8

      452     2172    4                   N = J;

   2172 26 000612   200061 235100                    LDA     J,,AUTO
        26 000613   200057 755100                    STA     N,,AUTO

      453     2173    4                   END;

   2173 26 000614   200060 236100                    LDQ     I,,AUTO
        26 000615   000001 036007                    ADLQ    1,DL
        26 000616   200060 756100                    STQ     I,,AUTO
        26 000617   000003 116007                    CMPQ    3,DL
        26 000620   000516 602000 26                 TNC     s:2153

      454     2174    3               END;

      455     2175    3           DO WHILE (TDISPLAY_LIST# > 0);

   2175 26 000621   200013 235100                    LDA     TDISPLAY_LIST#,,AUTO
        26 000622   001011 600000 26                 TZE     s:2308

      456     2176        /*
      457     2177          If no Via information was supplied or if Via information was
      458     2178          exhausted and records still remain in TDISPLAY_LIST, then this
      459     2179          section will be executed.
      460     2180                                                                              */
      461     2181
      462     2182        /*
      463     2183          For B03 and beyond, this section also contains a kludge to
      464     2184          (hopefully) make paths built using VIA lists work. The general
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:90   
      465     2185          idea is this. If we have a VIA list for a display, we will have
      466     2186          set up part of the path list by this point using the records and
      467     2187          sets indicated in the via list. As a repercussion of this, the
      468     2188          TEMP_PORT variable will no longer contain the index of the actual
      469     2189          port record but that of the last record entered in the path list.
      470     2190          This was causing problems when the path chosen was going to
      471     2191          contain a lambda structure. Unfortunately, if TEMP_PORT turned
      472     2192          out to be "below" the lambda pivot point, the possibility was
      473     2193          very high that the back tracking routine would build a bad branch
      474     2194          for retrieval purposes. E.g., if the record furthest away from
      475     2195          TEMP_PORT was connectable to TEMP_PORT via sets which involved the
      476     2196          lambda pivot record, then the branch built would back track to the
      477     2197          lambda pivot and then down a piece of a branch already built. This
      478     2198          caused a lot of excitement during retrieval. Anyway, suffice it to
      479     2199          say that the path list would easily end up unuseable in this kind
      480     2200          of situation.
      481     2201
      482     2202          This "solution" tries to do the following. Regardless of what
      483     2203          TEMP_PORT is, we first find the record farthest away and build
      484     2204          the branch between. Then, we compare the branch just built with
      485     2205          the original branch. (If there was no via list, there won't be an
      486     2206          original branch yet.) If the branch just built has a record(s) in
      487     2207          it which is also in the original branch, then we are encountering
      488     2208          the problem mentioned above. If this is true, we mark the culprit
      489     2209          record(s) in D_TABLE, erase the new branch, go back, and find the
      490     2210          next longest branch which doesn't include any culprit records.
      491     2211          When we run out of acceptable branches (CURRENT_NODE still equals 0)
      492     2212          and there are still records left unattached, then we want to pop
      493     2213          TEMP_PORT back up the traversal tree (represented by the path list)
      494     2214          toward the port record and try again. However, we only want to back
      495     2215          up to a record which was flagged when we found lambda conflicts
      496     2216          before. These are the records which were found in the new branch
      497     2217          and also in the original (or a previously built) branch. At least
      498     2218          one of these must be a lambda pivot point. After backing up to the
      499     2219          closest one of these, we go back to the beginning of the NORM loop
      500     2220          and start over clean, recomputing distances to records not yet
      501     2221          attached from the new TEMP_PORT (i.e., rebuilding D_TABLE). This
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:91   
      502     2222          method is reiterated until every required record has been attached
      503     2223          to the traversal tree (or path list). Hopefully, this will help
      504     2224          ensure that a path list will be at least theoretically useable in
      505     2225          retrieval. It may indicate nested lambda structures which cannot
      506     2226          be handled by the current retrieval mechanism, but this problem
      507     2227          should be caught later before any damage is done.
      508     2228        */
      509     2229    3   NORM:       TEMP_ARG=TEMP_PORT;

   2229 26 000623   200065 235100       NORM         LDA     TEMP_PORT,,AUTO
        26 000624   200066 755100                    STA     TEMP_ARG,,AUTO

      510     2230         /*
      511     2231            Since we have a new temp port rec, we want to set (or reset)
      512     2232            these flags since they won't necessarily be true for this
      513     2233            version of the table. These may be set later if a new path
      514     2234            built is back tracking thru a (potential) lambda pivot
      515     2235            record located higher up in the traversal tree.
      516     2236         */
      517     2237    4               DO I = 0 TO TBL_DIM-1;

   2237 26 000625   200060 450100                    STZ     I,,AUTO
        26 000626   000636 710000 26                 TRA     s:2239+3

      518     2238    4                   D_TABLE.BELONGS_PREV_LAMBDA(I) = '0'B;

   2238 26 000627   200060 235100                    LDA     I,,AUTO
        26 000630   000002 735000                    ALS     2
        26 000631   000000 470400 7                  LDP0    D_TBL$
        26 000632   000003 450105                    STZ     3,AL,PR0

      519     2239    4                   END;

   2239 26 000633   200060 236100                    LDQ     I,,AUTO
        26 000634   000001 036007                    ADLQ    1,DL
        26 000635   200060 756100                    STQ     I,,AUTO
        26 000636   200060 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:92   
        26 000637   000000 116000 9                  CMPQ    TBL_DIM
        26 000640   000627 602000 26                 TNC     s:2238

      520     2240    3               CALL COMP_DIST(TEMP_ARG);

   2240 26 000641   200066 630500                    EPPR0   TEMP_ARG,,AUTO
        26 000642   200117 450500                    STP0    MEMBER_LIST+23,,AUTO
        26 000643   003171 701000 26                 TSX1    COMP_DIST
        26 000644   000000 011000                    NOP     0

      521     2241    3               LAMBDA_REC# = 0; /* The # of recs in the LAMBDA_RECS array */

   2241 26 000645   200027 450100                    STZ     LAMBDA_REC#,,AUTO

      522     2242    4               DO WHILE (TDISPLAY_LIST#~=0 AND TEMP_ARG = TEMP_PORT);

   2242 26 000646   001002 710000 26                 TRA     s:2301

      523     2243    4                   T_DIST=0;

   2243 26 000647   200023 450100                    STZ     T_DIST,,AUTO

      524     2244    4                   CURRENT_NODE=0;

   2244 26 000650   200064 450100                    STZ     CURRENT_NODE,,AUTO

      525     2245    4                   N=1;

   2245 26 000651   000001 235007                    LDA     1,DL
        26 000652   200057 755100                    STA     N,,AUTO

      526     2246    5                   DO WHILE (N <= TDISPLAY_LIST#);

   2246 26 000653   200013 236100                    LDQ     TDISPLAY_LIST#,,AUTO
        26 000654   200057 116100                    CMPQ    N,,AUTO
        26 000655   000715 602000 26                 TNC     s:2263

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:93   
      527     2247    5                       CALL ZII$FIND_IDX(TDISPLAY_LIST(N),J);

   2247 26 000656   200061 630500                    EPPR0   J,,AUTO
        26 000657   200207 450500                    STP0    DRFS$$+3,,AUTO
        26 000660   200057 236100                    LDQ     N,,AUTO
        26 000661   000022 736000                    QLS     18
        26 000662   000000 036000 0                  ADLQ    ZII$COMMON$
        26 000663   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 000664   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 000665   000000 631400 27                 EPPR1   0
        26 000666   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 000667   000000 011000                    NOP     0

      528     2248    5                       IF D_TABLE.DIST_FROM_PORT(J)>T_DIST AND

   2248 26 000670   200061 235100                    LDA     J,,AUTO
        26 000671   000002 735000                    ALS     2
        26 000672   000000 470400 7                  LDP0    D_TBL$
        26 000673   000000 236105                    LDQ     0,AL,PR0
        26 000674   777777 376007                    ANQ     -1,DL
        26 000675   200023 116100                    CMPQ    T_DIST,,AUTO
        26 000676   000707 602000 26                 TNC     s:2254
        26 000677   000707 600000 26                 TZE     s:2254
        26 000700   000003 234105                    SZN     3,AL,PR0
        26 000701   000707 604000 26                 TMI     s:2254

      529     2249    5                          NOT D_TABLE.BELONGS_PREV_LAMBDA(J) THEN
      530     2250    6                       DO;

      531     2251    6                           T_DIST=D_TABLE.DIST_FROM_PORT(J);

   2251 26 000702   200023 756100                    STQ     T_DIST,,AUTO

      532     2252    6                           CURRENT_NODE=TDISPLAY_LIST(N);

   2252 26 000703   000000 471400 0                  LDP1    ZII$COMMON$
        26 000704   200057 720100                    LXL0    N,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:94   
        26 000705   100000 235110                    LDA     0,X0,PR1
        26 000706   200064 755100                    STA     CURRENT_NODE,,AUTO

      533     2253    6                           END;

      534     2254    5                       N=N+1;

   2254 26 000707   200057 235100                    LDA     N,,AUTO
        26 000710   000001 035007                    ADLA    1,DL
        26 000711   200057 755100                    STA     N,,AUTO

      535     2255    5                       END;

   2255 26 000712   200013 236100                    LDQ     TDISPLAY_LIST#,,AUTO
        26 000713   200057 116100                    CMPQ    N,,AUTO
        26 000714   000656 603000 26                 TRC     s:2247

      536     2256         /*
      537     2257            If CURRENT_NODE=0 then we didn't find any more acceptable
      538     2258            branches from the current TEMP_PORT. Therefore, we want
      539     2259            to find the nearest rec which was a possible lambda pivot
      540     2260            and make it the new TEMP_PORT. I.e., pop back up the
      541     2261            traversal tree and start over again.
      542     2262         */
      543     2263    5                   IF CURRENT_NODE = 0 THEN DO;

   2263 26 000715   200064 235100                    LDA     CURRENT_NODE,,AUTO
        26 000716   000762 601000 26                 TNZ     s:2296

      544     2264    5                       IF LAMBDA_REC# = 0 THEN

   2264 26 000717   200027 235100                    LDA     LAMBDA_REC#,,AUTO
        26 000720   001253 600000 26                 TZE     ER_CANT_MAKE_PATH

      545     2265    5                           GOTO ER_CANT_MAKE_PATH;
      546     2266    5                       TEMP_PORT_PATH_IDX = 0;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:95   
   2266 26 000721   200055 450100                    STZ     TEMP_PORT_PATH_IDX,,AUTO

      547     2267    6                       DO I = 1 TO LAMBDA_REC#;
              2267                                /* IF should always be true at least once */

   2267 26 000722   000001 235007                    LDA     1,DL
        26 000723   200060 755100                    STA     I,,AUTO
        26 000724   000744 710000 26                 TRA     s:2273+3

      548     2268    7                          IF LAMBDA_RECS.PATH_LIST_IDX(I) > TEMP_PORT_PATH_IDX THEN DO
              2268                                    ;

   2268 26 000725   200060 720100                    LXL0    I,,AUTO
        26 000726   200030 236110                    LDQ     LAMBDA_RECS,X0,AUTO
        26 000727   777777 376007                    ANQ     -1,DL
        26 000730   200055 116100                    CMPQ    TEMP_PORT_PATH_IDX,,AUTO
        26 000731   000741 602000 26                 TNC     s:2273
        26 000732   000741 600000 26                 TZE     s:2273

      549     2269    7                               TEMP_PORT_PATH_IDX = LAMBDA_RECS.PATH_LIST_IDX(I);

   2269 26 000733   200055 756100                    STQ     TEMP_PORT_PATH_IDX,,AUTO

      550     2270    7                               TEMP_PORT = LAMBDA_RECS.REC_NO(I);

   2270 26 000734   200030 236110                    LDQ     LAMBDA_RECS,X0,AUTO
        26 000735   000022 772000                    QRL     18
        26 000736   200065 756100                    STQ     TEMP_PORT,,AUTO

      551     2271    7                               IDX = I;

   2271 26 000737   200060 235100                    LDA     I,,AUTO
        26 000740   200056 755100                    STA     IDX,,AUTO

      552     2272    7                               END;

      553     2273    6                           END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:96   

   2273 26 000741   200060 235100                    LDA     I,,AUTO
        26 000742   000001 035007                    ADLA    1,DL
        26 000743   200060 755100                    STA     I,,AUTO
        26 000744   200027 236100                    LDQ     LAMBDA_REC#,,AUTO
        26 000745   200060 116100                    CMPQ    I,,AUTO
        26 000746   000725 603000 26                 TRC     s:2268

      554     2274    5                       IF LAMBDA_REC# ~= IDX THEN

   2274 26 000747   200056 116100                    CMPQ    IDX,,AUTO
        26 000750   000754 600000 26                 TZE     s:2276

      555     2275    5                           LAMBDA_RECS(IDX) = LAMBDA_RECS(LAMBDA_REC#);

   2275 26 000751   200030 236106                    LDQ     LAMBDA_RECS,QL,AUTO
        26 000752   200056 720100                    LXL0    IDX,,AUTO
        26 000753   200030 756110                    STQ     LAMBDA_RECS,X0,AUTO

      556     2276    5                       LAMBDA_REC# = LAMBDA_REC# - 1;

   2276 26 000754   200027 236100                    LDQ     LAMBDA_REC#,,AUTO
        26 000755   000001 136007                    SBLQ    1,DL
        26 000756   200027 756100                    STQ     LAMBDA_REC#,,AUTO

      557     2277    5                       START_NODE = TEMP_PORT;

   2277 26 000757   200065 235100                    LDA     TEMP_PORT,,AUTO
        26 000760   200063 755100                    STA     START_NODE,,AUTO

      558     2278    5                       END;

   2278 26 000761   001002 710000 26                 TRA     s:2301

      559     2279    5                   ELSE DO;

      560     2280         /*
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:97   
      561     2281            Else, we did find a potential branch to build. This
      562     2282            routine used to be called BACK_TRACK, but now we're
      563     2283            not always so sure. It will build the new branch in
      564     2284            the path list, but will check it before returning. If
      565     2285            the branch is unacceptable, it will be obliterated,
      566     2286            the potential lambda pivot records will be placed in
      567     2287            the LAMBDA_RECS array, and the records in the branch
      568     2288            will be flagged in D_TABLE.BELONGS_PREV_LAMBDA so that
      569     2289            we won't try to back track from any of them on the next
      570     2290            go round. DID_I just tells us whether we really built
      571     2291            the branch and saved it or whether we erased it because
      572     2292            it was bad. If we really built it, then we can safely
      573     2293            erase the records contained therein from the TDISPLAY
      574     2294            list.
      575     2295         */
      576     2296    5                       CALL BACK_TRACK_MAYBE(START_NODE,CURRENT_NODE,DID_I)

   2296 26 000762   200067 630500                    EPPR0   DID_I,,AUTO
        26 000763   200121 450500                    STP0    @PATH_LIST+1,,AUTO
        26 000764   200064 631500                    EPPR1   CURRENT_NODE,,AUTO
        26 000765   200120 451500                    STP1    J+1,,AUTO
        26 000766   200063 633500                    EPPR3   START_NODE,,AUTO
        26 000767   200117 453500                    STP3    MEMBER_LIST+23,,AUTO
        26 000770   001356 701000 26                 TSX1    BACK_TRACK_MAYBE
        26 000771   001243 702000 26                 TSX2    ER_COMMON

      577     2297    5                          ALTRET(ER_COMMON);
      578     2298    5                       IF DID_I = '1'B THEN

   2298 26 000772   200067 234100                    SZN     DID_I,,AUTO
        26 000773   001002 605000 26                 TPL     s:2301

      579     2299    5                           CALL NOT_PATHTBL(TDISPLAY_LIST,PATH$->PATH_LIST);

   2299 26 000774   200014 236100                    LDQ     PATH$,,AUTO
        26 000775   200120 756100                    STQ     J+1,,AUTO
        26 000776   000000 236000 0                  LDQ     ZII$COMMON$
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:98   
        26 000777   200117 756100                    STQ     MEMBER_LIST+23,,AUTO
        26 001000   004614 701000 26                 TSX1    NOT_PATHTBL
        26 001001   000000 011000                    NOP     0

      580     2300    5                       END;

      581     2301    4                   END;

   2301 26 001002   200013 235100                    LDA     TDISPLAY_LIST#,,AUTO
        26 001003   001007 600000 26                 TZE     s:2302
        26 001004   200066 236100                    LDQ     TEMP_ARG,,AUTO
        26 001005   200065 116100                    CMPQ    TEMP_PORT,,AUTO
        26 001006   000647 600000 26                 TZE     s:2243

      582     2302    3               END;

   2302 26 001007   000000 115003                    CMPA    0,DU
        26 001010   000623 601000 26                 TNZ     NORM

      583     2303        /*
      584     2304          In both cases, call COMPRESS_PATH to take out redundant record
      585     2305          appearances in the Path that were unseen during construction of
      586     2306          PATH_LIST.
      587     2307                                                                              */
      588     2308    2           CALL COMPRESS_PATH(PATH$->PATH_LIST);

   2308 26 001011   200014 236100                    LDQ     PATH$,,AUTO
        26 001012   200117 756100                    STQ     MEMBER_LIST+23,,AUTO
        26 001013   002712 701000 26                 TSX1    COMPRESS_PATH
        26 001014   000000 011000                    NOP     0

      589     2309    2           END;

      590     2310        /*
      591     2311          Check to see if this path list has more than 1 lambda structure
      592     2312          in it (nested lambdas). If so, we can't necessarily handle it
      593     2313          during retrieval, so tell him so and cancel this display.
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:99   
      594     2314        */
      595     2315
      596     2316    1       N = 0;

   2316 26 001015   200057 450100                    STZ     N,,AUTO

      597     2317    2       DO I = 1 TO REC_NO-1;

   2317 26 001016   000001 235007                    LDA     1,DL
        26 001017   200060 755100                    STA     I,,AUTO
        26 001020   001123 710000 26                 TRA     s:2341+3

      598     2318    3           DO J = I+1 TO REC_NO;

   2318 26 001021   200060 235100                    LDA     I,,AUTO
        26 001022   000001 035007                    ADLA    1,DL
        26 001023   200061 755100                    STA     J,,AUTO
        26 001024   001115 710000 26                 TRA     s:2340+3

      599     2319    3               IF PATH_LIST.REC_NO(I) = PATH_LIST.REC_NO(J) THEN

   2319 26 001025   200060 236100                    LDQ     I,,AUTO
        26 001026   000005 402007                    MPY     5,DL
        26 001027   200014 470500                    LDP0    PATH$,,AUTO
        26 001030   000000 220106                    LDX0    0,QL,PR0
        26 001031   200061 236100                    LDQ     J,,AUTO
        26 001032   000005 402007                    MPY     5,DL
        26 001033   000000 100106                    CMPX0   0,QL,PR0
        26 001034   001112 601000 26                 TNZ     s:2340

      600     2320    3                   IF N=0

   2320 26 001035   200057 235100                    LDA     N,,AUTO
        26 001036   001045 601000 26                 TNZ     s:2322

      601     2321    3                   THEN N = PATH_LIST.REC_NO(I);

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:100  
   2321 26 001037   200060 236100                    LDQ     I,,AUTO
        26 001040   000005 402007                    MPY     5,DL
        26 001041   000000 236106                    LDQ     0,QL,PR0
        26 001042   000022 772000                    QRL     18
        26 001043   200057 756100                    STQ     N,,AUTO
        26 001044   001112 710000 26                 TRA     s:2340

      602     2322    4                   ELSE IF N ~= PATH_LIST.REC_NO(I) THEN DO;

   2322 26 001045   200060 236100                    LDQ     I,,AUTO
        26 001046   000005 402007                    MPY     5,DL
        26 001047   000000 236106                    LDQ     0,QL,PR0
        26 001050   000022 772000                    QRL     18
        26 001051   200057 116100                    CMPQ    N,,AUTO
        26 001052   001112 600000 26                 TZE     s:2340

      603     2323         /*
      604     2324            This indicates a nested lambda structure. However,
      605     2325            if the contained lambda structure has 2nd and higher
      606     2326            branches made up of only owners, then it should all
      607     2327            work O.K. anyway during retrieval, so let those
      608     2328            go thru.
      609     2329         */
      610     2330    4                           K=J;

   2330 26 001053   200061 235100                    LDA     J,,AUTO
        26 001054   200062 755100                    STA     K,,AUTO

      611     2331    5                           DO WHILE(PATH_LIST.SET_NO(K)~=0);

   2331 26 001055   200062 236100                    LDQ     K,,AUTO
        26 001056   000005 402007                    MPY     5,DL
        26 001057   000000 720106                    LXL0    0,QL,PR0
        26 001060   001112 600000 26                 TZE     s:2340

      612     2332    6                               IF NOT PATH_LIST.OWN_NEXT(K) THEN DO;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:101  
   2332 26 001061   200062 236100                    LDQ     K,,AUTO
        26 001062   000005 402007                    MPY     5,DL
        26 001063   200014 470500                    LDP0    PATH$,,AUTO
        26 001064   000001 234106                    SZN     1,QL,PR0
        26 001065   001103 604000 26                 TMI     s:2337

      613     2333    6                                   CALL ZII$PRINT_PATH(ACCESS_LIST,PATH_LIST,
              2333                                            DISPLAY_LIST);

   2333 26 001066   200003 236100                    LDQ     @DISPLAY_LIST,,AUTO
        26 001067   200210 756100                    STQ     DRFS$$+4,,AUTO
        26 001070   200014 236100                    LDQ     PATH$,,AUTO
        26 001071   200005 235100                    LDA     @ACCESS_LIST,,AUTO
        26 001072   200206 757100                    STAQ    DRFS$$+2,,AUTO
        26 001073   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 001074   000024 631400 27                 EPPR1   20
        26 001075   000000 701000 xent               TSX1    ZII$PRINT_PATH
        26 001076   000000 011000                    NOP     0

      614     2334    6                                   STATUS_CODE = %ZII_NO_NESTED_LAMBDAS;

   2334 26 001077   013600 235007                    LDA     6016,DL
        26 001100   200011 470500                    LDP0    @STATUS_CODE,,AUTO
        26 001101   000000 755100                    STA     0,,PR0

      615     2335    6                                   ALTRETURN;

   2335 26 001102   000000 702200 xent               TSX2  ! X66_AALT

      616     2336    6                                   END;
      617     2337    5                               K=K+1;

   2337 26 001103   200062 235100                    LDA     K,,AUTO
        26 001104   000001 035007                    ADLA    1,DL
        26 001105   200062 755100                    STA     K,,AUTO

      618     2338    5                               END;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:102  

   2338 26 001106   200062 236100                    LDQ     K,,AUTO
        26 001107   000005 402007                    MPY     5,DL
        26 001110   000000 720106                    LXL0    0,QL,PR0
        26 001111   001061 601000 26                 TNZ     s:2332

      619     2339    4                           END;

      620     2340    3               END;

   2340 26 001112   200061 235100                    LDA     J,,AUTO
        26 001113   000001 035007                    ADLA    1,DL
        26 001114   200061 755100                    STA     J,,AUTO
        26 001115   200015 236100                    LDQ     REC_NO,,AUTO
        26 001116   200061 116100                    CMPQ    J,,AUTO
        26 001117   001025 603000 26                 TRC     s:2319

      621     2341    2           END;

   2341 26 001120   200060 235100                    LDA     I,,AUTO
        26 001121   000001 035007                    ADLA    1,DL
        26 001122   200060 755100                    STA     I,,AUTO
        26 001123   200060 236100                    LDQ     I,,AUTO
        26 001124   200015 116100                    CMPQ    REC_NO,,AUTO
        26 001125   001021 602000 26                 TNC     s:2318

      622     2342    2       IF TOPOLOGY_OPTIONS.WARNING_CODE > 0 THEN DO;

   2342 26 001126   200010 470500                    LDP0    @TOPOLOGY_OPTIONS,,AUTO
        26 001127   000000 235100                    LDA     0,,PR0
        26 001130   001220 600000 26                 TZE     s:2365

      623     2343    3           DO J = 1 TO REC_NO;

   2343 26 001131   000001 235007                    LDA     1,DL
        26 001132   200061 755100                    STA     J,,AUTO
        26 001133   001215 710000 26                 TRA     s:2360+3
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:103  

      624     2344    3               ILLEGAL_SETS_INCLUDED=1;

   2344 26 001134   000001 235007                    LDA     1,DL
        26 001135   200020 755100                    STA     ILLEGAL_SETS_INCLUDED,,AUTO

      625     2345    4               IF PATH_LIST.SET_NO(J) ~= 0 THEN DO;

   2345 26 001136   200061 236100                    LDQ     J,,AUTO
        26 001137   000005 402007                    MPY     5,DL
        26 001140   200014 470500                    LDP0    PATH$,,AUTO
        26 001141   000000 720106                    LXL0    0,QL,PR0
        26 001142   001212 600000 26                 TZE     s:2360

      626     2346    5                   DO K = 1 TO VIA_LIST(0);

   2346 26 001143   000001 235007                    LDA     1,DL
        26 001144   200062 755100                    STA     K,,AUTO
        26 001145   001165 710000 26                 TRA     s:2351+3

      627     2347    6                       IF PATH_LIST.SET_NO(J)=VIA_LIST(K) THEN DO;

   2347 26 001146   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 001147   200062 720100                    LXL0    K,,AUTO
        26 001150   200061 236100                    LDQ     J,,AUTO
        26 001151   000005 402007                    MPY     5,DL
        26 001152   200014 471500                    LDP1    PATH$,,AUTO
        26 001153   100000 236106                    LDQ     0,QL,PR1
        26 001154   777777 376007                    ANQ     -1,DL
        26 001155   000000 116110                    CMPQ    0,X0,PR0
        26 001156   001162 601000 26                 TNZ     s:2351

      628     2348    6                           ILLEGAL_SETS_INCLUDED=0;

   2348 26 001157   200020 450100                    STZ     ILLEGAL_SETS_INCLUDED,,AUTO

      629     2349    6                           K=VIA_LIST(0);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:104  

   2349 26 001160   000000 235100                    LDA     0,,PR0
        26 001161   200062 755100                    STA     K,,AUTO

      630     2350    6                           END;

      631     2351    5                       END; /* Do K thru VIA_LIST */

   2351 26 001162   200062 235100                    LDA     K,,AUTO
        26 001163   000001 035007                    ADLA    1,DL
        26 001164   200062 755100                    STA     K,,AUTO
        26 001165   200006 470500                    LDP0    @VIA_LIST,,AUTO
        26 001166   000000 236100                    LDQ     0,,PR0
        26 001167   200062 116100                    CMPQ    K,,AUTO
        26 001170   001146 603000 26                 TRC     s:2347

      632     2352    5                   IF ILLEGAL_SETS_INCLUDED=1 THEN DO;

   2352 26 001171   200020 235100                    LDA     ILLEGAL_SETS_INCLUDED,,AUTO
        26 001172   000001 115007                    CMPA    1,DL
        26 001173   001212 601000 26                 TNZ     s:2360

      633     2353    5                       IF TOPOLOGY_OPTIONS.WARNING_CODE=2 THEN

   2353 26 001174   200010 471500                    LDP1    @TOPOLOGY_OPTIONS,,AUTO
        26 001175   100000 235100                    LDA     0,,PR1
        26 001176   000002 115007                    CMPA    2,DL
        26 001177   001204 601000 26                 TNZ     s:2356

      634     2354    5                           STATUS_CODE=%ZII_SETS_ABORT;

   2354 26 001200   013562 235007                    LDA     6002,DL
        26 001201   200011 473500                    LDP3    @STATUS_CODE,,AUTO
        26 001202   300000 755100                    STA     0,,PR3
        26 001203   001207 710000 26                 TRA     s:2357

      635     2355    5                       ELSE
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:105  
      636     2356    5                           STATUS_CODE=%ZII_SETS_WARNING;

   2356 26 001204   013563 235007                    LDA     6003,DL
        26 001205   200011 473500                    LDP3    @STATUS_CODE,,AUTO
        26 001206   300000 755100                    STA     0,,PR3

      637     2357    5                       J=REC_NO+1;

   2357 26 001207   200015 236100                    LDQ     REC_NO,,AUTO
        26 001210   000001 036007                    ADLQ    1,DL
        26 001211   200061 756100                    STQ     J,,AUTO

      638     2358    5                       END;

      639     2359    4                   END; /* If PATH_LIST.SET_NO(J) ~= 0 */

      640     2360    3               END; /* Do J = 1 thru REC_NO */

   2360 26 001212   200061 235100                    LDA     J,,AUTO
        26 001213   000001 035007                    ADLA    1,DL
        26 001214   200061 755100                    STA     J,,AUTO
        26 001215   200015 236100                    LDQ     REC_NO,,AUTO
        26 001216   200061 116100                    CMPQ    J,,AUTO
        26 001217   001134 603000 26                 TRC     s:2344

      641     2361    2           END; /* If PATH WARN or ABORT */

      642     2362        /*
      643     2363          Now print Topology analysis summary if it was requested by
      644     2364          the user via the TOPOLOGY ON command in IDP.                         */
      645     2365    1       IF TOPOLOGY_OPTIONS.PRINT_IND THEN

   2365 26 001220   200010 470500                    LDP0    @TOPOLOGY_OPTIONS,,AUTO
        26 001221   000001 236100                    LDQ     1,,PR0
        26 001222   200000 316003                    CANQ    65536,DU
        26 001223   001235 600000 26                 TZE     s:2367

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:106  
      646     2366    1           CALL ZII$PRINT_PATH(ACCESS_LIST,PATH_LIST,DISPLAY_LIST) ALTRET(
              2366                    ER_IMPOSSIBLE_PATH);

   2366 26 001224   200003 236100                    LDQ     @DISPLAY_LIST,,AUTO
        26 001225   200210 756100                    STQ     DRFS$$+4,,AUTO
        26 001226   200014 236100                    LDQ     PATH$,,AUTO
        26 001227   200005 235100                    LDA     @ACCESS_LIST,,AUTO
        26 001230   200206 757100                    STAQ    DRFS$$+2,,AUTO
        26 001231   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 001232   000024 631400 27                 EPPR1   20
        26 001233   000000 701000 xent               TSX1    ZII$PRINT_PATH
        26 001234   001247 702000 26                 TSX2    ER_IMPOSSIBLE_PATH

      647     2367    1       IF STATUS_CODE = %ZII_SETS_ABORT THEN ALTRETURN;

   2367 26 001235   200011 470500                    LDP0    @STATUS_CODE,,AUTO
        26 001236   000000 235100                    LDA     0,,PR0
        26 001237   013562 115007                    CMPA    6002,DL
        26 001240   001242 601000 26                 TNZ     s:2368

   2367 26 001241   000000 702200 xent               TSX2  ! X66_AALT

      648     2368    1       RETURN;

   2368 26 001242   000000 702200 xent               TSX2  ! X66_ARET

      649     2369    1   ER_COMMON:
      650     2370    1       STATUS_CODE=%ZII_NO_MEMORY;

   2370 26 001243   013561 235007       ER_COMMON    LDA     6001,DL
        26 001244   200011 470500                    LDP0    @STATUS_CODE,,AUTO
        26 001245   000000 755100                    STA     0,,PR0

      651     2371    1       ALTRETURN;

   2371 26 001246   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:107  
   2367 26 001247                       ER_IMPOSSIB* null
      652     2372    1   ER_IMPOSSIBLE_PATH:;
      653     2373    1       STATUS_CODE = %ZII_NO_NESTED_LAMBDAS;

   2373 26 001247   013600 235007                    LDA     6016,DL
        26 001250   200011 470500                    LDP0    @STATUS_CODE,,AUTO
        26 001251   000000 755100                    STA     0,,PR0

      654     2374    1       ALTRETURN;

   2374 26 001252   000000 702200 xent               TSX2  ! X66_AALT

   2373 26 001253                       ER_CANT_MAK* null
      655     2375    1   ER_CANT_MAKE_PATH:;
      656     2376    1       STATUS_CODE = %ZII_CANT_MAKE_PATH;

   2376 26 001253   013601 235007                    LDA     6017,DL
        26 001254   200011 470500                    LDP0    @STATUS_CODE,,AUTO
        26 001255   000000 755100                    STA     0,,PR0

      657     2377    1       CALL ZII$PRINT_PATH(ACCESS_LIST,PATH_LIST,DISPLAY_LIST);

   2377 26 001256   200003 236100                    LDQ     @DISPLAY_LIST,,AUTO
        26 001257   200210 756100                    STQ     DRFS$$+4,,AUTO
        26 001260   200014 236100                    LDQ     PATH$,,AUTO
        26 001261   200005 235100                    LDA     @ACCESS_LIST,,AUTO
        26 001262   200206 757100                    STAQ    DRFS$$+2,,AUTO
        26 001263   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 001264   000024 631400 27                 EPPR1   20
        26 001265   000000 701000 xent               TSX1    ZII$PRINT_PATH
        26 001266   000000 011000                    NOP     0

      658     2378    1       ALTRETURN;

   2378 26 001267   000000 702200 xent               TSX2  ! X66_AALT

      659     2379         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:108  
      660     2380    1   MEMBER_TBL: PROC(REC_IDX,IN_TBL,OUT_FLG);

   2380 26 001270   200142 741300       MEMBER_TBL   STX1  ! N+1,,AUTO

      661     2381        /*
      662     2382          DESCRIPTION: This Proc takes a single index of a record in the
      663     2383                       subschema tables and compares it with all members of
      664     2384                       the list W until it either hits the end of the list,
      665     2385                       indicating that the index is not in the list, or when
      666     2386                       the same index is encountered in the list, indicating
      667     2387                       that the index is in the list.
      668     2388
      669     2389          IN:
      670     2390             REC_IDX := Single index of a record in the subschema tables.
      671     2391             IN_TBL := Table of indices of records in the subschema tables.
      672     2392
      673     2393          Out:
      674     2394              OUT_FLG := Idicator of membership: 0 = V is not in W,
      675     2395                                                 1 = V is a member of W.
      676     2396                                                                              */
      677     2397    2   DCL REC_IDX UBIN;
      678     2398    2   DCL IN_TBL (0:0) UBIN;
      679     2399    2   DCL OUT_FLG UBIN;
      680     2400    2   DCL N UBIN AUTO;
      681     2401        /**/
      682     2402    2       OUT_FLG=0;

   2402 26 001271   200145 470500                    LDP0    @OUT_FLG,,AUTO
        26 001272   000000 450100                    STZ     0,,PR0

      683     2403    2       N=1;

   2403 26 001273   000001 235007                    LDA     1,DL
        26 001274   200146 755100                    STA     N,,AUTO

      684     2404    3       DO WHILE (N<=IN_TBL(0));

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:109  
   2404 26 001275   200144 471500                    LDP1    @IN_TBL,,AUTO
        26 001276   100000 236100                    LDQ     0,,PR1
        26 001277   200146 116100                    CMPQ    N,,AUTO
        26 001300   001322 602000 26                 TNC     s:2412

      685     2405    3           IF REC_IDX=IN_TBL(N) THEN

   2405 26 001301   200143 470500                    LDP0    @REC_IDX,,AUTO
        26 001302   200144 471500                    LDP1    @IN_TBL,,AUTO
        26 001303   200146 720100                    LXL0    N,,AUTO
        26 001304   000000 236100                    LDQ     0,,PR0
        26 001305   100000 116110                    CMPQ    0,X0,PR1
        26 001306   001314 601000 26                 TNZ     s:2410

      686     2406    4           DO;

      687     2407    4               OUT_FLG=1;

   2407 26 001307   000001 235007                    LDA     1,DL
        26 001310   200145 473500                    LDP3    @OUT_FLG,,AUTO
        26 001311   300000 755100                    STA     0,,PR3

      688     2408    4               N=IN_TBL(0);

   2408 26 001312   100000 235100                    LDA     0,,PR1
        26 001313   200146 755100                    STA     N,,AUTO

      689     2409    4               END;

      690     2410    3           N=N+1;

   2410 26 001314   200146 235100                    LDA     N,,AUTO
        26 001315   000001 035007                    ADLA    1,DL
        26 001316   200146 755100                    STA     N,,AUTO

      691     2411    3           END;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:110  
   2411 26 001317   100000 236100                    LDQ     0,,PR1
        26 001320   200146 116100                    CMPQ    N,,AUTO
        26 001321   001301 603000 26                 TRC     s:2405

      692     2412    2       RETURN;

   2412 26 001322   200142 221300                    LDX1  ! N+1,,AUTO
        26 001323   000001 702211                    TSX2  ! 1,X1

      693     2413    2   END MEMBER_TBL;
      694     2414         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:111  
      695     2415    1   EMPTY_TBL: PROC (IN_TBL,OUT_FLG);

   2415 26 001324   200136 741300       EMPTY_TBL    STX1  ! ZER_FLG+1,,AUTO

      696     2416        /*
      697     2417          DESCRIPTION: This Proc determines whether a list is null.
      698     2418
      699     2419          IN:
      700     2420             IN_TBL := List of indices of records in the subschema tables.
      701     2421
      702     2422          OUT:
      703     2423              OUT_FLG := Indicator :  0 = List is null,
      704     2424                                      1 = List is not null.
      705     2425                                                                              */
      706     2426    2   DCL IN_TBL (0:0) UBIN;
      707     2427    2   DCL OUT_FLG UBIN;
      708     2428    2   DCL N UBIN AUTO;
      709     2429    2   DCL K UBIN AUTO;
      710     2430        /**/
      711     2431    2       OUT_FLG=0;

   2431 26 001325   200140 470500                    LDP0    @OUT_FLG,,AUTO
        26 001326   000000 450100                    STZ     0,,PR0

      712     2432    2       N=1;

   2432 26 001327   000001 235007                    LDA     1,DL
        26 001330   200141 755100                    STA     N,,AUTO

      713     2433    3       DO WHILE (N<=IN_TBL(0));

   2433 26 001331   200137 471500                    LDP1    @IN_TBL,,AUTO
        26 001332   100000 236100                    LDQ     0,,PR1
        26 001333   200141 116100                    CMPQ    N,,AUTO
        26 001334   001354 602000 26                 TNC     s:2441

      714     2434    3           IF IN_TBL(N)~=0 THEN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:112  

   2434 26 001335   200137 470500                    LDP0    @IN_TBL,,AUTO
        26 001336   200141 720100                    LXL0    N,,AUTO
        26 001337   000000 235110                    LDA     0,X0,PR0
        26 001340   001346 600000 26                 TZE     s:2439

      715     2435    4           DO;

      716     2436    4               OUT_FLG=1;

   2436 26 001341   000001 236007                    LDQ     1,DL
        26 001342   200140 471500                    LDP1    @OUT_FLG,,AUTO
        26 001343   100000 756100                    STQ     0,,PR1

      717     2437    4               RETURN;

   2437 26 001344   200136 221300                    LDX1  ! ZER_FLG+1,,AUTO
        26 001345   000001 702211                    TSX2  ! 1,X1

      718     2438    4               END;
      719     2439    3           N=N+1;

   2439 26 001346   200141 236100                    LDQ     N,,AUTO
        26 001347   000001 036007                    ADLQ    1,DL
        26 001350   200141 756100                    STQ     N,,AUTO

      720     2440    3           END;

   2440 26 001351   000000 116100                    CMPQ    0,,PR0
        26 001352   001335 602000 26                 TNC     s:2434
        26 001353   001335 600000 26                 TZE     s:2434

      721     2441    2       RETURN;

   2441 26 001354   200136 221300                    LDX1  ! ZER_FLG+1,,AUTO
        26 001355   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:113  
      722     2442    2   END EMPTY_TBL;
      723     2443         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:114  
      724     2444    1   BACK_TRACK_MAYBE: PROC (START_NODE,TERM_NODE,DID_I) ALTRET;

   2444 26 001356   200116 741300       BACK_TRACK_* STX1  ! MEMBER_LIST+22,,AUTO

      725     2445        /*
      726     2446          DESCRIPTION: This proc is the main mechanism for finding a series
      727     2447                       of connected records between one record and another,
      728     2448                       namely START_NODE and TERM_NODE.
      729     2449          IN:
      730     2450             START_NODE := Starting node of partial branch (initially Port).
      731     2451             TERM_NODE := Node to be reached by some series of connected records.
      732     2452             PORT_RECORD := Record already cited as the Port record.
      733     2453             TDISPLAY_LIST := List containing indices of records involved
      734     2454                              in the search.
      735     2455          OUT:
      736     2456              PATH_LIST := The partial path of connected records that defines
      737     2457                           a path between START_NODE and V. There may be many partial
      738     2458                           paths (from successive calls to BACK_TRACK) and
      739     2459                           these are eventially put together in the calling
      740     2460                           routine (ZII$TOPOLOGY) to form the final Path.
      741     2461                                                                              */
      742     2462    2   DCL START_NODE UBIN;
      743     2463    2   DCL TERM_NODE UBIN;
      744     2464    2   DCL I UBIN AUTO;
      745     2465    2   DCL K UBIN AUTO;
      746     2466    2   DCL J UBIN AUTO;
      747     2467    2   DCL MAX_DIST UBIN AUTO;
      748     2468    2   DCL N UBIN AUTO;
      749     2469    2   DCL M UBIN AUTO;
      750     2470    2   DCL X UBIN AUTO;
      751     2471    2   DCL CUR_NODE UBIN AUTO;
      752     2472    2   DCL TEMP_ARG UBIN AUTO;
      753     2473    2   DCL MEM_FLG UBIN AUTO;
      754     2474    2   DCL PATH_SLOTS_NEEDED UBIN AUTO;
      755     2475    2   DCL START_OF_BRANCH UBIN AUTO;
      756     2476    2   DCL DID_I BIT(1) ALIGNED;
      757     2477    2   DCL ADD_TO_LAMBDA_RECS BIT(1) ALIGNED;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:115  
      758     2478    2   DCL SAVE_REC_NO UBIN AUTO;
      759     2479    2   DCL SET_NO UBIN;
      760     2480        /**/
      761     2481    2   DCL ZII$FIND_D2_IDX ENTRY(3);
      762     2482    2   DCL ZII$PATH_MEMORY ENTRY(2) ALTRET;
      763     2483        /**/
      764     2484    2       IF REC_NO=1 THEN

   2484 26 001357   200015 235100                    LDA     REC_NO,,AUTO
        26 001360   000001 115007                    CMPA    1,DL
        26 001361   001365 601000 26                 TNZ     s:2487

      765     2485    2           START_OF_BRANCH=1;

   2485 26 001362   000001 236007                    LDQ     1,DL
        26 001363   200135 756100                    STQ     START_OF_BRANCH,,AUTO
        26 001364   001367 710000 26                 TRA     s:2489

      766     2486    2       ELSE
      767     2487    2           START_OF_BRANCH=REC_NO+1;

   2487 26 001365   000001 035007                    ADLA    1,DL
        26 001366   200135 755100                    STA     START_OF_BRANCH,,AUTO

      768     2488         /* Save it in case we end up throwing this new branch away. */
      769     2489    2       SAVE_REC_NO = REC_NO;

   2489 26 001367   200015 235100                    LDA     REC_NO,,AUTO
        26 001370   200137 755100                    STA     SAVE_REC_NO,,AUTO

      770     2490    2       CUR_NODE=TERM_NODE;

   2490 26 001371   200120 470500                    LDP0    @TERM_NODE,,AUTO
        26 001372   000000 235100                    LDA     0,,PR0
        26 001373   200131 755100                    STA     CUR_NODE,,AUTO

      771     2491    2       CALL ZII$FIND_IDX(TERM_NODE,N);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:116  

   2491 26 001374   200126 631500                    EPPR1   N,,AUTO
        26 001375   200207 451500                    STP1    DRFS$$+3,,AUTO
        26 001376   200120 236100                    LDQ     @TERM_NODE,,AUTO
        26 001377   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 001400   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 001401   000000 631400 27                 EPPR1   0
        26 001402   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 001403   000000 011000                    NOP     0

      772     2492    2       MAX_DIST=D_TABLE.DIST_FROM_PORT(N)+START_OF_BRANCH;

   2492 26 001404   200126 235100                    LDA     N,,AUTO
        26 001405   000002 735000                    ALS     2
        26 001406   000000 470400 7                  LDP0    D_TBL$
        26 001407   000000 236105                    LDQ     0,AL,PR0
        26 001410   777777 376007                    ANQ     -1,DL
        26 001411   200135 036100                    ADLQ    START_OF_BRANCH,,AUTO
        26 001412   200125 756100                    STQ     MAX_DIST,,AUTO

      773     2493    2       PATH_SLOTS_NEEDED=MAX_DIST;

   2493 26 001413   200134 756100                    STQ     PATH_SLOTS_NEEDED,,AUTO

      774     2494    2       CALL ZII$PATH_MEMORY(PATH_SLOTS_NEEDED,%GET) ALTRET(ER_COMMON);

   2494 26 001414   000005 236000 27                 LDQ     5
        26 001415   200207 756100                    STQ     DRFS$$+3,,AUTO
        26 001416   200134 631500                    EPPR1   PATH_SLOTS_NEEDED,,AUTO
        26 001417   200206 451500                    STP1    DRFS$$+2,,AUTO
        26 001420   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 001421   000000 631400 27                 EPPR1   0
        26 001422   000000 701000 xent               TSX1    ZII$PATH_MEMORY
        26 001423   002710 702000 26                 TSX2    ER_COMMON

      775     2495    2       PATH_LIST.REC_NO(MAX_DIST)=CUR_NODE;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:117  
   2495 26 001424   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001425   000005 402007                    MPY     5,DL
        26 001426   200131 720100                    LXL0    CUR_NODE,,AUTO
        26 001427   200014 470500                    LDP0    PATH$,,AUTO
        26 001430   000000 740106                    STX0    0,QL,PR0

      776     2496    2       REC_NO = REC_NO + 1;

   2496 26 001431   200015 235100                    LDA     REC_NO,,AUTO
        26 001432   000001 035007                    ADLA    1,DL
        26 001433   200015 755100                    STA     REC_NO,,AUTO

      777     2497    2       PATH_LIST.REC_NO(0)=REC_NO;

   2497 26 001434   000000 621005                    EAX1    0,AL
        26 001435   000000 741100                    STX1    0,,PR0

      778     2498    2       PATH_LIST.FIND_ATTEMPTED(MAX_DIST)='0'B;

   2498 26 001436   000000 620006                    EAX0    0,QL
        26 001437   000007 236000 27                 LDQ     7
        26 001440   000001 356110                    ANSQ    1,X0,PR0

      779     2499    2       PATH_LIST.GET_IND(MAX_DIST)='1'B;

   2499 26 001441   200000 236003                    LDQ     65536,DU
        26 001442   000001 256110                    ORSQ    1,X0,PR0

      780     2500    2       PATH_LIST.OWN_NEXT(MAX_DIST)='0'B;

   2500 26 001443   000006 236000 27                 LDQ     6
        26 001444   000001 356110                    ANSQ    1,X0,PR0

      781     2501    2       PATH_LIST.SET_NO(MAX_DIST)=0;

   2501 26 001445   000000 221003                    LDX1    0,DU
        26 001446   000000 441110                    SXL1    0,X0,PR0
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:118  

      782     2502    2       PATH_LIST.INIT_EPTR(MAX_DIST)=ENTADDR(NIL);

   2502 26 001447   000011 236000 27                 LDQ     9
        26 001450   000002 756110                    STQ     2,X0,PR0

      783     2503    2       PATH_LIST.CONVERT_EPTR(MAX_DIST)=ENTADDR(NIL);

   2503 26 001451   000003 756110                    STQ     3,X0,PR0

      784     2504    2       PATH_LIST.CONSTRAINT_EPTR(MAX_DIST)=ENTADDR(NIL);

   2504 26 001452   000004 756110                    STQ     4,X0,PR0

      785     2505    3       DO K=1 TO DISPLAY_LIST#;

   2505 26 001453   000001 235007                    LDA     1,DL
        26 001454   200123 755100                    STA     K,,AUTO
        26 001455   001505 710000 26                 TRA     s:2512+3

      786     2506    3           IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(MAX_DIST)

   2506 26 001456   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 001457   200123 720100                    LXL0    K,,AUTO
        26 001460   000000 721110                    LXL1    0,X0,PR0
        26 001461   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001462   000005 402007                    MPY     5,DL
        26 001463   200014 471500                    LDP1    PATH$,,AUTO
        26 001464   100000 101106                    CMPX1   0,QL,PR1
        26 001465   001502 601000 26                 TNZ     s:2512
        26 001466   000000 236110                    LDQ     0,X0,PR0
        26 001467   000777 376003                    ANQ     511,DU
        26 001470   000001 116003                    CMPQ    1,DU
        26 001471   001502 601000 26                 TNZ     s:2512

      787     2507    3              AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      788     2508    4           DO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:119  

      789     2509    4               PATH_LIST.DISPLAY_IND(MAX_DIST)='1'B;

   2509 26 001472   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001473   000005 402007                    MPY     5,DL
        26 001474   000000 622006                    EAX2    0,QL
        26 001475   010000 236003                    LDQ     4096,DU
        26 001476   100001 256112                    ORSQ    1,X2,PR1

      790     2510    4               K=DISPLAY_LIST#+1;

   2510 26 001477   200012 235100                    LDA     DISPLAY_LIST#,,AUTO
        26 001500   000001 035007                    ADLA    1,DL
        26 001501   200123 755100                    STA     K,,AUTO

      791     2511    4               END;

      792     2512    3           END;

   2512 26 001502   200123 235100                    LDA     K,,AUTO
        26 001503   000001 035007                    ADLA    1,DL
        26 001504   200123 755100                    STA     K,,AUTO
        26 001505   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 001506   200123 116100                    CMPQ    K,,AUTO
        26 001507   001456 603000 26                 TRC     s:2506

      793     2513    2       J=1;

   2513 26 001510   000001 235007                    LDA     1,DL
        26 001511   200124 755100                    STA     J,,AUTO

      794     2514    3       DO WHILE (J + START_OF_BRANCH < MAX_DIST);

   2514 26 001512   002337 710000 26                 TRA     s:2612

      795     2515    3           PATH_LIST.REC_NO(MAX_DIST-J)=0;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:120  
   2515 26 001513   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001514   200124 136100                    SBLQ    J,,AUTO
        26 001515   000005 402007                    MPY     5,DL
        26 001516   000000 220003                    LDX0    0,DU
        26 001517   200014 470500                    LDP0    PATH$,,AUTO
        26 001520   000000 740106                    STX0    0,QL,PR0

      796     2516    3           I=0;

   2516 26 001521   200122 450100                    STZ     I,,AUTO

      797     2517    4           DO WHILE (I<TBL_DIM);

   2517 26 001522   200122 236100                    LDQ     I,,AUTO
        26 001523   000000 116000 9                  CMPQ    TBL_DIM
        26 001524   002017 603000 26                 TRC     s:2561

      798     2518    4               IF D_TABLE.REC_NO(I)~=CUR_NODE AND

   2518 26 001525   200122 235100                    LDA     I,,AUTO
        26 001526   000002 735000                    ALS     2
        26 001527   000000 470400 7                  LDP0    D_TBL$
        26 001530   000000 236105                    LDQ     0,AL,PR0
        26 001531   000022 772000                    QRL     18
        26 001532   200131 116100                    CMPQ    CUR_NODE,,AUTO
        26 001533   002011 600000 26                 TZE     s:2559
        26 001534   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001535   200135 136100                    SBLQ    START_OF_BRANCH,,AUTO
        26 001536   200124 136100                    SBLQ    J,,AUTO
        26 001537   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 001540   000000 236105                    LDQ     0,AL,PR0
        26 001541   777777 376007                    ANQ     -1,DL
        26 001542   200206 116100                    CMPQ    DRFS$$+2,,AUTO
        26 001543   002011 601000 26                 TNZ     s:2559

      799     2519    4                  D_TABLE.DIST_FROM_PORT(I)=((MAX_DIST-START_OF_BRANCH)-J) THEN
      800     2520    5               DO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:121  

      801     2521    5                   TEMP_ARG=D_TABLE.REC_NO(I);

   2521 26 001544   000000 236105                    LDQ     0,AL,PR0
        26 001545   000022 772000                    QRL     18
        26 001546   200132 756100                    STQ     TEMP_ARG,,AUTO

      802     2522    5                   CALL ZII$FIND_D2_IDX(TEMP_ARG,CUR_NODE,X);

   2522 26 001547   200130 631500                    EPPR1   X,,AUTO
        26 001550   200210 451500                    STP1    DRFS$$+4,,AUTO
        26 001551   200131 633500                    EPPR3   CUR_NODE,,AUTO
        26 001552   200207 453500                    STP3    DRFS$$+3,,AUTO
        26 001553   200132 634500                    EPPR4   TEMP_ARG,,AUTO
        26 001554   200206 454500                    STP4    DRFS$$+2,,AUTO
        26 001555   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 001556   000024 631400 27                 EPPR1   20
        26 001557   000000 701000 xent               TSX1    ZII$FIND_D2_IDX
        26 001560   000000 011000                    NOP     0

      803     2523    5                   IF D2_TABLE.SET_IND(X)~=0 THEN

   2523 26 001561   200130 235100                    LDA     X,,AUTO
        26 001562   000001 735000                    ALS     1
        26 001563   000000 470400 8                  LDP0    D2_TBL$
        26 001564   000100 101505                    MRL     fill='000'O
        26 001565   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 001566   200206 000004                    ADSC9   DRFS$$+2,,AUTO           cn=0,n=4
        26 001567   200206 236100                    LDQ     DRFS$$+2,,AUTO
        26 001570   000000 116003                    CMPQ    0,DU
        26 001571   002011 600000 26                 TZE     s:2559

      804     2524    6                   DO;

      805     2525    6                       DS$=NAM1.DESC$(D2_TABLE.SET_IND(X));

   2525 26 001572   000100 101505                    MRL     fill='000'O
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:122  
        26 001573   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 001574   200206 000004                    ADSC9   DRFS$$+2,,AUTO           cn=0,n=4
        26 001575   200206 236100                    LDQ     DRFS$$+2,,AUTO
        26 001576   000012 402007                    MPY     10,DL
        26 001577   000000 471400 10                 LDP1    NAM1$
        26 001600   100011 236106                    LDQ     9,QL,PR1
        26 001601   000000 756000 18                 STQ     DS$

      806     2526    6                       IF SET.OWNER_IDX=CUR_NODE THEN

   2526 26 001602   000000 473400 18                 LDP3    DS$
        26 001603   300001 236100                    LDQ     1,,PR3
        26 001604   000022 772000                    QRL     18
        26 001605   200131 116100                    CMPQ    CUR_NODE,,AUTO
        26 001606   002011 601000 26                 TNZ     s:2559

      807     2527    7                       DO;

      808     2528    7                           SET_NO = D2_TABLE.SET_IND(X);

   2528 26 001607   200130 235100                    LDA     X,,AUTO
        26 001610   000001 735000                    ALS     1
        26 001611   000100 101505                    MRL     fill='000'O
        26 001612   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 001613   200140 000004                    ADSC9   SET_NO,,AUTO             cn=0,n=4

      809     2529    7                           CALL MEMBER_SET(SET_NO,MEMBER_LIST);

   2529 26 001614   200070 634500                    EPPR4   MEMBER_LIST,,AUTO
        26 001615   200202 454500                    STP4    @SET_NO+1,,AUTO
        26 001616   200140 635500                    EPPR5   SET_NO,,AUTO
        26 001617   200201 455500                    STP5    J+2,,AUTO
        26 001620   003766 701000 26                 TSX1    MEMBER_SET
        26 001621   000000 011000                    NOP     0

      810     2530    7                           IF MEMBER_LIST.REC_NO(0) > 1 THEN

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:123  
   2530 26 001622   200070 220100                    LDX0    MEMBER_LIST,,AUTO
        26 001623   000002 100003                    CMPX0   2,DU
        26 001624   001635 602000 26                 TNC     s:2532

      811     2531    7                               CALL PICK_A_MEMBER(MEMBER_LIST,TEMP_ARG);

   2531 26 001625   000012 236000 27                 LDQ     10
        26 001626   200145 756100                    STQ     @OUT_FLG,,AUTO
        26 001627   200132 630500                    EPPR0   TEMP_ARG,,AUTO
        26 001630   200144 450500                    STP0    @IN_TBL,,AUTO
        26 001631   200070 631500                    EPPR1   MEMBER_LIST,,AUTO
        26 001632   200143 451500                    STP1    @REC_IDX,,AUTO
        26 001633   004040 701000 26                 TSX1    PICK_A_MEMBER
        26 001634   000000 011000                    NOP     0

      812     2532    7                           PATH_LIST.REC_NO(MAX_DIST-J)=TEMP_ARG;

   2532 26 001635   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001636   200124 136100                    SBLQ    J,,AUTO
        26 001637   000005 402007                    MPY     5,DL
        26 001640   200132 720100                    LXL0    TEMP_ARG,,AUTO
        26 001641   200014 470500                    LDP0    PATH$,,AUTO
        26 001642   000000 740106                    STX0    0,QL,PR0

      813     2533    7                           PATH_LIST.SET_NO(MAX_DIST-J)=SET.NAM_IDX;

   2533 26 001643   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001644   200124 136100                    SBLQ    J,,AUTO
        26 001645   000005 402007                    MPY     5,DL
        26 001646   000000 471400 18                 LDP1    DS$
        26 001647   100000 220100                    LDX0    0,,PR1
        26 001650   000000 440106                    SXL0    0,QL,PR0

      814     2534    7                           CALL MEMBER_TBL(TEMP_ARG,TDISPLAY_LIST,MEM_FLG);

   2534 26 001651   200133 631500                    EPPR1   MEM_FLG,,AUTO
        26 001652   200145 451500                    STP1    @OUT_FLG,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:124  
        26 001653   000000 236000 0                  LDQ     ZII$COMMON$
        26 001654   200144 756100                    STQ     @IN_TBL,,AUTO
        26 001655   200132 633500                    EPPR3   TEMP_ARG,,AUTO
        26 001656   200143 453500                    STP3    @REC_IDX,,AUTO
        26 001657   001270 701000 26                 TSX1    MEMBER_TBL
        26 001660   000000 011000                    NOP     0

      815     2535    7                           IF MEM_FLG=1 THEN

   2535 26 001661   200133 235100                    LDA     MEM_FLG,,AUTO
        26 001662   000001 115007                    CMPA    1,DL
        26 001663   001674 601000 26                 TNZ     s:2538

      816     2536    7                               PATH_LIST.GET_IND(MAX_DIST-J)='1'B;

   2536 26 001664   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001665   200124 136100                    SBLQ    J,,AUTO
        26 001666   000005 402007                    MPY     5,DL
        26 001667   200014 470500                    LDP0    PATH$,,AUTO
        26 001670   000000 620006                    EAX0    0,QL
        26 001671   200000 236003                    LDQ     65536,DU
        26 001672   000001 256110                    ORSQ    1,X0,PR0
        26 001673   001703 710000 26                 TRA     s:2539

      817     2537    7                           ELSE
      818     2538    7                               PATH_LIST.GET_IND(MAX_DIST-J)='0'B;

   2538 26 001674   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001675   200124 136100                    SBLQ    J,,AUTO
        26 001676   000005 402007                    MPY     5,DL
        26 001677   200014 470500                    LDP0    PATH$,,AUTO
        26 001700   000000 620006                    EAX0    0,QL
        26 001701   000025 236000 27                 LDQ     21
        26 001702   000001 356110                    ANSQ    1,X0,PR0

      819     2539    7                           PATH_LIST.OWN_NEXT(MAX_DIST-J)='1'B;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:125  
   2539 26 001703   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001704   200124 136100                    SBLQ    J,,AUTO
        26 001705   000005 402007                    MPY     5,DL
        26 001706   000000 620006                    EAX0    0,QL
        26 001707   400000 236003                    LDQ     -131072,DU
        26 001710   000001 256110                    ORSQ    1,X0,PR0

      820     2540    7                           PATH_LIST.FIND_ATTEMPTED(MAX_DIST-J)='0'B;

   2540 26 001711   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001712   200124 136100                    SBLQ    J,,AUTO
        26 001713   000005 402007                    MPY     5,DL
        26 001714   000000 620006                    EAX0    0,QL
        26 001715   000007 236000 27                 LDQ     7
        26 001716   000001 356110                    ANSQ    1,X0,PR0

      821     2541    7                           PATH_LIST.INIT_EPTR(MAX_DIST-J)=ENTADDR(NIL);

   2541 26 001717   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001720   200124 136100                    SBLQ    J,,AUTO
        26 001721   000005 402007                    MPY     5,DL
        26 001722   000000 620006                    EAX0    0,QL
        26 001723   000011 236000 27                 LDQ     9
        26 001724   000002 756110                    STQ     2,X0,PR0

      822     2542    7                           PATH_LIST.CONVERT_EPTR(MAX_DIST-J)=ENTADDR(NIL);

   2542 26 001725   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001726   200124 136100                    SBLQ    J,,AUTO
        26 001727   000005 402007                    MPY     5,DL
        26 001730   000000 620006                    EAX0    0,QL
        26 001731   000011 236000 27                 LDQ     9
        26 001732   000003 756110                    STQ     3,X0,PR0

      823     2543    7                           PATH_LIST.CONSTRAINT_EPTR(MAX_DIST-J)=ENTADDR(NIL);

   2543 26 001733   200125 236100                    LDQ     MAX_DIST,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:126  
        26 001734   200124 136100                    SBLQ    J,,AUTO
        26 001735   000005 402007                    MPY     5,DL
        26 001736   000000 620006                    EAX0    0,QL
        26 001737   000011 236000 27                 LDQ     9
        26 001740   000004 756110                    STQ     4,X0,PR0

      824     2544    7                           REC_NO = REC_NO + 1;

   2544 26 001741   200015 235100                    LDA     REC_NO,,AUTO
        26 001742   000001 035007                    ADLA    1,DL
        26 001743   200015 755100                    STA     REC_NO,,AUTO

      825     2545    7                           PATH_LIST.REC_NO(0)=REC_NO;

   2545 26 001744   000000 620005                    EAX0    0,AL
        26 001745   000000 740100                    STX0    0,,PR0

      826     2546    8                           DO K=1 TO DISPLAY_LIST#;

   2546 26 001746   000001 235007                    LDA     1,DL
        26 001747   200123 755100                    STA     K,,AUTO
        26 001750   002002 710000 26                 TRA     s:2553+3

      827     2547    8                              IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(MAX_DIST-J)

   2547 26 001751   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001752   200124 136100                    SBLQ    J,,AUTO
        26 001753   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 001754   200123 720100                    LXL0    K,,AUTO
        26 001755   000000 721110                    LXL1    0,X0,PR0
        26 001756   000005 402007                    MPY     5,DL
        26 001757   200014 471500                    LDP1    PATH$,,AUTO
        26 001760   100000 101106                    CMPX1   0,QL,PR1
        26 001761   001777 601000 26                 TNZ     s:2553
        26 001762   000000 236110                    LDQ     0,X0,PR0
        26 001763   000777 376003                    ANQ     511,DU
        26 001764   000001 116003                    CMPQ    1,DU
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:127  
        26 001765   001777 601000 26                 TNZ     s:2553

      828     2548    8                                  AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      829     2549    9                               DO;

      830     2550    9                                   PATH_LIST.DISPLAY_IND(MAX_DIST-J)='1'B;

   2550 26 001766   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 001767   200124 136100                    SBLQ    J,,AUTO
        26 001770   000005 402007                    MPY     5,DL
        26 001771   000000 622006                    EAX2    0,QL
        26 001772   010000 236003                    LDQ     4096,DU
        26 001773   100001 256112                    ORSQ    1,X2,PR1

      831     2551    9                                   K=DISPLAY_LIST#+1;

   2551 26 001774   200012 235100                    LDA     DISPLAY_LIST#,,AUTO
        26 001775   000001 035007                    ADLA    1,DL
        26 001776   200123 755100                    STA     K,,AUTO

      832     2552    9                                   END;

      833     2553    8                               END;

   2553 26 001777   200123 235100                    LDA     K,,AUTO
        26 002000   000001 035007                    ADLA    1,DL
        26 002001   200123 755100                    STA     K,,AUTO
        26 002002   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 002003   200123 116100                    CMPQ    K,,AUTO
        26 002004   001751 603000 26                 TRC     s:2547

      834     2554    7                           CUR_NODE=TEMP_ARG;

   2554 26 002005   200132 235100                    LDA     TEMP_ARG,,AUTO
        26 002006   200131 755100                    STA     CUR_NODE,,AUTO

      835     2555    7                           I = TBL_DIM;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:128  

   2555 26 002007   000000 235000 9                  LDA     TBL_DIM
        26 002010   200122 755100                    STA     I,,AUTO

      836     2556    7                           END;

      837     2557    6                       END;

      838     2558    5                   END;

      839     2559    4               I=I+1;

   2559 26 002011   200122 235100                    LDA     I,,AUTO
        26 002012   000001 035007                    ADLA    1,DL
        26 002013   200122 755100                    STA     I,,AUTO

      840     2560    4               END;

   2560 26 002014   200122 236100                    LDQ     I,,AUTO
        26 002015   000000 116000 9                  CMPQ    TBL_DIM
        26 002016   001525 602000 26                 TNC     s:2518

      841     2561    3           IF PATH_LIST.REC_NO(MAX_DIST-J)=0 THEN

   2561 26 002017   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002020   200124 136100                    SBLQ    J,,AUTO
        26 002021   000005 402007                    MPY     5,DL
        26 002022   200014 470500                    LDP0    PATH$,,AUTO
        26 002023   000000 220106                    LDX0    0,QL,PR0
        26 002024   002334 601000 26                 TNZ     s:2611

      842     2562    4           DO;

      843     2563    4               I=0;

   2563 26 002025   200122 450100                    STZ     I,,AUTO

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:129  
      844     2564    5               DO WHILE (I<TBL_DIM);

   2564 26 002026   200122 236100                    LDQ     I,,AUTO
        26 002027   000000 116000 9                  CMPQ    TBL_DIM
        26 002030   002334 603000 26                 TRC     s:2611

      845     2565    5                   IF D_TABLE.DIST_FROM_PORT(I)=((MAX_DIST-START_OF_BRANCH)-J) THEN

   2565 26 002031   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002032   200135 136100                    SBLQ    START_OF_BRANCH,,AUTO
        26 002033   200124 136100                    SBLQ    J,,AUTO
        26 002034   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 002035   200122 235100                    LDA     I,,AUTO
        26 002036   000002 735000                    ALS     2
        26 002037   000000 470400 7                  LDP0    D_TBL$
        26 002040   000000 236105                    LDQ     0,AL,PR0
        26 002041   777777 376007                    ANQ     -1,DL
        26 002042   200206 116100                    CMPQ    DRFS$$+2,,AUTO
        26 002043   002326 601000 26                 TNZ     s:2608

      846     2566    6                   DO;

      847     2567    6                       TEMP_ARG=D_TABLE.REC_NO(I);

   2567 26 002044   000000 236105                    LDQ     0,AL,PR0
        26 002045   000022 772000                    QRL     18
        26 002046   200132 756100                    STQ     TEMP_ARG,,AUTO

      848     2568    6                       CALL ZII$FIND_D2_IDX(CUR_NODE,TEMP_ARG,X);

   2568 26 002047   200130 631500                    EPPR1   X,,AUTO
        26 002050   200210 451500                    STP1    DRFS$$+4,,AUTO
        26 002051   200132 633500                    EPPR3   TEMP_ARG,,AUTO
        26 002052   200207 453500                    STP3    DRFS$$+3,,AUTO
        26 002053   200131 634500                    EPPR4   CUR_NODE,,AUTO
        26 002054   200206 454500                    STP4    DRFS$$+2,,AUTO
        26 002055   200206 630500                    EPPR0   DRFS$$+2,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:130  
        26 002056   000024 631400 27                 EPPR1   20
        26 002057   000000 701000 xent               TSX1    ZII$FIND_D2_IDX
        26 002060   000000 011000                    NOP     0

      849     2569    6                       IF D2_TABLE.SET_IND(X)~=0 THEN

   2569 26 002061   200130 235100                    LDA     X,,AUTO
        26 002062   000001 735000                    ALS     1
        26 002063   000000 470400 8                  LDP0    D2_TBL$
        26 002064   000100 101505                    MRL     fill='000'O
        26 002065   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 002066   200206 000004                    ADSC9   DRFS$$+2,,AUTO           cn=0,n=4
        26 002067   200206 236100                    LDQ     DRFS$$+2,,AUTO
        26 002070   000000 116003                    CMPQ    0,DU
        26 002071   002326 600000 26                 TZE     s:2608

      850     2570    7                       DO;

      851     2571    7                           DS$=NAM1.DESC$(D2_TABLE.SET_IND(X));

   2571 26 002072   000100 101505                    MRL     fill='000'O
        26 002073   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 002074   200206 000004                    ADSC9   DRFS$$+2,,AUTO           cn=0,n=4
        26 002075   200206 236100                    LDQ     DRFS$$+2,,AUTO
        26 002076   000012 402007                    MPY     10,DL
        26 002077   000000 471400 10                 LDP1    NAM1$
        26 002100   100011 236106                    LDQ     9,QL,PR1
        26 002101   000000 756000 18                 STQ     DS$

      852     2572    7                           IF SET.OWNER_IDX=CUR_NODE THEN

   2572 26 002102   000000 473400 18                 LDP3    DS$
        26 002103   300001 236100                    LDQ     1,,PR3
        26 002104   000022 772000                    QRL     18
        26 002105   200131 116100                    CMPQ    CUR_NODE,,AUTO
        26 002106   002145 601000 26                 TNZ     s:2581

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:131  
      853     2573    8                           DO;

      854     2574    8                               SET_NO = D2_TABLE.SET_IND(X);

   2574 26 002107   200130 235100                    LDA     X,,AUTO
        26 002110   000001 735000                    ALS     1
        26 002111   000100 101505                    MRL     fill='000'O
        26 002112   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 002113   200140 000004                    ADSC9   SET_NO,,AUTO             cn=0,n=4

      855     2575    8                               CALL MEMBER_SET(SET_NO,MEMBER_LIST);

   2575 26 002114   200070 634500                    EPPR4   MEMBER_LIST,,AUTO
        26 002115   200202 454500                    STP4    @SET_NO+1,,AUTO
        26 002116   200140 635500                    EPPR5   SET_NO,,AUTO
        26 002117   200201 455500                    STP5    J+2,,AUTO
        26 002120   003766 701000 26                 TSX1    MEMBER_SET
        26 002121   000000 011000                    NOP     0

      856     2576    8                               IF MEMBER_LIST.REC_NO(0) > 1 THEN

   2576 26 002122   200070 220100                    LDX0    MEMBER_LIST,,AUTO
        26 002123   000002 100003                    CMPX0   2,DU
        26 002124   002135 602000 26                 TNC     s:2578

      857     2577    8                                   CALL PICK_A_MEMBER(MEMBER_LIST,TEMP_ARG);

   2577 26 002125   000012 236000 27                 LDQ     10
        26 002126   200145 756100                    STQ     @OUT_FLG,,AUTO
        26 002127   200132 630500                    EPPR0   TEMP_ARG,,AUTO
        26 002130   200144 450500                    STP0    @IN_TBL,,AUTO
        26 002131   200070 631500                    EPPR1   MEMBER_LIST,,AUTO
        26 002132   200143 451500                    STP1    @REC_IDX,,AUTO
        26 002133   004040 701000 26                 TSX1    PICK_A_MEMBER
        26 002134   000000 011000                    NOP     0

      858     2578    8                               PATH_LIST.OWN_NEXT(MAX_DIST-J)='1'B;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:132  

   2578 26 002135   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002136   200124 136100                    SBLQ    J,,AUTO
        26 002137   000005 402007                    MPY     5,DL
        26 002140   200014 470500                    LDP0    PATH$,,AUTO
        26 002141   000000 620006                    EAX0    0,QL
        26 002142   400000 236003                    LDQ     -131072,DU
        26 002143   000001 256110                    ORSQ    1,X0,PR0

      859     2579    8                               END;

   2579 26 002144   002154 710000 26                 TRA     s:2582

      860     2580    7                           ELSE
      861     2581    7                               PATH_LIST.OWN_NEXT(MAX_DIST-J)='0'B;

   2581 26 002145   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002146   200124 136100                    SBLQ    J,,AUTO
        26 002147   000005 402007                    MPY     5,DL
        26 002150   200014 474500                    LDP4    PATH$,,AUTO
        26 002151   000000 620006                    EAX0    0,QL
        26 002152   000006 236000 27                 LDQ     6
        26 002153   400001 356110                    ANSQ    1,X0,PR4

      862     2582    7                           PATH_LIST.REC_NO(MAX_DIST-J)=TEMP_ARG;

   2582 26 002154   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002155   200124 136100                    SBLQ    J,,AUTO
        26 002156   000005 402007                    MPY     5,DL
        26 002157   200132 720100                    LXL0    TEMP_ARG,,AUTO
        26 002160   200014 470500                    LDP0    PATH$,,AUTO
        26 002161   000000 740106                    STX0    0,QL,PR0

      863     2583    7                           PATH_LIST.SET_NO(MAX_DIST-J)=D2_TABLE.SET_IND(X);

   2583 26 002162   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002163   200124 136100                    SBLQ    J,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:133  
        26 002164   000005 402007                    MPY     5,DL
        26 002165   200130 235100                    LDA     X,,AUTO
        26 002166   000001 735000                    ALS     1
        26 002167   000002 736000                    QLS     2
        26 002170   000000 471400 8                  LDP1    D2_TBL$
        26 002171   000106 100505                    MLR     fill='000'O
        26 002172   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2
        26 002173   000000 400002                    ADSC9   0,Q,PR0                  cn=2,n=2

      864     2584    7                           CALL MEMBER_TBL(TEMP_ARG,

   2584 26 002174   200133 631500                    EPPR1   MEM_FLG,,AUTO
        26 002175   200145 451500                    STP1    @OUT_FLG,,AUTO
        26 002176   000000 236000 0                  LDQ     ZII$COMMON$
        26 002177   200144 756100                    STQ     @IN_TBL,,AUTO
        26 002200   200132 633500                    EPPR3   TEMP_ARG,,AUTO
        26 002201   200143 453500                    STP3    @REC_IDX,,AUTO
        26 002202   001270 701000 26                 TSX1    MEMBER_TBL
        26 002203   000000 011000                    NOP     0

      865     2585    7                              TDISPLAY_LIST,MEM_FLG);
      866     2586    7                           IF MEM_FLG=1 THEN

   2586 26 002204   200133 235100                    LDA     MEM_FLG,,AUTO
        26 002205   000001 115007                    CMPA    1,DL
        26 002206   002217 601000 26                 TNZ     s:2589

      867     2587    7                               PATH_LIST.GET_IND(MAX_DIST-J)='1'B;

   2587 26 002207   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002210   200124 136100                    SBLQ    J,,AUTO
        26 002211   000005 402007                    MPY     5,DL
        26 002212   200014 470500                    LDP0    PATH$,,AUTO
        26 002213   000000 620006                    EAX0    0,QL
        26 002214   200000 236003                    LDQ     65536,DU
        26 002215   000001 256110                    ORSQ    1,X0,PR0
        26 002216   002226 710000 26                 TRA     s:2590
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:134  

      868     2588    7                           ELSE
      869     2589    7                               PATH_LIST.GET_IND(MAX_DIST-J)='0'B;

   2589 26 002217   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002220   200124 136100                    SBLQ    J,,AUTO
        26 002221   000005 402007                    MPY     5,DL
        26 002222   200014 470500                    LDP0    PATH$,,AUTO
        26 002223   000000 620006                    EAX0    0,QL
        26 002224   000025 236000 27                 LDQ     21
        26 002225   000001 356110                    ANSQ    1,X0,PR0

      870     2590    7                           PATH_LIST.FIND_ATTEMPTED(MAX_DIST-J)='0'B;

   2590 26 002226   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002227   200124 136100                    SBLQ    J,,AUTO
        26 002230   000005 402007                    MPY     5,DL
        26 002231   000000 620006                    EAX0    0,QL
        26 002232   000007 236000 27                 LDQ     7
        26 002233   000001 356110                    ANSQ    1,X0,PR0

      871     2591    7                           PATH_LIST.INIT_EPTR(MAX_DIST-J)=ENTADDR(NIL);

   2591 26 002234   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002235   200124 136100                    SBLQ    J,,AUTO
        26 002236   000005 402007                    MPY     5,DL
        26 002237   000000 620006                    EAX0    0,QL
        26 002240   000011 236000 27                 LDQ     9
        26 002241   000002 756110                    STQ     2,X0,PR0

      872     2592    7                           PATH_LIST.CONVERT_EPTR(MAX_DIST-J)=ENTADDR(NIL);

   2592 26 002242   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002243   200124 136100                    SBLQ    J,,AUTO
        26 002244   000005 402007                    MPY     5,DL
        26 002245   000000 620006                    EAX0    0,QL
        26 002246   000011 236000 27                 LDQ     9
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:135  
        26 002247   000003 756110                    STQ     3,X0,PR0

      873     2593    7                           PATH_LIST.CONSTRAINT_EPTR(MAX_DIST-J)=ENTADDR(NIL);

   2593 26 002250   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002251   200124 136100                    SBLQ    J,,AUTO
        26 002252   000005 402007                    MPY     5,DL
        26 002253   000000 620006                    EAX0    0,QL
        26 002254   000011 236000 27                 LDQ     9
        26 002255   000004 756110                    STQ     4,X0,PR0

      874     2594    7                           REC_NO = REC_NO + 1;

   2594 26 002256   200015 235100                    LDA     REC_NO,,AUTO
        26 002257   000001 035007                    ADLA    1,DL
        26 002260   200015 755100                    STA     REC_NO,,AUTO

      875     2595    7                           PATH_LIST.REC_NO(0)=REC_NO;

   2595 26 002261   000000 620005                    EAX0    0,AL
        26 002262   000000 740100                    STX0    0,,PR0

      876     2596    8                           DO K=1 TO DISPLAY_LIST#;

   2596 26 002263   000001 235007                    LDA     1,DL
        26 002264   200123 755100                    STA     K,,AUTO
        26 002265   002317 710000 26                 TRA     s:2603+3

      877     2597    8                              IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(MAX_DIST-J)

   2597 26 002266   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002267   200124 136100                    SBLQ    J,,AUTO
        26 002270   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 002271   200123 720100                    LXL0    K,,AUTO
        26 002272   000000 721110                    LXL1    0,X0,PR0
        26 002273   000005 402007                    MPY     5,DL
        26 002274   200014 471500                    LDP1    PATH$,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:136  
        26 002275   100000 101106                    CMPX1   0,QL,PR1
        26 002276   002314 601000 26                 TNZ     s:2603
        26 002277   000000 236110                    LDQ     0,X0,PR0
        26 002300   000777 376003                    ANQ     511,DU
        26 002301   000001 116003                    CMPQ    1,DU
        26 002302   002314 601000 26                 TNZ     s:2603

      878     2598    8                                  AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      879     2599    9                               DO;

      880     2600    9                                   PATH_LIST.DISPLAY_IND(MAX_DIST-J)='1'B;

   2600 26 002303   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002304   200124 136100                    SBLQ    J,,AUTO
        26 002305   000005 402007                    MPY     5,DL
        26 002306   000000 622006                    EAX2    0,QL
        26 002307   010000 236003                    LDQ     4096,DU
        26 002310   100001 256112                    ORSQ    1,X2,PR1

      881     2601    9                                   K=DISPLAY_LIST#+1;

   2601 26 002311   200012 235100                    LDA     DISPLAY_LIST#,,AUTO
        26 002312   000001 035007                    ADLA    1,DL
        26 002313   200123 755100                    STA     K,,AUTO

      882     2602    9                                   END;

      883     2603    8                               END;

   2603 26 002314   200123 235100                    LDA     K,,AUTO
        26 002315   000001 035007                    ADLA    1,DL
        26 002316   200123 755100                    STA     K,,AUTO
        26 002317   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 002320   200123 116100                    CMPQ    K,,AUTO
        26 002321   002266 603000 26                 TRC     s:2597

      884     2604    7                           CUR_NODE=TEMP_ARG;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:137  

   2604 26 002322   200132 235100                    LDA     TEMP_ARG,,AUTO
        26 002323   200131 755100                    STA     CUR_NODE,,AUTO

      885     2605    7                           I=TBL_DIM;

   2605 26 002324   000000 235000 9                  LDA     TBL_DIM
        26 002325   200122 755100                    STA     I,,AUTO

      886     2606    7                           END;

      887     2607    6                       END;

      888     2608    5                   I=I+1;

   2608 26 002326   200122 235100                    LDA     I,,AUTO
        26 002327   000001 035007                    ADLA    1,DL
        26 002330   200122 755100                    STA     I,,AUTO

      889     2609    5                   END;

   2609 26 002331   200122 236100                    LDQ     I,,AUTO
        26 002332   000000 116000 9                  CMPQ    TBL_DIM
        26 002333   002031 602000 26                 TNC     s:2565

      890     2610    4               END;

      891     2611    3           J=J+1;

   2611 26 002334   200124 235100                    LDA     J,,AUTO
        26 002335   000001 035007                    ADLA    1,DL
        26 002336   200124 755100                    STA     J,,AUTO

      892     2612    3           END;

   2612 26 002337   200124 236100                    LDQ     J,,AUTO
        26 002340   200135 036100                    ADLQ    START_OF_BRANCH,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:138  
        26 002341   200125 116100                    CMPQ    MAX_DIST,,AUTO
        26 002342   001513 602000 26                 TNC     s:2515

      893     2613    2       CALL ZII$FIND_IDX(START_NODE,N);

   2613 26 002343   200126 630500                    EPPR0   N,,AUTO
        26 002344   200207 450500                    STP0    DRFS$$+3,,AUTO
        26 002345   200117 236100                    LDQ     @START_NODE,,AUTO
        26 002346   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 002347   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 002350   000000 631400 27                 EPPR1   0
        26 002351   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 002352   000000 011000                    NOP     0

      894     2614    2       PATH_LIST.REC_NO(START_OF_BRANCH)=START_NODE;

   2614 26 002353   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
        26 002354   000005 402007                    MPY     5,DL
        26 002355   200117 470500                    LDP0    @START_NODE,,AUTO
        26 002356   000000 720100                    LXL0    0,,PR0
        26 002357   200014 471500                    LDP1    PATH$,,AUTO
        26 002360   100000 740106                    STX0    0,QL,PR1

      895     2615    2       IF START_OF_BRANCH>1 THEN

   2615 26 002361   200135 235100                    LDA     START_OF_BRANCH,,AUTO
        26 002362   000002 115007                    CMPA    2,DL
        26 002363   002367 602000 26                 TNC     s:2617

      896     2616    2           REC_NO = REC_NO + 1;

   2616 26 002364   200015 235100                    LDA     REC_NO,,AUTO
        26 002365   000001 035007                    ADLA    1,DL
        26 002366   200015 755100                    STA     REC_NO,,AUTO

      897     2617    2       PATH_LIST.REC_NO(0)=REC_NO;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:139  
   2617 26 002367   200015 721100                    LXL1    REC_NO,,AUTO
        26 002370   100000 741100                    STX1    0,,PR1

      898     2618    2       TEMP_ARG=PATH_LIST.REC_NO(START_OF_BRANCH+1);

   2618 26 002371   100005 236106                    LDQ     5,QL,PR1
        26 002372   000022 772000                    QRL     18
        26 002373   200132 756100                    STQ     TEMP_ARG,,AUTO

      899     2619    2       CALL ZII$FIND_D2_IDX(START_NODE,TEMP_ARG,X);

   2619 26 002374   200130 633500                    EPPR3   X,,AUTO
        26 002375   200210 453500                    STP3    DRFS$$+4,,AUTO
        26 002376   200132 634500                    EPPR4   TEMP_ARG,,AUTO
        26 002377   200207 454500                    STP4    DRFS$$+3,,AUTO
        26 002400   200117 236100                    LDQ     @START_NODE,,AUTO
        26 002401   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 002402   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 002403   000024 631400 27                 EPPR1   20
        26 002404   000000 701000 xent               TSX1    ZII$FIND_D2_IDX
        26 002405   000000 011000                    NOP     0

      900     2620    2       PATH_LIST.SET_NO(START_OF_BRANCH)=D2_TABLE.SET_IND(X);

   2620 26 002406   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
        26 002407   000005 402007                    MPY     5,DL
        26 002410   200130 235100                    LDA     X,,AUTO
        26 002411   000001 735000                    ALS     1
        26 002412   000002 736000                    QLS     2
        26 002413   000000 470400 8                  LDP0    D2_TBL$
        26 002414   200014 471500                    LDP1    PATH$,,AUTO
        26 002415   000106 100505                    MLR     fill='000'O
        26 002416   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 002417   100000 400002                    ADSC9   0,Q,PR1                  cn=2,n=2

      901     2621    2       DS$=NAM1.DESC$(D2_TABLE.SET_IND(X));

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:140  
   2621 26 002420   200130 235100                    LDA     X,,AUTO
        26 002421   000001 735000                    ALS     1
        26 002422   000000 470400 8                  LDP0    D2_TBL$
        26 002423   000100 101505                    MRL     fill='000'O
        26 002424   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 002425   200206 000004                    ADSC9   DRFS$$+2,,AUTO           cn=0,n=4
        26 002426   200206 236100                    LDQ     DRFS$$+2,,AUTO
        26 002427   000012 402007                    MPY     10,DL
        26 002430   000000 473400 10                 LDP3    NAM1$
        26 002431   300011 236106                    LDQ     9,QL,PR3
        26 002432   000000 756000 18                 STQ     DS$

      902     2622    2       IF SET.OWNER_IDX=START_NODE THEN

   2622 26 002433   200117 474500                    LDP4    @START_NODE,,AUTO
        26 002434   000000 475400 18                 LDP5    DS$
        26 002435   500001 236100                    LDQ     1,,PR5
        26 002436   000022 772000                    QRL     18
        26 002437   400000 116100                    CMPQ    0,,PR4
        26 002440   002447 601000 26                 TNZ     s:2625

      903     2623    2           PATH_LIST.OWN_NEXT(START_OF_BRANCH)='0'B;

   2623 26 002441   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
        26 002442   000005 402007                    MPY     5,DL
        26 002443   000000 620006                    EAX0    0,QL
        26 002444   000006 236000 27                 LDQ     6
        26 002445   100001 356110                    ANSQ    1,X0,PR1
        26 002446   002454 710000 26                 TRA     s:2626

      904     2624    2       ELSE
      905     2625    2           PATH_LIST.OWN_NEXT(START_OF_BRANCH)='1'B;

   2625 26 002447   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
        26 002450   000005 402007                    MPY     5,DL
        26 002451   000000 620006                    EAX0    0,QL
        26 002452   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:141  
        26 002453   100001 256110                    ORSQ    1,X0,PR1

      906     2626    2       PATH_LIST.GET_IND(START_OF_BRANCH)='1'B;

   2626 26 002454   200000 236003                    LDQ     65536,DU
        26 002455   100001 256110                    ORSQ    1,X0,PR1

      907     2627    2       PATH_LIST.FIND_ATTEMPTED(START_OF_BRANCH)='0'B;

   2627 26 002456   000007 236000 27                 LDQ     7
        26 002457   100001 356110                    ANSQ    1,X0,PR1

      908     2628    2       PATH_LIST.INIT_EPTR(START_OF_BRANCH)=ENTADDR(NIL);

   2628 26 002460   000011 236000 27                 LDQ     9
        26 002461   100002 756110                    STQ     2,X0,PR1

      909     2629    2       PATH_LIST.CONVERT_EPTR(START_OF_BRANCH)=ENTADDR(NIL);

   2629 26 002462   100003 756110                    STQ     3,X0,PR1

      910     2630    2       PATH_LIST.CONSTRAINT_EPTR(START_OF_BRANCH)=ENTADDR(NIL);

   2630 26 002463   100004 756110                    STQ     4,X0,PR1

      911     2631    3       DO K=1 TO DISPLAY_LIST#;

   2631 26 002464   000001 235007                    LDA     1,DL
        26 002465   200123 755100                    STA     K,,AUTO
        26 002466   002516 710000 26                 TRA     s:2638+3

      912     2632    3           IF DISPLAY_LIST.REC_NO(K) = PATH_LIST.REC_NO(START_OF_BRANCH)

   2632 26 002467   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 002470   200123 720100                    LXL0    K,,AUTO
        26 002471   000000 721110                    LXL1    0,X0,PR0
        26 002472   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:142  
        26 002473   000005 402007                    MPY     5,DL
        26 002474   200014 471500                    LDP1    PATH$,,AUTO
        26 002475   100000 101106                    CMPX1   0,QL,PR1
        26 002476   002513 601000 26                 TNZ     s:2638
        26 002477   000000 236110                    LDQ     0,X0,PR0
        26 002500   000777 376003                    ANQ     511,DU
        26 002501   000001 116003                    CMPQ    1,DU
        26 002502   002513 601000 26                 TNZ     s:2638

      913     2633    3              AND DISPLAY_LIST.IND.DISPLAY(K) = 1 THEN
      914     2634    4           DO;

      915     2635    4               PATH_LIST.DISPLAY_IND(START_OF_BRANCH)='1'B;

   2635 26 002503   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
        26 002504   000005 402007                    MPY     5,DL
        26 002505   000000 622006                    EAX2    0,QL
        26 002506   010000 236003                    LDQ     4096,DU
        26 002507   100001 256112                    ORSQ    1,X2,PR1

      916     2636    4               K=DISPLAY_LIST#+1;

   2636 26 002510   200012 235100                    LDA     DISPLAY_LIST#,,AUTO
        26 002511   000001 035007                    ADLA    1,DL
        26 002512   200123 755100                    STA     K,,AUTO

      917     2637    4               END;

      918     2638    3           END;

   2638 26 002513   200123 235100                    LDA     K,,AUTO
        26 002514   000001 035007                    ADLA    1,DL
        26 002515   200123 755100                    STA     K,,AUTO
        26 002516   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 002517   200123 116100                    CMPQ    K,,AUTO
        26 002520   002467 603000 26                 TRC     s:2632

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:143  
      919     2639    2       DID_I = '1'B;

   2639 26 002521   400000 236003                    LDQ     -131072,DU
        26 002522   200121 470500                    LDP0    @DID_I,,AUTO
        26 002523   000000 756100                    STQ     0,,PR0

      920     2640        /*
      921     2641          It's only necessary to see if the new branch is bad if (1) there
      922     2642          was a via list to begin with and (2) the branch just built
      923     2643          contains more than just the start node and terminal node. We know
      924     2644          the terminal node can't be also in any previous branches or it would
      925     2645          never been chosen as the terminal node. We also know that the start
      926     2646          node is not a problem. Therefore, we only need to look if there are
      927     2647          other nodes in between to complete the branch.
      928     2648        */
      929     2649    3       IF VIA_LIST(0) ~= 0 AND MAX_DIST-START_OF_BRANCH > 1 THEN DO;

   2649 26 002524   200006 473500                    LDP3    @VIA_LIST,,AUTO
        26 002525   300000 235100                    LDA     0,,PR3
        26 002526   002706 600000 26                 TZE     s:2685
        26 002527   200125 236100                    LDQ     MAX_DIST,,AUTO
        26 002530   200135 136100                    SBLQ    START_OF_BRANCH,,AUTO
        26 002531   000001 116007                    CMPQ    1,DL
        26 002532   002706 604400 26                 TMOZ    s:2685

      930     2650    4           DO I = START_OF_BRANCH+1 TO REC_NO-1; /* New branch */

   2650 26 002533   200135 236100                    LDQ     START_OF_BRANCH,,AUTO
        26 002534   000001 036007                    ADLQ    1,DL
        26 002535   200122 756100                    STQ     I,,AUTO
        26 002536   002663 710000 26                 TRA     s:2674+3

      931     2651    5               DO J = 1 TO SAVE_REC_NO; /* Previous branch(es) */

   2651 26 002537   000001 235007                    LDA     1,DL
        26 002540   200124 755100                    STA     J,,AUTO
        26 002541   002655 710000 26                 TRA     s:2673+3
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:144  

      932     2652    5                   IF (PATH_LIST.REC_NO(I) = PATH_LIST.REC_NO(J)) AND

   2652 26 002542   200122 236100                    LDQ     I,,AUTO
        26 002543   000005 402007                    MPY     5,DL
        26 002544   200014 470500                    LDP0    PATH$,,AUTO
        26 002545   000000 220106                    LDX0    0,QL,PR0
        26 002546   200124 236100                    LDQ     J,,AUTO
        26 002547   000005 402007                    MPY     5,DL
        26 002550   000000 100106                    CMPX0   0,QL,PR0
        26 002551   002652 601000 26                 TNZ     s:2673
        26 002552   200124 236100                    LDQ     J,,AUTO
        26 002553   200055 116100                    CMPQ    TEMP_PORT_PATH_IDX,,AUTO
        26 002554   002652 603000 26                 TRC     s:2673

      933     2653    6                      (J < TEMP_PORT_PATH_IDX) THEN DO;

      934     2654    6                       ADD_TO_LAMBDA_RECS = '1'B;

   2654 26 002555   400000 236003                    LDQ     -131072,DU
        26 002556   200136 756100                    STQ     ADD_TO_LAMBDA_RECS,,AUTO

      935     2655         /* We only want to add this to LAMBDA_RECS if it's not
      936     2656            there already. */
      937     2657    7                       DO K = 1 TO LAMBDA_REC#;

   2657 26 002557   000001 235007                    LDA     1,DL
        26 002560   200123 755100                    STA     K,,AUTO
        26 002561   002575 710000 26                 TRA     s:2660+3

      938     2658    7                           IF LAMBDA_RECS.REC_NO(K) = PATH_LIST.REC_NO(I) THEN

   2658 26 002562   200123 720100                    LXL0    K,,AUTO
        26 002563   200030 221110                    LDX1    LAMBDA_RECS,X0,AUTO
        26 002564   200122 236100                    LDQ     I,,AUTO
        26 002565   000005 402007                    MPY     5,DL
        26 002566   200014 470500                    LDP0    PATH$,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:145  
        26 002567   000000 101106                    CMPX1   0,QL,PR0
        26 002570   002572 601000 26                 TNZ     s:2660

      939     2659    7                               ADD_TO_LAMBDA_RECS = '0'B;

   2659 26 002571   200136 450100                    STZ     ADD_TO_LAMBDA_RECS,,AUTO

      940     2660    7                           END;

   2660 26 002572   200123 235100                    LDA     K,,AUTO
        26 002573   000001 035007                    ADLA    1,DL
        26 002574   200123 755100                    STA     K,,AUTO
        26 002575   200027 236100                    LDQ     LAMBDA_REC#,,AUTO
        26 002576   200123 116100                    CMPQ    K,,AUTO
        26 002577   002562 603000 26                 TRC     s:2658

      941     2661    7                       IF ADD_TO_LAMBDA_RECS THEN DO;

   2661 26 002600   200136 234100                    SZN     ADD_TO_LAMBDA_RECS,,AUTO
        26 002601   002650 605000 26                 TPL     s:2671

      942     2662    7                           LAMBDA_REC# = LAMBDA_REC# + 1;

   2662 26 002602   000001 036007                    ADLQ    1,DL
        26 002603   200027 756100                    STQ     LAMBDA_REC#,,AUTO

      943     2663    7                           LAMBDA_RECS.REC_NO(LAMBDA_REC#) = PATH_LIST.REC_NO(J);

   2663 26 002604   200124 236100                    LDQ     J,,AUTO
        26 002605   000005 402007                    MPY     5,DL
        26 002606   000000 220106                    LDX0    0,QL,PR0
        26 002607   200027 721100                    LXL1    LAMBDA_REC#,,AUTO
        26 002610   200030 740111                    STX0    LAMBDA_RECS,X1,AUTO

      944     2664    7                           LAMBDA_RECS.PATH_LIST_IDX(LAMBDA_REC#) = J;

   2664 26 002611   200124 722100                    LXL2    J,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:146  
        26 002612   200030 442111                    SXL2    LAMBDA_RECS,X1,AUTO

      945     2665    8                           DO K = START_OF_BRANCH+1 TO REC_NO;

   2665 26 002613   200135 235100                    LDA     START_OF_BRANCH,,AUTO
        26 002614   000001 035007                    ADLA    1,DL
        26 002615   200123 755100                    STA     K,,AUTO
        26 002616   002645 710000 26                 TRA     s:2669+3

      946     2666    8                               CUR_NODE = PATH_LIST.REC_NO(K);

   2666 26 002617   200123 236100                    LDQ     K,,AUTO
        26 002620   000005 402007                    MPY     5,DL
        26 002621   200014 470500                    LDP0    PATH$,,AUTO
        26 002622   000000 236106                    LDQ     0,QL,PR0
        26 002623   000022 772000                    QRL     18
        26 002624   200131 756100                    STQ     CUR_NODE,,AUTO

      947     2667    8                               CALL ZII$FIND_IDX(CUR_NODE,X);

   2667 26 002625   200130 631500                    EPPR1   X,,AUTO
        26 002626   200207 451500                    STP1    DRFS$$+3,,AUTO
        26 002627   200131 633500                    EPPR3   CUR_NODE,,AUTO
        26 002630   200206 453500                    STP3    DRFS$$+2,,AUTO
        26 002631   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 002632   000000 631400 27                 EPPR1   0
        26 002633   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 002634   000000 011000                    NOP     0

      948     2668    8                               D_TABLE.BELONGS_PREV_LAMBDA(X) = '1'B;

   2668 26 002635   200130 235100                    LDA     X,,AUTO
        26 002636   000002 735000                    ALS     2
        26 002637   400000 236003                    LDQ     -131072,DU
        26 002640   000000 470400 7                  LDP0    D_TBL$
        26 002641   000003 756105                    STQ     3,AL,PR0

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:147  
      949     2669    8                               END;

   2669 26 002642   200123 235100                    LDA     K,,AUTO
        26 002643   000001 035007                    ADLA    1,DL
        26 002644   200123 755100                    STA     K,,AUTO
        26 002645   200015 236100                    LDQ     REC_NO,,AUTO
        26 002646   200123 116100                    CMPQ    K,,AUTO
        26 002647   002617 603000 26                 TRC     s:2666

      950     2670    7                           END;

      951     2671    6                       DID_I = '0'B;

   2671 26 002650   200121 470500                    LDP0    @DID_I,,AUTO
        26 002651   000000 450100                    STZ     0,,PR0

      952     2672    6                       END;

      953     2673    5                   END;

   2673 26 002652   200124 235100                    LDA     J,,AUTO
        26 002653   000001 035007                    ADLA    1,DL
        26 002654   200124 755100                    STA     J,,AUTO
        26 002655   200137 236100                    LDQ     SAVE_REC_NO,,AUTO
        26 002656   200124 116100                    CMPQ    J,,AUTO
        26 002657   002542 603000 26                 TRC     s:2652

      954     2674    4               END;

   2674 26 002660   200122 235100                    LDA     I,,AUTO
        26 002661   000001 035007                    ADLA    1,DL
        26 002662   200122 755100                    STA     I,,AUTO
        26 002663   200122 236100                    LDQ     I,,AUTO
        26 002664   200015 116100                    CMPQ    REC_NO,,AUTO
        26 002665   002537 602000 26                 TNC     s:2651

      955     2675         /*
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:148  
      956     2676            If the new branch is a bad one, restore the path list to
      957     2677            the state it was in before we started.
      958     2678         */
      959     2679    4           IF DID_I = '0'B THEN DO;

   2679 26 002666   200121 470500                    LDP0    @DID_I,,AUTO
        26 002667   000000 234100                    SZN     0,,PR0
        26 002670   002706 604000 26                 TMI     s:2685

      960     2680    4               REC_NO = SAVE_REC_NO;

   2680 26 002671   200137 235100                    LDA     SAVE_REC_NO,,AUTO
        26 002672   200015 755100                    STA     REC_NO,,AUTO

      961     2681    4               PATH_LIST.REC_NO(0) = SAVE_REC_NO;

   2681 26 002673   000000 620005                    EAX0    0,AL
        26 002674   200014 471500                    LDP1    PATH$,,AUTO
        26 002675   100000 740100                    STX0    0,,PR1

      962     2682    4               CALL ZII$PATH_MEMORY(PATH_SLOTS_NEEDED,%RLSE);

   2682 26 002676   000026 236000 27                 LDQ     22
        26 002677   200207 756100                    STQ     DRFS$$+3,,AUTO
        26 002700   200134 633500                    EPPR3   PATH_SLOTS_NEEDED,,AUTO
        26 002701   200206 453500                    STP3    DRFS$$+2,,AUTO
        26 002702   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 002703   000000 631400 27                 EPPR1   0
        26 002704   000000 701000 xent               TSX1    ZII$PATH_MEMORY
        26 002705   000000 011000                    NOP     0

      963     2683    4               END;

      964     2684    3           END;

      965     2685    2       RETURN;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:149  
   2685 26 002706   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 002707   000001 702211                    TSX2  ! 1,X1

      966     2686    2   ER_COMMON:
      967     2687    2       ALTRETURN;

   2687 26 002710   200116 221300       ER_COMMON    LDX1  ! MEMBER_LIST+22,,AUTO
        26 002711   000000 702211                    TSX2  ! 0,X1

      968     2688    2   END BACK_TRACK_MAYBE;
      969     2689         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:150  
      970     2690    1   COMPRESS_PATH: PROC(PATH_LIST);

   2690 26 002712   200116 741300       COMPRESS_PA* STX1  ! MEMBER_LIST+22,,AUTO

      971     2691        /*
      972     2692          DESCRIPTION: This proc is used to compress the Path list in order
      973     2693                       to rid it of non-essentially redundant record index
      974     2694                       appearances.
      975     2695
      976     2696          IN:
      977     2697             PATH_LIST := The structure defining the calls and directions for
      978     2698                          the Retrieval module to perform. This list appears
      979     2699                          in the ZI$PATH_STRUCTS include file.
      980     2700
      981     2701          OUT:
      982     2702              PATH_LIST := same as above but may contain fewer occurrences.
      983     2703                                                                              */
      984     2704    2   DCL I UBIN AUTO;
      985     2705    2   DCL J UBIN AUTO;
      986     2706        /**/
      987     2707        %PATH_DESC (STCLASS=" ");
      988     2747        /**/
      989     2748        /**/
      990     2749    2       I=2;

   2749 26 002713   000002 235007                    LDA     2,DL
        26 002714   200120 755100                    STA     I,,AUTO

      991     2750    3       DO WHILE (I<=REC_NO);

   2750 26 002715   200015 236100                    LDQ     REC_NO,,AUTO
        26 002716   200120 116100                    CMPQ    I,,AUTO
        26 002717   002772 602000 26                 TNC     s:2763

      992     2751    3           IF PATH_LIST.REC_NO(I)=PATH_LIST.REC_NO(1) THEN

   2751 26 002720   200120 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:151  
        26 002721   000005 402007                    MPY     5,DL
        26 002722   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 002723   000000 220106                    LDX0    0,QL,PR0
        26 002724   000005 100100                    CMPX0   5,,PR0
        26 002725   002764 601000 26                 TNZ     s:2761

      993     2752    4           DO;

      994     2753    4               I=I+1;

   2753 26 002726   200120 235100                    LDA     I,,AUTO
        26 002727   000001 035007                    ADLA    1,DL
        26 002730   200120 755100                    STA     I,,AUTO

      995     2754    4               J=2;

   2754 26 002731   000002 236007                    LDQ     2,DL
        26 002732   200121 756100                    STQ     J,,AUTO

      996     2755    5               DO WHILE (PATH_LIST.REC_NO(I)=PATH_LIST.REC_NO(J));

   2755 26 002733   200120 236100                    LDQ     I,,AUTO
        26 002734   000005 402007                    MPY     5,DL
        26 002735   000000 220106                    LDX0    0,QL,PR0
        26 002736   200121 236100                    LDQ     J,,AUTO
        26 002737   000005 402007                    MPY     5,DL
        26 002740   000000 100106                    CMPX0   0,QL,PR0
        26 002741   002764 601000 26                 TNZ     s:2761

      997     2756    5                   PATH_LIST.REC_NO(I-1)=0;

   2756 26 002742   200120 236100                    LDQ     I,,AUTO
        26 002743   000005 402007                    MPY     5,DL
        26 002744   000000 220003                    LDX0    0,DU
        26 002745   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 002746   077773 740106                    STX0    -5,QL,PR0

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:152  
      998     2757    5                   J=J+1;

   2757 26 002747   200121 235100                    LDA     J,,AUTO
        26 002750   000001 035007                    ADLA    1,DL
        26 002751   200121 755100                    STA     J,,AUTO

      999     2758    5                   I=I+1;

   2758 26 002752   200120 235100                    LDA     I,,AUTO
        26 002753   000001 035007                    ADLA    1,DL
        26 002754   200120 755100                    STA     I,,AUTO

     1000     2759    5                   END;

   2759 26 002755   200120 236100                    LDQ     I,,AUTO
        26 002756   000005 402007                    MPY     5,DL
        26 002757   000000 221106                    LDX1    0,QL,PR0
        26 002760   200121 236100                    LDQ     J,,AUTO
        26 002761   000005 402007                    MPY     5,DL
        26 002762   000000 101106                    CMPX1   0,QL,PR0
        26 002763   002742 600000 26                 TZE     s:2756

     1001     2760    4               END;

     1002     2761    3           I=I+1;

   2761 26 002764   200120 235100                    LDA     I,,AUTO
        26 002765   000001 035007                    ADLA    1,DL
        26 002766   200120 755100                    STA     I,,AUTO

     1003     2762    3           END;

   2762 26 002767   200015 236100                    LDQ     REC_NO,,AUTO
        26 002770   200120 116100                    CMPQ    I,,AUTO
        26 002771   002720 603000 26                 TRC     s:2751

     1004     2763    2       I=1;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:153  

   2763 26 002772   000001 235007                    LDA     1,DL
        26 002773   200120 755100                    STA     I,,AUTO

     1005     2764    2       J=1;

   2764 26 002774   200121 755100                    STA     J,,AUTO

     1006     2765    3       DO WHILE (I<=REC_NO);

   2765 26 002775   200120 116100                    CMPQ    I,,AUTO
        26 002776   003054 602000 26                 TNC     s:2778

     1007     2766    3           IF PATH_LIST.REC_NO(I)~=0 THEN

   2766 26 002777   200120 236100                    LDQ     I,,AUTO
        26 003000   000005 402007                    MPY     5,DL
        26 003001   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 003002   000000 220106                    LDX0    0,QL,PR0
        26 003003   003046 600000 26                 TZE     s:2776

     1008     2767    4           DO;

     1009     2768    4               PATH_LIST.REC_NO(J)=PATH_LIST.REC_NO(I);

   2768 26 003004   200121 236100                    LDQ     J,,AUTO
        26 003005   000005 402007                    MPY     5,DL
        26 003006   000000 620006                    EAX0    0,QL
        26 003007   200120 236100                    LDQ     I,,AUTO
        26 003010   000005 402007                    MPY     5,DL
        26 003011   000000 221106                    LDX1    0,QL,PR0
        26 003012   000000 741110                    STX1    0,X0,PR0

     1010     2769    4               PATH_LIST.SET_NO(J)=PATH_LIST.SET_NO(I);

   2769 26 003013   000000 722106                    LXL2    0,QL,PR0
        26 003014   000000 442110                    SXL2    0,X0,PR0
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:154  

     1011     2770    4               PATH_LIST.GET_IND(J)=PATH_LIST.GET_IND(I);

   2770 26 003015   000001 236106                    LDQ     1,QL,PR0
        26 003016   000001 676110                    ERQ     1,X0,PR0
        26 003017   200000 376003                    ANQ     65536,DU
        26 003020   000001 656110                    ERSQ    1,X0,PR0

     1012     2771    4               PATH_LIST.OWN_NEXT(J)=PATH_LIST.OWN_NEXT(I);

   2771 26 003021   200120 236100                    LDQ     I,,AUTO
        26 003022   000005 402007                    MPY     5,DL
        26 003023   000001 236106                    LDQ     1,QL,PR0
        26 003024   000001 676110                    ERQ     1,X0,PR0
        26 003025   400000 376003                    ANQ     -131072,DU
        26 003026   000001 656110                    ERSQ    1,X0,PR0

     1013     2772    4               PATH_LIST.DISPLAY_IND(J)=PATH_LIST.DISPLAY_IND(I);

   2772 26 003027   200120 236100                    LDQ     I,,AUTO
        26 003030   000005 402007                    MPY     5,DL
        26 003031   000001 236106                    LDQ     1,QL,PR0
        26 003032   000001 676110                    ERQ     1,X0,PR0
        26 003033   010000 376003                    ANQ     4096,DU
        26 003034   000001 656110                    ERSQ    1,X0,PR0

     1014     2773    4               PATH_LIST.FIND_ATTEMPTED(J)=PATH_LIST.FIND_ATTEMPTED(I);

   2773 26 003035   200120 236100                    LDQ     I,,AUTO
        26 003036   000005 402007                    MPY     5,DL
        26 003037   000001 236106                    LDQ     1,QL,PR0
        26 003040   000001 676110                    ERQ     1,X0,PR0
        26 003041   100000 376003                    ANQ     32768,DU
        26 003042   000001 656110                    ERSQ    1,X0,PR0

     1015     2774    4               J=J+1;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:155  
   2774 26 003043   200121 235100                    LDA     J,,AUTO
        26 003044   000001 035007                    ADLA    1,DL
        26 003045   200121 755100                    STA     J,,AUTO

     1016     2775    4               END;

     1017     2776    3           I=I+1;

   2776 26 003046   200120 235100                    LDA     I,,AUTO
        26 003047   000001 035007                    ADLA    1,DL
        26 003050   200120 755100                    STA     I,,AUTO

     1018     2777    3           END;

   2777 26 003051   200015 236100                    LDQ     REC_NO,,AUTO
        26 003052   200120 116100                    CMPQ    I,,AUTO
        26 003053   002777 603000 26                 TRC     s:2766

     1019     2778    2       REC_NO=REC_NO-(I-J);

   2778 26 003054   200120 236100                    LDQ     I,,AUTO
        26 003055   200121 136100                    SBLQ    J,,AUTO
        26 003056   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 003057   200015 236100                    LDQ     REC_NO,,AUTO
        26 003060   200206 136100                    SBLQ    DRFS$$+2,,AUTO
        26 003061   200015 756100                    STQ     REC_NO,,AUTO

     1020     2779    2       PATH_LIST.REC_NO(0)=REC_NO;

   2779 26 003062   000000 620006                    EAX0    0,QL
        26 003063   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 003064   000000 740100                    STX0    0,,PR0

     1021     2780    2       J=1;

   2780 26 003065   000001 236007                    LDQ     1,DL
        26 003066   200121 756100                    STQ     J,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:156  

     1022     2781    3       DO WHILE (J<REC_NO);

   2781 26 003067   200015 116100                    CMPQ    REC_NO,,AUTO
        26 003070   003107 603000 26                 TRC     s:2786

     1023     2782    3           IF PATH_LIST.REC_NO(J)=PATH_LIST.REC_NO(J+1) THEN

   2782 26 003071   200121 236100                    LDQ     J,,AUTO
        26 003072   000005 402007                    MPY     5,DL
        26 003073   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 003074   000000 220106                    LDX0    0,QL,PR0
        26 003075   000005 100106                    CMPX0   5,QL,PR0
        26 003076   003101 601000 26                 TNZ     s:2784

     1024     2783    3               PATH_LIST.REC_NO(J)=0;

   2783 26 003077   000000 221003                    LDX1    0,DU
        26 003100   000000 741106                    STX1    0,QL,PR0

     1025     2784    3           J=J+1;

   2784 26 003101   200121 235100                    LDA     J,,AUTO
        26 003102   000001 035007                    ADLA    1,DL
        26 003103   200121 755100                    STA     J,,AUTO

     1026     2785    3           END;

   2785 26 003104   200121 236100                    LDQ     J,,AUTO
        26 003105   200015 116100                    CMPQ    REC_NO,,AUTO
        26 003106   003071 602000 26                 TNC     s:2782

     1027     2786    2       CALL NOT_PATHPT(PATH_LIST,0);

   2786 26 003107   000026 236000 27                 LDQ     22
        26 003110   200124 756100                    STQ     J,,AUTO
        26 003111   200117 236100                    LDQ     @PATH_LIST,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:157  
        26 003112   200123 756100                    STQ     K,,AUTO
        26 003113   004412 701000 26                 TSX1    NOT_PATHPT
        26 003114   000000 011000                    NOP     0

     1028     2787        /* Now fill in the Repeat indicators for all recurring lambda structure
     1029     2788           owning records. */
     1030     2789    2       PATH_LIST.REPEAT_IND(1)='0'B;

   2789 26 003115   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 003116   000010 236000 27                 LDQ     8
        26 003117   000006 356100                    ANSQ    6,,PR0

     1031     2790    2       J=2;

   2790 26 003120   000002 235007                    LDA     2,DL
        26 003121   200121 755100                    STA     J,,AUTO

     1032     2791    3       DO WHILE (J<=REC_NO);

   2791 26 003122   200015 236100                    LDQ     REC_NO,,AUTO
        26 003123   200121 116100                    CMPQ    J,,AUTO
        26 003124   003167 602000 26                 TNC     s:2805

     1033     2792    3           I=1;

   2792 26 003125   000001 235007                    LDA     1,DL
        26 003126   200120 755100                    STA     I,,AUTO

     1034     2793    4           DO WHILE (I<J);

   2793 26 003127   200120 236100                    LDQ     I,,AUTO
        26 003130   200121 116100                    CMPQ    J,,AUTO
        26 003131   003161 603000 26                 TRC     s:2803

     1035     2794    4               IF PATH_LIST.REC_NO(I)=PATH_LIST.REC_NO(J) THEN

   2794 26 003132   200120 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:158  
        26 003133   000005 402007                    MPY     5,DL
        26 003134   200117 470500                    LDP0    @PATH_LIST,,AUTO
        26 003135   000000 220106                    LDX0    0,QL,PR0
        26 003136   200121 236100                    LDQ     J,,AUTO
        26 003137   000005 402007                    MPY     5,DL
        26 003140   000000 100106                    CMPX0   0,QL,PR0
        26 003141   003150 601000 26                 TNZ     s:2800

     1036     2795    5               DO;

     1037     2796    5                   PATH_LIST.REPEAT_IND(J)='1'B;

   2796 26 003142   000000 620006                    EAX0    0,QL
        26 003143   040000 236003                    LDQ     16384,DU
        26 003144   000001 256110                    ORSQ    1,X0,PR0

     1038     2797    5                   I=J;

   2797 26 003145   200121 235100                    LDA     J,,AUTO
        26 003146   200120 755100                    STA     I,,AUTO

     1039     2798    5                   END;

   2798 26 003147   003153 710000 26                 TRA     s:2801

     1040     2799    4               ELSE
     1041     2800    4                   PATH_LIST.REPEAT_IND(J)='0'B;

   2800 26 003150   000000 620006                    EAX0    0,QL
        26 003151   000010 236000 27                 LDQ     8
        26 003152   000001 356110                    ANSQ    1,X0,PR0

     1042     2801    4               I=I+1;

   2801 26 003153   200120 235100                    LDA     I,,AUTO
        26 003154   000001 035007                    ADLA    1,DL
        26 003155   200120 755100                    STA     I,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:159  

     1043     2802    4               END;

   2802 26 003156   200120 236100                    LDQ     I,,AUTO
        26 003157   200121 116100                    CMPQ    J,,AUTO
        26 003160   003132 602000 26                 TNC     s:2794

     1044     2803    3           J=J+1;

   2803 26 003161   200121 235100                    LDA     J,,AUTO
        26 003162   000001 035007                    ADLA    1,DL
        26 003163   200121 755100                    STA     J,,AUTO

     1045     2804    3           END;

   2804 26 003164   200015 236100                    LDQ     REC_NO,,AUTO
        26 003165   200121 116100                    CMPQ    J,,AUTO
        26 003166   003125 603000 26                 TRC     s:2792

     1046     2805    2       RETURN;

   2805 26 003167   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 003170   000001 702211                    TSX2  ! 1,X1

     1047     2806    2   END COMPRESS_PATH;
     1048     2807         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:160  
     1049     2808    1   COMP_DIST: PROC (PORT_RECORD);

   2808 26 003171   200116 741300       COMP_DIST    STX1  ! MEMBER_LIST+22,,AUTO

     1050     2809        /*
     1051     2810          DESCRIPTION: This proc uses the Port record as input and
     1052     2811                       proceeds to compute path lengths from all other records
     1053     2812                       to the Port record. there is no value retrned but
     1054     2813                       the result of COMP_DIST is the information placed
     1055     2814                       into D_TABLE in the Common segment.
     1056     2815
     1057     2816          IN:
     1058     2817             ACCESS_LIST.PORT := Index to the record previously defined as the
     1059     2818                            Port record.
     1060     2819
     1061     2820          OUT:
     1062     2821              [None]
     1063     2822                                                                              */
     1064     2823        /**/
     1065     2824    2   DCL ZII$FIND_D2_IDX ENTRY(3);
     1066     2825        /**/
     1067     2826    2   DCL PORT_RECORD UBIN;
     1068     2827    2   DCL K UBIN AUTO;
     1069     2828    2   DCL X UBIN AUTO;
     1070     2829    2   DCL Y UBIN AUTO;
     1071     2830    2   DCL M (0:200) UBIN STATIC;
     1072     2831    2   DCL W (0:200) UBIN STATIC;
     1073     2832    2   DCL W_LENGTH UBIN AUTO;
     1074     2833    2   DCL MEM_FLG UBIN AUTO;
     1075     2834    2   DCL D2_IND UBIN AUTO;
     1076     2835    2   DCL ZER_FLG UBIN AUTO;
     1077     2836    2   DCL TEMP_ARG UBIN AUTO;
     1078     2837        /**/
     1079     2838    2       M='0'B;

   2838 26 003172   000000 100400                    MLR     fill='000'O
        26 003173   000011 000001 27                 ADSC9   9                        cn=0,n=1
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:161  
        26 003174   000034 001444 2                  ADSC9   M                        cn=0,n=804

     1080     2839    2       W='0'B;

   2839 26 003175   000000 100400                    MLR     fill='000'O
        26 003176   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 003177   000345 001444 2                  ADSC9   W                        cn=0,n=804

     1081     2840    2       W(0)=1;

   2840 26 003200   000001 235007                    LDA     1,DL
        26 003201   000345 755000 2                  STA     W

     1082     2841    2       K=0;

   2841 26 003202   200120 450100                    STZ     K,,AUTO

     1083     2842    2       W(1)=PORT_RECORD;

   2842 26 003203   200117 470500                    LDP0    @PORT_RECORD,,AUTO
        26 003204   000000 235100                    LDA     0,,PR0
        26 003205   000346 755000 2                  STA     W+1

     1084     2843    2       MEM_FLG=0;

   2843 26 003206   200124 450100                    STZ     MEM_FLG,,AUTO

     1085     2844    2       ZER_FLG=1;

   2844 26 003207   000001 236007                    LDQ     1,DL
        26 003210   200126 756100                    STQ     ZER_FLG,,AUTO

     1086     2845    3       DO WHILE (W(0)~=0);

   2845 26 003211   000345 235000 2                  LDA     W
        26 003212   003374 600000 26                 TZE     s:2877

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:162  
     1087     2846    3           CALL UNION_MAT(M,W);

   2846 26 003213   000027 236000 27                 LDQ     23
        26 003214   200132 756100                    STQ     TEMP_ARG,,AUTO
        26 003215   000030 236000 27                 LDQ     24
        26 003216   200131 756100                    STQ     CUR_NODE,,AUTO
        26 003217   004353 701000 26                 TSX1    UNION_MAT
        26 003220   000000 011000                    NOP     0

     1088     2847    3           CALL SET_DISTANCE(W,K);

   2847 26 003221   200120 630500                    EPPR0   K,,AUTO
        26 003222   200132 450500                    STP0    TEMP_ARG,,AUTO
        26 003223   000027 236000 27                 LDQ     23
        26 003224   200131 756100                    STQ     CUR_NODE,,AUTO
        26 003225   003376 701000 26                 TSX1    SET_DISTANCE
        26 003226   000000 011000                    NOP     0

     1089     2848    3           K=K+1;

   2848 26 003227   200120 235100                    LDA     K,,AUTO
        26 003230   000001 035007                    ADLA    1,DL
        26 003231   200120 755100                    STA     K,,AUTO

     1090     2849    3           W_LENGTH=W(0);

   2849 26 003232   000345 236000 2                  LDQ     W
        26 003233   200123 756100                    STQ     W_LENGTH,,AUTO

     1091     2850    3           X=1;

   2850 26 003234   000001 235007                    LDA     1,DL
        26 003235   200121 755100                    STA     X,,AUTO

     1092     2851    4           DO WHILE (X<=W_LENGTH);

   2851 26 003236   200121 116100                    CMPQ    X,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:163  
        26 003237   003364 602000 26                 TNC     s:2875

     1093     2852    4               Y=0;

   2852 26 003240   200122 450100                    STZ     Y,,AUTO

     1094     2853    5               DO WHILE (Y<TBL_DIM);

   2853 26 003241   200122 236100                    LDQ     Y,,AUTO
        26 003242   000000 116000 9                  CMPQ    TBL_DIM
        26 003243   003356 603000 26                 TRC     s:2873

     1095     2854    5                   TEMP_ARG=D_TABLE.REC_NO(Y);

   2854 26 003244   200122 235100                    LDA     Y,,AUTO
        26 003245   000002 735000                    ALS     2
        26 003246   000000 470400 7                  LDP0    D_TBL$
        26 003247   000000 236105                    LDQ     0,AL,PR0
        26 003250   000022 772000                    QRL     18
        26 003251   200127 756100                    STQ     TEMP_ARG,,AUTO

     1096     2855    5                   CALL MEMBER_TBL(TEMP_ARG,M,MEM_FLG);

   2855 26 003252   200124 631500                    EPPR1   MEM_FLG,,AUTO
        26 003253   200145 451500                    STP1    @OUT_FLG,,AUTO
        26 003254   000030 236000 27                 LDQ     24
        26 003255   200144 756100                    STQ     @IN_TBL,,AUTO
        26 003256   200127 633500                    EPPR3   TEMP_ARG,,AUTO
        26 003257   200143 453500                    STP3    @REC_IDX,,AUTO
        26 003260   001270 701000 26                 TSX1    MEMBER_TBL
        26 003261   000000 011000                    NOP     0

     1097     2856    5                   IF MEM_FLG=0 THEN

   2856 26 003262   200124 235100                    LDA     MEM_FLG,,AUTO
        26 003263   003350 601000 26                 TNZ     s:2871

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:164  
     1098     2857    6                   DO;

     1099     2858    6                       TEMP_ARG=D_TABLE.REC_NO(Y);

   2858 26 003264   200122 236100                    LDQ     Y,,AUTO
        26 003265   000002 736000                    QLS     2
        26 003266   000000 470400 7                  LDP0    D_TBL$
        26 003267   000000 236106                    LDQ     0,QL,PR0
        26 003270   000022 772000                    QRL     18
        26 003271   200127 756100                    STQ     TEMP_ARG,,AUTO

     1100     2859    6                       CALL ZII$FIND_D2_IDX(W(X),TEMP_ARG,D2_IND);

   2859 26 003272   200125 631500                    EPPR1   D2_IND,,AUTO
        26 003273   200210 451500                    STP1    DRFS$$+4,,AUTO
        26 003274   200127 633500                    EPPR3   TEMP_ARG,,AUTO
        26 003275   200207 453500                    STP3    DRFS$$+3,,AUTO
        26 003276   200121 720100                    LXL0    X,,AUTO
        26 003277   000345 634410 2                  EPPR4   W,X0
        26 003300   200206 454500                    STP4    DRFS$$+2,,AUTO
        26 003301   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 003302   000024 631400 27                 EPPR1   20
        26 003303   000000 701000 xent               TSX1    ZII$FIND_D2_IDX
        26 003304   000000 011000                    NOP     0

     1101     2860    6                       IF D2_TABLE.SET_IND(D2_IND)~=0 THEN

   2860 26 003305   200125 235100                    LDA     D2_IND,,AUTO
        26 003306   000001 735000                    ALS     1
        26 003307   000000 470400 8                  LDP0    D2_TBL$
        26 003310   000100 101505                    MRL     fill='000'O
        26 003311   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
        26 003312   200206 000004                    ADSC9   DRFS$$+2,,AUTO           cn=0,n=4
        26 003313   200206 236100                    LDQ     DRFS$$+2,,AUTO
        26 003314   000000 116003                    CMPQ    0,DU
        26 003315   003350 600000 26                 TZE     s:2871

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:165  
     1102     2861    7                       DO;

     1103     2862    7                           TEMP_ARG=D_TABLE.REC_NO(Y);

   2862 26 003316   200122 236100                    LDQ     Y,,AUTO
        26 003317   000002 736000                    QLS     2
        26 003320   000000 471400 7                  LDP1    D_TBL$
        26 003321   100000 236106                    LDQ     0,QL,PR1
        26 003322   000022 772000                    QRL     18
        26 003323   200127 756100                    STQ     TEMP_ARG,,AUTO

     1104     2863    7                           CALL MEMBER_TBL(TEMP_ARG,W,MEM_FLG);

   2863 26 003324   200124 633500                    EPPR3   MEM_FLG,,AUTO
        26 003325   200145 453500                    STP3    @OUT_FLG,,AUTO
        26 003326   000027 236000 27                 LDQ     23
        26 003327   200144 756100                    STQ     @IN_TBL,,AUTO
        26 003330   200127 634500                    EPPR4   TEMP_ARG,,AUTO
        26 003331   200143 454500                    STP4    @REC_IDX,,AUTO
        26 003332   001270 701000 26                 TSX1    MEMBER_TBL
        26 003333   000000 011000                    NOP     0

     1105     2864    7                           IF MEM_FLG=0 THEN

   2864 26 003334   200124 235100                    LDA     MEM_FLG,,AUTO
        26 003335   003350 601000 26                 TNZ     s:2871

     1106     2865    8                           DO;

     1107     2866    8                               W(W(0)+1)=D_TABLE.REC_NO(Y);

   2866 26 003336   200122 236100                    LDQ     Y,,AUTO
        26 003337   000002 736000                    QLS     2
        26 003340   000000 470400 7                  LDP0    D_TBL$
        26 003341   000000 236106                    LDQ     0,QL,PR0
        26 003342   000022 772000                    QRL     18
        26 003343   000345 720000 2                  LXL0    W
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:166  
        26 003344   000346 756010 2                  STQ     W+1,X0

     1108     2867    8                               W(0)=W(0)+1;

   2867 26 003345   000345 236000 2                  LDQ     W
        26 003346   000001 036007                    ADLQ    1,DL
        26 003347   000345 756000 2                  STQ     W

     1109     2868    8                               END;

     1110     2869    7                           END;

     1111     2870    6                       END;

     1112     2871    5                   Y=Y+1;

   2871 26 003350   200122 235100                    LDA     Y,,AUTO
        26 003351   000001 035007                    ADLA    1,DL
        26 003352   200122 755100                    STA     Y,,AUTO

     1113     2872    5                   END;

   2872 26 003353   200122 236100                    LDQ     Y,,AUTO
        26 003354   000000 116000 9                  CMPQ    TBL_DIM
        26 003355   003244 602000 26                 TNC     s:2854

     1114     2873    4               X=X+1;

   2873 26 003356   200121 235100                    LDA     X,,AUTO
        26 003357   000001 035007                    ADLA    1,DL
        26 003360   200121 755100                    STA     X,,AUTO

     1115     2874    4               END;

   2874 26 003361   200123 236100                    LDQ     W_LENGTH,,AUTO
        26 003362   200121 116100                    CMPQ    X,,AUTO
        26 003363   003240 603000 26                 TRC     s:2852
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:167  

     1116     2875    3           CALL NOT_TBL(W,M);

   2875 26 003364   000030 236000 27                 LDQ     24
        26 003365   200132 756100                    STQ     TEMP_ARG,,AUTO
        26 003366   000027 236000 27                 LDQ     23
        26 003367   200131 756100                    STQ     CUR_NODE,,AUTO
        26 003370   004232 701000 26                 TSX1    NOT_TBL
        26 003371   000000 011000                    NOP     0

     1117     2876    3           END;

   2876 26 003372   000345 235000 2                  LDA     W
        26 003373   003213 601000 26                 TNZ     s:2846

     1118     2877    2       RETURN;

   2877 26 003374   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 003375   000001 702211                    TSX2  ! 1,X1

     1119     2878         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:168  
     1120     2879    2   SET_DISTANCE: PROC (IN_TBL,DISTANCE);

   2879 26 003376   200130 741300       SET_DISTANCE STX1  ! X,,AUTO

     1121     2880        /*
     1122     2881          DESCRIPTION: This routine finds the matching entry of W in D_TABLE
     1123     2882                       and sets the appropriate area in the structure to the
     1124     2883                       distance K from the Port record.
     1125     2884
     1126     2885          IN:
     1127     2886             IN_TBL := List of record indices into subschema tables.
     1128     2887             DISTANCE := Current distance from Port record.
     1129     2888
     1130     2889          OUT:
     1131     2890              [None]
     1132     2891                                                                              */
     1133     2892    3   DCL IN_TBL (0:0) UBIN;
     1134     2893    3   DCL DISTANCE UBIN;
     1135     2894    3   DCL I UBIN AUTO;
     1136     2895    3   DCL J UBIN AUTO;
     1137     2896        /**/
     1138     2897    3   DCL ZII$FIND_IDX ENTRY(2);
     1139     2898        /**/
     1140     2899    3       I=1;

   2899 26 003377   000001 235007                    LDA     1,DL
        26 003400   200133 755100                    STA     I,,AUTO

     1141     2900    4       DO WHILE (I<=IN_TBL(0));

   2900 26 003401   200131 470500                    LDP0    @IN_TBL,,AUTO
        26 003402   000000 236100                    LDQ     0,,PR0
        26 003403   200133 116100                    CMPQ    I,,AUTO
        26 003404   003434 602000 26                 TNC     s:2905

     1142     2901    4           CALL ZII$FIND_IDX(IN_TBL(I),J);

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:169  
   2901 26 003405   200134 630500                    EPPR0   J,,AUTO
        26 003406   200207 450500                    STP0    DRFS$$+3,,AUTO
        26 003407   200133 236100                    LDQ     I,,AUTO
        26 003410   000022 736000                    QLS     18
        26 003411   200131 036100                    ADLQ    @IN_TBL,,AUTO
        26 003412   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 003413   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 003414   000000 631400 27                 EPPR1   0
        26 003415   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 003416   000000 011000                    NOP     0

     1143     2902    4           D_TABLE.DIST_FROM_PORT(J)=DISTANCE;

   2902 26 003417   200134 235100                    LDA     J,,AUTO
        26 003420   000002 735000                    ALS     2
        26 003421   200132 470500                    LDP0    @DISTANCE,,AUTO
        26 003422   000000 720100                    LXL0    0,,PR0
        26 003423   000000 471400 7                  LDP1    D_TBL$
        26 003424   100000 440105                    SXL0    0,AL,PR1

     1144     2903    4           I=I+1;

   2903 26 003425   200133 235100                    LDA     I,,AUTO
        26 003426   000001 035007                    ADLA    1,DL
        26 003427   200133 755100                    STA     I,,AUTO

     1145     2904    4           END;

   2904 26 003430   200131 471500                    LDP1    @IN_TBL,,AUTO
        26 003431   100000 236100                    LDQ     0,,PR1
        26 003432   200133 116100                    CMPQ    I,,AUTO
        26 003433   003405 603000 26                 TRC     s:2901

     1146     2905    3       RETURN;

   2905 26 003434   200130 221300                    LDX1  ! X,,AUTO
        26 003435   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:170  

     1147     2906    3   END SET_DISTANCE;
     1148     2907    2   END COMP_DIST;
     1149     2908         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:171  
     1150     2909    1   SELECT_PORT: PROC;

   2909 26 003436   200116 741300       SELECT_PORT  STX1  ! MEMBER_LIST+22,,AUTO

     1151     2910    2   DCL I UBIN;
     1152     2911    2   DCL J UBIN;
     1153     2912    2   DCL K UBIN;
     1154     2913    2   DCL REC_NO UBIN;
     1155     2914    2   DCL THISPX UBIN;
     1156     2915    2   DCL BESTPX UBIN;
     1157     2916    2   DCL PORT UBIN;
     1158     2917    2   DCL PORT_KEY UBIN;
     1159     2918         /* []  KEYED  SPEC.KEY  CONSTRAINT  OUT_CLASS>0
     1160     2919            1    Y       Y          Y            Y
     1161     2920            2    Y       Y          Y
     1162     2921            3    Y       Y                       Y
     1163     2922            4    Y       Y
     1164     2923            5    Y                  Y            Y
     1165     2924            6    Y                  Y
     1166     2925            7    Y                               Y
     1167     2926            8    Y
     1168     2927            9    N                  Y            Y
     1169     2928            10    N                  Y
     1170     2929            11    N                               Y
     1171     2930            12    N
     1172     2931         */
     1173     2932    2   DCL ZII$FIND_IDX ENTRY(2);
     1174     2933        %DSC_RFK;
     1175     2949         /*
     1176     2950            Attempt to use one of the port optimization candidates as a port
     1177     2951            prefering one with an OUT_CLASS>0.
     1178     2952         */
     1179     2953    2       IF CANDIDATE_LIST.REC_NO(0) ~= 0 THEN

   2953 26 003437   200004 470500                    LDP0    @CANDIDATE_LIST,,AUTO
        26 003440   000000 220100                    LDX0    0,,PR0
        26 003441   003536 600000 26                 TZE     s:2987
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:172  

     1180     2954    3       DO;

     1181     2955    4           DO I = 1 TO CANDIDATE_LIST.REC_NO(0);

   2955 26 003442   000001 235007                    LDA     1,DL
        26 003443   200117 755100                    STA     I,,AUTO
        26 003444   003512 710000 26                 TRA     s:2970+3

     1182     2956    4               REC_NO = CANDIDATE_LIST.REC_NO(I);

   2956 26 003445   200004 470500                    LDP0    @CANDIDATE_LIST,,AUTO
        26 003446   200117 720100                    LXL0    I,,AUTO
        26 003447   000000 236110                    LDQ     0,X0,PR0
        26 003450   000022 772000                    QRL     18
        26 003451   200122 756100                    STQ     REC_NO,,AUTO

     1183     2957    4               CALL ZII$FIND_IDX(REC_NO,J);

   2957 26 003452   200120 631500                    EPPR1   J,,AUTO
        26 003453   200207 451500                    STP1    DRFS$$+3,,AUTO
        26 003454   200122 633500                    EPPR3   REC_NO,,AUTO
        26 003455   200206 453500                    STP3    DRFS$$+2,,AUTO
        26 003456   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 003457   000000 631400 27                 EPPR1   0
        26 003460   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 003461   000000 011000                    NOP     0

     1184     2958    4               IF D_TABLE.OUT_CLASS(J) ~= 0 THEN

   2958 26 003462   200120 235100                    LDA     J,,AUTO
        26 003463   000002 735000                    ALS     2
        26 003464   000000 470400 7                  LDP0    D_TBL$
        26 003465   000002 235105                    LDA     2,AL,PR0
        26 003466   003507 600000 26                 TZE     s:2970

     1185     2959    5               DO;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:173  

     1186     2960    5                   ACCESS_LIST.PORT = REC_NO;

   2960 26 003467   200122 720100                    LXL0    REC_NO,,AUTO
        26 003470   200005 471500                    LDP1    @ACCESS_LIST,,AUTO
        26 003471   100000 740100                    STX0    0,,PR1

     1187     2961    5                   IF CANDIDATE_LIST.KEY_NO(I) = 0 THEN

   2961 26 003472   200004 470500                    LDP0    @CANDIDATE_LIST,,AUTO
        26 003473   200117 721100                    LXL1    I,,AUTO
        26 003474   000000 722111                    LXL2    0,X1,PR0
        26 003475   003501 601000 26                 TNZ     s:2964

     1188     2962    5                       ACCESS_LIST.PORT_TYPE = %CALC_ACCESS;

   2962 26 003476   000004 223003                    LDX3    4,DU
        26 003477   100001 743100                    STX3    1,,PR1
        26 003500   003504 710000 26                 TRA     s:2967

     1189     2963    6                   ELSE DO;

     1190     2964    6                       ACCESS_LIST.PORT_KEY = CANDIDATE_LIST.KEY_NO(I);

   2964 26 003501   100000 442100                    SXL2    0,,PR1

     1191     2965    6                       ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;

   2965 26 003502   000003 223003                    LDX3    3,DU
        26 003503   100001 743100                    STX3    1,,PR1

     1192     2966    6                       END;

     1193     2967    5                   CANDIDATE_LIST.KEY_NO(0) = I;

   2967 26 003504   000000 441100                    SXL1    0,,PR0

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:174  
     1194     2968    5                   RETURN;

   2968 26 003505   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 003506   000001 702211                    TSX2  ! 1,X1

     1195     2969    5                   END;
     1196     2970    4               END;

   2970 26 003507   200117 235100                    LDA     I,,AUTO
        26 003510   000001 035007                    ADLA    1,DL
        26 003511   200117 755100                    STA     I,,AUTO
        26 003512   200004 470500                    LDP0    @CANDIDATE_LIST,,AUTO
        26 003513   000000 236100                    LDQ     0,,PR0
        26 003514   000022 772000                    QRL     18
        26 003515   200117 116100                    CMPQ    I,,AUTO
        26 003516   003445 603000 26                 TRC     s:2956

     1197     2971    3           ACCESS_LIST.PORT = REC_NO;

   2971 26 003517   200122 720100                    LXL0    REC_NO,,AUTO
        26 003520   200005 471500                    LDP1    @ACCESS_LIST,,AUTO
        26 003521   100000 740100                    STX0    0,,PR1

     1198     2972    3           IF CANDIDATE_LIST.KEY_NO(1) = 0 THEN

   2972 26 003522   000001 721100                    LXL1    1,,PR0
        26 003523   003527 601000 26                 TNZ     s:2975

     1199     2973    3               ACCESS_LIST.PORT_TYPE = %CALC_ACCESS;

   2973 26 003524   000004 222003                    LDX2    4,DU
        26 003525   100001 742100                    STX2    1,,PR1
        26 003526   003532 710000 26                 TRA     s:2978

     1200     2974    4           ELSE DO;

     1201     2975    4               ACCESS_LIST.PORT_KEY = CANDIDATE_LIST.KEY_NO(1);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:175  

   2975 26 003527   100000 441100                    SXL1    0,,PR1

     1202     2976    4               ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;

   2976 26 003530   000003 222003                    LDX2    3,DU
        26 003531   100001 742100                    STX2    1,,PR1

     1203     2977    4               END;

     1204     2978    3           CANDIDATE_LIST.KEY_NO(0) = 1;

   2978 26 003532   000001 221003                    LDX1    1,DU
        26 003533   000000 441100                    SXL1    0,,PR0

     1205     2979    3           RETURN;

   2979 26 003534   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 003535   000001 702211                    TSX2  ! 1,X1

     1206     2980    3           END;
     1207     2981        /*
     1208     2982            Handle the situation where a port record was given but no
     1209     2983            access type was specified.  If there are alternate keys, take
     1210     2984            the 1st one found and make the type 'keyed'.  If not, make
     1211     2985            it 'serial'.
     1212     2986        */
     1213     2987    3       IF ACCESS_LIST.PORT ~= 0 THEN DO; /* PORT_TYPE = 0 */

   2987 26 003536   200005 471500                    LDP1    @ACCESS_LIST,,AUTO
        26 003537   100000 222100                    LDX2    0,,PR1
        26 003540   003565 600000 26                 TZE     s:3015

     1214     2988    3           DR$ = NAM1.DESC$(ACCESS_LIST.PORT);

   2988 26 003541   100000 236100                    LDQ     0,,PR1
        26 003542   000022 772000                    QRL     18
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:176  
        26 003543   000012 402007                    MPY     10,DL
        26 003544   000000 473400 10                 LDP3    NAM1$
        26 003545   300011 236106                    LDQ     9,QL,PR3
        26 003546   000000 756000 17                 STQ     DR$

     1215     2989    4           IF RECORD.RFK_DSC$ ~= ADDR(NIL) THEN DO;

   2989 26 003547   000000 474400 17                 LDP4    DR$
        26 003550   400007 236100                    LDQ     7,,PR4
        26 003551   000012 116000 27                 CMPQ    10
        26 003552   003561 600000 26                 TZE     s:2993

     1216     2990    4               ACCESS_LIST.PORT_KEY = RECORD.RFK_DSC$->RFK_DSC.KEY_IDX;

   2990 26 003553   400007 475500                    LDP5    7,,PR4
        26 003554   500000 720100                    LXL0    0,,PR5
        26 003555   100000 440100                    SXL0    0,,PR1

     1217     2991    4               ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;

   2991 26 003556   000003 221003                    LDX1    3,DU
        26 003557   100001 741100                    STX1    1,,PR1

     1218     2992    4               END;

   2992 26 003560   003563 710000 26                 TRA     s:2994

     1219     2993    3           ELSE ACCESS_LIST.PORT_TYPE = %SERIAL_ACCESS;

   2993 26 003561   000001 220003                    LDX0    1,DU
        26 003562   100001 740100                    STX0    1,,PR1

     1220     2994    3           RETURN;

   2994 26 003563   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 003564   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:177  
     1221     2995    3           END;
     1222     2996
     1223     2997         /*
     1224     2998            Try for the best possible un-optimized port.  The choice is made
     1225     2999            from the display list in the following order.
     1226     3000            1.  A keyed record which matches a specific given key, is used
     1227     3001            in a constraint and has OUT_CLASS > 0.
     1228     3002            2.  Same but OUT_CLASS = 0.
     1229     3003            3.  A keyed record which matches a specific given key, and has
     1230     3004            OUT_CLASS > 0.
     1231     3005            4.  Same but OUT_CLASS = 0.
     1232     3006            5.  A keyed record, used in a constraint and has OUT_CLASS > 0.
     1233     3007            6.  Same but OUT_CLASS = 0.
     1234     3008            7.  A keyed record with OUT_CLASS > 0.
     1235     3009            8.  A keyed record.
     1236     3010            9.  A record used in a constraint with OUT_CLASS > 0.
     1237     3011            10.  A record used in a constraint.
     1238     3012            11.  A record with OUT_CLASS > 0.
     1239     3013            12.  The first record in the display list.
     1240     3014         */
     1241     3015    2       PORT = DISPLAY_LIST.REC_NO(1);

   3015 26 003565   200003 473500                    LDP3    @DISPLAY_LIST,,AUTO
        26 003566   300001 236100                    LDQ     1,,PR3
        26 003567   777777 376007                    ANQ     -1,DL
        26 003570   200125 756100                    STQ     PORT,,AUTO

     1242     3016    2       BESTPX = 12;

   3016 26 003571   000014 235007                    LDA     12,DL
        26 003572   200124 755100                    STA     BESTPX,,AUTO

     1243     3017    3       DO I = 1 TO DISPLAY_LIST#;

   3017 26 003573   000001 235007                    LDA     1,DL
        26 003574   200117 755100                    STA     I,,AUTO
        26 003575   003721 710000 26                 TRA     s:3049+3
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:178  

     1244     3018    3           REC_NO = DISPLAY_LIST.REC_NO(I);

   3018 26 003576   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 003577   200117 720100                    LXL0    I,,AUTO
        26 003600   000000 236110                    LDQ     0,X0,PR0
        26 003601   777777 376007                    ANQ     -1,DL
        26 003602   200122 756100                    STQ     REC_NO,,AUTO

     1245     3019    3           THISPX = 12;

   3019 26 003603   000014 235007                    LDA     12,DL
        26 003604   200123 755100                    STA     THISPX,,AUTO

     1246     3020    3           DR$ = NAM1.DESC$(REC_NO);

   3020 26 003605   000012 402007                    MPY     10,DL
        26 003606   000000 471400 10                 LDP1    NAM1$
        26 003607   100011 236106                    LDQ     9,QL,PR1
        26 003610   000000 756000 17                 STQ     DR$

     1247     3021    3           IF RECORD.RFK_DSC$ ~= ADDR(NIL) THEN

   3021 26 003611   000000 473400 17                 LDP3    DR$
        26 003612   300007 236100                    LDQ     7,,PR3
        26 003613   000012 116000 27                 CMPQ    10
        26 003614   003650 600000 26                 TZE     s:3035

     1248     3022    4           DO;

     1249     3023    4               THISPX = 8;

   3023 26 003615   000010 235007                    LDA     8,DL
        26 003616   200123 755100                    STA     THISPX,,AUTO

     1250     3024    4               K = RECORD.RFK_DSC$->RFK_DSC.KEY_IDX;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:179  
   3024 26 003617   300007 474500                    LDP4    7,,PR3
        26 003620   400000 236100                    LDQ     0,,PR4
        26 003621   777777 376007                    ANQ     -1,DL
        26 003622   200121 756100                    STQ     K,,AUTO

     1251     3025    4               IF ACCESS_LIST.PORT_KEY ~= 0 THEN

   3025 26 003623   200005 475500                    LDP5    @ACCESS_LIST,,AUTO
        26 003624   500000 721100                    LXL1    0,,PR5
        26 003625   003650 600000 26                 TZE     s:3035

     1252     3026    5               DO;

     1253     3027    5                   DRFK$ = RECORD.RFK_DSC$;

   3027 26 003626   300007 236100                    LDQ     7,,PR3
        26 003627   000000 756000 22                 STQ     DRFK$

     1254     3028    6                   DO WHILE(DRFK$ ~= ADDR(NIL) AND THISPX ~= 4);

   3028 26 003630   003643 710000 26                 TRA     s:3032

     1255     3029    6                       IF ACCESS_LIST.PORT_KEY = RFK_DSC.KEY_IDX THEN

   3029 26 003631   000000 470400 22                 LDP0    DRFK$
        26 003632   200005 471500                    LDP1    @ACCESS_LIST,,AUTO
        26 003633   100000 236100                    LDQ     0,,PR1
        26 003634   000000 676100                    ERQ     0,,PR0
        26 003635   777777 376007                    ANQ     -1,DL
        26 003636   003641 601000 26                 TNZ     s:3031

     1256     3030    6                           THISPX = 4;

   3030 26 003637   000004 235007                    LDA     4,DL
        26 003640   200123 755100                    STA     THISPX,,AUTO

     1257     3031    6                       DRFK$ = RFK_DSC.REC$;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:180  

   3031 26 003641   000005 236100                    LDQ     5,,PR0
        26 003642   000000 756000 22                 STQ     DRFK$

     1258     3032    6                       END;

   3032 26 003643   000012 116000 27                 CMPQ    10
        26 003644   003650 600000 26                 TZE     s:3035
        26 003645   200123 235100                    LDA     THISPX,,AUTO
        26 003646   000004 115007                    CMPA    4,DL
        26 003647   003631 601000 26                 TNZ     s:3029

     1259     3033    5                   END;

     1260     3034    4               END;

     1261     3035    3           IF THISPX < BESTPX+3 THEN

   3035 26 003650   200124 236100                    LDQ     BESTPX,,AUTO
        26 003651   000003 036007                    ADLQ    3,DL
        26 003652   200123 116100                    CMPQ    THISPX,,AUTO
        26 003653   003716 602000 26                 TNC     s:3049
        26 003654   003716 600000 26                 TZE     s:3049

     1262     3036    4           DO;

     1263     3037    4               IF DISPLAY_LIST.IND.CONSTRAINT(I) = 1 THEN

   3037 26 003655   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 003656   200117 720100                    LXL0    I,,AUTO
        26 003657   000000 236110                    LDQ     0,X0,PR0
        26 003660   777000 376003                    ANQ     -512,DU
        26 003661   001000 116003                    CMPQ    512,DU
        26 003662   003666 601000 26                 TNZ     s:3039

     1264     3038    4                   THISPX = THISPX - 2;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:181  
   3038 26 003663   200123 235100                    LDA     THISPX,,AUTO
        26 003664   000002 135007                    SBLA    2,DL
        26 003665   200123 755100                    STA     THISPX,,AUTO

     1265     3039    4               CALL ZII$FIND_IDX(REC_NO,J);

   3039 26 003666   200120 631500                    EPPR1   J,,AUTO
        26 003667   200207 451500                    STP1    DRFS$$+3,,AUTO
        26 003670   200122 633500                    EPPR3   REC_NO,,AUTO
        26 003671   200206 453500                    STP3    DRFS$$+2,,AUTO
        26 003672   200206 630500                    EPPR0   DRFS$$+2,,AUTO
        26 003673   000000 631400 27                 EPPR1   0
        26 003674   000000 701000 xent               TSX1    ZII$FIND_IDX
        26 003675   000000 011000                    NOP     0

     1266     3040    4               IF D_TABLE.OUT_CLASS(J) ~= 0 THEN

   3040 26 003676   200120 235100                    LDA     J,,AUTO
        26 003677   000002 735000                    ALS     2
        26 003700   000000 470400 7                  LDP0    D_TBL$
        26 003701   000002 235105                    LDA     2,AL,PR0
        26 003702   003706 600000 26                 TZE     s:3042

     1267     3041    4                   THISPX = THISPX - 1;

   3041 26 003703   200123 235100                    LDA     THISPX,,AUTO
        26 003704   000001 135007                    SBLA    1,DL
        26 003705   200123 755100                    STA     THISPX,,AUTO

     1268     3042    4               IF THISPX < BESTPX THEN

   3042 26 003706   200123 236100                    LDQ     THISPX,,AUTO
        26 003707   200124 116100                    CMPQ    BESTPX,,AUTO
        26 003710   003716 603000 26                 TRC     s:3049

     1269     3043    5               DO;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:182  
     1270     3044    5                   BESTPX = THISPX;

   3044 26 003711   200124 756100                    STQ     BESTPX,,AUTO

     1271     3045    5                   PORT_KEY = K;

   3045 26 003712   200121 235100                    LDA     K,,AUTO
        26 003713   200126 755100                    STA     PORT_KEY,,AUTO

     1272     3046    5                   PORT = REC_NO;

   3046 26 003714   200122 235100                    LDA     REC_NO,,AUTO
        26 003715   200125 755100                    STA     PORT,,AUTO

     1273     3047    5                   END;

     1274     3048    4               END;

     1275     3049    3           END;

   3049 26 003716   200117 235100                    LDA     I,,AUTO
        26 003717   000001 035007                    ADLA    1,DL
        26 003720   200117 755100                    STA     I,,AUTO
        26 003721   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 003722   200117 116100                    CMPQ    I,,AUTO
        26 003723   003576 603000 26                 TRC     s:3018

     1276     3050
     1277     3051    2       ACCESS_LIST.PORT = PORT;

   3051 26 003724   200125 720100                    LXL0    PORT,,AUTO
        26 003725   200005 470500                    LDP0    @ACCESS_LIST,,AUTO
        26 003726   000000 740100                    STX0    0,,PR0

     1278     3052    2       IF BESTPX > 8 THEN

   3052 26 003727   200124 235100                    LDA     BESTPX,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:183  
        26 003730   000011 115007                    CMPA    9,DL
        26 003731   003735 602000 26                 TNC     s:3055

     1279     3053    2           ACCESS_LIST.PORT_TYPE = %SERIAL_ACCESS;

   3053 26 003732   000001 221003                    LDX1    1,DU
        26 003733   000001 741100                    STX1    1,,PR0
        26 003734   003743 710000 26                 TRA     s:3060

     1280     3054    3       ELSE DO;

     1281     3055    3           ACCESS_LIST.PORT_TYPE = %KEYED_ACCESS;

   3055 26 003735   000003 221003                    LDX1    3,DU
        26 003736   000001 741100                    STX1    1,,PR0

     1282     3056    3           IF BESTPX > 4 THEN

   3056 26 003737   000005 115007                    CMPA    5,DL
        26 003740   003743 602000 26                 TNC     s:3060

     1283     3057    3               ACCESS_LIST.PORT_KEY = PORT_KEY;

   3057 26 003741   200126 722100                    LXL2    PORT_KEY,,AUTO
        26 003742   000000 442100                    SXL2    0,,PR0

     1284     3058    3           END;

     1285     3059
     1286     3060    2   END;

   3060 26 003743   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 003744   000001 702211                    TSX2  ! 1,X1

     1287     3061         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:184  
     1288     3062    1   OWNER_SET: PROC (SET_NO,OUT_RECNO) ALTRET;

   3062 26 003745   200200 741300       OWNER_SET    STX1  ! J+1,,AUTO

     1289     3063        /*
     1290     3064          DESCRIPTION: This routine finds the index into the subschema tables
     1291     3065                       of the record that owns the set defined by SET_NO.
     1292     3066                       It will altreturn if the record which owns the set
     1293     3067                       is not in the subschema (index=0).
     1294     3068
     1295     3069          IN:
     1296     3070             SET_NO := Index into the subschema tables of the set for which
     1297     3071                       the owner is to be found.
     1298     3072
     1299     3073          OUT:
     1300     3074              OUT_RECNO := Index into the subschema tables of the records that
     1301     3075                           owns the above set.
     1302     3076                                                                              */
     1303     3077    2   DCL SET_NO UBIN;
     1304     3078    2   DCL OUT_RECNO UBIN;
     1305     3079        /**/
     1306     3080    2       DS$=NAM1.DESC$(SET_NO);

   3080 26 003746   200201 470500                    LDP0    @SET_NO,,AUTO
        26 003747   000000 236100                    LDQ     0,,PR0
        26 003750   000012 402007                    MPY     10,DL
        26 003751   000000 471400 10                 LDP1    NAM1$
        26 003752   100011 236106                    LDQ     9,QL,PR1
        26 003753   000000 756000 18                 STQ     DS$

     1307     3081    2       OUT_RECNO=SET.OWNER_IDX;

   3081 26 003754   000000 473400 18                 LDP3    DS$
        26 003755   300001 236100                    LDQ     1,,PR3
        26 003756   000022 772000                    QRL     18
        26 003757   200202 474500                    LDP4    @OUT_RECNO,,AUTO
        26 003760   400000 756100                    STQ     0,,PR4
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:185  

     1308     3082    2       IF OUT_RECNO = 0 THEN

   3082 26 003761   003764 601000 26                 TNZ     s:3084

     1309     3083    2           ALTRETURN;

   3083 26 003762   200200 221300                    LDX1  ! J+1,,AUTO
        26 003763   000000 702211                    TSX2  ! 0,X1

     1310     3084    2       RETURN;

   3084 26 003764   200200 221300                    LDX1  ! J+1,,AUTO
        26 003765   000001 702211                    TSX2  ! 1,X1

     1311     3085    2   END OWNER_SET;
     1312     3086         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:186  
     1313     3087    1   MEMBER_SET: PROC (SET_NO,SET_MEMBERS) ALTRET;

   3087 26 003766   200200 741300       MEMBER_SET   STX1  ! J+1,,AUTO

     1314     3088        /*
     1315     3089          DESCRIPTION: This routine finds the indices of records that are
     1316     3090                       members of the set defined by SET_NO. It will
     1317     3091                       altreturn if the set has no members in this subschema.
     1318     3092
     1319     3093          IN:
     1320     3094             SET_NO       := Index into the subschema tables of the set for
     1321     3095                             which a member or members must be found.
     1322     3096
     1323     3097          OUT:
     1324     3098              SET_MEMBERS := Array of indices into the subschema tables for
     1325     3099                             records which are members of the above set. The
     1326     3100                             zeroth element is the count of members in the
     1327     3101                             array.
     1328     3102                                                                              */
     1329     3103    2   DCL SET_NO UBIN;
     1330     3104        %MEMBER_LIST_DESC(
     1331     3105         NAME=SET_MEMBERS,
     1332     3106         STCLASS=" ");
     1333     3114    2   DCL IDX UBIN;
     1334     3115    2   DCL DRFS$$ PTR;
     1335     3116        /**/
     1336     3117    2       DRFS$$=NAM1.DESC$(SET_NO)->SET.RFS_DSC$;

   3117 26 003767   200201 470500                    LDP0    @SET_NO,,AUTO
        26 003770   000000 236100                    LDQ     0,,PR0
        26 003771   000012 402007                    MPY     10,DL
        26 003772   000000 471400 10                 LDP1    NAM1$
        26 003773   100011 473506                    LDP3    9,QL,PR1
        26 003774   300007 236100                    LDQ     7,,PR3
        26 003775   200204 756100                    STQ     DRFS$$,,AUTO

     1337     3118    2       SET_MEMBERS='0'B;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:187  

   3118 26 003776   200202 473500                    LDP3    @SET_MEMBERS,,AUTO
        26 003777   000100 100400                    MLR     fill='000'O
        26 004000   000011 000001 27                 ADSC9   9                        cn=0,n=1
        26 004001   300000 000124                    ADSC9   0,,PR3                   cn=0,n=84

     1338     3119    2       IDX=1;

   3119 26 004002   000001 235007                    LDA     1,DL
        26 004003   200203 755100                    STA     IDX,,AUTO

     1339     3120    3       DO WHILE (DRFS$$~=ADDR(NIL));

   3120 26 004004   004027 710000 26                 TRA     s:3128

     1340     3121    3           IF DRFS$$->RFS_DSC.OWN_MEM AND IDX <= %MAX_SET_MEMBERS THEN

   3121 26 004005   200204 470500                    LDP0    DRFS$$,,AUTO
        26 004006   000001 236100                    LDQ     1,,PR0
        26 004007   400000 316007                    CANQ    -131072,DL
        26 004010   004025 600000 26                 TZE     s:3127
        26 004011   200203 235100                    LDA     IDX,,AUTO
        26 004012   000025 115007                    CMPA    21,DL
        26 004013   004025 603000 26                 TRC     s:3127

     1341     3122    4           DO;

     1342     3123    4               SET_MEMBERS.REC_NO(0)=SET_MEMBERS.REC_NO(0)+1;

   3123 26 004014   200202 471500                    LDP1    @SET_MEMBERS,,AUTO
        26 004015   100000 220100                    LDX0    0,,PR1
        26 004016   000001 621010                    EAX1    1,X0
        26 004017   100000 741100                    STX1    0,,PR1

     1343     3124    4               SET_MEMBERS.REC_NO(IDX)=DRFS$$->RFS_DSC.REC_IDX;

   3124 26 004020   000000 220100                    LDX0    0,,PR0
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:188  
        26 004021   100000 740105                    STX0    0,AL,PR1

     1344     3125    4               IDX=IDX+1;

   3125 26 004022   200203 235100                    LDA     IDX,,AUTO
        26 004023   000001 035007                    ADLA    1,DL
        26 004024   200203 755100                    STA     IDX,,AUTO

     1345     3126    4               END;

     1346     3127    3           DRFS$$=DRFS$$->RFS_DSC.SET$;

   3127 26 004025   000006 236100                    LDQ     6,,PR0
        26 004026   200204 756100                    STQ     DRFS$$,,AUTO

     1347     3128    3           END;

   3128 26 004027   000012 116000 27                 CMPQ    10
        26 004030   004005 601000 26                 TNZ     s:3121

     1348     3129    2       IF SET_MEMBERS.REC_NO(0) = 0 THEN

   3129 26 004031   200202 470500                    LDP0    @SET_MEMBERS,,AUTO
        26 004032   000000 220100                    LDX0    0,,PR0
        26 004033   004036 601000 26                 TNZ     s:3131

     1349     3130    2           ALTRETURN;

   3130 26 004034   200200 221300                    LDX1  ! J+1,,AUTO
        26 004035   000000 702211                    TSX2  ! 0,X1

     1350     3131    2       RETURN;

   3131 26 004036   200200 221300                    LDX1  ! J+1,,AUTO
        26 004037   000001 702211                    TSX2  ! 1,X1

     1351     3132    2   END MEMBER_SET;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:189  
     1352     3133         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:190  
     1353     3134    1   PICK_A_MEMBER: PROC(SET_MEMBERS,BEST_MEMBER,NEXT_VIA_SET);

   3134 26 004040   200142 741300       PICK_A_MEMB* STX1  ! K,,AUTO

     1354     3135        /**/
     1355     3136        /*I*
     1356     3137                  NAME:  PICK_A_MEMBER
     1357     3138
     1358     3139               PURPOSE:  PICK_A_MEMBER chooses one record from an array of
     1359     3140                         records which are members of a particular set.
     1360     3141                         The criteria used to choose include whether the
     1361     3142                         record is involved in display, constraint, or the
     1362     3143                         next set in the via list (if one exists). The chosen
     1363     3144                         set will be used to fill a slot in the PATH_LIST by
     1364     3145                         the calling routine.
     1365     3146
     1366     3147                  CALL:  CALL PICK_A_MEMBER(member_list,best_member,next_via_set)
     1367     3148                         where
     1368     3149                               member_list is defined as an instance of the
     1369     3150                               MEMBER_LIST_DESC macro
     1370     3151
     1371     3152                               best_member is a ubin word
     1372     3153
     1373     3154                               next_via_list is a ubin word and may be
     1374     3155                               omitted from the call if none exists.
     1375     3156
     1376     3157                  DATA:  Input:
     1377     3158
     1378     3159                                  SET_MEMBERS
     1379     3160                                  NEXT_VIA_SET
     1380     3161                                  DISPLAY_LIST
     1381     3162
     1382     3163                         Output:
     1383     3164
     1384     3165                                  BEST_MEMBER
     1385     3166
     1386     3167           DESCRIPTION:  PICK_A_MEMBER receives as input: (1) an array called
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:191  
     1387     3168                         SET_MEMBERS which contains indices into the
     1388     3169                         subschema tables of record types which can be
     1389     3170                         members of a particular set, and (2) NEXT_VIA_SET
     1390     3171                         which is the index into the subschema tables of the
     1391     3172                         next set in the VIA list (if one exists). In order
     1392     3173                         to fill an entry in the PATH_LIST, one of these
     1393     3174                         member records must be chosen. In order to do this,
     1394     3175                         a weight is computed and assigned to each member.
     1395     3176                         This weight reflects how important each member is
     1396     3177                         to the display as a whole and to this particular
     1397     3178                         place in the PATH_LIST. The following criteria are
     1398     3179                         used to decide the weight of each record, in order
     1399     3180                         from most important to least important.
     1400     3181
     1401     3182                               Record involved in:
     1402     3183
     1403     3184                               Display  Constraint  Next Set in VIA List
     1404     3185                               -------  ----------  --------------------
     1405     3186
     1406     3187                         1.       Y          Y                Y
     1407     3188                         2.                  Y                Y
     1408     3189                         3.       Y                           Y
     1409     3190                         4.                                   Y
     1410     3191                         5.       Y          Y
     1411     3192                         6.                  Y
     1412     3193                         7.       Y
     1413     3194
     1414     3195                         The first record in the list with the highest
     1415     3196                         weight will be chosen. If no records fit the
     1416     3197                         above criteria, the first record in the list will
     1417     3198                         be chosen. The record chosen is placed in
     1418     3199                         the output variable BEST_MEMBER.
     1419     3200        */
     1420     3201         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:192  
     1421     3202        %MEMBER_LIST_DESC(
     1422     3203         NAME=SET_MEMBERS,
     1423     3204         STCLASS=" ");
     1424     3212    2   DCL BEST_MEMBER UBIN;
     1425     3213    2   DCL NEXT_VIA_SET UBIN;
     1426     3214    2   DCL NEXT_VIA_OWNER UBIN;
     1427     3215        %MEMBER_LIST_DESC(
     1428     3216         NAME=NEXT_VIA_MEMBERS,
     1429     3217         STCLASS=" ");
     1430     3225    2   DCL NEXT_VIA_SET_EXISTS BIT(1) ALIGNED;
     1431     3226    2   DCL PRIO UBIN;
     1432     3227    2   DCL I UBIN;
     1433     3228    2   DCL J UBIN;
     1434     3229
     1435     3230
     1436     3231    3       IF ADDR(NEXT_VIA_SET)=ADDR(NIL) THEN DO;

   3231 26 004041   200145 236100                    LDQ     @NEXT_VIA_SET,,AUTO
        26 004042   000012 116000 27                 CMPQ    10
        26 004043   004046 601000 26                 TNZ     s:3236

   3220 26 004044                       END_VIA_LIST null
     1437     3232    3   END_VIA_LIST:;
     1438     3233    3           NEXT_VIA_SET_EXISTS='0'B;

   3233 26 004044   200174 450100                    STZ     NEXT_VIA_SET_EXISTS,,AUTO

     1439     3234    3           END;

   3234 26 004045   004064 710000 26                 TRA     s:3241

     1440     3235    3       ELSE DO;

     1441     3236    3           NEXT_VIA_SET_EXISTS='1'B;

   3236 26 004046   400000 236003                    LDQ     -131072,DU
        26 004047   200174 756100                    STQ     NEXT_VIA_SET_EXISTS,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:193  

     1442     3237    3           CALL OWNER_SET(NEXT_VIA_SET,NEXT_VIA_OWNER) ALTRET(END_VIA_LIST);

   3237 26 004050   200146 630500                    EPPR0   NEXT_VIA_OWNER,,AUTO
        26 004051   200202 450500                    STP0    @SET_MEMBERS,,AUTO
        26 004052   200145 236100                    LDQ     @NEXT_VIA_SET,,AUTO
        26 004053   200201 756100                    STQ     @SET_NO,,AUTO
        26 004054   003745 701000 26                 TSX1    OWNER_SET
        26 004055   004044 702000 26                 TSX2    END_VIA_LIST

     1443     3238    3           CALL MEMBER_SET(NEXT_VIA_SET,NEXT_VIA_MEMBERS) ALTRET(END_VIA_LIST);

   3238 26 004056   200147 630500                    EPPR0   NEXT_VIA_MEMBERS,,AUTO
        26 004057   200202 450500                    STP0    @SET_MEMBERS,,AUTO
        26 004060   200145 236100                    LDQ     @NEXT_VIA_SET,,AUTO
        26 004061   200201 756100                    STQ     @SET_NO,,AUTO
        26 004062   003766 701000 26                 TSX1    MEMBER_SET
        26 004063   004044 702000 26                 TSX2    END_VIA_LIST

     1444     3239    3           END;

     1445     3240
     1446     3241    3       DO I = 1 TO SET_MEMBERS.REC_NO(0);

   3241 26 004064   000001 235007                    LDA     1,DL
        26 004065   200176 755100                    STA     I,,AUTO
        26 004066   004166 710000 26                 TRA     s:3261+3

     1447     3242    3   FIND_MEMBER:
     1448     3243    4           DO J = 1 TO DISPLAY_LIST.REC_NO(0);

   3243 26 004067   000001 235007       FIND_MEMBER  LDA     1,DL
        26 004070   200177 755100                    STA     J,,AUTO
        26 004071   004117 710000 26                 TRA     s:3250+3

     1449     3244    4               IF SET_MEMBERS.REC_NO(I) = DISPLAY_LIST.REC_NO(J) THEN

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:194  
   3244 26 004072   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 004073   200177 720100                    LXL0    J,,AUTO
        26 004074   000000 721110                    LXL1    0,X0,PR0
        26 004075   200143 471500                    LDP1    @SET_MEMBERS,,AUTO
        26 004076   200176 722100                    LXL2    I,,AUTO
        26 004077   100000 101112                    CMPX1   0,X2,PR1
        26 004100   004114 601000 26                 TNZ     s:3250

     1450     3245    5               DO;

     1451     3246    5                   SET_MEMBERS.PRIORITY(I) = DISPLAY_LIST.IND.DISPLAY(J) +

   3246 26 004101   000000 236110                    LDQ     0,X0,PR0
        26 004102   000022 772000                    QRL     18
        26 004103   000777 376007                    ANQ     511,DL
        26 004104   200206 756100                    STQ     DRFS$$+2,,AUTO
        26 004105   000000 236110                    LDQ     0,X0,PR0
        26 004106   000032 772000                    QRL     26
        26 004107   001776 376007                    ANQ     1022,DL
        26 004110   200206 036100                    ADLQ    DRFS$$+2,,AUTO
        26 004111   000000 621006                    EAX1    0,QL
        26 004112   100000 441112                    SXL1    0,X2,PR1

     1452     3247    5                      DISPLAY_LIST.IND.CONSTRAINT(J)*2;
     1453     3248    5                   EXIT FIND_MEMBER;

   3248 26 004113   004124 710000 26                 TRA     VIA_SET_CHECK

     1454     3249    5                   END;
     1455     3250    4               END;

   3250 26 004114   200177 235100                    LDA     J,,AUTO
        26 004115   000001 035007                    ADLA    1,DL
        26 004116   200177 755100                    STA     J,,AUTO
        26 004117   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 004120   000000 236100                    LDQ     0,,PR0
        26 004121   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:195  
        26 004122   200177 116100                    CMPQ    J,,AUTO
        26 004123   004072 603000 26                 TRC     s:3244

   3247 26 004124                       VIA_SET_CHE* null
     1456     3251    3   VIA_SET_CHECK:;
     1457     3252    3           IF NEXT_VIA_SET_EXISTS THEN

   3252 26 004124   200174 234100                    SZN     NEXT_VIA_SET_EXISTS,,AUTO
        26 004125   004163 605000 26                 TPL     s:3261

     1458     3253    4           DO;

     1459     3254    4               IF SET_MEMBERS.REC_NO(I) = NEXT_VIA_OWNER THEN

   3254 26 004126   200143 471500                    LDP1    @SET_MEMBERS,,AUTO
        26 004127   200176 720100                    LXL0    I,,AUTO
        26 004130   100000 236110                    LDQ     0,X0,PR1
        26 004131   000022 772000                    QRL     18
        26 004132   200146 116100                    CMPQ    NEXT_VIA_OWNER,,AUTO
        26 004133   004140 601000 26                 TNZ     s:3256

     1460     3255    4                   SET_MEMBERS.PRIORITY(I) = SET_MEMBERS.PRIORITY(I) + 10;

   3255 26 004134   100000 721110                    LXL1    0,X0,PR1
        26 004135   000012 622011                    EAX2    10,X1
        26 004136   100000 442110                    SXL2    0,X0,PR1
        26 004137   004163 710000 26                 TRA     s:3261

     1461     3256    5               ELSE DO J = 1 TO NEXT_VIA_MEMBERS.REC_NO(0);

   3256 26 004140   000001 235007                    LDA     1,DL
        26 004141   200177 755100                    STA     J,,AUTO
        26 004142   004157 710000 26                 TRA     s:3259+3

     1462     3257    5                   IF SET_MEMBERS.REC_NO(I) = NEXT_VIA_MEMBERS.REC_NO(J) THEN

   3257 26 004143   200143 470500                    LDP0    @SET_MEMBERS,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:196  
        26 004144   200176 720100                    LXL0    I,,AUTO
        26 004145   000000 221110                    LDX1    0,X0,PR0
        26 004146   200177 722100                    LXL2    J,,AUTO
        26 004147   200147 101112                    CMPX1   NEXT_VIA_MEMBERS,X2,AUTO
        26 004150   004154 601000 26                 TNZ     s:3259

     1463     3258    5                       SET_MEMBERS.PRIORITY(I) = SET_MEMBERS.PRIORITY(I) + 10;

   3258 26 004151   000000 723110                    LXL3    0,X0,PR0
        26 004152   000012 624013                    EAX4    10,X3
        26 004153   000000 444110                    SXL4    0,X0,PR0

     1464     3259    5                   END;

   3259 26 004154   200177 235100                    LDA     J,,AUTO
        26 004155   000001 035007                    ADLA    1,DL
        26 004156   200177 755100                    STA     J,,AUTO
        26 004157   200147 236100                    LDQ     NEXT_VIA_MEMBERS,,AUTO
        26 004160   000022 772000                    QRL     18
        26 004161   200177 116100                    CMPQ    J,,AUTO
        26 004162   004143 603000 26                 TRC     s:3257

     1465     3260    4               END;

     1466     3261    3           END;

   3261 26 004163   200176 235100                    LDA     I,,AUTO
        26 004164   000001 035007                    ADLA    1,DL
        26 004165   200176 755100                    STA     I,,AUTO
        26 004166   200143 470500                    LDP0    @SET_MEMBERS,,AUTO
        26 004167   000000 236100                    LDQ     0,,PR0
        26 004170   000022 772000                    QRL     18
        26 004171   200176 116100                    CMPQ    I,,AUTO
        26 004172   004067 603000 26                 TRC     FIND_MEMBER

     1467     3262
     1468     3263    2       BEST_MEMBER = SET_MEMBERS.REC_NO(1);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:197  

   3263 26 004173   000001 236100                    LDQ     1,,PR0
        26 004174   000022 772000                    QRL     18
        26 004175   200144 471500                    LDP1    @BEST_MEMBER,,AUTO
        26 004176   100000 756100                    STQ     0,,PR1

     1469     3264    2       PRIO = 0;

   3264 26 004177   200175 450100                    STZ     PRIO,,AUTO

     1470     3265    3       DO I = 1 TO SET_MEMBERS.REC_NO(0);

   3265 26 004200   000001 235007                    LDA     1,DL
        26 004201   200176 755100                    STA     I,,AUTO
        26 004202   004224 710000 26                 TRA     s:3271+3

     1471     3266    3           IF SET_MEMBERS.PRIORITY(I) > PRIO THEN

   3266 26 004203   200143 470500                    LDP0    @SET_MEMBERS,,AUTO
        26 004204   200176 720100                    LXL0    I,,AUTO
        26 004205   000000 236110                    LDQ     0,X0,PR0
        26 004206   777777 376007                    ANQ     -1,DL
        26 004207   200175 116100                    CMPQ    PRIO,,AUTO
        26 004210   004221 602000 26                 TNC     s:3271
        26 004211   004221 600000 26                 TZE     s:3271

     1472     3267    4           DO;

     1473     3268    4               BEST_MEMBER = SET_MEMBERS.REC_NO(I);

   3268 26 004212   000000 236110                    LDQ     0,X0,PR0
        26 004213   000022 772000                    QRL     18
        26 004214   200144 471500                    LDP1    @BEST_MEMBER,,AUTO
        26 004215   100000 756100                    STQ     0,,PR1

     1474     3269    4               PRIO = SET_MEMBERS.PRIORITY(I);

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:198  
   3269 26 004216   000000 236110                    LDQ     0,X0,PR0
        26 004217   777777 376007                    ANQ     -1,DL
        26 004220   200175 756100                    STQ     PRIO,,AUTO

     1475     3270    4               END;

     1476     3271    3           END;

   3271 26 004221   200176 235100                    LDA     I,,AUTO
        26 004222   000001 035007                    ADLA    1,DL
        26 004223   200176 755100                    STA     I,,AUTO
        26 004224   000000 236100                    LDQ     0,,PR0
        26 004225   000022 772000                    QRL     18
        26 004226   200176 116100                    CMPQ    I,,AUTO
        26 004227   004203 603000 26                 TRC     s:3266

     1477     3272
     1478     3273    2       RETURN;

   3273 26 004230   200142 221300                    LDX1  ! K,,AUTO
        26 004231   000001 702211                    TSX2  ! 1,X1

     1479     3274
     1480     3275    2   END PICK_A_MEMBER;
     1481     3276         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:199  
     1482     3277         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:200  
     1483     3278    1   NOT_TBL: PROC (IN_TBL1,IN_TBL2);

   3278 26 004232   200130 741300       NOT_TBL      STX1  ! X,,AUTO

     1484     3279        /*
     1485     3280          DESCRIPTION: This Proc compares two lists and performs the
     1486     3281                       following function:   IN_TBL1=IN_TBL1~IN_TBL2     .
     1487     3282
     1488     3283          IN:
     1489     3284             IN_TBL1 := List of indices of records in the subschema tables.
     1490     3285             IN_TBL2 := Similar to IN_TBL1.
     1491     3286
     1492     3287          OUT:
     1493     3288              IN_TBL1 := Same list as IN_TBL1 but without elements contained in IN_TBL2.
     1494     3289                                                                              */
     1495     3290    2   DCL IN_TBL1 (0:0) UBIN;
     1496     3291    2   DCL IN_TBL2 (0:0) UBIN;
     1497     3292    2   DCL I UBIN AUTO;
     1498     3293    2   DCL J UBIN AUTO;
     1499     3294    2   DCL ZER_FLG UBIN AUTO;
     1500     3295        /**/
     1501     3296    2       IF IN_TBL2(0)=0 THEN

   3296 26 004233   200132 470500                    LDP0    @IN_TBL2,,AUTO
        26 004234   000000 235100                    LDA     0,,PR0
        26 004235   004237 601000 26                 TNZ     s:3298

     1502     3297    2           RETURN;

   3297 26 004236   000001 702211                    TSX2  ! 1,X1

     1503     3298    2       I=1;

   3298 26 004237   000001 236007                    LDQ     1,DL
        26 004240   200133 756100                    STQ     I,,AUTO

     1504     3299    3       DO WHILE (I<=IN_TBL1(0));
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:201  

   3299 26 004241   200131 471500                    LDP1    @IN_TBL1,,AUTO
        26 004242   100000 116100                    CMPQ    0,,PR1
        26 004243   004245 600000 26                 TZE     s:3300
        26 004244   004300 603000 26                 TRC     s:3308

     1505     3300    3           J=1;

   3300 26 004245   000001 235007                    LDA     1,DL
        26 004246   200134 755100                    STA     J,,AUTO

     1506     3301    4           DO WHILE (J<=IN_TBL2(0));

   3301 26 004247   200132 470500                    LDP0    @IN_TBL2,,AUTO
        26 004250   000000 236100                    LDQ     0,,PR0
        26 004251   200134 116100                    CMPQ    J,,AUTO
        26 004252   004271 602000 26                 TNC     s:3306

     1507     3302    4               IF IN_TBL1(I)=IN_TBL2(J) THEN

   3302 26 004253   200132 470500                    LDP0    @IN_TBL2,,AUTO
        26 004254   200134 720100                    LXL0    J,,AUTO
        26 004255   200131 471500                    LDP1    @IN_TBL1,,AUTO
        26 004256   200133 721100                    LXL1    I,,AUTO
        26 004257   100000 236111                    LDQ     0,X1,PR1
        26 004260   000000 116110                    CMPQ    0,X0,PR0
        26 004261   004263 601000 26                 TNZ     s:3304

     1508     3303    4                   IN_TBL1(I)=0;

   3303 26 004262   100000 450111                    STZ     0,X1,PR1

     1509     3304    4               J=J+1;

   3304 26 004263   200134 235100                    LDA     J,,AUTO
        26 004264   000001 035007                    ADLA    1,DL
        26 004265   200134 755100                    STA     J,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:202  

     1510     3305    4               END;

   3305 26 004266   000000 236100                    LDQ     0,,PR0
        26 004267   200134 116100                    CMPQ    J,,AUTO
        26 004270   004253 603000 26                 TRC     s:3302

     1511     3306    3           I=I+1;

   3306 26 004271   200133 235100                    LDA     I,,AUTO
        26 004272   000001 035007                    ADLA    1,DL
        26 004273   200133 755100                    STA     I,,AUTO

     1512     3307    3           END;

   3307 26 004274   200131 471500                    LDP1    @IN_TBL1,,AUTO
        26 004275   100000 236100                    LDQ     0,,PR1
        26 004276   200133 116100                    CMPQ    I,,AUTO
        26 004277   004245 603000 26                 TRC     s:3300

     1513     3308    2       J=1;

   3308 26 004300   000001 235007                    LDA     1,DL
        26 004301   200134 755100                    STA     J,,AUTO

     1514     3309    2       I=1;

   3309 26 004302   200133 755100                    STA     I,,AUTO

     1515     3310    3       DO WHILE (I<=IN_TBL1(0));

   3310 26 004303   100000 236100                    LDQ     0,,PR1
        26 004304   200133 116100                    CMPQ    I,,AUTO
        26 004305   004331 602000 26                 TNC     s:3322

     1516     3311    3           IF IN_TBL1(I)~=0 THEN

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:203  
   3311 26 004306   200131 470500                    LDP0    @IN_TBL1,,AUTO
        26 004307   200133 720100                    LXL0    I,,AUTO
        26 004310   000000 235110                    LDA     0,X0,PR0
        26 004311   004323 600000 26                 TZE     s:3320

     1517     3312    4           DO;

     1518     3313    5               DO;

     1519     3314    5                   IN_TBL1(J)=IN_TBL1(I);

   3314 26 004312   200134 721100                    LXL1    J,,AUTO
        26 004313   000000 755111                    STA     0,X1,PR0

     1520     3315    5                   IF I~=J THEN

   3315 26 004314   200133 236100                    LDQ     I,,AUTO
        26 004315   200134 116100                    CMPQ    J,,AUTO
        26 004316   004320 600000 26                 TZE     s:3317

     1521     3316    5                       IN_TBL1(I)=0;

   3316 26 004317   000000 450110                    STZ     0,X0,PR0

     1522     3317    5                   J=J+1;

   3317 26 004320   200134 235100                    LDA     J,,AUTO
        26 004321   000001 035007                    ADLA    1,DL
        26 004322   200134 755100                    STA     J,,AUTO

     1523     3318    5                   END;

     1524     3319    4               END;

     1525     3320    3           I=I+1;

   3320 26 004323   200133 235100                    LDA     I,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:204  
        26 004324   000001 035007                    ADLA    1,DL
        26 004325   200133 755100                    STA     I,,AUTO

     1526     3321    3           END;

   3321 26 004326   000000 236100                    LDQ     0,,PR0
        26 004327   200133 116100                    CMPQ    I,,AUTO
        26 004330   004306 603000 26                 TRC     s:3311

     1527     3322    2       CALL EMPTY_TBL(IN_TBL1,ZER_FLG);

   3322 26 004331   200135 630500                    EPPR0   ZER_FLG,,AUTO
        26 004332   200140 450500                    STP0    SET_NO,,AUTO
        26 004333   200131 236100                    LDQ     @IN_TBL1,,AUTO
        26 004334   200137 756100                    STQ     SAVE_REC_NO,,AUTO
        26 004335   001324 701000 26                 TSX1    EMPTY_TBL
        26 004336   000000 011000                    NOP     0

     1528     3323    2       IF ZER_FLG=1 THEN

   3323 26 004337   200135 235100                    LDA     ZER_FLG,,AUTO
        26 004340   000001 115007                    CMPA    1,DL
        26 004341   004347 601000 26                 TNZ     s:3326

     1529     3324    2           IN_TBL1(0)=J-1;

   3324 26 004342   200131 470500                    LDP0    @IN_TBL1,,AUTO
        26 004343   200134 236100                    LDQ     J,,AUTO
        26 004344   000001 136007                    SBLQ    1,DL
        26 004345   000000 756100                    STQ     0,,PR0
        26 004346   004351 710000 26                 TRA     s:3327

     1530     3325    2       ELSE
     1531     3326    2           IN_TBL1(0)=0;

   3326 26 004347   200131 470500                    LDP0    @IN_TBL1,,AUTO
        26 004350   000000 450100                    STZ     0,,PR0
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:205  

     1532     3327    2       RETURN;

   3327 26 004351   200130 221300                    LDX1  ! X,,AUTO
        26 004352   000001 702211                    TSX2  ! 1,X1

     1533     3328    2   END NOT_TBL;
     1534     3329         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:206  
     1535     3330    1   UNION_MAT: PROC (IN_TBL1,IN_TBL2);

   3330 26 004353   200130 741300       UNION_MAT    STX1  ! X,,AUTO

     1536     3331        /*
     1537     3332          DESCRIPTION: This Proc takes two lists as input and performs the
     1538     3333                       following function:   IN_TBL1=IN_TBL1 (concatenated with) IN_TBL2  .
     1539     3334
     1540     3335          IN:
     1541     3336             IN_TBL1 := List of indices of records in the subschema tables.
     1542     3337             IN_TBL2 := List of record indices into the subschema tables.
     1543     3338
     1544     3339          OUT:
     1545     3340              IN_TBL1 := Same as above but concatenated with IN_TBL2.
     1546     3341                                                                              */
     1547     3342    2   DCL IN_TBL2 (0:0) UBIN;
     1548     3343    2   DCL IN_TBL1 (0:0) UBIN;
     1549     3344    2   DCL I UBIN AUTO;
     1550     3345    2   DCL J UBIN AUTO;
     1551     3346        /**/
     1552     3347        %D_DESC;
     1553     3356        %D2_DESC;
     1554     3363        %TBL_DIM_DESC;
     1555     3368        /**/
     1556     3369    2       I=IN_TBL1(0)+1;

   3369 26 004354   200131 470500                    LDP0    @IN_TBL1,,AUTO
        26 004355   000000 235100                    LDA     0,,PR0
        26 004356   000001 035007                    ADLA    1,DL
        26 004357   200133 755100                    STA     I,,AUTO

     1557     3370    2       J=1;

   3370 26 004360   000001 236007                    LDQ     1,DL
        26 004361   200134 756100                    STQ     J,,AUTO

     1558     3371    3       DO WHILE (J<=IN_TBL2(0));
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:207  

   3371 26 004362   200132 471500                    LDP1    @IN_TBL2,,AUTO
        26 004363   100000 116100                    CMPQ    0,,PR1
        26 004364   004366 600000 26                 TZE     s:3372
        26 004365   004410 603000 26                 TRC     s:3377

     1559     3372    3           IN_TBL1(I)=IN_TBL2(J);

   3372 26 004366   200132 470500                    LDP0    @IN_TBL2,,AUTO
        26 004367   200134 720100                    LXL0    J,,AUTO
        26 004370   200131 471500                    LDP1    @IN_TBL1,,AUTO
        26 004371   200133 721100                    LXL1    I,,AUTO
        26 004372   000000 235110                    LDA     0,X0,PR0
        26 004373   100000 755111                    STA     0,X1,PR1

     1560     3373    3           J=J+1;

   3373 26 004374   200134 236100                    LDQ     J,,AUTO
        26 004375   000001 036007                    ADLQ    1,DL
        26 004376   200134 756100                    STQ     J,,AUTO

     1561     3374    3           I=I+1;

   3374 26 004377   200133 235100                    LDA     I,,AUTO
        26 004400   000001 035007                    ADLA    1,DL
        26 004401   200133 755100                    STA     I,,AUTO

     1562     3375    3           IN_TBL1(0)=IN_TBL1(0)+1;

   3375 26 004402   100000 235100                    LDA     0,,PR1
        26 004403   000001 035007                    ADLA    1,DL
        26 004404   100000 755100                    STA     0,,PR1

     1563     3376    3           END;

   3376 26 004405   000000 116100                    CMPQ    0,,PR0
        26 004406   004366 602000 26                 TNC     s:3372
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:208  
        26 004407   004366 600000 26                 TZE     s:3372

     1564     3377    2       RETURN;

   3377 26 004410   200130 221300                    LDX1  ! X,,AUTO
        26 004411   000001 702211                    TSX2  ! 1,X1

     1565     3378    2   END UNION_MAT;
     1566     3379         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:209  
     1567     3380    1   NOT_PATHPT: PROC (PATH_LIST,IN_PT);

   3380 26 004412   200122 741300       NOT_PATHPT   STX1  ! REC_NO,,AUTO

     1568     3381        /*
     1569     3382        DESCRIPTION: This proc takes the PATH_LIST and IN_PT as input and
     1570     3383                     performs the following function:
     1571     3384                                        PATH_LIST=PATH_LIST ~ IN_PT   .
     1572     3385
     1573     3386          IN:
     1574     3387             PATH_LIST := structure defined in ZI$PATH_STRUCTS containing
     1575     3388                          information about retrieval.
     1576     3389             IN_PT := single index of a record index into the subschema tables
     1577     3390
     1578     3391          OUT:
     1579     3392              PATH_LIST := Same as above exept all occurrences with the
     1580     3393                           same REC_NO as IN_PT are removed.
     1581     3394                                                                              */
     1582     3395    2   DCL IN_PT UBIN(18);
     1583     3396    2   DCL ZER_FLG UBIN AUTO;
     1584     3397    2   DCL I UBIN AUTO;
     1585     3398    2   DCL J UBIN AUTO;
     1586     3399        /**/
     1587     3400        %PATH_DESC (STCLASS=" ");
     1588     3440        /**/
     1589     3441    3       DO;

     1590     3442    3           I=1;

   3442 26 004413   000001 235007                    LDA     1,DL
        26 004414   200126 755100                    STA     I,,AUTO

     1591     3443    4           DO WHILE (I<=REC_NO);

   3443 26 004415   200015 236100                    LDQ     REC_NO,,AUTO
        26 004416   200126 116100                    CMPQ    I,,AUTO
        26 004417   004441 602000 26                 TNC     s:3451
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:210  

     1592     3444    4               IF PATH_LIST.REC_NO(I)=IN_PT THEN

   3444 26 004420   200126 236100                    LDQ     I,,AUTO
        26 004421   000005 402007                    MPY     5,DL
        26 004422   200123 470500                    LDP0    @PATH_LIST,,AUTO
        26 004423   000000 220106                    LDX0    0,QL,PR0
        26 004424   200124 471500                    LDP1    @IN_PT,,AUTO
        26 004425   100000 100100                    CMPX0   0,,PR1
        26 004426   004433 601000 26                 TNZ     s:3449

     1593     3445    5               DO;

     1594     3446    5                   PATH_LIST.REC_NO(I)=0;

   3446 26 004427   000000 221003                    LDX1    0,DU
        26 004430   000000 741106                    STX1    0,QL,PR0

     1595     3447    5                   I=REC_NO;

   3447 26 004431   200015 235100                    LDA     REC_NO,,AUTO
        26 004432   200126 755100                    STA     I,,AUTO

     1596     3448    5                   END;

     1597     3449    4               I=I+1;

   3449 26 004433   200126 235100                    LDA     I,,AUTO
        26 004434   000001 035007                    ADLA    1,DL
        26 004435   200126 755100                    STA     I,,AUTO

     1598     3450    4               END;

   3450 26 004436   200015 236100                    LDQ     REC_NO,,AUTO
        26 004437   200126 116100                    CMPQ    I,,AUTO
        26 004440   004420 603000 26                 TRC     s:3444

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:211  
     1599     3451    3           I=1;

   3451 26 004441   000001 235007                    LDA     1,DL
        26 004442   200126 755100                    STA     I,,AUTO

     1600     3452    3           J=1;

   3452 26 004443   200127 755100                    STA     J,,AUTO

     1601     3453    4           DO WHILE (I<=REC_NO);

   3453 26 004444   200126 116100                    CMPQ    I,,AUTO
        26 004445   004537 602000 26                 TNC     s:3469

     1602     3454    4               IF PATH_LIST.REC_NO(I)~=0 THEN

   3454 26 004446   200126 236100                    LDQ     I,,AUTO
        26 004447   000005 402007                    MPY     5,DL
        26 004450   200123 470500                    LDP0    @PATH_LIST,,AUTO
        26 004451   000000 220106                    LDX0    0,QL,PR0
        26 004452   004531 600000 26                 TZE     s:3467

     1603     3455    5               DO;

     1604     3456    5                   PATH_LIST.REC_NO(J)=PATH_LIST.REC_NO(I);

   3456 26 004453   200127 236100                    LDQ     J,,AUTO
        26 004454   000005 402007                    MPY     5,DL
        26 004455   000000 620006                    EAX0    0,QL
        26 004456   200126 236100                    LDQ     I,,AUTO
        26 004457   000005 402007                    MPY     5,DL
        26 004460   000000 221106                    LDX1    0,QL,PR0
        26 004461   000000 741110                    STX1    0,X0,PR0

     1605     3457    5                   PATH_LIST.SET_NO(J)=PATH_LIST.SET_NO(I);

   3457 26 004462   000000 722106                    LXL2    0,QL,PR0
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:212  
        26 004463   000000 442110                    SXL2    0,X0,PR0

     1606     3458    5                   PATH_LIST.OWN_NEXT(J)=PATH_LIST.OWN_NEXT(I);

   3458 26 004464   000001 236106                    LDQ     1,QL,PR0
        26 004465   000001 676110                    ERQ     1,X0,PR0
        26 004466   400000 376003                    ANQ     -131072,DU
        26 004467   000001 656110                    ERSQ    1,X0,PR0

     1607     3459    5                   PATH_LIST.GET_IND(J)=PATH_LIST.GET_IND(I);

   3459 26 004470   200126 236100                    LDQ     I,,AUTO
        26 004471   000005 402007                    MPY     5,DL
        26 004472   000001 236106                    LDQ     1,QL,PR0
        26 004473   000001 676110                    ERQ     1,X0,PR0
        26 004474   200000 376003                    ANQ     65536,DU
        26 004475   000001 656110                    ERSQ    1,X0,PR0

     1608     3460    5                   PATH_LIST.FIND_ATTEMPTED(J)=PATH_LIST.FIND_ATTEMPTED(I);

   3460 26 004476   200126 236100                    LDQ     I,,AUTO
        26 004477   000005 402007                    MPY     5,DL
        26 004500   000001 236106                    LDQ     1,QL,PR0
        26 004501   000001 676110                    ERQ     1,X0,PR0
        26 004502   100000 376003                    ANQ     32768,DU
        26 004503   000001 656110                    ERSQ    1,X0,PR0

     1609     3461    5                   PATH_LIST.DISPLAY_IND(J)=PATH_LIST.DISPLAY_IND(I);

   3461 26 004504   200126 236100                    LDQ     I,,AUTO
        26 004505   000005 402007                    MPY     5,DL
        26 004506   000001 236106                    LDQ     1,QL,PR0
        26 004507   000001 676110                    ERQ     1,X0,PR0
        26 004510   010000 376003                    ANQ     4096,DU
        26 004511   000001 656110                    ERSQ    1,X0,PR0

     1610     3462    5                   PATH_LIST.INIT_EPTR(J)=PATH_LIST.INIT_EPTR(I);
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:213  

   3462 26 004512   200126 236100                    LDQ     I,,AUTO
        26 004513   000005 402007                    MPY     5,DL
        26 004514   000002 236106                    LDQ     2,QL,PR0
        26 004515   000002 756110                    STQ     2,X0,PR0

     1611     3463    5                   PATH_LIST.CONVERT_EPTR(J)=PATH_LIST.CONVERT_EPTR(I);

   3463 26 004516   200126 236100                    LDQ     I,,AUTO
        26 004517   000005 402007                    MPY     5,DL
        26 004520   000003 236106                    LDQ     3,QL,PR0
        26 004521   000003 756110                    STQ     3,X0,PR0

     1612     3464    5                   PATH_LIST.CONSTRAINT_EPTR(J)=PATH_LIST.CONSTRAINT_EPTR(I);

   3464 26 004522   200126 236100                    LDQ     I,,AUTO
        26 004523   000005 402007                    MPY     5,DL
        26 004524   000004 236106                    LDQ     4,QL,PR0
        26 004525   000004 756110                    STQ     4,X0,PR0

     1613     3465    5                   J=J+1;

   3465 26 004526   200127 235100                    LDA     J,,AUTO
        26 004527   000001 035007                    ADLA    1,DL
        26 004530   200127 755100                    STA     J,,AUTO

     1614     3466    5                   END;

     1615     3467    4               I=I+1;

   3467 26 004531   200126 235100                    LDA     I,,AUTO
        26 004532   000001 035007                    ADLA    1,DL
        26 004533   200126 755100                    STA     I,,AUTO

     1616     3468    4               END;

   3468 26 004534   200015 236100                    LDQ     REC_NO,,AUTO
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:214  
        26 004535   200126 116100                    CMPQ    I,,AUTO
        26 004536   004446 603000 26                 TRC     s:3454

     1617     3469    3           CALL EMPTY_PATHTBL(PATH_LIST,ZER_FLG);

   3469 26 004537   200125 630500                    EPPR0   ZER_FLG,,AUTO
        26 004540   200132 450500                    STP0    @IN_TBL2,,AUTO
        26 004541   200123 236100                    LDQ     @PATH_LIST,,AUTO
        26 004542   200131 756100                    STQ     @IN_TBL1,,AUTO
        26 004543   004562 701000 26                 TSX1    EMPTY_PATHTBL
        26 004544   000000 011000                    NOP     0

     1618     3470    3           IF ZER_FLG=1 THEN

   3470 26 004545   200125 235100                    LDA     ZER_FLG,,AUTO
        26 004546   000001 115007                    CMPA    1,DL
        26 004547   004554 601000 26                 TNZ     s:3473

     1619     3471    3               REC_NO=J-1;

   3471 26 004550   200127 236100                    LDQ     J,,AUTO
        26 004551   000001 136007                    SBLQ    1,DL
        26 004552   200015 756100                    STQ     REC_NO,,AUTO
        26 004553   004555 710000 26                 TRA     s:3474

     1620     3472    3           ELSE
     1621     3473    3               REC_NO=0;

   3473 26 004554   200015 450100                    STZ     REC_NO,,AUTO

     1622     3474    3           PATH_LIST.REC_NO(0)=REC_NO;

   3474 26 004555   200015 720100                    LXL0    REC_NO,,AUTO
        26 004556   200123 470500                    LDP0    @PATH_LIST,,AUTO
        26 004557   000000 740100                    STX0    0,,PR0

     1623     3475    3           RETURN;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:215  

   3475 26 004560   200122 221300                    LDX1  ! REC_NO,,AUTO
        26 004561   000001 702211                    TSX2  ! 1,X1

     1624     3476    3           END;
     1625     3477         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:216  
     1626     3478    2   EMPTY_PATHTBL: PROC (PATH_LIST,OUT_FLG);

   3478 26 004562   200130 741300       EMPTY_PATHT* STX1  ! X,,AUTO

     1627     3479        /*
     1628     3480          DESCRIPTION: This Proc determines if the PATH_LIST is null after
     1629     3481                       extractions are made from it.
     1630     3482
     1631     3483          IN:
     1632     3484             PATH_LIST := same as above.
     1633     3485             OUT_FLG := Indicator for null condition: 0 = List is null,
     1634     3486                                                      1 = List is not null.
     1635     3487                                                                              */
     1636     3488    3   DCL OUT_FLG UBIN;
     1637     3489    3   DCL N UBIN AUTO;
     1638     3490    3   DCL K UBIN AUTO;
     1639     3491        /**/
     1640     3492        %PATH_DESC (STCLASS=" ");
     1641     3532        /**/
     1642     3533    3       OUT_FLG=0;

   3533 26 004563   200132 470500                    LDP0    @OUT_FLG,,AUTO
        26 004564   000000 450100                    STZ     0,,PR0

     1643     3534    3       N=1;

   3534 26 004565   000001 235007                    LDA     1,DL
        26 004566   200133 755100                    STA     N,,AUTO

     1644     3535    4       DO WHILE (N<=REC_NO);

   3535 26 004567   200015 236100                    LDQ     REC_NO,,AUTO
        26 004570   200133 116100                    CMPQ    N,,AUTO
        26 004571   004612 602000 26                 TNC     s:3543

     1645     3536    4           IF PATH_LIST.REC_NO(N)~=0 THEN

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:217  
   3536 26 004572   200133 236100                    LDQ     N,,AUTO
        26 004573   000005 402007                    MPY     5,DL
        26 004574   200131 470500                    LDP0    @PATH_LIST,,AUTO
        26 004575   000000 220106                    LDX0    0,QL,PR0
        26 004576   004604 600000 26                 TZE     s:3541

     1646     3537    5           DO;

     1647     3538    5               OUT_FLG=1;

   3538 26 004577   000001 235007                    LDA     1,DL
        26 004600   200132 471500                    LDP1    @OUT_FLG,,AUTO
        26 004601   100000 755100                    STA     0,,PR1

     1648     3539    5               RETURN;

   3539 26 004602   200130 221300                    LDX1  ! X,,AUTO
        26 004603   000001 702211                    TSX2  ! 1,X1

     1649     3540    5               END;
     1650     3541    4           N=N+1;

   3541 26 004604   200133 235100                    LDA     N,,AUTO
        26 004605   000001 035007                    ADLA    1,DL
        26 004606   200133 755100                    STA     N,,AUTO

     1651     3542    4           END;

   3542 26 004607   200015 236100                    LDQ     REC_NO,,AUTO
        26 004610   200133 116100                    CMPQ    N,,AUTO
        26 004611   004572 603000 26                 TRC     s:3536

     1652     3543    3       RETURN;

   3543 26 004612   200130 221300                    LDX1  ! X,,AUTO
        26 004613   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:218  
     1653     3544    3   END EMPTY_PATHTBL;
     1654     3545    2   END NOT_PATHPT;
     1655     3546         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:219  
     1656     3547    1   NOT_PATHTBL: PROC (TDISPLAY_LIST,PATH_LIST);

   3547 26 004614   200116 741300       NOT_PATHTBL  STX1  ! MEMBER_LIST+22,,AUTO

     1657     3548        /*
     1658     3549          DESCRIPTION: This Proc extracts all occurrences of TDISPLAY_LIST
     1659     3550                       that correspond with PATH_LIST.REC_NOs. This routine is
     1660     3551                       used to eliminate from TDISPLAY_LIST all records that
     1661     3552                       have been covered so far by the Path. When the
     1662     3553                       TDISPLAY_LIST becomes null, processing in the Topology
     1663     3554                       module is complete.
     1664     3555
     1665     3556          IN:
     1666     3557             TDISPLAY_LIST := List of record indices into the subschema
     1667     3558                              tables.
     1668     3559             PATH_LIST := Structure defined in ZI$PATH_STRUCTS which contains
     1669     3560                          all information for retrieval.
     1670     3561
     1671     3562          OUT:
     1672     3563              TDISPLAY_LIST := same as above but all occurrences that
     1673     3564                               correspond to REC_NO in PATH_LIST are
     1674     3565                               eliminated.
     1675     3566                                                                              */
     1676     3567    2   DCL I UBIN AUTO;
     1677     3568    2   DCL J UBIN AUTO;
     1678     3569    2   DCL ZER_FLG UBIN AUTO;
     1679     3570        /**/
     1680     3571        %PATH_DESC (STCLASS=" ");
     1681     3611    2   DCL TDISPLAY_LIST(0:0) UBIN;
     1682     3612        /**/
     1683     3613    2       IF REC_NO=0 THEN

   3613 26 004615   200015 235100                    LDA     REC_NO,,AUTO
        26 004616   004620 601000 26                 TNZ     s:3615

     1684     3614    2           RETURN;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:220  
   3614 26 004617   000001 702211                    TSX2  ! 1,X1

     1685     3615    2       I=1;

   3615 26 004620   000001 236007                    LDQ     1,DL
        26 004621   200121 756100                    STQ     I,,AUTO

     1686     3616    3       DO WHILE (I<=TDISPLAY_LIST#);

   3616 26 004622   200013 116100                    CMPQ    TDISPLAY_LIST#,,AUTO
        26 004623   004625 600000 26                 TZE     s:3617
        26 004624   004662 603000 26                 TRC     s:3627

     1687     3617    3           J=1;

   3617 26 004625   000001 235007                    LDA     1,DL
        26 004626   200122 755100                    STA     J,,AUTO

     1688     3618    4           DO WHILE (J<=REC_NO);

   3618 26 004627   200015 236100                    LDQ     REC_NO,,AUTO
        26 004630   200122 116100                    CMPQ    J,,AUTO
        26 004631   004654 602000 26                 TNC     s:3625

     1689     3619    5               IF TDISPLAY_LIST(I)=PATH_LIST.REC_NO(J) THEN DO;

   3619 26 004632   200117 470500                    LDP0    @TDISPLAY_LIST,,AUTO
        26 004633   200121 720100                    LXL0    I,,AUTO
        26 004634   200122 236100                    LDQ     J,,AUTO
        26 004635   000005 402007                    MPY     5,DL
        26 004636   200120 471500                    LDP1    @PATH_LIST,,AUTO
        26 004637   100000 236106                    LDQ     0,QL,PR1
        26 004640   000022 772000                    QRL     18
        26 004641   000000 116110                    CMPQ    0,X0,PR0
        26 004642   004646 601000 26                 TNZ     s:3623

     1690     3620    5                   TDISPLAY_LIST(I)=0;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:221  

   3620 26 004643   000000 450110                    STZ     0,X0,PR0

     1691     3621    5                   J = REC_NO;

   3621 26 004644   200015 235100                    LDA     REC_NO,,AUTO
        26 004645   200122 755100                    STA     J,,AUTO

     1692     3622    5                   END;

     1693     3623    4               J=J+1;

   3623 26 004646   200122 235100                    LDA     J,,AUTO
        26 004647   000001 035007                    ADLA    1,DL
        26 004650   200122 755100                    STA     J,,AUTO

     1694     3624    4               END;

   3624 26 004651   200015 236100                    LDQ     REC_NO,,AUTO
        26 004652   200122 116100                    CMPQ    J,,AUTO
        26 004653   004632 603000 26                 TRC     s:3619

     1695     3625    3           I=I+1;

   3625 26 004654   200121 235100                    LDA     I,,AUTO
        26 004655   000001 035007                    ADLA    1,DL
        26 004656   200121 755100                    STA     I,,AUTO

     1696     3626    3           END;

   3626 26 004657   200013 236100                    LDQ     TDISPLAY_LIST#,,AUTO
        26 004660   200121 116100                    CMPQ    I,,AUTO
        26 004661   004625 603000 26                 TRC     s:3617

     1697     3627    2       J=1;

   3627 26 004662   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:222  
        26 004663   200122 755100                    STA     J,,AUTO

     1698     3628    3       DO I = 1 TO TDISPLAY_LIST#;

   3628 26 004664   200121 755100                    STA     I,,AUTO
        26 004665   004706 710000 26                 TRA     s:3637+3

     1699     3629    3           IF TDISPLAY_LIST(I)~=0 THEN

   3629 26 004666   200117 470500                    LDP0    @TDISPLAY_LIST,,AUTO
        26 004667   200121 720100                    LXL0    I,,AUTO
        26 004670   000000 235110                    LDA     0,X0,PR0
        26 004671   004703 600000 26                 TZE     s:3637

     1700     3630    4           DO;

     1701     3631    5               IF I~=J THEN DO;

   3631 26 004672   200121 236100                    LDQ     I,,AUTO
        26 004673   200122 116100                    CMPQ    J,,AUTO
        26 004674   004700 600000 26                 TZE     s:3635

     1702     3632    5                   TDISPLAY_LIST(J)=TDISPLAY_LIST(I);

   3632 26 004675   200122 721100                    LXL1    J,,AUTO
        26 004676   000000 755111                    STA     0,X1,PR0

     1703     3633    5                   TDISPLAY_LIST(I)=0;

   3633 26 004677   000000 450110                    STZ     0,X0,PR0

     1704     3634    5                   END;

     1705     3635    4               J=J+1;

   3635 26 004700   200122 235100                    LDA     J,,AUTO
        26 004701   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:223  
        26 004702   200122 755100                    STA     J,,AUTO

     1706     3636    4               END;

     1707     3637    3           END;

   3637 26 004703   200121 235100                    LDA     I,,AUTO
        26 004704   000001 035007                    ADLA    1,DL
        26 004705   200121 755100                    STA     I,,AUTO
        26 004706   200013 236100                    LDQ     TDISPLAY_LIST#,,AUTO
        26 004707   200121 116100                    CMPQ    I,,AUTO
        26 004710   004666 603000 26                 TRC     s:3629

     1708     3638    2       CALL EMPTY_TBL(TDISPLAY_LIST,ZER_FLG);

   3638 26 004711   200123 630500                    EPPR0   ZER_FLG,,AUTO
        26 004712   200140 450500                    STP0    SET_NO,,AUTO
        26 004713   200117 236100                    LDQ     @TDISPLAY_LIST,,AUTO
        26 004714   200137 756100                    STQ     SAVE_REC_NO,,AUTO
        26 004715   001324 701000 26                 TSX1    EMPTY_TBL
        26 004716   000000 011000                    NOP     0

     1709     3639    2       IF ZER_FLG=1 THEN

   3639 26 004717   200123 235100                    LDA     ZER_FLG,,AUTO
        26 004720   000001 115007                    CMPA    1,DL
        26 004721   004726 601000 26                 TNZ     s:3642

     1710     3640    2           TDISPLAY_LIST# = J-1;

   3640 26 004722   200122 236100                    LDQ     J,,AUTO
        26 004723   000001 136007                    SBLQ    1,DL
        26 004724   200013 756100                    STQ     TDISPLAY_LIST#,,AUTO
        26 004725   004727 710000 26                 TRA     s:3643

     1711     3641    2       ELSE
     1712     3642    2           TDISPLAY_LIST# = 0;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:224  

   3642 26 004726   200013 450100                    STZ     TDISPLAY_LIST#,,AUTO

     1713     3643    2       TDISPLAY_LIST(0) = TDISPLAY_LIST#;

   3643 26 004727   200117 470500                    LDP0    @TDISPLAY_LIST,,AUTO
        26 004730   200013 236100                    LDQ     TDISPLAY_LIST#,,AUTO
        26 004731   000000 756100                    STQ     0,,PR0

     1714     3644    2       RETURN;

   3644 26 004732   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 004733   000001 702211                    TSX2  ! 1,X1

     1715     3645    2   END NOT_PATHTBL;
     1716     3646        %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:225  
     1717     3647    1   SET_DISPLAY_IND: PROC;

   3647 26 004734   200116 741300       SET_DISPLAY* STX1  ! MEMBER_LIST+22,,AUTO

     1718     3648    2   DCL J UBIN WORD;
     1719     3649        /**/
     1720     3650    3       DO J=1 TO DISPLAY_LIST#;

   3650 26 004735   000001 235007                    LDA     1,DL
        26 004736   200117 755100                    STA     J,,AUTO
        26 004737   004767 710000 26                 TRA     s:3657+3

     1721     3651    3           IF DISPLAY_LIST.REC_NO(J) = PATH_LIST.REC_NO(REC_NO)

   3651 26 004740   200003 470500                    LDP0    @DISPLAY_LIST,,AUTO
        26 004741   200117 720100                    LXL0    J,,AUTO
        26 004742   000000 721110                    LXL1    0,X0,PR0
        26 004743   200015 236100                    LDQ     REC_NO,,AUTO
        26 004744   000005 402007                    MPY     5,DL
        26 004745   200014 471500                    LDP1    PATH$,,AUTO
        26 004746   100000 101106                    CMPX1   0,QL,PR1
        26 004747   004764 601000 26                 TNZ     s:3657
        26 004750   000000 236110                    LDQ     0,X0,PR0
        26 004751   000777 376003                    ANQ     511,DU
        26 004752   000001 116003                    CMPQ    1,DU
        26 004753   004764 601000 26                 TNZ     s:3657

     1722     3652    3              AND DISPLAY_LIST.IND.DISPLAY(J) = 1 THEN
     1723     3653    4           DO;

     1724     3654    4               PATH_LIST.DISPLAY_IND(REC_NO)='1'B;

   3654 26 004754   200015 236100                    LDQ     REC_NO,,AUTO
        26 004755   000005 402007                    MPY     5,DL
        26 004756   000000 622006                    EAX2    0,QL
        26 004757   010000 236003                    LDQ     4096,DU
        26 004760   100001 256112                    ORSQ    1,X2,PR1
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:226  

     1725     3655    4               J=DISPLAY_LIST#+1;

   3655 26 004761   200012 235100                    LDA     DISPLAY_LIST#,,AUTO
        26 004762   000001 035007                    ADLA    1,DL
        26 004763   200117 755100                    STA     J,,AUTO

     1726     3656    4               END;

     1727     3657    3           END;

   3657 26 004764   200117 235100                    LDA     J,,AUTO
        26 004765   000001 035007                    ADLA    1,DL
        26 004766   200117 755100                    STA     J,,AUTO
        26 004767   200012 236100                    LDQ     DISPLAY_LIST#,,AUTO
        26 004770   200117 116100                    CMPQ    J,,AUTO
        26 004771   004740 603000 26                 TRC     s:3651

     1728     3658    2       RETURN;

   3658 26 004772   200116 221300                    LDX1  ! MEMBER_LIST+22,,AUTO
        26 004773   000001 702211                    TSX2  ! 1,X1

VIA_ERROR
 Sect OctLoc
   1     000   040127 141162   156151 156147   072040 104151   163143 157156     Warning: Discon
   1     004   156145 143164   145144 040126   111101 040154   151163 164056    nected VIA list.
   1     010   040124 150145   040146 157154   154157 167151   156147 040163     The following s
   1     014   145164 163040   155151 147150   164040 156157   164040 142145    ets might not be
   1     020   040165 163145   144072 ******                                     used:..

ERR_LINE
 Sect OctLoc
   2     000   040040 040040   ****** ******   ****** ******   ****** ******        ............
   2     010*  ****** ******                                                    ....

BLNK_LINE
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:227  
 Sect OctLoc
   2     011   040040 040040

DUMMY_VECTOR
 Sect OctLoc
   2     012   000000 177640   000000 006014                                    ........

ERR_OUT
 Sect OctLoc
   2     014   000003 777640   000024 006000   000000 177640   000000 006014    ................
   2     020   000021 377640   000000 006000   000000 177640   000000 006014    ................
   2     024   000000 400400   000000 000000   000000 000000   000000 000000    ................

LO_DO
 Sect OctLoc
   2     030   000001 777640   000032 006000   000000 000000   ****** ******    ................

M
 Sect OctLoc
   2     034   ****** ******   ****** ******   ****** ******   ****** ******    ................

W
 Sect OctLoc
   2     345   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
  27     000   000002 000000   000012 006000   000000 000002   000000 000001    ................
  27     004   000002 006000   000003 006000   377777 777777   677777 777777    ................
  27     010   737777 777777   000000 000000   000000 006014   000003 006000    ................
  27     014   000003 006000   000000 000000   000000 777640   000011 006000    ................
  27     020   000021 377640   000000 006000   000010 777640   000000 006000    ................
  27     024   000003 000000   577777 777777   000011 006000   000345 006000    ................
  27     030   000034 006000                                                    ....
     1729     3659    2   END SET_DISPLAY_IND;
     1730     3660         /* .................Comment out the unused code..............................
     1731     3661         %EJECT;
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:228  
     1732     3662         ELIMINATE_SETS: PROC;
     1733     3663         DCL J UBIN WORD;
     1734     3664         DCL K UBIN WORD;
     1735     3665
     1736     3666            N=1;
     1737     3667            DO J=1 TO REC_NO;
     1738     3668            DO K=1 TO VIA_LIST(0);
     1739     3669            IF PATH_LIST.SET_NO(J)=VIA_LIST(K) THEN
     1740     3670            N=N+1;
     1741     3671            END;
     1742     3672            END;
     1743     3673            RETURN;
     1744     3674            END ELIMINATE_SETS;
     1745     3675         ...........................................................................*/
     1746     3676    1   END ZII$TOPOLOGY;
     1747     3677        %EOD;

PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:229  
--  Include file information  --

   ZI_IDPERR_SUBS.:ZIC0TOU  is referenced.
   ZI$PATH_STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$TOPOLOGY.

   Procedure ZII$TOPOLOGY requires 2556 words for executable code.
   Procedure ZII$TOPOLOGY requires 138 words of local(AUTO) storage.
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:230  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:231  
          MINI XREF LISTING

ACCESS_LIST
      1810**DCL       145--PROC     2333<>CALL     2366<>CALL     2377<>CALL
ACCESS_LIST.DIRECT
      1822**DCL      1824--REDEF    1831--REDEF
ACCESS_LIST.PORT
      1811**DCL      1978>>IF       2003>>ASSIGN   2006>>ASSIGN   2026>>ASSIGN   2027>>IF       2960<<ASSIGN
      2971<<ASSIGN   2987>>IF       2988>>ASSIGN   3051<<ASSIGN
ACCESS_LIST.PORT_KEY
      1813**DCL      2964<<ASSIGN   2975<<ASSIGN   2990<<ASSIGN   3025>>IF       3029>>IF       3057<<ASSIGN
ACCESS_LIST.PORT_TYPE
      1815**DCL      1986>>IF       2962<<ASSIGN   2965<<ASSIGN   2973<<ASSIGN   2976<<ASSIGN   2991<<ASSIGN
      2993<<ASSIGN   3053<<ASSIGN   3055<<ASSIGN
ADD_TO_LAMBDA_RECS IN PROCEDURE BACK_TRACK_MAYBE
      2477**DCL      2654<<ASSIGN   2659<<ASSIGN   2661>>IF
BACK_TRACK_MAYBE
      2444**PROC     2296--CALL
BESTPX IN PROCEDURE SELECT_PORT
      2915**DCL      3016<<ASSIGN   3035>>IF       3042>>IF       3044<<ASSIGN   3052>>IF       3056>>IF
BEST_MEMBER IN PROCEDURE PICK_A_MEMBER
      3212**DCL      3134--PROC     3263<<ASSIGN   3268<<ASSIGN
BLNK_LINE
       178**DCL      2155--ASSIGN   2159--ASSIGN   2168--ASSIGN
CANDIDATE_LIST
      1753**DCL       145--PROC
CANDIDATE_LIST.KEY_NO
      1758**DCL      2961>>IF       2964>>ASSIGN   2967<<ASSIGN   2972>>IF       2975>>ASSIGN   2978<<ASSIGN
CANDIDATE_LIST.REC_NO
      1754**DCL      2953>>IF       2955>>DOINDEX  2956>>ASSIGN
COMMON_REDEF.WORD_OFFSET
       149**DCL      1956>>ASSIGN
COMPRESS_PATH
      2690**PROC     2308--CALL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:232  
COMP_DIST
      2808**PROC     2030--CALL     2240--CALL
CURRENT_NODE
       184**DCL      2033<<ASSIGN   2045>>IF       2071<<ASSIGN   2074>>IF       2087<<ASSIGN   2244<<ASSIGN
      2252<<ASSIGN   2263>>IF       2296<>CALL
CUR_NODE IN PROCEDURE BACK_TRACK_MAYBE
      2471**DCL      2490<<ASSIGN   2495>>ASSIGN   2518>>IF       2522<>CALL     2526>>IF       2554<<ASSIGN
      2568<>CALL     2572>>IF       2604<<ASSIGN   2666<<ASSIGN   2667<>CALL
D2_IND IN PROCEDURE COMP_DIST
      2834**DCL      2859<>CALL     2860>>IF
D2_TABLE.SET_IND
       353**DCL      2523>>IF       2525>>ASSIGN   2528>>ASSIGN   2569>>IF       2571>>ASSIGN   2574>>ASSIGN
      2583>>ASSIGN   2620>>ASSIGN   2621>>ASSIGN   2860>>IF
D2_TBL$
       351**DCL       352--IMP-PTR  2523>>IF       2525>>ASSIGN   2528>>ASSIGN   2569>>IF       2571>>ASSIGN
      2574>>ASSIGN   2583>>ASSIGN   2620>>ASSIGN   2621>>ASSIGN   2860>>IF
D2_TBL$ IN PROCEDURE UNION_MAT
      3357**DCL      3358--IMP-PTR
DA$
      1338**DCL      1339--IMP-PTR
DD$
      1481**DCL      1482--IMP-PTR
DESC#
       480**DCL       485--IMP-SIZ
DF$
      1489**DCL      1490--IMP-PTR
DID_I
       192**DCL      2296<>CALL     2298>>IF
DID_I IN PROCEDURE BACK_TRACK_MAYBE
      2476**DCL      2444--PROC     2639<<ASSIGN   2671<<ASSIGN   2679>>IF
DISPLAY_LIST
      1742**DCL       145--PROC     2333<>CALL     2366<>CALL     2377<>CALL
DISPLAY_LIST.IND.CONSTRAINT
      1745**DCL      3037>>IF       3246>>ASSIGN
DISPLAY_LIST.IND.DISPLAY
      1747**DCL      2506>>IF       2547>>IF       2597>>IF       2632>>IF       3246>>ASSIGN   3651>>IF
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:233  
DISPLAY_LIST.REC_NO
      1749**DCL      1967>>ASSIGN   1969>>ASSIGN   1972>>ASSIGN   2506>>IF       2547>>IF       2597>>IF
      2632>>IF       3015>>ASSIGN   3018>>ASSIGN   3243>>DOINDEX  3244>>IF       3651>>IF
DISPLAY_LIST#
       152**DCL      1969<<ASSIGN   1970>>ASSIGN   1971>>DOINDEX  2001>>ASSIGN   2027>>IF       2505>>DOINDEX
      2510>>ASSIGN   2546>>DOINDEX  2551>>ASSIGN   2596>>DOINDEX  2601>>ASSIGN   2631>>DOINDEX  2636>>ASSIGN
      3017>>DOINDEX  3650>>DOINDEX  3655>>ASSIGN
DISTANCE IN PROCEDURE SET_DISTANCE
      2893**DCL      2879--PROC     2902>>ASSIGN
DR$
      1360**DCL      1361--IMP-PTR  2988<<ASSIGN   2989>>IF       2990>>ASSIGN   3020<<ASSIGN   3021>>IF
      3024>>ASSIGN   3027>>ASSIGN
DRFK$ IN PROCEDURE SELECT_PORT
      2934**DCL      2935--IMP-PTR  3027<<ASSIGN   3028>>DOWHILE  3029>>IF       3031<<ASSIGN   3031>>ASSIGN
DRFS$
      1436**DCL      1437--IMP-PTR
DRFS$$ IN PROCEDURE MEMBER_SET
      3115**DCL      3117<<ASSIGN   3120>>DOWHILE  3121>>IF       3124>>ASSIGN   3127<<ASSIGN   3127>>ASSIGN
DS$
      1394**DCL      1395--IMP-PTR  2525<<ASSIGN   2526>>IF       2533>>ASSIGN   2571<<ASSIGN   2572>>IF
      2621<<ASSIGN   2622>>IF       3080<<ASSIGN   3081>>ASSIGN
DUMMY_VECTOR
      1899**DCL      1968<>CALL
DUMMY_VECTOR.W2
      1900**DCL      1901--REDEF
D_TABLE.BELONGS_PREV_LAMBDA
       348**DCL      2238<<ASSIGN   2248>>IF       2668<<ASSIGN
D_TABLE.DIST_FROM_PORT
       345**DCL      2248>>IF       2251>>ASSIGN   2492>>ASSIGN   2518>>IF       2565>>IF       2902<<ASSIGN
D_TABLE.OUT_CLASS
       347**DCL      2958>>IF       3040>>IF
D_TABLE.REC_NO
       344**DCL      2518>>IF       2521>>ASSIGN   2567>>ASSIGN   2854>>ASSIGN   2858>>ASSIGN   2862>>ASSIGN
      2866>>ASSIGN
D_TBL$
       342**DCL       343--IMP-PTR  2238>>ASSIGN   2248>>IF       2248>>IF       2251>>ASSIGN   2492>>ASSIGN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:234  
      2518>>IF       2518>>IF       2521>>ASSIGN   2565>>IF       2567>>ASSIGN   2668>>ASSIGN   2854>>ASSIGN
      2858>>ASSIGN   2862>>ASSIGN   2866>>ASSIGN   2902>>ASSIGN   2958>>IF       3040>>IF
D_TBL$ IN PROCEDURE UNION_MAT
      3348**DCL      3349--IMP-PTR
EMPTY_PATHTBL IN PROCEDURE NOT_PATHPT
      3478**PROC     3469--CALL
EMPTY_TBL
      2415**PROC     3322--CALL     3638--CALL
END_VIA_LIST IN PROCEDURE PICK_A_MEMBER
      3220**LABEL    3237--CALLALT  3238--CALLALT
ERR_LINE
       169**DCL      2161--ASSIGN
ERR_LINE.SET_FD
       171**DCL      2163<<ASSIGN
ERR_OUT
      1921**DCL      2156<>CALL     2158<>CALL     2160<>CALL     2164<>CALL     2169<>CALL
ERR_OUT.BUF_
      1921**DCL      2155<<ASSIGN   2157<<ASSIGN   2159<<ASSIGN   2161<<ASSIGN   2168<<ASSIGN
ERR_OUT.STATION_
      1923**DCL      1923--REDEF
ERR_OUT.V
      1924**DCL      1921--DCLINIT
ERR_OUT.V.DCB#
      1924**DCL      2171<<ASSIGN
ERR_OUT.V.DVBYTE.VFC#
      1930**DCL      1930--REDEF
ER_CANT_MAKE_PATH
      2373**LABEL    2265--GOTO
ER_COMMON
      2370**LABEL    1968--CALLALT  2000--CALLALT  2046--CALLALT  2075--CALLALT  2296--CALLALT
ER_COMMON IN PROCEDURE BACK_TRACK_MAYBE
      2687**LABEL    2494--CALLALT
ER_IMPOSSIBLE_PATH
      2367**LABEL    2366--CALLALT
FIELD.EIS_BITS.NDSC
      1561**DCL      1590--REDEF
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:235  
FIELD.FLAG_BITS_1
      1502**DCL      1503--REDEF
FIELD.FLAG_BITS_2
      1529**DCL      1530--REDEF
FIND_MEMBER IN PROCEDURE PICK_A_MEMBER
      3243**LABEL    3248--EXIT
I
       180**DCL      2152<<DOINDEX  2237<<DOINDEX  2238>>ASSIGN   2267<<DOINDEX  2268>>IF       2269>>ASSIGN
      2270>>ASSIGN   2271>>ASSIGN   2317<<DOINDEX  2318>>DOINDEX  2319>>IF       2321>>ASSIGN   2322>>IF
I IN PROCEDURE BACK_TRACK_MAYBE
      2464**DCL      2516<<ASSIGN   2517>>DOWHILE  2518>>IF       2518>>IF       2521>>ASSIGN   2555<<ASSIGN
      2559<<ASSIGN   2559>>ASSIGN   2563<<ASSIGN   2564>>DOWHILE  2565>>IF       2567>>ASSIGN   2605<<ASSIGN
      2608<<ASSIGN   2608>>ASSIGN   2650<<DOINDEX  2652>>IF       2658>>IF
I IN PROCEDURE COMPRESS_PATH
      2704**DCL      2749<<ASSIGN   2750>>DOWHILE  2751>>IF       2753<<ASSIGN   2753>>ASSIGN   2755>>DOWHILE
      2756>>ASSIGN   2758<<ASSIGN   2758>>ASSIGN   2761<<ASSIGN   2761>>ASSIGN   2763<<ASSIGN   2765>>DOWHILE
      2766>>IF       2768>>ASSIGN   2769>>ASSIGN   2770>>ASSIGN   2771>>ASSIGN   2772>>ASSIGN   2773>>ASSIGN
      2776<<ASSIGN   2776>>ASSIGN   2778>>ASSIGN   2792<<ASSIGN   2793>>DOWHILE  2794>>IF       2797<<ASSIGN
      2801<<ASSIGN   2801>>ASSIGN
I IN PROCEDURE NOT_PATHPT
      3397**DCL      3442<<ASSIGN   3443>>DOWHILE  3444>>IF       3446>>ASSIGN   3447<<ASSIGN   3449<<ASSIGN
      3449>>ASSIGN   3451<<ASSIGN   3453>>DOWHILE  3454>>IF       3456>>ASSIGN   3457>>ASSIGN   3458>>ASSIGN
      3459>>ASSIGN   3460>>ASSIGN   3461>>ASSIGN   3462>>ASSIGN   3463>>ASSIGN   3464>>ASSIGN   3467<<ASSIGN
      3467>>ASSIGN
I IN PROCEDURE NOT_PATHTBL
      3567**DCL      3615<<ASSIGN   3616>>DOWHILE  3619>>IF       3620>>ASSIGN   3625<<ASSIGN   3625>>ASSIGN
      3628<<DOINDEX  3629>>IF       3631>>IF       3632>>ASSIGN   3633>>ASSIGN
I IN PROCEDURE NOT_TBL
      3292**DCL      3298<<ASSIGN   3299>>DOWHILE  3302>>IF       3303>>ASSIGN   3306<<ASSIGN   3306>>ASSIGN
      3309<<ASSIGN   3310>>DOWHILE  3311>>IF       3314>>ASSIGN   3315>>IF       3316>>ASSIGN   3320<<ASSIGN
      3320>>ASSIGN
I IN PROCEDURE PICK_A_MEMBER
      3227**DCL      3241<<DOINDEX  3244>>IF       3246>>ASSIGN   3254>>IF       3255>>ASSIGN   3255>>ASSIGN
      3257>>IF       3258>>ASSIGN   3258>>ASSIGN   3265<<DOINDEX  3266>>IF       3268>>ASSIGN   3269>>ASSIGN
I IN PROCEDURE SELECT_PORT
      2910**DCL      2955<<DOINDEX  2956>>ASSIGN   2961>>IF       2964>>ASSIGN   2967>>ASSIGN   3017<<DOINDEX
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:236  
      3018>>ASSIGN   3037>>IF
I IN PROCEDURE SET_DISTANCE
      2894**DCL      2899<<ASSIGN   2900>>DOWHILE  2901>>CALL     2903<<ASSIGN   2903>>ASSIGN
I IN PROCEDURE UNION_MAT
      3344**DCL      3369<<ASSIGN   3372>>ASSIGN   3374<<ASSIGN   3374>>ASSIGN
IDX
       177**DCL      2271<<ASSIGN   2274>>IF       2275>>ASSIGN
IDX IN PROCEDURE MEMBER_SET
      3114**DCL      3119<<ASSIGN   3121>>IF       3124>>ASSIGN   3125<<ASSIGN   3125>>ASSIGN
ILLEGAL_SETS_INCLUDED
       159**DCL      2344<<ASSIGN   2348<<ASSIGN   2352>>IF
IN_PT IN PROCEDURE NOT_PATHPT
      3395**DCL      3380--PROC     3444>>IF
IN_TBL IN PROCEDURE EMPTY_TBL
      2426**DCL      2415--PROC     2433>>DOWHILE  2434>>IF
IN_TBL IN PROCEDURE MEMBER_TBL
      2398**DCL      2380--PROC     2404>>DOWHILE  2405>>IF       2408>>ASSIGN
IN_TBL IN PROCEDURE SET_DISTANCE
      2892**DCL      2879--PROC     2900>>DOWHILE  2901<>CALL
IN_TBL1 IN PROCEDURE NOT_TBL
      3290**DCL      3278--PROC     3299>>DOWHILE  3302>>IF       3303<<ASSIGN   3310>>DOWHILE  3311>>IF
      3314<<ASSIGN   3314>>ASSIGN   3316<<ASSIGN   3322<>CALL     3324<<ASSIGN   3326<<ASSIGN
IN_TBL1 IN PROCEDURE UNION_MAT
      3343**DCL      3330--PROC     3369>>ASSIGN   3372<<ASSIGN   3375<<ASSIGN   3375>>ASSIGN
IN_TBL2 IN PROCEDURE NOT_TBL
      3291**DCL      3278--PROC     3296>>IF       3301>>DOWHILE  3302>>IF
IN_TBL2 IN PROCEDURE UNION_MAT
      3342**DCL      3330--PROC     3371>>DOWHILE  3372>>ASSIGN
J
       181**DCL      2153<<ASSIGN   2172>>ASSIGN   2247<>CALL     2248>>IF       2248>>IF       2251>>ASSIGN
      2318<<DOINDEX  2319>>IF       2330>>ASSIGN   2343<<DOINDEX  2345>>IF       2347>>IF       2357<<ASSIGN
J IN PROCEDURE BACK_TRACK_MAYBE
      2466**DCL      2513<<ASSIGN   2514>>DOWHILE  2515>>ASSIGN   2518>>IF       2532>>ASSIGN   2533>>ASSIGN
      2536>>ASSIGN   2538>>ASSIGN   2539>>ASSIGN   2540>>ASSIGN   2541>>ASSIGN   2542>>ASSIGN   2543>>ASSIGN
      2547>>IF       2550>>ASSIGN   2561>>IF       2565>>IF       2578>>ASSIGN   2581>>ASSIGN   2582>>ASSIGN
      2583>>ASSIGN   2587>>ASSIGN   2589>>ASSIGN   2590>>ASSIGN   2591>>ASSIGN   2592>>ASSIGN   2593>>ASSIGN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:237  
      2597>>IF       2600>>ASSIGN   2611<<ASSIGN   2611>>ASSIGN   2651<<DOINDEX  2652>>IF       2652>>IF
      2663>>ASSIGN   2664>>ASSIGN
J IN PROCEDURE COMPRESS_PATH
      2705**DCL      2754<<ASSIGN   2755>>DOWHILE  2757<<ASSIGN   2757>>ASSIGN   2764<<ASSIGN   2768>>ASSIGN
      2769>>ASSIGN   2770>>ASSIGN   2771>>ASSIGN   2772>>ASSIGN   2773>>ASSIGN   2774<<ASSIGN   2774>>ASSIGN
      2778>>ASSIGN   2780<<ASSIGN   2781>>DOWHILE  2782>>IF       2782>>IF       2783>>ASSIGN   2784<<ASSIGN
      2784>>ASSIGN   2790<<ASSIGN   2791>>DOWHILE  2793>>DOWHILE  2794>>IF       2796>>ASSIGN   2797>>ASSIGN
      2800>>ASSIGN   2803<<ASSIGN   2803>>ASSIGN
J IN PROCEDURE NOT_PATHPT
      3398**DCL      3452<<ASSIGN   3456>>ASSIGN   3457>>ASSIGN   3458>>ASSIGN   3459>>ASSIGN   3460>>ASSIGN
      3461>>ASSIGN   3462>>ASSIGN   3463>>ASSIGN   3464>>ASSIGN   3465<<ASSIGN   3465>>ASSIGN   3471>>ASSIGN
J IN PROCEDURE NOT_PATHTBL
      3568**DCL      3617<<ASSIGN   3618>>DOWHILE  3619>>IF       3621<<ASSIGN   3623<<ASSIGN   3623>>ASSIGN
      3627<<ASSIGN   3631>>IF       3632>>ASSIGN   3635<<ASSIGN   3635>>ASSIGN   3640>>ASSIGN
J IN PROCEDURE NOT_TBL
      3293**DCL      3300<<ASSIGN   3301>>DOWHILE  3302>>IF       3304<<ASSIGN   3304>>ASSIGN   3308<<ASSIGN
      3314>>ASSIGN   3315>>IF       3317<<ASSIGN   3317>>ASSIGN   3324>>ASSIGN
J IN PROCEDURE PICK_A_MEMBER
      3228**DCL      3243<<DOINDEX  3244>>IF       3246>>ASSIGN   3246>>ASSIGN   3256<<DOINDEX  3257>>IF
J IN PROCEDURE SELECT_PORT
      2911**DCL      2957<>CALL     2958>>IF       3039<>CALL     3040>>IF
J IN PROCEDURE SET_DISPLAY_IND
      3648**DCL      3650<<DOINDEX  3651>>IF       3651>>IF       3655<<ASSIGN
J IN PROCEDURE SET_DISTANCE
      2895**DCL      2901<>CALL     2902>>ASSIGN
J IN PROCEDURE UNION_MAT
      3345**DCL      3370<<ASSIGN   3371>>DOWHILE  3372>>ASSIGN   3373<<ASSIGN   3373>>ASSIGN
K
       182**DCL      2058<<ASSIGN   2059>>DOWHILE  2060>>IF       2063<<ASSIGN   2065<<ASSIGN   2065>>ASSIGN
      2330<<ASSIGN   2331>>DOWHILE  2332>>IF       2337<<ASSIGN   2337>>ASSIGN   2346<<DOINDEX  2347>>IF
      2349<<ASSIGN
K IN PROCEDURE BACK_TRACK_MAYBE
      2465**DCL      2505<<DOINDEX  2506>>IF       2506>>IF       2510<<ASSIGN   2546<<DOINDEX  2547>>IF
      2547>>IF       2551<<ASSIGN   2596<<DOINDEX  2597>>IF       2597>>IF       2601<<ASSIGN   2631<<DOINDEX
      2632>>IF       2632>>IF       2636<<ASSIGN   2657<<DOINDEX  2658>>IF       2665<<DOINDEX  2666>>ASSIGN
K IN PROCEDURE COMP_DIST
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:238  
      2827**DCL      2841<<ASSIGN   2847<>CALL     2848<<ASSIGN   2848>>ASSIGN
K IN PROCEDURE SELECT_PORT
      2912**DCL      3024<<ASSIGN   3045>>ASSIGN
LAMBDA_REC#
       172**DCL      2241<<ASSIGN   2264>>IF       2267>>DOINDEX  2274>>IF       2275>>ASSIGN   2276<<ASSIGN
      2276>>ASSIGN   2657>>DOINDEX  2662<<ASSIGN   2662>>ASSIGN   2663>>ASSIGN   2664>>ASSIGN
LAMBDA_RECS
       173**DCL      2275<<ASSIGN   2275>>ASSIGN
LAMBDA_RECS.PATH_LIST_IDX
       175**DCL      2268>>IF       2269>>ASSIGN   2664<<ASSIGN
LAMBDA_RECS.REC_NO
       174**DCL      2270>>ASSIGN   2658>>IF       2663<<ASSIGN
LO_DO
      1946**DCL      2170<>CALL
LO_DO.V
      1946**DCL      1946--DCLINIT
M IN PROCEDURE COMP_DIST
      2830**DCL      2838<<ASSIGN   2846<>CALL     2855<>CALL     2875<>CALL
M$CORRES
       213**DCL-ENT  2170--CALL
M$DO
       189**DCL      2171>>ASSIGN
M$WRITE
       209**DCL-ENT  2156--CALL     2158--CALL     2160--CALL     2164--CALL     2169--CALL
MAX_DIST IN PROCEDURE BACK_TRACK_MAYBE
      2467**DCL      2492<<ASSIGN   2493>>ASSIGN   2495>>ASSIGN   2498>>ASSIGN   2499>>ASSIGN   2500>>ASSIGN
      2501>>ASSIGN   2502>>ASSIGN   2503>>ASSIGN   2504>>ASSIGN   2506>>IF       2509>>ASSIGN   2514>>DOWHILE
      2515>>ASSIGN   2518>>IF       2532>>ASSIGN   2533>>ASSIGN   2536>>ASSIGN   2538>>ASSIGN   2539>>ASSIGN
      2540>>ASSIGN   2541>>ASSIGN   2542>>ASSIGN   2543>>ASSIGN   2547>>IF       2550>>ASSIGN   2561>>IF
      2565>>IF       2578>>ASSIGN   2581>>ASSIGN   2582>>ASSIGN   2583>>ASSIGN   2587>>ASSIGN   2589>>ASSIGN
      2590>>ASSIGN   2591>>ASSIGN   2592>>ASSIGN   2593>>ASSIGN   2597>>IF       2600>>ASSIGN   2649>>IF
MEMBER_LIST
       365**DCL      2038<>CALL     2042<>CALL     2044<>CALL     2529<>CALL     2531<>CALL     2575<>CALL
      2577<>CALL
MEMBER_LIST.REC_NO
       366**DCL      2039>>IF       2040>>ASSIGN   2530>>IF       2576>>IF
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:239  
MEMBER_OF_LIST
       164**DCL      1991<<ASSIGN   2062<<ASSIGN   2067>>IF
MEMBER_REC
       162**DCL      2040<<ASSIGN   2042<>CALL     2044<>CALL     2050>>ASSIGN   2071>>ASSIGN   2074>>IF
MEMBER_SET
      3087**PROC     2038--CALL     2529--CALL     2575--CALL     3238--CALL
MEMBER_TBL
      2380**PROC     2534--CALL     2584--CALL     2855--CALL     2863--CALL
MEMORY_FRAME
       187**DCL      1956>>ASSIGN
MEMORY_NEEDED
       157**DCL      1956<<ASSIGN   1957>>IF       1958>>ASSIGN   1967<<ASSIGN   1968<>CALL
MEM_FLG IN PROCEDURE BACK_TRACK_MAYBE
      2473**DCL      2534<>CALL     2535>>IF       2584<>CALL     2586>>IF
MEM_FLG IN PROCEDURE COMP_DIST
      2833**DCL      2843<<ASSIGN   2855<>CALL     2856>>IF       2863<>CALL     2864>>IF
N
       179**DCL      1971<<DOINDEX  1972>>ASSIGN   1972>>ASSIGN   2034<<ASSIGN   2036>>IF       2037>>CALL
      2038>>CALL     2041>>IF       2044>>CALL     2047>>ASSIGN   2072<<ASSIGN   2072>>ASSIGN   2076>>ASSIGN
      2088<<ASSIGN   2088>>ASSIGN   2151>>IF       2153>>ASSIGN   2162>>DOWHILE  2163>>ASSIGN   2165<<ASSIGN
      2165>>ASSIGN   2172<<ASSIGN   2245<<ASSIGN   2246>>DOWHILE  2247>>CALL     2252>>ASSIGN   2254<<ASSIGN
      2254>>ASSIGN   2316<<ASSIGN   2320>>IF       2321<<ASSIGN   2322>>IF
N IN PROCEDURE BACK_TRACK_MAYBE
      2468**DCL      2491<>CALL     2492>>ASSIGN   2613<>CALL
N IN PROCEDURE EMPTY_PATHTBL
      3489**DCL      3534<<ASSIGN   3535>>DOWHILE  3536>>IF       3541<<ASSIGN   3541>>ASSIGN
N IN PROCEDURE EMPTY_TBL
      2428**DCL      2432<<ASSIGN   2433>>DOWHILE  2434>>IF       2439<<ASSIGN   2439>>ASSIGN
N IN PROCEDURE MEMBER_TBL
      2400**DCL      2403<<ASSIGN   2404>>DOWHILE  2405>>IF       2408<<ASSIGN   2410<<ASSIGN   2410>>ASSIGN
NAM1.DESC$
       471**DCL      2525>>ASSIGN   2571>>ASSIGN   2621>>ASSIGN   2988>>ASSIGN   3020>>ASSIGN   3080>>ASSIGN
      3117>>ASSIGN
NAM1.NAME.TEXT
       470**DCL      2163>>ASSIGN
NAM1$
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:240  
       453**DCL       456--IMP-PTR  2163>>ASSIGN   2525>>ASSIGN   2571>>ASSIGN   2621>>ASSIGN   2988>>ASSIGN
      3020>>ASSIGN   3080>>ASSIGN   3117>>ASSIGN
NAM2.DESC
       484**DCL       485--REDEF
NAM2$
       478**DCL       481--IMP-PTR
NEXT_VIA_MEMBERS IN PROCEDURE PICK_A_MEMBER
      3218**DCL      3238<>CALL
NEXT_VIA_MEMBERS.REC_NO IN PROCEDURE PICK_A_MEMBER
      3219**DCL      3256>>DOINDEX  3257>>IF
NEXT_VIA_OWNER IN PROCEDURE PICK_A_MEMBER
      3214**DCL      3237<>CALL     3254>>IF
NEXT_VIA_SET IN PROCEDURE PICK_A_MEMBER
      3213**DCL      3134--PROC     3231--IF       3237<>CALL     3238<>CALL
NEXT_VIA_SET_EXISTS IN PROCEDURE PICK_A_MEMBER
      3225**DCL      3233<<ASSIGN   3236<<ASSIGN   3252>>IF
NORM
      2229**LABEL    2143--GOTO     2170--CALLALT
NOT_PATHPT
      3380**PROC     2786--CALL
NOT_PATHTBL
      3547**PROC     2136--CALL     2299--CALL
NOT_TBL
      3278**PROC     2875--CALL
OUT_FLG IN PROCEDURE EMPTY_PATHTBL
      3488**DCL      3478--PROC     3533<<ASSIGN   3538<<ASSIGN
OUT_FLG IN PROCEDURE EMPTY_TBL
      2427**DCL      2415--PROC     2431<<ASSIGN   2436<<ASSIGN
OUT_FLG IN PROCEDURE MEMBER_TBL
      2399**DCL      2380--PROC     2402<<ASSIGN   2407<<ASSIGN
OUT_RECNO IN PROCEDURE OWNER_SET
      3078**DCL      3062--PROC     3081<<ASSIGN   3082>>IF
OWNER_REC
       161**DCL      2037<>CALL     2045>>IF       2080>>ASSIGN   2087>>ASSIGN
OWNER_SET
      3062**PROC     2037--CALL     3237--CALL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:241  
PATH$
       155**DCL      1770--IMP-PTR  2002<<ASSIGN   2005>>ASSIGN   2006>>ASSIGN   2007>>ASSIGN   2008>>ASSIGN
      2009>>ASSIGN   2010>>ASSIGN   2011>>ASSIGN   2012>>ASSIGN   2013>>ASSIGN   2014>>ASSIGN   2047>>ASSIGN
      2049>>ASSIGN   2050>>ASSIGN   2051>>ASSIGN   2052>>ASSIGN   2053>>ASSIGN   2054>>ASSIGN   2060>>IF
      2060>>IF       2068>>ASSIGN   2070>>ASSIGN   2076>>ASSIGN   2077>>ASSIGN   2079>>ASSIGN   2080>>ASSIGN
      2081>>ASSIGN   2082>>ASSIGN   2083>>ASSIGN   2084>>ASSIGN   2085>>ASSIGN   2098>>ASSIGN   2136>>CALL
      2140>>ASSIGN   2299>>CALL     2308>>CALL     2319>>IF       2319>>IF       2321>>ASSIGN   2322>>IF
      2331>>DOWHILE  2332>>IF       2333>>CALL     2345>>IF       2347>>IF       2366>>CALL     2377>>CALL
      2495>>ASSIGN   2497>>ASSIGN   2498>>ASSIGN   2499>>ASSIGN   2500>>ASSIGN   2501>>ASSIGN   2502>>ASSIGN
      2503>>ASSIGN   2504>>ASSIGN   2506>>IF       2509>>ASSIGN   2515>>ASSIGN   2532>>ASSIGN   2533>>ASSIGN
      2536>>ASSIGN   2538>>ASSIGN   2539>>ASSIGN   2540>>ASSIGN   2541>>ASSIGN   2542>>ASSIGN   2543>>ASSIGN
      2545>>ASSIGN   2547>>IF       2550>>ASSIGN   2561>>IF       2578>>ASSIGN   2581>>ASSIGN   2582>>ASSIGN
      2583>>ASSIGN   2587>>ASSIGN   2589>>ASSIGN   2590>>ASSIGN   2591>>ASSIGN   2592>>ASSIGN   2593>>ASSIGN
      2595>>ASSIGN   2597>>IF       2600>>ASSIGN   2614>>ASSIGN   2617>>ASSIGN   2618>>ASSIGN   2620>>ASSIGN
      2623>>ASSIGN   2625>>ASSIGN   2626>>ASSIGN   2627>>ASSIGN   2628>>ASSIGN   2629>>ASSIGN   2630>>ASSIGN
      2632>>IF       2635>>ASSIGN   2652>>IF       2652>>IF       2658>>IF       2663>>ASSIGN   2666>>ASSIGN
      2681>>ASSIGN   3651>>IF       3654>>ASSIGN
PATH$_P
       154**DCL       145--PROC     2001<<ASSIGN   2002>>ASSIGN
PATH_LIST
      1770**DCL      2136<>CALL     2299<>CALL     2308<>CALL     2333<>CALL     2366<>CALL     2377<>CALL
PATH_LIST.CONSTRAINT_EPTR
      1806**DCL      2014<<ASSIGN   2053<<ASSIGN   2085<<ASSIGN   2504<<ASSIGN   2543<<ASSIGN   2593<<ASSIGN
      2630<<ASSIGN
PATH_LIST.CONVERT_EPTR
      1803**DCL      2013<<ASSIGN   2054<<ASSIGN   2084<<ASSIGN   2503<<ASSIGN   2542<<ASSIGN   2592<<ASSIGN
      2629<<ASSIGN
PATH_LIST.DISPLAY_IND
      1790**DCL      2509<<ASSIGN   2550<<ASSIGN   2600<<ASSIGN   2635<<ASSIGN   3654<<ASSIGN
PATH_LIST.FIND_ATTEMPTED
      1777**DCL      2010<<ASSIGN   2498<<ASSIGN   2540<<ASSIGN   2590<<ASSIGN   2627<<ASSIGN
PATH_LIST.GET_IND
      1775**DCL      2009<<ASSIGN   2070<<ASSIGN   2082<<ASSIGN   2499<<ASSIGN   2536<<ASSIGN   2538<<ASSIGN
      2587<<ASSIGN   2589<<ASSIGN   2626<<ASSIGN
PATH_LIST.INIT_EPTR
      1801**DCL      2012<<ASSIGN   2052<<ASSIGN   2083<<ASSIGN   2502<<ASSIGN   2541<<ASSIGN   2591<<ASSIGN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:242  
      2628<<ASSIGN
PATH_LIST.OWN_NEXT
      1773**DCL      2008<<ASSIGN   2077<<ASSIGN   2332>>IF       2500<<ASSIGN   2539<<ASSIGN   2578<<ASSIGN
      2581<<ASSIGN   2623<<ASSIGN   2625<<ASSIGN
PATH_LIST.REC_NO
      1771**DCL      2005<<ASSIGN   2006<<ASSIGN   2049<<ASSIGN   2050<<ASSIGN   2060>>IF       2060>>IF
      2079<<ASSIGN   2080<<ASSIGN   2098>>ASSIGN   2140>>ASSIGN   2319>>IF       2319>>IF       2321>>ASSIGN
      2322>>IF       2495<<ASSIGN   2497<<ASSIGN   2506>>IF       2515<<ASSIGN   2532<<ASSIGN   2545<<ASSIGN
      2547>>IF       2561>>IF       2582<<ASSIGN   2595<<ASSIGN   2597>>IF       2614<<ASSIGN   2617<<ASSIGN
      2618>>ASSIGN   2632>>IF       2652>>IF       2652>>IF       2658>>IF       2663>>ASSIGN   2666>>ASSIGN
      2681<<ASSIGN   3651>>IF
PATH_LIST.REPEAT_IND
      1781**DCL      2011<<ASSIGN   2068<<ASSIGN
PATH_LIST.SET_NO
      1772**DCL      2007<<ASSIGN   2047<<ASSIGN   2051<<ASSIGN   2076<<ASSIGN   2081<<ASSIGN   2331>>DOWHILE
      2345>>IF       2347>>IF       2501<<ASSIGN   2533<<ASSIGN   2583<<ASSIGN   2620<<ASSIGN
PATH_LIST IN PROCEDURE COMPRESS_PATH
      2708**DCL      2690--PROC     2786<>CALL
PATH_LIST.DISPLAY_IND IN PROCEDURE COMPRESS_PATH
      2728**DCL      2772<<ASSIGN   2772>>ASSIGN
PATH_LIST.FIND_ATTEMPTED IN PROCEDURE COMPRESS_PATH
      2715**DCL      2773<<ASSIGN   2773>>ASSIGN
PATH_LIST.GET_IND IN PROCEDURE COMPRESS_PATH
      2713**DCL      2770<<ASSIGN   2770>>ASSIGN
PATH_LIST.OWN_NEXT IN PROCEDURE COMPRESS_PATH
      2711**DCL      2771<<ASSIGN   2771>>ASSIGN
PATH_LIST.REC_NO IN PROCEDURE COMPRESS_PATH
      2709**DCL      2751>>IF       2751>>IF       2755>>DOWHILE  2755>>DOWHILE  2756<<ASSIGN   2766>>IF
      2768<<ASSIGN   2768>>ASSIGN   2779<<ASSIGN   2782>>IF       2782>>IF       2783<<ASSIGN   2794>>IF
      2794>>IF
PATH_LIST.REPEAT_IND IN PROCEDURE COMPRESS_PATH
      2719**DCL      2789<<ASSIGN   2796<<ASSIGN   2800<<ASSIGN
PATH_LIST.SET_NO IN PROCEDURE COMPRESS_PATH
      2710**DCL      2769<<ASSIGN   2769>>ASSIGN
PATH_LIST IN PROCEDURE EMPTY_PATHTBL
      3493**DCL      3478--PROC
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:243  
PATH_LIST.REC_NO IN PROCEDURE EMPTY_PATHTBL
      3494**DCL      3536>>IF
PATH_LIST IN PROCEDURE NOT_PATHPT
      3401**DCL      3380--PROC     3469<>CALL
PATH_LIST.CONSTRAINT_EPTR IN PROCEDURE NOT_PATHPT
      3437**DCL      3464<<ASSIGN   3464>>ASSIGN
PATH_LIST.CONVERT_EPTR IN PROCEDURE NOT_PATHPT
      3434**DCL      3463<<ASSIGN   3463>>ASSIGN
PATH_LIST.DISPLAY_IND IN PROCEDURE NOT_PATHPT
      3421**DCL      3461<<ASSIGN   3461>>ASSIGN
PATH_LIST.FIND_ATTEMPTED IN PROCEDURE NOT_PATHPT
      3408**DCL      3460<<ASSIGN   3460>>ASSIGN
PATH_LIST.GET_IND IN PROCEDURE NOT_PATHPT
      3406**DCL      3459<<ASSIGN   3459>>ASSIGN
PATH_LIST.INIT_EPTR IN PROCEDURE NOT_PATHPT
      3432**DCL      3462<<ASSIGN   3462>>ASSIGN
PATH_LIST.OWN_NEXT IN PROCEDURE NOT_PATHPT
      3404**DCL      3458<<ASSIGN   3458>>ASSIGN
PATH_LIST.REC_NO IN PROCEDURE NOT_PATHPT
      3402**DCL      3444>>IF       3446<<ASSIGN   3454>>IF       3456<<ASSIGN   3456>>ASSIGN   3474<<ASSIGN
PATH_LIST.SET_NO IN PROCEDURE NOT_PATHPT
      3403**DCL      3457<<ASSIGN   3457>>ASSIGN
PATH_LIST IN PROCEDURE NOT_PATHTBL
      3572**DCL      3547--PROC
PATH_LIST.REC_NO IN PROCEDURE NOT_PATHTBL
      3573**DCL      3619>>IF
PATH_SLOTS_NEEDED IN PROCEDURE BACK_TRACK_MAYBE
      2474**DCL      2493<<ASSIGN   2494<>CALL     2682<>CALL
PICK_A_MEMBER
      3134**PROC     2042--CALL     2044--CALL     2531--CALL     2577--CALL
PORT IN PROCEDURE SELECT_PORT
      2916**DCL      3015<<ASSIGN   3046<<ASSIGN   3051>>ASSIGN
PORT_KEY IN PROCEDURE SELECT_PORT
      2917**DCL      3045<<ASSIGN   3057>>ASSIGN
PORT_RECORD IN PROCEDURE COMP_DIST
      2826**DCL      2808--PROC     2842>>ASSIGN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:244  
PRINT_VIA_WARN
      2136**LABEL    2037--CALLALT  2038--CALLALT  2101--GOTO
PRIO IN PROCEDURE PICK_A_MEMBER
      3226**DCL      3264<<ASSIGN   3266>>IF       3269<<ASSIGN
RECORD.FLAG_BITS
      1365**DCL      1366--REDEF
RECORD.RFK_DSC$
      1390**DCL      2989>>IF       2990>>ASSIGN   3021>>IF       3024>>ASSIGN   3027>>ASSIGN
REC_IDX IN PROCEDURE MEMBER_TBL
      2397**DCL      2380--PROC     2405>>IF
REC_NO
       156**DCL      2004<<ASSIGN   2005>>ASSIGN   2047>>ASSIGN   2048<<ASSIGN   2048>>ASSIGN   2049>>ASSIGN
      2050>>ASSIGN   2051>>ASSIGN   2052>>ASSIGN   2053>>ASSIGN   2054>>ASSIGN   2056>>IF       2059>>DOWHILE
      2060>>IF       2063>>ASSIGN   2068>>ASSIGN   2070>>ASSIGN   2076>>ASSIGN   2077>>ASSIGN   2078<<ASSIGN
      2078>>ASSIGN   2079>>ASSIGN   2080>>ASSIGN   2081>>ASSIGN   2082>>ASSIGN   2083>>ASSIGN   2084>>ASSIGN
      2085>>ASSIGN   2098>>ASSIGN   2099>>ASSIGN   2140>>ASSIGN   2141>>ASSIGN   2317>>DOINDEX  2318>>DOINDEX
      2343>>DOINDEX  2357>>ASSIGN   2484>>IF       2487>>ASSIGN   2489>>ASSIGN   2496<<ASSIGN   2496>>ASSIGN
      2497>>ASSIGN   2544<<ASSIGN   2544>>ASSIGN   2545>>ASSIGN   2594<<ASSIGN   2594>>ASSIGN   2595>>ASSIGN
      2616<<ASSIGN   2616>>ASSIGN   2617>>ASSIGN   2650>>DOINDEX  2665>>DOINDEX  2680<<ASSIGN   2750>>DOWHILE
      2765>>DOWHILE  2778<<ASSIGN   2778>>ASSIGN   2779>>ASSIGN   2781>>DOWHILE  2791>>DOWHILE  3443>>DOWHILE
      3447>>ASSIGN   3453>>DOWHILE  3471<<ASSIGN   3473<<ASSIGN   3474>>ASSIGN   3535>>DOWHILE  3613>>IF
      3618>>DOWHILE  3621>>ASSIGN   3651>>IF       3654>>ASSIGN
REC_NO IN PROCEDURE SELECT_PORT
      2913**DCL      2956<<ASSIGN   2957<>CALL     2960>>ASSIGN   2971>>ASSIGN   3018<<ASSIGN   3020>>ASSIGN
      3039<>CALL     3046>>ASSIGN
RFK_DSC.KEY_IDX IN PROCEDURE SELECT_PORT
      2937**DCL      2990>>ASSIGN   3024>>ASSIGN   3029>>IF
RFK_DSC.REC$ IN PROCEDURE SELECT_PORT
      2944**DCL      3031>>ASSIGN
RFS_DSC.OWN_MEM
      1441**DCL      3121>>IF
RFS_DSC.REC_IDX
      1438**DCL      3124>>ASSIGN
RFS_DSC.SET$
      1476**DCL      3127>>ASSIGN
SAVE_REC_NO IN PROCEDURE BACK_TRACK_MAYBE
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:245  
      2478**DCL      2489<<ASSIGN   2651>>DOINDEX  2680>>ASSIGN   2681>>ASSIGN
SELECT_PORT
      2909**PROC     1985--CALL     1986--CALL
SET.FLAG_BITS
      1400**DCL      1401--REDEF
SET.NAM_IDX
      1396**DCL      2533>>ASSIGN
SET.OWNER_IDX
      1398**DCL      2526>>IF       2572>>IF       2622>>IF       3081>>ASSIGN
SET.RFS_DSC$
      1432**DCL      3117>>ASSIGN
SET_DISPLAY_IND
      3647**PROC     2015--CALL     2055--CALL     2086--CALL
SET_DISTANCE IN PROCEDURE COMP_DIST
      2879**PROC     2847--CALL
SET_MEMBERS IN PROCEDURE MEMBER_SET
      3107**DCL      3087--PROC     3118<<ASSIGN
SET_MEMBERS.REC_NO IN PROCEDURE MEMBER_SET
      3108**DCL      3123<<ASSIGN   3123>>ASSIGN   3124<<ASSIGN   3129>>IF
SET_MEMBERS IN PROCEDURE PICK_A_MEMBER
      3205**DCL      3134--PROC
SET_MEMBERS.PRIORITY IN PROCEDURE PICK_A_MEMBER
      3207**DCL      3246<<ASSIGN   3255<<ASSIGN   3255>>ASSIGN   3258<<ASSIGN   3258>>ASSIGN   3266>>IF
      3269>>ASSIGN
SET_MEMBERS.REC_NO IN PROCEDURE PICK_A_MEMBER
      3206**DCL      3241>>DOINDEX  3244>>IF       3254>>IF       3257>>IF       3263>>ASSIGN   3265>>DOINDEX
      3268>>ASSIGN
SET_NO IN PROCEDURE BACK_TRACK_MAYBE
      2479**DCL      2528<<ASSIGN   2529<>CALL     2574<<ASSIGN   2575<>CALL
SET_NO IN PROCEDURE MEMBER_SET
      3103**DCL      3087--PROC     3117>>ASSIGN
SET_NO IN PROCEDURE OWNER_SET
      3077**DCL      3062--PROC     3080>>ASSIGN
START_NODE
       183**DCL      2003<<ASSIGN   2098<<ASSIGN   2100>>ASSIGN   2140<<ASSIGN   2142>>ASSIGN   2277<<ASSIGN
      2296<>CALL
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:246  
START_NODE IN PROCEDURE BACK_TRACK_MAYBE
      2462**DCL      2444--PROC     2613<>CALL     2614>>ASSIGN   2619<>CALL     2622>>IF
START_OF_BRANCH IN PROCEDURE BACK_TRACK_MAYBE
      2475**DCL      2485<<ASSIGN   2487<<ASSIGN   2492>>ASSIGN   2514>>DOWHILE  2518>>IF       2565>>IF
      2614>>ASSIGN   2615>>IF       2618>>ASSIGN   2620>>ASSIGN   2623>>ASSIGN   2625>>ASSIGN   2626>>ASSIGN
      2627>>ASSIGN   2628>>ASSIGN   2629>>ASSIGN   2630>>ASSIGN   2632>>IF       2635>>ASSIGN   2649>>IF
      2650>>DOINDEX  2665>>DOINDEX
STATUS_CODE
       160**DCL       145--PROC     1981<<ASSIGN   1990<<ASSIGN   2167<<ASSIGN   2334<<ASSIGN   2354<<ASSIGN
      2356<<ASSIGN   2367>>IF       2370<<ASSIGN   2373<<ASSIGN   2376<<ASSIGN
TBL_DIM
       358**DCL      2237>>DOINDEX  2517>>DOWHILE  2555>>ASSIGN   2564>>DOWHILE  2605>>ASSIGN   2853>>DOWHILE
TDISPLAY_LIST
       151**DCL      1972<<ASSIGN   2027>>IF       2136<>CALL     2247<>CALL     2252>>ASSIGN   2299<>CALL
      2534<>CALL     2584<>CALL
TDISPLAY_LIST IN PROCEDURE NOT_PATHTBL
      3611**DCL      3547--PROC     3619>>IF       3620<<ASSIGN   3629>>IF       3632<<ASSIGN   3632>>ASSIGN
      3633<<ASSIGN   3638<>CALL     3643<<ASSIGN
TDISPLAY_LIST#
       153**DCL      1970<<ASSIGN   2035>>DOWHILE  2175>>DOWHILE  2242>>DOWHILE  2246>>DOWHILE  3616>>DOWHILE
      3628>>DOINDEX  3640<<ASSIGN   3642<<ASSIGN   3643>>ASSIGN
TEMP_ARG
       186**DCL      2029<<ASSIGN   2030<>CALL     2229<<ASSIGN   2240<>CALL     2242>>DOWHILE
TEMP_ARG IN PROCEDURE BACK_TRACK_MAYBE
      2472**DCL      2521<<ASSIGN   2522<>CALL     2531<>CALL     2532>>ASSIGN   2534<>CALL     2554>>ASSIGN
      2567<<ASSIGN   2568<>CALL     2577<>CALL     2582>>ASSIGN   2584<>CALL     2604>>ASSIGN   2618<<ASSIGN
      2619<>CALL
TEMP_ARG IN PROCEDURE COMP_DIST
      2836**DCL      2854<<ASSIGN   2855<>CALL     2858<<ASSIGN   2859<>CALL     2862<<ASSIGN   2863<>CALL
TEMP_PORT
       185**DCL      2026<<ASSIGN   2029>>ASSIGN   2033>>ASSIGN   2100<<ASSIGN   2142<<ASSIGN   2229>>ASSIGN
      2242>>DOWHILE  2270<<ASSIGN   2277>>ASSIGN
TEMP_PORT_PATH_IDX
       176**DCL      2025<<ASSIGN   2099<<ASSIGN   2141<<ASSIGN   2266<<ASSIGN   2268>>IF       2269<<ASSIGN
      2652>>IF
TERM_NODE IN PROCEDURE BACK_TRACK_MAYBE
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:247  
      2463**DCL      2444--PROC     2490>>ASSIGN   2491<>CALL
THISPX IN PROCEDURE SELECT_PORT
      2914**DCL      3019<<ASSIGN   3023<<ASSIGN   3028>>DOWHILE  3030<<ASSIGN   3035>>IF       3038<<ASSIGN
      3038>>ASSIGN   3041<<ASSIGN   3041>>ASSIGN   3042>>IF       3044>>ASSIGN
TOPOLOGY_OPTIONS
      1849**DCL       145--PROC
TOPOLOGY_OPTIONS.PORTFLAG
      1851**DCL      1979>>IF
TOPOLOGY_OPTIONS.PRINT_IND
      1852**DCL      2154<<ASSIGN   2365>>IF
TOPOLOGY_OPTIONS.WARNING_CODE
      1850**DCL      2342>>IF       2353>>IF
T_DIST
       163**DCL      2243<<ASSIGN   2248>>IF       2251<<ASSIGN
UNION_MAT
      3330**PROC     2846--CALL
VIA_ERROR
       167**DCL      1922--DCLINIT  1923--DCLINIT  2157--ASSIGN
VIA_LIST
      1765**DCL       145--PROC     2031>>IF       2036>>IF       2037<>CALL     2038<>CALL     2041>>IF
      2044<>CALL     2047>>ASSIGN   2076>>ASSIGN   2151>>IF       2162>>DOWHILE  2163>>ASSIGN   2346>>DOINDEX
      2347>>IF       2349>>ASSIGN   2649>>IF
W IN PROCEDURE COMP_DIST
      2831**DCL      2839<<ASSIGN   2840<<ASSIGN   2842<<ASSIGN   2845>>DOWHILE  2846<>CALL     2847<>CALL
      2849>>ASSIGN   2859<>CALL     2863<>CALL     2866>>ASSIGN   2866<<ASSIGN   2867<<ASSIGN   2867>>ASSIGN
      2875<>CALL
W_LENGTH IN PROCEDURE COMP_DIST
      2832**DCL      2849<<ASSIGN   2851>>DOWHILE
X IN PROCEDURE BACK_TRACK_MAYBE
      2470**DCL      2522<>CALL     2523>>IF       2525>>ASSIGN   2528>>ASSIGN   2568<>CALL     2569>>IF
      2571>>ASSIGN   2574>>ASSIGN   2583>>ASSIGN   2619<>CALL     2620>>ASSIGN   2621>>ASSIGN   2667<>CALL
      2668>>ASSIGN
X IN PROCEDURE COMP_DIST
      2828**DCL      2850<<ASSIGN   2851>>DOWHILE  2859>>CALL     2873<<ASSIGN   2873>>ASSIGN
Y IN PROCEDURE COMP_DIST
      2829**DCL      2852<<ASSIGN   2853>>DOWHILE  2854>>ASSIGN   2858>>ASSIGN   2862>>ASSIGN   2866>>ASSIGN
PL6.E3A0      #001=ZII$TOPOLOGY File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:32 Page:248  
      2871<<ASSIGN   2871>>ASSIGN
ZER_FLG IN PROCEDURE COMP_DIST
      2835**DCL      2844<<ASSIGN
ZER_FLG IN PROCEDURE NOT_PATHPT
      3396**DCL      3469<>CALL     3470>>IF
ZER_FLG IN PROCEDURE NOT_PATHTBL
      3569**DCL      3638<>CALL     3639>>IF
ZER_FLG IN PROCEDURE NOT_TBL
      3294**DCL      3322<>CALL     3323>>IF
ZII$COMMON$
       147**DCL       148--REDEF     151--IMP-PTR  1958<<ASSIGN   1958>>ASSIGN   1972>>ASSIGN   2001>>ASSIGN
      2027>>IF       2136>>CALL     2247>>CALL     2252>>ASSIGN   2299>>CALL     2534>>CALL     2584>>CALL
ZII$COMMON_MEMORY
       196**DCL-ENT  1968--CALL
ZII$FIND_D2_IDX IN PROCEDURE BACK_TRACK_MAYBE
      2481**DCL-ENT  2522--CALL     2568--CALL     2619--CALL
ZII$FIND_D2_IDX IN PROCEDURE COMP_DIST
      2824**DCL-ENT  2859--CALL
ZII$FIND_IDX
       194**DCL-ENT  2247--CALL     2491--CALL     2613--CALL     2667--CALL
ZII$FIND_IDX IN PROCEDURE SELECT_PORT
      2932**DCL-ENT  2957--CALL     3039--CALL
ZII$FIND_IDX IN PROCEDURE SET_DISTANCE
      2897**DCL-ENT  2901--CALL
ZII$PATH_MEMORY
       195**DCL-ENT  2000--CALL     2046--CALL     2075--CALL
ZII$PATH_MEMORY IN PROCEDURE BACK_TRACK_MAYBE
      2482**DCL-ENT  2494--CALL     2682--CALL
ZII$PRINT_PATH
       197**DCL-ENT  2333--CALL     2366--CALL     2377--CALL

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:249  
     1748        1        /*T***********************************************************/
     1749        2        /*T*                                                         */
     1750        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1751        4        /*T*                                                         */
     1752        5        /*T***********************************************************/
     1753        6        ZII$BUILD_TABLES: PROC (SCHNAM,SSCHNAM,LOCK_VALUE,STATUS_CODE);
     1754        7    1   DCL MEM_ND UBIN(36) STATIC ALIGNED;
     1755        8    1   DCL MEMORY_NEEDED UBIN AUTO;
     1756        9    1   DCL MEMORY_FRAME UBIN(36) EXTROOT;
     1757       10    1   DCL MUPT_ BIT(72) INIT('0'B) STATIC ALIGNED;
     1758       11    1   DCL LOCK_VALUE CHAR(12);
     1759       12    1   DCL STATUS_CODE UBIN(36);
     1760       13    1   DCL MMEM_ BIT(72) INIT('0'B) STATIC ALIGNED;
     1761       14    1   DCL ERROR_CODE UBIN(36) INIT(0) EXT;
     1762       15    1   DCL SCHNAM CHAR(32) ALIGNED;
     1763       16    1   DCL SSCHNAM CHAR(32) ALIGNED;
     1764       17    1   DCL HASH_VALUE UBIN(18) STATIC;
     1765       18    1   DCL B$JIT$ PTR SYMREF;
     1766       19    1   DCL SYSID CHAR(32) INIT(' ') STATIC;
     1767       20    1   DCL TRNDT CHAR(32) INIT(' ') STATIC;
     1768       21    1   DCL ZII$COMMON$ PTR EXTROOT;
     1769       22    1   DCL M UBIN AUTO;
     1770       23    1   DCL N UBIN AUTO;
     1771       24    1   DCL K UBIN AUTO;
     1772       25    1   DCL X UBIN AUTO;
     1773       26    1   DCL TEMP_ARG UBIN AUTO;
     1774       27    1   DCL TEMP_ARG1 UBIN AUTO;
     1775       28    1   DCL TEMP_ARG2 UBIN AUTO;
     1776       29        /**/
     1777       30    1   DCL ZII$FIND_IDX ENTRY(2);
     1778       31    1   DCL ZII$SEGSZ ENTRY(7) ALTRET;
     1779       32    1   DCL ZII$BLDNAM ENTRY(6) ALTRET;
     1780       33    1   DCL ZII$FIND_D2_IDX ENTRY(3);
     1781       34    1   DCL ZII$COMMON_MEMORY ENTRY(2) ALTRET;
     1782       35        /**/
     1783       36        %INCLUDE CP_6;
     1784      117        %INCLUDE CP_6_SUBS;
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:250  
     1785      657        %INCLUDE B$JIT;
     1786      947        %INCLUDE ZI$STRUCTS;
     1787     1019        %NAM1;
     1788     1048        %NAM2;
     1789     1062        %UWA1;
     1790     1085        %INCLUDE ZI$DESC;
     1791     1935        %PROC_SUBS;
     1792     1942        %DSC_AREA;
     1793     1964        %DSC_RFS;
     1794     2009        %DSC_FLD;
     1795     2124        %DSC_REC;
     1796     2158        %DSC_SET;
     1797     2200        %DSC_DESC;
     1798     2208        %TYPE_SUBS;
     1799     2218        /**/
     1800     2219        %INCLUDE ZI$TOP_STRUCTS;
     1801     2280        %D_DESC;
     1802     2289        %D2_DESC;
     1803     2296        %TBL_DIM_DESC;
     1804     2301        %INCLUDE ZI_IDPERR_SUBS;
     1805     2335        /**/
     1806     2336        %FPT_FDS(FPTN=FDS_FPT,COMMON=YES,RESULTS=RESULTSE);
     1807     2351        %VLP_VECTOR(FPTN=RESULTSE);
     1808     2366    1   DCL 1 SEGMENT_FRAME REDEF RESULTSE,
     1809     2367    1         2 COUNT UBIN HALF UNAL,
     1810     2368    1         2 * (0:2) UBIN HALF UNAL;
     1811     2369        %VLP_VECTOR(FPTN=NAM1_);
     1812     2384        %VLP_VECTOR(FPTN=NAM2_);
     1813     2399        %VLP_VECTOR(FPTN=IA_,STCLASS=EXTROOT);
     1814     2414        %VLP_VECTOR(FPTN=UWA_,STCLASS=EXTROOT);
     1815     2429        %VLP_VECTOR(FPTN=RVA_,STCLASS=EXTROOT);
     1816     2444        /**/
     1817     2445    1       STATUS_CODE=0;
     1818     2446    1       SYSID=B$JIT.UNAME;
     1819     2447    1       CALL ZII$SEGSZ(SSCHNAM,MEM_ND,#IDP,SCHNAM,LOCK_VALUE,SYSID,TRNDT) ALTRET(ER_SUBS
              2447                );
     1820     2448    1       FDS_FPT.V.SEGSIZE#=0;
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:251  
     1821     2449    1       CALL M$FDS(FDS_FPT) ALTRET(ER_FDS);
     1822     2450    1       IF SEGMENT_FRAME.COUNT>0 THEN
     1823     2451    2       DO;
     1824     2452    2           FDS_FPT.V.SEGSIZE#=SEGMENT_FRAME.COUNT;
     1825     2453    2           CALL M$FDS(FDS_FPT);
     1826     2454    2           END;
     1827     2455    1       MEMORY_NEEDED=MEM_ND;
     1828     2456    1       MEMORY_FRAME=0;
     1829     2457    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,RESULTSE) ALTRET(ER_GDS);
     1830     2458    1       CALL ZII$BLDNAM(RESULTSE,UWA_,RVA_,IA_,NAM1_,NAM2_) ALTRET(
     1831     2459    1          ER_SUBS);
     1832     2460    1       NAM1$=NAM1_.PTR$;
     1833     2461    1       NAM2$=NAM2_.PTR$;
     1834     2462    1       MEMORY_NEEDED = TBL_DIM * LENGTHW(D_TABLE(0));
     1835     2463    1       D_TBL$=PINCRW(RESULTSE.PTR$,MEMORY_FRAME);
     1836     2464    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,RESULTSE) ALTRET(ER_GDS);
     1837     2465    1       M=0;
     1838     2466    1       DA$=NAM1.DESC$(0);
     1839     2467    1       DR$=AREA.LREC$;
     1840     2468    2       DO WHILE (DR$~=ADDR(NIL));
     1841     2469    2           D_TABLE.REC_NO(M)=RECORD.NAM_IDX;
     1842     2470    2           DRFS$=RECORD.RFS_DSC$;
     1843     2471    3           DO WHILE(DRFS$~=ADDR(NIL));
     1844     2472    3               IF RFS_DSC.FLD_IDX=0 THEN
     1845     2473    4               DO;
     1846     2474    4                   IF RFS_DSC.OWN_MEM THEN
     1847     2475    4                       D_TABLE.IN_CLASS(M)=D_TABLE.IN_CLASS(M)+1;
     1848     2476    4                   ELSE
     1849     2477    4                       D_TABLE.OUT_CLASS(M)=D_TABLE.OUT_CLASS(M)+1;
     1850     2478    4                   END;
     1851     2479    3               DRFS$=RFS_DSC.REC$;
     1852     2480    3               END;
     1853     2481    2           DR$=RECORD.LREC$;
     1854     2482    2           M=M+1;
     1855     2483    2           END;
     1856     2484    1       IF TBL_DIM = 1 THEN
     1857     2485    1           MEMORY_NEEDED = 1;
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:252  
     1858     2486    1       ELSE
     1859     2487    2       DO;
     1860     2488    2           M=TBL_DIM - 1;
     1861     2489    2           N=TBL_DIM - 2;
     1862     2490    2           MEMORY_NEEDED=((((M*M)+M)-((2*M)-(2*N)))/2)+1;
     1863     2491    2           END;
     1864     2492    1       D2_TBL$=PINCRW(RESULTSE.PTR$,MEMORY_FRAME);
     1865     2493    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,RESULTSE) ALTRET(ER_GDS);
     1866     2494    1       ZII$COMMON$=PINCRW(RESULTSE.PTR$,MEMORY_FRAME);
     1867     2495    1       D2_TABLE='0'B;
     1868     2496    1       DA$=NAM1.DESC$(0);
     1869     2497    1       DS$=AREA.LSET$;
     1870     2498    2       DO WHILE (DS$~=ADDR(NIL));
     1871     2499    2           N=0;
     1872     2500    2           TEMP_ARG1=SET.OWNER_IDX;
     1873     2501    3           IF TEMP_ARG1 ~= 0 THEN DO;
     1874     2502    3               DRFS$=SET.RFS_DSC$;
     1875     2503    4               DO WHILE (DRFS$~=ADDR(NIL));
     1876     2504    4                   TEMP_ARG2=RFS_DSC.REC_IDX;
     1877     2505    4                   IF TEMP_ARG1~=TEMP_ARG2 THEN
     1878     2506    5                   DO;
     1879     2507    5                       CALL ZII$FIND_D2_IDX(TEMP_ARG1,TEMP_ARG2,X);
     1880     2508    5                       D2_TABLE.SET_IND(X)=SET.NAM_IDX;
     1881     2509    5                       END;
     1882     2510    4                   DRFS$=RFS_DSC.SET$;
     1883     2511    4                   END;
     1884     2512    3               END;
     1885     2513    2           DS$=SET.LSET$;
     1886     2514    2           END;
     1887     2515    1       RETURN;
     1888     2516    1   ER_SUBS:
     1889     2517    1       STATUS_CODE=ERROR_CODE;
     1890     2518    1       RETURN;
     1891     2519    1   ER_GDS:
     1892     2520    1       STATUS_CODE=%ZII_NO_MEMORY;
     1893     2521    1       RETURN;
     1894     2522    1   ER_FDS:
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:253  
     1895     2523    1       STATUS_CODE=%ZII_NO_MEMORY;
     1896     2524    1       RETURN;
     1897     2525    1   END ZII$BUILD_TABLES;
     1898     2526        %EOD;

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:254  
--  Include file information  --

   ZI_IDPERR_SUBS.:ZIC0TOU  is referenced.
   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$BUILD_TABLES.

   Procedure ZII$BUILD_TABLES requires 226 words for executable code.
   Procedure ZII$BUILD_TABLES requires 24 words of local(AUTO) storage.

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:255  

 Object Unit name= ZII$BUILD_TABLES                           File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:33:26.64 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    34     42  ZII$BUILD_TABLES
    1  RtLbCm even  none     1      1  MEMORY_FRAME
    2  LblCom even  none     1      1  ERROR_CODE
    3  RtLbCm even  none     1      1  ZII$COMMON$
    4   DCB   even  none     0      0  M$UC
    5  LblCom even  none     1      1  NAM1$
    6  LblCom even  none     1      1  NAM1_SIZ
    7  LblCom even  none     1      1  NAM1_IDX
    8  LblCom even  none     1      1  NAM2$
    9  LblCom even  none     1      1  NAM2_SIZ
   10  LblCom even  none     1      1  DESC#
   11  LblCom even  none     1      1  UWA$
   12  LblCom even  none     1      1  UWA_SIZ
   13  LblCom even  none     1      1  UWA#
   14  LblCom even  none     1      1  DA$
   15  LblCom even  none     1      1  DRFS$
   16  LblCom even  none     1      1  DF$
   17  LblCom even  none     1      1  DR$
   18  LblCom even  none     1      1  DS$
   19  LblCom even  none     1      1  DD$
   20  LblCom even  none     1      1  D_TBL$
   21  LblCom even  none     1      1  D2_TBL$
   22  LblCom even  none     1      1  TBL_DIM
   23  RtLbCm even  none     2      2  IA_
   24  RtLbCm even  none     2      2  UWA_
   25  RtLbCm even  none     2      2  RVA_
   26   Proc  even  none   226    342  ZII$BUILD_TABLES
   27  RoData even  none    18     22  ZII$BUILD_TABLES
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:256  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    26      0   yes            yes      Std        4  ZII$BUILD_TABLES

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       7 ZII$SEGSZ
 yes     yes           Std       6 ZII$BLDNAM
 yes     yes           Std       2 ZII$COMMON_MEMORY
         yes           Std       3 ZII$FIND_D2_IDX
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:257  


     1748        1        /*T***********************************************************/
     1749        2        /*T*                                                         */
     1750        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1751        4        /*T*                                                         */
     1752        5        /*T***********************************************************/
     1753        6        ZII$BUILD_TABLES: PROC (SCHNAM,SSCHNAM,LOCK_VALUE,STATUS_CODE);

      6 26 000000   000000 700200 xent  ZII$BUILD_T* TSX0  ! X66_AUTO_4
        26 000001   000030 000004                    ZERO    24,4

     1754        7    1   DCL MEM_ND UBIN(36) STATIC ALIGNED;
     1755        8    1   DCL MEMORY_NEEDED UBIN AUTO;
     1756        9    1   DCL MEMORY_FRAME UBIN(36) EXTROOT;
     1757       10    1   DCL MUPT_ BIT(72) INIT('0'B) STATIC ALIGNED;
     1758       11    1   DCL LOCK_VALUE CHAR(12);
     1759       12    1   DCL STATUS_CODE UBIN(36);
     1760       13    1   DCL MMEM_ BIT(72) INIT('0'B) STATIC ALIGNED;
     1761       14    1   DCL ERROR_CODE UBIN(36) INIT(0) EXT;
     1762       15    1   DCL SCHNAM CHAR(32) ALIGNED;
     1763       16    1   DCL SSCHNAM CHAR(32) ALIGNED;
     1764       17    1   DCL HASH_VALUE UBIN(18) STATIC;
     1765       18    1   DCL B$JIT$ PTR SYMREF;
     1766       19    1   DCL SYSID CHAR(32) INIT(' ') STATIC;
     1767       20    1   DCL TRNDT CHAR(32) INIT(' ') STATIC;
     1768       21    1   DCL ZII$COMMON$ PTR EXTROOT;
     1769       22    1   DCL M UBIN AUTO;
     1770       23    1   DCL N UBIN AUTO;
     1771       24    1   DCL K UBIN AUTO;
     1772       25    1   DCL X UBIN AUTO;
     1773       26    1   DCL TEMP_ARG UBIN AUTO;
     1774       27    1   DCL TEMP_ARG1 UBIN AUTO;
     1775       28    1   DCL TEMP_ARG2 UBIN AUTO;
     1776       29        /**/
     1777       30    1   DCL ZII$FIND_IDX ENTRY(2);
     1778       31    1   DCL ZII$SEGSZ ENTRY(7) ALTRET;
     1779       32    1   DCL ZII$BLDNAM ENTRY(6) ALTRET;
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:258  
     1780       33    1   DCL ZII$FIND_D2_IDX ENTRY(3);
     1781       34    1   DCL ZII$COMMON_MEMORY ENTRY(2) ALTRET;
     1782       35        /**/
     1783       36        %INCLUDE CP_6;
     1784      117        %INCLUDE CP_6_SUBS;
     1785      657        %INCLUDE B$JIT;
     1786      947        %INCLUDE ZI$STRUCTS;
     1787     1019        %NAM1;
     1788     1048        %NAM2;
     1789     1062        %UWA1;
     1790     1085        %INCLUDE ZI$DESC;
     1791     1935        %PROC_SUBS;
     1792     1942        %DSC_AREA;
     1793     1964        %DSC_RFS;
     1794     2009        %DSC_FLD;
     1795     2124        %DSC_REC;
     1796     2158        %DSC_SET;
     1797     2200        %DSC_DESC;
     1798     2208        %TYPE_SUBS;
     1799     2218        /**/
     1800     2219        %INCLUDE ZI$TOP_STRUCTS;
     1801     2280        %D_DESC;
     1802     2289        %D2_DESC;
     1803     2296        %TBL_DIM_DESC;
     1804     2301        %INCLUDE ZI_IDPERR_SUBS;
     1805     2335        /**/
     1806     2336        %FPT_FDS(FPTN=FDS_FPT,COMMON=YES,RESULTS=RESULTSE);
     1807     2351        %VLP_VECTOR(FPTN=RESULTSE);
     1808     2366    1   DCL 1 SEGMENT_FRAME REDEF RESULTSE,
     1809     2367    1         2 COUNT UBIN HALF UNAL,
     1810     2368    1         2 * (0:2) UBIN HALF UNAL;
     1811     2369        %VLP_VECTOR(FPTN=NAM1_);
     1812     2384        %VLP_VECTOR(FPTN=NAM2_);
     1813     2399        %VLP_VECTOR(FPTN=IA_,STCLASS=EXTROOT);
     1814     2414        %VLP_VECTOR(FPTN=UWA_,STCLASS=EXTROOT);
     1815     2429        %VLP_VECTOR(FPTN=RVA_,STCLASS=EXTROOT);
     1816     2444        /**/
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:259  
     1817     2445    1       STATUS_CODE=0;

   2445 26 000002   200006 470500                    LDP0    @STATUS_CODE,,AUTO
        26 000003   000000 450100                    STZ     0,,PR0

     1818     2446    1       SYSID=B$JIT.UNAME;

   2446 26 000004   000000 471400 xsym               LDP1    B$JIT$
        26 000005   040000 100500                    MLR     fill='040'O
        26 000006   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12
        26 000007   000006 000040 0                  ADSC9   SYSID                    cn=0,n=32

     1819     2447    1      CALL ZII$SEGSZ(SSCHNAM,MEM_ND,#IDP,SCHNAM,LOCK_VALUE,SYSID,TRNDT) ALTRET(ER_SUBS
              2447                );

   2447 26 000010   000002 236000 27                 LDQ     2
        26 000011   200026 756100                    STQ     TEMP_ARG2+8,,AUTO
        26 000012   000003 236000 27                 LDQ     3
        26 000013   200005 235100                    LDA     @LOCK_VALUE,,AUTO
        26 000014   200024 757100                    STAQ    TEMP_ARG2+6,,AUTO
        26 000015   200003 236100                    LDQ     @SCHNAM,,AUTO
        26 000016   000004 235000 27                 LDA     4
        26 000017   200022 757100                    STAQ    TEMP_ARG2+4,,AUTO
        26 000020   000005 236000 27                 LDQ     5
        26 000021   200004 235100                    LDA     @SSCHNAM,,AUTO
        26 000022   200020 757100                    STAQ    TEMP_ARG2+2,,AUTO
        26 000023   200020 630500                    EPPR0   TEMP_ARG2+2,,AUTO
        26 000024   000000 631400 27                 EPPR1   0
        26 000025   000000 701000 xent               TSX1    ZII$SEGSZ
        26 000026   000326 702000 26                 TSX2    ER_SUBS

     1820     2448    1       FDS_FPT.V.SEGSIZE#=0;

   2448 26 000027   000000 220003                    LDX0    0,DU
        26 000030   000032 440000 0                  SXL0    FDS_FPT+4

     1821     2449    1       CALL M$FDS(FDS_FPT) ALTRET(ER_FDS);
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:260  

   2449 26 000031   000026 630400 0                  EPPR0   FDS_FPT
        26 000032   430002 713400                    CLIMB   alt,fds
        26 000033   400400 401760                    pmme    nvectors=2
        26 000034   000336 702000 26                 TSX2    ER_FDS

     1822     2450    1       IF SEGMENT_FRAME.COUNT>0 THEN

   2450 26 000035   000034 220000 0                  LDX0    RESULTSE
        26 000036   000043 600000 26                 TZE     s:2455

     1823     2451    2       DO;

     1824     2452    2           FDS_FPT.V.SEGSIZE#=SEGMENT_FRAME.COUNT;

   2452 26 000037   000032 440000 0                  SXL0    FDS_FPT+4

     1825     2453    2           CALL M$FDS(FDS_FPT);

   2453 26 000040   000026 630400 0                  EPPR0   FDS_FPT
        26 000041   030002 713400                    CLIMB   fds
        26 000042   400400 401760                    pmme    nvectors=2

     1826     2454    2           END;

     1827     2455    1       MEMORY_NEEDED=MEM_ND;

   2455 26 000043   000000 235000 0                  LDA     MEM_ND
        26 000044   200007 755100                    STA     MEMORY_NEEDED,,AUTO

     1828     2456    1       MEMORY_FRAME=0;

   2456 26 000045   000000 450000 1                  STZ     MEMORY_FRAME

     1829     2457    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,RESULTSE) ALTRET(ER_GDS);

   2457 26 000046   000007 236000 27                 LDQ     7
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:261  
        26 000047   200021 756100                    STQ     TEMP_ARG2+3,,AUTO
        26 000050   200007 630500                    EPPR0   MEMORY_NEEDED,,AUTO
        26 000051   200020 450500                    STP0    TEMP_ARG2+2,,AUTO
        26 000052   200020 630500                    EPPR0   TEMP_ARG2+2,,AUTO
        26 000053   000006 631400 27                 EPPR1   6
        26 000054   000000 701000 xent               TSX1    ZII$COMMON_MEMORY
        26 000055   000332 702000 26                 TSX2    ER_GDS

     1830     2458    1       CALL ZII$BLDNAM(RESULTSE,UWA_,RVA_,IA_,NAM1_,NAM2_) ALTRET(

   2458 26 000056   000011 630400 27                 EPPR0   9
        26 000057   000010 631400 27                 EPPR1   8
        26 000060   000000 701000 xent               TSX1    ZII$BLDNAM
        26 000061   000326 702000 26                 TSX2    ER_SUBS

     1831     2459    1          ER_SUBS);
     1832     2460    1       NAM1$=NAM1_.PTR$;

   2460 26 000062   000037 236000 0                  LDQ     NAM1_+1
        26 000063   000000 756000 5                  STQ     NAM1$

     1833     2461    1       NAM2$=NAM2_.PTR$;

   2461 26 000064   000041 236000 0                  LDQ     NAM2_+1
        26 000065   000000 756000 8                  STQ     NAM2$

     1834     2462    1       MEMORY_NEEDED = TBL_DIM * LENGTHW(D_TABLE(0));

   2462 26 000066   000000 235000 22                 LDA     TBL_DIM
        26 000067   000002 735000                    ALS     2
        26 000070   200007 755100                    STA     MEMORY_NEEDED,,AUTO

     1835     2463    1       D_TBL$=PINCRW(RESULTSE.PTR$,MEMORY_FRAME);

   2463 26 000071   000000 236000 1                  LDQ     MEMORY_FRAME
        26 000072   000022 736000                    QLS     18
        26 000073   000035 036000 0                  ADLQ    RESULTSE+1
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:262  
        26 000074   000000 756000 20                 STQ     D_TBL$

     1836     2464    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,RESULTSE) ALTRET(ER_GDS);

   2464 26 000075   000007 236000 27                 LDQ     7
        26 000076   200021 756100                    STQ     TEMP_ARG2+3,,AUTO
        26 000077   200007 630500                    EPPR0   MEMORY_NEEDED,,AUTO
        26 000100   200020 450500                    STP0    TEMP_ARG2+2,,AUTO
        26 000101   200020 630500                    EPPR0   TEMP_ARG2+2,,AUTO
        26 000102   000006 631400 27                 EPPR1   6
        26 000103   000000 701000 xent               TSX1    ZII$COMMON_MEMORY
        26 000104   000332 702000 26                 TSX2    ER_GDS

     1837     2465    1       M=0;

   2465 26 000105   200010 450100                    STZ     M,,AUTO

     1838     2466    1       DA$=NAM1.DESC$(0);

   2466 26 000106   000000 470400 5                  LDP0    NAM1$
        26 000107   000011 236100                    LDQ     9,,PR0
        26 000110   000000 756000 14                 STQ     DA$

     1839     2467    1       DR$=AREA.LREC$;

   2467 26 000111   000000 471400 14                 LDP1    DA$
        26 000112   100003 236100                    LDQ     3,,PR1
        26 000113   000000 756000 17                 STQ     DR$

     1840     2468    2       DO WHILE (DR$~=ADDR(NIL));

   2468 26 000114   000167 710000 26                 TRA     s:2483

     1841     2469    2           D_TABLE.REC_NO(M)=RECORD.NAM_IDX;

   2469 26 000115   200010 235100                    LDA     M,,AUTO
        26 000116   000002 735000                    ALS     2
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:263  
        26 000117   000000 470400 17                 LDP0    DR$
        26 000120   000000 220100                    LDX0    0,,PR0
        26 000121   000000 471400 20                 LDP1    D_TBL$
        26 000122   100000 740105                    STX0    0,AL,PR1

     1842     2470    2           DRFS$=RECORD.RFS_DSC$;

   2470 26 000123   000000 470400 17                 LDP0    DR$
        26 000124   000006 236100                    LDQ     6,,PR0
        26 000125   000000 756000 15                 STQ     DRFS$

     1843     2471    3           DO WHILE(DRFS$~=ADDR(NIL));

   2471 26 000126   000157 710000 26                 TRA     s:2480

     1844     2472    3               IF RFS_DSC.FLD_IDX=0 THEN

   2472 26 000127   000000 470400 15                 LDP0    DRFS$
        26 000130   000001 220100                    LDX0    1,,PR0
        26 000131   000154 601000 26                 TNZ     s:2479

     1845     2473    4               DO;

     1846     2474    4                   IF RFS_DSC.OWN_MEM THEN

   2474 26 000132   000001 236100                    LDQ     1,,PR0
        26 000133   400000 316007                    CANQ    -131072,DL
        26 000134   000145 600000 26                 TZE     s:2477

     1847     2475    4                       D_TABLE.IN_CLASS(M)=D_TABLE.IN_CLASS(M)+1;

   2475 26 000135   200010 235100                    LDA     M,,AUTO
        26 000136   000002 735000                    ALS     2
        26 000137   000000 471400 20                 LDP1    D_TBL$
        26 000140   000000 621005                    EAX1    0,AL
        26 000141   100001 235105                    LDA     1,AL,PR1
        26 000142   000001 035007                    ADLA    1,DL
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:264  
        26 000143   100001 755111                    STA     1,X1,PR1
        26 000144   000154 710000 26                 TRA     s:2479

     1848     2476    4                   ELSE
     1849     2477    4                       D_TABLE.OUT_CLASS(M)=D_TABLE.OUT_CLASS(M)+1;

   2477 26 000145   200010 235100                    LDA     M,,AUTO
        26 000146   000002 735000                    ALS     2
        26 000147   000000 471400 20                 LDP1    D_TBL$
        26 000150   000000 621005                    EAX1    0,AL
        26 000151   100002 235105                    LDA     2,AL,PR1
        26 000152   000001 035007                    ADLA    1,DL
        26 000153   100002 755111                    STA     2,X1,PR1

     1850     2478    4                   END;

     1851     2479    3               DRFS$=RFS_DSC.REC$;

   2479 26 000154   000000 470400 15                 LDP0    DRFS$
        26 000155   000005 236100                    LDQ     5,,PR0
        26 000156   000000 756000 15                 STQ     DRFS$

     1852     2480    3               END;

   2480 26 000157   000017 116000 27                 CMPQ    15
        26 000160   000127 601000 26                 TNZ     s:2472

     1853     2481    2           DR$=RECORD.LREC$;

   2481 26 000161   000000 470400 17                 LDP0    DR$
        26 000162   000005 236100                    LDQ     5,,PR0
        26 000163   000000 756000 17                 STQ     DR$

     1854     2482    2           M=M+1;

   2482 26 000164   200010 235100                    LDA     M,,AUTO
        26 000165   000001 035007                    ADLA    1,DL
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:265  
        26 000166   200010 755100                    STA     M,,AUTO

     1855     2483    2           END;

   2483 26 000167   000017 116000 27                 CMPQ    15
        26 000170   000115 601000 26                 TNZ     s:2469

     1856     2484    1       IF TBL_DIM = 1 THEN

   2484 26 000171   000000 235000 22                 LDA     TBL_DIM
        26 000172   000001 115007                    CMPA    1,DL
        26 000173   000177 601000 26                 TNZ     s:2488

     1857     2485    1           MEMORY_NEEDED = 1;

   2485 26 000174   000001 235007                    LDA     1,DL
        26 000175   200007 755100                    STA     MEMORY_NEEDED,,AUTO
        26 000176   000221 710000 26                 TRA     s:2492

     1858     2486    1       ELSE
     1859     2487    2       DO;

     1860     2488    2           M=TBL_DIM - 1;

   2488 26 000177   000001 135007                    SBLA    1,DL
        26 000200   200010 755100                    STA     M,,AUTO

     1861     2489    2           N=TBL_DIM - 2;

   2489 26 000201   000000 235000 22                 LDA     TBL_DIM
        26 000202   000002 135007                    SBLA    2,DL
        26 000203   200011 755100                    STA     N,,AUTO

     1862     2490    2           MEMORY_NEEDED=((((M*M)+M)-((2*M)-(2*N)))/2)+1;

   2490 26 000204   200010 236100                    LDQ     M,,AUTO
        26 000205   200010 402100                    MPY     M,,AUTO
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:266  
        26 000206   200010 036100                    ADLQ    M,,AUTO
        26 000207   200020 756100                    STQ     TEMP_ARG2+2,,AUTO
        26 000210   200010 236100                    LDQ     M,,AUTO
        26 000211   200011 136100                    SBLQ    N,,AUTO
        26 000212   000001 736000                    QLS     1
        26 000213   000020 676000 27                 ERQ     16
        26 000214   000001 036007                    ADLQ    1,DL
        26 000215   200020 036100                    ADLQ    TEMP_ARG2+2,,AUTO
        26 000216   000002 506007                    DIV     2,DL
        26 000217   000001 036007                    ADLQ    1,DL
        26 000220   200007 756100                    STQ     MEMORY_NEEDED,,AUTO

     1863     2491    2           END;

     1864     2492    1       D2_TBL$=PINCRW(RESULTSE.PTR$,MEMORY_FRAME);

   2492 26 000221   000000 236000 1                  LDQ     MEMORY_FRAME
        26 000222   000022 736000                    QLS     18
        26 000223   000035 036000 0                  ADLQ    RESULTSE+1
        26 000224   000000 756000 21                 STQ     D2_TBL$

     1865     2493    1       CALL ZII$COMMON_MEMORY(MEMORY_NEEDED,RESULTSE) ALTRET(ER_GDS);

   2493 26 000225   000007 236000 27                 LDQ     7
        26 000226   200021 756100                    STQ     TEMP_ARG2+3,,AUTO
        26 000227   200007 630500                    EPPR0   MEMORY_NEEDED,,AUTO
        26 000230   200020 450500                    STP0    TEMP_ARG2+2,,AUTO
        26 000231   200020 630500                    EPPR0   TEMP_ARG2+2,,AUTO
        26 000232   000006 631400 27                 EPPR1   6
        26 000233   000000 701000 xent               TSX1    ZII$COMMON_MEMORY
        26 000234   000332 702000 26                 TSX2    ER_GDS

     1866     2494    1       ZII$COMMON$=PINCRW(RESULTSE.PTR$,MEMORY_FRAME);

   2494 26 000235   000000 236000 1                  LDQ     MEMORY_FRAME
        26 000236   000022 736000                    QLS     18
        26 000237   000035 036000 0                  ADLQ    RESULTSE+1
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:267  
        26 000240   000000 756000 3                  STQ     ZII$COMMON$

     1867     2495    1       D2_TABLE='0'B;

   2495 26 000241   000000 220003                    LDX0    0,DU
        26 000242   000000 470400 21                 LDP0    D2_TBL$
        26 000243   000000 740100                    STX0    0,,PR0

     1868     2496    1       DA$=NAM1.DESC$(0);

   2496 26 000244   000000 470400 5                  LDP0    NAM1$
        26 000245   000011 236100                    LDQ     9,,PR0
        26 000246   000000 756000 14                 STQ     DA$

     1869     2497    1       DS$=AREA.LSET$;

   2497 26 000247   000000 471400 14                 LDP1    DA$
        26 000250   100004 236100                    LDQ     4,,PR1
        26 000251   000000 756000 18                 STQ     DS$

     1870     2498    2       DO WHILE (DS$~=ADDR(NIL));

   2498 26 000252   000323 710000 26                 TRA     s:2514

     1871     2499    2           N=0;

   2499 26 000253   200011 450100                    STZ     N,,AUTO

     1872     2500    2           TEMP_ARG1=SET.OWNER_IDX;

   2500 26 000254   000000 470400 18                 LDP0    DS$
        26 000255   000001 236100                    LDQ     1,,PR0
        26 000256   000022 772000                    QRL     18
        26 000257   200015 756100                    STQ     TEMP_ARG1,,AUTO

     1873     2501    3           IF TEMP_ARG1 ~= 0 THEN DO;

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:268  
   2501 26 000260   000320 600000 26                 TZE     s:2513

     1874     2502    3               DRFS$=SET.RFS_DSC$;

   2502 26 000261   000007 236100                    LDQ     7,,PR0
        26 000262   000000 756000 15                 STQ     DRFS$

     1875     2503    4               DO WHILE (DRFS$~=ADDR(NIL));

   2503 26 000263   000316 710000 26                 TRA     s:2511

     1876     2504    4                   TEMP_ARG2=RFS_DSC.REC_IDX;

   2504 26 000264   000000 470400 15                 LDP0    DRFS$
        26 000265   000000 236100                    LDQ     0,,PR0
        26 000266   000022 772000                    QRL     18
        26 000267   200016 756100                    STQ     TEMP_ARG2,,AUTO

     1877     2505    4                   IF TEMP_ARG1~=TEMP_ARG2 THEN

   2505 26 000270   200015 116100                    CMPQ    TEMP_ARG1,,AUTO
        26 000271   000313 600000 26                 TZE     s:2510

     1878     2506    5                   DO;

     1879     2507    5                       CALL ZII$FIND_D2_IDX(TEMP_ARG1,TEMP_ARG2,X);

   2507 26 000272   200013 631500                    EPPR1   X,,AUTO
        26 000273   200022 451500                    STP1    TEMP_ARG2+4,,AUTO
        26 000274   200016 633500                    EPPR3   TEMP_ARG2,,AUTO
        26 000275   200021 453500                    STP3    TEMP_ARG2+3,,AUTO
        26 000276   200015 634500                    EPPR4   TEMP_ARG1,,AUTO
        26 000277   200020 454500                    STP4    TEMP_ARG2+2,,AUTO
        26 000300   200020 630500                    EPPR0   TEMP_ARG2+2,,AUTO
        26 000301   000021 631400 27                 EPPR1   17
        26 000302   000000 701000 xent               TSX1    ZII$FIND_D2_IDX
        26 000303   000000 011000                    NOP     0
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:269  

     1880     2508    5                       D2_TABLE.SET_IND(X)=SET.NAM_IDX;

   2508 26 000304   200013 235100                    LDA     X,,AUTO
        26 000305   000001 735000                    ALS     1
        26 000306   000000 470400 18                 LDP0    DS$
        26 000307   000000 471400 21                 LDP1    D2_TBL$
        26 000310   000105 100500                    MLR     fill='000'O
        26 000311   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
        26 000312   100000 000002                    ADSC9   0,A,PR1                  cn=0,n=2

     1881     2509    5                       END;

     1882     2510    4                   DRFS$=RFS_DSC.SET$;

   2510 26 000313   000000 470400 15                 LDP0    DRFS$
        26 000314   000006 236100                    LDQ     6,,PR0
        26 000315   000000 756000 15                 STQ     DRFS$

     1883     2511    4                   END;

   2511 26 000316   000017 116000 27                 CMPQ    15
        26 000317   000264 601000 26                 TNZ     s:2504

     1884     2512    3               END;

     1885     2513    2           DS$=SET.LSET$;

   2513 26 000320   000000 470400 18                 LDP0    DS$
        26 000321   000006 236100                    LDQ     6,,PR0
        26 000322   000000 756000 18                 STQ     DS$

     1886     2514    2           END;

   2514 26 000323   000017 116000 27                 CMPQ    15
        26 000324   000253 601000 26                 TNZ     s:2499

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:270  
     1887     2515    1       RETURN;

   2515 26 000325   000000 702200 xent               TSX2  ! X66_ARET

     1888     2516    1   ER_SUBS:
     1889     2517    1       STATUS_CODE=ERROR_CODE;

   2517 26 000326   200006 470500       ER_SUBS      LDP0    @STATUS_CODE,,AUTO
        26 000327   000000 235000 2                  LDA     ERROR_CODE
        26 000330   000000 755100                    STA     0,,PR0

     1890     2518    1       RETURN;

   2518 26 000331   000000 702200 xent               TSX2  ! X66_ARET

     1891     2519    1   ER_GDS:
     1892     2520    1       STATUS_CODE=%ZII_NO_MEMORY;

   2520 26 000332   013561 235007       ER_GDS       LDA     6001,DL
        26 000333   200006 470500                    LDP0    @STATUS_CODE,,AUTO
        26 000334   000000 755100                    STA     0,,PR0

     1893     2521    1       RETURN;

   2521 26 000335   000000 702200 xent               TSX2  ! X66_ARET

     1894     2522    1   ER_FDS:
     1895     2523    1       STATUS_CODE=%ZII_NO_MEMORY;

   2523 26 000336   013561 235007       ER_FDS       LDA     6001,DL
        26 000337   200006 470500                    LDP0    @STATUS_CODE,,AUTO
        26 000340   000000 755100                    STA     0,,PR0

     1896     2524    1       RETURN;

   2524 26 000341   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:271  
MUPT_
 Sect OctLoc
   0     001   000000 000000   000000 000000                                    ........

MMEM_
 Sect OctLoc
   0     003   000000 000000   000000 000000                                    ........

SYSID
 Sect OctLoc
   0     006   040040 040040   040040 040040   040040 040040   040040 040040
   0     012   040040 040040   040040 040040   040040 040040   040040 040040

TRNDT
 Sect OctLoc
   0     016   040040 040040   040040 040040   040040 040040   040040 040040
   0     022   040040 040040   040040 040040   040040 040040   040040 040040

FDS_FPT
 Sect OctLoc
   0     026   000001 777640   000032 006000   000001 777640   000034 006000    ................
   0     032   200000 000000   ****** ******                                    ........

RESULTSE
 Sect OctLoc
   0     034   000000 177640   000000 006014                                    ........

NAM1_
 Sect OctLoc
   0     036   000000 177640   000000 006014                                    ........

NAM2_
 Sect OctLoc
   0     040   000000 177640   000000 006014                                    ........

ERROR_CODE
 Sect OctLoc
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:272  
   2     000   000000 000000                                                    ....

IA_
 Sect OctLoc
  23     000   000000 177640   000000 006014                                    ........

UWA_
 Sect OctLoc
  24     000   000000 177640   000000 006014                                    ........

RVA_
 Sect OctLoc
  25     000   000000 177640   000000 006014                                    ........

(unnamed)
 Sect OctLoc
  27     000   000007 000000   000000 000004   000016 006000   000006 006000    ................
  27     004   000001 006000   000000 006000   000002 000000   000034 006000    ................
  27     010   000006 000000   000034 006000   000000 006000   000000 006000    ................
  27     014   000000 006000   000036 006000   000040 006000   000000 006014    ......... ......
  27     020   777777 777777   000003 000000                                    ........
     1897     2525    1   END ZII$BUILD_TABLES;
     1898     2526        %EOD;

PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:273  
--  Include file information  --

   ZI_IDPERR_SUBS.:ZIC0TOU  is referenced.
   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$BUILD_TABLES.

   Procedure ZII$BUILD_TABLES requires 226 words for executable code.
   Procedure ZII$BUILD_TABLES requires 24 words of local(AUTO) storage.
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:274  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:275  
          MINI XREF LISTING

AREA.LREC$
      1957**DCL      2467>>ASSIGN
AREA.LSET$
      1958**DCL      2497>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       765**DCL       765--REDEF
B$JIT.ERR.MID
       672**DCL       672--REDEF
B$JIT.JRESPEAK
       833**DCL       834--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       942**DCL       942--REDEF     943--REDEF
B$JIT.PNR
       846**DCL       846--REDEF
B$JIT.TSLINE
       940**DCL       941--REDEF
B$JIT.UNAME
       671**DCL      2446>>ASSIGN
B$JIT$
        18**DCL       666--IMP-PTR  2446>>ASSIGN
D2_TABLE
      2291**DCL      2495<<ASSIGN
D2_TABLE.SET_IND
      2292**DCL      2508<<ASSIGN
D2_TBL$
      2290**DCL      2291--IMP-PTR  2492<<ASSIGN   2495>>ASSIGN   2508>>ASSIGN
DA$
      1943**DCL      1944--IMP-PTR  2466<<ASSIGN   2467>>ASSIGN   2496<<ASSIGN   2497>>ASSIGN
DD$
      2201**DCL      2202--IMP-PTR
DESC#
      1055**DCL      1060--IMP-SIZ
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:276  
DF$
      2010**DCL      2011--IMP-PTR
DR$
      2125**DCL      2126--IMP-PTR  2467<<ASSIGN   2468>>DOWHILE  2469>>ASSIGN   2470>>ASSIGN   2481<<ASSIGN
      2481>>ASSIGN
DRFS$
      1965**DCL      1966--IMP-PTR  2470<<ASSIGN   2471>>DOWHILE  2472>>IF       2474>>IF       2479<<ASSIGN
      2479>>ASSIGN   2502<<ASSIGN   2503>>DOWHILE  2504>>ASSIGN   2510<<ASSIGN   2510>>ASSIGN
DS$
      2159**DCL      2160--IMP-PTR  2497<<ASSIGN   2498>>DOWHILE  2500>>ASSIGN   2502>>ASSIGN   2508>>ASSIGN
      2513<<ASSIGN   2513>>ASSIGN
D_TABLE
      2282**DCL      2462--ASSIGN
D_TABLE.IN_CLASS
      2285**DCL      2475<<ASSIGN   2475>>ASSIGN
D_TABLE.OUT_CLASS
      2286**DCL      2477<<ASSIGN   2477>>ASSIGN
D_TABLE.REC_NO
      2283**DCL      2469<<ASSIGN
D_TBL$
      2281**DCL      2282--IMP-PTR  2463<<ASSIGN   2469>>ASSIGN   2475>>ASSIGN   2475>>ASSIGN   2477>>ASSIGN
      2477>>ASSIGN
ERROR_CODE
        14**DCL      2517>>ASSIGN
ER_FDS
      2523**LABEL    2449--CALLALT
ER_GDS
      2520**LABEL    2457--CALLALT  2464--CALLALT  2493--CALLALT
ER_SUBS
      2517**LABEL    2447--CALLALT  2458--CALLALT
FDS_FPT
      2347**DCL      2449<>CALL     2453<>CALL
FDS_FPT.V
      2347**DCL      2347--DCLINIT
FDS_FPT.V.SEGSIZE#
      2349**DCL      2448<<ASSIGN   2452<<ASSIGN
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:277  
FIELD.EIS_BITS.NDSC
      2082**DCL      2111--REDEF
FIELD.FLAG_BITS_1
      2023**DCL      2024--REDEF
FIELD.FLAG_BITS_2
      2050**DCL      2051--REDEF
IA_
      2410**DCL      2458<>CALL
IA_.W2
      2411**DCL      2412--REDEF
LOCK_VALUE
        11**DCL         6--PROC     2447<>CALL
M
        22**DCL      2465<<ASSIGN   2469>>ASSIGN   2475>>ASSIGN   2475>>ASSIGN   2477>>ASSIGN   2477>>ASSIGN
      2482<<ASSIGN   2482>>ASSIGN   2488<<ASSIGN   2490>>ASSIGN   2490>>ASSIGN   2490>>ASSIGN   2490>>ASSIGN
M$FDS
        80**DCL-ENT  2449--CALL     2453--CALL
MEMORY_FRAME
         9**DCL      2456<<ASSIGN   2463>>ASSIGN   2492>>ASSIGN   2494>>ASSIGN
MEMORY_NEEDED
         8**DCL      2455<<ASSIGN   2457<>CALL     2462<<ASSIGN   2464<>CALL     2485<<ASSIGN   2490<<ASSIGN
      2493<>CALL
MEM_ND
         7**DCL      2447<>CALL     2455>>ASSIGN
N
        23**DCL      2489<<ASSIGN   2490>>ASSIGN   2499<<ASSIGN
NAM1.DESC$
      1046**DCL      2466>>ASSIGN   2496>>ASSIGN
NAM1$
      1028**DCL      1031--IMP-PTR  2460<<ASSIGN   2466>>ASSIGN   2496>>ASSIGN
NAM1_
      2380**DCL      2458<>CALL
NAM1_.PTR$
      2382**DCL      2460>>ASSIGN
NAM1_.W2
      2381**DCL      2382--REDEF
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:278  
NAM2.DESC
      1059**DCL      1060--REDEF
NAM2$
      1053**DCL      1056--IMP-PTR  2461<<ASSIGN
NAM2_
      2395**DCL      2458<>CALL
NAM2_.PTR$
      2397**DCL      2461>>ASSIGN
NAM2_.W2
      2396**DCL      2397--REDEF
RECORD.FLAG_BITS
      2130**DCL      2131--REDEF
RECORD.LREC$
      2153**DCL      2481>>ASSIGN
RECORD.NAM_IDX
      2127**DCL      2469>>ASSIGN
RECORD.RFS_DSC$
      2154**DCL      2470>>ASSIGN
RESULTSE
      2362**DCL      2347--DCLINIT  2366--REDEF    2457<>CALL     2458<>CALL     2464<>CALL     2493<>CALL
RESULTSE.PTR$
      2364**DCL      2463>>ASSIGN   2492>>ASSIGN   2494>>ASSIGN
RESULTSE.W2
      2363**DCL      2364--REDEF
RFS_DSC.FLD_IDX
      1969**DCL      2472>>IF
RFS_DSC.OWN_MEM
      1970**DCL      2474>>IF
RFS_DSC.REC$
      2004**DCL      2479>>ASSIGN
RFS_DSC.REC_IDX
      1967**DCL      2504>>ASSIGN
RFS_DSC.SET$
      2005**DCL      2510>>ASSIGN
RVA_
      2440**DCL      2458<>CALL
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:279  
RVA_.W2
      2441**DCL      2442--REDEF
SCHNAM
        15**DCL         6--PROC     2447<>CALL
SEGMENT_FRAME.COUNT
      2367**DCL      2450>>IF       2452>>ASSIGN
SET.FLAG_BITS
      2165**DCL      2166--REDEF
SET.LSET$
      2196**DCL      2513>>ASSIGN
SET.NAM_IDX
      2161**DCL      2508>>ASSIGN
SET.OWNER_IDX
      2163**DCL      2500>>ASSIGN
SET.RFS_DSC$
      2197**DCL      2502>>ASSIGN
SSCHNAM
        16**DCL         6--PROC     2447<>CALL
STATUS_CODE
        12**DCL         6--PROC     2445<<ASSIGN   2517<<ASSIGN   2520<<ASSIGN   2523<<ASSIGN
SYSID
        19**DCL      2446<<ASSIGN   2447<>CALL
TBL_DIM
      2297**DCL      2462>>ASSIGN   2484>>IF       2488>>ASSIGN   2489>>ASSIGN
TEMP_ARG1
        27**DCL      2500<<ASSIGN   2501>>IF       2505>>IF       2507<>CALL
TEMP_ARG2
        28**DCL      2504<<ASSIGN   2505>>IF       2507<>CALL
TRNDT
        20**DCL      2447<>CALL
UWA#
      1065**DCL      1083--IMP-SIZ
UWA$
      1063**DCL      1066--IMP-PTR
UWA_
      2425**DCL      2458<>CALL
PL6.E3A0      #002=ZII$BUILD_TABLES File=ZII$TOP_LIB.:ZIC0TSI                    FRI 09/05/97 12:33 Page:280  
UWA_.W2
      2426**DCL      2427--REDEF
X
        25**DCL      2507<>CALL     2508>>ASSIGN
ZII$BLDNAM
        32**DCL-ENT  2458--CALL
ZII$COMMON$
        21**DCL      2494<<ASSIGN
ZII$COMMON_MEMORY
        34**DCL-ENT  2457--CALL     2464--CALL     2493--CALL
ZII$FIND_D2_IDX
        33**DCL-ENT  2507--CALL
ZII$SEGSZ
        31**DCL-ENT  2447--CALL

PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:281  
     1899        1        /*T***********************************************************/
     1900        2        /*T*                                                         */
     1901        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1902        4        /*T*                                                         */
     1903        5        /*T***********************************************************/
     1904        6        ZII$FIND_IDX: PROC (IN_REC,OUT_INDX);
     1905        7    1   DCL IN_REC UBIN;
     1906        8    1   DCL OUT_INDX UBIN;
     1907        9    1   DCL I UBIN AUTO;
     1908       10        /**/
     1909       11        %INCLUDE ZI$TOP_STRUCTS;
     1910       72        %D_DESC;
     1911       81        %TBL_DIM_DESC;
     1912       86        /**/
     1913       87    1       OUT_INDX=0;
     1914       88    1       I=0;
     1915       89    2       DO WHILE (I<TBL_DIM);
     1916       90    2           IF IN_REC=D_TABLE.REC_NO(I) THEN
     1917       91    3           DO;
     1918       92    3               OUT_INDX=I;
     1919       93    3               I=TBL_DIM;
     1920       94    3               END;
     1921       95    2           I=I+1;
     1922       96    2           END;
     1923       97    1       RETURN;
     1924       98    1   END ZII$FIND_IDX;
     1925       99        %EOD;

PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:282  
--  Include file information  --

   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FIND_IDX.

   Procedure ZII$FIND_IDX requires 28 words for executable code.
   Procedure ZII$FIND_IDX requires 6 words of local(AUTO) storage.

PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:283  

 Object Unit name= ZII$FIND_IDX                               File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:33:37.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  D_TBL$
    1  LblCom even  none     1      1  TBL_DIM
    2   Proc  even  none    28     34  ZII$FIND_IDX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  ZII$FIND_IDX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:284  


     1899        1        /*T***********************************************************/
     1900        2        /*T*                                                         */
     1901        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1902        4        /*T*                                                         */
     1903        5        /*T***********************************************************/
     1904        6        ZII$FIND_IDX: PROC (IN_REC,OUT_INDX);

      6  2 000000   000000 700200 xent  ZII$FIND_IDX TSX0  ! X66_AUTO_2
         2 000001   000006 000002                    ZERO    6,2

     1905        7    1   DCL IN_REC UBIN;
     1906        8    1   DCL OUT_INDX UBIN;
     1907        9    1   DCL I UBIN AUTO;
     1908       10        /**/
     1909       11        %INCLUDE ZI$TOP_STRUCTS;
     1910       72        %D_DESC;
     1911       81        %TBL_DIM_DESC;
     1912       86        /**/
     1913       87    1       OUT_INDX=0;

     87  2 000002   200004 470500                    LDP0    @OUT_INDX,,AUTO
         2 000003   000000 450100                    STZ     0,,PR0

     1914       88    1       I=0;

     88  2 000004   200005 450100                    STZ     I,,AUTO

     1915       89    2       DO WHILE (I<TBL_DIM);

     89  2 000005   200005 236100                    LDQ     I,,AUTO
         2 000006   000000 116000 1                  CMPQ    TBL_DIM
         2 000007   000033 603000 2                  TRC     s:97

     1916       90    2           IF IN_REC=D_TABLE.REC_NO(I) THEN

     90  2 000010   200003 470500                    LDP0    @IN_REC,,AUTO
PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:285  
         2 000011   200005 235100                    LDA     I,,AUTO
         2 000012   000002 735000                    ALS     2
         2 000013   000000 471400 0                  LDP1    D_TBL$
         2 000014   100000 236105                    LDQ     0,AL,PR1
         2 000015   000022 772000                    QRL     18
         2 000016   000000 116100                    CMPQ    0,,PR0
         2 000017   000025 601000 2                  TNZ     s:95

     1917       91    3           DO;

     1918       92    3               OUT_INDX=I;

     92  2 000020   200004 473500                    LDP3    @OUT_INDX,,AUTO
         2 000021   200005 235100                    LDA     I,,AUTO
         2 000022   300000 755100                    STA     0,,PR3

     1919       93    3               I=TBL_DIM;

     93  2 000023   000000 236000 1                  LDQ     TBL_DIM
         2 000024   200005 756100                    STQ     I,,AUTO

     1920       94    3               END;

     1921       95    2           I=I+1;

     95  2 000025   200005 235100                    LDA     I,,AUTO
         2 000026   000001 035007                    ADLA    1,DL
         2 000027   200005 755100                    STA     I,,AUTO

     1922       96    2           END;

     96  2 000030   200005 236100                    LDQ     I,,AUTO
         2 000031   000000 116000 1                  CMPQ    TBL_DIM
         2 000032   000010 602000 2                  TNC     s:90

     1923       97    1       RETURN;

PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:286  
     97  2 000033   000000 702200 xent               TSX2  ! X66_ARET
     1924       98    1   END ZII$FIND_IDX;
     1925       99        %EOD;

PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:287  
--  Include file information  --

   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FIND_IDX.

   Procedure ZII$FIND_IDX requires 28 words for executable code.
   Procedure ZII$FIND_IDX requires 6 words of local(AUTO) storage.
PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:288  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ZII$FIND_IDX File=ZII$TOP_LIB.:ZIC0TSI                        FRI 09/05/97 12:33 Page:289  
          MINI XREF LISTING

D_TABLE.REC_NO
        75**DCL        90>>IF
D_TBL$
        73**DCL        74--IMP-PTR    90>>IF
I
         9**DCL        88<<ASSIGN     89>>DOWHILE    90>>IF         92>>ASSIGN     93<<ASSIGN     95<<ASSIGN
        95>>ASSIGN
IN_REC
         7**DCL         6--PROC       90>>IF
OUT_INDX
         8**DCL         6--PROC       87<<ASSIGN     92<<ASSIGN
TBL_DIM
        82**DCL        89>>DOWHILE    93>>ASSIGN

PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:290  
     1926        1        /*T***********************************************************/
     1927        2        /*T*                                                         */
     1928        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1929        4        /*T*                                                         */
     1930        5        /*T***********************************************************/
     1931        6        ZII$FIND_D2_IDX: PROC (X,Y,OUT_IDX);
     1932        7    1   DCL X UBIN;
     1933        8    1   DCL Y UBIN;
     1934        9    1   DCL OUT_IDX UBIN;
     1935       10    1   DCL M UBIN AUTO;
     1936       11    1   DCL N UBIN AUTO;
     1937       12        /**/
     1938       13        %INCLUDE ZI$TOP_STRUCTS;
     1939       74        %D2_DESC;
     1940       81        /**/
     1941       82    1   DCL ZII$FIND_IDX ENTRY(2);
     1942       83        /**/
     1943       84    1       CALL ZII$FIND_IDX(X,N);
     1944       85    1       CALL ZII$FIND_IDX(Y,M);
     1945       86    1       OUT_IDX=0;
     1946       87    1       IF N>M THEN
     1947       88    1           OUT_IDX=(((N*N)+N)-((2*N)-(2*M)))/2;
     1948       89    1       ELSE
     1949       90    1           OUT_IDX=(((M*M)+M)-((2*M)-(2*N)))/2;
     1950       91    1       RETURN;
     1951       92    1   END ZII$FIND_D2_IDX;
     1952       93        %EOD;

PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:291  
--  Include file information  --

   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FIND_D2_IDX.

   Procedure ZII$FIND_D2_IDX requires 48 words for executable code.
   Procedure ZII$FIND_D2_IDX requires 10 words of local(AUTO) storage.

PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:292  

 Object Unit name= ZII$FIND_D2_IDX                            File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:33:39.60 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  D2_TBL$
    1   Proc  even  none    48     60  ZII$FIND_D2_IDX
    2  RoData even  none     2      2  ZII$FIND_D2_IDX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  ZII$FIND_D2_IDX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 ZII$FIND_IDX
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:293  


     1926        1        /*T***********************************************************/
     1927        2        /*T*                                                         */
     1928        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1929        4        /*T*                                                         */
     1930        5        /*T***********************************************************/
     1931        6        ZII$FIND_D2_IDX: PROC (X,Y,OUT_IDX);

      6  1 000000   000000 700200 xent  ZII$FIND_D2* TSX0  ! X66_AUTO_3
         1 000001   000012 000003                    ZERO    10,3

     1932        7    1   DCL X UBIN;
     1933        8    1   DCL Y UBIN;
     1934        9    1   DCL OUT_IDX UBIN;
     1935       10    1   DCL M UBIN AUTO;
     1936       11    1   DCL N UBIN AUTO;
     1937       12        /**/
     1938       13        %INCLUDE ZI$TOP_STRUCTS;
     1939       74        %D2_DESC;
     1940       81        /**/
     1941       82    1   DCL ZII$FIND_IDX ENTRY(2);
     1942       83        /**/
     1943       84    1       CALL ZII$FIND_IDX(X,N);

     84  1 000002   200007 630500                    EPPR0   N,,AUTO
         1 000003   200011 450500                    STP0    N+2,,AUTO
         1 000004   200003 236100                    LDQ     @X,,AUTO
         1 000005   200010 756100                    STQ     N+1,,AUTO
         1 000006   200010 630500                    EPPR0   N+1,,AUTO
         1 000007   000000 631400 2                  EPPR1   0
         1 000010   000000 701000 xent               TSX1    ZII$FIND_IDX
         1 000011   000000 011000                    NOP     0

     1944       85    1       CALL ZII$FIND_IDX(Y,M);

     85  1 000012   200006 630500                    EPPR0   M,,AUTO
         1 000013   200011 450500                    STP0    N+2,,AUTO
PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:294  
         1 000014   200004 236100                    LDQ     @Y,,AUTO
         1 000015   200010 756100                    STQ     N+1,,AUTO
         1 000016   200010 630500                    EPPR0   N+1,,AUTO
         1 000017   000000 631400 2                  EPPR1   0
         1 000020   000000 701000 xent               TSX1    ZII$FIND_IDX
         1 000021   000000 011000                    NOP     0

     1945       86    1       OUT_IDX=0;

     86  1 000022   200005 470500                    LDP0    @OUT_IDX,,AUTO
         1 000023   000000 450100                    STZ     0,,PR0

     1946       87    1       IF N>M THEN

     87  1 000024   200006 236100                    LDQ     M,,AUTO
         1 000025   200007 116100                    CMPQ    N,,AUTO
         1 000026   000044 603000 1                  TRC     s:90

     1947       88    1           OUT_IDX=(((N*N)+N)-((2*N)-(2*M)))/2;

     88  1 000027   200007 236100                    LDQ     N,,AUTO
         1 000030   200007 402100                    MPY     N,,AUTO
         1 000031   200007 036100                    ADLQ    N,,AUTO
         1 000032   200010 756100                    STQ     N+1,,AUTO
         1 000033   200007 236100                    LDQ     N,,AUTO
         1 000034   200006 136100                    SBLQ    M,,AUTO
         1 000035   000001 736000                    QLS     1
         1 000036   000001 676000 2                  ERQ     1
         1 000037   000001 036007                    ADLQ    1,DL
         1 000040   200010 036100                    ADLQ    N+1,,AUTO
         1 000041   000002 506007                    DIV     2,DL
         1 000042   000000 756100                    STQ     0,,PR0
         1 000043   000057 710000 1                  TRA     s:91

     1948       89    1       ELSE
     1949       90    1           OUT_IDX=(((M*M)+M)-((2*M)-(2*N)))/2;

PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:295  
     90  1 000044   200006 402100                    MPY     M,,AUTO
         1 000045   200006 036100                    ADLQ    M,,AUTO
         1 000046   200010 756100                    STQ     N+1,,AUTO
         1 000047   200006 236100                    LDQ     M,,AUTO
         1 000050   200007 136100                    SBLQ    N,,AUTO
         1 000051   000001 736000                    QLS     1
         1 000052   000001 676000 2                  ERQ     1
         1 000053   000001 036007                    ADLQ    1,DL
         1 000054   200010 036100                    ADLQ    N+1,,AUTO
         1 000055   000002 506007                    DIV     2,DL
         1 000056   000000 756100                    STQ     0,,PR0

     1950       91    1       RETURN;

     91  1 000057   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000002 000000   777777 777777                                    ........
     1951       92    1   END ZII$FIND_D2_IDX;
     1952       93        %EOD;

PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:296  
--  Include file information  --

   ZI$TOP_STRUCTS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZII$FIND_D2_IDX.

   Procedure ZII$FIND_D2_IDX requires 48 words for executable code.
   Procedure ZII$FIND_D2_IDX requires 10 words of local(AUTO) storage.
PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:297  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ZII$FIND_D2_IDX File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:298  
          MINI XREF LISTING

D2_TBL$
        75**DCL        76--IMP-PTR
M
        10**DCL        85<>CALL       87>>IF         88>>ASSIGN     90>>ASSIGN     90>>ASSIGN     90>>ASSIGN
        90>>ASSIGN
N
        11**DCL        84<>CALL       87>>IF         88>>ASSIGN     88>>ASSIGN     88>>ASSIGN     88>>ASSIGN
        90>>ASSIGN
OUT_IDX
         9**DCL         6--PROC       86<<ASSIGN     88<<ASSIGN     90<<ASSIGN
X
         7**DCL         6--PROC       84<>CALL
Y
         8**DCL         6--PROC       85<>CALL
ZII$FIND_IDX
        82**DCL-ENT    84--CALL       85--CALL

PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:299  
     1953        1        /*T***********************************************************/
     1954        2        /*T*                                                         */
     1955        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1956        4        /*T*                                                         */
     1957        5        /*T***********************************************************/
     1958        6        ZII$PATH_MEMORY: PROC (PATH_SLOTS_NEEDED,MODE) ALTRET;
     1959        7    1   DCL PATH_SLOTS_NEEDED UBIN;
     1960        8    1   DCL NUM_WORDS UBIN AUTO;
     1961        9    1   DCL MODE UBIN;
     1962       10    1   DCL MEMORY_FRAME UBIN(36) EXT;
     1963       11        %EQU GET = 1;
     1964       12        %EQU RLSE = 0;
     1965       13        /**/
     1966       14    1   DCL ZII$COMMON_MEMORY ENTRY(2) ALTRET;
     1967       15        /**/
     1968       16        %INCLUDE CP_6;
     1969       97        %FPT_FDS(FPTN=FDS_FPT,COMMON=YES,RESULTS=RESULTS_VECTOR);
     1970      112        %INCLUDE ZI$PATH_STRUCTS;
     1971      250        %PATH_DESC (STCLASS="STATIC");
     1972      290        %VLP_VECTOR (FPTN=RESULTSE);
     1973      305        %VLP_VECTOR(FPTN=RESULTS_VECTOR);
     1974      320        /**/
     1975      321    1       NUM_WORDS = LENGTHW(PATH_LIST(0))*PATH_SLOTS_NEEDED;
     1976      322    1       IF ADDR(MODE) = ADDR(NIL) OR MODE = %GET THEN
     1977      323    2       DO;
     1978      324    2           CALL ZII$COMMON_MEMORY(NUM_WORDS,RESULTSE) ALTRET(ER_COMMON);
     1979      325    2           RETURN;
     1980      326    2   ER_COMMON:;
     1981      327    2           ALTRETURN;
     1982      328    2           END;
     1983      329    2       ELSE DO; /* MODE = %RLSE */
     1984      330    2           FDS_FPT.V.SEGSIZE# = NUM_WORDS;
     1985      331    2           CALL M$FDS(FDS_FPT);
     1986      332    2           RESULTSE = RESULTS_VECTOR;
     1987      333    2           MEMORY_FRAME = MEMORY_FRAME - NUM_WORDS;
     1988      334    2           END;
     1989      335    1   END ZII$PATH_MEMORY;
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:300  
     1990      336        %EOD;

PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:301  
--  Include file information  --

   ZI$PATH_STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$PATH_MEMORY.

   Procedure ZII$PATH_MEMORY requires 34 words for executable code.
   Procedure ZII$PATH_MEMORY requires 8 words of local(AUTO) storage.

PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:302  

 Object Unit name= ZII$PATH_MEMORY                            File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:33:41.40 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  MEMORY_FRAME
    1   DCB   even  none     0      0  M$UC
    2   Data  even  none    16     20  ZII$PATH_MEMORY
    3   Proc  even  none    34     42  ZII$PATH_MEMORY
    4  RoData even  none     3      3  ZII$PATH_MEMORY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        2  ZII$PATH_MEMORY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 ZII$COMMON_MEMORY
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:303  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:304  


     1953        1        /*T***********************************************************/
     1954        2        /*T*                                                         */
     1955        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1956        4        /*T*                                                         */
     1957        5        /*T***********************************************************/
     1958        6        ZII$PATH_MEMORY: PROC (PATH_SLOTS_NEEDED,MODE) ALTRET;

      6  3 000000   000000 700200 xent  ZII$PATH_ME* TSX0  ! X66_AUTO_2
         3 000001   000010 000002                    ZERO    8,2

     1959        7    1   DCL PATH_SLOTS_NEEDED UBIN;
     1960        8    1   DCL NUM_WORDS UBIN AUTO;
     1961        9    1   DCL MODE UBIN;
     1962       10    1   DCL MEMORY_FRAME UBIN(36) EXT;
     1963       11        %EQU GET = 1;
     1964       12        %EQU RLSE = 0;
     1965       13        /**/
     1966       14    1   DCL ZII$COMMON_MEMORY ENTRY(2) ALTRET;
     1967       15        /**/
     1968       16        %INCLUDE CP_6;
     1969       97        %FPT_FDS(FPTN=FDS_FPT,COMMON=YES,RESULTS=RESULTS_VECTOR);
     1970      112        %INCLUDE ZI$PATH_STRUCTS;
     1971      250        %PATH_DESC (STCLASS="STATIC");
     1972      290        %VLP_VECTOR (FPTN=RESULTSE);
     1973      305        %VLP_VECTOR(FPTN=RESULTS_VECTOR);
     1974      320        /**/
     1975      321    1       NUM_WORDS = LENGTHW(PATH_LIST(0))*PATH_SLOTS_NEEDED;

    321  3 000002   200003 470500                    LDP0    @PATH_SLOTS_NEEDED,,AUTO
         3 000003   000000 236100                    LDQ     0,,PR0
         3 000004   000005 402007                    MPY     5,DL
         3 000005   200005 756100                    STQ     NUM_WORDS,,AUTO

     1976      322    1       IF ADDR(MODE) = ADDR(NIL) OR MODE = %GET THEN

    322  3 000006   200004 236100                    LDQ     @MODE,,AUTO
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:305  
         3 000007   000000 116000 4                  CMPQ    0
         3 000010   000015 600000 3                  TZE     s:324
         3 000011   200004 471500                    LDP1    @MODE,,AUTO
         3 000012   100000 235100                    LDA     0,,PR1
         3 000013   000001 115007                    CMPA    1,DL
         3 000014   000027 601000 3                  TNZ     s:330

     1977      323    2       DO;

     1978      324    2           CALL ZII$COMMON_MEMORY(NUM_WORDS,RESULTSE) ALTRET(ER_COMMON);

    324  3 000015   000002 236000 4                  LDQ     2
         3 000016   200007 756100                    STQ     NUM_WORDS+2,,AUTO
         3 000017   200005 631500                    EPPR1   NUM_WORDS,,AUTO
         3 000020   200006 451500                    STP1    NUM_WORDS+1,,AUTO
         3 000021   200006 630500                    EPPR0   NUM_WORDS+1,,AUTO
         3 000022   000001 631400 4                  EPPR1   1
         3 000023   000000 701000 xent               TSX1    ZII$COMMON_MEMORY
         3 000024   000026 702000 3                  TSX2    ER_COMMON

     1979      325    2           RETURN;

    325  3 000025   000000 702200 xent               TSX2  ! X66_ARET

    324  3 000026                       ER_COMMON    null
     1980      326    2   ER_COMMON:;
     1981      327    2           ALTRETURN;

    327  3 000026   000000 702200 xent               TSX2  ! X66_AALT

     1982      328    2           END;
     1983      329    2       ELSE DO; /* MODE = %RLSE */

     1984      330    2           FDS_FPT.V.SEGSIZE# = NUM_WORDS;

    330  3 000027   200005 720100                    LXL0    NUM_WORDS,,AUTO
         3 000030   000004 440000 2                  SXL0    FDS_FPT+4
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:306  

     1985      331    2           CALL M$FDS(FDS_FPT);

    331  3 000031   000000 630400 2                  EPPR0   FDS_FPT
         3 000032   030002 713400                    CLIMB   fds
         3 000033   400400 401760                    pmme    nvectors=2

     1986      332    2           RESULTSE = RESULTS_VECTOR;

    332  3 000034   000016 237000 2                  LDAQ    RESULTS_VECTOR
         3 000035   000014 757000 2                  STAQ    RESULTSE

     1987      333    2           MEMORY_FRAME = MEMORY_FRAME - NUM_WORDS;

    333  3 000036   000000 236000 0                  LDQ     MEMORY_FRAME
         3 000037   200005 136100                    SBLQ    NUM_WORDS,,AUTO
         3 000040   000000 756000 0                  STQ     MEMORY_FRAME

     1988      334    2           END;

     1989      335    1   END ZII$PATH_MEMORY;

    335  3 000041   000000 702200 xent               TSX2  ! X66_ARET

FDS_FPT
 Sect OctLoc
   2     000   000001 777640   000004 006000   000001 777640   000016 006000    ................
   2     004   200000 000000   ****** ******                                    ........

PATH_LIST
 Sect OctLoc
   2     006   ****** ******   ****** ******   ****** ******   ****** ******    ................

RESULTSE
 Sect OctLoc
   2     014   000000 177640   000000 006014                                    ........

PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:307  
RESULTS_VECTOR
 Sect OctLoc
   2     016   000000 177640   000000 006014                                    ........

(unnamed)
 Sect OctLoc
   4     000   000000 006014   000002 000000   000014 006000                    ............
     1990      336        %EOD;

PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:308  
--  Include file information  --

   ZI$PATH_STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$PATH_MEMORY.

   Procedure ZII$PATH_MEMORY requires 34 words for executable code.
   Procedure ZII$PATH_MEMORY requires 8 words of local(AUTO) storage.
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:309  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ZII$PATH_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                     FRI 09/05/97 12:33 Page:310  
          MINI XREF LISTING

ER_COMMON
       324**LABEL     324--CALLALT
FDS_FPT
       108**DCL       331<>CALL
FDS_FPT.V
       108**DCL       108--DCLINIT
FDS_FPT.V.SEGSIZE#
       110**DCL       330<<ASSIGN
M$FDS
        60**DCL-ENT   331--CALL
MEMORY_FRAME
        10**DCL       333<<ASSIGN    333>>ASSIGN
MODE
         9**DCL         6--PROC      322--IF        322>>IF
NUM_WORDS
         8**DCL       321<<ASSIGN    324<>CALL      330>>ASSIGN    333>>ASSIGN
PATH_LIST
       251**DCL       321--ASSIGN
PATH_SLOTS_NEEDED
         7**DCL         6--PROC      321>>ASSIGN
RESULTSE
       301**DCL       324<>CALL      332<<ASSIGN
RESULTSE.W2
       302**DCL       303--REDEF
RESULTS_VECTOR
       316**DCL       108--DCLINIT   332>>ASSIGN
RESULTS_VECTOR.W2
       317**DCL       318--REDEF
ZII$COMMON_MEMORY
        14**DCL-ENT   324--CALL

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:311  
     1991        1        /*T***********************************************************/
     1992        2        /*T*                                                         */
     1993        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1994        4        /*T*                                                         */
     1995        5        /*T***********************************************************/
     1996        6        ZII$PRINT_PATH: PROC(ACCESS_LIST,PATH_LIST,DISPLAY_LIST) ALTRET;
     1997        7
     1998        8        %INCLUDE CP_6;
     1999       89        %INCLUDE ZI$STRUCTS;
     2000      161        %INCLUDE ZI$PATH_STRUCTS;
     2001      299
     2002      300        %NAM1;
     2003      329        %PATH_DESC;
     2004      369        %ACCESS_DESC;
     2005      408        %DISPLAY_DESC;
     2006      419
     2007      420        %EQU TOP_HDR = 'BIDP Topology Analysis:';
     2008      421
     2009      422
     2010      423    1   DCL BUFFER CHAR(120) ALIGNED;
     2011      424    1   DCL BUFX UBIN;
     2012      425    1   DCL M$LO DCB;
     2013      426        %FPT_WRITE(
     2014      427         DCB=M$LO,
     2015      428         VFC=YES);
     2016      459        %MACRO MOVE_LIT(S=,O=BUFX,X=);
     2017      460            CALL INSERT(BUFFER,O,%LENGTHC(S),S);
     2018      461        %IF TEXTCHAR(O) = 'BUFX';
     2019      462            BUFX = BUFX + %LENGTHC(S) X;
     2020      463        %ENDIF;
     2021      464        %MEND;
     2022      465
     2023      466    1   DCL LX UBIN;
     2024      467    1   DCL
     2025      468    1    1 LEVEL(0:100) ALIGNED,
     2026      469    1    2 REC_NO UBIN HALF UNAL,
     2027      470    1    2 BRANCH UBIN HALF UNAL;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:312  
     2028      471
     2029      472    1   DCL PX UBIN;
     2030      473    1   DCL PN UBIN;
     2031      474    1   DCL REC_NO UBIN;
     2032      475    1   DCL SET_NO UBIN;
     2033      476    1   DCL X UBIN;
     2034      477         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:313  
     2035      478    1       BUFFER = 'A';
     2036      479    1       FPT_WRITE.BUF_ = VECTOR(SUBSTR(BUFFER,0,2));
     2037      480    1       CALL M$WRITE(FPT_WRITE);
     2038      481    1       CALL INSERT(BUFFER,0,%LENGTHC(TOP_HDR),%TOP_HDR);
     2039      482    1       FPT_WRITE.BUF_.BOUND = %LENGTHC(TOP_HDR) - 1;
     2040      483    1       CALL M$WRITE(FPT_WRITE);
     2041      484
     2042      485    1       PN = PATH_LIST.REC_NO(0);
     2043      486    1       REC_NO = PATH_LIST.REC_NO(1);
     2044      487    1       BUFX = 0;
     2045      488            %MOVE_LIT(S='B  Port is ');
     2046      494    1       CALL MOVE_NAM1(REC_NO);
     2047      495            %MOVE_LIT(S=' access is ');
     2048      501    2       DO CASE(ACCESS_LIST.PORT_TYPE);
     2049      502    2       CASE(%SERIAL_ACCESS);
     2050      503                %MOVE_LIT(S='SERIAL.');
     2051      509    2       CASE(%DIRECT_ACCESS);
     2052      510                %MOVE_LIT(S='DIRECT.');
     2053      516    2       CASE(%CALC_ACCESS);
     2054      517                %MOVE_LIT(S='CALC.');
     2055      523    2       CASE(%KEYED_ACCESS);
     2056      524                %MOVE_LIT(S='KEYED');
     2057      530    2           CALL INSERT(BUFFER,0,1,'A');
     2058      531    2           FPT_WRITE.BUF_.BOUND = BUFX - 1;
     2059      532    2           CALL M$WRITE(FPT_WRITE);
     2060      533    2           BUFX = 0;
     2061      534                %MOVE_LIT(S='B    via ');
     2062      540    2           X = ACCESS_LIST.PORT_KEY;
     2063      541    2           CALL MOVE_NAM1(X);
     2064      542                %MOVE_LIT(S='.');
     2065      548    2       CASE(ELSE);
     2066      549                %MOVE_LIT(S='? bad access mode ?');
     2067      555    2           END;
     2068      556
     2069      557    1       FPT_WRITE.BUF_.BOUND = BUFX - 1;
     2070      558    1       LX = 0;
     2071      559    1       PX = 1;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:314  
     2072      560    1       CALL TEST_BRANCH_AND_PRINT;
     2073      561
     2074      562    1       SET_NO = PATH_LIST.SET_NO(1);
     2075      563    2       DO PX = 2 TO PN;
     2076      564    2           REC_NO = PATH_LIST.REC_NO(PX);
     2077      565         /*
     2078      566            If the .REPEAT_IND is true, then this is the beginning of a
     2079      567            lambda branch (and not the first branch).  Pop the level stack,
     2080      568            possibly zero times and increment the branch number at the
     2081      569            appropriate level.
     2082      570         */
     2083      571    3           IF PATH_LIST.REPEAT_IND(PX) THEN DO;
     2084      572    3               SET_NO = PATH_LIST.SET_NO(PX);
     2085      573    4               DO WHILE(REC_NO ~= LEVEL.REC_NO(LX));
     2086      574    4                   IF LX > 0
     2087      575    4                   THEN LX = LX - 1;
     2088      576    4                   ELSE ALTRETURN; /* Path list is screwed. */
     2089      577    4                   END;
     2090      578    3               LEVEL.BRANCH(LX) = LEVEL.BRANCH(LX) + 1;
     2091      579    3               CALL PRINT_LAMBDA;
     2092      580    3               END;
     2093      581    3           ELSE DO;
     2094      582         /*
     2095      583            ELSE this is just a regular old node so print it (indented
     2096      584            properly of course).
     2097      585         */
     2098      586    3               BUFFER = 'A';
     2099      587    3               BUFX = LX * 2 + 2;
     2100      588    3               IF BUFX > 22 THEN BUFX = 22;
     2101      589                    %MOVE_LIT(S='Record is',X=+1);
     2102      595    3               CALL MOVE_NAM1(REC_NO);
     2103      596    3               FPT_WRITE.BUF_.BOUND = BUFX - 1;
     2104      597    3               CALL M$WRITE(FPT_WRITE);
     2105      598    3               BUFFER = 'A';
     2106      599    3               BUFX = LX * 2 + 4;
     2107      600    3               IF BUFX > 24 THEN BUFX = 24;
     2108      601                    %MOVE_LIT(S='as member of',X=+1);
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:315  
     2109      607    3               IF PATH_LIST.OWN_NEXT(PX-1) THEN
     2110      608    3                   CALL INSERT(BUFFER,BUFX-%LENGTHC('member of '),6,'owner ');
     2111      609    3               CALL MOVE_NAM1(SET_NO);
     2112      610    3               CALL GET_INDICATORS;
     2113      611    4               DO CASE(X);
     2114      612    4               CASE(0);
     2115      613                        %MOVE_LIT(S=' to complete path.');
     2116      619    4               CASE(1);
     2117      620                        %MOVE_LIT(S=' for constraint.');
     2118      626    4               CASE(2);
     2119      627                        %MOVE_LIT(S=' for display.');
     2120      633    4               CASE(3);
     2121      634                        %MOVE_LIT(S=' for display and constraint.');
     2122      640    4                   END;
     2123      641    3               FPT_WRITE.BUF_.BOUND = BUFX - 1;
     2124      642    3               SET_NO = PATH_LIST.SET_NO(PX);
     2125      643    4               IF SET_NO = 0 THEN DO;
     2126      644    4                   CALL INSERT(BUFFER,0,1,'B');
     2127      645    4                   CALL M$WRITE(FPT_WRITE);
     2128      646    4                   END;
     2129      647    3               ELSE
     2130      648    3                   CALL TEST_BRANCH_AND_PRINT;
     2131      649    3               END;
     2132      650    2           END;
     2133      651    1       RETURN;
     2134      652         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:316  
     2135      653
     2136      654    1   GET_INDICATORS: PROC;
     2137      655    3       DO X = 1 TO DISPLAY_LIST.REC_NO(0);
     2138      656    4           IF REC_NO = DISPLAY_LIST.REC_NO(X) THEN DO;
     2139      657    4               X = DISPLAY_LIST.IND.DISPLAY(X) * 2 +
     2140      658    4                  DISPLAY_LIST.IND.CONSTRAINT(X);
     2141      659    4               RETURN;
     2142      660    4               END;
     2143      661    3           END;
     2144      662    2       X = 0;
     2145      663    2   END;
     2146      664
     2147      665
     2148      666
     2149      667    1   TEST_BRANCH_AND_PRINT: PROC;
     2150      668    2   DCL I UBIN;
     2151      669
     2152      670    3       DO I = PX+1 TO PN;
     2153      671    4           IF PATH_LIST.REC_NO(I) = REC_NO THEN DO;
     2154      672    4               LX = LX + 1;
     2155      673    4               LEVEL.REC_NO(LX) = REC_NO;
     2156      674    4               LEVEL.BRANCH(LX) = 1;
     2157      675    4               CALL INSERT(BUFFER,0,1,'B');
     2158      676    4               CALL M$WRITE(FPT_WRITE);
     2159      677    4               CALL PRINT_LAMBDA;
     2160      678    4               RETURN;
     2161      679    4               END;
     2162      680    3           END;
     2163      681    2       CALL M$WRITE(FPT_WRITE);
     2164      682    2   END;
     2165      683         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:317  
     2166      684    1   PRINT_LAMBDA: PROC;
     2167      685    2   DCL BRANCH UBIN;
     2168      686
     2169      687    2       BUFFER = 'A';
     2170      688    2       BUFX = LX * 2;
     2171      689    2       IF BUFX > 20 THEN BUFX = 20;
     2172      690            %MOVE_LIT(S='<< Lambda level',X=+1);
     2173      696    2       CALL XDEC(LX);
     2174      697            %MOVE_LIT(S=' branch',X=+1);
     2175      703    2       BRANCH = LEVEL.BRANCH(LX);
     2176      704    2       CALL XDEC(BRANCH);
     2177      705            %MOVE_LIT(S=' >>');
     2178      711    2       FPT_WRITE.BUF_.BOUND = BUFX - 1;
     2179      712    2       CALL M$WRITE(FPT_WRITE);
     2180      713    2   END;
     2181      714         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:318  
     2182      715    1   XDEC: PROC(XBIN);
     2183      716    2   DCL XBIN SBIN;
     2184      717    2   DCL XCH CHAR(4) ALIGNED;
     2185      718
     2186      719    2       CALL BINCHAR(XCH,XBIN);
     2187      720    3       IF XBIN < 10 THEN DO;
     2188      721    3           CALL INSERT(BUFFER,BUFX,1,SUBSTR(XCH,3,1));
     2189      722    3           BUFX = BUFX + 1;
     2190      723    3           END;
     2191      724    3       ELSE IF XBIN < 100 THEN DO;
     2192      725    3               CALL INSERT(BUFFER,BUFX,2,SUBSTR(XCH,2,2));
     2193      726    3               BUFX = BUFX + 2;
     2194      727    3               END;
     2195      728    3           ELSE IF XBIN < 1000 THEN DO;
     2196      729    3                   CALL INSERT(BUFFER,BUFX,3,SUBSTR(XCH,1,3));
     2197      730    3                   BUFX = BUFX + 3;
     2198      731    3                   END;
     2199      732    3               ELSE DO;
     2200      733    3                   CALL INSERT(BUFFER,BUFX,4,SUBSTR(XCH,0,4));
     2201      734    3                   BUFX = BUFX + 4;
     2202      735    3                   END;
     2203      736    2   END;
     2204      737
     2205      738
     2206      739
     2207      740    1   MOVE_NAM1: PROC(N1X);
     2208      741    2   DCL N1X UBIN;
     2209      742    2   DCL CNT UBIN;
     2210      743    2       CNT = NAM1.NAME.CNT(N1X);
     2211      744    2       CALL INSERT(BUFFER,BUFX,CNT,
     2212      745    2          SUBSTR(NAM1.NAME.TEXT(N1X),0,CNT));
     2213      746    2       BUFX = BUFX + CNT;
     2214      747    2   END;
     2215      748
     2216      749    1   END; /* ZII$PRINT_PATH */
     2217      750        %EOD;

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:319  
--  Include file information  --

   ZI$PATH_STRUCTS.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$PRINT_PATH.

   Procedure ZII$PRINT_PATH requires 484 words for executable code.
   Procedure ZII$PRINT_PATH requires 154 words of local(AUTO) storage.

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:320  

 Object Unit name= ZII$PRINT_PATH                             File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:33:44.80 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none     1      1  NAM1$
    2  LblCom even  none     1      1  NAM1_SIZ
    3  LblCom even  none     1      1  NAM1_IDX
    4   DCB   even  none     0      0  M$LO
    5   Data  even  none    12     14  ZII$PRINT_PATH
    6  RoData even  UTS     63     77  ZII$PRINT_PATH
    7   Proc  even  none   484    744  ZII$PRINT_PATH
    8  RoData even  none     4      4  ZII$PRINT_PATH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes    yes     yes      Std        3  ZII$PRINT_PATH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:321  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LO

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:322  


     1991        1        /*T***********************************************************/
     1992        2        /*T*                                                         */
     1993        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1994        4        /*T*                                                         */
     1995        5        /*T***********************************************************/
     1996        6        ZII$PRINT_PATH: PROC(ACCESS_LIST,PATH_LIST,DISPLAY_LIST) ALTRET;

      6  7 000000   000000 700200 xent  ZII$PRINT_P* TSX0  ! X66_AUTO_3
         7 000001   000232 000003                    ZERO    154,3

     1997        7
     1998        8        %INCLUDE CP_6;
     1999       89        %INCLUDE ZI$STRUCTS;
     2000      161        %INCLUDE ZI$PATH_STRUCTS;
     2001      299
     2002      300        %NAM1;
     2003      329        %PATH_DESC;
     2004      369        %ACCESS_DESC;
     2005      408        %DISPLAY_DESC;
     2006      419
     2007      420        %EQU TOP_HDR = 'BIDP Topology Analysis:';
     2008      421
     2009      422
     2010      423    1   DCL BUFFER CHAR(120) ALIGNED;
     2011      424    1   DCL BUFX UBIN;
     2012      425    1   DCL M$LO DCB;
     2013      426        %FPT_WRITE(
     2014      427         DCB=M$LO,
     2015      428         VFC=YES);
     2016      459        %MACRO MOVE_LIT(S=,O=BUFX,X=);
     2017      460            CALL INSERT(BUFFER,O,%LENGTHC(S),S);
     2018      461        %IF TEXTCHAR(O) = 'BUFX';
     2019      462            BUFX = BUFX + %LENGTHC(S) X;
     2020      463        %ENDIF;
     2021      464        %MEND;
     2022      465
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:323  
     2023      466    1   DCL LX UBIN;
     2024      467    1   DCL
     2025      468    1    1 LEVEL(0:100) ALIGNED,
     2026      469    1    2 REC_NO UBIN HALF UNAL,
     2027      470    1    2 BRANCH UBIN HALF UNAL;
     2028      471
     2029      472    1   DCL PX UBIN;
     2030      473    1   DCL PN UBIN;
     2031      474    1   DCL REC_NO UBIN;
     2032      475    1   DCL SET_NO UBIN;
     2033      476    1   DCL X UBIN;
     2034      477         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:324  
     2035      478    1       BUFFER = 'A';

    478  7 000002   040100 100400                    MLR     fill='040'O
         7 000003   000000 000001 8                  ADSC9   0                        cn=0,n=1
         7 000004   200006 000170                    ADSC9   BUFFER,,AUTO             cn=0,n=120

     2036      479    1       FPT_WRITE.BUF_ = VECTOR(SUBSTR(BUFFER,0,2));

    479  7 000005   377640 235007                    LDA     130976,DL
         7 000006   200230 452500                    STP2    XCH+2,,AUTO
         7 000007   200230 236100                    LDQ     XCH+2,,AUTO
         7 000010   000006 036003                    ADLQ    6,DU
         7 000011   000004 757000 5                  STAQ    FPT_WRITE+4

     2037      480    1       CALL M$WRITE(FPT_WRITE);

    480  7 000012   000000 630400 5                  EPPR0   FPT_WRITE
         7 000013   040001 713400                    CLIMB   write
         7 000014   401400 401760                    pmme    nvectors=4

     2038      481    1       CALL INSERT(BUFFER,0,%LENGTHC(TOP_HDR),%TOP_HDR);

    481  7 000015   040100 100400                    MLR     fill='040'O
         7 000016   000000 000027 6                  ADSC9   0                        cn=0,n=23
         7 000017   200006 000027                    ADSC9   BUFFER,,AUTO             cn=0,n=23

     2039      482    1       FPT_WRITE.BUF_.BOUND = %LENGTHC(TOP_HDR) - 1;

    482  7 000020   000004 236000 5                  LDQ     FPT_WRITE+4
         7 000021   177777 376007                    ANQ     65535,DL
         7 000022   000001 276000 8                  ORQ     1
         7 000023   000004 756000 5                  STQ     FPT_WRITE+4

     2040      483    1       CALL M$WRITE(FPT_WRITE);

    483  7 000024   000000 630400 5                  EPPR0   FPT_WRITE
         7 000025   040001 713400                    CLIMB   write
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:325  
         7 000026   401400 401760                    pmme    nvectors=4

     2041      484
     2042      485    1       PN = PATH_LIST.REC_NO(0);

    485  7 000027   200004 470500                    LDP0    @PATH_LIST,,AUTO
         7 000030   000000 236100                    LDQ     0,,PR0
         7 000031   000022 772000                    QRL     18
         7 000032   200214 756100                    STQ     PN,,AUTO

     2043      486    1       REC_NO = PATH_LIST.REC_NO(1);

    486  7 000033   000005 236100                    LDQ     5,,PR0
         7 000034   000022 772000                    QRL     18
         7 000035   200215 756100                    STQ     REC_NO,,AUTO

     2044      487    1       BUFX = 0;

    487  7 000036   200044 450100                    STZ     BUFX,,AUTO

     2045      488            %MOVE_LIT(S='B  Port is ');

    489  7 000037   200044 235100                    LDA     BUFX,,AUTO
         7 000040   040105 100400                    MLR     fill='040'O
         7 000041   000006 000013 6                  ADSC9   6                        cn=0,n=11
         7 000042   200006 000013                    ADSC9   BUFFER,A,AUTO            cn=0,n=11

    491  7 000043   000013 035007                    ADLA    11,DL
         7 000044   200044 755100                    STA     BUFX,,AUTO

     2046      494    1       CALL MOVE_NAM1(REC_NO);

    494  7 000045   200215 631500                    EPPR1   REC_NO,,AUTO
         7 000046   200221 451500                    STP1    X+2,,AUTO
         7 000047   000717 701000 7                  TSX1    MOVE_NAM1
         7 000050   000000 011000                    NOP     0

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:326  
     2047      495            %MOVE_LIT(S=' access is ');

    496  7 000051   200044 235100                    LDA     BUFX,,AUTO
         7 000052   040105 100400                    MLR     fill='040'O
         7 000053   000011 000013 6                  ADSC9   9                        cn=0,n=11
         7 000054   200006 000013                    ADSC9   BUFFER,A,AUTO            cn=0,n=11

    498  7 000055   000013 035007                    ADLA    11,DL
         7 000056   200044 755100                    STA     BUFX,,AUTO

     2048      501    2       DO CASE(ACCESS_LIST.PORT_TYPE);

    501  7 000057   200003 470500                    LDP0    @ACCESS_LIST,,AUTO
         7 000060   000001 220100                    LDX0    1,,PR0
         7 000061   000005 100003                    CMPX0   5,DU
         7 000062   000064 602010 7                  TNC     s:501+5,X0
         7 000063   000161 710000 7                  TRA     s:550
         7 000064   000161 710000 7                  TRA     s:550
         7 000065   000071 710000 7                  TRA     s:504
         7 000066   000077 710000 7                  TRA     s:511
         7 000067   000113 710000 7                  TRA     s:525
         7 000070   000105 710000 7                  TRA     s:518

     2049      502    2       CASE(%SERIAL_ACCESS);

     2050      503                %MOVE_LIT(S='SERIAL.');

    504  7 000071   040105 100400                    MLR     fill='040'O
         7 000072   000014 000007 6                  ADSC9   12                       cn=0,n=7
         7 000073   200006 000007                    ADSC9   BUFFER,A,AUTO            cn=0,n=7

    506  7 000074   000007 035007                    ADLA    7,DL
         7 000075   200044 755100                    STA     BUFX,,AUTO
         7 000076   000166 710000 7                  TRA     s:557

     2051      509    2       CASE(%DIRECT_ACCESS);

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:327  
     2052      510                %MOVE_LIT(S='DIRECT.');

    511  7 000077   040105 100400                    MLR     fill='040'O
         7 000100   000016 000007 6                  ADSC9   14                       cn=0,n=7
         7 000101   200006 000007                    ADSC9   BUFFER,A,AUTO            cn=0,n=7

    513  7 000102   000007 035007                    ADLA    7,DL
         7 000103   200044 755100                    STA     BUFX,,AUTO
         7 000104   000166 710000 7                  TRA     s:557

     2053      516    2       CASE(%CALC_ACCESS);

     2054      517                %MOVE_LIT(S='CALC.');

    518  7 000105   040105 100400                    MLR     fill='040'O
         7 000106   000020 000005 6                  ADSC9   16                       cn=0,n=5
         7 000107   200006 000005                    ADSC9   BUFFER,A,AUTO            cn=0,n=5

    520  7 000110   000005 035007                    ADLA    5,DL
         7 000111   200044 755100                    STA     BUFX,,AUTO
         7 000112   000166 710000 7                  TRA     s:557

     2055      523    2       CASE(%KEYED_ACCESS);

     2056      524                %MOVE_LIT(S='KEYED');

    525  7 000113   040105 100400                    MLR     fill='040'O
         7 000114   000022 000005 6                  ADSC9   18                       cn=0,n=5
         7 000115   200006 000005                    ADSC9   BUFFER,A,AUTO            cn=0,n=5

    527  7 000116   000005 035007                    ADLA    5,DL
         7 000117   200044 755100                    STA     BUFX,,AUTO

     2057      530    2           CALL INSERT(BUFFER,0,1,'A');

    530  7 000120   101000 236003                    LDQ     33280,DU
         7 000121   200006 552140                    STBQ    BUFFER,'40'O,AUTO
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:328  

     2058      531    2           FPT_WRITE.BUF_.BOUND = BUFX - 1;

    531  7 000122   200044 236100                    LDQ     BUFX,,AUTO
         7 000123   000001 136007                    SBLQ    1,DL
         7 000124   000020 736000                    QLS     16
         7 000125   000004 676000 5                  ERQ     FPT_WRITE+4
         7 000126   000002 376000 8                  ANQ     2
         7 000127   000004 656000 5                  ERSQ    FPT_WRITE+4

     2059      532    2           CALL M$WRITE(FPT_WRITE);

    532  7 000130   000000 630400 5                  EPPR0   FPT_WRITE
         7 000131   040001 713400                    CLIMB   write
         7 000132   401400 401760                    pmme    nvectors=4

     2060      533    2           BUFX = 0;

    533  7 000133   200044 450100                    STZ     BUFX,,AUTO

     2061      534                %MOVE_LIT(S='B    via ');

    535  7 000134   200044 235100                    LDA     BUFX,,AUTO
         7 000135   040105 100400                    MLR     fill='040'O
         7 000136   000024 000011 6                  ADSC9   20                       cn=0,n=9
         7 000137   200006 000011                    ADSC9   BUFFER,A,AUTO            cn=0,n=9

    537  7 000140   000011 035007                    ADLA    9,DL
         7 000141   200044 755100                    STA     BUFX,,AUTO

     2062      540    2           X = ACCESS_LIST.PORT_KEY;

    540  7 000142   200003 470500                    LDP0    @ACCESS_LIST,,AUTO
         7 000143   000000 236100                    LDQ     0,,PR0
         7 000144   777777 376007                    ANQ     -1,DL
         7 000145   200217 756100                    STQ     X,,AUTO

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:329  
     2063      541    2           CALL MOVE_NAM1(X);

    541  7 000146   200217 631500                    EPPR1   X,,AUTO
         7 000147   200221 451500                    STP1    X+2,,AUTO
         7 000150   000717 701000 7                  TSX1    MOVE_NAM1
         7 000151   000000 011000                    NOP     0

     2064      542                %MOVE_LIT(S='.');

    543  7 000152   200044 235100                    LDA     BUFX,,AUTO
         7 000153   040105 100400                    MLR     fill='040'O
         7 000154   000003 000001 8                  ADSC9   3                        cn=0,n=1
         7 000155   200006 000001                    ADSC9   BUFFER,A,AUTO            cn=0,n=1

    545  7 000156   000001 035007                    ADLA    1,DL
         7 000157   200044 755100                    STA     BUFX,,AUTO
         7 000160   000166 710000 7                  TRA     s:557

     2065      548    2       CASE(ELSE);

     2066      549                %MOVE_LIT(S='? bad access mode ?');

    550  7 000161   040105 100400                    MLR     fill='040'O
         7 000162   000027 000023 6                  ADSC9   23                       cn=0,n=19
         7 000163   200006 000023                    ADSC9   BUFFER,A,AUTO            cn=0,n=19

    552  7 000164   000023 035007                    ADLA    19,DL
         7 000165   200044 755100                    STA     BUFX,,AUTO

     2067      555    2           END;

     2068      556
     2069      557    1       FPT_WRITE.BUF_.BOUND = BUFX - 1;

    557  7 000166   200044 236100                    LDQ     BUFX,,AUTO
         7 000167   000001 136007                    SBLQ    1,DL
         7 000170   000020 736000                    QLS     16
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:330  
         7 000171   000004 676000 5                  ERQ     FPT_WRITE+4
         7 000172   000002 376000 8                  ANQ     2
         7 000173   000004 656000 5                  ERSQ    FPT_WRITE+4

     2070      558    1       LX = 0;

    558  7 000174   200045 450100                    STZ     LX,,AUTO

     2071      559    1       PX = 1;

    559  7 000175   000001 236007                    LDQ     1,DL
         7 000176   200213 756100                    STQ     PX,,AUTO

     2072      560    1       CALL TEST_BRANCH_AND_PRINT;

    560  7 000177   000512 701000 7                  TSX1    TEST_BRANCH_AND_PRINT
         7 000200   000000 011000                    NOP     0

     2073      561
     2074      562    1       SET_NO = PATH_LIST.SET_NO(1);

    562  7 000201   200004 470500                    LDP0    @PATH_LIST,,AUTO
         7 000202   000005 236100                    LDQ     5,,PR0
         7 000203   777777 376007                    ANQ     -1,DL
         7 000204   200216 756100                    STQ     SET_NO,,AUTO

     2075      563    2       DO PX = 2 TO PN;

    563  7 000205   000002 235007                    LDA     2,DL
         7 000206   200213 755100                    STA     PX,,AUTO
         7 000207   000447 710000 7                  TRA     s:650+3

     2076      564    2           REC_NO = PATH_LIST.REC_NO(PX);

    564  7 000210   200213 236100                    LDQ     PX,,AUTO
         7 000211   000005 402007                    MPY     5,DL
         7 000212   200004 470500                    LDP0    @PATH_LIST,,AUTO
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:331  
         7 000213   000000 236106                    LDQ     0,QL,PR0
         7 000214   000022 772000                    QRL     18
         7 000215   200215 756100                    STQ     REC_NO,,AUTO

     2077      565         /*
     2078      566            If the .REPEAT_IND is true, then this is the beginning of a
     2079      567            lambda branch (and not the first branch).  Pop the level stack,
     2080      568            possibly zero times and increment the branch number at the
     2081      569            appropriate level.
     2082      570         */
     2083      571    3           IF PATH_LIST.REPEAT_IND(PX) THEN DO;

    571  7 000216   200213 236100                    LDQ     PX,,AUTO
         7 000217   000005 402007                    MPY     5,DL
         7 000220   000001 236106                    LDQ     1,QL,PR0
         7 000221   040000 316003                    CANQ    16384,DU
         7 000222   000256 600000 7                  TZE     s:586

     2084      572    3               SET_NO = PATH_LIST.SET_NO(PX);

    572  7 000223   200213 236100                    LDQ     PX,,AUTO
         7 000224   000005 402007                    MPY     5,DL
         7 000225   000000 236106                    LDQ     0,QL,PR0
         7 000226   777777 376007                    ANQ     -1,DL
         7 000227   200216 756100                    STQ     SET_NO,,AUTO

     2085      573    4               DO WHILE(REC_NO ~= LEVEL.REC_NO(LX));

    573  7 000230   200045 720100                    LXL0    LX,,AUTO
         7 000231   200046 236110                    LDQ     LEVEL,X0,AUTO
         7 000232   000022 772000                    QRL     18
         7 000233   200215 116100                    CMPQ    REC_NO,,AUTO
         7 000234   000247 600000 7                  TZE     s:578

     2086      574    4                   IF LX > 0

    574  7 000235   200045 235100                    LDA     LX,,AUTO
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:332  
         7 000236   000242 600000 7                  TZE     s:576

     2087      575    4                   THEN LX = LX - 1;

    575  7 000237   000001 135007                    SBLA    1,DL
         7 000240   200045 755100                    STA     LX,,AUTO
         7 000241   000243 710000 7                  TRA     s:577

     2088      576    4                   ELSE ALTRETURN; /* Path list is screwed. */

    576  7 000242   000000 702200 xent               TSX2  ! X66_AALT

     2089      577    4                   END;

    577  7 000243   200046 236105                    LDQ     LEVEL,AL,AUTO
         7 000244   000022 772000                    QRL     18
         7 000245   200215 116100                    CMPQ    REC_NO,,AUTO
         7 000246   000235 601000 7                  TNZ     s:574

     2090      578    3               LEVEL.BRANCH(LX) = LEVEL.BRANCH(LX) + 1;

    578  7 000247   200045 720100                    LXL0    LX,,AUTO
         7 000250   200046 721110                    LXL1    LEVEL,X0,AUTO
         7 000251   000001 622011                    EAX2    1,X1
         7 000252   200046 442110                    SXL2    LEVEL,X0,AUTO

     2091      579    3               CALL PRINT_LAMBDA;

    579  7 000253   000562 701000 7                  TSX1    PRINT_LAMBDA
         7 000254   000000 011000                    NOP     0

     2092      580    3               END;

    580  7 000255   000444 710000 7                  TRA     s:650

     2093      581    3           ELSE DO;

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:333  
     2094      582         /*
     2095      583            ELSE this is just a regular old node so print it (indented
     2096      584            properly of course).
     2097      585         */
     2098      586    3               BUFFER = 'A';

    586  7 000256   040100 100400                    MLR     fill='040'O
         7 000257   000000 000001 8                  ADSC9   0                        cn=0,n=1
         7 000260   200006 000170                    ADSC9   BUFFER,,AUTO             cn=0,n=120

     2099      587    3               BUFX = LX * 2 + 2;

    587  7 000261   200045 235100                    LDA     LX,,AUTO
         7 000262   000001 735000                    ALS     1
         7 000263   000002 035007                    ADLA    2,DL
         7 000264   200044 755100                    STA     BUFX,,AUTO

     2100      588    3               IF BUFX > 22 THEN BUFX = 22;

    588  7 000265   000027 115007                    CMPA    23,DL
         7 000266   000271 602000 7                  TNC     s:590

    588  7 000267   000026 236007                    LDQ     22,DL
         7 000270   200044 756100                    STQ     BUFX,,AUTO

     2101      589                    %MOVE_LIT(S='Record is',X=+1);

    590  7 000271   200044 236100                    LDQ     BUFX,,AUTO
         7 000272   040106 100400                    MLR     fill='040'O
         7 000273   000034 000011 6                  ADSC9   28                       cn=0,n=9
         7 000274   200006 000011                    ADSC9   BUFFER,Q,AUTO            cn=0,n=9

    592  7 000275   000012 036007                    ADLQ    10,DL
         7 000276   200044 756100                    STQ     BUFX,,AUTO

     2102      595    3               CALL MOVE_NAM1(REC_NO);

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:334  
    595  7 000277   200215 631500                    EPPR1   REC_NO,,AUTO
         7 000300   200221 451500                    STP1    X+2,,AUTO
         7 000301   000717 701000 7                  TSX1    MOVE_NAM1
         7 000302   000000 011000                    NOP     0

     2103      596    3               FPT_WRITE.BUF_.BOUND = BUFX - 1;

    596  7 000303   200044 236100                    LDQ     BUFX,,AUTO
         7 000304   000001 136007                    SBLQ    1,DL
         7 000305   000020 736000                    QLS     16
         7 000306   000004 676000 5                  ERQ     FPT_WRITE+4
         7 000307   000002 376000 8                  ANQ     2
         7 000310   000004 656000 5                  ERSQ    FPT_WRITE+4

     2104      597    3               CALL M$WRITE(FPT_WRITE);

    597  7 000311   000000 630400 5                  EPPR0   FPT_WRITE
         7 000312   040001 713400                    CLIMB   write
         7 000313   401400 401760                    pmme    nvectors=4

     2105      598    3               BUFFER = 'A';

    598  7 000314   040100 100400                    MLR     fill='040'O
         7 000315   000000 000001 8                  ADSC9   0                        cn=0,n=1
         7 000316   200006 000170                    ADSC9   BUFFER,,AUTO             cn=0,n=120

     2106      599    3               BUFX = LX * 2 + 4;

    599  7 000317   200045 235100                    LDA     LX,,AUTO
         7 000320   000001 735000                    ALS     1
         7 000321   000004 035007                    ADLA    4,DL
         7 000322   200044 755100                    STA     BUFX,,AUTO

     2107      600    3               IF BUFX > 24 THEN BUFX = 24;

    600  7 000323   000031 115007                    CMPA    25,DL
         7 000324   000327 602000 7                  TNC     s:602
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:335  

    600  7 000325   000030 236007                    LDQ     24,DL
         7 000326   200044 756100                    STQ     BUFX,,AUTO

     2108      601                    %MOVE_LIT(S='as member of',X=+1);

    602  7 000327   200044 236100                    LDQ     BUFX,,AUTO
         7 000330   040106 100400                    MLR     fill='040'O
         7 000331   000037 000014 6                  ADSC9   31                       cn=0,n=12
         7 000332   200006 000014                    ADSC9   BUFFER,Q,AUTO            cn=0,n=12

    604  7 000333   000015 036007                    ADLQ    13,DL
         7 000334   200044 756100                    STQ     BUFX,,AUTO

     2109      607    3               IF PATH_LIST.OWN_NEXT(PX-1) THEN

    607  7 000335   200213 236100                    LDQ     PX,,AUTO
         7 000336   000005 402007                    MPY     5,DL
         7 000337   200004 470500                    LDP0    @PATH_LIST,,AUTO
         7 000340   077774 234106                    SZN     -4,QL,PR0
         7 000341   000346 605000 7                  TPL     s:609

     2110      608    3                   CALL INSERT(BUFFER,BUFX-%LENGTHC('member of '),6,'owner ');

    608  7 000342   200044 235100                    LDA     BUFX,,AUTO
         7 000343   040105 100400                    MLR     fill='040'O
         7 000344   000042 000006 6                  ADSC9   34                       cn=0,n=6
         7 000345   200003 400006                    ADSC9   @ACCESS_LIST,A,AUTO      cn=2,n=6

     2111      609    3               CALL MOVE_NAM1(SET_NO);

    609  7 000346   200216 631500                    EPPR1   SET_NO,,AUTO
         7 000347   200221 451500                    STP1    X+2,,AUTO
         7 000350   000717 701000 7                  TSX1    MOVE_NAM1
         7 000351   000000 011000                    NOP     0

     2112      610    3               CALL GET_INDICATORS;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:336  

    610  7 000352   000453 701000 7                  TSX1    GET_INDICATORS
         7 000353   000000 011000                    NOP     0

     2113      611    4               DO CASE(X);

    611  7 000354   200217 235100                    LDA     X,,AUTO
         7 000355   000004 115007                    CMPA    4,DL
         7 000356   000360 602005 7                  TNC     s:611+4,AL
         7 000357   000417 710000 7                  TRA     s:641
         7 000360   000364 710000 7                  TRA     s:614
         7 000361   000373 710000 7                  TRA     s:621
         7 000362   000402 710000 7                  TRA     s:628
         7 000363   000411 710000 7                  TRA     s:635

     2114      612    4               CASE(0);

     2115      613                        %MOVE_LIT(S=' to complete path.');

    614  7 000364   200044 236100                    LDQ     BUFX,,AUTO
         7 000365   040106 100400                    MLR     fill='040'O
         7 000366   000044 000022 6                  ADSC9   36                       cn=0,n=18
         7 000367   200006 000022                    ADSC9   BUFFER,Q,AUTO            cn=0,n=18

    616  7 000370   000022 036007                    ADLQ    18,DL
         7 000371   200044 756100                    STQ     BUFX,,AUTO
         7 000372   000417 710000 7                  TRA     s:641

     2116      619    4               CASE(1);

     2117      620                        %MOVE_LIT(S=' for constraint.');

    621  7 000373   200044 236100                    LDQ     BUFX,,AUTO
         7 000374   040106 100400                    MLR     fill='040'O
         7 000375   000051 000020 6                  ADSC9   41                       cn=0,n=16
         7 000376   200006 000020                    ADSC9   BUFFER,Q,AUTO            cn=0,n=16

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:337  
    623  7 000377   000020 036007                    ADLQ    16,DL
         7 000400   200044 756100                    STQ     BUFX,,AUTO
         7 000401   000417 710000 7                  TRA     s:641

     2118      626    4               CASE(2);

     2119      627                        %MOVE_LIT(S=' for display.');

    628  7 000402   200044 236100                    LDQ     BUFX,,AUTO
         7 000403   040106 100400                    MLR     fill='040'O
         7 000404   000055 000015 6                  ADSC9   45                       cn=0,n=13
         7 000405   200006 000015                    ADSC9   BUFFER,Q,AUTO            cn=0,n=13

    630  7 000406   000015 036007                    ADLQ    13,DL
         7 000407   200044 756100                    STQ     BUFX,,AUTO
         7 000410   000417 710000 7                  TRA     s:641

     2120      633    4               CASE(3);

     2121      634                        %MOVE_LIT(S=' for display and constraint.');

    635  7 000411   200044 236100                    LDQ     BUFX,,AUTO
         7 000412   040106 100400                    MLR     fill='040'O
         7 000413   000061 000034 6                  ADSC9   49                       cn=0,n=28
         7 000414   200006 000034                    ADSC9   BUFFER,Q,AUTO            cn=0,n=28

    637  7 000415   000034 036007                    ADLQ    28,DL
         7 000416   200044 756100                    STQ     BUFX,,AUTO

     2122      640    4                   END;

     2123      641    3               FPT_WRITE.BUF_.BOUND = BUFX - 1;

    641  7 000417   200044 236100                    LDQ     BUFX,,AUTO
         7 000420   000001 136007                    SBLQ    1,DL
         7 000421   000020 736000                    QLS     16
         7 000422   000004 676000 5                  ERQ     FPT_WRITE+4
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:338  
         7 000423   000002 376000 8                  ANQ     2
         7 000424   000004 656000 5                  ERSQ    FPT_WRITE+4

     2124      642    3               SET_NO = PATH_LIST.SET_NO(PX);

    642  7 000425   200213 236100                    LDQ     PX,,AUTO
         7 000426   000005 402007                    MPY     5,DL
         7 000427   200004 470500                    LDP0    @PATH_LIST,,AUTO
         7 000430   000000 236106                    LDQ     0,QL,PR0
         7 000431   777777 376007                    ANQ     -1,DL
         7 000432   200216 756100                    STQ     SET_NO,,AUTO

     2125      643    4               IF SET_NO = 0 THEN DO;

    643  7 000433   000442 601000 7                  TNZ     s:648

     2126      644    4                   CALL INSERT(BUFFER,0,1,'B');

    644  7 000434   102000 236003                    LDQ     33792,DU
         7 000435   200006 552140                    STBQ    BUFFER,'40'O,AUTO

     2127      645    4                   CALL M$WRITE(FPT_WRITE);

    645  7 000436   000000 630400 5                  EPPR0   FPT_WRITE
         7 000437   040001 713400                    CLIMB   write
         7 000440   401400 401760                    pmme    nvectors=4

     2128      646    4                   END;

    646  7 000441   000444 710000 7                  TRA     s:650

     2129      647    3               ELSE
     2130      648    3                   CALL TEST_BRANCH_AND_PRINT;

    648  7 000442   000512 701000 7                  TSX1    TEST_BRANCH_AND_PRINT
         7 000443   000000 011000                    NOP     0

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:339  
     2131      649    3               END;

     2132      650    2           END;

    650  7 000444   200213 235100                    LDA     PX,,AUTO
         7 000445   000001 035007                    ADLA    1,DL
         7 000446   200213 755100                    STA     PX,,AUTO
         7 000447   200214 236100                    LDQ     PN,,AUTO
         7 000450   200213 116100                    CMPQ    PX,,AUTO
         7 000451   000210 603000 7                  TRC     s:564

     2133      651    1       RETURN;

    651  7 000452   000000 702200 xent               TSX2  ! X66_ARET

     2134      652         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:340  
     2135      653
     2136      654    1   GET_INDICATORS: PROC;

    654  7 000453   200220 741300       GET_INDICAT* STX1  ! X+1,,AUTO

     2137      655    3       DO X = 1 TO DISPLAY_LIST.REC_NO(0);

    655  7 000454   000001 235007                    LDA     1,DL
         7 000455   200217 755100                    STA     X,,AUTO
         7 000456   000502 710000 7                  TRA     s:661+3

     2138      656    4           IF REC_NO = DISPLAY_LIST.REC_NO(X) THEN DO;

    656  7 000457   200005 470500                    LDP0    @DISPLAY_LIST,,AUTO
         7 000460   200217 720100                    LXL0    X,,AUTO
         7 000461   000000 236110                    LDQ     0,X0,PR0
         7 000462   777777 376007                    ANQ     -1,DL
         7 000463   200215 116100                    CMPQ    REC_NO,,AUTO
         7 000464   000477 601000 7                  TNZ     s:661

     2139      657    4               X = DISPLAY_LIST.IND.DISPLAY(X) * 2 +

    657  7 000465   000000 236110                    LDQ     0,X0,PR0
         7 000466   000033 772000                    QRL     27
         7 000467   200230 756100                    STQ     XCH+2,,AUTO
         7 000470   000000 236110                    LDQ     0,X0,PR0
         7 000471   000021 772000                    QRL     17
         7 000472   001776 376007                    ANQ     1022,DL
         7 000473   200230 036100                    ADLQ    XCH+2,,AUTO
         7 000474   200217 756100                    STQ     X,,AUTO

     2140      658    4                  DISPLAY_LIST.IND.CONSTRAINT(X);
     2141      659    4               RETURN;

    659  7 000475   200220 221300                    LDX1  ! X+1,,AUTO
         7 000476   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:341  
     2142      660    4               END;
     2143      661    3           END;

    661  7 000477   200217 235100                    LDA     X,,AUTO
         7 000500   000001 035007                    ADLA    1,DL
         7 000501   200217 755100                    STA     X,,AUTO
         7 000502   200005 470500                    LDP0    @DISPLAY_LIST,,AUTO
         7 000503   000000 236100                    LDQ     0,,PR0
         7 000504   777777 376007                    ANQ     -1,DL
         7 000505   200217 116100                    CMPQ    X,,AUTO
         7 000506   000457 603000 7                  TRC     s:656

     2144      662    2       X = 0;

    662  7 000507   200217 450100                    STZ     X,,AUTO

     2145      663    2   END;

    663  7 000510   200220 221300                    LDX1  ! X+1,,AUTO
         7 000511   000001 702211                    TSX2  ! 1,X1

     2146      664
     2147      665
     2148      666
     2149      667    1   TEST_BRANCH_AND_PRINT: PROC;

    667  7 000512   200220 741300       TEST_BRANCH* STX1  ! X+1,,AUTO

     2150      668    2   DCL I UBIN;
     2151      669
     2152      670    3       DO I = PX+1 TO PN;

    670  7 000513   200213 235100                    LDA     PX,,AUTO
         7 000514   000001 035007                    ADLA    1,DL
         7 000515   200221 755100                    STA     I,,AUTO
         7 000516   000552 710000 7                  TRA     s:680+3

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:342  
     2153      671    4           IF PATH_LIST.REC_NO(I) = REC_NO THEN DO;

    671  7 000517   200221 236100                    LDQ     I,,AUTO
         7 000520   000005 402007                    MPY     5,DL
         7 000521   200004 470500                    LDP0    @PATH_LIST,,AUTO
         7 000522   000000 236106                    LDQ     0,QL,PR0
         7 000523   000022 772000                    QRL     18
         7 000524   200215 116100                    CMPQ    REC_NO,,AUTO
         7 000525   000547 601000 7                  TNZ     s:680

     2154      672    4               LX = LX + 1;

    672  7 000526   200045 235100                    LDA     LX,,AUTO
         7 000527   000001 035007                    ADLA    1,DL
         7 000530   200045 755100                    STA     LX,,AUTO

     2155      673    4               LEVEL.REC_NO(LX) = REC_NO;

    673  7 000531   200215 720100                    LXL0    REC_NO,,AUTO
         7 000532   200046 740105                    STX0    LEVEL,AL,AUTO

     2156      674    4               LEVEL.BRANCH(LX) = 1;

    674  7 000533   000001 221003                    LDX1    1,DU
         7 000534   200045 722100                    LXL2    LX,,AUTO
         7 000535   200046 441112                    SXL1    LEVEL,X2,AUTO

     2157      675    4               CALL INSERT(BUFFER,0,1,'B');

    675  7 000536   102000 236003                    LDQ     33792,DU
         7 000537   200006 552140                    STBQ    BUFFER,'40'O,AUTO

     2158      676    4               CALL M$WRITE(FPT_WRITE);

    676  7 000540   000000 630400 5                  EPPR0   FPT_WRITE
         7 000541   040001 713400                    CLIMB   write
         7 000542   401400 401760                    pmme    nvectors=4
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:343  

     2159      677    4               CALL PRINT_LAMBDA;

    677  7 000543   000562 701000 7                  TSX1    PRINT_LAMBDA
         7 000544   000000 011000                    NOP     0

     2160      678    4               RETURN;

    678  7 000545   200220 221300                    LDX1  ! X+1,,AUTO
         7 000546   000001 702211                    TSX2  ! 1,X1

     2161      679    4               END;
     2162      680    3           END;

    680  7 000547   200221 235100                    LDA     I,,AUTO
         7 000550   000001 035007                    ADLA    1,DL
         7 000551   200221 755100                    STA     I,,AUTO
         7 000552   200214 236100                    LDQ     PN,,AUTO
         7 000553   200221 116100                    CMPQ    I,,AUTO
         7 000554   000517 603000 7                  TRC     s:671

     2163      681    2       CALL M$WRITE(FPT_WRITE);

    681  7 000555   000000 630400 5                  EPPR0   FPT_WRITE
         7 000556   040001 713400                    CLIMB   write
         7 000557   401400 401760                    pmme    nvectors=4

     2164      682    2   END;

    682  7 000560   200220 221300                    LDX1  ! X+1,,AUTO
         7 000561   000001 702211                    TSX2  ! 1,X1

     2165      683         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:344  
     2166      684    1   PRINT_LAMBDA: PROC;

    684  7 000562   200222 741300       PRINT_LAMBDA STX1  ! @N1X+1,,AUTO

     2167      685    2   DCL BRANCH UBIN;
     2168      686
     2169      687    2       BUFFER = 'A';

    687  7 000563   040100 100400                    MLR     fill='040'O
         7 000564   000000 000001 8                  ADSC9   0                        cn=0,n=1
         7 000565   200006 000170                    ADSC9   BUFFER,,AUTO             cn=0,n=120

     2170      688    2       BUFX = LX * 2;

    688  7 000566   200045 235100                    LDA     LX,,AUTO
         7 000567   000001 735000                    ALS     1
         7 000570   200044 755100                    STA     BUFX,,AUTO

     2171      689    2       IF BUFX > 20 THEN BUFX = 20;

    689  7 000571   000025 115007                    CMPA    21,DL
         7 000572   000575 602000 7                  TNC     s:691

    689  7 000573   000024 236007                    LDQ     20,DL
         7 000574   200044 756100                    STQ     BUFX,,AUTO

     2172      690            %MOVE_LIT(S='<< Lambda level',X=+1);

    691  7 000575   200044 236100                    LDQ     BUFX,,AUTO
         7 000576   040106 100400                    MLR     fill='040'O
         7 000577   000070 000017 6                  ADSC9   56                       cn=0,n=15
         7 000600   200006 000017                    ADSC9   BUFFER,Q,AUTO            cn=0,n=15

    693  7 000601   000020 036007                    ADLQ    16,DL
         7 000602   200044 756100                    STQ     BUFX,,AUTO

     2173      696    2       CALL XDEC(LX);
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:345  

    696  7 000603   200045 630500                    EPPR0   LX,,AUTO
         7 000604   200225 450500                    STP0    BRANCH+2,,AUTO
         7 000605   000646 701000 7                  TSX1    XDEC
         7 000606   000000 011000                    NOP     0

     2174      697            %MOVE_LIT(S=' branch',X=+1);

    698  7 000607   200044 235100                    LDA     BUFX,,AUTO
         7 000610   040105 100400                    MLR     fill='040'O
         7 000611   000074 000007 6                  ADSC9   60                       cn=0,n=7
         7 000612   200006 000007                    ADSC9   BUFFER,A,AUTO            cn=0,n=7

    700  7 000613   000010 035007                    ADLA    8,DL
         7 000614   200044 755100                    STA     BUFX,,AUTO

     2175      703    2       BRANCH = LEVEL.BRANCH(LX);

    703  7 000615   200045 720100                    LXL0    LX,,AUTO
         7 000616   200046 236110                    LDQ     LEVEL,X0,AUTO
         7 000617   777777 376007                    ANQ     -1,DL
         7 000620   200223 756100                    STQ     BRANCH,,AUTO

     2176      704    2       CALL XDEC(BRANCH);

    704  7 000621   200223 630500                    EPPR0   BRANCH,,AUTO
         7 000622   200225 450500                    STP0    BRANCH+2,,AUTO
         7 000623   000646 701000 7                  TSX1    XDEC
         7 000624   000000 011000                    NOP     0

     2177      705            %MOVE_LIT(S=' >>');

    706  7 000625   200044 235100                    LDA     BUFX,,AUTO
         7 000626   040105 100400                    MLR     fill='040'O
         7 000627   000076 000003 6                  ADSC9   62                       cn=0,n=3
         7 000630   200006 000003                    ADSC9   BUFFER,A,AUTO            cn=0,n=3

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:346  
    708  7 000631   000003 035007                    ADLA    3,DL
         7 000632   200044 755100                    STA     BUFX,,AUTO

     2178      711    2       FPT_WRITE.BUF_.BOUND = BUFX - 1;

    711  7 000633   200044 236100                    LDQ     BUFX,,AUTO
         7 000634   000001 136007                    SBLQ    1,DL
         7 000635   000020 736000                    QLS     16
         7 000636   000004 676000 5                  ERQ     FPT_WRITE+4
         7 000637   000002 376000 8                  ANQ     2
         7 000640   000004 656000 5                  ERSQ    FPT_WRITE+4

     2179      712    2       CALL M$WRITE(FPT_WRITE);

    712  7 000641   000000 630400 5                  EPPR0   FPT_WRITE
         7 000642   040001 713400                    CLIMB   write
         7 000643   401400 401760                    pmme    nvectors=4

     2180      713    2   END;

    713  7 000644   200222 221300                    LDX1  ! @N1X+1,,AUTO
         7 000645   000001 702211                    TSX2  ! 1,X1

     2181      714         %EJECT;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:347  
     2182      715    1   XDEC: PROC(XBIN);

    715  7 000646   200224 741300       XDEC         STX1  ! BRANCH+1,,AUTO

     2183      716    2   DCL XBIN SBIN;
     2184      717    2   DCL XCH CHAR(4) ALIGNED;
     2185      718
     2186      719    2       CALL BINCHAR(XCH,XBIN);

    719  7 000647   200225 470500                    LDP0    @XBIN,,AUTO
         7 000650   000100 301500                    BTD
         7 000651   000000 000004                    NDSC9   0,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         7 000652   200226 030004                    NDSC9   XCH,,AUTO                cn=0,s=nosgn,sf=0,n=4

     2187      720    3       IF XBIN < 10 THEN DO;

    720  7 000653   000000 235100                    LDA     0,,PR0
         7 000654   000012 115007                    CMPA    10,DL
         7 000655   000665 605000 7                  TPL     s:724

     2188      721    3           CALL INSERT(BUFFER,BUFX,1,SUBSTR(XCH,3,1));

    721  7 000656   200044 236100                    LDQ     BUFX,,AUTO
         7 000657   040106 100500                    MLR     fill='040'O
         7 000660   200226 600001                    ADSC9   XCH,,AUTO                cn=3,n=1
         7 000661   200006 000001                    ADSC9   BUFFER,Q,AUTO            cn=0,n=1

     2189      722    3           BUFX = BUFX + 1;

    722  7 000662   000001 036007                    ADLQ    1,DL
         7 000663   200044 756100                    STQ     BUFX,,AUTO

     2190      723    3           END;

    723  7 000664   000715 710000 7                  TRA     s:736

     2191      724    3       ELSE IF XBIN < 100 THEN DO;
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:348  

    724  7 000665   000144 115007                    CMPA    100,DL
         7 000666   000676 605000 7                  TPL     s:728

     2192      725    3               CALL INSERT(BUFFER,BUFX,2,SUBSTR(XCH,2,2));

    725  7 000667   200044 236100                    LDQ     BUFX,,AUTO
         7 000670   040106 100500                    MLR     fill='040'O
         7 000671   200226 400002                    ADSC9   XCH,,AUTO                cn=2,n=2
         7 000672   200006 000002                    ADSC9   BUFFER,Q,AUTO            cn=0,n=2

     2193      726    3               BUFX = BUFX + 2;

    726  7 000673   000002 036007                    ADLQ    2,DL
         7 000674   200044 756100                    STQ     BUFX,,AUTO

     2194      727    3               END;

    727  7 000675   000715 710000 7                  TRA     s:736

     2195      728    3           ELSE IF XBIN < 1000 THEN DO;

    728  7 000676   001750 115007                    CMPA    1000,DL
         7 000677   000707 605000 7                  TPL     s:733

     2196      729    3                   CALL INSERT(BUFFER,BUFX,3,SUBSTR(XCH,1,3));

    729  7 000700   200044 236100                    LDQ     BUFX,,AUTO
         7 000701   040106 100500                    MLR     fill='040'O
         7 000702   200226 200003                    ADSC9   XCH,,AUTO                cn=1,n=3
         7 000703   200006 000003                    ADSC9   BUFFER,Q,AUTO            cn=0,n=3

     2197      730    3                   BUFX = BUFX + 3;

    730  7 000704   000003 036007                    ADLQ    3,DL
         7 000705   200044 756100                    STQ     BUFX,,AUTO

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:349  
     2198      731    3                   END;

    731  7 000706   000715 710000 7                  TRA     s:736

     2199      732    3               ELSE DO;

     2200      733    3                   CALL INSERT(BUFFER,BUFX,4,SUBSTR(XCH,0,4));

    733  7 000707   200044 236100                    LDQ     BUFX,,AUTO
         7 000710   040106 100500                    MLR     fill='040'O
         7 000711   200226 000004                    ADSC9   XCH,,AUTO                cn=0,n=4
         7 000712   200006 000004                    ADSC9   BUFFER,Q,AUTO            cn=0,n=4

     2201      734    3                   BUFX = BUFX + 4;

    734  7 000713   000004 036007                    ADLQ    4,DL
         7 000714   200044 756100                    STQ     BUFX,,AUTO

     2202      735    3                   END;

     2203      736    2   END;

    736  7 000715   200224 221300                    LDX1  ! BRANCH+1,,AUTO
         7 000716   000001 702211                    TSX2  ! 1,X1

     2204      737
     2205      738
     2206      739
     2207      740    1   MOVE_NAM1: PROC(N1X);

    740  7 000717   200220 741300       MOVE_NAM1    STX1  ! X+1,,AUTO

     2208      741    2   DCL N1X UBIN;
     2209      742    2   DCL CNT UBIN;
     2210      743    2       CNT = NAM1.NAME.CNT(N1X);

    743  7 000720   200221 470500                    LDP0    @N1X,,AUTO
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:350  
         7 000721   000000 236100                    LDQ     0,,PR0
         7 000722   000012 402007                    MPY     10,DL
         7 000723   000000 471400 1                  LDP1    NAM1$
         7 000724   100000 236106                    LDQ     0,QL,PR1
         7 000725   000777 376007                    ANQ     511,DL
         7 000726   200222 756100                    STQ     CNT,,AUTO

     2211      744    2       CALL INSERT(BUFFER,BUFX,CNT,

    744  7 000727   000000 236100                    LDQ     0,,PR0
         7 000730   000012 402007                    MPY     10,DL
         7 000731   000002 736000                    QLS     2
         7 000732   200222 720100                    LXL0    CNT,,AUTO
         7 000733   200044 235100                    LDA     BUFX,,AUTO
         7 000734   040145 100546                    MLR     fill='040'O
         7 000735   100001 000010                    ADSC9   1,Q,PR1                  cn=0,n=*X0
         7 000736   200006 000010                    ADSC9   BUFFER,A,AUTO            cn=0,n=*X0

     2212      745    2          SUBSTR(NAM1.NAME.TEXT(N1X),0,CNT));
     2213      746    2       BUFX = BUFX + CNT;

    746  7 000737   200044 236100                    LDQ     BUFX,,AUTO
         7 000740   200222 036100                    ADLQ    CNT,,AUTO
         7 000741   200044 756100                    STQ     BUFX,,AUTO

     2214      747    2   END;

    747  7 000742   200220 221300                    LDX1  ! X+1,,AUTO
         7 000743   000001 702211                    TSX2  ! 1,X1

FPT_WRITE
 Sect OctLoc
   5     000   000003 777640   000010 006000   000000 177640   000000 006014    ................
   5     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   5     010   000000 400400   000000 000000   000000 000000   100000 000000    ............@...

(unnamed)
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:351  
 Sect OctLoc
   6     000   102111 104120   040124 157160   157154 157147   171040 101156    BIDP Topology An
   6     004   141154 171163   151163 072040   102040 040120   157162 164040    alysis: B  Port
   6     010   151163 040040   040141 143143   145163 163040   151163 040040    is   access is
   6     014   123105 122111   101114 056040   104111 122105   103124 056040    SERIAL. DIRECT.
   6     020   103101 114103   056040 040040   113105 131105   104040 040040    CALC.   KEYED
   6     024   102040 040040   040166 151141   040040 040040   077040 142141    B    via    ? ba
   6     030   144040 141143   143145 163163   040155 157144   145040 077040    d access mode ?
   6     034   122145 143157   162144 040151   163040 040040   141163 040155    Record is   as m
   6     040   145155 142145   162040 157146   157167 156145   162040 040040    ember ofowner
   6     044   040164 157040   143157 155160   154145 164145   040160 141164     to complete pat
   6     050   150056 040040   040146 157162   040143 157156   163164 162141    h.   for constra
   6     054   151156 164056   040146 157162   040144 151163   160154 141171    int. for display
   6     060   056040 040040   040146 157162   040144 151163   160154 141171    .    for display
   6     064   040141 156144   040143 157156   163164 162141   151156 164056     and constraint.
   6     070   074074 040114   141155 142144   141040 154145   166145 154040    << Lambda level
   6     074   040142 162141   156143 150040   040076 076040                     branch  >>

(unnamed)
 Sect OctLoc
   8     000   101040 040040   000005 400000   777777 600000   056040 040040    A   .........
     2215      748
     2216      749    1   END; /* ZII$PRINT_PATH */
     2217      750        %EOD;

PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:352  
--  Include file information  --

   ZI$PATH_STRUCTS.:ZIC0TOU  is referenced.
   ZI$STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$PRINT_PATH.

   Procedure ZII$PRINT_PATH requires 484 words for executable code.
   Procedure ZII$PRINT_PATH requires 154 words of local(AUTO) storage.
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:353  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:354  
          MINI XREF LISTING

ACCESS_LIST
       370**DCL         6--PROC
ACCESS_LIST.DIRECT
       382**DCL       384--REDEF     391--REDEF
ACCESS_LIST.PORT_KEY
       373**DCL       540>>ASSIGN
ACCESS_LIST.PORT_TYPE
       375**DCL       501>>DOCASE
BRANCH IN PROCEDURE PRINT_LAMBDA
       685**DCL       703<<ASSIGN    704<>CALL
BUFFER
       423**DCL       478<<ASSIGN    479--ASSIGN    481<<CALLBLT   489<<CALLBLT   496<<CALLBLT   504<<CALLBLT
       511<<CALLBLT   518<<CALLBLT   525<<CALLBLT   530<<CALLBLT   535<<CALLBLT   543<<CALLBLT   550<<CALLBLT
       586<<ASSIGN    590<<CALLBLT   598<<ASSIGN    602<<CALLBLT   608<<CALLBLT   614<<CALLBLT   621<<CALLBLT
       628<<CALLBLT   635<<CALLBLT   644<<CALLBLT   675<<CALLBLT   687<<ASSIGN    691<<CALLBLT   698<<CALLBLT
       706<<CALLBLT   721<<CALLBLT   725<<CALLBLT   729<<CALLBLT   733<<CALLBLT   744<<CALLBLT
BUFX
       424**DCL       487<<ASSIGN    489>>CALLBLT   491<<ASSIGN    491>>ASSIGN    496>>CALLBLT   498<<ASSIGN
       498>>ASSIGN    504>>CALLBLT   506<<ASSIGN    506>>ASSIGN    511>>CALLBLT   513<<ASSIGN    513>>ASSIGN
       518>>CALLBLT   520<<ASSIGN    520>>ASSIGN    525>>CALLBLT   527<<ASSIGN    527>>ASSIGN    531>>ASSIGN
       533<<ASSIGN    535>>CALLBLT   537<<ASSIGN    537>>ASSIGN    543>>CALLBLT   545<<ASSIGN    545>>ASSIGN
       550>>CALLBLT   552<<ASSIGN    552>>ASSIGN    557>>ASSIGN    587<<ASSIGN    588>>IF        588<<ASSIGN
       590>>CALLBLT   592<<ASSIGN    592>>ASSIGN    596>>ASSIGN    599<<ASSIGN    600>>IF        600<<ASSIGN
       602>>CALLBLT   604<<ASSIGN    604>>ASSIGN    608>>CALLBLT   614>>CALLBLT   616<<ASSIGN    616>>ASSIGN
       621>>CALLBLT   623<<ASSIGN    623>>ASSIGN    628>>CALLBLT   630<<ASSIGN    630>>ASSIGN    635>>CALLBLT
       637<<ASSIGN    637>>ASSIGN    641>>ASSIGN    688<<ASSIGN    689>>IF        689<<ASSIGN    691>>CALLBLT
       693<<ASSIGN    693>>ASSIGN    698>>CALLBLT   700<<ASSIGN    700>>ASSIGN    706>>CALLBLT   708<<ASSIGN
       708>>ASSIGN    711>>ASSIGN    721>>CALLBLT   722<<ASSIGN    722>>ASSIGN    725>>CALLBLT   726<<ASSIGN
       726>>ASSIGN    729>>CALLBLT   730<<ASSIGN    730>>ASSIGN    733>>CALLBLT   734<<ASSIGN    734>>ASSIGN
       744>>CALLBLT   746<<ASSIGN    746>>ASSIGN
CNT IN PROCEDURE MOVE_NAM1
       742**DCL       743<<ASSIGN    744>>CALLBLT   744>>CALLBLT   746>>ASSIGN
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:355  
DISPLAY_LIST
       409**DCL         6--PROC
DISPLAY_LIST.IND.CONSTRAINT
       412**DCL       657>>ASSIGN
DISPLAY_LIST.IND.DISPLAY
       414**DCL       657>>ASSIGN
DISPLAY_LIST.REC_NO
       416**DCL       655>>DOINDEX   656>>IF
FPT_WRITE
       445**DCL       480<>CALL      483<>CALL      532<>CALL      597<>CALL      645<>CALL      676<>CALL
       681<>CALL      712<>CALL
FPT_WRITE.BUF_
       445**DCL       479<<ASSIGN
FPT_WRITE.BUF_.BOUND
       445**DCL       482<<ASSIGN    531<<ASSIGN    557<<ASSIGN    596<<ASSIGN    641<<ASSIGN    711<<ASSIGN
FPT_WRITE.STATION_
       447**DCL       447--REDEF
FPT_WRITE.V
       448**DCL       445--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
       454**DCL       454--REDEF
GET_INDICATORS
       654**PROC      610--CALL
I IN PROCEDURE TEST_BRANCH_AND_PRINT
       668**DCL       670<<DOINDEX   671>>IF
LEVEL.BRANCH
       470**DCL       578<<ASSIGN    578>>ASSIGN    674<<ASSIGN    703>>ASSIGN
LEVEL.REC_NO
       469**DCL       573>>DOWHILE   673<<ASSIGN
LX
       466**DCL       558<<ASSIGN    573>>DOWHILE   574>>IF        575<<ASSIGN    575>>ASSIGN    578>>ASSIGN
       578>>ASSIGN    587>>ASSIGN    599>>ASSIGN    672<<ASSIGN    672>>ASSIGN    673>>ASSIGN    674>>ASSIGN
       688>>ASSIGN    696<>CALL      703>>ASSIGN
M$WRITE
        18**DCL-ENT   480--CALL      483--CALL      532--CALL      597--CALL      645--CALL      676--CALL
       681--CALL      712--CALL
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:356  
MOVE_NAM1
       740**PROC      494--CALL      541--CALL      595--CALL      609--CALL
N1X IN PROCEDURE MOVE_NAM1
       741**DCL       740--PROC      743>>ASSIGN    744>>CALLBLT
NAM1.NAME.CNT
       325**DCL       743>>ASSIGN
NAM1.NAME.TEXT
       326**DCL       744>>CALLBLT
NAM1$
       309**DCL       312--IMP-PTR   743>>ASSIGN    744>>CALLBLT
PATH_LIST
       330**DCL         6--PROC
PATH_LIST.OWN_NEXT
       333**DCL       607>>IF
PATH_LIST.REC_NO
       331**DCL       485>>ASSIGN    486>>ASSIGN    564>>ASSIGN    671>>IF
PATH_LIST.REPEAT_IND
       341**DCL       571>>IF
PATH_LIST.SET_NO
       332**DCL       562>>ASSIGN    572>>ASSIGN    642>>ASSIGN
PN
       473**DCL       485<<ASSIGN    563>>DOINDEX   670>>DOINDEX
PRINT_LAMBDA
       684**PROC      579--CALL      677--CALL
PX
       472**DCL       559<<ASSIGN    563<<DOINDEX   564>>ASSIGN    571>>IF        572>>ASSIGN    607>>IF
       642>>ASSIGN    670>>DOINDEX
REC_NO
       474**DCL       486<<ASSIGN    494<>CALL      564<<ASSIGN    573>>DOWHILE   595<>CALL      656>>IF
       671>>IF        673>>ASSIGN
SET_NO
       475**DCL       562<<ASSIGN    572<<ASSIGN    609<>CALL      642<<ASSIGN    643>>IF
TEST_BRANCH_AND_PRINT
       667**PROC      560--CALL      648--CALL
X
       476**DCL       540<<ASSIGN    541<>CALL      611>>DOCASE    655<<DOINDEX   656>>IF        657<<ASSIGN
PL6.E3A0      #006=ZII$PRINT_PATH File=ZII$TOP_LIB.:ZIC0TSI                      FRI 09/05/97 12:33 Page:357  
       657>>ASSIGN    657>>ASSIGN    662<<ASSIGN
XBIN IN PROCEDURE XDEC
       716**DCL       715--PROC      719>>CALLBLT   720>>IF        724>>IF        728>>IF
XCH IN PROCEDURE XDEC
       717**DCL       719<<CALLBLT   721>>CALLBLT   725>>CALLBLT   729>>CALLBLT   733>>CALLBLT
XDEC
       715**PROC      696--CALL      704--CALL

PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:358  
     2218        1        /*T***********************************************************/
     2219        2        /*T*                                                         */
     2220        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2221        4        /*T*                                                         */
     2222        5        /*T***********************************************************/
     2223        6        ZII$COMMON_MEMORY: PROC(NUMBER_OF_WORDS,RESULTSE) ALTRET;
     2224        7    1   DCL NUMBER_OF_WORDS UBIN;
     2225        8    1   DCL MEMORY_FRAME UBIN(36) EXT;
     2226        9    1   DCL ZERO_OUT$ PTR AUTO;
     2227       10    1   DCL ZERO_OUT# UBIN AUTO;
     2228       11    1   DCL 1 ZERO_OUT_MEM BASED(ZERO_OUT$) ALIGNED,
     2229       12    1         2 * CHAR(ZERO_OUT#);
     2230       13        %EQU MAX_WORDS = 262143; /* Max size of GDS_FPT.V.SEGSIZE# */
     2231       14        /**/
     2232       15        %INCLUDE CP_6;
     2233       96        %FPT_GDS(FPTN=GDS_FPT,COMMON=YES,RESULTS=RESULTS_VECTOR);
     2234      112        %VLP_VECTOR(FPTN=RESULTS_VECTOR);
     2235      127        %VLP_VECTOR(FPTN=RESULTSE,STCLASS=);
     2236      142        /**/
     2237      143    1       IF NUMBER_OF_WORDS > %MAX_WORDS THEN
     2238      144    1           GOTO ER_GDS; /* Asking for more than can fit in a segment */
     2239      145    1       GDS_FPT.V.SEGSIZE#=NUMBER_OF_WORDS;
     2240      146    1       CALL M$GDS(GDS_FPT) ALTRET(ER_GDS);
     2241      147    1       RESULTSE=RESULTS_VECTOR;
     2242      148        /*
     2243      149          Init the new memory with Zeros.
     2244      150        */
     2245      151    1       ZERO_OUT$=PINCRW(RESULTS_VECTOR.PTR$,MEMORY_FRAME);
     2246      152    1       ZERO_OUT#=NUMBER_OF_WORDS * 4;
     2247      153    1       ZERO_OUT_MEM='0'B;
     2248      154    1       MEMORY_FRAME=MEMORY_FRAME + NUMBER_OF_WORDS;
     2249      155    1       RETURN;
     2250      156    1   ER_GDS:
     2251      157    1       ALTRETURN;
     2252      158    1   END ZII$COMMON_MEMORY;

PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:359  
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$COMMON_MEMORY.

   Procedure ZII$COMMON_MEMORY requires 33 words for executable code.
   Procedure ZII$COMMON_MEMORY requires 8 words of local(AUTO) storage.

    No errors detected in file ZII$TOP_LIB.:ZIC0TSI    .

PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:360  

 Object Unit name= ZII$COMMON_MEMORY                          File name= ZII$TOP_LIB.:ZIC0TOU
 UTS= SEP 05 '97 12:33:53.96 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  MEMORY_FRAME
    1   DCB   even  none     0      0  M$UC
    2   Data  even  none     8     10  ZII$COMMON_MEMORY
    3   Proc  even  none    33     41  ZII$COMMON_MEMORY
    4  RoData even  none     1      1  ZII$COMMON_MEMORY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        2  ZII$COMMON_MEMORY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC
PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:361  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:362  


     2218        1        /*T***********************************************************/
     2219        2        /*T*                                                         */
     2220        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2221        4        /*T*                                                         */
     2222        5        /*T***********************************************************/
     2223        6        ZII$COMMON_MEMORY: PROC(NUMBER_OF_WORDS,RESULTSE) ALTRET;

      6  3 000000   000000 700200 xent  ZII$COMMON_* TSX0  ! X66_AUTO_2
         3 000001   000010 000002                    ZERO    8,2

     2224        7    1   DCL NUMBER_OF_WORDS UBIN;
     2225        8    1   DCL MEMORY_FRAME UBIN(36) EXT;
     2226        9    1   DCL ZERO_OUT$ PTR AUTO;
     2227       10    1   DCL ZERO_OUT# UBIN AUTO;
     2228       11    1   DCL 1 ZERO_OUT_MEM BASED(ZERO_OUT$) ALIGNED,
     2229       12    1         2 * CHAR(ZERO_OUT#);
     2230       13        %EQU MAX_WORDS = 262143; /* Max size of GDS_FPT.V.SEGSIZE# */
     2231       14        /**/
     2232       15        %INCLUDE CP_6;
     2233       96        %FPT_GDS(FPTN=GDS_FPT,COMMON=YES,RESULTS=RESULTS_VECTOR);
     2234      112        %VLP_VECTOR(FPTN=RESULTS_VECTOR);
     2235      127        %VLP_VECTOR(FPTN=RESULTSE,STCLASS=);
     2236      142        /**/
     2237      143    1       IF NUMBER_OF_WORDS > %MAX_WORDS THEN

    143  3 000002   200003 470500                    LDP0    @NUMBER_OF_WORDS,,AUTO
         3 000003   000000 235100                    LDA     0,,PR0
         3 000004   000001 115003                    CMPA    1,DU
         3 000005   000040 603000 3                  TRC     ER_GDS

     2238      144    1           GOTO ER_GDS; /* Asking for more than can fit in a segment */
     2239      145    1       GDS_FPT.V.SEGSIZE#=NUMBER_OF_WORDS;

    145  3 000006   000000 720100                    LXL0    0,,PR0
         3 000007   000004 440000 2                  SXL0    GDS_FPT+4

PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:363  
     2240      146    1       CALL M$GDS(GDS_FPT) ALTRET(ER_GDS);

    146  3 000010   000000 630400 2                  EPPR0   GDS_FPT
         3 000011   430001 713400                    CLIMB   alt,gds
         3 000012   400400 401760                    pmme    nvectors=2
         3 000013   000040 702000 3                  TSX2    ER_GDS

     2241      147    1       RESULTSE=RESULTS_VECTOR;

    147  3 000014   000006 237000 2                  LDAQ    RESULTS_VECTOR
         3 000015   200004 470500                    LDP0    @RESULTSE,,AUTO
         3 000016   000000 757100                    STAQ    0,,PR0

     2242      148        /*
     2243      149          Init the new memory with Zeros.
     2244      150        */
     2245      151    1       ZERO_OUT$=PINCRW(RESULTS_VECTOR.PTR$,MEMORY_FRAME);

    151  3 000017   000000 236000 0                  LDQ     MEMORY_FRAME
         3 000020   000022 736000                    QLS     18
         3 000021   000007 036000 2                  ADLQ    RESULTS_VECTOR+1
         3 000022   200005 756100                    STQ     ZERO_OUT$,,AUTO

     2246      152    1       ZERO_OUT#=NUMBER_OF_WORDS * 4;

    152  3 000023   200003 471500                    LDP1    @NUMBER_OF_WORDS,,AUTO
         3 000024   100000 235100                    LDA     0,,PR1
         3 000025   000002 735000                    ALS     2
         3 000026   200006 755100                    STA     ZERO_OUT#,,AUTO

     2247      153    1       ZERO_OUT_MEM='0'B;

    153  3 000027   200005 473500                    LDP3    ZERO_OUT$,,AUTO
         3 000030   000000 620005                    EAX0    0,AL
         3 000031   000140 100400                    MLR     fill='000'O
         3 000032   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000033   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:364  

     2248      154    1       MEMORY_FRAME=MEMORY_FRAME + NUMBER_OF_WORDS;

    154  3 000034   000000 236000 0                  LDQ     MEMORY_FRAME
         3 000035   100000 036100                    ADLQ    0,,PR1
         3 000036   000000 756000 0                  STQ     MEMORY_FRAME

     2249      155    1       RETURN;

    155  3 000037   000000 702200 xent               TSX2  ! X66_ARET

     2250      156    1   ER_GDS:
     2251      157    1       ALTRETURN;

    157  3 000040   000000 702200 xent  ER_GDS       TSX2  ! X66_AALT

GDS_FPT
 Sect OctLoc
   2     000   000001 777640   000004 006000   000001 777640   000006 006000    ................
   2     004   200600 000000   ****** ******                                    ........

RESULTS_VECTOR
 Sect OctLoc
   2     006   000000 177640   000000 006014                                    ........

(unnamed)
 Sect OctLoc
   4     000   000000 000000                                                    ....
     2252      158    1   END ZII$COMMON_MEMORY;

PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:365  
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$COMMON_MEMORY.

   Procedure ZII$COMMON_MEMORY requires 33 words for executable code.
   Procedure ZII$COMMON_MEMORY requires 8 words of local(AUTO) storage.

    No errors detected in file ZII$TOP_LIB.:ZIC0TSI    .
PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:366  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=ZII$COMMON_MEMORY File=ZII$TOP_LIB.:ZIC0TSI                   FRI 09/05/97 12:33 Page:367  
          MINI XREF LISTING

ER_GDS
       157**LABEL     144--GOTO      146--CALLALT
GDS_FPT
       107**DCL       146<>CALL
GDS_FPT.V
       107**DCL       107--DCLINIT
GDS_FPT.V.SEGSIZE#
       110**DCL       145<<ASSIGN
M$GDS
        59**DCL-ENT   146--CALL
MEMORY_FRAME
         8**DCL       151>>ASSIGN    154<<ASSIGN    154>>ASSIGN
NUMBER_OF_WORDS
         7**DCL         6--PROC      143>>IF        145>>ASSIGN    152>>ASSIGN    154>>ASSIGN
RESULTSE
       138**DCL         6--PROC      147<<ASSIGN
RESULTSE.W2
       139**DCL       140--REDEF
RESULTS_VECTOR
       123**DCL       107--DCLINIT   147>>ASSIGN
RESULTS_VECTOR.PTR$
       125**DCL       151>>ASSIGN
RESULTS_VECTOR.W2
       124**DCL       125--REDEF
ZERO_OUT#
        10**DCL        12--IMP-SIZ   152<<ASSIGN    153>>ASSIGN
ZERO_OUT$
         9**DCL        11--IMP-PTR   151<<ASSIGN    153>>ASSIGN
ZERO_OUT_MEM
        11**DCL       153<<ASSIGN
