
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:1    
        1        1        /*M*     ZIG$V_FIELD      I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_FIELD
        9        9        PURPOSE:
       10       10              To put all the fields for the current record in the schema
       11       11            subset. To find the connection for the type_430 descriptors
       12       12            and the schemas items for the current record.
       13       13
       14       14              This connection is not the easiest thing in the world since
       15       15            COBOL has group items and the may or may not be in the schema
       16       16            record.
       17       17
       18       18              One other thing; the names of all the fields for the current
       19       19            record are in the ALT HASH TABLE for easy finding and to save
       20       20            CLIMBs to IDS for every item in this record.
       21       21
       22       22        */
       23       23        /*
       24       24        ZZZZZ  III   GGG    $   V   V       FFFFF  III  EEEEE L     DDDD
       25       25            Z   I   G   G  $$$  V   V       F       I   E     L     D   D
       26       26           Z    I   G     $ $   V   V       F       I   E     L     D   D
       27       27          Z     I   G      $$$  V   V       FFFF    I   EEEE  L     D   D
       28       28         Z      I   G  GG   $ $ V   V       F       I   E     L     D   D
       29       29        Z       I   G   G  $$$   V V        F       I   E     L     D   D
       30       30        ZZZZZ  III   GGG    $     V         F      III  EEEEE LLLLL DDDD
       31       31                                      _____
       32       32        */
       33       33        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:2    
       34       34        ZIG$V_FIELD:
       35       35            PROC;
       36       36    1   DCL ZIG$HASH_IT ENTRY (8);
       37       37    1   DCL READSF ENTRY (2);
       38       38    1   DCL WRITSF ENTRY (2);
       39       39    1   DCL ZIG$ADD_SI ENTRY;
       40       40    1   DCL SN_DBK UBIN (36) EXT;
       41       41        %INCLUDE ZI_ERRORS_SUBS;
       42      561        %INCLUDE ZI_SUB_LANG;
       43     2276        %INCLUDE ZIG_DIR_STRUCS;
       44     2406        %GENERAL;
       45     2530        %CONTROL_BLOCK;
       46     2638    1   DCL IO_BUF CHAR (128) EXT;
       47     2639        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
       48     2798        %DESC_TYPE_9;
       49     2975        %DESC_TYPE_34;
       50     3023        %DESC_TYPE_35;
       51     3062        %INCLUDE ZIG_GENERAL;
       52     3170        %INCLUDE ZIG_TYPE_SUBS;
       53     3185        %INCLUDE ZIG_SSS;
       54     3755        %SS_GENERAL(PSTCLASS=EXT);
       55     3776        %OA(PSTCLASS=EXT);
       56     3843        %OA1(PSTCLASS=EXT);
       57     3851        %RC(PSTCLASS=EXT);
       58     3884        %RC1(PSTCLASS=EXT);
       59     3894        %DP(PSTCLASS=EXT);
       60     3908        %DP1(PSTCLASS=EXT);
       61     3916        %FR(PSTCLASS=EXT);
       62     3962        %FR1(PSTCLASS=EXT);
       63     3970        %CD(PSTCLASS=EXT);
       64     3989        %RS(PSTCLASS=EXT);
       65     4063        %SC(PSTCLASS=EXT);
       66     4090        %SS(PSTCLASS=EXT);
       67     4104        %INCLUDE ZIG_DBA_INT;
       68     4152        %INCLUDE ZI_SUB4_CAN;
       69     4809        %UWA;
       70     5144        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:3    
       71     5145    1   DCL I UBIN (36) STATIC;
       72     5146    1   DCL K UBIN (36) STATIC;
       73     5147    1   DCL HEADING_FIELD CHAR (25) STATIC;
       74     5148    1   DCL FIRST_FIELD BIT (1) EXT;
       75     5149    1   DCL CUR_EXT_NAME_SEG UBIN (36) EXT;
       76     5150    1   DCL IN_GROUP BIT (1) EXT;
       77     5151    1   DCL LAST_GROUP_LEVEL UBIN (36) EXT;
       78     5152    1   DCL TPTR$ PTR;
       79     5153    1   DCL L_SUBSCH_FR UBIN (36);
       80     5154    1   DCL SUCC BIT (1);
       81     5155    1   DCL CURRENT_OFF UBIN (36) EXT;
       82     5156    1   DCL STATUS UBIN (6);
       83     5157    1   DCL ERROR_FLG UBIN (36) STATIC;
       84     5158    1   DCL LAST_RC UBIN (18) EXT;
       85     5159    1   DCL LAST_FR UBIN (18) EXT;
       86     5160    1   DCL LAST_SC UBIN (18) EXT;
       87     5161    1   DCL CURRENT_CF UBIN (18) EXT;
       88     5162    1   DCL LIST_STRING CHAR (128) EXT;
       89     5163    1   DCL TEMP_STRING CHAR (128);
       90     5164    1   DCL T1PTR$ PTR;
       91     5165    1   DCL T5PTR$ PTR STATIC;
       92     5166    1   DCL T6PTR$ PTR STATIC;
       93     5167    1   DCL T_OFF UBIN (18);
       94     5168    1   DCL WORD36 UBIN (36) BASED;
       95     5169    1   DCL RECORD_NUM UBIN (36) EXT;
       96     5170    1   DCL SAVE_DBK UBIN (36) STATIC;
       97     5171    1   DCL SAVE_CF_DBK UBIN (36) STATIC;
       98     5172    1   DCL CF_PTR$ PTR EXT;
       99     5173    1   DCL 1 CF_STR BASED,
      100     5174    1         2 NPTR$ PTR,
      101     5175    1         2 COUNT UBIN (36),
      102     5176    1         2 STR CHAR (CF_STR.COUNT);
      103     5177    1   DCL CF_TPTR$ PTR;
      104     5178    1   DCL START_N UBIN (36) STATIC;
      105     5179    1   DCL ZERO_A UBIN (36) STATIC INIT (0);
      106     5180    1   DCL CHAR2 CHAR (2) BASED;
      107     5181    1   DCL BASED_PTR$ PTR BASED;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:4    
      108     5182    1   DCL FIELD_ERRORED BIT (1) EXT;
      109     5183    1   DCL DESCPTR PTR STATIC INIT (ADDR(BUFFER1));
      110     5184    1   DCL BUFFER1 CHAR (128) STATIC;
      111     5185    1   DCL BUFFER_TEMP CHAR (128) BASED (DESCPTR);
      112     5186    1   DCL EOF UBIN (36) STATIC;
      113     5187    1   DCL BUFFER_SIZE UBIN (36) STATIC;
      114     5188    1   DCL 1 FIELD1 EXT,
      115     5189    1         2 COUNT1 UBIN (9) UNAL,
      116     5190    1         2 TEXT1 CHAR (31) UNAL;
      117     5191    1   DCL WORD_OFFSET CHAR (6) STATIC;
      118     5192    1   DCL NIBLE_OFF CHAR (1) STATIC;
      119     5193    1   DCL NUM_OFF CHAR (12) STATIC;
      120     5194        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:5    
      121     5195         /*
      122     5196            Data type info
      123     5197         */
      124     5198    1   DCL VALID_STYPE(0:20) CONSTANT BIT(1) UNAL INIT(
      125     5199    1    '0'B,'1'B*6,'0'B,'1'B,'0'B,'1'B,'0'B,'1'B*2,'0'B*6,'1'B);
      126     5200    1   DCL VALID_CSSTYPE(0:28) CONSTANT BIT(1) UNAL INIT(
      127     5201    1    '0'B,'1'B*15,'0'B*13);
      128     5202    1   DCL VALID_FSSTYPE(0:28) CONSTANT BIT(1) UNAL INIT(
      129     5203    1    '0'B,'1'B,'0'B,'1'B,'0'B*10,'1'B*6,'0'B*9);
      130     5204    1   DCL SCHEMA_CC(0:19) ALIGNED BIT(3) CONSTANT INIT(
      131     5205    1    '000'B,'010'B,'010'B,'001'B,'001'B,
      132     5206    1    '000'B,'011'B,'010'B,'000'B,'000'B,
      133     5207    1    '100'B,'101'B,'101'B,'011'B,'011'B,
      134     5208    1    '000'B,'000'B,'000'B,'000'B,'000'B);
      135     5209    1   DCL STYPE6(0:19) CONSTANT UNAL BIT(6) INIT(
      136     5210    1    '000001'B,
      137     5211    1    '000010'B,
      138     5212    1    '001101'B,
      139     5213    1    '000011'B,
      140     5214    1    '000101'B,
      141     5215    1    '000000'B,
      142     5216    1    '001110'B,
      143     5217    1    '001111'B,
      144     5218    1    '010000'B,
      145     5219    1    '010001'B,
      146     5220    1    '010011'B,
      147     5221    1    '010100'B,
      148     5222    1    '010101'B,
      149     5223    1    '001110'B,
      150     5224    1    '010010'B,
      151     5225    1    '010110'B,
      152     5226    1    '010111'B,
      153     5227    1    '011000'B,
      154     5228    1    '011001'B,
      155     5229    1    '000000'B);
      156     5230    1   DCL DECIMAL(0:19) UNAL BIT(1) CONSTANT INIT(
      157     5231    1    '0'B,'0'B,'0'B,'1'B,'1'B,'0'B,
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:6    
      158     5232    1    '0'B,'0'B,'0'B,'0'B,'0'B,'1'B,
      159     5233    1    '1'B,'1'B,'1'B,'0'B*5);
      160     5234    1   DCL TN_S(0:27) UNAL BIT(3) CONSTANT INIT(
      161     5235    1    /*  0 */ '000'B,
      162     5236    1    /*  1 */ '000'B,
      163     5237    1    /*  2 */ '000'B,
      164     5238    1    /*  3 */ '111'B,
      165     5239    1    /*  4 */ '110'B,
      166     5240    1    /*  5 */ '110'B,
      167     5241    1    /*  6 */ '011'B,
      168     5242    1    /*  7 */ '001'B,
      169     5243    1    /*  8 */ '010'B,
      170     5244    1    /*  9 */ '011'B,
      171     5245    1    /* 10 */ '011'B,
      172     5246    1    /* 11 */ '000'B,
      173     5247    1    /* 12 */ '000'B,
      174     5248    1    /* 13 */ '000'B,
      175     5249    1    /* 14-27*/'000'B*14);
      176     5250    1   DCL M(0:27) CONSTANT UBIN (9) UNAL INIT(
      177     5251    1    2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,
      178     5252    1    2,2,2,2,2);
      179     5253    1   DCL NUMERIC(0:27) CONSTANT ALIGNED BIT(1) INIT(
      180     5254    1    '0'B,'0'B,'0'B,'1'B*8,'0'B*17);
      181     5255         /*
      182     5256            Cki tables
      183     5257         */
      184     5258         /* Validation check and encode flags */
      185     5259    1   DCL FLAG_TAB (0:63) BIT(12) CONSTANT UNAL INIT(
      186     5260         /*
      187     5261            ffffffffffee
      188     5262            1234567891BB
      189     5263            0CS           cki
      190     5264            ::::::::::::
      191     5265         */
      192     5266    1   '000000100000'B, /* 0*/
      193     5267    1   '100000000011'B, /* 1*/
      194     5268    1   '000000000000'B, /* 2*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:7    
      195     5269    1   '000000000011'B, /* 3*/
      196     5270    1   '010000000011'B, /* 4*/
      197     5271    1   '000000000011'B, /* 5*/
      198     5272    1   '000000000011'B, /* 6*/
      199     5273    1   '000100000011'B, /* 7*/
      200     5274    1   '000100000011'B, /* 8*/
      201     5275    1   '000100000011'B, /* 9*/
      202     5276    1   '000100000011'B, /*10*/
      203     5277    1   '000100000011'B, /*11*/
      204     5278    1   '000000000011'B, /*12*/
      205     5279    1   '000000000011'B, /*13*/
      206     5280    1   '000000000011'B, /*14*/
      207     5281    1   '010010000011'B, /*15*/
      208     5282    1   '000000000011'B, /*16*/
      209     5283    1   '000010000011'B, /*17*/
      210     5284    1   '000001000010'B, /*18*/
      211     5285    1   '000000000010'B, /*19*/
      212     5286    1   '000000000010'B, /*20*/
      213     5287    1   '000000000010'B, /*21*/
      214     5288    1   '000000000011'B, /*22*/
      215     5289    1   '000000000011'B, /*23*/
      216     5290    1   '000010000011'B, /*24*/
      217     5291    1   '000000000011'B, /*25*/
      218     5292    1   '000010000011'B, /*26*/
      219     5293    1   '000000000010'B, /*27*/
      220     5294    1   '000000000010'B, /*28*/
      221     5295    1   '000000000011'B, /*29*/
      222     5296    1   '000000000011'B, /*30*/
      223     5297    1   '000010000011'B, /*31*/
      224     5298    1   '000001000010'B, /*32*/
      225     5299    1   '001000000011'B, /*33*/
      226     5300    1   '001100000011'B, /*34*/
      227     5301    1   '001100000011'B, /*35*/
      228     5302    1   '001100000011'B, /*36*/
      229     5303    1   '001100000011'B, /*37*/
      230     5304    1   '001000000011'B, /*38*/
      231     5305    1   '000000000011'B, /*39*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:8    
      232     5306    1   '000000000011'B, /*40*/
      233     5307    1   '000000000000'B, /*41*/
      234     5308    1   '000000010000'B, /*42*/
      235     5309    1   '000000000011'B, /*43*/
      236     5310    1   '000000000011'B, /*44*/
      237     5311    1   '000000000011'B, /*45*/
      238     5312    1   '000000000011'B, /*46*/
      239     5313    1   '000000000011'B, /*47*/
      240     5314    1   '000000000011'B, /* 48 */
      241     5315    1   '000000000011'B, /* 49 */
      242     5316    1   '000100000011'B, /* 50 */
      243     5317    1   '000100000011'B, /* 51 */
      244     5318    1   '000100000011'B, /* 52 */
      245     5319    1   '000100000011'B, /* 53 */
      246     5320    1   '000000000000'B*10); /*Avail*/
      247     5321    1   DCL 1 FLAG_TAB1 (0:63) REDEF FLAG_TAB UNAL,
      248     5322    1         2 F1 BIT (1) UNAL,
      249     5323    1         2 F2 BIT (1) UNAL,
      250     5324    1         2 F3 BIT (1) UNAL,
      251     5325    1         2 F4 BIT (1) UNAL,
      252     5326    1         2 F5 BIT (1) UNAL,
      253     5327    1         2 F6 BIT (1) UNAL,
      254     5328    1         2 F7 BIT (1) UNAL,
      255     5329    1         2 F8 BIT (1) UNAL,
      256     5330    1         2 F9 BIT (1) UNAL,
      257     5331    1         2 F10 BIT (1) UNAL,
      258     5332    1         2 EBC BIT (1) UNAL,
      259     5333    1         2 EBS BIT (1) UNAL;
      260     5334         /* Encode subroutines */
      261     5335    1   DCL EN (0:63) UBIN (9) CONSTANT UNAL INIT(
      262     5336        /*   Name     cki      */
      263     5337    1   0, /* 0*/
      264     5338    1   0, /* 1*/
      265     5339    1   1, /* 2*/
      266     5340    1   1, /* 3*/ /* Changed from GCOS  DRP */
      267     5341    1   6, /* 4*/
      268     5342    1   33, /* 5*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:9    
      269     5343    1   35, /* 6*/
      270     5344    1   7, /* 7*/
      271     5345    1   7, /* 8*/
      272     5346    1   7, /* 9*/
      273     5347    1   13, /*10*/
      274     5348    1   14, /*11*/
      275     5349    1   8, /*12*/
      276     5350    1   36, /*13*/
      277     5351    1   12, /*14*/
      278     5352    1   2, /*15*/
      279     5353    1   34, /*16*/
      280     5354    1   24, /*17*/
      281     5355    1   3, /*18*/
      282     5356    1   23, /*19*/
      283     5357    1   23, /*20*/
      284     5358    1   3, /*21*/
      285     5359    1   26, /*22*/
      286     5360    1   27, /*23*/
      287     5361    1   25, /*24*/
      288     5362    1   35, /*25*/
      289     5363    1   4, /*26*/
      290     5364    1   3, /*27*/
      291     5365    1   3, /*28*/
      292     5366    1   15, /*29*/
      293     5367    1   16, /*30*/
      294     5368    1   5, /*31*/
      295     5369    1   1, /*32*/
      296     5370    1   10, /*33*/
      297     5371    1   9, /*34*/
      298     5372    1   9, /*35*/
      299     5373    1   17, /*36*/
      300     5374    1   18, /*37*/
      301     5375    1   11, /*38*/
      302     5376    1   27, /*39*/
      303     5377    1   32, /*40*/
      304     5378    1   29, /*41*/
      305     5379    1   0, /*42*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:10   
      306     5380    1   36, /*43*/
      307     5381    1   37, /*44*/
      308     5382    1   38, /*45*/
      309     5383    1   39, /*46*/
      310     5384    1   38, /*47*/
      311     5385    1   40, /* 48 */
      312     5386    1   41, /* 49 */
      313     5387    1   43, /* 50 */
      314     5388    1   44, /* 51 */
      315     5389    1   42, /* 52 */
      316     5390    1   42, /* 53 */
      317     5391    1   0*10); /*AVAIL.*/
      318     5392         /* Decode subroutines */
      319     5393    1   DCL DN (0:63) UBIN (9) CONSTANT UNAL INIT(
      320     5394        /*   Name     cki      */
      321     5395    1   0, /* 0*/
      322     5396    1   0, /* 1*/
      323     5397    1   1, /* 2*/
      324     5398    1   1, /* 3*/ /* Changed from GCOS  DRP */
      325     5399    1   2, /* 4*/
      326     5400    1   34, /* 5*/
      327     5401    1   35, /* 6*/
      328     5402    1   24, /* 7*/
      329     5403    1   4, /* 8*/
      330     5404    1   3, /* 9*/
      331     5405    1   5, /*10*/
      332     5406    1   6, /*11*/
      333     5407    1   7, /*12*/
      334     5408    1   35, /*13*/
      335     5409    1   20, /*14*/
      336     5410    1   10, /*15*/
      337     5411    1   33, /*16*/
      338     5412    1   14, /*17*/
      339     5413    1   8, /*18*/
      340     5414    1   9, /*19*/
      341     5415    1   8, /*20*/
      342     5416    1   8, /*21*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:11   
      343     5417    1   11, /*22*/
      344     5418    1   12, /*23*/
      345     5419    1   13, /*24*/
      346     5420    1   36, /*25*/
      347     5421    1   14, /*26*/
      348     5422    1   25, /*27*/
      349     5423    1   9, /*28*/
      350     5424    1   11, /*29*/
      351     5425    1   12, /*30*/
      352     5426    1   13, /*31*/
      353     5427    1   1, /*32*/
      354     5428    1   15, /*33*/
      355     5429    1   16, /*34*/
      356     5430    1   17, /*35*/
      357     5431    1   16, /*36*/
      358     5432    1   16, /*37*/
      359     5433    1   18, /*38*/
      360     5434    1   26, /*39*/
      361     5435    1   30, /*40*/
      362     5436    1   27, /*41*/
      363     5437    1   0, /*42*/
      364     5438    1   36, /*43*/
      365     5439    1   38, /*44*/
      366     5440    1   37, /*45*/
      367     5441    1   38, /*46*/
      368     5442    1   39, /*47*/
      369     5443    1   40, /* 48 */
      370     5444    1   40, /* 49 */
      371     5445    1   43, /* 50 */
      372     5446    1   43, /* 51 */
      373     5447    1   41, /* 52 */
      374     5448    1   42, /* 53 */
      375     5449    1   0*10); /*AVAIL.*/
      376     5450         /* Cki value matrix */
      377     5451    1   DCL CMAP_CKI (0:559) UBIN (9) UNAL
      378     5452    1    CONSTANT INIT(
      379     5453         /* Schema  data   TYPE: Horizontal */
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:12   
      380     5454         /* Subschema data TYPE: Vertical */
      381     5455    1    1, 4, 4,15,15,32, 0, 4, 0, 3, 0,50,51, 0, 0, 0, 0, 0, 0,41,
      382     5456    1    2, 1, 1, 1, 1, 1, 0, 1, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,42,
      383     5457    1    2, 2,14,17,26,33, 0,39, 0, 3, 0,44,46, 0, 0, 0, 0, 0, 0, 0,
      384     5458    1    1, 7, 7,18,27,34, 0, 7, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      385     5459    1    1, 8, 8,19,28,35, 0, 8, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      386     5460    1    1, 9, 9,20,18,34, 0, 9, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      387     5461    1    1, 7, 7,21,27,34, 0, 7, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      388     5462    1    1, 9, 9,20,21,34, 0, 9, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      389     5463    1    1, 9, 9,20,21,34, 0, 8, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      390     5464    1    1,10,10,22,29,36, 0,10, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      391     5465    1    1,11,11,23,30,37, 0,11, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      392     5466    1    1,12,12,24,31,38, 0,12, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,42,
      393     5467    1    1,12,12,24,31,38, 0,12, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,42,
      394     5468    1    1,45,45, 6,13,52, 0, 0, 0, 0, 0, 2, 5, 0, 0, 0, 0, 0, 0, 0,
      395     5469    1    1,47,47,25,43,53, 0, 0, 0, 0, 0,16, 2, 0, 0, 0, 0, 0, 0, 0,
      396     5470    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      397     5471    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      398     5472    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      399     5473    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      400     5474    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      401     5475    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      402     5476    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      403     5477    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      404     5478    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      405     5479    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      406     5480    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      407     5481    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      408     5482    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
      409     5483    1   DCL FMAP_CKI (0:559) UBIN (9)
      410     5484    1    CONSTANT UNAL INIT(
      411     5485    1    1, 4, 4,15,15,32, 0, 4, 0, 3, 0,50,51, 0, 0, 0, 0, 0, 0,41,
      412     5486    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      413     5487    1    2, 2,14,17,26,33, 0,39, 0, 3, 0,44,46, 0, 0, 0, 0, 0, 0, 0,
      414     5488    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      415     5489    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      416     5490    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:13   
      417     5491    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      418     5492    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      419     5493    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      420     5494    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      421     5495    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      422     5496    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      423     5497    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      424     5498    1    1,45,45, 6,13,52, 0, 0, 0, 0, 0, 2, 5, 0, 0, 0, 0, 0, 0, 0,
      425     5499    1    47,47,47,25,43,53, 0, 0, 0, 0, 0,16, 2, 0, 0, 0, 0, 0, 0, 0,
      426     5500    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      427     5501    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      428     5502    1    0,40,40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      429     5503    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      430     5504    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      431     5505    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      432     5506    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      433     5507    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      434     5508    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      435     5509    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      436     5510    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      437     5511    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      438     5512    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
      439     5513    1   DCL SSCALE UBIN (36) STATIC;
      440     5514    1   DCL SLENGTH UBIN (36) STATIC;
      441     5515    1   DCL 1 NEIS BASED ALIGNED,
      442     5516    1         2 * BIT (24) UNAL,
      443     5517    1         2 SCALE UBIN (6) UNAL,
      444     5518    1         2 LENGTH UBIN (6) UNAL;
      445     5519    1   DCL 1 AEIS BASED ALIGNED,
      446     5520    1         2 * BIT (24) UNAL,
      447     5521    1         2 LENGTH UBIN (12) UNAL;
      448     5522    1   DCL DPPROC BIT (1) STATIC;
      449     5523    1   DCL CKI UBIN (36) STATIC;
      450     5524    1   DCL CKIP UBIN (36) STATIC;
      451     5525        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:14   
      452     5526    1   FIND_LENGTH:
      453     5527    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      454     5528    2   DCL RETURN_LENGTH UBIN (36);
      455     5529    2   DCL STRING_TO_GET CHAR (30);
      456     5530    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);
      457     5531    2       RETURN;
      458     5532    2   NOT_BLANK:
      459     5533    2       RETURN_LENGTH = 30;
      460     5534    2       RETURN;
      461     5535    2   END FIND_LENGTH;
      462     5536        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:15   
      463     5537    1   FIND_CF:
      464     5538    1       PROC(DBK,FOUND);
      465     5539    2   DCL DBK UBIN (36);
      466     5540    2   DCL FOUND UBIN (36);
      467     5541    2   DCL 1 SEARCH_STR,
      468     5542    2         2 STR CHAR(2) UNAL,
      469     5543    2         2 NUM REDEF STR UBIN (18) UNAL;
      470     5544    2   DCL T9PTR$ PTR STATIC;
      471     5545    2       SEARCH_STR.NUM = DBK;
      472     5546    2       FOUND = 0;
      473     5547    2       START_N = 0;
      474     5548    2       CF_TPTR$ = CF_PTR$;
      475     5549    3       DO WHILE (CF_TPTR$ ~= ADDR(NIL));
      476     5550    3           CALL INDEX2(I,SEARCH_STR.STR,CF_TPTR$ -> CF_STR.STR,START_N)
      477     5551    3              ALTRET(INCREMENT);
      478     5552    3           IF MOD(I,4) = 0
      479     5553    4           THEN DO;
      480     5554    4               FOUND = 1;
      481     5555    4               ADDR(CURRENT_CF) -> CHAR2 = SUBSTR(CF_TPTR$ -> CF_STR.STR,I+2,2);
      482     5556    4               T1PTR$ = PINCRW(SSS$, CURRENT_CF);
      483     5557    4               IF T1PTR$ -> CD.DEF.RELT = 0
      484     5558    5               THEN DO;
      485     5559    5                   T9PTR$ = PINCRW(SSS$, T1PTR$ -> CD.RSCDH);
      486     5560    5                   IF T9PTR$ -> RS.DEF.TYPE = '0040'O
      487     5561    6                   THEN DO;
      488     5562    6                       T9PTR$ = PINCRW(SSS$, T9PTR$ -> RS.SCRSH);
      489     5563    6                       IF T9PTR$ -> SC.DEF.SETT = 0 AND
      490     5564    6                          ( T9PTR$ -> SC.DEF.SETO = 4 OR
      491     5565    6                          T9PTR$ -> SC.DEF.SETO = 6) AND
      492     5566    6                          T9PTR$ -> SC.DEF.SNSS
      493     5567    7                       THEN DO;
      494     5568    7                           FR.DEF.FMOD = '1'B;
      495     5569    7                           END;
      496     5570    6                       END;
      497     5571    5                   END;
      498     5572    4               RETURN;
      499     5573    4               END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:16   
      500     5574    4           ELSE DO;
      501     5575    4               START_N = I + 1;
      502     5576    4               END;
      503     5577    4           DO WHILE ('0'B);
      504     5578    4   INCREMENT:
      505     5579    4               CF_TPTR$ = CF_TPTR$ -> CF_STR.NPTR$;
      506     5580    4               START_N = 0;
      507     5581    4               END;
      508     5582    3           END;
      509     5583    2       RETURN;
      510     5584    2   END FIND_CF;
      511     5585        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:17   
      512     5586    1   GET_ENCODE_DECODE:
      513     5587    1       PROC;
      514     5588    2       IF UWA.FR.FTYPE > 19 OR ~VALID_STYPE(UWA.FR.FTYPE+1)
      515     5589    3       THEN DO;
      516     5590    3           CALL CHECK_FOR_DPPROC;
      517     5591    3           IF DPPROC
      518     5592    4           THEN DO;
      519     5593    4               FR.DEF.ENDX = 21; /* Encode DB procedure. */
      520     5594    4               FR.DEF.DNDX = 22; /* Decode DB procedure. */
      521     5595        /*
      522     5596              The data base procedures will be connected up at the
      523     5597            end of the validation and at that time all the FR records
      524     5598            with DB procedures will be checked.
      525     5599        */
      526     5600    4               RETURN;
      527     5601    4               END;
      528     5602    3           CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);
      529     5603    3           CALL SET_FIELDS(2,30,TYPE_430.FIELD_NAME);
      530     5604    3           I = RC.DEF.RNL;
      531     5605    3           CALL SET_FIELDS(3,I,RC.RNAM);
      532     5606    3           CALL ERROR(%ZIG_V_NO_SYS_E_D);
      533     5607        /*E*     ERROR:    ZIG-ZIG_V_NO_SYS_E_D-C
      534     5608        MESSAGE: For the subschema field "%U1" in the schema record "%U3"
      535     5609                 there is no system ENCODE or DECODE procedures for
      536     5610                 the schema field "%U2".
      537     5611        */
      538     5612    3           FIELD_ERRORED = '1'B;
      539     5613    3           RETURN;
      540     5614    3           END;
      541     5615    2       IF DECIMAL(UWA.FR.FTYPE)
      542     5616    3       THEN DO;
      543     5617    3           SLENGTH = ADDR(FR.ROFST) -> NEIS.LENGTH;
      544     5618    3           SSCALE = ADDR(FR.ROFST) -> NEIS.SCALE;
      545     5619    3           IF SSCALE < 32
      546     5620    3           THEN SSCALE = -SSCALE;
      547     5621    3           ELSE SSCALE = 64 - SSCALE;
      548     5622    3           END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:18   
      549     5623    3       ELSE DO;
      550     5624    3           SLENGTH = FR.ROFST.EIS.COUNT;
      551     5625    3           SSCALE = 0;
      552     5626    3           END;
      553     5627    2       IF TYPE_430.DATA_TYPE > 27 OR
      554     5628    2          (~VALID_CSSTYPE(TYPE_430.DATA_TYPE + 1) AND SUB_LANGUAGE = #COBOL)
      555     5629    2          OR (~VALID_FSSTYPE(TYPE_430.DATA_TYPE + 1) AND
      556     5630    2          (SUB_LANGUAGE = #FORTRAN OR SUB_LANGUAGE = #APL OR SUB_LANGUAGE = #BASIC))
      557     5631    3       THEN DO;
      558     5632    3           CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);
      559     5633    3           I = RC.DEF.RNL;
      560     5634    3           CALL SET_FIELDS(2,I,RC.RNAM);
      561     5635    3           CALL ERROR(%ZIG_V_BAD_DATA_TYPE);
      562     5636        /*E*     ERROR:    ZIG-ZIG_V_BAD_DATA_TYPE-C
      563     5637        MESSAGE: For the field "%U1" in the record "%U2"
      564     5638                 the subschema data type is not a valid data type for
      565     5639                 this field.
      566     5640                 <<<< SOFTWARE ERROR >>>>
      567     5641        */
      568     5642    3           RETURN;
      569     5643    3           END;
      570     5644        /*
      571     5645              Everything is ok to set the encode and decode procedure.
      572     5646        */
      573     5647    2       CKIP = UWA.FR.FTYPE + TYPE_430.DATA_TYPE * 20;
      574     5648    2       IF SUB_LANGUAGE = #COBOL
      575     5649    2       THEN CKI = CMAP_CKI(CKIP);
      576     5650    2       ELSE CKI = FMAP_CKI(CKIP);
      577     5651    2       CALL SYSTEM_CONVERSION_ERROR;
      578     5652    2       FR.DEF.EBCM = FLAG_TAB1.EBS(CKI);
      579     5653    2       FR.DEF.EBCL = FLAG_TAB1.EBC(CKI);
      580     5654    2       IF FLAG_TAB1.F6(CKI) AND SLENGTH = TYPE_430.LEN_FIELD AND
      581     5655    2          SSCALE = TYPE_430.SCALE_FIELD
      582     5656    2       THEN FR.DEF.EBCL = '0'B;
      583     5657    2       FR.DEF.ENDX = EN(CKI);
      584     5658    2       IF (UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9) AND
      585     5659    2          TYPE_430.DATA_TYPE = 0 AND TYPE_430.LEN_FIELD > SLENGTH
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:19   
      586     5660    3       THEN DO;
      587     5661    3           FR.DEF.ENDX = 19;
      588     5662    3           FR.DEF.EBCM = '1'B;
      589     5663    3           END;
      590     5664        /*
      591     5665              Now comes the decode things for this field.
      592     5666        */
      593     5667    2       FR.DEF.DNDX = DN(CKI);
      594     5668    2       IF (UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9)
      595     5669    2          AND TYPE_430.DATA_TYPE = 0
      596     5670    3       THEN DO;
      597     5671        /*
      598     5672              Character to character decode.
      599     5673        */
      600     5674    3           IF SUB_LANGUAGE = #COBOL
      601     5675    4           THEN DO;
      602     5676    4               IF SLENGTH > TYPE_430.LEN_FIELD
      603     5677    4               THEN FR.DEF.DNDX = 19;
      604     5678    4               END;
      605     5679    4           ELSE DO;
      606     5680    4               IF SLENGTH > TYPE_430.LEN_FIELD
      607     5681    5               THEN DO;
      608     5682    5                   IF MOD(TYPE_430.LEN_FIELD,4) = 0
      609     5683    5                   THEN FR.DEF.DNDX = 19;
      610     5684    5                   ELSE FR.DEF.DNDX = 32;
      611     5685    5                   END;
      612     5686    5               ELSE DO;
      613     5687    5                   IF MOD(TYPE_430.LEN_FIELD,4) = 0
      614     5688    5                   THEN FR.DEF.DNDX = 31;
      615     5689    5                   END;
      616     5690    4               END;
      617     5691    3           END;
      618     5692    2       FR.DEF.COMC = BITBIN(SCHEMA_CC(UWA.FR.FTYPE));
      619     5693    2   END GET_ENCODE_DECODE;
      620     5694        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:20   
      621     5695    1   SYSTEM_CONVERSION_ERROR:
      622     5696    1       PROC;
      623     5697    2       IF FLAG_TAB1.F1(CKI) OR
      624     5698    2          FLAG_TAB1.F7(CKI) OR
      625     5699    2          FLAG_TAB1.F8(CKI)
      626     5700    3       THEN DO;
      627     5701    3           FIELD_ERRORED = '1'B;
      628     5702    3           RETURN;
      629     5703    3           END;
      630     5704    2       IF (FLAG_TAB1.F2(CKI) AND TYPE_430.LEN_FIELD > 63) OR
      631     5705    2          (FLAG_TAB1.F3(CKI) AND SLENGTH > 63) OR
      632     5706    2          (FLAG_TAB1.F4(CKI) AND TYPE_430.SCALE_FIELD ~= 0) OR
      633     5707    2          (FLAG_TAB1.F5(CKI) AND SSCALE ~= 0)
      634     5708    3       THEN DO;
      635     5709    3           FIELD_ERRORED = '1'B;
      636     5710    3           RETURN;
      637     5711    3           END;
      638     5712    2       RETURN;
      639     5713    2   END SYSTEM_CONVERSION_ERROR;
      640     5714        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:21   
      641     5715    1   CHECK_FOR_DPPROC:
      642     5716    1       PROC;
      643     5717    2       DPPROC = '0'B;
      644     5718    2       RETURN;
      645     5719    2   END CHECK_FOR_DPPROC;
      646     5720        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:22   
      647     5721    1       TYPE_430.DBK_SN = 0;
      648     5722        /*
      649     5723              Now comes the code that does the field things.
      650     5724        */
      651     5725    1       IF TYPE_430.REF_LINE ~= 0
      652     5726    2       THEN DO;
      653     5727    2           IF IN_GROUP AND LAST_GROUP_LEVEL < TYPE_430.LEVEL_FIELD
      654     5728    3           THEN DO;
      655     5729    3               TYPE_430.FLAGS.TYPE = '111111111111'B;
      656     5730    3               CONTROL.BITS.ALL_FIELDS = '0'B;
      657     5731    3               CALL WRITSF(CURRENT_RECORD,IO_BUF);
      658     5732        /*
      659     5733            Turn off the bit which says this group item is in the UWA so
      660     5734            the languages know this item cannot be used in a DML statement.
      661     5735        */
      662     5736    3               CALL READSF(TYPE_430.REF_LINE,DESC_TYPE_9);
      663     5737    3               DESC_TYPE_9.BUWA = '0'B;
      664     5738    3               CALL WRITSF(TYPE_430.REF_LINE,DESC_TYPE_9);
      665     5739    3               RETURN;
      666     5740    3               END;
      667     5741        /*
      668     5742              We are not still in a group so don't just return.
      669     5743        */
      670     5744    3           ELSE DO;
      671     5745    3               IN_GROUP = '0'B;
      672     5746    3               LAST_GROUP_LEVEL = 0;
      673     5747    3               END;
      674     5748    2           FIELD_ERRORED = '0'B;
      675     5749    2           STATUS = #ITEM_DEF;
      676     5750    2           ALLOCATE_END = 2;
      677     5751    2           HASH_SCHEMA_NAME = '1'B;
      678     5752    2           CALL ZIG$HASH_IT(TYPE_430.FIELD_NAME,#ADD_ALT_HASH,ERROR_FLG,0,
      679     5753    2              RECORD_NUM,14,TPTR$,STATUS);
      680     5754    2           ALLOCATE_END = 0;
      681     5755    2           IF ERROR_FLG = 0
      682     5756    3           THEN DO;
      683     5757    3               TYPE_430.FLAGS.TYPE = '111111111110'B;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:23   
      684     5758    3               CONTROL.BITS.ALL_FIELDS = '0'B;
      685     5759    3               CALL WRITSF(CURRENT_RECORD,IO_BUF);
      686     5760    3               IF TYPE_430.ELEMENTARY
      687     5761    4               THEN DO;
      688     5762    4                   CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);
      689     5763    4                   CALL SET_FIELDS(2,30,TYPE_430.FIELD_NAME);
      690     5764    4                   TYPE_35.SUB_RECORD_NM = RC.RNAM;
      691     5765    4                   CALL SET_FIELDS(3,30,TYPE_35.SUB_RECORD_NM);
      692     5766    4                   CALL WARNING(%ZIG_V_FIELD_USER);
      693     5767        /*E*     ERROR:    ZIG-ZIG_V_FIELD_USER-C
      694     5768        MESSAGE: The field "%U1" has no corresponding field in
      695     5769                 the schema for the record "%U3" field "%U2".
      696     5770                 Therefore, the field will not be updated by any DML calls and
      697     5771                 cannot be used as a control item in any DML calls.
      698     5772        */
      699     5773    4                   END;
      700     5774    3               TPTR$ -> FIELD_HASH.REF = 1;
      701     5775        /*
      702     5776              This is to make the driver think that we use this field
      703     5777            even if it isn't in the schema.
      704     5778        */
      705     5779    3               RETURN;
      706     5780    3               END;
      707     5781        /*
      708     5782              The item with that name is in the schema file so we can
      709     5783            add it to the RC record as a FR record and the try and do
      710     5784            some incoding and decoding procedures for that item.
      711     5785        */
      712     5786    2           TYPE_430.DBK_SN = TPTR$ -> FIELD_HASH.DBK_SN;
      713     5787    2           CALL FETCHD_6('FR  ',TPTR$ -> FIELD_HASH.DBK);
      714     5788    2           END;
      715     5789    1       CALL ZIG$G_DYN_MEM_6(1, FR1$);
      716     5790    1       FR1.XXDPN = UWA.DIRECT_REF;
      717     5791        /*
      718     5792              The FR record was the last thing found all ways and don't
      719     5793            screw it up.
      720     5794        */
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:24   
      721     5795    1       IF VALIDS.FR_NAMES
      722     5796    2       THEN DO;
      723     5797    2           CALL FIND_LENGTH(TYPE_430.SUB_FIELD_NAME,L_SUBSCH_FR);
      724     5798    2           CALL ZIG$G_DYN_MEM_6(%FR_BASE_SIZE+(L_SUBSCH_FR+3)/4,FR$);
      725     5799    2           FR.FNL = L_SUBSCH_FR;
      726     5800    2           FR.FNAM = TYPE_430.SUB_FIELD_NAME;
      727     5801    2           END;
      728     5802    2       ELSE DO;
      729     5803    2           CALL ZIG$G_DYN_MEM_6(%FR_BASE_SIZE,FR$);
      730     5804    2           FR1.NLIND = CURRENT_RECORD;
      731     5805    2           END;
      732     5806    1       IF TYPE_430.REF_LINE ~= 0
      733     5807    2       THEN DO;
      734     5808    2           CALL FETCHOS_6('SN-SE   ');
      735     5809    2           SN_DBK = UWA.DIRECT_REF;
      736     5810    2           CALL ZIG$ADD_SI;
      737     5811    2           END;
      738     5812    1       FR.DEF.TYPE = '000000010000'B;
      739     5813    1       IF UWA.FR.SYN = 1
      740     5814    1       THEN FR.DEF.SYN = '1'B;
      741     5815    2       ELSE DO;
      742     5816    2           IF TYPE_430.REF_LINE ~= 0
      743     5817    3           THEN DO;
      744     5818    3               FR.FRWSO = OA.CSZ + %CUR_BASE_SIZE;
      745     5819    3               OA.CSZ = OA.CSZ + %CUR_FR;
      746     5820    3               END;
      747     5821    2           END;
      748     5822    1       T1PTR$ = PINCRW(SSS$,LAST_FR);
      749     5823    1       FR.RCFRN = T1PTR$ -> FR.RCFRN;
      750     5824    1       CURRENT_OFF = POFFW(FR$,SSS$);
      751     5825    1       IF TYPE_430.REF_LINE ~= 0
      752     5826    2       THEN DO;
      753     5827    2           TPTR$ -> FIELD_HASH.SUB_OFF = CURRENT_OFF;
      754     5828    2           TPTR$ -> FIELD_HASH.REF = CURRENT_RECORD;
      755     5829    2           END;
      756     5830    1       LAST_FR = CURRENT_OFF;
      757     5831    1       T1PTR$ -> FR.RCFRN = CURRENT_OFF;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:25   
      758     5832    1       FR.RCFRH = LAST_RC;
      759     5833    1       FR.DEF.FUSE = UWA.FR.F_USE;
      760     5834    1       ADDR(FR.ROFST) -> WORD36 = UWA.FR.BUFFLOC;
      761     5835    1       IF UWA.FR.FTYPE = 19 /* CHAR VARYING */
      762     5836    2       THEN DO;
      763     5837    2           FR.ROFST.EIS.COUNT = UWA.FR.PREC;
      764     5838    2           FR.DEF.FVF = '1'B;
      765     5839    2           END;
      766     5840    1       FR.UOFST.EIS = TYPE_430.EIS;
      767     5841    1       FR.UOFST.EIS.REG = 1;
      768     5842    2       DO WHILE ('1'B);
      769     5843    2           CALL FETCHNS_6('FR-CFS   ') ALTRET(END_CFS);
      770     5844    2           SAVE_CF_DBK = UWA.DIRECT_REF;
      771     5845        /*
      772     5846              Now search the hash table for the DBK that is in that CF record
      773     5847            so we can find the offset in the schema subset.
      774     5848        */
      775     5849    2           CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);
      776     5850    2           IF UWA.C_F.CTRLTYPE ~= 4 OR ERROR_FLG ~= 0
      777     5851    3           THEN DO;
      778     5852        /*
      779     5853              Calc control fields don't have a CDSN on the FR.
      780     5854        */
      781     5855    3               IF ERROR_FLG = 0
      782     5856    4               THEN DO;
      783     5857    4                   CALL FINDOS_6('SSSM-CF '); /* find SS for CF */
      784     5858    4                   CALL FINDOS_6('SM-SS   '); /* find SM for CF */
      785     5859    4                   CALL FETCHOS_6('SC-SOSM '); /* find SC for CF */
      786     5860    5                   IF UWA.SC.ALTOWN ~= 2 THEN DO; /* for THEN THRU CFs */
      787     5861         /* don't flag as errors */
      788     5862    5                       CALL ERROR(%ZIG_NO_CF_FR);
      789     5863        /*E*     ERROR:    ZIG-ZIG_NO_CF_FR-C
      790     5864        MESSAGE: This CF record is not already in the schema subset from
      791     5865                 the set information.
      792     5866                 <<<< SOFTWARE ERROR >>>>
      793     5867        */
      794     5868    5                       CALL ABORT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:26   
      795     5869    5                       END;
      796     5870    4                   END; /* ERROR not zero */
      797     5871    3               T1PTR$ -> CD.CDSH = LAST_FR;
      798     5872    3               T1PTR$ -> CD.CDSN = FR.CDSN;
      799     5873    3               FR.CDSN = CURRENT_CF;
      800     5874    3               IF TYPE_430.REF_LINE ~= 0
      801     5875    4               THEN DO;
      802     5876    4                   T5PTR$ = PINCRW(SSS$,T1PTR$ -> CD.RSCDH);
      803     5877    4                   IF T5PTR$ -> RS.DEF.TYPE = '000000001000'B
      804     5878    5                   THEN DO;
      805     5879    5                       T5PTR$ = PINCRW(SSS$,T5PTR$ -> SS.RSSSH);
      806     5880    5                       TYPE_34.THEN_THRU_FIELD = '1'B;
      807     5881    5                       END;
      808     5882    5                   ELSE DO;
      809     5883    5                       TYPE_34.THEN_THRU_FIELD = '0'B;
      810     5884    5                       END;
      811     5885    4                   T6PTR$ = PINCRW(SSS$,T5PTR$ -> RS.SCRSH);
      812     5886    4                   IF SUBSTR(T6PTR$ -> SC.SNAM,0,1) = '*'
      813     5887    5                   THEN DO;
      814     5888    5                       IF T6PTR$ -> SC.SNAM = '*CALC'
      815     5889    6                       THEN DO;
      816     5890    6                           TYPE_430.PRIMARY_CON_FIELD = '1'B;
      817     5891    6                           END;
      818     5892    5                       END;
      819     5893    5                   ELSE DO;
      820     5894    5                       IF NOT T6PTR$->SC.DEF.SRCR
      821     5895    6                       THEN DO;
      822     5896    6                           IF (T6PTR$->SC.DEF.SETT = 3) OR (T6PTR$->SC.DEF.SETT = 2)
      823     5897    7                           THEN DO;
      824     5898    7                               TYPE_35.FIELD_NAME = TYPE_430.OFFSET;
      825     5899    7                               TYPE_35.KEY_NAME = T6PTR$ -> SC.SCID;
      826     5900    7                               TYPE_35.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;
      827     5901    7                               TYPE_35.SUB_KEY_NM = T6PTR$ -> SC.SNAM;
      828     5902    7                               TYPE_35.SUB_RECORD_NM = RC.RNAM;
      829     5903    7                               CALL UPUT('5*',ADDR(TYPE_35),32);
      830     5904    7                               END;
      831     5905    7                           ELSE DO;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:27   
      832     5906    7                               TYPE_34.ASSEND_OR_DESCEND = T1PTR$ -> CD.DEF.CONT;
      833     5907    7                               TYPE_34.FIELD_NAME = TYPE_430.OFFSET;
      834     5908    7                               TYPE_34.SET_NAME = T6PTR$ -> SC.SCID;
      835     5909    7                               TYPE_34.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;
      836     5910    7                               TYPE_34.SUB_SET_NM = T6PTR$ -> SC.SNAM;
      837     5911    7                               TYPE_34.SUB_RECORD_NM = RC.RNAM;
      838     5912    7                               CALL UPUT('5*',ADDR(TYPE_34),32);
      839     5913    7                               END;
      840     5914    6                           CONTROL.NUM_FIELD_SET = CONTROL.NUM_FIELD_SET + 1;
      841     5915    6                           END;
      842     5916    5                       END;
      843     5917    4                   END;
      844     5918    3               END;
      845     5919    2           END;
      846     5920    1   END_CFS:
      847     5921    1       CALL FCURR_R_6('FR  ');
      848     5922    2       DO WHILE ('1'B);
      849     5923    2           CALL FETCHNS_6('FR-CFR   ') ALTRET(END_CFR);
      850     5924    2           SAVE_CF_DBK = UWA.DIRECT_REF;
      851     5925        /*
      852     5926              Now search the hash table for the DBK that is in that CF record
      853     5927            so we can find the offset in the schema subset.
      854     5928        */
      855     5929    2           CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);
      856     5930    2           IF UWA.C_F.CTRLTYPE ~= 4 OR ERROR_FLG ~= 0
      857     5931    3           THEN DO;
      858     5932        /*
      859     5933              Calc control fields don't have a CDRN on the FR.
      860     5934        */
      861     5935    3               IF ERROR_FLG = 0
      862     5936    4               THEN DO;
      863     5937    4                   CALL ERROR(%ZIG_NO_CF_FR);
      864     5938        /*       ERROR:    ZIG-ZIG_NO_CF_FR-C
      865     5939        MESSAGE: This CF record is not already in the schema subset from
      866     5940                 the set information.
      867     5941                 <<<< SOFTWARE ERROR >>>>
      868     5942        */
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:28   
      869     5943    4                   CALL ABORT;
      870     5944    4                   END;
      871     5945    3               T1PTR$ -> CD.CDRH = LAST_FR;
      872     5946    3               T1PTR$ -> CD.CDRN = FR.CDRN;
      873     5947    3               FR.CDRN = CURRENT_CF;
      874     5948    3               IF TYPE_430.REF_LINE ~= 0
      875     5949    4               THEN DO;
      876     5950    4                   T5PTR$ = PINCRW(SSS$,T1PTR$ -> CD.RSCDH);
      877     5951    4                   IF T5PTR$ -> RS.DEF.TYPE = '000000001000'B
      878     5952    5                   THEN DO;
      879     5953    5                       T5PTR$ = PINCRW(SSS$,T5PTR$ -> SS.RSSSH);
      880     5954    5                       END;
      881     5955    4                   T6PTR$ = PINCRW(SSS$,T5PTR$ -> RS.SCRSH);
      882     5956    4                   IF SUBSTR(T6PTR$ -> SC.SNAM,0,1) = '*'
      883     5957    5                   THEN DO;
      884     5958    5                       IF T6PTR$ -> SC.SNAM = '*CALC'
      885     5959    6                       THEN DO;
      886     5960    6                           TYPE_430.PRIMARY_CON_FIELD = '1'B;
      887     5961    6                           END;
      888     5962    5                       END;
      889     5963    5                   ELSE DO;
      890     5964    5                       IF NOT T6PTR$->SC.DEF.SRCR
      891     5965    6                       THEN DO;
      892     5966    6                           IF (T6PTR$ -> SC.DEF.SETT = 3) OR (T6PTR$->SC.DEF.SETT = 2)
      893     5967    7                           THEN DO;
      894     5968    7                               TYPE_35.FIELD_NAME = TYPE_430.OFFSET;
      895     5969    7                               TYPE_35.KEY_NAME = T6PTR$ -> SC.SCID;
      896     5970    7                               TYPE_35.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;
      897     5971    7                               TYPE_35.SUB_KEY_NM = T6PTR$ -> SC.SNAM;
      898     5972    7                               TYPE_35.SUB_RECORD_NM = RC.RNAM;
      899     5973    7                               CALL UPUT('5*',ADDR(TYPE_35),32);
      900     5974    7                               END;
      901     5975    7                           ELSE DO;
      902     5976    7                               TYPE_34.FIELD_NAME = TYPE_430.OFFSET;
      903     5977    7                               TYPE_34.SET_NAME = T6PTR$ -> SC.SCID;
      904     5978    7                               TYPE_34.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;
      905     5979    7                               TYPE_34.SUB_SET_NM = T6PTR$ -> SC.SNAM;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:29   
      906     5980    7                               TYPE_34.SUB_RECORD_NM = RC.RNAM;
      907     5981    7                               CALL UPUT('5*',ADDR(TYPE_34),32);
      908     5982    7                               END;
      909     5983    6                           CONTROL.NUM_FIELD_SET = CONTROL.NUM_FIELD_SET + 1;
      910     5984    6                           END;
      911     5985    5                       END;
      912     5986    4                   END;
      913     5987    3               END;
      914     5988    2           END;
      915     5989    1   END_CFR:
      916     5990    1       IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;
      917     5991    1       IF ~TYPE_430.ELEMENTARY
      918     5992    2       THEN DO;
      919     5993    2           IN_GROUP = '1'B;
      920     5994    2           LAST_GROUP_LEVEL = TYPE_430.LEVEL_FIELD;
      921     5995    2           IF UWA.FR.FTYPE = 1 OR
      922     5996    2              UWA.FR.FTYPE = 2 OR
      923     5997    2              UWA.FR.FTYPE = 3 OR
      924     5998    2              UWA.FR.FTYPE = 5 OR
      925     5999    2              UWA.FR.FTYPE = 7 OR
      926     6000    2              UWA.FR.FTYPE = 9 OR
      927     6001    2              UWA.FR.FTYPE = 10 OR
      928     6002    2              UWA.FR.FTYPE = 13 OR
      929     6003    2              UWA.FR.FTYPE = 14 OR
      930     6004    2              UWA.FR.FTYPE = 19
      931     6005    3           THEN DO;
      932     6006        /*
      933     6007              Group item is ok for this data type.
      934     6008        */
      935     6009    3               IF UWA.FR.PREC < TYPE_430.LEN_FIELD
      936     6010    4               THEN DO;
      937     6011    4                   CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);
      938     6012    4                   I = RC.DEF.RNL;
      939     6013    4                   CALL SET_FIELDS(2,I,RC.RNAM);
      940     6014    4                   CALL WARNING(%ZIG_V_GROUP_TO_BIG);
      941     6015        /*E*     ERROR:    ZIG-ZIG_V_GROUP_TO_BIG-C
      942     6016        MESSAGE: For the group named "%U1" in the record "%U2"
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:30   
      943     6017                 the length in the subschema is longer than the maximum
      944     6018                 length for the item in the schema file.
      945     6019                 The items after the schema length will not be put
      946     6020                 into the area and a get will not fill this space.
      947     6021                 Note: treated as a user defined variable in the UWA.
      948     6022        */
      949     6023    4                   END;
      950     6024    3               END;
      951     6025    3           ELSE DO;
      952     6026    3               CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);
      953     6027    3               I = RC.DEF.RNL;
      954     6028    3               CALL SET_FIELDS(2,I,RC.RNAM);
      955     6029    3               CALL ERROR(%ZIG_V_GROUP_BAD_DATA);
      956     6030        /*E*     ERROR:    ZIG-ZIG_V_GROUP_BAD_DATA-C
      957     6031        MESSAGE: For the group named "%U1" in the record "%U2"
      958     6032                 the schema data type does not allow groups under it.
      959     6033                 The allowed group data types are:
      960     6034                      BINARY 18,36,72
      961     6035                      CHARACTER ,UNSPEC
      962     6036                      OR UNSIGNED PACKED DEC.
      963     6037        */
      964     6038    3               FIELD_ERRORED = '1'B;
      965     6039    3               END;
      966     6040    2           END;
      967     6041    1       CALL GET_ENCODE_DECODE;
      968     6042    1       IF TYPE_430.REF_LINE ~= 0
      969     6043    2       THEN DO;
      970     6044    2           TYPE_430.INFO = FR.DEF;
      971     6045    2           IF UWA.FR.FTYPE = 0
      972     6046    2           THEN TYPE_430.SCHEMA_DBKEY = '1'B;
      973     6047    2           ELSE TYPE_430.SCHEMA_DBKEY = '0'B;
      974     6048    2           IF FIELD_ERRORED
      975     6049    3           THEN DO;
      976     6050    3               TYPE_430.FLAGS.TYPE = '111111111110'B;
      977     6051    3               CONTROL.BITS.ALL_FIELDS = '0'B;
      978     6052    3               END;
      979     6053    2           CALL WRITSF(CURRENT_RECORD,IO_BUF);
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:31   
      980     6054    2           IF VALIDS.RECORD_XREF
      981     6055    3           THEN DO;
      982     6056    3               I = FR.UOFST.EIS.FRID/8;
      983     6057    3               CALL SET_FIELD_NUM(1,I);
      984     6058    3               WORD_OFFSET = ' ';
      985     6059    3               CALL INSERT(WORD_OFFSET,5-FIELD1.COUNT1,FIELD1.COUNT1,
      986     6060    3                  SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      987     6061    3               I = ( FR.UOFST.EIS.FRID - (I * 8)) / 2;
      988     6062    3               CALL SET_FIELD_NUM(1,I);
      989     6063    3               I = MOD( FR.UOFST.EIS.FRID, 2);
      990     6064    3               IF I = 1
      991     6065    4               THEN DO;
      992     6066    4                   NIBLE_OFF = '1';
      993     6067    4                   END;
      994     6068    4               ELSE DO;
      995     6069    4                   NIBLE_OFF = '0';
      996     6070    4                   END;
      997     6071    3               CALL CONCAT(NUM_OFF,WORD_OFFSET,' ',SUBSTR(FIELD1.TEXT1,0,1),
      998     6072    3                  ' ',NIBLE_OFF);
      999     6073    3               IF FIRST_FIELD
     1000     6074    4               THEN DO;
     1001     6075    4                   FIRST_FIELD = '0'B;
     1002     6076    4                   HEADING_FIELD = '    DEFINED FIELD-NAMES: ';
     1003     6077    4                   END;
     1004     6078    4               ELSE DO;
     1005     6079    4                   HEADING_FIELD = ' ';
     1006     6080    4                   END;
     1007     6081    3               IF TYPE_430.ALIASED
     1008     6082    4               THEN DO;
     1009     6083    4                   CALL FIND_LENGTH(TYPE_430.SUB_FIELD_NAME,I);
     1010     6084    4                   CALL FIND_LENGTH(TYPE_430.FIELD_NAME,K);
     1011     6085    4                   CALL CONCAT(LIST_STRING,HEADING_FIELD,NUM_OFF,
     1012     6086    4                      SUBSTR(TYPE_430.SUB_FIELD_NAME,0,I),
     1013     6087    4                      ' ( NEE ',SUBSTR(TYPE_430.FIELD_NAME,0,K),' )');
     1014     6088    4                   END;
     1015     6089    4               ELSE DO;
     1016     6090    4                   CALL CONCAT(LIST_STRING,HEADING_FIELD,
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:32   
     1017     6091    4                      NUM_OFF,TYPE_430.SUB_FIELD_NAME);
     1018     6092    4                   END;
     1019     6093        /*
     1020     6094                      To print *CALC when location mode is calc
     1021     6095        */
     1022     6096    3               IF TYPE_430.PRIMARY_CON_FIELD
     1023     6097    4               THEN DO;
     1024     6098    4                   TEMP_STRING = LIST_STRING;
     1025     6099    4                   IF TYPE_430.ALIASED
     1026     6100    4                   THEN I = 105;
     1027     6101    4                   ELSE I = 65;
     1028     6102    4                   CALL CONCAT(LIST_STRING,SUBSTR(TEMP_STRING,0,I),' (*CALC)');
     1029     6103    4                   END;
     1030     6104    3               IF TYPE_35.SUB_KEY_NM ~= ' '
     1031     6105    4               THEN DO;
     1032     6106    4                   CALL FIND_LENGTH(TYPE_35.SUB_KEY_NM,I);
     1033     6107    4                   IF TYPE_430.ALIASED
     1034     6108    4                   THEN K = 90;
     1035     6109    4                   ELSE K = 75;
     1036     6110    4                   CALL INSERT(LIST_STRING,K,I+2,'(',
     1037     6111    4                      SUBSTR(TYPE_35.SUB_KEY_NM,0,I),')');
     1038     6112    4                   TYPE_35.SUB_KEY_NM = ' ';
     1039     6113    4                   END;
     1040     6114    3               CALL LIST(LIST_STRING);
     1041     6115    3               END;
     1042     6116    2           END;
     1043     6117    1       RETURN;
     1044     6118    1   END ZIG$V_FIELD;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:33   
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_FIELD.

   Procedure ZIG$V_FIELD requires 1274 words for executable code.
   Procedure ZIG$V_FIELD requires 54 words of local(AUTO) storage.

    No errors detected in file ZIG$V_FIELD.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:34   

 Object Unit name= ZIG$V_FIELD                                File name= ZIG$V_FIELD.:ZIC0TOU
 UTS= SEP 05 '97 12:20:25.64 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  SN_DBK
    1  LblCom even  none    12     14  ANALS
    2  LblCom even  none    13     15  PURGE
    3  LblCom even  none    19     23  DICTS
    4  LblCom even  none    23     27  DISPS
    5  LblCom even  none    22     26  VALIDS
    6  LblCom even  none    12     14  LOCKS
    7  LblCom even  none    10     12  STRAN
    8  LblCom even  none    12     14  DTRAN
    9  LblCom even  none    16     20  SSTRANS
   10  LblCom even  none    20     24  SSGEN
   11  LblCom even  none     5      5  LANG_ALLOWED
   12  LblCom even  none     1      1  SUB_LANGUAGE
   13  LblCom even  none    16     20  HEADING_TEXT
   14  LblCom even  none    13     15  LANG_TEXT
   15  LblCom even  none     1      1  HASH_SCHEMA_NAME
   16  LblCom even  none     1      1  CURRENT_RECORD
   17  LblCom even  none    64    100  CONTROL
   18  LblCom even  none    32     40  IO_BUF
   19  LblCom even  none    32     40  DESC_TYPE_9
   20  LblCom even  none    32     40  TYPE_34
   21  LblCom even  none    32     40  TYPE_35
   22  LblCom even  none     1      1  NUM_ERROR_MSG
   23  LblCom even  none     1      1  NUM_WARN_MSG
   24  LblCom even  none     1      1  ALLOCATE_END
   25  LblCom even  none     2      2  SUBSCHEMA_KEY
   26  LblCom even  none     1      1  BUFFER$
   27  LblCom even  none     1      1  ERROR_IO
   28  LblCom even  none     1      1  BUFFER_LEN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:35   
   29  LblCom even  none     2      2  UWA_KEY
   30  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   31  LblCom even  none     2      2  RVA_KEY
   32  LblCom even  none     2      2  IA__KEY
   33  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   34  LblCom even  none    32     40  SEARCHR_NB
   35  LblCom even  none    32     40  SEM_COM
   36  LblCom even  none    32     40  DMCL_XLATE
   37  LblCom even  none    32     40  Q2_PERCENT
   38  LblCom even  none     1      1  SSS$
   39  LblCom even  none     1      1  OA$
   40  LblCom even  none     1      1  OA1$
   41  LblCom even  none     1      1  RC$
   42  LblCom even  none     1      1  RC1$
   43  LblCom even  none     1      1  DP$
   44  LblCom even  none     1      1  DP1$
   45  LblCom even  none     1      1  FR$
   46  LblCom even  none     1      1  FR1$
   47  LblCom even  none     1      1  CD$
   48  LblCom even  none     1      1  RS$
   49  LblCom even  none     1      1  SC$
   50  LblCom even  none     1      1  SS$
   51  LblCom even  none   656   1220  UWA
   52   Data  even  none    63     77  ZIG$V_FIELD
   53  LblCom even  none     1      1  FIRST_FIELD
   54  LblCom even  none     1      1  CUR_EXT_NAME_SEG
   55  LblCom even  none     1      1  IN_GROUP
   56  LblCom even  none     1      1  LAST_GROUP_LEVEL
   57  LblCom even  none     1      1  CURRENT_OFF
   58  LblCom even  none     1      1  LAST_RC
   59  LblCom even  none     1      1  LAST_FR
   60  LblCom even  none     1      1  LAST_SC
   61  LblCom even  none     1      1  CURRENT_CF
   62  LblCom even  none    32     40  LIST_STRING
   63  LblCom even  none     1      1  RECORD_NUM
   64  LblCom even  none     1      1  CF_PTR$
   65  LblCom even  none     1      1  FIELD_ERRORED
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:36   
   66  LblCom even  none     8     10  FIELD1
   67  RoData even  UTS    432    660  ZIG$V_FIELD
   68   Proc  even  none  1274   2372  ZIG$V_FIELD
   69  RoData even  none    81    121  ZIG$V_FIELD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    68      0   yes            yes      Std        0  ZIG$V_FIELD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 WRITSF
         yes           Std       2 READSF
         yes           Std       8 ZIG$HASH_IT
         yes           Std       3 SET_FIELDS
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHOS_6
         yes           Std       0 ZIG$ADD_SI
         yes           Std       3 UPUT
         yes           Std       2 SET_FIELD_NUM
         yes           Std       1 LIST
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       1 FETCHNS_6
         yes           Std       1 WARNING
 yes     yes           Std       1 FINDOS_6
         yes           Std       2 ZIG$G_DYN_MEM_6
         yes           Std       1 ERROR
         yes           Std       0 ABORT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:37   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:38   


        1        1        /*M*     ZIG$V_FIELD      I-D-S/II       DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_FIELD
        9        9        PURPOSE:
       10       10              To put all the fields for the current record in the schema
       11       11            subset. To find the connection for the type_430 descriptors
       12       12            and the schemas items for the current record.
       13       13
       14       14              This connection is not the easiest thing in the world since
       15       15            COBOL has group items and the may or may not be in the schema
       16       16            record.
       17       17
       18       18              One other thing; the names of all the fields for the current
       19       19            record are in the ALT HASH TABLE for easy finding and to save
       20       20            CLIMBs to IDS for every item in this record.
       21       21
       22       22        */
       23       23        /*
       24       24        ZZZZZ  III   GGG    $   V   V       FFFFF  III  EEEEE L     DDDD
       25       25            Z   I   G   G  $$$  V   V       F       I   E     L     D   D
       26       26           Z    I   G     $ $   V   V       F       I   E     L     D   D
       27       27          Z     I   G      $$$  V   V       FFFF    I   EEEE  L     D   D
       28       28         Z      I   G  GG   $ $ V   V       F       I   E     L     D   D
       29       29        Z       I   G   G  $$$   V V        F       I   E     L     D   D
       30       30        ZZZZZ  III   GGG    $     V         F      III  EEEEE LLLLL DDDD
       31       31                                      _____
       32       32        */
       33       33        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:39   
       34       34        ZIG$V_FIELD:
       35       35            PROC;

     35 68 000000   000000 700200 xent  ZIG$V_FIELD  TSX0  ! X66_AUTO_0
        68 000001   000066 000000                    ZERO    54,0
        68 000002   000623 710000 68                 TRA     s:5721

       36       36    1   DCL ZIG$HASH_IT ENTRY (8);
       37       37    1   DCL READSF ENTRY (2);
       38       38    1   DCL WRITSF ENTRY (2);
       39       39    1   DCL ZIG$ADD_SI ENTRY;
       40       40    1   DCL SN_DBK UBIN (36) EXT;
       41       41        %INCLUDE ZI_ERRORS_SUBS;
       42      561        %INCLUDE ZI_SUB_LANG;
       43     2276        %INCLUDE ZIG_DIR_STRUCS;
       44     2406        %GENERAL;
       45     2530        %CONTROL_BLOCK;
       46     2638    1   DCL IO_BUF CHAR (128) EXT;
       47     2639        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
       48     2798        %DESC_TYPE_9;
       49     2975        %DESC_TYPE_34;
       50     3023        %DESC_TYPE_35;
       51     3062        %INCLUDE ZIG_GENERAL;
       52     3170        %INCLUDE ZIG_TYPE_SUBS;
       53     3185        %INCLUDE ZIG_SSS;
       54     3755        %SS_GENERAL(PSTCLASS=EXT);
       55     3776        %OA(PSTCLASS=EXT);
       56     3843        %OA1(PSTCLASS=EXT);
       57     3851        %RC(PSTCLASS=EXT);
       58     3884        %RC1(PSTCLASS=EXT);
       59     3894        %DP(PSTCLASS=EXT);
       60     3908        %DP1(PSTCLASS=EXT);
       61     3916        %FR(PSTCLASS=EXT);
       62     3962        %FR1(PSTCLASS=EXT);
       63     3970        %CD(PSTCLASS=EXT);
       64     3989        %RS(PSTCLASS=EXT);
       65     4063        %SC(PSTCLASS=EXT);
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:40   
       66     4090        %SS(PSTCLASS=EXT);
       67     4104        %INCLUDE ZIG_DBA_INT;
       68     4152        %INCLUDE ZI_SUB4_CAN;
       69     4809        %UWA;
       70     5144        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:41   
       71     5145    1   DCL I UBIN (36) STATIC;
       72     5146    1   DCL K UBIN (36) STATIC;
       73     5147    1   DCL HEADING_FIELD CHAR (25) STATIC;
       74     5148    1   DCL FIRST_FIELD BIT (1) EXT;
       75     5149    1   DCL CUR_EXT_NAME_SEG UBIN (36) EXT;
       76     5150    1   DCL IN_GROUP BIT (1) EXT;
       77     5151    1   DCL LAST_GROUP_LEVEL UBIN (36) EXT;
       78     5152    1   DCL TPTR$ PTR;
       79     5153    1   DCL L_SUBSCH_FR UBIN (36);
       80     5154    1   DCL SUCC BIT (1);
       81     5155    1   DCL CURRENT_OFF UBIN (36) EXT;
       82     5156    1   DCL STATUS UBIN (6);
       83     5157    1   DCL ERROR_FLG UBIN (36) STATIC;
       84     5158    1   DCL LAST_RC UBIN (18) EXT;
       85     5159    1   DCL LAST_FR UBIN (18) EXT;
       86     5160    1   DCL LAST_SC UBIN (18) EXT;
       87     5161    1   DCL CURRENT_CF UBIN (18) EXT;
       88     5162    1   DCL LIST_STRING CHAR (128) EXT;
       89     5163    1   DCL TEMP_STRING CHAR (128);
       90     5164    1   DCL T1PTR$ PTR;
       91     5165    1   DCL T5PTR$ PTR STATIC;
       92     5166    1   DCL T6PTR$ PTR STATIC;
       93     5167    1   DCL T_OFF UBIN (18);
       94     5168    1   DCL WORD36 UBIN (36) BASED;
       95     5169    1   DCL RECORD_NUM UBIN (36) EXT;
       96     5170    1   DCL SAVE_DBK UBIN (36) STATIC;
       97     5171    1   DCL SAVE_CF_DBK UBIN (36) STATIC;
       98     5172    1   DCL CF_PTR$ PTR EXT;
       99     5173    1   DCL 1 CF_STR BASED,
      100     5174    1         2 NPTR$ PTR,
      101     5175    1         2 COUNT UBIN (36),
      102     5176    1         2 STR CHAR (CF_STR.COUNT);
      103     5177    1   DCL CF_TPTR$ PTR;
      104     5178    1   DCL START_N UBIN (36) STATIC;
      105     5179    1   DCL ZERO_A UBIN (36) STATIC INIT (0);
      106     5180    1   DCL CHAR2 CHAR (2) BASED;
      107     5181    1   DCL BASED_PTR$ PTR BASED;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:42   
      108     5182    1   DCL FIELD_ERRORED BIT (1) EXT;
      109     5183    1   DCL DESCPTR PTR STATIC INIT (ADDR(BUFFER1));
      110     5184    1   DCL BUFFER1 CHAR (128) STATIC;
      111     5185    1   DCL BUFFER_TEMP CHAR (128) BASED (DESCPTR);
      112     5186    1   DCL EOF UBIN (36) STATIC;
      113     5187    1   DCL BUFFER_SIZE UBIN (36) STATIC;
      114     5188    1   DCL 1 FIELD1 EXT,
      115     5189    1         2 COUNT1 UBIN (9) UNAL,
      116     5190    1         2 TEXT1 CHAR (31) UNAL;
      117     5191    1   DCL WORD_OFFSET CHAR (6) STATIC;
      118     5192    1   DCL NIBLE_OFF CHAR (1) STATIC;
      119     5193    1   DCL NUM_OFF CHAR (12) STATIC;
      120     5194        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:43   
      121     5195         /*
      122     5196            Data type info
      123     5197         */
      124     5198    1   DCL VALID_STYPE(0:20) CONSTANT BIT(1) UNAL INIT(
      125     5199    1    '0'B,'1'B*6,'0'B,'1'B,'0'B,'1'B,'0'B,'1'B*2,'0'B*6,'1'B);
      126     5200    1   DCL VALID_CSSTYPE(0:28) CONSTANT BIT(1) UNAL INIT(
      127     5201    1    '0'B,'1'B*15,'0'B*13);
      128     5202    1   DCL VALID_FSSTYPE(0:28) CONSTANT BIT(1) UNAL INIT(
      129     5203    1    '0'B,'1'B,'0'B,'1'B,'0'B*10,'1'B*6,'0'B*9);
      130     5204    1   DCL SCHEMA_CC(0:19) ALIGNED BIT(3) CONSTANT INIT(
      131     5205    1    '000'B,'010'B,'010'B,'001'B,'001'B,
      132     5206    1    '000'B,'011'B,'010'B,'000'B,'000'B,
      133     5207    1    '100'B,'101'B,'101'B,'011'B,'011'B,
      134     5208    1    '000'B,'000'B,'000'B,'000'B,'000'B);
      135     5209    1   DCL STYPE6(0:19) CONSTANT UNAL BIT(6) INIT(
      136     5210    1    '000001'B,
      137     5211    1    '000010'B,
      138     5212    1    '001101'B,
      139     5213    1    '000011'B,
      140     5214    1    '000101'B,
      141     5215    1    '000000'B,
      142     5216    1    '001110'B,
      143     5217    1    '001111'B,
      144     5218    1    '010000'B,
      145     5219    1    '010001'B,
      146     5220    1    '010011'B,
      147     5221    1    '010100'B,
      148     5222    1    '010101'B,
      149     5223    1    '001110'B,
      150     5224    1    '010010'B,
      151     5225    1    '010110'B,
      152     5226    1    '010111'B,
      153     5227    1    '011000'B,
      154     5228    1    '011001'B,
      155     5229    1    '000000'B);
      156     5230    1   DCL DECIMAL(0:19) UNAL BIT(1) CONSTANT INIT(
      157     5231    1    '0'B,'0'B,'0'B,'1'B,'1'B,'0'B,
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:44   
      158     5232    1    '0'B,'0'B,'0'B,'0'B,'0'B,'1'B,
      159     5233    1    '1'B,'1'B,'1'B,'0'B*5);
      160     5234    1   DCL TN_S(0:27) UNAL BIT(3) CONSTANT INIT(
      161     5235    1    /*  0 */ '000'B,
      162     5236    1    /*  1 */ '000'B,
      163     5237    1    /*  2 */ '000'B,
      164     5238    1    /*  3 */ '111'B,
      165     5239    1    /*  4 */ '110'B,
      166     5240    1    /*  5 */ '110'B,
      167     5241    1    /*  6 */ '011'B,
      168     5242    1    /*  7 */ '001'B,
      169     5243    1    /*  8 */ '010'B,
      170     5244    1    /*  9 */ '011'B,
      171     5245    1    /* 10 */ '011'B,
      172     5246    1    /* 11 */ '000'B,
      173     5247    1    /* 12 */ '000'B,
      174     5248    1    /* 13 */ '000'B,
      175     5249    1    /* 14-27*/'000'B*14);
      176     5250    1   DCL M(0:27) CONSTANT UBIN (9) UNAL INIT(
      177     5251    1    2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,
      178     5252    1    2,2,2,2,2);
      179     5253    1   DCL NUMERIC(0:27) CONSTANT ALIGNED BIT(1) INIT(
      180     5254    1    '0'B,'0'B,'0'B,'1'B*8,'0'B*17);
      181     5255         /*
      182     5256            Cki tables
      183     5257         */
      184     5258         /* Validation check and encode flags */
      185     5259    1   DCL FLAG_TAB (0:63) BIT(12) CONSTANT UNAL INIT(
      186     5260         /*
      187     5261            ffffffffffee
      188     5262            1234567891BB
      189     5263            0CS           cki
      190     5264            ::::::::::::
      191     5265         */
      192     5266    1   '000000100000'B, /* 0*/
      193     5267    1   '100000000011'B, /* 1*/
      194     5268    1   '000000000000'B, /* 2*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:45   
      195     5269    1   '000000000011'B, /* 3*/
      196     5270    1   '010000000011'B, /* 4*/
      197     5271    1   '000000000011'B, /* 5*/
      198     5272    1   '000000000011'B, /* 6*/
      199     5273    1   '000100000011'B, /* 7*/
      200     5274    1   '000100000011'B, /* 8*/
      201     5275    1   '000100000011'B, /* 9*/
      202     5276    1   '000100000011'B, /*10*/
      203     5277    1   '000100000011'B, /*11*/
      204     5278    1   '000000000011'B, /*12*/
      205     5279    1   '000000000011'B, /*13*/
      206     5280    1   '000000000011'B, /*14*/
      207     5281    1   '010010000011'B, /*15*/
      208     5282    1   '000000000011'B, /*16*/
      209     5283    1   '000010000011'B, /*17*/
      210     5284    1   '000001000010'B, /*18*/
      211     5285    1   '000000000010'B, /*19*/
      212     5286    1   '000000000010'B, /*20*/
      213     5287    1   '000000000010'B, /*21*/
      214     5288    1   '000000000011'B, /*22*/
      215     5289    1   '000000000011'B, /*23*/
      216     5290    1   '000010000011'B, /*24*/
      217     5291    1   '000000000011'B, /*25*/
      218     5292    1   '000010000011'B, /*26*/
      219     5293    1   '000000000010'B, /*27*/
      220     5294    1   '000000000010'B, /*28*/
      221     5295    1   '000000000011'B, /*29*/
      222     5296    1   '000000000011'B, /*30*/
      223     5297    1   '000010000011'B, /*31*/
      224     5298    1   '000001000010'B, /*32*/
      225     5299    1   '001000000011'B, /*33*/
      226     5300    1   '001100000011'B, /*34*/
      227     5301    1   '001100000011'B, /*35*/
      228     5302    1   '001100000011'B, /*36*/
      229     5303    1   '001100000011'B, /*37*/
      230     5304    1   '001000000011'B, /*38*/
      231     5305    1   '000000000011'B, /*39*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:46   
      232     5306    1   '000000000011'B, /*40*/
      233     5307    1   '000000000000'B, /*41*/
      234     5308    1   '000000010000'B, /*42*/
      235     5309    1   '000000000011'B, /*43*/
      236     5310    1   '000000000011'B, /*44*/
      237     5311    1   '000000000011'B, /*45*/
      238     5312    1   '000000000011'B, /*46*/
      239     5313    1   '000000000011'B, /*47*/
      240     5314    1   '000000000011'B, /* 48 */
      241     5315    1   '000000000011'B, /* 49 */
      242     5316    1   '000100000011'B, /* 50 */
      243     5317    1   '000100000011'B, /* 51 */
      244     5318    1   '000100000011'B, /* 52 */
      245     5319    1   '000100000011'B, /* 53 */
      246     5320    1   '000000000000'B*10); /*Avail*/
      247     5321    1   DCL 1 FLAG_TAB1 (0:63) REDEF FLAG_TAB UNAL,
      248     5322    1         2 F1 BIT (1) UNAL,
      249     5323    1         2 F2 BIT (1) UNAL,
      250     5324    1         2 F3 BIT (1) UNAL,
      251     5325    1         2 F4 BIT (1) UNAL,
      252     5326    1         2 F5 BIT (1) UNAL,
      253     5327    1         2 F6 BIT (1) UNAL,
      254     5328    1         2 F7 BIT (1) UNAL,
      255     5329    1         2 F8 BIT (1) UNAL,
      256     5330    1         2 F9 BIT (1) UNAL,
      257     5331    1         2 F10 BIT (1) UNAL,
      258     5332    1         2 EBC BIT (1) UNAL,
      259     5333    1         2 EBS BIT (1) UNAL;
      260     5334         /* Encode subroutines */
      261     5335    1   DCL EN (0:63) UBIN (9) CONSTANT UNAL INIT(
      262     5336        /*   Name     cki      */
      263     5337    1   0, /* 0*/
      264     5338    1   0, /* 1*/
      265     5339    1   1, /* 2*/
      266     5340    1   1, /* 3*/ /* Changed from GCOS  DRP */
      267     5341    1   6, /* 4*/
      268     5342    1   33, /* 5*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:47   
      269     5343    1   35, /* 6*/
      270     5344    1   7, /* 7*/
      271     5345    1   7, /* 8*/
      272     5346    1   7, /* 9*/
      273     5347    1   13, /*10*/
      274     5348    1   14, /*11*/
      275     5349    1   8, /*12*/
      276     5350    1   36, /*13*/
      277     5351    1   12, /*14*/
      278     5352    1   2, /*15*/
      279     5353    1   34, /*16*/
      280     5354    1   24, /*17*/
      281     5355    1   3, /*18*/
      282     5356    1   23, /*19*/
      283     5357    1   23, /*20*/
      284     5358    1   3, /*21*/
      285     5359    1   26, /*22*/
      286     5360    1   27, /*23*/
      287     5361    1   25, /*24*/
      288     5362    1   35, /*25*/
      289     5363    1   4, /*26*/
      290     5364    1   3, /*27*/
      291     5365    1   3, /*28*/
      292     5366    1   15, /*29*/
      293     5367    1   16, /*30*/
      294     5368    1   5, /*31*/
      295     5369    1   1, /*32*/
      296     5370    1   10, /*33*/
      297     5371    1   9, /*34*/
      298     5372    1   9, /*35*/
      299     5373    1   17, /*36*/
      300     5374    1   18, /*37*/
      301     5375    1   11, /*38*/
      302     5376    1   27, /*39*/
      303     5377    1   32, /*40*/
      304     5378    1   29, /*41*/
      305     5379    1   0, /*42*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:48   
      306     5380    1   36, /*43*/
      307     5381    1   37, /*44*/
      308     5382    1   38, /*45*/
      309     5383    1   39, /*46*/
      310     5384    1   38, /*47*/
      311     5385    1   40, /* 48 */
      312     5386    1   41, /* 49 */
      313     5387    1   43, /* 50 */
      314     5388    1   44, /* 51 */
      315     5389    1   42, /* 52 */
      316     5390    1   42, /* 53 */
      317     5391    1   0*10); /*AVAIL.*/
      318     5392         /* Decode subroutines */
      319     5393    1   DCL DN (0:63) UBIN (9) CONSTANT UNAL INIT(
      320     5394        /*   Name     cki      */
      321     5395    1   0, /* 0*/
      322     5396    1   0, /* 1*/
      323     5397    1   1, /* 2*/
      324     5398    1   1, /* 3*/ /* Changed from GCOS  DRP */
      325     5399    1   2, /* 4*/
      326     5400    1   34, /* 5*/
      327     5401    1   35, /* 6*/
      328     5402    1   24, /* 7*/
      329     5403    1   4, /* 8*/
      330     5404    1   3, /* 9*/
      331     5405    1   5, /*10*/
      332     5406    1   6, /*11*/
      333     5407    1   7, /*12*/
      334     5408    1   35, /*13*/
      335     5409    1   20, /*14*/
      336     5410    1   10, /*15*/
      337     5411    1   33, /*16*/
      338     5412    1   14, /*17*/
      339     5413    1   8, /*18*/
      340     5414    1   9, /*19*/
      341     5415    1   8, /*20*/
      342     5416    1   8, /*21*/
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:49   
      343     5417    1   11, /*22*/
      344     5418    1   12, /*23*/
      345     5419    1   13, /*24*/
      346     5420    1   36, /*25*/
      347     5421    1   14, /*26*/
      348     5422    1   25, /*27*/
      349     5423    1   9, /*28*/
      350     5424    1   11, /*29*/
      351     5425    1   12, /*30*/
      352     5426    1   13, /*31*/
      353     5427    1   1, /*32*/
      354     5428    1   15, /*33*/
      355     5429    1   16, /*34*/
      356     5430    1   17, /*35*/
      357     5431    1   16, /*36*/
      358     5432    1   16, /*37*/
      359     5433    1   18, /*38*/
      360     5434    1   26, /*39*/
      361     5435    1   30, /*40*/
      362     5436    1   27, /*41*/
      363     5437    1   0, /*42*/
      364     5438    1   36, /*43*/
      365     5439    1   38, /*44*/
      366     5440    1   37, /*45*/
      367     5441    1   38, /*46*/
      368     5442    1   39, /*47*/
      369     5443    1   40, /* 48 */
      370     5444    1   40, /* 49 */
      371     5445    1   43, /* 50 */
      372     5446    1   43, /* 51 */
      373     5447    1   41, /* 52 */
      374     5448    1   42, /* 53 */
      375     5449    1   0*10); /*AVAIL.*/
      376     5450         /* Cki value matrix */
      377     5451    1   DCL CMAP_CKI (0:559) UBIN (9) UNAL
      378     5452    1    CONSTANT INIT(
      379     5453         /* Schema  data   TYPE: Horizontal */
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:50   
      380     5454         /* Subschema data TYPE: Vertical */
      381     5455    1    1, 4, 4,15,15,32, 0, 4, 0, 3, 0,50,51, 0, 0, 0, 0, 0, 0,41,
      382     5456    1    2, 1, 1, 1, 1, 1, 0, 1, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,42,
      383     5457    1    2, 2,14,17,26,33, 0,39, 0, 3, 0,44,46, 0, 0, 0, 0, 0, 0, 0,
      384     5458    1    1, 7, 7,18,27,34, 0, 7, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      385     5459    1    1, 8, 8,19,28,35, 0, 8, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      386     5460    1    1, 9, 9,20,18,34, 0, 9, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      387     5461    1    1, 7, 7,21,27,34, 0, 7, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      388     5462    1    1, 9, 9,20,21,34, 0, 9, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      389     5463    1    1, 9, 9,20,21,34, 0, 8, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      390     5464    1    1,10,10,22,29,36, 0,10, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      391     5465    1    1,11,11,23,30,37, 0,11, 0, 3, 0,48,49, 0, 0, 0, 0, 0, 0,42,
      392     5466    1    1,12,12,24,31,38, 0,12, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,42,
      393     5467    1    1,12,12,24,31,38, 0,12, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,42,
      394     5468    1    1,45,45, 6,13,52, 0, 0, 0, 0, 0, 2, 5, 0, 0, 0, 0, 0, 0, 0,
      395     5469    1    1,47,47,25,43,53, 0, 0, 0, 0, 0,16, 2, 0, 0, 0, 0, 0, 0, 0,
      396     5470    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      397     5471    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      398     5472    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      399     5473    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      400     5474    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      401     5475    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      402     5476    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      403     5477    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      404     5478    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      405     5479    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      406     5480    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      407     5481    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      408     5482    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
      409     5483    1   DCL FMAP_CKI (0:559) UBIN (9)
      410     5484    1    CONSTANT UNAL INIT(
      411     5485    1    1, 4, 4,15,15,32, 0, 4, 0, 3, 0,50,51, 0, 0, 0, 0, 0, 0,41,
      412     5486    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      413     5487    1    2, 2,14,17,26,33, 0,39, 0, 3, 0,44,46, 0, 0, 0, 0, 0, 0, 0,
      414     5488    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      415     5489    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      416     5490    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:51   
      417     5491    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      418     5492    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      419     5493    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      420     5494    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      421     5495    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      422     5496    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      423     5497    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      424     5498    1    1,45,45, 6,13,52, 0, 0, 0, 0, 0, 2, 5, 0, 0, 0, 0, 0, 0, 0,
      425     5499    1    47,47,47,25,43,53, 0, 0, 0, 0, 0,16, 2, 0, 0, 0, 0, 0, 0, 0,
      426     5500    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      427     5501    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      428     5502    1    0,40,40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      429     5503    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      430     5504    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      431     5505    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      432     5506    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      433     5507    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      434     5508    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      435     5509    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      436     5510    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      437     5511    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      438     5512    1    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
      439     5513    1   DCL SSCALE UBIN (36) STATIC;
      440     5514    1   DCL SLENGTH UBIN (36) STATIC;
      441     5515    1   DCL 1 NEIS BASED ALIGNED,
      442     5516    1         2 * BIT (24) UNAL,
      443     5517    1         2 SCALE UBIN (6) UNAL,
      444     5518    1         2 LENGTH UBIN (6) UNAL;
      445     5519    1   DCL 1 AEIS BASED ALIGNED,
      446     5520    1         2 * BIT (24) UNAL,
      447     5521    1         2 LENGTH UBIN (12) UNAL;
      448     5522    1   DCL DPPROC BIT (1) STATIC;
      449     5523    1   DCL CKI UBIN (36) STATIC;
      450     5524    1   DCL CKIP UBIN (36) STATIC;
      451     5525        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:52   
      452     5526    1   FIND_LENGTH:

   5526 68 000003   200052 741300       FIND_LENGTH  STX1  ! CF_TPTR$+1,,AUTO

      453     5527    1       PROC(STRING_TO_GET,RETURN_LENGTH);
      454     5528    2   DCL RETURN_LENGTH UBIN (36);
      455     5529    2   DCL STRING_TO_GET CHAR (30);
      456     5530    2       CALL INDEX1(RETURN_LENGTH,' ',STRING_TO_GET) ALTRET(NOT_BLANK);

   5530 68 000004   200054 470500                    LDP0    @RETURN_LENGTH,,AUTO
        68 000005   200053 471500                    LDP1    @STRING_TO_GET,,AUTO
        68 000006   000000 124500                    SCM     mask='000'O
        68 000007   100000 000036                    ADSC9   0,,PR1                   cn=0,n=30
        68 000010   000000 000001 69                 ADSC9   0                        cn=0,n=1
        68 000011   000000 000100                    ARG     0,,PR0
        68 000012   000015 606400 68                 TTN     NOT_BLANK

      457     5531    2       RETURN;

   5531 68 000013   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000014   000001 702211                    TSX2  ! 1,X1

      458     5532    2   NOT_BLANK:
      459     5533    2       RETURN_LENGTH = 30;

   5533 68 000015   000036 235007       NOT_BLANK    LDA     30,DL
        68 000016   200054 470500                    LDP0    @RETURN_LENGTH,,AUTO
        68 000017   000000 755100                    STA     0,,PR0

      460     5534    2       RETURN;

   5534 68 000020   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000021   000001 702211                    TSX2  ! 1,X1

      461     5535    2   END FIND_LENGTH;
      462     5536        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:53   
      463     5537    1   FIND_CF:

   5537 68 000022   200052 741300       FIND_CF      STX1  ! CF_TPTR$+1,,AUTO

      464     5538    1       PROC(DBK,FOUND);
      465     5539    2   DCL DBK UBIN (36);
      466     5540    2   DCL FOUND UBIN (36);
      467     5541    2   DCL 1 SEARCH_STR,
      468     5542    2         2 STR CHAR(2) UNAL,
      469     5543    2         2 NUM REDEF STR UBIN (18) UNAL;
      470     5544    2   DCL T9PTR$ PTR STATIC;
      471     5545    2       SEARCH_STR.NUM = DBK;

   5545 68 000023   200053 470500                    LDP0    @DBK,,AUTO
        68 000024   000000 720100                    LXL0    0,,PR0
        68 000025   200055 740100                    STX0    SEARCH_STR,,AUTO

      472     5546    2       FOUND = 0;

   5546 68 000026   200054 471500                    LDP1    @FOUND,,AUTO
        68 000027   100000 450100                    STZ     0,,PR1

      473     5547    2       START_N = 0;

   5547 68 000030   000016 450000 52                 STZ     START_N

      474     5548    2       CF_TPTR$ = CF_PTR$;

   5548 68 000031   000000 236000 64                 LDQ     CF_PTR$
        68 000032   200051 756100                    STQ     CF_TPTR$,,AUTO

      475     5549    3       DO WHILE (CF_TPTR$ ~= ADDR(NIL));

   5549 68 000033   000147 710000 68                 TRA     s:5582

      476     5550    3           CALL INDEX2(I,SEARCH_STR.STR,CF_TPTR$ -> CF_STR.STR,START_N)

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:54   
   5550 68 000034   200051 470500                    LDP0    CF_TPTR$,,AUTO
        68 000035   000001 720100                    LXL0    1,,PR0
        68 000036   000000 636010                    EAQ     0,X0
        68 000037   000022 772000                    QRL     18
        68 000040   000016 136000 52                 SBLQ    START_N
        68 000041   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 000042   000016 236000 52                 LDQ     START_N
        68 000043   200056 720100                    LXL0    SEARCH_STR+1,,AUTO
        68 000044   000016 235000 52                 LDA     START_N
        68 000045   000100 120545                    SCD
        68 000046   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=*X0
        68 000047   200055 000002                    ADSC9   SEARCH_STR,,AUTO         cn=0,n=2
        68 000050   000000 000000 52                 ARG     I
        68 000051   000000 056000 52                 ASQ     I
        68 000052   000055 607000 68                 TTF     s:5552
        68 000053   000000 054000 52                 AOS     I
        68 000054   000143 710000 68                 TRA     INCREMENT

      477     5551    3              ALTRET(INCREMENT);
      478     5552    3           IF MOD(I,4) = 0

   5552 68 000055   000000 236000 52                 LDQ     I
        68 000056   000003 376007                    ANQ     3,DL
        68 000057   000137 601000 68                 TNZ     s:5575

      479     5553    4           THEN DO;

      480     5554    4               FOUND = 1;

   5554 68 000060   000001 236007                    LDQ     1,DL
        68 000061   200054 471500                    LDP1    @FOUND,,AUTO
        68 000062   100000 756100                    STQ     0,,PR1

      481     5555    4               ADDR(CURRENT_CF) -> CHAR2 = SUBSTR(CF_TPTR$ -> CF_STR.STR,I+2,2);

   5555 68 000063   000001 720100                    LXL0    1,,PR0
        68 000064   000000 235000 52                 LDA     I
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:55   
        68 000065   040000 100505                    MLR     fill='040'O
        68 000066   000002 400002                    ADSC9   2,A,PR0                  cn=2,n=2
        68 000067   000000 000002 61                 ADSC9   CURRENT_CF               cn=0,n=2

      482     5556    4               T1PTR$ = PINCRW(SSS$, CURRENT_CF);

   5556 68 000070   000000 236000 61                 LDQ     CURRENT_CF
        68 000071   777777 376003                    ANQ     -1,DU
        68 000072   000000 036000 38                 ADLQ    SSS$
        68 000073   200047 756100                    STQ     T1PTR$,,AUTO

      483     5557    4               IF T1PTR$ -> CD.DEF.RELT = 0

   5557 68 000074   200047 473500                    LDP3    T1PTR$,,AUTO
        68 000075   300000 236100                    LDQ     0,,PR3
        68 000076   000017 316003                    CANQ    15,DU
        68 000077   000135 601000 68                 TNZ     s:5572

      484     5558    5               THEN DO;

      485     5559    5                   T9PTR$ = PINCRW(SSS$, T1PTR$ -> CD.RSCDH);

   5559 68 000100   300001 721100                    LXL1    1,,PR3
        68 000101   000000 636011                    EAQ     0,X1
        68 000102   000000 036000 38                 ADLQ    SSS$
        68 000103   000076 756000 52                 STQ     T9PTR$

      486     5560    5                   IF T9PTR$ -> RS.DEF.TYPE = '0040'O

   5560 68 000104   000076 474400 52                 LDP4    T9PTR$
        68 000105   400000 236100                    LDQ     0,,PR4
        68 000106   777700 376003                    ANQ     -64,DU
        68 000107   004000 116003                    CMPQ    2048,DU
        68 000110   000135 601000 68                 TNZ     s:5572

      487     5561    6                   THEN DO;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:56   
      488     5562    6                       T9PTR$ = PINCRW(SSS$, T9PTR$ -> RS.SCRSH);

   5562 68 000111   400003 722100                    LXL2    3,,PR4
        68 000112   000000 636012                    EAQ     0,X2
        68 000113   000000 036000 38                 ADLQ    SSS$
        68 000114   000076 756000 52                 STQ     T9PTR$

      489     5563    6                       IF T9PTR$ -> SC.DEF.SETT = 0 AND

   5563 68 000115   000076 474400 52                 LDP4    T9PTR$
        68 000116   400000 236100                    LDQ     0,,PR4
        68 000117   000700 316007                    CANQ    448,DL
        68 000120   000135 601000 68                 TNZ     s:5572
        68 000121   400000 236100                    LDQ     0,,PR4
        68 000122   740000 376007                    ANQ     -16384,DL
        68 000123   200000 116007                    CMPQ    65536,DL
        68 000124   000127 600000 68                 TZE     s:5563+10
        68 000125   300000 116007                    CMPQ    98304,DL
        68 000126   000135 601000 68                 TNZ     s:5572
        68 000127   400000 236100                    LDQ     0,,PR4
        68 000130   020000 316007                    CANQ    8192,DL
        68 000131   000135 600000 68                 TZE     s:5572

      490     5564    6                          ( T9PTR$ -> SC.DEF.SETO = 4 OR
      491     5565    6                          T9PTR$ -> SC.DEF.SETO = 6) AND
      492     5566    6                          T9PTR$ -> SC.DEF.SNSS
      493     5567    7                       THEN DO;

      494     5568    7                           FR.DEF.FMOD = '1'B;

   5568 68 000132   000000 475400 45                 LDP5    FR$
        68 000133   000200 236007                    LDQ     128,DL
        68 000134   500000 256100                    ORSQ    0,,PR5

      495     5569    7                           END;

      496     5570    6                       END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:57   

      497     5571    5                   END;

      498     5572    4               RETURN;

   5572 68 000135   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000136   000001 702211                    TSX2  ! 1,X1

      499     5573    4               END;
      500     5574    4           ELSE DO;

      501     5575    4               START_N = I + 1;

   5575 68 000137   000000 236000 52                 LDQ     I
        68 000140   000001 036007                    ADLQ    1,DL
        68 000141   000016 756000 52                 STQ     START_N

      502     5576    4               END;

      503     5577    4           DO WHILE ('0'B);

   5577 68 000142   000147 710000 68                 TRA     s:5582

      504     5578    4   INCREMENT:
      505     5579    4               CF_TPTR$ = CF_TPTR$ -> CF_STR.NPTR$;

   5579 68 000143   200051 470500       INCREMENT    LDP0    CF_TPTR$,,AUTO
        68 000144   000000 236100                    LDQ     0,,PR0
        68 000145   200051 756100                    STQ     CF_TPTR$,,AUTO

      506     5580    4               START_N = 0;

   5580 68 000146   000016 450000 52                 STZ     START_N

      507     5581    4               END;

      508     5582    3           END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:58   

   5582 68 000147   200051 236100                    LDQ     CF_TPTR$,,AUTO
        68 000150   000001 116000 69                 CMPQ    1
        68 000151   000034 601000 68                 TNZ     s:5550

      509     5583    2       RETURN;

   5583 68 000152   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000153   000001 702211                    TSX2  ! 1,X1

      510     5584    2   END FIND_CF;
      511     5585        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:59   
      512     5586    1   GET_ENCODE_DECODE:

   5586 68 000154   200052 741300       GET_ENCODE_* STX1  ! CF_TPTR$+1,,AUTO

      513     5587    1       PROC;
      514     5588    2       IF UWA.FR.FTYPE > 19 OR ~VALID_STYPE(UWA.FR.FTYPE+1)

   5588 68 000155   000334 235000 51                 LDA     UWA+220
        68 000156   000023 115007                    CMPA    19,DL
        68 000157   000171 605400 68                 TPNZ    s:5590
        68 000160   000000 115003                    CMPA    0,DU
        68 000161   000163 605000 68                 TPL     s:5588+6
        68 000162   000044 035003                    ADLA    36,DU
        68 000163   003100 060405                    CSL     bolr='003'O
        68 000164   000000 010001 67                 BDSC    VALID_STYPE,A            by=0,bit=1,n=1
        68 000165   200056 000044                    BDSC    SEARCH_STR+1,,AUTO       by=0,bit=0,n=36
        68 000166   200056 236100                    LDQ     SEARCH_STR+1,,AUTO
        68 000167   400000 676003                    ERQ     -131072,DU
        68 000170   000242 600000 68                 TZE     s:5615

      515     5589    3       THEN DO;

      516     5590    3           CALL CHECK_FOR_DPPROC;

   5590 68 000171   000620 701000 68                 TSX1    CHECK_FOR_DPPROC
        68 000172   000000 011000                    NOP     0

      517     5591    3           IF DPPROC

   5591 68 000173   000073 234000 52                 SZN     DPPROC
        68 000174   000205 605000 68                 TPL     s:5602

      518     5592    4           THEN DO;

      519     5593    4               FR.DEF.ENDX = 21; /* Encode DB procedure. */

   5593 68 000175   000000 470400 45                 LDP0    FR$
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:60   
        68 000176   000025 236003                    LDQ     21,DU
        68 000177   000000 752110                    STCQ    0,'10'O,PR0

      520     5594    4               FR.DEF.DNDX = 22; /* Decode DB procedure. */

   5594 68 000200   000000 470400 45                 LDP0    FR$
        68 000201   000026 236007                    LDQ     22,DL
        68 000202   000000 752101                    STCQ    0,'01'O,PR0

      521     5595        /*
      522     5596              The data base procedures will be connected up at the
      523     5597            end of the validation and at that time all the FR records
      524     5598            with DB procedures will be checked.
      525     5599        */
      526     5600    4               RETURN;

   5600 68 000203   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000204   000001 702211                    TSX2  ! 1,X1

      527     5601    4               END;
      528     5602    3           CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);

   5602 68 000205   000005 630400 69                 EPPR0   5
        68 000206   000002 631400 69                 EPPR1   2
        68 000207   000000 701000 xent               TSX1    SET_FIELDS
        68 000210   000000 011000                    NOP     0

      529     5603    3           CALL SET_FIELDS(2,30,TYPE_430.FIELD_NAME);

   5603 68 000211   000011 630400 69                 EPPR0   9
        68 000212   000002 631400 69                 EPPR1   2
        68 000213   000000 701000 xent               TSX1    SET_FIELDS
        68 000214   000000 011000                    NOP     0

      530     5604    3           I = RC.DEF.RNL;

   5604 68 000215   000000 470400 41                 LDP0    RC$
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:61   
        68 000216   000000 236100                    LDQ     0,,PR0
        68 000217   000077 376007                    ANQ     63,DL
        68 000220   000000 756000 52                 STQ     I

      531     5605    3           CALL SET_FIELDS(3,I,RC.RNAM);

   5605 68 000221   000000 236000 41                 LDQ     RC$
        68 000222   000005 036003                    ADLQ    5,DU
        68 000223   200060 756100                    STQ     SEARCH_STR+3,,AUTO
        68 000224   000016 237000 69                 LDAQ    14
        68 000225   200056 757100                    STAQ    SEARCH_STR+1,,AUTO
        68 000226   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 000227   000002 631400 69                 EPPR1   2
        68 000230   000000 701000 xent               TSX1    SET_FIELDS
        68 000231   000000 011000                    NOP     0

      532     5606    3           CALL ERROR(%ZIG_V_NO_SYS_E_D);

   5606 68 000232   000021 630400 69                 EPPR0   17
        68 000233   000015 631400 69                 EPPR1   13
        68 000234   000000 701000 xent               TSX1    ERROR
        68 000235   000000 011000                    NOP     0

      533     5607        /*E*     ERROR:    ZIG-ZIG_V_NO_SYS_E_D-C
      534     5608        MESSAGE: For the subschema field "%U1" in the schema record "%U3"
      535     5609                 there is no system ENCODE or DECODE procedures for
      536     5610                 the schema field "%U2".
      537     5611        */
      538     5612    3           FIELD_ERRORED = '1'B;

   5612 68 000236   400000 236003                    LDQ     -131072,DU
        68 000237   000000 756000 65                 STQ     FIELD_ERRORED

      539     5613    3           RETURN;

   5613 68 000240   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000241   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:62   

      540     5614    3           END;
      541     5615    2       IF DECIMAL(UWA.FR.FTYPE)

   5615 68 000242   000334 235000 51                 LDA     UWA+220
        68 000243   000245 605000 68                 TPL     s:5615+3
        68 000244   000044 035003                    ADLA    36,DU
        68 000245   000000 066405                    CMPB    filb='0'B
        68 000246   000033 000001 67                 BDSC    DECIMAL,A                by=0,bit=0,n=1
        68 000247   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000250   000273 600000 68                 TZE     s:5624

      542     5616    3       THEN DO;

      543     5617    3           SLENGTH = ADDR(FR.ROFST) -> NEIS.LENGTH;

   5617 68 000251   000000 470400 45                 LDP0    FR$
        68 000252   000001 236100                    LDQ     1,,PR0
        68 000253   000077 376007                    ANQ     63,DL
        68 000254   000072 756000 52                 STQ     SLENGTH

      544     5618    3           SSCALE = ADDR(FR.ROFST) -> NEIS.SCALE;

   5618 68 000255   000001 236100                    LDQ     1,,PR0
        68 000256   000006 772000                    QRL     6
        68 000257   000077 376007                    ANQ     63,DL
        68 000260   000071 756000 52                 STQ     SSCALE

      545     5619    3           IF SSCALE < 32

   5619 68 000261   000040 116007                    CMPQ    32,DL
        68 000262   000267 603000 68                 TRC     s:5621

      546     5620    3           THEN SSCALE = -SSCALE;

   5620 68 000263   000000 235003                    LDA     0,DU
        68 000264   000071 135000 52                 SBLA    SSCALE
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:63   
        68 000265   000071 755000 52                 STA     SSCALE
        68 000266   000300 710000 68                 TRA     s:5627

      547     5621    3           ELSE SSCALE = 64 - SSCALE;

   5621 68 000267   000100 235007                    LDA     64,DL
        68 000270   000071 135000 52                 SBLA    SSCALE
        68 000271   000071 755000 52                 STA     SSCALE

      548     5622    3           END;

   5622 68 000272   000300 710000 68                 TRA     s:5627

      549     5623    3       ELSE DO;

      550     5624    3           SLENGTH = FR.ROFST.EIS.COUNT;

   5624 68 000273   000000 470400 45                 LDP0    FR$
        68 000274   000001 236100                    LDQ     1,,PR0
        68 000275   007777 376007                    ANQ     4095,DL
        68 000276   000072 756000 52                 STQ     SLENGTH

      551     5625    3           SSCALE = 0;

   5625 68 000277   000071 450000 52                 STZ     SSCALE

      552     5626    3           END;

      553     5627    2       IF TYPE_430.DATA_TYPE > 27 OR

   5627 68 000300   000024 235000 18                 LDA     IO_BUF+20
        68 000301   000034 115007                    CMPA    28,DL
        68 000302   000331 603000 68                 TRC     s:5632
        68 000303   003100 060405                    CSL     bolr='003'O
        68 000304   000001 010001 67                 BDSC    VALID_CSSTYPE,A          by=0,bit=1,n=1
        68 000305   200056 000044                    BDSC    SEARCH_STR+1,,AUTO       by=0,bit=0,n=36
        68 000306   200056 236100                    LDQ     SEARCH_STR+1,,AUTO
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:64   
        68 000307   400000 676003                    ERQ     -131072,DU
        68 000310   000314 600000 68                 TZE     s:5627+12
        68 000311   000000 236000 12                 LDQ     SUB_LANGUAGE
        68 000312   000001 116007                    CMPQ    1,DL
        68 000313   000331 600000 68                 TZE     s:5632
        68 000314   003100 060405                    CSL     bolr='003'O
        68 000315   000002 010001 67                 BDSC    VALID_FSSTYPE,A          by=0,bit=1,n=1
        68 000316   200057 000044                    BDSC    SEARCH_STR+2,,AUTO       by=0,bit=0,n=36
        68 000317   200057 236100                    LDQ     SEARCH_STR+2,,AUTO
        68 000320   400000 676003                    ERQ     -131072,DU
        68 000321   000360 600000 68                 TZE     s:5647
        68 000322   000000 236000 12                 LDQ     SUB_LANGUAGE
        68 000323   000002 116007                    CMPQ    2,DL
        68 000324   000331 600000 68                 TZE     s:5632
        68 000325   000003 116007                    CMPQ    3,DL
        68 000326   000331 600000 68                 TZE     s:5632
        68 000327   000004 116007                    CMPQ    4,DL
        68 000330   000360 601000 68                 TNZ     s:5647

      554     5628    2          (~VALID_CSSTYPE(TYPE_430.DATA_TYPE + 1) AND SUB_LANGUAGE = #COBOL)
      555     5629    2          OR (~VALID_FSSTYPE(TYPE_430.DATA_TYPE + 1) AND
      556     5630    2          (SUB_LANGUAGE = #FORTRAN OR SUB_LANGUAGE = #APL OR SUB_LANGUAGE = #BASIC))
      557     5631    3       THEN DO;

      558     5632    3           CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);

   5632 68 000331   000005 630400 69                 EPPR0   5
        68 000332   000002 631400 69                 EPPR1   2
        68 000333   000000 701000 xent               TSX1    SET_FIELDS
        68 000334   000000 011000                    NOP     0

      559     5633    3           I = RC.DEF.RNL;

   5633 68 000335   000000 470400 41                 LDP0    RC$
        68 000336   000000 236100                    LDQ     0,,PR0
        68 000337   000077 376007                    ANQ     63,DL
        68 000340   000000 756000 52                 STQ     I
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:65   

      560     5634    3           CALL SET_FIELDS(2,I,RC.RNAM);

   5634 68 000341   000000 236000 41                 LDQ     RC$
        68 000342   000005 036003                    ADLQ    5,DU
        68 000343   200060 756100                    STQ     SEARCH_STR+3,,AUTO
        68 000344   000024 237000 69                 LDAQ    20
        68 000345   200056 757100                    STAQ    SEARCH_STR+1,,AUTO
        68 000346   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 000347   000002 631400 69                 EPPR1   2
        68 000350   000000 701000 xent               TSX1    SET_FIELDS
        68 000351   000000 011000                    NOP     0

      561     5635    3           CALL ERROR(%ZIG_V_BAD_DATA_TYPE);

   5635 68 000352   000026 630400 69                 EPPR0   22
        68 000353   000015 631400 69                 EPPR1   13
        68 000354   000000 701000 xent               TSX1    ERROR
        68 000355   000000 011000                    NOP     0

      562     5636        /*E*     ERROR:    ZIG-ZIG_V_BAD_DATA_TYPE-C
      563     5637        MESSAGE: For the field "%U1" in the record "%U2"
      564     5638                 the subschema data type is not a valid data type for
      565     5639                 this field.
      566     5640                 <<<< SOFTWARE ERROR >>>>
      567     5641        */
      568     5642    3           RETURN;

   5642 68 000356   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000357   000001 702211                    TSX2  ! 1,X1

      569     5643    3           END;
      570     5644        /*
      571     5645              Everything is ok to set the encode and decode procedure.
      572     5646        */
      573     5647    2       CKIP = UWA.FR.FTYPE + TYPE_430.DATA_TYPE * 20;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:66   
   5647 68 000360   000024 236000 18                 LDQ     IO_BUF+20
        68 000361   000024 402007                    MPY     20,DL
        68 000362   000334 036000 51                 ADLQ    UWA+220
        68 000363   000075 756000 52                 STQ     CKIP

      574     5648    2       IF SUB_LANGUAGE = #COBOL

   5648 68 000364   000000 235000 12                 LDA     SUB_LANGUAGE
        68 000365   000001 115007                    CMPA    1,DL
        68 000366   000373 601000 68                 TNZ     s:5650

      575     5649    2       THEN CKI = CMAP_CKI(CKIP);

   5649 68 000367   000000 101406                    MRL     fill='000'O
        68 000370   000170 000001 67                 ADSC9   CMAP_CKI,Q               cn=0,n=1
        68 000371   000074 000004 52                 ADSC9   CKI                      cn=0,n=4
        68 000372   000376 710000 68                 TRA     s:5651

      576     5650    2       ELSE CKI = FMAP_CKI(CKIP);

   5650 68 000373   000000 101406                    MRL     fill='000'O
        68 000374   000404 000001 67                 ADSC9   FMAP_CKI,Q               cn=0,n=1
        68 000375   000074 000004 52                 ADSC9   CKI                      cn=0,n=4

      577     5651    2       CALL SYSTEM_CONVERSION_ERROR;

   5651 68 000376   000540 701000 68                 TSX1    SYSTEM_CONVERSION_ERROR
        68 000377   000000 011000                    NOP     0

      578     5652    2       FR.DEF.EBCM = FLAG_TAB1.EBS(CKI);

   5652 68 000400   000074 236000 52                 LDQ     CKI
        68 000401   000014 402007                    MPY     12,DL
        68 000402   000000 470400 45                 LDP0    FR$
        68 000403   003100 060406                    CSL     bolr='003'O
        68 000404   000102 220001 67                 BDSC    FLAG_TAB,Q               by=1,bit=2,n=1
        68 000405   000000 400001                    BDSC    0,,PR0                   by=2,bit=0,n=1
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:67   

      579     5653    2       FR.DEF.EBCL = FLAG_TAB1.EBC(CKI);

   5653 68 000406   000000 470400 45                 LDP0    FR$
        68 000407   003100 060406                    CSL     bolr='003'O
        68 000410   000102 210001 67                 BDSC    FLAG_TAB,Q               by=1,bit=1,n=1
        68 000411   000000 410001                    BDSC    0,,PR0                   by=2,bit=1,n=1

      580     5654    2       IF FLAG_TAB1.F6(CKI) AND SLENGTH = TYPE_430.LEN_FIELD AND

   5654 68 000412   000000 066406                    CMPB    filb='0'B
        68 000413   000102 050001 67                 BDSC    FLAG_TAB,Q               by=0,bit=5,n=1
        68 000414   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000415   000427 600000 68                 TZE     s:5657
        68 000416   000072 236000 52                 LDQ     SLENGTH
        68 000417   000025 116000 18                 CMPQ    IO_BUF+21
        68 000420   000427 601000 68                 TNZ     s:5657
        68 000421   000071 236000 52                 LDQ     SSCALE
        68 000422   000026 116000 18                 CMPQ    IO_BUF+22
        68 000423   000427 601000 68                 TNZ     s:5657

      581     5655    2          SSCALE = TYPE_430.SCALE_FIELD
      582     5656    2       THEN FR.DEF.EBCL = '0'B;

   5656 68 000424   000000 470400 45                 LDP0    FR$
        68 000425   000027 236000 69                 LDQ     23
        68 000426   000000 356100                    ANSQ    0,,PR0

      583     5657    2       FR.DEF.ENDX = EN(CKI);

   5657 68 000427   000074 236000 52                 LDQ     CKI
        68 000430   000011 402007                    MPY     9,DL
        68 000431   000000 470400 45                 LDP0    FR$
        68 000432   003100 061406                    CSR     bolr='003'O
        68 000433   000130 000011 67                 BDSC    EN,Q                     by=0,bit=0,n=9
        68 000434   000000 230006                    BDSC    0,,PR0                   by=1,bit=3,n=6

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:68   
      584     5658    2       IF (UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9) AND

   5658 68 000435   000334 235000 51                 LDA     UWA+220
        68 000436   000005 115007                    CMPA    5,DL
        68 000437   000442 600000 68                 TZE     s:5658+5
        68 000440   000011 115007                    CMPA    9,DL
        68 000441   000455 601000 68                 TNZ     s:5667
        68 000442   000024 235000 18                 LDA     IO_BUF+20
        68 000443   000455 601000 68                 TNZ     s:5667
        68 000444   000072 236000 52                 LDQ     SLENGTH
        68 000445   000025 116000 18                 CMPQ    IO_BUF+21
        68 000446   000455 603000 68                 TRC     s:5667

      585     5659    2          TYPE_430.DATA_TYPE = 0 AND TYPE_430.LEN_FIELD > SLENGTH
      586     5660    3       THEN DO;

      587     5661    3           FR.DEF.ENDX = 19;

   5661 68 000447   000000 470400 45                 LDP0    FR$
        68 000450   000023 236003                    LDQ     19,DU
        68 000451   000000 752110                    STCQ    0,'10'O,PR0

      588     5662    3           FR.DEF.EBCM = '1'B;

   5662 68 000452   000000 470400 45                 LDP0    FR$
        68 000453   400000 236007                    LDQ     -131072,DL
        68 000454   000000 256100                    ORSQ    0,,PR0

      589     5663    3           END;

      590     5664        /*
      591     5665              Now comes the decode things for this field.
      592     5666        */
      593     5667    2       FR.DEF.DNDX = DN(CKI);

   5667 68 000455   000074 236000 52                 LDQ     CKI
        68 000456   000011 402007                    MPY     9,DL
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:69   
        68 000457   000000 470400 45                 LDP0    FR$
        68 000460   003100 061406                    CSR     bolr='003'O
        68 000461   000150 000011 67                 BDSC    DN,Q                     by=0,bit=0,n=9
        68 000462   000000 630006                    BDSC    0,,PR0                   by=3,bit=3,n=6

      594     5668    2       IF (UWA.FR.FTYPE = 5 OR UWA.FR.FTYPE = 9)

   5668 68 000463   000334 235000 51                 LDA     UWA+220
        68 000464   000005 115007                    CMPA    5,DL
        68 000465   000470 600000 68                 TZE     s:5668+5
        68 000466   000011 115007                    CMPA    9,DL
        68 000467   000526 601000 68                 TNZ     s:5692
        68 000470   000024 235000 18                 LDA     IO_BUF+20
        68 000471   000526 601000 68                 TNZ     s:5692

      595     5669    2          AND TYPE_430.DATA_TYPE = 0
      596     5670    3       THEN DO;

      597     5671        /*
      598     5672              Character to character decode.
      599     5673        */
      600     5674    3           IF SUB_LANGUAGE = #COBOL

   5674 68 000472   000000 235000 12                 LDA     SUB_LANGUAGE
        68 000473   000001 115007                    CMPA    1,DL
        68 000474   000504 601000 68                 TNZ     s:5680

      601     5675    4           THEN DO;

      602     5676    4               IF SLENGTH > TYPE_430.LEN_FIELD

   5676 68 000475   000025 236000 18                 LDQ     IO_BUF+21
        68 000476   000072 116000 52                 CMPQ    SLENGTH
        68 000477   000526 603000 68                 TRC     s:5692

      603     5677    4               THEN FR.DEF.DNDX = 19;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:70   
   5677 68 000500   000000 470400 45                 LDP0    FR$
        68 000501   000023 236007                    LDQ     19,DL
        68 000502   000000 752101                    STCQ    0,'01'O,PR0

      604     5678    4               END;

   5678 68 000503   000526 710000 68                 TRA     s:5692

      605     5679    4           ELSE DO;

      606     5680    4               IF SLENGTH > TYPE_430.LEN_FIELD

   5680 68 000504   000025 236000 18                 LDQ     IO_BUF+21
        68 000505   000072 116000 52                 CMPQ    SLENGTH
        68 000506   000521 603000 68                 TRC     s:5687

      607     5681    5               THEN DO;

      608     5682    5                   IF MOD(TYPE_430.LEN_FIELD,4) = 0

   5682 68 000507   000003 376007                    ANQ     3,DL
        68 000510   000515 601000 68                 TNZ     s:5684

      609     5683    5                   THEN FR.DEF.DNDX = 19;

   5683 68 000511   000000 470400 45                 LDP0    FR$
        68 000512   000023 236007                    LDQ     19,DL
        68 000513   000000 752101                    STCQ    0,'01'O,PR0
        68 000514   000526 710000 68                 TRA     s:5692

      610     5684    5                   ELSE FR.DEF.DNDX = 32;

   5684 68 000515   000000 470400 45                 LDP0    FR$
        68 000516   000040 236007                    LDQ     32,DL
        68 000517   000000 752101                    STCQ    0,'01'O,PR0

      611     5685    5                   END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:71   

   5685 68 000520   000526 710000 68                 TRA     s:5692

      612     5686    5               ELSE DO;

      613     5687    5                   IF MOD(TYPE_430.LEN_FIELD,4) = 0

   5687 68 000521   000003 376007                    ANQ     3,DL
        68 000522   000526 601000 68                 TNZ     s:5692

      614     5688    5                   THEN FR.DEF.DNDX = 31;

   5688 68 000523   000000 470400 45                 LDP0    FR$
        68 000524   000037 236007                    LDQ     31,DL
        68 000525   000000 752101                    STCQ    0,'01'O,PR0

      615     5689    5                   END;

      616     5690    4               END;

      617     5691    3           END;

      618     5692    2       FR.DEF.COMC = BITBIN(SCHEMA_CC(UWA.FR.FTYPE));

   5692 68 000526   000334 720000 51                 LXL0    UWA+220
        68 000527   000003 236010 67                 LDQ     SCHEMA_CC,X0
        68 000530   000041 772000                    QRL     33
        68 000531   000000 470400 45                 LDP0    FR$
        68 000532   000015 736000                    QLS     13
        68 000533   000000 676100                    ERQ     0,,PR0
        68 000534   160000 376007                    ANQ     57344,DL
        68 000535   000000 656100                    ERSQ    0,,PR0

      619     5693    2   END GET_ENCODE_DECODE;

   5693 68 000536   200052 221300                    LDX1  ! CF_TPTR$+1,,AUTO
        68 000537   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:72   

      620     5694        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:73   
      621     5695    1   SYSTEM_CONVERSION_ERROR:

   5695 68 000540   200054 741300       SYSTEM_CONV* STX1  ! @FOUND,,AUTO

      622     5696    1       PROC;
      623     5697    2       IF FLAG_TAB1.F1(CKI) OR

   5697 68 000541   000074 236000 52                 LDQ     CKI
        68 000542   000014 402007                    MPY     12,DL
        68 000543   000000 066406                    CMPB    filb='0'B
        68 000544   000102 000001 67                 BDSC    FLAG_TAB,Q               by=0,bit=0,n=1
        68 000545   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000546   000557 601000 68                 TNZ     s:5701
        68 000547   000000 066406                    CMPB    filb='0'B
        68 000550   000102 060001 67                 BDSC    FLAG_TAB,Q               by=0,bit=6,n=1
        68 000551   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000552   000557 601000 68                 TNZ     s:5701
        68 000553   000000 066406                    CMPB    filb='0'B
        68 000554   000102 070001 67                 BDSC    FLAG_TAB,Q               by=0,bit=7,n=1
        68 000555   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000556   000562 600000 68                 TZE     s:5704

      624     5698    2          FLAG_TAB1.F7(CKI) OR
      625     5699    2          FLAG_TAB1.F8(CKI)
      626     5700    3       THEN DO;

      627     5701    3           FIELD_ERRORED = '1'B;

   5701 68 000557   400000 236003                    LDQ     -131072,DU
        68 000560   000000 756000 65                 STQ     FIELD_ERRORED

      628     5702    3           RETURN;

   5702 68 000561   000001 702211                    TSX2  ! 1,X1

      629     5703    3           END;
      630     5704    2       IF (FLAG_TAB1.F2(CKI) AND TYPE_430.LEN_FIELD > 63) OR
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:74   

   5704 68 000562   000000 066406                    CMPB    filb='0'B
        68 000563   000102 010001 67                 BDSC    FLAG_TAB,Q               by=0,bit=1,n=1
        68 000564   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000565   000571 600000 68                 TZE     s:5704+7
        68 000566   000025 235000 18                 LDA     IO_BUF+21
        68 000567   000100 115007                    CMPA    64,DL
        68 000570   000614 603000 68                 TRC     s:5709
        68 000571   000000 066406                    CMPB    filb='0'B
        68 000572   000102 020001 67                 BDSC    FLAG_TAB,Q               by=0,bit=2,n=1
        68 000573   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000574   000600 600000 68                 TZE     s:5704+14
        68 000575   000072 235000 52                 LDA     SLENGTH
        68 000576   000100 115007                    CMPA    64,DL
        68 000577   000614 603000 68                 TRC     s:5709
        68 000600   000000 066406                    CMPB    filb='0'B
        68 000601   000102 030001 67                 BDSC    FLAG_TAB,Q               by=0,bit=3,n=1
        68 000602   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000603   000606 600000 68                 TZE     s:5704+20
        68 000604   000026 235000 18                 LDA     IO_BUF+22
        68 000605   000614 601000 68                 TNZ     s:5709
        68 000606   000000 066406                    CMPB    filb='0'B
        68 000607   000102 040001 67                 BDSC    FLAG_TAB,Q               by=0,bit=4,n=1
        68 000610   000022 000022 69                 BDSC    18                       by=0,bit=0,n=18
        68 000611   000617 600000 68                 TZE     s:5712
        68 000612   000071 235000 52                 LDA     SSCALE
        68 000613   000617 600000 68                 TZE     s:5712

      631     5705    2          (FLAG_TAB1.F3(CKI) AND SLENGTH > 63) OR
      632     5706    2          (FLAG_TAB1.F4(CKI) AND TYPE_430.SCALE_FIELD ~= 0) OR
      633     5707    2          (FLAG_TAB1.F5(CKI) AND SSCALE ~= 0)
      634     5708    3       THEN DO;

      635     5709    3           FIELD_ERRORED = '1'B;

   5709 68 000614   400000 236003                    LDQ     -131072,DU
        68 000615   000000 756000 65                 STQ     FIELD_ERRORED
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:75   

      636     5710    3           RETURN;

   5710 68 000616   000001 702211                    TSX2  ! 1,X1

      637     5711    3           END;
      638     5712    2       RETURN;

   5712 68 000617   000001 702211                    TSX2  ! 1,X1

      639     5713    2   END SYSTEM_CONVERSION_ERROR;
      640     5714        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:76   
      641     5715    1   CHECK_FOR_DPPROC:

   5715 68 000620   200054 741300       CHECK_FOR_D* STX1  ! @FOUND,,AUTO

      642     5716    1       PROC;
      643     5717    2       DPPROC = '0'B;

   5717 68 000621   000073 450000 52                 STZ     DPPROC

      644     5718    2       RETURN;

   5718 68 000622   000001 702211                    TSX2  ! 1,X1

      645     5719    2   END CHECK_FOR_DPPROC;
      646     5720        %EJECT;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:77   
      647     5721    1       TYPE_430.DBK_SN = 0;

   5721 68 000623   000033 450000 18                 STZ     IO_BUF+27

      648     5722        /*
      649     5723              Now comes the code that does the field things.
      650     5724        */
      651     5725    1       IF TYPE_430.REF_LINE ~= 0

   5725 68 000624   000001 235000 18                 LDA     IO_BUF+1
        68 000625   000767 600000 68                 TZE     s:5789

      652     5726    2       THEN DO;

      653     5727    2           IF IN_GROUP AND LAST_GROUP_LEVEL < TYPE_430.LEVEL_FIELD

   5727 68 000626   000000 234000 55                 SZN     IN_GROUP
        68 000627   000656 605000 68                 TPL     s:5745
        68 000630   000000 236000 56                 LDQ     LAST_GROUP_LEVEL
        68 000631   000027 116000 18                 CMPQ    IO_BUF+23
        68 000632   000656 603000 68                 TRC     s:5745

      654     5728    3           THEN DO;

      655     5729    3               TYPE_430.FLAGS.TYPE = '111111111111'B;

   5729 68 000633   777700 236003                    LDQ     -64,DU
        68 000634   000032 752060 18                 STCQ    IO_BUF+26,'60'O

      656     5730    3               CONTROL.BITS.ALL_FIELDS = '0'B;

   5730 68 000635   000030 236000 69                 LDQ     24
        68 000636   000071 356000 17                 ANSQ    CONTROL+57

      657     5731    3               CALL WRITSF(CURRENT_RECORD,IO_BUF);

   5731 68 000637   000032 630400 69                 EPPR0   26
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:78   
        68 000640   000031 631400 69                 EPPR1   25
        68 000641   000000 701000 xent               TSX1    WRITSF
        68 000642   000000 011000                    NOP     0

      658     5732        /*
      659     5733            Turn off the bit which says this group item is in the UWA so
      660     5734            the languages know this item cannot be used in a DML statement.
      661     5735        */
      662     5736    3               CALL READSF(TYPE_430.REF_LINE,DESC_TYPE_9);

   5736 68 000643   000034 630400 69                 EPPR0   28
        68 000644   000031 631400 69                 EPPR1   25
        68 000645   000000 701000 xent               TSX1    READSF
        68 000646   000000 011000                    NOP     0

      663     5737    3               DESC_TYPE_9.BUWA = '0'B;

   5737 68 000647   000036 236000 69                 LDQ     30
        68 000650   000010 356000 19                 ANSQ    DESC_TYPE_9+8

      664     5738    3               CALL WRITSF(TYPE_430.REF_LINE,DESC_TYPE_9);

   5738 68 000651   000034 630400 69                 EPPR0   28
        68 000652   000031 631400 69                 EPPR1   25
        68 000653   000000 701000 xent               TSX1    WRITSF
        68 000654   000000 011000                    NOP     0

      665     5739    3               RETURN;

   5739 68 000655   000000 702200 xent               TSX2  ! X66_ARET

      666     5740    3               END;
      667     5741        /*
      668     5742              We are not still in a group so don't just return.
      669     5743        */
      670     5744    3           ELSE DO;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:79   
      671     5745    3               IN_GROUP = '0'B;

   5745 68 000656   000000 450000 55                 STZ     IN_GROUP

      672     5746    3               LAST_GROUP_LEVEL = 0;

   5746 68 000657   000000 450000 56                 STZ     LAST_GROUP_LEVEL

      673     5747    3               END;

      674     5748    2           FIELD_ERRORED = '0'B;

   5748 68 000660   000000 450000 65                 STZ     FIELD_ERRORED

      675     5749    2           STATUS = #ITEM_DEF;

   5749 68 000661   050000 236003                    LDQ     20480,DU
        68 000662   200006 756100                    STQ     STATUS,,AUTO

      676     5750    2           ALLOCATE_END = 2;

   5750 68 000663   000002 235007                    LDA     2,DL
        68 000664   000000 755000 24                 STA     ALLOCATE_END

      677     5751    2           HASH_SCHEMA_NAME = '1'B;

   5751 68 000665   400000 236003                    LDQ     -131072,DU
        68 000666   000000 756000 15                 STQ     HASH_SCHEMA_NAME

      678     5752    2           CALL ZIG$HASH_IT(TYPE_430.FIELD_NAME,#ADD_ALT_HASH,ERROR_FLG,0,

   5752 68 000667   200006 630500                    EPPR0   STATUS,,AUTO
        68 000670   200065 450500                    STP0    SEARCH_STR+8,,AUTO
        68 000671   200003 631500                    EPPR1   TPTR$,,AUTO
        68 000672   200064 451500                    STP1    SEARCH_STR+7,,AUTO
        68 000673   000042 237000 69                 LDAQ    34
        68 000674   200062 757100                    STAQ    SEARCH_STR+5,,AUTO
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:80   
        68 000675   000044 237000 69                 LDAQ    36
        68 000676   200060 757100                    STAQ    SEARCH_STR+3,,AUTO
        68 000677   000046 237000 69                 LDAQ    38
        68 000700   200056 757100                    STAQ    SEARCH_STR+1,,AUTO
        68 000701   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 000702   000037 631400 69                 EPPR1   31
        68 000703   000000 701000 xent               TSX1    ZIG$HASH_IT
        68 000704   000000 011000                    NOP     0

      679     5753    2              RECORD_NUM,14,TPTR$,STATUS);
      680     5754    2           ALLOCATE_END = 0;

   5754 68 000705   000000 450000 24                 STZ     ALLOCATE_END

      681     5755    2           IF ERROR_FLG = 0

   5755 68 000706   000011 235000 52                 LDA     ERROR_FLG
        68 000707   000754 601000 68                 TNZ     s:5786

      682     5756    3           THEN DO;

      683     5757    3               TYPE_430.FLAGS.TYPE = '111111111110'B;

   5757 68 000710   777600 236003                    LDQ     -128,DU
        68 000711   000032 752060 18                 STCQ    IO_BUF+26,'60'O

      684     5758    3               CONTROL.BITS.ALL_FIELDS = '0'B;

   5758 68 000712   000030 236000 69                 LDQ     24
        68 000713   000071 356000 17                 ANSQ    CONTROL+57

      685     5759    3               CALL WRITSF(CURRENT_RECORD,IO_BUF);

   5759 68 000714   000032 630400 69                 EPPR0   26
        68 000715   000031 631400 69                 EPPR1   25
        68 000716   000000 701000 xent               TSX1    WRITSF
        68 000717   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:81   

      686     5760    3               IF TYPE_430.ELEMENTARY

   5760 68 000720   000030 234000 18                 SZN     IO_BUF+24
        68 000721   000750 605000 68                 TPL     s:5774

      687     5761    4               THEN DO;

      688     5762    4                   CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);

   5762 68 000722   000005 630400 69                 EPPR0   5
        68 000723   000002 631400 69                 EPPR1   2
        68 000724   000000 701000 xent               TSX1    SET_FIELDS
        68 000725   000000 011000                    NOP     0

      689     5763    4                   CALL SET_FIELDS(2,30,TYPE_430.FIELD_NAME);

   5763 68 000726   000011 630400 69                 EPPR0   9
        68 000727   000002 631400 69                 EPPR1   2
        68 000730   000000 701000 xent               TSX1    SET_FIELDS
        68 000731   000000 011000                    NOP     0

      690     5764    4                   TYPE_35.SUB_RECORD_NM = RC.RNAM;

   5764 68 000732   000000 470400 41                 LDP0    RC$
        68 000733   000000 720100                    LXL0    0,,PR0
        68 000734   000077 360003                    ANX0    63,DU
        68 000735   040000 100540                    MLR     fill='040'O
        68 000736   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        68 000737   000025 000040 21                 ADSC9   TYPE_35+21               cn=0,n=32

      691     5765    4                   CALL SET_FIELDS(3,30,TYPE_35.SUB_RECORD_NM);

   5765 68 000740   000050 630400 69                 EPPR0   40
        68 000741   000002 631400 69                 EPPR1   2
        68 000742   000000 701000 xent               TSX1    SET_FIELDS
        68 000743   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:82   

      692     5766    4                   CALL WARNING(%ZIG_V_FIELD_USER);

   5766 68 000744   000053 630400 69                 EPPR0   43
        68 000745   000015 631400 69                 EPPR1   13
        68 000746   000000 701000 xent               TSX1    WARNING
        68 000747   000000 011000                    NOP     0

      693     5767        /*E*     ERROR:    ZIG-ZIG_V_FIELD_USER-C
      694     5768        MESSAGE: The field "%U1" has no corresponding field in
      695     5769                 the schema for the record "%U3" field "%U2".
      696     5770                 Therefore, the field will not be updated by any DML calls and
      697     5771                 cannot be used as a control item in any DML calls.
      698     5772        */
      699     5773    4                   END;

      700     5774    3               TPTR$ -> FIELD_HASH.REF = 1;

   5774 68 000750   000001 235007                    LDA     1,DL
        68 000751   200003 470500                    LDP0    TPTR$,,AUTO
        68 000752   000011 755100                    STA     9,,PR0

      701     5775        /*
      702     5776              This is to make the driver think that we use this field
      703     5777            even if it isn't in the schema.
      704     5778        */
      705     5779    3               RETURN;

   5779 68 000753   000000 702200 xent               TSX2  ! X66_ARET

      706     5780    3               END;
      707     5781        /*
      708     5782              The item with that name is in the schema file so we can
      709     5783            add it to the RC record as a FR record and the try and do
      710     5784            some incoding and decoding procedures for that item.
      711     5785        */
      712     5786    2           TYPE_430.DBK_SN = TPTR$ -> FIELD_HASH.DBK_SN;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:83   

   5786 68 000754   200003 470500                    LDP0    TPTR$,,AUTO
        68 000755   000014 235100                    LDA     12,,PR0
        68 000756   000033 755000 18                 STA     IO_BUF+27

      713     5787    2           CALL FETCHD_6('FR  ',TPTR$ -> FIELD_HASH.DBK);

   5787 68 000757   200003 236100                    LDQ     TPTR$,,AUTO
        68 000760   000013 036003                    ADLQ    11,DU
        68 000761   000054 235000 69                 LDA     44
        68 000762   200056 757100                    STAQ    SEARCH_STR+1,,AUTO
        68 000763   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 000764   000031 631400 69                 EPPR1   25
        68 000765   000000 701000 xent               TSX1    FETCHD_6
        68 000766   000000 011000                    NOP     0

      714     5788    2           END;

      715     5789    1       CALL ZIG$G_DYN_MEM_6(1, FR1$);

   5789 68 000767   000055 630400 69                 EPPR0   45
        68 000770   000031 631400 69                 EPPR1   25
        68 000771   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        68 000772   000000 011000                    NOP     0

      716     5790    1       FR1.XXDPN = UWA.DIRECT_REF;

   5790 68 000773   000036 720000 51                 LXL0    UWA+30
        68 000774   000000 470400 46                 LDP0    FR1$
        68 000775   000000 740100                    STX0    0,,PR0

      717     5791        /*
      718     5792              The FR record was the last thing found all ways and don't
      719     5793            screw it up.
      720     5794        */
      721     5795    1       IF VALIDS.FR_NAMES

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:84   
   5795 68 000776   000000 236000 5                  LDQ     VALIDS
        68 000777   000100 316003                    CANQ    64,DU
        68 001000   001036 600000 68                 TZE     s:5803

      722     5796    2       THEN DO;

      723     5797    2           CALL FIND_LENGTH(TYPE_430.SUB_FIELD_NAME,L_SUBSCH_FR);

   5797 68 001001   200004 630500                    EPPR0   L_SUBSCH_FR,,AUTO
        68 001002   200054 450500                    STP0    @DBK+1,,AUTO
        68 001003   000007 236000 69                 LDQ     7
        68 001004   200053 756100                    STQ     CF_TPTR$+2,,AUTO
        68 001005   000003 701000 68                 TSX1    FIND_LENGTH
        68 001006   000000 011000                    NOP     0

      724     5798    2           CALL ZIG$G_DYN_MEM_6(%FR_BASE_SIZE+(L_SUBSCH_FR+3)/4,FR$);

   5798 68 001007   200004 236100                    LDQ     L_SUBSCH_FR,,AUTO
        68 001010   000003 036007                    ADLQ    3,DL
        68 001011   000002 772000                    QRL     2
        68 001012   000006 036007                    ADLQ    6,DL
        68 001013   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 001014   000057 236000 69                 LDQ     47
        68 001015   200061 756100                    STQ     SEARCH_STR+4,,AUTO
        68 001016   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 001017   200060 450500                    STP0    SEARCH_STR+3,,AUTO
        68 001020   200060 630500                    EPPR0   SEARCH_STR+3,,AUTO
        68 001021   000031 631400 69                 EPPR1   25
        68 001022   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        68 001023   000000 011000                    NOP     0

      725     5799    2           FR.FNL = L_SUBSCH_FR;

   5799 68 001024   000000 470400 45                 LDP0    FR$
        68 001025   200004 236100                    LDQ     L_SUBSCH_FR,,AUTO
        68 001026   000022 736000                    QLS     18
        68 001027   000004 752110                    STCQ    4,'10'O,PR0
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:85   

      726     5800    2           FR.FNAM = TYPE_430.SUB_FIELD_NAME;

   5800 68 001030   000004 220100                    LDX0    4,,PR0
        68 001031   000077 360003                    ANX0    63,DU
        68 001032   040140 100400                    MLR     fill='040'O
        68 001033   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        68 001034   000006 000010                    ADSC9   6,,PR0                   cn=0,n=*X0

      727     5801    2           END;

   5801 68 001035   001045 710000 68                 TRA     s:5806

      728     5802    2       ELSE DO;

      729     5803    2           CALL ZIG$G_DYN_MEM_6(%FR_BASE_SIZE,FR$);

   5803 68 001036   000061 630400 69                 EPPR0   49
        68 001037   000031 631400 69                 EPPR1   25
        68 001040   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        68 001041   000000 011000                    NOP     0

      730     5804    2           FR1.NLIND = CURRENT_RECORD;

   5804 68 001042   000000 720000 16                 LXL0    CURRENT_RECORD
        68 001043   000000 470400 46                 LDP0    FR1$
        68 001044   000000 440100                    SXL0    0,,PR0

      731     5805    2           END;

      732     5806    1       IF TYPE_430.REF_LINE ~= 0

   5806 68 001045   000001 235000 18                 LDA     IO_BUF+1
        68 001046   001060 600000 68                 TZE     s:5812

      733     5807    2       THEN DO;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:86   
      734     5808    2           CALL FETCHOS_6('SN-SE   ');

   5808 68 001047   000063 630400 69                 EPPR0   51
        68 001050   000015 631400 69                 EPPR1   13
        68 001051   000000 701000 xent               TSX1    FETCHOS_6
        68 001052   000000 011000                    NOP     0

      735     5809    2           SN_DBK = UWA.DIRECT_REF;

   5809 68 001053   000036 235000 51                 LDA     UWA+30
        68 001054   000000 755000 0                  STA     SN_DBK

      736     5810    2           CALL ZIG$ADD_SI;

   5810 68 001055   000022 631400 69                 EPPR1   18
        68 001056   000000 701000 xent               TSX1    ZIG$ADD_SI
        68 001057   000000 011000                    NOP     0

      737     5811    2           END;

      738     5812    1       FR.DEF.TYPE = '000000010000'B;

   5812 68 001060   000000 470400 45                 LDP0    FR$
        68 001061   002000 236003                    LDQ     1024,DU
        68 001062   000000 752160                    STCQ    0,'60'O,PR0

      739     5813    1       IF UWA.FR.SYN = 1

   5813 68 001063   000332 235000 51                 LDA     UWA+218
        68 001064   000001 115007                    CMPA    1,DL
        68 001065   001072 601000 68                 TNZ     s:5816

      740     5814    1       THEN FR.DEF.SYN = '1'B;

   5814 68 001066   000000 470400 45                 LDP0    FR$
        68 001067   004000 236007                    LDQ     2048,DL
        68 001070   000000 256100                    ORSQ    0,,PR0
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:87   
        68 001071   001104 710000 68                 TRA     s:5822

      741     5815    2       ELSE DO;

      742     5816    2           IF TYPE_430.REF_LINE ~= 0

   5816 68 001072   000001 235000 18                 LDA     IO_BUF+1
        68 001073   001104 600000 68                 TZE     s:5822

      743     5817    3           THEN DO;

      744     5818    3               FR.FRWSO = OA.CSZ + %CUR_BASE_SIZE;

   5818 68 001074   000000 470400 39                 LDP0    OA$
        68 001075   000017 220100                    LDX0    15,,PR0
        68 001076   001223 621010                    EAX1    659,X0
        68 001077   000000 471400 45                 LDP1    FR$
        68 001100   100005 441100                    SXL1    5,,PR1

      745     5819    3               OA.CSZ = OA.CSZ + %CUR_FR;

   5819 68 001101   000017 220100                    LDX0    15,,PR0
        68 001102   000001 622010                    EAX2    1,X0
        68 001103   000017 742100                    STX2    15,,PR0

      746     5820    3               END;

      747     5821    2           END;

      748     5822    1       T1PTR$ = PINCRW(SSS$,LAST_FR);

   5822 68 001104   000000 236000 59                 LDQ     LAST_FR
        68 001105   777777 376003                    ANQ     -1,DU
        68 001106   000000 036000 38                 ADLQ    SSS$
        68 001107   200047 756100                    STQ     T1PTR$,,AUTO

      749     5823    1       FR.RCFRN = T1PTR$ -> FR.RCFRN;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:88   

   5823 68 001110   200047 470500                    LDP0    T1PTR$,,AUTO
        68 001111   000004 720100                    LXL0    4,,PR0
        68 001112   000000 471400 45                 LDP1    FR$
        68 001113   100004 440100                    SXL0    4,,PR1

      750     5824    1       CURRENT_OFF = POFFW(FR$,SSS$);

   5824 68 001114   000000 235000 38                 LDA     SSS$
        68 001115   000022 771000                    ARL     18
        68 001116   200056 755100                    STA     SEARCH_STR+1,,AUTO
        68 001117   000000 236000 45                 LDQ     FR$
        68 001120   000022 772000                    QRL     18
        68 001121   200056 136100                    SBLQ    SEARCH_STR+1,,AUTO
        68 001122   000000 756000 57                 STQ     CURRENT_OFF

      751     5825    1       IF TYPE_430.REF_LINE ~= 0

   5825 68 001123   000001 235000 18                 LDA     IO_BUF+1
        68 001124   001131 600000 68                 TZE     s:5830

      752     5826    2       THEN DO;

      753     5827    2           TPTR$ -> FIELD_HASH.SUB_OFF = CURRENT_OFF;

   5827 68 001125   200003 473500                    LDP3    TPTR$,,AUTO
        68 001126   300012 756100                    STQ     10,,PR3

      754     5828    2           TPTR$ -> FIELD_HASH.REF = CURRENT_RECORD;

   5828 68 001127   000000 235000 16                 LDA     CURRENT_RECORD
        68 001130   300011 755100                    STA     9,,PR3

      755     5829    2           END;

      756     5830    1       LAST_FR = CURRENT_OFF;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:89   
   5830 68 001131   000000 620006                    EAX0    0,QL
        68 001132   000000 740000 59                 STX0    LAST_FR

      757     5831    1       T1PTR$ -> FR.RCFRN = CURRENT_OFF;

   5831 68 001133   000000 721000 57                 LXL1    CURRENT_OFF
        68 001134   000004 441100                    SXL1    4,,PR0

      758     5832    1       FR.RCFRH = LAST_RC;

   5832 68 001135   000000 222000 58                 LDX2    LAST_RC
        68 001136   100005 742100                    STX2    5,,PR1

      759     5833    1       FR.DEF.FUSE = UWA.FR.F_USE;

   5833 68 001137   000343 236000 51                 LDQ     UWA+227
        68 001140   000010 736000                    QLS     8
        68 001141   100000 676100                    ERQ     0,,PR1
        68 001142   003400 376007                    ANQ     1792,DL
        68 001143   100000 656100                    ERSQ    0,,PR1

      760     5834    1       ADDR(FR.ROFST) -> WORD36 = UWA.FR.BUFFLOC;

   5834 68 001144   000351 235000 51                 LDA     UWA+233
        68 001145   000000 471400 45                 LDP1    FR$
        68 001146   100001 755100                    STA     1,,PR1

      761     5835    1       IF UWA.FR.FTYPE = 19 /* CHAR VARYING */

   5835 68 001147   000334 236000 51                 LDQ     UWA+220
        68 001150   000023 116007                    CMPQ    19,DL
        68 001151   001156 601000 68                 TNZ     s:5840

      762     5836    2       THEN DO;

      763     5837    2           FR.ROFST.EIS.COUNT = UWA.FR.PREC;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:90   
   5837 68 001152   000335 236000 51                 LDQ     UWA+221
        68 001153   100001 752103                    STCQ    1,'03'O,PR1

      764     5838    2           FR.DEF.FVF = '1'B;

   5838 68 001154   010000 236007                    LDQ     4096,DL
        68 001155   100000 256100                    ORSQ    0,,PR1

      765     5839    2           END;

      766     5840    1       FR.UOFST.EIS = TYPE_430.EIS;

   5840 68 001156   000031 236000 18                 LDQ     IO_BUF+25
        68 001157   000000 471400 45                 LDP1    FR$
        68 001160   100002 756100                    STQ     2,,PR1

      767     5841    1       FR.UOFST.EIS.REG = 1;

   5841 68 001161   000064 376000 69                 ANQ     52
        68 001162   100000 276003                    ORQ     32768,DU
        68 001163   100002 756100                    STQ     2,,PR1

      768     5842    2       DO WHILE ('1'B);

      769     5843    2           CALL FETCHNS_6('FR-CFS   ') ALTRET(END_CFS);

   5843 68 001164   000065 630400 69                 EPPR0   53
        68 001165   000015 631400 69                 EPPR1   13
        68 001166   000000 701000 xent               TSX1    FETCHNS_6
        68 001167   001435 702000 68                 TSX2    END_CFS

      770     5844    2           SAVE_CF_DBK = UWA.DIRECT_REF;

   5844 68 001170   000036 235000 51                 LDA     UWA+30
        68 001171   000015 755000 52                 STA     SAVE_CF_DBK

      771     5845        /*
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:91   
      772     5846              Now search the hash table for the DBK that is in that CF record
      773     5847            so we can find the offset in the schema subset.
      774     5848        */
      775     5849    2           CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);

   5849 68 001172   000044 236000 69                 LDQ     36
        68 001173   200054 756100                    STQ     @DBK+1,,AUTO
        68 001174   000066 236000 69                 LDQ     54
        68 001175   200053 756100                    STQ     CF_TPTR$+2,,AUTO
        68 001176   000022 701000 68                 TSX1    FIND_CF
        68 001177   000000 011000                    NOP     0

      776     5850    2           IF UWA.C_F.CTRLTYPE ~= 4 OR ERROR_FLG ~= 0

   5850 68 001200   000401 235000 51                 LDA     UWA+257
        68 001201   000004 115007                    CMPA    4,DL
        68 001202   001205 601000 68                 TNZ     s:5855
        68 001203   000011 236000 52                 LDQ     ERROR_FLG
        68 001204   001164 600000 68                 TZE     s:5843

      777     5851    3           THEN DO;

      778     5852        /*
      779     5853              Calc control fields don't have a CDSN on the FR.
      780     5854        */
      781     5855    3               IF ERROR_FLG = 0

   5855 68 001205   000011 236000 52                 LDQ     ERROR_FLG
        68 001206   001235 601000 68                 TNZ     s:5871

      782     5856    4               THEN DO;

      783     5857    4                   CALL FINDOS_6('SSSM-CF '); /* find SS for CF */

   5857 68 001207   000067 630400 69                 EPPR0   55
        68 001210   000015 631400 69                 EPPR1   13
        68 001211   000000 701000 xent               TSX1    FINDOS_6
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:92   
        68 001212   000000 011000                    NOP     0

      784     5858    4                   CALL FINDOS_6('SM-SS   '); /* find SM for CF */

   5858 68 001213   000070 630400 69                 EPPR0   56
        68 001214   000015 631400 69                 EPPR1   13
        68 001215   000000 701000 xent               TSX1    FINDOS_6
        68 001216   000000 011000                    NOP     0

      785     5859    4                   CALL FETCHOS_6('SC-SOSM '); /* find SC for CF */

   5859 68 001217   000071 630400 69                 EPPR0   57
        68 001220   000015 631400 69                 EPPR1   13
        68 001221   000000 701000 xent               TSX1    FETCHOS_6
        68 001222   000000 011000                    NOP     0

      786     5860    5                   IF UWA.SC.ALTOWN ~= 2 THEN DO; /* for THEN THRU CFs */

   5860 68 001223   000316 235000 51                 LDA     UWA+206
        68 001224   000002 115007                    CMPA    2,DL
        68 001225   001235 600000 68                 TZE     s:5871

      787     5861         /* don't flag as errors */
      788     5862    5                       CALL ERROR(%ZIG_NO_CF_FR);

   5862 68 001226   000073 630400 69                 EPPR0   59
        68 001227   000015 631400 69                 EPPR1   13
        68 001230   000000 701000 xent               TSX1    ERROR
        68 001231   000000 011000                    NOP     0

      789     5863        /*E*     ERROR:    ZIG-ZIG_NO_CF_FR-C
      790     5864        MESSAGE: This CF record is not already in the schema subset from
      791     5865                 the set information.
      792     5866                 <<<< SOFTWARE ERROR >>>>
      793     5867        */
      794     5868    5                       CALL ABORT;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:93   
   5868 68 001232   000022 631400 69                 EPPR1   18
        68 001233   000000 701000 xent               TSX1    ABORT
        68 001234   000000 011000                    NOP     0

      795     5869    5                       END;

      796     5870    4                   END; /* ERROR not zero */

      797     5871    3               T1PTR$ -> CD.CDSH = LAST_FR;

   5871 68 001235   000000 220000 59                 LDX0    LAST_FR
        68 001236   200047 470500                    LDP0    T1PTR$,,AUTO
        68 001237   000002 740100                    STX0    2,,PR0

      798     5872    3               T1PTR$ -> CD.CDSN = FR.CDSN;

   5872 68 001240   000000 471400 45                 LDP1    FR$
        68 001241   100003 221100                    LDX1    3,,PR1
        68 001242   000003 741100                    STX1    3,,PR0

      799     5873    3               FR.CDSN = CURRENT_CF;

   5873 68 001243   000000 222000 61                 LDX2    CURRENT_CF
        68 001244   100003 742100                    STX2    3,,PR1

      800     5874    3               IF TYPE_430.REF_LINE ~= 0

   5874 68 001245   000001 235000 18                 LDA     IO_BUF+1
        68 001246   001164 600000 68                 TZE     s:5843

      801     5875    4               THEN DO;

      802     5876    4                   T5PTR$ = PINCRW(SSS$,T1PTR$ -> CD.RSCDH);

   5876 68 001247   000001 721100                    LXL1    1,,PR0
        68 001250   000000 636011                    EAQ     0,X1
        68 001251   000000 036000 38                 ADLQ    SSS$
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:94   
        68 001252   000012 756000 52                 STQ     T5PTR$

      803     5877    4                   IF T5PTR$ -> RS.DEF.TYPE = '000000001000'B

   5877 68 001253   000012 473400 52                 LDP3    T5PTR$
        68 001254   300000 236100                    LDQ     0,,PR3
        68 001255   777700 376003                    ANQ     -64,DU
        68 001256   001000 116003                    CMPQ    512,DU
        68 001257   001267 601000 68                 TNZ     s:5883

      804     5878    5                   THEN DO;

      805     5879    5                       T5PTR$ = PINCRW(SSS$,T5PTR$ -> SS.RSSSH);

   5879 68 001260   300002 723100                    LXL3    2,,PR3
        68 001261   000000 636013                    EAQ     0,X3
        68 001262   000000 036000 38                 ADLQ    SSS$
        68 001263   000012 756000 52                 STQ     T5PTR$

      806     5880    5                       TYPE_34.THEN_THRU_FIELD = '1'B;

   5880 68 001264   200000 236003                    LDQ     65536,DU
        68 001265   000004 256000 20                 ORSQ    TYPE_34+4

      807     5881    5                       END;

   5881 68 001266   001271 710000 68                 TRA     s:5885

      808     5882    5                   ELSE DO;

      809     5883    5                       TYPE_34.THEN_THRU_FIELD = '0'B;

   5883 68 001267   000074 236000 69                 LDQ     60
        68 001270   000004 356000 20                 ANSQ    TYPE_34+4

      810     5884    5                       END;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:95   
      811     5885    4                   T6PTR$ = PINCRW(SSS$,T5PTR$ -> RS.SCRSH);

   5885 68 001271   000012 473400 52                 LDP3    T5PTR$
        68 001272   300003 721100                    LXL1    3,,PR3
        68 001273   000000 636011                    EAQ     0,X1
        68 001274   000000 036000 38                 ADLQ    SSS$
        68 001275   000013 756000 52                 STQ     T6PTR$

      812     5886    4                   IF SUBSTR(T6PTR$ -> SC.SNAM,0,1) = '*'

   5886 68 001276   000013 474400 52                 LDP4    T6PTR$
        68 001277   400000 723100                    LXL3    0,,PR4
        68 001300   000077 363003                    ANX3    63,DU
        68 001301   400003 236100                    LDQ     3,,PR4
        68 001302   777000 376003                    ANQ     -512,DU
        68 001303   052000 116003                    CMPQ    21504,DU
        68 001304   001314 601000 68                 TNZ     s:5894

      813     5887    5                   THEN DO;

      814     5888    5                       IF T6PTR$ -> SC.SNAM = '*CALC'

   5888 68 001305   040000 106540                    CMPC    fill='040'O
        68 001306   400003 000013                    ADSC9   3,,PR4                   cn=0,n=*X3
        68 001307   000634 000005 67                 ADSC9   FMAP_CKI+152             cn=0,n=5
        68 001310   001164 601000 68                 TNZ     s:5843

      815     5889    6                       THEN DO;

      816     5890    6                           TYPE_430.PRIMARY_CON_FIELD = '1'B;

   5890 68 001311   100000 236003                    LDQ     32768,DU
        68 001312   000030 256000 18                 ORSQ    IO_BUF+24

      817     5891    6                           END;

      818     5892    5                       END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:96   

   5892 68 001313   001164 710000 68                 TRA     s:5843

      819     5893    5                   ELSE DO;

      820     5894    5                       IF NOT T6PTR$->SC.DEF.SRCR

   5894 68 001314   400000 236100                    LDQ     0,,PR4
        68 001315   004000 316007                    CANQ    2048,DL
        68 001316   001164 601000 68                 TNZ     s:5843

      821     5895    6                       THEN DO;

      822     5896    6                           IF (T6PTR$->SC.DEF.SETT = 3) OR (T6PTR$->SC.DEF.SETT = 2)

   5896 68 001317   400000 236100                    LDQ     0,,PR4
        68 001320   000700 376007                    ANQ     448,DL
        68 001321   000300 116007                    CMPQ    192,DL
        68 001322   001325 600000 68                 TZE     s:5898
        68 001323   000200 116007                    CMPQ    128,DL
        68 001324   001365 601000 68                 TNZ     s:5906

      823     5897    7                           THEN DO;

      824     5898    7                               TYPE_35.FIELD_NAME = TYPE_430.OFFSET;

   5898 68 001325   000023 235000 18                 LDA     IO_BUF+19
        68 001326   000001 755000 21                 STA     TYPE_35+1

      825     5899    7                               TYPE_35.KEY_NAME = T6PTR$ -> SC.SCID;

   5899 68 001327   400002 236100                    LDQ     2,,PR4
        68 001330   777777 376007                    ANQ     -1,DL
        68 001331   000002 756000 21                 STQ     TYPE_35+2

      826     5900    7                               TYPE_35.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:97   
   5900 68 001332   040000 100400                    MLR     fill='040'O
        68 001333   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        68 001334   000005 000040 21                 ADSC9   TYPE_35+5                cn=0,n=32

      827     5901    7                               TYPE_35.SUB_KEY_NM = T6PTR$ -> SC.SNAM;

   5901 68 001335   400000 721100                    LXL1    0,,PR4
        68 001336   000077 361003                    ANX1    63,DU
        68 001337   040000 100540                    MLR     fill='040'O
        68 001340   400003 000011                    ADSC9   3,,PR4                   cn=0,n=*X1
        68 001341   000015 000040 21                 ADSC9   TYPE_35+13               cn=0,n=32

      828     5902    7                               TYPE_35.SUB_RECORD_NM = RC.RNAM;

   5902 68 001342   000000 475400 41                 LDP5    RC$
        68 001343   500000 721100                    LXL1    0,,PR5
        68 001344   000077 361003                    ANX1    63,DU
        68 001345   040000 100540                    MLR     fill='040'O
        68 001346   500005 000011                    ADSC9   5,,PR5                   cn=0,n=*X1
        68 001347   000025 000040 21                 ADSC9   TYPE_35+21               cn=0,n=32

      829     5903    7                               CALL UPUT('5*',ADDR(TYPE_35),32);

   5903 68 001350   000075 236000 69                 LDQ     61
        68 001351   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 001352   000077 236000 69                 LDQ     63
        68 001353   200061 756100                    STQ     SEARCH_STR+4,,AUTO
        68 001354   200056 636500                    EPPR6   SEARCH_STR+1,,AUTO
        68 001355   200060 456500                    STP6    SEARCH_STR+3,,AUTO
        68 001356   000100 236000 69                 LDQ     64
        68 001357   200057 756100                    STQ     SEARCH_STR+2,,AUTO
        68 001360   200057 630500                    EPPR0   SEARCH_STR+2,,AUTO
        68 001361   000002 631400 69                 EPPR1   2
        68 001362   000000 701000 xent               TSX1    UPUT
        68 001363   000000 011000                    NOP     0

      830     5904    7                               END;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:98   

   5904 68 001364   001431 710000 68                 TRA     s:5914

      831     5905    7                           ELSE DO;

      832     5906    7                               TYPE_34.ASSEND_OR_DESCEND = T1PTR$ -> CD.DEF.CONT;

   5906 68 001365   000000 236100                    LDQ     0,,PR0
        68 001366   000015 736000                    QLS     13
        68 001367   000004 676000 20                 ERQ     TYPE_34+4
        68 001370   400000 376003                    ANQ     -131072,DU
        68 001371   000004 656000 20                 ERSQ    TYPE_34+4

      833     5907    7                               TYPE_34.FIELD_NAME = TYPE_430.OFFSET;

   5907 68 001372   000023 236000 18                 LDQ     IO_BUF+19
        68 001373   000001 756000 20                 STQ     TYPE_34+1

      834     5908    7                               TYPE_34.SET_NAME = T6PTR$ -> SC.SCID;

   5908 68 001374   400002 236100                    LDQ     2,,PR4
        68 001375   777777 376007                    ANQ     -1,DL
        68 001376   000002 756000 20                 STQ     TYPE_34+2

      835     5909    7                               TYPE_34.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;

   5909 68 001377   040000 100400                    MLR     fill='040'O
        68 001400   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        68 001401   000005 000040 20                 ADSC9   TYPE_34+5                cn=0,n=32

      836     5910    7                               TYPE_34.SUB_SET_NM = T6PTR$ -> SC.SNAM;

   5910 68 001402   400000 721100                    LXL1    0,,PR4
        68 001403   000077 361003                    ANX1    63,DU
        68 001404   040000 100540                    MLR     fill='040'O
        68 001405   400003 000011                    ADSC9   3,,PR4                   cn=0,n=*X1
        68 001406   000015 000040 20                 ADSC9   TYPE_34+13               cn=0,n=32
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:99   

      837     5911    7                               TYPE_34.SUB_RECORD_NM = RC.RNAM;

   5911 68 001407   000000 475400 41                 LDP5    RC$
        68 001410   500000 721100                    LXL1    0,,PR5
        68 001411   000077 361003                    ANX1    63,DU
        68 001412   040000 100540                    MLR     fill='040'O
        68 001413   500005 000011                    ADSC9   5,,PR5                   cn=0,n=*X1
        68 001414   000025 000040 20                 ADSC9   TYPE_34+21               cn=0,n=32

      838     5912    7                               CALL UPUT('5*',ADDR(TYPE_34),32);

   5912 68 001415   000101 236000 69                 LDQ     65
        68 001416   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 001417   000077 236000 69                 LDQ     63
        68 001420   200061 756100                    STQ     SEARCH_STR+4,,AUTO
        68 001421   200056 636500                    EPPR6   SEARCH_STR+1,,AUTO
        68 001422   200060 456500                    STP6    SEARCH_STR+3,,AUTO
        68 001423   000100 236000 69                 LDQ     64
        68 001424   200057 756100                    STQ     SEARCH_STR+2,,AUTO
        68 001425   200057 630500                    EPPR0   SEARCH_STR+2,,AUTO
        68 001426   000002 631400 69                 EPPR1   2
        68 001427   000000 701000 xent               TSX1    UPUT
        68 001430   000000 011000                    NOP     0

      839     5913    7                               END;

      840     5914    6                           CONTROL.NUM_FIELD_SET = CONTROL.NUM_FIELD_SET + 1;

   5914 68 001431   000002 235000 17                 LDA     CONTROL+2
        68 001432   000001 035007                    ADLA    1,DL
        68 001433   000002 755000 17                 STA     CONTROL+2

      841     5915    6                           END;

      842     5916    5                       END;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:100  
      843     5917    4                   END;

      844     5918    3               END;

      845     5919    2           END;

   5919 68 001434   001164 710000 68                 TRA     s:5843

      846     5920    1   END_CFS:
      847     5921    1       CALL FCURR_R_6('FR  ');

   5921 68 001435   000054 630400 69    END_CFS      EPPR0   44
        68 001436   000015 631400 69                 EPPR1   13
        68 001437   000000 701000 xent               TSX1    FCURR_R_6
        68 001440   000000 011000                    NOP     0

      848     5922    2       DO WHILE ('1'B);

      849     5923    2           CALL FETCHNS_6('FR-CFR   ') ALTRET(END_CFR);

   5923 68 001441   000102 630400 69                 EPPR0   66
        68 001442   000015 631400 69                 EPPR1   13
        68 001443   000000 701000 xent               TSX1    FETCHNS_6
        68 001444   001661 702000 68                 TSX2    END_CFR

      850     5924    2           SAVE_CF_DBK = UWA.DIRECT_REF;

   5924 68 001445   000036 235000 51                 LDA     UWA+30
        68 001446   000015 755000 52                 STA     SAVE_CF_DBK

      851     5925        /*
      852     5926              Now search the hash table for the DBK that is in that CF record
      853     5927            so we can find the offset in the schema subset.
      854     5928        */
      855     5929    2           CALL FIND_CF(SAVE_CF_DBK,ERROR_FLG);

   5929 68 001447   000044 236000 69                 LDQ     36
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:101  
        68 001450   200054 756100                    STQ     @DBK+1,,AUTO
        68 001451   000066 236000 69                 LDQ     54
        68 001452   200053 756100                    STQ     CF_TPTR$+2,,AUTO
        68 001453   000022 701000 68                 TSX1    FIND_CF
        68 001454   000000 011000                    NOP     0

      856     5930    2           IF UWA.C_F.CTRLTYPE ~= 4 OR ERROR_FLG ~= 0

   5930 68 001455   000401 235000 51                 LDA     UWA+257
        68 001456   000004 115007                    CMPA    4,DL
        68 001457   001462 601000 68                 TNZ     s:5935
        68 001460   000011 236000 52                 LDQ     ERROR_FLG
        68 001461   001441 600000 68                 TZE     s:5923

      857     5931    3           THEN DO;

      858     5932        /*
      859     5933              Calc control fields don't have a CDRN on the FR.
      860     5934        */
      861     5935    3               IF ERROR_FLG = 0

   5935 68 001462   000011 236000 52                 LDQ     ERROR_FLG
        68 001463   001473 601000 68                 TNZ     s:5945

      862     5936    4               THEN DO;

      863     5937    4                   CALL ERROR(%ZIG_NO_CF_FR);

   5937 68 001464   000073 630400 69                 EPPR0   59
        68 001465   000015 631400 69                 EPPR1   13
        68 001466   000000 701000 xent               TSX1    ERROR
        68 001467   000000 011000                    NOP     0

      864     5938        /*       ERROR:    ZIG-ZIG_NO_CF_FR-C
      865     5939        MESSAGE: This CF record is not already in the schema subset from
      866     5940                 the set information.
      867     5941                 <<<< SOFTWARE ERROR >>>>
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:102  
      868     5942        */
      869     5943    4                   CALL ABORT;

   5943 68 001470   000022 631400 69                 EPPR1   18
        68 001471   000000 701000 xent               TSX1    ABORT
        68 001472   000000 011000                    NOP     0

      870     5944    4                   END;

      871     5945    3               T1PTR$ -> CD.CDRH = LAST_FR;

   5945 68 001473   000000 220000 59                 LDX0    LAST_FR
        68 001474   200047 470500                    LDP0    T1PTR$,,AUTO
        68 001475   000002 440100                    SXL0    2,,PR0

      872     5946    3               T1PTR$ -> CD.CDRN = FR.CDRN;

   5946 68 001476   000000 471400 45                 LDP1    FR$
        68 001477   100003 721100                    LXL1    3,,PR1
        68 001500   000003 441100                    SXL1    3,,PR0

      873     5947    3               FR.CDRN = CURRENT_CF;

   5947 68 001501   000000 222000 61                 LDX2    CURRENT_CF
        68 001502   100003 442100                    SXL2    3,,PR1

      874     5948    3               IF TYPE_430.REF_LINE ~= 0

   5948 68 001503   000001 235000 18                 LDA     IO_BUF+1
        68 001504   001441 600000 68                 TZE     s:5923

      875     5949    4               THEN DO;

      876     5950    4                   T5PTR$ = PINCRW(SSS$,T1PTR$ -> CD.RSCDH);

   5950 68 001505   000001 721100                    LXL1    1,,PR0
        68 001506   000000 636011                    EAQ     0,X1
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:103  
        68 001507   000000 036000 38                 ADLQ    SSS$
        68 001510   000012 756000 52                 STQ     T5PTR$

      877     5951    4                   IF T5PTR$ -> RS.DEF.TYPE = '000000001000'B

   5951 68 001511   000012 473400 52                 LDP3    T5PTR$
        68 001512   300000 236100                    LDQ     0,,PR3
        68 001513   777700 376003                    ANQ     -64,DU
        68 001514   001000 116003                    CMPQ    512,DU
        68 001515   001522 601000 68                 TNZ     s:5955

      878     5952    5                   THEN DO;

      879     5953    5                       T5PTR$ = PINCRW(SSS$,T5PTR$ -> SS.RSSSH);

   5953 68 001516   300002 723100                    LXL3    2,,PR3
        68 001517   000000 636013                    EAQ     0,X3
        68 001520   000000 036000 38                 ADLQ    SSS$
        68 001521   000012 756000 52                 STQ     T5PTR$

      880     5954    5                       END;

      881     5955    4                   T6PTR$ = PINCRW(SSS$,T5PTR$ -> RS.SCRSH);

   5955 68 001522   000012 473400 52                 LDP3    T5PTR$
        68 001523   300003 723100                    LXL3    3,,PR3
        68 001524   000000 636013                    EAQ     0,X3
        68 001525   000000 036000 38                 ADLQ    SSS$
        68 001526   000013 756000 52                 STQ     T6PTR$

      882     5956    4                   IF SUBSTR(T6PTR$ -> SC.SNAM,0,1) = '*'

   5956 68 001527   000013 474400 52                 LDP4    T6PTR$
        68 001530   400000 724100                    LXL4    0,,PR4
        68 001531   000077 364003                    ANX4    63,DU
        68 001532   400003 236100                    LDQ     3,,PR4
        68 001533   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:104  
        68 001534   052000 116003                    CMPQ    21504,DU
        68 001535   001545 601000 68                 TNZ     s:5964

      883     5957    5                   THEN DO;

      884     5958    5                       IF T6PTR$ -> SC.SNAM = '*CALC'

   5958 68 001536   040000 106540                    CMPC    fill='040'O
        68 001537   400003 000014                    ADSC9   3,,PR4                   cn=0,n=*X4
        68 001540   000634 000005 67                 ADSC9   FMAP_CKI+152             cn=0,n=5
        68 001541   001441 601000 68                 TNZ     s:5923

      885     5959    6                       THEN DO;

      886     5960    6                           TYPE_430.PRIMARY_CON_FIELD = '1'B;

   5960 68 001542   100000 236003                    LDQ     32768,DU
        68 001543   000030 256000 18                 ORSQ    IO_BUF+24

      887     5961    6                           END;

      888     5962    5                       END;

   5962 68 001544   001441 710000 68                 TRA     s:5923

      889     5963    5                   ELSE DO;

      890     5964    5                       IF NOT T6PTR$->SC.DEF.SRCR

   5964 68 001545   400000 236100                    LDQ     0,,PR4
        68 001546   004000 316007                    CANQ    2048,DL
        68 001547   001441 601000 68                 TNZ     s:5923

      891     5965    6                       THEN DO;

      892     5966    6                           IF (T6PTR$ -> SC.DEF.SETT = 3) OR (T6PTR$->SC.DEF.SETT = 2)

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:105  
   5966 68 001550   400000 236100                    LDQ     0,,PR4
        68 001551   000700 376007                    ANQ     448,DL
        68 001552   000300 116007                    CMPQ    192,DL
        68 001553   001556 600000 68                 TZE     s:5968
        68 001554   000200 116007                    CMPQ    128,DL
        68 001555   001616 601000 68                 TNZ     s:5976

      893     5967    7                           THEN DO;

      894     5968    7                               TYPE_35.FIELD_NAME = TYPE_430.OFFSET;

   5968 68 001556   000023 235000 18                 LDA     IO_BUF+19
        68 001557   000001 755000 21                 STA     TYPE_35+1

      895     5969    7                               TYPE_35.KEY_NAME = T6PTR$ -> SC.SCID;

   5969 68 001560   400002 236100                    LDQ     2,,PR4
        68 001561   777777 376007                    ANQ     -1,DL
        68 001562   000002 756000 21                 STQ     TYPE_35+2

      896     5970    7                               TYPE_35.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;

   5970 68 001563   040000 100400                    MLR     fill='040'O
        68 001564   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        68 001565   000005 000040 21                 ADSC9   TYPE_35+5                cn=0,n=32

      897     5971    7                               TYPE_35.SUB_KEY_NM = T6PTR$ -> SC.SNAM;

   5971 68 001566   400000 721100                    LXL1    0,,PR4
        68 001567   000077 361003                    ANX1    63,DU
        68 001570   040000 100540                    MLR     fill='040'O
        68 001571   400003 000011                    ADSC9   3,,PR4                   cn=0,n=*X1
        68 001572   000015 000040 21                 ADSC9   TYPE_35+13               cn=0,n=32

      898     5972    7                               TYPE_35.SUB_RECORD_NM = RC.RNAM;

   5972 68 001573   000000 475400 41                 LDP5    RC$
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:106  
        68 001574   500000 721100                    LXL1    0,,PR5
        68 001575   000077 361003                    ANX1    63,DU
        68 001576   040000 100540                    MLR     fill='040'O
        68 001577   500005 000011                    ADSC9   5,,PR5                   cn=0,n=*X1
        68 001600   000025 000040 21                 ADSC9   TYPE_35+21               cn=0,n=32

      899     5973    7                               CALL UPUT('5*',ADDR(TYPE_35),32);

   5973 68 001601   000075 236000 69                 LDQ     61
        68 001602   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 001603   000077 236000 69                 LDQ     63
        68 001604   200061 756100                    STQ     SEARCH_STR+4,,AUTO
        68 001605   200056 636500                    EPPR6   SEARCH_STR+1,,AUTO
        68 001606   200060 456500                    STP6    SEARCH_STR+3,,AUTO
        68 001607   000100 236000 69                 LDQ     64
        68 001610   200057 756100                    STQ     SEARCH_STR+2,,AUTO
        68 001611   200057 630500                    EPPR0   SEARCH_STR+2,,AUTO
        68 001612   000002 631400 69                 EPPR1   2
        68 001613   000000 701000 xent               TSX1    UPUT
        68 001614   000000 011000                    NOP     0

      900     5974    7                               END;

   5974 68 001615   001655 710000 68                 TRA     s:5983

      901     5975    7                           ELSE DO;

      902     5976    7                               TYPE_34.FIELD_NAME = TYPE_430.OFFSET;

   5976 68 001616   000023 235000 18                 LDA     IO_BUF+19
        68 001617   000001 755000 20                 STA     TYPE_34+1

      903     5977    7                               TYPE_34.SET_NAME = T6PTR$ -> SC.SCID;

   5977 68 001620   400002 236100                    LDQ     2,,PR4
        68 001621   777777 376007                    ANQ     -1,DL
        68 001622   000002 756000 20                 STQ     TYPE_34+2
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:107  

      904     5978    7                               TYPE_34.SUB_FIELD_NM = TYPE_430.SUB_FIELD_NAME;

   5978 68 001623   040000 100400                    MLR     fill='040'O
        68 001624   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        68 001625   000005 000040 20                 ADSC9   TYPE_34+5                cn=0,n=32

      905     5979    7                               TYPE_34.SUB_SET_NM = T6PTR$ -> SC.SNAM;

   5979 68 001626   400000 721100                    LXL1    0,,PR4
        68 001627   000077 361003                    ANX1    63,DU
        68 001630   040000 100540                    MLR     fill='040'O
        68 001631   400003 000011                    ADSC9   3,,PR4                   cn=0,n=*X1
        68 001632   000015 000040 20                 ADSC9   TYPE_34+13               cn=0,n=32

      906     5980    7                               TYPE_34.SUB_RECORD_NM = RC.RNAM;

   5980 68 001633   000000 475400 41                 LDP5    RC$
        68 001634   500000 721100                    LXL1    0,,PR5
        68 001635   000077 361003                    ANX1    63,DU
        68 001636   040000 100540                    MLR     fill='040'O
        68 001637   500005 000011                    ADSC9   5,,PR5                   cn=0,n=*X1
        68 001640   000025 000040 20                 ADSC9   TYPE_34+21               cn=0,n=32

      907     5981    7                               CALL UPUT('5*',ADDR(TYPE_34),32);

   5981 68 001641   000101 236000 69                 LDQ     65
        68 001642   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 001643   000077 236000 69                 LDQ     63
        68 001644   200061 756100                    STQ     SEARCH_STR+4,,AUTO
        68 001645   200056 636500                    EPPR6   SEARCH_STR+1,,AUTO
        68 001646   200060 456500                    STP6    SEARCH_STR+3,,AUTO
        68 001647   000100 236000 69                 LDQ     64
        68 001650   200057 756100                    STQ     SEARCH_STR+2,,AUTO
        68 001651   200057 630500                    EPPR0   SEARCH_STR+2,,AUTO
        68 001652   000002 631400 69                 EPPR1   2
        68 001653   000000 701000 xent               TSX1    UPUT
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:108  
        68 001654   000000 011000                    NOP     0

      908     5982    7                               END;

      909     5983    6                           CONTROL.NUM_FIELD_SET = CONTROL.NUM_FIELD_SET + 1;

   5983 68 001655   000002 235000 17                 LDA     CONTROL+2
        68 001656   000001 035007                    ADLA    1,DL
        68 001657   000002 755000 17                 STA     CONTROL+2

      910     5984    6                           END;

      911     5985    5                       END;

      912     5986    4                   END;

      913     5987    3               END;

      914     5988    2           END;

   5988 68 001660   001441 710000 68                 TRA     s:5923

      915     5989    1   END_CFR:
      916     5990    1       IF UWA.DB_STATUS ~= '0502100' THEN CALL ABORT;

   5990 68 001661   040000 106400       END_CFR      CMPC    fill='040'O
        68 001662   000001 000007 51                 ADSC9   UWA+1                    cn=0,n=7
        68 001663   000642 000007 67                 ADSC9   FMAP_CKI+158             cn=0,n=7
        68 001664   001670 600000 68                 TZE     s:5991

   5990 68 001665   000022 631400 69                 EPPR1   18
        68 001666   000000 701000 xent               TSX1    ABORT
        68 001667   000000 011000                    NOP     0

      917     5991    1       IF ~TYPE_430.ELEMENTARY

   5991 68 001670   000030 236000 18                 LDQ     IO_BUF+24
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:109  
        68 001671   400000 376003                    ANQ     -131072,DU
        68 001672   400000 676003                    ERQ     -131072,DU
        68 001673   002006 600000 68                 TZE     s:6041

      918     5992    2       THEN DO;

      919     5993    2           IN_GROUP = '1'B;

   5993 68 001674   400000 236003                    LDQ     -131072,DU
        68 001675   000000 756000 55                 STQ     IN_GROUP

      920     5994    2           LAST_GROUP_LEVEL = TYPE_430.LEVEL_FIELD;

   5994 68 001676   000027 235000 18                 LDA     IO_BUF+23
        68 001677   000000 755000 56                 STA     LAST_GROUP_LEVEL

      921     5995    2           IF UWA.FR.FTYPE = 1 OR

   5995 68 001700   000334 235000 51                 LDA     UWA+220
        68 001701   000001 115007                    CMPA    1,DL
        68 001702   001725 600000 68                 TZE     s:6009
        68 001703   000002 115007                    CMPA    2,DL
        68 001704   001725 600000 68                 TZE     s:6009
        68 001705   000003 115007                    CMPA    3,DL
        68 001706   001725 600000 68                 TZE     s:6009
        68 001707   000005 115007                    CMPA    5,DL
        68 001710   001725 600000 68                 TZE     s:6009
        68 001711   000007 115007                    CMPA    7,DL
        68 001712   001725 600000 68                 TZE     s:6009
        68 001713   000011 115007                    CMPA    9,DL
        68 001714   001725 600000 68                 TZE     s:6009
        68 001715   000012 115007                    CMPA    10,DL
        68 001716   001725 600000 68                 TZE     s:6009
        68 001717   000015 115007                    CMPA    13,DL
        68 001720   001725 600000 68                 TZE     s:6009
        68 001721   000016 115007                    CMPA    14,DL
        68 001722   001725 600000 68                 TZE     s:6009
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:110  
        68 001723   000023 115007                    CMPA    19,DL
        68 001724   001757 601000 68                 TNZ     s:6026

      922     5996    2              UWA.FR.FTYPE = 2 OR
      923     5997    2              UWA.FR.FTYPE = 3 OR
      924     5998    2              UWA.FR.FTYPE = 5 OR
      925     5999    2              UWA.FR.FTYPE = 7 OR
      926     6000    2              UWA.FR.FTYPE = 9 OR
      927     6001    2              UWA.FR.FTYPE = 10 OR
      928     6002    2              UWA.FR.FTYPE = 13 OR
      929     6003    2              UWA.FR.FTYPE = 14 OR
      930     6004    2              UWA.FR.FTYPE = 19
      931     6005    3           THEN DO;

      932     6006        /*
      933     6007              Group item is ok for this data type.
      934     6008        */
      935     6009    3               IF UWA.FR.PREC < TYPE_430.LEN_FIELD

   6009 68 001725   000335 236000 51                 LDQ     UWA+221
        68 001726   001731 604000 68                 TMI     s:6011
        68 001727   000025 116000 18                 CMPQ    IO_BUF+21
        68 001730   002006 603000 68                 TRC     s:6041

      936     6010    4               THEN DO;

      937     6011    4                   CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);

   6011 68 001731   000005 630400 69                 EPPR0   5
        68 001732   000002 631400 69                 EPPR1   2
        68 001733   000000 701000 xent               TSX1    SET_FIELDS
        68 001734   000000 011000                    NOP     0

      938     6012    4                   I = RC.DEF.RNL;

   6012 68 001735   000000 470400 41                 LDP0    RC$
        68 001736   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:111  
        68 001737   000077 376007                    ANQ     63,DL
        68 001740   000000 756000 52                 STQ     I

      939     6013    4                   CALL SET_FIELDS(2,I,RC.RNAM);

   6013 68 001741   000000 236000 41                 LDQ     RC$
        68 001742   000005 036003                    ADLQ    5,DU
        68 001743   200060 756100                    STQ     SEARCH_STR+3,,AUTO
        68 001744   000024 237000 69                 LDAQ    20
        68 001745   200056 757100                    STAQ    SEARCH_STR+1,,AUTO
        68 001746   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 001747   000002 631400 69                 EPPR1   2
        68 001750   000000 701000 xent               TSX1    SET_FIELDS
        68 001751   000000 011000                    NOP     0

      940     6014    4                   CALL WARNING(%ZIG_V_GROUP_TO_BIG);

   6014 68 001752   000104 630400 69                 EPPR0   68
        68 001753   000015 631400 69                 EPPR1   13
        68 001754   000000 701000 xent               TSX1    WARNING
        68 001755   000000 011000                    NOP     0

      941     6015        /*E*     ERROR:    ZIG-ZIG_V_GROUP_TO_BIG-C
      942     6016        MESSAGE: For the group named "%U1" in the record "%U2"
      943     6017                 the length in the subschema is longer than the maximum
      944     6018                 length for the item in the schema file.
      945     6019                 The items after the schema length will not be put
      946     6020                 into the area and a get will not fill this space.
      947     6021                 Note: treated as a user defined variable in the UWA.
      948     6022        */
      949     6023    4                   END;

      950     6024    3               END;

   6024 68 001756   002006 710000 68                 TRA     s:6041

      951     6025    3           ELSE DO;
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:112  

      952     6026    3               CALL SET_FIELDS(1,30,TYPE_430.SUB_FIELD_NAME);

   6026 68 001757   000005 630400 69                 EPPR0   5
        68 001760   000002 631400 69                 EPPR1   2
        68 001761   000000 701000 xent               TSX1    SET_FIELDS
        68 001762   000000 011000                    NOP     0

      953     6027    3               I = RC.DEF.RNL;

   6027 68 001763   000000 470400 41                 LDP0    RC$
        68 001764   000000 236100                    LDQ     0,,PR0
        68 001765   000077 376007                    ANQ     63,DL
        68 001766   000000 756000 52                 STQ     I

      954     6028    3               CALL SET_FIELDS(2,I,RC.RNAM);

   6028 68 001767   000000 236000 41                 LDQ     RC$
        68 001770   000005 036003                    ADLQ    5,DU
        68 001771   200060 756100                    STQ     SEARCH_STR+3,,AUTO
        68 001772   000024 237000 69                 LDAQ    20
        68 001773   200056 757100                    STAQ    SEARCH_STR+1,,AUTO
        68 001774   200056 630500                    EPPR0   SEARCH_STR+1,,AUTO
        68 001775   000002 631400 69                 EPPR1   2
        68 001776   000000 701000 xent               TSX1    SET_FIELDS
        68 001777   000000 011000                    NOP     0

      955     6029    3               CALL ERROR(%ZIG_V_GROUP_BAD_DATA);

   6029 68 002000   000106 630400 69                 EPPR0   70
        68 002001   000015 631400 69                 EPPR1   13
        68 002002   000000 701000 xent               TSX1    ERROR
        68 002003   000000 011000                    NOP     0

      956     6030        /*E*     ERROR:    ZIG-ZIG_V_GROUP_BAD_DATA-C
      957     6031        MESSAGE: For the group named "%U1" in the record "%U2"
      958     6032                 the schema data type does not allow groups under it.
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:113  
      959     6033                 The allowed group data types are:
      960     6034                      BINARY 18,36,72
      961     6035                      CHARACTER ,UNSPEC
      962     6036                      OR UNSIGNED PACKED DEC.
      963     6037        */
      964     6038    3               FIELD_ERRORED = '1'B;

   6038 68 002004   400000 236003                    LDQ     -131072,DU
        68 002005   000000 756000 65                 STQ     FIELD_ERRORED

      965     6039    3               END;

      966     6040    2           END;

      967     6041    1       CALL GET_ENCODE_DECODE;

   6041 68 002006   000154 701000 68                 TSX1    GET_ENCODE_DECODE
        68 002007   000000 011000                    NOP     0

      968     6042    1       IF TYPE_430.REF_LINE ~= 0

   6042 68 002010   000001 235000 18                 LDA     IO_BUF+1
        68 002011   002371 600000 68                 TZE     s:6117

      969     6043    2       THEN DO;

      970     6044    2           TYPE_430.INFO = FR.DEF;

   6044 68 002012   000000 470400 45                 LDP0    FR$
        68 002013   000000 236100                    LDQ     0,,PR0
        68 002014   000032 756000 18                 STQ     IO_BUF+26

      971     6045    2           IF UWA.FR.FTYPE = 0

   6045 68 002015   000334 235000 51                 LDA     UWA+220
        68 002016   002022 601000 68                 TNZ     s:6047

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:114  
      972     6046    2           THEN TYPE_430.SCHEMA_DBKEY = '1'B;

   6046 68 002017   040000 236003                    LDQ     16384,DU
        68 002020   000030 256000 18                 ORSQ    IO_BUF+24
        68 002021   002024 710000 68                 TRA     s:6048

      973     6047    2           ELSE TYPE_430.SCHEMA_DBKEY = '0'B;

   6047 68 002022   000107 236000 69                 LDQ     71
        68 002023   000030 356000 18                 ANSQ    IO_BUF+24

      974     6048    2           IF FIELD_ERRORED

   6048 68 002024   000000 234000 65                 SZN     FIELD_ERRORED
        68 002025   002032 605000 68                 TPL     s:6053

      975     6049    3           THEN DO;

      976     6050    3               TYPE_430.FLAGS.TYPE = '111111111110'B;

   6050 68 002026   777600 236003                    LDQ     -128,DU
        68 002027   000032 752060 18                 STCQ    IO_BUF+26,'60'O

      977     6051    3               CONTROL.BITS.ALL_FIELDS = '0'B;

   6051 68 002030   000030 236000 69                 LDQ     24
        68 002031   000071 356000 17                 ANSQ    CONTROL+57

      978     6052    3               END;

      979     6053    2           CALL WRITSF(CURRENT_RECORD,IO_BUF);

   6053 68 002032   000032 630400 69                 EPPR0   26
        68 002033   000031 631400 69                 EPPR1   25
        68 002034   000000 701000 xent               TSX1    WRITSF
        68 002035   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:115  
      980     6054    2           IF VALIDS.RECORD_XREF

   6054 68 002036   000000 236000 5                  LDQ     VALIDS
        68 002037   000020 316003                    CANQ    16,DU
        68 002040   002371 600000 68                 TZE     s:6117

      981     6055    3           THEN DO;

      982     6056    3               I = FR.UOFST.EIS.FRID/8;

   6056 68 002041   000000 470400 45                 LDP0    FR$
        68 002042   000002 236100                    LDQ     2,,PR0
        68 002043   000017 772000                    QRL     15
        68 002044   777777 376007                    ANQ     -1,DL
        68 002045   000003 772000                    QRL     3
        68 002046   000000 756000 52                 STQ     I

      983     6057    3               CALL SET_FIELD_NUM(1,I);

   6057 68 002047   000110 630400 69                 EPPR0   72
        68 002050   000031 631400 69                 EPPR1   25
        68 002051   000000 701000 xent               TSX1    SET_FIELD_NUM
        68 002052   000000 011000                    NOP     0

      984     6058    3               WORD_OFFSET = ' ';

   6058 68 002053   040000 100400                    MLR     fill='040'O
        68 002054   000000 000001 69                 ADSC9   0                        cn=0,n=1
        68 002055   000063 000006 52                 ADSC9   WORD_OFFSET              cn=0,n=6

      985     6059    3               CALL INSERT(WORD_OFFSET,5-FIELD1.COUNT1,FIELD1.COUNT1,

   6059 68 002056   000000 236000 66                 LDQ     FIELD1
        68 002057   000033 772000                    QRL     27
        68 002060   000000 620006                    EAX0    0,QL
        68 002061   000000 236000 66                 LDQ     FIELD1
        68 002062   000033 772000                    QRL     27
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:116  
        68 002063   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 002064   000000 235003                    LDA     0,DU
        68 002065   200056 135100                    SBLA    SEARCH_STR+1,,AUTO
        68 002066   000000 621006                    EAX1    0,QL
        68 002067   040045 100440                    MLR     fill='040'O
        68 002070   000000 200010 66                 ADSC9   FIELD1                   cn=1,n=*X0
        68 002071   000064 200011 52                 ADSC9   WORD_OFFSET+1,A          cn=1,n=*X1

      986     6060    3                  SUBSTR(FIELD1.TEXT1,0,FIELD1.COUNT1));
      987     6061    3               I = ( FR.UOFST.EIS.FRID - (I * 8)) / 2;

   6061 68 002072   000000 470400 45                 LDP0    FR$
        68 002073   000002 236100                    LDQ     2,,PR0
        68 002074   000017 772000                    QRL     15
        68 002075   777777 376007                    ANQ     -1,DL
        68 002076   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 002077   000000 236003                    LDQ     0,DU
        68 002100   000000 136000 52                 SBLQ    I
        68 002101   000003 736000                    QLS     3
        68 002102   200056 036100                    ADLQ    SEARCH_STR+1,,AUTO
        68 002103   000002 506007                    DIV     2,DL
        68 002104   000000 756000 52                 STQ     I

      988     6062    3               CALL SET_FIELD_NUM(1,I);

   6062 68 002105   000110 630400 69                 EPPR0   72
        68 002106   000031 631400 69                 EPPR1   25
        68 002107   000000 701000 xent               TSX1    SET_FIELD_NUM
        68 002110   000000 011000                    NOP     0

      989     6063    3               I = MOD( FR.UOFST.EIS.FRID, 2);

   6063 68 002111   000000 470400 45                 LDP0    FR$
        68 002112   000002 236100                    LDQ     2,,PR0
        68 002113   000017 772000                    QRL     15
        68 002114   777777 376007                    ANQ     -1,DL
        68 002115   000001 376007                    ANQ     1,DL
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:117  
        68 002116   000000 756000 52                 STQ     I

      990     6064    3               IF I = 1

   6064 68 002117   000001 116007                    CMPQ    1,DL
        68 002120   002124 601000 68                 TNZ     s:6069

      991     6065    4               THEN DO;

      992     6066    4                   NIBLE_OFF = '1';

   6066 68 002121   061000 236003                    LDQ     25088,DU
        68 002122   000065 756000 52                 STQ     NIBLE_OFF

      993     6067    4                   END;

   6067 68 002123   002126 710000 68                 TRA     s:6071

      994     6068    4               ELSE DO;

      995     6069    4                   NIBLE_OFF = '0';

   6069 68 002124   060000 236003                    LDQ     24576,DU
        68 002125   000065 756000 52                 STQ     NIBLE_OFF

      996     6070    4                   END;

      997     6071    3               CALL CONCAT(NUM_OFF,WORD_OFFSET,' ',SUBSTR(FIELD1.TEXT1,0,1),

   6071 68 002126   040000 100400                    MLR     fill='040'O
        68 002127   000063 000006 52                 ADSC9   WORD_OFFSET              cn=0,n=6
        68 002130   000066 000006 52                 ADSC9   NUM_OFF                  cn=0,n=6
        68 002131   040000 236007                    LDQ     16384,DL
        68 002132   000067 552010 52                 STBQ    NUM_OFF+1,'10'O
        68 002133   000000 236000 66                 LDQ     FIELD1
        68 002134   000022 772000                    QRL     18
        68 002135   000067 552004 52                 STBQ    NUM_OFF+1,'04'O
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:118  
        68 002136   040000 236003                    LDQ     16384,DU
        68 002137   000070 756000 52                 STQ     NUM_OFF+2
        68 002140   000065 236000 52                 LDQ     NIBLE_OFF
        68 002141   777000 376003                    ANQ     -512,DU
        68 002142   000112 276000 69                 ORQ     74
        68 002143   000011 772000                    QRL     9
        68 002144   000070 552034 52                 STBQ    NUM_OFF+2,'34'O

      998     6072    3                  ' ',NIBLE_OFF);
      999     6073    3               IF FIRST_FIELD

   6073 68 002145   000000 234000 53                 SZN     FIRST_FIELD
        68 002146   002154 605000 68                 TPL     s:6079

     1000     6074    4               THEN DO;

     1001     6075    4                   FIRST_FIELD = '0'B;

   6075 68 002147   000000 450000 53                 STZ     FIRST_FIELD

     1002     6076    4                   HEADING_FIELD = '    DEFINED FIELD-NAMES: ';

   6076 68 002150   040000 100400                    MLR     fill='040'O
        68 002151   000644 000031 67                 ADSC9   FMAP_CKI+160             cn=0,n=25
        68 002152   000002 000031 52                 ADSC9   HEADING_FIELD            cn=0,n=25

     1003     6077    4                   END;

   6077 68 002153   002157 710000 68                 TRA     s:6081

     1004     6078    4               ELSE DO;

     1005     6079    4                   HEADING_FIELD = ' ';

   6079 68 002154   040000 100400                    MLR     fill='040'O
        68 002155   000000 000001 69                 ADSC9   0                        cn=0,n=1
        68 002156   000002 000031 52                 ADSC9   HEADING_FIELD            cn=0,n=25
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:119  

     1006     6080    4                   END;

     1007     6081    3               IF TYPE_430.ALIASED

   6081 68 002157   000030 236000 18                 LDQ     IO_BUF+24
        68 002160   200000 316003                    CANQ    65536,DU
        68 002161   002245 600000 68                 TZE     s:6090

     1008     6082    4               THEN DO;

     1009     6083    4                   CALL FIND_LENGTH(TYPE_430.SUB_FIELD_NAME,I);

   6083 68 002162   000017 236000 69                 LDQ     15
        68 002163   200054 756100                    STQ     @DBK+1,,AUTO
        68 002164   000007 236000 69                 LDQ     7
        68 002165   200053 756100                    STQ     CF_TPTR$+2,,AUTO
        68 002166   000003 701000 68                 TSX1    FIND_LENGTH
        68 002167   000000 011000                    NOP     0

     1010     6084    4                   CALL FIND_LENGTH(TYPE_430.FIELD_NAME,K);

   6084 68 002170   000113 236000 69                 LDQ     75
        68 002171   200054 756100                    STQ     @DBK+1,,AUTO
        68 002172   000013 236000 69                 LDQ     11
        68 002173   200053 756100                    STQ     CF_TPTR$+2,,AUTO
        68 002174   000003 701000 68                 TSX1    FIND_LENGTH
        68 002175   000000 011000                    NOP     0

     1011     6085    4                   CALL CONCAT(LIST_STRING,HEADING_FIELD,NUM_OFF,

   6085 68 002176   040000 100400                    MLR     fill='040'O
        68 002177   000002 000031 52                 ADSC9   HEADING_FIELD            cn=0,n=25
        68 002200   000000 000031 62                 ADSC9   LIST_STRING              cn=0,n=25
        68 002201   040000 100400                    MLR     fill='040'O
        68 002202   000066 000014 52                 ADSC9   NUM_OFF                  cn=0,n=12
        68 002203   000006 200014 62                 ADSC9   LIST_STRING+6            cn=1,n=12
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:120  
        68 002204   000000 720000 52                 LXL0    I
        68 002205   040000 100440                    MLR     fill='040'O
        68 002206   000013 000010 18                 ADSC9   IO_BUF+11                cn=0,n=*X0
        68 002207   000011 200133 62                 ADSC9   LIST_STRING+9            cn=1,n=91
        68 002210   000000 236000 52                 LDQ     I
        68 002211   000133 116007                    CMPQ    91,DL
        68 002212   002244 603000 68                 TRC     s:6088
        68 002213   777644 621006                    EAX1    -92,QL
        68 002214   777777 661003                    ERX1    -1,DU
        68 002215   040046 100400                    MLR     fill='040'O
        68 002216   000653 000007 67                 ADSC9   FMAP_CKI+167             cn=0,n=7
        68 002217   000011 200011 62                 ADSC9   LIST_STRING+9,Q          cn=1,n=*X1
        68 002220   000124 116007                    CMPQ    84,DL
        68 002221   002244 603000 68                 TRC     s:6088
        68 002222   777653 622006                    EAX2    -85,QL
        68 002223   777777 662003                    ERX2    -1,DU
        68 002224   000001 723000 52                 LXL3    K
        68 002225   040046 100440                    MLR     fill='040'O
        68 002226   000003 000013 18                 ADSC9   IO_BUF+3                 cn=0,n=*X3
        68 002227   000013 000012 62                 ADSC9   LIST_STRING+11,Q         cn=0,n=*X2
        68 002230   000001 036000 52                 ADLQ    K
        68 002231   000124 116007                    CMPQ    84,DL
        68 002232   002244 603000 68                 TRC     s:6088
        68 002233   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 002234   000000 236000 52                 LDQ     I
        68 002235   000001 036000 52                 ADLQ    K
        68 002236   200056 724100                    LXL4    SEARCH_STR+1,,AUTO
        68 002237   777653 624014                    EAX4    -85,X4
        68 002240   777777 664003                    ERX4    -1,DU
        68 002241   040046 100400                    MLR     fill='040'O
        68 002242   000655 000002 67                 ADSC9   FMAP_CKI+169             cn=0,n=2
        68 002243   000013 000014 62                 ADSC9   LIST_STRING+11,Q         cn=0,n=*X4

     1012     6086    4                      SUBSTR(TYPE_430.SUB_FIELD_NAME,0,I),
     1013     6087    4                      ' ( NEE ',SUBSTR(TYPE_430.FIELD_NAME,0,K),' )');
     1014     6088    4                   END;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:121  
   6088 68 002244   002256 710000 68                 TRA     s:6096

     1015     6089    4               ELSE DO;

     1016     6090    4                   CALL CONCAT(LIST_STRING,HEADING_FIELD,

   6090 68 002245   040000 100400                    MLR     fill='040'O
        68 002246   000002 000031 52                 ADSC9   HEADING_FIELD            cn=0,n=25
        68 002247   000000 000031 62                 ADSC9   LIST_STRING              cn=0,n=25
        68 002250   040000 100400                    MLR     fill='040'O
        68 002251   000066 000014 52                 ADSC9   NUM_OFF                  cn=0,n=12
        68 002252   000006 200014 62                 ADSC9   LIST_STRING+6            cn=1,n=12
        68 002253   040000 100400                    MLR     fill='040'O
        68 002254   000013 000036 18                 ADSC9   IO_BUF+11                cn=0,n=30
        68 002255   000011 200133 62                 ADSC9   LIST_STRING+9            cn=1,n=91

     1017     6091    4                      NUM_OFF,TYPE_430.SUB_FIELD_NAME);
     1018     6092    4                   END;

     1019     6093        /*
     1020     6094                      To print *CALC when location mode is calc
     1021     6095        */
     1022     6096    3               IF TYPE_430.PRIMARY_CON_FIELD

   6096 68 002256   000030 236000 18                 LDQ     IO_BUF+24
        68 002257   100000 316003                    CANQ    32768,DU
        68 002260   002307 600000 68                 TZE     s:6104

     1023     6097    4               THEN DO;

     1024     6098    4                   TEMP_STRING = LIST_STRING;

   6098 68 002261   040100 100400                    MLR     fill='040'O
        68 002262   000000 000200 62                 ADSC9   LIST_STRING              cn=0,n=128
        68 002263   200007 000200                    ADSC9   TEMP_STRING,,AUTO        cn=0,n=128

     1025     6099    4                   IF TYPE_430.ALIASED
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:122  

   6099 68 002264   200000 316003                    CANQ    65536,DU
        68 002265   002271 600000 68                 TZE     s:6101

     1026     6100    4                   THEN I = 105;

   6100 68 002266   000151 235007                    LDA     105,DL
        68 002267   000000 755000 52                 STA     I
        68 002270   002273 710000 68                 TRA     s:6102

     1027     6101    4                   ELSE I = 65;

   6101 68 002271   000101 235007                    LDA     65,DL
        68 002272   000000 755000 52                 STA     I

     1028     6102    4                   CALL CONCAT(LIST_STRING,SUBSTR(TEMP_STRING,0,I),' (*CALC)');

   6102 68 002273   000000 620005                    EAX0    0,AL
        68 002274   040000 100540                    MLR     fill='040'O
        68 002275   200007 000010                    ADSC9   TEMP_STRING,,AUTO        cn=0,n=*X0
        68 002276   000000 000200 62                 ADSC9   LIST_STRING              cn=0,n=128
        68 002277   000000 236000 52                 LDQ     I
        68 002300   000200 116007                    CMPQ    128,DL
        68 002301   002307 603000 68                 TRC     s:6104
        68 002302   777577 620006                    EAX0    -129,QL
        68 002303   777777 660003                    ERX0    -1,DU
        68 002304   040046 100400                    MLR     fill='040'O
        68 002305   000656 000010 67                 ADSC9   FMAP_CKI+170             cn=0,n=8
        68 002306   000000 000010 62                 ADSC9   LIST_STRING,Q            cn=0,n=*X0

     1029     6103    4                   END;

     1030     6104    3               IF TYPE_35.SUB_KEY_NM ~= ' '

   6104 68 002307   040000 106400                    CMPC    fill='040'O
        68 002310   000015 000040 21                 ADSC9   TYPE_35+13               cn=0,n=32
        68 002311   000000 000001 69                 ADSC9   0                        cn=0,n=1
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:123  
        68 002312   002365 600000 68                 TZE     s:6114

     1031     6105    4               THEN DO;

     1032     6106    4                   CALL FIND_LENGTH(TYPE_35.SUB_KEY_NM,I);

   6106 68 002313   000017 236000 69                 LDQ     15
        68 002314   200054 756100                    STQ     @DBK+1,,AUTO
        68 002315   000114 236000 69                 LDQ     76
        68 002316   200053 756100                    STQ     CF_TPTR$+2,,AUTO
        68 002317   000003 701000 68                 TSX1    FIND_LENGTH
        68 002320   000000 011000                    NOP     0

     1033     6107    4                   IF TYPE_430.ALIASED

   6107 68 002321   000030 236000 18                 LDQ     IO_BUF+24
        68 002322   200000 316003                    CANQ    65536,DU
        68 002323   002327 600000 68                 TZE     s:6109

     1034     6108    4                   THEN K = 90;

   6108 68 002324   000132 235007                    LDA     90,DL
        68 002325   000001 755000 52                 STA     K
        68 002326   002331 710000 68                 TRA     s:6110

     1035     6109    4                   ELSE K = 75;

   6109 68 002327   000113 235007                    LDA     75,DL
        68 002330   000001 755000 52                 STA     K

     1036     6110    4                   CALL INSERT(LIST_STRING,K,I+2,'(',

   6110 68 002331   000000 720000 52                 LXL0    I
        68 002332   000002 621010                    EAX1    2,X0
        68 002333   040045 100400                    MLR     fill='040'O
        68 002334   000115 000001 69                 ADSC9   77                       cn=0,n=1
        68 002335   000000 000011 62                 ADSC9   LIST_STRING,A            cn=0,n=*X1
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:124  
        68 002336   000000 236000 52                 LDQ     I
        68 002337   000000 116003                    CMPQ    0,DU
        68 002340   002362 602000 68                 TNC     s:6112
        68 002341   000001 622006                    EAX2    1,QL
        68 002342   000000 623006                    EAX3    0,QL
        68 002343   040045 100440                    MLR     fill='040'O
        68 002344   000015 000013 21                 ADSC9   TYPE_35+13               cn=0,n=*X3
        68 002345   000000 200012 62                 ADSC9   LIST_STRING,A            cn=1,n=*X2
        68 002346   000000 236000 52                 LDQ     I
        68 002347   000000 136000 52                 SBLQ    I
        68 002350   000116 116000 69                 CMPQ    78
        68 002351   002362 604400 68                 TMOZ    s:6112
        68 002352   200056 756100                    STQ     SEARCH_STR+1,,AUTO
        68 002353   000001 236000 52                 LDQ     K
        68 002354   000000 036000 52                 ADLQ    I
        68 002355   200056 723100                    LXL3    SEARCH_STR+1,,AUTO
        68 002356   000001 624013                    EAX4    1,X3
        68 002357   040046 100400                    MLR     fill='040'O
        68 002360   000117 000001 69                 ADSC9   79                       cn=0,n=1
        68 002361   000000 200014 62                 ADSC9   LIST_STRING,Q            cn=1,n=*X4

     1037     6111    4                      SUBSTR(TYPE_35.SUB_KEY_NM,0,I),')');
     1038     6112    4                   TYPE_35.SUB_KEY_NM = ' ';

   6112 68 002362   040000 100400                    MLR     fill='040'O
        68 002363   000000 000001 69                 ADSC9   0                        cn=0,n=1
        68 002364   000015 000040 21                 ADSC9   TYPE_35+13               cn=0,n=32

     1039     6113    4                   END;

     1040     6114    3               CALL LIST(LIST_STRING);

   6114 68 002365   000120 630400 69                 EPPR0   80
        68 002366   000015 631400 69                 EPPR1   13
        68 002367   000000 701000 xent               TSX1    LIST
        68 002370   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:125  
     1041     6115    3               END;

     1042     6116    2           END;

     1043     6117    1       RETURN;

   6117 68 002371   000000 702200 xent               TSX2  ! X66_ARET

ANALS
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
   4     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
   4     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
   5     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
   6     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:126  
DTRAN
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
   9     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
  10     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_ALLOWED
 Sect OctLoc
  11     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  13     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  14     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  14     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
  14     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
  14     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  15     000   0***** ******                                                    ....

CONTROL
 Sect OctLoc
  17     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  17     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  17     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  17     020*  040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:127  
  17     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  17     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  17     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
  17     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  17     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  17     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  17     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

IO_BUF
 Sect OctLoc
  18     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DESC_TYPE_9
 Sect OctLoc
  19     000   000000 000160   000000 000000   000000 000000   000000 000011    ...p............
  19     004   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     020*  000000 000000   200000 000000   000000 000000   000000 000000    ................
  19     024   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     030   040040 040040   040040 040040   040040 040040   040040 040040
  19     034   040040 040040   040040 040040   040040 040040   040040 040040

TYPE_34
 Sect OctLoc
  20     000   000000 000042   000000 000000   000000 000000   000000 000042    ..."..........."
  20     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  20     010   040040 040040   040040 040040   040040 040040   040040 040040
  20     034*  040040 040040   000000 000000   000000 000000   000000 000000        ............

TYPE_35
 Sect OctLoc
  21     000   000000 000043   000000 000000   000000 000000   000000 000043    ...#...........#
  21     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  21     010   040040 040040   040040 040040   040040 040040   040040 040040
  21     034*  040040 040040   000000 000000   000000 000000   000000 000000        ............

UWA_KEY
 Sect OctLoc
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:128  
  29     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  31     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  32     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  34     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  34     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  34     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  34     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  35     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  35     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  35     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  35     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  35     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  35     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  35     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  35     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  36     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  36     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  36     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  36     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  36     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  36     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  36     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:129  
  36     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  37     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  37     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  37     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  37     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  37     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  37     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  37     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  37     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  51     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  51     004   040040 040040   040040 040040   040040 040040   040040 040040
  51     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  51     014   040040 040040   040040 040040   040040 040040   040040 040040
  51     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  51     024   040040 040040   040040 040040   040040 040040   040040 040040
  51     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  51     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  51     040   040040 040040   040040 040040   040040 040040   040040 040040
  51     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  51     050   040040 040040   040040 040040   040040 040040   040040 040040
  51     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  51     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  51     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  51     070   040040 040040   040040 040040   040040 040040   040040 040040
  51     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  51     104   040040 040040   040040 040040   040040 040040   040040 040040
  51     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  51     130   040040 040040   040040 040040   040040 040040   040040 040040
  51     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  51     140   040040 040040   040040 040040   040040 040040   040040 040040
  51     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:130  
  51     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     154   040040 040040   040040 040040   040040 040040   040040 040040
  51     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  51     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  51     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  51     174   040040 040040   040040 040040   040040 040040   040040 040040
  51     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  51     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  51     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  51     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  51     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  51     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  51     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  51     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  51     430   040040 040040   040040 040040   040040 040040   040040 040040
  51     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  51     440   040040 040040   040040 040040   040040 040040   040040 040040
  51     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  51     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  51     460   040040 040040   040040 040040   040040 040040   040040 040040
  51     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  51     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  51     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  51     504   040040 040040   040040 040040   040040 040040   040040 040040
  51     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  51     524   040040 040040   040040 040040   040040 040040   040040 040040
  51     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  51     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  51     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:131  
  51     614   040040 040040   040040 040040   040040 040040   040040 040040
  51     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  51     624   040040 040040   040040 040040   040040 040040   040040 040040
  51     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  51     664   040040 040040   040040 040040   040040 040040   040040 040040
  51     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51     700   040040 040040   040040 040040   040040 040040   040040 040040
  51     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51     714   040040 040040   040040 040040   040040 040040   040040 040040
  51     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  51     724   040040 040040   040040 040040   040040 040040   040040 040040
  51     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51     744   040040 040040   040040 040040   040040 040040   040040 040040
  51     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51    1000   040040 040040   040040 040040   040040 040040   040040 040040
  51    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51    1040   040040 040040   040040 040040   040040 040040   040040 040040
  51    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51    1064   040040 040040   040040 040040   040040 040040   040040 040040
  51    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  51    1120   040040 040040   040040 040040   040040 040040   040040 040040
  51    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  51    1140   040040 040040   040040 040040   040040 040040   040040 040040
  51    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  51    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  51    1154   040040 040040   040040 040040   040040 040040   040040 040040
  51    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  51    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  51    1170   040040 040040   040040 040040   040040 040040   040040 040040
  51    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  51    1204   040040 040040   040040 040040   040040 040040   040040 040040
  51    1214*  040040 040040   040040 040040   040040 040040   040040 040040

HEADING_FIELD
 Sect OctLoc
  52     002   ****** ******   ****** ******   ****** ******   ****** ******    ................

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:132  
ZERO_A
 Sect OctLoc
  52     017   000000 000000                                                    ....

DESCPTR
 Sect OctLoc
  52     020   000021 006000                                                    ....

BUFFER1
 Sect OctLoc
  52     021   ****** ******   ****** ******   ****** ******   ****** ******    ................

LIST_STRING
 Sect OctLoc
  62     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

FIELD1
 Sect OctLoc
  66     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

VALID_STYPE
 Sect OctLoc
  67     000   375260 10****                                                    ..@.

VALID_CSSTYPE
 Sect OctLoc
  67     001   377774 00000*                                                    ....

VALID_FSSTYPE
 Sect OctLoc
  67     002   240017 60000*                                                    ....

SCHEMA_CC
 Sect OctLoc
  67     003   000000 000000   200000 000000   200000 000000   100000 000000    ............@...
  67     007   100000 000000   000000 000000   300000 000000   200000 000000    @...............
  67     013   000000 000000   000000 000000   400000 000000   500000 000000    ................
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:133  
  67     017   500000 000000   300000 000000   300000 000000   000000 000000    ................
  67     023   000000 000000   000000 000000   000000 000000   000000 000000    ................

STYPE6
 Sect OctLoc
  67     027   010215 030500   161720 212324   251622 262730   3100** ******    ....q...........

DECIMAL
 Sect OctLoc
  67     033   060170 00****                                                    0x..

TN_S
 Sect OctLoc
  67     034   000766 312330   000000 000000   0000** ******                    ............

M
 Sect OctLoc
  67     037   002002 002001   001001 002002   002002 002002   002002 002002    ................
  67     043   002002 002002   002002 002002   002002 002002                    ............

NUMERIC
 Sect OctLoc
  67     046   000000 000000   000000 000000   000000 000000   400000 000000    ................
  67     052   400000 000000   400000 000000   400000 000000   400000 000000    ................
  67     056   400000 000000   400000 000000   400000 000000   000000 000000    ................
  67     062   000000 000000   000000 000000   000000 000000   000000 000000    ................
  67     076*  000000 000000   000000 000000   000000 000000   000000 000000    ................

FLAG_TAB
 Sect OctLoc
  67     102   004040 030000   000320 030003   000304 030403   040304 030403    . .......... ...
  67     106   000300 030003   220300 030203   010200 020002   000200 030003    ................
  67     112   020300 030203   000200 020003   000302 030102   100314 031403    ...........B@...
  67     116   140314 031003   000300 030000   002000 030003   000300 030003    `...............
  67     122   000300 030403   040304 030403   000000 000000   000000 000000    .... ...........
  67     126   000000 000000   0000** ******                                    ........

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:134  
EN
 Sect OctLoc
  67     130   000000 001001   006041 043007   007007 015016   010044 014002    .....!#......$..
  67     134   042030 003027   027003 032033   031043 004003   003017 020005    "........#......
  67     140   001012 011011   021022 013033   040035 000044   045046 047046    ........ ..$%&'&
  67     144   050051 053054   052052 000000   000000 000000   000000 000000    ()+,**..........

DN
 Sect OctLoc
  67     150   000000 001001   002042 043030   004003 005006   007043 024012    ....."#......#..
  67     154   041016 010011   010010 013014   015044 016031   011013 014015    !........$......
  67     160   001017 020021   020020 022032   036033 000044   046045 046047    ...........$&%&'
  67     164   050050 053053   051052 000000   000000 000000   000000 000000    ((++)*..........

CMAP_CKI
 Sect OctLoc
  67     170   001004 004017   017040 000004   000003 000062   063000 000000    ..... .....23...
  67     174   000000 000051   002001 001001   001001 000001   000003 000000    ...)............
  67     200   000000 000000   000000 000052   002002 016021   032041 000047    .......*.....!.'
  67     204   000003 000054   056000 000000   000000 000000   001007 007022    ...,............
  67     210   033042 000007   000003 000060   061000 000000   000000 000052    .".....01......*
  67     214   001010 010023   034043 000010   000003 000060   061000 000000    .....#.....01...
  67     220   000000 000052   001011 011024   022042 000011   000003 000060    ...*.....".....0
  67     224   061000 000000   000000 000052   001007 007025   033042 000007    1......*....."..
  67     230   000003 000060   061000 000000   000000 000052   001011 011024    ...01......*....
  67     234   025042 000011   000003 000060   061000 000000   000000 000052    .".....01......*
  67     240   001011 011024   025042 000010   000003 000060   061000 000000    .....".....01...
  67     244   000000 000052   001012 012026   035044 000012   000003 000060    ...*.....$.....0
  67     250   061000 000000   000000 000052   001013 013027   036045 000013    1......*.....%..
  67     254   000003 000060   061000 000000   000000 000052   001014 014030    ...01......*....
  67     260   037046 000014   000003 000000   000000 000000   000000 000052    .&.............*
  67     264   001014 014030   037046 000014   000003 000000   000000 000000    .....&..........
  67     270   000000 000052   001055 055006   015064 000000   000000 000002    ...*.--..4......
  67     274   005000 000000   000000 000000   001057 057031   053065 000000    .........//.+5..
  67     300   000000 000020   002000 000000   000000 000000   000000 000000    ................
  67     304   000000 000000   000000 000000   000000 000000   000000 000000    ................
  67     400*  000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:135  

FMAP_CKI
 Sect OctLoc
  67     404   001004 004017   017040 000004   000003 000062   063000 000000    ..... .....23...
  67     410   000000 000051   000000 000000   000000 000000   000000 000000    ...)............
  67     414   000000 000000   000000 000000   002002 016021   032041 000047    .............!.'
  67     420   000003 000054   056000 000000   000000 000000   000000 000000    ...,............
  67     424   000000 000000   000000 000000   000000 000000   000000 000000    ................
  67     504*  000000 000000   001055 055006   015064 000000   000000 000002    .....--..4......
  67     510   005000 000000   000000 000000   057057 057031   053065 000000    ........///.+5..
  67     514   000000 000020   002000 000000   000000 000000   000000 000000    ................
  67     520   000000 000000   000000 000000   000000 000000   000000 000000    ................
  67     530*  000000 000000   000050 050000   000000 000000   000000 000000    .....((.........
  67     534   000000 000000   000000 000000   000000 000000   000000 000000    ................
  67     614*  000000 000000   000000 000000   000000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
  67     620   106122 040040   123116 055123   105040 040040   106122 055103    FR  SN-SE   FR-C
  67     624   106123 040040   040040 040040   123123 123115   055103 106040    FS      SSSM-CF
  67     630   123115 055123   123040 040040   123103 055123   117123 115040    SM-SS   SC-SOSM
  67     634   052103 101114   103040 040040   065052 040040   106122 055103    *CALC   5*  FR-C
  67     640   106122 040040   040040 040040   060065 060062   061060 060040    FR      0502100
  67     644   040040 040040   104105 106111   116105 104040   106111 105114        DEFINED FIEL
  67     650   104055 116101   115105 123072   040040 040040   040050 040116    D-NAMES:     ( N
  67     654   105105 040040   040051 040040   040050 052103   101114 103051    EE   )   (*CALC)

(unnamed)
 Sect OctLoc
  69     000   040040 040040   000000 006014   000003 000000   000000 000001        ............
  69     004   000000 000036   000003 006000   000004 006000   000013 006000    ................
  69     010   000000 000002   000010 006000   000004 006000   000003 006000    ................
  69     014   000000 000003   000001 000000   000014 006000   000000 006000    ................
  69     020   000000 021477   000020 006000   000000 000000   000000 021476    ................
  69     024   000010 006000   000000 006000   000023 006000   777777 577777    ................
  69     030   377777 777777   000002 000000   000000 006000   000000 006000    ................
  69     034   000001 006000   000000 006000   777777 773777   000010 000000    ................
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:136  
  69     040   000000 000016   000000 021511   000000 006000   000040 006000    ............. ..
  69     044   000011 006000   000022 006000   000003 006000   000010 006000    ................
  69     050   000014 006000   000004 006000   000025 006000   000041 006000    .............!..
  69     054   000620 006000   000003 006000   000000 006000   000000 006000    ................
  69     060   000000 000006   000060 006000   000000 006000   000621 006000    .....0..........
  69     064   077777 777777   000623 006000   000015 006000   000626 006000    ?...............
  69     070   000630 006000   000632 006000   000000 021472   000072 006000    .............:..
  69     074   577777 777777   000000 006000   000000 000040   000076 006000    ........... .>..
  69     100   000636 006000   000000 006000   000637 006000   000000 021473    ................
  69     104   000103 006000   000000 021474   000105 006000   737777 777777    .C.......E......
  69     110   000003 006000   000000 006000   000040 040040   000001 006000    .........   ....
  69     114   000015 006000   050040 040040   777777 777777   051040 040040    ....(   ....)
  69     120   000000 006000                                                    ....
     1044     6118    1   END ZIG$V_FIELD;

PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:137  
--  Include file information  --

   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_SSS.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_FIELD.

   Procedure ZIG$V_FIELD requires 1274 words for executable code.
   Procedure ZIG$V_FIELD requires 54 words of local(AUTO) storage.

    No errors detected in file ZIG$V_FIELD.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:138  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:139  
          MINI XREF LISTING

ABORT
      3083**DCL-ENT  5868--CALL     5943--CALL     5990--CALL
ALLOCATE_END
      3086**DCL      5750<<ASSIGN   5754<<ASSIGN
BUFFER1
      5184**DCL      5183--DCLINIT
CD.CDRH
      3985**DCL      5945<<ASSIGN
CD.CDRN
      3987**DCL      5946<<ASSIGN
CD.CDSH
      3984**DCL      5871<<ASSIGN
CD.CDSN
      3986**DCL      5872<<ASSIGN
CD.DEF.CONT
      3977**DCL      5906>>ASSIGN
CD.DEF.RELT
      3978**DCL      5557>>IF
CD.RSCDH
      3983**DCL      5559>>ASSIGN   5876>>ASSIGN   5950>>ASSIGN
CD$
      3972**DCL      3973--IMP-PTR
CF_PTR$
      5172**DCL      5548>>ASSIGN
CF_STR.COUNT
      5175**DCL      5176--IMP-SIZ  5550>>CALLBLT  5555>>ASSIGN
CF_STR.NPTR$
      5174**DCL      5579>>ASSIGN
CF_STR.STR
      5176**DCL      5550>>CALLBLT  5555>>ASSIGN
CF_TPTR$
      5177**DCL      5548<<ASSIGN   5549>>DOWHILE  5550>>CALLBLT  5550>>CALLBLT  5555>>ASSIGN   5555>>ASSIGN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:140  
      5579<<ASSIGN   5579>>ASSIGN
CHAR2
      5180**DCL      5555<<ASSIGN
CHECK_FOR_DPPROC
      5716**PROC     5590--CALL
CKI
      5523**DCL      5649<<ASSIGN   5650<<ASSIGN   5652>>ASSIGN   5653>>ASSIGN   5654>>IF       5657>>ASSIGN
      5667>>ASSIGN   5697>>IF       5697>>IF       5697>>IF       5704>>IF       5704>>IF       5704>>IF
      5704>>IF
CKIP
      5524**DCL      5647<<ASSIGN   5649>>ASSIGN   5650>>ASSIGN
CMAP_CKI
      5451**DCL      5649>>ASSIGN
CONTROL.BITS.ALL_FIELDS
      2629**DCL      5730<<ASSIGN   5758<<ASSIGN   6051<<ASSIGN
CONTROL.NUM_FIELD_SET
      2598**DCL      5914<<ASSIGN   5914>>ASSIGN   5983<<ASSIGN   5983>>ASSIGN
CURRENT_CF
      5161**DCL      5555--ASSIGN   5556>>ASSIGN   5873>>ASSIGN   5947>>ASSIGN
CURRENT_OFF
      5155**DCL      5824<<ASSIGN   5827>>ASSIGN   5830>>ASSIGN   5831>>ASSIGN
CURRENT_RECORD
      2516**DCL      5731<>CALL     5759<>CALL     5804>>ASSIGN   5828>>ASSIGN   6053<>CALL
DBK IN PROCEDURE FIND_CF
      5539**DCL      5538--PROC     5545>>ASSIGN
DECIMAL
      5230**DCL      5615>>IF
DESCPTR
      5183**DCL      5185--IMP-PTR
DESC_TYPE_9
      2901**DCL      5736<>CALL     5738<>CALL
DESC_TYPE_9.BUWA
      2914**DCL      5737<<ASSIGN
DN
      5393**DCL      5667>>ASSIGN
DP$
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:141  
      3896**DCL      3897--IMP-PTR
DP1$
      3910**DCL      3911--IMP-PTR
DPPROC
      5522**DCL      5591>>IF       5717<<ASSIGN
EN
      5335**DCL      5657>>ASSIGN
END_CFR
      5990**LABEL    5923--CALLALT
END_CFS
      5921**LABEL    5843--CALLALT
ERROR
      3075**DCL-ENT  5606--CALL     5635--CALL     5862--CALL     5937--CALL     6029--CALL
ERROR_FLG
      5157**DCL      5752<>CALL     5755>>IF       5849<>CALL     5850>>IF       5855>>IF       5929<>CALL
      5930>>IF       5935>>IF
FCURR_R_6
      4116**DCL-ENT  5921--CALL
FETCHD_6
      4114**DCL-ENT  5787--CALL
FETCHNS_6
      4119**DCL-ENT  5843--CALL     5923--CALL
FETCHOS_6
      4123**DCL-ENT  5808--CALL     5859--CALL
FIELD1.COUNT1
      5189**DCL      6059>>CALLBLT  6059>>CALLBLT  6059>>CALLBLT
FIELD1.TEXT1
      5190**DCL      6059>>CALLBLT  6071>>CALLBLT
FIELD_ERRORED
      5182**DCL      5612<<ASSIGN   5701<<ASSIGN   5709<<ASSIGN   5748<<ASSIGN   6038<<ASSIGN   6048>>IF
FIELD_HASH.DBK
      2514**DCL      5787<>CALL
FIELD_HASH.DBK_SN
      2515**DCL      5786>>ASSIGN
FIELD_HASH.REF
      2512**DCL      5774<<ASSIGN   5828<<ASSIGN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:142  
FIELD_HASH.SUB_OFF
      2513**DCL      5827<<ASSIGN
FINDOS_6
      4122**DCL-ENT  5857--CALL     5858--CALL
FIND_CF
      5538**PROC     5849--CALL     5929--CALL
FIND_LENGTH
      5527**PROC     5797--CALL     6083--CALL     6084--CALL     6106--CALL
FIRST_FIELD
      5148**DCL      6073>>IF       6075<<ASSIGN
FLAG_TAB
      5259**DCL      5321--REDEF
FLAG_TAB1.EBC
      5332**DCL      5653>>ASSIGN
FLAG_TAB1.EBS
      5333**DCL      5652>>ASSIGN
FLAG_TAB1.F1
      5322**DCL      5697>>IF
FLAG_TAB1.F2
      5323**DCL      5704>>IF
FLAG_TAB1.F3
      5324**DCL      5704>>IF
FLAG_TAB1.F4
      5325**DCL      5704>>IF
FLAG_TAB1.F5
      5326**DCL      5704>>IF
FLAG_TAB1.F6
      5327**DCL      5654>>IF
FLAG_TAB1.F7
      5328**DCL      5697>>IF
FLAG_TAB1.F8
      5329**DCL      5697>>IF
FMAP_CKI
      5483**DCL      5650>>ASSIGN
FOUND IN PROCEDURE FIND_CF
      5540**DCL      5538--PROC     5546<<ASSIGN   5554<<ASSIGN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:143  
FR.CDRN
      3953**DCL      5946>>ASSIGN   5947<<ASSIGN
FR.CDSN
      3952**DCL      5872>>ASSIGN   5873<<ASSIGN
FR.DEF
      3921**DCL      6044>>ASSIGN
FR.DEF.COMC
      3926**DCL      5692<<ASSIGN
FR.DEF.DNDX
      3932**DCL      5594<<ASSIGN   5667<<ASSIGN   5677<<ASSIGN   5683<<ASSIGN   5684<<ASSIGN   5688<<ASSIGN
FR.DEF.EBCL
      3925**DCL      5653<<ASSIGN   5656<<ASSIGN
FR.DEF.EBCM
      3924**DCL      5652<<ASSIGN   5662<<ASSIGN
FR.DEF.ENDX
      3923**DCL      5593<<ASSIGN   5657<<ASSIGN   5661<<ASSIGN
FR.DEF.FMOD
      3930**DCL      5568<<ASSIGN
FR.DEF.FUSE
      3929**DCL      5833<<ASSIGN
FR.DEF.FVF
      3927**DCL      5838<<ASSIGN
FR.DEF.SYN
      3928**DCL      5814<<ASSIGN
FR.DEF.TYPE
      3922**DCL      5812<<ASSIGN
FR.FNAM
      3959**DCL      5800<<ASSIGN
FR.FNL
      3955**DCL      3959--IMP-SIZ  5799<<ASSIGN   5800>>ASSIGN
FR.FRWSO
      3958**DCL      5818<<ASSIGN
FR.RCFRH
      3957**DCL      5832<<ASSIGN
FR.RCFRN
      3956**DCL      5823<<ASSIGN   5823>>ASSIGN   5831<<ASSIGN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:144  
FR.ROFST
      3933**DCL      5617--ASSIGN   5618--ASSIGN   5834--ASSIGN
FR.ROFST.EIS.COUNT
      3941**DCL      5624>>ASSIGN   5837<<ASSIGN
FR.UOFST.EIS
      3943**DCL      5840<<ASSIGN
FR.UOFST.EIS.FRID
      3948**DCL      6056>>ASSIGN   6061>>ASSIGN   6063>>ASSIGN
FR.UOFST.EIS.OFFSET
      3945**DCL      3948--REDEF
FR.UOFST.EIS.REG
      3944**DCL      5841<<ASSIGN
FR$
      3919**DCL      3920--IMP-PTR  5568>>ASSIGN   5593>>ASSIGN   5594>>ASSIGN   5617>>ASSIGN   5618>>ASSIGN
      5624>>ASSIGN   5652>>ASSIGN   5653>>ASSIGN   5656>>ASSIGN   5657>>ASSIGN   5661>>ASSIGN   5662>>ASSIGN
      5667>>ASSIGN   5677>>ASSIGN   5683>>ASSIGN   5684>>ASSIGN   5688>>ASSIGN   5692>>ASSIGN   5798<>CALL
      5799>>ASSIGN   5800>>ASSIGN   5800>>ASSIGN   5803<>CALL     5812>>ASSIGN   5814>>ASSIGN   5818>>ASSIGN
      5823>>ASSIGN   5824>>ASSIGN   5832>>ASSIGN   5833>>ASSIGN   5834>>ASSIGN   5837>>ASSIGN   5838>>ASSIGN
      5840>>ASSIGN   5841>>ASSIGN   5872>>ASSIGN   5873>>ASSIGN   5946>>ASSIGN   5947>>ASSIGN   6044>>ASSIGN
      6056>>ASSIGN   6061>>ASSIGN   6063>>ASSIGN
FR1.NLIND
      3967**DCL      5804<<ASSIGN
FR1.XXDPN
      3966**DCL      5790<<ASSIGN
FR1$
      3964**DCL      3965--IMP-PTR  5789<>CALL     5790>>ASSIGN   5804>>ASSIGN
GET_ENCODE_DECODE
      5587**PROC     6041--CALL
HASH_SCHEMA_NAME
      2458**DCL      5751<<ASSIGN
HEADING_FIELD
      5147**DCL      6076<<ASSIGN   6079<<ASSIGN   6085>>CALLBLT  6090>>CALLBLT
I
      5145**DCL      5550<<CALLBLT  5552>>IF       5555>>ASSIGN   5575>>ASSIGN   5604<<ASSIGN   5605<>CALL
      5633<<ASSIGN   5634<>CALL     6012<<ASSIGN   6013<>CALL     6027<<ASSIGN   6028<>CALL     6056<<ASSIGN
      6057<>CALL     6061<<ASSIGN   6061>>ASSIGN   6062<>CALL     6063<<ASSIGN   6064>>IF       6083<>CALL
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:145  
      6085>>CALLBLT  6100<<ASSIGN   6101<<ASSIGN   6102>>CALLBLT  6106<>CALL     6110>>CALLBLT  6110>>CALLBLT
INCREMENT IN PROCEDURE FIND_CF
      5579**LABEL    5550--CALLALT
IN_GROUP
      5150**DCL      5727>>IF       5745<<ASSIGN   5993<<ASSIGN
IO_BUF
      2638**DCL      2696--REDEF    5731<>CALL     5759<>CALL     6053<>CALL
K
      5146**DCL      6084<>CALL     6085>>CALLBLT  6108<<ASSIGN   6109<<ASSIGN   6110>>CALLBLT
LAST_FR
      5159**DCL      5822>>ASSIGN   5830<<ASSIGN   5871>>ASSIGN   5945>>ASSIGN
LAST_GROUP_LEVEL
      5151**DCL      5727>>IF       5746<<ASSIGN   5994<<ASSIGN
LAST_RC
      5158**DCL      5832>>ASSIGN
LIST
      3090**DCL-ENT  6114--CALL
LIST_STRING
      5162**DCL      6085<<CALLBLT  6090<<CALLBLT  6098>>ASSIGN   6102<<CALLBLT  6110<<CALLBLT  6114<>CALL
L_SUBSCH_FR
      5153**DCL      5797<>CALL     5798>>CALL     5799>>ASSIGN
NEIS.LENGTH
      5518**DCL      5617>>ASSIGN
NEIS.SCALE
      5517**DCL      5618>>ASSIGN
NIBLE_OFF
      5192**DCL      6066<<ASSIGN   6069<<ASSIGN   6071>>CALLBLT
NOT_BLANK IN PROCEDURE FIND_LENGTH
      5533**LABEL    5530--CALLALT
NUM_OFF
      5193**DCL      6071<<CALLBLT  6085>>CALLBLT  6090>>CALLBLT
OA.CSZ
      3826**DCL      5818>>ASSIGN   5819<<ASSIGN   5819>>ASSIGN
OA.SCNAM.EIS.COUNT
      3801**DCL      3838--IMP-SIZ
OA$
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:146  
      3779**DCL      3780--IMP-PTR  5818>>ASSIGN   5819>>ASSIGN   5819>>ASSIGN
OA1$
      3845**DCL      3846--IMP-PTR
RC.DEF.RNL
      3871**DCL      3881--IMP-SIZ  5604>>ASSIGN   5605>>CALL     5633>>ASSIGN   5634>>CALL     5764>>ASSIGN
      5902>>ASSIGN   5911>>ASSIGN   5972>>ASSIGN   5980>>ASSIGN   6012>>ASSIGN   6013>>CALL     6027>>ASSIGN
      6028>>CALL
RC.RNAM
      3881**DCL      5605<>CALL     5634<>CALL     5764>>ASSIGN   5902>>ASSIGN   5911>>ASSIGN   5972>>ASSIGN
      5980>>ASSIGN   6013<>CALL     6028<>CALL
RC$
      3854**DCL      3855--IMP-PTR  5604>>ASSIGN   5605>>CALL     5605>>CALL     5633>>ASSIGN   5634>>CALL
      5634>>CALL     5764>>ASSIGN   5764>>ASSIGN   5902>>ASSIGN   5902>>ASSIGN   5911>>ASSIGN   5911>>ASSIGN
      5972>>ASSIGN   5972>>ASSIGN   5980>>ASSIGN   5980>>ASSIGN   6012>>ASSIGN   6013>>CALL     6013>>CALL
      6027>>ASSIGN   6028>>CALL     6028>>CALL
RC1$
      3886**DCL      3887--IMP-PTR
READSF
        37**DCL-ENT  5736--CALL
RECORD_NUM
      5169**DCL      5752<>CALL
RETURN_LENGTH IN PROCEDURE FIND_LENGTH
      5528**DCL      5527--PROC     5530<<CALLBLT  5533<<ASSIGN
RS.DEF.TYPE
      3994**DCL      5560>>IF       5877>>IF       5951>>IF
RS.NPOS
      4017**DCL      4026--REDEF
RS.SCRSH
      4016**DCL      5562>>ASSIGN   5885>>ASSIGN   5955>>ASSIGN
RS$
      3991**DCL      3992--IMP-PTR
SAVE_CF_DBK
      5171**DCL      5844<<ASSIGN   5849<>CALL     5924<<ASSIGN   5929<>CALL
SC.DEF.SETO
      4072**DCL      5563>>IF       5563>>IF
SC.DEF.SETT
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:147  
      4078**DCL      5563>>IF       5896>>IF       5896>>IF       5966>>IF       5966>>IF
SC.DEF.SNL
      4079**DCL      4084--IMP-SIZ  5886>>IF       5888>>IF       5901>>ASSIGN   5910>>ASSIGN   5956>>IF
      5958>>IF       5971>>ASSIGN   5979>>ASSIGN
SC.DEF.SNSS
      4073**DCL      5563>>IF
SC.DEF.SRCR
      4075**DCL      5894>>IF       5964>>IF
SC.SCID
      4083**DCL      5899>>ASSIGN   5908>>ASSIGN   5969>>ASSIGN   5977>>ASSIGN
SC.SNAM
      4084**DCL      5886>>IF       5888>>IF       5901>>ASSIGN   5910>>ASSIGN   5956>>IF       5958>>IF
      5971>>ASSIGN   5979>>ASSIGN
SC$
      4066**DCL      4067--IMP-PTR
SCHEMA_CC
      5204**DCL      5692>>ASSIGN
SEARCH_STR.NUM IN PROCEDURE FIND_CF
      5543**DCL      5545<<ASSIGN
SEARCH_STR.STR IN PROCEDURE FIND_CF
      5542**DCL      5543--REDEF    5550>>CALLBLT
SET_FIELDS
      3078**DCL-ENT  5602--CALL     5603--CALL     5605--CALL     5632--CALL     5634--CALL     5762--CALL
      5763--CALL     5765--CALL     6011--CALL     6013--CALL     6026--CALL     6028--CALL
SET_FIELD_NUM
      3079**DCL-ENT  6057--CALL     6062--CALL
SLENGTH
      5514**DCL      5617<<ASSIGN   5624<<ASSIGN   5654>>IF       5658>>IF       5676>>IF       5680>>IF
      5704>>IF
SN_DBK
        40**DCL      5809<<ASSIGN
SS.RSSSH
      4102**DCL      5879>>ASSIGN   5953>>ASSIGN
SS$
      4092**DCL      4093--IMP-PTR
SSCALE
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:148  
      5513**DCL      5618<<ASSIGN   5619>>IF       5620<<ASSIGN   5620>>ASSIGN   5621<<ASSIGN   5621>>ASSIGN
      5625<<ASSIGN   5654>>IF       5704>>IF
SSS$
      3774**DCL      5556>>ASSIGN   5559>>ASSIGN   5562>>ASSIGN   5822>>ASSIGN   5824>>ASSIGN   5876>>ASSIGN
      5879>>ASSIGN   5885>>ASSIGN   5950>>ASSIGN   5953>>ASSIGN   5955>>ASSIGN
START_N
      5178**DCL      5547<<ASSIGN   5550>>CALLBLT  5575<<ASSIGN   5580<<ASSIGN
STATUS
      5156**DCL      5749<<ASSIGN   5752<>CALL
STRING_TO_GET IN PROCEDURE FIND_LENGTH
      5529**DCL      5527--PROC     5530>>CALLBLT
SUBSCHEMA_KEY
      3110**DCL      3111--REDEF
SUB_LANGUAGE
      2414**DCL      5627>>IF       5627>>IF       5627>>IF       5627>>IF       5648>>IF       5674>>IF
SYSTEM_CONVERSION_ERROR
      5696**PROC     5651--CALL
T1PTR$
      5164**DCL      5556<<ASSIGN   5557>>IF       5559>>ASSIGN   5822<<ASSIGN   5823>>ASSIGN   5831>>ASSIGN
      5871>>ASSIGN   5872>>ASSIGN   5876>>ASSIGN   5906>>ASSIGN   5945>>ASSIGN   5946>>ASSIGN   5950>>ASSIGN
T5PTR$
      5165**DCL      5876<<ASSIGN   5877>>IF       5879<<ASSIGN   5879>>ASSIGN   5885>>ASSIGN   5950<<ASSIGN
      5951>>IF       5953<<ASSIGN   5953>>ASSIGN   5955>>ASSIGN
T6PTR$
      5166**DCL      5885<<ASSIGN   5886>>IF       5886>>IF       5888>>IF       5888>>IF       5894>>IF
      5896>>IF       5896>>IF       5899>>ASSIGN   5901>>ASSIGN   5901>>ASSIGN   5908>>ASSIGN   5910>>ASSIGN
      5910>>ASSIGN   5955<<ASSIGN   5956>>IF       5956>>IF       5958>>IF       5958>>IF       5964>>IF
      5966>>IF       5966>>IF       5969>>ASSIGN   5971>>ASSIGN   5971>>ASSIGN   5977>>ASSIGN   5979>>ASSIGN
      5979>>ASSIGN
T9PTR$ IN PROCEDURE FIND_CF
      5544**DCL      5559<<ASSIGN   5560>>IF       5562<<ASSIGN   5562>>ASSIGN   5563>>IF       5563>>IF
      5563>>IF       5563>>IF
TEMP_STRING
      5163**DCL      6098<<ASSIGN   6102>>CALLBLT
TPTR$
      5152**DCL      5752<>CALL     5774>>ASSIGN   5786>>ASSIGN   5787>>CALL     5827>>ASSIGN   5828>>ASSIGN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:149  
TYPE_34
      3010**DCL      5912--CALL     5981--CALL
TYPE_34.ASSEND_OR_DESCEND
      3015**DCL      5906<<ASSIGN
TYPE_34.FIELD_NAME
      3012**DCL      5907<<ASSIGN   5976<<ASSIGN
TYPE_34.SET_NAME
      3013**DCL      5908<<ASSIGN   5977<<ASSIGN
TYPE_34.SUB_FIELD_NM
      3018**DCL      5909<<ASSIGN   5978<<ASSIGN
TYPE_34.SUB_RECORD_NM
      3020**DCL      5911<<ASSIGN   5980<<ASSIGN
TYPE_34.SUB_SET_NM
      3019**DCL      5910<<ASSIGN   5979<<ASSIGN
TYPE_34.THEN_THRU_FIELD
      3016**DCL      5880<<ASSIGN   5883<<ASSIGN
TYPE_35
      3051**DCL      5903--CALL     5973--CALL
TYPE_35.FIELD_NAME
      3053**DCL      5898<<ASSIGN   5968<<ASSIGN
TYPE_35.KEY_NAME
      3054**DCL      5899<<ASSIGN   5969<<ASSIGN
TYPE_35.SUB_FIELD_NM
      3057**DCL      5900<<ASSIGN   5970<<ASSIGN
TYPE_35.SUB_KEY_NM
      3058**DCL      5901<<ASSIGN   5971<<ASSIGN   6104>>IF       6106<>CALL     6110>>CALLBLT  6112<<ASSIGN
TYPE_35.SUB_RECORD_NM
      3059**DCL      5764<<ASSIGN   5765<>CALL     5902<<ASSIGN   5972<<ASSIGN
TYPE_430.ALIASED
      2710**DCL      6081>>IF       6099>>IF       6107>>IF
TYPE_430.DATA_TYPE
      2705**DCL      5627>>IF       5627>>IF       5627>>IF       5647>>ASSIGN   5658>>IF       5668>>IF
TYPE_430.DBK_SN
      2795**DCL      5721<<ASSIGN   5786<<ASSIGN
TYPE_430.EIS
      2714**DCL      5840>>ASSIGN
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:150  
TYPE_430.EIS.ADDER
      2715**DCL      2716--REDEF    2717--REDEF
TYPE_430.EIS.EIS_BITS
      2720**DCL      2721--REDEF    2725--REDEF    2753--REDEF
TYPE_430.ELEMENTARY
      2709**DCL      5760>>IF       5991>>IF
TYPE_430.FIELD_NAME
      2700**DCL      5603<>CALL     5752<>CALL     5763<>CALL     6084<>CALL     6085>>CALLBLT
TYPE_430.FLAGS.TYPE
      2764**DCL      5729<<ASSIGN   5757<<ASSIGN   6050<<ASSIGN
TYPE_430.INFO
      2762**DCL      2763--REDEF    6044<<ASSIGN
TYPE_430.LEN_FIELD
      2706**DCL      5654>>IF       5658>>IF       5676>>IF       5680>>IF       5682>>IF       5687>>IF
      5704>>IF       6009>>IF
TYPE_430.LEVEL_FIELD
      2708**DCL      5727>>IF       5994>>ASSIGN
TYPE_430.OFFSET
      2704**DCL      5898>>ASSIGN   5907>>ASSIGN   5968>>ASSIGN   5976>>ASSIGN
TYPE_430.PRIMARY_CON_FIELD
      2711**DCL      5890<<ASSIGN   5960<<ASSIGN   6096>>IF
TYPE_430.REF_LINE
      2698**DCL      5725>>IF       5736<>CALL     5738<>CALL     5806>>IF       5816>>IF       5825>>IF
      5874>>IF       5948>>IF       6042>>IF
TYPE_430.SCALE_FIELD
      2707**DCL      5654>>IF       5704>>IF
TYPE_430.SCHEMA_DBKEY
      2712**DCL      6046<<ASSIGN   6047<<ASSIGN
TYPE_430.SUB_FIELD_NAME
      2702**DCL      5602<>CALL     5632<>CALL     5762<>CALL     5797<>CALL     5800>>ASSIGN   5900>>ASSIGN
      5909>>ASSIGN   5970>>ASSIGN   5978>>ASSIGN   6011<>CALL     6026<>CALL     6083<>CALL     6085>>CALLBLT
      6090>>CALLBLT
UPUT
      3098**DCL-ENT  5903--CALL     5912--CALL     5973--CALL     5981--CALL
UWA.AC.CALC_NEXT
      4920**DCL      4921--REDEF
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:151  
UWA.AC.CALC_PRIOR
      4929**DCL      4930--REDEF
UWA.AC.DEFAULTS
      4881**DCL      4882--REDEF
UWA.AC.FILE_CODE
      4886**DCL      4887--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      4883**DCL      4884--REDEF
UWA.C_F.CTRLTYPE
      5016**DCL      5850>>IF       5930>>IF
UWA.DB_STATUS
      4812**DCL      5990>>IF
UWA.DIRECT_REF
      4821**DCL      5790>>ASSIGN   5809>>ASSIGN   5844>>ASSIGN   5924>>ASSIGN
UWA.FR.BUFFLOC
      4990**DCL      5834>>ASSIGN
UWA.FR.FTYPE
      4977**DCL      5588>>IF       5588>>IF       5615>>IF       5647>>ASSIGN   5658>>IF       5658>>IF
      5668>>IF       5668>>IF       5692>>ASSIGN   5835>>IF       5995>>IF       5995>>IF       5995>>IF
      5995>>IF       5995>>IF       5995>>IF       5995>>IF       5995>>IF       5995>>IF       5995>>IF
      6045>>IF
UWA.FR.F_USE
      4984**DCL      5833>>ASSIGN
UWA.FR.PREC
      4978**DCL      5837>>ASSIGN   6009>>IF
UWA.FR.SYN
      4975**DCL      5813>>IF
UWA.SC.ALTOWN
      4962**DCL      5860>>IF
VALIDS.FR_NAMES
      2357**DCL      5795>>IF
VALIDS.RECORD_XREF
      2359**DCL      6054>>IF
VALID_CSSTYPE
      5200**DCL      5627>>IF
VALID_FSSTYPE
PL6.E3A0      #001=ZIG$V_FIELD File=ZIG$V_FIELD.:ZIC0TSI                         FRI 09/05/97 12:20 Page:152  
      5202**DCL      5627>>IF
VALID_STYPE
      5198**DCL      5588>>IF
WARNING
      3076**DCL-ENT  5766--CALL     6014--CALL
WORD36
      5168**DCL      5834<<ASSIGN
WORD_OFFSET
      5191**DCL      6058<<ASSIGN   6059<<CALLBLT  6071>>CALLBLT
WRITSF
        38**DCL-ENT  5731--CALL     5738--CALL     5759--CALL     6053--CALL
ZIG$ADD_SI
        39**DCL-ENT  5810--CALL
ZIG$G_DYN_MEM_6
      3085**DCL-ENT  5789--CALL     5798--CALL     5803--CALL
ZIG$HASH_IT
        36**DCL-ENT  5752--CALL
