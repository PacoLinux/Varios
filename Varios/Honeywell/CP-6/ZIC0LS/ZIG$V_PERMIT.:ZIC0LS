
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:1    
        1        1        /*M*     ZIG$V_PERMIT      I-D-S/II       DBACS      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_PERMIT
        9        9        PURPOSE:
       10       10              This procedure is called for two different places during
       11       11            two different processes.
       12       12            First - ZIG$V_DRIVER (validation).
       13       13            Second - DISP  (display processor).
       14       14
       15       15              This procedure output a list of permitted DML calls that can
       16       16            used for this subschema. The list doesn't include all valid DML
       17       17            calls in the database since some calls are run time depented
       18       18            but it does include all the more common DML calls that the
       19       19            normal I-D-S/II programer would use.
       20       20
       21       21              Before this procedure is called two things must be set up:
       22       22            First    - The schema subset must be in memory and the pointer
       23       23                      SSS$ must be a valid pointer.
       24       24            Second   - The subschema file must be open for update.
       25       25
       26       26        */
       27       27        ZIG$V_PERMIT:
       28       28            PROC;
       29       29    1   DCL HEAD_PERMIT CHAR (64) CONSTANT INIT(
       30       30    1    'SUBSCHEMA PERMITTED LIST.');
       31       31    1   DCL TEMP_WORD CHAR (30) STATIC;
       32       32    1   DCL EOFC CHAR (120) EXT INIT ('/*/*/*/*/*/*/*/*/*');
       33       33    1   DCL LIST_STRING CHAR (128) EXT;
       34       34    1   DCL READSF ENTRY (2);
       35       35    1   DCL CONNECT_OK BIT (1) STATIC;
       36       36    1   DCL MODIFY_OK BIT (1) STATIC;
       37       37    1   DCL CALC_OK BIT (1) STATIC;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:2    
       38       38    1   DCL NUM_RECORDS UBIN(36) STATIC;
       39       39    1   DCL NUM_REC_IN_SET UBIN(36) STATIC;
       40       40    1   DCL FIELDS BIT (1) STATIC;
       41       41        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:3    
       42       42        %INCLUDE ZI_ERRORS_SUBS;
       43      562        %INCLUDE ZIG_GENERAL;
       44      670        %INCLUDE ZIG_DBA_INT;
       45      718        %INCLUDE ZI_SUB_LANG;
       46     2433        %DESC_TYPE_9(NAME_MAIN=TYPE_9);
       47     2610        %GENERAL;
       48     2734    1   DCL IO_BUF CHAR (128) EXT;
       49     2735        %TEXT_LINE(STCLASS="REDEF IO_BUF");
       50     2772        %DESC_TYPE_9(STCLASS="REDEF IO_BUF");
       51     2949        %DESC_TYPE_100(STCLASS="REDEF IO_BUF");
       52     2989        %DESC_TYPE_110(STCLASS="REDEF IO_BUF");
       53     3053        %DESC_TYPE_200(STCLASS="REDEF IO_BUF");
       54     3106        %DESC_TYPE_210(STCLASS="REDEF IO_BUF");
       55     3161        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       56     3230        %DESC_TYPE_350(STCLASS="REDEF IO_BUF");
       57     3268        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
       58     3327        %DESC_TYPE_410(STCLASS="REDEF IO_BUF");
       59     3383        %DESC_TYPE_420(STCLASS="REDEF IO_BUF");
       60     3416        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
       61     3575        %CONTROL_BLOCK;
       62     3683        %DESC_TYPE_36;
       63     3722        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:4    
       64     3723        /*
       65     3724              Now comes the sturctures for the schema subset.
       66     3725        */
       67     3726        %INCLUDE ZIG_SSS;
       68     4296        %SS_GENERAL(PSTCLASS=EXT);
       69     4317        %AC(PSTCLASS=EXT);
       70     4412        %AC1(PSTCLASS=EXT);
       71     4420        %FR(PSTCLASS=EXT);
       72     4466        %FR1(PSTCLASS=EXT);
       73     4474        %SC(PSTCLASS=EXT);
       74     4501        %SC1(PSTCLASS=EXT);
       75     4511        %RC(PSTCLASS=EXT);
       76     4544        %RC1(PSTCLASS=EXT);
       77     4554        %OA(PSTCLASS=EXT);
       78     4621        %OA1(PSTCLASS=EXT);
       79     4629        %RA(PSTCLASS=EXT);
       80     4649        %RS(PSTCLASS=EXT);
       81     4723        %SM1(PSTCLASS=EXT);
       82     4731        %SS(PSTCLASS=EXT);
       83     4745        %CD(PSTCLASS=EXT);
       84     4764        %DP(PSTCLASS=EXT);
       85     4778        %DP1(PSTCLASS=EXT);
       86     4786        %AG(PSTCLASS=EXT);
       87     4816        %AG1(PSTCLASS=EXT);
       88     4824        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:5    
       89     4825    1   INFO_ONLY_INT:
       90     4826    1       PROC (ERROR_NUM);
       91     4827    2   DCL ERROR_NUM UBIN (36);
       92     4828    2       CALL INFO_ONLY(ERROR_NUM + SUB_LANGUAGE - 1);
       93     4829    2   END INFO_ONLY_INT;
       94     4830        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:6    
       95     4831        /*
       96     4832              This is the start of the main program for the permitted list.
       97     4833            Each permitted statement must have three different error messages
       98     4834            for each one since the validator works for three different
       99     4835            subschema (COBOL, FORTRAN, APL, BASIC). The call to INFO_ONLY_INT gives
      100     4836            the cobol number of the error message and if the language is
      101     4837            fortran then a 1 is added to the error_num and if the language is
      102     4838            apl the a 2 is added to the error_num.
      103     4839        */
      104     4840    1       CALL SUBLST(HEAD_PERMIT);
      105     4841    1       AC$ = PINCRW(SSS$, OA.OAACN);
      106     4842    2       DO WHILE (SSS$ ~= AC$);
      107     4843    2           NUM_RECORDS = 0;
      108     4844    2           TEMP_WORD = AC.ANAM;
      109     4845    2           LIST_STRING = ' ';
      110     4846    2           CALL LIST(LIST_STRING);
      111     4847    2           CALL LIST(LIST_STRING);
      112     4848    2           CALL CONCAT(LIST_STRING,'<<<<<PERMITTED LIST FOR AREA ',AC.ANAM,' >>>>>');
      113     4849    2           CALL LIST(LIST_STRING);
      114     4850    2           CALL SET_FIELDS(1,30,TEMP_WORD);
      115     4851    2           RA$ = PINCRW(SSS$, AC.ACRAN);
      116     4852    3           DO WHILE (RA$ ~= SSS$);
      117     4853    3               RC$ = PINCRW(SSS$, RA.RCRAH);
      118     4854    3               IF ~RC.DEF.SR
      119     4855    4               THEN DO;
      120     4856    4                   NUM_RECORDS = NUM_RECORDS + 1;
      121     4857    4                   TEMP_WORD = RC.RNAM;
      122     4858    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
      123     4859    4                   IF NUM_RECORDS = 1
      124     4860    5                   THEN DO;
      125     4861    5                       CALL INFO_ONLY_INT(%ZIG_PER_AREA_FINDS);
      126     4862        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_COBOL-C
      127     4863        MESSAGE: For the area %U1 these DML calls are permitted:
      128     4864                 FIND NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1
      129     4865                 FIND CURRENT [record-name] WITHIN %U1
      130     4866                 .
      131     4867                 Record-name = %U2
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:7    
      132     4868        */
      133     4869        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_FORT-C
      134     4870        MESSAGE: For the area %U1 these DML calls are permitted:
      135     4871                 CALL FIND(NEXT|PRIOR|FIRST|LAST|integer-1 [,record-name], %U1)
      136     4872                 CALL FIND (CURRENT [,record-name], %U1)
      137     4873                 .
      138     4874                 Record-name = %U2
      139     4875        */
      140     4876        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_APL-C
      141     4877        MESSAGE: For the area %U1 these DML calls are permitted:
      142     4878                 []DBFIND 'NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1'
      143     4879                 []DBFIND 'CURRENT [record-name] WITHIN %U1'
      144     4880                 .
      145     4881                 Record-name = %U2
      146     4882        */
      147     4883        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_BASIC-C
      148     4884        MESSAGE: For the area %U1 these DML calls are permitted:
      149     4885                 [line no] DB FIND NEXT/PRIOR/FIRST/LAST/integer-1 [record-name] WITHIN %U1
      150     4886                 [line no] DB FIND CURRENT [record-name] WITHIN %U1
      151     4887                 .
      152     4888                 Record-name = %U2
      153     4889        */
      154     4890    5                       END;
      155     4891    5                   ELSE DO;
      156     4892    5                       CALL INFO_ONLY(%ZIG_PER_MORE_AREAS);
      157     4893        /*E*     ERROR:    ZIG-ZIG_PER_MORE_AREAS-C
      158     4894        MESSAGE: or          , %U2
      159     4895        */
      160     4896    5                       END;
      161     4897    4                   END;
      162     4898    3               RA$ = PINCRW(SSS$, RA.ACRAN);
      163     4899    3               END;
      164     4900    2           AC$ = PINCRW(SSS$, AC.OAACN);
      165     4901    2           END;
      166     4902    1       SC$ = PINCRW(SSS$,OA.OASCN);
      167     4903    2       DO WHILE (SC$ ~= SSS$);
      168     4904    2           IF ~SC.DEF.SNSS AND SC.DEF.SETT = 0
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:8    
      169     4905    3           THEN DO;
      170     4906    3               NUM_REC_IN_SET = 0;
      171     4907    3               TEMP_WORD = SC.SNAM;
      172     4908    3               LIST_STRING = ' ';
      173     4909    3               CALL LIST(LIST_STRING);
      174     4910    3               CALL LIST(LIST_STRING);
      175     4911    3               CALL CONCAT(LIST_STRING,'<<<<<PERMITTED LIST FOR SET ',SC.SNAM,' >>>>>')
              4911                        ;
      176     4912    3               CALL LIST(LIST_STRING);
      177     4913    3               CALL SET_FIELDS(1,30,TEMP_WORD);
      178     4914    3               RS$ = PINCRW(SSS$, SC.SCRSN);
      179     4915    4               DO WHILE (SSS$ ~= RS$);
      180     4916    4                   RC$ = PINCRW(SSS$, RS.RCRSH);
      181     4917    4                   TEMP_WORD = RC.RNAM;
      182     4918    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
      183     4919    4                   IF RS.DEF.TYPE = '0100'O
      184     4920    5                   THEN DO;
      185     4921         /* A owner well lets go with it */
      186     4922    5                       IF ~RC.DEF.SR
      187     4923    6                       THEN DO;
      188     4924    6                           CALL INFO_ONLY_INT(%ZIG_PER_SET_OWNER);
      189     4925        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_COBOL-C
      190     4926        MESSAGE: FIND OWNER [ %U2 ] WITHIN %U1
      191     4927        */
      192     4928        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_FORT-C
      193     4929        MESSAGE: CALL FIND (OWNER [,%U2 ], %U1)
      194     4930        */
      195     4931        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_APL-C
      196     4932        MESSAGE: []DBFIND 'OWNER [ %U2 ] WITHIN %U1'
      197     4933        */
      198     4934        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_BASIC-C
      199     4935        MESSAGE: [line no] DB FIND OWNER WITHIN %U1
      200     4936        */
      201     4937    6                           END;
      202     4938    5                       END;
      203     4939    5                   ELSE DO;
      204     4940         /* Now we have a member */
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:9    
      205     4941    5                       IF ~RC.DEF.SR
      206     4942    6                       THEN DO;
      207     4943    6                           IF RS.DEF.MSM OR RS.DEF.OSM
      208     4944    7                           THEN DO;
      209     4945         /* Might be able to connect
      210     4946         and disconnect. */
      211     4947    7                               CONNECT_OK = '1'B;
      212     4948    7                               CD$ = PINCRW(SSS$, RS.RSCDN);
      213     4949    8                               DO WHILE (SSS$ ~= CD$ AND CONNECT_OK);
      214     4950    8                                   IF CD.CDRH ~= 0
      215     4951    9                                   THEN DO;
      216     4952    9                                       FR$ = PINCRW(SSS$, CD.CDRH);
      217     4953    9                                       END;
      218     4954    9                                   ELSE DO;
      219     4955    9                                       FR$ = PINCRW(SSS$, CD.CDSH);
      220     4956    9                                       END;
      221     4957    8                                   IF FR.DEF.FSR AND ~FR.DEF.SYN
      222     4958    8                                   THEN CONNECT_OK = '0'B;
      223     4959    8                                   CD$ = PINCRW(SSS$, CD.RSCDN);
      224     4960    8                                   END;
      225     4961    7                               SS$ = PINCRW(SSS$, RS.RSSSN);
      226     4962    8                               DO WHILE (SSS$ ~= SS$ AND CONNECT_OK);
      227     4963    8                                   CD$ = PINCRW(SSS$, SS.RSCDN);
      228     4964    9                                   DO WHILE(CD$ ~= SSS$ AND CONNECT_OK);
      229     4965    9                                       IF CD.CDRH ~= 0
      230     4966   10                                       THEN DO;
      231     4967   10                                           FR$ = PINCRW(SSS$, CD.CDRN);
      232     4968   10                                           END;
      233     4969   10                                       ELSE DO;
      234     4970   10                                           FR$ = PINCRW(SSS$, CD.CDSN);
      235     4971   10                                           END;
      236     4972    9                                       IF FR.DEF.FSR AND ~FR.DEF.SYN
      237     4973    9                                       THEN CONNECT_OK = '0'B;
      238     4974    9                                       CD$ = PINCRW(SSS$, CD.RSCDN);
      239     4975    9                                       END;
      240     4976    8                                   SS$ = PINCRW(SSS$, SS.RSSSN);
      241     4977    8                                   END;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:10   
      242     4978    7                               END;
      243     4979    6                           IF (RS.DEF.MSM OR RS.DEF.OSM) AND CONNECT_OK
      244     4980    7                           THEN DO;
      245     4981    7                               CALL INFO_ONLY_INT(%ZIG_PER_CONNECT_SET);
      246     4982        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_COBOL-C
      247     4983        MESSAGE: CONNECT %U2 TO %U1
      248     4984        */
      249     4985        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_FORT-C
      250     4986        MESSAGE: CALL CONNECT([%U2,]  %U1)
      251     4987        */
      252     4988        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_APL-C
      253     4989        MESSAGE: []DBCONNECT '[%U2] [TO] %U1'
      254     4990        */
      255     4991        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_BASIC_C
      256     4992        MESSAGE: [line no] DB CONNECT [%U2] [TO] %U1
      257     4993        */
      258     4994    7                               END;
      259     4995    6                           IF RS.DEF.OSM
      260     4996    7                           THEN DO;
      261     4997    7                               CALL INFO_ONLY_INT(%ZIG_PER_DISCONNECT_SET);
      262     4998        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_COBOL-C
      263     4999        MESSAGE: DISCONNECT %U2 FROM %U1
      264     5000        */
      265     5001        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_FORT-C
      266     5002        MESSAGE: CALL DISCONNECT(%U2 ,%U1)
      267     5003        */
      268     5004        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_APL-C
      269     5005        MESSAGE: []DBDISCONNECT '%U2 FROM %U1'
      270     5006        */
      271     5007        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_BASIC-C
      272     5008        MESSAGE: [line no] DB DISCONNECT %U2 [FROM] %U1
      273     5009        */
      274     5010    7                               END;
      275     5011    6                           END;
      276     5012    5                       END;
      277     5013    4                   RS$ = PINCRW(SSS$, RS.SCRSN);
      278     5014    4                   END;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:11   
      279     5015    3               RS$ = PINCRW(SSS$, SC.SCRSN);
      280     5016    4               DO WHILE(SSS$ ~= RS$);
      281     5017    4                   RC$ = PINCRW(SSS$, RS.RCRSH);
      282     5018    4                   TEMP_WORD = RC.RNAM;
      283     5019    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
      284     5020    4                   IF ~RC.DEF.SR AND RS.DEF.TYPE = '0040'O
      285     5021    5                   THEN DO;
      286     5022    5                       NUM_REC_IN_SET = NUM_REC_IN_SET + 1;
      287     5023    5                       IF NUM_REC_IN_SET = 1
      288     5024    6                       THEN DO;
      289     5025    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_SET);
      290     5026        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_COBOL-C
      291     5027        MESSAGE: FIND NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1
      292     5028                 FIND CURRENT [record-name] WITHIN %U1
      293     5029                 .
      294     5030                 record-name = %U2
      295     5031        */
      296     5032        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_FORT-C
      297     5033        MESSAGE: CALL FIND(NEXT|PRIOR|FIRST|LAST|integer-1 [,record-name] ,%U1)
      298     5034                 CALL FIND(CURRENT [,record-name] ,%U1)
      299     5035                 .
      300     5036                 record-name = %U2
      301     5037        */
      302     5038        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_APL-C
      303     5039        MESSAGE: []DBFIND 'NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1'
      304     5040                 []DBFIND 'CURRENT [record-name] WITHIN %U1'
      305     5041                 .
      306     5042                 record-name = %U2
      307     5043        */
      308     5044        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_BASIC-C
      309     5045        MESSAGE: [line no] DB FIND NEXT/PRIOR/FIRST/LAST/integer-1 [record-name] [WITHIN] %U
              5045        1
      310     5046                 [line no] DB FIND CURRENT [record-name] [WITHIN] %U1
      311     5047                 .
      312     5048                 record-name = %U2
      313     5049        */
      314     5050    6                           END;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:12   
      315     5051    6                       ELSE DO;
      316     5052    6                           CALL INFO_ONLY(%ZIG_PER_MORE_AREAS);
      317     5053    6                           END;
      318     5054    5                       END;
      319     5055    4                   RS$ = PINCRW(SSS$, RS.SCRSN);
      320     5056    4                   END;
      321     5057    3               END;
      322     5058    2           SC$ = PINCRW(SSS$, SC.OASCN);
      323     5059    2           END;
      324     5060        /*
      325     5061              Now go throw all the records and print out all the things
      326     5062            that can be performed on this record. Some of the DML calls
      327     5063            might have already been given in the set list of permitted
      328     5064            statements but what the hell why not print them out again
      329     5065            so the user can find them by record or set or area.
      330     5066        */
      331     5067    1       RC$ = PINCRW(SSS$, OA.OARCN);
      332     5068    2       DO WHILE (SSS$ ~= RC$);
      333     5069    2           IF ~RC.DEF.SR
      334     5070    3           THEN DO;
      335     5071    3               TEMP_WORD = RC.RNAM;
      336     5072    3               LIST_STRING = ' ';
      337     5073    3               CALL LIST(LIST_STRING);
      338     5074    3               CALL LIST(LIST_STRING);
      339     5075    3               CALL CONCAT(LIST_STRING,'<<<<<PERMITTED LIST FOR RECORD ',RC.RNAM,
              5075                        ' >>>>>');
      340     5076    3               CALL LIST(LIST_STRING);
      341     5077    3               CALL SET_FIELDS(1,30,TEMP_WORD);
      342     5078    3               RS$ = PINCRW(SSS$, RC.RCRSN);
      343     5079    4               DO WHILE (SSS$ ~= RS$);
      344     5080    4                   SC$ = PINCRW(SSS$, RS.SCRSH);
      345     5081    4                   TEMP_WORD = SC.SNAM;
      346     5082    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
      347     5083    4                   IF RS.DEF.TYPE = '0040'O AND ~SC.DEF.SNSS
      348     5084    5                   THEN DO;
      349     5085         /* Member of this set */
      350     5086    5                       IF RS.DEF.MSM OR RS.DEF.OSM
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:13   
      351     5087    6                       THEN DO;
      352     5088         /* Might be able to connect
      353     5089         and disconnect. */
      354     5090    6                           CONNECT_OK = '1'B;
      355     5091    6                           CD$ = PINCRW(SSS$, RS.RSCDN);
      356     5092    7                           DO WHILE (SSS$ ~= CD$ AND CONNECT_OK);
      357     5093    7                               IF CD.CDRH ~= 0
      358     5094    8                               THEN DO;
      359     5095    8                                   FR$ = PINCRW(SSS$, CD.CDRH);
      360     5096    8                                   END;
      361     5097    8                               ELSE DO;
      362     5098    8                                   FR$ = PINCRW(SSS$, CD.CDSH);
      363     5099    8                                   END;
      364     5100    7                               IF FR.DEF.FSR AND ~FR.DEF.SYN
      365     5101    7                               THEN CONNECT_OK = '0'B;
      366     5102    7                               CD$ = PINCRW(SSS$, CD.RSCDN);
      367     5103    7                               END;
      368     5104    6                           SS$ = PINCRW(SSS$, RS.RSSSN);
      369     5105    7                           DO WHILE (SSS$ ~= SS$ AND CONNECT_OK);
      370     5106    7                               CD$ = PINCRW(SSS$, SS.RSCDN);
      371     5107    8                               DO WHILE(CD$ ~= SSS$ AND CONNECT_OK);
      372     5108    8                                   IF CD.CDRH ~= 0
      373     5109    9                                   THEN DO;
      374     5110    9                                       FR$ = PINCRW(SSS$, CD.CDRN);
      375     5111    9                                       END;
      376     5112    9                                   ELSE DO;
      377     5113    9                                       FR$ = PINCRW(SSS$, CD.CDSN);
      378     5114    9                                       END;
      379     5115    8                                   IF FR.DEF.FSR AND ~FR.DEF.SYN
      380     5116    8                                   THEN CONNECT_OK = '0'B;
      381     5117    8                                   CD$ = PINCRW(SSS$, CD.RSCDN);
      382     5118    8                                   END;
      383     5119    7                               SS$ = PINCRW(SSS$, SS.RSSSN);
      384     5120    7                               END;
      385     5121    6                           END;
      386     5122    5                       IF (RS.DEF.MSM OR RS.DEF.OSM) AND CONNECT_OK
      387     5123    6                       THEN DO;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:14   
      388     5124    6                           CALL INFO_ONLY_INT(%ZIG_PER_CONNECT_SET);
      389     5125        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_COBOL-C
      390     5126        MESSAGE: CONNECT %U2 TO %U1
      391     5127        */
      392     5128        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_FORT-C
      393     5129        MESSAGE: CALL CONNECT([%U2,]  %U1)
      394     5130        */
      395     5131        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_APL-C
      396     5132        MESSAGE: []DBCONNECT '[%U2] [TO] %U1'
      397     5133        */
      398     5134        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_BASIC-C
      399     5135        MESSAGE: [line no] DB CONNECT [%U2] [TO] %U1
      400     5136        */
      401     5137    6                           END;
      402     5138    5                       IF RS.DEF.OSM
      403     5139    6                       THEN DO;
      404     5140    6                           CALL INFO_ONLY_INT(%ZIG_PER_DISCONNECT_SET);
      405     5141        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_COBOL-C
      406     5142        MESSAGE: DISCONNECT %U2 FROM %U1
      407     5143        */
      408     5144        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_FORT-C
      409     5145        MESSAGE: CALL DISCONNECT(%U2 ,%U1)
      410     5146        */
      411     5147        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_APL-C
      412     5148        MESSAGE: []DBDISCONNECT '%U2 FROM %U1'
      413     5149        */
      414     5150        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_BASIC-C
      415     5151        MESSAGE: [line no] DB DISCONNECT %U2 [FROM] %U1
      416     5152        */
      417     5153    6                           END;
      418     5154    5                       END;
      419     5155    4                   RS$ = PINCRW(SSS$, RS.RSSSN);
      420     5156    4                   END;
      421     5157    3               IF ~RC.DEF.RERS
      422     5158    4               THEN DO;
      423     5159    4                   IF ~RC.DEF.RERA
      424     5160    5                   THEN DO;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:15   
      425     5161    5                       CALL INFO_ONLY_INT(%ZIG_PER_ERASE_ALL);
      426     5162        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_COBOL-C
      427     5163        MESSAGE: ERASE %U1 [ALL [MEMBER]]
      428     5164        */
      429     5165        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_FORT-C
      430     5166        MESSAGE: CALL ERASE (%U1 [,ALL])
      431     5167        */
      432     5168        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_APL-C
      433     5169        MESSAGE: []DBERASE '%U1 [ALL [MEMBER]]'
      434     5170        */
      435     5171        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_BASIC-C
      436     5172        MESSAGE: [line no] DB ERASE %U1 ALL [MEMBERS
      437     5173        */
      438     5174    5                       END;
      439     5175    5                   ELSE DO;
      440     5176    5                       CALL INFO_ONLY_INT(%ZIG_PER_ERASE);
      441     5177        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_COBOL-C
      442     5178        MESSAGE: ERASE %U1
      443     5179        */
      444     5180        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_FORT-C
      445     5181        MESSAGE: CALL ERASE (%U1)
      446     5182        */
      447     5183        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_APL-C
      448     5184        MESSAGE: []DBERASE '%U1'
      449     5185        */
      450     5186        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_BASIC-C
      451     5187        MESSAGE: [line no] DB ERASE %U1
      452     5188        */
      453     5189    5                       END;
      454     5190    4                   END;
      455     5191    3               RS$ = PINCRW(SSS$, RC.RCRSN);
      456     5192    4               DO WHILE (SSS$ ~= RS$);
      457     5193    4                   SC$ = PINCRW(SSS$, RS.SCRSH);
      458     5194    4                   TEMP_WORD = SC.SNAM;
      459     5195    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
      460     5196    4                   IF SC.DEF.SETT = 1
      461     5197    5                   THEN DO;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:16   
      462     5198    5                       CALC_OK = '1'B;
      463     5199    5                       CD$ = PINCRW(SSS$, RS.RSCDN);
      464     5200    6                       DO WHILE (SSS$ ~= CD$ AND CALC_OK);
      465     5201    6                           IF CD.CDSH ~= 0
      466     5202    7                           THEN DO;
      467     5203    7                               FR$ = PINCRW(SSS$, CD.CDSH);
      468     5204    7                               END;
      469     5205    7                           ELSE DO;
      470     5206    7                               FR$ = PINCRW(SSS$, CD.CDRH);
      471     5207    7                               END;
      472     5208    6                           IF FR.DEF.FSR AND NOT FR.DEF.SYN
      473     5209    7                           THEN DO;
      474     5210    7                               CALC_OK = '0'B;
      475     5211    7                               END;
      476     5212    6                           CD$ = PINCRW(SSS$, CD.RSCDN);
      477     5213    6                           END;
      478     5214    5                       IF CALC_OK
      479     5215    6                       THEN DO;
      480     5216    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_CALC);
      481     5217        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_COBOL-C
      482     5218        MESSAGE: FIND ANY %U1
      483     5219        */
      484     5220        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_APL-C
      485     5221        MESSAGE: []DBFIND 'ANY %U1'
      486     5222        */
      487     5223        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_BASIC-C
      488     5224        MESSAGE: [line no] DB FIND ANY %U1
      489     5225        */
      490     5226        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_FORT-C
      491     5227        MESSAGE: CALL FIND (ANY ,%U1)
      492     5228        */
      493     5229    6                           END;
      494     5230    5                       END;
      495     5231    4                   IF SC.DEF.SETT = 0 AND ~SC.DEF.SNSS
      496     5232    5                   THEN DO;
      497     5233    5                       IF RS.DEF.TYPE = '0040'O
      498     5234    6                       THEN DO;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:17   
      499     5235    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_SET_REC);
      500     5236        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_COBOL-C
      501     5237        MESSAGE: FIND NEXT|PRIOR|FIRST|LAST|integer-1 %U1 WITHIN %U2
      502     5238                 FIND CURRENT %U1 WITHIN %U2
      503     5239        */
      504     5240        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_FORT-C
      505     5241        MESSAGE: CALL FIND (NEXT|PRIOR|FIRST|LAST|integer-1, %U1 ,%U2)
      506     5242                 CALL FIND (CURRENT, %U1, %U2)
      507     5243        */
      508     5244        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_APL-C
      509     5245        MESSAGE: []DBFIND 'NEXT|PRIOR|FIRST|LAST|integer-1 %U1 WITHIN %U2'
      510     5246                 []DBFIND 'CURRENT %U1 WITHIN %U2'
      511     5247        */
      512     5248        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_BASIC-C
      513     5249        MESSAGE: [line no] DB FIND NEXT/PRIOR/FIRST/LAST/integer-1 %U1 [WITHIN] %U2
      514     5250                 [line no] DB FIND CURRENT %U1 [WITHIN] %U2
      515     5251        */
      516     5252    6                           END;
      517     5253    6                       ELSE DO;
      518     5254    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_OWN_REC);
      519     5255        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_COBOL-C
      520     5256        MESSAGE: FIND OWNER WITHIN %U2
      521     5257        */
      522     5258        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_FORT-C
      523     5259        MESSAGE: CALL FIND (OWNER, %U2)
      524     5260        */
      525     5261        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_APL-C
      526     5262        MESSAGE: []DBFIND 'OWNER WITHIN %U2'
      527     5263        */
      528     5264        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_BASIC-C
      529     5265        MESSAGE: [line no] DB FIND OWNER [WITHIN] %U2
      530     5266        */
      531     5267    6                           END;
      532     5268    5                       END;
      533     5269    4                   RS$ = PINCRW(SSS$, RS.RCRSN);
      534     5270    4                   END;
      535     5271    3               MODIFY_OK = '1'B;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:18   
      536     5272    3               FIELDS='0'B;
      537     5273    3               FR$ = PINCRW(SSS$, RC.RCFRN);
      538     5274    4               DO WHILE (FR$ ~= SSS$ AND ~FIELDS);
      539     5275    4                   IF ~FR.DEF.FSR AND ~FR.DEF.SYN
      540     5276    5                   THEN DO;
      541     5277    5                       FIELDS = '1'B;
      542     5278    5                       END;
      543     5279    4                   FR$ = PINCRW(SSS$, FR.RCFRN);
      544     5280    4                   END;
      545     5281    3               RS$ = PINCRW(SSS$, RC.RCRSN);
      546     5282    4               DO WHILE (SSS$ ~= RS$);
      547     5283    4                   SC$ = PINCRW(SSS$, RS.SCRSH);
      548     5284    4                   IF SC.DEF.SNSS AND (SC.DEF.SETO=4 OR SC.DEF.SETO=6)
      549     5285    4                      AND SC.DEF.SETT=0 AND RS.DEF.TYPE = '0040'O
      550     5286    5                   THEN DO;
      551     5287    5                       MODIFY_OK = '0'B;
      552     5288    5                       GOTO NO_MODIFY;
      553     5289        /*
      554     5290              This record is a member of a set the is sorted and that set is
      555     5291            not in the subschema.
      556     5292        */
      557     5293    5                       END;
      558     5294    4                   RS$ = PINCRW(SSS$, RS.RCRSN);
      559     5295    4                   END;
      560     5296
      561     5297    3               RS$ = PINCRW(SSS$, RC.RCRSN);
      562     5298    4               DO WHILE (SSS$ ~= RS$);
      563     5299    4                   IF RS.DEF.TYPE = '0040'O
      564     5300    5                   THEN DO;
      565     5301    5                       IF (SC.DEF.SETO=4 OR SC.DEF.SETO=6 OR NOT FIELDS)
      566     5302    5                          AND (SC.DEF.SETT=0 AND NOT SC.DEF.SNSS)
      567     5303    5                          AND (SC.DEF.SETT = 0)
      568     5304    6                       THEN DO;
      569     5305    6                           TEMP_WORD = SC.SNAM;
      570     5306    6                           CALL SET_FIELDS(2,30,TEMP_WORD);
      571     5307    6                           IF MODIFY_OK
      572     5308    7                           THEN DO;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:19   
      573     5309    7                               CALL INFO_ONLY_INT(%ZIG_PER_MODIFY_ALL);
      574     5310        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_COBOL-C
      575     5311        MESSAGE: MODIFY %U1 ONLY|INCLUDING ALL|set_name MEMBERSHIP
      576     5312                 set_name = %U2
      577     5313        */
      578     5314        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_FORT-C
      579     5315        MESSAGE: CALL MODIFY(%U1, ONLY|INCLUDING, ALL|set_name)
      580     5316                 set_name = %U2
      581     5317        */
      582     5318        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_APL-C
      583     5319        MESSAGE: []DBMODIFY '%U1 ONLY|INCLUDING ALL|set_name MEMBERSHIP'
      584     5320                 set_name = %U2
      585     5321        */
      586     5322        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_BASIC-C
      587     5323        MESSAGE: [line no] DB MODIFY %U1 ONLY/INCLUDING ALL/set_name [MEMBERSHIP]
      588     5324                 set_name = %U2
      589     5325        */
      590     5326    7                               MODIFY_OK = '0'B;
      591     5327    7                               END;
      592     5328    7                           ELSE DO;
      593     5329    7                               CALL INFO_ONLY(%ZIG_PER_MODIFY_MORE);
      594     5330        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_MORE-C
      595     5331        MESSAGE: and      , %U2
      596     5332        */
      597     5333    7                               END;
      598     5334    6                           END;
      599     5335    5                       END;
      600     5336    4                   RS$ = PINCRW(SSS$, RS.RCRSN);
      601     5337    4                   END;
      602     5338    3               IF MODIFY_OK
      603     5339    4               THEN DO;
      604     5340    4                   CALL INFO_ONLY_INT(%ZIG_PER_MODIFY);
      605     5341        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_COBOL-C
      606     5342        MESSAGE: MODIFY %U1
      607     5343        */
      608     5344        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_FORT-C
      609     5345        MESSAGE: CALL MODIFY (%U1)
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:20   
      610     5346        */
      611     5347        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_APL-C
      612     5348        MESSAGE: []DBMODIFY '%U1'
      613     5349        */
      614     5350        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_BASIC-C
      615     5351        MESSAGE: [line no] DB MODIFY %U1
      616     5352        */
      617     5353    4                   END;
      618     5354    3               IF ~RC.DEF.RSTO
      619     5355    4               THEN DO;
      620     5356    4                   CALL INFO_ONLY_INT(%ZIG_PRO_RC_NOSTORE);
      621     5357    4                   END;
      622     5358    3   NO_MODIFY:
      623     5359    3               END;
      624     5360    2           RC$ = PINCRW(SSS$, RC.OARCN);
      625     5361    2           END;
      626     5362    1       RETURN;
      627     5363    1   END ZIG$V_PERMIT;

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:21   
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_PERMIT.

   Procedure ZIG$V_PERMIT requires 893 words for executable code.
   Procedure ZIG$V_PERMIT requires 8 words of local(AUTO) storage.

    No errors detected in file ZIG$V_PERMIT.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:22   

 Object Unit name= ZIG$V_PERMIT                               File name= ZIG$V_PERMIT.:ZIC0TOU
 UTS= SEP 05 '97 12:22:08.64 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     41     51  ZIG$V_PERMIT
    1   Data  even  none    14     16  ZIG$V_PERMIT
    2  LblCom even  none    30     36  EOFC
    3  LblCom even  none    32     40  LIST_STRING
    4  LblCom even  none     1      1  NUM_ERROR_MSG
    5  LblCom even  none     1      1  NUM_WARN_MSG
    6  LblCom even  none     1      1  ALLOCATE_END
    7  LblCom even  none     2      2  SUBSCHEMA_KEY
    8  LblCom even  none     1      1  BUFFER$
    9  LblCom even  none     1      1  ERROR_IO
   10  LblCom even  none     1      1  BUFFER_LEN
   11  LblCom even  none     2      2  UWA_KEY
   12  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   13  LblCom even  none     2      2  RVA_KEY
   14  LblCom even  none     2      2  IA__KEY
   15  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   16  LblCom even  none    32     40  SEARCHR_NB
   17  LblCom even  none    32     40  SEM_COM
   18  LblCom even  none    32     40  DMCL_XLATE
   19  LblCom even  none    32     40  Q2_PERCENT
   20  LblCom even  none    32     40  TYPE_9
   21  LblCom even  none     5      5  LANG_ALLOWED
   22  LblCom even  none     1      1  SUB_LANGUAGE
   23  LblCom even  none    16     20  HEADING_TEXT
   24  LblCom even  none    13     15  LANG_TEXT
   25  LblCom even  none     1      1  HASH_SCHEMA_NAME
   26  LblCom even  none     1      1  CURRENT_RECORD
   27  LblCom even  none    32     40  IO_BUF
   28  LblCom even  none    64    100  CONTROL
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:23   
   29  LblCom even  none    32     40  TYPE_36
   30  LblCom even  none     1      1  SSS$
   31  LblCom even  none     1      1  AC$
   32  LblCom even  none     1      1  AC1$
   33  LblCom even  none     1      1  FR$
   34  LblCom even  none     1      1  FR1$
   35  LblCom even  none     1      1  SC$
   36  LblCom even  none     1      1  SC1$
   37  LblCom even  none     1      1  RC$
   38  LblCom even  none     1      1  RC1$
   39  LblCom even  none     1      1  OA$
   40  LblCom even  none     1      1  OA1$
   41  LblCom even  none     1      1  RA$
   42  LblCom even  none     1      1  RS$
   43  LblCom even  none     1      1  SM1$
   44  LblCom even  none     1      1  SS$
   45  LblCom even  none     1      1  CD$
   46  LblCom even  none     1      1  DP$
   47  LblCom even  none     1      1  DP1$
   48  LblCom even  none     1      1  AG$
   49  LblCom even  none     1      1  AG1$
   50   Proc  even  none   893   1575  ZIG$V_PERMIT
   51  RoData even  none    44     54  ZIG$V_PERMIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    50      0   yes            yes      Std        0  ZIG$V_PERMIT
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 SUBLST
         yes           Std       1 LIST
         yes           Std       1 INFO_ONLY
         yes           Std       3 SET_FIELDS
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:25   


        1        1        /*M*     ZIG$V_PERMIT      I-D-S/II       DBACS      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$V_PERMIT
        9        9        PURPOSE:
       10       10              This procedure is called for two different places during
       11       11            two different processes.
       12       12            First - ZIG$V_DRIVER (validation).
       13       13            Second - DISP  (display processor).
       14       14
       15       15              This procedure output a list of permitted DML calls that can
       16       16            used for this subschema. The list doesn't include all valid DML
       17       17            calls in the database since some calls are run time depented
       18       18            but it does include all the more common DML calls that the
       19       19            normal I-D-S/II programer would use.
       20       20
       21       21              Before this procedure is called two things must be set up:
       22       22            First    - The schema subset must be in memory and the pointer
       23       23                      SSS$ must be a valid pointer.
       24       24            Second   - The subschema file must be open for update.
       25       25
       26       26        */
       27       27        ZIG$V_PERMIT:
       28       28            PROC;

     28 50 000000   000000 700200 xent  ZIG$V_PERMIT TSX0  ! X66_AUTO_0
        50 000001   000010 000000                    ZERO    8,0
        50 000002   000021 710000 50                 TRA     s:4840

       29       29    1   DCL HEAD_PERMIT CHAR (64) CONSTANT INIT(
       30       30    1    'SUBSCHEMA PERMITTED LIST.');
       31       31    1   DCL TEMP_WORD CHAR (30) STATIC;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:26   
       32       32    1   DCL EOFC CHAR (120) EXT INIT ('/*/*/*/*/*/*/*/*/*');
       33       33    1   DCL LIST_STRING CHAR (128) EXT;
       34       34    1   DCL READSF ENTRY (2);
       35       35    1   DCL CONNECT_OK BIT (1) STATIC;
       36       36    1   DCL MODIFY_OK BIT (1) STATIC;
       37       37    1   DCL CALC_OK BIT (1) STATIC;
       38       38    1   DCL NUM_RECORDS UBIN(36) STATIC;
       39       39    1   DCL NUM_REC_IN_SET UBIN(36) STATIC;
       40       40    1   DCL FIELDS BIT (1) STATIC;
       41       41        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:27   
       42       42        %INCLUDE ZI_ERRORS_SUBS;
       43      562        %INCLUDE ZIG_GENERAL;
       44      670        %INCLUDE ZIG_DBA_INT;
       45      718        %INCLUDE ZI_SUB_LANG;
       46     2433        %DESC_TYPE_9(NAME_MAIN=TYPE_9);
       47     2610        %GENERAL;
       48     2734    1   DCL IO_BUF CHAR (128) EXT;
       49     2735        %TEXT_LINE(STCLASS="REDEF IO_BUF");
       50     2772        %DESC_TYPE_9(STCLASS="REDEF IO_BUF");
       51     2949        %DESC_TYPE_100(STCLASS="REDEF IO_BUF");
       52     2989        %DESC_TYPE_110(STCLASS="REDEF IO_BUF");
       53     3053        %DESC_TYPE_200(STCLASS="REDEF IO_BUF");
       54     3106        %DESC_TYPE_210(STCLASS="REDEF IO_BUF");
       55     3161        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       56     3230        %DESC_TYPE_350(STCLASS="REDEF IO_BUF");
       57     3268        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
       58     3327        %DESC_TYPE_410(STCLASS="REDEF IO_BUF");
       59     3383        %DESC_TYPE_420(STCLASS="REDEF IO_BUF");
       60     3416        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
       61     3575        %CONTROL_BLOCK;
       62     3683        %DESC_TYPE_36;
       63     3722        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:28   
       64     3723        /*
       65     3724              Now comes the sturctures for the schema subset.
       66     3725        */
       67     3726        %INCLUDE ZIG_SSS;
       68     4296        %SS_GENERAL(PSTCLASS=EXT);
       69     4317        %AC(PSTCLASS=EXT);
       70     4412        %AC1(PSTCLASS=EXT);
       71     4420        %FR(PSTCLASS=EXT);
       72     4466        %FR1(PSTCLASS=EXT);
       73     4474        %SC(PSTCLASS=EXT);
       74     4501        %SC1(PSTCLASS=EXT);
       75     4511        %RC(PSTCLASS=EXT);
       76     4544        %RC1(PSTCLASS=EXT);
       77     4554        %OA(PSTCLASS=EXT);
       78     4621        %OA1(PSTCLASS=EXT);
       79     4629        %RA(PSTCLASS=EXT);
       80     4649        %RS(PSTCLASS=EXT);
       81     4723        %SM1(PSTCLASS=EXT);
       82     4731        %SS(PSTCLASS=EXT);
       83     4745        %CD(PSTCLASS=EXT);
       84     4764        %DP(PSTCLASS=EXT);
       85     4778        %DP1(PSTCLASS=EXT);
       86     4786        %AG(PSTCLASS=EXT);
       87     4816        %AG1(PSTCLASS=EXT);
       88     4824        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:29   
       89     4825    1   INFO_ONLY_INT:

   4825 50 000003   200004 741300       INFO_ONLY_I* STX1  ! 4,,AUTO

       90     4826    1       PROC (ERROR_NUM);
       91     4827    2   DCL ERROR_NUM UBIN (36);
       92     4828    2       CALL INFO_ONLY(ERROR_NUM + SUB_LANGUAGE - 1);

   4828 50 000004   200005 470500                    LDP0    @ERROR_NUM,,AUTO
        50 000005   000000 236100                    LDQ     0,,PR0
        50 000006   000000 036000 22                 ADLQ    SUB_LANGUAGE
        50 000007   000001 136007                    SBLQ    1,DL
        50 000010   200006 756100                    STQ     @ERROR_NUM+1,,AUTO
        50 000011   200006 631500                    EPPR1   @ERROR_NUM+1,,AUTO
        50 000012   200007 451500                    STP1    @ERROR_NUM+2,,AUTO
        50 000013   200007 630500                    EPPR0   @ERROR_NUM+2,,AUTO
        50 000014   000000 631400 51                 EPPR1   0
        50 000015   000000 701000 xent               TSX1    INFO_ONLY
        50 000016   000000 011000                    NOP     0

       93     4829    2   END INFO_ONLY_INT;

   4829 50 000017   200004 221300                    LDX1  ! 4,,AUTO
        50 000020   000001 702211                    TSX2  ! 1,X1

       94     4830        %EJECT;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:30   
       95     4831        /*
       96     4832              This is the start of the main program for the permitted list.
       97     4833            Each permitted statement must have three different error messages
       98     4834            for each one since the validator works for three different
       99     4835            subschema (COBOL, FORTRAN, APL, BASIC). The call to INFO_ONLY_INT gives
      100     4836            the cobol number of the error message and if the language is
      101     4837            fortran then a 1 is added to the error_num and if the language is
      102     4838            apl the a 2 is added to the error_num.
      103     4839        */
      104     4840    1       CALL SUBLST(HEAD_PERMIT);

   4840 50 000021   000001 630400 51                 EPPR0   1
        50 000022   000000 631400 51                 EPPR1   0
        50 000023   000000 701000 xent               TSX1    SUBLST
        50 000024   000000 011000                    NOP     0

      105     4841    1       AC$ = PINCRW(SSS$, OA.OAACN);

   4841 50 000025   000000 470400 39                 LDP0    OA$
        50 000026   000001 220100                    LDX0    1,,PR0
        50 000027   000000 636010                    EAQ     0,X0
        50 000030   000000 036000 30                 ADLQ    SSS$
        50 000031   000000 756000 31                 STQ     AC$

      106     4842    2       DO WHILE (SSS$ ~= AC$);

   4842 50 000032   000000 116000 30                 CMPQ    SSS$
        50 000033   000203 600000 50                 TZE     s:4902

      107     4843    2           NUM_RECORDS = 0;

   4843 50 000034   000013 450000 1                  STZ     NUM_RECORDS

      108     4844    2           TEMP_WORD = AC.ANAM;

   4844 50 000035   000000 470400 31                 LDP0    AC$
        50 000036   000000 720100                    LXL0    0,,PR0
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:31   
        50 000037   000077 360003                    ANX0    63,DU
        50 000040   040000 100540                    MLR     fill='040'O
        50 000041   000026 000010                    ADSC9   22,,PR0                  cn=0,n=*X0
        50 000042   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      109     4845    2           LIST_STRING = ' ';

   4845 50 000043   040000 100400                    MLR     fill='040'O
        50 000044   000002 000001 51                 ADSC9   2                        cn=0,n=1
        50 000045   000000 000200 3                  ADSC9   LIST_STRING              cn=0,n=128

      110     4846    2           CALL LIST(LIST_STRING);

   4846 50 000046   000003 630400 51                 EPPR0   3
        50 000047   000000 631400 51                 EPPR1   0
        50 000050   000000 701000 xent               TSX1    LIST
        50 000051   000000 011000                    NOP     0

      111     4847    2           CALL LIST(LIST_STRING);

   4847 50 000052   000003 630400 51                 EPPR0   3
        50 000053   000000 631400 51                 EPPR1   0
        50 000054   000000 701000 xent               TSX1    LIST
        50 000055   000000 011000                    NOP     0

      112     4848    2           CALL CONCAT(LIST_STRING,'<<<<<PERMITTED LIST FOR AREA ',AC.ANAM,' >>>>>');

   4848 50 000056   000000 470400 31                 LDP0    AC$
        50 000057   000000 720100                    LXL0    0,,PR0
        50 000060   000077 360003                    ANX0    63,DU
        50 000061   040000 100400                    MLR     fill='040'O
        50 000062   000020 000035 0                  ADSC9   HEAD_PERMIT+16           cn=0,n=29
        50 000063   000000 000035 3                  ADSC9   LIST_STRING              cn=0,n=29
        50 000064   040000 100540                    MLR     fill='040'O
        50 000065   000026 000010                    ADSC9   22,,PR0                  cn=0,n=*X0
        50 000066   000007 200143 3                  ADSC9   LIST_STRING+7            cn=1,n=99
        50 000067   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:32   
        50 000070   000022 772000                    QRL     18
        50 000071   000143 116007                    CMPQ    99,DL
        50 000072   000103 603000 50                 TRC     s:4849
        50 000073   200006 740100                    STX0    @ERROR_NUM+1,,AUTO
        50 000074   777634 620010                    EAX0    -100,X0
        50 000075   777777 660003                    ERX0    -1,DU
        50 000076   200006 235100                    LDA     @ERROR_NUM+1,,AUTO
        50 000077   000022 771000                    ARL     18
        50 000100   040045 100400                    MLR     fill='040'O
        50 000101   000030 000006 0                  ADSC9   HEAD_PERMIT+24           cn=0,n=6
        50 000102   000007 200010 3                  ADSC9   LIST_STRING+7,A          cn=1,n=*X0

      113     4849    2           CALL LIST(LIST_STRING);

   4849 50 000103   000003 630400 51                 EPPR0   3
        50 000104   000000 631400 51                 EPPR1   0
        50 000105   000000 701000 xent               TSX1    LIST
        50 000106   000000 011000                    NOP     0

      114     4850    2           CALL SET_FIELDS(1,30,TEMP_WORD);

   4850 50 000107   000007 630400 51                 EPPR0   7
        50 000110   000004 631400 51                 EPPR1   4
        50 000111   000000 701000 xent               TSX1    SET_FIELDS
        50 000112   000000 011000                    NOP     0

      115     4851    2           RA$ = PINCRW(SSS$, AC.ACRAN);

   4851 50 000113   000000 470400 31                 LDP0    AC$
        50 000114   000001 720100                    LXL0    1,,PR0
        50 000115   000000 636010                    EAQ     0,X0
        50 000116   000000 036000 30                 ADLQ    SSS$
        50 000117   000000 756000 41                 STQ     RA$

      116     4852    3           DO WHILE (RA$ ~= SSS$);

   4852 50 000120   000000 116000 30                 CMPQ    SSS$
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:33   
        50 000121   000174 600000 50                 TZE     s:4900

      117     4853    3               RC$ = PINCRW(SSS$, RA.RCRAH);

   4853 50 000122   000000 470400 41                 LDP0    RA$
        50 000123   000002 220100                    LDX0    2,,PR0
        50 000124   000000 636010                    EAQ     0,X0
        50 000125   000000 036000 30                 ADLQ    SSS$
        50 000126   000000 756000 37                 STQ     RC$

      118     4854    3               IF ~RC.DEF.SR

   4854 50 000127   000000 471400 37                 LDP1    RC$
        50 000130   100000 236100                    LDQ     0,,PR1
        50 000131   000024 736000                    QLS     20
        50 000132   400000 376003                    ANQ     -131072,DU
        50 000133   400000 676003                    ERQ     -131072,DU
        50 000134   000165 600000 50                 TZE     s:4898

      119     4855    4               THEN DO;

      120     4856    4                   NUM_RECORDS = NUM_RECORDS + 1;

   4856 50 000135   000013 235000 1                  LDA     NUM_RECORDS
        50 000136   000001 035007                    ADLA    1,DL
        50 000137   000013 755000 1                  STA     NUM_RECORDS

      121     4857    4                   TEMP_WORD = RC.RNAM;

   4857 50 000140   100000 721100                    LXL1    0,,PR1
        50 000141   000077 361003                    ANX1    63,DU
        50 000142   040000 100540                    MLR     fill='040'O
        50 000143   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
        50 000144   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      122     4858    4                   CALL SET_FIELDS(2,30,TEMP_WORD);

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:34   
   4858 50 000145   000013 630400 51                 EPPR0   11
        50 000146   000004 631400 51                 EPPR1   4
        50 000147   000000 701000 xent               TSX1    SET_FIELDS
        50 000150   000000 011000                    NOP     0

      123     4859    4                   IF NUM_RECORDS = 1

   4859 50 000151   000013 235000 1                  LDA     NUM_RECORDS
        50 000152   000001 115007                    CMPA    1,DL
        50 000153   000161 601000 50                 TNZ     s:4892

      124     4860    5                   THEN DO;

      125     4861    5                       CALL INFO_ONLY_INT(%ZIG_PER_AREA_FINDS);

   4861 50 000154   000017 236000 51                 LDQ     15
        50 000155   200005 756100                    STQ     5,,AUTO
        50 000156   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 000157   000000 011000                    NOP     0

      126     4862        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_COBOL-C
      127     4863        MESSAGE: For the area %U1 these DML calls are permitted:
      128     4864                 FIND NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1
      129     4865                 FIND CURRENT [record-name] WITHIN %U1
      130     4866                 .
      131     4867                 Record-name = %U2
      132     4868        */
      133     4869        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_FORT-C
      134     4870        MESSAGE: For the area %U1 these DML calls are permitted:
      135     4871                 CALL FIND(NEXT|PRIOR|FIRST|LAST|integer-1 [,record-name], %U1)
      136     4872                 CALL FIND (CURRENT [,record-name], %U1)
      137     4873                 .
      138     4874                 Record-name = %U2
      139     4875        */
      140     4876        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_APL-C
      141     4877        MESSAGE: For the area %U1 these DML calls are permitted:
      142     4878                 []DBFIND 'NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1'
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:35   
      143     4879                 []DBFIND 'CURRENT [record-name] WITHIN %U1'
      144     4880                 .
      145     4881                 Record-name = %U2
      146     4882        */
      147     4883        /*E*     ERROR:    ZIG-ZIG_PER_AREA_FINDS_BASIC-C
      148     4884        MESSAGE: For the area %U1 these DML calls are permitted:
      149     4885                 [line no] DB FIND NEXT/PRIOR/FIRST/LAST/integer-1 [record-name] WITHIN %U1
      150     4886                 [line no] DB FIND CURRENT [record-name] WITHIN %U1
      151     4887                 .
      152     4888                 Record-name = %U2
      153     4889        */
      154     4890    5                       END;

   4890 50 000160   000165 710000 50                 TRA     s:4898

      155     4891    5                   ELSE DO;

      156     4892    5                       CALL INFO_ONLY(%ZIG_PER_MORE_AREAS);

   4892 50 000161   000021 630400 51                 EPPR0   17
        50 000162   000000 631400 51                 EPPR1   0
        50 000163   000000 701000 xent               TSX1    INFO_ONLY
        50 000164   000000 011000                    NOP     0

      157     4893        /*E*     ERROR:    ZIG-ZIG_PER_MORE_AREAS-C
      158     4894        MESSAGE: or          , %U2
      159     4895        */
      160     4896    5                       END;

      161     4897    4                   END;

      162     4898    3               RA$ = PINCRW(SSS$, RA.ACRAN);

   4898 50 000165   000000 470400 41                 LDP0    RA$
        50 000166   000001 720100                    LXL0    1,,PR0
        50 000167   000000 636010                    EAQ     0,X0
        50 000170   000000 036000 30                 ADLQ    SSS$
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:36   
        50 000171   000000 756000 41                 STQ     RA$

      163     4899    3               END;

   4899 50 000172   000000 116000 30                 CMPQ    SSS$
        50 000173   000122 601000 50                 TNZ     s:4853

      164     4900    2           AC$ = PINCRW(SSS$, AC.OAACN);

   4900 50 000174   000000 470400 31                 LDP0    AC$
        50 000175   000001 220100                    LDX0    1,,PR0
        50 000176   000000 636010                    EAQ     0,X0
        50 000177   000000 036000 30                 ADLQ    SSS$
        50 000200   000000 756000 31                 STQ     AC$

      165     4901    2           END;

   4901 50 000201   000000 116000 30                 CMPQ    SSS$
        50 000202   000034 601000 50                 TNZ     s:4843

      166     4902    1       SC$ = PINCRW(SSS$,OA.OASCN);

   4902 50 000203   000000 470400 39                 LDP0    OA$
        50 000204   000001 720100                    LXL0    1,,PR0
        50 000205   000000 636010                    EAQ     0,X0
        50 000206   000000 036000 30                 ADLQ    SSS$
        50 000207   000000 756000 35                 STQ     SC$

      167     4903    2       DO WHILE (SC$ ~= SSS$);

   4903 50 000210   000000 116000 30                 CMPQ    SSS$
        50 000211   000641 600000 50                 TZE     s:5067

      168     4904    2           IF ~SC.DEF.SNSS AND SC.DEF.SETT = 0

   4904 50 000212   000000 470400 35                 LDP0    SC$
        50 000213   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:37   
        50 000214   000026 736000                    QLS     22
        50 000215   400000 376003                    ANQ     -131072,DU
        50 000216   400000 676003                    ERQ     -131072,DU
        50 000217   000632 600000 50                 TZE     s:5058
        50 000220   000000 236100                    LDQ     0,,PR0
        50 000221   000700 316007                    CANQ    448,DL
        50 000222   000632 601000 50                 TNZ     s:5058

      169     4905    3           THEN DO;

      170     4906    3               NUM_REC_IN_SET = 0;

   4906 50 000223   000014 450000 1                  STZ     NUM_REC_IN_SET

      171     4907    3               TEMP_WORD = SC.SNAM;

   4907 50 000224   000000 720100                    LXL0    0,,PR0
        50 000225   000077 360003                    ANX0    63,DU
        50 000226   040000 100540                    MLR     fill='040'O
        50 000227   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        50 000230   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      172     4908    3               LIST_STRING = ' ';

   4908 50 000231   040000 100400                    MLR     fill='040'O
        50 000232   000002 000001 51                 ADSC9   2                        cn=0,n=1
        50 000233   000000 000200 3                  ADSC9   LIST_STRING              cn=0,n=128

      173     4909    3               CALL LIST(LIST_STRING);

   4909 50 000234   000003 630400 51                 EPPR0   3
        50 000235   000000 631400 51                 EPPR1   0
        50 000236   000000 701000 xent               TSX1    LIST
        50 000237   000000 011000                    NOP     0

      174     4910    3               CALL LIST(LIST_STRING);

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:38   
   4910 50 000240   000003 630400 51                 EPPR0   3
        50 000241   000000 631400 51                 EPPR1   0
        50 000242   000000 701000 xent               TSX1    LIST
        50 000243   000000 011000                    NOP     0

      175     4911    3              CALL CONCAT(LIST_STRING,'<<<<<PERMITTED LIST FOR SET ',SC.SNAM,' >>>>>')
              4911                        ;

   4911 50 000244   000000 470400 35                 LDP0    SC$
        50 000245   000000 720100                    LXL0    0,,PR0
        50 000246   000077 360003                    ANX0    63,DU
        50 000247   040000 100400                    MLR     fill='040'O
        50 000250   000032 000034 0                  ADSC9   HEAD_PERMIT+26           cn=0,n=28
        50 000251   000000 000034 3                  ADSC9   LIST_STRING              cn=0,n=28
        50 000252   040000 100540                    MLR     fill='040'O
        50 000253   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        50 000254   000007 000144 3                  ADSC9   LIST_STRING+7            cn=0,n=100
        50 000255   000000 636010                    EAQ     0,X0
        50 000256   000022 772000                    QRL     18
        50 000257   000144 116007                    CMPQ    100,DL
        50 000260   000271 603000 50                 TRC     s:4912
        50 000261   200006 740100                    STX0    @ERROR_NUM+1,,AUTO
        50 000262   777633 620010                    EAX0    -101,X0
        50 000263   777777 660003                    ERX0    -1,DU
        50 000264   200006 235100                    LDA     @ERROR_NUM+1,,AUTO
        50 000265   000022 771000                    ARL     18
        50 000266   040045 100400                    MLR     fill='040'O
        50 000267   000030 000006 0                  ADSC9   HEAD_PERMIT+24           cn=0,n=6
        50 000270   000007 000010 3                  ADSC9   LIST_STRING+7,A          cn=0,n=*X0

      176     4912    3               CALL LIST(LIST_STRING);

   4912 50 000271   000003 630400 51                 EPPR0   3
        50 000272   000000 631400 51                 EPPR1   0
        50 000273   000000 701000 xent               TSX1    LIST
        50 000274   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:39   
      177     4913    3               CALL SET_FIELDS(1,30,TEMP_WORD);

   4913 50 000275   000007 630400 51                 EPPR0   7
        50 000276   000004 631400 51                 EPPR1   4
        50 000277   000000 701000 xent               TSX1    SET_FIELDS
        50 000300   000000 011000                    NOP     0

      178     4914    3               RS$ = PINCRW(SSS$, SC.SCRSN);

   4914 50 000301   000000 470400 35                 LDP0    SC$
        50 000302   000002 220100                    LDX0    2,,PR0
        50 000303   000000 636010                    EAQ     0,X0
        50 000304   000000 036000 30                 ADLQ    SSS$
        50 000305   000000 756000 42                 STQ     RS$

      179     4915    4               DO WHILE (SSS$ ~= RS$);

   4915 50 000306   000000 116000 30                 CMPQ    SSS$
        50 000307   000544 600000 50                 TZE     s:5015

      180     4916    4                   RC$ = PINCRW(SSS$, RS.RCRSH);

   4916 50 000310   000000 470400 42                 LDP0    RS$
        50 000311   000003 220100                    LDX0    3,,PR0
        50 000312   000000 636010                    EAQ     0,X0
        50 000313   000000 036000 30                 ADLQ    SSS$
        50 000314   000000 756000 37                 STQ     RC$

      181     4917    4                   TEMP_WORD = RC.RNAM;

   4917 50 000315   000000 471400 37                 LDP1    RC$
        50 000316   100000 721100                    LXL1    0,,PR1
        50 000317   000077 361003                    ANX1    63,DU
        50 000320   040000 100540                    MLR     fill='040'O
        50 000321   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
        50 000322   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:40   
      182     4918    4                   CALL SET_FIELDS(2,30,TEMP_WORD);

   4918 50 000323   000013 630400 51                 EPPR0   11
        50 000324   000004 631400 51                 EPPR1   4
        50 000325   000000 701000 xent               TSX1    SET_FIELDS
        50 000326   000000 011000                    NOP     0

      183     4919    4                   IF RS.DEF.TYPE = '0100'O

   4919 50 000327   000000 470400 42                 LDP0    RS$
        50 000330   000000 236100                    LDQ     0,,PR0
        50 000331   777700 376003                    ANQ     -64,DU
        50 000332   010000 116003                    CMPQ    4096,DU
        50 000333   000347 601000 50                 TNZ     s:4941

      184     4920    5                   THEN DO;

      185     4921         /* A owner well lets go with it */
      186     4922    5                       IF ~RC.DEF.SR

   4922 50 000334   000000 471400 37                 LDP1    RC$
        50 000335   100000 236100                    LDQ     0,,PR1
        50 000336   000024 736000                    QLS     20
        50 000337   400000 376003                    ANQ     -131072,DU
        50 000340   400000 676003                    ERQ     -131072,DU
        50 000341   000535 600000 50                 TZE     s:5013

      187     4923    6                       THEN DO;

      188     4924    6                           CALL INFO_ONLY_INT(%ZIG_PER_SET_OWNER);

   4924 50 000342   000023 236000 51                 LDQ     19
        50 000343   200005 756100                    STQ     5,,AUTO
        50 000344   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 000345   000000 011000                    NOP     0

      189     4925        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_COBOL-C
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:41   
      190     4926        MESSAGE: FIND OWNER [ %U2 ] WITHIN %U1
      191     4927        */
      192     4928        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_FORT-C
      193     4929        MESSAGE: CALL FIND (OWNER [,%U2 ], %U1)
      194     4930        */
      195     4931        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_APL-C
      196     4932        MESSAGE: []DBFIND 'OWNER [ %U2 ] WITHIN %U1'
      197     4933        */
      198     4934        /*E*     ERROR:    ZIG-ZIG_PER_SET_OWNER_BASIC-C
      199     4935        MESSAGE: [line no] DB FIND OWNER WITHIN %U1
      200     4936        */
      201     4937    6                           END;

      202     4938    5                       END;

   4938 50 000346   000535 710000 50                 TRA     s:5013

      203     4939    5                   ELSE DO;

      204     4940         /* Now we have a member */
      205     4941    5                       IF ~RC.DEF.SR

   4941 50 000347   000000 471400 37                 LDP1    RC$
        50 000350   100000 236100                    LDQ     0,,PR1
        50 000351   000024 736000                    QLS     20
        50 000352   400000 376003                    ANQ     -131072,DU
        50 000353   400000 676003                    ERQ     -131072,DU
        50 000354   000535 600000 50                 TZE     s:5013

      206     4942    6                       THEN DO;

      207     4943    6                           IF RS.DEF.MSM OR RS.DEF.OSM

   4943 50 000355   000000 236100                    LDQ     0,,PR0
        50 000356   040000 316007                    CANQ    16384,DL
        50 000357   000362 601000 50                 TNZ     s:4947
        50 000360   100000 316007                    CANQ    32768,DL
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:42   
        50 000361   000511 600000 50                 TZE     s:4979

      208     4944    7                           THEN DO;

      209     4945         /* Might be able to connect
      210     4946         and disconnect. */
      211     4947    7                               CONNECT_OK = '1'B;

   4947 50 000362   400000 236003                    LDQ     -131072,DU
        50 000363   000010 756000 1                  STQ     CONNECT_OK

      212     4948    7                               CD$ = PINCRW(SSS$, RS.RSCDN);

   4948 50 000364   000001 220100                    LDX0    1,,PR0
        50 000365   000000 636010                    EAQ     0,X0
        50 000366   000000 036000 30                 ADLQ    SSS$
        50 000367   000000 756000 45                 STQ     CD$

      213     4949    8                               DO WHILE (SSS$ ~= CD$ AND CONNECT_OK);

   4949 50 000370   000422 710000 50                 TRA     s:4960

      214     4950    8                                   IF CD.CDRH ~= 0

   4950 50 000371   000000 470400 45                 LDP0    CD$
        50 000372   000002 720100                    LXL0    2,,PR0
        50 000373   000400 600000 50                 TZE     s:4955

      215     4951    9                                   THEN DO;

      216     4952    9                                       FR$ = PINCRW(SSS$, CD.CDRH);

   4952 50 000374   000000 636010                    EAQ     0,X0
        50 000375   000000 036000 30                 ADLQ    SSS$
        50 000376   000000 756000 33                 STQ     FR$

      217     4953    9                                       END;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:43   

   4953 50 000377   000404 710000 50                 TRA     s:4957

      218     4954    9                                   ELSE DO;

      219     4955    9                                       FR$ = PINCRW(SSS$, CD.CDSH);

   4955 50 000400   000002 221100                    LDX1    2,,PR0
        50 000401   000000 636011                    EAQ     0,X1
        50 000402   000000 036000 30                 ADLQ    SSS$
        50 000403   000000 756000 33                 STQ     FR$

      220     4956    9                                       END;

      221     4957    8                                   IF FR.DEF.FSR AND ~FR.DEF.SYN

   4957 50 000404   000000 471400 33                 LDP1    FR$
        50 000405   100000 236100                    LDQ     0,,PR1
        50 000406   000100 316007                    CANQ    64,DL
        50 000407   000416 600000 50                 TZE     s:4959
        50 000410   100000 236100                    LDQ     0,,PR1
        50 000411   000030 736000                    QLS     24
        50 000412   400000 376003                    ANQ     -131072,DU
        50 000413   400000 676003                    ERQ     -131072,DU
        50 000414   000416 600000 50                 TZE     s:4959

      222     4958    8                                   THEN CONNECT_OK = '0'B;

   4958 50 000415   000010 450000 1                  STZ     CONNECT_OK

      223     4959    8                                   CD$ = PINCRW(SSS$, CD.RSCDN);

   4959 50 000416   000001 221100                    LDX1    1,,PR0
        50 000417   000000 636011                    EAQ     0,X1
        50 000420   000000 036000 30                 ADLQ    SSS$
        50 000421   000000 756000 45                 STQ     CD$

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:44   
      224     4960    8                                   END;

   4960 50 000422   000000 116000 30                 CMPQ    SSS$
        50 000423   000426 600000 50                 TZE     s:4961
        50 000424   000010 234000 1                  SZN     CONNECT_OK
        50 000425   000371 604000 50                 TMI     s:4950

      225     4961    7                               SS$ = PINCRW(SSS$, RS.RSSSN);

   4961 50 000426   000000 470400 42                 LDP0    RS$
        50 000427   000001 720100                    LXL0    1,,PR0
        50 000430   000000 636010                    EAQ     0,X0
        50 000431   000000 036000 30                 ADLQ    SSS$
        50 000432   000000 756000 44                 STQ     SS$

      226     4962    8                               DO WHILE (SSS$ ~= SS$ AND CONNECT_OK);

   4962 50 000433   000505 710000 50                 TRA     s:4977

      227     4963    8                                   CD$ = PINCRW(SSS$, SS.RSCDN);

   4963 50 000434   000000 470400 44                 LDP0    SS$
        50 000435   000001 220100                    LDX0    1,,PR0
        50 000436   000000 636010                    EAQ     0,X0
        50 000437   000000 036000 30                 ADLQ    SSS$
        50 000440   000000 756000 45                 STQ     CD$

      228     4964    9                                   DO WHILE(CD$ ~= SSS$ AND CONNECT_OK);

   4964 50 000441   000474 710000 50                 TRA     s:4975

      229     4965    9                                       IF CD.CDRH ~= 0

   4965 50 000442   000000 470400 45                 LDP0    CD$
        50 000443   000002 720100                    LXL0    2,,PR0
        50 000444   000452 600000 50                 TZE     s:4970

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:45   
      230     4966   10                                       THEN DO;

      231     4967   10                                           FR$ = PINCRW(SSS$, CD.CDRN);

   4967 50 000445   000003 721100                    LXL1    3,,PR0
        50 000446   000000 636011                    EAQ     0,X1
        50 000447   000000 036000 30                 ADLQ    SSS$
        50 000450   000000 756000 33                 STQ     FR$

      232     4968   10                                           END;

   4968 50 000451   000456 710000 50                 TRA     s:4972

      233     4969   10                                       ELSE DO;

      234     4970   10                                           FR$ = PINCRW(SSS$, CD.CDSN);

   4970 50 000452   000003 221100                    LDX1    3,,PR0
        50 000453   000000 636011                    EAQ     0,X1
        50 000454   000000 036000 30                 ADLQ    SSS$
        50 000455   000000 756000 33                 STQ     FR$

      235     4971   10                                           END;

      236     4972    9                                       IF FR.DEF.FSR AND ~FR.DEF.SYN

   4972 50 000456   000000 471400 33                 LDP1    FR$
        50 000457   100000 236100                    LDQ     0,,PR1
        50 000460   000100 316007                    CANQ    64,DL
        50 000461   000470 600000 50                 TZE     s:4974
        50 000462   100000 236100                    LDQ     0,,PR1
        50 000463   000030 736000                    QLS     24
        50 000464   400000 376003                    ANQ     -131072,DU
        50 000465   400000 676003                    ERQ     -131072,DU
        50 000466   000470 600000 50                 TZE     s:4974

      237     4973    9                                       THEN CONNECT_OK = '0'B;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:46   

   4973 50 000467   000010 450000 1                  STZ     CONNECT_OK

      238     4974    9                                       CD$ = PINCRW(SSS$, CD.RSCDN);

   4974 50 000470   000001 221100                    LDX1    1,,PR0
        50 000471   000000 636011                    EAQ     0,X1
        50 000472   000000 036000 30                 ADLQ    SSS$
        50 000473   000000 756000 45                 STQ     CD$

      239     4975    9                                       END;

   4975 50 000474   000000 116000 30                 CMPQ    SSS$
        50 000475   000500 600000 50                 TZE     s:4976
        50 000476   000010 234000 1                  SZN     CONNECT_OK
        50 000477   000442 604000 50                 TMI     s:4965

      240     4976    8                                   SS$ = PINCRW(SSS$, SS.RSSSN);

   4976 50 000500   000000 470400 44                 LDP0    SS$
        50 000501   000001 720100                    LXL0    1,,PR0
        50 000502   000000 636010                    EAQ     0,X0
        50 000503   000000 036000 30                 ADLQ    SSS$
        50 000504   000000 756000 44                 STQ     SS$

      241     4977    8                                   END;

   4977 50 000505   000000 116000 30                 CMPQ    SSS$
        50 000506   000511 600000 50                 TZE     s:4979
        50 000507   000010 234000 1                  SZN     CONNECT_OK
        50 000510   000434 604000 50                 TMI     s:4963

      242     4978    7                               END;

      243     4979    6                           IF (RS.DEF.MSM OR RS.DEF.OSM) AND CONNECT_OK

   4979 50 000511   000000 470400 42                 LDP0    RS$
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:47   
        50 000512   000000 236100                    LDQ     0,,PR0
        50 000513   040000 316007                    CANQ    16384,DL
        50 000514   000517 601000 50                 TNZ     s:4979+6
        50 000515   100000 316007                    CANQ    32768,DL
        50 000516   000525 600000 50                 TZE     s:4995
        50 000517   000010 234000 1                  SZN     CONNECT_OK
        50 000520   000525 605000 50                 TPL     s:4995

      244     4980    7                           THEN DO;

      245     4981    7                               CALL INFO_ONLY_INT(%ZIG_PER_CONNECT_SET);

   4981 50 000521   000025 236000 51                 LDQ     21
        50 000522   200005 756100                    STQ     5,,AUTO
        50 000523   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 000524   000000 011000                    NOP     0

      246     4982        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_COBOL-C
      247     4983        MESSAGE: CONNECT %U2 TO %U1
      248     4984        */
      249     4985        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_FORT-C
      250     4986        MESSAGE: CALL CONNECT([%U2,]  %U1)
      251     4987        */
      252     4988        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_APL-C
      253     4989        MESSAGE: []DBCONNECT '[%U2] [TO] %U1'
      254     4990        */
      255     4991        /*E*     ERROR:    ZIG-ZIG_PER_CONNECT_SET_BASIC_C
      256     4992        MESSAGE: [line no] DB CONNECT [%U2] [TO] %U1
      257     4993        */
      258     4994    7                               END;

      259     4995    6                           IF RS.DEF.OSM

   4995 50 000525   000000 470400 42                 LDP0    RS$
        50 000526   000000 236100                    LDQ     0,,PR0
        50 000527   100000 316007                    CANQ    32768,DL
        50 000530   000535 600000 50                 TZE     s:5013
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:48   

      260     4996    7                           THEN DO;

      261     4997    7                               CALL INFO_ONLY_INT(%ZIG_PER_DISCONNECT_SET);

   4997 50 000531   000027 236000 51                 LDQ     23
        50 000532   200005 756100                    STQ     5,,AUTO
        50 000533   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 000534   000000 011000                    NOP     0

      262     4998        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_COBOL-C
      263     4999        MESSAGE: DISCONNECT %U2 FROM %U1
      264     5000        */
      265     5001        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_FORT-C
      266     5002        MESSAGE: CALL DISCONNECT(%U2 ,%U1)
      267     5003        */
      268     5004        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_APL-C
      269     5005        MESSAGE: []DBDISCONNECT '%U2 FROM %U1'
      270     5006        */
      271     5007        /*E*     ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_BASIC-C
      272     5008        MESSAGE: [line no] DB DISCONNECT %U2 [FROM] %U1
      273     5009        */
      274     5010    7                               END;

      275     5011    6                           END;

      276     5012    5                       END;

      277     5013    4                   RS$ = PINCRW(SSS$, RS.SCRSN);

   5013 50 000535   000000 470400 42                 LDP0    RS$
        50 000536   000002 220100                    LDX0    2,,PR0
        50 000537   000000 636010                    EAQ     0,X0
        50 000540   000000 036000 30                 ADLQ    SSS$
        50 000541   000000 756000 42                 STQ     RS$

      278     5014    4                   END;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:49   

   5014 50 000542   000000 116000 30                 CMPQ    SSS$
        50 000543   000310 601000 50                 TNZ     s:4916

      279     5015    3               RS$ = PINCRW(SSS$, SC.SCRSN);

   5015 50 000544   000000 470400 35                 LDP0    SC$
        50 000545   000002 220100                    LDX0    2,,PR0
        50 000546   000000 636010                    EAQ     0,X0
        50 000547   000000 036000 30                 ADLQ    SSS$
        50 000550   000000 756000 42                 STQ     RS$

      280     5016    4               DO WHILE(SSS$ ~= RS$);

   5016 50 000551   000000 116000 30                 CMPQ    SSS$
        50 000552   000632 600000 50                 TZE     s:5058

      281     5017    4                   RC$ = PINCRW(SSS$, RS.RCRSH);

   5017 50 000553   000000 470400 42                 LDP0    RS$
        50 000554   000003 220100                    LDX0    3,,PR0
        50 000555   000000 636010                    EAQ     0,X0
        50 000556   000000 036000 30                 ADLQ    SSS$
        50 000557   000000 756000 37                 STQ     RC$

      282     5018    4                   TEMP_WORD = RC.RNAM;

   5018 50 000560   000000 471400 37                 LDP1    RC$
        50 000561   100000 721100                    LXL1    0,,PR1
        50 000562   000077 361003                    ANX1    63,DU
        50 000563   040000 100540                    MLR     fill='040'O
        50 000564   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
        50 000565   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      283     5019    4                   CALL SET_FIELDS(2,30,TEMP_WORD);

   5019 50 000566   000013 630400 51                 EPPR0   11
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:50   
        50 000567   000004 631400 51                 EPPR1   4
        50 000570   000000 701000 xent               TSX1    SET_FIELDS
        50 000571   000000 011000                    NOP     0

      284     5020    4                   IF ~RC.DEF.SR AND RS.DEF.TYPE = '0040'O

   5020 50 000572   000000 470400 37                 LDP0    RC$
        50 000573   000000 236100                    LDQ     0,,PR0
        50 000574   000024 736000                    QLS     20
        50 000575   400000 376003                    ANQ     -131072,DU
        50 000576   400000 676003                    ERQ     -131072,DU
        50 000577   000623 600000 50                 TZE     s:5055
        50 000600   000000 471400 42                 LDP1    RS$
        50 000601   100000 236100                    LDQ     0,,PR1
        50 000602   777700 376003                    ANQ     -64,DU
        50 000603   004000 116003                    CMPQ    2048,DU
        50 000604   000623 601000 50                 TNZ     s:5055

      285     5021    5                   THEN DO;

      286     5022    5                       NUM_REC_IN_SET = NUM_REC_IN_SET + 1;

   5022 50 000605   000014 235000 1                  LDA     NUM_REC_IN_SET
        50 000606   000001 035007                    ADLA    1,DL
        50 000607   000014 755000 1                  STA     NUM_REC_IN_SET

      287     5023    5                       IF NUM_REC_IN_SET = 1

   5023 50 000610   000001 115007                    CMPA    1,DL
        50 000611   000617 601000 50                 TNZ     s:5052

      288     5024    6                       THEN DO;

      289     5025    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_SET);

   5025 50 000612   000031 236000 51                 LDQ     25
        50 000613   200005 756100                    STQ     5,,AUTO
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:51   
        50 000614   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 000615   000000 011000                    NOP     0

      290     5026        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_COBOL-C
      291     5027        MESSAGE: FIND NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1
      292     5028                 FIND CURRENT [record-name] WITHIN %U1
      293     5029                 .
      294     5030                 record-name = %U2
      295     5031        */
      296     5032        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_FORT-C
      297     5033        MESSAGE: CALL FIND(NEXT|PRIOR|FIRST|LAST|integer-1 [,record-name] ,%U1)
      298     5034                 CALL FIND(CURRENT [,record-name] ,%U1)
      299     5035                 .
      300     5036                 record-name = %U2
      301     5037        */
      302     5038        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_APL-C
      303     5039        MESSAGE: []DBFIND 'NEXT|PRIOR|FIRST|LAST|integer-1 [record-name] WITHIN %U1'
      304     5040                 []DBFIND 'CURRENT [record-name] WITHIN %U1'
      305     5041                 .
      306     5042                 record-name = %U2
      307     5043        */
      308     5044        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_BASIC-C
      309     5045       MESSAGE: [line no] DB FIND NEXT/PRIOR/FIRST/LAST/integer-1 [record-name] [WITHIN] %U
              5045        1
      310     5046                 [line no] DB FIND CURRENT [record-name] [WITHIN] %U1
      311     5047                 .
      312     5048                 record-name = %U2
      313     5049        */
      314     5050    6                           END;

   5050 50 000616   000623 710000 50                 TRA     s:5055

      315     5051    6                       ELSE DO;

      316     5052    6                           CALL INFO_ONLY(%ZIG_PER_MORE_AREAS);

   5052 50 000617   000021 630400 51                 EPPR0   17
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:52   
        50 000620   000000 631400 51                 EPPR1   0
        50 000621   000000 701000 xent               TSX1    INFO_ONLY
        50 000622   000000 011000                    NOP     0

      317     5053    6                           END;

      318     5054    5                       END;

      319     5055    4                   RS$ = PINCRW(SSS$, RS.SCRSN);

   5055 50 000623   000000 470400 42                 LDP0    RS$
        50 000624   000002 220100                    LDX0    2,,PR0
        50 000625   000000 636010                    EAQ     0,X0
        50 000626   000000 036000 30                 ADLQ    SSS$
        50 000627   000000 756000 42                 STQ     RS$

      320     5056    4                   END;

   5056 50 000630   000000 116000 30                 CMPQ    SSS$
        50 000631   000553 601000 50                 TNZ     s:5017

      321     5057    3               END;

      322     5058    2           SC$ = PINCRW(SSS$, SC.OASCN);

   5058 50 000632   000000 470400 35                 LDP0    SC$
        50 000633   000001 720100                    LXL0    1,,PR0
        50 000634   000000 636010                    EAQ     0,X0
        50 000635   000000 036000 30                 ADLQ    SSS$
        50 000636   000000 756000 35                 STQ     SC$

      323     5059    2           END;

   5059 50 000637   000000 116000 30                 CMPQ    SSS$
        50 000640   000212 601000 50                 TNZ     s:4904

      324     5060        /*
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:53   
      325     5061              Now go throw all the records and print out all the things
      326     5062            that can be performed on this record. Some of the DML calls
      327     5063            might have already been given in the set list of permitted
      328     5064            statements but what the hell why not print them out again
      329     5065            so the user can find them by record or set or area.
      330     5066        */
      331     5067    1       RC$ = PINCRW(SSS$, OA.OARCN);

   5067 50 000641   000000 470400 39                 LDP0    OA$
        50 000642   000002 220100                    LDX0    2,,PR0
        50 000643   000000 636010                    EAQ     0,X0
        50 000644   000000 036000 30                 ADLQ    SSS$
        50 000645   000000 756000 37                 STQ     RC$

      332     5068    2       DO WHILE (SSS$ ~= RC$);

   5068 50 000646   000000 116000 30                 CMPQ    SSS$
        50 000647   001574 600000 50                 TZE     s:5362

      333     5069    2           IF ~RC.DEF.SR

   5069 50 000650   000000 470400 37                 LDP0    RC$
        50 000651   000000 236100                    LDQ     0,,PR0
        50 000652   000024 736000                    QLS     20
        50 000653   400000 376003                    ANQ     -131072,DU
        50 000654   400000 676003                    ERQ     -131072,DU
        50 000655   001565 600000 50                 TZE     NO_MODIFY

      334     5070    3           THEN DO;

      335     5071    3               TEMP_WORD = RC.RNAM;

   5071 50 000656   000000 720100                    LXL0    0,,PR0
        50 000657   000077 360003                    ANX0    63,DU
        50 000660   040000 100540                    MLR     fill='040'O
        50 000661   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        50 000662   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:54   

      336     5072    3               LIST_STRING = ' ';

   5072 50 000663   040000 100400                    MLR     fill='040'O
        50 000664   000002 000001 51                 ADSC9   2                        cn=0,n=1
        50 000665   000000 000200 3                  ADSC9   LIST_STRING              cn=0,n=128

      337     5073    3               CALL LIST(LIST_STRING);

   5073 50 000666   000003 630400 51                 EPPR0   3
        50 000667   000000 631400 51                 EPPR1   0
        50 000670   000000 701000 xent               TSX1    LIST
        50 000671   000000 011000                    NOP     0

      338     5074    3               CALL LIST(LIST_STRING);

   5074 50 000672   000003 630400 51                 EPPR0   3
        50 000673   000000 631400 51                 EPPR1   0
        50 000674   000000 701000 xent               TSX1    LIST
        50 000675   000000 011000                    NOP     0

      339     5075    3               CALL CONCAT(LIST_STRING,'<<<<<PERMITTED LIST FOR RECORD ',RC.RNAM,
              5075                        ' >>>>>');

   5075 50 000676   000000 470400 37                 LDP0    RC$
        50 000677   000000 720100                    LXL0    0,,PR0
        50 000700   000077 360003                    ANX0    63,DU
        50 000701   040000 100400                    MLR     fill='040'O
        50 000702   000041 000037 0                  ADSC9   HEAD_PERMIT+33           cn=0,n=31
        50 000703   000000 000037 3                  ADSC9   LIST_STRING              cn=0,n=31
        50 000704   040000 100540                    MLR     fill='040'O
        50 000705   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        50 000706   000007 600141 3                  ADSC9   LIST_STRING+7            cn=3,n=97
        50 000707   000000 636010                    EAQ     0,X0
        50 000710   000022 772000                    QRL     18
        50 000711   000141 116007                    CMPQ    97,DL
        50 000712   000723 603000 50                 TRC     s:5076
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:55   
        50 000713   200006 740100                    STX0    @ERROR_NUM+1,,AUTO
        50 000714   777636 620010                    EAX0    -98,X0
        50 000715   777777 660003                    ERX0    -1,DU
        50 000716   200006 235100                    LDA     @ERROR_NUM+1,,AUTO
        50 000717   000022 771000                    ARL     18
        50 000720   040045 100400                    MLR     fill='040'O
        50 000721   000030 000006 0                  ADSC9   HEAD_PERMIT+24           cn=0,n=6
        50 000722   000007 600010 3                  ADSC9   LIST_STRING+7,A          cn=3,n=*X0

      340     5076    3               CALL LIST(LIST_STRING);

   5076 50 000723   000003 630400 51                 EPPR0   3
        50 000724   000000 631400 51                 EPPR1   0
        50 000725   000000 701000 xent               TSX1    LIST
        50 000726   000000 011000                    NOP     0

      341     5077    3               CALL SET_FIELDS(1,30,TEMP_WORD);

   5077 50 000727   000007 630400 51                 EPPR0   7
        50 000730   000004 631400 51                 EPPR1   4
        50 000731   000000 701000 xent               TSX1    SET_FIELDS
        50 000732   000000 011000                    NOP     0

      342     5078    3               RS$ = PINCRW(SSS$, RC.RCRSN);

   5078 50 000733   000000 470400 37                 LDP0    RC$
        50 000734   000002 720100                    LXL0    2,,PR0
        50 000735   000000 636010                    EAQ     0,X0
        50 000736   000000 036000 30                 ADLQ    SSS$
        50 000737   000000 756000 42                 STQ     RS$

      343     5079    4               DO WHILE (SSS$ ~= RS$);

   5079 50 000740   000000 116000 30                 CMPQ    SSS$
        50 000741   001163 600000 50                 TZE     s:5157

      344     5080    4                   SC$ = PINCRW(SSS$, RS.SCRSH);
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:56   

   5080 50 000742   000000 470400 42                 LDP0    RS$
        50 000743   000003 720100                    LXL0    3,,PR0
        50 000744   000000 636010                    EAQ     0,X0
        50 000745   000000 036000 30                 ADLQ    SSS$
        50 000746   000000 756000 35                 STQ     SC$

      345     5081    4                   TEMP_WORD = SC.SNAM;

   5081 50 000747   000000 471400 35                 LDP1    SC$
        50 000750   100000 721100                    LXL1    0,,PR1
        50 000751   000077 361003                    ANX1    63,DU
        50 000752   040000 100540                    MLR     fill='040'O
        50 000753   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        50 000754   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      346     5082    4                   CALL SET_FIELDS(2,30,TEMP_WORD);

   5082 50 000755   000013 630400 51                 EPPR0   11
        50 000756   000004 631400 51                 EPPR1   4
        50 000757   000000 701000 xent               TSX1    SET_FIELDS
        50 000760   000000 011000                    NOP     0

      347     5083    4                   IF RS.DEF.TYPE = '0040'O AND ~SC.DEF.SNSS

   5083 50 000761   000000 470400 42                 LDP0    RS$
        50 000762   000000 236100                    LDQ     0,,PR0
        50 000763   777700 376003                    ANQ     -64,DU
        50 000764   004000 116003                    CMPQ    2048,DU
        50 000765   001154 601000 50                 TNZ     s:5155
        50 000766   000000 471400 35                 LDP1    SC$
        50 000767   100000 236100                    LDQ     0,,PR1
        50 000770   000026 736000                    QLS     22
        50 000771   400000 376003                    ANQ     -131072,DU
        50 000772   400000 676003                    ERQ     -131072,DU
        50 000773   001154 600000 50                 TZE     s:5155

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:57   
      348     5084    5                   THEN DO;

      349     5085         /* Member of this set */
      350     5086    5                       IF RS.DEF.MSM OR RS.DEF.OSM

   5086 50 000774   000000 236100                    LDQ     0,,PR0
        50 000775   040000 316007                    CANQ    16384,DL
        50 000776   001001 601000 50                 TNZ     s:5090
        50 000777   100000 316007                    CANQ    32768,DL
        50 001000   001130 600000 50                 TZE     s:5122

      351     5087    6                       THEN DO;

      352     5088         /* Might be able to connect
      353     5089         and disconnect. */
      354     5090    6                           CONNECT_OK = '1'B;

   5090 50 001001   400000 236003                    LDQ     -131072,DU
        50 001002   000010 756000 1                  STQ     CONNECT_OK

      355     5091    6                           CD$ = PINCRW(SSS$, RS.RSCDN);

   5091 50 001003   000001 220100                    LDX0    1,,PR0
        50 001004   000000 636010                    EAQ     0,X0
        50 001005   000000 036000 30                 ADLQ    SSS$
        50 001006   000000 756000 45                 STQ     CD$

      356     5092    7                           DO WHILE (SSS$ ~= CD$ AND CONNECT_OK);

   5092 50 001007   001041 710000 50                 TRA     s:5103

      357     5093    7                               IF CD.CDRH ~= 0

   5093 50 001010   000000 470400 45                 LDP0    CD$
        50 001011   000002 720100                    LXL0    2,,PR0
        50 001012   001017 600000 50                 TZE     s:5098

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:58   
      358     5094    8                               THEN DO;

      359     5095    8                                   FR$ = PINCRW(SSS$, CD.CDRH);

   5095 50 001013   000000 636010                    EAQ     0,X0
        50 001014   000000 036000 30                 ADLQ    SSS$
        50 001015   000000 756000 33                 STQ     FR$

      360     5096    8                                   END;

   5096 50 001016   001023 710000 50                 TRA     s:5100

      361     5097    8                               ELSE DO;

      362     5098    8                                   FR$ = PINCRW(SSS$, CD.CDSH);

   5098 50 001017   000002 221100                    LDX1    2,,PR0
        50 001020   000000 636011                    EAQ     0,X1
        50 001021   000000 036000 30                 ADLQ    SSS$
        50 001022   000000 756000 33                 STQ     FR$

      363     5099    8                                   END;

      364     5100    7                               IF FR.DEF.FSR AND ~FR.DEF.SYN

   5100 50 001023   000000 471400 33                 LDP1    FR$
        50 001024   100000 236100                    LDQ     0,,PR1
        50 001025   000100 316007                    CANQ    64,DL
        50 001026   001035 600000 50                 TZE     s:5102
        50 001027   100000 236100                    LDQ     0,,PR1
        50 001030   000030 736000                    QLS     24
        50 001031   400000 376003                    ANQ     -131072,DU
        50 001032   400000 676003                    ERQ     -131072,DU
        50 001033   001035 600000 50                 TZE     s:5102

      365     5101    7                               THEN CONNECT_OK = '0'B;

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:59   
   5101 50 001034   000010 450000 1                  STZ     CONNECT_OK

      366     5102    7                               CD$ = PINCRW(SSS$, CD.RSCDN);

   5102 50 001035   000001 221100                    LDX1    1,,PR0
        50 001036   000000 636011                    EAQ     0,X1
        50 001037   000000 036000 30                 ADLQ    SSS$
        50 001040   000000 756000 45                 STQ     CD$

      367     5103    7                               END;

   5103 50 001041   000000 116000 30                 CMPQ    SSS$
        50 001042   001045 600000 50                 TZE     s:5104
        50 001043   000010 234000 1                  SZN     CONNECT_OK
        50 001044   001010 604000 50                 TMI     s:5093

      368     5104    6                           SS$ = PINCRW(SSS$, RS.RSSSN);

   5104 50 001045   000000 470400 42                 LDP0    RS$
        50 001046   000001 720100                    LXL0    1,,PR0
        50 001047   000000 636010                    EAQ     0,X0
        50 001050   000000 036000 30                 ADLQ    SSS$
        50 001051   000000 756000 44                 STQ     SS$

      369     5105    7                           DO WHILE (SSS$ ~= SS$ AND CONNECT_OK);

   5105 50 001052   001124 710000 50                 TRA     s:5120

      370     5106    7                               CD$ = PINCRW(SSS$, SS.RSCDN);

   5106 50 001053   000000 470400 44                 LDP0    SS$
        50 001054   000001 220100                    LDX0    1,,PR0
        50 001055   000000 636010                    EAQ     0,X0
        50 001056   000000 036000 30                 ADLQ    SSS$
        50 001057   000000 756000 45                 STQ     CD$

      371     5107    8                               DO WHILE(CD$ ~= SSS$ AND CONNECT_OK);
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:60   

   5107 50 001060   001113 710000 50                 TRA     s:5118

      372     5108    8                                   IF CD.CDRH ~= 0

   5108 50 001061   000000 470400 45                 LDP0    CD$
        50 001062   000002 720100                    LXL0    2,,PR0
        50 001063   001071 600000 50                 TZE     s:5113

      373     5109    9                                   THEN DO;

      374     5110    9                                       FR$ = PINCRW(SSS$, CD.CDRN);

   5110 50 001064   000003 721100                    LXL1    3,,PR0
        50 001065   000000 636011                    EAQ     0,X1
        50 001066   000000 036000 30                 ADLQ    SSS$
        50 001067   000000 756000 33                 STQ     FR$

      375     5111    9                                       END;

   5111 50 001070   001075 710000 50                 TRA     s:5115

      376     5112    9                                   ELSE DO;

      377     5113    9                                       FR$ = PINCRW(SSS$, CD.CDSN);

   5113 50 001071   000003 221100                    LDX1    3,,PR0
        50 001072   000000 636011                    EAQ     0,X1
        50 001073   000000 036000 30                 ADLQ    SSS$
        50 001074   000000 756000 33                 STQ     FR$

      378     5114    9                                       END;

      379     5115    8                                   IF FR.DEF.FSR AND ~FR.DEF.SYN

   5115 50 001075   000000 471400 33                 LDP1    FR$
        50 001076   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:61   
        50 001077   000100 316007                    CANQ    64,DL
        50 001100   001107 600000 50                 TZE     s:5117
        50 001101   100000 236100                    LDQ     0,,PR1
        50 001102   000030 736000                    QLS     24
        50 001103   400000 376003                    ANQ     -131072,DU
        50 001104   400000 676003                    ERQ     -131072,DU
        50 001105   001107 600000 50                 TZE     s:5117

      380     5116    8                                   THEN CONNECT_OK = '0'B;

   5116 50 001106   000010 450000 1                  STZ     CONNECT_OK

      381     5117    8                                   CD$ = PINCRW(SSS$, CD.RSCDN);

   5117 50 001107   000001 221100                    LDX1    1,,PR0
        50 001110   000000 636011                    EAQ     0,X1
        50 001111   000000 036000 30                 ADLQ    SSS$
        50 001112   000000 756000 45                 STQ     CD$

      382     5118    8                                   END;

   5118 50 001113   000000 116000 30                 CMPQ    SSS$
        50 001114   001117 600000 50                 TZE     s:5119
        50 001115   000010 234000 1                  SZN     CONNECT_OK
        50 001116   001061 604000 50                 TMI     s:5108

      383     5119    7                               SS$ = PINCRW(SSS$, SS.RSSSN);

   5119 50 001117   000000 470400 44                 LDP0    SS$
        50 001120   000001 720100                    LXL0    1,,PR0
        50 001121   000000 636010                    EAQ     0,X0
        50 001122   000000 036000 30                 ADLQ    SSS$
        50 001123   000000 756000 44                 STQ     SS$

      384     5120    7                               END;

   5120 50 001124   000000 116000 30                 CMPQ    SSS$
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:62   
        50 001125   001130 600000 50                 TZE     s:5122
        50 001126   000010 234000 1                  SZN     CONNECT_OK
        50 001127   001053 604000 50                 TMI     s:5106

      385     5121    6                           END;

      386     5122    5                       IF (RS.DEF.MSM OR RS.DEF.OSM) AND CONNECT_OK

   5122 50 001130   000000 470400 42                 LDP0    RS$
        50 001131   000000 236100                    LDQ     0,,PR0
        50 001132   040000 316007                    CANQ    16384,DL
        50 001133   001136 601000 50                 TNZ     s:5122+6
        50 001134   100000 316007                    CANQ    32768,DL
        50 001135   001144 600000 50                 TZE     s:5138
        50 001136   000010 234000 1                  SZN     CONNECT_OK
        50 001137   001144 605000 50                 TPL     s:5138

      387     5123    6                       THEN DO;

      388     5124    6                           CALL INFO_ONLY_INT(%ZIG_PER_CONNECT_SET);

   5124 50 001140   000025 236000 51                 LDQ     21
        50 001141   200005 756100                    STQ     5,,AUTO
        50 001142   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001143   000000 011000                    NOP     0

      389     5125        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_COBOL-C
      390     5126        MESSAGE: CONNECT %U2 TO %U1
      391     5127        */
      392     5128        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_FORT-C
      393     5129        MESSAGE: CALL CONNECT([%U2,]  %U1)
      394     5130        */
      395     5131        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_APL-C
      396     5132        MESSAGE: []DBCONNECT '[%U2] [TO] %U1'
      397     5133        */
      398     5134        /*       ERROR:    ZIG-ZIG_PER_CONNECT_SET_BASIC-C
      399     5135        MESSAGE: [line no] DB CONNECT [%U2] [TO] %U1
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:63   
      400     5136        */
      401     5137    6                           END;

      402     5138    5                       IF RS.DEF.OSM

   5138 50 001144   000000 470400 42                 LDP0    RS$
        50 001145   000000 236100                    LDQ     0,,PR0
        50 001146   100000 316007                    CANQ    32768,DL
        50 001147   001154 600000 50                 TZE     s:5155

      403     5139    6                       THEN DO;

      404     5140    6                           CALL INFO_ONLY_INT(%ZIG_PER_DISCONNECT_SET);

   5140 50 001150   000027 236000 51                 LDQ     23
        50 001151   200005 756100                    STQ     5,,AUTO
        50 001152   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001153   000000 011000                    NOP     0

      405     5141        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_COBOL-C
      406     5142        MESSAGE: DISCONNECT %U2 FROM %U1
      407     5143        */
      408     5144        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_FORT-C
      409     5145        MESSAGE: CALL DISCONNECT(%U2 ,%U1)
      410     5146        */
      411     5147        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_APL-C
      412     5148        MESSAGE: []DBDISCONNECT '%U2 FROM %U1'
      413     5149        */
      414     5150        /*       ERROR:    ZIG-ZIG_PER_DISCONNECT_SET_BASIC-C
      415     5151        MESSAGE: [line no] DB DISCONNECT %U2 [FROM] %U1
      416     5152        */
      417     5153    6                           END;

      418     5154    5                       END;

      419     5155    4                   RS$ = PINCRW(SSS$, RS.RSSSN);

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:64   
   5155 50 001154   000000 470400 42                 LDP0    RS$
        50 001155   000001 720100                    LXL0    1,,PR0
        50 001156   000000 636010                    EAQ     0,X0
        50 001157   000000 036000 30                 ADLQ    SSS$
        50 001160   000000 756000 42                 STQ     RS$

      420     5156    4                   END;

   5156 50 001161   000000 116000 30                 CMPQ    SSS$
        50 001162   000742 601000 50                 TNZ     s:5080

      421     5157    3               IF ~RC.DEF.RERS

   5157 50 001163   000000 470400 37                 LDP0    RC$
        50 001164   000000 236100                    LDQ     0,,PR0
        50 001165   000022 736000                    QLS     18
        50 001166   400000 376003                    ANQ     -131072,DU
        50 001167   400000 676003                    ERQ     -131072,DU
        50 001170   001207 600000 50                 TZE     s:5191

      422     5158    4               THEN DO;

      423     5159    4                   IF ~RC.DEF.RERA

   5159 50 001171   000000 236100                    LDQ     0,,PR0
        50 001172   000030 736000                    QLS     24
        50 001173   400000 376003                    ANQ     -131072,DU
        50 001174   400000 676003                    ERQ     -131072,DU
        50 001175   001203 600000 50                 TZE     s:5176

      424     5160    5                   THEN DO;

      425     5161    5                       CALL INFO_ONLY_INT(%ZIG_PER_ERASE_ALL);

   5161 50 001176   000033 236000 51                 LDQ     27
        50 001177   200005 756100                    STQ     5,,AUTO
        50 001200   000003 701000 50                 TSX1    INFO_ONLY_INT
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:65   
        50 001201   000000 011000                    NOP     0

      426     5162        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_COBOL-C
      427     5163        MESSAGE: ERASE %U1 [ALL [MEMBER]]
      428     5164        */
      429     5165        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_FORT-C
      430     5166        MESSAGE: CALL ERASE (%U1 [,ALL])
      431     5167        */
      432     5168        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_APL-C
      433     5169        MESSAGE: []DBERASE '%U1 [ALL [MEMBER]]'
      434     5170        */
      435     5171        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_ALL_BASIC-C
      436     5172        MESSAGE: [line no] DB ERASE %U1 ALL [MEMBERS
      437     5173        */
      438     5174    5                       END;

   5174 50 001202   001207 710000 50                 TRA     s:5191

      439     5175    5                   ELSE DO;

      440     5176    5                       CALL INFO_ONLY_INT(%ZIG_PER_ERASE);

   5176 50 001203   000035 236000 51                 LDQ     29
        50 001204   200005 756100                    STQ     5,,AUTO
        50 001205   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001206   000000 011000                    NOP     0

      441     5177        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_COBOL-C
      442     5178        MESSAGE: ERASE %U1
      443     5179        */
      444     5180        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_FORT-C
      445     5181        MESSAGE: CALL ERASE (%U1)
      446     5182        */
      447     5183        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_APL-C
      448     5184        MESSAGE: []DBERASE '%U1'
      449     5185        */
      450     5186        /*E*     ERROR:    ZIG-ZIG_PER_ERASE_BASIC-C
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:66   
      451     5187        MESSAGE: [line no] DB ERASE %U1
      452     5188        */
      453     5189    5                       END;

      454     5190    4                   END;

      455     5191    3               RS$ = PINCRW(SSS$, RC.RCRSN);

   5191 50 001207   000000 470400 37                 LDP0    RC$
        50 001210   000002 720100                    LXL0    2,,PR0
        50 001211   000000 636010                    EAQ     0,X0
        50 001212   000000 036000 30                 ADLQ    SSS$
        50 001213   000000 756000 42                 STQ     RS$

      456     5192    4               DO WHILE (SSS$ ~= RS$);

   5192 50 001214   000000 116000 30                 CMPQ    SSS$
        50 001215   001350 600000 50                 TZE     s:5271

      457     5193    4                   SC$ = PINCRW(SSS$, RS.SCRSH);

   5193 50 001216   000000 470400 42                 LDP0    RS$
        50 001217   000003 720100                    LXL0    3,,PR0
        50 001220   000000 636010                    EAQ     0,X0
        50 001221   000000 036000 30                 ADLQ    SSS$
        50 001222   000000 756000 35                 STQ     SC$

      458     5194    4                   TEMP_WORD = SC.SNAM;

   5194 50 001223   000000 471400 35                 LDP1    SC$
        50 001224   100000 721100                    LXL1    0,,PR1
        50 001225   000077 361003                    ANX1    63,DU
        50 001226   040000 100540                    MLR     fill='040'O
        50 001227   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        50 001230   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      459     5195    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:67   

   5195 50 001231   000013 630400 51                 EPPR0   11
        50 001232   000004 631400 51                 EPPR1   4
        50 001233   000000 701000 xent               TSX1    SET_FIELDS
        50 001234   000000 011000                    NOP     0

      460     5196    4                   IF SC.DEF.SETT = 1

   5196 50 001235   000000 470400 35                 LDP0    SC$
        50 001236   000000 236100                    LDQ     0,,PR0
        50 001237   000700 376007                    ANQ     448,DL
        50 001240   000100 116007                    CMPQ    64,DL
        50 001241   001312 601000 50                 TNZ     s:5231

      461     5197    5                   THEN DO;

      462     5198    5                       CALC_OK = '1'B;

   5198 50 001242   400000 236003                    LDQ     -131072,DU
        50 001243   000012 756000 1                  STQ     CALC_OK

      463     5199    5                       CD$ = PINCRW(SSS$, RS.RSCDN);

   5199 50 001244   000000 471400 42                 LDP1    RS$
        50 001245   100001 220100                    LDX0    1,,PR1
        50 001246   000000 636010                    EAQ     0,X0
        50 001247   000000 036000 30                 ADLQ    SSS$
        50 001250   000000 756000 45                 STQ     CD$

      464     5200    6                       DO WHILE (SSS$ ~= CD$ AND CALC_OK);

   5200 50 001251   001300 710000 50                 TRA     s:5213

      465     5201    6                           IF CD.CDSH ~= 0

   5201 50 001252   000000 470400 45                 LDP0    CD$
        50 001253   000002 220100                    LDX0    2,,PR0
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:68   
        50 001254   001261 600000 50                 TZE     s:5206

      466     5202    7                           THEN DO;

      467     5203    7                               FR$ = PINCRW(SSS$, CD.CDSH);

   5203 50 001255   000000 636010                    EAQ     0,X0
        50 001256   000000 036000 30                 ADLQ    SSS$
        50 001257   000000 756000 33                 STQ     FR$

      468     5204    7                               END;

   5204 50 001260   001265 710000 50                 TRA     s:5208

      469     5205    7                           ELSE DO;

      470     5206    7                               FR$ = PINCRW(SSS$, CD.CDRH);

   5206 50 001261   000002 721100                    LXL1    2,,PR0
        50 001262   000000 636011                    EAQ     0,X1
        50 001263   000000 036000 30                 ADLQ    SSS$
        50 001264   000000 756000 33                 STQ     FR$

      471     5207    7                               END;

      472     5208    6                           IF FR.DEF.FSR AND NOT FR.DEF.SYN

   5208 50 001265   000000 471400 33                 LDP1    FR$
        50 001266   100000 236100                    LDQ     0,,PR1
        50 001267   000100 316007                    CANQ    64,DL
        50 001270   001274 600000 50                 TZE     s:5212
        50 001271   004000 316007                    CANQ    2048,DL
        50 001272   001274 601000 50                 TNZ     s:5212

      473     5209    7                           THEN DO;

      474     5210    7                               CALC_OK = '0'B;
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:69   

   5210 50 001273   000012 450000 1                  STZ     CALC_OK

      475     5211    7                               END;

      476     5212    6                           CD$ = PINCRW(SSS$, CD.RSCDN);

   5212 50 001274   000001 221100                    LDX1    1,,PR0
        50 001275   000000 636011                    EAQ     0,X1
        50 001276   000000 036000 30                 ADLQ    SSS$
        50 001277   000000 756000 45                 STQ     CD$

      477     5213    6                           END;

   5213 50 001300   000000 116000 30                 CMPQ    SSS$
        50 001301   001304 600000 50                 TZE     s:5214
        50 001302   000012 234000 1                  SZN     CALC_OK
        50 001303   001252 604000 50                 TMI     s:5201

      478     5214    5                       IF CALC_OK

   5214 50 001304   000012 234000 1                  SZN     CALC_OK
        50 001305   001312 605000 50                 TPL     s:5231

      479     5215    6                       THEN DO;

      480     5216    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_CALC);

   5216 50 001306   000037 236000 51                 LDQ     31
        50 001307   200005 756100                    STQ     5,,AUTO
        50 001310   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001311   000000 011000                    NOP     0

      481     5217        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_COBOL-C
      482     5218        MESSAGE: FIND ANY %U1
      483     5219        */
      484     5220        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_APL-C
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:70   
      485     5221        MESSAGE: []DBFIND 'ANY %U1'
      486     5222        */
      487     5223        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_BASIC-C
      488     5224        MESSAGE: [line no] DB FIND ANY %U1
      489     5225        */
      490     5226        /*E*     ERROR:    ZIG-ZIG_PER_FIND_CALC_FORT-C
      491     5227        MESSAGE: CALL FIND (ANY ,%U1)
      492     5228        */
      493     5229    6                           END;

      494     5230    5                       END;

      495     5231    4                   IF SC.DEF.SETT = 0 AND ~SC.DEF.SNSS

   5231 50 001312   000000 470400 35                 LDP0    SC$
        50 001313   000000 236100                    LDQ     0,,PR0
        50 001314   000700 316007                    CANQ    448,DL
        50 001315   001341 601000 50                 TNZ     s:5269
        50 001316   000000 236100                    LDQ     0,,PR0
        50 001317   000026 736000                    QLS     22
        50 001320   400000 376003                    ANQ     -131072,DU
        50 001321   400000 676003                    ERQ     -131072,DU
        50 001322   001341 600000 50                 TZE     s:5269

      496     5232    5                   THEN DO;

      497     5233    5                       IF RS.DEF.TYPE = '0040'O

   5233 50 001323   000000 471400 42                 LDP1    RS$
        50 001324   100000 236100                    LDQ     0,,PR1
        50 001325   777700 376003                    ANQ     -64,DU
        50 001326   004000 116003                    CMPQ    2048,DU
        50 001327   001335 601000 50                 TNZ     s:5254

      498     5234    6                       THEN DO;

      499     5235    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_SET_REC);
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:71   

   5235 50 001330   000041 236000 51                 LDQ     33
        50 001331   200005 756100                    STQ     5,,AUTO
        50 001332   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001333   000000 011000                    NOP     0

      500     5236        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_COBOL-C
      501     5237        MESSAGE: FIND NEXT|PRIOR|FIRST|LAST|integer-1 %U1 WITHIN %U2
      502     5238                 FIND CURRENT %U1 WITHIN %U2
      503     5239        */
      504     5240        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_FORT-C
      505     5241        MESSAGE: CALL FIND (NEXT|PRIOR|FIRST|LAST|integer-1, %U1 ,%U2)
      506     5242                 CALL FIND (CURRENT, %U1, %U2)
      507     5243        */
      508     5244        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_APL-C
      509     5245        MESSAGE: []DBFIND 'NEXT|PRIOR|FIRST|LAST|integer-1 %U1 WITHIN %U2'
      510     5246                 []DBFIND 'CURRENT %U1 WITHIN %U2'
      511     5247        */
      512     5248        /*E*     ERROR:    ZIG-ZIG_PER_FIND_SET_REC_BASIC-C
      513     5249        MESSAGE: [line no] DB FIND NEXT/PRIOR/FIRST/LAST/integer-1 %U1 [WITHIN] %U2
      514     5250                 [line no] DB FIND CURRENT %U1 [WITHIN] %U2
      515     5251        */
      516     5252    6                           END;

   5252 50 001334   001341 710000 50                 TRA     s:5269

      517     5253    6                       ELSE DO;

      518     5254    6                           CALL INFO_ONLY_INT(%ZIG_PER_FIND_OWN_REC);

   5254 50 001335   000043 236000 51                 LDQ     35
        50 001336   200005 756100                    STQ     5,,AUTO
        50 001337   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001340   000000 011000                    NOP     0

      519     5255        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_COBOL-C
      520     5256        MESSAGE: FIND OWNER WITHIN %U2
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:72   
      521     5257        */
      522     5258        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_FORT-C
      523     5259        MESSAGE: CALL FIND (OWNER, %U2)
      524     5260        */
      525     5261        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_APL-C
      526     5262        MESSAGE: []DBFIND 'OWNER WITHIN %U2'
      527     5263        */
      528     5264        /*E*     ERROR:    ZIG-ZIG_PER_FIND_OWN_REC_BASIC-C
      529     5265        MESSAGE: [line no] DB FIND OWNER [WITHIN] %U2
      530     5266        */
      531     5267    6                           END;

      532     5268    5                       END;

      533     5269    4                   RS$ = PINCRW(SSS$, RS.RCRSN);

   5269 50 001341   000000 470400 42                 LDP0    RS$
        50 001342   000002 720100                    LXL0    2,,PR0
        50 001343   000000 636010                    EAQ     0,X0
        50 001344   000000 036000 30                 ADLQ    SSS$
        50 001345   000000 756000 42                 STQ     RS$

      534     5270    4                   END;

   5270 50 001346   000000 116000 30                 CMPQ    SSS$
        50 001347   001216 601000 50                 TNZ     s:5193

      535     5271    3               MODIFY_OK = '1'B;

   5271 50 001350   400000 236003                    LDQ     -131072,DU
        50 001351   000011 756000 1                  STQ     MODIFY_OK

      536     5272    3               FIELDS='0'B;

   5272 50 001352   000015 450000 1                  STZ     FIELDS

      537     5273    3               FR$ = PINCRW(SSS$, RC.RCFRN);
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:73   

   5273 50 001353   000000 470400 37                 LDP0    RC$
        50 001354   000004 720100                    LXL0    4,,PR0
        50 001355   000000 636010                    EAQ     0,X0
        50 001356   000000 036000 30                 ADLQ    SSS$
        50 001357   000000 756000 33                 STQ     FR$

      538     5274    4               DO WHILE (FR$ ~= SSS$ AND ~FIELDS);

   5274 50 001360   001402 710000 50                 TRA     s:5280

      539     5275    4                   IF ~FR.DEF.FSR AND ~FR.DEF.SYN

   5275 50 001361   000000 470400 33                 LDP0    FR$
        50 001362   000000 236100                    LDQ     0,,PR0
        50 001363   000035 736000                    QLS     29
        50 001364   400000 376003                    ANQ     -131072,DU
        50 001365   400000 676003                    ERQ     -131072,DU
        50 001366   001376 600000 50                 TZE     s:5279
        50 001367   000000 236100                    LDQ     0,,PR0
        50 001370   000030 736000                    QLS     24
        50 001371   400000 376003                    ANQ     -131072,DU
        50 001372   400000 676003                    ERQ     -131072,DU
        50 001373   001376 600000 50                 TZE     s:5279

      540     5276    5                   THEN DO;

      541     5277    5                       FIELDS = '1'B;

   5277 50 001374   400000 236003                    LDQ     -131072,DU
        50 001375   000015 756000 1                  STQ     FIELDS

      542     5278    5                       END;

      543     5279    4                   FR$ = PINCRW(SSS$, FR.RCFRN);

   5279 50 001376   000004 720100                    LXL0    4,,PR0
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:74   
        50 001377   000000 636010                    EAQ     0,X0
        50 001400   000000 036000 30                 ADLQ    SSS$
        50 001401   000000 756000 33                 STQ     FR$

      544     5280    4                   END;

   5280 50 001402   000000 116000 30                 CMPQ    SSS$
        50 001403   001410 600000 50                 TZE     s:5281
        50 001404   000015 236000 1                  LDQ     FIELDS
        50 001405   400000 376003                    ANQ     -131072,DU
        50 001406   400000 676003                    ERQ     -131072,DU
        50 001407   001361 601000 50                 TNZ     s:5275

      545     5281    3               RS$ = PINCRW(SSS$, RC.RCRSN);

   5281 50 001410   000000 470400 37                 LDP0    RC$
        50 001411   000002 720100                    LXL0    2,,PR0
        50 001412   000000 636010                    EAQ     0,X0
        50 001413   000000 036000 30                 ADLQ    SSS$
        50 001414   000000 756000 42                 STQ     RS$

      546     5282    4               DO WHILE (SSS$ ~= RS$);

   5282 50 001415   000000 116000 30                 CMPQ    SSS$
        50 001416   001455 600000 50                 TZE     s:5297

      547     5283    4                   SC$ = PINCRW(SSS$, RS.SCRSH);

   5283 50 001417   000000 470400 42                 LDP0    RS$
        50 001420   000003 720100                    LXL0    3,,PR0
        50 001421   000000 636010                    EAQ     0,X0
        50 001422   000000 036000 30                 ADLQ    SSS$
        50 001423   000000 756000 35                 STQ     SC$

      548     5284    4                   IF SC.DEF.SNSS AND (SC.DEF.SETO=4 OR SC.DEF.SETO=6)

   5284 50 001424   000000 471400 35                 LDP1    SC$
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:75   
        50 001425   100000 236100                    LDQ     0,,PR1
        50 001426   020000 316007                    CANQ    8192,DL
        50 001427   001447 600000 50                 TZE     s:5294
        50 001430   100000 236100                    LDQ     0,,PR1
        50 001431   740000 376007                    ANQ     -16384,DL
        50 001432   200000 116007                    CMPQ    65536,DL
        50 001433   001436 600000 50                 TZE     s:5284+10
        50 001434   300000 116007                    CMPQ    98304,DL
        50 001435   001447 601000 50                 TNZ     s:5294
        50 001436   100000 236100                    LDQ     0,,PR1
        50 001437   000700 316007                    CANQ    448,DL
        50 001440   001447 601000 50                 TNZ     s:5294
        50 001441   000000 236100                    LDQ     0,,PR0
        50 001442   777700 376003                    ANQ     -64,DU
        50 001443   004000 116003                    CMPQ    2048,DU
        50 001444   001447 601000 50                 TNZ     s:5294

      549     5285    4                      AND SC.DEF.SETT=0 AND RS.DEF.TYPE = '0040'O
      550     5286    5                   THEN DO;

      551     5287    5                       MODIFY_OK = '0'B;

   5287 50 001445   000011 450000 1                  STZ     MODIFY_OK

      552     5288    5                       GOTO NO_MODIFY;

   5288 50 001446   001565 710000 50                 TRA     NO_MODIFY

      553     5289        /*
      554     5290              This record is a member of a set the is sorted and that set is
      555     5291            not in the subschema.
      556     5292        */
      557     5293    5                       END;
      558     5294    4                   RS$ = PINCRW(SSS$, RS.RCRSN);

   5294 50 001447   000002 721100                    LXL1    2,,PR0
        50 001450   000000 636011                    EAQ     0,X1
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:76   
        50 001451   000000 036000 30                 ADLQ    SSS$
        50 001452   000000 756000 42                 STQ     RS$

      559     5295    4                   END;

   5295 50 001453   000000 116000 30                 CMPQ    SSS$
        50 001454   001417 601000 50                 TNZ     s:5283

      560     5296
      561     5297    3               RS$ = PINCRW(SSS$, RC.RCRSN);

   5297 50 001455   000000 470400 37                 LDP0    RC$
        50 001456   000002 720100                    LXL0    2,,PR0
        50 001457   000000 636010                    EAQ     0,X0
        50 001460   000000 036000 30                 ADLQ    SSS$
        50 001461   000000 756000 42                 STQ     RS$

      562     5298    4               DO WHILE (SSS$ ~= RS$);

   5298 50 001462   000000 116000 30                 CMPQ    SSS$
        50 001463   001545 600000 50                 TZE     s:5338

      563     5299    4                   IF RS.DEF.TYPE = '0040'O

   5299 50 001464   000000 470400 42                 LDP0    RS$
        50 001465   000000 236100                    LDQ     0,,PR0
        50 001466   777700 376003                    ANQ     -64,DU
        50 001467   004000 116003                    CMPQ    2048,DU
        50 001470   001536 601000 50                 TNZ     s:5336

      564     5300    5                   THEN DO;

      565     5301    5                       IF (SC.DEF.SETO=4 OR SC.DEF.SETO=6 OR NOT FIELDS)

   5301 50 001471   000000 471400 35                 LDP1    SC$
        50 001472   100000 236100                    LDQ     0,,PR1
        50 001473   740000 376007                    ANQ     -16384,DL
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:77   
        50 001474   200000 116007                    CMPQ    65536,DL
        50 001475   001502 600000 50                 TZE     s:5301+9
        50 001476   300000 116007                    CMPQ    98304,DL
        50 001477   001502 600000 50                 TZE     s:5301+9
        50 001500   000015 234000 1                  SZN     FIELDS
        50 001501   001536 604000 50                 TMI     s:5336
        50 001502   100000 236100                    LDQ     0,,PR1
        50 001503   000700 316007                    CANQ    448,DL
        50 001504   001536 601000 50                 TNZ     s:5336
        50 001505   020000 316007                    CANQ    8192,DL
        50 001506   001536 601000 50                 TNZ     s:5336
        50 001507   000700 316007                    CANQ    448,DL
        50 001510   001536 601000 50                 TNZ     s:5336

      566     5302    5                          AND (SC.DEF.SETT=0 AND NOT SC.DEF.SNSS)
      567     5303    5                          AND (SC.DEF.SETT = 0)
      568     5304    6                       THEN DO;

      569     5305    6                           TEMP_WORD = SC.SNAM;

   5305 50 001511   100000 720100                    LXL0    0,,PR1
        50 001512   000077 360003                    ANX0    63,DU
        50 001513   040000 100540                    MLR     fill='040'O
        50 001514   100003 000010                    ADSC9   3,,PR1                   cn=0,n=*X0
        50 001515   000000 000036 1                  ADSC9   TEMP_WORD                cn=0,n=30

      570     5306    6                           CALL SET_FIELDS(2,30,TEMP_WORD);

   5306 50 001516   000013 630400 51                 EPPR0   11
        50 001517   000004 631400 51                 EPPR1   4
        50 001520   000000 701000 xent               TSX1    SET_FIELDS
        50 001521   000000 011000                    NOP     0

      571     5307    6                           IF MODIFY_OK

   5307 50 001522   000011 234000 1                  SZN     MODIFY_OK
        50 001523   001532 605000 50                 TPL     s:5329
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:78   

      572     5308    7                           THEN DO;

      573     5309    7                               CALL INFO_ONLY_INT(%ZIG_PER_MODIFY_ALL);

   5309 50 001524   000045 236000 51                 LDQ     37
        50 001525   200005 756100                    STQ     5,,AUTO
        50 001526   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001527   000000 011000                    NOP     0

      574     5310        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_COBOL-C
      575     5311        MESSAGE: MODIFY %U1 ONLY|INCLUDING ALL|set_name MEMBERSHIP
      576     5312                 set_name = %U2
      577     5313        */
      578     5314        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_FORT-C
      579     5315        MESSAGE: CALL MODIFY(%U1, ONLY|INCLUDING, ALL|set_name)
      580     5316                 set_name = %U2
      581     5317        */
      582     5318        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_APL-C
      583     5319        MESSAGE: []DBMODIFY '%U1 ONLY|INCLUDING ALL|set_name MEMBERSHIP'
      584     5320                 set_name = %U2
      585     5321        */
      586     5322        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_ALL_BASIC-C
      587     5323        MESSAGE: [line no] DB MODIFY %U1 ONLY/INCLUDING ALL/set_name [MEMBERSHIP]
      588     5324                 set_name = %U2
      589     5325        */
      590     5326    7                               MODIFY_OK = '0'B;

   5326 50 001530   000011 450000 1                  STZ     MODIFY_OK

      591     5327    7                               END;

   5327 50 001531   001536 710000 50                 TRA     s:5336

      592     5328    7                           ELSE DO;

      593     5329    7                               CALL INFO_ONLY(%ZIG_PER_MODIFY_MORE);
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:79   

   5329 50 001532   000047 630400 51                 EPPR0   39
        50 001533   000000 631400 51                 EPPR1   0
        50 001534   000000 701000 xent               TSX1    INFO_ONLY
        50 001535   000000 011000                    NOP     0

      594     5330        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_MORE-C
      595     5331        MESSAGE: and      , %U2
      596     5332        */
      597     5333    7                               END;

      598     5334    6                           END;

      599     5335    5                       END;

      600     5336    4                   RS$ = PINCRW(SSS$, RS.RCRSN);

   5336 50 001536   000000 470400 42                 LDP0    RS$
        50 001537   000002 720100                    LXL0    2,,PR0
        50 001540   000000 636010                    EAQ     0,X0
        50 001541   000000 036000 30                 ADLQ    SSS$
        50 001542   000000 756000 42                 STQ     RS$

      601     5337    4                   END;

   5337 50 001543   000000 116000 30                 CMPQ    SSS$
        50 001544   001464 601000 50                 TNZ     s:5299

      602     5338    3               IF MODIFY_OK

   5338 50 001545   000011 234000 1                  SZN     MODIFY_OK
        50 001546   001553 605000 50                 TPL     s:5354

      603     5339    4               THEN DO;

      604     5340    4                   CALL INFO_ONLY_INT(%ZIG_PER_MODIFY);

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:80   
   5340 50 001547   000051 236000 51                 LDQ     41
        50 001550   200005 756100                    STQ     5,,AUTO
        50 001551   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001552   000000 011000                    NOP     0

      605     5341        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_COBOL-C
      606     5342        MESSAGE: MODIFY %U1
      607     5343        */
      608     5344        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_FORT-C
      609     5345        MESSAGE: CALL MODIFY (%U1)
      610     5346        */
      611     5347        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_APL-C
      612     5348        MESSAGE: []DBMODIFY '%U1'
      613     5349        */
      614     5350        /*E*     ERROR:    ZIG-ZIG_PER_MODIFY_BASIC-C
      615     5351        MESSAGE: [line no] DB MODIFY %U1
      616     5352        */
      617     5353    4                   END;

      618     5354    3               IF ~RC.DEF.RSTO

   5354 50 001553   000000 470400 37                 LDP0    RC$
        50 001554   000000 236100                    LDQ     0,,PR0
        50 001555   000023 736000                    QLS     19
        50 001556   400000 376003                    ANQ     -131072,DU
        50 001557   400000 676003                    ERQ     -131072,DU
        50 001560   001565 600000 50                 TZE     NO_MODIFY

      619     5355    4               THEN DO;

      620     5356    4                   CALL INFO_ONLY_INT(%ZIG_PRO_RC_NOSTORE);

   5356 50 001561   000053 236000 51                 LDQ     43
        50 001562   200005 756100                    STQ     5,,AUTO
        50 001563   000003 701000 50                 TSX1    INFO_ONLY_INT
        50 001564   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:81   
      621     5357    4                   END;

      622     5358    3   NO_MODIFY:
      623     5359    3               END;

   5359 50 001565                       NO_MODIFY    null
      624     5360    2           RC$ = PINCRW(SSS$, RC.OARCN);

   5360 50 001565   000000 470400 37                 LDP0    RC$
        50 001566   000002 220100                    LDX0    2,,PR0
        50 001567   000000 636010                    EAQ     0,X0
        50 001570   000000 036000 30                 ADLQ    SSS$
        50 001571   000000 756000 37                 STQ     RC$

      625     5361    2           END;

   5361 50 001572   000000 116000 30                 CMPQ    SSS$
        50 001573   000650 601000 50                 TNZ     s:5069

      626     5362    1       RETURN;

   5362 50 001574   000000 702200 xent               TSX2  ! X66_ARET

HEAD_PERMIT
 Sect OctLoc
   0     000   123125 102123   103110 105115   101040 120105   122115 111124    SUBSCHEMA PERMIT
   0     004   124105 104040   114111 123124   056040 040040   040040 040040    TED LIST.
   0     010   040040 040040   040040 040040   040040 040040   040040 040040
   0     014   040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   0     020   074074 074074   074120 105122   115111 124124   105104 040114    <<<<<PERMITTED L
   0     024   111123 124040   106117 122040   101122 105101   040040 040040    IST FOR AREA
   0     030   040076 076076   076076 040040   074074 074074   074120 105122     >>>>>  <<<<<PER
   0     034   115111 124124   105104 040114   111123 124040   106117 122040    MITTED LIST FOR
   0     040   123105 124040   074074 074074   074120 105122   115111 124124    SET <<<<<PERMITT
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:82   
   0     044   105104 040114   111123 124040   106117 122040   122105 103117    ED LIST FOR RECO
   0     050   122104 040040                                                    RD

TEMP_WORD
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

EOFC
 Sect OctLoc
   2     000   057052 057052   057052 057052   057052 057052   057052 057052    /*/*/*/*/*/*/*/*
   2     004   057052 040040   040040 040040   040040 040040   040040 040040    /*
   2     010   040040 040040   040040 040040   040040 040040   040040 040040
   2     034*  040040 040040   040040 040040

LIST_STRING
 Sect OctLoc
   3     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  11     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  13     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  14     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  16     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  16     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  16     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  16     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:83   
SEM_COM
 Sect OctLoc
  17     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  17     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  17     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  17     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  17     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  17     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  17     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  17     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  18     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  18     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  18     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  18     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  18     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  18     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  18     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  18     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  19     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  19     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  19     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  19     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  19     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  19     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  19     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  19     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

TYPE_9
 Sect OctLoc
  20     000   000000 000160   000000 000000   000000 000000   000000 000011    ...p............
  20     004   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:84   
  20     020*  000000 000000   200000 000000   000000 000000   000000 000000    ................
  20     024   000000 000000   000000 000000   000000 000000   000000 000000    ................
  20     030   040040 040040   040040 040040   040040 040040   040040 040040
  20     034   040040 040040   040040 040040   040040 040040   040040 040040

LANG_ALLOWED
 Sect OctLoc
  21     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  23     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  24     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  24     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
  24     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
  24     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  25     000   0***** ******                                                    ....

IO_BUF
 Sect OctLoc
  27     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

CONTROL
 Sect OctLoc
  28     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  28     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  28     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  28     020*  040040 040040   040040 040040   040040 040040   040040 040040
  28     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  28     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  28     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:85   
  28     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  28     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  28     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  28     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

TYPE_36
 Sect OctLoc
  29     000   000000 000044   000000 000000   000000 000000   000000 000044    ...$...........$
  29     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  29     010   040040 040040   040040 040040   040040 040040   040040 040040
  29     034*  040040 040040   000000 000000   000000 000000   000000 000000        ............

(unnamed)
 Sect OctLoc
  51     000   000001 000000   000000 006000   040040 040040   000000 006000    ........    ....
  51     004   000003 000000   000000 000001   000000 000036   000005 006000    ................
  51     010   000006 006000   000000 006000   000000 000002   000012 006000    ................
  51     014   000006 006000   000000 006000   000000 022271   000016 006000    ................
  51     020   000000 022270   000020 006000   000000 022275   000022 006000    ................
  51     024   000000 022301   000024 006000   000000 022305   000026 006000    ................
  51     030   000000 022311   000030 006000   000000 022315   000032 006000    ................
  51     034   000000 022321   000034 006000   000000 022325   000036 006000    ................
  51     040   000000 022331   000040 006000   000000 022335   000042 006000    ..... ......."..
  51     044   000000 022341   000044 006000   000000 022345   000046 006000    .....$.......&..
  51     050   000000 022346   000050 006000   000000 022504   000052 006000    .....(.......*..
      627     5363    1   END ZIG$V_PERMIT;

PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:86   
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_PERMIT.

   Procedure ZIG$V_PERMIT requires 893 words for executable code.
   Procedure ZIG$V_PERMIT requires 8 words of local(AUTO) storage.

    No errors detected in file ZIG$V_PERMIT.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:87   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:88   
          MINI XREF LISTING

AC.ACRAN
      4339**DCL      4851>>ASSIGN
AC.ANAM
      4408**DCL      4844>>ASSIGN   4848>>CALLBLT
AC.DEF.ANL
      4337**DCL      4408--IMP-SIZ  4844>>ASSIGN   4848>>CALLBLT
AC.DEF.FORG
      4324**DCL      4328--REDEF
AC.OAACN
      4338**DCL      4900>>ASSIGN
AC$
      4320**DCL      4321--IMP-PTR  4841<<ASSIGN   4842>>DOWHILE  4844>>ASSIGN   4844>>ASSIGN   4848>>CALLBLT
      4848>>CALLBLT  4851>>ASSIGN   4900<<ASSIGN   4900>>ASSIGN
AC1$
      4414**DCL      4415--IMP-PTR
AG$
      4788**DCL      4789--IMP-PTR
AG1$
      4818**DCL      4819--IMP-PTR
CALC_OK
        37**DCL      5198<<ASSIGN   5200>>DOWHILE  5210<<ASSIGN   5214>>IF
CD.CDRH
      4760**DCL      4950>>IF       4952>>ASSIGN   4965>>IF       5093>>IF       5095>>ASSIGN   5108>>IF
      5206>>ASSIGN
CD.CDRN
      4762**DCL      4967>>ASSIGN   5110>>ASSIGN
CD.CDSH
      4759**DCL      4955>>ASSIGN   5098>>ASSIGN   5201>>IF       5203>>ASSIGN
CD.CDSN
      4761**DCL      4970>>ASSIGN   5113>>ASSIGN
CD.RSCDN
      4757**DCL      4959>>ASSIGN   4974>>ASSIGN   5102>>ASSIGN   5117>>ASSIGN   5212>>ASSIGN
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:89   
CD$
      4747**DCL      4748--IMP-PTR  4948<<ASSIGN   4949>>DOWHILE  4950>>IF       4952>>ASSIGN   4955>>ASSIGN
      4959<<ASSIGN   4959>>ASSIGN   4963<<ASSIGN   4964>>DOWHILE  4965>>IF       4967>>ASSIGN   4970>>ASSIGN
      4974<<ASSIGN   4974>>ASSIGN   5091<<ASSIGN   5092>>DOWHILE  5093>>IF       5095>>ASSIGN   5098>>ASSIGN
      5102<<ASSIGN   5102>>ASSIGN   5106<<ASSIGN   5107>>DOWHILE  5108>>IF       5110>>ASSIGN   5113>>ASSIGN
      5117<<ASSIGN   5117>>ASSIGN   5199<<ASSIGN   5200>>DOWHILE  5201>>IF       5203>>ASSIGN   5206>>ASSIGN
      5212<<ASSIGN   5212>>ASSIGN
CONNECT_OK
        35**DCL      4947<<ASSIGN   4949>>DOWHILE  4958<<ASSIGN   4962>>DOWHILE  4964>>DOWHILE  4973<<ASSIGN
      4979>>IF       5090<<ASSIGN   5092>>DOWHILE  5101<<ASSIGN   5105>>DOWHILE  5107>>DOWHILE  5116<<ASSIGN
      5122>>IF
DP$
      4766**DCL      4767--IMP-PTR
DP1$
      4780**DCL      4781--IMP-PTR
ERROR_NUM IN PROCEDURE INFO_ONLY_INT
      4827**DCL      4826--PROC     4828>>CALL
FIELDS
        40**DCL      5272<<ASSIGN   5274>>DOWHILE  5277<<ASSIGN   5301>>IF
FR.DEF.FSR
      4435**DCL      4957>>IF       4972>>IF       5100>>IF       5115>>IF       5208>>IF       5275>>IF
FR.DEF.SYN
      4432**DCL      4957>>IF       4972>>IF       5100>>IF       5115>>IF       5208>>IF       5275>>IF
FR.FNL
      4459**DCL      4463--IMP-SIZ
FR.RCFRN
      4460**DCL      5279>>ASSIGN
FR.UOFST.EIS.OFFSET
      4449**DCL      4452--REDEF
FR$
      4423**DCL      4424--IMP-PTR  4952<<ASSIGN   4955<<ASSIGN   4957>>IF       4957>>IF       4967<<ASSIGN
      4970<<ASSIGN   4972>>IF       4972>>IF       5095<<ASSIGN   5098<<ASSIGN   5100>>IF       5100>>IF
      5110<<ASSIGN   5113<<ASSIGN   5115>>IF       5115>>IF       5203<<ASSIGN   5206<<ASSIGN   5208>>IF
      5208>>IF       5273<<ASSIGN   5274>>DOWHILE  5275>>IF       5275>>IF       5279<<ASSIGN   5279>>ASSIGN
FR1$
      4468**DCL      4469--IMP-PTR
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:90   
HEAD_PERMIT
        29**DCL      4840<>CALL
INFO_ONLY
       577**DCL-ENT  4828--CALL     4892--CALL     5052--CALL     5329--CALL
INFO_ONLY_INT
      4826**PROC     4861--CALL     4924--CALL     4981--CALL     4997--CALL     5025--CALL     5124--CALL
      5140--CALL     5161--CALL     5176--CALL     5216--CALL     5235--CALL     5254--CALL     5309--CALL
      5340--CALL     5356--CALL
IO_BUF
      2734**DCL      2760--REDEF    2875--REDEF    2978--REDEF    3027--REDEF    3086--REDEF    3135--REDEF
      3187--REDEF    3255--REDEF    3294--REDEF    3357--REDEF    3406--REDEF    3473--REDEF
LIST
       590**DCL-ENT  4846--CALL     4847--CALL     4849--CALL     4909--CALL     4910--CALL     4912--CALL
      5073--CALL     5074--CALL     5076--CALL
LIST_STRING
        33**DCL      4845<<ASSIGN   4846<>CALL     4847<>CALL     4848<<CALLBLT  4849<>CALL     4908<<ASSIGN
      4909<>CALL     4910<>CALL     4911<<CALLBLT  4912<>CALL     5072<<ASSIGN   5073<>CALL     5074<>CALL
      5075<<CALLBLT  5076<>CALL
MODIFY_OK
        36**DCL      5271<<ASSIGN   5287<<ASSIGN   5307>>IF       5326<<ASSIGN   5338>>IF
NO_MODIFY
      5359**LABEL    5288--GOTO
NUM_RECORDS
        38**DCL      4843<<ASSIGN   4856<<ASSIGN   4856>>ASSIGN   4859>>IF
NUM_REC_IN_SET
        39**DCL      4906<<ASSIGN   5022<<ASSIGN   5022>>ASSIGN   5023>>IF
OA.OAACN
      4565**DCL      4841>>ASSIGN
OA.OARCN
      4567**DCL      5067>>ASSIGN
OA.OASCN
      4566**DCL      4902>>ASSIGN
OA.SCNAM.EIS.COUNT
      4579**DCL      4616--IMP-SIZ
OA$
      4557**DCL      4558--IMP-PTR  4841>>ASSIGN   4902>>ASSIGN   5067>>ASSIGN
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:91   
OA1$
      4623**DCL      4624--IMP-PTR
RA.ACRAN
      4640**DCL      4898>>ASSIGN
RA.RCRAH
      4641**DCL      4853>>ASSIGN
RA$
      4631**DCL      4632--IMP-PTR  4851<<ASSIGN   4852>>DOWHILE  4853>>ASSIGN   4898<<ASSIGN   4898>>ASSIGN
RC.DEF.RERA
      4526**DCL      5159>>IF
RC.DEF.RERS
      4520**DCL      5157>>IF
RC.DEF.RNL
      4531**DCL      4541--IMP-SIZ  4857>>ASSIGN   4917>>ASSIGN   5018>>ASSIGN   5071>>ASSIGN   5075>>CALLBLT
RC.DEF.RSTO
      4521**DCL      5354>>IF
RC.DEF.SR
      4522**DCL      4854>>IF       4922>>IF       4941>>IF       5020>>IF       5069>>IF
RC.OARCN
      4534**DCL      5360>>ASSIGN
RC.RCFRN
      4540**DCL      5273>>ASSIGN
RC.RCRSN
      4535**DCL      5078>>ASSIGN   5191>>ASSIGN   5281>>ASSIGN   5297>>ASSIGN
RC.RNAM
      4541**DCL      4857>>ASSIGN   4917>>ASSIGN   5018>>ASSIGN   5071>>ASSIGN   5075>>CALLBLT
RC$
      4514**DCL      4515--IMP-PTR  4853<<ASSIGN   4854>>IF       4857>>ASSIGN   4857>>ASSIGN   4916<<ASSIGN
      4917>>ASSIGN   4917>>ASSIGN   4922>>IF       4941>>IF       5017<<ASSIGN   5018>>ASSIGN   5018>>ASSIGN
      5020>>IF       5067<<ASSIGN   5068>>DOWHILE  5069>>IF       5071>>ASSIGN   5071>>ASSIGN   5075>>CALLBLT
      5075>>CALLBLT  5078>>ASSIGN   5157>>IF       5159>>IF       5191>>ASSIGN   5273>>ASSIGN   5281>>ASSIGN
      5297>>ASSIGN   5354>>IF       5360<<ASSIGN   5360>>ASSIGN
RC1$
      4546**DCL      4547--IMP-PTR
RS.DEF.MSM
      4665**DCL      4943>>IF       4979>>IF       5086>>IF       5122>>IF
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:92   
RS.DEF.OSM
      4664**DCL      4943>>IF       4979>>IF       4995>>IF       5086>>IF       5122>>IF       5138>>IF
RS.DEF.TYPE
      4654**DCL      4919>>IF       5020>>IF       5083>>IF       5233>>IF       5284>>IF       5299>>IF
RS.NPOS
      4677**DCL      4686--REDEF
RS.RCRSH
      4675**DCL      4916>>ASSIGN   5017>>ASSIGN
RS.RCRSN
      4674**DCL      5269>>ASSIGN   5294>>ASSIGN   5336>>ASSIGN
RS.RSCDN
      4671**DCL      4948>>ASSIGN   5091>>ASSIGN   5199>>ASSIGN
RS.RSSSN
      4672**DCL      4961>>ASSIGN   5104>>ASSIGN   5155>>ASSIGN
RS.SCRSH
      4676**DCL      5080>>ASSIGN   5193>>ASSIGN   5283>>ASSIGN
RS.SCRSN
      4673**DCL      5013>>ASSIGN   5055>>ASSIGN
RS$
      4651**DCL      4652--IMP-PTR  4914<<ASSIGN   4915>>DOWHILE  4916>>ASSIGN   4919>>IF       4943>>IF
      4943>>IF       4948>>ASSIGN   4961>>ASSIGN   4979>>IF       4979>>IF       4995>>IF       5013<<ASSIGN
      5013>>ASSIGN   5015<<ASSIGN   5016>>DOWHILE  5017>>ASSIGN   5020>>IF       5055<<ASSIGN   5055>>ASSIGN
      5078<<ASSIGN   5079>>DOWHILE  5080>>ASSIGN   5083>>IF       5086>>IF       5086>>IF       5091>>ASSIGN
      5104>>ASSIGN   5122>>IF       5122>>IF       5138>>IF       5155<<ASSIGN   5155>>ASSIGN   5191<<ASSIGN
      5192>>DOWHILE  5193>>ASSIGN   5199>>ASSIGN   5233>>IF       5269<<ASSIGN   5269>>ASSIGN   5281<<ASSIGN
      5282>>DOWHILE  5283>>ASSIGN   5284>>IF       5294<<ASSIGN   5294>>ASSIGN   5297<<ASSIGN   5298>>DOWHILE
      5299>>IF       5336<<ASSIGN   5336>>ASSIGN
SC.DEF.SETO
      4483**DCL      5284>>IF       5284>>IF       5301>>IF       5301>>IF
SC.DEF.SETT
      4489**DCL      4904>>IF       5196>>IF       5231>>IF       5284>>IF       5301>>IF       5301>>IF
SC.DEF.SNL
      4490**DCL      4495--IMP-SIZ  4907>>ASSIGN   4911>>CALLBLT  5081>>ASSIGN   5194>>ASSIGN   5305>>ASSIGN
SC.DEF.SNSS
      4484**DCL      4904>>IF       5083>>IF       5231>>IF       5284>>IF       5301>>IF
SC.OASCN
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:93   
      4492**DCL      5058>>ASSIGN
SC.SCRSN
      4493**DCL      4914>>ASSIGN   5015>>ASSIGN
SC.SNAM
      4495**DCL      4907>>ASSIGN   4911>>CALLBLT  5081>>ASSIGN   5194>>ASSIGN   5305>>ASSIGN
SC$
      4477**DCL      4478--IMP-PTR  4902<<ASSIGN   4903>>DOWHILE  4904>>IF       4904>>IF       4907>>ASSIGN
      4907>>ASSIGN   4911>>CALLBLT  4911>>CALLBLT  4914>>ASSIGN   5015>>ASSIGN   5058<<ASSIGN   5058>>ASSIGN
      5080<<ASSIGN   5081>>ASSIGN   5081>>ASSIGN   5083>>IF       5193<<ASSIGN   5194>>ASSIGN   5194>>ASSIGN
      5196>>IF       5231>>IF       5231>>IF       5283<<ASSIGN   5284>>IF       5284>>IF       5284>>IF
      5284>>IF       5301>>IF       5301>>IF       5301>>IF       5301>>IF       5301>>IF       5305>>ASSIGN
      5305>>ASSIGN
SC1$
      4503**DCL      4504--IMP-PTR
SET_FIELDS
       578**DCL-ENT  4850--CALL     4858--CALL     4913--CALL     4918--CALL     5019--CALL     5077--CALL
      5082--CALL     5195--CALL     5306--CALL
SM1$
      4725**DCL      4726--IMP-PTR
SS.RSCDN
      4740**DCL      4963>>ASSIGN   5106>>ASSIGN
SS.RSSSN
      4741**DCL      4976>>ASSIGN   5119>>ASSIGN
SS$
      4733**DCL      4734--IMP-PTR  4961<<ASSIGN   4962>>DOWHILE  4963>>ASSIGN   4976<<ASSIGN   4976>>ASSIGN
      5104<<ASSIGN   5105>>DOWHILE  5106>>ASSIGN   5119<<ASSIGN   5119>>ASSIGN
SSS$
      4315**DCL      4841>>ASSIGN   4842>>DOWHILE  4851>>ASSIGN   4852>>DOWHILE  4853>>ASSIGN   4898>>ASSIGN
      4900>>ASSIGN   4902>>ASSIGN   4903>>DOWHILE  4914>>ASSIGN   4915>>DOWHILE  4916>>ASSIGN   4948>>ASSIGN
      4949>>DOWHILE  4952>>ASSIGN   4955>>ASSIGN   4959>>ASSIGN   4961>>ASSIGN   4962>>DOWHILE  4963>>ASSIGN
      4964>>DOWHILE  4967>>ASSIGN   4970>>ASSIGN   4974>>ASSIGN   4976>>ASSIGN   5013>>ASSIGN   5015>>ASSIGN
      5016>>DOWHILE  5017>>ASSIGN   5055>>ASSIGN   5058>>ASSIGN   5067>>ASSIGN   5068>>DOWHILE  5078>>ASSIGN
      5079>>DOWHILE  5080>>ASSIGN   5091>>ASSIGN   5092>>DOWHILE  5095>>ASSIGN   5098>>ASSIGN   5102>>ASSIGN
      5104>>ASSIGN   5105>>DOWHILE  5106>>ASSIGN   5107>>DOWHILE  5110>>ASSIGN   5113>>ASSIGN   5117>>ASSIGN
      5119>>ASSIGN   5155>>ASSIGN   5191>>ASSIGN   5192>>DOWHILE  5193>>ASSIGN   5199>>ASSIGN   5200>>DOWHILE
      5203>>ASSIGN   5206>>ASSIGN   5212>>ASSIGN   5269>>ASSIGN   5273>>ASSIGN   5274>>DOWHILE  5279>>ASSIGN
PL6.E3A0      #001=ZIG$V_PERMIT File=ZIG$V_PERMIT.:ZIC0TSI                       FRI 09/05/97 12:22 Page:94   
      5281>>ASSIGN   5282>>DOWHILE  5283>>ASSIGN   5294>>ASSIGN   5297>>ASSIGN   5298>>DOWHILE  5336>>ASSIGN
      5360>>ASSIGN
SUBLST
       592**DCL-ENT  4840--CALL
SUBSCHEMA_KEY
       610**DCL       611--REDEF
SUB_LANGUAGE
      2618**DCL      4828>>CALL
TEMP_WORD
        31**DCL      4844<<ASSIGN   4850<>CALL     4857<<ASSIGN   4858<>CALL     4907<<ASSIGN   4913<>CALL
      4917<<ASSIGN   4918<>CALL     5018<<ASSIGN   5019<>CALL     5071<<ASSIGN   5077<>CALL     5081<<ASSIGN
      5082<>CALL     5194<<ASSIGN   5195<>CALL     5305<<ASSIGN   5306<>CALL
TYPE_300.INFO
      3196**DCL      3197--REDEF
TYPE_400.INFO
      3303**DCL      3304--REDEF
TYPE_430.EIS.ADDER
      3492**DCL      3493--REDEF    3494--REDEF
TYPE_430.EIS.EIS_BITS
      3497**DCL      3498--REDEF    3502--REDEF    3530--REDEF
TYPE_430.INFO
      3539**DCL      3540--REDEF
