
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:1    
        1        1        /*M*     ZIU$Q2UT       I-D-S/II      UTILITY DRIVER MODULE*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME: ZIU$Q2UT
        9        9        PURPOSE: DRIVER AND CALLER OF ALL THE UTILITY MODULES
       10       10        */
       11       11        ZIU$Q2UT: PROC MAIN;
       12       12
       13       13    1   DCL ZIU$Q2IN ENTRY ALTRET; /*Initialize routine*/
       14       14    1   DCL ZIU$Q2SC ENTRY(2) ALTRET; /*Schema interface routine*/
       15       15    1   DCL ZIU$Q2DI ENTRY ALTRET; /*Directive parser*/
       16       16    1   DCL GET_NXT_AC ENTRY(1) ALTRET;
       17       17    1   DCL ZIU$INRBT ENTRY ALTRET; /*Inventory page rebuilder*/
       18       18    1   DCL ZIU$KEYBLD ENTRY ALTRET;
       19       19    1   DCL DB_FUNC_FIN ENTRY ALTRET;
       20       20    1   DCL DB_FUNC_FDR ENTRY(2) ALTRET;
       21       21    1   DCL DB_FUNC_GET ENTRY(1) ALTRET;
       22       22    1   DCL GET_DCB ENTRY(1) ALTRET;
       23       23    1   DCL GET_SCHEMA_NAME ENTRY(1) ALTRET;
       24       24    1   DCL GETBUFFERS ENTRY ALTRET;
       25       25    1   DCL ZIU$ROLL ENTRY ALTRET; /* Roll foward utility */
       26       26    1   DCL ZIU$LOCK ENTRY ALTRET;
       27       27    1   DCL ZIU$UNLCK ENTRY ALTRET;
       28       28    1   DCL ZIU$TESTLOCK ENTRY ALTRET;
       29       29    1   DCL ZIU$SYSCTL ENTRY ALTRET;
       30       30    1   DCL ZIU$LOAD ENTRY ALTRET; /* Load routine */
       31       31    1   DCL ZIU$DUMP ENTRY ALTRET; /* Unload (dump)*/
       32       32    1   DCL ZIU$Q2PR ENTRY ALTRET; /*Print routine*/
       33       33    1   DCL ZIU$Q2RP ENTRY ALTRET; /* REPAIR ROUTINE */
       34       34    1   DCL ZIU$PA_ROOT ENTRY ALTRET;
       35       35    1   DCL ZIU$CHECK ENTRY ALTRET;
       36       36    1   DCL ZIU$REPRT ENTRY ALTRET;
       37       37    1   DCL ZIU$VALSET ENTRY ALTRET;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:2    
       38       38    1   DCL ZIU$SNAP ENTRY ALTRET;
       39       39    1   DCL REPORT_CHK ENTRY ALTRET;
       40       40    1   DCL FREE_DYN_MEM ENTRY ALTRET;
       41       41    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
       42       42    1   DCL SYS_FUNC_DATE ENTRY ALTRET;
       43       43    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
       44       44    1   DCL SYS_FUNC_CORRES ENTRY(2) ALTRET;
       45       45    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       46       46    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       47       47    1   DCL SYS_FUNC_GETDCB ENTRY ALTRET;
       48       48    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
       49       49    1   DCL ZIU$BRKCTL ENTRY ASYNC;
       50       50    1   DCL LAST_AREA BIT(1) STATIC UNAL;
       51       51    1   DCL PRINT_HDR BIT(1) STATIC SYMDEF INIT('0'B) UNAL;
       52       52    1   DCL CCBUF_ON BIT(1) STATIC SYMDEF UNAL;
       53       53    1   DCL ATBLK$ PTR STATIC SYMDEF ALIGNED;
       54       54    1   DCL DATA$ PTR STATIC SYMDEF ALIGNED;
       55       55    1   DCL INVPG$ PTR STATIC SYMDEF ALIGNED;
       56       56    1   DCL 1 TYPE STATIC SYMDEF ALIGNED,
       57       57    1         2 MSTRINDX(0:4003) SBIN HALF HALIGNED; /* USED BY ZIU$XREF */
       58       58    1   DCL XREF_BUILT BIT(1) SYMREF ALIGNED; /* DONT INVOKE ZI_DBU_XREF */
       59       59    1   DCL M$DO DCB;
       60       60    1   DCL M$SI DCB;
       61       61    1   DCL SI_DCB UBIN HALF STATIC SYMDEF INIT(DCBNUM(M$SI));
       62       62    1   DCL LO_DCB UBIN HALF STATIC SYMDEF INIT(DCBNUM(M$LO));
       63       63    1   DCL UC_DCB UBIN HALF STATIC SYMDEF INIT(DCBNUM(M$UC));
       64       64    1   DCL
       65       65    1    1 USER_SYSID STATIC SYMDEF ALIGNED,
       66       66    1    2 CNT UBIN BYTE UNAL,
       67       67    1    2 TEXT CHAR(7) UNAL;
       68       68    1   DCL 1 BUFFER STATIC SYMDEF ALIGNED,
       69       69    1         2 CAR_CON BIT(9) INIT('001000010'B) UNAL,
       70       70    1         2 TXT,
       71       71    1           3 MSG CHAR(35) INIT(' ') UNAL,
       72       72    1           3 AREA_NM CHAR(96) INIT(' ') UNAL,
       73       73    1         2 TEXT REDEF TXT CHAR(131),
       74       74    1         2 TEXT_EXIT REDEF TXT,
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:3    
       75       75    1           3 * CHAR(32) CALIGNED,
       76       76    1           3 STEPCC UBIN BYTE CALIGNED,
       77       77    1           3 * CHAR(98) CALIGNED;
       78       78    1   DCL 1 OUTPUT_STEPCC STATIC ALIGNED,
       79       79    1         2 * CHAR(0) INIT('B  Last directive STEPCC = ') CALIGNED,
       80       80    1         2 CURR UBIN BYTE CALIGNED,
       81       81    1         2 * CHAR(0) INIT('.  Highest STEPCC = ') CALIGNED,
       82       82    1         2 HIGHEST UBIN BYTE CALIGNED,
       83       83    1         2 * CHAR(0) INIT('.  ') CALIGNED;
       84       84    1   DCL FIR_LOOP_SW UBIN(36) INIT(0) STATIC ALIGNED;
       85       85    1   DCL INDX SBIN(36) STATIC ALIGNED;
       86       86    1   DCL HLP_CHK CHAR(4) STATIC ALIGNED;
       87       87    1   DCL CURR_SCHNM CHAR(30) INIT(' ') STATIC SYMDEF ALIGNED;
       88       88    1   DCL LAST_DBK UBIN WORD SYMREF; /* Symdefed in ZIU$Q2SC */
       89       89    1   DCL PPG# UBIN(36) INIT(0) STATIC SYMDEF;
       90       90    1   DCL READ_SW SBIN STATIC SYMDEF ALIGNED;
       91       91    1   DCL 1 B_VERSION ALIGNED SYMREF,
       92       92    1         2 L UBIN BYTE CALIGNED,
       93       93    1         2 C CHAR(B_VERSION.L);
       94       94    1   DCL 1 EX_RPT_HDR STATIC SYMDEF ALIGNED,
       95       95    1         2 * BIT(9) INIT('001110010'B) UNAL,
       96       96    1         2 * CHAR(4) INIT('VER '),
       97       97    1         2 VERS CHAR(6) INIT('******'),
       98       98    1         2 * CHAR(50) INIT('      BULL HN   I-D-S/II DBUTIL EXECUTION REPORT') UNAL,
       99       99    1         2 HDR_DATE CHAR(8) UNAL,
      100      100    1         2 * CHAR(6) INIT(' PAGE '),
      101      101    1         2 PG# CHAR(4) INIT(' ') UNAL;
      102      102    1   DCL 1 UTM6 STATIC ALIGNED,
      103      103    1         2 CAR_CON BIT(9) INIT('001000011'B) UNAL,
      104      104    1         2 * CHAR(10) INIT(' ') UNAL,
      105      105    1         2 * CHAR(47) INIT('*****UNRECOVERABLE ERROR - ACTIVITY ABORTED****') UNAL,
      106      106    1         2 * CHAR(74) INIT(' ') UNAL;
      107      107    1   DCL 1 DIR_PRNT STATIC SYMDEF ALIGNED,
      108      108    1         2 CAR_CON BIT(9) INIT('001000001'B) UNAL,
      109      109    1         2 * CHAR(13) INIT('DIRECTIVE:  ') UNAL,
      110      110    1         2 * CHAR(118) INIT(' ') UNAL;
      111      111    1   DCL RBUF CHAR(256) STATIC SYMDEF ALIGNED;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:4    
      112      112    1   DCL BLANK BIT(9) STATIC SYMDEF INIT('001000001'B) ;
      113      113        %INCLUDE ZI_PRSE_SUBS;
      114      269        %INCLUDE ZI_ERRORS_SUBS;
      115      789        %INCLUDE ZI$DIR;
      116      946        %DIR(STCLASS="STATIC SYMDEF",DIRNAME=ZI$DIR); /* GLOBAL SYMDEF HERE */
      117     1090        %INCLUDE CP_6;
      118     1171        %FPT_EXIT; /* DO M$EXIT WITH FPT TO SET STEPCC */
      119     1186        %INCLUDE CP_6_SUBS;
      120     1726        %INCLUDE ZI_RVA_C;
      121     2407         %CAN_RVA_REF;
      122     2726        %INCLUDE ZI_UWA_C;
      123     3416         %ZI$UWAB;
      124     3756        %F$DCB (DCBN=F$DCB);
      125     3813        %FPT_INT(UENTRY=ZIU$BRKCTL);
      126     3827        %B$TCB;
      127     3830        %B$EXCFR;
      128     3848        %INCLUDE ZI_GLOBAL_DBUTIL;
      129     4026         %MISC_DCLS(STCLASS="STATIC SYMDEF");
      130     4079         %SYS_FUNC(STCLASS="STATIC SYMDEF");
      131     4171        %INCLUDE B_ERRORS_C;
      132     5298        %INCLUDE B$ROSEG;
      133     5361        %INCLUDE U$JIT_C;
      134     5547        %EJECT;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:5    
      135     5548        /*
      136     5549               Print invocation header.
      137     5550        */
      138     5551    1   /**/ SUBMESSF = %YES#;
      139     5552    1   /**/ REASGNSF = %YES#;
      140     5553    1   /**/ DCBSF = DCBNUM(M$SI);
      141     5554    1       CALL SYS_FUNC_OPEN ALTRET(END_ZIU$Q2UT);
      142     5555    1   /**/ DCBSF = DCBNUM(M$LO);
      143     5556    1       CALL SYS_FUNC_OPEN ALTRET(END_ZIU$Q2UT);
      144     5557    1       CALL CONCAT(BUFFER.TEXT, 'DBUTIL I-D-S/II  VER ',B_VERSION.C,':');
      145     5558    1   /**/ BUFLNSF = 23 + B_VERSION.L;
      146     5559    1   /**/ DCBSF = DCBNUM(M$LO);
      147     5560    1   /**/ BUFSF = VECTOR(BUFFER.TXT.MSG);
      148     5561    1   /**/ VFCSF = %NO#;
      149     5562    1       CALL SYS_FUNC_WRIT;
      150     5563    1       CALL M$INT(FPT_INT);
      151     5564    1       CALL GETBUFFERS ALTRET(END_ZIU$Q2UT); /* GET I/O BUFFERS */
      152     5565    1       PRINT_HDR = %NO#;
      153     5566    1       CALL SYS_FUNC_CORRES(SI_DCB,UC_DCB) ALTRET(CHK_LO);
      154     5567    1       PRINT_HDR = %YES#;
      155     5568    1   CHK_LO: CALL SYS_FUNC_CORRES(LO_DCB,UC_DCB) ALTRET(ZIU$Q2UT_STRT);
      156     5569    1       PRINT_HDR = %YES#;
      157     5570    1   ZIU$Q2UT_STRT:
      158     5571         /*Initialize all switches before pass*/
      159     5572    1       REMEMBER RESTRT IN RESTART;
      160     5573        /*
      161     5574             Begin execution of utility directive by calling for it.
      162     5575        */
      163     5576    1   ZIU$Q2UT_GETDI:
      164     5577    1       BREAK_FLAG = 0;
      165     5578    1       IF STEPCC>FPT_EXIT.V.STEPCC# THEN
      166     5579    1           FPT_EXIT.V.STEPCC# = STEPCC;
      167     5580    1       STEPCC = 0; /* THEN INITILIZE INTERNAL STEPCC TO 0 */
      168     5581    1       CALL ZIU$Q2DI ALTRET(ALTEND_ZIU$Q2UT);
      169     5582         /*
      170     5583            Check if schema is open and needes to be closed.
      171     5584         */
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:6    
      172     5585    1       IF READ_SW = 3 THEN
      173     5586    2       DO; /* 3=End of directives from parser */
      174     5587    2           BUFFER.TEXT = '       DBUTIL Completed (STEPCC=0)';
      175     5588    2           BUFFER.TEXT_EXIT.STEPCC=FPT_EXIT.V.STEPCC#+48;
      176     5589    2    /**/   BUFSF = VECTOR(BUFFER);
      177     5590    2    /**/   DCBSF=DCBNUM(M$LO);
      178     5591    2           IF FPT_EXIT.V.STEPCC#=0 OR PRINT_HDR='0'B THEN
      179     5592    2               BUFLNSF = 24; /* DONT TYPE STEPCC=4 */
      180     5593    2           ELSE
      181     5594    2               BUFLNSF = 48; /* INCLUDE STEPCC=4 MSG */
      182     5595    2    /**/   WAITSF = %YES#;
      183     5596    2           CALL SYS_FUNC_WRIT;
      184     5597    2    /**/   BUFSF = VECTOR(BLANK);
      185     5598    2    /**/   VFCSF = %NO#;
      186     5599    2    /**/   BUFLNSF = 0;
      187     5600    2           CALL SYS_FUNC_WRIT;
      188     5601    2           GOTO END_ZIU$Q2UT;
      189     5602    2           END;
      190     5603        /*
      191     5604           Print header only if source in is from a file or list out
      192     5605           is to a file.
      193     5606        */
      194     5607    1       IF PRINT_HDR = %YES# THEN
      195     5608    2       DO;
      196     5609    2    /**/   UTSSF = VECTOR(NIL);
      197     5610    2    /**/   DATESF = VECTOR(EX_RPT_HDR.HDR_DATE);
      198     5611    2    /**/   SOURCESF = %CLOCK#;
      199     5612    2    /**/   DESTSF = %LOCAL#;
      200     5613    2           CALL SYS_FUNC_DATE;
      201     5614    2           PPG#=PPG#+1;
      202     5615    2           CALL BINCHAR(EX_RPT_HDR.PG#,PPG#);
      203     5616    2           EX_RPT_HDR.VERS = B_VERSION.C;
      204     5617    2    /**/   DCBSF = DCBNUM(M$LO);
      205     5618    2    /**/   BUFSF = VECTOR(EX_RPT_HDR);
      206     5619    2    /**/   BUFLNSF = LENGTHC(EX_RPT_HDR);
      207     5620    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);
      208     5621    2    /**/   BUFSF = VECTOR(DIR_PRNT);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:7    
      209     5622    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);
      210     5623    2    /**/   BUFSF = VECTOR(RBUF);
      211     5624    2    /**/   BUFLNSF = 256;
      212     5625    2    /**/   VFCSF = %NO#;
      213     5626    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);
      214     5627    2           END;
      215     5628    1       IF ZI$DIR.CODE=0 THEN /* IF DIR IS HELP OR HELP IDS */
      216     5629    1           GOTO RESTRT;
      217     5630    1       IF ZI$DIR.SYSCTL THEN
      218     5631    2       DO;
      219     5632    2           CALL ZIU$SYSCTL ALTRET(END_ZIU$Q2UT); /* ALT ON OPEN ERR */
      220     5633    2           GOTO RESTRT;
      221     5634    2           END;
      222     5635    1       IF ZI$DIR.CODE=#IBEX_OUTPUT THEN
      223     5636    2       DO; /* DIR IS OUTPUT STEPCC */
      224     5637    2           OUTPUT_STEPCC.CURR=STEPCC+48;
      225     5638    2           OUTPUT_STEPCC.HIGHEST=FPT_EXIT.V.STEPCC#+48;
      226     5639    2           DCBSF = DCBNUM(M$LO);
      227     5640    2           BUFSF = VECTOR(OUTPUT_STEPCC);
      228     5641    2           BUFLNSF = LENGTHC(OUTPUT_STEPCC);
      229     5642    2           VFCSF = %YES#;
      230     5643    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);
      231     5644    2           GOTO RESTRT;
      232     5645    2           END;
      233     5646        %EJECT;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:8    
      234     5647    1       IF ZI$DIR.SCHEMA_NEEDED THEN /* SCHEMA NAME NOT IN DIR */
      235     5648    1           IF ZI$DIR.UNLOAD THEN /* DIR = DUMP */
      236     5649    1               ZI$DIR.AREA_NM.NAME = ZI$DIR.SRCE_NM.NAME;
      237     5650    1           ELSE
      238     5651    1               IF ZI$DIR.LOAD THEN /* DIR = LOAD */
      239     5652    1                   ZI$DIR.AREA_NM.NAME = ZI$DIR.DEST_NM.NAME;
      240     5653    1       IF ZI$DIR.AUTODUMP='0'B AND ZI$DIR.AREA_NM.NAME.TEXT~=' ' THEN
      241     5654    1           CALL GET_DCB(ZI$DIR.AREA_NM); /* get dcb foa area specified.*/
      242     5655         /*
      243     5656            Check for one of 4 possible schema conditions and fill need.
      244     5657            1- Schema is needed  and is already active (no action)
      245     5658            2- Schema is needed  and is not active (open schema)
      246     5659            3- Schema is needed  and a different one is active
      247     5660            4- Schema not needed and one is active (handled above).
      248     5661         */
      249     5662    1       LAST_AREA = %NO#;
      250     5663    1       IF ZI$DIR.SCHEMA_NEEDED THEN
      251     5664    2       DO;
      252     5665    2           IF ZI$DIR.SCHEMA_NM.NAME.TEXT = '  ' THEN
      253     5666    2               CALL GET_SCHEMA_NAME(ZI$DIR.AREA_NM) ALTRET(ALTEND_ZIU$Q2UT);
      254     5667    2           IF SCHEMA_ACTIVE THEN
      255     5668    3           DO;
      256     5669    3               IF CURR_SCHNM ~= ZI$DIR.SCHEMA_NM.NAME.TEXT THEN
      257     5670    4               DO;
      258     5671    4                   CALL DB_FUNC_FIN;
      259     5672    4                   SCHEMA_ACTIVE=%NO#;
      260     5673    4                   IF XREF_BUILT = %YES# THEN
      261     5674    5                   DO;
      262     5675    5                       CALL FREE_DYN_MEM;
      263     5676    5                       XREF_BUILT = %NO#;
      264     5677    5                       END;
      265     5678    4                   END;
      266     5679    3               ELSE
      267     5680    4               DO; /* RESET SCHEMA POINTERS TO THE OA RECORD */
      268     5681    4                   CALL DB_FUNC_FDR(CAN_RVA.SFREC.SEC,2);
      269     5682    4                   CALL DB_FUNC_GET(CAN_RVA.SFREC.SEC);
      270     5683    4                   CALL DB_FUNC_FDR(CAN_RVA.OAREC.SEC,UWA.SF_REC.DBKOA);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:9    
      271     5684    4                   LAST_DBK = UWA.DIR_REF;
      272     5685    4                   IF (ZI$DIR.AUTODUMP OR ZI$DIR.AREA_NM.NAME.TEXT~=' ')
      273     5686    4                      AND NOT ZI$DIR.RESTR THEN
      274     5687    4                       CALL GET_NXT_AC(LAST_AREA) ALTRET(ALTEND_ZIU$Q2UT);
      275     5688    4                   END;
      276     5689    3               END;
      277     5690    2           IF SCHEMA_ACTIVE=%NO# THEN
      278     5691    3           DO; /* READY THE SCHEMA AND BUILD THE RVA */
      279     5692    3               CALL ZIU$Q2SC(ZI$DIR.AREA_NM.NAME.TEXT,
      280     5693    3                  ZI$DIR.SCHEMA_NM.NAME.TEXT) ALTRET(RESTRT);
      281     5694    3               IF (ZI$DIR.AUTODUMP OR ZI$DIR.AREA_NM.NAME.TEXT~=' ')
      282     5695    3                  AND NOT ZI$DIR.RESTR THEN
      283     5696    3                   CALL GET_NXT_AC(LAST_AREA) ALTRET(ALTEND_ZIU$Q2UT);
      284     5697    3               SCHEMA_ACTIVE=%YES#;
      285     5698    3               CURR_SCHNM = ZI$DIR.SCHEMA_NM.NAME.TEXT;
      286     5699    3               END;
      287     5700    2           END;
      288     5701        /**/
      289     5702        /*
      290     5703                 Procedure  for DUMP  and LOAD ('ALL' area option not allowed).
      291     5704        */
      292     5705
      293     5706    1       IF ZI$DIR.LOAD OR ZI$DIR.UNLOAD THEN
      294     5707    2       DO;
      295     5708    2           MERGESF = %YES#;
      296     5709    2           CALL GET_DCB(ZI$DIR.SRCE_NM) ALTRET(ALTEND_ZIU$Q2UT);
      297     5710    2           IF DCBADDR(DCBSF)->F$DCB.ASN# = %TAPE# AND
      298     5711    2              DCBADDR(DCBSF)->F$DCB.PSN# ~= PSNSF.SN# THEN
      299     5712    2               PSNSF.VOL# = 0;
      300     5713    2           CALL SYS_FUNC_RELDCB;
      301     5714    2           MERGESF = %NO#;
      302     5715    2           CALL GET_DCB(ZI$DIR.SRCE_NM) ALTRET(ALTEND_ZIU$Q2UT);
      303     5716    2           MERGESF = %YES#;
      304     5717    2           CALL GET_DCB(ZI$DIR.DEST_NM) ALTRET(ALTEND_ZIU$Q2UT);
      305     5718    2           IF DCBADDR(DCBSF)->F$DCB.ASN# = %TAPE# AND
      306     5719    2              DCBADDR(DCBSF)->F$DCB.PSN# ~= PSNSF.SN# THEN
      307     5720    2               PSNSF.VOL# = 0;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:10   
      308     5721        /* The following lines of code seem to serve no purpose...
      309     5722          this code seemed to cause $14573... but were not sure if any
      310     5723         side effects will not occur...can be deleted for C00...
      311     5724                    CALL SYS_FUNC_RELDCB;
      312     5725                    MERGESF = %NO#;
      313     5726                    CALL GET_DCB(ZI$DIR.DEST_NM) ALTRET(ALTEND_ZIU$Q2UT);
      314     5727        */
      315     5728    2           IF ZI$DIR.LOAD THEN
      316     5729    2               CALL ZIU$LOAD ALTRET(ALTEND_ZIU$Q2UT);
      317     5730    2           ELSE
      318     5731    2               CALL ZIU$DUMP ALTRET(ALTEND_ZIU$Q2UT);
      319     5732    2           END;
      320     5733        /*
      321     5734              Procedure for INIT,PRINT,KEY REBUILD AND INVENTORY REBUILD.
      322     5735        */
      323     5736    2       DO WHILE(~LAST_AREA);
      324     5737    2           IF ZI$DIR.AREA_NM.NAME.TEXT~=' ' THEN
      325     5738    2               MERGESF = %YES#;
      326     5739    2           CALL GET_DCB(ZI$DIR.AREA_NM) ALTRET(ALTEND_ZIU$Q2UT);
      327     5740    3           DO CASE(ZI$DIR.CODE);
      328     5741    3           CASE(#INIT);
      329     5742    3               CALL ZIU$Q2IN ALTRET(ALTEND_ZIU$Q2UT);
      330     5743    3           CASE(#PRINT);
      331     5744    3               CALL ZIU$Q2PR ALTRET(ALTEND_ZIU$Q2UT);
      332     5745    3           CASE(#REPAIR);
      333     5746    3               CALL ZIU$Q2RP ALTRET(ALTEND_ZIU$Q2UT);
      334     5747    3               GOTO RESTRT;
      335     5748    3           CASE(#COMPACT,#CONVERT,#RESORT,#REBUILDPA,#REVERT);
      336     5749    3               CALL ZIU$PA_ROOT ALTRET(ALTEND_ZIU$Q2UT);
      337     5750    3               GOTO RESTRT;
      338     5751    3           CASE(#CHECK);
      339     5752    3               CALL ZIU$CHECK ALTRET(ALTEND_ZIU$Q2UT);
      340     5753    3           CASE(#REPORT);
      341     5754    3               CALL ZIU$REPRT ALTRET(ALTEND_ZIU$Q2UT);
      342     5755    3           CASE(#VALIDATE);
      343     5756    3               CALL ZIU$VALSET ALTRET(ALTEND_ZIU$Q2UT);
      344     5757    3               GOTO RESTRT;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:11   
      345     5758    3           CASE(#SNAP);
      346     5759    3               CALL ZIU$SNAP ALTRET(ALTEND_ZIU$Q2UT);
      347     5760    3           CASE(#KEYRBLD);
      348     5761    3               CALL ZIU$KEYBLD ALTRET(ALTEND_ZIU$Q2UT);
      349     5762    3           CASE(#INV_RBD);
      350     5763    3               CALL ZIU$INRBT ALTRET(ALTEND_ZIU$Q2UT);
      351     5764    3           CASE(#ROLL);
      352     5765    3               IF XREF_BUILT = %YES# THEN
      353     5766    4               DO;
      354     5767    4                   CALL FREE_DYN_MEM;
      355     5768    4                   XREF_BUILT = %NO#;
      356     5769    4                   END;
      357     5770    3               CALL ZIU$ROLL ALTRET(ALTEND_ZIU$Q2UT);
      358     5771    3           CASE(#LOCK);
      359     5772    3               CALL ZIU$LOCK ALTRET(ALTEND_ZIU$Q2UT);
      360     5773    3           CASE(#UNLOCK);
      361     5774    3               CALL ZIU$UNLCK ALTRET(ALTEND_ZIU$Q2UT);
      362     5775    3           CASE(#TESTLOCK);
      363     5776    3               CALL ZIU$TESTLOCK ALTRET(ALTEND_ZIU$Q2UT);
      364     5777    3               IF STEPCC = 6 AND
      365     5778    3                  B$JIT.NEXTCC ~= %CC_FROMUC#
      366     5779    4               THEN DO;
      367     5780    4                   FPT_EXIT.V.STEPCC# = STEPCC;
      368     5781    4                   CALL M$EXIT(FPT_EXIT);
      369     5782    4                   END;
      370     5783    3           CASE(ELSE);
      371     5784    3               LAST_AREA = %YES#; /* ENSURE EXIT FROM LOOP */
      372     5785    3               END;
      373     5786    2           IF ZI$DIR.AREA_NM.NAME.TEXT~=' ' THEN
      374     5787    3           DO;
      375     5788    3    /**/       DCBSF = ZI$DIR.AREA_NM.DCB#;
      376     5789    3               CALL SYS_FUNC_RELDCB ALTRET(ALTEND_ZIU$Q2UT);
      377     5790    3               END;
      378     5791         /* we don't want to goto the next area if FOLLOW
      379     5792            was specified */
      380     5793    2           IF ZI$DIR.AUTODUMP AND ZI$DIR.FSET = '0'B THEN
      381     5794    2               CALL GET_NXT_AC(LAST_AREA);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:12   
      382     5795    2           ELSE
      383     5796    2               LAST_AREA = %YES#;
      384     5797    2           END;
      385     5798    1       IF ZI$DIR.CODE = #CHECK OR ZI$DIR.CHECK = %YES# THEN
      386     5799    2       DO;
      387     5800    2           CALL REPORT_CHK ALTRET(ALTEND_ZIU$Q2UT);
      388     5801    2           IF STEPCC = 0 AND FPT_EXIT.V.STEPCC# <4 THEN
      389     5802    2               FPT_EXIT.V.STEPCC# = 0; /* RESET GLOBAL STEPCC */
      390     5803    2           END;
      391     5804    1   RESTRT: IF CCBUF_ON THEN
      392     5805    1           GOTO END_ZIU$Q2UT;
      393     5806    1       ELSE
      394     5807    1           GOTO ZIU$Q2UT_STRT;
      395     5808    1   ALTEND_ZIU$Q2UT:
      396     5809    1       IF DCBADDR(DCBNUM(M$SI))->F$DCB.TYC.EOF# THEN /*End of file*/
      397     5810    2       DO;
      398     5811    2           BUFFER.TEXT='DIRECTIVE END OF FILE';
      399     5812    2    /**/   DCBSF = DCBNUM(M$LO);
      400     5813    2    /**/   BUFSF = VECTOR(BUFFER);
      401     5814    2    /**/   BUFLNSF = 60;
      402     5815    2           CALL SYS_FUNC_WRIT;
      403     5816    2    /**/   BUFSF = VECTOR(BLANK);
      404     5817    2    /**/   BUFLNSF = 1;
      405     5818    2           CALL SYS_FUNC_WRIT;
      406     5819    2    /**/   DCBSF= DCBNUM(M$SI);
      407     5820    2           CALL SYS_FUNC_CLOS;
      408     5821    2           GOTO END_ZIU$Q2UT;
      409     5822    2           END;
      410     5823    1       IF STEPCC > 9 THEN /* IF THE DIRECTIVE SET ABORT STEPCC */
      411     5824    2       DO;
      412     5825        /*E* ERROR: ZIU-DBU#XXX-5
      413     5826        MESSAGE: M$XXX is issued by DBUTIL.
      414     5827                 Critical errors occurred during the last directive. */
      415     5828    2           ERRCODESF.ERR# = DBU#XXX;
      416     5829    2           MSGCODE = ERRCODE_RDEF;
      417     5830    2           ERRFLGSF = 5; /* 5 STARS MSG */
      418     5831    2           CALL SYS_FUNC_ERRMSG;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:13   
      419     5832    2           CALL M$XXX;
      420     5833    2           END;
      421     5834    1       IF STEPCC=0 THEN STEPCC=7; /* SET IT IF NOT ALREADY SET */
      422     5835    1       IF STEPCC>FPT_EXIT.V.STEPCC# THEN
      423     5836    1           FPT_EXIT.V.STEPCC#=STEPCC;
      424     5837    1       IF DCBADDR(DCBNUM(M$SI)) -> F$DCB.TYC.IOERR# THEN
      425     5838    2       DO;
      426     5839    2           BUFFER.TEXT = '**** I/O ERROR ON DIRECTIVE INPUT';
      427     5840    2    /**/   DCBSF = DCBNUM(M$LO);
      428     5841    2    /**/   VFCSF = %NO#;
      429     5842    2    /**/   BUFSF = VECTOR(BUFFER.TEXT);
      430     5843    2    /**/   BUFLNSF = 50;
      431     5844    2           CALL SYS_FUNC_WRIT;
      432     5845    2           GOTO STEP_EXIT;
      433     5846    2           END;
      434     5847    1       ZI$DIR.HELP=0;
      435     5848    1       ZI$DIR.HELP_SVRITY=0;
      436     5849    1       GOTO RESTRT;
      437     5850    1   END_ZIU$Q2UT:
      438     5851    1       IF SCHEMA_ACTIVE THEN
      439     5852    1           CALL DB_FUNC_FIN;
      440     5853    1       IF XREF_BUILT = %YES# THEN
      441     5854    1           CALL FREE_DYN_MEM;
      442     5855    1       DCBSF=DCBNUM(M$SI);
      443     5856    1       CALL SYS_FUNC_CLOS;
      444     5857    1       DCBSF=DCBNUM(M$LO);
      445     5858    1       CALL SYS_FUNC_CLOS;
      446     5859    1   STEP_EXIT:
      447     5860    1       CALL M$EXIT (FPT_EXIT);
      448     5861    1   END ZIU$Q2UT;

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:14   
--  Include file information  --

   U$JIT_C.:LIB_E05  cannot be made into a system file and is referenced.
   B$ROSEG.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_UWA_C.:ZIC0TOU  is referenced.
   ZI_RVA_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$Q2UT.

   Procedure ZIU$Q2UT requires 669 words for executable code.
   Procedure ZIU$Q2UT requires 6 words of local(AUTO) storage.

    No errors detected in file ZIU$Q2UT.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:15   

 Object Unit name= ZIU$Q2UT                                   File name= ZIU$Q2UT.:ZIC0TOU
 UTS= SEP 05 '97 13:28:28.36 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none  3678   7136  ZIU$Q2UT
    1   DCB   even  none     0      0  M$DO
    2   DCB   even  none     0      0  M$SI
    3   DCB   even  none     0      0  M$UC
    4   DCB   even  none     0      0  M$LO
    5  RoData even  UTS     30     36  ZIU$Q2UT
    6   Proc  even  none   669   1235  ZIU$Q2UT
    7  RoData even  none    46     56  ZIU$Q2UT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Main       0  ZIU$Q2UT
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:16   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      1  PRINT_HDR                          0      2  CCBUF_ON
    0      3  ATBLK$                             0      4  DATA$
    0      5  INVPG$                             0      6  TYPE
    0   3730  SI_DCB                             0   3731  LO_DCB
    0   3732  UC_DCB                             0   3733  USER_SYSID
    0   3735  BUFFER                             0   4016  CURR_SCHNM
    0   4026  PPG#                               0   4027  READ_SW
    0   4030  EX_RPT_HDR                         0   4115  DIR_PRNT
    0   4156  RBUF                               0   4256  BLANK
    0   4257  ZI$DIR                             0   4546  SCHEMA_ACTIVE
    0   4547  RECORD_LIST                        0   5007  SET_LIST
    0   5247  RETAIN_LIST                        0   5507  DUMP_FID
    0   5747  ALTKY                              0   6207  INIT_RG
    0   6257  KEY_RNG                            0   6327  ITEM_LIST
    0   6602  REC$                               0   6603  RB
    0   6604  RE                                 0   6605  IE
    0   6606  IB                                 0   6607  CNT
    0   6610  ICNT                               0   6611  RCNT
    0   6612  SCNT                               0   6613  FIRST_SET
    0   6614  RETCNT                             0   6615  DMPCNT
    0   6616  KCNT                               0   6617  ACNT_IDX
    0   6620  I                                  0   6621  J
    0   6622  K                                  0   6623  X
    0   6624  STEPCC                             0   6625  I_O_BUF$
    0   6626  OUT_INDX                           0   6627  I_O_SIZE
    0   6630  REC_DATA_LN                        0   6631  KEYFID
    0   6642  I_O_KEY                            0   6643  RESTART
    0   6645  BREAK_FLAG                         0   6646  ICHKSUM
    0   6647  ITMCNT                             0   6650  GAP1
    0   6655  BLKLSF                             0   6656  KEYLSF
    0   6657  KEYXSF                             0   6660  DCBSF
    0   6661  ORGSF                              0   6662  KEYSF
    0   6663  KEYVSF                             0   6763  ACSSF
    0   6764  NOTIMESF                           0   6765  FUNSF
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:17   
    0   6766  ASNSF                              0   6767  TESTSF
    0   6770  XTENSIZESF                         0   6771  DISPSF
    0   6772  WAITSF                             0   6773  VFCSF
    0   6774  FULLSF                             0   6775  BKUPSF
    0   6776  BUFLNSF                            0   6777  BUFSF
    0   7001  SOURCESF                           0   7002  DESTSF
    0   7003  DATESF                             0   7005  TIMESF
    0   7007  UTSSF                              0   7011  DAYSF
    0   7013  TSTAMPSF                           0   7015  ENCRP_SEEDSF
    0   7016  ERRCODESF                          0   7017  MSGCODE
    0   7020  INCL_ERR                           0   7021  ERR_INSERT
    0   7051  FIDSF_RD                           0   7061  ACNT
    0   7105  EXISTSF                            0   7106  SHARESF
    0   7107  DCBNMSF                            0   7111  KEYRSF
    0   7112  NO_KEYSF                           0   7113  REASGNSF
    0   7114  CARRY_ATTRIBUTESF                  0   7115  SUBMESSF
    0   7116  SPKY_OPNSF                         0   7117  POSSF
    0   7120  ERRFLGSF                           0   7121  MERGESF
    0   7122  FSA_FLAG                           0   7123  RELGSF
    0   7124  UNUSED                             0   7125  HELPCODE
    0   7126  COUNTSF                            0   7127  INDEXSF
    0   7130  GAP                                0   7131  PSNSF
    0   7133  ACNTSF                             0   7135  KEY_SHADWSF
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:18   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 ZIU$BRKCTL
 yes     yes           Std       0 SYS_FUNC_OPEN
 yes     yes           Std       0 ZIU$SYSCTL
 yes     yes           Std       0 ZIU$Q2DI
 yes     yes           Std       0 SYS_FUNC_DATE
 yes     yes           Std       1 DB_FUNC_GET
 yes     yes           Std       0 ZIU$Q2IN
 yes     yes           Std       0 ZIU$Q2PR
 yes     yes           Std       0 ZIU$Q2RP
 yes     yes           Std       0 ZIU$INRBT
 yes     yes           Std       0 ZIU$KEYBLD
 yes     yes           Std       0 ZIU$LOAD
 yes     yes           Std       0 FREE_DYN_MEM
 yes     yes           Std       0 SYS_FUNC_RELDCB
 yes     yes           Std       0 ZIU$DUMP
 yes     yes           Std       0 ZIU$UNLCK
 yes     yes           Std       0 ZIU$REPRT
 yes     yes           Std       0 SYS_FUNC_WRIT
 yes     yes           Std       2 SYS_FUNC_CORRES
 yes     yes           Std       1 GET_SCHEMA_NAME
 yes     yes           Std       0 SYS_FUNC_CLOS
 yes     yes           Std       0 ZIU$CHECK
 yes     yes           Std       0 REPORT_CHK
 yes     yes           Std       1 GET_DCB
 yes     yes           Std       0 ZIU$PA_ROOT
 yes     yes           Std       0 ZIU$VALSET
 yes     yes           Std       2 DB_FUNC_FDR
 yes     yes           Std       0 ZIU$ROLL
 yes     yes           Std       1 GET_NXT_AC
 yes     yes           Std       0 ZIU$LOCK
 yes     yes           Std       2 ZIU$Q2SC
 yes     yes           Std       0 GETBUFFERS
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:19   
 yes     yes           Std       0 DB_FUNC_FIN
 yes     yes           Std       0 ZIU$SNAP
 yes     yes           Std       0 ZIU$TESTLOCK
 yes     yes           Std       0 SYS_FUNC_ERRMSG
                       nStd      0 X66_MAUTO
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     XREF_BUILT                            M$DO                                  M$SI
     LAST_DBK                              B_VERSION                             M$UC
     CAN_RVA                               UWA                                   M$LO
     B$TCB$                                B$ROS$                                B$JIT$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:20   


        1        1        /*M*     ZIU$Q2UT       I-D-S/II      UTILITY DRIVER MODULE*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME: ZIU$Q2UT
        9        9        PURPOSE: DRIVER AND CALLER OF ALL THE UTILITY MODULES
       10       10        */
       11       11        ZIU$Q2UT: PROC MAIN;

     11  6 000000   000000 700200 xent  ZIU$Q2UT     TSX0  ! X66_MAUTO
         6 000001   000006 000000                    ZERO    6,0

       12       12
       13       13    1   DCL ZIU$Q2IN ENTRY ALTRET; /*Initialize routine*/
       14       14    1   DCL ZIU$Q2SC ENTRY(2) ALTRET; /*Schema interface routine*/
       15       15    1   DCL ZIU$Q2DI ENTRY ALTRET; /*Directive parser*/
       16       16    1   DCL GET_NXT_AC ENTRY(1) ALTRET;
       17       17    1   DCL ZIU$INRBT ENTRY ALTRET; /*Inventory page rebuilder*/
       18       18    1   DCL ZIU$KEYBLD ENTRY ALTRET;
       19       19    1   DCL DB_FUNC_FIN ENTRY ALTRET;
       20       20    1   DCL DB_FUNC_FDR ENTRY(2) ALTRET;
       21       21    1   DCL DB_FUNC_GET ENTRY(1) ALTRET;
       22       22    1   DCL GET_DCB ENTRY(1) ALTRET;
       23       23    1   DCL GET_SCHEMA_NAME ENTRY(1) ALTRET;
       24       24    1   DCL GETBUFFERS ENTRY ALTRET;
       25       25    1   DCL ZIU$ROLL ENTRY ALTRET; /* Roll foward utility */
       26       26    1   DCL ZIU$LOCK ENTRY ALTRET;
       27       27    1   DCL ZIU$UNLCK ENTRY ALTRET;
       28       28    1   DCL ZIU$TESTLOCK ENTRY ALTRET;
       29       29    1   DCL ZIU$SYSCTL ENTRY ALTRET;
       30       30    1   DCL ZIU$LOAD ENTRY ALTRET; /* Load routine */
       31       31    1   DCL ZIU$DUMP ENTRY ALTRET; /* Unload (dump)*/
       32       32    1   DCL ZIU$Q2PR ENTRY ALTRET; /*Print routine*/
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:21   
       33       33    1   DCL ZIU$Q2RP ENTRY ALTRET; /* REPAIR ROUTINE */
       34       34    1   DCL ZIU$PA_ROOT ENTRY ALTRET;
       35       35    1   DCL ZIU$CHECK ENTRY ALTRET;
       36       36    1   DCL ZIU$REPRT ENTRY ALTRET;
       37       37    1   DCL ZIU$VALSET ENTRY ALTRET;
       38       38    1   DCL ZIU$SNAP ENTRY ALTRET;
       39       39    1   DCL REPORT_CHK ENTRY ALTRET;
       40       40    1   DCL FREE_DYN_MEM ENTRY ALTRET;
       41       41    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
       42       42    1   DCL SYS_FUNC_DATE ENTRY ALTRET;
       43       43    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
       44       44    1   DCL SYS_FUNC_CORRES ENTRY(2) ALTRET;
       45       45    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       46       46    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       47       47    1   DCL SYS_FUNC_GETDCB ENTRY ALTRET;
       48       48    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
       49       49    1   DCL ZIU$BRKCTL ENTRY ASYNC;
       50       50    1   DCL LAST_AREA BIT(1) STATIC UNAL;
       51       51    1   DCL PRINT_HDR BIT(1) STATIC SYMDEF INIT('0'B) UNAL;
       52       52    1   DCL CCBUF_ON BIT(1) STATIC SYMDEF UNAL;
       53       53    1   DCL ATBLK$ PTR STATIC SYMDEF ALIGNED;
       54       54    1   DCL DATA$ PTR STATIC SYMDEF ALIGNED;
       55       55    1   DCL INVPG$ PTR STATIC SYMDEF ALIGNED;
       56       56    1   DCL 1 TYPE STATIC SYMDEF ALIGNED,
       57       57    1         2 MSTRINDX(0:4003) SBIN HALF HALIGNED; /* USED BY ZIU$XREF */
       58       58    1   DCL XREF_BUILT BIT(1) SYMREF ALIGNED; /* DONT INVOKE ZI_DBU_XREF */
       59       59    1   DCL M$DO DCB;
       60       60    1   DCL M$SI DCB;
       61       61    1   DCL SI_DCB UBIN HALF STATIC SYMDEF INIT(DCBNUM(M$SI));
       62       62    1   DCL LO_DCB UBIN HALF STATIC SYMDEF INIT(DCBNUM(M$LO));
       63       63    1   DCL UC_DCB UBIN HALF STATIC SYMDEF INIT(DCBNUM(M$UC));
       64       64    1   DCL
       65       65    1    1 USER_SYSID STATIC SYMDEF ALIGNED,
       66       66    1    2 CNT UBIN BYTE UNAL,
       67       67    1    2 TEXT CHAR(7) UNAL;
       68       68    1   DCL 1 BUFFER STATIC SYMDEF ALIGNED,
       69       69    1         2 CAR_CON BIT(9) INIT('001000010'B) UNAL,
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:22   
       70       70    1         2 TXT,
       71       71    1           3 MSG CHAR(35) INIT(' ') UNAL,
       72       72    1           3 AREA_NM CHAR(96) INIT(' ') UNAL,
       73       73    1         2 TEXT REDEF TXT CHAR(131),
       74       74    1         2 TEXT_EXIT REDEF TXT,
       75       75    1           3 * CHAR(32) CALIGNED,
       76       76    1           3 STEPCC UBIN BYTE CALIGNED,
       77       77    1           3 * CHAR(98) CALIGNED;
       78       78    1   DCL 1 OUTPUT_STEPCC STATIC ALIGNED,
       79       79    1         2 * CHAR(0) INIT('B  Last directive STEPCC = ') CALIGNED,
       80       80    1         2 CURR UBIN BYTE CALIGNED,
       81       81    1         2 * CHAR(0) INIT('.  Highest STEPCC = ') CALIGNED,
       82       82    1         2 HIGHEST UBIN BYTE CALIGNED,
       83       83    1         2 * CHAR(0) INIT('.  ') CALIGNED;
       84       84    1   DCL FIR_LOOP_SW UBIN(36) INIT(0) STATIC ALIGNED;
       85       85    1   DCL INDX SBIN(36) STATIC ALIGNED;
       86       86    1   DCL HLP_CHK CHAR(4) STATIC ALIGNED;
       87       87    1   DCL CURR_SCHNM CHAR(30) INIT(' ') STATIC SYMDEF ALIGNED;
       88       88    1   DCL LAST_DBK UBIN WORD SYMREF; /* Symdefed in ZIU$Q2SC */
       89       89    1   DCL PPG# UBIN(36) INIT(0) STATIC SYMDEF;
       90       90    1   DCL READ_SW SBIN STATIC SYMDEF ALIGNED;
       91       91    1   DCL 1 B_VERSION ALIGNED SYMREF,
       92       92    1         2 L UBIN BYTE CALIGNED,
       93       93    1         2 C CHAR(B_VERSION.L);
       94       94    1   DCL 1 EX_RPT_HDR STATIC SYMDEF ALIGNED,
       95       95    1         2 * BIT(9) INIT('001110010'B) UNAL,
       96       96    1         2 * CHAR(4) INIT('VER '),
       97       97    1         2 VERS CHAR(6) INIT('******'),
       98       98    1         2 * CHAR(50) INIT('      BULL HN   I-D-S/II DBUTIL EXECUTION REPORT') UNAL,
       99       99    1         2 HDR_DATE CHAR(8) UNAL,
      100      100    1         2 * CHAR(6) INIT(' PAGE '),
      101      101    1         2 PG# CHAR(4) INIT(' ') UNAL;
      102      102    1   DCL 1 UTM6 STATIC ALIGNED,
      103      103    1         2 CAR_CON BIT(9) INIT('001000011'B) UNAL,
      104      104    1         2 * CHAR(10) INIT(' ') UNAL,
      105      105    1         2 * CHAR(47) INIT('*****UNRECOVERABLE ERROR - ACTIVITY ABORTED****') UNAL,
      106      106    1         2 * CHAR(74) INIT(' ') UNAL;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:23   
      107      107    1   DCL 1 DIR_PRNT STATIC SYMDEF ALIGNED,
      108      108    1         2 CAR_CON BIT(9) INIT('001000001'B) UNAL,
      109      109    1         2 * CHAR(13) INIT('DIRECTIVE:  ') UNAL,
      110      110    1         2 * CHAR(118) INIT(' ') UNAL;
      111      111    1   DCL RBUF CHAR(256) STATIC SYMDEF ALIGNED;
      112      112    1   DCL BLANK BIT(9) STATIC SYMDEF INIT('001000001'B) ;
      113      113        %INCLUDE ZI_PRSE_SUBS;
      114      269        %INCLUDE ZI_ERRORS_SUBS;
      115      789        %INCLUDE ZI$DIR;
      116      946        %DIR(STCLASS="STATIC SYMDEF",DIRNAME=ZI$DIR); /* GLOBAL SYMDEF HERE */
      117     1090        %INCLUDE CP_6;
      118     1171        %FPT_EXIT; /* DO M$EXIT WITH FPT TO SET STEPCC */
      119     1186        %INCLUDE CP_6_SUBS;
      120     1726        %INCLUDE ZI_RVA_C;
      121     2407         %CAN_RVA_REF;
      122     2726        %INCLUDE ZI_UWA_C;
      123     3416         %ZI$UWAB;
      124     3756        %F$DCB (DCBN=F$DCB);
      125     3813        %FPT_INT(UENTRY=ZIU$BRKCTL);
      126     3827        %B$TCB;
      127     3830        %B$EXCFR;
      128     3848        %INCLUDE ZI_GLOBAL_DBUTIL;
      129     4026         %MISC_DCLS(STCLASS="STATIC SYMDEF");
      130     4079         %SYS_FUNC(STCLASS="STATIC SYMDEF");
      131     4171        %INCLUDE B_ERRORS_C;
      132     5298        %INCLUDE B$ROSEG;
      133     5361        %INCLUDE U$JIT_C;
      134     5547        %EJECT;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:24   
      135     5548        /*
      136     5549               Print invocation header.
      137     5550        */
      138     5551    1   /**/ SUBMESSF = %YES#;

   5551  6 000002   400000 236003                    LDQ     -131072,DU
         6 000003   007115 756000 0                  STQ     SUBMESSF

      139     5552    1   /**/ REASGNSF = %YES#;

   5552  6 000004   007113 756000 0                  STQ     REASGNSF

      140     5553    1   /**/ DCBSF = DCBNUM(M$SI);

   5553  6 000005   000000 236007 xsym               LDQ     M$SI,DL
         6 000006   000000 620006                    EAX0    0,QL
         6 000007   006660 740000 0                  STX0    DCBSF

      141     5554    1       CALL SYS_FUNC_OPEN ALTRET(END_ZIU$Q2UT);

   5554  6 000010   000000 631400 7                  EPPR1   0
         6 000011   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         6 000012   001203 702000 6                  TSX2    END_ZIU$Q2UT

      142     5555    1   /**/ DCBSF = DCBNUM(M$LO);

   5555  6 000013   000000 236007 xsym               LDQ     M$LO,DL
         6 000014   000000 620006                    EAX0    0,QL
         6 000015   006660 740000 0                  STX0    DCBSF

      143     5556    1       CALL SYS_FUNC_OPEN ALTRET(END_ZIU$Q2UT);

   5556  6 000016   000000 631400 7                  EPPR1   0
         6 000017   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         6 000020   001203 702000 6                  TSX2    END_ZIU$Q2UT

      144     5557    1       CALL CONCAT(BUFFER.TEXT, 'DBUTIL I-D-S/II  VER ',B_VERSION.C,':');
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:25   

   5557  6 000021   000000 236000 xsym               LDQ     B_VERSION
         6 000022   000033 772000                    QRL     27
         6 000023   040000 100400                    MLR     fill='040'O
         6 000024   000000 000025 5                  ADSC9   0                        cn=0,n=21
         6 000025   003735 200025 0                  ADSC9   BUFFER                   cn=1,n=21
         6 000026   000000 620006                    EAX0    0,QL
         6 000027   040000 100440                    MLR     fill='040'O
         6 000030   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         6 000031   003742 400156 0                  ADSC9   BUFFER+5                 cn=2,n=110
         6 000032   000156 116007                    CMPQ    110,DL
         6 000033   000041 603000 6                  TRC     s:5558
         6 000034   777621 621006                    EAX1    -111,QL
         6 000035   777777 661003                    ERX1    -1,DU
         6 000036   040046 100400                    MLR     fill='040'O
         6 000037   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 000040   003742 400011 0                  ADSC9   BUFFER+5,Q               cn=2,n=*X1

      145     5558    1   /**/ BUFLNSF = 23 + B_VERSION.L;

   5558  6 000041   000027 036007                    ADLQ    23,DL
         6 000042   006776 756000 0                  STQ     BUFLNSF

      146     5559    1   /**/ DCBSF = DCBNUM(M$LO);

   5559  6 000043   000000 236007 xsym               LDQ     M$LO,DL
         6 000044   000000 621006                    EAX1    0,QL
         6 000045   006660 741000 0                  STX1    DCBSF

      147     5560    1   /**/ BUFSF = VECTOR(BUFFER.TXT.MSG);

   5560  6 000046   000002 237000 7                  LDAQ    2
         6 000047   006777 755000 0                  STA     BUFSF
         6 000050   007000 756000 0                  STQ     BUFSF+1

      148     5561    1   /**/ VFCSF = %NO#;

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:26   
   5561  6 000051   006773 450000 0                  STZ     VFCSF

      149     5562    1       CALL SYS_FUNC_WRIT;

   5562  6 000052   000000 631400 7                  EPPR1   0
         6 000053   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000054   000000 011000                    NOP     0

      150     5563    1       CALL M$INT(FPT_INT);

   5563  6 000055   006576 630400 0                  EPPR0   FPT_INT
         6 000056   010002 713400                    CLIMB   4098
         6 000057   400000 401760                    pmme    nvectors=1

      151     5564    1       CALL GETBUFFERS ALTRET(END_ZIU$Q2UT); /* GET I/O BUFFERS */

   5564  6 000060   000000 631400 7                  EPPR1   0
         6 000061   000000 701000 xent               TSX1    GETBUFFERS
         6 000062   001203 702000 6                  TSX2    END_ZIU$Q2UT

      152     5565    1       PRINT_HDR = %NO#;

   5565  6 000063   000001 450000 0                  STZ     PRINT_HDR

      153     5566    1       CALL SYS_FUNC_CORRES(SI_DCB,UC_DCB) ALTRET(CHK_LO);

   5566  6 000064   000005 630400 7                  EPPR0   5
         6 000065   000004 631400 7                  EPPR1   4
         6 000066   000000 701000 xent               TSX1    SYS_FUNC_CORRES
         6 000067   000072 702000 6                  TSX2    CHK_LO

      154     5567    1       PRINT_HDR = %YES#;

   5567  6 000070   400000 236003                    LDQ     -131072,DU
         6 000071   000001 756000 0                  STQ     PRINT_HDR

      155     5568    1   CHK_LO: CALL SYS_FUNC_CORRES(LO_DCB,UC_DCB) ALTRET(ZIU$Q2UT_STRT);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:27   

   5568  6 000072   000007 630400 7     CHK_LO       EPPR0   7
         6 000073   000004 631400 7                  EPPR1   4
         6 000074   000000 701000 xent               TSX1    SYS_FUNC_CORRES
         6 000075   000100 702000 6                  TSX2    ZIU$Q2UT_STRT

      156     5569    1       PRINT_HDR = %YES#;

   5569  6 000076   400000 236003                    LDQ     -131072,DU
         6 000077   000001 756000 0                  STQ     PRINT_HDR

      157     5570    1   ZIU$Q2UT_STRT:
      158     5571         /*Initialize all switches before pass*/
      159     5572    1       REMEMBER RESTRT IN RESTART;

   5572  6 000100   001045 635000 6     ZIU$Q2UT_ST* EAA     RESTRT
         6 000101   006643 452400 0                  STP2    RESTART
         6 000102   006644 755000 0                  STA     RESTART+1

      160     5573        /*
      161     5574             Begin execution of utility directive by calling for it.
      162     5575        */
      163     5576    1   ZIU$Q2UT_GETDI:
      164     5577    1       BREAK_FLAG = 0;

   5577  6 000103   006645 450000 0     ZIU$Q2UT_GE* STZ     BREAK_FLAG

      165     5578    1       IF STEPCC>FPT_EXIT.V.STEPCC# THEN

   5578  6 000104   006574 236000 0                  LDQ     FPT_EXIT+4
         6 000105   000033 772000                    QRL     27
         6 000106   006624 116000 0                  CMPQ    STEPCC
         6 000107   000113 605000 6                  TPL     s:5580

      166     5579    1           FPT_EXIT.V.STEPCC# = STEPCC;

   5579  6 000110   006624 236000 0                  LDQ     STEPCC
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:28   
         6 000111   000033 736000                    QLS     27
         6 000112   006574 552040 0                  STBQ    FPT_EXIT+4,'40'O

      167     5580    1       STEPCC = 0; /* THEN INITILIZE INTERNAL STEPCC TO 0 */

   5580  6 000113   006624 450000 0                  STZ     STEPCC

      168     5581    1       CALL ZIU$Q2DI ALTRET(ALTEND_ZIU$Q2UT);

   5581  6 000114   000000 631400 7                  EPPR1   0
         6 000115   000000 701000 xent               TSX1    ZIU$Q2DI
         6 000116   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      169     5582         /*
      170     5583            Check if schema is open and needes to be closed.
      171     5584         */
      172     5585    1       IF READ_SW = 3 THEN

   5585  6 000117   004027 235000 0                  LDA     READ_SW
         6 000120   000003 115007                    CMPA    3,DL
         6 000121   000170 601000 6                  TNZ     s:5607

      173     5586    2       DO; /* 3=End of directives from parser */

      174     5587    2           BUFFER.TEXT = '       DBUTIL Completed (STEPCC=0)';

   5587  6 000122   040000 100400                    MLR     fill='040'O
         6 000123   000006 000042 5                  ADSC9   6                        cn=0,n=34
         6 000124   003735 200203 0                  ADSC9   BUFFER                   cn=1,n=131

      175     5588    2           BUFFER.TEXT_EXIT.STEPCC=FPT_EXIT.V.STEPCC#+48;

   5588  6 000125   006574 236000 0                  LDQ     FPT_EXIT+4
         6 000126   000033 772000                    QRL     27
         6 000127   000060 036007                    ADLQ    48,DL
         6 000130   000022 736000                    QLS     18
         6 000131   003745 552020 0                  STBQ    BUFFER+8,'20'O
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:29   

      176     5589    2    /**/   BUFSF = VECTOR(BUFFER);

   5589  6 000132   000012 237000 7                  LDAQ    10
         6 000133   006777 755000 0                  STA     BUFSF
         6 000134   007000 756000 0                  STQ     BUFSF+1

      177     5590    2    /**/   DCBSF=DCBNUM(M$LO);

   5590  6 000135   000000 236007 xsym               LDQ     M$LO,DL
         6 000136   000000 620006                    EAX0    0,QL
         6 000137   006660 740000 0                  STX0    DCBSF

      178     5591    2           IF FPT_EXIT.V.STEPCC#=0 OR PRINT_HDR='0'B THEN

   5591  6 000140   006574 236000 0                  LDQ     FPT_EXIT+4
         6 000141   777000 316003                    CANQ    -512,DU
         6 000142   000145 600000 6                  TZE     s:5592
         6 000143   000001 234000 0                  SZN     PRINT_HDR
         6 000144   000150 604000 6                  TMI     s:5594

      179     5592    2               BUFLNSF = 24; /* DONT TYPE STEPCC=4 */

   5592  6 000145   000030 235007                    LDA     24,DL
         6 000146   006776 755000 0                  STA     BUFLNSF
         6 000147   000152 710000 6                  TRA     s:5595

      180     5593    2           ELSE
      181     5594    2               BUFLNSF = 48; /* INCLUDE STEPCC=4 MSG */

   5594  6 000150   000060 235007                    LDA     48,DL
         6 000151   006776 755000 0                  STA     BUFLNSF

      182     5595    2    /**/   WAITSF = %YES#;

   5595  6 000152   400000 236003                    LDQ     -131072,DU
         6 000153   006772 756000 0                  STQ     WAITSF
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:30   

      183     5596    2           CALL SYS_FUNC_WRIT;

   5596  6 000154   000000 631400 7                  EPPR1   0
         6 000155   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000156   000000 011000                    NOP     0

      184     5597    2    /**/   BUFSF = VECTOR(BLANK);

   5597  6 000157   000014 237000 7                  LDAQ    12
         6 000160   006777 755000 0                  STA     BUFSF
         6 000161   007000 756000 0                  STQ     BUFSF+1

      185     5598    2    /**/   VFCSF = %NO#;

   5598  6 000162   006773 450000 0                  STZ     VFCSF

      186     5599    2    /**/   BUFLNSF = 0;

   5599  6 000163   006776 450000 0                  STZ     BUFLNSF

      187     5600    2           CALL SYS_FUNC_WRIT;

   5600  6 000164   000000 631400 7                  EPPR1   0
         6 000165   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000166   000000 011000                    NOP     0

      188     5601    2           GOTO END_ZIU$Q2UT;

   5601  6 000167   001203 710000 6                  TRA     END_ZIU$Q2UT

      189     5602    2           END;
      190     5603        /*
      191     5604           Print header only if source in is from a file or list out
      192     5605           is to a file.
      193     5606        */
      194     5607    1       IF PRINT_HDR = %YES# THEN
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:31   

   5607  6 000170   000001 234000 0                  SZN     PRINT_HDR
         6 000171   000256 605000 6                  TPL     s:5628

      195     5608    2       DO;

      196     5609    2    /**/   UTSSF = VECTOR(NIL);

   5609  6 000172   000016 237000 7                  LDAQ    14
         6 000173   007007 755000 0                  STA     UTSSF
         6 000174   007010 756000 0                  STQ     UTSSF+1

      197     5610    2    /**/   DATESF = VECTOR(EX_RPT_HDR.HDR_DATE);

   5610  6 000175   000020 237000 7                  LDAQ    16
         6 000176   007003 755000 0                  STA     DATESF
         6 000177   007004 756000 0                  STQ     DATESF+1

      198     5611    2    /**/   SOURCESF = %CLOCK#;

   5611  6 000200   007001 450000 0                  STZ     SOURCESF

      199     5612    2    /**/   DESTSF = %LOCAL#;

   5612  6 000201   000003 235007                    LDA     3,DL
         6 000202   007002 755000 0                  STA     DESTSF

      200     5613    2           CALL SYS_FUNC_DATE;

   5613  6 000203   000000 631400 7                  EPPR1   0
         6 000204   000000 701000 xent               TSX1    SYS_FUNC_DATE
         6 000205   000000 011000                    NOP     0

      201     5614    2           PPG#=PPG#+1;

   5614  6 000206   004026 235000 0                  LDA     PPG#
         6 000207   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:32   
         6 000210   004026 755000 0                  STA     PPG#

      202     5615    2           CALL BINCHAR(EX_RPT_HDR.PG#,PPG#);

   5615  6 000211   000044 773000                    LRL     36
         6 000212   200004 757100                    STAQ    4,,AUTO
         6 000213   000000 301500                    BTD
         6 000214   200004 000010                    NDSC9   4,,AUTO                  cn=0,s=lsgnf,sf=0,n=8
         6 000215   004052 630004 0                  NDSC9   EX_RPT_HDR+18            cn=3,s=nosgn,sf=0,n=4

      203     5616    2           EX_RPT_HDR.VERS = B_VERSION.C;

   5616  6 000216   000000 236000 xsym               LDQ     B_VERSION
         6 000217   000033 772000                    QRL     27
         6 000220   000000 620006                    EAX0    0,QL
         6 000221   040000 100440                    MLR     fill='040'O
         6 000222   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         6 000223   004031 200006 0                  ADSC9   EX_RPT_HDR+1             cn=1,n=6

      204     5617    2    /**/   DCBSF = DCBNUM(M$LO);

   5617  6 000224   000000 236007 xsym               LDQ     M$LO,DL
         6 000225   000000 621006                    EAX1    0,QL
         6 000226   006660 741000 0                  STX1    DCBSF

      205     5618    2    /**/   BUFSF = VECTOR(EX_RPT_HDR);

   5618  6 000227   000022 237000 7                  LDAQ    18
         6 000230   006777 755000 0                  STA     BUFSF
         6 000231   007000 756000 0                  STQ     BUFSF+1

      206     5619    2    /**/   BUFLNSF = LENGTHC(EX_RPT_HDR);

   5619  6 000232   000117 235007                    LDA     79,DL
         6 000233   006776 755000 0                  STA     BUFLNSF

      207     5620    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:33   

   5620  6 000234   000000 631400 7                  EPPR1   0
         6 000235   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000236   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      208     5621    2    /**/   BUFSF = VECTOR(DIR_PRNT);

   5621  6 000237   000024 237000 7                  LDAQ    20
         6 000240   006777 755000 0                  STA     BUFSF
         6 000241   007000 756000 0                  STQ     BUFSF+1

      209     5622    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);

   5622  6 000242   000000 631400 7                  EPPR1   0
         6 000243   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000244   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      210     5623    2    /**/   BUFSF = VECTOR(RBUF);

   5623  6 000245   000026 237000 7                  LDAQ    22
         6 000246   006777 755000 0                  STA     BUFSF
         6 000247   007000 756000 0                  STQ     BUFSF+1

      211     5624    2    /**/   BUFLNSF = 256;

   5624  6 000250   000400 235007                    LDA     256,DL
         6 000251   006776 755000 0                  STA     BUFLNSF

      212     5625    2    /**/   VFCSF = %NO#;

   5625  6 000252   006773 450000 0                  STZ     VFCSF

      213     5626    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);

   5626  6 000253   000000 631400 7                  EPPR1   0
         6 000254   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000255   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:34   

      214     5627    2           END;

      215     5628    1       IF ZI$DIR.CODE=0 THEN /* IF DIR IS HELP OR HELP IDS */

   5628  6 000256   004404 236000 0                  LDQ     ZI$DIR+85
         6 000257   000030 316000 7                  CANQ    24
         6 000260   001045 600000 6                  TZE     RESTRT

      216     5629    1           GOTO RESTRT;
      217     5630    1       IF ZI$DIR.SYSCTL THEN

   5630  6 000261   020000 316007                    CANQ    8192,DL
         6 000262   000267 600000 6                  TZE     s:5635

      218     5631    2       DO;

      219     5632    2           CALL ZIU$SYSCTL ALTRET(END_ZIU$Q2UT); /* ALT ON OPEN ERR */

   5632  6 000263   000000 631400 7                  EPPR1   0
         6 000264   000000 701000 xent               TSX1    ZIU$SYSCTL
         6 000265   001203 702000 6                  TSX2    END_ZIU$Q2UT

      220     5633    2           GOTO RESTRT;

   5633  6 000266   001045 710000 6                  TRA     RESTRT

      221     5634    2           END;
      222     5635    1       IF ZI$DIR.CODE=#IBEX_OUTPUT THEN

   5635  6 000267   004404 236000 0                  LDQ     ZI$DIR+85
         6 000270   000030 376000 7                  ANQ     24
         6 000271   000031 116000 7                  CMPQ    25
         6 000272   000321 601000 6                  TNZ     s:5647

      223     5636    2       DO; /* DIR IS OUTPUT STEPCC */

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:35   
      224     5637    2           OUTPUT_STEPCC.CURR=STEPCC+48;

   5637  6 000273   006624 236000 0                  LDQ     STEPCC
         6 000274   000060 036007                    ADLQ    48,DL
         6 000275   004004 552004 0                  STBQ    OUTPUT_STEPCC+6,'04'O

      225     5638    2           OUTPUT_STEPCC.HIGHEST=FPT_EXIT.V.STEPCC#+48;

   5638  6 000276   006574 236000 0                  LDQ     FPT_EXIT+4
         6 000277   000033 772000                    QRL     27
         6 000300   000060 036007                    ADLQ    48,DL
         6 000301   000033 736000                    QLS     27
         6 000302   004012 552040 0                  STBQ    OUTPUT_STEPCC+12,'40'O

      226     5639    2           DCBSF = DCBNUM(M$LO);

   5639  6 000303   000000 236007 xsym               LDQ     M$LO,DL
         6 000304   000000 620006                    EAX0    0,QL
         6 000305   006660 740000 0                  STX0    DCBSF

      227     5640    2           BUFSF = VECTOR(OUTPUT_STEPCC);

   5640  6 000306   000032 237000 7                  LDAQ    26
         6 000307   006777 755000 0                  STA     BUFSF
         6 000310   007000 756000 0                  STQ     BUFSF+1

      228     5641    2           BUFLNSF = LENGTHC(OUTPUT_STEPCC);

   5641  6 000311   000064 235007                    LDA     52,DL
         6 000312   006776 755000 0                  STA     BUFLNSF

      229     5642    2           VFCSF = %YES#;

   5642  6 000313   400000 236003                    LDQ     -131072,DU
         6 000314   006773 756000 0                  STQ     VFCSF

      230     5643    2           CALL SYS_FUNC_WRIT ALTRET(ALTEND_ZIU$Q2UT);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:36   

   5643  6 000315   000000 631400 7                  EPPR1   0
         6 000316   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 000317   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      231     5644    2           GOTO RESTRT;

   5644  6 000320   001045 710000 6                  TRA     RESTRT

      232     5645    2           END;
      233     5646        %EJECT;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:37   
      234     5647    1       IF ZI$DIR.SCHEMA_NEEDED THEN /* SCHEMA NAME NOT IN DIR */

   5647  6 000321   004404 236000 0                  LDQ     ZI$DIR+85
         6 000322   004000 316003                    CANQ    2048,DU
         6 000323   000340 600000 6                  TZE     s:5653

      235     5648    1           IF ZI$DIR.UNLOAD THEN /* DIR = DUMP */

   5648  6 000324   004257 236000 0                  LDQ     ZI$DIR
         6 000325   020000 316003                    CANQ    8192,DU
         6 000326   000333 600000 6                  TZE     s:5651

      236     5649    1               ZI$DIR.AREA_NM.NAME = ZI$DIR.SRCE_NM.NAME;

   5649  6 000327   000000 100400                    MLR     fill='000'O
         6 000330   004524 000037 0                  ADSC9   ZI$DIR+165               cn=0,n=31
         6 000331   004513 000037 0                  ADSC9   ZI$DIR+156               cn=0,n=31
         6 000332   000340 710000 6                  TRA     s:5653

      237     5650    1           ELSE
      238     5651    1               IF ZI$DIR.LOAD THEN /* DIR = LOAD */

   5651  6 000333   040000 316003                    CANQ    16384,DU
         6 000334   000340 600000 6                  TZE     s:5653

      239     5652    1                   ZI$DIR.AREA_NM.NAME = ZI$DIR.DEST_NM.NAME;

   5652  6 000335   000000 100400                    MLR     fill='000'O
         6 000336   004535 000037 0                  ADSC9   ZI$DIR+174               cn=0,n=31
         6 000337   004513 000037 0                  ADSC9   ZI$DIR+156               cn=0,n=31

      240     5653    1       IF ZI$DIR.AUTODUMP='0'B AND ZI$DIR.AREA_NM.NAME.TEXT~=' ' THEN

   5653  6 000340   004305 236000 0                  LDQ     ZI$DIR+22
         6 000341   400000 316007                    CANQ    -131072,DL
         6 000342   000353 601000 6                  TNZ     s:5662
         6 000343   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:38   
         6 000344   004513 200036 0                  ADSC9   ZI$DIR+156               cn=1,n=30
         6 000345   000034 000001 7                  ADSC9   28                       cn=0,n=1
         6 000346   000353 600000 6                  TZE     s:5662

      241     5654    1           CALL GET_DCB(ZI$DIR.AREA_NM); /* get dcb foa area specified.*/

   5654  6 000347   000036 630400 7                  EPPR0   30
         6 000350   000035 631400 7                  EPPR1   29
         6 000351   000000 701000 xent               TSX1    GET_DCB
         6 000352   000000 011000                    NOP     0

      242     5655         /*
      243     5656            Check for one of 4 possible schema conditions and fill need.
      244     5657            1- Schema is needed  and is already active (no action)
      245     5658            2- Schema is needed  and is not active (open schema)
      246     5659            3- Schema is needed  and a different one is active
      247     5660            4- Schema not needed and one is active (handled above).
      248     5661         */
      249     5662    1       LAST_AREA = %NO#;

   5662  6 000353   000000 450000 0                  STZ     LAST_AREA

      250     5663    1       IF ZI$DIR.SCHEMA_NEEDED THEN

   5663  6 000354   004404 236000 0                  LDQ     ZI$DIR+85
         6 000355   004000 316003                    CANQ    2048,DU
         6 000356   000475 600000 6                  TZE     s:5706

      251     5664    2       DO;

      252     5665    2           IF ZI$DIR.SCHEMA_NM.NAME.TEXT = '  ' THEN

   5665  6 000357   040000 106400                    CMPC    fill='040'O
         6 000360   004502 200036 0                  ADSC9   ZI$DIR+147               cn=1,n=30
         6 000361   000005 000002 5                  ADSC9   5                        cn=0,n=2
         6 000362   000367 601000 6                  TNZ     s:5667

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:39   
      253     5666    2               CALL GET_SCHEMA_NAME(ZI$DIR.AREA_NM) ALTRET(ALTEND_ZIU$Q2UT);

   5666  6 000363   000036 630400 7                  EPPR0   30
         6 000364   000035 631400 7                  EPPR1   29
         6 000365   000000 701000 xent               TSX1    GET_SCHEMA_NAME
         6 000366   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      254     5667    2           IF SCHEMA_ACTIVE THEN

   5667  6 000367   004546 234000 0                  SZN     SCHEMA_ACTIVE
         6 000370   000444 605000 6                  TPL     s:5690

      255     5668    3           DO;

      256     5669    3               IF CURR_SCHNM ~= ZI$DIR.SCHEMA_NM.NAME.TEXT THEN

   5669  6 000371   040000 106400                    CMPC    fill='040'O
         6 000372   004016 000036 0                  ADSC9   CURR_SCHNM               cn=0,n=30
         6 000373   004502 200036 0                  ADSC9   ZI$DIR+147               cn=1,n=30
         6 000374   000410 600000 6                  TZE     s:5681

      257     5670    4               DO;

      258     5671    4                   CALL DB_FUNC_FIN;

   5671  6 000375   000000 631400 7                  EPPR1   0
         6 000376   000000 701000 xent               TSX1    DB_FUNC_FIN
         6 000377   000000 011000                    NOP     0

      259     5672    4                   SCHEMA_ACTIVE=%NO#;

   5672  6 000400   004546 450000 0                  STZ     SCHEMA_ACTIVE

      260     5673    4                   IF XREF_BUILT = %YES# THEN

   5673  6 000401   000000 234000 xsym               SZN     XREF_BUILT
         6 000402   000444 605000 6                  TPL     s:5690
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:40   

      261     5674    5                   DO;

      262     5675    5                       CALL FREE_DYN_MEM;

   5675  6 000403   000000 631400 7                  EPPR1   0
         6 000404   000000 701000 xent               TSX1    FREE_DYN_MEM
         6 000405   000000 011000                    NOP     0

      263     5676    5                       XREF_BUILT = %NO#;

   5676  6 000406   000000 450000 xsym               STZ     XREF_BUILT

      264     5677    5                       END;

      265     5678    4                   END;

   5678  6 000407   000444 710000 6                  TRA     s:5690

      266     5679    3               ELSE
      267     5680    4               DO; /* RESET SCHEMA POINTERS TO THE OA RECORD */

      268     5681    4                   CALL DB_FUNC_FDR(CAN_RVA.SFREC.SEC,2);

   5681  6 000410   000040 630400 7                  EPPR0   32
         6 000411   000004 631400 7                  EPPR1   4
         6 000412   000000 701000 xent               TSX1    DB_FUNC_FDR
         6 000413   000000 011000                    NOP     0

      269     5682    4                   CALL DB_FUNC_GET(CAN_RVA.SFREC.SEC);

   5682  6 000414   000040 630400 7                  EPPR0   32
         6 000415   000035 631400 7                  EPPR1   29
         6 000416   000000 701000 xent               TSX1    DB_FUNC_GET
         6 000417   000000 011000                    NOP     0

      270     5683    4                   CALL DB_FUNC_FDR(CAN_RVA.OAREC.SEC,UWA.SF_REC.DBKOA);
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:41   

   5683  6 000420   000042 630400 7                  EPPR0   34
         6 000421   000004 631400 7                  EPPR1   4
         6 000422   000000 701000 xent               TSX1    DB_FUNC_FDR
         6 000423   000000 011000                    NOP     0

      271     5684    4                   LAST_DBK = UWA.DIR_REF;

   5684  6 000424   000036 235000 xsym               LDA     UWA+30
         6 000425   000000 755000 xsym               STA     LAST_DBK

      272     5685    4                   IF (ZI$DIR.AUTODUMP OR ZI$DIR.AREA_NM.NAME.TEXT~=' ')

   5685  6 000426   004305 236000 0                  LDQ     ZI$DIR+22
         6 000427   400000 316007                    CANQ    -131072,DL
         6 000430   000435 601000 6                  TNZ     s:5685+7
         6 000431   040000 106400                    CMPC    fill='040'O
         6 000432   004513 200036 0                  ADSC9   ZI$DIR+156               cn=1,n=30
         6 000433   000034 000001 7                  ADSC9   28                       cn=0,n=1
         6 000434   000444 600000 6                  TZE     s:5690
         6 000435   004404 236000 0                  LDQ     ZI$DIR+85
         6 000436   000002 316007                    CANQ    2,DL
         6 000437   000444 601000 6                  TNZ     s:5690

      273     5686    4                      AND NOT ZI$DIR.RESTR THEN
      274     5687    4                       CALL GET_NXT_AC(LAST_AREA) ALTRET(ALTEND_ZIU$Q2UT);

   5687  6 000440   000044 630400 7                  EPPR0   36
         6 000441   000035 631400 7                  EPPR1   29
         6 000442   000000 701000 xent               TSX1    GET_NXT_AC
         6 000443   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      275     5688    4                   END;

      276     5689    3               END;

      277     5690    2           IF SCHEMA_ACTIVE=%NO# THEN
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:42   

   5690  6 000444   004546 234000 0                  SZN     SCHEMA_ACTIVE
         6 000445   000475 604000 6                  TMI     s:5706

      278     5691    3           DO; /* READY THE SCHEMA AND BUILD THE RVA */

      279     5692    3               CALL ZIU$Q2SC(ZI$DIR.AREA_NM.NAME.TEXT,

   5692  6 000446   000045 630400 7                  EPPR0   37
         6 000447   000004 631400 7                  EPPR1   4
         6 000450   000000 701000 xent               TSX1    ZIU$Q2SC
         6 000451   001045 702000 6                  TSX2    RESTRT

      280     5693    3                  ZI$DIR.SCHEMA_NM.NAME.TEXT) ALTRET(RESTRT);
      281     5694    3               IF (ZI$DIR.AUTODUMP OR ZI$DIR.AREA_NM.NAME.TEXT~=' ')

   5694  6 000452   004305 236000 0                  LDQ     ZI$DIR+22
         6 000453   400000 316007                    CANQ    -131072,DL
         6 000454   000461 601000 6                  TNZ     s:5694+7
         6 000455   040000 106400                    CMPC    fill='040'O
         6 000456   004513 200036 0                  ADSC9   ZI$DIR+156               cn=1,n=30
         6 000457   000034 000001 7                  ADSC9   28                       cn=0,n=1
         6 000460   000470 600000 6                  TZE     s:5697
         6 000461   004404 236000 0                  LDQ     ZI$DIR+85
         6 000462   000002 316007                    CANQ    2,DL
         6 000463   000470 601000 6                  TNZ     s:5697

      282     5695    3                  AND NOT ZI$DIR.RESTR THEN
      283     5696    3                   CALL GET_NXT_AC(LAST_AREA) ALTRET(ALTEND_ZIU$Q2UT);

   5696  6 000464   000044 630400 7                  EPPR0   36
         6 000465   000035 631400 7                  EPPR1   29
         6 000466   000000 701000 xent               TSX1    GET_NXT_AC
         6 000467   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      284     5697    3               SCHEMA_ACTIVE=%YES#;

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:43   
   5697  6 000470   400000 236003                    LDQ     -131072,DU
         6 000471   004546 756000 0                  STQ     SCHEMA_ACTIVE

      285     5698    3               CURR_SCHNM = ZI$DIR.SCHEMA_NM.NAME.TEXT;

   5698  6 000472   040000 100400                    MLR     fill='040'O
         6 000473   004502 200036 0                  ADSC9   ZI$DIR+147               cn=1,n=30
         6 000474   004016 000036 0                  ADSC9   CURR_SCHNM               cn=0,n=30

      286     5699    3               END;

      287     5700    2           END;

      288     5701        /**/
      289     5702        /*
      290     5703                 Procedure  for DUMP  and LOAD ('ALL' area option not allowed).
      291     5704        */
      292     5705
      293     5706    1       IF ZI$DIR.LOAD OR ZI$DIR.UNLOAD THEN

   5706  6 000475   004257 236000 0                  LDQ     ZI$DIR
         6 000476   040000 316003                    CANQ    16384,DU
         6 000477   000502 601000 6                  TNZ     s:5708
         6 000500   020000 316003                    CANQ    8192,DU
         6 000501   000574 600000 6                  TZE     s:5736

      294     5707    2       DO;

      295     5708    2           MERGESF = %YES#;

   5708  6 000502   400000 236003                    LDQ     -131072,DU
         6 000503   007121 756000 0                  STQ     MERGESF

      296     5709    2           CALL GET_DCB(ZI$DIR.SRCE_NM) ALTRET(ALTEND_ZIU$Q2UT);

   5709  6 000504   000047 630400 7                  EPPR0   39
         6 000505   000035 631400 7                  EPPR1   29
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:44   
         6 000506   000000 701000 xent               TSX1    GET_DCB
         6 000507   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      297     5710    2           IF DCBADDR(DCBSF)->F$DCB.ASN# = %TAPE# AND

   5710  6 000510   000050 470400 7                  LDP0    40
         6 000511   000000 471500                    LDP1    0,,PR0
         6 000512   006660 220000 0                  LDX0    DCBSF
         6 000513   100000 473510                    LDP3    0,X0,PR1
         6 000514   300032 236100                    LDQ     26,,PR3
         6 000515   777000 376007                    ANQ     -512,DL
         6 000516   002000 116007                    CMPQ    1024,DL
         6 000517   000526 601000 6                  TNZ     s:5713
         6 000520   040000 106500                    CMPC    fill='040'O
         6 000521   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         6 000522   007131 400006 0                  ADSC9   PSNSF                    cn=2,n=6
         6 000523   000526 600000 6                  TZE     s:5713

      298     5711    2              DCBADDR(DCBSF)->F$DCB.PSN# ~= PSNSF.SN# THEN
      299     5712    2               PSNSF.VOL# = 0;

   5712  6 000524   000000 236003                    LDQ     0,DU
         6 000525   007131 552040 0                  STBQ    PSNSF,'40'O

      300     5713    2           CALL SYS_FUNC_RELDCB;

   5713  6 000526   000000 631400 7                  EPPR1   0
         6 000527   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         6 000530   000000 011000                    NOP     0

      301     5714    2           MERGESF = %NO#;

   5714  6 000531   007121 450000 0                  STZ     MERGESF

      302     5715    2           CALL GET_DCB(ZI$DIR.SRCE_NM) ALTRET(ALTEND_ZIU$Q2UT);

   5715  6 000532   000047 630400 7                  EPPR0   39
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:45   
         6 000533   000035 631400 7                  EPPR1   29
         6 000534   000000 701000 xent               TSX1    GET_DCB
         6 000535   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      303     5716    2           MERGESF = %YES#;

   5716  6 000536   400000 236003                    LDQ     -131072,DU
         6 000537   007121 756000 0                  STQ     MERGESF

      304     5717    2           CALL GET_DCB(ZI$DIR.DEST_NM) ALTRET(ALTEND_ZIU$Q2UT);

   5717  6 000540   000051 630400 7                  EPPR0   41
         6 000541   000035 631400 7                  EPPR1   29
         6 000542   000000 701000 xent               TSX1    GET_DCB
         6 000543   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      305     5718    2           IF DCBADDR(DCBSF)->F$DCB.ASN# = %TAPE# AND

   5718  6 000544   000050 470400 7                  LDP0    40
         6 000545   000000 471500                    LDP1    0,,PR0
         6 000546   006660 220000 0                  LDX0    DCBSF
         6 000547   100000 473510                    LDP3    0,X0,PR1
         6 000550   300032 236100                    LDQ     26,,PR3
         6 000551   777000 376007                    ANQ     -512,DL
         6 000552   002000 116007                    CMPQ    1024,DL
         6 000553   000562 601000 6                  TNZ     s:5728
         6 000554   040000 106500                    CMPC    fill='040'O
         6 000555   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
         6 000556   007131 400006 0                  ADSC9   PSNSF                    cn=2,n=6
         6 000557   000562 600000 6                  TZE     s:5728

      306     5719    2              DCBADDR(DCBSF)->F$DCB.PSN# ~= PSNSF.SN# THEN
      307     5720    2               PSNSF.VOL# = 0;

   5720  6 000560   000000 236003                    LDQ     0,DU
         6 000561   007131 552040 0                  STBQ    PSNSF,'40'O

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:46   
      308     5721        /* The following lines of code seem to serve no purpose...
      309     5722          this code seemed to cause $14573... but were not sure if any
      310     5723         side effects will not occur...can be deleted for C00...
      311     5724                    CALL SYS_FUNC_RELDCB;
      312     5725                    MERGESF = %NO#;
      313     5726                    CALL GET_DCB(ZI$DIR.DEST_NM) ALTRET(ALTEND_ZIU$Q2UT);
      314     5727        */
      315     5728    2           IF ZI$DIR.LOAD THEN

   5728  6 000562   004257 236000 0                  LDQ     ZI$DIR
         6 000563   040000 316003                    CANQ    16384,DU
         6 000564   000571 600000 6                  TZE     s:5731

      316     5729    2               CALL ZIU$LOAD ALTRET(ALTEND_ZIU$Q2UT);

   5729  6 000565   000000 631400 7                  EPPR1   0
         6 000566   000000 701000 xent               TSX1    ZIU$LOAD
         6 000567   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000570   000574 710000 6                  TRA     s:5736

      317     5730    2           ELSE
      318     5731    2               CALL ZIU$DUMP ALTRET(ALTEND_ZIU$Q2UT);

   5731  6 000571   000000 631400 7                  EPPR1   0
         6 000572   000000 701000 xent               TSX1    ZIU$DUMP
         6 000573   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      319     5732    2           END;

      320     5733        /*
      321     5734              Procedure for INIT,PRINT,KEY REBUILD AND INVENTORY REBUILD.
      322     5735        */
      323     5736    2       DO WHILE(~LAST_AREA);

   5736  6 000574   001020 710000 6                  TRA     s:5797

      324     5737    2           IF ZI$DIR.AREA_NM.NAME.TEXT~=' ' THEN
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:47   

   5737  6 000575   040000 106400                    CMPC    fill='040'O
         6 000576   004513 200036 0                  ADSC9   ZI$DIR+156               cn=1,n=30
         6 000577   000034 000001 7                  ADSC9   28                       cn=0,n=1
         6 000600   000603 600000 6                  TZE     s:5739

      325     5738    2               MERGESF = %YES#;

   5738  6 000601   400000 236003                    LDQ     -131072,DU
         6 000602   007121 756000 0                  STQ     MERGESF

      326     5739    2           CALL GET_DCB(ZI$DIR.AREA_NM) ALTRET(ALTEND_ZIU$Q2UT);

   5739  6 000603   000036 630400 7                  EPPR0   30
         6 000604   000035 631400 7                  EPPR1   29
         6 000605   000000 701000 xent               TSX1    GET_DCB
         6 000606   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      327     5740    3           DO CASE(ZI$DIR.CODE);

   5740  6 000607   004404 236000 0                  LDQ     ZI$DIR+85
         6 000610   000020 772000                    QRL     16
         6 000611   000037 376007                    ANQ     31,DL
         6 000612   000037 116007                    CMPQ    31,DL
         6 000613   000615 602006 6                  TNC     s:5740+6,QL
         6 000614   000770 710000 6                  TRA     s:5784
         6 000615   000770 710000 6                  TRA     s:5784
         6 000616   000770 710000 6                  TRA     s:5784
         6 000617   000770 710000 6                  TRA     s:5784
         6 000620   000654 710000 6                  TRA     s:5742
         6 000621   000660 710000 6                  TRA     s:5744
         6 000622   000720 710000 6                  TRA     s:5763
         6 000623   000770 710000 6                  TRA     s:5784
         6 000624   000770 710000 6                  TRA     s:5784
         6 000625   000714 710000 6                  TRA     s:5761
         6 000626   000724 710000 6                  TRA     s:5765
         6 000627   000736 710000 6                  TRA     s:5772
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:48   
         6 000630   000742 710000 6                  TRA     s:5774
         6 000631   000770 710000 6                  TRA     s:5784
         6 000632   000664 710000 6                  TRA     s:5746
         6 000633   000674 710000 6                  TRA     s:5752
         6 000634   000704 710000 6                  TRA     s:5756
         6 000635   000710 710000 6                  TRA     s:5759
         6 000636   000700 710000 6                  TRA     s:5754
         6 000637   000670 710000 6                  TRA     s:5749
         6 000640   000670 710000 6                  TRA     s:5749
         6 000641   000670 710000 6                  TRA     s:5749
         6 000642   000670 710000 6                  TRA     s:5749
         6 000643   000670 710000 6                  TRA     s:5749
         6 000644   000770 710000 6                  TRA     s:5784
         6 000645   000770 710000 6                  TRA     s:5784
         6 000646   000770 710000 6                  TRA     s:5784
         6 000647   000770 710000 6                  TRA     s:5784
         6 000650   000770 710000 6                  TRA     s:5784
         6 000651   000770 710000 6                  TRA     s:5784
         6 000652   000770 710000 6                  TRA     s:5784
         6 000653   000746 710000 6                  TRA     s:5776

      328     5741    3           CASE(#INIT);

      329     5742    3               CALL ZIU$Q2IN ALTRET(ALTEND_ZIU$Q2UT);

   5742  6 000654   000000 631400 7                  EPPR1   0
         6 000655   000000 701000 xent               TSX1    ZIU$Q2IN
         6 000656   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000657   000772 710000 6                  TRA     s:5786

      330     5743    3           CASE(#PRINT);

      331     5744    3               CALL ZIU$Q2PR ALTRET(ALTEND_ZIU$Q2UT);

   5744  6 000660   000000 631400 7                  EPPR1   0
         6 000661   000000 701000 xent               TSX1    ZIU$Q2PR
         6 000662   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:49   
         6 000663   000772 710000 6                  TRA     s:5786

      332     5745    3           CASE(#REPAIR);

      333     5746    3               CALL ZIU$Q2RP ALTRET(ALTEND_ZIU$Q2UT);

   5746  6 000664   000000 631400 7                  EPPR1   0
         6 000665   000000 701000 xent               TSX1    ZIU$Q2RP
         6 000666   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      334     5747    3               GOTO RESTRT;

   5747  6 000667   001045 710000 6                  TRA     RESTRT

      335     5748    3           CASE(#COMPACT,#CONVERT,#RESORT,#REBUILDPA,#REVERT);

      336     5749    3               CALL ZIU$PA_ROOT ALTRET(ALTEND_ZIU$Q2UT);

   5749  6 000670   000000 631400 7                  EPPR1   0
         6 000671   000000 701000 xent               TSX1    ZIU$PA_ROOT
         6 000672   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      337     5750    3               GOTO RESTRT;

   5750  6 000673   001045 710000 6                  TRA     RESTRT

      338     5751    3           CASE(#CHECK);

      339     5752    3               CALL ZIU$CHECK ALTRET(ALTEND_ZIU$Q2UT);

   5752  6 000674   000000 631400 7                  EPPR1   0
         6 000675   000000 701000 xent               TSX1    ZIU$CHECK
         6 000676   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000677   000772 710000 6                  TRA     s:5786

      340     5753    3           CASE(#REPORT);

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:50   
      341     5754    3               CALL ZIU$REPRT ALTRET(ALTEND_ZIU$Q2UT);

   5754  6 000700   000000 631400 7                  EPPR1   0
         6 000701   000000 701000 xent               TSX1    ZIU$REPRT
         6 000702   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000703   000772 710000 6                  TRA     s:5786

      342     5755    3           CASE(#VALIDATE);

      343     5756    3               CALL ZIU$VALSET ALTRET(ALTEND_ZIU$Q2UT);

   5756  6 000704   000000 631400 7                  EPPR1   0
         6 000705   000000 701000 xent               TSX1    ZIU$VALSET
         6 000706   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      344     5757    3               GOTO RESTRT;

   5757  6 000707   001045 710000 6                  TRA     RESTRT

      345     5758    3           CASE(#SNAP);

      346     5759    3               CALL ZIU$SNAP ALTRET(ALTEND_ZIU$Q2UT);

   5759  6 000710   000000 631400 7                  EPPR1   0
         6 000711   000000 701000 xent               TSX1    ZIU$SNAP
         6 000712   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000713   000772 710000 6                  TRA     s:5786

      347     5760    3           CASE(#KEYRBLD);

      348     5761    3               CALL ZIU$KEYBLD ALTRET(ALTEND_ZIU$Q2UT);

   5761  6 000714   000000 631400 7                  EPPR1   0
         6 000715   000000 701000 xent               TSX1    ZIU$KEYBLD
         6 000716   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000717   000772 710000 6                  TRA     s:5786

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:51   
      349     5762    3           CASE(#INV_RBD);

      350     5763    3               CALL ZIU$INRBT ALTRET(ALTEND_ZIU$Q2UT);

   5763  6 000720   000000 631400 7                  EPPR1   0
         6 000721   000000 701000 xent               TSX1    ZIU$INRBT
         6 000722   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000723   000772 710000 6                  TRA     s:5786

      351     5764    3           CASE(#ROLL);

      352     5765    3               IF XREF_BUILT = %YES# THEN

   5765  6 000724   000000 234000 xsym               SZN     XREF_BUILT
         6 000725   000732 605000 6                  TPL     s:5770

      353     5766    4               DO;

      354     5767    4                   CALL FREE_DYN_MEM;

   5767  6 000726   000000 631400 7                  EPPR1   0
         6 000727   000000 701000 xent               TSX1    FREE_DYN_MEM
         6 000730   000000 011000                    NOP     0

      355     5768    4                   XREF_BUILT = %NO#;

   5768  6 000731   000000 450000 xsym               STZ     XREF_BUILT

      356     5769    4                   END;

      357     5770    3               CALL ZIU$ROLL ALTRET(ALTEND_ZIU$Q2UT);

   5770  6 000732   000000 631400 7                  EPPR1   0
         6 000733   000000 701000 xent               TSX1    ZIU$ROLL
         6 000734   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000735   000772 710000 6                  TRA     s:5786

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:52   
      358     5771    3           CASE(#LOCK);

      359     5772    3               CALL ZIU$LOCK ALTRET(ALTEND_ZIU$Q2UT);

   5772  6 000736   000000 631400 7                  EPPR1   0
         6 000737   000000 701000 xent               TSX1    ZIU$LOCK
         6 000740   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000741   000772 710000 6                  TRA     s:5786

      360     5773    3           CASE(#UNLOCK);

      361     5774    3               CALL ZIU$UNLCK ALTRET(ALTEND_ZIU$Q2UT);

   5774  6 000742   000000 631400 7                  EPPR1   0
         6 000743   000000 701000 xent               TSX1    ZIU$UNLCK
         6 000744   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT
         6 000745   000772 710000 6                  TRA     s:5786

      362     5775    3           CASE(#TESTLOCK);

      363     5776    3               CALL ZIU$TESTLOCK ALTRET(ALTEND_ZIU$Q2UT);

   5776  6 000746   000000 631400 7                  EPPR1   0
         6 000747   000000 701000 xent               TSX1    ZIU$TESTLOCK
         6 000750   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      364     5777    3               IF STEPCC = 6 AND

   5777  6 000751   006624 235000 0                  LDA     STEPCC
         6 000752   000006 115007                    CMPA    6,DL
         6 000753   000772 601000 6                  TNZ     s:5786
         6 000754   000000 470400 xsym               LDP0    B$JIT$
         6 000755   000151 236100                    LDQ     105,,PR0
         6 000756   000777 376003                    ANQ     511,DU
         6 000757   000003 116003                    CMPQ    3,DU
         6 000760   000772 600000 6                  TZE     s:5786

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:53   
      365     5778    3                  B$JIT.NEXTCC ~= %CC_FROMUC#
      366     5779    4               THEN DO;

      367     5780    4                   FPT_EXIT.V.STEPCC# = STEPCC;

   5780  6 000761   006624 236000 0                  LDQ     STEPCC
         6 000762   000033 736000                    QLS     27
         6 000763   006574 552040 0                  STBQ    FPT_EXIT+4,'40'O

      368     5781    4                   CALL M$EXIT(FPT_EXIT);

   5781  6 000764   006570 630400 0                  EPPR0   FPT_EXIT
         6 000765   000001 713400                    CLIMB   exit
         6 000766   400400 401760                    pmme    nvectors=2

      369     5782    4                   END;

   5782  6 000767   000772 710000 6                  TRA     s:5786

      370     5783    3           CASE(ELSE);

      371     5784    3               LAST_AREA = %YES#; /* ENSURE EXIT FROM LOOP */

   5784  6 000770   400000 236003                    LDQ     -131072,DU
         6 000771   000000 756000 0                  STQ     LAST_AREA

      372     5785    3               END;

      373     5786    2           IF ZI$DIR.AREA_NM.NAME.TEXT~=' ' THEN

   5786  6 000772   040000 106400                    CMPC    fill='040'O
         6 000773   004513 200036 0                  ADSC9   ZI$DIR+156               cn=1,n=30
         6 000774   000034 000001 7                  ADSC9   28                       cn=0,n=1
         6 000775   001003 600000 6                  TZE     s:5793

      374     5787    3           DO;

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:54   
      375     5788    3    /**/       DCBSF = ZI$DIR.AREA_NM.DCB#;

   5788  6 000776   004523 220000 0                  LDX0    ZI$DIR+164
         6 000777   006660 740000 0                  STX0    DCBSF

      376     5789    3               CALL SYS_FUNC_RELDCB ALTRET(ALTEND_ZIU$Q2UT);

   5789  6 001000   000000 631400 7                  EPPR1   0
         6 001001   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         6 001002   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      377     5790    3               END;

      378     5791         /* we don't want to goto the next area if FOLLOW
      379     5792            was specified */
      380     5793    2           IF ZI$DIR.AUTODUMP AND ZI$DIR.FSET = '0'B THEN

   5793  6 001003   004305 236000 0                  LDQ     ZI$DIR+22
         6 001004   400000 316007                    CANQ    -131072,DL
         6 001005   001016 600000 6                  TZE     s:5796
         6 001006   004404 236000 0                  LDQ     ZI$DIR+85
         6 001007   000010 316003                    CANQ    8,DU
         6 001010   001016 601000 6                  TNZ     s:5796

      381     5794    2               CALL GET_NXT_AC(LAST_AREA);

   5794  6 001011   000044 630400 7                  EPPR0   36
         6 001012   000035 631400 7                  EPPR1   29
         6 001013   000000 701000 xent               TSX1    GET_NXT_AC
         6 001014   000000 011000                    NOP     0
         6 001015   001020 710000 6                  TRA     s:5797

      382     5795    2           ELSE
      383     5796    2               LAST_AREA = %YES#;

   5796  6 001016   400000 236003                    LDQ     -131072,DU
         6 001017   000000 756000 0                  STQ     LAST_AREA
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:55   

      384     5797    2           END;

   5797  6 001020   000000 236000 0                  LDQ     LAST_AREA
         6 001021   400000 376003                    ANQ     -131072,DU
         6 001022   400000 676003                    ERQ     -131072,DU
         6 001023   000575 601000 6                  TNZ     s:5737

      385     5798    1       IF ZI$DIR.CODE = #CHECK OR ZI$DIR.CHECK = %YES# THEN

   5798  6 001024   004404 236000 0                  LDQ     ZI$DIR+85
         6 001025   000030 376000 7                  ANQ     24
         6 001026   000052 116000 7                  CMPQ    42
         6 001027   001032 600000 6                  TZE     s:5800
         6 001030   004404 430000 0                  FSZN    ZI$DIR+85
         6 001031   001045 605000 6                  TPL     RESTRT

      386     5799    2       DO;

      387     5800    2           CALL REPORT_CHK ALTRET(ALTEND_ZIU$Q2UT);

   5800  6 001032   000000 631400 7                  EPPR1   0
         6 001033   000000 701000 xent               TSX1    REPORT_CHK
         6 001034   001050 702000 6                  TSX2    ALTEND_ZIU$Q2UT

      388     5801    2           IF STEPCC = 0 AND FPT_EXIT.V.STEPCC# <4 THEN

   5801  6 001035   006624 235000 0                  LDA     STEPCC
         6 001036   001045 601000 6                  TNZ     RESTRT
         6 001037   006574 236000 0                  LDQ     FPT_EXIT+4
         6 001040   777000 376003                    ANQ     -512,DU
         6 001041   004000 116003                    CMPQ    2048,DU
         6 001042   001045 603000 6                  TRC     RESTRT

      389     5802    2               FPT_EXIT.V.STEPCC# = 0; /* RESET GLOBAL STEPCC */

   5802  6 001043   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:56   
         6 001044   006574 552040 0                  STBQ    FPT_EXIT+4,'40'O

      390     5803    2           END;

      391     5804    1   RESTRT: IF CCBUF_ON THEN

   5804  6 001045   000002 234000 0     RESTRT       SZN     CCBUF_ON
         6 001046   001203 604000 6                  TMI     END_ZIU$Q2UT

      392     5805    1           GOTO END_ZIU$Q2UT;
      393     5806    1       ELSE
      394     5807    1           GOTO ZIU$Q2UT_STRT;

   5807  6 001047   000100 710000 6                  TRA     ZIU$Q2UT_STRT

      395     5808    1   ALTEND_ZIU$Q2UT:
      396     5809    1       IF DCBADDR(DCBNUM(M$SI))->F$DCB.TYC.EOF# THEN /*End of file*/

   5809  6 001050   000000 236007 xsym  ALTEND_ZIU$* LDQ     M$SI,DL
         6 001051   000050 470400 7                  LDP0    40
         6 001052   000000 471500                    LDP1    0,,PR0
         6 001053   100000 473506                    LDP3    0,QL,PR1
         6 001054   300002 236100                    LDQ     2,,PR3
         6 001055   004000 316003                    CANQ    2048,DU
         6 001056   001114 600000 6                  TZE     s:5823

      397     5810    2       DO;

      398     5811    2           BUFFER.TEXT='DIRECTIVE END OF FILE';

   5811  6 001057   040000 100400                    MLR     fill='040'O
         6 001060   000017 000025 5                  ADSC9   15                       cn=0,n=21
         6 001061   003735 200203 0                  ADSC9   BUFFER                   cn=1,n=131

      399     5812    2    /**/   DCBSF = DCBNUM(M$LO);

   5812  6 001062   000000 236007 xsym               LDQ     M$LO,DL
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:57   
         6 001063   000000 620006                    EAX0    0,QL
         6 001064   006660 740000 0                  STX0    DCBSF

      400     5813    2    /**/   BUFSF = VECTOR(BUFFER);

   5813  6 001065   000012 237000 7                  LDAQ    10
         6 001066   006777 755000 0                  STA     BUFSF
         6 001067   007000 756000 0                  STQ     BUFSF+1

      401     5814    2    /**/   BUFLNSF = 60;

   5814  6 001070   000074 235007                    LDA     60,DL
         6 001071   006776 755000 0                  STA     BUFLNSF

      402     5815    2           CALL SYS_FUNC_WRIT;

   5815  6 001072   000000 631400 7                  EPPR1   0
         6 001073   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 001074   000000 011000                    NOP     0

      403     5816    2    /**/   BUFSF = VECTOR(BLANK);

   5816  6 001075   000014 237000 7                  LDAQ    12
         6 001076   006777 755000 0                  STA     BUFSF
         6 001077   007000 756000 0                  STQ     BUFSF+1

      404     5817    2    /**/   BUFLNSF = 1;

   5817  6 001100   000001 235007                    LDA     1,DL
         6 001101   006776 755000 0                  STA     BUFLNSF

      405     5818    2           CALL SYS_FUNC_WRIT;

   5818  6 001102   000000 631400 7                  EPPR1   0
         6 001103   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 001104   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:58   
      406     5819    2    /**/   DCBSF= DCBNUM(M$SI);

   5819  6 001105   000000 236007 xsym               LDQ     M$SI,DL
         6 001106   000000 620006                    EAX0    0,QL
         6 001107   006660 740000 0                  STX0    DCBSF

      407     5820    2           CALL SYS_FUNC_CLOS;

   5820  6 001110   000000 631400 7                  EPPR1   0
         6 001111   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         6 001112   000000 011000                    NOP     0

      408     5821    2           GOTO END_ZIU$Q2UT;

   5821  6 001113   001203 710000 6                  TRA     END_ZIU$Q2UT

      409     5822    2           END;
      410     5823    1       IF STEPCC > 9 THEN /* IF THE DIRECTIVE SET ABORT STEPCC */

   5823  6 001114   006624 235000 0                  LDA     STEPCC
         6 001115   000011 115007                    CMPA    9,DL
         6 001116   001133 604400 6                  TMOZ    s:5834

      411     5824    2       DO;

      412     5825        /*E* ERROR: ZIU-DBU#XXX-5
      413     5826        MESSAGE: M$XXX is issued by DBUTIL.
      414     5827                 Critical errors occurred during the last directive. */
      415     5828    2           ERRCODESF.ERR# = DBU#XXX;

   5828  6 001117   007016 236000 0                  LDQ     ERRCODESF
         6 001120   000053 376000 7                  ANQ     43
         6 001121   220120 276007                    ORQ     73808,DL
         6 001122   007016 756000 0                  STQ     ERRCODESF

      416     5829    2           MSGCODE = ERRCODE_RDEF;

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:59   
   5829  6 001123   007017 756000 0                  STQ     MSGCODE

      417     5830    2           ERRFLGSF = 5; /* 5 STARS MSG */

   5830  6 001124   005000 236003                    LDQ     2560,DU
         6 001125   007120 756000 0                  STQ     ERRFLGSF

      418     5831    2           CALL SYS_FUNC_ERRMSG;

   5831  6 001126   000000 631400 7                  EPPR1   0
         6 001127   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         6 001130   000000 011000                    NOP     0

      419     5832    2           CALL M$XXX;

   5832  6 001131   000003 713400                    CLIMB   3
         6 001132   000000 401760                    pmme    nvectors=0

      420     5833    2           END;

      421     5834    1       IF STEPCC=0 THEN STEPCC=7; /* SET IT IF NOT ALREADY SET */

   5834  6 001133   006624 235000 0                  LDA     STEPCC
         6 001134   001137 601000 6                  TNZ     s:5835

   5834  6 001135   000007 236007                    LDQ     7,DL
         6 001136   006624 756000 0                  STQ     STEPCC

      422     5835    1       IF STEPCC>FPT_EXIT.V.STEPCC# THEN

   5835  6 001137   006574 236000 0                  LDQ     FPT_EXIT+4
         6 001140   000033 772000                    QRL     27
         6 001141   006624 116000 0                  CMPQ    STEPCC
         6 001142   001146 605000 6                  TPL     s:5837

      423     5836    1           FPT_EXIT.V.STEPCC#=STEPCC;

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:60   
   5836  6 001143   006624 236000 0                  LDQ     STEPCC
         6 001144   000033 736000                    QLS     27
         6 001145   006574 552040 0                  STBQ    FPT_EXIT+4,'40'O

      424     5837    1       IF DCBADDR(DCBNUM(M$SI)) -> F$DCB.TYC.IOERR# THEN

   5837  6 001146   000000 236007 xsym               LDQ     M$SI,DL
         6 001147   000050 470400 7                  LDP0    40
         6 001150   000000 471500                    LDP1    0,,PR0
         6 001151   100000 473506                    LDP3    0,QL,PR1
         6 001152   300002 430100                    FSZN    2,,PR3
         6 001153   001174 605000 6                  TPL     s:5847

      425     5838    2       DO;

      426     5839    2           BUFFER.TEXT = '**** I/O ERROR ON DIRECTIVE INPUT';

   5839  6 001154   040000 100400                    MLR     fill='040'O
         6 001155   000025 000041 5                  ADSC9   21                       cn=0,n=33
         6 001156   003735 200203 0                  ADSC9   BUFFER                   cn=1,n=131

      427     5840    2    /**/   DCBSF = DCBNUM(M$LO);

   5840  6 001157   000000 236007 xsym               LDQ     M$LO,DL
         6 001160   000000 620006                    EAX0    0,QL
         6 001161   006660 740000 0                  STX0    DCBSF

      428     5841    2    /**/   VFCSF = %NO#;

   5841  6 001162   006773 450000 0                  STZ     VFCSF

      429     5842    2    /**/   BUFSF = VECTOR(BUFFER.TEXT);

   5842  6 001163   000054 237000 7                  LDAQ    44
         6 001164   006777 755000 0                  STA     BUFSF
         6 001165   007000 756000 0                  STQ     BUFSF+1

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:61   
      430     5843    2    /**/   BUFLNSF = 50;

   5843  6 001166   000062 235007                    LDA     50,DL
         6 001167   006776 755000 0                  STA     BUFLNSF

      431     5844    2           CALL SYS_FUNC_WRIT;

   5844  6 001170   000000 631400 7                  EPPR1   0
         6 001171   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         6 001172   000000 011000                    NOP     0

      432     5845    2           GOTO STEP_EXIT;

   5845  6 001173   001231 710000 6                  TRA     STEP_EXIT

      433     5846    2           END;
      434     5847    1       ZI$DIR.HELP=0;

   5847  6 001174   003000 060400                    CSL     bolr='003'O
         6 001175   000000 000044 7                  BDSC    0                        by=0,bit=0,n=36
         6 001176   004257 240044 0                  BDSC    ZI$DIR                   by=1,bit=4,n=36

      435     5848    1       ZI$DIR.HELP_SVRITY=0;

   5848  6 001177   003000 060400                    CSL     bolr='003'O
         6 001200   000000 000044 7                  BDSC    0                        by=0,bit=0,n=36
         6 001201   004260 240044 0                  BDSC    ZI$DIR+1                 by=1,bit=4,n=36

      436     5849    1       GOTO RESTRT;

   5849  6 001202   001045 710000 6                  TRA     RESTRT

      437     5850    1   END_ZIU$Q2UT:
      438     5851    1       IF SCHEMA_ACTIVE THEN

   5851  6 001203   004546 234000 0     END_ZIU$Q2UT SZN     SCHEMA_ACTIVE
         6 001204   001210 605000 6                  TPL     s:5853
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:62   

      439     5852    1           CALL DB_FUNC_FIN;

   5852  6 001205   000000 631400 7                  EPPR1   0
         6 001206   000000 701000 xent               TSX1    DB_FUNC_FIN
         6 001207   000000 011000                    NOP     0

      440     5853    1       IF XREF_BUILT = %YES# THEN

   5853  6 001210   000000 234000 xsym               SZN     XREF_BUILT
         6 001211   001215 605000 6                  TPL     s:5855

      441     5854    1           CALL FREE_DYN_MEM;

   5854  6 001212   000000 631400 7                  EPPR1   0
         6 001213   000000 701000 xent               TSX1    FREE_DYN_MEM
         6 001214   000000 011000                    NOP     0

      442     5855    1       DCBSF=DCBNUM(M$SI);

   5855  6 001215   000000 236007 xsym               LDQ     M$SI,DL
         6 001216   000000 620006                    EAX0    0,QL
         6 001217   006660 740000 0                  STX0    DCBSF

      443     5856    1       CALL SYS_FUNC_CLOS;

   5856  6 001220   000000 631400 7                  EPPR1   0
         6 001221   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         6 001222   000000 011000                    NOP     0

      444     5857    1       DCBSF=DCBNUM(M$LO);

   5857  6 001223   000000 236007 xsym               LDQ     M$LO,DL
         6 001224   000000 620006                    EAX0    0,QL
         6 001225   006660 740000 0                  STX0    DCBSF

      445     5858    1       CALL SYS_FUNC_CLOS;
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:63   

   5858  6 001226   000000 631400 7                  EPPR1   0
         6 001227   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         6 001230   000000 011000                    NOP     0

      446     5859    1   STEP_EXIT:
      447     5860    1       CALL M$EXIT (FPT_EXIT);

   5860  6 001231   006570 630400 0     STEP_EXIT    EPPR0   FPT_EXIT
         6 001232   000001 713400                    CLIMB   exit
         6 001233   400400 401760                    pmme    nvectors=2

      448     5861    1   END ZIU$Q2UT;

   5861  6 001234   000000 702200 xent               TSX2  ! X66_MARET

PRINT_HDR
 Sect OctLoc
   0     001   0***** ******                                                    ....

TYPE
 Sect OctLoc
   0     006   ****** ******   ****** ******   ****** ******   ****** ******    ................

SI_DCB
 Sect OctLoc
   0    3730   000000 ******                                                    ....

LO_DCB
 Sect OctLoc
   0    3731   000000 ******                                                    ....

UC_DCB
 Sect OctLoc
   0    3732   000000 ******                                                    ....

BUFFER
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:64   
 Sect OctLoc
   0    3735   102040 040040   040040 040040   040040 040040   040040 040040    B
   0    3741   040040 040040   040040 040040   040040 040040   040040 040040
   0    3775*  040040 040040

OUTPUT_STEPCC
 Sect OctLoc
   0    3776   102040 040114   141163 164040   144151 162145   143164 151166    B  Last directiv
   0    4002   145040 123124   105120 103103   040075 040***   056040 040110    e STEPCC = ..  H
   0    4006   151147 150145   163164 040123   124105 120103   103040 075040    ighest STEPCC =
   0    4012   ***056 040040                                                    ..

FIR_LOOP_SW
 Sect OctLoc
   0    4013   000000 000000                                                    ....

CURR_SCHNM
 Sect OctLoc
   0    4016   040040 040040   040040 040040   040040 040040   040040 040040
   0    4022   040040 040040   040040 040040   040040 040040   040040 040040

PPG#
 Sect OctLoc
   0    4026   000000 000000                                                    ....

EX_RPT_HDR
 Sect OctLoc
   0    4030   162126 105122   040052 052052   052052 052040   040040 040040    rVER ******
   0    4034   040102 125114   114040 110116   040040 040111   055104 055123     BULL HN   I-D-S
   0    4040   057111 111040   104102 125124   111114 040105   130105 103125    /II DBUTIL EXECU
   0    4044   124111 117116   040122 105120   117122 124040   040*** ******    TION REPORT  ...
   0    4050   ****** ******   ***040 120101   107105 040040   040040 040***    ..... PAGE     .

UTM6
 Sect OctLoc
   0    4054   103040 040040   040040 040040   040040 040052   052052 052052    C          *****
   0    4060   125116 122105   103117 126105   122101 102114   105040 105122    UNRECOVERABLE ER
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:65   
   0    4064   122117 122040   055040 101103   124111 126111   124131 040101    ROR - ACTIVITY A
   0    4070   102117 122124   105104 052052   052052 040040   040040 040040    BORTED****
   0    4074   040040 040040   040040 040040   040040 040040   040040 040040
   0    4114*  040040 040040

DIR_PRNT
 Sect OctLoc
   0    4115   101104 111122   105103 124111   126105 072040   040040 040040    ADIRECTIVE:
   0    4121   040040 040040   040040 040040   040040 040040   040040 040040
   0    4155*  040040 040040

RBUF
 Sect OctLoc
   0    4156   ****** ******   ****** ******   ****** ******   ****** ******    ................

BLANK
 Sect OctLoc
   0    4256   101*** ******                                                    A...

ZI$DIR
 Sect OctLoc
   0    4257   000340 000000   000000 000000   00000* 040040   040040 040040    ..........
   0    4263   040040 040040   040040 040040   040040 040040   040040 040040
   0    4303*  040040 040040   040040 040040   040040 0*****   000000 000000              ......
   0    4307   000000 000000   ****** ******   ****** ******   ****** ******    ................
   0    4403*  ****** ******   010040 140000   000040 040040   040040 040040    ..... `..
   0    4407   040040 040040   040040 040040   040040 040040   040040 040040
   0    4417*  040040 040040   040000 0*****   040040 040040   040040 040040         ...
   0    4423   040040 040040   040040 040040   040040 040040   040040 040040
   0    4477*  000000 000000   000000 000000   000000 000000   000040 040040    .............
   0    4503   040040 040040   040040 040040   040040 040040   040040 040040
   0    4507   040040 040040   040040 040040   040040 040***   000000 ******               .....
   0    4513   000040 040040   040040 040040   040040 040040   040040 040040    .
   0    4517   040040 040040   040040 040040   040040 040040   040040 040***                   .
   0    4523   000000 ******   000040 040040   040040 040040   040040 040040    .....
   0    4527   040040 040040   040040 040040   040040 040040   040040 040040
   0    4533   040040 040***   000000 ******   000040 040040   040040 040040       ......
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:66   
   0    4537   040040 040040   040040 040040   040040 040040   040040 040040
   0    4543   040040 040040   040040 040***   000000 ******                           .....

SCHEMA_ACTIVE
 Sect OctLoc
   0    4546   0***** ******                                                    ....

RECORD_LIST
 Sect OctLoc
   0    4547   ****** ******   ****** ******   ****** ******   ****** ******    ................

SET_LIST
 Sect OctLoc
   0    5007   ****** ******   ****** ******   ****** ******   ****** ******    ................

RETAIN_LIST
 Sect OctLoc
   0    5247   ****** ******   ****** ******   ****** ******   ****** ******    ................

DUMP_FID
 Sect OctLoc
   0    5507   ****** ******   ****** ******   ****** ******   ****** ******    ................

ALTKY
 Sect OctLoc
   0    5747   ****** ******   ****** ******   ****** ******   ****** ******    ................

INIT_RG
 Sect OctLoc
   0    6207   ****** ******   ****** ******   ****** ******   ****** ******    ................

KEY_RNG
 Sect OctLoc
   0    6257   ****** ******   ****** ******   ****** ******   ****** ******    ................

ITEM_LIST
 Sect OctLoc
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:67   
   0    6327   ****** ******   ****** ******   ****** ******   ****** ******    ................

FPT_EXIT
 Sect OctLoc
   0    6570   000001 777640   006574 006000   000000 177640   000000 006014    ................
   0    6574   000000 000000   000000 000000                                    ........

FPT_INT
 Sect OctLoc
   0    6576   000001 777640   006600 006000   000000 000000   000000 000000    ................

RB
 Sect OctLoc
   0    6603   000000 000000                                                    ....

RE
 Sect OctLoc
   0    6604   000000 000000                                                    ....

IE
 Sect OctLoc
   0    6605   000000 000000                                                    ....

IB
 Sect OctLoc
   0    6606   000000 000000                                                    ....

CNT
 Sect OctLoc
   0    6607   000000 000000                                                    ....

ICNT
 Sect OctLoc
   0    6610   777777 777777                                                    ....

RCNT
 Sect OctLoc
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:68   
   0    6611   777777 777777                                                    ....

SCNT
 Sect OctLoc
   0    6612   777777 777777                                                    ....

FIRST_SET
 Sect OctLoc
   0    6613   000000 000000                                                    ....

RETCNT
 Sect OctLoc
   0    6614   777777 777777                                                    ....

DMPCNT
 Sect OctLoc
   0    6615   777777 777777                                                    ....

KCNT
 Sect OctLoc
   0    6616   777777 777777                                                    ....

ACNT_IDX
 Sect OctLoc
   0    6617   777777 777777                                                    ....

I
 Sect OctLoc
   0    6620   000000 000000                                                    ....

J
 Sect OctLoc
   0    6621   000000 000000                                                    ....

K
 Sect OctLoc
   0    6622   000000 000000                                                    ....
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:69   

X
 Sect OctLoc
   0    6623   000000 000000                                                    ....

STEPCC
 Sect OctLoc
   0    6624   000000 000000                                                    ....

I_O_SIZE
 Sect OctLoc
   0    6627   000000 000000                                                    ....

KEYFID
 Sect OctLoc
   0    6631   ****** ******   ****** ******   ****** ******   ****** ******    ................

I_O_KEY
 Sect OctLoc
   0    6642   000000 000000                                                    ....

RESTART
 Sect OctLoc
   0    6643   000000 000000   000000 000000                                    ........

BREAK_FLAG
 Sect OctLoc
   0    6645   000000 000000                                                    ....

ICHKSUM
 Sect OctLoc
   0    6646   000000 000000                                                    ....

ITMCNT
 Sect OctLoc
   0    6647   000000 000000                                                    ....

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:70   
GAP1
 Sect OctLoc
   0    6650   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    6654   000000 000000                                                    ....

DCBSF
 Sect OctLoc
   0    6660   000000 ******                                                    ....

ORGSF
 Sect OctLoc
   0    6661   000000 000000                                                    ....

KEYSF
 Sect OctLoc
   0    6662   0***** ******                                                    ....

KEYVSF
 Sect OctLoc
   0    6663   ***040 040040   040040 040040   040040 040040   040040 040040    .
   0    6667   040040 040040   040040 040040   040040 040040   040040 040040
   0    6757*  040040 040040   040040 040040   040040 040040   040040 040***                   .

ACSSF
 Sect OctLoc
   0    6763   000000 000000                                                    ....

NOTIMESF
 Sect OctLoc
   0    6764   0***** ******                                                    ....

FUNSF
 Sect OctLoc
   0    6765   000000 000000                                                    ....

ASNSF
 Sect OctLoc
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:71   
   0    6766   000000 000000                                                    ....

TESTSF
 Sect OctLoc
   0    6767   0***** ******                                                    ....

XTENSIZESF
 Sect OctLoc
   0    6770   000000 000000                                                    ....

DISPSF
 Sect OctLoc
   0    6771   000000 000000                                                    ....

WAITSF
 Sect OctLoc
   0    6772   4***** ******                                                    ....

VFCSF
 Sect OctLoc
   0    6773   4***** ******                                                    ....

FULLSF
 Sect OctLoc
   0    6774   0***** ******                                                    ....

BKUPSF
 Sect OctLoc
   0    6775   0***** ******                                                    ....

BUFLNSF
 Sect OctLoc
   0    6776   000000 000000                                                    ....

BUFSF
 Sect OctLoc
   0    6777   000000 000000   000000 000000                                    ........
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:72   

SOURCESF
 Sect OctLoc
   0    7001   000000 000000                                                    ....

DESTSF
 Sect OctLoc
   0    7002   000000 000000                                                    ....

DATESF
 Sect OctLoc
   0    7003   000000 000000   000000 000000                                    ........

TIMESF
 Sect OctLoc
   0    7005   000000 000000   000000 000000                                    ........

UTSSF
 Sect OctLoc
   0    7007   000000 000000   000000 000000                                    ........

DAYSF
 Sect OctLoc
   0    7011   000000 000000   000000 000000                                    ........

TSTAMPSF
 Sect OctLoc
   0    7013   000000 000000   000000 000000                                    ........

ENCRP_SEEDSF
 Sect OctLoc
   0    7015   000000 000000                                                    ....

ERRCODESF
 Sect OctLoc
   0    7016   321125 000000                                                    .U..

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:73   
INCL_ERR
 Sect OctLoc
   0    7020   0***** ******                                                    ....

ERR_INSERT
 Sect OctLoc
   0    7021   000040 040040   040040 040040   040040 040040   040040 040040    .
   0    7025   040040 040040   040040 040040   040040 040040   040040 040***                   .
   0    7031   000040 040040   040040 040040   040040 040040   040040 040040    .
   0    7035   040040 040040   040040 040040   040040 040040   040040 040***                   .
   0    7041   000040 040040   040040 040040   040040 040040   040040 040040    .
   0    7045   040040 040040   040040 040040   040040 040040   040040 040***                   .

FIDSF_RD
 Sect OctLoc
   0    7051   040040 040040   040040 040040   040040 040040   040040 040040
   0    7055   040040 040040   040040 040040   040040 040040   040040 ******                  ..

ACNT
 Sect OctLoc
   0    7061   040040 040040   040040 040040   040040 040040   040040 040040
   0    7101*  040040 040040   040040 040040   040040 040040   040040 040040

EXISTSF
 Sect OctLoc
   0    7105   0***** ******                                                    ....

SHARESF
 Sect OctLoc
   0    7106   0***** ******                                                    ....

DCBNMSF
 Sect OctLoc
   0    7107   000000 000000   000000 000000                                    ........

KEYRSF
 Sect OctLoc
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:74   
   0    7111   0***** ******                                                    ....

NO_KEYSF
 Sect OctLoc
   0    7112   0***** ******                                                    ....

REASGNSF
 Sect OctLoc
   0    7113   4***** ******                                                    ....

CARRY_ATTRIBUTESF
 Sect OctLoc
   0    7114   4***** ******                                                    ....

SUBMESSF
 Sect OctLoc
   0    7115   0***** ******                                                    ....

SPKY_OPNSF
 Sect OctLoc
   0    7116   0***** ******                                                    ....

POSSF
 Sect OctLoc
   0    7117   000*** ******                                                    ....

ERRFLGSF
 Sect OctLoc
   0    7120   003*** ******                                                    ....

MERGESF
 Sect OctLoc
   0    7121   0***** ******                                                    ....

FSA_FLAG
 Sect OctLoc
   0    7122   0***** ******                                                    ....
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:75   

RELGSF
 Sect OctLoc
   0    7123   0***** ******                                                    ....

UNUSED
 Sect OctLoc
   0    7124   000*** ******                                                    ....

HELPCODE
 Sect OctLoc
   0    7125   321110 000000                                                    .H..

COUNTSF
 Sect OctLoc
   0    7126   000000 000000                                                    ....

INDEXSF
 Sect OctLoc
   0    7127   000000 000000                                                    ....

GAP
 Sect OctLoc
   0    7130   000000 000000                                                    ....

PSNSF
 Sect OctLoc
   0    7131   000*** ******   ****** ******                                    ........

ACNTSF
 Sect OctLoc
   0    7133   040040 040040   040040 040040

KEY_SHADWSF
 Sect OctLoc
   0    7135   000000 000000                                                    ....

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:76   
(unnamed)
 Sect OctLoc
   5     000   104102 125124   111114 040111   055104 055123   057111 111040    DBUTIL I-D-S/II
   5     004   040126 105122   040040 040040   040040 040040   040040 040104     VER           D
   5     010   102125 124111   114040 103157   155160 154145   164145 144040    BUTIL Completed
   5     014   050123 124105   120103 103075   060051 040040   104111 122105    (STEPCC=0)  DIRE
   5     020   103124 111126   105040 105116   104040 117106   040106 111114    CTIVE END OF FIL
   5     024   105040 040040   052052 052052   040111 057117   040105 122122    E   **** I/O ERR
   5     030   117122 040117   116040 104111   122105 103124   111126 105040    OR ON DIRECTIVE
   5     034   111116 120125   124040 040040                                    INPUT

(unnamed)
 Sect OctLoc
   7     000   000000 000000   072040 040040   000010 577640   003735 206000    ....:   ........
   7     004   000002 000000   003730 006000   003732 006000   003731 006000    ................
   7     010   003732 006000   000000 000000   000040 777640   003735 006000    ......... ......
   7     014   000000 177640   004256 006000   000000 177640   000000 006014    ................
   7     020   000001 777640   004047 206000   000023 777640   004030 006000    .....'..........
   7     024   000040 777640   004115 006000   000077 777640   004156 006000    . ...M...?...n..
   7     030   000007 600000   000006 200000   000014 777640   003776 006000    ................
   7     034   040040 040040   000001 000000   004513 006000   000000 000002        ............
   7     040   000052 406000   000037 006000   000062 406000   000063 006000    .*.......2...3..
   7     044   000000 006000   004513 206000   004502 206000   004524 006000    ................
   7     050   000000 006003   004535 006000   000003 400000   777777 400007    ................
   7     054   000040 577640   003735 206000                                    . ......

PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:77   
--  Include file information  --

   U$JIT_C.:LIB_E05  cannot be made into a system file and is referenced.
   B$ROSEG.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_UWA_C.:ZIC0TOU  is referenced.
   ZI_RVA_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$Q2UT.

   Procedure ZIU$Q2UT requires 669 words for executable code.
   Procedure ZIU$Q2UT requires 6 words of local(AUTO) storage.

    No errors detected in file ZIU$Q2UT.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:78   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:79   
          MINI XREF LISTING

ALTEND_ZIU$Q2UT
      5809**LABEL    5581--CALLALT  5620--CALLALT  5622--CALLALT  5626--CALLALT  5643--CALLALT  5666--CALLALT
      5687--CALLALT  5696--CALLALT  5709--CALLALT  5715--CALLALT  5717--CALLALT  5729--CALLALT  5731--CALLALT
      5739--CALLALT  5742--CALLALT  5744--CALLALT  5746--CALLALT  5749--CALLALT  5752--CALLALT  5754--CALLALT
      5756--CALLALT  5759--CALLALT  5761--CALLALT  5763--CALLALT  5770--CALLALT  5772--CALLALT  5774--CALLALT
      5776--CALLALT  5789--CALLALT  5800--CALLALT
B$EXCFR.ASL
      3831**DCL      3831--REDEF
B$EXCFR.ERR.ERR#
      3845**DCL      3845--REDEF
B$EXCFR.EVID
      3844**DCL      3844--REDEF    3845--REDEF
B$EXCFR.IR
      3832**DCL      3832--REDEF
B$EXCFR.PREVSZ
      3831**DCL      3831--REDEF
B$EXCFR.SUBC
      3843**DCL      3843--REDEF    3844--REDEF    3844--REDEF
B$JIT.CPFLAGS1.SLEAZE
      5469**DCL      5469--REDEF
B$JIT.ERR.MID
      5376**DCL      5376--REDEF
B$JIT.NEXTCC
      5517**DCL      5777>>IF
B$JIT$
      4065**DCL      5370--IMP-PTR  5777>>IF
BLANK
       112**DCL      5597--ASSIGN   5816--ASSIGN
BREAK_FLAG
      4073**DCL      5577<<ASSIGN
BUFFER
        68**DCL      5589--ASSIGN   5813--ASSIGN
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:80   
BUFFER.TEXT
        73**DCL      5557<<CALLBLT  5587<<ASSIGN   5811<<ASSIGN   5839<<ASSIGN   5842--ASSIGN
BUFFER.TEXT_EXIT.STEPCC
        76**DCL      5588<<ASSIGN
BUFFER.TXT
        70**DCL        73--REDEF      74--REDEF
BUFFER.TXT.MSG
        71**DCL      5560--ASSIGN
BUFLNSF
      4109**DCL      5558<<ASSIGN   5592<<ASSIGN   5594<<ASSIGN   5599<<ASSIGN   5619<<ASSIGN   5624<<ASSIGN
      5641<<ASSIGN   5814<<ASSIGN   5817<<ASSIGN   5843<<ASSIGN
BUFSF
      4110**DCL      5560<<ASSIGN   5589<<ASSIGN   5597<<ASSIGN   5618<<ASSIGN   5621<<ASSIGN   5623<<ASSIGN
      5640<<ASSIGN   5813<<ASSIGN   5816<<ASSIGN   5842<<ASSIGN
B_VERSION.C
        93**DCL      5557>>CALLBLT  5616>>ASSIGN
B_VERSION.L
        92**DCL        93--IMP-SIZ  5557>>CALLBLT  5558>>ASSIGN   5616>>ASSIGN
CAN_RVA.OAREC.SEC
      2560**DCL      5683<>CALL
CAN_RVA.SFREC.SEC
      2536**DCL      5681<>CALL     5682<>CALL
CCBUF_ON
        52**DCL      5804>>IF
CHK_LO
      5568**LABEL    5566--CALLALT
COUNTSF
      4160**DCL      4161--REDEF
CURR_SCHNM
        87**DCL      5669>>IF       5698<<ASSIGN
DATESF
      4113**DCL      5610<<ASSIGN
DB_FUNC_FDR
        20**DCL-ENT  5681--CALL     5683--CALL
DB_FUNC_FIN
        19**DCL-ENT  5671--CALL     5852--CALL
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:81   
DB_FUNC_GET
        21**DCL-ENT  5682--CALL
DCBSF
      4089**DCL      5553<<ASSIGN   5555<<ASSIGN   5559<<ASSIGN   5590<<ASSIGN   5617<<ASSIGN   5639<<ASSIGN
      5710--IF       5710--IF       5718--IF       5718--IF       5788<<ASSIGN   5812<<ASSIGN   5819<<ASSIGN
      5840<<ASSIGN   5855<<ASSIGN   5857<<ASSIGN
DESTSF
      4112**DCL      5612<<ASSIGN
DIR_PRNT
       107**DCL      5621--ASSIGN
ENCRP_SEEDSF
      4118**DCL      4119--REDEF
END_ZIU$Q2UT
      5851**LABEL    5554--CALLALT  5556--CALLALT  5564--CALLALT  5601--GOTO     5632--CALLALT  5805--GOTO
      5821--GOTO
ERRCODESF
      4120**DCL      4125--REDEF
ERRCODESF.ERR#
      4123**DCL      5828<<ASSIGN
ERRCODE_RDEF
      4125**DCL      5829>>ASSIGN
ERRFLGSF
      4149**DCL      5830<<ASSIGN
EX_RPT_HDR
        94**DCL      5618--ASSIGN   5619--ASSIGN
EX_RPT_HDR.HDR_DATE
        99**DCL      5610--ASSIGN
EX_RPT_HDR.PG#
       101**DCL      5615<<CALLBLT
EX_RPT_HDR.VERS
        97**DCL      5616<<ASSIGN
F$DCB.ACTPOS
      3789**DCL      3789--REDEF
F$DCB.ARS#
      3763**DCL      3763--REDEF
F$DCB.ASN#
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:82   
      3778**DCL      5710>>IF       5718>>IF
F$DCB.ATTR
      3782**DCL      3783--REDEF
F$DCB.BORROW
      3797**DCL      3797--REDEF    3797--REDEF    3797--REDEF
F$DCB.DCBNAME.L
      3811**DCL      3811--IMP-SIZ
F$DCB.EOMCHAR#
      3767**DCL      3767--REDEF
F$DCB.FLDID
      3792**DCL      3792--REDEF
F$DCB.FORM$
      3786**DCL      3786--REDEF
F$DCB.FSECT
      3802**DCL      3802--REDEF
F$DCB.FSN#
      3779**DCL      3779--REDEF    3779--REDEF    3780--REDEF
F$DCB.HEADER$
      3785**DCL      3785--REDEF
F$DCB.IXTNSIZE#
      3783**DCL      3783--REDEF
F$DCB.LASTSTA$
      3772**DCL      3772--REDEF
F$DCB.LVL
      3798**DCL      3798--REDEF
F$DCB.NAME#.C
      3773**DCL      3773--REDEF
F$DCB.NOEOF
      3795**DCL      3795--REDEF
F$DCB.NRECS#
      3784**DCL      3784--REDEF
F$DCB.NRECX
      3803**DCL      3803--REDEF
F$DCB.OHDR
      3795**DCL      3795--REDEF
F$DCB.ORG#
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:83   
      3778**DCL      3778--REDEF
F$DCB.PRECNO
      3801**DCL      3801--REDEF
F$DCB.PSN#
      3773**DCL      5710>>IF       5718>>IF
F$DCB.RCSZ
      3807**DCL      3807--REDEF
F$DCB.RES#
      3774**DCL      3774--REDEF
F$DCB.SETX
      3786**DCL      3786--REDEF
F$DCB.TAB$
      3786**DCL      3786--REDEF
F$DCB.TDA
      3800**DCL      3801--REDEF
F$DCB.TYC.EOF#
      3764**DCL      5809>>IF
F$DCB.TYC.IOERR#
      3764**DCL      5837>>IF
F$DCB.WSN#
      3774**DCL      3774--REDEF
FIDSF_RD
      4136**DCL      4137--REDEF
FPT_EXIT
      1182**DCL      5781<>CALL     5860<>CALL
FPT_EXIT.V
      1182**DCL      1182--DCLINIT
FPT_EXIT.V.STEPCC#
      1183**DCL      1183--REDEF    5578>>IF       5579<<ASSIGN   5588>>ASSIGN   5591>>IF       5638>>ASSIGN
      5780<<ASSIGN   5801>>IF       5802<<ASSIGN   5835>>IF       5836<<ASSIGN
FPT_INT
      3824**DCL      5563<>CALL
FPT_INT.V
      3824**DCL      3824--DCLINIT
FREE_DYN_MEM
        40**DCL-ENT  5675--CALL     5767--CALL     5854--CALL
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:84   
GETBUFFERS
        24**DCL-ENT  5564--CALL
GET_DCB
        22**DCL-ENT  5654--CALL     5709--CALL     5715--CALL     5717--CALL     5739--CALL
GET_NXT_AC
        16**DCL-ENT  5687--CALL     5696--CALL     5794--CALL
GET_SCHEMA_NAME
        23**DCL-ENT  5666--CALL
HELPCODE
      4154**DCL      4159--REDEF
ICHKSUM
      4074**DCL      4075--REDEF
I_O_BUF$
      4052**DCL      4053--IMP-PTR
KEYVSF
      4092**DCL      4097--REDEF
KEYVSF.WD_ONE
      4094**DCL      4095--REDEF
LAST_AREA
        50**DCL      5662<<ASSIGN   5687<>CALL     5696<>CALL     5736>>DOWHILE  5784<<ASSIGN   5794<>CALL
      5796<<ASSIGN
LAST_DBK
        88**DCL      5684<<ASSIGN
LO_DCB
        62**DCL      5568<>CALL
M$EXIT
      1111**DCL-ENT  5781--CALL     5860--CALL
M$INT
      1154**DCL-ENT  5563--CALL
M$LO
      4062**DCL      5555>>ASSIGN   5559>>ASSIGN   5590>>ASSIGN   5617>>ASSIGN   5639>>ASSIGN   5812>>ASSIGN
      5840>>ASSIGN   5857>>ASSIGN
M$SI
        60**DCL      5553>>ASSIGN   5809--IF       5819>>ASSIGN   5837--IF       5855>>ASSIGN
M$XXX
      1111**DCL-ENT  5832--CALL
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:85   
MERGESF
      4150**DCL      5708<<ASSIGN   5714<<ASSIGN   5716<<ASSIGN   5738<<ASSIGN
MSGCODE
      4126**DCL      4127--REDEF    5829<<ASSIGN
OUTPUT_STEPCC
        78**DCL      5640--ASSIGN   5641--ASSIGN
OUTPUT_STEPCC.CURR
        80**DCL      5637<<ASSIGN
OUTPUT_STEPCC.HIGHEST
        82**DCL      5638<<ASSIGN
PPG#
        89**DCL      5614<<ASSIGN   5614>>ASSIGN   5615>>CALLBLT
PRINT_HDR
        51**DCL      5565<<ASSIGN   5567<<ASSIGN   5569<<ASSIGN   5591>>IF       5607>>IF
PSNSF.SN#
      4167**DCL      5710>>IF       5718>>IF
PSNSF.VOL#
      4165**DCL      5712<<ASSIGN   5720<<ASSIGN
RBUF
       111**DCL      5623--ASSIGN
READ_SW
        90**DCL      5585>>IF
REASGNSF
      4144**DCL      5552<<ASSIGN
REC$
      4033**DCL      4056--IMP-PTR
REC_DATA_LN
      4061**DCL      4060--IMP-SIZ
REPORT_CHK
        39**DCL-ENT  5800--CALL
RESTART
      4072**DCL      5572<<REMEMBR
RESTRT
      5804**LABEL    5572--REMEMBR  5629--GOTO     5633--GOTO     5644--GOTO     5692--CALLALT  5747--GOTO
      5750--GOTO     5757--GOTO     5849--GOTO
SCHEMA_ACTIVE
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:86   
      1063**DCL      5667>>IF       5672<<ASSIGN   5690>>IF       5697<<ASSIGN   5851>>IF
SI_DCB
        61**DCL      5566<>CALL
SOURCESF
      4111**DCL      5611<<ASSIGN
STEPCC
      4051**DCL      5578>>IF       5579>>ASSIGN   5580<<ASSIGN   5637>>ASSIGN   5777>>IF       5780>>ASSIGN
      5801>>IF       5823>>IF       5834>>IF       5834<<ASSIGN   5835>>IF       5836>>ASSIGN
STEP_EXIT
      5860**LABEL    5845--GOTO
SUBMESSF
      4146**DCL      5551<<ASSIGN
SYS_FUNC_CLOS
        41**DCL-ENT  5820--CALL     5856--CALL     5858--CALL
SYS_FUNC_CORRES
        44**DCL-ENT  5566--CALL     5568--CALL
SYS_FUNC_DATE
        42**DCL-ENT  5613--CALL
SYS_FUNC_ERRMSG
        45**DCL-ENT  5831--CALL
SYS_FUNC_OPEN
        43**DCL-ENT  5554--CALL     5556--CALL
SYS_FUNC_RELDCB
        48**DCL-ENT  5713--CALL     5789--CALL
SYS_FUNC_WRIT
        46**DCL-ENT  5562--CALL     5596--CALL     5600--CALL     5620--CALL     5622--CALL     5626--CALL
      5643--CALL     5815--CALL     5818--CALL     5844--CALL
UC_DCB
        63**DCL      5566<>CALL     5568<>CALL
UTSSF
      4115**DCL      5609<<ASSIGN
UWA.AC_REC.CALC_NEXT
      3532**DCL      3533--REDEF
UWA.AC_REC.CALC_PRIOR
      3541**DCL      3542--REDEF
UWA.AC_REC.DEFAULTS
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:87   
      3490**DCL      3491--REDEF
UWA.AC_REC.FILE_CODE
      3495**DCL      3496--REDEF
UWA.AC_REC.FLAG1.ERROR_TYPE
      3492**DCL      3493--REDEF
UWA.AC_REC.PG_TYPE
      3507**DCL      3508--REDEF
UWA.AD_REC.ADDATE
      3472**DCL      3473--REDEF
UWA.DIR_REF
      3429**DCL      5684>>ASSIGN
UWA.SF_REC.DBKOA
      3438**DCL      5683<>CALL
VFCSF
      4106**DCL      5561<<ASSIGN   5598<<ASSIGN   5625<<ASSIGN   5642<<ASSIGN   5841<<ASSIGN
WAITSF
      4105**DCL      5595<<ASSIGN
XREF_BUILT
        58**DCL      5673>>IF       5676<<ASSIGN   5765>>IF       5768<<ASSIGN   5853>>IF
ZI$DIR.ALTKEY
      1018**DCL      1019--REDEF    1020--REDEF
ZI$DIR.AREAFID
       984**DCL       985--REDEF
ZI$DIR.AREA_NM
      1047**DCL      5654<>CALL     5666<>CALL     5739<>CALL
ZI$DIR.AREA_NM.DCB#
      1051**DCL      5788>>ASSIGN
ZI$DIR.AREA_NM.NAME
      1048**DCL      5649<<ASSIGN   5652<<ASSIGN
ZI$DIR.AREA_NM.NAME.TEXT
      1050**DCL      5653>>IF       5685>>IF       5692<>CALL     5694>>IF       5737>>IF       5786>>IF
ZI$DIR.AUTODUMP
       971**DCL      5653>>IF       5685>>IF       5694>>IF       5793>>IF
ZI$DIR.CHECK
       993**DCL      5798>>IF
ZI$DIR.CODE
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:88   
      1000**DCL      5628>>IF       5635>>IF       5740>>DOCASE   5798>>IF
ZI$DIR.DATE
      1023**DCL      1027--REDEF
ZI$DIR.DEST_NM
      1057**DCL      5717<>CALL
ZI$DIR.DEST_NM.NAME
      1058**DCL      5652>>ASSIGN
ZI$DIR.DEST_SEED
       979**DCL       980--REDEF     981--REDEF
ZI$DIR.ENCP_SEED
       976**DCL       977--REDEF     978--REDEF
ZI$DIR.FSET
       999**DCL      5793>>IF
ZI$DIR.HELP
       968**DCL      5847<<ASSIGN
ZI$DIR.HELP_SVRITY
       969**DCL      5848<<ASSIGN
ZI$DIR.LOAD
       958**DCL      5651>>IF       5706>>IF       5728>>IF
ZI$DIR.REPRT_ZERO
      1010**DCL      1011--REDEF
ZI$DIR.RESTR
      1014**DCL      5685>>IF       5694>>IF
ZI$DIR.SCHEMA_NEEDED
       991**DCL      5647>>IF       5663>>IF
ZI$DIR.SCHEMA_NM.NAME.TEXT
      1045**DCL      5665>>IF       5669>>IF       5692<>CALL     5698>>ASSIGN
ZI$DIR.SCHFID
       982**DCL       983--REDEF
ZI$DIR.SRCE_NM
      1052**DCL      5709<>CALL     5715<>CALL
ZI$DIR.SRCE_NM.NAME
      1053**DCL      5649>>ASSIGN
ZI$DIR.SYSCTL
      1003**DCL      5630>>IF
ZI$DIR.TIME
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:89   
      1028**DCL      1033--REDEF
ZI$DIR.UNLOAD
       959**DCL      5648>>IF       5706>>IF
ZIU$BRKCTL
        49**DCL-ENT  3824--DCLINIT
ZIU$CHECK
        35**DCL-ENT  5752--CALL
ZIU$DUMP
        31**DCL-ENT  5731--CALL
ZIU$INRBT
        17**DCL-ENT  5763--CALL
ZIU$KEYBLD
        18**DCL-ENT  5761--CALL
ZIU$LOAD
        30**DCL-ENT  5729--CALL
ZIU$LOCK
        26**DCL-ENT  5772--CALL
ZIU$PA_ROOT
        34**DCL-ENT  5749--CALL
ZIU$Q2DI
        15**DCL-ENT  5581--CALL
ZIU$Q2IN
        13**DCL-ENT  5742--CALL
ZIU$Q2PR
        32**DCL-ENT  5744--CALL
ZIU$Q2RP
        33**DCL-ENT  5746--CALL
ZIU$Q2SC
        14**DCL-ENT  5692--CALL
ZIU$Q2UT_STRT
      5572**LABEL    5568--CALLALT  5807--GOTO
ZIU$REPRT
        36**DCL-ENT  5754--CALL
ZIU$ROLL
        25**DCL-ENT  5770--CALL
ZIU$SNAP
PL6.E3A0      #001=ZIU$Q2UT File=ZIU$Q2UT.:ZIC0TSI                               FRI 09/05/97 13:28 Page:90   
        38**DCL-ENT  5759--CALL
ZIU$SYSCTL
        29**DCL-ENT  5632--CALL
ZIU$TESTLOCK
        28**DCL-ENT  5776--CALL
ZIU$UNLCK
        27**DCL-ENT  5774--CALL
ZIU$VALSET
        37**DCL-ENT  5756--CALL
