
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:1    
        1        1        /*M* ZIG$DDP8         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        P2DMCL:
        8        8            PROC;
        9        9         /*Define internal cell current. Current determines if
       10       10         a clause has been specified more than once
       11       11         cm  *Proc*         *Set*    *Record*       *Area*
       12       12         1                  mode      type           FILE_CODE
       13       13         2   parameter                POINTER_SEQ
       14       14         3                                           allocate
       15       15         4                                           PAGE_INTERVAL
       16       16         5                                           CALC_INTERVAL
       17       17         6                                           PAGE_SIZE
       18       18         7   CLAUSE_TYPE                             LOAD_LIMIT
       19       19         8                                           inventory
       20       20         9                                           organization
       21       21         11   PROGRAM_NAME
       22       22         12   author
       23       23         16   RECORD_NAME
       24       24         25   STATUS_RETURN
       25       25         29   SS_RECORD_NAME
       26       26            */
       27       27    1   DCL PA_PLACE UBIN WORD;
       28       28    1   DCL USER_PLACE UBIN WORD;
       29       29    1   DCL CHPP SBIN HALF;
       30       30    1   DCL HLN SBIN HALF;
       31       31    1   DCL OA_SPACE SBIN HALF;
       32       32    1   DCL 01 AREA STATIC,
       33       33    1         02 ALLOC SBIN WORD,
       34       34    1         02 BASE_DBK SBIN WORD,
       35       35    1         02 MIN_DBK SBIN WORD,
       36       36    1         02 MAX_DBK SBIN WORD,
       37       37    1         02 MIN_PAGE SBIN WORD,
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:2    
       38       38    1         02 FIRST_INV_PG SBIN WORD,
       39       39    1         02 MAX_PAGE SBIN WORD,
       40       40    1         02 DBK_PAGE SBIN WORD,
       41       41    1         02 DBK_PAGE_REDEF (0:35) REDEF DBK_PAGE BIT(1),
       42       42    1         02 DBK_CALC SBIN WORD,
       43       43    1         02 LINE_BITS SBIN WORD,
       44       44    1         02 INV_THRESH SBIN HALF,
       45       45    1         02 PGS_INV_PG SBIN HALF,
       46       46    1         02 INV_UNIT SBIN HALF,
       47       47    1         02 PAGE_SIZE SBIN HALF,
       48       48    1         02 SECTORS_PAGE SBIN HALF;
       49       49    1   DCL 1 AREAS STATIC,
       50       50    1         2 DBKAC(0:99) SBIN WORD;
       51       51    1   DCL HIGH_DBK SBIN WORD STATIC;
       52       52    1   DCL LOW_DBK SBIN WORD STATIC;
       53       53    1   DCL ADJ_LOW_DBK SBIN WORD STATIC;
       54       54    1   DCL ADJ_HIGH_DBK SBIN WORD STATIC;
       55       55    1   DCL CALC_OFFS SBIN WORD STATIC;
       56       56    1   DCL NUMB_CALC SBIN WORD STATIC;
       57       57    1   DCL T1 SBIN WORD STATIC;
       58       58    1   DCL T3 SBIN WORD STATIC;
       59       59    1   DCL LOCAL_SIZE SBIN WORD STATIC;
       60       60    1   DCL GLOBAL_SIZE SBIN WORD STATIC;
       61       61    1   DCL LOC_AREA SBIN WORD;
       62       62    1   DCL E SBIN HALF STATIC;
       63       63    1   DCL ARG SBIN HALF;
       64       64    1   DCL LOCK_BITS BIT(36);
       65       65    1   DCL ALL_ZEROS BIT(36) STATIC INIT('0'B);
       66       66    1   DCL LOCK_TYPE BIT(36);
       67       67    1   DCL TEST_TYPE BIT(36);
       68       68    1   DCL RNG SBIN WORD STATIC INIT(0);
       69       69    1   DCL PART_RNG SBIN WORD STATIC INIT(0);
       70       70    1   DCL P3 PTR;
       71       71    1   DCL I SBIN HALF;
       72       72    1   DCL X SBIN HALF;
       73       73    1   DCL D SBIN;
       74       74    1   DCL ROOT SBIN;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:3    
       75       75        %EQU MAX_PRIME_SAVE = 19;
       76       76    1   DCL 1 PRIME_SAVER(0:%MAX_PRIME_SAVE) DALIGNED,
       77       77    1         2 N_CALC SBIN,
       78       78    1         2 PRIM SBIN;
       79       79    1   DCL PRIME_INDEX SBIN;
       80       80    1   DCL PROC_TYPE SBIN HALF;
       81       81    1   DCL INV_FLG SBIN HALF INIT(0) STATIC;
       82       82    1   DCL DCLR SBIN HALF INIT(1) STATIC;
       83       83    1   DCL TOTAL_KEYS UBIN WORD;
       84       84    1   DCL S1 CHAR(16) INIT(' ') STATIC;
       85       85    1   DCL S2 CHAR(16) INIT(' ') STATIC;
       86       86    1   DCL S3 CHAR(16) INIT(' ') STATIC;
       87       87    1   DCL S4 CHAR(16) INIT(' ') STATIC;
       88       88    1   DCL SUBEX_STK_SZ SBIN HALF STATIC INIT(0);
       89       89    1   DCL DELETE BIT(3) STATIC INIT('111'B);
       90       90    1   DCL FLD_NAME CHAR(30) STATIC;
       91       91    1   DCL REC_NAME CHAR(30) STATIC;
       92       92    1   DCL REFR SBIN HALF STATIC INIT(2);
       93       93    1   DCL X131072 SBIN WORD STATIC INIT(131072);
       94       94    1   DCL TYPE_CD(0:4319) BIT(1);
       95       95    1   DCL SUBH1 CHAR(40) STATIC INIT(' ');
       96       96    1   DCL PNAME CHAR(30);
       97       97    1   DCL ZFOR BIT(1);
       98       98    1   DCL MAXI UBIN WORD STATIC ALIGNED INIT(BITBIN('777777777777'O));
       99       99    1   DCL Z SBIN HALF;
      100      100    1   DCL Z1 SBIN HALF;
      101      101    1   DCL ERX SBIN HALF EXT;
      102      102    1   DCL FIRST SBIN HALF STATIC INIT(1);
      103      103    1   DCL LAST SBIN HALF STATIC INIT(2);
      104      104    1   DCL DBK SBIN WORD;
      105      105    1   DCL DBK_RA SBIN WORD;
      106      106        %INCLUDE ZIA_IDS_DCL;
      107      214        %INCLUDE ZIG_DBA_INT;
      108      262        %INCLUDE ZI_ERRORS_SUBS;
      109      782        %INCLUDE ZI_SUB4_CAN;
      110     1439        %INCLUDE ZIG_GENERAL;
      111     1547        %UWA;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:4    
      112     1882         /* Local pointers or dbks */
      113     1883    1   DCL DBK_SN SBIN WORD STATIC;
      114     1884    1   DCL DBK_SF SBIN WORD STATIC;
      115     1885    1   DCL DBK_LOC_AREA SBIN WORD STATIC;
      116     1886    1   DCL TOTAL_RSRVD UBIN WORD;
      117     1887    1   DCL TOTAL UBIN WORD;
      118     1888    1   DCL KEYS_RESERVED UBIN WORD INIT(0) STATIC;
      119     1889    1   DCL MAX_PTR_SIZE SBIN HALF;
      120     1890    1   DCL TEMP_UBIN_WORD UBIN WORD;
      121     1891        %EJECT;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:5    
      122     1892    1       PRIME_SAVER = '0'B;
      123     1893         /* Start   of   program */
      124     1894    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1); /* Get oa record */
      125     1895    1       AREA.MIN_PAGE = 1;
      126     1896    1       AREA.MAX_DBK = 0;
      127     1897    1       TOTAL_RSRVD = 0;
      128     1898         /* Go through all ac records and set all default values
      129     1899            to all unspecified attrigutes */
      130     1900    1   DOAC:
      131     1901    1       CALL FETCHNS_6('OA-AC   ') ALTRET(DORA); /* Get next ac record */
      132     1902    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* In case of error */
      133     1903         /* Page interval */
      134     1904    1       IF UWA.AC.PAGE_TYP = 3
      135     1905    1       THEN GOTO DOAC;
      136     1906    1       IF UWA.AC.DBK_PAGE = 0 & UWA.AC.PAGE_TYP ~= 3
      137     1907    1       THEN UWA.AC.DBK_PAGE = 64;
      138     1908    1       IF UWA.AC.DBK_CALC = 0 & UWA.AC.CALC_NULL = 0 THEN
      139     1909    1           UWA.AC.DBK_CALC = UWA.AC.DBK_PAGE;
      140     1910    1       UWA.AC.MIN_PAGE = 1;
      141     1911    1       IF UWA.AC.SECTORS_PAGE = 0 THEN
      142     1912    1           UWA.AC.SECTORS_PAGE = 8;
      143     1913         /* Refresh area record for next ac */
      144     1914    1       AREA.ALLOC = UWA.AC.MAX_DBK; /* # keys for this area */
      145     1915    1       IF AREA.ALLOC = 0 THEN
      146     1916    1           AREA.ALLOC = 6400;
      147     1917    1       AREA.LINE_BITS = 0;
      148     1918    1       AREA.MIN_DBK = 0;
      149     1919    1       AREA.DBK_PAGE = UWA.AC.DBK_PAGE; /* PAGE_INTERVAL */
      150     1920    1       AREA.DBK_CALC = UWA.AC.DBK_CALC; /* CALC_INTERVAL */
      151     1921    1       AREA.INV_THRESH = 0;
      152     1922    1       AREA.INV_UNIT = 0;
      153     1923         /* Calculate line bits */
      154     1924        /*       AREA.LINE_BITS = LOG2(AREA.DBK_PAGE); */
      155     1925         /* since 2**line_bits = dbk_page, the only bit position on in
      156     1926            dbk_page will give correct value for line_bits */
      157     1927    1       X = 35;
      158     1928    2       DO WHILE AREA.DBK_PAGE_REDEF(X) = '0'B;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:6    
      159     1929    2           X = X - 1;
      160     1930    2           END;
      161     1931    1       AREA.LINE_BITS = 35 - X;
      162     1932         /* Calculate pages per inventory page */
      163     1933    1       IF UWA.AC.PER_INV ~= INV_FLG THEN
      164     1934    1           AREA.PGS_INV_PG = UWA.AC.PAGE_SIZE - 12;
      165     1935    1       ELSE
      166     1936    1           AREA.PGS_INV_PG = 0;
      167     1937         /* Calculate min DATA_BASE_KEY for area
      168     1938            it equals the last max dbk (of lasst area) + 1 */
      169     1939    1       AREA.MIN_DBK = (AREA.MAX_DBK + 1) + KEYS_RESERVED;
      170     1940         /* Calculate max DATA_BASE_KEY for area
      171     1941            it equals #DBK key for this area starting at
      172     1942            MIN_DBK */
      173     1943         /* Check if total number of data-base-keys plus
      174     1944            number of reserved keys is greater than
      175     1945            68,719,476,735 */
      176     1946    1       TOTAL_KEYS = AREA.MAX_DBK + UWA.AC.KEYS_RSRVD;
      177     1947    1       IF TOTAL_KEYS > MAXI THEN
      178     1948    2       DO;
      179     1949    2           UWA.AC.KEYS_RSRVD = MAXI - AREA.MAX_DBK;
      180     1950    2           CALL FCURR_R_6('AC  ' ) ALTRET(ERROR1);
      181     1951    2           CALL WARNING(2301);
      182     1952        /*E*     ERROR:    ZIG-ZIG_TOO_MANY_KEYS-C
      183     1953        MESSAGE: Warning: The total number of DATA_BASE_KEYS plus the number of
      184     1954                 reserved keys for an area is greater than 34,359,738,367.
      185     1955                 Total keys will be set to 34,359,738,367.
      186     1956        */
      187     1957    2           END;
      188     1958         /* Accumulate reserved keys */
      189     1959    1       TOTAL_RSRVD = TOTAL_RSRVD + UWA.AC.KEYS_RSRVD;
      190     1960         /* If area is indexed check if index filecode
      191     1961            is the same as data file code */
      192     1962    1       AREA.MAX_DBK = AREA.ALLOC + AREA.MIN_DBK - 1;
      193     1963         /* Calculate max page in area */
      194     1964    1       T3 =0;
      195     1965    1       IF MOD(AREA.ALLOC,AREA.DBK_PAGE) = 0 THEN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:7    
      196     1966    1           T1 = AREA.ALLOC/AREA.DBK_PAGE;
      197     1967    1       ELSE
      198     1968    1           T1 = AREA.ALLOC/AREA.DBK_PAGE + 1;
      199     1969    1       IF UWA.AC.PER_INV ~= INV_FLG THEN
      200     1970    1           IF MOD(T1,AREA.PGS_INV_PG) = 0 THEN
      201     1971    1               T3 = T1/AREA.PGS_INV_PG;
      202     1972    1           ELSE
      203     1973    1               T3 = T1/AREA.PGS_INV_PG + 1;
      204     1974    1       AREA.MAX_PAGE = T1 + T3;
      205     1975    1       IF UWA.AC.PER_INV ~= INV_FLG THEN
      206     1976    1           AREA.FIRST_INV_PG = T1 + 1;
      207     1977    1       ELSE
      208     1978    1           AREA.FIRST_INV_PG = 0;
      209     1979         /* Set inventory threshold */
      210     1980    1       IF UWA.AC.PER_INV ~= INV_FLG THEN
      211     1981    1           AREA.INV_THRESH = UWA.AC.PAGE_SIZE - (((UWA.AC.PER_INV
      212     1982    1              * UWA.AC.PAGE_SIZE) + 50) / 100); /* +50 IS FOR ROUND UP */
      213     1983         /* Calculate base dbk for local pointers */
      214     1984    1       AREA.BASE_DBK = AREA.MIN_DBK - 1;
      215     1985    1       KEYS_RESERVED = UWA.AC.KEYS_RSRVD;
      216     1986    1       IF UWA.AC.PER_INV ~= INV_FLG THEN /* Calc area inv unit */
      217     1987    2       DO;
      218     1988    2           AREA.INV_UNIT = ((4096*(100-UWA.AC.PER_INV))+51199)/51200;
      219     1989    2           END;
      220     1990         /* Set ac record */
      221     1991    1       UWA.AC.BASE_DBK = AREA.BASE_DBK;
      222     1992    1       UWA.AC.MIN_DBK = AREA.MIN_DBK;
      223     1993    1       UWA.AC.MAX_DBK = AREA.MAX_DBK;
      224     1994    1       UWA.AC.MIN_PAGE = AREA.MIN_PAGE;
      225     1995    1       UWA.AC.MAX_PAGE = AREA.MAX_PAGE;
      226     1996    1       UWA.AC.LINE_BITS = AREA.LINE_BITS;
      227     1997    1       UWA.AC.INV_THRESH = AREA.INV_THRESH;
      228     1998    1       UWA.AC.PGS_INV_PG = AREA.PGS_INV_PG;
      229     1999    1       UWA.AC.KEYS_ALLOC = AREA.ALLOC;
      230     2000    1       UWA.AC.FRST_INV_PG = AREA.FIRST_INV_PG;
      231     2001    1       UWA.AC.INV_UNIT = AREA.INV_UNIT;
      232     2002    1       IF UWA.AC.PER_INV = INV_FLG THEN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:8    
      233     2003    1           UWA.AC.PER_INV = 0;
      234     2004    1       CALL FCURR_R_6('AC  ') ALTRET(ERROR1);
      235     2005    1       CALL MODIFY_6('AC  ') ALTRET(ERROR1);
      236     2006         /* Factor in extra page if index area */
      237     2007    1       GOTO DOAC; /* Get next ac record */
      238     2008    1   DORA:
      239     2009         /* AREA.MAX_DBK is the total # dbk in all areas
      240     2010            determine global size */
      241     2011    1       TOTAL = KEYS_RESERVED + AREA.MAX_DBK;
      242     2012    1       GLOBAL_SIZE = 2;
      243     2013    1       IF TOTAL > 262143 THEN
      244     2014    1           GLOBAL_SIZE = 3;
      245     2015    1       IF TOTAL > 134217727 THEN
      246     2016    1           GLOBAL_SIZE = 4;
      247     2017    1       UWA.OA.GLOBAL = GLOBAL_SIZE - 1;
      248     2018    1       CALL FCURR_R_6('OA  ') ALTRET(ERROR1);
      249     2019    1       CALL MODIFY_6('OA  ') ALTRET(ERROR1);
      250     2020         /* Go through all rc records and associate ra records
      251     2021            and set appropriate fields */
      252     2022    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1); /* Start at beginning */
      253     2023    1   NXTRC:
      254     2024    1       CALL FETCHNS_6('OA-RC   ') ALTRET(CKAC); /* Get next rc */
      255     2025    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get associated sn */
      256     2026    1       IF UWA.SN.SENAME = '*DBPARAM' THEN
      257     2027    1           GOTO NXTRC;
      258     2028    1       IF UWA.SN.SENAME = '*CALC.RC' THEN
      259     2029    1           GOTO NXTRC;
      260     2030    1       IF UWA.SN.SENAME = '*SYSTEM' THEN
      261     2031    1           GOTO NXTRC;
      262     2032    2       IF SUBSTR(UWA.SN.SENAME,0,8) = '*PA_REC_' THEN DO;
      263     2033    2           CALL FCURR_R_6('RC  ') ALTRET(ERROR1);
      264     2034    2           PA_PLACE = UWA.DIRECT_REF;
      265     2035    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(ERROR1);
      266     2036    2           CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);
      267     2037    2           CALL FETCHNS_6('SC-SOSM ') ALTRET(ERROR1);
      268     2038    2           CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      269     2039    2   NXT_PA_RC_RA:
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:9    
      270     2040    2           CALL FETCHNS_6('RC-RA   ') ALTRET(DONE_PA_RC_RA);
      271     2041    2           USER_PLACE = UWA.DIRECT_REF;
      272     2042    2           CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);
      273     2043    2           CALL FINDD_6('RC  ',PA_PLACE) ALTRET(ERROR1);
      274     2044    2           CALL STRE_6('RA  ') ALTRET(ERROR1);
      275     2045    2           CALL FINDD_6('RA  ',USER_PLACE) ALTRET(ERROR1);
      276     2046    2           GOTO NXT_PA_RC_RA;
      277     2047    2   DONE_PA_RC_RA:
      278     2048    2           CALL FETCHD_6('RC  ',PA_PLACE) ALTRET(ERROR1);
      279     2049    2           GOTO NXTRC;
      280     2050    2           END;
      281     2051         /* Go through ra's for this rc */
      282     2052    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1);
      283     2053    1   NXTRA:
      284     2054    1       CALL FETCHNS_6('RC-RA   ') ALTRET(NXTRC); /* Get next ra */
      285     2055    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);
      286     2056    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1); /* Get ac for this ra*/
      287     2057    1       LOW_DBK = UWA.RA.LOWDBK;
      288     2058    1       HIGH_DBK = UWA.RA.HIGHDBK;
      289     2059    1       IF HIGH_DBK = 0 & LOW_DBK = 0 THEN
      290     2060    2       DO; /* No range values specified for rc */
      291     2061    2           LOW_DBK = 1;
      292     2062    2           ADJ_LOW_DBK = UWA.AC.MIN_DBK;
      293     2063    2           HIGH_DBK = LOW_DBK + (UWA.AC.MAX_DBK - UWA.AC.MIN_DBK);
      294     2064    2           ADJ_HIGH_DBK = UWA.AC.MAX_DBK;
      295     2065    2           END;
      296     2066    1       ELSE
      297     2067    2       DO; /* Range values specified for rc */
      298     2068    2           AREA.MIN_DBK = UWA.AC.MIN_DBK;
      299     2069    2           ADJ_LOW_DBK = AREA.MIN_DBK + LOW_DBK - 1;
      300     2070    2           ADJ_HIGH_DBK = AREA.MIN_DBK + HIGH_DBK - 1;
      301     2071    2           END;
      302     2072    1       IF UWA.AC.CALC_NULL = 1 THEN
      303     2073    1           GOTO NEXTRA1; /* No calc records for area */
      304     2074    1       AREA.DBK_CALC = UWA.AC.DBK_CALC;
      305     2075    1       CALC_OFFS = LOW_DBK - 1; /* Low range value */
      306     2076    1       IF CALC_OFFS ~= 0 THEN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:10   
      307     2077    2       DO;
      308     2078    2           X = 0;
      309     2079    3           DO WHILE(MOD(CALC_OFFS,AREA.DBK_CALC) ~= 0);
      310     2080    3               X = X + 1;
      311     2081    3               CALC_OFFS = CALC_OFFS - 1;
      312     2082    3               END;
      313     2083    2           CALC_OFFS = -1 * X;
      314     2084    2           END;
      315     2085    1       IF CALC_OFFS < 0 THEN
      316     2086    1           RNG = HIGH_DBK - LOW_DBK + 1 - CALC_OFFS;
      317     2087    1       ELSE
      318     2088    1           RNG = HIGH_DBK - LOW_DBK + 1 + CALC_OFFS;
      319     2089    1       NUMB_CALC = RNG/AREA.DBK_CALC;
      320     2090    1       PART_RNG = MOD(RNG,AREA.DBK_CALC);
      321     2091    1       IF PART_RNG > AREA.DBK_CALC/2 THEN
      322     2092    1           NUMB_CALC = NUMB_CALC + 1;
      323     2093    1       IF NUMB_CALC = 0 THEN
      324     2094    1           NUMB_CALC = 1;
      325     2095    1       IF NUMB_CALC <= 3 THEN
      326     2096    1           GOTO NEXTRA1;
      327     2097
      328     2098         /* We need to adjust NUMB_CALC to be the maximum prime less than
      329     2099            NUMB_CALC's current value. */
      330     2100
      331     2101         /* See if we have saved this one already */
      332     2102    1       PRIME_INDEX = 0;
      333     2103    1   FIND_SAVED_PRIME:
      334     2104    2       DO UNTIL PRIME_INDEX > %MAX_PRIME_SAVE;
      335     2105    2           IF NUMB_CALC <= PRIME_SAVER.N_CALC(PRIME_INDEX)
      336     2106    3           THEN DO;
      337     2107    3               IF NUMB_CALC >= PRIME_SAVER.PRIM(PRIME_INDEX)
      338     2108    4               THEN DO;
      339     2109    4                   NUMB_CALC = PRIME_SAVER.PRIM(PRIME_INDEX);
      340     2110    4                   GOTO NEXTRA1;
      341     2111    4                   END;
      342     2112    4               ELSE DO;
      343     2113    4                   PRIME_INDEX = PRIME_INDEX + 1;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:11   
      344     2114    4                   END;
      345     2115    3               END;
      346     2116    3           ELSE DO;
      347     2117    3               EXIT FIND_SAVED_PRIME;
      348     2118    3               END;
      349     2119    2           END;
      350     2120
      351     2121         /* Make room to save it if it fits. */
      352     2122    1       IF PRIME_INDEX <= %MAX_PRIME_SAVE
      353     2123    2       THEN DO;
      354     2124    3           DO D = %MAX_PRIME_SAVE DOWNTO PRIME_INDEX + 1;
      355     2125    3               PRIME_SAVER(D) = PRIME_SAVER(D-1);
      356     2126    3               END;
      357     2127    2           PRIME_SAVER.N_CALC(PRIME_INDEX) = NUMB_CALC;
      358     2128    2           PRIME_SAVER.PRIM(PRIME_INDEX) = 0;
      359     2129    2           END;
      360     2130
      361     2131    1       IF MOD(NUMB_CALC,2) = 0 THEN /* Is it even */
      362     2132    1           NUMB_CALC = NUMB_CALC - 1;
      363     2133
      364     2134         /* Approximate square root to nearest power of 2 greater then NUMB_CALC */
      365     2135    1       ROOT = 2;
      366     2136    2       DO WHILE ROOT * ROOT < NUMB_CALC;
      367     2137    2           ROOT = ROOT * 2;
      368     2138    2           END;
      369     2139
      370     2140         /* Reduce number of calc headers to a prime */
      371     2141    1   PRIME: ;
      372     2142    2       DO D = 3 TO ROOT BY 2 ;
      373     2143    2           IF MOD( NUMB_CALC, D ) = 0 THEN
      374     2144    3           DO;
      375     2145    3               NUMB_CALC = NUMB_CALC - 2;
      376     2146    3               GOTO PRIME;
      377     2147    3               END;
      378     2148    2           END;
      379     2149
      380     2150         /* Save it now that we have calculated it */
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:12   
      381     2151    1       IF PRIME_INDEX < %MAX_PRIME_SAVE
      382     2152    2       THEN DO;
      383     2153    2           PRIME_SAVER.PRIM(PRIME_INDEX) = NUMB_CALC;
      384     2154    2           END;
      385     2155
      386     2156         /* Set ra record */
      387     2157    1   NEXTRA1:
      388     2158    1       UWA.RA.LOWDBK = ADJ_LOW_DBK;
      389     2159    1       UWA.RA.HIGHDBK = ADJ_HIGH_DBK;
      390     2160         /* Check if user specified null option in calc
      391     2161            interval clause */
      392     2162    1       IF UWA.AC.CALC_NULL = 1 THEN
      393     2163    2       DO;
      394     2164    2           UWA.RA.CALC_HDRS = 0;
      395     2165    2           UWA.RA.HDR_OFFS = 0;
      396     2166    2           END;
      397     2167    1       ELSE
      398     2168    2       DO;
      399     2169    2           UWA.RA.CALC_HDRS = NUMB_CALC;
      400     2170    2           UWA.RA.HDR_OFFS = CALC_OFFS;
      401     2171    2           END;
      402     2172    1       CALL FCURR_R_6('RA  ') ALTRET(ERROR1);
      403     2173    1       CALL MODIFYIA_6('RA  ') ALTRET(ERROR1);
      404     2174    1       GOTO NXTRA;
      405     2175    1   CKAC:
      406     2176    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1);
      407     2177    1   CKRNG:
      408     2178    1       CALL FETCHNS_6('OA-AC   ') ALTRET(SET_POINT); /* Get next ac */
      409     2179    1       IF UWA.AC.PAGE_TYP = 0 /* Inttegrated */ THEN
      410     2180    1           UWA.AC.SPACE_AVAIL = UWA.AC.PAGE_SIZE - 12;
      411     2181    1       IF UWA.AC.CALC_NULL = 0 THEN
      412     2182    1           IF UWA.AC.DBK_CALC <= UWA.AC.DBK_PAGE THEN
      413     2183    2           DO;
      414     2184         /* Calc number of calc hdrs per page */
      415     2185    2               CHPP = UWA.AC.DBK_PAGE/UWA.AC.DBK_CALC;
      416     2186         /* Calc lrgst calc hdr offset */
      417     2187    2               HLN = ((CHPP-1)*UWA.AC.DBK_CALC)+1;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:13   
      418     2188         /* Adjust avail space for offset array space */
      419     2189    2               OA_SPACE = HLN*2;
      420     2190    3               DO WHILE(MOD(OA_SPACE,4) ~= 0);
      421     2191    3                   OA_SPACE = OA_SPACE + 1;
      422     2192    3                   END;
      423     2193    2               UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL - OA_SPACE;
      424     2194         /* Adjust avail space for calc hdr space */
      425     2195    2               UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL -
      426     2196    2                  (CHPP*(4+(2*GLOBAL_SIZE)));
      427     2197    2               END;
      428     2198    1           ELSE UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL - 4;
      429     2199    1       ELSE UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL - 4;
      430     2200    1       CALL FCURR_R_6('AC  ') ALTRET(ERROR1);
      431     2201    1       CALL MODIFY_6('AC  ') ALTRET(ERROR1);
      432     2202    1   CKRNG2:
      433     2203         /* Determine if all record ranges are within the
      434     2204            area they re assigned to */
      435     2205    1       CALL FETCHNS_6('AC-RA   ') ALTRET(SRT_RA); /* Get next ra */
      436     2206    1       DBK_RA = UWA.DIRECT_REF;
      437     2207    1       IF UWA.RA.LOWDBK < UWA.AC.MIN_DBK THEN
      438     2208    1           GOTO RNGERR; /* Low range value < low area */
      439     2209    1       IF UWA.RA.HIGHDBK <= UWA.AC.MAX_DBK THEN
      440     2210    1           GOTO CKRNG2; /* High range < high area  value */
      441     2211    1   RNGERR: /* Range error - low range value of record < low
      442     2212         area value for dbk */
      443     2213    1       CALL FCURR_R_6('AC  ') ALTRET(ERROR1); /* Get current ac */
      444     2214    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn of ac */
      445     2215    1       CALL SET_FIELDS(2,30,UWA.SN.SENAME);
      446     2216    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1); /* Get rc for this ra */
      447     2217    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn of rc */
      448     2218    1       CALL SET_FIELDS(1,30,UWA.SN.SENAME);
      449     2219    1       CALL ERROR (2302);
      450     2220        /*E*     ERROR:    ZIG-ZIG_BAD_KEY_RANGE-C
      451     2221        MESSAGE: The range specified for the record %U1 is invalid because
      452     2222                 it is not contained within the range of keys assigned to
      453     2223                 to area %U2.
      454     2224        */
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:14   
      455     2225    1       TEMP_UBIN_WORD = DBK_RA;
      456     2226    1       CALL FETCHD_6('RA  ', TEMP_UBIN_WORD) ALTRET(ERROR1); /*Reestablish position*/
      457     2227    1       GOTO CKRNG2;
      458     2228         /* Finished going thru ra's for this rc */
      459     2229    1   SRT_RA:
      460     2230    1       GOTO CKRNG;
      461     2231         /* Finished going thru ac's */
      462     2232    1   SET_POINT:
      463     2233         /* Go thru all sc and determine if the set spans more
      464     2234            than one area and set ptrsz */
      465     2235    1       CALL FETCHOS_6('OA-SC   ') ALTRET(ERROR1); /* Start at beginning */
      466     2236    1   NEXTSET:
      467     2237    1       CALL FETCHNS_6('OA-SC   ') ALTRET(NX_SC); /* Get next sc */
      468     2238    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn of sc */
      469     2239    1       IF UWA.SN.SENAME = '*CALC' THEN
      470     2240    2       DO;
      471     2241    2           UWA.SC.SETGLO = 1; /* Set spans more than 1 area */
      472     2242    2           UWA.SC.PTRSZ = GLOBAL_SIZE;
      473     2243    2           CALL FCURR_R_6('SC  ') ALTRET(ERROR1);
      474     2244    2           CALL MODIFY_6('SC  ') ALTRET(ERROR1);
      475     2245    2           GOTO NEXTSET;
      476     2246    2           END;
      477     2247         /* Go thru each occurrence of a sc, so/sm,
      478     2248            rc.  For each rc determine if record is in multi
      479     2249            areas.  Determine pointer size for each rc record*/
      480     2250    1       DBK_LOC_AREA = -1;
      481     2251    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1); /* Just in case we hit upon
      482     2252         current occurrence */
      483     2253    1       MAX_PTR_SIZE = 2; /* Set for ptrs are local clause */
      484     2254    1   NEXTRS:
      485     2255    1       CALL FETCHNS_6('SC-SOSM ') ALTRET(SET_LOC); /* Get next so/sm */
      486     2256    1       IF UWA.RECORD_NAME = 'SO'
      487     2257    1       THEN DBK = 1;
      488     2258    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1); /* Get rc of so/sm */
      489     2259    1       IF DBK = 1
      490     2260    1       THEN DBK = UWA.DIRECT_REF;
      491     2261    1       IF UWA.RC.WITHINA ~= 0 & UWA.SC.USER_PTS = 0 THEN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:15   
      492     2262    1           GOTO SET_GLO; /* Rec in more than 1 area*/
      493     2263    1       CALL FETCHNS_6('RC-RA   ') ALTRET(NEXTSET); /* Get next ra */
      494     2264    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1); /* Get ac of this ra */
      495     2265    1       IF DBK_LOC_AREA = -1 THEN
      496     2266    2       DO;
      497     2267    2           DBK_LOC_AREA = UWA.DIRECT_REF; /* Dbk of ac */
      498     2268    2           AREA.MAX_DBK = UWA.AC.KEYS_ALLOC;
      499     2269    2           LOCAL_SIZE = 2;
      500     2270    2           TOTAL = AREA.MAX_DBK + UWA.AC.KEYS_RSRVD;
      501     2271    2           IF TOTAL > 262143 THEN
      502     2272    2               LOCAL_SIZE = 3;
      503     2273    2           IF TOTAL > 134217727 THEN
      504     2274    2               LOCAL_SIZE = 4;
      505     2275    2           IF LOCAL_SIZE > MAX_PTR_SIZE THEN
      506     2276    2               MAX_PTR_SIZE = LOCAL_SIZE;
      507     2277    2           END;
      508     2278    1       IF UWA.SC.USER_PTS = 1 THEN
      509     2279    1           GOTO NEXTRS;
      510     2280    1       IF DBK_LOC_AREA ~= UWA.DIRECT_REF THEN
      511     2281    1           GOTO SET_GLO;
      512     2282    1       GOTO NEXTRS;
      513     2283    1   SET_GLO:
      514     2284    1       UWA.SC.PTRSZ = GLOBAL_SIZE; /* Set pointer size */
      515     2285    1       UWA.SC.SETGLO = 1;
      516     2286    1       CALL FCURR_R_6('SC  ') ALTRET(ERROR1);
      517     2287    1       CALL MODIFY_6('SC  ') ALTRET(ERROR1);
      518     2288    1       GOTO NEXTSET;
      519     2289    1   SET_LOC: /* Finished so/smset for this sc */
      520     2290    1       IF UWA.SC.USER_PTS = 1 THEN
      521     2291    1           LOCAL_SIZE = MAX_PTR_SIZE;
      522     2292    1       UWA.SC.PTRSZ = LOCAL_SIZE;
      523     2293    1       UWA.SC.SETGLO = 0;
      524     2294    1       CALL FCURR_R_6('SC  ') ALTRET(ERROR1);
      525     2295    1       CALL MODIFY_6('SC  ') ALTRET(ERROR1);
      526     2296        /*
      527     2297              Determine if the areas for the user ptrs
      528     2298            ( POINTERS ARE LOCAL ) that the member records and the
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:16   
      529     2299            owner records belong to intersect.
      530     2300        */
      531     2301    1       IF UWA.SC.SETTYPE ~= 0 | UWA.SC.USER_PTS = 0
      532     2302    1       THEN GOTO NEXTSET;
      533     2303    1       D = 0;
      534     2304    1       TEMP_UBIN_WORD = DBK;
      535     2305    1       CALL FETCHD_6('RC  ',TEMP_UBIN_WORD) ALTRET(ERROR1);
      536     2306    1   LOPST:
      537     2307    1       CALL FETCHNS_6('RC-RA   ') ALTRET(LOPEND);
      538     2308    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);
      539     2309    1       D = D + 1;
      540     2310    1       AREAS.DBKAC(D) = UWA.DIRECT_REF;
      541     2311    1       GOTO LOPST;
      542     2312    1   LOPEND:
      543     2313        /*
      544     2314              Go through all member RC(s) of this set and determine
      545     2315            if the areas of each member rc is a subset of the
      546     2316            owner RC.
      547     2317        */
      548     2318    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);
      549     2319    1   LOPSM:
      550     2320    1       CALL FETCHNS_6('SC-SOSM ') ALTRET(NEXTSET);
      551     2321    1       IF UWA.RECORD_NAME = 'SO'
      552     2322    1       THEN GOTO LOPSM;
      553     2323    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);
      554     2324    1   LOPRA:
      555     2325    1       CALL FETCHNS_6('RC-RA   ') ALTRET(LOPSM);
      556     2326    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);
      557     2327    2       DO I = 0 TO D;
      558     2328    2           IF AREAS.DBKAC(I) = UWA.DIRECT_REF
      559     2329    2           THEN GOTO LOPRA;
      560     2330    2           END;
      561     2331    1       CALL FCURR_R_6('SC  ') ALTRET(ERROR1);
      562     2332    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);
      563     2333    1       CALL SET_FIELDS(1,30,UWA.SN.SENAME);
      564     2334    1       CALL ERROR(9032); /* DMCL_LOCAL_POINTER_ERR */
      565     2335        /*E*     ERROR:    ZIG-DMCL_LOCAL_POINTER_ERR-C
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:17   
      566     2336        MESSAGE: For the set "%U1" the areas that the member records
      567     2337                 belong to must be a subset of the areas that
      568     2338                 the owner record belongs to.
      569     2339        */
      570     2340    1       GOTO NEXTSET;
      571     2341         /* Go thru all sc type RTYP.KC and check
      572     2342            1. Duplicate keys cannot exist
      573     2343            2. Primary keys must have a value of zero
      574     2344            3. Secondarry keys must have a value assigned*/
      575     2345    1   NX_SC:
      576     2346    1       Z1 = UWA.OA.NUMB_SC;
      577     2347    1       Z = Z1;
      578     2348    1       TEMP_UBIN_WORD = UWA.DA.FRST_KC;
      579     2349    1       CALL FETCHD_6('SN  ', TEMP_UBIN_WORD) ALTRET(ERROR1);
      580     2350    1       DBK = UWA.DIRECT_REF;
      581     2351    1       CALL FETCHNS_6('SN-SE   ') ALTRET(ERROR1);
      582     2352    1       GOTO NX_SC2;
      583     2353    1   NX_SC0:
      584     2354    1       TEMP_UBIN_WORD = DBK;
      585     2355    1       CALL FETCHD_6('SN  ', TEMP_UBIN_WORD) ALTRET(ERROR1); /* Reestablish position*/
      586     2356    1       CALL FETCHNS_6('DA-SN   ') ALTRET(TERM);
      587     2357    1       DBK = UWA.DIRECT_REF;
      588     2358    1       IF UWA.SN.SETYPE ~=31 THEN /* Not a key */
      589     2359    1           GOTO TERM;
      590     2360    1       Z1 = Z1 - 1;
      591     2361    1       Z = Z1;
      592     2362    1       CALL FETCHNS_6('SN-SE   ') ALTRET(ERROR1);
      593     2363    1   NX_SC2:
      594     2364    1       IF UWA.SC.SETTYPE = 2 THEN
      595     2365    2       DO; /* Primary key */
      596     2366    2           IF UWA.SC.INDEX_ID ~= 0 THEN
      597     2367    2               CALL ERROR(2303);
      598     2368        /*E*     ERROR:    ZIG-ZIG_LOCAL_KEYS_EQ_ZERO-C
      599     2369        MESSAGE: Local keys must be assigned a  value of zero.
      600     2370        */
      601     2371    2           GOTO NX_SC0;
      602     2372    2           END;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:18   
      603     2373    1       IF UWA.SC.SETTYPE = 3 THEN
      604     2374    2       DO;
      605     2375    2           IF UWA.SC.INDEX_ID = 0 THEN
      606     2376    3           DO;
      607     2377    3               CALL ERROR(2304);
      608     2378        /*E*     ERROR:    ZIG-ZIG_REC_KEYS_GR_ZERO-C
      609     2379        MESSAGE: Record keys must be assigned a value greater than zero.
      610     2380        */
      611     2381    3               GOTO NX_SC0;
      612     2382    3               END;
      613     2383    2           END;
      614     2384    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);
      615     2385    1       IF UWA.SN.SETYPE = 31 THEN /* RTYP.KC */
      616     2386    2       DO;
      617     2387    2           X= UWA.SC.INDEX_ID;
      618     2388    2   NX_SC3:
      619     2389    2           CALL FETCHNS_6('DA-SN   ') ALTRET(NX_SC0);
      620     2390    2           CALL FETCHNS_6('SN-SE   ') ALTRET(ERROR1);
      621     2391    2           Z = Z - 1;
      622     2392    2           IF Z = 0 THEN
      623     2393    2               GOTO NX_SC0;
      624     2394    2           IF UWA.RECORD_NAME ~= 'SC' THEN
      625     2395    2               GOTO NX_SC3;
      626     2396    2           IF UWA.SC.SETTYPE = 3 THEN
      627     2397    2               IF X = UWA.SC.INDEX_ID THEN
      628     2398    2                   CALL ERROR(2305);
      629     2399        /*E*     ERROR:    ZIG-ZIG_KEYS_SAME_NAME-C
      630     2400        MESSAGE: Cannot have two keys with the same name.
      631     2401        */
      632     2402    2           GOTO NX_SC3;
      633     2403    2           END;
      634     2404         /* Finished going thru all sc's */
      635     2405    1   TERM: /* Check that all areas have been assigned
      636     2406         attributes by the dmcl */
      637     2407    1       TOTAL_KEYS = 0;
      638     2408    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1);
      639     2409         /* Go through all ac records and determine total
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:19   
      640     2410            number of dbks */
      641     2411    1   CHECK_1:
      642     2412    1       CALL FETCHNS_6('OA-AC   ') ALTRET(CHECK_2);
      643     2413    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);
      644     2414    1       IF UWA.AC.DEFAULTS = 0 /* Was area defined */
      645     2415    2       THEN DO;
      646     2416    2           CALL SET_FIELDS(1,30,UWA.SN.SENAME);
      647     2417    2           CALL ERROR(2306);
      648     2418        /*E*     ERROR:    ZIG-ZIG_AREA_NOT_IN_DMCL-C
      649     2419        MESSAGE: The area %U1 has not been referenced by the DMCL.
      650     2420                 All areas in the schema must be defined in the DMCL and
      651     2421                 the number of data base keys given.
      652     2422        */
      653     2423    2           END;
      654     2424    1       TOTAL_KEYS = TOTAL_KEYS + UWA.AC.KEYS_ALLOC;
      655     2425    1       GOTO CHECK_1;
      656     2426    1   CHECK_2: /* Check that total keys in all areas not > 2**36 - 1*/
      657     2427    1       IF TOTAL_KEYS > MAXI THEN
      658     2428    1           CALL ERROR(2307);
      659     2429        /*E*     ERROR:    ZIG-ZIG_TOO_MANY_DB_KEYS-C
      660     2430        MESSAGE: The total number of data base keys allocated to all areas
      661     2431                 of the data base exceeds (2**36)-1.
      662     2432        */
      663     2433         /* Check all records for duplicate type codes */
      664     2434    1       TYPE_CD = '0'B;
      665     2435    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);
      666     2436    1   CHECK_3: /**Go thru all rc records and check rtype field
      667     2437         to see if duplicate types */
      668     2438    1       CALL FETCHNS_6('OA-RC   ') ALTRET(CHECK_3A);
      669     2439    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn */
      670     2440    1       IF UWA.RC.RTYPE = 0 THEN /* Was record assigned type*/
      671     2441    1           GOTO CHECK_3;
      672     2442    1       IF ~TYPE_CD(UWA.RC.RTYPE) THEN
      673     2443    1           TYPE_CD(UWA.RC.RTYPE) = '1'B;
      674     2444    1       ELSE
      675     2445    2       DO;
      676     2446    2           CALL ERROR(ZIG_DUP_TYPE);
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:20   
      677     2447    2           END;
      678     2448        /*E*     ERROR:    ZIG-ZIG_DUP_TYPE-C
      679     2449        MESSAGE: A record TYPE is not uniquely defined in the DMCL.
      680     2450        */
      681     2451    1       GOTO CHECK_3;
      682     2452         /* Assign default record types if not assigned */
      683     2453    1   CHECK_3A:
      684     2454    1       X = 1;
      685     2455    2       DO WHILE(( TYPE_CD(X) = '1'B) AND ( X < 4000 ));
      686     2456    2           X = X + 1;
      687     2457    2           END;
      688     2458    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);
      689     2459    1   CHECK_3B:
      690     2460    1       CALL FETCHNS_6('OA-RC   ') ALTRET(CHECK_4); /* Get next rc */
      691     2461    1       IF UWA.RC.RTYPE = 0 THEN
      692     2462    2       DO;
      693     2463    2           UWA.RC.RTYPE = X;
      694     2464    2           CALL MODIFY_6('RC  ') ALTRET(ERROR1);
      695     2465    2           X = X + 1;
      696     2466    3           DO WHILE(( TYPE_CD(X) = '1'B) AND ( X < 4000 ));
      697     2467    3               X = X + 1;
      698     2468    3               END;
      699     2469    2           END;
      700     2470    1       GOTO CHECK_3B;
      701     2471         /* Check that all data base procedures referenced
      702     2472            in ddl have been declared in dmcl */
      703     2473    1   CHECK_4:
      704     2474    1       CALL FETCHOS_6('DA-PN   ') ALTRET(ERROR1); /* Get da record */
      705     2475    1   CHECK_41:
      706     2476    1       CALL FETCHNS_6('DA-PN   ') ALTRET(CHECK_5); /* Get next pn */
      707     2477    1       IF UWA.PN.LANG = 0 THEN
      708     2478    2       DO;
      709     2479    2           CALL SET_FIELDS(1,30,UWA.PN.PNAME);
      710     2480    2           CALL ERROR(2308);
      711     2481        /*E*     ERROR:    ZIG-ZIG_PROC_NOT_IN_DMCL-C
      712     2482        MESSAGE: The data_base_procedure %U1 has been referenced by the
      713     2483                 schema DDL; however, corresponding DMCL entries cannot be
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:21   
      714     2484                 located.
      715     2485        */
      716     2486    2           END;
      717     2487    1       GOTO CHECK_41;
      718     2488         /* E r r o r    e x i t s */
      719     2489    1   ERROR1:
      720     2490    1       CALL ABORT;
      721     2491    1   CHECK_5:
      722     2492    1   END P2DMCL;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:22   
--  Include file information  --

   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIA_IDS_DCL.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure P2DMCL.

   Procedure P2DMCL requires 1181 words for executable code.
   Procedure P2DMCL requires 200 words of local(AUTO) storage.

    No errors detected in file ZIG$M_P8.:ZIC0TSI    .

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:23   

 Object Unit name= P2DMCL                                     File name= ZIG$M_P8.:ZIC0TOU
 UTS= SEP 05 '97 12:08:18.48 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   184    270  P2DMCL
    1  LblCom even  none     1      1  ERX
    2  LblCom even  none     1      1  NUM_ERROR_MSG
    3  LblCom even  none     1      1  NUM_WARN_MSG
    4  LblCom even  none     1      1  ALLOCATE_END
    5  LblCom even  none     2      2  SUBSCHEMA_KEY
    6  LblCom even  none     1      1  BUFFER$
    7  LblCom even  none     1      1  ERROR_IO
    8  LblCom even  none     1      1  BUFFER_LEN
    9  LblCom even  none     2      2  UWA_KEY
   10  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   11  LblCom even  none     2      2  RVA_KEY
   12  LblCom even  none     2      2  IA__KEY
   13  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   14  LblCom even  none    32     40  SEARCHR_NB
   15  LblCom even  none    32     40  SEM_COM
   16  LblCom even  none    32     40  DMCL_XLATE
   17  LblCom even  none    32     40  Q2_PERCENT
   18  LblCom even  none   656   1220  UWA
   19  RoData even  UTS     35     43  P2DMCL
   20   Proc  even  none  1181   2235  P2DMCL
   21  RoData even  none    55     67  P2DMCL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    20      0   yes            yes      Std        0  P2DMCL
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FETCHOS_6
 yes     yes           Std       1 FETCHNS_6
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       2 FINDD_6
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 STRE_6
         yes           Std       3 SET_FIELDS
         yes           Std       1 WARNING
 yes     yes           Std       1 MODIFY_6
 yes     yes           Std       1 MODIFYIA_6
         yes           Std       1 ERROR
         yes           Std       0 ABORT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:25   


        1        1        /*M* ZIG$DDP8         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        P2DMCL:
        8        8            PROC;

      8 20 000000   000000 700200 xent  P2DMCL       TSX0  ! X66_AUTO_0
        20 000001   000310 000000                    ZERO    200,0

        9        9         /*Define internal cell current. Current determines if
       10       10         a clause has been specified more than once
       11       11         cm  *Proc*         *Set*    *Record*       *Area*
       12       12         1                  mode      type           FILE_CODE
       13       13         2   parameter                POINTER_SEQ
       14       14         3                                           allocate
       15       15         4                                           PAGE_INTERVAL
       16       16         5                                           CALC_INTERVAL
       17       17         6                                           PAGE_SIZE
       18       18         7   CLAUSE_TYPE                             LOAD_LIMIT
       19       19         8                                           inventory
       20       20         9                                           organization
       21       21         11   PROGRAM_NAME
       22       22         12   author
       23       23         16   RECORD_NAME
       24       24         25   STATUS_RETURN
       25       25         29   SS_RECORD_NAME
       26       26            */
       27       27    1   DCL PA_PLACE UBIN WORD;
       28       28    1   DCL USER_PLACE UBIN WORD;
       29       29    1   DCL CHPP SBIN HALF;
       30       30    1   DCL HLN SBIN HALF;
       31       31    1   DCL OA_SPACE SBIN HALF;
       32       32    1   DCL 01 AREA STATIC,
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:26   
       33       33    1         02 ALLOC SBIN WORD,
       34       34    1         02 BASE_DBK SBIN WORD,
       35       35    1         02 MIN_DBK SBIN WORD,
       36       36    1         02 MAX_DBK SBIN WORD,
       37       37    1         02 MIN_PAGE SBIN WORD,
       38       38    1         02 FIRST_INV_PG SBIN WORD,
       39       39    1         02 MAX_PAGE SBIN WORD,
       40       40    1         02 DBK_PAGE SBIN WORD,
       41       41    1         02 DBK_PAGE_REDEF (0:35) REDEF DBK_PAGE BIT(1),
       42       42    1         02 DBK_CALC SBIN WORD,
       43       43    1         02 LINE_BITS SBIN WORD,
       44       44    1         02 INV_THRESH SBIN HALF,
       45       45    1         02 PGS_INV_PG SBIN HALF,
       46       46    1         02 INV_UNIT SBIN HALF,
       47       47    1         02 PAGE_SIZE SBIN HALF,
       48       48    1         02 SECTORS_PAGE SBIN HALF;
       49       49    1   DCL 1 AREAS STATIC,
       50       50    1         2 DBKAC(0:99) SBIN WORD;
       51       51    1   DCL HIGH_DBK SBIN WORD STATIC;
       52       52    1   DCL LOW_DBK SBIN WORD STATIC;
       53       53    1   DCL ADJ_LOW_DBK SBIN WORD STATIC;
       54       54    1   DCL ADJ_HIGH_DBK SBIN WORD STATIC;
       55       55    1   DCL CALC_OFFS SBIN WORD STATIC;
       56       56    1   DCL NUMB_CALC SBIN WORD STATIC;
       57       57    1   DCL T1 SBIN WORD STATIC;
       58       58    1   DCL T3 SBIN WORD STATIC;
       59       59    1   DCL LOCAL_SIZE SBIN WORD STATIC;
       60       60    1   DCL GLOBAL_SIZE SBIN WORD STATIC;
       61       61    1   DCL LOC_AREA SBIN WORD;
       62       62    1   DCL E SBIN HALF STATIC;
       63       63    1   DCL ARG SBIN HALF;
       64       64    1   DCL LOCK_BITS BIT(36);
       65       65    1   DCL ALL_ZEROS BIT(36) STATIC INIT('0'B);
       66       66    1   DCL LOCK_TYPE BIT(36);
       67       67    1   DCL TEST_TYPE BIT(36);
       68       68    1   DCL RNG SBIN WORD STATIC INIT(0);
       69       69    1   DCL PART_RNG SBIN WORD STATIC INIT(0);
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:27   
       70       70    1   DCL P3 PTR;
       71       71    1   DCL I SBIN HALF;
       72       72    1   DCL X SBIN HALF;
       73       73    1   DCL D SBIN;
       74       74    1   DCL ROOT SBIN;
       75       75        %EQU MAX_PRIME_SAVE = 19;
       76       76    1   DCL 1 PRIME_SAVER(0:%MAX_PRIME_SAVE) DALIGNED,
       77       77    1         2 N_CALC SBIN,
       78       78    1         2 PRIM SBIN;
       79       79    1   DCL PRIME_INDEX SBIN;
       80       80    1   DCL PROC_TYPE SBIN HALF;
       81       81    1   DCL INV_FLG SBIN HALF INIT(0) STATIC;
       82       82    1   DCL DCLR SBIN HALF INIT(1) STATIC;
       83       83    1   DCL TOTAL_KEYS UBIN WORD;
       84       84    1   DCL S1 CHAR(16) INIT(' ') STATIC;
       85       85    1   DCL S2 CHAR(16) INIT(' ') STATIC;
       86       86    1   DCL S3 CHAR(16) INIT(' ') STATIC;
       87       87    1   DCL S4 CHAR(16) INIT(' ') STATIC;
       88       88    1   DCL SUBEX_STK_SZ SBIN HALF STATIC INIT(0);
       89       89    1   DCL DELETE BIT(3) STATIC INIT('111'B);
       90       90    1   DCL FLD_NAME CHAR(30) STATIC;
       91       91    1   DCL REC_NAME CHAR(30) STATIC;
       92       92    1   DCL REFR SBIN HALF STATIC INIT(2);
       93       93    1   DCL X131072 SBIN WORD STATIC INIT(131072);
       94       94    1   DCL TYPE_CD(0:4319) BIT(1);
       95       95    1   DCL SUBH1 CHAR(40) STATIC INIT(' ');
       96       96    1   DCL PNAME CHAR(30);
       97       97    1   DCL ZFOR BIT(1);
       98       98    1   DCL MAXI UBIN WORD STATIC ALIGNED INIT(BITBIN('777777777777'O));
       99       99    1   DCL Z SBIN HALF;
      100      100    1   DCL Z1 SBIN HALF;
      101      101    1   DCL ERX SBIN HALF EXT;
      102      102    1   DCL FIRST SBIN HALF STATIC INIT(1);
      103      103    1   DCL LAST SBIN HALF STATIC INIT(2);
      104      104    1   DCL DBK SBIN WORD;
      105      105    1   DCL DBK_RA SBIN WORD;
      106      106        %INCLUDE ZIA_IDS_DCL;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:28   
      107      214        %INCLUDE ZIG_DBA_INT;
      108      262        %INCLUDE ZI_ERRORS_SUBS;
      109      782        %INCLUDE ZI_SUB4_CAN;
      110     1439        %INCLUDE ZIG_GENERAL;
      111     1547        %UWA;
      112     1882         /* Local pointers or dbks */
      113     1883    1   DCL DBK_SN SBIN WORD STATIC;
      114     1884    1   DCL DBK_SF SBIN WORD STATIC;
      115     1885    1   DCL DBK_LOC_AREA SBIN WORD STATIC;
      116     1886    1   DCL TOTAL_RSRVD UBIN WORD;
      117     1887    1   DCL TOTAL UBIN WORD;
      118     1888    1   DCL KEYS_RESERVED UBIN WORD INIT(0) STATIC;
      119     1889    1   DCL MAX_PTR_SIZE SBIN HALF;
      120     1890    1   DCL TEMP_UBIN_WORD UBIN WORD;
      121     1891        %EJECT;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:29   
      122     1892    1       PRIME_SAVER = '0'B;

   1892 20 000002   000100 100400                    MLR     fill='000'O
        20 000003   000000 000001 21                 ADSC9   0                        cn=0,n=1
        20 000004   200022 000240                    ADSC9   PRIME_SAVER,,AUTO        cn=0,n=160

      123     1893         /* Start   of   program */
      124     1894    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1); /* Get oa record */

   1894 20 000005   000002 630400 21                 EPPR0   2
        20 000006   000001 631400 21                 EPPR1   1
        20 000007   000000 701000 xent               TSX1    FETCHOS_6
        20 000010   002231 702000 20                 TSX2    ERROR1

      125     1895    1       AREA.MIN_PAGE = 1;

   1895 20 000011   000001 235007                    LDA     1,DL
        20 000012   000004 755000 0                  STA     AREA+4

      126     1896    1       AREA.MAX_DBK = 0;

   1896 20 000013   000003 450000 0                  STZ     AREA+3

      127     1897    1       TOTAL_RSRVD = 0;

   1897 20 000014   200302 450100                    STZ     TOTAL_RSRVD,,AUTO

      128     1898         /* Go through all ac records and set all default values
      129     1899            to all unspecified attrigutes */
      130     1900    1   DOAC:
      131     1901    1       CALL FETCHNS_6('OA-AC   ') ALTRET(DORA); /* Get next ac record */

   1901 20 000015   000002 630400 21    DOAC         EPPR0   2
        20 000016   000001 631400 21                 EPPR1   1
        20 000017   000000 701000 xent               TSX1    FETCHNS_6
        20 000020   000400 702000 20                 TSX2    DORA

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:30   
      132     1902    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* In case of error */

   1902 20 000021   000003 630400 21                 EPPR0   3
        20 000022   000001 631400 21                 EPPR1   1
        20 000023   000000 701000 xent               TSX1    FETCHOS_6
        20 000024   002231 702000 20                 TSX2    ERROR1

      133     1903         /* Page interval */
      134     1904    1       IF UWA.AC.PAGE_TYP = 3

   1904 20 000025   000237 235000 18                 LDA     UWA+159
        20 000026   000003 115007                    CMPA    3,DL
        20 000027   000015 600000 20                 TZE     DOAC

      135     1905    1       THEN GOTO DOAC;
      136     1906    1       IF UWA.AC.DBK_PAGE = 0 & UWA.AC.PAGE_TYP ~= 3

   1906 20 000030   400000 220003                    LDX0    -131072,DU
        20 000031   000253 236000 18                 LDQ     UWA+171
        20 000032   000034 600000 20                 TZE     s:1906+4
        20 000033   000000 220003                    LDX0    0,DU
        20 000034   400000 221003                    LDX1    -131072,DU
        20 000035   000003 115007                    CMPA    3,DL
        20 000036   000040 601000 20                 TNZ     s:1906+8
        20 000037   000000 221003                    LDX1    0,DU
        20 000040   000000 636011                    EAQ     0,X1
        20 000041   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000042   000000 636010                    EAQ     0,X0
        20 000043   200306 376100                    ANQ     TEMP_UBIN_WORD+1,,AUTO
        20 000044   000047 600000 20                 TZE     s:1908

      137     1907    1       THEN UWA.AC.DBK_PAGE = 64;

   1907 20 000045   000100 236007                    LDQ     64,DL
        20 000046   000253 756000 18                 STQ     UWA+171

      138     1908    1       IF UWA.AC.DBK_CALC = 0 & UWA.AC.CALC_NULL = 0 THEN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:31   

   1908 20 000047   400000 220003                    LDX0    -131072,DU
        20 000050   000254 236000 18                 LDQ     UWA+172
        20 000051   000053 600000 20                 TZE     s:1908+4
        20 000052   000000 220003                    LDX0    0,DU
        20 000053   400000 221003                    LDX1    -131072,DU
        20 000054   000241 235000 18                 LDA     UWA+161
        20 000055   000057 600000 20                 TZE     s:1908+8
        20 000056   000000 221003                    LDX1    0,DU
        20 000057   000000 636011                    EAQ     0,X1
        20 000060   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000061   000000 636010                    EAQ     0,X0
        20 000062   200306 376100                    ANQ     TEMP_UBIN_WORD+1,,AUTO
        20 000063   000066 600000 20                 TZE     s:1910

      139     1909    1           UWA.AC.DBK_CALC = UWA.AC.DBK_PAGE;

   1909 20 000064   000253 236000 18                 LDQ     UWA+171
        20 000065   000254 756000 18                 STQ     UWA+172

      140     1910    1       UWA.AC.MIN_PAGE = 1;

   1910 20 000066   000001 236007                    LDQ     1,DL
        20 000067   000247 756000 18                 STQ     UWA+167

      141     1911    1       IF UWA.AC.SECTORS_PAGE = 0 THEN

   1911 20 000070   000264 235000 18                 LDA     UWA+180
        20 000071   000074 601000 20                 TNZ     s:1914

      142     1912    1           UWA.AC.SECTORS_PAGE = 8;

   1912 20 000072   000010 235007                    LDA     8,DL
        20 000073   000264 755000 18                 STA     UWA+180

      143     1913         /* Refresh area record for next ac */
      144     1914    1       AREA.ALLOC = UWA.AC.MAX_DBK; /* # keys for this area */
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:32   

   1914 20 000074   000246 235000 18                 LDA     UWA+166
        20 000075   000000 755000 0                  STA     AREA

      145     1915    1       IF AREA.ALLOC = 0 THEN

   1915 20 000076   000101 601000 20                 TNZ     s:1917

      146     1916    1           AREA.ALLOC = 6400;

   1916 20 000077   014400 235007                    LDA     6400,DL
        20 000100   000000 755000 0                  STA     AREA

      147     1917    1       AREA.LINE_BITS = 0;

   1917 20 000101   000011 450000 0                  STZ     AREA+9

      148     1918    1       AREA.MIN_DBK = 0;

   1918 20 000102   000002 450000 0                  STZ     AREA+2

      149     1919    1       AREA.DBK_PAGE = UWA.AC.DBK_PAGE; /* PAGE_INTERVAL */

   1919 20 000103   000253 235000 18                 LDA     UWA+171
        20 000104   000007 755000 0                  STA     AREA+7

      150     1920    1       AREA.DBK_CALC = UWA.AC.DBK_CALC; /* CALC_INTERVAL */

   1920 20 000105   000254 235000 18                 LDA     UWA+172
        20 000106   000010 755000 0                  STA     AREA+8

      151     1921    1       AREA.INV_THRESH = 0;

   1921 20 000107   000000 220003                    LDX0    0,DU
        20 000110   000012 740000 0                  STX0    AREA+10

      152     1922    1       AREA.INV_UNIT = 0;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:33   

   1922 20 000111   000014 740000 0                  STX0    AREA+12

      153     1923         /* Calculate line bits */
      154     1924        /*       AREA.LINE_BITS = LOG2(AREA.DBK_PAGE); */
      155     1925         /* since 2**line_bits = dbk_page, the only bit position on in
      156     1926            dbk_page will give correct value for line_bits */
      157     1927    1       X = 35;

   1927 20 000112   000043 221003                    LDX1    35,DU
        20 000113   200017 741100                    STX1    X,,AUTO

      158     1928    2       DO WHILE AREA.DBK_PAGE_REDEF(X) = '0'B;

   1928 20 000114   200017 235100                    LDA     X,,AUTO
        20 000115   000022 731000                    ARS     18
        20 000116   000120 605000 20                 TPL     s:1928+4
        20 000117   000044 035003                    ADLA    36,DU
        20 000120   000000 066405                    CMPB    filb='0'B
        20 000121   000007 000001 0                  BDSC    AREA+7,A                 by=0,bit=0,n=1
        20 000122   000000 000022 21                 BDSC    0                        by=0,bit=0,n=18
        20 000123   000137 601000 20                 TNZ     s:1931

      159     1929    2           X = X - 1;

   1929 20 000124   200017 220100                    LDX0    X,,AUTO
        20 000125   777777 621010                    EAX1    -1,X0
        20 000126   200017 741100                    STX1    X,,AUTO

      160     1930    2           END;

   1930 20 000127   200017 235100                    LDA     X,,AUTO
        20 000130   000022 731000                    ARS     18
        20 000131   000133 605000 20                 TPL     s:1930+4
        20 000132   000044 035003                    ADLA    36,DU
        20 000133   000000 066405                    CMPB    filb='0'B
        20 000134   000007 000001 0                  BDSC    AREA+7,A                 by=0,bit=0,n=1
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:34   
        20 000135   000000 000022 21                 BDSC    0                        by=0,bit=0,n=18
        20 000136   000124 600000 20                 TZE     s:1929

      161     1931    1       AREA.LINE_BITS = 35 - X;

   1931 20 000137   200017 235100                    LDA     X,,AUTO
        20 000140   000022 731000                    ARS     18
        20 000141   000004 675000 21                 ERA     4
        20 000142   000044 035007                    ADLA    36,DL
        20 000143   000011 755000 0                  STA     AREA+9

      162     1932         /* Calculate pages per inventory page */
      163     1933    1       IF UWA.AC.PER_INV ~= INV_FLG THEN

   1933 20 000144   000201 236000 0                  LDQ     INV_FLG
        20 000145   000022 732000                    QRS     18
        20 000146   000240 116000 18                 CMPQ    UWA+160
        20 000147   000154 600000 20                 TZE     s:1936

      164     1934    1           AREA.PGS_INV_PG = UWA.AC.PAGE_SIZE - 12;

   1934 20 000150   000262 720000 18                 LXL0    UWA+178
        20 000151   777764 622010                    EAX2    -12,X0
        20 000152   000013 742000 0                  STX2    AREA+11
        20 000153   000156 710000 20                 TRA     s:1939

      165     1935    1       ELSE
      166     1936    1           AREA.PGS_INV_PG = 0;

   1936 20 000154   000000 220003                    LDX0    0,DU
        20 000155   000013 740000 0                  STX0    AREA+11

      167     1937         /* Calculate min DATA_BASE_KEY for area
      168     1938            it equals the last max dbk (of lasst area) + 1 */
      169     1939    1       AREA.MIN_DBK = (AREA.MAX_DBK + 1) + KEYS_RESERVED;

   1939 20 000156   000003 236000 0                  LDQ     AREA+3
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:35   
        20 000157   000267 036000 0                  ADLQ    KEYS_RESERVED
        20 000160   000001 036007                    ADLQ    1,DL
        20 000161   000002 756000 0                  STQ     AREA+2

      170     1940         /* Calculate max DATA_BASE_KEY for area
      171     1941            it equals #DBK key for this area starting at
      172     1942            MIN_DBK */
      173     1943         /* Check if total number of data-base-keys plus
      174     1944            number of reserved keys is greater than
      175     1945            68,719,476,735 */
      176     1946    1       TOTAL_KEYS = AREA.MAX_DBK + UWA.AC.KEYS_RSRVD;

   1946 20 000162   000003 236000 0                  LDQ     AREA+3
        20 000163   000244 036000 18                 ADLQ    UWA+164
        20 000164   200074 756100                    STQ     TOTAL_KEYS,,AUTO

      177     1947    1       IF TOTAL_KEYS > MAXI THEN

   1947 20 000165   000261 116000 0                  CMPQ    MAXI
        20 000166   000203 602000 20                 TNC     s:1959
        20 000167   000203 600000 20                 TZE     s:1959

      178     1948    2       DO;

      179     1949    2           UWA.AC.KEYS_RSRVD = MAXI - AREA.MAX_DBK;

   1949 20 000170   000261 236000 0                  LDQ     MAXI
        20 000171   000003 136000 0                  SBLQ    AREA+3
        20 000172   000244 756000 18                 STQ     UWA+164

      180     1950    2           CALL FCURR_R_6('AC  ' ) ALTRET(ERROR1);

   1950 20 000173   000005 630400 21                 EPPR0   5
        20 000174   000001 631400 21                 EPPR1   1
        20 000175   000000 701000 xent               TSX1    FCURR_R_6
        20 000176   002231 702000 20                 TSX2    ERROR1

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:36   
      181     1951    2           CALL WARNING(2301);

   1951 20 000177   000007 630400 21                 EPPR0   7
        20 000200   000001 631400 21                 EPPR1   1
        20 000201   000000 701000 xent               TSX1    WARNING
        20 000202   000000 011000                    NOP     0

      182     1952        /*E*     ERROR:    ZIG-ZIG_TOO_MANY_KEYS-C
      183     1953        MESSAGE: Warning: The total number of DATA_BASE_KEYS plus the number of
      184     1954                 reserved keys for an area is greater than 34,359,738,367.
      185     1955                 Total keys will be set to 34,359,738,367.
      186     1956        */
      187     1957    2           END;

      188     1958         /* Accumulate reserved keys */
      189     1959    1       TOTAL_RSRVD = TOTAL_RSRVD + UWA.AC.KEYS_RSRVD;

   1959 20 000203   200302 236100                    LDQ     TOTAL_RSRVD,,AUTO
        20 000204   000244 036000 18                 ADLQ    UWA+164
        20 000205   200302 756100                    STQ     TOTAL_RSRVD,,AUTO

      190     1960         /* If area is indexed check if index filecode
      191     1961            is the same as data file code */
      192     1962    1       AREA.MAX_DBK = AREA.ALLOC + AREA.MIN_DBK - 1;

   1962 20 000206   000000 236000 0                  LDQ     AREA
        20 000207   000002 036000 0                  ADLQ    AREA+2
        20 000210   000001 136007                    SBLQ    1,DL
        20 000211   000003 756000 0                  STQ     AREA+3

      193     1963         /* Calculate max page in area */
      194     1964    1       T3 =0;

   1964 20 000212   000172 450000 0                  STZ     T3

      195     1965    1       IF MOD(AREA.ALLOC,AREA.DBK_PAGE) = 0 THEN

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:37   
   1965 20 000213   000000 236000 0                  LDQ     AREA
        20 000214   000007 506000 0                  DIV     AREA+7
        20 000215   000044 733000                    LRS     36
        20 000216   000000 116003                    CMPQ    0,DU
        20 000217   000224 601000 20                 TNZ     s:1968

      196     1966    1           T1 = AREA.ALLOC/AREA.DBK_PAGE;

   1966 20 000220   000000 236000 0                  LDQ     AREA
        20 000221   000007 506000 0                  DIV     AREA+7
        20 000222   000171 756000 0                  STQ     T1
        20 000223   000230 710000 20                 TRA     s:1969

      197     1967    1       ELSE
      198     1968    1           T1 = AREA.ALLOC/AREA.DBK_PAGE + 1;

   1968 20 000224   000000 236000 0                  LDQ     AREA
        20 000225   000007 506000 0                  DIV     AREA+7
        20 000226   000001 036007                    ADLQ    1,DL
        20 000227   000171 756000 0                  STQ     T1

      199     1969    1       IF UWA.AC.PER_INV ~= INV_FLG THEN

   1969 20 000230   000201 236000 0                  LDQ     INV_FLG
        20 000231   000022 732000                    QRS     18
        20 000232   000240 116000 18                 CMPQ    UWA+160
        20 000233   000262 600000 20                 TZE     s:1974

      200     1970    1           IF MOD(T1,AREA.PGS_INV_PG) = 0 THEN

   1970 20 000234   000013 235000 0                  LDA     AREA+11
        20 000235   000022 731000                    ARS     18
        20 000236   200306 755100                    STA     TEMP_UBIN_WORD+1,,AUTO
        20 000237   000171 236000 0                  LDQ     T1
        20 000240   200306 506100                    DIV     TEMP_UBIN_WORD+1,,AUTO
        20 000241   000044 733000                    LRS     36
        20 000242   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:38   
        20 000243   000253 601000 20                 TNZ     s:1973

      201     1971    1               T3 = T1/AREA.PGS_INV_PG;

   1971 20 000244   000013 235000 0                  LDA     AREA+11
        20 000245   000022 731000                    ARS     18
        20 000246   200306 755100                    STA     TEMP_UBIN_WORD+1,,AUTO
        20 000247   000171 236000 0                  LDQ     T1
        20 000250   200306 506100                    DIV     TEMP_UBIN_WORD+1,,AUTO
        20 000251   000172 756000 0                  STQ     T3
        20 000252   000262 710000 20                 TRA     s:1974

      202     1972    1           ELSE
      203     1973    1               T3 = T1/AREA.PGS_INV_PG + 1;

   1973 20 000253   000013 235000 0                  LDA     AREA+11
        20 000254   000022 731000                    ARS     18
        20 000255   200306 755100                    STA     TEMP_UBIN_WORD+1,,AUTO
        20 000256   000171 236000 0                  LDQ     T1
        20 000257   200306 506100                    DIV     TEMP_UBIN_WORD+1,,AUTO
        20 000260   000001 036007                    ADLQ    1,DL
        20 000261   000172 756000 0                  STQ     T3

      204     1974    1       AREA.MAX_PAGE = T1 + T3;

   1974 20 000262   000171 236000 0                  LDQ     T1
        20 000263   000172 036000 0                  ADLQ    T3
        20 000264   000006 756000 0                  STQ     AREA+6

      205     1975    1       IF UWA.AC.PER_INV ~= INV_FLG THEN

   1975 20 000265   000201 236000 0                  LDQ     INV_FLG
        20 000266   000022 732000                    QRS     18
        20 000267   000240 116000 18                 CMPQ    UWA+160
        20 000270   000275 600000 20                 TZE     s:1978

      206     1976    1           AREA.FIRST_INV_PG = T1 + 1;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:39   

   1976 20 000271   000171 235000 0                  LDA     T1
        20 000272   000001 035007                    ADLA    1,DL
        20 000273   000005 755000 0                  STA     AREA+5
        20 000274   000276 710000 20                 TRA     s:1980

      207     1977    1       ELSE
      208     1978    1           AREA.FIRST_INV_PG = 0;

   1978 20 000275   000005 450000 0                  STZ     AREA+5

      209     1979         /* Set inventory threshold */
      210     1980    1       IF UWA.AC.PER_INV ~= INV_FLG THEN

   1980 20 000276   000240 116000 18                 CMPQ    UWA+160
        20 000277   000311 600000 20                 TZE     s:1984

      211     1981    1           AREA.INV_THRESH = UWA.AC.PAGE_SIZE - (((UWA.AC.PER_INV

   1981 20 000300   000240 236000 18                 LDQ     UWA+160
        20 000301   000262 402000 18                 MPY     UWA+178
        20 000302   000062 036007                    ADLQ    50,DL
        20 000303   000144 506007                    DIV     100,DL
        20 000304   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000305   000262 236000 18                 LDQ     UWA+178
        20 000306   200306 136100                    SBLQ    TEMP_UBIN_WORD+1,,AUTO
        20 000307   000000 620006                    EAX0    0,QL
        20 000310   000012 740000 0                  STX0    AREA+10

      212     1982    1              * UWA.AC.PAGE_SIZE) + 50) / 100); /* +50 IS FOR ROUND UP */
      213     1983         /* Calculate base dbk for local pointers */
      214     1984    1       AREA.BASE_DBK = AREA.MIN_DBK - 1;

   1984 20 000311   000002 235000 0                  LDA     AREA+2
        20 000312   000001 135007                    SBLA    1,DL
        20 000313   000001 755000 0                  STA     AREA+1

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:40   
      215     1985    1       KEYS_RESERVED = UWA.AC.KEYS_RSRVD;

   1985 20 000314   000244 236000 18                 LDQ     UWA+164
        20 000315   000267 756000 0                  STQ     KEYS_RESERVED

      216     1986    1       IF UWA.AC.PER_INV ~= INV_FLG THEN /* Calc area inv unit */

   1986 20 000316   000201 236000 0                  LDQ     INV_FLG
        20 000317   000022 732000                    QRS     18
        20 000320   000240 116000 18                 CMPQ    UWA+160
        20 000321   000331 600000 20                 TZE     s:1991

      217     1987    2       DO;

      218     1988    2           AREA.INV_UNIT = ((4096*(100-UWA.AC.PER_INV))+51199)/51200;

   1988 20 000322   000240 236000 18                 LDQ     UWA+160
        20 000323   000014 736000                    QLS     12
        20 000324   000004 676000 21                 ERQ     4
        20 000325   000010 036000 21                 ADLQ    8
        20 000326   144000 506007                    DIV     51200,DL
        20 000327   000000 620006                    EAX0    0,QL
        20 000330   000014 740000 0                  STX0    AREA+12

      219     1989    2           END;

      220     1990         /* Set ac record */
      221     1991    1       UWA.AC.BASE_DBK = AREA.BASE_DBK;

   1991 20 000331   000001 235000 0                  LDA     AREA+1
        20 000332   000242 755000 18                 STA     UWA+162

      222     1992    1       UWA.AC.MIN_DBK = AREA.MIN_DBK;

   1992 20 000333   000002 236000 0                  LDQ     AREA+2
        20 000334   000245 756000 18                 STQ     UWA+165

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:41   
      223     1993    1       UWA.AC.MAX_DBK = AREA.MAX_DBK;

   1993 20 000335   000003 235000 0                  LDA     AREA+3
        20 000336   000246 755000 18                 STA     UWA+166

      224     1994    1       UWA.AC.MIN_PAGE = AREA.MIN_PAGE;

   1994 20 000337   000004 235000 0                  LDA     AREA+4
        20 000340   000247 755000 18                 STA     UWA+167

      225     1995    1       UWA.AC.MAX_PAGE = AREA.MAX_PAGE;

   1995 20 000341   000006 235000 0                  LDA     AREA+6
        20 000342   000250 755000 18                 STA     UWA+168

      226     1996    1       UWA.AC.LINE_BITS = AREA.LINE_BITS;

   1996 20 000343   000011 235000 0                  LDA     AREA+9
        20 000344   000255 755000 18                 STA     UWA+173

      227     1997    1       UWA.AC.INV_THRESH = AREA.INV_THRESH;

   1997 20 000345   000012 235000 0                  LDA     AREA+10
        20 000346   000022 731000                    ARS     18
        20 000347   000256 755000 18                 STA     UWA+174

      228     1998    1       UWA.AC.PGS_INV_PG = AREA.PGS_INV_PG;

   1998 20 000350   000013 235000 0                  LDA     AREA+11
        20 000351   000022 731000                    ARS     18
        20 000352   000260 755000 18                 STA     UWA+176

      229     1999    1       UWA.AC.KEYS_ALLOC = AREA.ALLOC;

   1999 20 000353   000000 235000 0                  LDA     AREA
        20 000354   000243 755000 18                 STA     UWA+163

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:42   
      230     2000    1       UWA.AC.FRST_INV_PG = AREA.FIRST_INV_PG;

   2000 20 000355   000005 235000 0                  LDA     AREA+5
        20 000356   000252 755000 18                 STA     UWA+170

      231     2001    1       UWA.AC.INV_UNIT = AREA.INV_UNIT;

   2001 20 000357   000014 235000 0                  LDA     AREA+12
        20 000360   000022 731000                    ARS     18
        20 000361   000261 755000 18                 STA     UWA+177

      232     2002    1       IF UWA.AC.PER_INV = INV_FLG THEN

   2002 20 000362   000201 236000 0                  LDQ     INV_FLG
        20 000363   000022 732000                    QRS     18
        20 000364   000240 116000 18                 CMPQ    UWA+160
        20 000365   000367 601000 20                 TNZ     s:2004

      233     2003    1           UWA.AC.PER_INV = 0;

   2003 20 000366   000240 450000 18                 STZ     UWA+160

      234     2004    1       CALL FCURR_R_6('AC  ') ALTRET(ERROR1);

   2004 20 000367   000005 630400 21                 EPPR0   5
        20 000370   000001 631400 21                 EPPR1   1
        20 000371   000000 701000 xent               TSX1    FCURR_R_6
        20 000372   002231 702000 20                 TSX2    ERROR1

      235     2005    1       CALL MODIFY_6('AC  ') ALTRET(ERROR1);

   2005 20 000373   000005 630400 21                 EPPR0   5
        20 000374   000001 631400 21                 EPPR1   1
        20 000375   000000 701000 xent               TSX1    MODIFY_6
        20 000376   002231 702000 20                 TSX2    ERROR1

      236     2006         /* Factor in extra page if index area */
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:43   
      237     2007    1       GOTO DOAC; /* Get next ac record */

   2007 20 000377   000015 710000 20                 TRA     DOAC

      238     2008    1   DORA:
      239     2009         /* AREA.MAX_DBK is the total # dbk in all areas
      240     2010            determine global size */
      241     2011    1       TOTAL = KEYS_RESERVED + AREA.MAX_DBK;

   2011 20 000400   000267 236000 0     DORA         LDQ     KEYS_RESERVED
        20 000401   000003 036000 0                  ADLQ    AREA+3
        20 000402   200303 756100                    STQ     TOTAL,,AUTO

      242     2012    1       GLOBAL_SIZE = 2;

   2012 20 000403   000002 235007                    LDA     2,DL
        20 000404   000174 755000 0                  STA     GLOBAL_SIZE

      243     2013    1       IF TOTAL > 262143 THEN

   2013 20 000405   000001 116003                    CMPQ    1,DU
        20 000406   000411 602000 20                 TNC     s:2015

      244     2014    1           GLOBAL_SIZE = 3;

   2014 20 000407   000003 235007                    LDA     3,DL
        20 000410   000174 755000 0                  STA     GLOBAL_SIZE

      245     2015    1       IF TOTAL > 134217727 THEN

   2015 20 000411   001000 116003                    CMPQ    512,DU
        20 000412   000415 602000 20                 TNC     s:2017

      246     2016    1           GLOBAL_SIZE = 4;

   2016 20 000413   000004 235007                    LDA     4,DL
        20 000414   000174 755000 0                  STA     GLOBAL_SIZE
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:44   

      247     2017    1       UWA.OA.GLOBAL = GLOBAL_SIZE - 1;

   2017 20 000415   000001 135007                    SBLA    1,DL
        20 000416   000226 755000 18                 STA     UWA+150

      248     2018    1       CALL FCURR_R_6('OA  ') ALTRET(ERROR1);

   2018 20 000417   000011 630400 21                 EPPR0   9
        20 000420   000001 631400 21                 EPPR1   1
        20 000421   000000 701000 xent               TSX1    FCURR_R_6
        20 000422   002231 702000 20                 TSX2    ERROR1

      249     2019    1       CALL MODIFY_6('OA  ') ALTRET(ERROR1);

   2019 20 000423   000011 630400 21                 EPPR0   9
        20 000424   000001 631400 21                 EPPR1   1
        20 000425   000000 701000 xent               TSX1    MODIFY_6
        20 000426   002231 702000 20                 TSX2    ERROR1

      250     2020         /* Go through all rc records and associate ra records
      251     2021            and set appropriate fields */
      252     2022    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1); /* Start at beginning */

   2022 20 000427   000012 630400 21                 EPPR0   10
        20 000430   000001 631400 21                 EPPR1   1
        20 000431   000000 701000 xent               TSX1    FETCHOS_6
        20 000432   002231 702000 20                 TSX2    ERROR1

      253     2023    1   NXTRC:
      254     2024    1       CALL FETCHNS_6('OA-RC   ') ALTRET(CKAC); /* Get next rc */

   2024 20 000433   000012 630400 21    NXTRC        EPPR0   10
        20 000434   000001 631400 21                 EPPR1   1
        20 000435   000000 701000 xent               TSX1    FETCHNS_6
        20 000436   001077 702000 20                 TSX2    CKAC

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:45   
      255     2025    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get associated sn */

   2025 20 000437   000003 630400 21                 EPPR0   3
        20 000440   000001 631400 21                 EPPR1   1
        20 000441   000000 701000 xent               TSX1    FETCHOS_6
        20 000442   002231 702000 20                 TSX2    ERROR1

      256     2026    1       IF UWA.SN.SENAME = '*DBPARAM' THEN

   2026 20 000443   040000 106400                    CMPC    fill='040'O
        20 000444   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 000445   000010 000010 19                 ADSC9   8                        cn=0,n=8
        20 000446   000433 600000 20                 TZE     NXTRC

      257     2027    1           GOTO NXTRC;
      258     2028    1       IF UWA.SN.SENAME = '*CALC.RC' THEN

   2028 20 000447   040000 106400                    CMPC    fill='040'O
        20 000450   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 000451   000012 000010 19                 ADSC9   10                       cn=0,n=8
        20 000452   000433 600000 20                 TZE     NXTRC

      259     2029    1           GOTO NXTRC;
      260     2030    1       IF UWA.SN.SENAME = '*SYSTEM' THEN

   2030 20 000453   040000 106400                    CMPC    fill='040'O
        20 000454   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 000455   000014 000007 19                 ADSC9   12                       cn=0,n=7
        20 000456   000433 600000 20                 TZE     NXTRC

      261     2031    1           GOTO NXTRC;
      262     2032    2       IF SUBSTR(UWA.SN.SENAME,0,8) = '*PA_REC_' THEN DO;

   2032 20 000457   040000 106400                    CMPC    fill='040'O
        20 000460   000427 000010 18                 ADSC9   UWA+279                  cn=0,n=8
        20 000461   000016 000010 19                 ADSC9   14                       cn=0,n=8
        20 000462   000561 601000 20                 TNZ     s:2052
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:46   

      263     2033    2           CALL FCURR_R_6('RC  ') ALTRET(ERROR1);

   2033 20 000463   000013 630400 21                 EPPR0   11
        20 000464   000001 631400 21                 EPPR1   1
        20 000465   000000 701000 xent               TSX1    FCURR_R_6
        20 000466   002231 702000 20                 TSX2    ERROR1

      264     2034    2           PA_PLACE = UWA.DIRECT_REF;

   2034 20 000467   000036 235000 18                 LDA     UWA+30
        20 000470   200003 755100                    STA     PA_PLACE,,AUTO

      265     2035    2           CALL FETCHNS_6('RC-SOSM ') ALTRET(ERROR1);

   2035 20 000471   000014 630400 21                 EPPR0   12
        20 000472   000001 631400 21                 EPPR1   1
        20 000473   000000 701000 xent               TSX1    FETCHNS_6
        20 000474   002231 702000 20                 TSX2    ERROR1

      266     2036    2           CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);

   2036 20 000475   000015 630400 21                 EPPR0   13
        20 000476   000001 631400 21                 EPPR1   1
        20 000477   000000 701000 xent               TSX1    FETCHOS_6
        20 000500   002231 702000 20                 TSX2    ERROR1

      267     2037    2           CALL FETCHNS_6('SC-SOSM ') ALTRET(ERROR1);

   2037 20 000501   000015 630400 21                 EPPR0   13
        20 000502   000001 631400 21                 EPPR1   1
        20 000503   000000 701000 xent               TSX1    FETCHNS_6
        20 000504   002231 702000 20                 TSX2    ERROR1

      268     2038    2           CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   2038 20 000505   000014 630400 21                 EPPR0   12
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:47   
        20 000506   000001 631400 21                 EPPR1   1
        20 000507   000000 701000 xent               TSX1    FETCHOS_6
        20 000510   002231 702000 20                 TSX2    ERROR1

      269     2039    2   NXT_PA_RC_RA:
      270     2040    2           CALL FETCHNS_6('RC-RA   ') ALTRET(DONE_PA_RC_RA);

   2040 20 000511   000016 630400 21    NXT_PA_RC_RA EPPR0   14
        20 000512   000001 631400 21                 EPPR1   1
        20 000513   000000 701000 xent               TSX1    FETCHNS_6
        20 000514   000550 702000 20                 TSX2    DONE_PA_RC_RA

      271     2041    2           USER_PLACE = UWA.DIRECT_REF;

   2041 20 000515   000036 235000 18                 LDA     UWA+30
        20 000516   200004 755100                    STA     USER_PLACE,,AUTO

      272     2042    2           CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);

   2042 20 000517   000017 630400 21                 EPPR0   15
        20 000520   000001 631400 21                 EPPR1   1
        20 000521   000000 701000 xent               TSX1    FETCHOS_6
        20 000522   002231 702000 20                 TSX2    ERROR1

      273     2043    2           CALL FINDD_6('RC  ',PA_PLACE) ALTRET(ERROR1);

   2043 20 000523   200003 630500                    EPPR0   PA_PLACE,,AUTO
        20 000524   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 000525   000013 236000 21                 LDQ     11
        20 000526   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000527   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
        20 000530   000020 631400 21                 EPPR1   16
        20 000531   000000 701000 xent               TSX1    FINDD_6
        20 000532   002231 702000 20                 TSX2    ERROR1

      274     2044    2           CALL STRE_6('RA  ') ALTRET(ERROR1);

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:48   
   2044 20 000533   000021 630400 21                 EPPR0   17
        20 000534   000001 631400 21                 EPPR1   1
        20 000535   000000 701000 xent               TSX1    STRE_6
        20 000536   002231 702000 20                 TSX2    ERROR1

      275     2045    2           CALL FINDD_6('RA  ',USER_PLACE) ALTRET(ERROR1);

   2045 20 000537   200004 630500                    EPPR0   USER_PLACE,,AUTO
        20 000540   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 000541   000021 236000 21                 LDQ     17
        20 000542   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000543   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
        20 000544   000020 631400 21                 EPPR1   16
        20 000545   000000 701000 xent               TSX1    FINDD_6
        20 000546   002231 702000 20                 TSX2    ERROR1

      276     2046    2           GOTO NXT_PA_RC_RA;

   2046 20 000547   000511 710000 20                 TRA     NXT_PA_RC_RA

      277     2047    2   DONE_PA_RC_RA:
      278     2048    2           CALL FETCHD_6('RC  ',PA_PLACE) ALTRET(ERROR1);

   2048 20 000550   200003 630500       DONE_PA_RC_* EPPR0   PA_PLACE,,AUTO
        20 000551   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 000552   000013 236000 21                 LDQ     11
        20 000553   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000554   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
        20 000555   000020 631400 21                 EPPR1   16
        20 000556   000000 701000 xent               TSX1    FETCHD_6
        20 000557   002231 702000 20                 TSX2    ERROR1

      279     2049    2           GOTO NXTRC;

   2049 20 000560   000433 710000 20                 TRA     NXTRC

      280     2050    2           END;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:49   
      281     2051         /* Go through ra's for this rc */
      282     2052    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1);

   2052 20 000561   000016 630400 21                 EPPR0   14
        20 000562   000001 631400 21                 EPPR1   1
        20 000563   000000 701000 xent               TSX1    FETCHOS_6
        20 000564   002231 702000 20                 TSX2    ERROR1

      283     2053    1   NXTRA:
      284     2054    1       CALL FETCHNS_6('RC-RA   ') ALTRET(NXTRC); /* Get next ra */

   2054 20 000565   000016 630400 21    NXTRA        EPPR0   14
        20 000566   000001 631400 21                 EPPR1   1
        20 000567   000000 701000 xent               TSX1    FETCHNS_6
        20 000570   000433 702000 20                 TSX2    NXTRC

      285     2055    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);

   2055 20 000571   000003 630400 21                 EPPR0   3
        20 000572   000001 631400 21                 EPPR1   1
        20 000573   000000 701000 xent               TSX1    FETCHOS_6
        20 000574   002231 702000 20                 TSX2    ERROR1

      286     2056    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1); /* Get ac for this ra*/

   2056 20 000575   000017 630400 21                 EPPR0   15
        20 000576   000001 631400 21                 EPPR1   1
        20 000577   000000 701000 xent               TSX1    FETCHOS_6
        20 000600   002231 702000 20                 TSX2    ERROR1

      287     2057    1       LOW_DBK = UWA.RA.LOWDBK;

   2057 20 000601   000326 235000 18                 LDA     UWA+214
        20 000602   000164 755000 0                  STA     LOW_DBK

      288     2058    1       HIGH_DBK = UWA.RA.HIGHDBK;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:50   
   2058 20 000603   000327 236000 18                 LDQ     UWA+215
        20 000604   000163 756000 0                  STQ     HIGH_DBK

      289     2059    1       IF HIGH_DBK = 0 & LOW_DBK = 0 THEN

   2059 20 000605   400000 220003                    LDX0    -131072,DU
        20 000606   000000 116003                    CMPQ    0,DU
        20 000607   000611 600000 20                 TZE     s:2059+4
        20 000610   000000 220003                    LDX0    0,DU
        20 000611   400000 221003                    LDX1    -131072,DU
        20 000612   000000 115003                    CMPA    0,DU
        20 000613   000615 600000 20                 TZE     s:2059+8
        20 000614   000000 221003                    LDX1    0,DU
        20 000615   000000 636011                    EAQ     0,X1
        20 000616   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 000617   000000 636010                    EAQ     0,X0
        20 000620   200306 376100                    ANQ     TEMP_UBIN_WORD+1,,AUTO
        20 000621   000635 600000 20                 TZE     s:2068

      290     2060    2       DO; /* No range values specified for rc */

      291     2061    2           LOW_DBK = 1;

   2061 20 000622   000001 236007                    LDQ     1,DL
        20 000623   000164 756000 0                  STQ     LOW_DBK

      292     2062    2           ADJ_LOW_DBK = UWA.AC.MIN_DBK;

   2062 20 000624   000245 235000 18                 LDA     UWA+165
        20 000625   000165 755000 0                  STA     ADJ_LOW_DBK

      293     2063    2           HIGH_DBK = LOW_DBK + (UWA.AC.MAX_DBK - UWA.AC.MIN_DBK);

   2063 20 000626   000246 236000 18                 LDQ     UWA+166
        20 000627   000245 136000 18                 SBLQ    UWA+165
        20 000630   000164 036000 0                  ADLQ    LOW_DBK
        20 000631   000163 756000 0                  STQ     HIGH_DBK
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:51   

      294     2064    2           ADJ_HIGH_DBK = UWA.AC.MAX_DBK;

   2064 20 000632   000246 235000 18                 LDA     UWA+166
        20 000633   000166 755000 0                  STA     ADJ_HIGH_DBK

      295     2065    2           END;

   2065 20 000634   000646 710000 20                 TRA     s:2072

      296     2066    1       ELSE
      297     2067    2       DO; /* Range values specified for rc */

      298     2068    2           AREA.MIN_DBK = UWA.AC.MIN_DBK;

   2068 20 000635   000245 236000 18                 LDQ     UWA+165
        20 000636   000002 756000 0                  STQ     AREA+2

      299     2069    2           ADJ_LOW_DBK = AREA.MIN_DBK + LOW_DBK - 1;

   2069 20 000637   000164 036000 0                  ADLQ    LOW_DBK
        20 000640   000001 136007                    SBLQ    1,DL
        20 000641   000165 756000 0                  STQ     ADJ_LOW_DBK

      300     2070    2           ADJ_HIGH_DBK = AREA.MIN_DBK + HIGH_DBK - 1;

   2070 20 000642   000002 236000 0                  LDQ     AREA+2
        20 000643   000163 036000 0                  ADLQ    HIGH_DBK
        20 000644   000001 136007                    SBLQ    1,DL
        20 000645   000166 756000 0                  STQ     ADJ_HIGH_DBK

      301     2071    2           END;

      302     2072    1       IF UWA.AC.CALC_NULL = 1 THEN

   2072 20 000646   000241 235000 18                 LDA     UWA+161
        20 000647   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:52   
        20 000650   001050 600000 20                 TZE     NEXTRA1

      303     2073    1           GOTO NEXTRA1; /* No calc records for area */
      304     2074    1       AREA.DBK_CALC = UWA.AC.DBK_CALC;

   2074 20 000651   000254 236000 18                 LDQ     UWA+172
        20 000652   000010 756000 0                  STQ     AREA+8

      305     2075    1       CALC_OFFS = LOW_DBK - 1; /* Low range value */

   2075 20 000653   000164 235000 0                  LDA     LOW_DBK
        20 000654   000001 135007                    SBLA    1,DL
        20 000655   000167 755000 0                  STA     CALC_OFFS

      306     2076    1       IF CALC_OFFS ~= 0 THEN

   2076 20 000656   000700 600000 20                 TZE     s:2085

      307     2077    2       DO;

      308     2078    2           X = 0;

   2078 20 000657   000000 220003                    LDX0    0,DU
        20 000660   200017 740100                    STX0    X,,AUTO

      309     2079    3           DO WHILE(MOD(CALC_OFFS,AREA.DBK_CALC) ~= 0);

   2079 20 000661   000667 710000 20                 TRA     s:2082

      310     2080    3               X = X + 1;

   2080 20 000662   200017 220100                    LDX0    X,,AUTO
        20 000663   000001 621010                    EAX1    1,X0
        20 000664   200017 741100                    STX1    X,,AUTO

      311     2081    3               CALC_OFFS = CALC_OFFS - 1;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:53   
   2081 20 000665   000001 336007                    LCQ     1,DL
        20 000666   000167 056000 0                  ASQ     CALC_OFFS

      312     2082    3               END;

   2082 20 000667   000167 236000 0                  LDQ     CALC_OFFS
        20 000670   000010 506000 0                  DIV     AREA+8
        20 000671   000044 733000                    LRS     36
        20 000672   000000 116003                    CMPQ    0,DU
        20 000673   000662 601000 20                 TNZ     s:2080

      313     2083    2           CALC_OFFS = -1 * X;

   2083 20 000674   200017 235100                    LDA     X,,AUTO
        20 000675   000022 731000                    ARS     18
        20 000676   000000 531000                    NEG     0
        20 000677   000167 755000 0                  STA     CALC_OFFS

      314     2084    2           END;

      315     2085    1       IF CALC_OFFS < 0 THEN

   2085 20 000700   000707 605000 20                 TPL     s:2088

      316     2086    1           RNG = HIGH_DBK - LOW_DBK + 1 - CALC_OFFS;

   2086 20 000701   000163 236000 0                  LDQ     HIGH_DBK
        20 000702   000164 136000 0                  SBLQ    LOW_DBK
        20 000703   000167 136000 0                  SBLQ    CALC_OFFS
        20 000704   000001 036007                    ADLQ    1,DL
        20 000705   000177 756000 0                  STQ     RNG
        20 000706   000714 710000 20                 TRA     s:2089

      317     2087    1       ELSE
      318     2088    1           RNG = HIGH_DBK - LOW_DBK + 1 + CALC_OFFS;

   2088 20 000707   000163 236000 0                  LDQ     HIGH_DBK
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:54   
        20 000710   000164 136000 0                  SBLQ    LOW_DBK
        20 000711   000167 036000 0                  ADLQ    CALC_OFFS
        20 000712   000001 036007                    ADLQ    1,DL
        20 000713   000177 756000 0                  STQ     RNG

      319     2089    1       NUMB_CALC = RNG/AREA.DBK_CALC;

   2089 20 000714   000010 506000 0                  DIV     AREA+8
        20 000715   000170 756000 0                  STQ     NUMB_CALC

      320     2090    1       PART_RNG = MOD(RNG,AREA.DBK_CALC);

   2090 20 000716   000177 236000 0                  LDQ     RNG
        20 000717   000010 506000 0                  DIV     AREA+8
        20 000720   000200 755000 0                  STA     PART_RNG

      321     2091    1       IF PART_RNG > AREA.DBK_CALC/2 THEN

   2091 20 000721   000010 236000 0                  LDQ     AREA+8
        20 000722   000002 506007                    DIV     2,DL
        20 000723   000200 116000 0                  CMPQ    PART_RNG
        20 000724   000726 605000 20                 TPL     s:2093

      322     2092    1           NUMB_CALC = NUMB_CALC + 1;

   2092 20 000725   000170 054000 0                  AOS     NUMB_CALC

      323     2093    1       IF NUMB_CALC = 0 THEN

   2093 20 000726   000170 235000 0                  LDA     NUMB_CALC
        20 000727   000732 601000 20                 TNZ     s:2095

      324     2094    1           NUMB_CALC = 1;

   2094 20 000730   000001 236007                    LDQ     1,DL
        20 000731   000170 756000 0                  STQ     NUMB_CALC

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:55   
      325     2095    1       IF NUMB_CALC <= 3 THEN

   2095 20 000732   000170 235000 0                  LDA     NUMB_CALC
        20 000733   000003 115007                    CMPA    3,DL
        20 000734   001050 604400 20                 TMOZ    NEXTRA1

      326     2096    1           GOTO NEXTRA1;
      327     2097
      328     2098         /* We need to adjust NUMB_CALC to be the maximum prime less than
      329     2099            NUMB_CALC's current value. */
      330     2100
      331     2101         /* See if we have saved this one already */
      332     2102    1       PRIME_INDEX = 0;

   2102 20 000735   200072 450100                    STZ     PRIME_INDEX,,AUTO

      333     2103    1   FIND_SAVED_PRIME:
      334     2104    2       DO UNTIL PRIME_INDEX > %MAX_PRIME_SAVE;

   2104 20 000736                       FIND_SAVED_* null
      335     2105    2           IF NUMB_CALC <= PRIME_SAVER.N_CALC(PRIME_INDEX)

   2105 20 000736   200072 235100                    LDA     PRIME_INDEX,,AUTO
        20 000737   000001 735000                    ALS     1
        20 000740   000170 236000 0                  LDQ     NUMB_CALC
        20 000741   200022 116105                    CMPQ    PRIME_SAVER,AL,AUTO
        20 000742   000752 605400 20                 TPNZ    s:2117

      336     2106    3           THEN DO;

      337     2107    3               IF NUMB_CALC >= PRIME_SAVER.PRIM(PRIME_INDEX)

   2107 20 000743   200023 116105                    CMPQ    PRIME_SAVER+1,AL,AUTO
        20 000744   000750 604000 20                 TMI     s:2113

      338     2108    4               THEN DO;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:56   
      339     2109    4                   NUMB_CALC = PRIME_SAVER.PRIM(PRIME_INDEX);

   2109 20 000745   200023 235105                    LDA     PRIME_SAVER+1,AL,AUTO
        20 000746   000170 755000 0                  STA     NUMB_CALC

      340     2110    4                   GOTO NEXTRA1;

   2110 20 000747   001050 710000 20                 TRA     NEXTRA1

      341     2111    4                   END;
      342     2112    4               ELSE DO;

      343     2113    4                   PRIME_INDEX = PRIME_INDEX + 1;

   2113 20 000750   200072 054100                    AOS     PRIME_INDEX,,AUTO

      344     2114    4                   END;

      345     2115    3               END;

   2115 20 000751   000753 710000 20                 TRA     s:2119

      346     2116    3           ELSE DO;

      347     2117    3               EXIT FIND_SAVED_PRIME;

   2117 20 000752   000756 710000 20                 TRA     s:2122

      348     2118    3               END;
      349     2119    2           END;

   2119 20 000753   200072 235100                    LDA     PRIME_INDEX,,AUTO
        20 000754   000023 115007                    CMPA    19,DL
        20 000755   000736 604400 20                 TMOZ    FIND_SAVED_PRIME

      350     2120
      351     2121         /* Make room to save it if it fits. */
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:57   
      352     2122    1       IF PRIME_INDEX <= %MAX_PRIME_SAVE

   2122 20 000756   200072 235100                    LDA     PRIME_INDEX,,AUTO
        20 000757   000023 115007                    CMPA    19,DL
        20 000760   001003 605400 20                 TPNZ    s:2131

      353     2123    2       THEN DO;

      354     2124    3           DO D = %MAX_PRIME_SAVE DOWNTO PRIME_INDEX + 1;

   2124 20 000761   000023 235007                    LDA     19,DL
        20 000762   200020 755100                    STA     D,,AUTO
        20 000763   000773 710000 20                 TRA     s:2126+2

      355     2125    3               PRIME_SAVER(D) = PRIME_SAVER(D-1);

   2125 20 000764   200020 235100                    LDA     D,,AUTO
        20 000765   000001 735000                    ALS     1
        20 000766   000000 620005                    EAX0    0,AL
        20 000767   200020 237105                    LDAQ    D,AL,AUTO
        20 000770   200022 757110                    STAQ    PRIME_SAVER,X0,AUTO

      356     2126    3               END;

   2126 20 000771   000001 336007                    LCQ     1,DL
        20 000772   200020 056100                    ASQ     D,,AUTO
        20 000773   200020 236100                    LDQ     D,,AUTO
        20 000774   200072 116100                    CMPQ    PRIME_INDEX,,AUTO
        20 000775   000764 605400 20                 TPNZ    s:2125

      357     2127    2           PRIME_SAVER.N_CALC(PRIME_INDEX) = NUMB_CALC;

   2127 20 000776   200072 235100                    LDA     PRIME_INDEX,,AUTO
        20 000777   000001 735000                    ALS     1
        20 001000   000170 236000 0                  LDQ     NUMB_CALC
        20 001001   200022 756105                    STQ     PRIME_SAVER,AL,AUTO

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:58   
      358     2128    2           PRIME_SAVER.PRIM(PRIME_INDEX) = 0;

   2128 20 001002   200023 450105                    STZ     PRIME_SAVER+1,AL,AUTO

      359     2129    2           END;

      360     2130
      361     2131    1       IF MOD(NUMB_CALC,2) = 0 THEN /* Is it even */

   2131 20 001003   000002 506007                    DIV     2,DL
        20 001004   000044 733000                    LRS     36
        20 001005   000000 116003                    CMPQ    0,DU
        20 001006   001011 601000 20                 TNZ     s:2135

      362     2132    1           NUMB_CALC = NUMB_CALC - 1;

   2132 20 001007   000001 336007                    LCQ     1,DL
        20 001010   000170 056000 0                  ASQ     NUMB_CALC

      363     2133
      364     2134         /* Approximate square root to nearest power of 2 greater then NUMB_CALC */
      365     2135    1       ROOT = 2;

   2135 20 001011   000002 235007                    LDA     2,DL
        20 001012   200021 755100                    STA     ROOT,,AUTO

      366     2136    2       DO WHILE ROOT * ROOT < NUMB_CALC;

   2136 20 001013   001016 710000 20                 TRA     s:2138

      367     2137    2           ROOT = ROOT * 2;

   2137 20 001014   200021 236100                    LDQ     ROOT,,AUTO
        20 001015   200021 056100                    ASQ     ROOT,,AUTO

      368     2138    2           END;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:59   
   2138 20 001016   200021 236100                    LDQ     ROOT,,AUTO
        20 001017   200021 402100                    MPY     ROOT,,AUTO
        20 001020   000170 116000 0                  CMPQ    NUMB_CALC
        20 001021   001014 604000 20                 TMI     s:2137

   2137 20 001022                       PRIME        null
      369     2139
      370     2140         /* Reduce number of calc headers to a prime */
      371     2141    1   PRIME: ;
      372     2142    2       DO D = 3 TO ROOT BY 2 ;

   2142 20 001022   000003 235007                    LDA     3,DL
        20 001023   200020 755100                    STA     D,,AUTO
        20 001024   001037 710000 20                 TRA     s:2148+2

      373     2143    2           IF MOD( NUMB_CALC, D ) = 0 THEN

   2143 20 001025   000170 236000 0                  LDQ     NUMB_CALC
        20 001026   200020 506100                    DIV     D,,AUTO
        20 001027   000044 733000                    LRS     36
        20 001030   000000 116003                    CMPQ    0,DU
        20 001031   001035 601000 20                 TNZ     s:2148

      374     2144    3           DO;

      375     2145    3               NUMB_CALC = NUMB_CALC - 2;

   2145 20 001032   000002 336007                    LCQ     2,DL
        20 001033   000170 056000 0                  ASQ     NUMB_CALC

      376     2146    3               GOTO PRIME;

   2146 20 001034   001022 710000 20                 TRA     PRIME

      377     2147    3               END;
      378     2148    2           END;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:60   
   2148 20 001035   000002 236007                    LDQ     2,DL
        20 001036   200020 056100                    ASQ     D,,AUTO
        20 001037   200020 236100                    LDQ     D,,AUTO
        20 001040   200021 116100                    CMPQ    ROOT,,AUTO
        20 001041   001025 604400 20                 TMOZ    s:2143

      379     2149
      380     2150         /* Save it now that we have calculated it */
      381     2151    1       IF PRIME_INDEX < %MAX_PRIME_SAVE

   2151 20 001042   200072 235100                    LDA     PRIME_INDEX,,AUTO
        20 001043   000023 115007                    CMPA    19,DL
        20 001044   001050 605000 20                 TPL     NEXTRA1

      382     2152    2       THEN DO;

      383     2153    2           PRIME_SAVER.PRIM(PRIME_INDEX) = NUMB_CALC;

   2153 20 001045   000001 735000                    ALS     1
        20 001046   000170 236000 0                  LDQ     NUMB_CALC
        20 001047   200023 756105                    STQ     PRIME_SAVER+1,AL,AUTO

      384     2154    2           END;

      385     2155
      386     2156         /* Set ra record */
      387     2157    1   NEXTRA1:
      388     2158    1       UWA.RA.LOWDBK = ADJ_LOW_DBK;

   2158 20 001050   000165 235000 0     NEXTRA1      LDA     ADJ_LOW_DBK
        20 001051   000326 755000 18                 STA     UWA+214

      389     2159    1       UWA.RA.HIGHDBK = ADJ_HIGH_DBK;

   2159 20 001052   000166 236000 0                  LDQ     ADJ_HIGH_DBK
        20 001053   000327 756000 18                 STQ     UWA+215

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:61   
      390     2160         /* Check if user specified null option in calc
      391     2161            interval clause */
      392     2162    1       IF UWA.AC.CALC_NULL = 1 THEN

   2162 20 001054   000241 235000 18                 LDA     UWA+161
        20 001055   000001 115007                    CMPA    1,DL
        20 001056   001062 601000 20                 TNZ     s:2169

      393     2163    2       DO;

      394     2164    2           UWA.RA.CALC_HDRS = 0;

   2164 20 001057   000330 450000 18                 STZ     UWA+216

      395     2165    2           UWA.RA.HDR_OFFS = 0;

   2165 20 001060   000331 450000 18                 STZ     UWA+217

      396     2166    2           END;

   2166 20 001061   001066 710000 20                 TRA     s:2172

      397     2167    1       ELSE
      398     2168    2       DO;

      399     2169    2           UWA.RA.CALC_HDRS = NUMB_CALC;

   2169 20 001062   000170 235000 0                  LDA     NUMB_CALC
        20 001063   000330 755000 18                 STA     UWA+216

      400     2170    2           UWA.RA.HDR_OFFS = CALC_OFFS;

   2170 20 001064   000167 235000 0                  LDA     CALC_OFFS
        20 001065   000331 755000 18                 STA     UWA+217

      401     2171    2           END;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:62   
      402     2172    1       CALL FCURR_R_6('RA  ') ALTRET(ERROR1);

   2172 20 001066   000021 630400 21                 EPPR0   17
        20 001067   000001 631400 21                 EPPR1   1
        20 001070   000000 701000 xent               TSX1    FCURR_R_6
        20 001071   002231 702000 20                 TSX2    ERROR1

      403     2173    1       CALL MODIFYIA_6('RA  ') ALTRET(ERROR1);

   2173 20 001072   000021 630400 21                 EPPR0   17
        20 001073   000001 631400 21                 EPPR1   1
        20 001074   000000 701000 xent               TSX1    MODIFYIA_6
        20 001075   002231 702000 20                 TSX2    ERROR1

      404     2174    1       GOTO NXTRA;

   2174 20 001076   000565 710000 20                 TRA     NXTRA

      405     2175    1   CKAC:
      406     2176    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1);

   2176 20 001077   000002 630400 21    CKAC         EPPR0   2
        20 001100   000001 631400 21                 EPPR1   1
        20 001101   000000 701000 xent               TSX1    FETCHOS_6
        20 001102   002231 702000 20                 TSX2    ERROR1

      407     2177    1   CKRNG:
      408     2178    1       CALL FETCHNS_6('OA-AC   ') ALTRET(SET_POINT); /* Get next ac */

   2178 20 001103   000002 630400 21    CKRNG        EPPR0   2
        20 001104   000001 631400 21                 EPPR1   1
        20 001105   000000 701000 xent               TSX1    FETCHNS_6
        20 001106   001273 702000 20                 TSX2    SET_POINT

      409     2179    1       IF UWA.AC.PAGE_TYP = 0 /* Inttegrated */ THEN

   2179 20 001107   000237 235000 18                 LDA     UWA+159
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:63   
        20 001110   001114 601000 20                 TNZ     s:2181

      410     2180    1           UWA.AC.SPACE_AVAIL = UWA.AC.PAGE_SIZE - 12;

   2180 20 001111   000262 236000 18                 LDQ     UWA+178
        20 001112   000014 136007                    SBLQ    12,DL
        20 001113   000263 756000 18                 STQ     UWA+179

      411     2181    1       IF UWA.AC.CALC_NULL = 0 THEN

   2181 20 001114   000241 236000 18                 LDQ     UWA+161
        20 001115   001175 601000 20                 TNZ     s:2199

      412     2182    1           IF UWA.AC.DBK_CALC <= UWA.AC.DBK_PAGE THEN

   2182 20 001116   000254 236000 18                 LDQ     UWA+172
        20 001117   000253 116000 18                 CMPQ    UWA+171
        20 001120   001172 605400 20                 TPNZ    s:2198

      413     2183    2           DO;

      414     2184         /* Calc number of calc hdrs per page */
      415     2185    2               CHPP = UWA.AC.DBK_PAGE/UWA.AC.DBK_CALC;

   2185 20 001121   000253 236000 18                 LDQ     UWA+171
        20 001122   000254 506000 18                 DIV     UWA+172
        20 001123   000000 620006                    EAX0    0,QL
        20 001124   200005 740100                    STX0    CHPP,,AUTO

      416     2186         /* Calc lrgst calc hdr offset */
      417     2187    2               HLN = ((CHPP-1)*UWA.AC.DBK_CALC)+1;

   2187 20 001125   200005 236100                    LDQ     CHPP,,AUTO
        20 001126   000022 732000                    QRS     18
        20 001127   000001 136007                    SBLQ    1,DL
        20 001130   000254 402000 18                 MPY     UWA+172
        20 001131   000001 621006                    EAX1    1,QL
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:64   
        20 001132   200006 741100                    STX1    HLN,,AUTO

      418     2188         /* Adjust avail space for offset array space */
      419     2189    2               OA_SPACE = HLN*2;

   2189 20 001133   200006 222100                    LDX2    HLN,,AUTO
        20 001134   200006 022100                    ADLX2   HLN,,AUTO
        20 001135   200007 742100                    STX2    OA_SPACE,,AUTO

      420     2190    3               DO WHILE(MOD(OA_SPACE,4) ~= 0);

   2190 20 001136   001142 710000 20                 TRA     s:2192

      421     2191    3                   OA_SPACE = OA_SPACE + 1;

   2191 20 001137   200007 220100                    LDX0    OA_SPACE,,AUTO
        20 001140   000001 621010                    EAX1    1,X0
        20 001141   200007 741100                    STX1    OA_SPACE,,AUTO

      422     2192    3                   END;

   2192 20 001142   200007 236100                    LDQ     OA_SPACE,,AUTO
        20 001143   000022 732000                    QRS     18
        20 001144   000004 506007                    DIV     4,DL
        20 001145   000044 733000                    LRS     36
        20 001146   000000 116003                    CMPQ    0,DU
        20 001147   001137 601000 20                 TNZ     s:2191

      423     2193    2               UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL - OA_SPACE;

   2193 20 001150   200007 235100                    LDA     OA_SPACE,,AUTO
        20 001151   000022 731000                    ARS     18
        20 001152   200306 755100                    STA     TEMP_UBIN_WORD+1,,AUTO
        20 001153   000263 236000 18                 LDQ     UWA+179
        20 001154   200306 136100                    SBLQ    TEMP_UBIN_WORD+1,,AUTO
        20 001155   000263 756000 18                 STQ     UWA+179

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:65   
      424     2194         /* Adjust avail space for calc hdr space */
      425     2195    2               UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL -

   2195 20 001156   000174 235000 0                  LDA     GLOBAL_SIZE
        20 001157   000001 735000                    ALS     1
        20 001160   000004 035007                    ADLA    4,DL
        20 001161   200306 755100                    STA     TEMP_UBIN_WORD+1,,AUTO
        20 001162   200005 236100                    LDQ     CHPP,,AUTO
        20 001163   000022 732000                    QRS     18
        20 001164   200306 402100                    MPY     TEMP_UBIN_WORD+1,,AUTO
        20 001165   200307 756100                    STQ     TEMP_UBIN_WORD+2,,AUTO
        20 001166   000263 236000 18                 LDQ     UWA+179
        20 001167   200307 136100                    SBLQ    TEMP_UBIN_WORD+2,,AUTO
        20 001170   000263 756000 18                 STQ     UWA+179

      426     2196    2                  (CHPP*(4+(2*GLOBAL_SIZE)));
      427     2197    2               END;

   2197 20 001171   001177 710000 20                 TRA     s:2200

      428     2198    1           ELSE UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL - 4;

   2198 20 001172   000004 336007                    LCQ     4,DL
        20 001173   000263 056000 18                 ASQ     UWA+179
        20 001174   001177 710000 20                 TRA     s:2200

      429     2199    1       ELSE UWA.AC.SPACE_AVAIL = UWA.AC.SPACE_AVAIL - 4;

   2199 20 001175   000004 336007                    LCQ     4,DL
        20 001176   000263 056000 18                 ASQ     UWA+179

      430     2200    1       CALL FCURR_R_6('AC  ') ALTRET(ERROR1);

   2200 20 001177   000005 630400 21                 EPPR0   5
        20 001200   000001 631400 21                 EPPR1   1
        20 001201   000000 701000 xent               TSX1    FCURR_R_6
        20 001202   002231 702000 20                 TSX2    ERROR1
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:66   

      431     2201    1       CALL MODIFY_6('AC  ') ALTRET(ERROR1);

   2201 20 001203   000005 630400 21                 EPPR0   5
        20 001204   000001 631400 21                 EPPR1   1
        20 001205   000000 701000 xent               TSX1    MODIFY_6
        20 001206   002231 702000 20                 TSX2    ERROR1

      432     2202    1   CKRNG2:
      433     2203         /* Determine if all record ranges are within the
      434     2204            area they re assigned to */
      435     2205    1       CALL FETCHNS_6('AC-RA   ') ALTRET(SRT_RA); /* Get next ra */

   2205 20 001207   000017 630400 21    CKRNG2       EPPR0   15
        20 001210   000001 631400 21                 EPPR1   1
        20 001211   000000 701000 xent               TSX1    FETCHNS_6
        20 001212   001272 702000 20                 TSX2    SRT_RA

      436     2206    1       DBK_RA = UWA.DIRECT_REF;

   2206 20 001213   000036 235000 18                 LDA     UWA+30
        20 001214   200301 755100                    STA     DBK_RA,,AUTO

      437     2207    1       IF UWA.RA.LOWDBK < UWA.AC.MIN_DBK THEN

   2207 20 001215   000326 236000 18                 LDQ     UWA+214
        20 001216   000245 116000 18                 CMPQ    UWA+165
        20 001217   001223 604000 20                 TMI     RNGERR

      438     2208    1           GOTO RNGERR; /* Low range value < low area */
      439     2209    1       IF UWA.RA.HIGHDBK <= UWA.AC.MAX_DBK THEN

   2209 20 001220   000327 236000 18                 LDQ     UWA+215
        20 001221   000246 116000 18                 CMPQ    UWA+166
        20 001222   001207 604400 20                 TMOZ    CKRNG2

      440     2210    1           GOTO CKRNG2; /* High range < high area  value */
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:67   
      441     2211    1   RNGERR: /* Range error - low range value of record < low
      442     2212         area value for dbk */
      443     2213    1       CALL FCURR_R_6('AC  ') ALTRET(ERROR1); /* Get current ac */

   2213 20 001223   000005 630400 21    RNGERR       EPPR0   5
        20 001224   000001 631400 21                 EPPR1   1
        20 001225   000000 701000 xent               TSX1    FCURR_R_6
        20 001226   002231 702000 20                 TSX2    ERROR1

      444     2214    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn of ac */

   2214 20 001227   000003 630400 21                 EPPR0   3
        20 001230   000001 631400 21                 EPPR1   1
        20 001231   000000 701000 xent               TSX1    FETCHOS_6
        20 001232   002231 702000 20                 TSX2    ERROR1

      445     2215    1       CALL SET_FIELDS(2,30,UWA.SN.SENAME);

   2215 20 001233   000025 630400 21                 EPPR0   21
        20 001234   000022 631400 21                 EPPR1   18
        20 001235   000000 701000 xent               TSX1    SET_FIELDS
        20 001236   000000 011000                    NOP     0

      446     2216    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1); /* Get rc for this ra */

   2216 20 001237   000016 630400 21                 EPPR0   14
        20 001240   000001 631400 21                 EPPR1   1
        20 001241   000000 701000 xent               TSX1    FETCHOS_6
        20 001242   002231 702000 20                 TSX2    ERROR1

      447     2217    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn of rc */

   2217 20 001243   000003 630400 21                 EPPR0   3
        20 001244   000001 631400 21                 EPPR1   1
        20 001245   000000 701000 xent               TSX1    FETCHOS_6
        20 001246   002231 702000 20                 TSX2    ERROR1

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:68   
      448     2218    1       CALL SET_FIELDS(1,30,UWA.SN.SENAME);

   2218 20 001247   000031 630400 21                 EPPR0   25
        20 001250   000022 631400 21                 EPPR1   18
        20 001251   000000 701000 xent               TSX1    SET_FIELDS
        20 001252   000000 011000                    NOP     0

      449     2219    1       CALL ERROR (2302);

   2219 20 001253   000035 630400 21                 EPPR0   29
        20 001254   000001 631400 21                 EPPR1   1
        20 001255   000000 701000 xent               TSX1    ERROR
        20 001256   000000 011000                    NOP     0

      450     2220        /*E*     ERROR:    ZIG-ZIG_BAD_KEY_RANGE-C
      451     2221        MESSAGE: The range specified for the record %U1 is invalid because
      452     2222                 it is not contained within the range of keys assigned to
      453     2223                 to area %U2.
      454     2224        */
      455     2225    1       TEMP_UBIN_WORD = DBK_RA;

   2225 20 001257   200301 235100                    LDA     DBK_RA,,AUTO
        20 001260   200305 755100                    STA     TEMP_UBIN_WORD,,AUTO

      456     2226    1       CALL FETCHD_6('RA  ', TEMP_UBIN_WORD) ALTRET(ERROR1); /*Reestablish position*/

   2226 20 001261   200305 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 001262   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 001263   000021 236000 21                 LDQ     17
        20 001264   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 001265   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
        20 001266   000020 631400 21                 EPPR1   16
        20 001267   000000 701000 xent               TSX1    FETCHD_6
        20 001270   002231 702000 20                 TSX2    ERROR1

      457     2227    1       GOTO CKRNG2;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:69   
   2227 20 001271   001207 710000 20                 TRA     CKRNG2

      458     2228         /* Finished going thru ra's for this rc */
      459     2229    1   SRT_RA:
      460     2230    1       GOTO CKRNG;

   2230 20 001272   001103 710000 20    SRT_RA       TRA     CKRNG

      461     2231         /* Finished going thru ac's */
      462     2232    1   SET_POINT:
      463     2233         /* Go thru all sc and determine if the set spans more
      464     2234            than one area and set ptrsz */
      465     2235    1       CALL FETCHOS_6('OA-SC   ') ALTRET(ERROR1); /* Start at beginning */

   2235 20 001273   000036 630400 21    SET_POINT    EPPR0   30
        20 001274   000001 631400 21                 EPPR1   1
        20 001275   000000 701000 xent               TSX1    FETCHOS_6
        20 001276   002231 702000 20                 TSX2    ERROR1

      466     2236    1   NEXTSET:
      467     2237    1       CALL FETCHNS_6('OA-SC   ') ALTRET(NX_SC); /* Get next sc */

   2237 20 001277   000036 630400 21    NEXTSET      EPPR0   30
        20 001300   000001 631400 21                 EPPR1   1
        20 001301   000000 701000 xent               TSX1    FETCHNS_6
        20 001302   001644 702000 20                 TSX2    NX_SC

      468     2238    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn of sc */

   2238 20 001303   000003 630400 21                 EPPR0   3
        20 001304   000001 631400 21                 EPPR1   1
        20 001305   000000 701000 xent               TSX1    FETCHOS_6
        20 001306   002231 702000 20                 TSX2    ERROR1

      469     2239    1       IF UWA.SN.SENAME = '*CALC' THEN

   2239 20 001307   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:70   
        20 001310   000427 000036 18                 ADSC9   UWA+279                  cn=0,n=30
        20 001311   000012 000005 19                 ADSC9   10                       cn=0,n=5
        20 001312   001330 601000 20                 TNZ     s:2250

      470     2240    2       DO;

      471     2241    2           UWA.SC.SETGLO = 1; /* Set spans more than 1 area */

   2241 20 001313   000001 235007                    LDA     1,DL
        20 001314   000313 755000 18                 STA     UWA+203

      472     2242    2           UWA.SC.PTRSZ = GLOBAL_SIZE;

   2242 20 001315   000174 236000 0                  LDQ     GLOBAL_SIZE
        20 001316   000321 756000 18                 STQ     UWA+209

      473     2243    2           CALL FCURR_R_6('SC  ') ALTRET(ERROR1);

   2243 20 001317   000037 630400 21                 EPPR0   31
        20 001320   000001 631400 21                 EPPR1   1
        20 001321   000000 701000 xent               TSX1    FCURR_R_6
        20 001322   002231 702000 20                 TSX2    ERROR1

      474     2244    2           CALL MODIFY_6('SC  ') ALTRET(ERROR1);

   2244 20 001323   000037 630400 21                 EPPR0   31
        20 001324   000001 631400 21                 EPPR1   1
        20 001325   000000 701000 xent               TSX1    MODIFY_6
        20 001326   002231 702000 20                 TSX2    ERROR1

      475     2245    2           GOTO NEXTSET;

   2245 20 001327   001277 710000 20                 TRA     NEXTSET

      476     2246    2           END;
      477     2247         /* Go thru each occurrence of a sc, so/sm,
      478     2248            rc.  For each rc determine if record is in multi
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:71   
      479     2249            areas.  Determine pointer size for each rc record*/
      480     2250    1       DBK_LOC_AREA = -1;

   2250 20 001330   000001 335007                    LCA     1,DL
        20 001331   000266 755000 0                  STA     DBK_LOC_AREA

      481     2251    1       CALL FETCHOS_6('RC-RA   ') ALTRET(ERROR1); /* Just in case we hit upon

   2251 20 001332   000016 630400 21                 EPPR0   14
        20 001333   000001 631400 21                 EPPR1   1
        20 001334   000000 701000 xent               TSX1    FETCHOS_6
        20 001335   002231 702000 20                 TSX2    ERROR1

      482     2252         current occurrence */
      483     2253    1       MAX_PTR_SIZE = 2; /* Set for ptrs are local clause */

   2253 20 001336   000002 220003                    LDX0    2,DU
        20 001337   200304 740100                    STX0    MAX_PTR_SIZE,,AUTO

      484     2254    1   NEXTRS:
      485     2255    1       CALL FETCHNS_6('SC-SOSM ') ALTRET(SET_LOC); /* Get next so/sm */

   2255 20 001340   000015 630400 21    NEXTRS       EPPR0   13
        20 001341   000001 631400 21                 EPPR1   1
        20 001342   000000 701000 xent               TSX1    FETCHNS_6
        20 001343   001467 702000 20                 TSX2    SET_LOC

      486     2256    1       IF UWA.RECORD_NAME = 'SO'

   2256 20 001344   040000 106400                    CMPC    fill='040'O
        20 001345   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 001346   000035 000002 19                 ADSC9   29                       cn=0,n=2
        20 001347   001352 601000 20                 TNZ     s:2258

      487     2257    1       THEN DBK = 1;

   2257 20 001350   000001 235007                    LDA     1,DL
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:72   
        20 001351   200300 755100                    STA     DBK,,AUTO

      488     2258    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1); /* Get rc of so/sm */

   2258 20 001352   000014 630400 21                 EPPR0   12
        20 001353   000001 631400 21                 EPPR1   1
        20 001354   000000 701000 xent               TSX1    FETCHOS_6
        20 001355   002231 702000 20                 TSX2    ERROR1

      489     2259    1       IF DBK = 1

   2259 20 001356   200300 235100                    LDA     DBK,,AUTO
        20 001357   000001 115007                    CMPA    1,DL
        20 001360   001363 601000 20                 TNZ     s:2261

      490     2260    1       THEN DBK = UWA.DIRECT_REF;

   2260 20 001361   000036 236000 18                 LDQ     UWA+30
        20 001362   200300 756100                    STQ     DBK,,AUTO

      491     2261    1       IF UWA.RC.WITHINA ~= 0 & UWA.SC.USER_PTS = 0 THEN

   2261 20 001363   400000 220003                    LDX0    -131072,DU
        20 001364   000273 235000 18                 LDA     UWA+187
        20 001365   001367 601000 20                 TNZ     s:2261+4
        20 001366   000000 220003                    LDX0    0,DU
        20 001367   400000 221003                    LDX1    -131072,DU
        20 001370   000322 236000 18                 LDQ     UWA+210
        20 001371   001373 600000 20                 TZE     s:2261+8
        20 001372   000000 221003                    LDX1    0,DU
        20 001373   000000 636011                    EAQ     0,X1
        20 001374   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 001375   000000 636010                    EAQ     0,X0
        20 001376   200306 376100                    ANQ     TEMP_UBIN_WORD+1,,AUTO
        20 001377   001452 601000 20                 TNZ     SET_GLO

      492     2262    1           GOTO SET_GLO; /* Rec in more than 1 area*/
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:73   
      493     2263    1       CALL FETCHNS_6('RC-RA   ') ALTRET(NEXTSET); /* Get next ra */

   2263 20 001400   000016 630400 21                 EPPR0   14
        20 001401   000001 631400 21                 EPPR1   1
        20 001402   000000 701000 xent               TSX1    FETCHNS_6
        20 001403   001277 702000 20                 TSX2    NEXTSET

      494     2264    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1); /* Get ac of this ra */

   2264 20 001404   000017 630400 21                 EPPR0   15
        20 001405   000001 631400 21                 EPPR1   1
        20 001406   000000 701000 xent               TSX1    FETCHOS_6
        20 001407   002231 702000 20                 TSX2    ERROR1

      495     2265    1       IF DBK_LOC_AREA = -1 THEN

   2265 20 001410   000266 235000 0                  LDA     DBK_LOC_AREA
        20 001411   000004 115000 21                 CMPA    4
        20 001412   001442 601000 20                 TNZ     s:2278

      496     2266    2       DO;

      497     2267    2           DBK_LOC_AREA = UWA.DIRECT_REF; /* Dbk of ac */

   2267 20 001413   000036 236000 18                 LDQ     UWA+30
        20 001414   000266 756000 0                  STQ     DBK_LOC_AREA

      498     2268    2           AREA.MAX_DBK = UWA.AC.KEYS_ALLOC;

   2268 20 001415   000243 235000 18                 LDA     UWA+163
        20 001416   000003 755000 0                  STA     AREA+3

      499     2269    2           LOCAL_SIZE = 2;

   2269 20 001417   000002 235007                    LDA     2,DL
        20 001420   000173 755000 0                  STA     LOCAL_SIZE

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:74   
      500     2270    2           TOTAL = AREA.MAX_DBK + UWA.AC.KEYS_RSRVD;

   2270 20 001421   000003 236000 0                  LDQ     AREA+3
        20 001422   000244 036000 18                 ADLQ    UWA+164
        20 001423   200303 756100                    STQ     TOTAL,,AUTO

      501     2271    2           IF TOTAL > 262143 THEN

   2271 20 001424   000001 116003                    CMPQ    1,DU
        20 001425   001430 602000 20                 TNC     s:2273

      502     2272    2               LOCAL_SIZE = 3;

   2272 20 001426   000003 235007                    LDA     3,DL
        20 001427   000173 755000 0                  STA     LOCAL_SIZE

      503     2273    2           IF TOTAL > 134217727 THEN

   2273 20 001430   001000 116003                    CMPQ    512,DU
        20 001431   001434 602000 20                 TNC     s:2275

      504     2274    2               LOCAL_SIZE = 4;

   2274 20 001432   000004 235007                    LDA     4,DL
        20 001433   000173 755000 0                  STA     LOCAL_SIZE

      505     2275    2           IF LOCAL_SIZE > MAX_PTR_SIZE THEN

   2275 20 001434   200304 236100                    LDQ     MAX_PTR_SIZE,,AUTO
        20 001435   000022 732000                    QRS     18
        20 001436   000173 116000 0                  CMPQ    LOCAL_SIZE
        20 001437   001442 605000 20                 TPL     s:2278

      506     2276    2               MAX_PTR_SIZE = LOCAL_SIZE;

   2276 20 001440   000000 620005                    EAX0    0,AL
        20 001441   200304 740100                    STX0    MAX_PTR_SIZE,,AUTO
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:75   

      507     2277    2           END;

      508     2278    1       IF UWA.SC.USER_PTS = 1 THEN

   2278 20 001442   000322 235000 18                 LDA     UWA+210
        20 001443   000001 115007                    CMPA    1,DL
        20 001444   001340 600000 20                 TZE     NEXTRS

      509     2279    1           GOTO NEXTRS;
      510     2280    1       IF DBK_LOC_AREA ~= UWA.DIRECT_REF THEN

   2280 20 001445   000266 236000 0                  LDQ     DBK_LOC_AREA
        20 001446   001452 604000 20                 TMI     SET_GLO
        20 001447   000036 116000 18                 CMPQ    UWA+30
        20 001450   001452 601000 20                 TNZ     SET_GLO

      511     2281    1           GOTO SET_GLO;
      512     2282    1       GOTO NEXTRS;

   2282 20 001451   001340 710000 20                 TRA     NEXTRS

      513     2283    1   SET_GLO:
      514     2284    1       UWA.SC.PTRSZ = GLOBAL_SIZE; /* Set pointer size */

   2284 20 001452   000174 235000 0     SET_GLO      LDA     GLOBAL_SIZE
        20 001453   000321 755000 18                 STA     UWA+209

      515     2285    1       UWA.SC.SETGLO = 1;

   2285 20 001454   000001 236007                    LDQ     1,DL
        20 001455   000313 756000 18                 STQ     UWA+203

      516     2286    1       CALL FCURR_R_6('SC  ') ALTRET(ERROR1);

   2286 20 001456   000037 630400 21                 EPPR0   31
        20 001457   000001 631400 21                 EPPR1   1
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:76   
        20 001460   000000 701000 xent               TSX1    FCURR_R_6
        20 001461   002231 702000 20                 TSX2    ERROR1

      517     2287    1       CALL MODIFY_6('SC  ') ALTRET(ERROR1);

   2287 20 001462   000037 630400 21                 EPPR0   31
        20 001463   000001 631400 21                 EPPR1   1
        20 001464   000000 701000 xent               TSX1    MODIFY_6
        20 001465   002231 702000 20                 TSX2    ERROR1

      518     2288    1       GOTO NEXTSET;

   2288 20 001466   001277 710000 20                 TRA     NEXTSET

      519     2289    1   SET_LOC: /* Finished so/smset for this sc */
      520     2290    1       IF UWA.SC.USER_PTS = 1 THEN

   2290 20 001467   000322 235000 18    SET_LOC      LDA     UWA+210
        20 001470   000001 115007                    CMPA    1,DL
        20 001471   001475 601000 20                 TNZ     s:2292

      521     2291    1           LOCAL_SIZE = MAX_PTR_SIZE;

   2291 20 001472   200304 236100                    LDQ     MAX_PTR_SIZE,,AUTO
        20 001473   000022 732000                    QRS     18
        20 001474   000173 756000 0                  STQ     LOCAL_SIZE

      522     2292    1       UWA.SC.PTRSZ = LOCAL_SIZE;

   2292 20 001475   000173 236000 0                  LDQ     LOCAL_SIZE
        20 001476   000321 756000 18                 STQ     UWA+209

      523     2293    1       UWA.SC.SETGLO = 0;

   2293 20 001477   000313 450000 18                 STZ     UWA+203

      524     2294    1       CALL FCURR_R_6('SC  ') ALTRET(ERROR1);
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:77   

   2294 20 001500   000037 630400 21                 EPPR0   31
        20 001501   000001 631400 21                 EPPR1   1
        20 001502   000000 701000 xent               TSX1    FCURR_R_6
        20 001503   002231 702000 20                 TSX2    ERROR1

      525     2295    1       CALL MODIFY_6('SC  ') ALTRET(ERROR1);

   2295 20 001504   000037 630400 21                 EPPR0   31
        20 001505   000001 631400 21                 EPPR1   1
        20 001506   000000 701000 xent               TSX1    MODIFY_6
        20 001507   002231 702000 20                 TSX2    ERROR1

      526     2296        /*
      527     2297              Determine if the areas for the user ptrs
      528     2298            ( POINTERS ARE LOCAL ) that the member records and the
      529     2299            owner records belong to intersect.
      530     2300        */
      531     2301    1       IF UWA.SC.SETTYPE ~= 0 | UWA.SC.USER_PTS = 0

   2301 20 001510   400000 220003                    LDX0    -131072,DU
        20 001511   000310 235000 18                 LDA     UWA+200
        20 001512   001514 601000 20                 TNZ     s:2301+4
        20 001513   000000 220003                    LDX0    0,DU
        20 001514   400000 221003                    LDX1    -131072,DU
        20 001515   000322 236000 18                 LDQ     UWA+210
        20 001516   001520 600000 20                 TZE     s:2301+8
        20 001517   000000 221003                    LDX1    0,DU
        20 001520   000000 636011                    EAQ     0,X1
        20 001521   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 001522   000000 636010                    EAQ     0,X0
        20 001523   200306 276100                    ORQ     TEMP_UBIN_WORD+1,,AUTO
        20 001524   001277 601000 20                 TNZ     NEXTSET

      532     2302    1       THEN GOTO NEXTSET;
      533     2303    1       D = 0;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:78   
   2303 20 001525   200020 450100                    STZ     D,,AUTO

      534     2304    1       TEMP_UBIN_WORD = DBK;

   2304 20 001526   200300 236100                    LDQ     DBK,,AUTO
        20 001527   200305 756100                    STQ     TEMP_UBIN_WORD,,AUTO

      535     2305    1       CALL FETCHD_6('RC  ',TEMP_UBIN_WORD) ALTRET(ERROR1);

   2305 20 001530   200305 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 001531   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 001532   000013 236000 21                 LDQ     11
        20 001533   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 001534   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
        20 001535   000020 631400 21                 EPPR1   16
        20 001536   000000 701000 xent               TSX1    FETCHD_6
        20 001537   002231 702000 20                 TSX2    ERROR1

      536     2306    1   LOPST:
      537     2307    1       CALL FETCHNS_6('RC-RA   ') ALTRET(LOPEND);

   2307 20 001540   000016 630400 21    LOPST        EPPR0   14
        20 001541   000001 631400 21                 EPPR1   1
        20 001542   000000 701000 xent               TSX1    FETCHNS_6
        20 001543   001555 702000 20                 TSX2    LOPEND

      538     2308    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);

   2308 20 001544   000017 630400 21                 EPPR0   15
        20 001545   000001 631400 21                 EPPR1   1
        20 001546   000000 701000 xent               TSX1    FETCHOS_6
        20 001547   002231 702000 20                 TSX2    ERROR1

      539     2309    1       D = D + 1;

   2309 20 001550   200020 054100                    AOS     D,,AUTO

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:79   
      540     2310    1       AREAS.DBKAC(D) = UWA.DIRECT_REF;

   2310 20 001551   000036 235000 18                 LDA     UWA+30
        20 001552   200020 720100                    LXL0    D,,AUTO
        20 001553   000017 755010 0                  STA     AREAS,X0

      541     2311    1       GOTO LOPST;

   2311 20 001554   001540 710000 20                 TRA     LOPST

      542     2312    1   LOPEND:
      543     2313        /*
      544     2314              Go through all member RC(s) of this set and determine
      545     2315            if the areas of each member rc is a subset of the
      546     2316            owner RC.
      547     2317        */
      548     2318    1       CALL FETCHOS_6('SC-SOSM ') ALTRET(ERROR1);

   2318 20 001555   000015 630400 21    LOPEND       EPPR0   13
        20 001556   000001 631400 21                 EPPR1   1
        20 001557   000000 701000 xent               TSX1    FETCHOS_6
        20 001560   002231 702000 20                 TSX2    ERROR1

      549     2319    1   LOPSM:
      550     2320    1       CALL FETCHNS_6('SC-SOSM ') ALTRET(NEXTSET);

   2320 20 001561   000015 630400 21    LOPSM        EPPR0   13
        20 001562   000001 631400 21                 EPPR1   1
        20 001563   000000 701000 xent               TSX1    FETCHNS_6
        20 001564   001277 702000 20                 TSX2    NEXTSET

      551     2321    1       IF UWA.RECORD_NAME = 'SO'

   2321 20 001565   040000 106400                    CMPC    fill='040'O
        20 001566   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 001567   000035 000002 19                 ADSC9   29                       cn=0,n=2
        20 001570   001561 600000 20                 TZE     LOPSM
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:80   

      552     2322    1       THEN GOTO LOPSM;
      553     2323    1       CALL FETCHOS_6('RC-SOSM ') ALTRET(ERROR1);

   2323 20 001571   000014 630400 21                 EPPR0   12
        20 001572   000001 631400 21                 EPPR1   1
        20 001573   000000 701000 xent               TSX1    FETCHOS_6
        20 001574   002231 702000 20                 TSX2    ERROR1

      554     2324    1   LOPRA:
      555     2325    1       CALL FETCHNS_6('RC-RA   ') ALTRET(LOPSM);

   2325 20 001575   000016 630400 21    LOPRA        EPPR0   14
        20 001576   000001 631400 21                 EPPR1   1
        20 001577   000000 701000 xent               TSX1    FETCHNS_6
        20 001600   001561 702000 20                 TSX2    LOPSM

      556     2326    1       CALL FETCHOS_6('AC-RA   ') ALTRET(ERROR1);

   2326 20 001601   000017 630400 21                 EPPR0   15
        20 001602   000001 631400 21                 EPPR1   1
        20 001603   000000 701000 xent               TSX1    FETCHOS_6
        20 001604   002231 702000 20                 TSX2    ERROR1

      557     2327    2       DO I = 0 TO D;

   2327 20 001605   000000 220003                    LDX0    0,DU
        20 001606   200016 740100                    STX0    I,,AUTO
        20 001607   001617 710000 20                 TRA     s:2330+2

      558     2328    2           IF AREAS.DBKAC(I) = UWA.DIRECT_REF

   2328 20 001610   200016 220100                    LDX0    I,,AUTO
        20 001611   000017 236010 0                  LDQ     AREAS,X0
        20 001612   001615 604000 20                 TMI     s:2330
        20 001613   000036 116000 18                 CMPQ    UWA+30
        20 001614   001575 600000 20                 TZE     LOPRA
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:81   

      559     2329    2           THEN GOTO LOPRA;
      560     2330    2           END;

   2330 20 001615   000001 621010                    EAX1    1,X0
        20 001616   200016 741100                    STX1    I,,AUTO
        20 001617   200016 236100                    LDQ     I,,AUTO
        20 001620   000022 732000                    QRS     18
        20 001621   200020 116100                    CMPQ    D,,AUTO
        20 001622   001610 604400 20                 TMOZ    s:2328

      561     2331    1       CALL FCURR_R_6('SC  ') ALTRET(ERROR1);

   2331 20 001623   000037 630400 21                 EPPR0   31
        20 001624   000001 631400 21                 EPPR1   1
        20 001625   000000 701000 xent               TSX1    FCURR_R_6
        20 001626   002231 702000 20                 TSX2    ERROR1

      562     2332    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);

   2332 20 001627   000003 630400 21                 EPPR0   3
        20 001630   000001 631400 21                 EPPR1   1
        20 001631   000000 701000 xent               TSX1    FETCHOS_6
        20 001632   002231 702000 20                 TSX2    ERROR1

      563     2333    1       CALL SET_FIELDS(1,30,UWA.SN.SENAME);

   2333 20 001633   000031 630400 21                 EPPR0   25
        20 001634   000022 631400 21                 EPPR1   18
        20 001635   000000 701000 xent               TSX1    SET_FIELDS
        20 001636   000000 011000                    NOP     0

      564     2334    1       CALL ERROR(9032); /* DMCL_LOCAL_POINTER_ERR */

   2334 20 001637   000041 630400 21                 EPPR0   33
        20 001640   000001 631400 21                 EPPR1   1
        20 001641   000000 701000 xent               TSX1    ERROR
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:82   
        20 001642   000000 011000                    NOP     0

      565     2335        /*E*     ERROR:    ZIG-DMCL_LOCAL_POINTER_ERR-C
      566     2336        MESSAGE: For the set "%U1" the areas that the member records
      567     2337                 belong to must be a subset of the areas that
      568     2338                 the owner record belongs to.
      569     2339        */
      570     2340    1       GOTO NEXTSET;

   2340 20 001643   001277 710000 20                 TRA     NEXTSET

      571     2341         /* Go thru all sc type RTYP.KC and check
      572     2342            1. Duplicate keys cannot exist
      573     2343            2. Primary keys must have a value of zero
      574     2344            3. Secondarry keys must have a value assigned*/
      575     2345    1   NX_SC:
      576     2346    1       Z1 = UWA.OA.NUMB_SC;

   2346 20 001644   000216 720000 18    NX_SC        LXL0    UWA+142
        20 001645   200277 740100                    STX0    Z1,,AUTO

      577     2347    1       Z = Z1;

   2347 20 001646   200276 740100                    STX0    Z,,AUTO

      578     2348    1       TEMP_UBIN_WORD = UWA.DA.FRST_KC;

   2348 20 001647   000420 235000 18                 LDA     UWA+272
        20 001650   200305 755100                    STA     TEMP_UBIN_WORD,,AUTO

      579     2349    1       CALL FETCHD_6('SN  ', TEMP_UBIN_WORD) ALTRET(ERROR1);

   2349 20 001651   200305 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 001652   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 001653   000042 236000 21                 LDQ     34
        20 001654   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 001655   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:83   
        20 001656   000020 631400 21                 EPPR1   16
        20 001657   000000 701000 xent               TSX1    FETCHD_6
        20 001660   002231 702000 20                 TSX2    ERROR1

      580     2350    1       DBK = UWA.DIRECT_REF;

   2350 20 001661   000036 235000 18                 LDA     UWA+30
        20 001662   200300 755100                    STA     DBK,,AUTO

      581     2351    1       CALL FETCHNS_6('SN-SE   ') ALTRET(ERROR1);

   2351 20 001663   000003 630400 21                 EPPR0   3
        20 001664   000001 631400 21                 EPPR1   1
        20 001665   000000 701000 xent               TSX1    FETCHNS_6
        20 001666   002231 702000 20                 TSX2    ERROR1

      582     2352    1       GOTO NX_SC2;

   2352 20 001667   001723 710000 20                 TRA     NX_SC2

      583     2353    1   NX_SC0:
      584     2354    1       TEMP_UBIN_WORD = DBK;

   2354 20 001670   200300 235100       NX_SC0       LDA     DBK,,AUTO
        20 001671   200305 755100                    STA     TEMP_UBIN_WORD,,AUTO

      585     2355    1       CALL FETCHD_6('SN  ', TEMP_UBIN_WORD) ALTRET(ERROR1); /* Reestablish position*/

   2355 20 001672   200305 630500                    EPPR0   TEMP_UBIN_WORD,,AUTO
        20 001673   200307 450500                    STP0    TEMP_UBIN_WORD+2,,AUTO
        20 001674   000042 236000 21                 LDQ     34
        20 001675   200306 756100                    STQ     TEMP_UBIN_WORD+1,,AUTO
        20 001676   200306 630500                    EPPR0   TEMP_UBIN_WORD+1,,AUTO
        20 001677   000020 631400 21                 EPPR1   16
        20 001700   000000 701000 xent               TSX1    FETCHD_6
        20 001701   002231 702000 20                 TSX2    ERROR1

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:84   
      586     2356    1       CALL FETCHNS_6('DA-SN   ') ALTRET(TERM);

   2356 20 001702   000043 630400 21                 EPPR0   35
        20 001703   000001 631400 21                 EPPR1   1
        20 001704   000000 701000 xent               TSX1    FETCHNS_6
        20 001705   002013 702000 20                 TSX2    TERM

      587     2357    1       DBK = UWA.DIRECT_REF;

   2357 20 001706   000036 235000 18                 LDA     UWA+30
        20 001707   200300 755100                    STA     DBK,,AUTO

      588     2358    1       IF UWA.SN.SETYPE ~=31 THEN /* Not a key */

   2358 20 001710   000424 236000 18                 LDQ     UWA+276
        20 001711   000037 116007                    CMPQ    31,DL
        20 001712   002013 601000 20                 TNZ     TERM

      589     2359    1           GOTO TERM;
      590     2360    1       Z1 = Z1 - 1;

   2360 20 001713   200277 220100                    LDX0    Z1,,AUTO
        20 001714   777777 621010                    EAX1    -1,X0
        20 001715   200277 741100                    STX1    Z1,,AUTO

      591     2361    1       Z = Z1;

   2361 20 001716   200276 741100                    STX1    Z,,AUTO

      592     2362    1       CALL FETCHNS_6('SN-SE   ') ALTRET(ERROR1);

   2362 20 001717   000003 630400 21                 EPPR0   3
        20 001720   000001 631400 21                 EPPR1   1
        20 001721   000000 701000 xent               TSX1    FETCHNS_6
        20 001722   002231 702000 20                 TSX2    ERROR1

      593     2363    1   NX_SC2:
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:85   
      594     2364    1       IF UWA.SC.SETTYPE = 2 THEN

   2364 20 001723   000310 235000 18    NX_SC2       LDA     UWA+200
        20 001724   000002 115007                    CMPA    2,DL
        20 001725   001735 601000 20                 TNZ     s:2373

      595     2365    2       DO; /* Primary key */

      596     2366    2           IF UWA.SC.INDEX_ID ~= 0 THEN

   2366 20 001726   000323 236000 18                 LDQ     UWA+211
        20 001727   001734 600000 20                 TZE     s:2371

      597     2367    2               CALL ERROR(2303);

   2367 20 001730   000045 630400 21                 EPPR0   37
        20 001731   000001 631400 21                 EPPR1   1
        20 001732   000000 701000 xent               TSX1    ERROR
        20 001733   000000 011000                    NOP     0

      598     2368        /*E*     ERROR:    ZIG-ZIG_LOCAL_KEYS_EQ_ZERO-C
      599     2369        MESSAGE: Local keys must be assigned a  value of zero.
      600     2370        */
      601     2371    2           GOTO NX_SC0;

   2371 20 001734   001670 710000 20                 TRA     NX_SC0

      602     2372    2           END;
      603     2373    1       IF UWA.SC.SETTYPE = 3 THEN

   2373 20 001735   000003 115007                    CMPA    3,DL
        20 001736   001746 601000 20                 TNZ     s:2384

      604     2374    2       DO;

      605     2375    2           IF UWA.SC.INDEX_ID = 0 THEN

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:86   
   2375 20 001737   000323 236000 18                 LDQ     UWA+211
        20 001740   001746 601000 20                 TNZ     s:2384

      606     2376    3           DO;

      607     2377    3               CALL ERROR(2304);

   2377 20 001741   000047 630400 21                 EPPR0   39
        20 001742   000001 631400 21                 EPPR1   1
        20 001743   000000 701000 xent               TSX1    ERROR
        20 001744   000000 011000                    NOP     0

      608     2378        /*E*     ERROR:    ZIG-ZIG_REC_KEYS_GR_ZERO-C
      609     2379        MESSAGE: Record keys must be assigned a value greater than zero.
      610     2380        */
      611     2381    3               GOTO NX_SC0;

   2381 20 001745   001670 710000 20                 TRA     NX_SC0

      612     2382    3               END;
      613     2383    2           END;
      614     2384    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);

   2384 20 001746   000003 630400 21                 EPPR0   3
        20 001747   000001 631400 21                 EPPR1   1
        20 001750   000000 701000 xent               TSX1    FETCHOS_6
        20 001751   002231 702000 20                 TSX2    ERROR1

      615     2385    1       IF UWA.SN.SETYPE = 31 THEN /* RTYP.KC */

   2385 20 001752   000424 235000 18                 LDA     UWA+276
        20 001753   000037 115007                    CMPA    31,DL
        20 001754   002013 601000 20                 TNZ     TERM

      616     2386    2       DO;

      617     2387    2           X= UWA.SC.INDEX_ID;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:87   

   2387 20 001755   000323 720000 18                 LXL0    UWA+211
        20 001756   200017 740100                    STX0    X,,AUTO

      618     2388    2   NX_SC3:
      619     2389    2           CALL FETCHNS_6('DA-SN   ') ALTRET(NX_SC0);

   2389 20 001757   000043 630400 21    NX_SC3       EPPR0   35
        20 001760   000001 631400 21                 EPPR1   1
        20 001761   000000 701000 xent               TSX1    FETCHNS_6
        20 001762   001670 702000 20                 TSX2    NX_SC0

      620     2390    2           CALL FETCHNS_6('SN-SE   ') ALTRET(ERROR1);

   2390 20 001763   000003 630400 21                 EPPR0   3
        20 001764   000001 631400 21                 EPPR1   1
        20 001765   000000 701000 xent               TSX1    FETCHNS_6
        20 001766   002231 702000 20                 TSX2    ERROR1

      621     2391    2           Z = Z - 1;

   2391 20 001767   200276 220100                    LDX0    Z,,AUTO
        20 001770   777777 621010                    EAX1    -1,X0
        20 001771   200276 741100                    STX1    Z,,AUTO

      622     2392    2           IF Z = 0 THEN

   2392 20 001772   001670 600000 20                 TZE     NX_SC0

      623     2393    2               GOTO NX_SC0;
      624     2394    2           IF UWA.RECORD_NAME ~= 'SC' THEN

   2394 20 001773   040000 106400                    CMPC    fill='040'O
        20 001774   000023 000036 18                 ADSC9   UWA+19                   cn=0,n=30
        20 001775   000023 000002 19                 ADSC9   19                       cn=0,n=2
        20 001776   001757 601000 20                 TNZ     NX_SC3

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:88   
      625     2395    2               GOTO NX_SC3;
      626     2396    2           IF UWA.SC.SETTYPE = 3 THEN

   2396 20 001777   000310 235000 18                 LDA     UWA+200
        20 002000   000003 115007                    CMPA    3,DL
        20 002001   002012 601000 20                 TNZ     s:2402

      627     2397    2               IF X = UWA.SC.INDEX_ID THEN

   2397 20 002002   200017 236100                    LDQ     X,,AUTO
        20 002003   000022 732000                    QRS     18
        20 002004   000323 116000 18                 CMPQ    UWA+211
        20 002005   002012 601000 20                 TNZ     s:2402

      628     2398    2                   CALL ERROR(2305);

   2398 20 002006   000051 630400 21                 EPPR0   41
        20 002007   000001 631400 21                 EPPR1   1
        20 002010   000000 701000 xent               TSX1    ERROR
        20 002011   000000 011000                    NOP     0

      629     2399        /*E*     ERROR:    ZIG-ZIG_KEYS_SAME_NAME-C
      630     2400        MESSAGE: Cannot have two keys with the same name.
      631     2401        */
      632     2402    2           GOTO NX_SC3;

   2402 20 002012   001757 710000 20                 TRA     NX_SC3

      633     2403    2           END;
      634     2404         /* Finished going thru all sc's */
      635     2405    1   TERM: /* Check that all areas have been assigned
      636     2406         attributes by the dmcl */
      637     2407    1       TOTAL_KEYS = 0;

   2407 20 002013   200074 450100       TERM         STZ     TOTAL_KEYS,,AUTO

      638     2408    1       CALL FETCHOS_6('OA-AC   ') ALTRET(ERROR1);
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:89   

   2408 20 002014   000002 630400 21                 EPPR0   2
        20 002015   000001 631400 21                 EPPR1   1
        20 002016   000000 701000 xent               TSX1    FETCHOS_6
        20 002017   002231 702000 20                 TSX2    ERROR1

      639     2409         /* Go through all ac records and determine total
      640     2410            number of dbks */
      641     2411    1   CHECK_1:
      642     2412    1       CALL FETCHNS_6('OA-AC   ') ALTRET(CHECK_2);

   2412 20 002020   000002 630400 21    CHECK_1      EPPR0   2
        20 002021   000001 631400 21                 EPPR1   1
        20 002022   000000 701000 xent               TSX1    FETCHNS_6
        20 002023   002046 702000 20                 TSX2    CHECK_2

      643     2413    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1);

   2413 20 002024   000003 630400 21                 EPPR0   3
        20 002025   000001 631400 21                 EPPR1   1
        20 002026   000000 701000 xent               TSX1    FETCHOS_6
        20 002027   002231 702000 20                 TSX2    ERROR1

      644     2414    1       IF UWA.AC.DEFAULTS = 0 /* Was area defined */

   2414 20 002030   000232 235000 18                 LDA     UWA+154
        20 002031   002042 601000 20                 TNZ     s:2424

      645     2415    2       THEN DO;

      646     2416    2           CALL SET_FIELDS(1,30,UWA.SN.SENAME);

   2416 20 002032   000031 630400 21                 EPPR0   25
        20 002033   000022 631400 21                 EPPR1   18
        20 002034   000000 701000 xent               TSX1    SET_FIELDS
        20 002035   000000 011000                    NOP     0

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:90   
      647     2417    2           CALL ERROR(2306);

   2417 20 002036   000053 630400 21                 EPPR0   43
        20 002037   000001 631400 21                 EPPR1   1
        20 002040   000000 701000 xent               TSX1    ERROR
        20 002041   000000 011000                    NOP     0

      648     2418        /*E*     ERROR:    ZIG-ZIG_AREA_NOT_IN_DMCL-C
      649     2419        MESSAGE: The area %U1 has not been referenced by the DMCL.
      650     2420                 All areas in the schema must be defined in the DMCL and
      651     2421                 the number of data base keys given.
      652     2422        */
      653     2423    2           END;

      654     2424    1       TOTAL_KEYS = TOTAL_KEYS + UWA.AC.KEYS_ALLOC;

   2424 20 002042   200074 236100                    LDQ     TOTAL_KEYS,,AUTO
        20 002043   000243 036000 18                 ADLQ    UWA+163
        20 002044   200074 756100                    STQ     TOTAL_KEYS,,AUTO

      655     2425    1       GOTO CHECK_1;

   2425 20 002045   002020 710000 20                 TRA     CHECK_1

      656     2426    1   CHECK_2: /* Check that total keys in all areas not > 2**36 - 1*/
      657     2427    1       IF TOTAL_KEYS > MAXI THEN

   2427 20 002046   000261 236000 0     CHECK_2      LDQ     MAXI
        20 002047   200074 116100                    CMPQ    TOTAL_KEYS,,AUTO
        20 002050   002055 603000 20                 TRC     s:2434

      658     2428    1           CALL ERROR(2307);

   2428 20 002051   000055 630400 21                 EPPR0   45
        20 002052   000001 631400 21                 EPPR1   1
        20 002053   000000 701000 xent               TSX1    ERROR
        20 002054   000000 011000                    NOP     0
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:91   

      659     2429        /*E*     ERROR:    ZIG-ZIG_TOO_MANY_DB_KEYS-C
      660     2430        MESSAGE: The total number of data base keys allocated to all areas
      661     2431                 of the data base exceeds (2**36)-1.
      662     2432        */
      663     2433         /* Check all records for duplicate type codes */
      664     2434    1       TYPE_CD = '0'B;

   2434 20 002055   000100 100400                    MLR     fill='000'O
        20 002056   000000 000001 21                 ADSC9   0                        cn=0,n=1
        20 002057   200075 000740                    ADSC9   TYPE_CD,,AUTO            cn=0,n=480

      665     2435    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);

   2435 20 002060   000012 630400 21                 EPPR0   10
        20 002061   000001 631400 21                 EPPR1   1
        20 002062   000000 701000 xent               TSX1    FETCHOS_6
        20 002063   002231 702000 20                 TSX2    ERROR1

      666     2436    1   CHECK_3: /**Go thru all rc records and check rtype field
      667     2437         to see if duplicate types */
      668     2438    1       CALL FETCHNS_6('OA-RC   ') ALTRET(CHECK_3A);

   2438 20 002064   000012 630400 21    CHECK_3      EPPR0   10
        20 002065   000001 631400 21                 EPPR1   1
        20 002066   000000 701000 xent               TSX1    FETCHNS_6
        20 002067   002122 702000 20                 TSX2    CHECK_3A

      669     2439    1       CALL FETCHOS_6('SN-SE   ') ALTRET(ERROR1); /* Get sn */

   2439 20 002070   000003 630400 21                 EPPR0   3
        20 002071   000001 631400 21                 EPPR1   1
        20 002072   000000 701000 xent               TSX1    FETCHOS_6
        20 002073   002231 702000 20                 TSX2    ERROR1

      670     2440    1       IF UWA.RC.RTYPE = 0 THEN /* Was record assigned type*/

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:92   
   2440 20 002074   000270 235000 18                 LDA     UWA+184
        20 002075   002064 600000 20                 TZE     CHECK_3

      671     2441    1           GOTO CHECK_3;
      672     2442    1       IF ~TYPE_CD(UWA.RC.RTYPE) THEN

   2442 20 002076   002100 605000 20                 TPL     s:2442+2
        20 002077   000044 035003                    ADLA    36,DU
        20 002100   003100 060505                    CSL     bolr='003'O
        20 002101   200075 000001                    BDSC    TYPE_CD,A,AUTO           by=0,bit=0,n=1
        20 002102   200306 000044                    BDSC    TEMP_UBIN_WORD+1,,AUTO   by=0,bit=0,n=36
        20 002103   200306 236100                    LDQ     TEMP_UBIN_WORD+1,,AUTO
        20 002104   400000 676003                    ERQ     -131072,DU
        20 002105   002115 600000 20                 TZE     s:2446

      673     2443    1           TYPE_CD(UWA.RC.RTYPE) = '1'B;

   2443 20 002106   000270 235000 18                 LDA     UWA+184
        20 002107   002111 605000 20                 TPL     s:2443+3
        20 002110   000044 035003                    ADLA    36,DU
        20 002111   003105 060400                    CSL     bolr='003'O
        20 002112   000056 000001 21                 BDSC    46                       by=0,bit=0,n=1
        20 002113   200075 000001                    BDSC    TYPE_CD,A,AUTO           by=0,bit=0,n=1
        20 002114   002121 710000 20                 TRA     s:2451

      674     2444    1       ELSE
      675     2445    2       DO;

      676     2446    2           CALL ERROR(ZIG_DUP_TYPE);

   2446 20 002115   000060 630400 21                 EPPR0   48
        20 002116   000001 631400 21                 EPPR1   1
        20 002117   000000 701000 xent               TSX1    ERROR
        20 002120   000000 011000                    NOP     0

      677     2447    2           END;

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:93   
      678     2448        /*E*     ERROR:    ZIG-ZIG_DUP_TYPE-C
      679     2449        MESSAGE: A record TYPE is not uniquely defined in the DMCL.
      680     2450        */
      681     2451    1       GOTO CHECK_3;

   2451 20 002121   002064 710000 20                 TRA     CHECK_3

      682     2452         /* Assign default record types if not assigned */
      683     2453    1   CHECK_3A:
      684     2454    1       X = 1;

   2454 20 002122   000001 220003       CHECK_3A     LDX0    1,DU
        20 002123   200017 740100                    STX0    X,,AUTO

      685     2455    2       DO WHILE(( TYPE_CD(X) = '1'B) AND ( X < 4000 ));

   2455 20 002124   002130 710000 20                 TRA     s:2457

      686     2456    2           X = X + 1;

   2456 20 002125   200017 220100                    LDX0    X,,AUTO
        20 002126   000001 621010                    EAX1    1,X0
        20 002127   200017 741100                    STX1    X,,AUTO

      687     2457    2           END;

   2457 20 002130   200017 235100                    LDA     X,,AUTO
        20 002131   000022 731000                    ARS     18
        20 002132   002134 605000 20                 TPL     s:2457+4
        20 002133   000044 035003                    ADLA    36,DU
        20 002134   000000 066505                    CMPB    filb='0'B
        20 002135   200075 000001                    BDSC    TYPE_CD,A,AUTO           by=0,bit=0,n=1
        20 002136   000000 000022 21                 BDSC    0                        by=0,bit=0,n=18
        20 002137   002143 600000 20                 TZE     s:2458
        20 002140   200017 220100                    LDX0    X,,AUTO
        20 002141   007640 100003                    CMPX0   4000,DU
        20 002142   002125 604000 20                 TMI     s:2456
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:94   

      688     2458    1       CALL FETCHOS_6('OA-RC   ') ALTRET(ERROR1);

   2458 20 002143   000012 630400 21                 EPPR0   10
        20 002144   000001 631400 21                 EPPR1   1
        20 002145   000000 701000 xent               TSX1    FETCHOS_6
        20 002146   002231 702000 20                 TSX2    ERROR1

      689     2459    1   CHECK_3B:
      690     2460    1       CALL FETCHNS_6('OA-RC   ') ALTRET(CHECK_4); /* Get next rc */

   2460 20 002147   000012 630400 21    CHECK_3B     EPPR0   10
        20 002150   000001 631400 21                 EPPR1   1
        20 002151   000000 701000 xent               TSX1    FETCHNS_6
        20 002152   002206 702000 20                 TSX2    CHECK_4

      691     2461    1       IF UWA.RC.RTYPE = 0 THEN

   2461 20 002153   000270 235000 18                 LDA     UWA+184
        20 002154   002205 601000 20                 TNZ     s:2470

      692     2462    2       DO;

      693     2463    2           UWA.RC.RTYPE = X;

   2463 20 002155   200017 236100                    LDQ     X,,AUTO
        20 002156   000022 732000                    QRS     18
        20 002157   000270 756000 18                 STQ     UWA+184

      694     2464    2           CALL MODIFY_6('RC  ') ALTRET(ERROR1);

   2464 20 002160   000013 630400 21                 EPPR0   11
        20 002161   000001 631400 21                 EPPR1   1
        20 002162   000000 701000 xent               TSX1    MODIFY_6
        20 002163   002231 702000 20                 TSX2    ERROR1

      695     2465    2           X = X + 1;
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:95   

   2465 20 002164   200017 220100                    LDX0    X,,AUTO
        20 002165   000001 621010                    EAX1    1,X0
        20 002166   200017 741100                    STX1    X,,AUTO

      696     2466    3           DO WHILE(( TYPE_CD(X) = '1'B) AND ( X < 4000 ));

   2466 20 002167   002173 710000 20                 TRA     s:2468

      697     2467    3               X = X + 1;

   2467 20 002170   200017 220100                    LDX0    X,,AUTO
        20 002171   000001 621010                    EAX1    1,X0
        20 002172   200017 741100                    STX1    X,,AUTO

      698     2468    3               END;

   2468 20 002173   200017 235100                    LDA     X,,AUTO
        20 002174   000022 731000                    ARS     18
        20 002175   002177 605000 20                 TPL     s:2468+4
        20 002176   000044 035003                    ADLA    36,DU
        20 002177   000000 066505                    CMPB    filb='0'B
        20 002200   200075 000001                    BDSC    TYPE_CD,A,AUTO           by=0,bit=0,n=1
        20 002201   000000 000022 21                 BDSC    0                        by=0,bit=0,n=18
        20 002202   002205 600000 20                 TZE     s:2470
        20 002203   007640 101003                    CMPX1   4000,DU
        20 002204   002170 604000 20                 TMI     s:2467

      699     2469    2           END;

      700     2470    1       GOTO CHECK_3B;

   2470 20 002205   002147 710000 20                 TRA     CHECK_3B

      701     2471         /* Check that all data base procedures referenced
      702     2472            in ddl have been declared in dmcl */
      703     2473    1   CHECK_4:
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:96   
      704     2474    1       CALL FETCHOS_6('DA-PN   ') ALTRET(ERROR1); /* Get da record */

   2474 20 002206   000061 630400 21    CHECK_4      EPPR0   49
        20 002207   000001 631400 21                 EPPR1   1
        20 002210   000000 701000 xent               TSX1    FETCHOS_6
        20 002211   002231 702000 20                 TSX2    ERROR1

      705     2475    1   CHECK_41:
      706     2476    1       CALL FETCHNS_6('DA-PN   ') ALTRET(CHECK_5); /* Get next pn */

   2476 20 002212   000061 630400 21    CHECK_41     EPPR0   49
        20 002213   000001 631400 21                 EPPR1   1
        20 002214   000000 701000 xent               TSX1    FETCHNS_6
        20 002215   002234 702000 20                 TSX2    CHECK_5

      707     2477    1       IF UWA.PN.LANG = 0 THEN

   2477 20 002216   000454 235000 18                 LDA     UWA+300
        20 002217   002230 601000 20                 TNZ     s:2487

      708     2478    2       DO;

      709     2479    2           CALL SET_FIELDS(1,30,UWA.PN.PNAME);

   2479 20 002220   000062 630400 21                 EPPR0   50
        20 002221   000022 631400 21                 EPPR1   18
        20 002222   000000 701000 xent               TSX1    SET_FIELDS
        20 002223   000000 011000                    NOP     0

      710     2480    2           CALL ERROR(2308);

   2480 20 002224   000066 630400 21                 EPPR0   54
        20 002225   000001 631400 21                 EPPR1   1
        20 002226   000000 701000 xent               TSX1    ERROR
        20 002227   000000 011000                    NOP     0

      711     2481        /*E*     ERROR:    ZIG-ZIG_PROC_NOT_IN_DMCL-C
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:97   
      712     2482        MESSAGE: The data_base_procedure %U1 has been referenced by the
      713     2483                 schema DDL; however, corresponding DMCL entries cannot be
      714     2484                 located.
      715     2485        */
      716     2486    2           END;

      717     2487    1       GOTO CHECK_41;

   2487 20 002230   002212 710000 20                 TRA     CHECK_41

      718     2488         /* E r r o r    e x i t s */
      719     2489    1   ERROR1:
      720     2490    1       CALL ABORT;

   2490 20 002231   000000 631400 21    ERROR1       EPPR1   0
        20 002232   000000 701000 xent               TSX1    ABORT
        20 002233   000000 011000                    NOP     0

      721     2491    1   CHECK_5:
      722     2492    1   END P2DMCL;

   2492 20 002234                       CHECK_5      null
   2492 20 002234   000000 702200 xent               TSX2  ! X66_ARET

AREA
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

AREAS
 Sect OctLoc
   0     017   ****** ******   ****** ******   ****** ******   ****** ******    ................

ALL_ZEROS
 Sect OctLoc
   0     176   000000 000000                                                    ....

RNG
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:98   
 Sect OctLoc
   0     177   000000 000000                                                    ....

PART_RNG
 Sect OctLoc
   0     200   000000 000000                                                    ....

INV_FLG
 Sect OctLoc
   0     201   000000 ******                                                    ....

DCLR
 Sect OctLoc
   0     202   000001 ******                                                    ....

S1
 Sect OctLoc
   0     203   040040 040040   040040 040040   040040 040040   040040 040040

S2
 Sect OctLoc
   0     207   040040 040040   040040 040040   040040 040040   040040 040040

S3
 Sect OctLoc
   0     213   040040 040040   040040 040040   040040 040040   040040 040040

S4
 Sect OctLoc
   0     217   040040 040040   040040 040040   040040 040040   040040 040040

SUBEX_STK_SZ
 Sect OctLoc
   0     223   000000 ******                                                    ....

DELETE
 Sect OctLoc
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:99   
   0     224   7***** ******                                                    ....

FLD_NAME
 Sect OctLoc
   0     225   ****** ******   ****** ******   ****** ******   ****** ******    ................

REC_NAME
 Sect OctLoc
   0     235   ****** ******   ****** ******   ****** ******   ****** ******    ................

REFR
 Sect OctLoc
   0     245   000002 ******                                                    ....

X131072
 Sect OctLoc
   0     246   000000 400000                                                    ....

SUBH1
 Sect OctLoc
   0     247   040040 040040   040040 040040   040040 040040   040040 040040
   0     257*  040040 040040   040040 040040

MAXI
 Sect OctLoc
   0     261   777777 777777                                                    ....

FIRST
 Sect OctLoc
   0     262   000001 ******                                                    ....

LAST
 Sect OctLoc
   0     263   000002 ******                                                    ....

KEYS_RESERVED
 Sect OctLoc
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:100  
   0     267   000000 000000                                                    ....

UWA_KEY
 Sect OctLoc
   9     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  11     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  12     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  14     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  14     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  14     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  14     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  15     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  15     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  15     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  15     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  15     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  15     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  15     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  15     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  16     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  16     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  16     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:101  
  16     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  16     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  16     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  16     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  16     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  17     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  17     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  17     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  17     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  17     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  17     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  17     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  17     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  18     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     004   040040 040040   040040 040040   040040 040040   040040 040040
  18     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     014   040040 040040   040040 040040   040040 040040   040040 040040
  18     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     024   040040 040040   040040 040040   040040 040040   040040 040040
  18     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  18     040   040040 040040   040040 040040   040040 040040   040040 040040
  18     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  18     050   040040 040040   040040 040040   040040 040040   040040 040040
  18     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  18     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  18     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  18     070   040040 040040   040040 040040   040040 040040   040040 040040
  18     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  18     104   040040 040040   040040 040040   040040 040040   040040 040040
  18     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:102  
  18     130   040040 040040   040040 040040   040040 040040   040040 040040
  18     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  18     140   040040 040040   040040 040040   040040 040040   040040 040040
  18     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  18     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     154   040040 040040   040040 040040   040040 040040   040040 040040
  18     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  18     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     174   040040 040040   040040 040040   040040 040040   040040 040040
  18     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  18     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  18     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  18     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  18     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  18     430   040040 040040   040040 040040   040040 040040   040040 040040
  18     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  18     440   040040 040040   040040 040040   040040 040040   040040 040040
  18     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  18     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  18     460   040040 040040   040040 040040   040040 040040   040040 040040
  18     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  18     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  18     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  18     504   040040 040040   040040 040040   040040 040040   040040 040040
  18     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  18     524   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:103  
  18     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  18     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  18     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  18     614   040040 040040   040040 040040   040040 040040   040040 040040
  18     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  18     624   040040 040040   040040 040040   040040 040040   040040 040040
  18     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18     664   040040 040040   040040 040040   040040 040040   040040 040040
  18     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18     700   040040 040040   040040 040040   040040 040040   040040 040040
  18     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18     714   040040 040040   040040 040040   040040 040040   040040 040040
  18     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  18     724   040040 040040   040040 040040   040040 040040   040040 040040
  18     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18     744   040040 040040   040040 040040   040040 040040   040040 040040
  18     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1000   040040 040040   040040 040040   040040 040040   040040 040040
  18    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1040   040040 040040   040040 040040   040040 040040   040040 040040
  18    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1064   040040 040040   040040 040040   040040 040040   040040 040040
  18    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1120   040040 040040   040040 040040   040040 040040   040040 040040
  18    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1140   040040 040040   040040 040040   040040 040040   040040 040040
  18    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1154   040040 040040   040040 040040   040040 040040   040040 040040
  18    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  18    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1170   040040 040040   040040 040040   040040 040040   040040 040040
  18    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  18    1204   040040 040040   040040 040040   040040 040040   040040 040040
  18    1214*  040040 040040   040040 040040   040040 040040   040040 040040

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:104  
(unnamed)
 Sect OctLoc
  19     000   117101 055101   103040 040040   123116 055123   105040 040040    OA-AC   SN-SE
  19     004   101103 040040   117101 040040   117101 055122   103040 040040    AC  OA  OA-RC
  19     010   052104 102120   101122 101115   052103 101114   103056 122103    *DBPARAM*CALC.RC
  19     014   052123 131123   124105 115040   052120 101137   122105 103137    *SYSTEM *PA_REC_
  19     020   122103 040040   122103 055123   117123 115040   123103 055123    RC  RC-SOSM SC-S
  19     024   117123 115040   122103 055122   101040 040040   101103 055122    OSM RC-RA   AC-R
  19     030   101040 040040   122101 040040   117101 055123   103040 040040    A   RA  OA-SC
  19     034   123103 040040   123117 040040   123116 040040   104101 055123    SC  SO  SN  DA-S
  19     040   116040 040040   104101 055120   116040 040040                    N   DA-PN

(unnamed)
 Sect OctLoc
  21     000   000000 000000   000001 000000   000000 006000   000002 006000    ................
  21     004   777777 777777   000004 006000   000000 004375   000006 006000    ................
  21     010   000001 604000   000005 006000   000006 006000   000020 006000    ................
  21     014   000021 006000   000023 006000   000025 006000   000027 006000    ................
  21     020   000002 000000   000031 006000   000003 000000   000000 000002    ................
  21     024   000000 000036   000023 006000   000024 006000   000427 006000    ................
  21     030   000000 000001   000030 006000   000024 006000   000427 006000    ................
  21     034   000000 004376   000034 006000   000032 006000   000034 006000    ................
  21     040   000000 021510   000040 006000   000036 006000   000037 006000    ..... ..........
  21     044   000000 004377   000044 006000   000000 004400   000046 006000    .....$.......&..
  21     050   000000 004401   000050 006000   000000 004402   000052 006000    .....(.......*..
  21     054   000000 004403   000054 006000   400000 000000   000000 004125    .....,.........U
  21     060   000057 006000   000041 006000   000030 006000   000024 006000    ./...!..........
  21     064   000455 006000   000000 004404   000065 006000                    .........5..

PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:105  
--  Include file information  --

   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIA_IDS_DCL.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure P2DMCL.

   Procedure P2DMCL requires 1181 words for executable code.
   Procedure P2DMCL requires 200 words of local(AUTO) storage.

    No errors detected in file ZIG$M_P8.:ZIC0TSI    .
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:106  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:107  
          MINI XREF LISTING

ABORT
      1460**DCL-ENT  2490--CALL
ADJ_HIGH_DBK
        54**DCL      2064<<ASSIGN   2070<<ASSIGN   2159>>ASSIGN
ADJ_LOW_DBK
        53**DCL      2062<<ASSIGN   2069<<ASSIGN   2158>>ASSIGN
AREA.ALLOC
        33**DCL      1914<<ASSIGN   1915>>IF       1916<<ASSIGN   1962>>ASSIGN   1965>>IF       1966>>ASSIGN
      1968>>ASSIGN   1999>>ASSIGN
AREA.BASE_DBK
        34**DCL      1984<<ASSIGN   1991>>ASSIGN
AREA.DBK_CALC
        42**DCL      1920<<ASSIGN   2074<<ASSIGN   2079>>DOWHILE  2089>>ASSIGN   2090>>ASSIGN   2091>>IF
AREA.DBK_PAGE
        40**DCL        41--REDEF    1919<<ASSIGN   1965>>IF       1966>>ASSIGN   1968>>ASSIGN
AREA.DBK_PAGE_REDEF
        41**DCL      1928>>DOWHILE
AREA.FIRST_INV_PG
        38**DCL      1976<<ASSIGN   1978<<ASSIGN   2000>>ASSIGN
AREA.INV_THRESH
        44**DCL      1921<<ASSIGN   1981<<ASSIGN   1997>>ASSIGN
AREA.INV_UNIT
        46**DCL      1922<<ASSIGN   1988<<ASSIGN   2001>>ASSIGN
AREA.LINE_BITS
        43**DCL      1917<<ASSIGN   1931<<ASSIGN   1996>>ASSIGN
AREA.MAX_DBK
        36**DCL      1896<<ASSIGN   1939>>ASSIGN   1946>>ASSIGN   1949>>ASSIGN   1962<<ASSIGN   1993>>ASSIGN
      2011>>ASSIGN   2268<<ASSIGN   2270>>ASSIGN
AREA.MAX_PAGE
        39**DCL      1974<<ASSIGN   1995>>ASSIGN
AREA.MIN_DBK
        35**DCL      1918<<ASSIGN   1939<<ASSIGN   1962>>ASSIGN   1984>>ASSIGN   1992>>ASSIGN   2068<<ASSIGN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:108  
      2069>>ASSIGN   2070>>ASSIGN
AREA.MIN_PAGE
        37**DCL      1895<<ASSIGN   1994>>ASSIGN
AREA.PGS_INV_PG
        45**DCL      1934<<ASSIGN   1936<<ASSIGN   1970>>IF       1971>>ASSIGN   1973>>ASSIGN   1998>>ASSIGN
AREAS.DBKAC
        50**DCL      2310<<ASSIGN   2328>>IF
CALC_OFFS
        55**DCL      2075<<ASSIGN   2076>>IF       2079>>DOWHILE  2081<<ASSIGN   2081>>ASSIGN   2083<<ASSIGN
      2085>>IF       2086>>ASSIGN   2088>>ASSIGN   2170>>ASSIGN
CHECK_1
      2412**LABEL    2425--GOTO
CHECK_2
      2427**LABEL    2412--CALLALT
CHECK_3
      2438**LABEL    2441--GOTO     2451--GOTO
CHECK_3A
      2454**LABEL    2438--CALLALT
CHECK_3B
      2460**LABEL    2470--GOTO
CHECK_4
      2474**LABEL    2460--CALLALT
CHECK_41
      2476**LABEL    2487--GOTO
CHECK_5
      2492**LABEL    2476--CALLALT
CHPP
        29**DCL      2185<<ASSIGN   2187>>ASSIGN   2195>>ASSIGN
CKAC
      2176**LABEL    2024--CALLALT
CKRNG
      2178**LABEL    2230--GOTO
CKRNG2
      2205**LABEL    2210--GOTO     2227--GOTO
D
        73**DCL      2124<<DOINDEX  2125>>ASSIGN   2125>>ASSIGN   2142<<DOINDEX  2143>>IF       2303<<ASSIGN
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:109  
      2309<<ASSIGN   2309>>ASSIGN   2310>>ASSIGN   2327>>DOINDEX
DBK
       104**DCL      2257<<ASSIGN   2259>>IF       2260<<ASSIGN   2304>>ASSIGN   2350<<ASSIGN   2354>>ASSIGN
      2357<<ASSIGN
DBK_LOC_AREA
      1885**DCL      2250<<ASSIGN   2265>>IF       2267<<ASSIGN   2280>>IF
DBK_RA
       105**DCL      2206<<ASSIGN   2225>>ASSIGN
DOAC
      1901**LABEL    1905--GOTO     2007--GOTO
DONE_PA_RC_RA
      2048**LABEL    2040--CALLALT
DORA
      2011**LABEL    1901--CALLALT
ERROR
      1452**DCL-ENT  2219--CALL     2334--CALL     2367--CALL     2377--CALL     2398--CALL     2417--CALL
      2428--CALL     2446--CALL     2480--CALL
ERROR1
      2490**LABEL    1894--CALLALT  1902--CALLALT  1950--CALLALT  2004--CALLALT  2005--CALLALT  2018--CALLALT
      2019--CALLALT  2022--CALLALT  2025--CALLALT  2033--CALLALT  2035--CALLALT  2036--CALLALT  2037--CALLALT
      2038--CALLALT  2042--CALLALT  2043--CALLALT  2044--CALLALT  2045--CALLALT  2048--CALLALT  2052--CALLALT
      2055--CALLALT  2056--CALLALT  2172--CALLALT  2173--CALLALT  2176--CALLALT  2200--CALLALT  2201--CALLALT
      2213--CALLALT  2214--CALLALT  2216--CALLALT  2217--CALLALT  2226--CALLALT  2235--CALLALT  2238--CALLALT
      2243--CALLALT  2244--CALLALT  2251--CALLALT  2258--CALLALT  2264--CALLALT  2286--CALLALT  2287--CALLALT
      2294--CALLALT  2295--CALLALT  2305--CALLALT  2308--CALLALT  2318--CALLALT  2323--CALLALT  2326--CALLALT
      2331--CALLALT  2332--CALLALT  2349--CALLALT  2351--CALLALT  2355--CALLALT  2362--CALLALT  2384--CALLALT
      2390--CALLALT  2408--CALLALT  2413--CALLALT  2435--CALLALT  2439--CALLALT  2458--CALLALT  2464--CALLALT
      2474--CALLALT
FCURR_R_6
       226**DCL-ENT  1950--CALL     2004--CALL     2018--CALL     2033--CALL     2172--CALL     2200--CALL
      2213--CALL     2243--CALL     2286--CALL     2294--CALL     2331--CALL
FETCHD_6
       224**DCL-ENT  2048--CALL     2226--CALL     2305--CALL     2349--CALL     2355--CALL
FETCHNS_6
       229**DCL-ENT  1901--CALL     2024--CALL     2035--CALL     2037--CALL     2040--CALL     2054--CALL
      2178--CALL     2205--CALL     2237--CALL     2255--CALL     2263--CALL     2307--CALL     2320--CALL
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:110  
      2325--CALL     2351--CALL     2356--CALL     2362--CALL     2389--CALL     2390--CALL     2412--CALL
      2438--CALL     2460--CALL     2476--CALL
FETCHOS_6
       233**DCL-ENT  1894--CALL     1902--CALL     2022--CALL     2025--CALL     2036--CALL     2038--CALL
      2042--CALL     2052--CALL     2055--CALL     2056--CALL     2176--CALL     2214--CALL     2216--CALL
      2217--CALL     2235--CALL     2238--CALL     2251--CALL     2258--CALL     2264--CALL     2308--CALL
      2318--CALL     2323--CALL     2326--CALL     2332--CALL     2384--CALL     2408--CALL     2413--CALL
      2435--CALL     2439--CALL     2458--CALL     2474--CALL
FINDD_6
       225**DCL-ENT  2043--CALL     2045--CALL
FIND_SAVED_PRIME
      2104**LABEL    2117--EXIT
GLOBAL_SIZE
        60**DCL      2012<<ASSIGN   2014<<ASSIGN   2016<<ASSIGN   2017>>ASSIGN   2195>>ASSIGN   2242>>ASSIGN
      2284>>ASSIGN
HIGH_DBK
        51**DCL      2058<<ASSIGN   2059>>IF       2063<<ASSIGN   2070>>ASSIGN   2086>>ASSIGN   2088>>ASSIGN
HLN
        30**DCL      2187<<ASSIGN   2189>>ASSIGN
I
        71**DCL      2327<<DOINDEX  2328>>IF
INV_FLG
        81**DCL      1933>>IF       1969>>IF       1975>>IF       1980>>IF       1986>>IF       2002>>IF
KEYS_RESERVED
      1888**DCL      1939>>ASSIGN   1985<<ASSIGN   2011>>ASSIGN
LOCAL_SIZE
        59**DCL      2269<<ASSIGN   2272<<ASSIGN   2274<<ASSIGN   2275>>IF       2276>>ASSIGN   2291<<ASSIGN
      2292>>ASSIGN
LOPEND
      2318**LABEL    2307--CALLALT
LOPRA
      2325**LABEL    2329--GOTO
LOPSM
      2320**LABEL    2322--GOTO     2325--CALLALT
LOPST
      2307**LABEL    2311--GOTO
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:111  
LOW_DBK
        52**DCL      2057<<ASSIGN   2059>>IF       2061<<ASSIGN   2063>>ASSIGN   2069>>ASSIGN   2075>>ASSIGN
      2086>>ASSIGN   2088>>ASSIGN
MAXI
        98**DCL      1947>>IF       1949>>ASSIGN   2427>>IF
MAX_PTR_SIZE
      1889**DCL      2253<<ASSIGN   2275>>IF       2276<<ASSIGN   2291>>ASSIGN
MODIFYIA_6
       239**DCL-ENT  2173--CALL
MODIFY_6
       227**DCL-ENT  2005--CALL     2019--CALL     2201--CALL     2244--CALL     2287--CALL     2295--CALL
      2464--CALL
NEXTRA1
      2158**LABEL    2073--GOTO     2096--GOTO     2110--GOTO
NEXTRS
      2255**LABEL    2279--GOTO     2282--GOTO
NEXTSET
      2237**LABEL    2245--GOTO     2263--CALLALT  2288--GOTO     2302--GOTO     2320--CALLALT  2340--GOTO
NUMB_CALC
        56**DCL      2089<<ASSIGN   2092<<ASSIGN   2092>>ASSIGN   2093>>IF       2094<<ASSIGN   2095>>IF
      2105>>IF       2107>>IF       2109<<ASSIGN   2127>>ASSIGN   2131>>IF       2132<<ASSIGN   2132>>ASSIGN
      2136>>DOWHILE  2143>>IF       2145<<ASSIGN   2145>>ASSIGN   2153>>ASSIGN   2169>>ASSIGN
NXTRA
      2054**LABEL    2174--GOTO
NXTRC
      2024**LABEL    2027--GOTO     2029--GOTO     2031--GOTO     2049--GOTO     2054--CALLALT
NXT_PA_RC_RA
      2040**LABEL    2046--GOTO
NX_SC
      2346**LABEL    2237--CALLALT
NX_SC0
      2354**LABEL    2371--GOTO     2381--GOTO     2389--CALLALT  2393--GOTO
NX_SC2
      2364**LABEL    2352--GOTO
NX_SC3
      2389**LABEL    2395--GOTO     2402--GOTO
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:112  
OA_SPACE
        31**DCL      2189<<ASSIGN   2190>>DOWHILE  2191<<ASSIGN   2191>>ASSIGN   2193>>ASSIGN
PART_RNG
        69**DCL      2090<<ASSIGN   2091>>IF
PA_PLACE
        27**DCL      2034<<ASSIGN   2043<>CALL     2048<>CALL
PRIME
      2137**LABEL    2146--GOTO
PRIME_INDEX
        79**DCL      2102<<ASSIGN   2104>>DOUNTIL  2105>>IF       2107>>IF       2109>>ASSIGN   2113<<ASSIGN
      2113>>ASSIGN   2122>>IF       2124>>DOINDEX  2127>>ASSIGN   2128>>ASSIGN   2151>>IF       2153>>ASSIGN
PRIME_SAVER
        76**DCL      1892<<ASSIGN   2125<<ASSIGN   2125>>ASSIGN
PRIME_SAVER.N_CALC
        77**DCL      2105>>IF       2127<<ASSIGN
PRIME_SAVER.PRIM
        78**DCL      2107>>IF       2109>>ASSIGN   2128<<ASSIGN   2153<<ASSIGN
RNG
        68**DCL      2086<<ASSIGN   2088<<ASSIGN   2089>>ASSIGN   2090>>ASSIGN
RNGERR
      2213**LABEL    2208--GOTO
ROOT
        74**DCL      2135<<ASSIGN   2136>>DOWHILE  2136>>DOWHILE  2137<<ASSIGN   2137>>ASSIGN   2142>>DOINDEX
SET_FIELDS
      1455**DCL-ENT  2215--CALL     2218--CALL     2333--CALL     2416--CALL     2479--CALL
SET_GLO
      2284**LABEL    2262--GOTO     2281--GOTO
SET_LOC
      2290**LABEL    2255--CALLALT
SET_POINT
      2235**LABEL    2178--CALLALT
SRT_RA
      2230**LABEL    2205--CALLALT
STRE_6
       221**DCL-ENT  2044--CALL
SUBSCHEMA_KEY
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:113  
      1487**DCL      1488--REDEF
T1
        57**DCL      1966<<ASSIGN   1968<<ASSIGN   1970>>IF       1971>>ASSIGN   1973>>ASSIGN   1974>>ASSIGN
      1976>>ASSIGN
T3
        58**DCL      1964<<ASSIGN   1971<<ASSIGN   1973<<ASSIGN   1974>>ASSIGN
TEMP_UBIN_WORD
      1890**DCL      2225<<ASSIGN   2226<>CALL     2304<<ASSIGN   2305<>CALL     2348<<ASSIGN   2349<>CALL
      2354<<ASSIGN   2355<>CALL
TERM
      2407**LABEL    2356--CALLALT  2359--GOTO
TOTAL
      1887**DCL      2011<<ASSIGN   2013>>IF       2015>>IF       2270<<ASSIGN   2271>>IF       2273>>IF
TOTAL_KEYS
        83**DCL      1946<<ASSIGN   1947>>IF       2407<<ASSIGN   2424<<ASSIGN   2424>>ASSIGN   2427>>IF
TOTAL_RSRVD
      1886**DCL      1897<<ASSIGN   1959<<ASSIGN   1959>>ASSIGN
TYPE_CD
        94**DCL      2434<<ASSIGN   2442>>IF       2443<<ASSIGN   2455>>DOWHILE  2466>>DOWHILE
USER_PLACE
        28**DCL      2041<<ASSIGN   2045<>CALL
UWA.AC.BASE_DBK
      1639**DCL      1991<<ASSIGN
UWA.AC.CALC_NEXT
      1658**DCL      1659--REDEF
UWA.AC.CALC_NULL
      1638**DCL      1908>>IF       2072>>IF       2162>>IF       2181>>IF
UWA.AC.CALC_PRIOR
      1667**DCL      1668--REDEF
UWA.AC.DBK_CALC
      1649**DCL      1908>>IF       1909<<ASSIGN   1920>>ASSIGN   2074>>ASSIGN   2182>>IF       2185>>ASSIGN
      2187>>ASSIGN
UWA.AC.DBK_PAGE
      1648**DCL      1906>>IF       1907<<ASSIGN   1909>>ASSIGN   1919>>ASSIGN   2182>>IF       2185>>ASSIGN
UWA.AC.DEFAULTS
      1619**DCL      1620--REDEF    2414>>IF
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:114  
UWA.AC.FILE_CODE
      1624**DCL      1625--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      1621**DCL      1622--REDEF
UWA.AC.FRST_INV_PG
      1647**DCL      2000<<ASSIGN
UWA.AC.INV_THRESH
      1651**DCL      1997<<ASSIGN
UWA.AC.INV_UNIT
      1654**DCL      2001<<ASSIGN
UWA.AC.KEYS_ALLOC
      1640**DCL      1999<<ASSIGN   2268>>ASSIGN   2424>>ASSIGN
UWA.AC.KEYS_RSRVD
      1641**DCL      1946>>ASSIGN   1949<<ASSIGN   1959>>ASSIGN   1985>>ASSIGN   2270>>ASSIGN
UWA.AC.LINE_BITS
      1650**DCL      1996<<ASSIGN
UWA.AC.MAX_DBK
      1643**DCL      1914>>ASSIGN   1993<<ASSIGN   2063>>ASSIGN   2064>>ASSIGN   2209>>IF
UWA.AC.MAX_PAGE
      1645**DCL      1995<<ASSIGN
UWA.AC.MIN_DBK
      1642**DCL      1992<<ASSIGN   2062>>ASSIGN   2063>>ASSIGN   2068>>ASSIGN   2207>>IF
UWA.AC.MIN_PAGE
      1644**DCL      1910<<ASSIGN   1994<<ASSIGN
UWA.AC.PAGE_SIZE
      1655**DCL      1934>>ASSIGN   1981>>ASSIGN   1981>>ASSIGN   2180>>ASSIGN
UWA.AC.PAGE_TYP
      1636**DCL      1904>>IF       1906>>IF       2179>>IF
UWA.AC.PER_INV
      1637**DCL      1933>>IF       1969>>IF       1975>>IF       1980>>IF       1981>>ASSIGN   1986>>IF
      1988>>ASSIGN   2002>>IF       2003<<ASSIGN
UWA.AC.PGS_INV_PG
      1653**DCL      1998<<ASSIGN
UWA.AC.SECTORS_PAGE
      1657**DCL      1911>>IF       1912<<ASSIGN
UWA.AC.SPACE_AVAIL
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:115  
      1656**DCL      2180<<ASSIGN   2193<<ASSIGN   2193>>ASSIGN   2195<<ASSIGN   2195>>ASSIGN   2198<<ASSIGN
      2198>>ASSIGN   2199<<ASSIGN   2199>>ASSIGN
UWA.DA.FRST_KC
      1769**DCL      2348>>ASSIGN
UWA.DIRECT_REF
      1559**DCL      2034>>ASSIGN   2041>>ASSIGN   2206>>ASSIGN   2260>>ASSIGN   2267>>ASSIGN   2280>>IF
      2310>>ASSIGN   2328>>IF       2350>>ASSIGN   2357>>ASSIGN
UWA.OA.GLOBAL
      1615**DCL      2017<<ASSIGN
UWA.OA.NUMB_SC
      1607**DCL      2346>>ASSIGN
UWA.PN.LANG
      1782**DCL      2477>>IF
UWA.PN.PNAME
      1783**DCL      2479<>CALL
UWA.RA.CALC_HDRS
      1710**DCL      2164<<ASSIGN   2169<<ASSIGN
UWA.RA.HDR_OFFS
      1711**DCL      2165<<ASSIGN   2170<<ASSIGN
UWA.RA.HIGHDBK
      1709**DCL      2058>>ASSIGN   2159<<ASSIGN   2209>>IF
UWA.RA.LOWDBK
      1708**DCL      2057>>ASSIGN   2158<<ASSIGN   2207>>IF
UWA.RC.RTYPE
      1677**DCL      2440>>IF       2442>>IF       2443>>ASSIGN   2461>>IF       2463<<ASSIGN
UWA.RC.WITHINA
      1680**DCL      2261>>IF
UWA.RECORD_NAME
      1556**DCL      2256>>IF       2321>>IF       2394>>IF
UWA.SC.INDEX_ID
      1705**DCL      2366>>IF       2375>>IF       2387>>ASSIGN   2397>>IF
UWA.SC.PTRSZ
      1703**DCL      2242<<ASSIGN   2284<<ASSIGN   2292<<ASSIGN
UWA.SC.SETGLO
      1697**DCL      2241<<ASSIGN   2285<<ASSIGN   2293<<ASSIGN
UWA.SC.SETTYPE
PL6.E3A0      #001=P2DMCL File=ZIG$M_P8.:ZIC0TSI                                 FRI 09/05/97 12:08 Page:116  
      1694**DCL      2301>>IF       2364>>IF       2373>>IF       2396>>IF
UWA.SC.USER_PTS
      1704**DCL      2261>>IF       2278>>IF       2290>>IF       2301>>IF
UWA.SN.SENAME
      1777**DCL      2026>>IF       2028>>IF       2030>>IF       2032>>IF       2215<>CALL     2218<>CALL
      2239>>IF       2333<>CALL     2416<>CALL
UWA.SN.SETYPE
      1774**DCL      2358>>IF       2385>>IF
WARNING
      1453**DCL-ENT  1951--CALL
X
        72**DCL      1927<<ASSIGN   1928>>DOWHILE  1929<<ASSIGN   1929>>ASSIGN   1931>>ASSIGN   2078<<ASSIGN
      2080<<ASSIGN   2080>>ASSIGN   2083>>ASSIGN   2387<<ASSIGN   2397>>IF       2454<<ASSIGN   2455>>DOWHILE
      2455>>DOWHILE  2456<<ASSIGN   2456>>ASSIGN   2463>>ASSIGN   2465<<ASSIGN   2465>>ASSIGN   2466>>DOWHILE
      2466>>DOWHILE  2467<<ASSIGN   2467>>ASSIGN
Z
        99**DCL      2347<<ASSIGN   2361<<ASSIGN   2391<<ASSIGN   2391>>ASSIGN   2392>>IF
Z1
       100**DCL      2346<<ASSIGN   2347>>ASSIGN   2360<<ASSIGN   2360>>ASSIGN   2361>>ASSIGN
