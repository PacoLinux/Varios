
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:1    
        1        1        /*M* ZIU$PRJRNL  IDSII  DRIVER FOR PROCESSING THE JOURNAL RECS FOR ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$PRJRNL: PROC NOAUTO ALTRET;
        8        8
        9        9    1   DCL 1 ROLL_REC,
       10       10    1         2 START UBIN WORD,
       11       11    1         2 USER# UBIN BYTE UNAL;
       12       12
       13       13    1   DCL 1 M_JRNL SYMREF ALIGNED,
       14       14    1         2 N,
       15       15    1           3 L UBIN BYTE UNAL,
       16       16    1           3 C CHAR(7) UNAL,
       17       17    1         2 DCB# UBIN HALF UNAL;
       18       18
       19       19    1   DCL CURR_USER# UBIN BYTE STATIC ALIGNED; /* USER# last jrnl rec */
       20       20    1   DCL CURR_TIME UBIN WORD STATIC ALIGNED; /* Current journal time */
       21       21    1   DCL X SBIN WORD STATIC ALIGNED;
       22       22    1   DCL JREC_NO UBIN WORD STATIC SYMDEF INIT(0);
       23       23    1   DCL UNAP UBIN WORD STATIC SYMDEF INIT(0);
       24       24    1   DCL 1 JRNL_BUF SYMREF ALIGNED, /* Journal input buf */
       25       25    1         2 VAL CHAR(4096) UNAL;
       26       26    1   DCL ROLL_CMPLT_TIME UBIN WORD SYMREF ALIGNED;
       27       27    1   DCL END_OF_JRNL BIT(1) STATIC UNAL INIT('0'B);
       28       28    1   DCL END_OF_ROLL BIT(1) STATIC UNAL INIT('0'B);
       29       29
       30       30    1   DCL 1 M_RLBK SYMREF ALIGNED,
       31       31    1         2 N,
       32       32    1           3 L UBIN BYTE UNAL,
       33       33    1           3 C CHAR(7) UNAL,
       34       34    1         2 DCB# UBIN HALF UNAL;
       35       35
       36       36    1   DCL B$TCB$ PTR SYMREF;
       37       37
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:2    
       38       38    1   DCL I_O_BUF$ PTR SYMREF;
       39       39    1   DCL I_O_BUF(0:0) BASED(I_O_BUF$) CHAR(4096) ALIGNED;
       40       40    1   DCL ZEROS (0:1023) UBIN WORD BASED(ZERO$);
       41       41    1   DCL ZERO$ PTR STATIC SYMDEF;
       42       42
       43       43
       44       44         %INCLUDE ZI$JRNL;
       45      152         %JRNL_REC;
       46      227         %INCLUDE ZI_DBU_ROLL;
       47      311         %ROLL_SUBS;
       48      330         %ROLL_LIST;
       49      389         %INCLUDE ZI_ROLL_STATS;
       50      510         %CNTERS(STCLASS=SYMREF);
       51      531         %INCLUDE ZI$DIR;
       52      688         %DIR;
       53      832         %INCLUDE CP_6;
       54      913         %F$DCB;
       55      970         %B$TCB;
       56      973         %B$EXCFR;
       57      991         %INCLUDE ZI_GLOBAL_DBUTIL;
       58     1169         %SYS_FUNC;
       59     1261         %INCLUDE B_ERRORS_C;
       60     2388         %INCLUDE ZI_ERRORS_SUBS;
       61     2908         %INCLUDE CP_6_SUBS;
       62     3448
       63     3449    1   DCL SYS_FUNC_READ ENTRY ALTRET;
       64     3450    1   DCL DEL_USER_FIDS ENTRY(1) ALTRET;
       65     3451    1   DCL ERASE_USER_DCBID ENTRY(2) ALTRET;
       66     3452    1   DCL PROCESS_FID ENTRY ALTRET;
       67     3453    1   DCL PROCESS_STO ENTRY ALTRET;
       68     3454    1   DCL PROCESS_DEL ENTRY ALTRET;
       69     3455    1   DCL PROCESS_MOD ENTRY ALTRET;
       70     3456    1   DCL PROCESS_SUM ENTRY ALTRET;
       71     3457    1   DCL PROCESS_SET ENTRY ALTRET;
       72     3458    1   DCL PROCESS_KSTO ENTRY ALTRET;
       73     3459    1   DCL PROCESS_KDEL ENTRY ALTRET;
       74     3460    1   DCL PROCESS_ISTO ENTRY ALTRET;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:3    
       75     3461    1   DCL PROCESS_IDEL ENTRY ALTRET;
       76     3462    1   DCL ZERO_SUP ENTRY(3);
       77     3463    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       78     3464    1   DCL ZIU$CGCLNUP ENTRY(2) ALTRET;
       79     3465    1   DCL PROCESS_CGMSG ENTRY ALTRET;
       80     3466    1   DCL PROCESS_CGDEL ENTRY ALTRET;
       81     3467    1   DCL FIND_USER_FIDID ENTRY(3) ALTRET;
       82     3468
       83     3469
       84     3470        /*
       85     3471                 APPLY THE JOURNAL RECORDS--IGNORING ROLLBACK INTERVALS
       86     3472        */
       87     3473    1   BGIN:
       88     3474    1       ROLL_REC.USER# = 0;
       89     3475    1       ROLL_REC.START = HIGH_VALUE;
       90     3476    1       CURR_TIME = 0;
       91     3477    2       DO X = 0 TO NO.USERS;
       92     3478    2           USER.SYSID(X) = 0;
       93     3479    2           USER.RLBK_START(X) = HIGH_VALUE;
       94     3480    2           END;
       95     3481    1       ZERO$ = ADDR(I_O_BUF(29));
       96     3482    2       DO X = 0 TO 1023;
       97     3483    2           ZEROS(X) = 0;
       98     3484    2           END;
       99     3485
      100     3486    1       CALL FILL_ROLL_INTRVLS ALTRET(ALTRTN);
      101     3487    1       CALL READ_JRNL ALTRET(EOF_JRNL);
      102     3488
      103     3489    2       DO WHILE(CURR_TIME < ROLL_CMPLT_TIME);
      104     3490
      105     3491
      106     3492    2           IF JREC.TYPE = T#FID OR JREC.TYPE = T#ROL OR JREC.TYPE= T#BGN OR
      107     3493    2              JREC.TIME <= USER.RLBK_START(CURR_USER#) THEN
      108     3494
      109     3495    3           DO CASE(JREC.TYPE);
      110     3496
      111     3497    3           CASE(T#BGN);
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:4    
      112     3498    3               IF USER.SYSID(BERC.USER#) ~= 0 THEN
      113     3499    4               DO; /* New user w/out and end record for last one */
      114     3500    4                   ERR_INSERT.CNT(0) = 6;
      115     3501    4                   CALL BINCHAR(ERR_INSERT.TEXT(0),
      116     3502    4                      USER.SYSID(BERC.USER#));
      117     3503    4                   CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,'1'B);
      118     3504    4                   IF USER.CHKPT_NO(BERC.USER#) < 0 THEN
      119     3505    5                   DO; /* Must be an ids assigned chkpt no. */
      120     3506    5                       X = BERC.USER#;
      121     3507    5                       USER.CHKPT_NO(X) = 0 - USER.CHKPT_NO(X);
      122     3508    5                       ERR_INSERT.CNT(2) = 14;
      123     3509    5                       ERR_INSERT.TEXT(2) = '(IDS Implicit)';
      124     3510    5                       END;
      125     3511    4                   ELSE
      126     3512    4                       ERR_INSERT.TEXT(2) = ' ';
      127     3513    4                   ERR_INSERT.CNT(1) = 12;
      128     3514    4                   CALL BINCHAR(ERR_INSERT.TEXT(1),
      129     3515    4                      USER.CHKPT_NO(BERC.USER#));
      130     3516    4                   CALL ZERO_SUP(ERR_INSERT.TEXT(1),30,'1'B);
      131     3517    4                   ERRCODESF.ERR# = DBU#RSYSCHK;
      132     3518    4                   ERRFLGSF = 1;
      133     3519    4                   MSGCODE = ERRCODE_RDEF;
      134     3520    4                   CALL SYS_FUNC_ERRMSG;
      135     3521    4                   CALL DEL_USER_FIDS(BERC.USER#);
      136     3522    4                   USER.CHKPT_NO(BERC.USER#) = 0;
      137     3523    4                   IF CURR_TIME > USER.RLBK_START(CURR_USER#) THEN
      138     3524    5                   DO;
      139     3525    5                       USER.RLBK_START(CURR_USER#) = HIGH_VALUE;
      140     3526    5                       CALL FILL_ROLL_INTRVLS ALTRET(ALTRTN);
      141     3527    5                       END;
      142     3528    4                   END;
      143     3529    3               USER.SYSID(BERC.USER#) = BERC.SYSID;
      144     3530    3               STCNT.BUSER =STCNT.BUSER + 1;
      145     3531
      146     3532    3           CASE(T#FID);
      147     3533    3               CALL PROCESS_FID ALTRET(ALTRTN);
      148     3534    3               STCNT.BFIDS =STCNT.BFIDS + 1;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:5    
      149     3535
      150     3536    3           CASE(T#STO);
      151     3537    3               CALL PROCESS_STO ALTRET(ALTRTN);
      152     3538    3               STCNT.STORES =STCNT.STORES + 1;
      153     3539
      154     3540    3           CASE(T#DEL);
      155     3541    3               CALL PROCESS_DEL ALTRET(ALTRTN);
      156     3542    3               STCNT.DLETES =STCNT.DLETES + 1;
      157     3543
      158     3544    3           CASE(T#MOD);
      159     3545    3               CALL PROCESS_MOD ALTRET(ALTRTN);
      160     3546    3               STCNT.MODRCDS =STCNT.MODRCDS + 1;
      161     3547
      162     3548    3           CASE(T#MSET); /* Modify set pointer */
      163     3549    3               CALL PROCESS_SET ALTRET(ALTRTN);
      164     3550    3               STCNT.MODSETS =STCNT.MODSETS + 1;
      165     3551
      166     3552    3           CASE(T#KSTO);
      167     3553    3               IF ZI$DIR.NOKEYS = %NO# THEN
      168     3554    4               DO; /* If nokeys off then roll the keys */
      169     3555    4                   CALL PROCESS_KSTO ALTRET(ALTRTN);
      170     3556    4                   STCNT.KSTO = STCNT.KSTO + 1;
      171     3557    4                   END;
      172     3558
      173     3559    3           CASE(T#KDEL);
      174     3560    3               IF ZI$DIR.NOKEYS = %NO# THEN
      175     3561    4               DO;
      176     3562    4                   CALL PROCESS_KDEL ALTRET(ALTRTN);
      177     3563    4                   STCNT.KDEL = STCNT.KDEL + 1;
      178     3564    4                   END;
      179     3565
      180     3566    3           CASE(T#IMOD,T#ISTO); /* Indexed store and modify */
      181     3567
      182     3568    3               CALL PROCESS_ISTO ALTRET(ALTRTN);
      183     3569    3               STCNT.STORES = STCNT.STORES + 1;
      184     3570
      185     3571    3           CASE(T#IDEL); /* Indexed delete record */
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:6    
      186     3572
      187     3573    3               CALL PROCESS_IDEL ALTRET(ALTRTN);
      188     3574    3               STCNT.DLETES = STCNT.DLETES + 1;
      189     3575
      190     3576
      191     3577    3           CASE(T#CKA);
      192     3578    3               CALL PROCESS_SUM ALTRET(ALTRTN);
      193     3579    3               STCNT.CHKSUMS =STCNT.CHKSUMS + 1;
      194     3580
      195     3581    3           CASE(T#ROL);
      196     3582    3               USER.RLBK_START(BERC.USER#) = HIGH_VALUE;
      197     3583    3               STCNT.ROLBKS =STCNT.ROLBKS + 1;
      198     3584    3               IF BERC.USER# = ROLL_REC.USER# THEN
      199     3585    3                   CALL FILL_ROLL_INTRVLS ALTRET(ALTRTN);
      200     3586
      201     3587    3           CASE(T#CFID);
      202     3588    3               CALL FIND_USER_FIDID(BERC.USER#,BERC.DCB#,FIDX);
      203     3589    3               IF FIDLIST.ORG#(FIDX) = %CG# THEN
      204     3590    3                   CALL ZIU$CGCLNUP(JRNL$,FIDLIST.DCB#(FIDX)) ALTRET(ALTRTN);
      205     3591    3               CALL ERASE_USER_DCBID(BERC.USER#,BERC.DCB#);
      206     3592    3               STCNT.EFIDS =STCNT.EFIDS + 1;
      207     3593
      208     3594    3           CASE(T#END);
      209     3595         /*E* ERROR: ZIU-DBU#RSYSCMP-C
      210     3596                                   MESSAGE: SYSID# %U1 rolled to completion. */
      211     3597    3               ERR_INSERT.CNT(0) = 6;
      212     3598    3               CALL BINCHAR(ERR_INSERT.TEXT(0),
      213     3599    3                  USER.SYSID(BERC.USER#));
      214     3600    3               CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,'1'B);
      215     3601    3               ERRCODESF.ERR# = DBU#RSYSCMP;
      216     3602    3               ERRFLGSF = 1;
      217     3603    3               MSGCODE = ERRCODE_RDEF;
      218     3604    3               CALL SYS_FUNC_ERRMSG;
      219     3605    3               USER.SYSID(BERC.USER#) = 0;
      220     3606    3               USER.CHKPT_NO(BERC.USER#) = 0;
      221     3607    3               STCNT.EUSER =STCNT.EUSER + 1;
      222     3608    3               CALL DEL_USER_FIDS(BERC.USER#);
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:7    
      223     3609
      224     3610    3           CASE(T#CKPT);
      225     3611    3               IF (JREC.TIME = USER.RLBK_START(CURR_USER#)) THEN
      226     3612    3                   USER.RLBK_START(CURR_USER#) = USER.RLBK_START(CURR_USER#)-1;
      227     3613    3               STCNT.CKPTS = STCNT.CKPTS + 1;
      228     3614    3               USER.CHKPT_NO(CKPT.USER#) = CKPT.CKPTNO;
      229     3615    3               USER.CGMSGID(CKPT.USER#) = CKPT.MSGID;
      230     3616    3           CASE(T#CGMSG);
      231     3617    3               CALL PROCESS_CGMSG ALTRET(ALTRTN);
      232     3618    3               STCNT.CGMSG = STCNT.CGMSG + 1;
      233     3619
      234     3620    3           CASE(T#CGDEL);
      235     3621    3               CALL PROCESS_CGDEL ALTRET(ALTRTN);
      236     3622    3               STCNT.CGDEL = STCNT.CGDEL + 1;
      237     3623
      238     3624    3           CASE(ELSE);
      239     3625         /*  NOT  PROCESSED */
      240     3626    3               END;
      241     3627    2           ELSE
      242     3628    2               UNAP = UNAP +1; /* Cnt of unapplied records */
      243     3629
      244     3630    2           CALL READ_JRNL ALTRET(EOF_JRNL);
      245     3631    2           END;
      246     3632    1       RETURN;
      247     3633
      248     3634    1   EOF_JRNL:
      249     3635    1       IF ERRCODESF.ERR# = %E$EOF THEN
      250     3636    1           RETURN;
      251     3637    1   ALTRTN:
      252     3638    1       ALTRETURN;
      253     3639
      254     3640
      255     3641        %EJECT;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:8    
      256     3642        /*
      257     3643                          READ JOURNAL PROCEDURE
      258     3644        */
      259     3645    1   READ_JRNL: PROC ALTRET;
      260     3646
      261     3647    2       JRNL_BUF = '0'B;
      262     3648
      263     3649    2   /**/ DCBSF = M_JRNL.DCB#;
      264     3650    2   /**/ BUFSF = VECTOR(JRNL_BUF);
      265     3651    2   /**/ BUFLNSF = 4096;
      266     3652    2   /**/ FULLSF = %NO#;
      267     3653    2   /**/ FSA_FLAG = %YES#; /* Use fast seq access routine */
      268     3654    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;
      269     3655    2       CALL SYS_FUNC_READ ALTRET(EOF);
      270     3656    2       JREC_NO = JREC_NO +1;
      271     3657
      272     3658    2       CURR_TIME = JREC.TIME;
      273     3659    2       CURR_USER# = JREC.USER#;
      274     3660    2       RETURN;
      275     3661    2   EOF:
      276     3662    2       ALTRETURN;
      277     3663    2   END READ_JRNL;
      278     3664    1   READ_ROLL: PROC ALTRET;
      279     3665    2   /**/ DCBSF = M_RLBK.DCB#;
      280     3666    2   /**/ BUFSF = VECTOR(ROLL_REC);
      281     3667    2   /**/ BUFLNSF = 10;
      282     3668    2   /**/ FULLSF = %NO#;
      283     3669    2       CALL SYS_FUNC_READ ALTRET(EOF);
      284     3670    2       RETURN;
      285     3671    2   EOF:
      286     3672    2       ALTRETURN;
      287     3673    2   END READ_ROLL;
      288     3674        %EJECT;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:9    
      289     3675        /*      FILL  ROLL  INTERVALS  IN  USER  TABLE   PROCEDURE   */
      290     3676    1   FILL_ROLL_INTRVLS: PROC ALTRET;
      291     3677        /*
      292     3678              This procedure reads the sorted roll back interval file and
      293     3679              places each roll interval in the user table against its user
      294     3680              until the end of file or until two intervals are hit for the
      295     3681              same user. For the later, the roll record causing the collision
      296     3682              is not processed until the journal has been processed up to that
      297     3683              time in the collision roll record, then this routine's again called.
      298     3684        */
      299     3685
      300     3686    3       DO WHILE(USER.RLBK_START(ROLL_REC.USER#) = HIGH_VALUE AND ~END_OF_ROLL);
      301     3687
      302     3688    3           USER.RLBK_START(ROLL_REC.USER#) = ROLL_REC.START;
      303     3689    3           CALL READ_ROLL ALTRET(EOF_ROLL);
      304     3690    3           END;
      305     3691
      306     3692    3       DO NEVER;
      307     3693    3   EOF_ROLL:
      308     3694    3           IF MONITOR_ERR# = %E$EOF THEN
      309     3695    4           DO;
      310     3696    4               END_OF_ROLL = %YES#;
      311     3697    4               ROLL_REC.START = ROLL_CMPLT_TIME;
      312     3698    4               END;
      313     3699    3           ELSE
      314     3700    3               ALTRETURN;
      315     3701    3           END;
      316     3702    2   END FILL_ROLL_INTRVLS;
      317     3703    1   END ZIU$PRJRNL;

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:10   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_ROLL_STATS.:ZIC0TOU  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$PRJRNL.

   Procedure ZIU$PRJRNL requires 525 words for executable code.
   Procedure ZIU$PRJRNL is declared NOAUTO and requires 18 words of local(STATIC) storage.

    No errors detected in file ZIU$PRJRNL.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:11   

 Object Unit name= ZIU$PRJRNL                                 File name= ZIU$PRJRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:20:05.92 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    18     22  ZIU$PRJRNL
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS      5      5  ZIU$PRJRNL
    3   Proc  even  none   525   1015  ZIU$PRJRNL
    4  RoData even  none    22     26  ZIU$PRJRNL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        0  ZIU$PRJRNL

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      6  JREC_NO                            0      7  UNAP
    0     12  ZERO$
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:12   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DEL_USER_FIDS
 yes     yes           Std       0 PROCESS_FID
 yes     yes           Std       0 PROCESS_DEL
 yes     yes           Std       0 PROCESS_MOD
 yes     yes           Std       0 PROCESS_SUM
 yes     yes           Std       0 PROCESS_KSTO
 yes     yes           Std       0 PROCESS_KDEL
 yes     yes           Std       0 PROCESS_IDEL
 yes     yes           Std       0 PROCESS_CGDEL
 yes     yes           Std       3 FIND_USER_FIDID
 yes     yes           Std       2 ERASE_USER_DCBID
         yes           Std       3 ZERO_SUP
 yes     yes           Std       0 PROCESS_SET
 yes     yes           Std       2 ZIU$CGCLNUP
 yes     yes           Std       0 PROCESS_CGMSG
 yes     yes           Std       0 PROCESS_STO
 yes     yes           Std       0 PROCESS_ISTO
 yes     yes           Std       0 SYS_FUNC_ERRMSG
 yes     yes           Std       0 SYS_FUNC_READ
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M_JRNL                                JRNL_BUF                              ROLL_CMPLT_TIME
     M_RLBK                                B$TCB$                                I_O_BUF$
     JRNL$                                 FID$                                  DCBLIST$
     USER$                                 FID_INDXS$                            FID_INDXS
     NXT_AVIL_FIDSLOT                      NXT_AVIL_DCBSLOT                      LAST_UNUSED_DCBSLOT
     USER                                  NO                                    FIRST
     LAST                                  MAX_DCBINDX                           MAX_FIDINDX
     FIDX                                  DCBX                                  BRK_ROLL
     STCNT                                 ZI$DIR                                SCHEMA_ACTIVE
     RECORD_LIST                           SET_LIST                              RETAIN_LIST
     DUMP_FID                              ALTKY                                 INIT_RG
     KEY_RNG                               ITEM_LIST                             M$UC
     BLKLSF                                KEYLSF                                KEYXSF
     DCBSF                                 ORGSF                                 KEYSF
     KEYVSF                                ACSSF                                 NOTIMESF
     FUNSF                                 ASNSF                                 TESTSF
     XTENSIZESF                            DISPSF                                WAITSF
     VFCSF                                 FULLSF                                BKUPSF
     BUFLNSF                               BUFSF                                 SOURCESF
     DESTSF                                DATESF                                TIMESF
     UTSSF                                 DAYSF                                 TSTAMPSF
     ENCRP_SEEDSF                          ERRCODESF                             MSGCODE
     INCL_ERR                              ERR_INSERT                            FIDSF_RD
     ACNT                                  EXISTSF                               SHARESF
     DCBNMSF                               KEYRSF                                NO_KEYSF
     REASGNSF                              CARRY_ATTRIBUTESF                     SUBMESSF
     SPKY_OPNSF                            POSSF                                 ERRFLGSF
     MERGESF                               FSA_FLAG                              RELGSF
     UNUSED                                HELPCODE                              COUNTSF
     INDEXSF                               GAP                                   PSNSF
     ACNTSF                                KEY_SHADWSF
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:14   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:15   


        1        1        /*M* ZIU$PRJRNL  IDSII  DRIVER FOR PROCESSING THE JOURNAL RECS FOR ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$PRJRNL: PROC NOAUTO ALTRET;

      7  3 000000   000000 741200 0     ZIU$PRJRNL   STX1  ! 0

        8        8
        9        9    1   DCL 1 ROLL_REC,
       10       10    1         2 START UBIN WORD,
       11       11    1         2 USER# UBIN BYTE UNAL;
       12       12
       13       13    1   DCL 1 M_JRNL SYMREF ALIGNED,
       14       14    1         2 N,
       15       15    1           3 L UBIN BYTE UNAL,
       16       16    1           3 C CHAR(7) UNAL,
       17       17    1         2 DCB# UBIN HALF UNAL;
       18       18
       19       19    1   DCL CURR_USER# UBIN BYTE STATIC ALIGNED; /* USER# last jrnl rec */
       20       20    1   DCL CURR_TIME UBIN WORD STATIC ALIGNED; /* Current journal time */
       21       21    1   DCL X SBIN WORD STATIC ALIGNED;
       22       22    1   DCL JREC_NO UBIN WORD STATIC SYMDEF INIT(0);
       23       23    1   DCL UNAP UBIN WORD STATIC SYMDEF INIT(0);
       24       24    1   DCL 1 JRNL_BUF SYMREF ALIGNED, /* Journal input buf */
       25       25    1         2 VAL CHAR(4096) UNAL;
       26       26    1   DCL ROLL_CMPLT_TIME UBIN WORD SYMREF ALIGNED;
       27       27    1   DCL END_OF_JRNL BIT(1) STATIC UNAL INIT('0'B);
       28       28    1   DCL END_OF_ROLL BIT(1) STATIC UNAL INIT('0'B);
       29       29
       30       30    1   DCL 1 M_RLBK SYMREF ALIGNED,
       31       31    1         2 N,
       32       32    1           3 L UBIN BYTE UNAL,
       33       33    1           3 C CHAR(7) UNAL,
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:16   
       34       34    1         2 DCB# UBIN HALF UNAL;
       35       35
       36       36    1   DCL B$TCB$ PTR SYMREF;
       37       37
       38       38    1   DCL I_O_BUF$ PTR SYMREF;
       39       39    1   DCL I_O_BUF(0:0) BASED(I_O_BUF$) CHAR(4096) ALIGNED;
       40       40    1   DCL ZEROS (0:1023) UBIN WORD BASED(ZERO$);
       41       41    1   DCL ZERO$ PTR STATIC SYMDEF;
       42       42
       43       43
       44       44         %INCLUDE ZI$JRNL;
       45      152         %JRNL_REC;
       46      227         %INCLUDE ZI_DBU_ROLL;
       47      311         %ROLL_SUBS;
       48      330         %ROLL_LIST;
       49      389         %INCLUDE ZI_ROLL_STATS;
       50      510         %CNTERS(STCLASS=SYMREF);
       51      531         %INCLUDE ZI$DIR;
       52      688         %DIR;
       53      832         %INCLUDE CP_6;
       54      913         %F$DCB;
       55      970         %B$TCB;
       56      973         %B$EXCFR;
       57      991         %INCLUDE ZI_GLOBAL_DBUTIL;
       58     1169         %SYS_FUNC;
       59     1261         %INCLUDE B_ERRORS_C;
       60     2388         %INCLUDE ZI_ERRORS_SUBS;
       61     2908         %INCLUDE CP_6_SUBS;
       62     3448
       63     3449    1   DCL SYS_FUNC_READ ENTRY ALTRET;
       64     3450    1   DCL DEL_USER_FIDS ENTRY(1) ALTRET;
       65     3451    1   DCL ERASE_USER_DCBID ENTRY(2) ALTRET;
       66     3452    1   DCL PROCESS_FID ENTRY ALTRET;
       67     3453    1   DCL PROCESS_STO ENTRY ALTRET;
       68     3454    1   DCL PROCESS_DEL ENTRY ALTRET;
       69     3455    1   DCL PROCESS_MOD ENTRY ALTRET;
       70     3456    1   DCL PROCESS_SUM ENTRY ALTRET;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:17   
       71     3457    1   DCL PROCESS_SET ENTRY ALTRET;
       72     3458    1   DCL PROCESS_KSTO ENTRY ALTRET;
       73     3459    1   DCL PROCESS_KDEL ENTRY ALTRET;
       74     3460    1   DCL PROCESS_ISTO ENTRY ALTRET;
       75     3461    1   DCL PROCESS_IDEL ENTRY ALTRET;
       76     3462    1   DCL ZERO_SUP ENTRY(3);
       77     3463    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       78     3464    1   DCL ZIU$CGCLNUP ENTRY(2) ALTRET;
       79     3465    1   DCL PROCESS_CGMSG ENTRY ALTRET;
       80     3466    1   DCL PROCESS_CGDEL ENTRY ALTRET;
       81     3467    1   DCL FIND_USER_FIDID ENTRY(3) ALTRET;
       82     3468
       83     3469
       84     3470        /*
       85     3471                 APPLY THE JOURNAL RECORDS--IGNORING ROLLBACK INTERVALS
       86     3472        */
       87     3473    1   BGIN:
       88     3474    1       ROLL_REC.USER# = 0;

   3474  3 000001   000002 450000 0     BGIN         STZ     ROLL_REC+1

       89     3475    1       ROLL_REC.START = HIGH_VALUE;

   3475  3 000002   000000 235000 2                  LDA     0
         3 000003   000001 755000 0                  STA     ROLL_REC

       90     3476    1       CURR_TIME = 0;

   3476  3 000004   000004 450000 0                  STZ     CURR_TIME

       91     3477    2       DO X = 0 TO NO.USERS;

   3477  3 000005   000005 450000 0                  STZ     X
         3 000006   000016 710000 3                  TRA     s:3480+1

       92     3478    2           USER.SYSID(X) = 0;

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:18   
   3478  3 000007   000005 236000 0                  LDQ     X
         3 000010   000005 402007                    MPY     5,DL
         3 000011   000000 220003                    LDX0    0,DU
         3 000012   000000 740006 xsym               STX0    USER,QL

       93     3479    2           USER.RLBK_START(X) = HIGH_VALUE;

   3479  3 000013   000000 235000 2                  LDA     0
         3 000014   000001 755006 xsym               STA     USER+1,QL

       94     3480    2           END;

   3480  3 000015   000005 054000 0                  AOS     X
         3 000016   000005 236000 0                  LDQ     X
         3 000017   000000 116000 xsym               CMPQ    NO
         3 000020   000007 604400 3                  TMOZ    s:3478

       95     3481    1       ZERO$ = ADDR(I_O_BUF(29));

   3481  3 000021   000000 236000 xsym               LDQ     I_O_BUF$
         3 000022   072000 036003                    ADLQ    29696,DU
         3 000023   000012 756000 0                  STQ     ZERO$

       96     3482    2       DO X = 0 TO 1023;

   3482  3 000024   000005 450000 0                  STZ     X

       97     3483    2           ZEROS(X) = 0;

   3483  3 000025   000012 470400 0                  LDP0    ZERO$
         3 000026   000005 720000 0                  LXL0    X
         3 000027   000000 450110                    STZ     0,X0,PR0

       98     3484    2           END;

   3484  3 000030   000005 054000 0                  AOS     X
         3 000031   000005 235000 0                  LDA     X
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:19   
         3 000032   001777 115007                    CMPA    1023,DL
         3 000033   000025 604400 3                  TMOZ    s:3483

       99     3485
      100     3486    1       CALL FILL_ROLL_INTRVLS ALTRET(ALTRTN);

   3486  3 000034   000752 701000 3                  TSX1    FILL_ROLL_INTRVLS
         3 000035   000665 702000 3                  TSX2    ALTRTN

      101     3487    1       CALL READ_JRNL ALTRET(EOF_JRNL);

   3487  3 000036   000667 701000 3                  TSX1    READ_JRNL
         3 000037   000657 702000 3                  TSX2    EOF_JRNL

      102     3488
      103     3489    2       DO WHILE(CURR_TIME < ROLL_CMPLT_TIME);

   3489  3 000040   000004 236000 0                  LDQ     CURR_TIME
         3 000041   000000 116000 xsym               CMPQ    ROLL_CMPLT_TIME
         3 000042   000655 603000 3                  TRC     s:3632

      104     3490
      105     3491
      106     3492    2           IF JREC.TYPE = T#FID OR JREC.TYPE = T#ROL OR JREC.TYPE= T#BGN OR

   3492  3 000043   000000 470400 xsym               LDP0    JRNL$
         3 000044   000001 236100                    LDQ     1,,PR0
         3 000045   777000 376003                    ANQ     -512,DU
         3 000046   003000 116003                    CMPQ    1536,DU
         3 000047   000062 600000 3                  TZE     s:3495
         3 000050   013000 116003                    CMPQ    5632,DU
         3 000051   000062 600000 3                  TZE     s:3495
         3 000052   001000 116003                    CMPQ    512,DU
         3 000053   000062 600000 3                  TZE     s:3495
         3 000054   000003 236000 0                  LDQ     CURR_USER#
         3 000055   000033 772000                    QRL     27
         3 000056   000005 402007                    MPY     5,DL
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:20   
         3 000057   000001 236006 xsym               LDQ     USER+1,QL
         3 000060   000000 116100                    CMPQ    0,,PR0
         3 000061   000645 602000 3                  TNC     s:3628

      107     3493    2              JREC.TIME <= USER.RLBK_START(CURR_USER#) THEN
      108     3494
      109     3495    3           DO CASE(JREC.TYPE);

   3495  3 000062   000001 236100                    LDQ     1,,PR0
         3 000063   000033 772000                    QRL     27
         3 000064   000025 116007                    CMPQ    21,DL
         3 000065   000067 602006 3                  TNC     s:3495+5,QL
         3 000066   000650 710000 3                  TRA     s:3630
         3 000067   000644 710000 3                  TRA     s:3626
         3 000070   000114 710000 3                  TRA     s:3498
         3 000071   000504 710000 3                  TRA     s:3597
         3 000072   000271 710000 3                  TRA     s:3533
         3 000073   000431 710000 3                  TRA     s:3588
         3 000074   000325 710000 3                  TRA     s:3549
         3 000075   000300 710000 3                  TRA     s:3537
         3 000076   000307 710000 3                  TRA     s:3541
         3 000077   000316 710000 3                  TRA     s:3545
         3 000100   000644 710000 3                  TRA     s:3626
         3 000101   000376 710000 3                  TRA     s:3578
         3 000102   000405 710000 3                  TRA     s:3582
         3 000103   000567 710000 3                  TRA     s:3611
         3 000104   000644 710000 3                  TRA     s:3626
         3 000105   000334 710000 3                  TRA     s:3553
         3 000106   000346 710000 3                  TRA     s:3560
         3 000107   000360 710000 3                  TRA     s:3568
         3 000110   000367 710000 3                  TRA     s:3573
         3 000111   000360 710000 3                  TRA     s:3568
         3 000112   000626 710000 3                  TRA     s:3617
         3 000113   000635 710000 3                  TRA     s:3621

      110     3496
      111     3497    3           CASE(T#BGN);
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:21   

      112     3498    3               IF USER.SYSID(BERC.USER#) ~= 0 THEN

   3498  3 000114   000001 236100                    LDQ     1,,PR0
         3 000115   000022 772000                    QRL     18
         3 000116   000777 376007                    ANQ     511,DL
         3 000117   000005 402007                    MPY     5,DL
         3 000120   000000 220006 xsym               LDX0    USER,QL
         3 000121   000256 600000 3                  TZE     s:3529

      113     3499    4               DO; /* New user w/out and end record for last one */

      114     3500    4                   ERR_INSERT.CNT(0) = 6;

   3500  3 000122   006000 236003                    LDQ     3072,DU
         3 000123   000000 552040 xsym               STBQ    ERR_INSERT,'40'O

      115     3501    4                   CALL BINCHAR(ERR_INSERT.TEXT(0),

   3501  3 000124   000001 236100                    LDQ     1,,PR0
         3 000125   000022 772000                    QRL     18
         3 000126   000777 376007                    ANQ     511,DL
         3 000127   000005 402007                    MPY     5,DL
         3 000130   000000 236006 xsym               LDQ     USER,QL
         3 000131   000022 772000                    QRL     18
         3 000132   000000 235003                    LDA     0,DU
         3 000133   000016 757000 0                  STAQ    ZERO$+4
         3 000134   000000 301400                    BTD
         3 000135   000016 000010 0                  NDSC9   ZERO$+4                  cn=0,s=lsgnf,sf=0,n=8
         3 000136   000000 230036 xsym               NDSC9   ERR_INSERT               cn=1,s=nosgn,sf=0,n=30

      116     3502    4                      USER.SYSID(BERC.USER#));
      117     3503    4                   CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,'1'B);

   3503  3 000137   000003 630400 4                  EPPR0   3
         3 000140   000000 631400 4                  EPPR1   0
         3 000141   000000 701000 xent               TSX1    ZERO_SUP
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:22   
         3 000142   000000 011000                    NOP     0

      118     3504    4                   IF USER.CHKPT_NO(BERC.USER#) < 0 THEN

   3504  3 000143   000000 470400 xsym               LDP0    JRNL$
         3 000144   000001 236100                    LDQ     1,,PR0
         3 000145   000022 772000                    QRL     18
         3 000146   000777 376007                    ANQ     511,DL
         3 000147   000005 402007                    MPY     5,DL
         3 000150   000002 235006 xsym               LDA     USER+2,QL
         3 000151   000170 605000 3                  TPL     s:3512

      119     3505    5                   DO; /* Must be an ids assigned chkpt no. */

      120     3506    5                       X = BERC.USER#;

   3506  3 000152   000001 236100                    LDQ     1,,PR0
         3 000153   000022 772000                    QRL     18
         3 000154   000777 376007                    ANQ     511,DL
         3 000155   000005 756000 0                  STQ     X

      121     3507    5                       USER.CHKPT_NO(X) = 0 - USER.CHKPT_NO(X);

   3507  3 000156   000005 402007                    MPY     5,DL
         3 000157   000002 235006 xsym               LDA     USER+2,QL
         3 000160   000000 531000                    NEG     0
         3 000161   000002 755006 xsym               STA     USER+2,QL

      122     3508    5                       ERR_INSERT.CNT(2) = 14;

   3508  3 000162   016000 236003                    LDQ     7168,DU
         3 000163   000020 552040 xsym               STBQ    ERR_INSERT+16,'40'O

      123     3509    5                       ERR_INSERT.TEXT(2) = '(IDS Implicit)';

   3509  3 000164   040000 100400                    MLR     fill='040'O
         3 000165   000001 000016 2                  ADSC9   1                        cn=0,n=14
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:23   
         3 000166   000020 200036 xsym               ADSC9   ERR_INSERT+16            cn=1,n=30

      124     3510    5                       END;

   3510  3 000167   000173 710000 3                  TRA     s:3513

      125     3511    4                   ELSE
      126     3512    4                       ERR_INSERT.TEXT(2) = ' ';

   3512  3 000170   040000 100400                    MLR     fill='040'O
         3 000171   000006 000001 4                  ADSC9   6                        cn=0,n=1
         3 000172   000020 200036 xsym               ADSC9   ERR_INSERT+16            cn=1,n=30

      127     3513    4                   ERR_INSERT.CNT(1) = 12;

   3513  3 000173   014000 236003                    LDQ     6144,DU
         3 000174   000010 552040 xsym               STBQ    ERR_INSERT+8,'40'O

      128     3514    4                   CALL BINCHAR(ERR_INSERT.TEXT(1),

   3514  3 000175   000001 236100                    LDQ     1,,PR0
         3 000176   000022 772000                    QRL     18
         3 000177   000777 376007                    ANQ     511,DL
         3 000200   000005 402007                    MPY     5,DL
         3 000201   000002 736000                    QLS     2
         3 000202   000000 301406                    BTD
         3 000203   000002 000004 xsym               NDSC9   USER+2,Q                 cn=0,s=lsgnf,sf=0,n=4
         3 000204   000010 230036 xsym               NDSC9   ERR_INSERT+8             cn=1,s=nosgn,sf=0,n=30

      129     3515    4                      USER.CHKPT_NO(BERC.USER#));
      130     3516    4                   CALL ZERO_SUP(ERR_INSERT.TEXT(1),30,'1'B);

   3516  3 000205   000007 630400 4                  EPPR0   7
         3 000206   000000 631400 4                  EPPR1   0
         3 000207   000000 701000 xent               TSX1    ZERO_SUP
         3 000210   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:24   
      131     3517    4                   ERRCODESF.ERR# = DBU#RSYSCHK;

   3517  3 000211   000000 236000 xsym               LDQ     ERRCODESF
         3 000212   000012 376000 4                  ANQ     10
         3 000213   214750 276007                    ORQ     72168,DL
         3 000214   000000 756000 xsym               STQ     ERRCODESF

      132     3518    4                   ERRFLGSF = 1;

   3518  3 000215   001000 236003                    LDQ     512,DU
         3 000216   000000 756000 xsym               STQ     ERRFLGSF

      133     3519    4                   MSGCODE = ERRCODE_RDEF;

   3519  3 000217   000000 235000 xsym               LDA     ERRCODESF
         3 000220   000000 755000 xsym               STA     MSGCODE

      134     3520    4                   CALL SYS_FUNC_ERRMSG;

   3520  3 000221   000013 631400 4                  EPPR1   11
         3 000222   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         3 000223   000000 011000                    NOP     0

      135     3521    4                   CALL DEL_USER_FIDS(BERC.USER#);

   3521  3 000224   000000 236000 xsym               LDQ     JRNL$
         3 000225   000015 036000 4                  ADLQ    13
         3 000226   000016 756000 0                  STQ     ZERO$+4
         3 000227   000016 630400 0                  EPPR0   ZERO$+4
         3 000230   000014 631400 4                  EPPR1   12
         3 000231   000000 701000 xent               TSX1    DEL_USER_FIDS
         3 000232   000000 011000                    NOP     0

      136     3522    4                   USER.CHKPT_NO(BERC.USER#) = 0;

   3522  3 000233   000000 470400 xsym               LDP0    JRNL$
         3 000234   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:25   
         3 000235   000022 772000                    QRL     18
         3 000236   000777 376007                    ANQ     511,DL
         3 000237   000005 402007                    MPY     5,DL
         3 000240   000002 450006 xsym               STZ     USER+2,QL

      137     3523    4                   IF CURR_TIME > USER.RLBK_START(CURR_USER#) THEN

   3523  3 000241   000003 236000 0                  LDQ     CURR_USER#
         3 000242   000033 772000                    QRL     27
         3 000243   000005 402007                    MPY     5,DL
         3 000244   000001 236006 xsym               LDQ     USER+1,QL
         3 000245   000004 116000 0                  CMPQ    CURR_TIME
         3 000246   000256 603000 3                  TRC     s:3529

      138     3524    5                   DO;

      139     3525    5                       USER.RLBK_START(CURR_USER#) = HIGH_VALUE;

   3525  3 000247   000003 236000 0                  LDQ     CURR_USER#
         3 000250   000033 772000                    QRL     27
         3 000251   000005 402007                    MPY     5,DL
         3 000252   000000 235000 2                  LDA     0
         3 000253   000001 755006 xsym               STA     USER+1,QL

      140     3526    5                       CALL FILL_ROLL_INTRVLS ALTRET(ALTRTN);

   3526  3 000254   000752 701000 3                  TSX1    FILL_ROLL_INTRVLS
         3 000255   000665 702000 3                  TSX2    ALTRTN

      141     3527    5                       END;

      142     3528    4                   END;

      143     3529    3               USER.SYSID(BERC.USER#) = BERC.SYSID;

   3529  3 000256   000000 470400 xsym               LDP0    JRNL$
         3 000257   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:26   
         3 000260   000022 772000                    QRL     18
         3 000261   000777 376007                    ANQ     511,DL
         3 000262   000005 402007                    MPY     5,DL
         3 000263   000001 720100                    LXL0    1,,PR0
         3 000264   000000 740006 xsym               STX0    USER,QL

      144     3530    3               STCNT.BUSER =STCNT.BUSER + 1;

   3530  3 000265   000000 235000 xsym               LDA     STCNT
         3 000266   000001 035007                    ADLA    1,DL
         3 000267   000000 755000 xsym               STA     STCNT
         3 000270   000650 710000 3                  TRA     s:3630

      145     3531
      146     3532    3           CASE(T#FID);

      147     3533    3               CALL PROCESS_FID ALTRET(ALTRTN);

   3533  3 000271   000013 631400 4                  EPPR1   11
         3 000272   000000 701000 xent               TSX1    PROCESS_FID
         3 000273   000665 702000 3                  TSX2    ALTRTN

      148     3534    3               STCNT.BFIDS =STCNT.BFIDS + 1;

   3534  3 000274   000002 235000 xsym               LDA     STCNT+2
         3 000275   000001 035007                    ADLA    1,DL
         3 000276   000002 755000 xsym               STA     STCNT+2
         3 000277   000650 710000 3                  TRA     s:3630

      149     3535
      150     3536    3           CASE(T#STO);

      151     3537    3               CALL PROCESS_STO ALTRET(ALTRTN);

   3537  3 000300   000013 631400 4                  EPPR1   11
         3 000301   000000 701000 xent               TSX1    PROCESS_STO
         3 000302   000665 702000 3                  TSX2    ALTRTN
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:27   

      152     3538    3               STCNT.STORES =STCNT.STORES + 1;

   3538  3 000303   000004 235000 xsym               LDA     STCNT+4
         3 000304   000001 035007                    ADLA    1,DL
         3 000305   000004 755000 xsym               STA     STCNT+4
         3 000306   000650 710000 3                  TRA     s:3630

      153     3539
      154     3540    3           CASE(T#DEL);

      155     3541    3               CALL PROCESS_DEL ALTRET(ALTRTN);

   3541  3 000307   000013 631400 4                  EPPR1   11
         3 000310   000000 701000 xent               TSX1    PROCESS_DEL
         3 000311   000665 702000 3                  TSX2    ALTRTN

      156     3542    3               STCNT.DLETES =STCNT.DLETES + 1;

   3542  3 000312   000005 235000 xsym               LDA     STCNT+5
         3 000313   000001 035007                    ADLA    1,DL
         3 000314   000005 755000 xsym               STA     STCNT+5
         3 000315   000650 710000 3                  TRA     s:3630

      157     3543
      158     3544    3           CASE(T#MOD);

      159     3545    3               CALL PROCESS_MOD ALTRET(ALTRTN);

   3545  3 000316   000013 631400 4                  EPPR1   11
         3 000317   000000 701000 xent               TSX1    PROCESS_MOD
         3 000320   000665 702000 3                  TSX2    ALTRTN

      160     3546    3               STCNT.MODRCDS =STCNT.MODRCDS + 1;

   3546  3 000321   000006 235000 xsym               LDA     STCNT+6
         3 000322   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:28   
         3 000323   000006 755000 xsym               STA     STCNT+6
         3 000324   000650 710000 3                  TRA     s:3630

      161     3547
      162     3548    3           CASE(T#MSET); /* Modify set pointer */

      163     3549    3               CALL PROCESS_SET ALTRET(ALTRTN);

   3549  3 000325   000013 631400 4                  EPPR1   11
         3 000326   000000 701000 xent               TSX1    PROCESS_SET
         3 000327   000665 702000 3                  TSX2    ALTRTN

      164     3550    3               STCNT.MODSETS =STCNT.MODSETS + 1;

   3550  3 000330   000007 235000 xsym               LDA     STCNT+7
         3 000331   000001 035007                    ADLA    1,DL
         3 000332   000007 755000 xsym               STA     STCNT+7
         3 000333   000650 710000 3                  TRA     s:3630

      165     3551
      166     3552    3           CASE(T#KSTO);

      167     3553    3               IF ZI$DIR.NOKEYS = %NO# THEN

   3553  3 000334   000125 236000 xsym               LDQ     ZI$DIR+85
         3 000335   020000 316003                    CANQ    8192,DU
         3 000336   000650 601000 3                  TNZ     s:3630

      168     3554    4               DO; /* If nokeys off then roll the keys */

      169     3555    4                   CALL PROCESS_KSTO ALTRET(ALTRTN);

   3555  3 000337   000013 631400 4                  EPPR1   11
         3 000340   000000 701000 xent               TSX1    PROCESS_KSTO
         3 000341   000665 702000 3                  TSX2    ALTRTN

      170     3556    4                   STCNT.KSTO = STCNT.KSTO + 1;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:29   

   3556  3 000342   000010 235000 xsym               LDA     STCNT+8
         3 000343   000001 035007                    ADLA    1,DL
         3 000344   000010 755000 xsym               STA     STCNT+8

      171     3557    4                   END;

   3557  3 000345   000650 710000 3                  TRA     s:3630

      172     3558
      173     3559    3           CASE(T#KDEL);

      174     3560    3               IF ZI$DIR.NOKEYS = %NO# THEN

   3560  3 000346   000125 236000 xsym               LDQ     ZI$DIR+85
         3 000347   020000 316003                    CANQ    8192,DU
         3 000350   000650 601000 3                  TNZ     s:3630

      175     3561    4               DO;

      176     3562    4                   CALL PROCESS_KDEL ALTRET(ALTRTN);

   3562  3 000351   000013 631400 4                  EPPR1   11
         3 000352   000000 701000 xent               TSX1    PROCESS_KDEL
         3 000353   000665 702000 3                  TSX2    ALTRTN

      177     3563    4                   STCNT.KDEL = STCNT.KDEL + 1;

   3563  3 000354   000011 235000 xsym               LDA     STCNT+9
         3 000355   000001 035007                    ADLA    1,DL
         3 000356   000011 755000 xsym               STA     STCNT+9

      178     3564    4                   END;

   3564  3 000357   000650 710000 3                  TRA     s:3630

      179     3565
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:30   
      180     3566    3           CASE(T#IMOD,T#ISTO); /* Indexed store and modify */

      181     3567
      182     3568    3               CALL PROCESS_ISTO ALTRET(ALTRTN);

   3568  3 000360   000013 631400 4                  EPPR1   11
         3 000361   000000 701000 xent               TSX1    PROCESS_ISTO
         3 000362   000665 702000 3                  TSX2    ALTRTN

      183     3569    3               STCNT.STORES = STCNT.STORES + 1;

   3569  3 000363   000004 235000 xsym               LDA     STCNT+4
         3 000364   000001 035007                    ADLA    1,DL
         3 000365   000004 755000 xsym               STA     STCNT+4
         3 000366   000650 710000 3                  TRA     s:3630

      184     3570
      185     3571    3           CASE(T#IDEL); /* Indexed delete record */

      186     3572
      187     3573    3               CALL PROCESS_IDEL ALTRET(ALTRTN);

   3573  3 000367   000013 631400 4                  EPPR1   11
         3 000370   000000 701000 xent               TSX1    PROCESS_IDEL
         3 000371   000665 702000 3                  TSX2    ALTRTN

      188     3574    3               STCNT.DLETES = STCNT.DLETES + 1;

   3574  3 000372   000005 235000 xsym               LDA     STCNT+5
         3 000373   000001 035007                    ADLA    1,DL
         3 000374   000005 755000 xsym               STA     STCNT+5
         3 000375   000650 710000 3                  TRA     s:3630

      189     3575
      190     3576
      191     3577    3           CASE(T#CKA);

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:31   
      192     3578    3               CALL PROCESS_SUM ALTRET(ALTRTN);

   3578  3 000376   000013 631400 4                  EPPR1   11
         3 000377   000000 701000 xent               TSX1    PROCESS_SUM
         3 000400   000665 702000 3                  TSX2    ALTRTN

      193     3579    3               STCNT.CHKSUMS =STCNT.CHKSUMS + 1;

   3579  3 000401   000012 235000 xsym               LDA     STCNT+10
         3 000402   000001 035007                    ADLA    1,DL
         3 000403   000012 755000 xsym               STA     STCNT+10
         3 000404   000650 710000 3                  TRA     s:3630

      194     3580
      195     3581    3           CASE(T#ROL);

      196     3582    3               USER.RLBK_START(BERC.USER#) = HIGH_VALUE;

   3582  3 000405   000001 236100                    LDQ     1,,PR0
         3 000406   000022 772000                    QRL     18
         3 000407   000777 376007                    ANQ     511,DL
         3 000410   000005 402007                    MPY     5,DL
         3 000411   000000 235000 2                  LDA     0
         3 000412   000001 755006 xsym               STA     USER+1,QL

      197     3583    3               STCNT.ROLBKS =STCNT.ROLBKS + 1;

   3583  3 000413   000013 236000 xsym               LDQ     STCNT+11
         3 000414   000001 036007                    ADLQ    1,DL
         3 000415   000013 756000 xsym               STQ     STCNT+11

      198     3584    3               IF BERC.USER# = ROLL_REC.USER# THEN

   3584  3 000416   000002 236000 0                  LDQ     ROLL_REC+1
         3 000417   000033 772000                    QRL     27
         3 000420   000016 756000 0                  STQ     ZERO$+4
         3 000421   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:32   
         3 000422   000022 772000                    QRL     18
         3 000423   000777 376007                    ANQ     511,DL
         3 000424   000016 116000 0                  CMPQ    ZERO$+4
         3 000425   000650 601000 3                  TNZ     s:3630

      199     3585    3                   CALL FILL_ROLL_INTRVLS ALTRET(ALTRTN);

   3585  3 000426   000752 701000 3                  TSX1    FILL_ROLL_INTRVLS
         3 000427   000665 702000 3                  TSX2    ALTRTN
         3 000430   000650 710000 3                  TRA     s:3630

      200     3586
      201     3587    3           CASE(T#CFID);

      202     3588    3               CALL FIND_USER_FIDID(BERC.USER#,BERC.DCB#,FIDX);

   3588  3 000431   000016 236000 4                  LDQ     14
         3 000432   000020 756000 0                  STQ     ZERO$+6
         3 000433   000000 236000 xsym               LDQ     JRNL$
         3 000434   000017 036000 4                  ADLQ    15
         3 000435   000017 756000 0                  STQ     ZERO$+5
         3 000436   000000 236000 xsym               LDQ     JRNL$
         3 000437   000015 036000 4                  ADLQ    13
         3 000440   000016 756000 0                  STQ     ZERO$+4
         3 000441   000016 630400 0                  EPPR0   ZERO$+4
         3 000442   000000 631400 4                  EPPR1   0
         3 000443   000000 701000 xent               TSX1    FIND_USER_FIDID
         3 000444   000000 011000                    NOP     0

      203     3589    3               IF FIDLIST.ORG#(FIDX) = %CG# THEN

   3589  3 000445   000000 236000 xsym               LDQ     FIDX
         3 000446   000021 402007                    MPY     17,DL
         3 000447   000000 470400 xsym               LDP0    FID$
         3 000450   000015 236106                    LDQ     13,QL,PR0
         3 000451   777000 376007                    ANQ     -512,DL
         3 000452   013000 116007                    CMPQ    5632,DL
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:33   
         3 000453   000466 601000 3                  TNZ     s:3591

      204     3590    3                   CALL ZIU$CGCLNUP(JRNL$,FIDLIST.DCB#(FIDX)) ALTRET(ALTRTN);

   3590  3 000454   000000 236000 xsym               LDQ     FIDX
         3 000455   000021 402003                    MPY     17,DU
         3 000456   000017 036003                    ADLQ    15,DU
         3 000457   000000 036000 xsym               ADLQ    FID$
         3 000460   000021 235000 4                  LDA     17
         3 000461   000016 757000 0                  STAQ    ZERO$+4
         3 000462   000016 630400 0                  EPPR0   ZERO$+4
         3 000463   000020 631400 4                  EPPR1   16
         3 000464   000000 701000 xent               TSX1    ZIU$CGCLNUP
         3 000465   000665 702000 3                  TSX2    ALTRTN

      205     3591    3               CALL ERASE_USER_DCBID(BERC.USER#,BERC.DCB#);

   3591  3 000466   000000 236000 xsym               LDQ     JRNL$
         3 000467   000017 036000 4                  ADLQ    15
         3 000470   000017 756000 0                  STQ     ZERO$+5
         3 000471   000000 236000 xsym               LDQ     JRNL$
         3 000472   000015 036000 4                  ADLQ    13
         3 000473   000016 756000 0                  STQ     ZERO$+4
         3 000474   000016 630400 0                  EPPR0   ZERO$+4
         3 000475   000020 631400 4                  EPPR1   16
         3 000476   000000 701000 xent               TSX1    ERASE_USER_DCBID
         3 000477   000000 011000                    NOP     0

      206     3592    3               STCNT.EFIDS =STCNT.EFIDS + 1;

   3592  3 000500   000003 235000 xsym               LDA     STCNT+3
         3 000501   000001 035007                    ADLA    1,DL
         3 000502   000003 755000 xsym               STA     STCNT+3
         3 000503   000650 710000 3                  TRA     s:3630

      207     3593
      208     3594    3           CASE(T#END);
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:34   

      209     3595         /*E* ERROR: ZIU-DBU#RSYSCMP-C
      210     3596                                   MESSAGE: SYSID# %U1 rolled to completion. */
      211     3597    3               ERR_INSERT.CNT(0) = 6;

   3597  3 000504   006000 236003                    LDQ     3072,DU
         3 000505   000000 552040 xsym               STBQ    ERR_INSERT,'40'O

      212     3598    3               CALL BINCHAR(ERR_INSERT.TEXT(0),

   3598  3 000506   000001 236100                    LDQ     1,,PR0
         3 000507   000022 772000                    QRL     18
         3 000510   000777 376007                    ANQ     511,DL
         3 000511   000005 402007                    MPY     5,DL
         3 000512   000000 236006 xsym               LDQ     USER,QL
         3 000513   000022 772000                    QRL     18
         3 000514   000000 235003                    LDA     0,DU
         3 000515   000016 757000 0                  STAQ    ZERO$+4
         3 000516   000000 301400                    BTD
         3 000517   000016 000010 0                  NDSC9   ZERO$+4                  cn=0,s=lsgnf,sf=0,n=8
         3 000520   000000 230036 xsym               NDSC9   ERR_INSERT               cn=1,s=nosgn,sf=0,n=30

      213     3599    3                  USER.SYSID(BERC.USER#));
      214     3600    3               CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,'1'B);

   3600  3 000521   000003 630400 4                  EPPR0   3
         3 000522   000000 631400 4                  EPPR1   0
         3 000523   000000 701000 xent               TSX1    ZERO_SUP
         3 000524   000000 011000                    NOP     0

      215     3601    3               ERRCODESF.ERR# = DBU#RSYSCMP;

   3601  3 000525   000000 236000 xsym               LDQ     ERRCODESF
         3 000526   000012 376000 4                  ANQ     10
         3 000527   214740 276007                    ORQ     72160,DL
         3 000530   000000 756000 xsym               STQ     ERRCODESF

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:35   
      216     3602    3               ERRFLGSF = 1;

   3602  3 000531   001000 236003                    LDQ     512,DU
         3 000532   000000 756000 xsym               STQ     ERRFLGSF

      217     3603    3               MSGCODE = ERRCODE_RDEF;

   3603  3 000533   000000 235000 xsym               LDA     ERRCODESF
         3 000534   000000 755000 xsym               STA     MSGCODE

      218     3604    3               CALL SYS_FUNC_ERRMSG;

   3604  3 000535   000013 631400 4                  EPPR1   11
         3 000536   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         3 000537   000000 011000                    NOP     0

      219     3605    3               USER.SYSID(BERC.USER#) = 0;

   3605  3 000540   000000 470400 xsym               LDP0    JRNL$
         3 000541   000001 236100                    LDQ     1,,PR0
         3 000542   000022 772000                    QRL     18
         3 000543   000777 376007                    ANQ     511,DL
         3 000544   000005 402007                    MPY     5,DL
         3 000545   000000 220003                    LDX0    0,DU
         3 000546   000000 740006 xsym               STX0    USER,QL

      220     3606    3               USER.CHKPT_NO(BERC.USER#) = 0;

   3606  3 000547   000001 236100                    LDQ     1,,PR0
         3 000550   000022 772000                    QRL     18
         3 000551   000777 376007                    ANQ     511,DL
         3 000552   000005 402007                    MPY     5,DL
         3 000553   000002 450006 xsym               STZ     USER+2,QL

      221     3607    3               STCNT.EUSER =STCNT.EUSER + 1;

   3607  3 000554   000001 235000 xsym               LDA     STCNT+1
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:36   
         3 000555   000001 035007                    ADLA    1,DL
         3 000556   000001 755000 xsym               STA     STCNT+1

      222     3608    3               CALL DEL_USER_FIDS(BERC.USER#);

   3608  3 000557   000000 236000 xsym               LDQ     JRNL$
         3 000560   000015 036000 4                  ADLQ    13
         3 000561   000016 756000 0                  STQ     ZERO$+4
         3 000562   000016 630400 0                  EPPR0   ZERO$+4
         3 000563   000014 631400 4                  EPPR1   12
         3 000564   000000 701000 xent               TSX1    DEL_USER_FIDS
         3 000565   000000 011000                    NOP     0
         3 000566   000650 710000 3                  TRA     s:3630

      223     3609
      224     3610    3           CASE(T#CKPT);

      225     3611    3               IF (JREC.TIME = USER.RLBK_START(CURR_USER#)) THEN

   3611  3 000567   000003 236000 0                  LDQ     CURR_USER#
         3 000570   000033 772000                    QRL     27
         3 000571   000005 402007                    MPY     5,DL
         3 000572   000000 620006                    EAX0    0,QL
         3 000573   000000 236100                    LDQ     0,,PR0
         3 000574   000001 116010 xsym               CMPQ    USER+1,X0
         3 000575   000601 601000 3                  TNZ     s:3613

      226     3612    3                   USER.RLBK_START(CURR_USER#) = USER.RLBK_START(CURR_USER#)-1;

   3612  3 000576   000001 235010 xsym               LDA     USER+1,X0
         3 000577   000001 135007                    SBLA    1,DL
         3 000600   000001 755010 xsym               STA     USER+1,X0

      227     3613    3               STCNT.CKPTS = STCNT.CKPTS + 1;

   3613  3 000601   000014 235000 xsym               LDA     STCNT+12
         3 000602   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:37   
         3 000603   000014 755000 xsym               STA     STCNT+12

      228     3614    3               USER.CHKPT_NO(CKPT.USER#) = CKPT.CKPTNO;

   3614  3 000604   000001 236100                    LDQ     1,,PR0
         3 000605   000022 772000                    QRL     18
         3 000606   000777 376007                    ANQ     511,DL
         3 000607   000005 402007                    MPY     5,DL
         3 000610   000001 235100                    LDA     1,,PR0
         3 000611   000000 621006                    EAX1    0,QL
         3 000612   000002 236100                    LDQ     2,,PR0
         3 000613   000022 773000                    LRL     18
         3 000614   000002 756011 xsym               STQ     USER+2,X1

      229     3615    3               USER.CGMSGID(CKPT.USER#) = CKPT.MSGID;

   3615  3 000615   000001 236100                    LDQ     1,,PR0
         3 000616   000022 772000                    QRL     18
         3 000617   000777 376007                    ANQ     511,DL
         3 000620   000005 402007                    MPY     5,DL
         3 000621   000002 736000                    QLS     2
         3 000622   000006 100500                    MLR     fill='000'O
         3 000623   000002 400010                    ADSC9   2,,PR0                   cn=2,n=8
         3 000624   000003 000010 xsym               ADSC9   USER+3,Q                 cn=0,n=8
         3 000625   000650 710000 3                  TRA     s:3630

      230     3616    3           CASE(T#CGMSG);

      231     3617    3               CALL PROCESS_CGMSG ALTRET(ALTRTN);

   3617  3 000626   000013 631400 4                  EPPR1   11
         3 000627   000000 701000 xent               TSX1    PROCESS_CGMSG
         3 000630   000665 702000 3                  TSX2    ALTRTN

      232     3618    3               STCNT.CGMSG = STCNT.CGMSG + 1;

   3618  3 000631   000015 235000 xsym               LDA     STCNT+13
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:38   
         3 000632   000001 035007                    ADLA    1,DL
         3 000633   000015 755000 xsym               STA     STCNT+13
         3 000634   000650 710000 3                  TRA     s:3630

      233     3619
      234     3620    3           CASE(T#CGDEL);

      235     3621    3               CALL PROCESS_CGDEL ALTRET(ALTRTN);

   3621  3 000635   000013 631400 4                  EPPR1   11
         3 000636   000000 701000 xent               TSX1    PROCESS_CGDEL
         3 000637   000665 702000 3                  TSX2    ALTRTN

      236     3622    3               STCNT.CGDEL = STCNT.CGDEL + 1;

   3622  3 000640   000016 235000 xsym               LDA     STCNT+14
         3 000641   000001 035007                    ADLA    1,DL
         3 000642   000016 755000 xsym               STA     STCNT+14
         3 000643   000650 710000 3                  TRA     s:3630

      237     3623
      238     3624    3           CASE(ELSE);

      239     3625         /*  NOT  PROCESSED */
      240     3626    3               END;

   3626  3 000644   000650 710000 3                  TRA     s:3630

      241     3627    2           ELSE
      242     3628    2               UNAP = UNAP +1; /* Cnt of unapplied records */

   3628  3 000645   000007 235000 0                  LDA     UNAP
         3 000646   000001 035007                    ADLA    1,DL
         3 000647   000007 755000 0                  STA     UNAP

      243     3629
      244     3630    2           CALL READ_JRNL ALTRET(EOF_JRNL);
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:39   

   3630  3 000650   000667 701000 3                  TSX1    READ_JRNL
         3 000651   000657 702000 3                  TSX2    EOF_JRNL

      245     3631    2           END;

   3631  3 000652   000004 236000 0                  LDQ     CURR_TIME
         3 000653   000000 116000 xsym               CMPQ    ROLL_CMPLT_TIME
         3 000654   000043 602000 3                  TNC     s:3492

      246     3632    1       RETURN;

   3632  3 000655   000000 221200 0                  LDX1  ! 0
         3 000656   000001 702211                    TSX2  ! 1,X1

      247     3633
      248     3634    1   EOF_JRNL:
      249     3635    1       IF ERRCODESF.ERR# = %E$EOF THEN

   3635  3 000657   000000 236000 xsym  EOF_JRNL     LDQ     ERRCODESF
         3 000660   377770 376007                    ANQ     131064,DL
         3 000661   000060 116007                    CMPQ    48,DL
         3 000662   000665 601000 3                  TNZ     ALTRTN

      250     3636    1           RETURN;

   3636  3 000663   000000 221200 0                  LDX1  ! 0
         3 000664   000001 702211                    TSX2  ! 1,X1

      251     3637    1   ALTRTN:
      252     3638    1       ALTRETURN;

   3638  3 000665   000000 221200 0     ALTRTN       LDX1  ! 0
         3 000666   000000 702211                    TSX2  ! 0,X1

      253     3639
      254     3640
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:40   
      255     3641        %EJECT;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:41   
      256     3642        /*
      257     3643                          READ JOURNAL PROCEDURE
      258     3644        */
      259     3645    1   READ_JRNL: PROC ALTRET;

   3645  3 000667   000013 741200 0     READ_JRNL    STX1  ! ZERO$+1

      260     3646
      261     3647    2       JRNL_BUF = '0'B;

   3647  3 000670   010000 220003                    LDX0    4096,DU
         3 000671   000040 100400                    MLR     fill='000'O
         3 000672   000013 000001 4                  ADSC9   11                       cn=0,n=1
         3 000673   000000 000010 xsym               ADSC9   JRNL_BUF                 cn=0,n=*X0

      262     3648
      263     3649    2   /**/ DCBSF = M_JRNL.DCB#;

   3649  3 000674   000002 222000 xsym               LDX2    M_JRNL+2
         3 000675   000000 742000 xsym               STX2    DCBSF

      264     3650    2   /**/ BUFSF = VECTOR(JRNL_BUF);

   3650  3 000676   000022 237000 4                  LDAQ    18
         3 000677   000000 755000 xsym               STA     BUFSF
         3 000700   000001 756000 xsym               STQ     BUFSF+1

      265     3651    2   /**/ BUFLNSF = 4096;

   3651  3 000701   010000 235007                    LDA     4096,DL
         3 000702   000000 755000 xsym               STA     BUFLNSF

      266     3652    2   /**/ FULLSF = %NO#;

   3652  3 000703   000000 450000 xsym               STZ     FULLSF

      267     3653    2   /**/ FSA_FLAG = %YES#; /* Use fast seq access routine */
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:42   

   3653  3 000704   400000 236003                    LDQ     -131072,DU
         3 000705   000000 756000 xsym               STQ     FSA_FLAG

      268     3654    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;

   3654  3 000706   000027 236000 xsym               LDQ     ZI$DIR+23
         3 000707   000000 756000 xsym               STQ     ENCRP_SEEDSF

      269     3655    2       CALL SYS_FUNC_READ ALTRET(EOF);

   3655  3 000710   000013 631400 4                  EPPR1   11
         3 000711   000000 701000 xent               TSX1    SYS_FUNC_READ
         3 000712   000730 702000 3                  TSX2    EOF

      270     3656    2       JREC_NO = JREC_NO +1;

   3656  3 000713   000006 235000 0                  LDA     JREC_NO
         3 000714   000001 035007                    ADLA    1,DL
         3 000715   000006 755000 0                  STA     JREC_NO

      271     3657
      272     3658    2       CURR_TIME = JREC.TIME;

   3658  3 000716   000000 470400 xsym               LDP0    JRNL$
         3 000717   000000 235100                    LDA     0,,PR0
         3 000720   000004 755000 0                  STA     CURR_TIME

      273     3659    2       CURR_USER# = JREC.USER#;

   3659  3 000721   000001 236100                    LDQ     1,,PR0
         3 000722   000022 772000                    QRL     18
         3 000723   000777 376007                    ANQ     511,DL
         3 000724   000033 736000                    QLS     27
         3 000725   000003 756000 0                  STQ     CURR_USER#

      274     3660    2       RETURN;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:43   

   3660  3 000726   000013 221200 0                  LDX1  ! ZERO$+1
         3 000727   000001 702211                    TSX2  ! 1,X1

      275     3661    2   EOF:
      276     3662    2       ALTRETURN;

   3662  3 000730   000013 221200 0     EOF          LDX1  ! ZERO$+1
         3 000731   000000 702211                    TSX2  ! 0,X1

      277     3663    2   END READ_JRNL;
      278     3664    1   READ_ROLL: PROC ALTRET;

   3664  3 000732   000014 741200 0     READ_ROLL    STX1  ! ZERO$+2

      279     3665    2   /**/ DCBSF = M_RLBK.DCB#;

   3665  3 000733   000002 220000 xsym               LDX0    M_RLBK+2
         3 000734   000000 740000 xsym               STX0    DCBSF

      280     3666    2   /**/ BUFSF = VECTOR(ROLL_REC);

   3666  3 000735   000024 237000 4                  LDAQ    20
         3 000736   000000 755000 xsym               STA     BUFSF
         3 000737   000001 756000 xsym               STQ     BUFSF+1

      281     3667    2   /**/ BUFLNSF = 10;

   3667  3 000740   000012 235007                    LDA     10,DL
         3 000741   000000 755000 xsym               STA     BUFLNSF

      282     3668    2   /**/ FULLSF = %NO#;

   3668  3 000742   000000 450000 xsym               STZ     FULLSF

      283     3669    2       CALL SYS_FUNC_READ ALTRET(EOF);

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:44   
   3669  3 000743   000013 631400 4                  EPPR1   11
         3 000744   000000 701000 xent               TSX1    SYS_FUNC_READ
         3 000745   000750 702000 3                  TSX2    EOF

      284     3670    2       RETURN;

   3670  3 000746   000014 221200 0                  LDX1  ! ZERO$+2
         3 000747   000001 702211                    TSX2  ! 1,X1

      285     3671    2   EOF:
      286     3672    2       ALTRETURN;

   3672  3 000750   000014 221200 0     EOF          LDX1  ! ZERO$+2
         3 000751   000000 702211                    TSX2  ! 0,X1

      287     3673    2   END READ_ROLL;
      288     3674        %EJECT;
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:45   
      289     3675        /*      FILL  ROLL  INTERVALS  IN  USER  TABLE   PROCEDURE   */
      290     3676    1   FILL_ROLL_INTRVLS: PROC ALTRET;

   3676  3 000752   000015 741200 0     FILL_ROLL_I* STX1  ! ZERO$+3

      291     3677        /*
      292     3678              This procedure reads the sorted roll back interval file and
      293     3679              places each roll interval in the user table against its user
      294     3680              until the end of file or until two intervals are hit for the
      295     3681              same user. For the later, the roll record causing the collision
      296     3682              is not processed until the journal has been processed up to that
      297     3683              time in the collision roll record, then this routine's again called.
      298     3684        */
      299     3685
      300     3686    3       DO WHILE(USER.RLBK_START(ROLL_REC.USER#) = HIGH_VALUE AND ~END_OF_ROLL);

   3686  3 000753   000763 710000 3                  TRA     s:3690

      301     3687
      302     3688    3           USER.RLBK_START(ROLL_REC.USER#) = ROLL_REC.START;

   3688  3 000754   000002 236000 0                  LDQ     ROLL_REC+1
         3 000755   000033 772000                    QRL     27
         3 000756   000005 402007                    MPY     5,DL
         3 000757   000001 235000 0                  LDA     ROLL_REC
         3 000760   000001 755006 xsym               STA     USER+1,QL

      303     3689    3           CALL READ_ROLL ALTRET(EOF_ROLL);

   3689  3 000761   000732 701000 3                  TSX1    READ_ROLL
         3 000762   000776 702000 3                  TSX2    EOF_ROLL

      304     3690    3           END;

   3690  3 000763   000002 236000 0                  LDQ     ROLL_REC+1
         3 000764   000033 772000                    QRL     27
         3 000765   000005 402007                    MPY     5,DL
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:46   
         3 000766   000001 236006 xsym               LDQ     USER+1,QL
         3 000767   000000 116000 2                  CMPQ    0
         3 000770   000775 601000 3                  TNZ     s:3692
         3 000771   000011 236000 0                  LDQ     END_OF_ROLL
         3 000772   400000 376003                    ANQ     -131072,DU
         3 000773   400000 676003                    ERQ     -131072,DU
         3 000774   000754 601000 3                  TNZ     s:3688

      305     3691
      306     3692    3       DO NEVER;

   3692  3 000775   001013 710000 3                  TRA     s:3702

      307     3693    3   EOF_ROLL:
      308     3694    3           IF MONITOR_ERR# = %E$EOF THEN

   3694  3 000776   000000 470400 xsym  EOF_ROLL     LDP0    B$TCB$
         3 000777   000000 471500                    LDP1    0,,PR0
         3 001000   100102 236100                    LDQ     66,,PR1
         3 001001   377770 376007                    ANQ     131064,DL
         3 001002   000060 116007                    CMPQ    48,DL
         3 001003   001011 601000 3                  TNZ     s:3700

      309     3695    4           DO;

      310     3696    4               END_OF_ROLL = %YES#;

   3696  3 001004   400000 236003                    LDQ     -131072,DU
         3 001005   000011 756000 0                  STQ     END_OF_ROLL

      311     3697    4               ROLL_REC.START = ROLL_CMPLT_TIME;

   3697  3 001006   000000 235000 xsym               LDA     ROLL_CMPLT_TIME
         3 001007   000001 755000 0                  STA     ROLL_REC

      312     3698    4               END;

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:47   
   3698  3 001010   001013 710000 3                  TRA     s:3702

      313     3699    3           ELSE
      314     3700    3               ALTRETURN;

   3700  3 001011   000015 221200 0                  LDX1  ! ZERO$+3
         3 001012   000000 702211                    TSX2  ! 0,X1

      315     3701    3           END;

      316     3702    2   END FILL_ROLL_INTRVLS;

   3702  3 001013   000015 221200 0                  LDX1  ! ZERO$+3
         3 001014   000001 702211                    TSX2  ! 1,X1

JREC_NO
 Sect OctLoc
   0     006   000000 000000                                                    ....

UNAP
 Sect OctLoc
   0     007   000000 000000                                                    ....

END_OF_JRNL
 Sect OctLoc
   0     010   0***** ******                                                    ....

END_OF_ROLL
 Sect OctLoc
   0     011   0***** ******                                                    ....

(unnamed)
 Sect OctLoc
   0     013   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:48   
   2     000   777777 777777   050111 104123   040111 155160   154151 143151    ....(IDS Implici
   2     004   164051 040040                                                    t)

(unnamed)
 Sect OctLoc
   4     000   000003 000000   000000 000036   400000 000000   000000 206000    ................
   4     004   000001 006000   000002 006000   040040 040040   000010 206000    ........    ....
   4     010   000001 006000   000002 006000   777777 400007   000000 000000    ................
   4     014   000001 000000   000001 200000   000000 006000   000001 400000    ................
   4     020   000002 000000   000000 006000   001777 777640   000000 006000    ................
   4     024   000001 777640   000001 006000                                    ........
      317     3703    1   END ZIU$PRJRNL;

PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:49   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_ROLL_STATS.:ZIC0TOU  is referenced.
   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$PRJRNL.

   Procedure ZIU$PRJRNL requires 525 words for executable code.
   Procedure ZIU$PRJRNL is declared NOAUTO and requires 18 words of local(STATIC) storage.

    No errors detected in file ZIU$PRJRNL.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:50   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:51   
          MINI XREF LISTING

ALTRTN
      3638**LABEL    3486--CALLALT  3526--CALLALT  3533--CALLALT  3537--CALLALT  3541--CALLALT  3545--CALLALT
      3549--CALLALT  3555--CALLALT  3562--CALLALT  3568--CALLALT  3573--CALLALT  3578--CALLALT  3585--CALLALT
      3590--CALLALT  3617--CALLALT  3621--CALLALT
B$EXCFR.ASL
       974**DCL       974--REDEF
B$EXCFR.ERR.ERR#
       988**DCL       988--REDEF    3694>>IF
B$EXCFR.EVID
       987**DCL       987--REDEF     988--REDEF
B$EXCFR.IR
       975**DCL       975--REDEF
B$EXCFR.PREVSZ
       974**DCL       974--REDEF
B$EXCFR.SUBC
       986**DCL       986--REDEF     987--REDEF     987--REDEF
B$TCB.ALT$
       971**DCL      3694>>IF
B$TCB$
        36**DCL      3694>>IF
BERC.DCB#
       195**DCL       196--REDEF    3588<>CALL     3591<>CALL
BERC.SYSID
       196**DCL      3529>>ASSIGN
BERC.USER#
       194**DCL      3498>>IF       3501>>CALLBLT  3504>>IF       3506>>ASSIGN   3514>>CALLBLT  3521<>CALL
      3522>>ASSIGN   3529>>ASSIGN   3582>>ASSIGN   3584>>IF       3588<>CALL     3591<>CALL     3598>>CALLBLT
      3605>>ASSIGN   3606>>ASSIGN   3608<>CALL
BUFLNSF
      1199**DCL      3651<<ASSIGN   3667<<ASSIGN
BUFSF
      1200**DCL      3650<<ASSIGN   3666<<ASSIGN
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:52   
CKPT.CKPTNO
       201**DCL      3614>>ASSIGN
CKPT.MSGID
       202**DCL      3615>>ASSIGN
CKPT.USER#
       200**DCL      3614>>ASSIGN   3615>>ASSIGN
COUNTSF
      1250**DCL      1251--REDEF
CURR_TIME
        20**DCL      3476<<ASSIGN   3489>>DOWHILE  3523>>IF       3658<<ASSIGN
CURR_USER#
        19**DCL      3492>>IF       3523>>IF       3525>>ASSIGN   3611>>IF       3612>>ASSIGN   3612>>ASSIGN
      3659<<ASSIGN
DCBLIST$
       338**DCL       361--IMP-PTR
DCBSF
      1179**DCL      3649<<ASSIGN   3665<<ASSIGN
DEL_USER_FIDS
      3450**DCL-ENT  3521--CALL     3608--CALL
ENCRP_SEEDSF
      1208**DCL      1209--REDEF    3654<<ASSIGN
END_OF_ROLL
        28**DCL      3686>>DOWHILE  3696<<ASSIGN
EOF IN PROCEDURE READ_JRNL
      3662**LABEL    3655--CALLALT
EOF IN PROCEDURE READ_ROLL
      3672**LABEL    3669--CALLALT
EOF_JRNL
      3635**LABEL    3487--CALLALT  3630--CALLALT
EOF_ROLL IN PROCEDURE FILL_ROLL_INTRVLS
      3694**LABEL    3689--CALLALT
ERASE_USER_DCBID
      3451**DCL-ENT  3591--CALL
ERRCODESF
      1210**DCL      1215--REDEF
ERRCODESF.ERR#
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:53   
      1213**DCL      3517<<ASSIGN   3601<<ASSIGN   3635>>IF
ERRCODE_RDEF
      1215**DCL      3519>>ASSIGN   3603>>ASSIGN
ERRFLGSF
      1239**DCL      3518<<ASSIGN   3602<<ASSIGN
ERR_INSERT.CNT
      1224**DCL      3500<<ASSIGN   3508<<ASSIGN   3513<<ASSIGN   3597<<ASSIGN
ERR_INSERT.TEXT
      1225**DCL      3501<<CALLBLT  3503<>CALL     3509<<ASSIGN   3512<<ASSIGN   3514<<CALLBLT  3516<>CALL
      3598<<CALLBLT  3600<>CALL
F$DCB.ACTPOS
       946**DCL       946--REDEF
F$DCB.ARS#
       920**DCL       920--REDEF
F$DCB.ATTR
       939**DCL       940--REDEF
F$DCB.BORROW
       954**DCL       954--REDEF     954--REDEF     954--REDEF
F$DCB.DCBNAME.L
       968**DCL       968--IMP-SIZ
F$DCB.EOMCHAR#
       924**DCL       924--REDEF
F$DCB.FLDID
       949**DCL       949--REDEF
F$DCB.FORM$
       943**DCL       943--REDEF
F$DCB.FSECT
       959**DCL       959--REDEF
F$DCB.FSN#
       936**DCL       936--REDEF     936--REDEF     937--REDEF
F$DCB.HEADER$
       942**DCL       942--REDEF
F$DCB.IXTNSIZE#
       940**DCL       940--REDEF
F$DCB.LASTSTA$
       929**DCL       929--REDEF
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:54   
F$DCB.LVL
       955**DCL       955--REDEF
F$DCB.NAME#.C
       930**DCL       930--REDEF
F$DCB.NOEOF
       952**DCL       952--REDEF
F$DCB.NRECS#
       941**DCL       941--REDEF
F$DCB.NRECX
       960**DCL       960--REDEF
F$DCB.OHDR
       952**DCL       952--REDEF
F$DCB.ORG#
       935**DCL       935--REDEF
F$DCB.PRECNO
       958**DCL       958--REDEF
F$DCB.RCSZ
       964**DCL       964--REDEF
F$DCB.RES#
       931**DCL       931--REDEF
F$DCB.SETX
       943**DCL       943--REDEF
F$DCB.TAB$
       943**DCL       943--REDEF
F$DCB.TDA
       957**DCL       958--REDEF
F$DCB.WSN#
       931**DCL       931--REDEF
FID$
       337**DCL       341--IMP-PTR  3589>>IF       3590>>CALL
FIDLIST.CRPT
       350**DCL       351--REDEF
FIDLIST.DCB#
       352**DCL      3590<>CALL
FIDLIST.ORG#
       348**DCL      3589>>IF
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:55   
FIDSF_RD
      1226**DCL      1227--REDEF
FIDX
       385**DCL      3588<>CALL     3589>>IF       3590>>CALL
FILL_ROLL_INTRVLS
      3676**PROC     3486--CALL     3526--CALL     3585--CALL
FIND_USER_FIDID
      3467**DCL-ENT  3588--CALL
FSA_FLAG
      1241**DCL      3653<<ASSIGN
FULLSF
      1197**DCL      3652<<ASSIGN   3668<<ASSIGN
HELPCODE
      1244**DCL      1249--REDEF
I_O_BUF
        39**DCL      3481--ASSIGN
I_O_BUF$
        38**DCL        39--IMP-PTR  3481>>ASSIGN
JREC.LENGTH
       180**DCL       183--IMP-SIZ
JREC.TIME
       175**DCL      3492>>IF       3611>>IF       3658>>ASSIGN
JREC.TYPE
       176**DCL      3492>>IF       3492>>IF       3492>>IF       3495>>DOCASE
JREC.USER#
       177**DCL      3659>>ASSIGN
JREC_NO
        22**DCL      3656<<ASSIGN   3656>>ASSIGN
JRNL$
       153**DCL       154--IMP-PTR   174--IMP-PTR   184--IMP-PTR   191--IMP-PTR   197--IMP-PTR  3492>>IF
      3492>>IF       3492>>IF       3492>>IF       3495>>DOCASE   3498>>IF       3501>>CALLBLT  3504>>IF
      3506>>ASSIGN   3514>>CALLBLT  3521>>CALL     3522>>ASSIGN   3529>>ASSIGN   3529>>ASSIGN   3582>>ASSIGN
      3584>>IF       3588>>CALL     3588>>CALL     3590<>CALL     3591>>CALL     3591>>CALL     3598>>CALLBLT
      3605>>ASSIGN   3606>>ASSIGN   3608>>CALL     3611>>IF       3614>>ASSIGN   3614>>ASSIGN   3615>>ASSIGN
      3615>>ASSIGN   3658>>ASSIGN   3659>>ASSIGN
JRNL_BUF
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:56   
        24**DCL      3647<<ASSIGN   3650--ASSIGN
KEYVSF
      1182**DCL      1187--REDEF
KEYVSF.WD_ONE
      1184**DCL      1185--REDEF
MSGCODE
      1216**DCL      1217--REDEF    3519<<ASSIGN   3603<<ASSIGN
M_JRNL.DCB#
        17**DCL      3649>>ASSIGN
M_RLBK.DCB#
        34**DCL      3665>>ASSIGN
NO.USERS
       374**DCL      3477>>DOINDEX
PROCESS_CGDEL
      3466**DCL-ENT  3621--CALL
PROCESS_CGMSG
      3465**DCL-ENT  3617--CALL
PROCESS_DEL
      3454**DCL-ENT  3541--CALL
PROCESS_FID
      3452**DCL-ENT  3533--CALL
PROCESS_IDEL
      3461**DCL-ENT  3573--CALL
PROCESS_ISTO
      3460**DCL-ENT  3568--CALL
PROCESS_KDEL
      3459**DCL-ENT  3562--CALL
PROCESS_KSTO
      3458**DCL-ENT  3555--CALL
PROCESS_MOD
      3455**DCL-ENT  3545--CALL
PROCESS_SET
      3457**DCL-ENT  3549--CALL
PROCESS_STO
      3453**DCL-ENT  3537--CALL
PROCESS_SUM
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:57   
      3456**DCL-ENT  3578--CALL
READ_JRNL
      3645**PROC     3487--CALL     3630--CALL
READ_ROLL
      3664**PROC     3689--CALL
ROLL_CMPLT_TIME
        26**DCL      3489>>DOWHILE  3697>>ASSIGN
ROLL_REC
         9**DCL      3666--ASSIGN
ROLL_REC.START
        10**DCL      3475<<ASSIGN   3688>>ASSIGN   3697<<ASSIGN
ROLL_REC.USER#
        11**DCL      3474<<ASSIGN   3584>>IF       3686>>DOWHILE  3688>>ASSIGN
STCNT
       512**DCL       529--REDEF
STCNT.BFIDS
       515**DCL      3534<<ASSIGN   3534>>ASSIGN
STCNT.BUSER
       513**DCL      3530<<ASSIGN   3530>>ASSIGN
STCNT.CGDEL
       527**DCL      3622<<ASSIGN   3622>>ASSIGN
STCNT.CGMSG
       526**DCL      3618<<ASSIGN   3618>>ASSIGN
STCNT.CHKSUMS
       523**DCL      3579<<ASSIGN   3579>>ASSIGN
STCNT.CKPTS
       525**DCL      3613<<ASSIGN   3613>>ASSIGN
STCNT.DLETES
       518**DCL      3542<<ASSIGN   3542>>ASSIGN   3574<<ASSIGN   3574>>ASSIGN
STCNT.EFIDS
       516**DCL      3592<<ASSIGN   3592>>ASSIGN
STCNT.EUSER
       514**DCL      3607<<ASSIGN   3607>>ASSIGN
STCNT.KDEL
       522**DCL      3563<<ASSIGN   3563>>ASSIGN
STCNT.KSTO
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:58   
       521**DCL      3556<<ASSIGN   3556>>ASSIGN
STCNT.MODRCDS
       519**DCL      3546<<ASSIGN   3546>>ASSIGN
STCNT.MODSETS
       520**DCL      3550<<ASSIGN   3550>>ASSIGN
STCNT.ROLBKS
       524**DCL      3583<<ASSIGN   3583>>ASSIGN
STCNT.STORES
       517**DCL      3538<<ASSIGN   3538>>ASSIGN   3569<<ASSIGN   3569>>ASSIGN
SYS_FUNC_ERRMSG
      3463**DCL-ENT  3520--CALL     3604--CALL
SYS_FUNC_READ
      3449**DCL-ENT  3655--CALL     3669--CALL
UNAP
        23**DCL      3628<<ASSIGN   3628>>ASSIGN
USER.CGMSGID
       370**DCL      3615<<ASSIGN
USER.CHKPT_NO
       369**DCL      3504>>IF       3507<<ASSIGN   3507>>ASSIGN   3514>>CALLBLT  3522<<ASSIGN   3606<<ASSIGN
      3614<<ASSIGN
USER.RLBK_START
       368**DCL      3479<<ASSIGN   3492>>IF       3523>>IF       3525<<ASSIGN   3582<<ASSIGN   3611>>IF
      3612<<ASSIGN   3612>>ASSIGN   3686>>DOWHILE  3688<<ASSIGN
USER.SYSID
       366**DCL      3478<<ASSIGN   3498>>IF       3501>>CALLBLT  3529<<ASSIGN   3598>>CALLBLT  3605<<ASSIGN
X
        21**DCL      3477<<DOINDEX  3478>>ASSIGN   3479>>ASSIGN   3482<<DOINDEX  3483>>ASSIGN   3506<<ASSIGN
      3507>>ASSIGN   3507>>ASSIGN
ZERO$
        41**DCL        40--IMP-PTR  3481<<ASSIGN   3483>>ASSIGN
ZEROS
        40**DCL      3483<<ASSIGN
ZERO_SUP
      3462**DCL-ENT  3503--CALL     3516--CALL     3600--CALL
ZI$DIR.ALTKEY
       760**DCL       761--REDEF     762--REDEF
PL6.E3A0      #001=ZIU$PRJRNL File=ZIU$PRJRNL.:ZIC0TSI                           FRI 09/05/97 13:20 Page:59   
ZI$DIR.AREAFID
       726**DCL       727--REDEF
ZI$DIR.DATE
       765**DCL       769--REDEF
ZI$DIR.DEST_SEED
       721**DCL       722--REDEF     723--REDEF
ZI$DIR.ENCP_SEED
       718**DCL       719--REDEF     720--REDEF    3654>>ASSIGN
ZI$DIR.NOKEYS
       731**DCL      3553>>IF       3560>>IF
ZI$DIR.REPRT_ZERO
       752**DCL       753--REDEF
ZI$DIR.SCHFID
       724**DCL       725--REDEF
ZI$DIR.TIME
       770**DCL       775--REDEF
ZIU$CGCLNUP
      3464**DCL-ENT  3590--CALL
