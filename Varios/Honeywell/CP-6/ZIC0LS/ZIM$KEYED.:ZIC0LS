
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:1    
        1        1        /*M*     ZIM$KDEL - delete alternate key          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIM$KDEL: PROC ALTRET
        8        8        /*          USE($PR5 FOR GLOBAL$)              */
        9        9               AVOID($PR5,$PR6,$PR7);
       10       10        %INCLUDE ZI$GLOBAL;
       11      496            %GLOBALS;
       12      804        %INCLUDE ZI$DBCB;
       13     1446            %DBCB;
       14     1924            %RECVAR;
       15     1958            %AWS;
       16     1998        %INCLUDE ZI$SSS;
       17     2547            %AC;
       18     2642            %SC1;
       19     2652            %RS;
       20     2728        %INCLUDE ZI_ERRORS_C;
       21     3054        %INCLUDE CP_6;
       22     3135            %FPT_DELREC(FPTN=FPT$DELR,STCLASS=BASED);
       23     3154            %B$TCB;
       24     3157            %B$ALT;
       25     3165        %INCLUDE CP_6_SUBS;
       26     3705    1   DCL B$TCB$ PTR SYMREF;
       27     3706    1   DCL DBKY SBIN(36);
       28     3707    1   DCL CDBKY REDEF DBKY CHAR(4);
       29     3708    1   DCL RVI$ PTR;
       30     3709    1   DCL ZIM$JKDEL ENTRY(1);
       31     3710    1   DCL ERROR UBIN(36);
       32     3711    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
       33     3712    1       SSS$=GLOBAL.ACTIVE.SSS$;
       34     3713    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);
       35     3714    1       AC$=PINCRW(SSS$,RVI$->RECVAR.ACPTR);
       36     3715    1       AWS$=PINCRW(DBCB$,AC.WSOF);
       37     3716        /*       If load mode return without processing */
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:2    
       38     3717    1       IF AWS.ATRIB.LOAD THEN
       39     3718    1           RETURN;
       40     3719    1       RS$=PINCRW(SSS$,DBCB.PWS.XPRS);
       41     3720    1       SC1$=PINCRW(SSS$,RS.SCRSH-SIZEW(SC1));
       42     3721    1       GLOBAL.SKEY.LENGTH=SC1.KLNG+AC.BPLDBK+2;
       43     3722    1       GLOBAL.SKEY.IXID=SC1.IXID;
       44     3723        /*       Value already there since KEYPA$ points into global    */
       45     3724    1       DBKY=RVI$->RECVAR.DBKEY-AC.ABAS;
       46     3725    1       CALL INSERT(GLOBAL.SKEY.VALUE,SC1.KLNG,AC.BPLDBK,
       47     3726    1          SUBSTR(CDBKY,4-AC.BPLDBK,AC.BPLDBK));
       48     3727    1       GLOBAL.DELR$->FPT$DELR.V.DCB#=AWS.KDCB;
       49     3728    1       CALL ZIM$JKDEL(AWS$);
       50     3729    1       CALL M$DELREC(GLOBAL.DELR$->FPT$DELR) ALTRET(ER_DELR);
       51     3730    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;
       52     3731    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;
       53     3732    1       RETURN;
       54     3733    1   ER_DELR: ERROR=ERR#IX#DELAK;
       55     3734    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
       56     3735    1       GLOBAL.RET.DCB#=GLOBAL.DELR$->FPT$DELR.V.DCB#;
       57     3736    1   ALT: ;
       58     3737            %DBALT;
       59     3751    1   END ZIM$KDEL;
       60     3752        %EOD;

PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:3    
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$KDEL.

   Procedure ZIM$KDEL requires 115 words for executable code.
   Procedure ZIM$KDEL requires 14 words of local(AUTO) storage.

PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:4    

 Object Unit name= ZIM$KDEL                                   File name= ZIM$KEYED.:ZIC0TOU
 UTS= SEP 05 '97 13:01:48.72 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   115    163  ZIM$KDEL
    2  RoData even  none     3      3  ZIM$KDEL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$KDEL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      1 ZIM$JKDEL
         yes           XStd      0 ZIB$ERR
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$TCB$
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:5    

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:6    


        1        1        /*M*     ZIM$KDEL - delete alternate key          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIM$KDEL: PROC ALTRET

      7  1 000000   000000 700200 xent  ZIM$KDEL     TSX0  ! X66_AUTO_0
         1 000001   000016 000000                    ZERO    14,0

        8        8        /*          USE($PR5 FOR GLOBAL$)              */
        9        9               AVOID($PR5,$PR6,$PR7);
       10       10        %INCLUDE ZI$GLOBAL;
       11      496            %GLOBALS;
       12      804        %INCLUDE ZI$DBCB;
       13     1446            %DBCB;
       14     1924            %RECVAR;
       15     1958            %AWS;
       16     1998        %INCLUDE ZI$SSS;
       17     2547            %AC;
       18     2642            %SC1;
       19     2652            %RS;
       20     2728        %INCLUDE ZI_ERRORS_C;
       21     3054        %INCLUDE CP_6;
       22     3135            %FPT_DELREC(FPTN=FPT$DELR,STCLASS=BASED);
       23     3154            %B$TCB;
       24     3157            %B$ALT;
       25     3165        %INCLUDE CP_6_SUBS;
       26     3705    1   DCL B$TCB$ PTR SYMREF;
       27     3706    1   DCL DBKY SBIN(36);
       28     3707    1   DCL CDBKY REDEF DBKY CHAR(4);
       29     3708    1   DCL RVI$ PTR;
       30     3709    1   DCL ZIM$JKDEL ENTRY(1);
       31     3710    1   DCL ERROR UBIN(36);
       32     3711    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:7    

   3711  1 000002   000000 470400 xsym               LDP0    GLOBAL$
         1 000003   000001 236100                    LDQ     1,,PR0
         1 000004   200003 756100                    STQ     DBCB$,,AUTO

       33     3712    1       SSS$=GLOBAL.ACTIVE.SSS$;

   3712  1 000005   000000 236100                    LDQ     0,,PR0
         1 000006   200005 756100                    STQ     SSS$,,AUTO

       34     3713    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);

   3713  1 000007   200003 471500                    LDP1    DBCB$,,AUTO
         1 000010   100510 220100                    LDX0    328,,PR1
         1 000011   000000 636010                    EAQ     0,X0
         1 000012   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000013   200012 756100                    STQ     RVI$,,AUTO

       35     3714    1       AC$=PINCRW(SSS$,RVI$->RECVAR.ACPTR);

   3714  1 000014   200012 473500                    LDP3    RVI$,,AUTO
         1 000015   300005 221100                    LDX1    5,,PR3
         1 000016   000000 636011                    EAQ     0,X1
         1 000017   200005 036100                    ADLQ    SSS$,,AUTO
         1 000020   200006 756100                    STQ     AC$,,AUTO

       36     3715    1       AWS$=PINCRW(DBCB$,AC.WSOF);

   3715  1 000021   200006 474500                    LDP4    AC$,,AUTO
         1 000022   400003 222100                    LDX2    3,,PR4
         1 000023   000000 636012                    EAQ     0,X2
         1 000024   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000025   200004 756100                    STQ     AWS$,,AUTO

       37     3716        /*       If load mode return without processing */
       38     3717    1       IF AWS.ATRIB.LOAD THEN

PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:8    
   3717  1 000026   200004 470500                    LDP0    AWS$,,AUTO
         1 000027   000000 236100                    LDQ     0,,PR0
         1 000030   000002 316003                    CANQ    2,DU
         1 000031   000033 600000 1                  TZE     s:3719

       39     3718    1           RETURN;

   3718  1 000032   000000 702200 xent               TSX2  ! X66_ARET

       40     3719    1       RS$=PINCRW(SSS$,DBCB.PWS.XPRS);

   3719  1 000033   100676 722100                    LXL2    446,,PR1
         1 000034   000000 636012                    EAQ     0,X2
         1 000035   200005 036100                    ADLQ    SSS$,,AUTO
         1 000036   200010 756100                    STQ     RS$,,AUTO

       41     3720    1       SC1$=PINCRW(SSS$,RS.SCRSH-SIZEW(SC1));

   3720  1 000037   200010 470500                    LDP0    RS$,,AUTO
         1 000040   000003 723100                    LXL3    3,,PR0
         1 000041   777776 636013                    EAQ     -2,X3
         1 000042   200005 036100                    ADLQ    SSS$,,AUTO
         1 000043   200007 756100                    STQ     SC1$,,AUTO

       42     3721    1       GLOBAL.SKEY.LENGTH=SC1.KLNG+AC.BPLDBK+2;

   3721  1 000044   400015 236100                    LDQ     13,,PR4
         1 000045   000022 772000                    QRL     18
         1 000046   200014 756100                    STQ     ERROR+1,,AUTO
         1 000047   200007 470500                    LDP0    SC1$,,AUTO
         1 000050   000000 236100                    LDQ     0,,PR0
         1 000051   777777 376007                    ANQ     -1,DL
         1 000052   200014 036100                    ADLQ    ERROR+1,,AUTO
         1 000053   000000 470400 xsym               LDP0    GLOBAL$
         1 000054   000002 036007                    ADLQ    2,DL
         1 000055   000033 736000                    QLS     27
         1 000056   004624 552140                    STBQ    2452,'40'O,PR0
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:9    

       43     3722    1       GLOBAL.SKEY.IXID=SC1.IXID;

   3722  1 000057   200007 471500                    LDP1    SC1$,,AUTO
         1 000060   100000 236100                    LDQ     0,,PR1
         1 000061   000011 772000                    QRL     9
         1 000062   004624 552130                    STBQ    2452,'30'O,PR0

       44     3723        /*       Value already there since KEYPA$ points into global    */
       45     3724    1       DBKY=RVI$->RECVAR.DBKEY-AC.ABAS;

   3724  1 000063   300000 236100                    LDQ     0,,PR3
         1 000064   400002 136100                    SBLQ    2,,PR4
         1 000065   200011 756100                    STQ     DBKY,,AUTO

       46     3725    1       CALL INSERT(GLOBAL.SKEY.VALUE,SC1.KLNG,AC.BPLDBK,

   3725  1 000066   400015 236100                    LDQ     13,,PR4
         1 000067   000022 772000                    QRL     18
         1 000070   400015 220100                    LDX0    13,,PR4
         1 000071   200014 756100                    STQ     ERROR+1,,AUTO
         1 000072   100000 236100                    LDQ     0,,PR1
         1 000073   777777 376007                    ANQ     -1,DL
         1 000074   400015 221100                    LDX1    13,,PR4
         1 000075   000000 235003                    LDA     0,DU
         1 000076   200014 135100                    SBLA    ERROR+1,,AUTO
         1 000077   040146 100545                    MLR     fill='040'O
         1 000100   200012 000010                    ADSC9   RVI$,A,AUTO              cn=0,n=*X0
         1 000101   004624 600011                    ADSC9   2452,Q,PR0               cn=3,n=*X1

       47     3726    1          SUBSTR(CDBKY,4-AC.BPLDBK,AC.BPLDBK));
       48     3727    1       GLOBAL.DELR$->FPT$DELR.V.DCB#=AWS.KDCB;

   3727  1 000102   005101 471500                    LDP1    2625,,PR0
         1 000103   200004 470500                    LDP0    AWS$,,AUTO
         1 000104   000006 720100                    LXL0    6,,PR0
         1 000105   100010 740100                    STX0    8,,PR1
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:10   

       49     3728    1       CALL ZIM$JKDEL(AWS$);

   3728  1 000106   200004 631500                    EPPR1   AWS$,,AUTO
         1 000107   200014 451500                    STP1    ERROR+1,,AUTO
         1 000110   200014 630500                    EPPR0   ERROR+1,,AUTO
         1 000111   000001 631400 2                  EPPR1   1
         1 000112   000000 701000 xent               TSX1    ZIM$JKDEL
         1 000113   000000 011000                    NOP     0

       50     3729    1       CALL M$DELREC(GLOBAL.DELR$->FPT$DELR) ALTRET(ER_DELR);

   3729  1 000114   000000 470400 xsym               LDP0    GLOBAL$
         1 000115   005101 471500                    LDP1    2625,,PR0
         1 000116   100000 630500                    EPPR0   0,,PR1
         1 000117   440002 713400                    CLIMB   alt,+16386
         1 000120   401400 401760                    pmme    nvectors=4
         1 000121   000132 702000 1                  TSX2    ER_DELR

       51     3730    1       GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;

   3730  1 000122   000000 470400 xsym               LDP0    GLOBAL$
         1 000123   001425 235100                    LDA     789,,PR0
         1 000124   000001 035007                    ADLA    1,DL
         1 000125   001425 755100                    STA     789,,PR0

       52     3731    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;

   3731  1 000126   001426 235100                    LDA     790,,PR0
         1 000127   000001 035007                    ADLA    1,DL
         1 000130   001426 755100                    STA     790,,PR0

       53     3732    1       RETURN;

   3732  1 000131   000000 702200 xent               TSX2  ! X66_ARET

       54     3733    1   ER_DELR: ERROR=ERR#IX#DELAK;
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:11   

   3733  1 000132   303424 235007       ER_DELR      LDA     100116,DL
         1 000133   200013 755100                    STA     ERROR,,AUTO

       55     3734    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3734  1 000134   000000 470400 xsym               LDP0    B$TCB$
         1 000135   000000 471500                    LDP1    0,,PR0
         1 000136   100102 236100                    LDQ     66,,PR1
         1 000137   000000 473400 xsym               LDP3    GLOBAL$
         1 000140   300007 756100                    STQ     7,,PR3

       56     3735    1       GLOBAL.RET.DCB#=GLOBAL.DELR$->FPT$DELR.V.DCB#;

   3735  1 000141   305101 471500                    LDP1    2625,,PR3
         1 000142   100010 220100                    LDX0    8,,PR1
         1 000143   300014 740100                    STX0    12,,PR3

   3735  1 000144                       ALT          null
       57     3736    1   ALT: ;
       58     3737            %DBALT;

   3738  1 000144   300006 235100                    LDA     6,,PR3
         1 000145   000154 601000 1                  TNZ     s:3746

   3740  1 000146   300010 450100                    STZ     8,,PR3

   3741  1 000147   300012 450100                    STZ     10,,PR3

   3742  1 000150   300013 450100                    STZ     11,,PR3

   3743  1 000151   300011 450100                    STZ     9,,PR3

   3744  1 000152   200013 235100                    LDA     ERROR,,AUTO
         1 000153   300006 755100                    STA     6,,PR3

   3746  1 000154   303240 115007                    CMPA    100000,DL
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:12   
         1 000155   000157 603000 1                  TRC     s:3749

   3747  1 000156   000000 702200 xent               TSX2  ! X66_AALT

   3749  1 000157   000002 631400 2                  EPPR1   2
         1 000160   000000 701000 xent               TSX1    ZIB$ERR
         1 000161   000000 011000                    NOP     0

       59     3751    1   END ZIM$KDEL;

   3751  1 000162   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000001 000000   000000 000000                    ............
       60     3752        %EOD;

PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:13   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$KDEL.

   Procedure ZIM$KDEL requires 115 words for executable code.
   Procedure ZIM$KDEL requires 14 words of local(AUTO) storage.
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:14   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:15   
          MINI XREF LISTING

AC.ABAS
      2570**DCL      3724>>ASSIGN
AC.BPLDBK
      2596**DCL      3721>>ASSIGN   3725>>CALLBLT  3725>>CALLBLT  3725>>CALLBLT
AC.DEF.ANL
      2567**DCL      2638--IMP-SIZ
AC.DEF.FORG
      2554**DCL      2558--REDEF
AC.WSOF
      2571**DCL      3715>>ASSIGN
AC$
      2550**DCL      2551--IMP-PTR  3714<<ASSIGN   3715>>ASSIGN   3721>>ASSIGN   3724>>ASSIGN   3725>>CALLBLT
      3725>>CALLBLT  3725>>CALLBLT
AWS.ATRIB.LOAD
      1976**DCL      3717>>IF
AWS.KDCB
      1986**DCL      3727>>ASSIGN
AWS$
      1959**DCL      1960--IMP-PTR  3715<<ASSIGN   3717>>IF       3727>>ASSIGN   3728<>CALL
B$ALT.CODE
      3159**DCL      3159--REDEF    3160--REDEF    3160--REDEF
B$ALT.ERR
      3160**DCL      3734>>ASSIGN
B$ALT.ERR.ERR#
      3161**DCL      3161--REDEF
B$ALT.EVID
      3160**DCL      3160--REDEF    3160--REDEF
B$TCB.ALT$
      3155**DCL      3734>>ASSIGN
B$TCB$
      3705**DCL      3734>>ASSIGN
CDBKY
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:16   
      3707**DCL      3725>>CALLBLT
DBCB.IOWS.CFCT
      1876**DCL      1877--REDEF
DBCB.IOWS.DBKF.RQ
      1819**DCL      1820--REDEF
DBCB.IOWS.DBKR
      1816**DCL      1817--REDEF
DBCB.IOWS.NOBF
      1878**DCL      1879--REDEF
DBCB.IOWS.SPND
      1804**DCL      1805--REDEF
DBCB.PCB.RVI
      1652**DCL      3713>>ASSIGN
DBCB.PWS.XPRS
      1734**DCL      3719>>ASSIGN
DBCB.SWS.RDYCW
      1542**DCL      1543--REDEF
DBCB.SWS.TEMP.PTR1$
      1576**DCL      1577--REDEF    1578--REDEF
DBCB.SWS.TEMP.PTR2$
      1579**DCL      1580--REDEF
DBCB$
      1447**DCL      1448--IMP-PTR  3711<<ASSIGN   3713>>ASSIGN   3713>>ASSIGN   3715>>ASSIGN   3719>>ASSIGN
DBKY
      3706**DCL      3707--REDEF    3724<<ASSIGN
ERROR
      3710**DCL      3733<<ASSIGN   3744>>ASSIGN
ER_DELR
      3733**LABEL    3729--CALLALT
FPT$DELR
      3146**DCL      3729<>CALL
FPT$DELR.V.DCB#
      3150**DCL      3727<<ASSIGN   3735>>ASSIGN
GLOBAL.ACTIVE.DBCB$
       503**DCL       504--REDEF    3711>>ASSIGN
GLOBAL.ACTIVE.SSS$
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:17   
       499**DCL       500--REDEF    3712>>ASSIGN
GLOBAL.DELR$
       765**DCL      3727>>ASSIGN   3729>>CALL     3735>>ASSIGN
GLOBAL.KEY
       707**DCL       710--REDEF
GLOBAL.PARAN.TRACE.MODE
       582**DCL       589--REDEF
GLOBAL.PRINTBUF.BUFFER
       741**DCL       742--REDEF     743--REDEF     744--REDEF
GLOBAL.PRINTBUF.ERR.V
       746**DCL       749--REDEF     750--REDEF     751--REDEF
GLOBAL.RET.AC#
       519**DCL      3740<<ASSIGN
GLOBAL.RET.DCB#
       523**DCL      3735<<ASSIGN
GLOBAL.RET.ERROR#
       517**DCL      3738>>IF       3744<<ASSIGN   3746>>IF
GLOBAL.RET.FR#
       520**DCL      3743<<ASSIGN
GLOBAL.RET.RC#
       522**DCL      3742<<ASSIGN
GLOBAL.RET.SC#
       521**DCL      3741<<ASSIGN
GLOBAL.RET.SYSERR#
       518**DCL      3734<<ASSIGN
GLOBAL.SKEY.IXID
       712**DCL      3722<<ASSIGN
GLOBAL.SKEY.LENGTH
       711**DCL      3721<<ASSIGN
GLOBAL.SKEY.VALUE
       713**DCL      3725<<CALLBLT
GLOBAL.STATS.CURR.READS
       657**DCL      3730<<ASSIGN   3730>>ASSIGN
GLOBAL.STATS.CURR.WRITES
       658**DCL      3731<<ASSIGN   3731>>ASSIGN
GLOBAL$
PL6.E3A0      #001=ZIM$KDEL File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:01 Page:18   
       801**DCL       497--IMP-PTR  3711>>ASSIGN   3712>>ASSIGN   3721>>ASSIGN   3722>>ASSIGN   3725>>CALLBLT
      3727>>ASSIGN   3729>>CALL     3730>>ASSIGN   3730>>ASSIGN   3731>>ASSIGN   3731>>ASSIGN   3734>>ASSIGN
      3735>>ASSIGN   3735>>ASSIGN   3738>>IF       3740>>ASSIGN   3741>>ASSIGN   3742>>ASSIGN   3743>>ASSIGN
      3744>>ASSIGN   3746>>IF
M$DELREC
      3065**DCL-ENT  3729--CALL
RECVAR.ACPTR
      1945**DCL      3714>>ASSIGN
RECVAR.BADDR
      1927**DCL      1930--REDEF
RECVAR.DBKEY
      1926**DCL      3724>>ASSIGN
RECVAR.RADDR
      1931**DCL      1935--REDEF
RS.NPOS
      2680**DCL      2689--REDEF
RS.SCRSH
      2679**DCL      3720>>ASSIGN
RS$
      2654**DCL      2655--IMP-PTR  3719<<ASSIGN   3720>>ASSIGN
RVI$
      3708**DCL      3713<<ASSIGN   3714>>ASSIGN   3724>>ASSIGN
SC1
      2645**DCL      3720--ASSIGN
SC1.IXID
      2646**DCL      3722>>ASSIGN
SC1.KLNG
      2647**DCL      3721>>ASSIGN   3725>>CALLBLT
SC1$
      2644**DCL      2645--IMP-PTR  3720<<ASSIGN   3721>>ASSIGN   3722>>ASSIGN   3725>>CALLBLT
SSS$
      2005**DCL      3712<<ASSIGN   3714>>ASSIGN   3719>>ASSIGN   3720>>ASSIGN
ZIB$ERR
       802**DCL-ENT  3749--CALL
ZIM$JKDEL
      3709**DCL-ENT  3728--CALL

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:19   
       61        1        /*M*     ZIM$KFIND - find useing alternate key     */
       62        2        /*T***********************************************************/
       63        3        /*T*                                                         */
       64        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       65        5        /*T*                                                         */
       66        6        /*T***********************************************************/
       67        7        ZIM$KFIND: PROC ALTRET
       68        8        /*          USE($PR5 FOR GLOBAL$)              */
       69        9               AVOID($PR5,$PR6,$PR7);
       70       10        %INCLUDE ZI$GLOBAL;
       71      496            %GLOBALS;
       72      804        %INCLUDE ZI$DBCB;
       73     1446            %DBCB;
       74     1924            %AWS;
       75     1964            %SETWS;
       76     1983            %RECVAR;
       77     2017        %INCLUDE ZI$SSS;
       78     2566            %AC;
       79     2661            %SC;
       80     2688            %SC1;
       81     2698            %RC;
       82     2730        %INCLUDE ZI_ERRORS_C;
       83     3056        %INCLUDE CP_6;
       84     3137            %FPT_PRECORD(FPTN=FPT$PREC,STCLASS=BASED);
       85     3158            %B$TCB;
       86     3161            %B$ALT;
       87     3169        %INCLUDE B_ERRORS_C;
       88     4296        %INCLUDE CP_6_SUBS;
       89     4836    1   DCL ZIG$DBPFD ENTRY ALTRET;
       90     4837    1   DCL ZIP$DBPR2 ENTRY ALTRET;
       91     4838    1   DCL ZIM$KCURR ENTRY;
       92     4839    1   DCL B$TCB$ PTR SYMREF;
       93     4840    1   DCL OLDKEY CHAR(248);
       94     4841    1   DCL DBKY SBIN(36);
       95     4842    1   DCL CDBKY REDEF DBKY CHAR(4);
       96     4843    1   DCL FOUND SBIN(36);
       97     4844    1   DCL ERROR UBIN(36);
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:20   
       98     4845    1   DCL RVI$ PTR;
       99     4846    1   DCL FUNCT SBIN(36);
      100     4847    1       FUNCT=1;
      101     4848    1       GOTO XNI;
      102     4849    1   ZIM$KFINDF: ENTRY ALTRET;
      103     4850    1       FUNCT=2;
      104     4851    1       GOTO XNI;
      105     4852    1   ZIM$KFINDN: ENTRY ALTRET;
      106     4853    1       FUNCT=3;
      107     4854    1   XNI: DBCB$=GLOBAL.ACTIVE.DBCB$;
      108     4855    1       SSS$=GLOBAL.ACTIVE.SSS$;
      109     4856    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);
      110     4857    1       AC$=PINCRW(SSS$,RVI$->RECVAR.ACPTR);
      111     4858    1       AWS$=PINCRW(DBCB$,AC.WSOF);
      112     4859    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);
      113     4860    1       SETWS$=PINCRW(DBCB$,SC.SCWSO);
      114     4861    1       SC1$=PINCRW(SC$,-SIZEW(SC1));
      115     4862    1       IF AWS.DDCB=0 THEN GOTO DBUNA; /* IDS AREA NOT READIED */
      116     4863    1       GLOBAL.PREC$->FPT$PREC.V.DCB#=AWS.KDCB;
      117     4864        /*       Clear garbage from larger local key     */
      118     4865    1       DBKY=0;
      119     4866    2       DO CASE(FUNCT);
      120     4867    2       CASE(1); /* ZIM$KFIND */
      121     4868    2           OLDKEY=SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG);
      122     4869    2           GLOBAL.SKEY.LENGTH=2+SC1.KLNG; /* No local DBK */
      123     4870    2           GLOBAL.SKEY.IXID=SC1.IXID;
      124     4871    2           GLOBAL.PREC$->FPT$PREC.V.N#=0;
      125     4872    2       CASE(2); /* ZIM$KFINDF */
      126     4873    2           GLOBAL.SKEY.LENGTH=2; /* Only IXID is known */
      127     4874    2           GLOBAL.SKEY.IXID=SC1.IXID;
      128     4875    2           GLOBAL.PREC$->FPT$PREC.V.N#=0;
      129     4876    2       CASE(3); /* ZIM$KFINDN */
      130     4877    2           GLOBAL.KEY.LENGTH=SETWS.KEY.LENGTH;
      131     4878    2           GLOBAL.KEY.VALUE=SETWS.KEY.VALUE;
      132     4879    2           IF SETWS.PRIV.CSE THEN
      133     4880    2               GLOBAL.PREC$->FPT$PREC.V.N#=0;
      134     4881    2           ELSE
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:21   
      135     4882    2               GLOBAL.PREC$->FPT$PREC.V.N#=1;
      136     4883    2           END;
      137     4884    1       FOUND=0;
      138     4885    2       DO WHILE (FOUND=0);
      139     4886    2           CALL M$PRECORD(GLOBAL.PREC$->FPT$PREC) ALTRET(NOKEY1);
      140     4887    2   PCOMP:  GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;
      141     4888    2           IF GLOBAL.SKEY.LENGTH=0 OR
      142     4889    2              GLOBAL.SKEY.IXID~=SC1.IXID THEN
      143     4890    2               GOTO ER_EOSR;
      144     4891    2           GLOBAL.PREC$->FPT$PREC.V.N#=1;
      145     4892    2           CALL INSERT(CDBKY,4-AC.BPLDBK,AC.BPLDBK,
      146     4893    2              SUBSTR(GLOBAL.SKEY.VALUE,SC1.KLNG,AC.BPLDBK));
      147     4894    2           RVI$->RECVAR.DBKEY=DBKY+AC.ABAS;
      148     4895                %DBCAL(NAME=ZIG$DBPFD,EXC=EX_PFD,ALT=ER_PFD);
      149     4911    2           IF RVI$->RECVAR.RTP.CONTROL.LD='1'B THEN
      150     4912    2               GOTO ER_XLD; /* Error if logically deleted */
      151     4913    3           IF DBCB.PCB.PRRC=0 THEN DO;
      152     4914    3               GLOBAL.PARAN.DBPR2.TYPE=RVI$->RECVAR.RTP.TYPE;
      153     4915    3               GLOBAL.PARAN.DBPR2.SC=DBCB.PCB.PRSC;
      154     4916    3               CALL ZIP$DBPR2 ALTRET(NEXT);
      155     4917    3               RC$=PINCRW(SSS$,GLOBAL.PARAN.DBPR2.RC);
      156     4918    3               IF NOT RC.DEF.SR THEN
      157     4919    3                   FOUND=1;
      158     4920    3               END;
      159     4921    2           ELSE
      160     4922    3           DO;
      161     4923    3               RC$=PINCRW(SSS$,DBCB.PCB.PRRC);
      162     4924    3               IF RVI$->RECVAR.RTP.TYPE=RC.RTYP THEN
      163     4925    3                   FOUND=1;
      164     4926    3               END;
      165     4927    2   NEXT:   END;
      166     4928    1       IF (RC.DEF.FVR = '0'B AND
      167     4929    1          RC.RSIZ ~= RVI$->RECVAR.RECSZ)
      168     4930    1          OR (RC.DEF.FVR = '1'B AND
      169     4931    1          RC.RSIZ < RVI$ -> RECVAR.RECSZ) THEN
      170     4932    1           GOTO ER_SIZE;
      171     4933    1       RVI$->RECVAR.RCPTR=POFFW(RC$,SSS$);
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:22   
      172     4934    1       FOUND=DBCB.PCB.RVI;
      173     4935    1       DBCB.PCB.RVI=DBCB.PCB.RVO;
      174     4936    1       DBCB.PCB.RVO=FOUND;
      175     4937    1       CALL ZIM$KCURR;
      176     4938    1       IF FUNCT=1 AND
      177     4939    1          SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG)~=OLDKEY THEN
      178     4940    1           GOTO EX_PCOMP;
      179     4941    1       RETURN;
      180     4942        %EJECT;
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:23   
      181     4943    1   NOKEY1: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN
      182     4944    1           GOTO PCOMP;
      183     4945    1       GOTO ER_UNEX;
      184     4946    1   EX_PFD: GLOBAL.PREC$->FPT$PREC.V.N#=0; /* Try same key */
      185     4947    1       CALL M$PRECORD(GLOBAL.PREC$->FPT$PREC) ALTRET(NOKEY2);
      186     4948    1       ERROR=ERR#IX#XPD;
      187     4949    1       GOTO ALT;
      188     4950    1   NOKEY2: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN
      189     4951    2       DO;
      190     4952    2           GLOBAL.PREC$->FPT$PREC.V.N#=1; /* Back to one */
      191     4953    2           GOTO NEXT;
      192     4954    2           END;
      193     4955    1   ER_UNEX: ERROR=ERR#IX#UNEX;
      194     4956    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      195     4957    1       GLOBAL.RET.DCB#=GLOBAL.PREC$->FPT$PREC.V.DCB#;
      196     4958    1       GOTO ALT;
      197     4959    1   EX_PCOMP: ERROR=EXC#PCOMP;
      198     4960            %DBEXC;
      199     4964    1   ER_EOSR: ERROR=EXC#EOSR;
      200     4965    1       GOTO ALT;
      201     4966    1   DBUNA: ERROR=EXC#UNA;
      202     4967    1       GOTO ALT;
      203     4968    1   ER_XLD: ERROR=ERR#IX#XLD;
      204     4969    1       GOTO ALT;
      205     4970    1   ER_SIZE: ERROR=ERR#CM#RSZER;
      206     4971    1   ER_PFD: ;
      207     4972    1   ALT: ;
      208     4973            %DBALT;
      209     4987    1   END ZIM$KFIND;
      210     4988        %EOD;

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:24   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$KFIND.

   Procedure ZIM$KFIND requires 314 words for executable code.
   Procedure ZIM$KFIND requires 80 words of local(AUTO) storage.

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:25   

 Object Unit name= ZIM$KFIND                                  File name= ZIM$KEYED.:ZIC0TOU
 UTS= SEP 05 '97 13:01:59.48 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   314    472  ZIM$KFIND
    2  RoData even  none     3      3  ZIM$KFIND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$KFIND
     1      5          yes     yes      XStd       0  ZIM$KFINDF
     1     12          yes     yes      XStd       0  ZIM$KFINDN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIB$ERR
 yes     yes           XStd      0 ZIG$DBPFD
 yes     yes           XStd      0 ZIP$DBPR2
         yes           XStd      0 ZIM$KCURR
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:26   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:27   


       61        1        /*M*     ZIM$KFIND - find useing alternate key     */
       62        2        /*T***********************************************************/
       63        3        /*T*                                                         */
       64        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       65        5        /*T*                                                         */
       66        6        /*T***********************************************************/
       67        7        ZIM$KFIND: PROC ALTRET

      7  1 000000   000000 700200 xent  ZIM$KFIND    TSX0  ! X66_AUTO_0
         1 000001   000120 000000                    ZERO    80,0

       68        8        /*          USE($PR5 FOR GLOBAL$)              */
       69        9               AVOID($PR5,$PR6,$PR7);
       70       10        %INCLUDE ZI$GLOBAL;
       71      496            %GLOBALS;
       72      804        %INCLUDE ZI$DBCB;
       73     1446            %DBCB;
       74     1924            %AWS;
       75     1964            %SETWS;
       76     1983            %RECVAR;
       77     2017        %INCLUDE ZI$SSS;
       78     2566            %AC;
       79     2661            %SC;
       80     2688            %SC1;
       81     2698            %RC;
       82     2730        %INCLUDE ZI_ERRORS_C;
       83     3056        %INCLUDE CP_6;
       84     3137            %FPT_PRECORD(FPTN=FPT$PREC,STCLASS=BASED);
       85     3158            %B$TCB;
       86     3161            %B$ALT;
       87     3169        %INCLUDE B_ERRORS_C;
       88     4296        %INCLUDE CP_6_SUBS;
       89     4836    1   DCL ZIG$DBPFD ENTRY ALTRET;
       90     4837    1   DCL ZIP$DBPR2 ENTRY ALTRET;
       91     4838    1   DCL ZIM$KCURR ENTRY;
       92     4839    1   DCL B$TCB$ PTR SYMREF;
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:28   
       93     4840    1   DCL OLDKEY CHAR(248);
       94     4841    1   DCL DBKY SBIN(36);
       95     4842    1   DCL CDBKY REDEF DBKY CHAR(4);
       96     4843    1   DCL FOUND SBIN(36);
       97     4844    1   DCL ERROR UBIN(36);
       98     4845    1   DCL RVI$ PTR;
       99     4846    1   DCL FUNCT SBIN(36);
      100     4847    1       FUNCT=1;

   4847  1 000002   000001 235007                    LDA     1,DL
         1 000003   200115 755100                    STA     FUNCT,,AUTO

      101     4848    1       GOTO XNI;

   4848  1 000004   000016 710000 1                  TRA     XNI

      102     4849    1   ZIM$KFINDF: ENTRY ALTRET;

   4849  1 000005   000000 700200 xent  ZIM$KFINDF   TSX0  ! X66_AUTO_0
         1 000006   000120 000000                    ZERO    80,0

      103     4850    1       FUNCT=2;

   4850  1 000007   000002 235007                    LDA     2,DL
         1 000010   200115 755100                    STA     FUNCT,,AUTO

      104     4851    1       GOTO XNI;

   4851  1 000011   000016 710000 1                  TRA     XNI

      105     4852    1   ZIM$KFINDN: ENTRY ALTRET;

   4852  1 000012   000000 700200 xent  ZIM$KFINDN   TSX0  ! X66_AUTO_0
         1 000013   000120 000000                    ZERO    80,0

      106     4853    1       FUNCT=3;

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:29   
   4853  1 000014   000003 235007                    LDA     3,DL
         1 000015   200115 755100                    STA     FUNCT,,AUTO

      107     4854    1   XNI: DBCB$=GLOBAL.ACTIVE.DBCB$;

   4854  1 000016   000000 470400 xsym  XNI          LDP0    GLOBAL$
         1 000017   000001 236100                    LDQ     1,,PR0
         1 000020   200003 756100                    STQ     DBCB$,,AUTO

      108     4855    1       SSS$=GLOBAL.ACTIVE.SSS$;

   4855  1 000021   000000 236100                    LDQ     0,,PR0
         1 000022   200006 756100                    STQ     SSS$,,AUTO

      109     4856    1       RVI$=PINCRW(DBCB$,DBCB.PCB.RVI);

   4856  1 000023   200003 471500                    LDP1    DBCB$,,AUTO
         1 000024   100510 220100                    LDX0    328,,PR1
         1 000025   000000 636010                    EAQ     0,X0
         1 000026   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000027   200114 756100                    STQ     RVI$,,AUTO

      110     4857    1       AC$=PINCRW(SSS$,RVI$->RECVAR.ACPTR);

   4857  1 000030   200114 473500                    LDP3    RVI$,,AUTO
         1 000031   300005 221100                    LDX1    5,,PR3
         1 000032   000000 636011                    EAQ     0,X1
         1 000033   200006 036100                    ADLQ    SSS$,,AUTO
         1 000034   200007 756100                    STQ     AC$,,AUTO

      111     4858    1       AWS$=PINCRW(DBCB$,AC.WSOF);

   4858  1 000035   200007 474500                    LDP4    AC$,,AUTO
         1 000036   400003 222100                    LDX2    3,,PR4
         1 000037   000000 636012                    EAQ     0,X2
         1 000040   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000041   200004 756100                    STQ     AWS$,,AUTO
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:30   

      112     4859    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);

   4859  1 000042   100520 223100                    LDX3    336,,PR1
         1 000043   000000 636013                    EAQ     0,X3
         1 000044   200006 036100                    ADLQ    SSS$,,AUTO
         1 000045   200010 756100                    STQ     SC$,,AUTO

      113     4860    1       SETWS$=PINCRW(DBCB$,SC.SCWSO);

   4860  1 000046   200010 470500                    LDP0    SC$,,AUTO
         1 000047   000001 224100                    LDX4    1,,PR0
         1 000050   000000 636014                    EAQ     0,X4
         1 000051   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000052   200005 756100                    STQ     SETWS$,,AUTO

      114     4861    1       SC1$=PINCRW(SC$,-SIZEW(SC1));

   4861  1 000053   200010 236100                    LDQ     SC$,,AUTO
         1 000054   777776 036003                    ADLQ    -2,DU
         1 000055   200011 756100                    STQ     SC1$,,AUTO

      115     4862    1       IF AWS.DDCB=0 THEN GOTO DBUNA; /* IDS AREA NOT READIED */

   4862  1 000056   200004 470500                    LDP0    AWS$,,AUTO
         1 000057   000006 224100                    LDX4    6,,PR0
         1 000060   000441 600000 1                  TZE     DBUNA

      116     4863    1       GLOBAL.PREC$->FPT$PREC.V.DCB#=AWS.KDCB;

   4863  1 000061   000000 470400 xsym               LDP0    GLOBAL$
         1 000062   005102 471500                    LDP1    2626,,PR0
         1 000063   200004 470500                    LDP0    AWS$,,AUTO
         1 000064   000006 720100                    LXL0    6,,PR0
         1 000065   100006 740100                    STX0    6,,PR1

      117     4864        /*       Clear garbage from larger local key     */
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:31   
      118     4865    1       DBKY=0;

   4865  1 000066   200111 450100                    STZ     DBKY,,AUTO

      119     4866    2       DO CASE(FUNCT);

   4866  1 000067   000004 115007                    CMPA    4,DL
         1 000070   000072 602005 1                  TNC     s:4866+3,AL
         1 000071   000153 710000 1                  TRA     s:4884
         1 000072   000153 710000 1                  TRA     s:4884
         1 000073   000076 710000 1                  TRA     s:4868
         1 000074   000117 710000 1                  TRA     s:4873
         1 000075   000131 710000 1                  TRA     s:4877

      120     4867    2       CASE(1); /* ZIM$KFIND */

      121     4868    2           OLDKEY=SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG);

   4868  1 000076   200011 471500                    LDP1    SC1$,,AUTO
         1 000077   100000 720100                    LXL0    0,,PR1
         1 000100   000000 470400 xsym               LDP0    GLOBAL$
         1 000101   040100 100540                    MLR     fill='040'O
         1 000102   004624 600010                    ADSC9   2452,,PR0                cn=3,n=*X0
         1 000103   200013 000370                    ADSC9   OLDKEY,,AUTO             cn=0,n=248

      122     4869    2           GLOBAL.SKEY.LENGTH=2+SC1.KLNG; /* No local DBK */

   4869  1 000104   100000 236100                    LDQ     0,,PR1
         1 000105   777777 376007                    ANQ     -1,DL
         1 000106   000002 036007                    ADLQ    2,DL
         1 000107   000033 736000                    QLS     27
         1 000110   004624 552140                    STBQ    2452,'40'O,PR0

      123     4870    2           GLOBAL.SKEY.IXID=SC1.IXID;

   4870  1 000111   100000 236100                    LDQ     0,,PR1
         1 000112   000011 772000                    QRL     9
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:32   
         1 000113   004624 552130                    STBQ    2452,'30'O,PR0

      124     4871    2           GLOBAL.PREC$->FPT$PREC.V.N#=0;

   4871  1 000114   005102 471500                    LDP1    2626,,PR0
         1 000115   100007 450100                    STZ     7,,PR1
         1 000116   000153 710000 1                  TRA     s:4884

      125     4872    2       CASE(2); /* ZIM$KFINDF */

      126     4873    2           GLOBAL.SKEY.LENGTH=2; /* Only IXID is known */

   4873  1 000117   000000 471400 xsym               LDP1    GLOBAL$
         1 000120   002000 236003                    LDQ     1024,DU
         1 000121   104624 552140                    STBQ    2452,'40'O,PR1

      127     4874    2           GLOBAL.SKEY.IXID=SC1.IXID;

   4874  1 000122   200011 470500                    LDP0    SC1$,,AUTO
         1 000123   000000 236100                    LDQ     0,,PR0
         1 000124   000011 772000                    QRL     9
         1 000125   104624 552130                    STBQ    2452,'30'O,PR1

      128     4875    2           GLOBAL.PREC$->FPT$PREC.V.N#=0;

   4875  1 000126   105102 470500                    LDP0    2626,,PR1
         1 000127   000007 450100                    STZ     7,,PR0
         1 000130   000153 710000 1                  TRA     s:4884

      129     4876    2       CASE(3); /* ZIM$KFINDN */

      130     4877    2           GLOBAL.KEY.LENGTH=SETWS.KEY.LENGTH;

   4877  1 000131   200005 471500                    LDP1    SETWS$,,AUTO
         1 000132   000000 470400 xsym               LDP0    GLOBAL$
         1 000133   100002 236100                    LDQ     2,,PR1
         1 000134   004624 552140                    STBQ    2452,'40'O,PR0
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:33   

      131     4878    2           GLOBAL.KEY.VALUE=SETWS.KEY.VALUE;

   4878  1 000135   100002 236100                    LDQ     2,,PR1
         1 000136   000033 772000                    QRL     27
         1 000137   000000 620006                    EAX0    0,QL
         1 000140   040100 100540                    MLR     fill='040'O
         1 000141   100002 200010                    ADSC9   2,,PR1                   cn=1,n=*X0
         1 000142   004624 200377                    ADSC9   2452,,PR0                cn=1,n=255

      132     4879    2           IF SETWS.PRIV.CSE THEN

   4879  1 000143   100000 234100                    SZN     0,,PR1
         1 000144   000150 605000 1                  TPL     s:4882

      133     4880    2               GLOBAL.PREC$->FPT$PREC.V.N#=0;

   4880  1 000145   005102 471500                    LDP1    2626,,PR0
         1 000146   100007 450100                    STZ     7,,PR1
         1 000147   000153 710000 1                  TRA     s:4884

      134     4881    2           ELSE
      135     4882    2               GLOBAL.PREC$->FPT$PREC.V.N#=1;

   4882  1 000150   005102 471500                    LDP1    2626,,PR0
         1 000151   000001 236007                    LDQ     1,DL
         1 000152   100007 756100                    STQ     7,,PR1

      136     4883    2           END;

      137     4884    1       FOUND=0;

   4884  1 000153   200112 450100                    STZ     FOUND,,AUTO

      138     4885    2       DO WHILE (FOUND=0);

   4885  1 000154   200112 236100                    LDQ     FOUND,,AUTO
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:34   
         1 000155   000310 601000 1                  TNZ     s:4928

      139     4886    2           CALL M$PRECORD(GLOBAL.PREC$->FPT$PREC) ALTRET(NOKEY1);

   4886  1 000156   000000 470400 xsym               LDP0    GLOBAL$
         1 000157   005102 471500                    LDP1    2626,,PR0
         1 000160   100000 630500                    EPPR0   0,,PR1
         1 000161   440003 713400                    CLIMB   alt,+16387
         1 000162   401000 401760                    pmme    nvectors=3
         1 000163   000365 702000 1                  TSX2    NOKEY1

      140     4887    2   PCOMP:  GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;

   4887  1 000164   000000 470400 xsym  PCOMP        LDP0    GLOBAL$
         1 000165   001425 235100                    LDA     789,,PR0
         1 000166   000001 035007                    ADLA    1,DL
         1 000167   001425 755100                    STA     789,,PR0

      141     4888    2           IF GLOBAL.SKEY.LENGTH=0 OR

   4888  1 000170   004624 236100                    LDQ     2452,,PR0
         1 000171   777000 316003                    CANQ    -512,DU
         1 000172   000436 600000 1                  TZE     ER_EOSR
         1 000173   200011 471500                    LDP1    SC1$,,AUTO
         1 000174   100000 236100                    LDQ     0,,PR1
         1 000175   000022 772000                    QRL     18
         1 000176   200116 756100                    STQ     FUNCT+1,,AUTO
         1 000177   004624 236100                    LDQ     2452,,PR0
         1 000200   000011 772000                    QRL     9
         1 000201   777777 376007                    ANQ     -1,DL
         1 000202   200116 116100                    CMPQ    FUNCT+1,,AUTO
         1 000203   000436 601000 1                  TNZ     ER_EOSR

      142     4889    2              GLOBAL.SKEY.IXID~=SC1.IXID THEN
      143     4890    2               GOTO ER_EOSR;
      144     4891    2           GLOBAL.PREC$->FPT$PREC.V.N#=1;

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:35   
   4891  1 000204   005102 473500                    LDP3    2626,,PR0
         1 000205   000001 235007                    LDA     1,DL
         1 000206   300007 755100                    STA     7,,PR3

      145     4892    2           CALL INSERT(CDBKY,4-AC.BPLDBK,AC.BPLDBK,

   4892  1 000207   100000 236100                    LDQ     0,,PR1
         1 000210   777777 376007                    ANQ     -1,DL
         1 000211   200007 473500                    LDP3    AC$,,AUTO
         1 000212   300015 220100                    LDX0    13,,PR3
         1 000213   200116 756100                    STQ     FUNCT+1,,AUTO
         1 000214   300015 236100                    LDQ     13,,PR3
         1 000215   000022 772000                    QRL     18
         1 000216   300015 221100                    LDX1    13,,PR3
         1 000217   000001 676000 2                  ERQ     1
         1 000220   000001 036007                    ADLQ    1,DL
         1 000221   200116 235100                    LDA     FUNCT+1,,AUTO
         1 000222   040146 100545                    MLR     fill='040'O
         1 000223   004624 600010                    ADSC9   2452,A,PR0               cn=3,n=*X0
         1 000224   200112 000011                    ADSC9   FOUND,Q,AUTO             cn=0,n=*X1

      146     4893    2              SUBSTR(GLOBAL.SKEY.VALUE,SC1.KLNG,AC.BPLDBK));
      147     4894    2           RVI$->RECVAR.DBKEY=DBKY+AC.ABAS;

   4894  1 000225   200111 236100                    LDQ     DBKY,,AUTO
         1 000226   300002 036100                    ADLQ    2,,PR3
         1 000227   200114 474500                    LDP4    RVI$,,AUTO
         1 000230   400000 756100                    STQ     0,,PR4

      148     4895                %DBCAL(NAME=ZIG$DBPFD,EXC=EX_PFD,ALT=ER_PFD);

   4899  1 000231   000002 631400 2                  EPPR1   2
         1 000232   000000 701000 xent               TSX1    ZIG$DBPFD
         1 000233   000451 702000 1                  TSX2    ER_PFD

   4900  1 000234   000000 470400 xsym               LDP0    GLOBAL$
         1 000235   000006 235100                    LDA     6,,PR0
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:36   
         1 000236   000241 600000 1                  TZE     s:4911

   4905  1 000237   000006 450100                    STZ     6,,PR0

   4906  1 000240   000374 710000 1                  TRA     EX_PFD

      149     4911    2           IF RVI$->RECVAR.RTP.CONTROL.LD='1'B THEN

   4911  1 000241   200114 471500                    LDP1    RVI$,,AUTO
         1 000242   100003 236100                    LDQ     3,,PR1
         1 000243   100000 316007                    CANQ    32768,DL
         1 000244   000444 601000 1                  TNZ     ER_XLD

      150     4912    2               GOTO ER_XLD; /* Error if logically deleted */
      151     4913    3           IF DBCB.PCB.PRRC=0 THEN DO;

   4913  1 000245   200003 473500                    LDP3    DBCB$,,AUTO
         1 000246   300517 220100                    LDX0    335,,PR3
         1 000247   000274 601000 1                  TNZ     s:4923

      152     4914    3               GLOBAL.PARAN.DBPR2.TYPE=RVI$->RECVAR.RTP.TYPE;

   4914  1 000250   100003 721100                    LXL1    3,,PR1
         1 000251   007777 361003                    ANX1    4095,DU
         1 000252   000041 741100                    STX1    33,,PR0

      153     4915    3               GLOBAL.PARAN.DBPR2.SC=DBCB.PCB.PRSC;

   4915  1 000253   300520 220100                    LDX0    336,,PR3
         1 000254   000041 440100                    SXL0    33,,PR0

      154     4916    3               CALL ZIP$DBPR2 ALTRET(NEXT);

   4916  1 000255   000002 631400 2                  EPPR1   2
         1 000256   000000 701000 xent               TSX1    ZIP$DBPR2
         1 000257   000306 702000 1                  TSX2    NEXT

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:37   
      155     4917    3               RC$=PINCRW(SSS$,GLOBAL.PARAN.DBPR2.RC);

   4917  1 000260   000000 470400 xsym               LDP0    GLOBAL$
         1 000261   000042 720100                    LXL0    34,,PR0
         1 000262   000000 636010                    EAQ     0,X0
         1 000263   200006 036100                    ADLQ    SSS$,,AUTO
         1 000264   200012 756100                    STQ     RC$,,AUTO

      156     4918    3               IF NOT RC.DEF.SR THEN

   4918  1 000265   200012 471500                    LDP1    RC$,,AUTO
         1 000266   100000 236100                    LDQ     0,,PR1
         1 000267   100000 316007                    CANQ    32768,DL
         1 000270   000306 601000 1                  TNZ     NEXT

      157     4919    3                   FOUND=1;

   4919  1 000271   000001 235007                    LDA     1,DL
         1 000272   200112 755100                    STA     FOUND,,AUTO

      158     4920    3               END;

   4920  1 000273   000306 710000 1                  TRA     NEXT

      159     4921    2           ELSE
      160     4922    3           DO;

      161     4923    3               RC$=PINCRW(SSS$,DBCB.PCB.PRRC);

   4923  1 000274   000000 636010                    EAQ     0,X0
         1 000275   200006 036100                    ADLQ    SSS$,,AUTO
         1 000276   200012 756100                    STQ     RC$,,AUTO

      162     4924    3               IF RVI$->RECVAR.RTP.TYPE=RC.RTYP THEN

   4924  1 000277   200012 474500                    LDP4    RC$,,AUTO
         1 000300   100003 236100                    LDQ     3,,PR1
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:38   
         1 000301   400003 676100                    ERQ     3,,PR4
         1 000302   007777 376007                    ANQ     4095,DL
         1 000303   000306 601000 1                  TNZ     NEXT

      163     4925    3                   FOUND=1;

   4925  1 000304   000001 236007                    LDQ     1,DL
         1 000305   200112 756100                    STQ     FOUND,,AUTO

      164     4926    3               END;

      165     4927    2   NEXT:   END;

   4927  1 000306   200112 235100       NEXT         LDA     FOUND,,AUTO
         1 000307   000156 600000 1                  TZE     s:4886

      166     4928    1       IF (RC.DEF.FVR = '0'B AND

   4928  1 000310   200012 470500                    LDP0    RC$,,AUTO
         1 000311   000000 236100                    LDQ     0,,PR0
         1 000312   040000 316007                    CANQ    16384,DL
         1 000313   000320 601000 1                  TNZ     s:4928+8
         1 000314   000003 220100                    LDX0    3,,PR0
         1 000315   200114 471500                    LDP1    RVI$,,AUTO
         1 000316   100003 100100                    CMPX0   3,,PR1
         1 000317   000447 601000 1                  TNZ     ER_SIZE
         1 000320   040000 316007                    CANQ    16384,DL
         1 000321   000326 600000 1                  TZE     s:4933
         1 000322   000003 220100                    LDX0    3,,PR0
         1 000323   200114 471500                    LDP1    RVI$,,AUTO
         1 000324   100003 100100                    CMPX0   3,,PR1
         1 000325   000447 602000 1                  TNC     ER_SIZE

      167     4929    1          RC.RSIZ ~= RVI$->RECVAR.RECSZ)
      168     4930    1          OR (RC.DEF.FVR = '1'B AND
      169     4931    1          RC.RSIZ < RVI$ -> RECVAR.RECSZ) THEN
      170     4932    1           GOTO ER_SIZE;
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:39   
      171     4933    1       RVI$->RECVAR.RCPTR=POFFW(RC$,SSS$);

   4933  1 000326   200006 235100                    LDA     SSS$,,AUTO
         1 000327   000022 771000                    ARL     18
         1 000330   200116 755100                    STA     FUNCT+1,,AUTO
         1 000331   200012 236100                    LDQ     RC$,,AUTO
         1 000332   000022 772000                    QRL     18
         1 000333   200116 136100                    SBLQ    FUNCT+1,,AUTO
         1 000334   000000 620006                    EAX0    0,QL
         1 000335   200114 471500                    LDP1    RVI$,,AUTO
         1 000336   100006 740100                    STX0    6,,PR1

      172     4934    1       FOUND=DBCB.PCB.RVI;

   4934  1 000337   200003 473500                    LDP3    DBCB$,,AUTO
         1 000340   300510 236100                    LDQ     328,,PR3
         1 000341   000022 772000                    QRL     18
         1 000342   200112 756100                    STQ     FOUND,,AUTO

      173     4935    1       DBCB.PCB.RVI=DBCB.PCB.RVO;

   4935  1 000343   300511 221100                    LDX1    329,,PR3
         1 000344   300510 741100                    STX1    328,,PR3

      174     4936    1       DBCB.PCB.RVO=FOUND;

   4936  1 000345   000000 620006                    EAX0    0,QL
         1 000346   300511 740100                    STX0    329,,PR3

      175     4937    1       CALL ZIM$KCURR;

   4937  1 000347   000002 631400 2                  EPPR1   2
         1 000350   000000 701000 xent               TSX1    ZIM$KCURR
         1 000351   000000 011000                    NOP     0

      176     4938    1       IF FUNCT=1 AND

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:40   
   4938  1 000352   200115 235100                    LDA     FUNCT,,AUTO
         1 000353   000001 115007                    CMPA    1,DL
         1 000354   000364 601000 1                  TNZ     s:4941
         1 000355   200011 470500                    LDP0    SC1$,,AUTO
         1 000356   000000 720100                    LXL0    0,,PR0
         1 000357   000000 471400 xsym               LDP1    GLOBAL$
         1 000360   040100 106540                    CMPC    fill='040'O
         1 000361   104624 600010                    ADSC9   2452,,PR1                cn=3,n=*X0
         1 000362   200013 000370                    ADSC9   OLDKEY,,AUTO             cn=0,n=248
         1 000363   000432 601000 1                  TNZ     EX_PCOMP

      177     4939    1          SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG)~=OLDKEY THEN
      178     4940    1           GOTO EX_PCOMP;
      179     4941    1       RETURN;

   4941  1 000364   000000 702200 xent               TSX2  ! X66_ARET

      180     4942        %EJECT;
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:41   
      181     4943    1   NOKEY1: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN

   4943  1 000365   000000 470400 xsym  NOKEY1       LDP0    B$TCB$
         1 000366   000000 471500                    LDP1    0,,PR0
         1 000367   100102 236100                    LDQ     66,,PR1
         1 000370   377770 376007                    ANQ     131064,DL
         1 000371   001020 116007                    CMPQ    528,DL
         1 000372   000164 600000 1                  TZE     PCOMP

      182     4944    1           GOTO PCOMP;
      183     4945    1       GOTO ER_UNEX;

   4945  1 000373   000421 710000 1                  TRA     ER_UNEX

      184     4946    1   EX_PFD: GLOBAL.PREC$->FPT$PREC.V.N#=0; /* Try same key */

   4946  1 000374   005102 471500       EX_PFD       LDP1    2626,,PR0
         1 000375   100007 450100                    STZ     7,,PR1

      185     4947    1       CALL M$PRECORD(GLOBAL.PREC$->FPT$PREC) ALTRET(NOKEY2);

   4947  1 000376   005102 471500                    LDP1    2626,,PR0
         1 000377   100000 630500                    EPPR0   0,,PR1
         1 000400   440003 713400                    CLIMB   alt,+16387
         1 000401   401000 401760                    pmme    nvectors=3
         1 000402   000406 702000 1                  TSX2    NOKEY2

      186     4948    1       ERROR=ERR#IX#XPD;

   4948  1 000403   303421 235007                    LDA     100113,DL
         1 000404   200113 755100                    STA     ERROR,,AUTO

      187     4949    1       GOTO ALT;

   4949  1 000405   000451 710000 1                  TRA     ER_PFD

      188     4950    1   NOKEY2: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$NOKEY THEN
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:42   

   4950  1 000406   000000 470400 xsym  NOKEY2       LDP0    B$TCB$
         1 000407   000000 471500                    LDP1    0,,PR0
         1 000410   100102 236100                    LDQ     66,,PR1
         1 000411   377770 376007                    ANQ     131064,DL
         1 000412   001020 116007                    CMPQ    528,DL
         1 000413   000421 601000 1                  TNZ     ER_UNEX

      189     4951    2       DO;

      190     4952    2           GLOBAL.PREC$->FPT$PREC.V.N#=1; /* Back to one */

   4952  1 000414   000000 473400 xsym               LDP3    GLOBAL$
         1 000415   305102 474500                    LDP4    2626,,PR3
         1 000416   000001 235007                    LDA     1,DL
         1 000417   400007 755100                    STA     7,,PR4

      191     4953    2           GOTO NEXT;

   4953  1 000420   000306 710000 1                  TRA     NEXT

      192     4954    2           END;
      193     4955    1   ER_UNEX: ERROR=ERR#IX#UNEX;

   4955  1 000421   303423 235007       ER_UNEX      LDA     100115,DL
         1 000422   200113 755100                    STA     ERROR,,AUTO

      194     4956    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4956  1 000423   100102 236100                    LDQ     66,,PR1
         1 000424   000000 473400 xsym               LDP3    GLOBAL$
         1 000425   300007 756100                    STQ     7,,PR3

      195     4957    1       GLOBAL.RET.DCB#=GLOBAL.PREC$->FPT$PREC.V.DCB#;

   4957  1 000426   305102 471500                    LDP1    2626,,PR3
         1 000427   100006 220100                    LDX0    6,,PR1
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:43   
         1 000430   300014 740100                    STX0    12,,PR3

      196     4958    1       GOTO ALT;

   4958  1 000431   000451 710000 1                  TRA     ER_PFD

      197     4959    1   EX_PCOMP: ERROR=EXC#PCOMP;

   4959  1 000432   004541 236007       EX_PCOMP     LDQ     2401,DL
         1 000433   200113 756100                    STQ     ERROR,,AUTO

      198     4960            %DBEXC;

   4961  1 000434   100006 756100                    STQ     6,,PR1

   4962  1 000435   000000 702200 xent               TSX2  ! X66_ARET

      199     4964    1   ER_EOSR: ERROR=EXC#EOSR;

   4964  1 000436   004064 236007       ER_EOSR      LDQ     2100,DL
         1 000437   200113 756100                    STQ     ERROR,,AUTO

      200     4965    1       GOTO ALT;

   4965  1 000440   000451 710000 1                  TRA     ER_PFD

      201     4966    1   DBUNA: ERROR=EXC#UNA;

   4966  1 000441   004230 235007       DBUNA        LDA     2200,DL
         1 000442   200113 755100                    STA     ERROR,,AUTO

      202     4967    1       GOTO ALT;

   4967  1 000443   000451 710000 1                  TRA     ER_PFD

      203     4968    1   ER_XLD: ERROR=ERR#IX#XLD;

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:44   
   4968  1 000444   303420 235007       ER_XLD       LDA     100112,DL
         1 000445   200113 755100                    STA     ERROR,,AUTO

      204     4969    1       GOTO ALT;

   4969  1 000446   000451 710000 1                  TRA     ER_PFD

      205     4970    1   ER_SIZE: ERROR=ERR#CM#RSZER;

   4970  1 000447   210574 235007       ER_SIZE      LDA     70012,DL
         1 000450   200113 755100                    STA     ERROR,,AUTO

   4961  1 000451                       ER_PFD       null
   4961  1 000451                       ALT          null
      206     4971    1   ER_PFD: ;
      207     4972    1   ALT: ;
      208     4973            %DBALT;

   4974  1 000451   000000 470400 xsym               LDP0    GLOBAL$
         1 000452   000006 235100                    LDA     6,,PR0
         1 000453   000462 601000 1                  TNZ     s:4982

   4976  1 000454   000010 450100                    STZ     8,,PR0

   4977  1 000455   000012 450100                    STZ     10,,PR0

   4978  1 000456   000013 450100                    STZ     11,,PR0

   4979  1 000457   000011 450100                    STZ     9,,PR0

   4980  1 000460   200113 236100                    LDQ     ERROR,,AUTO
         1 000461   000006 756100                    STQ     6,,PR0

   4982  1 000462   000006 235100                    LDA     6,,PR0
         1 000463   303240 115007                    CMPA    100000,DL
         1 000464   000466 603000 1                  TRC     s:4985

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:45   
   4983  1 000465   000000 702200 xent               TSX2  ! X66_AALT

   4985  1 000466   000002 631400 2                  EPPR1   2
         1 000467   000000 701000 xent               TSX1    ZIB$ERR
         1 000470   000000 011000                    NOP     0

      209     4987    1   END ZIM$KFIND;

   4987  1 000471   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 006014   777777 777777   000000 000000                    ............
      210     4988        %EOD;

PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:46   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$KFIND.

   Procedure ZIM$KFIND requires 314 words for executable code.
   Procedure ZIM$KFIND requires 80 words of local(AUTO) storage.
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:47   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:48   
          MINI XREF LISTING

AC.ABAS
      2589**DCL      4894>>ASSIGN
AC.BPLDBK
      2615**DCL      4892>>CALLBLT  4892>>CALLBLT  4892>>CALLBLT
AC.DEF.ANL
      2586**DCL      2657--IMP-SIZ
AC.DEF.FORG
      2573**DCL      2577--REDEF
AC.WSOF
      2590**DCL      4858>>ASSIGN
AC$
      2569**DCL      2570--IMP-PTR  4857<<ASSIGN   4858>>ASSIGN   4892>>CALLBLT  4892>>CALLBLT  4892>>CALLBLT
      4894>>ASSIGN
ALT
      4961**LABEL    4949--GOTO     4958--GOTO     4965--GOTO     4967--GOTO     4969--GOTO
AWS.DDCB
      1951**DCL      4862>>IF
AWS.KDCB
      1952**DCL      4863>>ASSIGN
AWS$
      1925**DCL      1926--IMP-PTR  4858<<ASSIGN   4862>>IF       4863>>ASSIGN
B$ALT.CODE
      3163**DCL      3163--REDEF    3164--REDEF    3164--REDEF
B$ALT.ERR
      3164**DCL      4956>>ASSIGN
B$ALT.ERR.ERR#
      3165**DCL      3165--REDEF    4943>>IF       4950>>IF
B$ALT.EVID
      3164**DCL      3164--REDEF    3164--REDEF
B$TCB.ALT$
      3159**DCL      4943>>IF       4950>>IF       4956>>ASSIGN
B$TCB$
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:49   
      4839**DCL      4943>>IF       4950>>IF       4956>>ASSIGN
CDBKY
      4842**DCL      4892<<CALLBLT
DBCB.IOWS.CFCT
      1876**DCL      1877--REDEF
DBCB.IOWS.DBKF.RQ
      1819**DCL      1820--REDEF
DBCB.IOWS.DBKR
      1816**DCL      1817--REDEF
DBCB.IOWS.NOBF
      1878**DCL      1879--REDEF
DBCB.IOWS.SPND
      1804**DCL      1805--REDEF
DBCB.PCB.PRRC
      1663**DCL      4913>>IF       4923>>ASSIGN
DBCB.PCB.PRSC
      1665**DCL      4859>>ASSIGN   4915>>ASSIGN
DBCB.PCB.RVI
      1652**DCL      4856>>ASSIGN   4934>>ASSIGN   4935<<ASSIGN
DBCB.PCB.RVO
      1654**DCL      4935>>ASSIGN   4936<<ASSIGN
DBCB.SWS.RDYCW
      1542**DCL      1543--REDEF
DBCB.SWS.TEMP.PTR1$
      1576**DCL      1577--REDEF    1578--REDEF
DBCB.SWS.TEMP.PTR2$
      1579**DCL      1580--REDEF
DBCB$
      1447**DCL      1448--IMP-PTR  4854<<ASSIGN   4856>>ASSIGN   4856>>ASSIGN   4858>>ASSIGN   4859>>ASSIGN
      4860>>ASSIGN   4913>>IF       4915>>ASSIGN   4923>>ASSIGN   4934>>ASSIGN   4935>>ASSIGN   4935>>ASSIGN
      4936>>ASSIGN
DBKY
      4841**DCL      4842--REDEF    4865<<ASSIGN   4894>>ASSIGN
DBUNA
      4966**LABEL    4862--GOTO
ERROR
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:50   
      4844**DCL      4948<<ASSIGN   4955<<ASSIGN   4959<<ASSIGN   4961>>ASSIGN   4964<<ASSIGN   4966<<ASSIGN
      4968<<ASSIGN   4970<<ASSIGN   4980>>ASSIGN
ER_EOSR
      4964**LABEL    4890--GOTO
ER_PFD
      4961**LABEL    4899--CALLALT
ER_SIZE
      4970**LABEL    4932--GOTO
ER_UNEX
      4955**LABEL    4945--GOTO
ER_XLD
      4968**LABEL    4912--GOTO
EX_PCOMP
      4959**LABEL    4940--GOTO
EX_PFD
      4946**LABEL    4906--GOTO
FOUND
      4843**DCL      4884<<ASSIGN   4885>>DOWHILE  4919<<ASSIGN   4925<<ASSIGN   4934<<ASSIGN   4936>>ASSIGN
FPT$PREC
      3148**DCL      4886<>CALL     4947<>CALL
FPT$PREC.V.DCB#
      3150**DCL      4863<<ASSIGN   4957>>ASSIGN
FPT$PREC.V.N#
      3154**DCL      4871<<ASSIGN   4875<<ASSIGN   4880<<ASSIGN   4882<<ASSIGN   4891<<ASSIGN   4946<<ASSIGN
      4952<<ASSIGN
FUNCT
      4846**DCL      4847<<ASSIGN   4850<<ASSIGN   4853<<ASSIGN   4866>>DOCASE   4938>>IF
GLOBAL.ACTIVE.DBCB$
       503**DCL       504--REDEF    4854>>ASSIGN
GLOBAL.ACTIVE.SSS$
       499**DCL       500--REDEF    4855>>ASSIGN
GLOBAL.KEY
       707**DCL       710--REDEF
GLOBAL.KEY.LENGTH
       708**DCL      4877<<ASSIGN
GLOBAL.KEY.VALUE
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:51   
       709**DCL      4878<<ASSIGN
GLOBAL.PARAN.DBPR2.RC
       570**DCL      4917>>ASSIGN
GLOBAL.PARAN.DBPR2.SC
       568**DCL      4915<<ASSIGN
GLOBAL.PARAN.DBPR2.TYPE
       567**DCL      4914<<ASSIGN
GLOBAL.PARAN.TRACE.MODE
       582**DCL       589--REDEF
GLOBAL.PREC$
       766**DCL      4863>>ASSIGN   4871>>ASSIGN   4875>>ASSIGN   4880>>ASSIGN   4882>>ASSIGN   4886>>CALL
      4891>>ASSIGN   4946>>ASSIGN   4947>>CALL     4952>>ASSIGN   4957>>ASSIGN
GLOBAL.PRINTBUF.BUFFER
       741**DCL       742--REDEF     743--REDEF     744--REDEF
GLOBAL.PRINTBUF.ERR.V
       746**DCL       749--REDEF     750--REDEF     751--REDEF
GLOBAL.RET.AC#
       519**DCL      4976<<ASSIGN
GLOBAL.RET.DCB#
       523**DCL      4957<<ASSIGN
GLOBAL.RET.ERROR#
       517**DCL      4900>>IF       4905<<ASSIGN   4961<<ASSIGN   4974>>IF       4980<<ASSIGN   4982>>IF
GLOBAL.RET.FR#
       520**DCL      4979<<ASSIGN
GLOBAL.RET.RC#
       522**DCL      4978<<ASSIGN
GLOBAL.RET.SC#
       521**DCL      4977<<ASSIGN
GLOBAL.RET.SYSERR#
       518**DCL      4956<<ASSIGN
GLOBAL.SKEY.IXID
       712**DCL      4870<<ASSIGN   4874<<ASSIGN   4888>>IF
GLOBAL.SKEY.LENGTH
       711**DCL      4869<<ASSIGN   4873<<ASSIGN   4888>>IF
GLOBAL.SKEY.VALUE
       713**DCL      4868>>ASSIGN   4892>>CALLBLT  4938>>IF
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:52   
GLOBAL.STATS.CURR.READS
       657**DCL      4887<<ASSIGN   4887>>ASSIGN
GLOBAL$
       801**DCL       497--IMP-PTR  4854>>ASSIGN   4855>>ASSIGN   4863>>ASSIGN   4868>>ASSIGN   4869>>ASSIGN
      4870>>ASSIGN   4871>>ASSIGN   4873>>ASSIGN   4874>>ASSIGN   4875>>ASSIGN   4877>>ASSIGN   4878>>ASSIGN
      4880>>ASSIGN   4882>>ASSIGN   4886>>CALL     4887>>ASSIGN   4887>>ASSIGN   4888>>IF       4888>>IF
      4891>>ASSIGN   4892>>CALLBLT  4900>>IF       4905>>ASSIGN   4914>>ASSIGN   4915>>ASSIGN   4917>>ASSIGN
      4938>>IF       4946>>ASSIGN   4947>>CALL     4952>>ASSIGN   4956>>ASSIGN   4957>>ASSIGN   4957>>ASSIGN
      4961>>ASSIGN   4974>>IF       4976>>ASSIGN   4977>>ASSIGN   4978>>ASSIGN   4979>>ASSIGN   4980>>ASSIGN
      4982>>IF
M$PRECORD
      3069**DCL-ENT  4886--CALL     4947--CALL
NEXT
      4927**LABEL    4916--CALLALT  4953--GOTO
NOKEY1
      4943**LABEL    4886--CALLALT
NOKEY2
      4950**LABEL    4947--CALLALT
OLDKEY
      4840**DCL      4868<<ASSIGN   4938>>IF
PCOMP
      4887**LABEL    4944--GOTO
RC.DEF.FVR
      2710**DCL      4928>>IF       4928>>IF
RC.DEF.RNL
      2717**DCL      2727--IMP-SIZ
RC.DEF.SR
      2709**DCL      4918>>IF
RC.RSIZ
      2722**DCL      4928>>IF       4928>>IF
RC.RTYP
      2724**DCL      4924>>IF
RC$
      2701**DCL      2702--IMP-PTR  4917<<ASSIGN   4918>>IF       4923<<ASSIGN   4924>>IF       4928>>IF
      4928>>IF       4928>>IF       4928>>IF       4933>>ASSIGN
RECVAR.ACPTR
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:53   
      2004**DCL      4857>>ASSIGN
RECVAR.BADDR
      1986**DCL      1989--REDEF
RECVAR.DBKEY
      1985**DCL      4894<<ASSIGN
RECVAR.RADDR
      1990**DCL      1994--REDEF
RECVAR.RCPTR
      2006**DCL      4933<<ASSIGN
RECVAR.RECSZ
      1995**DCL      4928>>IF       4928>>IF
RECVAR.RTP.CONTROL.LD
      1999**DCL      4911>>IF
RECVAR.RTP.TYPE
      2001**DCL      4914>>ASSIGN   4924>>IF
RVI$
      4845**DCL      4856<<ASSIGN   4857>>ASSIGN   4894>>ASSIGN   4911>>IF       4914>>ASSIGN   4924>>IF
      4928>>IF       4928>>IF       4933>>ASSIGN
SC.DEF.SNL
      2677**DCL      2682--IMP-SIZ
SC.SCWSO
      2678**DCL      4860>>ASSIGN
SC$
      2664**DCL      2665--IMP-PTR  4859<<ASSIGN   4860>>ASSIGN   4861>>ASSIGN
SC1
      2691**DCL      4861--ASSIGN
SC1.IXID
      2692**DCL      4870>>ASSIGN   4874>>ASSIGN   4888>>IF
SC1.KLNG
      2693**DCL      4868>>ASSIGN   4869>>ASSIGN   4892>>CALLBLT  4938>>IF
SC1$
      2690**DCL      2691--IMP-PTR  4861<<ASSIGN   4868>>ASSIGN   4869>>ASSIGN   4870>>ASSIGN   4874>>ASSIGN
      4888>>IF       4892>>CALLBLT  4938>>IF
SETWS.KEY.LENGTH
      1979**DCL      1980--IMP-SIZ  4877>>ASSIGN   4878>>ASSIGN
SETWS.KEY.VALUE
PL6.E3A0      #002=ZIM$KFIND File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:01 Page:54   
      1980**DCL      4878>>ASSIGN
SETWS.PRIV.CSE
      1968**DCL      4879>>IF
SETWS$
      1965**DCL      1966--IMP-PTR  4860<<ASSIGN   4877>>ASSIGN   4878>>ASSIGN   4878>>ASSIGN   4879>>IF
SSS$
      2024**DCL      4855<<ASSIGN   4857>>ASSIGN   4859>>ASSIGN   4917>>ASSIGN   4923>>ASSIGN   4933>>ASSIGN
XNI
      4854**LABEL    4848--GOTO     4851--GOTO
ZIB$ERR
       802**DCL-ENT  4985--CALL
ZIG$DBPFD
      4836**DCL-ENT  4899--CALL
ZIM$KCURR
      4838**DCL-ENT  4937--CALL
ZIP$DBPR2
      4837**DCL-ENT  4916--CALL

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:55   
      211        1        /*M*     ZIM$KSTO - store alternate key           */
      212        2        /*T***********************************************************/
      213        3        /*T*                                                         */
      214        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      215        5        /*T*                                                         */
      216        6        /*T***********************************************************/
      217        7        ZIM$KSTO: PROC ALTRET
      218        8        /*          USE($PR5 FOR GLOBAL$)              */
      219        9               AVOID($PR5,$PR6,$PR7);
      220       10        %INCLUDE ZI$GLOBAL;
      221      496            %GLOBALS;
      222      804        %INCLUDE ZI$DBCB;
      223     1446            %DBCB;
      224     1924            %RECVAR;
      225     1958            %AWS;
      226     1998        %INCLUDE ZI$SSS;
      227     2547            %AC;
      228     2642            %SC1;
      229     2652            %RS;
      230     2728        %INCLUDE ZI_ERRORS_C;
      231     3054        %INCLUDE CP_6;
      232     3135            %FPT_WRITE(FPTN=FPT$WRTK,STCLASS=BASED);
      233     3166            %FPT_PRECORD(FPTN=FPT$PREC,STCLASS=BASED);
      234     3187            %FPT_OPEN(FPTN=FPT$REOPEN,STCLASS=BASED);
      235     3296            %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      236     3338            %F$DCB;
      237     3395            %B$TCB(STCLASS=BASED);
      238     3398            %B$ALT(STCLASS=BASED);
      239     3406        %INCLUDE B_ERRORS_C;
      240     4533        %INCLUDE CP_6_SUBS;
      241     5073    1   DCL ZIM$JKSTO ENTRY(1);
      242     5074    1   DCL OLDKEY CHAR(248);
      243     5075    1   DCL DBKY UBIN(36);
      244     5076    1   DCL CDBKY REDEF DBKY CHAR(4);
      245     5077    1   DCL ERROR UBIN(36);
      246     5078    1   DCL RVT$ PTR;
      247     5079    1   DCL B$TCB$ PTR SYMREF;
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:56   
      248     5080    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
      249     5081    1       SSS$=GLOBAL.ACTIVE.SSS$;
      250     5082    1       RVT$=PINCRW(DBCB$,DBCB.PCB.RVT);
      251     5083    1       AC$=PINCRW(SSS$,RVT$->RECVAR.ACPTR);
      252     5084    1       AWS$=PINCRW(DBCB$,AC.WSOF);
      253     5085        /*       If load mode return without processing */
      254     5086    1       IF AWS.ATRIB.LOAD THEN
      255     5087    1           RETURN;
      256     5088    1       RS$=PINCRW(SSS$,DBCB.PWS.XPRS); /*Prss */
      257     5089    1       SC1$=PINCRW(SSS$,RS.SCRSH-2);
      258     5090    1       OLDKEY=SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG);
      259     5091    2       IF RS.DEF.DORD=2 THEN DO;
      260     5092        /*          No duplicates are allowed          */
      261     5093    2           GLOBAL.SKEY.LENGTH=SC1.KLNG+2; /* No local key */
      262     5094    2           GLOBAL.SKEY.IXID=SC1.IXID;
      263     5095    2           GLOBAL.PREC$->FPT$PREC.V.DCB#=AWS.KDCB;
      264     5096    2           GLOBAL.PREC$->FPT$PREC.V.N#=0;
      265     5097    2           CALL M$PRECORD(GLOBAL.PREC$->FPT$PREC) ALTRET(CHECK);
      266     5098    2           GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;
      267     5099    2           GOTO ER_BADKEY;
      268     5100        /*          Key must not exist                 */
      269     5101    2   CHECK:  IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$NOKEY THEN
      270     5102    2               GOTO ER_PREC;
      271     5103        /*          Check for duplicate key value      */
      272     5104    2           IF GLOBAL.SKEY.LENGTH~=0 AND
      273     5105    2              GLOBAL.SKEY.IXID=SC1.IXID AND
      274     5106    2              SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG)=OLDKEY THEN
      275     5107    2               GOTO ER_DUP;
      276     5108    2           END;
      277     5109    1       GLOBAL.SKEY.LENGTH=2+SC1.KLNG+AC.BPLDBK;
      278     5110    1       GLOBAL.SKEY.IXID=SC1.IXID;
      279     5111    1       GLOBAL.SKEY.VALUE=OLDKEY;
      280     5112    1       DBKY=RVT$->RECVAR.DBKEY-AC.ABAS;
      281     5113    1       CALL INSERT(GLOBAL.SKEY.VALUE,SC1.KLNG,AC.BPLDBK,
      282     5114    1          SUBSTR(CDBKY,4-AC.BPLDBK,AC.BPLDBK));
      283     5115    1       CALL ZIM$JKSTO(AWS$);
      284     5116    1       GLOBAL.WRTK$->FPT$WRTK.V.DCB#=AWS.KDCB;
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:57   
      285     5117    1       CALL M$WRITE(GLOBAL.WRTK$->FPT$WRTK) ALTRET(ER_WRT);
      286     5118    1       IF DCBADDR(AWS.KDCB)->F$DCB.RDL0#>3 THEN
      287     5119    2       DO;
      288     5120    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.KDCB;
      289     5121    2           GLOBAL.CLOSE$->FPT$CLOSE.V.OPER.REBLD#='1'B;
      290     5122    2           CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE) ALTRET(ER_CLSK);
      291     5123    2           GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#=AWS.KDCB;
      292     5124    2           CALL M$OPEN(GLOBAL.REOPEN$->FPT$REOPEN) ALTRET(ER_OPNK);
      293     5125    2           END;
      294     5126    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;
      295     5127    1       RETURN;
      296     5128    1   ER_WRT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$OLDREC THEN
      297     5129    1           ERROR=ERR#IX#DLDBK;
      298     5130    1       ELSE
      299     5131    1           ERROR=ERR#IX#UNEX;
      300     5132    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      301     5133    1       GLOBAL.RET.DCB#=GLOBAL.WRTK$->FPT$WRTK.V.DCB#;
      302     5134    1       GOTO ALT;
      303     5135    1   ER_BADKEY: ERROR=ERR#IX#NLDBK;
      304     5136    1       GOTO ALT;
      305     5137    1   ER_PREC: ERROR=ERR#IX#PSA;
      306     5138    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      307     5139    1       GLOBAL.RET.DCB#=GLOBAL.PREC$->FPT$PREC.V.DCB#;
      308     5140    1       GOTO ALT;
      309     5141    1   ER_DUP: ERROR=EXC#DDI;
      310     5142    1       GOTO ALT;
      311     5143    1   ER_CLSK: ERROR=ERR#IO#CLSK;
      312     5144    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      313     5145    1       GLOBAL.RET.DCB#=GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#;
      314     5146    1       GOTO ALT;
      315     5147    1   ER_OPNK: ERROR=ERR#IO#OPNK;
      316     5148    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      317     5149    1       GLOBAL.RET.DCB#=GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#;
      318     5150    1   ALT: ;
      319     5151            %DBALT;
      320     5165    1   END ZIM$KSTO;
      321     5166        %EOD;
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:58   

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:59   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$KSTO.

   Procedure ZIM$KSTO requires 253 words for executable code.
   Procedure ZIM$KSTO requires 76 words of local(AUTO) storage.

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:60   

 Object Unit name= ZIM$KSTO                                   File name= ZIM$KEYED.:ZIC0TOU
 UTS= SEP 05 '97 13:02:14.76 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   253    375  ZIM$KSTO
    2  RoData even  none     3      3  ZIM$KSTO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$KSTO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIB$ERR
         yes           XStd      1 ZIM$JKSTO
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$TCB$
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:61   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:62   


      211        1        /*M*     ZIM$KSTO - store alternate key           */
      212        2        /*T***********************************************************/
      213        3        /*T*                                                         */
      214        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      215        5        /*T*                                                         */
      216        6        /*T***********************************************************/
      217        7        ZIM$KSTO: PROC ALTRET

      7  1 000000   000000 700200 xent  ZIM$KSTO     TSX0  ! X66_AUTO_0
         1 000001   000114 000000                    ZERO    76,0

      218        8        /*          USE($PR5 FOR GLOBAL$)              */
      219        9               AVOID($PR5,$PR6,$PR7);
      220       10        %INCLUDE ZI$GLOBAL;
      221      496            %GLOBALS;
      222      804        %INCLUDE ZI$DBCB;
      223     1446            %DBCB;
      224     1924            %RECVAR;
      225     1958            %AWS;
      226     1998        %INCLUDE ZI$SSS;
      227     2547            %AC;
      228     2642            %SC1;
      229     2652            %RS;
      230     2728        %INCLUDE ZI_ERRORS_C;
      231     3054        %INCLUDE CP_6;
      232     3135            %FPT_WRITE(FPTN=FPT$WRTK,STCLASS=BASED);
      233     3166            %FPT_PRECORD(FPTN=FPT$PREC,STCLASS=BASED);
      234     3187            %FPT_OPEN(FPTN=FPT$REOPEN,STCLASS=BASED);
      235     3296            %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      236     3338            %F$DCB;
      237     3395            %B$TCB(STCLASS=BASED);
      238     3398            %B$ALT(STCLASS=BASED);
      239     3406        %INCLUDE B_ERRORS_C;
      240     4533        %INCLUDE CP_6_SUBS;
      241     5073    1   DCL ZIM$JKSTO ENTRY(1);
      242     5074    1   DCL OLDKEY CHAR(248);
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:63   
      243     5075    1   DCL DBKY UBIN(36);
      244     5076    1   DCL CDBKY REDEF DBKY CHAR(4);
      245     5077    1   DCL ERROR UBIN(36);
      246     5078    1   DCL RVT$ PTR;
      247     5079    1   DCL B$TCB$ PTR SYMREF;
      248     5080    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   5080  1 000002   000000 470400 xsym               LDP0    GLOBAL$
         1 000003   000001 236100                    LDQ     1,,PR0
         1 000004   200003 756100                    STQ     DBCB$,,AUTO

      249     5081    1       SSS$=GLOBAL.ACTIVE.SSS$;

   5081  1 000005   000000 236100                    LDQ     0,,PR0
         1 000006   200005 756100                    STQ     SSS$,,AUTO

      250     5082    1       RVT$=PINCRW(DBCB$,DBCB.PCB.RVT);

   5082  1 000007   200003 471500                    LDP1    DBCB$,,AUTO
         1 000010   100512 220100                    LDX0    330,,PR1
         1 000011   000000 636010                    EAQ     0,X0
         1 000012   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000013   200111 756100                    STQ     RVT$,,AUTO

      251     5083    1       AC$=PINCRW(SSS$,RVT$->RECVAR.ACPTR);

   5083  1 000014   200111 473500                    LDP3    RVT$,,AUTO
         1 000015   300005 221100                    LDX1    5,,PR3
         1 000016   000000 636011                    EAQ     0,X1
         1 000017   200005 036100                    ADLQ    SSS$,,AUTO
         1 000020   200006 756100                    STQ     AC$,,AUTO

      252     5084    1       AWS$=PINCRW(DBCB$,AC.WSOF);

   5084  1 000021   200006 474500                    LDP4    AC$,,AUTO
         1 000022   400003 222100                    LDX2    3,,PR4
         1 000023   000000 636012                    EAQ     0,X2
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:64   
         1 000024   200003 036100                    ADLQ    DBCB$,,AUTO
         1 000025   200004 756100                    STQ     AWS$,,AUTO

      253     5085        /*       If load mode return without processing */
      254     5086    1       IF AWS.ATRIB.LOAD THEN

   5086  1 000026   200004 470500                    LDP0    AWS$,,AUTO
         1 000027   000000 236100                    LDQ     0,,PR0
         1 000030   000002 316003                    CANQ    2,DU
         1 000031   000033 600000 1                  TZE     s:5088

      255     5087    1           RETURN;

   5087  1 000032   000000 702200 xent               TSX2  ! X66_ARET

      256     5088    1       RS$=PINCRW(SSS$,DBCB.PWS.XPRS); /*Prss */

   5088  1 000033   100676 722100                    LXL2    446,,PR1
         1 000034   000000 636012                    EAQ     0,X2
         1 000035   200005 036100                    ADLQ    SSS$,,AUTO
         1 000036   200010 756100                    STQ     RS$,,AUTO

      257     5089    1       SC1$=PINCRW(SSS$,RS.SCRSH-2);

   5089  1 000037   200010 470500                    LDP0    RS$,,AUTO
         1 000040   000003 723100                    LXL3    3,,PR0
         1 000041   777776 636013                    EAQ     -2,X3
         1 000042   200005 036100                    ADLQ    SSS$,,AUTO
         1 000043   200007 756100                    STQ     SC1$,,AUTO

      258     5090    1       OLDKEY=SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG);

   5090  1 000044   200007 470500                    LDP0    SC1$,,AUTO
         1 000045   000000 723100                    LXL3    0,,PR0
         1 000046   000000 470400 xsym               LDP0    GLOBAL$
         1 000047   040100 100540                    MLR     fill='040'O
         1 000050   004624 600013                    ADSC9   2452,,PR0                cn=3,n=*X3
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:65   
         1 000051   200011 000370                    ADSC9   OLDKEY,,AUTO             cn=0,n=248

      259     5091    2       IF RS.DEF.DORD=2 THEN DO;

   5091  1 000052   200010 470500                    LDP0    RS$,,AUTO
         1 000053   000000 236100                    LDQ     0,,PR0
         1 000054   600000 376007                    ANQ     -65536,DL
         1 000055   400000 116007                    CMPQ    -131072,DL
         1 000056   000141 601000 1                  TNZ     s:5109

      260     5092        /*          No duplicates are allowed          */
      261     5093    2           GLOBAL.SKEY.LENGTH=SC1.KLNG+2; /* No local key */

   5093  1 000057   000000 470400 xsym               LDP0    GLOBAL$
         1 000060   200007 471500                    LDP1    SC1$,,AUTO
         1 000061   100000 236100                    LDQ     0,,PR1
         1 000062   777777 376007                    ANQ     -1,DL
         1 000063   000002 036007                    ADLQ    2,DL
         1 000064   000033 736000                    QLS     27
         1 000065   004624 552140                    STBQ    2452,'40'O,PR0

      262     5094    2           GLOBAL.SKEY.IXID=SC1.IXID;

   5094  1 000066   100000 236100                    LDQ     0,,PR1
         1 000067   000011 772000                    QRL     9
         1 000070   004624 552130                    STBQ    2452,'30'O,PR0

      263     5095    2           GLOBAL.PREC$->FPT$PREC.V.DCB#=AWS.KDCB;

   5095  1 000071   005102 471500                    LDP1    2626,,PR0
         1 000072   200004 470500                    LDP0    AWS$,,AUTO
         1 000073   000006 720100                    LXL0    6,,PR0
         1 000074   100006 740100                    STX0    6,,PR1

      264     5096    2           GLOBAL.PREC$->FPT$PREC.V.N#=0;

   5096  1 000075   000000 471400 xsym               LDP1    GLOBAL$
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:66   
         1 000076   105102 470500                    LDP0    2626,,PR1
         1 000077   000007 450100                    STZ     7,,PR0

      265     5097    2           CALL M$PRECORD(GLOBAL.PREC$->FPT$PREC) ALTRET(CHECK);

   5097  1 000100   105102 470500                    LDP0    2626,,PR1
         1 000101   440003 713400                    CLIMB   alt,+16387
         1 000102   401000 401760                    pmme    nvectors=3
         1 000103   000111 702000 1                  TSX2    CHECK

      266     5098    2           GLOBAL.STATS.CURR.READS=GLOBAL.STATS.CURR.READS+1;

   5098  1 000104   000000 470400 xsym               LDP0    GLOBAL$
         1 000105   001425 235100                    LDA     789,,PR0
         1 000106   000001 035007                    ADLA    1,DL
         1 000107   001425 755100                    STA     789,,PR0

      267     5099    2           GOTO ER_BADKEY;

   5099  1 000110   000310 710000 1                  TRA     ER_BADKEY

      268     5100        /*          Key must not exist                 */
      269     5101    2   CHECK:  IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$NOKEY THEN

   5101  1 000111   000000 470400 xsym  CHECK        LDP0    B$TCB$
         1 000112   000000 471500                    LDP1    0,,PR0
         1 000113   100102 236100                    LDQ     66,,PR1
         1 000114   377770 376007                    ANQ     131064,DL
         1 000115   001020 116007                    CMPQ    528,DL
         1 000116   000313 601000 1                  TNZ     ER_PREC

      270     5102    2               GOTO ER_PREC;
      271     5103        /*          Check for duplicate key value      */
      272     5104    2           IF GLOBAL.SKEY.LENGTH~=0 AND

   5104  1 000117   000000 473400 xsym               LDP3    GLOBAL$
         1 000120   304624 236100                    LDQ     2452,,PR3
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:67   
         1 000121   777000 316003                    CANQ    -512,DU
         1 000122   000141 600000 1                  TZE     s:5109
         1 000123   200007 474500                    LDP4    SC1$,,AUTO
         1 000124   400000 236100                    LDQ     0,,PR4
         1 000125   000022 772000                    QRL     18
         1 000126   200112 756100                    STQ     RVT$+1,,AUTO
         1 000127   304624 236100                    LDQ     2452,,PR3
         1 000130   000011 772000                    QRL     9
         1 000131   777777 376007                    ANQ     -1,DL
         1 000132   200112 116100                    CMPQ    RVT$+1,,AUTO
         1 000133   000141 601000 1                  TNZ     s:5109
         1 000134   400000 720100                    LXL0    0,,PR4
         1 000135   040100 106540                    CMPC    fill='040'O
         1 000136   304624 600010                    ADSC9   2452,,PR3                cn=3,n=*X0
         1 000137   200011 000370                    ADSC9   OLDKEY,,AUTO             cn=0,n=248
         1 000140   000324 600000 1                  TZE     ER_DUP

      273     5105    2              GLOBAL.SKEY.IXID=SC1.IXID AND
      274     5106    2              SUBSTR(GLOBAL.SKEY.VALUE,0,SC1.KLNG)=OLDKEY THEN
      275     5107    2               GOTO ER_DUP;
      276     5108    2           END;

      277     5109    1       GLOBAL.SKEY.LENGTH=2+SC1.KLNG+AC.BPLDBK;

   5109  1 000141   200006 470500                    LDP0    AC$,,AUTO
         1 000142   000015 236100                    LDQ     13,,PR0
         1 000143   000022 772000                    QRL     18
         1 000144   200112 756100                    STQ     RVT$+1,,AUTO
         1 000145   200007 471500                    LDP1    SC1$,,AUTO
         1 000146   100000 236100                    LDQ     0,,PR1
         1 000147   777777 376007                    ANQ     -1,DL
         1 000150   200112 036100                    ADLQ    RVT$+1,,AUTO
         1 000151   000000 473400 xsym               LDP3    GLOBAL$
         1 000152   000002 036007                    ADLQ    2,DL
         1 000153   000033 736000                    QLS     27
         1 000154   304624 552140                    STBQ    2452,'40'O,PR3

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:68   
      278     5110    1       GLOBAL.SKEY.IXID=SC1.IXID;

   5110  1 000155   100000 236100                    LDQ     0,,PR1
         1 000156   000011 772000                    QRL     9
         1 000157   304624 552130                    STBQ    2452,'30'O,PR3

      279     5111    1       GLOBAL.SKEY.VALUE=OLDKEY;

   5111  1 000160   040100 100500                    MLR     fill='040'O
         1 000161   200011 000370                    ADSC9   OLDKEY,,AUTO             cn=0,n=248
         1 000162   304624 600375                    ADSC9   2452,,PR3                cn=3,n=253

      280     5112    1       DBKY=RVT$->RECVAR.DBKEY-AC.ABAS;

   5112  1 000163   200111 474500                    LDP4    RVT$,,AUTO
         1 000164   400000 236100                    LDQ     0,,PR4
         1 000165   000002 136100                    SBLQ    2,,PR0
         1 000166   200107 756100                    STQ     DBKY,,AUTO

      281     5113    1       CALL INSERT(GLOBAL.SKEY.VALUE,SC1.KLNG,AC.BPLDBK,

   5113  1 000167   000015 236100                    LDQ     13,,PR0
         1 000170   000022 772000                    QRL     18
         1 000171   000015 220100                    LDX0    13,,PR0
         1 000172   200112 756100                    STQ     RVT$+1,,AUTO
         1 000173   100000 236100                    LDQ     0,,PR1
         1 000174   777777 376007                    ANQ     -1,DL
         1 000175   000015 221100                    LDX1    13,,PR0
         1 000176   000000 235003                    LDA     0,DU
         1 000177   200112 135100                    SBLA    RVT$+1,,AUTO
         1 000200   040146 100545                    MLR     fill='040'O
         1 000201   200110 000010                    ADSC9   ERROR,A,AUTO             cn=0,n=*X0
         1 000202   304624 600011                    ADSC9   2452,Q,PR3               cn=3,n=*X1

      282     5114    1          SUBSTR(CDBKY,4-AC.BPLDBK,AC.BPLDBK));
      283     5115    1       CALL ZIM$JKSTO(AWS$);

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:69   
   5115  1 000203   200004 630500                    EPPR0   AWS$,,AUTO
         1 000204   200112 450500                    STP0    RVT$+1,,AUTO
         1 000205   200112 630500                    EPPR0   RVT$+1,,AUTO
         1 000206   000000 631400 2                  EPPR1   0
         1 000207   000000 701000 xent               TSX1    ZIM$JKSTO
         1 000210   000000 011000                    NOP     0

      284     5116    1       GLOBAL.WRTK$->FPT$WRTK.V.DCB#=AWS.KDCB;

   5116  1 000211   000000 470400 xsym               LDP0    GLOBAL$
         1 000212   005100 471500                    LDP1    2624,,PR0
         1 000213   200004 473500                    LDP3    AWS$,,AUTO
         1 000214   300006 720100                    LXL0    6,,PR3
         1 000215   100010 740100                    STX0    8,,PR1

      285     5117    1       CALL M$WRITE(GLOBAL.WRTK$->FPT$WRTK) ALTRET(ER_WRT);

   5117  1 000216   005100 471500                    LDP1    2624,,PR0
         1 000217   100000 630500                    EPPR0   0,,PR1
         1 000220   440001 713400                    CLIMB   alt,write
         1 000221   401400 401760                    pmme    nvectors=4
         1 000222   000266 702000 1                  TSX2    ER_WRT

      286     5118    1       IF DCBADDR(AWS.KDCB)->F$DCB.RDL0#>3 THEN

   5118  1 000223   000001 470400 2                  LDP0    1
         1 000224   000000 471500                    LDP1    0,,PR0
         1 000225   200004 473500                    LDP3    AWS$,,AUTO
         1 000226   300006 720100                    LXL0    6,,PR3
         1 000227   100000 474510                    LDP4    0,X0,PR1
         1 000230   400003 236100                    LDQ     3,,PR4
         1 000231   000777 376003                    ANQ     511,DU
         1 000232   000004 116003                    CMPQ    4,DU
         1 000233   000261 602000 1                  TNC     s:5126

      287     5119    2       DO;

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:70   
      288     5120    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=AWS.KDCB;

   5120  1 000234   000000 470400 xsym               LDP0    GLOBAL$
         1 000235   005072 471500                    LDP1    2618,,PR0
         1 000236   100032 740100                    STX0    26,,PR1

      289     5121    2           GLOBAL.CLOSE$->FPT$CLOSE.V.OPER.REBLD#='1'B;

   5121  1 000237   005072 471500                    LDP1    2618,,PR0
         1 000240   100000 236007                    LDQ     32768,DL
         1 000241   100032 256100                    ORSQ    26,,PR1

      290     5122    2           CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE) ALTRET(ER_CLSK);

   5122  1 000242   005072 471500                    LDP1    2618,,PR0
         1 000243   100000 630500                    EPPR0   0,,PR1
         1 000244   450001 713400                    CLIMB   alt,close
         1 000245   406000 401760                    pmme    nvectors=13
         1 000246   000327 702000 1                  TSX2    ER_CLSK

      291     5123    2           GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#=AWS.KDCB;

   5123  1 000247   000000 470400 xsym               LDP0    GLOBAL$
         1 000250   005071 471500                    LDP1    2617,,PR0
         1 000251   200004 473500                    LDP3    AWS$,,AUTO
         1 000252   300006 720100                    LXL0    6,,PR3
         1 000253   100044 740100                    STX0    36,,PR1

      292     5124    2           CALL M$OPEN(GLOBAL.REOPEN$->FPT$REOPEN) ALTRET(ER_OPNK);

   5124  1 000254   005071 471500                    LDP1    2617,,PR0
         1 000255   100000 630500                    EPPR0   0,,PR1
         1 000256   450000 713400                    CLIMB   alt,open
         1 000257   410400 401760                    pmme    nvectors=18
         1 000260   000342 702000 1                  TSX2    ER_OPNK

      293     5125    2           END;
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:71   

      294     5126    1       GLOBAL.STATS.CURR.WRITES=GLOBAL.STATS.CURR.WRITES+1;

   5126  1 000261   000000 470400 xsym               LDP0    GLOBAL$
         1 000262   001426 235100                    LDA     790,,PR0
         1 000263   000001 035007                    ADLA    1,DL
         1 000264   001426 755100                    STA     790,,PR0

      295     5127    1       RETURN;

   5127  1 000265   000000 702200 xent               TSX2  ! X66_ARET

      296     5128    1   ER_WRT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$OLDREC THEN

   5128  1 000266   000000 470400 xsym  ER_WRT       LDP0    B$TCB$
         1 000267   000000 471500                    LDP1    0,,PR0
         1 000270   100102 236100                    LDQ     66,,PR1
         1 000271   377770 376007                    ANQ     131064,DL
         1 000272   000750 116007                    CMPQ    488,DL
         1 000273   000277 601000 1                  TNZ     s:5131

      297     5129    1           ERROR=ERR#IX#DLDBK;

   5129  1 000274   303414 235007                    LDA     100108,DL
         1 000275   200110 755100                    STA     ERROR,,AUTO
         1 000276   000301 710000 1                  TRA     s:5132

      298     5130    1       ELSE
      299     5131    1           ERROR=ERR#IX#UNEX;

   5131  1 000277   303423 235007                    LDA     100115,DL
         1 000300   200110 755100                    STA     ERROR,,AUTO

      300     5132    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5132  1 000301   100102 236100                    LDQ     66,,PR1
         1 000302   000000 473400 xsym               LDP3    GLOBAL$
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:72   
         1 000303   300007 756100                    STQ     7,,PR3

      301     5133    1       GLOBAL.RET.DCB#=GLOBAL.WRTK$->FPT$WRTK.V.DCB#;

   5133  1 000304   305100 471500                    LDP1    2624,,PR3
         1 000305   100010 220100                    LDX0    8,,PR1
         1 000306   300014 740100                    STX0    12,,PR3

      302     5134    1       GOTO ALT;

   5134  1 000307   000354 710000 1                  TRA     ALT

      303     5135    1   ER_BADKEY: ERROR=ERR#IX#NLDBK;

   5135  1 000310   303415 236007       ER_BADKEY    LDQ     100109,DL
         1 000311   200110 756100                    STQ     ERROR,,AUTO

      304     5136    1       GOTO ALT;

   5136  1 000312   000354 710000 1                  TRA     ALT

      305     5137    1   ER_PREC: ERROR=ERR#IX#PSA;

   5137  1 000313   303416 235007       ER_PREC      LDA     100110,DL
         1 000314   200110 755100                    STA     ERROR,,AUTO

      306     5138    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5138  1 000315   100102 236100                    LDQ     66,,PR1
         1 000316   000000 473400 xsym               LDP3    GLOBAL$
         1 000317   300007 756100                    STQ     7,,PR3

      307     5139    1       GLOBAL.RET.DCB#=GLOBAL.PREC$->FPT$PREC.V.DCB#;

   5139  1 000320   305102 471500                    LDP1    2626,,PR3
         1 000321   100006 220100                    LDX0    6,,PR1
         1 000322   300014 740100                    STX0    12,,PR3
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:73   

      308     5140    1       GOTO ALT;

   5140  1 000323   000354 710000 1                  TRA     ALT

      309     5141    1   ER_DUP: ERROR=EXC#DDI;

   5141  1 000324   011754 235007       ER_DUP       LDA     5100,DL
         1 000325   200110 755100                    STA     ERROR,,AUTO

      310     5142    1       GOTO ALT;

   5142  1 000326   000354 710000 1                  TRA     ALT

      311     5143    1   ER_CLSK: ERROR=ERR#IO#CLSK;

   5143  1 000327   303355 235007       ER_CLSK      LDA     100077,DL
         1 000330   200110 755100                    STA     ERROR,,AUTO

      312     5144    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5144  1 000331   000000 470400 xsym               LDP0    B$TCB$
         1 000332   000000 471500                    LDP1    0,,PR0
         1 000333   100102 236100                    LDQ     66,,PR1
         1 000334   000000 473400 xsym               LDP3    GLOBAL$
         1 000335   300007 756100                    STQ     7,,PR3

      313     5145    1       GLOBAL.RET.DCB#=GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#;

   5145  1 000336   305072 471500                    LDP1    2618,,PR3
         1 000337   100032 220100                    LDX0    26,,PR1
         1 000340   300014 740100                    STX0    12,,PR3

      314     5146    1       GOTO ALT;

   5146  1 000341   000354 710000 1                  TRA     ALT

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:74   
      315     5147    1   ER_OPNK: ERROR=ERR#IO#OPNK;

   5147  1 000342   210700 235007       ER_OPNK      LDA     70080,DL
         1 000343   200110 755100                    STA     ERROR,,AUTO

      316     5148    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5148  1 000344   000000 470400 xsym               LDP0    B$TCB$
         1 000345   000000 471500                    LDP1    0,,PR0
         1 000346   100102 236100                    LDQ     66,,PR1
         1 000347   000000 473400 xsym               LDP3    GLOBAL$
         1 000350   300007 756100                    STQ     7,,PR3

      317     5149    1       GLOBAL.RET.DCB#=GLOBAL.REOPEN$->FPT$REOPEN.V.DCB#;

   5149  1 000351   305071 471500                    LDP1    2617,,PR3
         1 000352   100044 220100                    LDX0    36,,PR1
         1 000353   300014 740100                    STX0    12,,PR3

   5149  1 000354                       ALT          null
      318     5150    1   ALT: ;
      319     5151            %DBALT;

   5152  1 000354   000000 470400 xsym               LDP0    GLOBAL$
         1 000355   000006 235100                    LDA     6,,PR0
         1 000356   000365 601000 1                  TNZ     s:5160

   5154  1 000357   000010 450100                    STZ     8,,PR0

   5155  1 000360   000012 450100                    STZ     10,,PR0

   5156  1 000361   000013 450100                    STZ     11,,PR0

   5157  1 000362   000011 450100                    STZ     9,,PR0

   5158  1 000363   200110 236100                    LDQ     ERROR,,AUTO
         1 000364   000006 756100                    STQ     6,,PR0
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:75   

   5160  1 000365   000006 235100                    LDA     6,,PR0
         1 000366   303240 115007                    CMPA    100000,DL
         1 000367   000371 603000 1                  TRC     s:5163

   5161  1 000370   000000 702200 xent               TSX2  ! X66_AALT

   5163  1 000371   000002 631400 2                  EPPR1   2
         1 000372   000000 701000 xent               TSX1    ZIB$ERR
         1 000373   000000 011000                    NOP     0

      320     5165    1   END ZIM$KSTO;

   5165  1 000374   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000001 000000   000000 006003   000000 000000                    ............
      321     5166        %EOD;

PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:76   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$KSTO.

   Procedure ZIM$KSTO requires 253 words for executable code.
   Procedure ZIM$KSTO requires 76 words of local(AUTO) storage.
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:77   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:78   
          MINI XREF LISTING

AC.ABAS
      2570**DCL      5112>>ASSIGN
AC.BPLDBK
      2596**DCL      5109>>ASSIGN   5113>>CALLBLT  5113>>CALLBLT  5113>>CALLBLT
AC.DEF.ANL
      2567**DCL      2638--IMP-SIZ
AC.DEF.FORG
      2554**DCL      2558--REDEF
AC.WSOF
      2571**DCL      5084>>ASSIGN
AC$
      2550**DCL      2551--IMP-PTR  5083<<ASSIGN   5084>>ASSIGN   5109>>ASSIGN   5112>>ASSIGN   5113>>CALLBLT
      5113>>CALLBLT  5113>>CALLBLT
ALT
      5149**LABEL    5134--GOTO     5136--GOTO     5140--GOTO     5142--GOTO     5146--GOTO
AWS.ATRIB.LOAD
      1976**DCL      5086>>IF
AWS.KDCB
      1986**DCL      5095>>ASSIGN   5116>>ASSIGN   5118--IF       5120>>ASSIGN   5123>>ASSIGN
AWS$
      1959**DCL      1960--IMP-PTR  5084<<ASSIGN   5086>>IF       5095>>ASSIGN   5115<>CALL     5116>>ASSIGN
      5118>>IF       5120>>ASSIGN   5123>>ASSIGN
B$ALT.CODE
      3400**DCL      3400--REDEF    3401--REDEF    3401--REDEF
B$ALT.ERR
      3401**DCL      5132>>ASSIGN   5138>>ASSIGN   5144>>ASSIGN   5148>>ASSIGN
B$ALT.ERR.CODE
      3402**DCL      5101>>IF
B$ALT.ERR.ERR#
      3402**DCL      3402--REDEF    5128>>IF
B$ALT.EVID
      3401**DCL      3401--REDEF    3401--REDEF
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:79   
B$TCB.ALT$
      3396**DCL      5101>>IF       5128>>IF       5132>>ASSIGN   5138>>ASSIGN   5144>>ASSIGN   5148>>ASSIGN
B$TCB$
      5079**DCL      5101>>IF       5128>>IF       5132>>ASSIGN   5138>>ASSIGN   5144>>ASSIGN   5148>>ASSIGN
CDBKY
      5076**DCL      5113>>CALLBLT
CHECK
      5101**LABEL    5097--CALLALT
DBCB.IOWS.CFCT
      1876**DCL      1877--REDEF
DBCB.IOWS.DBKF.RQ
      1819**DCL      1820--REDEF
DBCB.IOWS.DBKR
      1816**DCL      1817--REDEF
DBCB.IOWS.NOBF
      1878**DCL      1879--REDEF
DBCB.IOWS.SPND
      1804**DCL      1805--REDEF
DBCB.PCB.RVT
      1656**DCL      5082>>ASSIGN
DBCB.PWS.XPRS
      1734**DCL      5088>>ASSIGN
DBCB.SWS.RDYCW
      1542**DCL      1543--REDEF
DBCB.SWS.TEMP.PTR1$
      1576**DCL      1577--REDEF    1578--REDEF
DBCB.SWS.TEMP.PTR2$
      1579**DCL      1580--REDEF
DBCB$
      1447**DCL      1448--IMP-PTR  5080<<ASSIGN   5082>>ASSIGN   5082>>ASSIGN   5084>>ASSIGN   5088>>ASSIGN
DBKY
      5075**DCL      5076--REDEF    5112<<ASSIGN
ERROR
      5077**DCL      5129<<ASSIGN   5131<<ASSIGN   5135<<ASSIGN   5137<<ASSIGN   5141<<ASSIGN   5143<<ASSIGN
      5147<<ASSIGN   5158>>ASSIGN
ER_BADKEY
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:80   
      5135**LABEL    5099--GOTO
ER_CLSK
      5143**LABEL    5122--CALLALT
ER_DUP
      5141**LABEL    5107--GOTO
ER_OPNK
      5147**LABEL    5124--CALLALT
ER_PREC
      5137**LABEL    5102--GOTO
ER_WRT
      5128**LABEL    5117--CALLALT
F$DCB.ACTPOS
      3371**DCL      3371--REDEF
F$DCB.ARS#
      3345**DCL      3345--REDEF
F$DCB.ATTR
      3364**DCL      3365--REDEF
F$DCB.BORROW
      3379**DCL      3379--REDEF    3379--REDEF    3379--REDEF
F$DCB.DCBNAME.L
      3393**DCL      3393--IMP-SIZ
F$DCB.EOMCHAR#
      3349**DCL      3349--REDEF
F$DCB.FLDID
      3374**DCL      3374--REDEF
F$DCB.FORM$
      3368**DCL      3368--REDEF
F$DCB.FSECT
      3384**DCL      3384--REDEF
F$DCB.FSN#
      3361**DCL      3361--REDEF    3361--REDEF    3362--REDEF
F$DCB.HEADER$
      3367**DCL      3367--REDEF
F$DCB.IXTNSIZE#
      3365**DCL      3365--REDEF
F$DCB.LASTSTA$
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:81   
      3354**DCL      3354--REDEF
F$DCB.LVL
      3380**DCL      3380--REDEF
F$DCB.NAME#.C
      3355**DCL      3355--REDEF
F$DCB.NOEOF
      3377**DCL      3377--REDEF
F$DCB.NRECS#
      3366**DCL      3366--REDEF
F$DCB.NRECX
      3385**DCL      3385--REDEF
F$DCB.OHDR
      3377**DCL      3377--REDEF
F$DCB.ORG#
      3360**DCL      3360--REDEF
F$DCB.PRECNO
      3383**DCL      3383--REDEF
F$DCB.RCSZ
      3389**DCL      3389--REDEF
F$DCB.RDL0#
      3349**DCL      5118>>IF
F$DCB.RES#
      3356**DCL      3356--REDEF
F$DCB.SETX
      3368**DCL      3368--REDEF
F$DCB.TAB$
      3368**DCL      3368--REDEF
F$DCB.TDA
      3382**DCL      3383--REDEF
F$DCB.WSN#
      3356**DCL      3356--REDEF
FPT$CLOSE
      3319**DCL      5122<>CALL
FPT$CLOSE.SN_
      3319**DCL      3319--REDEF
FPT$CLOSE.UTL_
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:82   
      3320**DCL      3320--REDEF
FPT$CLOSE.V.DCB#
      3325**DCL      5120<<ASSIGN   5145>>ASSIGN
FPT$CLOSE.V.EXPIRE#
      3334**DCL      3334--REDEF
FPT$CLOSE.V.OPER.REBLD#
      3326**DCL      5121<<ASSIGN
FPT$CLOSE.V.TYPE#
      3332**DCL      3332--REDEF
FPT$CLOSE.V.XTNSIZE#
      3329**DCL      3329--REDEF    3331--REDEF
FPT$PREC
      3177**DCL      5097<>CALL
FPT$PREC.V.DCB#
      3179**DCL      5095<<ASSIGN   5139>>ASSIGN
FPT$PREC.V.N#
      3183**DCL      5096<<ASSIGN
FPT$REOPEN
      3252**DCL      5124<>CALL
FPT$REOPEN.ACSVEH_
      3254**DCL      3255--REDEF
FPT$REOPEN.ALTKEYS_
      3260**DCL      3261--REDEF    3261--REDEF
FPT$REOPEN.HDR_
      3259**DCL      3260--REDEF
FPT$REOPEN.TAB_
      3258**DCL      3259--REDEF
FPT$REOPEN.UHL_
      3252**DCL      3253--REDEF    3253--REDEF
FPT$REOPEN.V.DCB#
      3261**DCL      5123<<ASSIGN   5149>>ASSIGN
FPT$REOPEN.V.FSN#
      3292**DCL      3292--REDEF    3292--REDEF
FPT$REOPEN.WSN_
      3258**DCL      3258--REDEF
FPT$WRTK
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:83   
      3152**DCL      5117<>CALL
FPT$WRTK.STATION_
      3154**DCL      3154--REDEF
FPT$WRTK.V.DCB#
      3155**DCL      5116<<ASSIGN   5133>>ASSIGN
FPT$WRTK.V.DVBYTE.VFC#
      3161**DCL      3161--REDEF
GLOBAL.ACTIVE.DBCB$
       503**DCL       504--REDEF    5080>>ASSIGN
GLOBAL.ACTIVE.SSS$
       499**DCL       500--REDEF    5081>>ASSIGN
GLOBAL.CLOSE$
       758**DCL      5120>>ASSIGN   5121>>ASSIGN   5122>>CALL     5145>>ASSIGN
GLOBAL.KEY
       707**DCL       710--REDEF
GLOBAL.PARAN.TRACE.MODE
       582**DCL       589--REDEF
GLOBAL.PREC$
       766**DCL      5095>>ASSIGN   5096>>ASSIGN   5097>>CALL     5139>>ASSIGN
GLOBAL.PRINTBUF.BUFFER
       741**DCL       742--REDEF     743--REDEF     744--REDEF
GLOBAL.PRINTBUF.ERR.V
       746**DCL       749--REDEF     750--REDEF     751--REDEF
GLOBAL.REOPEN$
       757**DCL      5123>>ASSIGN   5124>>CALL     5149>>ASSIGN
GLOBAL.RET.AC#
       519**DCL      5154<<ASSIGN
GLOBAL.RET.DCB#
       523**DCL      5133<<ASSIGN   5139<<ASSIGN   5145<<ASSIGN   5149<<ASSIGN
GLOBAL.RET.ERROR#
       517**DCL      5152>>IF       5158<<ASSIGN   5160>>IF
GLOBAL.RET.FR#
       520**DCL      5157<<ASSIGN
GLOBAL.RET.RC#
       522**DCL      5156<<ASSIGN
GLOBAL.RET.SC#
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:84   
       521**DCL      5155<<ASSIGN
GLOBAL.RET.SYSERR#
       518**DCL      5132<<ASSIGN   5138<<ASSIGN   5144<<ASSIGN   5148<<ASSIGN
GLOBAL.SKEY.IXID
       712**DCL      5094<<ASSIGN   5104>>IF       5110<<ASSIGN
GLOBAL.SKEY.LENGTH
       711**DCL      5093<<ASSIGN   5104>>IF       5109<<ASSIGN
GLOBAL.SKEY.VALUE
       713**DCL      5090>>ASSIGN   5104>>IF       5111<<ASSIGN   5113<<CALLBLT
GLOBAL.STATS.CURR.READS
       657**DCL      5098<<ASSIGN   5098>>ASSIGN
GLOBAL.STATS.CURR.WRITES
       658**DCL      5126<<ASSIGN   5126>>ASSIGN
GLOBAL.WRTK$
       764**DCL      5116>>ASSIGN   5117>>CALL     5133>>ASSIGN
GLOBAL$
       801**DCL       497--IMP-PTR  5080>>ASSIGN   5081>>ASSIGN   5090>>ASSIGN   5093>>ASSIGN   5094>>ASSIGN
      5095>>ASSIGN   5096>>ASSIGN   5097>>CALL     5098>>ASSIGN   5098>>ASSIGN   5104>>IF       5104>>IF
      5104>>IF       5109>>ASSIGN   5110>>ASSIGN   5111>>ASSIGN   5113>>CALLBLT  5116>>ASSIGN   5117>>CALL
      5120>>ASSIGN   5121>>ASSIGN   5122>>CALL     5123>>ASSIGN   5124>>CALL     5126>>ASSIGN   5126>>ASSIGN
      5132>>ASSIGN   5133>>ASSIGN   5133>>ASSIGN   5138>>ASSIGN   5139>>ASSIGN   5139>>ASSIGN   5144>>ASSIGN
      5145>>ASSIGN   5145>>ASSIGN   5148>>ASSIGN   5149>>ASSIGN   5149>>ASSIGN   5152>>IF       5154>>ASSIGN
      5155>>ASSIGN   5156>>ASSIGN   5157>>ASSIGN   5158>>ASSIGN   5160>>IF
M$CLOSE
      3063**DCL-ENT  5122--CALL
M$OPEN
      3063**DCL-ENT  5124--CALL
M$PRECORD
      3067**DCL-ENT  5097--CALL
M$WRITE
      3064**DCL-ENT  5117--CALL
OLDKEY
      5074**DCL      5090<<ASSIGN   5104>>IF       5111>>ASSIGN
RECVAR.ACPTR
      1945**DCL      5083>>ASSIGN
RECVAR.BADDR
PL6.E3A0      #003=ZIM$KSTO File=ZIM$KEYED.:ZIC0TSI                              FRI 09/05/97 13:02 Page:85   
      1927**DCL      1930--REDEF
RECVAR.DBKEY
      1926**DCL      5112>>ASSIGN
RECVAR.RADDR
      1931**DCL      1935--REDEF
RS.DEF.DORD
      2666**DCL      5091>>IF
RS.NPOS
      2680**DCL      2689--REDEF
RS.SCRSH
      2679**DCL      5089>>ASSIGN
RS$
      2654**DCL      2655--IMP-PTR  5088<<ASSIGN   5089>>ASSIGN   5091>>IF
RVT$
      5078**DCL      5082<<ASSIGN   5083>>ASSIGN   5112>>ASSIGN
SC1.IXID
      2646**DCL      5094>>ASSIGN   5104>>IF       5110>>ASSIGN
SC1.KLNG
      2647**DCL      5090>>ASSIGN   5093>>ASSIGN   5104>>IF       5109>>ASSIGN   5113>>CALLBLT
SC1$
      2644**DCL      2645--IMP-PTR  5089<<ASSIGN   5090>>ASSIGN   5093>>ASSIGN   5094>>ASSIGN   5104>>IF
      5104>>IF       5109>>ASSIGN   5110>>ASSIGN   5113>>CALLBLT
SSS$
      2005**DCL      5081<<ASSIGN   5083>>ASSIGN   5088>>ASSIGN   5089>>ASSIGN
ZIB$ERR
       802**DCL-ENT  5163--CALL
ZIM$JKSTO
      5073**DCL-ENT  5115--CALL

PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:86   
      322        1        /*M*        ZIM$CURR - Update currency for keyed and indexed areas */
      323        2        /*T***********************************************************/
      324        3        /*T*                                                         */
      325        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      326        5        /*T*                                                         */
      327        6        /*T***********************************************************/
      328        7        ZIM$KCURR: PROC
      329        8         /* USE($PR5 FOR GLOBAL$) */
      330        9               AVOID($PR5,$PR6,$PR7);
      331       10        %INCLUDE ZI$GLOBAL;
      332      496            %GLOBALS;
      333      804        %INCLUDE ZI$DBCB;
      334     1446            %DBCB;
      335     1924            %SETWS;
      336     1943            %RECVAR;
      337     1977        %INCLUDE ZI$SSS;
      338     2526            %SC;
      339     2553    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
      340     2554    1       SSS$=GLOBAL.ACTIVE.SSS$;
      341     2555    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);
      342     2556    1       SETWS$=PINCRW(DBCB$,SC.SCWSO);
      343     2557    1       SETWS.CURR=PINCRW(DBCB$,DBCB.PCB.RVO)->RECVAR.DBKEY;
      344     2558    1       SETWS.PRIV.CSE='0'B;
      345     2559    1       SETWS.AC=PINCRW(DBCB$,DBCB.PCB.RVO)->RECVAR.ACPTR;
      346     2560    1       SETWS.KEY.LENGTH=GLOBAL.KEY.LENGTH;
      347     2561    1       SETWS.KEY.VALUE=GLOBAL.KEY.VALUE;
      348     2562    1       RETURN;
      349     2563    1   END ZIM$KCURR;

PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:87   
--  Include file information  --

   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIM$KCURR.

   Procedure ZIM$KCURR requires 35 words for executable code.
   Procedure ZIM$KCURR requires 8 words of local(AUTO) storage.

    No errors detected in file ZIM$KEYED.:ZIC0TSI    .

PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:88   

 Object Unit name= ZIM$KCURR                                  File name= ZIM$KEYED.:ZIC0TOU
 UTS= SEP 05 '97 13:02:32.64 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    35     43  ZIM$KCURR
    1  RoData even  none     1      1  ZIM$KCURR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      XStd       0  ZIM$KCURR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$
PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:89   


      322        1        /*M*        ZIM$CURR - Update currency for keyed and indexed areas */
      323        2        /*T***********************************************************/
      324        3        /*T*                                                         */
      325        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      326        5        /*T*                                                         */
      327        6        /*T***********************************************************/
      328        7        ZIM$KCURR: PROC

      7  0 000000   000000 700200 xent  ZIM$KCURR    TSX0  ! X66_AUTO_0
         0 000001   000010 000000                    ZERO    8,0

      329        8         /* USE($PR5 FOR GLOBAL$) */
      330        9               AVOID($PR5,$PR6,$PR7);
      331       10        %INCLUDE ZI$GLOBAL;
      332      496            %GLOBALS;
      333      804        %INCLUDE ZI$DBCB;
      334     1446            %DBCB;
      335     1924            %SETWS;
      336     1943            %RECVAR;
      337     1977        %INCLUDE ZI$SSS;
      338     2526            %SC;
      339     2553    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   2553  0 000002   000000 470400 xsym               LDP0    GLOBAL$
         0 000003   000001 236100                    LDQ     1,,PR0
         0 000004   200003 756100                    STQ     DBCB$,,AUTO

      340     2554    1       SSS$=GLOBAL.ACTIVE.SSS$;

   2554  0 000005   000000 236100                    LDQ     0,,PR0
         0 000006   200005 756100                    STQ     SSS$,,AUTO

      341     2555    1       SC$=PINCRW(SSS$,DBCB.PCB.PRSC);

   2555  0 000007   200003 471500                    LDP1    DBCB$,,AUTO
         0 000010   100520 220100                    LDX0    336,,PR1
PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:90   
         0 000011   000000 636010                    EAQ     0,X0
         0 000012   200005 036100                    ADLQ    SSS$,,AUTO
         0 000013   200006 756100                    STQ     SC$,,AUTO

      342     2556    1       SETWS$=PINCRW(DBCB$,SC.SCWSO);

   2556  0 000014   200006 473500                    LDP3    SC$,,AUTO
         0 000015   300001 221100                    LDX1    1,,PR3
         0 000016   000000 636011                    EAQ     0,X1
         0 000017   200003 036100                    ADLQ    DBCB$,,AUTO
         0 000020   200004 756100                    STQ     SETWS$,,AUTO

      343     2557    1       SETWS.CURR=PINCRW(DBCB$,DBCB.PCB.RVO)->RECVAR.DBKEY;

   2557  0 000021   100511 222100                    LDX2    329,,PR1
         0 000022   200004 474500                    LDP4    SETWS$,,AUTO
         0 000023   100000 235112                    LDA     0,X2,PR1
         0 000024   400001 755100                    STA     1,,PR4

      344     2558    1       SETWS.PRIV.CSE='0'B;

   2558  0 000025   000000 236000 1                  LDQ     0
         0 000026   400000 356100                    ANSQ    0,,PR4

      345     2559    1       SETWS.AC=PINCRW(DBCB$,DBCB.PCB.RVO)->RECVAR.ACPTR;

   2559  0 000027   100511 220100                    LDX0    329,,PR1
         0 000030   100005 221110                    LDX1    5,X0,PR1
         0 000031   400000 441100                    SXL1    0,,PR4

      346     2560    1       SETWS.KEY.LENGTH=GLOBAL.KEY.LENGTH;

   2560  0 000032   004624 236100                    LDQ     2452,,PR0
         0 000033   400002 552140                    STBQ    2,'40'O,PR4

      347     2561    1       SETWS.KEY.VALUE=GLOBAL.KEY.VALUE;

PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:91   
   2561  0 000034   400002 236100                    LDQ     2,,PR4
         0 000035   000033 772000                    QRL     27
         0 000036   000000 620006                    EAX0    0,QL
         0 000037   040140 100500                    MLR     fill='040'O
         0 000040   004624 200377                    ADSC9   2452,,PR0                cn=1,n=255
         0 000041   400002 200010                    ADSC9   2,,PR4                   cn=1,n=*X0

      348     2562    1       RETURN;

   2562  0 000042   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   377777 777777                                                    ....
      349     2563    1   END ZIM$KCURR;

PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:92   
--  Include file information  --

   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIM$KCURR.

   Procedure ZIM$KCURR requires 35 words for executable code.
   Procedure ZIM$KCURR requires 8 words of local(AUTO) storage.

    No errors detected in file ZIM$KEYED.:ZIC0TSI    .
PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:93   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:94   
          MINI XREF LISTING

DBCB.IOWS.CFCT
      1876**DCL      1877--REDEF
DBCB.IOWS.DBKF.RQ
      1819**DCL      1820--REDEF
DBCB.IOWS.DBKR
      1816**DCL      1817--REDEF
DBCB.IOWS.NOBF
      1878**DCL      1879--REDEF
DBCB.IOWS.SPND
      1804**DCL      1805--REDEF
DBCB.PCB.PRSC
      1665**DCL      2555>>ASSIGN
DBCB.PCB.RVO
      1654**DCL      2557>>ASSIGN   2559>>ASSIGN
DBCB.SWS.RDYCW
      1542**DCL      1543--REDEF
DBCB.SWS.TEMP.PTR1$
      1576**DCL      1577--REDEF    1578--REDEF
DBCB.SWS.TEMP.PTR2$
      1579**DCL      1580--REDEF
DBCB$
      1447**DCL      1448--IMP-PTR  2553<<ASSIGN   2555>>ASSIGN   2556>>ASSIGN   2557>>ASSIGN   2557>>ASSIGN
      2559>>ASSIGN   2559>>ASSIGN
GLOBAL.ACTIVE.DBCB$
       503**DCL       504--REDEF    2553>>ASSIGN
GLOBAL.ACTIVE.SSS$
       499**DCL       500--REDEF    2554>>ASSIGN
GLOBAL.KEY
       707**DCL       710--REDEF
GLOBAL.KEY.LENGTH
       708**DCL      2560>>ASSIGN
GLOBAL.KEY.VALUE
PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:95   
       709**DCL      2561>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       582**DCL       589--REDEF
GLOBAL.PRINTBUF.BUFFER
       741**DCL       742--REDEF     743--REDEF     744--REDEF
GLOBAL.PRINTBUF.ERR.V
       746**DCL       749--REDEF     750--REDEF     751--REDEF
GLOBAL$
       801**DCL       497--IMP-PTR  2553>>ASSIGN   2554>>ASSIGN   2560>>ASSIGN   2561>>ASSIGN
RECVAR.ACPTR
      1964**DCL      2559>>ASSIGN
RECVAR.BADDR
      1946**DCL      1949--REDEF
RECVAR.DBKEY
      1945**DCL      2557>>ASSIGN
RECVAR.RADDR
      1950**DCL      1954--REDEF
SC.DEF.SNL
      2542**DCL      2547--IMP-SIZ
SC.SCWSO
      2543**DCL      2556>>ASSIGN
SC$
      2529**DCL      2530--IMP-PTR  2555<<ASSIGN   2556>>ASSIGN
SETWS.AC
      1936**DCL      2559<<ASSIGN
SETWS.CURR
      1937**DCL      2557<<ASSIGN
SETWS.KEY.LENGTH
      1939**DCL      1940--IMP-SIZ  2560<<ASSIGN   2561>>ASSIGN
SETWS.KEY.VALUE
      1940**DCL      2561<<ASSIGN
SETWS.PRIV.CSE
      1928**DCL      2558<<ASSIGN
SETWS$
      1925**DCL      1926--IMP-PTR  2556<<ASSIGN   2557>>ASSIGN   2558>>ASSIGN   2559>>ASSIGN   2560>>ASSIGN
      2561>>ASSIGN   2561>>ASSIGN
PL6.E3A0      #004=ZIM$KCURR File=ZIM$KEYED.:ZIC0TSI                             FRI 09/05/97 13:02 Page:96   
SSS$
      1984**DCL      2554<<ASSIGN   2555>>ASSIGN
