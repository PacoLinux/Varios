
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:1    
        1        1        /*M*     ZIM$PRIVACY - Check for privacy procedures and passwords */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F*     This routine checks the authorization of the user to
        8        8                   access the database.  This is done through a series of
        9        9                   password checks against the schema file describing
       10       10                   the database being opened.  For each lock specified in the
       11       11                   schema file the user is given the oppertunity to supply
       12       12                   the key. Only if the lock and key match, will the user be
       13       13                   given access to the subset of the database associated with
       14       14                   that lock.
       15       15                   In order to implement this scheme we must allow a mechanism
       16       16                   whereby the user can supply the keys.  Thus we must
       17       17                   interrupt our own operation while retaining our context.
       18       18                   This is done through the IDS$ETC call.  Instead of exiting
       19       19                   ids in the normal manner this routine call's IDS$ETC
       20       20                   which will save the environment on the auto frame.
       21       21                   IDS$ETC also sets a flag indicating that we expect a
       22       22                   dbetc call from the user (see zie$DBETC for further
       23       23                   explanations).  When control is returned to this routine
       24       24                   we can then check the users key against the lock.         */
       25       25        ZIM$PRIVACY: PROC ALTRET
       26       26         /* USE($PR5 FOR GLOBAL$) */
       27       27               AVOID($PR5,$PR6,$PR7);
       28       28        %INCLUDE ZI$GLOBAL;
       29      514            %GLOBALS;
       30      822        %INCLUDE ZI$SCHEMA;
       31     1027            %SLT;
       32     1047            %SLK;
       33     1065            %SSI;
       34     1093            %SAS;
       35     1121        %INCLUDE ZI$SSS;
       36     1670            %OA1;
       37     1678            %OA;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:2    
       38     1743            %AC;
       39     1838            %SC;
       40     1865            %RC;
       41     1897            %FR;
       42     1943        %INCLUDE ZI$USER;
       43     2088            %IA;
       44     2137            %UWA;
       45     2164            %UPT;
       46     2194            %RCW;
       47     2204        %INCLUDE ZI$DBCB;
       48     2846            %DBCB;
       49     3324            %AWS;
       50     3364            %SETWS;
       51     3383            %RWS;
       52     3403            %FWS;
       53     3415            %RECVAR;
       54     3449        %INCLUDE ZI_ERRORS_C;
       55     3775    1   DCL ZIB$FIXREGS ENTRY;
       56     3776    1   DCL ZIR$ESCAPE ENTRY;
       57     3777    1   DCL ZIB$DBIOO ENTRY ALTRET;
       58     3778    1   DCL ZIM$DBIOQ ENTRY ALTRET;
       59     3779    1   DCL ZIG$DBPFD ENTRY ALTRET;
       60     3780    1   DCL ZIG$DBPFN ENTRY ALTRET;
       61     3781    1   DCL ZIG$DBPFO ENTRY ALTRET;
       62     3782    1   DCL ZIP$DBFSE ENTRY ALTRET;
       63     3783    1   DCL ZIM$LKMAP ENTRY(2) ALTRET;
       64     3784    1   DCL SSORG SYMREF UBIN(36);
       65     3785    1   DCL SFOA SYMREF UBIN(36);
       66     3786    1   DCL SFAC1 SYMREF UBIN(36);
       67     3787    1   DCL SF$AS SYMREF UBIN(36);
       68     3788    1   DCL AS$SI SYMREF UBIN(36);
       69     3789    1   DCL SN$SI SYMREF UBIN(36);
       70     3790    1   DCL SN$LT SYMREF UBIN(36);
       71     3791    1   DCL LK$LT SYMREF UBIN(36);
       72     3792    1   DCL ZI_USER BIT(1) SYMREF;
       73     3793    1   DCL 1 WSPRIV BASED,
       74     3794    1         2 * BIT(9) UNAL,
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:3    
       75     3795    1         2 L BIT(9) UNAL;
       76     3796    1   DCL ERROR UBIN(36);
       77     3797    1   DCL LKVALUE CHAR(12);
       78     3798    1   DCL TEMP UBIN(18);
       79     3799    1   DCL AMAX UBIN(18);
       80     3800    1   DCL I UBIN(36);
       81     3801    1   DCL J UBIN(36);
       82     3802    1   DCL FOUND UBIN(36);
       83     3803    1   DCL LOCKS BIT(9);
       84     3804    1   DCL TYPE UBIN(36);
       85     3805    1   DCL RADDR$ PTR;
       86     3806    1   DCL WSOFST$ PTR;
       87     3807    1   DCL BINDCD UBIN(36);
       88     3808    1   DCL ASFLAG UBIN(36);
       89     3809    1   DCL DBKSI UBIN(36);
       90     3810    1   DCL SIFLAG UBIN(36);
       91     3811    1   DCL LTFLAG UBIN(36);
       92     3812    1   DCL UPLOCKS BIT(9);
       93     3813    1   DCL SCHEMAS UBIN(36);
       94     3814    1   DCL SCHEMAN CHAR(30);
       95     3815    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
       96     3816    1       IF GLOBAL.DB.FLAGS.PCKD(GLOBAL.ACTIVE.DBNO) THEN
       97     3817    1           RETURN;
       98     3818    1       SSS$=GLOBAL.ACTIVE.SSS$;
       99     3819    1       OA$=PINCRW(SSS$,SIZEW(OA1));
      100     3820    1       SCHEMAS=OA.SCNAM.EIS.COUNT;
      101     3821    1       IF SCHEMAS>30 THEN
      102     3822    1           GOTO ER_NAME;
      103     3823    1       SCHEMAN=OA.SNAM;
      104     3824    1       SC$=PINCRW(SSS$,SIZEW(OA1));
      105     3825    2       DO WHILE (SC.OASCN~=0);
      106     3826    2           SC$=PINCRW(SSS$,SC.OASCN);
      107     3827    2           PINCRW(DBCB$,SC.SCWSO)->SETWS.PRIV=SETWS#PRIV#ALL;
      108     3828    2           END;
      109     3829    1       RC$=PINCRW(SSS$,SIZEW(OA1));
      110     3830    2       DO WHILE (RC.OARCN~=0);
      111     3831    2           RC$=PINCRW(SSS$,RC.OARCN);
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:4    
      112     3832    3           IF NOT RC.DEF.SR THEN DO;
      113     3833    3               PINCRW(DBCB$,RC.RCWSO)->RWS.PRIV=RWS#PRIV#ALL;
      114     3834    3               FR$=RC$;
      115     3835    4               DO WHILE (FR.RCFRN~=0);
      116     3836    4                   FR$=PINCRW(SSS$,FR.RCFRN);
      117     3837    4                   IF NOT (FR.DEF.SYN OR FR.DEF.FSR) THEN
      118     3838    4                       PINCRW(DBCB$,FR.FRWSO)->FWS.PRIV=FWS#PRIV#ALL;
      119     3839    4                   END;
      120     3840    3               END;
      121     3841    2           END;
      122     3842        /*         Navigate  through schema using  canned subschema    */
      123     3843    1       IF SCHEMAN='SCHEMA40' THEN
      124     3844    1           GOTO PCKD;
      125     3845    1       AMAX=PINCRW(SSS$,SIZEW(OA1))->OA.AMAX;
      126     3846    1       SSS$=GLOBAL.CANSSS$;
      127     3847    1       GLOBAL.ACTIVE.SSS$=SSS$;
      128     3848    1       CALL ZIB$FIXREGS;
      129     3849    1       OA$=PINCRW(SSS$,POFFW(ADDR(SFOA),ADDR(SSORG)));
      130     3850    1       OA$->OA.AMAX=AMAX;
      131     3851    1       AC$=PINCRW(SSS$,POFFW(ADDR(SFAC1),ADDR(SSORG)));
      132     3852    1       AC.DEF.ANL=SCHEMAS;
      133     3853    1       AC.ANAM=SCHEMAN;
      134     3854         /* Eis descriptor points to AC.ANAM also */
      135     3855    1       AC.SANAM.EIS.COUNT=SCHEMAS;
      136     3856    1       DBCB.IOWS.ACOPN=POFFW(ADDR(SFAC1),ADDR(SSORG));
      137     3857            %DBCAL(NAME=ZIB$DBIOO,ALT=ZAP);
      138     3873    1       PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY=2;
      139     3874            %DBCAL(NAME=ZIG$DBPFD,ALT=ER_FSF);
      140     3890    1       DBCB.PCB.PRSC=POFFW(ADDR(SF$AS),ADDR(SSORG));
      141     3891    1       DBCB.PCB.PRRC=BITBIN('400000'O); /* Rec request is any */
      142     3892    1       ASFLAG=0;
      143     3893    2       DO WHILE (ASFLAG=0);
      144     3894                %DBCAL(NAME=ZIG$DBPFN,EXC=ER_EAS,ALT=ER_FAS);
      145     3910    2           TEMP=DBCB.PCB.RVI;
      146     3911    2           DBCB.PCB.RVI=DBCB.PCB.RVO;
      147     3912    2           DBCB.PCB.RVO=TEMP;
      148     3913    2           RADDR$=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.RADDR$;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:5    
      149     3914    2           IF GLOBAL.DB.SSNAME(GLOBAL.ACTIVE.DBNO)=RADDR$->SAS.SS_NAME THEN
      150     3915    2               ASFLAG=1;
      151     3916    2           END;
      152     3917    1       IF PINCRW(GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO),SIZEW(OA1))->
      153     3918    1          OA.SSVDT~=RADDR$->SAS.SS_TRAN_DBCS THEN
      154     3919    1           GOTO ER_DTE;
      155     3920    1       DBKSI=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY;
      156     3921    1       SIFLAG=1;
      157     3922    2       DO WHILE (SIFLAG~=0);
      158     3923    2           DBCB.PCB.PRSC=POFFW(ADDR(AS$SI),ADDR(SSORG));
      159     3924    2           IF SIFLAG=2 THEN
      160     3925    3           DO;
      161     3926    3               PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY=DBKSI;
      162     3927                    %DBCAL(NAME=ZIG$DBPFD,ALT=ER_FSI);
      163     3943    3               SIFLAG=1;
      164     3944    3               END;
      165     3945                %DBCAL(NAME=ZIG$DBPFN,EXC=NOSI,ALT=ER_FSI);
      166     3961    2           TEMP=DBCB.PCB.RVI;
      167     3962    2           DBCB.PCB.RVI=DBCB.PCB.RVO;
      168     3963    2           DBCB.PCB.RVO=TEMP;
      169     3964    2           RADDR$=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.RADDR$;
      170     3965         /* If no more locked si's done */
      171     3966    2           IF RADDR$->SSI.EXCLUDE='1'B THEN
      172     3967    3           DO;
      173     3968    3   NOSI:       SIFLAG=0;
      174     3969    3               GOTO SIEND;
      175     3970    3               END;
      176     3971    2           IF RADDR$->SSI.LOCKED='0'B THEN
      177     3972    2               GOTO SIEND;
      178     3973    2           SIFLAG=2;
      179     3974    2           DBKSI=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY;
      180     3975        /* Change to propper fields */
      181     3976    2           TYPE=RADDR$->SSI.BINDCD.TYPE;
      182     3977    2           BINDCD=RADDR$->SSI.BINDCD.CODE;
      183     3978    2           GLOBAL.ACTIVE.SSS$=GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO);
      184     3979    2           CALL ZIB$FIXREGS;
      185     3980    2           GLOBAL.PARAN.DBFSE.TYPE=TYPE;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:6    
      186     3981    2           GLOBAL.PARAN.DBFSE.ID=BINDCD;
      187     3982                %DBCAL(NAME=ZIP$DBFSE,ALT=ER_FSE);
      188     3998         /* Areas never have privacy defined */
      189     3999    2           IF PINCRW(GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO),
      190     4000    2              GLOBAL.PARAN.DBFSE.SSOFST)->AC.DEF.TYPE=AC_CLASS THEN
      191     4001    2               GOTO SIEND;
      192     4002    2           GLOBAL.ACTIVE.SSS$=GLOBAL.CANSSS$;
      193     4003    2           CALL ZIB$FIXREGS;
      194     4004    2           WSOFST$=PINCRW(DBCB$,GLOBAL.PARAN.DBFSE.WSOFST);
      195     4005    2           WSOFST$->WSPRIV=WSOFST$->WSPRIV&(~RADDR$->SSI.LOCKED);
      196     4006    2           DBCB.PCB.PRSC=POFFW(ADDR(SN$SI),ADDR(SSORG));
      197     4007                %DBCAL(NAME=ZIG$DBPFO,ALT=ER_FSN);
      198     4023    2           TEMP=DBCB.PCB.RVI;
      199     4024    2           DBCB.PCB.RVI=DBCB.PCB.RVO;
      200     4025    2           DBCB.PCB.RVO=TEMP;
      201     4026    2           LTFLAG=1;
      202     4027    3           DO WHILE (LTFLAG=1);
      203     4028    3               DBCB.PCB.PRSC=POFFW(ADDR(SN$LT),ADDR(SSORG));
      204     4029                    %DBCAL(NAME=ZIG$DBPFN,EXC=SIEND,ALT=ER_FLT);
      205     4045    3               TEMP=DBCB.PCB.RVI;
      206     4046    3               DBCB.PCB.RVI=DBCB.PCB.RVO;
      207     4047    3               DBCB.PCB.RVO=TEMP;
      208     4048    3               RADDR$=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.RADDR$;
      209     4049    3               LOCKS=RADDR$->SLT.PLOCKS;
      210     4050    3               DBCB.PCB.PRSC=POFFW(ADDR(LK$LT),ADDR(SSORG));
      211     4051                    %DBCAL(NAME=ZIG$DBPFO,ALT=ER_FLK);
      212     4067    4               DO WHILE (LOCKS);
      213     4068    4                   FOUND=0;
      214     4069    4                   I=UPT.W1.COUNT;
      215     4070    5                   DO WHILE (I>0 AND FOUND~=1);
      216     4071    5                       I=I-1;
      217     4072    5                       IF UPT.UPTE.UCW.PT(I)=TYPE THEN
      218     4073    5                           IF UPT.UPTE.UCW.A(I)=BINDCD THEN
      219     4074    5                               IF LOCKS&UPT.UPTE.UCW.PB(I) THEN
      220     4075    5                                   FOUND=1;
      221     4076    5                               ELSE;
      222     4077    5                           ELSE;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:7    
      223     4078    5                       IF TYPE~=3 AND UPT.UPTE.UCW.A(I)=0 THEN
      224     4079    5                           IF LOCKS&UPT.UPTE.UCW.PB(I) THEN
      225     4080    6                           DO;
      226     4081    6                               FOUND=2;
      227     4082    6                               J=I;
      228     4083    6                               END;
      229     4084    5                       END;
      230     4085    4                   IF FOUND=0 THEN
      231     4086    4                       GOTO LTEND;
      232     4087    4                   IF FOUND=2 THEN
      233     4088    4                       I=J;
      234     4089    4                   UPLOCKS=LOCKS&UPT.UPTE.UCW.PB(I);
      235     4090    4                   LOCKS=LOCKS&(~UPLOCKS);
      236     4091        /*          If executed in user mode the following changes need to */
      237     4092        /*          made.  Skip from here to the statement RADDR$= . .     */
      238     4093        /*          Also the IF should be forced to be true.               */
      239     4094        /*          This is caused by the fact that going out to the user  */
      240     4095        /*          when not a real ASL mucks up the AUTO stack during     */
      241     4096        /*          this call.                                             */
      242     4097    5                   IF ~ZI_USER THEN DO;
      243     4098    5                       IA.UPFLAG.UPADR=UPT.UPTE.W2.UPADR(I);
      244     4099    5                       IA.UPFLAG.FLAGS.ETC='1'B; /* Return through etc */
      245     4100    5                       CALL ZIR$ESCAPE;
      246     4101        /*          Reset to Canned SSS when returning from privacy */
      247     4102    5                       GLOBAL.ACTIVE.SSS$=GLOBAL.CANSSS$;
      248     4103    5                       CALL ZIB$FIXREGS;
      249     4104    5                       END;
      250     4105    4                   RADDR$=PINCRW(DBCB$,DBCB.PCB.RVO)->RECVAR.RADDR$;
      251     4106    4                   CALL ZIM$LKMAP(UWA.DBPKY,LKVALUE);
      252     4107    4                   IF RADDR$->SLK.PLVALUE=LKVALUE OR ZI_USER THEN
      253     4108    4                       WSOFST$->WSPRIV.L=WSOFST$->WSPRIV.L|UPLOCKS;
      254     4109    4   LOCKEND:        END;
      255     4110    3   LTEND:      END;
      256     4111    2   SIEND:  END;
      257     4112            %DBCAL(NAME=ZIM$DBIOQ,ALT=ZAP);
      258     4128    1       GLOBAL.ACTIVE.SSS$=GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO);
      259     4129    1       CALL ZIB$FIXREGS;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:8    
      260     4130    1   PCKD: GLOBAL.DB.FLAGS.PCKD(GLOBAL.ACTIVE.DBNO)='1'B;
      261     4131    1       RETURN;
      262     4132    1   ER_EAS: ERROR=ERR#CM#SSNF;
      263     4133    1       GOTO CLOSE;
      264     4134    1   ER_DTE: ERROR=ERR#CM#INSST;
      265     4135    1       GOTO CLOSE;
      266     4136    1   ER_NAME: ERROR=ERR#CM#INNM;
      267     4137    1       GOTO CLOSE;
      268     4138    1   ER_FSF: ;
      269     4139    1   ER_FAS: ;
      270     4140    1   ER_FSI: ;
      271     4141    1   ER_FSE: ;
      272     4142    1   ER_FSN: ;
      273     4143    1   ER_FLT: ;
      274     4144    1   ER_FLK: ;
      275     4145    1   ER_IOQ: ;
      276     4146    1   CLOSE: ;
      277     4147            %DBCAL(NAME=ZIM$DBIOQ,ALT=ZAP);
      278     4163    1   ZAP: GLOBAL.ACTIVE.SSS$=GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO);
      279     4164    1       CALL ZIB$FIXREGS;
      280     4165            %DBALT;
      281     4179    1   END ZIM$PRIVACY;

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:9    
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$SCHEMA.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIM$PRIVACY.

   Procedure ZIM$PRIVACY requires 583 words for executable code.
   Procedure ZIM$PRIVACY requires 48 words of local(AUTO) storage.

    No errors detected in file ZIM$PRIVACY.:ZIC0TSI    .

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:10   

 Object Unit name= ZIM$PRIVACY                                File name= ZIM$PRIVACY.:ZIC0TOU
 UTS= SEP 05 '97 13:04:42.48 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  ZIM$PRIVACY
    1   Proc  even  none   583   1107  ZIM$PRIVACY
    2  RoData even  none    11     13  ZIM$PRIVACY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      XStd       0  ZIM$PRIVACY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIB$FIXREGS
 yes     yes           XStd      0 ZIG$DBPFN
 yes     yes           XStd      0 ZIP$DBFSE
 yes     yes           XStd      2 ZIM$LKMAP
         yes           XStd      0 ZIB$ERR
 yes     yes           XStd      0 ZIB$DBIOO
 yes     yes           XStd      0 ZIG$DBPFD
         yes           XStd      0 ZIR$ESCAPE
 yes     yes           XStd      0 ZIM$DBIOQ
 yes     yes           XStd      0 ZIG$DBPFO
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               IA$                                   UWA$
     UPT$                                  SSORG                                 SFOA
     SFAC1                                 SF$AS                                 AS$SI
     SN$SI                                 SN$LT                                 LK$LT
     ZI_USER

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:12   


        1        1        /*M*     ZIM$PRIVACY - Check for privacy procedures and passwords */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F*     This routine checks the authorization of the user to
        8        8                   access the database.  This is done through a series of
        9        9                   password checks against the schema file describing
       10       10                   the database being opened.  For each lock specified in the
       11       11                   schema file the user is given the oppertunity to supply
       12       12                   the key. Only if the lock and key match, will the user be
       13       13                   given access to the subset of the database associated with
       14       14                   that lock.
       15       15                   In order to implement this scheme we must allow a mechanism
       16       16                   whereby the user can supply the keys.  Thus we must
       17       17                   interrupt our own operation while retaining our context.
       18       18                   This is done through the IDS$ETC call.  Instead of exiting
       19       19                   ids in the normal manner this routine call's IDS$ETC
       20       20                   which will save the environment on the auto frame.
       21       21                   IDS$ETC also sets a flag indicating that we expect a
       22       22                   dbetc call from the user (see zie$DBETC for further
       23       23                   explanations).  When control is returned to this routine
       24       24                   we can then check the users key against the lock.         */
       25       25        ZIM$PRIVACY: PROC ALTRET

     25  1 000000   000000 700200 xent  ZIM$PRIVACY  TSX0  ! X66_AUTO_0
         1 000001   000060 000000                    ZERO    48,0

       26       26         /* USE($PR5 FOR GLOBAL$) */
       27       27               AVOID($PR5,$PR6,$PR7);
       28       28        %INCLUDE ZI$GLOBAL;
       29      514            %GLOBALS;
       30      822        %INCLUDE ZI$SCHEMA;
       31     1027            %SLT;
       32     1047            %SLK;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:13   
       33     1065            %SSI;
       34     1093            %SAS;
       35     1121        %INCLUDE ZI$SSS;
       36     1670            %OA1;
       37     1678            %OA;
       38     1743            %AC;
       39     1838            %SC;
       40     1865            %RC;
       41     1897            %FR;
       42     1943        %INCLUDE ZI$USER;
       43     2088            %IA;
       44     2137            %UWA;
       45     2164            %UPT;
       46     2194            %RCW;
       47     2204        %INCLUDE ZI$DBCB;
       48     2846            %DBCB;
       49     3324            %AWS;
       50     3364            %SETWS;
       51     3383            %RWS;
       52     3403            %FWS;
       53     3415            %RECVAR;
       54     3449        %INCLUDE ZI_ERRORS_C;
       55     3775    1   DCL ZIB$FIXREGS ENTRY;
       56     3776    1   DCL ZIR$ESCAPE ENTRY;
       57     3777    1   DCL ZIB$DBIOO ENTRY ALTRET;
       58     3778    1   DCL ZIM$DBIOQ ENTRY ALTRET;
       59     3779    1   DCL ZIG$DBPFD ENTRY ALTRET;
       60     3780    1   DCL ZIG$DBPFN ENTRY ALTRET;
       61     3781    1   DCL ZIG$DBPFO ENTRY ALTRET;
       62     3782    1   DCL ZIP$DBFSE ENTRY ALTRET;
       63     3783    1   DCL ZIM$LKMAP ENTRY(2) ALTRET;
       64     3784    1   DCL SSORG SYMREF UBIN(36);
       65     3785    1   DCL SFOA SYMREF UBIN(36);
       66     3786    1   DCL SFAC1 SYMREF UBIN(36);
       67     3787    1   DCL SF$AS SYMREF UBIN(36);
       68     3788    1   DCL AS$SI SYMREF UBIN(36);
       69     3789    1   DCL SN$SI SYMREF UBIN(36);
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:14   
       70     3790    1   DCL SN$LT SYMREF UBIN(36);
       71     3791    1   DCL LK$LT SYMREF UBIN(36);
       72     3792    1   DCL ZI_USER BIT(1) SYMREF;
       73     3793    1   DCL 1 WSPRIV BASED,
       74     3794    1         2 * BIT(9) UNAL,
       75     3795    1         2 L BIT(9) UNAL;
       76     3796    1   DCL ERROR UBIN(36);
       77     3797    1   DCL LKVALUE CHAR(12);
       78     3798    1   DCL TEMP UBIN(18);
       79     3799    1   DCL AMAX UBIN(18);
       80     3800    1   DCL I UBIN(36);
       81     3801    1   DCL J UBIN(36);
       82     3802    1   DCL FOUND UBIN(36);
       83     3803    1   DCL LOCKS BIT(9);
       84     3804    1   DCL TYPE UBIN(36);
       85     3805    1   DCL RADDR$ PTR;
       86     3806    1   DCL WSOFST$ PTR;
       87     3807    1   DCL BINDCD UBIN(36);
       88     3808    1   DCL ASFLAG UBIN(36);
       89     3809    1   DCL DBKSI UBIN(36);
       90     3810    1   DCL SIFLAG UBIN(36);
       91     3811    1   DCL LTFLAG UBIN(36);
       92     3812    1   DCL UPLOCKS BIT(9);
       93     3813    1   DCL SCHEMAS UBIN(36);
       94     3814    1   DCL SCHEMAN CHAR(30);
       95     3815    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   3815  1 000002   000000 470400 xsym               LDP0    GLOBAL$
         1 000003   000001 236100                    LDQ     1,,PR0
         1 000004   200012 756100                    STQ     DBCB$,,AUTO

       96     3816    1       IF GLOBAL.DB.FLAGS.PCKD(GLOBAL.ACTIVE.DBNO) THEN

   3816  1 000005   000002 235100                    LDA     2,,PR0
         1 000006   000167 236105                    LDQ     119,AL,PR0
         1 000007   100000 316003                    CANQ    32768,DU
         1 000010   000012 600000 1                  TZE     s:3818
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:15   

       97     3817    1           RETURN;

   3817  1 000011   000000 702200 xent               TSX2  ! X66_ARET

       98     3818    1       SSS$=GLOBAL.ACTIVE.SSS$;

   3818  1 000012   000000 236100                    LDQ     0,,PR0
         1 000013   200003 756100                    STQ     SSS$,,AUTO

       99     3819    1       OA$=PINCRW(SSS$,SIZEW(OA1));

   3819  1 000014   000001 036003                    ADLQ    1,DU
         1 000015   200005 756100                    STQ     OA$,,AUTO

      100     3820    1       SCHEMAS=OA.SCNAM.EIS.COUNT;

   3820  1 000016   200005 471500                    LDP1    OA$,,AUTO
         1 000017   100004 236100                    LDQ     4,,PR1
         1 000020   007777 376007                    ANQ     4095,DL
         1 000021   200042 756100                    STQ     SCHEMAS,,AUTO

      101     3821    1       IF SCHEMAS>30 THEN

   3821  1 000022   000037 116007                    CMPQ    31,DL
         1 000023   001046 603000 1                  TRC     ER_NAME

      102     3822    1           GOTO ER_NAME;
      103     3823    1       SCHEMAN=OA.SNAM;

   3823  1 000024   100004 720100                    LXL0    4,,PR1
         1 000025   007777 360003                    ANX0    4095,DU
         1 000026   040100 100540                    MLR     fill='040'O
         1 000027   100025 000010                    ADSC9   21,,PR1                  cn=0,n=*X0
         1 000030   200043 000036                    ADSC9   SCHEMAN,,AUTO            cn=0,n=30

      104     3824    1       SC$=PINCRW(SSS$,SIZEW(OA1));
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:16   

   3824  1 000031   200003 236100                    LDQ     SSS$,,AUTO
         1 000032   000001 036003                    ADLQ    1,DU
         1 000033   200007 756100                    STQ     SC$,,AUTO

      105     3825    2       DO WHILE (SC.OASCN~=0);

   3825  1 000034   200007 473500                    LDP3    SC$,,AUTO
         1 000035   300001 721100                    LXL1    1,,PR3
         1 000036   000053 600000 1                  TZE     s:3829

      106     3826    2           SC$=PINCRW(SSS$,SC.OASCN);

   3826  1 000037   200007 470500                    LDP0    SC$,,AUTO
         1 000040   000001 720100                    LXL0    1,,PR0
         1 000041   000000 636010                    EAQ     0,X0
         1 000042   200003 036100                    ADLQ    SSS$,,AUTO
         1 000043   200007 756100                    STQ     SC$,,AUTO

      107     3827    2           PINCRW(DBCB$,SC.SCWSO)->SETWS.PRIV=SETWS#PRIV#ALL;

   3827  1 000044   200007 470500                    LDP0    SC$,,AUTO
         1 000045   000001 220100                    LDX0    1,,PR0
         1 000046   000434 221003                    LDX1    284,DU
         1 000047   200012 471500                    LDP1    DBCB$,,AUTO
         1 000050   100000 741110                    STX1    0,X0,PR1

      108     3828    2           END;

   3828  1 000051   000001 720100                    LXL0    1,,PR0
         1 000052   000037 601000 1                  TNZ     s:3826

      109     3829    1       RC$=PINCRW(SSS$,SIZEW(OA1));

   3829  1 000053   200003 236100                    LDQ     SSS$,,AUTO
         1 000054   000001 036003                    ADLQ    1,DU
         1 000055   200010 756100                    STQ     RC$,,AUTO
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:17   

      110     3830    2       DO WHILE (RC.OARCN~=0);

   3830  1 000056   200010 470500                    LDP0    RC$,,AUTO
         1 000057   000002 220100                    LDX0    2,,PR0
         1 000060   000127 600000 1                  TZE     s:3843

      111     3831    2           RC$=PINCRW(SSS$,RC.OARCN);

   3831  1 000061   200010 470500                    LDP0    RC$,,AUTO
         1 000062   000002 220100                    LDX0    2,,PR0
         1 000063   000000 636010                    EAQ     0,X0
         1 000064   200003 036100                    ADLQ    SSS$,,AUTO
         1 000065   200010 756100                    STQ     RC$,,AUTO

      112     3832    3           IF NOT RC.DEF.SR THEN DO;

   3832  1 000066   200010 470500                    LDP0    RC$,,AUTO
         1 000067   000000 236100                    LDQ     0,,PR0
         1 000070   100000 316007                    CANQ    32768,DL
         1 000071   000124 601000 1                  TNZ     s:3841

      113     3833    3               PINCRW(DBCB$,RC.RCWSO)->RWS.PRIV=RWS#PRIV#ALL;

   3833  1 000072   000004 220100                    LDX0    4,,PR0
         1 000073   000774 221003                    LDX1    508,DU
         1 000074   200012 471500                    LDP1    DBCB$,,AUTO
         1 000075   100000 741110                    STX1    0,X0,PR1

      114     3834    3               FR$=RC$;

   3834  1 000076   200010 236100                    LDQ     RC$,,AUTO
         1 000077   200011 756100                    STQ     FR$,,AUTO

      115     3835    4               DO WHILE (FR.RCFRN~=0);

   3835  1 000100   200011 473500                    LDP3    FR$,,AUTO
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:18   
         1 000101   300004 720100                    LXL0    4,,PR3
         1 000102   000124 600000 1                  TZE     s:3841

      116     3836    4                   FR$=PINCRW(SSS$,FR.RCFRN);

   3836  1 000103   200011 470500                    LDP0    FR$,,AUTO
         1 000104   000004 720100                    LXL0    4,,PR0
         1 000105   000000 636010                    EAQ     0,X0
         1 000106   200003 036100                    ADLQ    SSS$,,AUTO
         1 000107   200011 756100                    STQ     FR$,,AUTO

      117     3837    4                   IF NOT (FR.DEF.SYN OR FR.DEF.FSR) THEN

   3837  1 000110   200011 470500                    LDP0    FR$,,AUTO
         1 000111   000000 236100                    LDQ     0,,PR0
         1 000112   004000 316007                    CANQ    2048,DL
         1 000113   000122 601000 1                  TNZ     s:3839
         1 000114   000100 316007                    CANQ    64,DL
         1 000115   000122 601000 1                  TNZ     s:3839

      118     3838    4                       PINCRW(DBCB$,FR.FRWSO)->FWS.PRIV=FWS#PRIV#ALL;

   3838  1 000116   000005 720100                    LXL0    5,,PR0
         1 000117   000700 221003                    LDX1    448,DU
         1 000120   200012 471500                    LDP1    DBCB$,,AUTO
         1 000121   100000 741110                    STX1    0,X0,PR1

      119     3839    4                   END;

   3839  1 000122   000004 720100                    LXL0    4,,PR0
         1 000123   000103 601000 1                  TNZ     s:3836

      120     3840    3               END;

      121     3841    2           END;

   3841  1 000124   200010 470500                    LDP0    RC$,,AUTO
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:19   
         1 000125   000002 220100                    LDX0    2,,PR0
         1 000126   000061 601000 1                  TNZ     s:3831

      122     3842        /*         Navigate  through schema using  canned subschema    */
      123     3843    1       IF SCHEMAN='SCHEMA40' THEN

   3843  1 000127   040000 106500                    CMPC    fill='040'O
         1 000130   200043 000036                    ADSC9   SCHEMAN,,AUTO            cn=0,n=30
         1 000131   000000 000010 0                  ADSC9   0                        cn=0,n=8
         1 000132   001033 600000 1                  TZE     PCKD

      124     3844    1           GOTO PCKD;
      125     3845    1       AMAX=PINCRW(SSS$,SIZEW(OA1))->OA.AMAX;

   3845  1 000133   200003 471500                    LDP1    SSS$,,AUTO
         1 000134   100017 221100                    LDX1    15,,PR1
         1 000135   200024 741100                    STX1    AMAX,,AUTO

      126     3846    1       SSS$=GLOBAL.CANSSS$;

   3846  1 000136   000000 473400 xsym               LDP3    GLOBAL$
         1 000137   300003 236100                    LDQ     3,,PR3
         1 000140   200003 756100                    STQ     SSS$,,AUTO

      127     3847    1       GLOBAL.ACTIVE.SSS$=SSS$;

   3847  1 000141   300000 756100                    STQ     0,,PR3

      128     3848    1       CALL ZIB$FIXREGS;

   3848  1 000142   000001 631400 2                  EPPR1   1
         1 000143   000000 701000 xent               TSX1    ZIB$FIXREGS
         1 000144   000000 011000                    NOP     0

      129     3849    1       OA$=PINCRW(SSS$,POFFW(ADDR(SFOA),ADDR(SSORG)));

   3849  1 000145   000002 236000 2                  LDQ     2
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:20   
         1 000146   000022 772000                    QRL     18
         1 000147   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000150   000003 236000 2                  LDQ     3
         1 000151   000022 772000                    QRL     18
         1 000152   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000153   000022 736000                    QLS     18
         1 000154   200003 036100                    ADLQ    SSS$,,AUTO
         1 000155   200005 756100                    STQ     OA$,,AUTO

      130     3850    1       OA$->OA.AMAX=AMAX;

   3850  1 000156   200024 220100                    LDX0    AMAX,,AUTO
         1 000157   200005 470500                    LDP0    OA$,,AUTO
         1 000160   000016 740100                    STX0    14,,PR0

      131     3851    1       AC$=PINCRW(SSS$,POFFW(ADDR(SFAC1),ADDR(SSORG)));

   3851  1 000161   000002 236000 2                  LDQ     2
         1 000162   000022 772000                    QRL     18
         1 000163   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000164   000004 236000 2                  LDQ     4
         1 000165   000022 772000                    QRL     18
         1 000166   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000167   000022 736000                    QLS     18
         1 000170   200003 036100                    ADLQ    SSS$,,AUTO
         1 000171   200006 756100                    STQ     AC$,,AUTO

      132     3852    1       AC.DEF.ANL=SCHEMAS;

   3852  1 000172   200006 471500                    LDP1    AC$,,AUTO
         1 000173   200042 236100                    LDQ     SCHEMAS,,AUTO
         1 000174   100000 752101                    STCQ    0,'01'O,PR1

      133     3853    1       AC.ANAM=SCHEMAN;

   3853  1 000175   100000 721100                    LXL1    0,,PR1
         1 000176   000077 361003                    ANX1    63,DU
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:21   
         1 000177   040140 100500                    MLR     fill='040'O
         1 000200   200043 000036                    ADSC9   SCHEMAN,,AUTO            cn=0,n=30
         1 000201   100026 000011                    ADSC9   22,,PR1                  cn=0,n=*X1

      134     3854         /* Eis descriptor points to AC.ANAM also */
      135     3855    1       AC.SANAM.EIS.COUNT=SCHEMAS;

   3855  1 000202   100005 752103                    STCQ    5,'03'O,PR1

      136     3856    1       DBCB.IOWS.ACOPN=POFFW(ADDR(SFAC1),ADDR(SSORG));

   3856  1 000203   000002 236000 2                  LDQ     2
         1 000204   000022 772000                    QRL     18
         1 000205   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000206   000004 236000 2                  LDQ     4
         1 000207   000022 772000                    QRL     18
         1 000210   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000211   000000 621006                    EAX1    0,QL
         1 000212   200012 473500                    LDP3    DBCB$,,AUTO
         1 000213   301016 741100                    STX1    526,,PR3

      137     3857            %DBCAL(NAME=ZIB$DBIOO,ALT=ZAP);

   3861  1 000214   000001 631400 2                  EPPR1   1
         1 000215   000000 701000 xent               TSX1    ZIB$DBIOO
         1 000216   001057 702000 1                  TSX2    ZAP

   3862  1 000217   000000 470400 xsym               LDP0    GLOBAL$
         1 000220   000006 235100                    LDA     6,,PR0
         1 000221   001057 601000 1                  TNZ     ZAP

      138     3873    1       PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY=2;

   3873  1 000222   200012 471500                    LDP1    DBCB$,,AUTO
         1 000223   100510 220100                    LDX0    328,,PR1
         1 000224   000002 236007                    LDQ     2,DL
         1 000225   100000 756110                    STQ     0,X0,PR1
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:22   

      139     3874            %DBCAL(NAME=ZIG$DBPFD,ALT=ER_FSF);

   3878  1 000226   000001 631400 2                  EPPR1   1
         1 000227   000000 701000 xent               TSX1    ZIG$DBPFD
         1 000230   001051 702000 1                  TSX2    ER_FSF

   3879  1 000231   000000 470400 xsym               LDP0    GLOBAL$
         1 000232   000006 235100                    LDA     6,,PR0
         1 000233   001051 601000 1                  TNZ     ER_FSF

      140     3890    1       DBCB.PCB.PRSC=POFFW(ADDR(SF$AS),ADDR(SSORG));

   3890  1 000234   000002 236000 2                  LDQ     2
         1 000235   000022 772000                    QRL     18
         1 000236   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000237   000005 236000 2                  LDQ     5
         1 000240   000022 772000                    QRL     18
         1 000241   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000242   000000 620006                    EAX0    0,QL
         1 000243   200012 471500                    LDP1    DBCB$,,AUTO
         1 000244   100520 740100                    STX0    336,,PR1

      141     3891    1       DBCB.PCB.PRRC=BITBIN('400000'O); /* Rec request is any */

   3891  1 000245   400000 221003                    LDX1    -131072,DU
         1 000246   100517 741100                    STX1    335,,PR1

      142     3892    1       ASFLAG=0;

   3892  1 000247   200035 450100                    STZ     ASFLAG,,AUTO

      143     3893    2       DO WHILE (ASFLAG=0);

   3893  1 000250   200035 235100                    LDA     ASFLAG,,AUTO
         1 000251   000306 601000 1                  TNZ     s:3917

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:23   
      144     3894                %DBCAL(NAME=ZIG$DBPFN,EXC=ER_EAS,ALT=ER_FAS);

   3898  1 000252   000001 631400 2                  EPPR1   1
         1 000253   000000 701000 xent               TSX1    ZIG$DBPFN
         1 000254   001051 702000 1                  TSX2    ER_FSF

   3899  1 000255   000000 470400 xsym               LDP0    GLOBAL$
         1 000256   000006 235100                    LDA     6,,PR0
         1 000257   000262 600000 1                  TZE     s:3910

   3904  1 000260   000006 450100                    STZ     6,,PR0

   3905  1 000261   001040 710000 1                  TRA     ER_EAS

      145     3910    2           TEMP=DBCB.PCB.RVI;

   3910  1 000262   200012 471500                    LDP1    DBCB$,,AUTO
         1 000263   100510 220100                    LDX0    328,,PR1
         1 000264   200023 740100                    STX0    TEMP,,AUTO

      146     3911    2           DBCB.PCB.RVI=DBCB.PCB.RVO;

   3911  1 000265   100511 221100                    LDX1    329,,PR1
         1 000266   100510 741100                    STX1    328,,PR1

      147     3912    2           DBCB.PCB.RVO=TEMP;

   3912  1 000267   100511 740100                    STX0    329,,PR1

      148     3913    2           RADDR$=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.RADDR$;

   3913  1 000270   100002 236111                    LDQ     2,X1,PR1
         1 000271   200032 756100                    STQ     RADDR$,,AUTO

      149     3914    2           IF GLOBAL.DB.SSNAME(GLOBAL.ACTIVE.DBNO)=RADDR$->SAS.SS_NAME THEN

   3914  1 000272   000002 235100                    LDA     2,,PR0
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:24   
         1 000273   000044 733000                    LRS     36
         1 000274   000036 402007                    MPY     30,DL
         1 000275   200032 473500                    LDP3    RADDR$,,AUTO
         1 000276   040100 106506                    CMPC    fill='040'O
         1 000277   000076 000036                    ADSC9   62,Q,PR0                 cn=0,n=30
         1 000300   300006 400036                    ADSC9   6,,PR3                   cn=2,n=30
         1 000301   000304 601000 1                  TNZ     s:3916

      150     3915    2               ASFLAG=1;

   3915  1 000302   000001 235007                    LDA     1,DL
         1 000303   200035 755100                    STA     ASFLAG,,AUTO

      151     3916    2           END;

   3916  1 000304   200035 235100                    LDA     ASFLAG,,AUTO
         1 000305   000252 600000 1                  TZE     s:3898

      152     3917    1       IF PINCRW(GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO),SIZEW(OA1))->

   3917  1 000306   000002 235100                    LDA     2,,PR0
         1 000307   000153 473505                    LDP3    107,AL,PR0
         1 000310   200032 474500                    LDP4    RADDR$,,AUTO
         1 000311   040100 106500                    CMPC    fill='040'O
         1 000312   300011 000010                    ADSC9   9,,PR3                   cn=0,n=8
         1 000313   400021 000010                    ADSC9   17,,PR4                  cn=0,n=8
         1 000314   001043 601000 1                  TNZ     ER_DTE

      153     3918    1          OA.SSVDT~=RADDR$->SAS.SS_TRAN_DBCS THEN
      154     3919    1           GOTO ER_DTE;
      155     3920    1       DBKSI=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY;

   3920  1 000315   100510 220100                    LDX0    328,,PR1
         1 000316   100000 235110                    LDA     0,X0,PR1
         1 000317   200036 755100                    STA     DBKSI,,AUTO

      156     3921    1       SIFLAG=1;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:25   

   3921  1 000320   000001 236007                    LDQ     1,DL
         1 000321   200037 756100                    STQ     SIFLAG,,AUTO

      157     3922    2       DO WHILE (SIFLAG~=0);

   3922  1 000322   001017 600000 1                  TZE     s:4116

      158     3923    2           DBCB.PCB.PRSC=POFFW(ADDR(AS$SI),ADDR(SSORG));

   3923  1 000323   000002 236000 2                  LDQ     2
         1 000324   000022 772000                    QRL     18
         1 000325   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000326   000006 236000 2                  LDQ     6
         1 000327   000022 772000                    QRL     18
         1 000330   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000331   000000 620006                    EAX0    0,QL
         1 000332   200012 470500                    LDP0    DBCB$,,AUTO
         1 000333   000520 740100                    STX0    336,,PR0

      159     3924    2           IF SIFLAG=2 THEN

   3924  1 000334   200037 235100                    LDA     SIFLAG,,AUTO
         1 000335   000002 115007                    CMPA    2,DL
         1 000336   000352 601000 1                  TNZ     s:3949

      160     3925    3           DO;

      161     3926    3               PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY=DBKSI;

   3926  1 000337   000510 221100                    LDX1    328,,PR0
         1 000340   200036 236100                    LDQ     DBKSI,,AUTO
         1 000341   000000 756111                    STQ     0,X1,PR0

      162     3927                    %DBCAL(NAME=ZIG$DBPFD,ALT=ER_FSI);

   3931  1 000342   000001 631400 2                  EPPR1   1
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:26   
         1 000343   000000 701000 xent               TSX1    ZIG$DBPFD
         1 000344   001051 702000 1                  TSX2    ER_FSF

   3932  1 000345   000000 470400 xsym               LDP0    GLOBAL$
         1 000346   000006 235100                    LDA     6,,PR0
         1 000347   001051 601000 1                  TNZ     ER_FSF

      163     3943    3               SIFLAG=1;

   3943  1 000350   000001 236007                    LDQ     1,DL
         1 000351   200037 756100                    STQ     SIFLAG,,AUTO

      164     3944    3               END;

      165     3945                %DBCAL(NAME=ZIG$DBPFN,EXC=NOSI,ALT=ER_FSI);

   3949  1 000352   000001 631400 2                  EPPR1   1
         1 000353   000000 701000 xent               TSX1    ZIG$DBPFN
         1 000354   001051 702000 1                  TSX2    ER_FSF

   3950  1 000355   000000 470400 xsym               LDP0    GLOBAL$
         1 000356   000006 235100                    LDA     6,,PR0
         1 000357   000362 600000 1                  TZE     s:3961

   3955  1 000360   000006 450100                    STZ     6,,PR0

   3956  1 000361   000377 710000 1                  TRA     NOSI

      166     3961    2           TEMP=DBCB.PCB.RVI;

   3961  1 000362   200012 471500                    LDP1    DBCB$,,AUTO
         1 000363   100510 220100                    LDX0    328,,PR1
         1 000364   200023 740100                    STX0    TEMP,,AUTO

      167     3962    2           DBCB.PCB.RVI=DBCB.PCB.RVO;

   3962  1 000365   100511 221100                    LDX1    329,,PR1
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:27   
         1 000366   100510 741100                    STX1    328,,PR1

      168     3963    2           DBCB.PCB.RVO=TEMP;

   3963  1 000367   100511 740100                    STX0    329,,PR1

      169     3964    2           RADDR$=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.RADDR$;

   3964  1 000370   100002 236111                    LDQ     2,X1,PR1
         1 000371   200032 756100                    STQ     RADDR$,,AUTO

      170     3965         /* If no more locked si's done */
      171     3966    2           IF RADDR$->SSI.EXCLUDE='1'B THEN

   3966  1 000372   200032 473500                    LDP3    RADDR$,,AUTO
         1 000373   000000 066500                    CMPB    filb='0'B
         1 000374   300007 640001                    BDSC    7,,PR3                   by=3,bit=4,n=1
         1 000375   000001 000022 2                  BDSC    1                        by=0,bit=0,n=18
         1 000376   000401 600000 1                  TZE     s:3971

      172     3967    3           DO;

      173     3968    3   NOSI:       SIFLAG=0;

   3968  1 000377   200037 450100       NOSI         STZ     SIFLAG,,AUTO

      174     3969    3               GOTO SIEND;

   3969  1 000400   001015 710000 1                  TRA     SIEND

      175     3970    3               END;
      176     3971    2           IF RADDR$->SSI.LOCKED='0'B THEN

   3971  1 000401   000000 066500                    CMPB    filb='0'B
         1 000402   300005 000022                    BDSC    5,,PR3                   by=0,bit=0,n=18
         1 000403   000001 000022 2                  BDSC    1                        by=0,bit=0,n=18
         1 000404   001015 600000 1                  TZE     SIEND
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:28   

      177     3972    2               GOTO SIEND;
      178     3973    2           SIFLAG=2;

   3973  1 000405   000002 235007                    LDA     2,DL
         1 000406   200037 755100                    STA     SIFLAG,,AUTO

      179     3974    2           DBKSI=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.DBKEY;

   3974  1 000407   100000 235111                    LDA     0,X1,PR1
         1 000410   200036 755100                    STA     DBKSI,,AUTO

      180     3975        /* Change to propper fields */
      181     3976    2           TYPE=RADDR$->SSI.BINDCD.TYPE;

   3976  1 000411   003100 061500                    CSR     bolr='003'O
         1 000412   300006 200011                    BDSC    6,,PR3                   by=1,bit=0,n=9
         1 000413   200031 000044                    BDSC    TYPE,,AUTO               by=0,bit=0,n=36

      182     3977    2           BINDCD=RADDR$->SSI.BINDCD.CODE;

   3977  1 000414   003100 061500                    CSR     bolr='003'O
         1 000415   300006 400022                    BDSC    6,,PR3                   by=2,bit=0,n=18
         1 000416   200034 000044                    BDSC    BINDCD,,AUTO             by=0,bit=0,n=36

      183     3978    2           GLOBAL.ACTIVE.SSS$=GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO);

   3978  1 000417   000002 235100                    LDA     2,,PR0
         1 000420   000153 236105                    LDQ     107,AL,PR0
         1 000421   000000 756100                    STQ     0,,PR0

      184     3979    2           CALL ZIB$FIXREGS;

   3979  1 000422   000001 631400 2                  EPPR1   1
         1 000423   000000 701000 xent               TSX1    ZIB$FIXREGS
         1 000424   000000 011000                    NOP     0

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:29   
      185     3980    2           GLOBAL.PARAN.DBFSE.TYPE=TYPE;

   3980  1 000425   200031 720100                    LXL0    TYPE,,AUTO
         1 000426   000000 470400 xsym               LDP0    GLOBAL$
         1 000427   000037 740100                    STX0    31,,PR0

      186     3981    2           GLOBAL.PARAN.DBFSE.ID=BINDCD;

   3981  1 000430   200034 721100                    LXL1    BINDCD,,AUTO
         1 000431   000037 441100                    SXL1    31,,PR0

      187     3982                %DBCAL(NAME=ZIP$DBFSE,ALT=ER_FSE);

   3986  1 000432   000001 631400 2                  EPPR1   1
         1 000433   000000 701000 xent               TSX1    ZIP$DBFSE
         1 000434   001051 702000 1                  TSX2    ER_FSF

   3987  1 000435   000000 470400 xsym               LDP0    GLOBAL$
         1 000436   000006 235100                    LDA     6,,PR0
         1 000437   001051 601000 1                  TNZ     ER_FSF

      188     3998         /* Areas never have privacy defined */
      189     3999    2           IF PINCRW(GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO),

   3999  1 000440   000002 235100                    LDA     2,,PR0
         1 000441   000040 220100                    LDX0    32,,PR0
         1 000442   000153 471505                    LDP1    107,AL,PR0
         1 000443   100000 236110                    LDQ     0,X0,PR1
         1 000444   777700 376003                    ANQ     -64,DU
         1 000445   200000 116003                    CMPQ    65536,DU
         1 000446   001015 600000 1                  TZE     SIEND

      190     4000    2              GLOBAL.PARAN.DBFSE.SSOFST)->AC.DEF.TYPE=AC_CLASS THEN
      191     4001    2               GOTO SIEND;
      192     4002    2           GLOBAL.ACTIVE.SSS$=GLOBAL.CANSSS$;

   4002  1 000447   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:30   
         1 000450   000000 756100                    STQ     0,,PR0

      193     4003    2           CALL ZIB$FIXREGS;

   4003  1 000451   000001 631400 2                  EPPR1   1
         1 000452   000000 701000 xent               TSX1    ZIB$FIXREGS
         1 000453   000000 011000                    NOP     0

      194     4004    2           WSOFST$=PINCRW(DBCB$,GLOBAL.PARAN.DBFSE.WSOFST);

   4004  1 000454   000000 470400 xsym               LDP0    GLOBAL$
         1 000455   000040 720100                    LXL0    32,,PR0
         1 000456   000000 636010                    EAQ     0,X0
         1 000457   200012 036100                    ADLQ    DBCB$,,AUTO
         1 000460   200033 756100                    STQ     WSOFST$,,AUTO

      195     4005    2           WSOFST$->WSPRIV=WSOFST$->WSPRIV&(~RADDR$->SSI.LOCKED);

   4005  1 000461   200032 471500                    LDP1    RADDR$,,AUTO
         1 000462   003100 060500                    CSL     bolr='003'O
         1 000463   100005 000022                    BDSC    5,,PR1                   by=0,bit=0,n=18
         1 000464   200054 000044                    BDSC    SCHEMAN+9,,AUTO          by=0,bit=0,n=36
         1 000465   200054 236100                    LDQ     SCHEMAN+9,,AUTO
         1 000466   777777 676003                    ERQ     -1,DU
         1 000467   200055 756100                    STQ     SCHEMAN+10,,AUTO
         1 000470   200033 473500                    LDP3    WSOFST$,,AUTO
         1 000471   003100 060500                    CSL     bolr='003'O
         1 000472   300000 000022                    BDSC    0,,PR3                   by=0,bit=0,n=18
         1 000473   200056 000044                    BDSC    SCHEMAN+11,,AUTO         by=0,bit=0,n=36
         1 000474   200056 236100                    LDQ     SCHEMAN+11,,AUTO
         1 000475   200055 376100                    ANQ     SCHEMAN+10,,AUTO
         1 000476   200057 756100                    STQ     SCHEMAN+12,,AUTO
         1 000477   003100 060500                    CSL     bolr='003'O
         1 000500   200057 000044                    BDSC    SCHEMAN+12,,AUTO         by=0,bit=0,n=36
         1 000501   300000 000022                    BDSC    0,,PR3                   by=0,bit=0,n=18

      196     4006    2           DBCB.PCB.PRSC=POFFW(ADDR(SN$SI),ADDR(SSORG));
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:31   

   4006  1 000502   000002 236000 2                  LDQ     2
         1 000503   000022 772000                    QRL     18
         1 000504   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000505   000007 236000 2                  LDQ     7
         1 000506   000022 772000                    QRL     18
         1 000507   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000510   000000 620006                    EAX0    0,QL
         1 000511   200012 474500                    LDP4    DBCB$,,AUTO
         1 000512   400520 740100                    STX0    336,,PR4

      197     4007                %DBCAL(NAME=ZIG$DBPFO,ALT=ER_FSN);

   4011  1 000513   000001 631400 2                  EPPR1   1
         1 000514   000000 701000 xent               TSX1    ZIG$DBPFO
         1 000515   001051 702000 1                  TSX2    ER_FSF

   4012  1 000516   000000 470400 xsym               LDP0    GLOBAL$
         1 000517   000006 235100                    LDA     6,,PR0
         1 000520   001051 601000 1                  TNZ     ER_FSF

      198     4023    2           TEMP=DBCB.PCB.RVI;

   4023  1 000521   200012 471500                    LDP1    DBCB$,,AUTO
         1 000522   100510 220100                    LDX0    328,,PR1
         1 000523   200023 740100                    STX0    TEMP,,AUTO

      199     4024    2           DBCB.PCB.RVI=DBCB.PCB.RVO;

   4024  1 000524   100511 221100                    LDX1    329,,PR1
         1 000525   100510 741100                    STX1    328,,PR1

      200     4025    2           DBCB.PCB.RVO=TEMP;

   4025  1 000526   100511 740100                    STX0    329,,PR1

      201     4026    2           LTFLAG=1;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:32   

   4026  1 000527   000001 235007                    LDA     1,DL
         1 000530   200040 755100                    STA     LTFLAG,,AUTO

      202     4027    3           DO WHILE (LTFLAG=1);

   4027  1 000531   000001 115007                    CMPA    1,DL
         1 000532   001015 601000 1                  TNZ     SIEND

      203     4028    3               DBCB.PCB.PRSC=POFFW(ADDR(SN$LT),ADDR(SSORG));

   4028  1 000533   000002 236000 2                  LDQ     2
         1 000534   000022 772000                    QRL     18
         1 000535   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000536   000010 236000 2                  LDQ     8
         1 000537   000022 772000                    QRL     18
         1 000540   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000541   000000 620006                    EAX0    0,QL
         1 000542   200012 470500                    LDP0    DBCB$,,AUTO
         1 000543   000520 740100                    STX0    336,,PR0

      204     4029                    %DBCAL(NAME=ZIG$DBPFN,EXC=SIEND,ALT=ER_FLT);

   4033  1 000544   000001 631400 2                  EPPR1   1
         1 000545   000000 701000 xent               TSX1    ZIG$DBPFN
         1 000546   001051 702000 1                  TSX2    ER_FSF

   4034  1 000547   000000 470400 xsym               LDP0    GLOBAL$
         1 000550   000006 235100                    LDA     6,,PR0
         1 000551   000554 600000 1                  TZE     s:4045

   4039  1 000552   000006 450100                    STZ     6,,PR0

   4040  1 000553   001015 710000 1                  TRA     SIEND

      205     4045    3               TEMP=DBCB.PCB.RVI;

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:33   
   4045  1 000554   200012 471500                    LDP1    DBCB$,,AUTO
         1 000555   100510 220100                    LDX0    328,,PR1
         1 000556   200023 740100                    STX0    TEMP,,AUTO

      206     4046    3               DBCB.PCB.RVI=DBCB.PCB.RVO;

   4046  1 000557   100511 221100                    LDX1    329,,PR1
         1 000560   100510 741100                    STX1    328,,PR1

      207     4047    3               DBCB.PCB.RVO=TEMP;

   4047  1 000561   100511 740100                    STX0    329,,PR1

      208     4048    3               RADDR$=PINCRW(DBCB$,DBCB.PCB.RVI)->RECVAR.RADDR$;

   4048  1 000562   100002 236111                    LDQ     2,X1,PR1
         1 000563   200032 756100                    STQ     RADDR$,,AUTO

      209     4049    3               LOCKS=RADDR$->SLT.PLOCKS;

   4049  1 000564   200032 473500                    LDP3    RADDR$,,AUTO
         1 000565   003100 060500                    CSL     bolr='003'O
         1 000566   300004 600011                    BDSC    4,,PR3                   by=3,bit=0,n=9
         1 000567   200030 000011                    BDSC    LOCKS,,AUTO              by=0,bit=0,n=9

      210     4050    3               DBCB.PCB.PRSC=POFFW(ADDR(LK$LT),ADDR(SSORG));

   4050  1 000570   000002 236000 2                  LDQ     2
         1 000571   000022 772000                    QRL     18
         1 000572   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000573   000011 236000 2                  LDQ     9
         1 000574   000022 772000                    QRL     18
         1 000575   200054 136100                    SBLQ    SCHEMAN+9,,AUTO
         1 000576   000000 622006                    EAX2    0,QL
         1 000577   100520 742100                    STX2    336,,PR1

      211     4051                    %DBCAL(NAME=ZIG$DBPFO,ALT=ER_FLK);
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:34   

   4055  1 000600   000001 631400 2                  EPPR1   1
         1 000601   000000 701000 xent               TSX1    ZIG$DBPFO
         1 000602   001051 702000 1                  TSX2    ER_FSF

   4056  1 000603   000000 470400 xsym               LDP0    GLOBAL$
         1 000604   000006 235100                    LDA     6,,PR0
         1 000605   001051 601000 1                  TNZ     ER_FSF

      212     4067    4               DO WHILE (LOCKS);

   4067  1 000606   200030 236100                    LDQ     LOCKS,,AUTO
         1 000607   777000 316003                    CANQ    -512,DU
         1 000610   001012 600000 1                  TZE     LTEND

      213     4068    4                   FOUND=0;

   4068  1 000611   200027 450100                    STZ     FOUND,,AUTO

      214     4069    4                   I=UPT.W1.COUNT;

   4069  1 000612   000000 470400 xsym               LDP0    UPT$
         1 000613   000000 236100                    LDQ     0,,PR0
         1 000614   000022 772000                    QRL     18
         1 000615   377777 376007                    ANQ     131071,DL
         1 000616   200025 756100                    STQ     I,,AUTO

      215     4070    5                   DO WHILE (I>0 AND FOUND~=1);

   4070  1 000617   000670 710000 1                  TRA     s:4084

      216     4071    5                       I=I-1;

   4071  1 000620   200025 235100                    LDA     I,,AUTO
         1 000621   000001 135007                    SBLA    1,DL
         1 000622   200025 755100                    STA     I,,AUTO

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:35   
      217     4072    5                       IF UPT.UPTE.UCW.PT(I)=TYPE THEN

   4072  1 000623   000001 735000                    ALS     1
         1 000624   000000 470400 xsym               LDP0    UPT$
         1 000625   000001 236105                    LDQ     1,AL,PR0
         1 000626   000033 772000                    QRL     27
         1 000627   200031 116100                    CMPQ    TYPE,,AUTO
         1 000630   000647 601000 1                  TNZ     s:4078

      218     4073    5                           IF UPT.UPTE.UCW.A(I)=BINDCD THEN

   4073  1 000631   000001 236105                    LDQ     1,AL,PR0
         1 000632   777777 376007                    ANQ     -1,DL
         1 000633   200034 116100                    CMPQ    BINDCD,,AUTO
         1 000634   000647 601000 1                  TNZ     s:4078

      219     4074    5                               IF LOCKS&UPT.UPTE.UCW.PB(I) THEN

   4074  1 000635   000001 236105                    LDQ     1,AL,PR0
         1 000636   000011 736000                    QLS     9
         1 000637   777000 376003                    ANQ     -512,DU
         1 000640   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000641   200030 236100                    LDQ     LOCKS,,AUTO
         1 000642   777000 376003                    ANQ     -512,DU
         1 000643   200054 376100                    ANQ     SCHEMAN+9,,AUTO
         1 000644   000647 600000 1                  TZE     s:4078

      220     4075    5                                   FOUND=1;

   4075  1 000645   000001 236007                    LDQ     1,DL
         1 000646   200027 756100                    STQ     FOUND,,AUTO

      221     4076    5                               ELSE;
      222     4077    5                           ELSE;
      223     4078    5                       IF TYPE~=3 AND UPT.UPTE.UCW.A(I)=0 THEN

   4078  1 000647   200031 236100                    LDQ     TYPE,,AUTO
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:36   
         1 000650   000003 116007                    CMPQ    3,DL
         1 000651   000670 600000 1                  TZE     s:4084
         1 000652   000001 720105                    LXL0    1,AL,PR0
         1 000653   000670 601000 1                  TNZ     s:4084

      224     4079    5                           IF LOCKS&UPT.UPTE.UCW.PB(I) THEN

   4079  1 000654   000001 236105                    LDQ     1,AL,PR0
         1 000655   000011 736000                    QLS     9
         1 000656   777000 376003                    ANQ     -512,DU
         1 000657   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000660   200030 236100                    LDQ     LOCKS,,AUTO
         1 000661   777000 376003                    ANQ     -512,DU
         1 000662   200054 376100                    ANQ     SCHEMAN+9,,AUTO
         1 000663   000670 600000 1                  TZE     s:4084

      225     4080    6                           DO;

      226     4081    6                               FOUND=2;

   4081  1 000664   000002 236007                    LDQ     2,DL
         1 000665   200027 756100                    STQ     FOUND,,AUTO

      227     4082    6                               J=I;

   4082  1 000666   200025 235100                    LDA     I,,AUTO
         1 000667   200026 755100                    STA     J,,AUTO

      228     4083    6                               END;

      229     4084    5                       END;

   4084  1 000670   200025 235100                    LDA     I,,AUTO
         1 000671   000675 600000 1                  TZE     s:4085
         1 000672   200027 236100                    LDQ     FOUND,,AUTO
         1 000673   000001 116007                    CMPQ    1,DL
         1 000674   000620 601000 1                  TNZ     s:4071
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:37   

      230     4085    4                   IF FOUND=0 THEN

   4085  1 000675   200027 236100                    LDQ     FOUND,,AUTO
         1 000676   001012 600000 1                  TZE     LTEND

      231     4086    4                       GOTO LTEND;
      232     4087    4                   IF FOUND=2 THEN

   4087  1 000677   000002 116007                    CMPQ    2,DL
         1 000700   000703 601000 1                  TNZ     s:4089

      233     4088    4                       I=J;

   4088  1 000701   200026 235100                    LDA     J,,AUTO
         1 000702   200025 755100                    STA     I,,AUTO

      234     4089    4                   UPLOCKS=LOCKS&UPT.UPTE.UCW.PB(I);

   4089  1 000703   000001 735000                    ALS     1
         1 000704   000001 236105                    LDQ     1,AL,PR0
         1 000705   000011 736000                    QLS     9
         1 000706   777000 376003                    ANQ     -512,DU
         1 000707   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000710   200030 236100                    LDQ     LOCKS,,AUTO
         1 000711   777000 376003                    ANQ     -512,DU
         1 000712   200054 376100                    ANQ     SCHEMAN+9,,AUTO
         1 000713   200041 756100                    STQ     UPLOCKS,,AUTO

      235     4090    4                   LOCKS=LOCKS&(~UPLOCKS);

   4090  1 000714   200041 236100                    LDQ     UPLOCKS,,AUTO
         1 000715   777000 376003                    ANQ     -512,DU
         1 000716   777000 676003                    ERQ     -512,DU
         1 000717   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000720   200030 236100                    LDQ     LOCKS,,AUTO
         1 000721   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:38   
         1 000722   200054 376100                    ANQ     SCHEMAN+9,,AUTO
         1 000723   200030 756100                    STQ     LOCKS,,AUTO

      236     4091        /*          If executed in user mode the following changes need to */
      237     4092        /*          made.  Skip from here to the statement RADDR$= . .     */
      238     4093        /*          Also the IF should be forced to be true.               */
      239     4094        /*          This is caused by the fact that going out to the user  */
      240     4095        /*          when not a real ASL mucks up the AUTO stack during     */
      241     4096        /*          this call.                                             */
      242     4097    5                   IF ~ZI_USER THEN DO;

   4097  1 000724   000000 236000 xsym               LDQ     ZI_USER
         1 000725   400000 376003                    ANQ     -131072,DU
         1 000726   400000 676003                    ERQ     -131072,DU
         1 000727   000746 600000 1                  TZE     s:4105

      243     4098    5                       IA.UPFLAG.UPADR=UPT.UPTE.W2.UPADR(I);

   4098  1 000730   000002 220105                    LDX0    2,AL,PR0
         1 000731   000000 471400 xsym               LDP1    IA$
         1 000732   100007 740100                    STX0    7,,PR1

      244     4099    5                       IA.UPFLAG.FLAGS.ETC='1'B; /* Return through etc */

   4099  1 000733   000001 236007                    LDQ     1,DL
         1 000734   100007 256100                    ORSQ    7,,PR1

      245     4100    5                       CALL ZIR$ESCAPE;

   4100  1 000735   000001 631400 2                  EPPR1   1
         1 000736   000000 701000 xent               TSX1    ZIR$ESCAPE
         1 000737   000000 011000                    NOP     0

      246     4101        /*          Reset to Canned SSS when returning from privacy */
      247     4102    5                       GLOBAL.ACTIVE.SSS$=GLOBAL.CANSSS$;

   4102  1 000740   000000 470400 xsym               LDP0    GLOBAL$
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:39   
         1 000741   000003 236100                    LDQ     3,,PR0
         1 000742   000000 756100                    STQ     0,,PR0

      248     4103    5                       CALL ZIB$FIXREGS;

   4103  1 000743   000001 631400 2                  EPPR1   1
         1 000744   000000 701000 xent               TSX1    ZIB$FIXREGS
         1 000745   000000 011000                    NOP     0

      249     4104    5                       END;

      250     4105    4                   RADDR$=PINCRW(DBCB$,DBCB.PCB.RVO)->RECVAR.RADDR$;

   4105  1 000746   200012 470500                    LDP0    DBCB$,,AUTO
         1 000747   000511 220100                    LDX0    329,,PR0
         1 000750   000002 236110                    LDQ     2,X0,PR0
         1 000751   200032 756100                    STQ     RADDR$,,AUTO

      251     4106    4                   CALL ZIM$LKMAP(UWA.DBPKY,LKVALUE);

   4106  1 000752   200020 631500                    EPPR1   LKVALUE,,AUTO
         1 000753   200055 451500                    STP1    SCHEMAN+10,,AUTO
         1 000754   000000 236000 xsym               LDQ     UWA$
         1 000755   000033 036003                    ADLQ    27,DU
         1 000756   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000757   200054 630500                    EPPR0   SCHEMAN+9,,AUTO
         1 000760   000012 631400 2                  EPPR1   10
         1 000761   000000 701000 xent               TSX1    ZIM$LKMAP
         1 000762   000000 011000                    NOP     0

      252     4107    4                   IF RADDR$->SLK.PLVALUE=LKVALUE OR ZI_USER THEN

   4107  1 000763   200032 470500                    LDP0    RADDR$,,AUTO
         1 000764   040100 106500                    CMPC    fill='040'O
         1 000765   000014 000014                    ADSC9   12,,PR0                  cn=0,n=12
         1 000766   200020 000014                    ADSC9   LKVALUE,,AUTO            cn=0,n=12
         1 000767   000772 600000 1                  TZE     s:4108
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:40   
         1 000770   000000 234000 xsym               SZN     ZI_USER
         1 000771   001007 605000 1                  TPL     LOCKEND

      253     4108    4                       WSOFST$->WSPRIV.L=WSOFST$->WSPRIV.L|UPLOCKS;

   4108  1 000772   200041 236100                    LDQ     UPLOCKS,,AUTO
         1 000773   777000 376003                    ANQ     -512,DU
         1 000774   200054 756100                    STQ     SCHEMAN+9,,AUTO
         1 000775   200033 471500                    LDP1    WSOFST$,,AUTO
         1 000776   003100 060500                    CSL     bolr='003'O
         1 000777   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
         1 001000   200055 000044                    BDSC    SCHEMAN+10,,AUTO         by=0,bit=0,n=36
         1 001001   200055 236100                    LDQ     SCHEMAN+10,,AUTO
         1 001002   200054 276100                    ORQ     SCHEMAN+9,,AUTO
         1 001003   200056 756100                    STQ     SCHEMAN+11,,AUTO
         1 001004   003100 060500                    CSL     bolr='003'O
         1 001005   200056 000044                    BDSC    SCHEMAN+11,,AUTO         by=0,bit=0,n=36
         1 001006   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9

      254     4109    4   LOCKEND:        END;

   4109  1 001007   200030 236100       LOCKEND      LDQ     LOCKS,,AUTO
         1 001010   777000 316003                    CANQ    -512,DU
         1 001011   000611 601000 1                  TNZ     s:4068

      255     4110    3   LTEND:      END;

   4110  1 001012   200040 235100       LTEND        LDA     LTFLAG,,AUTO
         1 001013   000001 115007                    CMPA    1,DL
         1 001014   000533 600000 1                  TZE     s:4028

      256     4111    2   SIEND:  END;

   4111  1 001015   200037 235100       SIEND        LDA     SIFLAG,,AUTO
         1 001016   000323 601000 1                  TNZ     s:3923

      257     4112            %DBCAL(NAME=ZIM$DBIOQ,ALT=ZAP);
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:41   

   4116  1 001017   000001 631400 2                  EPPR1   1
         1 001020   000000 701000 xent               TSX1    ZIM$DBIOQ
         1 001021   001057 702000 1                  TSX2    ZAP

   4117  1 001022   000000 470400 xsym               LDP0    GLOBAL$
         1 001023   000006 235100                    LDA     6,,PR0
         1 001024   001057 601000 1                  TNZ     ZAP

      258     4128    1       GLOBAL.ACTIVE.SSS$=GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO);

   4128  1 001025   000002 235100                    LDA     2,,PR0
         1 001026   000153 236105                    LDQ     107,AL,PR0
         1 001027   000000 756100                    STQ     0,,PR0

      259     4129    1       CALL ZIB$FIXREGS;

   4129  1 001030   000001 631400 2                  EPPR1   1
         1 001031   000000 701000 xent               TSX1    ZIB$FIXREGS
         1 001032   000000 011000                    NOP     0

      260     4130    1   PCKD: GLOBAL.DB.FLAGS.PCKD(GLOBAL.ACTIVE.DBNO)='1'B;

   4130  1 001033   000000 470400 xsym  PCKD         LDP0    GLOBAL$
         1 001034   000002 235100                    LDA     2,,PR0
         1 001035   100000 236003                    LDQ     32768,DU
         1 001036   000167 256105                    ORSQ    119,AL,PR0

      261     4131    1       RETURN;

   4131  1 001037   000000 702200 xent               TSX2  ! X66_ARET

      262     4132    1   ER_EAS: ERROR=ERR#CM#SSNF;

   4132  1 001040   210573 235007       ER_EAS       LDA     70011,DL
         1 001041   200017 755100                    STA     ERROR,,AUTO

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:42   
      263     4133    1       GOTO CLOSE;

   4133  1 001042   001051 710000 1                  TRA     ER_FSF

      264     4134    1   ER_DTE: ERROR=ERR#CM#INSST;

   4134  1 001043   210575 235007       ER_DTE       LDA     70013,DL
         1 001044   200017 755100                    STA     ERROR,,AUTO

      265     4135    1       GOTO CLOSE;

   4135  1 001045   001051 710000 1                  TRA     ER_FSF

      266     4136    1   ER_NAME: ERROR=ERR#CM#INNM;

   4136  1 001046   210566 235007       ER_NAME      LDA     70006,DL
         1 001047   200017 755100                    STA     ERROR,,AUTO

      267     4137    1       GOTO CLOSE;

   4137  1 001050   001051 710000 1                  TRA     ER_FSF

   4134  1 001051                       ER_FSF       null
   4134  1 001051                       ER_FAS       null
   4134  1 001051                       ER_FSI       null
   4134  1 001051                       ER_FSE       null
   4134  1 001051                       ER_FSN       null
   4134  1 001051                       ER_FLT       null
   4134  1 001051                       ER_FLK       null
   4134  1 001051                       ER_IOQ       null
   4134  1 001051                       CLOSE        null
      268     4138    1   ER_FSF: ;
      269     4139    1   ER_FAS: ;
      270     4140    1   ER_FSI: ;
      271     4141    1   ER_FSE: ;
      272     4142    1   ER_FSN: ;
      273     4143    1   ER_FLT: ;
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:43   
      274     4144    1   ER_FLK: ;
      275     4145    1   ER_IOQ: ;
      276     4146    1   CLOSE: ;
      277     4147            %DBCAL(NAME=ZIM$DBIOQ,ALT=ZAP);

   4151  1 001051   000001 631400 2                  EPPR1   1
         1 001052   000000 701000 xent               TSX1    ZIM$DBIOQ
         1 001053   001057 702000 1                  TSX2    ZAP

   4152  1 001054   000000 470400 xsym               LDP0    GLOBAL$
         1 001055   000006 235100                    LDA     6,,PR0
         1 001056   001057 601000 1                  TNZ     ZAP

      278     4163    1   ZAP: GLOBAL.ACTIVE.SSS$=GLOBAL.DB.SSS$(GLOBAL.ACTIVE.DBNO);

   4163  1 001057   000000 470400 xsym  ZAP          LDP0    GLOBAL$
         1 001060   000002 235100                    LDA     2,,PR0
         1 001061   000153 236105                    LDQ     107,AL,PR0
         1 001062   000000 756100                    STQ     0,,PR0

      279     4164    1       CALL ZIB$FIXREGS;

   4164  1 001063   000001 631400 2                  EPPR1   1
         1 001064   000000 701000 xent               TSX1    ZIB$FIXREGS
         1 001065   000000 011000                    NOP     0

      280     4165            %DBALT;

   4166  1 001066   000000 470400 xsym               LDP0    GLOBAL$
         1 001067   000006 235100                    LDA     6,,PR0
         1 001070   001077 601000 1                  TNZ     s:4174

   4168  1 001071   000010 450100                    STZ     8,,PR0

   4169  1 001072   000012 450100                    STZ     10,,PR0

   4170  1 001073   000013 450100                    STZ     11,,PR0
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:44   

   4171  1 001074   000011 450100                    STZ     9,,PR0

   4172  1 001075   200017 236100                    LDQ     ERROR,,AUTO
         1 001076   000006 756100                    STQ     6,,PR0

   4174  1 001077   000006 235100                    LDA     6,,PR0
         1 001100   303240 115007                    CMPA    100000,DL
         1 001101   001103 603000 1                  TRC     s:4177

   4175  1 001102   000000 702200 xent               TSX2  ! X66_AALT

   4177  1 001103   000001 631400 2                  EPPR1   1
         1 001104   000000 701000 xent               TSX1    ZIB$ERR
         1 001105   000000 011000                    NOP     0

      281     4179    1   END ZIM$PRIVACY;

   4179  1 001106   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   123103 110105   115101 064060                                    SCHEMA40

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000000 000000   000000 006000   000000 006000    ................
   2     004   000000 006000   000000 006000   000000 006000   000000 006000    ................
   2     010   000000 006000   000000 006000   000002 000000                    ............

PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:45   
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$USER.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$SCHEMA.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIM$PRIVACY.

   Procedure ZIM$PRIVACY requires 583 words for executable code.
   Procedure ZIM$PRIVACY requires 48 words of local(AUTO) storage.

    No errors detected in file ZIM$PRIVACY.:ZIC0TSI    .
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:46   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:47   
          MINI XREF LISTING

AC.ANAM
      1834**DCL      3853<<ASSIGN
AC.DEF.ANL
      1763**DCL      1834--IMP-SIZ  3852<<ASSIGN   3853>>ASSIGN
AC.DEF.FORG
      1750**DCL      1754--REDEF
AC.DEF.TYPE
      1749**DCL      3999>>IF
AC.SANAM.EIS.COUNT
      1779**DCL      3855<<ASSIGN
AC$
      1746**DCL      1747--IMP-PTR  3851<<ASSIGN   3852>>ASSIGN   3853>>ASSIGN   3853>>ASSIGN   3855>>ASSIGN
AMAX
      3799**DCL      3845<<ASSIGN   3850>>ASSIGN
AS$SI
      3788**DCL      3923--ASSIGN
ASFLAG
      3808**DCL      3892<<ASSIGN   3893>>DOWHILE  3915<<ASSIGN
AWS$
      3325**DCL      3326--IMP-PTR
BINDCD
      3807**DCL      3977<<ASSIGN   3981>>ASSIGN   4073>>IF
CLOSE
      4134**LABEL    4133--GOTO     4135--GOTO     4137--GOTO
DBCB.IOWS.ACOPN
      3241**DCL      3856<<ASSIGN
DBCB.IOWS.CFCT
      3276**DCL      3277--REDEF
DBCB.IOWS.DBKF.RQ
      3219**DCL      3220--REDEF
DBCB.IOWS.DBKR
      3216**DCL      3217--REDEF
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:48   
DBCB.IOWS.NOBF
      3278**DCL      3279--REDEF
DBCB.IOWS.SPND
      3204**DCL      3205--REDEF
DBCB.PCB.PRRC
      3063**DCL      3891<<ASSIGN
DBCB.PCB.PRSC
      3065**DCL      3890<<ASSIGN   3923<<ASSIGN   4006<<ASSIGN   4028<<ASSIGN   4050<<ASSIGN
DBCB.PCB.RVI
      3052**DCL      3873>>ASSIGN   3910>>ASSIGN   3911<<ASSIGN   3913>>ASSIGN   3920>>ASSIGN   3926>>ASSIGN
      3961>>ASSIGN   3962<<ASSIGN   3964>>ASSIGN   3974>>ASSIGN   4023>>ASSIGN   4024<<ASSIGN   4045>>ASSIGN
      4046<<ASSIGN   4048>>ASSIGN
DBCB.PCB.RVO
      3054**DCL      3911>>ASSIGN   3912<<ASSIGN   3962>>ASSIGN   3963<<ASSIGN   4024>>ASSIGN   4025<<ASSIGN
      4046>>ASSIGN   4047<<ASSIGN   4105>>ASSIGN
DBCB.SWS.RDYCW
      2942**DCL      2943--REDEF
DBCB.SWS.TEMP.PTR1$
      2976**DCL      2977--REDEF    2978--REDEF
DBCB.SWS.TEMP.PTR2$
      2979**DCL      2980--REDEF
DBCB$
      2847**DCL      2848--IMP-PTR  3815<<ASSIGN   3827>>ASSIGN   3833>>ASSIGN   3838>>ASSIGN   3856>>ASSIGN
      3873>>ASSIGN   3873>>ASSIGN   3890>>ASSIGN   3891>>ASSIGN   3910>>ASSIGN   3911>>ASSIGN   3911>>ASSIGN
      3912>>ASSIGN   3913>>ASSIGN   3913>>ASSIGN   3920>>ASSIGN   3920>>ASSIGN   3923>>ASSIGN   3926>>ASSIGN
      3926>>ASSIGN   3961>>ASSIGN   3962>>ASSIGN   3962>>ASSIGN   3963>>ASSIGN   3964>>ASSIGN   3964>>ASSIGN
      3974>>ASSIGN   3974>>ASSIGN   4004>>ASSIGN   4006>>ASSIGN   4023>>ASSIGN   4024>>ASSIGN   4024>>ASSIGN
      4025>>ASSIGN   4028>>ASSIGN   4045>>ASSIGN   4046>>ASSIGN   4046>>ASSIGN   4047>>ASSIGN   4048>>ASSIGN
      4048>>ASSIGN   4050>>ASSIGN   4105>>ASSIGN   4105>>ASSIGN
DBKSI
      3809**DCL      3920<<ASSIGN   3926>>ASSIGN   3974<<ASSIGN
ERROR
      3796**DCL      4132<<ASSIGN   4134<<ASSIGN   4136<<ASSIGN   4172>>ASSIGN
ER_DTE
      4134**LABEL    3919--GOTO
ER_EAS
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:49   
      4132**LABEL    3905--GOTO
ER_FAS
      4134**LABEL    3898--CALLALT
ER_FLK
      4134**LABEL    4055--CALLALT  4058--GOTO
ER_FLT
      4134**LABEL    4033--CALLALT
ER_FSE
      4134**LABEL    3986--CALLALT  3989--GOTO
ER_FSF
      4134**LABEL    3878--CALLALT  3881--GOTO
ER_FSI
      4134**LABEL    3931--CALLALT  3934--GOTO     3949--CALLALT
ER_FSN
      4134**LABEL    4011--CALLALT  4014--GOTO
ER_NAME
      4136**LABEL    3822--GOTO
FOUND
      3802**DCL      4068<<ASSIGN   4070>>DOWHILE  4075<<ASSIGN   4081<<ASSIGN   4085>>IF       4087>>IF
FR.DEF.FSR
      1912**DCL      3837>>IF
FR.DEF.SYN
      1909**DCL      3837>>IF
FR.FNL
      1936**DCL      1940--IMP-SIZ
FR.FRWSO
      1939**DCL      3838>>ASSIGN
FR.RCFRN
      1937**DCL      3835>>DOWHILE  3836>>ASSIGN
FR.UOFST.EIS.OFFSET
      1926**DCL      1929--REDEF
FR$
      1900**DCL      1901--IMP-PTR  3834<<ASSIGN   3835>>DOWHILE  3836<<ASSIGN   3836>>ASSIGN   3837>>IF
      3837>>IF       3838>>ASSIGN
FWS.PRIV
      3406**DCL      3838<<ASSIGN
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:50   
FWS$
      3404**DCL      3405--IMP-PTR
GLOBAL.ACTIVE.DBCB$
       521**DCL       522--REDEF    3815>>ASSIGN
GLOBAL.ACTIVE.DBNO
       525**DCL      3816>>IF       3914>>IF       3917>>IF       3978>>ASSIGN   3999>>IF       4128>>ASSIGN
      4130>>ASSIGN   4163>>ASSIGN
GLOBAL.ACTIVE.SSS$
       517**DCL       518--REDEF    3818>>ASSIGN   3847<<ASSIGN   3978<<ASSIGN   4002<<ASSIGN   4102<<ASSIGN
      4128<<ASSIGN   4163<<ASSIGN
GLOBAL.CANSSS$
       526**DCL      3846>>ASSIGN   4002>>ASSIGN   4102>>ASSIGN
GLOBAL.DB.FLAGS.PCKD
       619**DCL      3816>>IF       4130<<ASSIGN
GLOBAL.DB.SSNAME
       613**DCL      3914>>IF
GLOBAL.DB.SSS$
       614**DCL      3917>>IF       3978>>ASSIGN   3999>>IF       4128>>ASSIGN   4163>>ASSIGN
GLOBAL.KEY
       725**DCL       728--REDEF
GLOBAL.PARAN.DBFSE.ID
       581**DCL      3981<<ASSIGN
GLOBAL.PARAN.DBFSE.SSOFST
       582**DCL      3999>>IF
GLOBAL.PARAN.DBFSE.TYPE
       580**DCL      3980<<ASSIGN
GLOBAL.PARAN.DBFSE.WSOFST
       583**DCL      4004>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       600**DCL       607--REDEF
GLOBAL.PRINTBUF.BUFFER
       759**DCL       760--REDEF     761--REDEF     762--REDEF
GLOBAL.PRINTBUF.ERR.V
       764**DCL       767--REDEF     768--REDEF     769--REDEF
GLOBAL.RET.AC#
       537**DCL      4168<<ASSIGN
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:51   
GLOBAL.RET.ERROR#
       535**DCL      3862>>IF       3879>>IF       3899>>IF       3904<<ASSIGN   3932>>IF       3950>>IF
      3955<<ASSIGN   3987>>IF       4012>>IF       4034>>IF       4039<<ASSIGN   4056>>IF       4117>>IF
      4152>>IF       4166>>IF       4172<<ASSIGN   4174>>IF
GLOBAL.RET.FR#
       538**DCL      4171<<ASSIGN
GLOBAL.RET.RC#
       540**DCL      4170<<ASSIGN
GLOBAL.RET.SC#
       539**DCL      4169<<ASSIGN
GLOBAL$
       819**DCL       515--IMP-PTR  3815>>ASSIGN   3816>>IF       3816>>IF       3818>>ASSIGN   3846>>ASSIGN
      3847>>ASSIGN   3862>>IF       3879>>IF       3899>>IF       3904>>ASSIGN   3914>>IF       3914>>IF
      3917>>IF       3917>>IF       3932>>IF       3950>>IF       3955>>ASSIGN   3978>>ASSIGN   3978>>ASSIGN
      3978>>ASSIGN   3980>>ASSIGN   3981>>ASSIGN   3987>>IF       3999>>IF       3999>>IF       3999>>IF
      4002>>ASSIGN   4002>>ASSIGN   4004>>ASSIGN   4012>>IF       4034>>IF       4039>>ASSIGN   4056>>IF
      4102>>ASSIGN   4102>>ASSIGN   4117>>IF       4128>>ASSIGN   4128>>ASSIGN   4128>>ASSIGN   4130>>ASSIGN
      4130>>ASSIGN   4152>>IF       4163>>ASSIGN   4163>>ASSIGN   4163>>ASSIGN   4166>>IF       4168>>ASSIGN
      4169>>ASSIGN   4170>>ASSIGN   4171>>ASSIGN   4172>>ASSIGN   4174>>IF
I
      3800**DCL      4069<<ASSIGN   4070>>DOWHILE  4071<<ASSIGN   4071>>ASSIGN   4072>>IF       4073>>IF
      4074>>IF       4078>>IF       4079>>IF       4082>>ASSIGN   4088<<ASSIGN   4089>>ASSIGN   4098>>ASSIGN
IA.SNAME
      2113**DCL      2114--REDEF
IA.SSDT
      2125**DCL      2126--REDEF
IA.SSNAME
      2116**DCL      2117--REDEF
IA.UPFLAG.FLAGS.ETC
      2110**DCL      4099<<ASSIGN
IA.UPFLAG.UPADR
      2103**DCL      4098<<ASSIGN
IA$
      2127**DCL      2092--IMP-PTR  4098>>ASSIGN   4099>>ASSIGN
J
      3801**DCL      4082<<ASSIGN   4088>>ASSIGN
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:52   
LK$LT
      3791**DCL      4050--ASSIGN
LKVALUE
      3797**DCL      4106<>CALL     4107>>IF
LOCKS
      3803**DCL      4049<<ASSIGN   4067>>DOWHILE  4074>>IF       4079>>IF       4089>>ASSIGN   4090<<ASSIGN
      4090>>ASSIGN
LTEND
      4110**LABEL    4086--GOTO
LTFLAG
      3811**DCL      4026<<ASSIGN   4027>>DOWHILE
NOSI
      3968**LABEL    3956--GOTO
OA.AMAX
      1724**DCL      3845>>ASSIGN   3850<<ASSIGN
OA.SCNAM.EIS.COUNT
      1703**DCL      1738--IMP-SIZ  3820>>ASSIGN   3823>>ASSIGN
OA.SNAM
      1738**DCL      3823>>ASSIGN
OA.SSVDT
      1714**DCL      3917>>IF
OA$
      1681**DCL      1682--IMP-PTR  3819<<ASSIGN   3820>>ASSIGN   3823>>ASSIGN   3823>>ASSIGN   3849<<ASSIGN
      3850>>ASSIGN
OA1
      1673**DCL      3819--ASSIGN   3824--ASSIGN   3829--ASSIGN   3845--ASSIGN   3917--IF
OA1$
      1672**DCL      1673--IMP-PTR
PCKD
      4130**LABEL    3844--GOTO
RADDR$
      3805**DCL      3913<<ASSIGN   3914>>IF       3917>>IF       3964<<ASSIGN   3966>>IF       3971>>IF
      3976>>ASSIGN   3977>>ASSIGN   4005>>ASSIGN   4048<<ASSIGN   4049>>ASSIGN   4105<<ASSIGN   4107>>IF
RC.DEF.RNL
      1884**DCL      1894--IMP-SIZ
RC.DEF.SR
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:53   
      1876**DCL      3832>>IF
RC.OARCN
      1887**DCL      3830>>DOWHILE  3831>>ASSIGN
RC.RCWSO
      1892**DCL      3833>>ASSIGN
RC$
      1868**DCL      1869--IMP-PTR  3829<<ASSIGN   3830>>DOWHILE  3831<<ASSIGN   3831>>ASSIGN   3832>>IF
      3833>>ASSIGN   3834>>ASSIGN
RECVAR.BADDR
      3418**DCL      3421--REDEF
RECVAR.DBKEY
      3417**DCL      3873<<ASSIGN   3920>>ASSIGN   3926<<ASSIGN   3974>>ASSIGN
RECVAR.RADDR
      3422**DCL      3426--REDEF
RECVAR.RADDR$
      3426**DCL      3913>>ASSIGN   3964>>ASSIGN   4048>>ASSIGN   4105>>ASSIGN
RWS.KEY.LENGTH
      3399**DCL      3400--IMP-SIZ
RWS.PRIV
      3386**DCL      3833<<ASSIGN
RWS$
      3384**DCL      3385--IMP-PTR
SAS.SS_NAME
      1114**DCL      3914>>IF
SAS.SS_TRAN_DBCS
      1116**DCL      3917>>IF
SC.DEF.SNL
      1854**DCL      1859--IMP-SIZ
SC.OASCN
      1856**DCL      3825>>DOWHILE  3826>>ASSIGN
SC.SCWSO
      1855**DCL      3827>>ASSIGN
SC$
      1841**DCL      1842--IMP-PTR  3824<<ASSIGN   3825>>DOWHILE  3826<<ASSIGN   3826>>ASSIGN   3827>>ASSIGN
SCHEMAN
      3814**DCL      3823<<ASSIGN   3843>>IF       3853>>ASSIGN
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:54   
SCHEMAS
      3813**DCL      3820<<ASSIGN   3821>>IF       3852>>ASSIGN   3855>>ASSIGN
SETWS.KEY.LENGTH
      3379**DCL      3380--IMP-SIZ
SETWS.PRIV
      3367**DCL      3827<<ASSIGN
SETWS$
      3365**DCL      3366--IMP-PTR
SF$AS
      3787**DCL      3890--ASSIGN
SFAC1
      3786**DCL      3851--ASSIGN   3856--ASSIGN
SFOA
      3785**DCL      3849--ASSIGN
SIEND
      4111**LABEL    3969--GOTO     3972--GOTO     4001--GOTO     4040--GOTO
SIFLAG
      3810**DCL      3921<<ASSIGN   3922>>DOWHILE  3924>>IF       3943<<ASSIGN   3968<<ASSIGN   3973<<ASSIGN
SLK.PLVALUE
      1063**DCL      4107>>IF
SLT.PLOCKS
      1042**DCL      4049>>ASSIGN
SN$LT
      3790**DCL      4028--ASSIGN
SN$SI
      3789**DCL      4006--ASSIGN
SSI.BINDCD.CODE
      1086**DCL      3977>>ASSIGN
SSI.BINDCD.TYPE
      1085**DCL      3976>>ASSIGN
SSI.EXCLUDE
      1089**DCL      3966>>IF
SSI.LOCKED
      1081**DCL      3971>>IF       4005>>ASSIGN
SSORG
      3784**DCL      3849--ASSIGN   3851--ASSIGN   3856--ASSIGN   3890--ASSIGN   3923--ASSIGN   4006--ASSIGN
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:55   
      4028--ASSIGN   4050--ASSIGN
SSS$
      1128**DCL      3818<<ASSIGN   3819>>ASSIGN   3824>>ASSIGN   3826>>ASSIGN   3829>>ASSIGN   3831>>ASSIGN
      3836>>ASSIGN   3845>>ASSIGN   3846<<ASSIGN   3847>>ASSIGN   3849>>ASSIGN   3851>>ASSIGN
TEMP
      3798**DCL      3910<<ASSIGN   3912>>ASSIGN   3961<<ASSIGN   3963>>ASSIGN   4023<<ASSIGN   4025>>ASSIGN
      4045<<ASSIGN   4047>>ASSIGN
TYPE
      3804**DCL      3976<<ASSIGN   3980>>ASSIGN   4072>>IF       4078>>IF
UPLOCKS
      3812**DCL      4089<<ASSIGN   4090>>ASSIGN   4108>>ASSIGN
UPT.UPTE.UCW
      2172**DCL      2187--REDEF
UPT.UPTE.UCW.A
      2186**DCL      4073>>IF       4078>>IF
UPT.UPTE.UCW.PB
      2174**DCL      4074>>IF       4079>>IF       4089>>ASSIGN
UPT.UPTE.UCW.PB.PG
      2175**DCL      2176--REDEF
UPT.UPTE.UCW.PB.PM
      2177**DCL      2178--REDEF
UPT.UPTE.UCW.PT
      2173**DCL      4072>>IF
UPT.UPTE.W2.UPADR
      2191**DCL      4098>>ASSIGN
UPT.W1.COUNT
      2169**DCL      4069>>ASSIGN
UPT$
      2165**DCL      2166--IMP-PTR  4069>>ASSIGN   4072>>IF       4073>>IF       4074>>IF       4078>>IF
      4079>>IF       4089>>ASSIGN   4098>>ASSIGN
UWA.DBPKY
      2154**DCL      4106<>CALL
UWA.DBST
      2143**DCL      2144--REDEF
UWA$
      2162**DCL      2141--IMP-PTR  4106>>CALL
PL6.E3A0      #001=ZIM$PRIVACY File=ZIM$PRIVACY.:ZIC0TSI                         FRI 09/05/97 13:04 Page:56   
WSOFST$
      3806**DCL      4004<<ASSIGN   4005>>ASSIGN   4005>>ASSIGN   4108>>ASSIGN   4108>>ASSIGN
WSPRIV
      3793**DCL      4005<<ASSIGN   4005>>ASSIGN
WSPRIV.L
      3795**DCL      4108<<ASSIGN   4108>>ASSIGN
ZAP
      4163**LABEL    3861--CALLALT  3864--GOTO     4116--CALLALT  4119--GOTO     4151--CALLALT  4154--GOTO
ZIB$DBIOO
      3777**DCL-ENT  3861--CALL
ZIB$ERR
       820**DCL-ENT  4177--CALL
ZIB$FIXREGS
      3775**DCL-ENT  3848--CALL     3979--CALL     4003--CALL     4103--CALL     4129--CALL     4164--CALL
ZIG$DBPFD
      3779**DCL-ENT  3878--CALL     3931--CALL
ZIG$DBPFN
      3780**DCL-ENT  3898--CALL     3949--CALL     4033--CALL
ZIG$DBPFO
      3781**DCL-ENT  4011--CALL     4055--CALL
ZIM$DBIOQ
      3778**DCL-ENT  4116--CALL     4151--CALL
ZIM$LKMAP
      3783**DCL-ENT  4106--CALL
ZIP$DBFSE
      3782**DCL-ENT  3986--CALL
ZIR$ESCAPE
      3776**DCL-ENT  4100--CALL
ZI_USER
      3792**DCL      4097>>IF       4107>>IF
