

11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              1    
    1      *M*        Q2MA           Dont mess with this module
    2      *T***********************************************************
    3      *T*                                                         *
    4      *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
    5      *T*                                                         *
    6      *T***********************************************************
    7      *      Q2SYM AND MACRO DECK    JR061578
    8             LIST    OFF
    9             TTL     Q2SYM AND MACRO DECK
   10      ********************************************************************
   11      *                                                                  *
   12      *   R---E---G---I---S---T---E---R      E---Q---U---A---T---E---S   *
   13      *                                                                  *
   14      ********************************************************************
   15      *
   16      X0     EQU     0
   17      X1     EQU     1
   18      X2     EQU     2
   19      X3     EQU     3
   20      X4     EQU     4
   21      X5     EQU     5
   22      X6     EQU     6
   23      X7     EQU     7
   24      PR0    EQU     0
   25      PR1    EQU     1
   26      PR2    EQU     2
   27      PR3    EQU     3
   28      PR4    EQU     4
   29      PR5    EQU     5
   30      PR6    EQU     6
   31      PR7    EQU     7
   32      PS0SID   EQU   0     Seg ID Parameter 0
   33      PS1SID   EQU   1                      1
   34      PS2SID   EQU   2                      2
   35      PS3SID   EQU   3                      3
   36      PS4SID   EQU   4                      4
   37      PS5SID   EQU   5                      5
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              2    
   38      PS6SID   EQU   6                      6
   39      VLPSID   EQU   PS0SID     Parameter 0
   40      IASID    EQU   PS1SID               1
   41      UWASID   EQU   PS2SID               2
   42      RVASID   EQU   PS3SID               3
   43      UPTSID   EQU   PS4SID               4
   44      *
   45      *
   46      *
   47             CPR     1974
   48             EJECT
   49               ENTREF      X66_AUTO_0
   50               ENTREF      X66_ARET
   51             EJECT
   52      ***********************************************************
   53      *
   54      *  DBTG SYMBOL EQUIVALENCES
   55      *  DECLARE & DEFINE THE SYMBOLS FOR THE FOLLOWING:
   56      *
   57      *    DATA BASE CONTROL BLOCK (DBCB)
   58      *    CONTROL STRUCTURE (SCHEMA SUBSET)
   59      *    BIT NO. EQUIVALENCES
   60      *
   61      ***********************************************************
   62             EJECT
   63      Q2SYM  MACRO
   64               LIST     OFF
   65      ***********************************************************
   66      *  CONSTANTS
   67      ***********************************************************
   68             CRSM    OFF
   69      M9     SET     1               9 BIT MODE INDICATOR
   70      CPW    SET     6-2*M9          CHARS PER WORD
   71      A      SET     1               DO ARGUMENT CHECKING
   72      B      SET     1               DO I/O CHECKS
   73      C      SET     1               DO STRUCTURE CHECKING
   74      D      SET     1               DO MISC. CHECKS
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              3    
   75      E      SET     1               DO RECORD SIZE CHECKS
   76      TDS    SET     0               JR060978
   77      CP6PGSZW EQU      1024-3            Words per integrated page
   78      CP6PGSZB EQU      CP6PGSZW*4        Bytes          "
   79      .N6685 SET     1               REPEAT INDICATOR
   80      CHRTP  EQU     4000            CALC HDR REC TYPE
   81      OAOFST EQU     1               OFST OF OA REC FROM AR0
   82      *
   83      ************************************************************************
   84      *  GLOBAL REGION EQUIVALENCES
   85      ************************************************************************
   86      ACTSSS  EQU    0               Displ. to active SSS$ from GLOBAL base.
   87      ACTDBCB EQU    1               Displ. to active DBCB$ from GLOBAL base.
   88      ACTDBNO  EQU      2           Disp to GLOBAL.ACTIVE.DBNO
   89      CANSSS   EQU      3           Disp to GLOBAL.CANSSS$
   90      FCN      EQU      4           Disp to GLOBAL.FCN
   91      ETCADR   EQU      5           Disp to GLOBAL.ETC.ADR
   92      ETCDBNO  EQU      5           Disp to GLOBAL.ETC.DBNO
   93      GERROR   EQU      6           Disp TO GLOBAL.ERROR
   94      GSYSERR  EQU      7
   95      GRETAC   EQU      8           Disp TO GLOBAL.RETAC
   96      GRETFR   EQU      9           Disp TO GLOBAL.RETFR
   97      GRETSC   EQU      10          Disp TO GLOBAL.RETSC
   98      GRETRC   EQU      11          Disp TO GLOBAL.RETRC
   99      GDCB     EQU      12          Disp to GLOBAL.DCB#
  100      GSTCD    EQU      12          Disp TO GLOBAL.STCD
  101      GPAGE    EQU      13          Disp TO GLOBAL.PAGE
  102      GINHIB   EQU      14          Disp to GLOBAL.PARAM.BREAK
  103      .BREAK   BOOL     000001      MASK FOR BREAK CONTROL
  104      .DUMP    BOOL     000002      MASK FOR DUMP CONTROL
  105      PENDING  EQU      15          Disp to GLOBAL.PENDING
  106      .RELEASE BOOL     400000      MASK FOR RELEASE CONTROL
  107      .TRACE   BOOL     040000      Mask for GLOBAL.PENDING.TRACE
  108      .EXIT    BOOL     000400      Mask for GLOBAL.PENDING.EXIT
  109      GIOAWS   EQU      16          Disp TO GLOBAL.PARAM.IO.AWS$
  110      GIOPGNO  EQU      17          Disp TO GLOBAL.PARAM.IO.PGNO
  111      GIOBUF   EQU      18          Disp TO GLOBAL.PARAM.IO.BUF$
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              4    
  112      ICKSMP   EQU      19          Disp TO GLOBAL.PARAM.ICKSM.P$
  113      ICKSMV   EQU      20          Disp TO GLOBAL.PARAM.ICKSM.V
  114      GRLCW    EQU      21                   Disp to Retention list control word
  115      CALLPM0  EQU  22
  116      GTRNAME  EQU      38          GLOBAL.PARAM.TRACE.RECNAME
  117      GTRPDCB  EQU      45          GLOBAL.PARAM.TRACE.PAGEDCB
  118      GTRPNO   EQU      46          GLOBAL.PARAM.TRACE.PAGENO
  119      GTRRDBK  EQU      47          GLOBAL.PARAM.TRACE.RECDBK
  120      GTRRTYPE EQU      48          GLOBAL.PARAM.TRACE.RECTYPE
  121      GTRTYPE  EQU      48          GLOBAL.PARAM.TRACE.TYPE
  122      TMODE    EQU      49          TO GLOBAL.PARAM.TRACE.MODE
  123      .TRENTRY EQU      1           Code for trace level of ENTRY
  124      .TRPREAD EQU      2
  125      .TRPWRITE   EQU   3
  126      .TRPMOD  EQU      4
  127      .TRRSTO  EQU      5
  128      .TRRDEL  EQU      6
  129      .TRRMOD  EQU      7
  130      .TRRACC  EQU      8
  131      .TRISTO  EQU      9
  132      .TRIDEL  EQU     10
  133      .TRIMOD  EQU     11
  134      .TRIREAD EQU     12
  135      .TRPREADENQ EQU  13
  136      .TRPMODENQ EQU   14
  137      .TRPDEQ  EQU     15
  138      .TRISTOENQ EQU   16
  139      .TRIDELENQ EQU   17
  140      .TRIMODENQ EQU   18
  141      .TRIREADENQ EQU  19
  142      .TRIDEQ  EQU     20
  143      REM_RECOVER EQU  50           Disp to GLOBAL.PARAN.REM_RECOVER
  144      *
  145      IOINI  EQU     100976            can't initialize inventory
  146      IOSCHEMA EQU     100974            can't open SCHEMA as database
  147      IONOTIDS EQU     100973            AREA opened not IDS organization
  148      IONOTKEY EQU     100972            alternate key AREA not KEYED org
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              5    
  149      *
  150      ***********************************************************
  151      *  USER WORK AREA EQUIVALENCES
  152      ***********************************************************
  153      IFR    EQU     0               IF TEST RESULTS
  154      DBST   EQU     1               DATABASE STATUS
  155      DBAN   EQU     3               DATABASE AREA   NAME
  156      DBSN   EQU     11              DATABASE SET    NAME
  157      DBRN   EQU     19              DATABASE RECORD NAME
  158      DBPKY  EQU     27              DATABASE PRIVACY KEY
  159      DBDR   EQU     30              DIRECT-REFERENCE
  160      DBFN   EQU     31              DB-FIELD-NAME
  161      DBKYN  EQU     39              DB-KEY-NAME
  162      ***********************************************************
  163      *  PROGRAM INFORMATION AREA EQUIVALENCES
  164      ***********************************************************
  165      ISYSDCB  EQU      4                 CP-6 dcb number if valid
  166      ISYSERR  EQU      5                 CP-6 error code if valid
  167      IROLLFLAG EQU     6                 Flag indicating rollback
  168      UPFLAG EQU     7               Use procedure in progress flags
  169      LANGC  EQU     42              LANGUAGE CODE IDENTIFIER
  170      SYSSF  BOOL    000000          SYSTEM SOFTWARE
  171      COB74  BOOL    100000          COBOL 74
  172      FRTRN  BOOL    200000          FORTRAN
  173      MDQS   BOOL    300000          MDQS
  174      INTII  BOOL    400000          INTERACTIVE IDS/II
  175      TPRCOD BOOL    500000          COBOL 74 - MODE IS TPR
  176      LCODM  BOOL    700000          MASK FOR LANGUAGE IDENTIFIER
  177      ***********************************************************
  178      *  STATEMENT CODES
  179      ***********************************************************
  180      AC     EQU     01              ACCEPT
  181      CN     EQU     02              CONNECT
  182      DS     EQU     03              DISCONNECT
  183      ES     EQU     04              ERASE
  184      FD     EQU     05              FIND
  185      FI     EQU     06              FINISH
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              6    
  186      GT     EQU     08              GET
  187      IF     EQU     09              IF
  188      MD     EQU     11              MODIFY
  189      OD     EQU     12              ORDER
  190      RY     EQU     13              READY
  191      ST     EQU     15              STORE
  192      IDS      EQU      19                   IDS internal statement code
  193      HIA      EQU      18                   Initialization
  194      ***********************************************************
  195      *  EXCEPTION CONDITIONS
  196      ***********************************************************
  197      ROLL     EQU      01100             Rollback performed
  198      EOSR   EQU     02100           END OF SET OR AREA
  199      UNA    EQU     02200           REQUEST FOR UNAVAILABLE AREA
  200      SOSE   EQU     02300           NO SET FOUND FOR SOS
  201      RSEE   EQU     02400           NO RECORD FOUND FOR RSE
  202      PCOMP  EQU     02401           PARTIAL COMPARE
  203      CNUL   EQU     03100           CURR OF AREA SET OR REC NULL
  204      CRNUL  EQU     03200           CURR OF RUN NULL
  205      CRIT   EQU     03300           CURR OF RUN IS INCORRECT TYPE
  206      CRST   EQU     03800           CURRENT OF SET IS INCORRECT TYPE
  207      DBKN   EQU     03900           DBK GIVEN IS NULL
  208      IDBK   EQU     04100           DBK INCONSISTENT WITH AREA NAME
  209      IRSN   EQU     04200           REC OR SET NOT DEFINED IN SUB-SCHEMA
  210      IAN    EQU     04300           INVALID AREA NAME
  211      DDI    EQU     05100           DUPLICATE DATA ITEM
  212      IDI    EQU     05200           INVALID DATA ITEM
  213      RDLT   EQU     07100           REC IS DELETED
  214      RNDLT  EQU     07110           REC IS NOT LOGICALLY DELETED
  215      DNES   EQU     07200           DELETION OF NON-EMPTY SET IS SPECIFIED
  216      RIM    EQU     08100           REC IS MEMBER OF SET
  217      RPM    EQU     08200           REC IS PERMANENT MEMBER OF SET
  218      RNM    EQU     08300           REC IS NOT MEMBER OF SET
  219      ICA    EQU     08400           MEMBERS IN PERM. & TEMP. AREAS
  220      SMCR   EQU     08500           SET MEMBERSHIP CHANGE REQUIRED
  221      SORSA  EQU     08600           SET OCCURRANCE MUST BE RESTRICTED TO SINGLE AREA
  222      ANR    EQU     09100           AREA NOT READY
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              7    
  223      IUM    EQU     09200           INVALID USAGE MODE FOR AREA
  224      AIR    EQU     09300           AREA IS READY
  225      RFDNL  EQU     70100           READY OR FINISH DENIAL
  226      ACDNL  EQU     70200           AREA SELECTION DENIAL
  227      RCDNL  EQU     70300           RECORD SUBENTRY DENIAL
  228      FRDNL  EQU     70400           DATA   SUBENTRY DENIAL
  229      SCDNL  EQU     70500           SET    SUBENTRY DENIAL
  230      RSDNL  EQU     70600           MEMBER SUBENTRY DENIAL
  231      NSDB   EQU     80100           NO SPACE IN DATABASE AVAILABLE
  232      NSA    EQU     80200           NO SPACE IN AREA AVAILABLE
  233      IVDBK  EQU     80210           INVALID DBK CHANGE REQUIRED              <EHW>
  234      FALRT  EQU     80220           FILE IN ALERT STATUS
  235      IKSEQ  EQU     80230           REC NOT IN PRIME KEY SEQ ON BUILD
  236      NSCS   EQU     80300           DBCS SPACE EXHAUSTED
  237      NKDB   EQU     80400           NO DBK'S IN DATABASE AVAILABLE
  238      NKA    EQU     80500           NO DBK'S IN AREA AVAILABLE
  239      LR     EQU     90100           LOCKED RESOURCE SPECIFIED
  240      LRA    EQU     99000           LOCKED RESOURCE SPECIFIED - ABORT
  241      ***********************************************************
  242      *  ERROR CODES
  243      ***********************************************************
  244      *
  245      *  ERRORS COMMON TO ALL ROUTINES AND PRIMITIVES
  246      *
  247      INTER  EQU     100001          INTERNAL ERROR
  248      ARGER  EQU     070002          CALLING ARGUMENT ERROR
  249      SSER   EQU     100003          SCHEMA SUBSET ERROR
  250      SSER1  EQU     100004          INVALID SCHEMA SUBSET
  251      AFNP   EQU     070005          AREA-ID FIELD NOT FOUND FOR MULTI-AREA RE
  252      INNM   EQU     070006          SCHEMA OR SUBSCHEMA NAME NOT CORRECT
  253      INSS   EQU     070007          SUBSCHEMA TRANS. AFTER COMPILE OF PROGRAM
  254      ORDNI  EQU     070008          ORDER VERB NOT IMPLEMENTED
  255      EDPER  EQU     100009          DP FOR USER'S ENC/DEC NOT FOUND
  256      RCBI   EQU     010010          REC CAN'T BE INSERTED INTO SET - INCOM SS
  257      SSNF   EQU     070011          SUBSCHEMA NOT FOUND ON SCHEMA FILE
  258      RSZER  EQU     070012          RECORD SIZE ERROR
  259      INSST  EQU     070013          SUBSCHEMA TRANSLATION DATE ERROR (SS TRANS DATE
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              8    
  260      SSNV  EQU      070014         Subschema not validated
  261      *  I/O ERRORS
  262      IOE1   EQU     100015          PAGE READ NOT PAGE REQUESTED
  263      IOE2   EQU     100016          LINE OFFSET OUTSIDE LIMITS
  264      IOE3   EQU     100017          ATTEMPTED TO READ PAGE 0
  265      IOE7   EQU     100018          AVAIL. LINE OUTSIDE ARRAY LIMITS
  266      IOE8   EQU     100019          LINE IN AVAIL. CHAIN NOT AVAIL
  267      IOE11  EQU     100020          SPACE AVAIL. GR THAN ACTIVE SIZE
  268      IOE12  EQU     100021          INVENT. OFST GR PAGE SIZE
  269      IOE18  EQU     100022          NOT ENOUGH BUFFERS
  270      *  PRIMITIVE ERRORS
  271      PRE1   EQU     100023          CURR OF RUN NOT SAME TYPE AS LAST ACCESS
  272      PRE3   EQU     100024          RECORD RETRIEVED IS NOT OWNER
  273      PRE4   EQU     100025          ENCODE INDEX OUTSIDE LIMIT
  274      PRE5   EQU     100026          DECODE INDEX OUTSIDE LIMIT
  275      PRE6   EQU     070027          RC NOT FOUND
  276      PRE7   EQU     070028          RS NOT FOUND
  277      PRE8   EQU     070029          RA NOT FOUND
  278      PRE9   EQU     100030          ILLEGAL SET ORDER
  279      PRE10  EQU     100031          ILLEGAL COMPARE CODE IN FR
  280      *  READY ERRORS
  281      RYE1   EQU     070032          REFERENCE VECTOR ENTRY NOT FOUND
  282      RYE4   EQU     070033          TOO MANY AREAS OPEN AT ONCE
  283      *  STORE  ERRORS
  284      STE1   EQU     100034          LOC MODE = DIRECT; FR NOT FOUND
  285      STE2   EQU     100035          ILLEGAL LOC MODE IN RC
  286      STE3   EQU     070036          STORE OF REC NOT ALLOWED - INCOMPLETE SS
  287      STE4   EQU     100037          ERROR DURING ERROR RECOVERY
  288      STE5   EQU     100038          SET NOT FOUND FOR LOC MODE SET
  289      *  ERASE ERRORS
  290      DLE1   EQU     070039          ERASE OF REC NOT ALLOWED - INCOMPLETE SS
  291      DLE2   EQU     100040          ERROR DURING ERROR RECOVERY
  292      DLE3   EQU     070041          ERASE ALL NOT ALLOWED - INCOMPLETE SS
  293      *  MODIFY ERRORS
  294      MRE4   EQU     070042          FIELD CANNOT BE MOD. - INCOMPLETE SS
  295      MRE5   EQU     100043          ERROR DURING ERROR RECOVERY
  296      MRE7   EQU     070044          CALC KEY CAN'T BE MODIFIED - INCOMP. SS
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              9    
  297      *  CONNECT ERRORS
  298      CNE1   EQU     100045          ERROR DURING ERROR RECOVERY
  299      *  DISCONNECT ERRORS
  300      DSE1   EQU     100046          ERROR DURING ERROR RECOVERY
  301      *  FIND ERRORS
  302      FDE1   EQU     070047          FIELD NOT IN SUBSCHEMA
  303      FDE2   EQU     100048          NO SS ENTRIES FOR RS
  304      FDE3   EQU     100049          CALC HDR REC NOT CORRECT TYPE
  305      FDE4   EQU     070050          RS NOT FOUND RELATING RC & SC
  306      FDE5   EQU     070051          REC RETRIEVED NOT CORRECT TYPE
  307      FDE6   EQU     070052          RC NOT FOUND FOR REC RETRIEVED
  308      FDE7   EQU     100053          OWNER OF SET WITH MEMBERS IS LOGICALLY DELETED
  309      FDE8   EQU     100054          CURR OF RUN IS LOGICALLY DELETED
  310      *  ENCODE ERRORS
  311      ENE1   EQU     070055          ENCODE ERROR
  312      *  DECODE ERRORS
  313      DCE1   EQU     070056          DECODE ERROR
  314      *  ERRORS ENCOUNTERED IN BUFFER MGT ROUTINES
  315      BME02  EQU     100057          BAD STATUS ON CALL TO CHANGE CI ATTRIBUTE
  316      *  INTERFACE UTILITY ERRORS
  317      DBLC01 EQU     070058          CAN'T OBTAIN ENOUGH STORAGE TO LOAD SS INFO
  318      DBLC05 EQU     070059          CANNOT ACCESS SUBSCHEMA FILE
  319      DBLC07 EQU     100060          CANNOT READ SUBSCHEMA FILE
  320      DBLD01 EQU     070061          A DB PROC NAME CANNOT BE FOUND
  321      *  POINTER ARRAY ERRORS
  322      PAER1  EQU     100062          A PTR IN PA REC IS NULL
  323      PAER2  EQU     100063          INCORRECT FORMAT FOR DUMMY PA ENTRY
  324      PAER3  EQU     100064          REC TYPE RETRIEVED NOT SAME TYPE AS IN PA REC
  325      PAER4  EQU     100065          NO. OF ENTRIES IN PA REC INCORRECT
  326      PAER5  EQU     100066          OFSTS NOT FOUND IN PA REC
  327      PAER6  EQU     100067          SPACE AVAILABLE ERROR IN PA REC
  328      XUNEX  EQU     070068          Unexpected Xcon.  Rollback attempted
  329      XASL   EQU     070069          Unexpected Xcon from ASL domain.
  330      XROLL  EQU     070070          Error during Roll. DB is suspect.
  331      *  Errors detected by the DBCS climb receiver.
  332      RCVER1 EQU     070071          ETC function received but not pending
  333      RCVER2 EQU     070072          o/t ETC function received while ETC pending
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              10   
  334      RCVER4 EQU     070073          Can't perform DBCS initialization
  335      RCVER5 EQU     070074          data-base for given sub-schema not HIA'd
  336      RCVER6 EQU     070075          Invalid function code given on climb
  337      *      Errors detected by CP-6 IDS I/O interface routines.
  338      IOCLSD EQU     100076          can't close integrated (IDS) file
  339      IOCLSK EQU     100077          can't close alternate (KEY) file
  340      IOGDCB EQU     070078          can't perform M$GETDCB
  341      IOOPND EQU     070079          can't open integrated (IDS) file
  342      IOOPNK EQU     070080          can't open alternate (KEY) file
  343      IORDD  EQU     100081          can't read block (IDS org.)
  344      IOWRTD EQU     100082          can't write block (IDS org.)
  345      IOFLSH EQU     100083          can't perform buffer flush
  346      *        ERRORS DETECTED BY CP-6 INDEXED AND SECONDARY KEY ROUTINES
  347      DELAK    EQU      100107               Delete of alternate key failed
  348      DLDBK    EQU      100108               Duplicate local DBKEY found
  349      NLDBK    EQU      100109               Key found with no local DBKEY
  350      PSA      EQU      100110               PREC during DBXSA failed
  351      UNIM     EQU      100111               Unimplemented and illegals
  352      XLD      EQU      100112               Key exists for logically deleted record
  353      XPD      EQU      100113               Key exists for physically deleted record
  354      ICNR     EQU      070114               Index currency not returnable
  355      ENCPNA   EQU       070089              Encription not allowed for this area
  356      BADSEED  EQU       070090              Bad encript seed passed for area
  357      ARNAF    EQU       070091              Area requested not area found
  358      CKSM     EQU       100092            Checksum different from one on page
  359      *
  360      *
  361      *      miscellaneous parameters related to exception code processing
  362      FTLINCR EQU    100000          fatal error if exc. code .ge. this value
  363      *
  364      ***********************************************************
  365      *  DATA BASE PROCEDURE TYPES
  366      ***********************************************************
  367      *  AREA SUBENTRY
  368      *  RECORD SUBENTRY
  369      .PTAS  EQU     3104            AREA SELECTION PROCEDURE
  370      *  DATA SUBENTRY
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              11   
  371      .PTENC EQU     4192            ENCODE
  372      .PTDEC EQU     4224            DECODE
  373      .PTCHK EQU     4160            CHECK
  374      ***
  375             CBSYM
  376      *                              WORD 11 NOT USED
  377      CBRCE  EQU     12              PA ENTRY OFST (MUST BE EVEN)
  378      CBRCP  EQU     12              PA PTR OFST
  379      CBRPA  EQU     13              DBK OF OWNER PA REC
  380      *
  381      *              BUFFER WORK AREA EQUIVALENCES
  382      *
  383      BWASZ  EQU     16              SIZE OF BUF WORK AREA
  384      BUFORG EQU     0
  385      NXBUF  EQU     BUFORG-BWASZ+0  NEXT BUF PTR
  386      ACDEF  EQU     BUFORG-BWASZ+0  AC PTR
  387      BID    EQU     BUFORG-BWASZ+1  PAGE NO.
  388      PBUF   EQU     BUFORG-BWASZ+2  PRIOR BUF PTR
  389      BIND   EQU     BUFORG-BWASZ+2  BUF INDICATORS & LOCK
  390      BSTAT  EQU     BUFORG-BWASZ+3  I/O STATUS
  391      BDCW   EQU     BUFORG-BWASZ+5  DCW FOR I/O
  392      RBA    EQU     BUFORG-BWASZ+6  REL. SECTOR NO.
  393      SA     EQU     BUFORG-BWASZ+7  SEEK ADDR.
  394      NLNSA  BOOL    400000          NO LINES AVAIL THIS PAGE
  395      MW     BOOL    400000          MUST WRITE       - INDICATOR WORD
  396      WRTI   BOOL    100000          WRITE ISSUED     - INDICATOR WORD
  397      RDI    BOOL    040000          READ ISSUED      - INDICATOR WORD
  398      BEFW   BOOL    020000          BEFORE WRITTEN   - INDICATOR WORD
  399      *
  400      *              PAGE SKELETON EQUIVALENCES
  401      *
  402      ACTSZ  EQU     0               ACTIVE PAGE SIZE
  403      SPAV   EQU     0               SPACE AVAILABLE THIS PAGE
  404      APNO   EQU     1               AREA - PAGE NO.
  405      AVLN   EQU     2               1ST AVAIL. LINE NO.
  406      HILN   EQU     2               CURRENT HIGH LINE NO.
  407      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              12   
  408      *              POINTER ARRAY RECORD EQUIVALENCES
  409      *
  410      PACW   EQU     1               LOC OF PA CONTROL WORD WITHIN RECORD
  411      .PANLL BOOL    400000          1 = PA NOT LOWEST LEVEL
  412      .PAHVR BOOL    200000          1 = PA HIGHEST KEY VALUE REPEATED IN NEXT REC
  413      .PAFIL BOOL    100000          1 = PA IS FIRST IN ITS LEVEL
  414      .PALIL BOOL    040000          1 = PA LAST IN ITS LEVEL
  415      .PALVR BOOL    020000          1 = PA LOWEST KEY VALUE REPEATED IN PRIOR REC
  416      .NOENT BOOL    017777          MASK FOR NO. OF ENTRIES
  417             SSSYM
  418      *
  419      ***********************************************************
  420      *  BIT NO. EQUIVALENCES
  421      ***********************************************************
  422      .B0    BOOL    400000
  423      .B1    BOOL    200000
  424      .B2    BOOL    100000
  425      .B3    BOOL    40000
  426      .B4    BOOL    20000
  427      .B5    BOOL    10000
  428      .B6    BOOL    4000
  429      .B7    BOOL    2000
  430      .B8    BOOL    1000
  431      .B9    BOOL    400
  432      .B10   BOOL    200
  433      .B11   BOOL    100
  434      .B12   BOOL    40
  435      .B13   BOOL    20
  436      .B14   BOOL    10
  437      .B15   BOOL    4
  438      .B16   BOOL    2
  439      .B17   BOOL    1
  440      .B18   BOOL    400000
  441      .B19   BOOL    200000
  442      .B20   BOOL    100000
  443      .B21   BOOL    40000
  444      .B22   BOOL    20000
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              13   
  445      .B23   BOOL    10000
  446      .B24   BOOL    4000
  447      .B25   BOOL    2000
  448      .B26   BOOL    1000
  449      .B27   BOOL    400
  450      .B28   BOOL    200
  451      .B29   BOOL    100
  452      .B30   BOOL    40
  453      .B31   BOOL    20
  454      .B32   BOOL    10
  455      .B33   BOOL    4
  456      .B34   BOOL    2
  457      .B35   BOOL    1
  458               LIST     ON
  459             ENDM    Q2SYM
  460             EJECT
  461      SSSYM  MACRO
  462      ***********************************************************
  463      *  CONTROL STRUCTURE EQUIVALENCES
  464      ***********************************************************
  465      XXDPN  EQU     -1              DP PROC. SET
  466      DEF    EQU     0
  467      *  OA DEF SYMBOLS
  468      .OA    BOOL    400000          DEF TYPE FOR OA
  469      OAACN  EQU     1               OA.AC SET NEXT PTR
  470      OASCN  EQU     1               OA.SC SET NEXT PTR
  471      OARCN  EQU     2               OA.RC SET NEXT PTR
  472      UWSSZ  EQU     2               SIZE OF AREA, RECORD, SET WORK SPACES
  473      CLCSC  EQU     3               OFST OF SC DEF FOR CALC SET
  474      CLCRC  EQU     3               OFST OF RC DEF FOR CALC HDR REC
  475      SCNAM  EQU     4               SCHEMA     NAME DESCRIPTOR
  476      SSNAM  EQU     5               SUB-SCHEMA NAME DESCRIPTOR
  477      SSDT   EQU     6               SUB-SCHEMA DATE AND TIME
  478      SSVDT  EQU     8               VALIDATION DATE/TIME
  479      NENC   EQU     10              NO. OF ENCODE PROCEDURES
  480      ENTBL  EQU     11              PTR TO ENCODE PROC. TBL
  481      NDCD   EQU     12              NO. OF DECODE PROCEDURES
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              14   
  482      DEF2   EQU     12              SOME MORE BIT DEFINITIONS
  483      .OPEV  BOOL    740000          OPERATING ENVIRONMENT
  484      DCTBL  EQU     13              PTR TO DECODE PROC. TBL
  485      AMAX   EQU     14              MAX AREA NO. + 1
  486      CSZ    EQU     15              SIZE OF CURRENCIES
  487      LRSZ   EQU     15              SIZE OF LARGEST REC KNOWN TO SS
  488      UWSZ   EQU     16              SIZE OF UWA
  489      FEASZ  EQU     17              FACT ENTRY AREA SIZE
  490      FWSSZ  EQU     17              FACT WORK SPACE SIZE
  491      KPASZ  EQU     18              SIZE OF KEY PROCESS AREA
  492      OACIWSOF EQU      18                   Offset to currency for indexed
  493      LPASZ  EQU     19              SIZE OF LARGEST PA REC
  494      SCFC   EQU     20              FILE CODE FOR SCHEMA FILE
  495      *  AC DEF SYMBOLS
  496      .AC    BOOL    200000          DEF TYPE FOR AC
  497      .FORG  BOOL    000074          FILE ORGANIZATION TYPE
  498      .INDEXED BOOL     000010               Indexed area flag
  499      .NCIA  BOOL    000002          NO CALCS IN AREA
  500      .PAIA  BOOL    000001          1 = PA RECS IN AREA
  501      .PMOD  BOOL    001600          PAGE MODE
  502      .ATMP  BOOL    000100          1 = TEMPORARY AREA
  503      .ANL   BOOL    000077          AREA NAME LENGTH
  504      .CHKSUM  BOOL  400000
  505      .ENCRP   BOOL  200000
  506      .CJRNL   BOOL     100000
  507      .TMPLT   BOOL  040000
  508      .TJRNL   BOOL     020000
  509      IXPLL  EQU     -1              INDEX FILE PERCENT LOAD LIMIT
  510      ACRAN  EQU     1               AC.RA SET NEXT PTR
  511      ABAS   EQU     2               DBK FOR BASE OF LOCAL PTRS
  512      WSOF   EQU     3
  513      ACID   EQU     3               AREA ID NO. FOR BINDING
  514      PLSEP  EQU     4               36 - NO. OF BITS FOR LINE NO.
  515      BPL    EQU     4               BITS FOR LINE NO.
  516      SANAM  EQU     5               DESCR. FOR SCHEMA AREA NAME
  517      PGLIM  EQU     6               LOW & HIGH PAGE LIMITS
  518      DBLIM  EQU     8               LOW & HIGH DBK LIMITS
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              15   
  519      LPP    EQU     10              LINES/PAGE
  520      INTVL  EQU     11              DBK'S / CALC HDR REC
  521      INVT   EQU     12              INVENTORY THRESHOLD (CHARS)
  522      BPLDBK EQU     13              BYTES PER LOCAL DB KEY.
  523      FLAGS    EQU   13                EXTRA FLAGS
  524      INCHA    EQU      14                   Initial # of calc headers.
  525      IUSZ   EQU     15              INVENTORY UNIT SIZE
  526      DPPI   EQU     16              DATA PAGES / INVENT. PAGE
  527      IFIPN    EQU      17                   Initial First inventory page
  528      CLCN   EQU     18              CALC NXT PTR DESCR.
  529      CLCP   EQU     19              CALC PRI PTR DESCR.
  530      UFSPK  EQU     20              UFAS PACKAGE ADDRESS
  531      UFSPK2 EQU     20              ADDITIONAL UFAS PKG ADDRESS
  532      ANAM   EQU     22              START OF SUBSCHEMA AREA NAME
  533      *  RC DEF SYMBOLS
  534      .RC    BOOL    100000          DEF TYPE FOR RC
  535      .PSTO  BOOL    000007          PRIMARY STORAGE MODE
  536      .RERS  BOOL    400000          1 = ERASE NOT ALLOWED
  537      .RSTO  BOOL    200000          1 = STORE NOT ALLOWED
  538      .SR    BOOL    100000          1 = REC NOT IN SUB-SCHEMA
  539      .FVR   BOOL    040000          1 = VARIABLE LENGTH RECORD
  540      .MAR   BOOL    020000          1 = MULTI-AREA RECORD
  541      .RKEY  BOOL    010000          RECORD HAS ALTERNATE KEYS
  542      .RERA  BOOL    004000          1 = ERASE ALL MEMBERS NOT ALLOWED
  543      .DIDP  BOOL    002000          1 = DONT INVOKE AREA SELECTION DB PROC
  544      CSPAC  BOOL    001000          1 = PA RECORD
  545      .RNL   BOOL    000077          RECORD NAME LENGTH
  546      .RTYP    BOOL  007777          Record type mask
  547      CSPSB  EQU     -2              START BYTE OF 1ST ENTRY IN PA REC
  548      CSPES  EQU     -2              PA ENTRY SIZE
  549      OTVL   EQU     -1              OFFSET TO VARIABLE LENGTH DATA
  550      RCRAN  EQU     1               RC.RA SET NEXT PTR
  551      RCID   EQU     1               RECORD ID FOR BINDING
  552      RCRSN  EQU     2               RC.RS NEXT
  553      RSIZ   EQU     3               RECORD SIZE
  554      RTYP   EQU     3               RECORD TYPE
  555      RCWSO  EQU     4               WORK SPACE OFST
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              16   
  556      RCFRN  EQU     4               RC.FR NEXT
  557      RNAM   EQU     5               RECORD NAME
  558      *  SC DEF SYMBOLS
  559      .SC    BOOL    040000          DEF TYPE FOR SC
  560      .SETM  BOOL    000070          SET MEMBER MASK
  561      .IXID  BOOL    777777          INDEX ID NUMBER
  562      .SETO  BOOL    740000          SET ORDER
  563      .SNSS  BOOL    020000          1 = SET NOT IN SUB-SCHEMA
  564      .SRCR  BOOL    004000          1 = RECURSIVE SET
  565      .ALTO  BOOL    002000          1 = ALTERNATE OWNER
  566      .LG    BOOL    001000          1 = GLOBAL SET
  567      .SETT  BOOL    000700          SET TYPE
  568      .SNL   BOOL    000077          SET NAME LENGTH
  569      IXID   EQU     -2              LOC OF INDEX ID
  570      KLNG   EQU     -2              LENGTH OF KEY IN BYTES
  571      SCWSO  EQU     1               WORK SPACE OFST
  572      SCRSN  EQU     2               SC.RS NEXT
  573      SCID   EQU     2               SET ID FOR BINDING
  574      SNAM   EQU     3               SET NAME
  575      *  RA DEF SYMBOLS
  576      .RA    BOOL    020000          DEF TYPE FOR RA
  577      FRANGE   BOOL     000002               Full range
  578      RCRAH  EQU     2               RC.RA HEAD PTR
  579      ACRAH  EQU     2               AC.RA HEAD PTR
  580      PGRNG  EQU     3               PAGE RANGE
  581      RAWSOF   EQU      4                    AWS offset if FRANGE set.
  582      NCHRS  EQU     5               NO. CALC HDR RECS IN RNG
  583      CHRD   EQU     6               DISPL. OF LO DBK FROM CHR
  584      *  RS DEF SYMBOLS
  585      .SO    BOOL    010000          DEF TYPE FOR SO
  586      .SM    BOOL    004000          DEF TYPE FOR SM
  587      .VIA   BOOL    000040          1 = THIS IS LOC MODE SET
  588      .MEMT  BOOL    000007          MEMBER TYPE MASK
  589      .DORD  BOOL    600000          DUPLICATE ORDER
  590      .OSM   BOOL    100000          1 = OPTIONAL SET MEMBER
  591      .MSM   BOOL    040000          1 = MANUAL SET MEMBER
  592      .SMOD  BOOL    020000          1 = THIS SET MEMBERSHIP CANNOT BE MOD.
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              17   
  593      .DUPP  BOOL    010000          1 = DUP KEYS PRESENT
  594      .DUPC  BOOL    002000          1 = DUPS NOT ALLOWED FOR CALC
  595      .IXNUM   BOOL     001777               Index number of key within record
  596      RSCDN  EQU     1               RS.CD NEXT
  597      RSSSN  EQU     1               RS.SS NEXT
  598      RCRSH  EQU     3               RC.RS SET HEAD PTR
  599      SCRSH  EQU     3               SC.RS SET HEAD PTR
  600      NPOS   EQU     4               POS. OF NEXT  PTR IN RECORD
  601      PPOS   EQU     5               POS. OF PRIOR PTR IN RECORD
  602      HPOS   EQU     6               POS. OF HEAD  PTR IN RECORD
  603      CSPAH  EQU     4               POS OF PA OWNER PTR IN PA MEM REC
  604      CSMPP  EQU     7               POS OF MEMBER PTR IN PA REC
  605      *  FR DEF SYMBOLS
  606      .FR    BOOL    002000          DEF TYPE FOR FR
  607      .ENDX  BOOL    000077          ENCODE INDEX
  608      .EBCM  BOOL    400000          1 = ENCODE BEFORE COMPARE
  609      .EBCL  BOOL    200000          1 = ENCODE BEFORE CALC
  610      .COMC  BOOL    160000          COMPARE CODE
  611      .FVF   BOOL    010000          1 = VARIABLE LENGTH FIELD
  612      .SYN   BOOL    004000          1 = SYNONYM FIELD
  613      .FUSE  BOOL    003400          USAGE CODE
  614      .FMOD  BOOL    000200          1 = THIS FIELD CANNOT BE MODIFIED
  615      .FSR   BOOL    000100          1 = THIS FIELD NOT IN SUB-SCHEMA
  616      .DNDX  BOOL    000077          DECODE INDEX
  617      .FNL   BOOL    000077          FIELD NAME LENGTH
  618      NLIND  EQU     -1              BIT NO. OFST OF NULL INDICATOR
  619      ROFST  EQU     1               OFST IN RECORD
  620      UOFST  EQU     2               OFST IN UWA
  621      CDSN   EQU     3               FR.CDS NEXT
  622      CDRN   EQU     3               FR.CDR NEXT
  623      FNL    EQU     4               FIELD NAME LENGTH
  624      RCFRH  EQU     5               RC.FR HEAD
  625      FRWSO  EQU     5               WORK SPACE OFST
  626      FNAM   EQU     6               FIELD NAME
  627      *  SS DEF SYMBOLS
  628      .SS    BOOL    001000          DEF TYPE FOR SS
  629      .SSTP  BOOL    000007          SET SELECTION TYPE
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              18   
  630      SSH    EQU     2               RS SEARCH POINTER
  631      RSSSH  EQU     2               RS.SS HEAD
  632      *  CD DEF SYMBOLS
  633      .CD    BOOL    000400          DEF TYPE FOR CD
  634      .SYNC  BOOL    000040          1 = SYNONYM CD
  635      .CONT  BOOL    000020          1 = DESCENDING
  636      .RELT  BOOL    000017          RELATIONSHIP TYPE
  637      .AV    BOOL    400000          1 = VIRTUAL CD
  638      RSCDH  EQU     1               RS.CD HEAD
  639      CDSH   EQU     2               FR.CDS HEAD
  640      CDRH   EQU     2               FR.CDR HEAD
  641      *  DP DEF SYMBOLS
  642      .DP    BOOL    000200          DEF TYPE FOR DP
  643      .CNSZ  BOOL    000077          SIZE OF CONSTANT SECTION
  644      .CTYP  BOOL    700000          TYPE OF CALL
  645      .DBPT  BOOL    077777          DATA BASE PROCEDURE TYPE
  646      DPAGN  EQU     -1              DP.AG NEXT
  647      COFS   EQU     1               OFST TO DB PROC. TYPE
  648      *  AG DEF SYMBOLS
  649      .AG    BOOL    000100          DEF TYPE FOR AG
  650      .DPST  BOOL    400000          1 = THIS IS TATUS ARG
  651      .DPSA  BOOL    200000          1 = THIS IS PSEUDO ARG(NU BY DBCS)
  652             ENDM    SSSYM
  653             EJECT
  654      CBSYM  MACRO
  655      ***********************************************************
  656      *  DATA BASE CONTROL BLOCK EQUIVALENCES
  657      ***********************************************************
  658      CSECT  EQU     0
  659      SWS    EQU     CSECT+16
  660      .DBEST EQU     SWS+168
  661      ESTSZ  EQU     64              SIZE OF ERASE STACK
  662      .DBSTK EQU     .DBEST+ESTSZ
  663      STKSIZ EQU     64              SIZE OF FIND STACK
  664      .DBIC  EQU     .DBSTK+STKSIZ
  665      ICSIZ  EQU     16              SIZE OF IC STACK
  666      PCB    EQU     .DBIC+ICSIZ
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              19   
  667      PWS    EQU     PCB+80
  668      IOWS   EQU     PWS+80          START OF I/O WORK SPACE
  669      FIB1   EQU     IOWS+88
  670      VIB1   EQU     FIB1+20         VIB FOR DATABASE FILES
  671      FIBP   EQU     FIB1+24         FIB FOR PRINT FILES
  672      VIBP   EQU     FIBP+20         VIB FOR PRINT FILE
  673      BUF4   EQU     FIBP+24         4-BIT BUF(8W LONG)
  674      BUF6   EQU     BUF4+8          6-BIT BUF(11W LONG)
  675      BMPB   EQU     BUF6+11         BUFFER MGT PARAMETER BLOCK
  676      MODFL  EQU     BMPB+4          MODIFY CI LIST
  677      UBSZ   EQU     MODFL+12
  678      CRUN   EQU     UBSZ            CURRENT OF RUN
  679      SFWS   EQU     CRUN+2          SCHEMA FILE WORK SPACE
  680      IXFBSZ EQU     38              SIZE OF INDEX FIB & I/O BLOCK
  681      *  OFFSETS RELATIVE TO IXFIB PTR
  682      FIBX   EQU     0               INDEX FIB
  683      IOBLK  EQU     28              UFAS I/O BLOCK
  684      *
  685      *              I/O WORK SPACE EQUIVALENCES
  686      *
  687      BTX0   EQU     IOWS+0          X0 FOR RPLX SEARCH OF BUFFERS
  688      LUPD   EQU     IOWS+0          BWA OF BUF LAST UPDATED IN ACT. CHAIN
  689      BEMT   EQU     IOWS+1          ADDR OF BWA FOR EMPTY BUFFER
  690      ENDSR  EQU     IOWS+2          ENCODE DESCRIPTOR FOR UWA
  691      CBIB   EQU     IOWS+3          ADDR OF BWA BEING SET UP
  692      DBK    EQU     IOWS+4          CURRENT DATA BASE KEY
  693      IAAC   EQU     IOWS+6          AC DEF FOR AREA TO INIT
  694      DCDSR  EQU     IOWS+7          DECODE DESCR. FOR FLD IN REC
  695      LNNO   EQU     IOWS+10         LINE NO. REQUESTED
  696      CREC   EQU     IOWS+12         CURRENT RECORD OFFSET
  697      SPND   EQU     IOWS+13         SPACE NEEDED          - FIND SPACE
  698      SPLF   EQU     IOWS+13         SPACE LEFT            FIND SPACE
  699      FSOF   EQU     IOWS+14         CURRENT RECORD OFFSET - FIND SPACE
  700      FSLN   EQU     IOWS+15         CURRENT LINE NO.      - FIND SPACE
  701      CURPG  EQU     IOWS+16         CURRENT PAGE          - INIT AREA
  702      NXTC   EQU     IOWS+17         NEXT CALC HDR. REC    - INIT AREA
  703      CHRO   EQU     IOWS+18         NEXT AVAIL. OFST      - INIT AREA
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              20   
  704      CHR    EQU     IOWS+19         CALC HEADER RECORD    - INIT AREA
  705      CTPAI  EQU     IOWS+20         2 PART AREA INDICATOR- OPEN/CLOSE AREA
  706      HIDB   EQU     IOWS+21         HI DBK FOR REC        - FIND SPACE
  707      DBKR   EQU     IOWS+22         CURRENT OF AREA       - NEXT/PRIOR OF AR
  708      CPGR   EQU     IOWS+24         CURR PAGE & LINE NO.  - NEXT/PRIOR OF AR
  709      IOINC  EQU     IOWS+26         INCREMENT FROM CURRENT- NEXT/PRIOR OF AR
  710      ACREC  EQU     IOWS+27         REC OFST IN PAGE      - NEXT/PRIOR OF AR
  711      CRD    EQU     IOWS+28         CURRENT READ COUNTER
  712      CWRT   EQU     IOWS+29         CURRENT WRITE COUNTER
  713      B32N   EQU     IOWS+30         32 BIT BINARY NO.     - ENCODE/DECODE
  714      B36N   EQU     IOWS+31         36 BIT BINARY NO.     - ENCODE/DECODE
  715      IALC   EQU     IOWS+32         LINE NO. OF LAST CHR  - INIT AREA
  716      IACLN  EQU     IOWS+33         OFST & NO. OF AV. LN  - INIT AREA
  717      IANLN  EQU     IOWS+34         OFST & NO. NXT AV LN  - INIT AREA
  718      UBRD2  EQU     IOWS+35         BURID FOR FIND SPACE,DELETE REC RTNS
  719      LAS    EQU     IOWS+36         LINE ARRAY SIZE IN CHARS
  720      DBKAC  EQU     DBKR+1              DBK for FIND AC is DBK requested.
  721      ACOPN  EQU     IOWS+38         AC TO OPEN/CLOSE      - OPEN/CLOSE AREA
  722      ACTP   EQU     IOWS+39         NXT AV. AREA TBL ENTRY- OPEN/CLOSE AREA
  723      LNCNT  EQU     IOWS+39         LINE CNT-UPDATE OFSTS IN LINE ARRAY
  724      FBUF   EQU     IOWS+40         ND4 FOR 4-BIT BUF
  725      FBUFU  EQU     IOWS+41         ND4 FOR 4-BIT BUF(LESS SIGN)
  726      FBUFM  EQU     IOWS+42         ND4 FOR 4-BIT BUF(MSD & SIGN)
  727      FBUMD  EQU     IOWS+43         AD4 FOR 4-BIT BUF(MSD ONLY)
  728      FBUF6  EQU     IOWS+44         AD6 FOR 6-BIT BUF
  729      FBU61  EQU     IOWS+45         AD6 FOR 6-BIT BUF(1ST CHAR ONLY)
  730      FBUF1  EQU     IOWS+46         ND4 FOR 4-BIT BUF(SIGN + 11 DIGITS)
  731      FBUF4  EQU     IOWS+47         AD4 FOR 4-BIT BUF
  732      CBID   EQU     IOWS+48         CURRENT BURID - INVENTORY ROUTINES
  733      ELO    EQU     IOWS+48         EVEN LINE OFFSET-UPDATE ARRAY AFTER PAGE COMPACT
  734      TSFN   EQU     IOWS+49         FILE NAME FOR TSS I/O
  735      CBRID  EQU     IOWS+51         CURRENT BURID-USED IN RETRIEVAL RTNS
  736      CAL    EQU     IOWS+51         CURR AVAIL. LINE NO. - FIND SPACE
  737      PLO    EQU     IOWS+52         PRIOR LINE PTR OFST  - FIND SPACE
  738      LSPC   EQU     IOWS+53         LINE ARRAY SPC NEEDED- FIND SPACE
  739      UPACD  EQU     IOWS+53         AC PTR FOR FIND SPACE,DELETE REC RTNS
  740      LOL    EQU     IOWS+54         LO LINE NO.          - FIND SPACE
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              21   
  741      HIL    EQU     IOWS+55         HI LINE NO.          - FIND SPACE
  742      NLN    EQU     IOWS+56         NUMBER OF LINE NOS ALLOCATED ON PAGE
  743      PACD   EQU     IOWS+57         AC PTR FOR I/0 ROUTINES
  744      CINVSZ EQU     IOWS+57         NO. INVENT. UNITS    - UPDATE INVENTORY
  745      CIPG   EQU     IOWS+58         CURR INVENT. PAGE NO.- UPDATE INVENTORY
  746      CIAC   EQU     IOWS+59         AC PTR FOR CURRENT BUFFER
  747      INVOF  EQU     IOWS+59         BYTE OFST IN INV PAGE- UPDATE INVENTORY
  748      CDPSI  EQU     IOWS+60         CURR DATA PAGE NO.
  749      LDPSI  EQU     IOWS+61         LAST DATA PAGE NO.
  750      SNSI   EQU     IOWS+62         NO. CHARS NEEDED, IU'S FOUND
  751      POFSI  EQU     IOWS+63         OFST IN CURR INVENT. PAGE
  752      CIPSI  EQU     IOWS+64         CURR INVENT. PAGE NO.
  753      CIBSI  EQU     IOWS+65         ADDR OF CURR INV. BUF
  754      IOSTS  EQU     IOWS+66         EXCEPT. CODE FROM ERROR IN I/O ROUTIN.
  755      CFCT   EQU     IOWS+67         CURRENT FACT ADDR
  756      DCPR   EQU     CFCT            maintains CP-6 disc read statistics
  757      NOBF   EQU     IOWS+67         NO. OF BUF LEFT TO FLUSH
  758      DCPW   EQU     NOBF            maintains CP-6 disc write statistics
  759      PNEOO  EQU     IOWS+68         PG NO. OF I/O ERROR
  760      FBF72  EQU     IOWS+69         AN4 EIS DESCRIPTOR - SIGN + 22 DIGITS
  761      B72N   EQU     IOWS+70         72-BIT BINARY NUMBER
  762      INVFLG EQU     IOWS+72         INVENTORY FLAG WHEN RECORD DELETED
  763      PAFLG  EQU     IOWS+72          PA SET MODIFY RECOVERY FLAG(UPPER HALF)
  764      BUFRQ  EQU     IOWS+72         NUMBER OF BUFFERS REQUESTED
  765      TCTRS  EQU     IOWS+73         RESULT FROM TCT INSTR ON ENCODE/DECODE
  766      SCDES  EQU     IOWS+74         SOURCE DESCRIPTOR FOR MODIFY CI
  767      DSDES  EQU     IOWS+75         DESTINATION DESCRIPTOR FOR MODIFY CI
  768      PGHD   EQU     IOWS+76         TEMP FOR 3-WORD PAGE HDR
  769      WLOA   EQU     IOWS+79         WORD IN LINE OFFSET ARRAY
  770      VFDSR  EQU     IOWS+80         EIS DESC FOR VARYIABLE LENGTH FIELD
  771      LINPT  EQU     IOWS+81         LENGTH OF INPUT
  772      NEWSIZ EQU     IOWS+82         NEW SIZE OF VARYING LENGTH RECORD
  773      OLDSIZ EQU     IOWS+82         OLD SIZE OF VARYING LENGTH RECORD
  774      SIZCHG EQU     IOWS+83         SIZE CHANGE OF VARYING LENGTH RECORD
  775      VFLNG  EQU     IOWS+84         VARYING FIELD LENGTH
  776      VRSIZ  EQU     IOWS+84         CURRENT SIZE OF VARIABLE RECORD
  777      RCHD   EQU     IOWS+85         RECORD HEADER                            <EHW>
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              22   
  778      *
  779      *              PRIMITIVE WORK SPACE
  780      *
  781      NPIND  EQU     PWS+0           NEXT/PRIOR INDICATOR
  782      PTR    EQU     PWS+1           NEXT/PRIOR/OWNER POINTER
  783      RSZTP  EQU     PWS+2           RECORD SIZE/TYPE
  784      BEF    EQU     PWS+3           DBK OF BEFORE REC - INSERT
  785      NEW    EQU     PWS+4           DBK OF NEW    REC - INSERT
  786      AFT    EQU     PWS+5           DBK OF AFTER  REC - INSERT
  787      SZREQ  EQU     SPND                size requested is size needed.
  788      *                              error code overide value in CP-6.
  789      *
  790      DBKRQ  EQU     DBKR+1          DBK for FIND SPACE is DBK requested.
  791      TFLD   EQU     PWS+8           TEMP FIELD DESCR.
  792      SKTYP  EQU     PWS+9           RC PTR FOR SORTED SET
  793      PGSPLT EQU     PWS+9           PTR GROUP SPLIT INDICATOR
  794      *                                (NONZERO = PTR GROUP SPLIT OCCURRED)
  795      PCD    EQU     PWS+10          CURRENT CD PTR    - MOVE/COMP. KEYS
  796      PCD2   EQU     PWS+10          CD PTR(2ND OPER.) - COMP. FIELDS
  797      SKIND  EQU     PWS+11          SORT KEY INDICATOR
  798      PRSTS  EQU     PWS+12          I/O STATUS        - FIND SPACE
  799      SKFLG  EQU     PWS+13          LAST COMPARE FLAG
  800      CHDBK  EQU     PWS+14          DBK OF CALC HDR REC
  801      IPC    EQU     PWS+15          INSERT POINT IN CALC SET
  802      IPCF   EQU     PWS+16          INSERT POINT FOUND INDICATOR
  803      DBKSR  EQU     PWS+17          DBK OF STARTING RECORD
  804      BN1    EQU     PWS+18          NO. FROM TEMP BUF - COMPARE FIELDS
  805      BN2    EQU     PWS+20          NO. FROM PAGE BUF - COMPARE FIELDS
  806      VFLD   EQU     PWS+22          EIS DESC FOR VARYING LENGTH FIELD
  807      TFLD2  EQU     PWS+23          TEMP EIS DESC
  808      RNGTAL EQU     PWS+24          RANGE TABLE TALLY - FIND SPACE
  809      RNG1   EQU     PWS+26          RANGE 1  LO & HI  - FIND SPACE
  810      RNG2   EQU     PWS+28          RANGE 2  LO & HI  - FIND SPACE
  811      KEYDS  EQU     PWS+30          DESC FOR KEY IN KEY PROCESS AREA
  812      UCADR  EQU     PWS+31          USER COMPARE ADDRESS
  813      CFLPT1 EQU     PWS+32          2 WORDS FOR 1ST ARG IN FLOAT. PT. COMPARE
  814      CFLPT2 EQU     PWS+34          2 WORDS FOR 2ND ARG IN FLOAT. PT. COMPARE
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              23   
  815      USTAT  EQU     PWS+36          UFAS STATUS CODE ON ALTERNATE RETURN
  816      PCMIN  EQU     PWS+37          PARTIAL COMPARE INDICATOR
  817      TMPPA  EQU     PWS+38          TEMP STORAGE FOR PA ROUTINES
  818      XPRS   EQU     PWS+38          RS PTR FOR INDEX UPDATE PRIMITIVES
  819      KCREG  EQU     PWS+40          REGISTER SAVE AREA FOR KEY COMP. RTN
  820      ENTNO  EQU     PWS+48          ENTRY NO. OF A PA MEMBER REC
  821      PTRNO  EQU     PWS+48          PTR NO. OF A PA MEMBER IN A PTR GRP
  822      NOPTRS EQU     PWS+49          NO. OF PTRS IN CURR PTR GRP
  823      ENTTYP EQU     PWS+49          TYPE CODE FROM CURR PA ENTRY
  824      ENTPTR EQU     PWS+50          PTR FROM CURR PA ENTRY
  825      NXPRI  EQU     PWS+51          NEXT/PRIOR INDIC. FOR PA (NEG=PRIOR,POS=NEXT)
  826      EFIND  EQU     PWS+51          ENTRY FOUND INDIC (0 = ENTRY NOT FOUND)
  827      PARCW  EQU     PWS+52          PA RECORD CONTROL WORD
  828      ULIM   EQU     PWS+53          UPPER LIMIT-USED IN BINARY SEARCH
  829      LOLIM  EQU     PWS+53          LOWER LIMIT-USED IN BINARY SEARCH
  830      CENTRY EQU     PWS+54          CURRENT PA ENTRY
  831      ENIND  EQU     PWS+54          ENTRY TYPE INDICATOR
  832      ENTSZ  EQU     PWS+55          PA ENTRY SIZE
  833      PTESZ  EQU     PWS+56          SIZE OF ENTRY IN PA PTR GRP
  834      UPACW  EQU     PWS+57          PA CONTROL WORD-UPDATE PRIMS
  835      CENTRN EQU     PWS+58          CURRENT PA ENTRY NO.
  836      CENTRO EQU     PWS+58          CURRENT PA ENTRY OFFSET
  837      CPTRN  EQU     PWS+59          CURRENT PA PTR NO.
  838      CPTRO  EQU     PWS+59          CURRENT PA PTR OFFSET
  839      PTRESZ EQU     PWS+60          SIZE OF ENTRY IN PA PTR GRP-UPDATE
  840      PASPLT EQU     PWS+60          PA REC SPLIT INDICATOR(1 = PA SPLIT)
  841      ESZ    EQU     PWS+61          SIZE OF PA ENTRY
  842      NUMENT EQU     PWS+62          NO. OF ENTRIES IN PA REC
  843      PARVPA EQU     PWS+62          PA IN PA REC VAR INDIC.(1 = NOT IN PA RV)
  844      NUMPTR EQU     PWS+63          NO. OF PTRS IN PA PTR GRP
  845      MEMTYP EQU     PWS+63          MEMBER TYPE AND PTR INDICATOR
  846      MEMPTR EQU     PWS+64          CURR PA MEM PTR OR OFST TO PTR GRP
  847      PAOPTR EQU     PWS+65          OWNER OF PA SET
  848      DEPCW  EQU     PWS+66          PA CONTROL WORD-DELETE PA RTNS
  849      PADBK  EQU     PWS+67          PA DBK
  850      PAEOF  EQU     PWS+68          PA ENTRY OFFSET
  851      PAPOF  EQU     PWS+68          PA PTR OFFSET
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              24   
  852      SNPAE  EQU     PWS+69          SPACE NEEDED FOR NEW PA ENTRY
  853      DUSEPA EQU     PWS+69          DONT USE PA SET INDICATOR
  854      RCW1   EQU     PWS+70          RECORD CONTROL WORD FOR PA REC
  855      RCW2   EQU     PWS+71          PA CONTROL WORD FOR PA REC
  856      FETM   EQU     PWS+72          1ST ENTRY NO. TO BE MOVED(SPLIT PA)
  857      PADUP  EQU     PWS+72          PA DUPLICATE INDICATOR (0 = NONDUP,
  858      *                                NEG = DUP OF PRIOR, POS = DUP OF NEXT)
  859      OPARCW EQU     PWS+73          PA CONTROL WORD OF OLD PA(SPLIT PA)
  860      NPARCW EQU     PWS+74          PA CONTROL WORD OF NEW PA(SPLIT PA)
  861      SOE    EQU     PWS+75          SIZE OF ENTRY(SPLIT PA)
  862      SPCAVN EQU     PWS+76          SPACE AVAIL IN NEW PA (SPLIT PA)
  863      SPCAVO EQU     PWS+76          SPACE AVAIL IN OLD PA (SPLIT PA)
  864      PAEN   EQU     PWS+77          PA ENTRY NO.-DELETE PA RTNS
  865      PAEO   EQU     PWS+77          PA ENTRY OFST-DELETE PA RTNS
  866      PGSIZE EQU     PWS+78          SIZE OF PTR GROUP TO BE DELETED
  867      PAESZ  EQU     PWS+79          SIZE OF PA ENTRY (USED IN DELETE PTR GRP)
  868      *
  869      *              PRIMITIVE CALL BLOCK
  870      *
  871      RVI    EQU     PCB+0           REC VAR  INPUT PTR
  872      RVO    EQU     PCB+1           REC VAR  OUTPUT PTR
  873      RVT    EQU     PCB+2           REC VAR  TEMP  PTR
  874      RVPA   EQU     PCB+3           REC VAR POINTER ARRAY PTR
  875      PRSS   EQU     PCB+6           SS REQUEST - MOVE/COMPARE MATCH KEYS
  876      CIND   EQU     PCB+6           INDIC. REG AFTER COMPARE
  877      PRRC   EQU     PCB+7           RECORD CLASS REQUEST
  878      PRRS     EQU  PCB+7     RS PARAMETER
  879      PRSC   EQU     PCB+8           SET CLASS REQUEST
  880      .PRCSE EQU     PCB+8           BIT 18: 1 = CURR IS PRIOR
  881      PRFR   EQU     PCB+9           FIELD REQUEST - MOVE COMPARE FIELD
  882      PRFR2  EQU     PCB+9           FR PTR(2ND OPER.) - COMP. FIELDS
  883      PREXC  EQU     PCB+10          EXCEPTION CODE ON NORMAL RETURN FROM
  884      *                                UFAS LOGICAL I/O INDEX ROUTINES
  885      KCARG0 EQU     PCB+11          AR0 SAVE AREA FOR KEY COMP RTN
  886      KCARG3 EQU     PCB+12          AR3 SAVE FOR KEY COMP RTN
  887      KCARG4 EQU     PCB+13          AR4 SAVE FOR KEY COMPRTN
  888      PROPA  EQU     PCB+14          DBK OF OWNER OF PA SET
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              25   
  889      RV1    EQU     PCB+16          RECORD VARIABLE  NO. 1
  890      RV2    EQU     PCB+32          RECORD VARIABLE NO. 2
  891      RV3    EQU     PCB+48          RECORD VARIABLE NO. 3
  892      RV4    EQU     PCB+64          RECORD VARIABLE NO. 4
  893      *
  894      *              IC STORAGE STACK
  895      *
  896      *              STACK FOR FIND
  897      *
  898      *              STACK FOR ERASE
  899      *
  900      *              SUBROUTINE WORK SPACE
  901      *
  902      ARGS   EQU     SWS+0           ADDRESS OF ARGS FROM CALL   - ALL
  903      SSSPTR EQU     ARGS          used in by ZIG$DBCKP for saving actual SSS$
  904      FMSBF  EQU     SWS+0           ADDR OF FMS BUF FOR TSS
  905      TSI    EQU     SWS+1           TIME-SHARING INDICATOR     - ALL
  906      RVTAL  EQU     SWS+2           REFERENCE VECTOR TALLY      - READY
  907      SCLST  EQU     SWS+4           SC LIST CONTROL WORD        - STOR&FIND
  908      NCH      EQU      SWS+5                Temp for Number of calc headers
  909      CLNG   EQU     SWS+6           LENGTH OF CALC KEY         - CALC
  910      EEIND  EQU     SWS+6           ERASE-ESTABLISH CURRENCY IND.-UPDT CURR
  911      HASH   EQU     SWS+7           HASH                        - CALC
  912      CDES   EQU     SWS+8           ALPHA DESCR FOR A CALC KEY - CALC
  913      CCHAR  EQU     SWS+9           CURR CHAR OF CALC KEY      - CALC
  914      DDBK   EQU     SWS+10          DIRECT DATA BASE KEY        - STORE
  915      SSZTP  EQU     SWS+11          SIZE & TYPE                 - STORE
  916      BSPG   EQU     SWS+12          BASE PAGE (DBK OF BASE LOC) - STORE
  917      CURRS  EQU     SWS+13          CURRENT RS                  - STORE
  918      DELRS  EQU     SWS+14          CURRENT RS                  - ERASE
  919      UCRS   EQU     SWS+14          CURRENT RS PTR  - UPDATE CURRENCIES
  920      CURSS  EQU     SWS+15          CURRENT SS                  - FIND ASS.
  921      RSREQ  EQU     SWS+15          RS REQUESTED                - FIND ASS.
  922      CDBK   EQU     SWS+16          CURRENT DBK                 - FIND ASS.
  923      ROCUR  EQU     SWS+17          REC OCCURRENCE NO.          - FIND A/R
  924      MODFR  EQU     SWS+18          FR LIST PTR                 - MODIFY
  925      MODSC  EQU     SWS+19          SC LIST PTR                 - MODIFY
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              26   
  926      MODRS  EQU     SWS+20          CURRENT RS                  - MODIFY
  927      MODIN  EQU     SWS+20          INCLUDING SET  INDICATOR   - MODIFY
  928      MODCD  EQU     SWS+21          CURRENT CD PTR              - MODIFY
  929      CONCD  EQU     SWS+21          CURRENT CD                 - CONNECT
  930      FLDTL  EQU     SWS+22          TALLY & IND WORD FOR FR LIST- GET FIELDS
  931      FCSS   EQU     SWS+23          SS PTR FOR CALC KEYS        - FIND CALC
  932      MRBKI  EQU     SWS+23          NEW ENTRY HAS BEEN INSERTED INDIC - MODIFY BO
  933      CACD   EQU     SWS+24          CURRENT CD PTR              - CALC
  934      CAAC   EQU     SWS+24          CURRENT AC OR ZERO         - CALC
  935      FCNT   EQU     SWS+25          NO. ENTRIES LEFT IN LIST    - MV/CMP FLD
  936      CMPL   EQU     SWS+26          CURRENT ENTRY IN LIST       - MV/CMP FLD
  937      DPSLW  EQU     SWS+27          NO. LINES TO SLEW          - ERROR ROUTINE
  938      FKIND  EQU     SWS+28          FIND W/I CURRENT INDICATOR - FIND ASS.
  939      STMASK EQU     SWS+29          SIZE & TYPE MASK            - ALL
  940      TMASK  EQU     SWS+30          TYPE MASK                   - ALL
  941      CTMASK EQU     SWS+31          COMPLIMENT OF TYPE MASK     - ALL
  942      ITRS   EQU     SWS+32          CURRENT RS PTR              - IF TESTS
  943      FTIND  EQU     SWS+32          FIRST TIME INDICATOR (.DBHIA)
  944      ITPTR  EQU     SWS+33          NXT PTR FROM CURR REC       - IF TESTS
  945      SUST   EQU     SWS+34          SUBROUTINE STATUS           - ALL
  946      EXCCD  EQU     SWS+36          EXCEPTION CODE              - ALL
  947      RECFR    EQU      SWS+37               Recovery value for FR
  948      RECAC    EQU      SWS+38               Recovery value for AC
  949      RECSC    EQU      SWS+39               Recovery value for SC
  950      RECRC    EQU      SWS+40               Recovery value for RC
  951      CSUB   EQU     SWS+41          PTR TO CURR SUBR. CNTRS     - ALL
  952      RNGO   EQU     SWS+42          LENGTH OF RANGE OF OWNER    - STORE
  953      RNGD   EQU     SWS+43          DISPL. OF OWNER W/I RANGE   - STORE
  954      ODBK   EQU     SWS+44          DBK TO RELINK TO            - MODIFY
  955      RDYCW  EQU     SWS+45          READY CONTROL WORD          - READY
  956      RDCNT  EQU     SWS+46          NEG. OF NO. OF AC'S         - READY
  957      RDAC   EQU     SWS+47          CURR AC OR IND. PTR         - READY
  958      ARGS2  EQU     SWS+47          ADDRESS OF ARGS FROM CALL(.DBEUP-FORTRAN)
  959      PKAW   EQU     SWS+48          RC, FR FOR AREA-ID         - FIND AREA
  960      FRAC   EQU     SWS+49          CURR AC FOR PRINTING STATS - FINISH
  961      OPADP  EQU     SWS+49          OLD PA KEY DUPLICATE INDIC.
  962      FICNT  EQU     SWS+50          NEG. OF NO. OF AC'S IN LIST - FINISH
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              27   
  963      FIAC   EQU     SWS+51          CURR AC OR PTR TO CURR RV E.- FINISH
  964      UPPAI  EQU     SWS+51          UPDATE PA OFSTS INDIC. (.DBUPC)
  965      STBIN  EQU     SWS+52          BINARY NO. FOR STATS       - FINISH
  966      STDEC  EQU     SWS+53          DECIMAL NO. FOR STATS      - FINISH
  967      SNIND  EQU     SWS+55          AREA-ID NAME INDICATOR     - FIND AREA
  968      CDP    EQU     SWS+56          CURRENT DP PTR             - PROC. INTER
  969      RSPAM  EQU     SWS+56          CURR RS PTR FOR PA MEMBER
  970      CAG    EQU     SWS+57          CURR AG                    - CALL DB PROC
  971      CRA    EQU     SWS+58              CURR RA                - FIND CHR
  972      TEMP   EQU     SWS+59          TEMPORARY STORAGE
  973      INAFLAG EQU    TEMP            used during RDY & INA functions
  974      CSTS   EQU     SWS+61          CURR STATS OFST            - FINISH
  975      *
  976      DBKSI  EQU     SWS+140         DBK OF CURR SI REC
  977      REMLT  EQU     SWS+141         REMAINING LOCK BITS IN LT & BIND. VALUE
  978      CURLT  EQU     SWS+142         CURRENT   LOCK BITS & BIND. VALUE
  979      CLI    EQU     SWS+143         CURR LOCK IND.
  980      CWSOF  EQU     SWS+143         CURR WORK SPACE OFST
  981      CURLN  EQU     SWS+144         CURRENT PRIVACY KEY
  982      VFDSC  EQU     SWS+147         EIS DESC FOR VARYING LENGTH FIELD
  983      FLDDSC EQU     SWS+148         EIS DESC DEFINING DESC FOR VARYING LENGTH FIELD
  984      GACDK  EQU     SWS+150         DBK TO FIND AC FOR
  985      PCEXI  EQU     SWS+151         PARTIAL COMPARE INDICATOR
  986      FNIND  EQU     SWS+152         FIRST/NEXT IN KEY INDICATOR
  987      RETFR  EQU     SWS+153         FR PTR FOR SPECIAL REGS
  988      OWNPTR EQU     SWS+154         DBK OF OWNER OF PA SET (BACKOUT)
  989      *
  990      *              CONTROL SECTION EQUIVALENCES
  991      *
  992      *          AWSO CSECT+0 OFFSET & NO. OF AWS'S
  993      *          RWSO CSECT+1    "     "   "  RWS'S
  994      *          SWSO CSECT+2    "     "   "  SWS'S
  995      ATBL   EQU     CSECT+3         ADDR OF OPEN AREA TABLE
  996      TBUF   EQU     CSECT+4         ADDR OF TEMP REC BUF
  997      KEYPA  EQU     CSECT+8         ADDR OF KEY PROCESS AREA
  998      IXBUF$   EQU      CSECT+9              Indexed buffer
  999      *          FACOF CSECT+11 FACT OFFSET
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              28   
 1000      *          FWSOF CSECT+11 FACT WORK SPACE OFFSET
 1001      CBFSZ  EQU     CSECT+12        SIZE OF DBCB + FACT
 1002      CIWSOF   EQU      CSECT+12             Current of run for index area
 1003      CFSA   EQU     CSECT+13        OPTIONS                                  <EHW>
 1004      PABUF  EQU     CSECT+14        ADDRESS OF PA BUFFER
 1005      .PCKD  BOOL    400000          1 = PRIVACY HAS BEEN CHECKED
 1006      .APDN  BOOL    200000          1 = ABORT PRINT COMPLETE
 1007      .DPS   BOOL    100000          1= DON'T PRINT STATS
 1008      .SFNP  BOOL    040000          1 = SCHEMA FILE NOT PRESENT
 1009      .DELM  BOOL    020000          1 = PERFORM LOGICAL DELETES
 1010      .BRK   BOOL    010000          1 = BREAK OCCURRED
 1011      .ETC   BOOL    004000          1 = 'ETCETERA' mode is in effect.
 1012      *
 1013      *              OPEN AREA TABLE EQUIVALENCES
 1014      *
 1015      DBKL   EQU     0               DBK LIMITS OF THE AREA
 1016      ACP    EQU     2               AC PTR
 1017      FCP    EQU     2               FACT PTR
 1018      TPAI   EQU     3               2 PART INDICATOR
 1019      *
 1020      *              AREA, SET, RECORD WORK SPACE EQUIVALENCES
 1021      *
 1022      PRIV   EQU     0               PRIVACIES
 1023      WSBID  EQU     0               BURID FOR CURRENT
 1024      .CAE   EQU     0               1 = CURRENT OF AREA WAS ERASED (BIT 0)
 1025      .CSE   EQU     0               1 = CURRENT OF SET WAS ERASED (BIT 0)
 1026      NSTS   BOOL    000001          1 = STATISTICS NEED TO BE PRINTED
 1027      PG     BOOL    000400          GET                        -REC  PRIVACY
 1028      PM     BOOL    000200          MODIFY                     -REC  PRIVACY
 1029      PS     BOOL    000100          STORE                      -REC  PRIVACY
 1030      PE     BOOL    000040          ERASE                      -REC  PRIVACY
 1031      PC     BOOL    000020          CONNECT                    -REC  PRIVACY
 1032      PD     BOOL    000010          DISCONNECT                 -REC  PRIVACY
 1033      PF     BOOL    000004          FIND                       -REC  PRIVACY
 1034      PSO    BOOL    000400          ORDER                      -SET PRIVACY
 1035      PSD    BOOL    000010          DISCONNECT                 -SET PRIVACY
 1036      PSC    BOOL    000020          CONNECT                    -SET PRIVACY
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              29   
 1037      PSF    BOOL    000004          FIND                       -SET PRIVACY
 1038      PFG    BOOL    000400          GET                        -FLD  PRIVACY
 1039      PFM    BOOL    000200          MODIFY                     -FLD  PRIVACY
 1040      PFS    BOOL    000100          STORE                      -FLD  PRIVACY
 1041      ATRIB    EQU      0
 1042      * High order bits same as in AC flags
 1043      .CAC     BOOL     000001               Concurrent access control
 1044      .LOAD    BOOL     000002               Load mode
 1045      .KEYED   BOOL     000004               Area has alternate keys
 1046      .INDEXED BOOL     000010               Area is Indexed
 1047      .CANSSS  BOOL     000200               Canned Schema SubSet
 1048      .ENQ     BOOL     000400               Enq outstanding on area
 1049      CURR   EQU     1               OFST IN WORK SPACE OF CURR DBK
 1050      NCHA     EQU      2                    # of clal headers in area
 1051      HIGHDBK  EQU      3                    High DBK of area
 1052      HIGHPG   EQU      4                    High page no in area
 1053      FIPN     EQU      5                    First invertory page no.
 1054      DDCB     EQU   6           CP-6 DCB# for data area
 1055      KDCB     EQU   6                         alternate key file
 1056      ENCRP    EQU   7           Encription seed
 1057      AWSZ   EQU     8               SIZE OF AREA WORK SPACE
 1058      RWSZ   EQU     2               SIZE OF REC  WORK SPACE
 1059      SWSZ   EQU     2               SIZE OF SET  WORK SPACE
 1060      PAWSZ  EQU     4               SIZE OF PA WORKSPACE
 1061      KWSZ   EQU     6               SIZE OF KEY WORK SPACE
 1062      *                 For key currencies only
 1063      SWSAC    EQU      0                    AC of associated area
 1064      *              FOR PA SET WORKSPACE ONLY
 1065      CBENO  EQU     2               PA ENTRY OFST OF CURR
 1066      CBCPO  EQU     2               PA PTR OFST OF CURR
 1067      CBCPA  EQU     3               DBK OF PA OWNER REC OF CURR
 1068      *                 Currencies for indexed area (TEXTC)
 1069      CIRUN    EQU      0                    Offset for current of run
 1070      CIAWS    EQU      10                   Offset for current of area
 1071      CIRWS    EQU      2                    Offset for current of record
 1072      CISWS    EQU      2                    Offset for current of set
 1073      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              30   
 1074      *              BUFFER MANAGER PARAMETER BLOCK EQUIVALENCES
 1075      *
 1076      .UPDT  BOOL    400000          UPDATE CI FLAG
 1077      .LCK   BOOL    010000          LOCK CI FLAG
 1078      .ULCK  BOOL    004000          UNLOCK CI FLAG
 1079      .CFLC  BOOL    040000          CONFLICT ON CI FLAG
 1080      *
 1081      *              MODIFY FIELD LIST EQUIVALENCES
 1082      *
 1083      .LEIL  BOOL    400000          LAST ENTRY IN LIST FLAG
 1084      .NBI   BOOL    200000          NO BEFORE IMAGE
 1085      .NAI   BOOL    100000          NO AFTER IMAGE
 1086      .NMV   BOOL    040000          NO MOVE
 1087      .BTB   BOOL    020000          BUFFER TO BUFFER MOVE
 1088      .MRL   BOOL    010000          MOVE RIGHT TO LEFT
 1089      ***********************************************************
 1090      *  RECORD VARIABLE EQUIVALENCES
 1091      ***********************************************************
 1092      DBKEY  EQU     0               DATA BASE KEY
 1093      BADDR  EQU     1               BUFFER ADDRESS
 1094      RADDR  EQU     2               RECORD ADDRESS
 1095      RECSZ  EQU     3               RECORD SIZE
 1096      RTP    EQU     3               RECORD TYPE
 1097      SCPTR  EQU     4               SC DEF. PTR
 1098      RSPTR  EQU     4               RS DEF. PTR
 1099      ACPTR  EQU     5               AC DEF. PTR
 1100      RAPTR  EQU     5               RA DEF. PTR
 1101      RCPTR  EQU     6               RC DEF. PTR
 1102      BURRID EQU     6               BUFFER USER RELATIONSHIP ID (BURID)
 1103      BLKD   EQU     7               BUF LOCK INDICATOR
 1104      RADIX  EQU     8               ADDRESS OF INDEX - 3 WORDS
 1105      AWS$     EQU      11          Area work space pointer
 1106             ENDM    CBSYM
 1107             EJECT
 1108      *
 1109      ************************************************************************
 1110      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              31   
 1111      *  DBCAL
 1112      *
 1113      *      This macro is used to call an internal subroutine
 1114      *      or primitive.
 1115      *
 1116      *  Invocation
 1117      *
 1118      *        DBCAL    subroutine,exception,altret
 1119      *
 1120      *  Definition of Parameters
 1121      *
 1122      *      SUBROUTINE is the subroutine to call
 1123      *      EXCEPTION  is the address for exceptional condition return
 1124      *                 (if this address is specified the old error is
 1125      *                 cleared.  Thus taking control of exceptional
 1126      *                 conditions implies the invoker does not think
 1127      *                 this is a true error or will load a new error
 1128      *                 code before exiting.)
 1129      *                 (if this address is not specified and the routine
 1130      *                 being called does an exceptional return the
 1131      *                 altret label is used.)
 1132      *      ALTRET     is the error return address
 1133      *
 1134      *     CASE 1. IF NOEXC SPECIFIED AS EXCEPTION,
 1135      *             A TYPICAL PL6 CALL IS GENERATED
 1136      *             TSX1  SUBROUTINE
 1137      *             DRL 0 ( IF KEYWORD NOALT USED AS ALTRET)
 1138      *             TSX2  ALTRET (IF KEYWORD IS NOT NOALT)
 1139      *     CASE 2. IF NOALT USED AND NO EXCEPTION SPCEIFIED,
 1140      *             THEN IT IS THE SAME AS   DBCAL SUBR,NOEXC,NOALT
 1141      *     CASE 3. AS DESCRIBED AS ABOVE
 1142      ***********************************************************************
 1143      *
 1144      DBCAL    MACRO    SUBROUTINE,EXCEPTION,ALTRET
 1145               TSX      X1,#1
 1146                IFE      '#3','NOALT',2   IF NOALT SPECIFIED, DO 2
 1147                DRL      0
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              32   
 1148                INE      '#2','',%EXC   AND NO EXC THEN ALL DONE
 1149               IFE      '#3',''
 1150               ALTRET MUST BE PRESENT
 1151               INE      '#3','NOALT'
 1152               TSX2     #3
 1153                INE      '#2','NOEXC',%EXC  IF NOEXC SPCIFIED THEN DONE
 1154               SZN      GERROR,,PR5
 1155               IFE      '#2',''
 1156               TNZ      -2,IC
 1157               INE      '#2','',%EXC
 1158               TZE      3,IC
 1159               STZ      GERROR,,PR5
 1160               TSX2     #2
 1161      EXC      MARK
 1162               ENDM     DBCAL
 1163               EJECT
 1164      ***********************************************************************
 1165      *
 1166      *  DBSAV
 1167      *
 1168      *      This macro saves the return address, and allocates
 1169      *      auto for the routine.
 1170      *
 1171      ***********************************************************************
 1172      *
 1173      DBSAV  MACRO
 1174               TSX0     X66_AUTO_0
 1175               ZERO     2+2,0
 1176             ENDM    DBSAV
 1177             EJECT
 1178      *
 1179      *
 1180      *  DBRET
 1181      *
 1182      *
 1183      ************************************************************************
 1184      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              33   
 1185      DBRET  MACRO
 1186               TSX2     X66_ARET
 1187             ENDM    DBRET
 1188             EJECT
 1189      ************************************************************************
 1190      *
 1191      *  DBEXC
 1192      *
 1193      *      This macro invokes the exception return sequence from
 1194      *      a routine that was called by the DBCAL macro.
 1195      *
 1196      ************************************************************************
 1197      *
 1198      DBEXC  MACRO
 1199             ENTREF  ZIB$DBEXC
 1200               TSX2     ZIB$DBEXC
 1201             ENDM    DBEXC
 1202             EJECT
 1203      *
 1204      ************************************************************************
 1205      *
 1206      *  DBALT
 1207      *
 1208      *      This macro invokes an alternate return sequence
 1209      *           (If 'RECOVER' is specified control is returned in line
 1210      *            so that the routine can back out of pending operations)
 1211      *        from a routine that was called by the DBCAL macro.
 1212      *
 1213      ************************************************************************
 1214      *
 1215      DBALT    MACRO
 1216               IFE      '#1','RECOVER',%RECOVER
 1217               ENTREF   ZIB$DBALTR
 1218               TSX2     ZIB$DBALTR
 1219      RECOVER  MARK
 1220               INE      '#1','RECOVER',%NOREC
 1221               ENTREF   ZIB$DBALT
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              34   
 1222               TSX2     ZIB$DBALT
 1223      NOREC    MARK
 1224               ENDM     DBALT
 1225               EJECT
 1226      **********************************************************************
 1227      *  DBALTO
 1228      *
 1229      *        This macro generates the calling sequence to restore
 1230      *        the origional error code and associated values after
 1231      *        a successful backout has been performed.
 1232      *
 1233      **********************************************************************
 1234      DBALTO   MACRO
 1235               ENTREF   ZIB$DBALTO
 1236               TSX2     ZIB$DBALTO
 1237               ENDM     DBALTO
 1238               EJECT
 1239      *
 1240      ********************************************************************
 1241      *
 1242      *  DBREC
 1243      *
 1244      *        This macro generates code to process errors
 1245      *        detected during error recovery
 1246      *
 1247      *******************************************************************
 1248      *
 1249      DBREC    MACRO
 1250               ENTREF   ZIB$DBALT
 1251               ALS      18
 1252               ORSA     SUST,,PR7
 1253               LDA      #1,DL
 1254               TSX2     ZIB$DBALT
 1255               ENDM     DBREC
 1256               EJECT
 1257      *
 1258      *  SUBROUTINE LINKAGE MACROS WHICH ONLY DESTROY X1.
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              35   
 1259      *
 1260      *  THESE MACROS ASSUME:
 1261      *       PR7 - POINTS TO THE USER WORK SPACE ( DBCB ).
 1262      *
 1263      ***********************************************************
 1264      *  ICCAL
 1265      *        SEE DBCAL
 1266      ***********************************************************
 1267      ICCAL  MACRO
 1268               DBCAL    #1,#2,#3
 1269             ENDM    ICCAL
 1270      *
 1271      ***********************************************************
 1272      *  ICSAV
 1273      *    THIS MACRO SAVES RETURN ADR FOR ROUTINE CALLED VIA ICCAL.
 1274      ***********************************************************
 1275      ICSAV  MACRO
 1276             STX     X1,.DBIC,ID,PR7 SAVE RETURN ADDR
 1277             ENDM    ICSAV
 1278      *
 1279      ***********************************************************
 1280      *  ICRET
 1281      *    THIS MACRO PERFORMS A NORMAL RETURN
 1282      ***********************************************************
 1283      ICRET  MACRO
 1284               LDX      X1,.DBIC,DI,PR7      GET RETURN ADDRESS
 1285               TRA      1,X1                 NORMAL RETURN
 1286             ENDM    ICRET
 1287      *
 1288      ***********************************************************
 1289      *  ICEXC
 1290      *    THIS MACRO PERFORMS AN EXCEPTION RETURN
 1291      ***********************************************************
 1292      ICEXC  MACRO
 1293             ENTREF  ZIB$ICEXC
 1294               TSX2     ZIB$ICEXC
 1295             ENDM    ICEXC
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              36   
 1296      *
 1297      ***********************************************************
 1298      *  ICALT
 1299      *        This macro performas an alternate return
 1300      ***********************************************************
 1301      ICALT    MACRO
 1302               ENTREF   ZIB$ICALT
 1303               TSX2     ZIB$ICALT
 1304               ENDM     ICALT
 1305             EJECT
 1306      *
 1307      *  PUSH & POP SS ENTRY MACROS
 1308      *
 1309      ***********************************************************
 1310      *  PSHSS - PUSH AN SS ENTRY - X4 CONTAINS SS TO PUSH
 1311      *    ARG-1 ERROR RETURN - STACK FULL
 1312      ***********************************************************
 1313      PSHSS  MACRO
 1314             STX     X4,.DBSTK,ID,PR7  PUT X4 IN STACK
 1315             TTN     #1              STACK FULL
 1316             ENDM    PSHSS
 1317             EJECT
 1318      *
 1319      ***********************************************************
 1320      *  POPSS - POP AN SS ENTRY - X4 CONTAINS ENTRY POPPED
 1321      *    ARG-1 NO ENTRIES - STACK EMPTY
 1322      ***********************************************************
 1323      POPSS  MACRO
 1324             EAX     X1,.DBSTK+2,,PR7  GET ADDR OF 1ST ENTRY
 1325             CMPX    X1,.DBSTK,,PR7  IS IT CURRENT
 1326             TZE     #1
 1327             LDX     X4,.DBSTK,DI,PR7  GET TOP ENTRY
 1328             ENDM    POPSS
 1329             EJECT
 1330      *
 1331      *  PUSH & POP RS ENTRY & DBK
 1332      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              37   
 1333      ***********************************************************
 1334      *  PSHRS - PUSH RS ENTRY & DBK
 1335      *    X5 CONTAINS RS TO PUSH
 1336      *    QR CONTAINS DBK TO PUSH
 1337      *
 1338      *    ARG-1 = ERROR RETURN - STACK FULL
 1339      ***********************************************************
 1340      PSHRS  MACRO
 1341             EAA     ,X5             PUT X5 IN A UPPER
 1342             STAQ    .DBEST,AD,PR7   PUT A & Q IN STACK
 1343             TTN     #1              STACK F%LL
 1344             ENDM    PSHRS
 1345             EJECT
 1346      *
 1347      ***********************************************************
 1348      *  POPRS - POP RS ENTRY & DBK
 1349      *    ARG-1 = STACK EMPTY
 1350      *
 1351      *    NORMAL RETURN:
 1352      *      X5 = RS ENTRY POPPED
 1353      *      QR = DBK      POPPED
 1354      ***********************************************************
 1355      POPRS  MACRO
 1356             EAX     X1,.DBEST+2,,PR7  GET ADDR OF 1ST ENTRY
 1357             CMPX    X1,.DBEST,,PR7  IS IT CURRENT
 1358             TZE     #1              YES T  STACK EMPTY
 1359             LDAQ    .DBEST,SD,PR7   GET PRIOR ENTRY
 1360             EAX     X5,,AU          GET RS PTR
 1361             ENDM    POPRS
 1362             EJECT
 1363      *
 1364      *  PUSH & POP DISCONNECT POINT
 1365      *  USED TO BACK OUT OF MODIFY
 1366      *
 1367      ***********************************************************
 1368      *  PSHDP - PUSH SC & DBK
 1369      *    X6 = SC TO PUSH
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              38   
 1370      *    QR = DBK TO PUSH
 1371      *
 1372      *    ARG-1 = ERROR RETURN - STACK FULL
 1373      ***********************************************************
 1374      PSHDP  MACRO
 1375             EAA     ,X6             PUT X6 IN AU
 1376             STAQ    .DBEST,AD,PR7   PUT A & Q IN STACK
 1377             TTN     #1              STACK FULL
 1378             ENDM    PSHDP
 1379             EJECT
 1380      ***********************************************************
 1381      *  POPDP - POP SC & DBK ENTRY
 1382      *    ARG-1  = STACK EMPTY RETURN
 1383      *
 1384      *    NORMAL RETURN:
 1385      *      X6 = SC FROM STACK
 1386      *      QR = DBK FROM STACK
 1387      ***********************************************************
 1388      POPDP  MACRO
 1389             EAX     X1,.DBEST+2,,PR7  GET ADDR OF 1ST ENTRY
 1390             CMPX    X1,.DBEST,,PR7  IS IT CURRENT
 1391             TZE     #1              YES - EMPTY
 1392             LDAQ    .DBEST,SD,PR7   GET PRIOR ENTRY
 1393             EAX     X6,,AU          GET SC
 1394             ENDM    POPDP
 1395             EJECT
 1396      *
 1397      *  DBTCE - TEST CHARACTERS ON ENCODE
 1398      *     THIS MACRO IS USED TO TEST CHARACTERS FOR NON-NUMERIC
 1399      *     DATA ON AN ASCII TO NUMERIC ENCODE.
 1400      *     IF ANY NON-NUMERIC CHARACTERS ARE ENCOUNTERED THEN THE
 1401      *     ERROR RETURN IS TAKEN.
 1402      *
 1403      *     ARGUMENTS:
 1404      *       ARG-1 - ERROR RETURN
 1405      *
 1406      DBTCE  MACRO
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              39   
 1407             TCT     (1,,1)          * TEST
 1408             ARG     UOFST,X4,PR6    *  CHARS IN UWA
 1409             ARG     TCTBL           *   FOR NON-NUMERIC DATA
 1410             ARG     TCTRS,,PR7
 1411             TTF     #1
 1412             ENDM    DBTCE
 1413             EJECT
 1414      *
 1415      *
 1416      *  DBTCD - TEST CHARACTERS ON DECODE
 1417      *     THIS MACRO IS USED TO TEST CHARACTERS FOR NON-NUMERIC
 1418      *     DATA ON AN ASCII TO NUMERIC DECODE.
 1419      *     IF ANY NON-NUMERIC CHARACTERS ARE ENCOUNTERED THEN THE
 1420      *     ERROR RETURN IS TAKEN.
 1421      *
 1422      *     ARGUMENTS:
 1423      *       ARG-1 - ERROR RETURN
 1424      *
 1425      DBTCD  MACRO
 1426             TCT     (1,,1)          * TEST
 1427             ARG     ROFST,X4,PR6    *  CHARS IN BUFFER
 1428             ARG     TCTBL           *   FOR NON-NUMERIC DATA
 1429             ARG     TCTRS,,PR7
 1430             TTF     #1              ERROR
 1431             ENDM    DBTCD
 1432             EJECT
 1433      ***********************************************************
 1434      *
 1435      *  OBJECT AREA DEFINITION MACRO
 1436      *
 1437      *  IS THE ROOT OF THE CONTROL STRUCTURE
 1438      *
 1439      *  LABEL FOR START OF SUBSET IS 'SSORG'
 1440      *
 1441      *  ARGUMENTS
 1442      *    ARG-1   FIRST AC DEF.
 1443      *    ARG-2   FIRST SC DEF.
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              40   
 1444      *    ARG-3   FIRST RC DEF.
 1445      *    ARG-4   ADDR OF CALC SET SC DEF
 1446      *    ARG-5   DBK SIZE IN BYTES
 1447      *
 1448      ***********************************************************
 1449      .DBOA  MACRO
 1450      DBKSZ  EQU     #5              NO. BYTES IN DBK
 1451      SSORG  NULL
 1452             ZERO    0               XX-DP NEXT
 1453      SFOA   NULL
 1454             VFD     O12/4000
 1455             ZERO    #1-SSORG,#2-SSORG   OA-SC NXT, OA-SC NXT
 1456             ZERO    #3-SSORG            OA-RC NXT
 1457             ZERO    #4-SSORG            CALC SC
 1458             OCT     0
 1459             OCT     0
 1460             OCT     0
 1461             OCT     0
 1462             OCT     0
 1463             OCT     0
 1464             OCT     0
 1465             OCT     0
 1466             OCT     0
 1467             OCT     0
 1468             OCT     0
 1469             OCT     0
 1470             OCT     0
 1471             OCT     0
 1472             OCT     0
 1473             OCT     0
 1474             OCT     0
 1475             ENDM    .DBOA
 1476             EJECT
 1477      ***********************************************************
 1478      *
 1479      *      AREA CLASS DEFINITION MACRO
 1480      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              41   
 1481      *  ARGUMENTS
 1482      *    ARG-1     LABEL FOR AC
 1483      *    ARG-2     OA-AC NEXT
 1484      *    ARG-3     AC-RC NEXT
 1485      *    ARG-4     DBK FOR BASE OF LOCAL PTRS
 1486      *    ARG-5     BITS/LINE NO.
 1487      *    ARG-6     HIGH PAGE NO.
 1488      *    ARG-7     LOW DBK
 1489      *    ARG-8     HIGH DBK
 1490      *    ARG-9     CALC INTERVAL
 1491      *    ARG-10    PAGE SIZE(BYTES)
 1492      *    ARG-11    AREA BITS
 1493      *    ARG-12    INVENTORY %
 1494      *    ARG-13    NO. CHARS IN AREA NAME
 1495      *    ARG-14    AREA NAME
 1496      *
 1497      ***********************************************************
 1498      .DBAC  MACRO
 1499      LPPAG  SET     131072/.B#5     LINES/PAGE
 1500             ODD
 1501             ZERO    0               XX-DP NEXT
 1502      #1     NULL
 1503             VFD     O12/2000,6/0,9/#12,3/0,6/#13
 1504             ZERO    #2-SSORG,#3-SSORG
 1505             DEC     #4              BASE DBK
 1506             ZERO    SFWS            WORK SPC OFST
 1507             ZERO    36-#5,#5        36-BITS/LINE NO.
 1508             ADSC9   #1-SSORG+ANAM,0,#13,0     NAME DESCR
 1509             DEC     1               LOW PAGE
 1510             DEC     #6              HIGH PAGE
 1511             DEC     #7              LOW  DBK
 1512             DEC     #8              HIGH DBK
 1513             ZERO    ,LPPAG          LINES/PAGE
 1514             ZERO    ,#9             CALC INTERVAL
 1515             ZERO    ,#10            PAGE SIZE
 1516               ZERO     2,#11                Template area
 1517             ZERO                    INDEX FILE CODE
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              42   
 1518             ZERO                    INVENT. THRESH.
 1519             ZERO    ,#10-12         DATA PGS/INV PG
 1520             DEC     0               INV. PG NO.
 1521      WC     SET     DBKSZ/4         WORD OFST OF CALC PRIOR
 1522      CC     SET     DBKSZ-4*WC      BYTE OFST OF CALC NEXT
 1523             ADSC9   1,0,DBKSZ,3         CALC NEXT
 1524             ADSC9   1+WC,CC,DBKSZ,3     CALC PRIOR
 1525             ZERO    .DIDS2,.DIDS2   UFAS PACKAGE
 1526             ZERO                    LINE ARRAY POSITION
 1527      CC     SET     #13+3
 1528      WC     SET     CC/4
 1529             UASCI   WC,#14
 1530             ENDM    .DBAC
 1531             EJECT
 1532      ***********************************************************
 1533      *
 1534      *  RECORD CLASS DEFINITION MACRO
 1535      *
 1536      *  ARGUMENTS
 1537      *    ARG-1     LABEL FOR RC
 1538      *    ARG-2     REC TYPE
 1539      *    ARG-3     REC SIZE (BYTES)
 1540      *    ARG-4     RC-RA NEXT
 1541      *    ARG-5     RC-RS NEXT
 1542      *    ARG-6     RC-FR NEXT
 1543      *    ARG-7     OA-RC NEXT
 1544      *    ARG-8     LOC MODE
 1545      *
 1546      ***********************************************************
 1547      .DBRC  MACRO
 1548             ZERO    0               XX-DP NEXT
 1549      #1     NULL
 1550             VFD     O12/1000,3/0,3/#8,18/0
 1551             ZERO    #4-SSORG,0          RC-RA NXT
 1552             ZERO    #7-SSORG,#5-SSORG   OA-RC NXT, RC-RS NXT
 1553             VFD     18/#3,O6/20,12/#2   REC SIZE/TYPE
 1554             ZERO    ,#6-SSORG           RC-FR NXT
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              43   
 1555             ENDM    .DBRC
 1556             EJECT
 1557      ***********************************************************
 1558      *
 1559      *  SET CLASS DEFINITION MACRO
 1560      *
 1561      *  ARGUMENTS
 1562      *    ARG-1     LABEL FOR SC
 1563      *    ARG-2     SC-RS NXT
 1564      *    ARG-3     OA-SC NXT
 1565      *    ARG-4     1= GLOBAL PTRS
 1566      *
 1567      ***********************************************************
 1568      .DBSC  MACRO
 1569             ZERO    0               XX-DP NEXT
 1570      #1     NULL
 1571             VFD     O12/0400,6/0,8/0,1/#4
 1572             ZERO    ,#3-SSORG           OA-SC NXT
 1573             ZERO    #2-SSORG            SC-RS NXT
 1574             ENDM    .DBSC
 1575             EJECT
 1576      ***********************************************************
 1577      *
 1578      *  RECORD IN AREA DEFINITION MACRO
 1579      *
 1580      *  ARGUMENTS
 1581      *    ARG-1   NEXT  RC.RA
 1582      *    ARG-2   NEXT  AC.RA
 1583      *    ARG-3   HEAD  RC.RA
 1584      *    ARG-4   HEAD  AC.RA
 1585      *    ARG-5   LO DBK OF PAGE RANGE(IN OCTAL)
 1586      *    ARG-6   HI DBK OF PAGE RANGE(IN OCTAL)
 1587      *    ARG-7   NO. CALC HDRS IN RNG(IN OCTAL)
 1588      *    ARG-8   OFST OF LO DBK FROM CHR
 1589      *
 1590      ***********************************************************
 1591      .DBRA  MACRO
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              44   
 1592             ODD
 1593             VFD     O12/0200
 1594             ZERO    #1-OALOC,#2-OALOC         RC-RA NEXT, AC-RA NEXT
 1595             ZERO    #3-OALOC,#4-OALOC         RC-RA HEAD, AC-RA HEAD
 1596             INE     #5,'',7
 1597             OCT     #5              LOW DBK OF PG RNG
 1598             OCT     #6              HI  DBK OF PG RNG
 1599      X#1    BOOL    #6
 1600      Y#1    BOOL    #5
 1601      X      SET     X#1-Y#1+1
 1602      X      SET     X/64
 1603             VFD     36/X
 1604             IFE     #5,'',3
 1605             OCT     100
 1606             IFE     'A#8','A',1                                             JR060978
 1607             OCT     7
 1608             IFE     'A#8','A',1                                             JR060978
 1609             OCT     0               CHR OFST = 0
 1610             INE     #8,'',1
 1611             OCT     #8              CHR OFST
 1612             ENDM    .DBRA
 1613             EJECT
 1614      ***********************************************************
 1615      *
 1616      *  RECORD IN SET  DEFINITION MACRO
 1617      *
 1618      *  ARGUMENTS
 1619      *    ARG-1     LABEL FOR RS
 1620      *    ARG-2     0=OWNER, 1= MEMBER
 1621      *    ARG-3     SC-RS NXT
 1622      *    ARG-4     RC-RS NXT
 1623      *    ARG-5     SC-RS HEAD
 1624      *    ARG-6     RC-RS HEAD
 1625      *    ARG-7     NEXT  PTR DESCR.
 1626      *    ARG-8     PRIOR PTR DESCR.
 1627      *    ARG-9     HEAD  PTR DESCR.
 1628      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              45   
 1629      ***********************************************************
 1630      .DBRS  MACRO
 1631             ZERO    0               XX-DP NEXT
 1632      #1     NULL
 1633             IFE     #2+0,0,1                                                JR060978
 1634             VFD     O12/0100
 1635             IFE     #2+0,1,1                                                JR060978
 1636             VFD     O12/0040
 1637             ZERO    0,0                 RS-CD NXT, RS-SS NXT
 1638             ZERO    #3-SSORG,#4-SSORG   SC-RS NXT, RC-RS NXT
 1639             ZERO    #6-SSORG,#5-SSORG   RC-RS HD , SC-RS HD
 1640             ADSC9   #7,DBKSZ,3      NEXT PTR
 1641             ADSC9   #8,DBKSZ,3      PRIOR PTR
 1642             IFE     #2+0,1,1                                                JR060978
 1643             ADSC9   #9,DBKSZ,3      HEAD PTR
 1644             ENDM    .DBRS
 1645             EJECT
 1646      ***********************************************************
 1647      *
 1648      *  FIELD IN RECORD DEFINITION MACRO
 1649      *
 1650      *  ARGUMENTS
 1651      *    ARG-1   FIRST CD DEF. IN SOURCE SET
 1652      *    ARG-2   FIRST CD DEF. IN RESULT SET
 1653      *    ARG-3   FR DEF FOR LENGTH IF VAR. LENGTH FIELD
 1654      *    ARG-4   NEXT RC.FR
 1655      *    ARG-5   HEAD RC.FR
 1656      *    ARG-6   FIELD OFFSET IN RECORD
 1657      *    ARG-7   FIELD OFFSET IN UWA
 1658      *    ARG-8   1 = DIRECT RETR. FIELD
 1659      *    ARG-9   SIZE OF FIELD
 1660      *   ARG-10   ENCODE PROCEDURE INDEX
 1661      *   ARG-11   DECODE PROCEDURE INDEX
 1662      *
 1663      ***********************************************************
 1664      .DBFR  MACRO
 1665      USE    SET     0
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              46   
 1666             IFE     #8+0,1,1                                                JR060978
 1667      USE    SET     3               SET USAGE TO 3 FOR DIR. RET. FLD.
 1668             VFD     O12/0020,6/#10,6/,1/#8,3/USE,2/,6/#11
 1669             ZERO    #1-OALOC,#2-OALOC         1ST CD SOURCE, 1ST CD RESULT
 1670             ZERO    #3-OALOC,#4-OALOC         FR MEM NXT, FR OWN NEXT
 1671             ZERO    #5-OALOC,WSO    FR HEAD, WORK SPC OFST
 1672      WSO    SET     WSO+1           INCR WSO
 1673      WC     SET     #6/4
 1674      CC     SET     #6-4*WC                         CHAR CNT.
 1675             ADSC9   WC,CC,#9,3          DESCR. - OFST IN REC
 1676      WC     SET     #7/4
 1677      CC     SET     #7-4*WC                         CHAR CNT.
 1678             ADSC9   WC,CC,#9,1          DESCR. - OFST IN UWA
 1679             ENDM    .DBFR                           DESCR - OFST IN UWA
 1680             EJECT
 1681      ***********************************************************
 1682      *
 1683      *  SET OCCURENCE SELECTION DEFINITION MACRO
 1684      *
 1685      *  ARGUMENTS
 1686      *    ARG-1   RS DEF FOR SS
 1687      *              SO FOR ENTRY SS(CALC OR CURRENT)
 1688      *              SM FOR SEARCH OR MEMBER TYPE
 1689      *              NULL FOR DIRECT
 1690      *    ARG-2   NOT USED
 1691      *    ARG-3   NEXT OF RS.CD  SET
 1692      *    ARG-4   NEXT OF RS.SS  SET
 1693      *    ARG-5   TYPE OF SS
 1694      *
 1695      ***********************************************************
 1696      .DBSS  MACRO
 1697             VFD     O12/0010,3/0,3/#5
 1698             ZERO    #1-OALOC        RS PTR
 1699             ZERO    #3-OALOC,#4-OALOC         1ST CD, RS-SS NEXT
 1700             ENDM    .DBSS
 1701             EJECT
 1702      ***********************************************************
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              47   
 1703      *
 1704      *  CONTROL DEFINITION    DEFINITION MACRO
 1705      *
 1706      *  ARGUMENTS
 1707      *    ARG-1   NEXT CD DEF. IN SOURCE SET
 1708      *    ARG-2   NEXT CD DEF. IN RESULT SET
 1709      *                   .CD
 1710      *    ARG-4   HEAD RS.CD
 1711      *    ARG-5   HEAD FR IN SOURCE SET
 1712      *    ARG-6   HEAD FR IN RESULT SET
 1713      *    ARG-7   RELATION SHIP TYPE CODE
 1714      *    ARG-8   CONTROL TYPE CODE
 1715      *
 1716      ***********************************************************
 1717      .DBCD  MACRO
 1718             VFD     O12/0004,1/0,1/#8,4/#7
 1719             ZERO    #1-OALOC,#2-OALOC         FR-CDS NEXT, FR-CDR NEXT
 1720             ZERO    #3-OALOC,#4-OALOC         RS-CD NEXT , RS-CD  HEAD
 1721             ZERO    #5-OALOC,#6-OALOC         FR-CDS HEAD, FR-CDR HEAD
 1722             ENDM    .DBCD
 1723             EJECT
 1724      *************************************************
 1725      *
 1726      *      FIELD NAME DEFINITION RECORD SYMBOLS.
 1727      *
 1728      *   ARGUMENTS.
 1729      *              NONE.
 1730      *
 1731      *************************************************
 1732      .FNSYM MACRO
 1733      FN.TYP EQU     0               DEFINITION TYPE.
 1734      FN.NTP EQU     0               TYPE OF THE NAME.
 1735      FN.DBS EQU     0               DATA BASE SEQUENCE NUMBER.
 1736      FN.NOC EQU     0               NO. OF CHARACTERS IN FIELD NAME.
 1737      FN.ALS EQU     1               ALIAS FN DEFINITION.
 1738      FN.FNN EQU     1               NEXT FN DEFINITION RECORD.
 1739      FN.FRH EQU     2               HEAD FR DEFINITION RECORD.
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              48   
 1740      FN.ENT EQU     2               SCHEMA DATA TYPE.
 1741      FN.DET EQU     2               SUBSCHEMA DATA TYPE.
 1742      FN.NAM EQU     3               FIELD NAME.
 1743             ENDM    .FNSYM
 1744             EJECT
 1745      *************************************************
 1746      *
 1747      *      FIELD NAME DEFINITION MACRO.
 1748      *
 1749      *   ARGUMENTS.
 1750      *     ARG-1    NO. OF CHARACTERS IN FIELD NAME.
 1751      *    ARG-2     FIELD NAME.
 1752      *    ARG-3     OFFSET OF THE NEXT FN DEF. RECORD.
 1753      *    ARG-4     OFFSET OF THE HEAD FR DEFINITION.
 1754      *    ARG-5     ALIAS FN DEFINITION.
 1755      *    ARG-6     TYPE OF THE NAME.
 1756      *    ARG-7     DATA BASE SEQUENCE NUMBER.
 1757      *    ARG-8     SUBSCHEMA DATA TYPE.
 1758      *    ARG-9     SCHEMA DATA TYPE.
 1759      *
 1760      *************************************************
 1761      .DBFN  MACRO
 1762             VFD     O12/7001,3/0,3/#6,12/#7,6/#1
 1763             ZERO    #5-OALOC,#3-OALOC
 1764             VFD     18/#4-OALOC,6/0,6/#8,6/#9
 1765             INE     #1,0,3
 1766      CC     SET     #1+3
 1767      WC     SET     CC/4
 1768             ASCII   WC,#2
 1769             ENDM    .DBFN
 1770             EJECT
 1771      *
 1772      *  CHECK STATUS MACRO
 1773      *
 1774      *  ARG-1       STATUS TO CHECK FOR
 1775      *  ARG-2       ERROR EXIT
 1776      *
11:15 SEP 05 '97 Q2MA.:ZIC0SI                                              49   
 1777      CKSTA  MACRO
 1778             LDA     DBST,,PR5
 1779             LDQ     DBST+1,,PR5
 1780             ORQ     =O040,DL        PUT BLANK O RIGHT
 1781             CMPA    *+5
 1782             TNZ     #2
 1783             CMPQ    *+4
 1784             TNZ     #2
 1785             TRA     *+3
 1786             ASCII   2,#1
 1787             ENDM    CKSTA
 1788             EJECT
 1789      LOCK  MACRO
 1790            LDX     X3,#1,,PR7          GET REC VAR
 1791            DBCAL   ZIM$DBPLK,,NOALT    DBIOL WILL TRA TO ZIO$LOCK
 1792            ENDM    LOCK
 1793      UNLOCK MACRO
 1794            LDX     X3,#1,,PR7
 1795            INE     #2,'',2
 1796            LDX     X4,BLKD,X3,PR7      CHK LOCKED FLAG OF REC VAR
 1797            TZE     *+3
 1798            TSX     X1,ZIM$DBPUL        CALL UNLOCK PRIMITIVE
 1799            DRL     0                   NO ALTRET ADDR
 1800            ENDM    UNLOCK
 1801            EJECT
 1802             LIST    ON              JR061278

