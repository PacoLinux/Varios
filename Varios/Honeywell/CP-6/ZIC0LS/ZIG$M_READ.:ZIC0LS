
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:1    
        1        1        /*M*     ZIG$M_READ            I-D-S/II  DBACS DIRECTIVE READER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$M_READ
        9        9        PURPOSE: TO GET A LINE FOR THE PARSER OF DBACS DIRECTIVES
       10       10                 AND STORE THEM IN A BUFFER
       11       11            CALLING PROGRAMS         SUBROUTINE NAMES
       12       12            ----------------         ----------------
       13       13                 ZIG$M_PSET               ZIG$M_PSET
       14       14                 ZIG$M_PDRI               ZIG$M_PDRI
       15       15        */
       16       16        ZIG$M_READ:
       17       17            PROC ;
       18       18    1   DCL RDWORD BIT (1) EXT;
       19       19    1   DCL ZIG$DDS5 ENTRY;
       20       20    1   DCL REC CHAR (80) EXT;
       21       21    1   DCL REC1 CHAR (80) EXT;
       22       22    1   DCL EOFFLG UBIN (36) EXT;
       23       23    1   DCL LINE_COUNT UBIN (36) EXT;
       24       24    1   DCL SAVESW BIT (1) EXT;
       25       25    1   DCL NUM_CHAR_READ UBIN (36) EXT;
       26       26    1   DCL LINE CHAR (4000) EXT;
       27       27    1   DCL LAST_COUNT UBIN (36) SYMREF;
       28       28    1   DCL LIST_STRING CHAR(128) EXT;
       29       29    1   DCL ZIG$COMP ENTRY (3); /* Put out a compressed record */
       30       30    1   DCL FOUND_PER BIT (1) SYMREF;
       31       31    1   DCL PUT_OUT_LINE ENTRY(2); /* Put out a record to M$LO */
       32       32    1   DCL INIT1 BIT (1);
       33       33    1   DCL NCS UBIN (36) EXT;
       34       34    1   DCL I UBIN (36);
       35       35    1   DCL K UBIN (36);
       36       36    1   DCL END_DMCL BIT (1) EXT;
       37       37    1   DCL DONE BIT (1);
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:2    
       38       38         %EJECT;
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:3    
       39       39         %INCLUDE XU_MACRO_C;
       40     3145         %INCLUDE ZI_ERRORS_SUBS;
       41     3665         %P$PCB(NAME=DMCL_P, STCLASS = "SYMREF");
       42     3866         %INCLUDE ZIG_GENERAL;
       43     3974         %EJECT;
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:4    
       44     3975    1   NEXT_REC: PROC;
       45     3976    2       CALL ZIG$DDS5; /* Get a record */
       46     3977    2       CALL PUT_OUT_LINE(LINE_COUNT,REC);
       47     3978    2       LINE_COUNT=LINE_COUNT+1;
       48     3979    2       REC1=REC;
       49     3980    2       CALL ZIG$COMP(NUM_CHAR_READ,'DM  ',REC1);
       50     3981    2   END;
       51     3982        /*****
       52     3983                 Find then number of characters read in the last
       53     3984                 read done by exread.
       54     3985        ******/
       55     3986    1   RESTART:
       56     3987    1       CALL NEXT_REC;
       57     3988    1       IF NCS=1
       58     3989    2       THEN DO;
       59     3990    2           RDWORD='0'B;
       60     3991    2           SAVESW='1'B;
       61     3992    2           CALL WARNING(2185); /* No END_DMCL */
       62     3993        /*       ERROR:    ZIG-2185-C
       63     3994        MESSAGE: No END_DMCL found at end of DMCL text.
       64     3995        */
       65     3996    2           END_DMCL='1'B;
       66     3997    2           RETURN;
       67     3998    2           END;
       68     3999    1       I=0;
       69     4000    1       CALL INDEX(I,'COMMENT"',REC1) ALTRET(NO_COMMENT);
       70     4001    1       DONE='0'B;
       71     4002    1       I=I+7;
       72     4003    2       DO WHILE (SUBSTR(REC1,I,1)~='"'&~DONE);
       73     4004    2           IF SUBSTR(REC1,I,1)~=' '
       74     4005    3           THEN DO;
       75     4006    3               I=0;
       76     4007    3               DONE='1'B;
       77     4008    3               END;
       78     4009    3           ELSE DO;
       79     4010    3               I=I+1;
       80     4011    3               IF I>NUM_CHAR_READ
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:5    
       81     4012    4               THEN DO;
       82     4013    4                   CALL NEXT_REC;
       83     4014    4                   I=0;
       84     4015    4                   END;
       85     4016    3               END;
       86     4017    2           END;
       87     4018    1       I=I+1;
       88     4019    2       DO WHILE(SUBSTR(REC1,I,1)~='"'&~DONE);
       89     4020    2           I=I+1;
       90     4021    2           IF I>NUM_CHAR_READ
       91     4022    3           THEN DO;
       92     4023    3               CALL NEXT_REC;
       93     4024    3               I=0;
       94     4025    3               END;
       95     4026    3           DO WHILE (SUBSTR(REC1,I,2)='""');
       96     4027    3               I=I+2;
       97     4028    3               END;
       98     4029    2           END;
       99     4030    1       IF ~DONE
      100     4031    2       THEN DO;
      101     4032    2           REC1=SUBSTR(REC1,I+1);
      102     4033    2           NUM_CHAR_READ=NUM_CHAR_READ-I;
      103     4034    2           END;
      104     4035    1   NO_COMMENT:
      105     4036    1       IF REC1 = ' '
      106     4037    1       THEN GOTO RESTART;
      107     4038        /*
      108     4039              Goto easy way out.
      109     4040        */
      110     4041    1       LAST_COUNT = DMCL_P.NCHARS;
      111     4042    1       I = NUM_CHAR_READ-1;
      112     4043        /*********
      113     4044        	scan from back of record to find the first non
      114     4045        	blank CHARACTER.(FIND the end of the record).
      115     4046        **********/
      116     4047    1       CALL SEARCHR(I,K,SEARCHR_NB,REC1);
      117     4048    1       CALL XLATE(REC1,DMCL_XLATE,REC1);
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:6    
      118     4049    1       CALL INSERT(LINE,DMCL_P.NCHARS,I+2,SUBSTR(REC1,0,I+1),' ');
      119     4050    1       DMCL_P.NCHARS = DMCL_P.NCHARS + I + 1;
      120     4051        /********
      121     4052        	don't add a ';' if this is the end of the directive.
      122     4053        *********/
      123     4054    1       FOUND_PER='0'B;
      124     4055    1       CALL INDEX2R(K,'. ',REC) ALTRET (NO_PERIOD);
      125     4056    1       IF K > I-2
      126     4057    2       THEN DO;
      127     4058    2           FOUND_PER = '1'B;
      128     4059    2           END;
      129     4060    1   NO_PERIOD:
      130     4061    1       IF ~FOUND_PER
      131     4062    2       THEN DO;
      132     4063    2           CALL INSERT(LINE,DMCL_P.NCHARS,3,' #;');
      133     4064    2           DMCL_P.NCHARS=DMCL_P.NCHARS + 3;
      134     4065    2           END;
      135     4066        /*********
      136     4067        	replace all ';' with '%' so that X$PARSE doesn't
      137     4068        	think that what is in '"' is a comment and skips
      138     4069        	over it.
      139     4070        *********/
      140     4071    1   END ZIG$M_READ;

PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:7    
--  Include file information  --

   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$M_READ.

   Procedure ZIG$M_READ requires 206 words for executable code.
   Procedure ZIG$M_READ requires 12 words of local(AUTO) storage.

    No errors detected in file ZIG$M_READ.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:8    

 Object Unit name= ZIG$M_READ                                 File name= ZIG$M_READ.:ZIC0TOU
 UTS= SEP 05 '97 12:09:59.20 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  RDWORD
    1  LblCom even  none    20     24  REC
    2  LblCom even  none    20     24  REC1
    3  LblCom even  none     1      1  EOFFLG
    4  LblCom even  none     1      1  LINE_COUNT
    5  LblCom even  none     1      1  SAVESW
    6  LblCom even  none     1      1  NUM_CHAR_READ
    7  LblCom even  none  1000   1750  LINE
    8  LblCom even  none    32     40  LIST_STRING
    9  LblCom even  none     1      1  NCS
   10  LblCom even  none     1      1  END_DMCL
   11  LblCom even  none     1      1  NUM_ERROR_MSG
   12  LblCom even  none     1      1  NUM_WARN_MSG
   13  LblCom even  none     1      1  ALLOCATE_END
   14  LblCom even  none     2      2  SUBSCHEMA_KEY
   15  LblCom even  none     1      1  BUFFER$
   16  LblCom even  none     1      1  ERROR_IO
   17  LblCom even  none     1      1  BUFFER_LEN
   18  LblCom even  none     2      2  UWA_KEY
   19  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   20  LblCom even  none     2      2  RVA_KEY
   21  LblCom even  none     2      2  IA__KEY
   22  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   23  LblCom even  none    32     40  SEARCHR_NB
   24  LblCom even  none    32     40  SEM_COM
   25  LblCom even  none    32     40  DMCL_XLATE
   26  LblCom even  none    32     40  Q2_PERCENT
   27  RoData even  UTS      6      6  ZIG$M_READ
   28   Proc  even  none   206    316  ZIG$M_READ
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:9    
   29  RoData even  none    14     16  ZIG$M_READ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    28      0   yes            yes      Std        0  ZIG$M_READ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 WARNING
         yes           Std       0 ZIG$DDS5
         yes           Std       2 PUT_OUT_LINE
         yes           Std       3 ZIG$COMP
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     LAST_COUNT                            FOUND_PER                             DMCL_P

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:10   


        1        1        /*M*     ZIG$M_READ            I-D-S/II  DBACS DIRECTIVE READER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$M_READ
        9        9        PURPOSE: TO GET A LINE FOR THE PARSER OF DBACS DIRECTIVES
       10       10                 AND STORE THEM IN A BUFFER
       11       11            CALLING PROGRAMS         SUBROUTINE NAMES
       12       12            ----------------         ----------------
       13       13                 ZIG$M_PSET               ZIG$M_PSET
       14       14                 ZIG$M_PDRI               ZIG$M_PDRI
       15       15        */
       16       16        ZIG$M_READ:
       17       17            PROC ;

     17 28 000000   000000 700200 xent  ZIG$M_READ   TSX0  ! X66_AUTO_0
        28 000001   000014 000000                    ZERO    12,0
        28 000002   000027 710000 28                 TRA     RESTART

       18       18    1   DCL RDWORD BIT (1) EXT;
       19       19    1   DCL ZIG$DDS5 ENTRY;
       20       20    1   DCL REC CHAR (80) EXT;
       21       21    1   DCL REC1 CHAR (80) EXT;
       22       22    1   DCL EOFFLG UBIN (36) EXT;
       23       23    1   DCL LINE_COUNT UBIN (36) EXT;
       24       24    1   DCL SAVESW BIT (1) EXT;
       25       25    1   DCL NUM_CHAR_READ UBIN (36) EXT;
       26       26    1   DCL LINE CHAR (4000) EXT;
       27       27    1   DCL LAST_COUNT UBIN (36) SYMREF;
       28       28    1   DCL LIST_STRING CHAR(128) EXT;
       29       29    1   DCL ZIG$COMP ENTRY (3); /* Put out a compressed record */
       30       30    1   DCL FOUND_PER BIT (1) SYMREF;
       31       31    1   DCL PUT_OUT_LINE ENTRY(2); /* Put out a record to M$LO */
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:11   
       32       32    1   DCL INIT1 BIT (1);
       33       33    1   DCL NCS UBIN (36) EXT;
       34       34    1   DCL I UBIN (36);
       35       35    1   DCL K UBIN (36);
       36       36    1   DCL END_DMCL BIT (1) EXT;
       37       37    1   DCL DONE BIT (1);
       38       38         %EJECT;
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:12   
       39       39         %INCLUDE XU_MACRO_C;
       40     3145         %INCLUDE ZI_ERRORS_SUBS;
       41     3665         %P$PCB(NAME=DMCL_P, STCLASS = "SYMREF");
       42     3866         %INCLUDE ZIG_GENERAL;
       43     3974         %EJECT;
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:13   
       44     3975    1   NEXT_REC: PROC;

   3975 28 000003   200010 741300       NEXT_REC     STX1  ! DONE+2,,AUTO

       45     3976    2       CALL ZIG$DDS5; /* Get a record */

   3976 28 000004   000000 631400 29                 EPPR1   0
        28 000005   000000 701000 xent               TSX1    ZIG$DDS5
        28 000006   000000 011000                    NOP     0

       46     3977    2       CALL PUT_OUT_LINE(LINE_COUNT,REC);

   3977 28 000007   000002 630400 29                 EPPR0   2
        28 000010   000001 631400 29                 EPPR1   1
        28 000011   000000 701000 xent               TSX1    PUT_OUT_LINE
        28 000012   000000 011000                    NOP     0

       47     3978    2       LINE_COUNT=LINE_COUNT+1;

   3978 28 000013   000000 235000 4                  LDA     LINE_COUNT
        28 000014   000001 035007                    ADLA    1,DL
        28 000015   000000 755000 4                  STA     LINE_COUNT

       48     3979    2       REC1=REC;

   3979 28 000016   040000 100400                    MLR     fill='040'O
        28 000017   000000 000120 1                  ADSC9   REC                      cn=0,n=80
        28 000020   000000 000120 2                  ADSC9   REC1                     cn=0,n=80

       49     3980    2       CALL ZIG$COMP(NUM_CHAR_READ,'DM  ',REC1);

   3980 28 000021   000005 630400 29                 EPPR0   5
        28 000022   000004 631400 29                 EPPR1   4
        28 000023   000000 701000 xent               TSX1    ZIG$COMP
        28 000024   000000 011000                    NOP     0

       50     3981    2   END;
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:14   

   3981 28 000025   200010 221300                    LDX1  ! DONE+2,,AUTO
        28 000026   000001 702211                    TSX2  ! 1,X1

       51     3982        /*****
       52     3983                 Find then number of characters read in the last
       53     3984                 read done by exread.
       54     3985        ******/
       55     3986    1   RESTART:
       56     3987    1       CALL NEXT_REC;

   3987 28 000027   000003 701000 28    RESTART      TSX1    NEXT_REC
        28 000030   000000 011000                    NOP     0

       57     3988    1       IF NCS=1

   3988 28 000031   000000 235000 9                  LDA     NCS
        28 000032   000001 115007                    CMPA    1,DL
        28 000033   000046 601000 28                 TNZ     s:3999

       58     3989    2       THEN DO;

       59     3990    2           RDWORD='0'B;

   3990 28 000034   000000 450000 0                  STZ     RDWORD

       60     3991    2           SAVESW='1'B;

   3991 28 000035   400000 236003                    LDQ     -131072,DU
        28 000036   000000 756000 5                  STQ     SAVESW

       61     3992    2           CALL WARNING(2185); /* No END_DMCL */

   3992 28 000037   000012 630400 29                 EPPR0   10
        28 000040   000010 631400 29                 EPPR1   8
        28 000041   000000 701000 xent               TSX1    WARNING
        28 000042   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:15   

       62     3993        /*       ERROR:    ZIG-2185-C
       63     3994        MESSAGE: No END_DMCL found at end of DMCL text.
       64     3995        */
       65     3996    2           END_DMCL='1'B;

   3996 28 000043   400000 236003                    LDQ     -131072,DU
        28 000044   000000 756000 10                 STQ     END_DMCL

       66     3997    2           RETURN;

   3997 28 000045   000000 702200 xent               TSX2  ! X66_ARET

       67     3998    2           END;
       68     3999    1       I=0;

   3999 28 000046   200004 450100                    STZ     I,,AUTO

       69     4000    1       CALL INDEX(I,'COMMENT"',REC1) ALTRET(NO_COMMENT);

   4000 28 000047   200004 631500                    EPPR1   I,,AUTO
        28 000050   000001 633400 27                 EPPR3   1
        28 000051   000010 223003                    LDX3    8,DU
        28 000052   000000 630400 2                  EPPR0   REC1
        28 000053   000120 220003                    LDX0    80,DU
        28 000054   000000 236003                    LDQ     0,DU
        28 000055   000000 701000 xent               TSX1    X66_INDEX
        28 000056   000201 710000 28                 TRA     NO_COMMENT

       70     4001    1       DONE='0'B;

   4001 28 000057   200006 450100                    STZ     DONE,,AUTO

       71     4002    1       I=I+7;

   4002 28 000060   200004 235100                    LDA     I,,AUTO
        28 000061   000007 035007                    ADLA    7,DL
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:16   
        28 000062   200004 755100                    STA     I,,AUTO

       72     4003    2       DO WHILE (SUBSTR(REC1,I,1)~='"'&~DONE);

   4003 28 000063   000105 710000 28                 TRA     s:4017

       73     4004    2           IF SUBSTR(REC1,I,1)~=' '

   4004 28 000064   200004 235100                    LDA     I,,AUTO
        28 000065   040000 106405                    CMPC    fill='040'O
        28 000066   000000 000001 2                  ADSC9   REC1,A                   cn=0,n=1
        28 000067   000013 000001 29                 ADSC9   11                       cn=0,n=1
        28 000070   000075 600000 28                 TZE     s:4010

       74     4005    3           THEN DO;

       75     4006    3               I=0;

   4006 28 000071   200004 450100                    STZ     I,,AUTO

       76     4007    3               DONE='1'B;

   4007 28 000072   400000 236003                    LDQ     -131072,DU
        28 000073   200006 756100                    STQ     DONE,,AUTO

       77     4008    3               END;

   4008 28 000074   000105 710000 28                 TRA     s:4017

       78     4009    3           ELSE DO;

       79     4010    3               I=I+1;

   4010 28 000075   000001 035007                    ADLA    1,DL
        28 000076   200004 755100                    STA     I,,AUTO

       80     4011    3               IF I>NUM_CHAR_READ
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:17   

   4011 28 000077   000000 236000 6                  LDQ     NUM_CHAR_READ
        28 000100   200004 116100                    CMPQ    I,,AUTO
        28 000101   000105 603000 28                 TRC     s:4017

       81     4012    4               THEN DO;

       82     4013    4                   CALL NEXT_REC;

   4013 28 000102   000003 701000 28                 TSX1    NEXT_REC
        28 000103   000000 011000                    NOP     0

       83     4014    4                   I=0;

   4014 28 000104   200004 450100                    STZ     I,,AUTO

       84     4015    4                   END;

       85     4016    3               END;

       86     4017    2           END;

   4017 28 000105   400000 220003                    LDX0    -131072,DU
        28 000106   200004 235100                    LDA     I,,AUTO
        28 000107   040000 106405                    CMPC    fill='040'O
        28 000110   000000 000001 2                  ADSC9   REC1,A                   cn=0,n=1
        28 000111   000014 000001 29                 ADSC9   12                       cn=0,n=1
        28 000112   000114 601000 28                 TNZ     s:4017+7
        28 000113   000000 220003                    LDX0    0,DU
        28 000114   200006 236100                    LDQ     DONE,,AUTO
        28 000115   400000 376003                    ANQ     -131072,DU
        28 000116   400000 676003                    ERQ     -131072,DU
        28 000117   200012 756100                    STQ     DONE+4,,AUTO
        28 000120   000000 636010                    EAQ     0,X0
        28 000121   200012 376100                    ANQ     DONE+4,,AUTO
        28 000122   000064 601000 28                 TNZ     s:4004

PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:18   
       87     4018    1       I=I+1;

   4018 28 000123   000001 035007                    ADLA    1,DL
        28 000124   200004 755100                    STA     I,,AUTO

       88     4019    2       DO WHILE(SUBSTR(REC1,I,1)~='"'&~DONE);

   4019 28 000125   000150 710000 28                 TRA     s:4029

       89     4020    2           I=I+1;

   4020 28 000126   200004 235100                    LDA     I,,AUTO
        28 000127   000001 035007                    ADLA    1,DL
        28 000130   200004 755100                    STA     I,,AUTO

       90     4021    2           IF I>NUM_CHAR_READ

   4021 28 000131   000000 236000 6                  LDQ     NUM_CHAR_READ
        28 000132   200004 116100                    CMPQ    I,,AUTO
        28 000133   000137 603000 28                 TRC     s:4026

       91     4022    3           THEN DO;

       92     4023    3               CALL NEXT_REC;

   4023 28 000134   000003 701000 28                 TSX1    NEXT_REC
        28 000135   000000 011000                    NOP     0

       93     4024    3               I=0;

   4024 28 000136   200004 450100                    STZ     I,,AUTO

       94     4025    3               END;

       95     4026    3           DO WHILE (SUBSTR(REC1,I,2)='""');

   4026 28 000137   000143 710000 28                 TRA     s:4028
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:19   

       96     4027    3               I=I+2;

   4027 28 000140   200004 235100                    LDA     I,,AUTO
        28 000141   000002 035007                    ADLA    2,DL
        28 000142   200004 755100                    STA     I,,AUTO

       97     4028    3               END;

   4028 28 000143   200004 235100                    LDA     I,,AUTO
        28 000144   040000 106405                    CMPC    fill='040'O
        28 000145   000000 000002 2                  ADSC9   REC1,A                   cn=0,n=2
        28 000146   000003 000002 27                 ADSC9   3                        cn=0,n=2
        28 000147   000140 600000 28                 TZE     s:4027

       98     4029    2           END;

   4029 28 000150   400000 220003                    LDX0    -131072,DU
        28 000151   040000 106405                    CMPC    fill='040'O
        28 000152   000000 000001 2                  ADSC9   REC1,A                   cn=0,n=1
        28 000153   000014 000001 29                 ADSC9   12                       cn=0,n=1
        28 000154   000156 601000 28                 TNZ     s:4029+6
        28 000155   000000 220003                    LDX0    0,DU
        28 000156   200006 236100                    LDQ     DONE,,AUTO
        28 000157   400000 376003                    ANQ     -131072,DU
        28 000160   400000 676003                    ERQ     -131072,DU
        28 000161   200012 756100                    STQ     DONE+4,,AUTO
        28 000162   000000 636010                    EAQ     0,X0
        28 000163   200012 376100                    ANQ     DONE+4,,AUTO
        28 000164   000126 601000 28                 TNZ     s:4020

       99     4030    1       IF ~DONE

   4030 28 000165   200006 236100                    LDQ     DONE,,AUTO
        28 000166   400000 376003                    ANQ     -131072,DU
        28 000167   400000 676003                    ERQ     -131072,DU
        28 000170   000201 600000 28                 TZE     NO_COMMENT
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:20   

      100     4031    2       THEN DO;

      101     4032    2           REC1=SUBSTR(REC1,I+1);

   4032 28 000171   777660 620005                    EAX0    -80,AL
        28 000172   777777 660003                    ERX0    -1,DU
        28 000173   040000 100445                    MLR     fill='040'O
        28 000174   000000 200010 2                  ADSC9   REC1,A                   cn=1,n=*X0
        28 000175   000000 000120 2                  ADSC9   REC1                     cn=0,n=80

      102     4033    2           NUM_CHAR_READ=NUM_CHAR_READ-I;

   4033 28 000176   000000 236000 6                  LDQ     NUM_CHAR_READ
        28 000177   200004 136100                    SBLQ    I,,AUTO
        28 000200   000000 756000 6                  STQ     NUM_CHAR_READ

      103     4034    2           END;

      104     4035    1   NO_COMMENT:
      105     4036    1       IF REC1 = ' '

   4036 28 000201   040000 106400       NO_COMMENT   CMPC    fill='040'O
        28 000202   000000 000120 2                  ADSC9   REC1                     cn=0,n=80
        28 000203   000013 000001 29                 ADSC9   11                       cn=0,n=1
        28 000204   000027 600000 28                 TZE     RESTART

      106     4037    1       THEN GOTO RESTART;
      107     4038        /*
      108     4039              Goto easy way out.
      109     4040        */
      110     4041    1       LAST_COUNT = DMCL_P.NCHARS;

   4041 28 000205   000011 235000 xsym               LDA     DMCL_P+9
        28 000206   000000 755000 xsym               STA     LAST_COUNT

      111     4042    1       I = NUM_CHAR_READ-1;
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:21   

   4042 28 000207   000000 236000 6                  LDQ     NUM_CHAR_READ
        28 000210   000001 136007                    SBLQ    1,DL
        28 000211   200004 756100                    STQ     I,,AUTO

      112     4043        /*********
      113     4044        	scan from back of record to find the first non
      114     4045        	blank CHARACTER.(FIND the end of the record).
      115     4046        **********/
      116     4047    1       CALL SEARCHR(I,K,SEARCHR_NB,REC1);

   4047 28 000212   000000 165400                    TCTR
        28 000213   000000 000120 2                  ADSC9   REC1                     cn=0,n=80
        28 000214   000000 000000 23                 ARG     SEARCHR_NB
        28 000215   200004 000100                    ARG     I,,AUTO
        28 000216   200004 235100                    LDA     I,,AUTO
        28 000217   000033 771000                    ARL     27
        28 000220   200005 755100                    STA     K,,AUTO
        28 000221   200004 551140                    STBA    I,'40'O,AUTO
        28 000222   000225 606400 28                 TTN     s:4048
        28 000223   000117 236007                    LDQ     79,DL
        28 000224   200004 156100                    SSQ     I,,AUTO

      117     4048    1       CALL XLATE(REC1,DMCL_XLATE,REC1);

   4048 28 000225   040000 160400                    MVT     fill='040'O
        28 000226   000000 000120 2                  ADSC9   REC1                     cn=0,n=80
        28 000227   000000 000120 2                  ADSC9   REC1                     cn=0,n=80
        28 000230   000000 000000 25                 ARG     DMCL_XLATE

      118     4049    1       CALL INSERT(LINE,DMCL_P.NCHARS,I+2,SUBSTR(REC1,0,I+1),' ');

   4049 28 000231   200004 720100                    LXL0    I,,AUTO
        28 000232   000001 621010                    EAX1    1,X0
        28 000233   200004 722100                    LXL2    I,,AUTO
        28 000234   000002 623012                    EAX3    2,X2
        28 000235   000011 236000 xsym               LDQ     DMCL_P+9
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:22   
        28 000236   040046 100440                    MLR     fill='040'O
        28 000237   000000 000011 2                  ADSC9   REC1                     cn=0,n=*X1
        28 000240   000000 000013 7                  ADSC9   LINE,Q                   cn=0,n=*X3
        28 000241   200004 236100                    LDQ     I,,AUTO
        28 000242   200004 136100                    SBLQ    I,,AUTO
        28 000243   000015 116000 29                 CMPQ    13
        28 000244   000255 604400 28                 TMOZ    s:4050
        28 000245   200012 756100                    STQ     DONE+4,,AUTO
        28 000246   000011 236000 xsym               LDQ     DMCL_P+9
        28 000247   200004 036100                    ADLQ    I,,AUTO
        28 000250   200012 724100                    LXL4    DONE+4,,AUTO
        28 000251   000001 625014                    EAX5    1,X4
        28 000252   040046 100400                    MLR     fill='040'O
        28 000253   000013 000001 29                 ADSC9   11                       cn=0,n=1
        28 000254   000000 200015 7                  ADSC9   LINE,Q                   cn=1,n=*X5

      119     4050    1       DMCL_P.NCHARS = DMCL_P.NCHARS + I + 1;

   4050 28 000255   000011 236000 xsym               LDQ     DMCL_P+9
        28 000256   200004 036100                    ADLQ    I,,AUTO
        28 000257   000001 036007                    ADLQ    1,DL
        28 000260   000011 756000 xsym               STQ     DMCL_P+9

      120     4051        /********
      121     4052        	don't add a ';' if this is the end of the directive.
      122     4053        *********/
      123     4054    1       FOUND_PER='0'B;

   4054 28 000261   000000 450000 xsym               STZ     FOUND_PER

      124     4055    1       CALL INDEX2R(K,'. ',REC) ALTRET (NO_PERIOD);

   4055 28 000262   000000 121400                    SCDR
        28 000263   000000 000120 1                  ADSC9   REC                      cn=0,n=80
        28 000264   000004 000002 27                 ADSC9   4                        cn=0,n=2
        28 000265   200005 000100                    ARG     K,,AUTO
        28 000266   000272 606400 28                 TTN     s:4055+8
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:23   
        28 000267   000117 236007                    LDQ     79,DL
        28 000270   200005 156100                    SSQ     K,,AUTO
        28 000271   000274 710000 28                 TRA     s:4056
        28 000272   200005 054100                    AOS     K,,AUTO
        28 000273   000303 710000 28                 TRA     NO_PERIOD

      125     4056    1       IF K > I-2

   4056 28 000274   200004 236100                    LDQ     I,,AUTO
        28 000275   000002 136007                    SBLQ    2,DL
        28 000276   000301 604000 28                 TMI     s:4058
        28 000277   200005 116100                    CMPQ    K,,AUTO
        28 000300   000303 603000 28                 TRC     NO_PERIOD

      126     4057    2       THEN DO;

      127     4058    2           FOUND_PER = '1'B;

   4058 28 000301   400000 236003                    LDQ     -131072,DU
        28 000302   000000 756000 xsym               STQ     FOUND_PER

      128     4059    2           END;

      129     4060    1   NO_PERIOD:
      130     4061    1       IF ~FOUND_PER

   4061 28 000303   000000 236000 xsym  NO_PERIOD    LDQ     FOUND_PER
        28 000304   400000 376003                    ANQ     -131072,DU
        28 000305   400000 676003                    ERQ     -131072,DU
        28 000306   000315 600000 28                 TZE     s:4071

      131     4062    2       THEN DO;

      132     4063    2           CALL INSERT(LINE,DMCL_P.NCHARS,3,' #;');

   4063 28 000307   000011 235000 xsym               LDA     DMCL_P+9
        28 000310   040005 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:24   
        28 000311   000005 000003 27                 ADSC9   5                        cn=0,n=3
        28 000312   000000 000003 7                  ADSC9   LINE,A                   cn=0,n=3

      133     4064    2           DMCL_P.NCHARS=DMCL_P.NCHARS + 3;

   4064 28 000313   000003 035007                    ADLA    3,DL
        28 000314   000011 755000 xsym               STA     DMCL_P+9

      134     4065    2           END;

      135     4066        /*********
      136     4067        	replace all ';' with '%' so that X$PARSE doesn't
      137     4068        	think that what is in '"' is a comment and skips
      138     4069        	over it.
      139     4070        *********/
      140     4071    1   END ZIG$M_READ;

   4071 28 000315   000000 702200 xent               TSX2  ! X66_ARET

REC
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

REC1
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LINE
 Sect OctLoc
   7     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LIST_STRING
 Sect OctLoc
   8     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:25   
  18     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  20     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  21     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  23     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  23     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  23     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  23     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  24     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  24     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  24     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  24     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  24     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  24     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  24     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  24     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  25     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  25     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  25     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  25     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  25     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  25     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  25     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:26   
  25     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  26     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  26     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  26     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  26     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  26     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  26     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  26     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  26     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

(unnamed)
 Sect OctLoc
  27     000   104115 040040   103117 115115   105116 124042   042042 040040    DM  COMMENT"""
  27     004   056040 040040   040043 073040                                    .    #;

(unnamed)
 Sect OctLoc
  29     000   000000 000000   000002 000000   000000 006000   000000 006000    ................
  29     004   000003 000000   000000 006000   000000 006000   000000 006000    ................
  29     010   000001 000000   000000 004211   000011 006000   040040 040040    ............
  29     014   042040 040040   777777 777777                                    "   ....

PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:27   
--  Include file information  --

   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$M_READ.

   Procedure ZIG$M_READ requires 206 words for executable code.
   Procedure ZIG$M_READ requires 12 words of local(AUTO) storage.

    No errors detected in file ZIG$M_READ.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:28   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:29   
          MINI XREF LISTING

DMCL_P.NCHARS
      3831**DCL      4041>>ASSIGN   4049>>CALLBLT  4050<<ASSIGN   4050>>ASSIGN   4063>>CALLBLT  4064<<ASSIGN
      4064>>ASSIGN
DMCL_XLATE
      3950**DCL      4048>>CALLBLT
DONE
        37**DCL      4001<<ASSIGN   4003>>DOWHILE  4007<<ASSIGN   4019>>DOWHILE  4030>>IF
END_DMCL
        36**DCL      3996<<ASSIGN
FOUND_PER
        30**DCL      4054<<ASSIGN   4058<<ASSIGN   4061>>IF
I
        34**DCL      3999<<ASSIGN   4000<<CALLBLT  4002<<ASSIGN   4002>>ASSIGN   4003>>DOWHILE  4004>>IF
      4006<<ASSIGN   4010<<ASSIGN   4010>>ASSIGN   4011>>IF       4014<<ASSIGN   4018<<ASSIGN   4018>>ASSIGN
      4019>>DOWHILE  4020<<ASSIGN   4020>>ASSIGN   4021>>IF       4024<<ASSIGN   4026>>DOWHILE  4027<<ASSIGN
      4027>>ASSIGN   4032>>ASSIGN   4033>>ASSIGN   4042<<ASSIGN   4047<<CALLBLT  4049>>CALLBLT  4049>>CALLBLT
      4050>>ASSIGN   4056>>IF
K
        35**DCL      4047<<CALLBLT  4055<<CALLBLT  4056>>IF
LAST_COUNT
        27**DCL      4041<<ASSIGN
LINE
        26**DCL      4049<<CALLBLT  4063<<CALLBLT
LINE_COUNT
        23**DCL      3977<>CALL     3978<<ASSIGN   3978>>ASSIGN
NCS
        33**DCL      3988>>IF
NEXT_REC
      3975**PROC     3987--CALL     4013--CALL     4023--CALL
NO_COMMENT
      4036**LABEL    4000--CALLALT
NO_PERIOD
PL6.E3A0      #001=ZIG$M_READ File=ZIG$M_READ.:ZIC0TSI                           FRI 09/05/97 12:09 Page:30   
      4061**LABEL    4055--CALLALT
NUM_CHAR_READ
        25**DCL      3980<>CALL     4011>>IF       4021>>IF       4033<<ASSIGN   4033>>ASSIGN   4042>>ASSIGN
PUT_OUT_LINE
        31**DCL-ENT  3977--CALL
RDWORD
        18**DCL      3990<<ASSIGN
REC
        20**DCL      3977<>CALL     3979>>ASSIGN   4055>>CALLBLT
REC1
        21**DCL      3979<<ASSIGN   3980<>CALL     4000>>CALLBLT  4003>>DOWHILE  4004>>IF       4019>>DOWHILE
      4026>>DOWHILE  4032<<ASSIGN   4032>>ASSIGN   4036>>IF       4047>>CALLBLT  4048<<CALLBLT  4048>>CALLBLT
      4049>>CALLBLT
RESTART
      3987**LABEL    4037--GOTO
SAVESW
        24**DCL      3991<<ASSIGN
SEARCHR_NB
      3941**DCL      4047>>CALLBLT
SUBSCHEMA_KEY
      3914**DCL      3915--REDEF
WARNING
      3880**DCL-ENT  3992--CALL
ZIG$COMP
        29**DCL-ENT  3980--CALL
ZIG$DDS5
        19**DCL-ENT  3976--CALL
