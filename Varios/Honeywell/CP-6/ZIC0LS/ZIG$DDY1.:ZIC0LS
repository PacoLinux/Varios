
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:1    
        1        1        /*M* ZIG$DDY1         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        LOCK:
        8        8            PROC;
        9        9    1   DCL W25$ PTR;
       10       10    1   DCL 1 W25 BASED(W25$),
       11       11    1         2 * CHAR(100);
       12       12        %INCLUDE ZIG_FIVESTAR_DESC;
       13       55    1   DCL LCKED SBIN STATIC INIT(0);
       14       56    1   DCL BUFSZ UBIN WORD STATIC INIT(25);
       15       57    1   DCL UNLCKED SBIN STATIC INIT(0);
       16       58    1   DCL LCKBTS BIT(36) BASED(PLB);
       17       59    1   DCL PLB PTR;
       18       60    1   DCL OL CHAR(128);
       19       61    1   DCL STYPE SBIN WORD STATIC;
       20       62    1   DCL NCS UBIN (36);
       21       63    1   DCL UNSC ENTRY(2);
       22       64    1   DCL BIT36 BIT(36) BASED;
       23       65    1   DCL REC CHAR(80) EXT;
       24       66         /* Input buffer */
       25       67        %INCLUDE ZIG_GENERAL;
       26      175        %INCLUDE ZI_SUB4_CAN;
       27      832        %UWA;
       28     1167        %INCLUDE ZIG_DIR_STRUCS;
       29     1297        %INCLUDE ZIG_DBA_INT;
       30     1345    1   DCL FIVESTAREOF UBIN(36) STATIC;
       31     1346    1   DCL C20 CHAR(20);
       32     1347    1   DCL LCKBTS_RDEF(0:35) BIT(1) BASED(PLB);
       33     1348    1   DCL RDYPL ENTRY;
       34     1349         /* Read routine */
       35     1350         /* Internal environment */
       36     1351    1   DCL X SBIN STATIC INIT(0);
       37     1352    1   DCL NOLK SBIN STATIC INIT(0);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:2    
       38     1353         /* */
       39     1354    1   DCL SPTR PTR;
       40     1355    1   DCL MSK_18B(0:5) BIT(18) BASED;
       41     1356    1   DCL PP PTR;
       42     1357    1   DCL LPTR PTR;
       43     1358    1   DCL ETYP SBIN(17);
       44     1359    1   DCL ELM_TYP(0:4) CHAR(6) STATIC INIT('SCHEMA', 'AREA', 'SET',
       45     1360    1    'RECORD','FIELD');
       46     1361    1   DCL SB36 BIT(36) STATIC INIT('0'B);
       47     1362    1   DCL LKV CHAR(12);
       48     1363    1   DCL HOLD_PLACE UBIN WORD;
       49     1364    1   DCL NEW_SN BIT(1) STATIC INIT('0'B);
       50     1365         /*Contains privacy key found in lk */
       51     1366    1   DCL R SBIN WORD STATIC INIT(0);
       52     1367    1   DCL S SBIN WORD STATIC INIT(0);
       53     1368    1   DCL T SBIN WORD STATIC INIT(0);
       54     1369    1   DCL LNAME CHAR(30);
       55     1370         /* LOCK_NAME extracted from */
       56     1371         /* Assignment statement */
       57     1372    1   DCL 01 SCRAMB(0:2) BASED(SPTR),/* Structure used to scramble
       58     1373         lock */
       59     1374         /* Value */
       60     1375    1         02 BITS1 BIT(5),
       61     1376    1         02 BITS2 BIT(31);
       62     1377    1   DCL 01 UNSCRAMB(0:2) BASED(SPTR),
       63     1378    1         02 UBITS1 BIT(31),
       64     1379    1         02 UBITS2 BIT(5);
       65     1380    1   DCL 1 LVALUE BASED(LPTR), /* used to move scrambled lock value */
       66     1381    1         2 B1 BIT(31) UNAL,
       67     1382    1         2 B2 BIT(5) UNAL,
       68     1383    1         2 B3 BIT(31) UNAL,
       69     1384    1         2 B4 BIT(5) UNAL,
       70     1385    1         2 B5 BIT(31) UNAL,
       71     1386    1         2 B6 BIT(5) UNAL;
       72     1387    1   DCL C64 CHAR(64);
       73     1388    1   DCL C44 CHAR(44);
       74     1389    1   DCL B128 CHAR(128) STATIC INIT(' ');
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:3    
       75     1390    1   DCL C96 CHAR(96);
       76     1391    1   DCL C32 CHAR(32);
       77     1392    1   DCL C12 CHAR(12);
       78     1393    1   DCL CHR CHAR(CHR_LEN) BASED(CHR$);
       79     1394    1   DCL CHR$ PTR;
       80     1395    1   DCL CHR_LEN UBIN WORD;
       81     1396    1       CHR$ = ADDR(C32);
       82     1397    1       C64 = 'SECURITY LOCK PROCESSOR';
       83     1398    1       CALL SUBLST(C64);
       84     1399    1       OL = ' ';
       85     1400    1       CALL FETCHD_6('SF      ', 2) ALTRET(DBCS_ERR);
       86     1401         /* Get da */
       87     1402    1       CALL FETCHD_6('DA      ', UWA.SF.DBKEY_DA) ALTRET(DBCS_ERR);
       88     1403    1       CALL FETCHNS_6('DA-SN   ') ALTRET(DBCS_ERR);
       89     1404    1       IF LOCKS.SNAME ~= ' ' THEN
       90     1405    2           IF UWA.SN.SENAME ~= LOCKS.SNAME THEN DO;
       91     1406    2               CALL CONCAT(OL,LOCKS.SNAME,' IS NOT NAME OF ASSIGNED SCHEMA FILE');
       92     1407    2               CALL LIST(OL);
       93     1408    2               GOTO CLOS;
       94     1409    2               END;
       95     1410         /*Record locks function attempted against schema*/
       96     1411    1       UWA.A_D.AD_FUNCTION = 4;
       97     1412    1       CALL GET_TIME(UWA.A_D.AD_DATE);
       98     1413    1       UWA.A_D.AD_IDENT = ' ';
       99     1414    1       X = 54;
      100     1415    1       ADDR(PP)->MSK_18B(1) = ADDR(X)->MSK_18B(2);
      101     1416    1       CALL STRE_6('A-D     ') ALTRET(DBCS_ERR);
      102     1417    1       PLB = ADDR(UWA.SN.ACTLCKS);
      103     1418    1       IF LCKBTS_RDEF(2) = '0'B THEN GOTO CK_LKV;
      104     1419    1       PLB = ADDR(UWA.LT.PLOCKS);
      105     1420    1   CHECK_NEXT:
      106     1421    1       CALL FETCHNS_6('SN-LT   ') ALTRET(L3);
      107     1422    1       IF LCKBTS_RDEF(2) = '0'B THEN GOTO CHECK_NEXT;
      108     1423    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);
      109     1424         /* Unscramble key */
      110     1425    1       CALL UNSC(UWA.LK.PLVALUE,LKV);
      111     1426    1       IF LOCKS.LOCKS_KEY = LKV THEN GOTO CK_LKV;
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:4    
      112     1427    1       GOTO CHECK_NEXT;
      113     1428    1   CK_LKV:
      114     1429    1       PLB = ADDR(UWA.LT.PLOCKS);
      115     1430    1       IF LOCKS.ASSIGNS THEN
      116     1431    2       DO;
      117     1432    2           CALL UOPEN ('5*',0);
      118     1433    2           CALL UGET('5*',W25$,FIVESTAREOF,BUFSZ);
      119     1434    2           LOCK_DESC = W25;
      120     1435    2           OL = 'LOCK NAME ASSIGNMENT MESSAGES';
      121     1436    2           CALL LIST(OL);
      122     1437    3           DO WHILE(FIVESTAREOF= 0);
      123     1438         /* Get lock-name */
      124     1439         /* * */
      125     1440    3   OUT1:
      126     1441    3               LNAME = LOCK_DESC.LOCK_NAME;
      127     1442         /* Get lock value */
      128     1443    3               IF LOCK_DESC.NULLL THEN
      129     1444    3                   LKV = '"NULL"';
      130     1445    3               ELSE
      131     1446    3                   LKV = LOCK_DESC.LOCK_VALUE;
      132     1447         /* Set calc fields for fetchc */
      133     1448    3               UWA.LK.PLNAME = LNAME;
      134     1449         /* Get lk element */
      135     1450    3               CALL FETCHC_6('LK        ') ALTRET(L5);
      136     1451    4               IF LKV = '"NULL"' THEN DO;
      137     1452         /* Modify the lk element then reset the locked
      138     1453         bits in each si element */
      139     1454    4                   UWA.LK.PLVALUE = LKV;
      140     1455    4                   CALL MODIFY_6('LK      ') ALTRET(DBCS_ERR);
      141     1456    5                   DO WHILE('1'B);
      142     1457    5                       CALL FETCHNS_6('LK-LT   ') ALTRET(RD);
      143     1458    5                       CALL FETCHOS_6('SN-LT   ') ALTRET(DBCS_ERR);
      144     1459    5                       UWA.SN.ACTLCKS = 0;
      145     1460    5                       CALL MODIFY_6('SN      ') ALTRET(DBCS_ERR);
      146     1461    6                       DO WHILE('1'B);
      147     1462    6                           CALL FETCHNS_6('SN-SI   ') ALTRET(UN1);
      148     1463    6                           UWA.SI.LOCKED = 0;
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:5    
      149     1464    6                           CALL MODIFY_6('SI      ') ALTRET(DBCS_ERR);
      150     1465    6                           END;
      151     1466    5   UN1:
      152     1467    5                       END;
      153     1468    4                   END;
      154     1469    4               ELSE DO;
      155     1470         /* Scramble lock value */
      156     1471    4                   LPTR = ADDR(UWA.LK.PLVALUE);
      157     1472    4                   SPTR = ADDR(LKV);
      158     1473    4                   LVALUE.B1 = SCRAMB.BITS2(0);
      159     1474    4                   LVALUE.B2 = SCRAMB.BITS1(0);
      160     1475    4                   LVALUE.B3 = SCRAMB.BITS2(1);
      161     1476    4                   LVALUE.B4 = SCRAMB.BITS1(1);
      162     1477    4                   LVALUE.B5 = SCRAMB.BITS2(2);
      163     1478    4                   LVALUE.B6 = SCRAMB.BITS1(2);
      164     1479    4                   CALL MODIFY_6('LK      ') ALTRET(DBCS_ERR);
      165     1480    4                   END;
      166     1481         /* * */
      167     1482         /* * */
      168     1483    3   RD:
      169     1484         /* Read next assignment statement */
      170     1485    3               CALL UGET('5*',W25$,FIVESTAREOF,BUFSZ);
      171     1486    3               LOCK_DESC = W25;
      172     1487    3               END;
      173     1488    2           CALL UCLOSE('5*');
      174     1489    2           OL = 'END LOCK NAME ASSIGNMENTS';
      175     1490    2           CALL LIST(OL);
      176     1491    2           END;
      177     1492         /**
      178     1493            Set all privacy lock bits in sn
      179     1494            and si
      180     1495            */
      181     1496    1       CALL RDYPL;
      182     1497    1       IF LOCKS.LIST = '0'B THEN RETURN;
      183     1498    1       CALL FETCHD_6('SF      ',2) ALTRET(DBCS_ERR);
      184     1499    1       OL = '****';
      185     1500    1       CALL LIST(OL);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:6    
      186     1501    1       OL = 'LOCK NAME/LOCK VALUE SUMMARY***';
      187     1502    1       CALL LIST(OL);
      188     1503    1       CALL LIST(B128);
      189     1504    1       OL = 'LOCK NAME                        LOCK VALUE';
      190     1505    1       CALL LIST(OL);
      191     1506    1       CALL LIST(B128);
      192     1507    1       CALL FETCHD_6('DA      ',UWA.SF.DBKEY_DA) ALTRET(DBCS_ERR);
      193     1508    1   NEXT_LK1:
      194     1509    1       CALL FETCHNS_6('DA-LK   ') ALTRET(LCKD_ELM_LST);
      195     1510    1       IF UWA.LK.PLVALUE = '"NULL"' THEN CALL CONCAT(OL,UWA.LK.PLNAME,'   NULL');
      196     1511    2       ELSE DO;
      197     1512    2           CALL UNSC(UWA.LK.PLVALUE,LKV);
      198     1513    2           CALL QTE(LKV);
      199     1514    2           CALL CONCAT(OL,UWA.LK.PLNAME,'   ',CHR);
      200     1515    2           END;
      201     1516    1       CALL LIST(OL);
      202     1517    1       GOTO NEXT_LK1;
      203     1518    1   LCKD_ELM_LST:
      204     1519    1       OL = '****';
      205     1520    1       CALL LIST(OL);
      206     1521    1       OL = 'RESTRICTED FUNCTIONS WHICH ARE LOCKED***';
      207     1522    1       CALL LIST(OL);
      208     1523    1       CALL LIST(B128);
      209     1524    1       C64 = 'SCHEMA ELEMENT NAME               TYPE       FUNCTIONS          ';
      210     1525    1       CALL CONCAT(OL,C64,'LOCK NAME                       LOCK VALUE');
      211     1526    1       CALL LIST(OL);
      212     1527    1       CALL LIST(B128);
      213     1528    1       CALL FCURR_R_6('DA      ') ALTRET(DBCS_ERR);
      214     1529    1       UWA.SN.SETYPE = 0;
      215     1530    1       OL = ' ';
      216     1531    1   NEXT_SN1:
      217     1532    1       CALL FETCH_AN_SN ALTRET(ULCKD_ELM_LST);
      218     1533    1       IF UWA.SN.ACTLCKS = 0 THEN GOTO NEXT_SN1;
      219     1534    1       LCKED = LCKED + 1;
      220     1535    1       CALL LIST(B128);
      221     1536    1   NEXT_LT1:
      222     1537    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN1);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:7    
      223     1538    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);
      224     1539    1   CHECK_LT:
      225     1540    1       SB36 = '0'B;
      226     1541    1       SB36 = ADDR(UWA.LT.PLOCKS)->BIT36 |
      227     1542    1          ADDR(UWA.SN.ACTLCKS)->BIT36;
      228     1543    1       IF SB36 ~= ADDR(UWA.SN.ACTLCKS)->BIT36 THEN GOTO
      229     1544    1              NEXT_LT1;
      230     1545    2       IF OL ~= ' ' THEN DO;
      231     1546    2           CALL LIST(OL);
      232     1547    2           OL = ' ';
      233     1548    2           CALL LIST(OL);
      234     1549    2           END;
      235     1550    1       ETYP = (UWA.SN.SETYPE / 10) - 1;
      236     1551    1       C44 = ' ';
      237     1552    1       IF NEW_SN THEN
      238     1553    1           IF UWA.SN.SETYPE = 50 THEN
      239     1554    1               CALL CONCAT(C44,'  ',UWA.SN.SENAME,'  ',ELM_TYP(ETYP),'    ');
      240     1555    1           ELSE
      241     1556    1               CALL CONCAT(C44,UWA.SN.SENAME,'    ',ELM_TYP(ETYP),'    ');
      242     1557    1       CALL FNCT(UWA.LT.PLOCKS);
      243     1558    1       CALL UNSC(UWA.LK.PLVALUE,C12);
      244     1559    1       CALL QTE(C12);
      245     1560    1       CALL CONCAT(OL,C44,C20,UWA.LK.PLNAME,'  ',CHR);
      246     1561    1       CALL LIST(OL);
      247     1562    1       OL = ' ';
      248     1563    1       STYPE = UWA.LT.PLOCKS;
      249     1564    1       NEW_SN = '0'B;
      250     1565    1   CHK_OR:
      251     1566    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN1);
      252     1567    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);
      253     1568    1       IF UWA.LT.PLOCKS ~= STYPE THEN GOTO CHECK_LT;
      254     1569    1       C64 = ' ';
      255     1570    1       CALL UNSC(UWA.LK.PLVALUE,C12);
      256     1571    1       CALL QTE(C12);
      257     1572    1       CALL CONCAT(OL,C64,UWA.LK.PLNAME,'  ',CHR);
      258     1573    1       CALL LIST(OL);
      259     1574    1       OL = ' ';
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:8    
      260     1575    1       GOTO CHK_OR;
      261     1576    1   ULCKD_ELM_LST:
      262     1577    2       IF LCKED = 0 THEN DO;
      263     1578    2           CALL LIST(B128);
      264     1579    2           OL = 'ALL DML FUNCTIONS ARE UNLOCKED';
      265     1580    2           CALL LIST(OL);
      266     1581    2           END;
      267     1582    1       OL = '****';
      268     1583    1       CALL LIST(OL);
      269     1584    1       OL = 'RESTRICTED FUNCTIONS WHICH ARE UNLOCKED***';
      270     1585    1       CALL LIST(OL);
      271     1586    1       CALL LIST(B128);
      272     1587    1       C64 = 'SCHEMA ELEMENT NAME               TYPE       FUNCTIONS          ';
      273     1588    1       CALL CONCAT(OL,C64,'LOCK NAME                       LOCK VALUE');
      274     1589    1       CALL LIST(OL);
      275     1590    1       OL = ' ';
      276     1591    1       CALL LIST(B128);
      277     1592    1       CALL FCURR_R_6('DA      ') ALTRET(DBCS_ERR);
      278     1593    1       UWA.SN.SETYPE = 0;
      279     1594    1   NEXT_SN2:
      280     1595    1       CALL FETCH_AN_SN ALTRET(DO_USE_PROC);
      281     1596    1   NEXT_LT2:
      282     1597    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN2);
      283     1598    1   CONTINUE_LT:
      284     1599    1       SB36 = '0'B;
      285     1600    1       SB36 = ADDR(UWA.SN.ACTLCKS)->BIT36 |
      286     1601    1          ADDR(UWA.LT.PLOCKS)->BIT36;
      287     1602    1       IF SB36 = ADDR(UWA.SN.ACTLCKS)->BIT36 THEN GOTO
      288     1603    1              NEXT_LT2;
      289     1604    1       UNLCKED = UNLCKED + 1;
      290     1605    1       IF NEW_SN THEN CALL LIST(B128);
      291     1606    2       IF OL ~= ' ' THEN DO;
      292     1607    2           CALL LIST(OL);
      293     1608    2           CALL LIST(B128);
      294     1609    2           OL = ' ';
      295     1610    2           END;
      296     1611    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:9    
      297     1612    1       ETYP = (UWA.SN.SETYPE / 10) - 1;
      298     1613    1       C44 = ' ';
      299     1614    1       IF NEW_SN THEN
      300     1615    1           IF UWA.SN.SETYPE = 50 THEN
      301     1616    1               CALL CONCAT(C44,'  ',UWA.SN.SENAME,'  ',ELM_TYP(ETYP),'    ');
      302     1617    1           ELSE
      303     1618    1               CALL CONCAT(C44,UWA.SN.SENAME,'    ',ELM_TYP(ETYP),'    ');
      304     1619    1       CALL FNCT(UWA.LT.PLOCKS);
      305     1620    2       IF UWA.LK.PLVALUE = '"NULL"' THEN DO;
      306     1621    2           CALL CONCAT(OL,C44,C20,UWA.LK.PLNAME,'  ','NULL');
      307     1622    2           END;
      308     1623    2       ELSE DO;
      309     1624    2           CALL UNSC(UWA.LK.PLVALUE,C12);
      310     1625    2           CALL QTE(C12);
      311     1626    2           CALL CONCAT(OL,C44,C20,UWA.LK.PLNAME,'  ',CHR);
      312     1627    2           END;
      313     1628    1       CALL LIST(OL);
      314     1629    1       OL = ' ';
      315     1630    1       STYPE = UWA.LT.PLOCKS;
      316     1631    1       NEW_SN = '0'B;
      317     1632    1   CHK_OR2:
      318     1633    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN2);
      319     1634    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);
      320     1635    1       IF UWA.LT.PLOCKS ~= STYPE THEN GOTO CONTINUE_LT;
      321     1636    1       C64 = ' ';
      322     1637    1       CALL CONCAT(C96,C64,UWA.LK.PLNAME,'  ');
      323     1638    1       CHR_LEN = 4;
      324     1639    1       IF UWA.LK.PLVALUE = '"NULL"' THEN CHR = 'NULL';
      325     1640    2       ELSE DO;
      326     1641    2           CALL UNSC(UWA.LK.PLVALUE,LKV);
      327     1642    2           CALL QTE(LKV);
      328     1643    2           END;
      329     1644    1       CALL CONCAT(OL,C96,CHR);
      330     1645    1       CALL LIST(OL);
      331     1646    1       OL = ' ';
      332     1647    1       GOTO CHK_OR2;
      333     1648    1   FNCT:
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:10   
      334     1649    1       PROC(LTYPES);
      335     1650    2   DCL LTYPES SBIN(36);
      336     1651    2   DCL P PTR;
      337     1652    2   DCL B36(0:35) BIT(1) BASED(P);
      338     1653    2   DCL Y UBIN WORD;
      339     1654    2   DCL FTYP(0:15) CHAR(2) STATIC INIT(' C',' D',' L',' A',
      340     1655    2   '  ','  ','  ','  ','  ',' G',' M',' S',' D',' I',' R',' F');
      341     1656    2       P = ADDR(LTYPES);
      342     1657    2       C20 = ' ';
      343     1658    2       Y = 0;
      344     1659    3       DO X = 0 TO 15;
      345     1660    4           IF B36(X) = '1'B THEN DO;
      346     1661    4               CALL INSERT(C20,Y,2,FTYP(X));
      347     1662    4               Y = Y + 2;
      348     1663    4               END;
      349     1664    3           END;
      350     1665    2   END;
      351     1666    1   FETCH_AN_SN:
      352     1667    1       PROC ALTRET;
      353     1668    2       NEW_SN = '1'B;
      354     1669    3       IF UWA.SN.SETYPE = 40 THEN DO;
      355     1670    3           CALL FCURR_R_6('SN      ') ALTRET(DBCS_ERR);
      356     1671    3           HOLD_PLACE = UWA.DIRECT_REF;
      357     1672    3           IF UWA.SN.ACTLCKS = 0 THEN OL = UWA.SN.SENAME;
      358     1673    3           CALL FETCHNS_6('SN-SE   ') ALTRET(DBCS_ERR);
      359     1674    3   NEXT_FR:
      360     1675    3           CALL FETCHNS_6('RC-FR   ')ALTRET(RESET_DASN);
      361     1676    3           IF UWA.FR.SYN ~= 0 THEN GOTO NEXT_FR;
      362     1677    3           CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERR);
      363     1678    3           RETURN;
      364     1679    3           END;
      365     1680    3       IF UWA.SN.SETYPE = 50 THEN DO;
      366     1681    3           CALL FETCHNS_6('RC-FR   ') ALTRET(RESET_DASN);
      367     1682    3           CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERR);
      368     1683    3           RETURN;
      369     1684    3           END;
      370     1685    2   NORMAL:
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:11   
      371     1686    2       CALL FETCHNS_6('DA-SN   ') ALTRET(ALT_END);
      372     1687    2       IF UWA.SN.SETYPE = 50 THEN GOTO NORMAL;
      373     1688    2       RETURN;
      374     1689    2   RESET_DASN:
      375     1690    2       CALL FINDD_6('SN      ',HOLD_PLACE) ALTRET(DBCS_ERR);
      376     1691    2       OL = ' ';
      377     1692    2       GOTO NORMAL;
      378     1693    2   ALT_END: ALTRETURN;
      379     1694    2   DBCS_ERR: CALL ABORT;
      380     1695    2   END;
      381     1696    1   QTE:
      382     1697    1       PROC(CST);
      383     1698    2   DCL CST CHAR(12);
      384     1699    2       CALL INDEX1(CHR_LEN,' ',CST);
      385     1700    2       CHR_LEN = CHR_LEN + 1;
      386     1701    2       CALL CONCAT(CHR,'"',CST);
      387     1702    2       CHR_LEN = CHR_LEN + 1;
      388     1703    2       CALL INSERT(CHR,CHR_LEN - 1,1,'"');
      389     1704    2   END;
      390     1705    1   DO_USE_PROC:
      391     1706    2       IF UNLCKED = 0 THEN DO;
      392     1707    2           CALL LIST(B128);
      393     1708    2           OL = 'ALL DML FUNCTIONS REFERENCED BY LOCK';
      394     1709    2           CALL LIST(OL);
      395     1710    2           OL = 'VARIABLES ARE LOCKED.';
      396     1711    2           CALL LIST(OL);
      397     1712    2           END;
      398     1713    1   CLOS:
      399     1714    1       RETURN;
      400     1715    1   L3:
      401     1716    1       CALL CONCAT(OL,'ILLEGAL PRIVACY KEY - ' , LOCKS.LOCKS_KEY);
      402     1717    1       CALL LIST(OL);
      403     1718    1       GOTO CLOS;
      404     1719    1   L5:
      405     1720    1       CALL CONCAT(OL,LNAME , ' LOCK NAME NOT IN DICTIONARY');
      406     1721    1       CALL LIST(OL);
      407     1722    1       GOTO RD;
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:12   
      408     1723    1   DBCS_ERR:
      409     1724    1       CALL ABORT;
      410     1725    1   END;

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:13   
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_FIVESTAR_DESC.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure LOCK.

   Procedure LOCK requires 1025 words for executable code.
   Procedure LOCK requires 132 words of local(AUTO) storage.

    No errors detected in file ZIG$DDY1.:ZIC0TSI    .

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:14   

 Object Unit name= LOCK                                       File name= ZIG$DDY1.:ZIC0TOU
 UTS= SEP 05 '97 11:54:00.08 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    25     31  DESC
    1   Data  even  none    98    142  LOCK
    2  LblCom even  none    20     24  REC
    3  LblCom even  none     1      1  NUM_ERROR_MSG
    4  LblCom even  none     1      1  NUM_WARN_MSG
    5  LblCom even  none     1      1  ALLOCATE_END
    6  LblCom even  none     2      2  SUBSCHEMA_KEY
    7  LblCom even  none     1      1  BUFFER$
    8  LblCom even  none     1      1  ERROR_IO
    9  LblCom even  none     1      1  BUFFER_LEN
   10  LblCom even  none     2      2  UWA_KEY
   11  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   12  LblCom even  none     2      2  RVA_KEY
   13  LblCom even  none     2      2  IA__KEY
   14  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   15  LblCom even  none    32     40  SEARCHR_NB
   16  LblCom even  none    32     40  SEM_COM
   17  LblCom even  none    32     40  DMCL_XLATE
   18  LblCom even  none    32     40  Q2_PERCENT
   19  LblCom even  none   656   1220  UWA
   20  LblCom even  none    12     14  ANALS
   21  LblCom even  none    13     15  PURGE
   22  LblCom even  none    19     23  DICTS
   23  LblCom even  none    23     27  DISPS
   24  LblCom even  none    22     26  VALIDS
   25  LblCom even  none    12     14  LOCKS
   26  LblCom even  none    10     12  STRAN
   27  LblCom even  none    12     14  DTRAN
   28  LblCom even  none    16     20  SSTRANS
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:15   
   29  LblCom even  none    20     24  SSGEN
   30  RoData even  UTS    167    247  LOCK
   31   Proc  even  none  1025   2001  LOCK
   32  RoData even  none    31     37  LOCK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    31      0   yes            yes      Std        0  LOCK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 SUBLST
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHOS_6
         yes           Std       2 UOPEN
         yes           Std       4 UGET
 yes     yes           Std       1 FETCHNS_6
         yes           Std       1 LIST
 yes     yes           Std       1 STRE_6
 yes     yes           Std       1 FETCHC_6
         yes           Std       0 RDYPL
         yes           Std       2 UNSC
 yes     yes           Std       1 FCURR_R_6
         yes           Std       1 GET_TIME
         yes           Std       1 UCLOSE
         yes           Std       0 ABORT
 yes     yes           Std       1 MODIFY_6
 yes     yes           Std       2 FINDD_6
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:16   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:17   


        1        1        /*M* ZIG$DDY1         I-D-S/II            DBACS    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        LOCK:
        8        8            PROC;

      8 31 000000   000000 700200 xent  LOCK         TSX0  ! X66_AUTO_0
        31 000001   000204 000000                    ZERO    132,0

        9        9    1   DCL W25$ PTR;
       10       10    1   DCL 1 W25 BASED(W25$),
       11       11    1         2 * CHAR(100);
       12       12        %INCLUDE ZIG_FIVESTAR_DESC;
       13       55    1   DCL LCKED SBIN STATIC INIT(0);
       14       56    1   DCL BUFSZ UBIN WORD STATIC INIT(25);
       15       57    1   DCL UNLCKED SBIN STATIC INIT(0);
       16       58    1   DCL LCKBTS BIT(36) BASED(PLB);
       17       59    1   DCL PLB PTR;
       18       60    1   DCL OL CHAR(128);
       19       61    1   DCL STYPE SBIN WORD STATIC;
       20       62    1   DCL NCS UBIN (36);
       21       63    1   DCL UNSC ENTRY(2);
       22       64    1   DCL BIT36 BIT(36) BASED;
       23       65    1   DCL REC CHAR(80) EXT;
       24       66         /* Input buffer */
       25       67        %INCLUDE ZIG_GENERAL;
       26      175        %INCLUDE ZI_SUB4_CAN;
       27      832        %UWA;
       28     1167        %INCLUDE ZIG_DIR_STRUCS;
       29     1297        %INCLUDE ZIG_DBA_INT;
       30     1345    1   DCL FIVESTAREOF UBIN(36) STATIC;
       31     1346    1   DCL C20 CHAR(20);
       32     1347    1   DCL LCKBTS_RDEF(0:35) BIT(1) BASED(PLB);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:18   
       33     1348    1   DCL RDYPL ENTRY;
       34     1349         /* Read routine */
       35     1350         /* Internal environment */
       36     1351    1   DCL X SBIN STATIC INIT(0);
       37     1352    1   DCL NOLK SBIN STATIC INIT(0);
       38     1353         /* */
       39     1354    1   DCL SPTR PTR;
       40     1355    1   DCL MSK_18B(0:5) BIT(18) BASED;
       41     1356    1   DCL PP PTR;
       42     1357    1   DCL LPTR PTR;
       43     1358    1   DCL ETYP SBIN(17);
       44     1359    1   DCL ELM_TYP(0:4) CHAR(6) STATIC INIT('SCHEMA', 'AREA', 'SET',
       45     1360    1    'RECORD','FIELD');
       46     1361    1   DCL SB36 BIT(36) STATIC INIT('0'B);
       47     1362    1   DCL LKV CHAR(12);
       48     1363    1   DCL HOLD_PLACE UBIN WORD;
       49     1364    1   DCL NEW_SN BIT(1) STATIC INIT('0'B);
       50     1365         /*Contains privacy key found in lk */
       51     1366    1   DCL R SBIN WORD STATIC INIT(0);
       52     1367    1   DCL S SBIN WORD STATIC INIT(0);
       53     1368    1   DCL T SBIN WORD STATIC INIT(0);
       54     1369    1   DCL LNAME CHAR(30);
       55     1370         /* LOCK_NAME extracted from */
       56     1371         /* Assignment statement */
       57     1372    1   DCL 01 SCRAMB(0:2) BASED(SPTR),/* Structure used to scramble
       58     1373         lock */
       59     1374         /* Value */
       60     1375    1         02 BITS1 BIT(5),
       61     1376    1         02 BITS2 BIT(31);
       62     1377    1   DCL 01 UNSCRAMB(0:2) BASED(SPTR),
       63     1378    1         02 UBITS1 BIT(31),
       64     1379    1         02 UBITS2 BIT(5);
       65     1380    1   DCL 1 LVALUE BASED(LPTR), /* used to move scrambled lock value */
       66     1381    1         2 B1 BIT(31) UNAL,
       67     1382    1         2 B2 BIT(5) UNAL,
       68     1383    1         2 B3 BIT(31) UNAL,
       69     1384    1         2 B4 BIT(5) UNAL,
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:19   
       70     1385    1         2 B5 BIT(31) UNAL,
       71     1386    1         2 B6 BIT(5) UNAL;
       72     1387    1   DCL C64 CHAR(64);
       73     1388    1   DCL C44 CHAR(44);
       74     1389    1   DCL B128 CHAR(128) STATIC INIT(' ');
       75     1390    1   DCL C96 CHAR(96);
       76     1391    1   DCL C32 CHAR(32);
       77     1392    1   DCL C12 CHAR(12);
       78     1393    1   DCL CHR CHAR(CHR_LEN) BASED(CHR$);
       79     1394    1   DCL CHR$ PTR;
       80     1395    1   DCL CHR_LEN UBIN WORD;
       81     1396    1       CHR$ = ADDR(C32);

   1396 31 000002   200156 630500                    EPPR0   C32,,AUTO
        31 000003   200171 450500                    STP0    CHR$,,AUTO

       82     1397    1       C64 = 'SECURITY LOCK PROCESSOR';

   1397 31 000004   040100 100400                    MLR     fill='040'O
        31 000005   000000 000027 30                 ADSC9   0                        cn=0,n=23
        31 000006   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64

       83     1398    1       CALL SUBLST(C64);

   1398 31 000007   200073 631500                    EPPR1   C64,,AUTO
        31 000010   200200 451500                    STP1    Y+1,,AUTO
        31 000011   200200 630500                    EPPR0   Y+1,,AUTO
        31 000012   000000 631400 32                 EPPR1   0
        31 000013   000000 701000 xent               TSX1    SUBLST
        31 000014   000000 011000                    NOP     0

       84     1399    1       OL = ' ';

   1399 31 000015   040100 100400                    MLR     fill='040'O
        31 000016   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000017   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:20   
       85     1400    1       CALL FETCHD_6('SF      ', 2) ALTRET(DBCS_ERR);

   1400 31 000020   000004 630400 32                 EPPR0   4
        31 000021   000002 631400 32                 EPPR1   2
        31 000022   000000 701000 xent               TSX1    FETCHD_6
        31 000023   001775 702000 31                 TSX2    DBCS_ERR

       86     1401         /* Get da */
       87     1402    1       CALL FETCHD_6('DA      ', UWA.SF.DBKEY_DA) ALTRET(DBCS_ERR);

   1402 31 000024   000006 630400 32                 EPPR0   6
        31 000025   000002 631400 32                 EPPR1   2
        31 000026   000000 701000 xent               TSX1    FETCHD_6
        31 000027   001775 702000 31                 TSX2    DBCS_ERR

       88     1403    1       CALL FETCHNS_6('DA-SN   ') ALTRET(DBCS_ERR);

   1403 31 000030   000010 630400 32                 EPPR0   8
        31 000031   000000 631400 32                 EPPR1   0
        31 000032   000000 701000 xent               TSX1    FETCHNS_6
        31 000033   001775 702000 31                 TSX2    DBCS_ERR

       89     1404    1       IF LOCKS.SNAME ~= ' ' THEN

   1404 31 000034   040000 106400                    CMPC    fill='040'O
        31 000035   000004 000036 25                 ADSC9   LOCKS+4                  cn=0,n=30
        31 000036   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000037   000061 600000 31                 TZE     s:1411

       90     1405    2           IF UWA.SN.SENAME ~= LOCKS.SNAME THEN DO;

   1405 31 000040   040000 106400                    CMPC    fill='040'O
        31 000041   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30
        31 000042   000004 000036 25                 ADSC9   LOCKS+4                  cn=0,n=30
        31 000043   000061 600000 31                 TZE     s:1411

       91     1406    2               CALL CONCAT(OL,LOCKS.SNAME,' IS NOT NAME OF ASSIGNED SCHEMA FILE');
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:21   

   1406 31 000044   040100 100400                    MLR     fill='040'O
        31 000045   000004 000036 25                 ADSC9   LOCKS+4                  cn=0,n=30
        31 000046   200005 000036                    ADSC9   OL,,AUTO                 cn=0,n=30
        31 000047   040100 100400                    MLR     fill='040'O
        31 000050   000014 000044 30                 ADSC9   12                       cn=0,n=36
        31 000051   200014 400142                    ADSC9   OL+7,,AUTO               cn=2,n=98

       92     1407    2               CALL LIST(OL);

   1407 31 000052   200005 630500                    EPPR0   OL,,AUTO
        31 000053   200200 450500                    STP0    Y+1,,AUTO
        31 000054   200200 630500                    EPPR0   Y+1,,AUTO
        31 000055   000000 631400 32                 EPPR1   0
        31 000056   000000 701000 xent               TSX1    LIST
        31 000057   000000 011000                    NOP     0

       93     1408    2               GOTO CLOS;

   1408 31 000060   001742 710000 31                 TRA     CLOS

       94     1409    2               END;
       95     1410         /*Record locks function attempted against schema*/
       96     1411    1       UWA.A_D.AD_FUNCTION = 4;

   1411 31 000061   000004 235007                    LDA     4,DL
        31 000062   000170 755000 19                 STA     UWA+120

       97     1412    1       CALL GET_TIME(UWA.A_D.AD_DATE);

   1412 31 000063   000011 630400 32                 EPPR0   9
        31 000064   000000 631400 32                 EPPR1   0
        31 000065   000000 701000 xent               TSX1    GET_TIME
        31 000066   000000 011000                    NOP     0

       98     1413    1       UWA.A_D.AD_IDENT = ' ';

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:22   
   1413 31 000067   040000 100400                    MLR     fill='040'O
        31 000070   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000071   000174 000074 19                 ADSC9   UWA+124                  cn=0,n=60

       99     1414    1       X = 54;

   1414 31 000072   000066 235007                    LDA     54,DL
        31 000073   000053 755000 1                  STA     X

      100     1415    1       ADDR(PP)->MSK_18B(1) = ADDR(X)->MSK_18B(2);

   1415 31 000074   000054 220000 1                  LDX0    NOLK
        31 000075   200054 440100                    SXL0    PP,,AUTO

      101     1416    1       CALL STRE_6('A-D     ') ALTRET(DBCS_ERR);

   1416 31 000076   000012 630400 32                 EPPR0   10
        31 000077   000000 631400 32                 EPPR1   0
        31 000100   000000 701000 xent               TSX1    STRE_6
        31 000101   001775 702000 31                 TSX2    DBCS_ERR

      102     1417    1       PLB = ADDR(UWA.SN.ACTLCKS);

   1417 31 000102   000013 236000 32                 LDQ     11
        31 000103   200004 756100                    STQ     PLB,,AUTO

      103     1418    1       IF LCKBTS_RDEF(2) = '0'B THEN GOTO CK_LKV;

   1418 31 000104   200004 470500                    LDP0    PLB,,AUTO
        31 000105   000000 066500                    CMPB    filb='0'B
        31 000106   000000 020001                    BDSC    0,,PR0                   by=0,bit=2,n=1
        31 000107   000014 000022 32                 BDSC    12                       by=0,bit=0,n=18
        31 000110   000145 600000 31                 TZE     CK_LKV

      104     1419    1       PLB = ADDR(UWA.LT.PLOCKS);

   1419 31 000111   000015 236000 32                 LDQ     13
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:23   
        31 000112   200004 756100                    STQ     PLB,,AUTO

      105     1420    1   CHECK_NEXT:
      106     1421    1       CALL FETCHNS_6('SN-LT   ') ALTRET(L3);

   1421 31 000113   000016 630400 32    CHECK_NEXT   EPPR0   14
        31 000114   000000 631400 32                 EPPR1   0
        31 000115   000000 701000 xent               TSX1    FETCHNS_6
        31 000116   001743 702000 31                 TSX2    L3

      107     1422    1       IF LCKBTS_RDEF(2) = '0'B THEN GOTO CHECK_NEXT;

   1422 31 000117   200004 470500                    LDP0    PLB,,AUTO
        31 000120   000000 066500                    CMPB    filb='0'B
        31 000121   000000 020001                    BDSC    0,,PR0                   by=0,bit=2,n=1
        31 000122   000014 000022 32                 BDSC    12                       by=0,bit=0,n=18
        31 000123   000113 600000 31                 TZE     CHECK_NEXT

      108     1423    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);

   1423 31 000124   000017 630400 32                 EPPR0   15
        31 000125   000000 631400 32                 EPPR1   0
        31 000126   000000 701000 xent               TSX1    FETCHOS_6
        31 000127   001775 702000 31                 TSX2    DBCS_ERR

      109     1424         /* Unscramble key */
      110     1425    1       CALL UNSC(UWA.LK.PLVALUE,LKV);

   1425 31 000130   200057 630500                    EPPR0   LKV,,AUTO
        31 000131   200201 450500                    STP0    Y+2,,AUTO
        31 000132   000020 236000 32                 LDQ     16
        31 000133   200200 756100                    STQ     Y+1,,AUTO
        31 000134   200200 630500                    EPPR0   Y+1,,AUTO
        31 000135   000002 631400 32                 EPPR1   2
        31 000136   000000 701000 xent               TSX1    UNSC
        31 000137   000000 011000                    NOP     0

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:24   
      111     1426    1       IF LOCKS.LOCKS_KEY = LKV THEN GOTO CK_LKV;

   1426 31 000140   040100 106400                    CMPC    fill='040'O
        31 000141   000001 000014 25                 ADSC9   LOCKS+1                  cn=0,n=12
        31 000142   200057 000014                    ADSC9   LKV,,AUTO                cn=0,n=12
        31 000143   000145 600000 31                 TZE     CK_LKV

      112     1427    1       GOTO CHECK_NEXT;

   1427 31 000144   000113 710000 31                 TRA     CHECK_NEXT

      113     1428    1   CK_LKV:
      114     1429    1       PLB = ADDR(UWA.LT.PLOCKS);

   1429 31 000145   000015 236000 32    CK_LKV       LDQ     13
        31 000146   200004 756100                    STQ     PLB,,AUTO

      115     1430    1       IF LOCKS.ASSIGNS THEN

   1430 31 000147   000000 236000 25                 LDQ     LOCKS
        31 000150   020000 316003                    CANQ    8192,DU
        31 000151   000365 600000 31                 TZE     s:1496

      116     1431    2       DO;

      117     1432    2           CALL UOPEN ('5*',0);

   1432 31 000152   000021 630400 32                 EPPR0   17
        31 000153   000002 631400 32                 EPPR1   2
        31 000154   000000 701000 xent               TSX1    UOPEN
        31 000155   000000 011000                    NOP     0

      118     1433    2           CALL UGET('5*',W25$,FIVESTAREOF,BUFSZ);

   1433 31 000156   000024 237000 32                 LDAQ    20
        31 000157   200202 757100                    STAQ    Y+3,,AUTO
        31 000160   200003 630500                    EPPR0   W25$,,AUTO
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:25   
        31 000161   200201 450500                    STP0    Y+2,,AUTO
        31 000162   000021 236000 32                 LDQ     17
        31 000163   200200 756100                    STQ     Y+1,,AUTO
        31 000164   200200 630500                    EPPR0   Y+1,,AUTO
        31 000165   000023 631400 32                 EPPR1   19
        31 000166   000000 701000 xent               TSX1    UGET
        31 000167   000000 011000                    NOP     0

      119     1434    2           LOCK_DESC = W25;

   1434 31 000170   200003 470500                    LDP0    W25$,,AUTO
        31 000171   000000 100500                    MLR     fill='000'O
        31 000172   000000 000144                    ADSC9   0,,PR0                   cn=0,n=100
        31 000173   000000 000144 0                  ADSC9   DESC                     cn=0,n=100

      120     1435    2           OL = 'LOCK NAME ASSIGNMENT MESSAGES';

   1435 31 000174   040100 100400                    MLR     fill='040'O
        31 000175   000034 000035 30                 ADSC9   28                       cn=0,n=29
        31 000176   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      121     1436    2           CALL LIST(OL);

   1436 31 000177   200005 631500                    EPPR1   OL,,AUTO
        31 000200   200200 451500                    STP1    Y+1,,AUTO
        31 000201   200200 630500                    EPPR0   Y+1,,AUTO
        31 000202   000000 631400 32                 EPPR1   0
        31 000203   000000 701000 xent               TSX1    LIST
        31 000204   000000 011000                    NOP     0

      122     1437    3           DO WHILE(FIVESTAREOF= 0);

   1437 31 000205   000052 235000 1                  LDA     FIVESTAREOF
        31 000206   000350 601000 31                 TNZ     s:1488

      123     1438         /* Get lock-name */
      124     1439         /* * */
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:26   
      125     1440    3   OUT1:
      126     1441    3               LNAME = LOCK_DESC.LOCK_NAME;

   1441 31 000207   040100 100400       OUT1         MLR     fill='040'O
        31 000210   000000 200036 0                  ADSC9   DESC                     cn=1,n=30
        31 000211   200063 000036                    ADSC9   LNAME,,AUTO              cn=0,n=30

      127     1442         /* Get lock value */
      128     1443    3               IF LOCK_DESC.NULLL THEN

   1443 31 000212   000000 234000 0                  SZN     DESC
        31 000213   000220 605000 31                 TPL     s:1446

      129     1444    3                   LKV = '"NULL"';

   1444 31 000214   040100 100400                    MLR     fill='040'O
        31 000215   000044 000006 30                 ADSC9   36                       cn=0,n=6
        31 000216   200057 000014                    ADSC9   LKV,,AUTO                cn=0,n=12
        31 000217   000223 710000 31                 TRA     s:1448

      130     1445    3               ELSE
      131     1446    3                   LKV = LOCK_DESC.LOCK_VALUE;

   1446 31 000220   040100 100400                    MLR     fill='040'O
        31 000221   000007 600014 0                  ADSC9   DESC+7                   cn=3,n=12
        31 000222   200057 000014                    ADSC9   LKV,,AUTO                cn=0,n=12

      132     1447         /* Set calc fields for fetchc */
      133     1448    3               UWA.LK.PLNAME = LNAME;

   1448 31 000223   040000 100500                    MLR     fill='040'O
        31 000224   200063 000036                    ADSC9   LNAME,,AUTO              cn=0,n=30
        31 000225   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30

      134     1449         /* Get lk element */
      135     1450    3               CALL FETCHC_6('LK        ') ALTRET(L5);

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:27   
   1450 31 000226   000026 630400 32                 EPPR0   22
        31 000227   000000 631400 32                 EPPR1   0
        31 000230   000000 701000 xent               TSX1    FETCHC_6
        31 000231   001760 702000 31                 TSX2    L5

      136     1451    4               IF LKV = '"NULL"' THEN DO;

   1451 31 000232   040000 106500                    CMPC    fill='040'O
        31 000233   200057 000014                    ADSC9   LKV,,AUTO                cn=0,n=12
        31 000234   000044 000006 30                 ADSC9   36                       cn=0,n=6
        31 000235   000275 601000 31                 TNZ     s:1471

      137     1452         /* Modify the lk element then reset the locked
      138     1453         bits in each si element */
      139     1454    4                   UWA.LK.PLVALUE = LKV;

   1454 31 000236   040000 100500                    MLR     fill='040'O
        31 000237   200057 000014                    ADSC9   LKV,,AUTO                cn=0,n=12
        31 000240   000447 400014 19                 ADSC9   UWA+295                  cn=2,n=12

      140     1455    4                   CALL MODIFY_6('LK      ') ALTRET(DBCS_ERR);

   1455 31 000241   000026 630400 32                 EPPR0   22
        31 000242   000000 631400 32                 EPPR1   0
        31 000243   000000 701000 xent               TSX1    MODIFY_6
        31 000244   001775 702000 31                 TSX2    DBCS_ERR

      141     1456    5                   DO WHILE('1'B);

      142     1457    5                       CALL FETCHNS_6('LK-LT   ') ALTRET(RD);

   1457 31 000245   000017 630400 32                 EPPR0   15
        31 000246   000000 631400 32                 EPPR1   0
        31 000247   000000 701000 xent               TSX1    FETCHNS_6
        31 000250   000330 702000 31                 TSX2    RD

      143     1458    5                       CALL FETCHOS_6('SN-LT   ') ALTRET(DBCS_ERR);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:28   

   1458 31 000251   000016 630400 32                 EPPR0   14
        31 000252   000000 631400 32                 EPPR1   0
        31 000253   000000 701000 xent               TSX1    FETCHOS_6
        31 000254   001775 702000 31                 TSX2    DBCS_ERR

      144     1459    5                       UWA.SN.ACTLCKS = 0;

   1459 31 000255   000426 450000 19                 STZ     UWA+278

      145     1460    5                       CALL MODIFY_6('SN      ') ALTRET(DBCS_ERR);

   1460 31 000256   000027 630400 32                 EPPR0   23
        31 000257   000000 631400 32                 EPPR1   0
        31 000260   000000 701000 xent               TSX1    MODIFY_6
        31 000261   001775 702000 31                 TSX2    DBCS_ERR

      146     1461    6                       DO WHILE('1'B);

      147     1462    6                           CALL FETCHNS_6('SN-SI   ') ALTRET(UN1);

   1462 31 000262   000030 630400 32                 EPPR0   24
        31 000263   000000 631400 32                 EPPR1   0
        31 000264   000000 701000 xent               TSX1    FETCHNS_6
        31 000265   000274 702000 31                 TSX2    UN1

      148     1463    6                           UWA.SI.LOCKED = 0;

   1463 31 000266   000146 450000 19                 STZ     UWA+102

      149     1464    6                           CALL MODIFY_6('SI      ') ALTRET(DBCS_ERR);

   1464 31 000267   000031 630400 32                 EPPR0   25
        31 000270   000000 631400 32                 EPPR1   0
        31 000271   000000 701000 xent               TSX1    MODIFY_6
        31 000272   001775 702000 31                 TSX2    DBCS_ERR

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:29   
      150     1465    6                           END;

   1465 31 000273   000262 710000 31                 TRA     s:1462

      151     1466    5   UN1:
      152     1467    5                       END;

   1467 31 000274   000245 710000 31    UN1          TRA     s:1457

      153     1468    4                   END;
      154     1469    4               ELSE DO;

      155     1470         /* Scramble lock value */
      156     1471    4                   LPTR = ADDR(UWA.LK.PLVALUE);

   1471 31 000275   000020 236000 32                 LDQ     16
        31 000276   200055 756100                    STQ     LPTR,,AUTO

      157     1472    4                   SPTR = ADDR(LKV);

   1472 31 000277   200057 630500                    EPPR0   LKV,,AUTO
        31 000300   200053 450500                    STP0    SPTR,,AUTO

      158     1473    4                   LVALUE.B1 = SCRAMB.BITS2(0);

   1473 31 000301   200055 471500                    LDP1    LPTR,,AUTO
        31 000302   003100 060500                    CSL     bolr='003'O
        31 000303   000000 050037                    BDSC    0,,PR0                   by=0,bit=5,n=31
        31 000304   100000 000037                    BDSC    0,,PR1                   by=0,bit=0,n=31

      159     1474    4                   LVALUE.B2 = SCRAMB.BITS1(0);

   1474 31 000305   003100 060500                    CSL     bolr='003'O
        31 000306   000000 000005                    BDSC    0,,PR0                   by=0,bit=0,n=5
        31 000307   100000 640005                    BDSC    0,,PR1                   by=3,bit=4,n=5

      160     1475    4                   LVALUE.B3 = SCRAMB.BITS2(1);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:30   

   1475 31 000310   003100 060500                    CSL     bolr='003'O
        31 000311   000001 050037                    BDSC    1,,PR0                   by=0,bit=5,n=31
        31 000312   100001 000037                    BDSC    1,,PR1                   by=0,bit=0,n=31

      161     1476    4                   LVALUE.B4 = SCRAMB.BITS1(1);

   1476 31 000313   003100 060500                    CSL     bolr='003'O
        31 000314   000001 000005                    BDSC    1,,PR0                   by=0,bit=0,n=5
        31 000315   100001 640005                    BDSC    1,,PR1                   by=3,bit=4,n=5

      162     1477    4                   LVALUE.B5 = SCRAMB.BITS2(2);

   1477 31 000316   003100 060500                    CSL     bolr='003'O
        31 000317   000002 050037                    BDSC    2,,PR0                   by=0,bit=5,n=31
        31 000320   100002 000037                    BDSC    2,,PR1                   by=0,bit=0,n=31

      163     1478    4                   LVALUE.B6 = SCRAMB.BITS1(2);

   1478 31 000321   003100 060500                    CSL     bolr='003'O
        31 000322   000002 000005                    BDSC    2,,PR0                   by=0,bit=0,n=5
        31 000323   100002 640005                    BDSC    2,,PR1                   by=3,bit=4,n=5

      164     1479    4                   CALL MODIFY_6('LK      ') ALTRET(DBCS_ERR);

   1479 31 000324   000026 630400 32                 EPPR0   22
        31 000325   000000 631400 32                 EPPR1   0
        31 000326   000000 701000 xent               TSX1    MODIFY_6
        31 000327   001775 702000 31                 TSX2    DBCS_ERR

      165     1480    4                   END;

      166     1481         /* * */
      167     1482         /* * */
      168     1483    3   RD:
      169     1484         /* Read next assignment statement */
      170     1485    3               CALL UGET('5*',W25$,FIVESTAREOF,BUFSZ);
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:31   

   1485 31 000330   000024 237000 32    RD           LDAQ    20
        31 000331   200202 757100                    STAQ    Y+3,,AUTO
        31 000332   200003 630500                    EPPR0   W25$,,AUTO
        31 000333   200201 450500                    STP0    Y+2,,AUTO
        31 000334   000021 236000 32                 LDQ     17
        31 000335   200200 756100                    STQ     Y+1,,AUTO
        31 000336   200200 630500                    EPPR0   Y+1,,AUTO
        31 000337   000023 631400 32                 EPPR1   19
        31 000340   000000 701000 xent               TSX1    UGET
        31 000341   000000 011000                    NOP     0

      171     1486    3               LOCK_DESC = W25;

   1486 31 000342   200003 470500                    LDP0    W25$,,AUTO
        31 000343   000000 100500                    MLR     fill='000'O
        31 000344   000000 000144                    ADSC9   0,,PR0                   cn=0,n=100
        31 000345   000000 000144 0                  ADSC9   DESC                     cn=0,n=100

      172     1487    3               END;

   1487 31 000346   000052 235000 1                  LDA     FIVESTAREOF
        31 000347   000207 600000 31                 TZE     OUT1

      173     1488    2           CALL UCLOSE('5*');

   1488 31 000350   000021 630400 32                 EPPR0   17
        31 000351   000000 631400 32                 EPPR1   0
        31 000352   000000 701000 xent               TSX1    UCLOSE
        31 000353   000000 011000                    NOP     0

      174     1489    2           OL = 'END LOCK NAME ASSIGNMENTS';

   1489 31 000354   040100 100400                    MLR     fill='040'O
        31 000355   000057 000031 30                 ADSC9   47                       cn=0,n=25
        31 000356   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:32   
      175     1490    2           CALL LIST(OL);

   1490 31 000357   200005 630500                    EPPR0   OL,,AUTO
        31 000360   200200 450500                    STP0    Y+1,,AUTO
        31 000361   200200 630500                    EPPR0   Y+1,,AUTO
        31 000362   000000 631400 32                 EPPR1   0
        31 000363   000000 701000 xent               TSX1    LIST
        31 000364   000000 011000                    NOP     0

      176     1491    2           END;

      177     1492         /**
      178     1493            Set all privacy lock bits in sn
      179     1494            and si
      180     1495            */
      181     1496    1       CALL RDYPL;

   1496 31 000365   000014 631400 32                 EPPR1   12
        31 000366   000000 701000 xent               TSX1    RDYPL
        31 000367   000000 011000                    NOP     0

      182     1497    1       IF LOCKS.LIST = '0'B THEN RETURN;

   1497 31 000370   000000 236000 25                 LDQ     LOCKS
        31 000371   040000 316003                    CANQ    16384,DU
        31 000372   000374 601000 31                 TNZ     s:1498

   1497 31 000373   000000 702200 xent               TSX2  ! X66_ARET

      183     1498    1       CALL FETCHD_6('SF      ',2) ALTRET(DBCS_ERR);

   1498 31 000374   000004 630400 32                 EPPR0   4
        31 000375   000002 631400 32                 EPPR1   2
        31 000376   000000 701000 xent               TSX1    FETCHD_6
        31 000377   001775 702000 31                 TSX2    DBCS_ERR

      184     1499    1       OL = '****';
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:33   

   1499 31 000400   040100 100400                    MLR     fill='040'O
        31 000401   000066 000004 30                 ADSC9   54                       cn=0,n=4
        31 000402   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      185     1500    1       CALL LIST(OL);

   1500 31 000403   200005 630500                    EPPR0   OL,,AUTO
        31 000404   200200 450500                    STP0    Y+1,,AUTO
        31 000405   200200 630500                    EPPR0   Y+1,,AUTO
        31 000406   000000 631400 32                 EPPR1   0
        31 000407   000000 701000 xent               TSX1    LIST
        31 000410   000000 011000                    NOP     0

      186     1501    1       OL = 'LOCK NAME/LOCK VALUE SUMMARY***';

   1501 31 000411   040100 100400                    MLR     fill='040'O
        31 000412   000067 000037 30                 ADSC9   55                       cn=0,n=31
        31 000413   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      187     1502    1       CALL LIST(OL);

   1502 31 000414   200005 630500                    EPPR0   OL,,AUTO
        31 000415   200200 450500                    STP0    Y+1,,AUTO
        31 000416   200200 630500                    EPPR0   Y+1,,AUTO
        31 000417   000000 631400 32                 EPPR1   0
        31 000420   000000 701000 xent               TSX1    LIST
        31 000421   000000 011000                    NOP     0

      188     1503    1       CALL LIST(B128);

   1503 31 000422   000032 630400 32                 EPPR0   26
        31 000423   000000 631400 32                 EPPR1   0
        31 000424   000000 701000 xent               TSX1    LIST
        31 000425   000000 011000                    NOP     0

      189     1504    1       OL = 'LOCK NAME                        LOCK VALUE';
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:34   

   1504 31 000426   040100 100400                    MLR     fill='040'O
        31 000427   000077 000053 30                 ADSC9   63                       cn=0,n=43
        31 000430   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      190     1505    1       CALL LIST(OL);

   1505 31 000431   200005 630500                    EPPR0   OL,,AUTO
        31 000432   200200 450500                    STP0    Y+1,,AUTO
        31 000433   200200 630500                    EPPR0   Y+1,,AUTO
        31 000434   000000 631400 32                 EPPR1   0
        31 000435   000000 701000 xent               TSX1    LIST
        31 000436   000000 011000                    NOP     0

      191     1506    1       CALL LIST(B128);

   1506 31 000437   000032 630400 32                 EPPR0   26
        31 000440   000000 631400 32                 EPPR1   0
        31 000441   000000 701000 xent               TSX1    LIST
        31 000442   000000 011000                    NOP     0

      192     1507    1       CALL FETCHD_6('DA      ',UWA.SF.DBKEY_DA) ALTRET(DBCS_ERR);

   1507 31 000443   000006 630400 32                 EPPR0   6
        31 000444   000002 631400 32                 EPPR1   2
        31 000445   000000 701000 xent               TSX1    FETCHD_6
        31 000446   001775 702000 31                 TSX2    DBCS_ERR

      193     1508    1   NEXT_LK1:
      194     1509    1       CALL FETCHNS_6('DA-LK   ') ALTRET(LCKD_ELM_LST);

   1509 31 000447   000033 630400 32    NEXT_LK1     EPPR0   27
        31 000450   000000 631400 32                 EPPR1   0
        31 000451   000000 701000 xent               TSX1    FETCHNS_6
        31 000452   000524 702000 31                 TSX2    LCKD_ELM_LST

      195     1510    1       IF UWA.LK.PLVALUE = '"NULL"' THEN CALL CONCAT(OL,UWA.LK.PLNAME,'   NULL');
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:35   

   1510 31 000453   040000 106400                    CMPC    fill='040'O
        31 000454   000447 400014 19                 ADSC9   UWA+295                  cn=2,n=12
        31 000455   000044 000006 30                 ADSC9   36                       cn=0,n=6
        31 000456   000466 601000 31                 TNZ     s:1512

   1510 31 000457   040100 100400                    MLR     fill='040'O
        31 000460   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
        31 000461   200005 000036                    ADSC9   OL,,AUTO                 cn=0,n=30
        31 000462   040100 100400                    MLR     fill='040'O
        31 000463   000114 000007 30                 ADSC9   76                       cn=0,n=7
        31 000464   200014 400142                    ADSC9   OL+7,,AUTO               cn=2,n=98
        31 000465   000515 710000 31                 TRA     s:1516

      196     1511    2       ELSE DO;

      197     1512    2           CALL UNSC(UWA.LK.PLVALUE,LKV);

   1512 31 000466   200057 630500                    EPPR0   LKV,,AUTO
        31 000467   200201 450500                    STP0    Y+2,,AUTO
        31 000470   000020 236000 32                 LDQ     16
        31 000471   200200 756100                    STQ     Y+1,,AUTO
        31 000472   200200 630500                    EPPR0   Y+1,,AUTO
        31 000473   000002 631400 32                 EPPR1   2
        31 000474   000000 701000 xent               TSX1    UNSC
        31 000475   000000 011000                    NOP     0

      198     1513    2           CALL QTE(LKV);

   1513 31 000476   200057 630500                    EPPR0   LKV,,AUTO
        31 000477   200175 450500                    STP0    CHR_LEN+3,,AUTO
        31 000500   001656 701000 31                 TSX1    QTE
        31 000501   000000 011000                    NOP     0

      199     1514    2           CALL CONCAT(OL,UWA.LK.PLNAME,'   ',CHR);

   1514 31 000502   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:36   
        31 000503   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
        31 000504   200005 000036                    ADSC9   OL,,AUTO                 cn=0,n=30
        31 000505   040100 100400                    MLR     fill='040'O
        31 000506   000007 000003 30                 ADSC9   7                        cn=0,n=3
        31 000507   200014 400003                    ADSC9   OL+7,,AUTO               cn=2,n=3
        31 000510   200171 470500                    LDP0    CHR$,,AUTO
        31 000511   200172 720100                    LXL0    CHR_LEN,,AUTO
        31 000512   040100 100540                    MLR     fill='040'O
        31 000513   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        31 000514   200015 200137                    ADSC9   OL+8,,AUTO               cn=1,n=95

      200     1515    2           END;

      201     1516    1       CALL LIST(OL);

   1516 31 000515   200005 630500                    EPPR0   OL,,AUTO
        31 000516   200200 450500                    STP0    Y+1,,AUTO
        31 000517   200200 630500                    EPPR0   Y+1,,AUTO
        31 000520   000000 631400 32                 EPPR1   0
        31 000521   000000 701000 xent               TSX1    LIST
        31 000522   000000 011000                    NOP     0

      202     1517    1       GOTO NEXT_LK1;

   1517 31 000523   000447 710000 31                 TRA     NEXT_LK1

      203     1518    1   LCKD_ELM_LST:
      204     1519    1       OL = '****';

   1519 31 000524   040100 100400       LCKD_ELM_LST MLR     fill='040'O
        31 000525   000066 000004 30                 ADSC9   54                       cn=0,n=4
        31 000526   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      205     1520    1       CALL LIST(OL);

   1520 31 000527   200005 630500                    EPPR0   OL,,AUTO
        31 000530   200200 450500                    STP0    Y+1,,AUTO
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:37   
        31 000531   200200 630500                    EPPR0   Y+1,,AUTO
        31 000532   000000 631400 32                 EPPR1   0
        31 000533   000000 701000 xent               TSX1    LIST
        31 000534   000000 011000                    NOP     0

      206     1521    1       OL = 'RESTRICTED FUNCTIONS WHICH ARE LOCKED***';

   1521 31 000535   040100 100400                    MLR     fill='040'O
        31 000536   000116 000050 30                 ADSC9   78                       cn=0,n=40
        31 000537   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      207     1522    1       CALL LIST(OL);

   1522 31 000540   200005 630500                    EPPR0   OL,,AUTO
        31 000541   200200 450500                    STP0    Y+1,,AUTO
        31 000542   200200 630500                    EPPR0   Y+1,,AUTO
        31 000543   000000 631400 32                 EPPR1   0
        31 000544   000000 701000 xent               TSX1    LIST
        31 000545   000000 011000                    NOP     0

      208     1523    1       CALL LIST(B128);

   1523 31 000546   000032 630400 32                 EPPR0   26
        31 000547   000000 631400 32                 EPPR1   0
        31 000550   000000 701000 xent               TSX1    LIST
        31 000551   000000 011000                    NOP     0

      209     1524    1       C64 = 'SCHEMA ELEMENT NAME               TYPE       FUNCTIONS          ';

   1524 31 000552   040100 100400                    MLR     fill='040'O
        31 000553   000130 000100 30                 ADSC9   88                       cn=0,n=64
        31 000554   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64

      210     1525    1       CALL CONCAT(OL,C64,'LOCK NAME                       LOCK VALUE');

   1525 31 000555   040100 100500                    MLR     fill='040'O
        31 000556   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:38   
        31 000557   200005 000100                    ADSC9   OL,,AUTO                 cn=0,n=64
        31 000560   040100 100400                    MLR     fill='040'O
        31 000561   000150 000052 30                 ADSC9   104                      cn=0,n=42
        31 000562   200025 000100                    ADSC9   OL+16,,AUTO              cn=0,n=64

      211     1526    1       CALL LIST(OL);

   1526 31 000563   200005 630500                    EPPR0   OL,,AUTO
        31 000564   200200 450500                    STP0    Y+1,,AUTO
        31 000565   200200 630500                    EPPR0   Y+1,,AUTO
        31 000566   000000 631400 32                 EPPR1   0
        31 000567   000000 701000 xent               TSX1    LIST
        31 000570   000000 011000                    NOP     0

      212     1527    1       CALL LIST(B128);

   1527 31 000571   000032 630400 32                 EPPR0   26
        31 000572   000000 631400 32                 EPPR1   0
        31 000573   000000 701000 xent               TSX1    LIST
        31 000574   000000 011000                    NOP     0

      213     1528    1       CALL FCURR_R_6('DA      ') ALTRET(DBCS_ERR);

   1528 31 000575   000006 630400 32                 EPPR0   6
        31 000576   000000 631400 32                 EPPR1   0
        31 000577   000000 701000 xent               TSX1    FCURR_R_6
        31 000600   001775 702000 31                 TSX2    DBCS_ERR

      214     1529    1       UWA.SN.SETYPE = 0;

   1529 31 000601   000424 450000 19                 STZ     UWA+276

      215     1530    1       OL = ' ';

   1530 31 000602   040100 100400                    MLR     fill='040'O
        31 000603   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000604   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:39   

      216     1531    1   NEXT_SN1:
      217     1532    1       CALL FETCH_AN_SN ALTRET(ULCKD_ELM_LST);

   1532 31 000605   001545 701000 31    NEXT_SN1     TSX1    FETCH_AN_SN
        31 000606   001066 702000 31                 TSX2    ULCKD_ELM_LST

      218     1533    1       IF UWA.SN.ACTLCKS = 0 THEN GOTO NEXT_SN1;

   1533 31 000607   000426 235000 19                 LDA     UWA+278
        31 000610   000605 600000 31                 TZE     NEXT_SN1

      219     1534    1       LCKED = LCKED + 1;

   1534 31 000611   000046 054000 1                  AOS     LCKED

      220     1535    1       CALL LIST(B128);

   1535 31 000612   000032 630400 32                 EPPR0   26
        31 000613   000000 631400 32                 EPPR1   0
        31 000614   000000 701000 xent               TSX1    LIST
        31 000615   000000 011000                    NOP     0

      221     1536    1   NEXT_LT1:
      222     1537    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN1);

   1537 31 000616   000016 630400 32    NEXT_LT1     EPPR0   14
        31 000617   000000 631400 32                 EPPR1   0
        31 000620   000000 701000 xent               TSX1    FETCHNS_6
        31 000621   000605 702000 31                 TSX2    NEXT_SN1

      223     1538    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);

   1538 31 000622   000017 630400 32                 EPPR0   15
        31 000623   000000 631400 32                 EPPR1   0
        31 000624   000000 701000 xent               TSX1    FETCHOS_6
        31 000625   001775 702000 31                 TSX2    DBCS_ERR
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:40   

      224     1539    1   CHECK_LT:
      225     1540    1       SB36 = '0'B;

   1540 31 000626   000065 450000 1     CHECK_LT     STZ     SB36

      226     1541    1       SB36 = ADDR(UWA.LT.PLOCKS)->BIT36 |

   1541 31 000627   000473 236000 19                 LDQ     UWA+315
        31 000630   000426 276000 19                 ORQ     UWA+278
        31 000631   000065 756000 1                  STQ     SB36

      227     1542    1          ADDR(UWA.SN.ACTLCKS)->BIT36;
      228     1543    1       IF SB36 ~= ADDR(UWA.SN.ACTLCKS)->BIT36 THEN GOTO

   1543 31 000632   000426 116000 19                 CMPQ    UWA+278
        31 000633   000616 601000 31                 TNZ     NEXT_LT1

      229     1544    1              NEXT_LT1;
      230     1545    2       IF OL ~= ' ' THEN DO;

   1545 31 000634   040000 106500                    CMPC    fill='040'O
        31 000635   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128
        31 000636   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000637   000657 600000 31                 TZE     s:1550

      231     1546    2           CALL LIST(OL);

   1546 31 000640   200005 630500                    EPPR0   OL,,AUTO
        31 000641   200200 450500                    STP0    Y+1,,AUTO
        31 000642   200200 630500                    EPPR0   Y+1,,AUTO
        31 000643   000000 631400 32                 EPPR1   0
        31 000644   000000 701000 xent               TSX1    LIST
        31 000645   000000 011000                    NOP     0

      232     1547    2           OL = ' ';

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:41   
   1547 31 000646   040100 100400                    MLR     fill='040'O
        31 000647   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000650   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      233     1548    2           CALL LIST(OL);

   1548 31 000651   200005 630500                    EPPR0   OL,,AUTO
        31 000652   200200 450500                    STP0    Y+1,,AUTO
        31 000653   200200 630500                    EPPR0   Y+1,,AUTO
        31 000654   000000 631400 32                 EPPR1   0
        31 000655   000000 701000 xent               TSX1    LIST
        31 000656   000000 011000                    NOP     0

      234     1549    2           END;

      235     1550    1       ETYP = (UWA.SN.SETYPE / 10) - 1;

   1550 31 000657   000424 236000 19                 LDQ     UWA+276
        31 000660   000012 506007                    DIV     10,DL
        31 000661   000001 136007                    SBLQ    1,DL
        31 000662   000023 736000                    QLS     19
        31 000663   200056 756100                    STQ     ETYP,,AUTO

      236     1551    1       C44 = ' ';

   1551 31 000664   040100 100400                    MLR     fill='040'O
        31 000665   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 000666   200113 000054                    ADSC9   C44,,AUTO                cn=0,n=44

      237     1552    1       IF NEW_SN THEN

   1552 31 000667   000066 234000 1                  SZN     NEW_SN
        31 000670   000731 605000 31                 TPL     s:1557

      238     1553    1           IF UWA.SN.SETYPE = 50 THEN

   1553 31 000671   000424 235000 19                 LDA     UWA+276
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:42   
        31 000672   000062 115007                    CMPA    50,DL
        31 000673   000713 601000 31                 TNZ     s:1556

      239     1554    1               CALL CONCAT(C44,'  ',UWA.SN.SENAME,'  ',ELM_TYP(ETYP),'    ');

   1554 31 000674   200056 236100                    LDQ     ETYP,,AUTO
        31 000675   000023 732000                    QRS     19
        31 000676   000007 220000 30                 LDX0    7
        31 000677   200113 740100                    STX0    C44,,AUTO
        31 000700   040100 100400                    MLR     fill='040'O
        31 000701   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30
        31 000702   200113 400036                    ADSC9   C44,,AUTO                cn=2,n=30
        31 000703   200123 740100                    STX0    C44+8,,AUTO
        31 000704   000006 402007                    MPY     6,DL
        31 000705   040100 100406                    MLR     fill='040'O
        31 000706   000055 000006 1                  ADSC9   ELM_TYP,Q                cn=0,n=6
        31 000707   200123 400006                    ADSC9   C44+8,,AUTO              cn=2,n=6
        31 000710   000007 236000 30                 LDQ     7
        31 000711   200125 756100                    STQ     C44+10,,AUTO
        31 000712   000731 710000 31                 TRA     s:1557

      240     1555    1           ELSE
      241     1556    1               CALL CONCAT(C44,UWA.SN.SENAME,'    ',ELM_TYP(ETYP),'    ');

   1556 31 000713   200056 236100                    LDQ     ETYP,,AUTO
        31 000714   000023 732000                    QRS     19
        31 000715   040100 100400                    MLR     fill='040'O
        31 000716   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30
        31 000717   200113 000036                    ADSC9   C44,,AUTO                cn=0,n=30
        31 000720   040100 100400                    MLR     fill='040'O
        31 000721   000007 000004 30                 ADSC9   7                        cn=0,n=4
        31 000722   200122 400004                    ADSC9   C44+7,,AUTO              cn=2,n=4
        31 000723   000006 402007                    MPY     6,DL
        31 000724   040100 100406                    MLR     fill='040'O
        31 000725   000055 000006 1                  ADSC9   ELM_TYP,Q                cn=0,n=6
        31 000726   200123 400006                    ADSC9   C44+8,,AUTO              cn=2,n=6
        31 000727   000007 236000 30                 LDQ     7
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:43   
        31 000730   200125 756100                    STQ     C44+10,,AUTO

      242     1557    1       CALL FNCT(UWA.LT.PLOCKS);

   1557 31 000731   000015 236000 32                 LDQ     13
        31 000732   200175 756100                    STQ     CHR_LEN+3,,AUTO
        31 000733   001507 701000 31                 TSX1    FNCT
        31 000734   000000 011000                    NOP     0

      243     1558    1       CALL UNSC(UWA.LK.PLVALUE,C12);

   1558 31 000735   200166 630500                    EPPR0   C12,,AUTO
        31 000736   200201 450500                    STP0    Y+2,,AUTO
        31 000737   000020 236000 32                 LDQ     16
        31 000740   200200 756100                    STQ     Y+1,,AUTO
        31 000741   200200 630500                    EPPR0   Y+1,,AUTO
        31 000742   000002 631400 32                 EPPR1   2
        31 000743   000000 701000 xent               TSX1    UNSC
        31 000744   000000 011000                    NOP     0

      244     1559    1       CALL QTE(C12);

   1559 31 000745   200166 630500                    EPPR0   C12,,AUTO
        31 000746   200175 450500                    STP0    CHR_LEN+3,,AUTO
        31 000747   001656 701000 31                 TSX1    QTE
        31 000750   000000 011000                    NOP     0

      245     1560    1       CALL CONCAT(OL,C44,C20,UWA.LK.PLNAME,'  ',CHR);

   1560 31 000751   040100 100500                    MLR     fill='040'O
        31 000752   200113 000054                    ADSC9   C44,,AUTO                cn=0,n=44
        31 000753   200005 000054                    ADSC9   OL,,AUTO                 cn=0,n=44
        31 000754   040100 100500                    MLR     fill='040'O
        31 000755   200046 000024                    ADSC9   C20,,AUTO                cn=0,n=20
        31 000756   200020 000024                    ADSC9   OL+11,,AUTO              cn=0,n=20
        31 000757   040100 100400                    MLR     fill='040'O
        31 000760   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:44   
        31 000761   200025 000036                    ADSC9   OL+16,,AUTO              cn=0,n=30
        31 000762   000007 220000 30                 LDX0    7
        31 000763   200034 440100                    SXL0    OL+23,,AUTO
        31 000764   200171 470500                    LDP0    CHR$,,AUTO
        31 000765   200172 721100                    LXL1    CHR_LEN,,AUTO
        31 000766   040100 100540                    MLR     fill='040'O
        31 000767   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        31 000770   200035 000040                    ADSC9   OL+24,,AUTO              cn=0,n=32

      246     1561    1       CALL LIST(OL);

   1561 31 000771   200005 630500                    EPPR0   OL,,AUTO
        31 000772   200200 450500                    STP0    Y+1,,AUTO
        31 000773   200200 630500                    EPPR0   Y+1,,AUTO
        31 000774   000000 631400 32                 EPPR1   0
        31 000775   000000 701000 xent               TSX1    LIST
        31 000776   000000 011000                    NOP     0

      247     1562    1       OL = ' ';

   1562 31 000777   040100 100400                    MLR     fill='040'O
        31 001000   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001001   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      248     1563    1       STYPE = UWA.LT.PLOCKS;

   1563 31 001002   000473 235000 19                 LDA     UWA+315
        31 001003   000051 755000 1                  STA     STYPE

      249     1564    1       NEW_SN = '0'B;

   1564 31 001004   000066 450000 1                  STZ     NEW_SN

      250     1565    1   CHK_OR:
      251     1566    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN1);

   1566 31 001005   000016 630400 32    CHK_OR       EPPR0   14
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:45   
        31 001006   000000 631400 32                 EPPR1   0
        31 001007   000000 701000 xent               TSX1    FETCHNS_6
        31 001010   000605 702000 31                 TSX2    NEXT_SN1

      252     1567    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);

   1567 31 001011   000017 630400 32                 EPPR0   15
        31 001012   000000 631400 32                 EPPR1   0
        31 001013   000000 701000 xent               TSX1    FETCHOS_6
        31 001014   001775 702000 31                 TSX2    DBCS_ERR

      253     1568    1       IF UWA.LT.PLOCKS ~= STYPE THEN GOTO CHECK_LT;

   1568 31 001015   000473 236000 19                 LDQ     UWA+315
        31 001016   000051 116000 1                  CMPQ    STYPE
        31 001017   000626 601000 31                 TNZ     CHECK_LT

      254     1569    1       C64 = ' ';

   1569 31 001020   040100 100400                    MLR     fill='040'O
        31 001021   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001022   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64

      255     1570    1       CALL UNSC(UWA.LK.PLVALUE,C12);

   1570 31 001023   200166 630500                    EPPR0   C12,,AUTO
        31 001024   200201 450500                    STP0    Y+2,,AUTO
        31 001025   000020 236000 32                 LDQ     16
        31 001026   200200 756100                    STQ     Y+1,,AUTO
        31 001027   200200 630500                    EPPR0   Y+1,,AUTO
        31 001030   000002 631400 32                 EPPR1   2
        31 001031   000000 701000 xent               TSX1    UNSC
        31 001032   000000 011000                    NOP     0

      256     1571    1       CALL QTE(C12);

   1571 31 001033   200166 630500                    EPPR0   C12,,AUTO
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:46   
        31 001034   200175 450500                    STP0    CHR_LEN+3,,AUTO
        31 001035   001656 701000 31                 TSX1    QTE
        31 001036   000000 011000                    NOP     0

      257     1572    1       CALL CONCAT(OL,C64,UWA.LK.PLNAME,'  ',CHR);

   1572 31 001037   040100 100500                    MLR     fill='040'O
        31 001040   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64
        31 001041   200005 000100                    ADSC9   OL,,AUTO                 cn=0,n=64
        31 001042   040100 100400                    MLR     fill='040'O
        31 001043   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
        31 001044   200025 000036                    ADSC9   OL+16,,AUTO              cn=0,n=30
        31 001045   000007 220000 30                 LDX0    7
        31 001046   200034 440100                    SXL0    OL+23,,AUTO
        31 001047   200171 470500                    LDP0    CHR$,,AUTO
        31 001050   200172 721100                    LXL1    CHR_LEN,,AUTO
        31 001051   040100 100540                    MLR     fill='040'O
        31 001052   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        31 001053   200035 000040                    ADSC9   OL+24,,AUTO              cn=0,n=32

      258     1573    1       CALL LIST(OL);

   1573 31 001054   200005 630500                    EPPR0   OL,,AUTO
        31 001055   200200 450500                    STP0    Y+1,,AUTO
        31 001056   200200 630500                    EPPR0   Y+1,,AUTO
        31 001057   000000 631400 32                 EPPR1   0
        31 001060   000000 701000 xent               TSX1    LIST
        31 001061   000000 011000                    NOP     0

      259     1574    1       OL = ' ';

   1574 31 001062   040100 100400                    MLR     fill='040'O
        31 001063   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001064   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      260     1575    1       GOTO CHK_OR;

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:47   
   1575 31 001065   001005 710000 31                 TRA     CHK_OR

      261     1576    1   ULCKD_ELM_LST:
      262     1577    2       IF LCKED = 0 THEN DO;

   1577 31 001066   000046 235000 1     ULCKD_ELM_L* LDA     LCKED
        31 001067   001105 601000 31                 TNZ     s:1582

      263     1578    2           CALL LIST(B128);

   1578 31 001070   000032 630400 32                 EPPR0   26
        31 001071   000000 631400 32                 EPPR1   0
        31 001072   000000 701000 xent               TSX1    LIST
        31 001073   000000 011000                    NOP     0

      264     1579    2           OL = 'ALL DML FUNCTIONS ARE UNLOCKED';

   1579 31 001074   040100 100400                    MLR     fill='040'O
        31 001075   000163 000036 30                 ADSC9   115                      cn=0,n=30
        31 001076   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      265     1580    2           CALL LIST(OL);

   1580 31 001077   200005 630500                    EPPR0   OL,,AUTO
        31 001100   200200 450500                    STP0    Y+1,,AUTO
        31 001101   200200 630500                    EPPR0   Y+1,,AUTO
        31 001102   000000 631400 32                 EPPR1   0
        31 001103   000000 701000 xent               TSX1    LIST
        31 001104   000000 011000                    NOP     0

      266     1581    2           END;

      267     1582    1       OL = '****';

   1582 31 001105   040100 100400                    MLR     fill='040'O
        31 001106   000066 000004 30                 ADSC9   54                       cn=0,n=4
        31 001107   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:48   

      268     1583    1       CALL LIST(OL);

   1583 31 001110   200005 630500                    EPPR0   OL,,AUTO
        31 001111   200200 450500                    STP0    Y+1,,AUTO
        31 001112   200200 630500                    EPPR0   Y+1,,AUTO
        31 001113   000000 631400 32                 EPPR1   0
        31 001114   000000 701000 xent               TSX1    LIST
        31 001115   000000 011000                    NOP     0

      269     1584    1       OL = 'RESTRICTED FUNCTIONS WHICH ARE UNLOCKED***';

   1584 31 001116   040100 100400                    MLR     fill='040'O
        31 001117   000173 000052 30                 ADSC9   123                      cn=0,n=42
        31 001120   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      270     1585    1       CALL LIST(OL);

   1585 31 001121   200005 630500                    EPPR0   OL,,AUTO
        31 001122   200200 450500                    STP0    Y+1,,AUTO
        31 001123   200200 630500                    EPPR0   Y+1,,AUTO
        31 001124   000000 631400 32                 EPPR1   0
        31 001125   000000 701000 xent               TSX1    LIST
        31 001126   000000 011000                    NOP     0

      271     1586    1       CALL LIST(B128);

   1586 31 001127   000032 630400 32                 EPPR0   26
        31 001130   000000 631400 32                 EPPR1   0
        31 001131   000000 701000 xent               TSX1    LIST
        31 001132   000000 011000                    NOP     0

      272     1587    1       C64 = 'SCHEMA ELEMENT NAME               TYPE       FUNCTIONS          ';

   1587 31 001133   040100 100400                    MLR     fill='040'O
        31 001134   000130 000100 30                 ADSC9   88                       cn=0,n=64
        31 001135   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:49   

      273     1588    1       CALL CONCAT(OL,C64,'LOCK NAME                       LOCK VALUE');

   1588 31 001136   040100 100500                    MLR     fill='040'O
        31 001137   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64
        31 001140   200005 000100                    ADSC9   OL,,AUTO                 cn=0,n=64
        31 001141   040100 100400                    MLR     fill='040'O
        31 001142   000150 000052 30                 ADSC9   104                      cn=0,n=42
        31 001143   200025 000100                    ADSC9   OL+16,,AUTO              cn=0,n=64

      274     1589    1       CALL LIST(OL);

   1589 31 001144   200005 630500                    EPPR0   OL,,AUTO
        31 001145   200200 450500                    STP0    Y+1,,AUTO
        31 001146   200200 630500                    EPPR0   Y+1,,AUTO
        31 001147   000000 631400 32                 EPPR1   0
        31 001150   000000 701000 xent               TSX1    LIST
        31 001151   000000 011000                    NOP     0

      275     1590    1       OL = ' ';

   1590 31 001152   040100 100400                    MLR     fill='040'O
        31 001153   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001154   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      276     1591    1       CALL LIST(B128);

   1591 31 001155   000032 630400 32                 EPPR0   26
        31 001156   000000 631400 32                 EPPR1   0
        31 001157   000000 701000 xent               TSX1    LIST
        31 001160   000000 011000                    NOP     0

      277     1592    1       CALL FCURR_R_6('DA      ') ALTRET(DBCS_ERR);

   1592 31 001161   000006 630400 32                 EPPR0   6
        31 001162   000000 631400 32                 EPPR1   0
        31 001163   000000 701000 xent               TSX1    FCURR_R_6
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:50   
        31 001164   001775 702000 31                 TSX2    DBCS_ERR

      278     1593    1       UWA.SN.SETYPE = 0;

   1593 31 001165   000424 450000 19                 STZ     UWA+276

      279     1594    1   NEXT_SN2:
      280     1595    1       CALL FETCH_AN_SN ALTRET(DO_USE_PROC);

   1595 31 001166   001545 701000 31    NEXT_SN2     TSX1    FETCH_AN_SN
        31 001167   001712 702000 31                 TSX2    DO_USE_PROC

      281     1596    1   NEXT_LT2:
      282     1597    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN2);

   1597 31 001170   000016 630400 32    NEXT_LT2     EPPR0   14
        31 001171   000000 631400 32                 EPPR1   0
        31 001172   000000 701000 xent               TSX1    FETCHNS_6
        31 001173   001166 702000 31                 TSX2    NEXT_SN2

      283     1598    1   CONTINUE_LT:
      284     1599    1       SB36 = '0'B;

   1599 31 001174   000065 450000 1     CONTINUE_LT  STZ     SB36

      285     1600    1       SB36 = ADDR(UWA.SN.ACTLCKS)->BIT36 |

   1600 31 001175   000426 236000 19                 LDQ     UWA+278
        31 001176   000473 276000 19                 ORQ     UWA+315
        31 001177   000065 756000 1                  STQ     SB36

      286     1601    1          ADDR(UWA.LT.PLOCKS)->BIT36;
      287     1602    1       IF SB36 = ADDR(UWA.SN.ACTLCKS)->BIT36 THEN GOTO

   1602 31 001200   000426 116000 19                 CMPQ    UWA+278
        31 001201   001170 600000 31                 TZE     NEXT_LT2

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:51   
      288     1603    1              NEXT_LT2;
      289     1604    1       UNLCKED = UNLCKED + 1;

   1604 31 001202   000050 054000 1                  AOS     UNLCKED

      290     1605    1       IF NEW_SN THEN CALL LIST(B128);

   1605 31 001203   000066 234000 1                  SZN     NEW_SN
        31 001204   001211 605000 31                 TPL     s:1606

   1605 31 001205   000032 630400 32                 EPPR0   26
        31 001206   000000 631400 32                 EPPR1   0
        31 001207   000000 701000 xent               TSX1    LIST
        31 001210   000000 011000                    NOP     0

      291     1606    2       IF OL ~= ' ' THEN DO;

   1606 31 001211   040000 106500                    CMPC    fill='040'O
        31 001212   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128
        31 001213   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001214   001232 600000 31                 TZE     s:1611

      292     1607    2           CALL LIST(OL);

   1607 31 001215   200005 630500                    EPPR0   OL,,AUTO
        31 001216   200200 450500                    STP0    Y+1,,AUTO
        31 001217   200200 630500                    EPPR0   Y+1,,AUTO
        31 001220   000000 631400 32                 EPPR1   0
        31 001221   000000 701000 xent               TSX1    LIST
        31 001222   000000 011000                    NOP     0

      293     1608    2           CALL LIST(B128);

   1608 31 001223   000032 630400 32                 EPPR0   26
        31 001224   000000 631400 32                 EPPR1   0
        31 001225   000000 701000 xent               TSX1    LIST
        31 001226   000000 011000                    NOP     0
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:52   

      294     1609    2           OL = ' ';

   1609 31 001227   040100 100400                    MLR     fill='040'O
        31 001230   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001231   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      295     1610    2           END;

      296     1611    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);

   1611 31 001232   000017 630400 32                 EPPR0   15
        31 001233   000000 631400 32                 EPPR1   0
        31 001234   000000 701000 xent               TSX1    FETCHOS_6
        31 001235   001775 702000 31                 TSX2    DBCS_ERR

      297     1612    1       ETYP = (UWA.SN.SETYPE / 10) - 1;

   1612 31 001236   000424 236000 19                 LDQ     UWA+276
        31 001237   000012 506007                    DIV     10,DL
        31 001240   000001 136007                    SBLQ    1,DL
        31 001241   000023 736000                    QLS     19
        31 001242   200056 756100                    STQ     ETYP,,AUTO

      298     1613    1       C44 = ' ';

   1613 31 001243   040100 100400                    MLR     fill='040'O
        31 001244   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001245   200113 000054                    ADSC9   C44,,AUTO                cn=0,n=44

      299     1614    1       IF NEW_SN THEN

   1614 31 001246   000066 234000 1                  SZN     NEW_SN
        31 001247   001310 605000 31                 TPL     s:1619

      300     1615    1           IF UWA.SN.SETYPE = 50 THEN

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:53   
   1615 31 001250   000424 235000 19                 LDA     UWA+276
        31 001251   000062 115007                    CMPA    50,DL
        31 001252   001272 601000 31                 TNZ     s:1618

      301     1616    1               CALL CONCAT(C44,'  ',UWA.SN.SENAME,'  ',ELM_TYP(ETYP),'    ');

   1616 31 001253   200056 236100                    LDQ     ETYP,,AUTO
        31 001254   000023 732000                    QRS     19
        31 001255   000007 220000 30                 LDX0    7
        31 001256   200113 740100                    STX0    C44,,AUTO
        31 001257   040100 100400                    MLR     fill='040'O
        31 001260   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30
        31 001261   200113 400036                    ADSC9   C44,,AUTO                cn=2,n=30
        31 001262   200123 740100                    STX0    C44+8,,AUTO
        31 001263   000006 402007                    MPY     6,DL
        31 001264   040100 100406                    MLR     fill='040'O
        31 001265   000055 000006 1                  ADSC9   ELM_TYP,Q                cn=0,n=6
        31 001266   200123 400006                    ADSC9   C44+8,,AUTO              cn=2,n=6
        31 001267   000007 236000 30                 LDQ     7
        31 001270   200125 756100                    STQ     C44+10,,AUTO
        31 001271   001310 710000 31                 TRA     s:1619

      302     1617    1           ELSE
      303     1618    1               CALL CONCAT(C44,UWA.SN.SENAME,'    ',ELM_TYP(ETYP),'    ');

   1618 31 001272   200056 236100                    LDQ     ETYP,,AUTO
        31 001273   000023 732000                    QRS     19
        31 001274   040100 100400                    MLR     fill='040'O
        31 001275   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30
        31 001276   200113 000036                    ADSC9   C44,,AUTO                cn=0,n=30
        31 001277   040100 100400                    MLR     fill='040'O
        31 001300   000007 000004 30                 ADSC9   7                        cn=0,n=4
        31 001301   200122 400004                    ADSC9   C44+7,,AUTO              cn=2,n=4
        31 001302   000006 402007                    MPY     6,DL
        31 001303   040100 100406                    MLR     fill='040'O
        31 001304   000055 000006 1                  ADSC9   ELM_TYP,Q                cn=0,n=6
        31 001305   200123 400006                    ADSC9   C44+8,,AUTO              cn=2,n=6
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:54   
        31 001306   000007 236000 30                 LDQ     7
        31 001307   200125 756100                    STQ     C44+10,,AUTO

      304     1619    1       CALL FNCT(UWA.LT.PLOCKS);

   1619 31 001310   000015 236000 32                 LDQ     13
        31 001311   200175 756100                    STQ     CHR_LEN+3,,AUTO
        31 001312   001507 701000 31                 TSX1    FNCT
        31 001313   000000 011000                    NOP     0

      305     1620    2       IF UWA.LK.PLVALUE = '"NULL"' THEN DO;

   1620 31 001314   040000 106400                    CMPC    fill='040'O
        31 001315   000447 400014 19                 ADSC9   UWA+295                  cn=2,n=12
        31 001316   000044 000006 30                 ADSC9   36                       cn=0,n=6
        31 001317   001337 601000 31                 TNZ     s:1624

      306     1621    2           CALL CONCAT(OL,C44,C20,UWA.LK.PLNAME,'  ','NULL');

   1621 31 001320   040100 100500                    MLR     fill='040'O
        31 001321   200113 000054                    ADSC9   C44,,AUTO                cn=0,n=44
        31 001322   200005 000054                    ADSC9   OL,,AUTO                 cn=0,n=44
        31 001323   040100 100500                    MLR     fill='040'O
        31 001324   200046 000024                    ADSC9   C20,,AUTO                cn=0,n=20
        31 001325   200020 000024                    ADSC9   OL+11,,AUTO              cn=0,n=20
        31 001326   040100 100400                    MLR     fill='040'O
        31 001327   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
        31 001330   200025 000036                    ADSC9   OL+16,,AUTO              cn=0,n=30
        31 001331   000007 220000 30                 LDX0    7
        31 001332   200034 440100                    SXL0    OL+23,,AUTO
        31 001333   040100 100400                    MLR     fill='040'O
        31 001334   000206 000004 30                 ADSC9   134                      cn=0,n=4
        31 001335   200035 000040                    ADSC9   OL+24,,AUTO              cn=0,n=32

      307     1622    2           END;

   1622 31 001336   001373 710000 31                 TRA     s:1628
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:55   

      308     1623    2       ELSE DO;

      309     1624    2           CALL UNSC(UWA.LK.PLVALUE,C12);

   1624 31 001337   200166 630500                    EPPR0   C12,,AUTO
        31 001340   200201 450500                    STP0    Y+2,,AUTO
        31 001341   000020 236000 32                 LDQ     16
        31 001342   200200 756100                    STQ     Y+1,,AUTO
        31 001343   200200 630500                    EPPR0   Y+1,,AUTO
        31 001344   000002 631400 32                 EPPR1   2
        31 001345   000000 701000 xent               TSX1    UNSC
        31 001346   000000 011000                    NOP     0

      310     1625    2           CALL QTE(C12);

   1625 31 001347   200166 630500                    EPPR0   C12,,AUTO
        31 001350   200175 450500                    STP0    CHR_LEN+3,,AUTO
        31 001351   001656 701000 31                 TSX1    QTE
        31 001352   000000 011000                    NOP     0

      311     1626    2           CALL CONCAT(OL,C44,C20,UWA.LK.PLNAME,'  ',CHR);

   1626 31 001353   040100 100500                    MLR     fill='040'O
        31 001354   200113 000054                    ADSC9   C44,,AUTO                cn=0,n=44
        31 001355   200005 000054                    ADSC9   OL,,AUTO                 cn=0,n=44
        31 001356   040100 100500                    MLR     fill='040'O
        31 001357   200046 000024                    ADSC9   C20,,AUTO                cn=0,n=20
        31 001360   200020 000024                    ADSC9   OL+11,,AUTO              cn=0,n=20
        31 001361   040100 100400                    MLR     fill='040'O
        31 001362   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
        31 001363   200025 000036                    ADSC9   OL+16,,AUTO              cn=0,n=30
        31 001364   000007 220000 30                 LDX0    7
        31 001365   200034 440100                    SXL0    OL+23,,AUTO
        31 001366   200171 470500                    LDP0    CHR$,,AUTO
        31 001367   200172 721100                    LXL1    CHR_LEN,,AUTO
        31 001370   040100 100540                    MLR     fill='040'O
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:56   
        31 001371   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
        31 001372   200035 000040                    ADSC9   OL+24,,AUTO              cn=0,n=32

      312     1627    2           END;

      313     1628    1       CALL LIST(OL);

   1628 31 001373   200005 630500                    EPPR0   OL,,AUTO
        31 001374   200200 450500                    STP0    Y+1,,AUTO
        31 001375   200200 630500                    EPPR0   Y+1,,AUTO
        31 001376   000000 631400 32                 EPPR1   0
        31 001377   000000 701000 xent               TSX1    LIST
        31 001400   000000 011000                    NOP     0

      314     1629    1       OL = ' ';

   1629 31 001401   040100 100400                    MLR     fill='040'O
        31 001402   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001403   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      315     1630    1       STYPE = UWA.LT.PLOCKS;

   1630 31 001404   000473 235000 19                 LDA     UWA+315
        31 001405   000051 755000 1                  STA     STYPE

      316     1631    1       NEW_SN = '0'B;

   1631 31 001406   000066 450000 1                  STZ     NEW_SN

      317     1632    1   CHK_OR2:
      318     1633    1       CALL FETCHNS_6('SN-LT   ') ALTRET(NEXT_SN2);

   1633 31 001407   000016 630400 32    CHK_OR2      EPPR0   14
        31 001410   000000 631400 32                 EPPR1   0
        31 001411   000000 701000 xent               TSX1    FETCHNS_6
        31 001412   001166 702000 31                 TSX2    NEXT_SN2

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:57   
      319     1634    1       CALL FETCHOS_6('LK-LT   ') ALTRET(DBCS_ERR);

   1634 31 001413   000017 630400 32                 EPPR0   15
        31 001414   000000 631400 32                 EPPR1   0
        31 001415   000000 701000 xent               TSX1    FETCHOS_6
        31 001416   001775 702000 31                 TSX2    DBCS_ERR

      320     1635    1       IF UWA.LT.PLOCKS ~= STYPE THEN GOTO CONTINUE_LT;

   1635 31 001417   000473 236000 19                 LDQ     UWA+315
        31 001420   000051 116000 1                  CMPQ    STYPE
        31 001421   001174 601000 31                 TNZ     CONTINUE_LT

      321     1636    1       C64 = ' ';

   1636 31 001422   040100 100400                    MLR     fill='040'O
        31 001423   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001424   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64

      322     1637    1       CALL CONCAT(C96,C64,UWA.LK.PLNAME,'  ');

   1637 31 001425   040100 100500                    MLR     fill='040'O
        31 001426   200073 000100                    ADSC9   C64,,AUTO                cn=0,n=64
        31 001427   200126 000100                    ADSC9   C96,,AUTO                cn=0,n=64
        31 001430   040100 100400                    MLR     fill='040'O
        31 001431   000440 000036 19                 ADSC9   UWA+288                  cn=0,n=30
        31 001432   200146 000036                    ADSC9   C96+16,,AUTO             cn=0,n=30
        31 001433   000007 220000 30                 LDX0    7
        31 001434   200155 440100                    SXL0    C96+23,,AUTO

      323     1638    1       CHR_LEN = 4;

   1638 31 001435   000004 235007                    LDA     4,DL
        31 001436   200172 755100                    STA     CHR_LEN,,AUTO

      324     1639    1       IF UWA.LK.PLVALUE = '"NULL"' THEN CHR = 'NULL';

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:58   
   1639 31 001437   040000 106400                    CMPC    fill='040'O
        31 001440   000447 400014 19                 ADSC9   UWA+295                  cn=2,n=12
        31 001441   000044 000006 30                 ADSC9   36                       cn=0,n=6
        31 001442   001451 601000 31                 TNZ     s:1641

   1639 31 001443   200171 470500                    LDP0    CHR$,,AUTO
        31 001444   000000 620005                    EAX0    0,AL
        31 001445   040140 100400                    MLR     fill='040'O
        31 001446   000206 000004 30                 ADSC9   134                      cn=0,n=4
        31 001447   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        31 001450   001465 710000 31                 TRA     s:1644

      325     1640    2       ELSE DO;

      326     1641    2           CALL UNSC(UWA.LK.PLVALUE,LKV);

   1641 31 001451   200057 630500                    EPPR0   LKV,,AUTO
        31 001452   200201 450500                    STP0    Y+2,,AUTO
        31 001453   000020 236000 32                 LDQ     16
        31 001454   200200 756100                    STQ     Y+1,,AUTO
        31 001455   200200 630500                    EPPR0   Y+1,,AUTO
        31 001456   000002 631400 32                 EPPR1   2
        31 001457   000000 701000 xent               TSX1    UNSC
        31 001460   000000 011000                    NOP     0

      327     1642    2           CALL QTE(LKV);

   1642 31 001461   200057 630500                    EPPR0   LKV,,AUTO
        31 001462   200175 450500                    STP0    CHR_LEN+3,,AUTO
        31 001463   001656 701000 31                 TSX1    QTE
        31 001464   000000 011000                    NOP     0

      328     1643    2           END;

      329     1644    1       CALL CONCAT(OL,C96,CHR);

   1644 31 001465   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:59   
        31 001466   200126 000140                    ADSC9   C96,,AUTO                cn=0,n=96
        31 001467   200005 000140                    ADSC9   OL,,AUTO                 cn=0,n=96
        31 001470   200171 470500                    LDP0    CHR$,,AUTO
        31 001471   200172 720100                    LXL0    CHR_LEN,,AUTO
        31 001472   040100 100540                    MLR     fill='040'O
        31 001473   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
        31 001474   200035 000040                    ADSC9   OL+24,,AUTO              cn=0,n=32

      330     1645    1       CALL LIST(OL);

   1645 31 001475   200005 630500                    EPPR0   OL,,AUTO
        31 001476   200200 450500                    STP0    Y+1,,AUTO
        31 001477   200200 630500                    EPPR0   Y+1,,AUTO
        31 001500   000000 631400 32                 EPPR1   0
        31 001501   000000 701000 xent               TSX1    LIST
        31 001502   000000 011000                    NOP     0

      331     1646    1       OL = ' ';

   1646 31 001503   040100 100400                    MLR     fill='040'O
        31 001504   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001505   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      332     1647    1       GOTO CHK_OR2;

   1647 31 001506   001407 710000 31                 TRA     CHK_OR2

      333     1648    1   FNCT:

   1648 31 001507   200174 741300       FNCT         STX1  ! CHR_LEN+2,,AUTO

      334     1649    1       PROC(LTYPES);
      335     1650    2   DCL LTYPES SBIN(36);
      336     1651    2   DCL P PTR;
      337     1652    2   DCL B36(0:35) BIT(1) BASED(P);
      338     1653    2   DCL Y UBIN WORD;
      339     1654    2   DCL FTYP(0:15) CHAR(2) STATIC INIT(' C',' D',' L',' A',
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:60   
      340     1655    2   '  ','  ','  ','  ','  ',' G',' M',' S',' D',' I',' R',' F');
      341     1656    2       P = ADDR(LTYPES);

   1656 31 001510   200175 236100                    LDQ     @LTYPES,,AUTO
        31 001511   200176 756100                    STQ     P,,AUTO

      342     1657    2       C20 = ' ';

   1657 31 001512   040100 100400                    MLR     fill='040'O
        31 001513   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001514   200046 000024                    ADSC9   C20,,AUTO                cn=0,n=20

      343     1658    2       Y = 0;

   1658 31 001515   200177 450100                    STZ     Y,,AUTO

      344     1659    3       DO X = 0 TO 15;

   1659 31 001516   000053 450000 1                  STZ     X

      345     1660    4           IF B36(X) = '1'B THEN DO;

   1660 31 001517   000053 235000 1                  LDA     X
        31 001520   001522 605000 31                 TPL     s:1660+3
        31 001521   000044 035003                    ADLA    36,DU
        31 001522   200176 470500                    LDP0    P,,AUTO
        31 001523   000000 066505                    CMPB    filb='0'B
        31 001524   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
        31 001525   000014 000022 32                 BDSC    12                       by=0,bit=0,n=18
        31 001526   001537 600000 31                 TZE     s:1664

      346     1661    4               CALL INSERT(C20,Y,2,FTYP(X));

   1661 31 001527   000053 235000 1                  LDA     X
        31 001530   000001 735000                    ALS     1
        31 001531   200177 236100                    LDQ     Y,,AUTO
        31 001532   040106 100405                    MLR     fill='040'O
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:61   
        31 001533   000132 000002 1                  ADSC9   FTYP,A                   cn=0,n=2
        31 001534   200046 000002                    ADSC9   C20,Q,AUTO               cn=0,n=2

      347     1662    4               Y = Y + 2;

   1662 31 001535   000002 036007                    ADLQ    2,DL
        31 001536   200177 756100                    STQ     Y,,AUTO

      348     1663    4               END;

      349     1664    3           END;

   1664 31 001537   000053 054000 1                  AOS     X
        31 001540   000053 235000 1                  LDA     X
        31 001541   000017 115007                    CMPA    15,DL
        31 001542   001517 604400 31                 TMOZ    s:1660

      350     1665    2   END;

   1665 31 001543   200174 221300                    LDX1  ! CHR_LEN+2,,AUTO
        31 001544   000001 702211                    TSX2  ! 1,X1

      351     1666    1   FETCH_AN_SN:

   1666 31 001545   200174 741300       FETCH_AN_SN  STX1  ! CHR_LEN+2,,AUTO

      352     1667    1       PROC ALTRET;
      353     1668    2       NEW_SN = '1'B;

   1668 31 001546   400000 236003                    LDQ     -131072,DU
        31 001547   000066 756000 1                  STQ     NEW_SN

      354     1669    3       IF UWA.SN.SETYPE = 40 THEN DO;

   1669 31 001550   000424 235000 19                 LDA     UWA+276
        31 001551   000050 115007                    CMPA    40,DL
        31 001552   001606 601000 31                 TNZ     s:1680
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:62   

      355     1670    3           CALL FCURR_R_6('SN      ') ALTRET(DBCS_ERR);

   1670 31 001553   000027 630400 32                 EPPR0   23
        31 001554   000000 631400 32                 EPPR1   0
        31 001555   000000 701000 xent               TSX1    FCURR_R_6
        31 001556   001651 702000 31                 TSX2    DBCS_ERR

      356     1671    3           HOLD_PLACE = UWA.DIRECT_REF;

   1671 31 001557   000036 235000 19                 LDA     UWA+30
        31 001560   200062 755100                    STA     HOLD_PLACE,,AUTO

      357     1672    3           IF UWA.SN.ACTLCKS = 0 THEN OL = UWA.SN.SENAME;

   1672 31 001561   000426 236000 19                 LDQ     UWA+278
        31 001562   001566 601000 31                 TNZ     s:1673

   1672 31 001563   040100 100400                    MLR     fill='040'O
        31 001564   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30
        31 001565   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      358     1673    3           CALL FETCHNS_6('SN-SE   ') ALTRET(DBCS_ERR);

   1673 31 001566   000034 630400 32                 EPPR0   28
        31 001567   000000 631400 32                 EPPR1   0
        31 001570   000000 701000 xent               TSX1    FETCHNS_6
        31 001571   001651 702000 31                 TSX2    DBCS_ERR

      359     1674    3   NEXT_FR:
      360     1675    3           CALL FETCHNS_6('RC-FR   ')ALTRET(RESET_DASN);

   1675 31 001572   000035 630400 32    NEXT_FR      EPPR0   29
        31 001573   000000 631400 32                 EPPR1   0
        31 001574   000000 701000 xent               TSX1    FETCHNS_6
        31 001575   001633 702000 31                 TSX2    RESET_DASN

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:63   
      361     1676    3           IF UWA.FR.SYN ~= 0 THEN GOTO NEXT_FR;

   1676 31 001576   000332 235000 19                 LDA     UWA+218
        31 001577   001572 601000 31                 TNZ     NEXT_FR

      362     1677    3           CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERR);

   1677 31 001600   000034 630400 32                 EPPR0   28
        31 001601   000000 631400 32                 EPPR1   0
        31 001602   000000 701000 xent               TSX1    FETCHOS_6
        31 001603   001651 702000 31                 TSX2    DBCS_ERR

      363     1678    3           RETURN;

   1678 31 001604   200174 221300                    LDX1  ! CHR_LEN+2,,AUTO
        31 001605   000001 702211                    TSX2  ! 1,X1

      364     1679    3           END;
      365     1680    3       IF UWA.SN.SETYPE = 50 THEN DO;

   1680 31 001606   000062 115007                    CMPA    50,DL
        31 001607   001622 601000 31                 TNZ     NORMAL

      366     1681    3           CALL FETCHNS_6('RC-FR   ') ALTRET(RESET_DASN);

   1681 31 001610   000035 630400 32                 EPPR0   29
        31 001611   000000 631400 32                 EPPR1   0
        31 001612   000000 701000 xent               TSX1    FETCHNS_6
        31 001613   001633 702000 31                 TSX2    RESET_DASN

      367     1682    3           CALL FETCHOS_6('SN-SE   ') ALTRET(DBCS_ERR);

   1682 31 001614   000034 630400 32                 EPPR0   28
        31 001615   000000 631400 32                 EPPR1   0
        31 001616   000000 701000 xent               TSX1    FETCHOS_6
        31 001617   001651 702000 31                 TSX2    DBCS_ERR

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:64   
      368     1683    3           RETURN;

   1683 31 001620   200174 221300                    LDX1  ! CHR_LEN+2,,AUTO
        31 001621   000001 702211                    TSX2  ! 1,X1

      369     1684    3           END;
      370     1685    2   NORMAL:
      371     1686    2       CALL FETCHNS_6('DA-SN   ') ALTRET(ALT_END);

   1686 31 001622   000010 630400 32    NORMAL       EPPR0   8
        31 001623   000000 631400 32                 EPPR1   0
        31 001624   000000 701000 xent               TSX1    FETCHNS_6
        31 001625   001647 702000 31                 TSX2    ALT_END

      372     1687    2       IF UWA.SN.SETYPE = 50 THEN GOTO NORMAL;

   1687 31 001626   000424 235000 19                 LDA     UWA+276
        31 001627   000062 115007                    CMPA    50,DL
        31 001630   001622 600000 31                 TZE     NORMAL

      373     1688    2       RETURN;

   1688 31 001631   200174 221300                    LDX1  ! CHR_LEN+2,,AUTO
        31 001632   000001 702211                    TSX2  ! 1,X1

      374     1689    2   RESET_DASN:
      375     1690    2       CALL FINDD_6('SN      ',HOLD_PLACE) ALTRET(DBCS_ERR);

   1690 31 001633   200062 630500       RESET_DASN   EPPR0   HOLD_PLACE,,AUTO
        31 001634   200201 450500                    STP0    Y+2,,AUTO
        31 001635   000027 236000 32                 LDQ     23
        31 001636   200200 756100                    STQ     Y+1,,AUTO
        31 001637   200200 630500                    EPPR0   Y+1,,AUTO
        31 001640   000002 631400 32                 EPPR1   2
        31 001641   000000 701000 xent               TSX1    FINDD_6
        31 001642   001651 702000 31                 TSX2    DBCS_ERR

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:65   
      376     1691    2       OL = ' ';

   1691 31 001643   040100 100400                    MLR     fill='040'O
        31 001644   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001645   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      377     1692    2       GOTO NORMAL;

   1692 31 001646   001622 710000 31                 TRA     NORMAL

      378     1693    2   ALT_END: ALTRETURN;

   1693 31 001647   200174 221300       ALT_END      LDX1  ! CHR_LEN+2,,AUTO
        31 001650   000000 702211                    TSX2  ! 0,X1

      379     1694    2   DBCS_ERR: CALL ABORT;

   1694 31 001651   000014 631400 32    DBCS_ERR     EPPR1   12
        31 001652   000000 701000 xent               TSX1    ABORT
        31 001653   000000 011000                    NOP     0

      380     1695    2   END;

   1695 31 001654   200174 221300                    LDX1  ! CHR_LEN+2,,AUTO
        31 001655   000001 702211                    TSX2  ! 1,X1

      381     1696    1   QTE:

   1696 31 001656   200174 741300       QTE          STX1  ! CHR_LEN+2,,AUTO

      382     1697    1       PROC(CST);
      383     1698    2   DCL CST CHAR(12);
      384     1699    2       CALL INDEX1(CHR_LEN,' ',CST);

   1699 31 001657   200175 470500                    LDP0    @CST,,AUTO
        31 001660   000000 124500                    SCM     mask='000'O
        31 001661   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:66   
        31 001662   000001 000001 32                 ADSC9   1                        cn=0,n=1
        31 001663   200172 000100                    ARG     CHR_LEN,,AUTO

      385     1700    2       CHR_LEN = CHR_LEN + 1;

   1700 31 001664   200172 235100                    LDA     CHR_LEN,,AUTO
        31 001665   000001 035007                    ADLA    1,DL
        31 001666   200172 755100                    STA     CHR_LEN,,AUTO

      386     1701    2       CALL CONCAT(CHR,'"',CST);

   1701 31 001667   200171 471500                    LDP1    CHR$,,AUTO
        31 001670   000000 620005                    EAX0    0,AL
        31 001671   040140 100400                    MLR     fill='040'O
        31 001672   000036 000001 32                 ADSC9   30                       cn=0,n=1
        31 001673   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        31 001674   200172 236100                    LDQ     CHR_LEN,,AUTO
        31 001675   000002 116007                    CMPQ    2,DL
        31 001676   001703 602000 31                 TNC     s:1702
        31 001677   777777 620006                    EAX0    -1,QL
        31 001700   040140 100500                    MLR     fill='040'O
        31 001701   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
        31 001702   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0

      387     1702    2       CHR_LEN = CHR_LEN + 1;

   1702 31 001703   000001 036007                    ADLQ    1,DL
        31 001704   200172 756100                    STQ     CHR_LEN,,AUTO

      388     1703    2       CALL INSERT(CHR,CHR_LEN - 1,1,'"');

   1703 31 001705   040106 100400                    MLR     fill='040'O
        31 001706   000036 000001 32                 ADSC9   30                       cn=0,n=1
        31 001707   177777 600001                    ADSC9   -1,Q,PR1                 cn=3,n=1

      389     1704    2   END;

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:67   
   1704 31 001710   200174 221300                    LDX1  ! CHR_LEN+2,,AUTO
        31 001711   000001 702211                    TSX2  ! 1,X1

      390     1705    1   DO_USE_PROC:
      391     1706    2       IF UNLCKED = 0 THEN DO;

   1706 31 001712   000050 235000 1     DO_USE_PROC  LDA     UNLCKED
        31 001713   001742 601000 31                 TNZ     CLOS

      392     1707    2           CALL LIST(B128);

   1707 31 001714   000032 630400 32                 EPPR0   26
        31 001715   000000 631400 32                 EPPR1   0
        31 001716   000000 701000 xent               TSX1    LIST
        31 001717   000000 011000                    NOP     0

      393     1708    2           OL = 'ALL DML FUNCTIONS REFERENCED BY LOCK';

   1708 31 001720   040100 100400                    MLR     fill='040'O
        31 001721   000213 000044 30                 ADSC9   139                      cn=0,n=36
        31 001722   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

      394     1709    2           CALL LIST(OL);

   1709 31 001723   200005 630500                    EPPR0   OL,,AUTO
        31 001724   200200 450500                    STP0    Y+1,,AUTO
        31 001725   200200 630500                    EPPR0   Y+1,,AUTO
        31 001726   000000 631400 32                 EPPR1   0
        31 001727   000000 701000 xent               TSX1    LIST
        31 001730   000000 011000                    NOP     0

      395     1710    2           OL = 'VARIABLES ARE LOCKED.';

   1710 31 001731   040100 100400                    MLR     fill='040'O
        31 001732   000224 000025 30                 ADSC9   148                      cn=0,n=21
        31 001733   200005 000200                    ADSC9   OL,,AUTO                 cn=0,n=128

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:68   
      396     1711    2           CALL LIST(OL);

   1711 31 001734   200005 630500                    EPPR0   OL,,AUTO
        31 001735   200200 450500                    STP0    Y+1,,AUTO
        31 001736   200200 630500                    EPPR0   Y+1,,AUTO
        31 001737   000000 631400 32                 EPPR1   0
        31 001740   000000 701000 xent               TSX1    LIST
        31 001741   000000 011000                    NOP     0

      397     1712    2           END;

      398     1713    1   CLOS:
      399     1714    1       RETURN;

   1714 31 001742   000000 702200 xent  CLOS         TSX2  ! X66_ARET

      400     1715    1   L3:
      401     1716    1       CALL CONCAT(OL,'ILLEGAL PRIVACY KEY - ' , LOCKS.LOCKS_KEY);

   1716 31 001743   040100 100400       L3           MLR     fill='040'O
        31 001744   000232 000026 30                 ADSC9   154                      cn=0,n=22
        31 001745   200005 000026                    ADSC9   OL,,AUTO                 cn=0,n=22
        31 001746   040100 100400                    MLR     fill='040'O
        31 001747   000001 000014 25                 ADSC9   LOCKS+1                  cn=0,n=12
        31 001750   200012 400152                    ADSC9   OL+5,,AUTO               cn=2,n=106

      402     1717    1       CALL LIST(OL);

   1717 31 001751   200005 630500                    EPPR0   OL,,AUTO
        31 001752   200200 450500                    STP0    Y+1,,AUTO
        31 001753   200200 630500                    EPPR0   Y+1,,AUTO
        31 001754   000000 631400 32                 EPPR1   0
        31 001755   000000 701000 xent               TSX1    LIST
        31 001756   000000 011000                    NOP     0

      403     1718    1       GOTO CLOS;

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:69   
   1718 31 001757   001742 710000 31                 TRA     CLOS

      404     1719    1   L5:
      405     1720    1       CALL CONCAT(OL,LNAME , ' LOCK NAME NOT IN DICTIONARY');

   1720 31 001760   040100 100500       L5           MLR     fill='040'O
        31 001761   200063 000036                    ADSC9   LNAME,,AUTO              cn=0,n=30
        31 001762   200005 000036                    ADSC9   OL,,AUTO                 cn=0,n=30
        31 001763   040100 100400                    MLR     fill='040'O
        31 001764   000240 000034 30                 ADSC9   160                      cn=0,n=28
        31 001765   200014 400142                    ADSC9   OL+7,,AUTO               cn=2,n=98

      406     1721    1       CALL LIST(OL);

   1721 31 001766   200005 630500                    EPPR0   OL,,AUTO
        31 001767   200200 450500                    STP0    Y+1,,AUTO
        31 001770   200200 630500                    EPPR0   Y+1,,AUTO
        31 001771   000000 631400 32                 EPPR1   0
        31 001772   000000 701000 xent               TSX1    LIST
        31 001773   000000 011000                    NOP     0

      407     1722    1       GOTO RD;

   1722 31 001774   000330 710000 31                 TRA     RD

      408     1723    1   DBCS_ERR:
      409     1724    1       CALL ABORT;

   1724 31 001775   000014 631400 32    DBCS_ERR     EPPR1   12
        31 001776   000000 701000 xent               TSX1    ABORT
        31 001777   000000 011000                    NOP     0

      410     1725    1   END;

   1725 31 002000   000000 702200 xent               TSX2  ! X66_ARET

DESC
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:70   
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

TYPE_NAME
 Sect OctLoc
   1     000   101122 105101   137116 101115   105040 040040   040040 040040    AREA_NAME
   1     004   040040 040040   040040 040040   040040 040040   040040 123105                  SE
   1     010   124137 116101   115105 040040   040040 040040   040040 040040    T_NAME
   1     014   040040 040040   040040 040040   040040 040040   113105 131137                KEY_
   1     020   116101 115105   040040 040040   040040 040040   040040 040040    NAME
   1     024   040040 040040   040040 040040   040040 122105   103117 122104              RECORD
   1     030   137116 101115   105040 040040   040040 040040   040040 040040    _NAME
   1     034   040040 040040   040040 040040   104101 124101   137116 101115            DATA_NAM
   1     040   105040 040040   040040 040040   040040 040040   040040 040040    E
   1     044   040040 040040   040040 ******                                          ..

LCKED
 Sect OctLoc
   1     046   000000 000000                                                    ....

BUFSZ
 Sect OctLoc
   1     047   000000 000031                                                    ....

UNLCKED
 Sect OctLoc
   1     050   000000 000000                                                    ....

X
 Sect OctLoc
   1     053   000000 000000                                                    ....

NOLK
 Sect OctLoc
   1     054   000000 000000                                                    ....

ELM_TYP
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:71   
 Sect OctLoc
   1     055   123103 110105   115101 101122   105101 040040   123105 124040    SCHEMAAREA  SET
   1     061   040040 122105   103117 122104   106111 105114   104040 ******      RECORDFIELD ..

SB36
 Sect OctLoc
   1     065   000000 000000                                                    ....

NEW_SN
 Sect OctLoc
   1     066   0***** ******                                                    ....

R
 Sect OctLoc
   1     067   000000 000000                                                    ....

S
 Sect OctLoc
   1     070   000000 000000                                                    ....

T
 Sect OctLoc
   1     071   000000 000000                                                    ....

B128
 Sect OctLoc
   1     072   040040 040040   040040 040040   040040 040040   040040 040040
   1     126*  040040 040040   040040 040040   040040 040040   040040 040040

FTYP
 Sect OctLoc
   1     132   040103 040104   040114 040101   040040 040040   040040 040040     C D L A
   1     136   040040 040107   040115 040123   040104 040111   040122 040106       G M S D I R F

REC
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:72   

UWA_KEY
 Sect OctLoc
  10     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  12     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  13     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  15     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  15     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  15     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  15     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  16     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  16     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  16     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  16     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  16     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  16     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  16     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  16     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  17     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  17     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  17     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  17     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:73   
  17     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  17     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  17     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  17     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  18     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  18     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  18     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  18     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  18     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  18     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  18     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  18     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

UWA
 Sect OctLoc
  19     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  19     004   040040 040040   040040 040040   040040 040040   040040 040040
  19     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     014   040040 040040   040040 040040   040040 040040   040040 040040
  19     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     024   040040 040040   040040 040040   040040 040040   040040 040040
  19     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  19     040   040040 040040   040040 040040   040040 040040   040040 040040
  19     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     050   040040 040040   040040 040040   040040 040040   040040 040040
  19     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  19     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  19     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  19     070   040040 040040   040040 040040   040040 040040   040040 040040
  19     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  19     104   040040 040040   040040 040040   040040 040040   040040 040040
  19     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  19     130   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:74   
  19     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  19     140   040040 040040   040040 040040   040040 040040   040040 040040
  19     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  19     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     154   040040 040040   040040 040040   040040 040040   040040 040040
  19     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  19     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  19     174   040040 040040   040040 040040   040040 040040   040040 040040
  19     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  19     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  19     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  19     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  19     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  19     430   040040 040040   040040 040040   040040 040040   040040 040040
  19     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  19     440   040040 040040   040040 040040   040040 040040   040040 040040
  19     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  19     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  19     460   040040 040040   040040 040040   040040 040040   040040 040040
  19     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  19     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  19     504   040040 040040   040040 040040   040040 040040   040040 040040
  19     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  19     524   040040 040040   040040 040040   040040 040040   040040 040040
  19     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:75   
  19     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  19     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  19     614   040040 040040   040040 040040   040040 040040   040040 040040
  19     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  19     624   040040 040040   040040 040040   040040 040040   040040 040040
  19     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19     664   040040 040040   040040 040040   040040 040040   040040 040040
  19     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19     700   040040 040040   040040 040040   040040 040040   040040 040040
  19     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19     714   040040 040040   040040 040040   040040 040040   040040 040040
  19     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  19     724   040040 040040   040040 040040   040040 040040   040040 040040
  19     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19     744   040040 040040   040040 040040   040040 040040   040040 040040
  19     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1000   040040 040040   040040 040040   040040 040040   040040 040040
  19    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1040   040040 040040   040040 040040   040040 040040   040040 040040
  19    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1064   040040 040040   040040 040040   040040 040040   040040 040040
  19    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1120   040040 040040   040040 040040   040040 040040   040040 040040
  19    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1140   040040 040040   040040 040040   040040 040040   040040 040040
  19    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1154   040040 040040   040040 040040   040040 040040   040040 040040
  19    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1170   040040 040040   040040 040040   040040 040040   040040 040040
  19    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1204   040040 040040   040040 040040   040040 040040   040040 040040
  19    1214*  040040 040040   040040 040040   040040 040040   040040 040040

ANALS
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:76   
 Sect OctLoc
  20     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
  21     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
  22     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
 Sect OctLoc
  23     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
  23     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
  24     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
  25     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
  26     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
  27     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
  28     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:77   
 Sect OctLoc
  29     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
  30     000   123105 103125   122111 124131   040114 117103   113040 120122    SECURITY LOCK PR
  30     004   117103 105123   123117 122040   123106 040040   040040 040040    OCESSOR SF
  30     010   104101 040040   040040 040040   104101 055123   116040 040040    DA      DA-SN
  30     014   040111 123040   116117 124040   116101 115105   040117 106040     IS NOT NAME OF
  30     020   101123 123111   107116 105104   040123 103110   105115 101040    ASSIGNED SCHEMA
  30     024   106111 114105   101055 104040   040040 040040   123116 055114    FILEA-D     SN-L
  30     030   124040 040040   114113 055114   124040 040040   065052 040040    T   LK-LT   5*
  30     034   114117 103113   040116 101115   105040 101123   123111 107116    LOCK NAME ASSIGN
  30     040   115105 116124   040115 105123   123101 107105   123040 040040    MENT MESSAGES
  30     044   042116 125114   114042 040040   114113 040040   040040 040040    "NULL"  LK
  30     050   040040 040040   123116 040040   040040 040040   123116 055123        SN      SN-S
  30     054   111040 040040   123111 040040   040040 040040   105116 104040    I   SI      END
  30     060   114117 103113   040116 101115   105040 101123   123111 107116    LOCK NAME ASSIGN
  30     064   115105 116124   123040 040040   052052 052052   114117 103113    MENTS   ****LOCK
  30     070   040116 101115   105057 114117   103113 040126   101114 125105     NAME/LOCK VALUE
  30     074   040123 125115   115101 122131   052052 052040   114117 103113     SUMMARY*** LOCK
  30     100   040116 101115   105040 040040   040040 040040   040040 040040     NAME
  30     104   040040 040040   040040 040040   040040 040040   040114 117103                 LOC
  30     110   113040 126101   114125 105040   104101 055114   113040 040040    K VALUE DA-LK
  30     114   040040 040116   125114 114040   122105 123124   122111 103124       NULL RESTRICT
  30     120   105104 040106   125116 103124   111117 116123   040127 110111    ED FUNCTIONS WHI
  30     124   103110 040101   122105 040114   117103 113105   104052 052052    CH ARE LOCKED***
  30     130   123103 110105   115101 040105   114105 115105   116124 040116    SCHEMA ELEMENT N
  30     134   101115 105040   040040 040040   040040 040040   040040 040040    AME
  30     140   040040 124131   120105 040040   040040 040040   040106 125116      TYPE       FUN
  30     144   103124 111117   116123 040040   040040 040040   040040 040040    CTIONS
  30     150   114117 103113   040116 101115   105040 040040   040040 040040    LOCK NAME
  30     154   040040 040040   040040 040040   040040 040040   040040 040040
  30     160   114117 103113   040126 101114   125105 040040   101114 114040    LOCK VALUE  ALL
  30     164   104115 114040   106125 116103   124111 117116   123040 101122    DML FUNCTIONS AR
  30     170   105040 125116   114117 103113   105104 040040   122105 123124    E UNLOCKED  REST
  30     174   122111 103124   105104 040106   125116 103124   111117 116123    RICTED FUNCTIONS
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:78   
  30     200   040127 110111   103110 040101   122105 040125   116114 117103     WHICH ARE UNLOC
  30     204   113105 104052   052052 040040   116125 114114   123116 055123    KED***  NULLSN-S
  30     210   105040 040040   122103 055106   122040 040040   101114 114040    E   RC-FR   ALL
  30     214   104115 114040   106125 116103   124111 117116   123040 122105    DML FUNCTIONS RE
  30     220   106105 122105   116103 105104   040102 131040   114117 103113    FERENCED BY LOCK
  30     224   126101 122111   101102 114105   123040 101122   105040 114117    VARIABLES ARE LO
  30     230   103113 105104   056040 040040   111114 114105   107101 114040    CKED.   ILLEGAL
  30     234   120122 111126   101103 131040   113105 131040   055040 040040    PRIVACY KEY -
  30     240   040114 117103   113040 116101   115105 040116   117124 040111     LOCK NAME NOT I
  30     244   116040 104111   103124 111117   116101 122131                    N DICTIONARY

(unnamed)
 Sect OctLoc
  32     000   000001 000000   040040 040040   000002 000000   000000 000002    ....    ........
  32     004   000006 006000   000003 006000   000010 006000   000064 006000    .............4..
  32     010   000012 006000   000171 006000   000025 006000   000426 006000    .....y..........
  32     014   000000 000000   000473 006000   000027 006000   000031 006000    ................
  32     020   000447 406000   000033 006000   000014 006000   000004 000000    ................
  32     024   000052 006000   000047 006000   000046 006000   000051 006000    .*...'...&...)..
  32     030   000053 006000   000055 006000   000072 006000   000112 006000    .+...-...:...J..
  32     034   000207 006000   000211 006000   042040 040040                    ........"

PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:79   
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_FIVESTAR_DESC.:ZIC0TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure LOCK.

   Procedure LOCK requires 1025 words for executable code.
   Procedure LOCK requires 132 words of local(AUTO) storage.

    No errors detected in file ZIG$DDY1.:ZIC0TSI    .
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:80   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:81   
          MINI XREF LISTING

ABORT
        88**DCL-ENT  1694--CALL     1724--CALL
ALT_END IN PROCEDURE FETCH_AN_SN
      1693**LABEL    1686--CALLALT
B128
      1389**DCL      1503<>CALL     1506<>CALL     1523<>CALL     1527<>CALL     1535<>CALL     1578<>CALL
      1586<>CALL     1591<>CALL     1605<>CALL     1608<>CALL     1707<>CALL
B36 IN PROCEDURE FNCT
      1652**DCL      1660>>IF
BIT36
        64**DCL      1541>>ASSIGN   1541>>ASSIGN   1543>>IF       1600>>ASSIGN   1600>>ASSIGN   1602>>IF
BUFSZ
        56**DCL      1433<>CALL     1485<>CALL
C12
      1392**DCL      1558<>CALL     1559<>CALL     1570<>CALL     1571<>CALL     1624<>CALL     1625<>CALL
C20
      1346**DCL      1560>>CALLBLT  1621>>CALLBLT  1626>>CALLBLT  1657<<ASSIGN   1661<<CALLBLT
C32
      1391**DCL      1396--ASSIGN
C44
      1388**DCL      1551<<ASSIGN   1554<<CALLBLT  1556<<CALLBLT  1560>>CALLBLT  1613<<ASSIGN   1616<<CALLBLT
      1618<<CALLBLT  1621>>CALLBLT  1626>>CALLBLT
C64
      1387**DCL      1397<<ASSIGN   1398<>CALL     1524<<ASSIGN   1525>>CALLBLT  1569<<ASSIGN   1572>>CALLBLT
      1587<<ASSIGN   1588>>CALLBLT  1636<<ASSIGN   1637>>CALLBLT
C96
      1390**DCL      1637<<CALLBLT  1644>>CALLBLT
CHECK_LT
      1540**LABEL    1568--GOTO
CHECK_NEXT
      1421**LABEL    1422--GOTO     1427--GOTO
CHK_OR
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:82   
      1566**LABEL    1575--GOTO
CHK_OR2
      1633**LABEL    1647--GOTO
CHR
      1393**DCL      1514>>CALLBLT  1560>>CALLBLT  1572>>CALLBLT  1626>>CALLBLT  1639<<ASSIGN   1644>>CALLBLT
      1701<<CALLBLT  1703<<CALLBLT
CHR$
      1394**DCL      1393--IMP-PTR  1396<<ASSIGN   1514>>CALLBLT  1560>>CALLBLT  1572>>CALLBLT  1626>>CALLBLT
      1639>>ASSIGN   1644>>CALLBLT  1701>>CALLBLT  1703>>CALLBLT
CHR_LEN
      1395**DCL      1393--IMP-SIZ  1514>>CALLBLT  1560>>CALLBLT  1572>>CALLBLT  1626>>CALLBLT  1638<<ASSIGN
      1639>>ASSIGN   1644>>CALLBLT  1699<<CALLBLT  1700<<ASSIGN   1700>>ASSIGN   1701>>CALLBLT  1702<<ASSIGN
      1702>>ASSIGN   1703>>CALLBLT  1703>>CALLBLT
CK_LKV
      1429**LABEL    1418--GOTO     1426--GOTO
CLOS
      1714**LABEL    1408--GOTO     1718--GOTO
CONTINUE_LT
      1599**LABEL    1635--GOTO
CST IN PROCEDURE QTE
      1698**DCL      1697--PROC     1699>>CALLBLT  1701>>CALLBLT
DBCS_ERR
      1724**LABEL    1400--CALLALT  1402--CALLALT  1403--CALLALT  1416--CALLALT  1423--CALLALT  1455--CALLALT
      1458--CALLALT  1460--CALLALT  1464--CALLALT  1479--CALLALT  1498--CALLALT  1507--CALLALT  1528--CALLALT
      1538--CALLALT  1567--CALLALT  1592--CALLALT  1611--CALLALT  1634--CALLALT
DBCS_ERR IN PROCEDURE FETCH_AN_SN
      1694**LABEL    1670--CALLALT  1673--CALLALT  1677--CALLALT  1682--CALLALT  1690--CALLALT
DESC
        25**DCL        26--REDEF      35--REDEF      38--REDEF      43--REDEF
DO_USE_PROC
      1706**LABEL    1595--CALLALT
ELM_TYP
      1359**DCL      1554>>CALLBLT  1556>>CALLBLT  1616>>CALLBLT  1618>>CALLBLT
ETYP
      1358**DCL      1550<<ASSIGN   1554>>CALLBLT  1556>>CALLBLT  1612<<ASSIGN   1616>>CALLBLT  1618>>CALLBLT
FCURR_R_6
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:83   
      1309**DCL-ENT  1528--CALL     1592--CALL     1670--CALL
FETCHC_6
      1305**DCL-ENT  1450--CALL
FETCHD_6
      1307**DCL-ENT  1400--CALL     1402--CALL     1498--CALL     1507--CALL
FETCHNS_6
      1312**DCL-ENT  1403--CALL     1421--CALL     1457--CALL     1462--CALL     1509--CALL     1537--CALL
      1566--CALL     1597--CALL     1633--CALL     1673--CALL     1675--CALL     1681--CALL     1686--CALL
FETCHOS_6
      1316**DCL-ENT  1423--CALL     1458--CALL     1538--CALL     1567--CALL     1611--CALL     1634--CALL
      1677--CALL     1682--CALL
FETCH_AN_SN
      1667**PROC     1532--CALL     1595--CALL
FINDD_6
      1308**DCL-ENT  1690--CALL
FIVESTAREOF
      1345**DCL      1433<>CALL     1437>>DOWHILE  1485<>CALL
FNCT
      1649**PROC     1557--CALL     1619--CALL
FTYP IN PROCEDURE FNCT
      1654**DCL      1661>>CALLBLT
GET_TIME
        99**DCL-ENT  1412--CALL
HOLD_PLACE
      1363**DCL      1671<<ASSIGN   1690<>CALL
L3
      1716**LABEL    1421--CALLALT
L5
      1720**LABEL    1450--CALLALT
LCKBTS_RDEF
      1347**DCL      1418>>IF       1422>>IF
LCKD_ELM_LST
      1519**LABEL    1509--CALLALT
LCKED
        55**DCL      1534<<ASSIGN   1534>>ASSIGN   1577>>IF
LIST
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:84   
        95**DCL-ENT  1407--CALL     1436--CALL     1490--CALL     1500--CALL     1502--CALL     1503--CALL
      1505--CALL     1506--CALL     1516--CALL     1520--CALL     1522--CALL     1523--CALL     1526--CALL
      1527--CALL     1535--CALL     1546--CALL     1548--CALL     1561--CALL     1573--CALL     1578--CALL
      1580--CALL     1583--CALL     1585--CALL     1586--CALL     1589--CALL     1591--CALL     1605--CALL
      1607--CALL     1608--CALL     1628--CALL     1645--CALL     1707--CALL     1709--CALL     1711--CALL
      1717--CALL     1721--CALL
LKV
      1362**DCL      1425<>CALL     1426>>IF       1444<<ASSIGN   1446<<ASSIGN   1451>>IF       1454>>ASSIGN
      1472--ASSIGN   1512<>CALL     1513<>CALL     1641<>CALL     1642<>CALL
LNAME
      1369**DCL      1441<<ASSIGN   1448>>ASSIGN   1720>>CALLBLT
LOCKS.ASSIGNS
      1262**DCL      1430>>IF
LOCKS.LIST
      1261**DCL      1497>>IF
LOCKS.LOCKS_KEY
      1265**DCL      1426>>IF       1716>>CALLBLT
LOCKS.SNAME
      1266**DCL      1404>>IF       1405>>IF       1406>>CALLBLT
LOCK_DESC
        38**DCL      1434<<ASSIGN   1486<<ASSIGN
LOCK_DESC.LOCK_NAME
        40**DCL      1441>>ASSIGN
LOCK_DESC.LOCK_VALUE
        41**DCL      1446>>ASSIGN
LOCK_DESC.NULLL
        39**DCL      1443>>IF
LPTR
      1357**DCL      1380--IMP-PTR  1471<<ASSIGN   1473>>ASSIGN   1474>>ASSIGN   1475>>ASSIGN   1476>>ASSIGN
      1477>>ASSIGN   1478>>ASSIGN
LTYPES IN PROCEDURE FNCT
      1650**DCL      1649--PROC     1656--ASSIGN
LVALUE.B1
      1381**DCL      1473<<ASSIGN
LVALUE.B2
      1382**DCL      1474<<ASSIGN
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:85   
LVALUE.B3
      1383**DCL      1475<<ASSIGN
LVALUE.B4
      1384**DCL      1476<<ASSIGN
LVALUE.B5
      1385**DCL      1477<<ASSIGN
LVALUE.B6
      1386**DCL      1478<<ASSIGN
MODIFY_6
      1310**DCL-ENT  1455--CALL     1460--CALL     1464--CALL     1479--CALL
MSK_18B
      1355**DCL      1415<<ASSIGN   1415>>ASSIGN
NEW_SN
      1364**DCL      1552>>IF       1564<<ASSIGN   1605>>IF       1614>>IF       1631<<ASSIGN   1668<<ASSIGN
NEXT_FR IN PROCEDURE FETCH_AN_SN
      1675**LABEL    1676--GOTO
NEXT_LK1
      1509**LABEL    1517--GOTO
NEXT_LT1
      1537**LABEL    1543--GOTO
NEXT_LT2
      1597**LABEL    1602--GOTO
NEXT_SN1
      1532**LABEL    1533--GOTO     1537--CALLALT  1566--CALLALT
NEXT_SN2
      1595**LABEL    1597--CALLALT  1633--CALLALT
NORMAL IN PROCEDURE FETCH_AN_SN
      1686**LABEL    1687--GOTO     1692--GOTO
OL
        60**DCL      1399<<ASSIGN   1406<<CALLBLT  1407<>CALL     1435<<ASSIGN   1436<>CALL     1489<<ASSIGN
      1490<>CALL     1499<<ASSIGN   1500<>CALL     1501<<ASSIGN   1502<>CALL     1504<<ASSIGN   1505<>CALL
      1510<<CALLBLT  1514<<CALLBLT  1516<>CALL     1519<<ASSIGN   1520<>CALL     1521<<ASSIGN   1522<>CALL
      1525<<CALLBLT  1526<>CALL     1530<<ASSIGN   1545>>IF       1546<>CALL     1547<<ASSIGN   1548<>CALL
      1560<<CALLBLT  1561<>CALL     1562<<ASSIGN   1572<<CALLBLT  1573<>CALL     1574<<ASSIGN   1579<<ASSIGN
      1580<>CALL     1582<<ASSIGN   1583<>CALL     1584<<ASSIGN   1585<>CALL     1588<<CALLBLT  1589<>CALL
      1590<<ASSIGN   1606>>IF       1607<>CALL     1609<<ASSIGN   1621<<CALLBLT  1626<<CALLBLT  1628<>CALL
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:86   
      1629<<ASSIGN   1644<<CALLBLT  1645<>CALL     1646<<ASSIGN   1672<<ASSIGN   1691<<ASSIGN   1708<<ASSIGN
      1709<>CALL     1710<<ASSIGN   1711<>CALL     1716<<CALLBLT  1717<>CALL     1720<<CALLBLT  1721<>CALL
P IN PROCEDURE FNCT
      1651**DCL      1652--IMP-PTR  1656<<ASSIGN   1660>>IF
PLB
        59**DCL        58--IMP-PTR  1347--IMP-PTR  1417<<ASSIGN   1418>>IF       1419<<ASSIGN   1422>>IF
      1429<<ASSIGN
PP
      1356**DCL      1415--ASSIGN
QTE
      1697**PROC     1513--CALL     1559--CALL     1571--CALL     1625--CALL     1642--CALL
RD
      1485**LABEL    1457--CALLALT  1722--GOTO
RDYPL
      1348**DCL-ENT  1496--CALL
RESET_DASN IN PROCEDURE FETCH_AN_SN
      1690**LABEL    1675--CALLALT  1681--CALLALT
SB36
      1361**DCL      1540<<ASSIGN   1541<<ASSIGN   1543>>IF       1599<<ASSIGN   1600<<ASSIGN   1602>>IF
SCRAMB.BITS1
      1375**DCL      1474>>ASSIGN   1476>>ASSIGN   1478>>ASSIGN
SCRAMB.BITS2
      1376**DCL      1473>>ASSIGN   1475>>ASSIGN   1477>>ASSIGN
SPTR
      1354**DCL      1372--IMP-PTR  1377--IMP-PTR  1472<<ASSIGN   1473>>ASSIGN   1474>>ASSIGN   1475>>ASSIGN
      1476>>ASSIGN   1477>>ASSIGN   1478>>ASSIGN
STRE_6
      1304**DCL-ENT  1416--CALL
STYPE
        61**DCL      1563<<ASSIGN   1568>>IF       1630<<ASSIGN   1635>>IF
SUBLST
        97**DCL-ENT  1398--CALL
SUBSCHEMA_KEY
       115**DCL       116--REDEF
UCLOSE
       104**DCL-ENT  1488--CALL
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:87   
UGET
       102**DCL-ENT  1433--CALL     1485--CALL
ULCKD_ELM_LST
      1577**LABEL    1532--CALLALT
UN1
      1467**LABEL    1462--CALLALT
UNLCKED
        57**DCL      1604<<ASSIGN   1604>>ASSIGN   1706>>IF
UNSC
        63**DCL-ENT  1425--CALL     1512--CALL     1558--CALL     1570--CALL     1624--CALL     1641--CALL
UOPEN
       101**DCL-ENT  1432--CALL
UWA.AC.CALC_NEXT
       943**DCL       944--REDEF
UWA.AC.CALC_PRIOR
       952**DCL       953--REDEF
UWA.AC.DEFAULTS
       904**DCL       905--REDEF
UWA.AC.FILE_CODE
       909**DCL       910--REDEF
UWA.AC.FLAG1.ERROR_TYPE
       906**DCL       907--REDEF
UWA.A_D.AD_DATE
       887**DCL      1412<>CALL
UWA.A_D.AD_FUNCTION
       886**DCL      1411<<ASSIGN
UWA.A_D.AD_IDENT
       888**DCL      1413<<ASSIGN
UWA.DIRECT_REF
       844**DCL      1671>>ASSIGN
UWA.FR.SYN
       998**DCL      1676>>IF
UWA.LK.PLNAME
      1064**DCL      1448<<ASSIGN   1510>>CALLBLT  1514>>CALLBLT  1560>>CALLBLT  1572>>CALLBLT  1621>>CALLBLT
      1626>>CALLBLT  1637>>CALLBLT
UWA.LK.PLVALUE
PL6.E3A0      #001=LOCK File=ZIG$DDY1.:ZIC0TSI                                   FRI 09/05/97 11:54 Page:88   
      1065**DCL      1425<>CALL     1454<<ASSIGN   1471--ASSIGN   1510>>IF       1512<>CALL     1558<>CALL
      1570<>CALL     1620>>IF       1624<>CALL     1639>>IF       1641<>CALL
UWA.LT.PLOCKS
      1076**DCL      1419--ASSIGN   1429--ASSIGN   1541--ASSIGN   1557<>CALL     1563>>ASSIGN   1568>>IF
      1600--ASSIGN   1619<>CALL     1630>>ASSIGN   1635>>IF
UWA.SF.DBKEY_DA
       854**DCL      1402<>CALL     1507<>CALL
UWA.SI.LOCKED
       873**DCL      1463<<ASSIGN
UWA.SN.ACTLCKS
      1061**DCL      1417--ASSIGN   1459<<ASSIGN   1533>>IF       1541--ASSIGN   1543--IF       1600--ASSIGN
      1602--IF       1672>>IF
UWA.SN.SENAME
      1062**DCL      1405>>IF       1554>>CALLBLT  1556>>CALLBLT  1616>>CALLBLT  1618>>CALLBLT  1672>>ASSIGN
UWA.SN.SETYPE
      1059**DCL      1529<<ASSIGN   1550>>ASSIGN   1553>>IF       1593<<ASSIGN   1612>>ASSIGN   1615>>IF
      1669>>IF       1680>>IF       1687>>IF
W25
        10**DCL      1434>>ASSIGN   1486>>ASSIGN
W25$
         9**DCL        10--IMP-PTR  1433<>CALL     1434>>ASSIGN   1485<>CALL     1486>>ASSIGN
X
      1351**DCL      1414<<ASSIGN   1415--ASSIGN   1659<<DOINDEX  1660>>IF       1661>>CALLBLT
Y IN PROCEDURE FNCT
      1653**DCL      1658<<ASSIGN   1661>>CALLBLT  1662<<ASSIGN   1662>>ASSIGN
