
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:1    
        1        1        /*M* ZIU$REPRT   IDS UTILITIES        REPORT RECORD STATISTICS  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8           NAME: ZIU$REPRT
        9        9        PURPOSE: This utility reports record statistics, keeping track of
       10       10                 the number of records of a type, the min and max record
       11       11                 size, the total size consumed by this sort of record,
       12       12                 the high and low dbkey for this type of record, and a                   
       13       13                 grand total for the size of the database.  It also
       14       14                 reports space usage and dbkeys usage per page.
       15       15                                                                         */
       16       16        ZIU$REPRT: PROC NOAUTO ALTRET;
       17       17
       18       18    1   DCL HIGH_DATA_PG SBIN WORD SYMREF ALIGNED;
       19       19    1   DCL I_O_INDX SBIN WORD STATIC ALIGNED;
       20       20    1   DCL LOW_DBK SBIN WORD SYMREF ALIGNED;
       21       21    1   DCL LPP SBIN WORD SYMREF ALIGNED;
       22       22
       23       23    1   DCL 1 RECORD BASED(REC$) UBIN WORD CALIGNED;
       24       24    1   DCL 1 REC STATIC CALIGNED,
       25       25    1         2 TYPE UBIN HALF UNAL,
       26       26    1         2 LEN UBIN HALF UNAL;
       27       27    1   DCL 1 REC_REDEF REDEF REC UBIN WORD CALIGNED;
       28       28
       29       29    1   DCL RECS$ PTR STATIC ALIGNED;
       30       30    1   DCL 1 RECS(0:0) BASED(RECS$) ALIGNED, /*IF 'RECORDS=' SPECIFIED */
       31       31    1         2 NO_OF_RECS UBIN WORD UNAL, /* then this table parallels */
       32       32    1         2 TOT_SZ UBIN WORD UNAL, /* RECORD_LIST else it */
       33       33    1         2 LO_SZ UBIN WORD UNAL, /* parallels MSTR_REF */
       34       34    1         2 HI_SZ UBIN WORD UNAL,
       35       35    1         2 LO_DBKEY UBIN WORD ALIGNED,
       36       36    1         2 HI_DBKEY UBIN WORD ALIGNED,
       37       37    1         2 NO_OF_PAGES UBIN WORD UNAL,
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:2    
       38       38    1         2 * UBIN WORD ALIGNED; /* FOR FUTURE EXPANSION */
       39       39
       40       40    1   DCL 1 CALC_REC ALIGNED,
       41       41    1         2 NO_OF_RECS UBIN WORD UNAL,
       42       42    1         2 TOT_SZ UBIN WORD UNAL,
       43       43    1         2 LO_SZ UBIN WORD UNAL,
       44       44    1         2 HI_SZ UBIN WORD UNAL,
       45       45    1         2 LO_DBKEY UBIN WORD ALIGNED,
       46       46    1         2 HI_DBKEY UBIN WORD ALIGNED;
       47       47
       48       48    1   DCL 1 PH0 ALIGNED STATIC,
       49       49    1         2 VFC CHAR(1) INIT('0'),
       50       50    1         2 * CHAR(31) INIT(' '),
       51       51    1         2 AREA_NAME CHAR(30);
       52       52    1   DCL PH1 CHAR(48) ALIGNED STATIC INIT(
                52            '                               RECORD STATISTICS');
       53       53    1   DCL PH2 CHAR(48) ALIGNED STATIC INIT(
                53            '                               -----------------');
       54       54    1   DCL 1 PH3 ALIGNED STATIC,
       55       55    1         2 * CHAR(40) INIT('RECORD              SIZE IN  VAR      NU'),
       56       56    1         2 * CHAR(40) INIT('MBER     # BYTES      LOWEST     HIGHEST');
       57       57    1   DCL 1 PH4 ALIGNED STATIC,
       58       58    1         2 * CHAR(40) INIT('NAME                  BYTES   SZ       F'),
       59       59    1         2 * CHAR(40) INIT('OUND        USED       DBKEY       DBKEY');
       60       60
       61       61    1   DCL 1 RLINE CALIGNED,
       62       62    1         2 REC_NAME CHAR(22),
       63       63    1         2 LO_SZ CHAR(5),
       64       64    1         2 HI_SZ CHAR(5),
       65       65    1         2 NO_OF_RECS CHAR(12),
       66       66    1         2 TOT_SZ CHAR(12),
       67       67    1         2 LO_DBKEY CHAR(12),
       68       68    1         2 HI_DBKEY CHAR(12);
       69       69
       70       70    1   DCL PF1 CHAR(56) STATIC ALIGNED
       71       71    1    INIT('                                 ----------- -----------');
       72       72    1   DCL 1 PF2 STATIC ALIGNED,
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:3    
       73       73    1         2 * CHAR(32) INIT(' '),
       74       74    1         2 AREA_TOT_RECS CHAR(12),
       75       75    1         2 AREA_TOT_SZ CHAR(12),
       76       76    1         2 MSG CHAR(17) INIT(' = TOTALS FOR '),
       77       77    1         2 TYP CHAR(7);
       78       78    1   DCL 1 PF3 STATIC ALIGNED,
       79       79    1         2 * CHAR(50) INIT (' '),
       80       80    1         2 PRCNT_LINE,
       81       81    1           3 PRCNT_MSG CHAR(9) INIT (' '),
       82       82    1           3 PRCNT_USED CHAR(3) INIT (' '),
       83       83    1         2 * CHAR(18) INIT('% OF AREA USED');
       84       84
       85       85    1   DCL BLANK_LINE CHAR(1) STATIC ALIGNED INIT(' ');
       86       86
       87       87    1   DCL 1 OA ALIGNED,
       88       88    1         2 LO_SZ UBIN WORD UNAL,
       89       89    1         2 HI_SZ UBIN WORD UNAL,
       90       90    1         2 TOT_SZ UBIN WORD UNAL;
       91       91
       92       92    1   DCL OA_SZ UBIN WORD UNAL;
       93       93    1   DCL AREA_TOT_SZ UBIN(36) UNAL;
       94       94    1   DCL AREA_TOT_RECS UBIN(36) UNAL;
       95       95    1   DCL AREA_SZ_REAL UBIN DALIGNED;
       96       96    1   DCL REAL100 UBIN DALIGNED;
       97       97    1   DCL MPY_RSLT1_REAL UBIN DALIGNED;
       98       98    1   DCL NUM_PGS_REPORTED_REAL UBIN DALIGNED;
       99       99    1   DCL REAL4072 UBIN DALIGNED;
      100      100    1   DCL MPY_RSLT2_REAL UBIN DALIGNED;
      101      101    1   DCL OA_SZ_REAL UBIN DALIGNED;
      102      102    1   DCL SUBTRACT_RSLT_REAL UBIN DALIGNED;
      103      103    1   DCL DIV_RSLT_REAL UBIN DALIGNED;
      104      104    1   DCL PRCNT UBIN DALIGNED;
      105      105    1   DCL REAL4096 UBIN DALIGNED;
      106      106
      107      107    1   DCL NEED_SUMMARY BIT(1) UNAL STATIC; /* =1 if NO_AREAS>1 & AUTODUMP='1'B */
      108      108    1   DCL REC_IN_LIST BIT(1) UNAL; /* = 1 If this record name was specified */
      109      109    1   DCL INDX SBIN WORD STATIC INIT(0) ALIGNED;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:4    
      110      110    1   DCL REC_OK BIT(1) UNAL;
      111      111    1   DCL NUM_PGS_REPORTED UBIN WORD UNAL;
      112      112    1   DCL HIDBKY UBIN WORD ALIGNED STATIC INIT(BITBIN('777777777777'O));
      113      113
      114      114    1   DCL LAST_PAGE BIT(1) UNAL STATIC;
      115      115    1   DCL CLEAR_COUNTERS BIT(1) UNAL STATIC INIT('0'B);
      116      116
      117      117
      118      118    1   DCL DB_RECS$ PTR STATIC ALIGNED;
      119      119    1   DCL 1 DB_RECS(0:0) BASED(DB_RECS$) ALIGNED, /*IF REC= SPECIFIED */
      120      120    1         2 NO_OF_RECS UBIN WORD UNAL,
      121      121    1         2 TOT_SZ UBIN WORD UNAL,
      122      122    1         2 LO_SZ UBIN WORD UNAL,
      123      123    1         2 HI_SZ UBIN WORD UNAL,
      124      124    1         2 LO_DBKEY UBIN WORD UNAL,
      125      125    1         2 HI_DBKEY UBIN WORD UNAL,
      126      126    1         2 NO_OF_PAGES UBIN WORD UNAL,
      127      127    1         2 MSTRINDX UBIN HALF UNAL, /* INDX TO MSTR_REF FOR EACH REC */
      128      128    1         2 PA_INDX UBIN HALF UNAL; /* INDX TO PA TABLE FOR EACH PA_REC */
      129      129
      130      130    1   DCL Y SBIN WORD STATIC ALIGNED;
      131      131    1   DCL DESTROY_TBL SBIN STATIC ALIGNED;
      132      132    1   DCL PTR_SIZE UBIN WORD STATIC ALIGNED;
      133      133    1   DCL 1 PA_REC BASED(REC$) CALIGNED,
      134      134    1         2 * UBIN WORD UNAL, /* CONTROL WORD 1 */
      135      135    1         2 NOT_LOWEST_LEVEL BIT(1) UNAL,
      136      136    1         2 * UBIN(5) UNAL, /* FLAGS */
      137      137    1         2 ENTRIES UBIN(12) UNAL,
      138      138    1         2 AVAIL UBIN HALF UNAL,
      139      139    1         2 PTRS CHAR(PTR_SIZE) UNAL;
      140      140
      141      141    1   DCL ENTRY$ PTR STATIC ALIGNED;
      142      142    1   DCL 1 PA_ENTRY BASED(ENTRY$) CALIGNED,
      143      143    1         2 C UBIN(1) UNAL,
      144      144    1         2 * UBIN(17) UNAL,
      145      145    1         2 PTRS CHAR(PTR_SIZE) UNAL;
      146      146
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:5    
      147      147    1   DCL GROUP$ PTR STATIC ALIGNED;
      148      148    1   DCL 1 PA_GROUP BASED(GROUP$) CALIGNED,
      149      149    1         2 NO_GROUPS UBIN HALF UNAL;
      150      150    1   DCL CHAR_V CHAR(PTR_SIZE) BASED CALIGNED;
      151      151    1   DCL PTR_BIN UBIN WORD STATIC ALIGNED;
      152      152
      153      153    1   DCL PAH1 CHAR(0) STATIC CALIGNED
      154      154    1    INIT('                               POINTER ARRAY RECORDS');
      155      155    1   DCL PAH2 CHAR(0) STATIC CALIGNED
      156      156    1    INIT('                               SPACE  USAGE  SUMMARY');
      157      157    1   DCL PAH3 CHAR(0) STATIC CALIGNED
      158      158    1    INIT('                               ---------------------');
      159      159    1   DCL PAH4 CHAR(0) STATIC CALIGNED
      160      160    1    INIT(
               160          'POINTER ARRAY          NUMBER FOUND            AVERAGE PER PA_REC        % SPACE'
               160             );
      161      161    1   DCL PAH5 CHAR(0) STATIC CALIGNED
      162      162    1    INIT(
               162          'SET NAME            OWNER PA_REC MEMBER   ENTRY-USED(RESed) BYTE-AVAIL      USED'
               162             );
      163      163    1   DCL 1 PAH6 STATIC CALIGNED,
      164      164    1         2 REC_NAME CHAR(20) CALIGNED,
      165      165    1         2 OWNER_FOUND CHAR(5) CALIGNED,
      166      166    1         2 PA_FOUND CHAR(6) CALIGNED,
      167      167    1         2 MEM_FOUND CHAR(8) CALIGNED,
      168      168    1         2 * CHAR(8) CALIGNED,
      169      169    1         2 NUMBER_PTR CHAR(3) CALIGNED,
      170      170    1         2 DOT1 CHAR(1) CALIGNED,
      171      171    1         2 NUMBER_PTR2 CHAR(1) CALIGNED,
      172      172    1         2 LEFT_PARAN CHAR(1) CALIGNED,
      173      173    1         2 ENT_RES CHAR(4) CALIGNED,
      174      174    1         2 RIGHT_PARAN CHAR(1) CALIGNED,
      175      175    1         2 SPACE_AVAIL CHAR(8) CALIGNED,
      176      176    1         2 DOT2 CHAR(1) CALIGNED,
      177      177    1         2 SPACE_AVAIL2 CHAR(1) CALIGNED,
      178      178    1         2 * CHAR(6) INIT(' ') CALIGNED,
      179      179    1         2 PERCENT_SPACE CHAR(3) CALIGNED,
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:6    
      180      180    1         2 PERCENT_MARK CHAR(2) CALIGNED;
      181      181    1   DCL OV1 CHAR(0) STATIC CALIGNED
      182      182    1    INIT(
               182           '                                            LOCATION    SET    AVG# OF AVG PAGE'
               182             );
      183      183    1   DCL OV3 CHAR(0) STATIC CALIGNED
      184      184    1    INIT(
               184             '  SETNAME                  MEMBER             MODE  OCCURENCES MEMBERS   SPAN'
               184             );
      185      185    1   DCL OV3A CHAR(0) STATIC CALIGNED
      186      186    1    INIT(
               186           '  _______                  ______            ____  ___________ _______ ________'
               186             );
      187      187    1   DCL 1 OV4 STATIC ALIGNED,
      188      188    1         2 X,
      189      189    1           3 SET CHAR(30) UNAL,
      190      190    1           3 * CHAR(16) UNAL,
      191      191    1         2 V REDEF X,
      192      192    1           3 * CHAR(15) UNAL,
      193      193    1           3 REC CHAR(30) UNAL,
      194      194    1           3 * CHAR(1) UNAL,
      195      195    1         2 LOC CHAR(6) UNAL,
      196      196    1         2 * CHAR(3) UNAL,
      197      197    1         2 SET CHAR(7) UNAL,
      198      198    1         2 * CHAR(1) UNAL,
      199      199    1         2 MEM CHAR(7) UNAL,
      200      200    1         2 * CHAR(1) UNAL,
      201      201    1         2 PGE CHAR(7) UNAL;
      202      202    1   DCL OV5 CHAR(0) STATIC CALIGNED
      203      203    1    INIT('                               OVERFLOW REPORT');
      204      204    1   DCL OV5A CHAR(0) STATIC CALIGNED
      205      205    1    INIT('                               ---------------');
      206      206
      207      207    1   DCL 1 DB_OA STATIC ALIGNED,
      208      208    1         2 LO_SZ UBIN WORD UNAL INIT(9999),
      209      209    1         2 HI_SZ UBIN WORD UNAL INIT(0),
      210      210    1         2 TOT_SZ UBIN WORD UNAL INIT(0);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:7    
      211      211
      212      212    1   DCL 1 DB_CALC_REC STATIC ALIGNED,
      213      213    1         2 NO_OF_RECS UBIN WORD UNAL INIT(0),
      214      214    1         2 TOT_SZ UBIN WORD UNAL INIT(0),
      215      215    1         2 LO_SZ UBIN WORD UNAL INIT(9999),
      216      216    1         2 HI_SZ UBIN WORD UNAL INIT(0),
      217      217    1         2 LO_DBKEY UBIN WORD ALIGNED INIT(BITBIN('777777777777'O)),
      218      218    1         2 HI_DBKEY UBIN WORD ALIGNED INIT(0);
      219      219
      220      220    1   DCL DB_TOT_SZ UBIN(36) STATIC UNAL INIT(0);
      221      221    1   DCL DB_TOT_RECS UBIN(36) STATIC UNAL INIT(0);
      222      222    1   DCL DB_NUM_PGS_REPORTED UBIN WORD STATIC ALIGNED INIT(0);
      223      223    1   DCL NUM_AREAS_REPORTED UBIN WORD UNAL STATIC INIT(0);
      224      224
      225      225    1   DCL PH5 CHAR(48) ALIGNED STATIC INIT(
               225            '                               PAGE   STATISTICS');
      226      226    1   DCL PH6 CHAR(68) ALIGNED STATIC INIT(
               226            '             DBKEY USAGE       -----------------         SPACE USAGE');
      227      227    1   DCL PH7 CHAR(68) ALIGNED STATIC INIT(
               227            '             -----------                                 -----------');
      228      228    1   DCL 1 PH8 ALIGNED STATIC,
      229      229    1         2 * CHAR(40) INIT('        # PAGES        % PAGES        % '),
      230      230    1         2 * CHAR(40) INIT('          # PAGES        % PAGES        ');
      231      231    1   DCL 1 PH9 ALIGNED STATIC,
      232      232    1         2 * CHAR(40) INIT('      THIS FULL      THIS FULL       FUL'),
      233      233    1         2 * CHAR(40) INIT('L       THIS FULL      THIS FULL        ');
      234      234
      235      235    1   DCL 1 PLINE ALIGNED STATIC,
      236      236    1         2 DNUM CHAR(15),
      237      237    1         2 DPRCNT CHAR(15),
      238      238    1         2 * CHAR(6) INIT(' '),
      239      239    1         2 PRCNT,
      240      240    1           3 * CHAR(3),
      241      241    1           3 HI CHAR(3),
      242      242    1         2 SNUM CHAR(15),
      243      243    1         2 SPRCNT CHAR(15);
      244      244
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:8    
      245      245    1   DCL 1 PGS(0:19) STATIC ALIGNED,
      246      246    1         2 DNUM UBIN WORD UNAL,
      247      247    1         2 DPRCNT UBIN WORD UNAL,
      248      248    1         2 PRCNT,
      249      249    1           3 * CHAR(2) INIT(' 0',' 5','10','15','20','25','30','35','40','45','50','55'
               249                    ,'60','65','70','75','80','85','90','95'),
      250      250    1           3 * CHAR(1) INIT('-'*0),
      251      251    1           3 HI CHAR(3)
      252      252    1   INIT('4  ','9  ','14 ','19 ','24 ','29 ','34 ','39 ','44 ','49 ','54 ','59 ','64 ',
               252            '69 ','74 ','79 ','84 ','89 ','94 ','100'),
      253      253    1         2 SNUM UBIN WORD UNAL,
      254      254    1         2 SPRCNT UBIN WORD UNAL;
      255      255    1   DCL 1 DB_PGS(0:19) STATIC ALIGNED,
      256      256    1         2 DNUM UBIN WORD UNAL,
      257      257    1         2 DPRCNT UBIN WORD UNAL,
      258      258    1         2 PRCNT,
      259      259    1           3 * CHAR(2) INIT(' 0',' 5','10','15','20','25','30','35','40','45','50','55'
               259                    ,'60','65','70','75','80','85','90','95'),
      260      260    1           3 * CHAR(1) INIT('-'*0),
      261      261    1           3 HI CHAR(3)
      262      262    1   INIT('4  ','9  ','14 ','19 ','24 ','29 ','34 ','39 ','44 ','49 ','54 ','59 ','64 ',
               262            '69 ','74 ','79 ','84 ','89 ','94 ','100'),
      263      263    1         2 SNUM UBIN WORD UNAL,
      264      264    1         2 SPRCNT UBIN WORD UNAL;
      265      265    1   DCL PRCNT_SPACE_FULL UBIN WORD ALIGNED;
      266      266    1   DCL PRCNT_DBKEYS_FULL UBIN WORD ALIGNED;
      267      267    1   DCL NUM_DBKEYS_UNUSED UBIN WORD ALIGNED;
      268      268    1   DCL NUM_DBKEYS_USED UBIN WORD ALIGNED;
      269      269    1   DCL PG_TOT_SZ UBIN WORD ALIGNED;
      270      270
      271      271         %INCLUDE ZI_GLOBAL_DBUTIL;
      272      449         %SYS_FUNC;
      273      541         %MISC_DCLS;
      274      594         %INCLUDE ZI$PG_STRUCTS;
      275      697         %ATBLK_PG;
      276      753         %DATA_PG;
      277      772         %INCLUDE ZI_DBU_XREF;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:9    
      278      939         %XREF_TBLS;
      279     1014         %INCLUDE ZI_ERRORS_SUBS;
      280     1534         %INCLUDE CP_6;
      281     1615         %F$DCB;
      282     1672         %INCLUDE CP_6_SUBS;
      283     2212         %INCLUDE ZI$DIR;
      284     2369         %INCLUDE ZI_UWA_C;
      285     3059         %ZI$UWAB;
      286     3399         %DIR;
      287     3543
      288     3544         %SUB OFFSET# = "2035 -";
      289     3545         %SUB #BUFS = 32;
      290     3546         %SUB NEVER = "WHILE('0'B)";
      291     3547         %SUB REPTBL# = 5;
      292     3548
      293     3549    1   DCL NUM_PA_RECS SBIN WORD STATIC ALIGNED;
      294     3550        /*    MAX_PA_SET IS SET TO 50 (121280) IN ZI_GLOBAL_DBUTIL */
      295     3551    1   DCL 1 PA(0:%MAX_PA_SET) ALIGNED AUTO,
      296     3552    1         2 RECSINDX UBIN HALF UNAL, /* POINT TO RECS INDX */
      297     3553    1         2 REC_SIZE UBIN HALF UNAL, /* SAVE PA REC SIZE */
      298     3554    1         2 OWNER_FOUND UBIN WORD ALIGNED,
      299     3555    1         2 MEM_FOUND UBIN WORD ALIGNED,
      300     3556    1         2 TOT_PTRS UBIN WORD ALIGNED,
      301     3557    1         2 SPACE_AVAIL UBIN WORD ALIGNED;
      302     3558    1   DCL BUILD_MSTR_TBL ENTRY ALTRET;
      303     3559    1   DCL BUILD_SETXREF ENTRY ALTRET;
      304     3560    1   DCL BUILD_RECXREF ENTRY ALTRET;
      305     3561    1   DCL CREATE_TBL_SEG ENTRY(2) ALTRET;
      306     3562    1   DCL EXPAND_TBL_SEG ENTRY(2) ALTRET;
      307     3563    1   DCL FREE_TBL ENTRY(2) ALTRET;
      308     3564    1   DCL SET_BUFS ENTRY(2) ALTRET;
      309     3565    1   DCL FREE_DYN_MEM ENTRY ALTRET;
      310     3566    1   DCL ZERO_SUP ENTRY(3);
      311     3567    1   DCL PAGE_RANGE ENTRY(6);
      312     3568    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
      313     3569    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
      314     3570    1   DCL SYS_FUNC_READ ENTRY ALTRET;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:10   
      315     3571    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
      316     3572    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      317     3573    1   DCL GET_DCB ENTRY(1) ALTRET;
      318     3574    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
      319     3575    1   DCL FLOAT ENTRY(2);
      320     3576    1   DCL FLOAT_ADD ENTRY(3);
      321     3577    1   DCL FLOAT_SUB ENTRY(3);
      322     3578    1   DCL FLOAT_MPY ENTRY(3);
      323     3579    1   DCL FLOAT_DIV ENTRY(3);
      324     3580    1   DCL FIX ENTRY(2);
      325     3581
      326     3582        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:11   
      327     3583        /*-----------------------------------------------------------------*/
      328     3584        /*    Open file and get page attributes.                           */
      329     3585        /*-----------------------------------------------------------------*/
      330     3586
      331     3587    1       DESTROY_TBL=0;
      332     3588    1       NUM_AREAS_REPORTED=0;
      333     3589    1       IF XREF_BUILT=%NO# THEN
      334     3590    2       DO;
      335     3591    2           CALL BUILD_MSTR_TBL ALTRET(ALTRTN);
      336     3592    2           CALL BUILD_SETXREF ALTRET(ALTRTN);
      337     3593    2           CALL BUILD_RECXREF ALTRET(ALTRTN);
      338     3594    2           END;
      339     3595    1       NUM_AREAS_REPORTED = 0;
      340     3596    1       IF ZI$DIR.AUTODUMP THEN /* IF REPORT ALL AREAS */
      341     3597    2       DO;
      342     3598    3           DO I=0 TO NO_AREAS-1; /* GET RID OFF ALL INDEXED AREAS */
      343     3599    3               IF AREA_KEY_XREF.MAX_KEY(I)=0 THEN /* INDEX AREA */
      344     3600    4               DO;
      345     3601    5                   DO J=I+1 TO NO_AREAS-1;
      346     3602    5                       AREA_KEY_XREF(J-1)=AREA_KEY_XREF(J);
      347     3603    5                       END;
      348     3604    4                   DESTROY_TBL=1; /* AREA TABLE WAS MESSED UP, DESTROY IT */
      349     3605    4                   NO_AREAS=NO_AREAS-1;
      350     3606    4                   I = I - 1;
      351     3607    4                   END;
      352     3608    3               END;
      353     3609    2           GOTO CLOSE_AREA;
      354     3610    2           END;
      355     3611    1   NEXT_AREA:
      356     3612    1   /**/ DCBSF = ZI$DIR.AREA_NM.DCB#;
      357     3613    1       ORGSF = %IDS#;
      358     3614    1       ASNSF = %FILE#;
      359     3615    1       ACSSF = %DIRECT#;
      360     3616    1       FUNSF = %IN#;
      361     3617    1       SHARESF = %ALL#;
      362     3618    1       FIDSF = ZI$DIR.AREA_NM.NAME.TEXT;
      363     3619    1       CALL SYS_FUNC_OPEN ALTRET(ALTRTN);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:12   
      364     3620
      365     3621    1       CALL GET_ATBLK(HIGH_DATA_PG) ALTRET(ALTRTN);
      366     3622
      367     3623    1       LAST_PAGE = %NO#;
      368     3624    1       OA.LO_SZ = 9999;
      369     3625    1       OA.HI_SZ = 0;
      370     3626    1       OA.TOT_SZ = 0;
      371     3627    1       NUM_PGS_REPORTED = 0;
      372     3628    1       AREA_TOT_SZ = 0;
      373     3629    1       AREA_TOT_RECS = 0;
      374     3630    1       PH0.AREA_NAME = ZI$DIR.AREA_NM.NAME.TEXT;
      375     3631    1       NUM_AREAS_REPORTED = NUM_AREAS_REPORTED + 1;
      376     3632
      377     3633    2       IF NUM_AREAS_REPORTED = 1 THEN DO;
      378     3634    2           NUM_PA_RECS=-1;
      379     3635    2           CALL SET_BUFS(,32);
      380     3636    2           CALL CREATE_TBL_SEG(RECS$,REPTBL#) ALTRET(ALTRTN);
      381     3637    2           X = ((NO_RECS * 16) / 1024) + 1; /* No pages needed for table */
      382     3638    2           IF X > 1 THEN CALL EXPAND_TBL_SEG(X,REPTBL#) ALTRET(ALTRTN);
      383     3639    2           DB_RECS$=PINCRW(RECS$,X*512); /*HALF WAY POINT OF SEGMENT */
      384     3640    2           END;
      385     3641
      386     3642        /*  If 'REC' NOT specified,
      387     3643               then
      388     3644                   if this is the first call
      389     3645                      then initialize summary items
      390     3646                   initialize area items
      391     3647            If 'REC' specified
      392     3648               then
      393     3649                    if this is the first call
      394     3650                      then
      395     3651                          verify record names specified
      396     3652                          initialize area items
      397     3653                          initialize summary items
      398     3654                   if this is not the first call
      399     3655                      then
      400     3656                          initialize area items
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:13   
      401     3657                                                                    */
      402     3658    1       IF RCNT = -1
      403     3659    1       THEN
      404     3660    2       DO;
      405     3661    2           IF (NUM_AREAS_REPORTED = 1) & (ZI$DIR.AUTODUMP = '1'B)
      406     3662    2           THEN
      407     3663    3           DO;
      408     3664    3               DB_TOT_SZ = 0;
      409     3665    3               DB_TOT_RECS = 0;
      410     3666    3               DB_NUM_PGS_REPORTED = 0;
      411     3667    3               DB_CALC_REC = '0'B;
      412     3668    3               DB_CALC_REC.LO_SZ = 9999;
      413     3669    3               DB_CALC_REC.LO_DBKEY = HIDBKY;
      414     3670    3               DB_OA.LO_SZ = 9999;
      415     3671    3               DB_OA.HI_SZ = 0;
      416     3672    3               DB_OA.TOT_SZ = 0;
      417     3673    4               DO X = 0 TO (NO_RECS -1 );
      418     3674    4                   DB_RECS.LO_SZ(X) = 9999;
      419     3675    4                   DB_RECS.LO_DBKEY(X) = HIDBKY;
      420     3676    4                   DB_RECS.NO_OF_RECS(X)=0;
      421     3677    4                   DB_RECS.TOT_SZ(X) = 0;
      422     3678    4                   DB_RECS.HI_SZ(X) = 0;
      423     3679    4                   DB_RECS.HI_DBKEY(X) = 0;
      424     3680    4                   DB_RECS.NO_OF_PAGES(X) = 0;
      425     3681    4                   END;
      426     3682    3               END;
      427     3683    3           DO X = 0 TO (NO_RECS - 1);
      428     3684    3               RECS.NO_OF_RECS(X) = 0;
      429     3685    3               DB_RECS.MSTRINDX(X)=X; /* TWO TABLES ARE PARALLEL */
      430     3686    3               END;
      431     3687    2           CALC_REC = '0'B;
      432     3688    2           PF2.TYP = 'AREA';
      433     3689    2           NEED_SUMMARY = (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS > 1);
      434     3690    2           END;
      435     3691    1       ELSE
      436     3692    2       DO;
      437     3693    2           IF NUM_AREAS_REPORTED = 1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:14   
      438     3694    2           THEN
      439     3695    3           DO;
      440     3696    4               DO X = 0 TO RCNT;
      441     3697    4                   REC_OK = '0'B;
      442     3698    4                   IF RECORD_LIST.NAME(X)='*CALC' THEN
      443     3699    4                       RECORD_LIST.NAME(X)='*CALC.RC'; /* USE INTERNAL NAME */
      444     3700    5                   DO I = 0 TO (NO_RECS - 1);
      445     3701    5                       IF (RECORD_LIST.NAME(X) = MSTR_REF.NAME(I))
      446     3702    5                       THEN
      447     3703    6                       DO;
      448     3704    6                           REC_OK = '1'B;
      449     3705    6                           RECORD_LIST.TYPE(X) = MSTR_REF.TYPE(I);
      450     3706    6                           DB_RECS.MSTRINDX(X)=I; /* REMEMBER THE MSTRINDX */
      451     3707    6                           IF MSTR_REF.PAOFF(I) > 0 AND
      452     3708    6                              (ZI$DIR.REPRT_ALL OR ZI$DIR.REPRT_PA) THEN
      453     3709    7                           DO;
      454     3710    7                               NUM_PA_RECS=NUM_PA_RECS+1;
      455     3711    7                               DB_RECS.PA_INDX(X)=NUM_PA_RECS;
      456     3712    7                               PA.RECSINDX(NUM_PA_RECS)=X; /* BLINK $ FLINK */
      457     3713    7                               END;
      458     3714    6                           I = NO_RECS;
      459     3715    6                           END;
      460     3716    5                       END;
      461     3717    4                   IF REC_OK AND ZI$DIR.REPRT_PA AND
      462     3718    4                      MSTR_REF.PAOFF(DB_RECS.MSTRINDX(X))=0 THEN
      463     3719    5                   DO;
      464     3720        /*E* ERROR: ZIU-DBU#NOTPAREP-C
      465     3721           MESSAGE: The record "%U1" is not a PA_REC. */
      466     3722    5                       ERRCODESF.ERR# = DBU#NOTPAREP;
      467     3723    5                       GOTO PRINT_ERRMSG;
      468     3724    5                       END;
      469     3725    4                   IF REC_OK = '0'B
      470     3726    4                   THEN
      471     3727    5                   DO;
      472     3728    5                       ERRCODESF.ERR# = DBU#NOREC;
      473     3729    5   PRINT_ERRMSG:
      474     3730    5                       CALL INDEX(INDX,' ',RECORD_LIST.NAME(X));
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:15   
      475     3731    5                       ERR_INSERT.CNT(0) = INDX;
      476     3732    5                       ERR_INSERT.TEXT(0) = RECORD_LIST.NAME(X);
      477     3733    5                       MSGCODE = ERRCODE_RDEF;
      478     3734    5                       CALL SYS_FUNC_ERRMSG;
      479     3735    5                       CALL SYS_FUNC_CLOS;
      480     3736    5                       CALL FREE_TBL(,REPTBL#);
      481     3737    5                       ALTRETURN;
      482     3738    5                       END;
      483     3739    4                   RECS.NO_OF_RECS(X) = 0;
      484     3740    4                   END;
      485     3741
      486     3742    4               IF ZI$DIR.AUTODUMP = '1'B THEN DO;
      487     3743    4                   DB_TOT_SZ = 0;
      488     3744    4                   DB_TOT_RECS = 0;
      489     3745    4                   DB_NUM_PGS_REPORTED = 0;
      490     3746    4                   DB_CALC_REC = '0'B;
      491     3747    4                   DB_CALC_REC.LO_SZ = 9999;
      492     3748    4                   DB_CALC_REC.LO_DBKEY = HIDBKY;
      493     3749    4                   DB_OA.LO_SZ = 9999;
      494     3750    4                   DB_OA.HI_SZ = 0;
      495     3751    4                   DB_OA.TOT_SZ = 0;
      496     3752    5                   DO X = 0 TO RCNT;
      497     3753    5                       DB_RECS.LO_SZ(X) = 9999;
      498     3754    5                       DB_RECS.LO_DBKEY(X) = HIDBKY;
      499     3755    5                       DB_RECS.TOT_SZ(X) = 0;
      500     3756    5                       DB_RECS.HI_SZ(X) = 0;
      501     3757    5                       DB_RECS.HI_DBKEY(X) = 0;
      502     3758    5                       DB_RECS.NO_OF_PAGES(X) = 0;
      503     3759    5                       END;
      504     3760    4                   END;
      505     3761    3               PF2.TYP = 'AREA';
      506     3762    3               CALC_REC = '0'B;
      507     3763    3               NEED_SUMMARY = (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS > 1);
      508     3764    3               END;
      509     3765    2           ELSE
      510     3766    3           DO X = 0 TO RCNT;
      511     3767    3               RECS.NO_OF_RECS(X) = 0;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:16   
      512     3768    3               END;
      513     3769    2           END;
      514     3770
      515     3771    2       IF (ZI$DIR.REPRT_PG = '1'B) | (ZI$DIR.REPRT_ALL = '1'B) THEN DO;
      516     3772    2           IF (NUM_AREAS_REPORTED = 1) & (ZI$DIR.AUTODUMP = '1'B) THEN
      517     3773    3           DO X = 0 TO 19;
      518     3774    3               DB_PGS.SNUM(X) = 0;
      519     3775    3               DB_PGS.SPRCNT(X) = 0;
      520     3776    3               DB_PGS.DNUM(X) = 0;
      521     3777    3               DB_PGS.DPRCNT(X) = 0;
      522     3778    3               END;
      523     3779    3           DO X = 0 TO 19;
      524     3780    3               PGS.SNUM(X) = 0;
      525     3781    3               PGS.SPRCNT(X) = 0;
      526     3782    3               PGS.DNUM(X) = 0;
      527     3783    3               PGS.DPRCNT(X) = 0;
      528     3784    3               END;
      529     3785    2           END;
      530     3786    1       IF NUM_AREAS_REPORTED=1 THEN /* FIRST TIME THRU */
      531     3787    2       DO;
      532     3788    2           IF RCNT=-1 THEN
      533     3789    2               X=NO_RECS-1;
      534     3790    2           ELSE
      535     3791    2               X=RCNT; /* NUMBER OF RECORDS TO BE SEARCHED FOR */
      536     3792    3           DO Y=0 TO X;
      537     3793    3               DB_RECS.NO_OF_RECS(Y)=0; /* SET THIS OVER-ALL COUNT TO 0 */
      538     3794    3               END;
      539     3795    2           END;
      540     3796
      541     3797    1       CALL PAGE_RANGE(RB,RE,#BUFS,I_O_SIZE,HIGH_DATA_PG,LAST_PAGE);
      542     3798        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:17   
      543     3799        /*------------------------------------------------------------------------*/
      544     3800        /*    Process  the reading of the data base #BUFS pages at a time.        */
      545     3801        /*------------------------------------------------------------------------*/
      546     3802    2       DO WHILE(~LAST_PAGE);
      547     3803
      548     3804    2           I_O_INDX = 0;
      549     3805    2    /**/   DCBSF = ZI$DIR.AREA_NM.DCB#;
      550     3806    2           BUFSF = VECTOR(I_O_BUF);
      551     3807    2           BUFLNSF = 4096 * I_O_SIZE;
      552     3808    2           FULLSF = %YES#;
      553     3809    2           KEYSF = %YES#;
      554     3810    2           KEYVSF.IDSKEY = RB;
      555     3811    2           ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;
      556     3812    2           CALL SYS_FUNC_READ ALTRET(ALTRTN);
      557     3813
      558     3814    3           DO RB = RB TO RE;
      559     3815    3               DATA$ = ADDR(I_O_BUF(I_O_INDX));
      560     3816    3               IF BREAK_FLAG > 0 THEN
      561     3817    4               DO;
      562     3818    4                   CALL SYS_FUNC_CLOS;
      563     3819    4                   IF DESTROY_TBL=1 THEN
      564     3820    5                   DO;
      565     3821    5                       XREF_BUILT=%NO#;
      566     3822    5                       CALL FREE_DYN_MEM;
      567     3823    5                       END;
      568     3824    4                   UNWIND TO RESTART;
      569     3825    4                   END;
      570     3826
      571     3827    3               CALL PROCESS_PAGE;
      572     3828
      573     3829    3               I_O_INDX = I_O_INDX + 1;
      574     3830    3               END;
      575     3831    2           CALL PAGE_RANGE(RB,RE,#BUFS,I_O_SIZE,HIGH_DATA_PG,LAST_PAGE);
      576     3832    2           END;
      577     3833    1       CALL SYS_FUNC_CLOS; /* Close area (DCBSF does not change ) */
      578     3834    1       IF ZI$DIR.AUTODUMP AND (AREA_KEY_XREF.PERMTYPE(NUM_AREAS_REPORTED-1) = 1) THEN
      579     3835    2       DO;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:18   
      580     3836        /*E* ERROR: ZIU-DBU#NOTREPRT-C
      581     3837           MESSAGE: Unable to report information on temporary area, %U1. */
      582     3838    2           ERRCODESF.ERR# = DBU#NOTREPRT;
      583     3839    2           MSGCODE = ERRCODE_RDEF;
      584     3840    2           ERR_INSERT.CNT(0) = ZI$DIR.AREA_NM.NAME.CNT;
      585     3841    2           ERR_INSERT.TEXT(0) = ZI$DIR.AREA_NM.NAME.TEXT;
      586     3842    2           CALL SYS_FUNC_ERRMSG;
      587     3843    2           END;
      588     3844    2       ELSE DO;
      589     3845    2           IF ZI$DIR.REPRT_ALL = '1'B THEN
      590     3846    3           DO;
      591     3847    3               CALL REPORT_RECORD;
      592     3848    3               CALL REPORT_PAGES;
      593     3849    3               END;
      594     3850    2           ELSE IF ZI$DIR.REPRT_REC = '1'B THEN
      595     3851    2                   CALL REPORT_RECORD;
      596     3852    2               ELSE IF ZI$DIR.REPRT_PG = '1'B THEN CALL REPORT_PAGES;
      597     3853    2           END;
      598     3854    1       IF ZI$DIR.AUTODUMP AND NUM_AREAS_REPORTED<NO_AREAS THEN
      599     3855    2       DO; /* PREPARE FOR NEXT AREA */
      600     3856    2   CLOSE_AREA:
      601     3857    2           DCBSF = ZI$DIR.AREA_NM.DCB#;
      602     3858    2           CALL SYS_FUNC_CLOS;
      603     3859    2           CALL SYS_FUNC_RELDCB;
      604     3860    2           ZI$DIR.AREA_NM.NAME.TEXT=AREA_KEY_XREF.NAME(NUM_AREAS_REPORTED);
      605     3861    2           CALL GET_DCB(ZI$DIR.AREA_NM) ALTRET(ALTRTN);
      606     3862    2           GOTO NEXT_AREA;
      607     3863    2           END;
      608     3864    1       IF NUM_AREAS_REPORTED>1 THEN /* PRINT SUMMARY */
      609     3865    1           IF ZI$DIR.REPRT_ALL = '1'B THEN
      610     3866    2           DO;
      611     3867    2               RECS$ = DB_RECS$;
      612     3868    2               NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;
      613     3869    2               AREA_TOT_RECS = DB_TOT_RECS;
      614     3870    2               AREA_TOT_SZ = DB_TOT_SZ;
      615     3871    2               OA = DB_OA;
      616     3872    2               CALC_REC = DB_CALC_REC;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:19   
      617     3873    2               PH0.AREA_NAME = 'ALL AREAS';
      618     3874    2               PF2.TYP = 'ALL';
      619     3875    2               NEED_SUMMARY = '0'B;
      620     3876    2               CALL REPORT_RECORD;
      621     3877    2               NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;
      622     3878    2               PGS = DB_PGS;
      623     3879    2               CALL REPORT_PAGES;
      624     3880    2               END;
      625     3881    1           ELSE IF ZI$DIR.REPRT_REC = '1'B THEN
      626     3882    2               DO;
      627     3883    2                   RECS$ = DB_RECS$;
      628     3884    2                   NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;
      629     3885    2                   AREA_TOT_RECS = DB_TOT_RECS;
      630     3886    2                   AREA_TOT_SZ = DB_TOT_SZ;
      631     3887    2                   OA = DB_OA;
      632     3888    2                   CALC_REC = DB_CALC_REC;
      633     3889    2                   PH0.AREA_NAME = 'ALL AREAS';
      634     3890    2                   PF2.TYP = 'ALL';
      635     3891    2                   NEED_SUMMARY = '0'B;
      636     3892    2                   CALL REPORT_RECORD;
      637     3893    2                   END;
      638     3894    1               ELSE IF ZI$DIR.REPRT_PG = '1'B THEN
      639     3895    2                   DO;
      640     3896    2                       PH0.AREA_NAME = 'ALL AREAS';
      641     3897    2                       NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;
      642     3898    2                       PGS = DB_PGS;
      643     3899    2                       CALL REPORT_PAGES;
      644     3900    2                       END;
      645     3901    1       IF (ZI$DIR.REPRT_ALL OR ZI$DIR.REPRT_PA) AND NUM_PA_RECS>=0 THEN
      646     3902    2       DO;
      647     3903    2           DCBSF=DCBNUM(M$LO);
      648     3904    2           VFCSF=%YES#;
      649     3905    2           BUFLNSF=1;
      650     3906    2           BUFSF=VECTOR(PH0); /* JUST USE THE VFC CHAR */
      651     3907    2           CALL SYS_FUNC_WRIT;
      652     3908    2           CALL WRIT(BLANK_LINE,1);
      653     3909    2           CALL WRIT(PAH1,LENGTHC(PAH1));
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:20   
      654     3910    2           CALL WRIT(PAH2,LENGTHC(PAH2));
      655     3911    2           CALL WRIT(PAH3,LENGTHC(PAH3));
      656     3912    2           CALL WRIT(PAH4,LENGTHC(PAH4));
      657     3913    2           CALL WRIT(PAH5,LENGTHC(PAH5));
      658     3914    2           CALL WRIT(BLANK_LINE,1);
      659     3915    2           IF ZI$DIR.AUTODUMP AND NO_AREAS>1 THEN
      660     3916    2               RECS$=DB_RECS$;
      661     3917    3           DO X=0 TO NUM_PA_RECS;
      662     3918    3               PTR_SIZE=LENGTHC(PAH6);
      663     3919    3               ADDR(PAH6)->CHAR_V=' '; /* BLANK WHOLE LINE */
      664     3920    3               Y=PA.RECSINDX(X); /* INTO RECS TABLE */
      665     3921    3               MSTR_INDX=DB_RECS.MSTRINDX(Y); /* INTO MSTR TABL */
      666     3922    3               PAH6.REC_NAME=SUBSTR(MSTR_REF.NAME(MSTR_INDX),8,20);
      667     3923    3               PTR_BIN=RECS.NO_OF_RECS(Y); /* SET TO NUMBER FOUND */
      668     3924    3               IF PTR_BIN=0 THEN
      669     3925    3                   PAH6.PA_FOUND=' -NONE-';
      670     3926    3               ELSE
      671     3927    4               DO;
      672     3928    4                   CALL BINCHAR_SUP(PAH6.OWNER_FOUND,PA.OWNER_FOUND(X),LENGTHC(PAH6.
              3928                            OWNER_FOUND));
      673     3929    4                   CALL BINCHAR_SUP(PAH6.PA_FOUND,PTR_BIN,LENGTHC(PAH6.PA_FOUND));
      674     3930    4                   CALL BINCHAR_SUP(PAH6.MEM_FOUND,PA.MEM_FOUND(X),LENGTHC(PAH6.
              3930                            MEM_FOUND));
      675     3931    4                   PAH6.PERCENT_MARK=' %';
      676     3932    4                   PAH6.DOT1='.';
      677     3933    4                   PAH6.DOT2='.';
      678     3934    4                   PAH6.LEFT_PARAN='(';
      679     3935    4                   PAH6.RIGHT_PARAN=')';
      680     3936    4                   INDX=PA.TOT_PTRS(X)/PTR_BIN;
      681     3937    4                   CALL BINCHAR_SUP(PAH6.NUMBER_PTR,INDX,LENGTHC(PAH6.NUMBER_PTR));
      682     3938    4                   INDX=PA.TOT_PTRS(X)-INDX*PTR_BIN; /* REMAINDER */
      683     3939    4                   INDX=((INDX*100)/PTR_BIN)/10;
      684     3940    4                   CALL BINCHAR_SUP(PAH6.NUMBER_PTR2,INDX,LENGTHC(PAH6.NUMBER_PTR2));
      685     3941    4                   INDX=PA.SPACE_AVAIL(X)/PTR_BIN;
      686     3942    4                   CALL BINCHAR_SUP(PAH6.SPACE_AVAIL,INDX,LENGTHC(PAH6.SPACE_AVAIL));
      687     3943    4                   INDX=PA.SPACE_AVAIL(X)-INDX*PTR_BIN;
      688     3944    4                   INDX=((INDX*100)/PTR_BIN)/10;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:21   
      689     3945    4                   CALL BINCHAR_SUP(PAH6.SPACE_AVAIL2,INDX,LENGTHC(PAH6.SPACE_AVAIL2));
      690     3946    4                   PTR_SIZE=PA.REC_SIZE(X)-MSTR_REF.PAOFF(MSTR_INDX);
      691     3947    4                   INDX=PTR_SIZE/MSTR_REF.PAENT(MSTR_INDX); /* # ENTRIES RESed */
      692     3948    4                   CALL BINCHAR_SUP(PAH6.ENT_RES,INDX,LENGTHC(PAH6.ENT_RES));
      693     3949    4                   INDX=100-(100*PA.SPACE_AVAIL(X))/(PTR_SIZE*PTR_BIN);
      694     3950    4                   CALL BINCHAR_SUP(PAH6.PERCENT_SPACE,INDX,LENGTHC(PAH6.PERCENT_SPACE)
              3950                            );
      695     3951    4                   END;
      696     3952    3               CALL WRIT(PAH6,LENGTHC(PAH6));
      697     3953    3               END;
      698     3954    2           CALL WRIT(BLANK_LINE,1);
      699     3955    2           CALL WRIT(BLANK_LINE,1);
      700     3956    2           END;
      701     3957    1       ZI$DIR.AUTODUMP='0'B;
      702     3958    1       IF DESTROY_TBL=1 THEN
      703     3959    2       DO;
      704     3960    2           CALL FREE_DYN_MEM;
      705     3961    2           XREF_BUILT='0'B;
      706     3962    2           END;
      707     3963    1       CALL FREE_TBL(,REPTBL#);
      708     3964    1       RETURN;
      709     3965        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:22   
      710     3966        /*--------------------------------------------------------------*/
      711     3967        /*         GET INVENTORY  AND  FILE  SZ  ATTRIBUTES           */
      712     3968        /*--------------------------------------------------------------*/
      713     3969    1   GET_ATBLK: PROC(HI_PGE) ALTRET;
      714     3970    2   DCL HI_PGE SBIN;
      715     3971        /*
      716     3972           Evaluate high data page and number of inventory pages according
      717     3973           to attribute block information.
      718     3974        */
      719     3975
      720     3976    2       IF DCBADDR(DCBSF)->F$DCB.ORG# ~= %IDS# THEN
      721     3977    3       DO;
      722     3978         /*E* ERROR: ZIU-DBU#CHKIDSREP-C
      723     3979                 MESSAGE: %FN is not an integrated IDS file. Directive aborted. */
      724     3980    3           ERRCODESF.ERR# = DBU#CHKIDSREP;
      725     3981    3           MSGCODE = ERRCODE_RDEF;
      726     3982    3           ERRFLGSF = 4;
      727     3983    3           CALL SYS_FUNC_ERRMSG;
      728     3984    3           CALL SYS_FUNC_CLOS;
      729     3985    3           ALTRETURN;
      730     3986    3           END;
      731     3987
      732     3988    2   /**/ DCBSF = ZI$DIR.AREA_NM.DCB#;
      733     3989    2   /**/ BUFSF = VECTOR(I_O_BUF(0));
      734     3990    2   /**/ BUFLNSF = 4096;
      735     3991    2   /**/ FULLSF = %YES#;
      736     3992    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;
      737     3993    2   /**/ KEYSF = %YES#;
      738     3994    2   /**/ KEYVSF.IDSKEY = 0;
      739     3995    2       CALL SYS_FUNC_READ ALTRET(ALT_ATBLK);
      740     3996    2       ATBLK$ = ADDR(I_O_BUF(0));
      741     3997    2       IF ATBLK_PG.FIR_INV_PGNO = 0 THEN
      742     3998    3       DO;
      743     3999    3           HI_PGE = ATBLK_PG.NUM_DBPG;
      744     4000    3           END;
      745     4001    3       ELSE DO;
      746     4002    3           HI_PGE = ATBLK_PG.NUM_DBPG - ((ATBLK_PG.NUM_DBPG -
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:23   
      747     4003    3              ATBLK_PG.FIR_INV_PGNO)+1);
      748     4004    3           END;
      749     4005    2       LOW_DBK = ATBLK_PG.LOW_DBK;
      750     4006    2       LPP = ATBLK_PG.LINE_INFO.LPP;
      751     4007    2       RETURN;
      752     4008        /**/
      753     4009    2   ALT_ATBLK:
      754     4010    2       ALTRETURN;
      755     4011    2   END GET_ATBLK;
      756     4012        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:24   
      757     4013
      758     4014        /*--------------------------------------------------------------------------*/
      759     4015        /*    Find location of each record in the page and accumulate statistics.   */
      760     4016        /*--------------------------------------------------------------------------*/
      761     4017    1   PROCESS_PAGE: PROC;
      762     4018
      763     4019    2   DCL REC_TABLE (0:4000) BIT(1) STATIC UNAL;
      764     4020    2       REC_TABLE = '0'B;
      765     4021    2       PG_TOT_SZ = 0;
      766     4022    2       NUM_DBKEYS_USED = 0;
      767     4023    2       NUM_PGS_REPORTED = NUM_PGS_REPORTED + 1;
      768     4024    2       DB_NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED + 1;
      769     4025    2       OA_SZ = ((DATA_PG.OFF_LN.SEC + 1) * 2);
      770     4026    2       IF OA_SZ < OA.LO_SZ
      771     4027    2       THEN OA.LO_SZ = OA_SZ;
      772     4028    2       IF OA_SZ > OA.HI_SZ
      773     4029    2       THEN OA.HI_SZ = OA_SZ;
      774     4030    2       OA.TOT_SZ = OA.TOT_SZ + OA_SZ;
      775     4031    3       DO I = 0 TO DATA_PG.OFF_LN.SEC;
      776     4032    4           IF DATA_PG.ACT_DATA_18(OFFSET# I) > 0 THEN DO;
      777     4033    4               REC$ = PINCRC(DATA$, 12 + DATA_PG.ACT_DATA_18(OFFSET# I));
      778     4034    4               REC_REDEF = REC$->RECORD;
      779     4035    4               REC_IN_LIST = '0'B;
      780     4036
      781     4037         /*  If 'RECORDS=' clause was specified then RCNT ~= -1 */
      782     4038
      783     4039    4               IF (RCNT ~= -1) /* If 'RECORDS=' specified */
      784     4040    5               THEN DO J = 0 TO RCNT; /* then see if this record */
      785     4041    5                   IF RECORD_LIST.TYPE(J) = REC.TYPE /* was specified */
      786     4042    6                   THEN DO;
      787     4043    6                       REC_IN_LIST = '1'B;
      788     4044    6                       X = J; /* save index to RECORD_LIST */
      789     4045    6                       J = RCNT + 1;
      790     4046    6                       END;
      791     4047    5                   END;
      792     4048    5               ELSE DO; /* If it wasn't specified */
      793     4049    5                   REC_IN_LIST = '1'B; /* find index to MSTR_REF */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:25   
      794     4050    5                   X = TYPE.MSTRINDX(REC.TYPE);
      795     4051    5                   END;
      796     4052        /*
      797     4053            If 'RECORDS=' clause was either (1) not specified or
      798     4054            (2) specified and this record name was specified
      799     4055            then accumulate stats for this record.
      800     4056        */
      801     4057    4               IF REC_IN_LIST = '1'B
      802     4058    5               THEN DO;
      803     4059    5                   NUM_DBKEYS_USED = NUM_DBKEYS_USED + 1;
      804     4060    5                   DB_RECS.NO_OF_RECS(X)=DB_RECS.NO_OF_RECS(X)+1;
      805     4061    5                   IF RECS.NO_OF_RECS(X) = 0 /* FIRST OCCURENCE */
      806     4062    6                   THEN DO;
      807     4063    6                       RECS.NO_OF_RECS(X) = 1;
      808     4064    6                       RECS.LO_SZ(X) = REC.LEN;
      809     4065    6                       RECS.HI_SZ(X) = REC.LEN;
      810     4066    6                       RECS.TOT_SZ(X) = REC.LEN;
      811     4067    6                       RECS.LO_DBKEY(X) = DATA_PG.CON_INTRVAL*LPP + I + LOW_DBK - LPP;
      812     4068    6                       RECS.HI_DBKEY(X) = DATA_PG.CON_INTRVAL*LPP + I + LOW_DBK - LPP;
      813     4069    6                       PG_TOT_SZ = PG_TOT_SZ + REC.LEN;
      814     4070    6                       IF NOT REC_TABLE(X) THEN
      815     4071    7                       DO;
      816     4072    7                           RECS.NO_OF_PAGES(X) = 1;
      817     4073    7                           REC_TABLE(X) = '1'B;
      818     4074    7                           END;
      819     4075    6                       END;
      820     4076    6                   ELSE DO;
      821     4077    6                       RECS.NO_OF_RECS(X) = RECS.NO_OF_RECS(X) + 1;
      822     4078    6                       IF REC.LEN < RECS.LO_SZ(X)
      823     4079    6                       THEN RECS.LO_SZ(X) = REC.LEN;
      824     4080    6                       ELSE IF REC.LEN > RECS.HI_SZ(X)
      825     4081    6                           THEN RECS.HI_SZ(X) = REC.LEN;
      826     4082    6                       RECS.TOT_SZ(X) = RECS.TOT_SZ(X) + REC.LEN;
      827     4083    6                       RECS.HI_DBKEY(X) = DATA_PG.CON_INTRVAL*LPP + I + LOW_DBK - LPP;
      828     4084    6                       PG_TOT_SZ = PG_TOT_SZ + REC.LEN;
      829     4085    6                       IF NOT REC_TABLE(X) THEN
      830     4086    7                       DO;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:26   
      831     4087    7                           RECS.NO_OF_PAGES(X) =
      832     4088    7                              RECS.NO_OF_PAGES(X)+1;
      833     4089    7                           REC_TABLE(X) = '1'B;
      834     4090    7                           END;
      835     4091    6                       END;
      836     4092    5                   MSTR_INDX=DB_RECS.MSTRINDX(X);
      837     4093    5                   IF MSTR_REF.PAOFF(MSTR_INDX)>0 THEN /* PA RECORD */
      838     4094    6                   DO;
      839     4095    6                       IF DB_RECS.NO_OF_RECS(X)=1 THEN
      840     4096    7                       DO; /* VERY 1ST TIME THRU THIS REC (EVEN MUTI-AREA) */
      841     4097    7                           IF RCNT=-1 THEN /* INCREMENT ONE MORE PA COUNT */
      842     4098    8                           DO;
      843     4099    8                               NUM_PA_RECS=NUM_PA_RECS+1;
      844     4100    8                               DB_RECS.PA_INDX(X)=NUM_PA_RECS; /* SET UP INDX FOR IT */
      845     4101    8                               PA.RECSINDX(NUM_PA_RECS)=X; /* POINT BACK TO RECS */
      846     4102    8                               END;
      847     4103    7                           Y=DB_RECS.PA_INDX(X); /* INDX INTO PA TABLE FOR THIS PA */
      848     4104    7                           PA.OWNER_FOUND(Y)=0; /* INIT COUNT */
      849     4105    7                           PA.TOT_PTRS(Y)=0;
      850     4106    7                           PA.MEM_FOUND(Y)=0;
      851     4107    7                           PA.SPACE_AVAIL(Y)=0;
      852     4108    7                           PA.REC_SIZE(Y)=REC.LEN; /* REMEMBER THE SIZE OF PA */
      853     4109    7                           END;
      854     4110    6                       PTR_SIZE=(MSTR_REF.PAOFF(MSTR_INDX)-2*4)/3;
      855     4111    6                       Y=DB_RECS.PA_INDX(X); /* INDX INTO PA_TABLE */
      856     4112    6                       IF PA_REC.PTRS=PINCRC(REC$,2*PTR_SIZE)->PA_REC.PTRS THEN
      857     4113    6                           PA.OWNER_FOUND(Y)=PA.OWNER_FOUND(Y)+1; /* HIGHEST PA */
      858     4114    6                       PA.SPACE_AVAIL(Y)=PA.SPACE_AVAIL(Y)+PA_REC.AVAIL;
      859     4115    6                       INDX=PA_REC.ENTRIES;
      860     4116    6                       ENTRY$=PINCRC(REC$,MSTR_REF.PAOFF(MSTR_INDX));
      861     4117    7                       DO X=1 TO PA_REC.ENTRIES; /* GO THRU ALL ENTRY */
      862     4118    7                           IF PA_ENTRY.C=1 THEN /* GROUP PRESENT */
      863     4119    8                           DO;
      864     4120    8                               PTR_BIN=0;
      865     4121    8                               PINCRC(ADDR(PTR_BIN),4-PTR_SIZE)->CHAR_V=PA_ENTRY.PTRS;
      866     4122    8                               GROUP$=PINCRC(REC$,PTR_BIN);
      867     4123    8                               INDX=INDX+PA_GROUP.NO_GROUPS-1;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:27   
      868     4124    8                               END;
      869     4125    7                           ENTRY$=PINCRC(ENTRY$,MSTR_REF.PAENT(MSTR_INDX));
      870     4126    7                           END;
      871     4127    6                       PA.TOT_PTRS(Y)=PA.TOT_PTRS(Y)+INDX;
      872     4128    6                       IF PA_REC.NOT_LOWEST_LEVEL='0'B THEN /* LOWEST LEVEL */
      873     4129    6                           PA.MEM_FOUND(Y)=PA.MEM_FOUND(Y)+INDX;
      874     4130    6                       END;
      875     4131    5                   END;
      876     4132    4               END;
      877     4133    3           END;
      878     4134
      879     4135    3       IF (ZI$DIR.REPRT_PG = '1'B) | (ZI$DIR.REPRT_ALL = '1'B) THEN DO;
      880     4136    4           IF RCNT = -1 THEN DO;
      881     4137    4               PG_TOT_SZ = PG_TOT_SZ + 24 + OA_SZ;
      882     4138    4               NUM_DBKEYS_UNUSED = LPP - (DATA_PG.OFF_LN.SEC + 1);
              4138                        /* LINES NOT IN OFFSET ARRAY */
      883     4139    5               DO X = 0 TO DATA_PG.OFF_LN.SEC;
      884     4140    5                   IF DATA_PG.ACT_DATA_18(OFFSET# X) < 0 THEN
      885     4141    5                       NUM_DBKEYS_UNUSED = NUM_DBKEYS_UNUSED + 1;
      886     4142    5                   END;
      887     4143    4               PRCNT_DBKEYS_FULL = (((LPP - NUM_DBKEYS_UNUSED) * 100) / LPP) + (1/2);
      888     4144    4               END;
      889     4145    3           ELSE PRCNT_DBKEYS_FULL = ((NUM_DBKEYS_USED * 100) / LPP) + (1/2);
      890     4146    3           IF PRCNT_DBKEYS_FULL >= 100 THEN PRCNT_DBKEYS_FULL = 99;
      891     4147    3           PGS.DNUM(PRCNT_DBKEYS_FULL/5) = PGS.DNUM(PRCNT_DBKEYS_FULL/5) + 1;
      892     4148    3           PRCNT_SPACE_FULL = ((PG_TOT_SZ*100) / (4096 - OA_SZ - 24)) + (1/2);
      893     4149    3           IF PRCNT_SPACE_FULL >= 100 THEN PRCNT_SPACE_FULL = 99;
      894     4150    3           PGS.SNUM(PRCNT_SPACE_FULL/5) = PGS.SNUM(PRCNT_SPACE_FULL/5) + 1;
      895     4151
      896     4152    3           END;
      897     4153
      898     4154    2       RETURN;
      899     4155    2   END PROCESS_PAGE;
      900     4156
      901     4157        /*------------------------------------------------------------------*/
      902     4158        /*   Called after processing an area, this routine produces a       */
      903     4159        /*   screen-oriented report of the record statistics accumulated.   */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:28   
      904     4160        /*------------------------------------------------------------------*/
      905     4161
      906     4162    1   REPORT_RECORD: PROC;
      907     4163
      908     4164    2       DCBSF = DCBNUM(M$LO);
      909     4165    2       VFCSF = %YES#;
      910     4166    2       BUFSF = VECTOR(PH0);
      911     4167    2       BUFLNSF = 62;
      912     4168    2       CALL SYS_FUNC_WRIT;
      913     4169    2       CALL WRIT(BLANK_LINE,1);
      914     4170    2       CALL WRIT(PH1,48);
      915     4171    2       CALL WRIT(PH2,48);
      916     4172    2       CALL WRIT(PH3,80);
      917     4173    2       CALL WRIT(PH4,80);
      918     4174    2       CALL WRIT(BLANK_LINE,1);
      919     4175
      920     4176        /*
      921     4177             If 'REC=' is not specified
      922     4178                then for all MSTR_REF entries
      923     4179                     that have occured in this area
      924     4180                          that are not CALC records
      925     4181                               report statistics.
      926     4182             If 'REC=' was specified
      927     4183                then for all RECORD_LIST entries
      928     4184                     that are not CALC records
      929     4185                          report statistics.
      930     4186             If summary statistics are needed, they are accumulated.
      931     4187                                                                        */
      932     4188    2       IF RCNT = -1 THEN
      933     4189    3       DO X = 0 TO (NO_RECS - 1);
      934     4190    3           IF MSTR_REF.TYPE(X)=4000 THEN /* *CALC RECORD */
      935     4191    3               IF RECS.NO_OF_RECS(X) > 0 THEN CALC_REC = RECS(X); /* *CALC EXIST */
      936     4192    3           IF (RECS.NO_OF_RECS(X) > 0) THEN
      937     4193    4           DO;
      938     4194    4               IF NEED_SUMMARY = '1'B THEN
      939     4195    5               DO;
      940     4196    5                   IF RECS.LO_SZ(X) < DB_RECS.LO_SZ(X)
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:29   
      941     4197    5                   THEN DB_RECS.LO_SZ(X) = RECS.LO_SZ(X);
      942     4198    5                   IF RECS.HI_SZ(X) > DB_RECS.HI_SZ(X)
      943     4199    5                   THEN DB_RECS.HI_SZ(X) = RECS.HI_SZ(X);
      944     4200    5                   DB_RECS.TOT_SZ(X) = DB_RECS.TOT_SZ(X) + RECS.TOT_SZ(X);
      945     4201    5                   IF RECS.LO_DBKEY(X) < DB_RECS.LO_DBKEY(X)
      946     4202    5                   THEN DB_RECS.LO_DBKEY(X) = RECS.LO_DBKEY(X);
      947     4203    5                   IF RECS.HI_DBKEY(X) > DB_RECS.HI_DBKEY(X)
      948     4204    5                   THEN DB_RECS.HI_DBKEY(X) = RECS.HI_DBKEY(X);
      949     4205    5                   END;
      950     4206    4               IF MSTR_REF.PAOFF(X)=0 AND MSTR_REF.TYPE(X)<4000 THEN
      951     4207    5               DO; /* NOT *PA_REC AND NOT *CALC RECORD */
      952     4208    5                   AREA_TOT_RECS=AREA_TOT_RECS+RECS.NO_OF_RECS(X);
      953     4209    5                   AREA_TOT_SZ=AREA_TOT_SZ+RECS.TOT_SZ(X);
      954     4210    5                   RLINE.REC_NAME = MSTR_REF.NAME(X);
      955     4211    5                   CALL BINCHAR_SUP(RLINE.LO_SZ, RECS.LO_SZ(X), 5);
      956     4212    5                   IF RECS.LO_SZ(X) ~= RECS.HI_SZ(X)
      957     4213    5                   THEN CALL BINCHAR_SUP(RLINE.HI_SZ, RECS.HI_SZ(X), 5);
      958     4214    5                   ELSE RLINE.HI_SZ = ' ';
      959     4215    5                   CALL BINCHAR_SUP(RLINE.NO_OF_RECS,RECS.NO_OF_RECS(X),12);
      960     4216    5                   CALL BINCHAR_SUP(RLINE.TOT_SZ,RECS.TOT_SZ(X), 12);
      961     4217    5                   CALL BINCHAR_SUP(RLINE.LO_DBKEY,RECS.LO_DBKEY(X),12);
      962     4218    5                   CALL BINCHAR_SUP(RLINE.HI_DBKEY,RECS.HI_DBKEY(X),12);
      963     4219    5                   CALL WRIT(RLINE,80);
      964     4220    5                   END;
      965     4221    4               END;
      966     4222    3           END;
      967     4223    2       ELSE /* If 'RECORDS=' clause specified */
      968     4224    3       DO X = 0 TO RCNT; /* report only those records specified */
      969     4225    3           RLINE.REC_NAME = RECORD_LIST.NAME(X);
      970     4226    4           IF RECS.NO_OF_RECS(X) = 0 THEN DO;
      971     4227    4               RLINE.LO_SZ = '    0';
      972     4228    4               RLINE.HI_SZ = '     ';
      973     4229    4               RLINE.NO_OF_RECS = '           0';
      974     4230    4               RLINE.TOT_SZ = '           0';
      975     4231    4               RLINE.LO_DBKEY = '           0';
      976     4232    4               RLINE.HI_DBKEY = '           0';
      977     4233    4               END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:30   
      978     4234    4           ELSE DO;
      979     4235    4               IF NEED_SUMMARY = '1'B THEN
      980     4236    5               DO;
      981     4237    5                   IF RECS.LO_SZ(X) < DB_RECS.LO_SZ(X)
      982     4238    5                   THEN DB_RECS.LO_SZ(X) = RECS.LO_SZ(X);
      983     4239    5                   IF RECS.HI_SZ(X) > DB_RECS.HI_SZ(X)
      984     4240    5                   THEN DB_RECS.HI_SZ(X) = RECS.HI_SZ(X);
      985     4241    5                   DB_RECS.TOT_SZ(X) = DB_RECS.TOT_SZ(X) + RECS.TOT_SZ(X);
      986     4242    5                   IF RECS.LO_DBKEY(X) < DB_RECS.LO_DBKEY(X)
      987     4243    5                   THEN DB_RECS.LO_DBKEY(X) = RECS.LO_DBKEY(X);
      988     4244    5                   IF RECS.HI_DBKEY(X) > DB_RECS.HI_DBKEY(X)
      989     4245    5                   THEN DB_RECS.HI_DBKEY(X) = RECS.HI_DBKEY(X);
      990     4246    5                   END;
      991     4247    4               AREA_TOT_RECS = AREA_TOT_RECS + RECS.NO_OF_RECS(X);
      992     4248    4               AREA_TOT_SZ = AREA_TOT_SZ + RECS.TOT_SZ(X);
      993     4249    4               CALL BINCHAR_SUP(RLINE.LO_SZ, RECS.LO_SZ(X), 5);
      994     4250    4               IF RECS.LO_SZ(X) ~= RECS.HI_SZ(X)
      995     4251    4               THEN CALL BINCHAR_SUP(RLINE.HI_SZ, RECS.HI_SZ(X), 5);
      996     4252    4               ELSE RLINE.HI_SZ = ' ';
      997     4253    4               CALL BINCHAR_SUP(RLINE.NO_OF_RECS,RECS.NO_OF_RECS(X),12);
      998     4254    4               CALL BINCHAR_SUP(RLINE.TOT_SZ,RECS.TOT_SZ(X),12);
      999     4255    4               CALL BINCHAR_SUP(RLINE.LO_DBKEY,RECS.LO_DBKEY(X),12);
     1000     4256    4               CALL BINCHAR_SUP(RLINE.HI_DBKEY,RECS.HI_DBKEY(X),12);
     1001     4257    4               END;
     1002     4258    3           CALL WRIT(RLINE,80);
     1003     4259    3           END;
     1004     4260
     1005     4261        /*
     1006     4262             If 'REC=' was not specified
     1007     4263                then
     1008     4264                    report subtotals and
     1009     4265                    report overhead usage.
     1010     4266                                                                           */
     1011     4267
     1012     4268    3       IF RCNT = -1 THEN DO;
     1013     4269    3           IF (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS > 1) THEN
     1014     4270    4           DO;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:31   
     1015     4271    4               IF OA.LO_SZ < DB_OA.LO_SZ THEN DB_OA.LO_SZ = OA.LO_SZ;
     1016     4272    4               IF OA.HI_SZ > DB_OA.HI_SZ THEN DB_OA.HI_SZ = OA.HI_SZ;
     1017     4273    4               DB_OA.TOT_SZ = DB_OA.TOT_SZ + OA.TOT_SZ;
     1018     4274    4               IF CALC_REC.NO_OF_RECS > 0 THEN /* *CALC EXIST */
     1019     4275    5               DO;
     1020     4276    5                   IF CALC_REC.LO_SZ < DB_CALC_REC.LO_SZ THEN DB_CALC_REC.LO_SZ =
              4276                            CALC_REC.LO_SZ;
     1021     4277    5                   IF CALC_REC.HI_SZ > DB_CALC_REC.HI_SZ THEN DB_CALC_REC.HI_SZ =
              4277                            CALC_REC.HI_SZ;
     1022     4278    5                   DB_CALC_REC.TOT_SZ = DB_CALC_REC.TOT_SZ + CALC_REC.TOT_SZ;
     1023     4279    5                   IF CALC_REC.LO_DBKEY < DB_CALC_REC.LO_DBKEY THEN DB_CALC_REC.
              4279                            LO_DBKEY = CALC_REC.LO_DBKEY;
     1024     4280    5                   IF CALC_REC.HI_DBKEY > DB_CALC_REC.HI_DBKEY THEN DB_CALC_REC.
              4280                            HI_DBKEY = CALC_REC.HI_DBKEY;
     1025     4281    5                   DB_CALC_REC.NO_OF_RECS = DB_CALC_REC.NO_OF_RECS + CALC_REC.
              4281                            NO_OF_RECS;
     1026     4282    5                   END;
     1027     4283    4               END;
     1028     4284    3           CALL WRIT(PF1,56);
     1029     4285    3           CALL BINCHAR_SUP(PF2.AREA_TOT_RECS,AREA_TOT_RECS,12);
     1030     4286    3           CALL BINCHAR_SUP(PF2.AREA_TOT_SZ,AREA_TOT_SZ,12);
     1031     4287    3           PF2.MSG = ' = SUBTOTALS FOR ';
     1032     4288    3           CALL WRIT(PF2,80);
     1033     4289         /* call BMAP routine in MRL to convert the integer to real */
     1034     4290    3           CALL FLOAT (AREA_TOT_SZ,AREA_SZ_REAL);
     1035     4291    3           CALL FLOAT (100,REAL100);
     1036     4292         /* calculate (AREA_TOT_SZ * 100) */
     1037     4293    3           CALL FLOAT_MPY (AREA_SZ_REAL,REAL100,MPY_RSLT1_REAL);
     1038     4294         /* call BMAP routine to convert the integer to real */
     1039     4295    3           CALL FLOAT (NUM_PGS_REPORTED,NUM_PGS_REPORTED_REAL);
     1040     4296    3           CALL FLOAT (4072,REAL4072);
     1041     4297         /* calculate (NUM_PGS_REPORTED * 4072) */
     1042     4298    3           CALL FLOAT_MPY (NUM_PGS_REPORTED_REAL,REAL4072,MPY_RSLT2_REAL);
     1043     4299         /* call BMAP routine to convert the integer to real */
     1044     4300    3           CALL FLOAT (OA.TOT_SZ,OA_SZ_REAL);
     1045     4301         /* calculate (MPY_RSLT2_REAL-OA_SZ_REAL) */
     1046     4302    3           CALL FLOAT_SUB (MPY_RSLT2_REAL,OA_SZ_REAL,SUBTRACT_RSLT_REAL);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:32   
     1047     4303         /* calculate (MPY_RSLT1_REAL/SUBTRACT_RSLT_REAL) */
     1048     4304    3           CALL FLOAT_DIV (MPY_RSLT1_REAL,SUBTRACT_RSLT_REAL,DIV_RSLT_REAL);
     1049     4305         /* call BMAP routine to convert the real back to integer */
     1050     4306    3           CALL FIX (DIV_RSLT_REAL,PRCNT);
     1051     4307    3           CALL BINCHAR_SUP(PF3.PRCNT_LINE.PRCNT_USED,PRCNT,3);
     1052     4308    3           IF PF3.PRCNT_LINE.PRCNT_USED = '  0'
     1053     4309    4           THEN DO;
     1054     4310    4               PF3.PRCNT_LINE.PRCNT_MSG = 'LESS THAN';
     1055     4311    4               PF3.PRCNT_LINE.PRCNT_USED = '  1';
     1056     4312    4               END;
     1057     4313    3           CALL WRIT(PF3,80);
     1058     4314    3           PF3.PRCNT_LINE.PRCNT_MSG = '         ';
     1059     4315    3           CALL WRIT(BLANK_LINE,1);
     1060     4316
     1061     4317    3           RLINE.REC_NAME = 'PAGE HEADERS';
     1062     4318    3           RLINE.LO_SZ = '   24';
     1063     4319    3           RLINE.HI_SZ = ' ';
     1064     4320    3           CALL BINCHAR_SUP(RLINE.NO_OF_RECS, NUM_PGS_REPORTED,12);
     1065     4321    3           CALL BINCHAR_SUP(RLINE.TOT_SZ, (NUM_PGS_REPORTED * 24), 12);
     1066     4322    3           RLINE.LO_DBKEY = ' ';
     1067     4323    3           RLINE.HI_DBKEY = ' ';
     1068     4324    3           CALL WRIT(RLINE,80);
     1069     4325
     1070     4326    3           RLINE.REC_NAME = 'OFFSET ARRAYS';
     1071     4327
     1072     4328    3           CALL BINCHAR_SUP(RLINE.LO_SZ, OA.LO_SZ, 5);
     1073     4329    3           IF OA.LO_SZ ~= OA.HI_SZ THEN
     1074     4330    3               CALL BINCHAR_SUP(RLINE.HI_SZ, OA.HI_SZ, 5);
     1075     4331    3           CALL BINCHAR_SUP(RLINE.TOT_SZ, OA.TOT_SZ, 12);
     1076     4332    3           CALL WRIT(RLINE,80);
     1077     4333
     1078     4334    3           IF CALC_REC.NO_OF_RECS > 0 THEN /*  PRINT *CALC */
     1079     4335    4           DO;
     1080     4336    4               RLINE.REC_NAME = '*CALC';
     1081     4337    4               CALL BINCHAR_SUP(RLINE.LO_SZ, CALC_REC.LO_SZ, 5);
     1082     4338    4               IF CALC_REC.LO_SZ ~= CALC_REC.HI_SZ THEN
     1083     4339    4                   CALL BINCHAR_SUP(RLINE.HI_SZ, CALC_REC.HI_SZ, 5);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:33   
     1084     4340    4               ELSE RLINE.HI_SZ = ' ';
     1085     4341    4               CALL BINCHAR_SUP(RLINE.TOT_SZ, CALC_REC.TOT_SZ, 12);
     1086     4342    4               CALL BINCHAR_SUP(RLINE.LO_DBKEY, CALC_REC.LO_DBKEY, 12);
     1087     4343    4               CALL BINCHAR_SUP(RLINE.HI_DBKEY, CALC_REC.HI_DBKEY, 12);
     1088     4344    4               CALL BINCHAR_SUP(RLINE.NO_OF_RECS, CALC_REC.NO_OF_RECS, 12);
     1089     4345    4               CALL WRIT(RLINE,80);
     1090     4346    4               END;
     1091     4347    4           DO X = 0 TO NUM_PA_RECS;
     1092     4348
     1093     4349    4               Y=PA.RECSINDX(X);
     1094     4350    4               IF RECS.NO_OF_RECS(Y)>0 THEN
     1095     4351    5               DO;
     1096     4352    5                   AREA_TOT_RECS = AREA_TOT_RECS + RECS.NO_OF_RECS(Y);
     1097     4353    5                   AREA_TOT_SZ = AREA_TOT_SZ + RECS.TOT_SZ(Y);
     1098     4354    5                   RLINE.REC_NAME = MSTR_REF.NAME(Y);
     1099     4355    5                   CALL BINCHAR_SUP(RLINE.LO_SZ, RECS.LO_SZ(Y), 5);
     1100     4356    5                   IF RECS.LO_SZ(Y) ~= RECS.HI_SZ(Y)
     1101     4357    5                   THEN CALL BINCHAR_SUP(RLINE.HI_SZ, RECS.HI_SZ(Y), 5);
     1102     4358    5                   ELSE RLINE.HI_SZ = ' ';
     1103     4359    5                   CALL BINCHAR_SUP(RLINE.NO_OF_RECS,RECS.NO_OF_RECS(Y),12);
     1104     4360    5                   CALL BINCHAR_SUP(RLINE.TOT_SZ,RECS.TOT_SZ(Y),12);
     1105     4361    5                   CALL BINCHAR_SUP(RLINE.LO_DBKEY,RECS.LO_DBKEY(Y),12);
     1106     4362    5                   CALL BINCHAR_SUP(RLINE.HI_DBKEY,RECS.HI_DBKEY(Y),12);
     1107     4363    5                   CALL WRIT(RLINE,80);
     1108     4364    5                   END;
     1109     4365    4               END;
     1110     4366
     1111     4367    3           AREA_TOT_RECS = AREA_TOT_RECS + (NUM_PGS_REPORTED * 2) + CALC_REC.NO_OF_RECS
              4367                    ;
     1112     4368    3           AREA_TOT_SZ = AREA_TOT_SZ + (NUM_PGS_REPORTED * 24) + OA.TOT_SZ + CALC_REC.
              4368                    TOT_SZ;
     1113     4369    3           END;
     1114     4370
     1115     4371
     1116     4372    2       CALL WRIT(PF1,56);
     1117     4373
     1118     4374    2       CALL BINCHAR_SUP(PF2.AREA_TOT_RECS,AREA_TOT_RECS,12);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:34   
     1119     4375    2       CALL BINCHAR_SUP(PF2.AREA_TOT_SZ, AREA_TOT_SZ, 12);
     1120     4376    2       PF2.MSG = ' =  TOTALS  FOR  ';
     1121     4377    2       CALL WRIT(PF2,78);
     1122     4378         /* call BMAP routine in MRL to convert the integer to real */
     1123     4379    2       CALL FLOAT (AREA_TOT_SZ,AREA_SZ_REAL);
     1124     4380    2       CALL FLOAT (100,REAL100);
     1125     4381         /* calculate (AREA_TOT_SZ * 100) */
     1126     4382    2       CALL FLOAT_MPY (AREA_SZ_REAL,REAL100,MPY_RSLT1_REAL);
     1127     4383         /* call BMAP routine to convert the integer to real */
     1128     4384    2       CALL FLOAT (NUM_PGS_REPORTED,NUM_PGS_REPORTED_REAL);
     1129     4385    2       CALL FLOAT (4096,REAL4096);
     1130     4386         /* calculate (NUM_PGS_REPORTED * 4096) */
     1131     4387    2       CALL FLOAT_MPY (NUM_PGS_REPORTED_REAL,REAL4096,MPY_RSLT2_REAL);
     1132     4388         /* calculate (MPY_RSLT1_REAL/MPY_RSLT2_REAL) */
     1133     4389    2       CALL FLOAT_DIV (MPY_RSLT1_REAL,MPY_RSLT2_REAL,DIV_RSLT_REAL);
     1134     4390         /* call BMAP routine to convert the real back to integer */
     1135     4391    2       CALL FIX (DIV_RSLT_REAL,PRCNT);
     1136     4392    2       CALL BINCHAR_SUP(PF3.PRCNT_LINE.PRCNT_USED,PRCNT,3);
     1137     4393    2       IF PF3.PRCNT_LINE.PRCNT_USED = '  0'
     1138     4394    3       THEN DO;
     1139     4395    3           PF3.PRCNT_LINE.PRCNT_MSG = 'LESS THAN';
     1140     4396    3           PF3.PRCNT_LINE.PRCNT_USED = '  1';
     1141     4397    3           END;
     1142     4398    2       CALL WRIT(PF3,80);
     1143     4399    2       PF3.PRCNT_LINE.PRCNT_MSG = '         ';
     1144     4400
     1145     4401    2       IF (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS = 1) THEN
     1146     4402    3       DO;
     1147     4403    3           CALL WRIT(' ',1);
     1148     4404    3           CALL WRIT('ONLY 1 INTEGRATED AREA IN THE SCHEMA',36);
     1149     4405    3           END;
     1150     4406
     1151     4407
     1152     4408    2       RETURN;
     1153     4409
     1154     4410    2   END REPORT_RECORD;
     1155     4411
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:35   
     1156     4412
     1157     4413        /*----------------------------------------------------------------*/
     1158     4414        /*   Called after processing an area, this routine produces a     */
     1159     4415        /*   screen-oriented report of the page statistics accumulated    */
     1160     4416        /*----------------------------------------------------------------*/
     1161     4417    1   REPORT_PAGES: PROC;
     1162     4418
     1163     4419    2   DCL NUM_PGS UBIN WORD ALIGNED;
     1164     4420
     1165     4421    2       DCBSF = DCBNUM(M$LO);
     1166     4422    2       VFCSF = %YES#;
     1167     4423    2       BUFSF = VECTOR(PH0);
     1168     4424    2       BUFLNSF = 62;
     1169     4425    2       CALL SYS_FUNC_WRIT;
     1170     4426    2       CALL WRIT(BLANK_LINE,1);
     1171     4427    2       CALL WRIT(PH5,48);
     1172     4428    2       CALL WRIT(PH6,68);
     1173     4429    2       CALL WRIT(PH7,68);
     1174     4430    2       CALL WRIT(PH8,80);
     1175     4431    2       CALL WRIT(PH9,80);
     1176     4432    2       CALL WRIT(BLANK_LINE,1);
     1177     4433    2       NUM_PGS = 0;
     1178     4434
     1179     4435    3       DO X = 0 TO 19;
     1180     4436    3           PLINE.PRCNT = PGS.PRCNT(X);
     1181     4437    3           IF NUM_PGS = NUM_PGS_REPORTED * 2 THEN /* Rest is zeroes */
     1182     4438    4           DO;
     1183     4439    4               PLINE.PRCNT.HI = '100';
     1184     4440    4               PLINE.SNUM = '              0';
     1185     4441    4               PLINE.DNUM = '              0';
     1186     4442    4               PLINE.SPRCNT = '              0';
     1187     4443    4               PLINE.DPRCNT = '              0';
     1188     4444    4               X = 20;
     1189     4445    4               END;
     1190     4446    3           ELSE
     1191     4447    4           DO;
     1192     4448    4               IF PGS.SNUM(X) = 0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:36   
     1193     4449    5               THEN DO;
     1194     4450    5                   PLINE.SNUM = '              0';
     1195     4451    5                   PLINE.SPRCNT = '              0';
     1196     4452    5                   END;
     1197     4453    5               ELSE DO;
     1198     4454    5                   NUM_PGS = NUM_PGS + PGS.SNUM(X);
     1199     4455    5                   CALL BINCHAR_SUP(PLINE.SNUM,BITBIN(BINBIT(PGS.SNUM(X),36)),15);
     1200     4456    5                   CALL BINCHAR_SUP(PLINE.SPRCNT,PGS.SNUM(X)*100/NUM_PGS_REPORTED,15);
     1201     4457    5                   DB_PGS.SNUM(X) = DB_PGS.SNUM(X) + PGS.SNUM(X);
     1202     4458    5                   END;
     1203     4459    4               IF PGS.DNUM(X) = 0
     1204     4460    5               THEN DO;
     1205     4461    5                   PLINE.DNUM = '              0';
     1206     4462    5                   PLINE.DPRCNT = '              0';
     1207     4463    5                   END;
     1208     4464    5               ELSE DO;
     1209     4465    5                   NUM_PGS = NUM_PGS + PGS.DNUM(X);
     1210     4466    5                   CALL BINCHAR_SUP(PLINE.DNUM,PGS.DNUM(X),15);
     1211     4467    5                   CALL BINCHAR_SUP(PLINE.DPRCNT,PGS.DNUM(X)*100/NUM_PGS_REPORTED,15);
     1212     4468    5                   DB_PGS.DNUM(X) = DB_PGS.DNUM(X) + PGS.DNUM(X);
     1213     4469    5                   END;
     1214     4470    4               END;
     1215     4471    3           CALL WRIT(PLINE,72);
     1216     4472    3           END;
     1217     4473
     1218     4474    2       IF (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS = 1) THEN
     1219     4475    3       DO;
     1220     4476    3           CALL WRIT(' ',1);
     1221     4477    3           CALL WRIT('ONLY 1 INTEGRATED AREA IN THE SCHEMA',36);
     1222     4478    3           END;
     1223     4479
     1224     4480    2       RETURN;
     1225     4481
     1226     4482    2   END REPORT_PAGES;
     1227     4483
     1228     4484        /*----------------------------------------------------------------*/
     1229     4485        /*   This write routine gets passed a character string and its    */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:37   
     1230     4486        /*   length.  It calls sys_func_writ with no vfc.                 */
     1231     4487        /*----------------------------------------------------------------*/
     1232     4488    1   WRIT: PROC(BF,LEN);
     1233     4489    2   DCL BF CHAR(LEN) ALIGNED;
     1234     4490    2   DCL LEN UBIN(36) ALIGNED;
     1235     4491    2       IF BREAK_FLAG>0 THEN
     1236     4492    3       DO;
     1237     4493    3           DCBSF=ZI$DIR.AREA_NM.DCB#;
     1238     4494    3           CALL FREE_TBL(,REPTBL#); /* RELEASE DYNAMIC PAGES */
     1239     4495    3           CALL SYS_FUNC_CLOS;
     1240     4496    3           IF XREF_BUILT THEN
     1241     4497    4           DO;
     1242     4498    4               XREF_BUILT = %NO#;
     1243     4499    4               CALL FREE_DYN_MEM;
     1244     4500    4               END;
     1245     4501    3           UNWIND TO RESTART;
     1246     4502    3           END;
     1247     4503    2       DCBSF = DCBNUM(M$LO);
     1248     4504    2       VFCSF = %NO#;
     1249     4505    2       BUFSF = VECTOR(BF);
     1250     4506    2       BUFLNSF = LEN;
     1251     4507    2       CALL SYS_FUNC_WRIT;
     1252     4508    2       RETURN;
     1253     4509    2   END WRIT;
     1254     4510
     1255     4511        /*-----------------------------------------------------------------*/
     1256     4512        /*    This routine converts a numeric value to a zero-suppressed   */
     1257     4513        /*    character string.                                            */
     1258     4514        /*-----------------------------------------------------------------*/
     1259     4515    1   BINCHAR_SUP: PROC(CHRFLD,NUMFLD,LENG);
     1260     4516    2   DCL CHRFLD CHAR(LENG) CALIGNED;
     1261     4517    2   DCL NUMFLD UBIN;
     1262     4518    2   DCL LENG UBIN;
     1263     4519    2       CALL BINCHAR(CHRFLD,NUMFLD);
     1264     4520    2       CALL ZERO_SUP(CHRFLD,LENG,'0'B);
     1265     4521    2       RETURN;
     1266     4522    2   END BINCHAR_SUP;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:38   
     1267     4523    1   SET_REPORT: PROC;
     1268     4524    2   DCL K SBIN WORD ALIGNED;
     1269     4525    2   DCL MEMINDX SBIN WORD ALIGNED;
     1270     4526    2   DCL SET_OCC SBIN WORD ALIGNED;
     1271     4527    2   DCL OWNER SBIN WORD ALIGNED;
     1272     4528    2   DCL NEXT SBIN WORD ALIGNED;
     1273     4529    2   DCL VALUE SBIN WORD ALIGNED;
     1274     4530    2   DCL LOCS(0:2) CHAR(6) STATIC ALIGNED;
     1275     4531    2   DCL REC_TYPE SBIN HALF ALIGNED;
     1276     4532    2   DCL 1 BLINE STATIC ALIGNED,
     1277     4533    2         2 * CHAR(80) INIT(' ');
     1278     4534    2       LOCS(0) = 'DIRECT';
     1279     4535    2       LOCS(1) = 'VIA   ';
     1280     4536    2       LOCS(2) = 'CALC  ';
     1281     4537        %EQU XCALC = '*CALC                         ';
     1282     4538
     1283     4539    2       CALL WRIT(PH0, LENGTHC(PH0));
     1284     4540    2       CALL WRIT(OV5, LENGTHC(OV5));
     1285     4541    2       CALL WRIT(OV5A, LENGTHC(OV5A));
     1286     4542
     1287     4543    2       CALL WRIT(OV1, LENGTHC(OV1));
     1288     4544    2       CALL WRIT(OV3, LENGTHC(OV3));
     1289     4545    2       CALL WRIT(OV3A, LENGTHC(OV3A));
     1290     4546    2       K = FIRST_SET;
     1291     4547    2       OV4 = BLINE;
     1292     4548    3       DO WHILE(K < NXT_MSLOT);
     1293     4549    3           IF SCNT ~= -1 THEN CALL SEARCH_LISTS(0,K) ALTRET(NI);
     1294     4550    3           OV4 = BLINE;
     1295     4551    3           OWNER =TYPE.MSTRINDX(MSTR_REF.SET.OWNER_TYPE(K));
     1296     4552    3           SET_OCC = RECS.NO_OF_RECS(OWNER);
     1297     4553    3           IF MSTR_REF.NAME(K) = %XCALC THEN GOTO NI;
     1298     4554    3           OV4.X.SET = MSTR_REF.NAME(K);
     1299     4555    3           CALL BINCHAR_SUP(OV4.SET,SET_OCC,7);
     1300     4556    3           CALL WRIT(OV4, LENGTHC(OV4));
     1301     4557    3           OV4 = BLINE;
     1302     4558    3           NEXT = MSTR_REF.NEXT(K);
     1303     4559    4           DO WHILE(NEXT ~= -1);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:39   
     1304     4560    4               MEMINDX = REC_XREF.MSTRINDX(NEXT);
     1305     4561    4               IF MSTR_REF.TYPE(MEMINDX) ~= MSTR_REF.TYPE(OWNER) THEN
     1306     4562    5               DO;
     1307     4563    5                   IF RCNT ~= -1 THEN CALL SEARCH_LISTS(1,MEMINDX) ALTRET(NX);
     1308     4564    5                   OV4.V.REC = MSTR_REF.NAME(MEMINDX);
     1309     4565    5                   OV4.LOC = LOCS(MSTR_REF.PSMODE(MEMINDX));
     1310     4566    5                   REC_TYPE = TYPE.MSTRINDX(MSTR_REF.TYPE(MEMINDX));
     1311     4567    5                   VALUE = RECS.NO_OF_RECS(REC_TYPE)/SET_OCC;
     1312     4568    5                   IF VALUE = 0 THEN RECS.NO_OF_PAGES(REC_TYPE) = 0;
     1313     4569    5                   CALL BINCHAR_SUP(OV4.MEM, VALUE, 7);
     1314     4570    5                   VALUE = VALUE/RECS.NO_OF_PAGES(REC_TYPE);
     1315     4571    5                   CALL BINCHAR_SUP(OV4.PGE,VALUE,7);
     1316     4572    5                   CALL WRIT(OV4, LENGTHC(OV4));
     1317     4573    5                   OV4 = BLINE;
     1318     4574    5                   CALL WRIT(BLINE, LENGTHC(BLINE));
     1319     4575    5                   END;
     1320     4576    4   NX:         NEXT = REC_XREF.NEXT(NEXT);
     1321     4577    4               END;
     1322     4578    3   NI:     K=K+1;
     1323     4579    3           END;
     1324     4580    2       RETURN;
     1325     4581    2   END SET_REPORT;
     1326     4582        /*****************************************/
     1327     4583        /*  This rtn looks to see a certain set  existed
     1328     4584            in the 'set=' clause. if not, it altrets */
     1329     4585        /*****************************************/
     1330     4586    1   SEARCH_LISTS: PROC(LIST,SINDX) ALTRET;
     1331     4587    2   DCL LIST SBIN;
     1332     4588
     1333     4589    2   DCL SINDX UBIN;
     1334     4590    2   DCL J UBIN WORD ALIGNED;
     1335     4591    2       IF LIST = 1 THEN
     1336     4592    3       DO J = 0 TO 19;
     1337     4593    3           IF RECORD_LIST.NAME(J) =
     1338     4594    3              MSTR_REF.NAME(SINDX) THEN J=25;
     1339     4595    3           END;
     1340     4596    2       ELSE
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:40   
     1341     4597
     1342     4598    3       DO J = 0 TO 19;
     1343     4599    3           IF SET_LIST.NAME(J) =
     1344     4600    3              MSTR_REF.NAME(SINDX) THEN
     1345     4601    3               J=25;
     1346     4602    3           END;
     1347     4603    2       IF J ~= 25 THEN ALTRETURN;
     1348     4604    2       RETURN;
     1349     4605    2   END SEARCH_LISTS;
     1350     4606
     1351     4607    1   ALTRTN: ALTRETURN;
     1352     4608    1   END ZIU$REPRT;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:41   
--  Include file information  --

   ZI_UWA_C.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$REPRT.

   Procedure ZIU$REPRT requires 3091 words for executable code.
   Procedure ZIU$REPRT is declared NOAUTO and requires 1266 words of local(STATIC) storage.

    No errors detected in file ZIU$REPRT.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:42   

 Object Unit name= ZIU$REPRT                                  File name= ZIU$REPRT.:ZIC0TOU
 UTS= SEP 05 '97 13:29:17.36 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none  1266   2362  ZIU$REPRT
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$UC
    3  RoData even  UTS     70    106  ZIU$REPRT
    4   Proc  even  none  3091   6023  ZIU$REPRT
    5  RoData even  none   232    350  ZIU$REPRT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  ZIU$REPRT
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:43   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 BUILD_MSTR_TBL
 yes     yes           Std       0 SYS_FUNC_OPEN
 yes     yes           Std       0 SYS_FUNC_READ
 yes     yes           Std       2 SET_BUFS
 yes     yes           Std       0 SYS_FUNC_RELDCB
 yes     yes           Std       0 BUILD_SETXREF
 yes     yes           Std       0 SYS_FUNC_CLOS
 yes     yes           Std       0 FREE_DYN_MEM
 yes     yes           Std       2 FREE_TBL
         yes           Std       6 PAGE_RANGE
 yes     yes           Std       0 BUILD_RECXREF
 yes     yes           Std       1 GET_DCB
 yes     yes           Std       0 SYS_FUNC_WRIT
 yes     yes           Std       2 CREATE_TBL_SEG
 yes     yes           Std       2 EXPAND_TBL_SEG
 yes     yes           Std       0 SYS_FUNC_ERRMSG
         yes           Std       2 FLOAT
         yes           Std       2 FIX
         yes           Std       3 FLOAT_SUB
         yes           Std       3 FLOAT_DIV
         yes           Std       3 FLOAT_MPY
         yes           Std       3 ZERO_SUP
                       nStd      0 X66_SUNWIND
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:44   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     HIGH_DATA_PG                          LOW_DBK                               LPP
     BLKLSF                                KEYLSF                                KEYXSF
     DCBSF                                 ORGSF                                 KEYSF
     KEYVSF                                ACSSF                                 NOTIMESF
     FUNSF                                 ASNSF                                 TESTSF
     XTENSIZESF                            DISPSF                                WAITSF
     VFCSF                                 FULLSF                                BKUPSF
     BUFLNSF                               BUFSF                                 SOURCESF
     DESTSF                                DATESF                                TIMESF
     UTSSF                                 DAYSF                                 TSTAMPSF
     ENCRP_SEEDSF                          ERRCODESF                             MSGCODE
     INCL_ERR                              ERR_INSERT                            FIDSF_RD
     ACNT                                  EXISTSF                               SHARESF
     DCBNMSF                               KEYRSF                                NO_KEYSF
     REASGNSF                              CARRY_ATTRIBUTESF                     SUBMESSF
     SPKY_OPNSF                            POSSF                                 ERRFLGSF
     MERGESF                               FSA_FLAG                              RELGSF
     UNUSED                                HELPCODE                              COUNTSF
     INDEXSF                               GAP                                   PSNSF
     ACNTSF                                KEY_SHADWSF                           REC$
     RB                                    RE                                    IE
     IB                                    CNT                                   ICNT
     RCNT                                  SCNT                                  FIRST_SET
     RETCNT                                DMPCNT                                KCNT
     ACNT_IDX                              I                                     J
     K                                     X                                     STEPCC
     I_O_BUF$                              OUT_INDX                              I_O_SIZE
     REC_DATA_LN                           M$LO                                  B$TCB$
     B$ROS$                                B$JIT$                                KEYFID
     I_O_KEY                               RESTART                               BREAK_FLAG
     ICHKSUM                               ITMCNT                                GAP1
     ATBLK$                                DATA$                                 TYPE
     MSTR$                                 NXT_MSLOT                             MAX_MSLOT
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:45   
     MSTR_INDX                             HASHTBL                               HASHINDX
     LOC_MODE                              AREA_KEY$                             NO_AREAS
     GLBL_PTR_SZ                           SET_XREF$                             NXT_SSLOT
     MAX_SSLOT                             REC_XREF$                             NXT_RSLOT
     MAX_RSLOT                             NO_RECS                               NO_SETS
     XREF_BUILT                            TYPESET                               TYPEREC
     M$UC                                  UWA                                   ZI$DIR
     SCHEMA_ACTIVE                         RECORD_LIST                           SET_LIST
     RETAIN_LIST                           DUMP_FID                              ALTKY
     INIT_RG                               KEY_RNG                               ITEM_LIST

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ROSID                                 ISSID
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:46   


        1        1        /*M* ZIU$REPRT   IDS UTILITIES        REPORT RECORD STATISTICS  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8           NAME: ZIU$REPRT
        9        9        PURPOSE: This utility reports record statistics, keeping track of
       10       10                 the number of records of a type, the min and max record
       11       11                 size, the total size consumed by this sort of record,
       12       12                 the high and low dbkey for this type of record, and a                   
       13       13                 grand total for the size of the database.  It also
       14       14                 reports space usage and dbkeys usage per page.
       15       15                                                                         */
       16       16        ZIU$REPRT: PROC NOAUTO ALTRET;

     16  4 000000   000000 741200 0     ZIU$REPRT    STX1  ! 0

       17       17
       18       18    1   DCL HIGH_DATA_PG SBIN WORD SYMREF ALIGNED;
       19       19    1   DCL I_O_INDX SBIN WORD STATIC ALIGNED;
       20       20    1   DCL LOW_DBK SBIN WORD SYMREF ALIGNED;
       21       21    1   DCL LPP SBIN WORD SYMREF ALIGNED;
       22       22
       23       23    1   DCL 1 RECORD BASED(REC$) UBIN WORD CALIGNED;
       24       24    1   DCL 1 REC STATIC CALIGNED,
       25       25    1         2 TYPE UBIN HALF UNAL,
       26       26    1         2 LEN UBIN HALF UNAL;
       27       27    1   DCL 1 REC_REDEF REDEF REC UBIN WORD CALIGNED;
       28       28
       29       29    1   DCL RECS$ PTR STATIC ALIGNED;
       30       30    1   DCL 1 RECS(0:0) BASED(RECS$) ALIGNED, /*IF 'RECORDS=' SPECIFIED */
       31       31    1         2 NO_OF_RECS UBIN WORD UNAL, /* then this table parallels */
       32       32    1         2 TOT_SZ UBIN WORD UNAL, /* RECORD_LIST else it */
       33       33    1         2 LO_SZ UBIN WORD UNAL, /* parallels MSTR_REF */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:47   
       34       34    1         2 HI_SZ UBIN WORD UNAL,
       35       35    1         2 LO_DBKEY UBIN WORD ALIGNED,
       36       36    1         2 HI_DBKEY UBIN WORD ALIGNED,
       37       37    1         2 NO_OF_PAGES UBIN WORD UNAL,
       38       38    1         2 * UBIN WORD ALIGNED; /* FOR FUTURE EXPANSION */
       39       39
       40       40    1   DCL 1 CALC_REC ALIGNED,
       41       41    1         2 NO_OF_RECS UBIN WORD UNAL,
       42       42    1         2 TOT_SZ UBIN WORD UNAL,
       43       43    1         2 LO_SZ UBIN WORD UNAL,
       44       44    1         2 HI_SZ UBIN WORD UNAL,
       45       45    1         2 LO_DBKEY UBIN WORD ALIGNED,
       46       46    1         2 HI_DBKEY UBIN WORD ALIGNED;
       47       47
       48       48    1   DCL 1 PH0 ALIGNED STATIC,
       49       49    1         2 VFC CHAR(1) INIT('0'),
       50       50    1         2 * CHAR(31) INIT(' '),
       51       51    1         2 AREA_NAME CHAR(30);
       52       52    1   DCL PH1 CHAR(48) ALIGNED STATIC INIT(
                52            '                               RECORD STATISTICS');
       53       53    1   DCL PH2 CHAR(48) ALIGNED STATIC INIT(
                53            '                               -----------------');
       54       54    1   DCL 1 PH3 ALIGNED STATIC,
       55       55    1         2 * CHAR(40) INIT('RECORD              SIZE IN  VAR      NU'),
       56       56    1         2 * CHAR(40) INIT('MBER     # BYTES      LOWEST     HIGHEST');
       57       57    1   DCL 1 PH4 ALIGNED STATIC,
       58       58    1         2 * CHAR(40) INIT('NAME                  BYTES   SZ       F'),
       59       59    1         2 * CHAR(40) INIT('OUND        USED       DBKEY       DBKEY');
       60       60
       61       61    1   DCL 1 RLINE CALIGNED,
       62       62    1         2 REC_NAME CHAR(22),
       63       63    1         2 LO_SZ CHAR(5),
       64       64    1         2 HI_SZ CHAR(5),
       65       65    1         2 NO_OF_RECS CHAR(12),
       66       66    1         2 TOT_SZ CHAR(12),
       67       67    1         2 LO_DBKEY CHAR(12),
       68       68    1         2 HI_DBKEY CHAR(12);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:48   
       69       69
       70       70    1   DCL PF1 CHAR(56) STATIC ALIGNED
       71       71    1    INIT('                                 ----------- -----------');
       72       72    1   DCL 1 PF2 STATIC ALIGNED,
       73       73    1         2 * CHAR(32) INIT(' '),
       74       74    1         2 AREA_TOT_RECS CHAR(12),
       75       75    1         2 AREA_TOT_SZ CHAR(12),
       76       76    1         2 MSG CHAR(17) INIT(' = TOTALS FOR '),
       77       77    1         2 TYP CHAR(7);
       78       78    1   DCL 1 PF3 STATIC ALIGNED,
       79       79    1         2 * CHAR(50) INIT (' '),
       80       80    1         2 PRCNT_LINE,
       81       81    1           3 PRCNT_MSG CHAR(9) INIT (' '),
       82       82    1           3 PRCNT_USED CHAR(3) INIT (' '),
       83       83    1         2 * CHAR(18) INIT('% OF AREA USED');
       84       84
       85       85    1   DCL BLANK_LINE CHAR(1) STATIC ALIGNED INIT(' ');
       86       86
       87       87    1   DCL 1 OA ALIGNED,
       88       88    1         2 LO_SZ UBIN WORD UNAL,
       89       89    1         2 HI_SZ UBIN WORD UNAL,
       90       90    1         2 TOT_SZ UBIN WORD UNAL;
       91       91
       92       92    1   DCL OA_SZ UBIN WORD UNAL;
       93       93    1   DCL AREA_TOT_SZ UBIN(36) UNAL;
       94       94    1   DCL AREA_TOT_RECS UBIN(36) UNAL;
       95       95    1   DCL AREA_SZ_REAL UBIN DALIGNED;
       96       96    1   DCL REAL100 UBIN DALIGNED;
       97       97    1   DCL MPY_RSLT1_REAL UBIN DALIGNED;
       98       98    1   DCL NUM_PGS_REPORTED_REAL UBIN DALIGNED;
       99       99    1   DCL REAL4072 UBIN DALIGNED;
      100      100    1   DCL MPY_RSLT2_REAL UBIN DALIGNED;
      101      101    1   DCL OA_SZ_REAL UBIN DALIGNED;
      102      102    1   DCL SUBTRACT_RSLT_REAL UBIN DALIGNED;
      103      103    1   DCL DIV_RSLT_REAL UBIN DALIGNED;
      104      104    1   DCL PRCNT UBIN DALIGNED;
      105      105    1   DCL REAL4096 UBIN DALIGNED;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:49   
      106      106
      107      107    1   DCL NEED_SUMMARY BIT(1) UNAL STATIC; /* =1 if NO_AREAS>1 & AUTODUMP='1'B */
      108      108    1   DCL REC_IN_LIST BIT(1) UNAL; /* = 1 If this record name was specified */
      109      109    1   DCL INDX SBIN WORD STATIC INIT(0) ALIGNED;
      110      110    1   DCL REC_OK BIT(1) UNAL;
      111      111    1   DCL NUM_PGS_REPORTED UBIN WORD UNAL;
      112      112    1   DCL HIDBKY UBIN WORD ALIGNED STATIC INIT(BITBIN('777777777777'O));
      113      113
      114      114    1   DCL LAST_PAGE BIT(1) UNAL STATIC;
      115      115    1   DCL CLEAR_COUNTERS BIT(1) UNAL STATIC INIT('0'B);
      116      116
      117      117
      118      118    1   DCL DB_RECS$ PTR STATIC ALIGNED;
      119      119    1   DCL 1 DB_RECS(0:0) BASED(DB_RECS$) ALIGNED, /*IF REC= SPECIFIED */
      120      120    1         2 NO_OF_RECS UBIN WORD UNAL,
      121      121    1         2 TOT_SZ UBIN WORD UNAL,
      122      122    1         2 LO_SZ UBIN WORD UNAL,
      123      123    1         2 HI_SZ UBIN WORD UNAL,
      124      124    1         2 LO_DBKEY UBIN WORD UNAL,
      125      125    1         2 HI_DBKEY UBIN WORD UNAL,
      126      126    1         2 NO_OF_PAGES UBIN WORD UNAL,
      127      127    1         2 MSTRINDX UBIN HALF UNAL, /* INDX TO MSTR_REF FOR EACH REC */
      128      128    1         2 PA_INDX UBIN HALF UNAL; /* INDX TO PA TABLE FOR EACH PA_REC */
      129      129
      130      130    1   DCL Y SBIN WORD STATIC ALIGNED;
      131      131    1   DCL DESTROY_TBL SBIN STATIC ALIGNED;
      132      132    1   DCL PTR_SIZE UBIN WORD STATIC ALIGNED;
      133      133    1   DCL 1 PA_REC BASED(REC$) CALIGNED,
      134      134    1         2 * UBIN WORD UNAL, /* CONTROL WORD 1 */
      135      135    1         2 NOT_LOWEST_LEVEL BIT(1) UNAL,
      136      136    1         2 * UBIN(5) UNAL, /* FLAGS */
      137      137    1         2 ENTRIES UBIN(12) UNAL,
      138      138    1         2 AVAIL UBIN HALF UNAL,
      139      139    1         2 PTRS CHAR(PTR_SIZE) UNAL;
      140      140
      141      141    1   DCL ENTRY$ PTR STATIC ALIGNED;
      142      142    1   DCL 1 PA_ENTRY BASED(ENTRY$) CALIGNED,
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:50   
      143      143    1         2 C UBIN(1) UNAL,
      144      144    1         2 * UBIN(17) UNAL,
      145      145    1         2 PTRS CHAR(PTR_SIZE) UNAL;
      146      146
      147      147    1   DCL GROUP$ PTR STATIC ALIGNED;
      148      148    1   DCL 1 PA_GROUP BASED(GROUP$) CALIGNED,
      149      149    1         2 NO_GROUPS UBIN HALF UNAL;
      150      150    1   DCL CHAR_V CHAR(PTR_SIZE) BASED CALIGNED;
      151      151    1   DCL PTR_BIN UBIN WORD STATIC ALIGNED;
      152      152
      153      153    1   DCL PAH1 CHAR(0) STATIC CALIGNED
      154      154    1    INIT('                               POINTER ARRAY RECORDS');
      155      155    1   DCL PAH2 CHAR(0) STATIC CALIGNED
      156      156    1    INIT('                               SPACE  USAGE  SUMMARY');
      157      157    1   DCL PAH3 CHAR(0) STATIC CALIGNED
      158      158    1    INIT('                               ---------------------');
      159      159    1   DCL PAH4 CHAR(0) STATIC CALIGNED
      160      160    1    INIT(
               160          'POINTER ARRAY          NUMBER FOUND            AVERAGE PER PA_REC       % SPACE'
               160             );
      161      161    1   DCL PAH5 CHAR(0) STATIC CALIGNED
      162      162    1    INIT(
               162          'SET NAME            OWNER PA_REC MEMBER   ENTRY-USED(RESed) BYTE-AVAIL     USED'
               162             );
      163      163    1   DCL 1 PAH6 STATIC CALIGNED,
      164      164    1         2 REC_NAME CHAR(20) CALIGNED,
      165      165    1         2 OWNER_FOUND CHAR(5) CALIGNED,
      166      166    1         2 PA_FOUND CHAR(6) CALIGNED,
      167      167    1         2 MEM_FOUND CHAR(8) CALIGNED,
      168      168    1         2 * CHAR(8) CALIGNED,
      169      169    1         2 NUMBER_PTR CHAR(3) CALIGNED,
      170      170    1         2 DOT1 CHAR(1) CALIGNED,
      171      171    1         2 NUMBER_PTR2 CHAR(1) CALIGNED,
      172      172    1         2 LEFT_PARAN CHAR(1) CALIGNED,
      173      173    1         2 ENT_RES CHAR(4) CALIGNED,
      174      174    1         2 RIGHT_PARAN CHAR(1) CALIGNED,
      175      175    1         2 SPACE_AVAIL CHAR(8) CALIGNED,
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:51   
      176      176    1         2 DOT2 CHAR(1) CALIGNED,
      177      177    1         2 SPACE_AVAIL2 CHAR(1) CALIGNED,
      178      178    1         2 * CHAR(6) INIT(' ') CALIGNED,
      179      179    1         2 PERCENT_SPACE CHAR(3) CALIGNED,
      180      180    1         2 PERCENT_MARK CHAR(2) CALIGNED;
      181      181    1   DCL OV1 CHAR(0) STATIC CALIGNED
      182      182    1    INIT(
               182           '                                            LOCATION    SET   AVG# OF AVG PAGE'
               182             );
      183      183    1   DCL OV3 CHAR(0) STATIC CALIGNED
      184      184    1    INIT(
               184             '  SETNAME                  MEMBER             MODE  OCCURENCES MEMBERS  SPAN'
               184             );
      185      185    1   DCL OV3A CHAR(0) STATIC CALIGNED
      186      186    1    INIT(
               186           '  _______                  ______            ____ ___________ _______ ________'
               186             );
      187      187    1   DCL 1 OV4 STATIC ALIGNED,
      188      188    1         2 X,
      189      189    1           3 SET CHAR(30) UNAL,
      190      190    1           3 * CHAR(16) UNAL,
      191      191    1         2 V REDEF X,
      192      192    1           3 * CHAR(15) UNAL,
      193      193    1           3 REC CHAR(30) UNAL,
      194      194    1           3 * CHAR(1) UNAL,
      195      195    1         2 LOC CHAR(6) UNAL,
      196      196    1         2 * CHAR(3) UNAL,
      197      197    1         2 SET CHAR(7) UNAL,
      198      198    1         2 * CHAR(1) UNAL,
      199      199    1         2 MEM CHAR(7) UNAL,
      200      200    1         2 * CHAR(1) UNAL,
      201      201    1         2 PGE CHAR(7) UNAL;
      202      202    1   DCL OV5 CHAR(0) STATIC CALIGNED
      203      203    1    INIT('                               OVERFLOW REPORT');
      204      204    1   DCL OV5A CHAR(0) STATIC CALIGNED
      205      205    1    INIT('                               ---------------');
      206      206
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:52   
      207      207    1   DCL 1 DB_OA STATIC ALIGNED,
      208      208    1         2 LO_SZ UBIN WORD UNAL INIT(9999),
      209      209    1         2 HI_SZ UBIN WORD UNAL INIT(0),
      210      210    1         2 TOT_SZ UBIN WORD UNAL INIT(0);
      211      211
      212      212    1   DCL 1 DB_CALC_REC STATIC ALIGNED,
      213      213    1         2 NO_OF_RECS UBIN WORD UNAL INIT(0),
      214      214    1         2 TOT_SZ UBIN WORD UNAL INIT(0),
      215      215    1         2 LO_SZ UBIN WORD UNAL INIT(9999),
      216      216    1         2 HI_SZ UBIN WORD UNAL INIT(0),
      217      217    1         2 LO_DBKEY UBIN WORD ALIGNED INIT(BITBIN('777777777777'O)),
      218      218    1         2 HI_DBKEY UBIN WORD ALIGNED INIT(0);
      219      219
      220      220    1   DCL DB_TOT_SZ UBIN(36) STATIC UNAL INIT(0);
      221      221    1   DCL DB_TOT_RECS UBIN(36) STATIC UNAL INIT(0);
      222      222    1   DCL DB_NUM_PGS_REPORTED UBIN WORD STATIC ALIGNED INIT(0);
      223      223    1   DCL NUM_AREAS_REPORTED UBIN WORD UNAL STATIC INIT(0);
      224      224
      225      225    1   DCL PH5 CHAR(48) ALIGNED STATIC INIT(
               225            '                               PAGE   STATISTICS');
      226      226    1   DCL PH6 CHAR(68) ALIGNED STATIC INIT(
               226            '             DBKEY USAGE       -----------------         SPACE USAGE');
      227      227    1   DCL PH7 CHAR(68) ALIGNED STATIC INIT(
               227            '             -----------                                 -----------');
      228      228    1   DCL 1 PH8 ALIGNED STATIC,
      229      229    1         2 * CHAR(40) INIT('        # PAGES        % PAGES        % '),
      230      230    1         2 * CHAR(40) INIT('          # PAGES        % PAGES        ');
      231      231    1   DCL 1 PH9 ALIGNED STATIC,
      232      232    1         2 * CHAR(40) INIT('      THIS FULL      THIS FULL       FUL'),
      233      233    1         2 * CHAR(40) INIT('L       THIS FULL      THIS FULL        ');
      234      234
      235      235    1   DCL 1 PLINE ALIGNED STATIC,
      236      236    1         2 DNUM CHAR(15),
      237      237    1         2 DPRCNT CHAR(15),
      238      238    1         2 * CHAR(6) INIT(' '),
      239      239    1         2 PRCNT,
      240      240    1           3 * CHAR(3),
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:53   
      241      241    1           3 HI CHAR(3),
      242      242    1         2 SNUM CHAR(15),
      243      243    1         2 SPRCNT CHAR(15);
      244      244
      245      245    1   DCL 1 PGS(0:19) STATIC ALIGNED,
      246      246    1         2 DNUM UBIN WORD UNAL,
      247      247    1         2 DPRCNT UBIN WORD UNAL,
      248      248    1         2 PRCNT,
      249      249    1          3 * CHAR(2) INIT(' 0',' 5','10','15','20','25','30','35','40','45','50','55'
               249                    ,'60','65','70','75','80','85','90','95'),
      250      250    1           3 * CHAR(1) INIT('-'*0),
      251      251    1           3 HI CHAR(3)
      252      252    1   INIT('4  ','9  ','14 ','19 ','24 ','29 ','34 ','39 ','44 ','49 ','54 ','59 ','64 ',
               252            '69 ','74 ','79 ','84 ','89 ','94 ','100'),
      253      253    1         2 SNUM UBIN WORD UNAL,
      254      254    1         2 SPRCNT UBIN WORD UNAL;
      255      255    1   DCL 1 DB_PGS(0:19) STATIC ALIGNED,
      256      256    1         2 DNUM UBIN WORD UNAL,
      257      257    1         2 DPRCNT UBIN WORD UNAL,
      258      258    1         2 PRCNT,
      259      259    1          3 * CHAR(2) INIT(' 0',' 5','10','15','20','25','30','35','40','45','50','55'
               259                    ,'60','65','70','75','80','85','90','95'),
      260      260    1           3 * CHAR(1) INIT('-'*0),
      261      261    1           3 HI CHAR(3)
      262      262    1   INIT('4  ','9  ','14 ','19 ','24 ','29 ','34 ','39 ','44 ','49 ','54 ','59 ','64 ',
               262            '69 ','74 ','79 ','84 ','89 ','94 ','100'),
      263      263    1         2 SNUM UBIN WORD UNAL,
      264      264    1         2 SPRCNT UBIN WORD UNAL;
      265      265    1   DCL PRCNT_SPACE_FULL UBIN WORD ALIGNED;
      266      266    1   DCL PRCNT_DBKEYS_FULL UBIN WORD ALIGNED;
      267      267    1   DCL NUM_DBKEYS_UNUSED UBIN WORD ALIGNED;
      268      268    1   DCL NUM_DBKEYS_USED UBIN WORD ALIGNED;
      269      269    1   DCL PG_TOT_SZ UBIN WORD ALIGNED;
      270      270
      271      271         %INCLUDE ZI_GLOBAL_DBUTIL;
      272      449         %SYS_FUNC;
      273      541         %MISC_DCLS;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:54   
      274      594         %INCLUDE ZI$PG_STRUCTS;
      275      697         %ATBLK_PG;
      276      753         %DATA_PG;
      277      772         %INCLUDE ZI_DBU_XREF;
      278      939         %XREF_TBLS;
      279     1014         %INCLUDE ZI_ERRORS_SUBS;
      280     1534         %INCLUDE CP_6;
      281     1615         %F$DCB;
      282     1672         %INCLUDE CP_6_SUBS;
      283     2212         %INCLUDE ZI$DIR;
      284     2369         %INCLUDE ZI_UWA_C;
      285     3059         %ZI$UWAB;
      286     3399         %DIR;
      287     3543
      288     3544         %SUB OFFSET# = "2035 -";
      289     3545         %SUB #BUFS = 32;
      290     3546         %SUB NEVER = "WHILE('0'B)";
      291     3547         %SUB REPTBL# = 5;
      292     3548
      293     3549    1   DCL NUM_PA_RECS SBIN WORD STATIC ALIGNED;
      294     3550        /*    MAX_PA_SET IS SET TO 50 (121280) IN ZI_GLOBAL_DBUTIL */
      295     3551    1   DCL 1 PA(0:%MAX_PA_SET) ALIGNED AUTO,
      296     3552    1         2 RECSINDX UBIN HALF UNAL, /* POINT TO RECS INDX */
      297     3553    1         2 REC_SIZE UBIN HALF UNAL, /* SAVE PA REC SIZE */
      298     3554    1         2 OWNER_FOUND UBIN WORD ALIGNED,
      299     3555    1         2 MEM_FOUND UBIN WORD ALIGNED,
      300     3556    1         2 TOT_PTRS UBIN WORD ALIGNED,
      301     3557    1         2 SPACE_AVAIL UBIN WORD ALIGNED;
      302     3558    1   DCL BUILD_MSTR_TBL ENTRY ALTRET;
      303     3559    1   DCL BUILD_SETXREF ENTRY ALTRET;
      304     3560    1   DCL BUILD_RECXREF ENTRY ALTRET;
      305     3561    1   DCL CREATE_TBL_SEG ENTRY(2) ALTRET;
      306     3562    1   DCL EXPAND_TBL_SEG ENTRY(2) ALTRET;
      307     3563    1   DCL FREE_TBL ENTRY(2) ALTRET;
      308     3564    1   DCL SET_BUFS ENTRY(2) ALTRET;
      309     3565    1   DCL FREE_DYN_MEM ENTRY ALTRET;
      310     3566    1   DCL ZERO_SUP ENTRY(3);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:55   
      311     3567    1   DCL PAGE_RANGE ENTRY(6);
      312     3568    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
      313     3569    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
      314     3570    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      315     3571    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
      316     3572    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      317     3573    1   DCL GET_DCB ENTRY(1) ALTRET;
      318     3574    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
      319     3575    1   DCL FLOAT ENTRY(2);
      320     3576    1   DCL FLOAT_ADD ENTRY(3);
      321     3577    1   DCL FLOAT_SUB ENTRY(3);
      322     3578    1   DCL FLOAT_MPY ENTRY(3);
      323     3579    1   DCL FLOAT_DIV ENTRY(3);
      324     3580    1   DCL FIX ENTRY(2);
      325     3581
      326     3582        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:56   
      327     3583        /*-----------------------------------------------------------------*/
      328     3584        /*    Open file and get page attributes.                           */
      329     3585        /*-----------------------------------------------------------------*/
      330     3586
      331     3587    1       DESTROY_TBL=0;

   3587  4 000001   000314 450000 0                  STZ     DESTROY_TBL

      332     3588    1       NUM_AREAS_REPORTED=0;

   3588  4 000002   000650 450000 0                  STZ     NUM_AREAS_REPORTED

      333     3589    1       IF XREF_BUILT=%NO# THEN

   3589  4 000003   000000 234000 xsym               SZN     XREF_BUILT
         4 000004   000016 604000 4                  TMI     s:3595

      334     3590    2       DO;

      335     3591    2           CALL BUILD_MSTR_TBL ALTRET(ALTRTN);

   3591  4 000005   000000 631400 5                  EPPR1   0
         4 000006   000000 701000 xent               TSX1    BUILD_MSTR_TBL
         4 000007   006021 702000 4                  TSX2    ALTRTN

      336     3592    2           CALL BUILD_SETXREF ALTRET(ALTRTN);

   3592  4 000010   000000 631400 5                  EPPR1   0
         4 000011   000000 701000 xent               TSX1    BUILD_SETXREF
         4 000012   006021 702000 4                  TSX2    ALTRTN

      337     3593    2           CALL BUILD_RECXREF ALTRET(ALTRTN);

   3593  4 000013   000000 631400 5                  EPPR1   0
         4 000014   000000 701000 xent               TSX1    BUILD_RECXREF
         4 000015   006021 702000 4                  TSX2    ALTRTN

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:57   
      338     3594    2           END;

      339     3595    1       NUM_AREAS_REPORTED = 0;

   3595  4 000016   000650 450000 0                  STZ     NUM_AREAS_REPORTED

      340     3596    1       IF ZI$DIR.AUTODUMP THEN /* IF REPORT ALL AREAS */

   3596  4 000017   000026 236000 xsym               LDQ     ZI$DIR+22
         4 000020   400000 316007                    CANQ    -131072,DL
         4 000021   000064 600000 4                  TZE     NEXT_AREA

      341     3597    2       DO;

      342     3598    3           DO I=0 TO NO_AREAS-1; /* GET RID OFF ALL INDEXED AREAS */

   3598  4 000022   000000 450000 xsym               STZ     I
         4 000023   000060 710000 4                  TRA     s:3608+1

      343     3599    3               IF AREA_KEY_XREF.MAX_KEY(I)=0 THEN /* INDEX AREA */

   3599  4 000024   000000 236000 xsym               LDQ     I
         4 000025   000012 402007                    MPY     10,DL
         4 000026   000000 470400 xsym               LDP0    AREA_KEY$
         4 000027   000000 235106                    LDA     0,QL,PR0
         4 000030   000001 236106                    LDQ     1,QL,PR0
         4 000031   000022 773000                    LRL     18
         4 000032   000000 116003                    CMPQ    0,DU
         4 000033   000057 601000 4                  TNZ     s:3608

      344     3600    4               DO;

      345     3601    5                   DO J=I+1 TO NO_AREAS-1;

   3601  4 000034   000000 235000 xsym               LDA     I
         4 000035   000001 035007                    ADLA    1,DL
         4 000036   000000 755000 xsym               STA     J
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:58   
         4 000037   000047 710000 4                  TRA     s:3603+1

      346     3602    5                       AREA_KEY_XREF(J-1)=AREA_KEY_XREF(J);

   3602  4 000040   000000 236000 xsym               LDQ     J
         4 000041   000050 402007                    MPY     40,DL
         4 000042   000000 470400 xsym               LDP0    AREA_KEY$
         4 000043   000106 100506                    MLR     fill='000'O
         4 000044   000000 000050                    ADSC9   0,Q,PR0                  cn=0,n=40
         4 000045   077766 000050                    ADSC9   -10,Q,PR0                cn=0,n=40

      347     3603    5                       END;

   3603  4 000046   000000 054000 xsym               AOS     J
         4 000047   000000 236000 xsym               LDQ     J
         4 000050   000000 116000 xsym               CMPQ    NO_AREAS
         4 000051   000040 604000 4                  TMI     s:3602

      348     3604    4                   DESTROY_TBL=1; /* AREA TABLE WAS MESSED UP, DESTROY IT */

   3604  4 000052   000001 235007                    LDA     1,DL
         4 000053   000314 755000 0                  STA     DESTROY_TBL

      349     3605    4                   NO_AREAS=NO_AREAS-1;

   3605  4 000054   000001 336007                    LCQ     1,DL
         4 000055   000000 056000 xsym               ASQ     NO_AREAS

      350     3606    4                   I = I - 1;

   3606  4 000056   000000 056000 xsym               ASQ     I

      351     3607    4                   END;

      352     3608    3               END;

   3608  4 000057   000000 054000 xsym               AOS     I
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:59   
         4 000060   000000 236000 xsym               LDQ     I
         4 000061   000000 116000 xsym               CMPQ    NO_AREAS
         4 000062   000024 604000 4                  TMI     s:3599

      353     3609    2           GOTO CLOSE_AREA;

   3609  4 000063   001170 710000 4                  TRA     CLOSE_AREA

      354     3610    2           END;
      355     3611    1   NEXT_AREA:
      356     3612    1   /**/ DCBSF = ZI$DIR.AREA_NM.DCB#;

   3612  4 000064   000244 220000 xsym  NEXT_AREA    LDX0    ZI$DIR+164
         4 000065   000000 740000 xsym               STX0    DCBSF

      357     3613    1       ORGSF = %IDS#;

   3613  4 000066   000007 235007                    LDA     7,DL
         4 000067   000000 755000 xsym               STA     ORGSF

      358     3614    1       ASNSF = %FILE#;

   3614  4 000070   000001 236007                    LDQ     1,DL
         4 000071   000000 756000 xsym               STQ     ASNSF

      359     3615    1       ACSSF = %DIRECT#;

   3615  4 000072   000002 235007                    LDA     2,DL
         4 000073   000000 755000 xsym               STA     ACSSF

      360     3616    1       FUNSF = %IN#;

   3616  4 000074   000000 755000 xsym               STA     FUNSF

      361     3617    1       SHARESF = %ALL#;

   3617  4 000075   200000 236003                    LDQ     65536,DU
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:60   
         4 000076   000000 756000 xsym               STQ     SHARESF

      362     3618    1       FIDSF = ZI$DIR.AREA_NM.NAME.TEXT;

   3618  4 000077   040000 100400                    MLR     fill='040'O
         4 000100   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         4 000101   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

      363     3619    1       CALL SYS_FUNC_OPEN ALTRET(ALTRTN);

   3619  4 000102   000000 631400 5                  EPPR1   0
         4 000103   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 000104   006021 702000 4                  TSX2    ALTRTN

      364     3620
      365     3621    1       CALL GET_ATBLK(HIGH_DATA_PG) ALTRET(ALTRTN);

   3621  4 000105   000001 236000 5                  LDQ     1
         4 000106   002110 756000 0                  STQ     PA+321
         4 000107   002044 701000 4                  TSX1    GET_ATBLK
         4 000110   006021 702000 4                  TSX2    ALTRTN

      366     3622
      367     3623    1       LAST_PAGE = %NO#;

   3623  4 000111   000310 450000 0                  STZ     LAST_PAGE

      368     3624    1       OA.LO_SZ = 9999;

   3624  4 000112   023417 235007                    LDA     9999,DL
         4 000113   000245 755000 0                  STA     OA

      369     3625    1       OA.HI_SZ = 0;

   3625  4 000114   000246 450000 0                  STZ     OA+1

      370     3626    1       OA.TOT_SZ = 0;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:61   

   3626  4 000115   000247 450000 0                  STZ     OA+2

      371     3627    1       NUM_PGS_REPORTED = 0;

   3627  4 000116   000306 450000 0                  STZ     NUM_PGS_REPORTED

      372     3628    1       AREA_TOT_SZ = 0;

   3628  4 000117   000251 450000 0                  STZ     AREA_TOT_SZ

      373     3629    1       AREA_TOT_RECS = 0;

   3629  4 000120   000252 450000 0                  STZ     AREA_TOT_RECS

      374     3630    1       PH0.AREA_NAME = ZI$DIR.AREA_NM.NAME.TEXT;

   3630  4 000121   040000 100400                    MLR     fill='040'O
         4 000122   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         4 000123   000022 000036 0                  ADSC9   PH0+8                    cn=0,n=30

      375     3631    1       NUM_AREAS_REPORTED = NUM_AREAS_REPORTED + 1;

   3631  4 000124   000650 236000 0                  LDQ     NUM_AREAS_REPORTED
         4 000125   000001 036007                    ADLQ    1,DL
         4 000126   000650 756000 0                  STQ     NUM_AREAS_REPORTED

      376     3632
      377     3633    2       IF NUM_AREAS_REPORTED = 1 THEN DO;

   3633  4 000127   000001 116007                    CMPQ    1,DL
         4 000130   000165 601000 4                  TNZ     s:3658

      378     3634    2           NUM_PA_RECS=-1;

   3634  4 000131   000001 335007                    LCA     1,DL
         4 000132   001406 755000 0                  STA     NUM_PA_RECS
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:62   

      379     3635    2           CALL SET_BUFS(,32);

   3635  4 000133   000005 236000 5                  LDQ     5
         4 000134   000003 235000 5                  LDA     3
         4 000135   002352 757000 0                  STAQ    J+1
         4 000136   002352 630400 0                  EPPR0   J+1
         4 000137   000002 631400 5                  EPPR1   2
         4 000140   000000 701000 xent               TSX1    SET_BUFS
         4 000141   000000 011000                    NOP     0

      380     3636    2           CALL CREATE_TBL_SEG(RECS$,REPTBL#) ALTRET(ALTRTN);

   3636  4 000142   000007 630400 5                  EPPR0   7
         4 000143   000002 631400 5                  EPPR1   2
         4 000144   000000 701000 xent               TSX1    CREATE_TBL_SEG
         4 000145   006021 702000 4                  TSX2    ALTRTN

      381     3637    2           X = ((NO_RECS * 16) / 1024) + 1; /* No pages needed for table */

   3637  4 000146   000000 236000 xsym               LDQ     NO_RECS
         4 000147   000004 736000                    QLS     4
         4 000150   002000 506007                    DIV     1024,DL
         4 000151   000001 036007                    ADLQ    1,DL
         4 000152   000000 756000 xsym               STQ     X

      382     3638    2           IF X > 1 THEN CALL EXPAND_TBL_SEG(X,REPTBL#) ALTRET(ALTRTN);

   3638  4 000153   000001 116007                    CMPQ    1,DL
         4 000154   000161 604400 4                  TMOZ    s:3639

   3638  4 000155   000011 630400 5                  EPPR0   9
         4 000156   000002 631400 5                  EPPR1   2
         4 000157   000000 701000 xent               TSX1    EXPAND_TBL_SEG
         4 000160   006021 702000 4                  TSX2    ALTRTN

      383     3639    2           DB_RECS$=PINCRW(RECS$,X*512); /*HALF WAY POINT OF SEGMENT */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:63   

   3639  4 000161   000000 236000 xsym               LDQ     X
         4 000162   000033 736000                    QLS     27
         4 000163   000003 036000 0                  ADLQ    RECS$
         4 000164   000312 756000 0                  STQ     DB_RECS$

      384     3640    2           END;

      385     3641
      386     3642        /*  If 'REC' NOT specified,
      387     3643               then
      388     3644                   if this is the first call
      389     3645                      then initialize summary items
      390     3646                   initialize area items
      391     3647            If 'REC' specified
      392     3648               then
      393     3649                    if this is the first call
      394     3650                      then
      395     3651                          verify record names specified
      396     3652                          initialize area items
      397     3653                          initialize summary items
      398     3654                   if this is not the first call
      399     3655                      then
      400     3656                          initialize area items
      401     3657                                                                    */
      402     3658    1       IF RCNT = -1

   3658  4 000165   000000 235000 xsym               LDA     RCNT
         4 000166   000013 115000 5                  CMPA    11
         4 000167   000327 601000 4                  TNZ     s:3693

      403     3659    1       THEN
      404     3660    2       DO;

      405     3661    2           IF (NUM_AREAS_REPORTED = 1) & (ZI$DIR.AUTODUMP = '1'B)

   3661  4 000170   400000 220003                    LDX0    -131072,DU
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:64   
         4 000171   000650 236000 0                  LDQ     NUM_AREAS_REPORTED
         4 000172   000001 116007                    CMPQ    1,DL
         4 000173   000175 600000 4                  TZE     s:3661+5
         4 000174   000000 220003                    LDX0    0,DU
         4 000175   400000 221003                    LDX1    -131072,DU
         4 000176   000026 236000 xsym               LDQ     ZI$DIR+22
         4 000177   400000 316007                    CANQ    -131072,DL
         4 000200   000202 601000 4                  TNZ     s:3661+10
         4 000201   000000 221003                    LDX1    0,DU
         4 000202   000000 636011                    EAQ     0,X1
         4 000203   002352 756000 0                  STQ     J+1
         4 000204   000000 636010                    EAQ     0,X0
         4 000205   002352 376000 0                  ANQ     J+1
         4 000206   000262 600000 4                  TZE     s:3683

      406     3662    2           THEN
      407     3663    3           DO;

      408     3664    3               DB_TOT_SZ = 0;

   3664  4 000207   000645 450000 0                  STZ     DB_TOT_SZ

      409     3665    3               DB_TOT_RECS = 0;

   3665  4 000210   000646 450000 0                  STZ     DB_TOT_RECS

      410     3666    3               DB_NUM_PGS_REPORTED = 0;

   3666  4 000211   000647 450000 0                  STZ     DB_NUM_PGS_REPORTED

      411     3667    3               DB_CALC_REC = '0'B;

   3667  4 000212   000000 100400                    MLR     fill='000'O
         4 000213   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000214   000637 000030 0                  ADSC9   DB_CALC_REC              cn=0,n=24

      412     3668    3               DB_CALC_REC.LO_SZ = 9999;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:65   

   3668  4 000215   023417 236007                    LDQ     9999,DL
         4 000216   000641 756000 0                  STQ     DB_CALC_REC+2

      413     3669    3               DB_CALC_REC.LO_DBKEY = HIDBKY;

   3669  4 000217   000307 235000 0                  LDA     HIDBKY
         4 000220   000643 755000 0                  STA     DB_CALC_REC+4

      414     3670    3               DB_OA.LO_SZ = 9999;

   3670  4 000221   000634 756000 0                  STQ     DB_OA

      415     3671    3               DB_OA.HI_SZ = 0;

   3671  4 000222   000635 450000 0                  STZ     DB_OA+1

      416     3672    3               DB_OA.TOT_SZ = 0;

   3672  4 000223   000636 450000 0                  STZ     DB_OA+2

      417     3673    4               DO X = 0 TO (NO_RECS -1 );

   3673  4 000224   000000 450000 xsym               STZ     X
         4 000225   000257 710000 4                  TRA     s:3681+1

      418     3674    4                   DB_RECS.LO_SZ(X) = 9999;

   3674  4 000226   000000 235000 xsym               LDA     X
         4 000227   000003 735000                    ALS     3
         4 000230   023417 236007                    LDQ     9999,DL
         4 000231   000312 470400 0                  LDP0    DB_RECS$
         4 000232   000002 756105                    STQ     2,AL,PR0

      419     3675    4                   DB_RECS.LO_DBKEY(X) = HIDBKY;

   3675  4 000233   000000 235000 xsym               LDA     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:66   
         4 000234   000003 735000                    ALS     3
         4 000235   000307 236000 0                  LDQ     HIDBKY
         4 000236   000004 756105                    STQ     4,AL,PR0

      420     3676    4                   DB_RECS.NO_OF_RECS(X)=0;

   3676  4 000237   000000 235000 xsym               LDA     X
         4 000240   000003 735000                    ALS     3
         4 000241   000000 450105                    STZ     0,AL,PR0

      421     3677    4                   DB_RECS.TOT_SZ(X) = 0;

   3677  4 000242   000000 235000 xsym               LDA     X
         4 000243   000003 735000                    ALS     3
         4 000244   000001 450105                    STZ     1,AL,PR0

      422     3678    4                   DB_RECS.HI_SZ(X) = 0;

   3678  4 000245   000000 235000 xsym               LDA     X
         4 000246   000003 735000                    ALS     3
         4 000247   000003 450105                    STZ     3,AL,PR0

      423     3679    4                   DB_RECS.HI_DBKEY(X) = 0;

   3679  4 000250   000000 235000 xsym               LDA     X
         4 000251   000003 735000                    ALS     3
         4 000252   000005 450105                    STZ     5,AL,PR0

      424     3680    4                   DB_RECS.NO_OF_PAGES(X) = 0;

   3680  4 000253   000000 235000 xsym               LDA     X
         4 000254   000003 735000                    ALS     3
         4 000255   000006 450105                    STZ     6,AL,PR0

      425     3681    4                   END;

   3681  4 000256   000000 054000 xsym               AOS     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:67   
         4 000257   000000 236000 xsym               LDQ     X
         4 000260   000000 116000 xsym               CMPQ    NO_RECS
         4 000261   000226 604000 4                  TMI     s:3674

      426     3682    3               END;

      427     3683    3           DO X = 0 TO (NO_RECS - 1);

   3683  4 000262   000000 450000 xsym               STZ     X
         4 000263   000276 710000 4                  TRA     s:3686+1

      428     3684    3               RECS.NO_OF_RECS(X) = 0;

   3684  4 000264   000000 235000 xsym               LDA     X
         4 000265   000003 735000                    ALS     3
         4 000266   000003 470400 0                  LDP0    RECS$
         4 000267   000000 450105                    STZ     0,AL,PR0

      429     3685    3               DB_RECS.MSTRINDX(X)=X; /* TWO TABLES ARE PARALLEL */

   3685  4 000270   000000 235000 xsym               LDA     X
         4 000271   000003 735000                    ALS     3
         4 000272   000000 720000 xsym               LXL0    X
         4 000273   000312 470400 0                  LDP0    DB_RECS$
         4 000274   000007 740105                    STX0    7,AL,PR0

      430     3686    3               END;

   3686  4 000275   000000 054000 xsym               AOS     X
         4 000276   000000 236000 xsym               LDQ     X
         4 000277   000000 116000 xsym               CMPQ    NO_RECS
         4 000300   000264 604000 4                  TMI     s:3684

      431     3687    2           CALC_REC = '0'B;

   3687  4 000301   000000 100400                    MLR     fill='000'O
         4 000302   000000 000001 5                  ADSC9   0                        cn=0,n=1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:68   
         4 000303   000004 000030 0                  ADSC9   CALC_REC                 cn=0,n=24

      432     3688    2           PF2.TYP = 'AREA';

   3688  4 000304   040000 100400                    MLR     fill='040'O
         4 000305   000000 000004 3                  ADSC9   0                        cn=0,n=4
         4 000306   000216 200007 0                  ADSC9   PF2+18                   cn=1,n=7

      433     3689    2           NEED_SUMMARY = (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS > 1);

   3689  4 000307   400000 220003                    LDX0    -131072,DU
         4 000310   000026 236000 xsym               LDQ     ZI$DIR+22
         4 000311   400000 316007                    CANQ    -131072,DL
         4 000312   000314 601000 4                  TNZ     s:3689+5
         4 000313   000000 220003                    LDX0    0,DU
         4 000314   400000 221003                    LDX1    -131072,DU
         4 000315   000000 235000 xsym               LDA     NO_AREAS
         4 000316   000001 115007                    CMPA    1,DL
         4 000317   000321 605400 4                  TPNZ    s:3689+10
         4 000320   000000 221003                    LDX1    0,DU
         4 000321   000000 636011                    EAQ     0,X1
         4 000322   002352 756000 0                  STQ     J+1
         4 000323   000000 636010                    EAQ     0,X0
         4 000324   002352 376000 0                  ANQ     J+1
         4 000325   000302 756000 0                  STQ     NEED_SUMMARY

      434     3690    2           END;

   3690  4 000326   000647 710000 4                  TRA     s:3771

      435     3691    1       ELSE
      436     3692    2       DO;

      437     3693    2           IF NUM_AREAS_REPORTED = 1

   3693  4 000327   000650 236000 0                  LDQ     NUM_AREAS_REPORTED
         4 000330   000001 116007                    CMPQ    1,DL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:69   
         4 000331   000635 601000 4                  TNZ     s:3766

      438     3694    2           THEN
      439     3695    3           DO;

      440     3696    4               DO X = 0 TO RCNT;

   3696  4 000332   000000 450000 xsym               STZ     X
         4 000333   000530 710000 4                  TRA     s:3740+1

      441     3697    4                   REC_OK = '0'B;

   3697  4 000334   000305 450000 0                  STZ     REC_OK

      442     3698    4                   IF RECORD_LIST.NAME(X)='*CALC' THEN

   3698  4 000335   000000 235000 xsym               LDA     X
         4 000336   000005 735000                    ALS     5
         4 000337   040000 106405                    CMPC    fill='040'O
         4 000340   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 000341   000001 000005 3                  ADSC9   1                        cn=0,n=5
         4 000342   000346 601000 4                  TNZ     s:3700

      443     3699    4                       RECORD_LIST.NAME(X)='*CALC.RC'; /* USE INTERNAL NAME */

   3699  4 000343   040005 100400                    MLR     fill='040'O
         4 000344   000003 000010 3                  ADSC9   3                        cn=0,n=8
         4 000345   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30

      444     3700    5                   DO I = 0 TO (NO_RECS - 1);

   3700  4 000346   000000 450000 xsym               STZ     I
         4 000347   000431 710000 4                  TRA     s:3716+1

      445     3701    5                       IF (RECORD_LIST.NAME(X) = MSTR_REF.NAME(I))

   3701  4 000350   000000 235000 xsym               LDA     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:70   
         4 000351   000005 735000                    ALS     5
         4 000352   000000 236000 xsym               LDQ     I
         4 000353   002352 755000 0                  STA     J+1
         4 000354   000050 402007                    MPY     40,DL
         4 000355   002352 235000 0                  LDA     J+1
         4 000356   000000 470400 xsym               LDP0    MSTR$
         4 000357   040106 106405                    CMPC    fill='040'O
         4 000360   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 000361   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         4 000362   000430 601000 4                  TNZ     s:3716

      446     3702    5                       THEN
      447     3703    6                       DO;

      448     3704    6                           REC_OK = '1'B;

   3704  4 000363   400000 236003                    LDQ     -131072,DU
         4 000364   000305 756000 0                  STQ     REC_OK

      449     3705    6                           RECORD_LIST.TYPE(X) = MSTR_REF.TYPE(I);

   3705  4 000365   000000 235000 xsym               LDA     X
         4 000366   000003 735000                    ALS     3
         4 000367   000000 236000 xsym               LDQ     I
         4 000370   000000 620005                    EAX0    0,AL
         4 000371   000012 402007                    MPY     10,DL
         4 000372   000000 221106                    LDX1    0,QL,PR0
         4 000373   000007 441010 xsym               SXL1    RECORD_LIST+7,X0

      450     3706    6                           DB_RECS.MSTRINDX(X)=I; /* REMEMBER THE MSTRINDX */

   3706  4 000374   000000 235000 xsym               LDA     X
         4 000375   000003 735000                    ALS     3
         4 000376   000000 720000 xsym               LXL0    I
         4 000377   000312 471400 0                  LDP1    DB_RECS$
         4 000400   100007 740105                    STX0    7,AL,PR1

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:71   
      451     3707    6                           IF MSTR_REF.PAOFF(I) > 0 AND

   3707  4 000401   000000 236000 xsym               LDQ     I
         4 000402   000012 402007                    MPY     10,DL
         4 000403   000000 470400 xsym               LDP0    MSTR$
         4 000404   000011 236106                    LDQ     9,QL,PR0
         4 000405   777000 316003                    CANQ    -512,DU
         4 000406   000426 600000 4                  TZE     s:3714
         4 000407   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000410   001000 316007                    CANQ    512,DL
         4 000411   000415 601000 4                  TNZ     s:3710
         4 000412   000126 236000 xsym               LDQ     ZI$DIR+86
         4 000413   100000 316003                    CANQ    32768,DU
         4 000414   000426 600000 4                  TZE     s:3714

      452     3708    6                              (ZI$DIR.REPRT_ALL OR ZI$DIR.REPRT_PA) THEN
      453     3709    7                           DO;

      454     3710    7                               NUM_PA_RECS=NUM_PA_RECS+1;

   3710  4 000415   001406 054000 0                  AOS     NUM_PA_RECS

      455     3711    7                               DB_RECS.PA_INDX(X)=NUM_PA_RECS;

   3711  4 000416   000000 235000 xsym               LDA     X
         4 000417   000003 735000                    ALS     3
         4 000420   001406 720000 0                  LXL0    NUM_PA_RECS
         4 000421   100007 440105                    SXL0    7,AL,PR1

      456     3712    7                               PA.RECSINDX(NUM_PA_RECS)=X; /* BLINK $ FLINK */

   3712  4 000422   001406 236000 0                  LDQ     NUM_PA_RECS
         4 000423   000005 402007                    MPY     5,DL
         4 000424   000000 721000 xsym               LXL1    X
         4 000425   001407 741006 0                  STX1    PA,QL

      457     3713    7                               END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:72   

      458     3714    6                           I = NO_RECS;

   3714  4 000426   000000 235000 xsym               LDA     NO_RECS
         4 000427   000000 755000 xsym               STA     I

      459     3715    6                           END;

      460     3716    5                       END;

   3716  4 000430   000000 054000 xsym               AOS     I
         4 000431   000000 236000 xsym               LDQ     I
         4 000432   000000 116000 xsym               CMPQ    NO_RECS
         4 000433   000350 604000 4                  TMI     s:3701

      461     3717    4                   IF REC_OK AND ZI$DIR.REPRT_PA AND

   3717  4 000434   000305 234000 0                  SZN     REC_OK
         4 000435   000460 605000 4                  TPL     s:3725
         4 000436   000126 236000 xsym               LDQ     ZI$DIR+86
         4 000437   100000 316003                    CANQ    32768,DU
         4 000440   000460 600000 4                  TZE     s:3725
         4 000441   000000 235000 xsym               LDA     X
         4 000442   000003 735000                    ALS     3
         4 000443   000312 470400 0                  LDP0    DB_RECS$
         4 000444   000007 236105                    LDQ     7,AL,PR0
         4 000445   000022 772000                    QRL     18
         4 000446   000012 402007                    MPY     10,DL
         4 000447   000000 471400 xsym               LDP1    MSTR$
         4 000450   100011 236106                    LDQ     9,QL,PR1
         4 000451   777000 316003                    CANQ    -512,DU
         4 000452   000460 601000 4                  TNZ     s:3725

      462     3718    4                      MSTR_REF.PAOFF(DB_RECS.MSTRINDX(X))=0 THEN
      463     3719    5                   DO;

      464     3720        /*E* ERROR: ZIU-DBU#NOTPAREP-C
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:73   
      465     3721           MESSAGE: The record "%U1" is not a PA_REC. */
      466     3722    5                       ERRCODESF.ERR# = DBU#NOTPAREP;

   3722  4 000453   000000 236000 xsym               LDQ     ERRCODESF
         4 000454   000014 376000 5                  ANQ     12
         4 000455   217000 276007                    ORQ     73216,DL
         4 000456   000000 756000 xsym               STQ     ERRCODESF

      467     3723    5                       GOTO PRINT_ERRMSG;

   3723  4 000457   000466 710000 4                  TRA     PRINT_ERRMSG

      468     3724    5                       END;
      469     3725    4                   IF REC_OK = '0'B

   3725  4 000460   000305 234000 0                  SZN     REC_OK
         4 000461   000523 604000 4                  TMI     s:3739

      470     3726    4                   THEN
      471     3727    5                   DO;

      472     3728    5                       ERRCODESF.ERR# = DBU#NOREC;

   3728  4 000462   000000 236000 xsym               LDQ     ERRCODESF
         4 000463   000014 376000 5                  ANQ     12
         4 000464   214700 276007                    ORQ     72128,DL
         4 000465   000000 756000 xsym               STQ     ERRCODESF

      473     3729    5   PRINT_ERRMSG:
      474     3730    5                       CALL INDEX(INDX,' ',RECORD_LIST.NAME(X));

   3730  4 000466   000000 235000 xsym  PRINT_ERRMSG LDA     X
         4 000467   000005 735000                    ALS     5
         4 000470   000000 124405                    SCM     mask='000'O
         4 000471   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 000472   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 000473   000304 000000 0                  ARG     INDX
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:74   

      475     3731    5                       ERR_INSERT.CNT(0) = INDX;

   3731  4 000474   000304 236000 0                  LDQ     INDX
         4 000475   000033 736000                    QLS     27
         4 000476   000000 552040 xsym               STBQ    ERR_INSERT,'40'O

      476     3732    5                       ERR_INSERT.TEXT(0) = RECORD_LIST.NAME(X);

   3732  4 000477   040000 100405                    MLR     fill='040'O
         4 000500   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 000501   000000 200036 xsym               ADSC9   ERR_INSERT               cn=1,n=30

      477     3733    5                       MSGCODE = ERRCODE_RDEF;

   3733  4 000502   000000 236000 xsym               LDQ     ERRCODESF
         4 000503   000000 756000 xsym               STQ     MSGCODE

      478     3734    5                       CALL SYS_FUNC_ERRMSG;

   3734  4 000504   000000 631400 5                  EPPR1   0
         4 000505   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 000506   000000 011000                    NOP     0

      479     3735    5                       CALL SYS_FUNC_CLOS;

   3735  4 000507   000000 631400 5                  EPPR1   0
         4 000510   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 000511   000000 011000                    NOP     0

      480     3736    5                       CALL FREE_TBL(,REPTBL#);

   3736  4 000512   000010 236000 5                  LDQ     8
         4 000513   000003 235000 5                  LDA     3
         4 000514   002352 757000 0                  STAQ    J+1
         4 000515   002352 630400 0                  EPPR0   J+1
         4 000516   000002 631400 5                  EPPR1   2
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:75   
         4 000517   000000 701000 xent               TSX1    FREE_TBL
         4 000520   000000 011000                    NOP     0

      481     3737    5                       ALTRETURN;

   3737  4 000521   000000 221200 0                  LDX1  ! 0
         4 000522   000000 702211                    TSX2  ! 0,X1

      482     3738    5                       END;
      483     3739    4                   RECS.NO_OF_RECS(X) = 0;

   3739  4 000523   000000 235000 xsym               LDA     X
         4 000524   000003 735000                    ALS     3
         4 000525   000003 470400 0                  LDP0    RECS$
         4 000526   000000 450105                    STZ     0,AL,PR0

      484     3740    4                   END;

   3740  4 000527   000000 054000 xsym               AOS     X
         4 000530   000000 236000 xsym               LDQ     X
         4 000531   000000 116000 xsym               CMPQ    RCNT
         4 000532   000334 604400 4                  TMOZ    s:3697

      485     3741
      486     3742    4               IF ZI$DIR.AUTODUMP = '1'B THEN DO;

   3742  4 000533   000026 236000 xsym               LDQ     ZI$DIR+22
         4 000534   400000 316007                    CANQ    -131072,DL
         4 000535   000607 600000 4                  TZE     s:3761

      487     3743    4                   DB_TOT_SZ = 0;

   3743  4 000536   000645 450000 0                  STZ     DB_TOT_SZ

      488     3744    4                   DB_TOT_RECS = 0;

   3744  4 000537   000646 450000 0                  STZ     DB_TOT_RECS
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:76   

      489     3745    4                   DB_NUM_PGS_REPORTED = 0;

   3745  4 000540   000647 450000 0                  STZ     DB_NUM_PGS_REPORTED

      490     3746    4                   DB_CALC_REC = '0'B;

   3746  4 000541   000000 100400                    MLR     fill='000'O
         4 000542   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000543   000637 000030 0                  ADSC9   DB_CALC_REC              cn=0,n=24

      491     3747    4                   DB_CALC_REC.LO_SZ = 9999;

   3747  4 000544   023417 235007                    LDA     9999,DL
         4 000545   000641 755000 0                  STA     DB_CALC_REC+2

      492     3748    4                   DB_CALC_REC.LO_DBKEY = HIDBKY;

   3748  4 000546   000307 235000 0                  LDA     HIDBKY
         4 000547   000643 755000 0                  STA     DB_CALC_REC+4

      493     3749    4                   DB_OA.LO_SZ = 9999;

   3749  4 000550   023417 235007                    LDA     9999,DL
         4 000551   000634 755000 0                  STA     DB_OA

      494     3750    4                   DB_OA.HI_SZ = 0;

   3750  4 000552   000635 450000 0                  STZ     DB_OA+1

      495     3751    4                   DB_OA.TOT_SZ = 0;

   3751  4 000553   000636 450000 0                  STZ     DB_OA+2

      496     3752    5                   DO X = 0 TO RCNT;

   3752  4 000554   000000 450000 xsym               STZ     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:77   
         4 000555   000604 710000 4                  TRA     s:3759+1

      497     3753    5                       DB_RECS.LO_SZ(X) = 9999;

   3753  4 000556   000000 235000 xsym               LDA     X
         4 000557   000003 735000                    ALS     3
         4 000560   023417 236007                    LDQ     9999,DL
         4 000561   000312 470400 0                  LDP0    DB_RECS$
         4 000562   000002 756105                    STQ     2,AL,PR0

      498     3754    5                       DB_RECS.LO_DBKEY(X) = HIDBKY;

   3754  4 000563   000000 235000 xsym               LDA     X
         4 000564   000003 735000                    ALS     3
         4 000565   000307 236000 0                  LDQ     HIDBKY
         4 000566   000004 756105                    STQ     4,AL,PR0

      499     3755    5                       DB_RECS.TOT_SZ(X) = 0;

   3755  4 000567   000000 235000 xsym               LDA     X
         4 000570   000003 735000                    ALS     3
         4 000571   000001 450105                    STZ     1,AL,PR0

      500     3756    5                       DB_RECS.HI_SZ(X) = 0;

   3756  4 000572   000000 235000 xsym               LDA     X
         4 000573   000003 735000                    ALS     3
         4 000574   000003 450105                    STZ     3,AL,PR0

      501     3757    5                       DB_RECS.HI_DBKEY(X) = 0;

   3757  4 000575   000000 235000 xsym               LDA     X
         4 000576   000003 735000                    ALS     3
         4 000577   000005 450105                    STZ     5,AL,PR0

      502     3758    5                       DB_RECS.NO_OF_PAGES(X) = 0;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:78   
   3758  4 000600   000000 235000 xsym               LDA     X
         4 000601   000003 735000                    ALS     3
         4 000602   000006 450105                    STZ     6,AL,PR0

      503     3759    5                       END;

   3759  4 000603   000000 054000 xsym               AOS     X
         4 000604   000000 236000 xsym               LDQ     X
         4 000605   000000 116000 xsym               CMPQ    RCNT
         4 000606   000556 604400 4                  TMOZ    s:3753

      504     3760    4                   END;

      505     3761    3               PF2.TYP = 'AREA';

   3761  4 000607   040000 100400                    MLR     fill='040'O
         4 000610   000000 000004 3                  ADSC9   0                        cn=0,n=4
         4 000611   000216 200007 0                  ADSC9   PF2+18                   cn=1,n=7

      506     3762    3               CALC_REC = '0'B;

   3762  4 000612   000000 100400                    MLR     fill='000'O
         4 000613   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000614   000004 000030 0                  ADSC9   CALC_REC                 cn=0,n=24

      507     3763    3               NEED_SUMMARY = (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS > 1);

   3763  4 000615   400000 220003                    LDX0    -131072,DU
         4 000616   000026 236000 xsym               LDQ     ZI$DIR+22
         4 000617   400000 316007                    CANQ    -131072,DL
         4 000620   000622 601000 4                  TNZ     s:3763+5
         4 000621   000000 220003                    LDX0    0,DU
         4 000622   400000 221003                    LDX1    -131072,DU
         4 000623   000000 235000 xsym               LDA     NO_AREAS
         4 000624   000001 115007                    CMPA    1,DL
         4 000625   000627 605400 4                  TPNZ    s:3763+10
         4 000626   000000 221003                    LDX1    0,DU
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:79   
         4 000627   000000 636011                    EAQ     0,X1
         4 000630   002352 756000 0                  STQ     J+1
         4 000631   000000 636010                    EAQ     0,X0
         4 000632   002352 376000 0                  ANQ     J+1
         4 000633   000302 756000 0                  STQ     NEED_SUMMARY

      508     3764    3               END;

   3764  4 000634   000647 710000 4                  TRA     s:3771

      509     3765    2           ELSE
      510     3766    3           DO X = 0 TO RCNT;

   3766  4 000635   000000 450000 xsym               STZ     X
         4 000636   000644 710000 4                  TRA     s:3768+1

      511     3767    3               RECS.NO_OF_RECS(X) = 0;

   3767  4 000637   000000 235000 xsym               LDA     X
         4 000640   000003 735000                    ALS     3
         4 000641   000003 470400 0                  LDP0    RECS$
         4 000642   000000 450105                    STZ     0,AL,PR0

      512     3768    3               END;

   3768  4 000643   000000 054000 xsym               AOS     X
         4 000644   000000 236000 xsym               LDQ     X
         4 000645   000000 116000 xsym               CMPQ    RCNT
         4 000646   000637 604400 4                  TMOZ    s:3767

      513     3769    2           END;

      514     3770
      515     3771    2       IF (ZI$DIR.REPRT_PG = '1'B) | (ZI$DIR.REPRT_ALL = '1'B) THEN DO;

   3771  4 000647   400000 220003                    LDX0    -131072,DU
         4 000650   000125 236000 xsym               LDQ     ZI$DIR+85
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:80   
         4 000651   000200 316007                    CANQ    128,DL
         4 000652   000654 601000 4                  TNZ     s:3771+5
         4 000653   000000 220003                    LDX0    0,DU
         4 000654   400000 221003                    LDX1    -131072,DU
         4 000655   001000 316007                    CANQ    512,DL
         4 000656   000660 601000 4                  TNZ     s:3771+9
         4 000657   000000 221003                    LDX1    0,DU
         4 000660   000000 636011                    EAQ     0,X1
         4 000661   002352 756000 0                  STQ     J+1
         4 000662   000000 636010                    EAQ     0,X0
         4 000663   002352 276000 0                  ORQ     J+1
         4 000664   000756 600000 4                  TZE     s:3786

      516     3772    2           IF (NUM_AREAS_REPORTED = 1) & (ZI$DIR.AUTODUMP = '1'B) THEN

   3772  4 000665   400000 220003                    LDX0    -131072,DU
         4 000666   000650 235000 0                  LDA     NUM_AREAS_REPORTED
         4 000667   000001 115007                    CMPA    1,DL
         4 000670   000672 600000 4                  TZE     s:3772+5
         4 000671   000000 220003                    LDX0    0,DU
         4 000672   400000 221003                    LDX1    -131072,DU
         4 000673   000026 236000 xsym               LDQ     ZI$DIR+22
         4 000674   400000 316007                    CANQ    -131072,DL
         4 000675   000677 601000 4                  TNZ     s:3772+10
         4 000676   000000 221003                    LDX1    0,DU
         4 000677   000000 636011                    EAQ     0,X1
         4 000700   002352 756000 0                  STQ     J+1
         4 000701   000000 636010                    EAQ     0,X0
         4 000702   002352 376000 0                  ANQ     J+1
         4 000703   000731 600000 4                  TZE     s:3779

      517     3773    3           DO X = 0 TO 19;

   3773  4 000704   000000 450000 xsym               STZ     X

      518     3774    3               DB_PGS.SNUM(X) = 0;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:81   
   3774  4 000705   000000 236000 xsym               LDQ     X
         4 000706   000006 402007                    MPY     6,DL
         4 000707   000002 736000                    QLS     2
         4 000710   000006 100400                    MLR     fill='000'O
         4 000711   000000 000004 5                  ADSC9   0                        cn=0,n=4
         4 000712   001214 400004 0                  ADSC9   DB_PGS+3,Q               cn=2,n=4

      519     3775    3               DB_PGS.SPRCNT(X) = 0;

   3775  4 000713   000000 236000 xsym               LDQ     X
         4 000714   000006 402007                    MPY     6,DL
         4 000715   000002 736000                    QLS     2
         4 000716   000006 100400                    MLR     fill='000'O
         4 000717   000000 000004 5                  ADSC9   0                        cn=0,n=4
         4 000720   001215 400004 0                  ADSC9   DB_PGS+4,Q               cn=2,n=4

      520     3776    3               DB_PGS.DNUM(X) = 0;

   3776  4 000721   000000 236000 xsym               LDQ     X
         4 000722   000006 402007                    MPY     6,DL
         4 000723   001211 450006 0                  STZ     DB_PGS,QL

      521     3777    3               DB_PGS.DPRCNT(X) = 0;

   3777  4 000724   001212 450006 0                  STZ     DB_PGS+1,QL

      522     3778    3               END;

   3778  4 000725   000000 054000 xsym               AOS     X
         4 000726   000000 235000 xsym               LDA     X
         4 000727   000023 115007                    CMPA    19,DL
         4 000730   000705 604400 4                  TMOZ    s:3774

      523     3779    3           DO X = 0 TO 19;

   3779  4 000731   000000 450000 xsym               STZ     X

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:82   
      524     3780    3               PGS.SNUM(X) = 0;

   3780  4 000732   000000 236000 xsym               LDQ     X
         4 000733   000006 402007                    MPY     6,DL
         4 000734   000002 736000                    QLS     2
         4 000735   000006 100400                    MLR     fill='000'O
         4 000736   000000 000004 5                  ADSC9   0                        cn=0,n=4
         4 000737   001024 400004 0                  ADSC9   PGS+3,Q                  cn=2,n=4

      525     3781    3               PGS.SPRCNT(X) = 0;

   3781  4 000740   000000 236000 xsym               LDQ     X
         4 000741   000006 402007                    MPY     6,DL
         4 000742   000002 736000                    QLS     2
         4 000743   000006 100400                    MLR     fill='000'O
         4 000744   000000 000004 5                  ADSC9   0                        cn=0,n=4
         4 000745   001025 400004 0                  ADSC9   PGS+4,Q                  cn=2,n=4

      526     3782    3               PGS.DNUM(X) = 0;

   3782  4 000746   000000 236000 xsym               LDQ     X
         4 000747   000006 402007                    MPY     6,DL
         4 000750   001021 450006 0                  STZ     PGS,QL

      527     3783    3               PGS.DPRCNT(X) = 0;

   3783  4 000751   001022 450006 0                  STZ     PGS+1,QL

      528     3784    3               END;

   3784  4 000752   000000 054000 xsym               AOS     X
         4 000753   000000 235000 xsym               LDA     X
         4 000754   000023 115007                    CMPA    19,DL
         4 000755   000732 604400 4                  TMOZ    s:3780

      529     3785    2           END;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:83   
      530     3786    1       IF NUM_AREAS_REPORTED=1 THEN /* FIRST TIME THRU */

   3786  4 000756   000650 235000 0                  LDA     NUM_AREAS_REPORTED
         4 000757   000001 115007                    CMPA    1,DL
         4 000760   001003 601000 4                  TNZ     s:3797

      531     3787    2       DO;

      532     3788    2           IF RCNT=-1 THEN

   3788  4 000761   000000 236000 xsym               LDQ     RCNT
         4 000762   000013 116000 5                  CMPQ    11
         4 000763   000770 601000 4                  TNZ     s:3791

      533     3789    2               X=NO_RECS-1;

   3789  4 000764   000000 235000 xsym               LDA     NO_RECS
         4 000765   000001 135007                    SBLA    1,DL
         4 000766   000000 755000 xsym               STA     X
         4 000767   000771 710000 4                  TRA     s:3792

      534     3790    2           ELSE
      535     3791    2               X=RCNT; /* NUMBER OF RECORDS TO BE SEARCHED FOR */

   3791  4 000770   000000 756000 xsym               STQ     X

      536     3792    3           DO Y=0 TO X;

   3792  4 000771   000313 450000 0                  STZ     Y
         4 000772   001000 710000 4                  TRA     s:3794+1

      537     3793    3               DB_RECS.NO_OF_RECS(Y)=0; /* SET THIS OVER-ALL COUNT TO 0 */

   3793  4 000773   000313 235000 0                  LDA     Y
         4 000774   000003 735000                    ALS     3
         4 000775   000312 470400 0                  LDP0    DB_RECS$
         4 000776   000000 450105                    STZ     0,AL,PR0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:84   

      538     3794    3               END;

   3794  4 000777   000313 054000 0                  AOS     Y
         4 001000   000313 236000 0                  LDQ     Y
         4 001001   000000 116000 xsym               CMPQ    X
         4 001002   000773 604400 4                  TMOZ    s:3793

      539     3795    2           END;

      540     3796
      541     3797    1       CALL PAGE_RANGE(RB,RE,#BUFS,I_O_SIZE,HIGH_DATA_PG,LAST_PAGE);

   3797  4 001003   000017 630400 5                  EPPR0   15
         4 001004   000016 631400 5                  EPPR1   14
         4 001005   000000 701000 xent               TSX1    PAGE_RANGE
         4 001006   000000 011000                    NOP     0

      542     3798        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:85   
      543     3799        /*------------------------------------------------------------------------*/
      544     3800        /*    Process  the reading of the data base #BUFS pages at a time.        */
      545     3801        /*------------------------------------------------------------------------*/
      546     3802    2       DO WHILE(~LAST_PAGE);

   3802  4 001007   001101 710000 4                  TRA     s:3832

      547     3803
      548     3804    2           I_O_INDX = 0;

   3804  4 001010   000001 450000 0                  STZ     I_O_INDX

      549     3805    2    /**/   DCBSF = ZI$DIR.AREA_NM.DCB#;

   3805  4 001011   000244 220000 xsym               LDX0    ZI$DIR+164
         4 001012   000000 740000 xsym               STX0    DCBSF

      550     3806    2           BUFSF = VECTOR(I_O_BUF);

   3806  4 001013   000025 235000 5                  LDA     21
         4 001014   000000 236000 xsym               LDQ     I_O_BUF$
         4 001015   000000 755000 xsym               STA     BUFSF
         4 001016   000001 756000 xsym               STQ     BUFSF+1

      551     3807    2           BUFLNSF = 4096 * I_O_SIZE;

   3807  4 001017   000000 235000 xsym               LDA     I_O_SIZE
         4 001020   000014 735000                    ALS     12
         4 001021   000000 755000 xsym               STA     BUFLNSF

      552     3808    2           FULLSF = %YES#;

   3808  4 001022   400000 236003                    LDQ     -131072,DU
         4 001023   000000 756000 xsym               STQ     FULLSF

      553     3809    2           KEYSF = %YES#;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:86   
   3809  4 001024   000000 756000 xsym               STQ     KEYSF

      554     3810    2           KEYVSF.IDSKEY = RB;

   3810  4 001025   000000 100400                    MLR     fill='000'O
         4 001026   000000 000004 xsym               ADSC9   RB                       cn=0,n=4
         4 001027   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

      555     3811    2           ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;

   3811  4 001030   000027 236000 xsym               LDQ     ZI$DIR+23
         4 001031   000000 756000 xsym               STQ     ENCRP_SEEDSF

      556     3812    2           CALL SYS_FUNC_READ ALTRET(ALTRTN);

   3812  4 001032   000000 631400 5                  EPPR1   0
         4 001033   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 001034   006021 702000 4                  TSX2    ALTRTN

      557     3813
      558     3814    3           DO RB = RB TO RE;

   3814  4 001035   001072 710000 4                  TRA     s:3830+3

      559     3815    3               DATA$ = ADDR(I_O_BUF(I_O_INDX));

   3815  4 001036   000001 236000 0                  LDQ     I_O_INDX
         4 001037   000034 736000                    QLS     28
         4 001040   000000 036000 xsym               ADLQ    I_O_BUF$
         4 001041   000000 756000 xsym               STQ     DATA$

      560     3816    3               IF BREAK_FLAG > 0 THEN

   3816  4 001042   000000 235000 xsym               LDA     BREAK_FLAG
         4 001043   001064 604400 4                  TMOZ    s:3827

      561     3817    4               DO;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:87   

      562     3818    4                   CALL SYS_FUNC_CLOS;

   3818  4 001044   000000 631400 5                  EPPR1   0
         4 001045   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 001046   000000 011000                    NOP     0

      563     3819    4                   IF DESTROY_TBL=1 THEN

   3819  4 001047   000314 235000 0                  LDA     DESTROY_TBL
         4 001050   000001 115007                    CMPA    1,DL
         4 001051   001056 601000 4                  TNZ     s:3824

      564     3820    5                   DO;

      565     3821    5                       XREF_BUILT=%NO#;

   3821  4 001052   000000 450000 xsym               STZ     XREF_BUILT

      566     3822    5                       CALL FREE_DYN_MEM;

   3822  4 001053   000000 631400 5                  EPPR1   0
         4 001054   000000 701000 xent               TSX1    FREE_DYN_MEM
         4 001055   000000 011000                    NOP     0

      567     3823    5                       END;

      568     3824    4                   UNWIND TO RESTART;

   3824  4 001056   000000 100600                    MLR   ! fill='000'O
         4 001057   000000 000010 xsym               ADSC9   RESTART                  cn=0,n=8
         4 001060   002352 000010 0                  ADSC9   J+1                      cn=0,n=8
         4 001061   002352 237200 0                  LDAQ  ! J+1
         4 001062   000000 700200 xent               TSX0  ! X66_SUNWIND
         4 001063   000000 000200                    ZERO    0,128

      569     3825    4                   END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:88   
      570     3826
      571     3827    3               CALL PROCESS_PAGE;

   3827  4 001064   002153 701000 4                  TSX1    PROCESS_PAGE
         4 001065   000000 011000                    NOP     0

      572     3828
      573     3829    3               I_O_INDX = I_O_INDX + 1;

   3829  4 001066   000001 054000 0                  AOS     I_O_INDX

      574     3830    3               END;

   3830  4 001067   000000 235000 xsym               LDA     RB
         4 001070   000001 035007                    ADLA    1,DL
         4 001071   000000 755000 xsym               STA     RB
         4 001072   000000 236000 xsym               LDQ     RE
         4 001073   000000 116000 xsym               CMPQ    RB
         4 001074   001036 603000 4                  TRC     s:3815

      575     3831    2           CALL PAGE_RANGE(RB,RE,#BUFS,I_O_SIZE,HIGH_DATA_PG,LAST_PAGE);

   3831  4 001075   000017 630400 5                  EPPR0   15
         4 001076   000016 631400 5                  EPPR1   14
         4 001077   000000 701000 xent               TSX1    PAGE_RANGE
         4 001100   000000 011000                    NOP     0

      576     3832    2           END;

   3832  4 001101   000310 236000 0                  LDQ     LAST_PAGE
         4 001102   400000 376003                    ANQ     -131072,DU
         4 001103   400000 676003                    ERQ     -131072,DU
         4 001104   001010 601000 4                  TNZ     s:3804

      577     3833    1       CALL SYS_FUNC_CLOS; /* Close area (DCBSF does not change ) */

   3833  4 001105   000000 631400 5                  EPPR1   0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:89   
         4 001106   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 001107   000000 011000                    NOP     0

      578     3834    1       IF ZI$DIR.AUTODUMP AND (AREA_KEY_XREF.PERMTYPE(NUM_AREAS_REPORTED-1) = 1) THEN

   3834  4 001110   000026 236000 xsym               LDQ     ZI$DIR+22
         4 001111   400000 316007                    CANQ    -131072,DL
         4 001112   001140 600000 4                  TZE     s:3845
         4 001113   000650 236000 0                  LDQ     NUM_AREAS_REPORTED
         4 001114   000012 402007                    MPY     10,DL
         4 001115   000000 470400 xsym               LDP0    AREA_KEY$
         4 001116   077777 236106                    LDQ     -1,QL,PR0
         4 001117   777000 376007                    ANQ     -512,DL
         4 001120   001000 116007                    CMPQ    512,DL
         4 001121   001140 601000 4                  TNZ     s:3845

      579     3835    2       DO;

      580     3836        /*E* ERROR: ZIU-DBU#NOTREPRT-C
      581     3837           MESSAGE: Unable to report information on temporary area, %U1. */
      582     3838    2           ERRCODESF.ERR# = DBU#NOTREPRT;

   3838  4 001122   000000 236000 xsym               LDQ     ERRCODESF
         4 001123   000014 376000 5                  ANQ     12
         4 001124   220550 276007                    ORQ     74088,DL
         4 001125   000000 756000 xsym               STQ     ERRCODESF

      583     3839    2           MSGCODE = ERRCODE_RDEF;

   3839  4 001126   000000 756000 xsym               STQ     MSGCODE

      584     3840    2           ERR_INSERT.CNT(0) = ZI$DIR.AREA_NM.NAME.CNT;

   3840  4 001127   000234 236000 xsym               LDQ     ZI$DIR+156
         4 001130   000000 552040 xsym               STBQ    ERR_INSERT,'40'O

      585     3841    2           ERR_INSERT.TEXT(0) = ZI$DIR.AREA_NM.NAME.TEXT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:90   

   3841  4 001131   040000 100400                    MLR     fill='040'O
         4 001132   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         4 001133   000000 200036 xsym               ADSC9   ERR_INSERT               cn=1,n=30

      586     3842    2           CALL SYS_FUNC_ERRMSG;

   3842  4 001134   000000 631400 5                  EPPR1   0
         4 001135   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001136   000000 011000                    NOP     0

      587     3843    2           END;

   3843  4 001137   001161 710000 4                  TRA     s:3854

      588     3844    2       ELSE DO;

      589     3845    2           IF ZI$DIR.REPRT_ALL = '1'B THEN

   3845  4 001140   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001141   001000 316007                    CANQ    512,DL
         4 001142   001150 600000 4                  TZE     s:3850

      590     3846    3           DO;

      591     3847    3               CALL REPORT_RECORD;

   3847  4 001143   003146 701000 4                  TSX1    REPORT_RECORD
         4 001144   000000 011000                    NOP     0

      592     3848    3               CALL REPORT_PAGES;

   3848  4 001145   004702 701000 4                  TSX1    REPORT_PAGES
         4 001146   000000 011000                    NOP     0

      593     3849    3               END;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:91   
   3849  4 001147   001161 710000 4                  TRA     s:3854

      594     3850    2           ELSE IF ZI$DIR.REPRT_REC = '1'B THEN

   3850  4 001150   000400 316007                    CANQ    256,DL
         4 001151   001155 600000 4                  TZE     s:3852

      595     3851    2                   CALL REPORT_RECORD;

   3851  4 001152   003146 701000 4                  TSX1    REPORT_RECORD
         4 001153   000000 011000                    NOP     0
         4 001154   001161 710000 4                  TRA     s:3854

      596     3852    2               ELSE IF ZI$DIR.REPRT_PG = '1'B THEN CALL REPORT_PAGES;

   3852  4 001155   000200 316007                    CANQ    128,DL
         4 001156   001161 600000 4                  TZE     s:3854

   3852  4 001157   004702 701000 4                  TSX1    REPORT_PAGES
         4 001160   000000 011000                    NOP     0

      597     3853    2           END;

      598     3854    1       IF ZI$DIR.AUTODUMP AND NUM_AREAS_REPORTED<NO_AREAS THEN

   3854  4 001161   000026 236000 xsym               LDQ     ZI$DIR+22
         4 001162   400000 316007                    CANQ    -131072,DL
         4 001163   001213 600000 4                  TZE     s:3864
         4 001164   000650 236000 0                  LDQ     NUM_AREAS_REPORTED
         4 001165   001213 604000 4                  TMI     s:3864
         4 001166   000000 116000 xsym               CMPQ    NO_AREAS
         4 001167   001213 605000 4                  TPL     s:3864

      599     3855    2       DO; /* PREPARE FOR NEXT AREA */

      600     3856    2   CLOSE_AREA:
      601     3857    2           DCBSF = ZI$DIR.AREA_NM.DCB#;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:92   

   3857  4 001170   000244 220000 xsym  CLOSE_AREA   LDX0    ZI$DIR+164
         4 001171   000000 740000 xsym               STX0    DCBSF

      602     3858    2           CALL SYS_FUNC_CLOS;

   3858  4 001172   000000 631400 5                  EPPR1   0
         4 001173   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 001174   000000 011000                    NOP     0

      603     3859    2           CALL SYS_FUNC_RELDCB;

   3859  4 001175   000000 631400 5                  EPPR1   0
         4 001176   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         4 001177   000000 011000                    NOP     0

      604     3860    2           ZI$DIR.AREA_NM.NAME.TEXT=AREA_KEY_XREF.NAME(NUM_AREAS_REPORTED);

   3860  4 001200   000650 236000 0                  LDQ     NUM_AREAS_REPORTED
         4 001201   000050 402007                    MPY     40,DL
         4 001202   000000 470400 xsym               LDP0    AREA_KEY$
         4 001203   040000 100506                    MLR     fill='040'O
         4 001204   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         4 001205   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30

      605     3861    2           CALL GET_DCB(ZI$DIR.AREA_NM) ALTRET(ALTRTN);

   3861  4 001206   000027 630400 5                  EPPR0   23
         4 001207   000026 631400 5                  EPPR1   22
         4 001210   000000 701000 xent               TSX1    GET_DCB
         4 001211   006021 702000 4                  TSX2    ALTRTN

      606     3862    2           GOTO NEXT_AREA;

   3862  4 001212   000064 710000 4                  TRA     NEXT_AREA

      607     3863    2           END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:93   
      608     3864    1       IF NUM_AREAS_REPORTED>1 THEN /* PRINT SUMMARY */

   3864  4 001213   000650 235000 0                  LDA     NUM_AREAS_REPORTED
         4 001214   000002 115007                    CMPA    2,DL
         4 001215   001326 602000 4                  TNC     s:3901

      609     3865    1           IF ZI$DIR.REPRT_ALL = '1'B THEN

   3865  4 001216   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001217   001000 316007                    CANQ    512,DL
         4 001220   001260 600000 4                  TZE     s:3881

      610     3866    2           DO;

      611     3867    2               RECS$ = DB_RECS$;

   3867  4 001221   000312 236000 0                  LDQ     DB_RECS$
         4 001222   000003 756000 0                  STQ     RECS$

      612     3868    2               NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;

   3868  4 001223   000647 235000 0                  LDA     DB_NUM_PGS_REPORTED
         4 001224   000306 755000 0                  STA     NUM_PGS_REPORTED

      613     3869    2               AREA_TOT_RECS = DB_TOT_RECS;

   3869  4 001225   000646 235000 0                  LDA     DB_TOT_RECS
         4 001226   000252 755000 0                  STA     AREA_TOT_RECS

      614     3870    2               AREA_TOT_SZ = DB_TOT_SZ;

   3870  4 001227   000645 235000 0                  LDA     DB_TOT_SZ
         4 001230   000251 755000 0                  STA     AREA_TOT_SZ

      615     3871    2               OA = DB_OA;

   3871  4 001231   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:94   
         4 001232   000634 000014 0                  ADSC9   DB_OA                    cn=0,n=12
         4 001233   000245 000014 0                  ADSC9   OA                       cn=0,n=12

      616     3872    2               CALC_REC = DB_CALC_REC;

   3872  4 001234   000000 100400                    MLR     fill='000'O
         4 001235   000637 000030 0                  ADSC9   DB_CALC_REC              cn=0,n=24
         4 001236   000004 000030 0                  ADSC9   CALC_REC                 cn=0,n=24

      617     3873    2               PH0.AREA_NAME = 'ALL AREAS';

   3873  4 001237   040000 100400                    MLR     fill='040'O
         4 001240   000005 000011 3                  ADSC9   5                        cn=0,n=9
         4 001241   000022 000036 0                  ADSC9   PH0+8                    cn=0,n=30

      618     3874    2               PF2.TYP = 'ALL';

   3874  4 001242   040000 100400                    MLR     fill='040'O
         4 001243   000005 000003 3                  ADSC9   5                        cn=0,n=3
         4 001244   000216 200007 0                  ADSC9   PF2+18                   cn=1,n=7

      619     3875    2               NEED_SUMMARY = '0'B;

   3875  4 001245   000302 450000 0                  STZ     NEED_SUMMARY

      620     3876    2               CALL REPORT_RECORD;

   3876  4 001246   003146 701000 4                  TSX1    REPORT_RECORD
         4 001247   000000 011000                    NOP     0

      621     3877    2               NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;

   3877  4 001250   000647 235000 0                  LDA     DB_NUM_PGS_REPORTED
         4 001251   000306 755000 0                  STA     NUM_PGS_REPORTED

      622     3878    2               PGS = DB_PGS;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:95   
   3878  4 001252   000000 100400                    MLR     fill='000'O
         4 001253   001211 000736 0                  ADSC9   DB_PGS                   cn=0,n=478
         4 001254   001021 000736 0                  ADSC9   PGS                      cn=0,n=478

      623     3879    2               CALL REPORT_PAGES;

   3879  4 001255   004702 701000 4                  TSX1    REPORT_PAGES
         4 001256   000000 011000                    NOP     0

      624     3880    2               END;

   3880  4 001257   001326 710000 4                  TRA     s:3901

      625     3881    1           ELSE IF ZI$DIR.REPRT_REC = '1'B THEN

   3881  4 001260   000400 316007                    CANQ    256,DL
         4 001261   001312 600000 4                  TZE     s:3894

      626     3882    2               DO;

      627     3883    2                   RECS$ = DB_RECS$;

   3883  4 001262   000312 236000 0                  LDQ     DB_RECS$
         4 001263   000003 756000 0                  STQ     RECS$

      628     3884    2                   NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;

   3884  4 001264   000647 235000 0                  LDA     DB_NUM_PGS_REPORTED
         4 001265   000306 755000 0                  STA     NUM_PGS_REPORTED

      629     3885    2                   AREA_TOT_RECS = DB_TOT_RECS;

   3885  4 001266   000646 235000 0                  LDA     DB_TOT_RECS
         4 001267   000252 755000 0                  STA     AREA_TOT_RECS

      630     3886    2                   AREA_TOT_SZ = DB_TOT_SZ;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:96   
   3886  4 001270   000645 235000 0                  LDA     DB_TOT_SZ
         4 001271   000251 755000 0                  STA     AREA_TOT_SZ

      631     3887    2                   OA = DB_OA;

   3887  4 001272   000000 100400                    MLR     fill='000'O
         4 001273   000634 000014 0                  ADSC9   DB_OA                    cn=0,n=12
         4 001274   000245 000014 0                  ADSC9   OA                       cn=0,n=12

      632     3888    2                   CALC_REC = DB_CALC_REC;

   3888  4 001275   000000 100400                    MLR     fill='000'O
         4 001276   000637 000030 0                  ADSC9   DB_CALC_REC              cn=0,n=24
         4 001277   000004 000030 0                  ADSC9   CALC_REC                 cn=0,n=24

      633     3889    2                   PH0.AREA_NAME = 'ALL AREAS';

   3889  4 001300   040000 100400                    MLR     fill='040'O
         4 001301   000005 000011 3                  ADSC9   5                        cn=0,n=9
         4 001302   000022 000036 0                  ADSC9   PH0+8                    cn=0,n=30

      634     3890    2                   PF2.TYP = 'ALL';

   3890  4 001303   040000 100400                    MLR     fill='040'O
         4 001304   000005 000003 3                  ADSC9   5                        cn=0,n=3
         4 001305   000216 200007 0                  ADSC9   PF2+18                   cn=1,n=7

      635     3891    2                   NEED_SUMMARY = '0'B;

   3891  4 001306   000302 450000 0                  STZ     NEED_SUMMARY

      636     3892    2                   CALL REPORT_RECORD;

   3892  4 001307   003146 701000 4                  TSX1    REPORT_RECORD
         4 001310   000000 011000                    NOP     0

      637     3893    2                   END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:97   

   3893  4 001311   001326 710000 4                  TRA     s:3901

      638     3894    1               ELSE IF ZI$DIR.REPRT_PG = '1'B THEN

   3894  4 001312   000200 316007                    CANQ    128,DL
         4 001313   001326 600000 4                  TZE     s:3901

      639     3895    2                   DO;

      640     3896    2                       PH0.AREA_NAME = 'ALL AREAS';

   3896  4 001314   040000 100400                    MLR     fill='040'O
         4 001315   000005 000011 3                  ADSC9   5                        cn=0,n=9
         4 001316   000022 000036 0                  ADSC9   PH0+8                    cn=0,n=30

      641     3897    2                       NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED;

   3897  4 001317   000647 235000 0                  LDA     DB_NUM_PGS_REPORTED
         4 001320   000306 755000 0                  STA     NUM_PGS_REPORTED

      642     3898    2                       PGS = DB_PGS;

   3898  4 001321   000000 100400                    MLR     fill='000'O
         4 001322   001211 000736 0                  ADSC9   DB_PGS                   cn=0,n=478
         4 001323   001021 000736 0                  ADSC9   PGS                      cn=0,n=478

      643     3899    2                       CALL REPORT_PAGES;

   3899  4 001324   004702 701000 4                  TSX1    REPORT_PAGES
         4 001325   000000 011000                    NOP     0

      644     3900    2                       END;

      645     3901    1       IF (ZI$DIR.REPRT_ALL OR ZI$DIR.REPRT_PA) AND NUM_PA_RECS>=0 THEN

   3901  4 001326   000125 236000 xsym               LDQ     ZI$DIR+85
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:98   
         4 001327   001000 316007                    CANQ    512,DL
         4 001330   001334 601000 4                  TNZ     s:3901+6
         4 001331   000126 236000 xsym               LDQ     ZI$DIR+86
         4 001332   100000 316003                    CANQ    32768,DU
         4 001333   002022 600000 4                  TZE     s:3957
         4 001334   001406 235000 0                  LDA     NUM_PA_RECS
         4 001335   002022 604000 4                  TMI     s:3957

      646     3902    2       DO;

      647     3903    2           DCBSF=DCBNUM(M$LO);

   3903  4 001336   000000 236007 xsym               LDQ     M$LO,DL
         4 001337   000000 620006                    EAX0    0,QL
         4 001340   000000 740000 xsym               STX0    DCBSF

      648     3904    2           VFCSF=%YES#;

   3904  4 001341   400000 236003                    LDQ     -131072,DU
         4 001342   000000 756000 xsym               STQ     VFCSF

      649     3905    2           BUFLNSF=1;

   3905  4 001343   000001 235007                    LDA     1,DL
         4 001344   000000 755000 xsym               STA     BUFLNSF

      650     3906    2           BUFSF=VECTOR(PH0); /* JUST USE THE VFC CHAR */

   3906  4 001345   000030 237000 5                  LDAQ    24
         4 001346   000000 755000 xsym               STA     BUFSF
         4 001347   000001 756000 xsym               STQ     BUFSF+1

      651     3907    2           CALL SYS_FUNC_WRIT;

   3907  4 001350   000000 631400 5                  EPPR1   0
         4 001351   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 001352   000000 011000                    NOP     0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:99   

      652     3908    2           CALL WRIT(BLANK_LINE,1);

   3908  4 001353   000034 237000 5                  LDAQ    28
         4 001354   002276 757000 0                  STAQ    NUM_PGS+2
         4 001355   005301 701000 4                  TSX1    WRIT
         4 001356   000000 011000                    NOP     0

      653     3909    2           CALL WRIT(PAH1,LENGTHC(PAH1));

   3909  4 001357   000036 237000 5                  LDAQ    30
         4 001360   002276 757000 0                  STAQ    NUM_PGS+2
         4 001361   005301 701000 4                  TSX1    WRIT
         4 001362   000000 011000                    NOP     0

      654     3910    2           CALL WRIT(PAH2,LENGTHC(PAH2));

   3910  4 001363   000040 237000 5                  LDAQ    32
         4 001364   002276 757000 0                  STAQ    NUM_PGS+2
         4 001365   005301 701000 4                  TSX1    WRIT
         4 001366   000000 011000                    NOP     0

      655     3911    2           CALL WRIT(PAH3,LENGTHC(PAH3));

   3911  4 001367   000042 237000 5                  LDAQ    34
         4 001370   002276 757000 0                  STAQ    NUM_PGS+2
         4 001371   005301 701000 4                  TSX1    WRIT
         4 001372   000000 011000                    NOP     0

      656     3912    2           CALL WRIT(PAH4,LENGTHC(PAH4));

   3912  4 001373   000046 237000 5                  LDAQ    38
         4 001374   002276 757000 0                  STAQ    NUM_PGS+2
         4 001375   005301 701000 4                  TSX1    WRIT
         4 001376   000000 011000                    NOP     0

      657     3913    2           CALL WRIT(PAH5,LENGTHC(PAH5));
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:100  

   3913  4 001377   000050 237000 5                  LDAQ    40
         4 001400   002276 757000 0                  STAQ    NUM_PGS+2
         4 001401   005301 701000 4                  TSX1    WRIT
         4 001402   000000 011000                    NOP     0

      658     3914    2           CALL WRIT(BLANK_LINE,1);

   3914  4 001403   000034 237000 5                  LDAQ    28
         4 001404   002276 757000 0                  STAQ    NUM_PGS+2
         4 001405   005301 701000 4                  TSX1    WRIT
         4 001406   000000 011000                    NOP     0

      659     3915    2           IF ZI$DIR.AUTODUMP AND NO_AREAS>1 THEN

   3915  4 001407   000026 236000 xsym               LDQ     ZI$DIR+22
         4 001410   400000 316007                    CANQ    -131072,DL
         4 001411   001417 600000 4                  TZE     s:3917
         4 001412   000000 235000 xsym               LDA     NO_AREAS
         4 001413   000001 115007                    CMPA    1,DL
         4 001414   001417 604400 4                  TMOZ    s:3917

      660     3916    2               RECS$=DB_RECS$;

   3916  4 001415   000312 236000 0                  LDQ     DB_RECS$
         4 001416   000003 756000 0                  STQ     RECS$

      661     3917    3           DO X=0 TO NUM_PA_RECS;

   3917  4 001417   000000 450000 xsym               STZ     X
         4 001420   002007 710000 4                  TRA     s:3953+1

      662     3918    3               PTR_SIZE=LENGTHC(PAH6);

   3918  4 001421   000117 235007                    LDA     79,DL
         4 001422   000315 755000 0                  STA     PTR_SIZE

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:101  
      663     3919    3               ADDR(PAH6)->CHAR_V=' '; /* BLANK WHOLE LINE */

   3919  4 001423   000000 620005                    EAX0    0,AL
         4 001424   040040 100400                    MLR     fill='040'O
         4 001425   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 001426   000440 000010 0                  ADSC9   PAH6                     cn=0,n=*X0

      664     3920    3               Y=PA.RECSINDX(X); /* INTO RECS TABLE */

   3920  4 001427   000000 236000 xsym               LDQ     X
         4 001430   000005 402007                    MPY     5,DL
         4 001431   001407 236006 0                  LDQ     PA,QL
         4 001432   000022 772000                    QRL     18
         4 001433   000313 756000 0                  STQ     Y

      665     3921    3               MSTR_INDX=DB_RECS.MSTRINDX(Y); /* INTO MSTR TABL */

   3921  4 001434   000313 235000 0                  LDA     Y
         4 001435   000003 735000                    ALS     3
         4 001436   000312 470400 0                  LDP0    DB_RECS$
         4 001437   000007 236105                    LDQ     7,AL,PR0
         4 001440   000022 772000                    QRL     18
         4 001441   000000 756000 xsym               STQ     MSTR_INDX

      666     3922    3               PAH6.REC_NAME=SUBSTR(MSTR_REF.NAME(MSTR_INDX),8,20);

   3922  4 001442   000050 402007                    MPY     40,DL
         4 001443   000000 471400 xsym               LDP1    MSTR$
         4 001444   040000 100506                    MLR     fill='040'O
         4 001445   100003 400024                    ADSC9   3,Q,PR1                  cn=2,n=20
         4 001446   000440 000024 0                  ADSC9   PAH6                     cn=0,n=20

      667     3923    3               PTR_BIN=RECS.NO_OF_RECS(Y); /* SET TO NUMBER FOUND */

   3923  4 001447   000313 235000 0                  LDA     Y
         4 001450   000003 735000                    ALS     3
         4 001451   000003 473400 0                  LDP3    RECS$
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:102  
         4 001452   300000 235105                    LDA     0,AL,PR3
         4 001453   000320 755000 0                  STA     PTR_BIN

      668     3924    3               IF PTR_BIN=0 THEN

   3924  4 001454   001461 601000 4                  TNZ     s:3928

      669     3925    3                   PAH6.PA_FOUND=' -NONE-';

   3925  4 001455   040000 100400                    MLR     fill='040'O
         4 001456   000010 000006 3                  ADSC9   8                        cn=0,n=6
         4 001457   000446 200006 0                  ADSC9   PAH6+6                   cn=1,n=6
         4 001460   002002 710000 4                  TRA     s:3952

      670     3926    3               ELSE
      671     3927    4               DO;

      672     3928    4                   CALL BINCHAR_SUP(PAH6.OWNER_FOUND,PA.OWNER_FOUND(X),LENGTHC(PAH6.
              3928                            OWNER_FOUND));

   3928  4 001461   000010 236000 5                  LDQ     8
         4 001462   002303 756000 0                  STQ     @NUMFLD+1
         4 001463   000000 236000 xsym               LDQ     X
         4 001464   000005 402003                    MPY     5,DU
         4 001465   000045 036000 5                  ADLQ    37
         4 001466   002302 756000 0                  STQ     @CHRFLD+1
         4 001467   000052 236000 5                  LDQ     42
         4 001470   002301 756000 0                  STQ     @LEN+2
         4 001471   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001472   000000 011000                    NOP     0

      673     3929    4                   CALL BINCHAR_SUP(PAH6.PA_FOUND,PTR_BIN,LENGTHC(PAH6.PA_FOUND));

   3929  4 001473   000054 237000 5                  LDAQ    44
         4 001474   002302 757000 0                  STAQ    @CHRFLD+1
         4 001475   000056 236000 5                  LDQ     46
         4 001476   002301 756000 0                  STQ     @LEN+2
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:103  
         4 001477   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001500   000000 011000                    NOP     0

      674     3930    4                   CALL BINCHAR_SUP(PAH6.MEM_FOUND,PA.MEM_FOUND(X),LENGTHC(PAH6.
              3930                            MEM_FOUND));

   3930  4 001501   000060 236000 5                  LDQ     48
         4 001502   002303 756000 0                  STQ     @NUMFLD+1
         4 001503   000000 236000 xsym               LDQ     X
         4 001504   000005 402003                    MPY     5,DU
         4 001505   000061 036000 5                  ADLQ    49
         4 001506   002302 756000 0                  STQ     @CHRFLD+1
         4 001507   000062 236000 5                  LDQ     50
         4 001510   002301 756000 0                  STQ     @LEN+2
         4 001511   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001512   000000 011000                    NOP     0

      675     3931    4                   PAH6.PERCENT_MARK=' %';

   3931  4 001513   000012 236000 3                  LDQ     10
         4 001514   000011 772000                    QRL     9
         4 001515   000463 552030 0                  STBQ    PAH6+19,'30'O

      676     3932    4                   PAH6.DOT1='.';

   3932  4 001516   056000 236007                    LDQ     23552,DL
         4 001517   000454 552010 0                  STBQ    PAH6+12,'10'O

      677     3933    4                   PAH6.DOT2='.';

   3933  4 001520   000460 552010 0                  STBQ    PAH6+16,'10'O

      678     3934    4                   PAH6.LEFT_PARAN='(';

   3934  4 001521   050000 236003                    LDQ     20480,DU
         4 001522   000455 552040 0                  STBQ    PAH6+13,'40'O

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:104  
      679     3935    4                   PAH6.RIGHT_PARAN=')';

   3935  4 001523   000051 236003                    LDQ     41,DU
         4 001524   000456 552020 0                  STBQ    PAH6+14,'20'O

      680     3936    4                   INDX=PA.TOT_PTRS(X)/PTR_BIN;

   3936  4 001525   000000 236000 xsym               LDQ     X
         4 001526   000005 402007                    MPY     5,DL
         4 001527   001412 236006 0                  LDQ     PA+3,QL
         4 001530   001546 605000 4                  TPL     s:3936+17
         4 001531   000320 235000 0                  LDA     PTR_BIN
         4 001532   001542 604000 4                  TMI     s:3936+13
         4 001533   000001 115007                    CMPA    1,DL
         4 001534   001553 600000 4                  TZE     s:3936+22
         4 001535   000000 235003                    LDA     0,DU
         4 001536   000001 737000                    LLS     1
         4 001537   000320 507000 0                  DVF     PTR_BIN
         4 001540   000044 733000                    LRS     36
         4 001541   001553 710000 4                  TRA     s:3936+22
         4 001542   000320 116000 0                  CMPQ    PTR_BIN
         4 001543   001550 602000 4                  TNC     s:3936+19
         4 001544   000001 236007                    LDQ     1,DL
         4 001545   001553 710000 4                  TRA     s:3936+22
         4 001546   000320 235000 0                  LDA     PTR_BIN
         4 001547   001552 605000 4                  TPL     s:3936+21
         4 001550   000000 236003                    LDQ     0,DU
         4 001551   001553 710000 4                  TRA     s:3936+22
         4 001552   000320 506000 0                  DIV     PTR_BIN
         4 001553   000304 756000 0                  STQ     INDX

      681     3937    4                   CALL BINCHAR_SUP(PAH6.NUMBER_PTR,INDX,LENGTHC(PAH6.NUMBER_PTR));

   3937  4 001554   000064 237000 5                  LDAQ    52
         4 001555   002302 757000 0                  STAQ    @CHRFLD+1
         4 001556   000066 236000 5                  LDQ     54
         4 001557   002301 756000 0                  STQ     @LEN+2
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:105  
         4 001560   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001561   000000 011000                    NOP     0

      682     3938    4                   INDX=PA.TOT_PTRS(X)-INDX*PTR_BIN; /* REMAINDER */

   3938  4 001562   000304 236000 0                  LDQ     INDX
         4 001563   000320 402000 0                  MPY     PTR_BIN
         4 001564   002352 756000 0                  STQ     J+1
         4 001565   000000 236000 xsym               LDQ     X
         4 001566   000005 402007                    MPY     5,DL
         4 001567   001412 236006 0                  LDQ     PA+3,QL
         4 001570   002352 136000 0                  SBLQ    J+1
         4 001571   000304 756000 0                  STQ     INDX

      683     3939    4                   INDX=((INDX*100)/PTR_BIN)/10;

   3939  4 001572   000144 402007                    MPY     100,DL
         4 001573   000320 235000 0                  LDA     PTR_BIN
         4 001574   001577 605000 4                  TPL     s:3939+5
         4 001575   000000 236003                    LDQ     0,DU
         4 001576   001600 710000 4                  TRA     s:3939+6
         4 001577   000320 506000 0                  DIV     PTR_BIN
         4 001600   000012 506007                    DIV     10,DL
         4 001601   000304 756000 0                  STQ     INDX

      684     3940    4                   CALL BINCHAR_SUP(PAH6.NUMBER_PTR2,INDX,LENGTHC(PAH6.NUMBER_PTR2));

   3940  4 001602   000070 237000 5                  LDAQ    56
         4 001603   002302 757000 0                  STAQ    @CHRFLD+1
         4 001604   000072 236000 5                  LDQ     58
         4 001605   002301 756000 0                  STQ     @LEN+2
         4 001606   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001607   000000 011000                    NOP     0

      685     3941    4                   INDX=PA.SPACE_AVAIL(X)/PTR_BIN;

   3941  4 001610   000000 236000 xsym               LDQ     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:106  
         4 001611   000005 402007                    MPY     5,DL
         4 001612   001413 236006 0                  LDQ     PA+4,QL
         4 001613   001631 605000 4                  TPL     s:3941+17
         4 001614   000320 235000 0                  LDA     PTR_BIN
         4 001615   001625 604000 4                  TMI     s:3941+13
         4 001616   000001 115007                    CMPA    1,DL
         4 001617   001636 600000 4                  TZE     s:3941+22
         4 001620   000000 235003                    LDA     0,DU
         4 001621   000001 737000                    LLS     1
         4 001622   000320 507000 0                  DVF     PTR_BIN
         4 001623   000044 733000                    LRS     36
         4 001624   001636 710000 4                  TRA     s:3941+22
         4 001625   000320 116000 0                  CMPQ    PTR_BIN
         4 001626   001633 602000 4                  TNC     s:3941+19
         4 001627   000001 236007                    LDQ     1,DL
         4 001630   001636 710000 4                  TRA     s:3941+22
         4 001631   000320 235000 0                  LDA     PTR_BIN
         4 001632   001635 605000 4                  TPL     s:3941+21
         4 001633   000000 236003                    LDQ     0,DU
         4 001634   001636 710000 4                  TRA     s:3941+22
         4 001635   000320 506000 0                  DIV     PTR_BIN
         4 001636   000304 756000 0                  STQ     INDX

      686     3942    4                   CALL BINCHAR_SUP(PAH6.SPACE_AVAIL,INDX,LENGTHC(PAH6.SPACE_AVAIL));

   3942  4 001637   000074 237000 5                  LDAQ    60
         4 001640   002302 757000 0                  STAQ    @CHRFLD+1
         4 001641   000076 236000 5                  LDQ     62
         4 001642   002301 756000 0                  STQ     @LEN+2
         4 001643   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001644   000000 011000                    NOP     0

      687     3943    4                   INDX=PA.SPACE_AVAIL(X)-INDX*PTR_BIN;

   3943  4 001645   000304 236000 0                  LDQ     INDX
         4 001646   000320 402000 0                  MPY     PTR_BIN
         4 001647   002352 756000 0                  STQ     J+1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:107  
         4 001650   000000 236000 xsym               LDQ     X
         4 001651   000005 402007                    MPY     5,DL
         4 001652   001413 236006 0                  LDQ     PA+4,QL
         4 001653   002352 136000 0                  SBLQ    J+1
         4 001654   000304 756000 0                  STQ     INDX

      688     3944    4                   INDX=((INDX*100)/PTR_BIN)/10;

   3944  4 001655   000144 402007                    MPY     100,DL
         4 001656   000320 235000 0                  LDA     PTR_BIN
         4 001657   001662 605000 4                  TPL     s:3944+5
         4 001660   000000 236003                    LDQ     0,DU
         4 001661   001663 710000 4                  TRA     s:3944+6
         4 001662   000320 506000 0                  DIV     PTR_BIN
         4 001663   000012 506007                    DIV     10,DL
         4 001664   000304 756000 0                  STQ     INDX

      689     3945    4                  CALL BINCHAR_SUP(PAH6.SPACE_AVAIL2,INDX,LENGTHC(PAH6.SPACE_AVAIL2));

   3945  4 001665   000070 237000 5                  LDAQ    56
         4 001666   002302 757000 0                  STAQ    @CHRFLD+1
         4 001667   000077 236000 5                  LDQ     63
         4 001670   002301 756000 0                  STQ     @LEN+2
         4 001671   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001672   000000 011000                    NOP     0

      690     3946    4                   PTR_SIZE=PA.REC_SIZE(X)-MSTR_REF.PAOFF(MSTR_INDX);

   3946  4 001673   000000 236000 xsym               LDQ     MSTR_INDX
         4 001674   000012 402007                    MPY     10,DL
         4 001675   000000 470400 xsym               LDP0    MSTR$
         4 001676   000011 236106                    LDQ     9,QL,PR0
         4 001677   000033 772000                    QRL     27
         4 001700   002352 756000 0                  STQ     J+1
         4 001701   000000 236000 xsym               LDQ     X
         4 001702   000005 402007                    MPY     5,DL
         4 001703   001407 236006 0                  LDQ     PA,QL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:108  
         4 001704   777777 376007                    ANQ     -1,DL
         4 001705   002352 136000 0                  SBLQ    J+1
         4 001706   000315 756000 0                  STQ     PTR_SIZE

      691     3947    4                   INDX=PTR_SIZE/MSTR_REF.PAENT(MSTR_INDX); /* # ENTRIES RESed */

   3947  4 001707   000000 236000 xsym               LDQ     MSTR_INDX
         4 001710   000012 402007                    MPY     10,DL
         4 001711   000011 236106                    LDQ     9,QL,PR0
         4 001712   000100 376000 5                  ANQ     64
         4 001713   002352 756000 0                  STQ     J+1
         4 001714   000315 236000 0                  LDQ     PTR_SIZE
         4 001715   001726 605000 4                  TPL     s:3947+15
         4 001716   002352 235000 0                  LDA     J+1
         4 001717   000001 405007                    CMG     1,DL
         4 001720   001727 600000 4                  TZE     s:3947+16
         4 001721   000000 235003                    LDA     0,DU
         4 001722   000001 737000                    LLS     1
         4 001723   002352 507000 0                  DVF     J+1
         4 001724   000044 733000                    LRS     36
         4 001725   001727 710000 4                  TRA     s:3947+16
         4 001726   002352 506000 0                  DIV     J+1
         4 001727   000304 756000 0                  STQ     INDX

      692     3948    4                   CALL BINCHAR_SUP(PAH6.ENT_RES,INDX,LENGTHC(PAH6.ENT_RES));

   3948  4 001730   000102 237000 5                  LDAQ    66
         4 001731   002302 757000 0                  STAQ    @CHRFLD+1
         4 001732   000104 236000 5                  LDQ     68
         4 001733   002301 756000 0                  STQ     @LEN+2
         4 001734   005360 701000 4                  TSX1    BINCHAR_SUP
         4 001735   000000 011000                    NOP     0

      693     3949    4                   INDX=100-(100*PA.SPACE_AVAIL(X))/(PTR_SIZE*PTR_BIN);

   3949  4 001736   000315 236000 0                  LDQ     PTR_SIZE
         4 001737   000320 402000 0                  MPY     PTR_BIN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:109  
         4 001740   002352 756000 0                  STQ     J+1
         4 001741   000000 236000 xsym               LDQ     X
         4 001742   000005 402007                    MPY     5,DL
         4 001743   001413 236006 0                  LDQ     PA+4,QL
         4 001744   000144 402007                    MPY     100,DL
         4 001745   000000 116003                    CMPQ    0,DU
         4 001746   001764 605000 4                  TPL     s:3949+22
         4 001747   002352 235000 0                  LDA     J+1
         4 001750   001760 604000 4                  TMI     s:3949+18
         4 001751   000001 115007                    CMPA    1,DL
         4 001752   001771 600000 4                  TZE     s:3949+27
         4 001753   000000 235003                    LDA     0,DU
         4 001754   000001 737000                    LLS     1
         4 001755   002352 507000 0                  DVF     J+1
         4 001756   000044 733000                    LRS     36
         4 001757   001771 710000 4                  TRA     s:3949+27
         4 001760   002352 116000 0                  CMPQ    J+1
         4 001761   001766 602000 4                  TNC     s:3949+24
         4 001762   000001 236007                    LDQ     1,DL
         4 001763   001771 710000 4                  TRA     s:3949+27
         4 001764   002352 235000 0                  LDA     J+1
         4 001765   001770 605000 4                  TPL     s:3949+26
         4 001766   000000 236003                    LDQ     0,DU
         4 001767   001771 710000 4                  TRA     s:3949+27
         4 001770   002352 506000 0                  DIV     J+1
         4 001771   000013 676000 5                  ERQ     11
         4 001772   000145 036007                    ADLQ    101,DL
         4 001773   000304 756000 0                  STQ     INDX

      694     3950    4                  CALL BINCHAR_SUP(PAH6.PERCENT_SPACE,INDX,LENGTHC(PAH6.PERCENT_SPACE)
              3950                            );

   3950  4 001774   000064 237000 5                  LDAQ    52
         4 001775   002302 757000 0                  STAQ    @CHRFLD+1
         4 001776   000105 236000 5                  LDQ     69
         4 001777   002301 756000 0                  STQ     @LEN+2
         4 002000   005360 701000 4                  TSX1    BINCHAR_SUP
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:110  
         4 002001   000000 011000                    NOP     0

      695     3951    4                   END;

      696     3952    3               CALL WRIT(PAH6,LENGTHC(PAH6));

   3952  4 002002   000110 237000 5                  LDAQ    72
         4 002003   002276 757000 0                  STAQ    NUM_PGS+2
         4 002004   005301 701000 4                  TSX1    WRIT
         4 002005   000000 011000                    NOP     0

      697     3953    3               END;

   3953  4 002006   000000 054000 xsym               AOS     X
         4 002007   000000 236000 xsym               LDQ     X
         4 002010   001406 116000 0                  CMPQ    NUM_PA_RECS
         4 002011   001421 604400 4                  TMOZ    s:3918

      698     3954    2           CALL WRIT(BLANK_LINE,1);

   3954  4 002012   000034 237000 5                  LDAQ    28
         4 002013   002276 757000 0                  STAQ    NUM_PGS+2
         4 002014   005301 701000 4                  TSX1    WRIT
         4 002015   000000 011000                    NOP     0

      699     3955    2           CALL WRIT(BLANK_LINE,1);

   3955  4 002016   000034 237000 5                  LDAQ    28
         4 002017   002276 757000 0                  STAQ    NUM_PGS+2
         4 002020   005301 701000 4                  TSX1    WRIT
         4 002021   000000 011000                    NOP     0

      700     3956    2           END;

      701     3957    1       ZI$DIR.AUTODUMP='0'B;

   3957  4 002022   000107 236000 5                  LDQ     71
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:111  
         4 002023   000026 356000 xsym               ANSQ    ZI$DIR+22

      702     3958    1       IF DESTROY_TBL=1 THEN

   3958  4 002024   000314 235000 0                  LDA     DESTROY_TBL
         4 002025   000001 115007                    CMPA    1,DL
         4 002026   002033 601000 4                  TNZ     s:3963

      703     3959    2       DO;

      704     3960    2           CALL FREE_DYN_MEM;

   3960  4 002027   000000 631400 5                  EPPR1   0
         4 002030   000000 701000 xent               TSX1    FREE_DYN_MEM
         4 002031   000000 011000                    NOP     0

      705     3961    2           XREF_BUILT='0'B;

   3961  4 002032   000000 450000 xsym               STZ     XREF_BUILT

      706     3962    2           END;

      707     3963    1       CALL FREE_TBL(,REPTBL#);

   3963  4 002033   000010 236000 5                  LDQ     8
         4 002034   000003 235000 5                  LDA     3
         4 002035   002352 757000 0                  STAQ    J+1
         4 002036   002352 630400 0                  EPPR0   J+1
         4 002037   000002 631400 5                  EPPR1   2
         4 002040   000000 701000 xent               TSX1    FREE_TBL
         4 002041   000000 011000                    NOP     0

      708     3964    1       RETURN;

   3964  4 002042   000000 221200 0                  LDX1  ! 0
         4 002043   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:112  
      709     3965        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:113  
      710     3966        /*--------------------------------------------------------------*/
      711     3967        /*         GET INVENTORY  AND  FILE  SZ  ATTRIBUTES           */
      712     3968        /*--------------------------------------------------------------*/
      713     3969    1   GET_ATBLK: PROC(HI_PGE) ALTRET;

   3969  4 002044   002107 741200 0     GET_ATBLK    STX1  ! PA+320

      714     3970    2   DCL HI_PGE SBIN;
      715     3971        /*
      716     3972           Evaluate high data page and number of inventory pages according
      717     3973           to attribute block information.
      718     3974        */
      719     3975
      720     3976    2       IF DCBADDR(DCBSF)->F$DCB.ORG# ~= %IDS# THEN

   3976  4 002045   000112 470400 5                  LDP0    74
         4 002046   000000 471500                    LDP1    0,,PR0
         4 002047   000000 220000 xsym               LDX0    DCBSF
         4 002050   100000 473510                    LDP3    0,X0,PR1
         4 002051   300032 236100                    LDQ     26,,PR3
         4 002052   777000 376003                    ANQ     -512,DU
         4 002053   007000 116003                    CMPQ    3584,DU
         4 002054   002074 600000 4                  TZE     s:3988

      721     3977    3       DO;

      722     3978         /*E* ERROR: ZIU-DBU#CHKIDSREP-C
      723     3979                 MESSAGE: %FN is not an integrated IDS file. Directive aborted. */
      724     3980    3           ERRCODESF.ERR# = DBU#CHKIDSREP;

   3980  4 002055   000000 236000 xsym               LDQ     ERRCODESF
         4 002056   000014 376000 5                  ANQ     12
         4 002057   216760 276007                    ORQ     73200,DL
         4 002060   000000 756000 xsym               STQ     ERRCODESF

      725     3981    3           MSGCODE = ERRCODE_RDEF;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:114  
   3981  4 002061   000000 756000 xsym               STQ     MSGCODE

      726     3982    3           ERRFLGSF = 4;

   3982  4 002062   004000 236003                    LDQ     2048,DU
         4 002063   000000 756000 xsym               STQ     ERRFLGSF

      727     3983    3           CALL SYS_FUNC_ERRMSG;

   3983  4 002064   000000 631400 5                  EPPR1   0
         4 002065   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002066   000000 011000                    NOP     0

      728     3984    3           CALL SYS_FUNC_CLOS;

   3984  4 002067   000000 631400 5                  EPPR1   0
         4 002070   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 002071   000000 011000                    NOP     0

      729     3985    3           ALTRETURN;

   3985  4 002072   002107 221200 0                  LDX1  ! PA+320
         4 002073   000000 702211                    TSX2  ! 0,X1

      730     3986    3           END;
      731     3987
      732     3988    2   /**/ DCBSF = ZI$DIR.AREA_NM.DCB#;

   3988  4 002074   000244 222000 xsym               LDX2    ZI$DIR+164
         4 002075   000000 742000 xsym               STX2    DCBSF

      733     3989    2   /**/ BUFSF = VECTOR(I_O_BUF(0));

   3989  4 002076   000025 235000 5                  LDA     21
         4 002077   000000 236000 xsym               LDQ     I_O_BUF$
         4 002100   000000 755000 xsym               STA     BUFSF
         4 002101   000001 756000 xsym               STQ     BUFSF+1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:115  

      734     3990    2   /**/ BUFLNSF = 4096;

   3990  4 002102   010000 235007                    LDA     4096,DL
         4 002103   000000 755000 xsym               STA     BUFLNSF

      735     3991    2   /**/ FULLSF = %YES#;

   3991  4 002104   400000 236003                    LDQ     -131072,DU
         4 002105   000000 756000 xsym               STQ     FULLSF

      736     3992    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;

   3992  4 002106   000027 236000 xsym               LDQ     ZI$DIR+23
         4 002107   000000 756000 xsym               STQ     ENCRP_SEEDSF

      737     3993    2   /**/ KEYSF = %YES#;

   3993  4 002110   400000 236003                    LDQ     -131072,DU
         4 002111   000000 756000 xsym               STQ     KEYSF

      738     3994    2   /**/ KEYVSF.IDSKEY = 0;

   3994  4 002112   000000 100400                    MLR     fill='000'O
         4 002113   000000 000004 5                  ADSC9   0                        cn=0,n=4
         4 002114   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

      739     3995    2       CALL SYS_FUNC_READ ALTRET(ALT_ATBLK);

   3995  4 002115   000000 631400 5                  EPPR1   0
         4 002116   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 002117   002151 702000 4                  TSX2    ALT_ATBLK

      740     3996    2       ATBLK$ = ADDR(I_O_BUF(0));

   3996  4 002120   000000 236000 xsym               LDQ     I_O_BUF$
         4 002121   000000 756000 xsym               STQ     ATBLK$
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:116  

      741     3997    2       IF ATBLK_PG.FIR_INV_PGNO = 0 THEN

   3997  4 002122   000000 470400 xsym               LDP0    ATBLK$
         4 002123   000014 235100                    LDA     12,,PR0
         4 002124   002131 601000 4                  TNZ     s:4002

      742     3998    3       DO;

      743     3999    3           HI_PGE = ATBLK_PG.NUM_DBPG;

   3999  4 002125   000005 235100                    LDA     5,,PR0
         4 002126   002110 471400 0                  LDP1    @HI_PGE
         4 002127   100000 755100                    STA     0,,PR1

      744     4000    3           END;

   4000  4 002130   002141 710000 4                  TRA     s:4005

      745     4001    3       ELSE DO;

      746     4002    3           HI_PGE = ATBLK_PG.NUM_DBPG - ((ATBLK_PG.NUM_DBPG -

   4002  4 002131   000005 236100                    LDQ     5,,PR0
         4 002132   000014 136100                    SBLQ    12,,PR0
         4 002133   002352 756000 0                  STQ     J+1
         4 002134   000005 236100                    LDQ     5,,PR0
         4 002135   002352 136000 0                  SBLQ    J+1
         4 002136   000001 136007                    SBLQ    1,DL
         4 002137   002110 471400 0                  LDP1    @HI_PGE
         4 002140   100000 756100                    STQ     0,,PR1

      747     4003    3              ATBLK_PG.FIR_INV_PGNO)+1);
      748     4004    3           END;

      749     4005    2       LOW_DBK = ATBLK_PG.LOW_DBK;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:117  
   4005  4 002141   000000 470400 xsym               LDP0    ATBLK$
         4 002142   000015 235100                    LDA     13,,PR0
         4 002143   000000 755000 xsym               STA     LOW_DBK

      750     4006    2       LPP = ATBLK_PG.LINE_INFO.LPP;

   4006  4 002144   000012 236100                    LDQ     10,,PR0
         4 002145   777777 376007                    ANQ     -1,DL
         4 002146   000000 756000 xsym               STQ     LPP

      751     4007    2       RETURN;

   4007  4 002147   002107 221200 0                  LDX1  ! PA+320
         4 002150   000001 702211                    TSX2  ! 1,X1

      752     4008        /**/
      753     4009    2   ALT_ATBLK:
      754     4010    2       ALTRETURN;

   4010  4 002151   002107 221200 0     ALT_ATBLK    LDX1  ! PA+320
         4 002152   000000 702211                    TSX2  ! 0,X1

      755     4011    2   END GET_ATBLK;
      756     4012        %EJECT;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:118  
      757     4013
      758     4014        /*--------------------------------------------------------------------------*/
      759     4015        /*    Find location of each record in the page and accumulate statistics.   */
      760     4016        /*--------------------------------------------------------------------------*/
      761     4017    1   PROCESS_PAGE: PROC;

   4017  4 002153   002111 741200 0     PROCESS_PAGE STX1  ! @HI_PGE+1

      762     4018
      763     4019    2   DCL REC_TABLE (0:4000) BIT(1) STATIC UNAL;
      764     4020    2       REC_TABLE = '0'B;

   4020  4 002154   003000 060400                    CSL     bolr='003'O
         4 002155   000000 000001 5                  BDSC    0                        by=0,bit=0,n=1
         4 002156   002112 007641 0                  BDSC    REC_TABLE                by=0,bit=0,n=4001

      765     4021    2       PG_TOT_SZ = 0;

   4021  4 002157   001405 450000 0                  STZ     PG_TOT_SZ

      766     4022    2       NUM_DBKEYS_USED = 0;

   4022  4 002160   001404 450000 0                  STZ     NUM_DBKEYS_USED

      767     4023    2       NUM_PGS_REPORTED = NUM_PGS_REPORTED + 1;

   4023  4 002161   000306 235000 0                  LDA     NUM_PGS_REPORTED
         4 002162   000001 035007                    ADLA    1,DL
         4 002163   000306 755000 0                  STA     NUM_PGS_REPORTED

      768     4024    2       DB_NUM_PGS_REPORTED = DB_NUM_PGS_REPORTED + 1;

   4024  4 002164   000647 236000 0                  LDQ     DB_NUM_PGS_REPORTED
         4 002165   000001 036007                    ADLQ    1,DL
         4 002166   000647 756000 0                  STQ     DB_NUM_PGS_REPORTED

      769     4025    2       OA_SZ = ((DATA_PG.OFF_LN.SEC + 1) * 2);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:119  

   4025  4 002167   000000 470400 xsym               LDP0    DATA$
         4 002170   000005 236100                    LDQ     5,,PR0
         4 002171   000001 736000                    QLS     1
         4 002172   000113 376000 5                  ANQ     75
         4 002173   000002 036007                    ADLQ    2,DL
         4 002174   000250 756000 0                  STQ     OA_SZ

      770     4026    2       IF OA_SZ < OA.LO_SZ

   4026  4 002175   000245 116000 0                  CMPQ    OA
         4 002176   002200 603000 4                  TRC     s:4028

      771     4027    2       THEN OA.LO_SZ = OA_SZ;

   4027  4 002177   000245 756000 0                  STQ     OA

      772     4028    2       IF OA_SZ > OA.HI_SZ

   4028  4 002200   000246 116000 0                  CMPQ    OA+1
         4 002201   002204 602000 4                  TNC     s:4030
         4 002202   002204 600000 4                  TZE     s:4030

      773     4029    2       THEN OA.HI_SZ = OA_SZ;

   4029  4 002203   000246 756000 0                  STQ     OA+1

      774     4030    2       OA.TOT_SZ = OA.TOT_SZ + OA_SZ;

   4030  4 002204   000247 036000 0                  ADLQ    OA+2
         4 002205   000247 756000 0                  STQ     OA+2

      775     4031    3       DO I = 0 TO DATA_PG.OFF_LN.SEC;

   4031  4 002206   000000 450000 xsym               STZ     I
         4 002207   002737 710000 4                  TRA     s:4133+1

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:120  
      776     4032    4           IF DATA_PG.ACT_DATA_18(OFFSET# I) > 0 THEN DO;

   4032  4 002210   000000 335000 xsym               LCA     I
         4 002211   000001 735000                    ALS     1
         4 002212   000000 470400 xsym               LDP0    DATA$
         4 002213   000000 100505                    MLR     fill='000'O
         4 002214   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 002215   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 002216   002352 236000 0                  LDQ     J+1
         4 002217   000022 732000                    QRS     18
         4 002220   000000 116003                    CMPQ    0,DU
         4 002221   002736 604400 4                  TMOZ    s:4133

      777     4033    4               REC$ = PINCRC(DATA$, 12 + DATA_PG.ACT_DATA_18(OFFSET# I));

   4033  4 002222   000000 100505                    MLR     fill='000'O
         4 002223   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 002224   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 002225   002352 236000 0                  LDQ     J+1
         4 002226   000022 732000                    QRS     18
         4 002227   000020 736000                    QLS     16
         4 002230   000003 036003                    ADLQ    3,DU
         4 002231   000000 036000 xsym               ADLQ    DATA$
         4 002232   000000 756000 xsym               STQ     REC$

      778     4034    4               REC_REDEF = REC$->RECORD;

   4034  4 002233   000000 471400 xsym               LDP1    REC$
         4 002234   000000 100500                    MLR     fill='000'O
         4 002235   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         4 002236   000002 000004 0                  ADSC9   REC                      cn=0,n=4

      779     4035    4               REC_IN_LIST = '0'B;

   4035  4 002237   000303 450000 0                  STZ     REC_IN_LIST

      780     4036
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:121  
      781     4037         /*  If 'RECORDS=' clause was specified then RCNT ~= -1 */
      782     4038
      783     4039    4               IF (RCNT ~= -1) /* If 'RECORDS=' specified */

   4039  4 002240   000000 235000 xsym               LDA     RCNT
         4 002241   000013 115000 5                  CMPA    11
         4 002242   002273 600000 4                  TZE     s:4049

      784     4040    5               THEN DO J = 0 TO RCNT; /* then see if this record */

   4040  4 002243   000000 450000 xsym               STZ     J
         4 002244   002267 710000 4                  TRA     s:4047+1

      785     4041    5                   IF RECORD_LIST.TYPE(J) = REC.TYPE /* was specified */

   4041  4 002245   000002 235000 0                  LDA     REC
         4 002246   000022 771000                    ARL     18
         4 002247   002352 755000 0                  STA     J+1
         4 002250   000000 236000 xsym               LDQ     J
         4 002251   000003 736000                    QLS     3
         4 002252   000007 236006 xsym               LDQ     RECORD_LIST+7,QL
         4 002253   000022 736000                    QLS     18
         4 002254   000022 732000                    QRS     18
         4 002255   002352 116000 0                  CMPQ    J+1
         4 002256   002266 601000 4                  TNZ     s:4047

      786     4042    6                   THEN DO;

      787     4043    6                       REC_IN_LIST = '1'B;

   4043  4 002257   400000 236003                    LDQ     -131072,DU
         4 002260   000303 756000 0                  STQ     REC_IN_LIST

      788     4044    6                       X = J; /* save index to RECORD_LIST */

   4044  4 002261   000000 235000 xsym               LDA     J
         4 002262   000000 755000 xsym               STA     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:122  

      789     4045    6                       J = RCNT + 1;

   4045  4 002263   000000 235000 xsym               LDA     RCNT
         4 002264   000001 035007                    ADLA    1,DL
         4 002265   000000 755000 xsym               STA     J

      790     4046    6                       END;

      791     4047    5                   END;

   4047  4 002266   000000 054000 xsym               AOS     J
         4 002267   000000 236000 xsym               LDQ     J
         4 002270   000000 116000 xsym               CMPQ    RCNT
         4 002271   002245 604400 4                  TMOZ    s:4041
         4 002272   002306 710000 4                  TRA     s:4057

      792     4048    5               ELSE DO; /* If it wasn't specified */

      793     4049    5                   REC_IN_LIST = '1'B; /* find index to MSTR_REF */

   4049  4 002273   400000 236003                    LDQ     -131072,DU
         4 002274   000303 756000 0                  STQ     REC_IN_LIST

      794     4050    5                   X = TYPE.MSTRINDX(REC.TYPE);

   4050  4 002275   000002 235000 0                  LDA     REC
         4 002276   777777 375003                    ANA     -1,DU
         4 002277   000021 771000                    ARL     17
         4 002300   000000 100405                    MLR     fill='000'O
         4 002301   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
         4 002302   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 002303   002352 236000 0                  LDQ     J+1
         4 002304   000022 732000                    QRS     18
         4 002305   000000 756000 xsym               STQ     X

      795     4051    5                   END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:123  

      796     4052        /*
      797     4053            If 'RECORDS=' clause was either (1) not specified or
      798     4054            (2) specified and this record name was specified
      799     4055            then accumulate stats for this record.
      800     4056        */
      801     4057    4               IF REC_IN_LIST = '1'B

   4057  4 002306   000303 234000 0                  SZN     REC_IN_LIST
         4 002307   002736 605000 4                  TPL     s:4133

      802     4058    5               THEN DO;

      803     4059    5                   NUM_DBKEYS_USED = NUM_DBKEYS_USED + 1;

   4059  4 002310   001404 235000 0                  LDA     NUM_DBKEYS_USED
         4 002311   000001 035007                    ADLA    1,DL
         4 002312   001404 755000 0                  STA     NUM_DBKEYS_USED

      804     4060    5                   DB_RECS.NO_OF_RECS(X)=DB_RECS.NO_OF_RECS(X)+1;

   4060  4 002313   000000 236000 xsym               LDQ     X
         4 002314   000003 736000                    QLS     3
         4 002315   000312 470400 0                  LDP0    DB_RECS$
         4 002316   000000 235106                    LDA     0,QL,PR0
         4 002317   000001 035007                    ADLA    1,DL
         4 002320   000000 755106                    STA     0,QL,PR0

      805     4061    5                   IF RECS.NO_OF_RECS(X) = 0 /* FIRST OCCURENCE */

   4061  4 002321   000000 235000 xsym               LDA     X
         4 002322   000003 735000                    ALS     3
         4 002323   000003 471400 0                  LDP1    RECS$
         4 002324   100000 235105                    LDA     0,AL,PR1
         4 002325   002425 601000 4                  TNZ     s:4077

      806     4062    6                   THEN DO;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:124  

      807     4063    6                       RECS.NO_OF_RECS(X) = 1;

   4063  4 002326   000000 235000 xsym               LDA     X
         4 002327   000003 735000                    ALS     3
         4 002330   000001 236007                    LDQ     1,DL
         4 002331   100000 756105                    STQ     0,AL,PR1

      808     4064    6                       RECS.LO_SZ(X) = REC.LEN;

   4064  4 002332   000000 235000 xsym               LDA     X
         4 002333   000003 735000                    ALS     3
         4 002334   000002 236000 0                  LDQ     REC
         4 002335   777777 376007                    ANQ     -1,DL
         4 002336   000003 471400 0                  LDP1    RECS$
         4 002337   100002 756105                    STQ     2,AL,PR1

      809     4065    6                       RECS.HI_SZ(X) = REC.LEN;

   4065  4 002340   000000 235000 xsym               LDA     X
         4 002341   000003 735000                    ALS     3
         4 002342   000003 471400 0                  LDP1    RECS$
         4 002343   100003 756105                    STQ     3,AL,PR1

      810     4066    6                       RECS.TOT_SZ(X) = REC.LEN;

   4066  4 002344   000000 235000 xsym               LDA     X
         4 002345   000003 735000                    ALS     3
         4 002346   000003 471400 0                  LDP1    RECS$
         4 002347   100001 756105                    STQ     1,AL,PR1

      811     4067    6                       RECS.LO_DBKEY(X) = DATA_PG.CON_INTRVAL*LPP + I + LOW_DBK - LPP;

   4067  4 002350   000000 235000 xsym               LDA     X
         4 002351   000003 735000                    ALS     3
         4 002352   000000 471400 xsym               LDP1    DATA$
         4 002353   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:125  
         4 002354   000000 620005                    EAX0    0,AL
         4 002355   000000 402000 xsym               MPY     LPP
         4 002356   000000 036000 xsym               ADLQ    I
         4 002357   000000 036000 xsym               ADLQ    LOW_DBK
         4 002360   000000 136000 xsym               SBLQ    LPP
         4 002361   000003 473400 0                  LDP3    RECS$
         4 002362   300004 756110                    STQ     4,X0,PR3

      812     4068    6                       RECS.HI_DBKEY(X) = DATA_PG.CON_INTRVAL*LPP + I + LOW_DBK - LPP;

   4068  4 002363   000000 235000 xsym               LDA     X
         4 002364   000003 735000                    ALS     3
         4 002365   000000 471400 xsym               LDP1    DATA$
         4 002366   100004 236100                    LDQ     4,,PR1
         4 002367   000000 620005                    EAX0    0,AL
         4 002370   000000 402000 xsym               MPY     LPP
         4 002371   000000 036000 xsym               ADLQ    I
         4 002372   000000 036000 xsym               ADLQ    LOW_DBK
         4 002373   000000 136000 xsym               SBLQ    LPP
         4 002374   000003 473400 0                  LDP3    RECS$
         4 002375   300005 756110                    STQ     5,X0,PR3

      813     4069    6                       PG_TOT_SZ = PG_TOT_SZ + REC.LEN;

   4069  4 002376   000002 236000 0                  LDQ     REC
         4 002377   777777 376007                    ANQ     -1,DL
         4 002400   001405 036000 0                  ADLQ    PG_TOT_SZ
         4 002401   001405 756000 0                  STQ     PG_TOT_SZ

      814     4070    6                       IF NOT REC_TABLE(X) THEN

   4070  4 002402   000000 235000 xsym               LDA     X
         4 002403   002405 605000 4                  TPL     s:4070+3
         4 002404   000044 035003                    ADLA    36,DU
         4 002405   000000 066405                    CMPB    filb='1'B
         4 002406   002112 000001 0                  BDSC    REC_TABLE,A              by=0,bit=0,n=1
         4 002407   000000 000022 5                  BDSC    0                        by=0,bit=0,n=18
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:126  
         4 002410   002520 601000 4                  TNZ     s:4092

      815     4071    7                       DO;

      816     4072    7                           RECS.NO_OF_PAGES(X) = 1;

   4072  4 002411   000000 235000 xsym               LDA     X
         4 002412   000003 735000                    ALS     3
         4 002413   000001 236007                    LDQ     1,DL
         4 002414   000003 471400 0                  LDP1    RECS$
         4 002415   100006 756105                    STQ     6,AL,PR1

      817     4073    7                           REC_TABLE(X) = '1'B;

   4073  4 002416   000000 235000 xsym               LDA     X
         4 002417   002421 605000 4                  TPL     s:4073+3
         4 002420   000044 035003                    ADLA    36,DU
         4 002421   003005 060400                    CSL     bolr='003'O
         4 002422   000114 000001 5                  BDSC    76                       by=0,bit=0,n=1
         4 002423   002112 000001 0                  BDSC    REC_TABLE,A              by=0,bit=0,n=1

      818     4074    7                           END;

      819     4075    6                       END;

   4075  4 002424   002520 710000 4                  TRA     s:4092

      820     4076    6                   ELSE DO;

      821     4077    6                       RECS.NO_OF_RECS(X) = RECS.NO_OF_RECS(X) + 1;

   4077  4 002425   000000 235000 xsym               LDA     X
         4 002426   000003 735000                    ALS     3
         4 002427   000000 620005                    EAX0    0,AL
         4 002430   100000 235105                    LDA     0,AL,PR1
         4 002431   000001 035007                    ADLA    1,DL
         4 002432   100000 755110                    STA     0,X0,PR1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:127  

      822     4078    6                       IF REC.LEN < RECS.LO_SZ(X)

   4078  4 002433   000000 235000 xsym               LDA     X
         4 002434   000003 735000                    ALS     3
         4 002435   000003 471400 0                  LDP1    RECS$
         4 002436   000002 236000 0                  LDQ     REC
         4 002437   777777 376007                    ANQ     -1,DL
         4 002440   100002 116105                    CMPQ    2,AL,PR1
         4 002441   002444 603000 4                  TRC     s:4080

      823     4079    6                       THEN RECS.LO_SZ(X) = REC.LEN;

   4079  4 002442   100002 756105                    STQ     2,AL,PR1
         4 002443   002450 710000 4                  TRA     s:4082

      824     4080    6                       ELSE IF REC.LEN > RECS.HI_SZ(X)

   4080  4 002444   100003 116105                    CMPQ    3,AL,PR1
         4 002445   002450 602000 4                  TNC     s:4082
         4 002446   002450 600000 4                  TZE     s:4082

      825     4081    6                           THEN RECS.HI_SZ(X) = REC.LEN;

   4081  4 002447   100003 756105                    STQ     3,AL,PR1

      826     4082    6                       RECS.TOT_SZ(X) = RECS.TOT_SZ(X) + REC.LEN;

   4082  4 002450   000000 235000 xsym               LDA     X
         4 002451   000003 735000                    ALS     3
         4 002452   000003 471400 0                  LDP1    RECS$
         4 002453   100001 036105                    ADLQ    1,AL,PR1
         4 002454   100001 756105                    STQ     1,AL,PR1

      827     4083    6                       RECS.HI_DBKEY(X) = DATA_PG.CON_INTRVAL*LPP + I + LOW_DBK - LPP;

   4083  4 002455   000000 235000 xsym               LDA     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:128  
         4 002456   000003 735000                    ALS     3
         4 002457   000000 471400 xsym               LDP1    DATA$
         4 002460   100004 236100                    LDQ     4,,PR1
         4 002461   000000 620005                    EAX0    0,AL
         4 002462   000000 402000 xsym               MPY     LPP
         4 002463   000000 036000 xsym               ADLQ    I
         4 002464   000000 036000 xsym               ADLQ    LOW_DBK
         4 002465   000000 136000 xsym               SBLQ    LPP
         4 002466   000003 473400 0                  LDP3    RECS$
         4 002467   300005 756110                    STQ     5,X0,PR3

      828     4084    6                       PG_TOT_SZ = PG_TOT_SZ + REC.LEN;

   4084  4 002470   000002 236000 0                  LDQ     REC
         4 002471   777777 376007                    ANQ     -1,DL
         4 002472   001405 036000 0                  ADLQ    PG_TOT_SZ
         4 002473   001405 756000 0                  STQ     PG_TOT_SZ

      829     4085    6                       IF NOT REC_TABLE(X) THEN

   4085  4 002474   000000 235000 xsym               LDA     X
         4 002475   002477 605000 4                  TPL     s:4085+3
         4 002476   000044 035003                    ADLA    36,DU
         4 002477   000000 066405                    CMPB    filb='1'B
         4 002500   002112 000001 0                  BDSC    REC_TABLE,A              by=0,bit=0,n=1
         4 002501   000000 000022 5                  BDSC    0                        by=0,bit=0,n=18
         4 002502   002520 601000 4                  TNZ     s:4092

      830     4086    7                       DO;

      831     4087    7                           RECS.NO_OF_PAGES(X) =

   4087  4 002503   000000 235000 xsym               LDA     X
         4 002504   000003 735000                    ALS     3
         4 002505   000003 471400 0                  LDP1    RECS$
         4 002506   000000 620005                    EAX0    0,AL
         4 002507   100006 235105                    LDA     6,AL,PR1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:129  
         4 002510   000001 035007                    ADLA    1,DL
         4 002511   100006 755110                    STA     6,X0,PR1

      832     4088    7                              RECS.NO_OF_PAGES(X)+1;
      833     4089    7                           REC_TABLE(X) = '1'B;

   4089  4 002512   000000 235000 xsym               LDA     X
         4 002513   002515 605000 4                  TPL     s:4089+3
         4 002514   000044 035003                    ADLA    36,DU
         4 002515   003005 060400                    CSL     bolr='003'O
         4 002516   000114 000001 5                  BDSC    76                       by=0,bit=0,n=1
         4 002517   002112 000001 0                  BDSC    REC_TABLE,A              by=0,bit=0,n=1

      834     4090    7                           END;

      835     4091    6                       END;

      836     4092    5                   MSTR_INDX=DB_RECS.MSTRINDX(X);

   4092  4 002520   000000 235000 xsym               LDA     X
         4 002521   000003 735000                    ALS     3
         4 002522   000007 236105                    LDQ     7,AL,PR0
         4 002523   000022 772000                    QRL     18
         4 002524   000000 756000 xsym               STQ     MSTR_INDX

      837     4093    5                   IF MSTR_REF.PAOFF(MSTR_INDX)>0 THEN /* PA RECORD */

   4093  4 002525   000012 402007                    MPY     10,DL
         4 002526   000000 471400 xsym               LDP1    MSTR$
         4 002527   100011 236106                    LDQ     9,QL,PR1
         4 002530   777000 316003                    CANQ    -512,DU
         4 002531   002736 600000 4                  TZE     s:4133

      838     4094    6                   DO;

      839     4095    6                       IF DB_RECS.NO_OF_RECS(X)=1 THEN

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:130  
   4095  4 002532   000000 235000 xsym               LDA     X
         4 002533   000003 735000                    ALS     3
         4 002534   000000 235105                    LDA     0,AL,PR0
         4 002535   000001 115007                    CMPA    1,DL
         4 002536   002567 601000 4                  TNZ     s:4110

      840     4096    7                       DO; /* VERY 1ST TIME THRU THIS REC (EVEN MUTI-AREA) */

      841     4097    7                           IF RCNT=-1 THEN /* INCREMENT ONE MORE PA COUNT */

   4097  4 002537   000000 235000 xsym               LDA     RCNT
         4 002540   000013 115000 5                  CMPA    11
         4 002541   002553 601000 4                  TNZ     s:4103

      842     4098    8                           DO;

      843     4099    8                               NUM_PA_RECS=NUM_PA_RECS+1;

   4099  4 002542   001406 054000 0                  AOS     NUM_PA_RECS

      844     4100    8                              DB_RECS.PA_INDX(X)=NUM_PA_RECS; /* SET UP INDX FOR IT */

   4100  4 002543   000000 236000 xsym               LDQ     X
         4 002544   000003 736000                    QLS     3
         4 002545   001406 720000 0                  LXL0    NUM_PA_RECS
         4 002546   000007 440106                    SXL0    7,QL,PR0

      845     4101    8                               PA.RECSINDX(NUM_PA_RECS)=X; /* POINT BACK TO RECS */

   4101  4 002547   001406 236000 0                  LDQ     NUM_PA_RECS
         4 002550   000005 402007                    MPY     5,DL
         4 002551   000000 721000 xsym               LXL1    X
         4 002552   001407 741006 0                  STX1    PA,QL

      846     4102    8                               END;

      847     4103    7                           Y=DB_RECS.PA_INDX(X); /* INDX INTO PA TABLE FOR THIS PA */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:131  

   4103  4 002553   000000 235000 xsym               LDA     X
         4 002554   000003 735000                    ALS     3
         4 002555   000007 236105                    LDQ     7,AL,PR0
         4 002556   777777 376007                    ANQ     -1,DL
         4 002557   000313 756000 0                  STQ     Y

      848     4104    7                           PA.OWNER_FOUND(Y)=0; /* INIT COUNT */

   4104  4 002560   000005 402007                    MPY     5,DL
         4 002561   001410 450006 0                  STZ     PA+1,QL

      849     4105    7                           PA.TOT_PTRS(Y)=0;

   4105  4 002562   001412 450006 0                  STZ     PA+3,QL

      850     4106    7                           PA.MEM_FOUND(Y)=0;

   4106  4 002563   001411 450006 0                  STZ     PA+2,QL

      851     4107    7                           PA.SPACE_AVAIL(Y)=0;

   4107  4 002564   001413 450006 0                  STZ     PA+4,QL

      852     4108    7                           PA.REC_SIZE(Y)=REC.LEN; /* REMEMBER THE SIZE OF PA */

   4108  4 002565   000002 720000 0                  LXL0    REC
         4 002566   001407 440006 0                  SXL0    PA,QL

      853     4109    7                           END;

      854     4110    6                       PTR_SIZE=(MSTR_REF.PAOFF(MSTR_INDX)-2*4)/3;

   4110  4 002567   000000 236000 xsym               LDQ     MSTR_INDX
         4 002570   000012 402007                    MPY     10,DL
         4 002571   000000 471400 xsym               LDP1    MSTR$
         4 002572   100011 236106                    LDQ     9,QL,PR1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:132  
         4 002573   000033 772000                    QRL     27
         4 002574   000010 136007                    SBLQ    8,DL
         4 002575   000003 506007                    DIV     3,DL
         4 002576   000315 756000 0                  STQ     PTR_SIZE

      855     4111    6                       Y=DB_RECS.PA_INDX(X); /* INDX INTO PA_TABLE */

   4111  4 002577   000000 235000 xsym               LDA     X
         4 002600   000003 735000                    ALS     3
         4 002601   000007 236105                    LDQ     7,AL,PR0
         4 002602   777777 376007                    ANQ     -1,DL
         4 002603   000313 756000 0                  STQ     Y

      856     4112    6                       IF PA_REC.PTRS=PINCRC(REC$,2*PTR_SIZE)->PA_REC.PTRS THEN

   4112  4 002604   000315 235000 0                  LDA     PTR_SIZE
         4 002605   000001 735000                    ALS     1
         4 002606   000000 473400 xsym               LDP3    REC$
         4 002607   000315 720000 0                  LXL0    PTR_SIZE
         4 002610   040145 106540                    CMPC    fill='040'O
         4 002611   300002 000010                    ADSC9   2,,PR3                   cn=0,n=*X0
         4 002612   300002 000010                    ADSC9   2,A,PR3                  cn=0,n=*X0
         4 002613   002620 601000 4                  TNZ     s:4114

      857     4113    6                           PA.OWNER_FOUND(Y)=PA.OWNER_FOUND(Y)+1; /* HIGHEST PA */

   4113  4 002614   000005 402007                    MPY     5,DL
         4 002615   001410 235006 0                  LDA     PA+1,QL
         4 002616   000001 035007                    ADLA    1,DL
         4 002617   001410 755006 0                  STA     PA+1,QL

      858     4114    6                       PA.SPACE_AVAIL(Y)=PA.SPACE_AVAIL(Y)+PA_REC.AVAIL;

   4114  4 002620   000313 236000 0                  LDQ     Y
         4 002621   000005 402007                    MPY     5,DL
         4 002622   000000 621006                    EAX1    0,QL
         4 002623   000000 101500                    MRL     fill='000'O
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:133  
         4 002624   300001 400002                    ADSC9   1,,PR3                   cn=2,n=2
         4 002625   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 002626   000000 622006                    EAX2    0,QL
         4 002627   002352 236000 0                  LDQ     J+1
         4 002630   001413 036011 0                  ADLQ    PA+4,X1
         4 002631   001413 756012 0                  STQ     PA+4,X2

      859     4115    6                       INDX=PA_REC.ENTRIES;

   4115  4 002632   003000 061500                    CSR     bolr='003'O
         4 002633   300001 060014                    BDSC    1,,PR3                   by=0,bit=6,n=12
         4 002634   000304 000044 0                  BDSC    INDX                     by=0,bit=0,n=36

      860     4116    6                       ENTRY$=PINCRC(REC$,MSTR_REF.PAOFF(MSTR_INDX));

   4116  4 002635   000000 236000 xsym               LDQ     MSTR_INDX
         4 002636   000012 402007                    MPY     10,DL
         4 002637   100011 236106                    LDQ     9,QL,PR1
         4 002640   000033 772000                    QRL     27
         4 002641   000020 736000                    QLS     16
         4 002642   000000 036000 xsym               ADLQ    REC$
         4 002643   000316 756000 0                  STQ     ENTRY$

      861     4117    7                       DO X=1 TO PA_REC.ENTRIES; /* GO THRU ALL ENTRY */

   4117  4 002644   000001 235007                    LDA     1,DL
         4 002645   000000 755000 xsym               STA     X
         4 002646   002712 710000 4                  TRA     s:4126+1

      862     4118    7                           IF PA_ENTRY.C=1 THEN /* GROUP PRESENT */

   4118  4 002647   000316 470400 0                  LDP0    ENTRY$
         4 002650   003000 061500                    CSR     bolr='003'O
         4 002651   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 002652   002352 000044 0                  BDSC    J+1                      by=0,bit=0,n=36
         4 002653   002352 236000 0                  LDQ     J+1
         4 002654   000001 116007                    CMPQ    1,DL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:134  
         4 002655   002701 601000 4                  TNZ     s:4125

      863     4119    8                           DO;

      864     4120    8                               PTR_BIN=0;

   4120  4 002656   000320 450000 0                  STZ     PTR_BIN

      865     4121    8                               PINCRC(ADDR(PTR_BIN),4-PTR_SIZE)->CHAR_V=PA_ENTRY.PTRS;

   4121  4 002657   000000 235003                    LDA     0,DU
         4 002660   000315 135000 0                  SBLA    PTR_SIZE
         4 002661   000315 720000 0                  LXL0    PTR_SIZE
         4 002662   040045 100540                    MLR     fill='040'O
         4 002663   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         4 002664   000321 000010 0                  ADSC9   PAH1,A                   cn=0,n=*X0

      866     4122    8                               GROUP$=PINCRC(REC$,PTR_BIN);

   4122  4 002665   000320 236000 0                  LDQ     PTR_BIN
         4 002666   000020 736000                    QLS     16
         4 002667   000000 036000 xsym               ADLQ    REC$
         4 002670   000317 756000 0                  STQ     GROUP$

      867     4123    8                               INDX=INDX+PA_GROUP.NO_GROUPS-1;

   4123  4 002671   000317 471400 0                  LDP1    GROUP$
         4 002672   000000 101500                    MRL     fill='000'O
         4 002673   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002674   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 002675   002352 236000 0                  LDQ     J+1
         4 002676   000304 036000 0                  ADLQ    INDX
         4 002677   000001 136007                    SBLQ    1,DL
         4 002700   000304 756000 0                  STQ     INDX

      868     4124    8                               END;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:135  
      869     4125    7                           ENTRY$=PINCRC(ENTRY$,MSTR_REF.PAENT(MSTR_INDX));

   4125  4 002701   000000 236000 xsym               LDQ     MSTR_INDX
         4 002702   000012 402007                    MPY     10,DL
         4 002703   000000 471400 xsym               LDP1    MSTR$
         4 002704   100011 236106                    LDQ     9,QL,PR1
         4 002705   000100 376000 5                  ANQ     64
         4 002706   000020 736000                    QLS     16
         4 002707   000316 036000 0                  ADLQ    ENTRY$
         4 002710   000316 756000 0                  STQ     ENTRY$

      870     4126    7                           END;

   4126  4 002711   000000 054000 xsym               AOS     X
         4 002712   000000 470400 xsym               LDP0    REC$
         4 002713   003000 061500                    CSR     bolr='003'O
         4 002714   000001 060014                    BDSC    1,,PR0                   by=0,bit=6,n=12
         4 002715   002352 000044 0                  BDSC    J+1                      by=0,bit=0,n=36
         4 002716   002352 236000 0                  LDQ     J+1
         4 002717   000000 116000 xsym               CMPQ    X
         4 002720   002647 605000 4                  TPL     s:4118

      871     4127    6                       PA.TOT_PTRS(Y)=PA.TOT_PTRS(Y)+INDX;

   4127  4 002721   000313 236000 0                  LDQ     Y
         4 002722   000005 402007                    MPY     5,DL
         4 002723   000000 620006                    EAX0    0,QL
         4 002724   001412 236006 0                  LDQ     PA+3,QL
         4 002725   000304 036000 0                  ADLQ    INDX
         4 002726   001412 756010 0                  STQ     PA+3,X0

      872     4128    6                       IF PA_REC.NOT_LOWEST_LEVEL='0'B THEN /* LOWEST LEVEL */

   4128  4 002727   000000 066500                    CMPB    filb='1'B
         4 002730   000001 000001                    BDSC    1,,PR0                   by=0,bit=0,n=1
         4 002731   000000 000022 5                  BDSC    0                        by=0,bit=0,n=18
         4 002732   002736 601000 4                  TNZ     s:4133
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:136  

      873     4129    6                           PA.MEM_FOUND(Y)=PA.MEM_FOUND(Y)+INDX;

   4129  4 002733   001411 236010 0                  LDQ     PA+2,X0
         4 002734   000304 036000 0                  ADLQ    INDX
         4 002735   001411 756010 0                  STQ     PA+2,X0

      874     4130    6                       END;

      875     4131    5                   END;

      876     4132    4               END;

      877     4133    3           END;

   4133  4 002736   000000 054000 xsym               AOS     I
         4 002737   000000 470400 xsym               LDP0    DATA$
         4 002740   000005 236100                    LDQ     5,,PR0
         4 002741   777777 376007                    ANQ     -1,DL
         4 002742   000000 116000 xsym               CMPQ    I
         4 002743   002210 605000 4                  TPL     s:4032

      878     4134
      879     4135    3       IF (ZI$DIR.REPRT_PG = '1'B) | (ZI$DIR.REPRT_ALL = '1'B) THEN DO;

   4135  4 002744   400000 220003                    LDX0    -131072,DU
         4 002745   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002746   000200 316007                    CANQ    128,DL
         4 002747   002751 601000 4                  TNZ     s:4135+5
         4 002750   000000 220003                    LDX0    0,DU
         4 002751   400000 221003                    LDX1    -131072,DU
         4 002752   001000 316007                    CANQ    512,DL
         4 002753   002755 601000 4                  TNZ     s:4135+9
         4 002754   000000 221003                    LDX1    0,DU
         4 002755   000000 636011                    EAQ     0,X1
         4 002756   002352 756000 0                  STQ     J+1
         4 002757   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:137  
         4 002760   002352 276000 0                  ORQ     J+1
         4 002761   003144 600000 4                  TZE     s:4154

      880     4136    4           IF RCNT = -1 THEN DO;

   4136  4 002762   000000 235000 xsym               LDA     RCNT
         4 002763   000013 115000 5                  CMPA    11
         4 002764   003032 601000 4                  TNZ     s:4145

      881     4137    4               PG_TOT_SZ = PG_TOT_SZ + 24 + OA_SZ;

   4137  4 002765   001405 236000 0                  LDQ     PG_TOT_SZ
         4 002766   000250 036000 0                  ADLQ    OA_SZ
         4 002767   000030 036007                    ADLQ    24,DL
         4 002770   001405 756000 0                  STQ     PG_TOT_SZ

      882     4138    4               NUM_DBKEYS_UNUSED = LPP - (DATA_PG.OFF_LN.SEC + 1);
              4138                        /* LINES NOT IN OFFSET ARRAY */

   4138  4 002771   000005 236100                    LDQ     5,,PR0
         4 002772   777777 376007                    ANQ     -1,DL
         4 002773   002352 756000 0                  STQ     J+1
         4 002774   000000 236000 xsym               LDQ     LPP
         4 002775   002352 136000 0                  SBLQ    J+1
         4 002776   000001 136007                    SBLQ    1,DL
         4 002777   001403 756000 0                  STQ     NUM_DBKEYS_UNUSED

      883     4139    5               DO X = 0 TO DATA_PG.OFF_LN.SEC;

   4139  4 003000   000000 450000 xsym               STZ     X
         4 003001   003020 710000 4                  TRA     s:4142+1

      884     4140    5                   IF DATA_PG.ACT_DATA_18(OFFSET# X) < 0 THEN

   4140  4 003002   000000 335000 xsym               LCA     X
         4 003003   000001 735000                    ALS     1
         4 003004   000000 470400 xsym               LDP0    DATA$
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:138  
         4 003005   000000 100505                    MLR     fill='000'O
         4 003006   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 003007   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 003010   002352 236000 0                  LDQ     J+1
         4 003011   000022 732000                    QRS     18
         4 003012   000000 116003                    CMPQ    0,DU
         4 003013   003017 605000 4                  TPL     s:4142

      885     4141    5                       NUM_DBKEYS_UNUSED = NUM_DBKEYS_UNUSED + 1;

   4141  4 003014   001403 236000 0                  LDQ     NUM_DBKEYS_UNUSED
         4 003015   000001 036007                    ADLQ    1,DL
         4 003016   001403 756000 0                  STQ     NUM_DBKEYS_UNUSED

      886     4142    5                   END;

   4142  4 003017   000000 054000 xsym               AOS     X
         4 003020   000005 236100                    LDQ     5,,PR0
         4 003021   777777 376007                    ANQ     -1,DL
         4 003022   000000 116000 xsym               CMPQ    X
         4 003023   003002 605000 4                  TPL     s:4140

      887     4143    4               PRCNT_DBKEYS_FULL = (((LPP - NUM_DBKEYS_UNUSED) * 100) / LPP) + (1/2);

   4143  4 003024   000000 236000 xsym               LDQ     LPP
         4 003025   001403 136000 0                  SBLQ    NUM_DBKEYS_UNUSED
         4 003026   000144 402007                    MPY     100,DL
         4 003027   000000 506000 xsym               DIV     LPP
         4 003030   001402 756000 0                  STQ     PRCNT_DBKEYS_FULL

      888     4144    4               END;

   4144  4 003031   003050 710000 4                  TRA     s:4146

      889     4145    3           ELSE PRCNT_DBKEYS_FULL = ((NUM_DBKEYS_USED * 100) / LPP) + (1/2);

   4145  4 003032   001404 236000 0                  LDQ     NUM_DBKEYS_USED
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:139  
         4 003033   000144 402007                    MPY     100,DL
         4 003034   000000 116003                    CMPQ    0,DU
         4 003035   003046 605000 4                  TPL     s:4145+12
         4 003036   000000 235000 xsym               LDA     LPP
         4 003037   000001 405007                    CMG     1,DL
         4 003040   003047 600000 4                  TZE     s:4145+13
         4 003041   000000 235003                    LDA     0,DU
         4 003042   000001 737000                    LLS     1
         4 003043   000000 507000 xsym               DVF     LPP
         4 003044   000044 733000                    LRS     36
         4 003045   003047 710000 4                  TRA     s:4145+13
         4 003046   000000 506000 xsym               DIV     LPP
         4 003047   001402 756000 0                  STQ     PRCNT_DBKEYS_FULL

      890     4146    3           IF PRCNT_DBKEYS_FULL >= 100 THEN PRCNT_DBKEYS_FULL = 99;

   4146  4 003050   000144 116007                    CMPQ    100,DL
         4 003051   003054 602000 4                  TNC     s:4147

   4146  4 003052   000143 235007                    LDA     99,DL
         4 003053   001402 755000 0                  STA     PRCNT_DBKEYS_FULL

      891     4147    3           PGS.DNUM(PRCNT_DBKEYS_FULL/5) = PGS.DNUM(PRCNT_DBKEYS_FULL/5) + 1;

   4147  4 003054   001402 235000 0                  LDA     PRCNT_DBKEYS_FULL
         4 003055   000043 773000                    LRL     35
         4 003056   000005 507007                    DVF     5,DL
         4 003057   000044 733000                    LRS     36
         4 003060   000006 402007                    MPY     6,DL
         4 003061   001402 235000 0                  LDA     PRCNT_DBKEYS_FULL
         4 003062   000000 620006                    EAX0    0,QL
         4 003063   000043 773000                    LRL     35
         4 003064   000005 507007                    DVF     5,DL
         4 003065   000044 733000                    LRS     36
         4 003066   000006 402007                    MPY     6,DL
         4 003067   001021 235006 0                  LDA     PGS,QL
         4 003070   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:140  
         4 003071   001021 755010 0                  STA     PGS,X0

      892     4148    3           PRCNT_SPACE_FULL = ((PG_TOT_SZ*100) / (4096 - OA_SZ - 24)) + (1/2);

   4148  4 003072   007750 235007                    LDA     4072,DL
         4 003073   000250 135000 0                  SBLA    OA_SZ
         4 003074   002352 755000 0                  STA     J+1
         4 003075   001405 236000 0                  LDQ     PG_TOT_SZ
         4 003076   000144 402007                    MPY     100,DL
         4 003077   000000 116003                    CMPQ    0,DU
         4 003100   003111 605000 4                  TPL     s:4148+15
         4 003101   002352 235000 0                  LDA     J+1
         4 003102   000001 405007                    CMG     1,DL
         4 003103   003112 600000 4                  TZE     s:4148+16
         4 003104   000000 235003                    LDA     0,DU
         4 003105   000001 737000                    LLS     1
         4 003106   002352 507000 0                  DVF     J+1
         4 003107   000044 733000                    LRS     36
         4 003110   003112 710000 4                  TRA     s:4148+16
         4 003111   002352 506000 0                  DIV     J+1
         4 003112   001401 756000 0                  STQ     PRCNT_SPACE_FULL

      893     4149    3           IF PRCNT_SPACE_FULL >= 100 THEN PRCNT_SPACE_FULL = 99;

   4149  4 003113   000144 116007                    CMPQ    100,DL
         4 003114   003117 602000 4                  TNC     s:4150

   4149  4 003115   000143 235007                    LDA     99,DL
         4 003116   001401 755000 0                  STA     PRCNT_SPACE_FULL

      894     4150    3           PGS.SNUM(PRCNT_SPACE_FULL/5) = PGS.SNUM(PRCNT_SPACE_FULL/5) + 1;

   4150  4 003117   001401 235000 0                  LDA     PRCNT_SPACE_FULL
         4 003120   000043 773000                    LRL     35
         4 003121   000005 507007                    DVF     5,DL
         4 003122   000044 733000                    LRS     36
         4 003123   000006 402007                    MPY     6,DL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:141  
         4 003124   001401 235000 0                  LDA     PRCNT_SPACE_FULL
         4 003125   000000 620006                    EAX0    0,QL
         4 003126   000043 773000                    LRL     35
         4 003127   000005 507007                    DVF     5,DL
         4 003130   000044 733000                    LRS     36
         4 003131   000006 402007                    MPY     6,DL
         4 003132   001024 235006 0                  LDA     PGS+3,QL
         4 003133   001025 236006 0                  LDQ     PGS+4,QL
         4 003134   000022 773000                    LRL     18
         4 003135   000001 036007                    ADLQ    1,DL
         4 003136   002352 756000 0                  STQ     J+1
         4 003137   000000 635010                    EAA     0,X0
         4 003140   000020 771000                    ARL     16
         4 003141   000005 100400                    MLR     fill='000'O
         4 003142   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 003143   001024 400004 0                  ADSC9   PGS+3,A                  cn=2,n=4

      895     4151
      896     4152    3           END;

      897     4153
      898     4154    2       RETURN;

   4154  4 003144   002111 221200 0                  LDX1  ! @HI_PGE+1
         4 003145   000001 702211                    TSX2  ! 1,X1

      899     4155    2   END PROCESS_PAGE;
      900     4156
      901     4157        /*------------------------------------------------------------------*/
      902     4158        /*   Called after processing an area, this routine produces a       */
      903     4159        /*   screen-oriented report of the record statistics accumulated.   */
      904     4160        /*------------------------------------------------------------------*/
      905     4161
      906     4162    1   REPORT_RECORD: PROC;

   4162  4 003146   002272 741200 0     REPORT_RECO* STX1  ! REC_TABLE+112

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:142  
      907     4163
      908     4164    2       DCBSF = DCBNUM(M$LO);

   4164  4 003147   000000 236007 xsym               LDQ     M$LO,DL
         4 003150   000000 620006                    EAX0    0,QL
         4 003151   000000 740000 xsym               STX0    DCBSF

      909     4165    2       VFCSF = %YES#;

   4165  4 003152   400000 236003                    LDQ     -131072,DU
         4 003153   000000 756000 xsym               STQ     VFCSF

      910     4166    2       BUFSF = VECTOR(PH0);

   4166  4 003154   000030 237000 5                  LDAQ    24
         4 003155   000000 755000 xsym               STA     BUFSF
         4 003156   000001 756000 xsym               STQ     BUFSF+1

      911     4167    2       BUFLNSF = 62;

   4167  4 003157   000076 235007                    LDA     62,DL
         4 003160   000000 755000 xsym               STA     BUFLNSF

      912     4168    2       CALL SYS_FUNC_WRIT;

   4168  4 003161   000000 631400 5                  EPPR1   0
         4 003162   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 003163   000000 011000                    NOP     0

      913     4169    2       CALL WRIT(BLANK_LINE,1);

   4169  4 003164   000034 237000 5                  LDAQ    28
         4 003165   002276 757000 0                  STAQ    NUM_PGS+2
         4 003166   005301 701000 4                  TSX1    WRIT
         4 003167   000000 011000                    NOP     0

      914     4170    2       CALL WRIT(PH1,48);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:143  

   4170  4 003170   000116 237000 5                  LDAQ    78
         4 003171   002276 757000 0                  STAQ    NUM_PGS+2
         4 003172   005301 701000 4                  TSX1    WRIT
         4 003173   000000 011000                    NOP     0

      915     4171    2       CALL WRIT(PH2,48);

   4171  4 003174   000120 237000 5                  LDAQ    80
         4 003175   002276 757000 0                  STAQ    NUM_PGS+2
         4 003176   005301 701000 4                  TSX1    WRIT
         4 003177   000000 011000                    NOP     0

      916     4172    2       CALL WRIT(PH3,80);

   4172  4 003200   000122 237000 5                  LDAQ    82
         4 003201   002276 757000 0                  STAQ    NUM_PGS+2
         4 003202   005301 701000 4                  TSX1    WRIT
         4 003203   000000 011000                    NOP     0

      917     4173    2       CALL WRIT(PH4,80);

   4173  4 003204   000124 237000 5                  LDAQ    84
         4 003205   002276 757000 0                  STAQ    NUM_PGS+2
         4 003206   005301 701000 4                  TSX1    WRIT
         4 003207   000000 011000                    NOP     0

      918     4174    2       CALL WRIT(BLANK_LINE,1);

   4174  4 003210   000034 237000 5                  LDAQ    28
         4 003211   002276 757000 0                  STAQ    NUM_PGS+2
         4 003212   005301 701000 4                  TSX1    WRIT
         4 003213   000000 011000                    NOP     0

      919     4175
      920     4176        /*
      921     4177             If 'REC=' is not specified
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:144  
      922     4178                then for all MSTR_REF entries
      923     4179                     that have occured in this area
      924     4180                          that are not CALC records
      925     4181                               report statistics.
      926     4182             If 'REC=' was specified
      927     4183                then for all RECORD_LIST entries
      928     4184                     that are not CALC records
      929     4185                          report statistics.
      930     4186             If summary statistics are needed, they are accumulated.
      931     4187                                                                        */
      932     4188    2       IF RCNT = -1 THEN

   4188  4 003214   000000 235000 xsym               LDA     RCNT
         4 003215   000013 115000 5                  CMPA    11
         4 003216   003473 601000 4                  TNZ     s:4224

      933     4189    3       DO X = 0 TO (NO_RECS - 1);

   4189  4 003217   000000 450000 xsym               STZ     X
         4 003220   003467 710000 4                  TRA     s:4222+1

      934     4190    3           IF MSTR_REF.TYPE(X)=4000 THEN /* *CALC RECORD */

   4190  4 003221   000000 236000 xsym               LDQ     X
         4 003222   000012 402007                    MPY     10,DL
         4 003223   000000 470400 xsym               LDP0    MSTR$
         4 003224   000000 220106                    LDX0    0,QL,PR0
         4 003225   007640 100003                    CMPX0   4000,DU
         4 003226   003241 601000 4                  TNZ     s:4192

      935     4191    3               IF RECS.NO_OF_RECS(X) > 0 THEN CALC_REC = RECS(X); /* *CALC EXIST */

   4191  4 003227   000000 235000 xsym               LDA     X
         4 003230   000003 735000                    ALS     3
         4 003231   000003 471400 0                  LDP1    RECS$
         4 003232   100000 235105                    LDA     0,AL,PR1
         4 003233   003241 600000 4                  TZE     s:4192
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:145  

   4191  4 003234   000000 235000 xsym               LDA     X
         4 003235   000005 735000                    ALS     5
         4 003236   000000 100505                    MLR     fill='000'O
         4 003237   100000 000030                    ADSC9   0,A,PR1                  cn=0,n=24
         4 003240   000004 000030 0                  ADSC9   CALC_REC                 cn=0,n=24

      936     4192    3           IF (RECS.NO_OF_RECS(X) > 0) THEN

   4192  4 003241   000000 235000 xsym               LDA     X
         4 003242   000003 735000                    ALS     3
         4 003243   000003 471400 0                  LDP1    RECS$
         4 003244   100000 235105                    LDA     0,AL,PR1
         4 003245   003466 600000 4                  TZE     s:4222

      937     4193    4           DO;

      938     4194    4               IF NEED_SUMMARY = '1'B THEN

   4194  4 003246   000302 234000 0                  SZN     NEED_SUMMARY
         4 003247   003316 605000 4                  TPL     s:4206

      939     4195    5               DO;

      940     4196    5                   IF RECS.LO_SZ(X) < DB_RECS.LO_SZ(X)

   4196  4 003250   000000 235000 xsym               LDA     X
         4 003251   000003 735000                    ALS     3
         4 003252   000312 473400 0                  LDP3    DB_RECS$
         4 003253   100002 236105                    LDQ     2,AL,PR1
         4 003254   300002 116105                    CMPQ    2,AL,PR3
         4 003255   003257 603000 4                  TRC     s:4198

      941     4197    5                   THEN DB_RECS.LO_SZ(X) = RECS.LO_SZ(X);

   4197  4 003256   300002 756105                    STQ     2,AL,PR3

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:146  
      942     4198    5                   IF RECS.HI_SZ(X) > DB_RECS.HI_SZ(X)

   4198  4 003257   000000 235000 xsym               LDA     X
         4 003260   000003 735000                    ALS     3
         4 003261   000003 470400 0                  LDP0    RECS$
         4 003262   300003 236105                    LDQ     3,AL,PR3
         4 003263   000003 116105                    CMPQ    3,AL,PR0
         4 003264   003270 603000 4                  TRC     s:4200

      943     4199    5                   THEN DB_RECS.HI_SZ(X) = RECS.HI_SZ(X);

   4199  4 003265   000000 620005                    EAX0    0,AL
         4 003266   000003 235105                    LDA     3,AL,PR0
         4 003267   300003 755110                    STA     3,X0,PR3

      944     4200    5                   DB_RECS.TOT_SZ(X) = DB_RECS.TOT_SZ(X) + RECS.TOT_SZ(X);

   4200  4 003270   000000 235000 xsym               LDA     X
         4 003271   000003 735000                    ALS     3
         4 003272   000003 470400 0                  LDP0    RECS$
         4 003273   300001 236105                    LDQ     1,AL,PR3
         4 003274   000001 036105                    ADLQ    1,AL,PR0
         4 003275   300001 756105                    STQ     1,AL,PR3

      945     4201    5                   IF RECS.LO_DBKEY(X) < DB_RECS.LO_DBKEY(X)

   4201  4 003276   000000 235000 xsym               LDA     X
         4 003277   000003 735000                    ALS     3
         4 003300   000003 470400 0                  LDP0    RECS$
         4 003301   000004 236105                    LDQ     4,AL,PR0
         4 003302   300004 116105                    CMPQ    4,AL,PR3
         4 003303   003305 603000 4                  TRC     s:4203

      946     4202    5                   THEN DB_RECS.LO_DBKEY(X) = RECS.LO_DBKEY(X);

   4202  4 003304   300004 756105                    STQ     4,AL,PR3

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:147  
      947     4203    5                   IF RECS.HI_DBKEY(X) > DB_RECS.HI_DBKEY(X)

   4203  4 003305   000000 235000 xsym               LDA     X
         4 003306   000003 735000                    ALS     3
         4 003307   000003 470400 0                  LDP0    RECS$
         4 003310   300005 236105                    LDQ     5,AL,PR3
         4 003311   000005 116105                    CMPQ    5,AL,PR0
         4 003312   003316 603000 4                  TRC     s:4206

      948     4204    5                   THEN DB_RECS.HI_DBKEY(X) = RECS.HI_DBKEY(X);

   4204  4 003313   000000 620005                    EAX0    0,AL
         4 003314   000005 235105                    LDA     5,AL,PR0
         4 003315   300005 755110                    STA     5,X0,PR3

      949     4205    5                   END;

      950     4206    4               IF MSTR_REF.PAOFF(X)=0 AND MSTR_REF.TYPE(X)<4000 THEN

   4206  4 003316   000000 236000 xsym               LDQ     X
         4 003317   000012 402007                    MPY     10,DL
         4 003320   000000 470400 xsym               LDP0    MSTR$
         4 003321   000011 236106                    LDQ     9,QL,PR0
         4 003322   777000 316003                    CANQ    -512,DU
         4 003323   003466 601000 4                  TNZ     s:4222
         4 003324   000000 236000 xsym               LDQ     X
         4 003325   000012 402007                    MPY     10,DL
         4 003326   000000 220106                    LDX0    0,QL,PR0
         4 003327   007640 100003                    CMPX0   4000,DU
         4 003330   003466 605000 4                  TPL     s:4222

      951     4207    5               DO; /* NOT *PA_REC AND NOT *CALC RECORD */

      952     4208    5                   AREA_TOT_RECS=AREA_TOT_RECS+RECS.NO_OF_RECS(X);

   4208  4 003331   000000 235000 xsym               LDA     X
         4 003332   000003 735000                    ALS     3
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:148  
         4 003333   000003 471400 0                  LDP1    RECS$
         4 003334   000252 236000 0                  LDQ     AREA_TOT_RECS
         4 003335   100000 036105                    ADLQ    0,AL,PR1
         4 003336   000252 756000 0                  STQ     AREA_TOT_RECS

      953     4209    5                   AREA_TOT_SZ=AREA_TOT_SZ+RECS.TOT_SZ(X);

   4209  4 003337   000251 236000 0                  LDQ     AREA_TOT_SZ
         4 003340   100001 036105                    ADLQ    1,AL,PR1
         4 003341   000251 756000 0                  STQ     AREA_TOT_SZ

      954     4210    5                   RLINE.REC_NAME = MSTR_REF.NAME(X);

   4210  4 003342   000000 236000 xsym               LDQ     X
         4 003343   000050 402007                    MPY     40,DL
         4 003344   040000 100506                    MLR     fill='040'O
         4 003345   000001 400026                    ADSC9   1,Q,PR0                  cn=2,n=22
         4 003346   000132 000026 0                  ADSC9   RLINE                    cn=0,n=22

      955     4211    5                   CALL BINCHAR_SUP(RLINE.LO_SZ, RECS.LO_SZ(X), 5);

   4211  4 003347   000010 236000 5                  LDQ     8
         4 003350   002303 756000 0                  STQ     @NUMFLD+1
         4 003351   000000 236000 xsym               LDQ     X
         4 003352   000025 736000                    QLS     21
         4 003353   000002 036003                    ADLQ    2,DU
         4 003354   000003 036000 0                  ADLQ    RECS$
         4 003355   002302 756000 0                  STQ     @CHRFLD+1
         4 003356   000126 236000 5                  LDQ     86
         4 003357   002301 756000 0                  STQ     @LEN+2
         4 003360   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003361   000000 011000                    NOP     0

      956     4212    5                   IF RECS.LO_SZ(X) ~= RECS.HI_SZ(X)

   4212  4 003362   000000 235000 xsym               LDA     X
         4 003363   000003 735000                    ALS     3
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:149  
         4 003364   000003 470400 0                  LDP0    RECS$
         4 003365   000002 236105                    LDQ     2,AL,PR0
         4 003366   000003 116105                    CMPQ    3,AL,PR0
         4 003367   003404 600000 4                  TZE     s:4214

      957     4213    5                   THEN CALL BINCHAR_SUP(RLINE.HI_SZ, RECS.HI_SZ(X), 5);

   4213  4 003370   000010 236000 5                  LDQ     8
         4 003371   002303 756000 0                  STQ     @NUMFLD+1
         4 003372   000000 236000 xsym               LDQ     X
         4 003373   000025 736000                    QLS     21
         4 003374   000003 036003                    ADLQ    3,DU
         4 003375   000003 036000 0                  ADLQ    RECS$
         4 003376   002302 756000 0                  STQ     @CHRFLD+1
         4 003377   000127 236000 5                  LDQ     87
         4 003400   002301 756000 0                  STQ     @LEN+2
         4 003401   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003402   000000 011000                    NOP     0
         4 003403   003407 710000 4                  TRA     s:4215

      958     4214    5                   ELSE RLINE.HI_SZ = ' ';

   4214  4 003404   040000 100400                    MLR     fill='040'O
         4 003405   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 003406   000140 600005 0                  ADSC9   RLINE+6                  cn=3,n=5

      959     4215    5                   CALL BINCHAR_SUP(RLINE.NO_OF_RECS,RECS.NO_OF_RECS(X),12);

   4215  4 003407   000131 236000 5                  LDQ     89
         4 003410   002303 756000 0                  STQ     @NUMFLD+1
         4 003411   000000 236000 xsym               LDQ     X
         4 003412   000025 736000                    QLS     21
         4 003413   000003 036000 0                  ADLQ    RECS$
         4 003414   002302 756000 0                  STQ     @CHRFLD+1
         4 003415   000132 236000 5                  LDQ     90
         4 003416   002301 756000 0                  STQ     @LEN+2
         4 003417   005360 701000 4                  TSX1    BINCHAR_SUP
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:150  
         4 003420   000000 011000                    NOP     0

      960     4216    5                   CALL BINCHAR_SUP(RLINE.TOT_SZ,RECS.TOT_SZ(X), 12);

   4216  4 003421   000131 236000 5                  LDQ     89
         4 003422   002303 756000 0                  STQ     @NUMFLD+1
         4 003423   000000 236000 xsym               LDQ     X
         4 003424   000025 736000                    QLS     21
         4 003425   000001 036003                    ADLQ    1,DU
         4 003426   000003 036000 0                  ADLQ    RECS$
         4 003427   002302 756000 0                  STQ     @CHRFLD+1
         4 003430   000133 236000 5                  LDQ     91
         4 003431   002301 756000 0                  STQ     @LEN+2
         4 003432   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003433   000000 011000                    NOP     0

      961     4217    5                   CALL BINCHAR_SUP(RLINE.LO_DBKEY,RECS.LO_DBKEY(X),12);

   4217  4 003434   000131 236000 5                  LDQ     89
         4 003435   002303 756000 0                  STQ     @NUMFLD+1
         4 003436   000000 236000 xsym               LDQ     X
         4 003437   000025 736000                    QLS     21
         4 003440   000004 036003                    ADLQ    4,DU
         4 003441   000003 036000 0                  ADLQ    RECS$
         4 003442   002302 756000 0                  STQ     @CHRFLD+1
         4 003443   000134 236000 5                  LDQ     92
         4 003444   002301 756000 0                  STQ     @LEN+2
         4 003445   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003446   000000 011000                    NOP     0

      962     4218    5                   CALL BINCHAR_SUP(RLINE.HI_DBKEY,RECS.HI_DBKEY(X),12);

   4218  4 003447   000131 236000 5                  LDQ     89
         4 003450   002303 756000 0                  STQ     @NUMFLD+1
         4 003451   000000 236000 xsym               LDQ     X
         4 003452   000025 736000                    QLS     21
         4 003453   000005 036003                    ADLQ    5,DU
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:151  
         4 003454   000003 036000 0                  ADLQ    RECS$
         4 003455   002302 756000 0                  STQ     @CHRFLD+1
         4 003456   000135 236000 5                  LDQ     93
         4 003457   002301 756000 0                  STQ     @LEN+2
         4 003460   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003461   000000 011000                    NOP     0

      963     4219    5                   CALL WRIT(RLINE,80);

   4219  4 003462   000136 237000 5                  LDAQ    94
         4 003463   002276 757000 0                  STAQ    NUM_PGS+2
         4 003464   005301 701000 4                  TSX1    WRIT
         4 003465   000000 011000                    NOP     0

      964     4220    5                   END;

      965     4221    4               END;

      966     4222    3           END;

   4222  4 003466   000000 054000 xsym               AOS     X
         4 003467   000000 236000 xsym               LDQ     X
         4 003470   000000 116000 xsym               CMPQ    NO_RECS
         4 003471   003221 604000 4                  TMI     s:4190
         4 003472   003735 710000 4                  TRA     s:4268

      967     4223    2       ELSE /* If 'RECORDS=' clause specified */
      968     4224    3       DO X = 0 TO RCNT; /* report only those records specified */

   4224  4 003473   000000 450000 xsym               STZ     X
         4 003474   003732 710000 4                  TRA     s:4259+1

      969     4225    3           RLINE.REC_NAME = RECORD_LIST.NAME(X);

   4225  4 003475   000000 235000 xsym               LDA     X
         4 003476   000005 735000                    ALS     5
         4 003477   040000 100405                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:152  
         4 003500   000000 000026 xsym               ADSC9   RECORD_LIST,A            cn=0,n=22
         4 003501   000132 000026 0                  ADSC9   RLINE                    cn=0,n=22

      970     4226    4           IF RECS.NO_OF_RECS(X) = 0 THEN DO;

   4226  4 003502   000000 236000 xsym               LDQ     X
         4 003503   000003 736000                    QLS     3
         4 003504   000003 470400 0                  LDP0    RECS$
         4 003505   000000 235106                    LDA     0,QL,PR0
         4 003506   003532 601000 4                  TNZ     s:4235

      971     4227    4               RLINE.LO_SZ = '    0';

   4227  4 003507   040000 100400                    MLR     fill='040'O
         4 003510   000013 000005 3                  ADSC9   11                       cn=0,n=5
         4 003511   000137 400005 0                  ADSC9   RLINE+5                  cn=2,n=5

      972     4228    4               RLINE.HI_SZ = '     ';

   4228  4 003512   040000 100400                    MLR     fill='040'O
         4 003513   000015 000005 3                  ADSC9   13                       cn=0,n=5
         4 003514   000140 600005 0                  ADSC9   RLINE+6                  cn=3,n=5

      973     4229    4               RLINE.NO_OF_RECS = '           0';

   4229  4 003515   040000 100400                    MLR     fill='040'O
         4 003516   000017 000014 3                  ADSC9   15                       cn=0,n=12
         4 003517   000142 000014 0                  ADSC9   RLINE+8                  cn=0,n=12

      974     4230    4               RLINE.TOT_SZ = '           0';

   4230  4 003520   040000 100400                    MLR     fill='040'O
         4 003521   000017 000014 3                  ADSC9   15                       cn=0,n=12
         4 003522   000145 000014 0                  ADSC9   RLINE+11                 cn=0,n=12

      975     4231    4               RLINE.LO_DBKEY = '           0';

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:153  
   4231  4 003523   040000 100400                    MLR     fill='040'O
         4 003524   000017 000014 3                  ADSC9   15                       cn=0,n=12
         4 003525   000150 000014 0                  ADSC9   RLINE+14                 cn=0,n=12

      976     4232    4               RLINE.HI_DBKEY = '           0';

   4232  4 003526   040000 100400                    MLR     fill='040'O
         4 003527   000017 000014 3                  ADSC9   15                       cn=0,n=12
         4 003530   000153 000014 0                  ADSC9   RLINE+17                 cn=0,n=12

      977     4233    4               END;

   4233  4 003531   003725 710000 4                  TRA     s:4258

      978     4234    4           ELSE DO;

      979     4235    4               IF NEED_SUMMARY = '1'B THEN

   4235  4 003532   000302 234000 0                  SZN     NEED_SUMMARY
         4 003533   003601 605000 4                  TPL     s:4247

      980     4236    5               DO;

      981     4237    5                   IF RECS.LO_SZ(X) < DB_RECS.LO_SZ(X)

   4237  4 003534   000312 471400 0                  LDP1    DB_RECS$
         4 003535   000000 620006                    EAX0    0,QL
         4 003536   000002 236110                    LDQ     2,X0,PR0
         4 003537   100002 116110                    CMPQ    2,X0,PR1
         4 003540   003542 603000 4                  TRC     s:4239

      982     4238    5                   THEN DB_RECS.LO_SZ(X) = RECS.LO_SZ(X);

   4238  4 003541   100002 756110                    STQ     2,X0,PR1

      983     4239    5                   IF RECS.HI_SZ(X) > DB_RECS.HI_SZ(X)

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:154  
   4239  4 003542   000000 235000 xsym               LDA     X
         4 003543   000003 735000                    ALS     3
         4 003544   000003 470400 0                  LDP0    RECS$
         4 003545   100003 236105                    LDQ     3,AL,PR1
         4 003546   000003 116105                    CMPQ    3,AL,PR0
         4 003547   003553 603000 4                  TRC     s:4241

      984     4240    5                   THEN DB_RECS.HI_SZ(X) = RECS.HI_SZ(X);

   4240  4 003550   000000 620005                    EAX0    0,AL
         4 003551   000003 235105                    LDA     3,AL,PR0
         4 003552   100003 755110                    STA     3,X0,PR1

      985     4241    5                   DB_RECS.TOT_SZ(X) = DB_RECS.TOT_SZ(X) + RECS.TOT_SZ(X);

   4241  4 003553   000000 235000 xsym               LDA     X
         4 003554   000003 735000                    ALS     3
         4 003555   000003 470400 0                  LDP0    RECS$
         4 003556   100001 236105                    LDQ     1,AL,PR1
         4 003557   000001 036105                    ADLQ    1,AL,PR0
         4 003560   100001 756105                    STQ     1,AL,PR1

      986     4242    5                   IF RECS.LO_DBKEY(X) < DB_RECS.LO_DBKEY(X)

   4242  4 003561   000000 235000 xsym               LDA     X
         4 003562   000003 735000                    ALS     3
         4 003563   000003 470400 0                  LDP0    RECS$
         4 003564   000004 236105                    LDQ     4,AL,PR0
         4 003565   100004 116105                    CMPQ    4,AL,PR1
         4 003566   003570 603000 4                  TRC     s:4244

      987     4243    5                   THEN DB_RECS.LO_DBKEY(X) = RECS.LO_DBKEY(X);

   4243  4 003567   100004 756105                    STQ     4,AL,PR1

      988     4244    5                   IF RECS.HI_DBKEY(X) > DB_RECS.HI_DBKEY(X)

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:155  
   4244  4 003570   000000 235000 xsym               LDA     X
         4 003571   000003 735000                    ALS     3
         4 003572   000003 470400 0                  LDP0    RECS$
         4 003573   100005 236105                    LDQ     5,AL,PR1
         4 003574   000005 116105                    CMPQ    5,AL,PR0
         4 003575   003601 603000 4                  TRC     s:4247

      989     4245    5                   THEN DB_RECS.HI_DBKEY(X) = RECS.HI_DBKEY(X);

   4245  4 003576   000000 620005                    EAX0    0,AL
         4 003577   000005 235105                    LDA     5,AL,PR0
         4 003600   100005 755110                    STA     5,X0,PR1

      990     4246    5                   END;

      991     4247    4               AREA_TOT_RECS = AREA_TOT_RECS + RECS.NO_OF_RECS(X);

   4247  4 003601   000000 235000 xsym               LDA     X
         4 003602   000003 735000                    ALS     3
         4 003603   000003 470400 0                  LDP0    RECS$
         4 003604   000252 236000 0                  LDQ     AREA_TOT_RECS
         4 003605   000000 036105                    ADLQ    0,AL,PR0
         4 003606   000252 756000 0                  STQ     AREA_TOT_RECS

      992     4248    4               AREA_TOT_SZ = AREA_TOT_SZ + RECS.TOT_SZ(X);

   4248  4 003607   000251 236000 0                  LDQ     AREA_TOT_SZ
         4 003610   000001 036105                    ADLQ    1,AL,PR0
         4 003611   000251 756000 0                  STQ     AREA_TOT_SZ

      993     4249    4               CALL BINCHAR_SUP(RLINE.LO_SZ, RECS.LO_SZ(X), 5);

   4249  4 003612   000010 236000 5                  LDQ     8
         4 003613   002303 756000 0                  STQ     @NUMFLD+1
         4 003614   000000 236000 xsym               LDQ     X
         4 003615   000025 736000                    QLS     21
         4 003616   000002 036003                    ADLQ    2,DU
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:156  
         4 003617   000003 036000 0                  ADLQ    RECS$
         4 003620   002302 756000 0                  STQ     @CHRFLD+1
         4 003621   000126 236000 5                  LDQ     86
         4 003622   002301 756000 0                  STQ     @LEN+2
         4 003623   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003624   000000 011000                    NOP     0

      994     4250    4               IF RECS.LO_SZ(X) ~= RECS.HI_SZ(X)

   4250  4 003625   000000 235000 xsym               LDA     X
         4 003626   000003 735000                    ALS     3
         4 003627   000003 470400 0                  LDP0    RECS$
         4 003630   000002 236105                    LDQ     2,AL,PR0
         4 003631   000003 116105                    CMPQ    3,AL,PR0
         4 003632   003647 600000 4                  TZE     s:4252

      995     4251    4               THEN CALL BINCHAR_SUP(RLINE.HI_SZ, RECS.HI_SZ(X), 5);

   4251  4 003633   000010 236000 5                  LDQ     8
         4 003634   002303 756000 0                  STQ     @NUMFLD+1
         4 003635   000000 236000 xsym               LDQ     X
         4 003636   000025 736000                    QLS     21
         4 003637   000003 036003                    ADLQ    3,DU
         4 003640   000003 036000 0                  ADLQ    RECS$
         4 003641   002302 756000 0                  STQ     @CHRFLD+1
         4 003642   000127 236000 5                  LDQ     87
         4 003643   002301 756000 0                  STQ     @LEN+2
         4 003644   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003645   000000 011000                    NOP     0
         4 003646   003652 710000 4                  TRA     s:4253

      996     4252    4               ELSE RLINE.HI_SZ = ' ';

   4252  4 003647   040000 100400                    MLR     fill='040'O
         4 003650   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 003651   000140 600005 0                  ADSC9   RLINE+6                  cn=3,n=5

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:157  
      997     4253    4               CALL BINCHAR_SUP(RLINE.NO_OF_RECS,RECS.NO_OF_RECS(X),12);

   4253  4 003652   000131 236000 5                  LDQ     89
         4 003653   002303 756000 0                  STQ     @NUMFLD+1
         4 003654   000000 236000 xsym               LDQ     X
         4 003655   000025 736000                    QLS     21
         4 003656   000003 036000 0                  ADLQ    RECS$
         4 003657   002302 756000 0                  STQ     @CHRFLD+1
         4 003660   000132 236000 5                  LDQ     90
         4 003661   002301 756000 0                  STQ     @LEN+2
         4 003662   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003663   000000 011000                    NOP     0

      998     4254    4               CALL BINCHAR_SUP(RLINE.TOT_SZ,RECS.TOT_SZ(X),12);

   4254  4 003664   000131 236000 5                  LDQ     89
         4 003665   002303 756000 0                  STQ     @NUMFLD+1
         4 003666   000000 236000 xsym               LDQ     X
         4 003667   000025 736000                    QLS     21
         4 003670   000001 036003                    ADLQ    1,DU
         4 003671   000003 036000 0                  ADLQ    RECS$
         4 003672   002302 756000 0                  STQ     @CHRFLD+1
         4 003673   000133 236000 5                  LDQ     91
         4 003674   002301 756000 0                  STQ     @LEN+2
         4 003675   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003676   000000 011000                    NOP     0

      999     4255    4               CALL BINCHAR_SUP(RLINE.LO_DBKEY,RECS.LO_DBKEY(X),12);

   4255  4 003677   000131 236000 5                  LDQ     89
         4 003700   002303 756000 0                  STQ     @NUMFLD+1
         4 003701   000000 236000 xsym               LDQ     X
         4 003702   000025 736000                    QLS     21
         4 003703   000004 036003                    ADLQ    4,DU
         4 003704   000003 036000 0                  ADLQ    RECS$
         4 003705   002302 756000 0                  STQ     @CHRFLD+1
         4 003706   000134 236000 5                  LDQ     92
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:158  
         4 003707   002301 756000 0                  STQ     @LEN+2
         4 003710   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003711   000000 011000                    NOP     0

     1000     4256    4               CALL BINCHAR_SUP(RLINE.HI_DBKEY,RECS.HI_DBKEY(X),12);

   4256  4 003712   000131 236000 5                  LDQ     89
         4 003713   002303 756000 0                  STQ     @NUMFLD+1
         4 003714   000000 236000 xsym               LDQ     X
         4 003715   000025 736000                    QLS     21
         4 003716   000005 036003                    ADLQ    5,DU
         4 003717   000003 036000 0                  ADLQ    RECS$
         4 003720   002302 756000 0                  STQ     @CHRFLD+1
         4 003721   000135 236000 5                  LDQ     93
         4 003722   002301 756000 0                  STQ     @LEN+2
         4 003723   005360 701000 4                  TSX1    BINCHAR_SUP
         4 003724   000000 011000                    NOP     0

     1001     4257    4               END;

     1002     4258    3           CALL WRIT(RLINE,80);

   4258  4 003725   000136 237000 5                  LDAQ    94
         4 003726   002276 757000 0                  STAQ    NUM_PGS+2
         4 003727   005301 701000 4                  TSX1    WRIT
         4 003730   000000 011000                    NOP     0

     1003     4259    3           END;

   4259  4 003731   000000 054000 xsym               AOS     X
         4 003732   000000 236000 xsym               LDQ     X
         4 003733   000000 116000 xsym               CMPQ    RCNT
         4 003734   003475 604400 4                  TMOZ    s:4225

     1004     4260
     1005     4261        /*
     1006     4262             If 'REC=' was not specified
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:159  
     1007     4263                then
     1008     4264                    report subtotals and
     1009     4265                    report overhead usage.
     1010     4266                                                                           */
     1011     4267
     1012     4268    3       IF RCNT = -1 THEN DO;

   4268  4 003735   000000 235000 xsym               LDA     RCNT
         4 003736   000013 115000 5                  CMPA    11
         4 003737   004533 601000 4                  TNZ     s:4372

     1013     4269    3           IF (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS > 1) THEN

   4269  4 003740   400000 220003                    LDX0    -131072,DU
         4 003741   000026 236000 xsym               LDQ     ZI$DIR+22
         4 003742   400000 316007                    CANQ    -131072,DL
         4 003743   003745 601000 4                  TNZ     s:4269+5
         4 003744   000000 220003                    LDX0    0,DU
         4 003745   400000 221003                    LDX1    -131072,DU
         4 003746   000000 235000 xsym               LDA     NO_AREAS
         4 003747   000001 115007                    CMPA    1,DL
         4 003750   003752 605400 4                  TPNZ    s:4269+10
         4 003751   000000 221003                    LDX1    0,DU
         4 003752   000000 636011                    EAQ     0,X1
         4 003753   002352 756000 0                  STQ     J+1
         4 003754   000000 636010                    EAQ     0,X0
         4 003755   002352 376000 0                  ANQ     J+1
         4 003756   004025 600000 4                  TZE     s:4284

     1014     4270    4           DO;

     1015     4271    4               IF OA.LO_SZ < DB_OA.LO_SZ THEN DB_OA.LO_SZ = OA.LO_SZ;

   4271  4 003757   000245 236000 0                  LDQ     OA
         4 003760   000634 116000 0                  CMPQ    DB_OA
         4 003761   003763 603000 4                  TRC     s:4272

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:160  
   4271  4 003762   000634 756000 0                  STQ     DB_OA

     1016     4272    4               IF OA.HI_SZ > DB_OA.HI_SZ THEN DB_OA.HI_SZ = OA.HI_SZ;

   4272  4 003763   000635 236000 0                  LDQ     DB_OA+1
         4 003764   000246 116000 0                  CMPQ    OA+1
         4 003765   003770 603000 4                  TRC     s:4273

   4272  4 003766   000246 235000 0                  LDA     OA+1
         4 003767   000635 755000 0                  STA     DB_OA+1

     1017     4273    4               DB_OA.TOT_SZ = DB_OA.TOT_SZ + OA.TOT_SZ;

   4273  4 003770   000636 236000 0                  LDQ     DB_OA+2
         4 003771   000247 036000 0                  ADLQ    OA+2
         4 003772   000636 756000 0                  STQ     DB_OA+2

     1018     4274    4               IF CALC_REC.NO_OF_RECS > 0 THEN /* *CALC EXIST */

   4274  4 003773   000004 235000 0                  LDA     CALC_REC
         4 003774   004025 600000 4                  TZE     s:4284

     1019     4275    5               DO;

     1020     4276    5                   IF CALC_REC.LO_SZ < DB_CALC_REC.LO_SZ THEN DB_CALC_REC.LO_SZ =
              4276                            CALC_REC.LO_SZ;

   4276  4 003775   000006 236000 0                  LDQ     CALC_REC+2
         4 003776   000641 116000 0                  CMPQ    DB_CALC_REC+2
         4 003777   004001 603000 4                  TRC     s:4277

   4276  4 004000   000641 756000 0                  STQ     DB_CALC_REC+2

     1021     4277    5                   IF CALC_REC.HI_SZ > DB_CALC_REC.HI_SZ THEN DB_CALC_REC.HI_SZ =
              4277                            CALC_REC.HI_SZ;

   4277  4 004001   000642 236000 0                  LDQ     DB_CALC_REC+3
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:161  
         4 004002   000007 116000 0                  CMPQ    CALC_REC+3
         4 004003   004006 603000 4                  TRC     s:4278

   4277  4 004004   000007 235000 0                  LDA     CALC_REC+3
         4 004005   000642 755000 0                  STA     DB_CALC_REC+3

     1022     4278    5                   DB_CALC_REC.TOT_SZ = DB_CALC_REC.TOT_SZ + CALC_REC.TOT_SZ;

   4278  4 004006   000640 236000 0                  LDQ     DB_CALC_REC+1
         4 004007   000005 036000 0                  ADLQ    CALC_REC+1
         4 004010   000640 756000 0                  STQ     DB_CALC_REC+1

     1023     4279    5                   IF CALC_REC.LO_DBKEY < DB_CALC_REC.LO_DBKEY THEN DB_CALC_REC.
              4279                            LO_DBKEY = CALC_REC.LO_DBKEY;

   4279  4 004011   000010 236000 0                  LDQ     CALC_REC+4
         4 004012   000643 116000 0                  CMPQ    DB_CALC_REC+4
         4 004013   004015 603000 4                  TRC     s:4280

   4279  4 004014   000643 756000 0                  STQ     DB_CALC_REC+4

     1024     4280    5                   IF CALC_REC.HI_DBKEY > DB_CALC_REC.HI_DBKEY THEN DB_CALC_REC.
              4280                            HI_DBKEY = CALC_REC.HI_DBKEY;

   4280  4 004015   000644 236000 0                  LDQ     DB_CALC_REC+5
         4 004016   000011 116000 0                  CMPQ    CALC_REC+5
         4 004017   004022 603000 4                  TRC     s:4281

   4280  4 004020   000011 235000 0                  LDA     CALC_REC+5
         4 004021   000644 755000 0                  STA     DB_CALC_REC+5

     1025     4281    5                   DB_CALC_REC.NO_OF_RECS = DB_CALC_REC.NO_OF_RECS + CALC_REC.
              4281                            NO_OF_RECS;

   4281  4 004022   000637 236000 0                  LDQ     DB_CALC_REC
         4 004023   000004 036000 0                  ADLQ    CALC_REC
         4 004024   000637 756000 0                  STQ     DB_CALC_REC
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:162  

     1026     4282    5                   END;

     1027     4283    4               END;

     1028     4284    3           CALL WRIT(PF1,56);

   4284  4 004025   000142 237000 5                  LDAQ    98
         4 004026   002276 757000 0                  STAQ    NUM_PGS+2
         4 004027   005301 701000 4                  TSX1    WRIT
         4 004030   000000 011000                    NOP     0

     1029     4285    3           CALL BINCHAR_SUP(PF2.AREA_TOT_RECS,AREA_TOT_RECS,12);

   4285  4 004031   000144 237000 5                  LDAQ    100
         4 004032   002302 757000 0                  STAQ    @CHRFLD+1
         4 004033   000141 236000 5                  LDQ     97
         4 004034   002301 756000 0                  STQ     @LEN+2
         4 004035   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004036   000000 011000                    NOP     0

     1030     4286    3           CALL BINCHAR_SUP(PF2.AREA_TOT_SZ,AREA_TOT_SZ,12);

   4286  4 004037   000146 237000 5                  LDAQ    102
         4 004040   002302 757000 0                  STAQ    @CHRFLD+1
         4 004041   000150 236000 5                  LDQ     104
         4 004042   002301 756000 0                  STQ     @LEN+2
         4 004043   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004044   000000 011000                    NOP     0

     1031     4287    3           PF2.MSG = ' = SUBTOTALS FOR ';

   4287  4 004045   040000 100400                    MLR     fill='040'O
         4 004046   000022 000021 3                  ADSC9   18                       cn=0,n=17
         4 004047   000212 000021 0                  ADSC9   PF2+14                   cn=0,n=17

     1032     4288    3           CALL WRIT(PF2,80);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:163  

   4288  4 004050   000152 237000 5                  LDAQ    106
         4 004051   002276 757000 0                  STAQ    NUM_PGS+2
         4 004052   005301 701000 4                  TSX1    WRIT
         4 004053   000000 011000                    NOP     0

     1033     4289         /* call BMAP routine in MRL to convert the integer to real */
     1034     4290    3           CALL FLOAT (AREA_TOT_SZ,AREA_SZ_REAL);

   4290  4 004054   000154 630400 5                  EPPR0   108
         4 004055   000002 631400 5                  EPPR1   2
         4 004056   000000 701000 xent               TSX1    FLOAT
         4 004057   000000 011000                    NOP     0

     1035     4291    3           CALL FLOAT (100,REAL100);

   4291  4 004060   000157 630400 5                  EPPR0   111
         4 004061   000002 631400 5                  EPPR1   2
         4 004062   000000 701000 xent               TSX1    FLOAT
         4 004063   000000 011000                    NOP     0

     1036     4292         /* calculate (AREA_TOT_SZ * 100) */
     1037     4293    3           CALL FLOAT_MPY (AREA_SZ_REAL,REAL100,MPY_RSLT1_REAL);

   4293  4 004064   000162 630400 5                  EPPR0   114
         4 004065   000161 631400 5                  EPPR1   113
         4 004066   000000 701000 xent               TSX1    FLOAT_MPY
         4 004067   000000 011000                    NOP     0

     1038     4294         /* call BMAP routine to convert the integer to real */
     1039     4295    3           CALL FLOAT (NUM_PGS_REPORTED,NUM_PGS_REPORTED_REAL);

   4295  4 004070   000165 630400 5                  EPPR0   117
         4 004071   000002 631400 5                  EPPR1   2
         4 004072   000000 701000 xent               TSX1    FLOAT
         4 004073   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:164  
     1040     4296    3           CALL FLOAT (4072,REAL4072);

   4296  4 004074   000170 630400 5                  EPPR0   120
         4 004075   000002 631400 5                  EPPR1   2
         4 004076   000000 701000 xent               TSX1    FLOAT
         4 004077   000000 011000                    NOP     0

     1041     4297         /* calculate (NUM_PGS_REPORTED * 4072) */
     1042     4298    3           CALL FLOAT_MPY (NUM_PGS_REPORTED_REAL,REAL4072,MPY_RSLT2_REAL);

   4298  4 004100   000172 630400 5                  EPPR0   122
         4 004101   000161 631400 5                  EPPR1   113
         4 004102   000000 701000 xent               TSX1    FLOAT_MPY
         4 004103   000000 011000                    NOP     0

     1043     4299         /* call BMAP routine to convert the integer to real */
     1044     4300    3           CALL FLOAT (OA.TOT_SZ,OA_SZ_REAL);

   4300  4 004104   000175 630400 5                  EPPR0   125
         4 004105   000002 631400 5                  EPPR1   2
         4 004106   000000 701000 xent               TSX1    FLOAT
         4 004107   000000 011000                    NOP     0

     1045     4301         /* calculate (MPY_RSLT2_REAL-OA_SZ_REAL) */
     1046     4302    3           CALL FLOAT_SUB (MPY_RSLT2_REAL,OA_SZ_REAL,SUBTRACT_RSLT_REAL);

   4302  4 004110   000177 630400 5                  EPPR0   127
         4 004111   000161 631400 5                  EPPR1   113
         4 004112   000000 701000 xent               TSX1    FLOAT_SUB
         4 004113   000000 011000                    NOP     0

     1047     4303         /* calculate (MPY_RSLT1_REAL/SUBTRACT_RSLT_REAL) */
     1048     4304    3           CALL FLOAT_DIV (MPY_RSLT1_REAL,SUBTRACT_RSLT_REAL,DIV_RSLT_REAL);

   4304  4 004114   000202 630400 5                  EPPR0   130
         4 004115   000161 631400 5                  EPPR1   113
         4 004116   000000 701000 xent               TSX1    FLOAT_DIV
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:165  
         4 004117   000000 011000                    NOP     0

     1049     4305         /* call BMAP routine to convert the real back to integer */
     1050     4306    3           CALL FIX (DIV_RSLT_REAL,PRCNT);

   4306  4 004120   000205 630400 5                  EPPR0   133
         4 004121   000002 631400 5                  EPPR1   2
         4 004122   000000 701000 xent               TSX1    FIX
         4 004123   000000 011000                    NOP     0

     1051     4307    3           CALL BINCHAR_SUP(PF3.PRCNT_LINE.PRCNT_USED,PRCNT,3);

   4307  4 004124   000210 237000 5                  LDAQ    136
         4 004125   002302 757000 0                  STAQ    @CHRFLD+1
         4 004126   000212 236000 5                  LDQ     138
         4 004127   002301 756000 0                  STQ     @LEN+2
         4 004130   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004131   000000 011000                    NOP     0

     1052     4308    3           IF PF3.PRCNT_LINE.PRCNT_USED = '  0'

   4308  4 004132   040000 106400                    CMPC    fill='040'O
         4 004133   000236 600003 0                  ADSC9   PF3+14                   cn=3,n=3
         4 004134   000027 000003 3                  ADSC9   23                       cn=0,n=3
         4 004135   004144 601000 4                  TNZ     s:4313

     1053     4309    4           THEN DO;

     1054     4310    4               PF3.PRCNT_LINE.PRCNT_MSG = 'LESS THAN';

   4310  4 004136   040000 100400                    MLR     fill='040'O
         4 004137   000030 000011 3                  ADSC9   24                       cn=0,n=9
         4 004140   000234 400011 0                  ADSC9   PF3+12                   cn=2,n=9

     1055     4311    4               PF3.PRCNT_LINE.PRCNT_USED = '  1';

   4311  4 004141   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:166  
         4 004142   000033 000003 3                  ADSC9   27                       cn=0,n=3
         4 004143   000236 600003 0                  ADSC9   PF3+14                   cn=3,n=3

     1056     4312    4               END;

     1057     4313    3           CALL WRIT(PF3,80);

   4313  4 004144   000214 237000 5                  LDAQ    140
         4 004145   002276 757000 0                  STAQ    NUM_PGS+2
         4 004146   005301 701000 4                  TSX1    WRIT
         4 004147   000000 011000                    NOP     0

     1058     4314    3           PF3.PRCNT_LINE.PRCNT_MSG = '         ';

   4314  4 004150   040000 100400                    MLR     fill='040'O
         4 004151   000015 000011 3                  ADSC9   13                       cn=0,n=9
         4 004152   000234 400011 0                  ADSC9   PF3+12                   cn=2,n=9

     1059     4315    3           CALL WRIT(BLANK_LINE,1);

   4315  4 004153   000034 237000 5                  LDAQ    28
         4 004154   002276 757000 0                  STAQ    NUM_PGS+2
         4 004155   005301 701000 4                  TSX1    WRIT
         4 004156   000000 011000                    NOP     0

     1060     4316
     1061     4317    3           RLINE.REC_NAME = 'PAGE HEADERS';

   4317  4 004157   040000 100400                    MLR     fill='040'O
         4 004160   000034 000014 3                  ADSC9   28                       cn=0,n=12
         4 004161   000132 000026 0                  ADSC9   RLINE                    cn=0,n=22

     1062     4318    3           RLINE.LO_SZ = '   24';

   4318  4 004162   040000 100400                    MLR     fill='040'O
         4 004163   000037 000005 3                  ADSC9   31                       cn=0,n=5
         4 004164   000137 400005 0                  ADSC9   RLINE+5                  cn=2,n=5
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:167  

     1063     4319    3           RLINE.HI_SZ = ' ';

   4319  4 004165   040000 100400                    MLR     fill='040'O
         4 004166   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 004167   000140 600005 0                  ADSC9   RLINE+6                  cn=3,n=5

     1064     4320    3           CALL BINCHAR_SUP(RLINE.NO_OF_RECS, NUM_PGS_REPORTED,12);

   4320  4 004170   000216 237000 5                  LDAQ    142
         4 004171   002302 757000 0                  STAQ    @CHRFLD+1
         4 004172   000132 236000 5                  LDQ     90
         4 004173   002301 756000 0                  STQ     @LEN+2
         4 004174   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004175   000000 011000                    NOP     0

     1065     4321    3           CALL BINCHAR_SUP(RLINE.TOT_SZ, (NUM_PGS_REPORTED * 24), 12);

   4321  4 004176   000306 236000 0                  LDQ     NUM_PGS_REPORTED
         4 004177   000030 402007                    MPY     24,DL
         4 004200   002355 756000 0                  STQ     J+4
         4 004201   000131 236000 5                  LDQ     89
         4 004202   002303 756000 0                  STQ     @NUMFLD+1
         4 004203   002355 630400 0                  EPPR0   J+4
         4 004204   002302 450400 0                  STP0    @CHRFLD+1
         4 004205   000133 236000 5                  LDQ     91
         4 004206   002301 756000 0                  STQ     @LEN+2
         4 004207   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004210   000000 011000                    NOP     0

     1066     4322    3           RLINE.LO_DBKEY = ' ';

   4322  4 004211   040000 100400                    MLR     fill='040'O
         4 004212   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 004213   000150 000014 0                  ADSC9   RLINE+14                 cn=0,n=12

     1067     4323    3           RLINE.HI_DBKEY = ' ';
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:168  

   4323  4 004214   040000 100400                    MLR     fill='040'O
         4 004215   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 004216   000153 000014 0                  ADSC9   RLINE+17                 cn=0,n=12

     1068     4324    3           CALL WRIT(RLINE,80);

   4324  4 004217   000136 237000 5                  LDAQ    94
         4 004220   002276 757000 0                  STAQ    NUM_PGS+2
         4 004221   005301 701000 4                  TSX1    WRIT
         4 004222   000000 011000                    NOP     0

     1069     4325
     1070     4326    3           RLINE.REC_NAME = 'OFFSET ARRAYS';

   4326  4 004223   040000 100400                    MLR     fill='040'O
         4 004224   000041 000015 3                  ADSC9   33                       cn=0,n=13
         4 004225   000132 000026 0                  ADSC9   RLINE                    cn=0,n=22

     1071     4327
     1072     4328    3           CALL BINCHAR_SUP(RLINE.LO_SZ, OA.LO_SZ, 5);

   4328  4 004226   000220 237000 5                  LDAQ    144
         4 004227   002302 757000 0                  STAQ    @CHRFLD+1
         4 004230   000126 236000 5                  LDQ     86
         4 004231   002301 756000 0                  STQ     @LEN+2
         4 004232   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004233   000000 011000                    NOP     0

     1073     4329    3           IF OA.LO_SZ ~= OA.HI_SZ THEN

   4329  4 004234   000245 236000 0                  LDQ     OA
         4 004235   000246 116000 0                  CMPQ    OA+1
         4 004236   004245 600000 4                  TZE     s:4331

     1074     4330    3               CALL BINCHAR_SUP(RLINE.HI_SZ, OA.HI_SZ, 5);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:169  
   4330  4 004237   000222 237000 5                  LDAQ    146
         4 004240   002302 757000 0                  STAQ    @CHRFLD+1
         4 004241   000127 236000 5                  LDQ     87
         4 004242   002301 756000 0                  STQ     @LEN+2
         4 004243   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004244   000000 011000                    NOP     0

     1075     4331    3           CALL BINCHAR_SUP(RLINE.TOT_SZ, OA.TOT_SZ, 12);

   4331  4 004245   000224 237000 5                  LDAQ    148
         4 004246   002302 757000 0                  STAQ    @CHRFLD+1
         4 004247   000133 236000 5                  LDQ     91
         4 004250   002301 756000 0                  STQ     @LEN+2
         4 004251   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004252   000000 011000                    NOP     0

     1076     4332    3           CALL WRIT(RLINE,80);

   4332  4 004253   000136 237000 5                  LDAQ    94
         4 004254   002276 757000 0                  STAQ    NUM_PGS+2
         4 004255   005301 701000 4                  TSX1    WRIT
         4 004256   000000 011000                    NOP     0

     1077     4333
     1078     4334    3           IF CALC_REC.NO_OF_RECS > 0 THEN /*  PRINT *CALC */

   4334  4 004257   000004 235000 0                  LDA     CALC_REC
         4 004260   004343 600000 4                  TZE     s:4347

     1079     4335    4           DO;

     1080     4336    4               RLINE.REC_NAME = '*CALC';

   4336  4 004261   040000 100400                    MLR     fill='040'O
         4 004262   000001 000005 3                  ADSC9   1                        cn=0,n=5
         4 004263   000132 000026 0                  ADSC9   RLINE                    cn=0,n=22

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:170  
     1081     4337    4               CALL BINCHAR_SUP(RLINE.LO_SZ, CALC_REC.LO_SZ, 5);

   4337  4 004264   000226 237000 5                  LDAQ    150
         4 004265   002302 757000 0                  STAQ    @CHRFLD+1
         4 004266   000126 236000 5                  LDQ     86
         4 004267   002301 756000 0                  STQ     @LEN+2
         4 004270   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004271   000000 011000                    NOP     0

     1082     4338    4               IF CALC_REC.LO_SZ ~= CALC_REC.HI_SZ THEN

   4338  4 004272   000006 236000 0                  LDQ     CALC_REC+2
         4 004273   000007 116000 0                  CMPQ    CALC_REC+3
         4 004274   004304 600000 4                  TZE     s:4340

     1083     4339    4                   CALL BINCHAR_SUP(RLINE.HI_SZ, CALC_REC.HI_SZ, 5);

   4339  4 004275   000230 237000 5                  LDAQ    152
         4 004276   002302 757000 0                  STAQ    @CHRFLD+1
         4 004277   000127 236000 5                  LDQ     87
         4 004300   002301 756000 0                  STQ     @LEN+2
         4 004301   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004302   000000 011000                    NOP     0
         4 004303   004307 710000 4                  TRA     s:4341

     1084     4340    4               ELSE RLINE.HI_SZ = ' ';

   4340  4 004304   040000 100400                    MLR     fill='040'O
         4 004305   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 004306   000140 600005 0                  ADSC9   RLINE+6                  cn=3,n=5

     1085     4341    4               CALL BINCHAR_SUP(RLINE.TOT_SZ, CALC_REC.TOT_SZ, 12);

   4341  4 004307   000232 237000 5                  LDAQ    154
         4 004310   002302 757000 0                  STAQ    @CHRFLD+1
         4 004311   000133 236000 5                  LDQ     91
         4 004312   002301 756000 0                  STQ     @LEN+2
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:171  
         4 004313   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004314   000000 011000                    NOP     0

     1086     4342    4               CALL BINCHAR_SUP(RLINE.LO_DBKEY, CALC_REC.LO_DBKEY, 12);

   4342  4 004315   000234 237000 5                  LDAQ    156
         4 004316   002302 757000 0                  STAQ    @CHRFLD+1
         4 004317   000134 236000 5                  LDQ     92
         4 004320   002301 756000 0                  STQ     @LEN+2
         4 004321   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004322   000000 011000                    NOP     0

     1087     4343    4               CALL BINCHAR_SUP(RLINE.HI_DBKEY, CALC_REC.HI_DBKEY, 12);

   4343  4 004323   000236 237000 5                  LDAQ    158
         4 004324   002302 757000 0                  STAQ    @CHRFLD+1
         4 004325   000135 236000 5                  LDQ     93
         4 004326   002301 756000 0                  STQ     @LEN+2
         4 004327   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004330   000000 011000                    NOP     0

     1088     4344    4               CALL BINCHAR_SUP(RLINE.NO_OF_RECS, CALC_REC.NO_OF_RECS, 12);

   4344  4 004331   000240 237000 5                  LDAQ    160
         4 004332   002302 757000 0                  STAQ    @CHRFLD+1
         4 004333   000132 236000 5                  LDQ     90
         4 004334   002301 756000 0                  STQ     @LEN+2
         4 004335   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004336   000000 011000                    NOP     0

     1089     4345    4               CALL WRIT(RLINE,80);

   4345  4 004337   000136 237000 5                  LDAQ    94
         4 004340   002276 757000 0                  STAQ    NUM_PGS+2
         4 004341   005301 701000 4                  TSX1    WRIT
         4 004342   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:172  
     1090     4346    4               END;

     1091     4347    4           DO X = 0 TO NUM_PA_RECS;

   4347  4 004343   000000 450000 xsym               STZ     X
         4 004344   004515 710000 4                  TRA     s:4365+1

     1092     4348
     1093     4349    4               Y=PA.RECSINDX(X);

   4349  4 004345   000000 236000 xsym               LDQ     X
         4 004346   000005 402007                    MPY     5,DL
         4 004347   001407 236006 0                  LDQ     PA,QL
         4 004350   000022 772000                    QRL     18
         4 004351   000313 756000 0                  STQ     Y

     1094     4350    4               IF RECS.NO_OF_RECS(Y)>0 THEN

   4350  4 004352   000313 235000 0                  LDA     Y
         4 004353   000003 735000                    ALS     3
         4 004354   000003 470400 0                  LDP0    RECS$
         4 004355   000000 235105                    LDA     0,AL,PR0
         4 004356   004514 600000 4                  TZE     s:4365

     1095     4351    5               DO;

     1096     4352    5                   AREA_TOT_RECS = AREA_TOT_RECS + RECS.NO_OF_RECS(Y);

   4352  4 004357   000313 235000 0                  LDA     Y
         4 004360   000003 735000                    ALS     3
         4 004361   000252 236000 0                  LDQ     AREA_TOT_RECS
         4 004362   000000 036105                    ADLQ    0,AL,PR0
         4 004363   000252 756000 0                  STQ     AREA_TOT_RECS

     1097     4353    5                   AREA_TOT_SZ = AREA_TOT_SZ + RECS.TOT_SZ(Y);

   4353  4 004364   000251 236000 0                  LDQ     AREA_TOT_SZ
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:173  
         4 004365   000001 036105                    ADLQ    1,AL,PR0
         4 004366   000251 756000 0                  STQ     AREA_TOT_SZ

     1098     4354    5                   RLINE.REC_NAME = MSTR_REF.NAME(Y);

   4354  4 004367   000313 236000 0                  LDQ     Y
         4 004370   000050 402007                    MPY     40,DL
         4 004371   000000 471400 xsym               LDP1    MSTR$
         4 004372   040000 100506                    MLR     fill='040'O
         4 004373   100001 400026                    ADSC9   1,Q,PR1                  cn=2,n=22
         4 004374   000132 000026 0                  ADSC9   RLINE                    cn=0,n=22

     1099     4355    5                   CALL BINCHAR_SUP(RLINE.LO_SZ, RECS.LO_SZ(Y), 5);

   4355  4 004375   000010 236000 5                  LDQ     8
         4 004376   002303 756000 0                  STQ     @NUMFLD+1
         4 004377   000313 236000 0                  LDQ     Y
         4 004400   000025 736000                    QLS     21
         4 004401   000002 036003                    ADLQ    2,DU
         4 004402   000003 036000 0                  ADLQ    RECS$
         4 004403   002302 756000 0                  STQ     @CHRFLD+1
         4 004404   000126 236000 5                  LDQ     86
         4 004405   002301 756000 0                  STQ     @LEN+2
         4 004406   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004407   000000 011000                    NOP     0

     1100     4356    5                   IF RECS.LO_SZ(Y) ~= RECS.HI_SZ(Y)

   4356  4 004410   000313 235000 0                  LDA     Y
         4 004411   000003 735000                    ALS     3
         4 004412   000003 470400 0                  LDP0    RECS$
         4 004413   000002 236105                    LDQ     2,AL,PR0
         4 004414   000003 116105                    CMPQ    3,AL,PR0
         4 004415   004432 600000 4                  TZE     s:4358

     1101     4357    5                   THEN CALL BINCHAR_SUP(RLINE.HI_SZ, RECS.HI_SZ(Y), 5);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:174  
   4357  4 004416   000010 236000 5                  LDQ     8
         4 004417   002303 756000 0                  STQ     @NUMFLD+1
         4 004420   000313 236000 0                  LDQ     Y
         4 004421   000025 736000                    QLS     21
         4 004422   000003 036003                    ADLQ    3,DU
         4 004423   000003 036000 0                  ADLQ    RECS$
         4 004424   002302 756000 0                  STQ     @CHRFLD+1
         4 004425   000127 236000 5                  LDQ     87
         4 004426   002301 756000 0                  STQ     @LEN+2
         4 004427   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004430   000000 011000                    NOP     0
         4 004431   004435 710000 4                  TRA     s:4359

     1102     4358    5                   ELSE RLINE.HI_SZ = ' ';

   4358  4 004432   040000 100400                    MLR     fill='040'O
         4 004433   000015 000001 5                  ADSC9   13                       cn=0,n=1
         4 004434   000140 600005 0                  ADSC9   RLINE+6                  cn=3,n=5

     1103     4359    5                   CALL BINCHAR_SUP(RLINE.NO_OF_RECS,RECS.NO_OF_RECS(Y),12);

   4359  4 004435   000131 236000 5                  LDQ     89
         4 004436   002303 756000 0                  STQ     @NUMFLD+1
         4 004437   000313 236000 0                  LDQ     Y
         4 004440   000025 736000                    QLS     21
         4 004441   000003 036000 0                  ADLQ    RECS$
         4 004442   002302 756000 0                  STQ     @CHRFLD+1
         4 004443   000132 236000 5                  LDQ     90
         4 004444   002301 756000 0                  STQ     @LEN+2
         4 004445   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004446   000000 011000                    NOP     0

     1104     4360    5                   CALL BINCHAR_SUP(RLINE.TOT_SZ,RECS.TOT_SZ(Y),12);

   4360  4 004447   000131 236000 5                  LDQ     89
         4 004450   002303 756000 0                  STQ     @NUMFLD+1
         4 004451   000313 236000 0                  LDQ     Y
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:175  
         4 004452   000025 736000                    QLS     21
         4 004453   000001 036003                    ADLQ    1,DU
         4 004454   000003 036000 0                  ADLQ    RECS$
         4 004455   002302 756000 0                  STQ     @CHRFLD+1
         4 004456   000133 236000 5                  LDQ     91
         4 004457   002301 756000 0                  STQ     @LEN+2
         4 004460   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004461   000000 011000                    NOP     0

     1105     4361    5                   CALL BINCHAR_SUP(RLINE.LO_DBKEY,RECS.LO_DBKEY(Y),12);

   4361  4 004462   000131 236000 5                  LDQ     89
         4 004463   002303 756000 0                  STQ     @NUMFLD+1
         4 004464   000313 236000 0                  LDQ     Y
         4 004465   000025 736000                    QLS     21
         4 004466   000004 036003                    ADLQ    4,DU
         4 004467   000003 036000 0                  ADLQ    RECS$
         4 004470   002302 756000 0                  STQ     @CHRFLD+1
         4 004471   000134 236000 5                  LDQ     92
         4 004472   002301 756000 0                  STQ     @LEN+2
         4 004473   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004474   000000 011000                    NOP     0

     1106     4362    5                   CALL BINCHAR_SUP(RLINE.HI_DBKEY,RECS.HI_DBKEY(Y),12);

   4362  4 004475   000131 236000 5                  LDQ     89
         4 004476   002303 756000 0                  STQ     @NUMFLD+1
         4 004477   000313 236000 0                  LDQ     Y
         4 004500   000025 736000                    QLS     21
         4 004501   000005 036003                    ADLQ    5,DU
         4 004502   000003 036000 0                  ADLQ    RECS$
         4 004503   002302 756000 0                  STQ     @CHRFLD+1
         4 004504   000135 236000 5                  LDQ     93
         4 004505   002301 756000 0                  STQ     @LEN+2
         4 004506   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004507   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:176  
     1107     4363    5                   CALL WRIT(RLINE,80);

   4363  4 004510   000136 237000 5                  LDAQ    94
         4 004511   002276 757000 0                  STAQ    NUM_PGS+2
         4 004512   005301 701000 4                  TSX1    WRIT
         4 004513   000000 011000                    NOP     0

     1108     4364    5                   END;

     1109     4365    4               END;

   4365  4 004514   000000 054000 xsym               AOS     X
         4 004515   000000 236000 xsym               LDQ     X
         4 004516   001406 116000 0                  CMPQ    NUM_PA_RECS
         4 004517   004345 604400 4                  TMOZ    s:4349

     1110     4366
     1111     4367    3          AREA_TOT_RECS = AREA_TOT_RECS + (NUM_PGS_REPORTED * 2) + CALC_REC.NO_OF_RECS
              4367                    ;

   4367  4 004520   000306 236000 0                  LDQ     NUM_PGS_REPORTED
         4 004521   000001 736000                    QLS     1
         4 004522   000252 036000 0                  ADLQ    AREA_TOT_RECS
         4 004523   000004 036000 0                  ADLQ    CALC_REC
         4 004524   000252 756000 0                  STQ     AREA_TOT_RECS

     1112     4368    3           AREA_TOT_SZ = AREA_TOT_SZ + (NUM_PGS_REPORTED * 24) + OA.TOT_SZ + CALC_REC.
              4368                    TOT_SZ;

   4368  4 004525   000306 236000 0                  LDQ     NUM_PGS_REPORTED
         4 004526   000030 402007                    MPY     24,DL
         4 004527   000251 036000 0                  ADLQ    AREA_TOT_SZ
         4 004530   000247 036000 0                  ADLQ    OA+2
         4 004531   000005 036000 0                  ADLQ    CALC_REC+1
         4 004532   000251 756000 0                  STQ     AREA_TOT_SZ

     1113     4369    3           END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:177  

     1114     4370
     1115     4371
     1116     4372    2       CALL WRIT(PF1,56);

   4372  4 004533   000142 237000 5                  LDAQ    98
         4 004534   002276 757000 0                  STAQ    NUM_PGS+2
         4 004535   005301 701000 4                  TSX1    WRIT
         4 004536   000000 011000                    NOP     0

     1117     4373
     1118     4374    2       CALL BINCHAR_SUP(PF2.AREA_TOT_RECS,AREA_TOT_RECS,12);

   4374  4 004537   000144 237000 5                  LDAQ    100
         4 004540   002302 757000 0                  STAQ    @CHRFLD+1
         4 004541   000141 236000 5                  LDQ     97
         4 004542   002301 756000 0                  STQ     @LEN+2
         4 004543   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004544   000000 011000                    NOP     0

     1119     4375    2       CALL BINCHAR_SUP(PF2.AREA_TOT_SZ, AREA_TOT_SZ, 12);

   4375  4 004545   000146 237000 5                  LDAQ    102
         4 004546   002302 757000 0                  STAQ    @CHRFLD+1
         4 004547   000150 236000 5                  LDQ     104
         4 004550   002301 756000 0                  STQ     @LEN+2
         4 004551   005360 701000 4                  TSX1    BINCHAR_SUP
         4 004552   000000 011000                    NOP     0

     1120     4376    2       PF2.MSG = ' =  TOTALS  FOR  ';

   4376  4 004553   040000 100400                    MLR     fill='040'O
         4 004554   000045 000021 3                  ADSC9   37                       cn=0,n=17
         4 004555   000212 000021 0                  ADSC9   PF2+14                   cn=0,n=17

     1121     4377    2       CALL WRIT(PF2,78);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:178  
   4377  4 004556   000244 237000 5                  LDAQ    164
         4 004557   002276 757000 0                  STAQ    NUM_PGS+2
         4 004560   005301 701000 4                  TSX1    WRIT
         4 004561   000000 011000                    NOP     0

     1122     4378         /* call BMAP routine in MRL to convert the integer to real */
     1123     4379    2       CALL FLOAT (AREA_TOT_SZ,AREA_SZ_REAL);

   4379  4 004562   000154 630400 5                  EPPR0   108
         4 004563   000002 631400 5                  EPPR1   2
         4 004564   000000 701000 xent               TSX1    FLOAT
         4 004565   000000 011000                    NOP     0

     1124     4380    2       CALL FLOAT (100,REAL100);

   4380  4 004566   000157 630400 5                  EPPR0   111
         4 004567   000002 631400 5                  EPPR1   2
         4 004570   000000 701000 xent               TSX1    FLOAT
         4 004571   000000 011000                    NOP     0

     1125     4381         /* calculate (AREA_TOT_SZ * 100) */
     1126     4382    2       CALL FLOAT_MPY (AREA_SZ_REAL,REAL100,MPY_RSLT1_REAL);

   4382  4 004572   000162 630400 5                  EPPR0   114
         4 004573   000161 631400 5                  EPPR1   113
         4 004574   000000 701000 xent               TSX1    FLOAT_MPY
         4 004575   000000 011000                    NOP     0

     1127     4383         /* call BMAP routine to convert the integer to real */
     1128     4384    2       CALL FLOAT (NUM_PGS_REPORTED,NUM_PGS_REPORTED_REAL);

   4384  4 004576   000165 630400 5                  EPPR0   117
         4 004577   000002 631400 5                  EPPR1   2
         4 004600   000000 701000 xent               TSX1    FLOAT
         4 004601   000000 011000                    NOP     0

     1129     4385    2       CALL FLOAT (4096,REAL4096);
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:179  

   4385  4 004602   000246 630400 5                  EPPR0   166
         4 004603   000002 631400 5                  EPPR1   2
         4 004604   000000 701000 xent               TSX1    FLOAT
         4 004605   000000 011000                    NOP     0

     1130     4386         /* calculate (NUM_PGS_REPORTED * 4096) */
     1131     4387    2       CALL FLOAT_MPY (NUM_PGS_REPORTED_REAL,REAL4096,MPY_RSLT2_REAL);

   4387  4 004606   000250 630400 5                  EPPR0   168
         4 004607   000161 631400 5                  EPPR1   113
         4 004610   000000 701000 xent               TSX1    FLOAT_MPY
         4 004611   000000 011000                    NOP     0

     1132     4388         /* calculate (MPY_RSLT1_REAL/MPY_RSLT2_REAL) */
     1133     4389    2       CALL FLOAT_DIV (MPY_RSLT1_REAL,MPY_RSLT2_REAL,DIV_RSLT_REAL);

   4389  4 004612   000253 630400 5                  EPPR0   171
         4 004613   000161 631400 5                  EPPR1   113
         4 004614   000000 701000 xent               TSX1    FLOAT_DIV
         4 004615   000000 011000                    NOP     0

     1134     4390         /* call BMAP routine to convert the real back to integer */
     1135     4391    2       CALL FIX (DIV_RSLT_REAL,PRCNT);

   4391  4 004616   000205 630400 5                  EPPR0   133
         4 004617   000002 631400 5                  EPPR1   2
         4 004620   000000 701000 xent               TSX1    FIX
         4 004621   000000 011000                    NOP     0

     1136     4392    2       CALL BINCHAR_SUP(PF3.PRCNT_LINE.PRCNT_USED,PRCNT,3);

   4392  4 004622   000206 237000 5                  LDAQ    134
         4 004623   002302 757000 0                  STAQ    @CHRFLD+1
         4 004624   000212 236000 5                  LDQ     138
         4 004625   002301 756000 0                  STQ     @LEN+2
         4 004626   005360 701000 4                  TSX1    BINCHAR_SUP
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:180  
         4 004627   000000 011000                    NOP     0

     1137     4393    2       IF PF3.PRCNT_LINE.PRCNT_USED = '  0'

   4393  4 004630   040000 106400                    CMPC    fill='040'O
         4 004631   000236 600003 0                  ADSC9   PF3+14                   cn=3,n=3
         4 004632   000027 000003 3                  ADSC9   23                       cn=0,n=3
         4 004633   004642 601000 4                  TNZ     s:4398

     1138     4394    3       THEN DO;

     1139     4395    3           PF3.PRCNT_LINE.PRCNT_MSG = 'LESS THAN';

   4395  4 004634   040000 100400                    MLR     fill='040'O
         4 004635   000030 000011 3                  ADSC9   24                       cn=0,n=9
         4 004636   000234 400011 0                  ADSC9   PF3+12                   cn=2,n=9

     1140     4396    3           PF3.PRCNT_LINE.PRCNT_USED = '  1';

   4396  4 004637   040000 100400                    MLR     fill='040'O
         4 004640   000033 000003 3                  ADSC9   27                       cn=0,n=3
         4 004641   000236 600003 0                  ADSC9   PF3+14                   cn=3,n=3

     1141     4397    3           END;

     1142     4398    2       CALL WRIT(PF3,80);

   4398  4 004642   000214 237000 5                  LDAQ    140
         4 004643   002276 757000 0                  STAQ    NUM_PGS+2
         4 004644   005301 701000 4                  TSX1    WRIT
         4 004645   000000 011000                    NOP     0

     1143     4399    2       PF3.PRCNT_LINE.PRCNT_MSG = '         ';

   4399  4 004646   040000 100400                    MLR     fill='040'O
         4 004647   000015 000011 3                  ADSC9   13                       cn=0,n=9
         4 004650   000234 400011 0                  ADSC9   PF3+12                   cn=2,n=9
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:181  

     1144     4400
     1145     4401    2       IF (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS = 1) THEN

   4401  4 004651   400000 220003                    LDX0    -131072,DU
         4 004652   000026 236000 xsym               LDQ     ZI$DIR+22
         4 004653   400000 316007                    CANQ    -131072,DL
         4 004654   004656 601000 4                  TNZ     s:4401+5
         4 004655   000000 220003                    LDX0    0,DU
         4 004656   400000 221003                    LDX1    -131072,DU
         4 004657   000000 235000 xsym               LDA     NO_AREAS
         4 004660   000001 115007                    CMPA    1,DL
         4 004661   004663 600000 4                  TZE     s:4401+10
         4 004662   000000 221003                    LDX1    0,DU
         4 004663   000000 636011                    EAQ     0,X1
         4 004664   002352 756000 0                  STQ     J+1
         4 004665   000000 636010                    EAQ     0,X0
         4 004666   002352 376000 0                  ANQ     J+1
         4 004667   004700 600000 4                  TZE     s:4408

     1146     4402    3       DO;

     1147     4403    3           CALL WRIT(' ',1);

   4403  4 004670   000256 237000 5                  LDAQ    174
         4 004671   002276 757000 0                  STAQ    NUM_PGS+2
         4 004672   005301 701000 4                  TSX1    WRIT
         4 004673   000000 011000                    NOP     0

     1148     4404    3           CALL WRIT('ONLY 1 INTEGRATED AREA IN THE SCHEMA',36);

   4404  4 004674   000262 237000 5                  LDAQ    178
         4 004675   002276 757000 0                  STAQ    NUM_PGS+2
         4 004676   005301 701000 4                  TSX1    WRIT
         4 004677   000000 011000                    NOP     0

     1149     4405    3           END;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:182  

     1150     4406
     1151     4407
     1152     4408    2       RETURN;

   4408  4 004700   002272 221200 0                  LDX1  ! REC_TABLE+112
         4 004701   000001 702211                    TSX2  ! 1,X1

     1153     4409
     1154     4410    2   END REPORT_RECORD;
     1155     4411
     1156     4412
     1157     4413        /*----------------------------------------------------------------*/
     1158     4414        /*   Called after processing an area, this routine produces a     */
     1159     4415        /*   screen-oriented report of the page statistics accumulated    */
     1160     4416        /*----------------------------------------------------------------*/
     1161     4417    1   REPORT_PAGES: PROC;

   4417  4 004702   002273 741200 0     REPORT_PAGES STX1  ! REC_TABLE+113

     1162     4418
     1163     4419    2   DCL NUM_PGS UBIN WORD ALIGNED;
     1164     4420
     1165     4421    2       DCBSF = DCBNUM(M$LO);

   4421  4 004703   000000 236007 xsym               LDQ     M$LO,DL
         4 004704   000000 620006                    EAX0    0,QL
         4 004705   000000 740000 xsym               STX0    DCBSF

     1166     4422    2       VFCSF = %YES#;

   4422  4 004706   400000 236003                    LDQ     -131072,DU
         4 004707   000000 756000 xsym               STQ     VFCSF

     1167     4423    2       BUFSF = VECTOR(PH0);

   4423  4 004710   000030 237000 5                  LDAQ    24
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:183  
         4 004711   000000 755000 xsym               STA     BUFSF
         4 004712   000001 756000 xsym               STQ     BUFSF+1

     1168     4424    2       BUFLNSF = 62;

   4424  4 004713   000076 235007                    LDA     62,DL
         4 004714   000000 755000 xsym               STA     BUFLNSF

     1169     4425    2       CALL SYS_FUNC_WRIT;

   4425  4 004715   000000 631400 5                  EPPR1   0
         4 004716   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 004717   000000 011000                    NOP     0

     1170     4426    2       CALL WRIT(BLANK_LINE,1);

   4426  4 004720   000034 237000 5                  LDAQ    28
         4 004721   002276 757000 0                  STAQ    NUM_PGS+2
         4 004722   005301 701000 4                  TSX1    WRIT
         4 004723   000000 011000                    NOP     0

     1171     4427    2       CALL WRIT(PH5,48);

   4427  4 004724   000264 237000 5                  LDAQ    180
         4 004725   002276 757000 0                  STAQ    NUM_PGS+2
         4 004726   005301 701000 4                  TSX1    WRIT
         4 004727   000000 011000                    NOP     0

     1172     4428    2       CALL WRIT(PH6,68);

   4428  4 004730   000266 237000 5                  LDAQ    182
         4 004731   002276 757000 0                  STAQ    NUM_PGS+2
         4 004732   005301 701000 4                  TSX1    WRIT
         4 004733   000000 011000                    NOP     0

     1173     4429    2       CALL WRIT(PH7,68);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:184  
   4429  4 004734   000270 237000 5                  LDAQ    184
         4 004735   002276 757000 0                  STAQ    NUM_PGS+2
         4 004736   005301 701000 4                  TSX1    WRIT
         4 004737   000000 011000                    NOP     0

     1174     4430    2       CALL WRIT(PH8,80);

   4430  4 004740   000272 237000 5                  LDAQ    186
         4 004741   002276 757000 0                  STAQ    NUM_PGS+2
         4 004742   005301 701000 4                  TSX1    WRIT
         4 004743   000000 011000                    NOP     0

     1175     4431    2       CALL WRIT(PH9,80);

   4431  4 004744   000274 237000 5                  LDAQ    188
         4 004745   002276 757000 0                  STAQ    NUM_PGS+2
         4 004746   005301 701000 4                  TSX1    WRIT
         4 004747   000000 011000                    NOP     0

     1176     4432    2       CALL WRIT(BLANK_LINE,1);

   4432  4 004750   000034 237000 5                  LDAQ    28
         4 004751   002276 757000 0                  STAQ    NUM_PGS+2
         4 004752   005301 701000 4                  TSX1    WRIT
         4 004753   000000 011000                    NOP     0

     1177     4433    2       NUM_PGS = 0;

   4433  4 004754   002274 450000 0                  STZ     NUM_PGS

     1178     4434
     1179     4435    3       DO X = 0 TO 19;

   4435  4 004755   000000 450000 xsym               STZ     X

     1180     4436    3           PLINE.PRCNT = PGS.PRCNT(X);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:185  
   4436  4 004756   000000 236000 xsym               LDQ     X
         4 004757   000030 402007                    MPY     24,DL
         4 004760   000000 100406                    MLR     fill='000'O
         4 004761   001023 000006 0                  ADSC9   PGS+2,Q                  cn=0,n=6
         4 004762   001010 000006 0                  ADSC9   PLINE+9                  cn=0,n=6

     1181     4437    3           IF NUM_PGS = NUM_PGS_REPORTED * 2 THEN /* Rest is zeroes */

   4437  4 004763   000306 236000 0                  LDQ     NUM_PGS_REPORTED
         4 004764   000001 736000                    QLS     1
         4 004765   002274 116000 0                  CMPQ    NUM_PGS
         4 004766   005011 601000 4                  TNZ     s:4448

     1182     4438    4           DO;

     1183     4439    4               PLINE.PRCNT.HI = '100';

   4439  4 004767   040000 100400                    MLR     fill='040'O
         4 004770   000063 000003 3                  ADSC9   51                       cn=0,n=3
         4 004771   001010 600003 0                  ADSC9   PLINE+9                  cn=3,n=3

     1184     4440    4               PLINE.SNUM = '              0';

   4440  4 004772   040000 100400                    MLR     fill='040'O
         4 004773   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 004774   001011 400017 0                  ADSC9   PLINE+10                 cn=2,n=15

     1185     4441    4               PLINE.DNUM = '              0';

   4441  4 004775   040000 100400                    MLR     fill='040'O
         4 004776   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 004777   000777 000017 0                  ADSC9   PLINE                    cn=0,n=15

     1186     4442    4               PLINE.SPRCNT = '              0';

   4442  4 005000   040000 100400                    MLR     fill='040'O
         4 005001   000064 000017 3                  ADSC9   52                       cn=0,n=15
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:186  
         4 005002   001015 200017 0                  ADSC9   PLINE+14                 cn=1,n=15

     1187     4443    4               PLINE.DPRCNT = '              0';

   4443  4 005003   040000 100400                    MLR     fill='040'O
         4 005004   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 005005   001002 600017 0                  ADSC9   PLINE+3                  cn=3,n=15

     1188     4444    4               X = 20;

   4444  4 005006   000024 235007                    LDA     20,DL
         4 005007   000000 755000 xsym               STA     X

     1189     4445    4               END;

   4445  4 005010   005240 710000 4                  TRA     s:4471

     1190     4446    3           ELSE
     1191     4447    4           DO;

     1192     4448    4               IF PGS.SNUM(X) = 0

   4448  4 005011   000000 236000 xsym               LDQ     X
         4 005012   000006 402007                    MPY     6,DL
         4 005013   001024 235006 0                  LDA     PGS+3,QL
         4 005014   001025 236006 0                  LDQ     PGS+4,QL
         4 005015   000022 773000                    LRL     18
         4 005016   000000 116003                    CMPQ    0,DU
         4 005017   005027 601000 4                  TNZ     s:4454

     1193     4449    5               THEN DO;

     1194     4450    5                   PLINE.SNUM = '              0';

   4450  4 005020   040000 100400                    MLR     fill='040'O
         4 005021   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 005022   001011 400017 0                  ADSC9   PLINE+10                 cn=2,n=15
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:187  

     1195     4451    5                   PLINE.SPRCNT = '              0';

   4451  4 005023   040000 100400                    MLR     fill='040'O
         4 005024   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 005025   001015 200017 0                  ADSC9   PLINE+14                 cn=1,n=15

     1196     4452    5                   END;

   4452  4 005026   005140 710000 4                  TRA     s:4459

     1197     4453    5               ELSE DO;

     1198     4454    5                   NUM_PGS = NUM_PGS + PGS.SNUM(X);

   4454  4 005027   000000 236000 xsym               LDQ     X
         4 005030   000006 402007                    MPY     6,DL
         4 005031   001024 235006 0                  LDA     PGS+3,QL
         4 005032   001025 236006 0                  LDQ     PGS+4,QL
         4 005033   000022 773000                    LRL     18
         4 005034   002274 036000 0                  ADLQ    NUM_PGS
         4 005035   002274 756000 0                  STQ     NUM_PGS

     1199     4455    5                   CALL BINCHAR_SUP(PLINE.SNUM,BITBIN(BINBIT(PGS.SNUM(X),36)),15);

   4455  4 005036   000000 236000 xsym               LDQ     X
         4 005037   000006 402007                    MPY     6,DL
         4 005040   001024 235006 0                  LDA     PGS+3,QL
         4 005041   001025 236006 0                  LDQ     PGS+4,QL
         4 005042   000022 773000                    LRL     18
         4 005043   002356 756000 0                  STQ     J+5
         4 005044   000277 236000 5                  LDQ     191
         4 005045   002303 756000 0                  STQ     @NUMFLD+1
         4 005046   002356 630400 0                  EPPR0   J+5
         4 005047   002302 450400 0                  STP0    @CHRFLD+1
         4 005050   000300 236000 5                  LDQ     192
         4 005051   002301 756000 0                  STQ     @LEN+2
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:188  
         4 005052   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005053   000000 011000                    NOP     0

     1200     4456    5                   CALL BINCHAR_SUP(PLINE.SPRCNT,PGS.SNUM(X)*100/NUM_PGS_REPORTED,15);

   4456  4 005054   000000 236000 xsym               LDQ     X
         4 005055   000006 402007                    MPY     6,DL
         4 005056   001024 235006 0                  LDA     PGS+3,QL
         4 005057   001025 236006 0                  LDQ     PGS+4,QL
         4 005060   000022 773000                    LRL     18
         4 005061   000144 402007                    MPY     100,DL
         4 005062   000000 116003                    CMPQ    0,DU
         4 005063   005101 605000 4                  TPL     s:4456+21
         4 005064   000306 235000 0                  LDA     NUM_PGS_REPORTED
         4 005065   005075 604000 4                  TMI     s:4456+17
         4 005066   000001 115007                    CMPA    1,DL
         4 005067   005106 600000 4                  TZE     s:4456+26
         4 005070   000000 235003                    LDA     0,DU
         4 005071   000001 737000                    LLS     1
         4 005072   000306 507000 0                  DVF     NUM_PGS_REPORTED
         4 005073   000044 733000                    LRS     36
         4 005074   005106 710000 4                  TRA     s:4456+26
         4 005075   000306 116000 0                  CMPQ    NUM_PGS_REPORTED
         4 005076   005103 602000 4                  TNC     s:4456+23
         4 005077   000001 236007                    LDQ     1,DL
         4 005100   005106 710000 4                  TRA     s:4456+26
         4 005101   000306 235000 0                  LDA     NUM_PGS_REPORTED
         4 005102   005105 605000 4                  TPL     s:4456+25
         4 005103   000000 236003                    LDQ     0,DU
         4 005104   005106 710000 4                  TRA     s:4456+26
         4 005105   000306 506000 0                  DIV     NUM_PGS_REPORTED
         4 005106   002357 756000 0                  STQ     J+6
         4 005107   000277 236000 5                  LDQ     191
         4 005110   002303 756000 0                  STQ     @NUMFLD+1
         4 005111   002357 630400 0                  EPPR0   J+6
         4 005112   002302 450400 0                  STP0    @CHRFLD+1
         4 005113   000301 236000 5                  LDQ     193
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:189  
         4 005114   002301 756000 0                  STQ     @LEN+2
         4 005115   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005116   000000 011000                    NOP     0

     1201     4457    5                   DB_PGS.SNUM(X) = DB_PGS.SNUM(X) + PGS.SNUM(X);

   4457  4 005117   000000 236000 xsym               LDQ     X
         4 005120   000006 402007                    MPY     6,DL
         4 005121   001024 235006 0                  LDA     PGS+3,QL
         4 005122   000000 620006                    EAX0    0,QL
         4 005123   001025 236006 0                  LDQ     PGS+4,QL
         4 005124   000022 773000                    LRL     18
         4 005125   002352 756000 0                  STQ     J+1
         4 005126   001214 235010 0                  LDA     DB_PGS+3,X0
         4 005127   001215 236010 0                  LDQ     DB_PGS+4,X0
         4 005130   000022 773000                    LRL     18
         4 005131   002352 036000 0                  ADLQ    J+1
         4 005132   002353 756000 0                  STQ     J+2
         4 005133   000000 635010                    EAA     0,X0
         4 005134   000020 731000                    ARS     16
         4 005135   000005 100400                    MLR     fill='000'O
         4 005136   002353 000004 0                  ADSC9   J+2                      cn=0,n=4
         4 005137   001214 400004 0                  ADSC9   DB_PGS+3,A               cn=2,n=4

     1202     4458    5                   END;

     1203     4459    4               IF PGS.DNUM(X) = 0

   4459  4 005140   000000 236000 xsym               LDQ     X
         4 005141   000006 402007                    MPY     6,DL
         4 005142   001021 235006 0                  LDA     PGS,QL
         4 005143   005153 601000 4                  TNZ     s:4465

     1204     4460    5               THEN DO;

     1205     4461    5                   PLINE.DNUM = '              0';

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:190  
   4461  4 005144   040000 100400                    MLR     fill='040'O
         4 005145   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 005146   000777 000017 0                  ADSC9   PLINE                    cn=0,n=15

     1206     4462    5                   PLINE.DPRCNT = '              0';

   4462  4 005147   040000 100400                    MLR     fill='040'O
         4 005150   000064 000017 3                  ADSC9   52                       cn=0,n=15
         4 005151   001002 600017 0                  ADSC9   PLINE+3                  cn=3,n=15

     1207     4463    5                   END;

   4463  4 005152   005240 710000 4                  TRA     s:4471

     1208     4464    5               ELSE DO;

     1209     4465    5                   NUM_PGS = NUM_PGS + PGS.DNUM(X);

   4465  4 005153   001021 236006 0                  LDQ     PGS,QL
         4 005154   002274 036000 0                  ADLQ    NUM_PGS
         4 005155   002274 756000 0                  STQ     NUM_PGS

     1210     4466    5                   CALL BINCHAR_SUP(PLINE.DNUM,PGS.DNUM(X),15);

   4466  4 005156   000277 236000 5                  LDQ     191
         4 005157   002303 756000 0                  STQ     @NUMFLD+1
         4 005160   000000 236000 xsym               LDQ     X
         4 005161   000006 402003                    MPY     6,DU
         4 005162   000302 036000 5                  ADLQ    194
         4 005163   002302 756000 0                  STQ     @CHRFLD+1
         4 005164   000303 236000 5                  LDQ     195
         4 005165   002301 756000 0                  STQ     @LEN+2
         4 005166   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005167   000000 011000                    NOP     0

     1211     4467    5                   CALL BINCHAR_SUP(PLINE.DPRCNT,PGS.DNUM(X)*100/NUM_PGS_REPORTED,15);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:191  
   4467  4 005170   000000 236000 xsym               LDQ     X
         4 005171   000006 402007                    MPY     6,DL
         4 005172   001021 236006 0                  LDQ     PGS,QL
         4 005173   000144 402007                    MPY     100,DL
         4 005174   000000 116003                    CMPQ    0,DU
         4 005175   005213 605000 4                  TPL     s:4467+19
         4 005176   000306 235000 0                  LDA     NUM_PGS_REPORTED
         4 005177   005207 604000 4                  TMI     s:4467+15
         4 005200   000001 115007                    CMPA    1,DL
         4 005201   005220 600000 4                  TZE     s:4467+24
         4 005202   000000 235003                    LDA     0,DU
         4 005203   000001 737000                    LLS     1
         4 005204   000306 507000 0                  DVF     NUM_PGS_REPORTED
         4 005205   000044 733000                    LRS     36
         4 005206   005220 710000 4                  TRA     s:4467+24
         4 005207   000306 116000 0                  CMPQ    NUM_PGS_REPORTED
         4 005210   005215 602000 4                  TNC     s:4467+21
         4 005211   000001 236007                    LDQ     1,DL
         4 005212   005220 710000 4                  TRA     s:4467+24
         4 005213   000306 235000 0                  LDA     NUM_PGS_REPORTED
         4 005214   005217 605000 4                  TPL     s:4467+23
         4 005215   000000 236003                    LDQ     0,DU
         4 005216   005220 710000 4                  TRA     s:4467+24
         4 005217   000306 506000 0                  DIV     NUM_PGS_REPORTED
         4 005220   002360 756000 0                  STQ     J+7
         4 005221   000277 236000 5                  LDQ     191
         4 005222   002303 756000 0                  STQ     @NUMFLD+1
         4 005223   002360 630400 0                  EPPR0   J+7
         4 005224   002302 450400 0                  STP0    @CHRFLD+1
         4 005225   000304 236000 5                  LDQ     196
         4 005226   002301 756000 0                  STQ     @LEN+2
         4 005227   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005230   000000 011000                    NOP     0

     1212     4468    5                   DB_PGS.DNUM(X) = DB_PGS.DNUM(X) + PGS.DNUM(X);

   4468  4 005231   000000 236000 xsym               LDQ     X
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:192  
         4 005232   000006 402007                    MPY     6,DL
         4 005233   000000 620006                    EAX0    0,QL
         4 005234   000000 621006                    EAX1    0,QL
         4 005235   001211 236010 0                  LDQ     DB_PGS,X0
         4 005236   001021 036010 0                  ADLQ    PGS,X0
         4 005237   001211 756011 0                  STQ     DB_PGS,X1

     1213     4469    5                   END;

     1214     4470    4               END;

     1215     4471    3           CALL WRIT(PLINE,72);

   4471  4 005240   000306 237000 5                  LDAQ    198
         4 005241   002276 757000 0                  STAQ    NUM_PGS+2
         4 005242   005301 701000 4                  TSX1    WRIT
         4 005243   000000 011000                    NOP     0

     1216     4472    3           END;

   4472  4 005244   000000 054000 xsym               AOS     X
         4 005245   000000 235000 xsym               LDA     X
         4 005246   000023 115007                    CMPA    19,DL
         4 005247   004756 604400 4                  TMOZ    s:4436

     1217     4473
     1218     4474    2       IF (ZI$DIR.AUTODUMP = '1'B) & (NO_AREAS = 1) THEN

   4474  4 005250   400000 220003                    LDX0    -131072,DU
         4 005251   000026 236000 xsym               LDQ     ZI$DIR+22
         4 005252   400000 316007                    CANQ    -131072,DL
         4 005253   005255 601000 4                  TNZ     s:4474+5
         4 005254   000000 220003                    LDX0    0,DU
         4 005255   400000 221003                    LDX1    -131072,DU
         4 005256   000000 235000 xsym               LDA     NO_AREAS
         4 005257   000001 115007                    CMPA    1,DL
         4 005260   005262 600000 4                  TZE     s:4474+10
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:193  
         4 005261   000000 221003                    LDX1    0,DU
         4 005262   000000 636011                    EAQ     0,X1
         4 005263   002352 756000 0                  STQ     J+1
         4 005264   000000 636010                    EAQ     0,X0
         4 005265   002352 376000 0                  ANQ     J+1
         4 005266   005277 600000 4                  TZE     s:4480

     1219     4475    3       DO;

     1220     4476    3           CALL WRIT(' ',1);

   4476  4 005267   000256 237000 5                  LDAQ    174
         4 005270   002276 757000 0                  STAQ    NUM_PGS+2
         4 005271   005301 701000 4                  TSX1    WRIT
         4 005272   000000 011000                    NOP     0

     1221     4477    3           CALL WRIT('ONLY 1 INTEGRATED AREA IN THE SCHEMA',36);

   4477  4 005273   000262 237000 5                  LDAQ    178
         4 005274   002276 757000 0                  STAQ    NUM_PGS+2
         4 005275   005301 701000 4                  TSX1    WRIT
         4 005276   000000 011000                    NOP     0

     1222     4478    3           END;

     1223     4479
     1224     4480    2       RETURN;

   4480  4 005277   002273 221200 0                  LDX1  ! REC_TABLE+113
         4 005300   000001 702211                    TSX2  ! 1,X1

     1225     4481
     1226     4482    2   END REPORT_PAGES;
     1227     4483
     1228     4484        /*----------------------------------------------------------------*/
     1229     4485        /*   This write routine gets passed a character string and its    */
     1230     4486        /*   length.  It calls sys_func_writ with no vfc.                 */
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:194  
     1231     4487        /*----------------------------------------------------------------*/
     1232     4488    1   WRIT: PROC(BF,LEN);

   4488  4 005301   002275 741200 0     WRIT         STX1  ! NUM_PGS+1

     1233     4489    2   DCL BF CHAR(LEN) ALIGNED;
     1234     4490    2   DCL LEN UBIN(36) ALIGNED;
     1235     4491    2       IF BREAK_FLAG>0 THEN

   4491  4 005302   000000 235000 xsym               LDA     BREAK_FLAG
         4 005303   005334 604400 4                  TMOZ    s:4503

     1236     4492    3       DO;

     1237     4493    3           DCBSF=ZI$DIR.AREA_NM.DCB#;

   4493  4 005304   000244 220000 xsym               LDX0    ZI$DIR+164
         4 005305   000000 740000 xsym               STX0    DCBSF

     1238     4494    3           CALL FREE_TBL(,REPTBL#); /* RELEASE DYNAMIC PAGES */

   4494  4 005306   000010 236000 5                  LDQ     8
         4 005307   000003 235000 5                  LDA     3
         4 005310   002352 757000 0                  STAQ    J+1
         4 005311   002352 630400 0                  EPPR0   J+1
         4 005312   000002 631400 5                  EPPR1   2
         4 005313   000000 701000 xent               TSX1    FREE_TBL
         4 005314   000000 011000                    NOP     0

     1239     4495    3           CALL SYS_FUNC_CLOS;

   4495  4 005315   000000 631400 5                  EPPR1   0
         4 005316   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 005317   000000 011000                    NOP     0

     1240     4496    3           IF XREF_BUILT THEN

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:195  
   4496  4 005320   000000 234000 xsym               SZN     XREF_BUILT
         4 005321   005326 605000 4                  TPL     s:4501

     1241     4497    4           DO;

     1242     4498    4               XREF_BUILT = %NO#;

   4498  4 005322   000000 450000 xsym               STZ     XREF_BUILT

     1243     4499    4               CALL FREE_DYN_MEM;

   4499  4 005323   000000 631400 5                  EPPR1   0
         4 005324   000000 701000 xent               TSX1    FREE_DYN_MEM
         4 005325   000000 011000                    NOP     0

     1244     4500    4               END;

     1245     4501    3           UNWIND TO RESTART;

   4501  4 005326   000000 100600                    MLR   ! fill='000'O
         4 005327   000000 000010 xsym               ADSC9   RESTART                  cn=0,n=8
         4 005330   002352 000010 0                  ADSC9   J+1                      cn=0,n=8
         4 005331   002352 237200 0                  LDAQ  ! J+1
         4 005332   000000 700200 xent               TSX0  ! X66_SUNWIND
         4 005333   000000 000200                    ZERO    0,128

     1246     4502    3           END;
     1247     4503    2       DCBSF = DCBNUM(M$LO);

   4503  4 005334   000000 236007 xsym               LDQ     M$LO,DL
         4 005335   000000 620006                    EAX0    0,QL
         4 005336   000000 740000 xsym               STX0    DCBSF

     1248     4504    2       VFCSF = %NO#;

   4504  4 005337   000000 450000 xsym               STZ     VFCSF

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:196  
     1249     4505    2       BUFSF = VECTOR(BF);

   4505  4 005340   002277 470400 0                  LDP0    @LEN
         4 005341   000000 722100                    LXL2    0,,PR0
         4 005342   000000 636012                    EAQ     0,X2
         4 005343   000022 772000                    QRL     18
         4 005344   000064 737000                    LLS     52
         4 005345   000140 135007                    SBLA    96,DL
         4 005346   002276 236000 0                  LDQ     @BF
         4 005347   000000 755000 xsym               STA     BUFSF
         4 005350   000001 756000 xsym               STQ     BUFSF+1

     1250     4506    2       BUFLNSF = LEN;

   4506  4 005351   000000 235100                    LDA     0,,PR0
         4 005352   000000 755000 xsym               STA     BUFLNSF

     1251     4507    2       CALL SYS_FUNC_WRIT;

   4507  4 005353   000000 631400 5                  EPPR1   0
         4 005354   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 005355   000000 011000                    NOP     0

     1252     4508    2       RETURN;

   4508  4 005356   002275 221200 0                  LDX1  ! NUM_PGS+1
         4 005357   000001 702211                    TSX2  ! 1,X1

     1253     4509    2   END WRIT;
     1254     4510
     1255     4511        /*-----------------------------------------------------------------*/
     1256     4512        /*    This routine converts a numeric value to a zero-suppressed   */
     1257     4513        /*    character string.                                            */
     1258     4514        /*-----------------------------------------------------------------*/
     1259     4515    1   BINCHAR_SUP: PROC(CHRFLD,NUMFLD,LENG);

   4515  4 005360   002300 741200 0     BINCHAR_SUP  STX1  ! @LEN+1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:197  

     1260     4516    2   DCL CHRFLD CHAR(LENG) CALIGNED;
     1261     4517    2   DCL NUMFLD UBIN;
     1262     4518    2   DCL LENG UBIN;
     1263     4519    2       CALL BINCHAR(CHRFLD,NUMFLD);

   4519  4 005361   002303 470400 0                  LDP0    @LENG
         4 005362   000000 720100                    LXL0    0,,PR0
         4 005363   002302 471400 0                  LDP1    @NUMFLD
         4 005364   100000 235100                    LDA     0,,PR1
         4 005365   000044 773000                    LRL     36
         4 005366   002352 757000 0                  STAQ    J+1
         4 005367   002301 473400 0                  LDP3    @CHRFLD
         4 005370   000140 301400                    BTD
         4 005371   002352 000010 0                  NDSC9   J+1                      cn=0,s=lsgnf,sf=0,n=8
         4 005372   300000 030010                    NDSC9   0,,PR3                   cn=0,s=nosgn,sf=0,n=*X0

     1264     4520    2       CALL ZERO_SUP(CHRFLD,LENG,'0'B);

   4520  4 005373   000310 236000 5                  LDQ     200
         4 005374   002354 756000 0                  STQ     J+3
         4 005375   002303 236000 0                  LDQ     @LENG
         4 005376   002301 235000 0                  LDA     @CHRFLD
         4 005377   002352 757000 0                  STAQ    J+1
         4 005400   002352 630400 0                  EPPR0   J+1
         4 005401   000161 631400 5                  EPPR1   113
         4 005402   000000 701000 xent               TSX1    ZERO_SUP
         4 005403   000000 011000                    NOP     0

     1265     4521    2       RETURN;

   4521  4 005404   002300 221200 0                  LDX1  ! @LEN+1
         4 005405   000001 702211                    TSX2  ! 1,X1

     1266     4522    2   END BINCHAR_SUP;
     1267     4523    1   SET_REPORT: PROC;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:198  
   4523  4 005406   002304 741200 0     SET_REPORT   STX1  ! @LENG+1

     1268     4524    2   DCL K SBIN WORD ALIGNED;
     1269     4525    2   DCL MEMINDX SBIN WORD ALIGNED;
     1270     4526    2   DCL SET_OCC SBIN WORD ALIGNED;
     1271     4527    2   DCL OWNER SBIN WORD ALIGNED;
     1272     4528    2   DCL NEXT SBIN WORD ALIGNED;
     1273     4529    2   DCL VALUE SBIN WORD ALIGNED;
     1274     4530    2   DCL LOCS(0:2) CHAR(6) STATIC ALIGNED;
     1275     4531    2   DCL REC_TYPE SBIN HALF ALIGNED;
     1276     4532    2   DCL 1 BLINE STATIC ALIGNED,
     1277     4533    2         2 * CHAR(80) INIT(' ');
     1278     4534    2       LOCS(0) = 'DIRECT';

   4534  4 005407   040000 100400                    MLR     fill='040'O
         4 005410   000070 000006 3                  ADSC9   56                       cn=0,n=6
         4 005411   002313 000006 0                  ADSC9   LOCS                     cn=0,n=6

     1279     4535    2       LOCS(1) = 'VIA   ';

   4535  4 005412   040000 100400                    MLR     fill='040'O
         4 005413   000072 000006 3                  ADSC9   58                       cn=0,n=6
         4 005414   002315 000006 0                  ADSC9   LOCS+2                   cn=0,n=6

     1280     4536    2       LOCS(2) = 'CALC  ';

   4536  4 005415   040000 100400                    MLR     fill='040'O
         4 005416   000074 000006 3                  ADSC9   60                       cn=0,n=6
         4 005417   002317 000006 0                  ADSC9   LOCS+4                   cn=0,n=6

     1281     4537        %EQU XCALC = '*CALC                         ';
     1282     4538
     1283     4539    2       CALL WRIT(PH0, LENGTHC(PH0));

   4539  4 005420   000312 237000 5                  LDAQ    202
         4 005421   002276 757000 0                  STAQ    @BF
         4 005422   005301 701000 4                  TSX1    WRIT
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:199  
         4 005423   000000 011000                    NOP     0

     1284     4540    2       CALL WRIT(OV5, LENGTHC(OV5));

   4540  4 005424   000316 237000 5                  LDAQ    206
         4 005425   002276 757000 0                  STAQ    @BF
         4 005426   005301 701000 4                  TSX1    WRIT
         4 005427   000000 011000                    NOP     0

     1285     4541    2       CALL WRIT(OV5A, LENGTHC(OV5A));

   4541  4 005430   000320 237000 5                  LDAQ    208
         4 005431   002276 757000 0                  STAQ    @BF
         4 005432   005301 701000 4                  TSX1    WRIT
         4 005433   000000 011000                    NOP     0

     1286     4542
     1287     4543    2       CALL WRIT(OV1, LENGTHC(OV1));

   4543  4 005434   000322 237000 5                  LDAQ    210
         4 005435   002276 757000 0                  STAQ    @BF
         4 005436   005301 701000 4                  TSX1    WRIT
         4 005437   000000 011000                    NOP     0

     1288     4544    2       CALL WRIT(OV3, LENGTHC(OV3));

   4544  4 005440   000324 237000 5                  LDAQ    212
         4 005441   002276 757000 0                  STAQ    @BF
         4 005442   005301 701000 4                  TSX1    WRIT
         4 005443   000000 011000                    NOP     0

     1289     4545    2       CALL WRIT(OV3A, LENGTHC(OV3A));

   4545  4 005444   000326 237000 5                  LDAQ    214
         4 005445   002276 757000 0                  STAQ    @BF
         4 005446   005301 701000 4                  TSX1    WRIT
         4 005447   000000 011000                    NOP     0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:200  

     1290     4546    2       K = FIRST_SET;

   4546  4 005450   000000 235000 xsym               LDA     FIRST_SET
         4 005451   002305 755000 0                  STA     K

     1291     4547    2       OV4 = BLINE;

   4547  4 005452   000000 100400                    MLR     fill='000'O
         4 005453   002322 000116 0                  ADSC9   BLINE                    cn=0,n=78
         4 005454   000560 000116 0                  ADSC9   OV4                      cn=0,n=78

     1292     4548    3       DO WHILE(K < NXT_MSLOT);

   4548  4 005455   002305 236000 0                  LDQ     K
         4 005456   000000 116000 xsym               CMPQ    NXT_MSLOT
         4 005457   005735 605000 4                  TPL     s:4580

     1293     4549    3           IF SCNT ~= -1 THEN CALL SEARCH_LISTS(0,K) ALTRET(NI);

   4549  4 005460   000000 235000 xsym               LDA     SCNT
         4 005461   000013 115000 5                  CMPA    11
         4 005462   005471 600000 4                  TZE     s:4550

   4549  4 005463   000330 236000 5                  LDQ     216
         4 005464   002350 756000 0                  STQ     @LIST+1
         4 005465   000310 236000 5                  LDQ     200
         4 005466   002347 756000 0                  STQ     BLINE+21
         4 005467   005737 701000 4                  TSX1    SEARCH_LISTS
         4 005470   005731 702000 4                  TSX2    NI

     1294     4550    3           OV4 = BLINE;

   4550  4 005471   000000 100400                    MLR     fill='000'O
         4 005472   002322 000116 0                  ADSC9   BLINE                    cn=0,n=78
         4 005473   000560 000116 0                  ADSC9   OV4                      cn=0,n=78

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:201  
     1295     4551    3           OWNER =TYPE.MSTRINDX(MSTR_REF.SET.OWNER_TYPE(K));

   4551  4 005474   002305 236000 0                  LDQ     K
         4 005475   000012 402007                    MPY     10,DL
         4 005476   000000 470400 xsym               LDP0    MSTR$
         4 005477   000011 236106                    LDQ     9,QL,PR0
         4 005500   000001 772000                    QRL     1
         4 005501   007777 376007                    ANQ     4095,DL
         4 005502   000001 736000                    QLS     1
         4 005503   000000 100406                    MLR     fill='000'O
         4 005504   000000 000002 xsym               ADSC9   TYPE,Q                   cn=0,n=2
         4 005505   002352 000004 0                  ADSC9   J+1                      cn=0,n=4
         4 005506   002352 236000 0                  LDQ     J+1
         4 005507   000022 732000                    QRS     18
         4 005510   002310 756000 0                  STQ     OWNER

     1296     4552    3           SET_OCC = RECS.NO_OF_RECS(OWNER);

   4552  4 005511   002310 235000 0                  LDA     OWNER
         4 005512   000003 735000                    ALS     3
         4 005513   000003 471400 0                  LDP1    RECS$
         4 005514   100000 235105                    LDA     0,AL,PR1
         4 005515   002307 755000 0                  STA     SET_OCC

     1297     4553    3           IF MSTR_REF.NAME(K) = %XCALC THEN GOTO NI;

   4553  4 005516   002305 236000 0                  LDQ     K
         4 005517   000050 402007                    MPY     40,DL
         4 005520   040000 106506                    CMPC    fill='040'O
         4 005521   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         4 005522   000076 000036 3                  ADSC9   62                       cn=0,n=30
         4 005523   005731 600000 4                  TZE     NI

     1298     4554    3           OV4.X.SET = MSTR_REF.NAME(K);

   4554  4 005524   040000 100506                    MLR     fill='040'O
         4 005525   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:202  
         4 005526   000560 000036 0                  ADSC9   OV4                      cn=0,n=30

     1299     4555    3           CALL BINCHAR_SUP(OV4.SET,SET_OCC,7);

   4555  4 005527   000332 237000 5                  LDAQ    218
         4 005530   002302 757000 0                  STAQ    @NUMFLD
         4 005531   000334 236000 5                  LDQ     220
         4 005532   002301 756000 0                  STQ     @CHRFLD
         4 005533   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005534   000000 011000                    NOP     0

     1300     4556    3           CALL WRIT(OV4, LENGTHC(OV4));

   4556  4 005535   000336 237000 5                  LDAQ    222
         4 005536   002276 757000 0                  STAQ    @BF
         4 005537   005301 701000 4                  TSX1    WRIT
         4 005540   000000 011000                    NOP     0

     1301     4557    3           OV4 = BLINE;

   4557  4 005541   000000 100400                    MLR     fill='000'O
         4 005542   002322 000116 0                  ADSC9   BLINE                    cn=0,n=78
         4 005543   000560 000116 0                  ADSC9   OV4                      cn=0,n=78

     1302     4558    3           NEXT = MSTR_REF.NEXT(K);

   4558  4 005544   002305 236000 0                  LDQ     K
         4 005545   000012 402007                    MPY     10,DL
         4 005546   000000 470400 xsym               LDP0    MSTR$
         4 005547   000000 236106                    LDQ     0,QL,PR0
         4 005550   000022 736000                    QLS     18
         4 005551   000022 732000                    QRS     18
         4 005552   002311 756000 0                  STQ     NEXT

     1303     4559    4           DO WHILE(NEXT ~= -1);

   4559  4 005553   005727 710000 4                  TRA     s:4577
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:203  

     1304     4560    4               MEMINDX = REC_XREF.MSTRINDX(NEXT);

   4560  4 005554   000000 470400 xsym               LDP0    REC_XREF$
         4 005555   002311 720000 0                  LXL0    NEXT
         4 005556   000000 236110                    LDQ     0,X0,PR0
         4 005557   000001 772000                    QRL     1
         4 005560   377777 376007                    ANQ     131071,DL
         4 005561   002306 756000 0                  STQ     MEMINDX

     1305     4561    4               IF MSTR_REF.TYPE(MEMINDX) ~= MSTR_REF.TYPE(OWNER) THEN

   4561  4 005562   000012 402007                    MPY     10,DL
         4 005563   000000 471400 xsym               LDP1    MSTR$
         4 005564   100000 221106                    LDX1    0,QL,PR1
         4 005565   002310 236000 0                  LDQ     OWNER
         4 005566   000012 402007                    MPY     10,DL
         4 005567   100000 101106                    CMPX1   0,QL,PR1
         4 005570   005722 600000 4                  TZE     NX

     1306     4562    5               DO;

     1307     4563    5                   IF RCNT ~= -1 THEN CALL SEARCH_LISTS(1,MEMINDX) ALTRET(NX);

   4563  4 005571   000000 235000 xsym               LDA     RCNT
         4 005572   000013 115000 5                  CMPA    11
         4 005573   005602 600000 4                  TZE     s:4564

   4563  4 005574   000340 236000 5                  LDQ     224
         4 005575   002350 756000 0                  STQ     @LIST+1
         4 005576   000035 236000 5                  LDQ     29
         4 005577   002347 756000 0                  STQ     BLINE+21
         4 005600   005737 701000 4                  TSX1    SEARCH_LISTS
         4 005601   005722 702000 4                  TSX2    NX

     1308     4564    5                   OV4.V.REC = MSTR_REF.NAME(MEMINDX);

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:204  
   4564  4 005602   002306 236000 0                  LDQ     MEMINDX
         4 005603   000050 402007                    MPY     40,DL
         4 005604   000000 470400 xsym               LDP0    MSTR$
         4 005605   040000 100506                    MLR     fill='040'O
         4 005606   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         4 005607   000563 600036 0                  ADSC9   OV4+3                    cn=3,n=30

     1309     4565    5                   OV4.LOC = LOCS(MSTR_REF.PSMODE(MEMINDX));

   4565  4 005610   002306 236000 0                  LDQ     MEMINDX
         4 005611   000012 402007                    MPY     10,DL
         4 005612   000011 236106                    LDQ     9,QL,PR0
         4 005613   000030 772000                    QRL     24
         4 005614   000007 376007                    ANQ     7,DL
         4 005615   000003 736000                    QLS     3
         4 005616   040000 100406                    MLR     fill='040'O
         4 005617   002313 000006 0                  ADSC9   LOCS,Q                   cn=0,n=6
         4 005620   000573 400006 0                  ADSC9   OV4+11                   cn=2,n=6

     1310     4566    5                   REC_TYPE = TYPE.MSTRINDX(MSTR_REF.TYPE(MEMINDX));

   4566  4 005621   002306 236000 0                  LDQ     MEMINDX
         4 005622   000012 402007                    MPY     10,DL
         4 005623   000000 236106                    LDQ     0,QL,PR0
         4 005624   000022 732000                    QRS     18
         4 005625   000001 736000                    QLS     1
         4 005626   000000 100406                    MLR     fill='000'O
         4 005627   000000 000002 xsym               ADSC9   TYPE,Q                   cn=0,n=2
         4 005630   002321 000002 0                  ADSC9   REC_TYPE                 cn=0,n=2

     1311     4567    5                   VALUE = RECS.NO_OF_RECS(REC_TYPE)/SET_OCC;

   4567  4 005631   002321 235000 0                  LDA     REC_TYPE
         4 005632   777777 375003                    ANA     -1,DU
         4 005633   000017 731000                    ARS     15
         4 005634   000003 471400 0                  LDP1    RECS$
         4 005635   100000 236105                    LDQ     0,AL,PR1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:205  
         4 005636   005647 605000 4                  TPL     s:4567+14
         4 005637   002307 235000 0                  LDA     SET_OCC
         4 005640   000001 405007                    CMG     1,DL
         4 005641   005650 600000 4                  TZE     s:4567+15
         4 005642   000000 235003                    LDA     0,DU
         4 005643   000001 737000                    LLS     1
         4 005644   002307 507000 0                  DVF     SET_OCC
         4 005645   000044 733000                    LRS     36
         4 005646   005650 710000 4                  TRA     s:4567+15
         4 005647   002307 506000 0                  DIV     SET_OCC
         4 005650   002312 756000 0                  STQ     VALUE

     1312     4568    5                   IF VALUE = 0 THEN RECS.NO_OF_PAGES(REC_TYPE) = 0;

   4568  4 005651   000000 116003                    CMPQ    0,DU
         4 005652   005657 601000 4                  TNZ     s:4569

   4568  4 005653   002321 235000 0                  LDA     REC_TYPE
         4 005654   777777 375003                    ANA     -1,DU
         4 005655   000017 731000                    ARS     15
         4 005656   100006 450105                    STZ     6,AL,PR1

     1313     4569    5                   CALL BINCHAR_SUP(OV4.MEM, VALUE, 7);

   4569  4 005657   000342 237000 5                  LDAQ    226
         4 005660   002302 757000 0                  STAQ    @NUMFLD
         4 005661   000344 236000 5                  LDQ     228
         4 005662   002301 756000 0                  STQ     @CHRFLD
         4 005663   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005664   000000 011000                    NOP     0

     1314     4570    5                   VALUE = VALUE/RECS.NO_OF_PAGES(REC_TYPE);

   4570  4 005665   002321 235000 0                  LDA     REC_TYPE
         4 005666   777777 375003                    ANA     -1,DU
         4 005667   000017 731000                    ARS     15
         4 005670   000003 470400 0                  LDP0    RECS$
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:206  
         4 005671   000000 620005                    EAX0    0,AL
         4 005672   002312 236000 0                  LDQ     VALUE
         4 005673   000006 235110                    LDA     6,X0,PR0
         4 005674   005677 605000 4                  TPL     s:4570+10
         4 005675   000000 236003                    LDQ     0,DU
         4 005676   005700 710000 4                  TRA     s:4570+11
         4 005677   000006 506110                    DIV     6,X0,PR0
         4 005700   002312 756000 0                  STQ     VALUE

     1315     4571    5                   CALL BINCHAR_SUP(OV4.PGE,VALUE,7);

   4571  4 005701   000342 237000 5                  LDAQ    226
         4 005702   002302 757000 0                  STAQ    @NUMFLD
         4 005703   000345 236000 5                  LDQ     229
         4 005704   002301 756000 0                  STQ     @CHRFLD
         4 005705   005360 701000 4                  TSX1    BINCHAR_SUP
         4 005706   000000 011000                    NOP     0

     1316     4572    5                   CALL WRIT(OV4, LENGTHC(OV4));

   4572  4 005707   000336 237000 5                  LDAQ    222
         4 005710   002276 757000 0                  STAQ    @BF
         4 005711   005301 701000 4                  TSX1    WRIT
         4 005712   000000 011000                    NOP     0

     1317     4573    5                   OV4 = BLINE;

   4573  4 005713   000000 100400                    MLR     fill='000'O
         4 005714   002322 000116 0                  ADSC9   BLINE                    cn=0,n=78
         4 005715   000560 000116 0                  ADSC9   OV4                      cn=0,n=78

     1318     4574    5                   CALL WRIT(BLINE, LENGTHC(BLINE));

   4574  4 005716   000346 237000 5                  LDAQ    230
         4 005717   002276 757000 0                  STAQ    @BF
         4 005720   005301 701000 4                  TSX1    WRIT
         4 005721   000000 011000                    NOP     0
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:207  

     1319     4575    5                   END;

     1320     4576    4   NX:         NEXT = REC_XREF.NEXT(NEXT);

   4576  4 005722   000000 470400 xsym  NX           LDP0    REC_XREF$
         4 005723   002311 720000 0                  LXL0    NEXT
         4 005724   000000 236110                    LDQ     0,X0,PR0
         4 005725   000022 732000                    QRS     18
         4 005726   002311 756000 0                  STQ     NEXT

     1321     4577    4               END;

   4577  4 005727   000013 116000 5                  CMPQ    11
         4 005730   005554 601000 4                  TNZ     s:4560

     1322     4578    3   NI:     K=K+1;

   4578  4 005731   002305 054000 0     NI           AOS     K

     1323     4579    3           END;

   4579  4 005732   002305 236000 0                  LDQ     K
         4 005733   000000 116000 xsym               CMPQ    NXT_MSLOT
         4 005734   005460 604000 4                  TMI     s:4549

     1324     4580    2       RETURN;

   4580  4 005735   002304 221200 0                  LDX1  ! @LENG+1
         4 005736   000001 702211                    TSX2  ! 1,X1

     1325     4581    2   END SET_REPORT;
     1326     4582        /*****************************************/
     1327     4583        /*  This rtn looks to see a certain set  existed
     1328     4584            in the 'set=' clause. if not, it altrets */
     1329     4585        /*****************************************/
     1330     4586    1   SEARCH_LISTS: PROC(LIST,SINDX) ALTRET;
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:208  

   4586  4 005737   002346 741200 0     SEARCH_LISTS STX1  ! BLINE+20

     1331     4587    2   DCL LIST SBIN;
     1332     4588
     1333     4589    2   DCL SINDX UBIN;
     1334     4590    2   DCL J UBIN WORD ALIGNED;
     1335     4591    2       IF LIST = 1 THEN

   4591  4 005740   002347 470400 0                  LDP0    @LIST
         4 005741   000000 235100                    LDA     0,,PR0
         4 005742   000001 115007                    CMPA    1,DL
         4 005743   005770 601000 4                  TNZ     s:4598

     1336     4592    3       DO J = 0 TO 19;

   4592  4 005744   002351 450000 0                  STZ     J

     1337     4593    3           IF RECORD_LIST.NAME(J) =

   4593  4 005745   002350 470400 0                  LDP0    @SINDX
         4 005746   000000 236100                    LDQ     0,,PR0
         4 005747   000012 402007                    MPY     10,DL
         4 005750   002351 235000 0                  LDA     J
         4 005751   000005 735000                    ALS     5
         4 005752   000002 736000                    QLS     2
         4 005753   000000 471400 xsym               LDP1    MSTR$
         4 005754   040106 106405                    CMPC    fill='040'O
         4 005755   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 005756   100001 400036                    ADSC9   1,Q,PR1                  cn=2,n=30
         4 005757   005762 601000 4                  TNZ     s:4595

     1338     4594    3              MSTR_REF.NAME(SINDX) THEN J=25;

   4594  4 005760   000031 236007                    LDQ     25,DL
         4 005761   002351 756000 0                  STQ     J

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:209  
     1339     4595    3           END;

   4595  4 005762   002351 235000 0                  LDA     J
         4 005763   000001 035007                    ADLA    1,DL
         4 005764   002351 755000 0                  STA     J
         4 005765   000024 115007                    CMPA    20,DL
         4 005766   005745 602000 4                  TNC     s:4593
         4 005767   006013 710000 4                  TRA     s:4603

     1340     4596    2       ELSE
     1341     4597
     1342     4598    3       DO J = 0 TO 19;

   4598  4 005770   002351 450000 0                  STZ     J

     1343     4599    3           IF SET_LIST.NAME(J) =

   4599  4 005771   002350 470400 0                  LDP0    @SINDX
         4 005772   000000 236100                    LDQ     0,,PR0
         4 005773   000012 402007                    MPY     10,DL
         4 005774   002351 235000 0                  LDA     J
         4 005775   000005 735000                    ALS     5
         4 005776   000002 736000                    QLS     2
         4 005777   000000 471400 xsym               LDP1    MSTR$
         4 006000   040106 106405                    CMPC    fill='040'O
         4 006001   000000 000036 xsym               ADSC9   SET_LIST,A               cn=0,n=30
         4 006002   100001 400036                    ADSC9   1,Q,PR1                  cn=2,n=30
         4 006003   006006 601000 4                  TNZ     s:4602

     1344     4600    3              MSTR_REF.NAME(SINDX) THEN
     1345     4601    3               J=25;

   4601  4 006004   000031 236007                    LDQ     25,DL
         4 006005   002351 756000 0                  STQ     J

     1346     4602    3           END;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:210  
   4602  4 006006   002351 235000 0                  LDA     J
         4 006007   000001 035007                    ADLA    1,DL
         4 006010   002351 755000 0                  STA     J
         4 006011   000024 115007                    CMPA    20,DL
         4 006012   005771 602000 4                  TNC     s:4599

     1347     4603    2       IF J ~= 25 THEN ALTRETURN;

   4603  4 006013   000031 115007                    CMPA    25,DL
         4 006014   006017 600000 4                  TZE     s:4604

   4603  4 006015   002346 221200 0                  LDX1  ! BLINE+20
         4 006016   000000 702211                    TSX2  ! 0,X1

     1348     4604    2       RETURN;

   4604  4 006017   002346 221200 0                  LDX1  ! BLINE+20
         4 006020   000001 702211                    TSX2  ! 1,X1

     1349     4605    2   END SEARCH_LISTS;
     1350     4606
     1351     4607    1   ALTRTN: ALTRETURN;

   4607  4 006021   000000 221200 0     ALTRTN       LDX1  ! 0
         4 006022   000000 702211                    TSX2  ! 0,X1

CALC_REC
 Sect OctLoc
   0     004   ****** ******   ****** ******   ****** ******   ****** ******    ................

PH0
 Sect OctLoc
   0     012   060040 040040   040040 040040   040040 040040   040040 040040    0
   0     016   040040 040040   040040 040040   040040 040040   040040 040040
   0     026*  ****** ******   ****** ******   ****** ******   ****** ******    ................

PH1
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:211  
 Sect OctLoc
   0     032   040040 040040   040040 040040   040040 040040   040040 040040
   0     036   040040 040040   040040 040040   040040 040040   040040 040122                   R
   0     042   105103 117122   104040 123124   101124 111123   124111 103123    ECORD STATISTICS

PH2
 Sect OctLoc
   0     046   040040 040040   040040 040040   040040 040040   040040 040040
   0     052   040040 040040   040040 040040   040040 040040   040040 040055                   -
   0     056   055055 055055   055055 055055   055055 055055   055055 055055    ----------------

PH3
 Sect OctLoc
   0     062   122105 103117   122104 040040   040040 040040   040040 040040    RECORD
   0     066   040040 040040   123111 132105   040111 116040   040126 101122        SIZE IN  VAR
   0     072   040040 040040   040040 116125   115102 105122   040040 040040          NUMBER
   0     076   040043 040102   131124 105123   040040 040040   040040 114117     # BYTES      LO
   0     102   127105 123124   040040 040040   040110 111107   110105 123124    WEST     HIGHEST

PH4
 Sect OctLoc
   0     106   116101 115105   040040 040040   040040 040040   040040 040040    NAME
   0     112   040040 040040   040040 102131   124105 123040   040040 123132          BYTES   SZ
   0     116   040040 040040   040040 040106   117125 116104   040040 040040           FOUND
   0     122   040040 040040   125123 105104   040040 040040   040040 040104        USED       D
   0     126   102113 105131   040040 040040   040040 040104   102113 105131    BKEY       DBKEY

RLINE
 Sect OctLoc
   0     132   ****** ******   ****** ******   ****** ******   ****** ******    ................

PF1
 Sect OctLoc
   0     156   040040 040040   040040 040040   040040 040040   040040 040040
   0     166*  040055 055055   055055 055055   055055 055055   040055 055055     ----------- ---
   0     172   055055 055055   055055 055055                                    --------

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:212  
PF2
 Sect OctLoc
   0     174   040040 040040   040040 040040   040040 040040   040040 040040
   0     210*  ****** ******   ****** ******   040075 040124   117124 101114    ........ = TOTAL
   0     214   123040 106117   122040 040040   040*** ******   ****** ******    S FOR    .......

PF3
 Sect OctLoc
   0     220   040040 040040   040040 040040   040040 040040   040040 040040
   0     234*  040040 040040   040040 040040   040040 040040   040040 045040                  %
   0     240   117106 040101   122105 101040   125123 105104   040040 040040    OF AREA USED

BLANK_LINE
 Sect OctLoc
   0     244   040*** ******                                                     ...

INDX
 Sect OctLoc
   0     304   000000 000000                                                    ....

HIDBKY
 Sect OctLoc
   0     307   777777 777777                                                    ....

CLEAR_COUNTERS
 Sect OctLoc
   0     311   0***** ******                                                    ....

PAH1
 Sect OctLoc
   0     321   040040 040040   040040 040040   040040 040040   040040 040040
   0     325   040040 040040   040040 040040   040040 040040   040040 040120                   P
   0     331   117111 116124   105122 040101   122122 101131   040122 105103    OINTER ARRAY REC
   0     335   117122 104123                                                    ORDS

PAH2
 Sect OctLoc
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:213  
   0     336   040040 040040   040040 040040   040040 040040   040040 040040
   0     342   040040 040040   040040 040040   040040 040040   040040 040123                   S
   0     346   120101 103105   040040 125123   101107 105040   040123 125115    PACE  USAGE  SUM
   0     352   115101 122131                                                    MARY

PAH3
 Sect OctLoc
   0     353   040040 040040   040040 040040   040040 040040   040040 040040
   0     357   040040 040040   040040 040040   040040 040040   040040 040055                   -
   0     363   055055 055055   055055 055055   055055 055055   055055 055055    ----------------
   0     367   055055 055055                                                    ----

PAH4
 Sect OctLoc
   0     370   120117 111116   124105 122040   101122 122101   131040 040040    POINTER ARRAY
   0     374   040040 040040   040040 040116   125115 102105   122040 106117           NUMBER FO
   0     400   125116 104040   040040 040040   040040 040040   040040 040101    UND            A
   0     404   126105 122101   107105 040120   105122 040120   101137 122105    VERAGE PER PA_RE
   0     410   103040 040040   040040 040040   040045 040123   120101 103105    C        % SPACE

PAH5
 Sect OctLoc
   0     414   123105 124040   116101 115105   040040 040040   040040 040040    SET NAME
   0     420   040040 040040   117127 116105   122040 120101   137122 105103        OWNER PA_REC
   0     424   040115 105115   102105 122040   040040 105116   124122 131055     MEMBER   ENTRY-
   0     430   125123 105104   050122 105123   145144 051040   102131 124105    USED(RESed) BYTE
   0     434   055101 126101   111114 040040   040040 040040   125123 105104    -AVAIL      USED

PAH6
 Sect OctLoc
   0     440   ****** ******   ****** ******   ****** ******   ****** ******    ................
   0     460*  ****** ******   040040 040040   040040 ******   ****** ******    ....      ......

OV1
 Sect OctLoc
   0     464   040040 040040   040040 040040   040040 040040   040040 040040
   0     474*  040040 040040   040040 040040   040040 040040   114117 103101                LOCA
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:214  
   0     500   124111 117116   040040 040040   123105 124040   040040 040101    TION    SET    A
   0     504   126107 043040   117106 040101   126107 040120   101107 105***    VG# OF AVG PAGE.

OV3
 Sect OctLoc
   0     510   040040 123105   124116 101115   105040 040040   040040 040040      SETNAME
   0     514   040040 040040   040040 040040   040040 040115   105115 102105               MEMBE
   0     520   122040 040040   040040 040040   040040 040040   040040 115117    R             MO
   0     524   104105 040040   117103 103125   122105 116103   105123 040115    DE  OCCURENCES M
   0     530   105115 102105   122123 040040   040123 120101   116*** ******    EMBERS   SPAN...

OV3A
 Sect OctLoc
   0     534   040040 137137   137137 137137   137040 040040   040040 040040      _______
   0     540   040040 040040   040040 040040   040040 040137   137137 137137               _____
   0     544   137040 040040   040040 040040   040040 040040   040137 137137    _            ___
   0     550   137040 040137   137137 137137   137137 137137   137137 040137    _  ___________ _
   0     554   137137 137137   137137 040137   137137 137137   137137 137***    ______ ________.

OV4
 Sect OctLoc
   0     560   ****** ******   ****** ******   ****** ******   ****** ******    ................

OV5
 Sect OctLoc
   0     604   040040 040040   040040 040040   040040 040040   040040 040040
   0     610   040040 040040   040040 040040   040040 040040   040040 040117                   O
   0     614   126105 122106   114117 127040   122105 120117   122124 ******    VERFLOW REPORT..

OV5A
 Sect OctLoc
   0     620   040040 040040   040040 040040   040040 040040   040040 040040
   0     624   040040 040040   040040 040040   040040 040040   040040 040055                   -
   0     630   055055 055055   055055 055055   055055 055055   055055 ******    --------------..

DB_OA
 Sect OctLoc
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:215  
   0     634   000000 023417   000000 000000   000000 000000                    ............

DB_CALC_REC
 Sect OctLoc
   0     637   000000 000000   000000 000000   000000 023417   000000 000000    ................
   0     643   777777 777777   000000 000000                                    ........

DB_TOT_SZ
 Sect OctLoc
   0     645   000000 000000                                                    ....

DB_TOT_RECS
 Sect OctLoc
   0     646   000000 000000                                                    ....

DB_NUM_PGS_REPORTED
 Sect OctLoc
   0     647   000000 000000                                                    ....

NUM_AREAS_REPORTED
 Sect OctLoc
   0     650   000000 000000                                                    ....

PH5
 Sect OctLoc
   0     651   040040 040040   040040 040040   040040 040040   040040 040040
   0     655   040040 040040   040040 040040   040040 040040   040040 040120                   P
   0     661   101107 105040   040040 123124   101124 111123   124111 103123    AGE   STATISTICS

PH6
 Sect OctLoc
   0     665   040040 040040   040040 040040   040040 040040   040104 102113                 DBK
   0     671   105131 040125   123101 107105   040040 040040   040040 040055    EY USAGE       -
   0     675   055055 055055   055055 055055   055055 055055   055055 055055    ----------------
   0     701   040040 040040   040040 040040   040123 120101   103105 040125             SPACE U
   0     705   123101 107105                                                    SAGE

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:216  
PH7
 Sect OctLoc
   0     706   040040 040040   040040 040040   040040 040040   040055 055055                 ---
   0     712   055055 055055   055055 055055   040040 040040   040040 040040    --------
   0     716   040040 040040   040040 040040   040040 040040   040040 040040
   0     722   040040 040040   040040 040040   040055 055055   055055 055055             -------
   0     726   055055 055055                                                    ----

PH8
 Sect OctLoc
   0     727   040040 040040   040040 040040   043040 120101   107105 123040            # PAGES
   0     733   040040 040040   040040 040045   040120 101107   105123 040040           % PAGES
   0     737   040040 040040   040040 045040   040040 040040   040040 040040          %
   0     743   040040 043040   120101 107105   123040 040040   040040 040040      # PAGES
   0     747   040045 040120   101107 105123   040040 040040   040040 040040     % PAGES

PH9
 Sect OctLoc
   0     753   040040 040040   040040 124110   111123 040106   125114 114040          THIS FULL
   0     757   040040 040040   040124 110111   123040 106125   114114 040040         THIS FULL
   0     763   040040 040040   040106 125114   114040 040040   040040 040040         FULL
   0     767   124110 111123   040106 125114   114040 040040   040040 040124    THIS FULL      T
   0     773   110111 123040   106125 114114   040040 040040   040040 040040    HIS FULL

PLINE
 Sect OctLoc
   0     777   ****** ******   ****** ******   ****** ******   ****** ******    ................
   0    1003*  ****** ******   ****** ******   ****** ******   ****** 040040    ..............
   0    1007   040040 040040   ****** ******   ****** ******   ****** ******        ............
   0    1017*  ****** ******   ****** ******                                    ........

PGS
 Sect OctLoc
   0    1021   ****** ******   ****** ******   040060 055064   040040 ******    ........ 0-4  ..
   0    1031*  040065 055071   040040 ******   ****** ******   ****** ******     5-9  ..........
   0    1035   ****** ******   ****** ******   061060 055061   064040 ******    ........10-14 ..
   0    1045*  061065 055061   071040 ******   ****** ******   ****** ******    15-19 ..........
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:217  
   0    1051   ****** ******   ****** ******   062060 055062   064040 ******    ........20-24 ..
   0    1061*  062065 055062   071040 ******   ****** ******   ****** ******    25-29 ..........
   0    1065   ****** ******   ****** ******   063060 055063   064040 ******    ........30-34 ..
   0    1075*  063065 055063   071040 ******   ****** ******   ****** ******    35-39 ..........
   0    1101   ****** ******   ****** ******   064060 055064   064040 ******    ........40-44 ..
   0    1111*  064065 055064   071040 ******   ****** ******   ****** ******    45-49 ..........
   0    1115   ****** ******   ****** ******   065060 055065   064040 ******    ........50-54 ..
   0    1125*  065065 055065   071040 ******   ****** ******   ****** ******    55-59 ..........
   0    1131   ****** ******   ****** ******   066060 055066   064040 ******    ........60-64 ..
   0    1141*  066065 055066   071040 ******   ****** ******   ****** ******    65-69 ..........
   0    1145   ****** ******   ****** ******   067060 055067   064040 ******    ........70-74 ..
   0    1155*  067065 055067   071040 ******   ****** ******   ****** ******    75-79 ..........
   0    1161   ****** ******   ****** ******   070060 055070   064040 ******    ........80-84 ..
   0    1171*  070065 055070   071040 ******   ****** ******   ****** ******    85-89 ..........
   0    1175   ****** ******   ****** ******   071060 055071   064040 ******    ........90-94 ..
   0    1205*  071065 055061   060060 ******   ****** ******   ****** ******    95-100..........

DB_PGS
 Sect OctLoc
   0    1211   ****** ******   ****** ******   040060 055064   040040 ******    ........ 0-4  ..
   0    1221*  040065 055071   040040 ******   ****** ******   ****** ******     5-9  ..........
   0    1225   ****** ******   ****** ******   061060 055061   064040 ******    ........10-14 ..
   0    1235*  061065 055061   071040 ******   ****** ******   ****** ******    15-19 ..........
   0    1241   ****** ******   ****** ******   062060 055062   064040 ******    ........20-24 ..
   0    1251*  062065 055062   071040 ******   ****** ******   ****** ******    25-29 ..........
   0    1255   ****** ******   ****** ******   063060 055063   064040 ******    ........30-34 ..
   0    1265*  063065 055063   071040 ******   ****** ******   ****** ******    35-39 ..........
   0    1271   ****** ******   ****** ******   064060 055064   064040 ******    ........40-44 ..
   0    1301*  064065 055064   071040 ******   ****** ******   ****** ******    45-49 ..........
   0    1305   ****** ******   ****** ******   065060 055065   064040 ******    ........50-54 ..
   0    1315*  065065 055065   071040 ******   ****** ******   ****** ******    55-59 ..........
   0    1321   ****** ******   ****** ******   066060 055066   064040 ******    ........60-64 ..
   0    1331*  066065 055066   071040 ******   ****** ******   ****** ******    65-69 ..........
   0    1335   ****** ******   ****** ******   067060 055067   064040 ******    ........70-74 ..
   0    1345*  067065 055067   071040 ******   ****** ******   ****** ******    75-79 ..........
   0    1351   ****** ******   ****** ******   070060 055070   064040 ******    ........80-84 ..
   0    1361*  070065 055070   071040 ******   ****** ******   ****** ******    85-89 ..........
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:218  
   0    1365   ****** ******   ****** ******   071060 055071   064040 ******    ........90-94 ..
   0    1375*  071065 055061   060060 ******   ****** ******   ****** ******    95-100..........

PA
 Sect OctLoc
   0    1407   ****** ******   ****** ******   ****** ******   ****** ******    ................

REC_TABLE
 Sect OctLoc
   0    2112   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCS
 Sect OctLoc
   0    2313   ****** ******   ****** ******   ****** ******   ****** ******    ................

BLINE
 Sect OctLoc
   0    2322   040040 040040   040040 040040   040040 040040   040040 040040
   0    2342*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   0    2352   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   3     000   101122 105101   052103 101114   103040 040040   052103 101114    AREA*CALC   *CAL
   3     004   103056 122103   101114 114040   101122 105101   123040 040040    C.RCALL AREAS
   3     010   040055 116117   116105 055040   040045 040040   040040 040040     -NONE-  %
   3     014   060040 040040   040040 040040   040040 040040   040040 040040    0
   3     020   040040 040040   040040 040060   040075 040123   125102 124117           0 = SUBTO
   3     024   124101 114123   040106 117122   040040 040040   040040 060040    TALS FOR      0
   3     030   114105 123123   040124 110101   116040 040040   040040 061040    LESS THAN     1
   3     034   120101 107105   040110 105101   104105 122123   040040 040062    PAGE HEADERS   2
   3     040   064040 040040   117106 106123   105124 040101   122122 101131    4   OFFSET ARRAY
   3     044   123040 040040   040075 040040   124117 124101   114123 040040    S    =  TOTALS
   3     050   106117 122040   040040 040040   117116 114131   040061 040111    FOR     ONLY 1 I
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:219  
   3     054   116124 105107   122101 124105   104040 101122   105101 040111    NTEGRATED AREA I
   3     060   116040 124110   105040 123103   110105 115101   061060 060040    N THE SCHEMA100
   3     064   040040 040040   040040 040040   040040 040040   040040 060040                  0
   3     070   104111 122105   103124 040040   126111 101040   040040 040040    DIRECT  VIA
   3     074   103101 114103   040040 040040   052103 101114   103040 040040    CALC    *CALC
   3     100   040040 040040   040040 040040   040040 040040   040040 040040
   3     104   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   5     000   000000 000000   000000 006000   000002 000000   000000 006014    ................
   5     004   000000 000040   000004 006000   000000 000005   000003 006000    ... ............
   5     010   000006 006000   000000 006000   000006 006000   777777 777777    ................
   5     014   777777 400007   040040 040040   000006 000000   000000 006000    ....    ........
   5     020   000000 006000   000004 006000   000000 006000   000000 006000    ................
   5     024   000310 006000   001777 777640   000001 000000   000234 006000    ................
   5     030   000017 777640   000012 006000   000000 000001   000000 000064    ...............4
   5     034   000244 006000   000032 006000   000321 006000   000033 006000    ................
   5     040   000336 006000   000033 006000   000353 006000   000033 006000    ................
   5     044   000000 000120   001410 006000   000370 006000   000044 006000    ...P.........$..
   5     050   000414 006000   000044 006000   000445 006000   000000 000006    .....$..........
   5     054   000320 006000   000053 006000   000446 206000   000000 000010    .....+..........
   5     060   000057 006000   001411 006000   000447 606000   000000 000003    ./..............
   5     064   000304 006000   000063 006000   000453 606000   000000 000000    .....3..........
   5     070   000304 006000   000032 006000   000454 606000   000000 000000    ................
   5     074   000304 006000   000057 006000   000456 406000   000460 606000    ...../..........
   5     100   000077 777777   000000 000004   000304 006000   000101 006000    .?...........A..
   5     104   000455 206000   000462 406000   000000 000117   777777 377777    ...........O....
   5     110   000440 006000   000106 006000   000000 006003   000001 777776    .....F..........
   5     114   400000 000000   000000 000060   000032 006000   000115 006000    .......0.....M..
   5     120   000046 006000   000115 006000   000062 006000   000044 006000    .&...M...2...$..
   5     124   000106 006000   000044 006000   000137 406000   000140 606000    .F...$..._...`..
   5     130   000000 000014   000130 006000   000142 006000   000145 006000    .....X...b...e..
   5     134   000150 006000   000153 006000   000132 006000   000044 006000    .h...k...Z...$..
   5     140   000000 000070   000204 006000   000156 006000   000140 006000    ...8.....n...`..
   5     144   000252 006000   000130 006000   000251 006000   000130 006000    .....X.......X..
   5     150   000207 006000   000000 000000   000174 006000   000044 006000    .........|...$..
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:220  
   5     154   000251 006000   000254 006000   000000 000144   000156 006000    ...........d.n..
   5     160   000256 006000   000003 000000   000254 006000   000256 006000    ................
   5     164   000260 006000   000306 006000   000262 006000   000000 007750    ................
   5     170   000167 006000   000264 006000   000262 006000   000264 006000    .w..............
   5     174   000266 006000   000247 006000   000270 006000   000266 006000    ................
   5     200   000270 006000   000272 006000   000260 006000   000272 006000    ................
   5     204   000274 006000   000274 006000   000276 006000   000063 006000    .............3..
   5     210   000276 006000   000063 006000   000236 606000   000000 000000    .....3..........
   5     214   000220 006000   000044 006000   000306 006000   000130 006000    .....$.......X..
   5     220   000245 006000   000006 006000   000246 006000   000006 006000    ................
   5     224   000247 006000   000130 006000   000006 006000   000006 006000    .....X..........
   5     230   000007 006000   000006 006000   000005 006000   000130 006000    .............X..
   5     234   000010 006000   000130 006000   000011 006000   000130 006000    .....X.......X..
   5     240   000004 006000   000130 006000   000000 000116   000000 010000    .....X.....N....
   5     244   000174 006000   000242 006000   000243 006000   000300 006000    .|..............
   5     250   000262 006000   000300 006000   000266 006000   000260 006000    ................
   5     254   000266 006000   000274 006000   000015 006000   000032 006000    ................
   5     260   000000 000044   000000 000104   000052 006000   000260 006000    ...$...D.*......
   5     264   000651 006000   000115 006000   000665 006000   000261 006000    .....M..........
   5     270   000706 006000   000261 006000   000727 006000   000044 006000    .............$..
   5     274   000753 006000   000044 006000   000000 000017   000276 006000    .....$..........
   5     300   001011 406000   001015 206000   001021 006000   000777 006000    ................
   5     304   001002 606000   000000 000110   000777 006000   000305 006000    .......H........
   5     310   000000 006000   000000 000076   000012 006000   000311 006000    .......>........
   5     314   000000 000056   000000 000115   000604 006000   000314 006000    .......M........
   5     320   000620 006000   000314 006000   000464 006000   000106 006000    .............F..
   5     324   000510 006000   000315 006000   000534 006000   000106 006000    .............F..
   5     330   002305 006000   000000 000007   002307 006000   000331 006000    ................
   5     334   000575 606000   000000 000000   000560 006000   000242 006000    ................
   5     340   002306 006000   000000 000000   002312 006000   000331 006000    ................
   5     344   000577 606000   000601 606000   002322 006000   000044 006000    .............$..
     1352     4608    1   END ZIU$REPRT;

PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:221  
--  Include file information  --

   ZI_UWA_C.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$REPRT.

   Procedure ZIU$REPRT requires 3091 words for executable code.
   Procedure ZIU$REPRT is declared NOAUTO and requires 1266 words of local(STATIC) storage.

    No errors detected in file ZIU$REPRT.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:222  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:223  
          MINI XREF LISTING

ACSSF
       468**DCL      3615<<ASSIGN
ALTRTN
      4607**LABEL    3591--CALLALT  3592--CALLALT  3593--CALLALT  3619--CALLALT  3621--CALLALT  3636--CALLALT
      3638--CALLALT  3812--CALLALT  3861--CALLALT
ALT_ATBLK IN PROCEDURE GET_ATBLK
      4010**LABEL    3995--CALLALT
AREA_KEY$
       977**DCL       980--IMP-PTR  3599>>IF       3602>>ASSIGN   3602>>ASSIGN   3834>>IF       3860>>ASSIGN
AREA_KEY_XREF
       980**DCL      3602<<ASSIGN   3602>>ASSIGN
AREA_KEY_XREF.MAX_KEY
       982**DCL      3599>>IF
AREA_KEY_XREF.NAME
       983**DCL      3860>>ASSIGN
AREA_KEY_XREF.PERMTYPE
       986**DCL      3834>>IF
AREA_SZ_REAL
        95**DCL      4290<>CALL     4293<>CALL     4379<>CALL     4382<>CALL
AREA_TOT_RECS
        94**DCL      3629<<ASSIGN   3869<<ASSIGN   3885<<ASSIGN   4208<<ASSIGN   4208>>ASSIGN   4247<<ASSIGN
      4247>>ASSIGN   4285<>CALL     4352<<ASSIGN   4352>>ASSIGN   4367<<ASSIGN   4367>>ASSIGN   4374<>CALL
AREA_TOT_SZ
        93**DCL      3628<<ASSIGN   3870<<ASSIGN   3886<<ASSIGN   4209<<ASSIGN   4209>>ASSIGN   4248<<ASSIGN
      4248>>ASSIGN   4286<>CALL     4290<>CALL     4353<<ASSIGN   4353>>ASSIGN   4368<<ASSIGN   4368>>ASSIGN
      4375<>CALL     4379<>CALL
ASNSF
       471**DCL      3614<<ASSIGN
ATBLK$
       698**DCL       699--IMP-PTR  3996<<ASSIGN   3997>>IF       3999>>ASSIGN   4002>>ASSIGN   4002>>ASSIGN
      4002>>ASSIGN   4005>>ASSIGN   4006>>ASSIGN
ATBLK_PG.AREA_NM
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:224  
       724**DCL       725--REDEF
ATBLK_PG.FIR_INV_PGNO
       721**DCL      3997>>IF       4002>>ASSIGN
ATBLK_PG.LINE_INFO.LPP
       719**DCL      4006>>ASSIGN
ATBLK_PG.LOW_DBK
       722**DCL      4005>>ASSIGN
ATBLK_PG.NUM_DBPG
       706**DCL      3999>>ASSIGN   4002>>ASSIGN   4002>>ASSIGN
ATBLK_PG.STATUS
       733**DCL       741--REDEF
BF IN PROCEDURE WRIT
      4489**DCL      4488--PROC     4505--ASSIGN
BINCHAR_SUP
      4515**PROC     3928--CALL     3929--CALL     3930--CALL     3937--CALL     3940--CALL     3942--CALL
      3945--CALL     3948--CALL     3950--CALL     4211--CALL     4213--CALL     4215--CALL     4216--CALL
      4217--CALL     4218--CALL     4249--CALL     4251--CALL     4253--CALL     4254--CALL     4255--CALL
      4256--CALL     4285--CALL     4286--CALL     4307--CALL     4320--CALL     4321--CALL     4328--CALL
      4330--CALL     4331--CALL     4337--CALL     4339--CALL     4341--CALL     4342--CALL     4343--CALL
      4344--CALL     4355--CALL     4357--CALL     4359--CALL     4360--CALL     4361--CALL     4362--CALL
      4374--CALL     4375--CALL     4392--CALL     4455--CALL     4456--CALL     4466--CALL     4467--CALL
      4555--CALL     4569--CALL     4571--CALL
BLANK_LINE
        85**DCL      3908<>CALL     3914<>CALL     3954<>CALL     3955<>CALL     4169<>CALL     4174<>CALL
      4315<>CALL     4426<>CALL     4432<>CALL
BLINE IN PROCEDURE SET_REPORT
      4532**DCL      4547>>ASSIGN   4550>>ASSIGN   4557>>ASSIGN   4573>>ASSIGN   4574<>CALL     4574--CALL
BREAK_FLAG
       588**DCL      3816>>IF       4491>>IF
BUFLNSF
       479**DCL      3807<<ASSIGN   3905<<ASSIGN   3990<<ASSIGN   4167<<ASSIGN   4424<<ASSIGN   4506<<ASSIGN
BUFSF
       480**DCL      3806<<ASSIGN   3906<<ASSIGN   3989<<ASSIGN   4166<<ASSIGN   4423<<ASSIGN   4505<<ASSIGN
BUILD_MSTR_TBL
      3558**DCL-ENT  3591--CALL
BUILD_RECXREF
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:225  
      3560**DCL-ENT  3593--CALL
BUILD_SETXREF
      3559**DCL-ENT  3592--CALL
CALC_REC
        40**DCL      3687<<ASSIGN   3762<<ASSIGN   3872<<ASSIGN   3888<<ASSIGN   4191<<ASSIGN
CALC_REC.HI_DBKEY
        46**DCL      4280>>IF       4280>>ASSIGN   4343<>CALL
CALC_REC.HI_SZ
        44**DCL      4277>>IF       4277>>ASSIGN   4338>>IF       4339<>CALL
CALC_REC.LO_DBKEY
        45**DCL      4279>>IF       4279>>ASSIGN   4342<>CALL
CALC_REC.LO_SZ
        43**DCL      4276>>IF       4276>>ASSIGN   4337<>CALL     4338>>IF
CALC_REC.NO_OF_RECS
        41**DCL      4274>>IF       4281>>ASSIGN   4334>>IF       4344<>CALL     4367>>ASSIGN
CALC_REC.TOT_SZ
        42**DCL      4278>>ASSIGN   4341<>CALL     4368>>ASSIGN
CHAR_V
       150**DCL      3919<<ASSIGN   4121<<ASSIGN
CHRFLD IN PROCEDURE BINCHAR_SUP
      4516**DCL      4515--PROC     4519<<CALLBLT  4520<>CALL
CLOSE_AREA
      3857**LABEL    3609--GOTO
COUNTSF
       530**DCL       531--REDEF
CREATE_TBL_SEG
      3561**DCL-ENT  3636--CALL
DATA$
       754**DCL       755--IMP-PTR  3815<<ASSIGN   4025>>ASSIGN   4031>>DOINDEX  4032>>IF       4033>>ASSIGN
      4033>>ASSIGN   4067>>ASSIGN   4068>>ASSIGN   4083>>ASSIGN   4138>>ASSIGN   4139>>DOINDEX  4140>>IF
DATA_PG.ACT_DATA
       767**DCL       768--REDEF     769--REDEF     770--REDEF
DATA_PG.ACT_DATA_18
       768**DCL      4032>>IF       4033>>ASSIGN   4140>>IF
DATA_PG.CON_INTRVAL
       763**DCL      4067>>ASSIGN   4068>>ASSIGN   4083>>ASSIGN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:226  
DATA_PG.OFF_LN.SEC
       766**DCL      4025>>ASSIGN   4031>>DOINDEX  4138>>ASSIGN   4139>>DOINDEX
DB_CALC_REC
       212**DCL      3667<<ASSIGN   3746<<ASSIGN   3872>>ASSIGN   3888>>ASSIGN
DB_CALC_REC.HI_DBKEY
       218**DCL      4280>>IF       4280<<ASSIGN
DB_CALC_REC.HI_SZ
       216**DCL      4277>>IF       4277<<ASSIGN
DB_CALC_REC.LO_DBKEY
       217**DCL      3669<<ASSIGN   3748<<ASSIGN   4279>>IF       4279<<ASSIGN
DB_CALC_REC.LO_SZ
       215**DCL      3668<<ASSIGN   3747<<ASSIGN   4276>>IF       4276<<ASSIGN
DB_CALC_REC.NO_OF_RECS
       213**DCL      4281<<ASSIGN   4281>>ASSIGN
DB_CALC_REC.TOT_SZ
       214**DCL      4278<<ASSIGN   4278>>ASSIGN
DB_NUM_PGS_REPORTED
       222**DCL      3666<<ASSIGN   3745<<ASSIGN   3868>>ASSIGN   3877>>ASSIGN   3884>>ASSIGN   3897>>ASSIGN
      4024<<ASSIGN   4024>>ASSIGN
DB_OA
       207**DCL      3871>>ASSIGN   3887>>ASSIGN
DB_OA.HI_SZ
       209**DCL      3671<<ASSIGN   3750<<ASSIGN   4272>>IF       4272<<ASSIGN
DB_OA.LO_SZ
       208**DCL      3670<<ASSIGN   3749<<ASSIGN   4271>>IF       4271<<ASSIGN
DB_OA.TOT_SZ
       210**DCL      3672<<ASSIGN   3751<<ASSIGN   4273<<ASSIGN   4273>>ASSIGN
DB_PGS
       255**DCL      3878>>ASSIGN   3898>>ASSIGN
DB_PGS.DNUM
       256**DCL      3776<<ASSIGN   4468<<ASSIGN   4468>>ASSIGN
DB_PGS.DPRCNT
       257**DCL      3777<<ASSIGN
DB_PGS.SNUM
       263**DCL      3774<<ASSIGN   4457<<ASSIGN   4457>>ASSIGN
DB_PGS.SPRCNT
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:227  
       264**DCL      3775<<ASSIGN
DB_RECS.HI_DBKEY
       125**DCL      3679<<ASSIGN   3757<<ASSIGN   4203>>IF       4204<<ASSIGN   4244>>IF       4245<<ASSIGN
DB_RECS.HI_SZ
       123**DCL      3678<<ASSIGN   3756<<ASSIGN   4198>>IF       4199<<ASSIGN   4239>>IF       4240<<ASSIGN
DB_RECS.LO_DBKEY
       124**DCL      3675<<ASSIGN   3754<<ASSIGN   4201>>IF       4202<<ASSIGN   4242>>IF       4243<<ASSIGN
DB_RECS.LO_SZ
       122**DCL      3674<<ASSIGN   3753<<ASSIGN   4196>>IF       4197<<ASSIGN   4237>>IF       4238<<ASSIGN
DB_RECS.MSTRINDX
       127**DCL      3685<<ASSIGN   3706<<ASSIGN   3717>>IF       3921>>ASSIGN   4092>>ASSIGN
DB_RECS.NO_OF_PAGES
       126**DCL      3680<<ASSIGN   3758<<ASSIGN
DB_RECS.NO_OF_RECS
       120**DCL      3676<<ASSIGN   3793<<ASSIGN   4060<<ASSIGN   4060>>ASSIGN   4095>>IF
DB_RECS.PA_INDX
       128**DCL      3711<<ASSIGN   4100<<ASSIGN   4103>>ASSIGN   4111>>ASSIGN
DB_RECS.TOT_SZ
       121**DCL      3677<<ASSIGN   3755<<ASSIGN   4200<<ASSIGN   4200>>ASSIGN   4241<<ASSIGN   4241>>ASSIGN
DB_RECS$
       118**DCL       119--IMP-PTR  3639<<ASSIGN   3674>>ASSIGN   3675>>ASSIGN   3676>>ASSIGN   3677>>ASSIGN
      3678>>ASSIGN   3679>>ASSIGN   3680>>ASSIGN   3685>>ASSIGN   3706>>ASSIGN   3711>>ASSIGN   3717>>IF
      3753>>ASSIGN   3754>>ASSIGN   3755>>ASSIGN   3756>>ASSIGN   3757>>ASSIGN   3758>>ASSIGN   3793>>ASSIGN
      3867>>ASSIGN   3883>>ASSIGN   3916>>ASSIGN   3921>>ASSIGN   4060>>ASSIGN   4060>>ASSIGN   4092>>ASSIGN
      4095>>IF       4100>>ASSIGN   4103>>ASSIGN   4111>>ASSIGN   4196>>IF       4197>>ASSIGN   4198>>IF
      4199>>ASSIGN   4200>>ASSIGN   4200>>ASSIGN   4201>>IF       4202>>ASSIGN   4203>>IF       4204>>ASSIGN
      4237>>IF       4238>>ASSIGN   4239>>IF       4240>>ASSIGN   4241>>ASSIGN   4241>>ASSIGN   4242>>IF
      4243>>ASSIGN   4244>>IF       4245>>ASSIGN
DB_TOT_RECS
       221**DCL      3665<<ASSIGN   3744<<ASSIGN   3869>>ASSIGN   3885>>ASSIGN
DB_TOT_SZ
       220**DCL      3664<<ASSIGN   3743<<ASSIGN   3870>>ASSIGN   3886>>ASSIGN
DCBSF
       459**DCL      3612<<ASSIGN   3805<<ASSIGN   3857<<ASSIGN   3903<<ASSIGN   3976--IF       3988<<ASSIGN
      4164<<ASSIGN   4421<<ASSIGN   4493<<ASSIGN   4503<<ASSIGN
DESTROY_TBL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:228  
       131**DCL      3587<<ASSIGN   3604<<ASSIGN   3819>>IF       3958>>IF
DIV_RSLT_REAL
       103**DCL      4304<>CALL     4306<>CALL     4389<>CALL     4391<>CALL
ENCRP_SEEDSF
       488**DCL       489--REDEF    3811<<ASSIGN   3992<<ASSIGN
ENTRY$
       141**DCL       142--IMP-PTR  4116<<ASSIGN   4118>>IF       4121>>ASSIGN   4125<<ASSIGN   4125>>ASSIGN
ERRCODESF
       490**DCL       495--REDEF
ERRCODESF.ERR#
       493**DCL      3722<<ASSIGN   3728<<ASSIGN   3838<<ASSIGN   3980<<ASSIGN
ERRCODE_RDEF
       495**DCL      3733>>ASSIGN   3839>>ASSIGN   3981>>ASSIGN
ERRFLGSF
       519**DCL      3982<<ASSIGN
ERR_INSERT.CNT
       504**DCL      3731<<ASSIGN   3840<<ASSIGN
ERR_INSERT.TEXT
       505**DCL      3732<<ASSIGN   3841<<ASSIGN
EXPAND_TBL_SEG
      3562**DCL-ENT  3638--CALL
F$DCB.ACTPOS
      1648**DCL      1648--REDEF
F$DCB.ARS#
      1622**DCL      1622--REDEF
F$DCB.ATTR
      1641**DCL      1642--REDEF
F$DCB.BORROW
      1656**DCL      1656--REDEF    1656--REDEF    1656--REDEF
F$DCB.DCBNAME.L
      1670**DCL      1670--IMP-SIZ
F$DCB.EOMCHAR#
      1626**DCL      1626--REDEF
F$DCB.FLDID
      1651**DCL      1651--REDEF
F$DCB.FORM$
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:229  
      1645**DCL      1645--REDEF
F$DCB.FSECT
      1661**DCL      1661--REDEF
F$DCB.FSN#
      1638**DCL      1638--REDEF    1638--REDEF    1639--REDEF
F$DCB.HEADER$
      1644**DCL      1644--REDEF
F$DCB.IXTNSIZE#
      1642**DCL      1642--REDEF
F$DCB.LASTSTA$
      1631**DCL      1631--REDEF
F$DCB.LVL
      1657**DCL      1657--REDEF
F$DCB.NAME#.C
      1632**DCL      1632--REDEF
F$DCB.NOEOF
      1654**DCL      1654--REDEF
F$DCB.NRECS#
      1643**DCL      1643--REDEF
F$DCB.NRECX
      1662**DCL      1662--REDEF
F$DCB.OHDR
      1654**DCL      1654--REDEF
F$DCB.ORG#
      1637**DCL      1637--REDEF    3976>>IF
F$DCB.PRECNO
      1660**DCL      1660--REDEF
F$DCB.RCSZ
      1666**DCL      1666--REDEF
F$DCB.RES#
      1633**DCL      1633--REDEF
F$DCB.SETX
      1645**DCL      1645--REDEF
F$DCB.TAB$
      1645**DCL      1645--REDEF
F$DCB.TDA
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:230  
      1659**DCL      1660--REDEF
F$DCB.WSN#
      1633**DCL      1633--REDEF
FIDSF
       507**DCL      3618<<ASSIGN
FIDSF_RD
       506**DCL       507--REDEF
FIRST_SET
       557**DCL      4546>>ASSIGN
FIX
      3580**DCL-ENT  4306--CALL     4391--CALL
FLOAT
      3575**DCL-ENT  4290--CALL     4291--CALL     4295--CALL     4296--CALL     4300--CALL     4379--CALL
      4380--CALL     4384--CALL     4385--CALL
FLOAT_DIV
      3579**DCL-ENT  4304--CALL     4389--CALL
FLOAT_MPY
      3578**DCL-ENT  4293--CALL     4298--CALL     4382--CALL     4387--CALL
FLOAT_SUB
      3577**DCL-ENT  4302--CALL
FREE_DYN_MEM
      3565**DCL-ENT  3822--CALL     3960--CALL     4499--CALL
FREE_TBL
      3563**DCL-ENT  3736--CALL     3963--CALL     4494--CALL
FULLSF
       477**DCL      3808<<ASSIGN   3991<<ASSIGN
FUNSF
       470**DCL      3616<<ASSIGN
GET_ATBLK
      3969**PROC     3621--CALL
GET_DCB
      3573**DCL-ENT  3861--CALL
GROUP$
       147**DCL       148--IMP-PTR  4122<<ASSIGN   4123>>ASSIGN
HELPCODE
       524**DCL       529--REDEF
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:231  
HIDBKY
       112**DCL      3669>>ASSIGN   3675>>ASSIGN   3748>>ASSIGN   3754>>ASSIGN
HIGH_DATA_PG
        18**DCL      3621<>CALL     3797<>CALL     3831<>CALL
HI_PGE IN PROCEDURE GET_ATBLK
      3970**DCL      3969--PROC     3999<<ASSIGN   4002<<ASSIGN
I
       562**DCL      3598<<DOINDEX  3599>>IF       3601>>DOINDEX  3606<<ASSIGN   3606>>ASSIGN   3700<<DOINDEX
      3701>>IF       3705>>ASSIGN   3706>>ASSIGN   3707>>IF       3714<<ASSIGN   4031<<DOINDEX  4032>>IF
      4033>>ASSIGN   4067>>ASSIGN   4068>>ASSIGN   4083>>ASSIGN
ICHKSUM
       589**DCL       590--REDEF
INDX
       109**DCL      3730<<CALLBLT  3731>>ASSIGN   3936<<ASSIGN   3937<>CALL     3938<<ASSIGN   3938>>ASSIGN
      3939<<ASSIGN   3939>>ASSIGN   3940<>CALL     3941<<ASSIGN   3942<>CALL     3943<<ASSIGN   3943>>ASSIGN
      3944<<ASSIGN   3944>>ASSIGN   3945<>CALL     3947<<ASSIGN   3948<>CALL     3949<<ASSIGN   3950<>CALL
      4115<<ASSIGN   4123<<ASSIGN   4123>>ASSIGN   4127>>ASSIGN   4129>>ASSIGN
I_O_BUF
       568**DCL      3806--ASSIGN   3815--ASSIGN   3989--ASSIGN   3996--ASSIGN
I_O_BUF$
       567**DCL       568--IMP-PTR  3806>>ASSIGN   3815>>ASSIGN   3989>>ASSIGN   3996>>ASSIGN
I_O_INDX
        19**DCL      3804<<ASSIGN   3815>>ASSIGN   3829<<ASSIGN   3829>>ASSIGN
I_O_SIZE
       570**DCL      3797<>CALL     3807>>ASSIGN   3831<>CALL
J
       563**DCL      3601<<DOINDEX  3602>>ASSIGN   3602>>ASSIGN   4040<<DOINDEX  4041>>IF       4044>>ASSIGN
      4045<<ASSIGN
J IN PROCEDURE SEARCH_LISTS
      4590**DCL      4592<<DOINDEX  4593>>IF       4594<<ASSIGN   4598<<DOINDEX  4599>>IF       4601<<ASSIGN
      4603>>IF
K IN PROCEDURE SET_REPORT
      4524**DCL      4546<<ASSIGN   4548>>DOWHILE  4549<>CALL     4551>>ASSIGN   4553>>IF       4554>>ASSIGN
      4558>>ASSIGN   4578<<ASSIGN   4578>>ASSIGN
KEYSF
       461**DCL      3809<<ASSIGN   3993<<ASSIGN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:232  
KEYVSF
       462**DCL       467--REDEF
KEYVSF.IDSKEY
       465**DCL      3810<<ASSIGN   3994<<ASSIGN
KEYVSF.WD_ONE
       464**DCL       465--REDEF
LAST_PAGE
       114**DCL      3623<<ASSIGN   3797<>CALL     3802>>DOWHILE  3831<>CALL
LEN IN PROCEDURE WRIT
      4490**DCL      4488--PROC     4489--IMP-SIZ  4505>>ASSIGN   4506>>ASSIGN
LENG IN PROCEDURE BINCHAR_SUP
      4518**DCL      4515--PROC     4516--IMP-SIZ  4519>>CALLBLT  4520>>CALL     4520<>CALL
LIST IN PROCEDURE SEARCH_LISTS
      4587**DCL      4586--PROC     4591>>IF
LOCS IN PROCEDURE SET_REPORT
      4530**DCL      4534<<ASSIGN   4535<<ASSIGN   4536<<ASSIGN   4565>>ASSIGN
LOW_DBK
        20**DCL      4005<<ASSIGN   4067>>ASSIGN   4068>>ASSIGN   4083>>ASSIGN
LPP
        21**DCL      4006<<ASSIGN   4067>>ASSIGN   4067>>ASSIGN   4068>>ASSIGN   4068>>ASSIGN   4083>>ASSIGN
      4083>>ASSIGN   4138>>ASSIGN   4143>>ASSIGN   4143>>ASSIGN   4145>>ASSIGN
M$LO
       577**DCL      3903>>ASSIGN   4164>>ASSIGN   4421>>ASSIGN   4503>>ASSIGN
MEMINDX IN PROCEDURE SET_REPORT
      4525**DCL      4560<<ASSIGN   4561>>IF       4563<>CALL     4564>>ASSIGN   4565>>ASSIGN   4566>>ASSIGN
MPY_RSLT1_REAL
        97**DCL      4293<>CALL     4304<>CALL     4382<>CALL     4389<>CALL
MPY_RSLT2_REAL
       100**DCL      4298<>CALL     4302<>CALL     4387<>CALL     4389<>CALL
MSGCODE
       496**DCL       497--REDEF    3733<<ASSIGN   3839<<ASSIGN   3981<<ASSIGN
MSTR$
       946**DCL       949--IMP-PTR  3701>>IF       3705>>ASSIGN   3707>>IF       3717>>IF       3922>>ASSIGN
      3946>>ASSIGN   3947>>ASSIGN   4093>>IF       4110>>ASSIGN   4116>>ASSIGN   4125>>ASSIGN   4190>>IF
      4206>>IF       4206>>IF       4210>>ASSIGN   4354>>ASSIGN   4551>>ASSIGN   4553>>IF       4554>>ASSIGN
      4558>>ASSIGN   4561>>IF       4561>>IF       4564>>ASSIGN   4565>>ASSIGN   4566>>ASSIGN   4593>>IF
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:233  
      4599>>IF
MSTR_INDX
       972**DCL      3921<<ASSIGN   3922>>ASSIGN   3946>>ASSIGN   3947>>ASSIGN   4092<<ASSIGN   4093>>IF
      4110>>ASSIGN   4116>>ASSIGN   4125>>ASSIGN
MSTR_REF.NAME
       954**DCL      3701>>IF       3922>>ASSIGN   4210>>ASSIGN   4354>>ASSIGN   4553>>IF       4554>>ASSIGN
      4564>>ASSIGN   4593>>IF       4599>>IF
MSTR_REF.NEXT
       951**DCL      4558>>ASSIGN
MSTR_REF.NXTHSH
       952**DCL       953--REDEF
MSTR_REF.PAENT
       958**DCL       959--REDEF    3947>>ASSIGN   4125>>ASSIGN
MSTR_REF.PAOFF
       955**DCL       956--REDEF    3707>>IF       3717>>IF       3946>>ASSIGN   4093>>IF       4110>>ASSIGN
      4116>>ASSIGN   4206>>IF
MSTR_REF.PSMODE
       957**DCL      4565>>ASSIGN
MSTR_REF.SET.OWNER_TYPE
       968**DCL      4551>>ASSIGN
MSTR_REF.TYPE
       950**DCL      3705>>ASSIGN   4190>>IF       4206>>IF       4561>>IF       4561>>IF       4566>>ASSIGN
NEED_SUMMARY
       107**DCL      3689<<ASSIGN   3763<<ASSIGN   3875<<ASSIGN   3891<<ASSIGN   4194>>IF       4235>>IF
NEXT IN PROCEDURE SET_REPORT
      4528**DCL      4558<<ASSIGN   4559>>DOWHILE  4560>>ASSIGN   4576<<ASSIGN   4576>>ASSIGN
NEXT_AREA
      3612**LABEL    3862--GOTO
NI IN PROCEDURE SET_REPORT
      4578**LABEL    4549--CALLALT  4553--GOTO
NO_AREAS
       988**DCL      3598>>DOINDEX  3601>>DOINDEX  3605<<ASSIGN   3605>>ASSIGN   3689>>ASSIGN   3763>>ASSIGN
      3854>>IF       3915>>IF       4269>>IF       4401>>IF       4474>>IF
NO_RECS
      1008**DCL      3637>>ASSIGN   3673>>DOINDEX  3683>>DOINDEX  3700>>DOINDEX  3714>>ASSIGN   3789>>ASSIGN
      4189>>DOINDEX
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:234  
NUMFLD IN PROCEDURE BINCHAR_SUP
      4517**DCL      4515--PROC     4519>>CALLBLT
NUM_AREAS_REPORTED
       223**DCL      3588<<ASSIGN   3595<<ASSIGN   3631<<ASSIGN   3631>>ASSIGN   3633>>IF       3661>>IF
      3693>>IF       3772>>IF       3786>>IF       3834>>IF       3854>>IF       3860>>ASSIGN   3864>>IF
NUM_DBKEYS_UNUSED
       267**DCL      4138<<ASSIGN   4141<<ASSIGN   4141>>ASSIGN   4143>>ASSIGN
NUM_DBKEYS_USED
       268**DCL      4022<<ASSIGN   4059<<ASSIGN   4059>>ASSIGN   4145>>ASSIGN
NUM_PA_RECS
      3549**DCL      3634<<ASSIGN   3710<<ASSIGN   3710>>ASSIGN   3711>>ASSIGN   3712>>ASSIGN   3901>>IF
      3917>>DOINDEX  4099<<ASSIGN   4099>>ASSIGN   4100>>ASSIGN   4101>>ASSIGN   4347>>DOINDEX
NUM_PGS IN PROCEDURE REPORT_PAGES
      4419**DCL      4433<<ASSIGN   4437>>IF       4454<<ASSIGN   4454>>ASSIGN   4465<<ASSIGN   4465>>ASSIGN
NUM_PGS_REPORTED
       111**DCL      3627<<ASSIGN   3868<<ASSIGN   3877<<ASSIGN   3884<<ASSIGN   3897<<ASSIGN   4023<<ASSIGN
      4023>>ASSIGN   4295<>CALL     4320<>CALL     4321>>CALL     4367>>ASSIGN   4368>>ASSIGN   4384<>CALL
      4437>>IF       4456>>CALL     4467>>CALL
NUM_PGS_REPORTED_REAL
        98**DCL      4295<>CALL     4298<>CALL     4384<>CALL     4387<>CALL
NX IN PROCEDURE SET_REPORT
      4576**LABEL    4563--CALLALT
NXT_MSLOT
       970**DCL      4548>>DOWHILE
OA
        87**DCL      3871<<ASSIGN   3887<<ASSIGN
OA.HI_SZ
        89**DCL      3625<<ASSIGN   4028>>IF       4029<<ASSIGN   4272>>IF       4272>>ASSIGN   4329>>IF
      4330<>CALL
OA.LO_SZ
        88**DCL      3624<<ASSIGN   4026>>IF       4027<<ASSIGN   4271>>IF       4271>>ASSIGN   4328<>CALL
      4329>>IF
OA.TOT_SZ
        90**DCL      3626<<ASSIGN   4030<<ASSIGN   4030>>ASSIGN   4273>>ASSIGN   4300<>CALL     4331<>CALL
      4368>>ASSIGN
OA_SZ
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:235  
        92**DCL      4025<<ASSIGN   4026>>IF       4027>>ASSIGN   4028>>IF       4029>>ASSIGN   4030>>ASSIGN
      4137>>ASSIGN   4148>>ASSIGN
OA_SZ_REAL
       101**DCL      4300<>CALL     4302<>CALL
ORGSF
       460**DCL      3613<<ASSIGN
OV1
       181**DCL      4543<>CALL     4543--CALL
OV3
       183**DCL      4544<>CALL     4544--CALL
OV3A
       185**DCL      4545<>CALL     4545--CALL
OV4
       187**DCL      4547<<ASSIGN   4550<<ASSIGN   4556<>CALL     4556--CALL     4557<<ASSIGN   4572<>CALL
      4572--CALL     4573<<ASSIGN
OV4.LOC
       195**DCL      4565<<ASSIGN
OV4.MEM
       199**DCL      4569<>CALL
OV4.PGE
       201**DCL      4571<>CALL
OV4.SET
       197**DCL      4555<>CALL
OV4.V.REC
       193**DCL      4564<<ASSIGN
OV4.X
       188**DCL       191--REDEF
OV4.X.SET
       189**DCL      4554<<ASSIGN
OV5
       202**DCL      4540<>CALL     4540--CALL
OV5A
       204**DCL      4541<>CALL     4541--CALL
OWNER IN PROCEDURE SET_REPORT
      4527**DCL      4551<<ASSIGN   4552>>ASSIGN   4561>>IF
PA.MEM_FOUND
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:236  
      3555**DCL      3930<>CALL     4106<<ASSIGN   4129<<ASSIGN   4129>>ASSIGN
PA.OWNER_FOUND
      3554**DCL      3928<>CALL     4104<<ASSIGN   4113<<ASSIGN   4113>>ASSIGN
PA.RECSINDX
      3552**DCL      3712<<ASSIGN   3920>>ASSIGN   4101<<ASSIGN   4349>>ASSIGN
PA.REC_SIZE
      3553**DCL      3946>>ASSIGN   4108<<ASSIGN
PA.SPACE_AVAIL
      3557**DCL      3941>>ASSIGN   3943>>ASSIGN   3949>>ASSIGN   4107<<ASSIGN   4114<<ASSIGN   4114>>ASSIGN
PA.TOT_PTRS
      3556**DCL      3936>>ASSIGN   3938>>ASSIGN   4105<<ASSIGN   4127<<ASSIGN   4127>>ASSIGN
PAGE_RANGE
      3567**DCL-ENT  3797--CALL     3831--CALL
PAH1
       153**DCL      3909<>CALL     3909--CALL
PAH2
       155**DCL      3910<>CALL     3910--CALL
PAH3
       157**DCL      3911<>CALL     3911--CALL
PAH4
       159**DCL      3912<>CALL     3912--CALL
PAH5
       161**DCL      3913<>CALL     3913--CALL
PAH6
       163**DCL      3918--ASSIGN   3919--ASSIGN   3952<>CALL     3952--CALL
PAH6.DOT1
       170**DCL      3932<<ASSIGN
PAH6.DOT2
       176**DCL      3933<<ASSIGN
PAH6.ENT_RES
       173**DCL      3948<>CALL     3948--CALL
PAH6.LEFT_PARAN
       172**DCL      3934<<ASSIGN
PAH6.MEM_FOUND
       167**DCL      3930<>CALL     3930--CALL
PAH6.NUMBER_PTR
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:237  
       169**DCL      3937<>CALL     3937--CALL
PAH6.NUMBER_PTR2
       171**DCL      3940<>CALL     3940--CALL
PAH6.OWNER_FOUND
       165**DCL      3928<>CALL     3928--CALL
PAH6.PA_FOUND
       166**DCL      3925<<ASSIGN   3929<>CALL     3929--CALL
PAH6.PERCENT_MARK
       180**DCL      3931<<ASSIGN
PAH6.PERCENT_SPACE
       179**DCL      3950<>CALL     3950--CALL
PAH6.REC_NAME
       164**DCL      3922<<ASSIGN
PAH6.RIGHT_PARAN
       174**DCL      3935<<ASSIGN
PAH6.SPACE_AVAIL
       175**DCL      3942<>CALL     3942--CALL
PAH6.SPACE_AVAIL2
       177**DCL      3945<>CALL     3945--CALL
PA_ENTRY.C
       143**DCL      4118>>IF
PA_ENTRY.PTRS
       145**DCL      4121>>ASSIGN
PA_GROUP.NO_GROUPS
       149**DCL      4123>>ASSIGN
PA_REC.AVAIL
       138**DCL      4114>>ASSIGN
PA_REC.ENTRIES
       137**DCL      4115>>ASSIGN   4117>>DOINDEX
PA_REC.NOT_LOWEST_LEVEL
       135**DCL      4128>>IF
PA_REC.PTRS
       139**DCL      4112>>IF       4112>>IF
PF1
        70**DCL      4284<>CALL     4372<>CALL
PF2
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:238  
        72**DCL      4288<>CALL     4377<>CALL
PF2.AREA_TOT_RECS
        74**DCL      4285<>CALL     4374<>CALL
PF2.AREA_TOT_SZ
        75**DCL      4286<>CALL     4375<>CALL
PF2.MSG
        76**DCL      4287<<ASSIGN   4376<<ASSIGN
PF2.TYP
        77**DCL      3688<<ASSIGN   3761<<ASSIGN   3874<<ASSIGN   3890<<ASSIGN
PF3
        78**DCL      4313<>CALL     4398<>CALL
PF3.PRCNT_LINE.PRCNT_MSG
        81**DCL      4310<<ASSIGN   4314<<ASSIGN   4395<<ASSIGN   4399<<ASSIGN
PF3.PRCNT_LINE.PRCNT_USED
        82**DCL      4307<>CALL     4308>>IF       4311<<ASSIGN   4392<>CALL     4393>>IF       4396<<ASSIGN
PGS
       245**DCL      3878<<ASSIGN   3898<<ASSIGN
PGS.DNUM
       246**DCL      3782<<ASSIGN   4147<<ASSIGN   4147>>ASSIGN   4459>>IF       4465>>ASSIGN   4466<>CALL
      4467>>CALL     4468>>ASSIGN
PGS.DPRCNT
       247**DCL      3783<<ASSIGN
PGS.PRCNT
       248**DCL      4436>>ASSIGN
PGS.SNUM
       253**DCL      3780<<ASSIGN   4150<<ASSIGN   4150>>ASSIGN   4448>>IF       4454>>ASSIGN   4455>>CALL
      4456>>CALL     4457>>ASSIGN
PGS.SPRCNT
       254**DCL      3781<<ASSIGN
PG_TOT_SZ
       269**DCL      4021<<ASSIGN   4069<<ASSIGN   4069>>ASSIGN   4084<<ASSIGN   4084>>ASSIGN   4137<<ASSIGN
      4137>>ASSIGN   4148>>ASSIGN
PH0
        48**DCL      3906--ASSIGN   4166--ASSIGN   4423--ASSIGN   4539<>CALL     4539--CALL
PH0.AREA_NAME
        51**DCL      3630<<ASSIGN   3873<<ASSIGN   3889<<ASSIGN   3896<<ASSIGN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:239  
PH1
        52**DCL      4170<>CALL
PH2
        53**DCL      4171<>CALL
PH3
        54**DCL      4172<>CALL
PH4
        57**DCL      4173<>CALL
PH5
       225**DCL      4427<>CALL
PH6
       226**DCL      4428<>CALL
PH7
       227**DCL      4429<>CALL
PH8
       228**DCL      4430<>CALL
PH9
       231**DCL      4431<>CALL
PLINE
       235**DCL      4471<>CALL
PLINE.DNUM
       236**DCL      4441<<ASSIGN   4461<<ASSIGN   4466<>CALL
PLINE.DPRCNT
       237**DCL      4443<<ASSIGN   4462<<ASSIGN   4467<>CALL
PLINE.PRCNT
       239**DCL      4436<<ASSIGN
PLINE.PRCNT.HI
       241**DCL      4439<<ASSIGN
PLINE.SNUM
       242**DCL      4440<<ASSIGN   4450<<ASSIGN   4455<>CALL
PLINE.SPRCNT
       243**DCL      4442<<ASSIGN   4451<<ASSIGN   4456<>CALL
PRCNT
       104**DCL      4306<>CALL     4307<>CALL     4391<>CALL     4392<>CALL
PRCNT_DBKEYS_FULL
       266**DCL      4143<<ASSIGN   4145<<ASSIGN   4146>>IF       4146<<ASSIGN   4147>>ASSIGN   4147>>ASSIGN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:240  
PRCNT_SPACE_FULL
       265**DCL      4148<<ASSIGN   4149>>IF       4149<<ASSIGN   4150>>ASSIGN   4150>>ASSIGN
PRINT_ERRMSG
      3730**LABEL    3723--GOTO
PROCESS_PAGE
      4017**PROC     3827--CALL
PTR_BIN
       151**DCL      3923<<ASSIGN   3924>>IF       3929<>CALL     3936>>ASSIGN   3938>>ASSIGN   3939>>ASSIGN
      3941>>ASSIGN   3943>>ASSIGN   3944>>ASSIGN   3949>>ASSIGN   4120<<ASSIGN   4121--ASSIGN   4122>>ASSIGN
PTR_SIZE
       132**DCL       139--IMP-SIZ   145--IMP-SIZ   150--IMP-SIZ  3918<<ASSIGN   3919>>ASSIGN   3946<<ASSIGN
      3947>>ASSIGN   3949>>ASSIGN   4110<<ASSIGN   4112>>IF       4112>>IF       4112>>IF       4121>>ASSIGN
      4121>>ASSIGN   4121>>ASSIGN
RB
       549**DCL      3797<>CALL     3810>>ASSIGN   3814<<DOINDEX  3814>>DOINDEX  3831<>CALL
RCNT
       555**DCL      3658>>IF       3696>>DOINDEX  3752>>DOINDEX  3766>>DOINDEX  3788>>IF       3791>>ASSIGN
      4039>>IF       4040>>DOINDEX  4045>>ASSIGN   4097>>IF       4136>>IF       4188>>IF       4224>>DOINDEX
      4268>>IF       4563>>IF
RE
       550**DCL      3797<>CALL     3814>>DOINDEX  3831<>CALL
REAL100
        96**DCL      4291<>CALL     4293<>CALL     4380<>CALL     4382<>CALL
REAL4072
        99**DCL      4296<>CALL     4298<>CALL
REAL4096
       105**DCL      4385<>CALL     4387<>CALL
REC
        24**DCL        27--REDEF
REC.LEN
        26**DCL      4064>>ASSIGN   4065>>ASSIGN   4066>>ASSIGN   4069>>ASSIGN   4078>>IF       4079>>ASSIGN
      4080>>IF       4081>>ASSIGN   4082>>ASSIGN   4084>>ASSIGN   4108>>ASSIGN
REC.TYPE
        25**DCL      4041>>IF       4050>>ASSIGN
REC$
       548**DCL        23--IMP-PTR   133--IMP-PTR   571--IMP-PTR  4033<<ASSIGN   4034>>ASSIGN   4112>>IF
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:241  
      4112>>IF       4114>>ASSIGN   4115>>ASSIGN   4116>>ASSIGN   4117>>DOINDEX  4122>>ASSIGN   4128>>IF
RECORD
        23**DCL      4034>>ASSIGN
RECORD_LIST.NAME
      3518**DCL      3698>>IF       3699<<ASSIGN   3701>>IF       3730>>CALLBLT  3732>>ASSIGN   4225>>ASSIGN
      4593>>IF
RECORD_LIST.TYPE
      3519**DCL      3705<<ASSIGN   4041>>IF
RECS
        30**DCL      4191>>ASSIGN
RECS.HI_DBKEY
        36**DCL      4068<<ASSIGN   4083<<ASSIGN   4203>>IF       4204>>ASSIGN   4218<>CALL     4244>>IF
      4245>>ASSIGN   4256<>CALL     4362<>CALL
RECS.HI_SZ
        34**DCL      4065<<ASSIGN   4080>>IF       4081<<ASSIGN   4198>>IF       4199>>ASSIGN   4212>>IF
      4213<>CALL     4239>>IF       4240>>ASSIGN   4250>>IF       4251<>CALL     4356>>IF       4357<>CALL
RECS.LO_DBKEY
        35**DCL      4067<<ASSIGN   4201>>IF       4202>>ASSIGN   4217<>CALL     4242>>IF       4243>>ASSIGN
      4255<>CALL     4361<>CALL
RECS.LO_SZ
        33**DCL      4064<<ASSIGN   4078>>IF       4079<<ASSIGN   4196>>IF       4197>>ASSIGN   4211<>CALL
      4212>>IF       4237>>IF       4238>>ASSIGN   4249<>CALL     4250>>IF       4355<>CALL     4356>>IF
RECS.NO_OF_PAGES
        37**DCL      4072<<ASSIGN   4087<<ASSIGN   4087>>ASSIGN   4568<<ASSIGN   4570>>ASSIGN
RECS.NO_OF_RECS
        31**DCL      3684<<ASSIGN   3739<<ASSIGN   3767<<ASSIGN   3923>>ASSIGN   4061>>IF       4063<<ASSIGN
      4077<<ASSIGN   4077>>ASSIGN   4191>>IF       4192>>IF       4208>>ASSIGN   4215<>CALL     4226>>IF
      4247>>ASSIGN   4253<>CALL     4350>>IF       4352>>ASSIGN   4359<>CALL     4552>>ASSIGN   4567>>ASSIGN
RECS.TOT_SZ
        32**DCL      4066<<ASSIGN   4082<<ASSIGN   4082>>ASSIGN   4200>>ASSIGN   4209>>ASSIGN   4216<>CALL
      4241>>ASSIGN   4248>>ASSIGN   4254<>CALL     4353>>ASSIGN   4360<>CALL
RECS$
        29**DCL        30--IMP-PTR  3636<>CALL     3639>>ASSIGN   3684>>ASSIGN   3739>>ASSIGN   3767>>ASSIGN
      3867<<ASSIGN   3883<<ASSIGN   3916<<ASSIGN   3923>>ASSIGN   4061>>IF       4063>>ASSIGN   4064>>ASSIGN
      4065>>ASSIGN   4066>>ASSIGN   4067>>ASSIGN   4068>>ASSIGN   4072>>ASSIGN   4077>>ASSIGN   4077>>ASSIGN
      4078>>IF       4079>>ASSIGN   4080>>IF       4081>>ASSIGN   4082>>ASSIGN   4082>>ASSIGN   4083>>ASSIGN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:242  
      4087>>ASSIGN   4087>>ASSIGN   4191>>IF       4191>>ASSIGN   4192>>IF       4196>>IF       4197>>ASSIGN
      4198>>IF       4199>>ASSIGN   4200>>ASSIGN   4201>>IF       4202>>ASSIGN   4203>>IF       4204>>ASSIGN
      4208>>ASSIGN   4209>>ASSIGN   4211>>CALL     4212>>IF       4212>>IF       4213>>CALL     4215>>CALL
      4216>>CALL     4217>>CALL     4218>>CALL     4226>>IF       4237>>IF       4238>>ASSIGN   4239>>IF
      4240>>ASSIGN   4241>>ASSIGN   4242>>IF       4243>>ASSIGN   4244>>IF       4245>>ASSIGN   4247>>ASSIGN
      4248>>ASSIGN   4249>>CALL     4250>>IF       4250>>IF       4251>>CALL     4253>>CALL     4254>>CALL
      4255>>CALL     4256>>CALL     4350>>IF       4352>>ASSIGN   4353>>ASSIGN   4355>>CALL     4356>>IF
      4356>>IF       4357>>CALL     4359>>CALL     4360>>CALL     4361>>CALL     4362>>CALL     4552>>ASSIGN
      4567>>ASSIGN   4568>>ASSIGN   4570>>ASSIGN
REC_DATA_LN
       576**DCL       575--IMP-SIZ
REC_IN_LIST
       108**DCL      4035<<ASSIGN   4043<<ASSIGN   4049<<ASSIGN   4057>>IF
REC_OK
       110**DCL      3697<<ASSIGN   3704<<ASSIGN   3717>>IF       3725>>IF
REC_REDEF
        27**DCL      4034<<ASSIGN
REC_TABLE IN PROCEDURE PROCESS_PAGE
      4019**DCL      4020<<ASSIGN   4070>>IF       4073<<ASSIGN   4085>>IF       4089<<ASSIGN
REC_TYPE IN PROCEDURE SET_REPORT
      4531**DCL      4566<<ASSIGN   4567>>ASSIGN   4568>>ASSIGN   4570>>ASSIGN
REC_XREF.MSTRINDX
      1004**DCL      4560>>ASSIGN
REC_XREF.NEXT
      1003**DCL      4576>>ASSIGN
REC_XREF$
      1001**DCL      1002--IMP-PTR  4560>>ASSIGN   4576>>ASSIGN
REPORT_PAGES
      4417**PROC     3848--CALL     3852--CALL     3879--CALL     3899--CALL
REPORT_RECORD
      4162**PROC     3847--CALL     3851--CALL     3876--CALL     3892--CALL
RESTART
       587**DCL      3824>>UNWIND   4501>>UNWIND
RLINE
        61**DCL      4219<>CALL     4258<>CALL     4324<>CALL     4332<>CALL     4345<>CALL     4363<>CALL
RLINE.HI_DBKEY
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:243  
        68**DCL      4218<>CALL     4232<<ASSIGN   4256<>CALL     4323<<ASSIGN   4343<>CALL     4362<>CALL
RLINE.HI_SZ
        64**DCL      4213<>CALL     4214<<ASSIGN   4228<<ASSIGN   4251<>CALL     4252<<ASSIGN   4319<<ASSIGN
      4330<>CALL     4339<>CALL     4340<<ASSIGN   4357<>CALL     4358<<ASSIGN
RLINE.LO_DBKEY
        67**DCL      4217<>CALL     4231<<ASSIGN   4255<>CALL     4322<<ASSIGN   4342<>CALL     4361<>CALL
RLINE.LO_SZ
        63**DCL      4211<>CALL     4227<<ASSIGN   4249<>CALL     4318<<ASSIGN   4328<>CALL     4337<>CALL
      4355<>CALL
RLINE.NO_OF_RECS
        65**DCL      4215<>CALL     4229<<ASSIGN   4253<>CALL     4320<>CALL     4344<>CALL     4359<>CALL
RLINE.REC_NAME
        62**DCL      4210<<ASSIGN   4225<<ASSIGN   4317<<ASSIGN   4326<<ASSIGN   4336<<ASSIGN   4354<<ASSIGN
RLINE.TOT_SZ
        66**DCL      4216<>CALL     4230<<ASSIGN   4254<>CALL     4321<>CALL     4331<>CALL     4341<>CALL
      4360<>CALL
SCNT
       556**DCL      4549>>IF
SEARCH_LISTS
      4586**PROC     4549--CALL     4563--CALL
SET_BUFS
      3564**DCL-ENT  3635--CALL
SET_LIST.NAME
      3521**DCL      4599>>IF
SET_OCC IN PROCEDURE SET_REPORT
      4526**DCL      4552<<ASSIGN   4555<>CALL     4567>>ASSIGN
SET_XREF$
       990**DCL       991--IMP-PTR
SHARESF
       510**DCL      3617<<ASSIGN
SINDX IN PROCEDURE SEARCH_LISTS
      4589**DCL      4586--PROC     4593>>IF       4599>>IF
SUBTRACT_RSLT_REAL
       102**DCL      4302<>CALL     4304<>CALL
SYS_FUNC_CLOS
      3569**DCL-ENT  3735--CALL     3818--CALL     3833--CALL     3858--CALL     3984--CALL     4495--CALL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:244  
SYS_FUNC_ERRMSG
      3572**DCL-ENT  3734--CALL     3842--CALL     3983--CALL
SYS_FUNC_OPEN
      3568**DCL-ENT  3619--CALL
SYS_FUNC_READ
      3570**DCL-ENT  3812--CALL     3995--CALL
SYS_FUNC_RELDCB
      3574**DCL-ENT  3859--CALL
SYS_FUNC_WRIT
      3571**DCL-ENT  3907--CALL     4168--CALL     4425--CALL     4507--CALL
TYPE.MSTRINDX
       938**DCL      4050>>ASSIGN   4551>>ASSIGN   4566>>ASSIGN
UWA.AC_REC.CALC_NEXT
      3175**DCL      3176--REDEF
UWA.AC_REC.CALC_PRIOR
      3184**DCL      3185--REDEF
UWA.AC_REC.DEFAULTS
      3133**DCL      3134--REDEF
UWA.AC_REC.FILE_CODE
      3138**DCL      3139--REDEF
UWA.AC_REC.FLAG1.ERROR_TYPE
      3135**DCL      3136--REDEF
UWA.AC_REC.PG_TYPE
      3150**DCL      3151--REDEF
UWA.AD_REC.ADDATE
      3115**DCL      3116--REDEF
VALUE IN PROCEDURE SET_REPORT
      4529**DCL      4567<<ASSIGN   4568>>IF       4569<>CALL     4570<<ASSIGN   4570>>ASSIGN   4571<>CALL
VFCSF
       476**DCL      3904<<ASSIGN   4165<<ASSIGN   4422<<ASSIGN   4504<<ASSIGN
WRIT
      4488**PROC     3908--CALL     3909--CALL     3910--CALL     3911--CALL     3912--CALL     3913--CALL
      3914--CALL     3952--CALL     3954--CALL     3955--CALL     4169--CALL     4170--CALL     4171--CALL
      4172--CALL     4173--CALL     4174--CALL     4219--CALL     4258--CALL     4284--CALL     4288--CALL
      4313--CALL     4315--CALL     4324--CALL     4332--CALL     4345--CALL     4363--CALL     4372--CALL
      4377--CALL     4398--CALL     4403--CALL     4404--CALL     4426--CALL     4427--CALL     4428--CALL
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:245  
      4429--CALL     4430--CALL     4431--CALL     4432--CALL     4471--CALL     4476--CALL     4477--CALL
      4539--CALL     4540--CALL     4541--CALL     4543--CALL     4544--CALL     4545--CALL     4556--CALL
      4572--CALL     4574--CALL
X
       565**DCL      3637<<ASSIGN   3638>>IF       3638<>CALL     3639>>ASSIGN   3673<<DOINDEX  3674>>ASSIGN
      3675>>ASSIGN   3676>>ASSIGN   3677>>ASSIGN   3678>>ASSIGN   3679>>ASSIGN   3680>>ASSIGN   3683<<DOINDEX
      3684>>ASSIGN   3685>>ASSIGN   3685>>ASSIGN   3696<<DOINDEX  3698>>IF       3699>>ASSIGN   3701>>IF
      3705>>ASSIGN   3706>>ASSIGN   3711>>ASSIGN   3712>>ASSIGN   3717>>IF       3730>>CALLBLT  3732>>ASSIGN
      3739>>ASSIGN   3752<<DOINDEX  3753>>ASSIGN   3754>>ASSIGN   3755>>ASSIGN   3756>>ASSIGN   3757>>ASSIGN
      3758>>ASSIGN   3766<<DOINDEX  3767>>ASSIGN   3773<<DOINDEX  3774>>ASSIGN   3775>>ASSIGN   3776>>ASSIGN
      3777>>ASSIGN   3779<<DOINDEX  3780>>ASSIGN   3781>>ASSIGN   3782>>ASSIGN   3783>>ASSIGN   3789<<ASSIGN
      3791<<ASSIGN   3792>>DOINDEX  3917<<DOINDEX  3920>>ASSIGN   3928>>CALL     3930>>CALL     3936>>ASSIGN
      3938>>ASSIGN   3941>>ASSIGN   3943>>ASSIGN   3946>>ASSIGN   3949>>ASSIGN   4044<<ASSIGN   4050<<ASSIGN
      4060>>ASSIGN   4060>>ASSIGN   4061>>IF       4063>>ASSIGN   4064>>ASSIGN   4065>>ASSIGN   4066>>ASSIGN
      4067>>ASSIGN   4068>>ASSIGN   4070>>IF       4072>>ASSIGN   4073>>ASSIGN   4077>>ASSIGN   4077>>ASSIGN
      4078>>IF       4079>>ASSIGN   4080>>IF       4081>>ASSIGN   4082>>ASSIGN   4082>>ASSIGN   4083>>ASSIGN
      4085>>IF       4087>>ASSIGN   4087>>ASSIGN   4089>>ASSIGN   4092>>ASSIGN   4095>>IF       4100>>ASSIGN
      4101>>ASSIGN   4103>>ASSIGN   4111>>ASSIGN   4117<<DOINDEX  4139<<DOINDEX  4140>>IF       4189<<DOINDEX
      4190>>IF       4191>>IF       4191>>ASSIGN   4192>>IF       4196>>IF       4196>>IF       4197>>ASSIGN
      4197>>ASSIGN   4198>>IF       4198>>IF       4199>>ASSIGN   4199>>ASSIGN   4200>>ASSIGN   4200>>ASSIGN
      4200>>ASSIGN   4201>>IF       4201>>IF       4202>>ASSIGN   4202>>ASSIGN   4203>>IF       4203>>IF
      4204>>ASSIGN   4204>>ASSIGN   4206>>IF       4206>>IF       4208>>ASSIGN   4209>>ASSIGN   4210>>ASSIGN
      4211>>CALL     4212>>IF       4212>>IF       4213>>CALL     4215>>CALL     4216>>CALL     4217>>CALL
      4218>>CALL     4224<<DOINDEX  4225>>ASSIGN   4226>>IF       4237>>IF       4237>>IF       4238>>ASSIGN
      4238>>ASSIGN   4239>>IF       4239>>IF       4240>>ASSIGN   4240>>ASSIGN   4241>>ASSIGN   4241>>ASSIGN
      4241>>ASSIGN   4242>>IF       4242>>IF       4243>>ASSIGN   4243>>ASSIGN   4244>>IF       4244>>IF
      4245>>ASSIGN   4245>>ASSIGN   4247>>ASSIGN   4248>>ASSIGN   4249>>CALL     4250>>IF       4250>>IF
      4251>>CALL     4253>>CALL     4254>>CALL     4255>>CALL     4256>>CALL     4347<<DOINDEX  4349>>ASSIGN
      4435<<DOINDEX  4436>>ASSIGN   4444<<ASSIGN   4448>>IF       4454>>ASSIGN   4455>>CALL     4456>>CALL
      4457>>ASSIGN   4457>>ASSIGN   4457>>ASSIGN   4459>>IF       4465>>ASSIGN   4466>>CALL     4467>>CALL
      4468>>ASSIGN   4468>>ASSIGN   4468>>ASSIGN
XREF_BUILT
      1010**DCL      3589>>IF       3821<<ASSIGN   3961<<ASSIGN   4496>>IF       4498<<ASSIGN
Y
       130**DCL      3792<<DOINDEX  3793>>ASSIGN   3920<<ASSIGN   3921>>ASSIGN   3923>>ASSIGN   4103<<ASSIGN
      4104>>ASSIGN   4105>>ASSIGN   4106>>ASSIGN   4107>>ASSIGN   4108>>ASSIGN   4111<<ASSIGN   4113>>ASSIGN
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:246  
      4113>>ASSIGN   4114>>ASSIGN   4114>>ASSIGN   4127>>ASSIGN   4127>>ASSIGN   4129>>ASSIGN   4129>>ASSIGN
      4349<<ASSIGN   4350>>IF       4352>>ASSIGN   4353>>ASSIGN   4354>>ASSIGN   4355>>CALL     4356>>IF
      4356>>IF       4357>>CALL     4359>>CALL     4360>>CALL     4361>>CALL     4362>>CALL
ZERO_SUP
      3566**DCL-ENT  4520--CALL
ZI$DIR.ALTKEY
      3471**DCL      3472--REDEF    3473--REDEF
ZI$DIR.AREAFID
      3437**DCL      3438--REDEF
ZI$DIR.AREA_NM
      3500**DCL      3861<>CALL
ZI$DIR.AREA_NM.DCB#
      3504**DCL      3612>>ASSIGN   3805>>ASSIGN   3857>>ASSIGN   3988>>ASSIGN   4493>>ASSIGN
ZI$DIR.AREA_NM.NAME.CNT
      3502**DCL      3840>>ASSIGN
ZI$DIR.AREA_NM.NAME.TEXT
      3503**DCL      3618>>ASSIGN   3630>>ASSIGN   3841>>ASSIGN   3860<<ASSIGN
ZI$DIR.AUTODUMP
      3424**DCL      3596>>IF       3661>>IF       3689>>ASSIGN   3742>>IF       3763>>ASSIGN   3772>>IF
      3834>>IF       3854>>IF       3915>>IF       3957<<ASSIGN   4269>>IF       4401>>IF       4474>>IF
ZI$DIR.DATE
      3476**DCL      3480--REDEF
ZI$DIR.DEST_SEED
      3432**DCL      3433--REDEF    3434--REDEF
ZI$DIR.ENCP_SEED
      3429**DCL      3430--REDEF    3431--REDEF    3811>>ASSIGN   3992>>ASSIGN
ZI$DIR.REPRT_ALL
      3458**DCL      3707>>IF       3771>>IF       3845>>IF       3865>>IF       3901>>IF       4135>>IF
ZI$DIR.REPRT_PA
      3472**DCL      3707>>IF       3717>>IF       3901>>IF
ZI$DIR.REPRT_PG
      3460**DCL      3771>>IF       3852>>IF       3894>>IF       4135>>IF
ZI$DIR.REPRT_REC
      3459**DCL      3850>>IF       3881>>IF
ZI$DIR.REPRT_ZERO
      3463**DCL      3464--REDEF
PL6.E3A0      #001=ZIU$REPRT File=ZIU$REPRT.:ZIC0TSI                             FRI 09/05/97 13:29 Page:247  
ZI$DIR.SCHFID
      3435**DCL      3436--REDEF
ZI$DIR.TIME
      3481**DCL      3486--REDEF
