
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:1    
        1        1        /*M* ZIU$DCBMGR    IDSII   PROG KEEPS TRACK OF USER DCBS FOR ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$DCBMGR: PROC(USER_NUM,DCB_ID,INDX) ALTRET;
        8        8
        9        9    1   DCL USER_NUM UBIN BYTE CALIGNED;
       10       10    1   DCL DCB_ID UBIN HALF CALIGNED;
       11       11    1   DCL INDX SBIN WORD CALIGNED;
       12       12
       13       13    1   DCL X SBIN WORD STATIC;
       14       14    1   DCL TEMP SBIN HALF STATIC;
       15       15
       16       16         %INCLUDE ZI_DBU_ROLL;
       17      100         %ROLL_SUBS;
       18      119         %ROLL_LIST;
       19      178
       20      179    1   DCL EXPAND_TBL_SEG ENTRY(2) ALTRET;
       21      180
       22      181         %SUB CURRENT_NOT_END_OF_CHAIN = "DCBX ~= -1";
       23      182         %SUB CURRENT_IS_END_OF_CHAIN = "DCBX = -1";
       24      183
       25      184    1   STR_USER_FIDID: ENTRY(USER_NUM,DCB_ID,INDX) ALTRET;
       26      185
       27      186    1       DCBX = USER.DCBINDX(USER_NUM);
       28      187
       29      188    1       IF DCBX = -1 THEN
       30      189    2       DO;
       31      190    2           USER.DCBINDX(USER_NUM) = NXT_AVIL_DCBSLOT;
       32      191    2           DCBLIST.FIDINDX(NXT_AVIL_DCBSLOT) = INDX;
       33      192    2           DCBLIST.DCBID(NXT_AVIL_DCBSLOT) = DCB_ID;
       34      193    2           CALL FILL_NXT_AVIL ALTRET(ALTRTRN);
       35      194    2           RETURN;
       36      195    2           END;
       37      196
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:2    
       38      197    2       DO WHILE(CURRENT_NOT_END_OF_CHAIN);
       39      198    2           X = DCBX;
       40      199    2           DCBX = DCBLIST.NEXT(DCBX);
       41      200    2           END;
       42      201
       43      202    1       DCBLIST.NEXT(X) = NXT_AVIL_DCBSLOT;
       44      203    1       DCBLIST.FIDINDX(NXT_AVIL_DCBSLOT) = INDX;
       45      204    1       DCBLIST.DCBID(NXT_AVIL_DCBSLOT) = DCB_ID;
       46      205    1       CALL FILL_NXT_AVIL ALTRET(ALTRTRN);
       47      206
       48      207    1       RETURN;
       49      208
       50      209
       51      210        /*
       52      211                 Find users DCBID entry in DCBLIST : NOTE- DCBID is only an
       53      212               identifier for which fid is desired - not the dcb open to that file.
       54      213        */
       55      214    1   FIND_USER_FIDID: ENTRY(USER_NUM,DCB_ID,INDX) ALTRET;
       56      215
       57      216    1       DCBX = USER.DCBINDX(USER_NUM);
       58      217    2       DO WHILE(DCBX ~= -1 AND DCBLIST.DCBID(DCBX) ~= DCB_ID);
       59      218
       60      219    2           DCBX = DCBLIST.NEXT(DCBX);
       61      220    2           END;
       62      221
       63      222    1       IF DCBX = -1 THEN
       64      223    1           INDX = 0;
       65      224    1       ELSE
       66      225    1           INDX = DCBLIST.FIDINDX(DCBX);
       67      226
       68      227    1       RETURN;
       69      228
       70      229        /*
       71      230                     Delete  a  users   DCBID   entries. ( When user ends job )
       72      231        */
       73      232    1   DEL_USER_FIDS: ENTRY(USER_NUM) ALTRET;
       74      233
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:3    
       75      234    1       DCBX = USER.DCBINDX(USER_NUM);
       76      235    2       DO WHILE(CURRENT_NOT_END_OF_CHAIN);
       77      236    2           DCBLIST.FIDINDX(DCBX) = -1;
       78      237    2           DCBLIST.DCBID(DCBX) = 0;
       79      238    2           X = DCBX;
       80      239    2           DCBX = DCBLIST.NEXT(DCBX);
       81      240    2           END;
       82      241
       83      242    1       IF USER.DCBINDX(USER_NUM) ~= -1 THEN
       84      243    2       DO;
       85      244    2           DCBLIST.NEXT(X) = NXT_AVIL_DCBSLOT;
       86      245    2           NXT_AVIL_DCBSLOT = USER.DCBINDX(USER_NUM);
       87      246    2           USER.DCBINDX(USER_NUM) = -1;
       88      247    2           END;
       89      248
       90      249    1       RETURN;
       91      250
       92      251        /*
       93      252              Delete a indivual DCBID from user ( when a user closes a file )
       94      253        */
       95      254    1   ERASE_USER_DCBID: ENTRY(USER_NUM,DCB_ID) ALTRET;
       96      255
       97      256    1       DCBX = USER.DCBINDX(USER_NUM);
       98      257    2       DO WHILE(DCBX ~= -1 AND DCBLIST.DCBID(DCBX) ~= DCB_ID);
       99      258    2           DCBX = DCBLIST.NEXT(DCBX);
      100      259    2           END;
      101      260    1       IF DCBX ~= -1 THEN
      102      261    1           DCBLIST.DCBID(DCBX) = 0; /* Zero out ID for reuse */
      103      262
      104      263    1       RETURN;
      105      264
      106      265        /*
      107      266                  Fill the next available dcbslot with next one available.
      108      267        */
      109      268    1   FILL_NXT_AVIL: PROC ALTRET;
      110      269
      111      270    2       DCBX = NXT_AVIL_DCBSLOT; /* MARK SLOT OF LAST USED DCBSLOT */
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:4    
      112      271    2       IF DCBLIST.NEXT(NXT_AVIL_DCBSLOT) ~= -1 THEN
      113      272    3       DO;
      114      273    3           NXT_AVIL_DCBSLOT = DCBLIST.NEXT(DCBX);
      115      274    3           DCBLIST.NEXT(DCBX) = -1;
      116      275    3           END;
      117      276    3       ELSE DO;
      118      277    3           NXT_AVIL_DCBSLOT = LAST_UNUSED_DCBSLOT;
      119      278    3           LAST_UNUSED_DCBSLOT = LAST_UNUSED_DCBSLOT+1;
      120      279    3           IF NXT_AVIL_DCBSLOT > MAX_DCBINDX THEN
      121      280    4           DO;
      122      281    4               CALL EXPAND_TBL_SEG(,DCBLST#) ALTRET(NSPACE);
      123      282    4               MAX_DCBINDX = MAX_DCBINDX + 682;
      124      283    5               DO X = NXT_AVIL_DCBSLOT TO MAX_DCBINDX;
      125      284    5                   DCBLIST.FIDINDX(X) = -1;
      126      285    5                   DCBLIST.DCBID(X) = 0;
      127      286    5                   DCBLIST.NEXT(X) = -1;
      128      287    5                   END;
      129      288    4               END;
      130      289    3           END;
      131      290    2       RETURN;
      132      291
      133      292    2   NSPACE:
      134      293    2       ALTRETURN;
      135      294    2   END FILL_NXT_AVIL;
      136      295
      137      296    1   ALTRTRN:
      138      297    1       ALTRETURN;
      139      298    1   END ZIU$DCBMGR;

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:5    
--  Include file information  --

   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIU$DCBMGR.

   Procedure ZIU$DCBMGR requires 322 words for executable code.
   Procedure ZIU$DCBMGR requires 10 words of local(AUTO) storage.

    No errors detected in file ZIU$DCBMGR.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:6    

 Object Unit name= ZIU$DCBMGR                                 File name= ZIU$DCBMGR.:ZIC0TOU
 UTS= SEP 05 '97 13:14:21.04 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     2      2  ZIU$DCBMGR
    1   Proc  even  none   322    502  ZIU$DCBMGR
    2  RoData even  none     5      5  ZIU$DCBMGR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        3  ZIU$DCBMGR
     1      3          yes     yes      Std        3  STR_USER_FIDID
     1    122          yes     yes      Std        3  FIND_USER_FIDID
     1    214          yes     yes      Std        1  DEL_USER_FIDS
     1    320          yes     yes      Std        2  ERASE_USER_DCBID

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 EXPAND_TBL_SEG
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:7    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     FID$                                  DCBLIST$                              USER$
     FID_INDXS$                            FID_INDXS                             NXT_AVIL_FIDSLOT
     NXT_AVIL_DCBSLOT                      LAST_UNUSED_DCBSLOT                   USER
     NO                                    FIRST                                 LAST
     MAX_DCBINDX                           MAX_FIDINDX                           FIDX
     DCBX                                  BRK_ROLL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:8    


        1        1        /*M* ZIU$DCBMGR    IDSII   PROG KEEPS TRACK OF USER DCBS FOR ROLL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIU$DCBMGR: PROC(USER_NUM,DCB_ID,INDX) ALTRET;

      7  1 000000   000000 700200 xent  ZIU$DCBMGR   TSX0  ! X66_AUTO_3
         1 000001   000012 000003                    ZERO    10,3
         1 000002   000005 710000 1                  TRA     s:186

        8        8
        9        9    1   DCL USER_NUM UBIN BYTE CALIGNED;
       10       10    1   DCL DCB_ID UBIN HALF CALIGNED;
       11       11    1   DCL INDX SBIN WORD CALIGNED;
       12       12
       13       13    1   DCL X SBIN WORD STATIC;
       14       14    1   DCL TEMP SBIN HALF STATIC;
       15       15
       16       16         %INCLUDE ZI_DBU_ROLL;
       17      100         %ROLL_SUBS;
       18      119         %ROLL_LIST;
       19      178
       20      179    1   DCL EXPAND_TBL_SEG ENTRY(2) ALTRET;
       21      180
       22      181         %SUB CURRENT_NOT_END_OF_CHAIN = "DCBX ~= -1";
       23      182         %SUB CURRENT_IS_END_OF_CHAIN = "DCBX = -1";
       24      183
       25      184    1   STR_USER_FIDID: ENTRY(USER_NUM,DCB_ID,INDX) ALTRET;

    184  1 000003   000000 700200 xent  STR_USER_FI* TSX0  ! X66_AUTO_3
         1 000004   000012 000003                    ZERO    10,3

       26      185
       27      186    1       DCBX = USER.DCBINDX(USER_NUM);
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:9    

    186  1 000005   200003 470500                    LDP0    @USER_NUM,,AUTO
         1 000006   000100 101500                    MRL     fill='000'O
         1 000007   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000010   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000011   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000012   000005 402007                    MPY     5,DL
         1 000013   000000 236006 xsym               LDQ     USER,QL
         1 000014   000022 736000                    QLS     18
         1 000015   000022 732000                    QRS     18
         1 000016   000000 756000 xsym               STQ     DCBX

       28      187
       29      188    1       IF DCBX = -1 THEN

    188  1 000017   000000 116000 2                  CMPQ    0
         1 000020   000053 601000 1                  TNZ     s:197

       30      189    2       DO;

       31      190    2           USER.DCBINDX(USER_NUM) = NXT_AVIL_DCBSLOT;

    190  1 000021   000100 101500                    MRL     fill='000'O
         1 000022   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000023   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000024   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000025   000005 402007                    MPY     5,DL
         1 000026   000000 220000 xsym               LDX0    NXT_AVIL_DCBSLOT
         1 000027   000000 440006 xsym               SXL0    USER,QL

       32      191    2           DCBLIST.FIDINDX(NXT_AVIL_DCBSLOT) = INDX;

    191  1 000030   000000 236000 xsym               LDQ     NXT_AVIL_DCBSLOT
         1 000031   000022 732000                    QRS     18
         1 000032   000006 402007                    MPY     6,DL
         1 000033   200005 471500                    LDP1    @INDX,,AUTO
         1 000034   000000 473400 xsym               LDP3    DCBLIST$
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:10   
         1 000035   000106 101500                    MRL     fill='000'O
         1 000036   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         1 000037   300000 000002                    ADSC9   0,Q,PR3                  cn=0,n=2

       33      192    2           DCBLIST.DCBID(NXT_AVIL_DCBSLOT) = DCB_ID;

    192  1 000040   000000 236000 xsym               LDQ     NXT_AVIL_DCBSLOT
         1 000041   000022 732000                    QRS     18
         1 000042   000006 402007                    MPY     6,DL
         1 000043   200004 473500                    LDP3    @DCB_ID,,AUTO
         1 000044   000000 474400 xsym               LDP4    DCBLIST$
         1 000045   000106 100500                    MLR     fill='000'O
         1 000046   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         1 000047   400000 400002                    ADSC9   0,Q,PR4                  cn=2,n=2

       34      193    2           CALL FILL_NXT_AVIL ALTRET(ALTRTRN);

    193  1 000050   000376 701000 1                  TSX1    FILL_NXT_AVIL
         1 000051   000501 702000 1                  TSX2    ALTRTRN

       35      194    2           RETURN;

    194  1 000052   000000 702200 xent               TSX2  ! X66_ARET

       36      195    2           END;
       37      196
       38      197    2       DO WHILE(CURRENT_NOT_END_OF_CHAIN);

    197  1 000053   000067 710000 1                  TRA     s:200

       39      198    2           X = DCBX;

    198  1 000054   000000 235000 xsym               LDA     DCBX
         1 000055   000000 755000 0                  STA     X

       40      199    2           DCBX = DCBLIST.NEXT(DCBX);

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:11   
    199  1 000056   000000 236000 xsym               LDQ     DCBX
         1 000057   000006 402007                    MPY     6,DL
         1 000060   000000 470400 xsym               LDP0    DCBLIST$
         1 000061   000100 100506                    MLR     fill='000'O
         1 000062   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2
         1 000063   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000064   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000065   000022 732000                    QRS     18
         1 000066   000000 756000 xsym               STQ     DCBX

       41      200    2           END;

    200  1 000067   000000 116000 2                  CMPQ    0
         1 000070   000054 601000 1                  TNZ     s:198

       42      201
       43      202    1       DCBLIST.NEXT(X) = NXT_AVIL_DCBSLOT;

    202  1 000071   000000 236000 0                  LDQ     X
         1 000072   000006 402007                    MPY     6,DL
         1 000073   000000 470400 xsym               LDP0    DCBLIST$
         1 000074   000106 100400                    MLR     fill='000'O
         1 000075   000000 000002 xsym               ADSC9   NXT_AVIL_DCBSLOT         cn=0,n=2
         1 000076   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2

       44      203    1       DCBLIST.FIDINDX(NXT_AVIL_DCBSLOT) = INDX;

    203  1 000077   000000 236000 xsym               LDQ     NXT_AVIL_DCBSLOT
         1 000100   000022 732000                    QRS     18
         1 000101   000006 402007                    MPY     6,DL
         1 000102   200005 470500                    LDP0    @INDX,,AUTO
         1 000103   000000 471400 xsym               LDP1    DCBLIST$
         1 000104   000106 101500                    MRL     fill='000'O
         1 000105   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         1 000106   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2

       45      204    1       DCBLIST.DCBID(NXT_AVIL_DCBSLOT) = DCB_ID;
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:12   

    204  1 000107   000000 236000 xsym               LDQ     NXT_AVIL_DCBSLOT
         1 000110   000022 732000                    QRS     18
         1 000111   000006 402007                    MPY     6,DL
         1 000112   200004 471500                    LDP1    @DCB_ID,,AUTO
         1 000113   000000 473400 xsym               LDP3    DCBLIST$
         1 000114   000106 100500                    MLR     fill='000'O
         1 000115   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         1 000116   300000 400002                    ADSC9   0,Q,PR3                  cn=2,n=2

       46      205    1       CALL FILL_NXT_AVIL ALTRET(ALTRTRN);

    205  1 000117   000376 701000 1                  TSX1    FILL_NXT_AVIL
         1 000120   000501 702000 1                  TSX2    ALTRTRN

       47      206
       48      207    1       RETURN;

    207  1 000121   000000 702200 xent               TSX2  ! X66_ARET

       49      208
       50      209
       51      210        /*
       52      211                 Find users DCBID entry in DCBLIST : NOTE- DCBID is only an
       53      212               identifier for which fid is desired - not the dcb open to that file.
       54      213        */
       55      214    1   FIND_USER_FIDID: ENTRY(USER_NUM,DCB_ID,INDX) ALTRET;

    214  1 000122   000000 700200 xent  FIND_USER_F* TSX0  ! X66_AUTO_3
         1 000123   000012 000003                    ZERO    10,3

       56      215
       57      216    1       DCBX = USER.DCBINDX(USER_NUM);

    216  1 000124   200003 470500                    LDP0    @USER_NUM,,AUTO
         1 000125   000100 101500                    MRL     fill='000'O
         1 000126   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:13   
         1 000127   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000130   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000131   000005 402007                    MPY     5,DL
         1 000132   000000 236006 xsym               LDQ     USER,QL
         1 000133   000022 736000                    QLS     18
         1 000134   000022 732000                    QRS     18
         1 000135   000000 756000 xsym               STQ     DCBX

       58      217    2       DO WHILE(DCBX ~= -1 AND DCBLIST.DCBID(DCBX) ~= DCB_ID);

    217  1 000136   000150 710000 1                  TRA     s:220

       59      218
       60      219    2           DCBX = DCBLIST.NEXT(DCBX);

    219  1 000137   000000 236000 xsym               LDQ     DCBX
         1 000140   000006 402007                    MPY     6,DL
         1 000141   000000 470400 xsym               LDP0    DCBLIST$
         1 000142   000100 100506                    MLR     fill='000'O
         1 000143   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2
         1 000144   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000145   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000146   000022 732000                    QRS     18
         1 000147   000000 756000 xsym               STQ     DCBX

       61      220    2           END;

    220  1 000150   000000 116000 2                  CMPQ    0
         1 000151   000166 600000 1                  TZE     s:222
         1 000152   200004 470500                    LDP0    @DCB_ID,,AUTO
         1 000153   000100 101500                    MRL     fill='000'O
         1 000154   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         1 000155   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000156   000006 402007                    MPY     6,DL
         1 000157   000000 471400 xsym               LDP1    DCBLIST$
         1 000160   000100 101506                    MRL     fill='000'O
         1 000161   100000 400002                    ADSC9   0,Q,PR1                  cn=2,n=2
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:14   
         1 000162   200011 000004                    ADSC9   @INDX+4,,AUTO            cn=0,n=4
         1 000163   200011 236100                    LDQ     @INDX+4,,AUTO
         1 000164   200010 116100                    CMPQ    @INDX+3,,AUTO
         1 000165   000137 601000 1                  TNZ     s:219

       62      221
       63      222    1       IF DCBX = -1 THEN

    222  1 000166   000000 235000 xsym               LDA     DCBX
         1 000167   000000 115000 2                  CMPA    0
         1 000170   000176 601000 1                  TNZ     s:225

       64      223    1           INDX = 0;

    223  1 000171   200005 470500                    LDP0    @INDX,,AUTO
         1 000172   000100 100400                    MLR     fill='000'O
         1 000173   000001 000004 2                  ADSC9   1                        cn=0,n=4
         1 000174   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         1 000175   000213 710000 1                  TRA     s:227

       65      224    1       ELSE
       66      225    1           INDX = DCBLIST.FIDINDX(DCBX);

    225  1 000176   000000 236000 xsym               LDQ     DCBX
         1 000177   000006 402007                    MPY     6,DL
         1 000200   000000 470400 xsym               LDP0    DCBLIST$
         1 000201   000100 100506                    MLR     fill='000'O
         1 000202   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2
         1 000203   200011 000004                    ADSC9   @INDX+4,,AUTO            cn=0,n=4
         1 000204   200011 236100                    LDQ     @INDX+4,,AUTO
         1 000205   000022 732000                    QRS     18
         1 000206   200010 756100                    STQ     @INDX+3,,AUTO
         1 000207   200005 471500                    LDP1    @INDX,,AUTO
         1 000210   000100 100500                    MLR     fill='000'O
         1 000211   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000212   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:15   
       67      226
       68      227    1       RETURN;

    227  1 000213   000000 702200 xent               TSX2  ! X66_ARET

       69      228
       70      229        /*
       71      230                     Delete  a  users   DCBID   entries. ( When user ends job )
       72      231        */
       73      232    1   DEL_USER_FIDS: ENTRY(USER_NUM) ALTRET;

    232  1 000214   000000 700200 xent  DEL_USER_FI* TSX0  ! X66_AUTO_3
         1 000215   000012 000003                    ZERO    10,3

       74      233
       75      234    1       DCBX = USER.DCBINDX(USER_NUM);

    234  1 000216   200003 470500                    LDP0    @USER_NUM,,AUTO
         1 000217   000100 101500                    MRL     fill='000'O
         1 000220   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000221   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000222   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000223   000005 402007                    MPY     5,DL
         1 000224   000000 236006 xsym               LDQ     USER,QL
         1 000225   000022 736000                    QLS     18
         1 000226   000022 732000                    QRS     18
         1 000227   000000 756000 xsym               STQ     DCBX

       76      235    2       DO WHILE(CURRENT_NOT_END_OF_CHAIN);

    235  1 000230   000260 710000 1                  TRA     s:240

       77      236    2           DCBLIST.FIDINDX(DCBX) = -1;

    236  1 000231   000000 236000 xsym               LDQ     DCBX
         1 000232   000006 402007                    MPY     6,DL
         1 000233   000000 470400 xsym               LDP0    DCBLIST$
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:16   
         1 000234   000106 101400                    MRL     fill='000'O
         1 000235   000000 000004 2                  ADSC9   0                        cn=0,n=4
         1 000236   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2

       78      237    2           DCBLIST.DCBID(DCBX) = 0;

    237  1 000237   000000 236000 xsym               LDQ     DCBX
         1 000240   000006 402007                    MPY     6,DL
         1 000241   000000 470400 xsym               LDP0    DCBLIST$
         1 000242   000106 101400                    MRL     fill='000'O
         1 000243   000001 000004 2                  ADSC9   1                        cn=0,n=4
         1 000244   000000 400002                    ADSC9   0,Q,PR0                  cn=2,n=2

       79      238    2           X = DCBX;

    238  1 000245   000000 235000 xsym               LDA     DCBX
         1 000246   000000 755000 0                  STA     X

       80      239    2           DCBX = DCBLIST.NEXT(DCBX);

    239  1 000247   000000 236000 xsym               LDQ     DCBX
         1 000250   000006 402007                    MPY     6,DL
         1 000251   000000 470400 xsym               LDP0    DCBLIST$
         1 000252   000100 100506                    MLR     fill='000'O
         1 000253   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2
         1 000254   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000255   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000256   000022 732000                    QRS     18
         1 000257   000000 756000 xsym               STQ     DCBX

       81      240    2           END;

    240  1 000260   000000 116000 2                  CMPQ    0
         1 000261   000231 601000 1                  TNZ     s:236

       82      241
       83      242    1       IF USER.DCBINDX(USER_NUM) ~= -1 THEN
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:17   

    242  1 000262   200003 470500                    LDP0    @USER_NUM,,AUTO
         1 000263   000100 101500                    MRL     fill='000'O
         1 000264   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000265   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000266   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000267   000005 402007                    MPY     5,DL
         1 000270   000000 720006 xsym               LXL0    USER,QL
         1 000271   777777 100003                    CMPX0   -1,DU
         1 000272   000317 600000 1                  TZE     s:249

       84      243    2       DO;

       85      244    2           DCBLIST.NEXT(X) = NXT_AVIL_DCBSLOT;

    244  1 000273   000000 236000 0                  LDQ     X
         1 000274   000006 402007                    MPY     6,DL
         1 000275   000000 471400 xsym               LDP1    DCBLIST$
         1 000276   000106 100400                    MLR     fill='000'O
         1 000277   000000 000002 xsym               ADSC9   NXT_AVIL_DCBSLOT         cn=0,n=2
         1 000300   100001 000002                    ADSC9   1,Q,PR1                  cn=0,n=2

       86      245    2           NXT_AVIL_DCBSLOT = USER.DCBINDX(USER_NUM);

    245  1 000301   000100 101500                    MRL     fill='000'O
         1 000302   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000303   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000304   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000305   000005 402007                    MPY     5,DL
         1 000306   000000 720006 xsym               LXL0    USER,QL
         1 000307   000000 740000 xsym               STX0    NXT_AVIL_DCBSLOT

       87      246    2           USER.DCBINDX(USER_NUM) = -1;

    246  1 000310   000100 101500                    MRL     fill='000'O
         1 000311   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000312   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:18   
         1 000313   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000314   000005 402007                    MPY     5,DL
         1 000315   777777 221003                    LDX1    -1,DU
         1 000316   000000 441006 xsym               SXL1    USER,QL

       88      247    2           END;

       89      248
       90      249    1       RETURN;

    249  1 000317   000000 702200 xent               TSX2  ! X66_ARET

       91      250
       92      251        /*
       93      252              Delete a indivual DCBID from user ( when a user closes a file )
       94      253        */
       95      254    1   ERASE_USER_DCBID: ENTRY(USER_NUM,DCB_ID) ALTRET;

    254  1 000320   000000 700200 xent  ERASE_USER_* TSX0  ! X66_AUTO_3
         1 000321   000012 000003                    ZERO    10,3

       96      255
       97      256    1       DCBX = USER.DCBINDX(USER_NUM);

    256  1 000322   200003 470500                    LDP0    @USER_NUM,,AUTO
         1 000323   000100 101500                    MRL     fill='000'O
         1 000324   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000325   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000326   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000327   000005 402007                    MPY     5,DL
         1 000330   000000 236006 xsym               LDQ     USER,QL
         1 000331   000022 736000                    QLS     18
         1 000332   000022 732000                    QRS     18
         1 000333   000000 756000 xsym               STQ     DCBX

       98      257    2       DO WHILE(DCBX ~= -1 AND DCBLIST.DCBID(DCBX) ~= DCB_ID);

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:19   
    257  1 000334   000346 710000 1                  TRA     s:259

       99      258    2           DCBX = DCBLIST.NEXT(DCBX);

    258  1 000335   000000 236000 xsym               LDQ     DCBX
         1 000336   000006 402007                    MPY     6,DL
         1 000337   000000 470400 xsym               LDP0    DCBLIST$
         1 000340   000100 100506                    MLR     fill='000'O
         1 000341   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2
         1 000342   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000343   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000344   000022 732000                    QRS     18
         1 000345   000000 756000 xsym               STQ     DCBX

      100      259    2           END;

    259  1 000346   000000 116000 2                  CMPQ    0
         1 000347   000364 600000 1                  TZE     s:260
         1 000350   200004 470500                    LDP0    @DCB_ID,,AUTO
         1 000351   000100 101500                    MRL     fill='000'O
         1 000352   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         1 000353   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000354   000006 402007                    MPY     6,DL
         1 000355   000000 471400 xsym               LDP1    DCBLIST$
         1 000356   000100 101506                    MRL     fill='000'O
         1 000357   100000 400002                    ADSC9   0,Q,PR1                  cn=2,n=2
         1 000360   200011 000004                    ADSC9   @INDX+4,,AUTO            cn=0,n=4
         1 000361   200011 236100                    LDQ     @INDX+4,,AUTO
         1 000362   200010 116100                    CMPQ    @INDX+3,,AUTO
         1 000363   000335 601000 1                  TNZ     s:258

      101      260    1       IF DCBX ~= -1 THEN

    260  1 000364   000000 235000 xsym               LDA     DCBX
         1 000365   000000 115000 2                  CMPA    0
         1 000366   000375 600000 1                  TZE     s:263

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:20   
      102      261    1           DCBLIST.DCBID(DCBX) = 0; /* Zero out ID for reuse */

    261  1 000367   000000 236000 xsym               LDQ     DCBX
         1 000370   000006 402007                    MPY     6,DL
         1 000371   000000 470400 xsym               LDP0    DCBLIST$
         1 000372   000106 101400                    MRL     fill='000'O
         1 000373   000001 000004 2                  ADSC9   1                        cn=0,n=4
         1 000374   000000 400002                    ADSC9   0,Q,PR0                  cn=2,n=2

      103      262
      104      263    1       RETURN;

    263  1 000375   000000 702200 xent               TSX2  ! X66_ARET

      105      264
      106      265        /*
      107      266                  Fill the next available dcbslot with next one available.
      108      267        */
      109      268    1   FILL_NXT_AVIL: PROC ALTRET;

    268  1 000376   200006 741300       FILL_NXT_AV* STX1  ! @INDX+1,,AUTO

      110      269
      111      270    2       DCBX = NXT_AVIL_DCBSLOT; /* MARK SLOT OF LAST USED DCBSLOT */

    270  1 000377   000000 235000 xsym               LDA     NXT_AVIL_DCBSLOT
         1 000400   000022 731000                    ARS     18
         1 000401   000000 755000 xsym               STA     DCBX

      112      271    2       IF DCBLIST.NEXT(NXT_AVIL_DCBSLOT) ~= -1 THEN

    271  1 000402   000000 236000 xsym               LDQ     NXT_AVIL_DCBSLOT
         1 000403   000022 732000                    QRS     18
         1 000404   000006 402007                    MPY     6,DL
         1 000405   000000 470400 xsym               LDP0    DCBLIST$
         1 000406   000100 100506                    MLR     fill='000'O
         1 000407   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:21   
         1 000410   200010 000004                    ADSC9   @INDX+3,,AUTO            cn=0,n=4
         1 000411   200010 236100                    LDQ     @INDX+3,,AUTO
         1 000412   000022 732000                    QRS     18
         1 000413   000000 116000 2                  CMPQ    0
         1 000414   000426 600000 1                  TZE     s:277

      113      272    3       DO;

      114      273    3           NXT_AVIL_DCBSLOT = DCBLIST.NEXT(DCBX);

    273  1 000415   000000 236000 xsym               LDQ     DCBX
         1 000416   000006 402007                    MPY     6,DL
         1 000417   000000 100506                    MLR     fill='000'O
         1 000420   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2
         1 000421   000000 000002 xsym               ADSC9   NXT_AVIL_DCBSLOT         cn=0,n=2

      115      274    3           DCBLIST.NEXT(DCBX) = -1;

    274  1 000422   000106 101400                    MRL     fill='000'O
         1 000423   000000 000004 2                  ADSC9   0                        cn=0,n=4
         1 000424   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2

      116      275    3           END;

    275  1 000425   000475 710000 1                  TRA     s:290

      117      276    3       ELSE DO;

      118      277    3           NXT_AVIL_DCBSLOT = LAST_UNUSED_DCBSLOT;

    277  1 000426   000000 220000 xsym               LDX0    LAST_UNUSED_DCBSLOT
         1 000427   000000 740000 xsym               STX0    NXT_AVIL_DCBSLOT

      119      278    3           LAST_UNUSED_DCBSLOT = LAST_UNUSED_DCBSLOT+1;

    278  1 000430   000001 622010                    EAX2    1,X0
         1 000431   000000 742000 xsym               STX2    LAST_UNUSED_DCBSLOT
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:22   

      120      279    3           IF NXT_AVIL_DCBSLOT > MAX_DCBINDX THEN

    279  1 000432   000000 236000 xsym               LDQ     NXT_AVIL_DCBSLOT
         1 000433   000022 732000                    QRS     18
         1 000434   000000 116000 xsym               CMPQ    MAX_DCBINDX
         1 000435   000475 604400 1                  TMOZ    s:290

      121      280    4           DO;

      122      281    4               CALL EXPAND_TBL_SEG(,DCBLST#) ALTRET(NSPACE);

    281  1 000436   000004 236000 2                  LDQ     4
         1 000437   000003 235000 2                  LDA     3
         1 000440   200010 757100                    STAQ    @INDX+3,,AUTO
         1 000441   200010 630500                    EPPR0   @INDX+3,,AUTO
         1 000442   000002 631400 2                  EPPR1   2
         1 000443   000000 701000 xent               TSX1    EXPAND_TBL_SEG
         1 000444   000477 702000 1                  TSX2    NSPACE

      123      282    4               MAX_DCBINDX = MAX_DCBINDX + 682;

    282  1 000445   001252 236007                    LDQ     682,DL
         1 000446   000000 056000 xsym               ASQ     MAX_DCBINDX

      124      283    5               DO X = NXT_AVIL_DCBSLOT TO MAX_DCBINDX;

    283  1 000447   000000 235000 xsym               LDA     NXT_AVIL_DCBSLOT
         1 000450   000022 731000                    ARS     18
         1 000451   000000 755000 0                  STA     X
         1 000452   000472 710000 1                  TRA     s:287+1

      125      284    5                   DCBLIST.FIDINDX(X) = -1;

    284  1 000453   000000 236000 0                  LDQ     X
         1 000454   000006 402007                    MPY     6,DL
         1 000455   000000 470400 xsym               LDP0    DCBLIST$
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:23   
         1 000456   000106 101400                    MRL     fill='000'O
         1 000457   000000 000004 2                  ADSC9   0                        cn=0,n=4
         1 000460   000000 000002                    ADSC9   0,Q,PR0                  cn=0,n=2

      126      285    5                   DCBLIST.DCBID(X) = 0;

    285  1 000461   000000 470400 xsym               LDP0    DCBLIST$
         1 000462   000106 101400                    MRL     fill='000'O
         1 000463   000001 000004 2                  ADSC9   1                        cn=0,n=4
         1 000464   000000 400002                    ADSC9   0,Q,PR0                  cn=2,n=2

      127      286    5                   DCBLIST.NEXT(X) = -1;

    286  1 000465   000000 470400 xsym               LDP0    DCBLIST$
         1 000466   000106 101400                    MRL     fill='000'O
         1 000467   000000 000004 2                  ADSC9   0                        cn=0,n=4
         1 000470   000001 000002                    ADSC9   1,Q,PR0                  cn=0,n=2

      128      287    5                   END;

    287  1 000471   000000 054000 0                  AOS     X
         1 000472   000000 236000 0                  LDQ     X
         1 000473   000000 116000 xsym               CMPQ    MAX_DCBINDX
         1 000474   000453 604400 1                  TMOZ    s:284

      129      288    4               END;

      130      289    3           END;

      131      290    2       RETURN;

    290  1 000475   200006 221300                    LDX1  ! @INDX+1,,AUTO
         1 000476   000001 702211                    TSX2  ! 1,X1

      132      291
      133      292    2   NSPACE:
      134      293    2       ALTRETURN;
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:24   

    293  1 000477   200006 221300       NSPACE       LDX1  ! @INDX+1,,AUTO
         1 000500   000000 702211                    TSX2  ! 0,X1

      135      294    2   END FILL_NXT_AVIL;
      136      295
      137      296    1   ALTRTRN:
      138      297    1       ALTRETURN;

    297  1 000501   000000 702200 xent  ALTRTRN      TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
   2     000   777777 777777   000000 000000   000002 000000   000000 006014    ................
   2     004   000001 006000                                                    ....
      139      298    1   END ZIU$DCBMGR;

PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:25   
--  Include file information  --

   ZI_DBU_ROLL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIU$DCBMGR.

   Procedure ZIU$DCBMGR requires 322 words for executable code.
   Procedure ZIU$DCBMGR requires 10 words of local(AUTO) storage.

    No errors detected in file ZIU$DCBMGR.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:26   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:27   
          MINI XREF LISTING

ALTRTRN
       297**LABEL     193--CALLALT   205--CALLALT
DCBLIST.DCBID
       152**DCL       192<<ASSIGN    204<<ASSIGN    217>>DOWHILE   237<<ASSIGN    257>>DOWHILE   261<<ASSIGN
       285<<ASSIGN
DCBLIST.FIDINDX
       151**DCL       191<<ASSIGN    203<<ASSIGN    225>>ASSIGN    236<<ASSIGN    284<<ASSIGN
DCBLIST.NEXT
       153**DCL       199>>ASSIGN    202<<ASSIGN    219>>ASSIGN    239>>ASSIGN    244<<ASSIGN    258>>ASSIGN
       271>>IF        273>>ASSIGN    274<<ASSIGN    286<<ASSIGN
DCBLIST$
       127**DCL       150--IMP-PTR   191>>ASSIGN    192>>ASSIGN    199>>ASSIGN    202>>ASSIGN    203>>ASSIGN
       204>>ASSIGN    217>>DOWHILE   219>>ASSIGN    225>>ASSIGN    236>>ASSIGN    237>>ASSIGN    239>>ASSIGN
       244>>ASSIGN    257>>DOWHILE   258>>ASSIGN    261>>ASSIGN    271>>IF        273>>ASSIGN    274>>ASSIGN
       284>>ASSIGN    285>>ASSIGN    286>>ASSIGN
DCBX
       175**DCL       186<<ASSIGN    188>>IF        197>>DOWHILE   198>>ASSIGN    199<<ASSIGN    199>>ASSIGN
       216<<ASSIGN    217>>DOWHILE   217>>DOWHILE   219<<ASSIGN    219>>ASSIGN    222>>IF        225>>ASSIGN
       234<<ASSIGN    235>>DOWHILE   236>>ASSIGN    237>>ASSIGN    238>>ASSIGN    239<<ASSIGN    239>>ASSIGN
       256<<ASSIGN    257>>DOWHILE   257>>DOWHILE   258<<ASSIGN    258>>ASSIGN    260>>IF        261>>ASSIGN
       270<<ASSIGN    273>>ASSIGN    274>>ASSIGN
DCB_ID
        10**DCL         7--PROC      184--ENTRY     192>>ASSIGN    204>>ASSIGN    214--ENTRY     217>>DOWHILE
       254--ENTRY     257>>DOWHILE
EXPAND_TBL_SEG
       179**DCL-ENT   281--CALL
FID$
       126**DCL       130--IMP-PTR
FIDLIST.CRPT
       139**DCL       140--REDEF
FILL_NXT_AVIL
       268**PROC      193--CALL      205--CALL
PL6.E3A0      #001=ZIU$DCBMGR File=ZIU$DCBMGR.:ZIC0TSI                           FRI 09/05/97 13:14 Page:28   
INDX
        11**DCL         7--PROC      184--ENTRY     191>>ASSIGN    203>>ASSIGN    214--ENTRY     223<<ASSIGN
       225<<ASSIGN
LAST_UNUSED_DCBSLOT
       149**DCL       277>>ASSIGN    278<<ASSIGN    278>>ASSIGN
MAX_DCBINDX
       170**DCL       279>>IF        282<<ASSIGN    282>>ASSIGN    283>>DOINDEX
NSPACE IN PROCEDURE FILL_NXT_AVIL
       293**LABEL     281--CALLALT
NXT_AVIL_DCBSLOT
       148**DCL       190>>ASSIGN    191>>ASSIGN    192>>ASSIGN    202>>ASSIGN    203>>ASSIGN    204>>ASSIGN
       244>>ASSIGN    245<<ASSIGN    270>>ASSIGN    271>>IF        273<<ASSIGN    277<<ASSIGN    279>>IF
       283>>DOINDEX
USER.DCBINDX
       156**DCL       186>>ASSIGN    190<<ASSIGN    216>>ASSIGN    234>>ASSIGN    242>>IF        245>>ASSIGN
       246<<ASSIGN    256>>ASSIGN
USER_NUM
         9**DCL         7--PROC      184--ENTRY     186>>ASSIGN    190>>ASSIGN    214--ENTRY     216>>ASSIGN
       232--ENTRY     234>>ASSIGN    242>>IF        245>>ASSIGN    246>>ASSIGN    254--ENTRY     256>>ASSIGN
X
        13**DCL       198<<ASSIGN    202>>ASSIGN    238<<ASSIGN    244>>ASSIGN    283<<DOINDEX   284>>ASSIGN
       285>>ASSIGN    286>>ASSIGN
