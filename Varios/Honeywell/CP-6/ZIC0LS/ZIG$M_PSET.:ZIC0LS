
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:1    
        1        1        /*M*     ZIG$M_PSET     I-D-S/II  DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$M_PSET
        9        9        PURPOSE: THIS SUBROUTINE IS CALLED FROM X$PARSE TO DO THREE THINGS:
       10       10                 FIRST:
       11       11                      TO GET MORE INPUT FOR X$PARSE IF THE LINE CONTINUES.
       12       12                      TO DO THIS IT CALLS ZIG$M_READ.
       13       13                 SECOND:
       14       14                      TO SET THING IN THE SCHEMA FOR THE THING GIVEN
       15       15                      IN THE DMCL.
       16       16                 THIRD:
       17       17                      TO FIND ALL SYNTAX ERRORS AND PRINT OUT THE MESSAGES
       18       18                      ON BOTH M$LO AND M$DO BY M$ERRMSG.
       19       19                      ALSO IT WILL TRY AND RECOVER FROM ALL SYNTAX ERROR AND
       20       20                      PARSE AS MUCH AS POSIBLE SO ONE COULD GET COMPOUNDING
       21       21                      ERRORS BUT HE SHOULD GET ALL THE ERROR IN THE DMCL
       22       22                      PRINTED OUT IN ONE PASS OF THE SYNTAX CHECKER.
       23       23        */
       24       24        /*
       25       25            Note:
       26       26                 The code to do pointer arrays is not in this subroutine
       27       27                 as it was in ZIG$DDD8. So when pointer arrays are added
       28       28                 to the dmcl then they will have to be added to this
       29       29                 routine and ZIG$M_PSI (the X$PARSE source);
       30       30        */
       31       31        ZIG$M_PSET:
       32       32            PROC (PARAN);
       33       33    1   DCL ZIG$M_READ ENTRY;
       34       34    1   DCL SRCHD ENTRY(3) ; /* CHAR(30),UBIN (18), bit (1) */
       35       35    1   DCL WARNING ENTRY (1); /* Ubin (36) */
       36       36    1   DCL ERROR ENTRY (1); /* Ubin (36) */
       37       37    1   DCL SET_FIELDS ENTRY (3);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:2    
       38       38    1   DCL WORD1 CHAR (30) STATIC;
       39       39    1   DCL SUCC BIT (1) STATIC;
       40       40    1   DCL BAD_AREA BIT (1) STATIC;
       41       41    1   DCL DBK_AC UBIN (36) STATIC;
       42       42    1   DCL DBK_RC UBIN (36) STATIC;
       43       43    1   DCL SEPNTR UBIN (36) STATIC;
       44       44    1   DCL NUM UBIN (36) STATIC;
       45       45    1   DCL BAD_RECORD BIT (1) STATIC;
       46       46    1   DCL DBK_SC UBIN (36) STATIC;
       47       47    1   DCL 1 FIELD1 EXT,
       48       48    1         2 COUNT1 UBIN (9) UNAL,
       49       49    1         2 TEXT1 CHAR (31) UNAL;
       50       50    1   DCL MAXN BIT (36) INIT ('111111111111111111111111111111111110'B)
       51       51    1    STATIC;
       52       52    1   DCL MAX1 REDEF MAXN UBIN (36);
       53       53    1   DCL HIGH_DBK UBIN (36) STATIC;
       54       54    1   DCL LOW_DBK UBIN (36) STATIC;
       55       55    1   DCL ABORT ENTRY;
       56       56    1   DCL END_DMCL BIT (1) EXT;
       57       57    1   DCL LINE CHAR (1) EXT;
       58       58    1   DCL J UBIN (36);
       59       59    1   DCL SYNTAX_ERR BIT (72) SYMREF;
       60       60    1   DCL PAREC_USER_PLACE UBIN (36) STATIC;
       61       61    1   DCL PAREC_PA_PLACE UBIN (36) STATIC;
       62       62    1   DCL PAREC_NUMB_SK UBIN (36) STATIC;
       63       63    1   DCL PAREC_SMDBK UBIN (36) STATIC;
       64       64    1   DCL SAVE_PA_TYPE UBIN (36) STATIC;
       65       65    1   DCL SAVE_PA_ENTRY UBIN (36) STATIC;
       66       66    1   DCL I UBIN (36);
       67       67    1   DCL INDEX_AREA BIT(1) STATIC;
       68       68        %INCLUDE ZIG_TYPE_SUBS;
       69       83        %INCLUDE ZI_SUB4_CAN;
       70      740        %UWA;
       71     1075        %INCLUDE ZIG_DBA_INT;
       72     1123        %INCLUDE ZI_ERRORS_SUBS;
       73     1643        %INCLUDE XU_MACRO_C;
       74     4749        %INCLUDE XU_SUBS_C;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:3    
       75     4841        %P$PCB(NAME=DMCL_P,STCLASS=SYMREF);
       76     5042        %PARSE$PARAM(NAME=PARAN);
       77     5123        %PARSE$OUT(NAME=BLK,STCLASS=BASED);
       78     5168        %PARSE$SYM(NAME=SYM,STCLASS=BASED);
       79     5206    1   PROCCESS_NAME: PROC;
       80     5207    2       SEPNTR=UWA.DIRECT_REF;
       81     5208    2       CALL FETCHNS_6('SN-SE   ') ALTRET(FAIL1);
       82     5209    2       SEPNTR=UWA.DIRECT_REF;
       83     5210    2       IF UWA.SN.SETYPE= 20
       84     5211    3       THEN DO;
       85     5212    3           UWA.AC.PER_INV=0;
       86     5213    3           CALL DISCONNECT_6('OA-AC   ');
       87     5214    3           CALL CONNECT_6('OA-AC   ');
       88     5215    3           DBK_AC=UWA.DIRECT_REF;
       89     5216    3           CALL MODT('AC  ');
       90     5217    3           END;
       91     5218    2       IF UWA.SN.SETYPE = 40
       92     5219    3       THEN DO;
       93     5220    3           CALL FETCHD_6('RC  ',SEPNTR); /* Find dbk and get */
       94     5221    3           DBK_RC = UWA.DIRECT_REF;
       95     5222    3           END;
       96     5223    2       IF UWA.SN.SETYPE = 30
       97     5224    3       THEN DO;
       98     5225    3           CALL FETCHD_6('SC  ',SEPNTR);
       99     5226    3           DBK_SC= UWA.DIRECT_REF;
      100     5227    3           END;
      101     5228    2       RETURN;
      102     5229    2   FAIL1: CALL ERROR(2014);
      103     5230        /*E*     ERROR:    ZIG-2014-C
      104     5231        MESSAGE: %U1 is not defined in the schema.
      105     5232        */
      106     5233    2   END PROCCESS_NAME;
      107     5234    1   MODT:
      108     5235    1       PROC (TYPE_C);
      109     5236    2   DCL TYPE_C CHAR (4);
      110     5237    2       CALL FCURR_R_6(TYPE_C);
      111     5238    2       CALL MODIFY_6(TYPE_C);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:4    
      112     5239    2       RETURN;
      113     5240    2   END MODT;
      114     5241    1   GET_WORD:
      115     5242    1       PROC;
      116     5243    2       WORD1=PARAN.OUT$ -> BLK.SUBLK$(0) -> SYM.TEXT;
      117     5244    2       FIELD1.COUNT1=PARAN.OUT$ -> BLK.SUBLK$(0) -> SYM.COUNT;
      118     5245    2       FIELD1.TEXT1=WORD1;
      119     5246    2       RETURN;
      120     5247    2   END GET_WORD;
      121     5248    1   GET_NUM:
      122     5249    1       PROC(LOW,HIGH);
      123     5250    2   DCL LOW UBIN (36);
      124     5251    2   DCL HIGH UBIN (36);
      125     5252    2       CALL GET_WORD;
      126     5253    2       CALL CHARBIN(NUM,SUBSTR(WORD1,0,FIELD1.COUNT1));
      127     5254    2       IF NUM<LOW OR NUM>HIGH
      128     5255    3       THEN DO;
      129     5256    3           CALL ERROR(2000+PARAN.CODE);
      130     5257    3           CALL WARNING(2199);
      131     5258    3           NUM=LOW;
      132     5259        /*E*     ERROR:    ZIG-2199-C
      133     5260        MESSAGE: The number %U1 will be set to the lowest limit for further
      134     5261                 syntax checking to continue.
      135     5262        */
      136     5263    3           END;
      137     5264    2   END GET_NUM;
      138     5265    1   POWER_2:
      139     5266    1       PROC(NUM_2);
      140     5267    2   DCL NUM_2 UBIN (36);
      141     5268    2   DCL I UBIN (36);
      142     5269    2   DCL I_B(0:35) REDEF I BIT (1) UNAL;
      143     5270    2   DCL COUNT UBIN (36);
      144     5271    2       I=1;
      145     5272    2       COUNT=0;
      146     5273    3       DO WHILE (I<NUM_2 AND COUNT<35);
      147     5274    3           COUNT=COUNT+1;
      148     5275    3           I_B(36-COUNT)='0'B;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:5    
      149     5276    3           I_B(35-COUNT)='1'B;
      150     5277    3           END;
      151     5278    2       NUM=I;
      152     5279    2   END POWER_2;
      153     5280    2       DO CASE (PARAN.TYPE);
      154     5281    2       CASE(%INPUT#);
      155     5282    2           IF END_DMCL THEN UNWIND TO SYNTAX_ERR;
      156     5283    2           CALL ZIG$M_READ;
      157     5284    2           IF END_DMCL THEN UNWIND TO SYNTAX_ERR;
      158     5285    2       CASE(%SUCC#, %PRE#);
      159     5286    3           DO CASE (PARAN.CODE);
      160     5287    3           CASE(3); /* Schema name */
      161     5288    3               CALL GET_WORD;
      162     5289    3               CALL SRCHD(WORD1,%ZIG_RTYPE_OA,SUCC);
      163     5290    3               IF ~SUCC THEN CALL ERROR(2099);
      164     5291        /*E*     ERROR:    ZIG-02099-C
      165     5292        MESSAGE: Schema name %U1 is not the same as the schema name
      166     5293                 in the schema file.
      167     5294        */
      168     5295    3           CASE(4); /*File code */
      169     5296    3               CALL WARNING(2101);
      170     5297        /*E*     ERROR:    ZIG-2101-C
      171     5298        MESSAGE: File codes are not used in CP-6 I-D-S/II.
      172     5299        */
      173     5300    3           CASE(5); /* End of area */
      174     5301    3               IF UWA.AC.FLAG1.STATUS=0 AND ~INDEX_AREA
      175     5302    4               THEN DO;
      176     5303    4                   UWA.AC.MAX_DBK=100;
      177     5304    4                   CALL ERROR(2104);
      178     5305        /*E*     ERROR:    ZIG-2104-C
      179     5306        MESSAGE: The ALLOCATE clause for each area must be given.
      180     5307        */
      181     5308    4                   END;
      182     5309    3               ELSE UWA.AC.FLAG1.STATUS=2;
      183     5310    3               IF INDEX_AREA
      184     5311    4               THEN DO;
      185     5312    4                   UWA.AC.PAGE_TYP = 3;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:6    
      186     5313    4                   UWA.AC.DBK_CALC=0;
      187     5314    4                   END;
      188     5315    3               IF ~BAD_AREA THEN CALL MODT('AC  ');
      189     5316    3               ELSE UWA.AC.FLAG1.STATUS=0;
      190     5317    3               BAD_AREA='0'B;
      191     5318    3               IF UWA.AC.FLAG1.STATUS=2 AND UWA.AC.FLAG1.ERROR_NUM=0
      192     5319    3               THEN UWA.AC.FLAG1.STATUS=3;
      193     5320    3           CASE(6); /* Allocation of data base keys */
      194     5321    3               IF INDEX_AREA
      195     5322    4               THEN DO;
      196     5323    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      197     5324        /*E*     ERROR:    ZIG-INDEX_AREA_NO_ALLOC-C
      198     5325        MESSAGE: For the indexed area "%U1" the only legal area entries are:
      199     5326                 TEMPLATE
      200     5327                 JOURNALING IS [ NOT ] REQUIRED
      201     5328                 BACKUP     IS [ NOT ] REQUIRED
      202     5329                 ENCRYPTION IS [ NOT ] REQUIRED
      203     5330                 ORGANIZATION IS INDEXED
      204     5331                 This area entry will be ignored.
      205     5332        */
      206     5333    4                   RETURN;
      207     5334    4                   END;
      208     5335    3               CALL GET_NUM(1,MAX1);
      209     5336    3               UWA.AC.MAX_DBK=NUM;
      210     5337    3               UWA.AC.FLAG1.STATUS=1; /* Set so that we know that allocate sc. */
      211     5338        /*E*     ERROR:    ZIG-2006-C
      212     5339        MESSAGE: The number of data base keys to allocate must be
      213     5340                 in the range 1 to 68,719,476,735.
      214     5341        */
      215     5342    3           CASE(7); /* Page interval for data base keys */
      216     5343    3               IF INDEX_AREA
      217     5344    4               THEN DO;
      218     5345    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      219     5346    4                   RETURN;
      220     5347    4                   END;
      221     5348    3               CALL GET_NUM(1,512);
      222     5349    3               CALL POWER_2(NUM);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:7    
      223     5350    3               UWA.AC.DBK_PAGE=NUM;
      224     5351        /*E*     ERROR:    ZIG-2007-C
      225     5352        MESSAGE: The number of data base keys per page interval must
      226     5353                 be in the range 1 to 512.
      227     5354        */
      228     5355    3           CASE(8); /* Calc interval */
      229     5356    3               IF INDEX_AREA
      230     5357    4               THEN DO;
      231     5358    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      232     5359    4                   RETURN;
      233     5360    4                   END;
      234     5361    3               CALL GET_NUM(1,131072);
      235     5362    3               CALL POWER_2(NUM);
      236     5363    3               UWA.AC.DBK_CALC=NUM;
      237     5364        /*E*     ERROR:    ZIG-2008-C
      238     5365        MESSAGE: The number of calc intervals must be in the range 1 to 131,072.
      239     5366        */
      240     5367    3           CASE(9); /* Page size */
      241     5368    3               CALL GET_NUM(1,99999);
      242     5369    3               IF NUM=4096 THEN RETURN;
      243     5370    3               CALL WARNING(2102);
      244     5371        /*E*     ERROR:    ZIG-2102-C
      245     5372        MESSAGE: The PAGE SIZE option in the DMCL is not allowed in CP-6
      246     5373                 I-D-S/II. The page size is set to 4096.
      247     5374        */
      248     5375    3           CASE(10); /* Inventory percent */
      249     5376    3               IF INDEX_AREA
      250     5377    4               THEN DO;
      251     5378    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      252     5379    4                   RETURN;
      253     5380    4                   END;
      254     5381    3               CALL GET_NUM(1,99);
      255     5382    3               UWA.AC.PER_INV=NUM;
      256     5383        /*E*     ERROR:    ZIG-2010-C
      257     5384        MESSAGE: The inventory percent must be in the range 1 to 99.
      258     5385        */
      259     5386    3           CASE(11); /* Load limit */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:8    
      260     5387    3               CALL WARNING(2103);
      261     5388        /*E*     ERROR:    ZIG-2103-C
      262     5389        MESSAGE: The LOAD LIMIT is not used in CP-6.
      263     5390                 This statement will not be processed.
      264     5391        */
      265     5392    3           CASE(12); /* Reserve keys */
      266     5393    3               IF INDEX_AREA
      267     5394    4               THEN DO;
      268     5395    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      269     5396    4                   RETURN;
      270     5397    4                   END;
      271     5398    3               CALL GET_NUM(1,MAX1/2);
      272     5399    3               UWA.AC.KEYS_RSRVD=NUM;
      273     5400        /*E*     ERROR:    ZIG-2012-C
      274     5401        MESSAGE: The number of keys reserved must be in the range
      275     5402                 1 to 34,359,738,367.
      276     5403        */
      277     5404    3           CASE(13); /* Null on CALC_INTERVAL */
      278     5405    3               IF INDEX_AREA
      279     5406    4               THEN DO;
      280     5407    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      281     5408    4                   RETURN;
      282     5409    4                   END;
      283     5410    3               UWA.AC.CALC_NULL=1;
      284     5411    3               UWA.AC.DBK_CALC=0;
      285     5412    3           CASE(15); /* Intergrated organization */
      286     5413    3               IF INDEX_AREA
      287     5414    4               THEN DO;
      288     5415    4                   CALL ERROR(%INDEX_NOT_INTERGRATED);
      289     5416        /*E*     ERROR:    ZIG-INDEX_NOT_INTERGRATED-C
      290     5417        MESSAGE: The area "%U1" has INDEXED record types so
      291     5418                 the area must be ORGANIZATION IS INDEXED, not
      292     5419                 ORGANIZATION IS INTEGRATED.
      293     5420        */
      294     5421    4                   RETURN;
      295     5422    4                   END;
      296     5423    3               UWA.AC.PAGE_TYP=0;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:9    
      297     5424    3           CASE(16); /* Indexed organization */
      298     5425    3               IF ~INDEX_AREA
      299     5426    4               THEN DO;
      300     5427    4                   CALL ERROR(%INTERGRATED_NOT_INDEX);
      301     5428        /*E*     ERROR:    ZIG-INTERGRATED_NOT_INDEX-C
      302     5429        MESSAGE: The area "%U1" does not contain a record of type INDEXED
      303     5430                 so the area cannot be declared as ORGANIZATION IS INDEXED.
      304     5431        */
      305     5432    4                   RETURN;
      306     5433    4                   END;
      307     5434    3               UWA.AC.PAGE_TYP=3;
      308     5435    3               UWA.AC.CALC_NULL=1;
      309     5436    3           CASE(17); /* Checksum */
      310     5437    3               IF INDEX_AREA
      311     5438    4               THEN DO;
      312     5439    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      313     5440    4                   RETURN;
      314     5441    4                   END;
      315     5442    3               UWA.AC.FLAGS.CHKSUM='1'B;
      316     5443    3           CASE(18); /* Encryption */
      317     5444    3               IF INDEX_AREA
      318     5445    4               THEN DO;
      319     5446    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);
      320     5447    4                   RETURN;
      321     5448    4                   END;
      322     5449    3               UWA.AC.FLAGS.ENCRP='1'B;
      323     5450    3           CASE(19); /* Journaling */
      324     5451    3               UWA.AC.FLAGS.CJRNL='1'B;
      325     5452    3           CASE(20); /* Template */
      326     5453    3               UWA.AC.FLAGS.TMPLT='1'B;
      327     5454    3           CASE(21); /* Area name */
      328     5455    3               BAD_AREA='0'B;
      329     5456    3               CALL GET_WORD;
      330     5457    3               CALL SRCHD(WORD1,%ZIG_RTYPE_AC,SUCC);
      331     5458    3               IF ~SUCC
      332     5459    4               THEN DO;
      333     5460    4                   CALL ERROR(2121);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:10   
      334     5461    4                   BAD_AREA='1'B;
      335     5462    4                   END;
      336     5463        /*E*     ERROR:    ZIG-2121-C
      337     5464        MESSAGE: The name of the area was not found in the schema file
      338     5465                 so you either misspelled it or did not declare it in
      339     5466                 the DDL.
      340     5467        */
      341     5468    3               ELSE CALL PROCCESS_NAME;
      342     5469    3               IF UWA.AC.FLAG1.STATUS ~=0
      343     5470    4               THEN DO;
      344     5471    4                   BAD_AREA='1'B;
      345     5472    4                   CALL ERROR(2122);
      346     5473        /*E*     ERROR:    ZIG-2122-C
      347     5474        MESSAGE: The AREA entry can only be given once per area defined
      348     5475                 by the DDL.
      349     5476        */
      350     5477    4                   END;
      351     5478    3               UWA.AC.FLAGS.CHKSUM='0'B;
      352     5479    3               UWA.AC.FLAGS.ENCRP='0'B;
      353     5480    3               UWA.AC.FLAGS.CJRNL='0'B;
      354     5481    3               UWA.AC.FLAGS.TMPLT='0'B;
      355     5482    3               UWA.AC.FLAGS.TJRNL='0'B;
      356     5483    3               UWA.AC.FLAG1.STATUS=0;
      357     5484    3               UWA.AC.FLAG1.ERROR_NUM=0;
      358     5485    3               UWA.AC.PAGE_SIZE=4084;
      359     5486    3               CALL MODT('AC  ');
      360     5487        /*W*
      361     5488              If this area is a INDEXED area then most of the entries
      362     5489            in the area clause can't be used so put out a warning and
      363     5490            return from them and don't change the area.
      364     5491        */
      365     5492    3               IF UWA.AC.PRIME_KEY = 1
      366     5493    3               THEN INDEX_AREA = '1'B;
      367     5494    3               ELSE INDEX_AREA = '0'B;
      368     5495    3           CASE(22); /* Backup */
      369     5496    3               UWA.AC.FLAGS.TJRNL='1'B;
      370     5497
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:11   
      371     5498
      372     5499
      373     5500        /*   Record enrty  */
      374     5501    3           CASE(30); /* End of record entry */
      375     5502    3               CALL MODT('RC  ');
      376     5503
      377     5504
      378     5505    3           CASE (31); /* Record name */
      379     5506    3               BAD_RECORD='0'B;
      380     5507    3               CALL GET_WORD;
      381     5508    3               CALL SRCHD(WORD1,%ZIG_RTYPE_RC,SUCC);
      382     5509    3               IF ~SUCC
      383     5510    4               THEN DO;
      384     5511    4                   BAD_RECORD='1'B;
      385     5512    4                   CALL ERROR(2131);
      386     5513        /*E*     ERROR:    ZIG-2131-C
      387     5514        MESSAGE: This record was not defined in the DDL.
      388     5515        */
      389     5516    4                   END;
      390     5517    3               ELSE CALL PROCCESS_NAME;
      391     5518    3           CASE(32); /* Range clause */
      392     5519    3               IF UWA.RC.PSMODE=4
      393     5520    4               THEN DO;
      394     5521    4                   CALL ERROR(2032);
      395     5522        /*E*     ERROR:    ZIG-2032-C
      396     5523        MESSAGE: The RANGE clause cannot be used for an INDEXED record.
      397     5524        */
      398     5525    4                   BAD_RECORD='1'B;
      399     5526    4                   END;
      400     5527    3           CASE(33); /* Areas given in record clause */
      401     5528    3               IF BAD_RECORD THEN RETURN;
      402     5529    3               CALL GET_WORD;
      403     5530    3               CALL SRCHD(WORD1,%ZIG_RTYPE_AC,SUCC);
      404     5531    3               IF ~SUCC
      405     5532    4               THEN DO;
      406     5533    4                   CALL ERROR(2033);
      407     5534        /*E*     ERROR:    ZIG-2033-C
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:12   
      408     5535        MESSAGE: The area "%U1" is not defined in the schema.
      409     5536        */
      410     5537    4                   END;
      411     5538    4               ELSE DO;
      412     5539    4                   CALL FETCHNS_6('SN-SE   ') ALTRET(FAIL);/* Get ac */
      413     5540    4                   DBK_AC=UWA.DIRECT_REF;
      414     5541    4                   CALL FETCHOS_6('RC-RA   ');
      415     5542    5                   DO WHILE (DBK_AC ~= UWA.DIRECT_REF);
      416     5543    5                       CALL FETCHNS_6('RC-RA   ') ALTRET(FAIL);
      417     5544    5                       CALL FETCHOS_6('AC-RA   ');
      418     5545    5                       END;
      419     5546    4                   UWA.RA.LOWDBK=LOW_DBK;
      420     5547    4                   UWA.RA.HIGHDBK=HIGH_DBK;
      421     5548    4                   CALL FCURR_R_6('RA  ');
      422     5549    4                   CALL MODIFYIA_6('RA  ');
      423     5550    4                   RETURN;
      424     5551    4   FAIL:           CALL ERROR(2132);
      425     5552        /*E*     ERROR:    ZIG-2132-C
      426     5553        MESSAGE: Record not defined for the area "%U1".
      427     5554        */
      428     5555    4                   END;
      429     5556    3           CASE(34); /* Low range value */
      430     5557    3               CALL GET_NUM(1,MAX1/2);
      431     5558    3               LOW_DBK=NUM;
      432     5559        /*E*     ERROR:    ZIG-2034-C
      433     5560        MESSAGE: The low key for the range clause in the RECORD entry must
      434     5561                 be in the range from 1 to 34,359,738,369.
      435     5562        */
      436     5563    3           CASE(35); /* High range value */
      437     5564    3               CALL GET_NUM(LOW_DBK,MAX1/2);
      438     5565    3               HIGH_DBK=NUM;
      439     5566        /*E*     ERROR:    ZIG-2035-C
      440     5567        MESSAGE: The high key for the RANGE clause in the RECORD entry
      441     5568                 must be greater than or equal to the low key and less than
      442     5569                 34,359,738,369.
      443     5570        */
      444     5571    3           CASE(37); /* Type clause in the record entry */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:13   
      445     5572    3               IF BAD_RECORD THEN RETURN;
      446     5573    3               CALL GET_NUM(1,3999);
      447     5574    3               UWA.RC.RTYPE=NUM;
      448     5575    3               CALL MODT('RC  ');
      449     5576        /*E*     ERROR:    ZIG-2037-C
      450     5577        MESSAGE: The type of the record must be in the range of 1 to 3999.
      451     5578        */
      452     5579    3           CASE(38); /* No areas given in the range clause */
      453     5580    3               IF BAD_RECORD THEN RETURN;
      454     5581    3               CALL FETCHOS_6('RC-RA   '); /* Find owner */
      455     5582    4               DO WHILE ('1'B);
      456     5583    4                   CALL FETCHNS_6('RC-RA   ') ALTRET(RET); /* Get next ra */
      457     5584    4                   CALL FETCHOS_6('AC-RA   ');
      458     5585    4                   UWA.RA.LOWDBK=LOW_DBK;
      459     5586    4                   UWA.RA.HIGHDBK=HIGH_DBK;
      460     5587    4                   CALL FCURR_R_6('RA  ');
      461     5588    4                   CALL MODIFYIA_6('RA  ');
      462     5589    4                   END;
      463     5590    3   RET:        RETURN;
      464     5591    3           CASE (40); /* SET name claues (end) */
      465     5592    3               IF UWA.SC.SETMODE = 2
      466     5593    4               THEN DO;
      467     5594    4                   CALL CONCAT(WORD1,'*PA_REC_',UWA.SN.SENAME);
      468     5595    4                   CALL FETCHD_6('SN  ',UWA.DA.FRST_RC);
      469     5596    5                   DO WHILE (UWA.SN.SENAME < WORD1);
      470     5597    5                       I = UWA.DIRECT_REF;
      471     5598    5                       CALL FETCHNS_6('DA-SN   ') ALTRET(END_SN);
      472     5599    5                       END;
      473     5600    4   END_SN:
      474     5601    4                   CALL FINDD_6('SN  ',I);
      475     5602    4                   IF UWA.SN.SENAME = WORD1
      476     5603    5                   THEN DO;
      477     5604    5                       CALL SET_FIELDS(2,30,WORD1);
      478     5605    5                       CALL ERROR(%ZIG_DMCL_DUP_PTR_NAME);
      479     5606        /*E*     ERROR:    ZIG-ZIG_DMCL_DUP_PTR_NAME-C
      480     5607        MESSAGE: For the POINTER ARRAY "%U2" syn record two sets have
      481     5608                 almost the same name. One of the sets' names must be changed
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:14   
      482     5609                 in the schema DDL before the DMCL will work, or one of the
      483     5610                 sets cannot be a POINTER ARRAY.
      484     5611        */
      485     5612    5                       END;
      486     5613    4                   UWA.SN.SENAME = WORD1;
      487     5614    4                   UWA.SN.DCLR = 0;
      488     5615    4                   UWA.SN.ESCAPE = 0;
      489     5616    4                   UWA.SN.SETYPE = %ZIG_RTYPE_RC;
      490     5617    4                   UWA.SN.LNO = 0;
      491     5618    4                   CALL STRE_6('SN  ');
      492     5619    4                   UWA.DA.NUMB_SN = UWA.DA.NUMB_SN + 1;
      493     5620    4                   UWA.RC = '0'B;
      494     5621    4                   UWA.RC.RTYPE = SAVE_PA_TYPE;
      495     5622    4                   UWA.RC.PA_ENTRY = SAVE_PA_ENTRY;
      496     5623    4                   UWA.RC.PSMODE = 5;
      497     5624    4                   CALL STRE_6('RC  ');
      498     5625    4                   UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 1;
      499     5626    4                   CALL FETCHOS_6('SC-SOSM ');
      500     5627    5                   DO WHILE ('1'B);
      501     5628    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET(ACTR581);
      502     5629    5                       IF UWA.RECORD_NAME = 'SM'
      503     5630    6                       THEN DO;
      504     5631    6                           IF PAREC_SMDBK = 0
      505     5632    6                           THEN PAREC_SMDBK = UWA.DIRECT_REF;
      506     5633    6                           UWA.SM.MEMDUP = 0;
      507     5634    6                           UWA.SM.CALCDUP = 0;
      508     5635    6                           UWA.SM.PSMODE = 0;
      509     5636    6                           UWA.SM.PAMEM = 1;
      510     5637    6                           CALL FCURR_R_6('RC  ');
      511     5638    6                           CALL STRE_6('SM  ');
      512     5639    6                           UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;
      513     5640    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;
      514     5641    6                           CALL CONNECT_6('RC-SOSM ');
      515     5642    6                           END;
      516     5643    5                       END;
      517     5644    4   ACTR581:
      518     5645    4                   CALL FCURR_R_6('RC  ');
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:15   
      519     5646    4                   CALL MODIFY_6('RC  ');
      520     5647    4                   CALL FETCHD_6('SM  ',PAREC_SMDBK);
      521     5648    5                   DO WHILE ('1'B);
      522     5649    6                       DO WHILE ('1'B);
      523     5650    6                           CALL FETCHNS_6('SMSS-CF ') ALTRET(ACTR584);
      524     5651    6                           PAREC_NUMB_SK = PAREC_NUMB_SK + 1;
      525     5652    6                           CALL FETCHOS_6('FR-CFS  ');
      526     5653    6                           UWA.FR.SYN = 1;
      527     5654    6                           UWA.FR.FR_FRH = UWA.DIRECT_REF;
      528     5655    6                           UWA.FR.F_USE = 6;
      529     5656    6                           CALL FCURR_R_6('RC  ');
      530     5657    6                           CALL STRE_6('FR  ');
      531     5658    6                           UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
      532     5659    6                           END;
      533     5660    5   ACTR584:
      534     5661    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET(DBCS_ERR);
      535     5662        /*  Skip over the PA record. */
      536     5663    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET (ACTR585);
      537     5664    5                       PAREC_NUMB_SK = 0;
      538     5665    5                       END;
      539     5666    4   ACTR585:
      540     5667    4                   CALL FCURR_R_6('RC  ');
      541     5668    4                   CALL FETCHD_6('SM  ',PAREC_SMDBK);
      542     5669    4                   PAREC_USER_PLACE = UWA.DIRECT_REF;
      543     5670    5                   DO WHILE ('1'B);
      544     5671    5                       CALL FETCHNS_6('SC-SOSM ');
      545     5672    5                       PAREC_PA_PLACE = UWA.DIRECT_REF;
      546     5673    6                       DO I = 1 TO PAREC_NUMB_SK;
      547     5674    6                           CALL FINDD_6('****',PAREC_USER_PLACE);
      548     5675    6                           CALL FETCHNS_6('SMSS-CF ') ALTRET(DBCS_ERR);
      549     5676    7                           DO WHILE (UWA.C_F.CTRLTYPE ~= 0);
      550     5677    7                               CALL FETCHNS_6('SMSS-CF ') ALTRET(DBCS_ERR);
      551     5678    7                               END;
      552     5679    6                           PAREC_USER_PLACE = UWA.DIRECT_REF;
      553     5680    6                           CALL FETCHNS_6('RC-FR   ') ALTRET (DBCS_ERR);
      554     5681    6                           CALL FINDD_6('****',PAREC_PA_PLACE);
      555     5682    6                           UWA.C_F.SYN = 1;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:16   
      556     5683    6                           UWA.C_F.CTRLTYPE = 6;
      557     5684    6                           CALL STRE_6('C-F ');
      558     5685    6                           UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
      559     5686    6                           CALL CONNECT_6('SMSS-CF ');
      560     5687    6                           CALL FINDD_6('FR  ',UWA.FR.FR_FRH);
      561     5688    6                           CALL FCURR_R_6('C-F ');
      562     5689    6                           CALL CONNECT_6('FR-CFR  ');
      563     5690    6                           CALL FINDOS_6('FR-CFS  ');
      564     5691    6                           END;
      565     5692    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET (ACTR588);
      566     5693    5                       PAREC_USER_PLACE = UWA.DIRECT_REF;
      567     5694    5                       END;
      568     5695    4   ACTR588:
      569     5696    4                   CALL MODT('SC  ');
      570     5697    4                   END;
      571     5698    3           CASE(41); /* Set entry */
      572     5699    3               SAVE_PA_TYPE = 0;
      573     5700    3               SAVE_PA_ENTRY = 0;
      574     5701    3               PAREC_USER_PLACE = 0;
      575     5702    3               PAREC_PA_PLACE = 0;
      576     5703    3               PAREC_NUMB_SK = 0;
      577     5704    3               PAREC_SMDBK = 0;
      578     5705    3               CALL GET_WORD;
      579     5706    3               CALL SRCHD(WORD1,%ZIG_RTYPE_SC,SUCC);
      580     5707    3               IF ~SUCC
      581     5708    4               THEN DO;
      582     5709    4                   CALL ERROR(2041);
      583     5710        /*E*     ERROR:    ZIG-2041-C
      584     5711        MESSAGE: The set name "%U1" is not defined in the schema.
      585     5712                 No new set name can be given in the DMCL. All sets
      586     5713                 must be declares in the DDL.
      587     5714        */
      588     5715    4                   END;
      589     5716    4               ELSE DO;
      590     5717    4                   CALL PROCCESS_NAME;
      591     5718    4                   END;
      592     5719    3           CASE(43); /* Processing pointer clause */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:17   
      593     5720    3               UWA.SC.USER_PTS=1;
      594     5721    3               CALL MODT('SC  ');
      595     5722    3           CASE(51); /* Key name */
      596     5723    3               CALL GET_WORD;
      597     5724    3               CALL SRCHD(WORD1,%ZIG_RTYPE_KC,SUCC);
      598     5725    3               IF ~SUCC
      599     5726    4               THEN DO;
      600     5727    4                   CALL ERROR(2051);
      601     5728    4                   RETURN;
      602     5729        /*E*     ERROR:    ZIG-2051-C
      603     5730        MESSAGE: The key "%U1" is not defined in the schema.
      604     5731        */
      605     5732    4                   END;
      606     5733    4               ELSE DO;
      607     5734    4                   CALL FETCHNS_6('SN-SE   ') ALTRET(FAIL2);
      608     5735    4                   RETURN;
      609     5736        /*E*     ERROR:    ZIG-2151-C
      610     5737        MESSAGE: The key "%U1" does not belong to any set.
      611     5738        */
      612     5739    4                   END;
      613     5740    3   FAIL2:      CALL ERROR(2151);
      614     5741    3           CASE(52); /* Record type */
      615     5742    3               CALL GET_NUM(0,2049);
      616     5743    3               UWA.SC.INDEX_ID=NUM;
      617     5744    3               CALL MODT('SC  ');
      618     5745        /*E*     ERROR:    ZIG-2052-C
      619     5746        MESSAGE: The key range must be in the range of 1 to 2049, not %U1.
      620     5747        */
      621     5748    3           CASE (85); /* Set is chain */
      622     5749    3               UWA.SC.SETMODE = 0;
      623     5750    3               CALL MODT('SC  ');
      624     5751    3           CASE (86); /* Pointer array */
      625     5752    3               UWA.SC.SETMODE = 2;
      626     5753    3               CALL MODT('SC  ');
      627     5754    3               IF UWA.SC.SETORD ~= 4
      628     5755    4               THEN DO;
      629     5756    4                   CALL SET_FIELDS(2,30,UWA.SN.SENAME);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:18   
      630     5757    4                   CALL ERROR(2086);
      631     5758        /*E*     ERROR:    ZIG-2086-C
      632     5759        MESSAGE: The SET named "%U2" has been declared as a POINTER ARRAY
      633     5760                 and only sets that are sorted by keys can have the type
      634     5761                 of a POINTER ARRAY.
      635     5762        */
      636     5763    4                   UWA.SC.SETMODE = 0;
      637     5764    4                   RETURN;
      638     5765    4                   END;
      639     5766    3           CASE (87); /* PA type */
      640     5767    3               CALL GET_NUM(1,3999);
      641     5768    3               SAVE_PA_TYPE = NUM;
      642     5769        /*E*     ERROR:    ZIG-2087-C
      643     5770        MESSAGE: The PA_TYPE must be in the range 1 to 3999, not %U1.
      644     5771        */
      645     5772    3           CASE (88); /* Num of entries */
      646     5773    3               CALL GET_NUM(3,2999);
      647     5774    3               SAVE_PA_ENTRY = NUM;
      648     5775        /*E*     ERROR:    ZIG-2088-C
      649     5776        MESSAGE: The number of POINTER ARRAY entries per block must be in the
      650     5777                 range of 3 to 2999, not %U1.
      651     5778        */
      652     5779    3           CASE (89); /* End of dmcl */
      653     5780    3               END_DMCL='1'B;
      654     5781
      655     5782
      656     5783
      657     5784
      658     5785        /* Data base procedure code next */
      659     5786    3           CASE(60); /* Data base procedures */
      660     5787    3               CALL ERROR(2060);
      661     5788        /*E*     ERROR:    ZIG-2060-C
      662     5789        MESSAGE: Data base procedures cannot be used yet!
      663     5790                 They will be in a later release.
      664     5791        */
      665     5792    3               END;
      666     5793    2       CASE(%FAIL#);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:19   
      667     5794    2           J=PARAN.CHARPOS;
      668     5795    3           DO WHILE (SUBSTR(LINE,J,1)=' ');
      669     5796    3               J=J+1;
      670     5797    3               END;
      671     5798    3           DO WHILE (SUBSTR(LINE,J,1)~=' ');
      672     5799    3               J=J+1;
      673     5800    3               END;
      674     5801    2           FIELD1.COUNT1=J-PARAN.CHARPOS;
      675     5802    2           FIELD1.TEXT1=SUBSTR(LINE,PARAN.CHARPOS,FIELD1.COUNT1);
      676     5803    3           DO CASE(PARAN.CODE);
      677     5804    3           CASE(1); /* Other entry fail */
      678     5805    3               CALL ERROR(2501);
      679     5806        /*E*     ERROR:    ZIG-2501-C
      680     5807        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal start for an
      681     5808                 ENTRY clause in the DMCL.
      682     5809        */
      683     5810    3           CASE(2); /* Schema entry */
      684     5811    3               CALL ERROR(2502);
      685     5812        /*E*     ERROR:    ZIG-2502-C
      686     5813        MESSAGE: SYNTAX ERROR: The DMCL must start with a SCHEMA entry.
      687     5814                 THE FORMAT IS: SCHEMA [NAME] [IS] schema_name .
      688     5815        */
      689     5816    3           CASE (6,7,8,9,10,11,12,87,88); /* Integers in area entry */
      690     5817    3               CALL ERROR(2506);
      691     5818        /*E*     ERROR:    ZIG-2506-C
      692     5819        MESSAGE: SYNTAX ERROR: %U1 is not an integer and at this point
      693     5820                 an integer must be present.
      694     5821        */
      695     5822    3               CALL MODT('AC  ');
      696     5823    3           CASE (16) ; /* Organization clause */
      697     5824    3               CALL ERROR(2516);
      698     5825        /*E*     ERROR:    ZIG-2516-C
      699     5826        MESSAGE: SYNTAX ERROR: After the keyword ORGANIZATION the keyword
      700     5827                 INTEGRATED or INDEXED must be given, not %U1.
      701     5828        */
      702     5829    3               CALL MODT('AC  ');
      703     5830    3           CASE(22); /* Area not ended right */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:20   
      704     5831    3               CALL ERROR(2522);
      705     5832        /*E*     ERROR:    ZIG-2522-C
      706     5833        MESSAGE: The word %U1 is not a legal option on the AREA_ENTRY
      707     5834                 clause.
      708     5835        */
      709     5836    3               CALL MODT('AC  ');
      710     5837    3           CASE(30); /* Bad option on record entry */
      711     5838    3               CALL ERROR(2530);
      712     5839        /*E*     ERROR:    ZIG-2530-C
      713     5840        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal option in the
      714     5841                 RECORD_ENTRY and all entries must end with a period.
      715     5842        */
      716     5843    3           CASE(34,35,37); /* Integers in record entry */
      717     5844    3               CALL ERROR(2534);
      718     5845        /*E*     ERROR:    ZIG-2534-C
      719     5846        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal integer
      720     5847                 required for this option in the RECORD entry.
      721     5848        */
      722     5849    3           CASE(40); /* End of set entry */
      723     5850    3               CALL ERROR(2540);
      724     5851        /*E*     ERROR:    ZIG-2540-C
      725     5852        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal option
      726     5853                  in the SET_ENTRY clause and all entries must end with
      727     5854                 a period.
      728     5855        */
      729     5856    3           CASE(42); /* Mode clause */
      730     5857    3               CALL ERROR(2542);
      731     5858        /*E*     ERROR:    ZIG-2542-C
      732     5859        MESSAGE: SYNTAX ERROR: After the MODE clause the keyword
      733     5860                 CHAIN must be specified, not %U1.
      734     5861        */
      735     5862    3           CASE(43); /* Pointer clause */;
      736     5863    3               CALL ERROR(2543);
      737     5864        /*E*     ERROR:    ZIG-2543-C
      738     5865        MESSAGE: SYNTAX ERROR: After the keyword POINTER the keyword
      739     5866                 LOCAL must be specified, not %U1.
      740     5867        */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:21   
      741     5868    3           CASE(50); /* Key end */
      742     5869    3               CALL ERROR(2550);
      743     5870        /*E*     ERROR:    ZIG-2550-C
      744     5871        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal option
      745     5872                 in the KEY_ENTRY and all entries must end with a period.
      746     5873        */
      747     5874    3           CASE(52); /* Key option */
      748     5875    3               CALL ERROR(2552);
      749     5876        /*E*     ERROR:    ZIG-2552-C
      750     5877        MESSAGE: SYNTAX ERROR: The word %U1 is not an integer and
      751     5878                 after the TYPE clause an integer must be present.
      752     5879        */
      753     5880    3           CASE(86); /*   PA option on sets */
      754     5881    3               CALL ERROR(2586);
      755     5882        /*E*     ERROR:    ZIG-2586-C
      756     5883        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal mode for
      757     5884                 the set entry. The syntax is:
      758     5885                 SET [NAME] [IS] set_name [ POINTERS [ARE] LOCAL ]
      759     5886                      [ MODE [IS] ( CHAIN | (POINTER ARRAY | PA )
      760     5887                      PA_TYPE [IS] number [ ALLOW [FOR] number [ENTRIES] ) ]
      761     5888        */
      762     5889    3               END;
      763     5890    2           UNWIND TO SYNTAX_ERR;
      764     5891    2           END;
      765     5892    1       RETURN;
      766     5893    1   DBCS_ERR:
      767     5894    1       CALL ABORT;
      768     5895    1   END ZIG$M_PSET;

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:22   
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$M_PSET.

   Procedure ZIG$M_PSET requires 1320 words for executable code.
   Procedure ZIG$M_PSET requires 18 words of local(AUTO) storage.

    No errors detected in file ZIG$M_PSET.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:23   

 Object Unit name= ZIG$M_PSET                                 File name= ZIG$M_PSET.:ZIC0TOU
 UTS= SEP 05 '97 12:09:29.88 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    26     32  ZIG$M_PSET
    1  LblCom even  none     8     10  FIELD1
    2  LblCom even  none     1      1  END_DMCL
    3  LblCom even  none     1      1  LINE
    4  LblCom even  none   656   1220  UWA
    5  RoData even  UTS     33     41  ZIG$M_PSET
    6   Proc  even  none  1320   2450  ZIG$M_PSET
    7  RoData even  none   162    242  ZIG$M_PSET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        1  ZIG$M_PSET
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 ZIG$M_READ
 yes     yes           Std       1 FETCHOS_6
 yes     yes           Std       2 FETCHD_6
         yes           Std       3 SRCHD
 yes     yes           Std       2 FINDD_6
 yes     yes           Std       1 FCURR_R_6
         yes           Std       3 SET_FIELDS
 yes     yes           Std       1 STRE_6
         yes           Std       1 ERROR
         yes           Std       1 WARNING
 yes     yes           Std       1 FETCHNS_6
 yes     yes           Std       1 CONNECT_6
 yes     yes           Std       1 FINDOS_6
 yes     yes           Std       1 MODIFYIA_6
         yes           Std       0 ABORT
 yes     yes           Std       1 MODIFY_6
 yes     yes           Std       1 DISCONNECT_6
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SYNTAX_ERR                            DMCL_P
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:25   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:26   


        1        1        /*M*     ZIG$M_PSET     I-D-S/II  DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$M_PSET
        9        9        PURPOSE: THIS SUBROUTINE IS CALLED FROM X$PARSE TO DO THREE THINGS:
       10       10                 FIRST:
       11       11                      TO GET MORE INPUT FOR X$PARSE IF THE LINE CONTINUES.
       12       12                      TO DO THIS IT CALLS ZIG$M_READ.
       13       13                 SECOND:
       14       14                      TO SET THING IN THE SCHEMA FOR THE THING GIVEN
       15       15                      IN THE DMCL.
       16       16                 THIRD:
       17       17                      TO FIND ALL SYNTAX ERRORS AND PRINT OUT THE MESSAGES
       18       18                      ON BOTH M$LO AND M$DO BY M$ERRMSG.
       19       19                      ALSO IT WILL TRY AND RECOVER FROM ALL SYNTAX ERROR AND
       20       20                      PARSE AS MUCH AS POSIBLE SO ONE COULD GET COMPOUNDING
       21       21                      ERRORS BUT HE SHOULD GET ALL THE ERROR IN THE DMCL
       22       22                      PRINTED OUT IN ONE PASS OF THE SYNTAX CHECKER.
       23       23        */
       24       24        /*
       25       25            Note:
       26       26                 The code to do pointer arrays is not in this subroutine
       27       27                 as it was in ZIG$DDD8. So when pointer arrays are added
       28       28                 to the dmcl then they will have to be added to this
       29       29                 routine and ZIG$M_PSI (the X$PARSE source);
       30       30        */
       31       31        ZIG$M_PSET:
       32       32            PROC (PARAN);

     32  6 000000   000000 700200 xent  ZIG$M_PSET   TSX0  ! X66_AUTO_1
         6 000001   000022 000001                    ZERO    18,1
         6 000002   000234 710000 6                  TRA     s:5280
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:27   

       33       33    1   DCL ZIG$M_READ ENTRY;
       34       34    1   DCL SRCHD ENTRY(3) ; /* CHAR(30),UBIN (18), bit (1) */
       35       35    1   DCL WARNING ENTRY (1); /* Ubin (36) */
       36       36    1   DCL ERROR ENTRY (1); /* Ubin (36) */
       37       37    1   DCL SET_FIELDS ENTRY (3);
       38       38    1   DCL WORD1 CHAR (30) STATIC;
       39       39    1   DCL SUCC BIT (1) STATIC;
       40       40    1   DCL BAD_AREA BIT (1) STATIC;
       41       41    1   DCL DBK_AC UBIN (36) STATIC;
       42       42    1   DCL DBK_RC UBIN (36) STATIC;
       43       43    1   DCL SEPNTR UBIN (36) STATIC;
       44       44    1   DCL NUM UBIN (36) STATIC;
       45       45    1   DCL BAD_RECORD BIT (1) STATIC;
       46       46    1   DCL DBK_SC UBIN (36) STATIC;
       47       47    1   DCL 1 FIELD1 EXT,
       48       48    1         2 COUNT1 UBIN (9) UNAL,
       49       49    1         2 TEXT1 CHAR (31) UNAL;
       50       50    1   DCL MAXN BIT (36) INIT ('111111111111111111111111111111111110'B)
       51       51    1    STATIC;
       52       52    1   DCL MAX1 REDEF MAXN UBIN (36);
       53       53    1   DCL HIGH_DBK UBIN (36) STATIC;
       54       54    1   DCL LOW_DBK UBIN (36) STATIC;
       55       55    1   DCL ABORT ENTRY;
       56       56    1   DCL END_DMCL BIT (1) EXT;
       57       57    1   DCL LINE CHAR (1) EXT;
       58       58    1   DCL J UBIN (36);
       59       59    1   DCL SYNTAX_ERR BIT (72) SYMREF;
       60       60    1   DCL PAREC_USER_PLACE UBIN (36) STATIC;
       61       61    1   DCL PAREC_PA_PLACE UBIN (36) STATIC;
       62       62    1   DCL PAREC_NUMB_SK UBIN (36) STATIC;
       63       63    1   DCL PAREC_SMDBK UBIN (36) STATIC;
       64       64    1   DCL SAVE_PA_TYPE UBIN (36) STATIC;
       65       65    1   DCL SAVE_PA_ENTRY UBIN (36) STATIC;
       66       66    1   DCL I UBIN (36);
       67       67    1   DCL INDEX_AREA BIT(1) STATIC;
       68       68        %INCLUDE ZIG_TYPE_SUBS;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:28   
       69       83        %INCLUDE ZI_SUB4_CAN;
       70      740        %UWA;
       71     1075        %INCLUDE ZIG_DBA_INT;
       72     1123        %INCLUDE ZI_ERRORS_SUBS;
       73     1643        %INCLUDE XU_MACRO_C;
       74     4749        %INCLUDE XU_SUBS_C;
       75     4841        %P$PCB(NAME=DMCL_P,STCLASS=SYMREF);
       76     5042        %PARSE$PARAM(NAME=PARAN);
       77     5123        %PARSE$OUT(NAME=BLK,STCLASS=BASED);
       78     5168        %PARSE$SYM(NAME=SYM,STCLASS=BASED);
       79     5206    1   PROCCESS_NAME: PROC;

   5206  6 000003   200006 741300       PROCCESS_NA* STX1  ! I+1,,AUTO

       80     5207    2       SEPNTR=UWA.DIRECT_REF;

   5207  6 000004   000036 235000 4                  LDA     UWA+30
         6 000005   000014 755000 0                  STA     SEPNTR

       81     5208    2       CALL FETCHNS_6('SN-SE   ') ALTRET(FAIL1);

   5208  6 000006   000001 630400 7                  EPPR0   1
         6 000007   000000 631400 7                  EPPR1   0
         6 000010   000000 701000 xent               TSX1    FETCHNS_6
         6 000011   000062 702000 6                  TSX2    FAIL1

       82     5209    2       SEPNTR=UWA.DIRECT_REF;

   5209  6 000012   000036 235000 4                  LDA     UWA+30
         6 000013   000014 755000 0                  STA     SEPNTR

       83     5210    2       IF UWA.SN.SETYPE= 20

   5210  6 000014   000424 236000 4                  LDQ     UWA+276
         6 000015   000024 116007                    CMPQ    20,DL
         6 000016   000036 601000 6                  TNZ     s:5218

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:29   
       84     5211    3       THEN DO;

       85     5212    3           UWA.AC.PER_INV=0;

   5212  6 000017   000240 450000 4                  STZ     UWA+160

       86     5213    3           CALL DISCONNECT_6('OA-AC   ');

   5213  6 000020   000002 630400 7                  EPPR0   2
         6 000021   000000 631400 7                  EPPR1   0
         6 000022   000000 701000 xent               TSX1    DISCONNECT_6
         6 000023   000000 011000                    NOP     0

       87     5214    3           CALL CONNECT_6('OA-AC   ');

   5214  6 000024   000002 630400 7                  EPPR0   2
         6 000025   000000 631400 7                  EPPR1   0
         6 000026   000000 701000 xent               TSX1    CONNECT_6
         6 000027   000000 011000                    NOP     0

       88     5215    3           DBK_AC=UWA.DIRECT_REF;

   5215  6 000030   000036 235000 4                  LDA     UWA+30
         6 000031   000012 755000 0                  STA     DBK_AC

       89     5216    3           CALL MODT('AC  ');

   5216  6 000032   000003 236000 7                  LDQ     3
         6 000033   200011 756100                    STQ     I+1,,AUTO
         6 000034   000070 701000 6                  TSX1    MODT
         6 000035   000000 011000                    NOP     0

       90     5217    3           END;

       91     5218    2       IF UWA.SN.SETYPE = 40

   5218  6 000036   000424 235000 4                  LDA     UWA+276
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:30   
         6 000037   000050 115007                    CMPA    40,DL
         6 000040   000047 601000 6                  TNZ     s:5223

       92     5219    3       THEN DO;

       93     5220    3           CALL FETCHD_6('RC  ',SEPNTR); /* Find dbk and get */

   5220  6 000041   000005 630400 7                  EPPR0   5
         6 000042   000004 631400 7                  EPPR1   4
         6 000043   000000 701000 xent               TSX1    FETCHD_6
         6 000044   000000 011000                    NOP     0

       94     5221    3           DBK_RC = UWA.DIRECT_REF;

   5221  6 000045   000036 235000 4                  LDA     UWA+30
         6 000046   000013 755000 0                  STA     DBK_RC

       95     5222    3           END;

       96     5223    2       IF UWA.SN.SETYPE = 30

   5223  6 000047   000424 235000 4                  LDA     UWA+276
         6 000050   000036 115007                    CMPA    30,DL
         6 000051   000060 601000 6                  TNZ     s:5228

       97     5224    3       THEN DO;

       98     5225    3           CALL FETCHD_6('SC  ',SEPNTR);

   5225  6 000052   000007 630400 7                  EPPR0   7
         6 000053   000004 631400 7                  EPPR1   4
         6 000054   000000 701000 xent               TSX1    FETCHD_6
         6 000055   000000 011000                    NOP     0

       99     5226    3           DBK_SC= UWA.DIRECT_REF;

   5226  6 000056   000036 235000 4                  LDA     UWA+30
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:31   
         6 000057   000017 755000 0                  STA     DBK_SC

      100     5227    3           END;

      101     5228    2       RETURN;

   5228  6 000060   200006 221300                    LDX1  ! I+1,,AUTO
         6 000061   000001 702211                    TSX2  ! 1,X1

      102     5229    2   FAIL1: CALL ERROR(2014);

   5229  6 000062   000012 630400 7     FAIL1        EPPR0   10
         6 000063   000000 631400 7                  EPPR1   0
         6 000064   000000 701000 xent               TSX1    ERROR
         6 000065   000000 011000                    NOP     0

      103     5230        /*E*     ERROR:    ZIG-2014-C
      104     5231        MESSAGE: %U1 is not defined in the schema.
      105     5232        */
      106     5233    2   END PROCCESS_NAME;

   5233  6 000066   200006 221300                    LDX1  ! I+1,,AUTO
         6 000067   000001 702211                    TSX2  ! 1,X1

      107     5234    1   MODT:

   5234  6 000070   200010 741300       MODT         STX1  ! @NUM_2+1,,AUTO

      108     5235    1       PROC (TYPE_C);
      109     5236    2   DCL TYPE_C CHAR (4);
      110     5237    2       CALL FCURR_R_6(TYPE_C);

   5237  6 000071   200011 630500                    EPPR0   @TYPE_C,,AUTO
         6 000072   000000 631400 7                  EPPR1   0
         6 000073   000000 701000 xent               TSX1    FCURR_R_6
         6 000074   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:32   
      111     5238    2       CALL MODIFY_6(TYPE_C);

   5238  6 000075   200011 630500                    EPPR0   @TYPE_C,,AUTO
         6 000076   000000 631400 7                  EPPR1   0
         6 000077   000000 701000 xent               TSX1    MODIFY_6
         6 000100   000000 011000                    NOP     0

      112     5239    2       RETURN;

   5239  6 000101   200010 221300                    LDX1  ! @NUM_2+1,,AUTO
         6 000102   000001 702211                    TSX2  ! 1,X1

      113     5240    2   END MODT;
      114     5241    1   GET_WORD:

   5241  6 000103   200012 741300       GET_WORD     STX1  ! COUNT+1,,AUTO

      115     5242    1       PROC;
      116     5243    2       WORD1=PARAN.OUT$ -> BLK.SUBLK$(0) -> SYM.TEXT;

   5243  6 000104   200003 470500                    LDP0    @PARAN,,AUTO
         6 000105   000002 471500                    LDP1    2,,PR0
         6 000106   100003 473500                    LDP3    3,,PR1
         6 000107   300004 236100                    LDQ     4,,PR3
         6 000110   000033 772000                    QRL     27
         6 000111   000000 620006                    EAX0    0,QL
         6 000112   040000 100540                    MLR     fill='040'O
         6 000113   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         6 000114   000000 000036 0                  ADSC9   WORD1                    cn=0,n=30

      117     5244    2       FIELD1.COUNT1=PARAN.OUT$ -> BLK.SUBLK$(0) -> SYM.COUNT;

   5244  6 000115   000002 471500                    LDP1    2,,PR0
         6 000116   100003 473500                    LDP3    3,,PR1
         6 000117   300004 236100                    LDQ     4,,PR3
         6 000120   000000 552040 1                  STBQ    FIELD1,'40'O

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:33   
      118     5245    2       FIELD1.TEXT1=WORD1;

   5245  6 000121   040000 100400                    MLR     fill='040'O
         6 000122   000000 000036 0                  ADSC9   WORD1                    cn=0,n=30
         6 000123   000000 200037 1                  ADSC9   FIELD1                   cn=1,n=31

      119     5246    2       RETURN;

   5246  6 000124   000001 702211                    TSX2  ! 1,X1

      120     5247    2   END GET_WORD;
      121     5248    1   GET_NUM:

   5248  6 000125   200006 741300       GET_NUM      STX1  ! I+1,,AUTO

      122     5249    1       PROC(LOW,HIGH);
      123     5250    2   DCL LOW UBIN (36);
      124     5251    2   DCL HIGH UBIN (36);
      125     5252    2       CALL GET_WORD;

   5252  6 000126   000103 701000 6                  TSX1    GET_WORD
         6 000127   000000 011000                    NOP     0

      126     5253    2       CALL CHARBIN(NUM,SUBSTR(WORD1,0,FIELD1.COUNT1));

   5253  6 000130   000000 236000 1                  LDQ     FIELD1
         6 000131   000033 772000                    QRL     27
         6 000132   000000 620006                    EAX0    0,QL
         6 000133   000100 305440                    DTB
         6 000134   000000 030010 0                  NDSC9   WORD1                    cn=0,s=nosgn,sf=0,n=*X0
         6 000135   200014 000010                    NDSC9   COUNT+3,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         6 000136   200015 235100                    LDA     COUNT+4,,AUTO
         6 000137   000015 755000 0                  STA     NUM

      127     5254    2       IF NUM<LOW OR NUM>HIGH

   5254  6 000140   200007 470500                    LDP0    @LOW,,AUTO
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:34   
         6 000141   000015 236000 0                  LDQ     NUM
         6 000142   000000 116100                    CMPQ    0,,PR0
         6 000143   000150 602000 6                  TNC     s:5256
         6 000144   200010 471500                    LDP1    @HIGH,,AUTO
         6 000145   100000 116100                    CMPQ    0,,PR1
         6 000146   000172 602000 6                  TNC     s:5264
         6 000147   000172 600000 6                  TZE     s:5264

      128     5255    3       THEN DO;

      129     5256    3           CALL ERROR(2000+PARAN.CODE);

   5256  6 000150   200003 471500                    LDP1    @PARAN,,AUTO
         6 000151   100000 236100                    LDQ     0,,PR1
         6 000152   777777 376007                    ANQ     -1,DL
         6 000153   003720 036007                    ADLQ    2000,DL
         6 000154   200014 756100                    STQ     COUNT+3,,AUTO
         6 000155   200014 633500                    EPPR3   COUNT+3,,AUTO
         6 000156   200015 453500                    STP3    COUNT+4,,AUTO
         6 000157   200015 630500                    EPPR0   COUNT+4,,AUTO
         6 000160   000000 631400 7                  EPPR1   0
         6 000161   000000 701000 xent               TSX1    ERROR
         6 000162   000000 011000                    NOP     0

      130     5257    3           CALL WARNING(2199);

   5257  6 000163   000014 630400 7                  EPPR0   12
         6 000164   000000 631400 7                  EPPR1   0
         6 000165   000000 701000 xent               TSX1    WARNING
         6 000166   000000 011000                    NOP     0

      131     5258    3           NUM=LOW;

   5258  6 000167   200007 470500                    LDP0    @LOW,,AUTO
         6 000170   000000 235100                    LDA     0,,PR0
         6 000171   000015 755000 0                  STA     NUM

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:35   
      132     5259        /*E*     ERROR:    ZIG-2199-C
      133     5260        MESSAGE: The number %U1 will be set to the lowest limit for further
      134     5261                 syntax checking to continue.
      135     5262        */
      136     5263    3           END;

      137     5264    2   END GET_NUM;

   5264  6 000172   200006 221300                    LDX1  ! I+1,,AUTO
         6 000173   000001 702211                    TSX2  ! 1,X1

      138     5265    1   POWER_2:

   5265  6 000174   200006 741300       POWER_2      STX1  ! I+1,,AUTO

      139     5266    1       PROC(NUM_2);
      140     5267    2   DCL NUM_2 UBIN (36);
      141     5268    2   DCL I UBIN (36);
      142     5269    2   DCL I_B(0:35) REDEF I BIT (1) UNAL;
      143     5270    2   DCL COUNT UBIN (36);
      144     5271    2       I=1;

   5271  6 000175   000001 235007                    LDA     1,DL
         6 000176   200010 755100                    STA     I,,AUTO

      145     5272    2       COUNT=0;

   5272  6 000177   200011 450100                    STZ     COUNT,,AUTO

      146     5273    3       DO WHILE (I<NUM_2 AND COUNT<35);

   5273  6 000200   000222 710000 6                  TRA     s:5277

      147     5274    3           COUNT=COUNT+1;

   5274  6 000201   200011 235100                    LDA     COUNT,,AUTO
         6 000202   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:36   
         6 000203   200011 755100                    STA     COUNT,,AUTO

      148     5275    3           I_B(36-COUNT)='0'B;

   5275  6 000204   000016 675000 7                  ERA     14
         6 000205   000001 035007                    ADLA    1,DL
         6 000206   000210 605000 6                  TPL     s:5275+4
         6 000207   000044 035003                    ADLA    36,DU
         6 000210   003105 060400                    CSL     bolr='003'O
         6 000211   000015 000001 7                  BDSC    13                       by=0,bit=0,n=1
         6 000212   200011 000001                    BDSC    COUNT,A,AUTO             by=0,bit=0,n=1

      149     5276    3           I_B(35-COUNT)='1'B;

   5276  6 000213   000000 235003                    LDA     0,DU
         6 000214   200011 135100                    SBLA    COUNT,,AUTO
         6 000215   000217 605000 6                  TPL     s:5276+4
         6 000216   000044 035003                    ADLA    36,DU
         6 000217   003105 060400                    CSL     bolr='003'O
         6 000220   000017 000001 7                  BDSC    15                       by=0,bit=0,n=1
         6 000221   200010 700001                    BDSC    I,A,AUTO                 by=3,bit=8,n=1

      150     5277    3           END;

   5277  6 000222   200007 470500                    LDP0    @NUM_2,,AUTO
         6 000223   200010 236100                    LDQ     I,,AUTO
         6 000224   000000 116100                    CMPQ    0,,PR0
         6 000225   000231 603000 6                  TRC     s:5278
         6 000226   200011 235100                    LDA     COUNT,,AUTO
         6 000227   000043 115007                    CMPA    35,DL
         6 000230   000201 602000 6                  TNC     s:5274

      151     5278    2       NUM=I;

   5278  6 000231   000015 756000 0                  STQ     NUM

      152     5279    2   END POWER_2;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:37   

   5279  6 000232   200006 221300                    LDX1  ! I+1,,AUTO
         6 000233   000001 702211                    TSX2  ! 1,X1

      153     5280    2       DO CASE (PARAN.TYPE);

   5280  6 000234   200003 470500                    LDP0    @PARAN,,AUTO
         6 000235   000000 236100                    LDQ     0,,PR0
         6 000236   000033 772000                    QRL     27
         6 000237   000005 116007                    CMPQ    5,DL
         6 000240   000242 602006 6                  TNC     s:5280+6,QL
         6 000241   002443 710000 6                  TRA     s:5892
         6 000242   002443 710000 6                  TRA     s:5892
         6 000243   000272 710000 6                  TRA     s:5286
         6 000244   000272 710000 6                  TRA     s:5286
         6 000245   002126 710000 6                  TRA     s:5794
         6 000246   000247 710000 6                  TRA     s:5282

      154     5281    2       CASE(%INPUT#);

      155     5282    2           IF END_DMCL THEN UNWIND TO SYNTAX_ERR;

   5282  6 000247   000000 234000 2                  SZN     END_DMCL
         6 000250   000257 605000 6                  TPL     s:5283

   5282  6 000251   000100 100600                    MLR   ! fill='000'O
         6 000252   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
         6 000253   200014 000010                    ADSC9   COUNT+3,,AUTO            cn=0,n=8
         6 000254   200014 237300                    LDAQ  ! COUNT+3,,AUTO
         6 000255   000000 700200 xent               TSX0  ! X66_AUNWIND
         6 000256   000000 000200                    ZERO    0,128

      156     5283    2           CALL ZIG$M_READ;

   5283  6 000257   000015 631400 7                  EPPR1   13
         6 000260   000000 701000 xent               TSX1    ZIG$M_READ
         6 000261   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:38   

      157     5284    2           IF END_DMCL THEN UNWIND TO SYNTAX_ERR;

   5284  6 000262   000000 234000 2                  SZN     END_DMCL
         6 000263   002443 605000 6                  TPL     s:5892

   5284  6 000264   000100 100600                    MLR   ! fill='000'O
         6 000265   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
         6 000266   200014 000010                    ADSC9   COUNT+3,,AUTO            cn=0,n=8
         6 000267   200014 237300                    LDAQ  ! COUNT+3,,AUTO
         6 000270   000000 700200 xent               TSX0  ! X66_AUNWIND
         6 000271   000000 000200                    ZERO    0,128

      158     5285    2       CASE(%SUCC#, %PRE#);

      159     5286    3           DO CASE (PARAN.CODE);

   5286  6 000272   000000 720100                    LXL0    0,,PR0
         6 000273   000132 100003                    CMPX0   90,DU
         6 000274   000276 602010 6                  TNC     s:5286+4,X0
         6 000275   002443 710000 6                  TRA     s:5892
         6 000276   002125 710000 6                  TRA     s:5792
         6 000277   002125 710000 6                  TRA     s:5792
         6 000300   002125 710000 6                  TRA     s:5792
         6 000301   000430 710000 6                  TRA     s:5288
         6 000302   000447 710000 6                  TRA     s:5296
         6 000303   000454 710000 6                  TRA     s:5301
         6 000304   000527 710000 6                  TRA     s:5321
         6 000305   000551 710000 6                  TRA     s:5343
         6 000306   000575 710000 6                  TRA     s:5356
         6 000307   000621 710000 6                  TRA     s:5368
         6 000310   000640 710000 6                  TRA     s:5376
         6 000311   000660 710000 6                  TRA     s:5387
         6 000312   000665 710000 6                  TRA     s:5393
         6 000313   000710 710000 6                  TRA     s:5405
         6 000314   002125 710000 6                  TRA     s:5792
         6 000315   000723 710000 6                  TRA     s:5413
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:39   
         6 000316   000734 710000 6                  TRA     s:5425
         6 000317   000752 710000 6                  TRA     s:5437
         6 000320   000764 710000 6                  TRA     s:5444
         6 000321   000776 710000 6                  TRA     s:5451
         6 000322   001001 710000 6                  TRA     s:5453
         6 000323   001004 710000 6                  TRA     s:5455
         6 000324   001074 710000 6                  TRA     s:5496
         6 000325   002125 710000 6                  TRA     s:5792
         6 000326   002125 710000 6                  TRA     s:5792
         6 000327   002125 710000 6                  TRA     s:5792
         6 000330   002125 710000 6                  TRA     s:5792
         6 000331   002125 710000 6                  TRA     s:5792
         6 000332   002125 710000 6                  TRA     s:5792
         6 000333   002125 710000 6                  TRA     s:5792
         6 000334   001077 710000 6                  TRA     s:5502
         6 000335   001104 710000 6                  TRA     s:5506
         6 000336   001131 710000 6                  TRA     s:5519
         6 000337   001143 710000 6                  TRA     s:5528
         6 000340   001237 710000 6                  TRA     s:5557
         6 000341   001253 710000 6                  TRA     s:5564
         6 000342   002125 710000 6                  TRA     s:5792
         6 000343   001267 710000 6                  TRA     s:5572
         6 000344   001307 710000 6                  TRA     s:5580
         6 000345   002125 710000 6                  TRA     s:5792
         6 000346   001344 710000 6                  TRA     s:5592
         6 000347   001736 710000 6                  TRA     s:5699
         6 000350   002125 710000 6                  TRA     s:5792
         6 000351   001766 710000 6                  TRA     s:5720
         6 000352   002125 710000 6                  TRA     s:5792
         6 000353   002125 710000 6                  TRA     s:5792
         6 000354   002125 710000 6                  TRA     s:5792
         6 000355   002125 710000 6                  TRA     s:5792
         6 000356   002125 710000 6                  TRA     s:5792
         6 000357   002125 710000 6                  TRA     s:5792
         6 000360   002125 710000 6                  TRA     s:5792
         6 000361   001775 710000 6                  TRA     s:5723
         6 000362   002026 710000 6                  TRA     s:5742
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:40   
         6 000363   002125 710000 6                  TRA     s:5792
         6 000364   002125 710000 6                  TRA     s:5792
         6 000365   002125 710000 6                  TRA     s:5792
         6 000366   002125 710000 6                  TRA     s:5792
         6 000367   002125 710000 6                  TRA     s:5792
         6 000370   002125 710000 6                  TRA     s:5792
         6 000371   002125 710000 6                  TRA     s:5792
         6 000372   002121 710000 6                  TRA     s:5787
         6 000373   002125 710000 6                  TRA     s:5792
         6 000374   002125 710000 6                  TRA     s:5792
         6 000375   002125 710000 6                  TRA     s:5792
         6 000376   002125 710000 6                  TRA     s:5792
         6 000377   002125 710000 6                  TRA     s:5792
         6 000400   002125 710000 6                  TRA     s:5792
         6 000401   002125 710000 6                  TRA     s:5792
         6 000402   002125 710000 6                  TRA     s:5792
         6 000403   002125 710000 6                  TRA     s:5792
         6 000404   002125 710000 6                  TRA     s:5792
         6 000405   002125 710000 6                  TRA     s:5792
         6 000406   002125 710000 6                  TRA     s:5792
         6 000407   002125 710000 6                  TRA     s:5792
         6 000410   002125 710000 6                  TRA     s:5792
         6 000411   002125 710000 6                  TRA     s:5792
         6 000412   002125 710000 6                  TRA     s:5792
         6 000413   002125 710000 6                  TRA     s:5792
         6 000414   002125 710000 6                  TRA     s:5792
         6 000415   002125 710000 6                  TRA     s:5792
         6 000416   002125 710000 6                  TRA     s:5792
         6 000417   002125 710000 6                  TRA     s:5792
         6 000420   002125 710000 6                  TRA     s:5792
         6 000421   002125 710000 6                  TRA     s:5792
         6 000422   002125 710000 6                  TRA     s:5792
         6 000423   002043 710000 6                  TRA     s:5749
         6 000424   002051 710000 6                  TRA     s:5752
         6 000425   002074 710000 6                  TRA     s:5767
         6 000426   002105 710000 6                  TRA     s:5773
         6 000427   002116 710000 6                  TRA     s:5780
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:41   

      160     5287    3           CASE(3); /* Schema name */

      161     5288    3               CALL GET_WORD;

   5288  6 000430   000103 701000 6                  TSX1    GET_WORD
         6 000431   000000 011000                    NOP     0

      162     5289    3               CALL SRCHD(WORD1,%ZIG_RTYPE_OA,SUCC);

   5289  6 000432   000022 630400 7                  EPPR0   18
         6 000433   000020 631400 7                  EPPR1   16
         6 000434   000000 701000 xent               TSX1    SRCHD
         6 000435   000000 011000                    NOP     0

      163     5290    3               IF ~SUCC THEN CALL ERROR(2099);

   5290  6 000436   000010 236000 0                  LDQ     SUCC
         6 000437   400000 376003                    ANQ     -131072,DU
         6 000440   400000 676003                    ERQ     -131072,DU
         6 000441   002443 600000 6                  TZE     s:5892

   5290  6 000442   000026 630400 7                  EPPR0   22
         6 000443   000000 631400 7                  EPPR1   0
         6 000444   000000 701000 xent               TSX1    ERROR
         6 000445   000000 011000                    NOP     0
         6 000446   002443 710000 6                  TRA     s:5892

      164     5291        /*E*     ERROR:    ZIG-02099-C
      165     5292        MESSAGE: Schema name %U1 is not the same as the schema name
      166     5293                 in the schema file.
      167     5294        */
      168     5295    3           CASE(4); /*File code */

      169     5296    3               CALL WARNING(2101);

   5296  6 000447   000030 630400 7                  EPPR0   24
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:42   
         6 000450   000000 631400 7                  EPPR1   0
         6 000451   000000 701000 xent               TSX1    WARNING
         6 000452   000000 011000                    NOP     0
         6 000453   002443 710000 6                  TRA     s:5892

      170     5297        /*E*     ERROR:    ZIG-2101-C
      171     5298        MESSAGE: File codes are not used in CP-6 I-D-S/II.
      172     5299        */
      173     5300    3           CASE(5); /* End of area */

      174     5301    3               IF UWA.AC.FLAG1.STATUS=0 AND ~INDEX_AREA

   5301  6 000454   000232 236000 4                  LDQ     UWA+154
         6 000455   000777 316007                    CANQ    511,DL
         6 000456   000472 601000 6                  TNZ     s:5309
         6 000457   000031 236000 0                  LDQ     INDEX_AREA
         6 000460   400000 376003                    ANQ     -131072,DU
         6 000461   400000 676003                    ERQ     -131072,DU
         6 000462   000472 600000 6                  TZE     s:5309

      175     5302    4               THEN DO;

      176     5303    4                   UWA.AC.MAX_DBK=100;

   5303  6 000463   000144 235007                    LDA     100,DL
         6 000464   000246 755000 4                  STA     UWA+166

      177     5304    4                   CALL ERROR(2104);

   5304  6 000465   000032 630400 7                  EPPR0   26
         6 000466   000000 631400 7                  EPPR1   0
         6 000467   000000 701000 xent               TSX1    ERROR
         6 000470   000000 011000                    NOP     0

      178     5305        /*E*     ERROR:    ZIG-2104-C
      179     5306        MESSAGE: The ALLOCATE clause for each area must be given.
      180     5307        */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:43   
      181     5308    4                   END;

   5308  6 000471   000474 710000 6                  TRA     s:5310

      182     5309    3               ELSE UWA.AC.FLAG1.STATUS=2;

   5309  6 000472   000002 236007                    LDQ     2,DL
         6 000473   000232 552004 4                  STBQ    UWA+154,'04'O

      183     5310    3               IF INDEX_AREA

   5310  6 000474   000031 234000 0                  SZN     INDEX_AREA
         6 000475   000501 605000 6                  TPL     s:5315

      184     5311    4               THEN DO;

      185     5312    4                   UWA.AC.PAGE_TYP = 3;

   5312  6 000476   000003 235007                    LDA     3,DL
         6 000477   000237 755000 4                  STA     UWA+159

      186     5313    4                   UWA.AC.DBK_CALC=0;

   5313  6 000500   000254 450000 4                  STZ     UWA+172

      187     5314    4                   END;

      188     5315    3               IF ~BAD_AREA THEN CALL MODT('AC  ');

   5315  6 000501   000011 236000 0                  LDQ     BAD_AREA
         6 000502   400000 376003                    ANQ     -131072,DU
         6 000503   400000 676003                    ERQ     -131072,DU
         6 000504   000512 600000 6                  TZE     s:5316

   5315  6 000505   000003 236000 7                  LDQ     3
         6 000506   200011 756100                    STQ     I+1,,AUTO
         6 000507   000070 701000 6                  TSX1    MODT
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:44   
         6 000510   000000 011000                    NOP     0
         6 000511   000514 710000 6                  TRA     s:5317

      189     5316    3               ELSE UWA.AC.FLAG1.STATUS=0;

   5316  6 000512   000000 236003                    LDQ     0,DU
         6 000513   000232 552004 4                  STBQ    UWA+154,'04'O

      190     5317    3               BAD_AREA='0'B;

   5317  6 000514   000011 450000 0                  STZ     BAD_AREA

      191     5318    3               IF UWA.AC.FLAG1.STATUS=2 AND UWA.AC.FLAG1.ERROR_NUM=0

   5318  6 000515   000232 236000 4                  LDQ     UWA+154
         6 000516   000777 376007                    ANQ     511,DL
         6 000517   000002 116007                    CMPQ    2,DL
         6 000520   002443 601000 6                  TNZ     s:5892
         6 000521   000232 236000 4                  LDQ     UWA+154
         6 000522   000033 316000 7                  CANQ    27
         6 000523   002443 601000 6                  TNZ     s:5892

      192     5319    3               THEN UWA.AC.FLAG1.STATUS=3;

   5319  6 000524   000003 236007                    LDQ     3,DL
         6 000525   000232 552004 4                  STBQ    UWA+154,'04'O
         6 000526   002443 710000 6                  TRA     s:5892

      193     5320    3           CASE(6); /* Allocation of data base keys */

      194     5321    3               IF INDEX_AREA

   5321  6 000527   000031 234000 0                  SZN     INDEX_AREA
         6 000530   000536 605000 6                  TPL     s:5335

      195     5322    4               THEN DO;

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:45   
      196     5323    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5323  6 000531   000035 630400 7                  EPPR0   29
         6 000532   000000 631400 7                  EPPR1   0
         6 000533   000000 701000 xent               TSX1    WARNING
         6 000534   000000 011000                    NOP     0

      197     5324        /*E*     ERROR:    ZIG-INDEX_AREA_NO_ALLOC-C
      198     5325        MESSAGE: For the indexed area "%U1" the only legal area entries are:
      199     5326                 TEMPLATE
      200     5327                 JOURNALING IS [ NOT ] REQUIRED
      201     5328                 BACKUP     IS [ NOT ] REQUIRED
      202     5329                 ENCRYPTION IS [ NOT ] REQUIRED
      203     5330                 ORGANIZATION IS INDEXED
      204     5331                 This area entry will be ignored.
      205     5332        */
      206     5333    4                   RETURN;

   5333  6 000535   000000 702200 xent               TSX2  ! X66_ARET

      207     5334    4                   END;
      208     5335    3               CALL GET_NUM(1,MAX1);

   5335  6 000536   000037 236000 7                  LDQ     31
         6 000537   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 000540   000040 236000 7                  LDQ     32
         6 000541   200007 756100                    STQ     I+2,,AUTO
         6 000542   000125 701000 6                  TSX1    GET_NUM
         6 000543   000000 011000                    NOP     0

      209     5336    3               UWA.AC.MAX_DBK=NUM;

   5336  6 000544   000015 235000 0                  LDA     NUM
         6 000545   000246 755000 4                  STA     UWA+166

      210     5337    3               UWA.AC.FLAG1.STATUS=1; /* Set so that we know that allocate sc. */

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:46   
   5337  6 000546   000001 236007                    LDQ     1,DL
         6 000547   000232 552004 4                  STBQ    UWA+154,'04'O
         6 000550   002443 710000 6                  TRA     s:5892

      211     5338        /*E*     ERROR:    ZIG-2006-C
      212     5339        MESSAGE: The number of data base keys to allocate must be
      213     5340                 in the range 1 to 68,719,476,735.
      214     5341        */
      215     5342    3           CASE(7); /* Page interval for data base keys */

      216     5343    3               IF INDEX_AREA

   5343  6 000551   000031 234000 0                  SZN     INDEX_AREA
         6 000552   000560 605000 6                  TPL     s:5348

      217     5344    4               THEN DO;

      218     5345    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5345  6 000553   000035 630400 7                  EPPR0   29
         6 000554   000000 631400 7                  EPPR1   0
         6 000555   000000 701000 xent               TSX1    WARNING
         6 000556   000000 011000                    NOP     0

      219     5346    4                   RETURN;

   5346  6 000557   000000 702200 xent               TSX2  ! X66_ARET

      220     5347    4                   END;
      221     5348    3               CALL GET_NUM(1,512);

   5348  6 000560   000042 236000 7                  LDQ     34
         6 000561   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 000562   000040 236000 7                  LDQ     32
         6 000563   200007 756100                    STQ     I+2,,AUTO
         6 000564   000125 701000 6                  TSX1    GET_NUM
         6 000565   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:47   

      222     5349    3               CALL POWER_2(NUM);

   5349  6 000566   000043 236000 7                  LDQ     35
         6 000567   200007 756100                    STQ     I+2,,AUTO
         6 000570   000174 701000 6                  TSX1    POWER_2
         6 000571   000000 011000                    NOP     0

      223     5350    3               UWA.AC.DBK_PAGE=NUM;

   5350  6 000572   000015 235000 0                  LDA     NUM
         6 000573   000253 755000 4                  STA     UWA+171
         6 000574   002443 710000 6                  TRA     s:5892

      224     5351        /*E*     ERROR:    ZIG-2007-C
      225     5352        MESSAGE: The number of data base keys per page interval must
      226     5353                 be in the range 1 to 512.
      227     5354        */
      228     5355    3           CASE(8); /* Calc interval */

      229     5356    3               IF INDEX_AREA

   5356  6 000575   000031 234000 0                  SZN     INDEX_AREA
         6 000576   000604 605000 6                  TPL     s:5361

      230     5357    4               THEN DO;

      231     5358    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5358  6 000577   000035 630400 7                  EPPR0   29
         6 000600   000000 631400 7                  EPPR1   0
         6 000601   000000 701000 xent               TSX1    WARNING
         6 000602   000000 011000                    NOP     0

      232     5359    4                   RETURN;

   5359  6 000603   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:48   

      233     5360    4                   END;
      234     5361    3               CALL GET_NUM(1,131072);

   5361  6 000604   000045 236000 7                  LDQ     37
         6 000605   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 000606   000040 236000 7                  LDQ     32
         6 000607   200007 756100                    STQ     I+2,,AUTO
         6 000610   000125 701000 6                  TSX1    GET_NUM
         6 000611   000000 011000                    NOP     0

      235     5362    3               CALL POWER_2(NUM);

   5362  6 000612   000043 236000 7                  LDQ     35
         6 000613   200007 756100                    STQ     I+2,,AUTO
         6 000614   000174 701000 6                  TSX1    POWER_2
         6 000615   000000 011000                    NOP     0

      236     5363    3               UWA.AC.DBK_CALC=NUM;

   5363  6 000616   000015 235000 0                  LDA     NUM
         6 000617   000254 755000 4                  STA     UWA+172
         6 000620   002443 710000 6                  TRA     s:5892

      237     5364        /*E*     ERROR:    ZIG-2008-C
      238     5365        MESSAGE: The number of calc intervals must be in the range 1 to 131,072.
      239     5366        */
      240     5367    3           CASE(9); /* Page size */

      241     5368    3               CALL GET_NUM(1,99999);

   5368  6 000621   000047 236000 7                  LDQ     39
         6 000622   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 000623   000040 236000 7                  LDQ     32
         6 000624   200007 756100                    STQ     I+2,,AUTO
         6 000625   000125 701000 6                  TSX1    GET_NUM
         6 000626   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:49   

      242     5369    3               IF NUM=4096 THEN RETURN;

   5369  6 000627   000015 235000 0                  LDA     NUM
         6 000630   010000 115007                    CMPA    4096,DL
         6 000631   000633 601000 6                  TNZ     s:5370

   5369  6 000632   000000 702200 xent               TSX2  ! X66_ARET

      243     5370    3               CALL WARNING(2102);

   5370  6 000633   000051 630400 7                  EPPR0   41
         6 000634   000000 631400 7                  EPPR1   0
         6 000635   000000 701000 xent               TSX1    WARNING
         6 000636   000000 011000                    NOP     0
         6 000637   002443 710000 6                  TRA     s:5892

      244     5371        /*E*     ERROR:    ZIG-2102-C
      245     5372        MESSAGE: The PAGE SIZE option in the DMCL is not allowed in CP-6
      246     5373                 I-D-S/II. The page size is set to 4096.
      247     5374        */
      248     5375    3           CASE(10); /* Inventory percent */

      249     5376    3               IF INDEX_AREA

   5376  6 000640   000031 234000 0                  SZN     INDEX_AREA
         6 000641   000647 605000 6                  TPL     s:5381

      250     5377    4               THEN DO;

      251     5378    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5378  6 000642   000035 630400 7                  EPPR0   29
         6 000643   000000 631400 7                  EPPR1   0
         6 000644   000000 701000 xent               TSX1    WARNING
         6 000645   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:50   
      252     5379    4                   RETURN;

   5379  6 000646   000000 702200 xent               TSX2  ! X66_ARET

      253     5380    4                   END;
      254     5381    3               CALL GET_NUM(1,99);

   5381  6 000647   000053 236000 7                  LDQ     43
         6 000650   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 000651   000040 236000 7                  LDQ     32
         6 000652   200007 756100                    STQ     I+2,,AUTO
         6 000653   000125 701000 6                  TSX1    GET_NUM
         6 000654   000000 011000                    NOP     0

      255     5382    3               UWA.AC.PER_INV=NUM;

   5382  6 000655   000015 235000 0                  LDA     NUM
         6 000656   000240 755000 4                  STA     UWA+160
         6 000657   002443 710000 6                  TRA     s:5892

      256     5383        /*E*     ERROR:    ZIG-2010-C
      257     5384        MESSAGE: The inventory percent must be in the range 1 to 99.
      258     5385        */
      259     5386    3           CASE(11); /* Load limit */

      260     5387    3               CALL WARNING(2103);

   5387  6 000660   000055 630400 7                  EPPR0   45
         6 000661   000000 631400 7                  EPPR1   0
         6 000662   000000 701000 xent               TSX1    WARNING
         6 000663   000000 011000                    NOP     0
         6 000664   002443 710000 6                  TRA     s:5892

      261     5388        /*E*     ERROR:    ZIG-2103-C
      262     5389        MESSAGE: The LOAD LIMIT is not used in CP-6.
      263     5390                 This statement will not be processed.
      264     5391        */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:51   
      265     5392    3           CASE(12); /* Reserve keys */

      266     5393    3               IF INDEX_AREA

   5393  6 000665   000031 234000 0                  SZN     INDEX_AREA
         6 000666   000674 605000 6                  TPL     s:5398

      267     5394    4               THEN DO;

      268     5395    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5395  6 000667   000035 630400 7                  EPPR0   29
         6 000670   000000 631400 7                  EPPR1   0
         6 000671   000000 701000 xent               TSX1    WARNING
         6 000672   000000 011000                    NOP     0

      269     5396    4                   RETURN;

   5396  6 000673   000000 702200 xent               TSX2  ! X66_ARET

      270     5397    4                   END;
      271     5398    3               CALL GET_NUM(1,MAX1/2);

   5398  6 000674   000020 236000 0                  LDQ     MAXN
         6 000675   000001 772000                    QRL     1
         6 000676   200016 756100                    STQ     COUNT+5,,AUTO
         6 000677   200016 631500                    EPPR1   COUNT+5,,AUTO
         6 000700   200010 451500                    STP1    @NUM_2+1,,AUTO
         6 000701   000040 236000 7                  LDQ     32
         6 000702   200007 756100                    STQ     I+2,,AUTO
         6 000703   000125 701000 6                  TSX1    GET_NUM
         6 000704   000000 011000                    NOP     0

      272     5399    3               UWA.AC.KEYS_RSRVD=NUM;

   5399  6 000705   000015 235000 0                  LDA     NUM
         6 000706   000244 755000 4                  STA     UWA+164
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:52   
         6 000707   002443 710000 6                  TRA     s:5892

      273     5400        /*E*     ERROR:    ZIG-2012-C
      274     5401        MESSAGE: The number of keys reserved must be in the range
      275     5402                 1 to 34,359,738,367.
      276     5403        */
      277     5404    3           CASE(13); /* Null on CALC_INTERVAL */

      278     5405    3               IF INDEX_AREA

   5405  6 000710   000031 234000 0                  SZN     INDEX_AREA
         6 000711   000717 605000 6                  TPL     s:5410

      279     5406    4               THEN DO;

      280     5407    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5407  6 000712   000035 630400 7                  EPPR0   29
         6 000713   000000 631400 7                  EPPR1   0
         6 000714   000000 701000 xent               TSX1    WARNING
         6 000715   000000 011000                    NOP     0

      281     5408    4                   RETURN;

   5408  6 000716   000000 702200 xent               TSX2  ! X66_ARET

      282     5409    4                   END;
      283     5410    3               UWA.AC.CALC_NULL=1;

   5410  6 000717   000001 235007                    LDA     1,DL
         6 000720   000241 755000 4                  STA     UWA+161

      284     5411    3               UWA.AC.DBK_CALC=0;

   5411  6 000721   000254 450000 4                  STZ     UWA+172
         6 000722   002443 710000 6                  TRA     s:5892

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:53   
      285     5412    3           CASE(15); /* Intergrated organization */

      286     5413    3               IF INDEX_AREA

   5413  6 000723   000031 234000 0                  SZN     INDEX_AREA
         6 000724   000732 605000 6                  TPL     s:5423

      287     5414    4               THEN DO;

      288     5415    4                   CALL ERROR(%INDEX_NOT_INTERGRATED);

   5415  6 000725   000057 630400 7                  EPPR0   47
         6 000726   000000 631400 7                  EPPR1   0
         6 000727   000000 701000 xent               TSX1    ERROR
         6 000730   000000 011000                    NOP     0

      289     5416        /*E*     ERROR:    ZIG-INDEX_NOT_INTERGRATED-C
      290     5417        MESSAGE: The area "%U1" has INDEXED record types so
      291     5418                 the area must be ORGANIZATION IS INDEXED, not
      292     5419                 ORGANIZATION IS INTEGRATED.
      293     5420        */
      294     5421    4                   RETURN;

   5421  6 000731   000000 702200 xent               TSX2  ! X66_ARET

      295     5422    4                   END;
      296     5423    3               UWA.AC.PAGE_TYP=0;

   5423  6 000732   000237 450000 4                  STZ     UWA+159
         6 000733   002443 710000 6                  TRA     s:5892

      297     5424    3           CASE(16); /* Indexed organization */

      298     5425    3               IF ~INDEX_AREA

   5425  6 000734   000031 236000 0                  LDQ     INDEX_AREA
         6 000735   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:54   
         6 000736   400000 676003                    ERQ     -131072,DU
         6 000737   000745 600000 6                  TZE     s:5434

      299     5426    4               THEN DO;

      300     5427    4                   CALL ERROR(%INTERGRATED_NOT_INDEX);

   5427  6 000740   000061 630400 7                  EPPR0   49
         6 000741   000000 631400 7                  EPPR1   0
         6 000742   000000 701000 xent               TSX1    ERROR
         6 000743   000000 011000                    NOP     0

      301     5428        /*E*     ERROR:    ZIG-INTERGRATED_NOT_INDEX-C
      302     5429        MESSAGE: The area "%U1" does not contain a record of type INDEXED
      303     5430                 so the area cannot be declared as ORGANIZATION IS INDEXED.
      304     5431        */
      305     5432    4                   RETURN;

   5432  6 000744   000000 702200 xent               TSX2  ! X66_ARET

      306     5433    4                   END;
      307     5434    3               UWA.AC.PAGE_TYP=3;

   5434  6 000745   000003 235007                    LDA     3,DL
         6 000746   000237 755000 4                  STA     UWA+159

      308     5435    3               UWA.AC.CALC_NULL=1;

   5435  6 000747   000001 236007                    LDQ     1,DL
         6 000750   000241 756000 4                  STQ     UWA+161
         6 000751   002443 710000 6                  TRA     s:5892

      309     5436    3           CASE(17); /* Checksum */

      310     5437    3               IF INDEX_AREA

   5437  6 000752   000031 234000 0                  SZN     INDEX_AREA
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:55   
         6 000753   000761 605000 6                  TPL     s:5442

      311     5438    4               THEN DO;

      312     5439    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5439  6 000754   000035 630400 7                  EPPR0   29
         6 000755   000000 631400 7                  EPPR1   0
         6 000756   000000 701000 xent               TSX1    WARNING
         6 000757   000000 011000                    NOP     0

      313     5440    4                   RETURN;

   5440  6 000760   000000 702200 xent               TSX2  ! X66_ARET

      314     5441    4                   END;
      315     5442    3               UWA.AC.FLAGS.CHKSUM='1'B;

   5442  6 000761   400000 236003                    LDQ     -131072,DU
         6 000762   000233 256000 4                  ORSQ    UWA+155
         6 000763   002443 710000 6                  TRA     s:5892

      316     5443    3           CASE(18); /* Encryption */

      317     5444    3               IF INDEX_AREA

   5444  6 000764   000031 234000 0                  SZN     INDEX_AREA
         6 000765   000773 605000 6                  TPL     s:5449

      318     5445    4               THEN DO;

      319     5446    4                   CALL WARNING(%INDEX_AREA_NO_ALLOC);

   5446  6 000766   000035 630400 7                  EPPR0   29
         6 000767   000000 631400 7                  EPPR1   0
         6 000770   000000 701000 xent               TSX1    WARNING
         6 000771   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:56   

      320     5447    4                   RETURN;

   5447  6 000772   000000 702200 xent               TSX2  ! X66_ARET

      321     5448    4                   END;
      322     5449    3               UWA.AC.FLAGS.ENCRP='1'B;

   5449  6 000773   200000 236003                    LDQ     65536,DU
         6 000774   000233 256000 4                  ORSQ    UWA+155
         6 000775   002443 710000 6                  TRA     s:5892

      323     5450    3           CASE(19); /* Journaling */

      324     5451    3               UWA.AC.FLAGS.CJRNL='1'B;

   5451  6 000776   100000 236003                    LDQ     32768,DU
         6 000777   000233 256000 4                  ORSQ    UWA+155
         6 001000   002443 710000 6                  TRA     s:5892

      325     5452    3           CASE(20); /* Template */

      326     5453    3               UWA.AC.FLAGS.TMPLT='1'B;

   5453  6 001001   040000 236003                    LDQ     16384,DU
         6 001002   000233 256000 4                  ORSQ    UWA+155
         6 001003   002443 710000 6                  TRA     s:5892

      327     5454    3           CASE(21); /* Area name */

      328     5455    3               BAD_AREA='0'B;

   5455  6 001004   000011 450000 0                  STZ     BAD_AREA

      329     5456    3               CALL GET_WORD;

   5456  6 001005   000103 701000 6                  TSX1    GET_WORD
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:57   
         6 001006   000000 011000                    NOP     0

      330     5457    3               CALL SRCHD(WORD1,%ZIG_RTYPE_AC,SUCC);

   5457  6 001007   000063 630400 7                  EPPR0   51
         6 001010   000020 631400 7                  EPPR1   16
         6 001011   000000 701000 xent               TSX1    SRCHD
         6 001012   000000 011000                    NOP     0

      331     5458    3               IF ~SUCC

   5458  6 001013   000010 236000 0                  LDQ     SUCC
         6 001014   400000 376003                    ANQ     -131072,DU
         6 001015   400000 676003                    ERQ     -131072,DU
         6 001016   001026 600000 6                  TZE     s:5468

      332     5459    4               THEN DO;

      333     5460    4                   CALL ERROR(2121);

   5460  6 001017   000067 630400 7                  EPPR0   55
         6 001020   000000 631400 7                  EPPR1   0
         6 001021   000000 701000 xent               TSX1    ERROR
         6 001022   000000 011000                    NOP     0

      334     5461    4                   BAD_AREA='1'B;

   5461  6 001023   400000 236003                    LDQ     -131072,DU
         6 001024   000011 756000 0                  STQ     BAD_AREA

      335     5462    4                   END;

   5462  6 001025   001030 710000 6                  TRA     s:5469

      336     5463        /*E*     ERROR:    ZIG-2121-C
      337     5464        MESSAGE: The name of the area was not found in the schema file
      338     5465                 so you either misspelled it or did not declare it in
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:58   
      339     5466                 the DDL.
      340     5467        */
      341     5468    3               ELSE CALL PROCCESS_NAME;

   5468  6 001026   000003 701000 6                  TSX1    PROCCESS_NAME
         6 001027   000000 011000                    NOP     0

      342     5469    3               IF UWA.AC.FLAG1.STATUS ~=0

   5469  6 001030   000232 236000 4                  LDQ     UWA+154
         6 001031   000777 316007                    CANQ    511,DL
         6 001032   001041 600000 6                  TZE     s:5478

      343     5470    4               THEN DO;

      344     5471    4                   BAD_AREA='1'B;

   5471  6 001033   400000 236003                    LDQ     -131072,DU
         6 001034   000011 756000 0                  STQ     BAD_AREA

      345     5472    4                   CALL ERROR(2122);

   5472  6 001035   000071 630400 7                  EPPR0   57
         6 001036   000000 631400 7                  EPPR1   0
         6 001037   000000 701000 xent               TSX1    ERROR
         6 001040   000000 011000                    NOP     0

      346     5473        /*E*     ERROR:    ZIG-2122-C
      347     5474        MESSAGE: The AREA entry can only be given once per area defined
      348     5475                 by the DDL.
      349     5476        */
      350     5477    4                   END;

      351     5478    3               UWA.AC.FLAGS.CHKSUM='0'B;

   5478  6 001041   000072 236000 7                  LDQ     58
         6 001042   000233 356000 4                  ANSQ    UWA+155
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:59   

      352     5479    3               UWA.AC.FLAGS.ENCRP='0'B;

   5479  6 001043   000073 236000 7                  LDQ     59
         6 001044   000233 356000 4                  ANSQ    UWA+155

      353     5480    3               UWA.AC.FLAGS.CJRNL='0'B;

   5480  6 001045   000074 236000 7                  LDQ     60
         6 001046   000233 356000 4                  ANSQ    UWA+155

      354     5481    3               UWA.AC.FLAGS.TMPLT='0'B;

   5481  6 001047   000075 236000 7                  LDQ     61
         6 001050   000233 356000 4                  ANSQ    UWA+155

      355     5482    3               UWA.AC.FLAGS.TJRNL='0'B;

   5482  6 001051   000076 236000 7                  LDQ     62
         6 001052   000233 356000 4                  ANSQ    UWA+155

      356     5483    3               UWA.AC.FLAG1.STATUS=0;

   5483  6 001053   000000 236003                    LDQ     0,DU
         6 001054   000232 552004 4                  STBQ    UWA+154,'04'O

      357     5484    3               UWA.AC.FLAG1.ERROR_NUM=0;

   5484  6 001055   000232 552070 4                  STBQ    UWA+154,'70'O

      358     5485    3               UWA.AC.PAGE_SIZE=4084;

   5485  6 001056   007764 235007                    LDA     4084,DL
         6 001057   000262 755000 4                  STA     UWA+178

      359     5486    3               CALL MODT('AC  ');

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:60   
   5486  6 001060   000003 236000 7                  LDQ     3
         6 001061   200011 756100                    STQ     I+1,,AUTO
         6 001062   000070 701000 6                  TSX1    MODT
         6 001063   000000 011000                    NOP     0

      360     5487        /*W*
      361     5488              If this area is a INDEXED area then most of the entries
      362     5489            in the area clause can't be used so put out a warning and
      363     5490            return from them and don't change the area.
      364     5491        */
      365     5492    3               IF UWA.AC.PRIME_KEY = 1

   5492  6 001064   000234 235000 4                  LDA     UWA+156
         6 001065   000001 115007                    CMPA    1,DL
         6 001066   001072 601000 6                  TNZ     s:5494

      366     5493    3               THEN INDEX_AREA = '1'B;

   5493  6 001067   400000 236003                    LDQ     -131072,DU
         6 001070   000031 756000 0                  STQ     INDEX_AREA
         6 001071   002443 710000 6                  TRA     s:5892

      367     5494    3               ELSE INDEX_AREA = '0'B;

   5494  6 001072   000031 450000 0                  STZ     INDEX_AREA
         6 001073   002443 710000 6                  TRA     s:5892

      368     5495    3           CASE(22); /* Backup */

      369     5496    3               UWA.AC.FLAGS.TJRNL='1'B;

   5496  6 001074   020000 236003                    LDQ     8192,DU
         6 001075   000233 256000 4                  ORSQ    UWA+155
         6 001076   002443 710000 6                  TRA     s:5892

      370     5497
      371     5498
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:61   
      372     5499
      373     5500        /*   Record enrty  */
      374     5501    3           CASE(30); /* End of record entry */

      375     5502    3               CALL MODT('RC  ');

   5502  6 001077   000005 236000 7                  LDQ     5
         6 001100   200011 756100                    STQ     I+1,,AUTO
         6 001101   000070 701000 6                  TSX1    MODT
         6 001102   000000 011000                    NOP     0
         6 001103   002443 710000 6                  TRA     s:5892

      376     5503
      377     5504
      378     5505    3           CASE (31); /* Record name */

      379     5506    3               BAD_RECORD='0'B;

   5506  6 001104   000016 450000 0                  STZ     BAD_RECORD

      380     5507    3               CALL GET_WORD;

   5507  6 001105   000103 701000 6                  TSX1    GET_WORD
         6 001106   000000 011000                    NOP     0

      381     5508    3               CALL SRCHD(WORD1,%ZIG_RTYPE_RC,SUCC);

   5508  6 001107   000100 630400 7                  EPPR0   64
         6 001110   000020 631400 7                  EPPR1   16
         6 001111   000000 701000 xent               TSX1    SRCHD
         6 001112   000000 011000                    NOP     0

      382     5509    3               IF ~SUCC

   5509  6 001113   000010 236000 0                  LDQ     SUCC
         6 001114   400000 376003                    ANQ     -131072,DU
         6 001115   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:62   
         6 001116   001126 600000 6                  TZE     s:5517

      383     5510    4               THEN DO;

      384     5511    4                   BAD_RECORD='1'B;

   5511  6 001117   400000 236003                    LDQ     -131072,DU
         6 001120   000016 756000 0                  STQ     BAD_RECORD

      385     5512    4                   CALL ERROR(2131);

   5512  6 001121   000104 630400 7                  EPPR0   68
         6 001122   000000 631400 7                  EPPR1   0
         6 001123   000000 701000 xent               TSX1    ERROR
         6 001124   000000 011000                    NOP     0

      386     5513        /*E*     ERROR:    ZIG-2131-C
      387     5514        MESSAGE: This record was not defined in the DDL.
      388     5515        */
      389     5516    4                   END;

   5516  6 001125   002443 710000 6                  TRA     s:5892

      390     5517    3               ELSE CALL PROCCESS_NAME;

   5517  6 001126   000003 701000 6                  TSX1    PROCCESS_NAME
         6 001127   000000 011000                    NOP     0
         6 001130   002443 710000 6                  TRA     s:5892

      391     5518    3           CASE(32); /* Range clause */

      392     5519    3               IF UWA.RC.PSMODE=4

   5519  6 001131   000271 235000 4                  LDA     UWA+185
         6 001132   000004 115007                    CMPA    4,DL
         6 001133   002443 601000 6                  TNZ     s:5892

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:63   
      393     5520    4               THEN DO;

      394     5521    4                   CALL ERROR(2032);

   5521  6 001134   000106 630400 7                  EPPR0   70
         6 001135   000000 631400 7                  EPPR1   0
         6 001136   000000 701000 xent               TSX1    ERROR
         6 001137   000000 011000                    NOP     0

      395     5522        /*E*     ERROR:    ZIG-2032-C
      396     5523        MESSAGE: The RANGE clause cannot be used for an INDEXED record.
      397     5524        */
      398     5525    4                   BAD_RECORD='1'B;

   5525  6 001140   400000 236003                    LDQ     -131072,DU
         6 001141   000016 756000 0                  STQ     BAD_RECORD

      399     5526    4                   END;

   5526  6 001142   002443 710000 6                  TRA     s:5892

      400     5527    3           CASE(33); /* Areas given in record clause */

      401     5528    3               IF BAD_RECORD THEN RETURN;

   5528  6 001143   000016 234000 0                  SZN     BAD_RECORD
         6 001144   001146 605000 6                  TPL     s:5529

   5528  6 001145   000000 702200 xent               TSX2  ! X66_ARET

      402     5529    3               CALL GET_WORD;

   5529  6 001146   000103 701000 6                  TSX1    GET_WORD
         6 001147   000000 011000                    NOP     0

      403     5530    3               CALL SRCHD(WORD1,%ZIG_RTYPE_AC,SUCC);

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:64   
   5530  6 001150   000063 630400 7                  EPPR0   51
         6 001151   000020 631400 7                  EPPR1   16
         6 001152   000000 701000 xent               TSX1    SRCHD
         6 001153   000000 011000                    NOP     0

      404     5531    3               IF ~SUCC

   5531  6 001154   000010 236000 0                  LDQ     SUCC
         6 001155   400000 376003                    ANQ     -131072,DU
         6 001156   400000 676003                    ERQ     -131072,DU
         6 001157   001165 600000 6                  TZE     s:5539

      405     5532    4               THEN DO;

      406     5533    4                   CALL ERROR(2033);

   5533  6 001160   000110 630400 7                  EPPR0   72
         6 001161   000000 631400 7                  EPPR1   0
         6 001162   000000 701000 xent               TSX1    ERROR
         6 001163   000000 011000                    NOP     0

      407     5534        /*E*     ERROR:    ZIG-2033-C
      408     5535        MESSAGE: The area "%U1" is not defined in the schema.
      409     5536        */
      410     5537    4                   END;

   5537  6 001164   002443 710000 6                  TRA     s:5892

      411     5538    4               ELSE DO;

      412     5539    4                   CALL FETCHNS_6('SN-SE   ') ALTRET(FAIL);/* Get ac */

   5539  6 001165   000001 630400 7                  EPPR0   1
         6 001166   000000 631400 7                  EPPR1   0
         6 001167   000000 701000 xent               TSX1    FETCHNS_6
         6 001170   001232 702000 6                  TSX2    FAIL

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:65   
      413     5540    4                   DBK_AC=UWA.DIRECT_REF;

   5540  6 001171   000036 235000 4                  LDA     UWA+30
         6 001172   000012 755000 0                  STA     DBK_AC

      414     5541    4                   CALL FETCHOS_6('RC-RA   ');

   5541  6 001173   000111 630400 7                  EPPR0   73
         6 001174   000000 631400 7                  EPPR1   0
         6 001175   000000 701000 xent               TSX1    FETCHOS_6
         6 001176   000000 011000                    NOP     0

      415     5542    5                   DO WHILE (DBK_AC ~= UWA.DIRECT_REF);

   5542  6 001177   000012 236000 0                  LDQ     DBK_AC
         6 001200   000036 116000 4                  CMPQ    UWA+30
         6 001201   001215 600000 6                  TZE     s:5546

      416     5543    5                       CALL FETCHNS_6('RC-RA   ') ALTRET(FAIL);

   5543  6 001202   000111 630400 7                  EPPR0   73
         6 001203   000000 631400 7                  EPPR1   0
         6 001204   000000 701000 xent               TSX1    FETCHNS_6
         6 001205   001232 702000 6                  TSX2    FAIL

      417     5544    5                       CALL FETCHOS_6('AC-RA   ');

   5544  6 001206   000112 630400 7                  EPPR0   74
         6 001207   000000 631400 7                  EPPR1   0
         6 001210   000000 701000 xent               TSX1    FETCHOS_6
         6 001211   000000 011000                    NOP     0

      418     5545    5                       END;

   5545  6 001212   000012 236000 0                  LDQ     DBK_AC
         6 001213   000036 116000 4                  CMPQ    UWA+30
         6 001214   001202 601000 6                  TNZ     s:5543
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:66   

      419     5546    4                   UWA.RA.LOWDBK=LOW_DBK;

   5546  6 001215   000022 235000 0                  LDA     LOW_DBK
         6 001216   000326 755000 4                  STA     UWA+214

      420     5547    4                   UWA.RA.HIGHDBK=HIGH_DBK;

   5547  6 001217   000021 235000 0                  LDA     HIGH_DBK
         6 001220   000327 755000 4                  STA     UWA+215

      421     5548    4                   CALL FCURR_R_6('RA  ');

   5548  6 001221   000113 630400 7                  EPPR0   75
         6 001222   000000 631400 7                  EPPR1   0
         6 001223   000000 701000 xent               TSX1    FCURR_R_6
         6 001224   000000 011000                    NOP     0

      422     5549    4                   CALL MODIFYIA_6('RA  ');

   5549  6 001225   000113 630400 7                  EPPR0   75
         6 001226   000000 631400 7                  EPPR1   0
         6 001227   000000 701000 xent               TSX1    MODIFYIA_6
         6 001230   000000 011000                    NOP     0

      423     5550    4                   RETURN;

   5550  6 001231   000000 702200 xent               TSX2  ! X66_ARET

      424     5551    4   FAIL:           CALL ERROR(2132);

   5551  6 001232   000115 630400 7     FAIL         EPPR0   77
         6 001233   000000 631400 7                  EPPR1   0
         6 001234   000000 701000 xent               TSX1    ERROR
         6 001235   000000 011000                    NOP     0

      425     5552        /*E*     ERROR:    ZIG-2132-C
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:67   
      426     5553        MESSAGE: Record not defined for the area "%U1".
      427     5554        */
      428     5555    4                   END;

   5555  6 001236   002443 710000 6                  TRA     s:5892

      429     5556    3           CASE(34); /* Low range value */

      430     5557    3               CALL GET_NUM(1,MAX1/2);

   5557  6 001237   000020 236000 0                  LDQ     MAXN
         6 001240   000001 772000                    QRL     1
         6 001241   200017 756100                    STQ     COUNT+6,,AUTO
         6 001242   200017 631500                    EPPR1   COUNT+6,,AUTO
         6 001243   200010 451500                    STP1    @NUM_2+1,,AUTO
         6 001244   000040 236000 7                  LDQ     32
         6 001245   200007 756100                    STQ     I+2,,AUTO
         6 001246   000125 701000 6                  TSX1    GET_NUM
         6 001247   000000 011000                    NOP     0

      431     5558    3               LOW_DBK=NUM;

   5558  6 001250   000015 235000 0                  LDA     NUM
         6 001251   000022 755000 0                  STA     LOW_DBK
         6 001252   002443 710000 6                  TRA     s:5892

      432     5559        /*E*     ERROR:    ZIG-2034-C
      433     5560        MESSAGE: The low key for the range clause in the RECORD entry must
      434     5561                 be in the range from 1 to 34,359,738,369.
      435     5562        */
      436     5563    3           CASE(35); /* High range value */

      437     5564    3               CALL GET_NUM(LOW_DBK,MAX1/2);

   5564  6 001253   000020 236000 0                  LDQ     MAXN
         6 001254   000001 772000                    QRL     1
         6 001255   200020 756100                    STQ     COUNT+7,,AUTO
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:68   
         6 001256   200020 631500                    EPPR1   COUNT+7,,AUTO
         6 001257   200010 451500                    STP1    @NUM_2+1,,AUTO
         6 001260   000116 236000 7                  LDQ     78
         6 001261   200007 756100                    STQ     I+2,,AUTO
         6 001262   000125 701000 6                  TSX1    GET_NUM
         6 001263   000000 011000                    NOP     0

      438     5565    3               HIGH_DBK=NUM;

   5565  6 001264   000015 235000 0                  LDA     NUM
         6 001265   000021 755000 0                  STA     HIGH_DBK
         6 001266   002443 710000 6                  TRA     s:5892

      439     5566        /*E*     ERROR:    ZIG-2035-C
      440     5567        MESSAGE: The high key for the RANGE clause in the RECORD entry
      441     5568                 must be greater than or equal to the low key and less than
      442     5569                 34,359,738,369.
      443     5570        */
      444     5571    3           CASE(37); /* Type clause in the record entry */

      445     5572    3               IF BAD_RECORD THEN RETURN;

   5572  6 001267   000016 234000 0                  SZN     BAD_RECORD
         6 001270   001272 605000 6                  TPL     s:5573

   5572  6 001271   000000 702200 xent               TSX2  ! X66_ARET

      446     5573    3               CALL GET_NUM(1,3999);

   5573  6 001272   000120 236000 7                  LDQ     80
         6 001273   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 001274   000040 236000 7                  LDQ     32
         6 001275   200007 756100                    STQ     I+2,,AUTO
         6 001276   000125 701000 6                  TSX1    GET_NUM
         6 001277   000000 011000                    NOP     0

      447     5574    3               UWA.RC.RTYPE=NUM;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:69   

   5574  6 001300   000015 235000 0                  LDA     NUM
         6 001301   000270 755000 4                  STA     UWA+184

      448     5575    3               CALL MODT('RC  ');

   5575  6 001302   000005 236000 7                  LDQ     5
         6 001303   200011 756100                    STQ     I+1,,AUTO
         6 001304   000070 701000 6                  TSX1    MODT
         6 001305   000000 011000                    NOP     0
         6 001306   002443 710000 6                  TRA     s:5892

      449     5576        /*E*     ERROR:    ZIG-2037-C
      450     5577        MESSAGE: The type of the record must be in the range of 1 to 3999.
      451     5578        */
      452     5579    3           CASE(38); /* No areas given in the range clause */

      453     5580    3               IF BAD_RECORD THEN RETURN;

   5580  6 001307   000016 234000 0                  SZN     BAD_RECORD
         6 001310   001312 605000 6                  TPL     s:5581

   5580  6 001311   000000 702200 xent               TSX2  ! X66_ARET

      454     5581    3               CALL FETCHOS_6('RC-RA   '); /* Find owner */

   5581  6 001312   000111 630400 7                  EPPR0   73
         6 001313   000000 631400 7                  EPPR1   0
         6 001314   000000 701000 xent               TSX1    FETCHOS_6
         6 001315   000000 011000                    NOP     0

      455     5582    4               DO WHILE ('1'B);

      456     5583    4                   CALL FETCHNS_6('RC-RA   ') ALTRET(RET); /* Get next ra */

   5583  6 001316   000111 630400 7                  EPPR0   73
         6 001317   000000 631400 7                  EPPR1   0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:70   
         6 001320   000000 701000 xent               TSX1    FETCHNS_6
         6 001321   001343 702000 6                  TSX2    RET

      457     5584    4                   CALL FETCHOS_6('AC-RA   ');

   5584  6 001322   000112 630400 7                  EPPR0   74
         6 001323   000000 631400 7                  EPPR1   0
         6 001324   000000 701000 xent               TSX1    FETCHOS_6
         6 001325   000000 011000                    NOP     0

      458     5585    4                   UWA.RA.LOWDBK=LOW_DBK;

   5585  6 001326   000022 235000 0                  LDA     LOW_DBK
         6 001327   000326 755000 4                  STA     UWA+214

      459     5586    4                   UWA.RA.HIGHDBK=HIGH_DBK;

   5586  6 001330   000021 236000 0                  LDQ     HIGH_DBK
         6 001331   000327 756000 4                  STQ     UWA+215

      460     5587    4                   CALL FCURR_R_6('RA  ');

   5587  6 001332   000113 630400 7                  EPPR0   75
         6 001333   000000 631400 7                  EPPR1   0
         6 001334   000000 701000 xent               TSX1    FCURR_R_6
         6 001335   000000 011000                    NOP     0

      461     5588    4                   CALL MODIFYIA_6('RA  ');

   5588  6 001336   000113 630400 7                  EPPR0   75
         6 001337   000000 631400 7                  EPPR1   0
         6 001340   000000 701000 xent               TSX1    MODIFYIA_6
         6 001341   000000 011000                    NOP     0

      462     5589    4                   END;

   5589  6 001342   001316 710000 6                  TRA     s:5583
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:71   

      463     5590    3   RET:        RETURN;

   5590  6 001343   000000 702200 xent  RET          TSX2  ! X66_ARET

      464     5591    3           CASE (40); /* SET name claues (end) */

      465     5592    3               IF UWA.SC.SETMODE = 2

   5592  6 001344   000311 235000 4                  LDA     UWA+201
         6 001345   000002 115007                    CMPA    2,DL
         6 001346   002443 601000 6                  TNZ     s:5892

      466     5593    4               THEN DO;

      467     5594    4                   CALL CONCAT(WORD1,'*PA_REC_',UWA.SN.SENAME);

   5594  6 001347   000014 237000 5                  LDAQ    12
         6 001350   000000 757000 0                  STAQ    WORD1
         6 001351   040000 100400                    MLR     fill='040'O
         6 001352   000427 000026 4                  ADSC9   UWA+279                  cn=0,n=22
         6 001353   000002 000026 0                  ADSC9   WORD1+2                  cn=0,n=22

      468     5595    4                   CALL FETCHD_6('SN  ',UWA.DA.FRST_RC);

   5595  6 001354   000121 630400 7                  EPPR0   81
         6 001355   000004 631400 7                  EPPR1   4
         6 001356   000000 701000 xent               TSX1    FETCHD_6
         6 001357   000000 011000                    NOP     0

      469     5596    5                   DO WHILE (UWA.SN.SENAME < WORD1);

   5596  6 001360   040000 106400                    CMPC    fill='040'O
         6 001361   000427 000036 4                  ADSC9   UWA+279                  cn=0,n=30
         6 001362   000000 000036 0                  ADSC9   WORD1                    cn=0,n=30
         6 001363   001376 603000 6                  TRC     END_SN

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:72   
      470     5597    5                       I = UWA.DIRECT_REF;

   5597  6 001364   000036 235000 4                  LDA     UWA+30
         6 001365   200005 755100                    STA     I,,AUTO

      471     5598    5                       CALL FETCHNS_6('DA-SN   ') ALTRET(END_SN);

   5598  6 001366   000123 630400 7                  EPPR0   83
         6 001367   000000 631400 7                  EPPR1   0
         6 001370   000000 701000 xent               TSX1    FETCHNS_6
         6 001371   001376 702000 6                  TSX2    END_SN

      472     5599    5                       END;

   5599  6 001372   040000 106400                    CMPC    fill='040'O
         6 001373   000427 000036 4                  ADSC9   UWA+279                  cn=0,n=30
         6 001374   000000 000036 0                  ADSC9   WORD1                    cn=0,n=30
         6 001375   001364 602000 6                  TNC     s:5597

      473     5600    4   END_SN:
      474     5601    4                   CALL FINDD_6('SN  ',I);

   5601  6 001376   200005 630500       END_SN       EPPR0   I,,AUTO
         6 001377   200015 450500                    STP0    COUNT+4,,AUTO
         6 001400   000121 236000 7                  LDQ     81
         6 001401   200014 756100                    STQ     COUNT+3,,AUTO
         6 001402   200014 630500                    EPPR0   COUNT+3,,AUTO
         6 001403   000004 631400 7                  EPPR1   4
         6 001404   000000 701000 xent               TSX1    FINDD_6
         6 001405   000000 011000                    NOP     0

      475     5602    4                   IF UWA.SN.SENAME = WORD1

   5602  6 001406   040000 106400                    CMPC    fill='040'O
         6 001407   000427 000036 4                  ADSC9   UWA+279                  cn=0,n=30
         6 001410   000000 000036 0                  ADSC9   WORD1                    cn=0,n=30
         6 001411   001422 601000 6                  TNZ     s:5613
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:73   

      476     5603    5                   THEN DO;

      477     5604    5                       CALL SET_FIELDS(2,30,WORD1);

   5604  6 001412   000126 630400 7                  EPPR0   86
         6 001413   000020 631400 7                  EPPR1   16
         6 001414   000000 701000 xent               TSX1    SET_FIELDS
         6 001415   000000 011000                    NOP     0

      478     5605    5                       CALL ERROR(%ZIG_DMCL_DUP_PTR_NAME);

   5605  6 001416   000132 630400 7                  EPPR0   90
         6 001417   000000 631400 7                  EPPR1   0
         6 001420   000000 701000 xent               TSX1    ERROR
         6 001421   000000 011000                    NOP     0

      479     5606        /*E*     ERROR:    ZIG-ZIG_DMCL_DUP_PTR_NAME-C
      480     5607        MESSAGE: For the POINTER ARRAY "%U2" syn record two sets have
      481     5608                 almost the same name. One of the sets' names must be changed
      482     5609                 in the schema DDL before the DMCL will work, or one of the
      483     5610                 sets cannot be a POINTER ARRAY.
      484     5611        */
      485     5612    5                       END;

      486     5613    4                   UWA.SN.SENAME = WORD1;

   5613  6 001422   040000 100400                    MLR     fill='040'O
         6 001423   000000 000036 0                  ADSC9   WORD1                    cn=0,n=30
         6 001424   000427 000036 4                  ADSC9   UWA+279                  cn=0,n=30

      487     5614    4                   UWA.SN.DCLR = 0;

   5614  6 001425   000422 450000 4                  STZ     UWA+274

      488     5615    4                   UWA.SN.ESCAPE = 0;

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:74   
   5615  6 001426   000423 450000 4                  STZ     UWA+275

      489     5616    4                   UWA.SN.SETYPE = %ZIG_RTYPE_RC;

   5616  6 001427   000050 235007                    LDA     40,DL
         6 001430   000424 755000 4                  STA     UWA+276

      490     5617    4                   UWA.SN.LNO = 0;

   5617  6 001431   000425 450000 4                  STZ     UWA+277

      491     5618    4                   CALL STRE_6('SN  ');

   5618  6 001432   000121 630400 7                  EPPR0   81
         6 001433   000000 631400 7                  EPPR1   0
         6 001434   000000 701000 xent               TSX1    STRE_6
         6 001435   000000 011000                    NOP     0

      492     5619    4                   UWA.DA.NUMB_SN = UWA.DA.NUMB_SN + 1;

   5619  6 001436   000406 054000 4                  AOS     UWA+262

      493     5620    4                   UWA.RC = '0'B;

   5620  6 001437   000000 100400                    MLR     fill='000'O
         6 001440   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 001441   000270 000100 4                  ADSC9   UWA+184                  cn=0,n=64

      494     5621    4                   UWA.RC.RTYPE = SAVE_PA_TYPE;

   5621  6 001442   000027 235000 0                  LDA     SAVE_PA_TYPE
         6 001443   000270 755000 4                  STA     UWA+184

      495     5622    4                   UWA.RC.PA_ENTRY = SAVE_PA_ENTRY;

   5622  6 001444   000030 236000 0                  LDQ     SAVE_PA_ENTRY
         6 001445   000304 756000 4                  STQ     UWA+196
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:75   

      496     5623    4                   UWA.RC.PSMODE = 5;

   5623  6 001446   000005 235007                    LDA     5,DL
         6 001447   000271 755000 4                  STA     UWA+185

      497     5624    4                   CALL STRE_6('RC  ');

   5624  6 001450   000005 630400 7                  EPPR0   5
         6 001451   000000 631400 7                  EPPR1   0
         6 001452   000000 701000 xent               TSX1    STRE_6
         6 001453   000000 011000                    NOP     0

      498     5625    4                   UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 1;

   5625  6 001454   000215 054000 4                  AOS     UWA+141

      499     5626    4                   CALL FETCHOS_6('SC-SOSM ');

   5626  6 001455   000133 630400 7                  EPPR0   91
         6 001456   000000 631400 7                  EPPR1   0
         6 001457   000000 701000 xent               TSX1    FETCHOS_6
         6 001460   000000 011000                    NOP     0

      500     5627    5                   DO WHILE ('1'B);

      501     5628    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET(ACTR581);

   5628  6 001461   000133 630400 7                  EPPR0   91
         6 001462   000000 631400 7                  EPPR1   0
         6 001463   000000 701000 xent               TSX1    FETCHNS_6
         6 001464   001521 702000 6                  TSX2    ACTR581

      502     5629    5                       IF UWA.RECORD_NAME = 'SM'

   5629  6 001465   040000 106400                    CMPC    fill='040'O
         6 001466   000023 000036 4                  ADSC9   UWA+19                   cn=0,n=30
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:76   
         6 001467   000023 000002 5                  ADSC9   19                       cn=0,n=2
         6 001470   001461 601000 6                  TNZ     s:5628

      503     5630    6                       THEN DO;

      504     5631    6                           IF PAREC_SMDBK = 0

   5631  6 001471   000026 235000 0                  LDA     PAREC_SMDBK
         6 001472   001475 601000 6                  TNZ     s:5633

      505     5632    6                           THEN PAREC_SMDBK = UWA.DIRECT_REF;

   5632  6 001473   000036 236000 4                  LDQ     UWA+30
         6 001474   000026 756000 0                  STQ     PAREC_SMDBK

      506     5633    6                           UWA.SM.MEMDUP = 0;

   5633  6 001475   000362 450000 4                  STZ     UWA+242

      507     5634    6                           UWA.SM.CALCDUP = 0;

   5634  6 001476   000364 450000 4                  STZ     UWA+244

      508     5635    6                           UWA.SM.PSMODE = 0;

   5635  6 001477   000366 450000 4                  STZ     UWA+246

      509     5636    6                           UWA.SM.PAMEM = 1;

   5636  6 001500   000001 235007                    LDA     1,DL
         6 001501   000365 755000 4                  STA     UWA+245

      510     5637    6                           CALL FCURR_R_6('RC  ');

   5637  6 001502   000005 630400 7                  EPPR0   5
         6 001503   000000 631400 7                  EPPR1   0
         6 001504   000000 701000 xent               TSX1    FCURR_R_6
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:77   
         6 001505   000000 011000                    NOP     0

      511     5638    6                           CALL STRE_6('SM  ');

   5638  6 001506   000134 630400 7                  EPPR0   92
         6 001507   000000 631400 7                  EPPR1   0
         6 001510   000000 701000 xent               TSX1    STRE_6
         6 001511   000000 011000                    NOP     0

      512     5639    6                           UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;

   5639  6 001512   000222 054000 4                  AOS     UWA+146

      513     5640    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;

   5640  6 001513   000305 054000 4                  AOS     UWA+197

      514     5641    6                           CALL CONNECT_6('RC-SOSM ');

   5641  6 001514   000135 630400 7                  EPPR0   93
         6 001515   000000 631400 7                  EPPR1   0
         6 001516   000000 701000 xent               TSX1    CONNECT_6
         6 001517   000000 011000                    NOP     0

      515     5642    6                           END;

      516     5643    5                       END;

   5643  6 001520   001461 710000 6                  TRA     s:5628

      517     5644    4   ACTR581:
      518     5645    4                   CALL FCURR_R_6('RC  ');

   5645  6 001521   000005 630400 7     ACTR581      EPPR0   5
         6 001522   000000 631400 7                  EPPR1   0
         6 001523   000000 701000 xent               TSX1    FCURR_R_6
         6 001524   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:78   

      519     5646    4                   CALL MODIFY_6('RC  ');

   5646  6 001525   000005 630400 7                  EPPR0   5
         6 001526   000000 631400 7                  EPPR1   0
         6 001527   000000 701000 xent               TSX1    MODIFY_6
         6 001530   000000 011000                    NOP     0

      520     5647    4                   CALL FETCHD_6('SM  ',PAREC_SMDBK);

   5647  6 001531   000136 630400 7                  EPPR0   94
         6 001532   000004 631400 7                  EPPR1   4
         6 001533   000000 701000 xent               TSX1    FETCHD_6
         6 001534   000000 011000                    NOP     0

      521     5648    5                   DO WHILE ('1'B);

      522     5649    6                       DO WHILE ('1'B);

      523     5650    6                           CALL FETCHNS_6('SMSS-CF ') ALTRET(ACTR584);

   5650  6 001535   000140 630400 7                  EPPR0   96
         6 001536   000000 631400 7                  EPPR1   0
         6 001537   000000 701000 xent               TSX1    FETCHNS_6
         6 001540   001570 702000 6                  TSX2    ACTR584

      524     5651    6                           PAREC_NUMB_SK = PAREC_NUMB_SK + 1;

   5651  6 001541   000025 235000 0                  LDA     PAREC_NUMB_SK
         6 001542   000001 035007                    ADLA    1,DL
         6 001543   000025 755000 0                  STA     PAREC_NUMB_SK

      525     5652    6                           CALL FETCHOS_6('FR-CFS  ');

   5652  6 001544   000141 630400 7                  EPPR0   97
         6 001545   000000 631400 7                  EPPR1   0
         6 001546   000000 701000 xent               TSX1    FETCHOS_6
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:79   
         6 001547   000000 011000                    NOP     0

      526     5653    6                           UWA.FR.SYN = 1;

   5653  6 001550   000001 235007                    LDA     1,DL
         6 001551   000332 755000 4                  STA     UWA+218

      527     5654    6                           UWA.FR.FR_FRH = UWA.DIRECT_REF;

   5654  6 001552   000036 236000 4                  LDQ     UWA+30
         6 001553   000352 756000 4                  STQ     UWA+234

      528     5655    6                           UWA.FR.F_USE = 6;

   5655  6 001554   000006 235007                    LDA     6,DL
         6 001555   000343 755000 4                  STA     UWA+227

      529     5656    6                           CALL FCURR_R_6('RC  ');

   5656  6 001556   000005 630400 7                  EPPR0   5
         6 001557   000000 631400 7                  EPPR1   0
         6 001560   000000 701000 xent               TSX1    FCURR_R_6
         6 001561   000000 011000                    NOP     0

      530     5657    6                           CALL STRE_6('FR  ');

   5657  6 001562   000142 630400 7                  EPPR0   98
         6 001563   000000 631400 7                  EPPR1   0
         6 001564   000000 701000 xent               TSX1    STRE_6
         6 001565   000000 011000                    NOP     0

      531     5658    6                           UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   5658  6 001566   000220 054000 4                  AOS     UWA+144

      532     5659    6                           END;

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:80   
   5659  6 001567   001535 710000 6                  TRA     s:5650

      533     5660    5   ACTR584:
      534     5661    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET(DBCS_ERR);

   5661  6 001570   000133 630400 7     ACTR584      EPPR0   91
         6 001571   000000 631400 7                  EPPR1   0
         6 001572   000000 701000 xent               TSX1    FETCHNS_6
         6 001573   002444 702000 6                  TSX2    DBCS_ERR

      535     5662        /*  Skip over the PA record. */
      536     5663    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET (ACTR585);

   5663  6 001574   000133 630400 7                  EPPR0   91
         6 001575   000000 631400 7                  EPPR1   0
         6 001576   000000 701000 xent               TSX1    FETCHNS_6
         6 001577   001602 702000 6                  TSX2    ACTR585

      537     5664    5                       PAREC_NUMB_SK = 0;

   5664  6 001600   000025 450000 0                  STZ     PAREC_NUMB_SK

      538     5665    5                       END;

   5665  6 001601   001535 710000 6                  TRA     s:5650

      539     5666    4   ACTR585:
      540     5667    4                   CALL FCURR_R_6('RC  ');

   5667  6 001602   000005 630400 7     ACTR585      EPPR0   5
         6 001603   000000 631400 7                  EPPR1   0
         6 001604   000000 701000 xent               TSX1    FCURR_R_6
         6 001605   000000 011000                    NOP     0

      541     5668    4                   CALL FETCHD_6('SM  ',PAREC_SMDBK);

   5668  6 001606   000136 630400 7                  EPPR0   94
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:81   
         6 001607   000004 631400 7                  EPPR1   4
         6 001610   000000 701000 xent               TSX1    FETCHD_6
         6 001611   000000 011000                    NOP     0

      542     5669    4                   PAREC_USER_PLACE = UWA.DIRECT_REF;

   5669  6 001612   000036 235000 4                  LDA     UWA+30
         6 001613   000023 755000 0                  STA     PAREC_USER_PLACE

      543     5670    5                   DO WHILE ('1'B);

      544     5671    5                       CALL FETCHNS_6('SC-SOSM ');

   5671  6 001614   000133 630400 7                  EPPR0   91
         6 001615   000000 631400 7                  EPPR1   0
         6 001616   000000 701000 xent               TSX1    FETCHNS_6
         6 001617   000000 011000                    NOP     0

      545     5672    5                       PAREC_PA_PLACE = UWA.DIRECT_REF;

   5672  6 001620   000036 235000 4                  LDA     UWA+30
         6 001621   000024 755000 0                  STA     PAREC_PA_PLACE

      546     5673    6                       DO I = 1 TO PAREC_NUMB_SK;

   5673  6 001622   000001 236007                    LDQ     1,DL
         6 001623   200005 756100                    STQ     I,,AUTO
         6 001624   001717 710000 6                  TRA     s:5691+3

      547     5674    6                           CALL FINDD_6('****',PAREC_USER_PLACE);

   5674  6 001625   000143 630400 7                  EPPR0   99
         6 001626   000004 631400 7                  EPPR1   4
         6 001627   000000 701000 xent               TSX1    FINDD_6
         6 001630   000000 011000                    NOP     0

      548     5675    6                           CALL FETCHNS_6('SMSS-CF ') ALTRET(DBCS_ERR);
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:82   

   5675  6 001631   000140 630400 7                  EPPR0   96
         6 001632   000000 631400 7                  EPPR1   0
         6 001633   000000 701000 xent               TSX1    FETCHNS_6
         6 001634   002444 702000 6                  TSX2    DBCS_ERR

      549     5676    7                           DO WHILE (UWA.C_F.CTRLTYPE ~= 0);

   5676  6 001635   000401 235000 4                  LDA     UWA+257
         6 001636   001645 600000 6                  TZE     s:5679

      550     5677    7                               CALL FETCHNS_6('SMSS-CF ') ALTRET(DBCS_ERR);

   5677  6 001637   000140 630400 7                  EPPR0   96
         6 001640   000000 631400 7                  EPPR1   0
         6 001641   000000 701000 xent               TSX1    FETCHNS_6
         6 001642   002444 702000 6                  TSX2    DBCS_ERR

      551     5678    7                               END;

   5678  6 001643   000401 235000 4                  LDA     UWA+257
         6 001644   001637 601000 6                  TNZ     s:5677

      552     5679    6                           PAREC_USER_PLACE = UWA.DIRECT_REF;

   5679  6 001645   000036 236000 4                  LDQ     UWA+30
         6 001646   000023 756000 0                  STQ     PAREC_USER_PLACE

      553     5680    6                           CALL FETCHNS_6('RC-FR   ') ALTRET (DBCS_ERR);

   5680  6 001647   000145 630400 7                  EPPR0   101
         6 001650   000000 631400 7                  EPPR1   0
         6 001651   000000 701000 xent               TSX1    FETCHNS_6
         6 001652   002444 702000 6                  TSX2    DBCS_ERR

      554     5681    6                           CALL FINDD_6('****',PAREC_PA_PLACE);

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:83   
   5681  6 001653   000146 630400 7                  EPPR0   102
         6 001654   000004 631400 7                  EPPR1   4
         6 001655   000000 701000 xent               TSX1    FINDD_6
         6 001656   000000 011000                    NOP     0

      555     5682    6                           UWA.C_F.SYN = 1;

   5682  6 001657   000001 235007                    LDA     1,DL
         6 001660   000400 755000 4                  STA     UWA+256

      556     5683    6                           UWA.C_F.CTRLTYPE = 6;

   5683  6 001661   000006 236007                    LDQ     6,DL
         6 001662   000401 756000 4                  STQ     UWA+257

      557     5684    6                           CALL STRE_6('C-F ');

   5684  6 001663   000150 630400 7                  EPPR0   104
         6 001664   000000 631400 7                  EPPR1   0
         6 001665   000000 701000 xent               TSX1    STRE_6
         6 001666   000000 011000                    NOP     0

      558     5685    6                           UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   5685  6 001667   000224 054000 4                  AOS     UWA+148

      559     5686    6                           CALL CONNECT_6('SMSS-CF ');

   5686  6 001670   000140 630400 7                  EPPR0   96
         6 001671   000000 631400 7                  EPPR1   0
         6 001672   000000 701000 xent               TSX1    CONNECT_6
         6 001673   000000 011000                    NOP     0

      560     5687    6                           CALL FINDD_6('FR  ',UWA.FR.FR_FRH);

   5687  6 001674   000151 630400 7                  EPPR0   105
         6 001675   000004 631400 7                  EPPR1   4
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:84   
         6 001676   000000 701000 xent               TSX1    FINDD_6
         6 001677   000000 011000                    NOP     0

      561     5688    6                           CALL FCURR_R_6('C-F ');

   5688  6 001700   000150 630400 7                  EPPR0   104
         6 001701   000000 631400 7                  EPPR1   0
         6 001702   000000 701000 xent               TSX1    FCURR_R_6
         6 001703   000000 011000                    NOP     0

      562     5689    6                           CALL CONNECT_6('FR-CFR  ');

   5689  6 001704   000153 630400 7                  EPPR0   107
         6 001705   000000 631400 7                  EPPR1   0
         6 001706   000000 701000 xent               TSX1    CONNECT_6
         6 001707   000000 011000                    NOP     0

      563     5690    6                           CALL FINDOS_6('FR-CFS  ');

   5690  6 001710   000141 630400 7                  EPPR0   97
         6 001711   000000 631400 7                  EPPR1   0
         6 001712   000000 701000 xent               TSX1    FINDOS_6
         6 001713   000000 011000                    NOP     0

      564     5691    6                           END;

   5691  6 001714   200005 235100                    LDA     I,,AUTO
         6 001715   000001 035007                    ADLA    1,DL
         6 001716   200005 755100                    STA     I,,AUTO
         6 001717   000025 236000 0                  LDQ     PAREC_NUMB_SK
         6 001720   200005 116100                    CMPQ    I,,AUTO
         6 001721   001625 603000 6                  TRC     s:5674

      565     5692    5                       CALL FETCHNS_6('SC-SOSM ') ALTRET (ACTR588);

   5692  6 001722   000133 630400 7                  EPPR0   91
         6 001723   000000 631400 7                  EPPR1   0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:85   
         6 001724   000000 701000 xent               TSX1    FETCHNS_6
         6 001725   001731 702000 6                  TSX2    ACTR588

      566     5693    5                       PAREC_USER_PLACE = UWA.DIRECT_REF;

   5693  6 001726   000036 235000 4                  LDA     UWA+30
         6 001727   000023 755000 0                  STA     PAREC_USER_PLACE

      567     5694    5                       END;

   5694  6 001730   001614 710000 6                  TRA     s:5671

      568     5695    4   ACTR588:
      569     5696    4                   CALL MODT('SC  ');

   5696  6 001731   000007 236000 7     ACTR588      LDQ     7
         6 001732   200011 756100                    STQ     I+1,,AUTO
         6 001733   000070 701000 6                  TSX1    MODT
         6 001734   000000 011000                    NOP     0

      570     5697    4                   END;

   5697  6 001735   002443 710000 6                  TRA     s:5892

      571     5698    3           CASE(41); /* Set entry */

      572     5699    3               SAVE_PA_TYPE = 0;

   5699  6 001736   000027 450000 0                  STZ     SAVE_PA_TYPE

      573     5700    3               SAVE_PA_ENTRY = 0;

   5700  6 001737   000030 450000 0                  STZ     SAVE_PA_ENTRY

      574     5701    3               PAREC_USER_PLACE = 0;

   5701  6 001740   000023 450000 0                  STZ     PAREC_USER_PLACE
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:86   

      575     5702    3               PAREC_PA_PLACE = 0;

   5702  6 001741   000024 450000 0                  STZ     PAREC_PA_PLACE

      576     5703    3               PAREC_NUMB_SK = 0;

   5703  6 001742   000025 450000 0                  STZ     PAREC_NUMB_SK

      577     5704    3               PAREC_SMDBK = 0;

   5704  6 001743   000026 450000 0                  STZ     PAREC_SMDBK

      578     5705    3               CALL GET_WORD;

   5705  6 001744   000103 701000 6                  TSX1    GET_WORD
         6 001745   000000 011000                    NOP     0

      579     5706    3               CALL SRCHD(WORD1,%ZIG_RTYPE_SC,SUCC);

   5706  6 001746   000154 630400 7                  EPPR0   108
         6 001747   000020 631400 7                  EPPR1   16
         6 001750   000000 701000 xent               TSX1    SRCHD
         6 001751   000000 011000                    NOP     0

      580     5707    3               IF ~SUCC

   5707  6 001752   000010 236000 0                  LDQ     SUCC
         6 001753   400000 376003                    ANQ     -131072,DU
         6 001754   400000 676003                    ERQ     -131072,DU
         6 001755   001763 600000 6                  TZE     s:5717

      581     5708    4               THEN DO;

      582     5709    4                   CALL ERROR(2041);

   5709  6 001756   000160 630400 7                  EPPR0   112
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:87   
         6 001757   000000 631400 7                  EPPR1   0
         6 001760   000000 701000 xent               TSX1    ERROR
         6 001761   000000 011000                    NOP     0

      583     5710        /*E*     ERROR:    ZIG-2041-C
      584     5711        MESSAGE: The set name "%U1" is not defined in the schema.
      585     5712                 No new set name can be given in the DMCL. All sets
      586     5713                 must be declares in the DDL.
      587     5714        */
      588     5715    4                   END;

   5715  6 001762   002443 710000 6                  TRA     s:5892

      589     5716    4               ELSE DO;

      590     5717    4                   CALL PROCCESS_NAME;

   5717  6 001763   000003 701000 6                  TSX1    PROCCESS_NAME
         6 001764   000000 011000                    NOP     0

      591     5718    4                   END;

   5718  6 001765   002443 710000 6                  TRA     s:5892

      592     5719    3           CASE(43); /* Processing pointer clause */

      593     5720    3               UWA.SC.USER_PTS=1;

   5720  6 001766   000001 235007                    LDA     1,DL
         6 001767   000322 755000 4                  STA     UWA+210

      594     5721    3               CALL MODT('SC  ');

   5721  6 001770   000007 236000 7                  LDQ     7
         6 001771   200011 756100                    STQ     I+1,,AUTO
         6 001772   000070 701000 6                  TSX1    MODT
         6 001773   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:88   
         6 001774   002443 710000 6                  TRA     s:5892

      595     5722    3           CASE(51); /* Key name */

      596     5723    3               CALL GET_WORD;

   5723  6 001775   000103 701000 6                  TSX1    GET_WORD
         6 001776   000000 011000                    NOP     0

      597     5724    3               CALL SRCHD(WORD1,%ZIG_RTYPE_KC,SUCC);

   5724  6 001777   000162 630400 7                  EPPR0   114
         6 002000   000020 631400 7                  EPPR1   16
         6 002001   000000 701000 xent               TSX1    SRCHD
         6 002002   000000 011000                    NOP     0

      598     5725    3               IF ~SUCC

   5725  6 002003   000010 236000 0                  LDQ     SUCC
         6 002004   400000 376003                    ANQ     -131072,DU
         6 002005   400000 676003                    ERQ     -131072,DU
         6 002006   002014 600000 6                  TZE     s:5734

      599     5726    4               THEN DO;

      600     5727    4                   CALL ERROR(2051);

   5727  6 002007   000166 630400 7                  EPPR0   118
         6 002010   000000 631400 7                  EPPR1   0
         6 002011   000000 701000 xent               TSX1    ERROR
         6 002012   000000 011000                    NOP     0

      601     5728    4                   RETURN;

   5728  6 002013   000000 702200 xent               TSX2  ! X66_ARET

      602     5729        /*E*     ERROR:    ZIG-2051-C
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:89   
      603     5730        MESSAGE: The key "%U1" is not defined in the schema.
      604     5731        */
      605     5732    4                   END;
      606     5733    4               ELSE DO;

      607     5734    4                   CALL FETCHNS_6('SN-SE   ') ALTRET(FAIL2);

   5734  6 002014   000001 630400 7                  EPPR0   1
         6 002015   000000 631400 7                  EPPR1   0
         6 002016   000000 701000 xent               TSX1    FETCHNS_6
         6 002017   002021 702000 6                  TSX2    FAIL2

      608     5735    4                   RETURN;

   5735  6 002020   000000 702200 xent               TSX2  ! X66_ARET

      609     5736        /*E*     ERROR:    ZIG-2151-C
      610     5737        MESSAGE: The key "%U1" does not belong to any set.
      611     5738        */
      612     5739    4                   END;
      613     5740    3   FAIL2:      CALL ERROR(2151);

   5740  6 002021   000170 630400 7     FAIL2        EPPR0   120
         6 002022   000000 631400 7                  EPPR1   0
         6 002023   000000 701000 xent               TSX1    ERROR
         6 002024   000000 011000                    NOP     0
         6 002025   002443 710000 6                  TRA     s:5892

      614     5741    3           CASE(52); /* Record type */

      615     5742    3               CALL GET_NUM(0,2049);

   5742  6 002026   000172 236000 7                  LDQ     122
         6 002027   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 002030   000173 236000 7                  LDQ     123
         6 002031   200007 756100                    STQ     I+2,,AUTO
         6 002032   000125 701000 6                  TSX1    GET_NUM
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:90   
         6 002033   000000 011000                    NOP     0

      616     5743    3               UWA.SC.INDEX_ID=NUM;

   5743  6 002034   000015 235000 0                  LDA     NUM
         6 002035   000323 755000 4                  STA     UWA+211

      617     5744    3               CALL MODT('SC  ');

   5744  6 002036   000007 236000 7                  LDQ     7
         6 002037   200011 756100                    STQ     I+1,,AUTO
         6 002040   000070 701000 6                  TSX1    MODT
         6 002041   000000 011000                    NOP     0
         6 002042   002443 710000 6                  TRA     s:5892

      618     5745        /*E*     ERROR:    ZIG-2052-C
      619     5746        MESSAGE: The key range must be in the range of 1 to 2049, not %U1.
      620     5747        */
      621     5748    3           CASE (85); /* Set is chain */

      622     5749    3               UWA.SC.SETMODE = 0;

   5749  6 002043   000311 450000 4                  STZ     UWA+201

      623     5750    3               CALL MODT('SC  ');

   5750  6 002044   000007 236000 7                  LDQ     7
         6 002045   200011 756100                    STQ     I+1,,AUTO
         6 002046   000070 701000 6                  TSX1    MODT
         6 002047   000000 011000                    NOP     0
         6 002050   002443 710000 6                  TRA     s:5892

      624     5751    3           CASE (86); /* Pointer array */

      625     5752    3               UWA.SC.SETMODE = 2;

   5752  6 002051   000002 235007                    LDA     2,DL
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:91   
         6 002052   000311 755000 4                  STA     UWA+201

      626     5753    3               CALL MODT('SC  ');

   5753  6 002053   000007 236000 7                  LDQ     7
         6 002054   200011 756100                    STQ     I+1,,AUTO
         6 002055   000070 701000 6                  TSX1    MODT
         6 002056   000000 011000                    NOP     0

      627     5754    3               IF UWA.SC.SETORD ~= 4

   5754  6 002057   000312 235000 4                  LDA     UWA+202
         6 002060   000004 115007                    CMPA    4,DL
         6 002061   002443 600000 6                  TZE     s:5892

      628     5755    4               THEN DO;

      629     5756    4                   CALL SET_FIELDS(2,30,UWA.SN.SENAME);

   5756  6 002062   000174 630400 7                  EPPR0   124
         6 002063   000020 631400 7                  EPPR1   16
         6 002064   000000 701000 xent               TSX1    SET_FIELDS
         6 002065   000000 011000                    NOP     0

      630     5757    4                   CALL ERROR(2086);

   5757  6 002066   000200 630400 7                  EPPR0   128
         6 002067   000000 631400 7                  EPPR1   0
         6 002070   000000 701000 xent               TSX1    ERROR
         6 002071   000000 011000                    NOP     0

      631     5758        /*E*     ERROR:    ZIG-2086-C
      632     5759        MESSAGE: The SET named "%U2" has been declared as a POINTER ARRAY
      633     5760                 and only sets that are sorted by keys can have the type
      634     5761                 of a POINTER ARRAY.
      635     5762        */
      636     5763    4                   UWA.SC.SETMODE = 0;
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:92   

   5763  6 002072   000311 450000 4                  STZ     UWA+201

      637     5764    4                   RETURN;

   5764  6 002073   000000 702200 xent               TSX2  ! X66_ARET

      638     5765    4                   END;
      639     5766    3           CASE (87); /* PA type */

      640     5767    3               CALL GET_NUM(1,3999);

   5767  6 002074   000120 236000 7                  LDQ     80
         6 002075   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 002076   000040 236000 7                  LDQ     32
         6 002077   200007 756100                    STQ     I+2,,AUTO
         6 002100   000125 701000 6                  TSX1    GET_NUM
         6 002101   000000 011000                    NOP     0

      641     5768    3               SAVE_PA_TYPE = NUM;

   5768  6 002102   000015 235000 0                  LDA     NUM
         6 002103   000027 755000 0                  STA     SAVE_PA_TYPE
         6 002104   002443 710000 6                  TRA     s:5892

      642     5769        /*E*     ERROR:    ZIG-2087-C
      643     5770        MESSAGE: The PA_TYPE must be in the range 1 to 3999, not %U1.
      644     5771        */
      645     5772    3           CASE (88); /* Num of entries */

      646     5773    3               CALL GET_NUM(3,2999);

   5773  6 002105   000203 236000 7                  LDQ     131
         6 002106   200010 756100                    STQ     @NUM_2+1,,AUTO
         6 002107   000204 236000 7                  LDQ     132
         6 002110   200007 756100                    STQ     I+2,,AUTO
         6 002111   000125 701000 6                  TSX1    GET_NUM
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:93   
         6 002112   000000 011000                    NOP     0

      647     5774    3               SAVE_PA_ENTRY = NUM;

   5774  6 002113   000015 235000 0                  LDA     NUM
         6 002114   000030 755000 0                  STA     SAVE_PA_ENTRY
         6 002115   002443 710000 6                  TRA     s:5892

      648     5775        /*E*     ERROR:    ZIG-2088-C
      649     5776        MESSAGE: The number of POINTER ARRAY entries per block must be in the
      650     5777                 range of 3 to 2999, not %U1.
      651     5778        */
      652     5779    3           CASE (89); /* End of dmcl */

      653     5780    3               END_DMCL='1'B;

   5780  6 002116   400000 236003                    LDQ     -131072,DU
         6 002117   000000 756000 2                  STQ     END_DMCL
         6 002120   002443 710000 6                  TRA     s:5892

      654     5781
      655     5782
      656     5783
      657     5784
      658     5785        /* Data base procedure code next */
      659     5786    3           CASE(60); /* Data base procedures */

      660     5787    3               CALL ERROR(2060);

   5787  6 002121   000206 630400 7                  EPPR0   134
         6 002122   000000 631400 7                  EPPR1   0
         6 002123   000000 701000 xent               TSX1    ERROR
         6 002124   000000 011000                    NOP     0

      661     5788        /*E*     ERROR:    ZIG-2060-C
      662     5789        MESSAGE: Data base procedures cannot be used yet!
      663     5790                 They will be in a later release.
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:94   
      664     5791        */
      665     5792    3               END;

   5792  6 002125   002443 710000 6                  TRA     s:5892

      666     5793    2       CASE(%FAIL#);

      667     5794    2           J=PARAN.CHARPOS;

   5794  6 002126   000004 235100                    LDA     4,,PR0
         6 002127   200004 755100                    STA     J,,AUTO

      668     5795    3           DO WHILE (SUBSTR(LINE,J,1)=' ');

   5795  6 002130   002134 710000 6                  TRA     s:5797

      669     5796    3               J=J+1;

   5796  6 002131   200004 235100                    LDA     J,,AUTO
         6 002132   000001 035007                    ADLA    1,DL
         6 002133   200004 755100                    STA     J,,AUTO

      670     5797    3               END;

   5797  6 002134   040000 106405                    CMPC    fill='040'O
         6 002135   000000 000001 3                  ADSC9   LINE,A                   cn=0,n=1
         6 002136   000207 000001 7                  ADSC9   135                      cn=0,n=1
         6 002137   002131 600000 6                  TZE     s:5796

      671     5798    3           DO WHILE (SUBSTR(LINE,J,1)~=' ');

   5798  6 002140   002144 710000 6                  TRA     s:5800

      672     5799    3               J=J+1;

   5799  6 002141   200004 235100                    LDA     J,,AUTO
         6 002142   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:95   
         6 002143   200004 755100                    STA     J,,AUTO

      673     5800    3               END;

   5800  6 002144   040000 106405                    CMPC    fill='040'O
         6 002145   000000 000001 3                  ADSC9   LINE,A                   cn=0,n=1
         6 002146   000207 000001 7                  ADSC9   135                      cn=0,n=1
         6 002147   002141 601000 6                  TNZ     s:5799

      674     5801    2           FIELD1.COUNT1=J-PARAN.CHARPOS;

   5801  6 002150   200003 470500                    LDP0    @PARAN,,AUTO
         6 002151   200004 236100                    LDQ     J,,AUTO
         6 002152   000004 136100                    SBLQ    4,,PR0
         6 002153   000033 736000                    QLS     27
         6 002154   000000 552040 1                  STBQ    FIELD1,'40'O

      675     5802    2           FIELD1.TEXT1=SUBSTR(LINE,PARAN.CHARPOS,FIELD1.COUNT1);

   5802  6 002155   000004 235100                    LDA     4,,PR0
         6 002156   000000 236000 1                  LDQ     FIELD1
         6 002157   000033 772000                    QRL     27
         6 002160   000000 620006                    EAX0    0,QL
         6 002161   040000 100445                    MLR     fill='040'O
         6 002162   000000 000010 3                  ADSC9   LINE,A                   cn=0,n=*X0
         6 002163   000000 200037 1                  ADSC9   FIELD1                   cn=1,n=31

      676     5803    3           DO CASE(PARAN.CODE);

   5803  6 002164   000000 720100                    LXL0    0,,PR0
         6 002165   000131 100003                    CMPX0   89,DU
         6 002166   002170 602010 6                  TNC     s:5803+4,X0
         6 002167   002435 710000 6                  TRA     s:5890
         6 002170   002435 710000 6                  TRA     s:5890
         6 002171   002321 710000 6                  TRA     s:5805
         6 002172   002326 710000 6                  TRA     s:5811
         6 002173   002435 710000 6                  TRA     s:5890
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:96   
         6 002174   002435 710000 6                  TRA     s:5890
         6 002175   002435 710000 6                  TRA     s:5890
         6 002176   002333 710000 6                  TRA     s:5817
         6 002177   002333 710000 6                  TRA     s:5817
         6 002200   002333 710000 6                  TRA     s:5817
         6 002201   002333 710000 6                  TRA     s:5817
         6 002202   002333 710000 6                  TRA     s:5817
         6 002203   002333 710000 6                  TRA     s:5817
         6 002204   002333 710000 6                  TRA     s:5817
         6 002205   002435 710000 6                  TRA     s:5890
         6 002206   002435 710000 6                  TRA     s:5890
         6 002207   002435 710000 6                  TRA     s:5890
         6 002210   002344 710000 6                  TRA     s:5824
         6 002211   002435 710000 6                  TRA     s:5890
         6 002212   002435 710000 6                  TRA     s:5890
         6 002213   002435 710000 6                  TRA     s:5890
         6 002214   002435 710000 6                  TRA     s:5890
         6 002215   002435 710000 6                  TRA     s:5890
         6 002216   002355 710000 6                  TRA     s:5831
         6 002217   002435 710000 6                  TRA     s:5890
         6 002220   002435 710000 6                  TRA     s:5890
         6 002221   002435 710000 6                  TRA     s:5890
         6 002222   002435 710000 6                  TRA     s:5890
         6 002223   002435 710000 6                  TRA     s:5890
         6 002224   002435 710000 6                  TRA     s:5890
         6 002225   002435 710000 6                  TRA     s:5890
         6 002226   002366 710000 6                  TRA     s:5838
         6 002227   002435 710000 6                  TRA     s:5890
         6 002230   002435 710000 6                  TRA     s:5890
         6 002231   002435 710000 6                  TRA     s:5890
         6 002232   002373 710000 6                  TRA     s:5844
         6 002233   002373 710000 6                  TRA     s:5844
         6 002234   002435 710000 6                  TRA     s:5890
         6 002235   002373 710000 6                  TRA     s:5844
         6 002236   002435 710000 6                  TRA     s:5890
         6 002237   002435 710000 6                  TRA     s:5890
         6 002240   002400 710000 6                  TRA     s:5850
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:97   
         6 002241   002435 710000 6                  TRA     s:5890
         6 002242   002405 710000 6                  TRA     s:5857
         6 002243   002412 710000 6                  TRA     s:5863
         6 002244   002435 710000 6                  TRA     s:5890
         6 002245   002435 710000 6                  TRA     s:5890
         6 002246   002435 710000 6                  TRA     s:5890
         6 002247   002435 710000 6                  TRA     s:5890
         6 002250   002435 710000 6                  TRA     s:5890
         6 002251   002435 710000 6                  TRA     s:5890
         6 002252   002417 710000 6                  TRA     s:5869
         6 002253   002435 710000 6                  TRA     s:5890
         6 002254   002424 710000 6                  TRA     s:5875
         6 002255   002435 710000 6                  TRA     s:5890
         6 002256   002435 710000 6                  TRA     s:5890
         6 002257   002435 710000 6                  TRA     s:5890
         6 002260   002435 710000 6                  TRA     s:5890
         6 002261   002435 710000 6                  TRA     s:5890
         6 002262   002435 710000 6                  TRA     s:5890
         6 002263   002435 710000 6                  TRA     s:5890
         6 002264   002435 710000 6                  TRA     s:5890
         6 002265   002435 710000 6                  TRA     s:5890
         6 002266   002435 710000 6                  TRA     s:5890
         6 002267   002435 710000 6                  TRA     s:5890
         6 002270   002435 710000 6                  TRA     s:5890
         6 002271   002435 710000 6                  TRA     s:5890
         6 002272   002435 710000 6                  TRA     s:5890
         6 002273   002435 710000 6                  TRA     s:5890
         6 002274   002435 710000 6                  TRA     s:5890
         6 002275   002435 710000 6                  TRA     s:5890
         6 002276   002435 710000 6                  TRA     s:5890
         6 002277   002435 710000 6                  TRA     s:5890
         6 002300   002435 710000 6                  TRA     s:5890
         6 002301   002435 710000 6                  TRA     s:5890
         6 002302   002435 710000 6                  TRA     s:5890
         6 002303   002435 710000 6                  TRA     s:5890
         6 002304   002435 710000 6                  TRA     s:5890
         6 002305   002435 710000 6                  TRA     s:5890
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:98   
         6 002306   002435 710000 6                  TRA     s:5890
         6 002307   002435 710000 6                  TRA     s:5890
         6 002310   002435 710000 6                  TRA     s:5890
         6 002311   002435 710000 6                  TRA     s:5890
         6 002312   002435 710000 6                  TRA     s:5890
         6 002313   002435 710000 6                  TRA     s:5890
         6 002314   002435 710000 6                  TRA     s:5890
         6 002315   002435 710000 6                  TRA     s:5890
         6 002316   002431 710000 6                  TRA     s:5881
         6 002317   002333 710000 6                  TRA     s:5817
         6 002320   002333 710000 6                  TRA     s:5817

      677     5804    3           CASE(1); /* Other entry fail */

      678     5805    3               CALL ERROR(2501);

   5805  6 002321   000211 630400 7                  EPPR0   137
         6 002322   000000 631400 7                  EPPR1   0
         6 002323   000000 701000 xent               TSX1    ERROR
         6 002324   000000 011000                    NOP     0
         6 002325   002435 710000 6                  TRA     s:5890

      679     5806        /*E*     ERROR:    ZIG-2501-C
      680     5807        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal start for an
      681     5808                 ENTRY clause in the DMCL.
      682     5809        */
      683     5810    3           CASE(2); /* Schema entry */

      684     5811    3               CALL ERROR(2502);

   5811  6 002326   000213 630400 7                  EPPR0   139
         6 002327   000000 631400 7                  EPPR1   0
         6 002330   000000 701000 xent               TSX1    ERROR
         6 002331   000000 011000                    NOP     0
         6 002332   002435 710000 6                  TRA     s:5890

      685     5812        /*E*     ERROR:    ZIG-2502-C
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:99   
      686     5813        MESSAGE: SYNTAX ERROR: The DMCL must start with a SCHEMA entry.
      687     5814                 THE FORMAT IS: SCHEMA [NAME] [IS] schema_name .
      688     5815        */
      689     5816    3           CASE (6,7,8,9,10,11,12,87,88); /* Integers in area entry */

      690     5817    3               CALL ERROR(2506);

   5817  6 002333   000215 630400 7                  EPPR0   141
         6 002334   000000 631400 7                  EPPR1   0
         6 002335   000000 701000 xent               TSX1    ERROR
         6 002336   000000 011000                    NOP     0

      691     5818        /*E*     ERROR:    ZIG-2506-C
      692     5819        MESSAGE: SYNTAX ERROR: %U1 is not an integer and at this point
      693     5820                 an integer must be present.
      694     5821        */
      695     5822    3               CALL MODT('AC  ');

   5822  6 002337   000003 236000 7                  LDQ     3
         6 002340   200011 756100                    STQ     I+1,,AUTO
         6 002341   000070 701000 6                  TSX1    MODT
         6 002342   000000 011000                    NOP     0
         6 002343   002435 710000 6                  TRA     s:5890

      696     5823    3           CASE (16) ; /* Organization clause */

      697     5824    3               CALL ERROR(2516);

   5824  6 002344   000217 630400 7                  EPPR0   143
         6 002345   000000 631400 7                  EPPR1   0
         6 002346   000000 701000 xent               TSX1    ERROR
         6 002347   000000 011000                    NOP     0

      698     5825        /*E*     ERROR:    ZIG-2516-C
      699     5826        MESSAGE: SYNTAX ERROR: After the keyword ORGANIZATION the keyword
      700     5827                 INTEGRATED or INDEXED must be given, not %U1.
      701     5828        */
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:100  
      702     5829    3               CALL MODT('AC  ');

   5829  6 002350   000003 236000 7                  LDQ     3
         6 002351   200011 756100                    STQ     I+1,,AUTO
         6 002352   000070 701000 6                  TSX1    MODT
         6 002353   000000 011000                    NOP     0
         6 002354   002435 710000 6                  TRA     s:5890

      703     5830    3           CASE(22); /* Area not ended right */

      704     5831    3               CALL ERROR(2522);

   5831  6 002355   000221 630400 7                  EPPR0   145
         6 002356   000000 631400 7                  EPPR1   0
         6 002357   000000 701000 xent               TSX1    ERROR
         6 002360   000000 011000                    NOP     0

      705     5832        /*E*     ERROR:    ZIG-2522-C
      706     5833        MESSAGE: The word %U1 is not a legal option on the AREA_ENTRY
      707     5834                 clause.
      708     5835        */
      709     5836    3               CALL MODT('AC  ');

   5836  6 002361   000003 236000 7                  LDQ     3
         6 002362   200011 756100                    STQ     I+1,,AUTO
         6 002363   000070 701000 6                  TSX1    MODT
         6 002364   000000 011000                    NOP     0
         6 002365   002435 710000 6                  TRA     s:5890

      710     5837    3           CASE(30); /* Bad option on record entry */

      711     5838    3               CALL ERROR(2530);

   5838  6 002366   000223 630400 7                  EPPR0   147
         6 002367   000000 631400 7                  EPPR1   0
         6 002370   000000 701000 xent               TSX1    ERROR
         6 002371   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:101  
         6 002372   002435 710000 6                  TRA     s:5890

      712     5839        /*E*     ERROR:    ZIG-2530-C
      713     5840        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal option in the
      714     5841                 RECORD_ENTRY and all entries must end with a period.
      715     5842        */
      716     5843    3           CASE(34,35,37); /* Integers in record entry */

      717     5844    3               CALL ERROR(2534);

   5844  6 002373   000225 630400 7                  EPPR0   149
         6 002374   000000 631400 7                  EPPR1   0
         6 002375   000000 701000 xent               TSX1    ERROR
         6 002376   000000 011000                    NOP     0
         6 002377   002435 710000 6                  TRA     s:5890

      718     5845        /*E*     ERROR:    ZIG-2534-C
      719     5846        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal integer
      720     5847                 required for this option in the RECORD entry.
      721     5848        */
      722     5849    3           CASE(40); /* End of set entry */

      723     5850    3               CALL ERROR(2540);

   5850  6 002400   000227 630400 7                  EPPR0   151
         6 002401   000000 631400 7                  EPPR1   0
         6 002402   000000 701000 xent               TSX1    ERROR
         6 002403   000000 011000                    NOP     0
         6 002404   002435 710000 6                  TRA     s:5890

      724     5851        /*E*     ERROR:    ZIG-2540-C
      725     5852        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal option
      726     5853                  in the SET_ENTRY clause and all entries must end with
      727     5854                 a period.
      728     5855        */
      729     5856    3           CASE(42); /* Mode clause */

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:102  
      730     5857    3               CALL ERROR(2542);

   5857  6 002405   000231 630400 7                  EPPR0   153
         6 002406   000000 631400 7                  EPPR1   0
         6 002407   000000 701000 xent               TSX1    ERROR
         6 002410   000000 011000                    NOP     0
         6 002411   002435 710000 6                  TRA     s:5890

      731     5858        /*E*     ERROR:    ZIG-2542-C
      732     5859        MESSAGE: SYNTAX ERROR: After the MODE clause the keyword
      733     5860                 CHAIN must be specified, not %U1.
      734     5861        */
      735     5862    3           CASE(43); /* Pointer clause */;

      736     5863    3               CALL ERROR(2543);

   5863  6 002412   000233 630400 7                  EPPR0   155
         6 002413   000000 631400 7                  EPPR1   0
         6 002414   000000 701000 xent               TSX1    ERROR
         6 002415   000000 011000                    NOP     0
         6 002416   002435 710000 6                  TRA     s:5890

      737     5864        /*E*     ERROR:    ZIG-2543-C
      738     5865        MESSAGE: SYNTAX ERROR: After the keyword POINTER the keyword
      739     5866                 LOCAL must be specified, not %U1.
      740     5867        */
      741     5868    3           CASE(50); /* Key end */

      742     5869    3               CALL ERROR(2550);

   5869  6 002417   000235 630400 7                  EPPR0   157
         6 002420   000000 631400 7                  EPPR1   0
         6 002421   000000 701000 xent               TSX1    ERROR
         6 002422   000000 011000                    NOP     0
         6 002423   002435 710000 6                  TRA     s:5890

      743     5870        /*E*     ERROR:    ZIG-2550-C
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:103  
      744     5871        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal option
      745     5872                 in the KEY_ENTRY and all entries must end with a period.
      746     5873        */
      747     5874    3           CASE(52); /* Key option */

      748     5875    3               CALL ERROR(2552);

   5875  6 002424   000237 630400 7                  EPPR0   159
         6 002425   000000 631400 7                  EPPR1   0
         6 002426   000000 701000 xent               TSX1    ERROR
         6 002427   000000 011000                    NOP     0
         6 002430   002435 710000 6                  TRA     s:5890

      749     5876        /*E*     ERROR:    ZIG-2552-C
      750     5877        MESSAGE: SYNTAX ERROR: The word %U1 is not an integer and
      751     5878                 after the TYPE clause an integer must be present.
      752     5879        */
      753     5880    3           CASE(86); /*   PA option on sets */

      754     5881    3               CALL ERROR(2586);

   5881  6 002431   000241 630400 7                  EPPR0   161
         6 002432   000000 631400 7                  EPPR1   0
         6 002433   000000 701000 xent               TSX1    ERROR
         6 002434   000000 011000                    NOP     0

      755     5882        /*E*     ERROR:    ZIG-2586-C
      756     5883        MESSAGE: SYNTAX ERROR: The word %U1 is not a legal mode for
      757     5884                 the set entry. The syntax is:
      758     5885                 SET [NAME] [IS] set_name [ POINTERS [ARE] LOCAL ]
      759     5886                      [ MODE [IS] ( CHAIN | (POINTER ARRAY | PA )
      760     5887                      PA_TYPE [IS] number [ ALLOW [FOR] number [ENTRIES] ) ]
      761     5888        */
      762     5889    3               END;

      763     5890    2           UNWIND TO SYNTAX_ERR;

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:104  
   5890  6 002435   000100 100600                    MLR   ! fill='000'O
         6 002436   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
         6 002437   200014 000010                    ADSC9   COUNT+3,,AUTO            cn=0,n=8
         6 002440   200014 237300                    LDAQ  ! COUNT+3,,AUTO
         6 002441   000000 700200 xent               TSX0  ! X66_AUNWIND
         6 002442   000000 000200                    ZERO    0,128

      764     5891    2           END;

      765     5892    1       RETURN;

   5892  6 002443   000000 702200 xent               TSX2  ! X66_ARET

      766     5893    1   DBCS_ERR:
      767     5894    1       CALL ABORT;

   5894  6 002444   000015 631400 7     DBCS_ERR     EPPR1   13
         6 002445   000000 701000 xent               TSX1    ABORT
         6 002446   000000 011000                    NOP     0

      768     5895    1   END ZIG$M_PSET;

   5895  6 002447   000000 702200 xent               TSX2  ! X66_ARET

WORD1
 Sect OctLoc
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

MAXN
 Sect OctLoc
   0     020   777777 777776                                                    ....

FIELD1
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:105  
 Sect OctLoc
   4     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
   4     004   040040 040040   040040 040040   040040 040040   040040 040040
   4     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
   4     014   040040 040040   040040 040040   040040 040040   040040 040040
   4     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
   4     024   040040 040040   040040 040040   040040 040040   040040 040040
   4     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
   4     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
   4     040   040040 040040   040040 040040   040040 040040   040040 040040
   4     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
   4     050   040040 040040   040040 040040   040040 040040   040040 040040
   4     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
   4     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
   4     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
   4     070   040040 040040   040040 040040   040040 040040   040040 040040
   4     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
   4     104   040040 040040   040040 040040   040040 040040   040040 040040
   4     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
   4     130   040040 040040   040040 040040   040040 040040   040040 040040
   4     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
   4     140   040040 040040   040040 040040   040040 040040   040040 040040
   4     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
   4     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     154   040040 040040   040040 040040   040040 040040   040040 040040
   4     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
   4     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
   4     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
   4     174   040040 040040   040040 040040   040040 040040   040040 040040
   4     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   4     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
   4     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
   4     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   4     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:106  
   4     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   4     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
   4     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
   4     430   040040 040040   040040 040040   040040 040040   040040 040040
   4     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
   4     440   040040 040040   040040 040040   040040 040040   040040 040040
   4     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
   4     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
   4     460   040040 040040   040040 040040   040040 040040   040040 040040
   4     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
   4     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
   4     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
   4     504   040040 040040   040040 040040   040040 040040   040040 040040
   4     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
   4     524   040040 040040   040040 040040   040040 040040   040040 040040
   4     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
   4     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
   4     614   040040 040040   040040 040040   040040 040040   040040 040040
   4     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
   4     624   040040 040040   040040 040040   040040 040040   040040 040040
   4     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   4     664   040040 040040   040040 040040   040040 040040   040040 040040
   4     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   4     700   040040 040040   040040 040040   040040 040040   040040 040040
   4     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   4     714   040040 040040   040040 040040   040040 040040   040040 040040
   4     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
   4     724   040040 040040   040040 040040   040040 040040   040040 040040
   4     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   4     744   040040 040040   040040 040040   040040 040040   040040 040040
   4     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:107  
   4    1000   040040 040040   040040 040040   040040 040040   040040 040040
   4    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   4    1040   040040 040040   040040 040040   040040 040040   040040 040040
   4    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   4    1064   040040 040040   040040 040040   040040 040040   040040 040040
   4    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
   4    1120   040040 040040   040040 040040   040040 040040   040040 040040
   4    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   4    1140   040040 040040   040040 040040   040040 040040   040040 040040
   4    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
   4    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
   4    1154   040040 040040   040040 040040   040040 040040   040040 040040
   4    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
   4    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
   4    1170   040040 040040   040040 040040   040040 040040   040040 040040
   4    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
   4    1204   040040 040040   040040 040040   040040 040040   040040 040040
   4    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   5     000   123116 055123   105040 040040   117101 055101   103040 040040    SN-SE   OA-AC
   5     004   101103 040040   122103 040040   123103 040040   122103 055122    AC  RC  SC  RC-R
   5     010   101040 040040   101103 055122   101040 040040   122101 040040    A   AC-RA   RA
   5     014   052120 101137   122105 103137   123116 040040   104101 055123    *PA_REC_SN  DA-S
   5     020   116040 040040   123103 055123   117123 115040   123115 040040    N   SC-SOSM SM
   5     024   122103 055123   117123 115040   123115 123123   055103 106040    RC-SOSM SMSS-CF
   5     030   106122 055103   106123 040040   106122 040040   052052 052052    FR-CFS  FR  ****
   5     034   122103 055106   122040 040040   103055 106040   106122 055103    RC-FR   C-F FR-C
   5     040   106122 040040                                                    FR

(unnamed)
 Sect OctLoc
   7     000   000001 000000   000000 006000   000002 006000   000004 006000    ................
   7     004   000002 000000   000005 006000   000014 006000   000006 006000    ................
   7     010   000014 006000   000000 003736   000011 006000   000000 004227    ................
   7     014   000013 006000   000000 000000   777777 777777   400000 000000    ................
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:108  
   7     020   000003 000000   000000 000012   000000 006000   000021 006000    ................
   7     024   000010 006000   000000 004063   000025 006000   000000 004065    .......3.......5
   7     030   000027 006000   000000 004070   000031 006000   777777 777000    .......8........
   7     034   000000 021521   000034 006000   000000 000001   000020 006000    ................
   7     040   000036 006000   000000 001000   000041 006000   000015 006000    .........!......
   7     044   000000 400000   000044 006000   000000 303237   000046 006000    .....$.......&..
   7     050   000000 004066   000050 006000   000000 000143   000052 006000    ...6.(.....c.*..
   7     054   000000 004067   000054 006000   000000 021522   000056 006000    ...7.,..........
   7     060   000000 021523   000060 006000   000000 000024   000000 006000    .....0..........
   7     064   000062 006000   000010 006000   000000 004111   000066 006000    .2.........I.6..
   7     070   000000 004112   000070 006000   377777 777777   577777 777777    ...J.8..........
   7     074   677777 777777   737777 777777   757777 777777   000000 000050    ...............(
   7     100   000000 006000   000077 006000   000010 006000   000000 004123    .....?.........S
   7     104   000103 006000   000000 003760   000105 006000   000000 003761    .C.......E......
   7     110   000107 006000   000007 006000   000011 006000   000013 006000    .G..............
   7     114   000000 004124   000114 006000   000022 006000   000000 007637    ...T.L..........
   7     120   000117 006000   000016 006000   000416 006000   000017 006000    .O..............
   7     124   000000 000002   000000 000036   000124 006000   000125 006000    .........T...U..
   7     130   000000 006000   000000 021534   000131 006000   000021 006000    .........Y......
   7     134   000023 006000   000024 006000   000023 006000   000026 006000    ................
   7     140   000026 006000   000030 006000   000032 006000   000033 006000    ................
   7     144   000023 006000   000034 006000   000033 006000   000024 006000    ................
   7     150   000036 006000   000032 006000   000352 006000   000037 006000    ................
   7     154   000000 006000   000125 006000   000010 006000   000000 003771    .....U..........
   7     160   000157 006000   000000 000037   000000 006000   000161 006000    .o...........q..
   7     164   000010 006000   000000 004003   000165 006000   000000 004147    .........u.....g
   7     170   000167 006000   000000 004001   000171 006000   000015 006000    .w.......y......
   7     174   000124 006000   000125 006000   000427 006000   000000 004046    .T...U.........&
   7     200   000177 006000   000000 000003   000000 005667   000202 006000    ................
   7     204   000201 006000   000000 004014   000205 006000   040040 040040    ............
   7     210   000000 004705   000210 006000   000000 004706   000212 006000    ................
   7     214   000000 004712   000214 006000   000000 004724   000216 006000    ................
   7     220   000000 004732   000220 006000   000000 004742   000222 006000    ................
   7     224   000000 004746   000224 006000   000000 004754   000226 006000    ................
   7     230   000000 004756   000230 006000   000000 004757   000232 006000    ................
   7     234   000000 004766   000234 006000   000000 004770   000236 006000    ................
   7     240   000000 005032   000240 006000                                    ........
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:109  

PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:110  
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$M_PSET.

   Procedure ZIG$M_PSET requires 1320 words for executable code.
   Procedure ZIG$M_PSET requires 18 words of local(AUTO) storage.

    No errors detected in file ZIG$M_PSET.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:111  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:112  
          MINI XREF LISTING

ABORT
        55**DCL-ENT  5894--CALL
ACTR581
      5645**LABEL    5628--CALLALT
ACTR584
      5661**LABEL    5650--CALLALT
ACTR585
      5667**LABEL    5663--CALLALT
ACTR588
      5696**LABEL    5692--CALLALT
BAD_AREA
        40**DCL      5315>>IF       5317<<ASSIGN   5455<<ASSIGN   5461<<ASSIGN   5471<<ASSIGN
BAD_RECORD
        45**DCL      5506<<ASSIGN   5511<<ASSIGN   5525<<ASSIGN   5528>>IF       5572>>IF       5580>>IF
BLK.SUBLK$
      5162**DCL      5243>>ASSIGN   5243>>ASSIGN   5244>>ASSIGN
CONNECT_6
      1095**DCL-ENT  5214--CALL     5641--CALL     5686--CALL     5689--CALL
COUNT IN PROCEDURE POWER_2
      5270**DCL      5272<<ASSIGN   5273>>DOWHILE  5274<<ASSIGN   5274>>ASSIGN   5275>>ASSIGN   5276>>ASSIGN
DBCS_ERR
      5894**LABEL    5661--CALLALT  5675--CALLALT  5677--CALLALT  5680--CALLALT
DBK_AC
        41**DCL      5215<<ASSIGN   5540<<ASSIGN   5542>>DOWHILE
DBK_RC
        42**DCL      5221<<ASSIGN
DBK_SC
        46**DCL      5226<<ASSIGN
DISCONNECT_6
      1096**DCL-ENT  5213--CALL
END_DMCL
        56**DCL      5282>>IF       5284>>IF       5780<<ASSIGN
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:113  
END_SN
      5601**LABEL    5598--CALLALT
ERROR
        36**DCL-ENT  5229--CALL     5256--CALL     5290--CALL     5304--CALL     5415--CALL     5427--CALL
      5460--CALL     5472--CALL     5512--CALL     5521--CALL     5533--CALL     5551--CALL     5605--CALL
      5709--CALL     5727--CALL     5740--CALL     5757--CALL     5787--CALL     5805--CALL     5811--CALL
      5817--CALL     5824--CALL     5831--CALL     5838--CALL     5844--CALL     5850--CALL     5857--CALL
      5863--CALL     5869--CALL     5875--CALL     5881--CALL
FAIL
      5551**LABEL    5539--CALLALT  5543--CALLALT
FAIL1 IN PROCEDURE PROCCESS_NAME
      5229**LABEL    5208--CALLALT
FAIL2
      5740**LABEL    5734--CALLALT
FCURR_R_6
      1087**DCL-ENT  5237--CALL     5548--CALL     5587--CALL     5637--CALL     5645--CALL     5656--CALL
      5667--CALL     5688--CALL
FETCHD_6
      1085**DCL-ENT  5220--CALL     5225--CALL     5595--CALL     5647--CALL     5668--CALL
FETCHNS_6
      1090**DCL-ENT  5208--CALL     5539--CALL     5543--CALL     5583--CALL     5598--CALL     5628--CALL
      5650--CALL     5661--CALL     5663--CALL     5671--CALL     5675--CALL     5677--CALL     5680--CALL
      5692--CALL     5734--CALL
FETCHOS_6
      1094**DCL-ENT  5541--CALL     5544--CALL     5581--CALL     5584--CALL     5626--CALL     5652--CALL
FIELD1.COUNT1
        48**DCL      5244<<ASSIGN   5253>>CALLBLT  5801<<ASSIGN   5802>>ASSIGN
FIELD1.TEXT1
        49**DCL      5245<<ASSIGN   5802<<ASSIGN
FINDD_6
      1086**DCL-ENT  5601--CALL     5674--CALL     5681--CALL     5687--CALL
FINDOS_6
      1093**DCL-ENT  5690--CALL
GET_NUM
      5249**PROC     5335--CALL     5348--CALL     5361--CALL     5368--CALL     5381--CALL     5398--CALL
      5557--CALL     5564--CALL     5573--CALL     5742--CALL     5767--CALL     5773--CALL
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:114  
GET_WORD
      5242**PROC     5252--CALL     5288--CALL     5456--CALL     5507--CALL     5529--CALL     5705--CALL
      5723--CALL
HIGH IN PROCEDURE GET_NUM
      5251**DCL      5249--PROC     5254>>IF
HIGH_DBK
        53**DCL      5547>>ASSIGN   5565<<ASSIGN   5586>>ASSIGN
I
        66**DCL      5597<<ASSIGN   5601<>CALL     5673<<DOINDEX
I IN PROCEDURE POWER_2
      5268**DCL      5269--REDEF    5271<<ASSIGN   5273>>DOWHILE  5278>>ASSIGN
INDEX_AREA
        67**DCL      5301>>IF       5310>>IF       5321>>IF       5343>>IF       5356>>IF       5376>>IF
      5393>>IF       5405>>IF       5413>>IF       5425>>IF       5437>>IF       5444>>IF       5493<<ASSIGN
      5494<<ASSIGN
I_B IN PROCEDURE POWER_2
      5269**DCL      5275<<ASSIGN   5276<<ASSIGN
J
        58**DCL      5794<<ASSIGN   5795>>DOWHILE  5796<<ASSIGN   5796>>ASSIGN   5798>>DOWHILE  5799<<ASSIGN
      5799>>ASSIGN   5801>>ASSIGN
LINE
        57**DCL      5795>>DOWHILE  5798>>DOWHILE  5802>>ASSIGN
LOW IN PROCEDURE GET_NUM
      5250**DCL      5249--PROC     5254>>IF       5258>>ASSIGN
LOW_DBK
        54**DCL      5546>>ASSIGN   5558<<ASSIGN   5564<>CALL     5585>>ASSIGN
MAX1
        52**DCL      5335<>CALL     5398>>CALL     5557>>CALL     5564>>CALL
MAXN
        50**DCL        52--REDEF
MODIFYIA_6
      1100**DCL-ENT  5549--CALL     5588--CALL
MODIFY_6
      1088**DCL-ENT  5238--CALL     5646--CALL
MODT
      5235**PROC     5216--CALL     5315--CALL     5486--CALL     5502--CALL     5575--CALL     5696--CALL
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:115  
      5721--CALL     5744--CALL     5750--CALL     5753--CALL     5822--CALL     5829--CALL     5836--CALL
NUM
        44**DCL      5253<<CALLBLT  5254>>IF       5254>>IF       5258<<ASSIGN   5278<<ASSIGN   5336>>ASSIGN
      5349<>CALL     5350>>ASSIGN   5362<>CALL     5363>>ASSIGN   5369>>IF       5382>>ASSIGN   5399>>ASSIGN
      5558>>ASSIGN   5565>>ASSIGN   5574>>ASSIGN   5743>>ASSIGN   5768>>ASSIGN   5774>>ASSIGN
NUM_2 IN PROCEDURE POWER_2
      5267**DCL      5266--PROC     5273>>DOWHILE
PARAN
      5061**DCL        31--PROC
PARAN.CHARPOS
      5099**DCL      5794>>ASSIGN   5801>>ASSIGN   5802>>ASSIGN
PARAN.CODE
      5082**DCL      5256>>CALL     5286>>DOCASE   5803>>DOCASE
PARAN.OUT$
      5091**DCL      5243>>ASSIGN   5243>>ASSIGN   5244>>ASSIGN
PARAN.TYPE
      5062**DCL      5280>>DOCASE
PAREC_NUMB_SK
        62**DCL      5651<<ASSIGN   5651>>ASSIGN   5664<<ASSIGN   5673>>DOINDEX  5703<<ASSIGN
PAREC_PA_PLACE
        61**DCL      5672<<ASSIGN   5681<>CALL     5702<<ASSIGN
PAREC_SMDBK
        63**DCL      5631>>IF       5632<<ASSIGN   5647<>CALL     5668<>CALL     5704<<ASSIGN
PAREC_USER_PLACE
        60**DCL      5669<<ASSIGN   5674<>CALL     5679<<ASSIGN   5693<<ASSIGN   5701<<ASSIGN
POWER_2
      5266**PROC     5349--CALL     5362--CALL
PROCCESS_NAME
      5206**PROC     5468--CALL     5517--CALL     5717--CALL
RET
      5590**LABEL    5583--CALLALT
SAVE_PA_ENTRY
        65**DCL      5622>>ASSIGN   5700<<ASSIGN   5774<<ASSIGN
SAVE_PA_TYPE
        64**DCL      5621>>ASSIGN   5699<<ASSIGN   5768<<ASSIGN
SEPNTR
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:116  
        43**DCL      5207<<ASSIGN   5209<<ASSIGN   5220<>CALL     5225<>CALL
SET_FIELDS
        37**DCL-ENT  5604--CALL     5756--CALL
SRCHD
        34**DCL-ENT  5289--CALL     5457--CALL     5508--CALL     5530--CALL     5706--CALL     5724--CALL
STRE_6
      1082**DCL-ENT  5618--CALL     5624--CALL     5638--CALL     5657--CALL     5684--CALL
SUCC
        39**DCL      5289<>CALL     5290>>IF       5457<>CALL     5458>>IF       5508<>CALL     5509>>IF
      5530<>CALL     5531>>IF       5706<>CALL     5707>>IF       5724<>CALL     5725>>IF
SYM.COUNT
      5198**DCL      5201--IMP-SIZ  5243>>ASSIGN   5244>>ASSIGN
SYM.TEXT
      5201**DCL      5243>>ASSIGN
SYNTAX_ERR
        59**DCL      5282>>UNWIND   5284>>UNWIND   5890>>UNWIND
TYPE_C IN PROCEDURE MODT
      5236**DCL      5235--PROC     5237<>CALL     5238<>CALL
UWA.AC.CALC_NEXT
       851**DCL       852--REDEF
UWA.AC.CALC_NULL
       831**DCL      5410<<ASSIGN   5435<<ASSIGN
UWA.AC.CALC_PRIOR
       860**DCL       861--REDEF
UWA.AC.DBK_CALC
       842**DCL      5313<<ASSIGN   5363<<ASSIGN   5411<<ASSIGN
UWA.AC.DBK_PAGE
       841**DCL      5350<<ASSIGN
UWA.AC.DEFAULTS
       812**DCL       813--REDEF
UWA.AC.FILE_CODE
       817**DCL       818--REDEF
UWA.AC.FLAG1.ERROR_NUM
       815**DCL      5318>>IF       5484<<ASSIGN
UWA.AC.FLAG1.ERROR_TYPE
       814**DCL       815--REDEF
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:117  
UWA.AC.FLAG1.STATUS
       816**DCL      5301>>IF       5309<<ASSIGN   5316<<ASSIGN   5318>>IF       5319<<ASSIGN   5337<<ASSIGN
      5469>>IF       5483<<ASSIGN
UWA.AC.FLAGS.CHKSUM
       819**DCL      5442<<ASSIGN   5478<<ASSIGN
UWA.AC.FLAGS.CJRNL
       821**DCL      5451<<ASSIGN   5480<<ASSIGN
UWA.AC.FLAGS.ENCRP
       820**DCL      5449<<ASSIGN   5479<<ASSIGN
UWA.AC.FLAGS.TJRNL
       823**DCL      5482<<ASSIGN   5496<<ASSIGN
UWA.AC.FLAGS.TMPLT
       822**DCL      5453<<ASSIGN   5481<<ASSIGN
UWA.AC.KEYS_RSRVD
       834**DCL      5399<<ASSIGN
UWA.AC.MAX_DBK
       836**DCL      5303<<ASSIGN   5336<<ASSIGN
UWA.AC.PAGE_SIZE
       848**DCL      5485<<ASSIGN
UWA.AC.PAGE_TYP
       829**DCL      5312<<ASSIGN   5423<<ASSIGN   5434<<ASSIGN
UWA.AC.PER_INV
       830**DCL      5212<<ASSIGN   5382<<ASSIGN
UWA.AC.PRIME_KEY
       826**DCL      5492>>IF
UWA.C_F.CTRLTYPE
       947**DCL      5676>>DOWHILE  5683<<ASSIGN
UWA.C_F.SYN
       946**DCL      5682<<ASSIGN
UWA.DA.FRST_RC
       960**DCL      5595<>CALL
UWA.DA.NUMB_SN
       952**DCL      5619<<ASSIGN   5619>>ASSIGN
UWA.DIRECT_REF
       752**DCL      5207>>ASSIGN   5209>>ASSIGN   5215>>ASSIGN   5221>>ASSIGN   5226>>ASSIGN   5540>>ASSIGN
      5542>>DOWHILE  5597>>ASSIGN   5632>>ASSIGN   5654>>ASSIGN   5669>>ASSIGN   5672>>ASSIGN   5679>>ASSIGN
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:118  
      5693>>ASSIGN
UWA.FR.FR_FRH
       922**DCL      5654<<ASSIGN   5687<>CALL
UWA.FR.F_USE
       915**DCL      5655<<ASSIGN
UWA.FR.SYN
       906**DCL      5653<<ASSIGN
UWA.OA.NUMB_CF
       806**DCL      5685<<ASSIGN   5685>>ASSIGN
UWA.OA.NUMB_FR
       802**DCL      5658<<ASSIGN   5658>>ASSIGN
UWA.OA.NUMB_RC
       799**DCL      5625<<ASSIGN   5625>>ASSIGN
UWA.OA.NUMB_SM
       804**DCL      5639<<ASSIGN   5639>>ASSIGN
UWA.RA.HIGHDBK
       902**DCL      5547<<ASSIGN   5586<<ASSIGN
UWA.RA.LOWDBK
       901**DCL      5546<<ASSIGN   5585<<ASSIGN
UWA.RC
       869**DCL      5620<<ASSIGN
UWA.RC.NUM_SOSM
       883**DCL      5640<<ASSIGN   5640>>ASSIGN
UWA.RC.PA_ENTRY
       882**DCL      5622<<ASSIGN
UWA.RC.PSMODE
       871**DCL      5519>>IF       5623<<ASSIGN
UWA.RC.RTYPE
       870**DCL      5574<<ASSIGN   5621<<ASSIGN
UWA.RECORD_NAME
       749**DCL      5629>>IF
UWA.SC.INDEX_ID
       898**DCL      5743<<ASSIGN
UWA.SC.SETMODE
       888**DCL      5592>>IF       5749<<ASSIGN   5752<<ASSIGN   5763<<ASSIGN
UWA.SC.SETORD
PL6.E3A0      #001=ZIG$M_PSET File=ZIG$M_PSET.:ZIC0TSI                           FRI 09/05/97 12:09 Page:119  
       889**DCL      5754>>IF
UWA.SC.USER_PTS
       897**DCL      5720<<ASSIGN
UWA.SM.CALCDUP
       932**DCL      5634<<ASSIGN
UWA.SM.MEMDUP
       930**DCL      5633<<ASSIGN
UWA.SM.PAMEM
       933**DCL      5636<<ASSIGN
UWA.SM.PSMODE
       934**DCL      5635<<ASSIGN
UWA.SN.DCLR
       965**DCL      5614<<ASSIGN
UWA.SN.ESCAPE
       966**DCL      5615<<ASSIGN
UWA.SN.LNO
       968**DCL      5617<<ASSIGN
UWA.SN.SENAME
       970**DCL      5594>>CALLBLT  5596>>DOWHILE  5602>>IF       5613<<ASSIGN   5756<>CALL
UWA.SN.SETYPE
       967**DCL      5210>>IF       5218>>IF       5223>>IF       5616<<ASSIGN
WARNING
        35**DCL-ENT  5257--CALL     5296--CALL     5323--CALL     5345--CALL     5358--CALL     5370--CALL
      5378--CALL     5387--CALL     5395--CALL     5407--CALL     5439--CALL     5446--CALL
WORD1
        38**DCL      5243<<ASSIGN   5245>>ASSIGN   5253>>CALLBLT  5289<>CALL     5457<>CALL     5508<>CALL
      5530<>CALL     5594<<CALLBLT  5596>>DOWHILE  5602>>IF       5604<>CALL     5613>>ASSIGN   5706<>CALL
      5724<>CALL
ZIG$M_READ
        33**DCL-ENT  5283--CALL
