VERSION A06

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8EY$BUILD_RUNTIME_ARGLIST: PROC (LIST_TOP$, ARG_LIST$, IDENT_COUNT);
        7        7
        8        8        %SET PHASE = 1;
        9        9
       10       10        %INCLUDE Z8A_DEFC;
       11       78        %INCLUDE Z8A_SUPP_MAC;
       12     2478        %INCLUDE Z8A_LTS;
       13     4555        %INCLUDE Z8A_ILL;
       14     5248        %INCLUDE Z8E_HEAP;
       15     5304        %INCLUDE Z8A_ETT;
       16     5605        %INCLUDE Z8A_ST;
       17     9264        %INCLUDE Z8A_QLT;
       18     9370        %INCLUDE Z8E_STACKS;
       19    11636        %INCLUDE Z8E_O1COM;
       20    12397
       21    12398    1   DCL Z8EU$FREE_LIST_ENTRY ENTRY (1);
       22    12399    1   DCL Z8EY$CHECK_OPTZ      ENTRY (1);
       23    12400
       24    12401    1   DCL LIST_TOP$                 PTR;
       25    12402    1   DCL LIST$                     PTR;
       26    12403    1   DCL ARG_LIST$                 PTR;
       27    12404    1   DCL IDENT_COUNT               SBIN WORD;
       28    12405
       29    12406    1   DCL ARG_COUNT                 SBIN WORD;
       30    12407    1   DCL ARG_PTR$                  PTR;
       31    12408    1   DCL ST$$                      PTR;
       32    12409    1   DCL QLT$$                     PTR;
       33    12410    1   DCL LTS_UBIN                  UBIN STATIC INIT (0);
       34    12411    1   DCL ZERO_PTR$                 REDEF LTS_UBIN PTR;
       35    12412
       36    12413           /* Count the number of args to put in the list */
       37    12414    1      ARG_COUNT = 0;
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:2    
       38    12415    1      LIST$ = LIST_TOP$;
       39    12416    2      DO WHILE LIST$ ~= ADDR(NIL);
       40    12417    2        ARG_COUNT = ARG_COUNT + 1;
       41    12418    2        LIST$ = LIST$ -> LX_ETT_ITEM.LINK;
       42    12419    2      END;
       43    12420
       44    12421    1      ITERATION = ARG_COUNT + 1;
       45    12422           %RESERVE_LTS (ITEM=%ARGLIST, POINTER = ARG_LIST$);
       46    12508
       47    12509    1      LIST$ = LIST_TOP$;
       48    12510    1      ARG_COUNT = 0;
       49    12511
       50    12512    2      DO WHILE (LIST$ ~= ADDR(NIL));
       51    12513    2        ARG_PTR$ = LIST$ -> LX_ETT_ITEM.ETT$;
       52    12514    2        ARG_LIST$ -> ARGLIST.ARG$(ARG_COUNT) = ARG_PTR$;
       53    12515
       54    12516             /* Inhibit Z8GO "VALUE" optimization for scalars used as args */
       55    12517    3        IF ARG_PTR$ ~= ADDR(NIL) THEN DO;
       56    12518               %FISH (TRIAD = ARG_PTR$, RTN = ST$$);
       57    12526    3          QLT$$ = ST$$ -> SCALAR.QLT$;
       58    12527    3          IF  ST$$ -> SCALAR.LTS$ ~= ADDR(NIL) /* Possible VALUE clause */
       59    12528    3          AND ST$$ -> SCALAR.LTS$ ~= ZERO_PTR$
       60    12529    3          AND ST$$ -> SCALAR.LTS$ -> ETT.ID = %TRIAD THEN
       61    12530    3            ST$$ -> SCALAR.LTS$ = ADDR(NIL);
       62    12531    3          IF  QLT$$ ~= ADDR(NIL)
       63    12532    3          AND QLT$$ ~= ZERO_PTR$ THEN
       64    12533    3            QLT$$ = QLT$$ -> QLT.SON;
       65    12534    3          IF  QLT$$ ~= ADDR(NIL)
       66    12535    3          AND QLT$$ ~= ZERO_PTR$ THEN
       67    12536    3            CALL Z8EY$CHECK_OPTZ (QLT$$); /* Check sons and brothers */
       68    12537    3        END; /* Inhibit Z8GO "VALUE" optimization. */
       69    12538
       70    12539    2        ARG_COUNT = ARG_COUNT + 1;
       71    12540    2        LIST$ = LIST$ -> LX_ETT_ITEM.LINK;
       72    12541    2      END; /* Until -- list$ ~= addr(nil) */
       73    12542
       74    12543    1   END; /* Proc -- Z8EY$build_runtime_arglist */
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:3    
       75    12544        %EJECT;
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:4    
       76    12545        %EOD;

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:5    
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$BUILD_RUNTIME_ARGLIST.

   Procedure Z8EY$BUILD_RUNTIME_ARGLIST requires 107 words for executable code.
   Procedure Z8EY$BUILD_RUNTIME_ARGLIST requires 14 words of local(AUTO) storage.

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:6    

 Object Unit name= Z8EY$BUILD_RUNTIME_ARGLIST                 File name= Z8EY.:Z8A6TOU
 UTS= AUG 09 '97 12:58:53.52 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  LTS$
    2  LblCom even  none     5      5  LTS_
    3  LblCom even  none     1      1  ILL$
    4  LblCom even  none     5      5  ILL_
    5  LblCom even  none     1      1  HEAP$
    6  LblCom even  none     1      1  ETT$
    7  LblCom even  none     1      1  HEAD_ETT$
    8  LblCom even  none   512   1000  ETT_BUCKETS
    9  LblCom even  none     5      5  ETT_
   10  LblCom even  none     1      1  ST$
   11  LblCom even  none     5      5  ST_
   12  LblCom even  none     1      1  QLT$
   13  LblCom even  none     1      1  PREV_01_QLT$
   14  LblCom even  none     5      5  QLT_
   15  LblCom even  none    90    132  LEX_SYMBOL
   16  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   17  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   18  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   19   Data  even  none     1      1  Z8EY$BUILD_RUNTIME_ARGLIST
   20   Proc  even  none   107    153  Z8EY$BUILD_RUNTIME_ARGLIST
   21  RoData even  none     3      3  Z8EY$BUILD_RUNTIME_ARGLIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    20      0   yes            yes      Std        3  Z8EY$BUILD_RUNTIME_ARGLIST
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:7    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 Z8AR$RESERVER
         yes           Std       1 Z8EY$CHECK_OPTZ
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    LTS_STEP                         r    ILL_STEP                              O1COM
     HIER_STK_PTR                          HIER_STK                              PAGE_FORMAT
     REP_STK_PTR                           REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:8    


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        Z8EY$BUILD_RUNTIME_ARGLIST: PROC (LIST_TOP$, ARG_LIST$, IDENT_COUNT);

      6 20 000000   000000 700200 xent  Z8EY$BUILD_* TSX0  ! X66_AUTO_3
        20 000001   000016 000003                    ZERO    14,3

        7        7
        8        8        %SET PHASE = 1;
        9        9
       10       10        %INCLUDE Z8A_DEFC;
       11       78        %INCLUDE Z8A_SUPP_MAC;
       12     2478        %INCLUDE Z8A_LTS;
       13     4555        %INCLUDE Z8A_ILL;
       14     5248        %INCLUDE Z8E_HEAP;
       15     5304        %INCLUDE Z8A_ETT;
       16     5605        %INCLUDE Z8A_ST;
       17     9264        %INCLUDE Z8A_QLT;
       18     9370        %INCLUDE Z8E_STACKS;
       19    11636        %INCLUDE Z8E_O1COM;
       20    12397
       21    12398    1   DCL Z8EU$FREE_LIST_ENTRY ENTRY (1);
       22    12399    1   DCL Z8EY$CHECK_OPTZ      ENTRY (1);
       23    12400
       24    12401    1   DCL LIST_TOP$                 PTR;
       25    12402    1   DCL LIST$                     PTR;
       26    12403    1   DCL ARG_LIST$                 PTR;
       27    12404    1   DCL IDENT_COUNT               SBIN WORD;
       28    12405
       29    12406    1   DCL ARG_COUNT                 SBIN WORD;
       30    12407    1   DCL ARG_PTR$                  PTR;
       31    12408    1   DCL ST$$                      PTR;
       32    12409    1   DCL QLT$$                     PTR;
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:9    
       33    12410    1   DCL LTS_UBIN                  UBIN STATIC INIT (0);
       34    12411    1   DCL ZERO_PTR$                 REDEF LTS_UBIN PTR;
       35    12412
       36    12413           /* Count the number of args to put in the list */
       37    12414    1      ARG_COUNT = 0;

  12414 20 000002   200007 450100                    STZ     ARG_COUNT,,AUTO

       38    12415    1      LIST$ = LIST_TOP$;

  12415 20 000003   200003 470500                    LDP0    @LIST_TOP$,,AUTO
        20 000004   000000 236100                    LDQ     0,,PR0
        20 000005   200006 756100                    STQ     LIST$,,AUTO

       39    12416    2      DO WHILE LIST$ ~= ADDR(NIL);

  12416 20 000006   000013 710000 20                 TRA     s:12419

       40    12417    2        ARG_COUNT = ARG_COUNT + 1;

  12417 20 000007   200007 054100                    AOS     ARG_COUNT,,AUTO

       41    12418    2        LIST$ = LIST$ -> LX_ETT_ITEM.LINK;

  12418 20 000010   200006 470500                    LDP0    LIST$,,AUTO
        20 000011   000007 236100                    LDQ     7,,PR0
        20 000012   200006 756100                    STQ     LIST$,,AUTO

       42    12419    2      END;

  12419 20 000013   000000 116000 21                 CMPQ    0
        20 000014   000007 601000 20                 TNZ     s:12417

       43    12420
       44    12421    1      ITERATION = ARG_COUNT + 1;

  12421 20 000015   200007 235100                    LDA     ARG_COUNT,,AUTO
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:10   
        20 000016   000001 035007                    ADLA    1,DL
        20 000017   000000 755000 0                  STA     ITERATION

       45    12422           %RESERVE_LTS (ITEM=%ARGLIST, POINTER = ARG_LIST$);

  12498 20 000020   000002 236000 2                  LDQ     LTS_+2
        20 000021   000000 036000 0                  ADLQ    ITERATION
        20 000022   000003 116000 2                  CMPQ    LTS_+3
        20 000023   000034 604000 20                 TMI     s:12500

  12499 20 000024   000002 236000 21                 LDQ     2
        20 000025   200014 756100                    STQ     QLT$$+2,,AUTO
        20 000026   200014 630500                    EPPR0   QLT$$+2,,AUTO
        20 000027   200015 450500                    STP0    QLT$$+3,,AUTO
        20 000030   200015 630500                    EPPR0   QLT$$+3,,AUTO
        20 000031   000001 631400 21                 EPPR1   1
        20 000032   000000 701000 xent               TSX1    Z8AR$RESERVER
        20 000033   000000 011000                    NOP     0

  12500 20 000034   000002 236000 2                  LDQ     LTS_+2
        20 000035   000022 736000                    QLS     18
        20 000036   000001 036000 2                  ADLQ    LTS_+1
        20 000037   200004 470500                    LDP0    @ARG_LIST$,,AUTO
        20 000040   000000 756100                    STQ     0,,PR0

  12501 20 000041   000002 236000 2                  LDQ     LTS_+2
        20 000042   000000 036000 0                  ADLQ    ITERATION
        20 000043   000002 756000 2                  STQ     LTS_+2

  12502 20 000044   000000 471500                    LDP1    0,,PR0
        20 000045   001112 220003                    LDX0    586,DU
        20 000046   100000 740100                    STX0    0,,PR1

  12504 20 000047   000000 471500                    LDP1    0,,PR0
        20 000050   000000 721000 0                  LXL1    ITERATION
        20 000051   100000 441100                    SXL1    0,,PR1

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:11   
       46    12508
       47    12509    1      LIST$ = LIST_TOP$;

  12509 20 000052   200003 471500                    LDP1    @LIST_TOP$,,AUTO
        20 000053   100000 236100                    LDQ     0,,PR1
        20 000054   200006 756100                    STQ     LIST$,,AUTO

       48    12510    1      ARG_COUNT = 0;

  12510 20 000055   200007 450100                    STZ     ARG_COUNT,,AUTO

       49    12511
       50    12512    2      DO WHILE (LIST$ ~= ADDR(NIL));

  12512 20 000056   000150 710000 20                 TRA     s:12541

       51    12513    2        ARG_PTR$ = LIST$ -> LX_ETT_ITEM.ETT$;

  12513 20 000057   200006 470500                    LDP0    LIST$,,AUTO
        20 000060   000001 236100                    LDQ     1,,PR0
        20 000061   200010 756100                    STQ     ARG_PTR$,,AUTO

       52    12514    2        ARG_LIST$ -> ARGLIST.ARG$(ARG_COUNT) = ARG_PTR$;

  12514 20 000062   200004 471500                    LDP1    @ARG_LIST$,,AUTO
        20 000063   100000 473500                    LDP3    0,,PR1
        20 000064   200007 720100                    LXL0    ARG_COUNT,,AUTO
        20 000065   300001 756110                    STQ     1,X0,PR3

       53    12515
       54    12516             /* Inhibit Z8GO "VALUE" optimization for scalars used as args */
       55    12517    3        IF ARG_PTR$ ~= ADDR(NIL) THEN DO;

  12517 20 000066   000000 116000 21                 CMPQ    0
        20 000067   000144 600000 20                 TZE     s:12539

       56    12518               %FISH (TRIAD = ARG_PTR$, RTN = ST$$);
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:12   

  12520 20 000070   200011 756100                    STQ     ST$$,,AUTO

  12521 20 000071   200011 473500                    LDP3    ST$$,,AUTO
        20 000072   300000 221100                    LDX1    0,,PR3
        20 000073   000751 101003                    CMPX1   489,DU
        20 000074   000104 603000 20                 TRC     s:12526

  12522 20 000075   200011 470500                    LDP0    ST$$,,AUTO
        20 000076   000001 236100                    LDQ     1,,PR0
        20 000077   200011 756100                    STQ     ST$$,,AUTO

  12523 20 000100   200011 470500                    LDP0    ST$$,,AUTO
        20 000101   000000 220100                    LDX0    0,,PR0
        20 000102   000751 100003                    CMPX0   489,DU
        20 000103   000075 602000 20                 TNC     s:12522

       57    12526    3          QLT$$ = ST$$ -> SCALAR.QLT$;

  12526 20 000104   200011 470500                    LDP0    ST$$,,AUTO
        20 000105   000007 236100                    LDQ     7,,PR0
        20 000106   200012 756100                    STQ     QLT$$,,AUTO

       58    12527    3          IF  ST$$ -> SCALAR.LTS$ ~= ADDR(NIL) /* Possible VALUE clause */

  12527 20 000107   000005 236100                    LDQ     5,,PR0
        20 000110   000000 116000 21                 CMPQ    0
        20 000111   000122 600000 20                 TZE     s:12531
        20 000112   000000 116000 19                 CMPQ    LTS_UBIN
        20 000113   000122 600000 20                 TZE     s:12531
        20 000114   000005 471500                    LDP1    5,,PR0
        20 000115   100000 220100                    LDX0    0,,PR1
        20 000116   000015 100003                    CMPX0   13,DU
        20 000117   000122 601000 20                 TNZ     s:12531

       59    12528    3          AND ST$$ -> SCALAR.LTS$ ~= ZERO_PTR$
       60    12529    3          AND ST$$ -> SCALAR.LTS$ -> ETT.ID = %TRIAD THEN
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:13   
       61    12530    3            ST$$ -> SCALAR.LTS$ = ADDR(NIL);

  12530 20 000120   000000 236000 21                 LDQ     0
        20 000121   000005 756100                    STQ     5,,PR0

       62    12531    3          IF  QLT$$ ~= ADDR(NIL)

  12531 20 000122   200012 236100                    LDQ     QLT$$,,AUTO
        20 000123   000000 116000 21                 CMPQ    0
        20 000124   000132 600000 20                 TZE     s:12534
        20 000125   000000 116000 19                 CMPQ    LTS_UBIN
        20 000126   000132 600000 20                 TZE     s:12534

       63    12532    3          AND QLT$$ ~= ZERO_PTR$ THEN
       64    12533    3            QLT$$ = QLT$$ -> QLT.SON;

  12533 20 000127   200012 471500                    LDP1    QLT$$,,AUTO
        20 000130   100003 236100                    LDQ     3,,PR1
        20 000131   200012 756100                    STQ     QLT$$,,AUTO

       65    12534    3          IF  QLT$$ ~= ADDR(NIL)

  12534 20 000132   000000 116000 21                 CMPQ    0
        20 000133   000144 600000 20                 TZE     s:12539
        20 000134   000000 116000 19                 CMPQ    LTS_UBIN
        20 000135   000144 600000 20                 TZE     s:12539

       66    12535    3          AND QLT$$ ~= ZERO_PTR$ THEN
       67    12536    3            CALL Z8EY$CHECK_OPTZ (QLT$$); /* Check sons and brothers */

  12536 20 000136   200012 631500                    EPPR1   QLT$$,,AUTO
        20 000137   200014 451500                    STP1    QLT$$+2,,AUTO
        20 000140   200014 630500                    EPPR0   QLT$$+2,,AUTO
        20 000141   000001 631400 21                 EPPR1   1
        20 000142   000000 701000 xent               TSX1    Z8EY$CHECK_OPTZ
        20 000143   000000 011000                    NOP     0

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:14   
       68    12537    3        END; /* Inhibit Z8GO "VALUE" optimization. */

       69    12538
       70    12539    2        ARG_COUNT = ARG_COUNT + 1;

  12539 20 000144   200007 054100                    AOS     ARG_COUNT,,AUTO

       71    12540    2        LIST$ = LIST$ -> LX_ETT_ITEM.LINK;

  12540 20 000145   200006 470500                    LDP0    LIST$,,AUTO
        20 000146   000007 236100                    LDQ     7,,PR0
        20 000147   200006 756100                    STQ     LIST$,,AUTO

       72    12541    2      END; /* Until -- list$ ~= addr(nil) */

  12541 20 000150   000000 116000 21                 CMPQ    0
        20 000151   000057 601000 20                 TNZ     s:12513

       73    12542
       74    12543    1   END; /* Proc -- Z8EY$build_runtime_arglist */

  12543 20 000152   000000 702200 xent               TSX2  ! X66_ARET
       75    12544        %EJECT;
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:15   
       76    12545        %EOD;

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:16   
--  Include file information  --

   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$BUILD_RUNTIME_ARGLIST.
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:17   

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 001 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 002 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 003 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 004 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:18   
  ****  Section 005 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 006 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 007 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 008 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 009 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 010 LblCom ST$

PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:19   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 011 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 012 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 013 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 014 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 015 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:20   

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 016 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 017 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 018 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 019  Data  Z8EY$BUILD_RUNTIME_ARGLIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 LTS_UBIN                   0-0-0/w PTR         r     1 ZERO_PTR$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARG_LIST$                 5-0-0/w PTR         r     1 @IDENT_COUNT
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:21   
     3-0-0/w PTR         r     1 @LIST_TOP$                 7-0-0/w SBIN        r     1 ARG_COUNT
    *0-0-0/w PTR         r     1 ARG_LIST$                 10-0-0/w PTR         r     1 ARG_PTR$
    *0-0-0/w SBIN        r     1 IDENT_COUNT                6-0-0/w PTR         r     1 LIST$
    *0-0-0/w PTR         r     1 LIST_TOP$                 12-0-0/w PTR         r     1 QLT$$
    11-0-0/w PTR         r     1 ST$$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580)       1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864) r     1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:22   
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w STRC(144)         1 DOEND
     0-0-0/w STRC(396)         1 DO_N                       0-0-0/w STRC(180)         1 DV4I
     0-0-0/w STRC(180)         1 ENTRY_ILL                  0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(144)         1 GO                         0-0-0/w STRC(180)         1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(108)         1 LINOI
     0-0-0/w STRC(72)          1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)         1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)   r     1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)         1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)         1 PREOFF                     0-0-0/w STRC(108)         1 PRESET
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)         1 PROC_
PL6.E3A0      #001=Z8EY$BUILD_RUNTIME_ARGLIST File=Z8EY.:Z8A6TSI                 SAT 08/09/97 12:58 Page:23   
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(900)         1 PROC_SUPP
     0-0-0/w STRC(144)         1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(216)   r     1 QLT                        0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)         1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EY$BUILD_RUNTIME_ARGLIST requires 107 words for executable code.
   Procedure Z8EY$BUILD_RUNTIME_ARGLIST requires 14 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:24   
       77        1        /*T***********************************************************/
       78        2        /*T*                                                         */
       79        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       80        4        /*T*                                                         */
       81        5        /*T***********************************************************/
       82        6        Z8EY$SUBSTR: PROC (VAR$$, START$$, LENGTH$$, RETURN$);
       83        7
       84        8        %EQU PHASE = 1;
       85        9        %EQU LENGTH_SPECIFIED = 2;
       86       10
       87       11        %INCLUDE Z8A_DEFC;
       88       79        %INCLUDE Z9A_FLAGS;
       89       93        %INCLUDE Z8A_SUPP_MAC;
       90     2493        %INCLUDE Z8A_ERR_NUMS;
       91     3257        %INCLUDE Z8A_COMCOM;
       92     3907        %INCLUDE Z8A_ETT;
       93     4208        %INCLUDE Z8A_SRCH;
       94     4257        %INCLUDE Z8A_ILL;
       95     4950        %INCLUDE Z8A_ILS;
       96     5059        %INCLUDE Z8A_LIBRARY;
       97     5273        %INCLUDE Z8A_ST;
       98     8932        %INCLUDE Z8A_TYPES;
       99     9106        %INCLUDE Z8A_DNT;
      100     9327        %INCLUDE Z8E_WINDOW;
      101    11397        %INCLUDE Z8E_MACROS;
      102    12072        %INCLUDE Z8A_LTS;
      103    14149        %INCLUDE Z8E_STACKS;
      104    16415        %INCLUDE Z8E_O1COM;
      105    17176
      106    17177    1   DCL Z8AC$MAKE_CONST           ENTRY(1);
      107    17178    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
      108    17179    1   DCL Z8AU$TYPE_DESCRIPTOR      ENTRY(2);
      109    17180    1   DCL Z8EQ$CHECK_FOR_INTEGER_ITEM      ENTRY (2) ALTRET;
      110    17181    1   DCL Z8AF$NEW_OFF              ENTRY (3);
      111    17182    1   DCL Z8AF$NEW_FISS             ENTRY (4);
      112    17183    1   DCL Z8AF$NEW_OFF_AND_SSOP     ENTRY (4);
      113    17184    1   DCL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK ENTRY (4);
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:25   
      114    17185    1   DCL Z8AT$CREATE_TEMP_WITH_BASE ENTRY(2);
      115    17186    1   DCL Z8AE$ERROR                ENTRY(12);
      116    17187    1   DCL Z8AF$FORME                ENTRY(4);
      117    17188    1   DCL Z8EV$CONVERT              ENTRY(3);
      118    17189    1   DCL Z8E5$MATH_PACK            ENTRY(2);
      119    17190    1   DCL Z8CO$DISPL_CHECK          ENTRY(1) ALTRET;
      120    17191    1   DCL Z8CO$CREATE_LIBRARY_BASE  ENTRY(2);
      121    17192
      122    17193    1   DCL START$$                   PTR;
      123    17194    1   DCL LENGTH$$                  PTR;
      124    17195    1   DCL VAR$$                     PTR;
      125    17196    1   DCL RETURN$                   PTR;
      126    17197
      127    17198    1   DCL START$                    PTR;
      128    17199        %DCL_AUTO_LX_ITEM (@NAME = START_POS);
      129    17203        %DCL_AUTO_LX_ITEM (@NAME = LENGTH);
      130    17207        %DCL_AUTO_LX_ITEM (@NAME = SUBSTR_VAR);
      131    17211        %DCL_AUTO_LX_ITEM (@NAME = OFFSET_TIMES_2);
      132    17215        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_TIMES_2);
      133    17219        %DCL_AUTO_LX_ITEM (@NAME = TWO);
      134    17223    1   DCL VAR_ST$                   PTR;
      135    17224    1   DCL TWO$                      PTR;
      136    17225    1   DCL LENGTH$                   PTR;
      137    17226    1   DCL STRING$                   PTR;
      138    17227    1   DCL VAR$                      PTR;
      139    17228    1   DCL STRT_POS$                 PTR;
      140    17229    1   DCL TEMP$                     PTR;
      141    17230    1   DCL STRING_ST$                PTR;
      142    17231    1   DCL SIZ$                      PTR;
      143    17232    1   DCL TABLE_ETT$                PTR;
      144    17233    1   DCL CONV_FLAG                 BOOLEAN;
      145    17234
      146    17235        %INCLUDE Z8A_MKCN;
      147    17252    1   DCL OFF                       SBIN WORD;
      148    17253    1   DCL FISS                      SBIN WORD;
      149    17254    1   DCL TYPE                      SBIN WORD;
      150    17255    1   DCL BYTE_SIZE                 SBIN WORD;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:26   
      151    17256    1   DCL SBCHK_FLAG                BIT(1);
      152    17257    1   DCL MAXLEN                    SBIN;
      153    17258    1   DCL OP                        SBIN WORD;
      154    17259        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:27   
      155    17260
      156    17261        %MACRO GET_SPECIFIED_LENGTH (@LENGTH$  = LENGTH$,
      157    17262                                     @FISS     = FISS,
      158    17263                                     @SIZ$     = SIZ$);
      159    17264           DO;
      160    17265             IF @LENGTH$ -> ETT.ID = %TRIAD
      161    17266             AND @LENGTH$ -> ETT.LOP -> CONST.CONSTI.WORD1 < %#4K THEN
      162    17267               @FISS = @LENGTH$ -> ETT.LOP -> CONST.CONSTI.WORD1;
      163    17268             ELSE
      164    17269               @SIZ$ = @LENGTH$;
      165    17270           END;
      166    17271        %MEND;
      167    17272        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:28   
      168    17273    1   GET_LENGTH: PROC (STRING$, LENGTH, SIZ$);
      169    17274
      170    17275    2   DCL STRING$                   PTR;
      171    17276    2   DCL SIZ$                      PTR;
      172    17277    2   DCL LENGTH                    SBIN WORD;
      173    17278    2   DCL 1 TYPE_DESC               ALIGNED,
      174    17279             %TYPE_DESC;
      175    17313
      176    17314    2    LENGTH = 0;
      177    17315    2    SIZ$ = ADDR(NIL);
      178    17316
      179    17317    2    CALL Z8AU$TYPE_DESCRIPTOR (STRING$, TYPE_DESC);
      180    17318
      181    17319    3    IF TYPE_DESC.SIZ$ ~= ADDR(NIL) THEN DO;
      182    17320    3        SIZ$ = TYPE_DESC.SIZ$;
      183    17321    3        IF TYPE_DESC.SIZ$ -> ETT.ID = %TRIAD THEN /* Constant */
      184    17322    3        LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;
      185    17323    3    END;
      186    17324    2    ELSE
      187    17325    3      DO CASE (TYPE_DESC.TYPE);
      188    17326    3        CASE (%TYA, %TYN, %TYB, %TYE);
      189    17327    3          LENGTH = TYPE_DESC.DESC.ADSC.N;
      190    17328    3        CASE (ELSE);
      191    17329    3          LENGTH = TYPE_DESC.DESC.NDSC.N;
      192    17330    3      END;
      193    17331
      194    17332    2   END; /* PROC -- GET_LENGTH */
      195    17333        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:29   
      196    17334    1   GET_IMPLIED_LENGTH: PROC (STRING$, STRT_POS$, FISS, SIZ$);
      197    17335
      198    17336    2   DCL STRING$                   PTR;
      199    17337    2   DCL SIZ$                      PTR;
      200    17338    2   DCL FISS                      SBIN WORD;
      201    17339    2   DCL STRT_POS$                 PTR;
      202    17340
      203    17341    2   DCL ST$$                      PTR;
      204    17342    2   DCL LENGTH                    SBIN WORD;
      205    17343    2    CALL GET_LENGTH (STRING$, LENGTH, SIZ$);
      206    17344
      207    17345    2    IF LENGTH ~= 0 THEN
      208    17346    3      DO;
      209    17347    3        IF STRT_POS$ -> ETT.ID = %TRIAD THEN
      210    17348    4          DO;
      211    17349    4            FISS = LENGTH + BYTE_SIZE - STRT_POS$ -> ETT.LOP -> CONST.CONSTI.WORD1;
      212    17350    4            IF FISS < %#4K THEN
      213    17351    4              SIZ$ = ADDR(NIL);
      214    17352    4            ELSE
      215    17353    5              DO;
      216    17354    5                MKCN.CON = FISS;
      217    17355    5                CALL Z8AC$MAKE_CONST(SIZ$);
      218    17356    5              END;
      219    17357    4           END;
      220    17358    3        ELSE
      221    17359    4          DO;
      222    17360    4            MKCN.CON = LENGTH + BYTE_SIZE; /* BYTE_SIZE = 1 or 2 */
      223    17361    4            CALL Z8AC$MAKE_CONST(ST$$);
      224    17362    4            CALL Z8AF$FORME(%SBI, ST$$, STRT_POS$, SIZ$) ;
      225    17363    4          END;
      226    17364    3      END;
      227    17365    2    ELSE
      228    17366    3      DO;
      229    17367    3        CALL Z8AF$FORME (%ADI, SIZ$, COMCOM.VALUE_1, SIZ$);
      230    17368    3        CALL Z8AF$FORME (%SBI, SIZ$, STRT_POS$, SIZ$);
      231    17369    3      END;
      232    17370
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:30   
      233    17371    2   END; /* Proc -- get_implied_length */
      234    17372        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:31   
      235    17373    1   SET_UP_START_POS: PROC (START$, OFF, VARIABLE_START);
      236    17374
      237    17375    2   DCL START$             PTR;
      238    17376    2   DCL OFF                SBIN WORD;
      239    17377    2   DCL VARIABLE_START     BIT(1) ALIGNED;
      240    17378
      241    17379    3    DO CASE(START$ -> ETT.ID);
      242    17380
      243    17381    3      CASE(%ADI);
      244    17382    3        IF START$ -> ETT.ROP -> ETT.ID = %TRIAD THEN
      245    17383    4          DO;
      246    17384    4            OFF = START$ -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;
      247    17385    4            START$ = START$ -> ETT.LOP;
      248    17386    4          END;
      249    17387    3        ELSE
      250    17388    3          OFF = - BYTE_SIZE;    /* 1 or 2 */
      251    17389
      252    17390    3        VARIABLE_START = TRUE;
      253    17391
      254    17392    3      CASE(%SBI);
      255    17393    3        IF START$ -> ETT.LOP -> ETT.ID = %TRIAD THEN
      256    17394    4          DO;
      257    17395    4            OFF = START$ -> ETT.LOP -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;
      258    17396    4            START$ = START$ -> ETT.ROP;
      259    17397
      260    17398    4            CALL Z8AF$FORME (%USI, START$, ADDR(NIL), START$);
      261    17399    4          END;
      262    17400    3        ELSE
      263    17401    3          IF START$ -> ETT.ROP -> ETT.ID = %TRIAD THEN
      264    17402    4            DO;
      265    17403    4              OFF = - START$ -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;
      266    17404    4              START$ = START$ -> ETT.LOP;
      267    17405    4            END;
      268    17406    3          ELSE
      269    17407    3            OFF = -BYTE_SIZE;   /* 1 or 2 */
      270    17408
      271    17409    3        VARIABLE_START = TRUE;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:32   
      272    17410
      273    17411    3      CASE(%TRIAD);
      274    17412    3        OFF = START$ -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;
      275    17413    3        VARIABLE_START = FALSE;
      276    17414
      277    17415    3      CASE(ELSE);
      278    17416    3        OFF = -BYTE_SIZE;       /* 1 or 2 */
      279    17417    3        VARIABLE_START = TRUE;
      280    17418
      281    17419    3    END;
      282    17420
      283    17421    2   END SET_UP_START_POS; /* Proc */
      284    17422        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:33   
      285    17423    1   OFFSET_OVERFLOW_CHECK: PROC (OFF, PREV_OFF, START$, VARIABLE_START, STRING$);
      286    17424
      287    17425    2   DCL OFF                SBIN WORD;
      288    17426    2   DCL PREV_OFF           SBIN WORD;
      289    17427    2   DCL START$             PTR;
      290    17428    2   DCL VARIABLE_START     BIT(1) ALIGNED;
      291    17429    2   DCL STRING$            PTR;
      292    17430    2   DCL MAX_OFF_PRECISION  SBIN;
      293    17431
      294    17432    2   DCL OFF$               PTR;
      295    17433    2   DCL LENGTH             SBIN;
      296    17434    2   DCL SIZ$               PTR;
      297    17435
      298    17436
      299    17437         %IF CP6;
      300    17438    2      IF STRING_ST$ -> SCALAR.B.LINKAGE THEN
      301    17439         %ENDIF;
      302    17440    2        MAX_OFF_PRECISION = %#16K;
      303    17441         %IF CP6;
      304    17442    2      ELSE
      305    17443    2        MAX_OFF_PRECISION = %#128K;
      306    17444         %ENDIF;
      307    17445
      308    17446    2      IF OFF + PREV_OFF > MAX_OFF_PRECISION
      309    17447    2      OR OFF + PREV_OFF < - MAX_OFF_PRECISION THEN
      310    17448    3        DO;
      311    17449    3          MKCN.CON = OFF;
      312    17450    3          CALL Z8AC$MAKE_CONST (OFF$);
      313    17451
      314    17452    3          OFF = 0;
      315    17453
      316    17454    4          IF VARIABLE_START THEN DO;
      317    17455    5            IF SBCHK_FLAG AND COMCOM.OB.SUBCHK THEN DO;
      318    17456    5              CALL GET_LENGTH (STRING$, LENGTH, SIZ$);
      319    17457    6              IF SIZ$ = ADDR(NIL) THEN DO;
      320    17458    6                MKCN.CON = LENGTH;
      321    17459    6                CALL Z8AC$MAKE_CONST (SIZ$);
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:34   
      322    17460    6              END;
      323    17461    5              CALL Z8AF$FORME (%SBCHK, START$, SIZ$, START$);
      324    17462    5            END;
      325    17463    4            CALL Z8AF$FORME (%ADI, START$, OFF$, START$);
      326    17464    4          END;
      327    17465    3          ELSE
      328    17466    3            START$ = OFF$;
      329    17467
      330    17468    3          VARIABLE_START = TRUE;
      331    17469    3        END;
      332    17470
      333    17471    2   END OFFSET_OVERFLOW_CHECK;
      334    17472        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:35   
      335    17473    1   CREATE_START_POSITION: PROC (STRING$, OFF, START$);
      336    17474
      337    17475    2   DCL STRING$            PTR;
      338    17476    2   DCL OFF                SBIN WORD;
      339    17477    2   DCL START$             PTR;
      340    17478
      341    17479    2   DCL 1 OFFSET           ALIGNED,
      342    17480    2        2 VALUE           SBIN WORD,
      343    17481    2        2 TYPE            SBIN WORD;
      344    17482    2   DCL OFF$               PTR;
      345    17483    2   DCL VARIABLE_START     BOOLEAN;
      346    17484
      347    17485    2    CALL SET_UP_START_POS (START$, OFF, VARIABLE_START);
      348    17486
      349    17487    3    DO CASE (STRING$ -> ETT.ID);
      350    17488
      351    17489    3      CASE(%SSOP);
      352    17490    3        CALL OFFSET_OVERFLOW_CHECK (OFF, STRING$ -> ETT.LOP -> ETT.OFFSET.VALUE,
      353    17491    3                                    START$, VARIABLE_START, STRING$);
      354    17492
      355    17493    3        IF OFF ~= 0
      356    17494    3        OR VARIABLE_START THEN
      357    17495    4          DO;
      358    17496    4            IF OFF ~= 0 THEN
      359    17497    4              CALL Z8AF$NEW_OFF (STRING$ -> ETT.LOP -> ETT.LOP,
      360    17498    4                                 STRING$ -> ETT.LOP -> ETT.OFFSET.VALUE + OFF,
      361    17499    4                                 OFF$);
      362    17500    4            ELSE
      363    17501    4              OFF$ = STRING$ -> ETT.LOP;
      364    17502
      365    17503    4            IF VARIABLE_START THEN
      366    17504    4              CALL Z8AF$FORME(%ADI, STRING$->ETT.ROP, START$, START$) ;
      367    17505    4            ELSE
      368    17506    4              START$ = STRING$ -> ETT.ROP;
      369    17507
      370    17508    4            CALL Z8AF$FORME (%SSOP, OFF$, START$, START$);
      371    17509    4          END;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:36   
      372    17510    3        ELSE
      373    17511    3          START$ = STRING$;
      374    17512
      375    17513        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:37   
      376    17514    3      CASE(%OFF);
      377    17515    3        CALL OFFSET_OVERFLOW_CHECK (OFF, START$ -> ETT.OFFSET.VALUE,
      378    17516    3                                    START$, VARIABLE_START, STRING$);
      379    17517
      380    17518    3        IF VARIABLE_START THEN
      381    17519    3          IF SBCHK_FLAG THEN
      382    17520    3            CALL Z8AF$NEW_OFF_AND_SSOP (STRING$, OFF, START$, START$);
      383    17521    3          ELSE
      384    17522    3            CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK(STRING$, OFF, START$, START$);
      385    17523    3        ELSE
      386    17524    3          CALL Z8AF$NEW_OFF (STRING$ -> ETT.LOP,
      387    17525    3                             STRING$ -> ETT.OFFSET.VALUE + OFF,
      388    17526    3                             START$);
      389    17527
      390    17528        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:38   
      391    17529    3      CASE(%BASE, ELSE);
      392    17530    3        CALL OFFSET_OVERFLOW_CHECK (OFF, 0, START$, VARIABLE_START, STRING$);
      393    17531
      394    17532    3        IF VARIABLE_START THEN
      395    17533    3          IF SBCHK_FLAG THEN
      396    17534    3            CALL Z8AF$NEW_OFF_AND_SSOP (STRING$, OFF, START$, START$);
      397    17535    3          ELSE
      398    17536    3            CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK(STRING$, OFF, START$, START$);
      399    17537    3        ELSE
      400    17538    3          IF OFF ~= 0 THEN
      401    17539    3            CALL Z8AF$NEW_OFF (STRING$, OFF, START$);
      402    17540    3          ELSE
      403    17541    3            START$ = STRING$;
      404    17542        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:39   
      405    17543    3      CASE (%TRIAD);
      406    17544    3        CALL OFFSET_OVERFLOW_CHECK (OFF, 0, START$, VARIABLE_START, STRING$);
      407    17545    3        IF OFF ~= 0
      408    17546    3        OR VARIABLE_START THEN
      409    17547    4          DO;
      410    17548    4            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, TEMP$);
      411    17549    4            TEMP$ -> ETT.LOP -> SCALAR.TYPE   = %TYA;
      412    17550    4            TEMP$ -> ETT.LOP -> SCALAR.ADSC.N = STRING_ST$ -> SCALAR.ADSC.N;
      413    17551
      414    17552                 %NEW_ILL (@ID  = %PRESET,
      415    17553                           @ROP = STRING$ -> ETT.LOP,
      416    17554                           @LOP = TEMP$ -> ETT.LOP);
      417    17933
      418    17934    4            IF VARIABLE_START THEN
      419    17935    4              IF SBCHK_FLAG THEN
      420    17936    4                CALL Z8AF$NEW_OFF_AND_SSOP (TEMP$, OFF, START$, START$);
      421    17937    4              ELSE
      422    17938    4                CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK(TEMP$, OFF, START$, START$);
      423    17939    4            ELSE /* NOT VARIABLE_START */
      424    17940    4              CALL Z8AF$NEW_OFF (TEMP$, OFF, START$);
      425    17941    4          END;
      426    17942    3        ELSE
      427    17943    3          START$ = STRING$;
      428    17944
      429    17945
      430    17946        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:40   
      431    17947    3      CASE (%SIZ, %FISS, %REFMOD); /*#28637*/
      432    17948    3        CALL OFFSET_OVERFLOW_CHECK (OFF, 0, START$, VARIABLE_START, STRING$);
      433    17949
      434    17950    3        IF VARIABLE_START THEN
      435    17951    3          IF SBCHK_FLAG THEN
      436    17952    3            CALL Z8AF$NEW_OFF_AND_SSOP (STRING$, OFF, START$, START$);
      437    17953    3          ELSE
      438    17954    3            CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK (STRING$, OFF, START$, START$);
      439    17955    3        ELSE
      440    17956    3          IF OFF ~= 0 THEN
      441    17957    3            CALL Z8AF$NEW_OFF (STRING$ -> ETT.LOP, OFF, START$);
      442    17958    3          ELSE
      443    17959    3            START$ = STRING$ -> ETT.LOP;
      444    17960
      445    17961    3    END; /* Case -- ident$ -> ill.id */
      446    17962    2   END CREATE_START_POSITION;  /*  proc  */
      447    17963        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:41   
      448    17964        %MACRO CREATE_LENGTH_ITEMS (@FISS      = FISS,
      449    17965                                    @SIZ$      = SIZ$,
      450    17966                                    @START_AT$ = STRT_POS$,
      451    17967                                    @RETURN$   = VAR$ -> LX_ETT_ITEM.ETT$);
      452    17968
      453    17969         IF SIZ$ = ADDR(NIL) THEN
      454    17970           CALL Z8AF$NEW_FISS (@START_AT$, @FISS, %ALPHA_NUMERIC_FISS, @RETURN$);
      455    17971         ELSE
      456    17972           CALL Z8AF$FORME (%REFMOD, @START_AT$, @SIZ$, @RETURN$); /*#28637*/
      457    17973        %MEND;
      458    17974        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:42   
      459    17975    1    SBCHK_FLAG = TRUE;
      460    17976    1    CONV_FLAG = TRUE;
      461    17977    1    GOTO START_Z8EY_SUBSTR;
      462    17978         /**/
      463    17979    1   Z8EY$SUBSTR_NO_SBCHK: ENTRY (VAR$$, START$$, LENGTH$$, RETURN$); /*#42050*/
      464    17980    1    SBCHK_FLAG = FALSE;
      465    17981    1    CONV_FLAG = TRUE;
      466    17982    1    GOTO START_Z8EY_SUBSTR;
      467    17983         /**/
      468    17984    1   Z8EY$INSERT: ENTRY (VAR$$, START$$, LENGTH$$, RETURN$);
      469    17985    1    SBCHK_FLAG = FALSE;
      470    17986    1    CONV_FLAG = FALSE;
      471    17987
      472    17988    1   START_Z8EY_SUBSTR:
      473    17989         %FISH (TRIAD = VAR$$ -> LX_ETT_ITEM.ETT$,
      474    17990                RTN = VAR_ST$);
      475    17998
      476    17999    1    IF VAR_ST$ -> SCALAR.B.KANJI AND SBCHK_FLAG THEN
      477    18000           /* SBCHK_FLAG false only for INSPECT, EXAMINE -- no KANJI check needed, either */
      478    18001    2      DO;
      479    18002    2        BYTE_SIZE = 2;
      480    18003    2        START$ = ADDR( OFFSET_TIMES_2 );
      481    18004    2        TWO$ = ADDR( TWO );
      482    18005    2        CALL Z8AC$LX_ETT_ITEM_TYI_CONST (2, TWO$);
      483    18006             %INIT_BINARY_OP (@POINTER = START$,
      484    18007                              @OP      = %OP_STAR,
      485    18008                              @LOP$    = START$$,
      486    18009                              @ROP$    = TWO$);
      487    18027    2      END;
      488    18028    1    ELSE
      489    18029    2      DO;
      490    18030    2        BYTE_SIZE = 1;
      491    18031    2        START$ = START$$;
      492    18032    2      END;
      493    18033
      494    18034    1    VAR$ = ADDR(SUBSTR_VAR);
      495    18035    1    VAR$ -> LX_ETT_ITEM = VAR$$ -> LX_ETT_ITEM;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:43   
      496    18036
      497    18037    1    CALL Z8E5$MATH_PACK (START$, ADDR(START_POS));
      498    18038    1    CALL Z8EQ$CHECK_FOR_INTEGER_ITEM (ADDR(START_POS),
      499    18039    1                                      %E$ONLY_INT_EXPR_FOR_REFMOD);
      500    18040
      501    18041    1    IF LENGTH$$ ~= ADDR(NIL) THEN   /* LENGTH_SPECIFIED */
      502    18042    2      DO;
      503    18043    2        IF BYTE_SIZE = 2 THEN /* KANJI */
      504    18044    3          DO;
      505    18045    3            LENGTH$ = ADDR(LENGTH_TIMES_2);
      506    18046                 %INIT_BINARY_OP (@POINTER = LENGTH$,
      507    18047                                  @OP      = %OP_STAR,
      508    18048                                  @LOP$    = LENGTH$$,
      509    18049                                  @ROP$    = TWO$);
      510    18067    3          END;
      511    18068    2        ELSE
      512    18069    2          LENGTH$ = LENGTH$$;
      513    18070    2        CALL Z8E5$MATH_PACK (LENGTH$, ADDR(LENGTH));
      514    18071    2        CALL Z8EQ$CHECK_FOR_INTEGER_ITEM (ADDR(LENGTH),
      515    18072    2                                          %E$ONLY_INT_EXPR_FOR_REFMOD);
      516    18073    2        LENGTH$ = ADDR(LENGTH);
      517    18074    2      END;
      518    18075    1    ELSE
      519    18076    1      LENGTH$ = ADDR(NIL);
      520    18077
      521    18078    1    CALL Z8CO$DISPL_CHECK (VAR$)
      522    18079    1      WHENALTRETURN
      523    18080    2        DO;
      524    18081    2          IF VAR$ -> LX_ETT_ITEM.TYPE ~= %TYX AND
      525    18082    2             VAR$ -> LX_ETT_ITEM.TYPE ~= %TYY THEN /* Prevent unexpected case */
      526    18083    2            CALL Z8EV$CONVERT (%TYA, VAR$, VAR$);
      527    18084
      528    18085               %INIT_LX_ETT_ITEM (@POINTER = RETURN$,
      529    18086                                  @ETT$    = VAR$ -> LX_ETT_ITEM.ETT$,
      530    18087                                  @TYPE    = %TYA,
      531    18088                                  @LINE    = VAR$ -> LX_ETT_ITEM.LINE,
      532    18089                                  @COLUMN  = VAR$ -> LX_ETT_ITEM.COLUMN);
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:44   
      533    18111    2          RETURN;
      534    18112    2        END;
      535    18113
      536    18114
      537    18115    1    STRT_POS$ = ADDR(START_POS) -> LX_ETT_ITEM.ETT$;
      538    18116
      539    18117    1    IF LENGTH$ ~= ADDR(NIL) THEN
      540    18118    1      LENGTH$ = LENGTH$ -> LX_ETT_ITEM.ETT$;
      541    18119
      542    18120    1    STRING$   = VAR$ -> LX_ETT_ITEM.ETT$;
      543    18121
      544    18122         %FISH (TRIAD = STRING$,
      545    18123                RTN   = STRING_ST$);
      546    18131
      547    18132    1    FISS   = 0;
      548    18133    1    SIZ$   = ADDR(NIL);
      549    18134
      550    18135    2    DO CASE (STRING_ST$ -> VARIABLE.TYPE);
      551    18136    2      CASE (%TYA, %TYN, %TYB, %TYE);
      552    18137             %GET_ADSC_LEN (ST$ = STRING_ST$,
      553    18138                            RTN = MAXLEN);
      554    18149    2      CASE (ELSE);
      555    18150    2        MAXLEN = STRING_ST$ -> VARIABLE.NDSC.N;
      556    18151    2    END;
      557    18152    1    IF LENGTH$ = ADDR(NIL) THEN
      558    18153    1      CALL GET_IMPLIED_LENGTH (STRING$, STRT_POS$, FISS, SIZ$);
      559    18154    1    ELSE
      560    18155           %GET_SPECIFIED_LENGTH (@LENGTH$ = LENGTH$,
      561    18156                                  @FISS    = FISS,
      562    18157                                  @SIZ$    = SIZ$);
      563    18166
      564    18167    2    IF COMCOM.OB.SUBCHK AND STRT_POS$ -> ETT.ID = %TRIAD THEN DO;
      565    18168    2      OFF = STRT_POS$ -> ETT.LOP -> CONST.CONSTI.WORD1;
      566    18169    2      IF LENGTH$ ~= ADDR(NIL) THEN
      567    18170    2        IF LENGTH$ -> ETT.ID = %TRIAD THEN
      568    18171    2          OFF = OFF + LENGTH$ -> ETT.LOP -> CONST.CONSTI.WORD1 - 1;
      569    18172    2      IF OFF > MAXLEN THEN
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:45   
      570    18173    2        CALL Z8AE$ERROR (%E$REFMOD_OUT_OF_BOUNDS);
      571    18174    2    END;
      572    18175
      573    18176    1    IF (VAR$ -> LX_ETT_ITEM.TYPE = %TYB OR VAR$ -> LX_ETT_ITEM.TYPE = %TYE)
      574    18177    1        AND CONV_FLAG THEN
      575    18178    2      DO;
      576    18179    2        IF VAR$ -> LX_ETT_ITEM.TYPE = %TYB
      577    18180    2          THEN OP = %OP_GBCD_TO_ASCII;
      578    18181    2          ELSE OP = %OP_EBCDIC_TO_ASCII;
      579    18182    2        CALL Z8CO$CREATE_LIBRARY_BASE (OP, TABLE_ETT$);
      580    18183    2        CALL Z8AF$FORME (%CVT,
      581    18184    2                         STRING$,
      582    18185    2                         TABLE_ETT$,
      583    18186    2                         STRING$);
      584    18187    2        VAR$ -> LX_ETT_ITEM.TYPE = %TYA;
      585    18188             /* Needed in case result assigned to numeric variable */
      586    18189    2      END;
      587    18190
      588    18191    1    OFF    = 0;
      589    18192
      590    18193    1    CALL CREATE_START_POSITION (STRING$, OFF, STRT_POS$);
      591    18194
      592    18195    2    DO CASE (VAR$ -> LX_ETT_ITEM.TYPE);
      593    18196    2      CASE (%TYA, %TYN, %TYB, %TYE);
      594    18197    2        TYPE = VAR$ -> LX_ETT_ITEM.TYPE;
      595    18198    2      CASE (ELSE);
      596    18199    2        CALL Z8AF$FORME (%DNA,
      597    18200    2                         STRT_POS$,
      598    18201    2                         0,
      599    18202    2                         STRT_POS$);
      600    18203    2        TYPE = %TYA;
      601    18204    2      END;
      602    18205
      603    18206         %CREATE_LENGTH_ITEMS (@FISS      = FISS,
      604    18207                               @SIZ$      = SIZ$,
      605    18208                               @START_AT$ = STRT_POS$,
      606    18209                               @RETURN$   = VAR$ -> LX_ETT_ITEM.ETT$);
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:46   
      607    18215
      608    18216         %INIT_LX_ETT_ITEM (@POINTER = RETURN$,
      609    18217                            @REFMOD  = TRUE,
      610    18218                            @ETT$    = VAR$ -> LX_ETT_ITEM.ETT$,
      611    18219                            @TYPE    = TYPE,
      612    18220                            @LINE    = VAR$ -> LX_ETT_ITEM.LINE,
      613    18221                            @COLUMN  = VAR$ -> LX_ETT_ITEM.COLUMN);
      614    18243
      615    18244    1     RETURN;
      616    18245
      617    18246    1   END Z8EY$SUBSTR;
      618    18247        %EOD;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:47   
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_SRCH.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$SUBSTR.

   Procedure Z8EY$SUBSTR requires 1197 words for executable code.
   Procedure Z8EY$SUBSTR requires 116 words of local(AUTO) storage.

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:48   

 Object Unit name= Z8EY$SUBSTR                                File name= Z8EY.:Z8A6TOU
 UTS= AUG 09 '97 13:00:37.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ETT$
    2  LblCom even  none     1      1  HEAD_ETT$
    3  LblCom even  none   512   1000  ETT_BUCKETS
    4  LblCom even  none     5      5  ETT_
    5  LblCom even  none     3      3  SRCH
    6  LblCom even  none     1      1  ILL$
    7  LblCom even  none     5      5  ILL_
    8  LblCom even  none     1      1  ILS$
    9  LblCom even  none     5      5  ILS_
   10  LblCom even  none     1      1  ST$
   11  LblCom even  none     5      5  ST_
   12  LblCom even  none     1      1  DNT$
   13  LblCom even  none     5      5  DNT_
   14  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   15  LblCom even  none     1      1  DNT_OF_1$
   16  LblCom even  none     1      1  LTS$
   17  LblCom even  none     5      5  LTS_
   18  LblCom even  none    90    132  LEX_SYMBOL
   19  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   20  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   21  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   22  LblCom even  none     2      2  MKCN
   23   Proc  even  none  1197   2255  Z8EY$SUBSTR
   24  RoData even  none    40     50  Z8EY$SUBSTR
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:49   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    23      0   yes            yes      Std        4  Z8EY$SUBSTR
    23   1327                  yes      Std        4  Z8EY$SUBSTR_NO_SBCHK
    23   1335                  yes      Std        4  Z8EY$INSERT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 Z8AC$LX_ETT_ITEM_TYI_CONST
 yes     yes           Std       2 Z8EQ$CHECK_FOR_INTEGER_ITEM
         yes           Std       3 Z8EV$CONVERT
         yes           Std      12 Z8AE$ERROR
         yes           Std       2 Z8CO$CREATE_LIBRARY_BASE
         yes           Std       4 Z8AF$NEW_FISS
         yes           Std       4 Z8AF$FORME
         yes           Std       2 Z8E5$MATH_PACK
 yes     yes           Std       1 Z8CO$DISPL_CHECK
         yes           Std       2 Z8AU$TYPE_DESCRIPTOR
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       3 Z8AF$NEW_OFF
         yes           Std       4 Z8AF$NEW_OFF_AND_SSOP
         yes           Std       4 Z8AN$NEW_ILL
         yes           Std       4 Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
         yes           Std       2 Z8AT$CREATE_TEMP_WITH_BASE
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:50   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    ILL_STEP                         r    ILS_STEP_TABLE
r    LTS_STEP                              O1COM                                 HIER_STK_PTR
     HIER_STK                              PAGE_FORMAT                           REP_STK_PTR
     REP_STK

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:51   


       77        1        /*T***********************************************************/
       78        2        /*T*                                                         */
       79        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       80        4        /*T*                                                         */
       81        5        /*T***********************************************************/
       82        6        Z8EY$SUBSTR: PROC (VAR$$, START$$, LENGTH$$, RETURN$);

      6 23 000000   000000 700200 xent  Z8EY$SUBSTR  TSX0  ! X66_AUTO_4
        23 000001   000164 000004                    ZERO    116,4
        23 000002   001323 710000 23                 TRA     s:17975

       83        7
       84        8        %EQU PHASE = 1;
       85        9        %EQU LENGTH_SPECIFIED = 2;
       86       10
       87       11        %INCLUDE Z8A_DEFC;
       88       79        %INCLUDE Z9A_FLAGS;
       89       93        %INCLUDE Z8A_SUPP_MAC;
       90     2493        %INCLUDE Z8A_ERR_NUMS;
       91     3257        %INCLUDE Z8A_COMCOM;
       92     3907        %INCLUDE Z8A_ETT;
       93     4208        %INCLUDE Z8A_SRCH;
       94     4257        %INCLUDE Z8A_ILL;
       95     4950        %INCLUDE Z8A_ILS;
       96     5059        %INCLUDE Z8A_LIBRARY;
       97     5273        %INCLUDE Z8A_ST;
       98     8932        %INCLUDE Z8A_TYPES;
       99     9106        %INCLUDE Z8A_DNT;
      100     9327        %INCLUDE Z8E_WINDOW;
      101    11397        %INCLUDE Z8E_MACROS;
      102    12072        %INCLUDE Z8A_LTS;
      103    14149        %INCLUDE Z8E_STACKS;
      104    16415        %INCLUDE Z8E_O1COM;
      105    17176
      106    17177    1   DCL Z8AC$MAKE_CONST           ENTRY(1);
      107    17178    1   DCL Z8AC$LX_ETT_ITEM_TYI_CONST ENTRY(2);
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:52   
      108    17179    1   DCL Z8AU$TYPE_DESCRIPTOR      ENTRY(2);
      109    17180    1   DCL Z8EQ$CHECK_FOR_INTEGER_ITEM      ENTRY (2) ALTRET;
      110    17181    1   DCL Z8AF$NEW_OFF              ENTRY (3);
      111    17182    1   DCL Z8AF$NEW_FISS             ENTRY (4);
      112    17183    1   DCL Z8AF$NEW_OFF_AND_SSOP     ENTRY (4);
      113    17184    1   DCL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK ENTRY (4);
      114    17185    1   DCL Z8AT$CREATE_TEMP_WITH_BASE ENTRY(2);
      115    17186    1   DCL Z8AE$ERROR                ENTRY(12);
      116    17187    1   DCL Z8AF$FORME                ENTRY(4);
      117    17188    1   DCL Z8EV$CONVERT              ENTRY(3);
      118    17189    1   DCL Z8E5$MATH_PACK            ENTRY(2);
      119    17190    1   DCL Z8CO$DISPL_CHECK          ENTRY(1) ALTRET;
      120    17191    1   DCL Z8CO$CREATE_LIBRARY_BASE  ENTRY(2);
      121    17192
      122    17193    1   DCL START$$                   PTR;
      123    17194    1   DCL LENGTH$$                  PTR;
      124    17195    1   DCL VAR$$                     PTR;
      125    17196    1   DCL RETURN$                   PTR;
      126    17197
      127    17198    1   DCL START$                    PTR;
      128    17199        %DCL_AUTO_LX_ITEM (@NAME = START_POS);
      129    17203        %DCL_AUTO_LX_ITEM (@NAME = LENGTH);
      130    17207        %DCL_AUTO_LX_ITEM (@NAME = SUBSTR_VAR);
      131    17211        %DCL_AUTO_LX_ITEM (@NAME = OFFSET_TIMES_2);
      132    17215        %DCL_AUTO_LX_ITEM (@NAME = LENGTH_TIMES_2);
      133    17219        %DCL_AUTO_LX_ITEM (@NAME = TWO);
      134    17223    1   DCL VAR_ST$                   PTR;
      135    17224    1   DCL TWO$                      PTR;
      136    17225    1   DCL LENGTH$                   PTR;
      137    17226    1   DCL STRING$                   PTR;
      138    17227    1   DCL VAR$                      PTR;
      139    17228    1   DCL STRT_POS$                 PTR;
      140    17229    1   DCL TEMP$                     PTR;
      141    17230    1   DCL STRING_ST$                PTR;
      142    17231    1   DCL SIZ$                      PTR;
      143    17232    1   DCL TABLE_ETT$                PTR;
      144    17233    1   DCL CONV_FLAG                 BOOLEAN;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:53   
      145    17234
      146    17235        %INCLUDE Z8A_MKCN;
      147    17252    1   DCL OFF                       SBIN WORD;
      148    17253    1   DCL FISS                      SBIN WORD;
      149    17254    1   DCL TYPE                      SBIN WORD;
      150    17255    1   DCL BYTE_SIZE                 SBIN WORD;
      151    17256    1   DCL SBCHK_FLAG                BIT(1);
      152    17257    1   DCL MAXLEN                    SBIN;
      153    17258    1   DCL OP                        SBIN WORD;
      154    17259        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:54   
      155    17260
      156    17261        %MACRO GET_SPECIFIED_LENGTH (@LENGTH$  = LENGTH$,
      157    17262                                     @FISS     = FISS,
      158    17263                                     @SIZ$     = SIZ$);
      159    17264           DO;
      160    17265             IF @LENGTH$ -> ETT.ID = %TRIAD
      161    17266             AND @LENGTH$ -> ETT.LOP -> CONST.CONSTI.WORD1 < %#4K THEN
      162    17267               @FISS = @LENGTH$ -> ETT.LOP -> CONST.CONSTI.WORD1;
      163    17268             ELSE
      164    17269               @SIZ$ = @LENGTH$;
      165    17270           END;
      166    17271        %MEND;
      167    17272        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:55   
      168    17273    1   GET_LENGTH: PROC (STRING$, LENGTH, SIZ$);

  17273 23 000003   200146 741300       GET_LENGTH   STX1  ! SIZ$+1,,AUTO

      169    17274
      170    17275    2   DCL STRING$                   PTR;
      171    17276    2   DCL SIZ$                      PTR;
      172    17277    2   DCL LENGTH                    SBIN WORD;
      173    17278    2   DCL 1 TYPE_DESC               ALIGNED,
      174    17279             %TYPE_DESC;
      175    17313
      176    17314    2    LENGTH = 0;

  17314 23 000004   200150 470500                    LDP0    @LENGTH,,AUTO
        23 000005   000000 450100                    STZ     0,,PR0

      177    17315    2    SIZ$ = ADDR(NIL);

  17315 23 000006   000000 236000 24                 LDQ     0
        23 000007   200151 471500                    LDP1    @SIZ$,,AUTO
        23 000010   100000 756100                    STQ     0,,PR1

      178    17316
      179    17317    2    CALL Z8AU$TYPE_DESCRIPTOR (STRING$, TYPE_DESC);

  17317 23 000011   200152 633500                    EPPR3   TYPE_DESC,,AUTO
        23 000012   200157 453500                    STP3    TYPE_DESC+5,,AUTO
        23 000013   200147 236100                    LDQ     @STRING$,,AUTO
        23 000014   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000015   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000016   000001 631400 24                 EPPR1   1
        23 000017   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        23 000020   000000 011000                    NOP     0

      180    17318
      181    17319    3    IF TYPE_DESC.SIZ$ ~= ADDR(NIL) THEN DO;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:56   
  17319 23 000021   200154 236100                    LDQ     TYPE_DESC+2,,AUTO
        23 000022   000000 116000 24                 CMPQ    0
        23 000023   000037 600000 23                 TZE     s:17325

      182    17320    3        SIZ$ = TYPE_DESC.SIZ$;

  17320 23 000024   200151 470500                    LDP0    @SIZ$,,AUTO
        23 000025   000000 756100                    STQ     0,,PR0

      183    17321    3        IF TYPE_DESC.SIZ$ -> ETT.ID = %TRIAD THEN /* Constant */

  17321 23 000026   200154 471500                    LDP1    TYPE_DESC+2,,AUTO
        23 000027   100000 220100                    LDX0    0,,PR1
        23 000030   000015 100003                    CMPX0   13,DU
        23 000031   000066 601000 23                 TNZ     s:17332

      184    17322    3        LENGTH = TYPE_DESC.SIZ$ -> ETT.LOP -> CONST.CONSTI.WORD1;

  17322 23 000032   100001 473500                    LDP3    1,,PR1
        23 000033   200150 474500                    LDP4    @LENGTH,,AUTO
        23 000034   300010 235100                    LDA     8,,PR3
        23 000035   400000 755100                    STA     0,,PR4

      185    17323    3    END;

  17323 23 000036   000066 710000 23                 TRA     s:17332

      186    17324    2    ELSE
      187    17325    3      DO CASE (TYPE_DESC.TYPE);

  17325 23 000037   200152 235100                    LDA     TYPE_DESC,,AUTO
        23 000040   000006 135007                    SBLA    6,DL
        23 000041   000011 115007                    CMPA    9,DL
        23 000042   000044 602005 23                 TNC     s:17325+5,AL
        23 000043   000062 710000 23                 TRA     s:17329
        23 000044   000055 710000 23                 TRA     s:17327
        23 000045   000062 710000 23                 TRA     s:17329
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:57   
        23 000046   000055 710000 23                 TRA     s:17327
        23 000047   000062 710000 23                 TRA     s:17329
        23 000050   000062 710000 23                 TRA     s:17329
        23 000051   000062 710000 23                 TRA     s:17329
        23 000052   000055 710000 23                 TRA     s:17327
        23 000053   000062 710000 23                 TRA     s:17329
        23 000054   000055 710000 23                 TRA     s:17327

      188    17326    3        CASE (%TYA, %TYN, %TYB, %TYE);

      189    17327    3          LENGTH = TYPE_DESC.DESC.ADSC.N;

  17327 23 000055   200153 236100                    LDQ     TYPE_DESC+1,,AUTO
        23 000056   007777 376007                    ANQ     4095,DL
        23 000057   200150 470500                    LDP0    @LENGTH,,AUTO
        23 000060   000000 756100                    STQ     0,,PR0
        23 000061   000066 710000 23                 TRA     s:17332

      190    17328    3        CASE (ELSE);

      191    17329    3          LENGTH = TYPE_DESC.DESC.NDSC.N;

  17329 23 000062   200153 236100                    LDQ     TYPE_DESC+1,,AUTO
        23 000063   000077 376007                    ANQ     63,DL
        23 000064   200150 470500                    LDP0    @LENGTH,,AUTO
        23 000065   000000 756100                    STQ     0,,PR0

      192    17330    3      END;

      193    17331
      194    17332    2   END; /* PROC -- GET_LENGTH */

  17332 23 000066   200146 221300                    LDX1  ! SIZ$+1,,AUTO
        23 000067   000001 702211                    TSX2  ! 1,X1

      195    17333        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:58   
      196    17334    1   GET_IMPLIED_LENGTH: PROC (STRING$, STRT_POS$, FISS, SIZ$);

  17334 23 000070   200124 741300       GET_IMPLIED* STX1  ! OP+1,,AUTO

      197    17335
      198    17336    2   DCL STRING$                   PTR;
      199    17337    2   DCL SIZ$                      PTR;
      200    17338    2   DCL FISS                      SBIN WORD;
      201    17339    2   DCL STRT_POS$                 PTR;
      202    17340
      203    17341    2   DCL ST$$                      PTR;
      204    17342    2   DCL LENGTH                    SBIN WORD;
      205    17343    2    CALL GET_LENGTH (STRING$, LENGTH, SIZ$);

  17343 23 000071   200130 236100                    LDQ     @SIZ$,,AUTO
        23 000072   200151 756100                    STQ     @SIZ$,,AUTO
        23 000073   200132 630500                    EPPR0   LENGTH,,AUTO
        23 000074   200150 450500                    STP0    @LENGTH,,AUTO
        23 000075   200125 236100                    LDQ     @STRING$,,AUTO
        23 000076   200147 756100                    STQ     @STRING$,,AUTO
        23 000077   000003 701000 23                 TSX1    GET_LENGTH
        23 000100   000000 011000                    NOP     0

      206    17344
      207    17345    2    IF LENGTH ~= 0 THEN

  17345 23 000101   200132 235100                    LDA     LENGTH,,AUTO
        23 000102   000157 600000 23                 TZE     s:17367

      208    17346    3      DO;

      209    17347    3        IF STRT_POS$ -> ETT.ID = %TRIAD THEN

  17347 23 000103   200126 470500                    LDP0    @STRT_POS$,,AUTO
        23 000104   000000 471500                    LDP1    0,,PR0
        23 000105   100000 220100                    LDX0    0,,PR1
        23 000106   000015 100003                    CMPX0   13,DU
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:59   
        23 000107   000132 601000 23                 TNZ     s:17360

      210    17348    4          DO;

      211    17349    4            FISS = LENGTH + BYTE_SIZE - STRT_POS$ -> ETT.LOP -> CONST.CONSTI.WORD1;

  17349 23 000110   200132 236100                    LDQ     LENGTH,,AUTO
        23 000111   200120 036100                    ADLQ    BYTE_SIZE,,AUTO
        23 000112   100001 473500                    LDP3    1,,PR1
        23 000113   300010 136100                    SBLQ    8,,PR3
        23 000114   200127 474500                    LDP4    @FISS,,AUTO
        23 000115   400000 756100                    STQ     0,,PR4

      212    17350    4            IF FISS < %#4K THEN

  17350 23 000116   010000 116007                    CMPQ    4096,DL
        23 000117   000124 605000 23                 TPL     s:17354

      213    17351    4              SIZ$ = ADDR(NIL);

  17351 23 000120   000000 236000 24                 LDQ     0
        23 000121   200130 471500                    LDP1    @SIZ$,,AUTO
        23 000122   100000 756100                    STQ     0,,PR1
        23 000123   000203 710000 23                 TRA     s:17371

      214    17352    4            ELSE
      215    17353    5              DO;

      216    17354    5                MKCN.CON = FISS;

  17354 23 000124   000000 756000 22                 STQ     MKCN

      217    17355    5                CALL Z8AC$MAKE_CONST(SIZ$);

  17355 23 000125   200130 630500                    EPPR0   @SIZ$,,AUTO
        23 000126   000002 631400 24                 EPPR1   2
        23 000127   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:60   
        23 000130   000000 011000                    NOP     0

      218    17356    5              END;

      219    17357    4           END;

  17357 23 000131   000203 710000 23                 TRA     s:17371

      220    17358    3        ELSE
      221    17359    4          DO;

      222    17360    4            MKCN.CON = LENGTH + BYTE_SIZE; /* BYTE_SIZE = 1 or 2 */

  17360 23 000132   200132 236100                    LDQ     LENGTH,,AUTO
        23 000133   200120 036100                    ADLQ    BYTE_SIZE,,AUTO
        23 000134   000000 756000 22                 STQ     MKCN

      223    17361    4            CALL Z8AC$MAKE_CONST(ST$$);

  17361 23 000135   200131 631500                    EPPR1   ST$$,,AUTO
        23 000136   200156 451500                    STP1    TYPE_DESC+4,,AUTO
        23 000137   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000140   000002 631400 24                 EPPR1   2
        23 000141   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        23 000142   000000 011000                    NOP     0

      224    17362    4            CALL Z8AF$FORME(%SBI, ST$$, STRT_POS$, SIZ$) ;

  17362 23 000143   200130 236100                    LDQ     @SIZ$,,AUTO
        23 000144   200126 235100                    LDA     @STRT_POS$,,AUTO
        23 000145   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000146   200131 630500                    EPPR0   ST$$,,AUTO
        23 000147   200157 450500                    STP0    TYPE_DESC+5,,AUTO
        23 000150   000005 236000 24                 LDQ     5
        23 000151   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000152   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000153   000003 631400 24                 EPPR1   3
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:61   
        23 000154   000000 701000 xent               TSX1    Z8AF$FORME
        23 000155   000000 011000                    NOP     0

      225    17363    4          END;

      226    17364    3      END;

  17364 23 000156   000203 710000 23                 TRA     s:17371

      227    17365    2    ELSE
      228    17366    3      DO;

      229    17367    3        CALL Z8AF$FORME (%ADI, SIZ$, COMCOM.VALUE_1, SIZ$);

  17367 23 000157   200130 236100                    LDQ     @SIZ$,,AUTO
        23 000160   000007 235000 24                 LDA     7
        23 000161   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000162   200130 236100                    LDQ     @SIZ$,,AUTO
        23 000163   000010 235000 24                 LDA     8
        23 000164   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 000165   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000166   000003 631400 24                 EPPR1   3
        23 000167   000000 701000 xent               TSX1    Z8AF$FORME
        23 000170   000000 011000                    NOP     0

      230    17368    3        CALL Z8AF$FORME (%SBI, SIZ$, STRT_POS$, SIZ$);

  17368 23 000171   200130 236100                    LDQ     @SIZ$,,AUTO
        23 000172   200126 235100                    LDA     @STRT_POS$,,AUTO
        23 000173   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000174   200130 236100                    LDQ     @SIZ$,,AUTO
        23 000175   000005 235000 24                 LDA     5
        23 000176   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 000177   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000200   000003 631400 24                 EPPR1   3
        23 000201   000000 701000 xent               TSX1    Z8AF$FORME
        23 000202   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:62   

      231    17369    3      END;

      232    17370
      233    17371    2   END; /* Proc -- get_implied_length */

  17371 23 000203   200124 221300                    LDX1  ! OP+1,,AUTO
        23 000204   000001 702211                    TSX2  ! 1,X1

      234    17372        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:63   
      235    17373    1   SET_UP_START_POS: PROC (START$, OFF, VARIABLE_START);

  17373 23 000205   200134 741300       SET_UP_STAR* STX1  ! VARIABLE_START+1,,AUTO

      236    17374
      237    17375    2   DCL START$             PTR;
      238    17376    2   DCL OFF                SBIN WORD;
      239    17377    2   DCL VARIABLE_START     BIT(1) ALIGNED;
      240    17378
      241    17379    3    DO CASE(START$ -> ETT.ID);

  17379 23 000206   200135 470500                    LDP0    @START$,,AUTO
        23 000207   000000 471500                    LDP1    0,,PR0
        23 000210   100000 236100                    LDQ     0,,PR1
        23 000211   000022 772000                    QRL     18
        23 000212   000015 136007                    SBLQ    13,DL
        23 000213   000042 116007                    CMPQ    34,DL
        23 000214   000216 602006 23                 TNC     s:17379+8,QL
        23 000215   000373 710000 23                 TRA     s:17416
        23 000216   000363 710000 23                 TRA     s:17412
        23 000217   000373 710000 23                 TRA     s:17416
        23 000220   000373 710000 23                 TRA     s:17416
        23 000221   000373 710000 23                 TRA     s:17416
        23 000222   000373 710000 23                 TRA     s:17416
        23 000223   000373 710000 23                 TRA     s:17416
        23 000224   000373 710000 23                 TRA     s:17416
        23 000225   000373 710000 23                 TRA     s:17416
        23 000226   000373 710000 23                 TRA     s:17416
        23 000227   000373 710000 23                 TRA     s:17416
        23 000230   000373 710000 23                 TRA     s:17416
        23 000231   000373 710000 23                 TRA     s:17416
        23 000232   000373 710000 23                 TRA     s:17416
        23 000233   000373 710000 23                 TRA     s:17416
        23 000234   000373 710000 23                 TRA     s:17416
        23 000235   000373 710000 23                 TRA     s:17416
        23 000236   000373 710000 23                 TRA     s:17416
        23 000237   000373 710000 23                 TRA     s:17416
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:64   
        23 000240   000373 710000 23                 TRA     s:17416
        23 000241   000373 710000 23                 TRA     s:17416
        23 000242   000373 710000 23                 TRA     s:17416
        23 000243   000373 710000 23                 TRA     s:17416
        23 000244   000373 710000 23                 TRA     s:17416
        23 000245   000373 710000 23                 TRA     s:17416
        23 000246   000373 710000 23                 TRA     s:17416
        23 000247   000373 710000 23                 TRA     s:17416
        23 000250   000373 710000 23                 TRA     s:17416
        23 000251   000373 710000 23                 TRA     s:17416
        23 000252   000373 710000 23                 TRA     s:17416
        23 000253   000373 710000 23                 TRA     s:17416
        23 000254   000373 710000 23                 TRA     s:17416
        23 000255   000260 710000 23                 TRA     s:17382
        23 000256   000373 710000 23                 TRA     s:17416
        23 000257   000304 710000 23                 TRA     s:17393

      242    17380
      243    17381    3      CASE(%ADI);

      244    17382    3        IF START$ -> ETT.ROP -> ETT.ID = %TRIAD THEN

  17382 23 000260   100002 473500                    LDP3    2,,PR1
        23 000261   300000 220100                    LDX0    0,,PR3
        23 000262   000015 100003                    CMPX0   13,DU
        23 000263   000275 601000 23                 TNZ     s:17388

      245    17383    4          DO;

      246    17384    4            OFF = START$ -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;

  17384 23 000264   300001 474500                    LDP4    1,,PR3
        23 000265   400010 236100                    LDQ     8,,PR4
        23 000266   200120 136100                    SBLQ    BYTE_SIZE,,AUTO
        23 000267   200136 475500                    LDP5    @OFF,,AUTO
        23 000270   500000 756100                    STQ     0,,PR5

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:65   
      247    17385    4            START$ = START$ -> ETT.LOP;

  17385 23 000271   000000 471500                    LDP1    0,,PR0
        23 000272   100001 236100                    LDQ     1,,PR1
        23 000273   000000 756100                    STQ     0,,PR0

      248    17386    4          END;

  17386 23 000274   000300 710000 23                 TRA     s:17390

      249    17387    3        ELSE
      250    17388    3          OFF = - BYTE_SIZE;    /* 1 or 2 */

  17388 23 000275   200136 474500                    LDP4    @OFF,,AUTO
        23 000276   200120 335100                    LCA     BYTE_SIZE,,AUTO
        23 000277   400000 755100                    STA     0,,PR4

      251    17389
      252    17390    3        VARIABLE_START = TRUE;

  17390 23 000300   400000 236003                    LDQ     -131072,DU
        23 000301   200137 471500                    LDP1    @VARIABLE_START,,AUTO
        23 000302   100000 756100                    STQ     0,,PR1
        23 000303   000401 710000 23                 TRA     s:17421

      253    17391
      254    17392    3      CASE(%SBI);

      255    17393    3        IF START$ -> ETT.LOP -> ETT.ID = %TRIAD THEN

  17393 23 000304   100001 473500                    LDP3    1,,PR1
        23 000305   300000 220100                    LDX0    0,,PR3
        23 000306   000015 100003                    CMPX0   13,DU
        23 000307   000335 601000 23                 TNZ     s:17401

      256    17394    4          DO;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:66   
      257    17395    4            OFF = START$ -> ETT.LOP -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;

  17395 23 000310   300001 474500                    LDP4    1,,PR3
        23 000311   400010 236100                    LDQ     8,,PR4
        23 000312   200120 136100                    SBLQ    BYTE_SIZE,,AUTO
        23 000313   200136 475500                    LDP5    @OFF,,AUTO
        23 000314   500000 756100                    STQ     0,,PR5

      258    17396    4            START$ = START$ -> ETT.ROP;

  17396 23 000315   000000 471500                    LDP1    0,,PR0
        23 000316   100002 236100                    LDQ     2,,PR1
        23 000317   000000 756100                    STQ     0,,PR0

      259    17397
      260    17398    4            CALL Z8AF$FORME (%USI, START$, ADDR(NIL), START$);

  17398 23 000320   000000 236000 24                 LDQ     0
        23 000321   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000322   200135 236100                    LDQ     @START$,,AUTO
        23 000323   200163 756100                    STQ     TYPE_DESC+9,,AUTO
        23 000324   200156 631500                    EPPR1   TYPE_DESC+4,,AUTO
        23 000325   200162 451500                    STP1    TYPE_DESC+8,,AUTO
        23 000326   000012 235000 24                 LDA     10
        23 000327   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000330   200160 630500                    EPPR0   TYPE_DESC+6,,AUTO
        23 000331   000003 631400 24                 EPPR1   3
        23 000332   000000 701000 xent               TSX1    Z8AF$FORME
        23 000333   000000 011000                    NOP     0

      261    17399    4          END;

  17399 23 000334   000357 710000 23                 TRA     s:17409

      262    17400    3        ELSE
      263    17401    3          IF START$ -> ETT.ROP -> ETT.ID = %TRIAD THEN

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:67   
  17401 23 000335   100002 474500                    LDP4    2,,PR1
        23 000336   400000 222100                    LDX2    0,,PR4
        23 000337   000015 102003                    CMPX2   13,DU
        23 000340   000354 601000 23                 TNZ     s:17407

      264    17402    4            DO;

      265    17403    4              OFF = - START$ -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;

  17403 23 000341   400001 475500                    LDP5    1,,PR4
        23 000342   500010 236100                    LDQ     8,,PR5
        23 000343   200120 036100                    ADLQ    BYTE_SIZE,,AUTO
        23 000344   000013 676000 24                 ERQ     11
        23 000345   000001 036007                    ADLQ    1,DL
        23 000346   200136 476500                    LDP6    @OFF,,AUTO
        23 000347   600000 756100                    STQ     0,,PR6

      266    17404    4              START$ = START$ -> ETT.LOP;

  17404 23 000350   000000 471500                    LDP1    0,,PR0
        23 000351   100001 236100                    LDQ     1,,PR1
        23 000352   000000 756100                    STQ     0,,PR0

      267    17405    4            END;

  17405 23 000353   000357 710000 23                 TRA     s:17409

      268    17406    3          ELSE
      269    17407    3            OFF = -BYTE_SIZE;   /* 1 or 2 */

  17407 23 000354   200136 475500                    LDP5    @OFF,,AUTO
        23 000355   200120 335100                    LCA     BYTE_SIZE,,AUTO
        23 000356   500000 755100                    STA     0,,PR5

      270    17408
      271    17409    3        VARIABLE_START = TRUE;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:68   
  17409 23 000357   400000 236003                    LDQ     -131072,DU
        23 000360   200137 470500                    LDP0    @VARIABLE_START,,AUTO
        23 000361   000000 756100                    STQ     0,,PR0
        23 000362   000401 710000 23                 TRA     s:17421

      272    17410
      273    17411    3      CASE(%TRIAD);

      274    17412    3        OFF = START$ -> ETT.LOP -> CONST.CONSTI.WORD1 - BYTE_SIZE;

  17412 23 000363   100001 473500                    LDP3    1,,PR1
        23 000364   300010 236100                    LDQ     8,,PR3
        23 000365   200120 136100                    SBLQ    BYTE_SIZE,,AUTO
        23 000366   200136 474500                    LDP4    @OFF,,AUTO
        23 000367   400000 756100                    STQ     0,,PR4

      275    17413    3        VARIABLE_START = FALSE;

  17413 23 000370   200137 471500                    LDP1    @VARIABLE_START,,AUTO
        23 000371   100000 450100                    STZ     0,,PR1
        23 000372   000401 710000 23                 TRA     s:17421

      276    17414
      277    17415    3      CASE(ELSE);

      278    17416    3        OFF = -BYTE_SIZE;       /* 1 or 2 */

  17416 23 000373   200136 473500                    LDP3    @OFF,,AUTO
        23 000374   200120 335100                    LCA     BYTE_SIZE,,AUTO
        23 000375   300000 755100                    STA     0,,PR3

      279    17417    3        VARIABLE_START = TRUE;

  17417 23 000376   400000 236003                    LDQ     -131072,DU
        23 000377   200137 471500                    LDP1    @VARIABLE_START,,AUTO
        23 000400   100000 756100                    STQ     0,,PR1

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:69   
      280    17418
      281    17419    3    END;

      282    17420
      283    17421    2   END SET_UP_START_POS; /* Proc */

  17421 23 000401   200134 221300                    LDX1  ! VARIABLE_START+1,,AUTO
        23 000402   000001 702211                    TSX2  ! 1,X1

      284    17422        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:70   
      285    17423    1   OFFSET_OVERFLOW_CHECK: PROC (OFF, PREV_OFF, START$, VARIABLE_START, STRING$);

  17423 23 000403   200134 741300       OFFSET_OVER* STX1  ! VARIABLE_START+1,,AUTO

      286    17424
      287    17425    2   DCL OFF                SBIN WORD;
      288    17426    2   DCL PREV_OFF           SBIN WORD;
      289    17427    2   DCL START$             PTR;
      290    17428    2   DCL VARIABLE_START     BIT(1) ALIGNED;
      291    17429    2   DCL STRING$            PTR;
      292    17430    2   DCL MAX_OFF_PRECISION  SBIN;
      293    17431
      294    17432    2   DCL OFF$               PTR;
      295    17433    2   DCL LENGTH             SBIN;
      296    17434    2   DCL SIZ$               PTR;
      297    17435
      298    17436
      299    17437         %IF CP6;
      300    17438    2      IF STRING_ST$ -> SCALAR.B.LINKAGE THEN

  17438 23 000404   200111 470500                    LDP0    STRING_ST$,,AUTO
        23 000405   000003 236100                    LDQ     3,,PR0
        23 000406   000002 316003                    CANQ    2,DU
        23 000407   000413 600000 23                 TZE     s:17443

      301    17439         %ENDIF;
      302    17440    2        MAX_OFF_PRECISION = %#16K;

  17440 23 000410   040000 235007                    LDA     16384,DL
        23 000411   200142 755100                    STA     MAX_OFF_PRECISION,,AUTO
        23 000412   000415 710000 23                 TRA     s:17446

      303    17441         %IF CP6;
      304    17442    2      ELSE
      305    17443    2        MAX_OFF_PRECISION = %#128K;

  17443 23 000413   400000 235007                    LDA     -131072,DL
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:71   
        23 000414   200142 755100                    STA     MAX_OFF_PRECISION,,AUTO

      306    17444         %ENDIF;
      307    17445
      308    17446    2      IF OFF + PREV_OFF > MAX_OFF_PRECISION

  17446 23 000415   200135 471500                    LDP1    @OFF,,AUTO
        23 000416   200136 473500                    LDP3    @PREV_OFF,,AUTO
        23 000417   100000 236100                    LDQ     0,,PR1
        23 000420   300000 036100                    ADLQ    0,,PR3
        23 000421   200142 116100                    CMPQ    MAX_OFF_PRECISION,,AUTO
        23 000422   000431 605400 23                 TPNZ    s:17449
        23 000423   100000 236100                    LDQ     0,,PR1
        23 000424   300000 036100                    ADLQ    0,,PR3
        23 000425   000000 531000                    NEG     0
        23 000426   200156 755100                    STA     TYPE_DESC+4,,AUTO
        23 000427   200156 116100                    CMPQ    TYPE_DESC+4,,AUTO
        23 000430   000530 605000 23                 TPL     s:17471

      309    17447    2      OR OFF + PREV_OFF < - MAX_OFF_PRECISION THEN
      310    17448    3        DO;

      311    17449    3          MKCN.CON = OFF;

  17449 23 000431   100000 235100                    LDA     0,,PR1
        23 000432   000000 755000 22                 STA     MKCN

      312    17450    3          CALL Z8AC$MAKE_CONST (OFF$);

  17450 23 000433   200143 634500                    EPPR4   OFF$,,AUTO
        23 000434   200156 454500                    STP4    TYPE_DESC+4,,AUTO
        23 000435   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000436   000002 631400 24                 EPPR1   2
        23 000437   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        23 000440   000000 011000                    NOP     0

      313    17451
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:72   
      314    17452    3          OFF = 0;

  17452 23 000441   200135 470500                    LDP0    @OFF,,AUTO
        23 000442   000000 450100                    STZ     0,,PR0

      315    17453
      316    17454    4          IF VARIABLE_START THEN DO;

  17454 23 000443   200140 471500                    LDP1    @VARIABLE_START,,AUTO
        23 000444   100000 234100                    SZN     0,,PR1
        23 000445   000522 605000 23                 TPL     s:17466

      317    17455    5            IF SBCHK_FLAG AND COMCOM.OB.SUBCHK THEN DO;

  17455 23 000446   200121 234100                    SZN     SBCHK_FLAG,,AUTO
        23 000447   000507 605000 23                 TPL     s:17463
        23 000450   000020 234000 xsym               SZN     COMCOM+16
        23 000451   000507 605000 23                 TPL     s:17463

      318    17456    5              CALL GET_LENGTH (STRING$, LENGTH, SIZ$);

  17456 23 000452   200145 633500                    EPPR3   SIZ$,,AUTO
        23 000453   200151 453500                    STP3    @SIZ$,,AUTO
        23 000454   200144 634500                    EPPR4   LENGTH,,AUTO
        23 000455   200150 454500                    STP4    @LENGTH,,AUTO
        23 000456   200141 236100                    LDQ     @STRING$,,AUTO
        23 000457   200147 756100                    STQ     @STRING$,,AUTO
        23 000460   000003 701000 23                 TSX1    GET_LENGTH
        23 000461   000000 011000                    NOP     0

      319    17457    6              IF SIZ$ = ADDR(NIL) THEN DO;

  17457 23 000462   200145 236100                    LDQ     SIZ$,,AUTO
        23 000463   000000 116000 24                 CMPQ    0
        23 000464   000475 601000 23                 TNZ     s:17461

      320    17458    6                MKCN.CON = LENGTH;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:73   

  17458 23 000465   200144 235100                    LDA     LENGTH,,AUTO
        23 000466   000000 755000 22                 STA     MKCN

      321    17459    6                CALL Z8AC$MAKE_CONST (SIZ$);

  17459 23 000467   200145 630500                    EPPR0   SIZ$,,AUTO
        23 000470   200156 450500                    STP0    TYPE_DESC+4,,AUTO
        23 000471   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000472   000002 631400 24                 EPPR1   2
        23 000473   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        23 000474   000000 011000                    NOP     0

      322    17460    6              END;

      323    17461    5              CALL Z8AF$FORME (%SBCHK, START$, SIZ$, START$);

  17461 23 000475   200137 236100                    LDQ     @START$,,AUTO
        23 000476   200161 756100                    STQ     TYPE_DESC+7,,AUTO
        23 000477   200145 630500                    EPPR0   SIZ$,,AUTO
        23 000500   200160 450500                    STP0    TYPE_DESC+6,,AUTO
        23 000501   000015 235000 24                 LDA     13
        23 000502   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 000503   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000504   000003 631400 24                 EPPR1   3
        23 000505   000000 701000 xent               TSX1    Z8AF$FORME
        23 000506   000000 011000                    NOP     0

      324    17462    5            END;

      325    17463    4            CALL Z8AF$FORME (%ADI, START$, OFF$, START$);

  17463 23 000507   200137 236100                    LDQ     @START$,,AUTO
        23 000510   200161 756100                    STQ     TYPE_DESC+7,,AUTO
        23 000511   200143 630500                    EPPR0   OFF$,,AUTO
        23 000512   200160 450500                    STP0    TYPE_DESC+6,,AUTO
        23 000513   000010 235000 24                 LDA     8
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:74   
        23 000514   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 000515   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000516   000003 631400 24                 EPPR1   3
        23 000517   000000 701000 xent               TSX1    Z8AF$FORME
        23 000520   000000 011000                    NOP     0

      326    17464    4          END;

  17464 23 000521   000525 710000 23                 TRA     s:17468

      327    17465    3          ELSE
      328    17466    3            START$ = OFF$;

  17466 23 000522   200143 236100                    LDQ     OFF$,,AUTO
        23 000523   200137 473500                    LDP3    @START$,,AUTO
        23 000524   300000 756100                    STQ     0,,PR3

      329    17467
      330    17468    3          VARIABLE_START = TRUE;

  17468 23 000525   400000 236003                    LDQ     -131072,DU
        23 000526   200140 470500                    LDP0    @VARIABLE_START,,AUTO
        23 000527   000000 756100                    STQ     0,,PR0

      331    17469    3        END;

      332    17470
      333    17471    2   END OFFSET_OVERFLOW_CHECK;

  17471 23 000530   200134 221300                    LDX1  ! VARIABLE_START+1,,AUTO
        23 000531   000001 702211                    TSX2  ! 1,X1

      334    17472        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:75   
      335    17473    1   CREATE_START_POSITION: PROC (STRING$, OFF, START$);

  17473 23 000532   200124 741300       CREATE_STAR* STX1  ! OP+1,,AUTO

      336    17474
      337    17475    2   DCL STRING$            PTR;
      338    17476    2   DCL OFF                SBIN WORD;
      339    17477    2   DCL START$             PTR;
      340    17478
      341    17479    2   DCL 1 OFFSET           ALIGNED,
      342    17480    2        2 VALUE           SBIN WORD,
      343    17481    2        2 TYPE            SBIN WORD;
      344    17482    2   DCL OFF$               PTR;
      345    17483    2   DCL VARIABLE_START     BOOLEAN;
      346    17484
      347    17485    2    CALL SET_UP_START_POS (START$, OFF, VARIABLE_START);

  17485 23 000533   200133 630500                    EPPR0   VARIABLE_START,,AUTO
        23 000534   200137 450500                    STP0    @START$,,AUTO
        23 000535   200126 236100                    LDQ     @OFF,,AUTO
        23 000536   200136 756100                    STQ     @PREV_OFF,,AUTO
        23 000537   200127 236100                    LDQ     @START$,,AUTO
        23 000540   200135 756100                    STQ     @OFF,,AUTO
        23 000541   000205 701000 23                 TSX1    SET_UP_START_POS
        23 000542   000000 011000                    NOP     0

      348    17486
      349    17487    3    DO CASE (STRING$ -> ETT.ID);

  17487 23 000543   200125 470500                    LDP0    @STRING$,,AUTO
        23 000544   000000 471500                    LDP1    0,,PR0
        23 000545   100000 220100                    LDX0    0,,PR1
        23 000546   000016 100003                    CMPX0   14,DU
        23 000547   000551 602010 23                 TNC     s:17487+6,X0
        23 000550   001001 710000 23                 TRA     s:17530
        23 000551   001001 710000 23                 TRA     s:17530
        23 000552   001001 710000 23                 TRA     s:17530
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:76   
        23 000553   001227 710000 23                 TRA     s:17948
        23 000554   000707 710000 23                 TRA     s:17515
        23 000555   001227 710000 23                 TRA     s:17948
        23 000556   000567 710000 23                 TRA     s:17490
        23 000557   001001 710000 23                 TRA     s:17530
        23 000560   001001 710000 23                 TRA     s:17530
        23 000561   001001 710000 23                 TRA     s:17530
        23 000562   001001 710000 23                 TRA     s:17530
        23 000563   001227 710000 23                 TRA     s:17948
        23 000564   001001 710000 23                 TRA     s:17530
        23 000565   001001 710000 23                 TRA     s:17530
        23 000566   001063 710000 23                 TRA     s:17544

      350    17488
      351    17489    3      CASE(%SSOP);

      352    17490    3        CALL OFFSET_OVERFLOW_CHECK (OFF, STRING$ -> ETT.LOP -> ETT.OFFSET.VALUE,

  17490 23 000567   100001 473500                    LDP3    1,,PR1
        23 000570   200125 236100                    LDQ     @STRING$,,AUTO
        23 000571   200141 756100                    STQ     @STRING$,,AUTO
        23 000572   200133 631500                    EPPR1   VARIABLE_START,,AUTO
        23 000573   200140 451500                    STP1    @VARIABLE_START,,AUTO
        23 000574   200127 236100                    LDQ     @START$,,AUTO
        23 000575   200137 756100                    STQ     @START$,,AUTO
        23 000576   300002 634500                    EPPR4   2,,PR3
        23 000577   200136 454500                    STP4    @PREV_OFF,,AUTO
        23 000600   200126 236100                    LDQ     @OFF,,AUTO
        23 000601   200135 756100                    STQ     @OFF,,AUTO
        23 000602   000403 701000 23                 TSX1    OFFSET_OVERFLOW_CHECK
        23 000603   000000 011000                    NOP     0

      353    17491    3                                    START$, VARIABLE_START, STRING$);
      354    17492
      355    17493    3        IF OFF ~= 0

  17493 23 000604   200126 470500                    LDP0    @OFF,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:77   
        23 000605   000000 235100                    LDA     0,,PR0
        23 000606   000611 601000 23                 TNZ     s:17496
        23 000607   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 000610   000702 605000 23                 TPL     s:17511

      356    17494    3        OR VARIABLE_START THEN
      357    17495    4          DO;

      358    17496    4            IF OFF ~= 0 THEN

  17496 23 000611   000000 115003                    CMPA    0,DU
        23 000612   000635 600000 23                 TZE     s:17501

      359    17497    4              CALL Z8AF$NEW_OFF (STRING$ -> ETT.LOP -> ETT.LOP,

  17497 23 000613   200125 471500                    LDP1    @STRING$,,AUTO
        23 000614   100000 473500                    LDP3    0,,PR1
        23 000615   300001 474500                    LDP4    1,,PR3
        23 000616   400002 236100                    LDQ     2,,PR4
        23 000617   000022 732000                    QRS     18
        23 000620   000000 036100                    ADLQ    0,,PR0
        23 000621   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000622   200132 633500                    EPPR3   OFF$,,AUTO
        23 000623   200161 453500                    STP3    TYPE_DESC+7,,AUTO
        23 000624   200156 635500                    EPPR5   TYPE_DESC+4,,AUTO
        23 000625   200160 455500                    STP5    TYPE_DESC+6,,AUTO
        23 000626   400001 636500                    EPPR6   1,,PR4
        23 000627   200157 456500                    STP6    TYPE_DESC+5,,AUTO
        23 000630   200157 630500                    EPPR0   TYPE_DESC+5,,AUTO
        23 000631   000016 631400 24                 EPPR1   14
        23 000632   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 000633   000000 011000                    NOP     0
        23 000634   000641 710000 23                 TRA     s:17503

      360    17498    4                                 STRING$ -> ETT.LOP -> ETT.OFFSET.VALUE + OFF,
      361    17499    4                                 OFF$);
      362    17500    4            ELSE
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:78   
      363    17501    4              OFF$ = STRING$ -> ETT.LOP;

  17501 23 000635   200125 471500                    LDP1    @STRING$,,AUTO
        23 000636   100000 473500                    LDP3    0,,PR1
        23 000637   300001 236100                    LDQ     1,,PR3
        23 000640   200132 756100                    STQ     OFF$,,AUTO

      364    17502
      365    17503    4            IF VARIABLE_START THEN

  17503 23 000641   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 000642   000661 605000 23                 TPL     s:17506

      366    17504    4              CALL Z8AF$FORME(%ADI, STRING$->ETT.ROP, START$, START$) ;

  17504 23 000643   200125 470500                    LDP0    @STRING$,,AUTO
        23 000644   000000 471500                    LDP1    0,,PR0
        23 000645   200127 236100                    LDQ     @START$,,AUTO
        23 000646   200127 235100                    LDA     @START$,,AUTO
        23 000647   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000650   100002 633500                    EPPR3   2,,PR1
        23 000651   200157 453500                    STP3    TYPE_DESC+5,,AUTO
        23 000652   000010 236000 24                 LDQ     8
        23 000653   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000654   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000655   000003 631400 24                 EPPR1   3
        23 000656   000000 701000 xent               TSX1    Z8AF$FORME
        23 000657   000000 011000                    NOP     0
        23 000660   000666 710000 23                 TRA     s:17508

      367    17505    4            ELSE
      368    17506    4              START$ = STRING$ -> ETT.ROP;

  17506 23 000661   200125 470500                    LDP0    @STRING$,,AUTO
        23 000662   000000 471500                    LDP1    0,,PR0
        23 000663   100002 236100                    LDQ     2,,PR1
        23 000664   200127 473500                    LDP3    @START$,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:79   
        23 000665   300000 756100                    STQ     0,,PR3

      369    17507
      370    17508    4            CALL Z8AF$FORME (%SSOP, OFF$, START$, START$);

  17508 23 000666   200127 236100                    LDQ     @START$,,AUTO
        23 000667   200127 235100                    LDA     @START$,,AUTO
        23 000670   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000671   200132 630500                    EPPR0   OFF$,,AUTO
        23 000672   200157 450500                    STP0    TYPE_DESC+5,,AUTO
        23 000673   000020 236000 24                 LDQ     16
        23 000674   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000675   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000676   000003 631400 24                 EPPR1   3
        23 000677   000000 701000 xent               TSX1    Z8AF$FORME
        23 000700   000000 011000                    NOP     0

      371    17509    4          END;

  17509 23 000701   001321 710000 23                 TRA     s:17962

      372    17510    3        ELSE
      373    17511    3          START$ = STRING$;

  17511 23 000702   200125 471500                    LDP1    @STRING$,,AUTO
        23 000703   100000 236100                    LDQ     0,,PR1
        23 000704   200127 473500                    LDP3    @START$,,AUTO
        23 000705   300000 756100                    STQ     0,,PR3
        23 000706   001321 710000 23                 TRA     s:17962

      374    17512
      375    17513        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:80   
      376    17514    3      CASE(%OFF);

      377    17515    3        CALL OFFSET_OVERFLOW_CHECK (OFF, START$ -> ETT.OFFSET.VALUE,

  17515 23 000707   200127 473500                    LDP3    @START$,,AUTO
        23 000710   300000 474500                    LDP4    0,,PR3
        23 000711   200125 236100                    LDQ     @STRING$,,AUTO
        23 000712   200141 756100                    STQ     @STRING$,,AUTO
        23 000713   200133 631500                    EPPR1   VARIABLE_START,,AUTO
        23 000714   200140 451500                    STP1    @VARIABLE_START,,AUTO
        23 000715   200127 236100                    LDQ     @START$,,AUTO
        23 000716   200137 756100                    STQ     @START$,,AUTO
        23 000717   400002 635500                    EPPR5   2,,PR4
        23 000720   200136 455500                    STP5    @PREV_OFF,,AUTO
        23 000721   200126 236100                    LDQ     @OFF,,AUTO
        23 000722   200135 756100                    STQ     @OFF,,AUTO
        23 000723   000403 701000 23                 TSX1    OFFSET_OVERFLOW_CHECK
        23 000724   000000 011000                    NOP     0

      378    17516    3                                    START$, VARIABLE_START, STRING$);
      379    17517
      380    17518    3        IF VARIABLE_START THEN

  17518 23 000725   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 000726   000757 605000 23                 TPL     s:17524

      381    17519    3          IF SBCHK_FLAG THEN

  17519 23 000727   200121 234100                    SZN     SBCHK_FLAG,,AUTO
        23 000730   000744 605000 23                 TPL     s:17522

      382    17520    3            CALL Z8AF$NEW_OFF_AND_SSOP (STRING$, OFF, START$, START$);

  17520 23 000731   200127 236100                    LDQ     @START$,,AUTO
        23 000732   200127 235100                    LDA     @START$,,AUTO
        23 000733   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000734   200126 236100                    LDQ     @OFF,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:81   
        23 000735   200125 235100                    LDA     @STRING$,,AUTO
        23 000736   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 000737   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000740   000003 631400 24                 EPPR1   3
        23 000741   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP
        23 000742   000000 011000                    NOP     0
        23 000743   001321 710000 23                 TRA     s:17962

      383    17521    3          ELSE
      384    17522    3            CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK(STRING$, OFF, START$, START$);

  17522 23 000744   200127 236100                    LDQ     @START$,,AUTO
        23 000745   200127 235100                    LDA     @START$,,AUTO
        23 000746   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 000747   200126 236100                    LDQ     @OFF,,AUTO
        23 000750   200125 235100                    LDA     @STRING$,,AUTO
        23 000751   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 000752   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 000753   000003 631400 24                 EPPR1   3
        23 000754   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
        23 000755   000000 011000                    NOP     0
        23 000756   001321 710000 23                 TRA     s:17962

      385    17523    3        ELSE
      386    17524    3          CALL Z8AF$NEW_OFF (STRING$ -> ETT.LOP,

  17524 23 000757   200125 470500                    LDP0    @STRING$,,AUTO
        23 000760   000000 471500                    LDP1    0,,PR0
        23 000761   200126 473500                    LDP3    @OFF,,AUTO
        23 000762   100002 236100                    LDQ     2,,PR1
        23 000763   000022 732000                    QRS     18
        23 000764   300000 036100                    ADLQ    0,,PR3
        23 000765   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 000766   200127 236100                    LDQ     @START$,,AUTO
        23 000767   200161 756100                    STQ     TYPE_DESC+7,,AUTO
        23 000770   200156 634500                    EPPR4   TYPE_DESC+4,,AUTO
        23 000771   200160 454500                    STP4    TYPE_DESC+6,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:82   
        23 000772   100001 635500                    EPPR5   1,,PR1
        23 000773   200157 455500                    STP5    TYPE_DESC+5,,AUTO
        23 000774   200157 630500                    EPPR0   TYPE_DESC+5,,AUTO
        23 000775   000016 631400 24                 EPPR1   14
        23 000776   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 000777   000000 011000                    NOP     0
        23 001000   001321 710000 23                 TRA     s:17962

      387    17525    3                             STRING$ -> ETT.OFFSET.VALUE + OFF,
      388    17526    3                             START$);
      389    17527
      390    17528        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:83   
      391    17529    3      CASE(%BASE, ELSE);

      392    17530    3        CALL OFFSET_OVERFLOW_CHECK (OFF, 0, START$, VARIABLE_START, STRING$);

  17530 23 001001   200125 236100                    LDQ     @STRING$,,AUTO
        23 001002   200141 756100                    STQ     @STRING$,,AUTO
        23 001003   200133 631500                    EPPR1   VARIABLE_START,,AUTO
        23 001004   200140 451500                    STP1    @VARIABLE_START,,AUTO
        23 001005   200127 236100                    LDQ     @START$,,AUTO
        23 001006   000022 235000 24                 LDA     18
        23 001007   200136 757100                    STAQ    @PREV_OFF,,AUTO
        23 001010   200126 236100                    LDQ     @OFF,,AUTO
        23 001011   200135 756100                    STQ     @OFF,,AUTO
        23 001012   000403 701000 23                 TSX1    OFFSET_OVERFLOW_CHECK
        23 001013   000000 011000                    NOP     0

      393    17531
      394    17532    3        IF VARIABLE_START THEN

  17532 23 001014   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 001015   001046 605000 23                 TPL     s:17538

      395    17533    3          IF SBCHK_FLAG THEN

  17533 23 001016   200121 234100                    SZN     SBCHK_FLAG,,AUTO
        23 001017   001033 605000 23                 TPL     s:17536

      396    17534    3            CALL Z8AF$NEW_OFF_AND_SSOP (STRING$, OFF, START$, START$);

  17534 23 001020   200127 236100                    LDQ     @START$,,AUTO
        23 001021   200127 235100                    LDA     @START$,,AUTO
        23 001022   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001023   200126 236100                    LDQ     @OFF,,AUTO
        23 001024   200125 235100                    LDA     @STRING$,,AUTO
        23 001025   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 001026   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001027   000003 631400 24                 EPPR1   3
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:84   
        23 001030   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP
        23 001031   000000 011000                    NOP     0
        23 001032   001321 710000 23                 TRA     s:17962

      397    17535    3          ELSE
      398    17536    3            CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK(STRING$, OFF, START$, START$);

  17536 23 001033   200127 236100                    LDQ     @START$,,AUTO
        23 001034   200127 235100                    LDA     @START$,,AUTO
        23 001035   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001036   200126 236100                    LDQ     @OFF,,AUTO
        23 001037   200125 235100                    LDA     @STRING$,,AUTO
        23 001040   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 001041   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001042   000003 631400 24                 EPPR1   3
        23 001043   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
        23 001044   000000 011000                    NOP     0
        23 001045   001321 710000 23                 TRA     s:17962

      399    17537    3        ELSE
      400    17538    3          IF OFF ~= 0 THEN

  17538 23 001046   200126 470500                    LDP0    @OFF,,AUTO
        23 001047   000000 235100                    LDA     0,,PR0
        23 001050   001056 600000 23                 TZE     s:17541

      401    17539    3            CALL Z8AF$NEW_OFF (STRING$, OFF, START$);

  17539 23 001051   200125 630500                    EPPR0   @STRING$,,AUTO
        23 001052   000016 631400 24                 EPPR1   14
        23 001053   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 001054   000000 011000                    NOP     0
        23 001055   001321 710000 23                 TRA     s:17962

      402    17540    3          ELSE
      403    17541    3            START$ = STRING$;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:85   
  17541 23 001056   200125 471500                    LDP1    @STRING$,,AUTO
        23 001057   100000 236100                    LDQ     0,,PR1
        23 001060   200127 473500                    LDP3    @START$,,AUTO
        23 001061   300000 756100                    STQ     0,,PR3
        23 001062   001321 710000 23                 TRA     s:17962

      404    17542        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:86   
      405    17543    3      CASE (%TRIAD);

      406    17544    3        CALL OFFSET_OVERFLOW_CHECK (OFF, 0, START$, VARIABLE_START, STRING$);

  17544 23 001063   200125 236100                    LDQ     @STRING$,,AUTO
        23 001064   200141 756100                    STQ     @STRING$,,AUTO
        23 001065   200133 631500                    EPPR1   VARIABLE_START,,AUTO
        23 001066   200140 451500                    STP1    @VARIABLE_START,,AUTO
        23 001067   200127 236100                    LDQ     @START$,,AUTO
        23 001070   000022 235000 24                 LDA     18
        23 001071   200136 757100                    STAQ    @PREV_OFF,,AUTO
        23 001072   200126 236100                    LDQ     @OFF,,AUTO
        23 001073   200135 756100                    STQ     @OFF,,AUTO
        23 001074   000403 701000 23                 TSX1    OFFSET_OVERFLOW_CHECK
        23 001075   000000 011000                    NOP     0

      407    17545    3        IF OFF ~= 0

  17545 23 001076   200126 470500                    LDP0    @OFF,,AUTO
        23 001077   000000 235100                    LDA     0,,PR0
        23 001100   001103 601000 23                 TNZ     s:17548
        23 001101   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 001102   001222 605000 23                 TPL     s:17943

      408    17546    3        OR VARIABLE_START THEN
      409    17547    4          DO;

      410    17548    4            CALL Z8AT$CREATE_TEMP_WITH_BASE (%SCALAR, TEMP$);

  17548 23 001103   200110 631500                    EPPR1   TEMP$,,AUTO
        23 001104   200157 451500                    STP1    TYPE_DESC+5,,AUTO
        23 001105   000024 236000 24                 LDQ     20
        23 001106   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 001107   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001110   000001 631400 24                 EPPR1   1
        23 001111   000000 701000 xent               TSX1    Z8AT$CREATE_TEMP_WITH_BASE
        23 001112   000000 011000                    NOP     0
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:87   

      411    17549    4            TEMP$ -> ETT.LOP -> SCALAR.TYPE   = %TYA;

  17549 23 001113   200110 470500                    LDP0    TEMP$,,AUTO
        23 001114   000001 471500                    LDP1    1,,PR0
        23 001115   000010 220003                    LDX0    8,DU
        23 001116   100002 740100                    STX0    2,,PR1

      412    17550    4            TEMP$ -> ETT.LOP -> SCALAR.ADSC.N = STRING_ST$ -> SCALAR.ADSC.N;

  17550 23 001117   200110 470500                    LDP0    TEMP$,,AUTO
        23 001120   000001 471500                    LDP1    1,,PR0
        23 001121   200111 473500                    LDP3    STRING_ST$,,AUTO
        23 001122   300001 236100                    LDQ     1,,PR3
        23 001123   100001 752103                    STCQ    1,'03'O,PR1

      413    17551
      414    17552                 %NEW_ILL (@ID  = %PRESET,
      415    17553                           @ROP = STRING$ -> ETT.LOP,
      416    17554                           @LOP = TEMP$ -> ETT.LOP);

  17774 23 001124   000026 236000 24                 LDQ     22
        23 001125   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 001126   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001127   200163 450500                    STP0    TYPE_DESC+9,,AUTO
        23 001130   000027 236000 24                 LDQ     23
        23 001131   200162 756100                    STQ     TYPE_DESC+8,,AUTO
        23 001132   000030 237000 24                 LDAQ    24
        23 001133   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001134   200160 630500                    EPPR0   TYPE_DESC+6,,AUTO
        23 001135   000003 631400 24                 EPPR1   3
        23 001136   000000 701000 xent               TSX1    Z8AN$NEW_ILL
        23 001137   000000 011000                    NOP     0

  17776 23 001140   000000 220003                    LDX0    0,DU
        23 001141   000000 470400 6                  LDP0    ILL$
        23 001142   000000 440100                    SXL0    0,,PR0
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:88   

  17780 23 001143   200110 470500                    LDP0    TEMP$,,AUTO
        23 001144   000001 236100                    LDQ     1,,PR0
        23 001145   000000 471400 6                  LDP1    ILL$
        23 001146   100001 756100                    STQ     1,,PR1

  17781 23 001147   200125 470500                    LDP0    @STRING$,,AUTO
        23 001150   000000 473500                    LDP3    0,,PR0
        23 001151   300001 236100                    LDQ     1,,PR3
        23 001152   100002 756100                    STQ     2,,PR1

      417    17933
      418    17934    4            IF VARIABLE_START THEN

  17934 23 001153   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 001154   001207 605000 23                 TPL     s:17940

      419    17935    4              IF SBCHK_FLAG THEN

  17935 23 001155   200121 234100                    SZN     SBCHK_FLAG,,AUTO
        23 001156   001173 605000 23                 TPL     s:17938

      420    17936    4                CALL Z8AF$NEW_OFF_AND_SSOP (TEMP$, OFF, START$, START$);

  17936 23 001157   200127 236100                    LDQ     @START$,,AUTO
        23 001160   200127 235100                    LDA     @START$,,AUTO
        23 001161   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001162   200126 236100                    LDQ     @OFF,,AUTO
        23 001163   200157 756100                    STQ     TYPE_DESC+5,,AUTO
        23 001164   200110 633500                    EPPR3   TEMP$,,AUTO
        23 001165   200156 453500                    STP3    TYPE_DESC+4,,AUTO
        23 001166   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001167   000003 631400 24                 EPPR1   3
        23 001170   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP
        23 001171   000000 011000                    NOP     0
        23 001172   001321 710000 23                 TRA     s:17962

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:89   
      421    17937    4              ELSE
      422    17938    4                CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK(TEMP$, OFF, START$, START$);

  17938 23 001173   200127 236100                    LDQ     @START$,,AUTO
        23 001174   200127 235100                    LDA     @START$,,AUTO
        23 001175   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001176   200126 236100                    LDQ     @OFF,,AUTO
        23 001177   200157 756100                    STQ     TYPE_DESC+5,,AUTO
        23 001200   200110 633500                    EPPR3   TEMP$,,AUTO
        23 001201   200156 453500                    STP3    TYPE_DESC+4,,AUTO
        23 001202   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001203   000003 631400 24                 EPPR1   3
        23 001204   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
        23 001205   000000 011000                    NOP     0
        23 001206   001321 710000 23                 TRA     s:17962

      423    17939    4            ELSE /* NOT VARIABLE_START */
      424    17940    4              CALL Z8AF$NEW_OFF (TEMP$, OFF, START$);

  17940 23 001207   200127 236100                    LDQ     @START$,,AUTO
        23 001210   200160 756100                    STQ     TYPE_DESC+6,,AUTO
        23 001211   200126 236100                    LDQ     @OFF,,AUTO
        23 001212   200157 756100                    STQ     TYPE_DESC+5,,AUTO
        23 001213   200110 633500                    EPPR3   TEMP$,,AUTO
        23 001214   200156 453500                    STP3    TYPE_DESC+4,,AUTO
        23 001215   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001216   000016 631400 24                 EPPR1   14
        23 001217   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 001220   000000 011000                    NOP     0

      425    17941    4          END;

  17941 23 001221   001321 710000 23                 TRA     s:17962

      426    17942    3        ELSE
      427    17943    3          START$ = STRING$;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:90   
  17943 23 001222   200125 471500                    LDP1    @STRING$,,AUTO
        23 001223   100000 236100                    LDQ     0,,PR1
        23 001224   200127 473500                    LDP3    @START$,,AUTO
        23 001225   300000 756100                    STQ     0,,PR3
        23 001226   001321 710000 23                 TRA     s:17962

      428    17944
      429    17945
      430    17946        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:91   
      431    17947    3      CASE (%SIZ, %FISS, %REFMOD); /*#28637*/

      432    17948    3        CALL OFFSET_OVERFLOW_CHECK (OFF, 0, START$, VARIABLE_START, STRING$);

  17948 23 001227   200125 236100                    LDQ     @STRING$,,AUTO
        23 001230   200141 756100                    STQ     @STRING$,,AUTO
        23 001231   200133 631500                    EPPR1   VARIABLE_START,,AUTO
        23 001232   200140 451500                    STP1    @VARIABLE_START,,AUTO
        23 001233   200127 236100                    LDQ     @START$,,AUTO
        23 001234   000022 235000 24                 LDA     18
        23 001235   200136 757100                    STAQ    @PREV_OFF,,AUTO
        23 001236   200126 236100                    LDQ     @OFF,,AUTO
        23 001237   200135 756100                    STQ     @OFF,,AUTO
        23 001240   000403 701000 23                 TSX1    OFFSET_OVERFLOW_CHECK
        23 001241   000000 011000                    NOP     0

      433    17949
      434    17950    3        IF VARIABLE_START THEN

  17950 23 001242   200133 234100                    SZN     VARIABLE_START,,AUTO
        23 001243   001274 605000 23                 TPL     s:17956

      435    17951    3          IF SBCHK_FLAG THEN

  17951 23 001244   200121 234100                    SZN     SBCHK_FLAG,,AUTO
        23 001245   001261 605000 23                 TPL     s:17954

      436    17952    3            CALL Z8AF$NEW_OFF_AND_SSOP (STRING$, OFF, START$, START$);

  17952 23 001246   200127 236100                    LDQ     @START$,,AUTO
        23 001247   200127 235100                    LDA     @START$,,AUTO
        23 001250   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001251   200126 236100                    LDQ     @OFF,,AUTO
        23 001252   200125 235100                    LDA     @STRING$,,AUTO
        23 001253   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 001254   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001255   000003 631400 24                 EPPR1   3
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:92   
        23 001256   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP
        23 001257   000000 011000                    NOP     0
        23 001260   001321 710000 23                 TRA     s:17962

      437    17953    3          ELSE
      438    17954    3            CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK (STRING$, OFF, START$, START$);

  17954 23 001261   200127 236100                    LDQ     @START$,,AUTO
        23 001262   200127 235100                    LDA     @START$,,AUTO
        23 001263   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 001264   200126 236100                    LDQ     @OFF,,AUTO
        23 001265   200125 235100                    LDA     @STRING$,,AUTO
        23 001266   200156 757100                    STAQ    TYPE_DESC+4,,AUTO
        23 001267   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001270   000003 631400 24                 EPPR1   3
        23 001271   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
        23 001272   000000 011000                    NOP     0
        23 001273   001321 710000 23                 TRA     s:17962

      439    17955    3        ELSE
      440    17956    3          IF OFF ~= 0 THEN

  17956 23 001274   200126 470500                    LDP0    @OFF,,AUTO
        23 001275   000000 235100                    LDA     0,,PR0
        23 001276   001314 600000 23                 TZE     s:17959

      441    17957    3            CALL Z8AF$NEW_OFF (STRING$ -> ETT.LOP, OFF, START$);

  17957 23 001277   200125 471500                    LDP1    @STRING$,,AUTO
        23 001300   100000 473500                    LDP3    0,,PR1
        23 001301   200127 236100                    LDQ     @START$,,AUTO
        23 001302   200160 756100                    STQ     TYPE_DESC+6,,AUTO
        23 001303   200126 236100                    LDQ     @OFF,,AUTO
        23 001304   200157 756100                    STQ     TYPE_DESC+5,,AUTO
        23 001305   300001 634500                    EPPR4   1,,PR3
        23 001306   200156 454500                    STP4    TYPE_DESC+4,,AUTO
        23 001307   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:93   
        23 001310   000016 631400 24                 EPPR1   14
        23 001311   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        23 001312   000000 011000                    NOP     0
        23 001313   001321 710000 23                 TRA     s:17962

      442    17958    3          ELSE
      443    17959    3            START$ = STRING$ -> ETT.LOP;

  17959 23 001314   200125 471500                    LDP1    @STRING$,,AUTO
        23 001315   100000 473500                    LDP3    0,,PR1
        23 001316   300001 236100                    LDQ     1,,PR3
        23 001317   200127 474500                    LDP4    @START$,,AUTO
        23 001320   400000 756100                    STQ     0,,PR4

      444    17960
      445    17961    3    END; /* Case -- ident$ -> ill.id */

      446    17962    2   END CREATE_START_POSITION;  /*  proc  */

  17962 23 001321   200124 221300                    LDX1  ! OP+1,,AUTO
        23 001322   000001 702211                    TSX2  ! 1,X1

      447    17963        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:94   
      448    17964        %MACRO CREATE_LENGTH_ITEMS (@FISS      = FISS,
      449    17965                                    @SIZ$      = SIZ$,
      450    17966                                    @START_AT$ = STRT_POS$,
      451    17967                                    @RETURN$   = VAR$ -> LX_ETT_ITEM.ETT$);
      452    17968
      453    17969         IF SIZ$ = ADDR(NIL) THEN
      454    17970           CALL Z8AF$NEW_FISS (@START_AT$, @FISS, %ALPHA_NUMERIC_FISS, @RETURN$);
      455    17971         ELSE
      456    17972           CALL Z8AF$FORME (%REFMOD, @START_AT$, @SIZ$, @RETURN$); /*#28637*/
      457    17973        %MEND;
      458    17974        %EJECT;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:95   
      459    17975    1    SBCHK_FLAG = TRUE;

  17975 23 001323   400000 236003                    LDQ     -131072,DU
        23 001324   200121 756100                    STQ     SBCHK_FLAG,,AUTO

      460    17976    1    CONV_FLAG = TRUE;

  17976 23 001325   200114 756100                    STQ     CONV_FLAG,,AUTO

      461    17977    1    GOTO START_Z8EY_SUBSTR;

  17977 23 001326   001341 710000 23                 TRA     START_Z8EY_SUBSTR

      462    17978         /**/
      463    17979    1   Z8EY$SUBSTR_NO_SBCHK: ENTRY (VAR$$, START$$, LENGTH$$, RETURN$); /*#42050*/

  17979 23 001327   000000 700200 xent  Z8EY$SUBSTR* TSX0  ! X66_AUTO_4
        23 001330   000164 000004                    ZERO    116,4

      464    17980    1    SBCHK_FLAG = FALSE;

  17980 23 001331   200121 450100                    STZ     SBCHK_FLAG,,AUTO

      465    17981    1    CONV_FLAG = TRUE;

  17981 23 001332   400000 236003                    LDQ     -131072,DU
        23 001333   200114 756100                    STQ     CONV_FLAG,,AUTO

      466    17982    1    GOTO START_Z8EY_SUBSTR;

  17982 23 001334   001341 710000 23                 TRA     START_Z8EY_SUBSTR

      467    17983         /**/
      468    17984    1   Z8EY$INSERT: ENTRY (VAR$$, START$$, LENGTH$$, RETURN$);

  17984 23 001335   000000 700200 xent  Z8EY$INSERT  TSX0  ! X66_AUTO_4
        23 001336   000164 000004                    ZERO    116,4
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:96   

      469    17985    1    SBCHK_FLAG = FALSE;

  17985 23 001337   200121 450100                    STZ     SBCHK_FLAG,,AUTO

      470    17986    1    CONV_FLAG = FALSE;

  17986 23 001340   200114 450100                    STZ     CONV_FLAG,,AUTO

      471    17987
      472    17988    1   START_Z8EY_SUBSTR:
      473    17989         %FISH (TRIAD = VAR$$ -> LX_ETT_ITEM.ETT$,
      474    17990                RTN = VAR_ST$);

  17991 23 001341                       START_Z8EY_* null
  17992 23 001341   200003 470500                    LDP0    @VAR$$,,AUTO
        23 001342   000000 471500                    LDP1    0,,PR0
        23 001343   100001 236100                    LDQ     1,,PR1
        23 001344   200102 756100                    STQ     VAR_ST$,,AUTO

  17993 23 001345   200102 473500                    LDP3    VAR_ST$,,AUTO
        23 001346   300000 220100                    LDX0    0,,PR3
        23 001347   000751 100003                    CMPX0   489,DU
        23 001350   001360 603000 23                 TRC     s:17999

  17994 23 001351   200102 470500                    LDP0    VAR_ST$,,AUTO
        23 001352   000001 236100                    LDQ     1,,PR0
        23 001353   200102 756100                    STQ     VAR_ST$,,AUTO

  17995 23 001354   200102 470500                    LDP0    VAR_ST$,,AUTO
        23 001355   000000 220100                    LDX0    0,,PR0
        23 001356   000751 100003                    CMPX0   489,DU
        23 001357   001351 602000 23                 TNC     s:17994

      475    17998
      476    17999    1    IF VAR_ST$ -> SCALAR.B.KANJI AND SBCHK_FLAG THEN

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:97   
  17999 23 001360   200102 470500                    LDP0    VAR_ST$,,AUTO
        23 001361   000003 236100                    LDQ     3,,PR0
        23 001362   001000 316007                    CANQ    512,DL
        23 001363   001436 600000 23                 TZE     s:18030
        23 001364   200121 234100                    SZN     SBCHK_FLAG,,AUTO
        23 001365   001436 605000 23                 TPL     s:18030

      477    18000          /* SBCHK_FLAG false only for INSPECT, EXAMINE -- no KANJI check needed, either */
      478    18001    2      DO;

      479    18002    2        BYTE_SIZE = 2;

  18002 23 001366   000002 235007                    LDA     2,DL
        23 001367   200120 755100                    STA     BYTE_SIZE,,AUTO

      480    18003    2        START$ = ADDR( OFFSET_TIMES_2 );

  18003 23 001370   200052 631500                    EPPR1   OFFSET_TIMES_2,,AUTO
        23 001371   200020 451500                    STP1    START$,,AUTO

      481    18004    2        TWO$ = ADDR( TWO );

  18004 23 001372   200072 633500                    EPPR3   TWO,,AUTO
        23 001373   200103 453500                    STP3    TWO$,,AUTO

      482    18005    2        CALL Z8AC$LX_ETT_ITEM_TYI_CONST (2, TWO$);

  18005 23 001374   200103 634500                    EPPR4   TWO$,,AUTO
        23 001375   200157 454500                    STP4    TYPE_DESC+5,,AUTO
        23 001376   000033 236000 24                 LDQ     27
        23 001377   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 001400   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001401   000001 631400 24                 EPPR1   1
        23 001402   000000 701000 xent               TSX1    Z8AC$LX_ETT_ITEM_TYI_CONST
        23 001403   000000 011000                    NOP     0

      483    18006             %INIT_BINARY_OP (@POINTER = START$,
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:98   
      484    18007                              @OP      = %OP_STAR,
      485    18008                              @LOP$    = START$$,
      486    18009                              @ROP$    = TWO$);

  18011 23 001404   000005 220003                    LDX0    5,DU
        23 001405   200020 470500                    LDP0    START$,,AUTO
        23 001406   000000 740100                    STX0    0,,PR0

  18012 23 001407   000000 221003                    LDX1    0,DU
        23 001410   200020 470500                    LDP0    START$,,AUTO
        23 001411   000000 441100                    SXL1    0,,PR0

  18019 23 001412   000133 235000 xsym               LDA     COMCOM+91
        23 001413   200020 470500                    LDP0    START$,,AUTO
        23 001414   000005 755100                    STA     5,,PR0

  18020 23 001415   000134 235000 xsym               LDA     COMCOM+92
        23 001416   200020 470500                    LDP0    START$,,AUTO
        23 001417   000006 755100                    STA     6,,PR0

  18021 23 001420   200103 236100                    LDQ     TWO$,,AUTO
        23 001421   200020 470500                    LDP0    START$,,AUTO
        23 001422   000002 756100                    STQ     2,,PR0

  18022 23 001423   200004 470500                    LDP0    @START$$,,AUTO
        23 001424   000000 236100                    LDQ     0,,PR0
        23 001425   200020 471500                    LDP1    START$,,AUTO
        23 001426   100001 756100                    STQ     1,,PR1

  18023 23 001427   000022 235007                    LDA     18,DL
        23 001430   200020 471500                    LDP1    START$,,AUTO
        23 001431   100003 755100                    STA     3,,PR1

  18024 23 001432   000000 236000 24                 LDQ     0
        23 001433   200020 471500                    LDP1    START$,,AUTO
        23 001434   100007 756100                    STQ     7,,PR1

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:99   
      487    18027    2      END;

  18027 23 001435   001443 710000 23                 TRA     s:18034

      488    18028    1    ELSE
      489    18029    2      DO;

      490    18030    2        BYTE_SIZE = 1;

  18030 23 001436   000001 235007                    LDA     1,DL
        23 001437   200120 755100                    STA     BYTE_SIZE,,AUTO

      491    18031    2        START$ = START$$;

  18031 23 001440   200004 471500                    LDP1    @START$$,,AUTO
        23 001441   100000 236100                    LDQ     0,,PR1
        23 001442   200020 756100                    STQ     START$,,AUTO

      492    18032    2      END;

      493    18033
      494    18034    1    VAR$ = ADDR(SUBSTR_VAR);

  18034 23 001443   200042 630500                    EPPR0   SUBSTR_VAR,,AUTO
        23 001444   200106 450500                    STP0    VAR$,,AUTO

      495    18035    1    VAR$ -> LX_ETT_ITEM = VAR$$ -> LX_ETT_ITEM;

  18035 23 001445   200003 471500                    LDP1    @VAR$$,,AUTO
        23 001446   100000 473500                    LDP3    0,,PR1
        23 001447   000100 100500                    MLR     fill='000'O
        23 001450   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32
        23 001451   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      496    18036
      497    18037    1    CALL Z8E5$MATH_PACK (START$, ADDR(START_POS));

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:100  
  18037 23 001452   200022 630500                    EPPR0   START_POS,,AUTO
        23 001453   200156 450500                    STP0    TYPE_DESC+4,,AUTO
        23 001454   200156 633500                    EPPR3   TYPE_DESC+4,,AUTO
        23 001455   200161 453500                    STP3    TYPE_DESC+7,,AUTO
        23 001456   200020 634500                    EPPR4   START$,,AUTO
        23 001457   200160 454500                    STP4    TYPE_DESC+6,,AUTO
        23 001460   200160 630500                    EPPR0   TYPE_DESC+6,,AUTO
        23 001461   000001 631400 24                 EPPR1   1
        23 001462   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        23 001463   000000 011000                    NOP     0

      498    18038    1    CALL Z8EQ$CHECK_FOR_INTEGER_ITEM (ADDR(START_POS),

  18038 23 001464   200022 630500                    EPPR0   START_POS,,AUTO
        23 001465   200156 450500                    STP0    TYPE_DESC+4,,AUTO
        23 001466   000035 236000 24                 LDQ     29
        23 001467   200161 756100                    STQ     TYPE_DESC+7,,AUTO
        23 001470   200156 631500                    EPPR1   TYPE_DESC+4,,AUTO
        23 001471   200160 451500                    STP1    TYPE_DESC+6,,AUTO
        23 001472   200160 630500                    EPPR0   TYPE_DESC+6,,AUTO
        23 001473   000001 631400 24                 EPPR1   1
        23 001474   000000 701000 xent               TSX1    Z8EQ$CHECK_FOR_INTEGER_ITEM
        23 001475   000000 011000                    NOP     0

      499    18039    1                                      %E$ONLY_INT_EXPR_FOR_REFMOD);
      500    18040
      501    18041    1    IF LENGTH$$ ~= ADDR(NIL) THEN   /* LENGTH_SPECIFIED */

  18041 23 001476   200005 470500                    LDP0    @LENGTH$$,,AUTO
        23 001477   000000 236100                    LDQ     0,,PR0
        23 001500   000000 116000 24                 CMPQ    0
        23 001501   001567 600000 23                 TZE     s:18076

      502    18042    2      DO;

      503    18043    2        IF BYTE_SIZE = 2 THEN /* KANJI */

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:101  
  18043 23 001502   200120 235100                    LDA     BYTE_SIZE,,AUTO
        23 001503   000002 115007                    CMPA    2,DL
        23 001504   001537 601000 23                 TNZ     s:18069

      504    18044    3          DO;

      505    18045    3            LENGTH$ = ADDR(LENGTH_TIMES_2);

  18045 23 001505   200062 631500                    EPPR1   LENGTH_TIMES_2,,AUTO
        23 001506   200104 451500                    STP1    LENGTH$,,AUTO

      506    18046                 %INIT_BINARY_OP (@POINTER = LENGTH$,
      507    18047                                  @OP      = %OP_STAR,
      508    18048                                  @LOP$    = LENGTH$$,
      509    18049                                  @ROP$    = TWO$);

  18051 23 001507   000005 220003                    LDX0    5,DU
        23 001510   100000 740100                    STX0    0,,PR1

  18052 23 001511   000000 221003                    LDX1    0,DU
        23 001512   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001513   100000 441100                    SXL1    0,,PR1

  18059 23 001514   000133 236000 xsym               LDQ     COMCOM+91
        23 001515   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001516   100005 756100                    STQ     5,,PR1

  18060 23 001517   000134 236000 xsym               LDQ     COMCOM+92
        23 001520   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001521   100006 756100                    STQ     6,,PR1

  18061 23 001522   200103 236100                    LDQ     TWO$,,AUTO
        23 001523   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001524   100002 756100                    STQ     2,,PR1

  18062 23 001525   000000 236100                    LDQ     0,,PR0
        23 001526   200104 471500                    LDP1    LENGTH$,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:102  
        23 001527   100001 756100                    STQ     1,,PR1

  18063 23 001530   000022 236007                    LDQ     18,DL
        23 001531   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001532   100003 756100                    STQ     3,,PR1

  18064 23 001533   000000 236000 24                 LDQ     0
        23 001534   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001535   100007 756100                    STQ     7,,PR1

      510    18067    3          END;

  18067 23 001536   001540 710000 23                 TRA     s:18070

      511    18068    2        ELSE
      512    18069    2          LENGTH$ = LENGTH$$;

  18069 23 001537   200104 756100                    STQ     LENGTH$,,AUTO

      513    18070    2        CALL Z8E5$MATH_PACK (LENGTH$, ADDR(LENGTH));

  18070 23 001540   200032 631500                    EPPR1   LENGTH,,AUTO
        23 001541   200156 451500                    STP1    TYPE_DESC+4,,AUTO
        23 001542   200156 633500                    EPPR3   TYPE_DESC+4,,AUTO
        23 001543   200161 453500                    STP3    TYPE_DESC+7,,AUTO
        23 001544   200104 634500                    EPPR4   LENGTH$,,AUTO
        23 001545   200160 454500                    STP4    TYPE_DESC+6,,AUTO
        23 001546   200160 630500                    EPPR0   TYPE_DESC+6,,AUTO
        23 001547   000001 631400 24                 EPPR1   1
        23 001550   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        23 001551   000000 011000                    NOP     0

      514    18071    2        CALL Z8EQ$CHECK_FOR_INTEGER_ITEM (ADDR(LENGTH),

  18071 23 001552   200032 630500                    EPPR0   LENGTH,,AUTO
        23 001553   200156 450500                    STP0    TYPE_DESC+4,,AUTO
        23 001554   000035 236000 24                 LDQ     29
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:103  
        23 001555   200161 756100                    STQ     TYPE_DESC+7,,AUTO
        23 001556   200156 631500                    EPPR1   TYPE_DESC+4,,AUTO
        23 001557   200160 451500                    STP1    TYPE_DESC+6,,AUTO
        23 001560   200160 630500                    EPPR0   TYPE_DESC+6,,AUTO
        23 001561   000001 631400 24                 EPPR1   1
        23 001562   000000 701000 xent               TSX1    Z8EQ$CHECK_FOR_INTEGER_ITEM
        23 001563   000000 011000                    NOP     0

      515    18072    2                                          %E$ONLY_INT_EXPR_FOR_REFMOD);
      516    18073    2        LENGTH$ = ADDR(LENGTH);

  18073 23 001564   200032 630500                    EPPR0   LENGTH,,AUTO
        23 001565   200104 450500                    STP0    LENGTH$,,AUTO

      517    18074    2      END;

  18074 23 001566   001571 710000 23                 TRA     s:18078

      518    18075    1    ELSE
      519    18076    1      LENGTH$ = ADDR(NIL);

  18076 23 001567   000000 236000 24                 LDQ     0
        23 001570   200104 756100                    STQ     LENGTH$,,AUTO

      520    18077
      521    18078    1    CALL Z8CO$DISPL_CHECK (VAR$)

  18078 23 001571   200106 630500                    EPPR0   VAR$,,AUTO
        23 001572   200156 450500                    STP0    TYPE_DESC+4,,AUTO
        23 001573   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001574   000002 631400 24                 EPPR1   2
        23 001575   000000 701000 xent               TSX1    Z8CO$DISPL_CHECK
        23 001576   001600 702000 23                 TSX2    s:18081
        23 001577   001655 710000 23                 TRA     s:18115

      522    18079    1      WHENALTRETURN
      523    18080    2        DO;
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:104  

      524    18081    2          IF VAR$ -> LX_ETT_ITEM.TYPE ~= %TYX AND

  18081 23 001600   200106 470500                    LDP0    VAR$,,AUTO
        23 001601   000004 235100                    LDA     4,,PR0
        23 001602   000011 115007                    CMPA    9,DL
        23 001603   001620 600000 23                 TZE     s:18091
        23 001604   000012 115007                    CMPA    10,DL
        23 001605   001620 600000 23                 TZE     s:18091

      525    18082    2             VAR$ -> LX_ETT_ITEM.TYPE ~= %TYY THEN /* Prevent unexpected case */
      526    18083    2            CALL Z8EV$CONVERT (%TYA, VAR$, VAR$);

  18083 23 001606   200106 631500                    EPPR1   VAR$,,AUTO
        23 001607   200160 451500                    STP1    TYPE_DESC+6,,AUTO
        23 001610   200106 633500                    EPPR3   VAR$,,AUTO
        23 001611   200157 453500                    STP3    TYPE_DESC+5,,AUTO
        23 001612   000037 236000 24                 LDQ     31
        23 001613   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 001614   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 001615   000016 631400 24                 EPPR1   14
        23 001616   000000 701000 xent               TSX1    Z8EV$CONVERT
        23 001617   000000 011000                    NOP     0

      527    18084
      528    18085               %INIT_LX_ETT_ITEM (@POINTER = RETURN$,
      529    18086                                  @ETT$    = VAR$ -> LX_ETT_ITEM.ETT$,
      530    18087                                  @TYPE    = %TYA,
      531    18088                                  @LINE    = VAR$ -> LX_ETT_ITEM.LINE,
      532    18089                                  @COLUMN  = VAR$ -> LX_ETT_ITEM.COLUMN);

  18091 23 001620   200006 470500                    LDP0    @RETURN$,,AUTO
        23 001621   000000 471500                    LDP1    0,,PR0
        23 001622   000004 220003                    LDX0    4,DU
        23 001623   100000 740100                    STX0    0,,PR1

  18092 23 001624   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:105  
        23 001625   000000 221003                    LDX1    0,DU
        23 001626   100000 441100                    SXL1    0,,PR1

  18093 23 001627   000000 471500                    LDP1    0,,PR0
        23 001630   000010 235007                    LDA     8,DL
        23 001631   100004 755100                    STA     4,,PR1

  18094 23 001632   000000 471500                    LDP1    0,,PR0
        23 001633   000000 236000 24                 LDQ     0
        23 001634   100007 756100                    STQ     7,,PR1

  18095 23 001635   000000 471500                    LDP1    0,,PR0
        23 001636   200106 473500                    LDP3    VAR$,,AUTO
        23 001637   300001 236100                    LDQ     1,,PR3
        23 001640   100001 756100                    STQ     1,,PR1

  18096 23 001641   000000 471500                    LDP1    0,,PR0
        23 001642   000000 236000 24                 LDQ     0
        23 001643   100002 756100                    STQ     2,,PR1

  18098 23 001644   000000 471500                    LDP1    0,,PR0
        23 001645   200106 473500                    LDP3    VAR$,,AUTO
        23 001646   300005 235100                    LDA     5,,PR3
        23 001647   100005 755100                    STA     5,,PR1

  18099 23 001650   000000 471500                    LDP1    0,,PR0
        23 001651   200106 473500                    LDP3    VAR$,,AUTO
        23 001652   300006 235100                    LDA     6,,PR3
        23 001653   100006 755100                    STA     6,,PR1

      533    18111    2          RETURN;

  18111 23 001654   000000 702200 xent               TSX2  ! X66_ARET

      534    18112    2        END;
      535    18113
      536    18114
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:106  
      537    18115    1    STRT_POS$ = ADDR(START_POS) -> LX_ETT_ITEM.ETT$;

  18115 23 001655   200023 236100                    LDQ     START_POS+1,,AUTO
        23 001656   200107 756100                    STQ     STRT_POS$,,AUTO

      538    18116
      539    18117    1    IF LENGTH$ ~= ADDR(NIL) THEN

  18117 23 001657   200104 236100                    LDQ     LENGTH$,,AUTO
        23 001660   000000 116000 24                 CMPQ    0
        23 001661   001665 600000 23                 TZE     s:18120

      540    18118    1      LENGTH$ = LENGTH$ -> LX_ETT_ITEM.ETT$;

  18118 23 001662   200104 470500                    LDP0    LENGTH$,,AUTO
        23 001663   000001 236100                    LDQ     1,,PR0
        23 001664   200104 756100                    STQ     LENGTH$,,AUTO

      541    18119
      542    18120    1    STRING$   = VAR$ -> LX_ETT_ITEM.ETT$;

  18120 23 001665   200106 470500                    LDP0    VAR$,,AUTO
        23 001666   000001 236100                    LDQ     1,,PR0
        23 001667   200105 756100                    STQ     STRING$,,AUTO

      543    18121
      544    18122         %FISH (TRIAD = STRING$,
      545    18123                RTN   = STRING_ST$);

  18125 23 001670   200111 756100                    STQ     STRING_ST$,,AUTO

  18126 23 001671   200111 471500                    LDP1    STRING_ST$,,AUTO
        23 001672   100000 220100                    LDX0    0,,PR1
        23 001673   000751 100003                    CMPX0   489,DU
        23 001674   001704 603000 23                 TRC     s:18132

  18127 23 001675   200111 470500                    LDP0    STRING_ST$,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:107  
        23 001676   000001 236100                    LDQ     1,,PR0
        23 001677   200111 756100                    STQ     STRING_ST$,,AUTO

  18128 23 001700   200111 470500                    LDP0    STRING_ST$,,AUTO
        23 001701   000000 220100                    LDX0    0,,PR0
        23 001702   000751 100003                    CMPX0   489,DU
        23 001703   001675 602000 23                 TNC     s:18127

      546    18131
      547    18132    1    FISS   = 0;

  18132 23 001704   200116 450100                    STZ     FISS,,AUTO

      548    18133    1    SIZ$   = ADDR(NIL);

  18133 23 001705   000000 236000 24                 LDQ     0
        23 001706   200112 756100                    STQ     SIZ$,,AUTO

      549    18134
      550    18135    2    DO CASE (STRING_ST$ -> VARIABLE.TYPE);

  18135 23 001707   200111 470500                    LDP0    STRING_ST$,,AUTO
        23 001710   000002 236100                    LDQ     2,,PR0
        23 001711   000022 772000                    QRL     18
        23 001712   000006 136007                    SBLQ    6,DL
        23 001713   000011 116007                    CMPQ    9,DL
        23 001714   001716 602006 23                 TNC     s:18135+7,QL
        23 001715   001751 710000 23                 TRA     s:18150
        23 001716   001727 710000 23                 TRA     s:18140
        23 001717   001751 710000 23                 TRA     s:18150
        23 001720   001727 710000 23                 TRA     s:18140
        23 001721   001751 710000 23                 TRA     s:18150
        23 001722   001751 710000 23                 TRA     s:18150
        23 001723   001751 710000 23                 TRA     s:18150
        23 001724   001727 710000 23                 TRA     s:18140
        23 001725   001751 710000 23                 TRA     s:18150
        23 001726   001727 710000 23                 TRA     s:18140
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:108  

      551    18136    2      CASE (%TYA, %TYN, %TYB, %TYE);

      552    18137             %GET_ADSC_LEN (ST$ = STRING_ST$,
      553    18138                            RTN = MAXLEN);

  18140 23 001727   000003 236100                    LDQ     3,,PR0
        23 001730   004000 316003                    CANQ    2048,DU
        23 001731   001745 600000 23                 TZE     s:18146

  18141 23 001732   000005 471500                    LDP1    5,,PR0
        23 001733   100000 220100                    LDX0    0,,PR1
        23 001734   001105 100003                    CMPX0   581,DU
        23 001735   001742 601000 23                 TNZ     s:18144

  18142 23 001736   100003 473500                    LDP3    3,,PR1
        23 001737   300001 235100                    LDA     1,,PR3
        23 001740   200122 755100                    STA     MAXLEN,,AUTO
        23 001741   001754 710000 23                 TRA     s:18152

  18144 23 001742   100001 235100                    LDA     1,,PR1
        23 001743   200122 755100                    STA     MAXLEN,,AUTO
        23 001744   001754 710000 23                 TRA     s:18152

  18146 23 001745   000001 236100                    LDQ     1,,PR0
        23 001746   007777 376007                    ANQ     4095,DL
        23 001747   200122 756100                    STQ     MAXLEN,,AUTO

  18147 23 001750   001754 710000 23                 TRA     s:18152

      554    18149    2      CASE (ELSE);

      555    18150    2        MAXLEN = STRING_ST$ -> VARIABLE.NDSC.N;

  18150 23 001751   000001 236100                    LDQ     1,,PR0
        23 001752   000077 376007                    ANQ     63,DL
        23 001753   200122 756100                    STQ     MAXLEN,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:109  

      556    18151    2    END;

      557    18152    1    IF LENGTH$ = ADDR(NIL) THEN

  18152 23 001754   200104 236100                    LDQ     LENGTH$,,AUTO
        23 001755   000000 116000 24                 CMPQ    0
        23 001756   001772 601000 23                 TNZ     s:18159

      558    18153    1      CALL GET_IMPLIED_LENGTH (STRING$, STRT_POS$, FISS, SIZ$);

  18153 23 001757   200112 631500                    EPPR1   SIZ$,,AUTO
        23 001760   200130 451500                    STP1    @START$+1,,AUTO
        23 001761   200116 633500                    EPPR3   FISS,,AUTO
        23 001762   200127 453500                    STP3    @OFF+1,,AUTO
        23 001763   200107 634500                    EPPR4   STRT_POS$,,AUTO
        23 001764   200126 454500                    STP4    @STRING$+1,,AUTO
        23 001765   200105 635500                    EPPR5   STRING$,,AUTO
        23 001766   200125 455500                    STP5    OP+2,,AUTO
        23 001767   000070 701000 23                 TSX1    GET_IMPLIED_LENGTH
        23 001770   000000 011000                    NOP     0
        23 001771   002005 710000 23                 TRA     s:18167

      559    18154    1    ELSE
      560    18155           %GET_SPECIFIED_LENGTH (@LENGTH$ = LENGTH$,
      561    18156                                  @FISS    = FISS,
      562    18157                                  @SIZ$    = SIZ$);

  18159 23 001772   200104 471500                    LDP1    LENGTH$,,AUTO
        23 001773   100000 220100                    LDX0    0,,PR1
        23 001774   000015 100003                    CMPX0   13,DU
        23 001775   002004 601000 23                 TNZ     s:18163
        23 001776   100001 473500                    LDP3    1,,PR1
        23 001777   300010 235100                    LDA     8,,PR3
        23 002000   010000 115007                    CMPA    4096,DL
        23 002001   002004 605000 23                 TPL     s:18163

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:110  
  18161 23 002002   200116 755100                    STA     FISS,,AUTO
        23 002003   002005 710000 23                 TRA     s:18167

  18163 23 002004   200112 756100                    STQ     SIZ$,,AUTO

      563    18166
      564    18167    2    IF COMCOM.OB.SUBCHK AND STRT_POS$ -> ETT.ID = %TRIAD THEN DO;

  18167 23 002005   000020 234000 xsym               SZN     COMCOM+16
        23 002006   002041 605000 23                 TPL     s:18176
        23 002007   200107 470500                    LDP0    STRT_POS$,,AUTO
        23 002010   000000 220100                    LDX0    0,,PR0
        23 002011   000015 100003                    CMPX0   13,DU
        23 002012   002041 601000 23                 TNZ     s:18176

      565    18168    2      OFF = STRT_POS$ -> ETT.LOP -> CONST.CONSTI.WORD1;

  18168 23 002013   000001 471500                    LDP1    1,,PR0
        23 002014   100010 235100                    LDA     8,,PR1
        23 002015   200115 755100                    STA     OFF,,AUTO

      566    18169    2      IF LENGTH$ ~= ADDR(NIL) THEN

  18169 23 002016   200104 236100                    LDQ     LENGTH$,,AUTO
        23 002017   000000 116000 24                 CMPQ    0
        23 002020   002032 600000 23                 TZE     s:18172

      567    18170    2        IF LENGTH$ -> ETT.ID = %TRIAD THEN

  18170 23 002021   200104 471500                    LDP1    LENGTH$,,AUTO
        23 002022   100000 220100                    LDX0    0,,PR1
        23 002023   000015 100003                    CMPX0   13,DU
        23 002024   002032 601000 23                 TNZ     s:18172

      568    18171    2          OFF = OFF + LENGTH$ -> ETT.LOP -> CONST.CONSTI.WORD1 - 1;

  18171 23 002025   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:111  
        23 002026   200115 236100                    LDQ     OFF,,AUTO
        23 002027   300010 036100                    ADLQ    8,,PR3
        23 002030   000001 136007                    SBLQ    1,DL
        23 002031   200115 756100                    STQ     OFF,,AUTO

      569    18172    2      IF OFF > MAXLEN THEN

  18172 23 002032   200115 236100                    LDQ     OFF,,AUTO
        23 002033   200122 116100                    CMPQ    MAXLEN,,AUTO
        23 002034   002041 604400 23                 TMOZ    s:18176

      570    18173    2        CALL Z8AE$ERROR (%E$REFMOD_OUT_OF_BOUNDS);

  18173 23 002035   000041 630400 24                 EPPR0   33
        23 002036   000002 631400 24                 EPPR1   2
        23 002037   000000 701000 xent               TSX1    Z8AE$ERROR
        23 002040   000000 011000                    NOP     0

      571    18174    2    END;

      572    18175
      573    18176    1    IF (VAR$ -> LX_ETT_ITEM.TYPE = %TYB OR VAR$ -> LX_ETT_ITEM.TYPE = %TYE)

  18176 23 002041   200106 470500                    LDP0    VAR$,,AUTO
        23 002042   000004 235100                    LDA     4,,PR0
        23 002043   000014 115007                    CMPA    12,DL
        23 002044   002047 600000 23                 TZE     s:18176+6
        23 002045   000006 115007                    CMPA    6,DL
        23 002046   002107 601000 23                 TNZ     s:18191
        23 002047   200114 234100                    SZN     CONV_FLAG,,AUTO
        23 002050   002107 605000 23                 TPL     s:18191

      574    18177    1        AND CONV_FLAG THEN
      575    18178    2      DO;

      576    18179    2        IF VAR$ -> LX_ETT_ITEM.TYPE = %TYB

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:112  
  18179 23 002051   000014 115007                    CMPA    12,DL
        23 002052   002056 601000 23                 TNZ     s:18181

      577    18180    2          THEN OP = %OP_GBCD_TO_ASCII;

  18180 23 002053   002663 236007                    LDQ     1459,DL
        23 002054   200123 756100                    STQ     OP,,AUTO
        23 002055   002060 710000 23                 TRA     s:18182

      578    18181    2          ELSE OP = %OP_EBCDIC_TO_ASCII;

  18181 23 002056   002723 236007                    LDQ     1491,DL
        23 002057   200123 756100                    STQ     OP,,AUTO

      579    18182    2        CALL Z8CO$CREATE_LIBRARY_BASE (OP, TABLE_ETT$);

  18182 23 002060   200113 631500                    EPPR1   TABLE_ETT$,,AUTO
        23 002061   200157 451500                    STP1    TYPE_DESC+5,,AUTO
        23 002062   200123 633500                    EPPR3   OP,,AUTO
        23 002063   200156 453500                    STP3    TYPE_DESC+4,,AUTO
        23 002064   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 002065   000001 631400 24                 EPPR1   1
        23 002066   000000 701000 xent               TSX1    Z8CO$CREATE_LIBRARY_BASE
        23 002067   000000 011000                    NOP     0

      580    18183    2        CALL Z8AF$FORME (%CVT,

  18183 23 002070   200105 630500                    EPPR0   STRING$,,AUTO
        23 002071   200161 450500                    STP0    TYPE_DESC+7,,AUTO
        23 002072   200113 631500                    EPPR1   TABLE_ETT$,,AUTO
        23 002073   200160 451500                    STP1    TYPE_DESC+6,,AUTO
        23 002074   200105 633500                    EPPR3   STRING$,,AUTO
        23 002075   200157 453500                    STP3    TYPE_DESC+5,,AUTO
        23 002076   000043 236000 24                 LDQ     35
        23 002077   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 002100   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 002101   000003 631400 24                 EPPR1   3
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:113  
        23 002102   000000 701000 xent               TSX1    Z8AF$FORME
        23 002103   000000 011000                    NOP     0

      581    18184    2                         STRING$,
      582    18185    2                         TABLE_ETT$,
      583    18186    2                         STRING$);
      584    18187    2        VAR$ -> LX_ETT_ITEM.TYPE = %TYA;

  18187 23 002104   000010 235007                    LDA     8,DL
        23 002105   200106 470500                    LDP0    VAR$,,AUTO
        23 002106   000004 755100                    STA     4,,PR0

      585    18188             /* Needed in case result assigned to numeric variable */
      586    18189    2      END;

      587    18190
      588    18191    1    OFF    = 0;

  18191 23 002107   200115 450100                    STZ     OFF,,AUTO

      589    18192
      590    18193    1    CALL CREATE_START_POSITION (STRING$, OFF, STRT_POS$);

  18193 23 002110   200107 630500                    EPPR0   STRT_POS$,,AUTO
        23 002111   200127 450500                    STP0    @OFF+1,,AUTO
        23 002112   200115 631500                    EPPR1   OFF,,AUTO
        23 002113   200126 451500                    STP1    @STRING$+1,,AUTO
        23 002114   200105 633500                    EPPR3   STRING$,,AUTO
        23 002115   200125 453500                    STP3    OP+2,,AUTO
        23 002116   000532 701000 23                 TSX1    CREATE_START_POSITION
        23 002117   000000 011000                    NOP     0

      591    18194
      592    18195    2    DO CASE (VAR$ -> LX_ETT_ITEM.TYPE);

  18195 23 002120   200106 470500                    LDP0    VAR$,,AUTO
        23 002121   000004 235100                    LDA     4,,PR0
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:114  
        23 002122   000006 135007                    SBLA    6,DL
        23 002123   000011 115007                    CMPA    9,DL
        23 002124   002126 602005 23                 TNC     s:18195+6,AL
        23 002125   002142 710000 23                 TRA     s:18199
        23 002126   002137 710000 23                 TRA     s:18197
        23 002127   002142 710000 23                 TRA     s:18199
        23 002130   002137 710000 23                 TRA     s:18197
        23 002131   002142 710000 23                 TRA     s:18199
        23 002132   002142 710000 23                 TRA     s:18199
        23 002133   002142 710000 23                 TRA     s:18199
        23 002134   002137 710000 23                 TRA     s:18197
        23 002135   002142 710000 23                 TRA     s:18199
        23 002136   002137 710000 23                 TRA     s:18197

      593    18196    2      CASE (%TYA, %TYN, %TYB, %TYE);

      594    18197    2        TYPE = VAR$ -> LX_ETT_ITEM.TYPE;

  18197 23 002137   000004 235100                    LDA     4,,PR0
        23 002140   200117 755100                    STA     TYPE,,AUTO
        23 002141   002160 710000 23                 TRA     s:18210

      595    18198    2      CASE (ELSE);

      596    18199    2        CALL Z8AF$FORME (%DNA,

  18199 23 002142   200107 631500                    EPPR1   STRT_POS$,,AUTO
        23 002143   200161 451500                    STP1    TYPE_DESC+7,,AUTO
        23 002144   000022 236000 24                 LDQ     18
        23 002145   200160 756100                    STQ     TYPE_DESC+6,,AUTO
        23 002146   200107 633500                    EPPR3   STRT_POS$,,AUTO
        23 002147   200157 453500                    STP3    TYPE_DESC+5,,AUTO
        23 002150   000045 236000 24                 LDQ     37
        23 002151   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 002152   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 002153   000003 631400 24                 EPPR1   3
        23 002154   000000 701000 xent               TSX1    Z8AF$FORME
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:115  
        23 002155   000000 011000                    NOP     0

      597    18200    2                         STRT_POS$,
      598    18201    2                         0,
      599    18202    2                         STRT_POS$);
      600    18203    2        TYPE = %TYA;

  18203 23 002156   000010 235007                    LDA     8,DL
        23 002157   200117 755100                    STA     TYPE,,AUTO

      601    18204    2      END;

      602    18205
      603    18206         %CREATE_LENGTH_ITEMS (@FISS      = FISS,
      604    18207                               @SIZ$      = SIZ$,
      605    18208                               @START_AT$ = STRT_POS$,
      606    18209                               @RETURN$   = VAR$ -> LX_ETT_ITEM.ETT$);

  18210 23 002160   200112 236100                    LDQ     SIZ$,,AUTO
        23 002161   000000 116000 24                 CMPQ    0
        23 002162   002200 601000 23                 TNZ     s:18213

  18211 23 002163   200106 236100                    LDQ     VAR$,,AUTO
        23 002164   000001 036003                    ADLQ    1,DU
        23 002165   000022 235000 24                 LDA     18
        23 002166   200160 757100                    STAQ    TYPE_DESC+6,,AUTO
        23 002167   200116 630500                    EPPR0   FISS,,AUTO
        23 002170   200157 450500                    STP0    TYPE_DESC+5,,AUTO
        23 002171   200107 631500                    EPPR1   STRT_POS$,,AUTO
        23 002172   200156 451500                    STP1    TYPE_DESC+4,,AUTO
        23 002173   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 002174   000003 631400 24                 EPPR1   3
        23 002175   000000 701000 xent               TSX1    Z8AF$NEW_FISS
        23 002176   000000 011000                    NOP     0
        23 002177   002215 710000 23                 TRA     s:18223

  18213 23 002200   200106 236100                    LDQ     VAR$,,AUTO
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:116  
        23 002201   000001 036003                    ADLQ    1,DU
        23 002202   200161 756100                    STQ     TYPE_DESC+7,,AUTO
        23 002203   200112 630500                    EPPR0   SIZ$,,AUTO
        23 002204   200160 450500                    STP0    TYPE_DESC+6,,AUTO
        23 002205   200107 631500                    EPPR1   STRT_POS$,,AUTO
        23 002206   200157 451500                    STP1    TYPE_DESC+5,,AUTO
        23 002207   000047 236000 24                 LDQ     39
        23 002210   200156 756100                    STQ     TYPE_DESC+4,,AUTO
        23 002211   200156 630500                    EPPR0   TYPE_DESC+4,,AUTO
        23 002212   000003 631400 24                 EPPR1   3
        23 002213   000000 701000 xent               TSX1    Z8AF$FORME
        23 002214   000000 011000                    NOP     0

      607    18215
      608    18216         %INIT_LX_ETT_ITEM (@POINTER = RETURN$,
      609    18217                            @REFMOD  = TRUE,
      610    18218                            @ETT$    = VAR$ -> LX_ETT_ITEM.ETT$,
      611    18219                            @TYPE    = TYPE,
      612    18220                            @LINE    = VAR$ -> LX_ETT_ITEM.LINE,
      613    18221                            @COLUMN  = VAR$ -> LX_ETT_ITEM.COLUMN);

  18223 23 002215   200006 470500                    LDP0    @RETURN$,,AUTO
        23 002216   000000 471500                    LDP1    0,,PR0
        23 002217   000004 220003                    LDX0    4,DU
        23 002220   100000 740100                    STX0    0,,PR1

  18224 23 002221   000000 471500                    LDP1    0,,PR0
        23 002222   000000 221003                    LDX1    0,DU
        23 002223   100000 441100                    SXL1    0,,PR1

  18225 23 002224   000000 471500                    LDP1    0,,PR0
        23 002225   200117 235100                    LDA     TYPE,,AUTO
        23 002226   100004 755100                    STA     4,,PR1

  18226 23 002227   000000 471500                    LDP1    0,,PR0
        23 002230   000000 236000 24                 LDQ     0
        23 002231   100007 756100                    STQ     7,,PR1
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:117  

  18227 23 002232   000000 471500                    LDP1    0,,PR0
        23 002233   200106 473500                    LDP3    VAR$,,AUTO
        23 002234   300001 236100                    LDQ     1,,PR3
        23 002235   100001 756100                    STQ     1,,PR1

  18228 23 002236   000000 471500                    LDP1    0,,PR0
        23 002237   000000 236000 24                 LDQ     0
        23 002240   100002 756100                    STQ     2,,PR1

  18230 23 002241   000000 471500                    LDP1    0,,PR0
        23 002242   200106 473500                    LDP3    VAR$,,AUTO
        23 002243   300005 235100                    LDA     5,,PR3
        23 002244   100005 755100                    STA     5,,PR1

  18231 23 002245   000000 471500                    LDP1    0,,PR0
        23 002246   200106 473500                    LDP3    VAR$,,AUTO
        23 002247   300006 235100                    LDA     6,,PR3
        23 002250   100006 755100                    STA     6,,PR1

  18239 23 002251   000000 471500                    LDP1    0,,PR0
        23 002252   010000 236007                    LDQ     4096,DL
        23 002253   100000 256100                    ORSQ    0,,PR1

      614    18243
      615    18244    1     RETURN;

  18244 23 002254   000000 702200 xent               TSX2  ! X66_ARET
      616    18245
      617    18246    1   END Z8EY$SUBSTR;
      618    18247        %EOD;

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:118  
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_SRCH.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$SUBSTR.
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:119  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 002 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 003 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 004 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:120  
  ****  Section 005 LblCom SRCH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 SRCH

  ****  Section 006 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 007 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 008 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 009 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 010 LblCom ST$

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:121  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 011 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 012 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 013 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 014 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 015 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:122  

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 016 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 017 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 018 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 019 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 020 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:123  

  ****  Section 021 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 022 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   127-0-0/w PTR         r     1 @FISS                    150-0-0/w PTR         r     1 @LENGTH
     5-0-0/w PTR         r     1 @LENGTH$$                136-0-0/w PTR         r     1 @OFF
   135-0-0/w PTR         r     1 @OFF                     126-0-0/w PTR         r     1 @OFF
   136-0-0/w PTR         r     1 @PREV_OFF                  6-0-0/w PTR         r     1 @RETURN$
   151-0-0/w PTR         r     1 @SIZ$                    130-0-0/w PTR         r     1 @SIZ$
   135-0-0/w PTR         r     1 @START$                  137-0-0/w PTR         r     1 @START$
   127-0-0/w PTR         r     1 @START$                    4-0-0/w PTR         r     1 @START$$
   147-0-0/w PTR         r     1 @STRING$                 125-0-0/w PTR         r     1 @STRING$
   141-0-0/w PTR         r     1 @STRING$                 125-0-0/w PTR         r     1 @STRING$
   126-0-0/w PTR         r     1 @STRT_POS$                 3-0-0/w PTR         r     1 @VAR$$
   137-0-0/w PTR         r     1 @VARIABLE_START          140-0-0/w PTR         r     1 @VARIABLE_START
   120-0-0/w SBIN        r     1 BYTE_SIZE                114-0-0/b BIT         r     1 CONV_FLAG
   116-0-0/w SBIN        r     1 FISS                      *0-0-0/w SBIN        r     1 FISS
    32-0-0/d STRC(288)   r     1 LENGTH                    *0-0-0/w SBIN        r     1 LENGTH
   132-0-0/w SBIN        r     1 LENGTH                   144-0-0/w SBIN        r     1 LENGTH
   104-0-0/w PTR         r     1 LENGTH$                   *0-0-0/w PTR         r     1 LENGTH$$
    62-0-0/d STRC(288)   r     1 LENGTH_TIMES_2           122-0-0/w SBIN        r     1 MAXLEN
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:124  
   142-0-0/w SBIN        r     1 MAX_OFF_PRECISION          7-0-0/w STRC(324)         1 NAME
   115-0-0/w SBIN        r     1 OFF                       *0-0-0/w SBIN        r     1 OFF
    *0-0-0/w SBIN        r     1 OFF                       *0-0-0/w SBIN        r     1 OFF
   143-0-0/w PTR         r     1 OFF$                     132-0-0/w PTR         r     1 OFF$
   130-0-0/w STRC(72)          1 OFFSET                    52-0-0/d STRC(288)   r     1 OFFSET_TIMES_2
   123-0-0/w SBIN        r     1 OP                        *0-0-0/w SBIN        r     1 PREV_OFF
    *0-0-0/w PTR         r     1 RETURN$                  121-0-0/b BIT         r     1 SBCHK_FLAG
   112-0-0/w PTR         r     1 SIZ$                      *0-0-0/w PTR         r     1 SIZ$
    *0-0-0/w PTR         r     1 SIZ$                     145-0-0/w PTR         r     1 SIZ$
   131-0-0/w PTR         r     1 ST$$                      20-0-0/w PTR         r     1 START$
    *0-0-0/w PTR         r     1 START$                    *0-0-0/w PTR         r     1 START$
    *0-0-0/w PTR         r     1 START$                    *0-0-0/w PTR         r     1 START$$
    22-0-0/d STRC(288)   r     1 START_POS                105-0-0/w PTR         r     1 STRING$
    *0-0-0/w PTR         r     1 STRING$                   *0-0-0/w PTR         r     1 STRING$
    *0-0-0/w PTR         r     1 STRING$                   *0-0-0/w PTR         r     1 STRING$
   111-0-0/w PTR         r     1 STRING_ST$               107-0-0/w PTR         r     1 STRT_POS$
    *0-0-0/w PTR         r     1 STRT_POS$                 42-0-0/d STRC(288)   r     1 SUBSTR_VAR
   113-0-0/w PTR         r     1 TABLE_ETT$               110-0-0/w PTR         r     1 TEMP$
    72-0-0/d STRC(288)   r     1 TWO                      103-0-0/w PTR         r     1 TWO$
   117-0-0/w SBIN        r     1 TYPE                     152-0-0/w STRC(144)   r     1 TYPE_DESC
   106-0-0/w PTR         r     1 VAR$                      *0-0-0/w PTR         r     1 VAR$$
    *0-0-0/w BIT         r     1 VARIABLE_START            *0-0-0/w BIT         r     1 VARIABLE_START
   133-0-0/b BIT         r     1 VARIABLE_START           102-0-0/w PTR         r     1 VAR_ST$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580) r     1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:125  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)         1 ILS                        0-0-0/w STRC(288)         1 ILS_LIST
     0-0-0/w STRC(108)         1 INDEXES                    0-0-0/w STRC(360)         1 INIT_LTS
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:126  
     0-0-0/w STRC(288)         1 INSPECT_1_STMT             0-0-0/w STRC(288)         1 INSPECT_2_STMT
     0-0-0/w STRC(288)         1 INSPECT_4_STMT             0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)         1 LABEL                      0-0-0/w STRC(288)         1 LA_ITEM
     0-0-0/w STRC(36864)       1 LCNST                      0-0-0/w STRC(108)         1 LINOI
     0-0-0/w STRC(72)    r     1 LONG                       0-0-0/w STRC        r     1 LTS
     0-0-0/w STRC(360)   r     1 LTSS                       0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY
     0-0-0/w STRC(504)         1 LX_CD_INPUT                0-0-0/w STRC(324)         1 LX_CD_I_O
     0-0-0/w STRC(396)         1 LX_CD_OUTPUT               0-0-0/w STRC(288)   r     1 LX_ETT_ITEM
     0-0-0/w STRC(288)         1 LX_ITEM                    0-0-0/w STRC(288)         1 LX_LARGE
     0-0-0/w STRC(288)         1 LX_LIST                    0-0-0/w STRC(1224)        1 LX_REC_DECL
     0-0-0/w STRC(864)         1 LX_REPORT_REC              0-0-0/w STRC(288)         1 LX_TERMINAL
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(288)         1 MULTIPLY_STMT              0-0-0/w STRC(180)         1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)   r     1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(288)         1 READ_STMT                  0-0-0/w STRC(216)         1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(288)         1 REWRITE_STMT               0-0-0/w STRC(144)         1 RVA_LTS
     0-0-0/w STRC(396)   r     1 SCALAR                     0-0-0/w STRC(144)         1 SCOPE
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(216)         1 SEARCH_
     0-0-0/w STRC(396)         1 SECTION                    0-0-0/w STRC(396)         1 SEGMENT
     0-0-0/w STRC(360)         1 SEGMENT_LTS                0-0-0/w STRC(396)         1 ST
     0-0-0/w STRC(288)         1 START_STMT                 0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 STRING_STMT                0-0-0/w STRC(288)         1 SUBTRACT_STMT
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)         1 SYMDEF_
PL6.E3A0      #002=Z8EY$SUBSTR File=Z8EY.:Z8A6TSI                                SAT 08/09/97 13:00 Page:127  
     0-0-0/w STRC(396)         1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/w STRC(288)         1 UNARY_OP                   0-0-0/w STRC(288)         1 UNSTRING_STMT
     0-0-0/d STRC(612)         1 USE                        0-0-0/w STRC(216)         1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EY$SUBSTR requires 1197 words for executable code.
   Procedure Z8EY$SUBSTR requires 116 words of local(AUTO) storage.

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:128  
      619        1        /*T***********************************************************/
      620        2        /*T*                                                         */
      621        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      622        4        /*T*                                                         */
      623        5        /*T***********************************************************/
      624        6        Z8EY$SUBSCRIPT: PROC (SUBSCR_LIST$, IDENT$);
      625        7
      626        8        %EQU PHASE = 1;
      627        9
      628       10        %INCLUDE Z8A_DEFC;
      629       78        %INCLUDE Z9A_FLAGS;
      630       92        %INCLUDE Z8A_SUPP_MAC;
      631     2492        %INCLUDE Z8A_ETT;
      632     2793        %INCLUDE Z8A_ILL;
      633     3486        %INCLUDE Z8A_SRCH;
      634     3535        %INCLUDE Z8A_DNT;
      635     3756        %INCLUDE Z8A_ST;
      636     7415        %INCLUDE Z8A_TYPES;
      637     7589        %INCLUDE Z8A_QLT;
      638     7695        %INCLUDE Z8A_LTS;
      639     9772        %INCLUDE Z8E_HEAP;
      640     9828        %INCLUDE Z8A_COMCOM;
      641    10478        %INCLUDE Z8A_ERR_NUMS;
      642    11242        %INCLUDE Z8E_WINDOW;
      643    13312        %INCLUDE Z8E_STACKS;
      644    15578        %INCLUDE Z8E_MACROS;
      645    16253        %INCLUDE Z8E_ABSSYN;
      646    16459        %INCLUDE Z8E_O1COM;
      647    17220
      648    17221    1   DCL Z8AC$MAKE_CONST           ENTRY(1);
      649    17222    1   DCL Z8AU$TYPE_DESCRIPTOR      ENTRY(2);
      650    17223    1   DCL Z8AF$NEW_BASE             ENTRY (3);
      651    17224    1   DCL Z8AF$NEW_FISS             ENTRY (4);
      652    17225    1   DCL Z8AU$UNITS                ENTRY(2);
      653    17226    1   DCL Z8EQ$CHECK_FOR_INTEGER_ITEM      ENTRY (2) ALTRET;
      654    17227    1   DCL Z8AF$NEW_OFF              ENTRY (3);
      655    17228    1   DCL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK ENTRY (4);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:129  
      656    17229    1   DCL Z8AE$ERROR                ENTRY(12);
      657    17230    1   DCL Z8AF$FORME                ENTRY(4);
      658    17231    1   DCL Z8EV$CONVERT              ENTRY(3);
      659    17232    1   DCL Z8E5$MATH_PACK            ENTRY(2);
      660    17233
      661    17234    1   DCL IDENT$                    PTR;
      662    17235    1   DCL SUBSCR_LIST$              PTR;
      663    17236
      664    17237    1   DCL ARRAY_ST$                 PTR;
      665    17238    1   DCL GLOBAL_DIMS$         PTR;
      666    17239    1   DCL SS_EXP$                   PTR;
      667    17240    1   DCL NEW_ETT$                  PTR;
      668    17241    1   DCL LIST$                     PTR;
      669    17242    1   DCL SUBSCRIPT#                SBIN WORD;
      670    17243    1   DCL OFF                       SBIN WORD;
      671    17244    1   DCL LAST_DIM                  SBIN WORD;
      672    17245    1   DCL DIM#                      SBIN WORD;
      673    17246    1   DCL SPAN#                     SBIN WORD;
      674    17247    1   DCL DIM$                      PTR;
      675    17248    1   DCL INDEXES$                  PTR;
      676    17249    1   DCL ID_TYPE                   UBIN;
      677    17250
      678    17251        %INCLUDE Z8A_MKCN;
      679    17268    1   DCL INDEX_SUB                 BIT(1);
      680    17269        %DCL_AUTO_LX_ITEM (@NAME = OP_NODE);
      681    17273
      682    17274        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:130  
      683    17275        %MACRO OPTIMIZE_FOR_ADI_OR_SBI;
      684    17276         DO;
      685    17277             IF LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP -> ETT.ID = %TRIAD THEN
      686    17278               DO;
      687    17279                 IF LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SBI THEN
      688    17280                   DO;
      689    17281                     OFF = - (LIST$ -> LX_ETT_ITEM.ETT$ ->
      690    17282                           ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 * SPAN#) + OFF;
      691    17283                     DIM# = + LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP ->
      692    17284                              ETT.LOP -> CONST.CONSTI.WORD1 + DIM#;
      693    17285                   END;
      694    17286                 ELSE
      695    17287                   DO;
      696    17288                     OFF = LIST$ -> LX_ETT_ITEM.ETT$ ->
      697    17289                           ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 * SPAN# + OFF;
      698    17290
      699    17291                     DIM# = - LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP ->
      700    17292                            ETT.LOP -> CONST.CONSTI.WORD1 + DIM#;
      701    17293                   END;
      702    17294
      703    17295
      704    17296               END;/* If -- lop is a base and rop is a triad */
      705    17297         END;
      706    17298        %MEND;
      707    17299        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:131  
      708    17300        %MACRO CHECK_CONST_FOR_OUT_OF_BOUNDS (@SUBSCRIPT$ = LIST$);
      709    17301
      710    17302           IF @SUBSCRIPT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %TRIAD THEN
      711    17303             IF @SUBSCRIPT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1 < 1
      712    17304             OR @SUBSCRIPT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1 > DIM# THEN
      713    17305               CALL Z8AE$ERROR (%E$SUBSCRIPT_OUT_OF_BOUNDS);
      714    17306        %MEND;
      715    17307        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:132  
      716    17308        %MACRO ADJUST_SUBSCRIPT_FOR_SPAN(@ETT$ = LIST$->LX_ETT_ITEM.ETT$);
      717    17309           DO ;
      718    17310             CALL SUBCHK (DIM#, @ETT$, @ETT$);
      719    17311
      720    17312             IF SPAN# = 1 THEN
      721    17313               NEW_ETT$ = @ETT$;
      722    17314             ELSE
      723    17315               DO;
      724    17316                 MKCN.CON = SPAN#;
      725    17317                 CALL Z8AC$MAKE_CONST (ETT$$);
      726    17318                 CALL Z8AF$FORME(%MPI, @ETT$, ETT$$, NEW_ETT$) ;
      727    17319               END;
      728    17320           END;
      729    17321        %MEND;
      730    17322        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:133  
      731    17323    1   CHECK_FOR_INDEX_SUB: PROC (NODE$, INDEX_SUB);
      732    17324
      733    17325    2        DCL NODE$         PTR;
      734    17326    2        DCL INDEX_SUB     BIT (1) ALIGNED;
      735    17327
      736    17328    2        DCL NODE_ST$      PTR;
      737    17329
      738    17330
      739    17331    3        DO SELECT (NODE$ -> LX_ETT_ITEM.TYPE);
      740    17332    3          SELECT (%TYY);
      741    17333                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      742    17334                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      743    17335                                     @LINE     = NODE$ -> LX_ETT_ITEM.LINE,
      744    17336                                     @COLUMN   = NODE$ -> LX_ETT_ITEM.COLUMN);
      745    17366
      746    17367    3          SELECT (%TYX);
      747    17368                 %FISH (TRIAD = NODE$ -> LX_ETT_ITEM.ETT$,
      748    17369                        RTN   = NODE_ST$);
      749    17377
      750    17378    3            IF NODE_ST$ -> SCALAR.LTS$ ~= ADDR(NIL) THEN
      751    17379    3              INDEX_SUB = TRUE;
      752    17380    3            ELSE
      753    17381                   %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      754    17382                                       @ERROR#   = %E$INVALID_SUBSCRIPT,
      755    17383                                       @LINE     = NODE$ -> LX_ETT_ITEM.LINE,
      756    17384                                       @COLUMN   = NODE$ -> LX_ETT_ITEM.COLUMN);
      757    17414
      758    17415    3          SELECT (ELSE);
      759    17416    3            INDEX_SUB = FALSE;
      760    17417    3        END; /* SELECT */
      761    17418
      762    17419    2   END CHECK_FOR_INDEX_SUB;
      763    17420        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:134  
      764    17421    1   VERIFY_POS_INTEGER_NUM_LIT: PROC (NODE$) ALTRET;
      765    17422
      766    17423    2   DCL NODE$              PTR;
      767    17424        %DCL_NUM_DESC;
      768    17433
      769    17434    2      CALL VERIFY_NUMERIC_LITERAL (NODE$, NUM_DESC)
      770    17435    2        WHENALTRETURN
      771    17436    3          DO;
      772    17437    3            ALTRETURN;
      773    17438    3          END;
      774    17439
      775    17440    2      IF NUM_DESC.MANTISSA_SIGN_VALUE = %MINUS_SIGN_VALUE THEN
      776    17441    2        ALTRETURN;
      777    17442
      778    17443    2   END VERIFY_POS_INTEGER_NUM_LIT;
      779    17444        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:135  
      780    17445    1   VERIFY_NUMERIC_LITERAL: PROC (NODE$, NUM_DESC) ALTRET;
      781    17446
      782    17447    2   DCL NODE$              PTR;
      783    17448
      784    17449        %DCL_NUM_DESC;
      785    17458
      786    17459    2   DCL Z8AU$CREATE_NUM_DESC      ENTRY (3);
      787    17460
      788    17461    2      CALL Z8AU$CREATE_NUM_DESC (NODE$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME,
      789    17462    2                                 BINBIT (NODE$ -> LX_TERMINAL.DNT$ ->
      790    17463    2                                         DNT.TEXT.LENGTH,36),
      791    17464    2                                 NUM_DESC);
      792    17465
      793    17466    2      IF NUM_DESC.DIGITS_RIGHT ~= 0 THEN
      794    17467    2        ALTRETURN;
      795    17468
      796    17469    2      IF NUM_DESC.DIGITS_EXPONENT ~= 0 THEN
      797    17470    2        ALTRETURN;
      798    17471
      799    17472    2      IF NUM_DESC.EXPONENT_SIGN_VALUE ~= %NO_SIGN_VALUE THEN
      800    17473    2        ALTRETURN;
      801    17474
      802    17475    2   END VERIFY_NUMERIC_LITERAL;
      803    17476        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:136  
      804    17477    1   VERIFY_SUBSCRIPT_SYNTAX: PROC(NODE$, INDEX_SUB);
      805    17478
      806    17479    2   DCL NODE$           PTR;
      807    17480    2   DCL ERROR_LINE#               SBIN WORD;
      808    17481    2   DCL ERROR_COLUMN#             SBIN WORD;
      809    17482    2   DCL SYMBOL                    SBIN WORD;
      810    17483    2   DCL INDEX_SUB                 BIT (1) ALIGNED;
      811    17484        %DCL_NUM_DESC;
      812    17493
      813    17494    2      INDEX_SUB = FALSE;
      814    17495
      815    17496    3      DO CASE(NODE$ -> LX_ETT_ITEM.ID);
      816    17497    3        CASE(%BINARY_OP);
      817    17498    3          ERROR_LINE#   = NODE$ -> BINARY_OP.LINE;
      818    17499    3          ERROR_COLUMN# = NODE$ -> BINARY_OP.COLUMN;
      819    17500
      820    17501    3          IF NODE$ -> BINARY_OP.OP = %OP_BINARY_MINUS
      821    17502    3          OR NODE$ -> BINARY_OP.OP = %OP_PLUS THEN
      822    17503    4            DO;
      823    17504    4              IF NODE$ -> BINARY_OP.LOP$ ->
      824    17505    4              LX_ETT_ITEM.ID = %LX_ETT_ITEM THEN
      825    17506    5                DO;
      826    17507    5                  IF NODE$ -> BINARY_OP.LOP$ ->
      827    17508    5                  LX_ETT_ITEM.ETT$ -> ETT.ID ~= %BASE THEN
      828    17509                         %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      829    17510                                             @ERROR#   = %E$INVALID_SUBSCRIPT,
      830    17511                                             @LINE     = ERROR_LINE#,
      831    17512                                             @COLUMN   = ERROR_COLUMN#);
      832    17542    5                  ELSE
      833    17543    5                    CALL CHECK_FOR_INDEX_SUB (NODE$ -> BINARY_OP.LOP$, INDEX_SUB);
      834    17544    5                END;
      835    17545    4              ELSE
      836    17546                     %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      837    17547                                         @ERROR#   = %E$INVALID_SUBSCRIPT,
      838    17548                                         @LINE     = ERROR_LINE#,
      839    17549                                         @COLUMN   = ERROR_COLUMN#);
      840    17579
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:137  
      841    17580    4              IF NODE$ -> BINARY_OP.ROP$ ->
      842    17581    4              LX_ETT_ITEM.ID = %LX_TERMINAL THEN
      843    17582    5                DO;
      844    17583    5                  SYMBOL = NODE$ -> BINARY_OP.ROP$ -> LX_TERMINAL.SYMBOL;
      845    17584
      846    17585    6                  DO CASE (SYMBOL);
      847    17586    6                    CASE (%NUMBER, %NUMBER_OR_PARAGRAPH);
      848    17587    6                      CALL CHECK_FOR_INDEX_SUB (NODE$ -> BINARY_OP.LOP$, INDEX_SUB);
      849    17588
      850    17589    6                    CASE (%NUMERIC_LITERAL);
      851    17590    6                      CALL VERIFY_NUMERIC_LITERAL (NODE$ -> BINARY_OP.ROP$,
      852    17591    6                                                   NUM_DESC)
      853    17592    6                        WHENALTRETURN
      854    17593    7                          DO;
      855    17594                                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      856    17595                                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      857    17596                                                     @LINE     = ERROR_LINE#,
      858    17597                                                     @COLUMN   = ERROR_COLUMN#);
      859    17627    7                          END;
      860    17628
      861    17629    6                      CALL CHECK_FOR_INDEX_SUB (NODE$ -> BINARY_OP.LOP$, INDEX_SUB);
      862    17630
      863    17631    6                    CASE (ELSE);
      864    17632                           %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      865    17633                                               @ERROR#   = %E$INVALID_SUBSCRIPT,
      866    17634                                               @LINE     = ERROR_LINE#,
      867    17635                                               @COLUMN   = ERROR_COLUMN#);
      868    17665
      869    17666    6                  END; /* Case */
      870    17667    5                END;
      871    17668    4              ELSE
      872    17669                     %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      873    17670                                         @ERROR#   = %E$INVALID_SUBSCRIPT,
      874    17671                                         @LINE     = ERROR_LINE#,
      875    17672                                         @COLUMN   = ERROR_COLUMN#);
      876    17702
      877    17703    4            END;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:138  
      878    17704    3          ELSE
      879    17705                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      880    17706                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      881    17707                                     @LINE     = ERROR_LINE#,
      882    17708                                     @COLUMN   = ERROR_COLUMN#);
      883    17738
      884    17739    3          IF NODE$ -> LX_ITEM.B.ERROR THEN
      885    17740    3              INDEX_SUB = FALSE;
      886    17741
      887    17742    3        CASE(%LX_TERMINAL);
      888    17743    3          ERROR_LINE#   = NODE$ -> LX_TERMINAL.LINE;
      889    17744    3          ERROR_COLUMN#  = NODE$ -> LX_TERMINAL.COLUMN;
      890    17745
      891    17746    3          SYMBOL = NODE$ -> LX_TERMINAL.SYMBOL;
      892    17747
      893    17748    4          DO CASE (SYMBOL);
      894    17749    4            CASE (%NUMBER, %NUMBER_OR_PARAGRAPH);
      895    17750    4              /* Peachy */;
      896    17751
      897    17752    4            CASE (%NUMERIC_LITERAL);
      898    17753    4              CALL VERIFY_POS_INTEGER_NUM_LIT (NODE$)
      899    17754    4                WHENALTRETURN
      900    17755    5                  DO;
      901    17756                         %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      902    17757                                             @ERROR#   = %E$INVALID_SUBSCRIPT,
      903    17758                                             @LINE     = ERROR_LINE#,
      904    17759                                             @COLUMN   = ERROR_COLUMN#);
      905    17789    5                  END;
      906    17790
      907    17791    4            CASE (ELSE);
      908    17792                   %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      909    17793                                       @ERROR#   = %E$INVALID_SUBSCRIPT,
      910    17794                                       @LINE     = ERROR_LINE#,
      911    17795                                       @COLUMN   = ERROR_COLUMN#);
      912    17825    4          END; /* Case */
      913    17826
      914    17827    3          CALL Z8EV$CONVERT (%TYI, NODE$, NODE$);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:139  
      915    17828
      916    17829    3        CASE(%LX_ETT_ITEM);
      917    17830    3          ERROR_LINE#   = NODE$ -> LX_ETT_ITEM.LINE;
      918    17831    3          ERROR_COLUMN#  = NODE$ -> LX_ETT_ITEM.COLUMN;
      919    17832
      920    17833    3          IF NODE$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %BASE THEN
      921    17834                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      922    17835                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      923    17836                                     @LINE     = ERROR_LINE#,
      924    17837                                     @COLUMN   = ERROR_COLUMN#);
      925    17867    3          ELSE
      926    17868    3            CALL CHECK_FOR_INDEX_SUB (NODE$, INDEX_SUB);
      927    17869
      928    17870    3        CASE(ELSE);
      929    17871    3          ERROR_LINE#   = NODE$ -> LX_ITEM.LINE;
      930    17872    3          ERROR_COLUMN#  = NODE$ -> LX_ITEM.COLUMN;
      931    17873
      932    17874               %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      933    17875                                   @ERROR#   = %E$INVALID_SUBSCRIPT,
      934    17876                                   @LINE     = ERROR_LINE#,
      935    17877                                   @COLUMN   = ERROR_COLUMN#);
      936    17907
      937    17908    3      END; /* Case */
      938    17909    2   END VERIFY_SUBSCRIPT_SYNTAX;/*  Proc  */
      939    17910        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:140  
      940    17911    1   COMPUTE_SUBSCRIPT_OFFSET: PROC (LIST$, OFF, NEW_ETT$);
      941    17912
      942    17913    2   DCL LIST$                     PTR;
      943    17914    2   DCL OFF                       SBIN WORD;
      944    17915    2   DCL NEW_ETT$                  PTR;
      945    17916    2   DCL ETT$$                     PTR;
      946    17917
      947    17918    3      DO CASE (LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ID);
      948    17919
      949    17920    3        CASE(%ADI);
      950    17921    3          IF COMCOM.OB.SUBCHK THEN
      951    17922                 %ADJUST_SUBSCRIPT_FOR_SPAN (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$);
      952    17935    3          ELSE
      953    17936    4            DO;
      954    17937                   %OPTIMIZE_FOR_ADI_OR_SBI;
      955    17958                   %ADJUST_SUBSCRIPT_FOR_SPAN
      956    17959                           (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP);
      957    17972    4            END;
      958    17973
      959    17974    3        CASE(%SBI);
      960    17975    3          IF COMCOM.OB.SUBCHK THEN
      961    17976                 %ADJUST_SUBSCRIPT_FOR_SPAN (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$);
      962    17989    3          ELSE
      963    17990    4            DO;
      964    17991                   %OPTIMIZE_FOR_ADI_OR_SBI;
      965    18012                   %ADJUST_SUBSCRIPT_FOR_SPAN
      966    18013                           (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP);
      967    18026    4            END;
      968    18027
      969    18028    3        CASE(%TRIAD);
      970    18029    3          OFF = OFF + LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1 *
             18029                   SPAN#;
      971    18030
      972    18031    3        CASE(ELSE);
      973    18032               %ADJUST_SUBSCRIPT_FOR_SPAN(@ETT$= LIST$ -> LX_ETT_ITEM.ETT$);
      974    18045
      975    18046    3      END; /* Case -- id */
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:141  
      976    18047
      977    18048    2   END COMPUTE_SUBSCRIPT_OFFSET;
      978    18049        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:142  
      979    18050    1   WRAP_UP: PROC (SS_EXP$, OFF, IDENT$);
      980    18051
      981    18052    2   DCL SS_EXP$                   PTR;
      982    18053    2   DCL OFF                       SBIN WORD;
      983    18054    2   DCL IDENT$                    PTR;
      984    18055
      985    18056    2   DCL OFF$                      PTR;
      986    18057    2   DCL SIZ$                      PTR;
      987    18058    2   DCL FISS_OFF                  UBIN;
      988    18059    2   DCL REFMOD$                   PTR;
      989    18060    2   DCL MAX_OFF_PRECISION  SBIN;
      990    18061
      991    18062        %IF CP6;
      992    18063    2    IF ARRAY_ST$ -> SCALAR.B.LINKAGE THEN
      993    18064        %ENDIF;
      994    18065    2      MAX_OFF_PRECISION = %#16K;
      995    18066        %IF CP6;
      996    18067    2    ELSE
      997    18068    2      MAX_OFF_PRECISION = %#128K;
      998    18069        %ENDIF;
      999    18070
     1000    18071    2    IF OFF >= MAX_OFF_PRECISION
     1001    18072    2    OR OFF <= - MAX_OFF_PRECISION THEN
     1002    18073    3      DO;
     1003    18074    3        MKCN.CON = OFF;
     1004    18075    3        CALL Z8AC$MAKE_CONST (OFF$);
     1005    18076
     1006    18077    3        IF SS_EXP$ ~= ADDR(NIL) THEN
     1007    18078    3          CALL Z8AF$FORME (%ADI, SS_EXP$, OFF$, SS_EXP$);
     1008    18079    3        ELSE
     1009    18080    3          SS_EXP$ = OFF$;
     1010    18081
     1011    18082    3        OFF = 0;
     1012    18083    3      END;
     1013    18084
     1014    18085    2    FISS_OFF = 0;
     1015    18086    2    REFMOD$ = ADDR(NIL);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:143  
     1016    18087    3    IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %FISS THEN DO;
     1017    18088    3      FISS_OFF = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.SIZE.VALUE;
     1018    18089    3      IDENT$ -> LX_ETT_ITEM.ETT$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP;
     1019    18090    3    END;
     1020    18091    3    ELSE IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %REFMOD THEN DO;
     1021    18092    3      REFMOD$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP;
     1022    18093    3      IDENT$ -> LX_ETT_ITEM.ETT$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP;
     1023    18094    3    END;
     1024    18095    2    SIZ$ = ADDR(NIL);
     1025    18096    2    IF OFF ~= 0
     1026    18097    2    OR SS_EXP$ ~= ADDR(NIL) THEN
     1027    18098    3      IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SIZ THEN DO;
     1028    18099    3        SIZ$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP;
     1029    18100    3        IDENT$ -> LX_ETT_ITEM.ETT$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP;
     1030    18101    3      END;
     1031    18102
     1032    18103    2    ID_TYPE = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> VARIABLE.TYPE;
     1033    18104    2    IF ID_TYPE = %TYC THEN
     1034    18105    2      CALL Z8AF$FORME (%DNA,
     1035    18106    2                       IDENT$ -> LX_ETT_ITEM.ETT$,
     1036    18107    2                       0,
     1037    18108    2                       IDENT$ -> LX_ETT_ITEM.ETT$);
     1038    18109
     1039    18110    2    IF SS_EXP$ ~= ADDR(NIL) THEN
     1040    18111    2      CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK (IDENT$ -> LX_ETT_ITEM.ETT$,
     1041    18112    2                                  OFF,
     1042    18113    2                                  SS_EXP$,
     1043    18114    2                                  IDENT$ -> LX_ETT_ITEM.ETT$);
     1044    18115    2    ELSE
     1045    18116    2    IF OFF ~= 0 THEN
     1046    18117    2      CALL Z8AF$NEW_OFF (IDENT$ -> LX_ETT_ITEM.ETT$,
     1047    18118    2                         OFF,
     1048    18119    2                         IDENT$ -> LX_ETT_ITEM.ETT$);
     1049    18120
     1050    18121    2    IF ID_TYPE = %TYC THEN
     1051    18122    2      CALL Z8AF$FORME (%DAN,
     1052    18123    2                       IDENT$ -> LX_ETT_ITEM.ETT$,
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:144  
     1053    18124    2                       0,
     1054    18125    2                       IDENT$ -> LX_ETT_ITEM.ETT$);
     1055    18126
     1056    18127    2    IF SIZ$ ~= ADDR(NIL) THEN
     1057    18128    2      CALL Z8AF$FORME (%SIZ,
     1058    18129    2                       IDENT$ -> LX_ETT_ITEM.ETT$,
     1059    18130    2                       SIZ$,
     1060    18131    2                       IDENT$ -> LX_ETT_ITEM.ETT$);
     1061    18132
     1062    18133    2   IF REFMOD$ ~= ADDR(NIL) THEN
     1063    18134    2     CALL Z8AF$FORME (%REFMOD,
     1064    18135    2                      IDENT$ -> LX_ETT_ITEM.ETT$,
     1065    18136    2                      REFMOD$,
     1066    18137    2                      IDENT$ -> LX_ETT_ITEM.ETT$);
     1067    18138    2   ELSE IF FISS_OFF ~= 0 THEN
     1068    18139    2     CALL Z8AF$NEW_FISS (IDENT$ -> LX_ETT_ITEM.ETT$,
     1069    18140    2                         FISS_OFF,
     1070    18141    2                         %ALPHA_NUMERIC_FISS,
     1071    18142    2                         IDENT$ -> LX_ETT_ITEM.ETT$);
     1072    18143    2   END WRAP_UP;
     1073    18144        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:145  
     1074    18145    1   CHECK_SUB_PLACEMENT: PROC (INDEX_ST$, INDEXES$);
     1075    18146
     1076    18147    2   DCL INDEX_ST$                 PTR;
     1077    18148    2   DCL INDEXES$                  PTR;
     1078    18149
     1079    18150    2   DCL LAST_DIM#                 SBIN WORD;
     1080    18151    2   DCL DIM_INDEX$                PTR;
     1081    18152    2   DCL I                         SBIN WORD;
     1082    18153
     1083    18154    2      DIM_INDEX$ = INDEXES$;
     1084    18155    3      DO WHILE (DIM_INDEX$ ~= ADDR(NIL));
     1085    18156    3        IF DIM_INDEX$ -> INDEXES.INDEX_ST$ ~= INDEX_ST$ THEN
     1086    18157    3          DIM_INDEX$ = DIM_INDEX$ -> INDEXES.LINK;
     1087    18158    3        ELSE
     1088    18159    3          EXIT;
     1089    18160    3      END; /* While */
     1090    18161
     1091    18162    2      IF DIM_INDEX$ = ADDR(NIL) THEN
     1092    18163             %CONDITIONAL_ERROR (@ERROR# = %E$SUB_IN_WRONG_ORDER,
     1093    18164                                 @LX_ITEM$ = LIST$,
     1094    18165                                 @LINE     = LIST$ -> LX_ITEM.LINE,
     1095    18166                                 @COLUMN   = LIST$ -> LX_ITEM.COLUMN);
     1096    18196
     1097    18197    2   END CHECK_SUB_PLACEMENT;
     1098    18198        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:146  
     1099    18199    1   CONVERT_INDEX_SPAN: PROC (ARRAY_ST$, DIM#, INDEX$, INDEX_ST$, INDEXES$, RETURN_ETT$)
             18199            ;
     1100    18200
     1101    18201    2   DCL ARRAY_ST$          PTR ;
     1102    18202    2   DCL DIM#               SBIN;
     1103    18203    2   DCL INDEX$             PTR ;
     1104    18204    2   DCL INDEX_ST$          PTR ;
     1105    18205    2   DCL INDEXES$           PTR;
     1106    18206    2   DCL RETURN_ETT$        PTR;
     1107    18207
     1108    18208    2   DCL ROPCON             SBIN WORD ;
     1109    18209    2   DCL UNITS              SBIN WORD;
     1110    18210    2   DCL SPAN$              PTR;
     1111    18211    2   DCL THREE$             PTR;
     1112    18212
     1113    18213        %DCL_AUTO_LX_ITEM (@NAME = INT_CONST);
     1114    18217
     1115    18218         /* This procedure cannot be invoked unless the subscript is an
     1116    18219            index name, possibly + or - an integer constant. In this case,
     1117    18220            if SCALAR.LTS$ is not ADDR(NIL), it points to the %ARRAY with
     1118    18221            which the index name is associated. */
     1119    18222
     1120    18223    2    IF INDEX_ST$ -> SCALAR.LTS$ ~= ADDR(NIL) THEN
     1121    18224    2      CALL CHECK_SUB_PLACEMENT (INDEX_ST$, INDEXES$);
     1122    18225
     1123    18226    2    CALL Z8AF$FORME (%BASE,
     1124    18227    2                     INDEX_ST$ -> SCALAR.QLT$ -> QLT.BROTHER ->
     1125    18228    2                                  QLT.SON -> QLT.ST$,
     1126    18229    2                     ADDR(NIL),
     1127    18230    2                     RETURN_ETT$);
     1128    18231
     1129    18232    2    IF INDEX_ST$ -> SCALAR.LTS$ = ADDR(NIL)
     1130    18233    2        OR NOT INDEX_ST$ -> SCALAR.LTS$ -> ARRAY.B.ELEMENTARY THEN
     1131    18234    3      DO;
     1132    18235    3        CALL Z8AU$UNITS (ARRAY_ST$, UNITS);
     1133    18236
     1134    18237    4        DO CASE (UNITS);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:147  
     1135    18238    4          CASE (%ALPHA4, %NUMERIC4);
     1136    18239    4            CALL Z8AF$FORME(%MPI2, RETURN_ETT$, 1, RETURN_ETT$) ;
     1137    18240
     1138    18241    4          CASE (%WORD_);
     1139    18242    4            CALL Z8AF$FORME(%DVI2, RETURN_ETT$, 2, RETURN_ETT$) ;
     1140    18243
     1141    18244    4          CASE (%ALPHA9, %NUMERIC9);
     1142    18245    4            /* Peachy */;
     1143    18246
     1144    18247    4          CASE(%ALPHA6);
     1145    18248    4            MKCN.CON = 3;
     1146    18249    4            CALL Z8AC$MAKE_CONST(THREE$);
     1147    18250    4            CALL Z8AF$FORME(%MPI, RETURN_ETT$, THREE$, RETURN_ETT$);
     1148    18251    4            CALL Z8AF$FORME(%DVI2, RETURN_ETT$, 1, RETURN_ETT$);
     1149    18252
     1150    18253    4          CASE(%BIT_, ELSE);
     1151    18254    4            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
     1152    18255
     1153    18256    4        END ; /* Case -- type */
     1154    18257    3      END;
     1155    18258
     1156    18259    2    IF INDEX$ -> LX_ITEM.ID = %BINARY_OP THEN
     1157    18260    3      DO; /* Possible only if SBCHK */
     1158    18261    3        CALL Z8EV$CONVERT (%TYI, INDEX$ -> BINARY_OP.ROP$, ADDR(INT_CONST));
     1159    18262    3        MKCN.CON = SPAN#;
     1160    18263    3        CALL Z8AC$MAKE_CONST (SPAN$);
     1161    18264    3        CALL Z8AF$FORME (%MPI,
     1162    18265    3                         ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$,
     1163    18266    3                         SPAN$,
     1164    18267    3                         ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$);
     1165    18268    3        IF INDEX$ -> BINARY_OP.OP = %OP_PLUS THEN
     1166    18269    3          CALL Z8AF$FORME (%ADI,
     1167    18270    3                           RETURN_ETT$,
     1168    18271    3                           ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$,
     1169    18272    3                           RETURN_ETT$);
     1170    18273    3        ELSE
     1171    18274    3          CALL Z8AF$FORME (%SBI,
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:148  
     1172    18275    3                           RETURN_ETT$,
     1173    18276    3                           ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$,
     1174    18277    3                           RETURN_ETT$);
     1175    18278    3      END;
     1176    18279
     1177    18280    2    CALL INDEX_SUBCHK (DIM#, RETURN_ETT$, RETURN_ETT$);
     1178    18281
     1179    18282    2   END ; /* Proc -- convert_index_span */
     1180    18283
     1181    18284        %EJECT ;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:149  
     1182    18285    1   INDEX_SUBSCRIPT: PROC (NODE$, OFF, INDEXES$, NEW_ETT$);
     1183    18286
     1184    18287    2   DCL NODE$                     PTR;
     1185    18288    2   DCL INDEXES$                  PTR;
     1186    18289    2   DCL OFF                       SBIN WORD;
     1187    18290    2   DCL NEW_ETT$                  PTR;
     1188    18291
     1189    18292    2   DCL INDEX_ST$                 PTR;
     1190    18293
     1191    18294        %DCL_AUTO_LX_ITEM (@NAME = INT_CONST);
     1192    18298
     1193    18299    3      DO CASE (NODE$ -> LX_ITEM.ID);
     1194    18300    3        CASE(%BINARY_OP);
     1195    18301    3          IF COMCOM.OB.SUBCHK THEN
     1196    18302    4            DO;
     1197    18303                   %FISH (TRIAD = NODE$ -> BINARY_OP.LOP$ -> LX_ETT_ITEM.ETT$, RTN =
             18303                       INDEX_ST$);
     1198    18311    4              DIM# = DIM# * SPAN#;
     1199    18312    4              CALL CONVERT_INDEX_SPAN (ARRAY_ST$,
     1200    18313    4                                       DIM#,
     1201    18314    4                                       NODE$,
     1202    18315    4                                       INDEX_ST$,
     1203    18316    4                                       INDEXES$,
     1204    18317    4                                       NEW_ETT$);
     1205    18318    4            END;
     1206    18319    3          ELSE
     1207    18320    4            DO;
     1208    18321    4              CALL Z8EV$CONVERT (%TYI, NODE$ -> BINARY_OP.ROP$, ADDR(INT_CONST));
     1209    18322
     1210    18323    4              IF NODE$ -> BINARY_OP.OP = %OP_PLUS THEN
     1211    18324    5                DO;
     1212    18325    5                  OFF = (ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI
             18325                           .WORD1
     1213    18326    5                      * SPAN#) + OFF;
     1214    18327
     1215    18328    5                  DIM# = (DIM# * SPAN#) + (SPAN# * - (ADDR(INT_CONST) ->
     1216    18329    5                         LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1));
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:150  
     1217    18330    5                END;
     1218    18331    4              ELSE
     1219    18332    5                DO;
     1220    18333    5                  OFF = -(ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.
             18333                           CONSTI.WORD1
     1221    18334    5                      * SPAN#) + OFF;
     1222    18335
     1223    18336    5                  DIM# = (DIM# * SPAN#) + (SPAN# * (ADDR(INT_CONST) ->
     1224    18337    5                         LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1));
     1225    18338    5                END;
     1226    18339
     1227    18340                   %FISH (TRIAD = NODE$ -> BINARY_OP.LOP$ -> LX_ETT_ITEM.ETT$, RTN =
             18340                       INDEX_ST$);
     1228    18348
     1229    18349
     1230    18350    4              CALL CONVERT_INDEX_SPAN (ARRAY_ST$,
     1231    18351    4                                       DIM#,
     1232    18352    4                                       NODE$ -> BINARY_OP.LOP$,
     1233    18353    4                                       INDEX_ST$,
     1234    18354    4                                       INDEXES$,
     1235    18355    4                                       NEW_ETT$);
     1236    18356    4            END;
     1237    18357
     1238    18358    3        CASE (%LX_ETT_ITEM);
     1239    18359
     1240    18360               %FISH (TRIAD = NODE$ -> LX_ETT_ITEM.ETT$, RTN = INDEX_ST$);
     1241    18368
     1242    18369    3          CALL CONVERT_INDEX_SPAN (ARRAY_ST$,
     1243    18370    3                                   DIM# * SPAN#,
     1244    18371    3                                   NODE$,
     1245    18372    3                                   INDEX_ST$,
     1246    18373    3                                   INDEXES$,
     1247    18374    3                                   NEW_ETT$);
     1248    18375
     1249    18376    3        CASE (ELSE);
     1250    18377    3          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);
     1251    18378
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:151  
     1252    18379    3      END;
     1253    18380
     1254    18381    2   END INDEX_SUBSCRIPT;
     1255    18382        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:152  
     1256    18383    1   CHECK_ARRAY_AND_#_SUBS: PROC (ARRAY$, SUB_LIST$, ARRAY_ST$, DIMS$);
     1257    18384
     1258    18385    2   DCL ARRAY$                    PTR;
     1259    18386    2   DCL SUB_LIST$                 PTR;
     1260    18387    2   DCL ARRAY_ST$                 PTR;
     1261    18388    2   DCL DIMS$                     PTR;
     1262    18389    2   DCL NO_DIMS                   SBIN WORD;
     1263    18390
     1264    18391           %FISH (TRIAD = ARRAY$ -> LX_ETT_ITEM.ETT$,
     1265    18392                  RTN   = ARRAY_ST$);
     1266    18400
     1267    18401    2      IF ARRAY_ST$ -> ARRAY.TYPE = %TYY THEN
     1268    18402    3        DO;
     1269    18403               /* The array is IBM index, we only want the occurrence number */
     1270    18404    3          ARRAY_ST$ = ARRAY_ST$ -> SCALAR.QLT$ -> QLT.BROTHER ->
     1271    18405    3                      QLT.SON -> QLT.BROTHER -> QLT.ST$;
     1272    18406
     1273    18407    3          CALL Z8AF$NEW_BASE (ARRAY_ST$, ADDR(NIL), ARRAY$ -> LX_ETT_ITEM.ETT$);
     1274    18408
     1275    18409    3          ARRAY$ -> LX_ETT_ITEM.TYPE = ARRAY_ST$ -> ST.TYPE;
     1276    18410    3        END;
     1277    18411
     1278    18412    2      IF ARRAY_ST$ -> ARRAY.ID ~= %ARRAY THEN
     1279    18413    3        DO;
     1280    18414    3          IF ARRAY_ST$ -> VARIABLE.B.COMPILER_CREATED THEN
     1281    18415    3            ARRAY$ -> LX_ETT_ITEM.B.ERROR = TRUE;
     1282    18416    3          ELSE
     1283    18417                 %CONDITIONAL_ERROR (@LX_ITEM$ = ARRAY$,
     1284    18418                                     @ERROR#   = %E$USING_SCALAR_W_SUBSCRIPT,
     1285    18419                                     @PLUG1    = ARRAY_ST$ -> ARRAY.DNT$,
     1286    18420                                     @LINE     = ARRAY$ -> LX_ETT_ITEM.LINE,
     1287    18421                                     @COLUMN   = ARRAY$ -> LX_ETT_ITEM.COLUMN);
     1288    18451    3          RETURN;
     1289    18452    3        END;
     1290    18453
     1291    18454           %GET_LTS (@ID     = %DIMS,
     1292    18455                     @ST$    = ARRAY_ST$,
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:153  
     1293    18456                     @RETURN$ = DIMS$);
     1294    18499
     1295    18500           %FIND_LAST_DIM (POINTER = DIMS$,
     1296    18501                           VARIABLE= NO_DIMS);
     1297    18506
     1298    18507    2      IF SUB_LIST$ -> LX_LIST.COUNT ~= NO_DIMS THEN
     1299    18508             %CONDITIONAL_ERROR (@LX_ITEM$ = ARRAY$,
     1300    18509                                 @ERROR#   = %E$WRONG_#_OF_SUBS,
     1301    18510                                 @LINE     = ARRAY$ -> LX_ETT_ITEM.LINE,
     1302    18511                                 @COLUMN   = ARRAY$ -> LX_ETT_ITEM.COLUMN);
     1303    18541    2      ELSE IF COMCOM.OB.FIPS.LEVEL = %HIGH_LEV AND SUB_LIST$ -> LX_LIST.COUNT > 7
     1304    18542    2          OR COMCOM.OB.FIPS.LEVEL > %HIGH_LEV AND SUB_LIST$ -> LX_LIST.COUNT > 3 THEN
     1305    18543    2        ARRAY$ -> LX_ETT_ITEM.B.HIGH_LEV = TRUE;
     1306    18544
     1307    18545    2   END CHECK_ARRAY_AND_#_SUBS;
     1308    18546        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:154  
     1309    18547    1   INDEX_SUBCHK: PROC (DIM#, SUB$, OUT$);
     1310    18548
     1311    18549    2   DCL DIM#               SBIN WORD;
     1312    18550    2   DCL SUB$               PTR;
     1313    18551    2   DCL OUT$               PTR;
     1314    18552
     1315    18553    2   DCL DIM$               PTR;
     1316    18554    2   DCL SPAN$              PTR;
     1317    18555
     1318    18556        %DCL_AUTO_LX_ITEM      (@NAME = OCCHK);
     1319    18560
     1320    18561    2      IF COMCOM.OB.SUBCHK THEN
     1321    18562    2        IF SUB$ -> ETT.ID ~= %TRIAD THEN
     1322    18563    3          DO;
     1323    18564    3            MKCN.CON  = DIM#;
     1324    18565    3            CALL Z8AC$MAKE_CONST (DIM$);
     1325    18566
     1326    18567    3            IF GLOBAL_DIMS$ -> DIMS.DN2 ~= ADDR(NIL) THEN
     1327    18568    4              DO;
     1328    18569
     1329    18570                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(OCCHK)",
     1330    18571                                        @ETT$    = GLOBAL_DIMS$ -> DIMS.DN2,
     1331    18572                                        @TYPE    = GLOBAL_DIMS$ -> DIMS.DN2 -> ST.TYPE);
     1332    18594
     1333    18595    4                CALL Z8AF$NEW_BASE (ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,
     1334    18596    4                                    ADDR(NIL),
     1335    18597    4                                    ADDR(OCCHK) -> LX_ETT_ITEM.ETT$);
     1336    18598
     1337    18599    4                CALL Z8EV$CONVERT (%TYI, ADDR(OCCHK), ADDR(OCCHK));
     1338    18600
     1339    18601    4                MKCN.CON = SPAN#;
     1340    18602    4                CALL Z8AC$MAKE_CONST (SPAN$);
     1341    18603
     1342    18604
     1343    18605    4                CALL Z8AF$FORME (%MPI,
     1344    18606    4                                 ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,
     1345    18607    4                                 SPAN$,
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:155  
     1346    18608    4                                 ADDR(OCCHK) -> LX_ETT_ITEM.ETT$);
     1347    18609
     1348    18610    4                CALL Z8AF$FORME (%OCCHK, ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,
     1349    18611    4                                 DIM$, DIM$);
     1350    18612    4              END;
     1351    18613
     1352    18614    3            CALL Z8AF$FORME (%SBCHK, SUB$, DIM$, OUT$);
     1353    18615    3          END;
     1354    18616
     1355    18617    2   END INDEX_SUBCHK;
     1356    18618        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:156  
     1357    18619    1   SUBCHK: PROC (DIM#, SUB$, OUT$);
     1358    18620
     1359    18621    2   DCL DIM#               SBIN WORD;
     1360    18622    2   DCL SUB$               PTR;
     1361    18623    2   DCL OUT$               PTR;
     1362    18624
     1363    18625    2   DCL DIM$               PTR;
     1364    18626
     1365    18627        %DCL_AUTO_LX_ITEM      (@NAME = OCCHK);
     1366    18631
     1367    18632    2      IF COMCOM.OB.SUBCHK THEN
     1368    18633    2        IF SUB$ -> ETT.ID ~= %TRIAD THEN
     1369    18634    3          DO;
     1370    18635    3            MKCN.CON  = DIM#;
     1371    18636    3            CALL Z8AC$MAKE_CONST (DIM$);
     1372    18637
     1373    18638    3            IF GLOBAL_DIMS$ -> DIMS.DN2 ~= ADDR(NIL) THEN
     1374    18639    4              DO;
     1375    18640
     1376    18641                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(OCCHK)",
     1377    18642                                        @ETT$    = GLOBAL_DIMS$ -> DIMS.DN2,
     1378    18643                                        @TYPE    = GLOBAL_DIMS$ -> DIMS.DN2 -> ST.TYPE);
     1379    18665
     1380    18666    4                CALL Z8AF$NEW_BASE (ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,
     1381    18667    4                                    ADDR(NIL),
     1382    18668    4                                    ADDR(OCCHK) -> LX_ETT_ITEM.ETT$);
     1383    18669
     1384    18670    4                CALL Z8EV$CONVERT (%TYI, ADDR(OCCHK), ADDR(OCCHK));
     1385    18671
     1386    18672    4                CALL Z8AF$FORME (%OCCHK, ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,
     1387    18673    4                                 DIM$, DIM$);
     1388    18674    4              END;
     1389    18675
     1390    18676    3            CALL Z8AF$FORME (%SBCHK, SUB$, DIM$, OUT$);
     1391    18677    3          END;
     1392    18678
     1393    18679    2   END SUBCHK;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:157  
     1394    18680        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:158  
     1395    18681    1   COMPUTE_NORMAL_SUBSCRIPT: PROC (NODE$, OFF, NEW_ETT$);
     1396    18682
     1397    18683    2   DCL NODE$                     PTR;
     1398    18684    2   DCL NEW_ETT$                  PTR;
     1399    18685    2   DCL OFF                       SBIN WORD;
     1400    18686
     1401    18687        %DCL_AUTO_LX_ITEM             (@NAME = SUBSCRIPT);
     1402    18691
     1403    18692
     1404    18693    2      CALL Z8E5$MATH_PACK (NODE$, ADDR(SUBSCRIPT));
     1405    18694
     1406    18695           %CHECK_CONST_FOR_OUT_OF_BOUNDS (@SUBSCRIPT$ = "ADDR(SUBSCRIPT)");
     1407    18701
     1408    18702    2      CALL Z8EQ$CHECK_FOR_INTEGER_ITEM (ADDR(SUBSCRIPT),
     1409    18703    2                                        %E$INVALID_SUBSCRIPT);
     1410    18704
     1411    18705    2      CALL COMPUTE_SUBSCRIPT_OFFSET (ADDR(SUBSCRIPT), OFF, NEW_ETT$);
     1412    18706
     1413    18707    2   END COMPUTE_NORMAL_SUBSCRIPT;
     1414    18708        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:159  
     1415    18709
     1416    18710        /*
     1417    18711                               Main Body
     1418    18712        */
     1419    18713    1      CALL CHECK_ARRAY_AND_#_SUBS (IDENT$, SUBSCR_LIST$, ARRAY_ST$, GLOBAL_DIMS$);
     1420    18714
     1421    18715    1      IF IDENT$ -> LX_ITEM.B.ERROR THEN
     1422    18716    1        RETURN;
     1423    18717
     1424    18718    1      SS_EXP$       = ADDR(NIL);
     1425    18719    1      DIM#          = 0;
     1426    18720    1      SPAN#         = 0;
     1427    18721    1      SUBSCRIPT#    = 0;
     1428    18722
     1429    18723    1      OFF    = - GLOBAL_DIMS$ -> DIMS.OD.TOTAL_SPAN;
     1430    18724    1      LIST$  = SUBSCR_LIST$ -> LX_LIST.HEAD$;
     1431    18725
     1432    18726    2      DO UNTIL (LIST$ = ADDR(NIL));
     1433    18727
     1434    18728    2        ADDR(OP_NODE) -> LX_ITEM = LIST$ -> LX_ITEM;
     1435    18729    2        NEW_ETT$      = ADDR(NIL);
     1436    18730
     1437    18731    2        SUBSCRIPT# = SUBSCRIPT# + 1;
     1438    18732    2        IF ARRAY_ST$ -> ARRAY.B.OCCURS_DEPENDING THEN
     1439    18733    2          DIM# = GLOBAL_DIMS$ -> DIMS.OD.INT2;
     1440    18734    2        ELSE
     1441    18735    2          DIM# = GLOBAL_DIMS$ -> DIMS.D.DIM(SUBSCRIPT#);
     1442    18736    2        SPAN# = GLOBAL_DIMS$ -> DIMS.D.SPAN(SUBSCRIPT#);
     1443    18737    2        INDEXES$ = GLOBAL_DIMS$ -> DIMS.D.INDEX$(SUBSCRIPT#);
     1444    18738
     1445    18739    2        CALL VERIFY_SUBSCRIPT_SYNTAX (ADDR(OP_NODE), INDEX_SUB);
     1446    18740
     1447    18741    2        IF ADDR(OP_NODE) -> LX_ITEM.B.ERROR THEN
     1448    18742    2          OFF = OFF + SPAN#;
     1449    18743    2        ELSE
     1450    18744    2          IF INDEX_SUB THEN
     1451    18745    2            CALL INDEX_SUBSCRIPT (ADDR(OP_NODE), OFF, INDEXES$, NEW_ETT$);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:160  
     1452    18746    2          ELSE
     1453    18747    2            CALL COMPUTE_NORMAL_SUBSCRIPT (ADDR(OP_NODE), OFF, NEW_ETT$);
     1454    18748
     1455    18749    2        IF NEW_ETT$ ~= ADDR(NIL) THEN
     1456    18750    2          IF SS_EXP$ = ADDR(NIL) THEN
     1457    18751    2            SS_EXP$ = NEW_ETT$;
     1458    18752    2          ELSE
     1459    18753    2            CALL Z8AF$FORME(%ADI, SS_EXP$, NEW_ETT$, SS_EXP$) ;
     1460    18754
     1461    18755    2        LIST$ = LIST$ -> LX_ETT_ITEM.LINK;
     1462    18756
     1463    18757    2      END; /* Until -- list$ = addr(nil) */
     1464    18758
     1465    18759    1      CALL WRAP_UP (SS_EXP$, OFF, IDENT$);
     1466    18760
     1467    18761    1   END; /* Proc -- Z8EY$SUBSCRIPT */
     1468    18762        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:161  
     1469    18763        %EOD;

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:162  
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_SRCH.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$SUBSCRIPT.

   Procedure Z8EY$SUBSCRIPT requires 1951 words for executable code.
   Procedure Z8EY$SUBSCRIPT requires 88 words of local(AUTO) storage.

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:163  

 Object Unit name= Z8EY$SUBSCRIPT                             File name= Z8EY.:Z8A6TOU
 UTS= AUG 09 '97 13:03:31.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ETT$
    2  LblCom even  none     1      1  HEAD_ETT$
    3  LblCom even  none   512   1000  ETT_BUCKETS
    4  LblCom even  none     5      5  ETT_
    5  LblCom even  none     1      1  ILL$
    6  LblCom even  none     5      5  ILL_
    7  LblCom even  none     3      3  SRCH
    8  LblCom even  none     1      1  DNT$
    9  LblCom even  none     5      5  DNT_
   10  LblCom even  none     1      1  DNT_BUCKET_NUMBER
   11  LblCom even  none     1      1  DNT_OF_1$
   12  LblCom even  none     1      1  ST$
   13  LblCom even  none     5      5  ST_
   14  LblCom even  none     1      1  QLT$
   15  LblCom even  none     1      1  PREV_01_QLT$
   16  LblCom even  none     5      5  QLT_
   17  LblCom even  none     1      1  LTS$
   18  LblCom even  none     5      5  LTS_
   19  LblCom even  none     1      1  HEAP$
   20  LblCom even  none    90    132  LEX_SYMBOL
   21  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   22  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   23  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   24  LblCom even  none     8     10  TEMP_LX_NODE
   25  LblCom even  none     2      2  MKCN
   26   Proc  even  none  1951   3637  Z8EY$SUBSCRIPT
   27  RoData even  none    46     56  Z8EY$SUBSCRIPT
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:164  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    26      0   yes            yes      Std        2  Z8EY$SUBSCRIPT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 Z8AF$FORME
         yes           Std      12 Z8AE$ERROR
         yes           Std       3 Z8AU$CREATE_NUM_DESC
         yes           Std       3 Z8EV$CONVERT
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       4 Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
         yes           Std       3 Z8AF$NEW_OFF
         yes           Std       4 Z8AF$NEW_FISS
         yes           Std       2 Z8AU$UNITS
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       2 Z8E5$MATH_PACK
 yes     yes           Std       2 Z8EQ$CHECK_FOR_INTEGER_ITEM
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    ILL_STEP                         r    LTS_STEP                              COMCOM
     O1COM                                 HIER_STK_PTR                          HIER_STK
     PAGE_FORMAT                           REP_STK_PTR                           REP_STK
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:165  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:166  


      619        1        /*T***********************************************************/
      620        2        /*T*                                                         */
      621        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      622        4        /*T*                                                         */
      623        5        /*T***********************************************************/
      624        6        Z8EY$SUBSCRIPT: PROC (SUBSCR_LIST$, IDENT$);

      6 26 000000   000000 700200 xent  Z8EY$SUBSCR* TSX0  ! X66_AUTO_2
        26 000001   000130 000002                    ZERO    88,2
        26 000002   003435 710000 26                 TRA     s:18713

      625        7
      626        8        %EQU PHASE = 1;
      627        9
      628       10        %INCLUDE Z8A_DEFC;
      629       78        %INCLUDE Z9A_FLAGS;
      630       92        %INCLUDE Z8A_SUPP_MAC;
      631     2492        %INCLUDE Z8A_ETT;
      632     2793        %INCLUDE Z8A_ILL;
      633     3486        %INCLUDE Z8A_SRCH;
      634     3535        %INCLUDE Z8A_DNT;
      635     3756        %INCLUDE Z8A_ST;
      636     7415        %INCLUDE Z8A_TYPES;
      637     7589        %INCLUDE Z8A_QLT;
      638     7695        %INCLUDE Z8A_LTS;
      639     9772        %INCLUDE Z8E_HEAP;
      640     9828        %INCLUDE Z8A_COMCOM;
      641    10478        %INCLUDE Z8A_ERR_NUMS;
      642    11242        %INCLUDE Z8E_WINDOW;
      643    13312        %INCLUDE Z8E_STACKS;
      644    15578        %INCLUDE Z8E_MACROS;
      645    16253        %INCLUDE Z8E_ABSSYN;
      646    16459        %INCLUDE Z8E_O1COM;
      647    17220
      648    17221    1   DCL Z8AC$MAKE_CONST           ENTRY(1);
      649    17222    1   DCL Z8AU$TYPE_DESCRIPTOR      ENTRY(2);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:167  
      650    17223    1   DCL Z8AF$NEW_BASE             ENTRY (3);
      651    17224    1   DCL Z8AF$NEW_FISS             ENTRY (4);
      652    17225    1   DCL Z8AU$UNITS                ENTRY(2);
      653    17226    1   DCL Z8EQ$CHECK_FOR_INTEGER_ITEM      ENTRY (2) ALTRET;
      654    17227    1   DCL Z8AF$NEW_OFF              ENTRY (3);
      655    17228    1   DCL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK ENTRY (4);
      656    17229    1   DCL Z8AE$ERROR                ENTRY(12);
      657    17230    1   DCL Z8AF$FORME                ENTRY(4);
      658    17231    1   DCL Z8EV$CONVERT              ENTRY(3);
      659    17232    1   DCL Z8E5$MATH_PACK            ENTRY(2);
      660    17233
      661    17234    1   DCL IDENT$                    PTR;
      662    17235    1   DCL SUBSCR_LIST$              PTR;
      663    17236
      664    17237    1   DCL ARRAY_ST$                 PTR;
      665    17238    1   DCL GLOBAL_DIMS$         PTR;
      666    17239    1   DCL SS_EXP$                   PTR;
      667    17240    1   DCL NEW_ETT$                  PTR;
      668    17241    1   DCL LIST$                     PTR;
      669    17242    1   DCL SUBSCRIPT#                SBIN WORD;
      670    17243    1   DCL OFF                       SBIN WORD;
      671    17244    1   DCL LAST_DIM                  SBIN WORD;
      672    17245    1   DCL DIM#                      SBIN WORD;
      673    17246    1   DCL SPAN#                     SBIN WORD;
      674    17247    1   DCL DIM$                      PTR;
      675    17248    1   DCL INDEXES$                  PTR;
      676    17249    1   DCL ID_TYPE                   UBIN;
      677    17250
      678    17251        %INCLUDE Z8A_MKCN;
      679    17268    1   DCL INDEX_SUB                 BIT(1);
      680    17269        %DCL_AUTO_LX_ITEM (@NAME = OP_NODE);
      681    17273
      682    17274        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:168  
      683    17275        %MACRO OPTIMIZE_FOR_ADI_OR_SBI;
      684    17276         DO;
      685    17277             IF LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP -> ETT.ID = %TRIAD THEN
      686    17278               DO;
      687    17279                 IF LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SBI THEN
      688    17280                   DO;
      689    17281                     OFF = - (LIST$ -> LX_ETT_ITEM.ETT$ ->
      690    17282                           ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 * SPAN#) + OFF;
      691    17283                     DIM# = + LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP ->
      692    17284                              ETT.LOP -> CONST.CONSTI.WORD1 + DIM#;
      693    17285                   END;
      694    17286                 ELSE
      695    17287                   DO;
      696    17288                     OFF = LIST$ -> LX_ETT_ITEM.ETT$ ->
      697    17289                           ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 * SPAN# + OFF;
      698    17290
      699    17291                     DIM# = - LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP ->
      700    17292                            ETT.LOP -> CONST.CONSTI.WORD1 + DIM#;
      701    17293                   END;
      702    17294
      703    17295
      704    17296               END;/* If -- lop is a base and rop is a triad */
      705    17297         END;
      706    17298        %MEND;
      707    17299        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:169  
      708    17300        %MACRO CHECK_CONST_FOR_OUT_OF_BOUNDS (@SUBSCRIPT$ = LIST$);
      709    17301
      710    17302           IF @SUBSCRIPT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %TRIAD THEN
      711    17303             IF @SUBSCRIPT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1 < 1
      712    17304            OR @SUBSCRIPT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1 > DIM# THEN
      713    17305               CALL Z8AE$ERROR (%E$SUBSCRIPT_OUT_OF_BOUNDS);
      714    17306        %MEND;
      715    17307        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:170  
      716    17308        %MACRO ADJUST_SUBSCRIPT_FOR_SPAN(@ETT$ = LIST$->LX_ETT_ITEM.ETT$);
      717    17309           DO ;
      718    17310             CALL SUBCHK (DIM#, @ETT$, @ETT$);
      719    17311
      720    17312             IF SPAN# = 1 THEN
      721    17313               NEW_ETT$ = @ETT$;
      722    17314             ELSE
      723    17315               DO;
      724    17316                 MKCN.CON = SPAN#;
      725    17317                 CALL Z8AC$MAKE_CONST (ETT$$);
      726    17318                 CALL Z8AF$FORME(%MPI, @ETT$, ETT$$, NEW_ETT$) ;
      727    17319               END;
      728    17320           END;
      729    17321        %MEND;
      730    17322        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:171  
      731    17323    1   CHECK_FOR_INDEX_SUB: PROC (NODE$, INDEX_SUB);

  17323 26 000003   200050 741300       CHECK_FOR_I* STX1  ! MAX_OFF_PRECISION+4,,AUTO

      732    17324
      733    17325    2        DCL NODE$         PTR;
      734    17326    2        DCL INDEX_SUB     BIT (1) ALIGNED;
      735    17327
      736    17328    2        DCL NODE_ST$      PTR;
      737    17329
      738    17330
      739    17331    3        DO SELECT (NODE$ -> LX_ETT_ITEM.TYPE);

  17331 26 000004   200051 470500                    LDP0    @NODE$,,AUTO
        26 000005   000000 471500                    LDP1    0,,PR0
        26 000006   100004 236100                    LDQ     4,,PR1
        26 000007   000012 116007                    CMPQ    10,DL
        26 000010   000013 602000 26                 TNC     s:17331+7
        26 000011   000016 600000 26                 TZE     s:17346
        26 000012   000111 710000 26                 TRA     s:17416
        26 000013   000011 116007                    CMPQ    9,DL
        26 000014   000111 601000 26                 TNZ     s:17416
        26 000015   000040 710000 26                 TRA     s:17371

      740    17332    3          SELECT (%TYY);

      741    17333                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      742    17334                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      743    17335                                     @LINE     = NODE$ -> LX_ETT_ITEM.LINE,
      744    17336                                     @COLUMN   = NODE$ -> LX_ETT_ITEM.COLUMN);

  17346 26 000016   100000 236100                    LDQ     0,,PR1
        26 000017   400000 316007                    CANQ    -131072,DL
        26 000020   000113 601000 26                 TNZ     s:17419

  17348 26 000021   100006 633500                    EPPR3   6,,PR1
        26 000022   200116 453500                    STP3    OCCHK+10,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:172  
        26 000023   100005 634500                    EPPR4   5,,PR1
        26 000024   200115 454500                    STP4    OCCHK+9,,AUTO
        26 000025   000002 236000 27                 LDQ     2
        26 000026   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000027   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000030   000000 631400 27                 EPPR1   0
        26 000031   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000032   000000 011000                    NOP     0

  17357 26 000033   200051 470500                    LDP0    @NODE$,,AUTO
        26 000034   000000 471500                    LDP1    0,,PR0
        26 000035   400000 236007                    LDQ     -131072,DL
        26 000036   100000 256100                    ORSQ    0,,PR1

  17364 26 000037   000113 710000 26                 TRA     s:17419

      745    17366
      746    17367    3          SELECT (%TYX);

      747    17368                 %FISH (TRIAD = NODE$ -> LX_ETT_ITEM.ETT$,
      748    17369                        RTN   = NODE_ST$);

  17371 26 000040   100001 236100                    LDQ     1,,PR1
        26 000041   200053 756100                    STQ     NODE_ST$,,AUTO

  17372 26 000042   200053 473500                    LDP3    NODE_ST$,,AUTO
        26 000043   300000 220100                    LDX0    0,,PR3
        26 000044   000751 100003                    CMPX0   489,DU
        26 000045   000055 603000 26                 TRC     s:17378

  17373 26 000046   200053 470500                    LDP0    NODE_ST$,,AUTO
        26 000047   000001 236100                    LDQ     1,,PR0
        26 000050   200053 756100                    STQ     NODE_ST$,,AUTO

  17374 26 000051   200053 470500                    LDP0    NODE_ST$,,AUTO
        26 000052   000000 220100                    LDX0    0,,PR0
        26 000053   000751 100003                    CMPX0   489,DU
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:173  
        26 000054   000046 602000 26                 TNC     s:17373

      749    17377
      750    17378    3            IF NODE_ST$ -> SCALAR.LTS$ ~= ADDR(NIL) THEN

  17378 26 000055   200053 470500                    LDP0    NODE_ST$,,AUTO
        26 000056   000005 236100                    LDQ     5,,PR0
        26 000057   000003 116000 27                 CMPQ    3
        26 000060   000065 600000 26                 TZE     s:17394

      751    17379    3              INDEX_SUB = TRUE;

  17379 26 000061   400000 236003                    LDQ     -131072,DU
        26 000062   200052 471500                    LDP1    @INDEX_SUB,,AUTO
        26 000063   100000 756100                    STQ     0,,PR1
        26 000064   000113 710000 26                 TRA     s:17419

      752    17380    3            ELSE
      753    17381                   %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      754    17382                                       @ERROR#   = %E$INVALID_SUBSCRIPT,
      755    17383                                       @LINE     = NODE$ -> LX_ETT_ITEM.LINE,
      756    17384                                       @COLUMN   = NODE$ -> LX_ETT_ITEM.COLUMN);

  17394 26 000065   200051 471500                    LDP1    @NODE$,,AUTO
        26 000066   100000 473500                    LDP3    0,,PR1
        26 000067   300000 236100                    LDQ     0,,PR3
        26 000070   400000 316007                    CANQ    -131072,DL
        26 000071   000113 601000 26                 TNZ     s:17419

  17396 26 000072   300006 634500                    EPPR4   6,,PR3
        26 000073   200116 454500                    STP4    OCCHK+10,,AUTO
        26 000074   300005 635500                    EPPR5   5,,PR3
        26 000075   200115 455500                    STP5    OCCHK+9,,AUTO
        26 000076   000002 236000 27                 LDQ     2
        26 000077   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000100   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000101   000000 631400 27                 EPPR1   0
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:174  
        26 000102   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000103   000000 011000                    NOP     0

  17405 26 000104   200051 470500                    LDP0    @NODE$,,AUTO
        26 000105   000000 471500                    LDP1    0,,PR0
        26 000106   400000 236007                    LDQ     -131072,DL
        26 000107   100000 256100                    ORSQ    0,,PR1

  17412 26 000110   000113 710000 26                 TRA     s:17419

      757    17414
      758    17415    3          SELECT (ELSE);

      759    17416    3            INDEX_SUB = FALSE;

  17416 26 000111   200052 473500                    LDP3    @INDEX_SUB,,AUTO
        26 000112   300000 450100                    STZ     0,,PR3

      760    17417    3        END; /* SELECT */

      761    17418
      762    17419    2   END CHECK_FOR_INDEX_SUB;

  17419 26 000113   200050 221300                    LDX1  ! MAX_OFF_PRECISION+4,,AUTO
        26 000114   000001 702211                    TSX2  ! 1,X1

      763    17420        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:175  
      764    17421    1   VERIFY_POS_INTEGER_NUM_LIT: PROC (NODE$) ALTRET;

  17421 26 000115   200050 741300       VERIFY_POS_* STX1  ! MAX_OFF_PRECISION+4,,AUTO

      765    17422
      766    17423    2   DCL NODE$              PTR;
      767    17424        %DCL_NUM_DESC;
      768    17433
      769    17434    2      CALL VERIFY_NUMERIC_LITERAL (NODE$, NUM_DESC)

  17434 26 000116   200052 630500                    EPPR0   NUM_DESC,,AUTO
        26 000117   200062 450500                    STP0    @OUT$+1,,AUTO
        26 000120   200051 236100                    LDQ     @NODE$,,AUTO
        26 000121   200061 756100                    STQ     @SUB$+1,,AUTO
        26 000122   000136 701000 26                 TSX1    VERIFY_NUMERIC_LITERAL
        26 000123   000125 702000 26                 TSX2    s:17437
        26 000124   000127 710000 26                 TRA     s:17440

      770    17435    2        WHENALTRETURN
      771    17436    3          DO;

      772    17437    3            ALTRETURN;

  17437 26 000125   200050 221300                    LDX1  ! MAX_OFF_PRECISION+4,,AUTO
        26 000126   000000 702211                    TSX2  ! 0,X1

      773    17438    3          END;
      774    17439
      775    17440    2      IF NUM_DESC.MANTISSA_SIGN_VALUE = %MINUS_SIGN_VALUE THEN

  17440 26 000127   200055 235100                    LDA     @DIM#+1,,AUTO
        26 000130   000002 115007                    CMPA    2,DL
        26 000131   000134 601000 26                 TNZ     s:17443

      776    17441    2        ALTRETURN;

  17441 26 000132   200050 221300                    LDX1  ! MAX_OFF_PRECISION+4,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:176  
        26 000133   000000 702211                    TSX2  ! 0,X1

      777    17442
      778    17443    2   END VERIFY_POS_INTEGER_NUM_LIT;

  17443 26 000134   200050 221300                    LDX1  ! MAX_OFF_PRECISION+4,,AUTO
        26 000135   000001 702211                    TSX2  ! 1,X1

      779    17444        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:177  
      780    17445    1   VERIFY_NUMERIC_LITERAL: PROC (NODE$, NUM_DESC) ALTRET;

  17445 26 000136   200060 741300       VERIFY_NUME* STX1  ! @DIM#+1,,AUTO

      781    17446
      782    17447    2   DCL NODE$              PTR;
      783    17448
      784    17449        %DCL_NUM_DESC;
      785    17458
      786    17459    2   DCL Z8AU$CREATE_NUM_DESC      ENTRY (3);
      787    17460
      788    17461    2      CALL Z8AU$CREATE_NUM_DESC (NODE$ -> LX_TERMINAL.DNT$ -> DNT.TEXT.NAME,

  17461 26 000137   200061 470500                    LDP0    @NODE$,,AUTO
        26 000140   000000 471500                    LDP1    0,,PR0
        26 000141   100002 473500                    LDP3    2,,PR1
        26 000142   300004 236100                    LDQ     4,,PR3
        26 000143   000022 772000                    QRL     18
        26 000144   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000145   200062 236100                    LDQ     @NUM_DESC,,AUTO
        26 000146   200120 756100                    STQ     OCCHK+12,,AUTO
        26 000147   200114 631500                    EPPR1   OCCHK+8,,AUTO
        26 000150   200117 451500                    STP1    OCCHK+11,,AUTO
        26 000151   200121 453500                    STP3    OCCHK+13,,AUTO
        26 000152   200121 236100                    LDQ     OCCHK+13,,AUTO
        26 000153   000004 036000 27                 ADLQ    4
        26 000154   200116 756100                    STQ     OCCHK+10,,AUTO
        26 000155   200116 630500                    EPPR0   OCCHK+10,,AUTO
        26 000156   000000 631400 27                 EPPR1   0
        26 000157   000000 701000 xent               TSX1    Z8AU$CREATE_NUM_DESC
        26 000160   000000 011000                    NOP     0

      789    17462    2                                 BINBIT (NODE$ -> LX_TERMINAL.DNT$ ->
      790    17463    2                                         DNT.TEXT.LENGTH,36),
      791    17464    2                                 NUM_DESC);
      792    17465
      793    17466    2      IF NUM_DESC.DIGITS_RIGHT ~= 0 THEN
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:178  

  17466 26 000161   200062 470500                    LDP0    @NUM_DESC,,AUTO
        26 000162   000001 235100                    LDA     1,,PR0
        26 000163   000166 600000 26                 TZE     s:17469

      794    17467    2        ALTRETURN;

  17467 26 000164   200060 221300                    LDX1  ! @DIM#+1,,AUTO
        26 000165   000000 702211                    TSX2  ! 0,X1

      795    17468
      796    17469    2      IF NUM_DESC.DIGITS_EXPONENT ~= 0 THEN

  17469 26 000166   000002 235100                    LDA     2,,PR0
        26 000167   000172 600000 26                 TZE     s:17472

      797    17470    2        ALTRETURN;

  17470 26 000170   200060 221300                    LDX1  ! @DIM#+1,,AUTO
        26 000171   000000 702211                    TSX2  ! 0,X1

      798    17471
      799    17472    2      IF NUM_DESC.EXPONENT_SIGN_VALUE ~= %NO_SIGN_VALUE THEN

  17472 26 000172   000004 235100                    LDA     4,,PR0
        26 000173   000176 600000 26                 TZE     s:17475

      800    17473    2        ALTRETURN;

  17473 26 000174   200060 221300                    LDX1  ! @DIM#+1,,AUTO
        26 000175   000000 702211                    TSX2  ! 0,X1

      801    17474
      802    17475    2   END VERIFY_NUMERIC_LITERAL;

  17475 26 000176   200060 221300                    LDX1  ! @DIM#+1,,AUTO
        26 000177   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:179  

      803    17476        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:180  
      804    17477    1   VERIFY_SUBSCRIPT_SYNTAX: PROC(NODE$, INDEX_SUB);

  17477 26 000200   200034 741300       VERIFY_SUBS* STX1  ! OP_NODE+8,,AUTO

      805    17478
      806    17479    2   DCL NODE$           PTR;
      807    17480    2   DCL ERROR_LINE#               SBIN WORD;
      808    17481    2   DCL ERROR_COLUMN#             SBIN WORD;
      809    17482    2   DCL SYMBOL                    SBIN WORD;
      810    17483    2   DCL INDEX_SUB                 BIT (1) ALIGNED;
      811    17484        %DCL_NUM_DESC;
      812    17493
      813    17494    2      INDEX_SUB = FALSE;

  17494 26 000201   200036 470500                    LDP0    @INDEX_SUB,,AUTO
        26 000202   000000 450100                    STZ     0,,PR0

      814    17495
      815    17496    3      DO CASE(NODE$ -> LX_ETT_ITEM.ID);

  17496 26 000203   200035 471500                    LDP1    @NODE$,,AUTO
        26 000204   100000 473500                    LDP3    0,,PR1
        26 000205   300000 220100                    LDX0    0,,PR3
        26 000206   000006 100003                    CMPX0   6,DU
        26 000207   000211 602010 26                 TNC     s:17496+6,X0
        26 000210   000714 710000 26                 TRA     s:17871
        26 000211   000524 710000 26                 TRA     s:17743
        26 000212   000714 710000 26                 TRA     s:17871
        26 000213   000714 710000 26                 TRA     s:17871
        26 000214   000714 710000 26                 TRA     s:17871
        26 000215   000651 710000 26                 TRA     s:17830
        26 000216   000217 710000 26                 TRA     s:17498

      816    17497    3        CASE(%BINARY_OP);

      817    17498    3          ERROR_LINE#   = NODE$ -> BINARY_OP.LINE;

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:181  
  17498 26 000217   300005 235100                    LDA     5,,PR3
        26 000220   200037 755100                    STA     ERROR_LINE#,,AUTO

      818    17499    3          ERROR_COLUMN# = NODE$ -> BINARY_OP.COLUMN;

  17499 26 000221   100000 473500                    LDP3    0,,PR1
        26 000222   300006 235100                    LDA     6,,PR3
        26 000223   200040 755100                    STA     ERROR_COLUMN#,,AUTO

      819    17500
      820    17501    3          IF NODE$ -> BINARY_OP.OP = %OP_BINARY_MINUS

  17501 26 000224   100000 473500                    LDP3    0,,PR1
        26 000225   300003 235100                    LDA     3,,PR3
        26 000226   000021 115007                    CMPA    17,DL
        26 000227   000232 600000 26                 TZE     s:17504
        26 000230   000020 115007                    CMPA    16,DL
        26 000231   000473 601000 26                 TNZ     s:17718

      821    17502    3          OR NODE$ -> BINARY_OP.OP = %OP_PLUS THEN
      822    17503    4            DO;

      823    17504    4              IF NODE$ -> BINARY_OP.LOP$ ->

  17504 26 000232   300001 474500                    LDP4    1,,PR3
        26 000233   400000 220100                    LDX0    0,,PR4
        26 000234   000004 100003                    CMPX0   4,DU
        26 000235   000273 601000 26                 TNZ     s:17559

      824    17505    4              LX_ETT_ITEM.ID = %LX_ETT_ITEM THEN
      825    17506    5                DO;

      826    17507    5                  IF NODE$ -> BINARY_OP.LOP$ ->

  17507 26 000236   400001 475500                    LDP5    1,,PR4
        26 000237   500000 221100                    LDX1    0,,PR5
        26 000240   000001 101003                    CMPX1   1,DU
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:182  
        26 000241   000264 600000 26                 TZE     s:17543

      827    17508    5                  LX_ETT_ITEM.ETT$ -> ETT.ID ~= %BASE THEN
      828    17509                         %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      829    17510                                             @ERROR#   = %E$INVALID_SUBSCRIPT,
      830    17511                                             @LINE     = ERROR_LINE#,
      831    17512                                             @COLUMN   = ERROR_COLUMN#);

  17522 26 000242   300000 236100                    LDQ     0,,PR3
        26 000243   400000 316007                    CANQ    -131072,DL
        26 000244   000314 601000 26                 TNZ     s:17580

  17524 26 000245   200040 636500                    EPPR6   ERROR_COLUMN#,,AUTO
        26 000246   200116 456500                    STP6    OCCHK+10,,AUTO
        26 000247   200037 633500                    EPPR3   ERROR_LINE#,,AUTO
        26 000250   200115 453500                    STP3    OCCHK+9,,AUTO
        26 000251   000002 236000 27                 LDQ     2
        26 000252   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000253   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000254   000000 631400 27                 EPPR1   0
        26 000255   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000256   000000 011000                    NOP     0

  17533 26 000257   200035 470500                    LDP0    @NODE$,,AUTO
        26 000260   000000 471500                    LDP1    0,,PR0
        26 000261   400000 236007                    LDQ     -131072,DL
        26 000262   100000 256100                    ORSQ    0,,PR1

  17540 26 000263   000314 710000 26                 TRA     s:17580

      832    17542    5                  ELSE
      833    17543    5                    CALL CHECK_FOR_INDEX_SUB (NODE$ -> BINARY_OP.LOP$, INDEX_SUB);

  17543 26 000264   200036 236100                    LDQ     @INDEX_SUB,,AUTO
        26 000265   200052 756100                    STQ     NUM_DESC,,AUTO
        26 000266   300001 634500                    EPPR4   1,,PR3
        26 000267   200051 454500                    STP4    @NODE$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:183  
        26 000270   000003 701000 26                 TSX1    CHECK_FOR_INDEX_SUB
        26 000271   000000 011000                    NOP     0

      834    17544    5                END;

  17544 26 000272   000314 710000 26                 TRA     s:17580

      835    17545    4              ELSE
      836    17546                     %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      837    17547                                         @ERROR#   = %E$INVALID_SUBSCRIPT,
      838    17548                                         @LINE     = ERROR_LINE#,
      839    17549                                         @COLUMN   = ERROR_COLUMN#);

  17559 26 000273   300000 236100                    LDQ     0,,PR3
        26 000274   400000 316007                    CANQ    -131072,DL
        26 000275   000314 601000 26                 TNZ     s:17580

  17561 26 000276   200040 635500                    EPPR5   ERROR_COLUMN#,,AUTO
        26 000277   200116 455500                    STP5    OCCHK+10,,AUTO
        26 000300   200037 633500                    EPPR3   ERROR_LINE#,,AUTO
        26 000301   200115 453500                    STP3    OCCHK+9,,AUTO
        26 000302   000002 236000 27                 LDQ     2
        26 000303   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000304   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000305   000000 631400 27                 EPPR1   0
        26 000306   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000307   000000 011000                    NOP     0

  17570 26 000310   200035 470500                    LDP0    @NODE$,,AUTO
        26 000311   000000 471500                    LDP1    0,,PR0
        26 000312   400000 236007                    LDQ     -131072,DL
        26 000313   100000 256100                    ORSQ    0,,PR1

      840    17579
      841    17580    4              IF NODE$ -> BINARY_OP.ROP$ ->

  17580 26 000314   200035 470500                    LDP0    @NODE$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:184  
        26 000315   000000 471500                    LDP1    0,,PR0
        26 000316   100002 473500                    LDP3    2,,PR1
        26 000317   300000 220100                    LDX0    0,,PR3
        26 000320   000451 601000 26                 TNZ     s:17682

      842    17581    4              LX_ETT_ITEM.ID = %LX_TERMINAL THEN
      843    17582    5                DO;

      844    17583    5                  SYMBOL = NODE$ -> BINARY_OP.ROP$ -> LX_TERMINAL.SYMBOL;

  17583 26 000321   300003 235100                    LDA     3,,PR3
        26 000322   200041 755100                    STA     SYMBOL,,AUTO

      845    17584
      846    17585    6                  DO CASE (SYMBOL);

  17585 26 000323   000027 115007                    CMPA    23,DL
        26 000324   000326 602005 26                 TNC     s:17585+3,AL
        26 000325   000427 710000 26                 TRA     s:17645
        26 000326   000427 710000 26                 TRA     s:17645
        26 000327   000427 710000 26                 TRA     s:17645
        26 000330   000355 710000 26                 TRA     s:17587
        26 000331   000427 710000 26                 TRA     s:17645
        26 000332   000427 710000 26                 TRA     s:17645
        26 000333   000427 710000 26                 TRA     s:17645
        26 000334   000427 710000 26                 TRA     s:17645
        26 000335   000427 710000 26                 TRA     s:17645
        26 000336   000427 710000 26                 TRA     s:17645
        26 000337   000427 710000 26                 TRA     s:17645
        26 000340   000427 710000 26                 TRA     s:17645
        26 000341   000427 710000 26                 TRA     s:17645
        26 000342   000427 710000 26                 TRA     s:17645
        26 000343   000427 710000 26                 TRA     s:17645
        26 000344   000427 710000 26                 TRA     s:17645
        26 000345   000427 710000 26                 TRA     s:17645
        26 000346   000427 710000 26                 TRA     s:17645
        26 000347   000427 710000 26                 TRA     s:17645
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:185  
        26 000350   000427 710000 26                 TRA     s:17645
        26 000351   000427 710000 26                 TRA     s:17645
        26 000352   000427 710000 26                 TRA     s:17645
        26 000353   000355 710000 26                 TRA     s:17587
        26 000354   000364 710000 26                 TRA     s:17590

      847    17586    6                    CASE (%NUMBER, %NUMBER_OR_PARAGRAPH);

      848    17587    6                      CALL CHECK_FOR_INDEX_SUB (NODE$ -> BINARY_OP.LOP$, INDEX_SUB);

  17587 26 000355   200036 236100                    LDQ     @INDEX_SUB,,AUTO
        26 000356   200052 756100                    STQ     NUM_DESC,,AUTO
        26 000357   100001 633500                    EPPR3   1,,PR1
        26 000360   200051 453500                    STP3    @NODE$,,AUTO
        26 000361   000003 701000 26                 TSX1    CHECK_FOR_INDEX_SUB
        26 000362   000000 011000                    NOP     0
        26 000363   000514 710000 26                 TRA     s:17739

      849    17588
      850    17589    6                    CASE (%NUMERIC_LITERAL);

      851    17590    6                      CALL VERIFY_NUMERIC_LITERAL (NODE$ -> BINARY_OP.ROP$,

  17590 26 000364   200042 634500                    EPPR4   NUM_DESC,,AUTO
        26 000365   200062 454500                    STP4    @NUM_DESC,,AUTO
        26 000366   100002 633500                    EPPR3   2,,PR1
        26 000367   200061 453500                    STP3    @NODE$,,AUTO
        26 000370   000136 701000 26                 TSX1    VERIFY_NUMERIC_LITERAL
        26 000371   000373 702000 26                 TSX2    s:17607
        26 000372   000416 710000 26                 TRA     s:17629

      852    17591    6                                                   NUM_DESC)
      853    17592    6                        WHENALTRETURN
      854    17593    7                          DO;

      855    17594                                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      856    17595                                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:186  
      857    17596                                                     @LINE     = ERROR_LINE#,
      858    17597                                                     @COLUMN   = ERROR_COLUMN#);

  17607 26 000373   200035 470500                    LDP0    @NODE$,,AUTO
        26 000374   000000 471500                    LDP1    0,,PR0
        26 000375   100000 236100                    LDQ     0,,PR1
        26 000376   400000 316007                    CANQ    -131072,DL
        26 000377   000416 601000 26                 TNZ     s:17629

  17609 26 000400   200040 633500                    EPPR3   ERROR_COLUMN#,,AUTO
        26 000401   200116 453500                    STP3    OCCHK+10,,AUTO
        26 000402   200037 631500                    EPPR1   ERROR_LINE#,,AUTO
        26 000403   200115 451500                    STP1    OCCHK+9,,AUTO
        26 000404   000002 236000 27                 LDQ     2
        26 000405   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000406   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000407   000000 631400 27                 EPPR1   0
        26 000410   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000411   000000 011000                    NOP     0

  17618 26 000412   200035 470500                    LDP0    @NODE$,,AUTO
        26 000413   000000 471500                    LDP1    0,,PR0
        26 000414   400000 236007                    LDQ     -131072,DL
        26 000415   100000 256100                    ORSQ    0,,PR1

      859    17627    7                          END;

      860    17628
      861    17629    6                      CALL CHECK_FOR_INDEX_SUB (NODE$ -> BINARY_OP.LOP$, INDEX_SUB);

  17629 26 000416   200035 470500                    LDP0    @NODE$,,AUTO
        26 000417   000000 471500                    LDP1    0,,PR0
        26 000420   200036 236100                    LDQ     @INDEX_SUB,,AUTO
        26 000421   200052 756100                    STQ     NUM_DESC,,AUTO
        26 000422   100001 633500                    EPPR3   1,,PR1
        26 000423   200051 453500                    STP3    @NODE$,,AUTO
        26 000424   000003 701000 26                 TSX1    CHECK_FOR_INDEX_SUB
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:187  
        26 000425   000000 011000                    NOP     0
        26 000426   000514 710000 26                 TRA     s:17739

      862    17630
      863    17631    6                    CASE (ELSE);

      864    17632                           %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      865    17633                                               @ERROR#   = %E$INVALID_SUBSCRIPT,
      866    17634                                               @LINE     = ERROR_LINE#,
      867    17635                                               @COLUMN   = ERROR_COLUMN#);

  17645 26 000427   100000 236100                    LDQ     0,,PR1
        26 000430   400000 316007                    CANQ    -131072,DL
        26 000431   000514 601000 26                 TNZ     s:17739

  17647 26 000432   200040 634500                    EPPR4   ERROR_COLUMN#,,AUTO
        26 000433   200116 454500                    STP4    OCCHK+10,,AUTO
        26 000434   200037 631500                    EPPR1   ERROR_LINE#,,AUTO
        26 000435   200115 451500                    STP1    OCCHK+9,,AUTO
        26 000436   000002 236000 27                 LDQ     2
        26 000437   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000440   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000441   000000 631400 27                 EPPR1   0
        26 000442   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000443   000000 011000                    NOP     0

  17656 26 000444   200035 470500                    LDP0    @NODE$,,AUTO
        26 000445   000000 471500                    LDP1    0,,PR0
        26 000446   400000 236007                    LDQ     -131072,DL
        26 000447   100000 256100                    ORSQ    0,,PR1

      868    17665
      869    17666    6                  END; /* Case */

      870    17667    5                END;

  17667 26 000450   000514 710000 26                 TRA     s:17739
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:188  

      871    17668    4              ELSE
      872    17669                     %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      873    17670                                         @ERROR#   = %E$INVALID_SUBSCRIPT,
      874    17671                                         @LINE     = ERROR_LINE#,
      875    17672                                         @COLUMN   = ERROR_COLUMN#);

  17682 26 000451   100000 236100                    LDQ     0,,PR1
        26 000452   400000 316007                    CANQ    -131072,DL
        26 000453   000514 601000 26                 TNZ     s:17739

  17684 26 000454   200040 634500                    EPPR4   ERROR_COLUMN#,,AUTO
        26 000455   200116 454500                    STP4    OCCHK+10,,AUTO
        26 000456   200037 631500                    EPPR1   ERROR_LINE#,,AUTO
        26 000457   200115 451500                    STP1    OCCHK+9,,AUTO
        26 000460   000002 236000 27                 LDQ     2
        26 000461   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000462   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000463   000000 631400 27                 EPPR1   0
        26 000464   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000465   000000 011000                    NOP     0

  17693 26 000466   200035 470500                    LDP0    @NODE$,,AUTO
        26 000467   000000 471500                    LDP1    0,,PR0
        26 000470   400000 236007                    LDQ     -131072,DL
        26 000471   100000 256100                    ORSQ    0,,PR1

      876    17702
      877    17703    4            END;

  17703 26 000472   000514 710000 26                 TRA     s:17739

      878    17704    3          ELSE
      879    17705                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      880    17706                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      881    17707                                     @LINE     = ERROR_LINE#,
      882    17708                                     @COLUMN   = ERROR_COLUMN#);
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:189  

  17718 26 000473   300000 236100                    LDQ     0,,PR3
        26 000474   400000 316007                    CANQ    -131072,DL
        26 000475   000514 601000 26                 TNZ     s:17739

  17720 26 000476   200040 634500                    EPPR4   ERROR_COLUMN#,,AUTO
        26 000477   200116 454500                    STP4    OCCHK+10,,AUTO
        26 000500   200037 633500                    EPPR3   ERROR_LINE#,,AUTO
        26 000501   200115 453500                    STP3    OCCHK+9,,AUTO
        26 000502   000002 236000 27                 LDQ     2
        26 000503   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000504   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000505   000000 631400 27                 EPPR1   0
        26 000506   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000507   000000 011000                    NOP     0

  17729 26 000510   200035 470500                    LDP0    @NODE$,,AUTO
        26 000511   000000 471500                    LDP1    0,,PR0
        26 000512   400000 236007                    LDQ     -131072,DL
        26 000513   100000 256100                    ORSQ    0,,PR1

      883    17738
      884    17739    3          IF NODE$ -> LX_ITEM.B.ERROR THEN

  17739 26 000514   200035 470500                    LDP0    @NODE$,,AUTO
        26 000515   000000 471500                    LDP1    0,,PR0
        26 000516   100000 236100                    LDQ     0,,PR1
        26 000517   400000 316007                    CANQ    -131072,DL
        26 000520   000743 600000 26                 TZE     s:17909

      885    17740    3              INDEX_SUB = FALSE;

  17740 26 000521   200036 473500                    LDP3    @INDEX_SUB,,AUTO
        26 000522   300000 450100                    STZ     0,,PR3
        26 000523   000743 710000 26                 TRA     s:17909

      886    17741
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:190  
      887    17742    3        CASE(%LX_TERMINAL);

      888    17743    3          ERROR_LINE#   = NODE$ -> LX_TERMINAL.LINE;

  17743 26 000524   300005 235100                    LDA     5,,PR3
        26 000525   200037 755100                    STA     ERROR_LINE#,,AUTO

      889    17744    3          ERROR_COLUMN#  = NODE$ -> LX_TERMINAL.COLUMN;

  17744 26 000526   100000 473500                    LDP3    0,,PR1
        26 000527   300006 235100                    LDA     6,,PR3
        26 000530   200040 755100                    STA     ERROR_COLUMN#,,AUTO

      890    17745
      891    17746    3          SYMBOL = NODE$ -> LX_TERMINAL.SYMBOL;

  17746 26 000531   100000 473500                    LDP3    0,,PR1
        26 000532   300003 235100                    LDA     3,,PR3
        26 000533   200041 755100                    STA     SYMBOL,,AUTO

      892    17747
      893    17748    4          DO CASE (SYMBOL);

  17748 26 000534   000027 115007                    CMPA    23,DL
        26 000535   000537 602005 26                 TNC     s:17748+3,AL
        26 000536   000617 710000 26                 TRA     s:17805
        26 000537   000617 710000 26                 TRA     s:17805
        26 000540   000617 710000 26                 TRA     s:17805
        26 000541   000640 710000 26                 TRA     s:17827
        26 000542   000617 710000 26                 TRA     s:17805
        26 000543   000617 710000 26                 TRA     s:17805
        26 000544   000617 710000 26                 TRA     s:17805
        26 000545   000617 710000 26                 TRA     s:17805
        26 000546   000617 710000 26                 TRA     s:17805
        26 000547   000617 710000 26                 TRA     s:17805
        26 000550   000617 710000 26                 TRA     s:17805
        26 000551   000617 710000 26                 TRA     s:17805
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:191  
        26 000552   000617 710000 26                 TRA     s:17805
        26 000553   000617 710000 26                 TRA     s:17805
        26 000554   000617 710000 26                 TRA     s:17805
        26 000555   000617 710000 26                 TRA     s:17805
        26 000556   000617 710000 26                 TRA     s:17805
        26 000557   000617 710000 26                 TRA     s:17805
        26 000560   000617 710000 26                 TRA     s:17805
        26 000561   000617 710000 26                 TRA     s:17805
        26 000562   000617 710000 26                 TRA     s:17805
        26 000563   000617 710000 26                 TRA     s:17805
        26 000564   000640 710000 26                 TRA     s:17827
        26 000565   000566 710000 26                 TRA     s:17753

      894    17749    4            CASE (%NUMBER, %NUMBER_OR_PARAGRAPH);

      895    17750    4              /* Peachy */;
      896    17751
      897    17752    4            CASE (%NUMERIC_LITERAL);

      898    17753    4              CALL VERIFY_POS_INTEGER_NUM_LIT (NODE$)

  17753 26 000566   200035 236100                    LDQ     @NODE$,,AUTO
        26 000567   200051 756100                    STQ     @NODE$,,AUTO
        26 000570   000115 701000 26                 TSX1    VERIFY_POS_INTEGER_NUM_LIT
        26 000571   000573 702000 26                 TSX2    s:17769
        26 000572   000616 710000 26                 TRA     s:17789

      899    17754    4                WHENALTRETURN
      900    17755    5                  DO;

      901    17756                         %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      902    17757                                             @ERROR#   = %E$INVALID_SUBSCRIPT,
      903    17758                                             @LINE     = ERROR_LINE#,
      904    17759                                             @COLUMN   = ERROR_COLUMN#);

  17769 26 000573   200035 470500                    LDP0    @NODE$,,AUTO
        26 000574   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:192  
        26 000575   100000 236100                    LDQ     0,,PR1
        26 000576   400000 316007                    CANQ    -131072,DL
        26 000577   000616 601000 26                 TNZ     s:17789

  17771 26 000600   200040 633500                    EPPR3   ERROR_COLUMN#,,AUTO
        26 000601   200116 453500                    STP3    OCCHK+10,,AUTO
        26 000602   200037 631500                    EPPR1   ERROR_LINE#,,AUTO
        26 000603   200115 451500                    STP1    OCCHK+9,,AUTO
        26 000604   000002 236000 27                 LDQ     2
        26 000605   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000606   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000607   000000 631400 27                 EPPR1   0
        26 000610   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000611   000000 011000                    NOP     0

  17780 26 000612   200035 470500                    LDP0    @NODE$,,AUTO
        26 000613   000000 471500                    LDP1    0,,PR0
        26 000614   400000 236007                    LDQ     -131072,DL
        26 000615   100000 256100                    ORSQ    0,,PR1

      905    17789    5                  END;

  17789 26 000616   000640 710000 26                 TRA     s:17827

      906    17790
      907    17791    4            CASE (ELSE);

      908    17792                   %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      909    17793                                       @ERROR#   = %E$INVALID_SUBSCRIPT,
      910    17794                                       @LINE     = ERROR_LINE#,
      911    17795                                       @COLUMN   = ERROR_COLUMN#);

  17805 26 000617   300000 236100                    LDQ     0,,PR3
        26 000620   400000 316007                    CANQ    -131072,DL
        26 000621   000640 601000 26                 TNZ     s:17827

  17807 26 000622   200040 634500                    EPPR4   ERROR_COLUMN#,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:193  
        26 000623   200116 454500                    STP4    OCCHK+10,,AUTO
        26 000624   200037 633500                    EPPR3   ERROR_LINE#,,AUTO
        26 000625   200115 453500                    STP3    OCCHK+9,,AUTO
        26 000626   000002 236000 27                 LDQ     2
        26 000627   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000630   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000631   000000 631400 27                 EPPR1   0
        26 000632   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000633   000000 011000                    NOP     0

  17816 26 000634   200035 470500                    LDP0    @NODE$,,AUTO
        26 000635   000000 471500                    LDP1    0,,PR0
        26 000636   400000 236007                    LDQ     -131072,DL
        26 000637   100000 256100                    ORSQ    0,,PR1

      912    17825    4          END; /* Case */

      913    17826
      914    17827    3          CALL Z8EV$CONVERT (%TYI, NODE$, NODE$);

  17827 26 000640   200035 236100                    LDQ     @NODE$,,AUTO
        26 000641   200116 756100                    STQ     OCCHK+10,,AUTO
        26 000642   000006 235000 27                 LDA     6
        26 000643   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 000644   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000645   000000 631400 27                 EPPR1   0
        26 000646   000000 701000 xent               TSX1    Z8EV$CONVERT
        26 000647   000000 011000                    NOP     0
        26 000650   000743 710000 26                 TRA     s:17909

      915    17828
      916    17829    3        CASE(%LX_ETT_ITEM);

      917    17830    3          ERROR_LINE#   = NODE$ -> LX_ETT_ITEM.LINE;

  17830 26 000651   300005 235100                    LDA     5,,PR3
        26 000652   200037 755100                    STA     ERROR_LINE#,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:194  

      918    17831    3          ERROR_COLUMN#  = NODE$ -> LX_ETT_ITEM.COLUMN;

  17831 26 000653   100000 473500                    LDP3    0,,PR1
        26 000654   300006 235100                    LDA     6,,PR3
        26 000655   200040 755100                    STA     ERROR_COLUMN#,,AUTO

      919    17832
      920    17833    3          IF NODE$ -> LX_ETT_ITEM.ETT$ -> ETT.ID ~= %BASE THEN

  17833 26 000656   100000 473500                    LDP3    0,,PR1
        26 000657   300001 474500                    LDP4    1,,PR3
        26 000660   400000 220100                    LDX0    0,,PR4
        26 000661   000001 100003                    CMPX0   1,DU
        26 000662   000705 600000 26                 TZE     s:17868

      921    17834                 %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      922    17835                                     @ERROR#   = %E$INVALID_SUBSCRIPT,
      923    17836                                     @LINE     = ERROR_LINE#,
      924    17837                                     @COLUMN   = ERROR_COLUMN#);

  17847 26 000663   300000 236100                    LDQ     0,,PR3
        26 000664   400000 316007                    CANQ    -131072,DL
        26 000665   000743 601000 26                 TNZ     s:17909

  17849 26 000666   200040 635500                    EPPR5   ERROR_COLUMN#,,AUTO
        26 000667   200116 455500                    STP5    OCCHK+10,,AUTO
        26 000670   200037 633500                    EPPR3   ERROR_LINE#,,AUTO
        26 000671   200115 453500                    STP3    OCCHK+9,,AUTO
        26 000672   000002 236000 27                 LDQ     2
        26 000673   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000674   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000675   000000 631400 27                 EPPR1   0
        26 000676   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000677   000000 011000                    NOP     0

  17858 26 000700   200035 470500                    LDP0    @NODE$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:195  
        26 000701   000000 471500                    LDP1    0,,PR0
        26 000702   400000 236007                    LDQ     -131072,DL
        26 000703   100000 256100                    ORSQ    0,,PR1

  17865 26 000704   000743 710000 26                 TRA     s:17909

      925    17867    3          ELSE
      926    17868    3            CALL CHECK_FOR_INDEX_SUB (NODE$, INDEX_SUB);

  17868 26 000705   200036 236100                    LDQ     @INDEX_SUB,,AUTO
        26 000706   200052 756100                    STQ     NUM_DESC,,AUTO
        26 000707   200035 236100                    LDQ     @NODE$,,AUTO
        26 000710   200051 756100                    STQ     @NODE$,,AUTO
        26 000711   000003 701000 26                 TSX1    CHECK_FOR_INDEX_SUB
        26 000712   000000 011000                    NOP     0
        26 000713   000743 710000 26                 TRA     s:17909

      927    17869
      928    17870    3        CASE(ELSE);

      929    17871    3          ERROR_LINE#   = NODE$ -> LX_ITEM.LINE;

  17871 26 000714   300005 235100                    LDA     5,,PR3
        26 000715   200037 755100                    STA     ERROR_LINE#,,AUTO

      930    17872    3          ERROR_COLUMN#  = NODE$ -> LX_ITEM.COLUMN;

  17872 26 000716   100000 473500                    LDP3    0,,PR1
        26 000717   300006 235100                    LDA     6,,PR3
        26 000720   200040 755100                    STA     ERROR_COLUMN#,,AUTO

      931    17873
      932    17874               %CONDITIONAL_ERROR (@LX_ITEM$ = NODE$,
      933    17875                                   @ERROR#   = %E$INVALID_SUBSCRIPT,
      934    17876                                   @LINE     = ERROR_LINE#,
      935    17877                                   @COLUMN   = ERROR_COLUMN#);

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:196  
  17887 26 000721   100000 473500                    LDP3    0,,PR1
        26 000722   300000 236100                    LDQ     0,,PR3
        26 000723   400000 316007                    CANQ    -131072,DL
        26 000724   000743 601000 26                 TNZ     s:17909

  17889 26 000725   200040 634500                    EPPR4   ERROR_COLUMN#,,AUTO
        26 000726   200116 454500                    STP4    OCCHK+10,,AUTO
        26 000727   200037 633500                    EPPR3   ERROR_LINE#,,AUTO
        26 000730   200115 453500                    STP3    OCCHK+9,,AUTO
        26 000731   000002 236000 27                 LDQ     2
        26 000732   200114 756100                    STQ     OCCHK+8,,AUTO
        26 000733   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 000734   000000 631400 27                 EPPR1   0
        26 000735   000000 701000 xent               TSX1    Z8AE$ERROR
        26 000736   000000 011000                    NOP     0

  17898 26 000737   200035 470500                    LDP0    @NODE$,,AUTO
        26 000740   000000 471500                    LDP1    0,,PR0
        26 000741   400000 236007                    LDQ     -131072,DL
        26 000742   100000 256100                    ORSQ    0,,PR1

      936    17907
      937    17908    3      END; /* Case */

      938    17909    2   END VERIFY_SUBSCRIPT_SYNTAX;/*  Proc  */

  17909 26 000743   200034 221300                    LDX1  ! OP_NODE+8,,AUTO
        26 000744   000001 702211                    TSX2  ! 1,X1

      939    17910        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:197  
      940    17911    1   COMPUTE_SUBSCRIPT_OFFSET: PROC (LIST$, OFF, NEW_ETT$);

  17911 26 000745   200050 741300       COMPUTE_SUB* STX1  ! MAX_OFF_PRECISION+4,,AUTO

      941    17912
      942    17913    2   DCL LIST$                     PTR;
      943    17914    2   DCL OFF                       SBIN WORD;
      944    17915    2   DCL NEW_ETT$                  PTR;
      945    17916    2   DCL ETT$$                     PTR;
      946    17917
      947    17918    3      DO CASE (LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.ID);

  17918 26 000746   200051 470500                    LDP0    @LIST$,,AUTO
        26 000747   000000 471500                    LDP1    0,,PR0
        26 000750   100001 473500                    LDP3    1,,PR1
        26 000751   300000 236100                    LDQ     0,,PR3
        26 000752   000022 772000                    QRL     18
        26 000753   000015 136007                    SBLQ    13,DL
        26 000754   000042 116007                    CMPQ    34,DL
        26 000755   000757 602006 26                 TNC     s:17918+9,QL
        26 000756   001410 710000 26                 TRA     s:18034
        26 000757   001401 710000 26                 TRA     s:18029
        26 000760   001410 710000 26                 TRA     s:18034
        26 000761   001410 710000 26                 TRA     s:18034
        26 000762   001410 710000 26                 TRA     s:18034
        26 000763   001410 710000 26                 TRA     s:18034
        26 000764   001410 710000 26                 TRA     s:18034
        26 000765   001410 710000 26                 TRA     s:18034
        26 000766   001410 710000 26                 TRA     s:18034
        26 000767   001410 710000 26                 TRA     s:18034
        26 000770   001410 710000 26                 TRA     s:18034
        26 000771   001410 710000 26                 TRA     s:18034
        26 000772   001410 710000 26                 TRA     s:18034
        26 000773   001410 710000 26                 TRA     s:18034
        26 000774   001410 710000 26                 TRA     s:18034
        26 000775   001410 710000 26                 TRA     s:18034
        26 000776   001410 710000 26                 TRA     s:18034
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:198  
        26 000777   001410 710000 26                 TRA     s:18034
        26 001000   001410 710000 26                 TRA     s:18034
        26 001001   001410 710000 26                 TRA     s:18034
        26 001002   001410 710000 26                 TRA     s:18034
        26 001003   001410 710000 26                 TRA     s:18034
        26 001004   001410 710000 26                 TRA     s:18034
        26 001005   001410 710000 26                 TRA     s:18034
        26 001006   001410 710000 26                 TRA     s:18034
        26 001007   001410 710000 26                 TRA     s:18034
        26 001010   001410 710000 26                 TRA     s:18034
        26 001011   001410 710000 26                 TRA     s:18034
        26 001012   001410 710000 26                 TRA     s:18034
        26 001013   001410 710000 26                 TRA     s:18034
        26 001014   001410 710000 26                 TRA     s:18034
        26 001015   001410 710000 26                 TRA     s:18034
        26 001016   001021 710000 26                 TRA     s:17921
        26 001017   001410 710000 26                 TRA     s:18034
        26 001020   001211 710000 26                 TRA     s:17975

      948    17919
      949    17920    3        CASE(%ADI);

      950    17921    3          IF COMCOM.OB.SUBCHK THEN

  17921 26 001021   000020 234000 xsym               SZN     COMCOM+16
        26 001022   001072 605000 26                 TPL     s:17939

      951    17922                 %ADJUST_SUBSCRIPT_FOR_SPAN (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$);

  17924 26 001023   100001 634500                    EPPR4   1,,PR1
        26 001024   200061 454500                    STP4    @NODE$,,AUTO
        26 001025   100001 633500                    EPPR3   1,,PR1
        26 001026   200060 453500                    STP3    @DIM#+1,,AUTO
        26 001027   200015 631500                    EPPR1   DIM#,,AUTO
        26 001030   200057 451500                    STP1    @INDEX_ST$+1,,AUTO
        26 001031   003227 701000 26                 TSX1    SUBCHK
        26 001032   000000 011000                    NOP     0
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:199  

  17925 26 001033   200016 235100                    LDA     SPAN#,,AUTO
        26 001034   000001 115007                    CMPA    1,DL
        26 001035   001044 601000 26                 TNZ     s:17929

  17926 26 001036   200051 470500                    LDP0    @LIST$,,AUTO
        26 001037   000000 471500                    LDP1    0,,PR0
        26 001040   100001 236100                    LDQ     1,,PR1
        26 001041   200053 473500                    LDP3    @NEW_ETT$,,AUTO
        26 001042   300000 756100                    STQ     0,,PR3
        26 001043   001456 710000 26                 TRA     s:18048

  17929 26 001044   000000 755000 25                 STA     MKCN

  17930 26 001045   200054 630500                    EPPR0   ETT$$,,AUTO
        26 001046   200114 450500                    STP0    OCCHK+8,,AUTO
        26 001047   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001050   000007 631400 27                 EPPR1   7
        26 001051   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 001052   000000 011000                    NOP     0

  17931 26 001053   200051 470500                    LDP0    @LIST$,,AUTO
        26 001054   000000 471500                    LDP1    0,,PR0
        26 001055   200053 236100                    LDQ     @NEW_ETT$,,AUTO
        26 001056   200117 756100                    STQ     OCCHK+11,,AUTO
        26 001057   200054 633500                    EPPR3   ETT$$,,AUTO
        26 001060   200116 453500                    STP3    OCCHK+10,,AUTO
        26 001061   100001 634500                    EPPR4   1,,PR1
        26 001062   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001063   000012 236000 27                 LDQ     10
        26 001064   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001065   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001066   000010 631400 27                 EPPR1   8
        26 001067   000000 701000 xent               TSX1    Z8AF$FORME
        26 001070   000000 011000                    NOP     0

  17933 26 001071   001456 710000 26                 TRA     s:18048
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:200  

      952    17935    3          ELSE
      953    17936    4            DO;

      954    17937                   %OPTIMIZE_FOR_ADI_OR_SBI;

  17939 26 001072   300002 474500                    LDP4    2,,PR3
        26 001073   400000 220100                    LDX0    0,,PR4
        26 001074   000015 100003                    CMPX0   13,DU
        26 001075   001136 601000 26                 TNZ     s:17961

  17941 26 001076   300000 222100                    LDX2    0,,PR3
        26 001077   000056 102003                    CMPX2   46,DU
        26 001100   001121 601000 26                 TNZ     s:17950

  17943 26 001101   400001 475500                    LDP5    1,,PR4
        26 001102   500010 236100                    LDQ     8,,PR5
        26 001103   200016 402100                    MPY     SPAN#,,AUTO
        26 001104   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001105   200052 471500                    LDP1    @OFF,,AUTO
        26 001106   100000 236100                    LDQ     0,,PR1
        26 001107   200114 136100                    SBLQ    OCCHK+8,,AUTO
        26 001110   100000 756100                    STQ     0,,PR1

  17945 26 001111   000000 473500                    LDP3    0,,PR0
        26 001112   300001 474500                    LDP4    1,,PR3
        26 001113   400002 475500                    LDP5    2,,PR4
        26 001114   500001 476500                    LDP6    1,,PR5
        26 001115   600010 236100                    LDQ     8,,PR6
        26 001116   200015 036100                    ADLQ    DIM#,,AUTO
        26 001117   200015 756100                    STQ     DIM#,,AUTO

  17947 26 001120   001136 710000 26                 TRA     s:17961

  17950 26 001121   400001 475500                    LDP5    1,,PR4
        26 001122   500010 236100                    LDQ     8,,PR5
        26 001123   200016 402100                    MPY     SPAN#,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:201  
        26 001124   200052 476500                    LDP6    @OFF,,AUTO
        26 001125   600000 036100                    ADLQ    0,,PR6
        26 001126   600000 756100                    STQ     0,,PR6

  17952 26 001127   000000 471500                    LDP1    0,,PR0
        26 001130   100001 473500                    LDP3    1,,PR1
        26 001131   300002 474500                    LDP4    2,,PR3
        26 001132   400001 475500                    LDP5    1,,PR4
        26 001133   200015 236100                    LDQ     DIM#,,AUTO
        26 001134   500010 136100                    SBLQ    8,,PR5
        26 001135   200015 756100                    STQ     DIM#,,AUTO

      955    17958                   %ADJUST_SUBSCRIPT_FOR_SPAN
      956    17959                           (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP);

  17961 26 001136   000000 471500                    LDP1    0,,PR0
        26 001137   100001 473500                    LDP3    1,,PR1
        26 001140   300001 634500                    EPPR4   1,,PR3
        26 001141   200061 454500                    STP4    @NODE$,,AUTO
        26 001142   300001 631500                    EPPR1   1,,PR3
        26 001143   200060 451500                    STP1    @DIM#+1,,AUTO
        26 001144   200015 633500                    EPPR3   DIM#,,AUTO
        26 001145   200057 453500                    STP3    @INDEX_ST$+1,,AUTO
        26 001146   003227 701000 26                 TSX1    SUBCHK
        26 001147   000000 011000                    NOP     0

  17962 26 001150   200016 235100                    LDA     SPAN#,,AUTO
        26 001151   000001 115007                    CMPA    1,DL
        26 001152   001162 601000 26                 TNZ     s:17966

  17963 26 001153   200051 470500                    LDP0    @LIST$,,AUTO
        26 001154   000000 471500                    LDP1    0,,PR0
        26 001155   100001 473500                    LDP3    1,,PR1
        26 001156   300001 236100                    LDQ     1,,PR3
        26 001157   200053 474500                    LDP4    @NEW_ETT$,,AUTO
        26 001160   400000 756100                    STQ     0,,PR4
        26 001161   001456 710000 26                 TRA     s:18048
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:202  

  17966 26 001162   000000 755000 25                 STA     MKCN

  17967 26 001163   200054 630500                    EPPR0   ETT$$,,AUTO
        26 001164   200114 450500                    STP0    OCCHK+8,,AUTO
        26 001165   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001166   000007 631400 27                 EPPR1   7
        26 001167   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 001170   000000 011000                    NOP     0

  17968 26 001171   200051 470500                    LDP0    @LIST$,,AUTO
        26 001172   000000 471500                    LDP1    0,,PR0
        26 001173   100001 473500                    LDP3    1,,PR1
        26 001174   200053 236100                    LDQ     @NEW_ETT$,,AUTO
        26 001175   200117 756100                    STQ     OCCHK+11,,AUTO
        26 001176   200054 631500                    EPPR1   ETT$$,,AUTO
        26 001177   200116 451500                    STP1    OCCHK+10,,AUTO
        26 001200   300001 634500                    EPPR4   1,,PR3
        26 001201   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001202   000012 236000 27                 LDQ     10
        26 001203   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001204   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001205   000010 631400 27                 EPPR1   8
        26 001206   000000 701000 xent               TSX1    Z8AF$FORME
        26 001207   000000 011000                    NOP     0

      957    17972    4            END;

  17972 26 001210   001456 710000 26                 TRA     s:18048

      958    17973
      959    17974    3        CASE(%SBI);

      960    17975    3          IF COMCOM.OB.SUBCHK THEN

  17975 26 001211   000020 234000 xsym               SZN     COMCOM+16
        26 001212   001262 605000 26                 TPL     s:17993
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:203  

      961    17976                 %ADJUST_SUBSCRIPT_FOR_SPAN (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$);

  17978 26 001213   100001 634500                    EPPR4   1,,PR1
        26 001214   200061 454500                    STP4    @NODE$,,AUTO
        26 001215   100001 633500                    EPPR3   1,,PR1
        26 001216   200060 453500                    STP3    @DIM#+1,,AUTO
        26 001217   200015 631500                    EPPR1   DIM#,,AUTO
        26 001220   200057 451500                    STP1    @INDEX_ST$+1,,AUTO
        26 001221   003227 701000 26                 TSX1    SUBCHK
        26 001222   000000 011000                    NOP     0

  17979 26 001223   200016 235100                    LDA     SPAN#,,AUTO
        26 001224   000001 115007                    CMPA    1,DL
        26 001225   001234 601000 26                 TNZ     s:17983

  17980 26 001226   200051 470500                    LDP0    @LIST$,,AUTO
        26 001227   000000 471500                    LDP1    0,,PR0
        26 001230   100001 236100                    LDQ     1,,PR1
        26 001231   200053 473500                    LDP3    @NEW_ETT$,,AUTO
        26 001232   300000 756100                    STQ     0,,PR3
        26 001233   001456 710000 26                 TRA     s:18048

  17983 26 001234   000000 755000 25                 STA     MKCN

  17984 26 001235   200054 630500                    EPPR0   ETT$$,,AUTO
        26 001236   200114 450500                    STP0    OCCHK+8,,AUTO
        26 001237   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001240   000007 631400 27                 EPPR1   7
        26 001241   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 001242   000000 011000                    NOP     0

  17985 26 001243   200051 470500                    LDP0    @LIST$,,AUTO
        26 001244   000000 471500                    LDP1    0,,PR0
        26 001245   200053 236100                    LDQ     @NEW_ETT$,,AUTO
        26 001246   200117 756100                    STQ     OCCHK+11,,AUTO
        26 001247   200054 633500                    EPPR3   ETT$$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:204  
        26 001250   200116 453500                    STP3    OCCHK+10,,AUTO
        26 001251   100001 634500                    EPPR4   1,,PR1
        26 001252   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001253   000012 236000 27                 LDQ     10
        26 001254   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001255   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001256   000010 631400 27                 EPPR1   8
        26 001257   000000 701000 xent               TSX1    Z8AF$FORME
        26 001260   000000 011000                    NOP     0

  17987 26 001261   001456 710000 26                 TRA     s:18048

      962    17989    3          ELSE
      963    17990    4            DO;

      964    17991                   %OPTIMIZE_FOR_ADI_OR_SBI;

  17993 26 001262   300002 474500                    LDP4    2,,PR3
        26 001263   400000 220100                    LDX0    0,,PR4
        26 001264   000015 100003                    CMPX0   13,DU
        26 001265   001326 601000 26                 TNZ     s:18015

  17995 26 001266   300000 222100                    LDX2    0,,PR3
        26 001267   000056 102003                    CMPX2   46,DU
        26 001270   001311 601000 26                 TNZ     s:18004

  17997 26 001271   400001 475500                    LDP5    1,,PR4
        26 001272   500010 236100                    LDQ     8,,PR5
        26 001273   200016 402100                    MPY     SPAN#,,AUTO
        26 001274   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001275   200052 471500                    LDP1    @OFF,,AUTO
        26 001276   100000 236100                    LDQ     0,,PR1
        26 001277   200114 136100                    SBLQ    OCCHK+8,,AUTO
        26 001300   100000 756100                    STQ     0,,PR1

  17999 26 001301   000000 473500                    LDP3    0,,PR0
        26 001302   300001 474500                    LDP4    1,,PR3
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:205  
        26 001303   400002 475500                    LDP5    2,,PR4
        26 001304   500001 476500                    LDP6    1,,PR5
        26 001305   600010 236100                    LDQ     8,,PR6
        26 001306   200015 036100                    ADLQ    DIM#,,AUTO
        26 001307   200015 756100                    STQ     DIM#,,AUTO

  18001 26 001310   001326 710000 26                 TRA     s:18015

  18004 26 001311   400001 475500                    LDP5    1,,PR4
        26 001312   500010 236100                    LDQ     8,,PR5
        26 001313   200016 402100                    MPY     SPAN#,,AUTO
        26 001314   200052 476500                    LDP6    @OFF,,AUTO
        26 001315   600000 036100                    ADLQ    0,,PR6
        26 001316   600000 756100                    STQ     0,,PR6

  18006 26 001317   000000 471500                    LDP1    0,,PR0
        26 001320   100001 473500                    LDP3    1,,PR1
        26 001321   300002 474500                    LDP4    2,,PR3
        26 001322   400001 475500                    LDP5    1,,PR4
        26 001323   200015 236100                    LDQ     DIM#,,AUTO
        26 001324   500010 136100                    SBLQ    8,,PR5
        26 001325   200015 756100                    STQ     DIM#,,AUTO

      965    18012                   %ADJUST_SUBSCRIPT_FOR_SPAN
      966    18013                           (@ETT$ = LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP);

  18015 26 001326   000000 471500                    LDP1    0,,PR0
        26 001327   100001 473500                    LDP3    1,,PR1
        26 001330   300001 634500                    EPPR4   1,,PR3
        26 001331   200061 454500                    STP4    @NODE$,,AUTO
        26 001332   300001 631500                    EPPR1   1,,PR3
        26 001333   200060 451500                    STP1    @DIM#+1,,AUTO
        26 001334   200015 633500                    EPPR3   DIM#,,AUTO
        26 001335   200057 453500                    STP3    @INDEX_ST$+1,,AUTO
        26 001336   003227 701000 26                 TSX1    SUBCHK
        26 001337   000000 011000                    NOP     0

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:206  
  18016 26 001340   200016 235100                    LDA     SPAN#,,AUTO
        26 001341   000001 115007                    CMPA    1,DL
        26 001342   001352 601000 26                 TNZ     s:18020

  18017 26 001343   200051 470500                    LDP0    @LIST$,,AUTO
        26 001344   000000 471500                    LDP1    0,,PR0
        26 001345   100001 473500                    LDP3    1,,PR1
        26 001346   300001 236100                    LDQ     1,,PR3
        26 001347   200053 474500                    LDP4    @NEW_ETT$,,AUTO
        26 001350   400000 756100                    STQ     0,,PR4
        26 001351   001456 710000 26                 TRA     s:18048

  18020 26 001352   000000 755000 25                 STA     MKCN

  18021 26 001353   200054 630500                    EPPR0   ETT$$,,AUTO
        26 001354   200114 450500                    STP0    OCCHK+8,,AUTO
        26 001355   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001356   000007 631400 27                 EPPR1   7
        26 001357   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 001360   000000 011000                    NOP     0

  18022 26 001361   200051 470500                    LDP0    @LIST$,,AUTO
        26 001362   000000 471500                    LDP1    0,,PR0
        26 001363   100001 473500                    LDP3    1,,PR1
        26 001364   200053 236100                    LDQ     @NEW_ETT$,,AUTO
        26 001365   200117 756100                    STQ     OCCHK+11,,AUTO
        26 001366   200054 631500                    EPPR1   ETT$$,,AUTO
        26 001367   200116 451500                    STP1    OCCHK+10,,AUTO
        26 001370   300001 634500                    EPPR4   1,,PR3
        26 001371   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001372   000012 236000 27                 LDQ     10
        26 001373   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001374   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001375   000010 631400 27                 EPPR1   8
        26 001376   000000 701000 xent               TSX1    Z8AF$FORME
        26 001377   000000 011000                    NOP     0

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:207  
      967    18026    4            END;

  18026 26 001400   001456 710000 26                 TRA     s:18048

      968    18027
      969    18028    3        CASE(%TRIAD);

      970    18029    3          OFF = OFF + LIST$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1 *
             18029                   SPAN#;

  18029 26 001401   300001 474500                    LDP4    1,,PR3
        26 001402   400010 236100                    LDQ     8,,PR4
        26 001403   200016 402100                    MPY     SPAN#,,AUTO
        26 001404   200052 475500                    LDP5    @OFF,,AUTO
        26 001405   500000 036100                    ADLQ    0,,PR5
        26 001406   500000 756100                    STQ     0,,PR5
        26 001407   001456 710000 26                 TRA     s:18048

      971    18030
      972    18031    3        CASE(ELSE);

      973    18032               %ADJUST_SUBSCRIPT_FOR_SPAN(@ETT$= LIST$ -> LX_ETT_ITEM.ETT$);

  18034 26 001410   100001 634500                    EPPR4   1,,PR1
        26 001411   200061 454500                    STP4    @NODE$,,AUTO
        26 001412   100001 633500                    EPPR3   1,,PR1
        26 001413   200060 453500                    STP3    @DIM#+1,,AUTO
        26 001414   200015 631500                    EPPR1   DIM#,,AUTO
        26 001415   200057 451500                    STP1    @INDEX_ST$+1,,AUTO
        26 001416   003227 701000 26                 TSX1    SUBCHK
        26 001417   000000 011000                    NOP     0

  18035 26 001420   200016 235100                    LDA     SPAN#,,AUTO
        26 001421   000001 115007                    CMPA    1,DL
        26 001422   001431 601000 26                 TNZ     s:18039

  18036 26 001423   200051 470500                    LDP0    @LIST$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:208  
        26 001424   000000 471500                    LDP1    0,,PR0
        26 001425   100001 236100                    LDQ     1,,PR1
        26 001426   200053 473500                    LDP3    @NEW_ETT$,,AUTO
        26 001427   300000 756100                    STQ     0,,PR3
        26 001430   001456 710000 26                 TRA     s:18048

  18039 26 001431   000000 755000 25                 STA     MKCN

  18040 26 001432   200054 630500                    EPPR0   ETT$$,,AUTO
        26 001433   200114 450500                    STP0    OCCHK+8,,AUTO
        26 001434   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001435   000007 631400 27                 EPPR1   7
        26 001436   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 001437   000000 011000                    NOP     0

  18041 26 001440   200051 470500                    LDP0    @LIST$,,AUTO
        26 001441   000000 471500                    LDP1    0,,PR0
        26 001442   200053 236100                    LDQ     @NEW_ETT$,,AUTO
        26 001443   200117 756100                    STQ     OCCHK+11,,AUTO
        26 001444   200054 633500                    EPPR3   ETT$$,,AUTO
        26 001445   200116 453500                    STP3    OCCHK+10,,AUTO
        26 001446   100001 634500                    EPPR4   1,,PR1
        26 001447   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001450   000012 236000 27                 LDQ     10
        26 001451   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001452   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001453   000010 631400 27                 EPPR1   8
        26 001454   000000 701000 xent               TSX1    Z8AF$FORME
        26 001455   000000 011000                    NOP     0

      974    18045
      975    18046    3      END; /* Case -- id */

      976    18047
      977    18048    2   END COMPUTE_SUBSCRIPT_OFFSET;

  18048 26 001456   200050 221300                    LDX1  ! MAX_OFF_PRECISION+4,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:209  
        26 001457   000001 702211                    TSX2  ! 1,X1

      978    18049        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:210  
      979    18050    1   WRAP_UP: PROC (SS_EXP$, OFF, IDENT$);

  18050 26 001460   200034 741300       WRAP_UP      STX1  ! OP_NODE+8,,AUTO

      980    18051
      981    18052    2   DCL SS_EXP$                   PTR;
      982    18053    2   DCL OFF                       SBIN WORD;
      983    18054    2   DCL IDENT$                    PTR;
      984    18055
      985    18056    2   DCL OFF$                      PTR;
      986    18057    2   DCL SIZ$                      PTR;
      987    18058    2   DCL FISS_OFF                  UBIN;
      988    18059    2   DCL REFMOD$                   PTR;
      989    18060    2   DCL MAX_OFF_PRECISION  SBIN;
      990    18061
      991    18062        %IF CP6;
      992    18063    2    IF ARRAY_ST$ -> SCALAR.B.LINKAGE THEN

  18063 26 001461   200005 470500                    LDP0    ARRAY_ST$,,AUTO
        26 001462   000003 236100                    LDQ     3,,PR0
        26 001463   000002 316003                    CANQ    2,DU
        26 001464   001470 600000 26                 TZE     s:18068

      993    18064        %ENDIF;
      994    18065    2      MAX_OFF_PRECISION = %#16K;

  18065 26 001465   040000 235007                    LDA     16384,DL
        26 001466   200044 755100                    STA     MAX_OFF_PRECISION,,AUTO
        26 001467   001472 710000 26                 TRA     s:18071

      995    18066        %IF CP6;
      996    18067    2    ELSE
      997    18068    2      MAX_OFF_PRECISION = %#128K;

  18068 26 001470   400000 235007                    LDA     -131072,DL
        26 001471   200044 755100                    STA     MAX_OFF_PRECISION,,AUTO

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:211  
      998    18069        %ENDIF;
      999    18070
     1000    18071    2    IF OFF >= MAX_OFF_PRECISION

  18071 26 001472   200036 471500                    LDP1    @OFF,,AUTO
        26 001473   100000 236100                    LDQ     0,,PR1
        26 001474   200044 116100                    CMPQ    MAX_OFF_PRECISION,,AUTO
        26 001475   001501 605000 26                 TPL     s:18074
        26 001476   200044 336100                    LCQ     MAX_OFF_PRECISION,,AUTO
        26 001477   100000 116100                    CMPQ    0,,PR1
        26 001500   001534 604000 26                 TMI     s:18085

     1001    18072    2    OR OFF <= - MAX_OFF_PRECISION THEN
     1002    18073    3      DO;

     1003    18074    3        MKCN.CON = OFF;

  18074 26 001501   100000 235100                    LDA     0,,PR1
        26 001502   000000 755000 25                 STA     MKCN

     1004    18075    3        CALL Z8AC$MAKE_CONST (OFF$);

  18075 26 001503   200040 633500                    EPPR3   OFF$,,AUTO
        26 001504   200114 453500                    STP3    OCCHK+8,,AUTO
        26 001505   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001506   000007 631400 27                 EPPR1   7
        26 001507   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 001510   000000 011000                    NOP     0

     1005    18076
     1006    18077    3        IF SS_EXP$ ~= ADDR(NIL) THEN

  18077 26 001511   200035 470500                    LDP0    @SS_EXP$,,AUTO
        26 001512   000000 236100                    LDQ     0,,PR0
        26 001513   000003 116000 27                 CMPQ    3
        26 001514   001530 600000 26                 TZE     s:18080

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:212  
     1007    18078    3          CALL Z8AF$FORME (%ADI, SS_EXP$, OFF$, SS_EXP$);

  18078 26 001515   200035 236100                    LDQ     @SS_EXP$,,AUTO
        26 001516   200117 756100                    STQ     OCCHK+11,,AUTO
        26 001517   200040 631500                    EPPR1   OFF$,,AUTO
        26 001520   200116 451500                    STP1    OCCHK+10,,AUTO
        26 001521   000014 235000 27                 LDA     12
        26 001522   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 001523   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001524   000010 631400 27                 EPPR1   8
        26 001525   000000 701000 xent               TSX1    Z8AF$FORME
        26 001526   000000 011000                    NOP     0
        26 001527   001532 710000 26                 TRA     s:18082

     1008    18079    3        ELSE
     1009    18080    3          SS_EXP$ = OFF$;

  18080 26 001530   200040 236100                    LDQ     OFF$,,AUTO
        26 001531   000000 756100                    STQ     0,,PR0

     1010    18081
     1011    18082    3        OFF = 0;

  18082 26 001532   200036 470500                    LDP0    @OFF,,AUTO
        26 001533   000000 450100                    STZ     0,,PR0

     1012    18083    3      END;

     1013    18084
     1014    18085    2    FISS_OFF = 0;

  18085 26 001534   200042 450100                    STZ     FISS_OFF,,AUTO

     1015    18086    2    REFMOD$ = ADDR(NIL);

  18086 26 001535   000003 236000 27                 LDQ     3
        26 001536   200043 756100                    STQ     REFMOD$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:213  

     1016    18087    3    IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %FISS THEN DO;

  18087 26 001537   200037 470500                    LDP0    @IDENT$,,AUTO
        26 001540   000000 471500                    LDP1    0,,PR0
        26 001541   100001 473500                    LDP3    1,,PR1
        26 001542   300000 220100                    LDX0    0,,PR3
        26 001543   000002 100003                    CMPX0   2,DU
        26 001544   001555 601000 26                 TNZ     s:18091

     1017    18088    3      FISS_OFF = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.SIZE.VALUE;

  18088 26 001545   300002 236100                    LDQ     2,,PR3
        26 001546   000022 732000                    QRS     18
        26 001547   200042 756100                    STQ     FISS_OFF,,AUTO

     1018    18089    3      IDENT$ -> LX_ETT_ITEM.ETT$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP;

  18089 26 001550   000000 471500                    LDP1    0,,PR0
        26 001551   100001 473500                    LDP3    1,,PR1
        26 001552   300001 236100                    LDQ     1,,PR3
        26 001553   100001 756100                    STQ     1,,PR1

     1019    18090    3    END;

  18090 26 001554   001565 710000 26                 TRA     s:18095

     1020    18091    3    ELSE IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %REFMOD THEN DO;

  18091 26 001555   000012 100003                    CMPX0   10,DU
        26 001556   001565 601000 26                 TNZ     s:18095

     1021    18092    3      REFMOD$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP;

  18092 26 001557   300002 236100                    LDQ     2,,PR3
        26 001560   200043 756100                    STQ     REFMOD$,,AUTO

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:214  
     1022    18093    3      IDENT$ -> LX_ETT_ITEM.ETT$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP;

  18093 26 001561   000000 471500                    LDP1    0,,PR0
        26 001562   100001 473500                    LDP3    1,,PR1
        26 001563   300001 236100                    LDQ     1,,PR3
        26 001564   100001 756100                    STQ     1,,PR1

     1023    18094    3    END;

     1024    18095    2    SIZ$ = ADDR(NIL);

  18095 26 001565   000003 236000 27                 LDQ     3
        26 001566   200041 756100                    STQ     SIZ$,,AUTO

     1025    18096    2    IF OFF ~= 0

  18096 26 001567   200036 471500                    LDP1    @OFF,,AUTO
        26 001570   100000 235100                    LDA     0,,PR1
        26 001571   001576 601000 26                 TNZ     s:18098
        26 001572   200035 473500                    LDP3    @SS_EXP$,,AUTO
        26 001573   300000 236100                    LDQ     0,,PR3
        26 001574   000003 116000 27                 CMPQ    3
        26 001575   001611 600000 26                 TZE     s:18103

     1026    18097    2    OR SS_EXP$ ~= ADDR(NIL) THEN
     1027    18098    3      IF IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ID = %SIZ THEN DO;

  18098 26 001576   000000 473500                    LDP3    0,,PR0
        26 001577   300001 474500                    LDP4    1,,PR3
        26 001600   400000 220100                    LDX0    0,,PR4
        26 001601   000004 100003                    CMPX0   4,DU
        26 001602   001611 601000 26                 TNZ     s:18103

     1028    18099    3        SIZ$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.ROP;

  18099 26 001603   400002 236100                    LDQ     2,,PR4
        26 001604   200041 756100                    STQ     SIZ$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:215  

     1029    18100    3        IDENT$ -> LX_ETT_ITEM.ETT$ = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP;

  18100 26 001605   000000 473500                    LDP3    0,,PR0
        26 001606   300001 474500                    LDP4    1,,PR3
        26 001607   400001 236100                    LDQ     1,,PR4
        26 001610   300001 756100                    STQ     1,,PR3

     1030    18101    3      END;

     1031    18102
     1032    18103    2    ID_TYPE = IDENT$ -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> VARIABLE.TYPE;

  18103 26 001611   000000 473500                    LDP3    0,,PR0
        26 001612   300001 474500                    LDP4    1,,PR3
        26 001613   400001 475500                    LDP5    1,,PR4
        26 001614   500002 236100                    LDQ     2,,PR5
        26 001615   000022 772000                    QRL     18
        26 001616   200021 756100                    STQ     ID_TYPE,,AUTO

     1033    18104    2    IF ID_TYPE = %TYC THEN

  18104 26 001617   000023 116007                    CMPQ    19,DL
        26 001620   001635 601000 26                 TNZ     s:18110

     1034    18105    2      CALL Z8AF$FORME (%DNA,

  18105 26 001621   300001 636500                    EPPR6   1,,PR3
        26 001622   200117 456500                    STP6    OCCHK+11,,AUTO
        26 001623   000017 236000 27                 LDQ     15
        26 001624   200116 756100                    STQ     OCCHK+10,,AUTO
        26 001625   300001 634500                    EPPR4   1,,PR3
        26 001626   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001627   000020 236000 27                 LDQ     16
        26 001630   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001631   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001632   000010 631400 27                 EPPR1   8
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:216  
        26 001633   000000 701000 xent               TSX1    Z8AF$FORME
        26 001634   000000 011000                    NOP     0

     1035    18106    2                       IDENT$ -> LX_ETT_ITEM.ETT$,
     1036    18107    2                       0,
     1037    18108    2                       IDENT$ -> LX_ETT_ITEM.ETT$);
     1038    18109
     1039    18110    2    IF SS_EXP$ ~= ADDR(NIL) THEN

  18110 26 001635   200035 470500                    LDP0    @SS_EXP$,,AUTO
        26 001636   000000 236100                    LDQ     0,,PR0
        26 001637   000003 116000 27                 CMPQ    3
        26 001640   001660 600000 26                 TZE     s:18116

     1040    18111    2      CALL Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK (IDENT$ -> LX_ETT_ITEM.ETT$,

  18111 26 001641   200037 471500                    LDP1    @IDENT$,,AUTO
        26 001642   100000 473500                    LDP3    0,,PR1
        26 001643   300001 634500                    EPPR4   1,,PR3
        26 001644   200117 454500                    STP4    OCCHK+11,,AUTO
        26 001645   200035 236100                    LDQ     @SS_EXP$,,AUTO
        26 001646   200116 756100                    STQ     OCCHK+10,,AUTO
        26 001647   200036 236100                    LDQ     @OFF,,AUTO
        26 001650   200115 756100                    STQ     OCCHK+9,,AUTO
        26 001651   300001 635500                    EPPR5   1,,PR3
        26 001652   200114 455500                    STP5    OCCHK+8,,AUTO
        26 001653   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001654   000010 631400 27                 EPPR1   8
        26 001655   000000 701000 xent               TSX1    Z8AF$NEW_OFF_AND_SSOP_NO_SBCHK
        26 001656   000000 011000                    NOP     0
        26 001657   001677 710000 26                 TRA     s:18121

     1041    18112    2                                  OFF,
     1042    18113    2                                  SS_EXP$,
     1043    18114    2                                  IDENT$ -> LX_ETT_ITEM.ETT$);
     1044    18115    2    ELSE
     1045    18116    2    IF OFF ~= 0 THEN
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:217  

  18116 26 001660   200036 471500                    LDP1    @OFF,,AUTO
        26 001661   100000 235100                    LDA     0,,PR1
        26 001662   001677 600000 26                 TZE     s:18121

     1046    18117    2      CALL Z8AF$NEW_OFF (IDENT$ -> LX_ETT_ITEM.ETT$,

  18117 26 001663   200037 473500                    LDP3    @IDENT$,,AUTO
        26 001664   300000 474500                    LDP4    0,,PR3
        26 001665   400001 635500                    EPPR5   1,,PR4
        26 001666   200116 455500                    STP5    OCCHK+10,,AUTO
        26 001667   200036 236100                    LDQ     @OFF,,AUTO
        26 001670   200115 756100                    STQ     OCCHK+9,,AUTO
        26 001671   400001 636500                    EPPR6   1,,PR4
        26 001672   200114 456500                    STP6    OCCHK+8,,AUTO
        26 001673   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001674   000000 631400 27                 EPPR1   0
        26 001675   000000 701000 xent               TSX1    Z8AF$NEW_OFF
        26 001676   000000 011000                    NOP     0

     1047    18118    2                         OFF,
     1048    18119    2                         IDENT$ -> LX_ETT_ITEM.ETT$);
     1049    18120
     1050    18121    2    IF ID_TYPE = %TYC THEN

  18121 26 001677   200021 235100                    LDA     ID_TYPE,,AUTO
        26 001700   000023 115007                    CMPA    19,DL
        26 001701   001720 601000 26                 TNZ     s:18127

     1051    18122    2      CALL Z8AF$FORME (%DAN,

  18122 26 001702   200037 470500                    LDP0    @IDENT$,,AUTO
        26 001703   000000 471500                    LDP1    0,,PR0
        26 001704   100001 633500                    EPPR3   1,,PR1
        26 001705   200117 453500                    STP3    OCCHK+11,,AUTO
        26 001706   000017 236000 27                 LDQ     15
        26 001707   200116 756100                    STQ     OCCHK+10,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:218  
        26 001710   100001 634500                    EPPR4   1,,PR1
        26 001711   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001712   000022 236000 27                 LDQ     18
        26 001713   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001714   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001715   000010 631400 27                 EPPR1   8
        26 001716   000000 701000 xent               TSX1    Z8AF$FORME
        26 001717   000000 011000                    NOP     0

     1052    18123    2                       IDENT$ -> LX_ETT_ITEM.ETT$,
     1053    18124    2                       0,
     1054    18125    2                       IDENT$ -> LX_ETT_ITEM.ETT$);
     1055    18126
     1056    18127    2    IF SIZ$ ~= ADDR(NIL) THEN

  18127 26 001720   200041 236100                    LDQ     SIZ$,,AUTO
        26 001721   000003 116000 27                 CMPQ    3
        26 001722   001741 600000 26                 TZE     s:18133

     1057    18128    2      CALL Z8AF$FORME (%SIZ,

  18128 26 001723   200037 470500                    LDP0    @IDENT$,,AUTO
        26 001724   000000 471500                    LDP1    0,,PR0
        26 001725   100001 633500                    EPPR3   1,,PR1
        26 001726   200117 453500                    STP3    OCCHK+11,,AUTO
        26 001727   200041 634500                    EPPR4   SIZ$,,AUTO
        26 001730   200116 454500                    STP4    OCCHK+10,,AUTO
        26 001731   100001 635500                    EPPR5   1,,PR1
        26 001732   200115 455500                    STP5    OCCHK+9,,AUTO
        26 001733   000024 236000 27                 LDQ     20
        26 001734   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001735   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001736   000010 631400 27                 EPPR1   8
        26 001737   000000 701000 xent               TSX1    Z8AF$FORME
        26 001740   000000 011000                    NOP     0

     1058    18129    2                       IDENT$ -> LX_ETT_ITEM.ETT$,
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:219  
     1059    18130    2                       SIZ$,
     1060    18131    2                       IDENT$ -> LX_ETT_ITEM.ETT$);
     1061    18132
     1062    18133    2   IF REFMOD$ ~= ADDR(NIL) THEN

  18133 26 001741   200043 236100                    LDQ     REFMOD$,,AUTO
        26 001742   000003 116000 27                 CMPQ    3
        26 001743   001763 600000 26                 TZE     s:18138

     1063    18134    2     CALL Z8AF$FORME (%REFMOD,

  18134 26 001744   200037 470500                    LDP0    @IDENT$,,AUTO
        26 001745   000000 471500                    LDP1    0,,PR0
        26 001746   100001 633500                    EPPR3   1,,PR1
        26 001747   200117 453500                    STP3    OCCHK+11,,AUTO
        26 001750   200043 634500                    EPPR4   REFMOD$,,AUTO
        26 001751   200116 454500                    STP4    OCCHK+10,,AUTO
        26 001752   100001 635500                    EPPR5   1,,PR1
        26 001753   200115 455500                    STP5    OCCHK+9,,AUTO
        26 001754   000026 236000 27                 LDQ     22
        26 001755   200114 756100                    STQ     OCCHK+8,,AUTO
        26 001756   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 001757   000010 631400 27                 EPPR1   8
        26 001760   000000 701000 xent               TSX1    Z8AF$FORME
        26 001761   000000 011000                    NOP     0
        26 001762   002003 710000 26                 TRA     s:18143

     1064    18135    2                      IDENT$ -> LX_ETT_ITEM.ETT$,
     1065    18136    2                      REFMOD$,
     1066    18137    2                      IDENT$ -> LX_ETT_ITEM.ETT$);
     1067    18138    2   ELSE IF FISS_OFF ~= 0 THEN

  18138 26 001763   200042 235100                    LDA     FISS_OFF,,AUTO
        26 001764   002003 600000 26                 TZE     s:18143

     1068    18139    2     CALL Z8AF$NEW_FISS (IDENT$ -> LX_ETT_ITEM.ETT$,

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:220  
  18139 26 001765   200037 470500                    LDP0    @IDENT$,,AUTO
        26 001766   000000 471500                    LDP1    0,,PR0
        26 001767   100001 633500                    EPPR3   1,,PR1
        26 001770   200117 453500                    STP3    OCCHK+11,,AUTO
        26 001771   000017 236000 27                 LDQ     15
        26 001772   200116 756100                    STQ     OCCHK+10,,AUTO
        26 001773   200042 634500                    EPPR4   FISS_OFF,,AUTO
        26 001774   200115 454500                    STP4    OCCHK+9,,AUTO
        26 001775   100001 635500                    EPPR5   1,,PR1
        26 001776   200114 455500                    STP5    OCCHK+8,,AUTO
        26 001777   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002000   000010 631400 27                 EPPR1   8
        26 002001   000000 701000 xent               TSX1    Z8AF$NEW_FISS
        26 002002   000000 011000                    NOP     0

     1069    18140    2                         FISS_OFF,
     1070    18141    2                         %ALPHA_NUMERIC_FISS,
     1071    18142    2                         IDENT$ -> LX_ETT_ITEM.ETT$);
     1072    18143    2   END WRAP_UP;

  18143 26 002003   200034 221300                    LDX1  ! OP_NODE+8,,AUTO
        26 002004   000001 702211                    TSX2  ! 1,X1

     1073    18144        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:221  
     1074    18145    1   CHECK_SUB_PLACEMENT: PROC (INDEX_ST$, INDEXES$);

  18145 26 002005   200076 741300       CHECK_SUB_P* STX1  ! INT_CONST+8,,AUTO

     1075    18146
     1076    18147    2   DCL INDEX_ST$                 PTR;
     1077    18148    2   DCL INDEXES$                  PTR;
     1078    18149
     1079    18150    2   DCL LAST_DIM#                 SBIN WORD;
     1080    18151    2   DCL DIM_INDEX$                PTR;
     1081    18152    2   DCL I                         SBIN WORD;
     1082    18153
     1083    18154    2      DIM_INDEX$ = INDEXES$;

  18154 26 002006   200100 470500                    LDP0    @INDEXES$,,AUTO
        26 002007   000000 236100                    LDQ     0,,PR0
        26 002010   200102 756100                    STQ     DIM_INDEX$,,AUTO

     1084    18155    3      DO WHILE (DIM_INDEX$ ~= ADDR(NIL));

  18155 26 002011   002022 710000 26                 TRA     s:18160

     1085    18156    3        IF DIM_INDEX$ -> INDEXES.INDEX_ST$ ~= INDEX_ST$ THEN

  18156 26 002012   200102 470500                    LDP0    DIM_INDEX$,,AUTO
        26 002013   200077 471500                    LDP1    @INDEX_ST$,,AUTO
        26 002014   000001 236100                    LDQ     1,,PR0
        26 002015   100000 116100                    CMPQ    0,,PR1
        26 002016   002024 600000 26                 TZE     s:18162

     1086    18157    3          DIM_INDEX$ = DIM_INDEX$ -> INDEXES.LINK;

  18157 26 002017   000002 236100                    LDQ     2,,PR0
        26 002020   200102 756100                    STQ     DIM_INDEX$,,AUTO
        26 002021   002022 710000 26                 TRA     s:18160

     1087    18158    3        ELSE
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:222  
     1088    18159    3          EXIT;
     1089    18160    3      END; /* While */

  18160 26 002022   000003 116000 27                 CMPQ    3
        26 002023   002012 601000 26                 TNZ     s:18156

     1090    18161
     1091    18162    2      IF DIM_INDEX$ = ADDR(NIL) THEN

  18162 26 002024   200102 236100                    LDQ     DIM_INDEX$,,AUTO
        26 002025   000003 116000 27                 CMPQ    3
        26 002026   002051 601000 26                 TNZ     s:18197

     1092    18163             %CONDITIONAL_ERROR (@ERROR# = %E$SUB_IN_WRONG_ORDER,
     1093    18164                                 @LX_ITEM$ = LIST$,
     1094    18165                                 @LINE     = LIST$ -> LX_ITEM.LINE,
     1095    18166                                 @COLUMN   = LIST$ -> LX_ITEM.COLUMN);

  18176 26 002027   200011 470500                    LDP0    LIST$,,AUTO
        26 002030   000000 236100                    LDQ     0,,PR0
        26 002031   400000 316007                    CANQ    -131072,DL
        26 002032   002051 601000 26                 TNZ     s:18197

  18178 26 002033   200011 236100                    LDQ     LIST$,,AUTO
        26 002034   000006 036003                    ADLQ    6,DU
        26 002035   200116 756100                    STQ     OCCHK+10,,AUTO
        26 002036   200011 236100                    LDQ     LIST$,,AUTO
        26 002037   000005 036003                    ADLQ    5,DU
        26 002040   000030 235000 27                 LDA     24
        26 002041   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002042   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002043   000000 631400 27                 EPPR1   0
        26 002044   000000 701000 xent               TSX1    Z8AE$ERROR
        26 002045   000000 011000                    NOP     0

  18187 26 002046   200011 470500                    LDP0    LIST$,,AUTO
        26 002047   400000 236007                    LDQ     -131072,DL
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:223  
        26 002050   000000 256100                    ORSQ    0,,PR0

     1096    18196
     1097    18197    2   END CHECK_SUB_PLACEMENT;

  18197 26 002051   200076 221300                    LDX1  ! INT_CONST+8,,AUTO
        26 002052   000001 702211                    TSX2  ! 1,X1

     1098    18198        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:224  
     1099    18199    1  CONVERT_INDEX_SPAN: PROC (ARRAY_ST$, DIM#, INDEX$, INDEX_ST$, INDEXES$, RETURN_ETT$)
             18199            ;

  18199 26 002053   200052 741300       CONVERT_IND* STX1  ! @OFF,,AUTO

     1100    18200
     1101    18201    2   DCL ARRAY_ST$          PTR ;
     1102    18202    2   DCL DIM#               SBIN;
     1103    18203    2   DCL INDEX$             PTR ;
     1104    18204    2   DCL INDEX_ST$          PTR ;
     1105    18205    2   DCL INDEXES$           PTR;
     1106    18206    2   DCL RETURN_ETT$        PTR;
     1107    18207
     1108    18208    2   DCL ROPCON             SBIN WORD ;
     1109    18209    2   DCL UNITS              SBIN WORD;
     1110    18210    2   DCL SPAN$              PTR;
     1111    18211    2   DCL THREE$             PTR;
     1112    18212
     1113    18213        %DCL_AUTO_LX_ITEM (@NAME = INT_CONST);
     1114    18217
     1115    18218         /* This procedure cannot be invoked unless the subscript is an
     1116    18219            index name, possibly + or - an integer constant. In this case,
     1117    18220            if SCALAR.LTS$ is not ADDR(NIL), it points to the %ARRAY with
     1118    18221            which the index name is associated. */
     1119    18222
     1120    18223    2    IF INDEX_ST$ -> SCALAR.LTS$ ~= ADDR(NIL) THEN

  18223 26 002054   200056 470500                    LDP0    @INDEX_ST$,,AUTO
        26 002055   000000 471500                    LDP1    0,,PR0
        26 002056   100005 236100                    LDQ     5,,PR1
        26 002057   000003 116000 27                 CMPQ    3
        26 002060   002067 600000 26                 TZE     s:18226

     1121    18224    2      CALL CHECK_SUB_PLACEMENT (INDEX_ST$, INDEXES$);

  18224 26 002061   200057 236100                    LDQ     @INDEXES$,,AUTO
        26 002062   200100 756100                    STQ     @INDEXES$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:225  
        26 002063   200056 236100                    LDQ     @INDEX_ST$,,AUTO
        26 002064   200077 756100                    STQ     @INDEX_ST$,,AUTO
        26 002065   002005 701000 26                 TSX1    CHECK_SUB_PLACEMENT
        26 002066   000000 011000                    NOP     0

     1122    18225
     1123    18226    2    CALL Z8AF$FORME (%BASE,

  18226 26 002067   200056 470500                    LDP0    @INDEX_ST$,,AUTO
        26 002070   000000 471500                    LDP1    0,,PR0
        26 002071   100007 473500                    LDP3    7,,PR1
        26 002072   300002 474500                    LDP4    2,,PR3
        26 002073   400003 475500                    LDP5    3,,PR4
        26 002074   000003 236000 27                 LDQ     3
        26 002075   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002076   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002077   200121 756100                    STQ     OCCHK+13,,AUTO
        26 002100   200114 631500                    EPPR1   OCCHK+8,,AUTO
        26 002101   200120 451500                    STP1    OCCHK+12,,AUTO
        26 002102   500004 633500                    EPPR3   4,,PR5
        26 002103   200117 453500                    STP3    OCCHK+11,,AUTO
        26 002104   000006 236000 27                 LDQ     6
        26 002105   200116 756100                    STQ     OCCHK+10,,AUTO
        26 002106   200116 630500                    EPPR0   OCCHK+10,,AUTO
        26 002107   000010 631400 27                 EPPR1   8
        26 002110   000000 701000 xent               TSX1    Z8AF$FORME
        26 002111   000000 011000                    NOP     0

     1124    18227    2                     INDEX_ST$ -> SCALAR.QLT$ -> QLT.BROTHER ->
     1125    18228    2                                  QLT.SON -> QLT.ST$,
     1126    18229    2                     ADDR(NIL),
     1127    18230    2                     RETURN_ETT$);
     1128    18231
     1129    18232    2    IF INDEX_ST$ -> SCALAR.LTS$ = ADDR(NIL)

  18232 26 002112   200056 470500                    LDP0    @INDEX_ST$,,AUTO
        26 002113   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:226  
        26 002114   100005 236100                    LDQ     5,,PR1
        26 002115   000003 116000 27                 CMPQ    3
        26 002116   002123 600000 26                 TZE     s:18235
        26 002117   100005 473500                    LDP3    5,,PR1
        26 002120   300003 236100                    LDQ     3,,PR3
        26 002121   010000 316003                    CANQ    4096,DU
        26 002122   002235 601000 26                 TNZ     s:18259

     1130    18233    2        OR NOT INDEX_ST$ -> SCALAR.LTS$ -> ARRAY.B.ELEMENTARY THEN
     1131    18234    3      DO;

     1132    18235    3        CALL Z8AU$UNITS (ARRAY_ST$, UNITS);

  18235 26 002123   200062 633500                    EPPR3   UNITS,,AUTO
        26 002124   200115 453500                    STP3    OCCHK+9,,AUTO
        26 002125   200053 236100                    LDQ     @ARRAY_ST$,,AUTO
        26 002126   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002127   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002130   000031 631400 27                 EPPR1   25
        26 002131   000000 701000 xent               TSX1    Z8AU$UNITS
        26 002132   000000 011000                    NOP     0

     1133    18236
     1134    18237    4        DO CASE (UNITS);

  18237 26 002133   200062 235100                    LDA     UNITS,,AUTO
        26 002134   000007 115007                    CMPA    7,DL
        26 002135   002137 602005 26                 TNC     s:18237+4,AL
        26 002136   002231 710000 26                 TRA     s:18254
        26 002137   002231 710000 26                 TRA     s:18254
        26 002140   002146 710000 26                 TRA     s:18239
        26 002141   002146 710000 26                 TRA     s:18239
        26 002142   002174 710000 26                 TRA     s:18248
        26 002143   002235 710000 26                 TRA     s:18259
        26 002144   002235 710000 26                 TRA     s:18259
        26 002145   002161 710000 26                 TRA     s:18242

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:227  
     1135    18238    4          CASE (%ALPHA4, %NUMERIC4);

     1136    18239    4            CALL Z8AF$FORME(%MPI2, RETURN_ETT$, 1, RETURN_ETT$) ;

  18239 26 002146   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002147   000006 235000 27                 LDA     6
        26 002150   200116 757100                    STAQ    OCCHK+10,,AUTO
        26 002151   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002152   000033 235000 27                 LDA     27
        26 002153   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002154   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002155   000010 631400 27                 EPPR1   8
        26 002156   000000 701000 xent               TSX1    Z8AF$FORME
        26 002157   000000 011000                    NOP     0
        26 002160   002235 710000 26                 TRA     s:18259

     1137    18240
     1138    18241    4          CASE (%WORD_);

     1139    18242    4            CALL Z8AF$FORME(%DVI2, RETURN_ETT$, 2, RETURN_ETT$) ;

  18242 26 002161   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002162   000036 235000 27                 LDA     30
        26 002163   200116 757100                    STAQ    OCCHK+10,,AUTO
        26 002164   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002165   000037 235000 27                 LDA     31
        26 002166   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002167   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002170   000010 631400 27                 EPPR1   8
        26 002171   000000 701000 xent               TSX1    Z8AF$FORME
        26 002172   000000 011000                    NOP     0
        26 002173   002235 710000 26                 TRA     s:18259

     1140    18243
     1141    18244    4          CASE (%ALPHA9, %NUMERIC9);

     1142    18245    4            /* Peachy */;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:228  
     1143    18246
     1144    18247    4          CASE(%ALPHA6);

     1145    18248    4            MKCN.CON = 3;

  18248 26 002174   000003 236007                    LDQ     3,DL
        26 002175   000000 756000 25                 STQ     MKCN

     1146    18249    4            CALL Z8AC$MAKE_CONST(THREE$);

  18249 26 002176   200064 630500                    EPPR0   THREE$,,AUTO
        26 002177   200114 450500                    STP0    OCCHK+8,,AUTO
        26 002200   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002201   000007 631400 27                 EPPR1   7
        26 002202   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 002203   000000 011000                    NOP     0

     1147    18250    4            CALL Z8AF$FORME(%MPI, RETURN_ETT$, THREE$, RETURN_ETT$);

  18250 26 002204   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002205   200117 756100                    STQ     OCCHK+11,,AUTO
        26 002206   200064 630500                    EPPR0   THREE$,,AUTO
        26 002207   200116 450500                    STP0    OCCHK+10,,AUTO
        26 002210   000012 235000 27                 LDA     10
        26 002211   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002212   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002213   000010 631400 27                 EPPR1   8
        26 002214   000000 701000 xent               TSX1    Z8AF$FORME
        26 002215   000000 011000                    NOP     0

     1148    18251    4            CALL Z8AF$FORME(%DVI2, RETURN_ETT$, 1, RETURN_ETT$);

  18251 26 002216   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002217   000006 235000 27                 LDA     6
        26 002220   200116 757100                    STAQ    OCCHK+10,,AUTO
        26 002221   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002222   000037 235000 27                 LDA     31
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:229  
        26 002223   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002224   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002225   000010 631400 27                 EPPR1   8
        26 002226   000000 701000 xent               TSX1    Z8AF$FORME
        26 002227   000000 011000                    NOP     0
        26 002230   002235 710000 26                 TRA     s:18259

     1149    18252
     1150    18253    4          CASE(%BIT_, ELSE);

     1151    18254    4            CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  18254 26 002231   000041 630400 27                 EPPR0   33
        26 002232   000007 631400 27                 EPPR1   7
        26 002233   000000 701000 xent               TSX1    Z8AE$ERROR
        26 002234   000000 011000                    NOP     0

     1152    18255
     1153    18256    4        END ; /* Case -- type */

     1154    18257    3      END;

     1155    18258
     1156    18259    2    IF INDEX$ -> LX_ITEM.ID = %BINARY_OP THEN

  18259 26 002235   200055 470500                    LDP0    @INDEX$,,AUTO
        26 002236   000000 471500                    LDP1    0,,PR0
        26 002237   100000 220100                    LDX0    0,,PR1
        26 002240   000005 100003                    CMPX0   5,DU
        26 002241   002334 601000 26                 TNZ     s:18280

     1157    18260    3      DO; /* Possible only if SBCHK */

     1158    18261    3        CALL Z8EV$CONVERT (%TYI, INDEX$ -> BINARY_OP.ROP$, ADDR(INT_CONST));

  18261 26 002242   200066 633500                    EPPR3   INT_CONST,,AUTO
        26 002243   200114 453500                    STP3    OCCHK+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:230  
        26 002244   200114 634500                    EPPR4   OCCHK+8,,AUTO
        26 002245   200117 454500                    STP4    OCCHK+11,,AUTO
        26 002246   100002 635500                    EPPR5   2,,PR1
        26 002247   200116 455500                    STP5    OCCHK+10,,AUTO
        26 002250   000006 236000 27                 LDQ     6
        26 002251   200115 756100                    STQ     OCCHK+9,,AUTO
        26 002252   200115 630500                    EPPR0   OCCHK+9,,AUTO
        26 002253   000000 631400 27                 EPPR1   0
        26 002254   000000 701000 xent               TSX1    Z8EV$CONVERT
        26 002255   000000 011000                    NOP     0

     1159    18262    3        MKCN.CON = SPAN#;

  18262 26 002256   200016 235100                    LDA     SPAN#,,AUTO
        26 002257   000000 755000 25                 STA     MKCN

     1160    18263    3        CALL Z8AC$MAKE_CONST (SPAN$);

  18263 26 002260   200063 630500                    EPPR0   SPAN$,,AUTO
        26 002261   200114 450500                    STP0    OCCHK+8,,AUTO
        26 002262   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002263   000007 631400 27                 EPPR1   7
        26 002264   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 002265   000000 011000                    NOP     0

     1161    18264    3        CALL Z8AF$FORME (%MPI,

  18264 26 002266   200067 630500                    EPPR0   INT_CONST+1,,AUTO
        26 002267   200117 450500                    STP0    OCCHK+11,,AUTO
        26 002270   200063 631500                    EPPR1   SPAN$,,AUTO
        26 002271   200116 451500                    STP1    OCCHK+10,,AUTO
        26 002272   200067 633500                    EPPR3   INT_CONST+1,,AUTO
        26 002273   200115 453500                    STP3    OCCHK+9,,AUTO
        26 002274   000012 236000 27                 LDQ     10
        26 002275   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002276   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002277   000010 631400 27                 EPPR1   8
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:231  
        26 002300   000000 701000 xent               TSX1    Z8AF$FORME
        26 002301   000000 011000                    NOP     0

     1162    18265    3                         ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$,
     1163    18266    3                         SPAN$,
     1164    18267    3                         ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$);
     1165    18268    3        IF INDEX$ -> BINARY_OP.OP = %OP_PLUS THEN

  18268 26 002302   200055 470500                    LDP0    @INDEX$,,AUTO
        26 002303   000000 471500                    LDP1    0,,PR0
        26 002304   100003 235100                    LDA     3,,PR1
        26 002305   000020 115007                    CMPA    16,DL
        26 002306   002322 601000 26                 TNZ     s:18274

     1166    18269    3          CALL Z8AF$FORME (%ADI,

  18269 26 002307   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002310   200117 756100                    STQ     OCCHK+11,,AUTO
        26 002311   200067 631500                    EPPR1   INT_CONST+1,,AUTO
        26 002312   200116 451500                    STP1    OCCHK+10,,AUTO
        26 002313   000014 235000 27                 LDA     12
        26 002314   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002315   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002316   000010 631400 27                 EPPR1   8
        26 002317   000000 701000 xent               TSX1    Z8AF$FORME
        26 002320   000000 011000                    NOP     0
        26 002321   002334 710000 26                 TRA     s:18280

     1167    18270    3                           RETURN_ETT$,
     1168    18271    3                           ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$,
     1169    18272    3                           RETURN_ETT$);
     1170    18273    3        ELSE
     1171    18274    3          CALL Z8AF$FORME (%SBI,

  18274 26 002322   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002323   200117 756100                    STQ     OCCHK+11,,AUTO
        26 002324   200067 631500                    EPPR1   INT_CONST+1,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:232  
        26 002325   200116 451500                    STP1    OCCHK+10,,AUTO
        26 002326   000043 235000 27                 LDA     35
        26 002327   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 002330   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002331   000010 631400 27                 EPPR1   8
        26 002332   000000 701000 xent               TSX1    Z8AF$FORME
        26 002333   000000 011000                    NOP     0

     1172    18275    3                           RETURN_ETT$,
     1173    18276    3                           ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$,
     1174    18277    3                           RETURN_ETT$);
     1175    18278    3      END;

     1176    18279
     1177    18280    2    CALL INDEX_SUBCHK (DIM#, RETURN_ETT$, RETURN_ETT$);

  18280 26 002334   200060 236100                    LDQ     @RETURN_ETT$,,AUTO
        26 002335   200060 235100                    LDA     @RETURN_ETT$,,AUTO
        26 002336   200100 757100                    STAQ    @INDEXES$,,AUTO
        26 002337   200054 236100                    LDQ     @DIM#,,AUTO
        26 002340   200077 756100                    STQ     @INDEX_ST$,,AUTO
        26 002341   003052 701000 26                 TSX1    INDEX_SUBCHK
        26 002342   000000 011000                    NOP     0

     1178    18281
     1179    18282    2   END ; /* Proc -- convert_index_span */

  18282 26 002343   200052 221300                    LDX1  ! @OFF,,AUTO
        26 002344   000001 702211                    TSX2  ! 1,X1

     1180    18283
     1181    18284        %EJECT ;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:233  
     1182    18285    1   INDEX_SUBSCRIPT: PROC (NODE$, OFF, INDEXES$, NEW_ETT$);

  18285 26 002345   200034 741300       INDEX_SUBSC* STX1  ! OP_NODE+8,,AUTO

     1183    18286
     1184    18287    2   DCL NODE$                     PTR;
     1185    18288    2   DCL INDEXES$                  PTR;
     1186    18289    2   DCL OFF                       SBIN WORD;
     1187    18290    2   DCL NEW_ETT$                  PTR;
     1188    18291
     1189    18292    2   DCL INDEX_ST$                 PTR;
     1190    18293
     1191    18294        %DCL_AUTO_LX_ITEM (@NAME = INT_CONST);
     1192    18298
     1193    18299    3      DO CASE (NODE$ -> LX_ITEM.ID);

  18299 26 002346   200035 470500                    LDP0    @NODE$,,AUTO
        26 002347   000000 471500                    LDP1    0,,PR0
        26 002350   100000 236100                    LDQ     0,,PR1
        26 002351   000022 772000                    QRL     18
        26 002352   000004 136007                    SBLQ    4,DL
        26 002353   000002 116007                    CMPQ    2,DL
        26 002354   002356 602006 26                 TNC     s:18299+8,QL
        26 002355   002607 710000 26                 TRA     s:18377
        26 002356   002550 710000 26                 TRA     s:18362
        26 002357   002360 710000 26                 TRA     s:18301

     1194    18300    3        CASE(%BINARY_OP);

     1195    18301    3          IF COMCOM.OB.SUBCHK THEN

  18301 26 002360   000020 234000 xsym               SZN     COMCOM+16
        26 002361   002422 605000 26                 TPL     s:18321

     1196    18302    4            DO;

     1197    18303                   %FISH (TRIAD = NODE$ -> BINARY_OP.LOP$ -> LX_ETT_ITEM.ETT$, RTN =
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:234  
             18303                       INDEX_ST$);

  18305 26 002362   100001 473500                    LDP3    1,,PR1
        26 002363   300001 236100                    LDQ     1,,PR3
        26 002364   200041 756100                    STQ     INDEX_ST$,,AUTO

  18306 26 002365   200041 471500                    LDP1    INDEX_ST$,,AUTO
        26 002366   100000 220100                    LDX0    0,,PR1
        26 002367   000751 100003                    CMPX0   489,DU
        26 002370   002400 603000 26                 TRC     s:18311

  18307 26 002371   200041 470500                    LDP0    INDEX_ST$,,AUTO
        26 002372   000001 236100                    LDQ     1,,PR0
        26 002373   200041 756100                    STQ     INDEX_ST$,,AUTO

  18308 26 002374   200041 470500                    LDP0    INDEX_ST$,,AUTO
        26 002375   000000 220100                    LDX0    0,,PR0
        26 002376   000751 100003                    CMPX0   489,DU
        26 002377   002371 602000 26                 TNC     s:18307

     1198    18311    4              DIM# = DIM# * SPAN#;

  18311 26 002400   200015 236100                    LDQ     DIM#,,AUTO
        26 002401   200016 402100                    MPY     SPAN#,,AUTO
        26 002402   200015 756100                    STQ     DIM#,,AUTO

     1199    18312    4              CALL CONVERT_INDEX_SPAN (ARRAY_ST$,

  18312 26 002403   200040 236100                    LDQ     @NEW_ETT$,,AUTO
        26 002404   200060 756100                    STQ     @RETURN_ETT$,,AUTO
        26 002405   200037 236100                    LDQ     @INDEXES$,,AUTO
        26 002406   200057 756100                    STQ     @INDEXES$,,AUTO
        26 002407   200041 630500                    EPPR0   INDEX_ST$,,AUTO
        26 002410   200056 450500                    STP0    @INDEX_ST$,,AUTO
        26 002411   200035 236100                    LDQ     @NODE$,,AUTO
        26 002412   200055 756100                    STQ     @INDEX$,,AUTO
        26 002413   200015 631500                    EPPR1   DIM#,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:235  
        26 002414   200054 451500                    STP1    @DIM#,,AUTO
        26 002415   200005 633500                    EPPR3   ARRAY_ST$,,AUTO
        26 002416   200053 453500                    STP3    @ARRAY_ST$,,AUTO
        26 002417   002053 701000 26                 TSX1    CONVERT_INDEX_SPAN
        26 002420   000000 011000                    NOP     0

     1200    18313    4                                       DIM#,
     1201    18314    4                                       NODE$,
     1202    18315    4                                       INDEX_ST$,
     1203    18316    4                                       INDEXES$,
     1204    18317    4                                       NEW_ETT$);
     1205    18318    4            END;

  18318 26 002421   002613 710000 26                 TRA     s:18381

     1206    18319    3          ELSE
     1207    18320    4            DO;

     1208    18321    4              CALL Z8EV$CONVERT (%TYI, NODE$ -> BINARY_OP.ROP$, ADDR(INT_CONST));

  18321 26 002422   200042 633500                    EPPR3   INT_CONST,,AUTO
        26 002423   200114 453500                    STP3    OCCHK+8,,AUTO
        26 002424   200114 634500                    EPPR4   OCCHK+8,,AUTO
        26 002425   200117 454500                    STP4    OCCHK+11,,AUTO
        26 002426   100002 635500                    EPPR5   2,,PR1
        26 002427   200116 455500                    STP5    OCCHK+10,,AUTO
        26 002430   000006 236000 27                 LDQ     6
        26 002431   200115 756100                    STQ     OCCHK+9,,AUTO
        26 002432   200115 630500                    EPPR0   OCCHK+9,,AUTO
        26 002433   000000 631400 27                 EPPR1   0
        26 002434   000000 701000 xent               TSX1    Z8EV$CONVERT
        26 002435   000000 011000                    NOP     0

     1209    18322
     1210    18323    4              IF NODE$ -> BINARY_OP.OP = %OP_PLUS THEN

  18323 26 002436   200035 470500                    LDP0    @NODE$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:236  
        26 002437   000000 471500                    LDP1    0,,PR0
        26 002440   100003 235100                    LDA     3,,PR1
        26 002441   000020 115007                    CMPA    16,DL
        26 002442   002466 601000 26                 TNZ     s:18333

     1211    18324    5                DO;

     1212    18325    5                 OFF = (ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI
             18325                           .WORD1

  18325 26 002443   200043 473500                    LDP3    REFMOD$,,AUTO
        26 002444   300001 474500                    LDP4    1,,PR3
        26 002445   400010 236100                    LDQ     8,,PR4
        26 002446   200016 402100                    MPY     SPAN#,,AUTO
        26 002447   200036 475500                    LDP5    @OFF,,AUTO
        26 002450   500000 036100                    ADLQ    0,,PR5
        26 002451   500000 756100                    STQ     0,,PR5

     1213    18326    5                      * SPAN#) + OFF;
     1214    18327
     1215    18328    5                  DIM# = (DIM# * SPAN#) + (SPAN# * - (ADDR(INT_CONST) ->

  18328 26 002452   200015 236100                    LDQ     DIM#,,AUTO
        26 002453   200016 402100                    MPY     SPAN#,,AUTO
        26 002454   200043 471500                    LDP1    REFMOD$,,AUTO
        26 002455   100001 473500                    LDP3    1,,PR1
        26 002456   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002457   200016 236100                    LDQ     SPAN#,,AUTO
        26 002460   300010 402100                    MPY     8,,PR3
        26 002461   200115 756100                    STQ     OCCHK+9,,AUTO
        26 002462   200114 236100                    LDQ     OCCHK+8,,AUTO
        26 002463   200115 136100                    SBLQ    OCCHK+9,,AUTO
        26 002464   200015 756100                    STQ     DIM#,,AUTO

     1216    18329    5                         LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1));
     1217    18330    5                END;

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:237  
  18330 26 002465   002510 710000 26                 TRA     s:18342

     1218    18331    4              ELSE
     1219    18332    5                DO;

     1220    18333    5                  OFF = -(ADDR(INT_CONST) -> LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.
             18333                           CONSTI.WORD1

  18333 26 002466   200043 473500                    LDP3    REFMOD$,,AUTO
        26 002467   300001 474500                    LDP4    1,,PR3
        26 002470   400010 236100                    LDQ     8,,PR4
        26 002471   200016 402100                    MPY     SPAN#,,AUTO
        26 002472   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002473   200036 471500                    LDP1    @OFF,,AUTO
        26 002474   100000 236100                    LDQ     0,,PR1
        26 002475   200114 136100                    SBLQ    OCCHK+8,,AUTO
        26 002476   100000 756100                    STQ     0,,PR1

     1221    18334    5                      * SPAN#) + OFF;
     1222    18335
     1223    18336    5                  DIM# = (DIM# * SPAN#) + (SPAN# * (ADDR(INT_CONST) ->

  18336 26 002477   200015 236100                    LDQ     DIM#,,AUTO
        26 002500   200016 402100                    MPY     SPAN#,,AUTO
        26 002501   200043 473500                    LDP3    REFMOD$,,AUTO
        26 002502   300001 474500                    LDP4    1,,PR3
        26 002503   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002504   200016 236100                    LDQ     SPAN#,,AUTO
        26 002505   400010 402100                    MPY     8,,PR4
        26 002506   200114 036100                    ADLQ    OCCHK+8,,AUTO
        26 002507   200015 756100                    STQ     DIM#,,AUTO

     1224    18337    5                         LX_ETT_ITEM.ETT$ -> ETT.LOP -> CONST.CONSTI.WORD1));
     1225    18338    5                END;

     1226    18339
     1227    18340                   %FISH (TRIAD = NODE$ -> BINARY_OP.LOP$ -> LX_ETT_ITEM.ETT$, RTN =
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:238  
             18340                       INDEX_ST$);

  18342 26 002510   000000 471500                    LDP1    0,,PR0
        26 002511   100001 473500                    LDP3    1,,PR1
        26 002512   300001 236100                    LDQ     1,,PR3
        26 002513   200041 756100                    STQ     INDEX_ST$,,AUTO

  18343 26 002514   200041 471500                    LDP1    INDEX_ST$,,AUTO
        26 002515   100000 220100                    LDX0    0,,PR1
        26 002516   000751 100003                    CMPX0   489,DU
        26 002517   002527 603000 26                 TRC     s:18350

  18344 26 002520   200041 470500                    LDP0    INDEX_ST$,,AUTO
        26 002521   000001 236100                    LDQ     1,,PR0
        26 002522   200041 756100                    STQ     INDEX_ST$,,AUTO

  18345 26 002523   200041 470500                    LDP0    INDEX_ST$,,AUTO
        26 002524   000000 220100                    LDX0    0,,PR0
        26 002525   000751 100003                    CMPX0   489,DU
        26 002526   002520 602000 26                 TNC     s:18344

     1228    18348
     1229    18349
     1230    18350    4              CALL CONVERT_INDEX_SPAN (ARRAY_ST$,

  18350 26 002527   200035 470500                    LDP0    @NODE$,,AUTO
        26 002530   000000 471500                    LDP1    0,,PR0
        26 002531   200040 236100                    LDQ     @NEW_ETT$,,AUTO
        26 002532   200060 756100                    STQ     @RETURN_ETT$,,AUTO
        26 002533   200037 236100                    LDQ     @INDEXES$,,AUTO
        26 002534   200057 756100                    STQ     @INDEXES$,,AUTO
        26 002535   200041 633500                    EPPR3   INDEX_ST$,,AUTO
        26 002536   200056 453500                    STP3    @INDEX_ST$,,AUTO
        26 002537   100001 634500                    EPPR4   1,,PR1
        26 002540   200055 454500                    STP4    @INDEX$,,AUTO
        26 002541   200015 631500                    EPPR1   DIM#,,AUTO
        26 002542   200054 451500                    STP1    @DIM#,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:239  
        26 002543   200005 635500                    EPPR5   ARRAY_ST$,,AUTO
        26 002544   200053 455500                    STP5    @ARRAY_ST$,,AUTO
        26 002545   002053 701000 26                 TSX1    CONVERT_INDEX_SPAN
        26 002546   000000 011000                    NOP     0

     1231    18351    4                                       DIM#,
     1232    18352    4                                       NODE$ -> BINARY_OP.LOP$,
     1233    18353    4                                       INDEX_ST$,
     1234    18354    4                                       INDEXES$,
     1235    18355    4                                       NEW_ETT$);
     1236    18356    4            END;

  18356 26 002547   002613 710000 26                 TRA     s:18381

     1237    18357
     1238    18358    3        CASE (%LX_ETT_ITEM);

     1239    18359
     1240    18360               %FISH (TRIAD = NODE$ -> LX_ETT_ITEM.ETT$, RTN = INDEX_ST$);

  18362 26 002550   100001 236100                    LDQ     1,,PR1
        26 002551   200041 756100                    STQ     INDEX_ST$,,AUTO

  18363 26 002552   200041 471500                    LDP1    INDEX_ST$,,AUTO
        26 002553   100000 220100                    LDX0    0,,PR1
        26 002554   000751 100003                    CMPX0   489,DU
        26 002555   002565 603000 26                 TRC     s:18369

  18364 26 002556   200041 470500                    LDP0    INDEX_ST$,,AUTO
        26 002557   000001 236100                    LDQ     1,,PR0
        26 002560   200041 756100                    STQ     INDEX_ST$,,AUTO

  18365 26 002561   200041 470500                    LDP0    INDEX_ST$,,AUTO
        26 002562   000000 220100                    LDX0    0,,PR0
        26 002563   000751 100003                    CMPX0   489,DU
        26 002564   002556 602000 26                 TNC     s:18364

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:240  
     1241    18368
     1242    18369    3          CALL CONVERT_INDEX_SPAN (ARRAY_ST$,

  18369 26 002565   200015 236100                    LDQ     DIM#,,AUTO
        26 002566   200016 402100                    MPY     SPAN#,,AUTO
        26 002567   200122 756100                    STQ     OCCHK+14,,AUTO
        26 002570   200040 236100                    LDQ     @NEW_ETT$,,AUTO
        26 002571   200060 756100                    STQ     @RETURN_ETT$,,AUTO
        26 002572   200037 236100                    LDQ     @INDEXES$,,AUTO
        26 002573   200057 756100                    STQ     @INDEXES$,,AUTO
        26 002574   200041 630500                    EPPR0   INDEX_ST$,,AUTO
        26 002575   200056 450500                    STP0    @INDEX_ST$,,AUTO
        26 002576   200035 236100                    LDQ     @NODE$,,AUTO
        26 002577   200055 756100                    STQ     @INDEX$,,AUTO
        26 002600   200122 631500                    EPPR1   OCCHK+14,,AUTO
        26 002601   200054 451500                    STP1    @DIM#,,AUTO
        26 002602   200005 633500                    EPPR3   ARRAY_ST$,,AUTO
        26 002603   200053 453500                    STP3    @ARRAY_ST$,,AUTO
        26 002604   002053 701000 26                 TSX1    CONVERT_INDEX_SPAN
        26 002605   000000 011000                    NOP     0
        26 002606   002613 710000 26                 TRA     s:18381

     1243    18370    3                                   DIM# * SPAN#,
     1244    18371    3                                   NODE$,
     1245    18372    3                                   INDEX_ST$,
     1246    18373    3                                   INDEXES$,
     1247    18374    3                                   NEW_ETT$);
     1248    18375
     1249    18376    3        CASE (ELSE);

     1250    18377    3          CALL Z8AE$ERROR (%E$UNEXPECTED_CASE);

  18377 26 002607   000041 630400 27                 EPPR0   33
        26 002610   000007 631400 27                 EPPR1   7
        26 002611   000000 701000 xent               TSX1    Z8AE$ERROR
        26 002612   000000 011000                    NOP     0

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:241  
     1251    18378
     1252    18379    3      END;

     1253    18380
     1254    18381    2   END INDEX_SUBSCRIPT;

  18381 26 002613   200034 221300                    LDX1  ! OP_NODE+8,,AUTO
        26 002614   000001 702211                    TSX2  ! 1,X1

     1255    18382        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:242  
     1256    18383    1   CHECK_ARRAY_AND_#_SUBS: PROC (ARRAY$, SUB_LIST$, ARRAY_ST$, DIMS$);

  18383 26 002615   200034 741300       CHECK_ARRAY* STX1  ! OP_NODE+8,,AUTO

     1257    18384
     1258    18385    2   DCL ARRAY$                    PTR;
     1259    18386    2   DCL SUB_LIST$                 PTR;
     1260    18387    2   DCL ARRAY_ST$                 PTR;
     1261    18388    2   DCL DIMS$                     PTR;
     1262    18389    2   DCL NO_DIMS                   SBIN WORD;
     1263    18390
     1264    18391           %FISH (TRIAD = ARRAY$ -> LX_ETT_ITEM.ETT$,
     1265    18392                  RTN   = ARRAY_ST$);

  18394 26 002616   200035 470500                    LDP0    @ARRAY$,,AUTO
        26 002617   000000 471500                    LDP1    0,,PR0
        26 002620   100001 236100                    LDQ     1,,PR1
        26 002621   200037 473500                    LDP3    @ARRAY_ST$,,AUTO
        26 002622   300000 756100                    STQ     0,,PR3

  18395 26 002623   300000 471500                    LDP1    0,,PR3
        26 002624   100000 220100                    LDX0    0,,PR1
        26 002625   000751 100003                    CMPX0   489,DU
        26 002626   002637 603000 26                 TRC     s:18401

  18396 26 002627   200037 470500                    LDP0    @ARRAY_ST$,,AUTO
        26 002630   000000 471500                    LDP1    0,,PR0
        26 002631   100001 236100                    LDQ     1,,PR1
        26 002632   000000 756100                    STQ     0,,PR0

  18397 26 002633   000000 471500                    LDP1    0,,PR0
        26 002634   100000 220100                    LDX0    0,,PR1
        26 002635   000751 100003                    CMPX0   489,DU
        26 002636   002627 602000 26                 TNC     s:18396

     1266    18400
     1267    18401    2      IF ARRAY_ST$ -> ARRAY.TYPE = %TYY THEN
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:243  

  18401 26 002637   200037 470500                    LDP0    @ARRAY_ST$,,AUTO
        26 002640   000000 471500                    LDP1    0,,PR0
        26 002641   100002 220100                    LDX0    2,,PR1
        26 002642   000012 100003                    CMPX0   10,DU
        26 002643   002677 601000 26                 TNZ     s:18412

     1268    18402    3        DO;

     1269    18403               /* The array is IBM index, we only want the occurrence number */
     1270    18404    3          ARRAY_ST$ = ARRAY_ST$ -> SCALAR.QLT$ -> QLT.BROTHER ->

  18404 26 002644   100007 473500                    LDP3    7,,PR1
        26 002645   300002 474500                    LDP4    2,,PR3
        26 002646   400003 475500                    LDP5    3,,PR4
        26 002647   500002 476500                    LDP6    2,,PR5
        26 002650   600004 236100                    LDQ     4,,PR6
        26 002651   000000 756100                    STQ     0,,PR0

     1271    18405    3                      QLT.SON -> QLT.BROTHER -> QLT.ST$;
     1272    18406
     1273    18407    3          CALL Z8AF$NEW_BASE (ARRAY_ST$, ADDR(NIL), ARRAY$ -> LX_ETT_ITEM.ETT$);

  18407 26 002652   200035 471500                    LDP1    @ARRAY$,,AUTO
        26 002653   100000 473500                    LDP3    0,,PR1
        26 002654   000003 236000 27                 LDQ     3
        26 002655   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002656   300001 634500                    EPPR4   1,,PR3
        26 002657   200117 454500                    STP4    OCCHK+11,,AUTO
        26 002660   200114 633500                    EPPR3   OCCHK+8,,AUTO
        26 002661   200116 453500                    STP3    OCCHK+10,,AUTO
        26 002662   200037 236100                    LDQ     @ARRAY_ST$,,AUTO
        26 002663   200115 756100                    STQ     OCCHK+9,,AUTO
        26 002664   200115 630500                    EPPR0   OCCHK+9,,AUTO
        26 002665   000000 631400 27                 EPPR1   0
        26 002666   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        26 002667   000000 011000                    NOP     0
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:244  

     1274    18408
     1275    18409    3          ARRAY$ -> LX_ETT_ITEM.TYPE = ARRAY_ST$ -> ST.TYPE;

  18409 26 002670   200035 470500                    LDP0    @ARRAY$,,AUTO
        26 002671   000000 471500                    LDP1    0,,PR0
        26 002672   200037 473500                    LDP3    @ARRAY_ST$,,AUTO
        26 002673   300000 474500                    LDP4    0,,PR3
        26 002674   400002 236100                    LDQ     2,,PR4
        26 002675   000022 772000                    QRL     18
        26 002676   100004 756100                    STQ     4,,PR1

     1276    18410    3        END;

     1277    18411
     1278    18412    2      IF ARRAY_ST$ -> ARRAY.ID ~= %ARRAY THEN

  18412 26 002677   200037 470500                    LDP0    @ARRAY_ST$,,AUTO
        26 002700   000000 471500                    LDP1    0,,PR0
        26 002701   100000 220100                    LDX0    0,,PR1
        26 002702   000765 100003                    CMPX0   501,DU
        26 002703   002743 600000 26                 TZE     s:18458

     1279    18413    3        DO;

     1280    18414    3          IF ARRAY_ST$ -> VARIABLE.B.COMPILER_CREATED THEN

  18414 26 002704   100003 236100                    LDQ     3,,PR1
        26 002705   100000 316003                    CANQ    32768,DU
        26 002706   002714 600000 26                 TZE     s:18431

     1281    18415    3            ARRAY$ -> LX_ETT_ITEM.B.ERROR = TRUE;

  18415 26 002707   200035 473500                    LDP3    @ARRAY$,,AUTO
        26 002710   300000 474500                    LDP4    0,,PR3
        26 002711   400000 236007                    LDQ     -131072,DL
        26 002712   400000 256100                    ORSQ    0,,PR4
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:245  
        26 002713   002741 710000 26                 TRA     s:18451

     1282    18416    3          ELSE
     1283    18417                 %CONDITIONAL_ERROR (@LX_ITEM$ = ARRAY$,
     1284    18418                                     @ERROR#   = %E$USING_SCALAR_W_SUBSCRIPT,
     1285    18419                                     @PLUG1    = ARRAY_ST$ -> ARRAY.DNT$,
     1286    18420                                     @LINE     = ARRAY$ -> LX_ETT_ITEM.LINE,
     1287    18421                                     @COLUMN   = ARRAY$ -> LX_ETT_ITEM.COLUMN);

  18431 26 002714   200035 473500                    LDP3    @ARRAY$,,AUTO
        26 002715   300000 474500                    LDP4    0,,PR3
        26 002716   400000 236100                    LDQ     0,,PR4
        26 002717   400000 316007                    CANQ    -131072,DL
        26 002720   002741 601000 26                 TNZ     s:18451

  18433 26 002721   100006 635500                    EPPR5   6,,PR1
        26 002722   200117 455500                    STP5    OCCHK+11,,AUTO
        26 002723   400006 631500                    EPPR1   6,,PR4
        26 002724   200116 451500                    STP1    OCCHK+10,,AUTO
        26 002725   400005 636500                    EPPR6   5,,PR4
        26 002726   200115 456500                    STP6    OCCHK+9,,AUTO
        26 002727   000045 236000 27                 LDQ     37
        26 002730   200114 756100                    STQ     OCCHK+8,,AUTO
        26 002731   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 002732   000010 631400 27                 EPPR1   8
        26 002733   000000 701000 xent               TSX1    Z8AE$ERROR
        26 002734   000000 011000                    NOP     0

  18442 26 002735   200035 470500                    LDP0    @ARRAY$,,AUTO
        26 002736   000000 471500                    LDP1    0,,PR0
        26 002737   400000 236007                    LDQ     -131072,DL
        26 002740   100000 256100                    ORSQ    0,,PR1

     1288    18451    3          RETURN;

  18451 26 002741   200034 221300                    LDX1  ! OP_NODE+8,,AUTO
        26 002742   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:246  

     1289    18452    3        END;
     1290    18453
     1291    18454           %GET_LTS (@ID     = %DIMS,
     1292    18455                     @ST$    = ARRAY_ST$,
     1293    18456                     @RETURN$ = DIMS$);

  18458 26 002743   100005 236100                    LDQ     5,,PR1
        26 002744   000003 116000 27                 CMPQ    3
        26 002745   002756 600000 26                 TZE     s:18492
        26 002746   100005 473500                    LDP3    5,,PR1
        26 002747   300000 221100                    LDX1    0,,PR3
        26 002750   001105 101003                    CMPX1   581,DU
        26 002751   002756 601000 26                 TNZ     s:18492

  18462 26 002752   300001 236100                    LDQ     1,,PR3
        26 002753   200040 474500                    LDP4    @DIMS$,,AUTO
        26 002754   400000 756100                    STQ     0,,PR4

  18490 26 002755   002772 710000 26                 TRA     s:18503

  18492 26 002756   000003 116000 27                 CMPQ    3
        26 002757   002767 600000 26                 TZE     s:18496
        26 002760   100005 473500                    LDP3    5,,PR1
        26 002761   300000 221100                    LDX1    0,,PR3
        26 002762   001104 101003                    CMPX1   580,DU
        26 002763   002767 601000 26                 TNZ     s:18496

  18494 26 002764   200040 474500                    LDP4    @DIMS$,,AUTO
        26 002765   400000 756100                    STQ     0,,PR4
        26 002766   002772 710000 26                 TRA     s:18503

  18496 26 002767   000003 236000 27                 LDQ     3
        26 002770   200040 473500                    LDP3    @DIMS$,,AUTO
        26 002771   300000 756100                    STQ     0,,PR3

     1294    18499
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:247  
     1295    18500           %FIND_LAST_DIM (POINTER = DIMS$,
     1296    18501                           VARIABLE= NO_DIMS);

  18503 26 002772   200040 471500                    LDP1    @DIMS$,,AUTO
        26 002773   100000 473500                    LDP3    0,,PR1
        26 002774   300000 236100                    LDQ     0,,PR3
        26 002775   777777 376007                    ANQ     -1,DL
        26 002776   000005 136007                    SBLQ    5,DL
        26 002777   000003 506007                    DIV     3,DL
        26 003000   200041 756100                    STQ     NO_DIMS,,AUTO

     1297    18506
     1298    18507    2      IF SUB_LIST$ -> LX_LIST.COUNT ~= NO_DIMS THEN

  18507 26 003001   200036 474500                    LDP4    @SUB_LIST$,,AUTO
        26 003002   400000 475500                    LDP5    0,,PR4
        26 003003   500002 116100                    CMPQ    2,,PR5
        26 003004   003031 600000 26                 TZE     s:18541

     1299    18508             %CONDITIONAL_ERROR (@LX_ITEM$ = ARRAY$,
     1300    18509                                 @ERROR#   = %E$WRONG_#_OF_SUBS,
     1301    18510                                 @LINE     = ARRAY$ -> LX_ETT_ITEM.LINE,
     1302    18511                                 @COLUMN   = ARRAY$ -> LX_ETT_ITEM.COLUMN);

  18521 26 003005   200035 476500                    LDP6    @ARRAY$,,AUTO
        26 003006   600000 477500                    LDP7    0,,PR6
        26 003007   700000 236100                    LDQ     0,,PR7
        26 003010   400000 316007                    CANQ    -131072,DL
        26 003011   003050 601000 26                 TNZ     s:18545

  18523 26 003012   700006 630500                    EPPR0   6,,PR7
        26 003013   200116 450500                    STP0    OCCHK+10,,AUTO
        26 003014   700005 633500                    EPPR3   5,,PR7
        26 003015   200115 453500                    STP3    OCCHK+9,,AUTO
        26 003016   000047 236000 27                 LDQ     39
        26 003017   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003020   200114 630500                    EPPR0   OCCHK+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:248  
        26 003021   000000 631400 27                 EPPR1   0
        26 003022   000000 701000 xent               TSX1    Z8AE$ERROR
        26 003023   000000 011000                    NOP     0

  18532 26 003024   200035 470500                    LDP0    @ARRAY$,,AUTO
        26 003025   000000 471500                    LDP1    0,,PR0
        26 003026   400000 236007                    LDQ     -131072,DL
        26 003027   100000 256100                    ORSQ    0,,PR1

  18539 26 003030   003050 710000 26                 TRA     s:18545

     1303    18541    2      ELSE IF COMCOM.OB.FIPS.LEVEL = %HIGH_LEV AND SUB_LIST$ -> LX_LIST.COUNT > 7

  18541 26 003031   000036 720000 xsym               LXL0    COMCOM+30
        26 003032   000001 100003                    CMPX0   1,DU
        26 003033   003037 601000 26                 TNZ     s:18541+6
        26 003034   500002 235100                    LDA     2,,PR5
        26 003035   000007 115007                    CMPA    7,DL
        26 003036   003044 605400 26                 TPNZ    s:18543
        26 003037   000001 100003                    CMPX0   1,DU
        26 003040   003050 604400 26                 TMOZ    s:18545
        26 003041   500002 235100                    LDA     2,,PR5
        26 003042   000003 115007                    CMPA    3,DL
        26 003043   003050 604400 26                 TMOZ    s:18545

     1304    18542    2          OR COMCOM.OB.FIPS.LEVEL > %HIGH_LEV AND SUB_LIST$ -> LX_LIST.COUNT > 3 THEN
     1305    18543    2        ARRAY$ -> LX_ETT_ITEM.B.HIGH_LEV = TRUE;

  18543 26 003044   200035 476500                    LDP6    @ARRAY$,,AUTO
        26 003045   600000 477500                    LDP7    0,,PR6
        26 003046   004000 236007                    LDQ     2048,DL
        26 003047   700000 256100                    ORSQ    0,,PR7

     1306    18544
     1307    18545    2   END CHECK_ARRAY_AND_#_SUBS;

  18545 26 003050   200034 221300                    LDX1  ! OP_NODE+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:249  
        26 003051   000001 702211                    TSX2  ! 1,X1

     1308    18546        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:250  
     1309    18547    1   INDEX_SUBCHK: PROC (DIM#, SUB$, OUT$);

  18547 26 003052   200076 741300       INDEX_SUBCHK STX1  ! INT_CONST+8,,AUTO

     1310    18548
     1311    18549    2   DCL DIM#               SBIN WORD;
     1312    18550    2   DCL SUB$               PTR;
     1313    18551    2   DCL OUT$               PTR;
     1314    18552
     1315    18553    2   DCL DIM$               PTR;
     1316    18554    2   DCL SPAN$              PTR;
     1317    18555
     1318    18556        %DCL_AUTO_LX_ITEM      (@NAME = OCCHK);
     1319    18560
     1320    18561    2      IF COMCOM.OB.SUBCHK THEN

  18561 26 003053   000020 234000 xsym               SZN     COMCOM+16
        26 003054   003225 605000 26                 TPL     s:18617

     1321    18562    2        IF SUB$ -> ETT.ID ~= %TRIAD THEN

  18562 26 003055   200100 470500                    LDP0    @SUB$,,AUTO
        26 003056   000000 471500                    LDP1    0,,PR0
        26 003057   100000 220100                    LDX0    0,,PR1
        26 003060   000015 100003                    CMPX0   13,DU
        26 003061   003225 600000 26                 TZE     s:18617

     1322    18563    3          DO;

     1323    18564    3            MKCN.CON  = DIM#;

  18564 26 003062   200077 473500                    LDP3    @DIM#,,AUTO
        26 003063   300000 235100                    LDA     0,,PR3
        26 003064   000000 755000 25                 STA     MKCN

     1324    18565    3            CALL Z8AC$MAKE_CONST (DIM$);

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:251  
  18565 26 003065   200102 631500                    EPPR1   DIM$,,AUTO
        26 003066   200114 451500                    STP1    OCCHK+8,,AUTO
        26 003067   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003070   000007 631400 27                 EPPR1   7
        26 003071   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 003072   000000 011000                    NOP     0

     1325    18566
     1326    18567    3            IF GLOBAL_DIMS$ -> DIMS.DN2 ~= ADDR(NIL) THEN

  18567 26 003073   200006 470500                    LDP0    GLOBAL_DIMS$,,AUTO
        26 003074   000001 236100                    LDQ     1,,PR0
        26 003075   000003 116000 27                 CMPQ    3
        26 003076   003212 600000 26                 TZE     s:18614

     1327    18568    4              DO;

     1328    18569
     1329    18570                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(OCCHK)",
     1330    18571                                        @ETT$    = GLOBAL_DIMS$ -> DIMS.DN2,
     1331    18572                                        @TYPE    = GLOBAL_DIMS$ -> DIMS.DN2 -> ST.TYPE);

  18574 26 003077   000004 220003                    LDX0    4,DU
        26 003100   200104 740100                    STX0    OCCHK,,AUTO

  18575 26 003101   000000 221003                    LDX1    0,DU
        26 003102   200104 441100                    SXL1    OCCHK,,AUTO

  18576 26 003103   000001 471500                    LDP1    1,,PR0
        26 003104   100002 236100                    LDQ     2,,PR1
        26 003105   000022 772000                    QRL     18
        26 003106   200110 756100                    STQ     OCCHK+4,,AUTO

  18577 26 003107   000003 236000 27                 LDQ     3
        26 003110   200113 756100                    STQ     OCCHK+7,,AUTO

  18578 26 003111   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:252  
        26 003112   200105 756100                    STQ     OCCHK+1,,AUTO

  18579 26 003113   000003 236000 27                 LDQ     3
        26 003114   200106 756100                    STQ     OCCHK+2,,AUTO

  18581 26 003115   000133 235000 xsym               LDA     COMCOM+91
        26 003116   200111 755100                    STA     OCCHK+5,,AUTO

  18582 26 003117   000134 235000 xsym               LDA     COMCOM+92
        26 003120   200112 755100                    STA     OCCHK+6,,AUTO

     1332    18594
     1333    18595    4                CALL Z8AF$NEW_BASE (ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,

  18595 26 003121   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003122   200105 631500                    EPPR1   OCCHK+1,,AUTO
        26 003123   200117 451500                    STP1    OCCHK+11,,AUTO
        26 003124   200114 633500                    EPPR3   OCCHK+8,,AUTO
        26 003125   200116 453500                    STP3    OCCHK+10,,AUTO
        26 003126   200105 634500                    EPPR4   OCCHK+1,,AUTO
        26 003127   200115 454500                    STP4    OCCHK+9,,AUTO
        26 003130   200115 630500                    EPPR0   OCCHK+9,,AUTO
        26 003131   000000 631400 27                 EPPR1   0
        26 003132   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        26 003133   000000 011000                    NOP     0

     1334    18596    4                                    ADDR(NIL),
     1335    18597    4                                    ADDR(OCCHK) -> LX_ETT_ITEM.ETT$);
     1336    18598
     1337    18599    4                CALL Z8EV$CONVERT (%TYI, ADDR(OCCHK), ADDR(OCCHK));

  18599 26 003134   200104 630500                    EPPR0   OCCHK,,AUTO
        26 003135   200114 450500                    STP0    OCCHK+8,,AUTO
        26 003136   200104 631500                    EPPR1   OCCHK,,AUTO
        26 003137   200115 451500                    STP1    OCCHK+9,,AUTO
        26 003140   200115 633500                    EPPR3   OCCHK+9,,AUTO
        26 003141   200120 453500                    STP3    OCCHK+12,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:253  
        26 003142   200114 634500                    EPPR4   OCCHK+8,,AUTO
        26 003143   200117 454500                    STP4    OCCHK+11,,AUTO
        26 003144   000006 236000 27                 LDQ     6
        26 003145   200116 756100                    STQ     OCCHK+10,,AUTO
        26 003146   200116 630500                    EPPR0   OCCHK+10,,AUTO
        26 003147   000000 631400 27                 EPPR1   0
        26 003150   000000 701000 xent               TSX1    Z8EV$CONVERT
        26 003151   000000 011000                    NOP     0

     1338    18600
     1339    18601    4                MKCN.CON = SPAN#;

  18601 26 003152   200016 235100                    LDA     SPAN#,,AUTO
        26 003153   000000 755000 25                 STA     MKCN

     1340    18602    4                CALL Z8AC$MAKE_CONST (SPAN$);

  18602 26 003154   200103 630500                    EPPR0   SPAN$,,AUTO
        26 003155   200114 450500                    STP0    OCCHK+8,,AUTO
        26 003156   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003157   000007 631400 27                 EPPR1   7
        26 003160   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 003161   000000 011000                    NOP     0

     1341    18603
     1342    18604
     1343    18605    4                CALL Z8AF$FORME (%MPI,

  18605 26 003162   200105 630500                    EPPR0   OCCHK+1,,AUTO
        26 003163   200117 450500                    STP0    OCCHK+11,,AUTO
        26 003164   200103 631500                    EPPR1   SPAN$,,AUTO
        26 003165   200116 451500                    STP1    OCCHK+10,,AUTO
        26 003166   200105 633500                    EPPR3   OCCHK+1,,AUTO
        26 003167   200115 453500                    STP3    OCCHK+9,,AUTO
        26 003170   000012 236000 27                 LDQ     10
        26 003171   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003172   200114 630500                    EPPR0   OCCHK+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:254  
        26 003173   000010 631400 27                 EPPR1   8
        26 003174   000000 701000 xent               TSX1    Z8AF$FORME
        26 003175   000000 011000                    NOP     0

     1344    18606    4                                 ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,
     1345    18607    4                                 SPAN$,
     1346    18608    4                                 ADDR(OCCHK) -> LX_ETT_ITEM.ETT$);
     1347    18609
     1348    18610    4                CALL Z8AF$FORME (%OCCHK, ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,

  18610 26 003176   200102 630500                    EPPR0   DIM$,,AUTO
        26 003177   200117 450500                    STP0    OCCHK+11,,AUTO
        26 003200   200102 631500                    EPPR1   DIM$,,AUTO
        26 003201   200116 451500                    STP1    OCCHK+10,,AUTO
        26 003202   200105 633500                    EPPR3   OCCHK+1,,AUTO
        26 003203   200115 453500                    STP3    OCCHK+9,,AUTO
        26 003204   000051 236000 27                 LDQ     41
        26 003205   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003206   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003207   000010 631400 27                 EPPR1   8
        26 003210   000000 701000 xent               TSX1    Z8AF$FORME
        26 003211   000000 011000                    NOP     0

     1349    18611    4                                 DIM$, DIM$);
     1350    18612    4              END;

     1351    18613
     1352    18614    3            CALL Z8AF$FORME (%SBCHK, SUB$, DIM$, OUT$);

  18614 26 003212   200101 236100                    LDQ     @OUT$,,AUTO
        26 003213   200117 756100                    STQ     OCCHK+11,,AUTO
        26 003214   200102 630500                    EPPR0   DIM$,,AUTO
        26 003215   200116 450500                    STP0    OCCHK+10,,AUTO
        26 003216   200100 236100                    LDQ     @SUB$,,AUTO
        26 003217   000053 235000 27                 LDA     43
        26 003220   200114 757100                    STAQ    OCCHK+8,,AUTO
        26 003221   200114 630500                    EPPR0   OCCHK+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:255  
        26 003222   000010 631400 27                 EPPR1   8
        26 003223   000000 701000 xent               TSX1    Z8AF$FORME
        26 003224   000000 011000                    NOP     0

     1353    18615    3          END;

     1354    18616
     1355    18617    2   END INDEX_SUBCHK;

  18617 26 003225   200076 221300                    LDX1  ! INT_CONST+8,,AUTO
        26 003226   000001 702211                    TSX2  ! 1,X1

     1356    18618        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:256  
     1357    18619    1   SUBCHK: PROC (DIM#, SUB$, OUT$);

  18619 26 003227   200056 741300       SUBCHK       STX1  ! @INDEX_ST$,,AUTO

     1358    18620
     1359    18621    2   DCL DIM#               SBIN WORD;
     1360    18622    2   DCL SUB$               PTR;
     1361    18623    2   DCL OUT$               PTR;
     1362    18624
     1363    18625    2   DCL DIM$               PTR;
     1364    18626
     1365    18627        %DCL_AUTO_LX_ITEM      (@NAME = OCCHK);
     1366    18631
     1367    18632    2      IF COMCOM.OB.SUBCHK THEN

  18632 26 003230   000020 234000 xsym               SZN     COMCOM+16
        26 003231   003356 605000 26                 TPL     s:18679

     1368    18633    2        IF SUB$ -> ETT.ID ~= %TRIAD THEN

  18633 26 003232   200060 470500                    LDP0    @SUB$,,AUTO
        26 003233   000000 471500                    LDP1    0,,PR0
        26 003234   100000 220100                    LDX0    0,,PR1
        26 003235   000015 100003                    CMPX0   13,DU
        26 003236   003356 600000 26                 TZE     s:18679

     1369    18634    3          DO;

     1370    18635    3            MKCN.CON  = DIM#;

  18635 26 003237   200057 473500                    LDP3    @DIM#,,AUTO
        26 003240   300000 235100                    LDA     0,,PR3
        26 003241   000000 755000 25                 STA     MKCN

     1371    18636    3            CALL Z8AC$MAKE_CONST (DIM$);

  18636 26 003242   200062 631500                    EPPR1   DIM$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:257  
        26 003243   200114 451500                    STP1    OCCHK+8,,AUTO
        26 003244   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003245   000007 631400 27                 EPPR1   7
        26 003246   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        26 003247   000000 011000                    NOP     0

     1372    18637
     1373    18638    3            IF GLOBAL_DIMS$ -> DIMS.DN2 ~= ADDR(NIL) THEN

  18638 26 003250   200006 470500                    LDP0    GLOBAL_DIMS$,,AUTO
        26 003251   000001 236100                    LDQ     1,,PR0
        26 003252   000003 116000 27                 CMPQ    3
        26 003253   003343 600000 26                 TZE     s:18676

     1374    18639    4              DO;

     1375    18640
     1376    18641                     %INIT_LX_ETT_ITEM (@POINTER = "ADDR(OCCHK)",
     1377    18642                                        @ETT$    = GLOBAL_DIMS$ -> DIMS.DN2,
     1378    18643                                        @TYPE    = GLOBAL_DIMS$ -> DIMS.DN2 -> ST.TYPE);

  18645 26 003254   000004 220003                    LDX0    4,DU
        26 003255   200064 740100                    STX0    OCCHK,,AUTO

  18646 26 003256   000000 221003                    LDX1    0,DU
        26 003257   200064 441100                    SXL1    OCCHK,,AUTO

  18647 26 003260   000001 471500                    LDP1    1,,PR0
        26 003261   100002 236100                    LDQ     2,,PR1
        26 003262   000022 772000                    QRL     18
        26 003263   200070 756100                    STQ     INT_CONST+2,,AUTO

  18648 26 003264   000003 236000 27                 LDQ     3
        26 003265   200073 756100                    STQ     INT_CONST+5,,AUTO

  18649 26 003266   000001 236100                    LDQ     1,,PR0
        26 003267   200065 756100                    STQ     OCCHK+1,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:258  

  18650 26 003270   000003 236000 27                 LDQ     3
        26 003271   200066 756100                    STQ     INT_CONST,,AUTO

  18652 26 003272   000133 235000 xsym               LDA     COMCOM+91
        26 003273   200071 755100                    STA     INT_CONST+3,,AUTO

  18653 26 003274   000134 235000 xsym               LDA     COMCOM+92
        26 003275   200072 755100                    STA     INT_CONST+4,,AUTO

     1379    18665
     1380    18666    4                CALL Z8AF$NEW_BASE (ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,

  18666 26 003276   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003277   200065 631500                    EPPR1   OCCHK+1,,AUTO
        26 003300   200117 451500                    STP1    OCCHK+11,,AUTO
        26 003301   200114 633500                    EPPR3   OCCHK+8,,AUTO
        26 003302   200116 453500                    STP3    OCCHK+10,,AUTO
        26 003303   200065 634500                    EPPR4   OCCHK+1,,AUTO
        26 003304   200115 454500                    STP4    OCCHK+9,,AUTO
        26 003305   200115 630500                    EPPR0   OCCHK+9,,AUTO
        26 003306   000000 631400 27                 EPPR1   0
        26 003307   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        26 003310   000000 011000                    NOP     0

     1381    18667    4                                    ADDR(NIL),
     1382    18668    4                                    ADDR(OCCHK) -> LX_ETT_ITEM.ETT$);
     1383    18669
     1384    18670    4                CALL Z8EV$CONVERT (%TYI, ADDR(OCCHK), ADDR(OCCHK));

  18670 26 003311   200064 630500                    EPPR0   OCCHK,,AUTO
        26 003312   200114 450500                    STP0    OCCHK+8,,AUTO
        26 003313   200064 631500                    EPPR1   OCCHK,,AUTO
        26 003314   200115 451500                    STP1    OCCHK+9,,AUTO
        26 003315   200115 633500                    EPPR3   OCCHK+9,,AUTO
        26 003316   200120 453500                    STP3    OCCHK+12,,AUTO
        26 003317   200114 634500                    EPPR4   OCCHK+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:259  
        26 003320   200117 454500                    STP4    OCCHK+11,,AUTO
        26 003321   000006 236000 27                 LDQ     6
        26 003322   200116 756100                    STQ     OCCHK+10,,AUTO
        26 003323   200116 630500                    EPPR0   OCCHK+10,,AUTO
        26 003324   000000 631400 27                 EPPR1   0
        26 003325   000000 701000 xent               TSX1    Z8EV$CONVERT
        26 003326   000000 011000                    NOP     0

     1385    18671
     1386    18672    4                CALL Z8AF$FORME (%OCCHK, ADDR(OCCHK) -> LX_ETT_ITEM.ETT$,

  18672 26 003327   200062 630500                    EPPR0   DIM$,,AUTO
        26 003330   200117 450500                    STP0    OCCHK+11,,AUTO
        26 003331   200062 631500                    EPPR1   DIM$,,AUTO
        26 003332   200116 451500                    STP1    OCCHK+10,,AUTO
        26 003333   200065 633500                    EPPR3   OCCHK+1,,AUTO
        26 003334   200115 453500                    STP3    OCCHK+9,,AUTO
        26 003335   000051 236000 27                 LDQ     41
        26 003336   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003337   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003340   000010 631400 27                 EPPR1   8
        26 003341   000000 701000 xent               TSX1    Z8AF$FORME
        26 003342   000000 011000                    NOP     0

     1387    18673    4                                 DIM$, DIM$);
     1388    18674    4              END;

     1389    18675
     1390    18676    3            CALL Z8AF$FORME (%SBCHK, SUB$, DIM$, OUT$);

  18676 26 003343   200061 236100                    LDQ     @OUT$,,AUTO
        26 003344   200117 756100                    STQ     OCCHK+11,,AUTO
        26 003345   200062 630500                    EPPR0   DIM$,,AUTO
        26 003346   200116 450500                    STP0    OCCHK+10,,AUTO
        26 003347   200060 236100                    LDQ     @SUB$,,AUTO
        26 003350   000053 235000 27                 LDA     43
        26 003351   200114 757100                    STAQ    OCCHK+8,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:260  
        26 003352   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003353   000010 631400 27                 EPPR1   8
        26 003354   000000 701000 xent               TSX1    Z8AF$FORME
        26 003355   000000 011000                    NOP     0

     1391    18677    3          END;

     1392    18678
     1393    18679    2   END SUBCHK;

  18679 26 003356   200056 221300                    LDX1  ! @INDEX_ST$,,AUTO
        26 003357   000001 702211                    TSX2  ! 1,X1

     1394    18680        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:261  
     1395    18681    1   COMPUTE_NORMAL_SUBSCRIPT: PROC (NODE$, OFF, NEW_ETT$);

  18681 26 003360   200034 741300       COMPUTE_NOR* STX1  ! OP_NODE+8,,AUTO

     1396    18682
     1397    18683    2   DCL NODE$                     PTR;
     1398    18684    2   DCL NEW_ETT$                  PTR;
     1399    18685    2   DCL OFF                       SBIN WORD;
     1400    18686
     1401    18687        %DCL_AUTO_LX_ITEM             (@NAME = SUBSCRIPT);
     1402    18691
     1403    18692
     1404    18693    2      CALL Z8E5$MATH_PACK (NODE$, ADDR(SUBSCRIPT));

  18693 26 003361   200040 630500                    EPPR0   SUBSCRIPT,,AUTO
        26 003362   200114 450500                    STP0    OCCHK+8,,AUTO
        26 003363   200114 631500                    EPPR1   OCCHK+8,,AUTO
        26 003364   200117 451500                    STP1    OCCHK+11,,AUTO
        26 003365   200035 236100                    LDQ     @NODE$,,AUTO
        26 003366   200116 756100                    STQ     OCCHK+10,,AUTO
        26 003367   200116 630500                    EPPR0   OCCHK+10,,AUTO
        26 003370   000031 631400 27                 EPPR1   25
        26 003371   000000 701000 xent               TSX1    Z8E5$MATH_PACK
        26 003372   000000 011000                    NOP     0

     1405    18694
     1406    18695           %CHECK_CONST_FOR_OUT_OF_BOUNDS (@SUBSCRIPT$ = "ADDR(SUBSCRIPT)");

  18696 26 003373   200041 470500                    LDP0    NO_DIMS,,AUTO
        26 003374   000000 220100                    LDX0    0,,PR0
        26 003375   000015 100003                    CMPX0   13,DU
        26 003376   003411 601000 26                 TNZ     s:18702

  18697 26 003377   000001 471500                    LDP1    1,,PR0
        26 003400   100010 235100                    LDA     8,,PR1
        26 003401   003405 604400 26                 TMOZ    s:18699
        26 003402   100010 236100                    LDQ     8,,PR1
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:262  
        26 003403   200015 116100                    CMPQ    DIM#,,AUTO
        26 003404   003411 604400 26                 TMOZ    s:18702

  18699 26 003405   000055 630400 27                 EPPR0   45
        26 003406   000007 631400 27                 EPPR1   7
        26 003407   000000 701000 xent               TSX1    Z8AE$ERROR
        26 003410   000000 011000                    NOP     0

     1407    18701
     1408    18702    2      CALL Z8EQ$CHECK_FOR_INTEGER_ITEM (ADDR(SUBSCRIPT),

  18702 26 003411   200040 630500                    EPPR0   SUBSCRIPT,,AUTO
        26 003412   200114 450500                    STP0    OCCHK+8,,AUTO
        26 003413   000002 236000 27                 LDQ     2
        26 003414   200117 756100                    STQ     OCCHK+11,,AUTO
        26 003415   200114 631500                    EPPR1   OCCHK+8,,AUTO
        26 003416   200116 451500                    STP1    OCCHK+10,,AUTO
        26 003417   200116 630500                    EPPR0   OCCHK+10,,AUTO
        26 003420   000031 631400 27                 EPPR1   25
        26 003421   000000 701000 xent               TSX1    Z8EQ$CHECK_FOR_INTEGER_ITEM
        26 003422   000000 011000                    NOP     0

     1409    18703    2                                        %E$INVALID_SUBSCRIPT);
     1410    18704
     1411    18705    2      CALL COMPUTE_SUBSCRIPT_OFFSET (ADDR(SUBSCRIPT), OFF, NEW_ETT$);

  18705 26 003423   200040 630500                    EPPR0   SUBSCRIPT,,AUTO
        26 003424   200123 450500                    STP0    OCCHK+15,,AUTO
        26 003425   200036 237100                    LDAQ    @OFF,,AUTO
        26 003426   200052 757100                    STAQ    @OFF,,AUTO
        26 003427   200123 631500                    EPPR1   OCCHK+15,,AUTO
        26 003430   200051 451500                    STP1    @LIST$,,AUTO
        26 003431   000745 701000 26                 TSX1    COMPUTE_SUBSCRIPT_OFFSET
        26 003432   000000 011000                    NOP     0

     1412    18706
     1413    18707    2   END COMPUTE_NORMAL_SUBSCRIPT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:263  

  18707 26 003433   200034 221300                    LDX1  ! OP_NODE+8,,AUTO
        26 003434   000001 702211                    TSX2  ! 1,X1

     1414    18708        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:264  
     1415    18709
     1416    18710        /*
     1417    18711                               Main Body
     1418    18712        */
     1419    18713    1      CALL CHECK_ARRAY_AND_#_SUBS (IDENT$, SUBSCR_LIST$, ARRAY_ST$, GLOBAL_DIMS$);

  18713 26 003435   200006 630500                    EPPR0   GLOBAL_DIMS$,,AUTO
        26 003436   200040 450500                    STP0    @NEW_ETT$+1,,AUTO
        26 003437   200005 631500                    EPPR1   ARRAY_ST$,,AUTO
        26 003440   200037 451500                    STP1    @OFF+1,,AUTO
        26 003441   200003 236100                    LDQ     @SUBSCR_LIST$,,AUTO
        26 003442   200036 756100                    STQ     @NODE$+1,,AUTO
        26 003443   200004 236100                    LDQ     @IDENT$,,AUTO
        26 003444   200035 756100                    STQ     OP_NODE+9,,AUTO
        26 003445   002615 701000 26                 TSX1    CHECK_ARRAY_AND_#_SUBS
        26 003446   000000 011000                    NOP     0

     1420    18714
     1421    18715    1      IF IDENT$ -> LX_ITEM.B.ERROR THEN

  18715 26 003447   200004 470500                    LDP0    @IDENT$,,AUTO
        26 003450   000000 471500                    LDP1    0,,PR0
        26 003451   100000 236100                    LDQ     0,,PR1
        26 003452   400000 316007                    CANQ    -131072,DL
        26 003453   003455 600000 26                 TZE     s:18718

     1422    18716    1        RETURN;

  18716 26 003454   000000 702200 xent               TSX2  ! X66_ARET

     1423    18717
     1424    18718    1      SS_EXP$       = ADDR(NIL);

  18718 26 003455   000003 236000 27                 LDQ     3
        26 003456   200007 756100                    STQ     SS_EXP$,,AUTO

     1425    18719    1      DIM#          = 0;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:265  

  18719 26 003457   200015 450100                    STZ     DIM#,,AUTO

     1426    18720    1      SPAN#         = 0;

  18720 26 003460   200016 450100                    STZ     SPAN#,,AUTO

     1427    18721    1      SUBSCRIPT#    = 0;

  18721 26 003461   200012 450100                    STZ     SUBSCRIPT#,,AUTO

     1428    18722
     1429    18723    1      OFF    = - GLOBAL_DIMS$ -> DIMS.OD.TOTAL_SPAN;

  18723 26 003462   200006 471500                    LDP1    GLOBAL_DIMS$,,AUTO
        26 003463   100004 235100                    LDA     4,,PR1
        26 003464   000000 531000                    NEG     0
        26 003465   200013 755100                    STA     OFF,,AUTO

     1430    18724    1      LIST$  = SUBSCR_LIST$ -> LX_LIST.HEAD$;

  18724 26 003466   200003 473500                    LDP3    @SUBSCR_LIST$,,AUTO
        26 003467   300000 474500                    LDP4    0,,PR3
        26 003470   400004 236100                    LDQ     4,,PR4
        26 003471   200011 756100                    STQ     LIST$,,AUTO

     1431    18725
     1432    18726    2      DO UNTIL (LIST$ = ADDR(NIL));

     1433    18727
     1434    18728    2        ADDR(OP_NODE) -> LX_ITEM = LIST$ -> LX_ITEM;

  18728 26 003472   200011 470500                    LDP0    LIST$,,AUTO
        26 003473   000100 100500                    MLR     fill='000'O
        26 003474   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
        26 003475   200024 000040                    ADSC9   OP_NODE,,AUTO            cn=0,n=32

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:266  
     1435    18729    2        NEW_ETT$      = ADDR(NIL);

  18729 26 003476   000003 236000 27                 LDQ     3
        26 003477   200010 756100                    STQ     NEW_ETT$,,AUTO

     1436    18730
     1437    18731    2        SUBSCRIPT# = SUBSCRIPT# + 1;

  18731 26 003500   200012 054100                    AOS     SUBSCRIPT#,,AUTO

     1438    18732    2        IF ARRAY_ST$ -> ARRAY.B.OCCURS_DEPENDING THEN

  18732 26 003501   200005 471500                    LDP1    ARRAY_ST$,,AUTO
        26 003502   100003 236100                    LDQ     3,,PR1
        26 003503   000200 316003                    CANQ    128,DU
        26 003504   003511 600000 26                 TZE     s:18735

     1439    18733    2          DIM# = GLOBAL_DIMS$ -> DIMS.OD.INT2;

  18733 26 003505   200006 473500                    LDP3    GLOBAL_DIMS$,,AUTO
        26 003506   300003 235100                    LDA     3,,PR3
        26 003507   200015 755100                    STA     DIM#,,AUTO
        26 003510   003516 710000 26                 TRA     s:18736

     1440    18734    2        ELSE
     1441    18735    2          DIM# = GLOBAL_DIMS$ -> DIMS.D.DIM(SUBSCRIPT#);

  18735 26 003511   200012 236100                    LDQ     SUBSCRIPT#,,AUTO
        26 003512   000003 402007                    MPY     3,DL
        26 003513   200006 473500                    LDP3    GLOBAL_DIMS$,,AUTO
        26 003514   300003 235106                    LDA     3,QL,PR3
        26 003515   200015 755100                    STA     DIM#,,AUTO

     1442    18736    2        SPAN# = GLOBAL_DIMS$ -> DIMS.D.SPAN(SUBSCRIPT#);

  18736 26 003516   200012 236100                    LDQ     SUBSCRIPT#,,AUTO
        26 003517   000003 402007                    MPY     3,DL
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:267  
        26 003520   300002 235106                    LDA     2,QL,PR3
        26 003521   200016 755100                    STA     SPAN#,,AUTO

     1443    18737    2        INDEXES$ = GLOBAL_DIMS$ -> DIMS.D.INDEX$(SUBSCRIPT#);

  18737 26 003522   300004 236106                    LDQ     4,QL,PR3
        26 003523   200020 756100                    STQ     INDEXES$,,AUTO

     1444    18738
     1445    18739    2        CALL VERIFY_SUBSCRIPT_SYNTAX (ADDR(OP_NODE), INDEX_SUB);

  18739 26 003524   200024 634500                    EPPR4   OP_NODE,,AUTO
        26 003525   200124 454500                    STP4    OCCHK+16,,AUTO
        26 003526   200022 635500                    EPPR5   INDEX_SUB,,AUTO
        26 003527   200036 455500                    STP5    @NODE$+1,,AUTO
        26 003530   200124 636500                    EPPR6   OCCHK+16,,AUTO
        26 003531   200035 456500                    STP6    OP_NODE+9,,AUTO
        26 003532   000200 701000 26                 TSX1    VERIFY_SUBSCRIPT_SYNTAX
        26 003533   000000 011000                    NOP     0

     1446    18740
     1447    18741    2        IF ADDR(OP_NODE) -> LX_ITEM.B.ERROR THEN

  18741 26 003534   200024 236100                    LDQ     OP_NODE,,AUTO
        26 003535   400000 316007                    CANQ    -131072,DL
        26 003536   003543 600000 26                 TZE     s:18744

     1448    18742    2          OFF = OFF + SPAN#;

  18742 26 003537   200013 236100                    LDQ     OFF,,AUTO
        26 003540   200016 036100                    ADLQ    SPAN#,,AUTO
        26 003541   200013 756100                    STQ     OFF,,AUTO
        26 003542   003574 710000 26                 TRA     s:18749

     1449    18743    2        ELSE
     1450    18744    2          IF INDEX_SUB THEN

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:268  
  18744 26 003543   200022 234100                    SZN     INDEX_SUB,,AUTO
        26 003544   003562 605000 26                 TPL     s:18747

     1451    18745    2            CALL INDEX_SUBSCRIPT (ADDR(OP_NODE), OFF, INDEXES$, NEW_ETT$);

  18745 26 003545   200024 630500                    EPPR0   OP_NODE,,AUTO
        26 003546   200125 450500                    STP0    OCCHK+17,,AUTO
        26 003547   200010 631500                    EPPR1   NEW_ETT$,,AUTO
        26 003550   200040 451500                    STP1    @NEW_ETT$+1,,AUTO
        26 003551   200020 633500                    EPPR3   INDEXES$,,AUTO
        26 003552   200037 453500                    STP3    @OFF+1,,AUTO
        26 003553   200013 634500                    EPPR4   OFF,,AUTO
        26 003554   200036 454500                    STP4    @NODE$+1,,AUTO
        26 003555   200125 635500                    EPPR5   OCCHK+17,,AUTO
        26 003556   200035 455500                    STP5    OP_NODE+9,,AUTO
        26 003557   002345 701000 26                 TSX1    INDEX_SUBSCRIPT
        26 003560   000000 011000                    NOP     0
        26 003561   003574 710000 26                 TRA     s:18749

     1452    18746    2          ELSE
     1453    18747    2            CALL COMPUTE_NORMAL_SUBSCRIPT (ADDR(OP_NODE), OFF, NEW_ETT$);

  18747 26 003562   200024 630500                    EPPR0   OP_NODE,,AUTO
        26 003563   200126 450500                    STP0    OCCHK+18,,AUTO
        26 003564   200010 631500                    EPPR1   NEW_ETT$,,AUTO
        26 003565   200037 451500                    STP1    @OFF+1,,AUTO
        26 003566   200013 633500                    EPPR3   OFF,,AUTO
        26 003567   200036 453500                    STP3    @NODE$+1,,AUTO
        26 003570   200126 634500                    EPPR4   OCCHK+18,,AUTO
        26 003571   200035 454500                    STP4    OP_NODE+9,,AUTO
        26 003572   003360 701000 26                 TSX1    COMPUTE_NORMAL_SUBSCRIPT
        26 003573   000000 011000                    NOP     0

     1454    18748
     1455    18749    2        IF NEW_ETT$ ~= ADDR(NIL) THEN

  18749 26 003574   200010 236100                    LDQ     NEW_ETT$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:269  
        26 003575   000003 116000 27                 CMPQ    3
        26 003576   003621 600000 26                 TZE     s:18755

     1456    18750    2          IF SS_EXP$ = ADDR(NIL) THEN

  18750 26 003577   200007 236100                    LDQ     SS_EXP$,,AUTO
        26 003600   000003 116000 27                 CMPQ    3
        26 003601   003605 601000 26                 TNZ     s:18753

     1457    18751    2            SS_EXP$ = NEW_ETT$;

  18751 26 003602   200010 236100                    LDQ     NEW_ETT$,,AUTO
        26 003603   200007 756100                    STQ     SS_EXP$,,AUTO
        26 003604   003621 710000 26                 TRA     s:18755

     1458    18752    2          ELSE
     1459    18753    2            CALL Z8AF$FORME(%ADI, SS_EXP$, NEW_ETT$, SS_EXP$) ;

  18753 26 003605   200007 630500                    EPPR0   SS_EXP$,,AUTO
        26 003606   200117 450500                    STP0    OCCHK+11,,AUTO
        26 003607   200010 631500                    EPPR1   NEW_ETT$,,AUTO
        26 003610   200116 451500                    STP1    OCCHK+10,,AUTO
        26 003611   200007 633500                    EPPR3   SS_EXP$,,AUTO
        26 003612   200115 453500                    STP3    OCCHK+9,,AUTO
        26 003613   000014 236000 27                 LDQ     12
        26 003614   200114 756100                    STQ     OCCHK+8,,AUTO
        26 003615   200114 630500                    EPPR0   OCCHK+8,,AUTO
        26 003616   000010 631400 27                 EPPR1   8
        26 003617   000000 701000 xent               TSX1    Z8AF$FORME
        26 003620   000000 011000                    NOP     0

     1460    18754
     1461    18755    2        LIST$ = LIST$ -> LX_ETT_ITEM.LINK;

  18755 26 003621   200011 470500                    LDP0    LIST$,,AUTO
        26 003622   000007 236100                    LDQ     7,,PR0
        26 003623   200011 756100                    STQ     LIST$,,AUTO
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:270  

     1462    18756
     1463    18757    2      END; /* Until -- list$ = addr(nil) */

  18757 26 003624   000003 116000 27                 CMPQ    3
        26 003625   003472 601000 26                 TNZ     s:18728

     1464    18758
     1465    18759    1      CALL WRAP_UP (SS_EXP$, OFF, IDENT$);

  18759 26 003626   200004 236100                    LDQ     @IDENT$,,AUTO
        26 003627   200037 756100                    STQ     @OFF+1,,AUTO
        26 003630   200013 630500                    EPPR0   OFF,,AUTO
        26 003631   200036 450500                    STP0    @NODE$+1,,AUTO
        26 003632   200007 631500                    EPPR1   SS_EXP$,,AUTO
        26 003633   200035 451500                    STP1    OP_NODE+9,,AUTO
        26 003634   001460 701000 26                 TSX1    WRAP_UP
        26 003635   000000 011000                    NOP     0

     1466    18760
     1467    18761    1   END; /* Proc -- Z8EY$SUBSCRIPT */

  18761 26 003636   000000 702200 xent               TSX2  ! X66_ARET
     1468    18762        %EJECT;
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:271  
     1469    18763        %EOD;

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:272  
--  Include file information  --

   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_O1COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_ABSSYN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8E_MACROS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_HEAP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_SRCH.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$SUBSCRIPT.
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:273  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 002 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 003 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 004 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:274  
  ****  Section 005 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 006 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 007 LblCom SRCH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 SRCH

  ****  Section 008 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 009 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 010 LblCom DNT_BUCKET_NUMBER

PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:275  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 011 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 012 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 013 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 014 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 015 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:276  

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 016 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 017 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 018 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 019 LblCom HEAP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAP$

  ****  Section 020 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:277  

  ****  Section 021 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 022 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 023 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 024 LblCom TEMP_LX_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)         1 TEMP_LX_NODE

  ****  Section 025 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Auto variables  ****
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:278  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    35-0-0/w PTR         r     1 @ARRAY$                   53-0-0/w PTR         r     1 @ARRAY_ST$
    37-0-0/w PTR         r     1 @ARRAY_ST$                54-0-0/w PTR         r     1 @DIM#
    77-0-0/w PTR         r     1 @DIM#                     57-0-0/w PTR         r     1 @DIM#
    40-0-0/w PTR         r     1 @DIMS$                     4-0-0/w PTR         r     1 @IDENT$
    37-0-0/w PTR         r     1 @IDENT$                   55-0-0/w PTR         r     1 @INDEX$
   100-0-0/w PTR         r     1 @INDEXES$                 57-0-0/w PTR         r     1 @INDEXES$
    37-0-0/w PTR         r     1 @INDEXES$                 77-0-0/w PTR         r     1 @INDEX_ST$
    56-0-0/w PTR         r     1 @INDEX_ST$                52-0-0/w PTR         r     1 @INDEX_SUB
    36-0-0/w PTR         r     1 @INDEX_SUB                51-0-0/w PTR         r     1 @LIST$
    53-0-0/w PTR         r     1 @NEW_ETT$                 40-0-0/w PTR         r     1 @NEW_ETT$
    37-0-0/w PTR         r     1 @NEW_ETT$                 51-0-0/w PTR         r     1 @NODE$
    51-0-0/w PTR         r     1 @NODE$                    61-0-0/w PTR         r     1 @NODE$
    35-0-0/w PTR         r     1 @NODE$                    35-0-0/w PTR         r     1 @NODE$
    35-0-0/w PTR         r     1 @NODE$                    62-0-0/w PTR         r     1 @NUM_DESC
    52-0-0/w PTR         r     1 @OFF                      36-0-0/w PTR         r     1 @OFF
    36-0-0/w PTR         r     1 @OFF                      36-0-0/w PTR         r     1 @OFF
   101-0-0/w PTR         r     1 @OUT$                     61-0-0/w PTR         r     1 @OUT$
    60-0-0/w PTR         r     1 @RETURN_ETT$              35-0-0/w PTR         r     1 @SS_EXP$
   100-0-0/w PTR         r     1 @SUB$                     60-0-0/w PTR         r     1 @SUB$
     3-0-0/w PTR         r     1 @SUBSCR_LIST$             36-0-0/w PTR         r     1 @SUB_LIST$
    *0-0-0/w PTR         r     1 ARRAY$                     5-0-0/w PTR         r     1 ARRAY_ST$
    *0-0-0/w PTR         r     1 ARRAY_ST$                 *0-0-0/w PTR         r     1 ARRAY_ST$
    15-0-0/w SBIN        r     1 DIM#                      *0-0-0/w SBIN        r     1 DIM#
    *0-0-0/w SBIN        r     1 DIM#                      *0-0-0/w SBIN        r     1 DIM#
    17-0-0/w PTR               1 DIM$                     102-0-0/w PTR         r     1 DIM$
    62-0-0/w PTR         r     1 DIM$                      *0-0-0/w PTR         r     1 DIMS$
   102-0-0/w PTR         r     1 DIM_INDEX$                40-0-0/w SBIN        r     1 ERROR_COLUMN#
    37-0-0/w SBIN        r     1 ERROR_LINE#               54-0-0/w PTR         r     1 ETT$$
    42-0-0/w UBIN        r     1 FISS_OFF                   6-0-0/w PTR         r     1 GLOBAL_DIMS$
   103-0-0/w SBIN              1 I                         *0-0-0/w PTR         r     1 IDENT$
    *0-0-0/w PTR         r     1 IDENT$                    21-0-0/w UBIN        r     1 ID_TYPE
    *0-0-0/w PTR         r     1 INDEX$                    20-0-0/w PTR         r     1 INDEXES$
    *0-0-0/w PTR         r     1 INDEXES$                  *0-0-0/w PTR         r     1 INDEXES$
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:279  
    *0-0-0/w PTR         r     1 INDEXES$                  *0-0-0/w PTR         r     1 INDEX_ST$
    *0-0-0/w PTR         r     1 INDEX_ST$                 41-0-0/w PTR         r     1 INDEX_ST$
    22-0-0/b BIT         r     1 INDEX_SUB                 *0-0-0/w BIT         r     1 INDEX_SUB
    *0-0-0/w BIT         r     1 INDEX_SUB                 66-0-0/d STRC(288)   r     1 INT_CONST
    42-0-0/d STRC(288)   r     1 INT_CONST                 14-0-0/w SBIN              1 LAST_DIM
   101-0-0/w SBIN              1 LAST_DIM#                 11-0-0/w PTR         r     1 LIST$
    *0-0-0/w PTR         r     1 LIST$                     44-0-0/w SBIN        r     1 MAX_OFF_PRECISION
    10-0-0/w PTR         r     1 NEW_ETT$                  *0-0-0/w PTR         r     1 NEW_ETT$
    *0-0-0/w PTR         r     1 NEW_ETT$                  *0-0-0/w PTR         r     1 NEW_ETT$
    *0-0-0/w PTR         r     1 NODE$                     *0-0-0/w PTR         r     1 NODE$
    *0-0-0/w PTR         r     1 NODE$                     *0-0-0/w PTR         r     1 NODE$
    *0-0-0/w PTR         r     1 NODE$                     *0-0-0/w PTR         r     1 NODE$
    53-0-0/w PTR         r     1 NODE_ST$                  41-0-0/w SBIN        r     1 NO_DIMS
    52-0-0/w STRC(216)   r     1 NUM_DESC                  *0-0-0/w STRC(216)   r     1 NUM_DESC
    42-0-0/w STRC(216)   r     1 NUM_DESC                 104-0-0/d STRC(288)   r     1 OCCHK
    64-0-0/d STRC(288)   r     1 OCCHK                     13-0-0/w SBIN        r     1 OFF
    *0-0-0/w SBIN        r     1 OFF                       *0-0-0/w SBIN        r     1 OFF
    *0-0-0/w SBIN        r     1 OFF                       *0-0-0/w SBIN        r     1 OFF
    40-0-0/w PTR         r     1 OFF$                      24-0-0/d STRC(288)   r     1 OP_NODE
    *0-0-0/w PTR         r     1 OUT$                      *0-0-0/w PTR         r     1 OUT$
    43-0-0/w PTR         r     1 REFMOD$                   *0-0-0/w PTR         r     1 RETURN_ETT$
    61-0-0/w SBIN              1 ROPCON                    41-0-0/w PTR         r     1 SIZ$
    16-0-0/w SBIN        r     1 SPAN#                     63-0-0/w PTR         r     1 SPAN$
   103-0-0/w PTR         r     1 SPAN$                      7-0-0/w PTR         r     1 SS_EXP$
    *0-0-0/w PTR         r     1 SS_EXP$                   *0-0-0/w PTR         r     1 SUB$
    *0-0-0/w PTR         r     1 SUB$                      40-0-0/d STRC(288)   r     1 SUBSCRIPT
    12-0-0/w SBIN        r     1 SUBSCRIPT#                *0-0-0/w PTR         r     1 SUBSCR_LIST$
    *0-0-0/w PTR         r     1 SUB_LIST$                 41-0-0/w SBIN        r     1 SYMBOL
    64-0-0/w PTR         r     1 THREE$                    62-0-0/w SBIN        r     1 UNITS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM
     0-0-0/w STRC(180)         1 HIER_STK(0:50)
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:280  
     0-0-0/w SBIN              1 HIER_STK_PTR               0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/d STRC(11580)       1 O1COM                      0-0-0/w STRC(144)         1 PAGE_FORMAT
     0-0-0/w STRC(153)         1 REP_STK(0:50)              0-0-0/w SBIN              1 REP_STK_PTR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864)       1 ARGLIST
     0-0-0/w STRC(396)   r     1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)   r     1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)  r     1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)         1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:281  
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)         1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(288)         1 ILS_LIST                   0-0-0/w STRC(108)   r     1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)         1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)   r     1 LX_ETT_ITEM                0-0-0/w STRC(288)   r     1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)   r     1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)   r     1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(180)         1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)         1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)         1 PROC_SUPP                  0-0-0/w STRC(144)         1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)         1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)        1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)         1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
PL6.E3A0      #003=Z8EY$SUBSCRIPT File=Z8EY.:Z8A6TSI                             SAT 08/09/97 13:03 Page:282  
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)         1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8EY$SUBSCRIPT requires 1951 words for executable code.
   Procedure Z8EY$SUBSCRIPT requires 88 words of local(AUTO) storage.

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:283  
     1470        1        /*T***********************************************************/
     1471        2        /*T*                                                         */
     1472        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1473        4        /*T*                                                         */
     1474        5        /*T***********************************************************/
     1475        6        Z8EY$CHECK_OPTZ: PROC (QLT$$);
     1476        7
     1477        8        /*I*   NAME: Z8EY$CHECK_OPTZ
     1478        9               CALL: CALL Z8EY$CHECK_OPTZ (QUAL-item-pointer);
     1479       10              INPUT: QLT$$ -- QUAL item to check for de-optimization.
     1480       11             OUTPUT: SCALAR.LTS$ -- set to ADDR(NIL) if de-optimized.
     1481       12        DESCRIPTION: This is a recursive routine. It checks all levels
     1482       13                     below a group item that is passed as an argument of
     1483       14                     a call. If an elementary item is a candidate for the
     1484       15                     "VALUE" optimization, then it is de-optimized, since a
     1485       16                     CALL statement could redefine its value.
     1486       17        */
     1487       18
     1488       19        %SET PHASE = 1;
     1489       20        %INCLUDE Z8A_DEFC;
     1490       88        %INCLUDE Z8A_SUPP_MAC;
     1491     2488        %INCLUDE Z8A_ST;
     1492     6147        %INCLUDE Z8A_QLT;
     1493     6253        %INCLUDE Z8A_ETT;
     1494     6554
     1495     6555        %EJECT;
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:284  
     1496     6556        /* Z8EY$CHECK_OPTZ -- recursive */
     1497     6557
     1498     6558    1   DCL  QLT$$      PTR;                  /* QUAL item */
     1499     6559    1   DCL  QUAL$      PTR;                  /* Local copy of QLT$$ */
     1500     6560    1   DCL  ST$$       PTR;                  /* Symbol Table item */
     1501     6561    1   DCL  LTS_UBIN   UBIN STATIC INIT (0);
     1502     6562    1   DCL  ZERO_PTR$  REDEF LTS_UBIN PTR;
     1503     6563
     1504     6564        /* Check this node, its sisters, and daughters */
     1505     6565
     1506     6566    1   QUAL$ = QLT$$; /* copy QLT$$ so we don't wipe out  the QLT chain */
     1507     6567
     1508     6568    2   DO FOREVER;
     1509     6569
     1510     6570    2     IF QUAL$ -> QLT.ID ~= %QUAL THEN
     1511     6571    2       EXIT;
     1512     6572
     1513     6573    2     ST$$ = QUAL$ -> QLT.ST$;
     1514     6574    2     IF ST$$ = ADDR(NIL)
     1515     6575    2     OR ST$$ = ZERO_PTR$
     1516     6576    2     OR ST$$ -> ST.ID ~= %SCALAR THEN
     1517     6577    2       EXIT;
     1518     6578
     1519     6579    2     IF  ST$$ -> SCALAR.LTS$ ~= ADDR(NIL)   /* Possible VALUE clause */
     1520     6580    2     AND ST$$ -> SCALAR.LTS$ ~= ZERO_PTR$
     1521     6581    2     AND ST$$ -> SCALAR.LTS$ -> ETT.ID = %TRIAD THEN
     1522     6582    2       ST$$ -> SCALAR.LTS$ = ADDR(NIL);
     1523     6583
     1524     6584    2     IF  QUAL$ -> QLT.SON ~= ADDR(NIL)
     1525     6585    2     AND QUAL$ -> QLT.SON ~= ZERO_PTR$ THEN
     1526     6586    2       CALL Z8EY$CHECK_OPTZ (QUAL$ -> QLT.SON);
     1527     6587
     1528     6588    2     QUAL$ = QUAL$ -> QLT.BROTHER;
     1529     6589    2     IF QUAL$ = ADDR(NIL)
     1530     6590    2     OR QUAL$ = ZERO_PTR$ THEN
     1531     6591    2       EXIT;
     1532     6592
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:285  
     1533     6593    2   END; /* Do Forever (until EXIT) */
     1534     6594
     1535     6595    1   END Z8EY$CHECK_OPTZ;

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:286  
--  Include file information  --

   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$CHECK_OPTZ.

   Procedure Z8EY$CHECK_OPTZ requires 51 words for executable code.
   Procedure Z8EY$CHECK_OPTZ requires 8 words of local(AUTO) storage.

    No errors detected in file Z8EY.:Z8A6TSI    .

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:287  

 Object Unit name= Z8EY$CHECK_OPTZ                            File name= Z8EY.:Z8A6TOU
 UTS= AUG 09 '97 13:06:54.36 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  ST$
    2  LblCom even  none     5      5  ST_
    3  LblCom even  none     1      1  QLT$
    4  LblCom even  none     1      1  PREV_01_QLT$
    5  LblCom even  none     5      5  QLT_
    6  LblCom even  none     1      1  ETT$
    7  LblCom even  none     1      1  HEAD_ETT$
    8  LblCom even  none   512   1000  ETT_BUCKETS
    9  LblCom even  none     5      5  ETT_
   10   Data  even  none     1      1  Z8EY$CHECK_OPTZ
   11   Proc  even  none    51     63  Z8EY$CHECK_OPTZ
   12  RoData even  none     2      2  Z8EY$CHECK_OPTZ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        1  Z8EY$CHECK_OPTZ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:288  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:289  


     1470        1        /*T***********************************************************/
     1471        2        /*T*                                                         */
     1472        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1473        4        /*T*                                                         */
     1474        5        /*T***********************************************************/
     1475        6        Z8EY$CHECK_OPTZ: PROC (QLT$$);

      6 11 000000   000000 700200 xent  Z8EY$CHECK_* TSX0  ! X66_AUTO_1
        11 000001   000010 000001                    ZERO    8,1

     1476        7
     1477        8        /*I*   NAME: Z8EY$CHECK_OPTZ
     1478        9               CALL: CALL Z8EY$CHECK_OPTZ (QUAL-item-pointer);
     1479       10              INPUT: QLT$$ -- QUAL item to check for de-optimization.
     1480       11             OUTPUT: SCALAR.LTS$ -- set to ADDR(NIL) if de-optimized.
     1481       12        DESCRIPTION: This is a recursive routine. It checks all levels
     1482       13                     below a group item that is passed as an argument of
     1483       14                     a call. If an elementary item is a candidate for the
     1484       15                     "VALUE" optimization, then it is de-optimized, since a
     1485       16                     CALL statement could redefine its value.
     1486       17        */
     1487       18
     1488       19        %SET PHASE = 1;
     1489       20        %INCLUDE Z8A_DEFC;
     1490       88        %INCLUDE Z8A_SUPP_MAC;
     1491     2488        %INCLUDE Z8A_ST;
     1492     6147        %INCLUDE Z8A_QLT;
     1493     6253        %INCLUDE Z8A_ETT;
     1494     6554
     1495     6555        %EJECT;
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:290  
     1496     6556        /* Z8EY$CHECK_OPTZ -- recursive */
     1497     6557
     1498     6558    1   DCL  QLT$$      PTR;                  /* QUAL item */
     1499     6559    1   DCL  QUAL$      PTR;                  /* Local copy of QLT$$ */
     1500     6560    1   DCL  ST$$       PTR;                  /* Symbol Table item */
     1501     6561    1   DCL  LTS_UBIN   UBIN STATIC INIT (0);
     1502     6562    1   DCL  ZERO_PTR$  REDEF LTS_UBIN PTR;
     1503     6563
     1504     6564        /* Check this node, its sisters, and daughters */
     1505     6565
     1506     6566    1   QUAL$ = QLT$$; /* copy QLT$$ so we don't wipe out  the QLT chain */

   6566 11 000002   200003 470500                    LDP0    @QLT$$,,AUTO
        11 000003   000000 236100                    LDQ     0,,PR0
        11 000004   200004 756100                    STQ     QUAL$,,AUTO

     1507     6567
     1508     6568    2   DO FOREVER;

     1509     6569
     1510     6570    2     IF QUAL$ -> QLT.ID ~= %QUAL THEN

   6570 11 000005   200004 470500                    LDP0    QUAL$,,AUTO
        11 000006   000000 220100                    LDX0    0,,PR0
        11 000007   001053 100003                    CMPX0   555,DU
        11 000010   000062 601000 11                 TNZ     s:6595

     1511     6571    2       EXIT;
     1512     6572
     1513     6573    2     ST$$ = QUAL$ -> QLT.ST$;

   6573 11 000011   000004 236100                    LDQ     4,,PR0
        11 000012   200005 756100                    STQ     ST$$,,AUTO

     1514     6574    2     IF ST$$ = ADDR(NIL)

   6574 11 000013   000000 116000 12                 CMPQ    0
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:291  
        11 000014   000062 600000 11                 TZE     s:6595
        11 000015   000000 116000 10                 CMPQ    LTS_UBIN
        11 000016   000062 600000 11                 TZE     s:6595
        11 000017   200005 471500                    LDP1    ST$$,,AUTO
        11 000020   100000 221100                    LDX1    0,,PR1
        11 000021   000766 101003                    CMPX1   502,DU
        11 000022   000062 601000 11                 TNZ     s:6595

     1515     6575    2     OR ST$$ = ZERO_PTR$
     1516     6576    2     OR ST$$ -> ST.ID ~= %SCALAR THEN
     1517     6577    2       EXIT;
     1518     6578
     1519     6579    2     IF  ST$$ -> SCALAR.LTS$ ~= ADDR(NIL)   /* Possible VALUE clause */

   6579 11 000023   100005 236100                    LDQ     5,,PR1
        11 000024   000000 116000 12                 CMPQ    0
        11 000025   000036 600000 11                 TZE     s:6584
        11 000026   000000 116000 10                 CMPQ    LTS_UBIN
        11 000027   000036 600000 11                 TZE     s:6584
        11 000030   100005 473500                    LDP3    5,,PR1
        11 000031   300000 222100                    LDX2    0,,PR3
        11 000032   000015 102003                    CMPX2   13,DU
        11 000033   000036 601000 11                 TNZ     s:6584

     1520     6580    2     AND ST$$ -> SCALAR.LTS$ ~= ZERO_PTR$
     1521     6581    2     AND ST$$ -> SCALAR.LTS$ -> ETT.ID = %TRIAD THEN
     1522     6582    2       ST$$ -> SCALAR.LTS$ = ADDR(NIL);

   6582 11 000034   000000 236000 12                 LDQ     0
        11 000035   100005 756100                    STQ     5,,PR1

     1523     6583
     1524     6584    2     IF  QUAL$ -> QLT.SON ~= ADDR(NIL)

   6584 11 000036   000003 236100                    LDQ     3,,PR0
        11 000037   000000 116000 12                 CMPQ    0
        11 000040   000052 600000 11                 TZE     s:6588
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:292  
        11 000041   000000 116000 10                 CMPQ    LTS_UBIN
        11 000042   000052 600000 11                 TZE     s:6588

     1525     6585    2     AND QUAL$ -> QLT.SON ~= ZERO_PTR$ THEN
     1526     6586    2       CALL Z8EY$CHECK_OPTZ (QUAL$ -> QLT.SON);

   6586 11 000043   200004 236100                    LDQ     QUAL$,,AUTO
        11 000044   000003 036003                    ADLQ    3,DU
        11 000045   200006 756100                    STQ     ST$$+1,,AUTO
        11 000046   200006 630500                    EPPR0   ST$$+1,,AUTO
        11 000047   000001 631400 12                 EPPR1   1
        11 000050   000000 701000 11                 TSX1    s:6
        11 000051   000000 011000                    NOP     0

     1527     6587
     1528     6588    2     QUAL$ = QUAL$ -> QLT.BROTHER;

   6588 11 000052   200004 470500                    LDP0    QUAL$,,AUTO
        11 000053   000002 236100                    LDQ     2,,PR0
        11 000054   200004 756100                    STQ     QUAL$,,AUTO

     1529     6589    2     IF QUAL$ = ADDR(NIL)

   6589 11 000055   000000 116000 12                 CMPQ    0
        11 000056   000062 600000 11                 TZE     s:6595
        11 000057   000000 116000 10                 CMPQ    LTS_UBIN
        11 000060   000062 600000 11                 TZE     s:6595

     1530     6590    2     OR QUAL$ = ZERO_PTR$ THEN
     1531     6591    2       EXIT;
     1532     6592
     1533     6593    2   END; /* Do Forever (until EXIT) */

   6593 11 000061   000005 710000 11                 TRA     s:6570

     1534     6594
     1535     6595    1   END Z8EY$CHECK_OPTZ;
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:293  

   6595 11 000062   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:294  
--  Include file information  --

   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8EY$CHECK_OPTZ.
PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:295  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 002 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 003 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 004 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:296  
  ****  Section 005 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 006 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 007 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 008 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 009 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 010  Data  Z8EY$CHECK_OPTZ

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:297  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 LTS_UBIN                   0-0-0/w PTR         r     1 ZERO_PTR$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @QLT$$                    *0-0-0/w PTR         r     1 QLT$$
     4-0-0/w PTR         r     1 QUAL$                      5-0-0/w PTR         r     1 ST$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(396)         1 BLOCK                      0-0-0/w STRC(396)         1 CD
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)         1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(396)         1 INTDEF                     0-0-0/w STRC(396)         1 LABEL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(396)         1 PROC_
     0-0-0/w STRC(396)         1 PROC_DEF                   0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(396)         1 SD                         0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(396)   r     1 ST
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(396)         1 VARIABLE

PL6.E3A0      #004=Z8EY$CHECK_OPTZ File=Z8EY.:Z8A6TSI                            SAT 08/09/97 13:06 Page:298  

   Procedure Z8EY$CHECK_OPTZ requires 51 words for executable code.
   Procedure Z8EY$CHECK_OPTZ requires 8 words of local(AUTO) storage.

    No errors detected in file Z8EY.:Z8A6TSI    .
