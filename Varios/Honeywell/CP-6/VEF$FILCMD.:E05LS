VERSION E05

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:1    
        1        1        /*M*    VEF$FILCMD - EDIT FILE COMMAND EXEC ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /**/
        9        9        VEF$FILCMD: PROC;
       10       10        /**/
       11       11        /*********************************************************************/
       12       12        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       13       13        /*********************************************************************/
       14       14        /**/
       15       15        %INCLUDE VE_SUBS_C;
       16      209        %INCLUDE VE_PERR_C;
       17      426        %INCLUDE CP_6_SUBS;
       18      966        %INCLUDE F$DCB;
       19     1015        %INCLUDE CP_6;
       20     1096        %INCLUDE B_ERRORS_C;
       21     2223        %INCLUDE B$JIT ;
       22     2513        %INCLUDE XU_MACRO_C ;
       23     5619        %INCLUDE XUH_MACRO_C ;
       24     5703        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:2    
       25     5704        /********************************************************************/
       26     5705        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       27     5706        /********************************************************************/
       28     5707        %FPT_OPEN (FPTN = OPEN_FILE_FPT,
       29     5708                      NAME = OPEN_FILE_NAME,
       30     5709                      DCB = M$FILE,
       31     5710                      ASN = FILE,
       32     5711                      ACS = DIRECT,
       33     5712                      DISP = NAMED,
       34     5713                      CTG = YES,
       35     5714                      SPARE = 50,
       36     5715                      SCRUB = YES,
       37     5716                      ORG = KEYED);
       38     5825        %FPT_TRUNC (FPTN = TRUNC_FPT, STCLASS = CONSTANT, DCB = M$FILE);
       39     5839        %FPT_OPEN (FPTN = OPEN_FILE2_FPT,
       40     5840                      NAME = OPEN_FILE_NAME,
       41     5841                      DCB = M$FILE2,
       42     5842                      ASN = FILE,
       43     5843                      ACS = DIRECT,
       44     5844                      SPARE = 50,
       45     5845                      ORG = KEYED,
       46     5846                      SCRUB = YES,
       47     5847                      DISP = NAMED);
       48     5956        %FPT_OPEN (FPTN = DELETE_FPT , STCLASS = AUTO);
       49     6065        %FPT_OPEN (FPTN = DELETE_FPT_C , STCLASS = CONSTANT,
       50     6066                      NAME = OPEN_FILE_NAME,
       51     6067                      DCB = M$FILE2,
       52     6068                      ASN = FILE,
       53     6069                      SCRUB = YES,
       54     6070                      DELETE = YES);
       55     6179        %FPT_CLOSE (FPTN = CLOSE_FPT, STCLASS = CONSTANT,
       56     6180                      DCB = M$FILE,
       57     6181                      RELG = YES ,
       58     6182                      DISP=SAVE);
       59     6224        %FPT_CLOSE (FPTN = CLOSEDFLT_FPT, STCLASS = CONSTANT,
       60     6225                      DCB = M$FILE,
       61     6226                      RELG = YES) ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:3    
       62     6268        %FPT_CLOSE (FPTN = CLOSEREL_FPT, STCLASS = CONSTANT,
       63     6269                    DCB = M$FILE,
       64     6270                    DISP = RELEASE);
       65     6312        %FPT_CLOSE (FPTN = CLOSE2_FPT,
       66     6313                      DCB = M$FILE2,
       67     6314                      RELG = YES ,
       68     6315                      DISP = SAVE);
       69     6357        %FPT_CLOSE (FPTN = CLOSE2DFLT_FPT,
       70     6358                      DCB = M$FILE2,
       71     6359                      RELG = YES) ;
       72     6401        %FPT_CLOSE (FPTN = CLOSE2REL_FPT, STCLASS = CONSTANT,
       73     6402                      DCB = M$FILE2,
       74     6403                      DISP = RELEASE);
       75     6445        %FPT_CLOSE    (FPTN = CLOSE_ME_FPT, STCLASS = CONSTANT,
       76     6446                      DCB = M$ME,
       77     6447                      DISP = SAVE);
       78     6489        %FPT_CLOSE    (FPTN = CLOSE_DO_FPT, STCLASS = CONSTANT,
       79     6490                      DCB = M$DO,
       80     6491                      DISP = SAVE);
       81     6533        %FPT_READ (FPTN = READ_SEQUEN2_FPT,
       82     6534                      BUF = CMD_BUF,
       83     6535                      DCB = M$FILE2,
       84     6536                      KEY = LAST_KEY,
       85     6537                      KEYS = NO,
       86     6538                      KEYR = YES);
       87     6577        %FPT_PFIL (FPTN = PFIL_FPT, STCLASS = CONSTANT,
       88     6578                      DCB = M$FILE,
       89     6579                      BOF = YES);
       90     6594        %FPT_GDS      (FPTN = COPYDS_FPT, STCLASS = CONSTANT,
       91     6595                       RESULTS = DS_RESULTS,
       92     6596                       SEGSIZE = 1024);
       93     6612        %FPT_DEVICE   (FPTN = TAB_FPT, STCLASS = CONSTANT,
       94     6613                      DCB = M$UC,
       95     6614                      TAB = TAB_VLP);
       96     6632        %VLP_VECTOR   (FPTN = DS_RESULTS);
       97     6647        %FPT_SETFMA (FPTN = FPT_SETFMA) ;
       98     6660        %FPT_UNFID (FPTN = UNFID_FPT , STCLASS = CONSTANT,
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:4    
       99     6661                    DCB = M$FILE ,
      100     6662                    TEXTFID = TEMP_BUF ) ;
      101     6680        %XUH_PARAM (NAME = XUH_PARAM ,
      102     6681                    PROCNAME = VLP_EDIT ,
      103     6682                    OUTDCB1 = M$ME ,
      104     6683                    OUTDCB2 = M$DO ,
      105     6684                    KEYWORD = VLP_ERROR_SYN ,
      106     6685                    STCLASS = STATIC) ;
      107     6746        %VLP_NAME  (FPTN = VLP_ERROR_SYN ,
      108     6747                    NAME = 'ERROR_SYN' ,
      109     6748                    LEN = 9 ,
      110     6749                    STCLASS = CONSTANT) ;
      111     6776        %VLP_NAME  (FPTN = VLP_EDIT ,
      112     6777                    NAME = 'EDIT' ,
      113     6778                    LEN = 4 ,
      114     6779                    STCLASS = CONSTANT) ;
      115     6806        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:5    
      116     6807        /**********************************************************************/
      117     6808        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      118     6809        /**********************************************************************/
      119     6810    1   DCL 1 CMD_CNTRLWD BASED ALIGNED,        /* CONTROL WORD FOR CMD_TBL ENTRIES   */
      120     6811    1          2 FLAGS,
      121     6812    1             3 ENDCT BIT(1) UNAL,          /* LAST ENTRY                         */
      122     6813    1             3 * BIT(17) UNAL,
      123     6814    1          2 OFFSET UBIN(9) UNAL,           /* NUM. OF WORDS TO NEXT ENTRY        */
      124     6815    1          2 CMD_CODE UBIN(9) UNAL;         /* CODE FOR THIS COMMAND              */
      125     6816    1   DCL 1 SSE$PARAM BASED ALIGNED,          /*SSE TABLE ENTRY                     */
      126     6817    1          2 FLAGS,
      127     6818    1             3 CLMNFLAG BIT(1) UNAL,                    /* IF TRUE NEXT WORD IS CLMN#
      128     6819                                                                   ELSE PTR$ */
      129     6820    1             3 NOTFLAG BIT(1) UNAL,        /* LOG. OP. IS NOT                    */
      130     6821    1             3 ANDFLAG BIT(1) UNAL,        /* LOG. OP. IS AND                    */
      131     6822    1             3 ORFLAG BIT(1) UNAL,         /* LOG. OP. IS OR                     */
      132     6823    1             3 EORFLAG BIT(1) UNAL,        /* LOG. OP. IS EOR*/
      133     6824    1             3 * BIT(13) UNAL,
      134     6825    1          2 J SBIN HALF UNAL,              /* OCCURANCE NUMBER                   */
      135     6826    1          2 PTR$ PTR UNAL;                 /* POINTER TO STRING                  */
      136     6827    1   DCL 1 STR$BUF BASED ALIGNED,
      137     6828    1          2 COUNT UBIN(9) UNAL,
      138     6829    1          2 TEXT CHAR(255) UNAL;
      139     6830    1   DCL 1 STR$PARAM BASED ALIGNED,
      140     6831    1          2 COUNT UBIN WORD UNAL,
      141     6832    1          2 STR(0:0),
      142     6833    1             3 QM BIT(1) UNAL,
      143     6834    1             3 * BIT(17) UNAL,
      144     6835    1             3 QMCOUNT UBIN HALF UNAL,
      145     6836    1             3 PTR$ PTR UNAL;
      146     6837        /**/
      147     6838    1   DCL 1 ED_CMD_TBL BASED ALIGNED,         /* EDIT AND DELETE                    */
      148     6839    1          2 * BIT(36) UNAL,
      149     6840    1          2 FID$ PTR;
      150     6841    1   DCL 1 B_CMD_TBL BASED ALIGNED,          /* BUILD COMMAND                      */
      151     6842    1          2 * BIT(36) UNAL,
      152     6843    1          2 FID$ PTR UNAL,
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:6    
      153     6844    1          2 SEQNUM UBIN(36) UNAL,
      154     6845    1          2 INCR UBIN(36) UNAL,
      155     6846    1          2 TYPE CHAR(2) UNAL;
      156     6847    1   DCL 1 B_HELP_CMD_TBL BASED ALIGNED,     /* BUILD COMMAND                      */
      157     6848    1          2 * BIT(36) UNAL,
      158     6849    1          2 FID$ PTR UNAL,
      159     6850    1          2 HELPKEY CHAR(64) UNAL,
      160     6851    1          2 INCR UBIN WORD UNAL,
      161     6852    1          2 TYPE CHAR(2) UNAL;
      162     6853    1   DCL 1 C_CMD_TBL BASED ALIGNED,          /* COPY COMMAND                       */
      163     6854    1          2 * BIT(36) UNAL,
      164     6855    1          2 FID$ PTR UNAL,
      165     6856    1          2 FID2$ PTR UNAL,
      166     6857    1          2 ONOVER CHAR(4) UNAL,
      167     6858    1          2 SEQNUM UBIN(36) UNAL,
      168     6859    1          2 INCR UBIN(36) UNAL,
      169     6860    1          2 TYPE CHAR(2) UNAL;
      170     6861    1   DCL 1 M_CMD_TBL BASED ALIGNED,          /* MERGE COMMAND                      */
      171     6862    1          2 * BIT(36) UNAL,
      172     6863    1          2 FID$ PTR UNAL,
      173     6864    1          2 LO_SEQNUM,
      174     6865    1             3 KEY UBIN WORD UNAL ,
      175     6866    1          2 HI_SEQNUM ,
      176     6867    1             3 KEY UBIN WORD UNAL ,
      177     6868    1          2 ONOVER UBIN WORD UNAL,
      178     6869    1          2 FID2$ PTR UNAL,
      179     6870    1          2 LO_SEQNUM2 ,
      180     6871    1             3 KEY UBIN WORD UNAL ,
      181     6872    1          2 HI_SEQNUM2,
      182     6873    1             3 KEY UBIN WORD UNAL ,
      183     6874    1          2 INCR UBIN(36) UNAL;
      184     6875    1   DCL 1 BP_CMD_TBL BASED ALIGNED,
      185     6876    1          2 * BIT(36) UNAL,
      186     6877    1          2 TEXT CHAR(4) UNAL;
      187     6878    1   DCL 1 TA_CMD_TBL BASED ALIGNED,
      188     6879    1          2 * BIT(36) UNAL,
      189     6880    1          2 TABS(0:30) UBIN(9) UNAL,
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:7    
      190     6881    1          2 NUM_TABS UBIN(9) UNAL ;
      191     6882    1   DCL 1 TYPE_CMD_TBL BASED ALIGNED,
      192     6883    1          2 * BIT(36) UNAL,
      193     6884    1          2 CODE CHAR(2);
      194     6885    1   DCL 1 FILE_CMD_TBL BASED ALIGNED,
      195     6886    1          2 * BIT(36) UNAL,
      196     6887    1          2 CODE UBIN WORD ;
      197     6888    1   DCL 1 VE_CMD_TBL BASED ALIGNED,
      198     6889    1          2 * BIT(36) UNAL,
      199     6890    1          2 TYPE UBIN WORD UNAL;
      200     6891    1   DCL 1 DIR_CMD_TBL BASED ALIGNED ,       /* DIRECTORY                          */
      201     6892    1          2 * BIT(36) UNAL ,
      202     6893    1          2 CODE UBIN WORD UNAL ,
      203     6894    1          2 ACCT CHAR(8) UNAL ,
      204     6895    1          2 PSN CHAR(6) UNAL ;
      205     6896        /**/
      206     6897        %B$TCB;
      207     6900        %B$ALT;
      208     6908    1   DCL 1 VARY$STRC BASED ALIGNED ,
      209     6909    1          2 CNT UBIN BYTE UNAL ,
      210     6910    1          2 TXT CHAR(VARY$STRC.CNT) UNAL ;
      211     6911        /**/
      212     6912        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:8    
      213     6913        /***********************************************************************/
      214     6914        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      215     6915        /**********************************************************************/
      216     6916    1   DCL VEH$ALL_HELP ENTRY ;
      217     6917    1   DCL VEX$CLMN_DFLT ENTRY;
      218     6918    1   DCL VEX$CHECK_CUTOFF ENTRY ALTRET ;
      219     6919    1   DCL VEX$DELREC ENTRY(3) ALTRET;
      220     6920    1   DCL VEX$ERROR ENTRY(2) ALTRET;
      221     6921    1   DCL VEX$ERRNEXT ENTRY ALTRET;
      222     6922    1   DCL VEX$ERRMAX ENTRY ALTRET;
      223     6923    1   DCL VEX$FID_2_FPT ENTRY(3) ALTRET;
      224     6924    1   DCL VEX$READ_RANDOM ENTRY(1) ALTRET;
      225     6925    1   DCL VEX$READ_SEQUEN ENTRY ALTRET;
      226     6926    1   DCL VEX$READ_TERM_REC ENTRY(3) ALTRET;
      227     6927    1   DCL VEX$SET_PROMPT ENTRY(1);
      228     6928    1   DCL VEX$SET_SUB_BUF ENTRY(2);
      229     6929    1   DCL VEX$SEQNUM_TEXT ENTRY(2);
      230     6930    1   DCL VEX$TYPE_REC ENTRY(1);
      231     6931    1   DCL VEX$WRITE_REC ENTRY(2) ALTRET;
      232     6932    1   DCL X$HELP ENTRY(1) ALTRET ;
      233     6933        /********************************************************************/
      234     6934        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      235     6935        /********************************************************************/
      236     6936        /**/
      237     6937    1   DCL M$SI DCB;
      238     6938    1   DCL M$FILE DCB;                         /* READ EDIT FILE                     */
      239     6939    1   DCL M$FILE2 DCB;                        /* FOR MERGE AND COPY                 */
      240     6940    1   DCL M$DO DCB;                           /* ERROR MESSAGES                     */
      241     6941    1   DCL M$ME DCB;
      242     6942        /**/
      243     6943        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:9    
      244     6944        /*****************************************************************/
      245     6945        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      246     6946        /*****************************************************************/
      247     6947        /**/
      248     6948        %INCLUDE VE_FLAGS_R;
      249     6999        %P_PCB (STCLASS = SYMREF) ;
      250     7198        /**/
      251     7199    1   DCL 1 P_ALLCMDS SYMREF ALIGNED,         /* NODE MACRO                         */
      252     7200    1          2 TYPE UBIN(9) UNAL,
      253     7201    1          2 NSUBNDS UBIN(9) UNAL,
      254     7202    1          2 CODE UBIN(18) UNAL,
      255     7203    1          2 * EPTR UNAL,
      256     7204    1          2 * EPTR UNAL,
      257     7205    1          2 * EPTR UNAL,
      258     7206    1          2 *(0:0) PTR UNAL;
      259     7207        /**/
      260     7208    1   DCL B$TCB$ PTR SYMREF;                  /* POINTER TO TCB                     */
      261     7209    1   DCL REC_BUF CHAR(PC_RECSIZE#) SYMREF;
      262     7210    1   DCL TEMP_BUF CHAR(PC_RECSIZE#) SYMREF;
      263     7211    1   DCL CMD_BUF CHAR(256) SYMREF;
      264     7212    1   DCL 1 TYPE_BUF SYMREF,
      265     7213    1          2 VFC CHAR(1) CALIGNED,
      266     7214    1          2 TEXT CHAR(PC_DISPRECSIZE#) CALIGNED;
      267     7215    1   DCL 1 SUB_BUF_1 SYMREF,
      268     7216    1          2 COUNT UBIN(9) UNAL,
      269     7217    1          2 TEXT CHAR(31) UNAL;
      270     7218    1   DCL 1 SUB_BUF_2 SYMREF,
      271     7219    1          2 COUNT UBIN(9) UNAL,
      272     7220    1          2 TEXT CHAR(31) UNAL;
      273     7221    1   DCL 1 SUB_BUF_3 SYMREF,
      274     7222    1          2 COUNT UBIN(9) UNAL,
      275     7223    1          2 TEXT CHAR(31) UNAL;
      276     7224    1   DCL SEQ_TEXT_BUF CHAR(9)  SYMREF;
      277     7225    1   DCL 1 CURR_FILE_NAME SYMREF,            /* Remember the FID being edited from*/
      278     7226    1          2 COUNT UBIN(9) CALIGNED,        /* before the COMMAND was executed   */
      279     7227    1          2 TEXT CHAR(31) CALIGNED;        /* that changed it.                  */
      280     7228    1   DCL   CURR_FILE_ACCT CHAR(8) SYMREF ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:10   
      281     7229    1   DCL   CURR_FILE_PASS CHAR(8) SYMREF ;
      282     7230    1   DCL 1 CURR_FILE_SN  SYMREF,
      283     7231    1          2 COUNT UBIN WORD,
      284     7232    1          2 SN CHAR(6) CALIGNED;
      285     7233    1   DCL 1 OPEN_FILE_NAME SYMREF,            /* EDIT FILE NAME                     */
      286     7234    1          2 COUNT UBIN(9) UNAL,
      287     7235    1          2 TEXT CHAR(31) UNAL;
      288     7236    1   DCL OPEN_FILE_ACCT CHAR(8) SYMREF;      /* EDIT FILE ACCT                     */
      289     7237    1   DCL OPEN_FILE_PASS CHAR(8) SYMREF;      /* EDIT FILE PASSWORD                 */
      290     7238    1   DCL 1 OPEN_FILE_SN SYMREF,
      291     7239    1          2 COUNT SBIN WORD,
      292     7240    1          2 SN CHAR(6) UNAL;
      293     7241    1   DCL 1 ERR_CODE SYMREF,
      294     7242    1          2 FCG_MID BIT(18) UNAL,
      295     7243    1          2 MON BIT(1) UNAL,
      296     7244    1          2 ERR# UBIN(14) UNAL,
      297     7245    1          2 SEV UBIN(3) UNAL;
      298     7246    1   DCL TYPE_CODE CHAR(2) SYMREF;
      299     7247    1   DCL SSE_INIT$ PTR SYMREF;
      300     7248    1   DCL REC_SIZE UBIN(36) SYMREF;           /* CHARACTER COUNT OF REC_BUF         */
      301     7249    1   DCL RP_REC_SIZE UBIN WORD SYMREF;       /* RECORD SIZE READ - FOR RP          */
      302     7250    1   DCL DVBYTE BIT(36) SYMREF ;
      303     7251    1   DCL LO_SRCH_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF SEARCH RANGE          */
      304     7252    1   DCL HI_SRCH_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF SEARCH RANGE         */
      305     7253    1   DCL LO_EXEC_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF CHANGEABLE RANGE      */
      306     7254    1   DCL HI_EXEC_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF CHANGEABLE RANGE     */
      307     7255    1   DCL LO_SEQNUM UBIN(36) SYMREF ;         /* LOW LIMIT OF RECORD RANGE          */
      308     7256    1   DCL HI_SEQNUM UBIN(36) SYMREF ;         /* HIGH LIMIT OF RECORD RANGE         */
      309     7257    1   DCL EXEC_SEQNUM UBIN(36) SYMREF;        /* CURRENT RECORD BEING USED          */
      310     7258    1   DCL LIMIT_SEQNUM UBIN(36) SYMREF;       /* TEMP FOR SEARCHING RANGES          */
      311     7259    1   DCL CP_SEQNUM UBIN WORD SYMREF;         /* CP,CI BASE                         */
      312     7260    1   DCL INCR UBIN(36) SYMREF;               /* INCREMENT                          */
      313     7261    1   DCL DFLT_INCR UBIN(36) SYMREF ;
      314     7262    1   DCL LAST_KEY UBIN(36) SYMREF;           /* KEY OF LAST RECORD READ            */
      315     7263    1   DCL READ_KEY UBIN(36) SYMREF;           /* KEY TO BE USED TO READ RECORD      */
      316     7264    1   DCL SAVE_KEY UBIN(36) SYMREF;           /* KEY USED FOR TEMP IN MERGE         */
      317     7265    1   DCL TEMP_CLMN UBIN(36) SYMREF;          /* TEMP CELL FOR COLUMN NUM.          */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:11   
      318     7266    1   DCL TEMP_COUNT UBIN(36) SYMREF;
      319     7267    1   DCL CMD_CODE UBIN(36) SYMREF;           /* CODE FOR CURRENT COMMAND           */
      320     7268    1   DCL LAST_CMD UBIN(36) SYMREF;           /* SAVED CMD FOR ?? COMMAND           */
      321     7269    1   DCL REC_COUNT UBIN(36) SYMREF;          /* COUNT OF RECORDS OPERATED ON       */
      322     7270    1   DCL I UBIN(36) SYMREF;                  /* INDEX                              */
      323     7271    1   DCL M$FILE_NUM UBIN(36) SYMREF ;
      324     7272        /**/
      325     7273        %VLP_TAB (FPTN = TAB_VLP,
      326     7274                  STCLASS = SYMREF);
      327     7288        %VLP_TAB (FPTN = SAVE_TAB_VLP,
      328     7289                  STCLASS = SYMREF);
      329     7303    1   DCL M$FILE2_NUM UBIN(36) SYMREF ;
      330     7304    1   DCL NUM_TABS UBIN(36) SYMREF;
      331     7305    1   DCL VERIFY_TYPE UBIN WORD SYMREF;       /* VERIFY COMMAND CODE                */
      332     7306        /**/
      333     7307    1   DCL P$ PTR SYMREF;                      /* TEMP PTR                           */
      334     7308    1   DCL M$SI$ PTR SYMREF;
      335     7309    1   DCL M$UC$ PTR SYMREF;
      336     7310    1   DCL M$FILE$ PTR SYMREF;                 /* POINTER TO M$FILE                  */
      337     7311    1   DCL M$FILE2$ PTR SYMREF;
      338     7312    1   DCL CMD$ PTR SYMREF;                    /* POINTER TO RUN CMD_TBL             */
      339     7313    1   DCL SSE$ PTR SYMREF;
      340     7314    1   DCL COPYDS_PTR$ PTR SYMREF;
      341     7315        /**/
      342     7316    1   DCL 1 SSE_PARAM SYMREF,                 /* STRING SELECTION PARAM             */
      343     7317    1          2 FLAGS,
      344     7318    1             3 CLMNFLAG BIT(1) UNAL,
      345     7319    1             3 NOTFLAG BIT(1) UNAL,
      346     7320    1             3 ANDFLAG BIT(1) UNAL,
      347     7321    1             3 ORFLAG BIT(1) UNAL,
      348     7322    1             3 EORFLAG BIT(1) UNAL,
      349     7323    1             3 * BIT(13) UNAL,
      350     7324    1          2 J SBIN HALF UNAL,
      351     7325    1          2 PTR$ PTR UNAL;
      352     7326    1   DCL MAX_SEQNUM UBIN(36) SYMREF ;
      353     7327    1   DCL MAX_CLMN UBIN(36) SYMREF ;
      354     7328    1   DCL Y003 UBIN(36) SYMREF ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:12   
      355     7329    1   DCL SEQNUM_ONE UBIN(36) SYMREF ;
      356     7330    1   DCL B$JIT$ PTR SYMREF ;
      357     7331        /********************************************************************/
      358     7332        /*   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   */
      359     7333        /********************************************************************/
      360     7334    1   DCL STATUS_FIELDS SBIN AUTO;
      361     7335    1   DCL REPSTATUS(0:NUMSTATUSOPTS) BIT(1) ALIGNED AUTO;
      362     7336    1   DCL LINELEN SBIN AUTO;
      363     7337    1   DCL TEMP_STR CHAR(80) AUTO;
      364     7338        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:13   
      365     7339        /*****************************************************************************/
      366     7340        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      367     7341        /*****************************************************************************/
      368     7342        /**/
      369     7343    1   VEF$EXEC_BP: ENTRY;
      370     7344        /**/
      371     7345    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.BPFLAG = TRUE;
      372     7346    1        ELSE FLAGS.BPFLAG = FALSE;
      373     7347    1        RETURN;
      374     7348        /**/
      375     7349        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:14   
      376     7350        /**/
      377     7351    1   VEF$EXEC_BUILD: ENTRY;
      378     7352        /**/
      379     7353    2        IF (FLAGS.EDIT_MODE) THEN DO;
      380     7354    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_BUILD_CLOSE_ERR1) ;
      381     7355    2   EXEC_BUILD_CLOSE_ERR1:
      382     7356    2           CALL VEX$ERROR(E$E_EDITSTOP,1);
      383     7357    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;
      384     7358    2           FLAGS.EDIT_MODE = FALSE;
      385     7359    2           FLAGS.CONSEC_MODE = FALSE;
      386     7360    2           FLAGS.REL_MODE = FALSE;
      387     7361    2           END;
      388     7362        /**/
      389     7363        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      390     7364                 MESSAGE:  EDIT stopped
      391     7365                 DESCRIPTION: The file currently open has been closed.
      392     7366        */
      393     7367        /**/
      394     7368    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */
      395     7369    1        LO_SEQNUM = Y003;
      396     7370    1        HI_SEQNUM = MAX_SEQNUM;
      397     7371    1        P$ = CMD$ -> B_CMD_TBL.FID$;
      398     7372        /**/
      399     7373    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET (EXEC_BUILD_ERR2);
      400     7374        /**/
      401     7375    1        OPEN_FILE_FPT.V.FUN# = %CREATE#;
      402     7376    1        OPEN_FILE_FPT.V.EXIST# = %ERROR#;
      403     7377    1        OPEN_FILE_FPT.V.TYPE# = CMD$ -> B_CMD_TBL.TYPE;
      404     7378        /**/
      405     7379    1        CALL M$OPEN (OPEN_FILE_FPT) ALTRET (EXEC_BUILD_ERR);
      406     7380        /**/
      407     7381    1        FLAGS.EDIT_MODE= TRUE;
      408     7382    1        DVBYTE = '0'B ;
      409     7383    1        EXEC_SEQNUM = CMD$ -> B_CMD_TBL.SEQNUM;
      410     7384    1        INCR = CMD$ -> B_CMD_TBL.INCR;
      411     7385        /**/
      412     7386    2        DO WHILE (EXEC_SEQNUM <= MAX_SEQNUM); /* READ INPUT                   */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:15   
      413     7387    2           CALL VEX$SEQNUM_TEXT(EXEC_SEQNUM);
      414     7388    2           CALL VEX$SET_PROMPT(PR_SEQNUM);
      415     7389    2           CALL VEX$READ_TERM_REC(REC_BUF,REC_SIZE,SIZEC(REC_BUF))
      416     7390    2              ALTRET (EXEC_BUILD_ERR2);
      417     7391    3           IF (REC_SIZE = 0) THEN DO;
      418     7392    4              IF (EXEC_SEQNUM ~= CMD$ -> B_CMD_TBL.SEQNUM) THEN DO;
      419     7393    4                 EXEC_SEQNUM = EXEC_SEQNUM - INCR;
      420     7394    4                 LO_SEQNUM = EXEC_SEQNUM;
      421     7395    4                 HI_SEQNUM = EXEC_SEQNUM;
      422     7396    4                 LAST_KEY = EXEC_SEQNUM;
      423     7397    4                 RETURN;
      424     7398    4                 END;
      425     7399        /**/
      426     7400    3              FLAGS.EDIT_MODE = FALSE;     /* RELEASE FILE - NO RECORDS          */
      427     7401    3              CALL M$CLOSE(CLOSEREL_FPT) ALTRET(EXEC_BUILD_ERR);
      428     7402    3              RETURN;
      429     7403    3              END;
      430     7404        /**/
      431     7405    2           RP_REC_SIZE = REC_SIZE;
      432     7406    2           CALL VEX$WRITE_REC(M$FILE_NUM,EXEC_SEQNUM) ALTRET(EXEC_BUILD_ERR2);
      433     7407    3           IF INCR = 0 THEN DO;
      434     7408    3              LO_SEQNUM = EXEC_SEQNUM ;
      435     7409    3              HI_SEQNUM = EXEC_SEQNUM ;
      436     7410    3              LAST_KEY = EXEC_SEQNUM ;
      437     7411    3              RETURN ;
      438     7412    3              END ;                        /* THEN DO                            */
      439     7413    2           EXEC_SEQNUM= EXEC_SEQNUM+INCR;
      440     7414    2           END;
      441     7415        /**/
      442     7416    1        CALL VEX$ERROR(E$E_MAXSEQ,1);      /* MAX SEQ EXCEEDED                   */
      443     7417    1        RETURN;
      444     7418        /**/
      445     7419        /*E*     ERROR:    VEE-E$E_MAXSEQ-0
      446     7420                 MESSAGE:  Maximum sequence number exceeded
      447     7421                 MESSAGE1: The sequence number of the previous record plus
      448     7422                           the specified increment exceeds 99999.999
      449     7423                 DESCRIPTION: EDIT cannot prompt for another input record
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:16   
      450     7424                           because the sequence number has gotten too large.
      451     7425        */
      452     7426        /**/
      453     7427        /*E*     ERROR:    VEE-E$E_MAXSEQ-0
      454     7428                 DESCRIPTION: EDIT cannot prompt for another input record
      455     7429                           because the sequence number has gotten too large.
      456     7430        */
      457     7431        /**/
      458     7432    1   EXEC_BUILD_ERR:
      459     7433    2        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$CREATERR) THEN DO;
      460     7434    2           CALL VEX$ERROR (E$E_CANTBLD,3);
      461     7435    2           RETURN;
      462     7436    2           END;
      463     7437        /**/
      464     7438        /*E*     ERROR:    VEE-E$E_CANTBLD-0
      465     7439                 MESSAGE:  Can't BUILD - file %%FN %exists
      466     7440                 MESSAGE1: You can't create file %%FN %- it already exists
      467     7441                 DESCRIPTION: An attempt was made to BUILD an existing file.
      468     7442        */
      469     7443        /**/
      470     7444    1        CALL VEX$ERROR(0,3);
      471     7445    1   EXEC_BUILD_ERR2:
      472     7446    1        RETURN;
      473     7447        /**/
      474     7448        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:17   
      475     7449        /**/
      476     7450    1   VEF$EXEC_COPY: ENTRY;
      477     7451        /**/
      478     7452    2        IF (FLAGS.EDIT_MODE) THEN DO;
      479     7453    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR1) ;
      480     7454    2   EXEC_COPY_CLOSE_ERR1:
      481     7455    2           CALL VEX$ERROR(E$E_EDITSTOP,1);
      482     7456    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;
      483     7457    2           FLAGS.EDIT_MODE=FALSE;
      484     7458    2           FLAGS.CONSEC_MODE = FALSE;
      485     7459    2           FLAGS.REL_MODE = FALSE;
      486     7460    2           END;
      487     7461        /**/
      488     7462        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      489     7463                 DESCRIPTION: The open file has been closed.
      490     7464        */
      491     7465        /**/
      492     7466    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */
      493     7467    1        LO_SEQNUM = Y003;
      494     7468    1        HI_SEQNUM = MAX_SEQNUM;
      495     7469        /**/
      496     7470    1        P$ = CMD$ -> C_CMD_TBL.FID$;       /* SET UP OPPEN OF INPUT FILE         */
      497     7471    1        DS_RESULTS = FALSE;                /* GET NEXT DS                        */
      498     7472    1        CALL M$GDS(COPYDS_FPT) ALTRET (EXEC_COPY2_ERR);
      499     7473    1        OPEN_FILE_FPT.FPARAM_ = DS_RESULTS;
      500     7474    1        OPEN_FILE2_FPT.IFPARAM_ = DS_RESULTS;
      501     7475    1        COPYDS_PTR$ = DS_RESULTS.PTR$;
      502     7476    1        CURR_FILE_NAME = OPEN_FILE_NAME; /* Remember Current name over the COPY */
      503     7477    1        CURR_FILE_SN = OPEN_FILE_SN;
      504     7478    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;
      505     7479    1        CURR_FILE_PASS = OPEN_FILE_PASS;
      506     7480    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET (EXEC_COPY_ERR);
      507     7481    1        OPEN_FILE_FPT.V.FUN# = %IN#;
      508     7482    1        CALL M$OPEN(OPEN_FILE_FPT) ALTRET (EXEC_COPY2_ERR);
      509     7483    2        IF (M$FILE$ -> F$DCB.ORG ~= %KEYED#) THEN DO;
      510     7484    2           IF ((M$FILE$ -> F$DCB.ORG = %CONSEC#)OR
      511     7485    2              (M$FILE$ -> F$DCB.ORG = %UR#)OR
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:18   
      512     7486    3              (M$FILE$ -> F$DCB.ORG = %INDEXED#)) THEN DO;
      513     7487    3              FLAGS.CONSEC_MODE = TRUE;
      514     7488    3              LAST_KEY = Y003;
      515     7489    3              END;
      516     7490    2           ELSE IF (M$FILE$ -> F$DCB.ORG = %RELATIVE#) THEN FLAGS.REL_MODE = TRUE;
      517     7491        /**/
      518     7492    3              ELSE DO;                     /* CANT COPY                          */
      519     7493    3                 CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR2) ;
      520     7494    3   EXEC_COPY_CLOSE_ERR2:
      521     7495    3                 CALL M$FDS (COPYDS_FPT);
      522     7496    3                 CALL VEX$ERROR(E$E_CANTEDIT,3);
      523     7497    3                 RETURN;
      524     7498    3                 END;
      525     7499    2           END;
      526     7500        /**/
      527     7501    1        P$ = CMD$ -> C_CMD_TBL.FID2$;      /* SET UP OUTPUT FPT                  */
      528     7502    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE2_FPT,0) ALTRET (EXEC_COPY_ERR);
      529     7503    1        OPEN_FILE2_FPT.V.FUN# = %CREATE#;
      530     7504    1        IF (CMD$ -> C_CMD_TBL.TYPE ~= ' ') THEN OPEN_FILE2_FPT.V.TYPE# =
      531     7505    1              CMD$ -> C_CMD_TBL.TYPE;
      532     7506    1        IF (CMD$ -> C_CMD_TBL.ONOVER = 'ON') THEN
      533     7507    1           OPEN_FILE2_FPT.V.EXIST# = %ERROR#;
      534     7508    1        ELSE OPEN_FILE2_FPT.V.EXIST# = %NEWFILE#; /* DONT TRASH 'ON' FILE     */
      535     7509    1        CALL M$OPEN(OPEN_FILE2_FPT) ALTRET (EXEC_COPY2_ERR);
      536     7510        /**/
      537     7511    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);
      538     7512    1        OPEN_FILE_FPT.IFPARAM_ = VECTOR(NIL);
      539     7513        /**/
      540     7514    1        INCR = CMD$ -> C_CMD_TBL.INCR;
      541     7515    2        IF INCR = 0 THEN DO ;
      542     7516    2           CALL VEX$ERROR( E$E_BADINCR,3);
      543     7517    2           GOTO EXEC_COPY_ERR ;
      544     7518    2           END ;                           /* THEN DO                            */
      545     7519        /**/
      546     7520        /*E*     ERROR:    VEE-E$E_BADINCR-0
      547     7521                 MESSAGE:  Illegal increment.
      548     7522                 DESCRIPTION: An increment of 0 was input for COPY command.
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:19   
      549     7523        */
      550     7524        /**/
      551     7525    1        EXEC_SEQNUM = CMD$ -> C_CMD_TBL.SEQNUM;
      552     7526    1        CALL VEX$ERROR(E$E_COPYING,1);
      553     7527        /**/
      554     7528        /*E*     ERROR:    VEE-E$E_COPYING-0
      555     7529                 MESSAGE:  Copying
      556     7530                 DESCRIPTION: The COPY operation has been started.
      557     7531        */
      558     7532        /**/
      559     7533    1        CALL VEX$READ_SEQUEN ALTRET (EXEC_COPY_ERR); /* READ FIRST RECORD     */
      560     7534    2        IF (EXEC_SEQNUM > MAX_SEQNUM) THEN DO WHILE (~FLAGS.EOF);
              7534                 /* SAME SEQ. NUMBERS */
      561     7535    2           CALL VEX$WRITE_REC(M$FILE2_NUM,LAST_KEY) ALTRET (EXEC_COPY_ERR);
      562     7536    2           CALL VEX$READ_SEQUEN ALTRET (EXEC_COPY_ERR);
      563     7537    2           END;
      564     7538    2        ELSE DO WHILE (~FLAGS.EOF);        /* RENUMBER                           */
      565     7539    2           CALL VEX$WRITE_REC (M$FILE2_NUM,EXEC_SEQNUM) ALTRET
      566     7540    2              (EXEC_COPY_ERR);
      567     7541    2           CALL VEX$READ_SEQUEN ALTRET (EXEC_COPY_ERR);
      568     7542    2           EXEC_SEQNUM = EXEC_SEQNUM + INCR;
      569     7543    3           IF (EXEC_SEQNUM > MAX_SEQNUM) THEN DO;
      570     7544    3              CALL VEX$ERROR(E$E_MAXSEQ,1);
      571     7545    3              GOTO COPY_CLOSE2 ;
      572     7546    3              END;
      573     7547        /**/
      574     7548        /*E*     ERROR:    VEE-E$E_MAXSEQ-0
      575     7549                 DESCRIPTION: Overran the sequence number limit durring a
      576     7550                           COPY operation.
      577     7551        */
      578     7552    2           END;
      579     7553        /**/
      580     7554    1        CALL VEX$ERROR(E$E_COPYDONE,1);    /* COPY DONE                          */
      581     7555        /**/
      582     7556        /*E*     ERROR:    VEE-E$E_COPYDONE-0
      583     7557                 MESSAGE:  COPY done
      584     7558                 DESCRIPTION: The COPY operation is over.
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:20   
      585     7559        */
      586     7560    1   COPY_CLOSE:
      587     7561    1        CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR3) ;
      588     7562    1   EXEC_COPY_CLOSE_ERR3:
      589     7563    1        CALL M$CLOSE(CLOSE2_FPT) ALTRET(EXEC_COPY_CLOSE_ERR4) ;
      590     7564    2        DO WHILE ('0'B) ;
      591     7565    2   COPY_CLOSE2:
      592     7566    2           CALL M$CLOSE(CLOSEDFLT_FPT) ALTRET(EXEC_COPY_CLOSE_ERR9) ;
      593     7567    2   EXEC_COPY_CLOSE_ERR9:
      594     7568    2           CALL M$CLOSE(CLOSE2DFLT_FPT) ALTRET(EXEC_COPY_CLOSE_ERR4) ;
      595     7569    2           END ;                           /* Do While */
      596     7570    1   EXEC_COPY_CLOSE_ERR4:
      597     7571    1        CALL M$FDS(COPYDS_FPT);
      598     7572        /**/
      599     7573    1        OPEN_FILE_FPT.V.FUN# = %UPDATE#;
      600     7574    1        OPEN_FILE_FPT.ACCT_ = OPEN_FILE2_FPT.ACCT_ ;
      601     7575    1        OPEN_FILE_FPT.PASS_ = OPEN_FILE2_FPT.PASS_ ;
      602     7576    1        CALL M$OPEN (OPEN_FILE_FPT) ALTRET (EXEC_COPY_ERR);
      603     7577    1        FLAGS.EDIT_MODE = TRUE;
      604     7578    1        FLAGS.REL_MODE = FALSE;
      605     7579    1        FLAGS.CONSEC_MODE = FALSE;
      606     7580        /**/
      607     7581    1        RETURN;
      608     7582        /**/
      609     7583    1   EXEC_COPY2_ERR:
      610     7584    2        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$CREATERR) THEN DO;
      611     7585    2           CALL VEX$ERROR(E$E_ONEXTS,3);   /* 'ON' FILE EXISTS                  */
      612     7586    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR5) ;
      613     7587    2   EXEC_COPY_CLOSE_ERR5:
      614     7588    2           CALL M$FDS(COPYDS_FPT);
      615     7589    2           OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);
      616     7590    2           OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);
      617     7591    2           RETURN;
      618     7592    2           END;
      619     7593        /**/
      620     7594        /*E*     ERROR:    VEE-E$E_ONEXTS-0
      621     7595                 MESSAGE:  'ON' file exists
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:21   
      622     7596                 MESSAGE1: Can't COPY - file %%FN %exists
      623     7597                 DESCRIPTION: An attempt was made to COPY 'ON' an
      624     7598                           existing file.
      625     7599        */
      626     7600    1        CALL VEX$ERROR(0,3);
      627     7601    1        OPEN_FILE_NAME = CURR_FILE_NAME;
      628     7602    1   EXEC_COPY_ERR:
      629     7603    1        IF (SUBSTR(CMD$ -> C_CMD_TBL.FID$ -> STR$BUF.TEXT,0,
      630     7604    1           CMD$ -> C_CMD_TBL.FID$ -> STR$BUF.COUNT) =
      631     7605    1           SUBSTR(CMD$ -> C_CMD_TBL.FID2$ -> STR$BUF.TEXT,0,
      632     7606    2           CMD$ -> C_CMD_TBL.FID2$ -> STR$BUF.COUNT)) THEN DO; /* SAME FILE    */
      633     7607    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR6) ;
              7607                    /* DONT TRASH FILE                    */
      634     7608    2   EXEC_COPY_CLOSE_ERR6:
      635     7609    2           CALL M$CLOSE (CLOSE2REL_FPT);
      636     7610    2           IF (OPEN_FILE_FPT.FPARAM_ ~= VECTOR(NIL)) THEN CALL M$FDS(COPYDS_FPT);
      637     7611    2           OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);
      638     7612    2           OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);
      639     7613    2           RETURN;
      640     7614    2           END;
      641     7615        /**/
      642     7616    1        CALL M$CLOSE (CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR7) ;
      643     7617    1   EXEC_COPY_CLOSE_ERR7:
      644     7618    1        CALL M$CLOSE (CLOSE2_FPT) ALTRET(EXEC_COPY_CLOSE_ERR8) ;
      645     7619    1   EXEC_COPY_CLOSE_ERR8:
      646     7620    1        IF (OPEN_FILE_FPT.FPARAM_ ~= VECTOR(NIL)) THEN CALL M$FDS(COPYDS_FPT);
      647     7621    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);
      648     7622    1        OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);
      649     7623    1        RETURN;
      650     7624        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:22   
      651     7625        /**/
      652     7626    1   VEF$EXEC_CR: ENTRY;
      653     7627        /**/
      654     7628    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.CRFLAG = TRUE;
      655     7629    1        ELSE FLAGS.CRFLAG = FALSE;
      656     7630    1        RETURN;
      657     7631        /**/
      658     7632        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:23   
      659     7633        /**/
      660     7634    1   VEF$EXEC_DELETE: ENTRY;
      661     7635        /**/
      662     7636    1        CURR_FILE_NAME = OPEN_FILE_NAME; /* Remember Current name over the DELETE */
      663     7637    1        CURR_FILE_SN = OPEN_FILE_SN;
      664     7638    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;
      665     7639    1        CURR_FILE_PASS = OPEN_FILE_PASS;
      666     7640        /**/
      667     7641    1        P$ = CMD$ -> ED_CMD_TBL.FID$;
      668     7642    1        DELETE_FPT = DELETE_FPT_C;
      669     7643    1        DELETE_FPT.V_ = VECTOR(DELETE_FPT.V);
      670     7644    1        CALL VEX$FID_2_FPT(P$,DELETE_FPT,0) ALTRET (EXEC_DELETE_RET);
      671     7645        /**/
      672     7646    1        IF (CURR_FILE_NAME.TEXT = OPEN_FILE_NAME.TEXT) AND
      673     7647    1           (CURR_FILE_ACCT = OPEN_FILE_ACCT) AND
      674     7648    1           (CURR_FILE_PASS = OPEN_FILE_PASS) AND
      675     7649    2           (CURR_FILE_SN.SN = OPEN_FILE_SN.SN) THEN DO;
      676     7650                 /* DELeting current file must close it first */
      677     7651    3           IF (FLAGS.EDIT_MODE) THEN DO;
      678     7652    3              CALL VEX$ERROR(E$E_EDITSTOP,1);
      679     7653    3              IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;
      680     7654    3              CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_DELETE_CLOSE_ERR1) ;
      681     7655    3   EXEC_DELETE_CLOSE_ERR1:
      682     7656    3              FLAGS.EDIT_MODE = FALSE;
      683     7657    3              FLAGS.CONSEC_MODE = FALSE;
      684     7658    3              FLAGS.REL_MODE = FALSE;
      685     7659    3              END;
      686     7660        /**/
      687     7661        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      688     7662                    DESCRIPTION: The currently open file has been closed.
      689     7663        */
      690     7664        /**/
      691     7665    2           CALL VEX$CLMN_DFLT;             /* RESET SELECTION PARAMETERS         */
      692     7666    2           LO_SEQNUM = Y003;
      693     7667    2           HI_SEQNUM = MAX_SEQNUM;
      694     7668    2           END;                            /* IF DELeting current file */
      695     7669        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:24   
      696     7670    1        CALL M$OPEN(DELETE_FPT) ALTRET (EXEC_DELETE_ERR);
      697     7671    1        CALL VEX$ERROR(E$E_DELETED,1);
      698     7672        /**/
      699     7673        /*E*     ERROR:    VEE-E$E_DELETED-0
      700     7674                 MESSAGE:  Deleted
      701     7675                 DESCRIPTION: The specified file has been deleted.
      702     7676        */
      703     7677    1        GOTO EXEC_DELETE_RET;
      704     7678        /**/
      705     7679    1   EXEC_DELETE_ERR:
      706     7680    1        CALL VEX$ERROR(0,SYSFLAGLEV);
      707     7681    1   EXEC_DELETE_RET:
      708     7682    1        OPEN_FILE_NAME = CURR_FILE_NAME;   /* Restore Current file name after DEL*/
      709     7683    1        OPEN_FILE_SN = CURR_FILE_SN;
      710     7684    1        OPEN_FILE_ACCT = CURR_FILE_ACCT;
      711     7685    1        OPEN_FILE_PASS = CURR_FILE_PASS;
      712     7686    1        RETURN;
      713     7687        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:25   
      714     7688        /**/
      715     7689    1   VEF$EXEC_EDIT: ENTRY;
      716     7690        /**/
      717     7691    2        IF (FLAGS.EDIT_MODE) THEN DO;      /* ALREADY HAVE A FILE OPEN           */
      718     7692    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_EDIT_CLOSE_ERR1) ;
      719     7693    2   EXEC_EDIT_CLOSE_ERR1:
      720     7694    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;
      721     7695    2           FLAGS.EDIT_MODE = FALSE;
      722     7696    2           FLAGS.CONSEC_MODE = FALSE;
      723     7697    2           FLAGS.REL_MODE = FALSE;
      724     7698    2           END;
      725     7699        /**/
      726     7700    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */
      727     7701    1        LO_SEQNUM = Y003;
      728     7702    1        HI_SEQNUM = MAX_SEQNUM;
      729     7703        /**/
      730     7704    1        P$ = CMD$ -> ED_CMD_TBL.FID$;
      731     7705    1        CURR_FILE_NAME =    OPEN_FILE_NAME;/* Remember Current NAME for EDIT*/
      732     7706    1        CURR_FILE_SN = OPEN_FILE_SN;
      733     7707    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;
      734     7708    1        CURR_FILE_PASS = OPEN_FILE_PASS;
      735     7709    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET (EXEC_EDIT_RET);
      736     7710        /**/
      737     7711    1        IF (CMD_CODE = EXAMINECMD) THEN OPEN_FILE_FPT.V.FUN# = %IN#;
      738     7712    1        ELSE OPEN_FILE_FPT.V.FUN# = %UPDATE#;
      739     7713        /**/
      740     7714    1   RETRY_OPEN:
      741     7715    1        CALL M$OPEN(OPEN_FILE_FPT) ALTRET (EXEC_EDIT_ERR);
      742     7716    1        CALL M$TRUNC (TRUNC_FPT);
      743     7717        /**/
      744     7718    2        IF (M$FILE$ -> F$DCB.ORG = %RELATIVE#) THEN DO;
      745     7719    2           FLAGS.REL_MODE = TRUE;
      746     7720    2           CALL VEX$ERROR(E$E_RELFILE,2);
      747     7721    2           END;
      748     7722        /**/
      749     7723        /*E*     ERROR:    VEE-E$E_RELFILE-0
      750     7724                 MESSAGE:  File %%FN %is a relative file
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:26   
      751     7725                 DESCRIPTION: INFORM USER ABOUT RELATIVE FILE    */
      752     7726        /**/
      753     7727    1        ELSE IF ((M$FILE$ -> F$DCB.ORG = %CONSEC#)OR
      754     7728    1              (M$FILE$ -> F$DCB.ORG = %UR#)OR
      755     7729    2              (M$FILE$ -> F$DCB.ORG = %INDEXED#)) THEN DO;
      756     7730    2              IF (M$FILE$ -> F$DCB.ORG = %UR#) THEN /* POSIT. UR FILE TO BEGINING */
      757     7731    2                 CALL M$PFIL (PFIL_FPT);
      758     7732    2              FLAGS.CONSEC_MODE = TRUE;
      759     7733    2              FLAGS.RPFLAG = TRUE;
      760     7734    2              LAST_KEY = Y003;
      761     7735    2              IF ((M$FILE$ -> F$DCB.FFLG.DELR)OR
      762     7736    2                 (M$FILE$ -> F$DCB.FFLG.WNEW)OR
      763     7737    2                 (M$FILE$ -> F$DCB.FFLG.UPD)) THEN
      764     7738    2                 CALL VEX$ERROR(E$E_NOTKEYED,3); /* NOT INPUT ONLY            */
      765     7739    2              END;
      766     7740        /**/
      767     7741        /*E*     ERROR:    VEE-E$E_NOTKEYED-0
      768     7742                 MESSAGE:  File %%FN %is not a keyed file - limited updating - RP mode set
      769     7743                 MESSAGE1: A consecutive, unit record or indexed file has been
      770     7744                           opened. You may alter records or add to the end of the
      771     7745                           file, however no insert or delete type commands are
      772     7746                           allowed. Also RP mode is ON and may not be turned off.
      773     7747                 DESCRIPTION: A request was made to edit a consec file --    */
      774     7748        /**/
      775     7749    2           ELSE IF (M$FILE$ -> F$DCB.ORG ~= %KEYED#) THEN DO;
      776     7750    2                 CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_EDIT_CLOSE_ERR2) ;
      777     7751    2   EXEC_EDIT_CLOSE_ERR2:
      778     7752    2                 CALL VEX$ERROR(E$E_CANTEDIT,3);
      779     7753    2                 RETURN;
      780     7754    2                 END;
      781     7755        /*E*     ERROR:    VEE-E$E_CANTEDIT-0
      782     7756                 MESSAGE: Cannot EDIT file %%FN %
      783     7757                 MESSAGE1: File %%FN %is not a keyed,consecutive,relative,indexed,
      784     7758                           or unit record type file. EDIT cannot help you with it.
      785     7759                 DESCRIPTION: FILE IS NOT EDIT FORMAT - FORGET IT  */
      786     7760        /**/
      787     7761    2        IF (CMD_CODE ~= EXAMINECMD) THEN DO;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:27   
      788     7762    2           IF ((NOT(M$FILE$ -> F$DCB.FFLG.DELR))AND
      789     7763    2              (NOT(M$FILE$ -> F$DCB.FFLG.WNEW))AND
      790     7764    3              (NOT(M$FILE$ -> F$DCB.FFLG.UPD))) THEN DO;
      791     7765    3              CALL VEX$ERROR(E$E_INONLY,1);
      792     7766    3              END;
      793     7767        /**/
      794     7768        /*E*     ERROR:    VEE-E$E_INONLY-0
      795     7769                 MESSAGE:  File %%FN %is open input - cannot update
      796     7770                 DESCRIPTION: An attempt was made to edit a file that the
      797     7771                           user doesn't have write access to.
      798     7772        */
      799     7773    3           ELSE DO;
      800     7774    3              IF ~(M$FILE$ -> F$DCB.FFLG.DELR) THEN /* CANT DELETE RECORDS    */
      801     7775    3                 CALL VEX$ERROR(E$E_CANTDEL,ADDR(NIL));
      802     7776        /**/
      803     7777        /*E*     ERROR:    VEE-E$E_CANTDEL-0
      804     7778                 MESSAGE:  You are not allowed to delete records from this file.
      805     7779                 DESCRIPTION: Delete record access is denied.      */
      806     7780        /**/
      807     7781    3              IF ~(M$FILE$ -> F$DCB.FFLG.WNEW) THEN /* CANT WRITE NEW RECORDS */
      808     7782    3                 CALL VEX$ERROR(E$E_CANTWNEW,ADDR(NIL));
      809     7783        /**/
      810     7784        /*E*     ERROR:    VEE-E$E_CANTWNEW-0
      811     7785                 MESSAGE:  You cannot add records to this file
      812     7786                 DESCRIPTION: New record access denied.  */
      813     7787        /**/
      814     7788    3              IF ~(M$FILE$ -> F$DCB.FFLG.UPD) THEN
              7788                       /* CANT OVERWRITE EXISTING RECORDS */
      815     7789    3                 CALL VEX$ERROR(E$E_CANTUPDAT,ADDR(NIL));
      816     7790        /**/
      817     7791        /*E*     ERROR:    VEE-E$E_CANTUPDAT-0
      818     7792                 MESSAGE:  You cannot overwrite existing records in this file
      819     7793                 DESCRIPTION: UPD  access denied.        */
      820     7794    3              END;
      821     7795    2           END;
      822     7796    1        FLAGS.EDIT_MODE = TRUE;
      823     7797    1        RETURN;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:28   
      824     7798        /**/
      825     7799    1   EXEC_EDIT_ERR:
      826     7800    1        IF (CMD_CODE = EDITCMD)AND
      827     7801    1           (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$FILEBUSY)AND
      828     7802    2           (OPEN_FILE_FPT.V.FUN# ~= %IN#) THEN DO;
      829     7803    2           OPEN_FILE_FPT.V.FUN# = %IN#;
      830     7804    2           GOTO RETRY_OPEN;
      831     7805    2           END;
      832     7806    1        CALL VEX$ERROR(0,SYSFLAGLEV);
      833     7807    1   EXEC_EDIT_RET:
      834     7808    1        RETURN;
      835     7809        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:29   
      836     7810        /**/
      837     7811    1   VEF$EXEC_END: ENTRY;
      838     7812        /**/
      839     7813    1        CALL M$CLOSE (CLOSE_FPT) ALTRET(EXEC_END_CLOSE_ERR1) ;
      840     7814    1   EXEC_END_CLOSE_ERR1:
      841     7815    1        CALL M$CLOSE (CLOSE2_FPT) ALTRET(EXEC_END_CLOSE_ERR2) ;
      842     7816    1   EXEC_END_CLOSE_ERR2:
      843     7817    1        CALL M$CLOSE(CLOSE_ME_FPT);
      844     7818    1        CALL M$CLOSE (CLOSE_DO_FPT);
      845     7819    1        TAB_VLP = SAVE_TAB_VLP;
      846     7820    1        CALL M$DEVICE(TAB_FPT);
      847     7821    1        CALL M$EXIT;
      848     7822        /**/
      849     7823        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:30   
      850     7824        /**/
      851     7825    1   VEF$EXEC_MERGE: ENTRY;
      852     7826        /**/
      853     7827    2        IF (FLAGS.EDIT_MODE) THEN DO;      /* CLOSE OPEN FILE                    */
      854     7828    2           CALL VEX$ERROR(E$E_EDITSTOP,1); /* EDIT STOPPED...*/
      855     7829    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR1) ;
      856     7830    2   EXEC_MERGE_CLOSE_ERR1:
      857     7831    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;
      858     7832    2           FLAGS.EDIT_MODE=FALSE;
      859     7833    2           FLAGS.CONSEC_MODE = FALSE;
      860     7834    2           FLAGS.REL_MODE = FALSE;
      861     7835    2           END;
      862     7836        /**/
      863     7837        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      864     7838                 DESCRIPTION: The currently open file has been closed.
      865     7839        */
      866     7840        /**/
      867     7841    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */
      868     7842    1        LO_SEQNUM = Y003;
      869     7843    1        HI_SEQNUM = MAX_SEQNUM;
      870     7844        /**/
      871     7845    1        P$ = CMD$ -> M_CMD_TBL.FID$;
      872     7846    1        CURR_FILE_NAME = OPEN_FILE_NAME;/* Remember Current name over the MERGE */
      873     7847    1        CURR_FILE_SN = OPEN_FILE_SN;
      874     7848    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;
      875     7849    1        CURR_FILE_PASS = OPEN_FILE_PASS;
      876     7850    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET(EXEC_MERGE_RET);
      877     7851    1        OPEN_FILE_FPT.V.FUN# = %IN#;
      878     7852    1        DS_RESULTS = FALSE;
      879     7853    1        CALL M$GDS(COPYDS_FPT) ALTRET (EXEC_MERGE_ERR);
      880     7854    1        OPEN_FILE_FPT.FPARAM_ = DS_RESULTS;
      881     7855    1        OPEN_FILE2_FPT.IFPARAM_ = DS_RESULTS;
      882     7856    1        COPYDS_PTR$ = DS_RESULTS.PTR$;
      883     7857    1        CALL M$OPEN(OPEN_FILE_FPT) ALTRET (EXEC_MERGE_ERR); /* OPEN INPUT FILE */
      884     7858    2        IF (M$FILE$ -> F$DCB.ORG ~= %KEYED#) THEN DO;
      885     7859    2           IF (M$FILE$ -> F$DCB.ORG = %CONSEC#)OR
      886     7860    2              (M$FILE$ -> F$DCB.ORG = %UR#)OR
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:31   
      887     7861    3              (M$FILE$ -> F$DCB.ORG = %INDEXED#) THEN DO;
      888     7862    3              FLAGS.CONSEC_MODE = TRUE;
      889     7863    3              LAST_KEY = Y003;
      890     7864    3              END;
      891     7865    2           ELSE IF (M$FILE$ -> F$DCB.ORG = %RELATIVE#) THEN FLAGS.REL_MODE = TRUE;
      892     7866        /**/
      893     7867    3              ELSE DO;                     /* CANT MERGE                         */
      894     7868    3                 CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR2) ;
      895     7869    3   EXEC_MERGE_CLOSE_ERR2:
      896     7870    3                 CALL VEX$ERROR(E$E_CANTEDIT,3);
      897     7871    3                 RETURN;
      898     7872    3                 END;
      899     7873    2           END;
      900     7874        /**/
      901     7875    1        P$ = CMD$ -> M_CMD_TBL.FID2$;
      902     7876    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE2_FPT,0) ALTRET(EXEC_MERGE_RET);
      903     7877    2        IF (CMD$ -> M_CMD_TBL.ONOVER = %OLDFILE#) THEN DO;
      904     7878    2           OPEN_FILE2_FPT.V.FUN# = %IN#;
      905     7879    2           OPEN_FILE2_FPT.V.OPER.TEST# = '1'B;
      906     7880    2           CALL M$OPEN(OPEN_FILE2_FPT)     /* TEST OPEN to see if EXISTs */
      907     7881    3           WHENALTRETURN DO;               /* Must not exist */
      908     7882    3              IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$NOFILE) THEN
      909     7883    3                 CALL VEX$ERROR (E$FILECREATED,0) ;
      910     7884    3              END;
      911     7885    2           END;                            /* IF OLDFILE */
      912     7886        /**/
      913     7887        /*E*        ERROR:      VEE-E$FILECREATED-0
      914     7888                    MESSAGE:   %UF was created by the MERGE operation
      915     7889                    DESCRIPTION:  User specified INTO and the File didn't
      916     7890                                  exist.  This is not an Error, but maybe
      917     7891                                  he didn't intend on creating a file, Let's
      918     7892                                  Inform him just incase.
      919     7893        */
      920     7894        /**/
      921     7895    1        OPEN_FILE2_FPT.V.FUN# = %CREATE#;
      922     7896    1        OPEN_FILE2_FPT.V.EXIST# = CMD$ -> M_CMD_TBL.ONOVER ;
      923     7897    1        OPEN_FILE2_FPT.V.TYPE# = TYPE_CODE;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:32   
      924     7898    1        CALL M$OPEN(OPEN_FILE2_FPT) ALTRET(EXEC_MERGE_ERR); /* OPEN OUTPUT FILE */
      925     7899        /**/
      926     7900    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);
      927     7901    1        OPEN_FILE_FPT.IFPARAM_ = VECTOR(NIL);
      928     7902        /**/
      929     7903    2        IF (M$FILE2$ -> F$DCB.ORG ~= %KEYED#) THEN DO; /* CANT MERGE INTO NON-KEYED */
      930     7904    2           CALL VEX$ERROR(E$E_MRGDESTNOTKEY,3);
      931     7905    2           GOTO EXEC_MERGE_RET;
      932     7906    2           END;
      933     7907        /**/
      934     7908        /*E*     ERROR:    VEE-E$E_MRGDESTNOTKEY-0
      935     7909                 MESSAGE:  File %%FN %is not a keyed file - can not merge into file.
      936     7910                 MESSAGE1: A consecutive, unit record or indexed file has been
      937     7911                           opened for a MERGE output file.  You can not MERGE into
      938     7912                           a non-keyed file.
      939     7913                 DESCRIPTION: A request was made to MERGE into a consec file.  */
      940     7914        /**/
      941     7915    1        READ_KEY = CMD$ -> M_CMD_TBL.LO_SEQNUM.KEY; /* BEGIN INPUT RANGE          */
      942     7916    1        LIMIT_SEQNUM = CMD$ -> M_CMD_TBL.HI_SEQNUM.KEY; /* END INPUT RANGE        */
      943     7917        /**/
      944     7918    1        CALL VEX$READ_RANDOM(READ_KEY) ALTRET(EXEC_MERGE_RET); /* SET POSITION */
      945     7919        /**/
      946     7920        /**/
      947     7921    2        IF (~FLAGS.EXISTS) THEN DO;
      948     7922    2           CALL VEX$READ_SEQUEN ALTRET(EXEC_MERGE_RET);
      949     7923    2           READ_KEY = LAST_KEY;
      950     7924    3           IF ((FLAGS.EOF) OR (LAST_KEY > LIMIT_SEQNUM)) THEN DO;
      951     7925    3              CALL VEX$ERROR(E$E_NOMOVE,2); /* NOTHING TO MOVE                */
      952     7926    3              GOTO EXEC_MERGE_CLOSE;
      953     7927    3              END ;                        /* THEN DO */
      954     7928        /*E*     ERROR:    VEE-E$E_NOMOVE-0
      955     7929                 MESSAGE:  Nothing to move
      956     7930                 MESSAGE1: There are no records in the 'FROM' range
      957     7931                 DESCRIPTION: An attempt was made to MERGE records from a file
      958     7932                           and the file has no records in the specified range.
      959     7933        */
      960     7934    2           END ;                           /* THEN DO */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:33   
      961     7935        /**/
      962     7936    1        EXEC_SEQNUM = CMD$ -> M_CMD_TBL.LO_SEQNUM2.KEY; /* BEGIN OUTPUT RANGE     */
      963     7937    1        LO_SEQNUM = EXEC_SEQNUM;
      964     7938    1        HI_SEQNUM = CMD$ -> M_CMD_TBL.HI_SEQNUM2.KEY; /* END OUTPUT RANGE         */
      965     7939        /**/
      966     7940    1        INCR = CMD$ -> M_CMD_TBL.INCR;     /* OUTPUT INCREMENT                   */
      967     7941        /**/
      968     7942    1        REC_COUNT = 0;                     /* DELETE RECORDS IN OUTPUT RANGE     */
      969     7943    1        CALL VEX$DELREC(M$FILE2_NUM,EXEC_SEQNUM,HI_SEQNUM)
      970     7944    1           ALTRET (EXEC_MERGE_RET);
      971     7945    1        REC_COUNT = M$FILE2$ -> F$DCB.ARS;
      972     7946    1        READ_SEQUEN2_FPT.KEY_ = VECTOR(LAST_KEY) ;
      973     7947    1        CALL M$READ(READ_SEQUEN2_FPT) ALTRET(MERGE_DEL2_ERR) ;
      974     7948    1        HI_SEQNUM = LAST_KEY ;             /* SET LIMIT                          */
      975     7949        /**/
      976     7950    1   EXEC_MERGE_MOVE:
      977     7951    2        IF (REC_COUNT > 0) THEN DO;
      978     7952    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,REC_COUNT);
      979     7953    2           CALL VEX$ERROR(E$E_RECSDEL,1);  /* XX RECORDS DELETED               */
      980     7954    2           END;
      981     7955        /**/
      982     7956        /*E*     ERROR:    VEE-E$E_RECSDEL-0
      983     7957                 MESSAGE:  %U1 records deleted
      984     7958                 DESCRIPTION: The specified range of records which was deleted
      985     7959                           contained %U1 records.
      986     7960        */
      987     7961    1        CALL VEX$ERROR(E$E_MRGSTART,1);    /* MERGE STARTED                      */
      988     7962        /**/
      989     7963        /*E*     ERROR:    VEE-E$E_MRGSTART-0
      990     7964                 MESSAGE:  MERGE started
      991     7965                 DESCRIPTION: The MERGE operation has started
      992     7966        */
      993     7967        /**/
      994     7968    1        REC_COUNT = 0;
      995     7969    1        LAST_KEY = READ_KEY ;              /* RESTORE POSITION IN INPUT FILE     */
      996     7970    2        DO WHILE (LAST_KEY <= LIMIT_SEQNUM); /* DO WHOLE INPUT RANGE       */
      997     7971    2           CALL VEX$WRITE_REC(M$FILE2_NUM,EXEC_SEQNUM) ALTRET(EXEC_MERGE_RET);
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:34   
      998     7972    2           EXEC_SEQNUM = EXEC_SEQNUM + INCR;
      999     7973    2           SAVE_KEY = LAST_KEY;            /* SAVE FOR CUTOFF              */
     1000     7974    2           REC_COUNT = REC_COUNT+1;
     1001     7975    2           CALL VEX$READ_SEQUEN ALTRET (EXEC_MERGE_RET); /* GET NEXT       */
     1002     7976    3           IF (FLAGS.EOF) THEN DO;
     1003     7977    3              CALL VEX$ERROR(E$E_EDITEOF,1); /* EOF HIT                    */
     1004     7978    3              GOTO EXEC_MERGE_DONE;
     1005     7979    3              END;
     1006     7980        /**/
     1007     7981        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1008     7982                 DESCRIPTION: EOF encountered in MERGE operation.
     1009     7983        */
     1010     7984    2           CALL VEX$CHECK_CUTOFF ALTRET(EXEC_MERGE_DONE1) ; /* Found cutoff. */
     1011     7985    2           END ;                           /* DO WHILE */
     1012     7986        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1013     7987                 DESCRIPTION: EOF encountered in MERGE operation.
     1014     7988        */
     1015     7989        /**/
     1016     7990    1   EXEC_MERGE_DONE:
     1017     7991    1        EXEC_SEQNUM = EXEC_SEQNUM - INCR;
     1018     7992    1   EXEC_MERGE_DECR:
     1019     7993    1        FLAGS.CONSEC_MODE = FALSE;         /* PRINT FRACTIONAL SEQNUM            */
     1020     7994    1        CALL VEX$SEQNUM_TEXT(EXEC_SEQNUM,SUB_BUF_1);
     1021     7995    1        CALL VEX$ERROR(E$E_DONEAT,1);
     1022     7996        /**/
     1023     7997    1   EXEC_MERGE_DONE1:
     1024     7998    1        CALL VEX$SET_SUB_BUF(SUB_BUF_1,REC_COUNT);
     1025     7999    1        CALL VEX$ERROR(E$E_RECSMVED,1);    /* XX RECORDS MOVED                   */
     1026     8000    1        HI_SEQNUM = EXEC_SEQNUM ;
     1027     8001        /**/
     1028     8002        /*E*     ERROR:    VEE-E$E_RECSMVED-0
     1029     8003                 MESSAGE:  %U1 records moved
     1030     8004                 DESCRIPTION: %u1 records were MERGEd from one file to the
     1031     8005                           other.
     1032     8006        */
     1033     8007        /**/
     1034     8008    1   EXEC_MERGE_CLOSE:
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:35   
     1035     8009    1        CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR3) ;
     1036     8010    1   EXEC_MERGE_CLOSE_ERR3:
     1037     8011    1        IF (~M$FILE2$ -> F$DCB.FEXT) THEN CLOSE2_FPT.V.OPER.RELG# = TRUE;
     1038     8012    1        CALL M$CLOSE(CLOSE2_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR4) ;
     1039     8013    1   EXEC_MERGE_CLOSE_ERR4:
     1040     8014    1        CLOSE2_FPT.V.OPER.RELG# = FALSE;
     1041     8015    1        CALL M$FDS (COPYDS_FPT);
     1042     8016        /**/
     1043     8017    1        FLAGS.CONSEC_MODE = FALSE;
     1044     8018    1        FLAGS.REL_MODE = FALSE;
     1045     8019        /**/
     1046     8020    1        CALL VEX$ERROR(E$E_MRGDONE,1);     /* MERGE DONE                         */
     1047     8021        /**/
     1048     8022        /*E*     ERROR:    VEE-E$E_MRGDONE-0
     1049     8023                 MESSAGE:  MERGE done
     1050     8024                 DESCRIPTION: The MERGE operation is complete.
     1051     8025        */
     1052     8026        /**/
     1053     8027    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET(EXEC_MERGE_RET);
     1054     8028    1        OPEN_FILE_FPT.V.FUN# = %UPDATE#;
     1055     8029    1        CALL M$OPEN (OPEN_FILE_FPT) ALTRET (EXEC_MERGE_ERR);
     1056     8030    1        FLAGS.EDIT_MODE = TRUE;
     1057     8031    1        P_PCB.ROOT$ = ADDR(P_ALLCMDS) ;
     1058     8032        /**/
     1059     8033    1        RETURN;
     1060     8034        /**/
     1061     8035    1   EXEC_MERGE_ERR:
     1062     8036    1        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$CREATERR) THEN
     1063     8037    1           CALL VEX$ERROR(E$E_ONEXTS,3);   /* 'ON' FILE EXISTS                  */
     1064     8038    1        ELSE
     1065     8039    1           CALL VEX$ERROR(0,SYSFLAGLEV);
     1066     8040    1        OPEN_FILE_NAME = CURR_FILE_NAME;
     1067     8041    1   EXEC_MERGE_RET:
     1068     8042    1        CALL M$CLOSE (CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR5) ;
     1069     8043    1   EXEC_MERGE_CLOSE_ERR5:
     1070     8044    1        IF (~M$FILE$ -> F$DCB.FEXT) THEN CLOSE2_FPT.V.OPER.RELG# = TRUE;
     1071     8045    1        CALL M$CLOSE (CLOSE2_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR6) ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:36   
     1072     8046    1   EXEC_MERGE_CLOSE_ERR6:
     1073     8047    1        CLOSE2_FPT.V.OPER.RELG# = FALSE;
     1074     8048    1        IF (OPEN_FILE_FPT.FPARAM_ ~= VECTOR(NIL)) THEN CALL M$FDS(COPYDS_FPT);
     1075     8049    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);
     1076     8050    1        OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);
     1077     8051    1        P_PCB.ROOT$ = ADDR(P_ALLCMDS) ;
     1078     8052    1        RETURN;
     1079     8053        /**/
     1080     8054    1   MERGE_DEL2_ERR:                         /* ERROR READING FILE2 TO DELETE RECS */
     1081     8055    2        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$BADVECT1 THEN DO ;
     1082     8056    2           ADDR(LAST_KEY) -> STR$BUF.COUNT = 3 ;
     1083     8057    2           HI_SEQNUM = LAST_KEY ;
     1084     8058    2           GOTO EXEC_MERGE_MOVE ;
     1085     8059    2           END ;                           /* THEN DO */
     1086     8060    1        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# ~= %E$EOF)
     1087     8061    1        THEN GOTO EXEC_MERGE_ERR;
     1088     8062    1        HI_SEQNUM = MAX_SEQNUM+1;          /* SET LIMIT                          */
     1089     8063    1        GOTO EXEC_MERGE_MOVE;
     1090     8064        /**/
     1091     8065        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:37   
     1092     8066        /**/
     1093     8067    1   VEF$EXEC_QM: ENTRY;
     1094     8068        /**/
     1095     8069    1        IF ((ERR_CODE.FCG_MID = '0'B) AND (FLAGS.HELP_MODE = '0'B)) THEN GOTO HELPMSG ;
     1096     8070        /**/
     1097     8071    1        CALL VEX$ERRNEXT ALTRET(HELPMSG);
     1098     8072    1        RETURN;
     1099     8073        /*E*     ERROR:    VEE-E$E_NOMOREHELP-0
     1100     8074         MESSAGE:  Please use the HELP command, or refer to the manual for more information.
     1101     8075                 DESCRIPTION: Error messages exhausted.
     1102     8076        */
     1103     8077        /**/
     1104     8078    1   HELPMSG:
     1105     8079    1        IF ((ERR_CODE.ERR# = E$E_SYNTAX) AND (ERR_CODE.MON = '0'B))
     1106     8080    1        THEN CALL X$HELP(XUH_PARAM) ALTRET(HELP_ERR) ;
     1107     8081    1        ELSE IF (FLAGS.HELP_MODE = '1'B)
     1108     8082    1           THEN CALL VEH$ALL_HELP ;
     1109     8083    1           ELSE CALL VEX$ERROR(E$E_NOMOREHELP,2) ; /* That's all folks. */
     1110     8084    1        RETURN;
     1111     8085    1   HELP_ERR:
     1112     8086    1        CALL VEX$ERROR(E$E_NOMOREHELP,2) ;
     1113     8087    1        RETURN ;
     1114     8088        /**/
     1115     8089    1   VEF$EXEC_QM2: ENTRY;
     1116     8090        /**/
     1117     8091    1        IF (ERR_CODE.FCG_MID = '0'B) THEN GOTO HELPMSG ;
     1118     8092        /**/
     1119     8093    1        IF (ERR_CODE.SEV = 7) THEN GOTO HELPMSG;
     1120     8094        /**/
     1121     8095    1        IF ((ERR_CODE.FCG_MID ~= '260505'O)OR /* MONITOR ERROR                */
     1122     8096    1           ((ERR_CODE.ERR# > 200)AND(ERR_CODE.ERR# < 400))) /* EDIT NON-HELP   */
     1123     8097    2        THEN DO;
     1124     8098    2           CALL VEX$ERRMAX;
     1125     8099    2           RETURN;
     1126     8100    2           END;
     1127     8101        /**/                                    /* ELSE HELP                          */
     1128     8102    2        DO WHILE('1'B);
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:38   
     1129     8103    2           CALL VEX$ERRNEXT ALTRET (QM2_DONE);
     1130     8104    2           END;
     1131     8105        /**/
     1132     8106    1   QM2_DONE:
     1133     8107    1        RETURN;
     1134     8108        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:39   
     1135     8109        /**/
     1136     8110    1   VEF$EXEC_ROUND: ENTRY;
     1137     8111        /**/
     1138     8112    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.ROUNDFLAG = TRUE;
     1139     8113    1        ELSE FLAGS.ROUNDFLAG = FALSE;
     1140     8114    1        RETURN;
     1141     8115        /**/
     1142     8116        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:40   
     1143     8117        /**/
     1144     8118    1   VEF$EXEC_RP: ENTRY;
     1145     8119        /**/
     1146     8120    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.RPFLAG = TRUE;
     1147     8121    1        ELSE FLAGS.RPFLAG = FALSE;
     1148     8122    1        RETURN;
     1149     8123        /**/
     1150     8124        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:41   
     1151     8125        /**/
     1152     8126    1   VEF$EXEC_STATUS: ENTRY;                 /* STATUS                             */
     1153     8127        /**/
     1154     8128    1        IF (CMD$ -> TA_CMD_TBL.NUM_TABS = 0) THEN /* Full STATUS CMD */
     1155     8129    2        DO STATUS_FIELDS = 0 TO NUMSTATUSOPTS;
     1156     8130    2           REPSTATUS(STATUS_FIELDS) = '1'B; /* Display them all */
     1157     8131    2           END;
     1158     8132    2        ELSE DO;                           /* Only Display selected STATUS stuff */
     1159     8133    3           DO STATUS_FIELDS = 0 to NUMSTATUSOPTS;
     1160     8134    3              REPSTATUS(STATUS_FIELDS) = '0'B; /* Assume not to Display */
     1161     8135    3              END;
     1162     8136    3           DO STATUS_FIELDS = 0 TO CMD$ -> TA_CMD_TBL.NUM_TABS - 1;
     1163     8137    3              REPSTATUS(CMD$ -> TA_CMD_TBL.TABS(STATUS_FIELDS)) = '1'B;
     1164     8138                                                /* Only Display what user wants */
     1165     8139    3              END;
     1166     8140    2           END;
     1167     8141        /**/
     1168     8142        /*   Initialize some temporaries */
     1169     8143    1        TEMP_STR = ' ';
     1170     8144    1        LINELEN = 0;
     1171     8145        /**/
     1172     8146
     1173     8147        /* Now go through each STATUS FIELD and display it if it was selected above   */
     1174     8148
     1175     8149    1   FILENAME: IF (~REPSTATUS(PC_FILENAMELIT-FIRSTSTATUS)) THEN GOTO SE;
     1176     8150
     1177     8151        /* Display file name */
     1178     8152    2        IF (FLAGS.EDIT_MODE) THEN DO;
     1179     8153    2           TYPE_BUF.TEXT = 'FILENAME = ';
     1180     8154    2           CALL M$UNFID(UNFID_FPT) ALTRET(UNFID_ALT) ;
     1181     8155    2   UNFID_ALT: CALL INSERT(TYPE_BUF.TEXT,11,,TEMP_BUF) ;
     1182     8156    2           END;
     1183     8157    1        ELSE TYPE_BUF.TEXT = 'NO FILE OPEN';
     1184     8158    1        CALL VEX$TYPE_REC(TYPECR);
     1185     8159        /**/
     1186     8160
     1187     8161    1   SE:  IF (~REPSTATUS(SECMD-FIRSTSTATUS)) THEN GOTO CL;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:42   
     1188     8162
     1189     8163        /* Display SE */
     1190     8164    1        TYPE_BUF.TEXT = 'SE ';             /* CONSTRUCT SE COMMAND               */
     1191     8165    1        I = 3;
     1192     8166        /**/
     1193     8167    1        CALL VEX$SEQNUM_TEXT(LO_SEQNUM);
     1194     8168    1        CALL INSERT (TYPE_BUF.TEXT,I,9,SEQ_TEXT_BUF);
     1195     8169    1        I = 12;
     1196     8170        /**/
     1197     8171    2        IF (HI_SEQNUM ~= LO_SEQNUM) THEN DO;
     1198     8172    2           CALL VEX$SEQNUM_TEXT(HI_SEQNUM);
     1199     8173    2           CALL INSERT (TYPE_BUF.TEXT,I,10,'-',SEQ_TEXT_BUF);
     1200     8174    2           I = 22;
     1201     8175    2           END;
     1202     8176        /**/
     1203     8177    1        SSE$ = SSE_INIT$;
     1204     8178    2        IF (SSE$ -> SSE$PARAM.PTR$ ~= ADDR(NIL)) THEN DO; /* SELECTION CRITERIA */
     1205     8179    2           SSE_PARAM = SSE$ -> SSE$PARAM;
     1206     8180    2           CALL INSERT (TYPE_BUF.TEXT,I,1,',');
     1207     8181    2           I = I+1;
     1208     8182    3           IF (SSE_PARAM.FLAGS.NOTFLAG) THEN DO;
     1209     8183    3              CALL INSERT (TYPE_BUF.TEXT,I,3,'NOT');
     1210     8184    3              I = I+3;
     1211     8185    3              END;
     1212     8186    2           CALL INSERT_STRING ALTRET (STAT_ALT);
     1213     8187        /**/
     1214     8188    2           SSE$ = PINCRW(SSE$,SIZEW(SSE$PARAM));
     1215     8189    3           DO WHILE (SSE$ -> SSE$PARAM.PTR$ ~= ADDR(NIL));
     1216     8190    3              SSE_PARAM = SSE$ -> SSE$PARAM;
     1217     8191    4              IF (SSE_PARAM.FLAGS.ANDFLAG) THEN DO;
     1218     8192    4                 CALL INSERT (TYPE_BUF.TEXT,I,3,'AND') ALTRET (STAT_ALT);
     1219     8193    4                 I = I+3;
     1220     8194    4                 END;
     1221     8195        /**/
     1222     8196    4              ELSE IF (SSE_PARAM.FLAGS.ORFLAG) THEN DO;
     1223     8197    4                    CALL INSERT (TYPE_BUF.TEXT,I,2,'OR') ALTRET (STAT_ALT);
     1224     8198    4                    I = I+2;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:43   
     1225     8199    4                    END;
     1226     8200    4                 ELSE DO;
     1227     8201    4                    CALL INSERT (TYPE_BUF.TEXT,I,3,'EOR') ALTRET (STAT_ALT);
     1228     8202    4                    I = I+3;
     1229     8203    4                    END;
     1230     8204        /**/
     1231     8205    4              IF (SSE_PARAM.FLAGS.NOTFLAG) THEN DO;
     1232     8206    4                 CALL INSERT (TYPE_BUF.TEXT,I,4,',NOT') ALTRET (STAT_ALT);
     1233     8207    4                 I = I+4;
     1234     8208    4                 END;
     1235     8209    3              CALL INSERT_STRING ALTRET (STAT_ALT);
     1236     8210    3              SSE$ = PINCRW(SSE$,SIZEW(SSE$PARAM));
     1237     8211    3              END;
     1238     8212    2           END;
     1239     8213        /**/
     1240     8214    1        CALL BINCHAR (SUBSTR(TEMP_BUF,0,4),LO_SRCH_CLMN+1);
     1241     8215    1        CALL BINCHAR (SUBSTR(CMD_BUF,0,4),HI_SRCH_CLMN+1);
     1242     8216        /**/
     1243     8217    1        CALL INSERT (TYPE_BUF.TEXT,I,10,',',SUBSTR(TEMP_BUF,0,4),
     1244     8218    1           ',',SUBSTR(CMD_BUF,0,4));
     1245     8219        /**/
     1246     8220    1   STAT_ALT:
     1247     8221    1        CALL VEX$TYPE_REC(TYPECR);
     1248     8222        /**/
     1249     8223
     1250     8224    1   CL:  IF (~REPSTATUS(CLCMD-FIRSTSTATUS)) THEN GOTO TA;
     1251     8225
     1252     8226        /* Display the Current CL settings */
     1253     8227    2        IF ((LO_SRCH_CLMN ~= LO_EXEC_CLMN)OR(HI_SRCH_CLMN ~= HI_EXEC_CLMN)) THEN DO;
     1254     8228    2           CALL BINCHAR (SUBSTR(TEMP_BUF,0,4),LO_EXEC_CLMN+1);
     1255     8229    2           CALL BINCHAR (SUBSTR(CMD_BUF,0,4),HI_EXEC_CLMN+1);
     1256     8230    2           CALL CONCAT (TYPE_BUF.TEXT,'CL ',SUBSTR(TEMP_BUF,0,4),',',
     1257     8231    2              SUBSTR(CMD_BUF,0,4));
     1258     8232    2           CALL VEX$TYPE_REC(TYPECR);
     1259     8233    2           END;
     1260     8234        /**/
     1261     8235
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:44   
     1262     8236
     1263     8237    1   TA:  IF (~REPSTATUS(TACMD-FIRSTSTATUS)) THEN GOTO DIR;
     1264     8238
     1265     8239        /* Display TA */
     1266     8240    1        IF (NUM_TABS = 0) THEN
     1267     8241    1           TYPE_BUF.TEXT = 'NO TABS SET';
     1268     8242    2        ELSE DO;
     1269     8243    2           TYPE_BUF.TEXT = 'TA';
     1270     8244    2           I = 3;
     1271     8245    3           DO TEMP_COUNT = 0 TO NUM_TABS - 1;
     1272     8246    3              CALL BINCHAR(SUBSTR(TEMP_BUF,0,3),TAB_VLP.TABS#(TEMP_COUNT));
     1273     8247    3              IF (SUBSTR(TEMP_BUF,0,1) = '0') THEN
     1274     8248    3                 IF (TEMP_COUNT = 0) THEN CALL INSERT(TEMP_BUF,0,1,' ');
     1275     8249    3                 ELSE CALL INSERT(TEMP_BUF,0,1,',');
     1276     8250    4              ELSE IF (TEMP_COUNT ~= 0) THEN DO;
     1277     8251    4                    CALL INSERT(TYPE_BUF.TEXT,I,1,',');
     1278     8252    4                    I = I+1;
     1279     8253    4                    END;
     1280     8254    3              CALL INSERT(TYPE_BUF.TEXT,I,3,SUBSTR(TEMP_BUF,0,3));
     1281     8255    3              I = I+3;
     1282     8256    3              END;
     1283     8257    2           END;
     1284     8258    1        CALL VEX$TYPE_REC(TYPECR);
     1285     8259        /**/
     1286     8260    1   DIR: IF (~REPSTATUS(DIRCMD-FIRSTSTATUS)) THEN GOTO MODE;
     1287     8261
     1288     8262        /* Display Directory */
     1289     8263    1        TYPE_BUF.TEXT = 'DIRECTORY: ' ;
     1290     8264    1        CALL INDEX(I,' ',B$JIT.FPSN) ;
     1291     8265    1        IF I > 0 THEN                      /* Insert PSN.                        */
     1292     8266    2        DO ;
     1293     8267    2           CALL INSERT(TYPE_BUF.TEXT,11,,'DP#',B$JIT.FPSN) ;
     1294     8268    2           I = 11 + I + 3 ;
     1295     8269    2           END ;                           /* THEN DO                            */
     1296     8270    1        ELSE I = 11;
     1297     8271                                                /* Insert ACCOUNT.                    */
     1298     8272    1        CALL INSERT( TYPE_BUF.TEXT,I,,'.',B$JIT.FACCN ) ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:45   
     1299     8273    1        CALL VEX$TYPE_REC(TYPECR) ;
     1300     8274        /**/
     1301     8275
     1302     8276    1   MODE: IF (~REPSTATUS(PC_MODELIT-FIRSTSTATUS)) THEN GOTO BP;
     1303     8277
     1304     8278        /* Display MODE */
     1305     8279    1        IF (FLAGS.EDIT_MODE) THEN          /* Currently editing a file */
     1306     8280    2        DO CASE (BITBIN(M$FILE$ -> F$DCB.FFLG.DELR) +
     1307     8281    2           BITBIN(M$FILE$ -> F$DCB.FFLG.WNEW)*2 +
     1308     8282    2           BITBIN(M$FILE$ -> F$DCB.FFLG.UPD)*4 ) ;
     1309     8283
     1310     8284    2        CASE (0);
     1311     8285    2           TEMP_STR='EXAMINE MODE   ' ;
     1312     8286    2        CASE (1);
     1313     8287    2           TEMP_STR='DELR ONLY MODE ' ;
     1314     8288    2        CASE (2);
     1315     8289    2           TEMP_STR='WNEW ONLY MODE ' ;
     1316     8290    2        CASE (3);
     1317     8291    2           TEMP_STR='CAN''T RR MODE  ' ;
     1318     8292    2        CASE (4);
     1319     8293    2           TEMP_STR='RR ONLY MODE   ' ;
     1320     8294    2        CASE (5);
     1321     8295    2           TEMP_STR='CAN''T WNEW MODE' ;
     1322     8296    2        CASE (6);
     1323     8297    2           TEMP_STR='CAN''T DELR MODE' ;
     1324     8298    2        CASE (7);
     1325     8299    2           TEMP_STR='EDIT MODE      ' ;
     1326     8300    2        END;
     1327     8301
     1328     8302    1        ELSE TEMP_STR =   'NO FILE MODE   ';
     1329     8303    1        CALL FILL_LINE(TEMP_STR,15);
     1330     8304        /**/
     1331     8305
     1332     8306    1   BP:  IF (~REPSTATUS(BPCMD-FIRSTSTATUS)) THEN GOTO CR;
     1333     8307
     1334     8308        /* Display BP */
     1335     8309    1        IF (FLAGS.BPFLAG) THEN TEMP_STR = 'BP ON ';
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:46   
     1336     8310    1        ELSE TEMP_STR = 'BP OFF';
     1337     8311    1        CALL FILL_LINE(TEMP_STR,6);
     1338     8312        /**/
     1339     8313
     1340     8314    1   CR:  IF (~REPSTATUS(CRCMD-FIRSTSTATUS)) THEN GOTO RP;
     1341     8315
     1342     8316        /* Display CR */
     1343     8317    1        IF (FLAGS.CRFLAG) THEN TEMP_STR = 'CR ON ';
     1344     8318    1        ELSE TEMP_STR = 'CR OFF';
     1345     8319    1        CALL FILL_LINE(TEMP_STR,6);
     1346     8320        /**/
     1347     8321
     1348     8322    1   RP:  IF (~REPSTATUS(RPCMD-FIRSTSTATUS)) THEN GOTO VE;
     1349     8323
     1350     8324        /* Display RP */
     1351     8325    1        IF (FLAGS.RPFLAG) THEN TEMP_STR = 'RP ON ';
     1352     8326    1        ELSE TEMP_STR = 'RP OFF';
     1353     8327    1        CALL FILL_LINE(TEMP_STR,6);
     1354     8328        /**/
     1355     8329
     1356     8330    1   TABX: IF (~REPSTATUS(TABXCMD-FIRSTSTATUS)) THEN GOTO TABC;
     1357     8331
     1358     8332        /* Display TABX */
     1359     8333    1        IF (FLAGS.TABXFLAG) THEN TEMP_STR = 'TABX ON ';
     1360     8334    1        ELSE TEMP_STR = 'TABX OFF';
     1361     8335    1        CALL FILL_LINE(TEMP_STR,8);
     1362     8336        /**/
     1363     8337
     1364     8338    1   TABC: IF (~REPSTATUS(TABCCMD-FIRSTSTATUS)) THEN GOTO VE;
     1365     8339
     1366     8340        /* Display TABC */
     1367     8341    1        IF (FLAGS.TABCFLAG) THEN TEMP_STR = 'TABC ON ';
     1368     8342    1        ELSE TEMP_STR = 'TABC OFF';
     1369     8343    1        CALL FILL_LINE(TEMP_STR,8);
     1370     8344        /**/
     1371     8345
     1372     8346    1   VE:  IF (~REPSTATUS(VECMD-FIRSTSTATUS)) THEN GOTO ROUND;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:47   
     1373     8347
     1374     8348        /* Display VE */
     1375     8349    2        IF (FLAGS.VERIFY) THEN DO;
     1376     8350    2           IF (VERIFY_TYPE = TYCMD) THEN TEMP_STR = 'VE TY ';
     1377     8351    2           ELSE IF (VERIFY_TYPE = TSCMD) THEN TEMP_STR = 'VE TS ';
     1378     8352    2              ELSE IF (VERIFY_TYPE = TCCMD) THEN TEMP_STR = 'VE TC ';
     1379     8353    2                 ELSE IF (VERIFY_TYPE = TXCMD) THEN TEMP_STR = 'VE TX ';
     1380     8354    2           END;
     1381     8355    1        ELSE TEMP_STR = 'VE OFF';
     1382     8356    1        CALL FILL_LINE (TEMP_STR,6);
     1383     8357        /**/
     1384     8358
     1385     8359    1   ROUND: IF (~REPSTATUS(ROUNDCMD-FIRSTSTATUS)) THEN GOTO DONE;
     1386     8360
     1387     8361        /* Display ROUND */
     1388     8362    1        IF (FLAGS.ROUNDFLAG) THEN TEMP_STR = 'ROUND ON ';
     1389     8363    1        ELSE TEMP_STR = 'ROUND OFF';
     1390     8364    1        CALL FILL_LINE(TEMP_STR,9);
     1391     8365        /**/
     1392     8366
     1393     8367    1   DONE: ;
     1394     8368    1        IF LINELEN > 0 THEN
     1395     8369    1           CALL VEX$TYPE_REC(TYPECR);
     1396     8370    1        RETURN;
     1397     8371        %EJECT ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:48   
     1398     8372        /**/
     1399     8373    1   VEF$EXEC_DIR: ENTRY ;
     1400     8374        /**/
     1401     8375    2        DO CASE( CMD$ -> DIR_CMD_TBL.CODE ) ;
     1402     8376        /**/
     1403     8377    2        CASE( DIRCMD ) ;
     1404     8378        /**/
     1405     8379    2           TYPE_BUF.TEXT = '   DIRECTORY: ' ;
     1406     8380    2           CALL INDEX(I,' ',B$JIT.FPSN) ;
     1407     8381    2           IF I > 0 THEN                   /* Insert PSN.                        */
     1408     8382    3           DO ;
     1409     8383    3              CALL INSERT(TYPE_BUF.TEXT,14,,'DP#',B$JIT.FPSN) ;
     1410     8384    3              I = 14 + I + 3 ;
     1411     8385    3              END ;                        /* THEN DO                            */
     1412     8386    2           ELSE I = 14 ;
     1413     8387                                                /* Insert ACCOUNT.                    */
     1414     8388    2           CALL INSERT( TYPE_BUF.TEXT,I,,'.',B$JIT.FACCN ) ;
     1415     8389    2           CALL VEX$TYPE_REC(TYPECR) ;
     1416     8390        /**/
     1417     8391    2        CASE( PC_RESET ) ;                 /* 'DIR R'                            */
     1418     8392        /**/
     1419     8393    2           FPT_SETFMA.ACCT_ = VECTOR(NIL) ;
     1420     8394    2           FPT_SETFMA.PSN_ = VECTOR(NIL) ;
     1421     8395    2           CALL M$SETFMA(FPT_SETFMA) ALTRET(SETFMA_ERR) ;
     1422     8396        /**/
     1423     8397    2        CASE( PC_FID ) ;                   /* 'DIR fid'                          */
     1424     8398        /**/
     1425     8399    2           FPT_SETFMA.ACCT_ = VECTOR(CMD$ -> DIR_CMD_TBL.ACCT) ;
     1426     8400    2           IF CMD$ -> DIR_CMD_TBL.PSN ~= ' '
     1427     8401    2           THEN                            /* PSN given.                         */
     1428     8402    2              FPT_SETFMA.PSN_ = VECTOR(CMD$ -> DIR_CMD_TBL.PSN) ;
     1429     8403    2           ELSE                            /* No PSN given.                      */
     1430     8404    2              FPT_SETFMA.PSN_ = VECTOR(NIL) ;
     1431     8405    2           CALL M$SETFMA(FPT_SETFMA) ALTRET(SETFMA_ERR) ;
     1432     8406        /**/
     1433     8407    2        END ;                              /* DO CASE                            */
     1434     8408        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:49   
     1435     8409    1        RETURN ;
     1436     8410        /**/
     1437     8411    1   SETFMA_ERR:
     1438     8412    1        CALL VEX$ERROR(E$E_BADDIR,1) ;
     1439     8413    1        RETURN ;
     1440     8414        /**/
     1441     8415        /*E*     ERROR:    VEE-E$E_BADDIR-0
     1442     8416                 DESCRIPTION: The user has input more than just [DP#SN].ACCOUNT
     1443     8417                              for the fid of the DIRECTORY command.
     1444     8418        */
     1445     8419        /**/
     1446     8420    1   INSERT_STRING: PROC ALTRET;
     1447     8421        /**/
     1448     8422    3        DO TEMP_COUNT = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;
     1449     8423    4           IF (SSE_PARAM.PTR$ -> STR$PARAM.STR.QM(TEMP_COUNT)) THEN DO;
     1450     8424    4              CALL INSERT(TYPE_BUF.TEXT,I,1,'?') ALTRET(IS_ALT);
     1451     8425    4              I = I+1;
     1452     8426    4              TEMP_CLMN = SSE_PARAM.PTR$ -> STR$PARAM.STR.QMCOUNT(TEMP_COUNT);
     1453     8427    5              IF (TEMP_CLMN ~= 0) THEN DO;
     1454     8428    5                 CALL BINCHAR(SUBSTR(TEMP_BUF,0,1),TEMP_CLMN);
     1455     8429    5                 CALL INSERT(TYPE_BUF.TEXT,I,1,SUBSTR(TEMP_BUF,0,1)) ALTRET(IS_ALT);
     1456     8430    5                 I = I+1;
     1457     8431    5                 END;
     1458     8432    4              END;
     1459     8433    4           ELSE DO;
     1460     8434    4              CALL INSERT(TYPE_BUF.TEXT,I,SSE_PARAM.PTR$ ->
     1461     8435    4                 STR$PARAM.STR.PTR$(TEMP_COUNT) -> STR$BUF.COUNT + 2,'/',
     1462     8436    4                 SUBSTR(SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(TEMP_COUNT) ->
     1463     8437    4                 STR$BUF.TEXT,0,SSE_PARAM.PTR$ ->
     1464     8438    4                 STR$PARAM.STR.PTR$(TEMP_COUNT) -> STR$BUF.COUNT),'/')
     1465     8439    4                 ALTRET (IS_ALT);
     1466     8440    4              I = I + 2 + SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(TEMP_COUNT)
     1467     8441    4                 -> STR$BUF.COUNT;
     1468     8442    4              END;
     1469     8443    3           END;
     1470     8444    2        RETURN;
     1471     8445        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:50   
     1472     8446    2   IS_ALT:
     1473     8447    2        ALTRETURN;
     1474     8448    2   END;
     1475     8449        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:51   
     1476     8450        /**/
     1477     8451    1   VEF$EXEC_TA: ENTRY;
     1478     8452    1        TAB_VLP = FALSE;
     1479     8453        /**/
     1480     8454    2        DO I = 0 TO NUM_TABS-1;
     1481     8455    2           TAB_VLP.TABS#(I) = CMD$ -> TA_CMD_TBL.TABS(I);
     1482     8456    2           END;
     1483     8457        /**/
     1484     8458    1        CALL M$DEVICE(TAB_FPT);
     1485     8459    1        RETURN;
     1486     8460        /**/
     1487     8461        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:52   
     1488     8462        /**/
     1489     8463    1   VEF$EXEC_TABC: ENTRY;
     1490     8464        /**/
     1491     8465    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.TABCFLAG = TRUE;
     1492     8466    1        ELSE FLAGS.TABCFLAG = FALSE;
     1493     8467        /**/
     1494     8468    1        CALL M$GTRMTAB(TAB_FPT);
     1495     8469    1        NUM_TABS = 0;
     1496     8470    2        DO WHILE ((TAB_VLP.TABS#(NUM_TABS) ~= 0)AND(NUM_TABS <= 30));
     1497     8471    2           NUM_TABS = NUM_TABS + 1;
     1498     8472    2           END;
     1499     8473    1        RETURN;
     1500     8474        /**/
     1501     8475        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:53   
     1502     8476        /**/
     1503     8477    1   VEF$EXEC_TABX: ENTRY;
     1504     8478        /**/
     1505     8479    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.TABXFLAG = TRUE;
     1506     8480    1        ELSE FLAGS.TABXFLAG = FALSE;
     1507     8481        /**/
     1508     8482    1        CALL M$GTRMTAB(TAB_FPT);
     1509     8483    1        NUM_TABS = 0;
     1510     8484    2        DO WHILE ((TAB_VLP.TABS#(NUM_TABS) ~= 0)AND(NUM_TABS <= 30));
     1511     8485    2           NUM_TABS = NUM_TABS + 1;
     1512     8486    2           END;
     1513     8487    1        RETURN;
     1514     8488        /**/
     1515     8489        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:54   
     1516     8490        /**/
     1517     8491    1   VEF$EXEC_TYPE: ENTRY;
     1518     8492        /**/
     1519     8493    1        TYPE_CODE = CMD$ -> TYPE_CMD_TBL.CODE;
     1520     8494    1        RETURN;
     1521     8495        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:55   
     1522     8496        /**/
     1523     8497    1   VEF$EXEC_VE: ENTRY;
     1524     8498        /**/
     1525     8499    1        VERIFY_TYPE = CMD$ -> VE_CMD_TBL.TYPE;
     1526     8500        /**/
     1527     8501    1        IF (VERIFY_TYPE = 0) THEN FLAGS.VERIFY = FALSE;
     1528     8502    1        ELSE FLAGS.VERIFY = TRUE;
     1529     8503    1        RETURN;
     1530     8504        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:56   
     1531     8505        /**/
     1532     8506    1   FILL_LINE: PROC (STR,PARM);
     1533     8507
     1534     8508    2   DCL STR CHAR(80);
     1535     8509    2   DCL PARM  SBIN;
     1536     8510    2   DCL LENGTH SBIN;
     1537     8511
     1538     8512    2        LENGTH =            PARM;/* PARM may be a CONSTANT, so change it to AUTO */
     1539     8513
     1540     8514    3        DO WHILE (SUBSTR(STR,LENGTH-1,1) = ' ') ;/* Delete Trailing blank */
     1541     8515    3           LENGTH = LENGTH - 1;
     1542     8516    3           END;
     1543     8517
     1544     8518    3        IF LINELEN > 75 THEN DO;           /* PRINT LINE */
     1545     8519    3           CALL VEX$TYPE_REC(TYPECR);
     1546     8520    3           LINELEN = 0;
     1547     8521    3           END;
     1548     8522    3        ELSE IF LINELEN > 0 THEN DO;
     1549     8523    3              CALL INSERT (TYPE_BUF.TEXT,LINELEN,,',  ');
     1550     8524    3              LINELEN = LINELEN + 3;
     1551     8525    3              END;
     1552     8526
     1553     8527    2        CALL INSERT (TYPE_BUF.TEXT,LINELEN,,SUBSTR(STR,0,LENGTH)) ;
     1554     8528    2        LINELEN = LINELEN + LENGTH ;
     1555     8529    2        RETURN;
     1556     8530    2   END FILL_LINE;
     1557     8531    1   END;                                    /* END VEF$FILCMD                     */

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:57   
--  Include file information  --

   VE_FLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEF$FILCMD.

   Procedure VEF$FILCMD requires 2197 words for executable code.
   Procedure VEF$FILCMD requires 106 words of local(AUTO) storage.

    No errors detected in file VEF$FILCMD.:E05TSI    .

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:58   

 Object Unit name= VEF$FILCMD                                 File name= VEF$FILCMD.:E05TOU
 UTS= JUL 30 '97 07:06:40.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   254    376  VEF$FILCMD
    2  RoData even  UTS    388    604  VEF$FILCMD
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  M$FILE
    5   DCB   even  none     0      0  M$FILE2
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$ME
    8   Proc  even  none  2197   4225  VEF$FILCMD
    9  RoData even  none   136    210  VEF$FILCMD
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:59   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes            yes      Std        0  VEF$FILCMD
     8      3                  yes      Std        0  VEF$EXEC_BP
     8     20                  yes      Std        0  VEF$EXEC_BUILD
     8    223                  yes      Std        0  VEF$EXEC_COPY
     8    714                  yes      Std        0  VEF$EXEC_CR
     8    731                  yes      Std        0  VEF$EXEC_DELETE
     8   1102                  yes      Std        0  VEF$EXEC_EDIT
     8   1412                  yes      Std        0  VEF$EXEC_END
     8   1443                  yes      Std        0  VEF$EXEC_MERGE
     8   2251                  yes      Std        0  VEF$EXEC_QM
     8   2321                  yes      Std        0  VEF$EXEC_QM2
     8   2352                  yes      Std        0  VEF$EXEC_ROUND
     8   2367                  yes      Std        0  VEF$EXEC_RP
     8   2404                  yes      Std        0  VEF$EXEC_STATUS
     8   3525                  yes      Std        0  VEF$EXEC_DIR
     8   4005                  yes      Std        0  VEF$EXEC_TA
     8   4032                  yes      Std        0  VEF$EXEC_TABC
     8   4070                  yes      Std        0  VEF$EXEC_TABX
     8   4126                  yes      Std        0  VEF$EXEC_TYPE
     8   4134                  yes      Std        0  VEF$EXEC_VE
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:60   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 VEX$ERROR
         yes           Std       2 VEX$SEQNUM_TEXT
         yes           Std       0 VEX$CLMN_DFLT
 yes     yes           Std       0 VEX$READ_SEQUEN
         yes           Std       2 VEX$SET_SUB_BUF
 yes     yes           Std       0 VEX$CHECK_CUTOFF
 yes     yes           Std       1 VEX$READ_RANDOM
         yes           Std       0 VEH$ALL_HELP
 yes     yes           Std       3 VEX$FID_2_FPT
         yes           Std       1 VEX$SET_PROMPT
 yes     yes           Std       3 VEX$READ_TERM_REC
 yes     yes           Std       2 VEX$WRITE_REC
 yes     yes           Std       1 X$HELP
         yes           Std       1 VEX$TYPE_REC
 yes     yes           Std       0 VEX$ERRMAX
 yes     yes           Std       3 VEX$DELREC
 yes     yes           Std       0 VEX$ERRNEXT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:61   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$SI                                  M$FILE
     M$FILE2                               M$DO                                  M$ME
     FLAGS                                 P_PCB                                 P_ALLCMDS
     B$TCB$                                REC_BUF                               TEMP_BUF
     CMD_BUF                               TYPE_BUF                              SUB_BUF_1
     SEQ_TEXT_BUF                          CURR_FILE_NAME                        CURR_FILE_ACCT
     CURR_FILE_PASS                        CURR_FILE_SN                          OPEN_FILE_NAME
     OPEN_FILE_ACCT                        OPEN_FILE_PASS                        OPEN_FILE_SN
     ERR_CODE                              TYPE_CODE                             SSE_INIT$
     REC_SIZE                              RP_REC_SIZE                           DVBYTE
     LO_SRCH_CLMN                          HI_SRCH_CLMN                          LO_EXEC_CLMN
     HI_EXEC_CLMN                          LO_SEQNUM                             HI_SEQNUM
     EXEC_SEQNUM                           LIMIT_SEQNUM                          INCR
     LAST_KEY                              READ_KEY                              SAVE_KEY
     TEMP_CLMN                             TEMP_COUNT                            CMD_CODE
     REC_COUNT                             I                                     M$FILE_NUM
     TAB_VLP                               SAVE_TAB_VLP                          M$FILE2_NUM
     NUM_TABS                              VERIFY_TYPE                           P$
     M$FILE$                               M$FILE2$                              CMD$
     SSE$                                  COPYDS_PTR$                           SSE_PARAM
     MAX_SEQNUM                            Y003                                  B$JIT$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:62   


        1        1        /*M*    VEF$FILCMD - EDIT FILE COMMAND EXEC ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        /**/
        9        9        VEF$FILCMD: PROC;

      9  8 000000   000000 700200 xent  VEF$FILCMD   TSX0  ! X66_AUTO_0
         8 000001   000152 000000                    ZERO    106,0
         8 000002   000005 710000 8                  TRA     s:7345

       10       10        /**/
       11       11        /*********************************************************************/
       12       12        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       13       13        /*********************************************************************/
       14       14        /**/
       15       15        %INCLUDE VE_SUBS_C;
       16      209        %INCLUDE VE_PERR_C;
       17      426        %INCLUDE CP_6_SUBS;
       18      966        %INCLUDE F$DCB;
       19     1015        %INCLUDE CP_6;
       20     1096        %INCLUDE B_ERRORS_C;
       21     2223        %INCLUDE B$JIT ;
       22     2513        %INCLUDE XU_MACRO_C ;
       23     5619        %INCLUDE XUH_MACRO_C ;
       24     5703        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:63   
       25     5704        /********************************************************************/
       26     5705        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       27     5706        /********************************************************************/
       28     5707        %FPT_OPEN (FPTN = OPEN_FILE_FPT,
       29     5708                      NAME = OPEN_FILE_NAME,
       30     5709                      DCB = M$FILE,
       31     5710                      ASN = FILE,
       32     5711                      ACS = DIRECT,
       33     5712                      DISP = NAMED,
       34     5713                      CTG = YES,
       35     5714                      SPARE = 50,
       36     5715                      SCRUB = YES,
       37     5716                      ORG = KEYED);
       38     5825        %FPT_TRUNC (FPTN = TRUNC_FPT, STCLASS = CONSTANT, DCB = M$FILE);
       39     5839        %FPT_OPEN (FPTN = OPEN_FILE2_FPT,
       40     5840                      NAME = OPEN_FILE_NAME,
       41     5841                      DCB = M$FILE2,
       42     5842                      ASN = FILE,
       43     5843                      ACS = DIRECT,
       44     5844                      SPARE = 50,
       45     5845                      ORG = KEYED,
       46     5846                      SCRUB = YES,
       47     5847                      DISP = NAMED);
       48     5956        %FPT_OPEN (FPTN = DELETE_FPT , STCLASS = AUTO);
       49     6065        %FPT_OPEN (FPTN = DELETE_FPT_C , STCLASS = CONSTANT,
       50     6066                      NAME = OPEN_FILE_NAME,
       51     6067                      DCB = M$FILE2,
       52     6068                      ASN = FILE,
       53     6069                      SCRUB = YES,
       54     6070                      DELETE = YES);
       55     6179        %FPT_CLOSE (FPTN = CLOSE_FPT, STCLASS = CONSTANT,
       56     6180                      DCB = M$FILE,
       57     6181                      RELG = YES ,
       58     6182                      DISP=SAVE);
       59     6224        %FPT_CLOSE (FPTN = CLOSEDFLT_FPT, STCLASS = CONSTANT,
       60     6225                      DCB = M$FILE,
       61     6226                      RELG = YES) ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:64   
       62     6268        %FPT_CLOSE (FPTN = CLOSEREL_FPT, STCLASS = CONSTANT,
       63     6269                    DCB = M$FILE,
       64     6270                    DISP = RELEASE);
       65     6312        %FPT_CLOSE (FPTN = CLOSE2_FPT,
       66     6313                      DCB = M$FILE2,
       67     6314                      RELG = YES ,
       68     6315                      DISP = SAVE);
       69     6357        %FPT_CLOSE (FPTN = CLOSE2DFLT_FPT,
       70     6358                      DCB = M$FILE2,
       71     6359                      RELG = YES) ;
       72     6401        %FPT_CLOSE (FPTN = CLOSE2REL_FPT, STCLASS = CONSTANT,
       73     6402                      DCB = M$FILE2,
       74     6403                      DISP = RELEASE);
       75     6445        %FPT_CLOSE    (FPTN = CLOSE_ME_FPT, STCLASS = CONSTANT,
       76     6446                      DCB = M$ME,
       77     6447                      DISP = SAVE);
       78     6489        %FPT_CLOSE    (FPTN = CLOSE_DO_FPT, STCLASS = CONSTANT,
       79     6490                      DCB = M$DO,
       80     6491                      DISP = SAVE);
       81     6533        %FPT_READ (FPTN = READ_SEQUEN2_FPT,
       82     6534                      BUF = CMD_BUF,
       83     6535                      DCB = M$FILE2,
       84     6536                      KEY = LAST_KEY,
       85     6537                      KEYS = NO,
       86     6538                      KEYR = YES);
       87     6577        %FPT_PFIL (FPTN = PFIL_FPT, STCLASS = CONSTANT,
       88     6578                      DCB = M$FILE,
       89     6579                      BOF = YES);
       90     6594        %FPT_GDS      (FPTN = COPYDS_FPT, STCLASS = CONSTANT,
       91     6595                       RESULTS = DS_RESULTS,
       92     6596                       SEGSIZE = 1024);
       93     6612        %FPT_DEVICE   (FPTN = TAB_FPT, STCLASS = CONSTANT,
       94     6613                      DCB = M$UC,
       95     6614                      TAB = TAB_VLP);
       96     6632        %VLP_VECTOR   (FPTN = DS_RESULTS);
       97     6647        %FPT_SETFMA (FPTN = FPT_SETFMA) ;
       98     6660        %FPT_UNFID (FPTN = UNFID_FPT , STCLASS = CONSTANT,
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:65   
       99     6661                    DCB = M$FILE ,
      100     6662                    TEXTFID = TEMP_BUF ) ;
      101     6680        %XUH_PARAM (NAME = XUH_PARAM ,
      102     6681                    PROCNAME = VLP_EDIT ,
      103     6682                    OUTDCB1 = M$ME ,
      104     6683                    OUTDCB2 = M$DO ,
      105     6684                    KEYWORD = VLP_ERROR_SYN ,
      106     6685                    STCLASS = STATIC) ;
      107     6746        %VLP_NAME  (FPTN = VLP_ERROR_SYN ,
      108     6747                    NAME = 'ERROR_SYN' ,
      109     6748                    LEN = 9 ,
      110     6749                    STCLASS = CONSTANT) ;
      111     6776        %VLP_NAME  (FPTN = VLP_EDIT ,
      112     6777                    NAME = 'EDIT' ,
      113     6778                    LEN = 4 ,
      114     6779                    STCLASS = CONSTANT) ;
      115     6806        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:66   
      116     6807        /**********************************************************************/
      117     6808        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      118     6809        /**********************************************************************/
      119     6810    1   DCL 1 CMD_CNTRLWD BASED ALIGNED,        /* CONTROL WORD FOR CMD_TBL ENTRIES   */
      120     6811    1          2 FLAGS,
      121     6812    1             3 ENDCT BIT(1) UNAL,          /* LAST ENTRY                         */
      122     6813    1             3 * BIT(17) UNAL,
      123     6814    1          2 OFFSET UBIN(9) UNAL,           /* NUM. OF WORDS TO NEXT ENTRY        */
      124     6815    1          2 CMD_CODE UBIN(9) UNAL;         /* CODE FOR THIS COMMAND              */
      125     6816    1   DCL 1 SSE$PARAM BASED ALIGNED,          /*SSE TABLE ENTRY                     */
      126     6817    1          2 FLAGS,
      127     6818    1             3 CLMNFLAG BIT(1) UNAL,                    /* IF TRUE NEXT WORD IS CLMN#
      128     6819                                                                   ELSE PTR$ */
      129     6820    1             3 NOTFLAG BIT(1) UNAL,        /* LOG. OP. IS NOT                    */
      130     6821    1             3 ANDFLAG BIT(1) UNAL,        /* LOG. OP. IS AND                    */
      131     6822    1             3 ORFLAG BIT(1) UNAL,         /* LOG. OP. IS OR                     */
      132     6823    1             3 EORFLAG BIT(1) UNAL,        /* LOG. OP. IS EOR*/
      133     6824    1             3 * BIT(13) UNAL,
      134     6825    1          2 J SBIN HALF UNAL,              /* OCCURANCE NUMBER                   */
      135     6826    1          2 PTR$ PTR UNAL;                 /* POINTER TO STRING                  */
      136     6827    1   DCL 1 STR$BUF BASED ALIGNED,
      137     6828    1          2 COUNT UBIN(9) UNAL,
      138     6829    1          2 TEXT CHAR(255) UNAL;
      139     6830    1   DCL 1 STR$PARAM BASED ALIGNED,
      140     6831    1          2 COUNT UBIN WORD UNAL,
      141     6832    1          2 STR(0:0),
      142     6833    1             3 QM BIT(1) UNAL,
      143     6834    1             3 * BIT(17) UNAL,
      144     6835    1             3 QMCOUNT UBIN HALF UNAL,
      145     6836    1             3 PTR$ PTR UNAL;
      146     6837        /**/
      147     6838    1   DCL 1 ED_CMD_TBL BASED ALIGNED,         /* EDIT AND DELETE                    */
      148     6839    1          2 * BIT(36) UNAL,
      149     6840    1          2 FID$ PTR;
      150     6841    1   DCL 1 B_CMD_TBL BASED ALIGNED,          /* BUILD COMMAND                      */
      151     6842    1          2 * BIT(36) UNAL,
      152     6843    1          2 FID$ PTR UNAL,
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:67   
      153     6844    1          2 SEQNUM UBIN(36) UNAL,
      154     6845    1          2 INCR UBIN(36) UNAL,
      155     6846    1          2 TYPE CHAR(2) UNAL;
      156     6847    1   DCL 1 B_HELP_CMD_TBL BASED ALIGNED,     /* BUILD COMMAND                      */
      157     6848    1          2 * BIT(36) UNAL,
      158     6849    1          2 FID$ PTR UNAL,
      159     6850    1          2 HELPKEY CHAR(64) UNAL,
      160     6851    1          2 INCR UBIN WORD UNAL,
      161     6852    1          2 TYPE CHAR(2) UNAL;
      162     6853    1   DCL 1 C_CMD_TBL BASED ALIGNED,          /* COPY COMMAND                       */
      163     6854    1          2 * BIT(36) UNAL,
      164     6855    1          2 FID$ PTR UNAL,
      165     6856    1          2 FID2$ PTR UNAL,
      166     6857    1          2 ONOVER CHAR(4) UNAL,
      167     6858    1          2 SEQNUM UBIN(36) UNAL,
      168     6859    1          2 INCR UBIN(36) UNAL,
      169     6860    1          2 TYPE CHAR(2) UNAL;
      170     6861    1   DCL 1 M_CMD_TBL BASED ALIGNED,          /* MERGE COMMAND                      */
      171     6862    1          2 * BIT(36) UNAL,
      172     6863    1          2 FID$ PTR UNAL,
      173     6864    1          2 LO_SEQNUM,
      174     6865    1             3 KEY UBIN WORD UNAL ,
      175     6866    1          2 HI_SEQNUM ,
      176     6867    1             3 KEY UBIN WORD UNAL ,
      177     6868    1          2 ONOVER UBIN WORD UNAL,
      178     6869    1          2 FID2$ PTR UNAL,
      179     6870    1          2 LO_SEQNUM2 ,
      180     6871    1             3 KEY UBIN WORD UNAL ,
      181     6872    1          2 HI_SEQNUM2,
      182     6873    1             3 KEY UBIN WORD UNAL ,
      183     6874    1          2 INCR UBIN(36) UNAL;
      184     6875    1   DCL 1 BP_CMD_TBL BASED ALIGNED,
      185     6876    1          2 * BIT(36) UNAL,
      186     6877    1          2 TEXT CHAR(4) UNAL;
      187     6878    1   DCL 1 TA_CMD_TBL BASED ALIGNED,
      188     6879    1          2 * BIT(36) UNAL,
      189     6880    1          2 TABS(0:30) UBIN(9) UNAL,
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:68   
      190     6881    1          2 NUM_TABS UBIN(9) UNAL ;
      191     6882    1   DCL 1 TYPE_CMD_TBL BASED ALIGNED,
      192     6883    1          2 * BIT(36) UNAL,
      193     6884    1          2 CODE CHAR(2);
      194     6885    1   DCL 1 FILE_CMD_TBL BASED ALIGNED,
      195     6886    1          2 * BIT(36) UNAL,
      196     6887    1          2 CODE UBIN WORD ;
      197     6888    1   DCL 1 VE_CMD_TBL BASED ALIGNED,
      198     6889    1          2 * BIT(36) UNAL,
      199     6890    1          2 TYPE UBIN WORD UNAL;
      200     6891    1   DCL 1 DIR_CMD_TBL BASED ALIGNED ,       /* DIRECTORY                          */
      201     6892    1          2 * BIT(36) UNAL ,
      202     6893    1          2 CODE UBIN WORD UNAL ,
      203     6894    1          2 ACCT CHAR(8) UNAL ,
      204     6895    1          2 PSN CHAR(6) UNAL ;
      205     6896        /**/
      206     6897        %B$TCB;
      207     6900        %B$ALT;
      208     6908    1   DCL 1 VARY$STRC BASED ALIGNED ,
      209     6909    1          2 CNT UBIN BYTE UNAL ,
      210     6910    1          2 TXT CHAR(VARY$STRC.CNT) UNAL ;
      211     6911        /**/
      212     6912        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:69   
      213     6913        /***********************************************************************/
      214     6914        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
      215     6915        /**********************************************************************/
      216     6916    1   DCL VEH$ALL_HELP ENTRY ;
      217     6917    1   DCL VEX$CLMN_DFLT ENTRY;
      218     6918    1   DCL VEX$CHECK_CUTOFF ENTRY ALTRET ;
      219     6919    1   DCL VEX$DELREC ENTRY(3) ALTRET;
      220     6920    1   DCL VEX$ERROR ENTRY(2) ALTRET;
      221     6921    1   DCL VEX$ERRNEXT ENTRY ALTRET;
      222     6922    1   DCL VEX$ERRMAX ENTRY ALTRET;
      223     6923    1   DCL VEX$FID_2_FPT ENTRY(3) ALTRET;
      224     6924    1   DCL VEX$READ_RANDOM ENTRY(1) ALTRET;
      225     6925    1   DCL VEX$READ_SEQUEN ENTRY ALTRET;
      226     6926    1   DCL VEX$READ_TERM_REC ENTRY(3) ALTRET;
      227     6927    1   DCL VEX$SET_PROMPT ENTRY(1);
      228     6928    1   DCL VEX$SET_SUB_BUF ENTRY(2);
      229     6929    1   DCL VEX$SEQNUM_TEXT ENTRY(2);
      230     6930    1   DCL VEX$TYPE_REC ENTRY(1);
      231     6931    1   DCL VEX$WRITE_REC ENTRY(2) ALTRET;
      232     6932    1   DCL X$HELP ENTRY(1) ALTRET ;
      233     6933        /********************************************************************/
      234     6934        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
      235     6935        /********************************************************************/
      236     6936        /**/
      237     6937    1   DCL M$SI DCB;
      238     6938    1   DCL M$FILE DCB;                         /* READ EDIT FILE                     */
      239     6939    1   DCL M$FILE2 DCB;                        /* FOR MERGE AND COPY                 */
      240     6940    1   DCL M$DO DCB;                           /* ERROR MESSAGES                     */
      241     6941    1   DCL M$ME DCB;
      242     6942        /**/
      243     6943        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:70   
      244     6944        /*****************************************************************/
      245     6945        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
      246     6946        /*****************************************************************/
      247     6947        /**/
      248     6948        %INCLUDE VE_FLAGS_R;
      249     6999        %P_PCB (STCLASS = SYMREF) ;
      250     7198        /**/
      251     7199    1   DCL 1 P_ALLCMDS SYMREF ALIGNED,         /* NODE MACRO                         */
      252     7200    1          2 TYPE UBIN(9) UNAL,
      253     7201    1          2 NSUBNDS UBIN(9) UNAL,
      254     7202    1          2 CODE UBIN(18) UNAL,
      255     7203    1          2 * EPTR UNAL,
      256     7204    1          2 * EPTR UNAL,
      257     7205    1          2 * EPTR UNAL,
      258     7206    1          2 *(0:0) PTR UNAL;
      259     7207        /**/
      260     7208    1   DCL B$TCB$ PTR SYMREF;                  /* POINTER TO TCB                     */
      261     7209    1   DCL REC_BUF CHAR(PC_RECSIZE#) SYMREF;
      262     7210    1   DCL TEMP_BUF CHAR(PC_RECSIZE#) SYMREF;
      263     7211    1   DCL CMD_BUF CHAR(256) SYMREF;
      264     7212    1   DCL 1 TYPE_BUF SYMREF,
      265     7213    1          2 VFC CHAR(1) CALIGNED,
      266     7214    1          2 TEXT CHAR(PC_DISPRECSIZE#) CALIGNED;
      267     7215    1   DCL 1 SUB_BUF_1 SYMREF,
      268     7216    1          2 COUNT UBIN(9) UNAL,
      269     7217    1          2 TEXT CHAR(31) UNAL;
      270     7218    1   DCL 1 SUB_BUF_2 SYMREF,
      271     7219    1          2 COUNT UBIN(9) UNAL,
      272     7220    1          2 TEXT CHAR(31) UNAL;
      273     7221    1   DCL 1 SUB_BUF_3 SYMREF,
      274     7222    1          2 COUNT UBIN(9) UNAL,
      275     7223    1          2 TEXT CHAR(31) UNAL;
      276     7224    1   DCL SEQ_TEXT_BUF CHAR(9)  SYMREF;
      277     7225    1   DCL 1 CURR_FILE_NAME SYMREF,            /* Remember the FID being edited from*/
      278     7226    1          2 COUNT UBIN(9) CALIGNED,        /* before the COMMAND was executed   */
      279     7227    1          2 TEXT CHAR(31) CALIGNED;        /* that changed it.                  */
      280     7228    1   DCL   CURR_FILE_ACCT CHAR(8) SYMREF ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:71   
      281     7229    1   DCL   CURR_FILE_PASS CHAR(8) SYMREF ;
      282     7230    1   DCL 1 CURR_FILE_SN  SYMREF,
      283     7231    1          2 COUNT UBIN WORD,
      284     7232    1          2 SN CHAR(6) CALIGNED;
      285     7233    1   DCL 1 OPEN_FILE_NAME SYMREF,            /* EDIT FILE NAME                     */
      286     7234    1          2 COUNT UBIN(9) UNAL,
      287     7235    1          2 TEXT CHAR(31) UNAL;
      288     7236    1   DCL OPEN_FILE_ACCT CHAR(8) SYMREF;      /* EDIT FILE ACCT                     */
      289     7237    1   DCL OPEN_FILE_PASS CHAR(8) SYMREF;      /* EDIT FILE PASSWORD                 */
      290     7238    1   DCL 1 OPEN_FILE_SN SYMREF,
      291     7239    1          2 COUNT SBIN WORD,
      292     7240    1          2 SN CHAR(6) UNAL;
      293     7241    1   DCL 1 ERR_CODE SYMREF,
      294     7242    1          2 FCG_MID BIT(18) UNAL,
      295     7243    1          2 MON BIT(1) UNAL,
      296     7244    1          2 ERR# UBIN(14) UNAL,
      297     7245    1          2 SEV UBIN(3) UNAL;
      298     7246    1   DCL TYPE_CODE CHAR(2) SYMREF;
      299     7247    1   DCL SSE_INIT$ PTR SYMREF;
      300     7248    1   DCL REC_SIZE UBIN(36) SYMREF;           /* CHARACTER COUNT OF REC_BUF         */
      301     7249    1   DCL RP_REC_SIZE UBIN WORD SYMREF;       /* RECORD SIZE READ - FOR RP          */
      302     7250    1   DCL DVBYTE BIT(36) SYMREF ;
      303     7251    1   DCL LO_SRCH_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF SEARCH RANGE          */
      304     7252    1   DCL HI_SRCH_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF SEARCH RANGE         */
      305     7253    1   DCL LO_EXEC_CLMN UBIN(36) SYMREF;       /* LOW LIMIT OF CHANGEABLE RANGE      */
      306     7254    1   DCL HI_EXEC_CLMN UBIN(36) SYMREF;       /* HIGH LIMIT OF CHANGEABLE RANGE     */
      307     7255    1   DCL LO_SEQNUM UBIN(36) SYMREF ;         /* LOW LIMIT OF RECORD RANGE          */
      308     7256    1   DCL HI_SEQNUM UBIN(36) SYMREF ;         /* HIGH LIMIT OF RECORD RANGE         */
      309     7257    1   DCL EXEC_SEQNUM UBIN(36) SYMREF;        /* CURRENT RECORD BEING USED          */
      310     7258    1   DCL LIMIT_SEQNUM UBIN(36) SYMREF;       /* TEMP FOR SEARCHING RANGES          */
      311     7259    1   DCL CP_SEQNUM UBIN WORD SYMREF;         /* CP,CI BASE                         */
      312     7260    1   DCL INCR UBIN(36) SYMREF;               /* INCREMENT                          */
      313     7261    1   DCL DFLT_INCR UBIN(36) SYMREF ;
      314     7262    1   DCL LAST_KEY UBIN(36) SYMREF;           /* KEY OF LAST RECORD READ            */
      315     7263    1   DCL READ_KEY UBIN(36) SYMREF;           /* KEY TO BE USED TO READ RECORD      */
      316     7264    1   DCL SAVE_KEY UBIN(36) SYMREF;           /* KEY USED FOR TEMP IN MERGE         */
      317     7265    1   DCL TEMP_CLMN UBIN(36) SYMREF;          /* TEMP CELL FOR COLUMN NUM.          */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:72   
      318     7266    1   DCL TEMP_COUNT UBIN(36) SYMREF;
      319     7267    1   DCL CMD_CODE UBIN(36) SYMREF;           /* CODE FOR CURRENT COMMAND           */
      320     7268    1   DCL LAST_CMD UBIN(36) SYMREF;           /* SAVED CMD FOR ?? COMMAND           */
      321     7269    1   DCL REC_COUNT UBIN(36) SYMREF;          /* COUNT OF RECORDS OPERATED ON       */
      322     7270    1   DCL I UBIN(36) SYMREF;                  /* INDEX                              */
      323     7271    1   DCL M$FILE_NUM UBIN(36) SYMREF ;
      324     7272        /**/
      325     7273        %VLP_TAB (FPTN = TAB_VLP,
      326     7274                  STCLASS = SYMREF);
      327     7288        %VLP_TAB (FPTN = SAVE_TAB_VLP,
      328     7289                  STCLASS = SYMREF);
      329     7303    1   DCL M$FILE2_NUM UBIN(36) SYMREF ;
      330     7304    1   DCL NUM_TABS UBIN(36) SYMREF;
      331     7305    1   DCL VERIFY_TYPE UBIN WORD SYMREF;       /* VERIFY COMMAND CODE                */
      332     7306        /**/
      333     7307    1   DCL P$ PTR SYMREF;                      /* TEMP PTR                           */
      334     7308    1   DCL M$SI$ PTR SYMREF;
      335     7309    1   DCL M$UC$ PTR SYMREF;
      336     7310    1   DCL M$FILE$ PTR SYMREF;                 /* POINTER TO M$FILE                  */
      337     7311    1   DCL M$FILE2$ PTR SYMREF;
      338     7312    1   DCL CMD$ PTR SYMREF;                    /* POINTER TO RUN CMD_TBL             */
      339     7313    1   DCL SSE$ PTR SYMREF;
      340     7314    1   DCL COPYDS_PTR$ PTR SYMREF;
      341     7315        /**/
      342     7316    1   DCL 1 SSE_PARAM SYMREF,                 /* STRING SELECTION PARAM             */
      343     7317    1          2 FLAGS,
      344     7318    1             3 CLMNFLAG BIT(1) UNAL,
      345     7319    1             3 NOTFLAG BIT(1) UNAL,
      346     7320    1             3 ANDFLAG BIT(1) UNAL,
      347     7321    1             3 ORFLAG BIT(1) UNAL,
      348     7322    1             3 EORFLAG BIT(1) UNAL,
      349     7323    1             3 * BIT(13) UNAL,
      350     7324    1          2 J SBIN HALF UNAL,
      351     7325    1          2 PTR$ PTR UNAL;
      352     7326    1   DCL MAX_SEQNUM UBIN(36) SYMREF ;
      353     7327    1   DCL MAX_CLMN UBIN(36) SYMREF ;
      354     7328    1   DCL Y003 UBIN(36) SYMREF ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:73   
      355     7329    1   DCL SEQNUM_ONE UBIN(36) SYMREF ;
      356     7330    1   DCL B$JIT$ PTR SYMREF ;
      357     7331        /********************************************************************/
      358     7332        /*   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   AUTO   */
      359     7333        /********************************************************************/
      360     7334    1   DCL STATUS_FIELDS SBIN AUTO;
      361     7335    1   DCL REPSTATUS(0:NUMSTATUSOPTS) BIT(1) ALIGNED AUTO;
      362     7336    1   DCL LINELEN SBIN AUTO;
      363     7337    1   DCL TEMP_STR CHAR(80) AUTO;
      364     7338        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:74   
      365     7339        /*****************************************************************************/
      366     7340        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      367     7341        /*****************************************************************************/
      368     7342        /**/
      369     7343    1   VEF$EXEC_BP: ENTRY;

   7343  8 000003   000000 700200 xent  VEF$EXEC_BP  TSX0  ! X66_AUTO_0
         8 000004   000152 000000                    ZERO    106,0

      370     7344        /**/
      371     7345    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.BPFLAG = TRUE;

   7345  8 000005   000000 470400 xsym               LDP0    CMD$
         8 000006   040000 106500                    CMPC    fill='040'O
         8 000007   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         8 000010   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
         8 000011   000015 601000 8                  TNZ     s:7346

   7345  8 000012   001000 236003                    LDQ     512,DU
         8 000013   000000 256000 xsym               ORSQ    FLAGS
         8 000014   000017 710000 8                  TRA     s:7347

      372     7346    1        ELSE FLAGS.BPFLAG = FALSE;

   7346  8 000015   000000 236000 9                  LDQ     0
         8 000016   000000 356000 xsym               ANSQ    FLAGS

      373     7347    1        RETURN;

   7347  8 000017   000000 702200 xent               TSX2  ! X66_ARET

      374     7348        /**/
      375     7349        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:75   
      376     7350        /**/
      377     7351    1   VEF$EXEC_BUILD: ENTRY;

   7351  8 000020   000000 700200 xent  VEF$EXEC_BU* TSX0  ! X66_AUTO_0
         8 000021   000152 000000                    ZERO    106,0

      378     7352        /**/
      379     7353    2        IF (FLAGS.EDIT_MODE) THEN DO;

   7353  8 000022   000000 234000 xsym               SZN     FLAGS
         8 000023   000047 605000 8                  TPL     s:7368

      380     7354    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_BUILD_CLOSE_ERR1) ;

   7354  8 000024   000076 630400 2                  EPPR0   CLOSE_FPT
         8 000025   450001 713400                    CLIMB   alt,close
         8 000026   406000 401760                    pmme    nvectors=13
         8 000027   000030 702000 8                  TSX2    EXEC_BUILD_CLOSE_ERR1

      381     7355    2   EXEC_BUILD_CLOSE_ERR1:
      382     7356    2           CALL VEX$ERROR(E$E_EDITSTOP,1);

   7356  8 000030   000002 630400 9     EXEC_BUILD_* EPPR0   2
         8 000031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000032   000000 701000 xent               TSX1    VEX$ERROR
         8 000033   000000 011000                    NOP     0

      383     7357    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;

   7357  8 000034   000000 236000 xsym               LDQ     FLAGS
         8 000035   002000 316003                    CANQ    1024,DU
         8 000036   000041 600000 8                  TZE     s:7358

   7357  8 000037   000004 236000 9                  LDQ     4
         8 000040   000000 356000 xsym               ANSQ    FLAGS

      384     7358    2           FLAGS.EDIT_MODE = FALSE;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:76   

   7358  8 000041   000031 236000 xsym               LDQ     B_VECTNIL+25
         8 000042   000000 356000 xsym               ANSQ    FLAGS

      385     7359    2           FLAGS.CONSEC_MODE = FALSE;

   7359  8 000043   000005 236000 9                  LDQ     5
         8 000044   000000 356000 xsym               ANSQ    FLAGS

      386     7360    2           FLAGS.REL_MODE = FALSE;

   7360  8 000045   000006 236000 9                  LDQ     6
         8 000046   000000 356000 xsym               ANSQ    FLAGS

      387     7361    2           END;

      388     7362        /**/
      389     7363        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      390     7364                 MESSAGE:  EDIT stopped
      391     7365                 DESCRIPTION: The file currently open has been closed.
      392     7366        */
      393     7367        /**/
      394     7368    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */

   7368  8 000047   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000050   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         8 000051   000000 011000                    NOP     0

      395     7369    1        LO_SEQNUM = Y003;

   7369  8 000052   000000 235000 xsym               LDA     Y003
         8 000053   000000 755000 xsym               STA     LO_SEQNUM

      396     7370    1        HI_SEQNUM = MAX_SEQNUM;

   7370  8 000054   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 000055   000000 756000 xsym               STQ     HI_SEQNUM
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:77   

      397     7371    1        P$ = CMD$ -> B_CMD_TBL.FID$;

   7371  8 000056   000000 470400 xsym               LDP0    CMD$
         8 000057   000001 236100                    LDQ     1,,PR0
         8 000060   000000 756000 xsym               STQ     P$

      398     7372        /**/
      399     7373    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET (EXEC_BUILD_ERR2);

   7373  8 000061   000007 630400 9                  EPPR0   7
         8 000062   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000063   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 000064   000222 702000 8                  TSX2    EXEC_BUILD_ERR2

      400     7374        /**/
      401     7375    1        OPEN_FILE_FPT.V.FUN# = %CREATE#;

   7375  8 000065   003000 236007                    LDQ     1536,DL
         8 000066   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

      402     7376    1        OPEN_FILE_FPT.V.EXIST# = %ERROR#;

   7376  8 000067   000044 236000 1                  LDQ     OPEN_FILE_FPT+36
         8 000070   000012 376000 9                  ANQ     10
         8 000071   000200 276007                    ORQ     128,DL
         8 000072   000044 756000 1                  STQ     OPEN_FILE_FPT+36

      403     7377    1        OPEN_FILE_FPT.V.TYPE# = CMD$ -> B_CMD_TBL.TYPE;

   7377  8 000073   000000 470400 xsym               LDP0    CMD$
         8 000074   000004 220100                    LDX0    4,,PR0
         8 000075   000047 740000 1                  STX0    OPEN_FILE_FPT+39

      404     7378        /**/
      405     7379    1        CALL M$OPEN (OPEN_FILE_FPT) ALTRET (EXEC_BUILD_ERR);

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:78   
   7379  8 000076   000000 630400 1                  EPPR0   OPEN_FILE_FPT
         8 000077   450000 713400                    CLIMB   alt,open
         8 000100   410400 401760                    pmme    nvectors=18
         8 000101   000203 702000 8                  TSX2    EXEC_BUILD_ERR

      406     7380        /**/
      407     7381    1        FLAGS.EDIT_MODE= TRUE;

   7381  8 000102   400000 236003                    LDQ     -131072,DU
         8 000103   000000 256000 xsym               ORSQ    FLAGS

      408     7382    1        DVBYTE = '0'B ;

   7382  8 000104   000000 450000 xsym               STZ     DVBYTE

      409     7383    1        EXEC_SEQNUM = CMD$ -> B_CMD_TBL.SEQNUM;

   7383  8 000105   000000 470400 xsym               LDP0    CMD$
         8 000106   000002 235100                    LDA     2,,PR0
         8 000107   000000 755000 xsym               STA     EXEC_SEQNUM

      410     7384    1        INCR = CMD$ -> B_CMD_TBL.INCR;

   7384  8 000110   000003 235100                    LDA     3,,PR0
         8 000111   000000 755000 xsym               STA     INCR

      411     7385        /**/
      412     7386    2        DO WHILE (EXEC_SEQNUM <= MAX_SEQNUM); /* READ INPUT                   */

   7386  8 000112   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 000113   000000 116000 xsym               CMPQ    EXEC_SEQNUM
         8 000114   000176 602000 8                  TNC     s:7416

      413     7387    2           CALL VEX$SEQNUM_TEXT(EXEC_SEQNUM);

   7387  8 000115   000013 630400 9                  EPPR0   11
         8 000116   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:79   
         8 000117   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         8 000120   000000 011000                    NOP     0

      414     7388    2           CALL VEX$SET_PROMPT(PR_SEQNUM);

   7388  8 000121   000014 630400 9                  EPPR0   12
         8 000122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000123   000000 701000 xent               TSX1    VEX$SET_PROMPT
         8 000124   000000 011000                    NOP     0

      415     7389    2           CALL VEX$READ_TERM_REC(REC_BUF,REC_SIZE,SIZEC(REC_BUF))

   7389  8 000125   000016 630400 9                  EPPR0   14
         8 000126   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000127   000000 701000 xent               TSX1    VEX$READ_TERM_REC
         8 000130   000222 702000 8                  TSX2    EXEC_BUILD_ERR2

      416     7390    2              ALTRET (EXEC_BUILD_ERR2);
      417     7391    3           IF (REC_SIZE = 0) THEN DO;

   7391  8 000131   000000 235000 xsym               LDA     REC_SIZE
         8 000132   000154 601000 8                  TNZ     s:7405

      418     7392    4              IF (EXEC_SEQNUM ~= CMD$ -> B_CMD_TBL.SEQNUM) THEN DO;

   7392  8 000133   000000 470400 xsym               LDP0    CMD$
         8 000134   000000 236000 xsym               LDQ     EXEC_SEQNUM
         8 000135   000002 116100                    CMPQ    2,,PR0
         8 000136   000145 600000 8                  TZE     s:7400

      419     7393    4                 EXEC_SEQNUM = EXEC_SEQNUM - INCR;

   7393  8 000137   000000 136000 xsym               SBLQ    INCR
         8 000140   000000 756000 xsym               STQ     EXEC_SEQNUM

      420     7394    4                 LO_SEQNUM = EXEC_SEQNUM;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:80   
   7394  8 000141   000000 756000 xsym               STQ     LO_SEQNUM

      421     7395    4                 HI_SEQNUM = EXEC_SEQNUM;

   7395  8 000142   000000 756000 xsym               STQ     HI_SEQNUM

      422     7396    4                 LAST_KEY = EXEC_SEQNUM;

   7396  8 000143   000000 756000 xsym               STQ     LAST_KEY

      423     7397    4                 RETURN;

   7397  8 000144   000000 702200 xent               TSX2  ! X66_ARET

      424     7398    4                 END;
      425     7399        /**/
      426     7400    3              FLAGS.EDIT_MODE = FALSE;     /* RELEASE FILE - NO RECORDS          */

   7400  8 000145   000031 236000 xsym               LDQ     B_VECTNIL+25
         8 000146   000000 356000 xsym               ANSQ    FLAGS

      427     7401    3              CALL M$CLOSE(CLOSEREL_FPT) ALTRET(EXEC_BUILD_ERR);

   7401  8 000147   000172 630400 2                  EPPR0   CLOSEREL_FPT
         8 000150   450001 713400                    CLIMB   alt,close
         8 000151   406000 401760                    pmme    nvectors=13
         8 000152   000203 702000 8                  TSX2    EXEC_BUILD_ERR

      428     7402    3              RETURN;

   7402  8 000153   000000 702200 xent               TSX2  ! X66_ARET

      429     7403    3              END;
      430     7404        /**/
      431     7405    2           RP_REC_SIZE = REC_SIZE;

   7405  8 000154   000000 755000 xsym               STA     RP_REC_SIZE
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:81   

      432     7406    2           CALL VEX$WRITE_REC(M$FILE_NUM,EXEC_SEQNUM) ALTRET(EXEC_BUILD_ERR2);

   7406  8 000155   000021 630400 9                  EPPR0   17
         8 000156   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000157   000000 701000 xent               TSX1    VEX$WRITE_REC
         8 000160   000222 702000 8                  TSX2    EXEC_BUILD_ERR2

      433     7407    3           IF INCR = 0 THEN DO;

   7407  8 000161   000000 235000 xsym               LDA     INCR
         8 000162   000170 601000 8                  TNZ     s:7413

      434     7408    3              LO_SEQNUM = EXEC_SEQNUM ;

   7408  8 000163   000000 236000 xsym               LDQ     EXEC_SEQNUM
         8 000164   000000 756000 xsym               STQ     LO_SEQNUM

      435     7409    3              HI_SEQNUM = EXEC_SEQNUM ;

   7409  8 000165   000000 756000 xsym               STQ     HI_SEQNUM

      436     7410    3              LAST_KEY = EXEC_SEQNUM ;

   7410  8 000166   000000 756000 xsym               STQ     LAST_KEY

      437     7411    3              RETURN ;

   7411  8 000167   000000 702200 xent               TSX2  ! X66_ARET

      438     7412    3              END ;                        /* THEN DO                            */
      439     7413    2           EXEC_SEQNUM= EXEC_SEQNUM+INCR;

   7413  8 000170   000000 236000 xsym               LDQ     EXEC_SEQNUM
         8 000171   000000 036000 xsym               ADLQ    INCR
         8 000172   000000 756000 xsym               STQ     EXEC_SEQNUM

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:82   
      440     7414    2           END;

   7414  8 000173   000000 116000 xsym               CMPQ    MAX_SEQNUM
         8 000174   000115 602000 8                  TNC     s:7387
         8 000175   000115 600000 8                  TZE     s:7387

      441     7415        /**/
      442     7416    1        CALL VEX$ERROR(E$E_MAXSEQ,1);      /* MAX SEQ EXCEEDED                   */

   7416  8 000176   000024 630400 9                  EPPR0   20
         8 000177   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000200   000000 701000 xent               TSX1    VEX$ERROR
         8 000201   000000 011000                    NOP     0

      443     7417    1        RETURN;

   7417  8 000202   000000 702200 xent               TSX2  ! X66_ARET

      444     7418        /**/
      445     7419        /*E*     ERROR:    VEE-E$E_MAXSEQ-0
      446     7420                 MESSAGE:  Maximum sequence number exceeded
      447     7421                 MESSAGE1: The sequence number of the previous record plus
      448     7422                           the specified increment exceeds 99999.999
      449     7423                 DESCRIPTION: EDIT cannot prompt for another input record
      450     7424                           because the sequence number has gotten too large.
      451     7425        */
      452     7426        /**/
      453     7427        /*E*     ERROR:    VEE-E$E_MAXSEQ-0
      454     7428                 DESCRIPTION: EDIT cannot prompt for another input record
      455     7429                           because the sequence number has gotten too large.
      456     7430        */
      457     7431        /**/
      458     7432    1   EXEC_BUILD_ERR:
      459     7433    2        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$CREATERR) THEN DO;

   7433  8 000203   000000 470400 xsym  EXEC_BUILD_* LDP0    B$TCB$
         8 000204   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:83   
         8 000205   100102 236100                    LDQ     66,,PR1
         8 000206   377770 376007                    ANQ     131064,DL
         8 000207   001560 116007                    CMPQ    880,DL
         8 000210   000216 601000 8                  TNZ     s:7444

      460     7434    2           CALL VEX$ERROR (E$E_CANTBLD,3);

   7434  8 000211   000027 630400 9                  EPPR0   23
         8 000212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000213   000000 701000 xent               TSX1    VEX$ERROR
         8 000214   000000 011000                    NOP     0

      461     7435    2           RETURN;

   7435  8 000215   000000 702200 xent               TSX2  ! X66_ARET

      462     7436    2           END;
      463     7437        /**/
      464     7438        /*E*     ERROR:    VEE-E$E_CANTBLD-0
      465     7439                 MESSAGE:  Can't BUILD - file %%FN %exists
      466     7440                 MESSAGE1: You can't create file %%FN %- it already exists
      467     7441                 DESCRIPTION: An attempt was made to BUILD an existing file.
      468     7442        */
      469     7443        /**/
      470     7444    1        CALL VEX$ERROR(0,3);

   7444  8 000216   000031 630400 9                  EPPR0   25
         8 000217   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000220   000000 701000 xent               TSX1    VEX$ERROR
         8 000221   000000 011000                    NOP     0

      471     7445    1   EXEC_BUILD_ERR2:
      472     7446    1        RETURN;

   7446  8 000222   000000 702200 xent  EXEC_BUILD_* TSX2  ! X66_ARET

      473     7447        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:84   
      474     7448        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:85   
      475     7449        /**/
      476     7450    1   VEF$EXEC_COPY: ENTRY;

   7450  8 000223   000000 700200 xent  VEF$EXEC_CO* TSX0  ! X66_AUTO_0
         8 000224   000152 000000                    ZERO    106,0

      477     7451        /**/
      478     7452    2        IF (FLAGS.EDIT_MODE) THEN DO;

   7452  8 000225   000000 234000 xsym               SZN     FLAGS
         8 000226   000252 605000 8                  TPL     s:7466

      479     7453    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR1) ;

   7453  8 000227   000076 630400 2                  EPPR0   CLOSE_FPT
         8 000230   450001 713400                    CLIMB   alt,close
         8 000231   406000 401760                    pmme    nvectors=13
         8 000232   000233 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR1

      480     7454    2   EXEC_COPY_CLOSE_ERR1:
      481     7455    2           CALL VEX$ERROR(E$E_EDITSTOP,1);

   7455  8 000233   000002 630400 9     EXEC_COPY_C* EPPR0   2
         8 000234   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000235   000000 701000 xent               TSX1    VEX$ERROR
         8 000236   000000 011000                    NOP     0

      482     7456    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;

   7456  8 000237   000000 236000 xsym               LDQ     FLAGS
         8 000240   002000 316003                    CANQ    1024,DU
         8 000241   000244 600000 8                  TZE     s:7457

   7456  8 000242   000004 236000 9                  LDQ     4
         8 000243   000000 356000 xsym               ANSQ    FLAGS

      483     7457    2           FLAGS.EDIT_MODE=FALSE;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:86   

   7457  8 000244   000031 236000 xsym               LDQ     B_VECTNIL+25
         8 000245   000000 356000 xsym               ANSQ    FLAGS

      484     7458    2           FLAGS.CONSEC_MODE = FALSE;

   7458  8 000246   000005 236000 9                  LDQ     5
         8 000247   000000 356000 xsym               ANSQ    FLAGS

      485     7459    2           FLAGS.REL_MODE = FALSE;

   7459  8 000250   000006 236000 9                  LDQ     6
         8 000251   000000 356000 xsym               ANSQ    FLAGS

      486     7460    2           END;

      487     7461        /**/
      488     7462        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      489     7463                 DESCRIPTION: The open file has been closed.
      490     7464        */
      491     7465        /**/
      492     7466    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */

   7466  8 000252   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000253   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         8 000254   000000 011000                    NOP     0

      493     7467    1        LO_SEQNUM = Y003;

   7467  8 000255   000000 235000 xsym               LDA     Y003
         8 000256   000000 755000 xsym               STA     LO_SEQNUM

      494     7468    1        HI_SEQNUM = MAX_SEQNUM;

   7468  8 000257   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 000260   000000 756000 xsym               STQ     HI_SEQNUM

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:87   
      495     7469        /**/
      496     7470    1        P$ = CMD$ -> C_CMD_TBL.FID$;       /* SET UP OPPEN OF INPUT FILE         */

   7470  8 000261   000000 470400 xsym               LDP0    CMD$
         8 000262   000001 236100                    LDQ     1,,PR0
         8 000263   000000 756000 xsym               STQ     P$

      497     7471    1        DS_RESULTS = FALSE;                /* GET NEXT DS                        */

   7471  8 000264   000000 235003                    LDA     0,DU
         8 000265   000000 236003                    LDQ     0,DU
         8 000266   000276 757000 1                  STAQ    DS_RESULTS

      498     7472    1        CALL M$GDS(COPYDS_FPT) ALTRET (EXEC_COPY2_ERR);

   7472  8 000267   000366 630400 2                  EPPR0   COPYDS_FPT
         8 000270   430001 713400                    CLIMB   alt,gds
         8 000271   400400 401760                    pmme    nvectors=2
         8 000272   000575 702000 8                  TSX2    EXEC_COPY2_ERR

      499     7473    1        OPEN_FILE_FPT.FPARAM_ = DS_RESULTS;

   7473  8 000273   000276 237000 1                  LDAQ    DS_RESULTS
         8 000274   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      500     7474    1        OPEN_FILE2_FPT.IFPARAM_ = DS_RESULTS;

   7474  8 000275   000276 237000 1                  LDAQ    DS_RESULTS
         8 000276   000120 757000 1                  STAQ    OPEN_FILE2_FPT+22

      501     7475    1        COPYDS_PTR$ = DS_RESULTS.PTR$;

   7475  8 000277   000277 236000 1                  LDQ     DS_RESULTS+1
         8 000300   000000 756000 xsym               STQ     COPYDS_PTR$

      502     7476    1        CURR_FILE_NAME = OPEN_FILE_NAME; /* Remember Current name over the COPY */

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:88   
   7476  8 000301   000000 100400                    MLR     fill='000'O
         8 000302   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32
         8 000303   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32

      503     7477    1        CURR_FILE_SN = OPEN_FILE_SN;

   7477  8 000304   000000 100400                    MLR     fill='000'O
         8 000305   000000 000012 xsym               ADSC9   OPEN_FILE_SN             cn=0,n=10
         8 000306   000000 000012 xsym               ADSC9   CURR_FILE_SN             cn=0,n=10

      504     7478    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;

   7478  8 000307   040000 100400                    MLR     fill='040'O
         8 000310   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8
         8 000311   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8

      505     7479    1        CURR_FILE_PASS = OPEN_FILE_PASS;

   7479  8 000312   040000 100400                    MLR     fill='040'O
         8 000313   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8
         8 000314   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8

      506     7480    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET (EXEC_COPY_ERR);

   7480  8 000315   000007 630400 9                  EPPR0   7
         8 000316   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000317   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 000320   000632 702000 8                  TSX2    EXEC_COPY_ERR

      507     7481    1        OPEN_FILE_FPT.V.FUN# = %IN#;

   7481  8 000321   002000 236007                    LDQ     1024,DL
         8 000322   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

      508     7482    1        CALL M$OPEN(OPEN_FILE_FPT) ALTRET (EXEC_COPY2_ERR);

   7482  8 000323   000000 630400 1                  EPPR0   OPEN_FILE_FPT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:89   
         8 000324   450000 713400                    CLIMB   alt,open
         8 000325   410400 401760                    pmme    nvectors=18
         8 000326   000575 702000 8                  TSX2    EXEC_COPY2_ERR

      509     7483    2        IF (M$FILE$ -> F$DCB.ORG ~= %KEYED#) THEN DO;

   7483  8 000327   000000 470400 xsym               LDP0    M$FILE$
         8 000330   000032 236100                    LDQ     26,,PR0
         8 000331   777000 376003                    ANQ     -512,DU
         8 000332   002000 116003                    CMPQ    1024,DU
         8 000333   000370 600000 8                  TZE     s:7501

      510     7484    2           IF ((M$FILE$ -> F$DCB.ORG = %CONSEC#)OR

   7484  8 000334   001000 116003                    CMPQ    512,DU
         8 000335   000342 600000 8                  TZE     s:7487
         8 000336   004000 116003                    CMPQ    2048,DU
         8 000337   000342 600000 8                  TZE     s:7487
         8 000340   006000 116003                    CMPQ    3072,DU
         8 000341   000347 601000 8                  TNZ     s:7490

      511     7485    2              (M$FILE$ -> F$DCB.ORG = %UR#)OR
      512     7486    3              (M$FILE$ -> F$DCB.ORG = %INDEXED#)) THEN DO;

      513     7487    3              FLAGS.CONSEC_MODE = TRUE;

   7487  8 000342   002000 236003                    LDQ     1024,DU
         8 000343   000000 256000 xsym               ORSQ    FLAGS

      514     7488    3              LAST_KEY = Y003;

   7488  8 000344   000000 235000 xsym               LDA     Y003
         8 000345   000000 755000 xsym               STA     LAST_KEY

      515     7489    3              END;

   7489  8 000346   000370 710000 8                  TRA     s:7501
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:90   

      516     7490    2           ELSE IF (M$FILE$ -> F$DCB.ORG = %RELATIVE#) THEN FLAGS.REL_MODE = TRUE;

   7490  8 000347   005000 116003                    CMPQ    2560,DU
         8 000350   000354 601000 8                  TNZ     s:7493

   7490  8 000351   400000 236007                    LDQ     -131072,DL
         8 000352   000000 256000 xsym               ORSQ    FLAGS
         8 000353   000370 710000 8                  TRA     s:7501

      517     7491        /**/
      518     7492    3              ELSE DO;                     /* CANT COPY                          */

      519     7493    3                 CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR2) ;

   7493  8 000354   000076 630400 2                  EPPR0   CLOSE_FPT
         8 000355   450001 713400                    CLIMB   alt,close
         8 000356   406000 401760                    pmme    nvectors=13
         8 000357   000360 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR2

      520     7494    3   EXEC_COPY_CLOSE_ERR2:
      521     7495    3                 CALL M$FDS (COPYDS_FPT);

   7495  8 000360   000366 630400 2     EXEC_COPY_C* EPPR0   COPYDS_FPT
         8 000361   030002 713400                    CLIMB   fds
         8 000362   400400 401760                    pmme    nvectors=2

      522     7496    3                 CALL VEX$ERROR(E$E_CANTEDIT,3);

   7496  8 000363   000034 630400 9                  EPPR0   28
         8 000364   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000365   000000 701000 xent               TSX1    VEX$ERROR
         8 000366   000000 011000                    NOP     0

      523     7497    3                 RETURN;

   7497  8 000367   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:91   

      524     7498    3                 END;
      525     7499    2           END;
      526     7500        /**/
      527     7501    1        P$ = CMD$ -> C_CMD_TBL.FID2$;      /* SET UP OUTPUT FPT                  */

   7501  8 000370   000000 471400 xsym               LDP1    CMD$
         8 000371   100002 236100                    LDQ     2,,PR1
         8 000372   000000 756000 xsym               STQ     P$

      528     7502    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE2_FPT,0) ALTRET (EXEC_COPY_ERR);

   7502  8 000373   000036 630400 9                  EPPR0   30
         8 000374   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000375   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 000376   000632 702000 8                  TSX2    EXEC_COPY_ERR

      529     7503    1        OPEN_FILE2_FPT.V.FUN# = %CREATE#;

   7503  8 000377   003000 236007                    LDQ     1536,DL
         8 000400   000137 552010 1                  STBQ    OPEN_FILE2_FPT+37,'10'O

      530     7504    1        IF (CMD$ -> C_CMD_TBL.TYPE ~= ' ') THEN OPEN_FILE2_FPT.V.TYPE# =

   7504  8 000401   000000 470400 xsym               LDP0    CMD$
         8 000402   000006 220100                    LDX0    6,,PR0
         8 000403   040040 100003                    CMPX0   16416,DU
         8 000404   000406 600000 8                  TZE     s:7506

   7504  8 000405   000141 740000 1                  STX0    OPEN_FILE2_FPT+39

      531     7505    1              CMD$ -> C_CMD_TBL.TYPE;
      532     7506    1        IF (CMD$ -> C_CMD_TBL.ONOVER = 'ON') THEN

   7506  8 000406   040000 106500                    CMPC    fill='040'O
         8 000407   000003 000004                    ADSC9   3,,PR0                   cn=0,n=4
         8 000410   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:92   
         8 000411   000417 601000 8                  TNZ     s:7508

      533     7507    1           OPEN_FILE2_FPT.V.EXIST# = %ERROR#;

   7507  8 000412   000136 236000 1                  LDQ     OPEN_FILE2_FPT+36
         8 000413   000012 376000 9                  ANQ     10
         8 000414   000200 276007                    ORQ     128,DL
         8 000415   000136 756000 1                  STQ     OPEN_FILE2_FPT+36
         8 000416   000421 710000 8                  TRA     s:7509

      534     7508    1        ELSE OPEN_FILE2_FPT.V.EXIST# = %NEWFILE#; /* DONT TRASH 'ON' FILE     */

   7508  8 000417   000600 236007                    LDQ     384,DL
         8 000420   000136 256000 1                  ORSQ    OPEN_FILE2_FPT+36

      535     7509    1        CALL M$OPEN(OPEN_FILE2_FPT) ALTRET (EXEC_COPY2_ERR);

   7509  8 000421   000072 630400 1                  EPPR0   OPEN_FILE2_FPT
         8 000422   450000 713400                    CLIMB   alt,open
         8 000423   410400 401760                    pmme    nvectors=18
         8 000424   000575 702000 8                  TSX2    EXEC_COPY2_ERR

      536     7510        /**/
      537     7511    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);

   7511  8 000425   000042 237000 9                  LDAQ    34
         8 000426   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      538     7512    1        OPEN_FILE_FPT.IFPARAM_ = VECTOR(NIL);

   7512  8 000427   000042 237000 9                  LDAQ    34
         8 000430   000026 757000 1                  STAQ    OPEN_FILE_FPT+22

      539     7513        /**/
      540     7514    1        INCR = CMD$ -> C_CMD_TBL.INCR;

   7514  8 000431   000000 470400 xsym               LDP0    CMD$
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:93   
         8 000432   000005 235100                    LDA     5,,PR0
         8 000433   000000 755000 xsym               STA     INCR

      541     7515    2        IF INCR = 0 THEN DO ;

   7515  8 000434   000442 601000 8                  TNZ     s:7525

      542     7516    2           CALL VEX$ERROR( E$E_BADINCR,3);

   7516  8 000435   000045 630400 9                  EPPR0   37
         8 000436   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000437   000000 701000 xent               TSX1    VEX$ERROR
         8 000440   000000 011000                    NOP     0

      543     7517    2           GOTO EXEC_COPY_ERR ;

   7517  8 000441   000632 710000 8                  TRA     EXEC_COPY_ERR

      544     7518    2           END ;                           /* THEN DO                            */
      545     7519        /**/
      546     7520        /*E*     ERROR:    VEE-E$E_BADINCR-0
      547     7521                 MESSAGE:  Illegal increment.
      548     7522                 DESCRIPTION: An increment of 0 was input for COPY command.
      549     7523        */
      550     7524        /**/
      551     7525    1        EXEC_SEQNUM = CMD$ -> C_CMD_TBL.SEQNUM;

   7525  8 000442   000004 235100                    LDA     4,,PR0
         8 000443   000000 755000 xsym               STA     EXEC_SEQNUM

      552     7526    1        CALL VEX$ERROR(E$E_COPYING,1);

   7526  8 000444   000050 630400 9                  EPPR0   40
         8 000445   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000446   000000 701000 xent               TSX1    VEX$ERROR
         8 000447   000000 011000                    NOP     0

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:94   
      553     7527        /**/
      554     7528        /*E*     ERROR:    VEE-E$E_COPYING-0
      555     7529                 MESSAGE:  Copying
      556     7530                 DESCRIPTION: The COPY operation has been started.
      557     7531        */
      558     7532        /**/
      559     7533    1        CALL VEX$READ_SEQUEN ALTRET (EXEC_COPY_ERR); /* READ FIRST RECORD     */

   7533  8 000450   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000451   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         8 000452   000632 702000 8                  TSX2    EXEC_COPY_ERR

      560     7534    2        IF (EXEC_SEQNUM > MAX_SEQNUM) THEN DO WHILE (~FLAGS.EOF);
              7534                 /* SAME SEQ. NUMBERS */

   7534  8 000453   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 000454   000000 116000 xsym               CMPQ    EXEC_SEQNUM
         8 000455   000474 603000 8                  TRC     s:7538

   7534  8 000456   000466 710000 8                  TRA     s:7537

      561     7535    2           CALL VEX$WRITE_REC(M$FILE2_NUM,LAST_KEY) ALTRET (EXEC_COPY_ERR);

   7535  8 000457   000052 630400 9                  EPPR0   42
         8 000460   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000461   000000 701000 xent               TSX1    VEX$WRITE_REC
         8 000462   000632 702000 8                  TSX2    EXEC_COPY_ERR

      562     7536    2           CALL VEX$READ_SEQUEN ALTRET (EXEC_COPY_ERR);

   7536  8 000463   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000464   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         8 000465   000632 702000 8                  TSX2    EXEC_COPY_ERR

      563     7537    2           END;

   7537  8 000466   000000 236000 xsym               LDQ     FLAGS
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:95   
         8 000467   000005 736000                    QLS     5
         8 000470   400000 376003                    ANQ     -131072,DU
         8 000471   400000 676003                    ERQ     -131072,DU
         8 000472   000457 601000 8                  TNZ     s:7535
         8 000473   000524 710000 8                  TRA     s:7554

      564     7538    2        ELSE DO WHILE (~FLAGS.EOF);        /* RENUMBER                           */

   7538  8 000474   000517 710000 8                  TRA     s:7552

      565     7539    2           CALL VEX$WRITE_REC (M$FILE2_NUM,EXEC_SEQNUM) ALTRET

   7539  8 000475   000054 630400 9                  EPPR0   44
         8 000476   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000477   000000 701000 xent               TSX1    VEX$WRITE_REC
         8 000500   000632 702000 8                  TSX2    EXEC_COPY_ERR

      566     7540    2              (EXEC_COPY_ERR);
      567     7541    2           CALL VEX$READ_SEQUEN ALTRET (EXEC_COPY_ERR);

   7541  8 000501   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000502   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         8 000503   000632 702000 8                  TSX2    EXEC_COPY_ERR

      568     7542    2           EXEC_SEQNUM = EXEC_SEQNUM + INCR;

   7542  8 000504   000000 236000 xsym               LDQ     EXEC_SEQNUM
         8 000505   000000 036000 xsym               ADLQ    INCR
         8 000506   000000 756000 xsym               STQ     EXEC_SEQNUM

      569     7543    3           IF (EXEC_SEQNUM > MAX_SEQNUM) THEN DO;

   7543  8 000507   000000 116000 xsym               CMPQ    MAX_SEQNUM
         8 000510   000517 602000 8                  TNC     s:7552
         8 000511   000517 600000 8                  TZE     s:7552

      570     7544    3              CALL VEX$ERROR(E$E_MAXSEQ,1);
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:96   

   7544  8 000512   000024 630400 9                  EPPR0   20
         8 000513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000514   000000 701000 xent               TSX1    VEX$ERROR
         8 000515   000000 011000                    NOP     0

      571     7545    3              GOTO COPY_CLOSE2 ;

   7545  8 000516   000541 710000 8                  TRA     COPY_CLOSE2

      572     7546    3              END;
      573     7547        /**/
      574     7548        /*E*     ERROR:    VEE-E$E_MAXSEQ-0
      575     7549                 DESCRIPTION: Overran the sequence number limit durring a
      576     7550                           COPY operation.
      577     7551        */
      578     7552    2           END;

   7552  8 000517   000000 236000 xsym               LDQ     FLAGS
         8 000520   000005 736000                    QLS     5
         8 000521   400000 376003                    ANQ     -131072,DU
         8 000522   400000 676003                    ERQ     -131072,DU
         8 000523   000475 601000 8                  TNZ     s:7539

      579     7553        /**/
      580     7554    1        CALL VEX$ERROR(E$E_COPYDONE,1);    /* COPY DONE                          */

   7554  8 000524   000057 630400 9                  EPPR0   47
         8 000525   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000526   000000 701000 xent               TSX1    VEX$ERROR
         8 000527   000000 011000                    NOP     0

      581     7555        /**/
      582     7556        /*E*     ERROR:    VEE-E$E_COPYDONE-0
      583     7557                 MESSAGE:  COPY done
      584     7558                 DESCRIPTION: The COPY operation is over.
      585     7559        */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:97   
      586     7560    1   COPY_CLOSE:
      587     7561    1        CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR3) ;

   7561  8 000530   000076 630400 2     COPY_CLOSE   EPPR0   CLOSE_FPT
         8 000531   450001 713400                    CLIMB   alt,close
         8 000532   406000 401760                    pmme    nvectors=13
         8 000533   000534 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR3

      588     7562    1   EXEC_COPY_CLOSE_ERR3:
      589     7563    1        CALL M$CLOSE(CLOSE2_FPT) ALTRET(EXEC_COPY_CLOSE_ERR4) ;

   7563  8 000534   000164 630400 1     EXEC_COPY_C* EPPR0   CLOSE2_FPT
         8 000535   450001 713400                    CLIMB   alt,close
         8 000536   406000 401760                    pmme    nvectors=13
         8 000537   000551 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR4

      590     7564    2        DO WHILE ('0'B) ;

   7564  8 000540   000551 710000 8                  TRA     EXEC_COPY_CLOSE_ERR4

      591     7565    2   COPY_CLOSE2:
      592     7566    2           CALL M$CLOSE(CLOSEDFLT_FPT) ALTRET(EXEC_COPY_CLOSE_ERR9) ;

   7566  8 000541   000134 630400 2     COPY_CLOSE2  EPPR0   CLOSEDFLT_FPT
         8 000542   450001 713400                    CLIMB   alt,close
         8 000543   406000 401760                    pmme    nvectors=13
         8 000544   000545 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR9

      593     7567    2   EXEC_COPY_CLOSE_ERR9:
      594     7568    2           CALL M$CLOSE(CLOSE2DFLT_FPT) ALTRET(EXEC_COPY_CLOSE_ERR4) ;

   7568  8 000545   000222 630400 1     EXEC_COPY_C* EPPR0   CLOSE2DFLT_FPT
         8 000546   450001 713400                    CLIMB   alt,close
         8 000547   406000 401760                    pmme    nvectors=13
         8 000550   000551 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR4

      595     7569    2           END ;                           /* Do While */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:98   

      596     7570    1   EXEC_COPY_CLOSE_ERR4:
      597     7571    1        CALL M$FDS(COPYDS_FPT);

   7571  8 000551   000366 630400 2     EXEC_COPY_C* EPPR0   COPYDS_FPT
         8 000552   030002 713400                    CLIMB   fds
         8 000553   400400 401760                    pmme    nvectors=2

      598     7572        /**/
      599     7573    1        OPEN_FILE_FPT.V.FUN# = %UPDATE#;

   7573  8 000554   001000 236007                    LDQ     512,DL
         8 000555   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

      600     7574    1        OPEN_FILE_FPT.ACCT_ = OPEN_FILE2_FPT.ACCT_ ;

   7574  8 000556   000116 237000 1                  LDAQ    OPEN_FILE2_FPT+20
         8 000557   000024 757000 1                  STAQ    OPEN_FILE_FPT+20

      601     7575    1        OPEN_FILE_FPT.PASS_ = OPEN_FILE2_FPT.PASS_ ;

   7575  8 000560   000102 237000 1                  LDAQ    OPEN_FILE2_FPT+8
         8 000561   000010 757000 1                  STAQ    OPEN_FILE_FPT+8

      602     7576    1        CALL M$OPEN (OPEN_FILE_FPT) ALTRET (EXEC_COPY_ERR);

   7576  8 000562   000000 630400 1                  EPPR0   OPEN_FILE_FPT
         8 000563   450000 713400                    CLIMB   alt,open
         8 000564   410400 401760                    pmme    nvectors=18
         8 000565   000632 702000 8                  TSX2    EXEC_COPY_ERR

      603     7577    1        FLAGS.EDIT_MODE = TRUE;

   7577  8 000566   400000 236003                    LDQ     -131072,DU
         8 000567   000000 256000 xsym               ORSQ    FLAGS

      604     7578    1        FLAGS.REL_MODE = FALSE;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:99   

   7578  8 000570   000006 236000 9                  LDQ     6
         8 000571   000000 356000 xsym               ANSQ    FLAGS

      605     7579    1        FLAGS.CONSEC_MODE = FALSE;

   7579  8 000572   000005 236000 9                  LDQ     5
         8 000573   000000 356000 xsym               ANSQ    FLAGS

      606     7580        /**/
      607     7581    1        RETURN;

   7581  8 000574   000000 702200 xent               TSX2  ! X66_ARET

      608     7582        /**/
      609     7583    1   EXEC_COPY2_ERR:
      610     7584    2        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$CREATERR) THEN DO;

   7584  8 000575   000000 470400 xsym  EXEC_COPY2_* LDP0    B$TCB$
         8 000576   000000 471500                    LDP1    0,,PR0
         8 000577   100102 236100                    LDQ     66,,PR1
         8 000600   377770 376007                    ANQ     131064,DL
         8 000601   001560 116007                    CMPQ    880,DL
         8 000602   000623 601000 8                  TNZ     s:7600

      611     7585    2           CALL VEX$ERROR(E$E_ONEXTS,3);   /* 'ON' FILE EXISTS                  */

   7585  8 000603   000062 630400 9                  EPPR0   50
         8 000604   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000605   000000 701000 xent               TSX1    VEX$ERROR
         8 000606   000000 011000                    NOP     0

      612     7586    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR5) ;

   7586  8 000607   000076 630400 2                  EPPR0   CLOSE_FPT
         8 000610   450001 713400                    CLIMB   alt,close
         8 000611   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:100  
         8 000612   000613 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR5

      613     7587    2   EXEC_COPY_CLOSE_ERR5:
      614     7588    2           CALL M$FDS(COPYDS_FPT);

   7588  8 000613   000366 630400 2     EXEC_COPY_C* EPPR0   COPYDS_FPT
         8 000614   030002 713400                    CLIMB   fds
         8 000615   400400 401760                    pmme    nvectors=2

      615     7589    2           OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);

   7589  8 000616   000042 237000 9                  LDAQ    34
         8 000617   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      616     7590    2           OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);

   7590  8 000620   000042 237000 9                  LDAQ    34
         8 000621   000120 757000 1                  STAQ    OPEN_FILE2_FPT+22

      617     7591    2           RETURN;

   7591  8 000622   000000 702200 xent               TSX2  ! X66_ARET

      618     7592    2           END;
      619     7593        /**/
      620     7594        /*E*     ERROR:    VEE-E$E_ONEXTS-0
      621     7595                 MESSAGE:  'ON' file exists
      622     7596                 MESSAGE1: Can't COPY - file %%FN %exists
      623     7597                 DESCRIPTION: An attempt was made to COPY 'ON' an
      624     7598                           existing file.
      625     7599        */
      626     7600    1        CALL VEX$ERROR(0,3);

   7600  8 000623   000031 630400 9                  EPPR0   25
         8 000624   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000625   000000 701000 xent               TSX1    VEX$ERROR
         8 000626   000000 011000                    NOP     0
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:101  

      627     7601    1        OPEN_FILE_NAME = CURR_FILE_NAME;

   7601  8 000627   000000 100400                    MLR     fill='000'O
         8 000630   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32
         8 000631   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32

      628     7602    1   EXEC_COPY_ERR:
      629     7603    1        IF (SUBSTR(CMD$ -> C_CMD_TBL.FID$ -> STR$BUF.TEXT,0,

   7603  8 000632   000000 470400 xsym  EXEC_COPY_E* LDP0    CMD$
         8 000633   000001 471500                    LDP1    1,,PR0
         8 000634   100000 236100                    LDQ     0,,PR1
         8 000635   000033 772000                    QRL     27
         8 000636   000002 473500                    LDP3    2,,PR0
         8 000637   000000 620006                    EAX0    0,QL
         8 000640   300000 236100                    LDQ     0,,PR3
         8 000641   000033 772000                    QRL     27
         8 000642   000000 621006                    EAX1    0,QL
         8 000643   040140 106540                    CMPC    fill='040'O
         8 000644   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         8 000645   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
         8 000646   000671 601000 8                  TNZ     s:7616

      630     7604    1           CMD$ -> C_CMD_TBL.FID$ -> STR$BUF.COUNT) =
      631     7605    1           SUBSTR(CMD$ -> C_CMD_TBL.FID2$ -> STR$BUF.TEXT,0,
      632     7606    2           CMD$ -> C_CMD_TBL.FID2$ -> STR$BUF.COUNT)) THEN DO; /* SAME FILE    */

      633     7607    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR6) ;
              7607                    /* DONT TRASH FILE                    */

   7607  8 000647   000076 630400 2                  EPPR0   CLOSE_FPT
         8 000650   450001 713400                    CLIMB   alt,close
         8 000651   406000 401760                    pmme    nvectors=13
         8 000652   000653 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR6

      634     7608    2   EXEC_COPY_CLOSE_ERR6:
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:102  
      635     7609    2           CALL M$CLOSE (CLOSE2REL_FPT);

   7609  8 000653   000230 630400 2     EXEC_COPY_C* EPPR0   CLOSE2REL_FPT
         8 000654   050001 713400                    CLIMB   close
         8 000655   406000 401760                    pmme    nvectors=13

      636     7610    2           IF (OPEN_FILE_FPT.FPARAM_ ~= VECTOR(NIL)) THEN CALL M$FDS(COPYDS_FPT);

   7610  8 000656   000030 237000 1                  LDAQ    OPEN_FILE_FPT+24
         8 000657   000042 117000 9                  CMPAQ   34
         8 000660   000664 600000 8                  TZE     s:7611

   7610  8 000661   000366 630400 2                  EPPR0   COPYDS_FPT
         8 000662   030002 713400                    CLIMB   fds
         8 000663   400400 401760                    pmme    nvectors=2

      637     7611    2           OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);

   7611  8 000664   000042 237000 9                  LDAQ    34
         8 000665   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      638     7612    2           OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);

   7612  8 000666   000042 237000 9                  LDAQ    34
         8 000667   000120 757000 1                  STAQ    OPEN_FILE2_FPT+22

      639     7613    2           RETURN;

   7613  8 000670   000000 702200 xent               TSX2  ! X66_ARET

      640     7614    2           END;
      641     7615        /**/
      642     7616    1        CALL M$CLOSE (CLOSE_FPT) ALTRET(EXEC_COPY_CLOSE_ERR7) ;

   7616  8 000671   000076 630400 2                  EPPR0   CLOSE_FPT
         8 000672   450001 713400                    CLIMB   alt,close
         8 000673   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:103  
         8 000674   000675 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR7

      643     7617    1   EXEC_COPY_CLOSE_ERR7:
      644     7618    1        CALL M$CLOSE (CLOSE2_FPT) ALTRET(EXEC_COPY_CLOSE_ERR8) ;

   7618  8 000675   000164 630400 1     EXEC_COPY_C* EPPR0   CLOSE2_FPT
         8 000676   450001 713400                    CLIMB   alt,close
         8 000677   406000 401760                    pmme    nvectors=13
         8 000700   000701 702000 8                  TSX2    EXEC_COPY_CLOSE_ERR8

      645     7619    1   EXEC_COPY_CLOSE_ERR8:
      646     7620    1        IF (OPEN_FILE_FPT.FPARAM_ ~= VECTOR(NIL)) THEN CALL M$FDS(COPYDS_FPT);

   7620  8 000701   000030 237000 1     EXEC_COPY_C* LDAQ    OPEN_FILE_FPT+24
         8 000702   000042 117000 9                  CMPAQ   34
         8 000703   000707 600000 8                  TZE     s:7621

   7620  8 000704   000366 630400 2                  EPPR0   COPYDS_FPT
         8 000705   030002 713400                    CLIMB   fds
         8 000706   400400 401760                    pmme    nvectors=2

      647     7621    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);

   7621  8 000707   000042 237000 9                  LDAQ    34
         8 000710   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      648     7622    1        OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);

   7622  8 000711   000042 237000 9                  LDAQ    34
         8 000712   000120 757000 1                  STAQ    OPEN_FILE2_FPT+22

      649     7623    1        RETURN;

   7623  8 000713   000000 702200 xent               TSX2  ! X66_ARET

      650     7624        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:104  
      651     7625        /**/
      652     7626    1   VEF$EXEC_CR: ENTRY;

   7626  8 000714   000000 700200 xent  VEF$EXEC_CR  TSX0  ! X66_AUTO_0
         8 000715   000152 000000                    ZERO    106,0

      653     7627        /**/
      654     7628    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.CRFLAG = TRUE;

   7628  8 000716   000000 470400 xsym               LDP0    CMD$
         8 000717   040000 106500                    CMPC    fill='040'O
         8 000720   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         8 000721   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
         8 000722   000726 601000 8                  TNZ     s:7629

   7628  8 000723   000400 236003                    LDQ     256,DU
         8 000724   000000 256000 xsym               ORSQ    FLAGS
         8 000725   000730 710000 8                  TRA     s:7630

      655     7629    1        ELSE FLAGS.CRFLAG = FALSE;

   7629  8 000726   000064 236000 9                  LDQ     52
         8 000727   000000 356000 xsym               ANSQ    FLAGS

      656     7630    1        RETURN;

   7630  8 000730   000000 702200 xent               TSX2  ! X66_ARET

      657     7631        /**/
      658     7632        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:105  
      659     7633        /**/
      660     7634    1   VEF$EXEC_DELETE: ENTRY;

   7634  8 000731   000000 700200 xent  VEF$EXEC_DE* TSX0  ! X66_AUTO_0
         8 000732   000152 000000                    ZERO    106,0

      661     7635        /**/
      662     7636    1        CURR_FILE_NAME = OPEN_FILE_NAME; /* Remember Current name over the DELETE */

   7636  8 000733   000000 100400                    MLR     fill='000'O
         8 000734   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32
         8 000735   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32

      663     7637    1        CURR_FILE_SN = OPEN_FILE_SN;

   7637  8 000736   000000 100400                    MLR     fill='000'O
         8 000737   000000 000012 xsym               ADSC9   OPEN_FILE_SN             cn=0,n=10
         8 000740   000000 000012 xsym               ADSC9   CURR_FILE_SN             cn=0,n=10

      664     7638    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;

   7638  8 000741   040000 100400                    MLR     fill='040'O
         8 000742   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8
         8 000743   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8

      665     7639    1        CURR_FILE_PASS = OPEN_FILE_PASS;

   7639  8 000744   040000 100400                    MLR     fill='040'O
         8 000745   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8
         8 000746   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8

      666     7640        /**/
      667     7641    1        P$ = CMD$ -> ED_CMD_TBL.FID$;

   7641  8 000747   000000 470400 xsym               LDP0    CMD$
         8 000750   000001 236100                    LDQ     1,,PR0
         8 000751   000000 756000 xsym               STQ     P$
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:106  

      668     7642    1        DELETE_FPT = DELETE_FPT_C;

   7642  8 000752   000100 100400                    MLR     fill='000'O
         8 000753   000004 000350 2                  ADSC9   DELETE_FPT_C             cn=0,n=232
         8 000754   200004 000350                    ADSC9   DELETE_FPT,,AUTO         cn=0,n=232

      669     7643    1        DELETE_FPT.V_ = VECTOR(DELETE_FPT.V);

   7643  8 000755   000065 235000 9                  LDA     53
         8 000756   200146 452500                    STP2    LENGTH+1,,AUTO
         8 000757   200146 236100                    LDQ     LENGTH+1,,AUTO
         8 000760   000050 036003                    ADLQ    40,DU
         8 000761   200004 757100                    STAQ    DELETE_FPT,,AUTO

      670     7644    1        CALL VEX$FID_2_FPT(P$,DELETE_FPT,0) ALTRET (EXEC_DELETE_RET);

   7644  8 000762   000011 236000 9                  LDQ     9
         8 000763   200150 756100                    STQ     LENGTH+3,,AUTO
         8 000764   200004 631500                    EPPR1   DELETE_FPT,,AUTO
         8 000765   200147 451500                    STP1    LENGTH+2,,AUTO
         8 000766   000007 236000 9                  LDQ     7
         8 000767   200146 756100                    STQ     LENGTH+1,,AUTO
         8 000770   200146 630500                    EPPR0   LENGTH+1,,AUTO
         8 000771   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 000772   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 000773   001065 702000 8                  TSX2    EXEC_DELETE_RET

      671     7645        /**/
      672     7646    1        IF (CURR_FILE_NAME.TEXT = OPEN_FILE_NAME.TEXT) AND

   7646  8 000774   040000 106400                    CMPC    fill='040'O
         8 000775   000000 200037 xsym               ADSC9   CURR_FILE_NAME           cn=1,n=31
         8 000776   000000 200037 xsym               ADSC9   OPEN_FILE_NAME           cn=1,n=31
         8 000777   001050 601000 8                  TNZ     s:7670
         8 001000   040000 106400                    CMPC    fill='040'O
         8 001001   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:107  
         8 001002   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8
         8 001003   001050 601000 8                  TNZ     s:7670
         8 001004   040000 106400                    CMPC    fill='040'O
         8 001005   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8
         8 001006   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8
         8 001007   001050 601000 8                  TNZ     s:7670
         8 001010   040000 106400                    CMPC    fill='040'O
         8 001011   000001 000006 xsym               ADSC9   CURR_FILE_SN+1           cn=0,n=6
         8 001012   000001 000006 xsym               ADSC9   OPEN_FILE_SN+1           cn=0,n=6
         8 001013   001050 601000 8                  TNZ     s:7670

      673     7647    1           (CURR_FILE_ACCT = OPEN_FILE_ACCT) AND
      674     7648    1           (CURR_FILE_PASS = OPEN_FILE_PASS) AND
      675     7649    2           (CURR_FILE_SN.SN = OPEN_FILE_SN.SN) THEN DO;

      676     7650                 /* DELeting current file must close it first */
      677     7651    3           IF (FLAGS.EDIT_MODE) THEN DO;

   7651  8 001014   000000 234000 xsym               SZN     FLAGS
         8 001015   001041 605000 8                  TPL     s:7665

      678     7652    3              CALL VEX$ERROR(E$E_EDITSTOP,1);

   7652  8 001016   000002 630400 9                  EPPR0   2
         8 001017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001020   000000 701000 xent               TSX1    VEX$ERROR
         8 001021   000000 011000                    NOP     0

      679     7653    3              IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;

   7653  8 001022   000000 236000 xsym               LDQ     FLAGS
         8 001023   002000 316003                    CANQ    1024,DU
         8 001024   001027 600000 8                  TZE     s:7654

   7653  8 001025   000004 236000 9                  LDQ     4
         8 001026   000000 356000 xsym               ANSQ    FLAGS

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:108  
      680     7654    3              CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_DELETE_CLOSE_ERR1) ;

   7654  8 001027   000076 630400 2                  EPPR0   CLOSE_FPT
         8 001030   450001 713400                    CLIMB   alt,close
         8 001031   406000 401760                    pmme    nvectors=13
         8 001032   001033 702000 8                  TSX2    EXEC_DELETE_CLOSE_ERR1

      681     7655    3   EXEC_DELETE_CLOSE_ERR1:
      682     7656    3              FLAGS.EDIT_MODE = FALSE;

   7656  8 001033   000031 236000 xsym  EXEC_DELETE* LDQ     B_VECTNIL+25
         8 001034   000000 356000 xsym               ANSQ    FLAGS

      683     7657    3              FLAGS.CONSEC_MODE = FALSE;

   7657  8 001035   000005 236000 9                  LDQ     5
         8 001036   000000 356000 xsym               ANSQ    FLAGS

      684     7658    3              FLAGS.REL_MODE = FALSE;

   7658  8 001037   000006 236000 9                  LDQ     6
         8 001040   000000 356000 xsym               ANSQ    FLAGS

      685     7659    3              END;

      686     7660        /**/
      687     7661        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      688     7662                    DESCRIPTION: The currently open file has been closed.
      689     7663        */
      690     7664        /**/
      691     7665    2           CALL VEX$CLMN_DFLT;             /* RESET SELECTION PARAMETERS         */

   7665  8 001041   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 001042   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         8 001043   000000 011000                    NOP     0

      692     7666    2           LO_SEQNUM = Y003;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:109  

   7666  8 001044   000000 235000 xsym               LDA     Y003
         8 001045   000000 755000 xsym               STA     LO_SEQNUM

      693     7667    2           HI_SEQNUM = MAX_SEQNUM;

   7667  8 001046   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 001047   000000 756000 xsym               STQ     HI_SEQNUM

      694     7668    2           END;                            /* IF DELeting current file */

      695     7669        /**/
      696     7670    1        CALL M$OPEN(DELETE_FPT) ALTRET (EXEC_DELETE_ERR);

   7670  8 001050   200004 630500                    EPPR0   DELETE_FPT,,AUTO
         8 001051   450000 713400                    CLIMB   alt,open
         8 001052   410400 401760                    pmme    nvectors=18
         8 001053   001061 702000 8                  TSX2    EXEC_DELETE_ERR

      697     7671    1        CALL VEX$ERROR(E$E_DELETED,1);

   7671  8 001054   000067 630400 9                  EPPR0   55
         8 001055   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001056   000000 701000 xent               TSX1    VEX$ERROR
         8 001057   000000 011000                    NOP     0

      698     7672        /**/
      699     7673        /*E*     ERROR:    VEE-E$E_DELETED-0
      700     7674                 MESSAGE:  Deleted
      701     7675                 DESCRIPTION: The specified file has been deleted.
      702     7676        */
      703     7677    1        GOTO EXEC_DELETE_RET;

   7677  8 001060   001065 710000 8                  TRA     EXEC_DELETE_RET

      704     7678        /**/
      705     7679    1   EXEC_DELETE_ERR:
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:110  
      706     7680    1        CALL VEX$ERROR(0,SYSFLAGLEV);

   7680  8 001061   000031 630400 9     EXEC_DELETE* EPPR0   25
         8 001062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001063   000000 701000 xent               TSX1    VEX$ERROR
         8 001064   000000 011000                    NOP     0

      707     7681    1   EXEC_DELETE_RET:
      708     7682    1        OPEN_FILE_NAME = CURR_FILE_NAME;   /* Restore Current file name after DEL*/

   7682  8 001065   000000 100400       EXEC_DELETE* MLR     fill='000'O
         8 001066   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32
         8 001067   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32

      709     7683    1        OPEN_FILE_SN = CURR_FILE_SN;

   7683  8 001070   000000 100400                    MLR     fill='000'O
         8 001071   000000 000012 xsym               ADSC9   CURR_FILE_SN             cn=0,n=10
         8 001072   000000 000012 xsym               ADSC9   OPEN_FILE_SN             cn=0,n=10

      710     7684    1        OPEN_FILE_ACCT = CURR_FILE_ACCT;

   7684  8 001073   040000 100400                    MLR     fill='040'O
         8 001074   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8
         8 001075   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8

      711     7685    1        OPEN_FILE_PASS = CURR_FILE_PASS;

   7685  8 001076   040000 100400                    MLR     fill='040'O
         8 001077   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8
         8 001100   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8

      712     7686    1        RETURN;

   7686  8 001101   000000 702200 xent               TSX2  ! X66_ARET

      713     7687        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:111  
      714     7688        /**/
      715     7689    1   VEF$EXEC_EDIT: ENTRY;

   7689  8 001102   000000 700200 xent  VEF$EXEC_ED* TSX0  ! X66_AUTO_0
         8 001103   000152 000000                    ZERO    106,0

      716     7690        /**/
      717     7691    2        IF (FLAGS.EDIT_MODE) THEN DO;      /* ALREADY HAVE A FILE OPEN           */

   7691  8 001104   000000 234000 xsym               SZN     FLAGS
         8 001105   001125 605000 8                  TPL     s:7700

      718     7692    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_EDIT_CLOSE_ERR1) ;

   7692  8 001106   000076 630400 2                  EPPR0   CLOSE_FPT
         8 001107   450001 713400                    CLIMB   alt,close
         8 001110   406000 401760                    pmme    nvectors=13
         8 001111   001112 702000 8                  TSX2    EXEC_EDIT_CLOSE_ERR1

      719     7693    2   EXEC_EDIT_CLOSE_ERR1:
      720     7694    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;

   7694  8 001112   000000 236000 xsym  EXEC_EDIT_C* LDQ     FLAGS
         8 001113   002000 316003                    CANQ    1024,DU
         8 001114   001117 600000 8                  TZE     s:7695

   7694  8 001115   000004 236000 9                  LDQ     4
         8 001116   000000 356000 xsym               ANSQ    FLAGS

      721     7695    2           FLAGS.EDIT_MODE = FALSE;

   7695  8 001117   000031 236000 xsym               LDQ     B_VECTNIL+25
         8 001120   000000 356000 xsym               ANSQ    FLAGS

      722     7696    2           FLAGS.CONSEC_MODE = FALSE;

   7696  8 001121   000005 236000 9                  LDQ     5
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:112  
         8 001122   000000 356000 xsym               ANSQ    FLAGS

      723     7697    2           FLAGS.REL_MODE = FALSE;

   7697  8 001123   000006 236000 9                  LDQ     6
         8 001124   000000 356000 xsym               ANSQ    FLAGS

      724     7698    2           END;

      725     7699        /**/
      726     7700    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */

   7700  8 001125   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 001126   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         8 001127   000000 011000                    NOP     0

      727     7701    1        LO_SEQNUM = Y003;

   7701  8 001130   000000 235000 xsym               LDA     Y003
         8 001131   000000 755000 xsym               STA     LO_SEQNUM

      728     7702    1        HI_SEQNUM = MAX_SEQNUM;

   7702  8 001132   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 001133   000000 756000 xsym               STQ     HI_SEQNUM

      729     7703        /**/
      730     7704    1        P$ = CMD$ -> ED_CMD_TBL.FID$;

   7704  8 001134   000000 470400 xsym               LDP0    CMD$
         8 001135   000001 236100                    LDQ     1,,PR0
         8 001136   000000 756000 xsym               STQ     P$

      731     7705    1        CURR_FILE_NAME =    OPEN_FILE_NAME;/* Remember Current NAME for EDIT*/

   7705  8 001137   000000 100400                    MLR     fill='000'O
         8 001140   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:113  
         8 001141   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32

      732     7706    1        CURR_FILE_SN = OPEN_FILE_SN;

   7706  8 001142   000000 100400                    MLR     fill='000'O
         8 001143   000000 000012 xsym               ADSC9   OPEN_FILE_SN             cn=0,n=10
         8 001144   000000 000012 xsym               ADSC9   CURR_FILE_SN             cn=0,n=10

      733     7707    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;

   7707  8 001145   040000 100400                    MLR     fill='040'O
         8 001146   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8
         8 001147   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8

      734     7708    1        CURR_FILE_PASS = OPEN_FILE_PASS;

   7708  8 001150   040000 100400                    MLR     fill='040'O
         8 001151   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8
         8 001152   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8

      735     7709    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET (EXEC_EDIT_RET);

   7709  8 001153   000007 630400 9                  EPPR0   7
         8 001154   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001155   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 001156   001411 702000 8                  TSX2    EXEC_EDIT_RET

      736     7710        /**/
      737     7711    1        IF (CMD_CODE = EXAMINECMD) THEN OPEN_FILE_FPT.V.FUN# = %IN#;

   7711  8 001157   000000 235000 xsym               LDA     CMD_CODE
         8 001160   000061 115007                    CMPA    49,DL
         8 001161   001165 601000 8                  TNZ     s:7712

   7711  8 001162   002000 236007                    LDQ     1024,DL
         8 001163   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O
         8 001164   001167 710000 8                  TRA     RETRY_OPEN
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:114  

      738     7712    1        ELSE OPEN_FILE_FPT.V.FUN# = %UPDATE#;

   7712  8 001165   001000 236007                    LDQ     512,DL
         8 001166   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

      739     7713        /**/
      740     7714    1   RETRY_OPEN:
      741     7715    1        CALL M$OPEN(OPEN_FILE_FPT) ALTRET (EXEC_EDIT_ERR);

   7715  8 001167   000000 630400 1     RETRY_OPEN   EPPR0   OPEN_FILE_FPT
         8 001170   450000 713400                    CLIMB   alt,open
         8 001171   410400 401760                    pmme    nvectors=18
         8 001172   001365 702000 8                  TSX2    EXEC_EDIT_ERR

      742     7716    1        CALL M$TRUNC (TRUNC_FPT);

   7716  8 001173   000000 630400 2                  EPPR0   TRUNC_FPT
         8 001174   050003 713400                    CLIMB   20483
         8 001175   400000 401760                    pmme    nvectors=1

      743     7717        /**/
      744     7718    2        IF (M$FILE$ -> F$DCB.ORG = %RELATIVE#) THEN DO;

   7718  8 001176   000000 470400 xsym               LDP0    M$FILE$
         8 001177   000032 236100                    LDQ     26,,PR0
         8 001200   777000 376003                    ANQ     -512,DU
         8 001201   005000 116003                    CMPQ    2560,DU
         8 001202   001212 601000 8                  TNZ     s:7727

      745     7719    2           FLAGS.REL_MODE = TRUE;

   7719  8 001203   400000 236007                    LDQ     -131072,DL
         8 001204   000000 256000 xsym               ORSQ    FLAGS

      746     7720    2           CALL VEX$ERROR(E$E_RELFILE,2);

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:115  
   7720  8 001205   000072 630400 9                  EPPR0   58
         8 001206   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001207   000000 701000 xent               TSX1    VEX$ERROR
         8 001210   000000 011000                    NOP     0

      747     7721    2           END;

   7721  8 001211   001263 710000 8                  TRA     s:7761

      748     7722        /**/
      749     7723        /*E*     ERROR:    VEE-E$E_RELFILE-0
      750     7724                 MESSAGE:  File %%FN %is a relative file
      751     7725                 DESCRIPTION: INFORM USER ABOUT RELATIVE FILE    */
      752     7726        /**/
      753     7727    1        ELSE IF ((M$FILE$ -> F$DCB.ORG = %CONSEC#)OR

   7727  8 001212   001000 116003                    CMPQ    512,DU
         8 001213   001220 600000 8                  TZE     s:7730
         8 001214   004000 116003                    CMPQ    2048,DU
         8 001215   001220 600000 8                  TZE     s:7730
         8 001216   006000 116003                    CMPQ    3072,DU
         8 001217   001250 601000 8                  TNZ     s:7749

      754     7728    1              (M$FILE$ -> F$DCB.ORG = %UR#)OR
      755     7729    2              (M$FILE$ -> F$DCB.ORG = %INDEXED#)) THEN DO;

      756     7730    2              IF (M$FILE$ -> F$DCB.ORG = %UR#) THEN /* POSIT. UR FILE TO BEGINING */

   7730  8 001220   004000 116003                    CMPQ    2048,DU
         8 001221   001225 601000 8                  TNZ     s:7732

      757     7731    2                 CALL M$PFIL (PFIL_FPT);

   7731  8 001222   000362 630400 2                  EPPR0   PFIL_FPT
         8 001223   040004 713400                    CLIMB   16388
         8 001224   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:116  
      758     7732    2              FLAGS.CONSEC_MODE = TRUE;

   7732  8 001225   002000 236003                    LDQ     1024,DU
         8 001226   000000 256000 xsym               ORSQ    FLAGS

      759     7733    2              FLAGS.RPFLAG = TRUE;

   7733  8 001227   000200 236003                    LDQ     128,DU
         8 001230   000000 256000 xsym               ORSQ    FLAGS

      760     7734    2              LAST_KEY = Y003;

   7734  8 001231   000000 235000 xsym               LDA     Y003
         8 001232   000000 755000 xsym               STA     LAST_KEY

      761     7735    2              IF ((M$FILE$ -> F$DCB.FFLG.DELR)OR

   7735  8 001233   000000 470400 xsym               LDP0    M$FILE$
         8 001234   000004 236100                    LDQ     4,,PR0
         8 001235   200000 316003                    CANQ    65536,DU
         8 001236   001243 601000 8                  TNZ     s:7738
         8 001237   100000 316003                    CANQ    32768,DU
         8 001240   001243 601000 8                  TNZ     s:7738
         8 001241   040000 316003                    CANQ    16384,DU
         8 001242   001263 600000 8                  TZE     s:7761

      762     7736    2                 (M$FILE$ -> F$DCB.FFLG.WNEW)OR
      763     7737    2                 (M$FILE$ -> F$DCB.FFLG.UPD)) THEN
      764     7738    2                 CALL VEX$ERROR(E$E_NOTKEYED,3); /* NOT INPUT ONLY            */

   7738  8 001243   000075 630400 9                  EPPR0   61
         8 001244   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001245   000000 701000 xent               TSX1    VEX$ERROR
         8 001246   000000 011000                    NOP     0

      765     7739    2              END;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:117  
   7739  8 001247   001263 710000 8                  TRA     s:7761

      766     7740        /**/
      767     7741        /*E*     ERROR:    VEE-E$E_NOTKEYED-0
      768     7742                 MESSAGE:  File %%FN %is not a keyed file - limited updating - RP mode set
      769     7743                 MESSAGE1: A consecutive, unit record or indexed file has been
      770     7744                           opened. You may alter records or add to the end of the
      771     7745                           file, however no insert or delete type commands are
      772     7746                           allowed. Also RP mode is ON and may not be turned off.
      773     7747                 DESCRIPTION: A request was made to edit a consec file --    */
      774     7748        /**/
      775     7749    2           ELSE IF (M$FILE$ -> F$DCB.ORG ~= %KEYED#) THEN DO;

   7749  8 001250   002000 116003                    CMPQ    1024,DU
         8 001251   001263 600000 8                  TZE     s:7761

      776     7750    2                 CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_EDIT_CLOSE_ERR2) ;

   7750  8 001252   000076 630400 2                  EPPR0   CLOSE_FPT
         8 001253   450001 713400                    CLIMB   alt,close
         8 001254   406000 401760                    pmme    nvectors=13
         8 001255   001256 702000 8                  TSX2    EXEC_EDIT_CLOSE_ERR2

      777     7751    2   EXEC_EDIT_CLOSE_ERR2:
      778     7752    2                 CALL VEX$ERROR(E$E_CANTEDIT,3);

   7752  8 001256   000034 630400 9     EXEC_EDIT_C* EPPR0   28
         8 001257   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001260   000000 701000 xent               TSX1    VEX$ERROR
         8 001261   000000 011000                    NOP     0

      779     7753    2                 RETURN;

   7753  8 001262   000000 702200 xent               TSX2  ! X66_ARET

      780     7754    2                 END;
      781     7755        /*E*     ERROR:    VEE-E$E_CANTEDIT-0
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:118  
      782     7756                 MESSAGE: Cannot EDIT file %%FN %
      783     7757                 MESSAGE1: File %%FN %is not a keyed,consecutive,relative,indexed,
      784     7758                           or unit record type file. EDIT cannot help you with it.
      785     7759                 DESCRIPTION: FILE IS NOT EDIT FORMAT - FORGET IT  */
      786     7760        /**/
      787     7761    2        IF (CMD_CODE ~= EXAMINECMD) THEN DO;

   7761  8 001263   000000 235000 xsym               LDA     CMD_CODE
         8 001264   000061 115007                    CMPA    49,DL
         8 001265   001362 600000 8                  TZE     s:7796

      788     7762    2           IF ((NOT(M$FILE$ -> F$DCB.FFLG.DELR))AND

   7762  8 001266   000000 470400 xsym               LDP0    M$FILE$
         8 001267   000004 236100                    LDQ     4,,PR0
         8 001270   200000 316003                    CANQ    65536,DU
         8 001271   001303 601000 8                  TNZ     s:7774
         8 001272   100000 316003                    CANQ    32768,DU
         8 001273   001303 601000 8                  TNZ     s:7774
         8 001274   040000 316003                    CANQ    16384,DU
         8 001275   001303 601000 8                  TNZ     s:7774

      789     7763    2              (NOT(M$FILE$ -> F$DCB.FFLG.WNEW))AND
      790     7764    3              (NOT(M$FILE$ -> F$DCB.FFLG.UPD))) THEN DO;

      791     7765    3              CALL VEX$ERROR(E$E_INONLY,1);

   7765  8 001276   000100 630400 9                  EPPR0   64
         8 001277   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001300   000000 701000 xent               TSX1    VEX$ERROR
         8 001301   000000 011000                    NOP     0

      792     7766    3              END;

   7766  8 001302   001362 710000 8                  TRA     s:7796

      793     7767        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:119  
      794     7768        /*E*     ERROR:    VEE-E$E_INONLY-0
      795     7769                 MESSAGE:  File %%FN %is open input - cannot update
      796     7770                 DESCRIPTION: An attempt was made to edit a file that the
      797     7771                           user doesn't have write access to.
      798     7772        */
      799     7773    3           ELSE DO;

      800     7774    3              IF ~(M$FILE$ -> F$DCB.FFLG.DELR) THEN /* CANT DELETE RECORDS    */

   7774  8 001303   000004 236100                    LDQ     4,,PR0
         8 001304   000001 736000                    QLS     1
         8 001305   400000 376003                    ANQ     -131072,DU
         8 001306   400000 676003                    ERQ     -131072,DU
         8 001307   001322 600000 8                  TZE     s:7781

      801     7775    3                 CALL VEX$ERROR(E$E_CANTDEL,ADDR(NIL));

   7775  8 001310   000001 236000 xsym               LDQ     B_VECTNIL+1
         8 001311   200146 756100                    STQ     LENGTH+1,,AUTO
         8 001312   200146 631500                    EPPR1   LENGTH+1,,AUTO
         8 001313   200151 451500                    STP1    LENGTH+4,,AUTO
         8 001314   000103 236000 9                  LDQ     67
         8 001315   200150 756100                    STQ     LENGTH+3,,AUTO
         8 001316   200150 630500                    EPPR0   LENGTH+3,,AUTO
         8 001317   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001320   000000 701000 xent               TSX1    VEX$ERROR
         8 001321   000000 011000                    NOP     0

      802     7776        /**/
      803     7777        /*E*     ERROR:    VEE-E$E_CANTDEL-0
      804     7778                 MESSAGE:  You are not allowed to delete records from this file.
      805     7779                 DESCRIPTION: Delete record access is denied.      */
      806     7780        /**/
      807     7781    3              IF ~(M$FILE$ -> F$DCB.FFLG.WNEW) THEN /* CANT WRITE NEW RECORDS */

   7781  8 001322   000000 470400 xsym               LDP0    M$FILE$
         8 001323   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:120  
         8 001324   000002 736000                    QLS     2
         8 001325   400000 376003                    ANQ     -131072,DU
         8 001326   400000 676003                    ERQ     -131072,DU
         8 001327   001342 600000 8                  TZE     s:7788

      808     7782    3                 CALL VEX$ERROR(E$E_CANTWNEW,ADDR(NIL));

   7782  8 001330   000001 236000 xsym               LDQ     B_VECTNIL+1
         8 001331   200146 756100                    STQ     LENGTH+1,,AUTO
         8 001332   200146 631500                    EPPR1   LENGTH+1,,AUTO
         8 001333   200151 451500                    STP1    LENGTH+4,,AUTO
         8 001334   000105 236000 9                  LDQ     69
         8 001335   200150 756100                    STQ     LENGTH+3,,AUTO
         8 001336   200150 630500                    EPPR0   LENGTH+3,,AUTO
         8 001337   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001340   000000 701000 xent               TSX1    VEX$ERROR
         8 001341   000000 011000                    NOP     0

      809     7783        /**/
      810     7784        /*E*     ERROR:    VEE-E$E_CANTWNEW-0
      811     7785                 MESSAGE:  You cannot add records to this file
      812     7786                 DESCRIPTION: New record access denied.  */
      813     7787        /**/
      814     7788    3              IF ~(M$FILE$ -> F$DCB.FFLG.UPD) THEN
              7788                       /* CANT OVERWRITE EXISTING RECORDS */

   7788  8 001342   000000 470400 xsym               LDP0    M$FILE$
         8 001343   000004 236100                    LDQ     4,,PR0
         8 001344   000003 736000                    QLS     3
         8 001345   400000 376003                    ANQ     -131072,DU
         8 001346   400000 676003                    ERQ     -131072,DU
         8 001347   001362 600000 8                  TZE     s:7796

      815     7789    3                 CALL VEX$ERROR(E$E_CANTUPDAT,ADDR(NIL));

   7789  8 001350   000001 236000 xsym               LDQ     B_VECTNIL+1
         8 001351   200146 756100                    STQ     LENGTH+1,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:121  
         8 001352   200146 631500                    EPPR1   LENGTH+1,,AUTO
         8 001353   200151 451500                    STP1    LENGTH+4,,AUTO
         8 001354   000107 236000 9                  LDQ     71
         8 001355   200150 756100                    STQ     LENGTH+3,,AUTO
         8 001356   200150 630500                    EPPR0   LENGTH+3,,AUTO
         8 001357   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001360   000000 701000 xent               TSX1    VEX$ERROR
         8 001361   000000 011000                    NOP     0

      816     7790        /**/
      817     7791        /*E*     ERROR:    VEE-E$E_CANTUPDAT-0
      818     7792                 MESSAGE:  You cannot overwrite existing records in this file
      819     7793                 DESCRIPTION: UPD  access denied.        */
      820     7794    3              END;

      821     7795    2           END;

      822     7796    1        FLAGS.EDIT_MODE = TRUE;

   7796  8 001362   400000 236003                    LDQ     -131072,DU
         8 001363   000000 256000 xsym               ORSQ    FLAGS

      823     7797    1        RETURN;

   7797  8 001364   000000 702200 xent               TSX2  ! X66_ARET

      824     7798        /**/
      825     7799    1   EXEC_EDIT_ERR:
      826     7800    1        IF (CMD_CODE = EDITCMD)AND

   7800  8 001365   000000 235000 xsym  EXEC_EDIT_E* LDA     CMD_CODE
         8 001366   000026 115007                    CMPA    22,DL
         8 001367   001405 601000 8                  TNZ     s:7806
         8 001370   000000 470400 xsym               LDP0    B$TCB$
         8 001371   000000 471500                    LDP1    0,,PR0
         8 001372   100102 236100                    LDQ     66,,PR1
         8 001373   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:122  
         8 001374   001550 116007                    CMPQ    872,DL
         8 001375   001405 601000 8                  TNZ     s:7806
         8 001376   000045 236000 1                  LDQ     OPEN_FILE_FPT+37
         8 001377   777000 376007                    ANQ     -512,DL
         8 001400   002000 116007                    CMPQ    1024,DL
         8 001401   001405 600000 8                  TZE     s:7806

      827     7801    1           (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$FILEBUSY)AND
      828     7802    2           (OPEN_FILE_FPT.V.FUN# ~= %IN#) THEN DO;

      829     7803    2           OPEN_FILE_FPT.V.FUN# = %IN#;

   7803  8 001402   002000 236007                    LDQ     1024,DL
         8 001403   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

      830     7804    2           GOTO RETRY_OPEN;

   7804  8 001404   001167 710000 8                  TRA     RETRY_OPEN

      831     7805    2           END;
      832     7806    1        CALL VEX$ERROR(0,SYSFLAGLEV);

   7806  8 001405   000031 630400 9                  EPPR0   25
         8 001406   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001407   000000 701000 xent               TSX1    VEX$ERROR
         8 001410   000000 011000                    NOP     0

      833     7807    1   EXEC_EDIT_RET:
      834     7808    1        RETURN;

   7808  8 001411   000000 702200 xent  EXEC_EDIT_R* TSX2  ! X66_ARET

      835     7809        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:123  
      836     7810        /**/
      837     7811    1   VEF$EXEC_END: ENTRY;

   7811  8 001412   000000 700200 xent  VEF$EXEC_END TSX0  ! X66_AUTO_0
         8 001413   000152 000000                    ZERO    106,0

      838     7812        /**/
      839     7813    1        CALL M$CLOSE (CLOSE_FPT) ALTRET(EXEC_END_CLOSE_ERR1) ;

   7813  8 001414   000076 630400 2                  EPPR0   CLOSE_FPT
         8 001415   450001 713400                    CLIMB   alt,close
         8 001416   406000 401760                    pmme    nvectors=13
         8 001417   001420 702000 8                  TSX2    EXEC_END_CLOSE_ERR1

      840     7814    1   EXEC_END_CLOSE_ERR1:
      841     7815    1        CALL M$CLOSE (CLOSE2_FPT) ALTRET(EXEC_END_CLOSE_ERR2) ;

   7815  8 001420   000164 630400 1     EXEC_END_CL* EPPR0   CLOSE2_FPT
         8 001421   450001 713400                    CLIMB   alt,close
         8 001422   406000 401760                    pmme    nvectors=13
         8 001423   001424 702000 8                  TSX2    EXEC_END_CLOSE_ERR2

      842     7816    1   EXEC_END_CLOSE_ERR2:
      843     7817    1        CALL M$CLOSE(CLOSE_ME_FPT);

   7817  8 001424   000266 630400 2     EXEC_END_CL* EPPR0   CLOSE_ME_FPT
         8 001425   050001 713400                    CLIMB   close
         8 001426   406000 401760                    pmme    nvectors=13

      844     7818    1        CALL M$CLOSE (CLOSE_DO_FPT);

   7818  8 001427   000324 630400 2                  EPPR0   CLOSE_DO_FPT
         8 001430   050001 713400                    CLIMB   close
         8 001431   406000 401760                    pmme    nvectors=13

      845     7819    1        TAB_VLP = SAVE_TAB_VLP;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:124  
   7819  8 001432   000000 100400                    MLR     fill='000'O
         8 001433   000000 000040 xsym               ADSC9   SAVE_TAB_VLP             cn=0,n=32
         8 001434   000000 000040 xsym               ADSC9   TAB_VLP                  cn=0,n=32

      846     7820    1        CALL M$DEVICE(TAB_FPT);

   7820  8 001435   000374 630400 2                  EPPR0   TAB_FPT
         8 001436   050006 713400                    CLIMB   20486
         8 001437   401000 401760                    pmme    nvectors=3

      847     7821    1        CALL M$EXIT;

   7821  8 001440   000001 713400                    CLIMB   exit
         8 001441   000000 401760                    pmme    nvectors=0
         8 001442   001445 710000 8                  TRA     s:7827

      848     7822        /**/
      849     7823        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:125  
      850     7824        /**/
      851     7825    1   VEF$EXEC_MERGE: ENTRY;

   7825  8 001443   000000 700200 xent  VEF$EXEC_ME* TSX0  ! X66_AUTO_0
         8 001444   000152 000000                    ZERO    106,0

      852     7826        /**/
      853     7827    2        IF (FLAGS.EDIT_MODE) THEN DO;      /* CLOSE OPEN FILE                    */

   7827  8 001445   000000 234000 xsym               SZN     FLAGS
         8 001446   001472 605000 8                  TPL     s:7841

      854     7828    2           CALL VEX$ERROR(E$E_EDITSTOP,1); /* EDIT STOPPED...*/

   7828  8 001447   000002 630400 9                  EPPR0   2
         8 001450   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001451   000000 701000 xent               TSX1    VEX$ERROR
         8 001452   000000 011000                    NOP     0

      855     7829    2           CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR1) ;

   7829  8 001453   000076 630400 2                  EPPR0   CLOSE_FPT
         8 001454   450001 713400                    CLIMB   alt,close
         8 001455   406000 401760                    pmme    nvectors=13
         8 001456   001457 702000 8                  TSX2    EXEC_MERGE_CLOSE_ERR1

      856     7830    2   EXEC_MERGE_CLOSE_ERR1:
      857     7831    2           IF (FLAGS.CONSEC_MODE) THEN FLAGS.RPFLAG = FALSE;

   7831  8 001457   000000 236000 xsym  EXEC_MERGE_* LDQ     FLAGS
         8 001460   002000 316003                    CANQ    1024,DU
         8 001461   001464 600000 8                  TZE     s:7832

   7831  8 001462   000004 236000 9                  LDQ     4
         8 001463   000000 356000 xsym               ANSQ    FLAGS

      858     7832    2           FLAGS.EDIT_MODE=FALSE;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:126  

   7832  8 001464   000031 236000 xsym               LDQ     B_VECTNIL+25
         8 001465   000000 356000 xsym               ANSQ    FLAGS

      859     7833    2           FLAGS.CONSEC_MODE = FALSE;

   7833  8 001466   000005 236000 9                  LDQ     5
         8 001467   000000 356000 xsym               ANSQ    FLAGS

      860     7834    2           FLAGS.REL_MODE = FALSE;

   7834  8 001470   000006 236000 9                  LDQ     6
         8 001471   000000 356000 xsym               ANSQ    FLAGS

      861     7835    2           END;

      862     7836        /**/
      863     7837        /*E*     ERROR:    VEE-E$E_EDITSTOP-0
      864     7838                 DESCRIPTION: The currently open file has been closed.
      865     7839        */
      866     7840        /**/
      867     7841    1        CALL VEX$CLMN_DFLT;                /* RESET SELECTION PARAMETERS         */

   7841  8 001472   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 001473   000000 701000 xent               TSX1    VEX$CLMN_DFLT
         8 001474   000000 011000                    NOP     0

      868     7842    1        LO_SEQNUM = Y003;

   7842  8 001475   000000 235000 xsym               LDA     Y003
         8 001476   000000 755000 xsym               STA     LO_SEQNUM

      869     7843    1        HI_SEQNUM = MAX_SEQNUM;

   7843  8 001477   000000 236000 xsym               LDQ     MAX_SEQNUM
         8 001500   000000 756000 xsym               STQ     HI_SEQNUM

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:127  
      870     7844        /**/
      871     7845    1        P$ = CMD$ -> M_CMD_TBL.FID$;

   7845  8 001501   000000 470400 xsym               LDP0    CMD$
         8 001502   000001 236100                    LDQ     1,,PR0
         8 001503   000000 756000 xsym               STQ     P$

      872     7846    1        CURR_FILE_NAME = OPEN_FILE_NAME;/* Remember Current name over the MERGE */

   7846  8 001504   000000 100400                    MLR     fill='000'O
         8 001505   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32
         8 001506   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32

      873     7847    1        CURR_FILE_SN = OPEN_FILE_SN;

   7847  8 001507   000000 100400                    MLR     fill='000'O
         8 001510   000000 000012 xsym               ADSC9   OPEN_FILE_SN             cn=0,n=10
         8 001511   000000 000012 xsym               ADSC9   CURR_FILE_SN             cn=0,n=10

      874     7848    1        CURR_FILE_ACCT = OPEN_FILE_ACCT;

   7848  8 001512   040000 100400                    MLR     fill='040'O
         8 001513   000000 000010 xsym               ADSC9   OPEN_FILE_ACCT           cn=0,n=8
         8 001514   000000 000010 xsym               ADSC9   CURR_FILE_ACCT           cn=0,n=8

      875     7849    1        CURR_FILE_PASS = OPEN_FILE_PASS;

   7849  8 001515   040000 100400                    MLR     fill='040'O
         8 001516   000000 000010 xsym               ADSC9   OPEN_FILE_PASS           cn=0,n=8
         8 001517   000000 000010 xsym               ADSC9   CURR_FILE_PASS           cn=0,n=8

      876     7850    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET(EXEC_MERGE_RET);

   7850  8 001520   000007 630400 9                  EPPR0   7
         8 001521   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001522   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 001523   002172 702000 8                  TSX2    EXEC_MERGE_RET
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:128  

      877     7851    1        OPEN_FILE_FPT.V.FUN# = %IN#;

   7851  8 001524   002000 236007                    LDQ     1024,DL
         8 001525   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

      878     7852    1        DS_RESULTS = FALSE;

   7852  8 001526   000000 235003                    LDA     0,DU
         8 001527   000000 236003                    LDQ     0,DU
         8 001530   000276 757000 1                  STAQ    DS_RESULTS

      879     7853    1        CALL M$GDS(COPYDS_FPT) ALTRET (EXEC_MERGE_ERR);

   7853  8 001531   000366 630400 2                  EPPR0   COPYDS_FPT
         8 001532   430001 713400                    CLIMB   alt,gds
         8 001533   400400 401760                    pmme    nvectors=2
         8 001534   002150 702000 8                  TSX2    EXEC_MERGE_ERR

      880     7854    1        OPEN_FILE_FPT.FPARAM_ = DS_RESULTS;

   7854  8 001535   000276 237000 1                  LDAQ    DS_RESULTS
         8 001536   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      881     7855    1        OPEN_FILE2_FPT.IFPARAM_ = DS_RESULTS;

   7855  8 001537   000276 237000 1                  LDAQ    DS_RESULTS
         8 001540   000120 757000 1                  STAQ    OPEN_FILE2_FPT+22

      882     7856    1        COPYDS_PTR$ = DS_RESULTS.PTR$;

   7856  8 001541   000277 236000 1                  LDQ     DS_RESULTS+1
         8 001542   000000 756000 xsym               STQ     COPYDS_PTR$

      883     7857    1        CALL M$OPEN(OPEN_FILE_FPT) ALTRET (EXEC_MERGE_ERR); /* OPEN INPUT FILE */

   7857  8 001543   000000 630400 1                  EPPR0   OPEN_FILE_FPT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:129  
         8 001544   450000 713400                    CLIMB   alt,open
         8 001545   410400 401760                    pmme    nvectors=18
         8 001546   002150 702000 8                  TSX2    EXEC_MERGE_ERR

      884     7858    2        IF (M$FILE$ -> F$DCB.ORG ~= %KEYED#) THEN DO;

   7858  8 001547   000000 470400 xsym               LDP0    M$FILE$
         8 001550   000032 236100                    LDQ     26,,PR0
         8 001551   777000 376003                    ANQ     -512,DU
         8 001552   002000 116003                    CMPQ    1024,DU
         8 001553   001605 600000 8                  TZE     s:7875

      885     7859    2           IF (M$FILE$ -> F$DCB.ORG = %CONSEC#)OR

   7859  8 001554   001000 116003                    CMPQ    512,DU
         8 001555   001562 600000 8                  TZE     s:7862
         8 001556   004000 116003                    CMPQ    2048,DU
         8 001557   001562 600000 8                  TZE     s:7862
         8 001560   006000 116003                    CMPQ    3072,DU
         8 001561   001567 601000 8                  TNZ     s:7865

      886     7860    2              (M$FILE$ -> F$DCB.ORG = %UR#)OR
      887     7861    3              (M$FILE$ -> F$DCB.ORG = %INDEXED#) THEN DO;

      888     7862    3              FLAGS.CONSEC_MODE = TRUE;

   7862  8 001562   002000 236003                    LDQ     1024,DU
         8 001563   000000 256000 xsym               ORSQ    FLAGS

      889     7863    3              LAST_KEY = Y003;

   7863  8 001564   000000 235000 xsym               LDA     Y003
         8 001565   000000 755000 xsym               STA     LAST_KEY

      890     7864    3              END;

   7864  8 001566   001605 710000 8                  TRA     s:7875
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:130  

      891     7865    2           ELSE IF (M$FILE$ -> F$DCB.ORG = %RELATIVE#) THEN FLAGS.REL_MODE = TRUE;

   7865  8 001567   005000 116003                    CMPQ    2560,DU
         8 001570   001574 601000 8                  TNZ     s:7868

   7865  8 001571   400000 236007                    LDQ     -131072,DL
         8 001572   000000 256000 xsym               ORSQ    FLAGS
         8 001573   001605 710000 8                  TRA     s:7875

      892     7866        /**/
      893     7867    3              ELSE DO;                     /* CANT MERGE                         */

      894     7868    3                 CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR2) ;

   7868  8 001574   000076 630400 2                  EPPR0   CLOSE_FPT
         8 001575   450001 713400                    CLIMB   alt,close
         8 001576   406000 401760                    pmme    nvectors=13
         8 001577   001600 702000 8                  TSX2    EXEC_MERGE_CLOSE_ERR2

      895     7869    3   EXEC_MERGE_CLOSE_ERR2:
      896     7870    3                 CALL VEX$ERROR(E$E_CANTEDIT,3);

   7870  8 001600   000034 630400 9     EXEC_MERGE_* EPPR0   28
         8 001601   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001602   000000 701000 xent               TSX1    VEX$ERROR
         8 001603   000000 011000                    NOP     0

      897     7871    3                 RETURN;

   7871  8 001604   000000 702200 xent               TSX2  ! X66_ARET

      898     7872    3                 END;
      899     7873    2           END;
      900     7874        /**/
      901     7875    1        P$ = CMD$ -> M_CMD_TBL.FID2$;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:131  
   7875  8 001605   000000 471400 xsym               LDP1    CMD$
         8 001606   100005 236100                    LDQ     5,,PR1
         8 001607   000000 756000 xsym               STQ     P$

      902     7876    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE2_FPT,0) ALTRET(EXEC_MERGE_RET);

   7876  8 001610   000036 630400 9                  EPPR0   30
         8 001611   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001612   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 001613   002172 702000 8                  TSX2    EXEC_MERGE_RET

      903     7877    2        IF (CMD$ -> M_CMD_TBL.ONOVER = %OLDFILE#) THEN DO;

   7877  8 001614   000000 470400 xsym               LDP0    CMD$
         8 001615   000004 235100                    LDA     4,,PR0
         8 001616   000002 115007                    CMPA    2,DL
         8 001617   001643 601000 8                  TNZ     s:7895

      904     7878    2           OPEN_FILE2_FPT.V.FUN# = %IN#;

   7878  8 001620   002000 236007                    LDQ     1024,DL
         8 001621   000137 552010 1                  STBQ    OPEN_FILE2_FPT+37,'10'O

      905     7879    2           OPEN_FILE2_FPT.V.OPER.TEST# = '1'B;

   7879  8 001622   020000 236007                    LDQ     8192,DL
         8 001623   000136 256000 1                  ORSQ    OPEN_FILE2_FPT+36

      906     7880    2           CALL M$OPEN(OPEN_FILE2_FPT)     /* TEST OPEN to see if EXISTs */

   7880  8 001624   000072 630400 1                  EPPR0   OPEN_FILE2_FPT
         8 001625   450000 713400                    CLIMB   alt,open
         8 001626   410400 401760                    pmme    nvectors=18
         8 001627   001631 702000 8                  TSX2    s:7882
         8 001630   001643 710000 8                  TRA     s:7895

      907     7881    3           WHENALTRETURN DO;               /* Must not exist */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:132  

      908     7882    3              IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$NOFILE) THEN

   7882  8 001631   000000 470400 xsym               LDP0    B$TCB$
         8 001632   000000 471500                    LDP1    0,,PR0
         8 001633   100102 236100                    LDQ     66,,PR1
         8 001634   377770 376007                    ANQ     131064,DL
         8 001635   001610 116007                    CMPQ    904,DL
         8 001636   001643 601000 8                  TNZ     s:7895

      909     7883    3                 CALL VEX$ERROR (E$FILECREATED,0) ;

   7883  8 001637   000111 630400 9                  EPPR0   73
         8 001640   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001641   000000 701000 xent               TSX1    VEX$ERROR
         8 001642   000000 011000                    NOP     0

      910     7884    3              END;

      911     7885    2           END;                            /* IF OLDFILE */

      912     7886        /**/
      913     7887        /*E*        ERROR:      VEE-E$FILECREATED-0
      914     7888                    MESSAGE:   %UF was created by the MERGE operation
      915     7889                    DESCRIPTION:  User specified INTO and the File didn't
      916     7890                                  exist.  This is not an Error, but maybe
      917     7891                                  he didn't intend on creating a file, Let's
      918     7892                                  Inform him just incase.
      919     7893        */
      920     7894        /**/
      921     7895    1        OPEN_FILE2_FPT.V.FUN# = %CREATE#;

   7895  8 001643   003000 236007                    LDQ     1536,DL
         8 001644   000137 552010 1                  STBQ    OPEN_FILE2_FPT+37,'10'O

      922     7896    1        OPEN_FILE2_FPT.V.EXIST# = CMD$ -> M_CMD_TBL.ONOVER ;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:133  
   7896  8 001645   000000 470400 xsym               LDP0    CMD$
         8 001646   000004 236100                    LDQ     4,,PR0
         8 001647   000007 736000                    QLS     7
         8 001650   000136 676000 1                  ERQ     OPEN_FILE2_FPT+36
         8 001651   000600 376007                    ANQ     384,DL
         8 001652   000136 656000 1                  ERSQ    OPEN_FILE2_FPT+36

      923     7897    1        OPEN_FILE2_FPT.V.TYPE# = TYPE_CODE;

   7897  8 001653   000000 220000 xsym               LDX0    TYPE_CODE
         8 001654   000141 740000 1                  STX0    OPEN_FILE2_FPT+39

      924     7898    1        CALL M$OPEN(OPEN_FILE2_FPT) ALTRET(EXEC_MERGE_ERR); /* OPEN OUTPUT FILE */

   7898  8 001655   000072 630400 1                  EPPR0   OPEN_FILE2_FPT
         8 001656   450000 713400                    CLIMB   alt,open
         8 001657   410400 401760                    pmme    nvectors=18
         8 001660   002150 702000 8                  TSX2    EXEC_MERGE_ERR

      925     7899        /**/
      926     7900    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);

   7900  8 001661   000042 237000 9                  LDAQ    34
         8 001662   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

      927     7901    1        OPEN_FILE_FPT.IFPARAM_ = VECTOR(NIL);

   7901  8 001663   000042 237000 9                  LDAQ    34
         8 001664   000026 757000 1                  STAQ    OPEN_FILE_FPT+22

      928     7902        /**/
      929     7903    2        IF (M$FILE2$ -> F$DCB.ORG ~= %KEYED#) THEN DO; /* CANT MERGE INTO NON-KEYED */

   7903  8 001665   000000 470400 xsym               LDP0    M$FILE2$
         8 001666   000032 236100                    LDQ     26,,PR0
         8 001667   777000 376003                    ANQ     -512,DU
         8 001670   002000 116003                    CMPQ    1024,DU
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:134  
         8 001671   001677 600000 8                  TZE     s:7915

      930     7904    2           CALL VEX$ERROR(E$E_MRGDESTNOTKEY,3);

   7904  8 001672   000114 630400 9                  EPPR0   76
         8 001673   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001674   000000 701000 xent               TSX1    VEX$ERROR
         8 001675   000000 011000                    NOP     0

      931     7905    2           GOTO EXEC_MERGE_RET;

   7905  8 001676   002172 710000 8                  TRA     EXEC_MERGE_RET

      932     7906    2           END;
      933     7907        /**/
      934     7908        /*E*     ERROR:    VEE-E$E_MRGDESTNOTKEY-0
      935     7909                 MESSAGE:  File %%FN %is not a keyed file - can not merge into file.
      936     7910                 MESSAGE1: A consecutive, unit record or indexed file has been
      937     7911                           opened for a MERGE output file.  You can not MERGE into
      938     7912                           a non-keyed file.
      939     7913                 DESCRIPTION: A request was made to MERGE into a consec file.  */
      940     7914        /**/
      941     7915    1        READ_KEY = CMD$ -> M_CMD_TBL.LO_SEQNUM.KEY; /* BEGIN INPUT RANGE          */

   7915  8 001677   000000 471400 xsym               LDP1    CMD$
         8 001700   100002 235100                    LDA     2,,PR1
         8 001701   000000 755000 xsym               STA     READ_KEY

      942     7916    1        LIMIT_SEQNUM = CMD$ -> M_CMD_TBL.HI_SEQNUM.KEY; /* END INPUT RANGE        */

   7916  8 001702   100003 235100                    LDA     3,,PR1
         8 001703   000000 755000 xsym               STA     LIMIT_SEQNUM

      943     7917        /**/
      944     7918    1        CALL VEX$READ_RANDOM(READ_KEY) ALTRET(EXEC_MERGE_RET); /* SET POSITION */

   7918  8 001704   000116 630400 9                  EPPR0   78
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:135  
         8 001705   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 001706   000000 701000 xent               TSX1    VEX$READ_RANDOM
         8 001707   002172 702000 8                  TSX2    EXEC_MERGE_RET

      945     7919        /**/
      946     7920        /**/
      947     7921    2        IF (~FLAGS.EXISTS) THEN DO;

   7921  8 001710   000000 236000 xsym               LDQ     FLAGS
         8 001711   000004 736000                    QLS     4
         8 001712   400000 376003                    ANQ     -131072,DU
         8 001713   400000 676003                    ERQ     -131072,DU
         8 001714   001735 600000 8                  TZE     s:7936

      948     7922    2           CALL VEX$READ_SEQUEN ALTRET(EXEC_MERGE_RET);

   7922  8 001715   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 001716   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         8 001717   002172 702000 8                  TSX2    EXEC_MERGE_RET

      949     7923    2           READ_KEY = LAST_KEY;

   7923  8 001720   000000 235000 xsym               LDA     LAST_KEY
         8 001721   000000 755000 xsym               STA     READ_KEY

      950     7924    3           IF ((FLAGS.EOF) OR (LAST_KEY > LIMIT_SEQNUM)) THEN DO;

   7924  8 001722   000000 236000 xsym               LDQ     FLAGS
         8 001723   010000 316003                    CANQ    4096,DU
         8 001724   001730 601000 8                  TNZ     s:7925
         8 001725   000000 236000 xsym               LDQ     LIMIT_SEQNUM
         8 001726   000000 116000 xsym               CMPQ    LAST_KEY
         8 001727   001735 603000 8                  TRC     s:7936

      951     7925    3              CALL VEX$ERROR(E$E_NOMOVE,2); /* NOTHING TO MOVE                */

   7925  8 001730   000120 630400 9                  EPPR0   80
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:136  
         8 001731   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001732   000000 701000 xent               TSX1    VEX$ERROR
         8 001733   000000 011000                    NOP     0

      952     7926    3              GOTO EXEC_MERGE_CLOSE;

   7926  8 001734   002075 710000 8                  TRA     EXEC_MERGE_CLOSE

      953     7927    3              END ;                        /* THEN DO */
      954     7928        /*E*     ERROR:    VEE-E$E_NOMOVE-0
      955     7929                 MESSAGE:  Nothing to move
      956     7930                 MESSAGE1: There are no records in the 'FROM' range
      957     7931                 DESCRIPTION: An attempt was made to MERGE records from a file
      958     7932                           and the file has no records in the specified range.
      959     7933        */
      960     7934    2           END ;                           /* THEN DO */
      961     7935        /**/
      962     7936    1        EXEC_SEQNUM = CMD$ -> M_CMD_TBL.LO_SEQNUM2.KEY; /* BEGIN OUTPUT RANGE     */

   7936  8 001735   000000 470400 xsym               LDP0    CMD$
         8 001736   000006 235100                    LDA     6,,PR0
         8 001737   000000 755000 xsym               STA     EXEC_SEQNUM

      963     7937    1        LO_SEQNUM = EXEC_SEQNUM;

   7937  8 001740   000000 755000 xsym               STA     LO_SEQNUM

      964     7938    1        HI_SEQNUM = CMD$ -> M_CMD_TBL.HI_SEQNUM2.KEY; /* END OUTPUT RANGE         */

   7938  8 001741   000007 235100                    LDA     7,,PR0
         8 001742   000000 755000 xsym               STA     HI_SEQNUM

      965     7939        /**/
      966     7940    1        INCR = CMD$ -> M_CMD_TBL.INCR;     /* OUTPUT INCREMENT                   */

   7940  8 001743   000010 235100                    LDA     8,,PR0
         8 001744   000000 755000 xsym               STA     INCR
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:137  

      967     7941        /**/
      968     7942    1        REC_COUNT = 0;                     /* DELETE RECORDS IN OUTPUT RANGE     */

   7942  8 001745   000000 450000 xsym               STZ     REC_COUNT

      969     7943    1        CALL VEX$DELREC(M$FILE2_NUM,EXEC_SEQNUM,HI_SEQNUM)

   7943  8 001746   000122 630400 9                  EPPR0   82
         8 001747   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 001750   000000 701000 xent               TSX1    VEX$DELREC
         8 001751   002172 702000 8                  TSX2    EXEC_MERGE_RET

      970     7944    1           ALTRET (EXEC_MERGE_RET);
      971     7945    1        REC_COUNT = M$FILE2$ -> F$DCB.ARS;

   7945  8 001752   000000 470400 xsym               LDP0    M$FILE2$
         8 001753   000000 235100                    LDA     0,,PR0
         8 001754   000000 755000 xsym               STA     REC_COUNT

      972     7946    1        READ_SEQUEN2_FPT.KEY_ = VECTOR(LAST_KEY) ;

   7946  8 001755   000126 237000 9                  LDAQ    86
         8 001756   000262 757000 1                  STAQ    READ_SEQUEN2_FPT+2

      973     7947    1        CALL M$READ(READ_SEQUEN2_FPT) ALTRET(MERGE_DEL2_ERR) ;

   7947  8 001757   000260 630400 1                  EPPR0   READ_SEQUEN2_FPT
         8 001760   440000 713400                    CLIMB   alt,read
         8 001761   401400 401760                    pmme    nvectors=4
         8 001762   002230 702000 8                  TSX2    MERGE_DEL2_ERR

      974     7948    1        HI_SEQNUM = LAST_KEY ;             /* SET LIMIT                          */

   7948  8 001763   000000 235000 xsym               LDA     LAST_KEY
         8 001764   000000 755000 xsym               STA     HI_SEQNUM

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:138  
      975     7949        /**/
      976     7950    1   EXEC_MERGE_MOVE:
      977     7951    2        IF (REC_COUNT > 0) THEN DO;

   7951  8 001765   000000 235000 xsym  EXEC_MERGE_* LDA     REC_COUNT
         8 001766   001777 600000 8                  TZE     s:7961

      978     7952    2           CALL VEX$SET_SUB_BUF(SUB_BUF_1,REC_COUNT);

   7952  8 001767   000130 630400 9                  EPPR0   88
         8 001770   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001771   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         8 001772   000000 011000                    NOP     0

      979     7953    2           CALL VEX$ERROR(E$E_RECSDEL,1);  /* XX RECORDS DELETED               */

   7953  8 001773   000133 630400 9                  EPPR0   91
         8 001774   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 001775   000000 701000 xent               TSX1    VEX$ERROR
         8 001776   000000 011000                    NOP     0

      980     7954    2           END;

      981     7955        /**/
      982     7956        /*E*     ERROR:    VEE-E$E_RECSDEL-0
      983     7957                 MESSAGE:  %U1 records deleted
      984     7958                 DESCRIPTION: The specified range of records which was deleted
      985     7959                           contained %U1 records.
      986     7960        */
      987     7961    1        CALL VEX$ERROR(E$E_MRGSTART,1);    /* MERGE STARTED                      */

   7961  8 001777   000136 630400 9                  EPPR0   94
         8 002000   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002001   000000 701000 xent               TSX1    VEX$ERROR
         8 002002   000000 011000                    NOP     0

      988     7962        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:139  
      989     7963        /*E*     ERROR:    VEE-E$E_MRGSTART-0
      990     7964                 MESSAGE:  MERGE started
      991     7965                 DESCRIPTION: The MERGE operation has started
      992     7966        */
      993     7967        /**/
      994     7968    1        REC_COUNT = 0;

   7968  8 002003   000000 450000 xsym               STZ     REC_COUNT

      995     7969    1        LAST_KEY = READ_KEY ;              /* RESTORE POSITION IN INPUT FILE     */

   7969  8 002004   000000 235000 xsym               LDA     READ_KEY
         8 002005   000000 755000 xsym               STA     LAST_KEY

      996     7970    2        DO WHILE (LAST_KEY <= LIMIT_SEQNUM); /* DO WHOLE INPUT RANGE       */

   7970  8 002006   000000 236000 xsym               LDQ     LIMIT_SEQNUM
         8 002007   000000 116000 xsym               CMPQ    LAST_KEY
         8 002010   002046 602000 8                  TNC     EXEC_MERGE_DONE

      997     7971    2           CALL VEX$WRITE_REC(M$FILE2_NUM,EXEC_SEQNUM) ALTRET(EXEC_MERGE_RET);

   7971  8 002011   000054 630400 9                  EPPR0   44
         8 002012   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002013   000000 701000 xent               TSX1    VEX$WRITE_REC
         8 002014   002172 702000 8                  TSX2    EXEC_MERGE_RET

      998     7972    2           EXEC_SEQNUM = EXEC_SEQNUM + INCR;

   7972  8 002015   000000 236000 xsym               LDQ     EXEC_SEQNUM
         8 002016   000000 036000 xsym               ADLQ    INCR
         8 002017   000000 756000 xsym               STQ     EXEC_SEQNUM

      999     7973    2           SAVE_KEY = LAST_KEY;            /* SAVE FOR CUTOFF              */

   7973  8 002020   000000 235000 xsym               LDA     LAST_KEY
         8 002021   000000 755000 xsym               STA     SAVE_KEY
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:140  

     1000     7974    2           REC_COUNT = REC_COUNT+1;

   7974  8 002022   000000 235000 xsym               LDA     REC_COUNT
         8 002023   000001 035007                    ADLA    1,DL
         8 002024   000000 755000 xsym               STA     REC_COUNT

     1001     7975    2           CALL VEX$READ_SEQUEN ALTRET (EXEC_MERGE_RET); /* GET NEXT       */

   7975  8 002025   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 002026   000000 701000 xent               TSX1    VEX$READ_SEQUEN
         8 002027   002172 702000 8                  TSX2    EXEC_MERGE_RET

     1002     7976    3           IF (FLAGS.EOF) THEN DO;

   7976  8 002030   000000 236000 xsym               LDQ     FLAGS
         8 002031   010000 316003                    CANQ    4096,DU
         8 002032   002040 600000 8                  TZE     s:7984

     1003     7977    3              CALL VEX$ERROR(E$E_EDITEOF,1); /* EOF HIT                    */

   7977  8 002033   000141 630400 9                  EPPR0   97
         8 002034   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002035   000000 701000 xent               TSX1    VEX$ERROR
         8 002036   000000 011000                    NOP     0

     1004     7978    3              GOTO EXEC_MERGE_DONE;

   7978  8 002037   002046 710000 8                  TRA     EXEC_MERGE_DONE

     1005     7979    3              END;
     1006     7980        /**/
     1007     7981        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1008     7982                 DESCRIPTION: EOF encountered in MERGE operation.
     1009     7983        */
     1010     7984    2           CALL VEX$CHECK_CUTOFF ALTRET(EXEC_MERGE_DONE1) ; /* Found cutoff. */

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:141  
   7984  8 002040   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 002041   000000 701000 xent               TSX1    VEX$CHECK_CUTOFF
         8 002042   002063 702000 8                  TSX2    EXEC_MERGE_DONE1

     1011     7985    2           END ;                           /* DO WHILE */

   7985  8 002043   000000 236000 xsym               LDQ     LIMIT_SEQNUM
         8 002044   000000 116000 xsym               CMPQ    LAST_KEY
         8 002045   002011 603000 8                  TRC     s:7971

     1012     7986        /*E*     ERROR:    VEE-E$E_EDITEOF-0
     1013     7987                 DESCRIPTION: EOF encountered in MERGE operation.
     1014     7988        */
     1015     7989        /**/
     1016     7990    1   EXEC_MERGE_DONE:
     1017     7991    1        EXEC_SEQNUM = EXEC_SEQNUM - INCR;

   7991  8 002046   000000 236000 xsym  EXEC_MERGE_* LDQ     EXEC_SEQNUM
         8 002047   000000 136000 xsym               SBLQ    INCR
         8 002050   000000 756000 xsym               STQ     EXEC_SEQNUM

     1018     7992    1   EXEC_MERGE_DECR:
     1019     7993    1        FLAGS.CONSEC_MODE = FALSE;         /* PRINT FRACTIONAL SEQNUM            */

   7993  8 002051   000005 236000 9     EXEC_MERGE_* LDQ     5
         8 002052   000000 356000 xsym               ANSQ    FLAGS

     1020     7994    1        CALL VEX$SEQNUM_TEXT(EXEC_SEQNUM,SUB_BUF_1);

   7994  8 002053   000143 630400 9                  EPPR0   99
         8 002054   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002055   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         8 002056   000000 011000                    NOP     0

     1021     7995    1        CALL VEX$ERROR(E$E_DONEAT,1);

   7995  8 002057   000146 630400 9                  EPPR0   102
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:142  
         8 002060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002061   000000 701000 xent               TSX1    VEX$ERROR
         8 002062   000000 011000                    NOP     0

     1022     7996        /**/
     1023     7997    1   EXEC_MERGE_DONE1:
     1024     7998    1        CALL VEX$SET_SUB_BUF(SUB_BUF_1,REC_COUNT);

   7998  8 002063   000130 630400 9     EXEC_MERGE_* EPPR0   88
         8 002064   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002065   000000 701000 xent               TSX1    VEX$SET_SUB_BUF
         8 002066   000000 011000                    NOP     0

     1025     7999    1        CALL VEX$ERROR(E$E_RECSMVED,1);    /* XX RECORDS MOVED                   */

   7999  8 002067   000151 630400 9                  EPPR0   105
         8 002070   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002071   000000 701000 xent               TSX1    VEX$ERROR
         8 002072   000000 011000                    NOP     0

     1026     8000    1        HI_SEQNUM = EXEC_SEQNUM ;

   8000  8 002073   000000 235000 xsym               LDA     EXEC_SEQNUM
         8 002074   000000 755000 xsym               STA     HI_SEQNUM

     1027     8001        /**/
     1028     8002        /*E*     ERROR:    VEE-E$E_RECSMVED-0
     1029     8003                 MESSAGE:  %U1 records moved
     1030     8004                 DESCRIPTION: %u1 records were MERGEd from one file to the
     1031     8005                           other.
     1032     8006        */
     1033     8007        /**/
     1034     8008    1   EXEC_MERGE_CLOSE:
     1035     8009    1        CALL M$CLOSE(CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR3) ;

   8009  8 002075   000076 630400 2     EXEC_MERGE_* EPPR0   CLOSE_FPT
         8 002076   450001 713400                    CLIMB   alt,close
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:143  
         8 002077   406000 401760                    pmme    nvectors=13
         8 002100   002101 702000 8                  TSX2    EXEC_MERGE_CLOSE_ERR3

     1036     8010    1   EXEC_MERGE_CLOSE_ERR3:
     1037     8011    1        IF (~M$FILE2$ -> F$DCB.FEXT) THEN CLOSE2_FPT.V.OPER.RELG# = TRUE;

   8011  8 002101   000000 470400 xsym  EXEC_MERGE_* LDP0    M$FILE2$
         8 002102   000064 236100                    LDQ     52,,PR0
         8 002103   400000 376003                    ANQ     -131072,DU
         8 002104   400000 676003                    ERQ     -131072,DU
         8 002105   002110 600000 8                  TZE     s:8012

   8011  8 002106   200000 236007                    LDQ     65536,DL
         8 002107   000216 256000 1                  ORSQ    CLOSE2_FPT+26

     1038     8012    1        CALL M$CLOSE(CLOSE2_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR4) ;

   8012  8 002110   000164 630400 1                  EPPR0   CLOSE2_FPT
         8 002111   450001 713400                    CLIMB   alt,close
         8 002112   406000 401760                    pmme    nvectors=13
         8 002113   002114 702000 8                  TSX2    EXEC_MERGE_CLOSE_ERR4

     1039     8013    1   EXEC_MERGE_CLOSE_ERR4:
     1040     8014    1        CLOSE2_FPT.V.OPER.RELG# = FALSE;

   8014  8 002114   000153 236000 9     EXEC_MERGE_* LDQ     107
         8 002115   000216 356000 1                  ANSQ    CLOSE2_FPT+26

     1041     8015    1        CALL M$FDS (COPYDS_FPT);

   8015  8 002116   000366 630400 2                  EPPR0   COPYDS_FPT
         8 002117   030002 713400                    CLIMB   fds
         8 002120   400400 401760                    pmme    nvectors=2

     1042     8016        /**/
     1043     8017    1        FLAGS.CONSEC_MODE = FALSE;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:144  
   8017  8 002121   000005 236000 9                  LDQ     5
         8 002122   000000 356000 xsym               ANSQ    FLAGS

     1044     8018    1        FLAGS.REL_MODE = FALSE;

   8018  8 002123   000006 236000 9                  LDQ     6
         8 002124   000000 356000 xsym               ANSQ    FLAGS

     1045     8019        /**/
     1046     8020    1        CALL VEX$ERROR(E$E_MRGDONE,1);     /* MERGE DONE                         */

   8020  8 002125   000155 630400 9                  EPPR0   109
         8 002126   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002127   000000 701000 xent               TSX1    VEX$ERROR
         8 002130   000000 011000                    NOP     0

     1047     8021        /**/
     1048     8022        /*E*     ERROR:    VEE-E$E_MRGDONE-0
     1049     8023                 MESSAGE:  MERGE done
     1050     8024                 DESCRIPTION: The MERGE operation is complete.
     1051     8025        */
     1052     8026        /**/
     1053     8027    1        CALL VEX$FID_2_FPT(P$,OPEN_FILE_FPT,0) ALTRET(EXEC_MERGE_RET);

   8027  8 002131   000007 630400 9                  EPPR0   7
         8 002132   000021 631400 xsym               EPPR1   B_VECTNIL+17
         8 002133   000000 701000 xent               TSX1    VEX$FID_2_FPT
         8 002134   002172 702000 8                  TSX2    EXEC_MERGE_RET

     1054     8028    1        OPEN_FILE_FPT.V.FUN# = %UPDATE#;

   8028  8 002135   001000 236007                    LDQ     512,DL
         8 002136   000045 552010 1                  STBQ    OPEN_FILE_FPT+37,'10'O

     1055     8029    1        CALL M$OPEN (OPEN_FILE_FPT) ALTRET (EXEC_MERGE_ERR);

   8029  8 002137   000000 630400 1                  EPPR0   OPEN_FILE_FPT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:145  
         8 002140   450000 713400                    CLIMB   alt,open
         8 002141   410400 401760                    pmme    nvectors=18
         8 002142   002150 702000 8                  TSX2    EXEC_MERGE_ERR

     1056     8030    1        FLAGS.EDIT_MODE = TRUE;

   8030  8 002143   400000 236003                    LDQ     -131072,DU
         8 002144   000000 256000 xsym               ORSQ    FLAGS

     1057     8031    1        P_PCB.ROOT$ = ADDR(P_ALLCMDS) ;

   8031  8 002145   000157 236000 9                  LDQ     111
         8 002146   000001 756000 xsym               STQ     P_PCB+1

     1058     8032        /**/
     1059     8033    1        RETURN;

   8033  8 002147   000000 702200 xent               TSX2  ! X66_ARET

     1060     8034        /**/
     1061     8035    1   EXEC_MERGE_ERR:
     1062     8036    1        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$CREATERR) THEN

   8036  8 002150   000000 470400 xsym  EXEC_MERGE_* LDP0    B$TCB$
         8 002151   000000 471500                    LDP1    0,,PR0
         8 002152   100102 236100                    LDQ     66,,PR1
         8 002153   377770 376007                    ANQ     131064,DL
         8 002154   001560 116007                    CMPQ    880,DL
         8 002155   002163 601000 8                  TNZ     s:8039

     1063     8037    1           CALL VEX$ERROR(E$E_ONEXTS,3);   /* 'ON' FILE EXISTS                  */

   8037  8 002156   000062 630400 9                  EPPR0   50
         8 002157   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002160   000000 701000 xent               TSX1    VEX$ERROR
         8 002161   000000 011000                    NOP     0
         8 002162   002167 710000 8                  TRA     s:8040
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:146  

     1064     8038    1        ELSE
     1065     8039    1           CALL VEX$ERROR(0,SYSFLAGLEV);

   8039  8 002163   000031 630400 9                  EPPR0   25
         8 002164   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002165   000000 701000 xent               TSX1    VEX$ERROR
         8 002166   000000 011000                    NOP     0

     1066     8040    1        OPEN_FILE_NAME = CURR_FILE_NAME;

   8040  8 002167   000000 100400                    MLR     fill='000'O
         8 002170   000000 000040 xsym               ADSC9   CURR_FILE_NAME           cn=0,n=32
         8 002171   000000 000040 xsym               ADSC9   OPEN_FILE_NAME           cn=0,n=32

     1067     8041    1   EXEC_MERGE_RET:
     1068     8042    1        CALL M$CLOSE (CLOSE_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR5) ;

   8042  8 002172   000076 630400 2     EXEC_MERGE_* EPPR0   CLOSE_FPT
         8 002173   450001 713400                    CLIMB   alt,close
         8 002174   406000 401760                    pmme    nvectors=13
         8 002175   002176 702000 8                  TSX2    EXEC_MERGE_CLOSE_ERR5

     1069     8043    1   EXEC_MERGE_CLOSE_ERR5:
     1070     8044    1        IF (~M$FILE$ -> F$DCB.FEXT) THEN CLOSE2_FPT.V.OPER.RELG# = TRUE;

   8044  8 002176   000000 470400 xsym  EXEC_MERGE_* LDP0    M$FILE$
         8 002177   000064 236100                    LDQ     52,,PR0
         8 002200   400000 376003                    ANQ     -131072,DU
         8 002201   400000 676003                    ERQ     -131072,DU
         8 002202   002205 600000 8                  TZE     s:8045

   8044  8 002203   200000 236007                    LDQ     65536,DL
         8 002204   000216 256000 1                  ORSQ    CLOSE2_FPT+26

     1071     8045    1        CALL M$CLOSE (CLOSE2_FPT) ALTRET(EXEC_MERGE_CLOSE_ERR6) ;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:147  
   8045  8 002205   000164 630400 1                  EPPR0   CLOSE2_FPT
         8 002206   450001 713400                    CLIMB   alt,close
         8 002207   406000 401760                    pmme    nvectors=13
         8 002210   002211 702000 8                  TSX2    EXEC_MERGE_CLOSE_ERR6

     1072     8046    1   EXEC_MERGE_CLOSE_ERR6:
     1073     8047    1        CLOSE2_FPT.V.OPER.RELG# = FALSE;

   8047  8 002211   000153 236000 9     EXEC_MERGE_* LDQ     107
         8 002212   000216 356000 1                  ANSQ    CLOSE2_FPT+26

     1074     8048    1        IF (OPEN_FILE_FPT.FPARAM_ ~= VECTOR(NIL)) THEN CALL M$FDS(COPYDS_FPT);

   8048  8 002213   000030 237000 1                  LDAQ    OPEN_FILE_FPT+24
         8 002214   000042 117000 9                  CMPAQ   34
         8 002215   002221 600000 8                  TZE     s:8049

   8048  8 002216   000366 630400 2                  EPPR0   COPYDS_FPT
         8 002217   030002 713400                    CLIMB   fds
         8 002220   400400 401760                    pmme    nvectors=2

     1075     8049    1        OPEN_FILE_FPT.FPARAM_ = VECTOR(NIL);

   8049  8 002221   000042 237000 9                  LDAQ    34
         8 002222   000030 757000 1                  STAQ    OPEN_FILE_FPT+24

     1076     8050    1        OPEN_FILE2_FPT.IFPARAM_ = VECTOR(NIL);

   8050  8 002223   000042 237000 9                  LDAQ    34
         8 002224   000120 757000 1                  STAQ    OPEN_FILE2_FPT+22

     1077     8051    1        P_PCB.ROOT$ = ADDR(P_ALLCMDS) ;

   8051  8 002225   000157 236000 9                  LDQ     111
         8 002226   000001 756000 xsym               STQ     P_PCB+1

     1078     8052    1        RETURN;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:148  

   8052  8 002227   000000 702200 xent               TSX2  ! X66_ARET

     1079     8053        /**/
     1080     8054    1   MERGE_DEL2_ERR:                         /* ERROR READING FILE2 TO DELETE RECS */
     1081     8055    2        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$BADVECT1 THEN DO ;

   8055  8 002230   000000 470400 xsym  MERGE_DEL2_* LDP0    B$TCB$
         8 002231   000000 471500                    LDP1    0,,PR0
         8 002232   100102 236100                    LDQ     66,,PR1
         8 002233   377770 376007                    ANQ     131064,DL
         8 002234   006450 116007                    CMPQ    3368,DL
         8 002235   002243 601000 8                  TNZ     s:8060

     1082     8056    2           ADDR(LAST_KEY) -> STR$BUF.COUNT = 3 ;

   8056  8 002236   003000 236003                    LDQ     1536,DU
         8 002237   000000 552040 xsym               STBQ    LAST_KEY,'40'O

     1083     8057    2           HI_SEQNUM = LAST_KEY ;

   8057  8 002240   000000 235000 xsym               LDA     LAST_KEY
         8 002241   000000 755000 xsym               STA     HI_SEQNUM

     1084     8058    2           GOTO EXEC_MERGE_MOVE ;

   8058  8 002242   001765 710000 8                  TRA     EXEC_MERGE_MOVE

     1085     8059    2           END ;                           /* THEN DO */
     1086     8060    1        IF (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# ~= %E$EOF)

   8060  8 002243   000060 116007                    CMPQ    48,DL
         8 002244   002150 601000 8                  TNZ     EXEC_MERGE_ERR

     1087     8061    1        THEN GOTO EXEC_MERGE_ERR;
     1088     8062    1        HI_SEQNUM = MAX_SEQNUM+1;          /* SET LIMIT                          */

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:149  
   8062  8 002245   000000 235000 xsym               LDA     MAX_SEQNUM
         8 002246   000001 035007                    ADLA    1,DL
         8 002247   000000 755000 xsym               STA     HI_SEQNUM

     1089     8063    1        GOTO EXEC_MERGE_MOVE;

   8063  8 002250   001765 710000 8                  TRA     EXEC_MERGE_MOVE

     1090     8064        /**/
     1091     8065        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:150  
     1092     8066        /**/
     1093     8067    1   VEF$EXEC_QM: ENTRY;

   8067  8 002251   000000 700200 xent  VEF$EXEC_QM  TSX0  ! X66_AUTO_0
         8 002252   000152 000000                    ZERO    106,0

     1094     8068        /**/
     1095     8069    1       IF ((ERR_CODE.FCG_MID = '0'B) AND (FLAGS.HELP_MODE = '0'B)) THEN GOTO HELPMSG ;

   8069  8 002253   000000 220000 xsym               LDX0    ERR_CODE
         8 002254   002260 601000 8                  TNZ     s:8071
         8 002255   000000 236000 xsym               LDQ     FLAGS
         8 002256   000002 316007                    CANQ    2,DL
         8 002257   002264 600000 8                  TZE     HELPMSG

     1096     8070        /**/
     1097     8071    1        CALL VEX$ERRNEXT ALTRET(HELPMSG);

   8071  8 002260   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 002261   000000 701000 xent               TSX1    VEX$ERRNEXT
         8 002262   002264 702000 8                  TSX2    HELPMSG

     1098     8072    1        RETURN;

   8072  8 002263   000000 702200 xent               TSX2  ! X66_ARET

     1099     8073        /*E*     ERROR:    VEE-E$E_NOMOREHELP-0
     1100     8074         MESSAGE: Please use the HELP command, or refer to the manual for more information.
     1101     8075                 DESCRIPTION: Error messages exhausted.
     1102     8076        */
     1103     8077        /**/
     1104     8078    1   HELPMSG:
     1105     8079    1        IF ((ERR_CODE.ERR# = E$E_SYNTAX) AND (ERR_CODE.MON = '0'B))

   8079  8 002264   000000 236000 xsym  HELPMSG      LDQ     ERR_CODE
         8 002265   377770 376007                    ANQ     131064,DL
         8 002266   003420 116007                    CMPQ    1808,DL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:151  
         8 002267   002300 601000 8                  TNZ     s:8081
         8 002270   000000 236000 xsym               LDQ     ERR_CODE
         8 002271   400000 316007                    CANQ    -131072,DL
         8 002272   002300 601000 8                  TNZ     s:8081

     1106     8080    1        THEN CALL X$HELP(XUH_PARAM) ALTRET(HELP_ERR) ;

   8080  8 002273   000160 630400 9                  EPPR0   112
         8 002274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 002275   000000 701000 xent               TSX1    X$HELP
         8 002276   002314 702000 8                  TSX2    HELP_ERR
         8 002277   002313 710000 8                  TRA     s:8084

     1107     8081    1        ELSE IF (FLAGS.HELP_MODE = '1'B)

   8081  8 002300   000000 236000 xsym               LDQ     FLAGS
         8 002301   000002 316007                    CANQ    2,DL
         8 002302   002307 600000 8                  TZE     s:8083

     1108     8082    1           THEN CALL VEH$ALL_HELP ;

   8082  8 002303   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 002304   000000 701000 xent               TSX1    VEH$ALL_HELP
         8 002305   000000 011000                    NOP     0
         8 002306   002313 710000 8                  TRA     s:8084

     1109     8083    1           ELSE CALL VEX$ERROR(E$E_NOMOREHELP,2) ; /* That's all folks. */

   8083  8 002307   000162 630400 9                  EPPR0   114
         8 002310   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002311   000000 701000 xent               TSX1    VEX$ERROR
         8 002312   000000 011000                    NOP     0

     1110     8084    1        RETURN;

   8084  8 002313   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:152  
     1111     8085    1   HELP_ERR:
     1112     8086    1        CALL VEX$ERROR(E$E_NOMOREHELP,2) ;

   8086  8 002314   000162 630400 9     HELP_ERR     EPPR0   114
         8 002315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 002316   000000 701000 xent               TSX1    VEX$ERROR
         8 002317   000000 011000                    NOP     0

     1113     8087    1        RETURN ;

   8087  8 002320   000000 702200 xent               TSX2  ! X66_ARET

     1114     8088        /**/
     1115     8089    1   VEF$EXEC_QM2: ENTRY;

   8089  8 002321   000000 700200 xent  VEF$EXEC_QM2 TSX0  ! X66_AUTO_0
         8 002322   000152 000000                    ZERO    106,0

     1116     8090        /**/
     1117     8091    1        IF (ERR_CODE.FCG_MID = '0'B) THEN GOTO HELPMSG ;

   8091  8 002323   000000 220000 xsym               LDX0    ERR_CODE
         8 002324   002264 600000 8                  TZE     HELPMSG

     1118     8092        /**/
     1119     8093    1        IF (ERR_CODE.SEV = 7) THEN GOTO HELPMSG;

   8093  8 002325   000000 236000 xsym               LDQ     ERR_CODE
         8 002326   000007 376007                    ANQ     7,DL
         8 002327   000007 116007                    CMPQ    7,DL
         8 002330   002264 600000 8                  TZE     HELPMSG

     1120     8094        /**/
     1121     8095    1        IF ((ERR_CODE.FCG_MID ~= '260505'O)OR /* MONITOR ERROR                */

   8095  8 002331   260505 100003                    CMPX0   90437,DU
         8 002332   002341 601000 8                  TNZ     s:8098
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:153  
         8 002333   000000 236000 xsym               LDQ     ERR_CODE
         8 002334   377770 376007                    ANQ     131064,DL
         8 002335   003110 116007                    CMPQ    1608,DL
         8 002336   002345 602000 8                  TNC     s:8103
         8 002337   006200 116007                    CMPQ    3200,DL
         8 002340   002345 603000 8                  TRC     s:8103

     1122     8096    1           ((ERR_CODE.ERR# > 200)AND(ERR_CODE.ERR# < 400))) /* EDIT NON-HELP   */
     1123     8097    2        THEN DO;

     1124     8098    2           CALL VEX$ERRMAX;

   8098  8 002341   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 002342   000000 701000 xent               TSX1    VEX$ERRMAX
         8 002343   000000 011000                    NOP     0

     1125     8099    2           RETURN;

   8099  8 002344   000000 702200 xent               TSX2  ! X66_ARET

     1126     8100    2           END;
     1127     8101        /**/                                    /* ELSE HELP                          */
     1128     8102    2        DO WHILE('1'B);

     1129     8103    2           CALL VEX$ERRNEXT ALTRET (QM2_DONE);

   8103  8 002345   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 002346   000000 701000 xent               TSX1    VEX$ERRNEXT
         8 002347   002351 702000 8                  TSX2    QM2_DONE

     1130     8104    2           END;

   8104  8 002350   002345 710000 8                  TRA     s:8103

     1131     8105        /**/
     1132     8106    1   QM2_DONE:
     1133     8107    1        RETURN;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:154  

   8107  8 002351   000000 702200 xent  QM2_DONE     TSX2  ! X66_ARET

     1134     8108        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:155  
     1135     8109        /**/
     1136     8110    1   VEF$EXEC_ROUND: ENTRY;

   8110  8 002352   000000 700200 xent  VEF$EXEC_RO* TSX0  ! X66_AUTO_0
         8 002353   000152 000000                    ZERO    106,0

     1137     8111        /**/
     1138     8112    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.ROUNDFLAG = TRUE;

   8112  8 002354   000000 470400 xsym               LDP0    CMD$
         8 002355   040000 106500                    CMPC    fill='040'O
         8 002356   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         8 002357   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
         8 002360   002364 601000 8                  TNZ     s:8113

   8112  8 002361   020000 236003                    LDQ     8192,DU
         8 002362   000001 256000 xsym               ORSQ    FLAGS+1
         8 002363   002366 710000 8                  TRA     s:8114

     1139     8113    1        ELSE FLAGS.ROUNDFLAG = FALSE;

   8113  8 002364   000164 236000 9                  LDQ     116
         8 002365   000001 356000 xsym               ANSQ    FLAGS+1

     1140     8114    1        RETURN;

   8114  8 002366   000000 702200 xent               TSX2  ! X66_ARET

     1141     8115        /**/
     1142     8116        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:156  
     1143     8117        /**/
     1144     8118    1   VEF$EXEC_RP: ENTRY;

   8118  8 002367   000000 700200 xent  VEF$EXEC_RP  TSX0  ! X66_AUTO_0
         8 002370   000152 000000                    ZERO    106,0

     1145     8119        /**/
     1146     8120    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.RPFLAG = TRUE;

   8120  8 002371   000000 470400 xsym               LDP0    CMD$
         8 002372   040000 106500                    CMPC    fill='040'O
         8 002373   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         8 002374   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
         8 002375   002401 601000 8                  TNZ     s:8121

   8120  8 002376   000200 236003                    LDQ     128,DU
         8 002377   000000 256000 xsym               ORSQ    FLAGS
         8 002400   002403 710000 8                  TRA     s:8122

     1147     8121    1        ELSE FLAGS.RPFLAG = FALSE;

   8121  8 002401   000004 236000 9                  LDQ     4
         8 002402   000000 356000 xsym               ANSQ    FLAGS

     1148     8122    1        RETURN;

   8122  8 002403   000000 702200 xent               TSX2  ! X66_ARET

     1149     8123        /**/
     1150     8124        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:157  
     1151     8125        /**/
     1152     8126    1   VEF$EXEC_STATUS: ENTRY;                 /* STATUS                             */

   8126  8 002404   000000 700200 xent  VEF$EXEC_ST* TSX0  ! X66_AUTO_0
         8 002405   000152 000000                    ZERO    106,0

     1153     8127        /**/
     1154     8128    1        IF (CMD$ -> TA_CMD_TBL.NUM_TABS = 0) THEN /* Full STATUS CMD */

   8128  8 002406   000000 470400 xsym               LDP0    CMD$
         8 002407   000010 236100                    LDQ     8,,PR0
         8 002410   000777 316007                    CANQ    511,DL
         8 002411   002423 601000 8                  TNZ     s:8133

     1155     8129    2        DO STATUS_FIELDS = 0 TO NUMSTATUSOPTS;

   8129  8 002412   200076 450100                    STZ     STATUS_FIELDS,,AUTO

     1156     8130    2           REPSTATUS(STATUS_FIELDS) = '1'B; /* Display them all */

   8130  8 002413   400000 236003                    LDQ     -131072,DU
         8 002414   200076 720100                    LXL0    STATUS_FIELDS,,AUTO
         8 002415   200077 756110                    STQ     REPSTATUS,X0,AUTO

     1157     8131    2           END;

   8131  8 002416   200076 054100                    AOS     STATUS_FIELDS,,AUTO
         8 002417   200076 235100                    LDA     STATUS_FIELDS,,AUTO
         8 002420   000014 115007                    CMPA    12,DL
         8 002421   002413 604400 8                  TMOZ    s:8130
         8 002422   002452 710000 8                  TRA     s:8143

     1158     8132    2        ELSE DO;                           /* Only Display selected STATUS stuff */

     1159     8133    3           DO STATUS_FIELDS = 0 to NUMSTATUSOPTS;

   8133  8 002423   200076 450100                    STZ     STATUS_FIELDS,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:158  

     1160     8134    3              REPSTATUS(STATUS_FIELDS) = '0'B; /* Assume not to Display */

   8134  8 002424   200076 720100                    LXL0    STATUS_FIELDS,,AUTO
         8 002425   200077 450110                    STZ     REPSTATUS,X0,AUTO

     1161     8135    3              END;

   8135  8 002426   200076 054100                    AOS     STATUS_FIELDS,,AUTO
         8 002427   200076 235100                    LDA     STATUS_FIELDS,,AUTO
         8 002430   000014 115007                    CMPA    12,DL
         8 002431   002424 604400 8                  TMOZ    s:8134

     1162     8136    3           DO STATUS_FIELDS = 0 TO CMD$ -> TA_CMD_TBL.NUM_TABS - 1;

   8136  8 002432   200076 450100                    STZ     STATUS_FIELDS,,AUTO
         8 002433   002445 710000 8                  TRA     s:8139+1

     1163     8137    3              REPSTATUS(CMD$ -> TA_CMD_TBL.TABS(STATUS_FIELDS)) = '1'B;

   8137  8 002434   000000 470400 xsym               LDP0    CMD$
         8 002435   200076 235100                    LDA     STATUS_FIELDS,,AUTO
         8 002436   000100 101505                    MRL     fill='000'O
         8 002437   000001 000001                    ADSC9   1,A,PR0                  cn=0,n=1
         8 002440   200146 000002                    ADSC9   LENGTH+1,,AUTO           cn=0,n=2
         8 002441   200146 220100                    LDX0    LENGTH+1,,AUTO
         8 002442   400000 236003                    LDQ     -131072,DU
         8 002443   200077 756110                    STQ     REPSTATUS,X0,AUTO

     1164     8138                                                /* Only Display what user wants */
     1165     8139    3              END;

   8139  8 002444   200076 054100                    AOS     STATUS_FIELDS,,AUTO
         8 002445   000000 470400 xsym               LDP0    CMD$
         8 002446   000010 236100                    LDQ     8,,PR0
         8 002447   000777 376007                    ANQ     511,DL
         8 002450   200076 116100                    CMPQ    STATUS_FIELDS,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:159  
         8 002451   002434 605400 8                  TPNZ    s:8137

     1166     8140    2           END;

     1167     8141        /**/
     1168     8142        /*   Initialize some temporaries */
     1169     8143    1        TEMP_STR = ' ';

   8143  8 002452   040100 100400                    MLR     fill='040'O
         8 002453   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 002454   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1170     8144    1        LINELEN = 0;

   8144  8 002455   200114 450100                    STZ     LINELEN,,AUTO

     1171     8145        /**/
     1172     8146
     1173     8147        /* Now go through each STATUS FIELD and display it if it was selected above   */
     1174     8148
     1175     8149    1   FILENAME: IF (~REPSTATUS(PC_FILENAMELIT-FIRSTSTATUS)) THEN GOTO SE;

   8149  8 002456   200111 236100       FILENAME     LDQ     REPSTATUS+10,,AUTO
         8 002457   400000 376003                    ANQ     -131072,DU
         8 002460   400000 676003                    ERQ     -131072,DU
         8 002461   002506 601000 8                  TNZ     SE

     1176     8150
     1177     8151        /* Display file name */
     1178     8152    2        IF (FLAGS.EDIT_MODE) THEN DO;

   8152  8 002462   000000 234000 xsym               SZN     FLAGS
         8 002463   002477 605000 8                  TPL     s:8157

     1179     8153    2           TYPE_BUF.TEXT = 'FILENAME = ';

   8153  8 002464   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:160  
         8 002465   000442 000013 2                  ADSC9   VLP_EDIT+3               cn=0,n=11
         8 002466   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092

     1180     8154    2           CALL M$UNFID(UNFID_FPT) ALTRET(UNFID_ALT) ;

   8154  8 002467   000406 630400 2                  EPPR0   UNFID_FPT
         8 002470   420021 713400                    CLIMB   alt,+8209
         8 002471   404400 401760                    pmme    nvectors=10
         8 002472   002473 702000 8                  TSX2    UNFID_ALT

     1181     8155    2   UNFID_ALT: CALL INSERT(TYPE_BUF.TEXT,11,,TEMP_BUF) ;

   8155  8 002473   040000 100400       UNFID_ALT    MLR     fill='040'O
         8 002474   000000 002000 xsym               ADSC9   TEMP_BUF                 cn=0,n=1024
         8 002475   000003 002071 xsym               ADSC9   TYPE_BUF+3               cn=0,n=1081

     1182     8156    2           END;

   8156  8 002476   002502 710000 8                  TRA     s:8158

     1183     8157    1        ELSE TYPE_BUF.TEXT = 'NO FILE OPEN';

   8157  8 002477   040000 100400                    MLR     fill='040'O
         8 002500   000445 000014 2                  ADSC9   VLP_EDIT+6               cn=0,n=12
         8 002501   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092

     1184     8158    1        CALL VEX$TYPE_REC(TYPECR);

   8158  8 002502   000003 630400 9                  EPPR0   3
         8 002503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 002504   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 002505   000000 011000                    NOP     0

     1185     8159        /**/
     1186     8160
     1187     8161    1   SE:  IF (~REPSTATUS(SECMD-FIRSTSTATUS)) THEN GOTO CL;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:161  
   8161  8 002506   200112 236100       SE           LDQ     REPSTATUS+11,,AUTO
         8 002507   400000 376003                    ANQ     -131072,DU
         8 002510   400000 676003                    ERQ     -131072,DU
         8 002511   002722 601000 8                  TNZ     CL

     1188     8162
     1189     8163        /* Display SE */
     1190     8164    1        TYPE_BUF.TEXT = 'SE ';             /* CONSTRUCT SE COMMAND               */

   8164  8 002512   040000 100400                    MLR     fill='040'O
         8 002513   000450 000003 2                  ADSC9   VLP_EDIT+9               cn=0,n=3
         8 002514   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092

     1191     8165    1        I = 3;

   8165  8 002515   000003 235007                    LDA     3,DL
         8 002516   000000 755000 xsym               STA     I

     1192     8166        /**/
     1193     8167    1        CALL VEX$SEQNUM_TEXT(LO_SEQNUM);

   8167  8 002517   000165 630400 9                  EPPR0   117
         8 002520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 002521   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         8 002522   000000 011000                    NOP     0

     1194     8168    1        CALL INSERT (TYPE_BUF.TEXT,I,9,SEQ_TEXT_BUF);

   8168  8 002523   000000 235000 xsym               LDA     I
         8 002524   040005 100400                    MLR     fill='040'O
         8 002525   000000 000011 xsym               ADSC9   SEQ_TEXT_BUF             cn=0,n=9
         8 002526   000000 200011 xsym               ADSC9   TYPE_BUF,A               cn=1,n=9

     1195     8169    1        I = 12;

   8169  8 002527   000014 236007                    LDQ     12,DL
         8 002530   000000 756000 xsym               STQ     I
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:162  

     1196     8170        /**/
     1197     8171    2        IF (HI_SEQNUM ~= LO_SEQNUM) THEN DO;

   8171  8 002531   000000 236000 xsym               LDQ     HI_SEQNUM
         8 002532   000000 116000 xsym               CMPQ    LO_SEQNUM
         8 002533   002551 600000 8                  TZE     s:8177

     1198     8172    2           CALL VEX$SEQNUM_TEXT(HI_SEQNUM);

   8172  8 002534   000124 630400 9                  EPPR0   84
         8 002535   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 002536   000000 701000 xent               TSX1    VEX$SEQNUM_TEXT
         8 002537   000000 011000                    NOP     0

     1199     8173    2           CALL INSERT (TYPE_BUF.TEXT,I,10,'-',SEQ_TEXT_BUF);

   8173  8 002540   000000 235000 xsym               LDA     I
         8 002541   040005 100400                    MLR     fill='040'O
         8 002542   000166 000001 9                  ADSC9   118                      cn=0,n=1
         8 002543   000000 200001 xsym               ADSC9   TYPE_BUF,A               cn=1,n=1
         8 002544   040005 100400                    MLR     fill='040'O
         8 002545   000000 000011 xsym               ADSC9   SEQ_TEXT_BUF             cn=0,n=9
         8 002546   000000 400011 xsym               ADSC9   TYPE_BUF,A               cn=2,n=9

     1200     8174    2           I = 22;

   8174  8 002547   000026 235007                    LDA     22,DL
         8 002550   000000 755000 xsym               STA     I

     1201     8175    2           END;

     1202     8176        /**/
     1203     8177    1        SSE$ = SSE_INIT$;

   8177  8 002551   000000 236000 xsym               LDQ     SSE_INIT$
         8 002552   000000 756000 xsym               STQ     SSE$
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:163  

     1204     8178    2        IF (SSE$ -> SSE$PARAM.PTR$ ~= ADDR(NIL)) THEN DO; /* SELECTION CRITERIA */

   8178  8 002553   000000 470400 xsym               LDP0    SSE$
         8 002554   000001 236100                    LDQ     1,,PR0
         8 002555   000001 116000 xsym               CMPQ    B_VECTNIL+1
         8 002556   002663 600000 8                  TZE     s:8214

     1205     8179    2           SSE_PARAM = SSE$ -> SSE$PARAM;

   8179  8 002557   000000 100500                    MLR     fill='000'O
         8 002560   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         8 002561   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

     1206     8180    2           CALL INSERT (TYPE_BUF.TEXT,I,1,',');

   8180  8 002562   000000 235000 xsym               LDA     I
         8 002563   040005 100400                    MLR     fill='040'O
         8 002564   000167 000001 9                  ADSC9   119                      cn=0,n=1
         8 002565   000000 200001 xsym               ADSC9   TYPE_BUF,A               cn=1,n=1

     1207     8181    2           I = I+1;

   8181  8 002566   000001 035007                    ADLA    1,DL
         8 002567   000000 755000 xsym               STA     I

     1208     8182    3           IF (SSE_PARAM.FLAGS.NOTFLAG) THEN DO;

   8182  8 002570   000000 236000 xsym               LDQ     SSE_PARAM
         8 002571   200000 316003                    CANQ    65536,DU
         8 002572   002600 600000 8                  TZE     s:8186

     1209     8183    3              CALL INSERT (TYPE_BUF.TEXT,I,3,'NOT');

   8183  8 002573   040005 100400                    MLR     fill='040'O
         8 002574   000451 000003 2                  ADSC9   VLP_EDIT+10              cn=0,n=3
         8 002575   000000 200003 xsym               ADSC9   TYPE_BUF,A               cn=1,n=3
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:164  

     1210     8184    3              I = I+3;

   8184  8 002576   000003 035007                    ADLA    3,DL
         8 002577   000000 755000 xsym               STA     I

     1211     8185    3              END;

     1212     8186    2           CALL INSERT_STRING ALTRET (STAT_ALT);

   8186  8 002600   003655 701000 8                  TSX1    INSERT_STRING
         8 002601   002716 702000 8                  TSX2    STAT_ALT

     1213     8187        /**/
     1214     8188    2           SSE$ = PINCRW(SSE$,SIZEW(SSE$PARAM));

   8188  8 002602   000000 236000 xsym               LDQ     SSE$
         8 002603   000002 036003                    ADLQ    2,DU
         8 002604   000000 756000 xsym               STQ     SSE$

     1215     8189    3           DO WHILE (SSE$ -> SSE$PARAM.PTR$ ~= ADDR(NIL));

   8189  8 002605   002657 710000 8                  TRA     s:8211

     1216     8190    3              SSE_PARAM = SSE$ -> SSE$PARAM;

   8190  8 002606   000000 470400 xsym               LDP0    SSE$
         8 002607   000000 100500                    MLR     fill='000'O
         8 002610   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         8 002611   000000 000010 xsym               ADSC9   SSE_PARAM                cn=0,n=8

     1217     8191    4              IF (SSE_PARAM.FLAGS.ANDFLAG) THEN DO;

   8191  8 002612   000000 236000 xsym               LDQ     SSE_PARAM
         8 002613   100000 316003                    CANQ    32768,DU
         8 002614   002624 600000 8                  TZE     s:8196

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:165  
     1218     8192    4                 CALL INSERT (TYPE_BUF.TEXT,I,3,'AND') ALTRET (STAT_ALT);

   8192  8 002615   000000 235000 xsym               LDA     I
         8 002616   040005 100400                    MLR     fill='040'O
         8 002617   000452 000003 2                  ADSC9   VLP_EDIT+11              cn=0,n=3
         8 002620   000000 200003 xsym               ADSC9   TYPE_BUF,A               cn=1,n=3

     1219     8193    4                 I = I+3;

   8193  8 002621   000003 035007                    ADLA    3,DL
         8 002622   000000 755000 xsym               STA     I

     1220     8194    4                 END;

   8194  8 002623   002643 710000 8                  TRA     s:8205

     1221     8195        /**/
     1222     8196    4              ELSE IF (SSE_PARAM.FLAGS.ORFLAG) THEN DO;

   8196  8 002624   040000 316003                    CANQ    16384,DU
         8 002625   002635 600000 8                  TZE     s:8201

     1223     8197    4                    CALL INSERT (TYPE_BUF.TEXT,I,2,'OR') ALTRET (STAT_ALT);

   8197  8 002626   000000 235000 xsym               LDA     I
         8 002627   040005 100400                    MLR     fill='040'O
         8 002630   000453 000002 2                  ADSC9   VLP_EDIT+12              cn=0,n=2
         8 002631   000000 200002 xsym               ADSC9   TYPE_BUF,A               cn=1,n=2

     1224     8198    4                    I = I+2;

   8198  8 002632   000002 035007                    ADLA    2,DL
         8 002633   000000 755000 xsym               STA     I

     1225     8199    4                    END;

   8199  8 002634   002643 710000 8                  TRA     s:8205
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:166  

     1226     8200    4                 ELSE DO;

     1227     8201    4                    CALL INSERT (TYPE_BUF.TEXT,I,3,'EOR') ALTRET (STAT_ALT);

   8201  8 002635   000000 235000 xsym               LDA     I
         8 002636   040005 100400                    MLR     fill='040'O
         8 002637   000454 000003 2                  ADSC9   VLP_EDIT+13              cn=0,n=3
         8 002640   000000 200003 xsym               ADSC9   TYPE_BUF,A               cn=1,n=3

     1228     8202    4                    I = I+3;

   8202  8 002641   000003 035007                    ADLA    3,DL
         8 002642   000000 755000 xsym               STA     I

     1229     8203    4                    END;

     1230     8204        /**/
     1231     8205    4              IF (SSE_PARAM.FLAGS.NOTFLAG) THEN DO;

   8205  8 002643   200000 316003                    CANQ    65536,DU
         8 002644   002652 600000 8                  TZE     s:8209

     1232     8206    4                 CALL INSERT (TYPE_BUF.TEXT,I,4,',NOT') ALTRET (STAT_ALT);

   8206  8 002645   040005 100400                    MLR     fill='040'O
         8 002646   000455 000004 2                  ADSC9   VLP_EDIT+14              cn=0,n=4
         8 002647   000000 200004 xsym               ADSC9   TYPE_BUF,A               cn=1,n=4

     1233     8207    4                 I = I+4;

   8207  8 002650   000004 035007                    ADLA    4,DL
         8 002651   000000 755000 xsym               STA     I

     1234     8208    4                 END;

     1235     8209    3              CALL INSERT_STRING ALTRET (STAT_ALT);
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:167  

   8209  8 002652   003655 701000 8                  TSX1    INSERT_STRING
         8 002653   002716 702000 8                  TSX2    STAT_ALT

     1236     8210    3              SSE$ = PINCRW(SSE$,SIZEW(SSE$PARAM));

   8210  8 002654   000000 236000 xsym               LDQ     SSE$
         8 002655   000002 036003                    ADLQ    2,DU
         8 002656   000000 756000 xsym               STQ     SSE$

     1237     8211    3              END;

   8211  8 002657   000000 470400 xsym               LDP0    SSE$
         8 002660   000001 236100                    LDQ     1,,PR0
         8 002661   000001 116000 xsym               CMPQ    B_VECTNIL+1
         8 002662   002606 601000 8                  TNZ     s:8190

     1238     8212    2           END;

     1239     8213        /**/
     1240     8214    1        CALL BINCHAR (SUBSTR(TEMP_BUF,0,4),LO_SRCH_CLMN+1);

   8214  8 002663   000000 235000 xsym               LDA     LO_SRCH_CLMN
         8 002664   000001 035007                    ADLA    1,DL
         8 002665   000044 773000                    LRL     36
         8 002666   200146 757100                    STAQ    LENGTH+1,,AUTO
         8 002667   000000 301500                    BTD
         8 002670   200146 000010                    NDSC9   LENGTH+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         8 002671   000000 030004 xsym               NDSC9   TEMP_BUF                 cn=0,s=nosgn,sf=0,n=4

     1241     8215    1        CALL BINCHAR (SUBSTR(CMD_BUF,0,4),HI_SRCH_CLMN+1);

   8215  8 002672   000000 235000 xsym               LDA     HI_SRCH_CLMN
         8 002673   000001 035007                    ADLA    1,DL
         8 002674   000044 773000                    LRL     36
         8 002675   200146 757100                    STAQ    LENGTH+1,,AUTO
         8 002676   000000 301500                    BTD
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:168  
         8 002677   200146 000010                    NDSC9   LENGTH+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         8 002700   000000 030004 xsym               NDSC9   CMD_BUF                  cn=0,s=nosgn,sf=0,n=4

     1242     8216        /**/
     1243     8217    1        CALL INSERT (TYPE_BUF.TEXT,I,10,',',SUBSTR(TEMP_BUF,0,4),

   8217  8 002701   000000 235000 xsym               LDA     I
         8 002702   040005 100400                    MLR     fill='040'O
         8 002703   000167 000001 9                  ADSC9   119                      cn=0,n=1
         8 002704   000000 200001 xsym               ADSC9   TYPE_BUF,A               cn=1,n=1
         8 002705   040005 100400                    MLR     fill='040'O
         8 002706   000000 000004 xsym               ADSC9   TEMP_BUF                 cn=0,n=4
         8 002707   000000 400004 xsym               ADSC9   TYPE_BUF,A               cn=2,n=4
         8 002710   040005 100400                    MLR     fill='040'O
         8 002711   000167 000001 9                  ADSC9   119                      cn=0,n=1
         8 002712   000001 400001 xsym               ADSC9   TYPE_BUF+1,A             cn=2,n=1
         8 002713   040005 100400                    MLR     fill='040'O
         8 002714   000000 000004 xsym               ADSC9   CMD_BUF                  cn=0,n=4
         8 002715   000001 600004 xsym               ADSC9   TYPE_BUF+1,A             cn=3,n=4

     1244     8218    1           ',',SUBSTR(CMD_BUF,0,4));
     1245     8219        /**/
     1246     8220    1   STAT_ALT:
     1247     8221    1        CALL VEX$TYPE_REC(TYPECR);

   8221  8 002716   000003 630400 9     STAT_ALT     EPPR0   3
         8 002717   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 002720   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 002721   000000 011000                    NOP     0

     1248     8222        /**/
     1249     8223
     1250     8224    1   CL:  IF (~REPSTATUS(CLCMD-FIRSTSTATUS)) THEN GOTO TA;

   8224  8 002722   200104 236100       CL           LDQ     REPSTATUS+5,,AUTO
         8 002723   400000 376003                    ANQ     -131072,DU
         8 002724   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:169  
         8 002725   002770 601000 8                  TNZ     TA

     1251     8225
     1252     8226        /* Display the Current CL settings */
     1253     8227    2        IF ((LO_SRCH_CLMN ~= LO_EXEC_CLMN)OR(HI_SRCH_CLMN ~= HI_EXEC_CLMN)) THEN DO;

   8227  8 002726   000000 236000 xsym               LDQ     LO_SRCH_CLMN
         8 002727   000000 116000 xsym               CMPQ    LO_EXEC_CLMN
         8 002730   002734 601000 8                  TNZ     s:8228
         8 002731   000000 236000 xsym               LDQ     HI_SRCH_CLMN
         8 002732   000000 116000 xsym               CMPQ    HI_EXEC_CLMN
         8 002733   002770 600000 8                  TZE     TA

     1254     8228    2           CALL BINCHAR (SUBSTR(TEMP_BUF,0,4),LO_EXEC_CLMN+1);

   8228  8 002734   000000 235000 xsym               LDA     LO_EXEC_CLMN
         8 002735   000001 035007                    ADLA    1,DL
         8 002736   000044 773000                    LRL     36
         8 002737   200146 757100                    STAQ    LENGTH+1,,AUTO
         8 002740   000000 301500                    BTD
         8 002741   200146 000010                    NDSC9   LENGTH+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         8 002742   000000 030004 xsym               NDSC9   TEMP_BUF                 cn=0,s=nosgn,sf=0,n=4

     1255     8229    2           CALL BINCHAR (SUBSTR(CMD_BUF,0,4),HI_EXEC_CLMN+1);

   8229  8 002743   000000 235000 xsym               LDA     HI_EXEC_CLMN
         8 002744   000001 035007                    ADLA    1,DL
         8 002745   000044 773000                    LRL     36
         8 002746   200146 757100                    STAQ    LENGTH+1,,AUTO
         8 002747   000000 301500                    BTD
         8 002750   200146 000010                    NDSC9   LENGTH+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         8 002751   000000 030004 xsym               NDSC9   CMD_BUF                  cn=0,s=nosgn,sf=0,n=4

     1256     8230    2           CALL CONCAT (TYPE_BUF.TEXT,'CL ',SUBSTR(TEMP_BUF,0,4),',',

   8230  8 002752   000456 236000 2                  LDQ     VLP_EDIT+15
         8 002753   000011 772000                    QRL     9
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:170  
         8 002754   000000 552034 xsym               STBQ    TYPE_BUF,'34'O
         8 002755   000000 236000 xsym               LDQ     TEMP_BUF
         8 002756   000001 756000 xsym               STQ     TYPE_BUF+1
         8 002757   054000 236003                    LDQ     22528,DU
         8 002760   000002 552040 xsym               STBQ    TYPE_BUF+2,'40'O
         8 002761   040000 100400                    MLR     fill='040'O
         8 002762   000000 000004 xsym               ADSC9   CMD_BUF                  cn=0,n=4
         8 002763   000002 202074 xsym               ADSC9   TYPE_BUF+2               cn=1,n=1084

     1257     8231    2              SUBSTR(CMD_BUF,0,4));
     1258     8232    2           CALL VEX$TYPE_REC(TYPECR);

   8232  8 002764   000003 630400 9                  EPPR0   3
         8 002765   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 002766   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 002767   000000 011000                    NOP     0

     1259     8233    2           END;

     1260     8234        /**/
     1261     8235
     1262     8236
     1263     8237    1   TA:  IF (~REPSTATUS(TACMD-FIRSTSTATUS)) THEN GOTO DIR;

   8237  8 002770   200103 236100       TA           LDQ     REPSTATUS+4,,AUTO
         8 002771   400000 376003                    ANQ     -131072,DU
         8 002772   400000 676003                    ERQ     -131072,DU
         8 002773   003067 601000 8                  TNZ     DIR

     1264     8238
     1265     8239        /* Display TA */
     1266     8240    1        IF (NUM_TABS = 0) THEN

   8240  8 002774   000000 235000 xsym               LDA     NUM_TABS
         8 002775   003002 601000 8                  TNZ     s:8243

     1267     8241    1           TYPE_BUF.TEXT = 'NO TABS SET';
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:171  

   8241  8 002776   040000 100400                    MLR     fill='040'O
         8 002777   000457 000013 2                  ADSC9   VLP_EDIT+16              cn=0,n=11
         8 003000   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092
         8 003001   003063 710000 8                  TRA     s:8258

     1268     8242    2        ELSE DO;

     1269     8243    2           TYPE_BUF.TEXT = 'TA';

   8243  8 003002   040000 100400                    MLR     fill='040'O
         8 003003   000462 000002 2                  ADSC9   VLP_EDIT+19              cn=0,n=2
         8 003004   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092

     1270     8244    2           I = 3;

   8244  8 003005   000003 236007                    LDQ     3,DL
         8 003006   000000 756000 xsym               STQ     I

     1271     8245    3           DO TEMP_COUNT = 0 TO NUM_TABS - 1;

   8245  8 003007   000000 450000 xsym               STZ     TEMP_COUNT
         8 003010   003060 710000 8                  TRA     s:8256+3

     1272     8246    3              CALL BINCHAR(SUBSTR(TEMP_BUF,0,3),TAB_VLP.TABS#(TEMP_COUNT));

   8246  8 003011   000000 235000 xsym               LDA     TEMP_COUNT
         8 003012   000100 101405                    MRL     fill='000'O
         8 003013   000000 200001 xsym               ADSC9   TAB_VLP,A                cn=1,n=1
         8 003014   200146 000004                    ADSC9   LENGTH+1,,AUTO           cn=0,n=4
         8 003015   200146 236100                    LDQ     LENGTH+1,,AUTO
         8 003016   000000 235003                    LDA     0,DU
         8 003017   200150 757100                    STAQ    LENGTH+3,,AUTO
         8 003020   000000 301500                    BTD
         8 003021   200150 000010                    NDSC9   LENGTH+3,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         8 003022   000000 030003 xsym               NDSC9   TEMP_BUF                 cn=0,s=nosgn,sf=0,n=3

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:172  
     1273     8247    3              IF (SUBSTR(TEMP_BUF,0,1) = '0') THEN

   8247  8 003023   000000 236000 xsym               LDQ     TEMP_BUF
         8 003024   777000 376003                    ANQ     -512,DU
         8 003025   060000 116003                    CMPQ    24576,DU
         8 003026   003037 601000 8                  TNZ     s:8250

     1274     8248    3                 IF (TEMP_COUNT = 0) THEN CALL INSERT(TEMP_BUF,0,1,' ');

   8248  8 003027   000000 236000 xsym               LDQ     TEMP_COUNT
         8 003030   003034 601000 8                  TNZ     s:8249

   8248  8 003031   040000 236003                    LDQ     16384,DU
         8 003032   000000 552040 xsym               STBQ    TEMP_BUF,'40'O
         8 003033   003047 710000 8                  TRA     s:8254

     1275     8249    3                 ELSE CALL INSERT(TEMP_BUF,0,1,',');

   8249  8 003034   054000 236003                    LDQ     22528,DU
         8 003035   000000 552040 xsym               STBQ    TEMP_BUF,'40'O
         8 003036   003047 710000 8                  TRA     s:8254

     1276     8250    4              ELSE IF (TEMP_COUNT ~= 0) THEN DO;

   8250  8 003037   000000 236000 xsym               LDQ     TEMP_COUNT
         8 003040   003047 600000 8                  TZE     s:8254

     1277     8251    4                    CALL INSERT(TYPE_BUF.TEXT,I,1,',');

   8251  8 003041   000000 235000 xsym               LDA     I
         8 003042   040005 100400                    MLR     fill='040'O
         8 003043   000167 000001 9                  ADSC9   119                      cn=0,n=1
         8 003044   000000 200001 xsym               ADSC9   TYPE_BUF,A               cn=1,n=1

     1278     8252    4                    I = I+1;

   8252  8 003045   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:173  
         8 003046   000000 755000 xsym               STA     I

     1279     8253    4                    END;

     1280     8254    3              CALL INSERT(TYPE_BUF.TEXT,I,3,SUBSTR(TEMP_BUF,0,3));

   8254  8 003047   000000 235000 xsym               LDA     I
         8 003050   040005 100400                    MLR     fill='040'O
         8 003051   000000 000003 xsym               ADSC9   TEMP_BUF                 cn=0,n=3
         8 003052   000000 200003 xsym               ADSC9   TYPE_BUF,A               cn=1,n=3

     1281     8255    3              I = I+3;

   8255  8 003053   000003 035007                    ADLA    3,DL
         8 003054   000000 755000 xsym               STA     I

     1282     8256    3              END;

   8256  8 003055   000000 236000 xsym               LDQ     TEMP_COUNT
         8 003056   000001 036007                    ADLQ    1,DL
         8 003057   000000 756000 xsym               STQ     TEMP_COUNT
         8 003060   000000 236000 xsym               LDQ     TEMP_COUNT
         8 003061   000000 116000 xsym               CMPQ    NUM_TABS
         8 003062   003011 602000 8                  TNC     s:8246

     1283     8257    2           END;

     1284     8258    1        CALL VEX$TYPE_REC(TYPECR);

   8258  8 003063   000003 630400 9                  EPPR0   3
         8 003064   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 003065   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 003066   000000 011000                    NOP     0

     1285     8259        /**/
     1286     8260    1   DIR: IF (~REPSTATUS(DIRCMD-FIRSTSTATUS)) THEN GOTO MODE;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:174  
   8260  8 003067   200107 236100       DIR          LDQ     REPSTATUS+8,,AUTO
         8 003070   400000 376003                    ANQ     -131072,DU
         8 003071   400000 676003                    ERQ     -131072,DU
         8 003072   003144 601000 8                  TNZ     MODE

     1287     8261
     1288     8262        /* Display Directory */
     1289     8263    1        TYPE_BUF.TEXT = 'DIRECTORY: ' ;

   8263  8 003073   040000 100400                    MLR     fill='040'O
         8 003074   000463 000013 2                  ADSC9   VLP_EDIT+20              cn=0,n=11
         8 003075   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092

     1290     8264    1        CALL INDEX(I,' ',B$JIT.FPSN) ;

   8264  8 003076   000000 470400 xsym               LDP0    B$JIT$
         8 003077   000000 124500                    SCM     mask='000'O
         8 003100   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
         8 003101   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 003102   000000 000000 xsym               ARG     I

     1291     8265    1        IF I > 0 THEN                      /* Insert PSN.                        */

   8265  8 003103   000000 235000 xsym               LDA     I
         8 003104   003116 600000 8                  TZE     s:8270

     1292     8266    2        DO ;

     1293     8267    2           CALL INSERT(TYPE_BUF.TEXT,11,,'DP#',B$JIT.FPSN) ;

   8267  8 003105   000466 236000 2                  LDQ     VLP_EDIT+23
         8 003106   000003 552070 xsym               STBQ    TYPE_BUF+3,'70'O
         8 003107   040000 100500                    MLR     fill='040'O
         8 003110   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
         8 003111   000003 602066 xsym               ADSC9   TYPE_BUF+3               cn=3,n=1078

     1294     8268    2           I = 11 + I + 3 ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:175  

   8268  8 003112   000000 235000 xsym               LDA     I
         8 003113   000016 035007                    ADLA    14,DL
         8 003114   000000 755000 xsym               STA     I

     1295     8269    2           END ;                           /* THEN DO                            */

   8269  8 003115   003120 710000 8                  TRA     s:8272

     1296     8270    1        ELSE I = 11;

   8270  8 003116   000013 236007                    LDQ     11,DL
         8 003117   000000 756000 xsym               STQ     I

     1297     8271                                                /* Insert ACCOUNT.                    */
     1298     8272    1        CALL INSERT( TYPE_BUF.TEXT,I,,'.',B$JIT.FACCN ) ;

   8272  8 003120   000000 720000 xsym               LXL0    I
         8 003121   775673 620010                    EAX0    -1093,X0
         8 003122   777777 660003                    ERX0    -1,DU
         8 003123   000000 235000 xsym               LDA     I
         8 003124   040045 100400                    MLR     fill='040'O
         8 003125   000170 000001 9                  ADSC9   120                      cn=0,n=1
         8 003126   000000 200010 xsym               ADSC9   TYPE_BUF,A               cn=1,n=*X0
         8 003127   000000 236000 xsym               LDQ     I
         8 003130   002103 116007                    CMPQ    1091,DL
         8 003131   003140 603000 8                  TRC     s:8273
         8 003132   775674 621006                    EAX1    -1092,QL
         8 003133   777777 661003                    ERX1    -1,DU
         8 003134   000000 470400 xsym               LDP0    B$JIT$
         8 003135   040046 100500                    MLR     fill='040'O
         8 003136   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         8 003137   000000 400011 xsym               ADSC9   TYPE_BUF,Q               cn=2,n=*X1

     1299     8273    1        CALL VEX$TYPE_REC(TYPECR) ;

   8273  8 003140   000003 630400 9                  EPPR0   3
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:176  
         8 003141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 003142   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 003143   000000 011000                    NOP     0

     1300     8274        /**/
     1301     8275
     1302     8276    1   MODE: IF (~REPSTATUS(PC_MODELIT-FIRSTSTATUS)) THEN GOTO BP;

   8276  8 003144   200110 236100       MODE         LDQ     REPSTATUS+9,,AUTO
         8 003145   400000 376003                    ANQ     -131072,DU
         8 003146   400000 676003                    ERQ     -131072,DU
         8 003147   003256 601000 8                  TNZ     BP

     1303     8277
     1304     8278        /* Display MODE */
     1305     8279    1        IF (FLAGS.EDIT_MODE) THEN          /* Currently editing a file */

   8279  8 003150   000000 234000 xsym               SZN     FLAGS
         8 003151   003245 605000 8                  TPL     s:8302

     1306     8280    2        DO CASE (BITBIN(M$FILE$ -> F$DCB.FFLG.DELR) +

   8280  8 003152   000000 470400 xsym               LDP0    M$FILE$
         8 003153   000004 236100                    LDQ     4,,PR0
         8 003154   000042 772000                    QRL     34
         8 003155   000001 376007                    ANQ     1,DL
         8 003156   200146 756100                    STQ     LENGTH+1,,AUTO
         8 003157   000004 236100                    LDQ     4,,PR0
         8 003160   000041 772000                    QRL     33
         8 003161   000001 376007                    ANQ     1,DL
         8 003162   000001 736000                    QLS     1
         8 003163   200146 036100                    ADLQ    LENGTH+1,,AUTO
         8 003164   200147 756100                    STQ     LENGTH+2,,AUTO
         8 003165   000004 236100                    LDQ     4,,PR0
         8 003166   000040 772000                    QRL     32
         8 003167   000001 376007                    ANQ     1,DL
         8 003170   000002 736000                    QLS     2
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:177  
         8 003171   200147 036100                    ADLQ    LENGTH+2,,AUTO
         8 003172   000010 116007                    CMPQ    8,DL
         8 003173   003175 602006 8                  TNC     s:8280+19,QL
         8 003174   003250 710000 8                  TRA     s:8303
         8 003175   003205 710000 8                  TRA     s:8285
         8 003176   003211 710000 8                  TRA     s:8287
         8 003177   003215 710000 8                  TRA     s:8289
         8 003200   003221 710000 8                  TRA     s:8291
         8 003201   003225 710000 8                  TRA     s:8293
         8 003202   003231 710000 8                  TRA     s:8295
         8 003203   003235 710000 8                  TRA     s:8297
         8 003204   003241 710000 8                  TRA     s:8299

     1307     8281    2           BITBIN(M$FILE$ -> F$DCB.FFLG.WNEW)*2 +
     1308     8282    2           BITBIN(M$FILE$ -> F$DCB.FFLG.UPD)*4 ) ;
     1309     8283
     1310     8284    2        CASE (0);

     1311     8285    2           TEMP_STR='EXAMINE MODE   ' ;

   8285  8 003205   040100 100400                    MLR     fill='040'O
         8 003206   000467 000017 2                  ADSC9   VLP_EDIT+24              cn=0,n=15
         8 003207   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003210   003250 710000 8                  TRA     s:8303

     1312     8286    2        CASE (1);

     1313     8287    2           TEMP_STR='DELR ONLY MODE ' ;

   8287  8 003211   040100 100400                    MLR     fill='040'O
         8 003212   000473 000017 2                  ADSC9   VLP_EDIT+28              cn=0,n=15
         8 003213   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003214   003250 710000 8                  TRA     s:8303

     1314     8288    2        CASE (2);

     1315     8289    2           TEMP_STR='WNEW ONLY MODE ' ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:178  

   8289  8 003215   040100 100400                    MLR     fill='040'O
         8 003216   000477 000017 2                  ADSC9   VLP_EDIT+32              cn=0,n=15
         8 003217   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003220   003250 710000 8                  TRA     s:8303

     1316     8290    2        CASE (3);

     1317     8291    2           TEMP_STR='CAN''T RR MODE  ' ;

   8291  8 003221   040100 100400                    MLR     fill='040'O
         8 003222   000503 000017 2                  ADSC9   VLP_EDIT+36              cn=0,n=15
         8 003223   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003224   003250 710000 8                  TRA     s:8303

     1318     8292    2        CASE (4);

     1319     8293    2           TEMP_STR='RR ONLY MODE   ' ;

   8293  8 003225   040100 100400                    MLR     fill='040'O
         8 003226   000507 000017 2                  ADSC9   VLP_EDIT+40              cn=0,n=15
         8 003227   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003230   003250 710000 8                  TRA     s:8303

     1320     8294    2        CASE (5);

     1321     8295    2           TEMP_STR='CAN''T WNEW MODE' ;

   8295  8 003231   040100 100400                    MLR     fill='040'O
         8 003232   000513 000017 2                  ADSC9   VLP_EDIT+44              cn=0,n=15
         8 003233   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003234   003250 710000 8                  TRA     s:8303

     1322     8296    2        CASE (6);

     1323     8297    2           TEMP_STR='CAN''T DELR MODE' ;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:179  
   8297  8 003235   040100 100400                    MLR     fill='040'O
         8 003236   000517 000017 2                  ADSC9   VLP_EDIT+48              cn=0,n=15
         8 003237   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003240   003250 710000 8                  TRA     s:8303

     1324     8298    2        CASE (7);

     1325     8299    2           TEMP_STR='EDIT MODE      ' ;

   8299  8 003241   040100 100400                    MLR     fill='040'O
         8 003242   000523 000017 2                  ADSC9   VLP_EDIT+52              cn=0,n=15
         8 003243   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1326     8300    2        END;

   8300  8 003244   003250 710000 8                  TRA     s:8303

     1327     8301
     1328     8302    1        ELSE TEMP_STR =   'NO FILE MODE   ';

   8302  8 003245   040100 100400                    MLR     fill='040'O
         8 003246   000527 000017 2                  ADSC9   VLP_EDIT+56              cn=0,n=15
         8 003247   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1329     8303    1        CALL FILL_LINE(TEMP_STR,15);

   8303  8 003250   000172 236000 9                  LDQ     122
         8 003251   200144 756100                    STQ     @STR+1,,AUTO
         8 003252   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003253   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003254   004150 701000 8                  TSX1    FILL_LINE
         8 003255   000000 011000                    NOP     0

     1330     8304        /**/
     1331     8305
     1332     8306    1   BP:  IF (~REPSTATUS(BPCMD-FIRSTSTATUS)) THEN GOTO CR;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:180  
   8306  8 003256   200077 236100       BP           LDQ     REPSTATUS,,AUTO
         8 003257   400000 376003                    ANQ     -131072,DU
         8 003260   400000 676003                    ERQ     -131072,DU
         8 003261   003301 601000 8                  TNZ     CR

     1333     8307
     1334     8308        /* Display BP */
     1335     8309    1        IF (FLAGS.BPFLAG) THEN TEMP_STR = 'BP ON ';

   8309  8 003262   000000 430000 xsym               FSZN    FLAGS
         8 003263   003270 605000 8                  TPL     s:8310

   8309  8 003264   040100 100400                    MLR     fill='040'O
         8 003265   000533 000006 2                  ADSC9   VLP_EDIT+60              cn=0,n=6
         8 003266   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003267   003273 710000 8                  TRA     s:8311

     1336     8310    1        ELSE TEMP_STR = 'BP OFF';

   8310  8 003270   040100 100400                    MLR     fill='040'O
         8 003271   000535 000006 2                  ADSC9   VLP_EDIT+62              cn=0,n=6
         8 003272   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1337     8311    1        CALL FILL_LINE(TEMP_STR,6);

   8311  8 003273   000173 236000 9                  LDQ     123
         8 003274   200144 756100                    STQ     @STR+1,,AUTO
         8 003275   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003276   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003277   004150 701000 8                  TSX1    FILL_LINE
         8 003300   000000 011000                    NOP     0

     1338     8312        /**/
     1339     8313
     1340     8314    1   CR:  IF (~REPSTATUS(CRCMD-FIRSTSTATUS)) THEN GOTO RP;

   8314  8 003301   200100 236100       CR           LDQ     REPSTATUS+1,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:181  
         8 003302   400000 376003                    ANQ     -131072,DU
         8 003303   400000 676003                    ERQ     -131072,DU
         8 003304   003325 601000 8                  TNZ     RP

     1341     8315
     1342     8316        /* Display CR */
     1343     8317    1        IF (FLAGS.CRFLAG) THEN TEMP_STR = 'CR ON ';

   8317  8 003305   000000 236000 xsym               LDQ     FLAGS
         8 003306   000400 316003                    CANQ    256,DU
         8 003307   003314 600000 8                  TZE     s:8318

   8317  8 003310   040100 100400                    MLR     fill='040'O
         8 003311   000537 000006 2                  ADSC9   VLP_EDIT+64              cn=0,n=6
         8 003312   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003313   003317 710000 8                  TRA     s:8319

     1344     8318    1        ELSE TEMP_STR = 'CR OFF';

   8318  8 003314   040100 100400                    MLR     fill='040'O
         8 003315   000541 000006 2                  ADSC9   VLP_EDIT+66              cn=0,n=6
         8 003316   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1345     8319    1        CALL FILL_LINE(TEMP_STR,6);

   8319  8 003317   000173 236000 9                  LDQ     123
         8 003320   200144 756100                    STQ     @STR+1,,AUTO
         8 003321   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003322   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003323   004150 701000 8                  TSX1    FILL_LINE
         8 003324   000000 011000                    NOP     0

     1346     8320        /**/
     1347     8321
     1348     8322    1   RP:  IF (~REPSTATUS(RPCMD-FIRSTSTATUS)) THEN GOTO VE;

   8322  8 003325   200101 236100       RP           LDQ     REPSTATUS+2,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:182  
         8 003326   400000 376003                    ANQ     -131072,DU
         8 003327   400000 676003                    ERQ     -131072,DU
         8 003330   003421 601000 8                  TNZ     VE

     1349     8323
     1350     8324        /* Display RP */
     1351     8325    1        IF (FLAGS.RPFLAG) THEN TEMP_STR = 'RP ON ';

   8325  8 003331   000000 236000 xsym               LDQ     FLAGS
         8 003332   000200 316003                    CANQ    128,DU
         8 003333   003340 600000 8                  TZE     s:8326

   8325  8 003334   040100 100400                    MLR     fill='040'O
         8 003335   000543 000006 2                  ADSC9   VLP_EDIT+68              cn=0,n=6
         8 003336   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003337   003343 710000 8                  TRA     s:8327

     1352     8326    1        ELSE TEMP_STR = 'RP OFF';

   8326  8 003340   040100 100400                    MLR     fill='040'O
         8 003341   000545 000006 2                  ADSC9   VLP_EDIT+70              cn=0,n=6
         8 003342   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1353     8327    1        CALL FILL_LINE(TEMP_STR,6);

   8327  8 003343   000173 236000 9                  LDQ     123
         8 003344   200144 756100                    STQ     @STR+1,,AUTO
         8 003345   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003346   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003347   004150 701000 8                  TSX1    FILL_LINE
         8 003350   000000 011000                    NOP     0

     1354     8328        /**/
     1355     8329
     1356     8330    1   TABX: IF (~REPSTATUS(TABXCMD-FIRSTSTATUS)) THEN GOTO TABC;

   8330  8 003351   200102 236100       TABX         LDQ     REPSTATUS+3,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:183  
         8 003352   400000 376003                    ANQ     -131072,DU
         8 003353   400000 676003                    ERQ     -131072,DU
         8 003354   003375 601000 8                  TNZ     TABC

     1357     8331
     1358     8332        /* Display TABX */
     1359     8333    1        IF (FLAGS.TABXFLAG) THEN TEMP_STR = 'TABX ON ';

   8333  8 003355   000000 236000 xsym               LDQ     FLAGS
         8 003356   000100 316003                    CANQ    64,DU
         8 003357   003364 600000 8                  TZE     s:8334

   8333  8 003360   040100 100400                    MLR     fill='040'O
         8 003361   000547 000010 2                  ADSC9   VLP_EDIT+72              cn=0,n=8
         8 003362   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003363   003367 710000 8                  TRA     s:8335

     1360     8334    1        ELSE TEMP_STR = 'TABX OFF';

   8334  8 003364   040100 100400                    MLR     fill='040'O
         8 003365   000551 000010 2                  ADSC9   VLP_EDIT+74              cn=0,n=8
         8 003366   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1361     8335    1        CALL FILL_LINE(TEMP_STR,8);

   8335  8 003367   000174 236000 9                  LDQ     124
         8 003370   200144 756100                    STQ     @STR+1,,AUTO
         8 003371   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003372   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003373   004150 701000 8                  TSX1    FILL_LINE
         8 003374   000000 011000                    NOP     0

     1362     8336        /**/
     1363     8337
     1364     8338    1   TABC: IF (~REPSTATUS(TABCCMD-FIRSTSTATUS)) THEN GOTO VE;

   8338  8 003375   200105 236100       TABC         LDQ     REPSTATUS+6,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:184  
         8 003376   400000 376003                    ANQ     -131072,DU
         8 003377   400000 676003                    ERQ     -131072,DU
         8 003400   003421 601000 8                  TNZ     VE

     1365     8339
     1366     8340        /* Display TABC */
     1367     8341    1        IF (FLAGS.TABCFLAG) THEN TEMP_STR = 'TABC ON ';

   8341  8 003401   000000 236000 xsym               LDQ     FLAGS
         8 003402   000001 316003                    CANQ    1,DU
         8 003403   003410 600000 8                  TZE     s:8342

   8341  8 003404   040100 100400                    MLR     fill='040'O
         8 003405   000553 000010 2                  ADSC9   VLP_EDIT+76              cn=0,n=8
         8 003406   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003407   003413 710000 8                  TRA     s:8343

     1368     8342    1        ELSE TEMP_STR = 'TABC OFF';

   8342  8 003410   040100 100400                    MLR     fill='040'O
         8 003411   000555 000010 2                  ADSC9   VLP_EDIT+78              cn=0,n=8
         8 003412   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1369     8343    1        CALL FILL_LINE(TEMP_STR,8);

   8343  8 003413   000174 236000 9                  LDQ     124
         8 003414   200144 756100                    STQ     @STR+1,,AUTO
         8 003415   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003416   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003417   004150 701000 8                  TSX1    FILL_LINE
         8 003420   000000 011000                    NOP     0

     1370     8344        /**/
     1371     8345
     1372     8346    1   VE:  IF (~REPSTATUS(VECMD-FIRSTSTATUS)) THEN GOTO ROUND;

   8346  8 003421   200106 236100       VE           LDQ     REPSTATUS+7,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:185  
         8 003422   400000 376003                    ANQ     -131072,DU
         8 003423   400000 676003                    ERQ     -131072,DU
         8 003424   003472 601000 8                  TNZ     ROUND

     1373     8347
     1374     8348        /* Display VE */
     1375     8349    2        IF (FLAGS.VERIFY) THEN DO;

   8349  8 003425   000000 236000 xsym               LDQ     FLAGS
         8 003426   010000 316007                    CANQ    4096,DL
         8 003427   003461 600000 8                  TZE     s:8355

     1376     8350    2           IF (VERIFY_TYPE = TYCMD) THEN TEMP_STR = 'VE TY ';

   8350  8 003430   000000 235000 xsym               LDA     VERIFY_TYPE
         8 003431   000062 115007                    CMPA    50,DL
         8 003432   003437 601000 8                  TNZ     s:8351

   8350  8 003433   040100 100400                    MLR     fill='040'O
         8 003434   000557 000006 2                  ADSC9   VLP_EDIT+80              cn=0,n=6
         8 003435   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003436   003464 710000 8                  TRA     s:8356

     1377     8351    2           ELSE IF (VERIFY_TYPE = TSCMD) THEN TEMP_STR = 'VE TS ';

   8351  8 003437   000063 115007                    CMPA    51,DL
         8 003440   003445 601000 8                  TNZ     s:8352

   8351  8 003441   040100 100400                    MLR     fill='040'O
         8 003442   000561 000006 2                  ADSC9   VLP_EDIT+82              cn=0,n=6
         8 003443   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003444   003464 710000 8                  TRA     s:8356

     1378     8352    2              ELSE IF (VERIFY_TYPE = TCCMD) THEN TEMP_STR = 'VE TC ';

   8352  8 003445   000064 115007                    CMPA    52,DL
         8 003446   003453 601000 8                  TNZ     s:8353
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:186  

   8352  8 003447   040100 100400                    MLR     fill='040'O
         8 003450   000563 000006 2                  ADSC9   VLP_EDIT+84              cn=0,n=6
         8 003451   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003452   003464 710000 8                  TRA     s:8356

     1379     8353    2                 ELSE IF (VERIFY_TYPE = TXCMD) THEN TEMP_STR = 'VE TX ';

   8353  8 003453   000065 115007                    CMPA    53,DL
         8 003454   003464 601000 8                  TNZ     s:8356

   8353  8 003455   040100 100400                    MLR     fill='040'O
         8 003456   000565 000006 2                  ADSC9   VLP_EDIT+86              cn=0,n=6
         8 003457   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1380     8354    2           END;

   8354  8 003460   003464 710000 8                  TRA     s:8356

     1381     8355    1        ELSE TEMP_STR = 'VE OFF';

   8355  8 003461   040100 100400                    MLR     fill='040'O
         8 003462   000567 000006 2                  ADSC9   VLP_EDIT+88              cn=0,n=6
         8 003463   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1382     8356    1        CALL FILL_LINE (TEMP_STR,6);

   8356  8 003464   000173 236000 9                  LDQ     123
         8 003465   200144 756100                    STQ     @STR+1,,AUTO
         8 003466   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003467   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003470   004150 701000 8                  TSX1    FILL_LINE
         8 003471   000000 011000                    NOP     0

     1383     8357        /**/
     1384     8358
     1385     8359    1   ROUND: IF (~REPSTATUS(ROUNDCMD-FIRSTSTATUS)) THEN GOTO DONE;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:187  

   8359  8 003472   200113 236100       ROUND        LDQ     REPSTATUS+12,,AUTO
         8 003473   400000 376003                    ANQ     -131072,DU
         8 003474   400000 676003                    ERQ     -131072,DU
         8 003475   003516 601000 8                  TNZ     DONE

     1386     8360
     1387     8361        /* Display ROUND */
     1388     8362    1        IF (FLAGS.ROUNDFLAG) THEN TEMP_STR = 'ROUND ON ';

   8362  8 003476   000001 236000 xsym               LDQ     FLAGS+1
         8 003477   020000 316003                    CANQ    8192,DU
         8 003500   003505 600000 8                  TZE     s:8363

   8362  8 003501   040100 100400                    MLR     fill='040'O
         8 003502   000571 000011 2                  ADSC9   VLP_EDIT+90              cn=0,n=9
         8 003503   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80
         8 003504   003510 710000 8                  TRA     s:8364

     1389     8363    1        ELSE TEMP_STR = 'ROUND OFF';

   8363  8 003505   040100 100400                    MLR     fill='040'O
         8 003506   000574 000011 2                  ADSC9   VLP_EDIT+93              cn=0,n=9
         8 003507   200115 000120                    ADSC9   TEMP_STR,,AUTO           cn=0,n=80

     1390     8364    1        CALL FILL_LINE(TEMP_STR,9);

   8364  8 003510   000175 236000 9                  LDQ     125
         8 003511   200144 756100                    STQ     @STR+1,,AUTO
         8 003512   200115 630500                    EPPR0   TEMP_STR,,AUTO
         8 003513   200143 450500                    STP0    TEMP_STR+22,,AUTO
         8 003514   004150 701000 8                  TSX1    FILL_LINE
         8 003515   000000 011000                    NOP     0

   8362  8 003516                       DONE         null
     1391     8365        /**/
     1392     8366
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:188  
     1393     8367    1   DONE: ;
     1394     8368    1        IF LINELEN > 0 THEN

   8368  8 003516   200114 235100                    LDA     LINELEN,,AUTO
         8 003517   003524 604400 8                  TMOZ    s:8370

     1395     8369    1           CALL VEX$TYPE_REC(TYPECR);

   8369  8 003520   000003 630400 9                  EPPR0   3
         8 003521   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 003522   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 003523   000000 011000                    NOP     0

     1396     8370    1        RETURN;

   8370  8 003524   000000 702200 xent               TSX2  ! X66_ARET

     1397     8371        %EJECT ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:189  
     1398     8372        /**/
     1399     8373    1   VEF$EXEC_DIR: ENTRY ;

   8373  8 003525   000000 700200 xent  VEF$EXEC_DIR TSX0  ! X66_AUTO_0
         8 003526   000152 000000                    ZERO    106,0

     1400     8374        /**/
     1401     8375    2        DO CASE( CMD$ -> DIR_CMD_TBL.CODE ) ;

   8375  8 003527   000000 470400 xsym               LDP0    CMD$
         8 003530   000001 235100                    LDA     1,,PR0
         8 003531   000021 135007                    SBLA    17,DL
         8 003532   000003 115007                    CMPA    3,DL
         8 003533   003535 602005 8                  TNC     s:8375+6,AL
         8 003534   003647 710000 8                  TRA     s:8409
         8 003535   003540 710000 8                  TRA     s:8379
         8 003536   003624 710000 8                  TRA     s:8399
         8 003537   003613 710000 8                  TRA     s:8393

     1402     8376        /**/
     1403     8377    2        CASE( DIRCMD ) ;

     1404     8378        /**/
     1405     8379    2           TYPE_BUF.TEXT = '   DIRECTORY: ' ;

   8379  8 003540   040000 100400                    MLR     fill='040'O
         8 003541   000577 000016 2                  ADSC9   VLP_EDIT+96              cn=0,n=14
         8 003542   000000 202104 xsym               ADSC9   TYPE_BUF                 cn=1,n=1092

     1406     8380    2           CALL INDEX(I,' ',B$JIT.FPSN) ;

   8380  8 003543   000000 471400 xsym               LDP1    B$JIT$
         8 003544   000000 124500                    SCM     mask='000'O
         8 003545   100021 000006                    ADSC9   17,,PR1                  cn=0,n=6
         8 003546   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 003547   000000 000000 xsym               ARG     I

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:190  
     1407     8381    2           IF I > 0 THEN                   /* Insert PSN.                        */

   8381  8 003550   000000 235000 xsym               LDA     I
         8 003551   003564 600000 8                  TZE     s:8386

     1408     8382    3           DO ;

     1409     8383    3              CALL INSERT(TYPE_BUF.TEXT,14,,'DP#',B$JIT.FPSN) ;

   8383  8 003552   040000 100400                    MLR     fill='040'O
         8 003553   000466 000003 2                  ADSC9   VLP_EDIT+23              cn=0,n=3
         8 003554   000003 600003 xsym               ADSC9   TYPE_BUF+3               cn=3,n=3
         8 003555   040000 100500                    MLR     fill='040'O
         8 003556   100021 000006                    ADSC9   17,,PR1                  cn=0,n=6
         8 003557   000004 402063 xsym               ADSC9   TYPE_BUF+4               cn=2,n=1075

     1410     8384    3              I = 14 + I + 3 ;

   8384  8 003560   000000 235000 xsym               LDA     I
         8 003561   000021 035007                    ADLA    17,DL
         8 003562   000000 755000 xsym               STA     I

     1411     8385    3              END ;                        /* THEN DO                            */

   8385  8 003563   003566 710000 8                  TRA     s:8388

     1412     8386    2           ELSE I = 14 ;

   8386  8 003564   000016 236007                    LDQ     14,DL
         8 003565   000000 756000 xsym               STQ     I

     1413     8387                                                /* Insert ACCOUNT.                    */
     1414     8388    2           CALL INSERT( TYPE_BUF.TEXT,I,,'.',B$JIT.FACCN ) ;

   8388  8 003566   000000 720000 xsym               LXL0    I
         8 003567   775673 620010                    EAX0    -1093,X0
         8 003570   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:191  
         8 003571   000000 235000 xsym               LDA     I
         8 003572   040045 100400                    MLR     fill='040'O
         8 003573   000170 000001 9                  ADSC9   120                      cn=0,n=1
         8 003574   000000 200010 xsym               ADSC9   TYPE_BUF,A               cn=1,n=*X0
         8 003575   000000 236000 xsym               LDQ     I
         8 003576   002103 116007                    CMPQ    1091,DL
         8 003577   003606 603000 8                  TRC     s:8389
         8 003600   775674 621006                    EAX1    -1092,QL
         8 003601   777777 661003                    ERX1    -1,DU
         8 003602   000000 470400 xsym               LDP0    B$JIT$
         8 003603   040046 100500                    MLR     fill='040'O
         8 003604   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         8 003605   000000 400011 xsym               ADSC9   TYPE_BUF,Q               cn=2,n=*X1

     1415     8389    2           CALL VEX$TYPE_REC(TYPECR) ;

   8389  8 003606   000003 630400 9                  EPPR0   3
         8 003607   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 003610   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 003611   000000 011000                    NOP     0
         8 003612   003647 710000 8                  TRA     s:8409

     1416     8390        /**/
     1417     8391    2        CASE( PC_RESET ) ;                 /* 'DIR R'                            */

     1418     8392        /**/
     1419     8393    2           FPT_SETFMA.ACCT_ = VECTOR(NIL) ;

   8393  8 003613   000042 237000 9                  LDAQ    34
         8 003614   000300 757000 1                  STAQ    FPT_SETFMA

     1420     8394    2           FPT_SETFMA.PSN_ = VECTOR(NIL) ;

   8394  8 003615   000042 237000 9                  LDAQ    34
         8 003616   000302 757000 1                  STAQ    FPT_SETFMA+2

     1421     8395    2           CALL M$SETFMA(FPT_SETFMA) ALTRET(SETFMA_ERR) ;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:192  

   8395  8 003617   000300 630400 1                  EPPR0   FPT_SETFMA
         8 003620   460001 713400                    CLIMB   alt,+24577
         8 003621   400400 401760                    pmme    nvectors=2
         8 003622   003650 702000 8                  TSX2    SETFMA_ERR
         8 003623   003647 710000 8                  TRA     s:8409

     1422     8396        /**/
     1423     8397    2        CASE( PC_FID ) ;                   /* 'DIR fid'                          */

     1424     8398        /**/
     1425     8399    2           FPT_SETFMA.ACCT_ = VECTOR(CMD$ -> DIR_CMD_TBL.ACCT) ;

   8399  8 003624   000176 235000 9                  LDA     126
         8 003625   000000 236000 xsym               LDQ     CMD$
         8 003626   000002 036003                    ADLQ    2,DU
         8 003627   000300 757000 1                  STAQ    FPT_SETFMA

     1426     8400    2           IF CMD$ -> DIR_CMD_TBL.PSN ~= ' '

   8400  8 003630   040000 106500                    CMPC    fill='040'O
         8 003631   000004 000006                    ADSC9   4,,PR0                   cn=0,n=6
         8 003632   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 003633   003641 600000 8                  TZE     s:8404

     1427     8401    2           THEN                            /* PSN given.                         */
     1428     8402    2              FPT_SETFMA.PSN_ = VECTOR(CMD$ -> DIR_CMD_TBL.PSN) ;

   8402  8 003634   000177 235000 9                  LDA     127
         8 003635   000000 236000 xsym               LDQ     CMD$
         8 003636   000004 036003                    ADLQ    4,DU
         8 003637   000302 757000 1                  STAQ    FPT_SETFMA+2
         8 003640   003643 710000 8                  TRA     s:8405

     1429     8403    2           ELSE                            /* No PSN given.                      */
     1430     8404    2              FPT_SETFMA.PSN_ = VECTOR(NIL) ;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:193  
   8404  8 003641   000042 237000 9                  LDAQ    34
         8 003642   000302 757000 1                  STAQ    FPT_SETFMA+2

     1431     8405    2           CALL M$SETFMA(FPT_SETFMA) ALTRET(SETFMA_ERR) ;

   8405  8 003643   000300 630400 1                  EPPR0   FPT_SETFMA
         8 003644   460001 713400                    CLIMB   alt,+24577
         8 003645   400400 401760                    pmme    nvectors=2
         8 003646   003650 702000 8                  TSX2    SETFMA_ERR

     1432     8406        /**/
     1433     8407    2        END ;                              /* DO CASE                            */

     1434     8408        /**/
     1435     8409    1        RETURN ;

   8409  8 003647   000000 702200 xent               TSX2  ! X66_ARET

     1436     8410        /**/
     1437     8411    1   SETFMA_ERR:
     1438     8412    1        CALL VEX$ERROR(E$E_BADDIR,1) ;

   8412  8 003650   000201 630400 9     SETFMA_ERR   EPPR0   129
         8 003651   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 003652   000000 701000 xent               TSX1    VEX$ERROR
         8 003653   000000 011000                    NOP     0

     1439     8413    1        RETURN ;

   8413  8 003654   000000 702200 xent               TSX2  ! X66_ARET

     1440     8414        /**/
     1441     8415        /*E*     ERROR:    VEE-E$E_BADDIR-0
     1442     8416                 DESCRIPTION: The user has input more than just [DP#SN].ACCOUNT
     1443     8417                              for the fid of the DIRECTORY command.
     1444     8418        */
     1445     8419        /**/
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:194  
     1446     8420    1   INSERT_STRING: PROC ALTRET;

   8420  8 003655   200142 741300       INSERT_STRI* STX1  ! TEMP_STR+21,,AUTO

     1447     8421        /**/
     1448     8422    3        DO TEMP_COUNT = 0 TO SSE_PARAM.PTR$ -> STR$PARAM.COUNT - 1;

   8422  8 003656   000000 450000 xsym               STZ     TEMP_COUNT
         8 003657   003775 710000 8                  TRA     s:8443+3

     1449     8423    4           IF (SSE_PARAM.PTR$ -> STR$PARAM.STR.QM(TEMP_COUNT)) THEN DO;

   8423  8 003660   000000 235000 xsym               LDA     TEMP_COUNT
         8 003661   000001 735000                    ALS     1
         8 003662   000001 470400 xsym               LDP0    SSE_PARAM+1
         8 003663   000001 234105                    SZN     1,AL,PR0
         8 003664   003713 605000 8                  TPL     s:8434

     1450     8424    4              CALL INSERT(TYPE_BUF.TEXT,I,1,'?') ALTRET(IS_ALT);

   8424  8 003665   000000 236000 xsym               LDQ     I
         8 003666   040006 100400                    MLR     fill='040'O
         8 003667   000203 000001 9                  ADSC9   131                      cn=0,n=1
         8 003670   000000 200001 xsym               ADSC9   TYPE_BUF,Q               cn=1,n=1

     1451     8425    4              I = I+1;

   8425  8 003671   000001 036007                    ADLQ    1,DL
         8 003672   000000 756000 xsym               STQ     I

     1452     8426    4              TEMP_CLMN = SSE_PARAM.PTR$ -> STR$PARAM.STR.QMCOUNT(TEMP_COUNT);

   8426  8 003673   000001 236105                    LDQ     1,AL,PR0
         8 003674   777777 376007                    ANQ     -1,DL
         8 003675   000000 756000 xsym               STQ     TEMP_CLMN

     1453     8427    5              IF (TEMP_CLMN ~= 0) THEN DO;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:195  

   8427  8 003676   003772 600000 8                  TZE     s:8443

     1454     8428    5                 CALL BINCHAR(SUBSTR(TEMP_BUF,0,1),TEMP_CLMN);

   8428  8 003677   000000 235003                    LDA     0,DU
         8 003700   200146 757100                    STAQ    LENGTH+1,,AUTO
         8 003701   000000 301500                    BTD
         8 003702   200146 000010                    NDSC9   LENGTH+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         8 003703   000000 030001 xsym               NDSC9   TEMP_BUF                 cn=0,s=nosgn,sf=0,n=1

     1455     8429    5                 CALL INSERT(TYPE_BUF.TEXT,I,1,SUBSTR(TEMP_BUF,0,1)) ALTRET(IS_ALT);

   8429  8 003704   000000 236000 xsym               LDQ     I
         8 003705   040006 100400                    MLR     fill='040'O
         8 003706   000000 000001 xsym               ADSC9   TEMP_BUF                 cn=0,n=1
         8 003707   000000 200001 xsym               ADSC9   TYPE_BUF,Q               cn=1,n=1

     1456     8430    5                 I = I+1;

   8430  8 003710   000001 036007                    ADLQ    1,DL
         8 003711   000000 756000 xsym               STQ     I

     1457     8431    5                 END;

     1458     8432    4              END;

   8432  8 003712   003772 710000 8                  TRA     s:8443

     1459     8433    4           ELSE DO;

     1460     8434    4              CALL INSERT(TYPE_BUF.TEXT,I,SSE_PARAM.PTR$ ->

   8434  8 003713   000002 471505                    LDP1    2,AL,PR0
         8 003714   100000 236100                    LDQ     0,,PR1
         8 003715   000033 772000                    QRL     27
         8 003716   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:196  
         8 003717   100000 236100                    LDQ     0,,PR1
         8 003720   000033 772000                    QRL     27
         8 003721   000002 621006                    EAX1    2,QL
         8 003722   000000 235000 xsym               LDA     I
         8 003723   040045 100400                    MLR     fill='040'O
         8 003724   000204 000001 9                  ADSC9   132                      cn=0,n=1
         8 003725   000000 200011 xsym               ADSC9   TYPE_BUF,A               cn=1,n=*X1
         8 003726   000000 636011                    EAQ     0,X1
         8 003727   000022 772000                    QRL     18
         8 003730   000002 116007                    CMPQ    2,DL
         8 003731   004003 602000 8                  TNC     IS_ALT
         8 003732   777777 622011                    EAX2    -1,X1
         8 003733   040045 100540                    MLR     fill='040'O
         8 003734   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         8 003735   000000 400012 xsym               ADSC9   TYPE_BUF,A               cn=2,n=*X2
         8 003736   000000 636010                    EAQ     0,X0
         8 003737   000022 772000                    QRL     18
         8 003740   200146 756100                    STQ     LENGTH+1,,AUTO
         8 003741   000000 636011                    EAQ     0,X1
         8 003742   000022 772000                    QRL     18
         8 003743   200146 136100                    SBLQ    LENGTH+1,,AUTO
         8 003744   000001 116007                    CMPQ    1,DL
         8 003745   004003 604400 8                  TMOZ    IS_ALT
         8 003746   200147 756100                    STQ     LENGTH+2,,AUTO
         8 003747   000000 636010                    EAQ     0,X0
         8 003750   000022 772000                    QRL     18
         8 003751   000000 036000 xsym               ADLQ    I
         8 003752   200147 720100                    LXL0    LENGTH+2,,AUTO
         8 003753   777777 621010                    EAX1    -1,X0
         8 003754   040046 100400                    MLR     fill='040'O
         8 003755   000204 000001 9                  ADSC9   132                      cn=0,n=1
         8 003756   000000 400011 xsym               ADSC9   TYPE_BUF,Q               cn=2,n=*X1
         8 003757   200147 236100                    LDQ     LENGTH+2,,AUTO
         8 003760   000002 116007                    CMPQ    2,DL
         8 003761   004003 604000 8                  TMI     IS_ALT

     1461     8435    4                 STR$PARAM.STR.PTR$(TEMP_COUNT) -> STR$BUF.COUNT + 2,'/',
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:197  
     1462     8436    4                 SUBSTR(SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(TEMP_COUNT) ->
     1463     8437    4                 STR$BUF.TEXT,0,SSE_PARAM.PTR$ ->
     1464     8438    4                 STR$PARAM.STR.PTR$(TEMP_COUNT) -> STR$BUF.COUNT),'/')
     1465     8439    4                 ALTRET (IS_ALT);
     1466     8440    4              I = I + 2 + SSE_PARAM.PTR$ -> STR$PARAM.STR.PTR$(TEMP_COUNT)

   8440  8 003762   000000 236000 xsym               LDQ     TEMP_COUNT
         8 003763   000001 736000                    QLS     1
         8 003764   000002 471506                    LDP1    2,QL,PR0
         8 003765   100000 236100                    LDQ     0,,PR1
         8 003766   000033 772000                    QRL     27
         8 003767   000000 036000 xsym               ADLQ    I
         8 003770   000002 036007                    ADLQ    2,DL
         8 003771   000000 756000 xsym               STQ     I

     1467     8441    4                 -> STR$BUF.COUNT;
     1468     8442    4              END;

     1469     8443    3           END;

   8443  8 003772   000000 235000 xsym               LDA     TEMP_COUNT
         8 003773   000001 035007                    ADLA    1,DL
         8 003774   000000 755000 xsym               STA     TEMP_COUNT
         8 003775   000001 470400 xsym               LDP0    SSE_PARAM+1
         8 003776   000000 236000 xsym               LDQ     TEMP_COUNT
         8 003777   000000 116100                    CMPQ    0,,PR0
         8 004000   003660 602000 8                  TNC     s:8423

     1470     8444    2        RETURN;

   8444  8 004001   200142 221300                    LDX1  ! TEMP_STR+21,,AUTO
         8 004002   000001 702211                    TSX2  ! 1,X1

     1471     8445        /**/
     1472     8446    2   IS_ALT:
     1473     8447    2        ALTRETURN;

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:198  
   8447  8 004003   200142 221300       IS_ALT       LDX1  ! TEMP_STR+21,,AUTO
         8 004004   000000 702211                    TSX2  ! 0,X1

     1474     8448    2   END;
     1475     8449        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:199  
     1476     8450        /**/
     1477     8451    1   VEF$EXEC_TA: ENTRY;

   8451  8 004005   000000 700200 xent  VEF$EXEC_TA  TSX0  ! X66_AUTO_0
         8 004006   000152 000000                    ZERO    106,0

     1478     8452    1        TAB_VLP = FALSE;

   8452  8 004007   000000 100400                    MLR     fill='000'O
         8 004010   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         8 004011   000000 000040 xsym               ADSC9   TAB_VLP                  cn=0,n=32

     1479     8453        /**/
     1480     8454    2        DO I = 0 TO NUM_TABS-1;

   8454  8 004012   000000 450000 xsym               STZ     I
         8 004013   004023 710000 8                  TRA     s:8456+2

     1481     8455    2           TAB_VLP.TABS#(I) = CMD$ -> TA_CMD_TBL.TABS(I);

   8455  8 004014   000000 470400 xsym               LDP0    CMD$
         8 004015   000000 235000 xsym               LDA     I
         8 004016   000005 100505                    MLR     fill='000'O
         8 004017   000001 000001                    ADSC9   1,A,PR0                  cn=0,n=1
         8 004020   000000 200001 xsym               ADSC9   TAB_VLP,A                cn=1,n=1

     1482     8456    2           END;

   8456  8 004021   000001 035007                    ADLA    1,DL
         8 004022   000000 755000 xsym               STA     I
         8 004023   000000 236000 xsym               LDQ     I
         8 004024   000000 116000 xsym               CMPQ    NUM_TABS
         8 004025   004014 602000 8                  TNC     s:8455

     1483     8457        /**/
     1484     8458    1        CALL M$DEVICE(TAB_FPT);

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:200  
   8458  8 004026   000374 630400 2                  EPPR0   TAB_FPT
         8 004027   050006 713400                    CLIMB   20486
         8 004030   401000 401760                    pmme    nvectors=3

     1485     8459    1        RETURN;

   8459  8 004031   000000 702200 xent               TSX2  ! X66_ARET

     1486     8460        /**/
     1487     8461        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:201  
     1488     8462        /**/
     1489     8463    1   VEF$EXEC_TABC: ENTRY;

   8463  8 004032   000000 700200 xent  VEF$EXEC_TA* TSX0  ! X66_AUTO_0
         8 004033   000152 000000                    ZERO    106,0

     1490     8464        /**/
     1491     8465    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.TABCFLAG = TRUE;

   8465  8 004034   000000 470400 xsym               LDP0    CMD$
         8 004035   040000 106500                    CMPC    fill='040'O
         8 004036   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         8 004037   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
         8 004040   004044 601000 8                  TNZ     s:8466

   8465  8 004041   000001 236003                    LDQ     1,DU
         8 004042   000000 256000 xsym               ORSQ    FLAGS
         8 004043   004046 710000 8                  TRA     s:8468

     1492     8466    1        ELSE FLAGS.TABCFLAG = FALSE;

   8466  8 004044   000205 236000 9                  LDQ     133
         8 004045   000000 356000 xsym               ANSQ    FLAGS

     1493     8467        /**/
     1494     8468    1        CALL M$GTRMTAB(TAB_FPT);

   8468  8 004046   000374 630400 2                  EPPR0   TAB_FPT
         8 004047   160012 713400                    CLIMB   57354
         8 004050   401000 401760                    pmme    nvectors=3

     1495     8469    1        NUM_TABS = 0;

   8469  8 004051   000000 450000 xsym               STZ     NUM_TABS

     1496     8470    2        DO WHILE ((TAB_VLP.TABS#(NUM_TABS) ~= 0)AND(NUM_TABS <= 30));

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:202  
   8470  8 004052   004056 710000 8                  TRA     s:8472

     1497     8471    2           NUM_TABS = NUM_TABS + 1;

   8471  8 004053   000000 235000 xsym               LDA     NUM_TABS
         8 004054   000001 035007                    ADLA    1,DL
         8 004055   000000 755000 xsym               STA     NUM_TABS

     1498     8472    2           END;

   8472  8 004056   000000 235000 xsym               LDA     NUM_TABS
         8 004057   000100 101405                    MRL     fill='000'O
         8 004060   000000 200001 xsym               ADSC9   TAB_VLP,A                cn=1,n=1
         8 004061   200146 000004                    ADSC9   LENGTH+1,,AUTO           cn=0,n=4
         8 004062   200146 236100                    LDQ     LENGTH+1,,AUTO
         8 004063   000000 116003                    CMPQ    0,DU
         8 004064   004067 600000 8                  TZE     s:8473
         8 004065   000037 115007                    CMPA    31,DL
         8 004066   004053 602000 8                  TNC     s:8471

     1499     8473    1        RETURN;

   8473  8 004067   000000 702200 xent               TSX2  ! X66_ARET

     1500     8474        /**/
     1501     8475        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:203  
     1502     8476        /**/
     1503     8477    1   VEF$EXEC_TABX: ENTRY;

   8477  8 004070   000000 700200 xent  VEF$EXEC_TA* TSX0  ! X66_AUTO_0
         8 004071   000152 000000                    ZERO    106,0

     1504     8478        /**/
     1505     8479    1        IF (CMD$ -> BP_CMD_TBL.TEXT = 'ON') THEN FLAGS.TABXFLAG = TRUE;

   8479  8 004072   000000 470400 xsym               LDP0    CMD$
         8 004073   040000 106500                    CMPC    fill='040'O
         8 004074   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         8 004075   000441 000002 2                  ADSC9   VLP_EDIT+2               cn=0,n=2
         8 004076   004102 601000 8                  TNZ     s:8480

   8479  8 004077   000100 236003                    LDQ     64,DU
         8 004100   000000 256000 xsym               ORSQ    FLAGS
         8 004101   004104 710000 8                  TRA     s:8482

     1506     8480    1        ELSE FLAGS.TABXFLAG = FALSE;

   8480  8 004102   000206 236000 9                  LDQ     134
         8 004103   000000 356000 xsym               ANSQ    FLAGS

     1507     8481        /**/
     1508     8482    1        CALL M$GTRMTAB(TAB_FPT);

   8482  8 004104   000374 630400 2                  EPPR0   TAB_FPT
         8 004105   160012 713400                    CLIMB   57354
         8 004106   401000 401760                    pmme    nvectors=3

     1509     8483    1        NUM_TABS = 0;

   8483  8 004107   000000 450000 xsym               STZ     NUM_TABS

     1510     8484    2        DO WHILE ((TAB_VLP.TABS#(NUM_TABS) ~= 0)AND(NUM_TABS <= 30));

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:204  
   8484  8 004110   004114 710000 8                  TRA     s:8486

     1511     8485    2           NUM_TABS = NUM_TABS + 1;

   8485  8 004111   000000 235000 xsym               LDA     NUM_TABS
         8 004112   000001 035007                    ADLA    1,DL
         8 004113   000000 755000 xsym               STA     NUM_TABS

     1512     8486    2           END;

   8486  8 004114   000000 235000 xsym               LDA     NUM_TABS
         8 004115   000100 101405                    MRL     fill='000'O
         8 004116   000000 200001 xsym               ADSC9   TAB_VLP,A                cn=1,n=1
         8 004117   200146 000004                    ADSC9   LENGTH+1,,AUTO           cn=0,n=4
         8 004120   200146 236100                    LDQ     LENGTH+1,,AUTO
         8 004121   000000 116003                    CMPQ    0,DU
         8 004122   004125 600000 8                  TZE     s:8487
         8 004123   000037 115007                    CMPA    31,DL
         8 004124   004111 602000 8                  TNC     s:8485

     1513     8487    1        RETURN;

   8487  8 004125   000000 702200 xent               TSX2  ! X66_ARET

     1514     8488        /**/
     1515     8489        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:205  
     1516     8490        /**/
     1517     8491    1   VEF$EXEC_TYPE: ENTRY;

   8491  8 004126   000000 700200 xent  VEF$EXEC_TY* TSX0  ! X66_AUTO_0
         8 004127   000152 000000                    ZERO    106,0

     1518     8492        /**/
     1519     8493    1        TYPE_CODE = CMD$ -> TYPE_CMD_TBL.CODE;

   8493  8 004130   000000 470400 xsym               LDP0    CMD$
         8 004131   000001 220100                    LDX0    1,,PR0
         8 004132   000000 740000 xsym               STX0    TYPE_CODE

     1520     8494    1        RETURN;

   8494  8 004133   000000 702200 xent               TSX2  ! X66_ARET

     1521     8495        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:206  
     1522     8496        /**/
     1523     8497    1   VEF$EXEC_VE: ENTRY;

   8497  8 004134   000000 700200 xent  VEF$EXEC_VE  TSX0  ! X66_AUTO_0
         8 004135   000152 000000                    ZERO    106,0

     1524     8498        /**/
     1525     8499    1        VERIFY_TYPE = CMD$ -> VE_CMD_TBL.TYPE;

   8499  8 004136   000000 470400 xsym               LDP0    CMD$
         8 004137   000001 235100                    LDA     1,,PR0
         8 004140   000000 755000 xsym               STA     VERIFY_TYPE

     1526     8500        /**/
     1527     8501    1        IF (VERIFY_TYPE = 0) THEN FLAGS.VERIFY = FALSE;

   8501  8 004141   004145 601000 8                  TNZ     s:8502

   8501  8 004142   000207 236000 9                  LDQ     135
         8 004143   000000 356000 xsym               ANSQ    FLAGS
         8 004144   004147 710000 8                  TRA     s:8503

     1528     8502    1        ELSE FLAGS.VERIFY = TRUE;

   8502  8 004145   010000 236007                    LDQ     4096,DL
         8 004146   000000 256000 xsym               ORSQ    FLAGS

     1529     8503    1        RETURN;

   8503  8 004147   000000 702200 xent               TSX2  ! X66_ARET

     1530     8504        %EJECT;
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:207  
     1531     8505        /**/
     1532     8506    1   FILL_LINE: PROC (STR,PARM);

   8506  8 004150   200142 741300       FILL_LINE    STX1  ! TEMP_STR+21,,AUTO

     1533     8507
     1534     8508    2   DCL STR CHAR(80);
     1535     8509    2   DCL PARM  SBIN;
     1536     8510    2   DCL LENGTH SBIN;
     1537     8511
     1538     8512    2        LENGTH =            PARM;/* PARM may be a CONSTANT, so change it to AUTO */

   8512  8 004151   200144 470500                    LDP0    @PARM,,AUTO
         8 004152   000000 235100                    LDA     0,,PR0
         8 004153   200145 755100                    STA     LENGTH,,AUTO

     1539     8513
     1540     8514    3        DO WHILE (SUBSTR(STR,LENGTH-1,1) = ' ') ;/* Delete Trailing blank */

   8514  8 004154   004157 710000 8                  TRA     s:8516

     1541     8515    3           LENGTH = LENGTH - 1;

   8515  8 004155   000001 336007                    LCQ     1,DL
         8 004156   200145 056100                    ASQ     LENGTH,,AUTO

     1542     8516    3           END;

   8516  8 004157   200143 470500                    LDP0    @STR,,AUTO
         8 004160   200145 235100                    LDA     LENGTH,,AUTO
         8 004161   040000 106505                    CMPC    fill='040'O
         8 004162   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         8 004163   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         8 004164   004155 600000 8                  TZE     s:8515

     1543     8517
     1544     8518    3        IF LINELEN > 75 THEN DO;           /* PRINT LINE */
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:208  

   8518  8 004165   200114 236100                    LDQ     LINELEN,,AUTO
         8 004166   000113 116007                    CMPQ    75,DL
         8 004167   004176 604400 8                  TMOZ    s:8522

     1545     8519    3           CALL VEX$TYPE_REC(TYPECR);

   8519  8 004170   000003 630400 9                  EPPR0   3
         8 004171   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 004172   000000 701000 xent               TSX1    VEX$TYPE_REC
         8 004173   000000 011000                    NOP     0

     1546     8520    3           LINELEN = 0;

   8520  8 004174   200114 450100                    STZ     LINELEN,,AUTO

     1547     8521    3           END;

   8521  8 004175   004207 710000 8                  TRA     s:8527

     1548     8522    3        ELSE IF LINELEN > 0 THEN DO;

   8522  8 004176   000000 116003                    CMPQ    0,DU
         8 004177   004207 604400 8                  TMOZ    s:8527

     1549     8523    3              CALL INSERT (TYPE_BUF.TEXT,LINELEN,,',  ');

   8523  8 004200   775673 620006                    EAX0    -1093,QL
         8 004201   777777 660003                    ERX0    -1,DU
         8 004202   040046 100400                    MLR     fill='040'O
         8 004203   000603 000003 2                  ADSC9   VLP_EDIT+100             cn=0,n=3
         8 004204   000000 200010 xsym               ADSC9   TYPE_BUF,Q               cn=1,n=*X0

     1550     8524    3              LINELEN = LINELEN + 3;

   8524  8 004205   000003 236007                    LDQ     3,DL
         8 004206   200114 056100                    ASQ     LINELEN,,AUTO
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:209  

     1551     8525    3              END;

     1552     8526
     1553     8527    2        CALL INSERT (TYPE_BUF.TEXT,LINELEN,,SUBSTR(STR,0,LENGTH)) ;

   8527  8 004207   200114 720100                    LXL0    LINELEN,,AUTO
         8 004210   775673 620010                    EAX0    -1093,X0
         8 004211   777777 660003                    ERX0    -1,DU
         8 004212   200143 470500                    LDP0    @STR,,AUTO
         8 004213   200145 721100                    LXL1    LENGTH,,AUTO
         8 004214   200114 235100                    LDA     LINELEN,,AUTO
         8 004215   040045 100540                    MLR     fill='040'O
         8 004216   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         8 004217   000000 200010 xsym               ADSC9   TYPE_BUF,A               cn=1,n=*X0

     1554     8528    2        LINELEN = LINELEN + LENGTH ;

   8528  8 004220   200114 236100                    LDQ     LINELEN,,AUTO
         8 004221   200145 036100                    ADLQ    LENGTH,,AUTO
         8 004222   200114 756100                    STQ     LINELEN,,AUTO

     1555     8529    2        RETURN;

   8529  8 004223   200142 221300                    LDX1  ! TEMP_STR+21,,AUTO
         8 004224   000001 702211                    TSX2  ! 1,X1
     1556     8530    2   END FILL_LINE;
     1557     8531    1   END;                                    /* END VEF$FILCMD                     */

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:210  
--  Include file information  --

   VE_FLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEF$FILCMD.
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:211  

 **** Variables and constants ****

  ****  Section 001  Data  VEF$FILCMD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   222-0-0/d STRC(1080)  r     1 CLOSE2DFLT_FPT           164-0-0/d STRC(1080)  r     1 CLOSE2_FPT
   276-0-0/d STRC(72)    r     1 DS_RESULTS               300-0-0/d STRC(144)   r     1 FPT_SETFMA
    72-0-0/d STRC(2088)  r     1 OPEN_FILE2_FPT             0-0-0/d STRC(2088)  r     1 OPEN_FILE_FPT
   260-0-0/d STRC(504)   r     1 READ_SEQUEN2_FPT         304-0-0/d STRC(2052)  r     1 XUH_PARAM

  ****  Section 002 RoData VEF$FILCMD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   230-0-0/d STRC(1080)  r     1 CLOSE2REL_FPT            134-0-0/d STRC(1080)  r     1 CLOSEDFLT_FPT
   172-0-0/d STRC(1080)  r     1 CLOSEREL_FPT             324-0-0/d STRC(1080)  r     1 CLOSE_DO_FPT
    76-0-0/d STRC(1080)  r     1 CLOSE_FPT                266-0-0/d STRC(1080)  r     1 CLOSE_ME_FPT
   366-0-0/d STRC(216)   r     1 COPYDS_FPT                 4-0-0/d STRC(2088)  r     1 DELETE_FPT_C
   362-0-0/d STRC(144)   r     1 PFIL_FPT                 374-0-0/d STRC(360)   r     1 TAB_FPT
     0-0-0/d STRC(144)   r     1 TRUNC_FPT                406-0-0/d STRC(792)   r     1 UNFID_FPT
   437-0-0/c STRC(45)    r     1 VLP_EDIT                 434-0-0/c STRC(90)    r     1 VLP_ERROR_SYN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   144-0-0/w PTR         r     1 @PARM                    143-0-0/w PTR         r     1 @STR
     4-0-0/d STRC(2088)  r     1 DELETE_FPT               145-0-0/w SBIN        r     1 LENGTH
   114-0-0/w SBIN        r     1 LINELEN                   *0-0-0/w SBIN        r     1 PARM
    77-0-0/w BIT         r     1 REPSTATUS(0:12)
    76-0-0/w SBIN        r     1 STATUS_FIELDS             *0-0-0/c CHAR(80)    r     1 STR
   115-0-0/c CHAR(80)    r     1 TEMP_STR

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:212  
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 CMD$                       0-0-0/c CHAR(256)   r     1 CMD_BUF
     0-0-0/w UBIN        r     1 CMD_CODE                   0-0-0/w PTR         r     1 COPYDS_PTR$
     0-0-0/c CHAR(8)     r     1 CURR_FILE_ACCT             0-0-0/c STRC(288)   r     1 CURR_FILE_NAME
     0-0-0/c CHAR(8)     r     1 CURR_FILE_PASS             0-0-0/w STRC(90)    r     1 CURR_FILE_SN
     0-0-0/b BIT         r     1 DVBYTE                     0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w UBIN        r     1 EXEC_SEQNUM                0-0-0/b STRC(72)    r     1 FLAGS
     0-0-0/w UBIN        r     1 HI_EXEC_CLMN               0-0-0/w UBIN        r     1 HI_SEQNUM
     0-0-0/w UBIN        r     1 HI_SRCH_CLMN               0-0-0/w UBIN        r     1 I
     0-0-0/w UBIN        r     1 INCR                       0-0-0/w UBIN        r     1 LAST_KEY
     0-0-0/w UBIN        r     1 LIMIT_SEQNUM               0-0-0/w UBIN        r     1 LO_EXEC_CLMN
     0-0-0/w UBIN        r     1 LO_SEQNUM                  0-0-0/w UBIN        r     1 LO_SRCH_CLMN
     0-0-0/w PTR         r     1 M$FILE$                    0-0-0/w PTR         r     1 M$FILE2$
     0-0-0/w UBIN        r     1 M$FILE2_NUM                0-0-0/w UBIN        r     1 M$FILE_NUM
     0-0-0/w UBIN        r     1 MAX_SEQNUM                 0-0-0/w UBIN        r     1 NUM_TABS
     0-0-0/c CHAR(8)     r     1 OPEN_FILE_ACCT             0-0-0/c STRC(288)   r     1 OPEN_FILE_NAME
     0-0-0/c CHAR(8)     r     1 OPEN_FILE_PASS             0-0-0/w STRC(90)    r     1 OPEN_FILE_SN
     0-0-0/w PTR         r     1 P$                         0-0-0/w STRC(180)   r     1 P_ALLCMDS
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/w UBIN        r     1 READ_KEY
     0-0-0/c CHAR(1024)  r     1 REC_BUF                    0-0-0/w UBIN        r     1 REC_COUNT
     0-0-0/w UBIN        r     1 REC_SIZE                   0-0-0/w UBIN        r     1 RP_REC_SIZE
     0-0-0/w UBIN        r     1 SAVE_KEY                   0-0-0/w STRC(288)   r     1 SAVE_TAB_VLP
     0-0-0/c CHAR(9)     r     1 SEQ_TEXT_BUF               0-0-0/w PTR         r     1 SSE$
     0-0-0/w PTR         r     1 SSE_INIT$                  0-0-0/b STRC(72)    r     1 SSE_PARAM
     0-0-0/c STRC(288)   r     1 SUB_BUF_1                  0-0-0/w STRC(288)   r     1 TAB_VLP
     0-0-0/c CHAR(1024)  r     1 TEMP_BUF                   0-0-0/w UBIN        r     1 TEMP_CLMN
     0-0-0/w UBIN        r     1 TEMP_COUNT                 0-0-0/c STRC(9837)  r     1 TYPE_BUF
     0-0-0/c CHAR(2)     r     1 TYPE_CODE                  0-0-0/w UBIN        r     1 VERIFY_TYPE
     0-0-0/w UBIN        r     1 Y003

  ****  BASED and DCB variables  ****

PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:213  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(72)    r     1 BP_CMD_TBL
     0-0-0/w STRC(162)   r     1 B_CMD_TBL                  0-0-0/w STRC(234)   r     1 C_CMD_TBL
     0-0-0/w STRC(198)   r     1 DIR_CMD_TBL                0-0-0/w STRC(72)    r     1 ED_CMD_TBL
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$FILE                     0-0-0N  NULL        r     1 M$FILE2
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(324)   r     1 M_CMD_TBL                  0-0-0/w STRC(72)    r     1 SSE$PARAM
     0-0-0/w STRC(2304)  r     1 STR$BUF                    0-0-0/w STRC(108)   r     1 STR$PARAM
     0-0-0/w STRC(324)   r     1 TA_CMD_TBL                 0-0-0/w STRC(54)    r     1 TYPE_CMD_TBL
     0-0-0/w ASTR(9)     r     1 VARY$STRC                  0-0-0/w STRC(72)    r     1 VE_CMD_TBL


   Procedure VEF$FILCMD requires 2197 words for executable code.
   Procedure VEF$FILCMD requires 106 words of local(AUTO) storage.

    No errors detected in file VEF$FILCMD.:E05TSI    .
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:214  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:215  
          MINI XREF LISTING

B$ALT.CODE
      6902**DCL      6902--REDEF    6903--REDEF    6903--REDEF
B$ALT.ERR.ERR#
      6904**DCL      6904--REDEF    7433>>IF       7584>>IF       7800>>IF       7882>>IF       8036>>IF
      8055>>IF       8060>>IF
B$ALT.EVID
      6903**DCL      6903--REDEF    6903--REDEF
B$JIT.CPFLAGS1.SLEAZE
      2331**DCL      2331--REDEF
B$JIT.ERR.MID
      2238**DCL      2238--REDEF
B$JIT.FACCN
      2237**DCL      8272>>CALLBLT  8388>>CALLBLT
B$JIT.FPSN
      2318**DCL      8264>>CALLBLT  8267>>CALLBLT  8380>>CALLBLT  8383>>CALLBLT
B$JIT.JRESPEAK
      2399**DCL      2400--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      2508**DCL      2508--REDEF    2509--REDEF
B$JIT.PNR
      2412**DCL      2412--REDEF
B$JIT.TSLINE
      2506**DCL      2507--REDEF
B$JIT$
      7330**DCL      2232--IMP-PTR  8264>>CALLBLT  8267>>CALLBLT  8272>>CALLBLT  8380>>CALLBLT  8383>>CALLBLT
      8388>>CALLBLT
B$TCB.ALT$
      6898**DCL      7433>>IF       7584>>IF       7800>>IF       7882>>IF       8036>>IF       8055>>IF
      8060>>IF
B$TCB$
      7208**DCL      7433>>IF       7584>>IF       7800>>IF       7882>>IF       8036>>IF       8055>>IF
      8060>>IF
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:216  
BP
      8306**LABEL    8276--GOTO
BP_CMD_TBL.TEXT
      6877**DCL      7345>>IF       7628>>IF       8112>>IF       8120>>IF       8465>>IF       8479>>IF
B_CMD_TBL.FID$
      6843**DCL      7371>>ASSIGN
B_CMD_TBL.INCR
      6845**DCL      7384>>ASSIGN
B_CMD_TBL.SEQNUM
      6844**DCL      7383>>ASSIGN   7392>>IF
B_CMD_TBL.TYPE
      6846**DCL      7377>>ASSIGN
CL
      8224**LABEL    8161--GOTO
CLOSE2DFLT_FPT
      6382**DCL      7568<>CALL
CLOSE2DFLT_FPT.SN_
      6382**DCL      6382--REDEF
CLOSE2DFLT_FPT.UTL_
      6383**DCL      6383--REDEF
CLOSE2DFLT_FPT.V
      6387**DCL      6382--DCLINIT
CLOSE2DFLT_FPT.V.EXPIRE#
      6397**DCL      6397--REDEF
CLOSE2DFLT_FPT.V.TYPE#
      6395**DCL      6395--REDEF
CLOSE2DFLT_FPT.V.XTNSIZE#
      6392**DCL      6392--REDEF    6394--REDEF
CLOSE2REL_FPT
      6426**DCL      7609<>CALL
CLOSE2REL_FPT.SN_
      6426**DCL      6426--REDEF
CLOSE2REL_FPT.UTL_
      6427**DCL      6427--REDEF
CLOSE2REL_FPT.V
      6431**DCL      6426--DCLINIT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:217  
CLOSE2REL_FPT.V.EXPIRE#
      6441**DCL      6441--REDEF
CLOSE2REL_FPT.V.TYPE#
      6439**DCL      6439--REDEF
CLOSE2REL_FPT.V.XTNSIZE#
      6436**DCL      6436--REDEF    6438--REDEF
CLOSE2_FPT
      6338**DCL      7563<>CALL     7618<>CALL     7815<>CALL     8012<>CALL     8045<>CALL
CLOSE2_FPT.SN_
      6338**DCL      6338--REDEF
CLOSE2_FPT.UTL_
      6339**DCL      6339--REDEF
CLOSE2_FPT.V
      6343**DCL      6338--DCLINIT
CLOSE2_FPT.V.EXPIRE#
      6353**DCL      6353--REDEF
CLOSE2_FPT.V.OPER.RELG#
      6344**DCL      8011<<ASSIGN   8014<<ASSIGN   8044<<ASSIGN   8047<<ASSIGN
CLOSE2_FPT.V.TYPE#
      6351**DCL      6351--REDEF
CLOSE2_FPT.V.XTNSIZE#
      6348**DCL      6348--REDEF    6350--REDEF
CLOSEDFLT_FPT
      6249**DCL      7566<>CALL
CLOSEDFLT_FPT.SN_
      6249**DCL      6249--REDEF
CLOSEDFLT_FPT.UTL_
      6250**DCL      6250--REDEF
CLOSEDFLT_FPT.V
      6254**DCL      6249--DCLINIT
CLOSEDFLT_FPT.V.EXPIRE#
      6264**DCL      6264--REDEF
CLOSEDFLT_FPT.V.TYPE#
      6262**DCL      6262--REDEF
CLOSEDFLT_FPT.V.XTNSIZE#
      6259**DCL      6259--REDEF    6261--REDEF
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:218  
CLOSEREL_FPT
      6293**DCL      7401<>CALL
CLOSEREL_FPT.SN_
      6293**DCL      6293--REDEF
CLOSEREL_FPT.UTL_
      6294**DCL      6294--REDEF
CLOSEREL_FPT.V
      6298**DCL      6293--DCLINIT
CLOSEREL_FPT.V.EXPIRE#
      6308**DCL      6308--REDEF
CLOSEREL_FPT.V.TYPE#
      6306**DCL      6306--REDEF
CLOSEREL_FPT.V.XTNSIZE#
      6303**DCL      6303--REDEF    6305--REDEF
CLOSE_DO_FPT
      6514**DCL      7818<>CALL
CLOSE_DO_FPT.SN_
      6514**DCL      6514--REDEF
CLOSE_DO_FPT.UTL_
      6515**DCL      6515--REDEF
CLOSE_DO_FPT.V
      6519**DCL      6514--DCLINIT
CLOSE_DO_FPT.V.EXPIRE#
      6529**DCL      6529--REDEF
CLOSE_DO_FPT.V.TYPE#
      6527**DCL      6527--REDEF
CLOSE_DO_FPT.V.XTNSIZE#
      6524**DCL      6524--REDEF    6526--REDEF
CLOSE_FPT
      6205**DCL      7354<>CALL     7453<>CALL     7493<>CALL     7561<>CALL     7586<>CALL     7607<>CALL
      7616<>CALL     7654<>CALL     7692<>CALL     7750<>CALL     7813<>CALL     7829<>CALL     7868<>CALL
      8009<>CALL     8042<>CALL
CLOSE_FPT.SN_
      6205**DCL      6205--REDEF
CLOSE_FPT.UTL_
      6206**DCL      6206--REDEF
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:219  
CLOSE_FPT.V
      6210**DCL      6205--DCLINIT
CLOSE_FPT.V.EXPIRE#
      6220**DCL      6220--REDEF
CLOSE_FPT.V.TYPE#
      6218**DCL      6218--REDEF
CLOSE_FPT.V.XTNSIZE#
      6215**DCL      6215--REDEF    6217--REDEF
CLOSE_ME_FPT
      6470**DCL      7817<>CALL
CLOSE_ME_FPT.SN_
      6470**DCL      6470--REDEF
CLOSE_ME_FPT.UTL_
      6471**DCL      6471--REDEF
CLOSE_ME_FPT.V
      6475**DCL      6470--DCLINIT
CLOSE_ME_FPT.V.EXPIRE#
      6485**DCL      6485--REDEF
CLOSE_ME_FPT.V.TYPE#
      6483**DCL      6483--REDEF
CLOSE_ME_FPT.V.XTNSIZE#
      6480**DCL      6480--REDEF    6482--REDEF
CMD$
      7312**DCL      7345>>IF       7371>>ASSIGN   7377>>ASSIGN   7383>>ASSIGN   7384>>ASSIGN   7392>>IF
      7470>>ASSIGN   7501>>ASSIGN   7504>>IF       7504>>ASSIGN   7506>>IF       7514>>ASSIGN   7525>>ASSIGN
      7603>>IF       7603>>IF       7603>>IF       7603>>IF       7628>>IF       7641>>ASSIGN   7704>>ASSIGN
      7845>>ASSIGN   7875>>ASSIGN   7877>>IF       7896>>ASSIGN   7915>>ASSIGN   7916>>ASSIGN   7936>>ASSIGN
      7938>>ASSIGN   7940>>ASSIGN   8112>>IF       8120>>IF       8128>>IF       8136>>DOINDEX  8137>>ASSIGN
      8375>>DOCASE   8399>>ASSIGN   8400>>IF       8402>>ASSIGN   8455>>ASSIGN   8465>>IF       8479>>IF
      8493>>ASSIGN   8499>>ASSIGN
CMD_BUF
      7211**DCL      6557--DCLINIT  6558--DCLINIT  8215<<CALLBLT  8217>>CALLBLT  8229<<CALLBLT  8230>>CALLBLT
CMD_CODE
      7267**DCL      7711>>IF       7761>>IF       7800>>IF
COPYDS_FPT
      6607**DCL      7472<>CALL     7495<>CALL     7571<>CALL     7588<>CALL     7610<>CALL     7620<>CALL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:220  
      7853<>CALL     8015<>CALL     8048<>CALL
COPYDS_FPT.V
      6607**DCL      6607--DCLINIT
COPYDS_PTR$
      7314**DCL      7475<<ASSIGN   7856<<ASSIGN
COPY_CLOSE2
      7566**LABEL    7545--GOTO
CR
      8314**LABEL    8306--GOTO
CURR_FILE_ACCT
      7228**DCL      7478<<ASSIGN   7638<<ASSIGN   7646>>IF       7684>>ASSIGN   7707<<ASSIGN   7848<<ASSIGN
CURR_FILE_NAME
      7225**DCL      7476<<ASSIGN   7601>>ASSIGN   7636<<ASSIGN   7682>>ASSIGN   7705<<ASSIGN   7846<<ASSIGN
      8040>>ASSIGN
CURR_FILE_NAME.TEXT
      7227**DCL      7646>>IF
CURR_FILE_PASS
      7229**DCL      7479<<ASSIGN   7639<<ASSIGN   7646>>IF       7685>>ASSIGN   7708<<ASSIGN   7849<<ASSIGN
CURR_FILE_SN
      7230**DCL      7477<<ASSIGN   7637<<ASSIGN   7683>>ASSIGN   7706<<ASSIGN   7847<<ASSIGN
CURR_FILE_SN.SN
      7232**DCL      7646>>IF
C_CMD_TBL.FID$
      6855**DCL      7470>>ASSIGN   7603>>IF       7603>>IF
C_CMD_TBL.FID2$
      6856**DCL      7501>>ASSIGN   7603>>IF       7603>>IF
C_CMD_TBL.INCR
      6859**DCL      7514>>ASSIGN
C_CMD_TBL.ONOVER
      6857**DCL      7506>>IF
C_CMD_TBL.SEQNUM
      6858**DCL      7525>>ASSIGN
C_CMD_TBL.TYPE
      6860**DCL      7504>>IF       7504>>ASSIGN
DELETE_FPT
      6021**DCL      7642<<ASSIGN   7644<>CALL     7670<>CALL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:221  
DELETE_FPT.ACSVEH_
      6023**DCL      6024--REDEF
DELETE_FPT.ALTKEYS_
      6029**DCL      6030--REDEF    6030--REDEF
DELETE_FPT.HDR_
      6028**DCL      6029--REDEF
DELETE_FPT.TAB_
      6027**DCL      6028--REDEF
DELETE_FPT.UHL_
      6021**DCL      6022--REDEF    6022--REDEF
DELETE_FPT.V
      6030**DCL      7643--ASSIGN
DELETE_FPT.V.FSN#
      6061**DCL      6061--REDEF    6061--REDEF
DELETE_FPT.V_
      6021**DCL      7643<<ASSIGN
DELETE_FPT.WSN_
      6027**DCL      6027--REDEF
DELETE_FPT_C
      6135**DCL      7642>>ASSIGN
DELETE_FPT_C.ACSVEH_
      6137**DCL      6138--REDEF
DELETE_FPT_C.ALTKEYS_
      6143**DCL      6144--REDEF    6144--REDEF
DELETE_FPT_C.HDR_
      6142**DCL      6143--REDEF
DELETE_FPT_C.TAB_
      6141**DCL      6142--REDEF
DELETE_FPT_C.UHL_
      6135**DCL      6136--REDEF    6136--REDEF
DELETE_FPT_C.V
      6144**DCL      6135--DCLINIT
DELETE_FPT_C.V.FSN#
      6175**DCL      6175--REDEF    6175--REDEF
DELETE_FPT_C.WSN_
      6141**DCL      6141--REDEF
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:222  
DIR
      8260**LABEL    8237--GOTO
DIR_CMD_TBL.ACCT
      6894**DCL      8399--ASSIGN
DIR_CMD_TBL.CODE
      6893**DCL      8375>>DOCASE
DIR_CMD_TBL.PSN
      6895**DCL      8400>>IF       8402--ASSIGN
DONE
      8362**LABEL    8359--GOTO
DS_RESULTS
      6643**DCL      6607--DCLINIT  7471<<ASSIGN   7473>>ASSIGN   7474>>ASSIGN   7852<<ASSIGN   7854>>ASSIGN
      7855>>ASSIGN
DS_RESULTS.PTR$
      6645**DCL      7475>>ASSIGN   7856>>ASSIGN
DS_RESULTS.W2
      6644**DCL      6645--REDEF
DVBYTE
      7250**DCL      7382<<ASSIGN
ED_CMD_TBL.FID$
      6840**DCL      7641>>ASSIGN   7704>>ASSIGN
ERR_CODE.ERR#
      7244**DCL      8079>>IF       8095>>IF       8095>>IF
ERR_CODE.FCG_MID
      7242**DCL      8069>>IF       8091>>IF       8095>>IF
ERR_CODE.MON
      7243**DCL      8079>>IF
ERR_CODE.SEV
      7245**DCL      8093>>IF
EXEC_BUILD_CLOSE_ERR1
      7356**LABEL    7354--CALLALT
EXEC_BUILD_ERR
      7433**LABEL    7379--CALLALT  7401--CALLALT
EXEC_BUILD_ERR2
      7446**LABEL    7373--CALLALT  7389--CALLALT  7406--CALLALT
EXEC_COPY2_ERR
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:223  
      7584**LABEL    7472--CALLALT  7482--CALLALT  7509--CALLALT
EXEC_COPY_CLOSE_ERR1
      7455**LABEL    7453--CALLALT
EXEC_COPY_CLOSE_ERR2
      7495**LABEL    7493--CALLALT
EXEC_COPY_CLOSE_ERR3
      7563**LABEL    7561--CALLALT
EXEC_COPY_CLOSE_ERR4
      7571**LABEL    7563--CALLALT  7568--CALLALT
EXEC_COPY_CLOSE_ERR5
      7588**LABEL    7586--CALLALT
EXEC_COPY_CLOSE_ERR6
      7609**LABEL    7607--CALLALT
EXEC_COPY_CLOSE_ERR7
      7618**LABEL    7616--CALLALT
EXEC_COPY_CLOSE_ERR8
      7620**LABEL    7618--CALLALT
EXEC_COPY_CLOSE_ERR9
      7568**LABEL    7566--CALLALT
EXEC_COPY_ERR
      7603**LABEL    7480--CALLALT  7502--CALLALT  7517--GOTO     7533--CALLALT  7535--CALLALT  7536--CALLALT
      7539--CALLALT  7541--CALLALT  7576--CALLALT
EXEC_DELETE_CLOSE_ERR1
      7656**LABEL    7654--CALLALT
EXEC_DELETE_ERR
      7680**LABEL    7670--CALLALT
EXEC_DELETE_RET
      7682**LABEL    7644--CALLALT  7677--GOTO
EXEC_EDIT_CLOSE_ERR1
      7694**LABEL    7692--CALLALT
EXEC_EDIT_CLOSE_ERR2
      7752**LABEL    7750--CALLALT
EXEC_EDIT_ERR
      7800**LABEL    7715--CALLALT
EXEC_EDIT_RET
      7808**LABEL    7709--CALLALT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:224  
EXEC_END_CLOSE_ERR1
      7815**LABEL    7813--CALLALT
EXEC_END_CLOSE_ERR2
      7817**LABEL    7815--CALLALT
EXEC_MERGE_CLOSE
      8009**LABEL    7926--GOTO
EXEC_MERGE_CLOSE_ERR1
      7831**LABEL    7829--CALLALT
EXEC_MERGE_CLOSE_ERR2
      7870**LABEL    7868--CALLALT
EXEC_MERGE_CLOSE_ERR3
      8011**LABEL    8009--CALLALT
EXEC_MERGE_CLOSE_ERR4
      8014**LABEL    8012--CALLALT
EXEC_MERGE_CLOSE_ERR5
      8044**LABEL    8042--CALLALT
EXEC_MERGE_CLOSE_ERR6
      8047**LABEL    8045--CALLALT
EXEC_MERGE_DONE
      7991**LABEL    7978--GOTO
EXEC_MERGE_DONE1
      7998**LABEL    7984--CALLALT
EXEC_MERGE_ERR
      8036**LABEL    7853--CALLALT  7857--CALLALT  7898--CALLALT  8029--CALLALT  8061--GOTO
EXEC_MERGE_MOVE
      7951**LABEL    8058--GOTO     8063--GOTO
EXEC_MERGE_RET
      8042**LABEL    7850--CALLALT  7876--CALLALT  7905--GOTO     7918--CALLALT  7922--CALLALT  7943--CALLALT
      7971--CALLALT  7975--CALLALT  8027--CALLALT
EXEC_SEQNUM
      7257**DCL      7383<<ASSIGN   7386>>DOWHILE  7387<>CALL     7392>>IF       7393<<ASSIGN   7393>>ASSIGN
      7394>>ASSIGN   7395>>ASSIGN   7396>>ASSIGN   7406<>CALL     7408>>ASSIGN   7409>>ASSIGN   7410>>ASSIGN
      7413<<ASSIGN   7413>>ASSIGN   7525<<ASSIGN   7534>>IF       7539<>CALL     7542<<ASSIGN   7542>>ASSIGN
      7543>>IF       7936<<ASSIGN   7937>>ASSIGN   7943<>CALL     7971<>CALL     7972<<ASSIGN   7972>>ASSIGN
      7991<<ASSIGN   7991>>ASSIGN   7994<>CALL     8000>>ASSIGN
F$DCB.ACTPOS
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:225  
       992**DCL       992--REDEF
F$DCB.ARS
       967**DCL       967--REDEF    7945>>ASSIGN
F$DCB.ATTR
       985**DCL       986--REDEF
F$DCB.BORROW
      1000**DCL      1000--REDEF    1000--REDEF    1000--REDEF
F$DCB.DCBNAME.L
      1014**DCL      1014--IMP-SIZ
F$DCB.EOMCHAR
       971**DCL       971--REDEF
F$DCB.FEXT
       995**DCL      8011>>IF       8044>>IF
F$DCB.FFLG.DELR
       972**DCL      7735>>IF       7762>>IF       7774>>IF       8280>>DOCASE
F$DCB.FFLG.UPD
       972**DCL      7735>>IF       7762>>IF       7788>>IF       8280>>DOCASE
F$DCB.FFLG.WNEW
       972**DCL      7735>>IF       7762>>IF       7781>>IF       8280>>DOCASE
F$DCB.FLDID
       995**DCL       995--REDEF
F$DCB.FORM$
       989**DCL       989--REDEF
F$DCB.FSECT
      1005**DCL      1005--REDEF
F$DCB.FSN
       982**DCL       982--REDEF     982--REDEF     983--REDEF
F$DCB.HEADER$
       988**DCL       988--REDEF
F$DCB.IXTNSIZE
       986**DCL       986--REDEF
F$DCB.LASTSTA$
       976**DCL       976--REDEF
F$DCB.LVL
      1001**DCL      1001--REDEF
F$DCB.NAME.C
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:226  
       976**DCL       976--REDEF
F$DCB.NOEOF
       997**DCL       997--REDEF
F$DCB.NRECS
       987**DCL       987--REDEF
F$DCB.NRECX
      1006**DCL      1006--REDEF
F$DCB.OHDR
       998**DCL       998--REDEF
F$DCB.ORG
       981**DCL       981--REDEF    7483>>IF       7484>>IF       7484>>IF       7484>>IF       7490>>IF
      7718>>IF       7727>>IF       7727>>IF       7727>>IF       7730>>IF       7749>>IF       7858>>IF
      7859>>IF       7859>>IF       7859>>IF       7865>>IF       7903>>IF
F$DCB.PRECNO
      1004**DCL      1004--REDEF
F$DCB.RCSZ
      1009**DCL      1009--REDEF
F$DCB.RES
       977**DCL       977--REDEF
F$DCB.SETX
       989**DCL       989--REDEF
F$DCB.TAB$
       988**DCL       989--REDEF
F$DCB.TDA
      1003**DCL      1003--REDEF
F$DCB.WSN
       978**DCL       978--REDEF
FILL_LINE
      8506**PROC     8303--CALL     8311--CALL     8319--CALL     8327--CALL     8335--CALL     8343--CALL
      8356--CALL     8364--CALL
FLAGS.BPFLAG
      6965**DCL      7345<<ASSIGN   7346<<ASSIGN   8309>>IF
FLAGS.CONSEC_MODE
      6964**DCL      7357>>IF       7359<<ASSIGN   7456>>IF       7458<<ASSIGN   7487<<ASSIGN   7579<<ASSIGN
      7653>>IF       7657<<ASSIGN   7694>>IF       7696<<ASSIGN   7732<<ASSIGN   7831>>IF       7833<<ASSIGN
      7862<<ASSIGN   7993<<ASSIGN   8017<<ASSIGN
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:227  
FLAGS.CRFLAG
      6966**DCL      7628<<ASSIGN   7629<<ASSIGN   8317>>IF
FLAGS.EDIT_MODE
      6957**DCL      7353>>IF       7358<<ASSIGN   7381<<ASSIGN   7400<<ASSIGN   7452>>IF       7457<<ASSIGN
      7577<<ASSIGN   7651>>IF       7656<<ASSIGN   7691>>IF       7695<<ASSIGN   7796<<ASSIGN   7827>>IF
      7832<<ASSIGN   8030<<ASSIGN   8152>>IF       8279>>IF
FLAGS.EOF
      6962**DCL      7534>>DOWHILE  7538>>DOWHILE  7924>>IF       7976>>IF
FLAGS.EXISTS
      6961**DCL      7921>>IF
FLAGS.HELP_MODE
      6991**DCL      8069>>IF       8081>>IF
FLAGS.REL_MODE
      6975**DCL      7360<<ASSIGN   7459<<ASSIGN   7490<<ASSIGN   7578<<ASSIGN   7658<<ASSIGN   7697<<ASSIGN
      7719<<ASSIGN   7834<<ASSIGN   7865<<ASSIGN   8018<<ASSIGN
FLAGS.ROUNDFLAG
      6997**DCL      8112<<ASSIGN   8113<<ASSIGN   8362>>IF
FLAGS.RPFLAG
      6967**DCL      7357<<ASSIGN   7456<<ASSIGN   7653<<ASSIGN   7694<<ASSIGN   7733<<ASSIGN   7831<<ASSIGN
      8120<<ASSIGN   8121<<ASSIGN   8325>>IF
FLAGS.TABCFLAG
      6974**DCL      8341>>IF       8465<<ASSIGN   8466<<ASSIGN
FLAGS.TABXFLAG
      6968**DCL      8333>>IF       8479<<ASSIGN   8480<<ASSIGN
FLAGS.VERIFY
      6980**DCL      8349>>IF       8501<<ASSIGN   8502<<ASSIGN
FPT_SETFMA
      6658**DCL      8395<>CALL     8405<>CALL
FPT_SETFMA.ACCT_
      6658**DCL      8393<<ASSIGN   8399<<ASSIGN
FPT_SETFMA.PSN_
      6658**DCL      8394<<ASSIGN   8402<<ASSIGN   8404<<ASSIGN
HELPMSG
      8079**LABEL    8069--GOTO     8071--CALLALT  8091--GOTO     8093--GOTO
HELP_ERR
      8086**LABEL    8080--CALLALT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:228  
HI_EXEC_CLMN
      7254**DCL      8227>>IF       8229>>CALLBLT
HI_SEQNUM
      7256**DCL      7370<<ASSIGN   7395<<ASSIGN   7409<<ASSIGN   7468<<ASSIGN   7667<<ASSIGN   7702<<ASSIGN
      7843<<ASSIGN   7938<<ASSIGN   7943<>CALL     7948<<ASSIGN   8000<<ASSIGN   8057<<ASSIGN   8062<<ASSIGN
      8171>>IF       8172<>CALL
HI_SRCH_CLMN
      7252**DCL      8215>>CALLBLT  8227>>IF
I
      7270**DCL      8165<<ASSIGN   8168>>CALLBLT  8169<<ASSIGN   8173>>CALLBLT  8174<<ASSIGN   8180>>CALLBLT
      8181<<ASSIGN   8181>>ASSIGN   8183>>CALLBLT  8184<<ASSIGN   8184>>ASSIGN   8192>>CALLBLT  8193<<ASSIGN
      8193>>ASSIGN   8197>>CALLBLT  8198<<ASSIGN   8198>>ASSIGN   8201>>CALLBLT  8202<<ASSIGN   8202>>ASSIGN
      8206>>CALLBLT  8207<<ASSIGN   8207>>ASSIGN   8217>>CALLBLT  8244<<ASSIGN   8251>>CALLBLT  8252<<ASSIGN
      8252>>ASSIGN   8254>>CALLBLT  8255<<ASSIGN   8255>>ASSIGN   8264<<CALLBLT  8265>>IF       8268<<ASSIGN
      8268>>ASSIGN   8270<<ASSIGN   8272>>CALLBLT  8380<<CALLBLT  8381>>IF       8384<<ASSIGN   8384>>ASSIGN
      8386<<ASSIGN   8388>>CALLBLT  8424>>CALLBLT  8425<<ASSIGN   8425>>ASSIGN   8429>>CALLBLT  8430<<ASSIGN
      8430>>ASSIGN   8434>>CALLBLT  8440<<ASSIGN   8440>>ASSIGN   8454<<DOINDEX  8455>>ASSIGN   8455>>ASSIGN
INCR
      7260**DCL      7384<<ASSIGN   7393>>ASSIGN   7407>>IF       7413>>ASSIGN   7514<<ASSIGN   7515>>IF
      7542>>ASSIGN   7940<<ASSIGN   7972>>ASSIGN   7991>>ASSIGN
INSERT_STRING
      8420**PROC     8186--CALL     8209--CALL
IS_ALT IN PROCEDURE INSERT_STRING
      8447**LABEL    8424--CALLALT  8429--CALLALT  8434--CALLALT
LAST_KEY
      7262**DCL      6555--DCLINIT  6556--DCLINIT  7396<<ASSIGN   7410<<ASSIGN   7488<<ASSIGN   7535<>CALL
      7734<<ASSIGN   7863<<ASSIGN   7923>>ASSIGN   7924>>IF       7946--ASSIGN   7948>>ASSIGN   7969<<ASSIGN
      7970>>DOWHILE  7973>>ASSIGN   8056--ASSIGN   8057>>ASSIGN
LENGTH IN PROCEDURE FILL_LINE
      8510**DCL      8512<<ASSIGN   8514>>DOWHILE  8515<<ASSIGN   8515>>ASSIGN   8527>>CALLBLT  8528>>ASSIGN
LIMIT_SEQNUM
      7258**DCL      7916<<ASSIGN   7924>>IF       7970>>DOWHILE
LINELEN
      7336**DCL      8144<<ASSIGN   8368>>IF       8518>>IF       8520<<ASSIGN   8522>>IF       8523>>CALLBLT
      8524<<ASSIGN   8524>>ASSIGN   8527>>CALLBLT  8528<<ASSIGN   8528>>ASSIGN
LO_EXEC_CLMN
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:229  
      7253**DCL      8227>>IF       8228>>CALLBLT
LO_SEQNUM
      7255**DCL      7369<<ASSIGN   7394<<ASSIGN   7408<<ASSIGN   7467<<ASSIGN   7666<<ASSIGN   7701<<ASSIGN
      7842<<ASSIGN   7937<<ASSIGN   8167<>CALL     8171>>IF
LO_SRCH_CLMN
      7251**DCL      8214>>CALLBLT  8227>>IF
M$CLOSE
      1024**DCL-ENT  7354--CALL     7401--CALL     7453--CALL     7493--CALL     7561--CALL     7563--CALL
      7566--CALL     7568--CALL     7586--CALL     7607--CALL     7609--CALL     7616--CALL     7618--CALL
      7654--CALL     7692--CALL     7750--CALL     7813--CALL     7815--CALL     7817--CALL     7818--CALL
      7829--CALL     7868--CALL     8009--CALL     8012--CALL     8042--CALL     8045--CALL
M$DEVICE
      1028**DCL-ENT  7820--CALL     8458--CALL
M$EXIT
      1036**DCL-ENT  7821--CALL
M$FDS
      1059**DCL-ENT  7495--CALL     7571--CALL     7588--CALL     7610--CALL     7620--CALL     8015--CALL
      8048--CALL
M$FILE$
      7310**DCL      7483>>IF       7484>>IF       7484>>IF       7484>>IF       7490>>IF       7718>>IF
      7727>>IF       7727>>IF       7727>>IF       7730>>IF       7735>>IF       7735>>IF       7735>>IF
      7749>>IF       7762>>IF       7762>>IF       7762>>IF       7774>>IF       7781>>IF       7788>>IF
      7858>>IF       7859>>IF       7859>>IF       7859>>IF       7865>>IF       8044>>IF       8280>>DOCASE
      8280>>DOCASE   8280>>DOCASE
M$FILE2$
      7311**DCL      7903>>IF       7945>>ASSIGN   8011>>IF
M$FILE2_NUM
      7303**DCL      7535<>CALL     7539<>CALL     7943<>CALL     7971<>CALL
M$FILE_NUM
      7271**DCL      7406<>CALL
M$GDS
      1059**DCL-ENT  7472--CALL     7853--CALL
M$GTRMTAB
      1051**DCL-ENT  8468--CALL     8482--CALL
M$OPEN
      1024**DCL-ENT  7379--CALL     7482--CALL     7509--CALL     7576--CALL     7670--CALL     7715--CALL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:230  
      7857--CALL     7880--CALL     7898--CALL     8029--CALL
M$PFIL
      1026**DCL-ENT  7731--CALL
M$READ
      1025**DCL-ENT  7947--CALL
M$SETFMA
      1024**DCL-ENT  8395--CALL     8405--CALL
M$TRUNC
      1025**DCL-ENT  7716--CALL
M$UNFID
      1087**DCL-ENT  8154--CALL
MAX_SEQNUM
      7326**DCL      7370>>ASSIGN   7386>>DOWHILE  7468>>ASSIGN   7534>>IF       7543>>IF       7667>>ASSIGN
      7702>>ASSIGN   7843>>ASSIGN   8062>>ASSIGN
MERGE_DEL2_ERR
      8055**LABEL    7947--CALLALT
MODE
      8276**LABEL    8260--GOTO
M_CMD_TBL.FID$
      6863**DCL      7845>>ASSIGN
M_CMD_TBL.FID2$
      6869**DCL      7875>>ASSIGN
M_CMD_TBL.HI_SEQNUM.KEY
      6867**DCL      7916>>ASSIGN
M_CMD_TBL.HI_SEQNUM2.KEY
      6873**DCL      7938>>ASSIGN
M_CMD_TBL.INCR
      6874**DCL      7940>>ASSIGN
M_CMD_TBL.LO_SEQNUM.KEY
      6865**DCL      7915>>ASSIGN
M_CMD_TBL.LO_SEQNUM2.KEY
      6871**DCL      7936>>ASSIGN
M_CMD_TBL.ONOVER
      6868**DCL      7877>>IF       7896>>ASSIGN
NUM_TABS
      7304**DCL      8240>>IF       8245>>DOINDEX  8454>>DOINDEX  8469<<ASSIGN   8470>>DOWHILE  8470>>DOWHILE
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:231  
      8471<<ASSIGN   8471>>ASSIGN   8483<<ASSIGN   8484>>DOWHILE  8484>>DOWHILE  8485<<ASSIGN   8485>>ASSIGN
OPEN_FILE2_FPT
      5912**DCL      7502<>CALL     7509<>CALL     7876<>CALL     7880<>CALL     7898<>CALL
OPEN_FILE2_FPT.ACCT_
      5916**DCL      7574>>ASSIGN
OPEN_FILE2_FPT.ACSVEH_
      5914**DCL      5915--REDEF
OPEN_FILE2_FPT.ALTKEYS_
      5920**DCL      5921--REDEF    5921--REDEF
OPEN_FILE2_FPT.HDR_
      5919**DCL      5920--REDEF
OPEN_FILE2_FPT.IFPARAM_
      5917**DCL      7474<<ASSIGN   7590<<ASSIGN   7612<<ASSIGN   7622<<ASSIGN   7855<<ASSIGN   8050<<ASSIGN
OPEN_FILE2_FPT.PASS_
      5914**DCL      7575>>ASSIGN
OPEN_FILE2_FPT.TAB_
      5918**DCL      5919--REDEF
OPEN_FILE2_FPT.UHL_
      5912**DCL      5913--REDEF    5913--REDEF
OPEN_FILE2_FPT.V
      5921**DCL      5912--DCLINIT
OPEN_FILE2_FPT.V.EXIST#
      5925**DCL      7507<<ASSIGN   7508<<ASSIGN   7896<<ASSIGN
OPEN_FILE2_FPT.V.FSN#
      5952**DCL      5952--REDEF    5952--REDEF
OPEN_FILE2_FPT.V.FUN#
      5931**DCL      7503<<ASSIGN   7878<<ASSIGN   7895<<ASSIGN
OPEN_FILE2_FPT.V.OPER.TEST#
      5923**DCL      7879<<ASSIGN
OPEN_FILE2_FPT.V.TYPE#
      5933**DCL      7504<<ASSIGN   7897<<ASSIGN
OPEN_FILE2_FPT.WSN_
      5918**DCL      5918--REDEF
OPEN_FILE_ACCT
      7236**DCL      7478>>ASSIGN   7638>>ASSIGN   7646>>IF       7684<<ASSIGN   7707>>ASSIGN   7848>>ASSIGN
OPEN_FILE_FPT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:232  
      5781**DCL      7373<>CALL     7379<>CALL     7480<>CALL     7482<>CALL     7576<>CALL     7709<>CALL
      7715<>CALL     7850<>CALL     7857<>CALL     8027<>CALL     8029<>CALL
OPEN_FILE_FPT.ACCT_
      5785**DCL      7574<<ASSIGN
OPEN_FILE_FPT.ACSVEH_
      5783**DCL      5784--REDEF
OPEN_FILE_FPT.ALTKEYS_
      5789**DCL      5790--REDEF    5790--REDEF
OPEN_FILE_FPT.FPARAM_
      5786**DCL      7473<<ASSIGN   7511<<ASSIGN   7589<<ASSIGN   7610>>IF       7611<<ASSIGN   7620>>IF
      7621<<ASSIGN   7854<<ASSIGN   7900<<ASSIGN   8048>>IF       8049<<ASSIGN
OPEN_FILE_FPT.HDR_
      5788**DCL      5789--REDEF
OPEN_FILE_FPT.IFPARAM_
      5786**DCL      7512<<ASSIGN   7901<<ASSIGN
OPEN_FILE_FPT.PASS_
      5783**DCL      7575<<ASSIGN
OPEN_FILE_FPT.TAB_
      5787**DCL      5788--REDEF
OPEN_FILE_FPT.UHL_
      5781**DCL      5782--REDEF    5782--REDEF
OPEN_FILE_FPT.V
      5790**DCL      5781--DCLINIT
OPEN_FILE_FPT.V.EXIST#
      5794**DCL      7376<<ASSIGN
OPEN_FILE_FPT.V.FSN#
      5821**DCL      5821--REDEF    5821--REDEF
OPEN_FILE_FPT.V.FUN#
      5800**DCL      7375<<ASSIGN   7481<<ASSIGN   7573<<ASSIGN   7711<<ASSIGN   7712<<ASSIGN   7800>>IF
      7803<<ASSIGN   7851<<ASSIGN   8028<<ASSIGN
OPEN_FILE_FPT.V.TYPE#
      5802**DCL      7377<<ASSIGN
OPEN_FILE_FPT.WSN_
      5787**DCL      5787--REDEF
OPEN_FILE_NAME
      7233**DCL      5782--DCLINIT  5913--DCLINIT  6136--DCLINIT  7476>>ASSIGN   7601<<ASSIGN   7636>>ASSIGN
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:233  
      7682<<ASSIGN   7705>>ASSIGN   7846>>ASSIGN   8040<<ASSIGN
OPEN_FILE_NAME.TEXT
      7235**DCL      7646>>IF
OPEN_FILE_PASS
      7237**DCL      7479>>ASSIGN   7639>>ASSIGN   7646>>IF       7685<<ASSIGN   7708>>ASSIGN   7849>>ASSIGN
OPEN_FILE_SN
      7238**DCL      7477>>ASSIGN   7637>>ASSIGN   7683<<ASSIGN   7706>>ASSIGN   7847>>ASSIGN
OPEN_FILE_SN.SN
      7240**DCL      7646>>IF
P$
      7307**DCL      7371<<ASSIGN   7373<>CALL     7470<<ASSIGN   7480<>CALL     7501<<ASSIGN   7502<>CALL
      7641<<ASSIGN   7644<>CALL     7704<<ASSIGN   7709<>CALL     7845<<ASSIGN   7850<>CALL     7875<<ASSIGN
      7876<>CALL     8027<>CALL
PARM IN PROCEDURE FILL_LINE
      8509**DCL      8506--PROC     8512>>ASSIGN
PFIL_FPT
      6590**DCL      7731<>CALL
PFIL_FPT.V
      6590**DCL      6590--DCLINIT
P_ALLCMDS
      7199**DCL      8031--ASSIGN   8051--ASSIGN
P_PCB.ROOT$
      7022**DCL      8031<<ASSIGN   8051<<ASSIGN
QM2_DONE
      8107**LABEL    8103--CALLALT
READ_KEY
      7263**DCL      7915<<ASSIGN   7918<>CALL     7923<<ASSIGN   7969>>ASSIGN
READ_SEQUEN2_FPT
      6555**DCL      7947<>CALL
READ_SEQUEN2_FPT.KEY_
      6555**DCL      7946<<ASSIGN
READ_SEQUEN2_FPT.STATION_
      6558**DCL      6559--REDEF
READ_SEQUEN2_FPT.V
      6559**DCL      6555--DCLINIT
READ_SEQUEN2_FPT.V.DVBYTE.REREAD#
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:234  
      6570**DCL      6570--REDEF
READ_SEQUEN2_FPT.V.INDX#
      6568**DCL      6568--REDEF
REC_BUF
      7209**DCL      7389<>CALL     7389--CALL
REC_COUNT
      7269**DCL      7942<<ASSIGN   7945<<ASSIGN   7951>>IF       7952<>CALL     7968<<ASSIGN   7974<<ASSIGN
      7974>>ASSIGN   7998<>CALL
REC_SIZE
      7248**DCL      7389<>CALL     7391>>IF       7405>>ASSIGN
REPSTATUS
      7335**DCL      8130<<ASSIGN   8134<<ASSIGN   8137<<ASSIGN   8149>>IF       8161>>IF       8224>>IF
      8237>>IF       8260>>IF       8276>>IF       8306>>IF       8314>>IF       8322>>IF       8330>>IF
      8338>>IF       8346>>IF       8359>>IF
RETRY_OPEN
      7715**LABEL    7804--GOTO
ROUND
      8359**LABEL    8346--GOTO
RP
      8322**LABEL    8314--GOTO
RP_REC_SIZE
      7249**DCL      7405<<ASSIGN
SAVE_KEY
      7264**DCL      7973<<ASSIGN
SAVE_TAB_VLP
      7300**DCL      7819>>ASSIGN
SE
      8161**LABEL    8149--GOTO
SEQ_TEXT_BUF
      7224**DCL      8168>>CALLBLT  8173>>CALLBLT
SETFMA_ERR
      8412**LABEL    8395--CALLALT  8405--CALLALT
SSE$
      7313**DCL      8177<<ASSIGN   8178>>IF       8179>>ASSIGN   8188<<ASSIGN   8188>>ASSIGN   8189>>DOWHILE
      8190>>ASSIGN   8210<<ASSIGN   8210>>ASSIGN
SSE$PARAM
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:235  
      6816**DCL      8179>>ASSIGN   8188--ASSIGN   8190>>ASSIGN   8210--ASSIGN
SSE$PARAM.PTR$
      6826**DCL      8178>>IF       8189>>DOWHILE
SSE_INIT$
      7247**DCL      8177>>ASSIGN
SSE_PARAM
      7316**DCL      8179<<ASSIGN   8190<<ASSIGN
SSE_PARAM.FLAGS.ANDFLAG
      7320**DCL      8191>>IF
SSE_PARAM.FLAGS.NOTFLAG
      7319**DCL      8182>>IF       8205>>IF
SSE_PARAM.FLAGS.ORFLAG
      7321**DCL      8196>>IF
SSE_PARAM.PTR$
      7325**DCL      8422>>DOINDEX  8423>>IF       8426>>ASSIGN   8434>>CALLBLT  8434>>CALLBLT  8434>>CALLBLT
      8440>>ASSIGN
STATUS_FIELDS
      7334**DCL      8129<<DOINDEX  8130>>ASSIGN   8133<<DOINDEX  8134>>ASSIGN   8136<<DOINDEX  8137>>ASSIGN
STAT_ALT
      8221**LABEL    8186--CALLALT  8192--CALLALT  8197--CALLALT  8201--CALLALT  8206--CALLALT  8209--CALLALT
STR IN PROCEDURE FILL_LINE
      8508**DCL      8506--PROC     8514>>DOWHILE  8527>>CALLBLT
STR$BUF.COUNT
      6828**DCL      7603>>IF       7603>>IF       8056<<ASSIGN   8434>>CALLBLT  8434>>CALLBLT  8440>>ASSIGN
STR$BUF.TEXT
      6829**DCL      7603>>IF       7603>>IF       8434>>CALLBLT
STR$PARAM.COUNT
      6831**DCL      8422>>DOINDEX
STR$PARAM.STR.PTR$
      6836**DCL      8434>>CALLBLT  8434>>CALLBLT  8434>>CALLBLT  8440>>ASSIGN
STR$PARAM.STR.QM
      6833**DCL      8423>>IF
STR$PARAM.STR.QMCOUNT
      6835**DCL      8426>>ASSIGN
SUB_BUF_1
      7215**DCL      7952<>CALL     7994<>CALL     7998<>CALL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:236  
TA
      8237**LABEL    8224--GOTO
TABC
      8338**LABEL    8330--GOTO
TAB_FPT
      6625**DCL      7820<>CALL     8458<>CALL     8468<>CALL     8482<>CALL
TAB_FPT.V
      6626**DCL      6625--DCLINIT
TAB_VLP
      7285**DCL      6625--DCLINIT  7819<<ASSIGN   8452<<ASSIGN
TAB_VLP.TABS#
      7285**DCL      8246>>CALLBLT  8455<<ASSIGN   8470>>DOWHILE  8484>>DOWHILE
TA_CMD_TBL.NUM_TABS
      6881**DCL      8128>>IF       8136>>DOINDEX
TA_CMD_TBL.TABS
      6880**DCL      8137>>ASSIGN   8455>>ASSIGN
TEMP_BUF
      7210**DCL      6673--DCLINIT  8155>>CALLBLT  8214<<CALLBLT  8217>>CALLBLT  8228<<CALLBLT  8230>>CALLBLT
      8246<<CALLBLT  8247>>IF       8248<<CALLBLT  8249<<CALLBLT  8254>>CALLBLT  8428<<CALLBLT  8429>>CALLBLT
TEMP_CLMN
      7265**DCL      8426<<ASSIGN   8427>>IF       8428>>CALLBLT
TEMP_COUNT
      7266**DCL      8245<<DOINDEX  8246>>CALLBLT  8248>>IF       8250>>IF       8422<<DOINDEX  8423>>IF
      8426>>ASSIGN   8434>>CALLBLT  8434>>CALLBLT  8434>>CALLBLT  8440>>ASSIGN
TEMP_STR
      7337**DCL      8143<<ASSIGN   8285<<ASSIGN   8287<<ASSIGN   8289<<ASSIGN   8291<<ASSIGN   8293<<ASSIGN
      8295<<ASSIGN   8297<<ASSIGN   8299<<ASSIGN   8302<<ASSIGN   8303<>CALL     8309<<ASSIGN   8310<<ASSIGN
      8311<>CALL     8317<<ASSIGN   8318<<ASSIGN   8319<>CALL     8325<<ASSIGN   8326<<ASSIGN   8327<>CALL
      8333<<ASSIGN   8334<<ASSIGN   8335<>CALL     8341<<ASSIGN   8342<<ASSIGN   8343<>CALL     8350<<ASSIGN
      8351<<ASSIGN   8352<<ASSIGN   8353<<ASSIGN   8355<<ASSIGN   8356<>CALL     8362<<ASSIGN   8363<<ASSIGN
      8364<>CALL
TRUNC_FPT
      5836**DCL      7716<>CALL
TRUNC_FPT.V
      5836**DCL      5836--DCLINIT
TYPE_BUF.TEXT
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:237  
      7214**DCL      8153<<ASSIGN   8155<<CALLBLT  8157<<ASSIGN   8164<<ASSIGN   8168<<CALLBLT  8173<<CALLBLT
      8180<<CALLBLT  8183<<CALLBLT  8192<<CALLBLT  8197<<CALLBLT  8201<<CALLBLT  8206<<CALLBLT  8217<<CALLBLT
      8230<<CALLBLT  8241<<ASSIGN   8243<<ASSIGN   8251<<CALLBLT  8254<<CALLBLT  8263<<ASSIGN   8267<<CALLBLT
      8272<<CALLBLT  8379<<ASSIGN   8383<<CALLBLT  8388<<CALLBLT  8424<<CALLBLT  8429<<CALLBLT  8434<<CALLBLT
      8523<<CALLBLT  8527<<CALLBLT
TYPE_CMD_TBL.CODE
      6884**DCL      8493>>ASSIGN
TYPE_CODE
      7246**DCL      7897>>ASSIGN   8493<<ASSIGN
UNFID_ALT
      8155**LABEL    8154--CALLALT
UNFID_FPT
      6673**DCL      8154<>CALL
UNFID_FPT.V
      6677**DCL      6673--DCLINIT
VARY$STRC.CNT
      6909**DCL      6910--IMP-SIZ
VE
      8346**LABEL    8322--GOTO     8338--GOTO
VEH$ALL_HELP
      6916**DCL-ENT  8082--CALL
VERIFY_TYPE
      7305**DCL      8350>>IF       8351>>IF       8352>>IF       8353>>IF       8499<<ASSIGN   8501>>IF
VEX$CHECK_CUTOFF
      6918**DCL-ENT  7984--CALL
VEX$CLMN_DFLT
      6917**DCL-ENT  7368--CALL     7466--CALL     7665--CALL     7700--CALL     7841--CALL
VEX$DELREC
      6919**DCL-ENT  7943--CALL
VEX$ERRMAX
      6922**DCL-ENT  8098--CALL
VEX$ERRNEXT
      6921**DCL-ENT  8071--CALL     8103--CALL
VEX$ERROR
      6920**DCL-ENT  7356--CALL     7416--CALL     7434--CALL     7444--CALL     7455--CALL     7496--CALL
      7516--CALL     7526--CALL     7544--CALL     7554--CALL     7585--CALL     7600--CALL     7652--CALL
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:238  
      7671--CALL     7680--CALL     7720--CALL     7738--CALL     7752--CALL     7765--CALL     7775--CALL
      7782--CALL     7789--CALL     7806--CALL     7828--CALL     7870--CALL     7883--CALL     7904--CALL
      7925--CALL     7953--CALL     7961--CALL     7977--CALL     7995--CALL     7999--CALL     8020--CALL
      8037--CALL     8039--CALL     8083--CALL     8086--CALL     8412--CALL
VEX$FID_2_FPT
      6923**DCL-ENT  7373--CALL     7480--CALL     7502--CALL     7644--CALL     7709--CALL     7850--CALL
      7876--CALL     8027--CALL
VEX$READ_RANDOM
      6924**DCL-ENT  7918--CALL
VEX$READ_SEQUEN
      6925**DCL-ENT  7533--CALL     7536--CALL     7541--CALL     7922--CALL     7975--CALL
VEX$READ_TERM_REC
      6926**DCL-ENT  7389--CALL
VEX$SEQNUM_TEXT
      6929**DCL-ENT  7387--CALL     7994--CALL     8167--CALL     8172--CALL
VEX$SET_PROMPT
      6927**DCL-ENT  7388--CALL
VEX$SET_SUB_BUF
      6928**DCL-ENT  7952--CALL     7998--CALL
VEX$TYPE_REC
      6930**DCL-ENT  8158--CALL     8221--CALL     8232--CALL     8258--CALL     8273--CALL     8369--CALL
      8389--CALL     8519--CALL
VEX$WRITE_REC
      6931**DCL-ENT  7406--CALL     7535--CALL     7539--CALL     7971--CALL
VE_CMD_TBL.TYPE
      6890**DCL      8499>>ASSIGN
VLP_EDIT
      6804**DCL      6709--DCLINIT
VLP_ERROR_SYN
      6774**DCL      6712--DCLINIT
X$HELP
      6932**DCL-ENT  8080--CALL
XUH_PARAM
      6705**DCL      8080<>CALL
Y003
      7328**DCL      7369>>ASSIGN   7467>>ASSIGN   7488>>ASSIGN   7666>>ASSIGN   7701>>ASSIGN   7734>>ASSIGN
PL6.E3A0      #001=VEF$FILCMD File=VEF$FILCMD.:E05TSI                            WED 07/30/97 07:06 Page:239  
      7842>>ASSIGN   7863>>ASSIGN
