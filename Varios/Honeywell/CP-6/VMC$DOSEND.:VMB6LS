VERSION B06

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:1    
        1        1        /*M* VMC$DOSEND - SENDS a message to MAILMAN */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8        /*P*
        9        9             NAME: VMC$DOSEND
       10       10             PURPOSE:
       11       11                  To pass a message file to MAILMAN for delivery.
       12       12             DESCRIPTION:
       13       13                  This routine will:
       14       14                   - Send a message to MAILMAN and ask that a file
       15       15                     be created for this message to be stuffed into.
       16       16                     It is assumed that the MAIL COMGROUP exists, and that
       17       17                     M$MAIL_COMGROUP is open to it. It will be left open.
       18       18
       19       19                   - Receive the name of the file from MAILMAN (via MAILCG).
       20       20
       21       21                   - Open that file.
       22       22
       23       23                   - Copy the message into that file.
       24       24
       25       25                   - Notify MAILMAN that the message is ready to be delivered.
       26       26
       27       27                   This routine has 2 parameters:
       28       28                      DCB#   - DCB open to file to be sent.
       29       29                      SEED   - seed to use to encrypt the message.
       30       30
       31       31                   NOTE: This routine expects the header (VM_HEADER) to
       32       32                         be stored in the VM_HEADER$ data segment.
       33       33        */
       34       34        VMC$DOSEND: PROC (DCB#,SEED) ALTRET;
       35       35        /***** Include files *****/
       36       36          %INCLUDE B$JIT;
       37      639          %INCLUDE CP_6;
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:2    
       38     6198          %INCLUDE CP_6_SUBS;
       39     6738          %INCLUDE VM_MACRO_C;
       40     8006          %INCLUDE VM_SUBS_C;
       41     8266          %INCLUDE VM_DATA_R;
       42     8697          %INCLUDE VM_PERR_C;
       43     8992          %INCLUDE VO_SUBS_C;
       44     9043          %INCLUDE XUR_ENTRY;
       45     9075        /***** Parameters *****/
       46     9076    1   DCL DCB# UBIN WORD;
       47     9077    1   DCL SEED UBIN WORD;
       48     9078        /***** Misc. global data *****/
       49     9079    1   DCL GATEWAY BIT (1) SYMREF;
       50     9080        /***** Based structures *****/
       51     9081          %B$TCB (STCLASS="BASED(B$TCB$)");
       52     9084          %B$ALT;
       53     9092          %VM_HEADER;
       54     9221          %VM_FOLDER_INFO (NAME=VM_CURRENT_FOLDER, STCLASS=SYMREF);
       55     9273        /***** External routines *****/
       56     9274    1   DCL VMA$ERRMSG ENTRY(5);
       57     9275    1   DCL VMM$COPY_MESSAGE_INTERSYS ENTRY(6) ALTRET;
       58     9276    1   DCL VMD$PUT_HEADER ENTRY(2) ALTRET;
       59     9277        /***** Local variables *****/
       60     9278           %VLP_ERRCODE (FPTN=ERROR);
       61     9323              %VLP_ERRCODE (FPTN=E_SENT,FCG="VM",MID="C",
       62     9324              ERR#=%E$SENT,STCLASS=CONSTANT);
       63     9369        /***** Dcbs *****/
       64     9370    1   DCL M$SEND DCB;
       65     9371        /***** Subs *****/
       66     9372          %VM_KEYTYPES;
       67     9393        /***** Fpts *****/
       68     9394        %FPT_OPEN (FPTN=OPEN_MAIL,
       69     9395                   ACCT=VM_MAIL_ACCT,
       70     9396                   NAME=MAIL_NAME,
       71     9397                   PASS=MAIL_PASS,
       72     9398                   DCB=M$SEND,
       73     9399                   ASN=FILE,
       74     9400                   FUN=UPDATE,
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:3    
       75     9401                   EXIST=OLDFILE,
       76     9402                   SHARE=NONE,
       77     9403                   ORG=KEYED,
       78     9404                   ACS=DIRECT);
       79     9513
       80     9514        %FPT_CLOSE (FPTN=CLOSE_MAIL,DCB=M$SEND,DISP=SAVE);
       81     9556
       82     9557        %VLP_NAME (FPTN=MAIL_NAME,LEN=31);
       83     9584        %VLP_PASS (FPTN=MAIL_PASS,PASS='MAILPASS');
       84     9597
       85     9598        %FPT_READ      (FPTN=READ_MAILCG,
       86     9599                            DCB=M$MAIL_COMGROUP,
       87     9600                            BUF=VM_CGBUFFER,
       88     9601                            WAIT=YES,
       89     9602                            STATION=MAILMAN_STATION);
       90     9641
       91     9642        %FPT_WRITE     (FPTN=WRITE_MAILCG,
       92     9643                            DCB=M$MAIL_COMGROUP,
       93     9644                            BUF=VM_CGBUFFER,
       94     9645                            WAIT=YES,
       95     9646                            STATION=MAILMAN_STATION);
       96     9677
       97     9678        %VLP_STATION   (FPTN=MAILMAN_STATION,
       98     9679                            STATION='MAILMAN',
       99     9680                            DIRONLY=YES);
      100     9707
      101     9708              %VM_CGBUFFER;
      102     9739        %EJECT;
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:4    
      103     9740        /*
      104     9741             If this is a shutdown message being sent from the master
      105     9742             mail registry, then send a kill-mailman request and simply
      106     9743             exit.
      107     9744        */
      108     9745    1       IF VM_CURRENT_FOLDER.ACCT = VM_MAIL_ACCT.ACCT#
      109     9746    1         AND VM_CURRENT_FOLDER.FOLDER = 'CENTRAL'
      110     9747    1         AND VM_HEADER.SUBJECT$ ~= ADDR(NIL)
      111     9748    1         AND VM_HEADER.SUBJECT$ -> X$STRING.TEXT = 'Go away!'
      112     9749    2       THEN DO;
      113     9750
      114     9751    2           VM_CGBUFFER.COMMAND = %VO_KILL_MAILMAN#;
      115     9752    2           CALL M$WRITE (WRITE_MAILCG) ALTRET (E_PMME);
      116     9753    2           CALL XUR$INFOMSG (E_SENT,,M$ME_NUM);
      117     9754
      118     9755    2           RETURN;
      119     9756
      120     9757    2       END;
      121     9758        /*
      122     9759             ***** Ask mailman to allocate a file ...
      123     9760        */
      124     9761    1       VM_CGBUFFER.COMMAND = %VO_SEND_FID#;
      125     9762    1       CALL M$WRITE (WRITE_MAILCG) ALTRET(E_PMME);
      126     9763        /*
      127     9764             ***** Wait for mailman to respond ...
      128     9765             ***** If he could not allocate a file, the error will be returned
      129     9766             ***** in VM_CGBUFFER.ERROR.
      130     9767        */
      131     9768    1       CALL M$READ (READ_MAILCG) ALTRET(E_PMME);
      132     9769        /*
      133     9770             ***** Check if mailman returned an error ---
      134     9771        */
      135     9772    1       IF VM_CGBUFFER.COMMAND = %VO_CREATE_ERROR# THEN
      136     9773    1           GOTO E_MAILMAN;
      137     9774        /*
      138     9775             ***** Get the name and password of the file that
      139     9776                   mailman has allocated and open it ...
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:5    
      140     9777        */
      141     9778    1       MAIL_NAME.NAME# = VM_CGBUFFER.FILE_NAME.TEXT;
      142     9779    1       MAIL_NAME.L# = VM_CGBUFFER.FILE_NAME.COUNT;
      143     9780    1       MAIL_PASS.PASS# = ' ';             /* Temporary code */
      144     9781
      145     9782    1       CALL M$OPEN (OPEN_MAIL) ALTRET(E_PMME);
      146     9783        /*
      147     9784             ***** Copy the message records into the message file ...
      148     9785        */
      149     9786    1       CALL VMM$COPY_MESSAGE_INTERSYS (0,0,DCB#,DCBNUM(M$SEND),0,SEED) ALTRET(E_PMME);
      150     9787
      151     9788    1       VM_CGBUFFER.FILE_NAME = MAIL_NAME;
      152     9789    1       VM_CGBUFFER.STATION# = VM_MAILCG_SETSTA.MYSTATION#;
      153     9790    1       VM_CGBUFFER.COMMAND = %VO_SEND#;
      154     9791    1       CALL M$CLOSE(CLOSE_MAIL);
      155     9792    1       CALL M$WRITE (WRITE_MAILCG) ALTRET(E_PMME);
      156     9793             /*E* ERROR: VMC-E$SENT-0
      157     9794                  MESSAGE: Message sent.
      158     9795              */
      159     9796        /*
      160     9797             ***** Mail gateway check. Don't send a confirmation message if the
      161     9798                   gateway option was specified.
      162     9799        */
      163     9800    1       IF NOT GATEWAY
      164     9801    1       THEN
      165     9802    1           CALL XUR$INFOMSG(E_SENT,,M$ME_NUM);
      166     9803
      167     9804    1       RETURN;
      168     9805    1   E_PMME:;
      169     9806    1       ERROR = B$TCB.ALT$ -> B$ALT.ERR;
      170     9807    1       CALL VMA$ERRMSG(ERROR,DCBNUM(M$SEND));
      171     9808    1       RETURN;
      172     9809    1   E_MAILMAN:;
      173     9810    1       ERROR = VM_CGBUFFER.ERROR;
      174     9811    1       CALL VMA$ERRMSG(ERROR);
      175     9812    1       RETURN;
      176     9813
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:6    
      177     9814    1   END VMC$DOSEND;

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:7    
--  Include file information  --

   XUR_ENTRY.:LIB_E05  cannot be made into a system file and is referenced.
   VO_SUBS_C.:VMB6TOU  is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMC$DOSEND.

   Procedure VMC$DOSEND requires 128 words for executable code.
   Procedure VMC$DOSEND requires 14 words of local(AUTO) storage.

    No errors detected in file VMC$DOSEND.:VMB6TSI    .

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:8    

 Object Unit name= VMC$DOSEND                                 File name= VMC$DOSEND.:VMB6TOU
 UTS= AUG 20 '97 15:07:34.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none   170    252  VMC$DOSEND
   12  RoData even  UTS      5      5  VMC$DOSEND
   13   DCB   even  none     0      0  M$SEND
   14   Proc  even  none   128    200  VMC$DOSEND
   15  RoData even  none    13     15  VMC$DOSEND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    14      0   yes    yes     yes      Std        2  VMC$DOSEND
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:9    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       7 XUR$INFOMSG
 yes     yes           Std       6 VMM$COPY_MESSAGE_INTERSYS
         yes           Std       5 VMA$ERRMSG
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                      GATEWAY
     VM_CURRENT_FOLDER                     M$SEND
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:10   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:11   


        1        1        /*M* VMC$DOSEND - SENDS a message to MAILMAN */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8        /*P*
        9        9             NAME: VMC$DOSEND
       10       10             PURPOSE:
       11       11                  To pass a message file to MAILMAN for delivery.
       12       12             DESCRIPTION:
       13       13                  This routine will:
       14       14                   - Send a message to MAILMAN and ask that a file
       15       15                     be created for this message to be stuffed into.
       16       16                     It is assumed that the MAIL COMGROUP exists, and that
       17       17                     M$MAIL_COMGROUP is open to it. It will be left open.
       18       18
       19       19                   - Receive the name of the file from MAILMAN (via MAILCG).
       20       20
       21       21                   - Open that file.
       22       22
       23       23                   - Copy the message into that file.
       24       24
       25       25                   - Notify MAILMAN that the message is ready to be delivered.
       26       26
       27       27                   This routine has 2 parameters:
       28       28                      DCB#   - DCB open to file to be sent.
       29       29                      SEED   - seed to use to encrypt the message.
       30       30
       31       31                   NOTE: This routine expects the header (VM_HEADER) to
       32       32                         be stored in the VM_HEADER$ data segment.
       33       33        */
       34       34        VMC$DOSEND: PROC (DCB#,SEED) ALTRET;

     34 14 000000   000000 700200 xent  VMC$DOSEND   TSX0  ! X66_AUTO_2
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:12   
        14 000001   000016 000002                    ZERO    14,2

       35       35        /***** Include files *****/
       36       36          %INCLUDE B$JIT;
       37      639          %INCLUDE CP_6;
       38     6198          %INCLUDE CP_6_SUBS;
       39     6738          %INCLUDE VM_MACRO_C;
       40     8006          %INCLUDE VM_SUBS_C;
       41     8266          %INCLUDE VM_DATA_R;
       42     8697          %INCLUDE VM_PERR_C;
       43     8992          %INCLUDE VO_SUBS_C;
       44     9043          %INCLUDE XUR_ENTRY;
       45     9075        /***** Parameters *****/
       46     9076    1   DCL DCB# UBIN WORD;
       47     9077    1   DCL SEED UBIN WORD;
       48     9078        /***** Misc. global data *****/
       49     9079    1   DCL GATEWAY BIT (1) SYMREF;
       50     9080        /***** Based structures *****/
       51     9081          %B$TCB (STCLASS="BASED(B$TCB$)");
       52     9084          %B$ALT;
       53     9092          %VM_HEADER;
       54     9221          %VM_FOLDER_INFO (NAME=VM_CURRENT_FOLDER, STCLASS=SYMREF);
       55     9273        /***** External routines *****/
       56     9274    1   DCL VMA$ERRMSG ENTRY(5);
       57     9275    1   DCL VMM$COPY_MESSAGE_INTERSYS ENTRY(6) ALTRET;
       58     9276    1   DCL VMD$PUT_HEADER ENTRY(2) ALTRET;
       59     9277        /***** Local variables *****/
       60     9278           %VLP_ERRCODE (FPTN=ERROR);
       61     9323              %VLP_ERRCODE (FPTN=E_SENT,FCG="VM",MID="C",
       62     9324              ERR#=%E$SENT,STCLASS=CONSTANT);
       63     9369        /***** Dcbs *****/
       64     9370    1   DCL M$SEND DCB;
       65     9371        /***** Subs *****/
       66     9372          %VM_KEYTYPES;
       67     9393        /***** Fpts *****/
       68     9394        %FPT_OPEN (FPTN=OPEN_MAIL,
       69     9395                   ACCT=VM_MAIL_ACCT,
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:13   
       70     9396                   NAME=MAIL_NAME,
       71     9397                   PASS=MAIL_PASS,
       72     9398                   DCB=M$SEND,
       73     9399                   ASN=FILE,
       74     9400                   FUN=UPDATE,
       75     9401                   EXIST=OLDFILE,
       76     9402                   SHARE=NONE,
       77     9403                   ORG=KEYED,
       78     9404                   ACS=DIRECT);
       79     9513
       80     9514        %FPT_CLOSE (FPTN=CLOSE_MAIL,DCB=M$SEND,DISP=SAVE);
       81     9556
       82     9557        %VLP_NAME (FPTN=MAIL_NAME,LEN=31);
       83     9584        %VLP_PASS (FPTN=MAIL_PASS,PASS='MAILPASS');
       84     9597
       85     9598        %FPT_READ      (FPTN=READ_MAILCG,
       86     9599                            DCB=M$MAIL_COMGROUP,
       87     9600                            BUF=VM_CGBUFFER,
       88     9601                            WAIT=YES,
       89     9602                            STATION=MAILMAN_STATION);
       90     9641
       91     9642        %FPT_WRITE     (FPTN=WRITE_MAILCG,
       92     9643                            DCB=M$MAIL_COMGROUP,
       93     9644                            BUF=VM_CGBUFFER,
       94     9645                            WAIT=YES,
       95     9646                            STATION=MAILMAN_STATION);
       96     9677
       97     9678        %VLP_STATION   (FPTN=MAILMAN_STATION,
       98     9679                            STATION='MAILMAN',
       99     9680                            DIRONLY=YES);
      100     9707
      101     9708              %VM_CGBUFFER;
      102     9739        %EJECT;
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:14   
      103     9740        /*
      104     9741             If this is a shutdown message being sent from the master
      105     9742             mail registry, then send a kill-mailman request and simply
      106     9743             exit.
      107     9744        */
      108     9745    1       IF VM_CURRENT_FOLDER.ACCT = VM_MAIL_ACCT.ACCT#

   9745 14 000002   040000 106400                    CMPC    fill='040'O
        14 000003   000001 400010 xsym               ADSC9   VM_CURRENT_FOLDER+1      cn=2,n=8
        14 000004   000000 000010 xsym               ADSC9   VM_MAIL_ACCT             cn=0,n=8
        14 000005   000047 601000 14                 TNZ     s:9761
        14 000006   040000 106400                    CMPC    fill='040'O
        14 000007   000003 400031 xsym               ADSC9   VM_CURRENT_FOLDER+3      cn=2,n=25
        14 000010   000001 000007 12                 ADSC9   E_SENT+1                 cn=0,n=7
        14 000011   000047 601000 14                 TNZ     s:9761
        14 000012   000000 470400 xsym               LDP0    VM_HEADER$
        14 000013   000030 236100                    LDQ     24,,PR0
        14 000014   000000 116000 15                 CMPQ    0
        14 000015   000047 600000 14                 TZE     s:9761
        14 000016   000030 471500                    LDP1    24,,PR0
        14 000017   000100 101500                    MRL     fill='000'O
        14 000020   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        14 000021   200006 000002                    ADSC9   @SEED+2,,AUTO            cn=0,n=2
        14 000022   200006 220100                    LDX0    @SEED+2,,AUTO
        14 000023   040000 106540                    CMPC    fill='040'O
        14 000024   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        14 000025   000003 000010 12                 ADSC9   E_SENT+3                 cn=0,n=8
        14 000026   000047 601000 14                 TNZ     s:9761

      109     9746    1         AND VM_CURRENT_FOLDER.FOLDER = 'CENTRAL'
      110     9747    1         AND VM_HEADER.SUBJECT$ ~= ADDR(NIL)
      111     9748    1         AND VM_HEADER.SUBJECT$ -> X$STRING.TEXT = 'Go away!'
      112     9749    2       THEN DO;

      113     9750
      114     9751    2           VM_CGBUFFER.COMMAND = %VO_KILL_MAILMAN#;

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:15   
   9751 14 000027   000013 235007                    LDA     11,DL
        14 000030   000210 755000 11                 STA     VM_CGBUFFER+2

      115     9752    2           CALL M$WRITE (WRITE_MAILCG) ALTRET (E_PMME);

   9752 14 000031   000162 630400 11                 EPPR0   WRITE_MAILCG
        14 000032   440001 713400                    CLIMB   alt,write
        14 000033   401400 401760                    pmme    nvectors=4
        14 000034   000152 702000 14                 TSX2    E_PMME

      116     9753    2           CALL XUR$INFOMSG (E_SENT,,M$ME_NUM);

   9753 14 000035   000002 236000 15                 LDQ     2
        14 000036   200010 756100                    STQ     @SEED+4,,AUTO
        14 000037   000000 236000 15                 LDQ     0
        14 000040   000003 235000 15                 LDA     3
        14 000041   200006 757100                    STAQ    @SEED+2,,AUTO
        14 000042   200006 630500                    EPPR0   @SEED+2,,AUTO
        14 000043   000001 631400 15                 EPPR1   1
        14 000044   000000 701000 xent               TSX1    XUR$INFOMSG
        14 000045   000000 011000                    NOP     0

      117     9754
      118     9755    2           RETURN;

   9755 14 000046   000000 702200 xent               TSX2  ! X66_ARET

      119     9756
      120     9757    2       END;
      121     9758        /*
      122     9759             ***** Ask mailman to allocate a file ...
      123     9760        */
      124     9761    1       VM_CGBUFFER.COMMAND = %VO_SEND_FID#;

   9761 14 000047   000005 235007                    LDA     5,DL
        14 000050   000210 755000 11                 STA     VM_CGBUFFER+2

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:16   
      125     9762    1       CALL M$WRITE (WRITE_MAILCG) ALTRET(E_PMME);

   9762 14 000051   000162 630400 11                 EPPR0   WRITE_MAILCG
        14 000052   440001 713400                    CLIMB   alt,write
        14 000053   401400 401760                    pmme    nvectors=4
        14 000054   000152 702000 14                 TSX2    E_PMME

      126     9763        /*
      127     9764             ***** Wait for mailman to respond ...
      128     9765             ***** If he could not allocate a file, the error will be returned
      129     9766             ***** in VM_CGBUFFER.ERROR.
      130     9767        */
      131     9768    1       CALL M$READ (READ_MAILCG) ALTRET(E_PMME);

   9768 14 000055   000144 630400 11                 EPPR0   READ_MAILCG
        14 000056   440000 713400                    CLIMB   alt,read
        14 000057   401400 401760                    pmme    nvectors=4
        14 000060   000152 702000 14                 TSX2    E_PMME

      132     9769        /*
      133     9770             ***** Check if mailman returned an error ---
      134     9771        */
      135     9772    1       IF VM_CGBUFFER.COMMAND = %VO_CREATE_ERROR# THEN

   9772 14 000061   000210 235000 11                 LDA     VM_CGBUFFER+2
        14 000062   000007 115007                    CMPA    7,DL
        14 000063   000171 600000 14                 TZE     E_MAILMAN

      136     9773    1           GOTO E_MAILMAN;
      137     9774        /*
      138     9775             ***** Get the name and password of the file that
      139     9776                   mailman has allocated and open it ...
      140     9777        */
      141     9778    1       MAIL_NAME.NAME# = VM_CGBUFFER.FILE_NAME.TEXT;

   9778 14 000064   040000 100400                    MLR     fill='040'O
        14 000065   000230 200037 11                 ADSC9   VM_CGBUFFER+18           cn=1,n=31
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:17   
        14 000066   000132 200037 11                 ADSC9   MAIL_NAME                cn=1,n=31

      142     9779    1       MAIL_NAME.L# = VM_CGBUFFER.FILE_NAME.COUNT;

   9779 14 000067   000230 236000 11                 LDQ     VM_CGBUFFER+18
        14 000070   000132 552040 11                 STBQ    MAIL_NAME,'40'O

      143     9780    1       MAIL_PASS.PASS# = ' ';             /* Temporary code */

   9780 14 000071   000004 235000 15                 LDA     4
        14 000072   000004 236000 15                 LDQ     4
        14 000073   000142 757000 11                 STAQ    MAIL_PASS

      144     9781
      145     9782    1       CALL M$OPEN (OPEN_MAIL) ALTRET(E_PMME);

   9782 14 000074   000002 630400 11                 EPPR0   OPEN_MAIL
        14 000075   450000 713400                    CLIMB   alt,open
        14 000076   410400 401760                    pmme    nvectors=18
        14 000077   000152 702000 14                 TSX2    E_PMME

      146     9783        /*
      147     9784             ***** Copy the message records into the message file ...
      148     9785        */
      149     9786    1       CALL VMM$COPY_MESSAGE_INTERSYS (0,0,DCB#,DCBNUM(M$SEND),0,SEED) ALTRET(E_PMME);

   9786 14 000100   000000 236007 xsym               LDQ     M$SEND,DL
        14 000101   200006 756100                    STQ     @SEED+2,,AUTO
        14 000102   200004 236100                    LDQ     @SEED,,AUTO
        14 000103   000007 235000 15                 LDA     7
        14 000104   200014 757100                    STAQ    @SEED+8,,AUTO
        14 000105   200006 630500                    EPPR0   @SEED+2,,AUTO
        14 000106   200013 450500                    STP0    @SEED+7,,AUTO
        14 000107   200003 236100                    LDQ     @DCB#,,AUTO
        14 000110   200012 756100                    STQ     @SEED+6,,AUTO
        14 000111   000010 237000 15                 LDAQ    8
        14 000112   200010 757100                    STAQ    @SEED+4,,AUTO
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:18   
        14 000113   200010 630500                    EPPR0   @SEED+4,,AUTO
        14 000114   000005 631400 15                 EPPR1   5
        14 000115   000000 701000 xent               TSX1    VMM$COPY_MESSAGE_INTERSYS
        14 000116   000152 702000 14                 TSX2    E_PMME

      150     9787
      151     9788    1       VM_CGBUFFER.FILE_NAME = MAIL_NAME;

   9788 14 000117   000000 100400                    MLR     fill='000'O
        14 000120   000132 000040 11                 ADSC9   MAIL_NAME                cn=0,n=32
        14 000121   000230 000040 11                 ADSC9   VM_CGBUFFER+18           cn=0,n=32

      152     9789    1       VM_CGBUFFER.STATION# = VM_MAILCG_SETSTA.MYSTATION#;

   9789 14 000122   040000 100400                    MLR     fill='040'O
        14 000123   000000 000010 xsym               ADSC9   VM_MAILCG_SETSTA         cn=0,n=8
        14 000124   000206 000010 11                 ADSC9   VM_CGBUFFER              cn=0,n=8

      153     9790    1       VM_CGBUFFER.COMMAND = %VO_SEND#;

   9790 14 000125   000004 235007                    LDA     4,DL
        14 000126   000210 755000 11                 STA     VM_CGBUFFER+2

      154     9791    1       CALL M$CLOSE(CLOSE_MAIL);

   9791 14 000127   000074 630400 11                 EPPR0   CLOSE_MAIL
        14 000130   050001 713400                    CLIMB   close
        14 000131   406000 401760                    pmme    nvectors=13

      155     9792    1       CALL M$WRITE (WRITE_MAILCG) ALTRET(E_PMME);

   9792 14 000132   000162 630400 11                 EPPR0   WRITE_MAILCG
        14 000133   440001 713400                    CLIMB   alt,write
        14 000134   401400 401760                    pmme    nvectors=4
        14 000135   000152 702000 14                 TSX2    E_PMME

      156     9793             /*E* ERROR: VMC-E$SENT-0
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:19   
      157     9794                  MESSAGE: Message sent.
      158     9795              */
      159     9796        /*
      160     9797             ***** Mail gateway check. Don't send a confirmation message if the
      161     9798                   gateway option was specified.
      162     9799        */
      163     9800    1       IF NOT GATEWAY

   9800 14 000136   000000 234000 xsym               SZN     GATEWAY
        14 000137   000151 604000 14                 TMI     s:9804

      164     9801    1       THEN
      165     9802    1           CALL XUR$INFOMSG(E_SENT,,M$ME_NUM);

   9802 14 000140   000002 236000 15                 LDQ     2
        14 000141   200010 756100                    STQ     @SEED+4,,AUTO
        14 000142   000000 236000 15                 LDQ     0
        14 000143   000003 235000 15                 LDA     3
        14 000144   200006 757100                    STAQ    @SEED+2,,AUTO
        14 000145   200006 630500                    EPPR0   @SEED+2,,AUTO
        14 000146   000001 631400 15                 EPPR1   1
        14 000147   000000 701000 xent               TSX1    XUR$INFOMSG
        14 000150   000000 011000                    NOP     0

      166     9803
      167     9804    1       RETURN;

   9804 14 000151   000000 702200 xent               TSX2  ! X66_ARET

   9800 14 000152                       E_PMME       null
      168     9805    1   E_PMME:;
      169     9806    1       ERROR = B$TCB.ALT$ -> B$ALT.ERR;

   9806 14 000152   000000 470400 xsym               LDP0    B$TCB$
        14 000153   000000 471500                    LDP1    0,,PR0
        14 000154   100102 236100                    LDQ     66,,PR1
        14 000155   000000 756000 11                 STQ     ERROR
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:20   

      170     9807    1       CALL VMA$ERRMSG(ERROR,DCBNUM(M$SEND));

   9807 14 000156   000000 236007 xsym               LDQ     M$SEND,DL
        14 000157   200006 756100                    STQ     @SEED+2,,AUTO
        14 000160   200006 631500                    EPPR1   @SEED+2,,AUTO
        14 000161   200011 451500                    STP1    @SEED+5,,AUTO
        14 000162   000013 236000 15                 LDQ     11
        14 000163   200010 756100                    STQ     @SEED+4,,AUTO
        14 000164   200010 630500                    EPPR0   @SEED+4,,AUTO
        14 000165   000012 631400 15                 EPPR1   10
        14 000166   000000 701000 xent               TSX1    VMA$ERRMSG
        14 000167   000000 011000                    NOP     0

      171     9808    1       RETURN;

   9808 14 000170   000000 702200 xent               TSX2  ! X66_ARET

   9806 14 000171                       E_MAILMAN    null
      172     9809    1   E_MAILMAN:;
      173     9810    1       ERROR = VM_CGBUFFER.ERROR;

   9810 14 000171   000240 236000 11                 LDQ     VM_CGBUFFER+26
        14 000172   000000 756000 11                 STQ     ERROR

      174     9811    1       CALL VMA$ERRMSG(ERROR);

   9811 14 000173   000013 630400 15                 EPPR0   11
        14 000174   000014 631400 15                 EPPR1   12
        14 000175   000000 701000 xent               TSX1    VMA$ERRMSG
        14 000176   000000 011000                    NOP     0

      175     9812    1       RETURN;

   9812 14 000177   000000 702200 xent               TSX2  ! X66_ARET

ERROR
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:21   
 Sect OctLoc
  11     000   000000 000000                                                    ....

OPEN_MAIL
 Sect OctLoc
  11     002   000025 777640   000046 006000   000000 177640   000000 006014    .....&..........
  11     006   000000 177640   000000 006014   000007 777640   000132 006000    .............Z..
  11     012   000001 777640   000142 006000   000000 177640   000000 006014    .....b..........
  11     016   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     026*  000001 777640   000000 006000   000000 177640   000000 006014    ................
  11     032   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     046*  000000 000472   000000 001001   252525 002002   000040 252520    ............. ..
  11     052   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
  11     056   000000 000000   000000 000000   000000 000000   000000 000000    ................
  11     062   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
  11     066   040040 040040   000000 000000   000000 000000   000000 000000        ............
  11     072   000000 000000   ****** ******                                    ........

CLOSE_MAIL
 Sect OctLoc
  11     074   000003 777640   000126 006000   000000 177640   000000 006014    .....V..........
  11     100   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     124*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
  11     130   000220 000000   000000 000000                                    ........

MAIL_NAME
 Sect OctLoc
  11     132   037040 040040   040040 040040   040040 040040   040040 040040    .
  11     136   040040 040040   040040 040040   040040 040040   040040 040040

MAIL_PASS
 Sect OctLoc
  11     142   115101 111114   120101 123123                                    MAILPASS

READ_MAILCG
 Sect OctLoc
  11     144   000005 777640   000154 006000   000000 177640   000000 006014    .....l..........
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:22   
  11     150   000043 777640   000206 006000   000007 777640   000176 006000    .#...........~..
  11     154   000000 400000   000000 000000   000000 000000   000000 000000    ................
  11     160   000000 000000   000000 000000                                    ........

WRITE_MAILCG
 Sect OctLoc
  11     162   000003 777640   000172 006000   000000 177640   000000 006014    .....z..........
  11     166   000043 777640   000206 006000   000007 777640   000176 006000    .#...........~..
  11     172   000000 400400   000000 000000   000000 000000   000000 000000    ................

MAILMAN_STATION
 Sect OctLoc
  11     176   115101 111114   115101 116040   040040 040040   040040 040040    MAILMAN
  11     202   005000 000000   000000 000000   000000 000000   000000 000000    ................

VM_CGBUFFER
 Sect OctLoc
  11     206   040040 040040   040040 040040   000000 000000   000040 040040            .....
  11     212   040040 040040   040040 040040   040040 040040   040040 040040
  11     216   040040 040040   040040 000000   040040 040040   040040 040040          ..
  11     222   040040 040040   040040 040040   040040 040040   040040 040040
  11     226   040040 040040   040040 040040   000040 040040   040040 040040            .
  11     232   040040 040040   040040 040040   040040 040040   040040 040040
  11     236   040040 040040   040040 040040   ****** ******   040040 040040            ....
  11     242   040040 040040   040040 040040   040040 040040   040040 040040
  11     246   040040 040040   040040 040040   040040 040040   040040 040040

E_SENT
 Sect OctLoc
  12     000   261503 000340                                                    ....

(unnamed)
 Sect OctLoc
  12     001   103105 116124   122101 114040   107157 040141   167141 171041    CENTRAL Go away!

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:23   
  15     000   000000 006014   000003 000000   000000 006000   000000 006000    ................
  15     004   040040 040040   000006 000000   000000 000000   000006 006000        ............
  15     010   000006 006000   000006 006000   000002 000000   000000 006000    ................
  15     014   000001 000000                                                    ....
      176     9813
      177     9814    1   END VMC$DOSEND;

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:24   
--  Include file information  --

   XUR_ENTRY.:LIB_E05  cannot be made into a system file and is referenced.
   VO_SUBS_C.:VMB6TOU  is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMC$DOSEND.
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:25   

 **** Variables and constants ****

  ****  Section 011  Data  VMC$DOSEND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    74-0-0/d STRC(1080)  r     1 CLOSE_MAIL                 0-0-0/w STRC        r     1 ERROR
   176-0-0/w STRC(288)   r     1 MAILMAN_STATION          132-0-0/c STRC(288)   r     1 MAIL_NAME
   142-0-0/c STRC(72)    r     1 MAIL_PASS                  2-0-0/d STRC(2088)  r     1 OPEN_MAIL
   144-0-0/d STRC(504)   r     1 READ_MAILCG              206-0-0/c STRC(1296)  r     1 VM_CGBUFFER
   162-0-0/d STRC(432)   r     1 WRITE_MAILCG

  ****  Section 012 RoData VMC$DOSEND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 E_SENT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCB#                      4-0-0/w PTR         r     1 @SEED
    *0-0-0/w UBIN        r     1 DCB#                      *0-0-0/w UBIN        r     1 SEED

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/b BIT         r     1 GATEWAY
     0-0-0/w UBIN              1 M$DO_NUM                   0-0-0/w UBIN              1 M$LO_NUM
     0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM         0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:26   
     0-0-0/w UBIN              1 M$MAIL_FILE_NUM            0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM
     0-0-0/w UBIN        r     1 M$ME_NUM                   0-0-0/w UBIN              1 M$NODE_NUM
     0-0-0/w UBIN              1 M$SI_NUM                   0-0-0/w UBIN              1 M$WORK_NUM
     0-0-0/w PTR               1 VM_ADDLIST$                0-0-0/d VECT              1 VM_ADDLIST_
     0-0-0/w PTR               1 VM_ADDREC$                 0-0-0/d VECT              1 VM_ADDREC_
     0-0-0/w PTR               1 VM_COPY$                   0-0-0/d VECT              1 VM_COPY_
     0-0-0/w STRC(2529)  r     1 VM_CURRENT_FOLDER          0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR         r     1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)   r     1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)    r     1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)        1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$MAIL_CENTRAL
     0-0-0N  NULL        r     1 M$MAIL_COMGROUP            0-0-0N  NULL        r     1 M$MAIL_FILE
     0-0-0N  NULL        r     1 M$MAIL_GLOBAL              0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SEND
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$WORK                     0-0-0/w STRC(1332)  r     1 VM_HEADER
     0-0-0/c ASTR(9)     r     1 X$STRING

PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:27   

   Procedure VMC$DOSEND requires 128 words for executable code.
   Procedure VMC$DOSEND requires 14 words of local(AUTO) storage.

    No errors detected in file VMC$DOSEND.:VMB6TSI    .
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:28   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:29   
          MINI XREF LISTING

B$ALT.CODE
      9086**DCL      9086--REDEF    9087--REDEF    9087--REDEF
B$ALT.ERR
      9087**DCL      9806>>ASSIGN
B$ALT.ERR.ERR#
      9088**DCL      9088--REDEF
B$ALT.EVID
      9087**DCL      9087--REDEF    9087--REDEF
B$JIT.CPFLAGS1.SLEAZE
       457**DCL       457--REDEF
B$JIT.ERR.MID
       364**DCL       364--REDEF
B$JIT.JRESPEAK
       525**DCL       526--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       634**DCL       634--REDEF     635--REDEF
B$JIT.PNR
       538**DCL       538--REDEF
B$JIT.TSLINE
       632**DCL       633--REDEF
B$JIT$
      8473**DCL       358--IMP-PTR
B$TCB.ALT$
      9082**DCL      9806>>ASSIGN
B$TCB$
      8474**DCL      9082--IMP-PTR  9806>>ASSIGN
CLOSE_MAIL
      9537**DCL      9791<>CALL
CLOSE_MAIL.SN_
      9537**DCL      9537--REDEF
CLOSE_MAIL.UTL_
      9538**DCL      9538--REDEF
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:30   
CLOSE_MAIL.V
      9542**DCL      9537--DCLINIT
CLOSE_MAIL.V.EXPIRE#
      9552**DCL      9552--REDEF
CLOSE_MAIL.V.TYPE#
      9550**DCL      9550--REDEF
CLOSE_MAIL.V.XTNSIZE#
      9547**DCL      9547--REDEF    9549--REDEF
DCB#
      9076**DCL        34--PROC     9786<>CALL
ERRMSG_FID.L#
      8542**DCL      8542--IMP-SIZ
ERROR
      9290**DCL      9806<<ASSIGN   9807<>CALL     9810<<ASSIGN   9811<>CALL
E_MAILMAN
      9806**LABEL    9773--GOTO
E_PMME
      9800**LABEL    9752--CALLALT  9762--CALLALT  9768--CALLALT  9782--CALLALT  9786--CALLALT  9792--CALLALT
E_SENT
      9336**DCL      9753<>CALL     9802<>CALL
GATEWAY
      9079**DCL      9800>>IF
M$CLOSE
      6126**DCL-ENT  9791--CALL
M$ME_NUM
      8465**DCL      9753<>CALL     9802<>CALL
M$OPEN
      6126**DCL-ENT  9782--CALL
M$READ
      6127**DCL-ENT  9768--CALL
M$SEND
      9370**DCL      9786<>CALL     9807<>CALL
M$WRITE
      6127**DCL-ENT  9752--CALL     9762--CALL     9792--CALL
MAILMAN_STATION
      9692**DCL      9622--DCLINIT  9665--DCLINIT
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:31   
MAILMAN_STATION.MSGIDXT
      9702**DCL      9705--REDEF
MAIL_NAME
      9582**DCL      9470--DCLINIT  9788>>ASSIGN
MAIL_NAME.L#
      9582**DCL      9779<<ASSIGN
MAIL_NAME.NAME#
      9582**DCL      9778<<ASSIGN
MAIL_PASS
      9595**DCL      9471--DCLINIT
MAIL_PASS.PASS#
      9595**DCL      9780<<ASSIGN
OPEN_MAIL
      9469**DCL      9782<>CALL
OPEN_MAIL.ACSVEH_
      9471**DCL      9472--REDEF
OPEN_MAIL.ALTKEYS_
      9477**DCL      9478--REDEF    9478--REDEF
OPEN_MAIL.HDR_
      9476**DCL      9477--REDEF
OPEN_MAIL.TAB_
      9475**DCL      9476--REDEF
OPEN_MAIL.UHL_
      9469**DCL      9470--REDEF    9470--REDEF
OPEN_MAIL.V
      9478**DCL      9469--DCLINIT
OPEN_MAIL.V.FSN#
      9509**DCL      9509--REDEF    9509--REDEF
OPEN_MAIL.WSN_
      9475**DCL      9475--REDEF
READ_MAILCG
      9619**DCL      9768<>CALL
READ_MAILCG.STATION_
      9622**DCL      9623--REDEF
READ_MAILCG.V
      9623**DCL      9619--DCLINIT
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:32   
READ_MAILCG.V.DVBYTE.REREAD#
      9634**DCL      9634--REDEF
READ_MAILCG.V.INDX#
      9632**DCL      9632--REDEF
SEED
      9077**DCL        34--PROC     9786<>CALL
VMA$ERRMSG
      9274**DCL-ENT  9807--CALL     9811--CALL
VMM$COPY_MESSAGE_INTERSYS
      9275**DCL-ENT  9786--CALL
VM_CGBUFFER
      9718**DCL      9621--DCLINIT  9622--DCLINIT  9664--DCLINIT  9665--DCLINIT
VM_CGBUFFER.COMMAND
      9720**DCL      9751<<ASSIGN   9761<<ASSIGN   9772>>IF       9790<<ASSIGN
VM_CGBUFFER.ERROR
      9730**DCL      9810>>ASSIGN
VM_CGBUFFER.FILE_NAME
      9727**DCL      9788<<ASSIGN
VM_CGBUFFER.FILE_NAME.COUNT
      9728**DCL      9779>>ASSIGN
VM_CGBUFFER.FILE_NAME.TEXT
      9729**DCL      9778>>ASSIGN
VM_CGBUFFER.STATION#
      9719**DCL      9789<<ASSIGN
VM_CURRENT_FOLDER.ACCT
      9234**DCL      9745>>IF
VM_CURRENT_FOLDER.FOLDER
      9236**DCL      9745>>IF
VM_HEADER.SUBJECT$
      9204**DCL      9745>>IF       9745>>IF       9745>>IF
VM_HEADER$
      8392**DCL      9102--IMP-PTR  9745>>IF       9745>>IF       9745>>IF
VM_MAILCG_SETSTA.MYSTATION#
      8683**DCL      9789>>ASSIGN
VM_MAIL_ACCT
      8488**DCL      9474--DCLINIT
PL6.E3A0      #001=VMC$DOSEND File=VMC$DOSEND.:VMB6TSI                           WED 08/20/97 15:07 Page:33   
VM_MAIL_ACCT.ACCT#
      8488**DCL      9745>>IF
WRITE_MAILCG
      9663**DCL      9752<>CALL     9762<>CALL     9792<>CALL
WRITE_MAILCG.STATION_
      9665**DCL      9665--REDEF
WRITE_MAILCG.V
      9666**DCL      9663--DCLINIT
WRITE_MAILCG.V.DVBYTE.VFC#
      9672**DCL      9672--REDEF
X$STRING.SIZ
      8388**DCL      8389--IMP-SIZ  9745>>IF
X$STRING.TEXT
      8389**DCL      9745>>IF
XUR$INFOMSG
      9059**DCL-ENT  9753--CALL     9802--CALL
