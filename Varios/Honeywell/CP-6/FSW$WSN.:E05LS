VERSION E05

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:1    
        1        1        /*M* FSW$WSN Prepares destinations for symbiont files.*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* ICP,MOC,DMR,CLM=8 */
        8        8        /*P*    NAME:    FSW$WSN
        9        9                PURPOSE: FSW$WSN validates workstation, device, and form
       10       10                         names when a symbiont file is being opened,
       11       11                         and returns attributes of the wsn/device/form.
       12       12        */
       13       13        /*F*    NAME:    FSW$DESTFORM
       14       14                PURPOSE: FSW$DESTFORM is called to validate workstation,
       15       15                         device, and form names whenever a symbiont file
       16       16                         is being created for a destination that has not
       17       17                         previously been validated.
       18       18                         For validated destinations (LDEV not SCRUB), the
       19       19                         routine FSW$FORM is used instead.
       20       20                DESCRIPTION: Open :WSN.:SYS.  Read record for workstation.
       21       21                         Find device in record.  If user didn't specify
       22       22                         form name, get default form.  Open :FORM.:SYS.
       23       23                         Read record for form.
       24       24        */
       25       25        /*D*    NAME:    FSW$DESTFORM
       26       26                CALL:    CALL  FSW$DESTFORM(DEST$,BUF$,JIT$)ALTRET;
       27       27                INPUT:   B$JIT.DCB$ points to a DCB for the symbiont file.
       28       28                         The DCB's WSN and RES fields specify a workstation
       29       29                         and device.  The DCB's FORM$ if not nil points to a
       30       30                         CODE16 which may or may not specify a form name.
       31       31                         DEST$ if not NIL points to a FS$DEST area which
       32       32                         has had various parameters filled in by LDEV;
       33       33                         if NIL, a FS$DEST area is built at the end of BUF$.
       34       34                         BUF$ points to a stolen file management buffer page
       35       35                         which is used as a buffer.
       36       36                         JIT$ points to a JIT whose ACCN is used as the
       37       37                         authorization-check account.
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:2    
       38       38                OUTPUT:  The DCB's ATTR and DDEV are filled in from the
       39       39                         device definition.
       40       40                         The DCB's WIDTH and LINES fields are filled in
       41       41                         from the form definition.
       42       42                         The DCB's CODE16 has been filled in from the
       43       43                         device definition, the form definition, and the
       44       44                         FS$DEST.  It has been acquired if DCB.FORM$ was nil.
       45       45                         BUF$ holds the form definition record.  It will
       46       46                         be used later for making a banner.
       47       47                         DEST$ holds a filled-out FS$DEST area for OUTSYM.
       48       48                DESCRIPTION:
       49       49        */
       50       50        FSW$DESTFORM: PROC(DEST$,BUF$,JIT$) ALTRET;
       51       51        /* PARAMETERS */
       52       52    1   DCL DEST$ PTR;
       53       53    1   DCL BUF$ PTR;
       54       54    1   DCL JIT$ PTR;
       55       55        /* INCLUDE FILES */
       56       56        %INCLUDE B$JIT;
       57      659        %MACRO F$DCBI(BASED=BASED);
       58      660        %INCLUDE F$DCB;
       59      709        %MEND;
       60      710        %INCLUDE FS$FIT;
       61      753        %INCLUDE F_MACROS_C;
       62      764        %INCLUDE F_CP6;
       63     1789        %INCLUDE KL_SUPER_C;
       64     4691        %INCLUDE FS_SUPER_C;
       65     5454        %INCLUDE CP_6_SUBS;
       66     5994        %INCLUDE F_ERRORS_C;
       67     6234        %INCLUDE FM$FIT;
       68     6455        %INCLUDE JG_GHOSTS_C;
       69     6545        %INCLUDE NK_VFC_C;
       70     6619        %INCLUDE F_FPTCODE_C;
       71     6655        %INCLUDE XG_SUBS_C;
       72     7149        /* EXTERNAL STORAGE */
       73     7150    1   DCL B$JIT$ PTR SYMREF;
       74     7151        /* LOCAL AUTOMATIC STORAGE */
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:3    
       75     7152    1   DCL JDCB$ PTR;
       76     7153    1   DCL STAR$ PTR;
       77     7154    1   DCL WT$ PTR;
       78     7155    1   DCL BANNER$ PTR;
       79     7156    1   DCL I UBIN;
       80     7157    1   DCL J UBIN;
       81     7158    1   DCL 1 KEY,
       82     7159    1         2 L UBIN BYTE UNAL,
       83     7160    1         2 C CHAR(11);
       84     7161        %FPT_READ(FPTN=AUTOREAD,STCLASS=);
       85     7200    1   DCL TEMPATTR BIT(36);
       86     7201    1   DCL ERRSAVE BIT(36);
       87     7202    1   DCL WILD_X UBIN;
       88     7203    1   DCL WILD_XC REDEF WILD_X CHAR(4);
       89     7204    1   DCL WILD_XP UBIN;
       90     7205    1   DCL COMPARE_X UBIN;
       91     7206    1   DCL COMPARE_XP UBIN;
       92     7207    1   DCL COMPACCT CHAR(8);
       93     7208    1   DCL MINGLCLLP BIT(1);
       94     7209        /* EXTERNAL ROUTINES */
       95     7210    1   DCL FMP$CLSJ ENTRY;
       96     7211    1   DCL FMM$DFLOPNP ENTRY; /* Default open, Privileged. */
       97     7212    1   DCL FSA$GSP ENTRY(2)ALTRET; /* Gets ROSEG space */
       98     7213    1   DCL FMM$SCRUB ENTRY(1);
       99     7214    1   DCL M$MREAD ENTRY(1)ALTRET;
      100     7215    1   DCL FOT$TCHK ENTRY(2)ALTRET;
      101     7216    1   DCL FOT$DCHK ENTRY(2)ALTRET;
      102     7217    1   DCL KIA$UCIO ENTRY(5)ALTRET;
      103     7218        /* CONSTANT STORAGE */
      104     7219        %FPT_READ(FPTN=CONSTREAD,STCLASS=CONSTANT,KEYS=YES);
      105     7258        %VLP_NAME(FPTN=WSNNAME,STCLASS=CONSTANT,NAME=':WSN');
      106     7285        %VLP_NAME(FPTN=FORMNAME,STCLASS=CONSTANT,NAME=':FORM');
      107     7312        %SUB FCG#='0623'O;
      108     7313        %SUB MID#='27'O;
      109     7314        %ERRCODE(NAME=ERR_ILLWSN,COD#=%E$INVWSN);
      110     7318        /*E*    ERROR: FSW-E$INVWSN-2
      111     7319                MESSAGE: No such workstation.
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:4    
      112     7320         */
      113     7321        %ERRCODE(NAME=ERR_CANTWSN,COD#=%E$CANTWSN);
      114     7325        /*E*    ERROR: FSW-E$CANTWSN-2
      115     7326                MESSAGE: You aren't authorized to use that workstation.
      116     7327         */
      117     7328        %ERRCODE(NAME=ERR_ILLDEV,COD#=%E$INVDEV);
      118     7332        /*E*    ERROR: FSW-E$INVDEV-2
      119     7333                MESSAGE: There is no such device at that workstation.
      120     7334         */
      121     7335        %ERRCODE(NAME=ERR_NOTOUT,COD#=%E$ILLOUT);
      122     7339        /*E*    ERROR: FSW-E$ILLOUT-2
      123     7340                MESSAGE: That device can not be written.
      124     7341         */
      125     7342        %ERRCODE(NAME=ERR_ILLATTR,COD#=%E$CANTATTR);
      126     7346        /*E*    ERROR: FSW-E$CANTATTR-2
      127     7347                MESSAGE: That device doesn't have the requested attributes.
      128     7348         */
      129     7349        %ERRCODE(NAME=ERR_INVFORM,COD#=%E$INVFORM);
      130     7353        /*E*    ERROR:   FSW-E$INVFORM-2
      131     7354                MESSAGE: No form exists with that name.
      132     7355        */
      133     7356        %ERRCODE(NAME=ERR_CANTFORM,COD#=%E$CANTFORM);
      134     7360        /*E*    ERROR:   FSW-E$CANTFORM-2
      135     7361                MESSAGE: That form is not available for that device.
      136     7362        */
      137     7363        %ERRCODE(NAME=ERR_NOTAUTHFORM,COD#=%E$NOTAUTHFORM);
      138     7367        /*E*    ERROR: FSW-E$NOTAUTHFORM-2
      139     7368                MESSAGE: You aren't authorized to use that form.
      140     7369        */
      141     7370        %KL_WTBLK(NAME=FSW_WTBLK,STCLASS="CONSTANT SYMDEF",
      142     7371                TTNAME='LOCAL',FFNAME='STDLP',DDDEV=%DDEV_LP#,
      143     7372                IINPUT='0'B,OOUTPUT='1'B);
      144     7406        %FS$FORMREC(NAME=FSW_FORMREC,
      145     7407                      FRMNAME='STDLP ',
      146     7408                      STCLASS="CONSTANT SYMDEF",
      147     7409                      ACCDISP=0,
      148     7410                      ACCTSDISP=0,
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:5    
      149     7411                      WDTH=132,
      150     7412                      LNGTH=39,
      151     7413                      LMBO=6,
      152     7414                      FLINE=6,
      153     7415                      LP_OK=YES,
      154     7416                      TS_OK=YES);
      155     7487        %FS$BAN_INIT(NAME=FSW_FORMREC_BAN,
      156     7488                      STCLASS="CONSTANT SYMDEF",
      157     7489                      CNT=13,
      158     7490                      REPTS=2,
      159     7491                      INR=1
      160     7492                           );
      161     7549        %FS$BAN_ENT(ROW=1,COL=1,TYPE=FS_DATE_INT);
      162     7586        %FS$BAN_ENT(ROW=1,COL=10,TYPE=FS_TIME_INT);
      163     7623        %FS$BAN_ENT(ROW=1,COL=18,TYPE=FS_ACCN_INT);
      164     7660        %FS$BAN_ENT(ROW=1,COL=27,TYPE=FS_UNAME_INT);
      165     7697        %FS$BAN_ENT(ROW=1,COL=40,TYPE=FS_WOO_INT);
      166     7734        %FS$BAN_ENT(ROW=1,COL=50,TYPE=FS_SYSID_INT);
      167     7771        %FS$BAN_ENT(ROW=3,COL=1,FONT=1,STRIKES=2,ICSH=1,TYPE=FS_PLAIN_TEXT,TEXT='Honeywell')
              7771            ;
      168     7808        %FS$BAN_ENT(ROW=3,COL=80,STRIKES=2,TYPE=FS_LOGO_INT);
      169     7845        %FS$BAN_ENT(ROW=15,COL=1,TYPE=FS_PLAIN_TEXT,TEXT='VERSION',REPS=3,RINC=2);
      170     7882        %FS$BAN_ENT(ROW=15,COL=9,TYPE=FS_VERSION_INT,REPS=3,RINC=2);
      171     7919        %FS$BAN_ENT(ROW=15,COL=20,TYPE=FS_SYSID_INT,FONT=1,STRIKES=2,ICSH=1);
      172     7956        %FS$BAN_ENT(ROW=26,COL=10,FONT=1,STRIKES=3,ICSH=1,TYPE=FS_UNAME_INT);
      173     7993        %FS$BAN_ENT(ROW=45,COL=1,REPS=2,TYPE=FS_X_INT,TEXT='*');
      174     8030        %FS$BAN_GEN;
      175     8049    1   DCL 1 MOVEBANNER BASED,
      176     8050    1         2 * CHAR(PL6ISDUMB);
      177     8051    1   DCL PL6ISDUMB UBIN CONSTANT INIT(SIZEC(FSW_FORMREC_BAN));
      178     8052        /**/
      179     8053        /* BASED STRUCTURES */
      180     8054        %F$DCBI (BASED="BASED(JDCB$)");
      181     8104        %FS$DEST (STCLASS="BASED(DEST$)",SIZ=FIT);
      182     8112        %CODE16;
      183     8120        %KL_WSNHDR(STCLASS="BASED(BUF$)");
      184     8131        %KL_INDIRECT_WSN(STCLASS="BASED(BUF$)");
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:6    
      185     8139        %KL_WTBLK(STCLASS="BASED(WT$)");
      186     8173        %KL_ACBLK(STCLASS="BASED(WT$)");
      187     8178        %FS$GFORMREC (NAME=GFORM,
      188     8179                      STCLASS="BASED(BUF$)");
      189     8238        %FS$FORMREC(STCLASS="BASED(BUF$)");
      190     8309        %FS$ACCT_INIT(NAME=FS$ACCT,STCLASS="BASED(WT$)");
      191     8323        %FS$BAN_INIT (NAME=BANNER,
      192     8324                    STCLASS = "BASED (BANNER$)" );
      193     8381    1   DCL 1 ZERO_VFC_IM CONSTANT,
      194     8382    1         2 LINE (0:31) UBIN (9) UNAL INIT (0*0),
      195     8383    1         2 NEXT (0:31) UBIN (9) UNAL INIT (0*0);
      196     8384        /**/
      197     8385        /**/
      198     8386    1           CALL SETUP ALTRET(ALTR);
      199     8387    2           IF DEST$=ADDR(NIL) THEN DO;
      200     8388    2              DEST$=PINCRW(BUF$,1024-SIZEW(FS$DEST));
      201     8389    2              FS$DEST='0'B;
      202     8390    2              FS$DEST.SIZ=SIZEW(FS$DEST)-1;
      203     8391    2              FS$DEST.COPIES=F$DCB.FORM$->CODE16.COPIES;
      204     8392    2              IF FS$DEST.COPIES=0 THEN
      205     8393    2                 FS$DEST.COPIES=1;
      206     8394    2              END;
      207     8395    1           FS$DEST.PRIO=JIT$->B$JIT.OUTPRIO;
      208     8396    1           IF B$JIT.SYSID<=JG_MING# AND B$JIT.SYSID~=JG_INSYM# THEN
      209     8397    1              FS$DEST.PRIO=15;
      210     8398    1           FS$DEST.MODE=B$JIT.MODE;
      211     8399    1           FS$DEST.JOBNAME=B$JIT.JOBNAME;
      212     8400    1           CALL READWSN ALTRET(TRUERR);
      213     8401    1           IF KL_INDIRECT_WSN.INDIRECT# THEN RETURN;
      214     8402    1   PASS2WSN:
      215     8403    1           FS$DEST.ATTR=F$DCB.ATTR;
      216     8404    1           FS$DEST.DDEV=F$DCB.DDEV;
      217     8405    1           FS$DEST.DT.DEV=F$DCB.RES;
      218     8406    1           FS$DEST.DT.WSN=F$DCB.WSN;
      219     8407    1           GOTO ONTOFORM;
      220     8408    1   FSW$FORM: ENTRY(DEST$,BUF$) ALTRET;
      221     8409    1           CALL SETUP ALTRET(ALTR);
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:7    
      222     8410    1   ONTOFORM:;
      223     8411    1           KEY.C=F$DCB.FORM$->CODE16.FORM;
      224     8412    1           CALL OPENSTAR(FORMNAME) ALTRET(STDFONLY);
      225     8413    1           CALL READFORMNOOPEN ALTRET (STDFONLY);
      226     8414    2           DO WHILE('0'B);
      227     8415    2   STDFONLY:  IF KEY.C~='STDLP' THEN GOTO ERR$ILLFORM;
      228     8416    2              FS$FORMREC=FSW_FORMREC;
      229     8417    2              FS$FORMREC.BANRDISP=SIZEW(FS$FORMREC);
      230     8418    2              PINCRW(ADDR(FS$FORMREC),SIZEW(FS$FORMREC))->MOVEBANNER=
      231     8419    2                FSW_FORMREC_BAN;
      232     8420    2              END;
      233     8421    1           CALL FOT$TCHK(FS$FORMREC,FS$DEST.DT.WSN)ALTRET(ERR$CANTFORM);
      234     8422    1           CALL FOT$DCHK(FS$FORMREC,FS$DEST.DT.DEV)ALTRET(ERR$CANTFORM);
      235     8423    2           IF FS$FORMREC.ACCTDISP~=0 THEN DO;
      236     8424    2              WT$=PINCRW(ADDR(FS$FORMREC),FS$FORMREC.ACCTDISP);
      237     8425    3              IF FS$ACCT.TACCTS~=0 THEN DO;
      238     8426    3                 IF ADDR(JIT$)=ADDR(NIL) THEN COMPACCT=B$JIT.ACCN;
      239     8427    3                 ELSE IF JIT$->B$JIT.ERR THEN COMPACCT=B$JIT.ACCN;
      240     8428    3                    ELSE COMPACCT=JIT$->B$JIT.ACCN;
      241     8429    3                 J=0;
      242     8430    4   NEXTACCT:     IF J=FS$ACCT.TACCTS THEN DO;
      243     8431    4                    ERRSAVE=ERR_NOTAUTHFORM;
      244     8432    4                    GOTO MEBBETRUERR;
      245     8433    4                    END;
      246     8434                      %WILD_COMPARE(WILD_CHARS="FS$ACCT.LIST(J)",
      247     8435                      COMPARE_CHARS=COMPACCT,
      248     8436                      NO_MATCH="DO;J=J+1;GOTO NEXTACCT;END");
      249     8507    3                 END;
      250     8508    2              END;
      251     8509    1           FS$DEST.FORM=FS$FORMREC.FNAME;
      252     8510    1           IF FS$FORMREC.GRAPHIC
      253     8511    2           THEN DO;
      254     8512    2              FS$DEST.FWIDTH = 0;
      255     8513    2              FS$DEST.FLINES = 0;
      256     8514    2              END;
      257     8515    2           ELSE DO;
      258     8516    2              FS$DEST.FWIDTH = FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:8    
      259     8517    2              FS$DEST.FLINES = FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;
      260     8518    2              END;
      261     8519    1           TEMPATTR=F$DCB.FORM$->CODE16.NSFORM;
      262     8520    1           F$DCB.FORM$->CODE16='0'B;
      263     8521    1           F$DCB.FORM$->CODE16.NSFORM=TEMPATTR;
      264     8522    1           F$DCB.FORM$->CODE16.FORM=KEY.C;
      265     8523    1           F$DCB.FORM$->CODE16.COPIES=FS$DEST.COPIES;
      266     8524    1           F$DCB.FORM$->CODE16.ATTR = FS$FORMREC.ATTR;
      267     8525    1           F$DCB.ATTR = FS$FORMREC.ATTR;
      268     8526    1   FORMCONTUR:;
      269     8527    1           IF FS$FORMREC.GRAPHIC
      270     8528    2           THEN DO;
      271     8529    2              F$DCB.LINES = 0;
      272     8530    2              F$DCB.WIDTH = 0;
      273     8531    2              F$DCB.DDEV = %DDEV_GR#;
      274     8532    2              END;
      275     8533    2           ELSE DO;
      276     8534    2              IF F$DCB.LINES=0 OR
      277     8535    2                F$DCB.LINES>FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
      278     8536    3              THEN DO;
      279     8537    3                 F$DCB.LINES=FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;
      280     8538    3                 END;
      281     8539    2              IF F$DCB.WIDTH=0 OR
      282     8540    2                F$DCB.WIDTH>FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH
      283     8541    3              THEN DO;
      284     8542    3                 F$DCB.WIDTH=FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH;
      285     8543    3                 IF FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID
      286     8544    3                 THEN
      287     8545    3                    F$DCB.WIDTH = F$DCB.WIDTH + 254;
      288     8546    3                 END;
      289     8547    2              END;
      290     8548    1           IF F$DCB.DVFC=BINASC(0) THEN
      291     8549    1              F$DCB.DVFC='A';
      292     8550    1           F$DCB.FORM$->CODE16.GOOD = '1'B;
      293     8551    1           F$DCB.FORM$->CODE16.DVFC = F$DCB.DVFC;
      294     8552    1           F$DCB.FORM$->CODE16.DDEV = F$DCB.DDEV;
      295     8553    1           F$DCB.FORM$->CODE16.WSN = F$DCB.WSN;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:9    
      296     8554    1           F$DCB.FORM$->CODE16.DEV = F$DCB.RES;
      297     8555    1           IF NOT FS$FORMREC.GRAPHIC
      298     8556    2           THEN DO;
      299     8557    2              F$DCB.FORM$->CODE16.VFCIM = FS$FORMREC.SOFTFORM.VFUIM.V;
      300     8558    2              F$DCB.FORM$->CODE16.LINES = F$DCB.LINES;
      301     8559    2              F$DCB.FORM$->CODE16.LINENO = F$DCB.LINES;
      302     8560    2              F$DCB.FORM$->CODE16.WIDTH = F$DCB.WIDTH;
      303     8561    2              F$DCB.FORM$->CODE16.CONTFORM =
      304     8562    2                (FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO=0) &
      305     8563    2                (FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE=0);
      306     8564    2              END;
      307     8565    2           ELSE DO;
      308     8566    2              F$DCB.FORM$->CODE16.VFCIM = ZERO_VFC_IM;
      309     8567    2              F$DCB.FORM$->CODE16.LINES = 0;
      310     8568    2              F$DCB.FORM$->CODE16.WIDTH = 0;
      311     8569    2              F$DCB.FORM$->CODE16.LINENO = 0;
      312     8570    2              F$DCB.FORM$->CODE16.CONTFORM = '1'B;
      313     8571    2              END;
      314     8572                /* Get the banner repeats and charges from the form record
      315     8573                   and place them in the CODE16 block.
      316     8574                */
      317     8575    1           IF FS$FORMREC.BANRDISP = 0
      318     8576    2           THEN DO;
      319     8577    2              F$DCB.FORM$->CODE16.BANNER_REPEATS = 0;
      320     8578    2              F$DCB.FORM$->CODE16.BANNER_CHARGES = '0'B;
      321     8579    2              END;
      322     8580    2           ELSE DO;
      323     8581    2              BANNER$ = PINCRW (ADDR(FS$FORMREC), FS$FORMREC.BANRDISP);
      324     8582    2              F$DCB.FORM$->CODE16.BANNER_REPEATS = BANNER.REPEATS;
      325     8583    2              F$DCB.FORM$->CODE16.BANNER_CHARGES = '1'B;
      326     8584    2              IF BANNER.CHARGE = 0
      327     8585    3              THEN DO;
      328     8586    3                 F$DCB.FORM$->CODE16.BANNER_CHARGES = '0'B;
      329     8587    3                 END;
      330     8588    2              END;
      331     8589    1           CALL CLSTAR;
      332     8590    1           B$JIT.DCB$=JDCB$;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:10   
      333     8591    1           RETURN;
      334     8592    1   FSW$UCFORM: ENTRY(DEST$,BUF$)ALTRET;
      335     8593    1           CALL SETUPUC;
      336     8594    1           KEY.C=F$DCB.PSN;
      337     8595    1           CALL READFORM ALTRET(ERR$ILLFORM);
      338     8596    1           IF FS$FORMREC.GRAPHIC
      339     8597    2           THEN DO;
      340     8598    2              GOTO ERR$CANTFORM;
      341     8599    2              END;
      342     8600    1           IF NOT FS$FORMREC.LGLTYPS.TSOK THEN
      343     8601    1              GOTO ERR$CANTFORM;
      344     8602    1           CALL CLSTAR;
      345     8603    1           B$JIT.DCB$=JDCB$;
      346     8604    1           F$DCB.WAIT=1;
      347     8605    1           F$DCB.TYC(1)='0'B;
      348     8606    1           F$DCB.UB$=ADDR(FS$FORMREC.SOFTFORM.VLPPLATEN);
      349     8607    1           F$DCB.UBYTES=SIZEC(FS$FORMREC.SOFTFORM.VLPPLATEN);
      350     8608    1           CALL KIA$UCIO(MFC_WRITE,%DVBYTE_TRANS#|%DVBYTE_VFC#|%DVBYTE_BP#,
      351     8609    1             %VFC_SPM,0)ALTRET(ERR$UCIO);
      352     8610    1           F$DCB.WIDTH=FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH;
      353     8611    1           IF FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID
      354     8612    1           THEN
      355     8613    1              F$DCB.WIDTH = F$DCB.WIDTH + 254;
      356     8614    1           F$DCB.LINES=FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;
      357     8615    1           F$DCB.UB$=ADDR(FS$FORMREC.SOFTFORM.VFUIM);
      358     8616    1           F$DCB.UBYTES=SIZEC(FS$FORMREC.SOFTFORM.VFUIM);
      359     8617    1           CALL KIA$UCIO(MFC_WRITE,%DVBYTE_TRANS#|%DVBYTE_VFC#|%DVBYTE_BP#,
      360     8618    1             %VFC_SPM,0)ALTRET(ERR$UCIO);
      361     8619    1           B$JIT.ERR='0'B;
      362     8620    1           RETURN;
      363     8621        /**/
      364     8622    1   FSW$URFORM: ENTRY(DEST$,BUF$)ALTRET;
      365     8623    1           CALL SETUP ALTRET(ALTR);
      366     8624    1           IF F$DCB.FORM$->CODE16.FORM<=' ' THEN
      367     8625    1              F$DCB.FORM$->CODE16.FORM=FSW_WTBLK.FNAME;
      368     8626    1           KEY.C=F$DCB.FORM$->CODE16.FORM;
      369     8627    1           I = F$DCB.FORM$->CODE16.COPIES;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:11   
      370     8628    1           CALL READFORM ALTRET(ERR$ILLFORM);
      371     8629    1           F$DCB.FORM$->CODE16='0'B;
      372     8630    1           F$DCB.FORM$->CODE16.FORM=KEY.C;
      373     8631    1           IF I > 1 THEN
      374     8632    1              F$DCB.FORM$->CODE16.COPIES = I;
      375     8633    1           ELSE
      376     8634    1              F$DCB.FORM$->CODE16.COPIES = 1;
      377     8635    1           IF FS$FORMREC.GRAPHIC
      378     8636    2           THEN DO; /* THIS IS GRAPHICS- SET DDEV */
      379     8637    2              F$DCB.FORM$->CODE16.ATTR = %ATTR_NOXLATE# ;
      380     8638    2              F$DCB.DDEV=%DDEV_GR#;
      381     8639    2              END;
      382     8640    2           ELSE DO;
      383     8641    3              IF FS$FORMREC.LGLTYPS.LPOK THEN DO;
      384     8642    3                 F$DCB.FORM$->CODE16.ATTR=%ATTR_TRUOVRPRT#|%ATTR_LOWERCASE#|%
              8642                          ATTR_UPPERCASE#;
      385     8643    3                 F$DCB.DDEV=%DDEV_LP#;
      386     8644    3                 END;
      387     8645    3              ELSE DO;
      388     8646    3                 F$DCB.FORM$->CODE16.ATTR=%ATTR_BIN#|%ATTR_LOWERCASE#|%ATTR_UPPERCASE#;
      389     8647    3                 F$DCB.DDEV='0'B;
      390     8648    3                 END;
      391     8649    2              END;
      392     8650    1           GOTO FORMCONTUR;
      393     8651        /**/
      394     8652    1   ERR$UCIO:;
      395     8653    1           ERRSAVE=B$JIT.ERR;
      396     8654    1           GOTO TRUERR;
      397     8655    1   ERR$ILLFORM:;
      398     8656    1           ERRSAVE=ERR_INVFORM;
      399     8657    1           GOTO MEBBETRUERR;
      400     8658    1   ERR$CANTFORM:;
      401     8659    1           ERRSAVE=ERR_CANTFORM;
      402     8660    1   MEBBETRUERR:;
      403     8661    1           IF ADDR(JIT$)=ADDR(NIL) THEN GOTO TRUERR;
      404     8662    1           CALL OPENSTAR(WSNNAME);
      405     8663    1           CALL READWSNERR ALTRET(TRUERR);
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:12   
      406     8664    1           GOTO PASS2WSN;
      407     8665    1   TRUERR: ;
      408     8666    1           CALL CLSTAR;
      409     8667    1           B$JIT.ERR=ERRSAVE;
      410     8668    1           B$JIT.DCB$=JDCB$;
      411     8669    1   ALTR:   ALTRETURN;
      412     8670        /**/
      413     8671    1   READFORM: PROC ALTRET;
      414     8672    2           CALL OPENSTAR(FORMNAME) ALTRET(ALTR);
      415     8673    2   READFORMNOOPEN: ENTRY ALTRET;
      416     8674    2           KEY.L=6;
      417     8675    2           CALL M$MREAD(AUTOREAD) ALTRET(ALTRIFLD);
      418     8676    2           RETURN;
      419     8677    2   ALTRIFLD: IF B$JIT.ERR.CODE = %E$LD THEN RETURN;
      420     8678    2   ALTR:   ALTRETURN;
      421     8679    2   END READFORM;
      422     8680        %EJECT;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:13   
      423     8681    1   READWSN: PROC ALTRET;
      424     8682        /*      Find record for DCB's WSN in :WSN.:SYS; find entry for
      425     8683                DCB's RES in that record.  If successful, set up --
      426     8684                F$DCB has RES, WSN, ATTR, DDEV.
      427     8685                CODE16 has default FORM if it didn't have a Form.
      428     8686                   It has been verified that WSN exists, RES exists as
      429     8687                a device, user can access the wsn, user-specified ATTRs
      430     8688                are available at the device, and device can be written.
      431     8689                   This code is invoked for INSYM and PRESCAN via special
      432     8690                kludgery to do authorization checks as if they were
      433     8691                someone else; they pass a JIT, and this code looks at
      434     8692                ACCN and WOO in the JIT.
      435     8693                   For INSYM, the kludgery is simply that the passed
      436     8694                JIT's ACCN instead of INSYM's is used for auth checks.
      437     8695                   For PRESCAN, it is a little more complicated.  The
      438     8696                idea is to end up with a DCB open to a place where PRESCAN
      439     8697                can report the fact that it couldn't access another place.
      440     8698                Hence, it works like this.  First pass, we see if the user
      441     8699                represented by ACCN in the passed JIT can access the
      442     8700                place specified by WSN and RES in the DCB.  If so, fine;
      443     8701                return.  If not, put reason why not in the   p a s s e d
      444     8702                JIT, and try again using WOO in the passed JIT to replace
      445     8703                DCB.WSN.  The second time, make no ACCN authorization
      446     8704                checks at all; this is PRESCAN doing its best to report
      447     8705                the error.
      448     8706        */
      449     8707    2           IF F$DCB.WSN=' ' OR F$DCB.WSN='@' THEN
      450     8708    2              F$DCB.WSN=B$JIT.WOO;
      451     8709    2           IF B$JIT$ = JIT$
      452     8710    2             AND B$JIT.SYSID <= JG_MING#
      453     8711    2             AND F$DCB.WSN = 'LOCAL'
      454     8712    2             AND SUBSTR(F$DCB.RES,0,2)= 'LP'
      455     8713    2           THEN
      456     8714    2              MINGLCLLP = '1'B; /* MING want the local line printer */
      457     8715    2           ELSE
      458     8716    2              MINGLCLLP = '0'B;
      459     8717    2           JIT$->B$JIT.ERR='0'B;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:14   
      460     8718    2           CALL OPENSTAR(WSNNAME) ALTRET(LOCALONLY);
      461     8719    2   PRESCANRETRY:;
      462     8720    2           KEY.L=9;
      463     8721    2           CALL CONCAT(KEY.C,F$DCB.WSN,'*');
      464     8722    2           CALL M$MREAD(AUTOREAD)ALTRET(LOCALONLY);
      465     8723    3           IF KL_WSNHDR.ACCSDISP~=0 THEN DO;
      466     8724    3              WT$=PINCRW(BUF$,KL_WSNHDR.ACCSDISP);
      467     8725    4              IF KL_ACBLK.ACCTS>0 AND NOT MINGLCLLP THEN DO;
      468     8726    4                 J=0;
      469     8727    5   NEXTACCT:     IF J=KL_ACBLK.ACCTS THEN DO;
      470     8728    5                    ERRSAVE=ERR_CANTWSN;
      471     8729    5                    IF JIT$=B$JIT$ OR B$JIT.SYSID~=%JG_PRESCAN# THEN
      472     8730    5                       ALTRETURN;
      473     8731    6                    IF NOT JIT$->B$JIT.ERR THEN DO; /* first pass */
      474     8732    6                       JIT$->B$JIT.ERR=ERRSAVE;
      475     8733    6                       JIT$->B$JIT.ERR.MON='1'B;
      476     8734    7                       IF JIT$->B$JIT.WOO~=F$DCB.WSN THEN DO;
      477     8735    7                          F$DCB.WSN=JIT$->B$JIT.WOO;
      478     8736    7                          GOTO PRESCANRETRY;
      479     8737    7                          END;
      480     8738    6                       END;
      481     8739    5                    END;
      482     8740    5                 ELSE DO;
      483     8741                         %WILD_COMPARE(WILD_CHARS="KL_ACBLK.LIST(J)",
      484     8742                         COMPARE_CHARS="JIT$->B$JIT.ACCN",
      485     8743                         NO_MATCH="DO;J=J+1;GOTO NEXTACCT;END");
      486     8814    5                    END;
      487     8815    4                 END;
      488     8816    3              END;
      489     8817    3           IF KL_INDIRECT_WSN.INDIRECT# THEN DO;
      490     8818    3              F$DCB.ACCT = KL_INDIRECT_WSN.INDIRECT_WSN;
      491     8819    3              F$DCB.PASS = KL_INDIRECT_WSN.NODE;
      492     8820    3              RETURN;
      493     8821    3              END; /*  INDIRECT#  */
      494     8822    2           WT$=ADDR(NIL); /*MEANS NO SUCH DEV TYPE*/
      495     8823    2           I=0;
      496     8824    3           DO WHILE (I<KL_WSNHDR.NTYP);
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:15   
      497     8825    4              IF SUBSTR(F$DCB.RES,0,2)=KL_WSNHDR.TYPS.TYP(I) THEN DO;
      498     8826    4                 WT$=PINCRW(BUF$,KL_WSNHDR.TYPS.DISP(I));
      499     8827    5                 IF NOT KL_WTBLK.IO.OUTPUT THEN DO;
      500     8828    5                    ERRSAVE=ERR_NOTOUT; GOTO ERR; END;
      501     8829    4                 TEMPATTR='777777777777'O; /*MEANS NO GOOD ATTRS*/
      502     8830    4                 J=0;
      503     8831    5                 DO WHILE (J<KL_WTBLK.NATR);
      504     8832    5                    IF NOT(F$DCB.ATTR&~KL_WTBLK.ATTRS(J)) THEN
      505     8833    5                       TEMPATTR=TEMPATTR&KL_WTBLK.ATTRS(J);
      506     8834    5                    J=J+1;
      507     8835    5                    END;
      508     8836    4                 IF TEMPATTR~='777777777777'O THEN GOTO GOTAGOOD;
      509     8837    4                 END;
      510     8838    3              I=I+1;
      511     8839    3              END;
      512     8840                /* oops */
      513     8841        /* There was no device.  Check if this was a MING opening LP@LOCAL */
      514     8842    2           IF MINGLCLLP
      515     8843    2           THEN
      516     8844    2              GOTO LOCALONLY;
      517     8845    2           IF WT$=ADDR(NIL) THEN
      518     8846    2   ERR$ILLDEV: ERRSAVE=ERR_ILLDEV;
      519     8847    2           ELSE
      520     8848    2   ERR$ILLATTR: ERRSAVE=ERR_ILLATTR;
      521     8849    2           GOTO ERR;
      522     8850        /*
      523     8851                If :WSN.:SYS doesn't exist or is bad, then the only legal
      524     8852                dd@wsn is LP@LOCAL.  Use a canned attribute block for it.
      525     8853         */
      526     8854    3   LOCALONLY: IF F$DCB.WSN~='LOCAL' THEN DO;
      527     8855    3              ERRSAVE=ERR_ILLWSN; GOTO ERR; END;
      528     8856    3           IF SUBSTR(F$DCB.RES,0,2)~='LP' THEN DO;
      529     8857    3              GOTO ERR$ILLDEV; END;
      530     8858    2           WT$=ADDR(FSW_WTBLK);
      531     8859    2           TEMPATTR='0'B;
      532     8860    2   GOTAGOOD:
      533     8861    2           F$DCB.ATTR=TEMPATTR;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:16   
      534     8862    2           F$DCB.DDEV=KL_WTBLK.DDEV&~(%DDEV_IC#|%DDEV_UCOUT#);
      535     8863    2           IF F$DCB.FORM$->CODE16.FORM<=' ' THEN
      536     8864    2              F$DCB.FORM$->CODE16.FORM=KL_WTBLK.FNAME;
      537     8865    2           ELSE
      538     8866    2              F$DCB.FORM$->CODE16.NSFORM=(F$DCB.FORM$->CODE16.FORM~=
      539     8867    2                KL_WTBLK.FNAME);
      540     8868    2           RETURN;
      541     8869        /*
      542     8870         */
      543     8871    2   READWSNERR: ENTRY ALTRET;
      544     8872    2   ERR:    ;
      545     8873    2           IF JIT$=B$JIT$ OR B$JIT.SYSID~=%JG_PRESCAN# THEN ALTRETURN;
      546     8874    2           IF JIT$->B$JIT.ERR THEN ALTRETURN; /* second pass */
      547     8875    2           JIT$->B$JIT.ERR=ERRSAVE;
      548     8876    2           JIT$->B$JIT.ERR.MON='1'B;
      549     8877    2           IF JIT$->B$JIT.WOO=F$DCB.WSN THEN ALTRETURN;
      550     8878    2           F$DCB.WSN=JIT$->B$JIT.WOO;
      551     8879    2           IF STAR$->F$DCB.FCD THEN
      552     8880    2              GOTO PRESCANRETRY;
      553     8881    2           ELSE GOTO LOCALONLY;
      554     8882    2   END READWSN;
      555     8883        %EJECT;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:17   
      556     8884    1   OPENSTAR: PROC(FNAME) ALTRET;
      557     8885        %VLP_NAME(FPTN=FNAME,STCLASS=,LEN="FNAME.L#");
      558     8912    2   DCL SC_FSFRMWSN ENTRY CONV(2,0);
      559     8913    2   DCL S_CTUIS SBIN SYMREF;
      560     8914    2           IF STAR$->F$DCB.FCD THEN
      561     8915    2              CALL FMP$CLSJ;
      562     8916    2           CALL FMM$SCRUB(STAR$);
      563     8917    2           STAR$->F$DCB.ASN=%FILE#;
      564     8918    2           STAR$->F$DCB.FUN=%IN#;
      565     8919    2           STAR$->F$DCB.SHARE=%ALL#;
      566     8920    2           STAR$->F$DCB.ACCT=':SYS';
      567     8921    2           STAR$->F$DCB.NAME=FNAME;
      568     8922    2           B$JIT.ERR='0'B;
      569     8923    2           CALL FMM$DFLOPNP;
      570     8924    2           IF B$JIT.ERR.CODE=0 THEN RETURN;
      571     8925    2           IF S_CTUIS>2 THEN CALL SC_FSFRMWSN;
      572     8926    2           ALTRETURN;
      573     8927    2   END OPENSTAR;
      574     8928    1   CLSTAR: PROC;
      575     8929    2           IF STAR$->F$DCB.FCD THEN
      576     8930    2              CALL FMP$CLSJ;
      577     8931    2           RETURN;
      578     8932    2   END CLSTAR;
      579     8933    1   SETUP:  PROC ALTRET;
      580     8934    2           JDCB$=B$JIT.DCB$;
      581     8935    3           IF F$DCB.FORM$=ADDR(NIL) THEN DO;
      582     8936    3              CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(ALTR);
      583     8937    3              F$DCB.FORM$->CODE16='0'B;
      584     8938    3              END;
      585     8939    2   SETUPUC: ENTRY ALTRET;
      586     8940    2           JDCB$=B$JIT.DCB$;
      587     8941    2           STAR$=DCBADDR(%M$STAR#);
      588     8942    2           B$JIT.DCB$=STAR$;
      589     8943    2           IF STAR$->F$DCB.FCD THEN
      590     8944    2              CALL FMP$CLSJ;
      591     8945    2           AUTOREAD=CONSTREAD;
      592     8946    2           AUTOREAD.V_=VECTOR(AUTOREAD.V);
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:18   
      593     8947    2           AUTOREAD.V.DCB#=%M$STAR#;
      594     8948    2           AUTOREAD.KEY_=VECTOR(KEY);
      595     8949    2           AUTOREAD.BUF_.BUF$=BUF$;
      596     8950    2           KL_INDIRECT_WSN = '0'B;
      597     8951    2           AUTOREAD.BUF_.BOUND=4095-SIZEC(FS$DEST);
      598     8952    2           RETURN;
      599     8953    2   ALTR:   ALTRETURN;
      600     8954    2   END SETUP;
      601     8955    1   END FSW$DESTFORM;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:19   
--  Include file information  --

   XG_SUBS_C.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F_MACROS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FSW$DESTFORM.

   Procedure FSW$DESTFORM requires 1169 words for executable code.
   Procedure FSW$DESTFORM requires 48 words of local(AUTO) storage.

    No errors detected in file FSW$WSN.:E05TSI    .

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:20   

 Object Unit name= FSW$DESTFORM                               File name= FSW$WSN.:E05TOU
 UTS= JUL 29 '97 17:38:35.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    214    326  FSW$DESTFORM
    1   Proc  even  none  1169   2221  FSW$DESTFORM
    2  RoData even  none    22     26  FSW$DESTFORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        3  FSW$DESTFORM
     1    117          yes     yes      Std        2  FSW$FORM
     1    743          yes     yes      Std        2  FSW$UCFORM
     1   1046          yes     yes      Std        2  FSW$URFORM

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0     32  FSW_WTBLK                          0     52  FSW_FORMREC
    0    203  FSW_FORMREC_BAN
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:21   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FOT$DCHK
 yes     yes           Std       5 KIA$UCIO
 yes     yes           Std       2 FOT$TCHK
 yes     yes           Std       1 M$MREAD
         yes           Std       0 FMP$CLSJ
         yes           Std       1 FMM$SCRUB
         yes           Std       0 FMM$DFLOPNP
 yes     yes           Std       2 FSA$GSP
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_FSFRMWSN                           B$JIT$                                S_CTUIS
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ASLENTSID
     ROSID
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:22   


        1        1        /*M* FSW$WSN Prepares destinations for symbiont files.*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* ICP,MOC,DMR,CLM=8 */
        8        8        /*P*    NAME:    FSW$WSN
        9        9                PURPOSE: FSW$WSN validates workstation, device, and form
       10       10                         names when a symbiont file is being opened,
       11       11                         and returns attributes of the wsn/device/form.
       12       12        */
       13       13        /*F*    NAME:    FSW$DESTFORM
       14       14                PURPOSE: FSW$DESTFORM is called to validate workstation,
       15       15                         device, and form names whenever a symbiont file
       16       16                         is being created for a destination that has not
       17       17                         previously been validated.
       18       18                         For validated destinations (LDEV not SCRUB), the
       19       19                         routine FSW$FORM is used instead.
       20       20                DESCRIPTION: Open :WSN.:SYS.  Read record for workstation.
       21       21                         Find device in record.  If user didn't specify
       22       22                         form name, get default form.  Open :FORM.:SYS.
       23       23                         Read record for form.
       24       24        */
       25       25        /*D*    NAME:    FSW$DESTFORM
       26       26                CALL:    CALL  FSW$DESTFORM(DEST$,BUF$,JIT$)ALTRET;
       27       27                INPUT:   B$JIT.DCB$ points to a DCB for the symbiont file.
       28       28                         The DCB's WSN and RES fields specify a workstation
       29       29                         and device.  The DCB's FORM$ if not nil points to a
       30       30                         CODE16 which may or may not specify a form name.
       31       31                         DEST$ if not NIL points to a FS$DEST area which
       32       32                         has had various parameters filled in by LDEV;
       33       33                         if NIL, a FS$DEST area is built at the end of BUF$.
       34       34                         BUF$ points to a stolen file management buffer page
       35       35                         which is used as a buffer.
       36       36                         JIT$ points to a JIT whose ACCN is used as the
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:23   
       37       37                         authorization-check account.
       38       38                OUTPUT:  The DCB's ATTR and DDEV are filled in from the
       39       39                         device definition.
       40       40                         The DCB's WIDTH and LINES fields are filled in
       41       41                         from the form definition.
       42       42                         The DCB's CODE16 has been filled in from the
       43       43                         device definition, the form definition, and the
       44       44                         FS$DEST.  It has been acquired if DCB.FORM$ was nil.
       45       45                         BUF$ holds the form definition record.  It will
       46       46                         be used later for making a banner.
       47       47                         DEST$ holds a filled-out FS$DEST area for OUTSYM.
       48       48                DESCRIPTION:
       49       49        */
       50       50        FSW$DESTFORM: PROC(DEST$,BUF$,JIT$) ALTRET;

     50  1 000000   000000 700200 xent  FSW$DESTFORM TSX0  ! X66_AUTO_3
         1 000001   000060 000003                    ZERO    48,3

       51       51        /* PARAMETERS */
       52       52    1   DCL DEST$ PTR;
       53       53    1   DCL BUF$ PTR;
       54       54    1   DCL JIT$ PTR;
       55       55        /* INCLUDE FILES */
       56       56        %INCLUDE B$JIT;
       57      659        %MACRO F$DCBI(BASED=BASED);
       58      660        %INCLUDE F$DCB;
       59      709        %MEND;
       60      710        %INCLUDE FS$FIT;
       61      753        %INCLUDE F_MACROS_C;
       62      764        %INCLUDE F_CP6;
       63     1789        %INCLUDE KL_SUPER_C;
       64     4691        %INCLUDE FS_SUPER_C;
       65     5454        %INCLUDE CP_6_SUBS;
       66     5994        %INCLUDE F_ERRORS_C;
       67     6234        %INCLUDE FM$FIT;
       68     6455        %INCLUDE JG_GHOSTS_C;
       69     6545        %INCLUDE NK_VFC_C;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:24   
       70     6619        %INCLUDE F_FPTCODE_C;
       71     6655        %INCLUDE XG_SUBS_C;
       72     7149        /* EXTERNAL STORAGE */
       73     7150    1   DCL B$JIT$ PTR SYMREF;
       74     7151        /* LOCAL AUTOMATIC STORAGE */
       75     7152    1   DCL JDCB$ PTR;
       76     7153    1   DCL STAR$ PTR;
       77     7154    1   DCL WT$ PTR;
       78     7155    1   DCL BANNER$ PTR;
       79     7156    1   DCL I UBIN;
       80     7157    1   DCL J UBIN;
       81     7158    1   DCL 1 KEY,
       82     7159    1         2 L UBIN BYTE UNAL,
       83     7160    1         2 C CHAR(11);
       84     7161        %FPT_READ(FPTN=AUTOREAD,STCLASS=);
       85     7200    1   DCL TEMPATTR BIT(36);
       86     7201    1   DCL ERRSAVE BIT(36);
       87     7202    1   DCL WILD_X UBIN;
       88     7203    1   DCL WILD_XC REDEF WILD_X CHAR(4);
       89     7204    1   DCL WILD_XP UBIN;
       90     7205    1   DCL COMPARE_X UBIN;
       91     7206    1   DCL COMPARE_XP UBIN;
       92     7207    1   DCL COMPACCT CHAR(8);
       93     7208    1   DCL MINGLCLLP BIT(1);
       94     7209        /* EXTERNAL ROUTINES */
       95     7210    1   DCL FMP$CLSJ ENTRY;
       96     7211    1   DCL FMM$DFLOPNP ENTRY; /* Default open, Privileged. */
       97     7212    1   DCL FSA$GSP ENTRY(2)ALTRET; /* Gets ROSEG space */
       98     7213    1   DCL FMM$SCRUB ENTRY(1);
       99     7214    1   DCL M$MREAD ENTRY(1)ALTRET;
      100     7215    1   DCL FOT$TCHK ENTRY(2)ALTRET;
      101     7216    1   DCL FOT$DCHK ENTRY(2)ALTRET;
      102     7217    1   DCL KIA$UCIO ENTRY(5)ALTRET;
      103     7218        /* CONSTANT STORAGE */
      104     7219        %FPT_READ(FPTN=CONSTREAD,STCLASS=CONSTANT,KEYS=YES);
      105     7258        %VLP_NAME(FPTN=WSNNAME,STCLASS=CONSTANT,NAME=':WSN');
      106     7285        %VLP_NAME(FPTN=FORMNAME,STCLASS=CONSTANT,NAME=':FORM');
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:25   
      107     7312        %SUB FCG#='0623'O;
      108     7313        %SUB MID#='27'O;
      109     7314        %ERRCODE(NAME=ERR_ILLWSN,COD#=%E$INVWSN);
      110     7318        /*E*    ERROR: FSW-E$INVWSN-2
      111     7319                MESSAGE: No such workstation.
      112     7320         */
      113     7321        %ERRCODE(NAME=ERR_CANTWSN,COD#=%E$CANTWSN);
      114     7325        /*E*    ERROR: FSW-E$CANTWSN-2
      115     7326                MESSAGE: You aren't authorized to use that workstation.
      116     7327         */
      117     7328        %ERRCODE(NAME=ERR_ILLDEV,COD#=%E$INVDEV);
      118     7332        /*E*    ERROR: FSW-E$INVDEV-2
      119     7333                MESSAGE: There is no such device at that workstation.
      120     7334         */
      121     7335        %ERRCODE(NAME=ERR_NOTOUT,COD#=%E$ILLOUT);
      122     7339        /*E*    ERROR: FSW-E$ILLOUT-2
      123     7340                MESSAGE: That device can not be written.
      124     7341         */
      125     7342        %ERRCODE(NAME=ERR_ILLATTR,COD#=%E$CANTATTR);
      126     7346        /*E*    ERROR: FSW-E$CANTATTR-2
      127     7347                MESSAGE: That device doesn't have the requested attributes.
      128     7348         */
      129     7349        %ERRCODE(NAME=ERR_INVFORM,COD#=%E$INVFORM);
      130     7353        /*E*    ERROR:   FSW-E$INVFORM-2
      131     7354                MESSAGE: No form exists with that name.
      132     7355        */
      133     7356        %ERRCODE(NAME=ERR_CANTFORM,COD#=%E$CANTFORM);
      134     7360        /*E*    ERROR:   FSW-E$CANTFORM-2
      135     7361                MESSAGE: That form is not available for that device.
      136     7362        */
      137     7363        %ERRCODE(NAME=ERR_NOTAUTHFORM,COD#=%E$NOTAUTHFORM);
      138     7367        /*E*    ERROR: FSW-E$NOTAUTHFORM-2
      139     7368                MESSAGE: You aren't authorized to use that form.
      140     7369        */
      141     7370        %KL_WTBLK(NAME=FSW_WTBLK,STCLASS="CONSTANT SYMDEF",
      142     7371                TTNAME='LOCAL',FFNAME='STDLP',DDDEV=%DDEV_LP#,
      143     7372                IINPUT='0'B,OOUTPUT='1'B);
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:26   
      144     7406        %FS$FORMREC(NAME=FSW_FORMREC,
      145     7407                      FRMNAME='STDLP ',
      146     7408                      STCLASS="CONSTANT SYMDEF",
      147     7409                      ACCDISP=0,
      148     7410                      ACCTSDISP=0,
      149     7411                      WDTH=132,
      150     7412                      LNGTH=39,
      151     7413                      LMBO=6,
      152     7414                      FLINE=6,
      153     7415                      LP_OK=YES,
      154     7416                      TS_OK=YES);
      155     7487        %FS$BAN_INIT(NAME=FSW_FORMREC_BAN,
      156     7488                      STCLASS="CONSTANT SYMDEF",
      157     7489                      CNT=13,
      158     7490                      REPTS=2,
      159     7491                      INR=1
      160     7492                           );
      161     7549        %FS$BAN_ENT(ROW=1,COL=1,TYPE=FS_DATE_INT);
      162     7586        %FS$BAN_ENT(ROW=1,COL=10,TYPE=FS_TIME_INT);
      163     7623        %FS$BAN_ENT(ROW=1,COL=18,TYPE=FS_ACCN_INT);
      164     7660        %FS$BAN_ENT(ROW=1,COL=27,TYPE=FS_UNAME_INT);
      165     7697        %FS$BAN_ENT(ROW=1,COL=40,TYPE=FS_WOO_INT);
      166     7734        %FS$BAN_ENT(ROW=1,COL=50,TYPE=FS_SYSID_INT);
      167     7771       %FS$BAN_ENT(ROW=3,COL=1,FONT=1,STRIKES=2,ICSH=1,TYPE=FS_PLAIN_TEXT,TEXT='Honeywell')
              7771            ;
      168     7808        %FS$BAN_ENT(ROW=3,COL=80,STRIKES=2,TYPE=FS_LOGO_INT);
      169     7845        %FS$BAN_ENT(ROW=15,COL=1,TYPE=FS_PLAIN_TEXT,TEXT='VERSION',REPS=3,RINC=2);
      170     7882        %FS$BAN_ENT(ROW=15,COL=9,TYPE=FS_VERSION_INT,REPS=3,RINC=2);
      171     7919        %FS$BAN_ENT(ROW=15,COL=20,TYPE=FS_SYSID_INT,FONT=1,STRIKES=2,ICSH=1);
      172     7956        %FS$BAN_ENT(ROW=26,COL=10,FONT=1,STRIKES=3,ICSH=1,TYPE=FS_UNAME_INT);
      173     7993        %FS$BAN_ENT(ROW=45,COL=1,REPS=2,TYPE=FS_X_INT,TEXT='*');
      174     8030        %FS$BAN_GEN;
      175     8049    1   DCL 1 MOVEBANNER BASED,
      176     8050    1         2 * CHAR(PL6ISDUMB);
      177     8051    1   DCL PL6ISDUMB UBIN CONSTANT INIT(SIZEC(FSW_FORMREC_BAN));
      178     8052        /**/
      179     8053        /* BASED STRUCTURES */
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:27   
      180     8054        %F$DCBI (BASED="BASED(JDCB$)");
      181     8104        %FS$DEST (STCLASS="BASED(DEST$)",SIZ=FIT);
      182     8112        %CODE16;
      183     8120        %KL_WSNHDR(STCLASS="BASED(BUF$)");
      184     8131        %KL_INDIRECT_WSN(STCLASS="BASED(BUF$)");
      185     8139        %KL_WTBLK(STCLASS="BASED(WT$)");
      186     8173        %KL_ACBLK(STCLASS="BASED(WT$)");
      187     8178        %FS$GFORMREC (NAME=GFORM,
      188     8179                      STCLASS="BASED(BUF$)");
      189     8238        %FS$FORMREC(STCLASS="BASED(BUF$)");
      190     8309        %FS$ACCT_INIT(NAME=FS$ACCT,STCLASS="BASED(WT$)");
      191     8323        %FS$BAN_INIT (NAME=BANNER,
      192     8324                    STCLASS = "BASED (BANNER$)" );
      193     8381    1   DCL 1 ZERO_VFC_IM CONSTANT,
      194     8382    1         2 LINE (0:31) UBIN (9) UNAL INIT (0*0),
      195     8383    1         2 NEXT (0:31) UBIN (9) UNAL INIT (0*0);
      196     8384        /**/
      197     8385        /**/
      198     8386    1           CALL SETUP ALTRET(ALTR);

   8386  1 000002   002115 701000 1                  TSX1    SETUP
         1 000003   001204 702000 1                  TSX2    ALTR

      199     8387    2           IF DEST$=ADDR(NIL) THEN DO;

   8387  1 000004   200003 470500                    LDP0    @DEST$,,AUTO
         1 000005   000000 236100                    LDQ     0,,PR0
         1 000006   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000007   000036 601000 1                  TNZ     s:8395

      200     8388    2              DEST$=PINCRW(BUF$,1024-SIZEW(FS$DEST));

   8388  1 000010   200004 471500                    LDP1    @BUF$,,AUTO
         1 000011   100000 236100                    LDQ     0,,PR1
         1 000012   001745 036003                    ADLQ    997,DU
         1 000013   000000 756100                    STQ     0,,PR0

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:28   
      201     8389    2              FS$DEST='0'B;

   8389  1 000014   000000 473500                    LDP3    0,,PR0
         1 000015   000100 100400                    MLR     fill='000'O
         1 000016   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000017   300000 000154                    ADSC9   0,,PR3                   cn=0,n=108

      202     8390    2              FS$DEST.SIZ=SIZEW(FS$DEST)-1;

   8390  1 000020   000000 473500                    LDP3    0,,PR0
         1 000021   000032 235007                    LDA     26,DL
         1 000022   300000 755100                    STA     0,,PR3

      203     8391    2              FS$DEST.COPIES=F$DCB.FORM$->CODE16.COPIES;

   8391  1 000023   000000 473500                    LDP3    0,,PR0
         1 000024   200006 474500                    LDP4    JDCB$,,AUTO
         1 000025   400050 475500                    LDP5    40,,PR4
         1 000026   500007 236100                    LDQ     7,,PR5
         1 000027   300006 552120                    STBQ    6,'20'O,PR3

      204     8392    2              IF FS$DEST.COPIES=0 THEN

   8392  1 000030   000000 473500                    LDP3    0,,PR0
         1 000031   300006 236100                    LDQ     6,,PR3
         1 000032   000777 316003                    CANQ    511,DU
         1 000033   000036 601000 1                  TNZ     s:8395

      205     8393    2                 FS$DEST.COPIES=1;

   8393  1 000034   000001 236003                    LDQ     1,DU
         1 000035   300006 552120                    STBQ    6,'20'O,PR3

      206     8394    2              END;

      207     8395    1           FS$DEST.PRIO=JIT$->B$JIT.OUTPRIO;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:29   
   8395  1 000036   000000 471500                    LDP1    0,,PR0
         1 000037   200005 473500                    LDP3    @JIT$,,AUTO
         1 000040   300000 474500                    LDP4    0,,PR3
         1 000041   400022 236100                    LDQ     18,,PR4
         1 000042   000011 772000                    QRL     9
         1 000043   100006 552104                    STBQ    6,'04'O,PR1

      208     8396    1           IF B$JIT.SYSID<=JG_MING# AND B$JIT.SYSID~=JG_INSYM# THEN

   8396  1 000044   000000 471400 xsym               LDP1    B$JIT$
         1 000045   100000 720100                    LXL0    0,,PR1
         1 000046   000020 100003                    CMPX0   16,DU
         1 000047   000055 603000 1                  TRC     s:8398
         1 000050   000005 100003                    CMPX0   5,DU
         1 000051   000055 600000 1                  TZE     s:8398

      209     8397    1              FS$DEST.PRIO=15;

   8397  1 000052   000000 474500                    LDP4    0,,PR0
         1 000053   000017 236007                    LDQ     15,DL
         1 000054   400006 552104                    STBQ    6,'04'O,PR4

      210     8398    1           FS$DEST.MODE=B$JIT.MODE;

   8398  1 000055   000000 474500                    LDP4    0,,PR0
         1 000056   100000 236100                    LDQ     0,,PR1
         1 000057   000005 772000                    QRL     5
         1 000060   400006 676100                    ERQ     6,,PR4
         1 000061   017000 376003                    ANQ     7680,DU
         1 000062   400006 656100                    ERSQ    6,,PR4

      211     8399    1           FS$DEST.JOBNAME=B$JIT.JOBNAME;

   8399  1 000063   000000 474500                    LDP4    0,,PR0
         1 000064   040100 100500                    MLR     fill='040'O
         1 000065   100156 200037                    ADSC9   110,,PR1                 cn=1,n=31
         1 000066   400023 200037                    ADSC9   19,,PR4                  cn=1,n=31
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:30   

      212     8400    1           CALL READWSN ALTRET(TRUERR);

   8400  1 000067   001237 701000 1                  TSX1    READWSN
         1 000070   001175 702000 1                  TSX2    TRUERR

      213     8401    1           IF KL_INDIRECT_WSN.INDIRECT# THEN RETURN;

   8401  1 000071   200004 470500                    LDP0    @BUF$,,AUTO
         1 000072   000000 471500                    LDP1    0,,PR0
         1 000073   100000 234100                    SZN     0,,PR1
         1 000074   000076 605000 1                  TPL     PASS2WSN

   8401  1 000075   000000 702200 xent               TSX2  ! X66_ARET

      214     8402    1   PASS2WSN:
      215     8403    1           FS$DEST.ATTR=F$DCB.ATTR;

   8403  1 000076   200003 470500       PASS2WSN     LDP0    @DEST$,,AUTO
         1 000077   000000 471500                    LDP1    0,,PR0
         1 000100   200006 473500                    LDP3    JDCB$,,AUTO
         1 000101   300040 720100                    LXL0    32,,PR3
         1 000102   100022 440100                    SXL0    18,,PR1

      216     8404    1           FS$DEST.DDEV=F$DCB.DDEV;

   8404  1 000103   000000 471500                    LDP1    0,,PR0
         1 000104   300004 236100                    LDQ     4,,PR3
         1 000105   000022 736000                    QLS     18
         1 000106   100017 552140                    STBQ    15,'40'O,PR1

      217     8405    1           FS$DEST.DT.DEV=F$DCB.RES;

   8405  1 000107   000000 471500                    LDP1    0,,PR0
         1 000110   300026 220100                    LDX0    22,,PR3
         1 000111   100017 440100                    SXL0    15,,PR1

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:31   
      218     8406    1           FS$DEST.DT.WSN=F$DCB.WSN;

   8406  1 000112   000000 471500                    LDP1    0,,PR0
         1 000113   040100 100500                    MLR     fill='040'O
         1 000114   300027 000010                    ADSC9   23,,PR3                  cn=0,n=8
         1 000115   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8

      219     8407    1           GOTO ONTOFORM;

   8407  1 000116   000123 710000 1                  TRA     ONTOFORM

      220     8408    1   FSW$FORM: ENTRY(DEST$,BUF$) ALTRET;

   8408  1 000117   000000 700200 xent  FSW$FORM     TSX0  ! X66_AUTO_3
         1 000120   000060 000003                    ZERO    48,3

      221     8409    1           CALL SETUP ALTRET(ALTR);

   8409  1 000121   002115 701000 1                  TSX1    SETUP
         1 000122   001204 702000 1                  TSX2    ALTR

   8406  1 000123                       ONTOFORM     null
      222     8410    1   ONTOFORM:;
      223     8411    1           KEY.C=F$DCB.FORM$->CODE16.FORM;

   8411  1 000123   200006 470500                    LDP0    JDCB$,,AUTO
         1 000124   000050 471500                    LDP1    40,,PR0
         1 000125   040100 100500                    MLR     fill='040'O
         1 000126   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         1 000127   200014 200013                    ADSC9   KEY,,AUTO                cn=1,n=11

      224     8412    1           CALL OPENSTAR(FORMNAME) ALTRET(STDFONLY);

   8412  1 000130   000000 236000 2                  LDQ     0
         1 000131   200053 756100                    STQ     MINGLCLLP+5,,AUTO
         1 000132   002016 701000 1                  TSX1    OPENSTAR
         1 000133   000137 702000 1                  TSX2    STDFONLY
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:32   

      225     8413    1           CALL READFORMNOOPEN ALTRET (STDFONLY);

   8413  1 000134   001213 701000 1                  TSX1    READFORMNOOPEN
         1 000135   000137 702000 1                  TSX2    STDFONLY

      226     8414    2           DO WHILE('0'B);

   8414  1 000136   000160 710000 1                  TRA     s:8421

      227     8415    2   STDFONLY:  IF KEY.C~='STDLP' THEN GOTO ERR$ILLFORM;

   8415  1 000137   040000 106500       STDFONLY     CMPC    fill='040'O
         1 000140   200014 200013                    ADSC9   KEY,,AUTO                cn=1,n=11
         1 000141   000316 000005 0                  ADSC9   ZERO_VFC_IM+16           cn=0,n=5
         1 000142   001156 601000 1                  TNZ     ERR$ILLFORM

      228     8416    2              FS$FORMREC=FSW_FORMREC;

   8416  1 000143   200004 470500                    LDP0    @BUF$,,AUTO
         1 000144   000000 471500                    LDP1    0,,PR0
         1 000145   000100 100400                    MLR     fill='000'O
         1 000146   000052 000542 0                  ADSC9   FSW_FORMREC              cn=0,n=354
         1 000147   100000 000542                    ADSC9   0,,PR1                   cn=0,n=354

      229     8417    2              FS$FORMREC.BANRDISP=SIZEW(FS$FORMREC);

   8417  1 000150   000000 471500                    LDP1    0,,PR0
         1 000151   000131 220003                    LDX0    89,DU
         1 000152   100003 740100                    STX0    3,,PR1

      230     8418    2              PINCRW(ADDR(FS$FORMREC),SIZEW(FS$FORMREC))->MOVEBANNER=

   8418  1 000153   000000 471500                    LDP1    0,,PR0
         1 000154   000275 721000 0                  LXL1    PL6ISDUMB
         1 000155   000140 100400                    MLR     fill='000'O
         1 000156   000203 000350 0                  ADSC9   FSW_FORMREC_BAN          cn=0,n=232
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:33   
         1 000157   100131 000011                    ADSC9   89,,PR1                  cn=0,n=*X1

      231     8419    2                FSW_FORMREC_BAN;
      232     8420    2              END;

      233     8421    1           CALL FOT$TCHK(FS$FORMREC,FS$DEST.DT.WSN)ALTRET(ERR$CANTFORM);

   8421  1 000160   200004 470500                    LDP0    @BUF$,,AUTO
         1 000161   000000 471500                    LDP1    0,,PR0
         1 000162   200003 473500                    LDP3    @DEST$,,AUTO
         1 000163   300000 474500                    LDP4    0,,PR3
         1 000164   400020 635500                    EPPR5   16,,PR4
         1 000165   200055 455500                    STP5    @FNAME+2,,AUTO
         1 000166   200054 451500                    STP1    @FNAME+1,,AUTO
         1 000167   200054 630500                    EPPR0   @FNAME+1,,AUTO
         1 000170   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000171   000000 701000 xent               TSX1    FOT$TCHK
         1 000172   001161 702000 1                  TSX2    ERR$CANTFORM

      234     8422    1           CALL FOT$DCHK(FS$FORMREC,FS$DEST.DT.DEV)ALTRET(ERR$CANTFORM);

   8422  1 000173   200004 470500                    LDP0    @BUF$,,AUTO
         1 000174   000000 471500                    LDP1    0,,PR0
         1 000175   200003 473500                    LDP3    @DEST$,,AUTO
         1 000176   300000 474500                    LDP4    0,,PR3
         1 000177   200056 454500                    STP4    @FNAME+3,,AUTO
         1 000200   200056 236100                    LDQ     @FNAME+3,,AUTO
         1 000201   000001 036000 2                  ADLQ    1
         1 000202   200055 756100                    STQ     @FNAME+2,,AUTO
         1 000203   200054 451500                    STP1    @FNAME+1,,AUTO
         1 000204   200054 630500                    EPPR0   @FNAME+1,,AUTO
         1 000205   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000206   000000 701000 xent               TSX1    FOT$DCHK
         1 000207   001161 702000 1                  TSX2    ERR$CANTFORM

      235     8423    2           IF FS$FORMREC.ACCTDISP~=0 THEN DO;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:34   
   8423  1 000210   200004 470500                    LDP0    @BUF$,,AUTO
         1 000211   000000 471500                    LDP1    0,,PR0
         1 000212   100001 720100                    LXL0    1,,PR1
         1 000213   000416 600000 1                  TZE     s:8509

      236     8424    2              WT$=PINCRW(ADDR(FS$FORMREC),FS$FORMREC.ACCTDISP);

   8424  1 000214   100000 633510                    EPPR3   0,X0,PR1
         1 000215   200010 453500                    STP3    WT$,,AUTO

      237     8425    3              IF FS$ACCT.TACCTS~=0 THEN DO;

   8425  1 000216   000100 100500                    MLR     fill='000'O
         1 000217   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         1 000220   200054 000004                    ADSC9   @FNAME+1,,AUTO           cn=0,n=4
         1 000221   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 000222   000000 116003                    CMPQ    0,DU
         1 000223   000416 600000 1                  TZE     s:8509

      238     8426    3                 IF ADDR(JIT$)=ADDR(NIL) THEN COMPACCT=B$JIT.ACCN;

   8426  1 000224   200005 236100                    LDQ     @JIT$,,AUTO
         1 000225   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000226   000234 601000 1                  TNZ     s:8427

   8426  1 000227   000000 471400 xsym               LDP1    B$JIT$
         1 000230   040100 100500                    MLR     fill='040'O
         1 000231   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000232   200044 000010                    ADSC9   COMPACCT,,AUTO           cn=0,n=8
         1 000233   000250 710000 1                  TRA     s:8429

      239     8427    3                 ELSE IF JIT$->B$JIT.ERR THEN COMPACCT=B$JIT.ACCN;

   8427  1 000234   200005 471500                    LDP1    @JIT$,,AUTO
         1 000235   100000 474500                    LDP4    0,,PR1
         1 000236   400012 235100                    LDA     10,,PR4
         1 000237   000245 600000 1                  TZE     s:8428
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:35   

   8427  1 000240   000000 475400 xsym               LDP5    B$JIT$
         1 000241   040100 100500                    MLR     fill='040'O
         1 000242   500001 000010                    ADSC9   1,,PR5                   cn=0,n=8
         1 000243   200044 000010                    ADSC9   COMPACCT,,AUTO           cn=0,n=8
         1 000244   000250 710000 1                  TRA     s:8429

      240     8428    3                    ELSE COMPACCT=JIT$->B$JIT.ACCN;

   8428  1 000245   040100 100500                    MLR     fill='040'O
         1 000246   400001 000010                    ADSC9   1,,PR4                   cn=0,n=8
         1 000247   200044 000010                    ADSC9   COMPACCT,,AUTO           cn=0,n=8

      241     8429    3                 J=0;

   8429  1 000250   200013 450100                    STZ     J,,AUTO

      242     8430    4   NEXTACCT:     IF J=FS$ACCT.TACCTS THEN DO;

   8430  1 000251   200010 470500       NEXTACCT     LDP0    WT$,,AUTO
         1 000252   000100 100500                    MLR     fill='000'O
         1 000253   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         1 000254   200054 000004                    ADSC9   @FNAME+1,,AUTO           cn=0,n=4
         1 000255   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 000256   200013 116100                    CMPQ    J,,AUTO
         1 000257   000263 601000 1                  TNZ     s:8454

      243     8431    4                    ERRSAVE=ERR_NOTAUTHFORM;

   8431  1 000260   000031 236000 0                  LDQ     ERR_NOTAUTHFORM
         1 000261   200037 756100                    STQ     ERRSAVE,,AUTO

      244     8432    4                    GOTO MEBBETRUERR;

   8432  1 000262   001163 710000 1                  TRA     MEBBETRUERR

      245     8433    4                    END;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:36   
      246     8434                      %WILD_COMPARE(WILD_CHARS="FS$ACCT.LIST(J)",
      247     8435                      COMPARE_CHARS=COMPACCT,
      248     8436                      NO_MATCH="DO;J=J+1;GOTO NEXTACCT;END");

   8454  1 000263   200013 235100                    LDA     J,,AUTO
         1 000264   000003 735000                    ALS     3
         1 000265   040100 100505                    MLR     fill='040'O
         1 000266   000001 000004                    ADSC9   1,A,PR0                  cn=0,n=4
         1 000267   200040 000004                    ADSC9   WILD_X,,AUTO             cn=0,n=4

   8455  1 000270   200040 236100                    LDQ     WILD_X,,AUTO
         1 000271   000320 376000 0                  ANQ     ZERO_VFC_IM+18
         1 000272   000321 116000 0                  CMPQ    ZERO_VFC_IM+19
         1 000273   000301 601000 1                  TNZ     s:8469

   8456  1 000274   000003 236007                    LDQ     3,DL
         1 000275   200040 756100                    STQ     WILD_X,,AUTO

   8457  1 000276   000002 235007                    LDA     2,DL
         1 000277   200041 755100                    STA     WILD_XP,,AUTO

   8458  1 000300   000304 710000 1                  TRA     s:8472

   8469  1 000301   200040 450100                    STZ     WILD_X,,AUTO

   8470  1 000302   000010 236007                    LDQ     8,DL
         1 000303   200041 756100                    STQ     WILD_XP,,AUTO

   8472  1 000304   200042 450100                    STZ     COMPARE_X,,AUTO

   8473  1 000305   200043 450100                    STZ     COMPARE_XP,,AUTO

   8477  1 000306   000374 710000 1                  TRA     s:8502

   8479  1 000307   200040 235100                    LDA     WILD_X,,AUTO
         1 000310   000010 115007                    CMPA    8,DL
         1 000311   000324 603000 1                  TRC     s:8483
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:37   
         1 000312   200013 236100                    LDQ     J,,AUTO
         1 000313   000003 736000                    QLS     3
         1 000314   200040 036100                    ADLQ    WILD_X,,AUTO
         1 000315   200010 470500                    LDP0    WT$,,AUTO
         1 000316   040000 106506                    CMPC    fill='040'O
         1 000317   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1
         1 000320   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000321   000324 601000 1                  TNZ     s:8483

   8480  1 000322   200041 755100                    STA     WILD_XP,,AUTO

   8481  1 000323   000367 710000 1                  TRA     s:8501

   8483  1 000324   200041 236100                    LDQ     WILD_XP,,AUTO
         1 000325   000001 036007                    ADLQ    1,DL
         1 000326   200040 116100                    CMPQ    WILD_X,,AUTO
         1 000327   000332 601000 1                  TNZ     s:8484

   8483  1 000330   200042 235100                    LDA     COMPARE_X,,AUTO
         1 000331   200043 755100                    STA     COMPARE_XP,,AUTO

   8484  1 000332   200040 235100                    LDA     WILD_X,,AUTO
         1 000333   000010 115007                    CMPA    8,DL
         1 000334   000350 603000 1                  TRC     s:8488
         1 000335   200042 235100                    LDA     COMPARE_X,,AUTO
         1 000336   000010 115007                    CMPA    8,DL
         1 000337   000350 603000 1                  TRC     s:8488
         1 000340   200013 236100                    LDQ     J,,AUTO
         1 000341   000003 736000                    QLS     3
         1 000342   200040 036100                    ADLQ    WILD_X,,AUTO
         1 000343   200010 470500                    LDP0    WT$,,AUTO
         1 000344   040105 106506                    CMPC    fill='040'O
         1 000345   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1
         1 000346   200044 000001                    ADSC9   COMPACCT,A,AUTO          cn=0,n=1
         1 000347   000364 600000 1                  TZE     s:8499

   8488  1 000350   200041 235100                    LDA     WILD_XP,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:38   
         1 000351   000010 115007                    CMPA    8,DL
         1 000352   000356 600000 1                  TZE     s:8489
         1 000353   200043 236100                    LDQ     COMPARE_XP,,AUTO
         1 000354   000010 116007                    CMPQ    8,DL
         1 000355   000362 601000 1                  TNZ     s:8490

   8489  1 000356   200013 236100                    LDQ     J,,AUTO
         1 000357   000001 036007                    ADLQ    1,DL
         1 000360   200013 756100                    STQ     J,,AUTO

   8489  1 000361   000251 710000 1                  TRA     NEXTACCT

   8490  1 000362   200040 755100                    STA     WILD_X,,AUTO

   8494  1 000363   200042 756100                    STQ     COMPARE_X,,AUTO

   8499  1 000364   200042 235100                    LDA     COMPARE_X,,AUTO
         1 000365   000001 035007                    ADLA    1,DL
         1 000366   200042 755100                    STA     COMPARE_X,,AUTO

   8501  1 000367   200040 235100                    LDA     WILD_X,,AUTO
         1 000370   000010 115007                    CMPA    8,DL
         1 000371   000374 603000 1                  TRC     s:8502

   8501  1 000372   000001 035007                    ADLA    1,DL
         1 000373   200040 755100                    STA     WILD_X,,AUTO

   8502  1 000374   200040 235100                    LDA     WILD_X,,AUTO
         1 000375   000010 115007                    CMPA    8,DL
         1 000376   000407 603000 1                  TRC     s:8502+11
         1 000377   200013 236100                    LDQ     J,,AUTO
         1 000400   000003 736000                    QLS     3
         1 000401   200040 036100                    ADLQ    WILD_X,,AUTO
         1 000402   200010 470500                    LDP0    WT$,,AUTO
         1 000403   040000 106506                    CMPC    fill='040'O
         1 000404   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1
         1 000405   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:39   
         1 000406   000307 601000 1                  TNZ     s:8479
         1 000407   200042 236100                    LDQ     COMPARE_X,,AUTO
         1 000410   000010 116007                    CMPQ    8,DL
         1 000411   000416 603000 1                  TRC     s:8509
         1 000412   040000 106506                    CMPC    fill='040'O
         1 000413   200044 000001                    ADSC9   COMPACCT,Q,AUTO          cn=0,n=1
         1 000414   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000415   000307 601000 1                  TNZ     s:8479

      249     8507    3                 END;

      250     8508    2              END;

      251     8509    1           FS$DEST.FORM=FS$FORMREC.FNAME;

   8509  1 000416   200003 470500                    LDP0    @DEST$,,AUTO
         1 000417   000000 471500                    LDP1    0,,PR0
         1 000420   200004 473500                    LDP3    @BUF$,,AUTO
         1 000421   300000 474500                    LDP4    0,,PR3
         1 000422   040100 100500                    MLR     fill='040'O
         1 000423   400000 000006                    ADSC9   0,,PR4                   cn=0,n=6
         1 000424   100001 000006                    ADSC9   1,,PR1                   cn=0,n=6

      252     8510    1           IF FS$FORMREC.GRAPHIC

   8510  1 000425   300000 471500                    LDP1    0,,PR3
         1 000426   100004 430100                    FSZN    4,,PR1
         1 000427   000436 605000 1                  TPL     s:8516

      253     8511    2           THEN DO;

      254     8512    2              FS$DEST.FWIDTH = 0;

   8512  1 000430   000000 474500                    LDP4    0,,PR0
         1 000431   000000 236003                    LDQ     0,DU
         1 000432   400003 552110                    STBQ    3,'10'O,PR4

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:40   
      255     8513    2              FS$DEST.FLINES = 0;

   8513  1 000433   000000 471500                    LDP1    0,,PR0
         1 000434   100003 552104                    STBQ    3,'04'O,PR1

      256     8514    2              END;

   8514  1 000435   000447 710000 1                  TRA     s:8519

      257     8515    2           ELSE DO;

      258     8516    2              FS$DEST.FWIDTH = FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH;

   8516  1 000436   000000 474500                    LDP4    0,,PR0
         1 000437   100006 236100                    LDQ     6,,PR1
         1 000440   000022 772000                    QRL     18
         1 000441   400003 552110                    STBQ    3,'10'O,PR4

      259     8517    2              FS$DEST.FLINES = FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;

   8517  1 000442   000000 471500                    LDP1    0,,PR0
         1 000443   300000 474500                    LDP4    0,,PR3
         1 000444   400006 236100                    LDQ     6,,PR4
         1 000445   000022 772000                    QRL     18
         1 000446   100003 552104                    STBQ    3,'04'O,PR1

      260     8518    2              END;

      261     8519    1           TEMPATTR=F$DCB.FORM$->CODE16.NSFORM;

   8519  1 000447   200006 471500                    LDP1    JDCB$,,AUTO
         1 000450   100050 474500                    LDP4    40,,PR1
         1 000451   400007 236100                    LDQ     7,,PR4
         1 000452   000003 736000                    QLS     3
         1 000453   400000 376003                    ANQ     -131072,DU
         1 000454   200036 756100                    STQ     TEMPATTR,,AUTO

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:41   
      262     8520    1           F$DCB.FORM$->CODE16='0'B;

   8520  1 000455   000100 100400                    MLR     fill='000'O
         1 000456   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000457   400000 000234                    ADSC9   0,,PR4                   cn=0,n=156

      263     8521    1           F$DCB.FORM$->CODE16.NSFORM=TEMPATTR;

   8521  1 000460   100050 474500                    LDP4    40,,PR1
         1 000461   200036 236100                    LDQ     TEMPATTR,,AUTO
         1 000462   000003 772000                    QRL     3
         1 000463   400007 676100                    ERQ     7,,PR4
         1 000464   040000 376003                    ANQ     16384,DU
         1 000465   400007 656100                    ERSQ    7,,PR4

      264     8522    1           F$DCB.FORM$->CODE16.FORM=KEY.C;

   8522  1 000466   100050 474500                    LDP4    40,,PR1
         1 000467   040100 100500                    MLR     fill='040'O
         1 000470   200014 200006                    ADSC9   KEY,,AUTO                cn=1,n=6
         1 000471   400000 000006                    ADSC9   0,,PR4                   cn=0,n=6

      265     8523    1           F$DCB.FORM$->CODE16.COPIES=FS$DEST.COPIES;

   8523  1 000472   100050 474500                    LDP4    40,,PR1
         1 000473   000000 475500                    LDP5    0,,PR0
         1 000474   500006 236100                    LDQ     6,,PR5
         1 000475   400007 552120                    STBQ    7,'20'O,PR4

      266     8524    1           F$DCB.FORM$->CODE16.ATTR = FS$FORMREC.ATTR;

   8524  1 000476   100050 474500                    LDP4    40,,PR1
         1 000477   300000 475500                    LDP5    0,,PR3
         1 000500   500005 220100                    LDX0    5,,PR5
         1 000501   400003 440100                    SXL0    3,,PR4

      267     8525    1           F$DCB.ATTR = FS$FORMREC.ATTR;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:42   

   8525  1 000502   300000 474500                    LDP4    0,,PR3
         1 000503   400005 220100                    LDX0    5,,PR4
         1 000504   100040 440100                    SXL0    32,,PR1

   8525  1 000505                       FORMCONTUR   null
      268     8526    1   FORMCONTUR:;
      269     8527    1           IF FS$FORMREC.GRAPHIC

   8527  1 000505   200004 470500                    LDP0    @BUF$,,AUTO
         1 000506   000000 471500                    LDP1    0,,PR0
         1 000507   100004 430100                    FSZN    4,,PR1
         1 000510   000521 605000 1                  TPL     s:8534

      270     8528    2           THEN DO;

      271     8529    2              F$DCB.LINES = 0;

   8529  1 000511   000000 220003                    LDX0    0,DU
         1 000512   200006 473500                    LDP3    JDCB$,,AUTO
         1 000513   300044 740100                    STX0    36,,PR3

      272     8530    2              F$DCB.WIDTH = 0;

   8530  1 000514   000000 236003                    LDQ     0,DU
         1 000515   300004 552104                    STBQ    4,'04'O,PR3

      273     8531    2              F$DCB.DDEV = %DDEV_GR#;

   8531  1 000516   010000 236007                    LDQ     4096,DL
         1 000517   300004 552110                    STBQ    4,'10'O,PR3

      274     8532    2              END;

   8532  1 000520   000565 710000 1                  TRA     s:8548

      275     8533    2           ELSE DO;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:43   

      276     8534    2              IF F$DCB.LINES=0 OR

   8534  1 000521   200006 473500                    LDP3    JDCB$,,AUTO
         1 000522   300044 220100                    LDX0    36,,PR3
         1 000523   000534 600000 1                  TZE     s:8537
         1 000524   300044 236100                    LDQ     36,,PR3
         1 000525   000022 772000                    QRL     18
         1 000526   200054 756100                    STQ     @FNAME+1,,AUTO
         1 000527   100006 236100                    LDQ     6,,PR1
         1 000530   000022 772000                    QRL     18
         1 000531   000777 376007                    ANQ     511,DL
         1 000532   200054 116100                    CMPQ    @FNAME+1,,AUTO
         1 000533   000540 605000 1                  TPL     s:8539

      277     8535    2                F$DCB.LINES>FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
      278     8536    3              THEN DO;

      279     8537    3                 F$DCB.LINES=FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;

   8537  1 000534   000000 471500                    LDP1    0,,PR0
         1 000535   100006 220100                    LDX0    6,,PR1
         1 000536   000777 360003                    ANX0    511,DU
         1 000537   300044 740100                    STX0    36,,PR3

      280     8538    3                 END;

      281     8539    2              IF F$DCB.WIDTH=0 OR

   8539  1 000540   300004 236100                    LDQ     4,,PR3
         1 000541   000777 316007                    CANQ    511,DL
         1 000542   000553 600000 1                  TZE     s:8542
         1 000543   000000 471500                    LDP1    0,,PR0
         1 000544   300004 236100                    LDQ     4,,PR3
         1 000545   000777 376007                    ANQ     511,DL
         1 000546   200054 756100                    STQ     @FNAME+1,,AUTO
         1 000547   100006 236100                    LDQ     6,,PR1
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:44   
         1 000550   000033 772000                    QRL     27
         1 000551   200054 116100                    CMPQ    @FNAME+1,,AUTO
         1 000552   000565 605000 1                  TPL     s:8548

      282     8540    2                F$DCB.WIDTH>FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH
      283     8541    3              THEN DO;

      284     8542    3                 F$DCB.WIDTH=FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH;

   8542  1 000553   000000 471500                    LDP1    0,,PR0
         1 000554   100006 236100                    LDQ     6,,PR1
         1 000555   000033 772000                    QRL     27
         1 000556   300004 552104                    STBQ    4,'04'O,PR3

      285     8543    3                 IF FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID

   8543  1 000557   000000 471500                    LDP1    0,,PR0
         1 000560   100007 430100                    FSZN    7,,PR1
         1 000561   000565 605000 1                  TPL     s:8548

      286     8544    3                 THEN
      287     8545    3                    F$DCB.WIDTH = F$DCB.WIDTH + 254;

   8545  1 000562   300004 236100                    LDQ     4,,PR3
         1 000563   000376 036007                    ADLQ    254,DL
         1 000564   300004 552104                    STBQ    4,'04'O,PR3

      288     8546    3                 END;

      289     8547    2              END;

      290     8548    1           IF F$DCB.DVFC=BINASC(0) THEN

   8548  1 000565   300044 236100                    LDQ     36,,PR3
         1 000566   777000 376007                    ANQ     -512,DL
         1 000567   000000 116003                    CMPQ    0,DU
         1 000570   000573 601000 1                  TNZ     s:8550
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:45   

      291     8549    1              F$DCB.DVFC='A';

   8549  1 000571   101000 236007                    LDQ     33280,DL
         1 000572   300044 552110                    STBQ    36,'10'O,PR3

      292     8550    1           F$DCB.FORM$->CODE16.GOOD = '1'B;

   8550  1 000573   300050 471500                    LDP1    40,,PR3
         1 000574   400000 236007                    LDQ     -131072,DL
         1 000575   100026 256100                    ORSQ    22,,PR1

      293     8551    1           F$DCB.FORM$->CODE16.DVFC = F$DCB.DVFC;

   8551  1 000576   300050 471500                    LDP1    40,,PR3
         1 000577   300044 236100                    LDQ     36,,PR3
         1 000600   000022 736000                    QLS     18
         1 000601   100026 552140                    STBQ    22,'40'O,PR1

      294     8552    1           F$DCB.FORM$->CODE16.DDEV = F$DCB.DDEV;

   8552  1 000602   300050 471500                    LDP1    40,,PR3
         1 000603   300004 236100                    LDQ     4,,PR3
         1 000604   000022 736000                    QLS     18
         1 000605   100003 552140                    STBQ    3,'40'O,PR1

      295     8553    1           F$DCB.FORM$->CODE16.WSN = F$DCB.WSN;

   8553  1 000606   300050 471500                    LDP1    40,,PR3
         1 000607   040100 100500                    MLR     fill='040'O
         1 000610   300027 000010                    ADSC9   23,,PR3                  cn=0,n=8
         1 000611   100012 000010                    ADSC9   10,,PR1                  cn=0,n=8

      296     8554    1           F$DCB.FORM$->CODE16.DEV = F$DCB.RES;

   8554  1 000612   300050 471500                    LDP1    40,,PR3
         1 000613   300026 220100                    LDX0    22,,PR3
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:46   
         1 000614   100011 440100                    SXL0    9,,PR1

      297     8555    1           IF NOT FS$FORMREC.GRAPHIC

   8555  1 000615   000000 471500                    LDP1    0,,PR0
         1 000616   100004 430100                    FSZN    4,,PR1
         1 000617   000662 604000 1                  TMI     s:8566

      298     8556    2           THEN DO;

      299     8557    2              F$DCB.FORM$->CODE16.VFCIM = FS$FORMREC.SOFTFORM.VFUIM.V;

   8557  1 000620   300050 474500                    LDP4    40,,PR3
         1 000621   000100 100500                    MLR     fill='000'O
         1 000622   100012 400100                    ADSC9   10,,PR1                  cn=2,n=64
         1 000623   400027 000100                    ADSC9   23,,PR4                  cn=0,n=64

      300     8558    2              F$DCB.FORM$->CODE16.LINES = F$DCB.LINES;

   8558  1 000624   300050 471500                    LDP1    40,,PR3
         1 000625   300044 220100                    LDX0    36,,PR3
         1 000626   100006 440100                    SXL0    6,,PR1

      301     8559    2              F$DCB.FORM$->CODE16.LINENO = F$DCB.LINES;

   8559  1 000627   300050 471500                    LDP1    40,,PR3
         1 000630   300044 220100                    LDX0    36,,PR3
         1 000631   100005 440100                    SXL0    5,,PR1

      302     8560    2              F$DCB.FORM$->CODE16.WIDTH = F$DCB.WIDTH;

   8560  1 000632   300050 471500                    LDP1    40,,PR3
         1 000633   300004 236100                    LDQ     4,,PR3
         1 000634   000022 736000                    QLS     18
         1 000635   100026 552120                    STBQ    22,'20'O,PR1

      303     8561    2              F$DCB.FORM$->CODE16.CONTFORM =
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:47   

   8561  1 000636   300050 471500                    LDP1    40,,PR3
         1 000637   000000 474500                    LDP4    0,,PR0
         1 000640   400000 220003                    LDX0    -131072,DU
         1 000641   400006 236100                    LDQ     6,,PR4
         1 000642   777000 316007                    CANQ    -512,DL
         1 000643   000645 600000 1                  TZE     s:8561+7
         1 000644   000000 220003                    LDX0    0,DU
         1 000645   400000 221003                    LDX1    -131072,DU
         1 000646   000777 316007                    CANQ    511,DL
         1 000647   000651 600000 1                  TZE     s:8561+11
         1 000650   000000 221003                    LDX1    0,DU
         1 000651   000000 636011                    EAQ     0,X1
         1 000652   200054 756100                    STQ     @FNAME+1,,AUTO
         1 000653   000000 636010                    EAQ     0,X0
         1 000654   200054 376100                    ANQ     @FNAME+1,,AUTO
         1 000655   000010 772000                    QRL     8
         1 000656   100007 676100                    ERQ     7,,PR1
         1 000657   001000 376003                    ANQ     512,DU
         1 000660   100007 656100                    ERSQ    7,,PR1

      304     8562    2                (FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO=0) &
      305     8563    2                (FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE=0);
      306     8564    2              END;

   8564  1 000661   000701 710000 1                  TRA     s:8575

      307     8565    2           ELSE DO;

      308     8566    2              F$DCB.FORM$->CODE16.VFCIM = ZERO_VFC_IM;

   8566  1 000662   300050 474500                    LDP4    40,,PR3
         1 000663   000100 100400                    MLR     fill='000'O
         1 000664   000276 000100 0                  ADSC9   ZERO_VFC_IM              cn=0,n=64
         1 000665   400027 000100                    ADSC9   23,,PR4                  cn=0,n=64

      309     8567    2              F$DCB.FORM$->CODE16.LINES = 0;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:48   

   8567  1 000666   300050 471500                    LDP1    40,,PR3
         1 000667   000000 220003                    LDX0    0,DU
         1 000670   100006 440100                    SXL0    6,,PR1

      310     8568    2              F$DCB.FORM$->CODE16.WIDTH = 0;

   8568  1 000671   300050 471500                    LDP1    40,,PR3
         1 000672   000000 236003                    LDQ     0,DU
         1 000673   100026 552120                    STBQ    22,'20'O,PR1

      311     8569    2              F$DCB.FORM$->CODE16.LINENO = 0;

   8569  1 000674   300050 471500                    LDP1    40,,PR3
         1 000675   100005 440100                    SXL0    5,,PR1

      312     8570    2              F$DCB.FORM$->CODE16.CONTFORM = '1'B;

   8570  1 000676   300050 471500                    LDP1    40,,PR3
         1 000677   001000 236003                    LDQ     512,DU
         1 000700   100007 256100                    ORSQ    7,,PR1

      313     8571    2              END;

      314     8572                /* Get the banner repeats and charges from the form record
      315     8573                   and place them in the CODE16 block.
      316     8574                */
      317     8575    1           IF FS$FORMREC.BANRDISP = 0

   8575  1 000701   000000 471500                    LDP1    0,,PR0
         1 000702   100003 220100                    LDX0    3,,PR1
         1 000703   000713 601000 1                  TNZ     s:8581

      318     8576    2           THEN DO;

      319     8577    2              F$DCB.FORM$->CODE16.BANNER_REPEATS = 0;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:49   
   8577  1 000704   300050 474500                    LDP4    40,,PR3
         1 000705   000000 236003                    LDQ     0,DU
         1 000706   400007 552110                    STBQ    7,'10'O,PR4

      320     8578    2              F$DCB.FORM$->CODE16.BANNER_CHARGES = '0'B;

   8578  1 000707   300050 471500                    LDP1    40,,PR3
         1 000710   000003 236000 2                  LDQ     3
         1 000711   100007 356100                    ANSQ    7,,PR1

      321     8579    2              END;

   8579  1 000712   000735 710000 1                  TRA     s:8589

      322     8580    2           ELSE DO;

      323     8581    2              BANNER$ = PINCRW (ADDR(FS$FORMREC), FS$FORMREC.BANRDISP);

   8581  1 000713   100000 634510                    EPPR4   0,X0,PR1
         1 000714   200011 454500                    STP4    BANNER$,,AUTO

      324     8582    2              F$DCB.FORM$->CODE16.BANNER_REPEATS = BANNER.REPEATS;

   8582  1 000715   300050 475500                    LDP5    40,,PR3
         1 000716   000100 100500                    MLR     fill='000'O
         1 000717   400000 200001                    ADSC9   0,,PR4                   cn=1,n=1
         1 000720   500007 400001                    ADSC9   7,,PR5                   cn=2,n=1

      325     8583    2              F$DCB.FORM$->CODE16.BANNER_CHARGES = '1'B;

   8583  1 000721   300050 471500                    LDP1    40,,PR3
         1 000722   002000 236003                    LDQ     1024,DU
         1 000723   100007 256100                    ORSQ    7,,PR1

      326     8584    2              IF BANNER.CHARGE = 0

   8584  1 000724   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:50   
         1 000725   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         1 000726   200054 000004                    ADSC9   @FNAME+1,,AUTO           cn=0,n=4
         1 000727   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 000730   000000 116003                    CMPQ    0,DU
         1 000731   000735 601000 1                  TNZ     s:8589

      327     8585    3              THEN DO;

      328     8586    3                 F$DCB.FORM$->CODE16.BANNER_CHARGES = '0'B;

   8586  1 000732   300050 471500                    LDP1    40,,PR3
         1 000733   000003 236000 2                  LDQ     3
         1 000734   100007 356100                    ANSQ    7,,PR1

      329     8587    3                 END;

      330     8588    2              END;

      331     8589    1           CALL CLSTAR;

   8589  1 000735   002103 701000 1                  TSX1    CLSTAR
         1 000736   000000 011000                    NOP     0

      332     8590    1           B$JIT.DCB$=JDCB$;

   8590  1 000737   200006 236100                    LDQ     JDCB$,,AUTO
         1 000740   000000 470400 xsym               LDP0    B$JIT$
         1 000741   000232 756100                    STQ     154,,PR0

      333     8591    1           RETURN;

   8591  1 000742   000000 702200 xent               TSX2  ! X66_ARET

      334     8592    1   FSW$UCFORM: ENTRY(DEST$,BUF$)ALTRET;

   8592  1 000743   000000 700200 xent  FSW$UCFORM   TSX0  ! X66_AUTO_3
         1 000744   000060 000003                    ZERO    48,3
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:51   

      335     8593    1           CALL SETUPUC;

   8593  1 000745   002143 701000 1                  TSX1    SETUPUC
         1 000746   000000 011000                    NOP     0

      336     8594    1           KEY.C=F$DCB.PSN;

   8594  1 000747   200006 470500                    LDP0    JDCB$,,AUTO
         1 000750   040100 100500                    MLR     fill='040'O
         1 000751   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         1 000752   200014 200013                    ADSC9   KEY,,AUTO                cn=1,n=11

      337     8595    1           CALL READFORM ALTRET(ERR$ILLFORM);

   8595  1 000753   001205 701000 1                  TSX1    READFORM
         1 000754   001156 702000 1                  TSX2    ERR$ILLFORM

      338     8596    1           IF FS$FORMREC.GRAPHIC

   8596  1 000755   200004 470500                    LDP0    @BUF$,,AUTO
         1 000756   000000 471500                    LDP1    0,,PR0
         1 000757   100004 430100                    FSZN    4,,PR1
         1 000760   000762 605000 1                  TPL     s:8600

      339     8597    2           THEN DO;

      340     8598    2              GOTO ERR$CANTFORM;

   8598  1 000761   001161 710000 1                  TRA     ERR$CANTFORM

      341     8599    2              END;
      342     8600    1           IF NOT FS$FORMREC.LGLTYPS.TSOK THEN

   8600  1 000762   100004 236100                    LDQ     4,,PR1
         1 000763   000200 316003                    CANQ    128,DU
         1 000764   001161 600000 1                  TZE     ERR$CANTFORM
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:52   

      343     8601    1              GOTO ERR$CANTFORM;
      344     8602    1           CALL CLSTAR;

   8602  1 000765   002103 701000 1                  TSX1    CLSTAR
         1 000766   000000 011000                    NOP     0

      345     8603    1           B$JIT.DCB$=JDCB$;

   8603  1 000767   200006 236100                    LDQ     JDCB$,,AUTO
         1 000770   000000 470400 xsym               LDP0    B$JIT$
         1 000771   000232 756100                    STQ     154,,PR0

      346     8604    1           F$DCB.WAIT=1;

   8604  1 000772   200006 471500                    LDP1    JDCB$,,AUTO
         1 000773   000020 236007                    LDQ     16,DL
         1 000774   100064 256100                    ORSQ    52,,PR1

      347     8605    1           F$DCB.TYC(1)='0'B;

   8605  1 000775   100002 450100                    STZ     2,,PR1

      348     8606    1           F$DCB.UB$=ADDR(FS$FORMREC.SOFTFORM.VLPPLATEN);

   8606  1 000776   200004 473500                    LDP3    @BUF$,,AUTO
         1 000777   300000 474500                    LDP4    0,,PR3
         1 001000   200054 454500                    STP4    @FNAME+1,,AUTO
         1 001001   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 001002   000004 036000 2                  ADLQ    4
         1 001003   100075 756100                    STQ     61,,PR1

      349     8607    1           F$DCB.UBYTES=SIZEC(FS$FORMREC.SOFTFORM.VLPPLATEN);

   8607  1 001004   000022 235007                    LDA     18,DL
         1 001005   100076 755100                    STA     62,,PR1

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:53   
      350     8608    1           CALL KIA$UCIO(MFC_WRITE,%DVBYTE_TRANS#|%DVBYTE_VFC#|%DVBYTE_BP#,

   8608  1 001006   000007 630400 2                  EPPR0   7
         1 001007   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001010   000000 701000 xent               TSX1    KIA$UCIO
         1 001011   001152 702000 1                  TSX2    ERR$UCIO

      351     8609    1             %VFC_SPM,0)ALTRET(ERR$UCIO);
      352     8610    1           F$DCB.WIDTH=FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH;

   8610  1 001012   200004 470500                    LDP0    @BUF$,,AUTO
         1 001013   000000 471500                    LDP1    0,,PR0
         1 001014   200006 473500                    LDP3    JDCB$,,AUTO
         1 001015   100006 236100                    LDQ     6,,PR1
         1 001016   000033 772000                    QRL     27
         1 001017   300004 552104                    STBQ    4,'04'O,PR3

      353     8611    1           IF FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID

   8611  1 001020   000000 471500                    LDP1    0,,PR0
         1 001021   100007 430100                    FSZN    7,,PR1
         1 001022   001026 605000 1                  TPL     s:8614

      354     8612    1           THEN
      355     8613    1              F$DCB.WIDTH = F$DCB.WIDTH + 254;

   8613  1 001023   300004 236100                    LDQ     4,,PR3
         1 001024   000376 036007                    ADLQ    254,DL
         1 001025   300004 552104                    STBQ    4,'04'O,PR3

      356     8614    1           F$DCB.LINES=FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH;

   8614  1 001026   000000 471500                    LDP1    0,,PR0
         1 001027   100006 220100                    LDX0    6,,PR1
         1 001030   000777 360003                    ANX0    511,DU
         1 001031   300044 740100                    STX0    36,,PR3

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:54   
      357     8615    1           F$DCB.UB$=ADDR(FS$FORMREC.SOFTFORM.VFUIM);

   8615  1 001032   000000 471500                    LDP1    0,,PR0
         1 001033   100012 634500                    EPPR4   10,,PR1
         1 001034   300075 454500                    STP4    61,,PR3

      358     8616    1           F$DCB.UBYTES=SIZEC(FS$FORMREC.SOFTFORM.VFUIM);

   8616  1 001035   000102 235007                    LDA     66,DL
         1 001036   300076 755100                    STA     62,,PR3

      359     8617    1           CALL KIA$UCIO(MFC_WRITE,%DVBYTE_TRANS#|%DVBYTE_VFC#|%DVBYTE_BP#,

   8617  1 001037   000007 630400 2                  EPPR0   7
         1 001040   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001041   000000 701000 xent               TSX1    KIA$UCIO
         1 001042   001152 702000 1                  TSX2    ERR$UCIO

      360     8618    1             %VFC_SPM,0)ALTRET(ERR$UCIO);
      361     8619    1           B$JIT.ERR='0'B;

   8619  1 001043   000000 470400 xsym               LDP0    B$JIT$
         1 001044   000012 450100                    STZ     10,,PR0

      362     8620    1           RETURN;

   8620  1 001045   000000 702200 xent               TSX2  ! X66_ARET

      363     8621        /**/
      364     8622    1   FSW$URFORM: ENTRY(DEST$,BUF$)ALTRET;

   8622  1 001046   000000 700200 xent  FSW$URFORM   TSX0  ! X66_AUTO_3
         1 001047   000060 000003                    ZERO    48,3

      365     8623    1           CALL SETUP ALTRET(ALTR);

   8623  1 001050   002115 701000 1                  TSX1    SETUP
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:55   
         1 001051   001204 702000 1                  TSX2    ALTR

      366     8624    1           IF F$DCB.FORM$->CODE16.FORM<=' ' THEN

   8624  1 001052   200006 470500                    LDP0    JDCB$,,AUTO
         1 001053   000050 471500                    LDP1    40,,PR0
         1 001054   040100 106400                    CMPC    fill='040'O
         1 001055   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001056   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         1 001057   001063 602000 1                  TNC     s:8626

      367     8625    1              F$DCB.FORM$->CODE16.FORM=FSW_WTBLK.FNAME;

   8625  1 001060   040100 100400                    MLR     fill='040'O
         1 001061   000034 000006 0                  ADSC9   FSW_WTBLK+2              cn=0,n=6
         1 001062   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      368     8626    1           KEY.C=F$DCB.FORM$->CODE16.FORM;

   8626  1 001063   000050 471500                    LDP1    40,,PR0
         1 001064   040100 100500                    MLR     fill='040'O
         1 001065   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         1 001066   200014 200013                    ADSC9   KEY,,AUTO                cn=1,n=11

      369     8627    1           I = F$DCB.FORM$->CODE16.COPIES;

   8627  1 001067   100007 236100                    LDQ     7,,PR1
         1 001070   000022 772000                    QRL     18
         1 001071   000777 376007                    ANQ     511,DL
         1 001072   200012 756100                    STQ     I,,AUTO

      370     8628    1           CALL READFORM ALTRET(ERR$ILLFORM);

   8628  1 001073   001205 701000 1                  TSX1    READFORM
         1 001074   001156 702000 1                  TSX2    ERR$ILLFORM

      371     8629    1           F$DCB.FORM$->CODE16='0'B;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:56   

   8629  1 001075   200006 470500                    LDP0    JDCB$,,AUTO
         1 001076   000050 471500                    LDP1    40,,PR0
         1 001077   000100 100400                    MLR     fill='000'O
         1 001100   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001101   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156

      372     8630    1           F$DCB.FORM$->CODE16.FORM=KEY.C;

   8630  1 001102   000050 471500                    LDP1    40,,PR0
         1 001103   040100 100500                    MLR     fill='040'O
         1 001104   200014 200006                    ADSC9   KEY,,AUTO                cn=1,n=6
         1 001105   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      373     8631    1           IF I > 1 THEN

   8631  1 001106   200012 235100                    LDA     I,,AUTO
         1 001107   000002 115007                    CMPA    2,DL
         1 001110   001116 602000 1                  TNC     s:8634

      374     8632    1              F$DCB.FORM$->CODE16.COPIES = I;

   8632  1 001111   000050 471500                    LDP1    40,,PR0
         1 001112   200012 236100                    LDQ     I,,AUTO
         1 001113   000022 736000                    QLS     18
         1 001114   100007 552120                    STBQ    7,'20'O,PR1
         1 001115   001121 710000 1                  TRA     s:8635

      375     8633    1           ELSE
      376     8634    1              F$DCB.FORM$->CODE16.COPIES = 1;

   8634  1 001116   000050 471500                    LDP1    40,,PR0
         1 001117   000001 236003                    LDQ     1,DU
         1 001120   100007 552120                    STBQ    7,'20'O,PR1

      377     8635    1           IF FS$FORMREC.GRAPHIC

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:57   
   8635  1 001121   200004 471500                    LDP1    @BUF$,,AUTO
         1 001122   100000 473500                    LDP3    0,,PR1
         1 001123   300004 430100                    FSZN    4,,PR3
         1 001124   001133 605000 1                  TPL     s:8641

      378     8636    2           THEN DO; /* THIS IS GRAPHICS- SET DDEV */

      379     8637    2              F$DCB.FORM$->CODE16.ATTR = %ATTR_NOXLATE# ;

   8637  1 001125   000050 474500                    LDP4    40,,PR0
         1 001126   000100 220003                    LDX0    64,DU
         1 001127   400003 440100                    SXL0    3,,PR4

      380     8638    2              F$DCB.DDEV=%DDEV_GR#;

   8638  1 001130   010000 236007                    LDQ     4096,DL
         1 001131   000004 552110                    STBQ    4,'10'O,PR0

      381     8639    2              END;

   8639  1 001132   001151 710000 1                  TRA     s:8650

      382     8640    2           ELSE DO;

      383     8641    3              IF FS$FORMREC.LGLTYPS.LPOK THEN DO;

   8641  1 001133   300004 236100                    LDQ     4,,PR3
         1 001134   000400 316003                    CANQ    256,DU
         1 001135   001144 600000 1                  TZE     s:8646

      384     8642    3                 F$DCB.FORM$->CODE16.ATTR=%ATTR_TRUOVRPRT#|%ATTR_LOWERCASE#|%
              8642                          ATTR_UPPERCASE#;

   8642  1 001136   000050 474500                    LDP4    40,,PR0
         1 001137   000051 220003                    LDX0    41,DU
         1 001140   400003 440100                    SXL0    3,,PR4

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:58   
      385     8643    3                 F$DCB.DDEV=%DDEV_LP#;

   8643  1 001141   400000 236007                    LDQ     -131072,DL
         1 001142   000004 552110                    STBQ    4,'10'O,PR0

      386     8644    3                 END;

   8644  1 001143   001151 710000 1                  TRA     s:8650

      387     8645    3              ELSE DO;

      388     8646    3                F$DCB.FORM$->CODE16.ATTR=%ATTR_BIN#|%ATTR_LOWERCASE#|%ATTR_UPPERCASE#;

   8646  1 001144   000050 474500                    LDP4    40,,PR0
         1 001145   000043 220003                    LDX0    35,DU
         1 001146   400003 440100                    SXL0    3,,PR4

      389     8647    3                 F$DCB.DDEV='0'B;

   8647  1 001147   000000 236003                    LDQ     0,DU
         1 001150   000004 552110                    STBQ    4,'10'O,PR0

      390     8648    3                 END;

      391     8649    2              END;

      392     8650    1           GOTO FORMCONTUR;

   8650  1 001151   000505 710000 1                  TRA     FORMCONTUR

   8643  1 001152                       ERR$UCIO     null
      393     8651        /**/
      394     8652    1   ERR$UCIO:;
      395     8653    1           ERRSAVE=B$JIT.ERR;

   8653  1 001152   000000 470400 xsym               LDP0    B$JIT$
         1 001153   000012 236100                    LDQ     10,,PR0
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:59   
         1 001154   200037 756100                    STQ     ERRSAVE,,AUTO

      396     8654    1           GOTO TRUERR;

   8654  1 001155   001175 710000 1                  TRA     TRUERR

   8653  1 001156                       ERR$ILLFORM  null
      397     8655    1   ERR$ILLFORM:;
      398     8656    1           ERRSAVE=ERR_INVFORM;

   8656  1 001156   000027 236000 0                  LDQ     ERR_INVFORM
         1 001157   200037 756100                    STQ     ERRSAVE,,AUTO

      399     8657    1           GOTO MEBBETRUERR;

   8657  1 001160   001163 710000 1                  TRA     MEBBETRUERR

   8656  1 001161                       ERR$CANTFORM null
      400     8658    1   ERR$CANTFORM:;
      401     8659    1           ERRSAVE=ERR_CANTFORM;

   8659  1 001161   000030 236000 0                  LDQ     ERR_CANTFORM
         1 001162   200037 756100                    STQ     ERRSAVE,,AUTO

   8659  1 001163                       MEBBETRUERR  null
      402     8660    1   MEBBETRUERR:;
      403     8661    1           IF ADDR(JIT$)=ADDR(NIL) THEN GOTO TRUERR;

   8661  1 001163   200005 236100                    LDQ     @JIT$,,AUTO
         1 001164   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001165   001175 600000 1                  TZE     TRUERR

      404     8662    1           CALL OPENSTAR(WSNNAME);

   8662  1 001166   000013 236000 2                  LDQ     11
         1 001167   200053 756100                    STQ     MINGLCLLP+5,,AUTO
         1 001170   002016 701000 1                  TSX1    OPENSTAR
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:60   
         1 001171   000000 011000                    NOP     0

      405     8663    1           CALL READWSNERR ALTRET(TRUERR);

   8663  1 001172   001751 701000 1                  TSX1    READWSNERR
         1 001173   001175 702000 1                  TSX2    TRUERR

      406     8664    1           GOTO PASS2WSN;

   8664  1 001174   000076 710000 1                  TRA     PASS2WSN

   8661  1 001175                       TRUERR       null
      407     8665    1   TRUERR: ;
      408     8666    1           CALL CLSTAR;

   8666  1 001175   002103 701000 1                  TSX1    CLSTAR
         1 001176   000000 011000                    NOP     0

      409     8667    1           B$JIT.ERR=ERRSAVE;

   8667  1 001177   200037 236100                    LDQ     ERRSAVE,,AUTO
         1 001200   000000 470400 xsym               LDP0    B$JIT$
         1 001201   000012 756100                    STQ     10,,PR0

      410     8668    1           B$JIT.DCB$=JDCB$;

   8668  1 001202   200006 236100                    LDQ     JDCB$,,AUTO
         1 001203   000232 756100                    STQ     154,,PR0

      411     8669    1   ALTR:   ALTRETURN;

   8669  1 001204   000000 702200 xent  ALTR         TSX2  ! X66_AALT

      412     8670        /**/
      413     8671    1   READFORM: PROC ALTRET;

   8671  1 001205   200050 741300       READFORM     STX1  ! MINGLCLLP+2,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:61   

      414     8672    2           CALL OPENSTAR(FORMNAME) ALTRET(ALTR);

   8672  1 001206   000000 236000 2                  LDQ     0
         1 001207   200053 756100                    STQ     MINGLCLLP+5,,AUTO
         1 001210   002016 701000 1                  TSX1    OPENSTAR
         1 001211   001235 702000 1                  TSX2    ALTR
         1 001212   001214 710000 1                  TRA     s:8674

      415     8673    2   READFORMNOOPEN: ENTRY ALTRET;

   8673  1 001213   200050 741300       READFORMNOO* STX1  ! MINGLCLLP+2,,AUTO

      416     8674    2           KEY.L=6;

   8674  1 001214   006000 236003                    LDQ     3072,DU
         1 001215   200014 552140                    STBQ    KEY,'40'O,AUTO

      417     8675    2           CALL M$MREAD(AUTOREAD) ALTRET(ALTRIFLD);

   8675  1 001216   200020 630500                    EPPR0   AUTOREAD,,AUTO
         1 001217   200054 450500                    STP0    @FNAME+1,,AUTO
         1 001220   200054 630500                    EPPR0   @FNAME+1,,AUTO
         1 001221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001222   000000 701000 xent               TSX1    M$MREAD
         1 001223   001226 702000 1                  TSX2    ALTRIFLD

      418     8676    2           RETURN;

   8676  1 001224   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001225   000001 702211                    TSX2  ! 1,X1

      419     8677    2   ALTRIFLD: IF B$JIT.ERR.CODE = %E$LD THEN RETURN;

   8677  1 001226   000000 470400 xsym  ALTRIFLD     LDP0    B$JIT$
         1 001227   000012 236100                    LDQ     10,,PR0
         1 001230   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:62   
         1 001231   000070 116007                    CMPQ    56,DL
         1 001232   001235 601000 1                  TNZ     ALTR

   8677  1 001233   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001234   000001 702211                    TSX2  ! 1,X1

      420     8678    2   ALTR:   ALTRETURN;

   8678  1 001235   200050 221300       ALTR         LDX1  ! MINGLCLLP+2,,AUTO
         1 001236   000000 702211                    TSX2  ! 0,X1

      421     8679    2   END READFORM;
      422     8680        %EJECT;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:63   
      423     8681    1   READWSN: PROC ALTRET;

   8681  1 001237   200050 741300       READWSN      STX1  ! MINGLCLLP+2,,AUTO

      424     8682        /*      Find record for DCB's WSN in :WSN.:SYS; find entry for
      425     8683                DCB's RES in that record.  If successful, set up --
      426     8684                F$DCB has RES, WSN, ATTR, DDEV.
      427     8685                CODE16 has default FORM if it didn't have a Form.
      428     8686                   It has been verified that WSN exists, RES exists as
      429     8687                a device, user can access the wsn, user-specified ATTRs
      430     8688                are available at the device, and device can be written.
      431     8689                   This code is invoked for INSYM and PRESCAN via special
      432     8690                kludgery to do authorization checks as if they were
      433     8691                someone else; they pass a JIT, and this code looks at
      434     8692                ACCN and WOO in the JIT.
      435     8693                   For INSYM, the kludgery is simply that the passed
      436     8694                JIT's ACCN instead of INSYM's is used for auth checks.
      437     8695                   For PRESCAN, it is a little more complicated.  The
      438     8696                idea is to end up with a DCB open to a place where PRESCAN
      439     8697                can report the fact that it couldn't access another place.
      440     8698                Hence, it works like this.  First pass, we see if the user
      441     8699                represented by ACCN in the passed JIT can access the
      442     8700                place specified by WSN and RES in the DCB.  If so, fine;
      443     8701                return.  If not, put reason why not in the   p a s s e d
      444     8702                JIT, and try again using WOO in the passed JIT to replace
      445     8703                DCB.WSN.  The second time, make no ACCN authorization
      446     8704                checks at all; this is PRESCAN doing its best to report
      447     8705                the error.
      448     8706        */
      449     8707    2           IF F$DCB.WSN=' ' OR F$DCB.WSN='@' THEN

   8707  1 001240   200006 470500                    LDP0    JDCB$,,AUTO
         1 001241   040000 106500                    CMPC    fill='040'O
         1 001242   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         1 001243   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001244   001251 600000 1                  TZE     s:8708
         1 001245   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:64   
         1 001246   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         1 001247   000014 000001 2                  ADSC9   12                       cn=0,n=1
         1 001250   001255 601000 1                  TNZ     s:8709

      450     8708    2              F$DCB.WSN=B$JIT.WOO;

   8708  1 001251   000000 471400 xsym               LDP1    B$JIT$
         1 001252   100010 237100                    LDAQ    8,,PR1
         1 001253   000027 755100                    STA     23,,PR0
         1 001254   000030 756100                    STQ     24,,PR0

      451     8709    2           IF B$JIT$ = JIT$

   8709  1 001255   200005 471500                    LDP1    @JIT$,,AUTO
         1 001256   000000 236000 xsym               LDQ     B$JIT$
         1 001257   100000 116100                    CMPQ    0,,PR1
         1 001260   001277 601000 1                  TNZ     s:8716
         1 001261   000000 473400 xsym               LDP3    B$JIT$
         1 001262   300000 720100                    LXL0    0,,PR3
         1 001263   000020 100003                    CMPX0   16,DU
         1 001264   001277 603000 1                  TRC     s:8716
         1 001265   040000 106500                    CMPC    fill='040'O
         1 001266   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         1 001267   000322 000005 0                  ADSC9   ZERO_VFC_IM+20           cn=0,n=5
         1 001270   001277 601000 1                  TNZ     s:8716
         1 001271   000026 221100                    LDX1    22,,PR0
         1 001272   000324 101000 0                  CMPX1   ZERO_VFC_IM+22
         1 001273   001277 601000 1                  TNZ     s:8716

      452     8710    2             AND B$JIT.SYSID <= JG_MING#
      453     8711    2             AND F$DCB.WSN = 'LOCAL'
      454     8712    2             AND SUBSTR(F$DCB.RES,0,2)= 'LP'
      455     8713    2           THEN
      456     8714    2              MINGLCLLP = '1'B; /* MING want the local line printer */

   8714  1 001274   400000 236003                    LDQ     -131072,DU
         1 001275   200046 756100                    STQ     MINGLCLLP,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:65   
         1 001276   001300 710000 1                  TRA     s:8717

      457     8715    2           ELSE
      458     8716    2              MINGLCLLP = '0'B;

   8716  1 001277   200046 450100                    STZ     MINGLCLLP,,AUTO

      459     8717    2           JIT$->B$JIT.ERR='0'B;

   8717  1 001300   100000 473500                    LDP3    0,,PR1
         1 001301   300012 450100                    STZ     10,,PR3

      460     8718    2           CALL OPENSTAR(WSNNAME) ALTRET(LOCALONLY);

   8718  1 001302   000013 236000 2                  LDQ     11
         1 001303   200053 756100                    STQ     MINGLCLLP+5,,AUTO
         1 001304   002016 701000 1                  TSX1    OPENSTAR
         1 001305   001672 702000 1                  TSX2    LOCALONLY

   8717  1 001306                       PRESCANRETRY null
      461     8719    2   PRESCANRETRY:;
      462     8720    2           KEY.L=9;

   8720  1 001306   011000 236003                    LDQ     4608,DU
         1 001307   200014 552140                    STBQ    KEY,'40'O,AUTO

      463     8721    2           CALL CONCAT(KEY.C,F$DCB.WSN,'*');

   8721  1 001310   200006 470500                    LDP0    JDCB$,,AUTO
         1 001311   040100 100500                    MLR     fill='040'O
         1 001312   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         1 001313   200014 200010                    ADSC9   KEY,,AUTO                cn=1,n=8
         1 001314   000015 236000 2                  LDQ     13
         1 001315   200016 552134                    STBQ    KEY+2,'34'O,AUTO

      464     8722    2           CALL M$MREAD(AUTOREAD)ALTRET(LOCALONLY);

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:66   
   8722  1 001316   200020 630500                    EPPR0   AUTOREAD,,AUTO
         1 001317   200054 450500                    STP0    @FNAME+1,,AUTO
         1 001320   200054 630500                    EPPR0   @FNAME+1,,AUTO
         1 001321   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001322   000000 701000 xent               TSX1    M$MREAD
         1 001323   001672 702000 1                  TSX2    LOCALONLY

      465     8723    3           IF KL_WSNHDR.ACCSDISP~=0 THEN DO;

   8723  1 001324   200004 470500                    LDP0    @BUF$,,AUTO
         1 001325   000000 471500                    LDP1    0,,PR0
         1 001326   100000 720100                    LXL0    0,,PR1
         1 001327   001541 600000 1                  TZE     s:8817

      466     8724    3              WT$=PINCRW(BUF$,KL_WSNHDR.ACCSDISP);

   8724  1 001330   100000 633510                    EPPR3   0,X0,PR1
         1 001331   200010 453500                    STP3    WT$,,AUTO

      467     8725    4              IF KL_ACBLK.ACCTS>0 AND NOT MINGLCLLP THEN DO;

   8725  1 001332   300000 235100                    LDA     0,,PR3
         1 001333   001541 600000 1                  TZE     s:8817
         1 001334   200046 234100                    SZN     MINGLCLLP,,AUTO
         1 001335   001541 604000 1                  TMI     s:8817

      468     8726    4                 J=0;

   8726  1 001336   200013 450100                    STZ     J,,AUTO

      469     8727    5   NEXTACCT:     IF J=KL_ACBLK.ACCTS THEN DO;

   8727  1 001337   200010 470500       NEXTACCT     LDP0    WT$,,AUTO
         1 001340   200013 236100                    LDQ     J,,AUTO
         1 001341   000000 116100                    CMPQ    0,,PR0
         1 001342   001401 601000 1                  TNZ     s:8761

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:67   
      470     8728    5                    ERRSAVE=ERR_CANTWSN;

   8728  1 001343   000023 236000 0                  LDQ     ERR_CANTWSN
         1 001344   200037 756100                    STQ     ERRSAVE,,AUTO

      471     8729    5                    IF JIT$=B$JIT$ OR B$JIT.SYSID~=%JG_PRESCAN# THEN

   8729  1 001345   200005 471500                    LDP1    @JIT$,,AUTO
         1 001346   100000 236100                    LDQ     0,,PR1
         1 001347   000000 116000 xsym               CMPQ    B$JIT$
         1 001350   001355 600000 1                  TZE     s:8730
         1 001351   000000 473400 xsym               LDP3    B$JIT$
         1 001352   300000 720100                    LXL0    0,,PR3
         1 001353   000004 100003                    CMPX0   4,DU
         1 001354   001357 600000 1                  TZE     s:8731

      472     8730    5                       ALTRETURN;

   8730  1 001355   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001356   000000 702211                    TSX2  ! 0,X1

      473     8731    6                    IF NOT JIT$->B$JIT.ERR THEN DO; /* first pass */

   8731  1 001357   100000 474500                    LDP4    0,,PR1
         1 001360   400012 235100                    LDA     10,,PR4
         1 001361   001541 601000 1                  TNZ     s:8817

      474     8732    6                       JIT$->B$JIT.ERR=ERRSAVE;

   8732  1 001362   200037 236100                    LDQ     ERRSAVE,,AUTO
         1 001363   400012 756100                    STQ     10,,PR4

      475     8733    6                       JIT$->B$JIT.ERR.MON='1'B;

   8733  1 001364   100000 474500                    LDP4    0,,PR1
         1 001365   400000 236007                    LDQ     -131072,DL
         1 001366   400012 256100                    ORSQ    10,,PR4
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:68   

      476     8734    7                       IF JIT$->B$JIT.WOO~=F$DCB.WSN THEN DO;

   8734  1 001367   100000 474500                    LDP4    0,,PR1
         1 001370   200006 475500                    LDP5    JDCB$,,AUTO
         1 001371   040100 106500                    CMPC    fill='040'O
         1 001372   400010 000010                    ADSC9   8,,PR4                   cn=0,n=8
         1 001373   500027 000010                    ADSC9   23,,PR5                  cn=0,n=8
         1 001374   001541 600000 1                  TZE     s:8817

      477     8735    7                          F$DCB.WSN=JIT$->B$JIT.WOO;

   8735  1 001375   400010 237100                    LDAQ    8,,PR4
         1 001376   500027 755100                    STA     23,,PR5
         1 001377   500030 756100                    STQ     24,,PR5

      478     8736    7                          GOTO PRESCANRETRY;

   8736  1 001400   001306 710000 1                  TRA     PRESCANRETRY

      479     8737    7                          END;
      480     8738    6                       END;
      481     8739    5                    END;
      482     8740    5                 ELSE DO;

      483     8741                         %WILD_COMPARE(WILD_CHARS="KL_ACBLK.LIST(J)",
      484     8742                         COMPARE_CHARS="JIT$->B$JIT.ACCN",
      485     8743                         NO_MATCH="DO;J=J+1;GOTO NEXTACCT;END");

   8761  1 001401   200013 235100                    LDA     J,,AUTO
         1 001402   000001 735000                    ALS     1
         1 001403   000001 236105                    LDQ     1,AL,PR0
         1 001404   200040 756100                    STQ     WILD_X,,AUTO

   8762  1 001405   200040 236100                    LDQ     WILD_X,,AUTO
         1 001406   000320 376000 0                  ANQ     ZERO_VFC_IM+18
         1 001407   000321 116000 0                  CMPQ    ZERO_VFC_IM+19
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:69   
         1 001410   001416 601000 1                  TNZ     s:8776

   8763  1 001411   000003 236007                    LDQ     3,DL
         1 001412   200040 756100                    STQ     WILD_X,,AUTO

   8764  1 001413   000002 235007                    LDA     2,DL
         1 001414   200041 755100                    STA     WILD_XP,,AUTO

   8765  1 001415   001421 710000 1                  TRA     s:8779

   8776  1 001416   200040 450100                    STZ     WILD_X,,AUTO

   8777  1 001417   000010 236007                    LDQ     8,DL
         1 001420   200041 756100                    STQ     WILD_XP,,AUTO

   8779  1 001421   200042 450100                    STZ     COMPARE_X,,AUTO

   8780  1 001422   200043 450100                    STZ     COMPARE_XP,,AUTO

   8784  1 001423   001515 710000 1                  TRA     s:8809

   8786  1 001424   200040 235100                    LDA     WILD_X,,AUTO
         1 001425   000010 115007                    CMPA    8,DL
         1 001426   001441 603000 1                  TRC     s:8790
         1 001427   200013 236100                    LDQ     J,,AUTO
         1 001430   000003 736000                    QLS     3
         1 001431   200040 036100                    ADLQ    WILD_X,,AUTO
         1 001432   200010 470500                    LDP0    WT$,,AUTO
         1 001433   040000 106506                    CMPC    fill='040'O
         1 001434   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1
         1 001435   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 001436   001441 601000 1                  TNZ     s:8790

   8787  1 001437   200041 755100                    STA     WILD_XP,,AUTO

   8788  1 001440   001510 710000 1                  TRA     s:8808

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:70   
   8790  1 001441   200041 236100                    LDQ     WILD_XP,,AUTO
         1 001442   000001 036007                    ADLQ    1,DL
         1 001443   200040 116100                    CMPQ    WILD_X,,AUTO
         1 001444   001447 601000 1                  TNZ     s:8791

   8790  1 001445   200042 235100                    LDA     COMPARE_X,,AUTO
         1 001446   200043 755100                    STA     COMPARE_XP,,AUTO

   8791  1 001447   200040 235100                    LDA     WILD_X,,AUTO
         1 001450   000010 115007                    CMPA    8,DL
         1 001451   001467 603000 1                  TRC     s:8795
         1 001452   200005 470500                    LDP0    @JIT$,,AUTO
         1 001453   000000 471500                    LDP1    0,,PR0
         1 001454   200042 235100                    LDA     COMPARE_X,,AUTO
         1 001455   000010 115007                    CMPA    8,DL
         1 001456   001467 603000 1                  TRC     s:8795
         1 001457   200013 236100                    LDQ     J,,AUTO
         1 001460   000003 736000                    QLS     3
         1 001461   200040 036100                    ADLQ    WILD_X,,AUTO
         1 001462   200010 473500                    LDP3    WT$,,AUTO
         1 001463   040105 106506                    CMPC    fill='040'O
         1 001464   300001 000001                    ADSC9   1,Q,PR3                  cn=0,n=1
         1 001465   100001 000001                    ADSC9   1,A,PR1                  cn=0,n=1
         1 001466   001505 600000 1                  TZE     s:8806

   8795  1 001467   200041 235100                    LDA     WILD_XP,,AUTO
         1 001470   000010 115007                    CMPA    8,DL
         1 001471   001477 600000 1                  TZE     s:8796
         1 001472   200005 470500                    LDP0    @JIT$,,AUTO
         1 001473   000000 471500                    LDP1    0,,PR0
         1 001474   200043 236100                    LDQ     COMPARE_XP,,AUTO
         1 001475   000010 116007                    CMPQ    8,DL
         1 001476   001503 601000 1                  TNZ     s:8797

   8796  1 001477   200013 236100                    LDQ     J,,AUTO
         1 001500   000001 036007                    ADLQ    1,DL
         1 001501   200013 756100                    STQ     J,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:71   

   8796  1 001502   001337 710000 1                  TRA     NEXTACCT

   8797  1 001503   200040 755100                    STA     WILD_X,,AUTO

   8801  1 001504   200042 756100                    STQ     COMPARE_X,,AUTO

   8806  1 001505   200042 235100                    LDA     COMPARE_X,,AUTO
         1 001506   000001 035007                    ADLA    1,DL
         1 001507   200042 755100                    STA     COMPARE_X,,AUTO

   8808  1 001510   200040 235100                    LDA     WILD_X,,AUTO
         1 001511   000010 115007                    CMPA    8,DL
         1 001512   001515 603000 1                  TRC     s:8809

   8808  1 001513   000001 035007                    ADLA    1,DL
         1 001514   200040 755100                    STA     WILD_X,,AUTO

   8809  1 001515   200040 235100                    LDA     WILD_X,,AUTO
         1 001516   000010 115007                    CMPA    8,DL
         1 001517   001530 603000 1                  TRC     s:8809+11
         1 001520   200013 236100                    LDQ     J,,AUTO
         1 001521   000003 736000                    QLS     3
         1 001522   200040 036100                    ADLQ    WILD_X,,AUTO
         1 001523   200010 470500                    LDP0    WT$,,AUTO
         1 001524   040000 106506                    CMPC    fill='040'O
         1 001525   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1
         1 001526   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001527   001424 601000 1                  TNZ     s:8786
         1 001530   200005 470500                    LDP0    @JIT$,,AUTO
         1 001531   000000 471500                    LDP1    0,,PR0
         1 001532   200042 236100                    LDQ     COMPARE_X,,AUTO
         1 001533   000010 116007                    CMPQ    8,DL
         1 001534   001541 603000 1                  TRC     s:8817
         1 001535   040000 106506                    CMPC    fill='040'O
         1 001536   100001 000001                    ADSC9   1,Q,PR1                  cn=0,n=1
         1 001537   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:72   
         1 001540   001424 601000 1                  TNZ     s:8786

      486     8814    5                    END;

      487     8815    4                 END;

      488     8816    3              END;

      489     8817    3           IF KL_INDIRECT_WSN.INDIRECT# THEN DO;

   8817  1 001541   200004 470500                    LDP0    @BUF$,,AUTO
         1 001542   000000 471500                    LDP1    0,,PR0
         1 001543   100000 234100                    SZN     0,,PR1
         1 001544   001557 605000 1                  TPL     s:8822

      490     8818    3              F$DCB.ACCT = KL_INDIRECT_WSN.INDIRECT_WSN;

   8818  1 001545   200006 473500                    LDP3    JDCB$,,AUTO
         1 001546   040100 100500                    MLR     fill='040'O
         1 001547   100003 000010                    ADSC9   3,,PR1                   cn=0,n=8
         1 001550   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8

      491     8819    3              F$DCB.PASS = KL_INDIRECT_WSN.NODE;

   8819  1 001551   000000 471500                    LDP1    0,,PR0
         1 001552   040100 100500                    MLR     fill='040'O
         1 001553   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 001554   300022 000010                    ADSC9   18,,PR3                  cn=0,n=8

      492     8820    3              RETURN;

   8820  1 001555   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001556   000001 702211                    TSX2  ! 1,X1

      493     8821    3              END; /*  INDIRECT#  */
      494     8822    2           WT$=ADDR(NIL); /*MEANS NO SUCH DEV TYPE*/

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:73   
   8822  1 001557   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001560   200010 756100                    STQ     WT$,,AUTO

      495     8823    2           I=0;

   8823  1 001561   200012 450100                    STZ     I,,AUTO

      496     8824    3           DO WHILE (I<KL_WSNHDR.NTYP);

   8824  1 001562   200012 236100                    LDQ     I,,AUTO
         1 001563   100003 116100                    CMPQ    3,,PR1
         1 001564   001657 603000 1                  TRC     s:8842

      497     8825    4              IF SUBSTR(F$DCB.RES,0,2)=KL_WSNHDR.TYPS.TYP(I) THEN DO;

   8825  1 001565   200004 470500                    LDP0    @BUF$,,AUTO
         1 001566   000000 471500                    LDP1    0,,PR0
         1 001567   200006 473500                    LDP3    JDCB$,,AUTO
         1 001570   300026 220100                    LDX0    22,,PR3
         1 001571   200012 721100                    LXL1    I,,AUTO
         1 001572   100004 100111                    CMPX0   4,X1,PR1
         1 001573   001647 601000 1                  TNZ     s:8838

      498     8826    4                 WT$=PINCRW(BUF$,KL_WSNHDR.TYPS.DISP(I));

   8826  1 001574   100004 722111                    LXL2    4,X1,PR1
         1 001575   100000 634512                    EPPR4   0,X2,PR1
         1 001576   200010 454500                    STP4    WT$,,AUTO

      499     8827    5                 IF NOT KL_WTBLK.IO.OUTPUT THEN DO;

   8827  1 001577   400003 236100                    LDQ     3,,PR4
         1 001600   000200 316007                    CANQ    128,DL
         1 001601   001605 601000 1                  TNZ     s:8829

      500     8828    5                    ERRSAVE=ERR_NOTOUT; GOTO ERR; END;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:74   
   8828  1 001602   000025 236000 0                  LDQ     ERR_NOTOUT
         1 001603   200037 756100                    STQ     ERRSAVE,,AUTO

   8828  1 001604   001752 710000 1                  TRA     ERR

      501     8829    4                 TEMPATTR='777777777777'O; /*MEANS NO GOOD ATTRS*/

   8829  1 001605   000027 236000 xsym               LDQ     B_VECTNIL+23
         1 001606   200036 756100                    STQ     TEMPATTR,,AUTO

      502     8830    4                 J=0;

   8830  1 001607   200013 450100                    STZ     J,,AUTO

      503     8831    5                 DO WHILE (J<KL_WTBLK.NATR);

   8831  1 001610   200013 236100                    LDQ     J,,AUTO
         1 001611   400004 116100                    CMPQ    4,,PR4
         1 001612   001644 603000 1                  TRC     s:8836

      504     8832    5                    IF NOT(F$DCB.ATTR&~KL_WTBLK.ATTRS(J)) THEN

   8832  1 001613   200013 235100                    LDA     J,,AUTO
         1 001614   000001 735000                    ALS     1
         1 001615   200010 470500                    LDP0    WT$,,AUTO
         1 001616   000100 100505                    MLR     fill='000'O
         1 001617   000005 000002                    ADSC9   5,A,PR0                  cn=0,n=2
         1 001620   200054 000004                    ADSC9   @FNAME+1,,AUTO           cn=0,n=4
         1 001621   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 001622   777777 676003                    ERQ     -1,DU
         1 001623   200055 756100                    STQ     @FNAME+2,,AUTO
         1 001624   200006 471500                    LDP1    JDCB$,,AUTO
         1 001625   100040 236100                    LDQ     32,,PR1
         1 001626   000022 736000                    QLS     18
         1 001627   200055 376100                    ANQ     @FNAME+2,,AUTO
         1 001630   001637 601000 1                  TNZ     s:8834

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:75   
      505     8833    5                       TEMPATTR=TEMPATTR&KL_WTBLK.ATTRS(J);

   8833  1 001631   000100 100505                    MLR     fill='000'O
         1 001632   000005 000002                    ADSC9   5,A,PR0                  cn=0,n=2
         1 001633   200054 000004                    ADSC9   @FNAME+1,,AUTO           cn=0,n=4
         1 001634   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 001635   200036 376100                    ANQ     TEMPATTR,,AUTO
         1 001636   200036 756100                    STQ     TEMPATTR,,AUTO

      506     8834    5                    J=J+1;

   8834  1 001637   200013 236100                    LDQ     J,,AUTO
         1 001640   000001 036007                    ADLQ    1,DL
         1 001641   200013 756100                    STQ     J,,AUTO

      507     8835    5                    END;

   8835  1 001642   000004 116100                    CMPQ    4,,PR0
         1 001643   001613 602000 1                  TNC     s:8832

      508     8836    4                 IF TEMPATTR~='777777777777'O THEN GOTO GOTAGOOD;

   8836  1 001644   200036 236100                    LDQ     TEMPATTR,,AUTO
         1 001645   000027 116000 xsym               CMPQ    B_VECTNIL+23
         1 001646   001711 601000 1                  TNZ     GOTAGOOD

      509     8837    4                 END;

      510     8838    3              I=I+1;

   8838  1 001647   200012 235100                    LDA     I,,AUTO
         1 001650   000001 035007                    ADLA    1,DL
         1 001651   200012 755100                    STA     I,,AUTO

      511     8839    3              END;

   8839  1 001652   200004 470500                    LDP0    @BUF$,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:76   
         1 001653   000000 471500                    LDP1    0,,PR0
         1 001654   200012 236100                    LDQ     I,,AUTO
         1 001655   100003 116100                    CMPQ    3,,PR1
         1 001656   001565 602000 1                  TNC     s:8825

      512     8840                /* oops */
      513     8841        /* There was no device.  Check if this was a MING opening LP@LOCAL */
      514     8842    2           IF MINGLCLLP

   8842  1 001657   200046 234100                    SZN     MINGLCLLP,,AUTO
         1 001660   001672 604000 1                  TMI     LOCALONLY

      515     8843    2           THEN
      516     8844    2              GOTO LOCALONLY;
      517     8845    2           IF WT$=ADDR(NIL) THEN

   8845  1 001661   200010 236100                    LDQ     WT$,,AUTO
         1 001662   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001663   001667 601000 1                  TNZ     ERR$ILLATTR

      518     8846    2   ERR$ILLDEV: ERRSAVE=ERR_ILLDEV;

   8846  1 001664   000024 236000 0     ERR$ILLDEV   LDQ     ERR_ILLDEV
         1 001665   200037 756100                    STQ     ERRSAVE,,AUTO
         1 001666   001671 710000 1                  TRA     s:8849

      519     8847    2           ELSE
      520     8848    2   ERR$ILLATTR: ERRSAVE=ERR_ILLATTR;

   8848  1 001667   000026 236000 0     ERR$ILLATTR  LDQ     ERR_ILLATTR
         1 001670   200037 756100                    STQ     ERRSAVE,,AUTO

      521     8849    2           GOTO ERR;

   8849  1 001671   001752 710000 1                  TRA     ERR

      522     8850        /*
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:77   
      523     8851                If :WSN.:SYS doesn't exist or is bad, then the only legal
      524     8852                dd@wsn is LP@LOCAL.  Use a canned attribute block for it.
      525     8853         */
      526     8854    3   LOCALONLY: IF F$DCB.WSN~='LOCAL' THEN DO;

   8854  1 001672   200006 470500       LOCALONLY    LDP0    JDCB$,,AUTO
         1 001673   040000 106500                    CMPC    fill='040'O
         1 001674   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         1 001675   000322 000005 0                  ADSC9   ZERO_VFC_IM+20           cn=0,n=5
         1 001676   001702 600000 1                  TZE     s:8856

      527     8855    3              ERRSAVE=ERR_ILLWSN; GOTO ERR; END;

   8855  1 001677   000022 236000 0                  LDQ     ERR_ILLWSN
         1 001700   200037 756100                    STQ     ERRSAVE,,AUTO

   8855  1 001701   001752 710000 1                  TRA     ERR

      528     8856    3           IF SUBSTR(F$DCB.RES,0,2)~='LP' THEN DO;

   8856  1 001702   000026 220100                    LDX0    22,,PR0
         1 001703   000324 100000 0                  CMPX0   ZERO_VFC_IM+22
         1 001704   001706 600000 1                  TZE     s:8858

      529     8857    3              GOTO ERR$ILLDEV; END;

   8857  1 001705   001664 710000 1                  TRA     ERR$ILLDEV

      530     8858    2           WT$=ADDR(FSW_WTBLK);

   8858  1 001706   000016 236000 2                  LDQ     14
         1 001707   200010 756100                    STQ     WT$,,AUTO

      531     8859    2           TEMPATTR='0'B;

   8859  1 001710   200036 450100                    STZ     TEMPATTR,,AUTO

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:78   
      532     8860    2   GOTAGOOD:
      533     8861    2           F$DCB.ATTR=TEMPATTR;

   8861  1 001711   200036 220100       GOTAGOOD     LDX0    TEMPATTR,,AUTO
         1 001712   200006 470500                    LDP0    JDCB$,,AUTO
         1 001713   000040 440100                    SXL0    32,,PR0

      534     8862    2           F$DCB.DDEV=KL_WTBLK.DDEV&~(%DDEV_IC#|%DDEV_UCOUT#);

   8862  1 001714   200010 471500                    LDP1    WT$,,AUTO
         1 001715   100003 236100                    LDQ     3,,PR1
         1 001716   000022 736000                    QLS     18
         1 001717   777000 376003                    ANQ     -512,DU
         1 001720   657000 376003                    ANQ     -41472,DU
         1 001721   000022 772000                    QRL     18
         1 001722   000004 552110                    STBQ    4,'10'O,PR0

      535     8863    2           IF F$DCB.FORM$->CODE16.FORM<=' ' THEN

   8863  1 001723   000050 473500                    LDP3    40,,PR0
         1 001724   040100 106400                    CMPC    fill='040'O
         1 001725   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001726   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         1 001727   001734 602000 1                  TNC     s:8866

      536     8864    2              F$DCB.FORM$->CODE16.FORM=KL_WTBLK.FNAME;

   8864  1 001730   040100 100500                    MLR     fill='040'O
         1 001731   100002 000006                    ADSC9   2,,PR1                   cn=0,n=6
         1 001732   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         1 001733   001747 710000 1                  TRA     s:8868

      537     8865    2           ELSE
      538     8866    2              F$DCB.FORM$->CODE16.NSFORM=(F$DCB.FORM$->CODE16.FORM~=

   8866  1 001734   400000 221003                    LDX1    -131072,DU
         1 001735   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:79   
         1 001736   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         1 001737   100002 000006                    ADSC9   2,,PR1                   cn=0,n=6
         1 001740   001742 601000 1                  TNZ     s:8866+6
         1 001741   000000 221003                    LDX1    0,DU
         1 001742   000000 636011                    EAQ     0,X1
         1 001743   000003 772000                    QRL     3
         1 001744   300007 676100                    ERQ     7,,PR3
         1 001745   040000 376003                    ANQ     16384,DU
         1 001746   300007 656100                    ERSQ    7,,PR3

      539     8867    2                KL_WTBLK.FNAME);
      540     8868    2           RETURN;

   8868  1 001747   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001750   000001 702211                    TSX2  ! 1,X1

      541     8869        /*
      542     8870         */
      543     8871    2   READWSNERR: ENTRY ALTRET;

   8871  1 001751   200050 741300       READWSNERR   STX1  ! MINGLCLLP+2,,AUTO

   8871  1 001752                       ERR          null
      544     8872    2   ERR:    ;
      545     8873    2           IF JIT$=B$JIT$ OR B$JIT.SYSID~=%JG_PRESCAN# THEN ALTRETURN;

   8873  1 001752   200005 470500                    LDP0    @JIT$,,AUTO
         1 001753   000000 236100                    LDQ     0,,PR0
         1 001754   000000 116000 xsym               CMPQ    B$JIT$
         1 001755   001762 600000 1                  TZE     s:8873
         1 001756   000000 471400 xsym               LDP1    B$JIT$
         1 001757   100000 720100                    LXL0    0,,PR1
         1 001760   000004 100003                    CMPX0   4,DU
         1 001761   001764 600000 1                  TZE     s:8874

   8873  1 001762   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001763   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:80   

      546     8874    2           IF JIT$->B$JIT.ERR THEN ALTRETURN; /* second pass */

   8874  1 001764   000000 473500                    LDP3    0,,PR0
         1 001765   300012 235100                    LDA     10,,PR3
         1 001766   001771 600000 1                  TZE     s:8875

   8874  1 001767   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 001770   000000 702211                    TSX2  ! 0,X1

      547     8875    2           JIT$->B$JIT.ERR=ERRSAVE;

   8875  1 001771   200037 236100                    LDQ     ERRSAVE,,AUTO
         1 001772   300012 756100                    STQ     10,,PR3

      548     8876    2           JIT$->B$JIT.ERR.MON='1'B;

   8876  1 001773   000000 473500                    LDP3    0,,PR0
         1 001774   400000 236007                    LDQ     -131072,DL
         1 001775   300012 256100                    ORSQ    10,,PR3

      549     8877    2           IF JIT$->B$JIT.WOO=F$DCB.WSN THEN ALTRETURN;

   8877  1 001776   000000 473500                    LDP3    0,,PR0
         1 001777   200006 474500                    LDP4    JDCB$,,AUTO
         1 002000   040100 106500                    CMPC    fill='040'O
         1 002001   300010 000010                    ADSC9   8,,PR3                   cn=0,n=8
         1 002002   400027 000010                    ADSC9   23,,PR4                  cn=0,n=8
         1 002003   002006 601000 1                  TNZ     s:8878

   8877  1 002004   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 002005   000000 702211                    TSX2  ! 0,X1

      550     8878    2           F$DCB.WSN=JIT$->B$JIT.WOO;

   8878  1 002006   300010 237100                    LDAQ    8,,PR3
         1 002007   400027 755100                    STA     23,,PR4
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:81   
         1 002010   400030 756100                    STQ     24,,PR4

      551     8879    2           IF STAR$->F$DCB.FCD THEN

   8879  1 002011   200007 473500                    LDP3    STAR$,,AUTO
         1 002012   300031 236100                    LDQ     25,,PR3
         1 002013   020000 316007                    CANQ    8192,DL
         1 002014   001306 601000 1                  TNZ     PRESCANRETRY

      552     8880    2              GOTO PRESCANRETRY;
      553     8881    2           ELSE GOTO LOCALONLY;

   8881  1 002015   001672 710000 1                  TRA     LOCALONLY

      554     8882    2   END READWSN;
      555     8883        %EJECT;
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:82   
      556     8884    1   OPENSTAR: PROC(FNAME) ALTRET;

   8884  1 002016   200052 741300       OPENSTAR     STX1  ! MINGLCLLP+4,,AUTO

      557     8885        %VLP_NAME(FPTN=FNAME,STCLASS=,LEN="FNAME.L#");
      558     8912    2   DCL SC_FSFRMWSN ENTRY CONV(2,0);
      559     8913    2   DCL S_CTUIS SBIN SYMREF;
      560     8914    2           IF STAR$->F$DCB.FCD THEN

   8914  1 002017   200007 470500                    LDP0    STAR$,,AUTO
         1 002020   000031 236100                    LDQ     25,,PR0
         1 002021   020000 316007                    CANQ    8192,DL
         1 002022   002026 600000 1                  TZE     s:8916

      561     8915    2              CALL FMP$CLSJ;

   8915  1 002023   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002024   000000 701000 xent               TSX1    FMP$CLSJ
         1 002025   000000 011000                    NOP     0

      562     8916    2           CALL FMM$SCRUB(STAR$);

   8916  1 002026   200007 630500                    EPPR0   STAR$,,AUTO
         1 002027   200054 450500                    STP0    @FNAME+1,,AUTO
         1 002030   200054 630500                    EPPR0   @FNAME+1,,AUTO
         1 002031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002032   000000 701000 xent               TSX1    FMM$SCRUB
         1 002033   000000 011000                    NOP     0

      563     8917    2           STAR$->F$DCB.ASN=%FILE#;

   8917  1 002034   200007 470500                    LDP0    STAR$,,AUTO
         1 002035   001000 236007                    LDQ     512,DL
         1 002036   000032 552110                    STBQ    26,'10'O,PR0

      564     8918    2           STAR$->F$DCB.FUN=%IN#;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:83   
   8918  1 002037   000002 236003                    LDQ     2,DU
         1 002040   000032 552120                    STBQ    26,'20'O,PR0

      565     8919    2           STAR$->F$DCB.SHARE=%ALL#;

   8919  1 002041   000031 236100                    LDQ     25,,PR0
         1 002042   000017 376000 2                  ANQ     15
         1 002043   000200 276007                    ORQ     128,DL
         1 002044   000031 756100                    STQ     25,,PR0

      566     8920    2           STAR$->F$DCB.ACCT=':SYS';

   8920  1 002045   000325 235000 0                  LDA     ZERO_VFC_IM+23
         1 002046   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 002047   000020 757100                    STAQ    16,,PR0

      567     8921    2           STAR$->F$DCB.NAME=FNAME;

   8921  1 002050   200053 471500                    LDP1    @FNAME,,AUTO
         1 002051   000100 101500                    MRL     fill='000'O
         1 002052   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         1 002053   200054 000002                    ADSC9   @FNAME+1,,AUTO           cn=0,n=2
         1 002054   200054 220100                    LDX0    @FNAME+1,,AUTO
         1 002055   000001 621010                    EAX1    1,X0
         1 002056   000100 100540                    MLR     fill='000'O
         1 002057   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 002060   000010 000040                    ADSC9   8,,PR0                   cn=0,n=32

      568     8922    2           B$JIT.ERR='0'B;

   8922  1 002061   000000 473400 xsym               LDP3    B$JIT$
         1 002062   300012 450100                    STZ     10,,PR3

      569     8923    2           CALL FMM$DFLOPNP;

   8923  1 002063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002064   000000 701000 xent               TSX1    FMM$DFLOPNP
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:84   
         1 002065   000000 011000                    NOP     0

      570     8924    2           IF B$JIT.ERR.CODE=0 THEN RETURN;

   8924  1 002066   000000 470400 xsym               LDP0    B$JIT$
         1 002067   000012 236100                    LDQ     10,,PR0
         1 002070   377770 316007                    CANQ    131064,DL
         1 002071   002074 601000 1                  TNZ     s:8925

   8924  1 002072   200052 221300                    LDX1  ! MINGLCLLP+4,,AUTO
         1 002073   000001 702211                    TSX2  ! 1,X1

      571     8925    2           IF S_CTUIS>2 THEN CALL SC_FSFRMWSN;

   8925  1 002074   000000 235000 xsym               LDA     S_CTUIS
         1 002075   000002 115007                    CMPA    2,DL
         1 002076   002101 604400 1                  TMOZ    s:8926

   8925  1 002077   000000 713400 xsym               CLIMB   SC_FSFRMWSN
         1 002100   000000 600000 xsid               climb   nvectors=         0

      572     8926    2           ALTRETURN;

   8926  1 002101   200052 221300                    LDX1  ! MINGLCLLP+4,,AUTO
         1 002102   000000 702211                    TSX2  ! 0,X1

      573     8927    2   END OPENSTAR;
      574     8928    1   CLSTAR: PROC;

   8928  1 002103   200050 741300       CLSTAR       STX1  ! MINGLCLLP+2,,AUTO

      575     8929    2           IF STAR$->F$DCB.FCD THEN

   8929  1 002104   200007 470500                    LDP0    STAR$,,AUTO
         1 002105   000031 236100                    LDQ     25,,PR0
         1 002106   020000 316007                    CANQ    8192,DL
         1 002107   002113 600000 1                  TZE     s:8931
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:85   

      576     8930    2              CALL FMP$CLSJ;

   8930  1 002110   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002111   000000 701000 xent               TSX1    FMP$CLSJ
         1 002112   000000 011000                    NOP     0

      577     8931    2           RETURN;

   8931  1 002113   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 002114   000001 702211                    TSX2  ! 1,X1

      578     8932    2   END CLSTAR;
      579     8933    1   SETUP:  PROC ALTRET;

   8933  1 002115   200050 741300       SETUP        STX1  ! MINGLCLLP+2,,AUTO

      580     8934    2           JDCB$=B$JIT.DCB$;

   8934  1 002116   000000 470400 xsym               LDP0    B$JIT$
         1 002117   000232 236100                    LDQ     154,,PR0
         1 002120   200006 756100                    STQ     JDCB$,,AUTO

      581     8935    3           IF F$DCB.FORM$=ADDR(NIL) THEN DO;

   8935  1 002121   200006 471500                    LDP1    JDCB$,,AUTO
         1 002122   100050 236100                    LDQ     40,,PR1
         1 002123   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002124   002142 601000 1                  TNZ     s:8938

      582     8936    3              CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(ALTR);

   8936  1 002125   200006 236100                    LDQ     JDCB$,,AUTO
         1 002126   000050 036003                    ADLQ    40,DU
         1 002127   000021 235000 2                  LDA     17
         1 002130   200054 757100                    STAQ    @FNAME+1,,AUTO
         1 002131   200054 630500                    EPPR0   @FNAME+1,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:86   
         1 002132   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002133   000000 701000 xent               TSX1    FSA$GSP
         1 002134   002217 702000 1                  TSX2    ALTR

      583     8937    3              F$DCB.FORM$->CODE16='0'B;

   8937  1 002135   200006 470500                    LDP0    JDCB$,,AUTO
         1 002136   000050 471500                    LDP1    40,,PR0
         1 002137   000100 100400                    MLR     fill='000'O
         1 002140   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 002141   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156

      584     8938    3              END;

   8938  1 002142   002144 710000 1                  TRA     s:8940

      585     8939    2   SETUPUC: ENTRY ALTRET;

   8939  1 002143   200050 741300       SETUPUC      STX1  ! MINGLCLLP+2,,AUTO

      586     8940    2           JDCB$=B$JIT.DCB$;

   8940  1 002144   000000 470400 xsym               LDP0    B$JIT$
         1 002145   000232 236100                    LDQ     154,,PR0
         1 002146   200006 756100                    STQ     JDCB$,,AUTO

      587     8941    2           STAR$=DCBADDR(%M$STAR#);

   8941  1 002147   000022 471400 2                  LDP1    18
         1 002150   100000 473500                    LDP3    0,,PR1
         1 002151   300001 236100                    LDQ     1,,PR3
         1 002152   200007 756100                    STQ     STAR$,,AUTO

      588     8942    2           B$JIT.DCB$=STAR$;

   8942  1 002153   000232 756100                    STQ     154,,PR0

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:87   
      589     8943    2           IF STAR$->F$DCB.FCD THEN

   8943  1 002154   200007 474500                    LDP4    STAR$,,AUTO
         1 002155   400031 236100                    LDQ     25,,PR4
         1 002156   020000 316007                    CANQ    8192,DL
         1 002157   002163 600000 1                  TZE     s:8945

      590     8944    2              CALL FMP$CLSJ;

   8944  1 002160   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002161   000000 701000 xent               TSX1    FMP$CLSJ
         1 002162   000000 011000                    NOP     0

      591     8945    2           AUTOREAD=CONSTREAD;

   8945  1 002163   000100 100400                    MLR     fill='000'O
         1 002164   000000 000070 0                  ADSC9   CONSTREAD                cn=0,n=56
         1 002165   200020 000070                    ADSC9   AUTOREAD,,AUTO           cn=0,n=56

      592     8946    2           AUTOREAD.V_=VECTOR(AUTOREAD.V);

   8946  1 002166   000023 235000 2                  LDA     19
         1 002167   200054 452500                    STP2    @FNAME+1,,AUTO
         1 002170   200054 236100                    LDQ     @FNAME+1,,AUTO
         1 002171   000030 036003                    ADLQ    24,DU
         1 002172   200020 757100                    STAQ    AUTOREAD,,AUTO

      593     8947    2           AUTOREAD.V.DCB#=%M$STAR#;

   8947  1 002173   000001 220003                    LDX0    1,DU
         1 002174   200030 740100                    STX0    AUTOREAD+8,,AUTO

      594     8948    2           AUTOREAD.KEY_=VECTOR(KEY);

   8948  1 002175   000024 235000 2                  LDA     20
         1 002176   200054 452500                    STP2    @FNAME+1,,AUTO
         1 002177   200054 236100                    LDQ     @FNAME+1,,AUTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:88   
         1 002200   000014 036003                    ADLQ    12,DU
         1 002201   200022 757100                    STAQ    AUTOREAD+2,,AUTO

      595     8949    2           AUTOREAD.BUF_.BUF$=BUF$;

   8949  1 002202   200004 470500                    LDP0    @BUF$,,AUTO
         1 002203   000000 236100                    LDQ     0,,PR0
         1 002204   200025 756100                    STQ     AUTOREAD+5,,AUTO

      596     8950    2           KL_INDIRECT_WSN = '0'B;

   8950  1 002205   000000 471500                    LDP1    0,,PR0
         1 002206   000100 100400                    MLR     fill='000'O
         1 002207   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 002210   100000 000024                    ADSC9   0,,PR1                   cn=0,n=20

      597     8951    2           AUTOREAD.BUF_.BOUND=4095-SIZEC(FS$DEST);

   8951  1 002211   200024 236100                    LDQ     AUTOREAD+4,,AUTO
         1 002212   177777 376007                    ANQ     65535,DL
         1 002213   000025 276000 2                  ORQ     21
         1 002214   200024 756100                    STQ     AUTOREAD+4,,AUTO

      598     8952    2           RETURN;

   8952  1 002215   200050 221300                    LDX1  ! MINGLCLLP+2,,AUTO
         1 002216   000001 702211                    TSX2  ! 1,X1

      599     8953    2   ALTR:   ALTRETURN;

   8953  1 002217   200050 221300       ALTR         LDX1  ! MINGLCLLP+2,,AUTO
         1 002220   000000 702211                    TSX2  ! 0,X1

CONSTREAD
 Sect OctLoc
   0     000   000005 777640   000010 006000   000000 177640   000000 006014    ................
   0     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:89   
   0     010   000000 600000   000000 000000   000000 000000   000000 000000    ................
   0     014   000000 000000   000000 000000                                    ........

WSNNAME
 Sect OctLoc
   0     016   004072 127123   116*** ******                                    .:WSN...

FORMNAME
 Sect OctLoc
   0     020   005072 106117   122115 ******                                    .:FORM..

ERR_ILLWSN
 Sect OctLoc
   0     022   062327 013742                                                    2...

ERR_CANTWSN
 Sect OctLoc
   0     023   062327 013752                                                    2...

ERR_ILLDEV
 Sect OctLoc
   0     024   062327 013732                                                    2...

ERR_NOTOUT
 Sect OctLoc
   0     025   062327 014022                                                    2...

ERR_ILLATTR
 Sect OctLoc
   0     026   062327 014002                                                    2...

ERR_INVFORM
 Sect OctLoc
   0     027   062327 013762                                                    2...

ERR_CANTFORM
 Sect OctLoc
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:90   
   0     030   062327 013772                                                    2...

ERR_NOTAUTHFORM
 Sect OctLoc
   0     031   062327 014042                                                    2.."

FSW_WTBLK
 Sect OctLoc
   0     032   114117 103101   114040 040040   123124 104114   120040 400200    LOCAL   STDLP ..
   0     036   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     046*  000000 000000   003124 124131   040040 040040   040040 040040    .....TTY

FSW_FORMREC
 Sect OctLoc
   0     052   123124 104114   120040 000000   000000 000000   000000 000000    STDLP ..........
   0     056   000600 040040   000006 010020   204047 006006   000006 000000    ..  .....'......
   0     062   000000 000000   000000 000000   022100 000000   000000 000000    .........@......
   0     066   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     102*  000000 000000   000000 000000   000000 066060   060040 040040    ..........600
   0     106   040040 102104   106107 110112   147123 060101   103105 111116      BDFGHJgS0ACEIN
   0     112   117122 114124   141142 143144   145146 113150   151152 153154    ORLTabcdefKhijkl
   0     116   155115 060120   121125 126127   130131 132072   073077 041045    mM0PQUVWXYZ:;?!%
   0     122   067170 171156   157160 162163   164167 060172   061062 063064    7xynoprstw0z1234
   0     126   065066 043070   071056 054050   051100 044075   046057 047134    56#89.,()@$=&/'\
   0     132   136137 060042   074076 133135   147123 176101   103105 111116    ^_0"<>[]gS~ACEIN
   0     136   117122 173124   141142 143144   145146 060150   151152 153154    OR{Tabcdef0hijkl
   0     142   155175 174140   055052 053161   165166 102104   106107 110112    m}|`-*+quvBDFGHJ
   0     146   067170 060156   157160 162163   164167 114172   061062 063064    7x0noprstwLz1234
   0     152   065066 113070   071056 054050   051115 060120   121125 126127    56K89.,()M0PQUVW
   0     156   130131 132072   073077 041045   147123 171101   103105 111116    XYZ:;?!%gSyACEIN
   0     162   117122 060124   141142 143144   145146 043150   151152 153154    OR0Tabcdef#hijkl
   0     166   155100 044075   046057 047134   136137 060042   074076 133135    m@$=&/'\^_0"<>[]
   0     172   067170 176156   157160 162163   164167 173172   061062 063064    7x~noprstw{z1234
   0     176   065066 060070   071056 054050   051175 174140   055052 053161    56089.,()}|`-*+q
   0     202   165166 ******                                                    uv..

FSW_FORMREC_BAN
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:91   
 Sect OctLoc
   0     203   000002 001015   001001 000001   000001 000000   007000 000000    ................
   0     207   000000 000000   001012 000001   000001 000000   006000 000000    ................
   0     213   000000 000000   001022 000001   000001 000000   002000 000000    ................
   0     217   000000 000000   001033 000001   000001 000000   003000 000000    ................
   0     223   000000 000000   001050 000001   000001 000000   004000 000000    .....(..........
   0     227   000000 000000   001062 000001   000001 000000   001000 000000    .....2..........
   0     233   000000 000000   003001 001002   001001 000000   000000 065011    ..............5.
   0     237   000000 000000   003120 000002   000001 000000   012000 000000    .....P..........
   0     243   000000 000000   017001 000001   000003 002000   000000 070007    ..............8.
   0     247   000000 000000   017011 000001   000003 002000   010000 000000    ................
   0     253   000000 000000   017024 001002   001001 000000   001000 000000    ................
   0     257   000000 000000   032012 001003   001001 000000   003000 000000    ................
   0     263   000000 000000   055001 000001   000002 000000   013000 000052    ....-..........*
   0     267   000000 000000   110157 156145   171167 145154   154040 040040    ....Honeywell
   0     273   126105 122123   111117 116040                                    VERSION

PL6ISDUMB
 Sect OctLoc
   0     275   000000 000350                                                    ....

ZERO_VFC_IM
 Sect OctLoc
   0     276   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     312*  000000 000000   000000 000000   000000 000000   000000 000000    ................

(unnamed)
 Sect OctLoc
   0     316   123124 104114   120040 040040   737737 737777   101114 114040    STDLP   ....ALL
   0     322   114117 103101   114040 040040   114120 040040   072123 131123    LOCAL   LP  :SYS

(unnamed)
 Sect OctLoc
   2     000   000020 006000   000017 400000   077040 040040   775777 777777    ........?   ....
   2     004   000005 400000   320000 000000   024040 040040   000003 006000    .........   ....
   2     010   000005 006000   000006 006000   000002 006000   000016 006000    ................
   2     014   100040 040040   000052 040040   000032 006000   777777 777177    @   .*  ........
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:92   
   2     020   000000 000047   000020 006000   000000 006003   000005 777640    ...'............
   2     024   000002 777640   001744 600000                                    ........
      600     8954    2   END SETUP;
      601     8955    1   END FSW$DESTFORM;

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:93   
--  Include file information  --

   XG_SUBS_C.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F_MACROS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FSW$DESTFORM.
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:94   

 **** Variables and constants ****

  ****  Section 000 RoData FSW$DESTFORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(504)   r     1 CONSTREAD                 30-0-0/b STRC        r     1 ERR_CANTFORM
    23-0-0/b STRC        r     1 ERR_CANTWSN               26-0-0/b STRC        r     1 ERR_ILLATTR
    24-0-0/b STRC        r     1 ERR_ILLDEV                22-0-0/b STRC        r     1 ERR_ILLWSN
    27-0-0/b STRC        r     1 ERR_INVFORM               31-0-0/b STRC        r     1 ERR_NOTAUTHFORM
    25-0-0/b STRC        r     1 ERR_NOTOUT                20-0-0/c STRC(54)    r     1 FORMNAME
    52-0-0/w STRC(3186)  r     1 FSW_FORMREC              203-0-0/c STRC(2088)  r     1 FSW_FORMREC_BAN
    32-0-0/w STRC(576)   r     1 FSW_WTBLK                275-0-0/w UBIN        r     1 PL6ISDUMB
    16-0-0/c STRC(45)    r     1 WSNNAME                  276-0-0/b STRC(576)   r     1 ZERO_VFC_IM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF$                      3-0-0/w PTR         r     1 @DEST$
    53-0-0/w PTR         r     1 @FNAME                     5-0-0/w PTR         r     1 @JIT$
    20-0-0/d STRC(504)   r     1 AUTOREAD                  11-0-0/w PTR         r     1 BANNER$
    *0-0-0/w PTR         r     1 BUF$                      44-0-0/c CHAR(8)     r     1 COMPACCT
    42-0-0/w UBIN        r     1 COMPARE_X                 43-0-0/w UBIN        r     1 COMPARE_XP
    *0-0-0/w PTR         r     1 DEST$                     37-0-0/b BIT         r     1 ERRSAVE
    *0-0-0/c ASTR(9)     r     1 FNAME                     12-0-0/w UBIN        r     1 I
    13-0-0/w UBIN        r     1 J                          6-0-0/w PTR         r     1 JDCB$
    *0-0-0/w PTR         r     1 JIT$                      14-0-0/c STRC(108)   r     1 KEY
    46-0-0/b BIT         r     1 MINGLCLLP                  7-0-0/w PTR         r     1 STAR$
    36-0-0/b BIT         r     1 TEMPATTR                  40-0-0/w UBIN        r     1 WILD_X
    40-0-0/w CHAR(4)     r     1 WILD_XC                   41-0-0/w UBIN        r     1 WILD_XP
    10-0-0/w PTR         r     1 WT$

  ****  SYMREF variables  ****

PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:95   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w SBIN        r     1 S_CTUIS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/c STRC(180)   r     1 BANNER
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/c STRC(108)   r     1 FS$ACCT                    0-0-0/w STRC(972)   r     1 FS$DEST
     0-0-0/w STRC(3186)  r     1 FS$FORMREC                 0-0-0/w STRC(108)   r     1 KL_ACBLK
     0-0-0/w STRC(180)   r     1 KL_INDIRECT_WSN            0-0-0/w STRC(180)   r     1 KL_WSNHDR
     0-0-0/w STRC(576)   r     1 KL_WTBLK                   0-0-0/c ASTR(0)     r     1 MOVEBANNER


   Procedure FSW$DESTFORM requires 1169 words for executable code.
   Procedure FSW$DESTFORM requires 48 words of local(AUTO) storage.

    No errors detected in file FSW$WSN.:E05TSI    .
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:96   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:97   
          MINI XREF LISTING

ALTR
      8669**LABEL    8386--CALLALT  8409--CALLALT  8623--CALLALT
ALTR IN PROCEDURE READFORM
      8678**LABEL    8672--CALLALT
ALTR IN PROCEDURE SETUP
      8953**LABEL    8936--CALLALT
ALTRIFLD IN PROCEDURE READFORM
      8677**LABEL    8675--CALLALT
AUTOREAD
      7178**DCL      8675<>CALL     8722<>CALL     8945<<ASSIGN
AUTOREAD.BUF_.BOUND
      7180**DCL      8951<<ASSIGN
AUTOREAD.BUF_.BUF$
      7181**DCL      8949<<ASSIGN
AUTOREAD.KEY_
      7178**DCL      8948<<ASSIGN
AUTOREAD.STATION_
      7181**DCL      7182--REDEF
AUTOREAD.V
      7182**DCL      8946--ASSIGN
AUTOREAD.V.DCB#
      7182**DCL      8947<<ASSIGN
AUTOREAD.V.DVBYTE.REREAD#
      7193**DCL      7193--REDEF
AUTOREAD.V.INDX#
      7191**DCL      7191--REDEF
AUTOREAD.V_
      7178**DCL      8946<<ASSIGN
B$JIT.ACCN
       383**DCL      8426>>ASSIGN   8427>>ASSIGN   8428>>ASSIGN   8784--DOWHILE  8784>>DOWHILE  8791--IF
      8791>>IF       8795--IF
B$JIT.CPFLAGS1.SLEAZE
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:98   
       477**DCL       477--REDEF
B$JIT.DCB$
       551**DCL      8590<<ASSIGN   8603<<ASSIGN   8668<<ASSIGN   8934>>ASSIGN   8940>>ASSIGN   8942<<ASSIGN
B$JIT.ERR
       383**DCL      8427>>IF       8619<<ASSIGN   8653>>ASSIGN   8667<<ASSIGN   8717<<ASSIGN   8731>>IF
      8732<<ASSIGN   8874>>IF       8875<<ASSIGN   8922<<ASSIGN
B$JIT.ERR.CODE
       384**DCL      8677>>IF       8924>>IF
B$JIT.ERR.MID
       384**DCL       384--REDEF
B$JIT.ERR.MON
       384**DCL      8733<<ASSIGN   8876<<ASSIGN
B$JIT.JOBNAME
       532**DCL      8399>>ASSIGN
B$JIT.JRESPEAK
       545**DCL       546--REDEF
B$JIT.MODE
       378**DCL      8398>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       654**DCL       654--REDEF     655--REDEF
B$JIT.OUTPRIO
       464**DCL      8395>>ASSIGN
B$JIT.PNR
       558**DCL       558--REDEF
B$JIT.SYSID
       383**DCL      8396>>IF       8396>>IF       8709>>IF       8729>>IF       8873>>IF
B$JIT.TSLINE
       652**DCL       653--REDEF
B$JIT.WOO
       383**DCL      8708>>ASSIGN   8734>>IF       8735>>ASSIGN   8877>>IF       8878>>ASSIGN
B$JIT$
      7150**DCL       378--IMP-PTR  8396>>IF       8396>>IF       8398>>ASSIGN   8399>>ASSIGN   8426>>ASSIGN
      8427>>ASSIGN   8590>>ASSIGN   8603>>ASSIGN   8619>>ASSIGN   8653>>ASSIGN   8667>>ASSIGN   8668>>ASSIGN
      8677>>IF       8708>>ASSIGN   8709>>IF       8709>>IF       8729>>IF       8729>>IF       8873>>IF
      8873>>IF       8922>>ASSIGN   8924>>IF       8934>>ASSIGN   8940>>ASSIGN   8942>>ASSIGN
BANNER.CHARGE
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:99   
      8329**DCL      8330--REDEF    8584>>IF
BANNER.ENTRIES.COUNT
      8350**DCL      8351--REDEF
BANNER.ENTRIES.DISP
      8346**DCL      8347--REDEF
BANNER.REPEATS
      8333**DCL      8582>>ASSIGN
BANNER$
      7155**DCL      8328--IMP-PTR  8581<<ASSIGN   8582>>ASSIGN   8584>>IF
BUF$
        53**DCL        50--PROC     8121--IMP-PTR  8132--IMP-PTR  8188--IMP-PTR  8249--IMP-PTR  8388>>ASSIGN
      8401>>IF       8408--ENTRY    8416>>ASSIGN   8417>>ASSIGN   8418>>ASSIGN   8421>>CALL     8422>>CALL
      8423>>IF       8424>>ASSIGN   8424>>ASSIGN   8509>>ASSIGN   8510>>IF       8516>>ASSIGN   8517>>ASSIGN
      8524>>ASSIGN   8525>>ASSIGN   8527>>IF       8534>>IF       8537>>ASSIGN   8539>>IF       8542>>ASSIGN
      8543>>IF       8555>>IF       8557>>ASSIGN   8561>>ASSIGN   8561>>ASSIGN   8575>>IF       8581>>ASSIGN
      8581>>ASSIGN   8592--ENTRY    8596>>IF       8600>>IF       8606>>ASSIGN   8610>>ASSIGN   8611>>IF
      8614>>ASSIGN   8615>>ASSIGN   8622--ENTRY    8635>>IF       8641>>IF       8723>>IF       8724>>ASSIGN
      8724>>ASSIGN   8817>>IF       8818>>ASSIGN   8819>>ASSIGN   8824>>DOWHILE  8825>>IF       8826>>ASSIGN
      8826>>ASSIGN   8949>>ASSIGN   8950>>ASSIGN
CLSTAR
      8928**PROC     8589--CALL     8602--CALL     8666--CALL
CODE16
      8113**DCL      8520<<ASSIGN   8629<<ASSIGN   8936--CALL     8937<<ASSIGN
CODE16.ATTR
      8113**DCL      8524<<ASSIGN   8637<<ASSIGN   8642<<ASSIGN   8646<<ASSIGN
CODE16.BANNER_CHARGES
      8115**DCL      8578<<ASSIGN   8583<<ASSIGN   8586<<ASSIGN
CODE16.BANNER_REPEATS
      8115**DCL      8577<<ASSIGN   8582<<ASSIGN
CODE16.CONTFORM
      8115**DCL      8561<<ASSIGN   8570<<ASSIGN
CODE16.COPIES
      8115**DCL      8391>>ASSIGN   8523<<ASSIGN   8627>>ASSIGN   8632<<ASSIGN   8634<<ASSIGN
CODE16.DDEV
      8113**DCL      8552<<ASSIGN
CODE16.DEV
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:100  
      8116**DCL      8554<<ASSIGN
CODE16.DVFC
      8117**DCL      8551<<ASSIGN
CODE16.FORM
      8113**DCL      8411>>ASSIGN   8522<<ASSIGN   8624>>IF       8625<<ASSIGN   8626>>ASSIGN   8630<<ASSIGN
      8863>>IF       8864<<ASSIGN   8866>>ASSIGN
CODE16.GOOD
      8117**DCL      8550<<ASSIGN
CODE16.LINENO
      8114**DCL      8559<<ASSIGN   8569<<ASSIGN
CODE16.LINES
      8114**DCL      8558<<ASSIGN   8567<<ASSIGN
CODE16.NSFORM
      8114**DCL      8519>>ASSIGN   8521<<ASSIGN   8866<<ASSIGN
CODE16.VFCIM
      8117**DCL      8557<<ASSIGN   8566<<ASSIGN
CODE16.WIDTH
      8117**DCL      8560<<ASSIGN   8568<<ASSIGN
CODE16.WSN
      8116**DCL      8553<<ASSIGN
COMPACCT
      7207**DCL      8426<<ASSIGN   8427<<ASSIGN   8428<<ASSIGN   8477--DOWHILE  8477>>DOWHILE  8484--IF
      8484>>IF       8488--IF
COMPARE_X
      7205**DCL      8472<<ASSIGN   8477>>DOWHILE  8477>>DOWHILE  8483>>ASSIGN   8484>>IF       8484>>IF
      8494<<ASSIGN   8499<<ASSIGN   8499>>ASSIGN   8779<<ASSIGN   8784>>DOWHILE  8784>>DOWHILE  8790>>ASSIGN
      8791>>IF       8791>>IF       8801<<ASSIGN   8806<<ASSIGN   8806>>ASSIGN
COMPARE_XP
      7206**DCL      8473<<ASSIGN   8483<<ASSIGN   8488>>IF       8494>>ASSIGN   8780<<ASSIGN   8790<<ASSIGN
      8795>>IF       8801>>ASSIGN
CONSTREAD
      7236**DCL      8945>>ASSIGN
CONSTREAD.STATION_
      7239**DCL      7240--REDEF
CONSTREAD.V
      7240**DCL      7236--DCLINIT
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:101  
CONSTREAD.V.DVBYTE.REREAD#
      7251**DCL      7251--REDEF
CONSTREAD.V.INDX#
      7249**DCL      7249--REDEF
DEST$
        52**DCL        50--PROC     8105--IMP-PTR  8387>>IF       8388<<ASSIGN   8389>>ASSIGN   8390>>ASSIGN
      8391>>ASSIGN   8392>>IF       8393>>ASSIGN   8395>>ASSIGN   8397>>ASSIGN   8398>>ASSIGN   8399>>ASSIGN
      8403>>ASSIGN   8404>>ASSIGN   8405>>ASSIGN   8406>>ASSIGN   8408--ENTRY    8421>>CALL     8422>>CALL
      8509>>ASSIGN   8512>>ASSIGN   8513>>ASSIGN   8516>>ASSIGN   8517>>ASSIGN   8523>>ASSIGN   8592--ENTRY
      8622--ENTRY
ERR IN PROCEDURE READWSN
      8871**LABEL    8828--GOTO     8849--GOTO     8855--GOTO
ERR$CANTFORM
      8656**LABEL    8421--CALLALT  8422--CALLALT  8598--GOTO     8601--GOTO
ERR$ILLDEV IN PROCEDURE READWSN
      8846**LABEL    8857--GOTO
ERR$ILLFORM
      8653**LABEL    8415--GOTO     8595--CALLALT  8628--CALLALT
ERR$UCIO
      8643**LABEL    8608--CALLALT  8617--CALLALT
ERRSAVE
      7201**DCL      8431<<ASSIGN   8653<<ASSIGN   8656<<ASSIGN   8659<<ASSIGN   8667>>ASSIGN   8728<<ASSIGN
      8732>>ASSIGN   8828<<ASSIGN   8846<<ASSIGN   8848<<ASSIGN   8855<<ASSIGN   8875>>ASSIGN
ERR_CANTFORM
      7357**DCL      8659>>ASSIGN
ERR_CANTWSN
      7322**DCL      8728>>ASSIGN
ERR_ILLATTR
      7343**DCL      8848>>ASSIGN
ERR_ILLDEV
      7329**DCL      8846>>ASSIGN
ERR_ILLWSN
      7315**DCL      8855>>ASSIGN
ERR_INVFORM
      7350**DCL      8656>>ASSIGN
ERR_NOTAUTHFORM
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:102  
      7364**DCL      8431>>ASSIGN
ERR_NOTOUT
      7336**DCL      8828>>ASSIGN
F$DCB.ACCT
      8065**DCL      8818<<ASSIGN   8920<<ASSIGN
F$DCB.ACTPOS
      8080**DCL      8080--REDEF
F$DCB.ARS
      8055**DCL      8055--REDEF
F$DCB.ASN
      8070**DCL      8917<<ASSIGN
F$DCB.ATTR
      8073**DCL      8074--REDEF    8403>>ASSIGN   8525<<ASSIGN   8832>>IF       8861<<ASSIGN
F$DCB.BORROW
      8088**DCL      8088--REDEF    8088--REDEF    8088--REDEF
F$DCB.DCBNAME.L
      8102**DCL      8102--IMP-SIZ
F$DCB.DDEV
      8061**DCL      8404>>ASSIGN   8531<<ASSIGN   8552>>ASSIGN   8638<<ASSIGN   8643<<ASSIGN   8647<<ASSIGN
      8862<<ASSIGN
F$DCB.DVFC
      8076**DCL      8548>>IF       8549<<ASSIGN   8551>>ASSIGN
F$DCB.EOMCHAR
      8059**DCL      8059--REDEF
F$DCB.FCD
      8068**DCL      8879>>IF       8914>>IF       8929>>IF       8943>>IF
F$DCB.FLDID
      8083**DCL      8083--REDEF
F$DCB.FORM$
      8077**DCL      8077--REDEF    8391>>ASSIGN   8411>>ASSIGN   8519>>ASSIGN   8520>>ASSIGN   8521>>ASSIGN
      8522>>ASSIGN   8523>>ASSIGN   8524>>ASSIGN   8550>>ASSIGN   8551>>ASSIGN   8552>>ASSIGN   8553>>ASSIGN
      8554>>ASSIGN   8557>>ASSIGN   8558>>ASSIGN   8559>>ASSIGN   8560>>ASSIGN   8561>>ASSIGN   8566>>ASSIGN
      8567>>ASSIGN   8568>>ASSIGN   8569>>ASSIGN   8570>>ASSIGN   8577>>ASSIGN   8578>>ASSIGN   8582>>ASSIGN
      8583>>ASSIGN   8586>>ASSIGN   8624>>IF       8625>>ASSIGN   8626>>ASSIGN   8627>>ASSIGN   8629>>ASSIGN
      8630>>ASSIGN   8632>>ASSIGN   8634>>ASSIGN   8637>>ASSIGN   8642>>ASSIGN   8646>>ASSIGN   8863>>IF
      8864>>ASSIGN   8866>>ASSIGN   8866>>ASSIGN   8935>>IF       8936<>CALL     8937>>ASSIGN
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:103  
F$DCB.FSECT
      8093**DCL      8093--REDEF
F$DCB.FSN
      8070**DCL      8070--REDEF    8070--REDEF    8071--REDEF
F$DCB.FUN
      8069**DCL      8918<<ASSIGN
F$DCB.HEADER$
      8076**DCL      8076--REDEF
F$DCB.IXTNSIZE
      8074**DCL      8074--REDEF
F$DCB.LASTSTA$
      8064**DCL      8064--REDEF
F$DCB.LINES
      8076**DCL      8529<<ASSIGN   8534>>IF       8534>>IF       8537<<ASSIGN   8558>>ASSIGN   8559>>ASSIGN
      8614<<ASSIGN
F$DCB.LVL
      8089**DCL      8089--REDEF
F$DCB.NAME
      8064**DCL      8921<<ASSIGN
F$DCB.NAME.C
      8064**DCL      8064--REDEF
F$DCB.NOEOF
      8085**DCL      8085--REDEF
F$DCB.NRECS
      8075**DCL      8075--REDEF
F$DCB.NRECX
      8094**DCL      8094--REDEF
F$DCB.OHDR
      8086**DCL      8086--REDEF
F$DCB.ORG
      8069**DCL      8069--REDEF
F$DCB.PASS
      8065**DCL      8819<<ASSIGN
F$DCB.PRECNO
      8092**DCL      8092--REDEF
F$DCB.PSN
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:104  
      8065**DCL      8594>>ASSIGN
F$DCB.RCSZ
      8097**DCL      8097--REDEF
F$DCB.RES
      8065**DCL      8065--REDEF    8405>>ASSIGN   8554>>ASSIGN   8709>>IF       8825>>IF       8856>>IF
F$DCB.SETX
      8077**DCL      8077--REDEF
F$DCB.SHARE
      8068**DCL      8919<<ASSIGN
F$DCB.TAB$
      8076**DCL      8077--REDEF
F$DCB.TDA
      8091**DCL      8091--REDEF
F$DCB.TYC
      8055**DCL      8605<<ASSIGN
F$DCB.UB$
      8093**DCL      8606<<ASSIGN   8615<<ASSIGN
F$DCB.UBYTES
      8093**DCL      8607<<ASSIGN   8616<<ASSIGN
F$DCB.WAIT
      8087**DCL      8604<<ASSIGN
F$DCB.WIDTH
      8062**DCL      8530<<ASSIGN   8539>>IF       8539>>IF       8542<<ASSIGN   8545<<ASSIGN   8545>>ASSIGN
      8560>>ASSIGN   8610<<ASSIGN   8613<<ASSIGN   8613>>ASSIGN
F$DCB.WSN
      8066**DCL      8066--REDEF    8406>>ASSIGN   8553>>ASSIGN   8707>>IF       8707>>IF       8708<<ASSIGN
      8709>>IF       8721>>CALLBLT  8734>>IF       8735<<ASSIGN   8854>>IF       8877>>IF       8878<<ASSIGN
FMM$DFLOPNP
      7211**DCL-ENT  8923--CALL
FMM$SCRUB
      7213**DCL-ENT  8916--CALL
FMP$CLSJ
      7210**DCL-ENT  8915--CALL     8930--CALL     8944--CALL
FNAME IN PROCEDURE OPENSTAR
      8910**DCL      8884--PROC     8921>>ASSIGN
FNAME.L# IN PROCEDURE OPENSTAR
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:105  
      8910**DCL      8910--IMP-SIZ  8921>>ASSIGN
FORMCONTUR
      8525**LABEL    8650--GOTO
FORMNAME
      7310**DCL      8412<>CALL     8672<>CALL
FOT$DCHK
      7216**DCL-ENT  8422--CALL
FOT$TCHK
      7215**DCL-ENT  8421--CALL
FS$ACCT.LIST
      8315**DCL      8454>>ASSIGN   8470--ASSIGN   8477--DOWHILE  8477>>DOWHILE  8479--IF       8479>>IF
      8484--IF       8484>>IF       8488--IF       8501--IF
FS$ACCT.TACCTS
      8314**DCL      8425>>IF       8430>>IF
FS$DEST
      8105**DCL      8388--ASSIGN   8389<<ASSIGN   8390--ASSIGN   8951--ASSIGN
FS$DEST.ATTR
      8110**DCL      8403<<ASSIGN
FS$DEST.COPIES
      8106**DCL      8391<<ASSIGN   8392>>IF       8393<<ASSIGN   8523>>ASSIGN
FS$DEST.DDEV
      8109**DCL      8404<<ASSIGN
FS$DEST.DT.DEV
      8110**DCL      8405<<ASSIGN   8422<>CALL
FS$DEST.DT.WSN
      8110**DCL      8406<<ASSIGN   8421<>CALL
FS$DEST.FLINES
      8105**DCL      8513<<ASSIGN   8517<<ASSIGN
FS$DEST.FORM
      8105**DCL      8509<<ASSIGN
FS$DEST.FWIDTH
      8105**DCL      8512<<ASSIGN   8516<<ASSIGN
FS$DEST.JOBNAME
      8110**DCL      8399<<ASSIGN
FS$DEST.MODE
      8106**DCL      8398<<ASSIGN
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:106  
FS$DEST.PRIO
      8107**DCL      8395<<ASSIGN   8397<<ASSIGN
FS$DEST.SIZ
      8105**DCL      8390<<ASSIGN
FS$FORMREC
      8249**DCL      8416<<ASSIGN   8417--ASSIGN   8418--ASSIGN   8418--ASSIGN   8421<>CALL     8422<>CALL
      8424--ASSIGN   8581--ASSIGN
FS$FORMREC.ACCTDISP
      8251**DCL      8423>>IF       8424>>ASSIGN
FS$FORMREC.ATTR
      8272**DCL      8524>>ASSIGN   8525>>ASSIGN
FS$FORMREC.BANRDISP
      8254**DCL      8417<<ASSIGN   8575>>IF       8581>>ASSIGN
FS$FORMREC.CHAINS
      8297**DCL      8307--REDEF
FS$FORMREC.FNAME
      8250**DCL      8509>>ASSIGN
FS$FORMREC.GRAPHIC
      8258**DCL      8510>>IF       8527>>IF       8555>>IF       8596>>IF       8635>>IF
FS$FORMREC.LGLTYPS.LPOK
      8266**DCL      8641>>IF
FS$FORMREC.LGLTYPS.TSOK
      8267**DCL      8600>>IF
FS$FORMREC.SOFTFORM.VFUIM
      8289**DCL      8615--ASSIGN   8616--ASSIGN
FS$FORMREC.SOFTFORM.VFUIM.V
      8293**DCL      8557>>ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN
      8277**DCL      8606--ASSIGN   8607--ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.EXTWID
      8286**DCL      8543>>IF       8611>>IF
FS$FORMREC.SOFTFORM.VLPPLATEN.FIRSTLINE
      8284**DCL      8561>>ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.LENGTH
      8282**DCL      8517>>ASSIGN   8534>>IF       8537>>ASSIGN   8614>>ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.LIMBO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:107  
      8283**DCL      8561>>ASSIGN
FS$FORMREC.SOFTFORM.VLPPLATEN.WIDTH
      8281**DCL      8516>>ASSIGN   8539>>IF       8542>>ASSIGN   8610>>ASSIGN
FSA$GSP
      7212**DCL-ENT  8936--CALL
FSW_FORMREC
      7427**DCL      8416>>ASSIGN
FSW_FORMREC.CHAINS
      7475**DCL      7485--REDEF
FSW_FORMREC_BAN
      7523**DCL      8051--DCLINIT  8418>>ASSIGN
FSW_FORMREC_BAN.CHARGE
      7524**DCL      7525--REDEF
FSW_FORMREC_BAN.ENTRIES.DISP
      8040**DCL      8041--REDEF
FSW_WTBLK
      7385**DCL      8858--ASSIGN
FSW_WTBLK.FNAME
      7388**DCL      8625>>ASSIGN
GFORM.SET_DEV_LIM
      8219**DCL      8236--REDEF
GOTAGOOD IN PROCEDURE READWSN
      8861**LABEL    8836--GOTO
I
      7156**DCL      8627<<ASSIGN   8631>>IF       8632>>ASSIGN   8823<<ASSIGN   8824>>DOWHILE  8825>>IF
      8826>>ASSIGN   8838<<ASSIGN   8838>>ASSIGN
J
      7157**DCL      8429<<ASSIGN   8430>>IF       8454>>ASSIGN   8470>>ASSIGN   8477>>DOWHILE  8477>>DOWHILE
      8479>>IF       8479>>IF       8484>>IF       8484>>IF       8488>>IF       8489<<ASSIGN   8489>>ASSIGN
      8501>>IF       8726<<ASSIGN   8727>>IF       8761>>ASSIGN   8777>>ASSIGN   8784>>DOWHILE  8784>>DOWHILE
      8786>>IF       8786>>IF       8791>>IF       8791>>IF       8795>>IF       8796<<ASSIGN   8796>>ASSIGN
      8808>>IF       8830<<ASSIGN   8831>>DOWHILE  8832>>IF       8833>>ASSIGN   8834<<ASSIGN   8834>>ASSIGN
JDCB$
      7152**DCL      8055--IMP-PTR  8391>>ASSIGN   8403>>ASSIGN   8404>>ASSIGN   8405>>ASSIGN   8406>>ASSIGN
      8411>>ASSIGN   8519>>ASSIGN   8520>>ASSIGN   8521>>ASSIGN   8522>>ASSIGN   8523>>ASSIGN   8524>>ASSIGN
      8525>>ASSIGN   8529>>ASSIGN   8530>>ASSIGN   8531>>ASSIGN   8534>>IF       8534>>IF       8537>>ASSIGN
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:108  
      8539>>IF       8539>>IF       8542>>ASSIGN   8545>>ASSIGN   8545>>ASSIGN   8548>>IF       8549>>ASSIGN
      8550>>ASSIGN   8551>>ASSIGN   8551>>ASSIGN   8552>>ASSIGN   8552>>ASSIGN   8553>>ASSIGN   8553>>ASSIGN
      8554>>ASSIGN   8554>>ASSIGN   8557>>ASSIGN   8558>>ASSIGN   8558>>ASSIGN   8559>>ASSIGN   8559>>ASSIGN
      8560>>ASSIGN   8560>>ASSIGN   8561>>ASSIGN   8566>>ASSIGN   8567>>ASSIGN   8568>>ASSIGN   8569>>ASSIGN
      8570>>ASSIGN   8577>>ASSIGN   8578>>ASSIGN   8582>>ASSIGN   8583>>ASSIGN   8586>>ASSIGN   8590>>ASSIGN
      8594>>ASSIGN   8603>>ASSIGN   8604>>ASSIGN   8605>>ASSIGN   8606>>ASSIGN   8607>>ASSIGN   8610>>ASSIGN
      8613>>ASSIGN   8613>>ASSIGN   8614>>ASSIGN   8615>>ASSIGN   8616>>ASSIGN   8624>>IF       8625>>ASSIGN
      8626>>ASSIGN   8627>>ASSIGN   8629>>ASSIGN   8630>>ASSIGN   8632>>ASSIGN   8634>>ASSIGN   8637>>ASSIGN
      8638>>ASSIGN   8642>>ASSIGN   8643>>ASSIGN   8646>>ASSIGN   8647>>ASSIGN   8668>>ASSIGN   8707>>IF
      8707>>IF       8708>>ASSIGN   8709>>IF       8709>>IF       8721>>CALLBLT  8734>>IF       8735>>ASSIGN
      8818>>ASSIGN   8819>>ASSIGN   8825>>IF       8832>>IF       8854>>IF       8856>>IF       8861>>ASSIGN
      8862>>ASSIGN   8863>>IF       8864>>ASSIGN   8866>>ASSIGN   8866>>ASSIGN   8877>>IF       8878>>ASSIGN
      8934<<ASSIGN   8935>>IF       8936>>CALL     8937>>ASSIGN   8940<<ASSIGN
JIT$
        54**DCL        50--PROC     8395>>ASSIGN   8426--IF       8427>>IF       8428>>ASSIGN   8661--IF
      8709>>IF       8717>>ASSIGN   8729>>IF       8731>>IF       8732>>ASSIGN   8733>>ASSIGN   8734>>IF
      8735>>ASSIGN   8784>>DOWHILE  8784>>DOWHILE  8791>>IF       8791>>IF       8795>>IF       8873>>IF
      8874>>IF       8875>>ASSIGN   8876>>ASSIGN   8877>>IF       8878>>ASSIGN
KEY
      7158**DCL      8948--ASSIGN
KEY.C
      7160**DCL      8411<<ASSIGN   8415>>IF       8522>>ASSIGN   8594<<ASSIGN   8626<<ASSIGN   8630>>ASSIGN
      8721<<CALLBLT
KEY.L
      7159**DCL      8674<<ASSIGN   8720<<ASSIGN
KIA$UCIO
      7217**DCL-ENT  8608--CALL     8617--CALL
KL_ACBLK.ACCTS
      8175**DCL      8725>>IF       8727>>IF
KL_ACBLK.LIST
      8176**DCL      8761>>ASSIGN   8777--ASSIGN   8784--DOWHILE  8784>>DOWHILE  8786--IF       8786>>IF
      8791--IF       8791>>IF       8795--IF       8808--IF
KL_INDIRECT_WSN
      8132**DCL      8950<<ASSIGN
KL_INDIRECT_WSN.INDIRECT#
      8133**DCL      8401>>IF       8817>>IF
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:109  
KL_INDIRECT_WSN.INDIRECT_WSN
      8137**DCL      8818>>ASSIGN
KL_INDIRECT_WSN.NODE
      8136**DCL      8819>>ASSIGN
KL_WSNHDR.ACCSDISP
      8124**DCL      8723>>IF       8724>>ASSIGN
KL_WSNHDR.NTYP
      8126**DCL      8824>>DOWHILE
KL_WSNHDR.TYPS.DISP
      8129**DCL      8826>>ASSIGN
KL_WSNHDR.TYPS.TYP
      8128**DCL      8825>>IF
KL_WTBLK.ATTRS
      8166**DCL      8832>>IF       8833>>ASSIGN
KL_WTBLK.DDEV
      8157**DCL      8862>>ASSIGN
KL_WTBLK.FNAME
      8155**DCL      8864>>ASSIGN   8866>>ASSIGN
KL_WTBLK.IO.OUTPUT
      8161**DCL      8827>>IF
KL_WTBLK.NATR
      8164**DCL      8831>>DOWHILE
LOCALONLY IN PROCEDURE READWSN
      8854**LABEL    8718--CALLALT  8722--CALLALT  8844--GOTO     8881--GOTO
M$MREAD
      7214**DCL-ENT  8675--CALL     8722--CALL
MEBBETRUERR
      8659**LABEL    8432--GOTO     8657--GOTO
MINGLCLLP
      7208**DCL      8714<<ASSIGN   8716<<ASSIGN   8725>>IF       8842>>IF
MOVEBANNER
      8049**DCL      8418<<ASSIGN
NEXTACCT
      8430**LABEL    8489--GOTO
NEXTACCT IN PROCEDURE READWSN
      8727**LABEL    8796--GOTO
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:110  
ONTOFORM
      8406**LABEL    8407--GOTO
OPENSTAR
      8884**PROC     8412--CALL     8662--CALL     8672--CALL     8718--CALL
PASS2WSN
      8403**LABEL    8664--GOTO
PL6ISDUMB
      8051**DCL      8050--IMP-SIZ  8418>>ASSIGN
PRESCANRETRY IN PROCEDURE READWSN
      8717**LABEL    8736--GOTO     8880--GOTO
READFORM
      8671**PROC     8595--CALL     8628--CALL
READFORMNOOPEN IN PROCEDURE READFORM
      8673**ENTRY    8413--CALL
READWSN
      8681**PROC     8400--CALL
READWSNERR IN PROCEDURE READWSN
      8871**ENTRY    8663--CALL
SC_FSFRMWSN IN PROCEDURE OPENSTAR
      8912**DCL-ENT  8925--CALL
SETUP
      8933**PROC     8386--CALL     8409--CALL     8623--CALL
SETUPUC IN PROCEDURE SETUP
      8939**ENTRY    8593--CALL
STAR$
      7153**DCL      8879>>IF       8914>>IF       8916<>CALL     8917>>ASSIGN   8918>>ASSIGN   8919>>ASSIGN
      8920>>ASSIGN   8921>>ASSIGN   8929>>IF       8941<<ASSIGN   8942>>ASSIGN   8943>>IF
STDFONLY
      8415**LABEL    8412--CALLALT  8413--CALLALT
S_CTUIS IN PROCEDURE OPENSTAR
      8913**DCL      8925>>IF
TEMPATTR
      7200**DCL      8519<<ASSIGN   8521>>ASSIGN   8829<<ASSIGN   8833<<ASSIGN   8833>>ASSIGN   8836>>IF
      8859<<ASSIGN   8861>>ASSIGN
TRUERR
      8661**LABEL    8400--CALLALT  8654--GOTO     8661--GOTO     8663--CALLALT
PL6.E3A0      #001=FSW$DESTFORM File=FSW$WSN.:E05TSI                             TUE 07/29/97 17:38 Page:111  
WILD_X
      7202**DCL      7203--REDEF    8455>>IF       8456<<ASSIGN   8469<<ASSIGN   8477>>DOWHILE  8477>>DOWHILE
      8479>>IF       8479>>IF       8480>>ASSIGN   8483>>IF       8484>>IF       8484>>IF       8490<<ASSIGN
      8501>>IF       8501<<ASSIGN   8501>>ASSIGN   8762>>IF       8763<<ASSIGN   8776<<ASSIGN   8784>>DOWHILE
      8784>>DOWHILE  8786>>IF       8786>>IF       8787>>ASSIGN   8790>>IF       8791>>IF       8791>>IF
      8797<<ASSIGN   8808>>IF       8808<<ASSIGN   8808>>ASSIGN
WILD_XC
      7203**DCL      8454<<ASSIGN   8761<<ASSIGN
WILD_XP
      7204**DCL      8457<<ASSIGN   8470<<ASSIGN   8480<<ASSIGN   8483>>IF       8488>>IF       8490>>ASSIGN
      8764<<ASSIGN   8777<<ASSIGN   8787<<ASSIGN   8790>>IF       8795>>IF       8797>>ASSIGN
WSNNAME
      7283**DCL      8662<>CALL     8718<>CALL
WT$
      7154**DCL      8152--IMP-PTR  8174--IMP-PTR  8313--IMP-PTR  8424<<ASSIGN   8425>>IF       8430>>IF
      8454>>ASSIGN   8477>>DOWHILE  8479>>IF       8484>>IF       8724<<ASSIGN   8725>>IF       8727>>IF
      8761>>ASSIGN   8784>>DOWHILE  8786>>IF       8791>>IF       8822<<ASSIGN   8826<<ASSIGN   8827>>IF
      8831>>DOWHILE  8832>>IF       8833>>ASSIGN   8845>>IF       8858<<ASSIGN   8862>>ASSIGN   8864>>ASSIGN
      8866>>ASSIGN
ZERO_VFC_IM
      8381**DCL      8566>>ASSIGN
