VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:1    
        1        1        /*M* ASL$LIST_ALL_VIRCIRS:  routine to handle LIST VIRCIR cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_VIRCIRS: PROC;
       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_VIRCIRS
       14       14             CALL:     CALL ASL$LIST_ALL_VIRCIRS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_VIRCIRS is a subroutine to handle
       18       18                           the LIST VIRCIR command for SUPER.
       19       19                           Link records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual link name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for links
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For links the
       35       35                           EQU is KLAT_LNKLINE# and its value is 6.
       36       36                           This routine will either read a single link
       37       37                           record or it will cycle through all of the :HLP
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:2    
       38       38                           records looking for links and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the vircirs
       42       42                           belonging to the link just found.  It will match
       43       43                           vircir numbers in the link record against the
       44       44                           vircir number asked for and if found
       45       45                           it will call the display routine
       46       46                           if the command was a DISPLAY command, or it will
       47       47                           call the formatter with the link name and the
       48       48                           vircir number.
       49       49
       50       50                  MEMORY REQUIREMENTS:
       51       51                           For all of the routines that deal with listing/
       52       52                           displaying links:
       53       53
       54       54                            ASL$LIST_ALL_VIRCIRS
       55       55                            ASL$DISP_ONE_VIRCIR
       56       56
       57       57                            The link record will be read into
       58       58                            data segment 1.  The name will be used by the
       59       59                            ASL$LIST_ALL_VIRCIRS, while the other info
       60       60                            will be used by the ASL$DISP_ONE_VIRCIR routine.
       61       61        */
       62       62        /********************************************************************/
       63       63        /*   Include files   include files   include files   include files  */
       64       64        /********************************************************************/
       65       65        %INCLUDE AS_PERR_C;
       66      667        %INCLUDE AS_SUPER_C;
       67     1102        %INCLUDE AS_SUBS_C;
       68     2516        %INCLUDE AS_MAC_C;
       69     2596        %INCLUDE AS_ENTRIES_M;
       70     3646        %INCLUDE OCI_SUBS_C;
       71     3744        %INCLUDE AS_SSUBS_C;
       72     3836        %INCLUDE B_ERRORS_C;
       73     4963        %INCLUDE KL_SUPER_C;
       74     7865        %INCLUDE XU_MACRO_C;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:3    
       75    10971        %INCLUDE XU_FORMAT_C;
       76    11133        %INCLUDE CP_6_SUBS;
       77    11673        %INCLUDE AS_SUPER_R;
       78    14689        /********************************************************************/
       79    14690        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       80    14691        /********************************************************************/
       81    14692        %ASB$PREC_HLP ;
       82    14695        %ASB$READ_HLP ;
       83    14698        %ASB$READ_HLP_SEQ ;
       84    14701        %ASH$ERROR ;
       85    14704        %ASA$ERROR ;
       86    14707        %ASL$FIND_VIRCIR ;
       87    14710        %ASL$DISP_ONE_VIRCIR ;
       88    14713        %ASB$WILD_MATCH ;
       89    14716    1   DCL X$FORMAT ENTRY(1) ;
       90    14717        /********************************************************************/
       91    14718        /*   Local based     local based     local based     local based    */
       92    14719        /********************************************************************/
       93    14720        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       94    14721                     NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       95    14766        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       96    14804        %KL_DREC      ( NAME     = LINK$DREC,
       97    14805                        STCLASS  = "BASED(DSEG1$)",
       98    14806                        LAST     = ";");
       99    14919        %KL_LNKVC     ( NAME     = KL$LNKVC,
      100    14920                        LVL      = 1,
      101    14921                        LAST     = ";",
      102    14922                        STCLASS  = "BASED( VC$ )" );
      103    15146        /********************************************************************/
      104    15147        /*   Auto data       auto data       auto data       auto data      */
      105    15148        /********************************************************************/
      106    15149    1   DCL ALL_LINKS                BIT(1);
      107    15150    1   DCL 1 BEGIN_KEY ,
      108    15151    1          2 COUNT               UBIN BYTE,
      109    15152    1          2 TEXT                CHAR(8);
      110    15153    1   DCL CURRENT_LINK             CHAR(8);
      111    15154    1   DCL DISP                     BIT(1);
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:4    
      112    15155    1   DCL DISP_LINKS               SBIN;
      113    15156    1   DCL DISP_VIRCIRS             SBIN;
      114    15157    1   DCL 1 END_KEY ,
      115    15158    1          2 COUNT               UBIN BYTE,
      116    15159    1          2 TEXT                CHAR(8);
      117    15160    1   DCL I                        UBIN;
      118    15161    1   DCL J                        UBIN;
      119    15162    1   DCL JCL                      BIT(1);
      120    15163    1   DCL 1 LINK_NAME,
      121    15164    1          2 COUNT               UBIN BYTE UNAL,
      122    15165    1          2 TEXT                CHAR(8) UNAL;
      123    15166    1   DCL NEW_LINK                 BIT(1);
      124    15167    1   DCL 1 VC_NAME,
      125    15168    1          2 COUNT               UBIN BYTE UNAL,
      126    15169    1          2 TEXT                CHAR(4) UNAL;
      127    15170    1   DCL VC$                      PTR;
      128    15171    1   DCL WILD_CARD                BIT(1);
      129    15172
      130    15173        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:5    
      131    15174        /********************************************************************/
      132    15175        /*   Constant data   constant data   constant data   constant data  */
      133    15176        /********************************************************************/
      134    15177    1   DCL LINK_STR                 CHAR(0) CONSTANT INIT ('link');
      135    15178    1   DCL LINKS_STR                CHAR(0) CONSTANT INIT ('links');
      136    15179    1   DCL VIRCIR_STR               CHAR(0) CONSTANT INIT ('vircir');
      137    15180    1   DCL VIRCIRS_STR              CHAR(0) CONSTANT INIT ('vircirs');
      138    15181    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      139    15182    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      140    15183    1   DCL FOUND_STR                CHAR(0) CONSTANT INIT ('found');
      141    15184        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:6    
      142    15185        /********************************************************************/
      143    15186        /*   Procedure       procedure       procedure       procedure      */
      144    15187        /********************************************************************/
      145    15188    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      146    15189    1   JCL = %NO#;
      147    15190    1   WILD_CARD = %NO#;
      148    15191    1   LINK_NAME.TEXT = '?';
      149    15192    1   LINK_NAME.COUNT = 1;
      150    15193    1   VC_NAME.TEXT = '?';
      151    15194    1   VC_NAME.COUNT = 1;
      152    15195    1   DISP_VIRCIRS = 0;
      153    15196    1   DISP_LINKS = 0;
      154    15197
      155    15198    2   DO SELECT (CODE);
      156    15199
      157    15200    2      SELECT (%LIST_ALL_VAL);
      158    15201
      159    15202    2      DISP = %NO#;
      160    15203    2      JCL = %NO#;
      161    15204
      162    15205    2      SELECT (%DISPLAY_ALL_VAL);
      163    15206
      164    15207    2      DISP = %YES#;
      165    15208    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
      166    15209    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      167    15210    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      168    15211    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      169    15212
      170    15213    2      SELECT ( %LIST_VIRCIR_VAL,
      171    15214    2           %DISPLAY_VIRCIR_VAL);
      172    15215
      173    15216    2      DISP = (CODE = %DISPLAY_VIRCIR_VAL);
      174    15217    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      175    15218    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINK_NAME_WILD_VAL THEN DO;
      176    15219    4            LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      177    15220    4            LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      178    15221    4            END;  /*  Code = LINK_NAME_WILD  */
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:7    
      179    15222    3         ELSE
      180    15223    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %VIRCIR_NAME_WILD_VAL THEN DO;
      181    15224    4               VC_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      182    15225    4               VC_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      183    15226    4               END; /*  Code = VIRCIR_NAME_WILD  */
      184    15227    3            ELSE
      185    15228    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;
      186    15229
      187    15230    4                  JCL = %YES#;
      188    15231
      189    15232    4                  END; /*  Code = JCL_VAL  */
      190    15233
      191    15234    3         END;  /*  Do i  */
      192    15235
      193    15236    2      END;  /*  Do case (code)  */
      194    15237
      195    15238    1   FDS.NVECS# = 0;
      196    15239    2   IF JCL THEN DO;
      197    15240    2      CALL CONCAT (FMT_BUF, '%1/"', VIRCIRS_STR, '%1/');
      198    15241    2      FDS.FMT_.BOUND = LENGTHC (VIRCIRS_STR) + 6;
      199    15242    2      END;  /*  Jcl  */
      200    15243    2   ELSE DO;
      201    15244    2      CALL CONCAT (FMT_BUF, '%1/', VIRCIRS_STR, '%1/');
      202    15245    2      FDS.FMT_.BOUND = LENGTHC (VIRCIRS_STR) + 5;
      203    15246    2      END;   /*  Not jcl  */
      204    15247    1   FDS.TABDFLT# = 10;
      205    15248    1   CALL X$FORMAT (FDS);
      206    15249
      207    15250    1   IF LINK_NAME.TEXT = '?' THEN
      208    15251    1      ALL_LINKS = %YES#;
      209    15252    2   ELSE DO;
      210    15253    2      ALL_LINKS = %NO#;
      211    15254    2      BEGIN_KEY.TEXT = ' ';
      212    15255    2      END_KEY.TEXT = ' ';
      213    15256    3      CALL INDEX (I,'?',LINK_NAME.TEXT) WHENRETURN DO;
      214    15257    3         BEGIN_KEY.TEXT = SUBSTR(LINK_NAME.TEXT,0,I);
      215    15258    3         BEGIN_KEY.COUNT = 8;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:8    
      216    15259    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINK_NAME.TEXT,0,I),'~');
      217    15260    3         END_KEY.COUNT = I + 1;
      218    15261    3         WILD_CARD = %YES#;
      219    15262    3         END;  /*  Whenreturn from index  */
      220    15263    3      WHENALTRETURN DO;
      221    15264    3         WILD_CARD = %NO#;
      222    15265    3         END;  /* Whenaltreturn  */
      223    15266    2      END;  /*  Else  */
      224    15267
      225    15268    1   FDS.NVECS# = 0;
      226    15269
      227    15270    2   IF ALL_LINKS THEN DO;
      228    15271    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */
      229    15272    2      END;  /*  ALL_LINKS  */
      230    15273    2   ELSE IF WILD_CARD THEN DO;
      231    15274    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      232    15275    2         USERS_KEY.COUNT = 9 ;
      233    15276    2         END; /*  WILD_CARD  */
      234    15277    2      ELSE DO;  /*  Single link and vircir  */
      235    15278    2         CALL CONCAT (USERS_KEY.TXTC,LINK_NAME.TEXT,'*');
      236    15279    2         USERS_KEY.COUNT = 9 ;
      237    15280    2         I = DSEG1SIZE;
      238    15281    2         CALL ASB$READ_HLP (DSEG1$,I,1)
      239    15282    3         WHENRETURN DO;
      240    15283    4            IF LINK$DREC.ATYP ~= %KLAT_LNKLINE# THEN DO;
      241    15284    4               AS_FIELD1 = LINK_NAME;
      242    15285                    %SCREAM( ERR#=E$NOTLINK , LEVEL=ERROR, MID='L' );
      243    15300    4               RETURN ;
      244    15301    4               END ; /* Then do */
      245    15302    3            I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;
      246    15303    3            VC$ = DSEG1$;
      247    15304    3            DISP_LINKS = 1;
      248    15305    3            NEW_LINK = %YES#;
      249    15306    4            DO FOREVER;
      250    15307    4               CALL ASL$FIND_VIRCIR (DSEG1$, I, VC_NAME, VC$) ALTRET (FINISH_UP);
      251    15308    5               IF DISP THEN DO;
      252    15309    6                  IF NOT JCL THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:9    
      253    15310    6                     CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '    ', LINK_NAME.TEXT);
      254    15311    6                     FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;
      255    15312    6                     FDS.NVECS# = 0;
      256    15313    6                     CALL X$FORMAT (FDS);
      257    15314    6                     END; /*  Not jcl  */
      258    15315    5                  CALL ASL$DISP_ONE_VIRCIR (VC$, NEW_LINK, JCL, LINK_NAME.TEXT);
      259    15316    5                  NEW_LINK = %NO#;
      260    15317    5                  END; /*  Disp  */
      261    15318    5               ELSE DO;
      262    15319    5                  FMT_BUF = '%1/   %A  %A  %A  %D';
      263    15320    5                  FDS.FMT_.BOUND = 20;
      264    15321    5                  FDS.NVECS# = 4;
      265    15322    5                  FMT_VEC (0) = VECTOR (LINK_STR);
      266    15323    5                  FMT_VEC (1) = VECTOR (LINK_NAME.TEXT);
      267    15324    5                  FMT_VEC (2) = VECTOR (VIRCIR_STR);
      268    15325    5                  FMT_VEC (3) = VECTOR (KL$LNKVC.VIRCIR#);
      269    15326    5                  CALL X$FORMAT (FDS);
      270    15327    5                  END; /*  ~ disp  */
      271    15328    4               DISP_VIRCIRS = DISP_VIRCIRS + 1;
      272    15329    4               END; /*  Forever  */
      273    15330    3            END;  /*  Whenreturn  */
      274    15331    3         WHENALTRETURN DO;
      275    15332    3            IF MERR_CODE.CODE = %E$NOKEY
      276    15333    4            THEN DO;
      277    15334    4               AS_FIELD1 = LINK_NAME;
      278    15335                    %SCREAM( ERR#=E$LINK_NO_EXIST2, MID='L', LEVEL=ERROR );
      279    15350    4               END;  /*  Error = nokey  */
      280    15351    4            ELSE DO;
      281    15352    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      282    15353    4               END;  /* Error ~= nokey */
      283    15354    3            END;  /*  Whenaltreturn  */
      284    15355    2         GOTO FINISH_UP;
      285    15356    2         END; /*  Else  */
      286    15357    1   CALL ASB$PREC_HLP ;
      287    15358    2   DO FOREVER;
      288    15359
      289    15360    3      DO UNTIL LINK$DREC.ATYP = %KLAT_LNKLINE# ;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:10   
      290    15361    3         I = DSEG1SIZE;
      291    15362    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)
      292    15363    4         WHENALTRETURN DO;
      293    15364    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      294    15365    4            GOTO FINISH_UP;
      295    15366    4            END;  /*  Whenaltreturn  */
      296    15367    3         END;  /*  Do until we find a link record  */
      297    15368    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;
      298    15369    2      IF I > 8 THEN I = 8;
      299    15370    2      CURRENT_LINK = SUBSTR(USERS_KEY.TXTC,0,I);
      300    15371    3      IF WILD_CARD THEN DO;
      301    15372    3         J = LINK_NAME.COUNT;
      302    15373    3         CALL ASB$WILD_MATCH (I, CURRENT_LINK, J, LINK_NAME.TEXT)
      303    15374    4         WHENALTRETURN DO;
      304    15375    4            IF CURRENT_LINK > END_KEY.TEXT THEN
      305    15376    4               GOTO FINISH_UP;
      306    15377    4            ELSE
      307    15378    4               GOTO END_FOREVER;
      308    15379    4            END;  /*  Whenaltreturn  */
      309    15380    3         END; /*  WILD_CARD  */
      310    15381    2      DISP_LINKS = DISP_LINKS + 1;
      311    15382    2      I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;
      312    15383    2      VC$ = DSEG1$;
      313    15384    2      NEW_LINK = %YES#;
      314    15385    3      DO FOREVER;
      315    15386    3         CALL ASL$FIND_VIRCIR (DSEG1$, I, VC_NAME, VC$) ALTRET (END_FOREVER);
      316    15387    4         IF DISP THEN DO;
      317    15388    5            IF NEW_LINK AND NOT JCL THEN DO;
      318    15389    5               CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '    ', SUBSTR(USERS_KEY.TXTC,
             15389                        0,8));
      319    15390    5               FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;
      320    15391    5               FDS.NVECS# = 0;
      321    15392    5               CALL X$FORMAT (FDS);
      322    15393    5               END;  /*  New link */
      323    15394    4            CALL ASL$DISP_ONE_VIRCIR (VC$, NEW_LINK, JCL, CURRENT_LINK);
      324    15395    4            NEW_LINK = %NO#;
      325    15396    4            END;  /*  Disp  */
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:11   
      326    15397    4         ELSE DO;
      327    15398    4            FMT_BUF = '%1/   %A  %A  %A  %D';
      328    15399    4            FDS.FMT_.BOUND = 20;
      329    15400    4            FDS.NVECS# = 4;
      330    15401    4            FMT_VEC (0) = VECTOR (LINK_STR);
      331    15402    4            FMT_VEC (1) = VECTOR (CURRENT_LINK);
      332    15403    4            FMT_VEC (2) = VECTOR (VIRCIR_STR);
      333    15404    4            FMT_VEC (3) = VECTOR (KL$LNKVC.VIRCIR#);
      334    15405    4            CALL X$FORMAT (FDS);
      335    15406    4            END;  /*  ~ disp  */
      336    15407    3         DISP_VIRCIRS = DISP_VIRCIRS + 1;
      337    15408    3         END;  /*  Forever  */
      338    15409    2   END_FOREVER:
      339    15410    2      END;  /*  Do forever  */
      340    15411    1   FINISH_UP:
      341    15412    2   IF NOT DISP THEN DO;
      342    15413    2      FMT_BUF = '%\%/';
      343    15414    2      FDS.FMT_.BOUND = 3;
      344    15415    2      FDS.NVECS# = 0;
      345    15416    2      CALL X$FORMAT(FDS);
      346    15417    2      END; /*  If not disp  */
      347    15418    2   IF NOT JCL THEN DO;
      348    15419    2      FMT_VEC(0) = VECTOR (DISP_LINKS);
      349    15420    2      IF DISP_LINKS = 1 THEN
      350    15421    3      DO;
      351    15422    3         FMT_VEC(1) = VECTOR (LINK_STR);
      352    15423    3         END; /*  DISP_LINKS = 1  */
      353    15424    3      ELSE DO;
      354    15425    3         FMT_VEC(1) = VECTOR (LINKS_STR);
      355    15426    3         END; /*  DISP_LINKS ~= 1  */
      356    15427    2      FMT_VEC(2) = VECTOR (FOUND_STR);
      357    15428    2      FDS.NVECS# = 3;
      358    15429    2      FMT_BUF = '   %5D %A %A.';
      359    15430    2      FDS.FMT_.BOUND = 12;
      360    15431    2      CALL X$FORMAT(FDS);
      361    15432    2      FMT_VEC(0) = VECTOR (DISP_VIRCIRS);
      362    15433    2      IF DISP_VIRCIRS = 1 THEN
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:12   
      363    15434    3      DO;
      364    15435    3         FMT_VEC(1) = VECTOR (VIRCIR_STR);
      365    15436    3         END; /*  DISP_VIRCIRS = 1  */
      366    15437    3      ELSE DO;
      367    15438    3         FMT_VEC(1) = VECTOR (VIRCIRS_STR);
      368    15439    3         END; /*  DISP_VIRCIRS ~= 1  */
      369    15440    2      IF DISP THEN
      370    15441    3      DO;
      371    15442    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      372    15443    3         END; /*  If disp  */
      373    15444    3      ELSE DO;
      374    15445    3         FMT_VEC(2) = VECTOR (LIST_STR);
      375    15446    3         END; /*  If ~ disp  */
      376    15447    2      FDS.NVECS# = 3;
      377    15448    2      FMT_BUF = '   %5D %A %A.';
      378    15449    2      FDS.FMT_.BOUND = 12;
      379    15450    2      CALL X$FORMAT(FDS);
      380    15451    2      END; /* Not jcl */
      381    15452    1   RETURN;
      382    15453    1   END ASL$LIST_ALL_VIRCIRS;
      383    15454        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:13   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_VIRCIRS.

   Procedure ASL$LIST_ALL_VIRCIRS requires 605 words for executable code.
   Procedure ASL$LIST_ALL_VIRCIRS requires 32 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:14   

 Object Unit name= ASL$LIST_ALL_VIRCIRS                       File name= ASL$LIST_VIRCIRS.:E05TOU
 UTS= JUL 29 '97 10:24:38.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     29     35  ASL$LIST_ALL_VIRCIRS
    2   Proc  even  none   605   1135  ASL$LIST_ALL_VIRCIRS
    3  RoData even  none    32     40  ASL$LIST_ALL_VIRCIRS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_VIRCIRS
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       4 ASL$FIND_VIRCIR
         yes           Std       4 ASL$DISP_ONE_VIRCIR
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$PREC_HLP
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       3 ASB$READ_HLP_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:16   


        1        1        /*M* ASL$LIST_ALL_VIRCIRS:  routine to handle LIST VIRCIR cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_VIRCIRS: PROC;

     10  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000040 000000                    ZERO    32,0

       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_VIRCIRS
       14       14             CALL:     CALL ASL$LIST_ALL_VIRCIRS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_VIRCIRS is a subroutine to handle
       18       18                           the LIST VIRCIR command for SUPER.
       19       19                           Link records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual link name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for links
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:17   
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For links the
       35       35                           EQU is KLAT_LNKLINE# and its value is 6.
       36       36                           This routine will either read a single link
       37       37                           record or it will cycle through all of the :HLP
       38       38                           records looking for links and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the vircirs
       42       42                           belonging to the link just found.  It will match
       43       43                           vircir numbers in the link record against the
       44       44                           vircir number asked for and if found
       45       45                           it will call the display routine
       46       46                           if the command was a DISPLAY command, or it will
       47       47                           call the formatter with the link name and the
       48       48                           vircir number.
       49       49
       50       50                  MEMORY REQUIREMENTS:
       51       51                           For all of the routines that deal with listing/
       52       52                           displaying links:
       53       53
       54       54                            ASL$LIST_ALL_VIRCIRS
       55       55                            ASL$DISP_ONE_VIRCIR
       56       56
       57       57                            The link record will be read into
       58       58                            data segment 1.  The name will be used by the
       59       59                            ASL$LIST_ALL_VIRCIRS, while the other info
       60       60                            will be used by the ASL$DISP_ONE_VIRCIR routine.
       61       61        */
       62       62        /********************************************************************/
       63       63        /*   Include files   include files   include files   include files  */
       64       64        /********************************************************************/
       65       65        %INCLUDE AS_PERR_C;
       66      667        %INCLUDE AS_SUPER_C;
       67     1102        %INCLUDE AS_SUBS_C;
       68     2516        %INCLUDE AS_MAC_C;
       69     2596        %INCLUDE AS_ENTRIES_M;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:18   
       70     3646        %INCLUDE OCI_SUBS_C;
       71     3744        %INCLUDE AS_SSUBS_C;
       72     3836        %INCLUDE B_ERRORS_C;
       73     4963        %INCLUDE KL_SUPER_C;
       74     7865        %INCLUDE XU_MACRO_C;
       75    10971        %INCLUDE XU_FORMAT_C;
       76    11133        %INCLUDE CP_6_SUBS;
       77    11673        %INCLUDE AS_SUPER_R;
       78    14689        /********************************************************************/
       79    14690        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       80    14691        /********************************************************************/
       81    14692        %ASB$PREC_HLP ;
       82    14695        %ASB$READ_HLP ;
       83    14698        %ASB$READ_HLP_SEQ ;
       84    14701        %ASH$ERROR ;
       85    14704        %ASA$ERROR ;
       86    14707        %ASL$FIND_VIRCIR ;
       87    14710        %ASL$DISP_ONE_VIRCIR ;
       88    14713        %ASB$WILD_MATCH ;
       89    14716    1   DCL X$FORMAT ENTRY(1) ;
       90    14717        /********************************************************************/
       91    14718        /*   Local based     local based     local based     local based    */
       92    14719        /********************************************************************/
       93    14720        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       94    14721                     NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       95    14766        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       96    14804        %KL_DREC      ( NAME     = LINK$DREC,
       97    14805                        STCLASS  = "BASED(DSEG1$)",
       98    14806                        LAST     = ";");
       99    14919        %KL_LNKVC     ( NAME     = KL$LNKVC,
      100    14920                        LVL      = 1,
      101    14921                        LAST     = ";",
      102    14922                        STCLASS  = "BASED( VC$ )" );
      103    15146        /********************************************************************/
      104    15147        /*   Auto data       auto data       auto data       auto data      */
      105    15148        /********************************************************************/
      106    15149    1   DCL ALL_LINKS                BIT(1);
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:19   
      107    15150    1   DCL 1 BEGIN_KEY ,
      108    15151    1          2 COUNT               UBIN BYTE,
      109    15152    1          2 TEXT                CHAR(8);
      110    15153    1   DCL CURRENT_LINK             CHAR(8);
      111    15154    1   DCL DISP                     BIT(1);
      112    15155    1   DCL DISP_LINKS               SBIN;
      113    15156    1   DCL DISP_VIRCIRS             SBIN;
      114    15157    1   DCL 1 END_KEY ,
      115    15158    1          2 COUNT               UBIN BYTE,
      116    15159    1          2 TEXT                CHAR(8);
      117    15160    1   DCL I                        UBIN;
      118    15161    1   DCL J                        UBIN;
      119    15162    1   DCL JCL                      BIT(1);
      120    15163    1   DCL 1 LINK_NAME,
      121    15164    1          2 COUNT               UBIN BYTE UNAL,
      122    15165    1          2 TEXT                CHAR(8) UNAL;
      123    15166    1   DCL NEW_LINK                 BIT(1);
      124    15167    1   DCL 1 VC_NAME,
      125    15168    1          2 COUNT               UBIN BYTE UNAL,
      126    15169    1          2 TEXT                CHAR(4) UNAL;
      127    15170    1   DCL VC$                      PTR;
      128    15171    1   DCL WILD_CARD                BIT(1);
      129    15172
      130    15173        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:20   
      131    15174        /********************************************************************/
      132    15175        /*   Constant data   constant data   constant data   constant data  */
      133    15176        /********************************************************************/
      134    15177    1   DCL LINK_STR                 CHAR(0) CONSTANT INIT ('link');
      135    15178    1   DCL LINKS_STR                CHAR(0) CONSTANT INIT ('links');
      136    15179    1   DCL VIRCIR_STR               CHAR(0) CONSTANT INIT ('vircir');
      137    15180    1   DCL VIRCIRS_STR              CHAR(0) CONSTANT INIT ('vircirs');
      138    15181    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      139    15182    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      140    15183    1   DCL FOUND_STR                CHAR(0) CONSTANT INIT ('found');
      141    15184        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:21   
      142    15185        /********************************************************************/
      143    15186        /*   Procedure       procedure       procedure       procedure      */
      144    15187        /********************************************************************/
      145    15188    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15188  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      146    15189    1   JCL = %NO#;

  15189  2 000007   200021 450100                    STZ     JCL,,AUTO

      147    15190    1   WILD_CARD = %NO#;

  15190  2 000010   200031 450100                    STZ     WILD_CARD,,AUTO

      148    15191    1   LINK_NAME.TEXT = '?';

  15191  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      149    15192    1   LINK_NAME.COUNT = 1;

  15192  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO

      150    15193    1   VC_NAME.TEXT = '?';

  15193  2 000016   040100 100400                    MLR     fill='040'O
         2 000017   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000020   200026 200004                    ADSC9   VC_NAME,,AUTO            cn=1,n=4

      151    15194    1   VC_NAME.COUNT = 1;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:22   

  15194  2 000021   200026 552140                    STBQ    VC_NAME,'40'O,AUTO

      152    15195    1   DISP_VIRCIRS = 0;

  15195  2 000022   200013 450100                    STZ     DISP_VIRCIRS,,AUTO

      153    15196    1   DISP_LINKS = 0;

  15196  2 000023   200012 450100                    STZ     DISP_LINKS,,AUTO

      154    15197
      155    15198    2   DO SELECT (CODE);

  15198  2 000024   000000 236000 xsym               LDQ     CODE
         2 000025   000022 116007                    CMPQ    18,DL
         2 000026   000037 602000 2                  TNC     s:15198+11
         2 000027   000042 600000 2                  TZE     s:15202
         2 000030   000144 116007                    CMPQ    100,DL
         2 000031   000034 602000 2                  TNC     s:15198+8
         2 000032   000045 600000 2                  TZE     s:15207
         2 000033   000160 710000 2                  TRA     s:15238
         2 000034   000142 116007                    CMPQ    98,DL
         2 000035   000160 601000 2                  TNZ     s:15238
         2 000036   000077 710000 2                  TRA     s:15216
         2 000037   000020 116007                    CMPQ    16,DL
         2 000040   000160 601000 2                  TNZ     s:15238
         2 000041   000077 710000 2                  TRA     s:15216

      156    15199
      157    15200    2      SELECT (%LIST_ALL_VAL);

      158    15201
      159    15202    2      DISP = %NO#;

  15202  2 000042   200011 450100                    STZ     DISP,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:23   
      160    15203    2      JCL = %NO#;

  15203  2 000043   200021 450100                    STZ     JCL,,AUTO
         2 000044   000160 710000 2                  TRA     s:15238

      161    15204
      162    15205    2      SELECT (%DISPLAY_ALL_VAL);

      163    15206
      164    15207    2      DISP = %YES#;

  15207  2 000045   400000 236003                    LDQ     -131072,DU
         2 000046   200011 756100                    STQ     DISP,,AUTO

      165    15208    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  15208  2 000047   000003 471500                    LDP1    3,,PR0
         2 000050   100001 220100                    LDX0    1,,PR1
         2 000051   000002 100003                    CMPX0   2,DU
         2 000052   000064 601000 2                  TNZ     s:15210

      166    15209    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  15209  2 000053   100004 473500                    LDP3    4,,PR1
         2 000054   400000 221003                    LDX1    -131072,DU
         2 000055   300000 722100                    LXL2    0,,PR3
         2 000056   000001 102003                    CMPX2   1,DU
         2 000057   000061 600000 2                  TZE     s:15209+6
         2 000060   000000 221003                    LDX1    0,DU
         2 000061   000000 636011                    EAQ     0,X1
         2 000062   200021 756100                    STQ     JCL,,AUTO
         2 000063   000160 710000 2                  TRA     s:15238

      167    15210    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  15210  2 000064   000000 100003                    CMPX0   0,DU
         2 000065   000160 600000 2                  TZE     s:15238
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:24   

      168    15211    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  15211  2 000066   100003 473500                    LDP3    3,,PR1
         2 000067   400000 221003                    LDX1    -131072,DU
         2 000070   300000 722100                    LXL2    0,,PR3
         2 000071   000001 102003                    CMPX2   1,DU
         2 000072   000074 600000 2                  TZE     s:15211+6
         2 000073   000000 221003                    LDX1    0,DU
         2 000074   000000 636011                    EAQ     0,X1
         2 000075   200021 756100                    STQ     JCL,,AUTO
         2 000076   000160 710000 2                  TRA     s:15238

      169    15212
      170    15213    2      SELECT ( %LIST_VIRCIR_VAL,

      171    15214    2           %DISPLAY_VIRCIR_VAL);
      172    15215
      173    15216    2      DISP = (CODE = %DISPLAY_VIRCIR_VAL);

  15216  2 000077   400000 220003                    LDX0    -131072,DU
         2 000100   000142 116007                    CMPQ    98,DL
         2 000101   000103 600000 2                  TZE     s:15216+4
         2 000102   000000 220003                    LDX0    0,DU
         2 000103   000000 636010                    EAQ     0,X0
         2 000104   200011 756100                    STQ     DISP,,AUTO

      174    15217    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15217  2 000105   000001 235007                    LDA     1,DL
         2 000106   200017 755100                    STA     I,,AUTO
         2 000107   000153 710000 2                  TRA     s:15234+3

      175    15218    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINK_NAME_WILD_VAL THEN DO;

  15218  2 000110   000003 470400 xsym               LDP0    P_PCB+3
         2 000111   200017 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:25   
         2 000112   000003 471510                    LDP1    3,X0,PR0
         2 000113   100000 721100                    LXL1    0,,PR1
         2 000114   000355 101003                    CMPX1   237,DU
         2 000115   000130 601000 2                  TNZ     s:15223

      176    15219    4            LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15219  2 000116   100004 236100                    LDQ     4,,PR1
         2 000117   000033 772000                    QRL     27
         2 000120   000000 622006                    EAX2    0,QL
         2 000121   040100 100540                    MLR     fill='040'O
         2 000122   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000123   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      177    15220    4            LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15220  2 000124   000003 471510                    LDP1    3,X0,PR0
         2 000125   100004 236100                    LDQ     4,,PR1
         2 000126   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO

      178    15221    4            END;  /*  Code = LINK_NAME_WILD  */

  15221  2 000127   000150 710000 2                  TRA     s:15234

      179    15222    3         ELSE
      180    15223    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %VIRCIR_NAME_WILD_VAL THEN DO;

  15223  2 000130   000356 101003                    CMPX1   238,DU
         2 000131   000144 601000 2                  TNZ     s:15228

      181    15224    4               VC_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15224  2 000132   100004 236100                    LDQ     4,,PR1
         2 000133   000033 772000                    QRL     27
         2 000134   000000 622006                    EAX2    0,QL
         2 000135   040100 100540                    MLR     fill='040'O
         2 000136   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:26   
         2 000137   200026 200004                    ADSC9   VC_NAME,,AUTO            cn=1,n=4

      182    15225    4               VC_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15225  2 000140   000003 471510                    LDP1    3,X0,PR0
         2 000141   100004 236100                    LDQ     4,,PR1
         2 000142   200026 552140                    STBQ    VC_NAME,'40'O,AUTO

      183    15226    4               END; /*  Code = VIRCIR_NAME_WILD  */

  15226  2 000143   000150 710000 2                  TRA     s:15234

      184    15227    3            ELSE
      185    15228    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;

  15228  2 000144   000001 101003                    CMPX1   1,DU
         2 000145   000150 601000 2                  TNZ     s:15234

      186    15229
      187    15230    4                  JCL = %YES#;

  15230  2 000146   400000 236003                    LDQ     -131072,DU
         2 000147   200021 756100                    STQ     JCL,,AUTO

      188    15231
      189    15232    4                  END; /*  Code = JCL_VAL  */

      190    15233
      191    15234    3         END;  /*  Do i  */

  15234  2 000150   200017 235100                    LDA     I,,AUTO
         2 000151   000001 035007                    ADLA    1,DL
         2 000152   200017 755100                    STA     I,,AUTO
         2 000153   000001 236100                    LDQ     1,,PR0
         2 000154   000022 772000                    QRL     18
         2 000155   200017 116100                    CMPQ    I,,AUTO
         2 000156   000160 600000 2                  TZE     s:15238
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:27   
         2 000157   000110 603000 2                  TRC     s:15218

      192    15235
      193    15236    2      END;  /*  Do case (code)  */

      194    15237
      195    15238    1   FDS.NVECS# = 0;

  15238  2 000160   000011 450000 xsym               STZ     FDS+9

      196    15239    2   IF JCL THEN DO;

  15239  2 000161   200021 234100                    SZN     JCL,,AUTO
         2 000162   000200 605000 2                  TPL     s:15244

      197    15240    2      CALL CONCAT (FMT_BUF, '%1/"', VIRCIRS_STR, '%1/');

  15240  2 000163   000016 236000 1                  LDQ     FOUND_STR+2
         2 000164   000000 756000 xsym               STQ     FMT_BUF
         2 000165   040000 100400                    MLR     fill='040'O
         2 000166   000005 000007 1                  ADSC9   VIRCIRS_STR              cn=0,n=7
         2 000167   000001 000007 xsym               ADSC9   FMT_BUF+1                cn=0,n=7
         2 000170   040000 100400                    MLR     fill='040'O
         2 000171   000016 000003 1                  ADSC9   FOUND_STR+2              cn=0,n=3
         2 000172   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

      198    15241    2      FDS.FMT_.BOUND = LENGTHC (VIRCIRS_STR) + 6;

  15241  2 000173   000000 236000 xsym               LDQ     FDS
         2 000174   177777 376007                    ANQ     65535,DL
         2 000175   000001 276000 3                  ORQ     1
         2 000176   000000 756000 xsym               STQ     FDS

      199    15242    2      END;  /*  Jcl  */

  15242  2 000177   000216 710000 2                  TRA     s:15247

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:28   
      200    15243    2   ELSE DO;

      201    15244    2      CALL CONCAT (FMT_BUF, '%1/', VIRCIRS_STR, '%1/');

  15244  2 000200   000016 236000 1                  LDQ     FOUND_STR+2
         2 000201   000002 376000 3                  ANQ     2
         2 000202   000040 276007                    ORQ     32,DL
         2 000203   000000 756000 xsym               STQ     FMT_BUF
         2 000204   040000 100400                    MLR     fill='040'O
         2 000205   000005 000007 1                  ADSC9   VIRCIRS_STR              cn=0,n=7
         2 000206   000000 600007 xsym               ADSC9   FMT_BUF                  cn=3,n=7
         2 000207   040000 100400                    MLR     fill='040'O
         2 000210   000016 000003 1                  ADSC9   FOUND_STR+2              cn=0,n=3
         2 000211   000002 400365 xsym               ADSC9   FMT_BUF+2                cn=2,n=245

      202    15245    2      FDS.FMT_.BOUND = LENGTHC (VIRCIRS_STR) + 5;

  15245  2 000212   000000 236000 xsym               LDQ     FDS
         2 000213   177777 376007                    ANQ     65535,DL
         2 000214   000003 276003                    ORQ     3,DU
         2 000215   000000 756000 xsym               STQ     FDS

      203    15246    2      END;   /*  Not jcl  */

      204    15247    1   FDS.TABDFLT# = 10;

  15247  2 000216   000012 235007                    LDA     10,DL
         2 000217   000017 755000 xsym               STA     FDS+15

      205    15248    1   CALL X$FORMAT (FDS);

  15248  2 000220   000003 630400 3                  EPPR0   3
         2 000221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000222   000000 701000 xent               TSX1    X$FORMAT
         2 000223   000000 011000                    NOP     0

      206    15249
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:29   
      207    15250    1   IF LINK_NAME.TEXT = '?' THEN

  15250  2 000224   040000 106500                    CMPC    fill='040'O
         2 000225   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         2 000226   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000227   000233 601000 2                  TNZ     s:15253

      208    15251    1      ALL_LINKS = %YES#;

  15251  2 000230   400000 236003                    LDQ     -131072,DU
         2 000231   200003 756100                    STQ     ALL_LINKS,,AUTO
         2 000232   000301 710000 2                  TRA     s:15268

      209    15252    2   ELSE DO;

      210    15253    2      ALL_LINKS = %NO#;

  15253  2 000233   200003 450100                    STZ     ALL_LINKS,,AUTO

      211    15254    2      BEGIN_KEY.TEXT = ' ';

  15254  2 000234   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000235   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000236   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         2 000237   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      212    15255    2      END_KEY.TEXT = ' ';

  15255  2 000240   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000241   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000242   200015 755100                    STA     END_KEY+1,,AUTO
         2 000243   200016 756100                    STQ     END_KEY+2,,AUTO

      213    15256    3      CALL INDEX (I,'?',LINK_NAME.TEXT) WHENRETURN DO;

  15256  2 000244   000000 124500                    SCM     mask='000'O
         2 000245   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:30   
         2 000246   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000247   200017 000100                    ARG     I,,AUTO
         2 000250   000300 606400 2                  TTN     s:15264

      214    15257    3         BEGIN_KEY.TEXT = SUBSTR(LINK_NAME.TEXT,0,I);

  15257  2 000251   200017 720100                    LXL0    I,,AUTO
         2 000252   040100 100540                    MLR     fill='040'O
         2 000253   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         2 000254   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      215    15258    3         BEGIN_KEY.COUNT = 8;

  15258  2 000255   010000 236003                    LDQ     4096,DU
         2 000256   200004 756100                    STQ     BEGIN_KEY,,AUTO

      216    15259    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINK_NAME.TEXT,0,I),'~');

  15259  2 000257   040100 100540                    MLR     fill='040'O
         2 000260   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         2 000261   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000262   200017 236100                    LDQ     I,,AUTO
         2 000263   000010 116007                    CMPQ    8,DL
         2 000264   000272 603000 2                  TRC     s:15260
         2 000265   777767 621006                    EAX1    -9,QL
         2 000266   777777 661003                    ERX1    -1,DU
         2 000267   040146 100400                    MLR     fill='040'O
         2 000270   000004 000001 3                  ADSC9   4                        cn=0,n=1
         2 000271   200015 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      217    15260    3         END_KEY.COUNT = I + 1;

  15260  2 000272   000001 036007                    ADLQ    1,DL
         2 000273   000033 736000                    QLS     27
         2 000274   200014 756100                    STQ     END_KEY,,AUTO

      218    15261    3         WILD_CARD = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:31   

  15261  2 000275   400000 236003                    LDQ     -131072,DU
         2 000276   200031 756100                    STQ     WILD_CARD,,AUTO

      219    15262    3         END;  /*  Whenreturn from index  */

  15262  2 000277   000301 710000 2                  TRA     s:15268

      220    15263    3      WHENALTRETURN DO;

      221    15264    3         WILD_CARD = %NO#;

  15264  2 000300   200031 450100                    STZ     WILD_CARD,,AUTO

      222    15265    3         END;  /* Whenaltreturn  */

      223    15266    2      END;  /*  Else  */

      224    15267
      225    15268    1   FDS.NVECS# = 0;

  15268  2 000301   000011 450000 xsym               STZ     FDS+9

      226    15269
      227    15270    2   IF ALL_LINKS THEN DO;

  15270  2 000302   200003 234100                    SZN     ALL_LINKS,,AUTO
         2 000303   000310 605000 2                  TPL     s:15273

      228    15271    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */

  15271  2 000304   000000 100400                    MLR     fill='000'O
         2 000305   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         2 000306   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      229    15272    2      END;  /*  ALL_LINKS  */

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:32   
  15272  2 000307   000543 710000 2                  TRA     s:15357

      230    15273    2   ELSE IF WILD_CARD THEN DO;

  15273  2 000310   200031 234100                    SZN     WILD_CARD,,AUTO
         2 000311   000323 605000 2                  TPL     s:15278

      231    15274    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  15274  2 000312   040000 100500                    MLR     fill='040'O
         2 000313   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         2 000314   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000315   040000 100400                    MLR     fill='040'O
         2 000316   000005 000001 3                  ADSC9   5                        cn=0,n=1
         2 000317   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      232    15275    2         USERS_KEY.COUNT = 9 ;

  15275  2 000320   011000 236003                    LDQ     4608,DU
         2 000321   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      233    15276    2         END; /*  WILD_CARD  */

  15276  2 000322   000543 710000 2                  TRA     s:15357

      234    15277    2      ELSE DO;  /*  Single link and vircir  */

      235    15278    2         CALL CONCAT (USERS_KEY.TXTC,LINK_NAME.TEXT,'*');

  15278  2 000323   040000 100500                    MLR     fill='040'O
         2 000324   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         2 000325   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000326   040000 100400                    MLR     fill='040'O
         2 000327   000005 000001 3                  ADSC9   5                        cn=0,n=1
         2 000330   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      236    15279    2         USERS_KEY.COUNT = 9 ;
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:33   

  15279  2 000331   011000 236003                    LDQ     4608,DU
         2 000332   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      237    15280    2         I = DSEG1SIZE;

  15280  2 000333   000000 235000 xsym               LDA     DSEG1SIZE
         2 000334   200017 755100                    STA     I,,AUTO

      238    15281    2         CALL ASB$READ_HLP (DSEG1$,I,1)

  15281  2 000335   000006 236000 3                  LDQ     6
         2 000336   200034 756100                    STQ     WILD_CARD+3,,AUTO
         2 000337   200017 630500                    EPPR0   I,,AUTO
         2 000340   200033 450500                    STP0    WILD_CARD+2,,AUTO
         2 000341   000007 236000 3                  LDQ     7
         2 000342   200032 756100                    STQ     WILD_CARD+1,,AUTO
         2 000343   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000344   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000345   000000 701000 xent               TSX1    ASB$READ_HLP
         2 000346   000522 702000 2                  TSX2    s:15332

      239    15282    3         WHENRETURN DO;

      240    15283    4            IF LINK$DREC.ATYP ~= %KLAT_LNKLINE# THEN DO;

  15283  2 000347   000000 470400 xsym               LDP0    DSEG1$
         2 000350   000000 236100                    LDQ     0,,PR0
         2 000351   777000 376003                    ANQ     -512,DU
         2 000352   006000 116003                    CMPQ    3072,DU
         2 000353   000364 600000 2                  TZE     s:15302

      241    15284    4               AS_FIELD1 = LINK_NAME;

  15284  2 000354   000000 100500                    MLR     fill='000'O
         2 000355   200022 000011                    ADSC9   LINK_NAME,,AUTO          cn=0,n=9
         2 000356   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:34   

      242    15285                    %SCREAM( ERR#=E$NOTLINK , LEVEL=ERROR, MID='L' );

  15297  2 000357   000010 630400 3                  EPPR0   8
         2 000360   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000361   000000 701000 xent               TSX1    ASH$ERROR
         2 000362   000000 011000                    NOP     0

      243    15300    4               RETURN ;

  15300  2 000363   000000 702200 xent               TSX2  ! X66_ARET

      244    15301    4               END ; /* Then do */
      245    15302    3            I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;

  15302  2 000364   000017 235100                    LDA     15,,PR0
         2 000365   000020 035007                    ADLA    16,DL
         2 000366   200017 755100                    STA     I,,AUTO

      246    15303    3            VC$ = DSEG1$;

  15303  2 000367   000000 236000 xsym               LDQ     DSEG1$
         2 000370   200030 756100                    STQ     VC$,,AUTO

      247    15304    3            DISP_LINKS = 1;

  15304  2 000371   000001 235007                    LDA     1,DL
         2 000372   200012 755100                    STA     DISP_LINKS,,AUTO

      248    15305    3            NEW_LINK = %YES#;

  15305  2 000373   400000 236003                    LDQ     -131072,DU
         2 000374   200025 756100                    STQ     NEW_LINK,,AUTO

      249    15306    4            DO FOREVER;

      250    15307    4               CALL ASL$FIND_VIRCIR (DSEG1$, I, VC_NAME, VC$) ALTRET (FINISH_UP);
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:35   

  15307  2 000375   200030 630500                    EPPR0   VC$,,AUTO
         2 000376   200035 450500                    STP0    WILD_CARD+4,,AUTO
         2 000377   200026 631500                    EPPR1   VC_NAME,,AUTO
         2 000400   200034 451500                    STP1    WILD_CARD+3,,AUTO
         2 000401   200017 633500                    EPPR3   I,,AUTO
         2 000402   200033 453500                    STP3    WILD_CARD+2,,AUTO
         2 000403   000007 236000 3                  LDQ     7
         2 000404   200032 756100                    STQ     WILD_CARD+1,,AUTO
         2 000405   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000406   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000407   000000 701000 xent               TSX1    ASL$FIND_VIRCIR
         2 000410   001006 702000 2                  TSX2    FINISH_UP

      251    15308    5               IF DISP THEN DO;

  15308  2 000411   200011 234100                    SZN     DISP,,AUTO
         2 000412   000462 605000 2                  TPL     s:15319

      252    15309    6                  IF NOT JCL THEN DO;

  15309  2 000413   200021 234100                    SZN     JCL,,AUTO
         2 000414   000442 604000 2                  TMI     s:15315

      253    15310    6                     CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '   ', LINK_NAME.TEXT);

  15310  2 000415   040000 100400                    MLR     fill='040'O
         2 000416   000020 000006 1                  ADSC9   FOUND_STR+4              cn=0,n=6
         2 000417   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000420   040000 100400                    MLR     fill='040'O
         2 000421   000000 000004 1                  ADSC9   LINK_STR                 cn=0,n=4
         2 000422   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 000423   040000 100400                    MLR     fill='040'O
         2 000424   000021 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000425   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000426   040000 100500                    MLR     fill='040'O
         2 000427   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:36   
         2 000430   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      254    15311    6                     FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;

  15311  2 000431   000000 236000 xsym               LDQ     FDS
         2 000432   177777 376007                    ANQ     65535,DL
         2 000433   000011 276000 3                  ORQ     9
         2 000434   000000 756000 xsym               STQ     FDS

      255    15312    6                     FDS.NVECS# = 0;

  15312  2 000435   000011 450000 xsym               STZ     FDS+9

      256    15313    6                     CALL X$FORMAT (FDS);

  15313  2 000436   000003 630400 3                  EPPR0   3
         2 000437   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000440   000000 701000 xent               TSX1    X$FORMAT
         2 000441   000000 011000                    NOP     0

      257    15314    6                     END; /*  Not jcl  */

      258    15315    5                  CALL ASL$DISP_ONE_VIRCIR (VC$, NEW_LINK, JCL, LINK_NAME.TEXT);

  15315  2 000442   200036 452500                    STP2    WILD_CARD+5,,AUTO
         2 000443   200036 236100                    LDQ     WILD_CARD+5,,AUTO
         2 000444   000012 036000 3                  ADLQ    10
         2 000445   200035 756100                    STQ     WILD_CARD+4,,AUTO
         2 000446   200021 630500                    EPPR0   JCL,,AUTO
         2 000447   200034 450500                    STP0    WILD_CARD+3,,AUTO
         2 000450   200025 631500                    EPPR1   NEW_LINK,,AUTO
         2 000451   200033 451500                    STP1    WILD_CARD+2,,AUTO
         2 000452   200030 633500                    EPPR3   VC$,,AUTO
         2 000453   200032 453500                    STP3    WILD_CARD+1,,AUTO
         2 000454   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000455   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000456   000000 701000 xent               TSX1    ASL$DISP_ONE_VIRCIR
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:37   
         2 000457   000000 011000                    NOP     0

      259    15316    5                  NEW_LINK = %NO#;

  15316  2 000460   200025 450100                    STZ     NEW_LINK,,AUTO

      260    15317    5                  END; /*  Disp  */

  15317  2 000461   000520 710000 2                  TRA     s:15328

      261    15318    5               ELSE DO;

      262    15319    5                  FMT_BUF = '%1/   %A  %A  %A  %D';

  15319  2 000462   040000 100400                    MLR     fill='040'O
         2 000463   000022 000024 1                  ADSC9   FOUND_STR+6              cn=0,n=20
         2 000464   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      263    15320    5                  FDS.FMT_.BOUND = 20;

  15320  2 000465   000000 236000 xsym               LDQ     FDS
         2 000466   177777 376007                    ANQ     65535,DL
         2 000467   000005 276003                    ORQ     5,DU
         2 000470   000000 756000 xsym               STQ     FDS

      264    15321    5                  FDS.NVECS# = 4;

  15321  2 000471   000004 235007                    LDA     4,DL
         2 000472   000011 755000 xsym               STA     FDS+9

      265    15322    5                  FMT_VEC (0) = VECTOR (LINK_STR);

  15322  2 000473   000014 237000 3                  LDAQ    12
         2 000474   000000 755000 xsym               STA     FMT_VEC
         2 000475   000001 756000 xsym               STQ     FMT_VEC+1

      266    15323    5                  FMT_VEC (1) = VECTOR (LINK_NAME.TEXT);
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:38   

  15323  2 000476   000013 235000 3                  LDA     11
         2 000477   200032 452500                    STP2    WILD_CARD+1,,AUTO
         2 000500   200032 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000501   000012 036000 3                  ADLQ    10
         2 000502   000002 755000 xsym               STA     FMT_VEC+2
         2 000503   000003 756000 xsym               STQ     FMT_VEC+3

      267    15324    5                  FMT_VEC (2) = VECTOR (VIRCIR_STR);

  15324  2 000504   000016 237000 3                  LDAQ    14
         2 000505   000004 755000 xsym               STA     FMT_VEC+4
         2 000506   000005 756000 xsym               STQ     FMT_VEC+5

      268    15325    5                  FMT_VEC (3) = VECTOR (KL$LNKVC.VIRCIR#);

  15325  2 000507   377640 235007                    LDA     130976,DL
         2 000510   200030 236100                    LDQ     VC$,,AUTO
         2 000511   000020 036000 3                  ADLQ    16
         2 000512   000006 755000 xsym               STA     FMT_VEC+6
         2 000513   000007 756000 xsym               STQ     FMT_VEC+7

      269    15326    5                  CALL X$FORMAT (FDS);

  15326  2 000514   000003 630400 3                  EPPR0   3
         2 000515   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000516   000000 701000 xent               TSX1    X$FORMAT
         2 000517   000000 011000                    NOP     0

      270    15327    5                  END; /*  ~ disp  */

      271    15328    4               DISP_VIRCIRS = DISP_VIRCIRS + 1;

  15328  2 000520   200013 054100                    AOS     DISP_VIRCIRS,,AUTO

      272    15329    4               END; /*  Forever  */

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:39   
  15329  2 000521   000375 710000 2                  TRA     s:15307

      273    15330    3            END;  /*  Whenreturn  */
      274    15331    3         WHENALTRETURN DO;

      275    15332    3            IF MERR_CODE.CODE = %E$NOKEY

  15332  2 000522   000000 236000 xsym               LDQ     ERR_CODE
         2 000523   377770 376007                    ANQ     131064,DL
         2 000524   001020 116007                    CMPQ    528,DL
         2 000525   000536 601000 2                  TNZ     s:15352

      276    15333    4            THEN DO;

      277    15334    4               AS_FIELD1 = LINK_NAME;

  15334  2 000526   000000 100500                    MLR     fill='000'O
         2 000527   200022 000011                    ADSC9   LINK_NAME,,AUTO          cn=0,n=9
         2 000530   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      278    15335                    %SCREAM( ERR#=E$LINK_NO_EXIST2, MID='L', LEVEL=ERROR );

  15347  2 000531   000021 630400 3                  EPPR0   17
         2 000532   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000533   000000 701000 xent               TSX1    ASH$ERROR
         2 000534   000000 011000                    NOP     0

      279    15350    4               END;  /*  Error = nokey  */

  15350  2 000535   000542 710000 2                  TRA     s:15355

      280    15351    4            ELSE DO;

      281    15352    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15352  2 000536   000023 630400 3                  EPPR0   19
         2 000537   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:40   
         2 000540   000000 701000 xent               TSX1    ASA$ERROR
         2 000541   000000 011000                    NOP     0

      282    15353    4               END;  /* Error ~= nokey */

      283    15354    3            END;  /*  Whenaltreturn  */

      284    15355    2         GOTO FINISH_UP;

  15355  2 000542   001006 710000 2                  TRA     FINISH_UP

      285    15356    2         END; /*  Else  */
      286    15357    1   CALL ASB$PREC_HLP ;

  15357  2 000543   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000544   000000 701000 xent               TSX1    ASB$PREC_HLP
         2 000545   000000 011000                    NOP     0

      287    15358    2   DO FOREVER;

      288    15359
      289    15360    3      DO UNTIL LINK$DREC.ATYP = %KLAT_LNKLINE# ;

      290    15361    3         I = DSEG1SIZE;

  15361  2 000546   000000 235000 xsym               LDA     DSEG1SIZE
         2 000547   200017 755100                    STA     I,,AUTO

      291    15362    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)

  15362  2 000550   000006 236000 3                  LDQ     6
         2 000551   200034 756100                    STQ     WILD_CARD+3,,AUTO
         2 000552   200017 630500                    EPPR0   I,,AUTO
         2 000553   200033 450500                    STP0    WILD_CARD+2,,AUTO
         2 000554   000007 236000 3                  LDQ     7
         2 000555   200032 756100                    STQ     WILD_CARD+1,,AUTO
         2 000556   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:41   
         2 000557   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000560   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         2 000561   000563 702000 2                  TSX2    s:15364
         2 000562   000574 710000 2                  TRA     s:15367

      292    15363    4         WHENALTRETURN DO;

      293    15364    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  15364  2 000563   000000 236000 xsym               LDQ     ERR_CODE
         2 000564   377770 376007                    ANQ     131064,DL
         2 000565   000060 116007                    CMPQ    48,DL
         2 000566   000573 600000 2                  TZE     s:15365

  15364  2 000567   000025 630400 3                  EPPR0   21
         2 000570   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000571   000000 701000 xent               TSX1    ASH$ERROR
         2 000572   000000 011000                    NOP     0

      294    15365    4            GOTO FINISH_UP;

  15365  2 000573   001006 710000 2                  TRA     FINISH_UP

      295    15366    4            END;  /*  Whenaltreturn  */
      296    15367    3         END;  /*  Do until we find a link record  */

  15367  2 000574   000000 470400 xsym               LDP0    DSEG1$
         2 000575   000000 236100                    LDQ     0,,PR0
         2 000576   777000 376003                    ANQ     -512,DU
         2 000577   006000 116003                    CMPQ    3072,DU
         2 000600   000546 601000 2                  TNZ     s:15361

      297    15368    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;

  15368  2 000601   000000 124400                    SCM     mask='000'O
         2 000602   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000603   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:42   
         2 000604   200017 000100                    ARG     I,,AUTO

      298    15369    2      IF I > 8 THEN I = 8;

  15369  2 000605   200017 235100                    LDA     I,,AUTO
         2 000606   000011 115007                    CMPA    9,DL
         2 000607   000612 602000 2                  TNC     s:15370

  15369  2 000610   000010 236007                    LDQ     8,DL
         2 000611   200017 756100                    STQ     I,,AUTO

      299    15370    2      CURRENT_LINK = SUBSTR(USERS_KEY.TXTC,0,I);

  15370  2 000612   200017 720100                    LXL0    I,,AUTO
         2 000613   040100 100440                    MLR     fill='040'O
         2 000614   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000615   200007 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=8

      300    15371    3      IF WILD_CARD THEN DO;

  15371  2 000616   200031 234100                    SZN     WILD_CARD,,AUTO
         2 000617   000647 605000 2                  TPL     s:15381

      301    15372    3         J = LINK_NAME.COUNT;

  15372  2 000620   200022 236100                    LDQ     LINK_NAME,,AUTO
         2 000621   000033 772000                    QRL     27
         2 000622   200020 756100                    STQ     J,,AUTO

      302    15373    3         CALL ASB$WILD_MATCH (I, CURRENT_LINK, J, LINK_NAME.TEXT)

  15373  2 000623   200036 452500                    STP2    WILD_CARD+5,,AUTO
         2 000624   200036 236100                    LDQ     WILD_CARD+5,,AUTO
         2 000625   000012 036000 3                  ADLQ    10
         2 000626   200035 756100                    STQ     WILD_CARD+4,,AUTO
         2 000627   200020 631500                    EPPR1   J,,AUTO
         2 000630   200034 451500                    STP1    WILD_CARD+3,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:43   
         2 000631   200007 633500                    EPPR3   CURRENT_LINK,,AUTO
         2 000632   200033 453500                    STP3    WILD_CARD+2,,AUTO
         2 000633   200017 634500                    EPPR4   I,,AUTO
         2 000634   200032 454500                    STP4    WILD_CARD+1,,AUTO
         2 000635   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000636   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000637   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000640   000642 702000 2                  TSX2    s:15375
         2 000641   000647 710000 2                  TRA     s:15381

      303    15374    4         WHENALTRETURN DO;

      304    15375    4            IF CURRENT_LINK > END_KEY.TEXT THEN

  15375  2 000642   040100 106500                    CMPC    fill='040'O
         2 000643   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000644   200007 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=8
         2 000645   001006 602000 2                  TNC     FINISH_UP

      305    15376    4               GOTO FINISH_UP;
      306    15377    4            ELSE
      307    15378    4               GOTO END_FOREVER;

  15378  2 000646   001005 710000 2                  TRA     END_FOREVER

      308    15379    4            END;  /*  Whenaltreturn  */
      309    15380    3         END; /*  WILD_CARD  */

      310    15381    2      DISP_LINKS = DISP_LINKS + 1;

  15381  2 000647   200012 054100                    AOS     DISP_LINKS,,AUTO

      311    15382    2      I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;

  15382  2 000650   000000 470400 xsym               LDP0    DSEG1$
         2 000651   000017 235100                    LDA     15,,PR0
         2 000652   000020 035007                    ADLA    16,DL
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:44   
         2 000653   200017 755100                    STA     I,,AUTO

      312    15383    2      VC$ = DSEG1$;

  15383  2 000654   000000 236000 xsym               LDQ     DSEG1$
         2 000655   200030 756100                    STQ     VC$,,AUTO

      313    15384    2      NEW_LINK = %YES#;

  15384  2 000656   400000 236003                    LDQ     -131072,DU
         2 000657   200025 756100                    STQ     NEW_LINK,,AUTO

      314    15385    3      DO FOREVER;

      315    15386    3         CALL ASL$FIND_VIRCIR (DSEG1$, I, VC_NAME, VC$) ALTRET (END_FOREVER);

  15386  2 000660   200030 630500                    EPPR0   VC$,,AUTO
         2 000661   200035 450500                    STP0    WILD_CARD+4,,AUTO
         2 000662   200026 631500                    EPPR1   VC_NAME,,AUTO
         2 000663   200034 451500                    STP1    WILD_CARD+3,,AUTO
         2 000664   200017 633500                    EPPR3   I,,AUTO
         2 000665   200033 453500                    STP3    WILD_CARD+2,,AUTO
         2 000666   000007 236000 3                  LDQ     7
         2 000667   200032 756100                    STQ     WILD_CARD+1,,AUTO
         2 000670   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000671   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000672   000000 701000 xent               TSX1    ASL$FIND_VIRCIR
         2 000673   001005 702000 2                  TSX2    END_FOREVER

      316    15387    4         IF DISP THEN DO;

  15387  2 000674   200011 234100                    SZN     DISP,,AUTO
         2 000675   000745 605000 2                  TPL     s:15398

      317    15388    5            IF NEW_LINK AND NOT JCL THEN DO;

  15388  2 000676   200025 234100                    SZN     NEW_LINK,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:45   
         2 000677   000727 605000 2                  TPL     s:15394
         2 000700   200021 234100                    SZN     JCL,,AUTO
         2 000701   000727 604000 2                  TMI     s:15394

      318    15389    5               CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '   ', SUBSTR(USERS_KEY.TXTC,
             15389                        0,8));

  15389  2 000702   040000 100400                    MLR     fill='040'O
         2 000703   000020 000006 1                  ADSC9   FOUND_STR+4              cn=0,n=6
         2 000704   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000705   040000 100400                    MLR     fill='040'O
         2 000706   000000 000004 1                  ADSC9   LINK_STR                 cn=0,n=4
         2 000707   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 000710   040000 100400                    MLR     fill='040'O
         2 000711   000021 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000712   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000713   040000 100400                    MLR     fill='040'O
         2 000714   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000715   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      319    15390    5               FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;

  15390  2 000716   000000 236000 xsym               LDQ     FDS
         2 000717   177777 376007                    ANQ     65535,DL
         2 000720   000011 276000 3                  ORQ     9
         2 000721   000000 756000 xsym               STQ     FDS

      320    15391    5               FDS.NVECS# = 0;

  15391  2 000722   000011 450000 xsym               STZ     FDS+9

      321    15392    5               CALL X$FORMAT (FDS);

  15392  2 000723   000003 630400 3                  EPPR0   3
         2 000724   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000725   000000 701000 xent               TSX1    X$FORMAT
         2 000726   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:46   

      322    15393    5               END;  /*  New link */

      323    15394    4            CALL ASL$DISP_ONE_VIRCIR (VC$, NEW_LINK, JCL, CURRENT_LINK);

  15394  2 000727   200007 630500                    EPPR0   CURRENT_LINK,,AUTO
         2 000730   200035 450500                    STP0    WILD_CARD+4,,AUTO
         2 000731   200021 631500                    EPPR1   JCL,,AUTO
         2 000732   200034 451500                    STP1    WILD_CARD+3,,AUTO
         2 000733   200025 633500                    EPPR3   NEW_LINK,,AUTO
         2 000734   200033 453500                    STP3    WILD_CARD+2,,AUTO
         2 000735   200030 634500                    EPPR4   VC$,,AUTO
         2 000736   200032 454500                    STP4    WILD_CARD+1,,AUTO
         2 000737   200032 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000740   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000741   000000 701000 xent               TSX1    ASL$DISP_ONE_VIRCIR
         2 000742   000000 011000                    NOP     0

      324    15395    4            NEW_LINK = %NO#;

  15395  2 000743   200025 450100                    STZ     NEW_LINK,,AUTO

      325    15396    4            END;  /*  Disp  */

  15396  2 000744   001003 710000 2                  TRA     s:15407

      326    15397    4         ELSE DO;

      327    15398    4            FMT_BUF = '%1/   %A  %A  %A  %D';

  15398  2 000745   040000 100400                    MLR     fill='040'O
         2 000746   000022 000024 1                  ADSC9   FOUND_STR+6              cn=0,n=20
         2 000747   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      328    15399    4            FDS.FMT_.BOUND = 20;

  15399  2 000750   000000 236000 xsym               LDQ     FDS
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:47   
         2 000751   177777 376007                    ANQ     65535,DL
         2 000752   000005 276003                    ORQ     5,DU
         2 000753   000000 756000 xsym               STQ     FDS

      329    15400    4            FDS.NVECS# = 4;

  15400  2 000754   000004 235007                    LDA     4,DL
         2 000755   000011 755000 xsym               STA     FDS+9

      330    15401    4            FMT_VEC (0) = VECTOR (LINK_STR);

  15401  2 000756   000014 237000 3                  LDAQ    12
         2 000757   000000 755000 xsym               STA     FMT_VEC
         2 000760   000001 756000 xsym               STQ     FMT_VEC+1

      331    15402    4            FMT_VEC (1) = VECTOR (CURRENT_LINK);

  15402  2 000761   000013 235000 3                  LDA     11
         2 000762   200032 452500                    STP2    WILD_CARD+1,,AUTO
         2 000763   200032 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000764   000007 036003                    ADLQ    7,DU
         2 000765   000002 755000 xsym               STA     FMT_VEC+2
         2 000766   000003 756000 xsym               STQ     FMT_VEC+3

      332    15403    4            FMT_VEC (2) = VECTOR (VIRCIR_STR);

  15403  2 000767   000016 237000 3                  LDAQ    14
         2 000770   000004 755000 xsym               STA     FMT_VEC+4
         2 000771   000005 756000 xsym               STQ     FMT_VEC+5

      333    15404    4            FMT_VEC (3) = VECTOR (KL$LNKVC.VIRCIR#);

  15404  2 000772   377640 235007                    LDA     130976,DL
         2 000773   200030 236100                    LDQ     VC$,,AUTO
         2 000774   000020 036000 3                  ADLQ    16
         2 000775   000006 755000 xsym               STA     FMT_VEC+6
         2 000776   000007 756000 xsym               STQ     FMT_VEC+7
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:48   

      334    15405    4            CALL X$FORMAT (FDS);

  15405  2 000777   000003 630400 3                  EPPR0   3
         2 001000   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001001   000000 701000 xent               TSX1    X$FORMAT
         2 001002   000000 011000                    NOP     0

      335    15406    4            END;  /*  ~ disp  */

      336    15407    3         DISP_VIRCIRS = DISP_VIRCIRS + 1;

  15407  2 001003   200013 054100                    AOS     DISP_VIRCIRS,,AUTO

      337    15408    3         END;  /*  Forever  */

  15408  2 001004   000660 710000 2                  TRA     s:15386

      338    15409    2   END_FOREVER:
      339    15410    2      END;  /*  Do forever  */

  15410  2 001005   000546 710000 2     END_FOREVER  TRA     s:15361

      340    15411    1   FINISH_UP:
      341    15412    2   IF NOT DISP THEN DO;

  15412  2 001006   200011 234100       FINISH_UP    SZN     DISP,,AUTO
         2 001007   001024 604000 2                  TMI     s:15418

      342    15413    2      FMT_BUF = '%\%/';

  15413  2 001010   040000 100400                    MLR     fill='040'O
         2 001011   000030 000004 1                  ADSC9   FOUND_STR+12             cn=0,n=4
         2 001012   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      343    15414    2      FDS.FMT_.BOUND = 3;

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:49   
  15414  2 001013   000000 236000 xsym               LDQ     FDS
         2 001014   177777 376007                    ANQ     65535,DL
         2 001015   600000 276007                    ORQ     -65536,DL
         2 001016   000000 756000 xsym               STQ     FDS

      344    15415    2      FDS.NVECS# = 0;

  15415  2 001017   000011 450000 xsym               STZ     FDS+9

      345    15416    2      CALL X$FORMAT(FDS);

  15416  2 001020   000003 630400 3                  EPPR0   3
         2 001021   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001022   000000 701000 xent               TSX1    X$FORMAT
         2 001023   000000 011000                    NOP     0

      346    15417    2      END; /*  If not disp  */

      347    15418    2   IF NOT JCL THEN DO;

  15418  2 001024   200021 234100                    SZN     JCL,,AUTO
         2 001025   001134 604000 2                  TMI     s:15452

      348    15419    2      FMT_VEC(0) = VECTOR (DISP_LINKS);

  15419  2 001026   777640 235007                    LDA     -96,DL
         2 001027   200032 452500                    STP2    WILD_CARD+1,,AUTO
         2 001030   200032 236100                    LDQ     WILD_CARD+1,,AUTO
         2 001031   000012 036003                    ADLQ    10,DU
         2 001032   000000 755000 xsym               STA     FMT_VEC
         2 001033   000001 756000 xsym               STQ     FMT_VEC+1

      349    15420    2      IF DISP_LINKS = 1 THEN

  15420  2 001034   200012 235100                    LDA     DISP_LINKS,,AUTO
         2 001035   000001 115007                    CMPA    1,DL
         2 001036   001043 601000 2                  TNZ     s:15425
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:50   

      350    15421    3      DO;

      351    15422    3         FMT_VEC(1) = VECTOR (LINK_STR);

  15422  2 001037   000014 237000 3                  LDAQ    12
         2 001040   000002 755000 xsym               STA     FMT_VEC+2
         2 001041   000003 756000 xsym               STQ     FMT_VEC+3

      352    15423    3         END; /*  DISP_LINKS = 1  */

  15423  2 001042   001046 710000 2                  TRA     s:15427

      353    15424    3      ELSE DO;

      354    15425    3         FMT_VEC(1) = VECTOR (LINKS_STR);

  15425  2 001043   000026 237000 3                  LDAQ    22
         2 001044   000002 755000 xsym               STA     FMT_VEC+2
         2 001045   000003 756000 xsym               STQ     FMT_VEC+3

      355    15426    3         END; /*  DISP_LINKS ~= 1  */

      356    15427    2      FMT_VEC(2) = VECTOR (FOUND_STR);

  15427  2 001046   000030 237000 3                  LDAQ    24
         2 001047   000004 755000 xsym               STA     FMT_VEC+4
         2 001050   000005 756000 xsym               STQ     FMT_VEC+5

      357    15428    2      FDS.NVECS# = 3;

  15428  2 001051   000003 235007                    LDA     3,DL
         2 001052   000011 755000 xsym               STA     FDS+9

      358    15429    2      FMT_BUF = '   %5D %A %A.';

  15429  2 001053   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:51   
         2 001054   000031 000015 1                  ADSC9   FOUND_STR+13             cn=0,n=13
         2 001055   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      359    15430    2      FDS.FMT_.BOUND = 12;

  15430  2 001056   000000 236000 xsym               LDQ     FDS
         2 001057   177777 376007                    ANQ     65535,DL
         2 001060   000003 276003                    ORQ     3,DU
         2 001061   000000 756000 xsym               STQ     FDS

      360    15431    2      CALL X$FORMAT(FDS);

  15431  2 001062   000003 630400 3                  EPPR0   3
         2 001063   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001064   000000 701000 xent               TSX1    X$FORMAT
         2 001065   000000 011000                    NOP     0

      361    15432    2      FMT_VEC(0) = VECTOR (DISP_VIRCIRS);

  15432  2 001066   777640 235007                    LDA     -96,DL
         2 001067   200032 452500                    STP2    WILD_CARD+1,,AUTO
         2 001070   200032 236100                    LDQ     WILD_CARD+1,,AUTO
         2 001071   000013 036003                    ADLQ    11,DU
         2 001072   000000 755000 xsym               STA     FMT_VEC
         2 001073   000001 756000 xsym               STQ     FMT_VEC+1

      362    15433    2      IF DISP_VIRCIRS = 1 THEN

  15433  2 001074   200013 235100                    LDA     DISP_VIRCIRS,,AUTO
         2 001075   000001 115007                    CMPA    1,DL
         2 001076   001103 601000 2                  TNZ     s:15438

      363    15434    3      DO;

      364    15435    3         FMT_VEC(1) = VECTOR (VIRCIR_STR);

  15435  2 001077   000016 237000 3                  LDAQ    14
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:52   
         2 001100   000002 755000 xsym               STA     FMT_VEC+2
         2 001101   000003 756000 xsym               STQ     FMT_VEC+3

      365    15436    3         END; /*  DISP_VIRCIRS = 1  */

  15436  2 001102   001106 710000 2                  TRA     s:15440

      366    15437    3      ELSE DO;

      367    15438    3         FMT_VEC(1) = VECTOR (VIRCIRS_STR);

  15438  2 001103   000032 237000 3                  LDAQ    26
         2 001104   000002 755000 xsym               STA     FMT_VEC+2
         2 001105   000003 756000 xsym               STQ     FMT_VEC+3

      368    15439    3         END; /*  DISP_VIRCIRS ~= 1  */

      369    15440    2      IF DISP THEN

  15440  2 001106   200011 234100                    SZN     DISP,,AUTO
         2 001107   001114 605000 2                  TPL     s:15445

      370    15441    3      DO;

      371    15442    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15442  2 001110   000034 237000 3                  LDAQ    28
         2 001111   000004 755000 xsym               STA     FMT_VEC+4
         2 001112   000005 756000 xsym               STQ     FMT_VEC+5

      372    15443    3         END; /*  If disp  */

  15443  2 001113   001117 710000 2                  TRA     s:15447

      373    15444    3      ELSE DO;

      374    15445    3         FMT_VEC(2) = VECTOR (LIST_STR);
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:53   

  15445  2 001114   000036 237000 3                  LDAQ    30
         2 001115   000004 755000 xsym               STA     FMT_VEC+4
         2 001116   000005 756000 xsym               STQ     FMT_VEC+5

      375    15446    3         END; /*  If ~ disp  */

      376    15447    2      FDS.NVECS# = 3;

  15447  2 001117   000003 235007                    LDA     3,DL
         2 001120   000011 755000 xsym               STA     FDS+9

      377    15448    2      FMT_BUF = '   %5D %A %A.';

  15448  2 001121   040000 100400                    MLR     fill='040'O
         2 001122   000031 000015 1                  ADSC9   FOUND_STR+13             cn=0,n=13
         2 001123   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      378    15449    2      FDS.FMT_.BOUND = 12;

  15449  2 001124   000000 236000 xsym               LDQ     FDS
         2 001125   177777 376007                    ANQ     65535,DL
         2 001126   000003 276003                    ORQ     3,DU
         2 001127   000000 756000 xsym               STQ     FDS

      379    15450    2      CALL X$FORMAT(FDS);

  15450  2 001130   000003 630400 3                  EPPR0   3
         2 001131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001132   000000 701000 xent               TSX1    X$FORMAT
         2 001133   000000 011000                    NOP     0

      380    15451    2      END; /* Not jcl */

      381    15452    1   RETURN;

  15452  2 001134   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:54   
      382    15453    1   END ASL$LIST_ALL_VIRCIRS;
      383    15454        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:55   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_VIRCIRS.
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:56   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_VIRCIRS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c CHAR(9)     r     1 DISPLAY_STR               14-0-0/c CHAR(5)     r     1 FOUND_STR
     1-0-0/c CHAR(5)     r     1 LINKS_STR                  0-0-0/c CHAR(4)     r     1 LINK_STR
     7-0-0/c CHAR(6)     r     1 LIST_STR                   5-0-0/c CHAR(7)     r     1 VIRCIRS_STR
     3-0-0/c CHAR(6)     r     1 VIRCIR_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_LINKS                  4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/c CHAR(8)     r     1 CURRENT_LINK              11-0-0/b BIT         r     1 DISP
    12-0-0/w SBIN        r     1 DISP_LINKS                13-0-0/w SBIN        r     1 DISP_VIRCIRS
    14-0-0/w STRC(108)   r     1 END_KEY                   17-0-0/w UBIN        r     1 I
    20-0-0/w UBIN        r     1 J                         21-0-0/b BIT         r     1 JCL
    22-0-0/c STRC(81)    r     1 LINK_NAME                 25-0-0/b BIT         r     1 NEW_LINK
    30-0-0/w PTR         r     1 VC$                       26-0-0/c STRC(45)    r     1 VC_NAME
    31-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:57   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KL$LNKVC                   0-0-0/w STRC(576)   r     1 LINK$DREC
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_VIRCIRS requires 605 words for executable code.
   Procedure ASL$LIST_ALL_VIRCIRS requires 32 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:58   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:59   
          MINI XREF LISTING

ALL_LINKS
     15149**DCL     15251<<ASSIGN  15253<<ASSIGN  15270>>IF
ASA$ERROR
     14705**DCL-ENT 15352--CALL
ASA_BRKS_LOC
     11837**DCL     11837--REDEF
ASB$PREC_HLP
     14693**DCL-ENT 15357--CALL
ASB$READ_HLP
     14696**DCL-ENT 15281--CALL
ASB$READ_HLP_SEQ
     14699**DCL-ENT 15362--CALL
ASB$WILD_MATCH
     14714**DCL-ENT 15373--CALL
ASH$ERROR
     14702**DCL-ENT 15297--CALL    15347--CALL    15364--CALL
ASL$DISP_ONE_VIRCIR
     14711**DCL-ENT 15315--CALL    15394--CALL
ASL$FIND_VIRCIR
     14708**DCL-ENT 15307--CALL    15386--CALL
AS_DEFAULT.BANNER_PERM
     12530**DCL     12531--REDEF
AS_DEFAULT.BUDGET.MACCT
     12435**DCL     12439--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12448**DCL     12451--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12431**DCL     12433--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12426**DCL     12428--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12546**DCL     12547--REDEF   12548--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:60   
AS_DEFAULT_DREC.PASSWORD
     13800**DCL     13804--REDEF
AS_DEFAULT_DREC.RENAME
     13823**DCL     13824--REDEF
AS_DFLT.BANNER_PERM
     12352**DCL     12353--REDEF
AS_DFLT.BUDGET.MACCT
     12257**DCL     12261--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12270**DCL     12273--REDEF
AS_DFLT.BUDGET.PACCUM
     12253**DCL     12255--REDEF
AS_DFLT.BUDGET.PMAXC
     12248**DCL     12250--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12368**DCL     12369--REDEF   12370--REDEF
AS_FE_MODE
     11703**DCL     11704--REDEF
AS_FIELD1
     11833**DCL     15284<<ASSIGN  15334<<ASSIGN
AS_MODE
     11700**DCL     11702--REDEF
AS_MOD_USER.ACCESS
     14565**DCL     14566--REDEF
AS_MOD_USER.BANNER
     14552**DCL     14553--REDEF
AS_MOD_USER.BANNER_PERM
     14554**DCL     14555--REDEF
AS_MOD_USER.BILL
     14560**DCL     14561--REDEF
AS_MOD_USER.CPROC
     14556**DCL     14557--REDEF
AS_MOD_USER.FEBILL
     14636**DCL     14637--REDEF
AS_MOD_USER.FECXTMEM
     14653**DCL     14654--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:61   
AS_MOD_USER.FEMINTS
     14638**DCL     14639--REDEF
AS_MOD_USER.FEMMEM
     14649**DCL     14650--REDEF
AS_MOD_USER.FEMTIME
     14647**DCL     14648--REDEF
AS_MOD_USER.FEPPRIV
     14644**DCL     14646--REDEF
AS_MOD_USER.FEPRIV
     14641**DCL     14643--REDEF
AS_MOD_USER.FORCE_BIT
     14550**DCL     14551--REDEF
AS_MOD_USER.KEY
     14632**DCL     14634--REDEF
AS_MOD_USER.LASTCPROC
     14558**DCL     14559--REDEF
AS_MOD_USER.LIMITS.DO_
     14606**DCL     14607--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14622**DCL     14623--REDEF
AS_MOD_USER.LIMITS.LO
     14602**DCL     14603--REDEF
AS_MOD_USER.LIMITS.MEM
     14598**DCL     14599--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14626**DCL     14627--REDEF
AS_MOD_USER.LIMITS.PDIS
     14614**DCL     14615--REDEF
AS_MOD_USER.LIMITS.PO
     14610**DCL     14611--REDEF
AS_MOD_USER.LIMITS.TDIS
     14618**DCL     14619--REDEF
AS_MOD_USER.LIMITS.TIME
     14594**DCL     14595--REDEF
AS_MOD_USER.MAXENQ
     14575**DCL     14576--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:62   
AS_MOD_USER.PERM_BIT
     14548**DCL     14549--REDEF
AS_MOD_USER.PPRIV
     14570**DCL     14572--REDEF
AS_MOD_USER.PRIOB
     14577**DCL     14578--REDEF
AS_MOD_USER.PRIV
     14567**DCL     14569--REDEF
AS_MOD_USER.QUAN
     14573**DCL     14574--REDEF
AS_MOD_USER.SETUP
     14546**DCL     14547--REDEF
AS_PROJECT.BANNER_PERM
     12886**DCL     12887--REDEF
AS_PROJECT.BUDGET.MACCT
     12791**DCL     12795--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12804**DCL     12807--REDEF
AS_PROJECT.BUDGET.PACCUM
     12787**DCL     12789--REDEF
AS_PROJECT.BUDGET.PMAXC
     12782**DCL     12784--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12902**DCL     12903--REDEF   12904--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13064**DCL     13065--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12969**DCL     12973--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12982**DCL     12985--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12965**DCL     12967--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12960**DCL     12962--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13080**DCL     13081--REDEF   13082--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:63   
AS_PROJECT_DFLT_DREC.PASSWORD
     14286**DCL     14290--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14309**DCL     14310--REDEF
AS_PROJECT_DREC.PASSWORD
     14124**DCL     14128--REDEF
AS_PROJECT_DREC.RENAME
     14147**DCL     14148--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12708**DCL     12709--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12613**DCL     12617--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12626**DCL     12629--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12609**DCL     12611--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12604**DCL     12606--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12724**DCL     12725--REDEF   12726--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13962**DCL     13966--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13985**DCL     13986--REDEF
AS_USERS.BANNER_PERM
     12174**DCL     12175--REDEF
AS_USERS.BUDGET.MACCT
     12079**DCL     12083--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12092**DCL     12095--REDEF
AS_USERS.BUDGET.PACCUM
     12075**DCL     12077--REDEF
AS_USERS.BUDGET.PMAXC
     12070**DCL     12072--REDEF
AS_USERS.SETUP_CHRA.TXT
     12190**DCL     12191--REDEF   12192--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:64   
AS_USERS_CONSTANT.BANNER_PERM
     13242**DCL     13243--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13147**DCL     13151--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13160**DCL     13163--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13143**DCL     13145--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13138**DCL     13140--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13258**DCL     13259--REDEF   13260--REDEF
BEGIN_KEY.COUNT
     15151**DCL     15258<<ASSIGN
BEGIN_KEY.TEXT
     15152**DCL     15254<<ASSIGN  15257<<ASSIGN  15274>>CALLBLT
CODE
     11830**DCL     15188<<ASSIGN  15198>>DOSELCT 15216>>ASSIGN
CURRENT_LINK
     15153**DCL     15370<<ASSIGN  15373<>CALL    15375>>IF      15394<>CALL    15402--ASSIGN
DISP
     15154**DCL     15202<<ASSIGN  15207<<ASSIGN  15216<<ASSIGN  15308>>IF      15387>>IF      15412>>IF
     15440>>IF
DISPLAY_STR
     15182**DCL     15442--ASSIGN
DISP_LINKS
     15155**DCL     15196<<ASSIGN  15304<<ASSIGN  15381<<ASSIGN  15381>>ASSIGN  15419--ASSIGN  15420>>IF
DISP_VIRCIRS
     15156**DCL     15195<<ASSIGN  15328<<ASSIGN  15328>>ASSIGN  15407<<ASSIGN  15407>>ASSIGN  15432--ASSIGN
     15433>>IF
DSEG1$
     11838**DCL     14819--IMP-PTR 15281<>CALL    15283>>IF      15302>>ASSIGN  15303>>ASSIGN  15307<>CALL
     15360>>DOUNTIL 15362<>CALL    15382>>ASSIGN  15383>>ASSIGN  15386<>CALL
DSEG1SIZE
     11839**DCL     15280>>ASSIGN  15361>>ASSIGN
END_FOREVER
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:65   
     15410**LABEL   15378--GOTO    15386--CALLALT
END_KEY.COUNT
     15158**DCL     15260<<ASSIGN
END_KEY.TEXT
     15159**DCL     15255<<ASSIGN  15259<<CALLBLT 15375>>IF
ERR_CODE
     11832**DCL     11833--REDEF
FDS
     11729**DCL     15248<>CALL    15313<>CALL    15326<>CALL    15392<>CALL    15405<>CALL    15416<>CALL
     15431<>CALL    15450<>CALL
FDS.FMT_.BOUND
     11734**DCL     15241<<ASSIGN  15245<<ASSIGN  15311<<ASSIGN  15320<<ASSIGN  15390<<ASSIGN  15399<<ASSIGN
     15414<<ASSIGN  15430<<ASSIGN  15449<<ASSIGN
FDS.NVECS#
     11757**DCL     15238<<ASSIGN  15268<<ASSIGN  15312<<ASSIGN  15321<<ASSIGN  15391<<ASSIGN  15400<<ASSIGN
     15415<<ASSIGN  15428<<ASSIGN  15447<<ASSIGN
FDS.TABDFLT#
     11795**DCL     15247<<ASSIGN
FINISH_UP
     15412**LABEL   15307--CALLALT 15355--GOTO    15365--GOTO    15376--GOTO
FMT_BUF
     11828**DCL     15240<<CALLBLT 15244<<CALLBLT 15310<<CALLBLT 15319<<ASSIGN  15389<<CALLBLT 15398<<ASSIGN
     15413<<ASSIGN  15429<<ASSIGN  15448<<ASSIGN
FMT_VEC
     11828**DCL     15322<<ASSIGN  15323<<ASSIGN  15324<<ASSIGN  15325<<ASSIGN  15401<<ASSIGN  15402<<ASSIGN
     15403<<ASSIGN  15404<<ASSIGN  15419<<ASSIGN  15422<<ASSIGN  15425<<ASSIGN  15427<<ASSIGN  15432<<ASSIGN
     15435<<ASSIGN  15438<<ASSIGN  15442<<ASSIGN  15445<<ASSIGN
FOUND_STR
     15183**DCL     15427--ASSIGN
I
     15160**DCL     15217<<DOINDEX 15218>>IF      15219>>ASSIGN  15219>>ASSIGN  15220>>ASSIGN  15223>>IF
     15224>>ASSIGN  15224>>ASSIGN  15225>>ASSIGN  15228>>IF      15256<<CALLBLT 15257>>ASSIGN  15259>>CALLBLT
     15260>>ASSIGN  15280<<ASSIGN  15281<>CALL    15302<<ASSIGN  15307<>CALL    15361<<ASSIGN  15362<>CALL
     15368<<CALLBLT 15369>>IF      15369<<ASSIGN  15370>>ASSIGN  15373<>CALL    15382<<ASSIGN  15386<>CALL
J
     15161**DCL     15372<<ASSIGN  15373<>CALL
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:66   
JCL
     15162**DCL     15189<<ASSIGN  15203<<ASSIGN  15209<<ASSIGN  15211<<ASSIGN  15230<<ASSIGN  15239>>IF
     15309>>IF      15315<>CALL    15388>>IF      15394<>CALL    15418>>IF
KL$LNKVC.CUG
     15036**DCL     15080--REDEF
KL$LNKVC.VIRCIR#
     15128**DCL     15325--ASSIGN  15404--ASSIGN
KL_DEFAULT.PASSWORD
     14448**DCL     14452--REDEF
KL_DEFAULT.RENAME
     14471**DCL     14472--REDEF
KL_DFLT.PASSWORD
     13638**DCL     13642--REDEF
KL_DFLT.RENAME
     13661**DCL     13662--REDEF
KL_DREC.PASSWORD
     13476**DCL     13480--REDEF
KL_DREC.RENAME
     13499**DCL     13500--REDEF
KL_DREC_CNT.PASSWORD
     13363**DCL     13367--REDEF
KL_DREC_CNT.RENAME
     13386**DCL     13387--REDEF
LINK$DREC
     14819**DCL     15302--ASSIGN  15382--ASSIGN
LINK$DREC.ATYP
     14824**DCL     15283>>IF      15360>>DOUNTIL
LINK$DREC.NWINFO
     14917**DCL     15302>>ASSIGN  15382>>ASSIGN
LINK$DREC.PASSWORD
     14877**DCL     14881--REDEF
LINK$DREC.RENAME
     14900**DCL     14901--REDEF
LINKS_STR
     15178**DCL     15425--ASSIGN
LINK_NAME
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:67   
     15163**DCL     15284>>ASSIGN  15334>>ASSIGN
LINK_NAME.COUNT
     15164**DCL     15192<<ASSIGN  15220<<ASSIGN  15372>>ASSIGN
LINK_NAME.TEXT
     15165**DCL     15191<<ASSIGN  15219<<ASSIGN  15250>>IF      15256>>CALLBLT 15257>>ASSIGN  15259>>CALLBLT
     15278>>CALLBLT 15310>>CALLBLT 15315<>CALL    15323--ASSIGN  15373<>CALL
LINK_STR
     15177**DCL     15310>>CALLBLT 15311--ASSIGN  15322--ASSIGN  15389>>CALLBLT 15390--ASSIGN  15401--ASSIGN
     15422--ASSIGN
LIST_STR
     15181**DCL     15445--ASSIGN
MERR_CODE
     11833**DCL     15364<>CALL
MERR_CODE.CODE
     11833**DCL     15332>>IF      15364>>IF
NEW_LINK
     15166**DCL     15305<<ASSIGN  15315<>CALL    15316<<ASSIGN  15384<<ASSIGN  15388>>IF      15394<>CALL
     15395<<ASSIGN
NODE$
     11830**DCL     14727--IMP-PTR
P$B.CODE
     14735**DCL     15188>>ASSIGN  15209>>ASSIGN  15211>>ASSIGN  15218>>IF      15223>>IF      15228>>IF
P$B.NSUBLKS
     14739**DCL     15208>>IF      15210>>IF      15217>>DOINDEX
P$B.SUBLK$
     14760**DCL     15188>>ASSIGN  15208>>IF      15209>>ASSIGN  15209>>ASSIGN  15210>>IF      15211>>ASSIGN
     15211>>ASSIGN  15218>>IF      15219>>ASSIGN  15219>>ASSIGN  15220>>ASSIGN  15223>>IF      15224>>ASSIGN
     15224>>ASSIGN  15225>>ASSIGN  15228>>IF
P$S.COUNT
     14796**DCL     14799--IMP-SIZ 15219>>ASSIGN  15220>>ASSIGN  15224>>ASSIGN  15225>>ASSIGN
P$S.TEXT
     14799**DCL     15219>>ASSIGN  15224>>ASSIGN
PROJ_KEY.TEXT
     11710**DCL     11710--REDEF
PROJ_KEY.TXT.PROJECT
     11710**DCL     11710--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_VIRCIRS File=ASL$LIST_VIRCIRS.:E05TSI            TUE 07/29/97 10:24 Page:68   
P_PCB.OUT$
     11878**DCL     15188>>ASSIGN  15208>>IF      15209>>ASSIGN  15210>>IF      15211>>ASSIGN  15217>>DOINDEX
     15218>>IF      15219>>ASSIGN  15219>>ASSIGN  15220>>ASSIGN  15223>>IF      15224>>ASSIGN  15224>>ASSIGN
     15225>>ASSIGN  15228>>IF
REMEM_VAR
     11836**DCL     11836--REDEF
REM_FCMD
     11836**DCL     11837--REDEF
USERS_KEY
     11707**DCL     15271<<ASSIGN  15352<>CALL
USERS_KEY.COUNT
     11707**DCL     15275<<ASSIGN  15279<<ASSIGN
USERS_KEY.TEXT
     11707**DCL     11708--REDEF   11708--REDEF   11708--REDEF   11709--REDEF
USERS_KEY.TXTC
     11708**DCL     15274<<CALLBLT 15278<<CALLBLT 15368>>CALLBLT 15370>>ASSIGN  15389>>CALLBLT
VC$
     15170**DCL     14937--IMP-PTR 15303<<ASSIGN  15307<>CALL    15315<>CALL    15325>>ASSIGN  15383<<ASSIGN
     15386<>CALL    15394<>CALL    15404>>ASSIGN
VC_NAME
     15167**DCL     15307<>CALL    15386<>CALL
VC_NAME.COUNT
     15168**DCL     15194<<ASSIGN  15225<<ASSIGN
VC_NAME.TEXT
     15169**DCL     15193<<ASSIGN  15224<<ASSIGN
VIRCIRS_STR
     15180**DCL     15240>>CALLBLT 15241--ASSIGN  15244>>CALLBLT 15245--ASSIGN  15438--ASSIGN
VIRCIR_STR
     15179**DCL     15324--ASSIGN  15403--ASSIGN  15435--ASSIGN
WILD_CARD
     15171**DCL     15190<<ASSIGN  15261<<ASSIGN  15264<<ASSIGN  15273>>IF      15371>>IF
X$FORMAT
     14716**DCL-ENT 15248--CALL    15313--CALL    15326--CALL    15392--CALL    15405--CALL    15416--CALL
     15431--CALL    15450--CALL

PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:69   
      384        1        /*T***********************************************************/
      385        2        /*T*                                                         */
      386        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      387        4        /*T*                                                         */
      388        5        /*T***********************************************************/
      389        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:70   
      390        7        /*M* ASL$FIND_VIRCIR: Routine to find link virtual circuits.*/
      391        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      392        9              ECU=3,CSU=3,SDI=3                                           */
      393       10        ASL$FIND_VIRCIR: PROC (LINK$, SIZE, NAME, VC$) ALTRET;
      394       11        /**********************************************************/
      395       12
      396       13        /*D* NAME:     ASL$FIND_VIRCIR
      397       14             CALL:     CALL ASL$FIND_VIRCIR (LINK$, SIZE, NAME, VC$)
      398       15             INPUT:    LINK$  - Pointer to the link record in memory.
      399       16                       SIZE   - The size of the link record in words.
      400       17                       NAME   - The textc name of the sought vircir.
      401       18             OUTPUT:   VC$  - Returned pointer to the vircir found.
      402       19             DESCRIPTION:  ASL$FIND_VIRCIR is the routine to handle
      403       20                           the finding of vircirs for the link in data
      404       21                           segment 1.  This routine will cycle through the
      405       22                           vircirs in data segment 1, matching the
      406       23                           vircir names against NAME if necessary
      407       24                           and then returning with VC$ pointing at the
      408       25                           vircir found or altreturning with VC$ set
      409       26                           to NIL.
      410       27        */
      411       28        /********************************************************************/
      412       29        /*   Include files   include files   include files   include files  */
      413       30        /********************************************************************/
      414       31        %INCLUDE AS_PERR_C;
      415      633        %INCLUDE AS_SUPER_C;
      416     1068        %INCLUDE AS_SUBS_C;
      417     2482        %INCLUDE AS_MAC_C;
      418     2562        %INCLUDE AS_ENTRIES_M;
      419     3612        %INCLUDE AS_SSUBS_C;
      420     3704        %INCLUDE B_ERRORS_C;
      421     4831        %INCLUDE CP_6_SUBS;
      422     5371        %INCLUDE KL_SUPER_C;
      423     8273        %INCLUDE XU_MACRO_C;
      424    11379        %INCLUDE XU_FORMAT_C;
      425    11541        %INCLUDE AS_SUPER_R;
      426    14557        /********************************************************************/
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:71   
      427    14558        /*   Parameters      parameters      parameters      parameters     */
      428    14559        /********************************************************************/
      429    14560    1   DCL LINK$                    PTR;
      430    14561    1   DCL 1 NAME,
      431    14562    1          2 COUNT               UBIN BYTE UNAL,
      432    14563    1          2 TEXT                CHAR(4) CALIGNED;
      433    14564    1   DCL SIZE                     UBIN;
      434    14565    1   DCL VC$                      PTR;
      435    14566        /********************************************************************/
      436    14567        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      437    14568        /********************************************************************/
      438    14569        %ASH$ERROR ;
      439    14572        %ASB$WILD_MATCH ;
      440    14575        /********************************************************************/
      441    14576        /*   Local based     local based     local based     local based    */
      442    14577        /********************************************************************/
      443    14578    1   DCL 1 TEXT$C BASED ALIGNED,
      444    14579    1          2 CNT                    UBIN(9) UNAL ,
      445    14580    1          2 TEXT                   CHAR(TEXT$C.CNT) UNAL;
      446    14581        %KL_DREC      ( NAME      = LINK$DREC,
      447    14582                        STCLASS   = "BASED(DSEG1$)",
      448    14583                        LAST      = ",");
      449    14696        %KL_LNK       ( NAME      = LNK,
      450    14697                        LVL       = 2,
      451    14698                        STCLASS   = BASED,
      452    14699                        LAST      = ";");
      453    14923        %KL_LNKVC     ( NAME      = KL$LNKVC,
      454    14924                        LVL       = 1,
      455    14925                        LAST      = ";",
      456    14926                        STCLASS   = "BASED( VC$ )" );
      457    15150        /********************************************************************/
      458    15151        /*   Auto data       auto data       auto data       auto data      */
      459    15152        /********************************************************************/
      460    15153    1   DCL ALL                      BIT(1);
      461    15154    1   DCL DEV_SIZEW                SBIN WORD ;
      462    15155    1   DCL DEV_START$               PTR ;
      463    15156    1   DCL DEV_STOP$                PTR ;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:72   
      464    15157    1   DCL I                        UBIN;
      465    15158    1   DCL TEMPVC                   CHAR(2);
      466    15159    1   DCL VC#                      UBIN;
      467    15160    1   DCL WILD_CARD                BIT(1);
      468    15161        /********************************************************************/
      469    15162        /*   Constant data   constant data   constant data   constant data  */
      470    15163        /********************************************************************/
      471    15164        %KL_LNKVC     ( LVL = 1, STCLASS = CONSTANT );
      472    15388        %KL_LINKDEV   ( LVL = 1, STCLASS = CONSTANT );
      473    15559        /********************************************************************/
      474    15560        /*   Procedure       procedure       procedure       procedure      */
      475    15561        /********************************************************************/
      476    15562    1   DEV_START$ = PINCRW(ADDR(LINK$DREC.LNK), SIZEW(LINK$DREC.LNK) );
      477    15563    1   DEV_SIZEW = LINK$DREC.NWINFO - POFFW(DEV_START$,ADDR(LINK$DREC.LNK));
      478    15564    1   DEV_STOP$ = PINCRW(DEV_START$, DEV_SIZEW);
      479    15565    1   ALL = %NO#;
      480    15566    1   WILD_CARD = %NO#;
      481    15567    1   IF VC$ = LINK$ THEN
      482    15568    1      VC$ = DEV_START$;
      483    15569    1   ELSE
      484    15570    1      VC$ = PINCRW (VC$, SIZEW(KL_LNKVC));
      485    15571    2   IF VC$ >= DEV_STOP$ THEN DO;
      486    15572    2      VC$ = ADDR (NIL);
      487    15573    2      ALTRETURN ;
      488    15574    2      END;  /*  VC$ >= DEV_STOP$  */
      489    15575    1   IF NAME.TEXT = '?' THEN
      490    15576    1      ALL = %YES#;
      491    15577    2   ELSE DO;
      492    15578    2      CALL INDEX (I, '?', NAME.TEXT)
      493    15579    3      WHENRETURN DO;
      494    15580    3         WILD_CARD = %YES#;
      495    15581    4         DO I = 0 TO 3;
      496    15582    4            IF SUBSTR(NAME.TEXT,I,1) = '?' THEN
      497    15583    4               SUBSTR (TEMPVC,I,1) = '0';
      498    15584    4            ELSE
      499    15585    4               SUBSTR (TEMPVC,I,1) = SUBSTR(NAME.TEXT,I,1);
      500    15586    4            END;  /*  Do 0 to 3  */
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:73   
      501    15587    3         CALL CHARBIN (VC#, SUBSTR(TEMPVC,0,NAME.COUNT));
      502    15588    3         END; /*  Whenreturn  */
      503    15589    3      WHENALTRETURN DO;
      504    15590    3         CALL CHARBIN( VC#, SUBSTR(NAME.TEXT,0,NAME.COUNT) );
      505    15591    3         END; /*  Whenaltreturn  */
      506    15592    3      IF VC# > 4095 THEN DO;
      507    15593        /*E*  ERROR:  ASL-E$BAD_VC_NUM-C
      508    15594              MESSAGE: Illegal VIRCIR number.
      509    15595              MESSAGE1: A VIRCIR number must be between 0 and 4095.
      510    15596        */
      511    15597              %SCREAM( ERR#=E$BAD_VC_NUM, LEVEL=ERROR, MID='L' );
      512    15612    3         VC$ = ADDR (NIL);
      513    15613    3         ALTRETURN;
      514    15614    3         END;   /*  Bad vircir number  */
      515    15615    2      END;  /*  Whenaltreturn  */
      516    15616                                                  /* Find controller info. */
      517    15617    2   DO WHILE VC$ < DEV_STOP$;
      518    15618    3      IF KL$LNKVC.BLKHDR.BLKTYP = %KLTY_VIRCIR# THEN DO;
      519    15619    4         IF WILD_CARD THEN DO;
      520    15620    4            CALL BINCHAR (TEMPVC, KL$LNKVC.VIRCIR#);
      521    15621    4            CALL ASB$WILD_MATCH (4, TEMPVC, 4, NAME.TEXT) ALTRET (LOOP_END);
      522    15622    4            END;   /*  If WILD_CARD  */
      523    15623    3         ELSE IF NOT WILD_CARD AND NOT ALL THEN
      524    15624    3               IF KL$LNKVC.VIRCIR# ~= VC# THEN GOTO LOOP_END;
      525    15625    3         RETURN ;
      526    15626    3   LOOP_END:
      527    15627    3         VC$ = PINCRW (VC$, SIZEW (KL_LNKVC));
      528    15628    3         END;  /*  Vircir  */
      529    15629    2      ELSE
      530    15630    2         VC$ = PINCRW (VC$, SIZEW (KL_LINKDEV));
      531    15631    2      END; /*  Do while VC$ < DEV_STOP$  */
      532    15632    1   VC$ = ADDR(NIL);
      533    15633    1   ALTRETURN ;
      534    15634    1   END ASL$FIND_VIRCIR;
      535    15635        %EOD;

PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:74   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_VIRCIR.

   Procedure ASL$FIND_VIRCIR requires 155 words for executable code.
   Procedure ASL$FIND_VIRCIR requires 20 words of local(AUTO) storage.

PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:75   

 Object Unit name= ASL$FIND_VIRCIR                            File name= ASL$LIST_VIRCIRS.:E05TOU
 UTS= JUL 29 '97 10:26:50.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     19     23  ASL$FIND_VIRCIR
    2   Proc  even  none   155    233  ASL$FIND_VIRCIR
    3  RoData even  none     4      4  ASL$FIND_VIRCIR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        4  ASL$FIND_VIRCIR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASH$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:76   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG1$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:77   


      384        1        /*T***********************************************************/
      385        2        /*T*                                                         */
      386        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      387        4        /*T*                                                         */
      388        5        /*T***********************************************************/
      389        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:78   
      390        7        /*M* ASL$FIND_VIRCIR: Routine to find link virtual circuits.*/
      391        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      392        9              ECU=3,CSU=3,SDI=3                                           */
      393       10        ASL$FIND_VIRCIR: PROC (LINK$, SIZE, NAME, VC$) ALTRET;

     10  2 000000   000000 700200 xent  ASL$FIND_VI* TSX0  ! X66_AUTO_4
         2 000001   000024 000004                    ZERO    20,4

      394       11        /**********************************************************/
      395       12
      396       13        /*D* NAME:     ASL$FIND_VIRCIR
      397       14             CALL:     CALL ASL$FIND_VIRCIR (LINK$, SIZE, NAME, VC$)
      398       15             INPUT:    LINK$  - Pointer to the link record in memory.
      399       16                       SIZE   - The size of the link record in words.
      400       17                       NAME   - The textc name of the sought vircir.
      401       18             OUTPUT:   VC$  - Returned pointer to the vircir found.
      402       19             DESCRIPTION:  ASL$FIND_VIRCIR is the routine to handle
      403       20                           the finding of vircirs for the link in data
      404       21                           segment 1.  This routine will cycle through the
      405       22                           vircirs in data segment 1, matching the
      406       23                           vircir names against NAME if necessary
      407       24                           and then returning with VC$ pointing at the
      408       25                           vircir found or altreturning with VC$ set
      409       26                           to NIL.
      410       27        */
      411       28        /********************************************************************/
      412       29        /*   Include files   include files   include files   include files  */
      413       30        /********************************************************************/
      414       31        %INCLUDE AS_PERR_C;
      415      633        %INCLUDE AS_SUPER_C;
      416     1068        %INCLUDE AS_SUBS_C;
      417     2482        %INCLUDE AS_MAC_C;
      418     2562        %INCLUDE AS_ENTRIES_M;
      419     3612        %INCLUDE AS_SSUBS_C;
      420     3704        %INCLUDE B_ERRORS_C;
      421     4831        %INCLUDE CP_6_SUBS;
      422     5371        %INCLUDE KL_SUPER_C;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:79   
      423     8273        %INCLUDE XU_MACRO_C;
      424    11379        %INCLUDE XU_FORMAT_C;
      425    11541        %INCLUDE AS_SUPER_R;
      426    14557        /********************************************************************/
      427    14558        /*   Parameters      parameters      parameters      parameters     */
      428    14559        /********************************************************************/
      429    14560    1   DCL LINK$                    PTR;
      430    14561    1   DCL 1 NAME,
      431    14562    1          2 COUNT               UBIN BYTE UNAL,
      432    14563    1          2 TEXT                CHAR(4) CALIGNED;
      433    14564    1   DCL SIZE                     UBIN;
      434    14565    1   DCL VC$                      PTR;
      435    14566        /********************************************************************/
      436    14567        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      437    14568        /********************************************************************/
      438    14569        %ASH$ERROR ;
      439    14572        %ASB$WILD_MATCH ;
      440    14575        /********************************************************************/
      441    14576        /*   Local based     local based     local based     local based    */
      442    14577        /********************************************************************/
      443    14578    1   DCL 1 TEXT$C BASED ALIGNED,
      444    14579    1          2 CNT                    UBIN(9) UNAL ,
      445    14580    1          2 TEXT                   CHAR(TEXT$C.CNT) UNAL;
      446    14581        %KL_DREC      ( NAME      = LINK$DREC,
      447    14582                        STCLASS   = "BASED(DSEG1$)",
      448    14583                        LAST      = ",");
      449    14696        %KL_LNK       ( NAME      = LNK,
      450    14697                        LVL       = 2,
      451    14698                        STCLASS   = BASED,
      452    14699                        LAST      = ";");
      453    14923        %KL_LNKVC     ( NAME      = KL$LNKVC,
      454    14924                        LVL       = 1,
      455    14925                        LAST      = ";",
      456    14926                        STCLASS   = "BASED( VC$ )" );
      457    15150        /********************************************************************/
      458    15151        /*   Auto data       auto data       auto data       auto data      */
      459    15152        /********************************************************************/
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:80   
      460    15153    1   DCL ALL                      BIT(1);
      461    15154    1   DCL DEV_SIZEW                SBIN WORD ;
      462    15155    1   DCL DEV_START$               PTR ;
      463    15156    1   DCL DEV_STOP$                PTR ;
      464    15157    1   DCL I                        UBIN;
      465    15158    1   DCL TEMPVC                   CHAR(2);
      466    15159    1   DCL VC#                      UBIN;
      467    15160    1   DCL WILD_CARD                BIT(1);
      468    15161        /********************************************************************/
      469    15162        /*   Constant data   constant data   constant data   constant data  */
      470    15163        /********************************************************************/
      471    15164        %KL_LNKVC     ( LVL = 1, STCLASS = CONSTANT );
      472    15388        %KL_LINKDEV   ( LVL = 1, STCLASS = CONSTANT );
      473    15559        /********************************************************************/
      474    15560        /*   Procedure       procedure       procedure       procedure      */
      475    15561        /********************************************************************/
      476    15562    1   DEV_START$ = PINCRW(ADDR(LINK$DREC.LNK), SIZEW(LINK$DREC.LNK) );

  15562  2 000002   000000 236000 xsym               LDQ     DSEG1$
         2 000003   000034 036003                    ADLQ    28,DU
         2 000004   200011 756100                    STQ     DEV_START$,,AUTO

      477    15563    1   DEV_SIZEW = LINK$DREC.NWINFO - POFFW(DEV_START$,ADDR(LINK$DREC.LNK));

  15563  2 000005   000000 236000 xsym               LDQ     DSEG1$
         2 000006   000020 036003                    ADLQ    16,DU
         2 000007   000022 772000                    QRL     18
         2 000010   200020 756100                    STQ     WILD_CARD+2,,AUTO
         2 000011   200011 236100                    LDQ     DEV_START$,,AUTO
         2 000012   000022 772000                    QRL     18
         2 000013   200020 136100                    SBLQ    WILD_CARD+2,,AUTO
         2 000014   200021 756100                    STQ     WILD_CARD+3,,AUTO
         2 000015   000000 470400 xsym               LDP0    DSEG1$
         2 000016   000017 236100                    LDQ     15,,PR0
         2 000017   200021 136100                    SBLQ    WILD_CARD+3,,AUTO
         2 000020   200010 756100                    STQ     DEV_SIZEW,,AUTO

PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:81   
      478    15564    1   DEV_STOP$ = PINCRW(DEV_START$, DEV_SIZEW);

  15564  2 000021   000022 736000                    QLS     18
         2 000022   200011 036100                    ADLQ    DEV_START$,,AUTO
         2 000023   200012 756100                    STQ     DEV_STOP$,,AUTO

      479    15565    1   ALL = %NO#;

  15565  2 000024   200007 450100                    STZ     ALL,,AUTO

      480    15566    1   WILD_CARD = %NO#;

  15566  2 000025   200016 450100                    STZ     WILD_CARD,,AUTO

      481    15567    1   IF VC$ = LINK$ THEN

  15567  2 000026   200006 471500                    LDP1    @VC$,,AUTO
         2 000027   200003 473500                    LDP3    @LINK$,,AUTO
         2 000030   100000 236100                    LDQ     0,,PR1
         2 000031   300000 116100                    CMPQ    0,,PR3
         2 000032   000036 601000 2                  TNZ     s:15570

      482    15568    1      VC$ = DEV_START$;

  15568  2 000033   200011 236100                    LDQ     DEV_START$,,AUTO
         2 000034   100000 756100                    STQ     0,,PR1
         2 000035   000040 710000 2                  TRA     s:15571

      483    15569    1   ELSE
      484    15570    1      VC$ = PINCRW (VC$, SIZEW(KL_LNKVC));

  15570  2 000036   000014 036003                    ADLQ    12,DU
         2 000037   100000 756100                    STQ     0,,PR1

      485    15571    2   IF VC$ >= DEV_STOP$ THEN DO;

  15571  2 000040   200012 116100                    CMPQ    DEV_STOP$,,AUTO
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:82   
         2 000041   000045 602000 2                  TNC     s:15575

      486    15572    2      VC$ = ADDR (NIL);

  15572  2 000042   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000043   100000 756100                    STQ     0,,PR1

      487    15573    2      ALTRETURN ;

  15573  2 000044   000000 702200 xent               TSX2  ! X66_AALT

      488    15574    2      END;  /*  VC$ >= DEV_STOP$  */
      489    15575    1   IF NAME.TEXT = '?' THEN

  15575  2 000045   200005 470500                    LDP0    @NAME,,AUTO
         2 000046   040000 106500                    CMPC    fill='040'O
         2 000047   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         2 000050   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000051   000055 601000 2                  TNZ     s:15578

      490    15576    1      ALL = %YES#;

  15576  2 000052   400000 236003                    LDQ     -131072,DU
         2 000053   200007 756100                    STQ     ALL,,AUTO
         2 000054   000145 710000 2                  TRA     s:15617

      491    15577    2   ELSE DO;

      492    15578    2      CALL INDEX (I, '?', NAME.TEXT)

  15578  2 000055   000000 124500                    SCM     mask='000'O
         2 000056   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         2 000057   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000060   200013 000100                    ARG     I,,AUTO
         2 000061   000120 606400 2                  TTN     s:15590

      493    15579    3      WHENRETURN DO;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:83   

      494    15580    3         WILD_CARD = %YES#;

  15580  2 000062   400000 236003                    LDQ     -131072,DU
         2 000063   200016 756100                    STQ     WILD_CARD,,AUTO

      495    15581    4         DO I = 0 TO 3;

  15581  2 000064   200013 450100                    STZ     I,,AUTO

      496    15582    4            IF SUBSTR(NAME.TEXT,I,1) = '?' THEN

  15582  2 000065   200005 470500                    LDP0    @NAME,,AUTO
         2 000066   200013 235100                    LDA     I,,AUTO
         2 000067   040000 106505                    CMPC    fill='040'O
         2 000070   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 000071   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000072   000077 601000 2                  TNZ     s:15585

      497    15583    4               SUBSTR (TEMPVC,I,1) = '0';

  15583  2 000073   040105 100400                    MLR     fill='040'O
         2 000074   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000075   200014 000001                    ADSC9   TEMPVC,A,AUTO            cn=0,n=1
         2 000076   000102 710000 2                  TRA     s:15586

      498    15584    4            ELSE
      499    15585    4               SUBSTR (TEMPVC,I,1) = SUBSTR(NAME.TEXT,I,1);

  15585  2 000077   040105 100505                    MLR     fill='040'O
         2 000100   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 000101   200014 000001                    ADSC9   TEMPVC,A,AUTO            cn=0,n=1

      500    15586    4            END;  /*  Do 0 to 3  */

  15586  2 000102   000001 035007                    ADLA    1,DL
         2 000103   200013 755100                    STA     I,,AUTO
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:84   
         2 000104   000004 115007                    CMPA    4,DL
         2 000105   000065 602000 2                  TNC     s:15582

      501    15587    3         CALL CHARBIN (VC#, SUBSTR(TEMPVC,0,NAME.COUNT));

  15587  2 000106   000100 101500                    MRL     fill='000'O
         2 000107   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000110   200020 000002                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=2
         2 000111   200020 220100                    LDX0    WILD_CARD+2,,AUTO
         2 000112   000100 305540                    DTB
         2 000113   200014 030010                    NDSC9   TEMPVC,,AUTO             cn=0,s=nosgn,sf=0,n=*X0
         2 000114   200022 000010                    NDSC9   WILD_CARD+4,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000115   200023 236100                    LDQ     WILD_CARD+5,,AUTO
         2 000116   200015 756100                    STQ     VC#,,AUTO

      502    15588    3         END; /*  Whenreturn  */

  15588  2 000117   000132 710000 2                  TRA     s:15592

      503    15589    3      WHENALTRETURN DO;

      504    15590    3         CALL CHARBIN( VC#, SUBSTR(NAME.TEXT,0,NAME.COUNT) );

  15590  2 000120   200005 470500                    LDP0    @NAME,,AUTO
         2 000121   000100 101500                    MRL     fill='000'O
         2 000122   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000123   200020 000002                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=2
         2 000124   200020 220100                    LDX0    WILD_CARD+2,,AUTO
         2 000125   000100 305540                    DTB
         2 000126   000000 230010                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
         2 000127   200022 000010                    NDSC9   WILD_CARD+4,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000130   200023 235100                    LDA     WILD_CARD+5,,AUTO
         2 000131   200015 755100                    STA     VC#,,AUTO

      505    15591    3         END; /*  Whenaltreturn  */

      506    15592    3      IF VC# > 4095 THEN DO;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:85   

  15592  2 000132   200015 235100                    LDA     VC#,,AUTO
         2 000133   010000 115007                    CMPA    4096,DL
         2 000134   000145 602000 2                  TNC     s:15617

      507    15593        /*E*  ERROR:  ASL-E$BAD_VC_NUM-C
      508    15594              MESSAGE: Illegal VIRCIR number.
      509    15595              MESSAGE1: A VIRCIR number must be between 0 and 4095.
      510    15596        */
      511    15597              %SCREAM( ERR#=E$BAD_VC_NUM, LEVEL=ERROR, MID='L' );

  15609  2 000135   000002 630400 3                  EPPR0   2
         2 000136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000137   000000 701000 xent               TSX1    ASH$ERROR
         2 000140   000000 011000                    NOP     0

      512    15612    3         VC$ = ADDR (NIL);

  15612  2 000141   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000142   200006 470500                    LDP0    @VC$,,AUTO
         2 000143   000000 756100                    STQ     0,,PR0

      513    15613    3         ALTRETURN;

  15613  2 000144   000000 702200 xent               TSX2  ! X66_AALT

      514    15614    3         END;   /*  Bad vircir number  */
      515    15615    2      END;  /*  Whenaltreturn  */
      516    15616                                                  /* Find controller info. */
      517    15617    2   DO WHILE VC$ < DEV_STOP$;

  15617  2 000145   200006 471500                    LDP1    @VC$,,AUTO
         2 000146   100000 236100                    LDQ     0,,PR1
         2 000147   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000150   000227 603000 2                  TRC     s:15632

      518    15618    3      IF KL$LNKVC.BLKHDR.BLKTYP = %KLTY_VIRCIR# THEN DO;
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:86   

  15618  2 000151   200006 470500                    LDP0    @VC$,,AUTO
         2 000152   000000 471500                    LDP1    0,,PR0
         2 000153   100001 236100                    LDQ     1,,PR1
         2 000154   777000 376003                    ANQ     -512,DU
         2 000155   010000 116003                    CMPQ    4096,DU
         2 000156   000222 601000 2                  TNZ     s:15630

      519    15619    4         IF WILD_CARD THEN DO;

  15619  2 000157   200016 234100                    SZN     WILD_CARD,,AUTO
         2 000160   000205 605000 2                  TPL     s:15623

      520    15620    4            CALL BINCHAR (TEMPVC, KL$LNKVC.VIRCIR#);

  15620  2 000161   100012 236100                    LDQ     10,,PR1
         2 000162   777777 376007                    ANQ     -1,DL
         2 000163   000000 235003                    LDA     0,DU
         2 000164   200020 757100                    STAQ    WILD_CARD+2,,AUTO
         2 000165   000100 301500                    BTD
         2 000166   200020 000010                    NDSC9   WILD_CARD+2,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000167   200014 030002                    NDSC9   TEMPVC,,AUTO             cn=0,s=nosgn,sf=0,n=2

      521    15621    4            CALL ASB$WILD_MATCH (4, TEMPVC, 4, NAME.TEXT) ALTRET (LOOP_END);

  15621  2 000170   200005 236100                    LDQ     @NAME,,AUTO
         2 000171   200000 036007                    ADLQ    65536,DL
         2 000172   000003 235000 3                  LDA     3
         2 000173   200022 757100                    STAQ    WILD_CARD+4,,AUTO
         2 000174   200014 631500                    EPPR1   TEMPVC,,AUTO
         2 000175   200021 451500                    STP1    WILD_CARD+3,,AUTO
         2 000176   000003 236000 3                  LDQ     3
         2 000177   200020 756100                    STQ     WILD_CARD+2,,AUTO
         2 000200   200020 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000201   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000202   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000203   000215 702000 2                  TSX2    LOOP_END
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:87   

      522    15622    4            END;   /*  If WILD_CARD  */

  15622  2 000204   000214 710000 2                  TRA     s:15625

      523    15623    3         ELSE IF NOT WILD_CARD AND NOT ALL THEN

  15623  2 000205   000214 604000 2                  TMI     s:15625
         2 000206   200007 234100                    SZN     ALL,,AUTO
         2 000207   000214 604000 2                  TMI     s:15625

      524    15624    3               IF KL$LNKVC.VIRCIR# ~= VC# THEN GOTO LOOP_END;

  15624  2 000210   100012 236100                    LDQ     10,,PR1
         2 000211   777777 376007                    ANQ     -1,DL
         2 000212   200015 116100                    CMPQ    VC#,,AUTO
         2 000213   000215 601000 2                  TNZ     LOOP_END

      525    15625    3         RETURN ;

  15625  2 000214   000000 702200 xent               TSX2  ! X66_ARET

      526    15626    3   LOOP_END:
      527    15627    3         VC$ = PINCRW (VC$, SIZEW (KL_LNKVC));

  15627  2 000215   200006 470500       LOOP_END     LDP0    @VC$,,AUTO
         2 000216   000000 236100                    LDQ     0,,PR0
         2 000217   000014 036003                    ADLQ    12,DU
         2 000220   000000 756100                    STQ     0,,PR0

      528    15628    3         END;  /*  Vircir  */

  15628  2 000221   000225 710000 2                  TRA     s:15631

      529    15629    2      ELSE
      530    15630    2         VC$ = PINCRW (VC$, SIZEW (KL_LINKDEV));

PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:88   
  15630  2 000222   000000 236100                    LDQ     0,,PR0
         2 000223   000006 036003                    ADLQ    6,DU
         2 000224   000000 756100                    STQ     0,,PR0

      531    15631    2      END; /*  Do while VC$ < DEV_STOP$  */

  15631  2 000225   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000226   000151 602000 2                  TNC     s:15618

      532    15632    1   VC$ = ADDR(NIL);

  15632  2 000227   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000230   200006 470500                    LDP0    @VC$,,AUTO
         2 000231   000000 756100                    STQ     0,,PR0

      533    15633    1   ALTRETURN ;

  15633  2 000232   000000 702200 xent               TSX2  ! X66_AALT
      534    15634    1   END ASL$FIND_VIRCIR;
      535    15635        %EOD;

PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:89   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_VIRCIR.
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:90   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$FIND_VIRCIR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/c STRC(216)   r     1 KL_LINKDEV                 0-0-0/w STRC(432)   r     1 KL_LNKVC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LINK$                     5-0-0/w PTR         r     1 @NAME
     4-0-0/w PTR         r     1 @SIZE                      6-0-0/w PTR         r     1 @VC$
     7-0-0/b BIT         r     1 ALL                       10-0-0/w SBIN        r     1 DEV_SIZEW
    11-0-0/w PTR         r     1 DEV_START$                12-0-0/w PTR         r     1 DEV_STOP$
    13-0-0/w UBIN        r     1 I                         *0-0-0/w PTR         r     1 LINK$
    *0-0-0/c STRC(45)    r     1 NAME                      *0-0-0/w UBIN        r     1 SIZE
    14-0-0/c CHAR(2)     r     1 TEMPVC                    15-0-0/w UBIN        r     1 VC#
    *0-0-0/w PTR         r     1 VC$                       16-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DSEG1$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KL$LNKVC                   0-0-0/w STRC(1008)  r     1 LINK$DREC
     0-0-0/w ASTR(9)     r     1 TEXT$C
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:91   


   Procedure ASL$FIND_VIRCIR requires 155 words for executable code.
   Procedure ASL$FIND_VIRCIR requires 20 words of local(AUTO) storage.
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:92   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:93   
          MINI XREF LISTING

ALL
     15153**DCL     15565<<ASSIGN  15576<<ASSIGN  15623>>IF
ASA_BRKS_LOC
     11705**DCL     11705--REDEF
ASB$WILD_MATCH
     14573**DCL-ENT 15621--CALL
ASH$ERROR
     14570**DCL-ENT 15609--CALL
AS_DEFAULT.BANNER_PERM
     12398**DCL     12399--REDEF
AS_DEFAULT.BUDGET.MACCT
     12303**DCL     12307--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12316**DCL     12319--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12299**DCL     12301--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12294**DCL     12296--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12414**DCL     12415--REDEF   12416--REDEF
AS_DEFAULT_DREC.PASSWORD
     13668**DCL     13672--REDEF
AS_DEFAULT_DREC.RENAME
     13691**DCL     13692--REDEF
AS_DFLT.BANNER_PERM
     12220**DCL     12221--REDEF
AS_DFLT.BUDGET.MACCT
     12125**DCL     12129--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12138**DCL     12141--REDEF
AS_DFLT.BUDGET.PACCUM
     12121**DCL     12123--REDEF
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:94   
AS_DFLT.BUDGET.PMAXC
     12116**DCL     12118--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12236**DCL     12237--REDEF   12238--REDEF
AS_FE_MODE
     11571**DCL     11572--REDEF
AS_MODE
     11568**DCL     11570--REDEF
AS_MOD_USER.ACCESS
     14433**DCL     14434--REDEF
AS_MOD_USER.BANNER
     14420**DCL     14421--REDEF
AS_MOD_USER.BANNER_PERM
     14422**DCL     14423--REDEF
AS_MOD_USER.BILL
     14428**DCL     14429--REDEF
AS_MOD_USER.CPROC
     14424**DCL     14425--REDEF
AS_MOD_USER.FEBILL
     14504**DCL     14505--REDEF
AS_MOD_USER.FECXTMEM
     14521**DCL     14522--REDEF
AS_MOD_USER.FEMINTS
     14506**DCL     14507--REDEF
AS_MOD_USER.FEMMEM
     14517**DCL     14518--REDEF
AS_MOD_USER.FEMTIME
     14515**DCL     14516--REDEF
AS_MOD_USER.FEPPRIV
     14512**DCL     14514--REDEF
AS_MOD_USER.FEPRIV
     14509**DCL     14511--REDEF
AS_MOD_USER.FORCE_BIT
     14418**DCL     14419--REDEF
AS_MOD_USER.KEY
     14500**DCL     14502--REDEF
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:95   
AS_MOD_USER.LASTCPROC
     14426**DCL     14427--REDEF
AS_MOD_USER.LIMITS.DO_
     14474**DCL     14475--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14490**DCL     14491--REDEF
AS_MOD_USER.LIMITS.LO
     14470**DCL     14471--REDEF
AS_MOD_USER.LIMITS.MEM
     14466**DCL     14467--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14494**DCL     14495--REDEF
AS_MOD_USER.LIMITS.PDIS
     14482**DCL     14483--REDEF
AS_MOD_USER.LIMITS.PO
     14478**DCL     14479--REDEF
AS_MOD_USER.LIMITS.TDIS
     14486**DCL     14487--REDEF
AS_MOD_USER.LIMITS.TIME
     14462**DCL     14463--REDEF
AS_MOD_USER.MAXENQ
     14443**DCL     14444--REDEF
AS_MOD_USER.PERM_BIT
     14416**DCL     14417--REDEF
AS_MOD_USER.PPRIV
     14438**DCL     14440--REDEF
AS_MOD_USER.PRIOB
     14445**DCL     14446--REDEF
AS_MOD_USER.PRIV
     14435**DCL     14437--REDEF
AS_MOD_USER.QUAN
     14441**DCL     14442--REDEF
AS_MOD_USER.SETUP
     14414**DCL     14415--REDEF
AS_PROJECT.BANNER_PERM
     12754**DCL     12755--REDEF
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:96   
AS_PROJECT.BUDGET.MACCT
     12659**DCL     12663--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12672**DCL     12675--REDEF
AS_PROJECT.BUDGET.PACCUM
     12655**DCL     12657--REDEF
AS_PROJECT.BUDGET.PMAXC
     12650**DCL     12652--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12770**DCL     12771--REDEF   12772--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12932**DCL     12933--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12837**DCL     12841--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12850**DCL     12853--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12833**DCL     12835--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12828**DCL     12830--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12948**DCL     12949--REDEF   12950--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14154**DCL     14158--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14177**DCL     14178--REDEF
AS_PROJECT_DREC.PASSWORD
     13992**DCL     13996--REDEF
AS_PROJECT_DREC.RENAME
     14015**DCL     14016--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12576**DCL     12577--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12481**DCL     12485--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12494**DCL     12497--REDEF
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:97   
AS_PROJ_ADMIN.BUDGET.PACCUM
     12477**DCL     12479--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12472**DCL     12474--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12592**DCL     12593--REDEF   12594--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13830**DCL     13834--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13853**DCL     13854--REDEF
AS_USERS.BANNER_PERM
     12042**DCL     12043--REDEF
AS_USERS.BUDGET.MACCT
     11947**DCL     11951--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11960**DCL     11963--REDEF
AS_USERS.BUDGET.PACCUM
     11943**DCL     11945--REDEF
AS_USERS.BUDGET.PMAXC
     11938**DCL     11940--REDEF
AS_USERS.SETUP_CHRA.TXT
     12058**DCL     12059--REDEF   12060--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13110**DCL     13111--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13015**DCL     13019--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13028**DCL     13031--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13011**DCL     13013--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13006**DCL     13008--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13126**DCL     13127--REDEF   13128--REDEF
DEV_SIZEW
     15154**DCL     15563<<ASSIGN  15564>>ASSIGN
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:98   
DEV_START$
     15155**DCL     15562<<ASSIGN  15563>>ASSIGN  15564>>ASSIGN  15568>>ASSIGN
DEV_STOP$
     15156**DCL     15564<<ASSIGN  15571>>IF      15617>>DOWHILE
DSEG1$
     11706**DCL     14596--IMP-PTR 15562>>ASSIGN  15563>>ASSIGN  15563>>ASSIGN
ERR_CODE
     11700**DCL     11701--REDEF
I
     15157**DCL     15578<<CALLBLT 15581<<DOINDEX 15582>>IF      15583>>ASSIGN  15585>>ASSIGN  15585>>ASSIGN
KL$LNKVC.BLKHDR.BLKTYP
     14987**DCL     15618>>IF
KL$LNKVC.CUG
     15040**DCL     15084--REDEF
KL$LNKVC.VIRCIR#
     15132**DCL     15620>>CALLBLT 15624>>IF
KL_DEFAULT.PASSWORD
     14316**DCL     14320--REDEF
KL_DEFAULT.RENAME
     14339**DCL     14340--REDEF
KL_DFLT.PASSWORD
     13506**DCL     13510--REDEF
KL_DFLT.RENAME
     13529**DCL     13530--REDEF
KL_DREC.PASSWORD
     13344**DCL     13348--REDEF
KL_DREC.RENAME
     13367**DCL     13368--REDEF
KL_DREC_CNT.PASSWORD
     13231**DCL     13235--REDEF
KL_DREC_CNT.RENAME
     13254**DCL     13255--REDEF
KL_LINKDEV
     15405**DCL     15630--ASSIGN
KL_LNKVC
     15179**DCL     15570--ASSIGN  15627--ASSIGN
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:99   
KL_LNKVC.CUG
     15278**DCL     15322--REDEF
LINK$
     14560**DCL        10--PROC    15567>>IF
LINK$DREC.LNK
     14718**DCL     15562--ASSIGN  15562--ASSIGN  15563--ASSIGN
LINK$DREC.NWINFO
     14694**DCL     15563>>ASSIGN
LINK$DREC.PASSWORD
     14654**DCL     14658--REDEF
LINK$DREC.RENAME
     14677**DCL     14678--REDEF
LOOP_END
     15627**LABEL   15621--CALLALT 15624--GOTO
NAME
     14561**DCL        10--PROC
NAME.COUNT
     14562**DCL     15587>>CALLBLT 15590>>CALLBLT
NAME.TEXT
     14563**DCL     15575>>IF      15578>>CALLBLT 15582>>IF      15585>>ASSIGN  15590>>CALLBLT 15621<>CALL
PROJ_KEY.TEXT
     11578**DCL     11578--REDEF
PROJ_KEY.TXT.PROJECT
     11578**DCL     11578--REDEF
REMEM_VAR
     11704**DCL     11704--REDEF
REM_FCMD
     11704**DCL     11705--REDEF
SIZE
     14564**DCL        10--PROC
TEMPVC
     15158**DCL     15583<<ASSIGN  15585<<ASSIGN  15587>>CALLBLT 15620<<CALLBLT 15621<>CALL
TEXT$C.CNT
     14579**DCL     14580--IMP-SIZ
USERS_KEY.TEXT
     11575**DCL     11576--REDEF   11576--REDEF   11576--REDEF   11577--REDEF
PL6.E3A0      #002=ASL$FIND_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI                 TUE 07/29/97 10:26 Page:100  
VC#
     15159**DCL     15587<<CALLBLT 15590<<CALLBLT 15592>>IF      15624>>IF
VC$
     14565**DCL        10--PROC    14941--IMP-PTR 15567>>IF      15568<<ASSIGN  15570<<ASSIGN  15570>>ASSIGN
     15571>>IF      15572<<ASSIGN  15612<<ASSIGN  15617>>DOWHILE 15618>>IF      15620>>CALLBLT 15624>>IF
     15627<<ASSIGN  15627>>ASSIGN  15630<<ASSIGN  15630>>ASSIGN  15632<<ASSIGN
WILD_CARD
     15160**DCL     15566<<ASSIGN  15580<<ASSIGN  15619>>IF      15623>>IF

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:101  
      536        1        /*T***********************************************************/
      537        2        /*T*                                                         */
      538        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      539        4        /*T*                                                         */
      540        5        /*T***********************************************************/
      541        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:102  
      542        7        ASL$DISP_ONE_VIRCIR: PROC (VIRCIR$, NEW_LINK, JCL, LINK_NAME);
      543        8        /**********************************************************/
      544        9
      545       10        /*D* NAME:     ASL$DISP_ONE_VIRCIR
      546       11             CALL:     CALL ASL$DISP_ONE_VIRCIR ( VIRCIR$, NEW_LINK, JCL, LINK_NAME)
      547       12             INPUT:    VIRCIR$ - Pointer to a kl_controller structure.
      548       13                       NEW_LINK - bit set for header display.
      549       14                       JCL    - bit set for JCL type display.
      550       15                       LINK_NAME - The name of the link the current vircir
      551       16                                   belongs to.
      552       17             OUTPUT:   Nothing is returned.
      553       18             DESCRIPTION:  ASL$DISP_ONE_VIRCIR is the routine to handle
      554       19                           the list/display of a vircir pointed at by
      555       20                           VIRCIR$.  The output from this routine will
      556       21                           depend upon the setting of the JCL flag.
      557       22        */
      558       23        /********************************************************************/
      559       24        /*   Include files   include files   include files   include files  */
      560       25        /********************************************************************/
      561       26        %INCLUDE AS_PERR_C;
      562      628        %INCLUDE AS_SUPER_C;
      563     1063        %INCLUDE AS_SUBS_C;
      564     2477        %INCLUDE AS_MAC_C;
      565     2557        %INCLUDE AS_ENTRIES_M;
      566     3607        %INCLUDE AS_SSUBS_C;
      567     3699        %INCLUDE B_ERRORS_C;
      568     4826        %INCLUDE KL_SUPER_C;
      569     7728        %INCLUDE XU_MACRO_C;
      570    10834        %INCLUDE XU_FORMAT_C;
      571    10996        %INCLUDE AS_SUPER_R;
      572    14012        /********************************************************************/
      573    14013        /*   Parameters      parameters      parameters      parameters     */
      574    14014        /********************************************************************/
      575    14015    1   DCL LINK_NAME                CHAR(8);
      576    14016    1   DCL JCL                      BIT(1);
      577    14017    1   DCL NEW_LINK                 BIT(1);
      578    14018    1   DCL VIRCIR$                  PTR;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:103  
      579    14019        /********************************************************************/
      580    14020        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      581    14021        /********************************************************************/
      582    14022    1   DCL X$FORMAT ENTRY(1) ;
      583    14023        %ASB$WRITE_LO ;
      584    14026        /********************************************************************/
      585    14027        /*   Local based     local based     local based     local based    */
      586    14028        /********************************************************************/
      587    14029        %KL_DREC      ( NAME       = LINK$DREC,
      588    14030                        STCLASS    = "BASED(DSEG1$)",
      589    14031                        LAST       = ",");
      590    14144        %KL_LNK       ( NAME       = LNK,
      591    14145                        LVL        = 2,
      592    14146                        STCLASS    = BASED,
      593    14147                        LAST       = ";");
      594    14371        %KL_LNKVC     ( NAME       = KL$LNKVC,
      595    14372                        LVL        = 1,
      596    14373                        LAST       = ";",
      597    14374                        STCLASS    = "BASED( VIRCIR$ )" );
      598    14598        %KL$UBWORD    ( NAME       = KL_UBWORD, STCLASS  =  AUTO );
      599    14608    1   DCL 1 TEXT$C BASED ALIGNED,
      600    14609    1          2 CNT                 UBIN(9) UNAL ,
      601    14610    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      602    14611        /********************************************************************/
      603    14612        /*   Auto data       auto data       auto data       auto data      */
      604    14613        /********************************************************************/
      605    14614    1   DCL ADDRESS(0:13)            CHAR(1) ;
      606    14615    1   DCL ADDR1(0:3)               CHAR(1) ;
      607    14616    1   DCL J                        SBIN WORD ;
      608    14617    1   DCL TEMP_NUMB                UBIN STATIC;
      609    14618    1   DCL VAL                      SBIN ;
      610    14619        /********************************************************************/
      611    14620        /*   Constant data   constant data   constant data   constant data  */
      612    14621        /********************************************************************/
      613    14622    1   DCL ADDRESS_JCL_FMT          CHAR(0) CONSTANT INIT
      614    14623    1         ('%3-ADDRESS = %>A');
      615    14624    1   DCL BL_STR                         CHAR(0) CONSTANT INIT (' ');
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:104  
      616    14625    1   DCL CUG_JCL_FMT              CHAR(0) CONSTANT INIT
      617    14626    1         ('%3-CUG = %A');
      618    14627    1   DCL DEST_JCL_FMT             CHAR(0) CONSTANT INIT
      619    14628    1         ('%3-DESTINATION = %>A');
      620    14629    1   DCL IS_STR                         CHAR(0) CONSTANT INIT ('IS');
      621    14630        %KL_LNKVC   ( LVL = 1, STCLASS = CONSTANT );
      622    14854    1   DCL PERMANENT_STR            CHAR(0) CONSTANT INIT ('PERMANENT');
      623    14855    1   DCL PERM_FMT                 CHAR(0) CONSTANT INIT
      624    14856    1   ('%61-%A');
      625    14857    1   DCL PERM_JCL_FMT             CHAR(0) CONSTANT INIT
      626    14858    1         ('%3-PERMANENT = %1.N[YES%0?NO%]');
      627    14859    1   DCL PROFILE_JCL_FMT          CHAR(0) CONSTANT INIT
      628    14860    1         ('%3-PROFILE = %>A');
      629    14861    1   DCL QOS_JCL_FMT              CHAR(0) CONSTANT INIT
      630    14862    1         ('%3-QOS = %D');
      631    14863    1   DCL VIRCIR_FMT               CHAR(0) CONSTANT INIT
      632    14864    1   ('%4-%D%12-%A%24-%A%30-%A%40-%A%57-%3D');
      633    14865    1   DCL VIRCIR_HDR               CHAR(0) CONSTANT INIT
      634    14866    1   ('  CIRCUIT  PROFILE     CUG   DEST      ADDRESS          QOS' ) ;
      635    14867    1   DCL VIRCIR_JCL_CMD           CHAR(0) CONSTANT INIT
      636    14868    1         ('CREATE VIRCIR %D FOR LINK %>A');
      637    14869        /********************************************************************/
      638    14870        /*   Procedure       procedure       procedure       procedure      */
      639    14871        /********************************************************************/
      640    14872    2   IF NOT JCL THEN DO;
      641    14873                                                  /* List virtual circuit info. */
      642    14874    3      IF NEW_LINK THEN DO;
      643    14875    3         CALL ASB$WRITE_LO( AS_BLANK, 1 );
      644    14876    3         CALL ASB$WRITE_LO( VIRCIR_HDR, LENGTHC(VIRCIR_HDR) );
      645    14877    3         END; /* New link  */
      646    14878    2      FMT_BUF = VIRCIR_FMT;
      647    14879    2      FDS.FMT_.BOUND = SIZEV(VIRCIR_FMT);
      648    14880    2      FDS.NVECS# = 6;
      649    14881    2      TEMP_NUMB = VIRCIR$->KL$LNKVC.VIRCIR# ;
      650    14882    2      FMT_VEC(0) = VECTOR( TEMP_NUMB );
      651    14883    2      FMT_VEC(1) = VECTOR( ADDR(VIRCIR$->KL$LNKVC.PRONM) -> TEXT$C.TEXT) ;
      652    14884    2      FMT_VEC(2) = VECTOR( ADDR1 ) ;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:105  
      653    14885    3      IF VIRCIR$ -> KL$LNKVC.CUG.LNG# = 2 THEN DO;  /*  Means 4 digits  */
      654    14886    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD1# ;
      655    14887    3         CALL BINCHAR( ADDR1(0), VAL ) ;
      656    14888    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD2# ;
      657    14889    3         CALL BINCHAR( ADDR1(1), VAL ) ;
      658    14890    3         END;  /*  LNG# = 2  */
      659    14891    3      ELSE DO;
      660    14892    3         ADDR1(0) = ' ';
      661    14893    3         ADDR1(1) = ' ';
      662    14894    3         END;  /*  LNG# ~= 2  */
      663    14895    3      IF VIRCIR$ -> KL$LNKVC.CUG.LNG# > 0 THEN DO;  /*  Means at least 2 digits  */
      664    14896    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD3# ;
      665    14897    3         CALL BINCHAR( ADDR1(2), VAL ) ;
      666    14898    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD4# ;
      667    14899    3         CALL BINCHAR( ADDR1(3), VAL ) ;
      668    14900    3         END;  /*  LNG# = 1 or LNG# = 2  */
      669    14901    3      ELSE DO;
      670    14902    3         ADDR1(2) = ' ';
      671    14903    3         ADDR1(3) = ' ';
      672    14904    3         END;  /*  LNG# = 0  */
      673    14905    2      FMT_VEC(3) = VECTOR( VIRCIR$->KL$LNKVC.DST# ) ;
      674    14906    2      FMT_VEC(4) = VECTOR( ADDRESS ) ;
      675    14907    3      DO J = 0 TO 6 ;
      676    14908    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD1#(J);
      677    14909    3         CALL BINCHAR ( ADDRESS( J*2 ), VAL ) ;
      678    14910    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD2#(J);
      679    14911    3         CALL BINCHAR ( ADDRESS( J*2+1 ), VAL ) ;
      680    14912    3         END ;  /*  Do j  */
      681    14913    3      DO J = VIRCIR$->KL$LNKVC.ADR.LNG# TO 14;
      682    14914    3         ADDRESS (J) = ' ';
      683    14915    3         END;  /*  Do j  */
      684    14916    2      FMT_VEC(5) = VECTOR (KL$LNKVC.QOS#);
      685    14917    2      IF VIRCIR$->KL$LNKVC.PERMANENT THEN
      686    14918    3      DO;
      687    14919    4         IF NEW_LINK THEN DO;
      688    14920    4            CALL CONCAT (FMT_BUF,VIRCIR_FMT,PERM_FMT);
      689    14921    4            FDS.FMT_.BOUND = SIZEC(VIRCIR_FMT) + SIZEC (PERM_FMT) - 1;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:106  
      690    14922    4            END;  /* New link  */
      691    14923    3         FMT_VEC(6) = VECTOR (PERMANENT_STR);
      692    14924    3         FDS.NVECS# = 7;
      693    14925    3         END;  /*  Permanent  */
      694    14926    2      CALL X$FORMAT( FDS );
      695    14927    2      END;  /*  Not jcl  */
      696    14928    2   ELSE DO;  /*  Jcl  */
      697    14929    2      FMT_BUF = VIRCIR_JCL_CMD;
      698    14930    2      FDS.FMT_.BOUND = SIZEV(VIRCIR_JCL_CMD);
      699    14931    2      FDS.NVECS# = 2;
      700    14932    2      TEMP_NUMB = VIRCIR$->KL$LNKVC.VIRCIR# ;
      701    14933    2      FMT_VEC(0) = VECTOR( TEMP_NUMB );
      702    14934    2      FMT_VEC(1) = VECTOR( LINK_NAME );
      703    14935    2      CALL X$FORMAT( FDS );
      704    14936    2      FMT_BUF = PROFILE_JCL_FMT;
      705    14937    2      FDS.FMT_.BOUND = SIZEV(PROFILE_JCL_FMT);
      706    14938    2      FDS.NVECS# = 1;
      707    14939    2      FMT_VEC(0) = VECTOR( ADDR(VIRCIR$->KL$LNKVC.PRONM) -> TEXT$C.TEXT) ;
      708    14940    2      CALL X$FORMAT( FDS );
      709    14941    3      IF VIRCIR$->KL$LNKVC.CUG.LNG# > 0 THEN DO;
      710    14942    3         ADDR1 (0)  = ' ';
      711    14943    3         ADDR1 (1)  = ' ';
      712    14944    3         ADDR1 (2)  = ' ';
      713    14945    3         ADDR1 (3)  = ' ';
      714    14946    3         FMT_BUF = CUG_JCL_FMT;
      715    14947    3         FDS.FMT_.BOUND = SIZEV(CUG_JCL_FMT);
      716    14948    3         FMT_VEC(0) = VECTOR( ADDR1 ) ;
      717    14949    4         IF VIRCIR$ -> KL$LNKVC.CUG.LNG# = 2 THEN DO;  /*  Means 4 digits  */
      718    14950    4            VAL = VIRCIR$->KL$LNKVC.CUG.BCD1# ;
      719    14951    4            CALL BINCHAR( ADDR1(0), VAL ) ;
      720    14952    4            VAL = VIRCIR$->KL$LNKVC.CUG.BCD2# ;
      721    14953    4            CALL BINCHAR( ADDR1(1), VAL ) ;
      722    14954    4            END;  /*  LNG# = 2  */
      723    14955    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD3# ;
      724    14956    3         CALL BINCHAR( ADDR1(2), VAL ) ;
      725    14957    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD4# ;
      726    14958    3         CALL BINCHAR( ADDR1(3), VAL ) ;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:107  
      727    14959    3         CALL X$FORMAT( FDS );
      728    14960    3         END;  /*  CUG.LNG# > 0  */
      729    14961    2      FMT_BUF = DEST_JCL_FMT;
      730    14962    2      FDS.FMT_.BOUND = SIZEV(DEST_JCL_FMT);
      731    14963    2      IF VIRCIR$->KL$LNKVC.NODE# = 254 THEN
      732    14964    2         FMT_VEC(0) = VECTOR( BL_STR ) ;
      733    14965    2      ELSE IF VIRCIR$->KL$LNKVC.NODE# = 253 THEN
      734    14966    2            FMT_VEC(0) = VECTOR( IS_STR ) ;
      735    14967    2         ELSE
      736    14968    2            FMT_VEC(0) = VECTOR( VIRCIR$->KL$LNKVC.DST# ) ;
      737    14969    2      CALL X$FORMAT( FDS );
      738    14970    2      FMT_BUF = ADDRESS_JCL_FMT;
      739    14971    2      FDS.FMT_.BOUND = SIZEV(ADDRESS_JCL_FMT);
      740    14972    2      FMT_VEC(0) = VECTOR( ADDRESS ) ;
      741    14973    3      DO J = 0 TO 6 ;
      742    14974    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD1#(J);
      743    14975    3         CALL BINCHAR ( ADDRESS( J*2 ), VAL ) ;
      744    14976    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD2#(J);
      745    14977    3         CALL BINCHAR ( ADDRESS( J*2+1 ), VAL ) ;
      746    14978    3         END ;  /*  Do j  */
      747    14979    3      DO J = VIRCIR$->KL$LNKVC.ADR.LNG# TO 14;
      748    14980    3         ADDRESS (J) = ' ';
      749    14981    3         END;  /*  Do j  */
      750    14982    2      CALL X$FORMAT( FDS );
      751    14983    2      FMT_BUF = QOS_JCL_FMT;
      752    14984    2      FDS.FMT_.BOUND = SIZEV(QOS_JCL_FMT);
      753    14985    2      FMT_VEC(0) = VECTOR (KL$LNKVC.QOS#);
      754    14986    2      CALL X$FORMAT( FDS );
      755    14987    2      FMT_BUF = PERM_JCL_FMT;
      756    14988    2      FDS.FMT_.BOUND = SIZEV(PERM_JCL_FMT);
      757    14989    2      TEMP_NUMB = BITBIN ( VIRCIR$->KL$LNKVC.PERMANENT );
      758    14990    2      FMT_VEC(0) = VECTOR ( TEMP_NUMB );
      759    14991    2      CALL X$FORMAT( FDS );
      760    14992    2      CALL ASB$WRITE_LO ('   END',6);
      761    14993    2      END;   /*  Jcl  */
      762    14994    1   FDS.NVECS# = 0; /* reset # vectors to format structure */
      763    14995    1   RETURN;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:108  
      764    14996
      765    14997    1   END ASL$DISP_ONE_VIRCIR;

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:109  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_VIRCIR.

   Procedure ASL$DISP_ONE_VIRCIR requires 456 words for executable code.
   Procedure ASL$DISP_ONE_VIRCIR requires 18 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_VIRCIRS.:E05TSI    .

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:110  

 Object Unit name= ASL$DISP_ONE_VIRCIR                        File name= ASL$LIST_VIRCIRS.:E05TOU
 UTS= JUL 29 '97 10:28:38.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   Data  even  none     1      1  ASL$DISP_ONE_VIRCIR
    2  RoData even  UTS     80    120  ASL$DISP_ONE_VIRCIR
    3   Proc  even  none   456    710  ASL$DISP_ONE_VIRCIR
    4  RoData even  none    24     30  ASL$DISP_ONE_VIRCIR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        4  ASL$DISP_ONE_VIRCIR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:111  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  FDS                                   FMT_BUF
     FMT_VEC                               ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:112  


      536        1        /*T***********************************************************/
      537        2        /*T*                                                         */
      538        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      539        4        /*T*                                                         */
      540        5        /*T***********************************************************/
      541        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:113  
      542        7        ASL$DISP_ONE_VIRCIR: PROC (VIRCIR$, NEW_LINK, JCL, LINK_NAME);

      7  3 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_4
         3 000001   000022 000004                    ZERO    18,4

      543        8        /**********************************************************/
      544        9
      545       10        /*D* NAME:     ASL$DISP_ONE_VIRCIR
      546       11             CALL:     CALL ASL$DISP_ONE_VIRCIR ( VIRCIR$, NEW_LINK, JCL, LINK_NAME)
      547       12             INPUT:    VIRCIR$ - Pointer to a kl_controller structure.
      548       13                       NEW_LINK - bit set for header display.
      549       14                       JCL    - bit set for JCL type display.
      550       15                       LINK_NAME - The name of the link the current vircir
      551       16                                   belongs to.
      552       17             OUTPUT:   Nothing is returned.
      553       18             DESCRIPTION:  ASL$DISP_ONE_VIRCIR is the routine to handle
      554       19                           the list/display of a vircir pointed at by
      555       20                           VIRCIR$.  The output from this routine will
      556       21                           depend upon the setting of the JCL flag.
      557       22        */
      558       23        /********************************************************************/
      559       24        /*   Include files   include files   include files   include files  */
      560       25        /********************************************************************/
      561       26        %INCLUDE AS_PERR_C;
      562      628        %INCLUDE AS_SUPER_C;
      563     1063        %INCLUDE AS_SUBS_C;
      564     2477        %INCLUDE AS_MAC_C;
      565     2557        %INCLUDE AS_ENTRIES_M;
      566     3607        %INCLUDE AS_SSUBS_C;
      567     3699        %INCLUDE B_ERRORS_C;
      568     4826        %INCLUDE KL_SUPER_C;
      569     7728        %INCLUDE XU_MACRO_C;
      570    10834        %INCLUDE XU_FORMAT_C;
      571    10996        %INCLUDE AS_SUPER_R;
      572    14012        /********************************************************************/
      573    14013        /*   Parameters      parameters      parameters      parameters     */
      574    14014        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:114  
      575    14015    1   DCL LINK_NAME                CHAR(8);
      576    14016    1   DCL JCL                      BIT(1);
      577    14017    1   DCL NEW_LINK                 BIT(1);
      578    14018    1   DCL VIRCIR$                  PTR;
      579    14019        /********************************************************************/
      580    14020        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      581    14021        /********************************************************************/
      582    14022    1   DCL X$FORMAT ENTRY(1) ;
      583    14023        %ASB$WRITE_LO ;
      584    14026        /********************************************************************/
      585    14027        /*   Local based     local based     local based     local based    */
      586    14028        /********************************************************************/
      587    14029        %KL_DREC      ( NAME       = LINK$DREC,
      588    14030                        STCLASS    = "BASED(DSEG1$)",
      589    14031                        LAST       = ",");
      590    14144        %KL_LNK       ( NAME       = LNK,
      591    14145                        LVL        = 2,
      592    14146                        STCLASS    = BASED,
      593    14147                        LAST       = ";");
      594    14371        %KL_LNKVC     ( NAME       = KL$LNKVC,
      595    14372                        LVL        = 1,
      596    14373                        LAST       = ";",
      597    14374                        STCLASS    = "BASED( VIRCIR$ )" );
      598    14598        %KL$UBWORD    ( NAME       = KL_UBWORD, STCLASS  =  AUTO );
      599    14608    1   DCL 1 TEXT$C BASED ALIGNED,
      600    14609    1          2 CNT                 UBIN(9) UNAL ,
      601    14610    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      602    14611        /********************************************************************/
      603    14612        /*   Auto data       auto data       auto data       auto data      */
      604    14613        /********************************************************************/
      605    14614    1   DCL ADDRESS(0:13)            CHAR(1) ;
      606    14615    1   DCL ADDR1(0:3)               CHAR(1) ;
      607    14616    1   DCL J                        SBIN WORD ;
      608    14617    1   DCL TEMP_NUMB                UBIN STATIC;
      609    14618    1   DCL VAL                      SBIN ;
      610    14619        /********************************************************************/
      611    14620        /*   Constant data   constant data   constant data   constant data  */
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:115  
      612    14621        /********************************************************************/
      613    14622    1   DCL ADDRESS_JCL_FMT          CHAR(0) CONSTANT INIT
      614    14623    1         ('%3-ADDRESS = %>A');
      615    14624    1   DCL BL_STR                         CHAR(0) CONSTANT INIT (' ');
      616    14625    1   DCL CUG_JCL_FMT              CHAR(0) CONSTANT INIT
      617    14626    1         ('%3-CUG = %A');
      618    14627    1   DCL DEST_JCL_FMT             CHAR(0) CONSTANT INIT
      619    14628    1         ('%3-DESTINATION = %>A');
      620    14629    1   DCL IS_STR                         CHAR(0) CONSTANT INIT ('IS');
      621    14630        %KL_LNKVC   ( LVL = 1, STCLASS = CONSTANT );
      622    14854    1   DCL PERMANENT_STR            CHAR(0) CONSTANT INIT ('PERMANENT');
      623    14855    1   DCL PERM_FMT                 CHAR(0) CONSTANT INIT
      624    14856    1   ('%61-%A');
      625    14857    1   DCL PERM_JCL_FMT             CHAR(0) CONSTANT INIT
      626    14858    1         ('%3-PERMANENT = %1.N[YES%0?NO%]');
      627    14859    1   DCL PROFILE_JCL_FMT          CHAR(0) CONSTANT INIT
      628    14860    1         ('%3-PROFILE = %>A');
      629    14861    1   DCL QOS_JCL_FMT              CHAR(0) CONSTANT INIT
      630    14862    1         ('%3-QOS = %D');
      631    14863    1   DCL VIRCIR_FMT               CHAR(0) CONSTANT INIT
      632    14864    1   ('%4-%D%12-%A%24-%A%30-%A%40-%A%57-%3D');
      633    14865    1   DCL VIRCIR_HDR               CHAR(0) CONSTANT INIT
      634    14866    1   ('  CIRCUIT  PROFILE     CUG   DEST      ADDRESS          QOS' ) ;
      635    14867    1   DCL VIRCIR_JCL_CMD           CHAR(0) CONSTANT INIT
      636    14868    1         ('CREATE VIRCIR %D FOR LINK %>A');
      637    14869        /********************************************************************/
      638    14870        /*   Procedure       procedure       procedure       procedure      */
      639    14871        /********************************************************************/
      640    14872    2   IF NOT JCL THEN DO;

  14872  3 000002   200005 470500                    LDP0    @JCL,,AUTO
         3 000003   000000 066500                    CMPB    filb='0'B
         3 000004   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 000005   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000006   000307 601000 3                  TNZ     s:14929

      641    14873                                                  /* List virtual circuit info. */
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:116  
      642    14874    3      IF NEW_LINK THEN DO;

  14874  3 000007   200004 471500                    LDP1    @NEW_LINK,,AUTO
         3 000010   000000 066500                    CMPB    filb='0'B
         3 000011   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         3 000012   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000013   000024 600000 3                  TZE     s:14878

      643    14875    3         CALL ASB$WRITE_LO( AS_BLANK, 1 );

  14875  3 000014   000000 630400 4                  EPPR0   0
         3 000015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000016   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000017   000000 011000                    NOP     0

      644    14876    3         CALL ASB$WRITE_LO( VIRCIR_HDR, LENGTHC(VIRCIR_HDR) );

  14876  3 000020   000003 630400 4                  EPPR0   3
         3 000021   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000022   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000023   000000 011000                    NOP     0

      645    14877    3         END; /* New link  */

      646    14878    2      FMT_BUF = VIRCIR_FMT;

  14878  3 000024   040000 100400                    MLR     fill='040'O
         3 000025   000056 000044 2                  ADSC9   VIRCIR_FMT               cn=0,n=36
         3 000026   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      647    14879    2      FDS.FMT_.BOUND = SIZEV(VIRCIR_FMT);

  14879  3 000027   000000 236000 xsym               LDQ     FDS
         3 000030   177777 376007                    ANQ     65535,DL
         3 000031   000005 276000 4                  ORQ     5
         3 000032   000000 756000 xsym               STQ     FDS

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:117  
      648    14880    2      FDS.NVECS# = 6;

  14880  3 000033   000006 235007                    LDA     6,DL
         3 000034   000011 755000 xsym               STA     FDS+9

      649    14881    2      TEMP_NUMB = VIRCIR$->KL$LNKVC.VIRCIR# ;

  14881  3 000035   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000036   000000 471500                    LDP1    0,,PR0
         3 000037   100012 236100                    LDQ     10,,PR1
         3 000040   777777 376007                    ANQ     -1,DL
         3 000041   000000 756000 1                  STQ     TEMP_NUMB

      650    14882    2      FMT_VEC(0) = VECTOR( TEMP_NUMB );

  14882  3 000042   000006 237000 4                  LDAQ    6
         3 000043   000000 755000 xsym               STA     FMT_VEC
         3 000044   000001 756000 xsym               STQ     FMT_VEC+1

      651    14883    2      FMT_VEC(1) = VECTOR( ADDR(VIRCIR$->KL$LNKVC.PRONM) -> TEXT$C.TEXT) ;

  14883  3 000045   000000 471500                    LDP1    0,,PR0
         3 000046   100007 236100                    LDQ     7,,PR1
         3 000047   000033 772000                    QRL     27
         3 000050   000064 737000                    LLS     52
         3 000051   000140 135007                    SBLA    96,DL
         3 000052   200020 451500                    STP1    VAL+2,,AUTO
         3 000053   200020 236100                    LDQ     VAL+2,,AUTO
         3 000054   000010 036000 4                  ADLQ    8
         3 000055   000002 755000 xsym               STA     FMT_VEC+2
         3 000056   000003 756000 xsym               STQ     FMT_VEC+3

      652    14884    2      FMT_VEC(2) = VECTOR( ADDR1 ) ;

  14884  3 000057   777640 235007                    LDA     -96,DL
         3 000060   200020 452500                    STP2    VAL+2,,AUTO
         3 000061   200020 236100                    LDQ     VAL+2,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:118  
         3 000062   000014 036003                    ADLQ    12,DU
         3 000063   000004 755000 xsym               STA     FMT_VEC+4
         3 000064   000005 756000 xsym               STQ     FMT_VEC+5

      653    14885    3      IF VIRCIR$ -> KL$LNKVC.CUG.LNG# = 2 THEN DO;  /*  Means 4 digits  */

  14885  3 000065   000000 471500                    LDP1    0,,PR0
         3 000066   100002 236100                    LDQ     2,,PR1
         3 000067   300000 376003                    ANQ     98304,DU
         3 000070   200000 116003                    CMPQ    65536,DU
         3 000071   000112 601000 3                  TNZ     s:14892

      654    14886    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD1# ;

  14886  3 000072   100002 236100                    LDQ     2,,PR1
         3 000073   000026 772000                    QRL     22
         3 000074   000017 376007                    ANQ     15,DL
         3 000075   200016 756100                    STQ     VAL,,AUTO

      655    14887    3         CALL BINCHAR( ADDR1(0), VAL ) ;

  14887  3 000076   000100 301500                    BTD
         3 000077   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000100   200014 030001                    NDSC9   ADDR1,,AUTO              cn=0,s=nosgn,sf=0,n=1

      656    14888    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD2# ;

  14888  3 000101   000000 471500                    LDP1    0,,PR0
         3 000102   100002 236100                    LDQ     2,,PR1
         3 000103   000022 772000                    QRL     18
         3 000104   000017 376007                    ANQ     15,DL
         3 000105   200016 756100                    STQ     VAL,,AUTO

      657    14889    3         CALL BINCHAR( ADDR1(1), VAL ) ;

  14889  3 000106   000100 301500                    BTD
         3 000107   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:119  
         3 000110   200014 230001                    NDSC9   ADDR1,,AUTO              cn=1,s=nosgn,sf=0,n=1

      658    14890    3         END;  /*  LNG# = 2  */

  14890  3 000111   000116 710000 3                  TRA     s:14895

      659    14891    3      ELSE DO;

      660    14892    3         ADDR1(0) = ' ';

  14892  3 000112   040000 236003                    LDQ     16384,DU
         3 000113   200014 552140                    STBQ    ADDR1,'40'O,AUTO

      661    14893    3         ADDR1(1) = ' ';

  14893  3 000114   000040 236003                    LDQ     32,DU
         3 000115   200014 552120                    STBQ    ADDR1,'20'O,AUTO

      662    14894    3         END;  /*  LNG# ~= 2  */

      663    14895    3      IF VIRCIR$ -> KL$LNKVC.CUG.LNG# > 0 THEN DO;  /*  Means at least 2 digits  */

  14895  3 000116   000000 471500                    LDP1    0,,PR0
         3 000117   100002 236100                    LDQ     2,,PR1
         3 000120   300000 316003                    CANQ    98304,DU
         3 000121   000142 600000 3                  TZE     s:14902

      664    14896    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD3# ;

  14896  3 000122   100002 236100                    LDQ     2,,PR1
         3 000123   000015 772000                    QRL     13
         3 000124   000017 376007                    ANQ     15,DL
         3 000125   200016 756100                    STQ     VAL,,AUTO

      665    14897    3         CALL BINCHAR( ADDR1(2), VAL ) ;

  14897  3 000126   000100 301500                    BTD
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:120  
         3 000127   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000130   200014 430001                    NDSC9   ADDR1,,AUTO              cn=2,s=nosgn,sf=0,n=1

      666    14898    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD4# ;

  14898  3 000131   000000 471500                    LDP1    0,,PR0
         3 000132   100002 236100                    LDQ     2,,PR1
         3 000133   000011 772000                    QRL     9
         3 000134   000017 376007                    ANQ     15,DL
         3 000135   200016 756100                    STQ     VAL,,AUTO

      667    14899    3         CALL BINCHAR( ADDR1(3), VAL ) ;

  14899  3 000136   000100 301500                    BTD
         3 000137   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000140   200014 630001                    NDSC9   ADDR1,,AUTO              cn=3,s=nosgn,sf=0,n=1

      668    14900    3         END;  /*  LNG# = 1 or LNG# = 2  */

  14900  3 000141   000146 710000 3                  TRA     s:14905

      669    14901    3      ELSE DO;

      670    14902    3         ADDR1(2) = ' ';

  14902  3 000142   040000 236007                    LDQ     16384,DL
         3 000143   200014 552110                    STBQ    ADDR1,'10'O,AUTO

      671    14903    3         ADDR1(3) = ' ';

  14903  3 000144   000040 236007                    LDQ     32,DL
         3 000145   200014 552104                    STBQ    ADDR1,'04'O,AUTO

      672    14904    3         END;  /*  LNG# = 0  */

      673    14905    2      FMT_VEC(3) = VECTOR( VIRCIR$->KL$LNKVC.DST# ) ;

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:121  
  14905  3 000146   000000 471500                    LDP1    0,,PR0
         3 000147   000011 235000 4                  LDA     9
         3 000150   200020 451500                    STP1    VAL+2,,AUTO
         3 000151   200020 236100                    LDQ     VAL+2,,AUTO
         3 000152   000005 036003                    ADLQ    5,DU
         3 000153   000006 755000 xsym               STA     FMT_VEC+6
         3 000154   000007 756000 xsym               STQ     FMT_VEC+7

      674    14906    2      FMT_VEC(4) = VECTOR( ADDRESS ) ;

  14906  3 000155   000012 235000 4                  LDA     10
         3 000156   200020 452500                    STP2    VAL+2,,AUTO
         3 000157   200020 236100                    LDQ     VAL+2,,AUTO
         3 000160   000010 036003                    ADLQ    8,DU
         3 000161   000010 755000 xsym               STA     FMT_VEC+8
         3 000162   000011 756000 xsym               STQ     FMT_VEC+9

      675    14907    3      DO J = 0 TO 6 ;

  14907  3 000163   200015 450100                    STZ     J,,AUTO

      676    14908    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD1#(J);

  14908  3 000164   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000165   000000 471500                    LDP1    0,,PR0
         3 000166   200015 236100                    LDQ     J,,AUTO
         3 000167   000011 402007                    MPY     9,DL
         3 000170   000000 116003                    CMPQ    0,DU
         3 000171   000173 605000 3                  TPL     s:14908+7
         3 000172   000044 036003                    ADLQ    36,DU
         3 000173   003100 061506                    CSR     bolr='003'O
         3 000174   100003 010004                    BDSC    3,Q,PR1                  by=0,bit=1,n=4
         3 000175   200016 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      677    14909    3         CALL BINCHAR ( ADDRESS( J*2 ), VAL ) ;

  14909  3 000176   200015 235100                    LDA     J,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:122  
         3 000177   000001 735000                    ALS     1
         3 000200   000105 301500                    BTD
         3 000201   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000202   200010 030001                    NDSC9   ADDRESS,A,AUTO           cn=0,s=nosgn,sf=0,n=1

      678    14910    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD2#(J);

  14910  3 000203   000000 471500                    LDP1    0,,PR0
         3 000204   200015 236100                    LDQ     J,,AUTO
         3 000205   000011 402007                    MPY     9,DL
         3 000206   000000 116003                    CMPQ    0,DU
         3 000207   000211 605000 3                  TPL     s:14910+6
         3 000210   000044 036003                    ADLQ    36,DU
         3 000211   003100 061506                    CSR     bolr='003'O
         3 000212   100003 050004                    BDSC    3,Q,PR1                  by=0,bit=5,n=4
         3 000213   200016 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      679    14911    3         CALL BINCHAR ( ADDRESS( J*2+1 ), VAL ) ;

  14911  3 000214   200015 235100                    LDA     J,,AUTO
         3 000215   000001 735000                    ALS     1
         3 000216   000105 301500                    BTD
         3 000217   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000220   200010 230001                    NDSC9   ADDRESS,A,AUTO           cn=1,s=nosgn,sf=0,n=1

      680    14912    3         END ;  /*  Do j  */

  14912  3 000221   200015 054100                    AOS     J,,AUTO
         3 000222   200015 235100                    LDA     J,,AUTO
         3 000223   000006 115007                    CMPA    6,DL
         3 000224   000164 604400 3                  TMOZ    s:14908

      681    14913    3      DO J = VIRCIR$->KL$LNKVC.ADR.LNG# TO 14;

  14913  3 000225   000000 471500                    LDP1    0,,PR0
         3 000226   100002 236100                    LDQ     2,,PR1
         3 000227   000777 376007                    ANQ     511,DL
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:123  
         3 000230   200015 756100                    STQ     J,,AUTO
         3 000231   000237 710000 3                  TRA     s:14915+1

      682    14914    3         ADDRESS (J) = ' ';

  14914  3 000232   200015 235100                    LDA     J,,AUTO
         3 000233   040105 100400                    MLR     fill='040'O
         3 000234   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000235   200010 000001                    ADSC9   ADDRESS,A,AUTO           cn=0,n=1

      683    14915    3         END;  /*  Do j  */

  14915  3 000236   200015 054100                    AOS     J,,AUTO
         3 000237   200015 235100                    LDA     J,,AUTO
         3 000240   000016 115007                    CMPA    14,DL
         3 000241   000232 604400 3                  TMOZ    s:14914

      684    14916    2      FMT_VEC(5) = VECTOR (KL$LNKVC.QOS#);

  14916  3 000242   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000243   000000 471500                    LDP1    0,,PR0
         3 000244   177640 235007                    LDA     65440,DL
         3 000245   200020 451500                    STP1    VAL+2,,AUTO
         3 000246   200020 236100                    LDQ     VAL+2,,AUTO
         3 000247   000013 036003                    ADLQ    11,DU
         3 000250   000012 755000 xsym               STA     FMT_VEC+10
         3 000251   000013 756000 xsym               STQ     FMT_VEC+11

      685    14917    2      IF VIRCIR$->KL$LNKVC.PERMANENT THEN

  14917  3 000252   000000 471500                    LDP1    0,,PR0
         3 000253   100013 236100                    LDQ     11,,PR1
         3 000254   000200 316003                    CANQ    128,DU
         3 000255   000302 600000 3                  TZE     s:14926

      686    14918    3      DO;

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:124  
      687    14919    4         IF NEW_LINK THEN DO;

  14919  3 000256   200004 473500                    LDP3    @NEW_LINK,,AUTO
         3 000257   000000 066500                    CMPB    filb='0'B
         3 000260   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         3 000261   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000262   000275 600000 3                  TZE     s:14923

      688    14920    4            CALL CONCAT (FMT_BUF,VIRCIR_FMT,PERM_FMT);

  14920  3 000263   040000 100400                    MLR     fill='040'O
         3 000264   000056 000044 2                  ADSC9   VIRCIR_FMT               cn=0,n=36
         3 000265   000000 000044 xsym               ADSC9   FMT_BUF                  cn=0,n=36
         3 000266   040000 100400                    MLR     fill='040'O
         3 000267   000035 000006 2                  ADSC9   PERM_FMT                 cn=0,n=6
         3 000270   000011 000333 xsym               ADSC9   FMT_BUF+9                cn=0,n=219

      689    14921    4            FDS.FMT_.BOUND = SIZEC(VIRCIR_FMT) + SIZEC (PERM_FMT) - 1;

  14921  3 000271   000000 236000 xsym               LDQ     FDS
         3 000272   177777 376007                    ANQ     65535,DL
         3 000273   000013 276000 4                  ORQ     11
         3 000274   000000 756000 xsym               STQ     FDS

      690    14922    4            END;  /* New link  */

      691    14923    3         FMT_VEC(6) = VECTOR (PERMANENT_STR);

  14923  3 000275   000014 237000 4                  LDAQ    12
         3 000276   000014 755000 xsym               STA     FMT_VEC+12
         3 000277   000015 756000 xsym               STQ     FMT_VEC+13

      692    14924    3         FDS.NVECS# = 7;

  14924  3 000300   000007 235007                    LDA     7,DL
         3 000301   000011 755000 xsym               STA     FDS+9

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:125  
      693    14925    3         END;  /*  Permanent  */

      694    14926    2      CALL X$FORMAT( FDS );

  14926  3 000302   000016 630400 4                  EPPR0   14
         3 000303   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000304   000000 701000 xent               TSX1    X$FORMAT
         3 000305   000000 011000                    NOP     0

      695    14927    2      END;  /*  Not jcl  */

  14927  3 000306   000706 710000 3                  TRA     s:14994

      696    14928    2   ELSE DO;  /*  Jcl  */

      697    14929    2      FMT_BUF = VIRCIR_JCL_CMD;

  14929  3 000307   040000 100400                    MLR     fill='040'O
         3 000310   000106 000035 2                  ADSC9   VIRCIR_JCL_CMD           cn=0,n=29
         3 000311   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      698    14930    2      FDS.FMT_.BOUND = SIZEV(VIRCIR_JCL_CMD);

  14930  3 000312   000000 236000 xsym               LDQ     FDS
         3 000313   177777 376007                    ANQ     65535,DL
         3 000314   000007 276003                    ORQ     7,DU
         3 000315   000000 756000 xsym               STQ     FDS

      699    14931    2      FDS.NVECS# = 2;

  14931  3 000316   000002 235007                    LDA     2,DL
         3 000317   000011 755000 xsym               STA     FDS+9

      700    14932    2      TEMP_NUMB = VIRCIR$->KL$LNKVC.VIRCIR# ;

  14932  3 000320   200003 471500                    LDP1    @VIRCIR$,,AUTO
         3 000321   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:126  
         3 000322   300012 236100                    LDQ     10,,PR3
         3 000323   777777 376007                    ANQ     -1,DL
         3 000324   000000 756000 1                  STQ     TEMP_NUMB

      701    14933    2      FMT_VEC(0) = VECTOR( TEMP_NUMB );

  14933  3 000325   000006 237000 4                  LDAQ    6
         3 000326   000000 755000 xsym               STA     FMT_VEC
         3 000327   000001 756000 xsym               STQ     FMT_VEC+1

      702    14934    2      FMT_VEC(1) = VECTOR( LINK_NAME );

  14934  3 000330   000011 235000 4                  LDA     9
         3 000331   200006 236100                    LDQ     @LINK_NAME,,AUTO
         3 000332   000002 755000 xsym               STA     FMT_VEC+2
         3 000333   000003 756000 xsym               STQ     FMT_VEC+3

      703    14935    2      CALL X$FORMAT( FDS );

  14935  3 000334   000016 630400 4                  EPPR0   14
         3 000335   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000336   000000 701000 xent               TSX1    X$FORMAT
         3 000337   000000 011000                    NOP     0

      704    14936    2      FMT_BUF = PROFILE_JCL_FMT;

  14936  3 000340   040000 100400                    MLR     fill='040'O
         3 000341   000047 000020 2                  ADSC9   PROFILE_JCL_FMT          cn=0,n=16
         3 000342   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      705    14937    2      FDS.FMT_.BOUND = SIZEV(PROFILE_JCL_FMT);

  14937  3 000343   000000 236000 xsym               LDQ     FDS
         3 000344   177777 376007                    ANQ     65535,DL
         3 000345   000017 276000 4                  ORQ     15
         3 000346   000000 756000 xsym               STQ     FDS

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:127  
      706    14938    2      FDS.NVECS# = 1;

  14938  3 000347   000001 235007                    LDA     1,DL
         3 000350   000011 755000 xsym               STA     FDS+9

      707    14939    2      FMT_VEC(0) = VECTOR( ADDR(VIRCIR$->KL$LNKVC.PRONM) -> TEXT$C.TEXT) ;

  14939  3 000351   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000352   000000 471500                    LDP1    0,,PR0
         3 000353   100007 236100                    LDQ     7,,PR1
         3 000354   000033 772000                    QRL     27
         3 000355   000064 737000                    LLS     52
         3 000356   000140 135007                    SBLA    96,DL
         3 000357   200020 451500                    STP1    VAL+2,,AUTO
         3 000360   200020 236100                    LDQ     VAL+2,,AUTO
         3 000361   000010 036000 4                  ADLQ    8
         3 000362   000000 755000 xsym               STA     FMT_VEC
         3 000363   000001 756000 xsym               STQ     FMT_VEC+1

      708    14940    2      CALL X$FORMAT( FDS );

  14940  3 000364   000016 630400 4                  EPPR0   14
         3 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000366   000000 701000 xent               TSX1    X$FORMAT
         3 000367   000000 011000                    NOP     0

      709    14941    3      IF VIRCIR$->KL$LNKVC.CUG.LNG# > 0 THEN DO;

  14941  3 000370   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000371   000000 471500                    LDP1    0,,PR0
         3 000372   100002 236100                    LDQ     2,,PR1
         3 000373   300000 316003                    CANQ    98304,DU
         3 000374   000472 600000 3                  TZE     s:14961

      710    14942    3         ADDR1 (0)  = ' ';

  14942  3 000375   040000 236003                    LDQ     16384,DU
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:128  
         3 000376   200014 552140                    STBQ    ADDR1,'40'O,AUTO

      711    14943    3         ADDR1 (1)  = ' ';

  14943  3 000377   000040 236003                    LDQ     32,DU
         3 000400   200014 552120                    STBQ    ADDR1,'20'O,AUTO

      712    14944    3         ADDR1 (2)  = ' ';

  14944  3 000401   040000 236007                    LDQ     16384,DL
         3 000402   200014 552110                    STBQ    ADDR1,'10'O,AUTO

      713    14945    3         ADDR1 (3)  = ' ';

  14945  3 000403   000040 236007                    LDQ     32,DL
         3 000404   200014 552104                    STBQ    ADDR1,'04'O,AUTO

      714    14946    3         FMT_BUF = CUG_JCL_FMT;

  14946  3 000405   040000 100400                    MLR     fill='040'O
         3 000406   000005 000013 2                  ADSC9   CUG_JCL_FMT              cn=0,n=11
         3 000407   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      715    14947    3         FDS.FMT_.BOUND = SIZEV(CUG_JCL_FMT);

  14947  3 000410   000000 236000 xsym               LDQ     FDS
         3 000411   177777 376007                    ANQ     65535,DL
         3 000412   000020 276000 4                  ORQ     16
         3 000413   000000 756000 xsym               STQ     FDS

      716    14948    3         FMT_VEC(0) = VECTOR( ADDR1 ) ;

  14948  3 000414   777640 235007                    LDA     -96,DL
         3 000415   200020 452500                    STP2    VAL+2,,AUTO
         3 000416   200020 236100                    LDQ     VAL+2,,AUTO
         3 000417   000014 036003                    ADLQ    12,DU
         3 000420   000000 755000 xsym               STA     FMT_VEC
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:129  
         3 000421   000001 756000 xsym               STQ     FMT_VEC+1

      717    14949    4         IF VIRCIR$ -> KL$LNKVC.CUG.LNG# = 2 THEN DO;  /*  Means 4 digits  */

  14949  3 000422   000000 471500                    LDP1    0,,PR0
         3 000423   100002 236100                    LDQ     2,,PR1
         3 000424   300000 376003                    ANQ     98304,DU
         3 000425   200000 116003                    CMPQ    65536,DU
         3 000426   000446 601000 3                  TNZ     s:14955

      718    14950    4            VAL = VIRCIR$->KL$LNKVC.CUG.BCD1# ;

  14950  3 000427   100002 236100                    LDQ     2,,PR1
         3 000430   000026 772000                    QRL     22
         3 000431   000017 376007                    ANQ     15,DL
         3 000432   200016 756100                    STQ     VAL,,AUTO

      719    14951    4            CALL BINCHAR( ADDR1(0), VAL ) ;

  14951  3 000433   000100 301500                    BTD
         3 000434   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000435   200014 030001                    NDSC9   ADDR1,,AUTO              cn=0,s=nosgn,sf=0,n=1

      720    14952    4            VAL = VIRCIR$->KL$LNKVC.CUG.BCD2# ;

  14952  3 000436   000000 471500                    LDP1    0,,PR0
         3 000437   100002 236100                    LDQ     2,,PR1
         3 000440   000022 772000                    QRL     18
         3 000441   000017 376007                    ANQ     15,DL
         3 000442   200016 756100                    STQ     VAL,,AUTO

      721    14953    4            CALL BINCHAR( ADDR1(1), VAL ) ;

  14953  3 000443   000100 301500                    BTD
         3 000444   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000445   200014 230001                    NDSC9   ADDR1,,AUTO              cn=1,s=nosgn,sf=0,n=1

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:130  
      722    14954    4            END;  /*  LNG# = 2  */

      723    14955    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD3# ;

  14955  3 000446   000000 471500                    LDP1    0,,PR0
         3 000447   100002 236100                    LDQ     2,,PR1
         3 000450   000015 772000                    QRL     13
         3 000451   000017 376007                    ANQ     15,DL
         3 000452   200016 756100                    STQ     VAL,,AUTO

      724    14956    3         CALL BINCHAR( ADDR1(2), VAL ) ;

  14956  3 000453   000100 301500                    BTD
         3 000454   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000455   200014 430001                    NDSC9   ADDR1,,AUTO              cn=2,s=nosgn,sf=0,n=1

      725    14957    3         VAL = VIRCIR$->KL$LNKVC.CUG.BCD4# ;

  14957  3 000456   000000 471500                    LDP1    0,,PR0
         3 000457   100002 236100                    LDQ     2,,PR1
         3 000460   000011 772000                    QRL     9
         3 000461   000017 376007                    ANQ     15,DL
         3 000462   200016 756100                    STQ     VAL,,AUTO

      726    14958    3         CALL BINCHAR( ADDR1(3), VAL ) ;

  14958  3 000463   000100 301500                    BTD
         3 000464   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000465   200014 630001                    NDSC9   ADDR1,,AUTO              cn=3,s=nosgn,sf=0,n=1

      727    14959    3         CALL X$FORMAT( FDS );

  14959  3 000466   000016 630400 4                  EPPR0   14
         3 000467   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000470   000000 701000 xent               TSX1    X$FORMAT
         3 000471   000000 011000                    NOP     0

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:131  
      728    14960    3         END;  /*  CUG.LNG# > 0  */

      729    14961    2      FMT_BUF = DEST_JCL_FMT;

  14961  3 000472   040000 100400                    MLR     fill='040'O
         3 000473   000010 000024 2                  ADSC9   DEST_JCL_FMT             cn=0,n=20
         3 000474   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      730    14962    2      FDS.FMT_.BOUND = SIZEV(DEST_JCL_FMT);

  14962  3 000475   000000 236000 xsym               LDQ     FDS
         3 000476   177777 376007                    ANQ     65535,DL
         3 000477   000021 276000 4                  ORQ     17
         3 000500   000000 756000 xsym               STQ     FDS

      731    14963    2      IF VIRCIR$->KL$LNKVC.NODE# = 254 THEN

  14963  3 000501   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000502   000000 471500                    LDP1    0,,PR0
         3 000503   100012 236100                    LDQ     10,,PR1
         3 000504   000777 376003                    ANQ     511,DU
         3 000505   000376 116003                    CMPQ    254,DU
         3 000506   000513 601000 3                  TNZ     s:14965

      732    14964    2         FMT_VEC(0) = VECTOR( BL_STR ) ;

  14964  3 000507   000022 237000 4                  LDAQ    18
         3 000510   000000 755000 xsym               STA     FMT_VEC
         3 000511   000001 756000 xsym               STQ     FMT_VEC+1
         3 000512   000527 710000 3                  TRA     s:14969

      733    14965    2      ELSE IF VIRCIR$->KL$LNKVC.NODE# = 253 THEN

  14965  3 000513   000375 116003                    CMPQ    253,DU
         3 000514   000521 601000 3                  TNZ     s:14968

      734    14966    2            FMT_VEC(0) = VECTOR( IS_STR ) ;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:132  

  14966  3 000515   000024 237000 4                  LDAQ    20
         3 000516   000000 755000 xsym               STA     FMT_VEC
         3 000517   000001 756000 xsym               STQ     FMT_VEC+1
         3 000520   000527 710000 3                  TRA     s:14969

      735    14967    2         ELSE
      736    14968    2            FMT_VEC(0) = VECTOR( VIRCIR$->KL$LNKVC.DST# ) ;

  14968  3 000521   000011 235000 4                  LDA     9
         3 000522   200020 451500                    STP1    VAL+2,,AUTO
         3 000523   200020 236100                    LDQ     VAL+2,,AUTO
         3 000524   000005 036003                    ADLQ    5,DU
         3 000525   000000 755000 xsym               STA     FMT_VEC
         3 000526   000001 756000 xsym               STQ     FMT_VEC+1

      737    14969    2      CALL X$FORMAT( FDS );

  14969  3 000527   000016 630400 4                  EPPR0   14
         3 000530   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000531   000000 701000 xent               TSX1    X$FORMAT
         3 000532   000000 011000                    NOP     0

      738    14970    2      FMT_BUF = ADDRESS_JCL_FMT;

  14970  3 000533   040000 100400                    MLR     fill='040'O
         3 000534   000000 000020 2                  ADSC9   ADDRESS_JCL_FMT          cn=0,n=16
         3 000535   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      739    14971    2      FDS.FMT_.BOUND = SIZEV(ADDRESS_JCL_FMT);

  14971  3 000536   000000 236000 xsym               LDQ     FDS
         3 000537   177777 376007                    ANQ     65535,DL
         3 000540   000017 276000 4                  ORQ     15
         3 000541   000000 756000 xsym               STQ     FDS

      740    14972    2      FMT_VEC(0) = VECTOR( ADDRESS ) ;
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:133  

  14972  3 000542   000012 235000 4                  LDA     10
         3 000543   200020 452500                    STP2    VAL+2,,AUTO
         3 000544   200020 236100                    LDQ     VAL+2,,AUTO
         3 000545   000010 036003                    ADLQ    8,DU
         3 000546   000000 755000 xsym               STA     FMT_VEC
         3 000547   000001 756000 xsym               STQ     FMT_VEC+1

      741    14973    3      DO J = 0 TO 6 ;

  14973  3 000550   200015 450100                    STZ     J,,AUTO

      742    14974    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD1#(J);

  14974  3 000551   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000552   000000 471500                    LDP1    0,,PR0
         3 000553   200015 236100                    LDQ     J,,AUTO
         3 000554   000011 402007                    MPY     9,DL
         3 000555   000000 116003                    CMPQ    0,DU
         3 000556   000560 605000 3                  TPL     s:14974+7
         3 000557   000044 036003                    ADLQ    36,DU
         3 000560   003100 061506                    CSR     bolr='003'O
         3 000561   100003 010004                    BDSC    3,Q,PR1                  by=0,bit=1,n=4
         3 000562   200016 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      743    14975    3         CALL BINCHAR ( ADDRESS( J*2 ), VAL ) ;

  14975  3 000563   200015 235100                    LDA     J,,AUTO
         3 000564   000001 735000                    ALS     1
         3 000565   000105 301500                    BTD
         3 000566   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000567   200010 030001                    NDSC9   ADDRESS,A,AUTO           cn=0,s=nosgn,sf=0,n=1

      744    14976    3         VAL = VIRCIR$->KL$LNKVC.ADR.ADR.BCD2#(J);

  14976  3 000570   000000 471500                    LDP1    0,,PR0
         3 000571   200015 236100                    LDQ     J,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:134  
         3 000572   000011 402007                    MPY     9,DL
         3 000573   000000 116003                    CMPQ    0,DU
         3 000574   000576 605000 3                  TPL     s:14976+6
         3 000575   000044 036003                    ADLQ    36,DU
         3 000576   003100 061506                    CSR     bolr='003'O
         3 000577   100003 050004                    BDSC    3,Q,PR1                  by=0,bit=5,n=4
         3 000600   200016 000044                    BDSC    VAL,,AUTO                by=0,bit=0,n=36

      745    14977    3         CALL BINCHAR ( ADDRESS( J*2+1 ), VAL ) ;

  14977  3 000601   200015 235100                    LDA     J,,AUTO
         3 000602   000001 735000                    ALS     1
         3 000603   000105 301500                    BTD
         3 000604   200016 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4
         3 000605   200010 230001                    NDSC9   ADDRESS,A,AUTO           cn=1,s=nosgn,sf=0,n=1

      746    14978    3         END ;  /*  Do j  */

  14978  3 000606   200015 054100                    AOS     J,,AUTO
         3 000607   200015 235100                    LDA     J,,AUTO
         3 000610   000006 115007                    CMPA    6,DL
         3 000611   000551 604400 3                  TMOZ    s:14974

      747    14979    3      DO J = VIRCIR$->KL$LNKVC.ADR.LNG# TO 14;

  14979  3 000612   000000 471500                    LDP1    0,,PR0
         3 000613   100002 236100                    LDQ     2,,PR1
         3 000614   000777 376007                    ANQ     511,DL
         3 000615   200015 756100                    STQ     J,,AUTO
         3 000616   000624 710000 3                  TRA     s:14981+1

      748    14980    3         ADDRESS (J) = ' ';

  14980  3 000617   200015 235100                    LDA     J,,AUTO
         3 000620   040105 100400                    MLR     fill='040'O
         3 000621   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000622   200010 000001                    ADSC9   ADDRESS,A,AUTO           cn=0,n=1
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:135  

      749    14981    3         END;  /*  Do j  */

  14981  3 000623   200015 054100                    AOS     J,,AUTO
         3 000624   200015 235100                    LDA     J,,AUTO
         3 000625   000016 115007                    CMPA    14,DL
         3 000626   000617 604400 3                  TMOZ    s:14980

      750    14982    2      CALL X$FORMAT( FDS );

  14982  3 000627   000016 630400 4                  EPPR0   14
         3 000630   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000631   000000 701000 xent               TSX1    X$FORMAT
         3 000632   000000 011000                    NOP     0

      751    14983    2      FMT_BUF = QOS_JCL_FMT;

  14983  3 000633   040000 100400                    MLR     fill='040'O
         3 000634   000053 000013 2                  ADSC9   QOS_JCL_FMT              cn=0,n=11
         3 000635   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      752    14984    2      FDS.FMT_.BOUND = SIZEV(QOS_JCL_FMT);

  14984  3 000636   000000 236000 xsym               LDQ     FDS
         3 000637   177777 376007                    ANQ     65535,DL
         3 000640   000020 276000 4                  ORQ     16
         3 000641   000000 756000 xsym               STQ     FDS

      753    14985    2      FMT_VEC(0) = VECTOR (KL$LNKVC.QOS#);

  14985  3 000642   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000643   000000 471500                    LDP1    0,,PR0
         3 000644   177640 235007                    LDA     65440,DL
         3 000645   200020 451500                    STP1    VAL+2,,AUTO
         3 000646   200020 236100                    LDQ     VAL+2,,AUTO
         3 000647   000013 036003                    ADLQ    11,DU
         3 000650   000000 755000 xsym               STA     FMT_VEC
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:136  
         3 000651   000001 756000 xsym               STQ     FMT_VEC+1

      754    14986    2      CALL X$FORMAT( FDS );

  14986  3 000652   000016 630400 4                  EPPR0   14
         3 000653   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000654   000000 701000 xent               TSX1    X$FORMAT
         3 000655   000000 011000                    NOP     0

      755    14987    2      FMT_BUF = PERM_JCL_FMT;

  14987  3 000656   040000 100400                    MLR     fill='040'O
         3 000657   000037 000036 2                  ADSC9   PERM_JCL_FMT             cn=0,n=30
         3 000660   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      756    14988    2      FDS.FMT_.BOUND = SIZEV(PERM_JCL_FMT);

  14988  3 000661   000000 236000 xsym               LDQ     FDS
         3 000662   177777 376007                    ANQ     65535,DL
         3 000663   000010 276000 4                  ORQ     8
         3 000664   000000 756000 xsym               STQ     FDS

      757    14989    2      TEMP_NUMB = BITBIN ( VIRCIR$->KL$LNKVC.PERMANENT );

  14989  3 000665   200003 470500                    LDP0    @VIRCIR$,,AUTO
         3 000666   000000 471500                    LDP1    0,,PR0
         3 000667   100013 236100                    LDQ     11,,PR1
         3 000670   000031 772000                    QRL     25
         3 000671   000001 376007                    ANQ     1,DL
         3 000672   000000 756000 1                  STQ     TEMP_NUMB

      758    14990    2      FMT_VEC(0) = VECTOR ( TEMP_NUMB );

  14990  3 000673   000006 237000 4                  LDAQ    6
         3 000674   000000 755000 xsym               STA     FMT_VEC
         3 000675   000001 756000 xsym               STQ     FMT_VEC+1

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:137  
      759    14991    2      CALL X$FORMAT( FDS );

  14991  3 000676   000016 630400 4                  EPPR0   14
         3 000677   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000700   000000 701000 xent               TSX1    X$FORMAT
         3 000701   000000 011000                    NOP     0

      760    14992    2      CALL ASB$WRITE_LO ('   END',6);

  14992  3 000702   000026 630400 4                  EPPR0   22
         3 000703   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000704   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000705   000000 011000                    NOP     0

      761    14993    2      END;   /*  Jcl  */

      762    14994    1   FDS.NVECS# = 0; /* reset # vectors to format structure */

  14994  3 000706   000011 450000 xsym               STZ     FDS+9

      763    14995    1   RETURN;

  14995  3 000707   000000 702200 xent               TSX2  ! X66_ARET
      764    14996
      765    14997    1   END ASL$DISP_ONE_VIRCIR;

PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:138  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_VIRCIR.
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:139  

 **** Variables and constants ****

  ****  Section 001  Data  ASL$DISP_ONE_VIRCIR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 TEMP_NUMB

  ****  Section 002 RoData ASL$DISP_ONE_VIRCIR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(16)    r     1 ADDRESS_JCL_FMT            4-0-0/c CHAR        r     1 BL_STR
     5-0-0/c CHAR(11)    r     1 CUG_JCL_FMT               10-0-0/c CHAR(20)    r     1 DEST_JCL_FMT
    15-0-0/c CHAR(2)     r     1 IS_STR                    32-0-0/c CHAR(9)     r     1 PERMANENT_STR
    35-0-0/c CHAR(6)     r     1 PERM_FMT                  37-0-0/c CHAR(30)    r     1 PERM_JCL_FMT
    47-0-0/c CHAR(16)    r     1 PROFILE_JCL_FMT           53-0-0/c CHAR(11)    r     1 QOS_JCL_FMT
    56-0-0/c CHAR        r     1 VIRCIR_FMT                67-0-0/c CHAR(59)    r     1 VIRCIR_HDR
   106-0-0/c CHAR(29)    r     1 VIRCIR_JCL_CMD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @JCL                       6-0-0/w PTR         r     1 @LINK_NAME
     4-0-0/w PTR         r     1 @NEW_LINK                  3-0-0/w PTR         r     1 @VIRCIR$
    14-0-0/c CHAR        r     1 ADDR1(0:3)                10-0-0/c CHAR        r     1 ADDRESS(0:13)
    15-0-0/w SBIN        r     1 J                         *0-0-0/b BIT         r     1 JCL
    *0-0-0/c CHAR(8)     r     1 LINK_NAME                 *0-0-0/b BIT         r     1 NEW_LINK
    16-0-0/w SBIN        r     1 VAL                       *0-0-0/w PTR         r     1 VIRCIR$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:140  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KL$LNKVC                   0-0-0/w ASTR(9)     r     1 TEXT$C


   Procedure ASL$DISP_ONE_VIRCIR requires 456 words for executable code.
   Procedure ASL$DISP_ONE_VIRCIR requires 18 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_VIRCIRS.:E05TSI    .
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:141  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:142  
          MINI XREF LISTING

ADDR1
     14615**DCL     14884--ASSIGN  14887<<CALLBLT 14889<<CALLBLT 14892<<ASSIGN  14893<<ASSIGN  14897<<CALLBLT
     14899<<CALLBLT 14902<<ASSIGN  14903<<ASSIGN  14942<<ASSIGN  14943<<ASSIGN  14944<<ASSIGN  14945<<ASSIGN
     14948--ASSIGN  14951<<CALLBLT 14953<<CALLBLT 14956<<CALLBLT 14958<<CALLBLT
ADDRESS
     14614**DCL     14906--ASSIGN  14909<<CALLBLT 14911<<CALLBLT 14914<<ASSIGN  14972--ASSIGN  14975<<CALLBLT
     14977<<CALLBLT 14980<<ASSIGN
ADDRESS_JCL_FMT
     14622**DCL     14970>>ASSIGN  14971--ASSIGN
ASA_BRKS_LOC
     11160**DCL     11160--REDEF
ASB$WRITE_LO
     14024**DCL-ENT 14875--CALL    14876--CALL    14992--CALL
AS_BLANK
     11020**DCL     14875<>CALL
AS_DEFAULT.BANNER_PERM
     11853**DCL     11854--REDEF
AS_DEFAULT.BUDGET.MACCT
     11758**DCL     11762--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11771**DCL     11774--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11754**DCL     11756--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11749**DCL     11751--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11869**DCL     11870--REDEF   11871--REDEF
AS_DEFAULT_DREC.PASSWORD
     13123**DCL     13127--REDEF
AS_DEFAULT_DREC.RENAME
     13146**DCL     13147--REDEF
AS_DFLT.BANNER_PERM
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:143  
     11675**DCL     11676--REDEF
AS_DFLT.BUDGET.MACCT
     11580**DCL     11584--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11593**DCL     11596--REDEF
AS_DFLT.BUDGET.PACCUM
     11576**DCL     11578--REDEF
AS_DFLT.BUDGET.PMAXC
     11571**DCL     11573--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11691**DCL     11692--REDEF   11693--REDEF
AS_FE_MODE
     11026**DCL     11027--REDEF
AS_MODE
     11023**DCL     11025--REDEF
AS_MOD_USER.ACCESS
     13888**DCL     13889--REDEF
AS_MOD_USER.BANNER
     13875**DCL     13876--REDEF
AS_MOD_USER.BANNER_PERM
     13877**DCL     13878--REDEF
AS_MOD_USER.BILL
     13883**DCL     13884--REDEF
AS_MOD_USER.CPROC
     13879**DCL     13880--REDEF
AS_MOD_USER.FEBILL
     13959**DCL     13960--REDEF
AS_MOD_USER.FECXTMEM
     13976**DCL     13977--REDEF
AS_MOD_USER.FEMINTS
     13961**DCL     13962--REDEF
AS_MOD_USER.FEMMEM
     13972**DCL     13973--REDEF
AS_MOD_USER.FEMTIME
     13970**DCL     13971--REDEF
AS_MOD_USER.FEPPRIV
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:144  
     13967**DCL     13969--REDEF
AS_MOD_USER.FEPRIV
     13964**DCL     13966--REDEF
AS_MOD_USER.FORCE_BIT
     13873**DCL     13874--REDEF
AS_MOD_USER.KEY
     13955**DCL     13957--REDEF
AS_MOD_USER.LASTCPROC
     13881**DCL     13882--REDEF
AS_MOD_USER.LIMITS.DO_
     13929**DCL     13930--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13945**DCL     13946--REDEF
AS_MOD_USER.LIMITS.LO
     13925**DCL     13926--REDEF
AS_MOD_USER.LIMITS.MEM
     13921**DCL     13922--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13949**DCL     13950--REDEF
AS_MOD_USER.LIMITS.PDIS
     13937**DCL     13938--REDEF
AS_MOD_USER.LIMITS.PO
     13933**DCL     13934--REDEF
AS_MOD_USER.LIMITS.TDIS
     13941**DCL     13942--REDEF
AS_MOD_USER.LIMITS.TIME
     13917**DCL     13918--REDEF
AS_MOD_USER.MAXENQ
     13898**DCL     13899--REDEF
AS_MOD_USER.PERM_BIT
     13871**DCL     13872--REDEF
AS_MOD_USER.PPRIV
     13893**DCL     13895--REDEF
AS_MOD_USER.PRIOB
     13900**DCL     13901--REDEF
AS_MOD_USER.PRIV
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:145  
     13890**DCL     13892--REDEF
AS_MOD_USER.QUAN
     13896**DCL     13897--REDEF
AS_MOD_USER.SETUP
     13869**DCL     13870--REDEF
AS_PROJECT.BANNER_PERM
     12209**DCL     12210--REDEF
AS_PROJECT.BUDGET.MACCT
     12114**DCL     12118--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12127**DCL     12130--REDEF
AS_PROJECT.BUDGET.PACCUM
     12110**DCL     12112--REDEF
AS_PROJECT.BUDGET.PMAXC
     12105**DCL     12107--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12225**DCL     12226--REDEF   12227--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12387**DCL     12388--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12292**DCL     12296--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12305**DCL     12308--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12288**DCL     12290--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12283**DCL     12285--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12403**DCL     12404--REDEF   12405--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13609**DCL     13613--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13632**DCL     13633--REDEF
AS_PROJECT_DREC.PASSWORD
     13447**DCL     13451--REDEF
AS_PROJECT_DREC.RENAME
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:146  
     13470**DCL     13471--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12031**DCL     12032--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11936**DCL     11940--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11949**DCL     11952--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11932**DCL     11934--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11927**DCL     11929--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12047**DCL     12048--REDEF   12049--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13285**DCL     13289--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13308**DCL     13309--REDEF
AS_USERS.BANNER_PERM
     11497**DCL     11498--REDEF
AS_USERS.BUDGET.MACCT
     11402**DCL     11406--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11415**DCL     11418--REDEF
AS_USERS.BUDGET.PACCUM
     11398**DCL     11400--REDEF
AS_USERS.BUDGET.PMAXC
     11393**DCL     11395--REDEF
AS_USERS.SETUP_CHRA.TXT
     11513**DCL     11514--REDEF   11515--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12565**DCL     12566--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12470**DCL     12474--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12483**DCL     12486--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:147  
     12466**DCL     12468--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12461**DCL     12463--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12581**DCL     12582--REDEF   12583--REDEF
BL_STR
     14624**DCL     14964--ASSIGN
CUG_JCL_FMT
     14625**DCL     14946>>ASSIGN  14947--ASSIGN
DEST_JCL_FMT
     14627**DCL     14961>>ASSIGN  14962--ASSIGN
DSEG1$
     11161**DCL     14044--IMP-PTR
ERR_CODE
     11155**DCL     11156--REDEF
FDS
     11052**DCL     14926<>CALL    14935<>CALL    14940<>CALL    14959<>CALL    14969<>CALL    14982<>CALL
     14986<>CALL    14991<>CALL
FDS.FMT_.BOUND
     11057**DCL     14879<<ASSIGN  14921<<ASSIGN  14930<<ASSIGN  14937<<ASSIGN  14947<<ASSIGN  14962<<ASSIGN
     14971<<ASSIGN  14984<<ASSIGN  14988<<ASSIGN
FDS.NVECS#
     11080**DCL     14880<<ASSIGN  14924<<ASSIGN  14931<<ASSIGN  14938<<ASSIGN  14994<<ASSIGN
FMT_BUF
     11151**DCL     14878<<ASSIGN  14920<<CALLBLT 14929<<ASSIGN  14936<<ASSIGN  14946<<ASSIGN  14961<<ASSIGN
     14970<<ASSIGN  14983<<ASSIGN  14987<<ASSIGN
FMT_VEC
     11151**DCL     14882<<ASSIGN  14883<<ASSIGN  14884<<ASSIGN  14905<<ASSIGN  14906<<ASSIGN  14916<<ASSIGN
     14923<<ASSIGN  14933<<ASSIGN  14934<<ASSIGN  14939<<ASSIGN  14948<<ASSIGN  14964<<ASSIGN  14966<<ASSIGN
     14968<<ASSIGN  14972<<ASSIGN  14985<<ASSIGN  14990<<ASSIGN
IS_STR
     14629**DCL     14966--ASSIGN
J
     14616**DCL     14907<<DOINDEX 14908>>ASSIGN  14909>>CALLBLT 14910>>ASSIGN  14911>>CALLBLT 14913<<DOINDEX
     14914>>ASSIGN  14973<<DOINDEX 14974>>ASSIGN  14975>>CALLBLT 14976>>ASSIGN  14977>>CALLBLT 14979<<DOINDEX
     14980>>ASSIGN
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:148  
JCL
     14016**DCL         7--PROC    14872>>IF
KL$LNKVC.ADR.ADR.BCD1#
     14552**DCL     14908>>ASSIGN  14974>>ASSIGN
KL$LNKVC.ADR.ADR.BCD2#
     14553**DCL     14910>>ASSIGN  14976>>ASSIGN
KL$LNKVC.ADR.LNG#
     14536**DCL     14913>>DOINDEX 14979>>DOINDEX
KL$LNKVC.CUG
     14488**DCL     14532--REDEF
KL$LNKVC.CUG.BCD1#
     14513**DCL     14886>>ASSIGN  14950>>ASSIGN
KL$LNKVC.CUG.BCD2#
     14517**DCL     14888>>ASSIGN  14952>>ASSIGN
KL$LNKVC.CUG.BCD3#
     14524**DCL     14896>>ASSIGN  14955>>ASSIGN
KL$LNKVC.CUG.BCD4#
     14528**DCL     14898>>ASSIGN  14957>>ASSIGN
KL$LNKVC.CUG.LNG#
     14503**DCL     14885>>IF      14895>>IF      14941>>IF      14949>>IF
KL$LNKVC.DST#
     14555**DCL     14905--ASSIGN  14968--ASSIGN
KL$LNKVC.NODE#
     14575**DCL     14963>>IF      14965>>IF
KL$LNKVC.PERMANENT
     14594**DCL     14917>>IF      14989>>ASSIGN
KL$LNKVC.PRONM
     14559**DCL     14883--ASSIGN  14883--ASSIGN  14939--ASSIGN  14939--ASSIGN
KL$LNKVC.QOS#
     14587**DCL     14916--ASSIGN  14985--ASSIGN
KL$LNKVC.VIRCIR#
     14580**DCL     14881>>ASSIGN  14932>>ASSIGN
KL_DEFAULT.PASSWORD
     13771**DCL     13775--REDEF
KL_DEFAULT.RENAME
     13794**DCL     13795--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:149  
KL_DFLT.PASSWORD
     12961**DCL     12965--REDEF
KL_DFLT.RENAME
     12984**DCL     12985--REDEF
KL_DREC.PASSWORD
     12799**DCL     12803--REDEF
KL_DREC.RENAME
     12822**DCL     12823--REDEF
KL_DREC_CNT.PASSWORD
     12686**DCL     12690--REDEF
KL_DREC_CNT.RENAME
     12709**DCL     12710--REDEF
KL_LNKVC.CUG
     14744**DCL     14788--REDEF
KL_UBWORD.NUM
     14601**DCL     14602--REDEF
LINK$DREC.PASSWORD
     14102**DCL     14106--REDEF
LINK$DREC.RENAME
     14125**DCL     14126--REDEF
LINK_NAME
     14015**DCL         7--PROC    14934--ASSIGN
NEW_LINK
     14017**DCL         7--PROC    14874>>IF      14919>>IF
PERMANENT_STR
     14854**DCL     14923--ASSIGN
PERM_FMT
     14855**DCL     14920>>CALLBLT 14921--ASSIGN
PERM_JCL_FMT
     14857**DCL     14987>>ASSIGN  14988--ASSIGN
PROFILE_JCL_FMT
     14859**DCL     14936>>ASSIGN  14937--ASSIGN
PROJ_KEY.TEXT
     11033**DCL     11033--REDEF
PROJ_KEY.TXT.PROJECT
     11033**DCL     11033--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_VIRCIR File=ASL$LIST_VIRCIRS.:E05TSI             TUE 07/29/97 10:28 Page:150  
QOS_JCL_FMT
     14861**DCL     14983>>ASSIGN  14984--ASSIGN
REMEM_VAR
     11159**DCL     11159--REDEF
REM_FCMD
     11159**DCL     11160--REDEF
TEMP_NUMB
     14617**DCL     14881<<ASSIGN  14882--ASSIGN  14932<<ASSIGN  14933--ASSIGN  14989<<ASSIGN  14990--ASSIGN
TEXT$C.CNT
     14609**DCL     14610--IMP-SIZ 14883>>ASSIGN  14939>>ASSIGN
TEXT$C.TEXT
     14610**DCL     14883--ASSIGN  14939--ASSIGN
USERS_KEY.TEXT
     11030**DCL     11031--REDEF   11031--REDEF   11031--REDEF   11032--REDEF
VAL
     14618**DCL     14886<<ASSIGN  14887>>CALLBLT 14888<<ASSIGN  14889>>CALLBLT 14896<<ASSIGN  14897>>CALLBLT
     14898<<ASSIGN  14899>>CALLBLT 14908<<ASSIGN  14909>>CALLBLT 14910<<ASSIGN  14911>>CALLBLT 14950<<ASSIGN
     14951>>CALLBLT 14952<<ASSIGN  14953>>CALLBLT 14955<<ASSIGN  14956>>CALLBLT 14957<<ASSIGN  14958>>CALLBLT
     14974<<ASSIGN  14975>>CALLBLT 14976<<ASSIGN  14977>>CALLBLT
VIRCIR$
     14018**DCL         7--PROC    14389--IMP-PTR 14881>>ASSIGN  14883>>ASSIGN  14883>>ASSIGN  14885>>IF
     14886>>ASSIGN  14888>>ASSIGN  14895>>IF      14896>>ASSIGN  14898>>ASSIGN  14905>>ASSIGN  14908>>ASSIGN
     14910>>ASSIGN  14913>>DOINDEX 14916>>ASSIGN  14917>>IF      14932>>ASSIGN  14939>>ASSIGN  14939>>ASSIGN
     14941>>IF      14949>>IF      14950>>ASSIGN  14952>>ASSIGN  14955>>ASSIGN  14957>>ASSIGN  14963>>IF
     14965>>IF      14968>>ASSIGN  14974>>ASSIGN  14976>>ASSIGN  14979>>DOINDEX 14985>>ASSIGN  14989>>ASSIGN
VIRCIR_FMT
     14863**DCL     14878>>ASSIGN  14879--ASSIGN  14920>>CALLBLT 14921--ASSIGN
VIRCIR_HDR
     14865**DCL     14876<>CALL    14876--CALL
VIRCIR_JCL_CMD
     14867**DCL     14929>>ASSIGN  14930--ASSIGN
X$FORMAT
     14022**DCL-ENT 14926--CALL    14935--CALL    14940--CALL    14959--CALL    14969--CALL    14982--CALL
     14986--CALL    14991--CALL
