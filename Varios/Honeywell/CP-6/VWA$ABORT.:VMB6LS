VERSION B06

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:1    
        1        1        /*M* VWA$ABORT - Handle SCOTTY ghost aborts. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P**
        9        9        *
       10       10        *   NAME:  VWA$ABORT
       11       11        *
       12       12        *   PURPOSE:
       13       13        *       To handle SCOTTY aborts.
       14       14        *
       15       15        *   DESCRIPTION:
       16       16        *       This routine is entered if SCOTTY aborts.
       17       17        *
       18       18        ****/
       19       19
       20       20        /*D**
       21       21        *
       22       22        *   NAME:  VWA$ABORT
       23       23        *
       24       24        *   CALL:
       25       25        *       Asynchronous upon errors
       26       26        *
       27       27        *   PARAMETERS:
       28       28        *       None.  An exceptional condition frame exists.
       29       29        *
       30       30        *   INTERFACE:
       31       31        *       None, except that a M$LDTRC is performed if required.
       32       32        *
       33       33        *   ENVIRONMENT:
       34       34        *       An exceptional condition frame exists.
       35       35        *
       36       36        *   INPUT:
       37       37        *       None.
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:2    
       38       38        *
       39       39        *   OUTPUT:
       40       40        *       VW_OPERERR# is set to '1'B if the operator has errored SCOTTY.
       41       41        *       This will result in SCOTTY closing and reopening the :NODES file.
       42       42        *
       43       43        *   SCRATCH:
       44       44        *       None.
       45       45        *
       46       46        *   DESCRIPTION:
       47       47        *       VWA$ABORT is entered if SCOTTY aborts.  At this point, we will
       48       48        *       try to delete the file which is causing us to abort, dump some
       49       49        *       stuff (via DELTA), then M$LDTRC back to ourself to restart.
       50       50        *       If the operator errors us, signal that a close and reopen of the
       51       51        *       :NODES file is required.  This will allow the replacement of the
       52       52        *       :NODES file without having to abort the SCOTTY ghost.
       53       53        *
       54       54        ****/
       55       55
       56       56        VWA$ABORT: PROC ASYNC;
       57       57
       58       58        /****
       59       59        *
       60       60        *   %INCLUDEs
       61       61        *
       62       62        ****/
       63       63
       64       64        %INCLUDE CP_6;
       65     5623        %INCLUDE B$JIT;
       66     6226
       67     6227        /****
       68     6228        *
       69     6229        *   FPTs
       70     6230        *
       71     6231        ****/
       72     6232
       73     6233        %FPT_CLOSE(DCB=M$JI,
       74     6234                   DISP=RELEASE);
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:3    
       75     6276
       76     6277        %FPT_ALIB(LIBNAME=NAME_DELTA,
       77     6278                  CMD=CMDBUF,
       78     6279                  DLIB=YES,
       79     6280                  RETRN=YES);
       80     6297
       81     6298        %VLP_NAME(FPTN=NAME_DELTA,
       82     6299                  LEN=5,
       83     6300                  NAME='DELTA');
       84     6327
       85     6328        %FPT_GJOB(CCBUF=MYNAME);
       86     6345
       87     6346        %FPT_KEYIN(OCTYPE=SYSTEM);
       88     6365
       89     6366        %FPT_XCON;
       90     6380
       91     6381        %B$TCB;
       92     6384        %B$XCON;
       93     6394
       94     6395        %F$DCB(DCBN=DUMMY);
       95     6452
       96     6453        /****
       97     6454        *
       98     6455        *   Local variables
       99     6456        *
      100     6457        ****/
      101     6458
      102     6459    1   DCL M$JI                           DCB;
      103     6460    1   DCL M$LM                           DCB;
      104     6461
      105     6462    1   DCL B$JIT$ SYMREF                  PTR;
      106     6463    1   DCL B$TCB$ SYMREF                  PTR;
      107     6464
      108     6465    1   DCL I                              SBIN;
      109     6466
      110     6467    1   DCL VW_OPERERR# STATIC SYMDEF      BIT(1) INIT('0'B);
      111     6468
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:4    
      112     6469    1   DCL CMDBUF CONSTANT                CHAR(80) INIT
      113     6470    1           ('PMD JIT,PL,TCB,AUTO,DCB');
      114     6471
      115     6472    1   DCL MYNAME STATIC                  CHAR(80);
      116     6473
      117     6474    1   DCL ABRTMSG(0:4) CONSTANT          CHAR(24) INIT(
      118     6475    1           '************************',
      119     6476    1           '*                      *',
      120     6477    1           '* SCOTTY HAS ABORTED!! *',
      121     6478    1           '*                      *',
      122     6479    1           '************************');
      123     6480
      124     6481        %EJECT;
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:5    
      125     6482        /****
      126     6483        *
      127     6484        *   If the operator has errored us, set the flag so :NODES
      128     6485        *   will be closed and reopened later; then ignore the error.
      129     6486        *
      130     6487        ****/
      131     6488
      132     6489    2           IF B$TCB$->B$TCB.STK$->B$XCON.RNST.OPERR THEN DO;
      133     6490    2              VW_OPERERR#='1'B;
      134     6491    2              CALL M$TRTN;
      135     6492    2              END;
      136     6493
      137     6494        /****
      138     6495        *
      139     6496        *   Resume our normal identity for the dump.  This will cause a
      140     6497        *   loop if SCOTTY hasn't been invoked with his privileges intact
      141     6498        *   (i.e., from .:SYS), since the JIT will be write-protected.
      142     6499        *
      143     6500        ****/
      144     6501
      145     6502    1           B$JIT.ACCN=':MOVE';
      146     6503    1           B$JIT.UNAME='SCOTTY';
      147     6504    1           B$JIT.JOBNAME='I USED TO BE THE SCOTTY GHOST';
      148     6505
      149     6506        /****
      150     6507        *
      151     6508        *   Reset exit control.  If the operator aborted us, go quietly.
      152     6509        *
      153     6510        ****/
      154     6511
      155     6512    1           CALL M$XCON(FPT_XCON);
      156     6513    1           IF B$TCB$->B$TCB.STK$->B$XCON.RNST.OPXXX THEN
      157     6514    1              CALL M$EXIT;
      158     6515
      159     6516        /****
      160     6517        *
      161     6518        *   If M$JI is open, close and trash it.
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:6    
      162     6519        *
      163     6520        ****/
      164     6521
      165     6522    1           IF DCBADDR(DCBNUM(M$JI))->DUMMY.FCD# THEN
      166     6523    2              CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO;
      167     6524    2                 CALL M$ALIB(FPT_ALIB);
      168     6525    2                 GOTO GAG;
      169     6526    2                 END;
      170     6527
      171     6528        /****
      172     6529        *
      173     6530        *   Dump, then M$GJOB back to myself.  We find "our" name in the M$LM
      174     6531        *   DCB.
      175     6532        *
      176     6533        ****/
      177     6534
      178     6535    1           CALL M$ALIB(FPT_ALIB);
      179     6536    1           MYNAME=SUBSTR(DCBADDR(DCBNUM(M$LM))->DUMMY.NAME#.C,0,
      180     6537    1             DCBADDR(DCBNUM(M$LM))->DUMMY.NAME#.L);
      181     6538    1           CALL M$GJOB(FPT_GJOB) ALTRET(GAG);
      182     6539    1           CALL M$ERR;
      183     6540
      184     6541        /****
      185     6542        *
      186     6543        *   We should never get here.  If we do, something disastrous has
      187     6544        *   happened.  Barf on the operator's console and give up.
      188     6545        *
      189     6546        ****/
      190     6547
      191     6548    1   GAG:
      192     6549    1           FPT_KEYIN.MESS_.BOUND=LENGTHC(ABRTMSG(0))-1;
      193     6550    2           DO I=0 TO 4;
      194     6551    2              FPT_KEYIN.MESS_.BUF$=ADDR(ABRTMSG(I));
      195     6552    2              CALL M$KEYIN(FPT_KEYIN);
      196     6553    2              END;
      197     6554    1           CALL M$XXX;
      198     6555
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:7    
      199     6556    1   END;

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:8    
--  Include file information  --

   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VWA$ABORT.

   Procedure VWA$ABORT requires 86 words for executable code.
   Procedure VWA$ABORT requires 4 words of local(AUTO) storage.

    No errors detected in file VWA$ABORT.:VMB6TSI    .

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:9    

 Object Unit name= VWA$ABORT                                  File name= VWA$ABORT.:VMB6TOU
 UTS= AUG 20 '97 15:36:54.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    97    141  VWA$ABORT
    2   DCB   even  none     0      0  M$JI
    3   DCB   even  none     0      0  M$LM
    4  RoData even  UTS     62     76  VWA$ABORT
    5   Proc  even  none    86    126  VWA$ABORT
    6  RoData even  none     3      3  VWA$ABORT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes     Async       0  VWA$ABORT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    114  VW_OPERERR#

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:10   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$JI                                  M$LM
     B$JIT$                                B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:11   


        1        1        /*M* VWA$ABORT - Handle SCOTTY ghost aborts. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P**
        9        9        *
       10       10        *   NAME:  VWA$ABORT
       11       11        *
       12       12        *   PURPOSE:
       13       13        *       To handle SCOTTY aborts.
       14       14        *
       15       15        *   DESCRIPTION:
       16       16        *       This routine is entered if SCOTTY aborts.
       17       17        *
       18       18        ****/
       19       19
       20       20        /*D**
       21       21        *
       22       22        *   NAME:  VWA$ABORT
       23       23        *
       24       24        *   CALL:
       25       25        *       Asynchronous upon errors
       26       26        *
       27       27        *   PARAMETERS:
       28       28        *       None.  An exceptional condition frame exists.
       29       29        *
       30       30        *   INTERFACE:
       31       31        *       None, except that a M$LDTRC is performed if required.
       32       32        *
       33       33        *   ENVIRONMENT:
       34       34        *       An exceptional condition frame exists.
       35       35        *
       36       36        *   INPUT:
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:12   
       37       37        *       None.
       38       38        *
       39       39        *   OUTPUT:
       40       40        *       VW_OPERERR# is set to '1'B if the operator has errored SCOTTY.
       41       41        *       This will result in SCOTTY closing and reopening the :NODES file.
       42       42        *
       43       43        *   SCRATCH:
       44       44        *       None.
       45       45        *
       46       46        *   DESCRIPTION:
       47       47        *       VWA$ABORT is entered if SCOTTY aborts.  At this point, we will
       48       48        *       try to delete the file which is causing us to abort, dump some
       49       49        *       stuff (via DELTA), then M$LDTRC back to ourself to restart.
       50       50        *       If the operator errors us, signal that a close and reopen of the
       51       51        *       :NODES file is required.  This will allow the replacement of the
       52       52        *       :NODES file without having to abort the SCOTTY ghost.
       53       53        *
       54       54        ****/
       55       55
       56       56        VWA$ABORT: PROC ASYNC;

     56  5 000000   000000 700200 xent  VWA$ABORT    TSX0  ! X66_AAUTO
         5 000001   000004 000000                    ZERO    4,0

       57       57
       58       58        /****
       59       59        *
       60       60        *   %INCLUDEs
       61       61        *
       62       62        ****/
       63       63
       64       64        %INCLUDE CP_6;
       65     5623        %INCLUDE B$JIT;
       66     6226
       67     6227        /****
       68     6228        *
       69     6229        *   FPTs
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:13   
       70     6230        *
       71     6231        ****/
       72     6232
       73     6233        %FPT_CLOSE(DCB=M$JI,
       74     6234                   DISP=RELEASE);
       75     6276
       76     6277        %FPT_ALIB(LIBNAME=NAME_DELTA,
       77     6278                  CMD=CMDBUF,
       78     6279                  DLIB=YES,
       79     6280                  RETRN=YES);
       80     6297
       81     6298        %VLP_NAME(FPTN=NAME_DELTA,
       82     6299                  LEN=5,
       83     6300                  NAME='DELTA');
       84     6327
       85     6328        %FPT_GJOB(CCBUF=MYNAME);
       86     6345
       87     6346        %FPT_KEYIN(OCTYPE=SYSTEM);
       88     6365
       89     6366        %FPT_XCON;
       90     6380
       91     6381        %B$TCB;
       92     6384        %B$XCON;
       93     6394
       94     6395        %F$DCB(DCBN=DUMMY);
       95     6452
       96     6453        /****
       97     6454        *
       98     6455        *   Local variables
       99     6456        *
      100     6457        ****/
      101     6458
      102     6459    1   DCL M$JI                           DCB;
      103     6460    1   DCL M$LM                           DCB;
      104     6461
      105     6462    1   DCL B$JIT$ SYMREF                  PTR;
      106     6463    1   DCL B$TCB$ SYMREF                  PTR;
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:14   
      107     6464
      108     6465    1   DCL I                              SBIN;
      109     6466
      110     6467    1   DCL VW_OPERERR# STATIC SYMDEF      BIT(1) INIT('0'B);
      111     6468
      112     6469    1   DCL CMDBUF CONSTANT                CHAR(80) INIT
      113     6470    1           ('PMD JIT,PL,TCB,AUTO,DCB');
      114     6471
      115     6472    1   DCL MYNAME STATIC                  CHAR(80);
      116     6473
      117     6474    1   DCL ABRTMSG(0:4) CONSTANT          CHAR(24) INIT(
      118     6475    1           '************************',
      119     6476    1           '*                      *',
      120     6477    1           '* SCOTTY HAS ABORTED!! *',
      121     6478    1           '*                      *',
      122     6479    1           '************************');
      123     6480
      124     6481        %EJECT;
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:15   
      125     6482        /****
      126     6483        *
      127     6484        *   If the operator has errored us, set the flag so :NODES
      128     6485        *   will be closed and reopened later; then ignore the error.
      129     6486        *
      130     6487        ****/
      131     6488
      132     6489    2           IF B$TCB$->B$TCB.STK$->B$XCON.RNST.OPERR THEN DO;

   6489  5 000002   000000 470400 xsym               LDP0    B$TCB$
         5 000003   000001 471500                    LDP1    1,,PR0
         5 000004   100101 236100                    LDQ     65,,PR1
         5 000005   020000 316003                    CANQ    8192,DU
         5 000006   000013 600000 5                  TZE     s:6502

      133     6490    2              VW_OPERERR#='1'B;

   6490  5 000007   400000 236003                    LDQ     -131072,DU
         5 000010   000114 756000 1                  STQ     VW_OPERERR#

      134     6491    2              CALL M$TRTN;

   6491  5 000011   010012 713400                    CLIMB   4106
         5 000012   000000 401760                    pmme    nvectors=0

      135     6492    2              END;

      136     6493
      137     6494        /****
      138     6495        *
      139     6496        *   Resume our normal identity for the dump.  This will cause a
      140     6497        *   loop if SCOTTY hasn't been invoked with his privileges intact
      141     6498        *   (i.e., from .:SYS), since the JIT will be write-protected.
      142     6499        *
      143     6500        ****/
      144     6501
      145     6502    1           B$JIT.ACCN=':MOVE';
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:16   

   6502  5 000013   000000 470400 xsym               LDP0    B$JIT$
         5 000014   040100 100400                    MLR     fill='040'O
         5 000015   000062 000005 4                  ADSC9   ABRTMSG+30               cn=0,n=5
         5 000016   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

      146     6503    1           B$JIT.UNAME='SCOTTY';

   6503  5 000017   040100 100400                    MLR     fill='040'O
         5 000020   000064 000006 4                  ADSC9   ABRTMSG+32               cn=0,n=6
         5 000021   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12

      147     6504    1           B$JIT.JOBNAME='I USED TO BE THE SCOTTY GHOST';

   6504  5 000022   040100 100400                    MLR     fill='040'O
         5 000023   000066 000035 4                  ADSC9   ABRTMSG+34               cn=0,n=29
         5 000024   000156 200037                    ADSC9   110,,PR0                 cn=1,n=31

      148     6505
      149     6506        /****
      150     6507        *
      151     6508        *   Reset exit control.  If the operator aborted us, go quietly.
      152     6509        *
      153     6510        ****/
      154     6511
      155     6512    1           CALL M$XCON(FPT_XCON);

   6512  5 000025   000106 630400 1                  EPPR0   FPT_XCON
         5 000026   010003 713400                    CLIMB   4099
         5 000027   400400 401760                    pmme    nvectors=2

      156     6513    1           IF B$TCB$->B$TCB.STK$->B$XCON.RNST.OPXXX THEN

   6513  5 000030   000000 470400 xsym               LDP0    B$TCB$
         5 000031   000001 471500                    LDP1    1,,PR0
         5 000032   100101 234100                    SZN     65,,PR1
         5 000033   000036 605000 5                  TPL     s:6522
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:17   

      157     6514    1              CALL M$EXIT;

   6514  5 000034   000001 713400                    CLIMB   exit
         5 000035   000000 401760                    pmme    nvectors=0

      158     6515
      159     6516        /****
      160     6517        *
      161     6518        *   If M$JI is open, close and trash it.
      162     6519        *
      163     6520        ****/
      164     6521
      165     6522    1           IF DCBADDR(DCBNUM(M$JI))->DUMMY.FCD# THEN

   6522  5 000036   000000 236007 xsym               LDQ     M$JI,DL
         5 000037   000000 470400 6                  LDP0    0
         5 000040   000000 471500                    LDP1    0,,PR0
         5 000041   100000 473506                    LDP3    0,QL,PR1
         5 000042   300031 236100                    LDQ     25,,PR3
         5 000043   020000 316007                    CANQ    8192,DL
         5 000044   000056 600000 5                  TZE     s:6535

      166     6523    2              CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN DO;

   6523  5 000045   000000 630400 1                  EPPR0   FPT_CLOSE
         5 000046   450001 713400                    CLIMB   alt,close
         5 000047   406000 401760                    pmme    nvectors=13
         5 000050   000052 702000 5                  TSX2    s:6524
         5 000051   000056 710000 5                  TRA     s:6535

      167     6524    2                 CALL M$ALIB(FPT_ALIB);

   6524  5 000052   000036 630400 1                  EPPR0   FPT_ALIB
         5 000053   000007 713400                    CLIMB   7
         5 000054   401400 401760                    pmme    nvectors=4

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:18   
      168     6525    2                 GOTO GAG;

   6525  5 000055   000103 710000 5                  TRA     GAG

      169     6526    2                 END;
      170     6527
      171     6528        /****
      172     6529        *
      173     6530        *   Dump, then M$GJOB back to myself.  We find "our" name in the M$LM
      174     6531        *   DCB.
      175     6532        *
      176     6533        ****/
      177     6534
      178     6535    1           CALL M$ALIB(FPT_ALIB);

   6535  5 000056   000036 630400 1                  EPPR0   FPT_ALIB
         5 000057   000007 713400                    CLIMB   7
         5 000060   401400 401760                    pmme    nvectors=4

      179     6536    1           MYNAME=SUBSTR(DCBADDR(DCBNUM(M$LM))->DUMMY.NAME#.C,0,

   6536  5 000061   000000 236007 xsym               LDQ     M$LM,DL
         5 000062   000000 470400 6                  LDP0    0
         5 000063   000000 471500                    LDP1    0,,PR0
         5 000064   100000 473506                    LDP3    0,QL,PR1
         5 000065   000000 236007 xsym               LDQ     M$LM,DL
         5 000066   100000 474506                    LDP4    0,QL,PR1
         5 000067   400010 236100                    LDQ     8,,PR4
         5 000070   000033 772000                    QRL     27
         5 000071   000000 620006                    EAX0    0,QL
         5 000072   040000 100540                    MLR     fill='040'O
         5 000073   300010 200010                    ADSC9   8,,PR3                   cn=1,n=*X0
         5 000074   000115 000120 1                  ADSC9   MYNAME                   cn=0,n=80

      180     6537    1             DCBADDR(DCBNUM(M$LM))->DUMMY.NAME#.L);
      181     6538    1           CALL M$GJOB(FPT_GJOB) ALTRET(GAG);

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:19   
   6538  5 000075   000052 630400 1                  EPPR0   FPT_GJOB
         5 000076   420022 713400                    CLIMB   alt,+8210
         5 000077   402400 401760                    pmme    nvectors=6
         5 000100   000103 702000 5                  TSX2    GAG

      182     6539    1           CALL M$ERR;

   6539  5 000101   000002 713400                    CLIMB   err
         5 000102   000000 401760                    pmme    nvectors=0

      183     6540
      184     6541        /****
      185     6542        *
      186     6543        *   We should never get here.  If we do, something disastrous has
      187     6544        *   happened.  Barf on the operator's console and give up.
      188     6545        *
      189     6546        ****/
      190     6547
      191     6548    1   GAG:
      192     6549    1           FPT_KEYIN.MESS_.BOUND=LENGTHC(ABRTMSG(0))-1;

   6549  5 000103   000072 236000 1     GAG          LDQ     FPT_KEYIN+2
         5 000104   177777 376007                    ANQ     65535,DL
         5 000105   000001 276000 6                  ORQ     1
         5 000106   000072 756000 1                  STQ     FPT_KEYIN+2

      193     6550    2           DO I=0 TO 4;

   6550  5 000107   200003 450100                    STZ     I,,AUTO

      194     6551    2              FPT_KEYIN.MESS_.BUF$=ADDR(ABRTMSG(I));

   6551  5 000110   200003 236100                    LDQ     I,,AUTO
         5 000111   000006 402003                    MPY     6,DU
         5 000112   000002 036000 6                  ADLQ    2
         5 000113   000073 756000 1                  STQ     FPT_KEYIN+3

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:20   
      195     6552    2              CALL M$KEYIN(FPT_KEYIN);

   6552  5 000114   000070 630400 1                  EPPR0   FPT_KEYIN
         5 000115   120000 713400                    CLIMB   40960
         5 000116   401400 401760                    pmme    nvectors=4

      196     6553    2              END;

   6553  5 000117   200003 054100                    AOS     I,,AUTO
         5 000120   200003 235100                    LDA     I,,AUTO
         5 000121   000004 115007                    CMPA    4,DL
         5 000122   000110 604400 5                  TMOZ    s:6551

      197     6554    1           CALL M$XXX;

   6554  5 000123   000003 713400                    CLIMB   3
         5 000124   000000 401760                    pmme    nvectors=0

      198     6555
      199     6556    1   END;

   6556  5 000125   000000 702200 xent               TSX2  ! X66_AARET

FPT_CLOSE
 Sect OctLoc
   1     000   000003 777640   000032 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     030*  000000 177640   000000 006014   000000 000001   000000 000040    ...............
   1     034   000220 000000   000000 000000                                    ........

FPT_ALIB
 Sect OctLoc
   1     036   000001 377640   000050 006000   000023 777640   000000 006000    .....(..........
   1     042   000000 177640   000000 006014   000001 777640   000046 006000    .............&..
   1     046   600000 000000   000000 000000                                    ........

NAME_DELTA
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:21   
 Sect OctLoc
   1     050   005104 105114   124101 ******                                    .DELTA..

FPT_GJOB
 Sect OctLoc
   1     052   000001 777640   000066 006000   000000 177640   000000 006014    .....6..........
   1     056   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     062   000023 777640   000115 006000   000000 177640   000000 006014    .....M..........
   1     066   000000 000000   000000 000000                                    ........

FPT_KEYIN
 Sect OctLoc
   1     070   000005 777640   000100 006000   000000 17764*   000000 006014    .....@..........
   1     074   000000 17764*   000000 006014   000000 177640   000000 006014    ................
   1     100   040040 040040   040040 040040   000000 000000   401000 000000            ........
   1     104   000000 000000   000000 000000                                    ........

FPT_XCON
 Sect OctLoc
   1     106   000001 777640   000112 006000   000000 177640   000000 006014    .....J..........
   1     112   000000 000000   000000 000000                                    ........

VW_OPERERR#
 Sect OctLoc
   1     114   0***** ******                                                    ....

MYNAME
 Sect OctLoc
   1     115   ****** ******   ****** ******   ****** ******   ****** ******    ................

CMDBUF
 Sect OctLoc
   4     000   120115 104040   112111 124054   120114 054124   103102 054101    PMD JIT,PL,TCB,A
   4     004   125124 117054   104103 102040   040040 040040   040040 040040    UTO,DCB
   4     010   040040 040040   040040 040040   040040 040040   040040 040040
   4     020*  040040 040040   040040 040040   040040 040040   040040 040040

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:22   
ABRTMSG
 Sect OctLoc
   4     024   052052 052052   052052 052052   052052 052052   052052 052052    ****************
   4     030   052052 052052   052052 052052   052040 040040   040040 040040    *********
   4     034   040040 040040   040040 040040   040040 040040   040040 040052                   *
   4     040   052040 123103   117124 124131   040110 101123   040101 102117    * SCOTTY HAS ABO
   4     044   122124 105104   041041 040052   052040 040040   040040 040040    RTED!! **
   4     050   040040 040040   040040 040040   040040 040040   040040 040052                   *
   4     054   052052 052052   052052 052052   052052 052052   052052 052052    ****************
   4     060   052052 052052   052052 052052                                    ********

(unnamed)
 Sect OctLoc
   4     062   072115 117126   105040 040040   123103 117124   124131 040040    :MOVE   SCOTTY
   4     066   111040 125123   105104 040124   117040 102105   040124 110105    I USED TO BE THE
   4     072   040123 103117   124124 131040   107110 117123   124040 040040     SCOTTY GHOST

(unnamed)
 Sect OctLoc
   6     000   000000 006003   000005 600000   000024 006000                    ............

PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:23   
--  Include file information  --

   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VWA$ABORT.
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:24   

 **** Variables and constants ****

  ****  Section 001  Data  VWA$ABORT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/d STRC(360)   r     1 FPT_ALIB                   0-0-0/d STRC(1080)  r     1 FPT_CLOSE
    52-0-0/d STRC(504)   r     1 FPT_GJOB                  70-0-0/d STRC(504)   r     1 FPT_KEYIN
   106-0-0/d STRC(216)   r     1 FPT_XCON                 115-0-0/c CHAR(80)    r     1 MYNAME
    50-0-0/c STRC(54)    r     1 NAME_DELTA               114-0-0/b BIT         r     1 VW_OPERERR#

  ****  Section 004 RoData VWA$ABORT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/c CHAR(24)    r     1 ABRTMSG(0:4)
     0-0-0/c CHAR(80)    r     1 CMDBUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 I

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:25   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(2448)  r     1 B$XCON                     0-0-0/d ASTR(3528)  r     1 DUMMY
     0-0-0N  NULL        r     1 M$JI                       0-0-0N  NULL        r     1 M$LM
     0-0-0N  NULL        r     1 M$UC


   Procedure VWA$ABORT requires 86 words for executable code.
   Procedure VWA$ABORT requires 4 words of local(AUTO) storage.

    No errors detected in file VWA$ABORT.:VMB6TSI    .
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:26   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:27   
          MINI XREF LISTING

ABRTMSG
      6474**DCL      6549--ASSIGN   6551--ASSIGN
B$JIT.ACCN
      5950**DCL      6502<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      6044**DCL      6044--REDEF
B$JIT.ERR.MID
      5951**DCL      5951--REDEF
B$JIT.JOBNAME
      6099**DCL      6504<<ASSIGN
B$JIT.JRESPEAK
      6112**DCL      6113--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6221**DCL      6221--REDEF    6222--REDEF
B$JIT.PNR
      6125**DCL      6125--REDEF
B$JIT.TSLINE
      6219**DCL      6220--REDEF
B$JIT.UNAME
      5950**DCL      6503<<ASSIGN
B$JIT$
      6462**DCL      5945--IMP-PTR  6502>>ASSIGN   6503>>ASSIGN   6504>>ASSIGN
B$TCB.STK$
      6382**DCL      6489>>IF       6513>>IF
B$TCB$
      6463**DCL      6489>>IF       6513>>IF
B$XCON.ERR.ERR#
      6391**DCL      6391--REDEF
B$XCON.LIMIT.MEM
      6389**DCL      6389--REDEF
B$XCON.RNST.OPERR
      6387**DCL      6489>>IF
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:28   
B$XCON.RNST.OPXXX
      6386**DCL      6513>>IF
CMDBUF
      6469**DCL      6291--DCLINIT
DUMMY.ACTPOS
      6428**DCL      6428--REDEF
DUMMY.ARS#
      6402**DCL      6402--REDEF
DUMMY.ATTR
      6421**DCL      6422--REDEF
DUMMY.BORROW
      6436**DCL      6436--REDEF    6436--REDEF    6436--REDEF
DUMMY.DCBNAME.L
      6450**DCL      6450--IMP-SIZ
DUMMY.EOMCHAR#
      6406**DCL      6406--REDEF
DUMMY.FCD#
      6415**DCL      6522>>IF
DUMMY.FLDID
      6431**DCL      6431--REDEF
DUMMY.FORM$
      6425**DCL      6425--REDEF
DUMMY.FSECT
      6441**DCL      6441--REDEF
DUMMY.FSN#
      6418**DCL      6418--REDEF    6418--REDEF    6419--REDEF
DUMMY.HEADER$
      6424**DCL      6424--REDEF
DUMMY.IXTNSIZE#
      6422**DCL      6422--REDEF
DUMMY.LASTSTA$
      6411**DCL      6411--REDEF
DUMMY.LVL
      6437**DCL      6437--REDEF
DUMMY.NAME#.C
      6412**DCL      6412--REDEF    6536>>ASSIGN
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:29   
DUMMY.NAME#.L
      6412**DCL      6536>>ASSIGN
DUMMY.NOEOF
      6434**DCL      6434--REDEF
DUMMY.NRECS#
      6423**DCL      6423--REDEF
DUMMY.NRECX
      6442**DCL      6442--REDEF
DUMMY.OHDR
      6434**DCL      6434--REDEF
DUMMY.ORG#
      6417**DCL      6417--REDEF
DUMMY.PRECNO
      6440**DCL      6440--REDEF
DUMMY.RCSZ
      6446**DCL      6446--REDEF
DUMMY.RES#
      6413**DCL      6413--REDEF
DUMMY.SETX
      6425**DCL      6425--REDEF
DUMMY.TAB$
      6425**DCL      6425--REDEF
DUMMY.TDA
      6439**DCL      6440--REDEF
DUMMY.WSN#
      6413**DCL      6413--REDEF
FPT_ALIB
      6291**DCL      6524<>CALL     6535<>CALL
FPT_ALIB.V
      6292**DCL      6292--DCLINIT
FPT_CLOSE
      6257**DCL      6523<>CALL
FPT_CLOSE.SN_
      6257**DCL      6257--REDEF
FPT_CLOSE.UTL_
      6258**DCL      6258--REDEF
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:30   
FPT_CLOSE.V
      6262**DCL      6257--DCLINIT
FPT_CLOSE.V.EXPIRE#
      6272**DCL      6272--REDEF
FPT_CLOSE.V.TYPE#
      6270**DCL      6270--REDEF
FPT_CLOSE.V.XTNSIZE#
      6267**DCL      6267--REDEF    6269--REDEF
FPT_GJOB
      6339**DCL      6538<>CALL
FPT_GJOB.V
      6341**DCL      6339--DCLINIT
FPT_KEYIN
      6357**DCL      6552<>CALL
FPT_KEYIN.MESS_.BOUND
      6357**DCL      6549<<ASSIGN
FPT_KEYIN.MESS_.BUF$
      6358**DCL      6551<<ASSIGN
FPT_KEYIN.V
      6360**DCL      6357--DCLINIT
FPT_XCON
      6377**DCL      6512<>CALL
FPT_XCON.V
      6378**DCL      6377--DCLINIT
GAG
      6549**LABEL    6525--GOTO     6538--CALLALT
I
      6465**DCL      6550<<DOINDEX  6551>>ASSIGN
M$ALIB
      5564**DCL-ENT  6524--CALL     6535--CALL
M$CLOSE
      5551**DCL-ENT  6523--CALL
M$ERR
      5563**DCL-ENT  6539--CALL
M$EXIT
      5563**DCL-ENT  6514--CALL
PL6.E3A0      #001=VWA$ABORT File=VWA$ABORT.:VMB6TSI                             WED 08/20/97 15:36 Page:31   
M$GJOB
      5616**DCL-ENT  6538--CALL
M$JI
      6459**DCL      6522--IF
M$KEYIN
      5556**DCL-ENT  6552--CALL
M$LM
      6460**DCL      6536--ASSIGN   6536--ASSIGN
M$TRTN
      5609**DCL-ENT  6491--CALL
M$XCON
      5606**DCL-ENT  6512--CALL
M$XXX
      5563**DCL-ENT  6554--CALL
MYNAME
      6472**DCL      6340--DCLINIT  6536<<ASSIGN
NAME_DELTA
      6325**DCL      6291--DCLINIT
VW_OPERERR#
      6467**DCL      6490<<ASSIGN
