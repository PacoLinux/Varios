VERSION E05

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:1    
        1        1        /*M* ASC$OPTS: EXTERNAL ROUTINES FOR CREATE AND MODIFY OPTIONS. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*    Tabs 7,11,13,15,17,19,21,23,25,27,29,31,40,55,60   */
       11       11        /*    I   i i i i i i i i i i i        i              i    i  */
       12       12                                                              /**/
       13       13        /*  ASC$OPTS:   This module consists of procedures:
       14       14                        ASC$CM_OPTS
       15       15                        ASC$MOD_USER
       16       16        */
       17       17        /**/
       18       18        /********************************************************************/
       19       19        /*                                                                   */
       20       20        /*                   ASC$CM_OPTS         proc                        */
       21       21        /*                                                                   */
       22       22        /*********************************************************************/
       23       23                                                              /**/
       24       24        ASC$CM_OPTS: PROC (CR_MOD_KEY) ;
       25       25                                                              /**/
       26       26        %SET LISTSUB = '1'B ;
       27       27        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:2    
       28       28        /********************************************************************/
       29       29        /*   Parameters      parameters      parameters      parameters      */
       30       30        /*********************************************************************/
       31       31                                                              /**/
       32       32    1   DCL 1 CR_MOD_KEY ALIGNED ,
       33       33    1          2 CNT UBIN(9) UNAL ,
       34       34    1          2 TEXT CHAR(20) UNAL ;
       35       35                                                              /**/
       36       36        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:3    
       37       37        /********************************************************************/
       38       38        /*   Include files   include files   include files   include files   */
       39       39        /*********************************************************************/
       40       40                                                              /**/
       41       41        %INCLUDE      AS_ENTRIES_M ;
       42     1091        %INCLUDE      AS_SUPER_C ;
       43     1526        %INCLUDE      AS_SUBS_C ;
       44     2940        %INCLUDE      AS_PERR_C ;
       45     3542        %INCLUDE      KL_SUPER_C ;
       46     6444        %INCLUDE      AS_MAC_C ;
       47     6524        %INCLUDE      XU_MACRO_C ;
       48     9630        %INCLUDE      XU_FORMAT_C ;
       49     9792        %INCLUDE      CP_6 ;
       50     9873        %INCLUDE      CP_6_SUBS;
       51    10413        %INCLUDE      AS_SUPER_R ;
       52    13429                                                              /**/
       53    13430        %FPT_TIME (FPTN = MAKE_UTS,
       54    13431                    DATE = DATE_BUF,
       55    13432                    TIME = TIME_BUF,
       56    13433                    SOURCE = LOCAL,
       57    13434                    DEST = UTS,
       58    13435                    TSTAMP = UTS_BUF);
       59    13454        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:4    
       60    13455        /********************************************************************/
       61    13456        /*   Static data     static data     static data     static data     */
       62    13457        /*********************************************************************/
       63    13458                                                              /**/
       64    13459    1   DCL MORE BIT(1) STATIC ;
       65    13460    1   DCL FE_MODE BIT(1) STATIC ;
       66    13461    1   DCL 1 TEXTC(0:2) CONSTANT,
       67    13462    1          2 CNT UBIN BYTE UNAL INIT( 4, 6, 17 ),
       68    13463    1          2 TEXT CHAR(17) INIT( 'user', 'project', 'user in a project' );
       69    13464    1   DCL 1 ALL_KEYS CONSTANT ALIGNED,
       70    13465    1          2 * BIT(36) INIT('777777777777'O),
       71    13466    1          2 * BIT(36) INIT('777777777777'O);
       72    13467                                                              /**/
       73    13468        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:5    
       74    13469        /********************************************************************/
       75    13470        /*   Local based     local based     local based     local based     */
       76    13471        /*********************************************************************/
       77    13472                                                              /**/
       78    13473            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       79    13474                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       80    13519              %PARSE$SYM( NAME = OUT$SYM ,
       81    13520                          STCLASS="BASED(BLK$)") ;
       82    13558    1   DCL 1 VARY$STR BASED(STR$) ALIGNED ,
       83    13559    1          2 CNT UBIN(9) UNAL ,
       84    13560    1          2 TEXT CHAR(VARY$STR.CNT) ;
       85    13561    1   DCL BIT$72 BIT(72) BASED ALIGNED;
       86    13562        %SUPER_TO_PIG( STCLASS="BASED(AS_SUPER_TO_PIG$)" );
       87    13594                                                              /**/
       88    13595    1   DCL ACHAR CHAR(1) BASED;
       89    13596    1   DCL ABYTE UBIN(9) BASED;
       90    13597        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:6    
       91    13598        /********************************************************************/
       92    13599        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       93    13600        /*********************************************************************/
       94    13601                                                              /**/
       95    13602    1   DCL X$PARSE ENTRY(1) ALTRET ;
       96    13603        %ASB$READ_SI ;
       97    13606        %ASB$SET_PROMPT ;
       98    13609        %ASC$PRIV ;
       99    13612        %ASC$PPRIV ;
      100    13615        %ASC$FEPRIV ;
      101    13618        %ASC$FEPPRIV ;
      102    13621        %ASC$BUDGET ;
      103    13624        %ASC$TIME ;
      104    13627        %ASC$MEMORY ;
      105    13630        %ASC$SERVICE ;
      106    13633        %ASC$EXPIRE ;
      107    13636        %ASB$LEGL_CHAR ;
      108    13639        %ASZ$SCRAMBLE ;
      109    13642        %ASC$OUTPUTPRIO ;
      110    13645        %ASC$RESOURCE ;
      111    13648        %ASC$FERESOURCE ;
      112    13651        %ASC$PSEUDO ;
      113    13654        %ASC$FEPSEUDO ;
      114    13657        %ASH$HELP ;
      115    13660        %ASH$DQUEST ;
      116    13663        %ASH$QUEST ;
      117    13666        %ASH$ERROR ;
      118    13669        %ASH$WARN ;
      119    13672        %ASB$READ_PROJ ;
      120    13675        %ASB$ACCT_OK ;
      121    13678        %ASB$PIG_ACCT_ATTR ;
      122    13681        %ASB$PIG ;
      123    13684        %ASW$PREC_WSN ;
      124    13687        %ASD$PREC_PRO ;
      125    13690        %ASC$BANNER ;
      126    13693        %ASC$SETUP ;
      127    13696                                                              /**/
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:7    
      128    13697                                                              /**/
      129    13698        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:8    
      130    13699        /********************************************************************/
      131    13700        /*   Auto data       auto data       auto data       auto data       */
      132    13701        /*********************************************************************/
      133    13702                                                              /**/
      134    13703    1   DCL ALTER BIT (1);
      135    13704    1   DCL ARS SBIN ;
      136    13705    1   DCL BLK$ PTR ;
      137    13706    1   DCL BTEXT$ PTR;
      138    13707    1   DCL DATE_BUF CHAR (8) STATIC;
      139    13708    1   DCL I SBIN ;
      140    13709    1   DCL J SBIN;
      141    13710    1   DCL K UBIN;
      142    13711    1   DCL LEN UBIN;
      143    13712    1   DCL MODE UBIN;
      144    13713    1   DCL OP_CODE UBIN;
      145    13714    1   DCL P$ PTR;
      146    13715    1   DCL PTR$ PTR;
      147    13716    1   DCL STR$ PTR ;
      148    13717    1   DCL SUBNODES SBIN ;
      149    13718    1   DCL SUBND$ PTR ;
      150    13719    1   DCL SUBS UBIN;
      151    13720    1   DCL TEMP   UBIN;
      152    13721    1   DCL TEMP$ PTR;
      153    13722    1   DCL TIME_BUF CHAR (11) STATIC;
      154    13723    1   DCL UTS_BUF UBIN WORD STATIC;
      155    13724    1   DCL UTS_BUF_BIT REDEF UTS_BUF BIT (36);
      156    13725        %AS$PROJ_HEADER( NAME=PROJ_HEADER, STCLASS=AUTO );
      157    13754                                                              /**/
      158    13755        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:9    
      159    13756        /********************************************************************/
      160    13757        /*   Procedure       procedure       procedure       procedure       */
      161    13758        /*********************************************************************/
      162    13759                                                              /**/
      163    13760        /*
      164    13761            ***            Begin procedure                    ***
      165    13762        */
      166    13763    1   MORE = AS_TRUE ;
      167    13764    1   REMEMBER CM_LOOP_FCMD IN REM_FCMD ;             /*   Remember for free command  */
      168    13765                                                              /**/
      169    13766    1   CM_LOOP: ;
      170    13767    1   P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
      171    13768                                                              /**/
      172    13769    2   DO WHILE (MORE) ;
      173    13770    2      REMEMBER CM_LOOP IN REMEM_VAR ;
      174    13771                                                              /*  Set prompt  */
      175    13772    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;
      176    13773    2      CALL ASB$READ_SI(IN_BUF,ARS) ;             /* Read option line */
      177    13774    2      P_PCB.NCHARS = ARS ;
      178    13775    2      CALL X$PARSE(P_PCB) ALTRET (OPTION_ERR) ;
      179    13776                                                              /**/
      180    13777    2      NODE$ = P_PCB.OUT$ ;
      181    13778                                                              /**/
      182    13779    2   CM_LOOP_FCMD: ;
      183    13780                                                              /**/
      184    13781    2      CODE = P$NODE.CODE ;
      185    13782    2      SUBNODES = P$NODE.SUBNODES ;
      186    13783                                                              /**/
      187    13784    3      DO I = 0 TO SUBNODES-1 ;
      188    13785    3         SUBND$ = P$NODE.SUBLK$(I) ;
      189    13786    3         CODE = SUBND$ -> P$NODE.CODE ;
      190    13787                                                              /**/
      191    13788    4         DO SELECT (CODE) ;
      192    13789                                                              /**/
      193    13790    4            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */) ;
      194    13791    4            USERS_KEY = CR_MOD_KEY ;        /* End or blank input */
      195    13792    4            ERR_CODE.CODE = 0 ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:10   
      196    13793    4            RETURN ;
      197    13794                                                              /**/
      198    13795    4            SELECT(302 /* HELP_VAL */) ;
      199    13796    4            CALL ASH$HELP ;
      200    13797                                                              /**/
      201    13798    4            SELECT(300 /* DQUESTION_VAL */) ;
      202    13799    4            CALL ASH$DQUEST ;
      203    13800                                                              /**/
      204    13801    4            SELECT(301 /* QUESTION_VAL */) ;
      205    13802    4            CALL ASH$QUEST ;
      206    13803        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:11   
      207    13804    4            SELECT( 45   /*  PASSWORD_ALT_VAL */ );
      208    13805    4            ERR_CODE.CODE = 0;
      209    13806    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;
      210    13807    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */
      211    13808    5            THEN DO;
      212    13809    5               KL_DREC.PASSWORD = BLANK_PASS;
      213    13810    5               AS_MOD_USER.PASSWORD = %YES#;
      214    13811    5               END;   /*  None val  */
      215    13812    5            ELSE IF P$ -> P$NODE.CODE = 46   /*  PASS_WORD_VAL */ THEN DO;
      216    13813    5                  STR$ = P$ -> P$NODE.SUBLK$(0);
      217    13814    5                  LEN = VARY$STR.CNT;
      218    13815    5                  IF LEN > 8
      219    13816    6                  THEN DO;
      220    13817        /*E*  ERROR:    ASC-E$PASSWORD_TOO_LONG-C
      221    13818              MESSAGE: PASSWORD too long.
      222    13819              MESSAGE1: PASSWORD can be at most 8 characters long.
      223    13820        */
      224    13821                          %SCREAM(ERR#=E$PASSWORD_TOO_LONG,LEVEL=ERROR,MID='C');
      225    13836    6                     END; /*  Length error  */
      226    13837    6                  ELSE DO;
      227    13838    6                     CALL ASB$LEGL_CHAR( VARY$STR.TEXT, LEN ) ALTRET(BAD_CHAR);
      228    13839    6                     KL_DREC.PASSWORD = VARY$STR.TEXT;
      229    13840    6                     CALL ASZ$SCRAMBLE( KL_DREC.PASSWORD );
      230    13841    6                     AS_MOD_USER.PASSWORD = %YES#;
      231    13842    6   BAD_CHAR:         ;
      232    13843    6                     END; /*  Length ok  */
      233    13844    5                  END; /*  PASS_WORD_VAL  */
      234    13845    5               ELSE DO;
      235    13846    5                  STR$ = P$ -> P$NODE.SUBLK$(0) -> OUT$SYM.TEXTC$;
      236    13847    5                  LEN = VARY$STR.CNT;
      237    13848    5                  IF LEN ~= 24
      238    13849    6                  THEN DO;
      239    13850        /*E*  ERROR:    ASC-E$OCTAL_PASSWORD_LENGTH_ERR-C
      240    13851              MESSAGE: PASSWORD not the right size.
      241    13852              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      242    13853        */
      243    13854                          %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='C');
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:12   
      244    13869    6                     END; /*  Length error  */
      245    13870    6                  ELSE DO;
      246    13871    6                     P$ = PINCRC (STR$,1);
      247    13872    6                     PTR$ = PINCRC (P$,24);
      248    13873    6                     TEMP$ = ADDR (KL_DREC.PASSWORD);
      249    13874    7                     DO WHILE P$ < PTR$ ;
      250    13875    7                        CALL CHARBIN (I, P$->ACHAR);
      251    13876    7                        P$ = PINCRC (P$,1);
      252    13877    7                        CALL CHARBIN (J, P$-> ACHAR);
      253    13878    7                        P$ = PINCRC (P$,1);
      254    13879    7                        CALL CHARBIN (K, P$->ACHAR);
      255    13880    7                        TEMP = I * 64 + J * 8 + K;
      256    13881    7                        P$ = PINCRC (P$, 1);
      257    13882    7                        TEMP$ -> ACHAR = BINASC ( TEMP );
      258    13883    7                        TEMP$ = PINCRC (TEMP$, 1);
      259    13884    7                        END; /*  Do while P$ < PTR$  */
      260    13885    6                     AS_MOD_USER.PASSWORD = %YES#;
      261    13886    6                     END; /*  Length ok  */
      262    13887    5                  END; /*  Else  */
      263    13888
      264    13889        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:13   
      265    13890    4            SELECT( 119 /* NATIVE LANG. */ ) ;
      266    13891    4            ERR_CODE = '0'B ;
      267    13892    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;
      268    13893    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */
      269    13894    4            THEN
      270    13895    4               AS_USERS.NAT_LANG = AS_BLANK ;
      271    13896    4            ELSE
      272    13897    4               AS_USERS.NAT_LANG = P$-> P$NODE.SUBLK$(0)-> VARY$STR.TEXT ;
      273    13898    4            AS_MOD_USER.NAT_LANG = AS_TRUE;
      274    13899        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:14   
      275    13900    4            SELECT( 120 /* STEP ACCNT */ ) ;
      276    13901    4            ERR_CODE = '0'B ;
      277    13902    4            IF SUBND$ -> P$NODE.SUBNODES = 0
      278    13903    4            THEN
      279    13904    4               AS_USERS.STEPACCNT = AS_TRUE ;
      280    13905    4            ELSE
      281    13906    4               IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1   /*  YES_VAL  */
      282    13907    4               THEN
      283    13908    4                  AS_USERS.STEPACCNT = AS_TRUE ;
      284    13909    4               ELSE
      285    13910    4                  AS_USERS.STEPACCNT = AS_FALSE ;
      286    13911    4            AS_MOD_USER.STEPACCNT = AS_TRUE ;
      287    13912        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:15   
      288    13913    4            SELECT( 96  /*  BATNUM_OPT_VAL */ ) ;
      289    13914    4            ERR_CODE = '0'B ;
      290    13915    4            IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 7   /*  NONE_VAL  */ THEN
      291    13916    4               J = -1;
      292    13917    5            ELSE DO;
      293    13918    5               STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      294    13919    5               CALL CHARBIN( J, VARY$STR.TEXT ) ;
      295    13920    5               END;
      296    13921    4            AS_USERS.BATNUM = J ;
      297    13922    4            IF AS_CR_MOD_PROJ > 0   AND  AS_DFLT.BATNUM ~= -1
      298    13923    4            THEN
      299    13924    4               IF J > AS_DFLT.BATNUM OR J = -1
      300    13925    5               THEN DO ;
      301    13926                       %NUMBER( NUM1 = AS_DFLT.BATNUM, SIGN1=YES );
             13936    5         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, AS_DFLT.BATNUM );
      302    13956        /*E*  ERROR:  ASC-E$BATNUM_LIMIT-C
      303    13957              MESSAGE: BATNUM value is too large. Set to maximum of %U1.
      304    13958        */
      305    13959                       %SCREAM( ERR#=E$BATNUM_LIMIT, LEVEL=ERROR, MID='C') ;
      306    13974    5                  AS_USERS.BATNUM = AS_DFLT.BATNUM ;
      307    13975    5                  END ;
      308    13976    4            AS_MOD_USER.BATNUM = %YES# ;
      309    13977        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:16   
      310    13978    4            SELECT( 107 /* FEDBACCN_OPT_VAL */ );
      311    13979    4            ERR_CODE.CODE = 0;
      312    13980    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;
      313    13981    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */
      314    13982    5            THEN DO;
      315    13983    5               KL_DREC.KL_DREC_FEBLK.DBACCN = BLANK_PASS;
      316    13984    5               AS_MOD_USER.FEDBACCN = AS_TRUE;
      317    13985    5               END;
      318    13986    5            ELSE DO;
      319    13987    5               STR$ = P$ -> P$NODE.SUBLK$(0);
      320    13988    5               LEN = VARY$STR.CNT;
      321    13989    5               IF LEN > 8
      322    13990    6               THEN DO;
      323    13991        /*E*  ERROR:    ASC-E$FEDBACCN_TOO_LONG-C
      324    13992              MESSAGE: FEDBACCN too long.
      325    13993              MESSAGE1: FEDBACCN can be at most 8 characters long.
      326    13994        */
      327    13995                       %SCREAM(ERR#=E$FEDBACCN_TOO_LONG,LEVEL=ERROR,MID='C');
      328    14010    6                  END;
      329    14011    6               ELSE DO;
      330    14012    6                  KL_DREC.KL_DREC_FEBLK.DBACCN = VARY$STR.TEXT;
      331    14013    6                  AS_MOD_USER.FEDBACCN = AS_TRUE;
      332    14014    6                  END;
      333    14015    5               END;
      334    14016
      335    14017        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:17   
      336    14018    4            SELECT( 89   /*  FESTEPACCNT_OPT_VAL */ ) ;
      337    14019    4            ERR_CODE = '0'B ;
      338    14020    4            IF SUBND$ -> P$NODE.SUBNODES = 0
      339    14021    4            THEN
      340    14022    4               KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT = AS_TRUE ;
      341    14023    4            ELSE
      342    14024    4               IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1   /*  YES_VAL  */
      343    14025    4               THEN
      344    14026    4                  KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT = AS_TRUE ;
      345    14027    4               ELSE
      346    14028    4                  KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT = AS_FALSE ;
      347    14029    4            AS_MOD_USER.FESTEPACCNT = AS_TRUE ;
      348    14030
      349    14031    4            SELECT( 98 /* FEMINTS_OPT_VAL */ ) ;
      350    14032    4            ERR_CODE = '0'B ;
      351    14033    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;
      352    14034    5            DO J = 0 TO SUBS ;
      353    14035    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      354    14036    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      355    14037    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;
      356    14038    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;
      357    14039    5               KL_DREC.KL_DREC_FEBLK.MINTS(MODE) = K ;
      358    14040    5               IF AS_CR_MOD_PROJ > 0
      359    14041    5               THEN
      360    14042    5                  IF K > KL_DFLT.KL_DFLT_FEBLK.MINTS(MODE)
      361    14043    6                  THEN DO ;
      362    14044    6                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;
      363    14045                          %NUMBER( NUM2 = "KL_DFLT.KL_DFLT_FEBLK.MINTS(MODE)" ) ;
             14061    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, KL_DFLT.KL_DFLT_FEBLK.MINTS(MODE) );
      364    14075        /*E*  ERROR:  ASC-E$MINTS_TOO_BIG-C
      365    14076              MESSAGE: %U1 FEMINTS value is too large. Set to maximum of %U2.
      366    14077        */
      367    14078                          %SCREAM( ERR#=E$MINTS_TOO_BIG, LEVEL=ERROR, MID='C' ) ;
      368    14093    6                     KL_DREC.KL_DREC_FEBLK.MINTS(MODE) = KL_DFLT.KL_DFLT_FEBLK.MINTS(
             14093                              MODE) ;
      369    14094    6                     END ;
      370    14095    5               AS_MOD_USER.FEMINTS_A(MODE) = AS_TRUE ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:18   
      371    14096    5               END ;
      372    14097        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:19   
      373    14098    4            SELECT( 99 /* FEMFPRG_OPT_VAL */ ) ;
      374    14099    4            ERR_CODE = '0'B ;
      375    14100    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      376    14101    4            CALL CHARBIN( MODE, VARY$STR.TEXT ) ;
      377    14102    4            KL_DREC.KL_DREC_FEBLK.MFPRG = MODE ;
      378    14103    4            IF AS_CR_MOD_PROJ > 0
      379    14104    4            THEN
      380    14105    4               IF MODE > KL_DFLT.KL_DFLT_FEBLK.MFPRG
      381    14106    5               THEN DO ;
      382    14107    5                  J = KL_DFLT.KL_DFLT_FEBLK.MFPRG ;
      383    14108                       %NUMBER( NUM1 = J) ;
             14116    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, J );
      384    14138        /*E*  ERROR:  ASC-E$MFPRG_TOO_BIG-C
      385    14139              MESSAGE: MFPRG value is too large. Set to maximum of %U1.
      386    14140        */
      387    14141                       %SCREAM( ERR#=E$MFPRG_TOO_BIG, LEVEL=ERROR, MID='C') ;
      388    14156    5                  KL_DREC.KL_DREC_FEBLK.MFPRG = KL_DFLT.KL_DFLT_FEBLK.MFPRG ;
      389    14157    5                  END ;
      390    14158    4            AS_MOD_USER.FEMFPRG = AS_TRUE ;
      391    14159        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:20   
      392    14160    4            SELECT( 103 /* FETIME_OPT_VAL */ ) ;
      393    14161    4            ERR_CODE = '0'B ;
      394    14162    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;
      395    14163    5            DO J = 0 TO SUBS ;
      396    14164    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      397    14165    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      398    14166    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;
      399    14167    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;
      400    14168    5               K = K * 6000 ;
      401    14169    5               KL_DREC.KL_DREC_FEBLK.MTIME(MODE) = K ;
      402    14170    5               IF AS_CR_MOD_PROJ > 0
      403    14171    5               THEN
      404    14172    5                  IF K > KL_DFLT.KL_DFLT_FEBLK.MTIME(MODE)
      405    14173    6                  THEN DO ;
      406    14174    6                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;
      407    14175                          %NUMBER( NUM2 = "KL_DFLT.KL_DFLT_FEBLK.MTIME(MODE)/6000" ) ;
             14191    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, KL_DFLT.KL_DFLT_FEBLK.MTIME(MODE)/
             14191                  6000 );
      408    14205        /*E*  ERROR:  ASC-E$FEMTIME_LIMIT-C
      409    14206              MESSAGE: %U1 FEMTIME value is too large. Set to maximum of %U2.
      410    14207        */
      411    14208                          %SCREAM( ERR#=E$FEMTIME_LIMIT, LEVEL=ERROR, MID='C' ) ;
      412    14223    6                     KL_DREC.KL_DREC_FEBLK.MTIME(MODE) = KL_DFLT.KL_DFLT_FEBLK.MTIME(
             14223                              MODE) ;
      413    14224    6                     END ;
      414    14225    5               AS_MOD_USER.FEMTIME_A(MODE) = AS_TRUE ;
      415    14226    5               END ;
      416    14227        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:21   
      417    14228    4            SELECT( 104 /* FEMEMORY_OPT_VAL */ ) ;
      418    14229    4            ERR_CODE = '0'B ;
      419    14230    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;
      420    14231    5            DO J = 0 TO SUBS ;
      421    14232    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      422    14233    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      423    14234    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;
      424    14235    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;
      425    14236    5               KL_DREC.KL_DREC_FEBLK.MMEM(MODE) = K ;
      426    14237    5               IF AS_CR_MOD_PROJ > 0
      427    14238    5               THEN
      428    14239    5                  IF K > KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE)
      429    14240    6                  THEN DO ;
      430    14241    6                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;
      431    14242                          %NUMBER( NUM2 = "KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE)" ) ;
             14258    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE) );
      432    14272        /*E*  ERROR:  ASC-E$FEMMEM_LIMIT-C
      433    14273              MESSAGE: %U1 FEMMEMORY value is too large. Set to maximum of %U2.
      434    14274        */
      435    14275                          %SCREAM( ERR#=E$FEMMEM_LIMIT, LEVEL=ERROR, MID='C' ) ;
      436    14290    6                     KL_DREC.KL_DREC_FEBLK.MMEM(MODE) = KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE
             14290                              ) ;
      437    14291    6                     END ;
      438    14292    5               AS_MOD_USER.FEMMEM_A(MODE) = AS_TRUE ;
      439    14293    5               END ;
      440    14294        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:22   
      441    14295    4            SELECT(48   /*  SETUP_OPT_VAL */) ;
      442    14296    4            ERR_CODE.CODE = 0 ;
      443    14297    4            MODE = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      444    14298    4            ALTER = AS_USERS.SETUP_PERM (MODE);
      445    14299    4            STR$ = ADDR (NIL);
      446    14300    5            DO J = 1 TO SUBND$->P$NODE.SUBNODES-1;
      447    14301    5               TEMP$ = SUBND$->P$NODE.SUBLK$(J);
      448    14302    6               DO SELECT (TEMP$->OUT$SYM.CODE);
      449    14303    6                  SELECT (0);/* No code for a node containing text*/
      450    14304    6                  STR$ = TEMP$->OUT$SYM.TEXTC$;
      451    14305    6                  SELECT (129 /* ALTER_TYPE_VAL */);
      452    14306    6                  IF ((SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'A') OR
      453    14307    6                       (SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'a'))
      454    14308    7                  THEN DO;
      455    14309    7                     ALTER = '0'B ;
      456    14310    7                     END;
      457    14311    7                  ELSE DO;
      458    14312    7                     ALTER = '1'B ;
      459    14313    7                     END;
      460    14314    6                  SELECT (ELSE);
      461    14315    6               RETURN;
      462    14316    6                  END; /* Of this case */
      463    14317    5               END; /* The do j = 0 to ... */
      464    14318    4            IF (STR$ = ADDR (NIL))
      465    14319    5            THEN DO;
      466    14320    5               AS_USERS.SETUP_PERM (MODE) = ALTER;
      467    14321    5               AS_MOD_USER.PERM_A(MODE) = AS_TRUE ;
      468    14322    5               END;
      469    14323    5            ELSE DO;
      470    14324    5               IF (STR$->VARY$STR.CNT >= 115)
      471    14325    6               THEN DO;
      472    14326        /*E* ERROR:  ASC-E$SETUP_TOO_LONG-C
      473    14327             MESSAGE0: The text specified is longer then allowed for SETUP.
      474    14328             MESSAGE1: The maximum length of a SETUP string is 114 characters
      475    14329                       or less.
      476    14330        */
      477    14331                       %SCREAM(ERR#=E$SETUP_TOO_LONG,LEVEL=ERROR,MID='C');
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:23   
      478    14346    6                  END;
      479    14347    6               ELSE DO;
      480    14348    6                  AS_USERS.SETUP_PERM (MODE) = ALTER;
      481    14349    6                  AS_MOD_USER.PERM_A(MODE) = AS_TRUE ;
      482    14350    6                  AS_MOD_USER.SETUP_A(MODE) = AS_TRUE ;
      483    14351    6                  CALL ASC$SETUP( ADDR(AS_USERS), MODE, STR$->VARY$STR)
      484    14352    7                  WHENALTRETURN DO;
      485    14353                          %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');
      486    14368    7                     AS_MOD_USER.SETUP_A(MODE) = AS_FALSE ;
      487    14369    7                     END;
      488    14370    6                  END;
      489    14371    5               END;
      490    14372        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:24   
      491    14373    4            SELECT ( 135 /* FORCE_SETUP */ );
      492    14374    4            ERR_CODE.CODE = 0;
      493    14375    4            PTR$ = SUBND$ -> P$NODE.SUBLK$(0);
      494    14376    4            SUBS = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBNODES - 1 ;
      495    14377    5            DO J = 0 TO SUBS ;
      496    14378    5               P$ = PTR$ -> P$NODE.SUBLK$(J) ;
      497    14379    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      498    14380    5               IF P$ -> P$NODE.SUBNODES = 1
      499    14381    5               THEN
      500    14382    5                  OP_CODE = 1   /*  YES_VAL  */ ;
      501    14383    5               ELSE
      502    14384    5                  OP_CODE = P$ -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
      503    14385    5               IF OP_CODE = 1   /*  YES_VAL  */ THEN
      504    14386    5                  AS_USERS.SETUP_FORCE (MODE) = %YES#;
      505    14387    5               ELSE
      506    14388    5                  AS_USERS.SETUP_FORCE (MODE) = %NO#;
      507    14389    5               AS_MOD_USER.FORCE_A (MODE) = %YES#;
      508    14390    5               END; /*  Do j  */
      509    14391        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:25   
      510    14392    4            SELECT(127 /* BANNERTEXT_OPT_VAL */) ;
      511    14393    4            BTEXT$ = ADDR (NIL);
      512    14394    4            ERR_CODE.CODE = 0 ;
      513    14395    5            DO J = 0 TO SUBND$->P$NODE.SUBNODES-1;
      514    14396    5               TEMP$ = SUBND$->P$NODE.SUBLK$(J);
      515    14397    6               DO SELECT (TEMP$->OUT$SYM.CODE);
      516    14398    6                  SELECT (0);/* No code for a node containing text*/
      517    14399    6                  BTEXT$ = TEMP$->OUT$SYM.TEXTC$;
      518    14400    6                  SELECT (128 /* FIELD_NUM_VAL */);
      519    14401                                  /* Mode is the banner field to be changed */
      520    14402    6                  MODE = ASCBIN( SUBSTR( TEMP$->OUT$SYM.TEXT,0,1)) - ASCBIN ('0');
      521    14403    6                  ALTER = AS_USERS.BANNER_PERM (MODE);
      522    14404    6                  SELECT (129 /* ALTER_TYPE_VAL */);
      523    14405    6                  IF ((SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'A') OR
      524    14406    6                       (SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'a'))
      525    14407    7                  THEN DO;
      526    14408    7                     ALTER = '0'B ;
      527    14409    7                     END;
      528    14410    7                  ELSE DO;
      529    14411    7                     ALTER = '1'B ;
      530    14412    7                     END;
      531    14413    6                  SELECT (ELSE);
      532    14414    6                  END; /* Of this case */
      533    14415    5               END; /* The do j = 0 to ... */
      534    14416    4            IF (BTEXT$ = ADDR (NIL))
      535    14417    5            THEN DO;
      536    14418    5               AS_USERS.BANNER_PERM (MODE) = ALTER;
      537    14419    5               END;
      538    14420    5            ELSE DO;
      539    14421    5               IF (BTEXT$->VARY$STR.CNT <= 80)
      540    14422    6               THEN DO;
      541    14423    6                  AS_USERS.BANNER_PERM (MODE) = ALTER;
      542    14424    6                  CALL ASC$BANNER(ADDR(AS_USERS),MODE,BTEXT$->VARY$STR)
      543    14425    7                  WHENALTRETURN DO;
      544    14426        /*E*   ERROR:  ASC-E$ALL_BANNNER_SPACE_USED-C
      545    14427               MESSAGE: TEXT field will not fit.  Change not successful.
      546    14428           MESSAGE1: All banner fields combined with setup must fit within a 1024 byte area.
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:26   
      547    14429        */
      548    14430
      549    14431        %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');
      550    14446    7                     END;
      551    14447    6                  AS_MOD_USER.BANNER_A(MODE) = AS_TRUE ;
      552    14448    6                  END;
      553    14449    6               ELSE DO;
      554    14450        /*E*  ERROR:   ASC-E$BANNER_TOO_LONG-C
      555    14451              MESSAGE: BANNERTEXT field too long.
      556    14452              MESSAGE1: A BANNERTEXT field can be at most 80 characters.
      557    14453        */
      558    14454                       %SCREAM(ERR#=E$BANNER_TOO_LONG,LEVEL=ERROR,MID='C');
      559    14469    6                  END;
      560    14470    5               END;
      561    14471    4            AS_MOD_USER.BANNER_PERM_A (MODE) = AS_TRUE;
      562    14472        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:27   
      563    14473    4            SELECT (130 /* ACCOUNT_OWNER_VAL */);
      564    14474                                   /* The account owner field is actually
      565    14475                                      stored in the bannertext pool as
      566    14476                                      bannertext 0.                    */
      567    14477    4            ERR_CODE.CODE = 0;
      568    14478    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;
      569    14479    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */
      570    14480    5            THEN DO;
      571    14481    5               BTEXT$ = ADDR  (AS_BLANK);
      572    14482    5               END;
      573    14483    5            ELSE DO;
      574    14484    5               BTEXT$ = SUBND$ -> P$NODE.SUBLK$(0) -> OUT$SYM.TEXTC$;
      575    14485    5               END;
      576    14486    4            MODE = 0;
      577    14487    4            ALTER = '1'B ;
      578    14488    4            IF (BTEXT$->VARY$STR.CNT <= 80)
      579    14489    5            THEN DO;
      580    14490    5               AS_USERS.BANNER_PERM (MODE) = ALTER;
      581    14491    5               CALL ASC$BANNER(ADDR(AS_USERS),MODE,BTEXT$->VARY$STR)
      582    14492    6               WHENALTRETURN DO;
      583    14493        /* ERROR:  ASC-E$ALL_BANNNER_SPACE_USED-C
      584    14494           MESSAGE: Text field will not fit.  Change not successful.
      585    14495           MESSAGE1: All banner fields combined with setup must fit within a 1024 byte area.
      586    14496        */
      587    14497
      588    14498        %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=WARN,MID='C');
      589    14513    6                  END;
      590    14514    5               END;
      591    14515    5            ELSE DO;
      592    14516        /*ERROR:   ASC-E$BANNER_TOO_LONG-C
      593    14517          MESSAGE: Bannertext field too long.
      594    14518          MESSAGE1: A bannertext field can be at most 80 characters.
      595    14519        */
      596    14520                    %SCREAM(ERR#=E$BANNER_TOO_LONG,LEVEL=ERROR,MID='C');
      597    14535    5               END;
      598    14536    4            AS_MOD_USER.BANNER_A (0) = %YES#;
      599    14537        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:28   
      600    14538    4            SELECT (139 /* PROJECT_ADMIN_VAL */);
      601    14539    4            ERR_CODE.CODE = 0;
      602    14540    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;
      603    14541    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */
      604    14542    5            THEN DO;
      605    14543    5               AS_USERS.BUDGET.MACCT = AS_NONE ;
      606    14544    5               END;
      607    14545    5            ELSE DO;
      608    14546    5               BLK$ = P$ -> P$NODE.SUBLK$(0);
      609    14547    5               AS_USERS.BUDGET.MACCT.ACCT = ' ';
      610    14548    5               AS_USERS.BUDGET.MACCT.NAME = ' ';
      611    14549    5               IF OUT$SYM.TEXTC$ -> VARY$STR.CNT > 8
      612    14550    6               THEN DO ;
      613    14551        /*E* ERROR:   ASC-E$ACCTTOOBIG-C
      614    14552             MESSAGE: ACCOUNT can be at most 8 characters long.
      615    14553        */
      616    14554                       %SCREAM( ERR#=E$ACCTTOOBIG, LEVEL=ERROR, MID='C' );
      617    14569    6                  END ;
      618    14570    6               ELSE DO;
      619    14571    6                  AS_USERS.BUDGET.MACCT.ACCT = OUT$SYM.TEXTC$ -> VARY$STR.TEXT;
      620    14572    6                  AS_USERS.BUDGET.MACCT.COUNT = OUT$SYM.TEXTC$ -> VARY$STR.CNT;
      621    14573    6                  END;
      622    14574    5               BLK$ = P$ -> P$NODE.SUBLK$(1) ;
      623    14575    5               IF OUT$SYM.TEXTC$->VARY$STR.CNT > 12
      624    14576    6               THEN DO ;
      625    14577        /*E* ERROR:   ASC-E$UNAME_TOO_LONG-C
      626    14578             MESSAGE: NAME can be at most 12 characters long.
      627    14579        */
      628    14580                       %SCREAM( ERR#=E$UNAME_TOO_LONG, LEVEL=ERROR, MID='C' );
      629    14595    6                  END ; /* Then do */
      630    14596    6               ELSE DO;
      631    14597    6                  AS_USERS.BUDGET.MACCT.NAME = OUT$SYM.TEXTC$ -> VARY$STR.TEXT ;
      632    14598    6                  AS_USERS.BUDGET.MACCT.COUNT = OUT$SYM.TEXTC$ -> VARY$STR.CNT + 8;
      633    14599    6                  END;
      634    14600    5               END;
      635    14601    4            AS_MOD_USER.BUDGET.MACCT = %YES#;
      636    14602        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:29   
      637    14603                                                              /**/
      638    14604    4            SELECT (131 /* LAST_LOGON_TIME_VAL */);
      639    14605    4            ERR_CODE.CODE = 0;
      640    14606    5            DO I = 0 TO SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBNODES - 1;
      641    14607    6               DO SELECT (SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->OUT$SYM.CODE);
      642    14608    6                  SELECT (132 /* LOGON_DATE_VAL */);
      643    14609    6                  DATE_BUF = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->OUT$SYM.TEXT;
      644    14610    6                  MAKE_UTS.DATE_.BOUND = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->
             14610                           OUT$SYM.COUNT - 1;
      645    14611    6                  SELECT (133 /* LOGON_TIME_VAL */);
      646    14612    6                  TIME_BUF = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->OUT$SYM.TEXT;
      647    14613    6                  MAKE_UTS.TIME_.BOUND = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->
             14613                           OUT$SYM.COUNT - 1;
      648    14614    6                  SELECT (ELSE);
      649    14615    6                  END; /* Do case */
      650    14616    5               END; /* Do for the # subnodes */
      651    14617    4            CALL M$TIME (MAKE_UTS)
      652    14618    5            WHENRETURN DO;
      653    14619    5               AS_USERS.LAST_LOGON_TIME = UTS_BUF_BIT;
      654    14620    5               AS_MOD_USER.LAST_LOGON_TIME = AS_TRUE;
      655    14621    5               END;
      656    14622    5            WHENALTRETURN DO;
      657    14623        /*E* ERROR: ASC-E$BAD_TIME_SPEC-C
      658    14624             MESSAGE: The conversion of the date and time to a UTS failed.
      659    14625             MESSAGE1: The time must be values less than 23:59:59.99 and
      660    14626                       the date must be values less than 12/31/99 only.
      661    14627        */
      662    14628                    %SCREAM (ERR#=E$BAD_TIME_SPEC, LEVEL=ERROR, MID='C');
      663    14643    5               END;
      664    14644        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:30   
      665    14645    4            SELECT(49 /* CPROC_OPT_VAL */) ;
      666    14646    4            ERR_CODE.CODE = 0 ;
      667    14647    4            K = SUBND$ -> P$NODE.SUBNODES - 1;
      668    14648    5            DO J = 0 TO K;
      669    14649    5               PTR$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      670    14650    5               MODE = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      671    14651    6               IF PTR$ -> P$NODE.SUBNODES = 1 THEN DO;
      672    14652    6                  AS_USERS.CPROC.NAME.CNT(MODE) = 0;
      673    14653    6                  AS_USERS.CPROC.NAME.TEXT(MODE) = AS_BLANK;
      674    14654    6                  AS_MOD_USER.CPROC_A( MODE ) = AS_TRUE ;
      675    14655    6                  END;
      676    14656    6               ELSE DO;
      677    14657    6                  STR$ = PTR$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0) ;
      678    14658    7                  IF VARY$STR.CNT <= 31 THEN DO;
      679    14659    7                     AS_USERS.CPROC.NAME.CNT(MODE) = VARY$STR.CNT ;
      680    14660    7                     AS_USERS.CPROC.NAME.TEXT(MODE) = VARY$STR.TEXT ;
      681    14661    7                     AS_MOD_USER.CPROC_A( MODE ) = AS_TRUE ;
      682    14662    7                     END;
      683    14663    7                  ELSE DO;
      684    14664        /*E*  ERROR:  ASC-E$CPROC_TOO_LONG-C
      685    14665              MESSAGE: %U1 CPROC too long.
      686    14666              MESSAGE1: CPROC can be at most 31 characters.
      687    14667        */
      688    14668    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);
      689    14669                          %SCREAM(ERR#=E$CPROC_TOO_LONG,LEVEL=ERROR,MID='C');
      690    14684    7                     END;
      691    14685    6                  END;
      692    14686    5               END ;   /* Do j */
      693    14687        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:31   
      694    14688    4            SELECT(124 /* LAST_CPROC_VAL */) ;
      695    14689    4            K = SUBND$ -> P$NODE.SUBNODES - 1;
      696    14690    5            DO J = 0 TO K;
      697    14691    5               PTR$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      698    14692    5               MODE = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      699    14693    6               IF PTR$ -> P$NODE.SUBNODES = 1 THEN DO;
      700    14694    6                  AS_USERS.LASTCPROC.NAME.CNT(MODE) = 0;
      701    14695    6                  AS_USERS.LASTCPROC.NAME.TEXT(MODE) = AS_BLANK;
      702    14696    6                  AS_MOD_USER.LASTCPROC_A( MODE ) = AS_TRUE ;
      703    14697    6                  END;
      704    14698    6               ELSE DO;
      705    14699    6                  STR$ = PTR$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0) ;
      706    14700    7                  IF VARY$STR.CNT <= 31 THEN DO;
      707    14701    7                     AS_USERS.LASTCPROC.NAME.CNT(MODE) = VARY$STR.CNT ;
      708    14702    7                     AS_USERS.LASTCPROC.NAME.TEXT(MODE) =VARY$STR.TEXT;
      709    14703    7                     AS_MOD_USER.LASTCPROC_A( MODE ) = AS_TRUE ;
      710    14704    7                     END;
      711    14705    7                  ELSE DO;
      712    14706        /*E*  ERROR:  ASC-E$LAST_CPROC_TOO_LONG-C
      713    14707              MESSAGE: %U1 LAST CPROC too long.
      714    14708              MESSAGE1: LAST CPROC can be at most 31 characters.
      715    14709        */
      716    14710    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);
      717    14711                          %SCREAM(ERR#=E$LAST_CPROC_TOO_LONG,LEVEL=ERROR,MID='C');
      718    14726    7                     END;
      719    14727    6                  END;
      720    14728    5               END ;   /* Do j */
      721    14729        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:32   
      722    14730    4            SELECT(125 /* STARS_ACCT_VAL */) ;
      723    14731    4            MODE = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      724    14732    4            AS_USERS.FLAGS.STARSACC = ( MODE = 1   /*  YES_VAL  */ );
      725    14733    4            AS_MOD_USER.STARSACC = AS_TRUE ;
      726    14734
      727    14735    4            SELECT(50 /* EXPIRE_OPT */) ;
      728    14736    4            ERR_CODE.CODE = 0 ;
      729    14737    4            CALL ASC$EXPIRE( SUBND$ );      /*  Expiration  */
      730    14738        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:33   
      731    14739    4            SELECT( 54   /*  BILLING_LIST_VAL */, 100  /*  FEBILLING_LIST_VAL */ ) ;
      732    14740    4            IF CODE = 100  /*  FEBILLING_LIST_VAL */
      733    14741    4            THEN FE_MODE = '1'B ;
      734    14742    4            ELSE FE_MODE = '0'B ;
      735    14743    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      736    14744        /*E* ERROR:      ASC-E$BILLING_CHG-C
      737    14745             MESSAGE:    Project Administrator cannot change user's BILLING.
      738    14746        */
      739    14747                    %SCREAM (ERR#=E$BILLING_CHG, LEVEL=ERROR,MID='C');
      740    14762    5               END;  /* Of then do  */
      741    14763    5            ELSE DO;
      742    14764    5               ERR_CODE.CODE = 0 ;
      743    14765    5               SUBS = SUBND$ -> P$NODE.SUBNODES - 1;
      744    14766    6               DO J = 0 TO SUBS;
      745    14767    6                  P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      746    14768    6                  MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      747    14769    6                  STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0);
      748    14770    6                  IF VARY$STR.CNT <= 6
      749    14771    7                  THEN DO;
      750    14772    7                     IF FE_MODE
      751    14773    8                     THEN DO ;
      752    14774    8                        KL_DREC.KL_DREC_FEBLK.BILL(MODE) = VARY$STR.TEXT;
      753    14775    8                        AS_MOD_USER.FEBILL_A(MODE) = AS_TRUE;
      754    14776    8                        END ;
      755    14777    8                     ELSE DO ;
      756    14778    8                        AS_USERS.BILL(MODE) = VARY$STR.TEXT;
      757    14779    8                        AS_MOD_USER.BILL_A(MODE) = AS_TRUE;
      758    14780    8                        END ;
      759    14781    7                     END;
      760    14782    7                  ELSE DO;
      761    14783        /*E*  ERROR:  ASC-E$RATE_SCHEDULE_TOO_LONG-C
      762    14784              MESSAGE: %U1 BILLING schedule too long.
      763    14785              MESSAGE1: BILLING schedule can be at most 6 characters long.
      764    14786        */
      765    14787    7                     IF FE_MODE
      766    14788    7                     THEN AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;
      767    14789    7                     ELSE AS_FIELD1 = AS_MODE_ARRY(MODE);
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:34   
      768    14790                          %SCREAM( ERR#=E$RATE_SCHEDULE_TOO_LONG, LEVEL=ERROR, MID='C' );
      769    14805    7                     END;
      770    14806    6                  END;
      771    14807    5               END; /* Of else do  */
      772    14808        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:35   
      773    14809    4            SELECT( 105 /* FEACCTMEM_OPT_VAL */ ) ;
      774    14810    5            IF AS_CR_MOD_PROJ > 0 THEN DO ;
      775    14811        /*E*  ERROR:  ASC-E$FEACCTMEM_TOO_BIG-C
      776    14812              MESSAGE: Project Administrator cannot change MAX ACCT MEMORY .
      777    14813        */
      778    14814                    %SCREAM( ERR#=E$FEACCTMEM_TOO_BIG, LEVEL=ERROR, MID='C' );
      779    14829    5               END ;
      780    14830    4            ERR_CODE = '0'B ;
      781    14831    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      782    14832    4            CALL CHARBIN( MODE, VARY$STR.TEXT ) ;
      783    14833    5            IF MODE > 9999 THEN DO ;
      784    14834        /*E*  ERROR:  ASC-E$FEMACCTMEM_TOO_LRG-C
      785    14835              MESSAGE: Maximum FEMACCTMEM value is 9999.
      786    14836        */
      787    14837                    %SCREAM( ERR#=E$FEMACCTMEM_TOO_LRG, LEVEL=ERROR, MID='C') ;
      788    14852    5               END ;
      789    14853    4            KL_DREC.KL_DREC_FEBLK.MACCTMEM = MODE ;
      790    14854    4            AS_MOD_USER.FEMACCTMEM = AS_TRUE ;
      791    14855        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:36   
      792    14856    4            SELECT( 121 /* FACCOUNT_OPT_VAL */ );
      793    14857    4            IF AS_CR_MOD_PROJ = %CR_PROJ_DEFAULT
      794    14858    4                 OR  AS_CR_MOD_PROJ = - %CR_PROJ_DEFAULT
      795    14859    5            THEN DO;
      796    14860        /*E*  ERROR:      ASC-E$FACCOUNT_NOT_ALLOWED-C
      797    14861              MESSAGE: FACCOUNT option not allowed.
      798    14862              MESSAGE1: The FACCOUNT option is not allowed when defining the
      799    14863                        DEFAULT record for users in a project.
      800    14864        */
      801    14865                    %SCREAM( ERR#=E$FACCOUNT_NOT_ALLOWED,MID='C',LEVEL=ERROR);
      802    14880    5               GOTO LOOP_END;
      803    14881    5               END;
      804    14882    4            SUPER_TO_PIG.TYPE = %VALIDATE_ATTR;
      805    14883    4            SUPER_TO_PIG.PROJ = AS_FALSE;
      806    14884    4            SUPER_TO_PIG.PACKSET = AS_USERS.HPSN;
      807    14885    4            CALL ASB$PIG_ACCT_ATTR( SUPER_TO_PIG ) ALTRET(CM_LOOP);
      808    14886    4            IF CR_MOD_FLG THEN
      809    14887    4               SUPER_TO_PIG.TYPE = %MODIFY_ACCT;
      810    14888    4            ELSE
      811    14889    4               SUPER_TO_PIG.TYPE = %CREATE_ACCT;
      812    14890    4            SUPER_TO_PIG.PROJ = (AS_CR_MOD_PROJ > 0);
      813    14891    4            CALL ASB$PIG( SUPER_TO_PIG ) ALTRET(CM_LOOP);
      814    14892    4            AS_MOD_USER.FACCOUNT = AS_TRUE;
      815    14893    4            GOTO CM_LOOP;
      816    14894        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:37   
      817    14895    4            SELECT(59   /*  PRIV_VAL_VAL */) ;
      818    14896    4            ERR_CODE.CODE = 0 ;
      819    14897    4            CALL ASC$PRIV ;
      820    14898                                                              /**/
      821    14899    4            SELECT(80 /* PPRIV_OPT */) ;
      822    14900    4            ERR_CODE = '0'B ;
      823    14901    4            CALL ASC$PPRIV ;
      824    14902                                                              /**/
      825    14903    4            SELECT(101 /* FEPRIV_OPT_VAL */) ;
      826    14904    4            ERR_CODE.CODE = 0 ;
      827    14905    4            CALL ASC$FEPRIV ;
      828    14906                                                              /**/
      829    14907    4            SELECT(102 /* FEPPRIV_OPT_VAL */) ;
      830    14908    4            ERR_CODE = '0'B ;
      831    14909    4            CALL ASC$FEPPRIV ;
      832    14910    4            SELECT(60   /*  BUDGET_OPT_VAL */) ;
      833    14911    4            ERR_CODE.CODE = 0 ;
      834    14912    4            CALL ASC$BUDGET(CR_MOD_KEY) ;
      835    14913        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:38   
      836    14914    4            SELECT( 90   /*  QUAN_OPT_VAL */ ) ;
      837    14915    4            ERR_CODE = '0'B ;
      838    14916    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;
      839    14917    5            DO J = 0 TO SUBS ;
      840    14918    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      841    14919    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      842    14920    5               IF P$->P$NODE.SUBLK$(1)->P$NODE.CODE = 105  /* SIGN_VAL */ THEN
      843    14921    5                  STR$ = P$ -> P$NODE.SUBLK$(2) -> P$NODE.SUBLK$ (0) ;
      844    14922    5               ELSE
      845    14923    5                  STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;
      846    14924    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;
      847    14925    6               IF K > BITBIN('377777'O) THEN DO ;
      848    14926        /*E*  ERROR:    ASC-E$QUAN_TOO_BIG-C
      849    14927              MESSAGE:  QUAN value is too big.
      850    14928              MESSAGE1: QUAN value must be between -2**17-1 and 2**17-1
      851    14929        */
      852    14930                       %SCREAM( ERR#=E$QUAN_TOO_BIG, LEVEL=ERROR, MID='C') ;
      853    14945    6                  GOTO LOOP_END ;
      854    14946    6                  END ;
      855    14947    5               IF P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE=1 /* MINUS_VAL */
             14947                        THEN
      856    14948    5                  AS_USERS.QUAN(MODE) = (-1 * K);
      857    14949    5               ELSE
      858    14950    5                  AS_USERS.QUAN(MODE) = K;
      859    14951    5               IF AS_CR_MOD_PROJ > 0 THEN
      860    14952    6                  IF AS_USERS.QUAN(MODE) > AS_DFLT.QUAN(MODE) THEN DO ;
      861    14953        /*E*  ERROR:  ASC-E$QUAN_LIMIT-C
      862    14954              MESSAGE: %U1 QUAN value is too large.  Set to maximum of %U2.
      863    14955        */
      864    14956                          %SCREAM( ERR#=E$QUAN_LIMIT, LEVEL=ERROR, MID='C');
      865    14971    6                     AS_USERS.QUAN(MODE) = AS_DFLT.QUAN(MODE) ;
      866    14972    6                     END ;
      867    14973    5               AS_MOD_USER.QUAN_A(MODE) = AS_TRUE ;
      868    14974    5               END ;
      869    14975        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:39   
      870    14976    4            SELECT( 108 /* MAXENQ_OPT_VAL */ ) ;
      871    14977    4            ERR_CODE = '0'B ;
      872    14978    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;
      873    14979    5            DO J = 0 TO SUBS ;
      874    14980    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      875    14981    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      876    14982    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;
      877    14983    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;
      878    14984    6               IF K > 262143 THEN DO ;
      879    14985        /*E*  ERROR:    ASC-E$MAXENQ_TOO_BIG-C
      880    14986              MESSAGE:  MAXENQ value is too big.
      881    14987              MESSAGE1: MAXENQ value can be at most 262143.
      882    14988        */
      883    14989                       %SCREAM( ERR#=E$MAXENQ_TOO_BIG, LEVEL=ERROR, MID='C') ;
      884    15004    6                  GOTO LOOP_END ;
      885    15005    6                  END ;
      886    15006    5               AS_USERS.MAXENQ(MODE) = K ;
      887    15007    5               IF AS_CR_MOD_PROJ > 0 THEN
      888    15008    6                  IF K > AS_DFLT.MAXENQ(MODE) THEN DO ;
      889    15009        /*E*  ERROR:  ASC-E$MAXENQ_LIMIT-C
      890    15010              MESSAGE: %U1 MAXENQ value is too large.  Set to maximum of %U2.
      891    15011        */
      892    15012                          %SCREAM( ERR#=E$MAXENQ_LIMIT, LEVEL=ERROR, MID='C');
      893    15027    6                     AS_USERS.MAXENQ(MODE) = AS_DFLT.MAXENQ(MODE) ;
      894    15028    6                     END ;
      895    15029    5               AS_MOD_USER.MAXENQ_A(MODE) = AS_TRUE ;
      896    15030    5               END ;
      897    15031        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:40   
      898    15032    4            SELECT( 91  /*  PRIOB_OPT_VAL */ ) ;
      899    15033    4            ERR_CODE = '0'B ;
      900    15034    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;
      901    15035    5            DO J = 0 TO SUBS ;
      902    15036    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;
      903    15037    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      904    15038    5               IF P$->P$NODE.SUBLK$(1)->P$NODE.CODE = 105  /* SIGN_VAL */
      905    15039    6               THEN DO;
      906    15040    6                  IF P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE = 1
             15040                           /* MINUS_VAL */ OR
      907    15041    6                       P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE = 0
             15041                                /* PLUS_VAL */ THEN
      908    15042    6                     STR$ = P$ -> P$NODE.SUBLK$(2) -> P$NODE.SUBLK$ (0) ;
      909    15043    6                  END;
      910    15044    5               ELSE
      911    15045    5                  STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;
      912    15046    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;
      913    15047    6               IF K > 255 THEN DO ;
      914    15048        /*E*  ERROR:    ASC-E$PRIOB_TOO_BIG-C
      915    15049              MESSAGE:  PRIOB value is too big.
      916    15050              MESSAGE1: PRIOB value must be between -255 and 255.
      917    15051        */
      918    15052                       %SCREAM( ERR#=E$PRIOB_TOO_BIG, LEVEL=ERROR, MID='C') ;
      919    15067    6                  GOTO LOOP_END ;
      920    15068    6                  END ;
      921    15069    5               IF P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE=1 /* MINUS_VAL */
             15069                        THEN
      922    15070    5                  AS_USERS.PRIOB(MODE) = (-1 * K);
      923    15071    5               ELSE
      924    15072    5                  AS_USERS.PRIOB(MODE) = K ;
      925    15073    5               IF AS_CR_MOD_PROJ > 0 THEN
      926    15074    6                  IF AS_USERS.PRIOB(MODE) > AS_DFLT.PRIOB(MODE) THEN DO ;
      927    15075        /*E*  ERROR:  ASC-E$PRIOB_LIMIT-C
      928    15076              MESSAGE: %U1 PRIOB value is too large.  Set to maximum of %U2.
      929    15077        */
      930    15078                          %SCREAM( ERR#=E$PRIOB_LIMIT, LEVEL=ERROR, MID='C');
      931    15093    6                     AS_USERS.PRIOB(MODE) = AS_DFLT.PRIOB(MODE) ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:41   
      932    15094    6                     END ;
      933    15095    5               AS_MOD_USER.PRIOB_A(MODE) = AS_TRUE ;
      934    15096    5               END ;
      935    15097        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:42   
      936    15098    4            SELECT(31  /* CM WSN */) ;
      937    15099    4            ERR_CODE.CODE = 0 ;
      938    15100    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
      939    15101    4            IF VARY$STR.CNT <= 8
      940    15102    5            THEN DO;
      941    15103    5               KL_DREC.WOO = VARY$STR.TEXT;
      942    15104    5               AS_MOD_USER.WSN = AS_TRUE;
      943    15105    5               USERS_KEY.COUNT = 9;
      944    15106    5               CALL CONCAT( USERS_KEY.TXTC, KL_DREC.WOO, '*' );
      945    15107    5               CALL ASW$PREC_WSN ALTRET( NO_WSN );
      946    15108    6               DO WHILE( '0'B );
      947    15109        /*E*  ERROR:  ASC-E$WSN_DOESNT_EXIST-C
      948    15110              MESSAGE: Warning: the WSN %U1 does not exist.
      949    15111        */
      950    15112    6   NO_WSN:        AS_FIELD1 = VARY$STR;
      951    15113                       %SCREAM(ERR#=E$WSN_DOESNT_EXIST, LEVEL=WARN, MID='C');
      952    15128    6                  END;
      953    15129    5               END;
      954    15130    5            ELSE DO;
      955    15131        /*E*  ERROR:    ASC-E$WSN_TOO_LONG-C
      956    15132              MESSAGE:  WSN name too long.
      957    15133              MESSAGE1: WSN name can be at most 8 characters long.
      958    15134        */
      959    15135                    %SCREAM( ERR#=E$WSN_TOO_LONG, LEVEL=ERROR, MID='C' );
      960    15150    5               END;
      961    15151        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:43   
      962    15152    4            SELECT(32  /* CM HSET */) ;
      963    15153    4            ERR_CODE.CODE = 0 ;
      964    15154    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
      965    15155    4            IF VARY$STR.CNT > 6
      966    15156    5            THEN DO;
      967    15157        /*E*  ERROR:    ASC-E$HSET_TOO_LONG-C
      968    15158              MESSAGE:  HSET name too long.
      969    15159              MESSAGE1: HSET name can be at most 6 characters long.
      970    15160        */
      971    15161                    %SCREAM( ERR#=E$HSET_TOO_LONG, LEVEL=ERROR, MID='C' );
      972    15176    5               GOTO LOOP_END;
      973    15177    5               END;
      974    15178    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      975    15179    5               PROJ_KEY.TXT.PROJECT = AS_PROJECT_ADMIN.TEXT;
      976    15180    5               PROJ_KEY.TXT.PACKSET = VARY$STR.TEXT;
      977    15181    5               PROJ_KEY.COUNT = 20 + VARY$STR.CNT;
      978    15182    5               ARS = SIZEC(PROJ_HEADER);
      979    15183    5               CALL ASB$READ_PROJ( ADDR(PROJ_HEADER), ARS ) ALTRET(NO_PROJ_REC);
      980    15184    6               IF '0'B THEN DO;
      981    15185        /*E* ERROR:   ASC-E$BAD_HSET-C
      982    15186             MESSAGE: HSET = DP#%U1 is not allowed for a %U2 you create.
      983    15187             MESSAGE1: The packset DP#%U1 was not defined for your project, so you are
      984    15188                       not allowed to specify HSET = DP#%U1 for a %U2 you create.
      985    15189        */
      986    15190    6   NO_PROJ_REC:
      987    15191    6                  AS_FIELD1 = VARY$STR;
      988    15192    6                  AS_FIELD2 = TEXTC(AS_CR_MOD_PROJ-1);
      989    15193                       %SCREAM( ERR#=E$BAD_HSET, MID='C', LEVEL=ERROR );
      990    15208    6                  GOTO LOOP_END;
      991    15209    6                  END;
      992    15210    5               CALL ASB$ACCT_OK( SUBSTR(CR_MOD_KEY.TEXT,0,8),
      993    15211    5                    PROJ_KEY.TXT.PACKSET, AS_PROJECT_ADMIN,
      994    15212    5                    AS_TRUE ) ALTRET(LOOP_END);
      995    15213    5               END;
      996    15214    4            KL_DREC.HPS.N = VARY$STR.TEXT;
      997    15215    4            AS_USERS.HPSN = VARY$STR.TEXT;
      998    15216    4            AS_MOD_USER.HSET = AS_TRUE;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:44   
      999    15217        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:45   
     1000    15218    4            SELECT(33  /* CM PROFILE */) ;
     1001    15219    4            ERR_CODE.CODE = 0 ;
     1002    15220    4            IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 7   /*  NONE_VAL  */
     1003    15221    5            THEN DO;
     1004    15222    5               KL_DREC.PNAME.CNT = 0;
     1005    15223    5               KL_DREC.PNAME.TXT = AS_BLANK;
     1006    15224    5               AS_MOD_USER.PROFILE = AS_TRUE;
     1007    15225    5               END;
     1008    15226    5            ELSE DO;
     1009    15227    5               STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
     1010    15228    5               IF VARY$STR.CNT <= 11
     1011    15229    6               THEN DO;
     1012    15230    6                  KL_DREC.PNAME.TXT = ' ';
     1013    15231    6                  KL_DREC.PNAME.CNT = VARY$STR.CNT;
     1014    15232    6                  KL_DREC.PNAME.TXT = SUBSTR ( VARY$STR.TEXT,0,VARY$STR.CNT);
     1015    15233    6                  AS_MOD_USER.PROFILE = %YES#;
     1016    15234    6                  USERS_KEY = VARY$STR ;
     1017    15235    6                  CALL ASD$PREC_PRO( USERS_KEY ) ALTRET( NO_PRO );
     1018    15236    7                  DO WHILE( '0'B );
     1019    15237        /*E*  ERROR:  ASC-E$PRO_DOESNT_EXIST-C
     1020    15238              MESSAGE: Warning: the profile %U1 does not exist.
     1021    15239        */
     1022    15240    7   NO_PRO:           AS_FIELD1 = VARY$STR;
     1023    15241                          %SCREAM(ERR#=E$PRO_DOESNT_EXIST, LEVEL=WARN, MID='C');
     1024    15256    7                     END;
     1025    15257    6                  END;
     1026    15258    6               ELSE DO;
     1027    15259        /*E*  ERROR:    ASC-E$PROFILE_TOO_LONG-C
     1028    15260              MESSAGE:  PROFILE name too long.
     1029    15261              MESSAGE1: PROFILE name can be at most 11 characters long.
     1030    15262        */
     1031    15263                       %SCREAM( ERR#=E$PROFILE_TOO_LONG, LEVEL=ERROR, MID='C' );
     1032    15278    6                  END;
     1033    15279    5               END;
     1034    15280        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:46   
     1035    15281    4            SELECT( 122 /* KEY_OPT_VAL */ ) ;
     1036    15282    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
     1037    15283        /*E* ERROR:      ASC-E$CANNOT_CHG_KEY-C
     1038    15284             MESSAGE:    Project Administrator cannot change user's KEY.
     1039    15285        */
     1040    15286                    %SCREAM (ERR#=E$CANNOT_CHG_KEY, LEVEL=ERROR,MID='C');
     1041    15301    5               GOTO LOOP_END ;
     1042    15302    5               END;
     1043    15303    4            PTR$ = SUBND$ -> P$NODE.SUBLK$(0) ;
     1044    15304    4            CODE = PTR$ -> P$NODE.CODE ;
     1045    15305    5            DO SELECT( CODE );
     1046    15306    5               SELECT( 7   /*  NONE_VAL  */ );
     1047    15307    5               ADDR(AS_USERS.KEY) -> BIT$72 = '0'B;
     1048    15308    6               IF AS_WILD_USER THEN DO;
     1049    15309    7                  DO K = 0 TO 71;
     1050    15310    7                     AS_MOD_USER.KEY_A(K) = 2   /*  NO_VAL  */;
     1051    15311    7                     END;
     1052    15312    6                  END;
     1053    15313    5               SELECT( 6   /*  ALL_VAL  */ );
     1054    15314    5               IF AS_CR_MOD_PROJ > 0  AND AS_DFLT.KEY ~= ALL_KEYS
     1055    15315    6               THEN DO;
     1056    15316        /*E* ERROR:   ASA-E$ALL_KEY_ILLEGAL-C
     1057    15317             MESSAGE: You are not allowed to specify KEY = ALL for a %U1 you create.
     1058    15318             MESSAGE1: KEY = ALL was not specified for your project so you are not
     1059    15319                       allowed to specify KEY = ALL for a %U1 you create.
     1060    15320        */
     1061    15321    6                  AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
     1062    15322                       %SCREAM( ERR#=E$ALL_KEY_ILLEGAL, LEVEL=ERROR,MID='C');
     1063    15337    6                  GOTO LOOP_END;
     1064    15338    6                  END;
     1065    15339    5               ADDR(AS_USERS.KEY) -> BIT$72 = ALL_KEYS;
     1066    15340    6               IF AS_WILD_USER THEN DO;
     1067    15341    7                  DO K = 0 TO 71;
     1068    15342    7                     AS_MOD_USER.KEY_A(K) = 1   /*  YES_VAL  */;
     1069    15343    7                     END;
     1070    15344    6                  END;
     1071    15345    5               SELECT( ELSE );
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:47   
     1072    15346    5            SUBS = PTR$ -> P$NODE.SUBNODES - 1;
     1073    15347    6            DO J = 0 TO SUBS;
     1074    15348    6               STR$ = PTR$->P$NODE.SUBLK$(J)->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0);
     1075    15349    6               CALL CHARBIN( MODE, VARY$STR.TEXT );
     1076    15350    7               IF MODE < 1 OR MODE > 72 THEN DO;
     1077    15351        /*E* ERROR:   ASC-E$ILLEGAL_KEY_VAL-C
     1078    15352             MESSAGE: %U1 is an illegal KEY value.
     1079    15353             MESSAGE1: A KEY must be a number between 1 and 72.
     1080    15354        */
     1081    15355    7                  AS_FIELD1 = VARY$STR ;
     1082    15356                       %SCREAM( ERR#=E$ILLEGAL_KEY_VAL, LEVEL=ERROR, MID='C' );
     1083    15371    7                  GOTO LOOP_END;
     1084    15372    7                  END;
     1085    15373    6               IF PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES = 1
     1086    15374    6               THEN
     1087    15375    6                  K = 1   /*  YES_VAL  */;
     1088    15376    6               ELSE
     1089    15377    6                  K = PTR$ -> P$NODE.SUBLK$(J)
     1090    15378    6                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
     1091    15379    6               IF AS_CR_MOD_PROJ > 0  AND  K = 1   /*  YES_VAL  */
     1092    15380    6                    AND  NOT (AS_DFLT.KEY(MODE-1))
     1093    15381    7               THEN DO;
     1094    15382        /*E* ERROR:   ASA-E$KEY_NOT_ALLOWED-C
     1095    15383             MESSAGE: You are not allowed to specify KEY = %U1.
     1096    15384             MESSAGE1: KEY = %U1 was not specified for your project, so you are not
     1097    15385                       allowed to specify KEY = %U1 for a %U2 you create.
     1098    15386        */
     1099    15387                       %NUMBER( NUM1=K );
             15395    7         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, K );
     1100    15417    7                  AS_FIELD2 = TEXTC(AS_CR_MOD_PROJ-1);
     1101    15418                       %SCREAM( ERR#=E$KEY_NOT_ALLOWED, MID='C',LEVEL=ERROR);
     1102    15433    7                  GOTO LOOP_END;
     1103    15434    7                  END;
     1104    15435    6               AS_USERS.KEY(MODE-1) = ( K = 1   /*  YES_VAL  */ ) ;
     1105    15436    6               AS_MOD_USER.KEY_A(MODE-1) = K;
     1106    15437    6               END;
     1107    15438    5               END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:48   
     1108    15439        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:49   
     1109    15440                                                              /**/
     1110    15441    4         SELECT( 34 /* OUTPUTPRIO OPTION */ ) ;
     1111    15442    4         CALL ASC$OUTPUTPRIO( SUBND$ );
     1112    15443
     1113    15444                                                              /**/
     1114    15445    4         SELECT( 114 /* ACCESS_OPT */ ) ;
     1115    15446    4         ERR_CODE = '0'B ;
     1116    15447    4         CALL ACCESS_OPT ;
     1117    15448                                                              /**/
     1118    15449    4         SELECT( 115  /* PSEUDO_OPT */ ) ;
     1119    15450    4         ERR_CODE.CODE = 0 ;
     1120    15451    4         CALL ASC$PSEUDO( AS_FALSE );
     1121    15452                                                              /**/
     1122    15453    4         SELECT( 92  /*  FEPSEUDO_OPT_VAL */ ) ;
     1123    15454    4         ERR_CODE.CODE = 0 ;
     1124    15455    4         CALL ASC$FEPSEUDO( AS_FALSE );
     1125    15456    4         SELECT( 57 /* SERVICE_OPT */ ) ;
     1126    15457    4         ERR_CODE = '0'B ;
     1127    15458    4         CALL ASC$SERVICE ;
     1128    15459                                                              /**/
     1129    15460    4         SELECT( 116 /* RESOURCE_OPT */ ) ;
     1130    15461    4         ERR_CODE = '0'B ;
     1131    15462    4         CALL ASC$RESOURCE( AS_FALSE );
     1132    15463                                                              /**/
     1133    15464    4         SELECT( 117 /* TIME_OPT */ );
     1134    15465    4         CALL ASC$TIME( SUBND$ );
     1135    15466
     1136    15467    4         SELECT( 118 /* MEMORY_OPT */ );
     1137    15468    4         CALL ASC$MEMORY( SUBND$ );
     1138    15469
     1139    15470    4         SELECT( 126 /* FERESOURCE_OPT */ ) ;
     1140    15471    4         ERR_CODE = '0'B ;
     1141    15472    4         CALL ASC$FERESOURCE( AS_FALSE );
     1142    15473                                                              /**/
     1143    15474                                                              /**/
     1144    15475    4            END ;   /* Do case(code) */
     1145    15476    3   LOOP_END: ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:50   
     1146    15477    3         END ; /* Do i */
     1147    15478    2      END ; /* Do while(more) */
     1148    15479        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:51   
     1149    15480    1   OPTION_ERR: ;
     1150    15481    1   CALL ASH$ERROR( P_PCB.ERROR );
     1151    15482    1   GOTO CM_LOOP ;
     1152    15483                                                              /**/
     1153    15484        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:52   
     1154    15485    1   ACCESS_OPT: PROC ;
     1155    15486                                                              /**/
     1156    15487                                                              /**/
     1157    15488        /********************************************************************/
     1158    15489        /*   Auto data       auto data       auto data       auto data       */
     1159    15490        /*********************************************************************/
     1160    15491                                                              /**/
     1161    15492    2   DCL SUBS UBIN WORD ;
     1162    15493    2   DCL PTR$ PTR ;
     1163    15494    2   DCL I UBIN WORD ;
     1164    15495    2   DCL MODE UBIN WORD ;
     1165    15496    2   DCL PTR2$ PTR ;
     1166    15497    2   DCL OP_CODE UBIN WORD ;
     1167    15498        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:53   
     1168    15499        /********************************************************************/
     1169    15500        /*   Procedure       procedure       procedure       procedure       */
     1170    15501        /*********************************************************************/
     1171    15502                                                              /**/
     1172    15503        /*
     1173    15504            ***            Begin procedure                    ***
     1174    15505        */
     1175    15506    2   SUBS = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBNODES ;
     1176    15507    2   PTR$ = SUBND$ -> P$NODE.SUBLK$(0) ;
     1177    15508                                                                   /**/
     1178    15509    3   DO I = 0 TO SUBS-1 ;
     1179    15510    3      PTR2$ = PTR$ -> P$NODE.SUBLK$(I) ;
     1180    15511    3      MODE = PTR2$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
     1181    15512    3      IF PTR2$ -> P$NODE.SUBNODES = 1
     1182    15513    3      THEN
     1183    15514    3         OP_CODE = 1   /*  YES_VAL  */ ;
     1184    15515    3      ELSE
     1185    15516    3         OP_CODE = PTR2$ -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
     1186    15517    4      DO SELECT( MODE ) ;
     1187    15518                                                              /**/
     1188    15519    4         SELECT( 0   /*  AS_M_BATCH#   */ ) ;
     1189    15520    4         IF OP_CODE = 1   /*  YES_VAL  */
     1190    15521    5         THEN DO;
     1191    15522    5            IF AS_CR_MOD_PROJ > 0  AND  NOT AS_DFLT.BATOK
     1192    15523    5            THEN
     1193    15524    5               CALL ACCESS_ERROR;
     1194    15525    6            ELSE DO;
     1195    15526    6               KL_DREC.FLAGS.BATOK = AS_TRUE ;
     1196    15527    6               AS_USERS.BATOK = AS_TRUE ;
     1197    15528    6               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;
     1198    15529    6               END;
     1199    15530    5            END ; /* Then do */
     1200    15531    5         ELSE DO;
     1201    15532    5            KL_DREC.FLAGS.BATOK = AS_FALSE ;
     1202    15533    5            AS_USERS.BATOK = AS_FALSE ;
     1203    15534    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;
     1204    15535    5            END ; /* Else do */
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:54   
     1205    15536                                                              /**/
     1206    15537    4         SELECT( 2     /*  AS_M_INT#     */ ) ;
     1207    15538                                                              /**/
     1208    15539    4         IF OP_CODE = 1   /*  YES_VAL  */
     1209    15540    4         THEN
     1210    15541    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.OLOK
     1211    15542    4            THEN
     1212    15543    4               CALL ACCESS_ERROR;
     1213    15544    5            ELSE DO;
     1214    15545    5               KL_DREC.FLAGS.OLOK = AS_TRUE ;
     1215    15546    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;
     1216    15547    5               END;
     1217    15548    5         ELSE DO;
     1218    15549    5            KL_DREC.FLAGS.OLOK = AS_FALSE ;
     1219    15550    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;
     1220    15551    5            END;
     1221    15552                                                              /**/
     1222    15553    4         SELECT( 1   /*  AS_M_GHOST#   */ ) ;
     1223    15554                                                              /**/
     1224    15555    4         IF OP_CODE = 1   /*  YES_VAL  */
     1225    15556    4         THEN
     1226    15557    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.GHOSTOK
     1227    15558    4            THEN
     1228    15559    4               CALL ACCESS_ERROR;
     1229    15560    5            ELSE DO;
     1230    15561    5               KL_DREC.FLAGS.GHOSTOK = AS_TRUE ;
     1231    15562    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;
     1232    15563    5               END;
     1233    15564    5         ELSE DO;
     1234    15565    5            KL_DREC.FLAGS.GHOSTOK = AS_FALSE ;
     1235    15566    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;
     1236    15567    5            END ;
     1237    15568                                                              /**/
     1238    15569    4         SELECT( 3 /* AS_M_TP# */ ) ;
     1239    15570                                                              /**/
     1240    15571    4         IF OP_CODE = 1   /*  YES_VAL  */
     1241    15572    4         THEN
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:55   
     1242    15573    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.TPOK
     1243    15574    4            THEN
     1244    15575    4               CALL ACCESS_ERROR;
     1245    15576    5            ELSE DO;
     1246    15577    5               KL_DREC.FLAGS.TPOK = AS_TRUE ;
     1247    15578    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;
     1248    15579    5               END;
     1249    15580    5         ELSE DO;
     1250    15581    5            KL_DREC.FLAGS.TPOK = AS_FALSE ;
     1251    15582    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;
     1252    15583    5            END ;
     1253    15584                                                              /**/
     1254    15585    4         SELECT( 4 /* AS_M_FE# */ ) ;
     1255    15586                                                              /**/
     1256    15587    4         IF OP_CODE = 1   /*  YES_VAL  */
     1257    15588    4         THEN
     1258    15589    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.FEOK
     1259    15590    4            THEN
     1260    15591    4               CALL ACCESS_ERROR;
     1261    15592    5            ELSE DO;
     1262    15593    5               KL_DREC.FLAGS.FEOK = AS_TRUE ;
     1263    15594    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;
     1264    15595    5               END;
     1265    15596    5         ELSE DO;
     1266    15597    5            KL_DREC.FLAGS.FEOK = AS_FALSE ;
     1267    15598    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;
     1268    15599    5            END ;
     1269    15600                                                              /**/
     1270    15601    4         END ; /* Do case */
     1271    15602    3      END ; /* Do i */
     1272    15603                                                              /**/
     1273    15604    2   RETURN ;
     1274    15605                                                              /**/
     1275    15606        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:56   
     1276    15607    2   ACCESS_ERROR: PROC;
     1277    15608
     1278    15609
     1279    15610    3   AS_FIELD1 = AS_MODE_ARRY(MODE);
     1280    15611    4   DO SELECT( AS_CR_MOD_PROJ );
     1281    15612
     1282    15613    4      SELECT( %CR_PROJ_USER );
     1283    15614
     1284    15615        /*E* ERROR:   ASC-E$CANT_GIVE_ACCTO_USER-C
     1285    15616             MESSAGE: %U1 access mode not allowed.
     1286    15617             MESSAGE1: Users in your project are not allowed %U1 access mode.
     1287    15618             MESSAGE2: No user in your project may have an access mode not specified
     1288    15619                       in the default record for the project.
     1289    15620        */
     1290    15621           %SCREAM( ERR#=E$CANT_GIVE_ACCTO_USER, LEVEL=ERROR, MID='C' );
     1291    15636
     1292    15637    4      SELECT( %CR_PROJECT );
     1293    15638
     1294    15639        /*E* ERROR:   ASC-E$CANT_GIVE_ACCTO_PROJ-C
     1295    15640             MESSAGE: %U1 access mode not allowed.
     1296    15641             MESSAGE1: Projects you create are not allowed %U1 access mode.
     1297    15642             MESSAGE2: Your project does not have %U1 access, so you are not allowed
     1298    15643                       to give %U1 access to a project you create.
     1299    15644        */
     1300    15645           %SCREAM( ERR#=E$CANT_GIVE_ACCTO_PROJ, LEVEL=ERROR, MID='C' );
     1301    15660
     1302    15661    4      SELECT( %CR_PROJ_DEFAULT );
     1303    15662
     1304    15663        /*E* ERROR:   ASC-E$CANT_GIVE_ACCTO_DFLT-C
     1305    15664             MESSAGE: %U1 access mode not allowed.
     1306    15665             MESSAGE1: Users in a project you create are not allowed %U1 access mode.
     1307    15666             MESSAGE2: Your project does not have %U1 access, so you are not allowed
     1308    15667                       to give %U1 access to users in a project you create.
     1309    15668        */
     1310    15669           %SCREAM( ERR#=E$CANT_GIVE_ACCTO_DFLT, LEVEL=ERROR, MID='C' );
     1311    15684
     1312    15685    4      END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:57   
     1313    15686
     1314    15687    3   END ACCESS_ERROR;
     1315    15688    2   END   ACCESS_OPT ;
     1316    15689        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:58   
     1317    15690    1   END   ASC$CM_OPTS    ;
     1318    15691        %EOD ;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:59   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$CM_OPTS.

   Procedure ASC$CM_OPTS requires 2603 words for executable code.
   Procedure ASC$CM_OPTS requires 50 words of local(AUTO) storage.

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:60   

 Object Unit name= ASC$CM_OPTS                                File name= ASC$OPTS.:E05TOU
 UTS= JUL 29 '97 09:37:23.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    20     24  ASC$CM_OPTS
    3  RoData even  UTS     56     70  ASC$CM_OPTS
    4   Proc  even  none  2603   5053  ASC$CM_OPTS
    5  RoData even  none    71    107  ASC$CM_OPTS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  ASC$CM_OPTS
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:61   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
 yes     yes           Std       2 ASB$LEGL_CHAR
         yes           Std       1 ASC$OUTPUTPRIO
         yes           Std       4 ASB$BINCHAR
         yes           Std       0 ASC$FEPPRIV
 yes     yes           Std       1 ASD$PREC_PRO
 yes     yes           Std       1 ASB$PIG
         yes           Std       0 ASC$PRIV
         yes           Std       1 ASC$FERESOURCE
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       0 ASH$HELP
 yes     yes           Std       3 ASC$SETUP
         yes           Std       1 ASC$TIME
         yes           Std       1 ASC$BUDGET
         yes           Std       1 ASC$MEMORY
         yes           Std       1 ASC$FEPSEUDO
         yes           Std       1 ASC$RESOURCE
         yes           Std       0 ASH$QUEST
         yes           Std       0 ASC$PPRIV
 yes     yes           Std       3 ASB$READ_PROJ
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASC$FEPRIV
 yes     yes           Std       0 ASW$PREC_WSN
         yes           Std       1 ASC$PSEUDO
         yes           Std       0 ASC$SERVICE
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
         yes           Std       4 ASB$BINXCHAR
         yes           Std       2 ASH$WARN
         yes           Std       1 ASC$EXPIRE
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:62   
 yes     yes           Std       5 ASB$ACCT_OK
 yes     yes           Std       3 ASC$BANNER
 yes     yes           Std       1 ASB$PIG_ACCT_ATTR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CR_MOD_TREE                      r    AS_BLANK
r    AS_TRUE                          r    AS_FALSE                         r    AS_NONE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             PROJ_KEY                              BLANK_PASS
     IN_BUF                                NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     AS_PROJECT_ADMIN                      AS_WILD_USER                          AS_SUPER_TO_PIG$
     AS_CR_MOD_PROJ                        CR_MOD_FLG                            P_PCB
     AS_USERS                              AS_DFLT                               KL_DREC
     KL_DFLT                               AS_MOD_USER                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:63   


        1        1        /*M* ASC$OPTS: EXTERNAL ROUTINES FOR CREATE AND MODIFY OPTIONS. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*    Tabs 7,11,13,15,17,19,21,23,25,27,29,31,40,55,60   */
       11       11        /*    I   i i i i i i i i i i i        i              i    i  */
       12       12                                                              /**/
       13       13        /*  ASC$OPTS:   This module consists of procedures:
       14       14                        ASC$CM_OPTS
       15       15                        ASC$MOD_USER
       16       16        */
       17       17        /**/
       18       18        /********************************************************************/
       19       19        /*                                                                   */
       20       20        /*                   ASC$CM_OPTS         proc                        */
       21       21        /*                                                                   */
       22       22        /*********************************************************************/
       23       23                                                              /**/
       24       24        ASC$CM_OPTS: PROC (CR_MOD_KEY) ;

     24  4 000000   000000 700200 xent  ASC$CM_OPTS  TSX0  ! X66_AUTO_1
         4 000001   000062 000001                    ZERO    50,1

       25       25                                                              /**/
       26       26        %SET LISTSUB = '1'B ;
       27       27        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:64   
       28       28        /********************************************************************/
       29       29        /*   Parameters      parameters      parameters      parameters      */
       30       30        /*********************************************************************/
       31       31                                                              /**/
       32       32    1   DCL 1 CR_MOD_KEY ALIGNED ,
       33       33    1          2 CNT UBIN(9) UNAL ,
       34       34    1          2 TEXT CHAR(20) UNAL ;
       35       35                                                              /**/
       36       36        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:65   
       37       37        /********************************************************************/
       38       38        /*   Include files   include files   include files   include files   */
       39       39        /*********************************************************************/
       40       40                                                              /**/
       41       41        %INCLUDE      AS_ENTRIES_M ;
       42     1091        %INCLUDE      AS_SUPER_C ;
       43     1526        %INCLUDE      AS_SUBS_C ;
       44     2940        %INCLUDE      AS_PERR_C ;
       45     3542        %INCLUDE      KL_SUPER_C ;
       46     6444        %INCLUDE      AS_MAC_C ;
       47     6524        %INCLUDE      XU_MACRO_C ;
       48     9630        %INCLUDE      XU_FORMAT_C ;
       49     9792        %INCLUDE      CP_6 ;
       50     9873        %INCLUDE      CP_6_SUBS;
       51    10413        %INCLUDE      AS_SUPER_R ;
       52    13429                                                              /**/
       53    13430        %FPT_TIME (FPTN = MAKE_UTS,
       54    13431                    DATE = DATE_BUF,
       55    13432                    TIME = TIME_BUF,
       56    13433                    SOURCE = LOCAL,
       57    13434                    DEST = UTS,
       58    13435                    TSTAMP = UTS_BUF);
       59    13454        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:66   
       60    13455        /********************************************************************/
       61    13456        /*   Static data     static data     static data     static data     */
       62    13457        /*********************************************************************/
       63    13458                                                              /**/
       64    13459    1   DCL MORE BIT(1) STATIC ;
       65    13460    1   DCL FE_MODE BIT(1) STATIC ;
       66    13461    1   DCL 1 TEXTC(0:2) CONSTANT,
       67    13462    1          2 CNT UBIN BYTE UNAL INIT( 4, 6, 17 ),
       68    13463    1          2 TEXT CHAR(17) INIT( 'user', 'project', 'user in a project' );
       69    13464    1   DCL 1 ALL_KEYS CONSTANT ALIGNED,
       70    13465    1          2 * BIT(36) INIT('777777777777'O),
       71    13466    1          2 * BIT(36) INIT('777777777777'O);
       72    13467                                                              /**/
       73    13468        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:67   
       74    13469        /********************************************************************/
       75    13470        /*   Local based     local based     local based     local based     */
       76    13471        /*********************************************************************/
       77    13472                                                              /**/
       78    13473            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       79    13474                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       80    13519              %PARSE$SYM( NAME = OUT$SYM ,
       81    13520                          STCLASS="BASED(BLK$)") ;
       82    13558    1   DCL 1 VARY$STR BASED(STR$) ALIGNED ,
       83    13559    1          2 CNT UBIN(9) UNAL ,
       84    13560    1          2 TEXT CHAR(VARY$STR.CNT) ;
       85    13561    1   DCL BIT$72 BIT(72) BASED ALIGNED;
       86    13562        %SUPER_TO_PIG( STCLASS="BASED(AS_SUPER_TO_PIG$)" );
       87    13594                                                              /**/
       88    13595    1   DCL ACHAR CHAR(1) BASED;
       89    13596    1   DCL ABYTE UBIN(9) BASED;
       90    13597        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:68   
       91    13598        /********************************************************************/
       92    13599        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       93    13600        /*********************************************************************/
       94    13601                                                              /**/
       95    13602    1   DCL X$PARSE ENTRY(1) ALTRET ;
       96    13603        %ASB$READ_SI ;
       97    13606        %ASB$SET_PROMPT ;
       98    13609        %ASC$PRIV ;
       99    13612        %ASC$PPRIV ;
      100    13615        %ASC$FEPRIV ;
      101    13618        %ASC$FEPPRIV ;
      102    13621        %ASC$BUDGET ;
      103    13624        %ASC$TIME ;
      104    13627        %ASC$MEMORY ;
      105    13630        %ASC$SERVICE ;
      106    13633        %ASC$EXPIRE ;
      107    13636        %ASB$LEGL_CHAR ;
      108    13639        %ASZ$SCRAMBLE ;
      109    13642        %ASC$OUTPUTPRIO ;
      110    13645        %ASC$RESOURCE ;
      111    13648        %ASC$FERESOURCE ;
      112    13651        %ASC$PSEUDO ;
      113    13654        %ASC$FEPSEUDO ;
      114    13657        %ASH$HELP ;
      115    13660        %ASH$DQUEST ;
      116    13663        %ASH$QUEST ;
      117    13666        %ASH$ERROR ;
      118    13669        %ASH$WARN ;
      119    13672        %ASB$READ_PROJ ;
      120    13675        %ASB$ACCT_OK ;
      121    13678        %ASB$PIG_ACCT_ATTR ;
      122    13681        %ASB$PIG ;
      123    13684        %ASW$PREC_WSN ;
      124    13687        %ASD$PREC_PRO ;
      125    13690        %ASC$BANNER ;
      126    13693        %ASC$SETUP ;
      127    13696                                                              /**/
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:69   
      128    13697                                                              /**/
      129    13698        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:70   
      130    13699        /********************************************************************/
      131    13700        /*   Auto data       auto data       auto data       auto data       */
      132    13701        /*********************************************************************/
      133    13702                                                              /**/
      134    13703    1   DCL ALTER BIT (1);
      135    13704    1   DCL ARS SBIN ;
      136    13705    1   DCL BLK$ PTR ;
      137    13706    1   DCL BTEXT$ PTR;
      138    13707    1   DCL DATE_BUF CHAR (8) STATIC;
      139    13708    1   DCL I SBIN ;
      140    13709    1   DCL J SBIN;
      141    13710    1   DCL K UBIN;
      142    13711    1   DCL LEN UBIN;
      143    13712    1   DCL MODE UBIN;
      144    13713    1   DCL OP_CODE UBIN;
      145    13714    1   DCL P$ PTR;
      146    13715    1   DCL PTR$ PTR;
      147    13716    1   DCL STR$ PTR ;
      148    13717    1   DCL SUBNODES SBIN ;
      149    13718    1   DCL SUBND$ PTR ;
      150    13719    1   DCL SUBS UBIN;
      151    13720    1   DCL TEMP   UBIN;
      152    13721    1   DCL TEMP$ PTR;
      153    13722    1   DCL TIME_BUF CHAR (11) STATIC;
      154    13723    1   DCL UTS_BUF UBIN WORD STATIC;
      155    13724    1   DCL UTS_BUF_BIT REDEF UTS_BUF BIT (36);
      156    13725        %AS$PROJ_HEADER( NAME=PROJ_HEADER, STCLASS=AUTO );
      157    13754                                                              /**/
      158    13755        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:71   
      159    13756        /********************************************************************/
      160    13757        /*   Procedure       procedure       procedure       procedure       */
      161    13758        /*********************************************************************/
      162    13759                                                              /**/
      163    13760        /*
      164    13761            ***            Begin procedure                    ***
      165    13762        */
      166    13763    1   MORE = AS_TRUE ;

  13763  4 000002   000000 236000 xsym               LDQ     AS_TRUE
         4 000003   400000 376003                    ANQ     -131072,DU
         4 000004   000014 756000 2                  STQ     MORE

      167    13764    1   REMEMBER CM_LOOP_FCMD IN REM_FCMD ;             /*   Remember for free command  */

  13764  4 000005   000043 635000 4                  EAA     CM_LOOP_FCMD
         4 000006   000000 452400 xsym               STP2    REM_FCMD
         4 000007   000001 755000 xsym               STA     REM_FCMD+1

  13763  4 000010                       CM_LOOP      null
      168    13765                                                              /**/
      169    13766    1   CM_LOOP: ;
      170    13767    1   P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  13767  4 000010   000000 236000 5                  LDQ     0
         4 000011   000001 756000 xsym               STQ     P_PCB+1

      171    13768                                                              /**/
      172    13769    2   DO WHILE (MORE) ;

  13769  4 000012   000014 234000 2                  SZN     MORE
         4 000013   004455 605000 4                  TPL     OPTION_ERR

      173    13770    2      REMEMBER CM_LOOP IN REMEM_VAR ;

  13770  4 000014   000010 635000 4                  EAA     CM_LOOP
         4 000015   000000 452400 xsym               STP2    REMEM_VAR
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:72   
         4 000016   000001 755000 xsym               STA     REMEM_VAR+1

      174    13771                                                              /*  Set prompt  */
      175    13772    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;

  13772  4 000017   000001 630400 5                  EPPR0   1
         4 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000021   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 000022   000000 011000                    NOP     0

      176    13773    2      CALL ASB$READ_SI(IN_BUF,ARS) ;             /* Read option line */

  13773  4 000023   200005 630500                    EPPR0   ARS,,AUTO
         4 000024   200055 450500                    STP0    OP_CODE+5,,AUTO
         4 000025   000002 236000 5                  LDQ     2
         4 000026   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 000027   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 000030   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000031   000000 701000 xent               TSX1    ASB$READ_SI
         4 000032   000000 011000                    NOP     0

      177    13774    2      P_PCB.NCHARS = ARS ;

  13774  4 000033   200005 235100                    LDA     ARS,,AUTO
         4 000034   000011 755000 xsym               STA     P_PCB+9

      178    13775    2      CALL X$PARSE(P_PCB) ALTRET (OPTION_ERR) ;

  13775  4 000035   000003 630400 5                  EPPR0   3
         4 000036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000037   000000 701000 xent               TSX1    X$PARSE
         4 000040   004455 702000 4                  TSX2    OPTION_ERR

      179    13776                                                              /**/
      180    13777    2      NODE$ = P_PCB.OUT$ ;

  13777  4 000041   000003 236000 xsym               LDQ     P_PCB+3
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:73   
         4 000042   000000 756000 xsym               STQ     NODE$

  13777  4 000043                       CM_LOOP_FCMD null
      181    13778                                                              /**/
      182    13779    2   CM_LOOP_FCMD: ;
      183    13780                                                              /**/
      184    13781    2      CODE = P$NODE.CODE ;

  13781  4 000043   000000 470400 xsym               LDP0    NODE$
         4 000044   000000 236100                    LDQ     0,,PR0
         4 000045   777777 376007                    ANQ     -1,DL
         4 000046   000000 756000 xsym               STQ     CODE

      185    13782    2      SUBNODES = P$NODE.SUBNODES ;

  13782  4 000047   000001 236100                    LDQ     1,,PR0
         4 000050   000022 772000                    QRL     18
         4 000051   200021 756100                    STQ     SUBNODES,,AUTO

      186    13783                                                              /**/
      187    13784    3      DO I = 0 TO SUBNODES-1 ;

  13784  4 000052   200010 450100                    STZ     I,,AUTO
         4 000053   004450 710000 4                  TRA     LOOP_END+1

      188    13785    3         SUBND$ = P$NODE.SUBLK$(I) ;

  13785  4 000054   000000 470400 xsym               LDP0    NODE$
         4 000055   200010 720100                    LXL0    I,,AUTO
         4 000056   000003 236110                    LDQ     3,X0,PR0
         4 000057   200022 756100                    STQ     SUBND$,,AUTO

      189    13786    3         CODE = SUBND$ -> P$NODE.CODE ;

  13786  4 000060   200022 471500                    LDP1    SUBND$,,AUTO
         4 000061   100000 236100                    LDQ     0,,PR1
         4 000062   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:74   
         4 000063   000000 756000 xsym               STQ     CODE

      190    13787                                                              /**/
      191    13788    4         DO SELECT (CODE) ;

  13788  4 000064   000140 116007                    CMPQ    96,DL
         4 000065   000230 602000 4                  TNC     s:13788+100
         4 000066   000630 600000 4                  TZE     s:13914
         4 000067   000167 116007                    CMPQ    119,DL
         4 000070   000144 602000 4                  TNC     s:13788+48
         4 000071   000543 600000 4                  TZE     s:13891
         4 000072   000202 116007                    CMPQ    130,DL
         4 000073   000117 602000 4                  TNC     s:13788+27
         4 000074   002047 600000 4                  TZE     s:14477
         4 000075   000454 116007                    CMPQ    300,DL
         4 000076   000106 602000 4                  TNC     s:13788+18
         4 000077   000343 600000 4                  TZE     s:13799
         4 000100   000455 116007                    CMPQ    301,DL
         4 000101   004447 602000 4                  TNC     LOOP_END
         4 000102   000347 600000 4                  TZE     s:13802
         4 000103   000456 116007                    CMPQ    302,DL
         4 000104   004447 601000 4                  TNZ     LOOP_END
         4 000105   000337 710000 4                  TRA     s:13796
         4 000106   000207 116007                    CMPQ    135,DL
         4 000107   000114 602000 4                  TNC     s:13788+24
         4 000110   001610 600000 4                  TZE     s:14374
         4 000111   000213 116007                    CMPQ    139,DL
         4 000112   004447 601000 4                  TNZ     LOOP_END
         4 000113   002132 710000 4                  TRA     s:14539
         4 000114   000203 116007                    CMPQ    131,DL
         4 000115   004447 601000 4                  TNZ     LOOP_END
         4 000116   002237 710000 4                  TRA     s:14605
         4 000117   000174 116007                    CMPQ    124,DL
         4 000120   000133 602000 4                  TNC     s:13788+39
         4 000121   002465 600000 4                  TZE     s:14689
         4 000122   000176 116007                    CMPQ    126,DL
         4 000123   000130 602000 4                  TNC     s:13788+36
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:75   
         4 000124   004442 600000 4                  TZE     s:15471
         4 000125   000177 116007                    CMPQ    127,DL
         4 000126   004447 601000 4                  TNZ     LOOP_END
         4 000127   001673 710000 4                  TRA     s:14393
         4 000130   000175 116007                    CMPQ    125,DL
         4 000131   004447 601000 4                  TNZ     LOOP_END
         4 000132   002577 710000 4                  TRA     s:14731
         4 000133   000171 116007                    CMPQ    121,DL
         4 000134   000141 602000 4                  TNC     s:13788+45
         4 000135   003031 600000 4                  TZE     s:14857
         4 000136   000172 116007                    CMPQ    122,DL
         4 000137   004447 601000 4                  TNZ     LOOP_END
         4 000140   004114 710000 4                  TRA     s:15282
         4 000141   000170 116007                    CMPQ    120,DL
         4 000142   004447 601000 4                  TNZ     LOOP_END
         4 000143   000572 710000 4                  TRA     s:13901
         4 000144   000147 116007                    CMPQ    103,DL
         4 000145   000206 602000 4                  TNC     s:13788+82
         4 000146   001210 600000 4                  TZE     s:14161
         4 000147   000154 116007                    CMPQ    108,DL
         4 000150   000173 602000 4                  TNC     s:13788+71
         4 000151   003322 600000 4                  TZE     s:14977
         4 000152   000163 116007                    CMPQ    115,DL
         4 000153   000167 602000 4                  TNC     s:13788+67
         4 000154   004373 600000 4                  TZE     s:15450
         4 000155   000165 116007                    CMPQ    117,DL
         4 000156   000163 602000 4                  TNC     s:13788+63
         4 000157   004424 600000 4                  TZE     s:15465
         4 000160   000166 116007                    CMPQ    118,DL
         4 000161   004447 601000 4                  TNZ     LOOP_END
         4 000162   004433 710000 4                  TRA     s:15468
         4 000163   000000 235000 xsym               LDA     CODE
         4 000164   000164 115007                    CMPA    116,DL
         4 000165   004447 601000 4                  TNZ     LOOP_END
         4 000166   004416 710000 4                  TRA     s:15461
         4 000167   000000 235000 xsym               LDA     CODE
         4 000170   000162 115007                    CMPA    114,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:76   
         4 000171   004447 601000 4                  TNZ     LOOP_END
         4 000172   004367 710000 4                  TRA     s:15446
         4 000173   000000 236000 xsym               LDQ     CODE
         4 000174   000151 116007                    CMPQ    105,DL
         4 000175   000202 602000 4                  TNC     s:13788+78
         4 000176   002766 600000 4                  TZE     s:14810
         4 000177   000153 116007                    CMPQ    107,DL
         4 000200   004447 601000 4                  TNZ     LOOP_END
         4 000201   000705 710000 4                  TRA     s:13979
         4 000202   000000 235000 xsym               LDA     CODE
         4 000203   000150 115007                    CMPA    104,DL
         4 000204   004447 601000 4                  TNZ     LOOP_END
         4 000205   001323 710000 4                  TRA     s:14229
         4 000206   000000 236000 xsym               LDQ     CODE
         4 000207   000143 116007                    CMPQ    99,DL
         4 000210   000224 602000 4                  TNC     s:13788+96
         4 000211   001132 600000 4                  TZE     s:14099
         4 000212   000145 116007                    CMPQ    101,DL
         4 000213   000220 602000 4                  TNC     s:13788+92
         4 000214   003134 600000 4                  TZE     s:14904
         4 000215   000146 116007                    CMPQ    102,DL
         4 000216   004447 601000 4                  TNZ     LOOP_END
         4 000217   003142 710000 4                  TRA     s:14908
         4 000220   000000 235000 xsym               LDA     CODE
         4 000221   000144 115007                    CMPA    100,DL
         4 000222   004447 601000 4                  TNZ     LOOP_END
         4 000223   002633 710000 4                  TRA     s:14740
         4 000224   000000 235000 xsym               LDA     CODE
         4 000225   000142 115007                    CMPA    98,DL
         4 000226   004447 601000 4                  TNZ     LOOP_END
         4 000227   001017 710000 4                  TRA     s:14032
         4 000230   000000 236000 xsym               LDQ     CODE
         4 000231   000066 116007                    CMPQ    54,DL
         4 000232   000267 602000 4                  TNC     s:13788+131
         4 000233   002633 600000 4                  TZE     s:14740
         4 000234   000120 116007                    CMPQ    80,DL
         4 000235   000254 602000 4                  TNC     s:13788+120
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:77   
         4 000236   003127 600000 4                  TZE     s:14900
         4 000237   000132 116007                    CMPQ    90,DL
         4 000240   000250 602000 4                  TNC     s:13788+116
         4 000241   003156 600000 4                  TZE     s:14915
         4 000242   000133 116007                    CMPQ    91,DL
         4 000243   004447 602000 4                  TNC     LOOP_END
         4 000244   003426 600000 4                  TZE     s:15033
         4 000245   000134 116007                    CMPQ    92,DL
         4 000246   004447 601000 4                  TNZ     LOOP_END
         4 000247   004402 710000 4                  TRA     s:15454
         4 000250   000000 235000 xsym               LDA     CODE
         4 000251   000131 115007                    CMPA    89,DL
         4 000252   004447 601000 4                  TNZ     LOOP_END
         4 000253   000760 710000 4                  TRA     s:14019
         4 000254   000000 236000 xsym               LDQ     CODE
         4 000255   000073 116007                    CMPQ    59,DL
         4 000256   000263 602000 4                  TNC     s:13788+127
         4 000257   003121 600000 4                  TZE     s:14896
         4 000260   000074 116007                    CMPQ    60,DL
         4 000261   004447 601000 4                  TNZ     LOOP_END
         4 000262   003147 710000 4                  TRA     s:14911
         4 000263   000000 235000 xsym               LDA     CODE
         4 000264   000071 115007                    CMPA    57,DL
         4 000265   004447 601000 4                  TNZ     LOOP_END
         4 000266   004411 710000 4                  TRA     s:15457
         4 000267   000000 236000 xsym               LDQ     CODE
         4 000270   000055 116007                    CMPQ    45,DL
         4 000271   000305 602000 4                  TNC     s:13788+145
         4 000272   000353 600000 4                  TZE     s:13805
         4 000273   000061 116007                    CMPQ    49,DL
         4 000274   000301 602000 4                  TNC     s:13788+141
         4 000275   002350 600000 4                  TZE     s:14646
         4 000276   000062 116007                    CMPQ    50,DL
         4 000277   004447 601000 4                  TNZ     LOOP_END
         4 000300   002622 710000 4                  TRA     s:14736
         4 000301   000000 235000 xsym               LDA     CODE
         4 000302   000060 115007                    CMPA    48,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:78   
         4 000303   004447 601000 4                  TNZ     LOOP_END
         4 000304   001440 710000 4                  TRA     s:14296
         4 000305   000000 236000 xsym               LDQ     CODE
         4 000306   000040 116007                    CMPQ    32,DL
         4 000307   000317 602000 4                  TNC     s:13788+155
         4 000310   003656 600000 4                  TZE     s:15153
         4 000311   000041 116007                    CMPQ    33,DL
         4 000312   004447 602000 4                  TNC     LOOP_END
         4 000313   004012 600000 4                  TZE     s:15219
         4 000314   000042 116007                    CMPQ    34,DL
         4 000315   004447 601000 4                  TNZ     LOOP_END
         4 000316   004360 710000 4                  TRA     s:15442
         4 000317   000032 116007                    CMPQ    26,DL
         4 000320   000325 602000 4                  TNC     s:13788+161
         4 000321   000330 600000 4                  TZE     s:13791
         4 000322   000037 116007                    CMPQ    31,DL
         4 000323   004447 601000 4                  TNZ     LOOP_END
         4 000324   003573 710000 4                  TRA     s:15099
         4 000325   000014 116007                    CMPQ    12,DL
         4 000326   004447 601000 4                  TNZ     LOOP_END
         4 000327   000330 710000 4                  TRA     s:13791

      192    13789                                                              /**/
      193    13790    4            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */) ;

      194    13791    4            USERS_KEY = CR_MOD_KEY ;        /* End or blank input */

  13791  4 000330   200003 470500                    LDP0    @CR_MOD_KEY,,AUTO
         4 000331   000000 100500                    MLR     fill='000'O
         4 000332   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         4 000333   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      195    13792    4            ERR_CODE.CODE = 0 ;

  13792  4 000334   000004 236000 5                  LDQ     4
         4 000335   000000 356000 xsym               ANSQ    ERR_CODE

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:79   
      196    13793    4            RETURN ;

  13793  4 000336   000000 702200 xent               TSX2  ! X66_ARET

      197    13794                                                              /**/
      198    13795    4            SELECT(302 /* HELP_VAL */) ;

      199    13796    4            CALL ASH$HELP ;

  13796  4 000337   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000340   000000 701000 xent               TSX1    ASH$HELP
         4 000341   000000 011000                    NOP     0
         4 000342   004447 710000 4                  TRA     LOOP_END

      200    13797                                                              /**/
      201    13798    4            SELECT(300 /* DQUESTION_VAL */) ;

      202    13799    4            CALL ASH$DQUEST ;

  13799  4 000343   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000344   000000 701000 xent               TSX1    ASH$DQUEST
         4 000345   000000 011000                    NOP     0
         4 000346   004447 710000 4                  TRA     LOOP_END

      203    13800                                                              /**/
      204    13801    4            SELECT(301 /* QUESTION_VAL */) ;

      205    13802    4            CALL ASH$QUEST ;

  13802  4 000347   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000350   000000 701000 xent               TSX1    ASH$QUEST
         4 000351   000000 011000                    NOP     0
         4 000352   004447 710000 4                  TRA     LOOP_END

      206    13803        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:80   
      207    13804    4            SELECT( 45   /*  PASSWORD_ALT_VAL */ );

      208    13805    4            ERR_CODE.CODE = 0;

  13805  4 000353   000004 236000 5                  LDQ     4
         4 000354   000000 356000 xsym               ANSQ    ERR_CODE

      209    13806    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  13806  4 000355   200022 470500                    LDP0    SUBND$,,AUTO
         4 000356   000003 236100                    LDQ     3,,PR0
         4 000357   200016 756100                    STQ     P$,,AUTO

      210    13807    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */

  13807  4 000360   200016 471500                    LDP1    P$,,AUTO
         4 000361   100000 720100                    LXL0    0,,PR1
         4 000362   000007 100003                    CMPX0   7,DU
         4 000363   000372 601000 4                  TNZ     s:13812

      211    13808    5            THEN DO;

      212    13809    5               KL_DREC.PASSWORD = BLANK_PASS;

  13809  4 000364   040000 100400                    MLR     fill='040'O
         4 000365   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 000366   000002 000010 xsym               ADSC9   KL_DREC+2                cn=0,n=8

      213    13810    5               AS_MOD_USER.PASSWORD = %YES#;

  13810  4 000367   400000 236003                    LDQ     -131072,DU
         4 000370   000000 256000 xsym               ORSQ    AS_MOD_USER

      214    13811    5               END;   /*  None val  */

  13811  4 000371   004447 710000 4                  TRA     LOOP_END

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:81   
      215    13812    5            ELSE IF P$ -> P$NODE.CODE = 46   /*  PASS_WORD_VAL */ THEN DO;

  13812  4 000372   000056 100003                    CMPX0   46,DU
         4 000373   000440 601000 4                  TNZ     s:13846

      216    13813    5                  STR$ = P$ -> P$NODE.SUBLK$(0);

  13813  4 000374   100003 236100                    LDQ     3,,PR1
         4 000375   200020 756100                    STQ     STR$,,AUTO

      217    13814    5                  LEN = VARY$STR.CNT;

  13814  4 000376   200020 473500                    LDP3    STR$,,AUTO
         4 000377   300000 236100                    LDQ     0,,PR3
         4 000400   000033 772000                    QRL     27
         4 000401   200013 756100                    STQ     LEN,,AUTO

      218    13815    5                  IF LEN > 8

  13815  4 000402   000011 116007                    CMPQ    9,DL
         4 000403   000411 602000 4                  TNC     s:13838

      219    13816    6                  THEN DO;

      220    13817        /*E*  ERROR:    ASC-E$PASSWORD_TOO_LONG-C
      221    13818              MESSAGE: PASSWORD too long.
      222    13819              MESSAGE1: PASSWORD can be at most 8 characters long.
      223    13820        */
      224    13821                          %SCREAM(ERR#=E$PASSWORD_TOO_LONG,LEVEL=ERROR,MID='C');

  13833  4 000404   000005 630400 5                  EPPR0   5
         4 000405   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000406   000000 701000 xent               TSX1    ASH$ERROR
         4 000407   000000 011000                    NOP     0

      225    13836    6                     END; /*  Length error  */

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:82   
  13836  4 000410   004447 710000 4                  TRA     LOOP_END

      226    13837    6                  ELSE DO;

      227    13838    6                     CALL ASB$LEGL_CHAR( VARY$STR.TEXT, LEN ) ALTRET(BAD_CHAR);

  13838  4 000411   200013 634500                    EPPR4   LEN,,AUTO
         4 000412   200055 454500                    STP4    OP_CODE+5,,AUTO
         4 000413   200020 236100                    LDQ     STR$,,AUTO
         4 000414   200000 036007                    ADLQ    65536,DL
         4 000415   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 000416   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 000417   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000420   000000 701000 xent               TSX1    ASB$LEGL_CHAR
         4 000421   000437 702000 4                  TSX2    BAD_CHAR

      228    13839    6                     KL_DREC.PASSWORD = VARY$STR.TEXT;

  13839  4 000422   200020 470500                    LDP0    STR$,,AUTO
         4 000423   000000 236100                    LDQ     0,,PR0
         4 000424   000033 772000                    QRL     27
         4 000425   000000 620006                    EAX0    0,QL
         4 000426   040000 100540                    MLR     fill='040'O
         4 000427   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         4 000430   000002 000010 xsym               ADSC9   KL_DREC+2                cn=0,n=8

      229    13840    6                     CALL ASZ$SCRAMBLE( KL_DREC.PASSWORD );

  13840  4 000431   000006 630400 5                  EPPR0   6
         4 000432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000433   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000434   000000 011000                    NOP     0

      230    13841    6                     AS_MOD_USER.PASSWORD = %YES#;

  13841  4 000435   400000 236003                    LDQ     -131072,DU
         4 000436   000000 256000 xsym               ORSQ    AS_MOD_USER
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:83   

  13841  4 000437                       BAD_CHAR     null
      231    13842    6   BAD_CHAR:         ;
      232    13843    6                     END; /*  Length ok  */

      233    13844    5                  END; /*  PASS_WORD_VAL  */

  13844  4 000437   004447 710000 4                  TRA     LOOP_END

      234    13845    5               ELSE DO;

      235    13846    5                  STR$ = P$ -> P$NODE.SUBLK$(0) -> OUT$SYM.TEXTC$;

  13846  4 000440   100003 473500                    LDP3    3,,PR1
         4 000441   300003 236100                    LDQ     3,,PR3
         4 000442   200020 756100                    STQ     STR$,,AUTO

      236    13847    5                  LEN = VARY$STR.CNT;

  13847  4 000443   200020 474500                    LDP4    STR$,,AUTO
         4 000444   400000 236100                    LDQ     0,,PR4
         4 000445   000033 772000                    QRL     27
         4 000446   200013 756100                    STQ     LEN,,AUTO

      237    13848    5                  IF LEN ~= 24

  13848  4 000447   000030 116007                    CMPQ    24,DL
         4 000450   000456 600000 4                  TZE     s:13871

      238    13849    6                  THEN DO;

      239    13850        /*E*  ERROR:    ASC-E$OCTAL_PASSWORD_LENGTH_ERR-C
      240    13851              MESSAGE: PASSWORD not the right size.
      241    13852              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      242    13853        */
      243    13854                          %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='C');

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:84   
  13866  4 000451   000007 630400 5                  EPPR0   7
         4 000452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000453   000000 701000 xent               TSX1    ASH$ERROR
         4 000454   000000 011000                    NOP     0

      244    13869    6                     END; /*  Length error  */

  13869  4 000455   004447 710000 4                  TRA     LOOP_END

      245    13870    6                  ELSE DO;

      246    13871    6                     P$ = PINCRC (STR$,1);

  13871  4 000456   200020 236100                    LDQ     STR$,,AUTO
         4 000457   200000 036007                    ADLQ    65536,DL
         4 000460   200016 756100                    STQ     P$,,AUTO

      247    13872    6                     PTR$ = PINCRC (P$,24);

  13872  4 000461   000006 036003                    ADLQ    6,DU
         4 000462   200017 756100                    STQ     PTR$,,AUTO

      248    13873    6                     TEMP$ = ADDR (KL_DREC.PASSWORD);

  13873  4 000463   000006 236000 5                  LDQ     6
         4 000464   200025 756100                    STQ     TEMP$,,AUTO

      249    13874    7                     DO WHILE P$ < PTR$ ;

  13874  4 000465   200016 236100                    LDQ     P$,,AUTO
         4 000466   200017 116100                    CMPQ    PTR$,,AUTO
         4 000467   000540 603000 4                  TRC     s:13885

      250    13875    7                        CALL CHARBIN (I, P$->ACHAR);

  13875  4 000470   200016 470500                    LDP0    P$,,AUTO
         4 000471   000100 305500                    DTB
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:85   
         4 000472   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 000473   200010 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      251    13876    7                        P$ = PINCRC (P$,1);

  13876  4 000474   200016 236100                    LDQ     P$,,AUTO
         4 000475   200000 036007                    ADLQ    65536,DL
         4 000476   200016 756100                    STQ     P$,,AUTO

      252    13877    7                        CALL CHARBIN (J, P$-> ACHAR);

  13877  4 000477   200016 470500                    LDP0    P$,,AUTO
         4 000500   000100 305500                    DTB
         4 000501   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 000502   200011 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      253    13878    7                        P$ = PINCRC (P$,1);

  13878  4 000503   200000 036007                    ADLQ    65536,DL
         4 000504   200016 756100                    STQ     P$,,AUTO

      254    13879    7                        CALL CHARBIN (K, P$->ACHAR);

  13879  4 000505   200016 470500                    LDP0    P$,,AUTO
         4 000506   000100 305500                    DTB
         4 000507   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 000510   200012 000004                    NDSC9   K,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      255    13880    7                        TEMP = I * 64 + J * 8 + K;

  13880  4 000511   200010 236100                    LDQ     I,,AUTO
         4 000512   000003 736000                    QLS     3
         4 000513   200011 036100                    ADLQ    J,,AUTO
         4 000514   000003 736000                    QLS     3
         4 000515   200012 036100                    ADLQ    K,,AUTO
         4 000516   200024 756100                    STQ     TEMP,,AUTO

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:86   
      256    13881    7                        P$ = PINCRC (P$, 1);

  13881  4 000517   200016 236100                    LDQ     P$,,AUTO
         4 000520   200000 036007                    ADLQ    65536,DL
         4 000521   200016 756100                    STQ     P$,,AUTO

      257    13882    7                        TEMP$ -> ACHAR = BINASC ( TEMP );

  13882  4 000522   200024 236100                    LDQ     TEMP,,AUTO
         4 000523   000033 736000                    QLS     27
         4 000524   000010 276000 5                  ORQ     8
         4 000525   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 000526   200025 470500                    LDP0    TEMP$,,AUTO
         4 000527   040100 100500                    MLR     fill='040'O
         4 000530   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 000531   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      258    13883    7                        TEMP$ = PINCRC (TEMP$, 1);

  13883  4 000532   200025 236100                    LDQ     TEMP$,,AUTO
         4 000533   200000 036007                    ADLQ    65536,DL
         4 000534   200025 756100                    STQ     TEMP$,,AUTO

      259    13884    7                        END; /*  Do while P$ < PTR$  */

  13884  4 000535   200016 236100                    LDQ     P$,,AUTO
         4 000536   200017 116100                    CMPQ    PTR$,,AUTO
         4 000537   000470 602000 4                  TNC     s:13875

      260    13885    6                     AS_MOD_USER.PASSWORD = %YES#;

  13885  4 000540   400000 236003                    LDQ     -131072,DU
         4 000541   000000 256000 xsym               ORSQ    AS_MOD_USER

      261    13886    6                     END; /*  Length ok  */

      262    13887    5                  END; /*  Else  */
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:87   

  13887  4 000542   004447 710000 4                  TRA     LOOP_END

      263    13888
      264    13889        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:88   
      265    13890    4            SELECT( 119 /* NATIVE LANG. */ ) ;

      266    13891    4            ERR_CODE = '0'B ;

  13891  4 000543   000000 450000 xsym               STZ     ERR_CODE

      267    13892    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  13892  4 000544   100003 236100                    LDQ     3,,PR1
         4 000545   200016 756100                    STQ     P$,,AUTO

      268    13893    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */

  13893  4 000546   200016 473500                    LDP3    P$,,AUTO
         4 000547   300000 721100                    LXL1    0,,PR3
         4 000550   000007 101003                    CMPX1   7,DU
         4 000551   000555 601000 4                  TNZ     s:13897

      269    13894    4            THEN
      270    13895    4               AS_USERS.NAT_LANG = AS_BLANK ;

  13895  4 000552   000000 236000 xsym               LDQ     AS_BLANK
         4 000553   000005 552040 xsym               STBQ    AS_USERS+5,'40'O
         4 000554   000564 710000 4                  TRA     s:13898

      271    13896    4            ELSE
      272    13897    4               AS_USERS.NAT_LANG = P$-> P$NODE.SUBLK$(0)-> VARY$STR.TEXT ;

  13897  4 000555   300003 474500                    LDP4    3,,PR3
         4 000556   400000 236100                    LDQ     0,,PR4
         4 000557   000033 772000                    QRL     27
         4 000560   000000 622006                    EAX2    0,QL
         4 000561   040000 100540                    MLR     fill='040'O
         4 000562   400000 200012                    ADSC9   0,,PR4                   cn=1,n=*X2
         4 000563   000005 000001 xsym               ADSC9   AS_USERS+5               cn=0,n=1

      273    13898    4            AS_MOD_USER.NAT_LANG = AS_TRUE;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:89   

  13898  4 000564   000000 236000 xsym               LDQ     AS_TRUE
         4 000565   000001 772000                    QRL     1
         4 000566   000000 676000 xsym               ERQ     AS_MOD_USER
         4 000567   200000 376003                    ANQ     65536,DU
         4 000570   000000 656000 xsym               ERSQ    AS_MOD_USER
         4 000571   004447 710000 4                  TRA     LOOP_END

      274    13899        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:90   
      275    13900    4            SELECT( 120 /* STEP ACCNT */ ) ;

      276    13901    4            ERR_CODE = '0'B ;

  13901  4 000572   000000 450000 xsym               STZ     ERR_CODE

      277    13902    4            IF SUBND$ -> P$NODE.SUBNODES = 0

  13902  4 000573   100001 221100                    LDX1    1,,PR1
         4 000574   000603 601000 4                  TNZ     s:13906

      278    13903    4            THEN
      279    13904    4               AS_USERS.STEPACCNT = AS_TRUE ;

  13904  4 000575   000000 236000 xsym               LDQ     AS_TRUE
         4 000576   000011 772000                    QRL     9
         4 000577   000005 676000 xsym               ERQ     AS_USERS+5
         4 000600   000400 376003                    ANQ     256,DU
         4 000601   000005 656000 xsym               ERSQ    AS_USERS+5
         4 000602   000622 710000 4                  TRA     s:13911

      280    13905    4            ELSE
      281    13906    4               IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1   /*  YES_VAL  */

  13906  4 000603   100003 473500                    LDP3    3,,PR1
         4 000604   300000 722100                    LXL2    0,,PR3
         4 000605   000001 102003                    CMPX2   1,DU
         4 000606   000615 601000 4                  TNZ     s:13910

      282    13907    4               THEN
      283    13908    4                  AS_USERS.STEPACCNT = AS_TRUE ;

  13908  4 000607   000000 236000 xsym               LDQ     AS_TRUE
         4 000610   000011 772000                    QRL     9
         4 000611   000005 676000 xsym               ERQ     AS_USERS+5
         4 000612   000400 376003                    ANQ     256,DU
         4 000613   000005 656000 xsym               ERSQ    AS_USERS+5
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:91   
         4 000614   000622 710000 4                  TRA     s:13911

      284    13909    4               ELSE
      285    13910    4                  AS_USERS.STEPACCNT = AS_FALSE ;

  13910  4 000615   000000 236000 xsym               LDQ     AS_FALSE
         4 000616   000011 772000                    QRL     9
         4 000617   000005 676000 xsym               ERQ     AS_USERS+5
         4 000620   000400 376003                    ANQ     256,DU
         4 000621   000005 656000 xsym               ERSQ    AS_USERS+5

      286    13911    4            AS_MOD_USER.STEPACCNT = AS_TRUE ;

  13911  4 000622   000000 236000 xsym               LDQ     AS_TRUE
         4 000623   000002 772000                    QRL     2
         4 000624   000000 676000 xsym               ERQ     AS_MOD_USER
         4 000625   100000 376003                    ANQ     32768,DU
         4 000626   000000 656000 xsym               ERSQ    AS_MOD_USER
         4 000627   004447 710000 4                  TRA     LOOP_END

      287    13912        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:92   
      288    13913    4            SELECT( 96  /*  BATNUM_OPT_VAL */ ) ;

      289    13914    4            ERR_CODE = '0'B ;

  13914  4 000630   000000 450000 xsym               STZ     ERR_CODE

      290    13915    4            IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 7   /*  NONE_VAL  */ THEN

  13915  4 000631   100003 473500                    LDP3    3,,PR1
         4 000632   300000 721100                    LXL1    0,,PR3
         4 000633   000007 101003                    CMPX1   7,DU
         4 000634   000640 601000 4                  TNZ     s:13918

      291    13916    4               J = -1;

  13916  4 000635   000001 335007                    LCA     1,DL
         4 000636   200011 755100                    STA     J,,AUTO
         4 000637   000651 710000 4                  TRA     s:13921

      292    13917    5            ELSE DO;

      293    13918    5               STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  13918  4 000640   300003 236100                    LDQ     3,,PR3
         4 000641   200020 756100                    STQ     STR$,,AUTO

      294    13919    5               CALL CHARBIN( J, VARY$STR.TEXT ) ;

  13919  4 000642   200020 474500                    LDP4    STR$,,AUTO
         4 000643   400000 236100                    LDQ     0,,PR4
         4 000644   000033 772000                    QRL     27
         4 000645   000000 622006                    EAX2    0,QL
         4 000646   000100 305540                    DTB
         4 000647   400000 230012                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 000650   200011 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      295    13920    5               END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:93   

      296    13921    4            AS_USERS.BATNUM = J ;

  13921  4 000651   200011 721100                    LXL1    J,,AUTO
         4 000652   000005 441000 xsym               SXL1    AS_USERS+5

      297    13922    4            IF AS_CR_MOD_PROJ > 0   AND  AS_DFLT.BATNUM ~= -1

  13922  4 000653   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 000654   000702 604400 4                  TMOZ    s:13976
         4 000655   000005 722000 xsym               LXL2    AS_DFLT+5
         4 000656   777777 102003                    CMPX2   -1,DU
         4 000657   000702 600000 4                  TZE     s:13976

      298    13923    4            THEN
      299    13924    4               IF J > AS_DFLT.BATNUM OR J = -1

  13924  4 000660   000005 236000 xsym               LDQ     AS_DFLT+5
         4 000661   000022 736000                    QLS     18
         4 000662   000022 732000                    QRS     18
         4 000663   200011 116100                    CMPQ    J,,AUTO
         4 000664   000670 604000 4                  TMI     s:13936
         4 000665   200011 235100                    LDA     J,,AUTO
         4 000666   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000667   000702 601000 4                  TNZ     s:13976

      300    13925    5               THEN DO ;

      301    13926                       %NUMBER( NUM1 = AS_DFLT.BATNUM, SIGN1=YES );
             13936    5         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, AS_DFLT.BATNUM );

  13936  4 000670   000011 630400 5                  EPPR0   9
         4 000671   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000672   000000 701000 xent               TSX1    ASB$BINXCHAR
         4 000673   000000 011000                    NOP     0

      302    13956        /*E*  ERROR:  ASC-E$BATNUM_LIMIT-C
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:94   
      303    13957              MESSAGE: BATNUM value is too large. Set to maximum of %U1.
      304    13958        */
      305    13959                       %SCREAM( ERR#=E$BATNUM_LIMIT, LEVEL=ERROR, MID='C') ;

  13971  4 000674   000015 630400 5                  EPPR0   13
         4 000675   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000676   000000 701000 xent               TSX1    ASH$ERROR
         4 000677   000000 011000                    NOP     0

      306    13974    5                  AS_USERS.BATNUM = AS_DFLT.BATNUM ;

  13974  4 000700   000005 720000 xsym               LXL0    AS_DFLT+5
         4 000701   000005 440000 xsym               SXL0    AS_USERS+5

      307    13975    5                  END ;

      308    13976    4            AS_MOD_USER.BATNUM = %YES# ;

  13976  4 000702   040000 236003                    LDQ     16384,DU
         4 000703   000000 256000 xsym               ORSQ    AS_MOD_USER
         4 000704   004447 710000 4                  TRA     LOOP_END

      309    13977        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:95   
      310    13978    4            SELECT( 107 /* FEDBACCN_OPT_VAL */ );

      311    13979    4            ERR_CODE.CODE = 0;

  13979  4 000705   000004 236000 5                  LDQ     4
         4 000706   000000 356000 xsym               ANSQ    ERR_CODE

      312    13980    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  13980  4 000707   200022 470500                    LDP0    SUBND$,,AUTO
         4 000710   000003 236100                    LDQ     3,,PR0
         4 000711   200016 756100                    STQ     P$,,AUTO

      313    13981    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */

  13981  4 000712   200016 471500                    LDP1    P$,,AUTO
         4 000713   100000 720100                    LXL0    0,,PR1
         4 000714   000007 100003                    CMPX0   7,DU
         4 000715   000727 601000 4                  TNZ     s:13987

      314    13982    5            THEN DO;

      315    13983    5               KL_DREC.KL_DREC_FEBLK.DBACCN = BLANK_PASS;

  13983  4 000716   040000 100400                    MLR     fill='040'O
         4 000717   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 000720   000026 000010 xsym               ADSC9   KL_DREC+22               cn=0,n=8

      316    13984    5               AS_MOD_USER.FEDBACCN = AS_TRUE;

  13984  4 000721   000000 236000 xsym               LDQ     AS_TRUE
         4 000722   000036 772000                    QRL     30
         4 000723   000050 676000 xsym               ERQ     AS_MOD_USER+40
         4 000724   000040 376007                    ANQ     32,DL
         4 000725   000050 656000 xsym               ERSQ    AS_MOD_USER+40

      317    13985    5               END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:96   

  13985  4 000726   004447 710000 4                  TRA     LOOP_END

      318    13986    5            ELSE DO;

      319    13987    5               STR$ = P$ -> P$NODE.SUBLK$(0);

  13987  4 000727   100003 236100                    LDQ     3,,PR1
         4 000730   200020 756100                    STQ     STR$,,AUTO

      320    13988    5               LEN = VARY$STR.CNT;

  13988  4 000731   200020 473500                    LDP3    STR$,,AUTO
         4 000732   300000 236100                    LDQ     0,,PR3
         4 000733   000033 772000                    QRL     27
         4 000734   200013 756100                    STQ     LEN,,AUTO

      321    13989    5               IF LEN > 8

  13989  4 000735   000011 116007                    CMPQ    9,DL
         4 000736   000744 602000 4                  TNC     s:14012

      322    13990    6               THEN DO;

      323    13991        /*E*  ERROR:    ASC-E$FEDBACCN_TOO_LONG-C
      324    13992              MESSAGE: FEDBACCN too long.
      325    13993              MESSAGE1: FEDBACCN can be at most 8 characters long.
      326    13994        */
      327    13995                       %SCREAM(ERR#=E$FEDBACCN_TOO_LONG,LEVEL=ERROR,MID='C');

  14007  4 000737   000016 630400 5                  EPPR0   14
         4 000740   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000741   000000 701000 xent               TSX1    ASH$ERROR
         4 000742   000000 011000                    NOP     0

      328    14010    6                  END;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:97   
  14010  4 000743   004447 710000 4                  TRA     LOOP_END

      329    14011    6               ELSE DO;

      330    14012    6                  KL_DREC.KL_DREC_FEBLK.DBACCN = VARY$STR.TEXT;

  14012  4 000744   300000 236100                    LDQ     0,,PR3
         4 000745   000033 772000                    QRL     27
         4 000746   000000 620006                    EAX0    0,QL
         4 000747   040000 100540                    MLR     fill='040'O
         4 000750   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         4 000751   000026 000010 xsym               ADSC9   KL_DREC+22               cn=0,n=8

      331    14013    6                  AS_MOD_USER.FEDBACCN = AS_TRUE;

  14013  4 000752   000000 236000 xsym               LDQ     AS_TRUE
         4 000753   000036 772000                    QRL     30
         4 000754   000050 676000 xsym               ERQ     AS_MOD_USER+40
         4 000755   000040 376007                    ANQ     32,DL
         4 000756   000050 656000 xsym               ERSQ    AS_MOD_USER+40

      332    14014    6                  END;

      333    14015    5               END;

  14015  4 000757   004447 710000 4                  TRA     LOOP_END

      334    14016
      335    14017        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:98   
      336    14018    4            SELECT( 89   /*  FESTEPACCNT_OPT_VAL */ ) ;

      337    14019    4            ERR_CODE = '0'B ;

  14019  4 000760   000000 450000 xsym               STZ     ERR_CODE

      338    14020    4            IF SUBND$ -> P$NODE.SUBNODES = 0

  14020  4 000761   200022 470500                    LDP0    SUBND$,,AUTO
         4 000762   000001 220100                    LDX0    1,,PR0
         4 000763   000772 601000 4                  TNZ     s:14024

      339    14021    4            THEN
      340    14022    4               KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT = AS_TRUE ;

  14022  4 000764   000000 236000 xsym               LDQ     AS_TRUE
         4 000765   000033 772000                    QRL     27
         4 000766   000031 676000 xsym               ERQ     KL_DREC+25
         4 000767   000400 376007                    ANQ     256,DL
         4 000770   000031 656000 xsym               ERSQ    KL_DREC+25
         4 000771   001011 710000 4                  TRA     s:14029

      341    14023    4            ELSE
      342    14024    4               IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1   /*  YES_VAL  */

  14024  4 000772   000003 471500                    LDP1    3,,PR0
         4 000773   100000 721100                    LXL1    0,,PR1
         4 000774   000001 101003                    CMPX1   1,DU
         4 000775   001004 601000 4                  TNZ     s:14028

      343    14025    4               THEN
      344    14026    4                  KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT = AS_TRUE ;

  14026  4 000776   000000 236000 xsym               LDQ     AS_TRUE
         4 000777   000033 772000                    QRL     27
         4 001000   000031 676000 xsym               ERQ     KL_DREC+25
         4 001001   000400 376007                    ANQ     256,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:99   
         4 001002   000031 656000 xsym               ERSQ    KL_DREC+25
         4 001003   001011 710000 4                  TRA     s:14029

      345    14027    4               ELSE
      346    14028    4                  KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT = AS_FALSE ;

  14028  4 001004   000000 236000 xsym               LDQ     AS_FALSE
         4 001005   000033 772000                    QRL     27
         4 001006   000031 676000 xsym               ERQ     KL_DREC+25
         4 001007   000400 376007                    ANQ     256,DL
         4 001010   000031 656000 xsym               ERSQ    KL_DREC+25

      347    14029    4            AS_MOD_USER.FESTEPACCNT = AS_TRUE ;

  14029  4 001011   000000 236000 xsym               LDQ     AS_TRUE
         4 001012   000005 772000                    QRL     5
         4 001013   000051 676000 xsym               ERQ     AS_MOD_USER+41
         4 001014   010000 376003                    ANQ     4096,DU
         4 001015   000051 656000 xsym               ERSQ    AS_MOD_USER+41
         4 001016   004447 710000 4                  TRA     LOOP_END

      348    14030
      349    14031    4            SELECT( 98 /* FEMINTS_OPT_VAL */ ) ;

      350    14032    4            ERR_CODE = '0'B ;

  14032  4 001017   000000 450000 xsym               STZ     ERR_CODE

      351    14033    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;

  14033  4 001020   200022 470500                    LDP0    SUBND$,,AUTO
         4 001021   000001 236100                    LDQ     1,,PR0
         4 001022   000022 772000                    QRL     18
         4 001023   000001 136007                    SBLQ    1,DL
         4 001024   200023 756100                    STQ     SUBS,,AUTO

      352    14034    5            DO J = 0 TO SUBS ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:100  

  14034  4 001025   200011 450100                    STZ     J,,AUTO
         4 001026   001125 710000 4                  TRA     s:14096+1

      353    14035    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14035  4 001027   200022 470500                    LDP0    SUBND$,,AUTO
         4 001030   200011 720100                    LXL0    J,,AUTO
         4 001031   000003 236110                    LDQ     3,X0,PR0
         4 001032   200016 756100                    STQ     P$,,AUTO

      354    14036    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14036  4 001033   200016 471500                    LDP1    P$,,AUTO
         4 001034   100003 473500                    LDP3    3,,PR1
         4 001035   300000 236100                    LDQ     0,,PR3
         4 001036   777777 376007                    ANQ     -1,DL
         4 001037   200014 756100                    STQ     MODE,,AUTO

      355    14037    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;

  14037  4 001040   100004 473500                    LDP3    4,,PR1
         4 001041   300003 236100                    LDQ     3,,PR3
         4 001042   200020 756100                    STQ     STR$,,AUTO

      356    14038    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;

  14038  4 001043   200020 474500                    LDP4    STR$,,AUTO
         4 001044   400000 236100                    LDQ     0,,PR4
         4 001045   000033 772000                    QRL     27
         4 001046   000000 621006                    EAX1    0,QL
         4 001047   000100 305540                    DTB
         4 001050   400000 230011                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 001051   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 001052   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 001053   200012 755100                    STA     K,,AUTO

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:101  
      357    14039    5               KL_DREC.KL_DREC_FEBLK.MINTS(MODE) = K ;

  14039  4 001054   200014 236100                    LDQ     MODE,,AUTO
         4 001055   000006 101500                    MRL     fill='000'O
         4 001056   200012 000004                    ADSC9   K,,AUTO                  cn=0,n=4
         4 001057   000030 000001 xsym               ADSC9   KL_DREC+24,Q             cn=0,n=1

      358    14040    5               IF AS_CR_MOD_PROJ > 0

  14040  4 001060   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 001061   001120 604400 4                  TMOZ    s:14095

      359    14041    5               THEN
      360    14042    5                  IF K > KL_DFLT.KL_DFLT_FEBLK.MINTS(MODE)

  14042  4 001062   000100 101406                    MRL     fill='000'O
         4 001063   000030 000001 xsym               ADSC9   KL_DFLT+24,Q             cn=0,n=1
         4 001064   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 001065   200054 236100                    LDQ     OP_CODE+4,,AUTO
         4 001066   200012 116100                    CMPQ    K,,AUTO
         4 001067   001120 603000 4                  TRC     s:14095

      361    14043    6                  THEN DO ;

      362    14044    6                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;

  14044  4 001070   200014 236100                    LDQ     MODE,,AUTO
         4 001071   000007 402007                    MPY     7,DL
         4 001072   000000 100406                    MLR     fill='000'O
         4 001073   000000 000007 xsym               ADSC9   AS_FE_MODE,Q             cn=0,n=7
         4 001074   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      363    14045                          %NUMBER( NUM2 = "KL_DFLT.KL_DFLT_FEBLK.MINTS(MODE)" ) ;
             14061    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, KL_DFLT.KL_DFLT_FEBLK.MINTS(MODE) );

  14061  4 001075   200014 236100                    LDQ     MODE,,AUTO
         4 001076   000020 736000                    QLS     16
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:102  
         4 001077   000020 036000 5                  ADLQ    16
         4 001100   000021 235000 5                  LDA     17
         4 001101   200056 757100                    STAQ    OP_CODE+6,,AUTO
         4 001102   000022 237000 5                  LDAQ    18
         4 001103   200054 757100                    STAQ    OP_CODE+4,,AUTO
         4 001104   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 001105   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001106   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001107   000000 011000                    NOP     0

      364    14075        /*E*  ERROR:  ASC-E$MINTS_TOO_BIG-C
      365    14076              MESSAGE: %U1 FEMINTS value is too large. Set to maximum of %U2.
      366    14077        */
      367    14078                          %SCREAM( ERR#=E$MINTS_TOO_BIG, LEVEL=ERROR, MID='C' ) ;

  14090  4 001110   000024 630400 5                  EPPR0   20
         4 001111   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001112   000000 701000 xent               TSX1    ASH$ERROR
         4 001113   000000 011000                    NOP     0

      368    14093    6                     KL_DREC.KL_DREC_FEBLK.MINTS(MODE) = KL_DFLT.KL_DFLT_FEBLK.MINTS(
             14093                              MODE) ;

  14093  4 001114   200014 235100                    LDA     MODE,,AUTO
         4 001115   000005 100405                    MLR     fill='000'O
         4 001116   000030 000001 xsym               ADSC9   KL_DFLT+24,A             cn=0,n=1
         4 001117   000030 000001 xsym               ADSC9   KL_DREC+24,A             cn=0,n=1

      369    14094    6                     END ;

      370    14095    5               AS_MOD_USER.FEMINTS_A(MODE) = AS_TRUE ;

  14095  4 001120   200014 235100                    LDA     MODE,,AUTO
         4 001121   003005 060400                    CSL     bolr='003'O
         4 001122   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 001123   000030 270001 xsym               BDSC    AS_MOD_USER+24,A         by=1,bit=7,n=1

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:103  
      371    14096    5               END ;

  14096  4 001124   200011 054100                    AOS     J,,AUTO
         4 001125   200023 236100                    LDQ     SUBS,,AUTO
         4 001126   001027 604000 4                  TMI     s:14035
         4 001127   200011 116100                    CMPQ    J,,AUTO
         4 001130   001027 605000 4                  TPL     s:14035
         4 001131   004447 710000 4                  TRA     LOOP_END

      372    14097        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:104  
      373    14098    4            SELECT( 99 /* FEMFPRG_OPT_VAL */ ) ;

      374    14099    4            ERR_CODE = '0'B ;

  14099  4 001132   000000 450000 xsym               STZ     ERR_CODE

      375    14100    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  14100  4 001133   200022 470500                    LDP0    SUBND$,,AUTO
         4 001134   000003 471500                    LDP1    3,,PR0
         4 001135   100003 236100                    LDQ     3,,PR1
         4 001136   200020 756100                    STQ     STR$,,AUTO

      376    14101    4            CALL CHARBIN( MODE, VARY$STR.TEXT ) ;

  14101  4 001137   200020 473500                    LDP3    STR$,,AUTO
         4 001140   300000 236100                    LDQ     0,,PR3
         4 001141   000033 772000                    QRL     27
         4 001142   000000 620006                    EAX0    0,QL
         4 001143   000100 305540                    DTB
         4 001144   300000 230010                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         4 001145   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 001146   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 001147   200014 755100                    STA     MODE,,AUTO

      377    14102    4            KL_DREC.KL_DREC_FEBLK.MFPRG = MODE ;

  14102  4 001150   200014 236100                    LDQ     MODE,,AUTO
         4 001151   000033 736000                    QLS     27
         4 001152   000031 552040 xsym               STBQ    KL_DREC+25,'40'O

      378    14103    4            IF AS_CR_MOD_PROJ > 0

  14103  4 001153   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 001154   001202 604400 4                  TMOZ    s:14158

      379    14104    4            THEN
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:105  
      380    14105    4               IF MODE > KL_DFLT.KL_DFLT_FEBLK.MFPRG

  14105  4 001155   000031 236000 xsym               LDQ     KL_DFLT+25
         4 001156   000033 772000                    QRL     27
         4 001157   200014 116100                    CMPQ    MODE,,AUTO
         4 001160   001202 603000 4                  TRC     s:14158

      381    14106    5               THEN DO ;

      382    14107    5                  J = KL_DFLT.KL_DFLT_FEBLK.MFPRG ;

  14107  4 001161   200011 756100                    STQ     J,,AUTO

      383    14108                       %NUMBER( NUM1 = J) ;
             14116    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, J );

  14116  4 001162   200011 631500                    EPPR1   J,,AUTO
         4 001163   200057 451500                    STP1    OP_CODE+7,,AUTO
         4 001164   000013 236000 5                  LDQ     11
         4 001165   200056 756100                    STQ     OP_CODE+6,,AUTO
         4 001166   000026 237000 5                  LDAQ    22
         4 001167   200054 757100                    STAQ    OP_CODE+4,,AUTO
         4 001170   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 001171   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001172   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001173   000000 011000                    NOP     0

      384    14138        /*E*  ERROR:  ASC-E$MFPRG_TOO_BIG-C
      385    14139              MESSAGE: MFPRG value is too large. Set to maximum of %U1.
      386    14140        */
      387    14141                       %SCREAM( ERR#=E$MFPRG_TOO_BIG, LEVEL=ERROR, MID='C') ;

  14153  4 001174   000030 630400 5                  EPPR0   24
         4 001175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001176   000000 701000 xent               TSX1    ASH$ERROR
         4 001177   000000 011000                    NOP     0

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:106  
      388    14156    5                  KL_DREC.KL_DREC_FEBLK.MFPRG = KL_DFLT.KL_DFLT_FEBLK.MFPRG ;

  14156  4 001200   000031 236000 xsym               LDQ     KL_DFLT+25
         4 001201   000031 552040 xsym               STBQ    KL_DREC+25,'40'O

      389    14157    5                  END ;

      390    14158    4            AS_MOD_USER.FEMFPRG = AS_TRUE ;

  14158  4 001202   000000 236000 xsym               LDQ     AS_TRUE
         4 001203   000024 772000                    QRL     20
         4 001204   000030 676000 xsym               ERQ     AS_MOD_USER+24
         4 001205   100000 376007                    ANQ     32768,DL
         4 001206   000030 656000 xsym               ERSQ    AS_MOD_USER+24
         4 001207   004447 710000 4                  TRA     LOOP_END

      391    14159        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:107  
      392    14160    4            SELECT( 103 /* FETIME_OPT_VAL */ ) ;

      393    14161    4            ERR_CODE = '0'B ;

  14161  4 001210   000000 450000 xsym               STZ     ERR_CODE

      394    14162    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;

  14162  4 001211   200022 470500                    LDP0    SUBND$,,AUTO
         4 001212   000001 236100                    LDQ     1,,PR0
         4 001213   000022 772000                    QRL     18
         4 001214   000001 136007                    SBLQ    1,DL
         4 001215   200023 756100                    STQ     SUBS,,AUTO

      395    14163    5            DO J = 0 TO SUBS ;

  14163  4 001216   200011 450100                    STZ     J,,AUTO
         4 001217   001316 710000 4                  TRA     s:14226+1

      396    14164    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14164  4 001220   200022 470500                    LDP0    SUBND$,,AUTO
         4 001221   200011 720100                    LXL0    J,,AUTO
         4 001222   000003 236110                    LDQ     3,X0,PR0
         4 001223   200016 756100                    STQ     P$,,AUTO

      397    14165    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14165  4 001224   200016 471500                    LDP1    P$,,AUTO
         4 001225   100003 473500                    LDP3    3,,PR1
         4 001226   300000 236100                    LDQ     0,,PR3
         4 001227   777777 376007                    ANQ     -1,DL
         4 001230   200014 756100                    STQ     MODE,,AUTO

      398    14166    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;

  14166  4 001231   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:108  
         4 001232   300003 236100                    LDQ     3,,PR3
         4 001233   200020 756100                    STQ     STR$,,AUTO

      399    14167    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;

  14167  4 001234   200020 474500                    LDP4    STR$,,AUTO
         4 001235   400000 236100                    LDQ     0,,PR4
         4 001236   000033 772000                    QRL     27
         4 001237   000000 621006                    EAX1    0,QL
         4 001240   000100 305540                    DTB
         4 001241   400000 230011                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 001242   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 001243   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 001244   200012 755100                    STA     K,,AUTO

      400    14168    5               K = K * 6000 ;

  14168  4 001245   200012 236100                    LDQ     K,,AUTO
         4 001246   013560 402007                    MPY     6000,DL
         4 001247   200012 756100                    STQ     K,,AUTO

      401    14169    5               KL_DREC.KL_DREC_FEBLK.MTIME(MODE) = K ;

  14169  4 001250   200014 721100                    LXL1    MODE,,AUTO
         4 001251   000042 756011 xsym               STQ     KL_DREC+34,X1

      402    14170    5               IF AS_CR_MOD_PROJ > 0

  14170  4 001252   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 001253   001311 604400 4                  TMOZ    s:14225

      403    14171    5               THEN
      404    14172    5                  IF K > KL_DFLT.KL_DFLT_FEBLK.MTIME(MODE)

  14172  4 001254   000000 116003                    CMPQ    0,DU
         4 001255   001260 604000 4                  TMI     s:14174
         4 001256   000042 116011 xsym               CMPQ    KL_DFLT+34,X1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:109  
         4 001257   001311 604400 4                  TMOZ    s:14225

      405    14173    6                  THEN DO ;

      406    14174    6                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;

  14174  4 001260   200014 236100                    LDQ     MODE,,AUTO
         4 001261   000007 402007                    MPY     7,DL
         4 001262   000000 100406                    MLR     fill='000'O
         4 001263   000000 000007 xsym               ADSC9   AS_FE_MODE,Q             cn=0,n=7
         4 001264   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      407    14175                          %NUMBER( NUM2 = "KL_DFLT.KL_DFLT_FEBLK.MTIME(MODE)/6000" ) ;
             14191    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, KL_DFLT.KL_DFLT_FEBLK.MTIME(MODE)/
             14191                  6000 );

  14191  4 001265   000042 236011 xsym               LDQ     KL_DFLT+34,X1
         4 001266   013560 506007                    DIV     6000,DL
         4 001267   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 001270   200054 633500                    EPPR3   OP_CODE+4,,AUTO
         4 001271   200061 453500                    STP3    OP_CODE+9,,AUTO
         4 001272   000021 236000 5                  LDQ     17
         4 001273   200060 756100                    STQ     OP_CODE+8,,AUTO
         4 001274   000022 237000 5                  LDAQ    18
         4 001275   200056 757100                    STAQ    OP_CODE+6,,AUTO
         4 001276   200056 630500                    EPPR0   OP_CODE+6,,AUTO
         4 001277   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001300   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001301   000000 011000                    NOP     0

      408    14205        /*E*  ERROR:  ASC-E$FEMTIME_LIMIT-C
      409    14206              MESSAGE: %U1 FEMTIME value is too large. Set to maximum of %U2.
      410    14207        */
      411    14208                          %SCREAM( ERR#=E$FEMTIME_LIMIT, LEVEL=ERROR, MID='C' ) ;

  14220  4 001302   000031 630400 5                  EPPR0   25
         4 001303   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:110  
         4 001304   000000 701000 xent               TSX1    ASH$ERROR
         4 001305   000000 011000                    NOP     0

      412    14223    6                     KL_DREC.KL_DREC_FEBLK.MTIME(MODE) = KL_DFLT.KL_DFLT_FEBLK.MTIME(
             14223                              MODE) ;

  14223  4 001306   200014 720100                    LXL0    MODE,,AUTO
         4 001307   000042 235010 xsym               LDA     KL_DFLT+34,X0
         4 001310   000042 755010 xsym               STA     KL_DREC+34,X0

      413    14224    6                     END ;

      414    14225    5               AS_MOD_USER.FEMTIME_A(MODE) = AS_TRUE ;

  14225  4 001311   200014 235100                    LDA     MODE,,AUTO
         4 001312   003005 060400                    CSL     bolr='003'O
         4 001313   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 001314   000050 430001 xsym               BDSC    AS_MOD_USER+40,A         by=2,bit=3,n=1

      415    14226    5               END ;

  14226  4 001315   200011 054100                    AOS     J,,AUTO
         4 001316   200023 236100                    LDQ     SUBS,,AUTO
         4 001317   001220 604000 4                  TMI     s:14164
         4 001320   200011 116100                    CMPQ    J,,AUTO
         4 001321   001220 605000 4                  TPL     s:14164
         4 001322   004447 710000 4                  TRA     LOOP_END

      416    14227        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:111  
      417    14228    4            SELECT( 104 /* FEMEMORY_OPT_VAL */ ) ;

      418    14229    4            ERR_CODE = '0'B ;

  14229  4 001323   000000 450000 xsym               STZ     ERR_CODE

      419    14230    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;

  14230  4 001324   200022 470500                    LDP0    SUBND$,,AUTO
         4 001325   000001 236100                    LDQ     1,,PR0
         4 001326   000022 772000                    QRL     18
         4 001327   000001 136007                    SBLQ    1,DL
         4 001330   200023 756100                    STQ     SUBS,,AUTO

      420    14231    5            DO J = 0 TO SUBS ;

  14231  4 001331   200011 450100                    STZ     J,,AUTO
         4 001332   001433 710000 4                  TRA     s:14293+1

      421    14232    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14232  4 001333   200022 470500                    LDP0    SUBND$,,AUTO
         4 001334   200011 720100                    LXL0    J,,AUTO
         4 001335   000003 236110                    LDQ     3,X0,PR0
         4 001336   200016 756100                    STQ     P$,,AUTO

      422    14233    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14233  4 001337   200016 471500                    LDP1    P$,,AUTO
         4 001340   100003 473500                    LDP3    3,,PR1
         4 001341   300000 236100                    LDQ     0,,PR3
         4 001342   777777 376007                    ANQ     -1,DL
         4 001343   200014 756100                    STQ     MODE,,AUTO

      423    14234    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;

  14234  4 001344   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:112  
         4 001345   300003 236100                    LDQ     3,,PR3
         4 001346   200020 756100                    STQ     STR$,,AUTO

      424    14235    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;

  14235  4 001347   200020 474500                    LDP4    STR$,,AUTO
         4 001350   400000 236100                    LDQ     0,,PR4
         4 001351   000033 772000                    QRL     27
         4 001352   000000 621006                    EAX1    0,QL
         4 001353   000100 305540                    DTB
         4 001354   400000 230011                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 001355   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 001356   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 001357   200012 755100                    STA     K,,AUTO

      425    14236    5               KL_DREC.KL_DREC_FEBLK.MMEM(MODE) = K ;

  14236  4 001360   200014 236100                    LDQ     MODE,,AUTO
         4 001361   000001 736000                    QLS     1
         4 001362   000006 101500                    MRL     fill='000'O
         4 001363   200012 000004                    ADSC9   K,,AUTO                  cn=0,n=4
         4 001364   000046 000002 xsym               ADSC9   KL_DREC+38,Q             cn=0,n=2

      426    14237    5               IF AS_CR_MOD_PROJ > 0

  14237  4 001365   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 001366   001426 604400 4                  TMOZ    s:14292

      427    14238    5               THEN
      428    14239    5                  IF K > KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE)

  14239  4 001367   000100 101406                    MRL     fill='000'O
         4 001370   000046 000002 xsym               ADSC9   KL_DFLT+38,Q             cn=0,n=2
         4 001371   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 001372   200054 236100                    LDQ     OP_CODE+4,,AUTO
         4 001373   200012 116100                    CMPQ    K,,AUTO
         4 001374   001426 603000 4                  TRC     s:14292
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:113  

      429    14240    6                  THEN DO ;

      430    14241    6                     AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;

  14241  4 001375   200014 236100                    LDQ     MODE,,AUTO
         4 001376   000007 402007                    MPY     7,DL
         4 001377   000000 100406                    MLR     fill='000'O
         4 001400   000000 000007 xsym               ADSC9   AS_FE_MODE,Q             cn=0,n=7
         4 001401   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      431    14242                          %NUMBER( NUM2 = "KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE)" ) ;
             14258    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE) );

  14258  4 001402   200014 236100                    LDQ     MODE,,AUTO
         4 001403   000021 736000                    QLS     17
         4 001404   000032 036000 5                  ADLQ    26
         4 001405   000021 235000 5                  LDA     17
         4 001406   200056 757100                    STAQ    OP_CODE+6,,AUTO
         4 001407   000022 237000 5                  LDAQ    18
         4 001410   200054 757100                    STAQ    OP_CODE+4,,AUTO
         4 001411   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 001412   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001413   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001414   000000 011000                    NOP     0

      432    14272        /*E*  ERROR:  ASC-E$FEMMEM_LIMIT-C
      433    14273              MESSAGE: %U1 FEMMEMORY value is too large. Set to maximum of %U2.
      434    14274        */
      435    14275                          %SCREAM( ERR#=E$FEMMEM_LIMIT, LEVEL=ERROR, MID='C' ) ;

  14287  4 001415   000033 630400 5                  EPPR0   27
         4 001416   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001417   000000 701000 xent               TSX1    ASH$ERROR
         4 001420   000000 011000                    NOP     0

      436    14290    6                    KL_DREC.KL_DREC_FEBLK.MMEM(MODE) = KL_DFLT.KL_DFLT_FEBLK.MMEM(MODE
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:114  
             14290                              ) ;

  14290  4 001421   200014 235100                    LDA     MODE,,AUTO
         4 001422   000001 735000                    ALS     1
         4 001423   000005 100405                    MLR     fill='000'O
         4 001424   000046 000002 xsym               ADSC9   KL_DFLT+38,A             cn=0,n=2
         4 001425   000046 000002 xsym               ADSC9   KL_DREC+38,A             cn=0,n=2

      437    14291    6                     END ;

      438    14292    5               AS_MOD_USER.FEMMEM_A(MODE) = AS_TRUE ;

  14292  4 001426   200014 235100                    LDA     MODE,,AUTO
         4 001427   003005 060400                    CSL     bolr='003'O
         4 001430   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 001431   000050 470001 xsym               BDSC    AS_MOD_USER+40,A         by=2,bit=7,n=1

      439    14293    5               END ;

  14293  4 001432   200011 054100                    AOS     J,,AUTO
         4 001433   200023 236100                    LDQ     SUBS,,AUTO
         4 001434   001333 604000 4                  TMI     s:14232
         4 001435   200011 116100                    CMPQ    J,,AUTO
         4 001436   001333 605000 4                  TPL     s:14232
         4 001437   004447 710000 4                  TRA     LOOP_END

      440    14294        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:115  
      441    14295    4            SELECT(48   /*  SETUP_OPT_VAL */) ;

      442    14296    4            ERR_CODE.CODE = 0 ;

  14296  4 001440   000004 236000 5                  LDQ     4
         4 001441   000000 356000 xsym               ANSQ    ERR_CODE

      443    14297    4            MODE = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  14297  4 001442   200022 470500                    LDP0    SUBND$,,AUTO
         4 001443   000003 471500                    LDP1    3,,PR0
         4 001444   100000 236100                    LDQ     0,,PR1
         4 001445   777777 376007                    ANQ     -1,DL
         4 001446   200014 756100                    STQ     MODE,,AUTO

      444    14298    4            ALTER = AS_USERS.SETUP_PERM (MODE);

  14298  4 001447   003100 060406                    CSL     bolr='003'O
         4 001450   000351 400001 xsym               BDSC    AS_USERS+233,Q           by=2,bit=0,n=1
         4 001451   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1

      445    14299    4            STR$ = ADDR (NIL);

  14299  4 001452   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001453   200020 756100                    STQ     STR$,,AUTO

      446    14300    5            DO J = 1 TO SUBND$->P$NODE.SUBNODES-1;

  14300  4 001454   000001 235007                    LDA     1,DL
         4 001455   200011 755100                    STA     J,,AUTO
         4 001456   001517 710000 4                  TRA     s:14317+1

      447    14301    5               TEMP$ = SUBND$->P$NODE.SUBLK$(J);

  14301  4 001457   200022 470500                    LDP0    SUBND$,,AUTO
         4 001460   200011 720100                    LXL0    J,,AUTO
         4 001461   000003 236110                    LDQ     3,X0,PR0
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:116  
         4 001462   200025 756100                    STQ     TEMP$,,AUTO

      448    14302    6               DO SELECT (TEMP$->OUT$SYM.CODE);

  14302  4 001463   200025 471500                    LDP1    TEMP$,,AUTO
         4 001464   100000 721100                    LXL1    0,,PR1
         4 001465   001471 600000 4                  TZE     s:14304
         4 001466   000201 101003                    CMPX1   129,DU
         4 001467   001515 601000 4                  TNZ     s:14315
         4 001470   001474 710000 4                  TRA     s:14306

      449    14303    6                  SELECT (0);/* No code for a node containing text*/

      450    14304    6                  STR$ = TEMP$->OUT$SYM.TEXTC$;

  14304  4 001471   100003 236100                    LDQ     3,,PR1
         4 001472   200020 756100                    STQ     STR$,,AUTO
         4 001473   001516 710000 4                  TRA     s:14317

      451    14305    6                  SELECT (129 /* ALTER_TYPE_VAL */);

      452    14306    6                  IF ((SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'A') OR

  14306  4 001474   100004 236100                    LDQ     4,,PR1
         4 001475   000033 772000                    QRL     27
         4 001476   100004 236100                    LDQ     4,,PR1
         4 001477   000777 376003                    ANQ     511,DU
         4 001500   000101 116003                    CMPQ    65,DU
         4 001501   001510 600000 4                  TZE     s:14309
         4 001502   100004 236100                    LDQ     4,,PR1
         4 001503   000033 772000                    QRL     27
         4 001504   100004 236100                    LDQ     4,,PR1
         4 001505   000777 376003                    ANQ     511,DU
         4 001506   000141 116003                    CMPQ    97,DU
         4 001507   001512 601000 4                  TNZ     s:14312

      453    14307    6                       (SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'a'))
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:117  
      454    14308    7                  THEN DO;

      455    14309    7                     ALTER = '0'B ;

  14309  4 001510   200004 450100                    STZ     ALTER,,AUTO

      456    14310    7                     END;

  14310  4 001511   001516 710000 4                  TRA     s:14317

      457    14311    7                  ELSE DO;

      458    14312    7                     ALTER = '1'B ;

  14312  4 001512   400000 236003                    LDQ     -131072,DU
         4 001513   200004 756100                    STQ     ALTER,,AUTO

      459    14313    7                     END;

  14313  4 001514   001516 710000 4                  TRA     s:14317

      460    14314    6                  SELECT (ELSE);

      461    14315    6               RETURN;

  14315  4 001515   000000 702200 xent               TSX2  ! X66_ARET

      462    14316    6                  END; /* Of this case */

      463    14317    5               END; /* The do j = 0 to ... */

  14317  4 001516   200011 054100                    AOS     J,,AUTO
         4 001517   000001 236100                    LDQ     1,,PR0
         4 001520   000022 772000                    QRL     18
         4 001521   200011 116100                    CMPQ    J,,AUTO
         4 001522   001457 605400 4                  TPNZ    s:14301

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:118  
      464    14318    4            IF (STR$ = ADDR (NIL))

  14318  4 001523   200020 236100                    LDQ     STR$,,AUTO
         4 001524   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001525   001536 601000 4                  TNZ     s:14324

      465    14319    5            THEN DO;

      466    14320    5               AS_USERS.SETUP_PERM (MODE) = ALTER;

  14320  4 001526   200014 235100                    LDA     MODE,,AUTO
         4 001527   003005 060500                    CSL     bolr='003'O
         4 001530   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1
         4 001531   000351 400001 xsym               BDSC    AS_USERS+233,A           by=2,bit=0,n=1

      467    14321    5               AS_MOD_USER.PERM_A(MODE) = AS_TRUE ;

  14321  4 001532   003005 060400                    CSL     bolr='003'O
         4 001533   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 001534   000000 200001 xsym               BDSC    AS_MOD_USER,A            by=1,bit=0,n=1

      468    14322    5               END;

  14322  4 001535   004447 710000 4                  TRA     LOOP_END

      469    14323    5            ELSE DO;

      470    14324    5               IF (STR$->VARY$STR.CNT >= 115)

  14324  4 001536   200020 471500                    LDP1    STR$,,AUTO
         4 001537   100000 236100                    LDQ     0,,PR1
         4 001540   777000 376003                    ANQ     -512,DU
         4 001541   163000 116003                    CMPQ    58880,DU
         4 001542   001550 602000 4                  TNC     s:14348

      471    14325    6               THEN DO;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:119  
      472    14326        /*E* ERROR:  ASC-E$SETUP_TOO_LONG-C
      473    14327             MESSAGE0: The text specified is longer then allowed for SETUP.
      474    14328             MESSAGE1: The maximum length of a SETUP string is 114 characters
      475    14329                       or less.
      476    14330        */
      477    14331                       %SCREAM(ERR#=E$SETUP_TOO_LONG,LEVEL=ERROR,MID='C');

  14343  4 001543   000034 630400 5                  EPPR0   28
         4 001544   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001545   000000 701000 xent               TSX1    ASH$ERROR
         4 001546   000000 011000                    NOP     0

      478    14346    6                  END;

  14346  4 001547   004447 710000 4                  TRA     LOOP_END

      479    14347    6               ELSE DO;

      480    14348    6                  AS_USERS.SETUP_PERM (MODE) = ALTER;

  14348  4 001550   200014 235100                    LDA     MODE,,AUTO
         4 001551   003005 060500                    CSL     bolr='003'O
         4 001552   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1
         4 001553   000351 400001 xsym               BDSC    AS_USERS+233,A           by=2,bit=0,n=1

      481    14349    6                  AS_MOD_USER.PERM_A(MODE) = AS_TRUE ;

  14349  4 001554   003005 060400                    CSL     bolr='003'O
         4 001555   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 001556   000000 200001 xsym               BDSC    AS_MOD_USER,A            by=1,bit=0,n=1

      482    14350    6                  AS_MOD_USER.SETUP_A(MODE) = AS_TRUE ;

  14350  4 001557   003005 060400                    CSL     bolr='003'O
         4 001560   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 001561   000000 050001 xsym               BDSC    AS_MOD_USER,A            by=0,bit=5,n=1

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:120  
      483    14351    6                  CALL ASC$SETUP( ADDR(AS_USERS), MODE, STR$->VARY$STR)

  14351  4 001562   000035 236000 5                  LDQ     29
         4 001563   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 001564   200020 236100                    LDQ     STR$,,AUTO
         4 001565   200057 756100                    STQ     OP_CODE+7,,AUTO
         4 001566   200014 633500                    EPPR3   MODE,,AUTO
         4 001567   200056 453500                    STP3    OP_CODE+6,,AUTO
         4 001570   200054 634500                    EPPR4   OP_CODE+4,,AUTO
         4 001571   200055 454500                    STP4    OP_CODE+5,,AUTO
         4 001572   200055 630500                    EPPR0   OP_CODE+5,,AUTO
         4 001573   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001574   000000 701000 xent               TSX1    ASC$SETUP
         4 001575   001577 702000 4                  TSX2    s:14365
         4 001576   001607 710000 4                  TRA     s:14371

      484    14352    7                  WHENALTRETURN DO;

      485    14353                          %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');

  14365  4 001577   000036 630400 5                  EPPR0   30
         4 001600   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001601   000000 701000 xent               TSX1    ASH$ERROR
         4 001602   000000 011000                    NOP     0

      486    14368    7                     AS_MOD_USER.SETUP_A(MODE) = AS_FALSE ;

  14368  4 001603   200014 235100                    LDA     MODE,,AUTO
         4 001604   003005 060400                    CSL     bolr='003'O
         4 001605   000000 000001 xsym               BDSC    AS_FALSE                 by=0,bit=0,n=1
         4 001606   000000 050001 xsym               BDSC    AS_MOD_USER,A            by=0,bit=5,n=1

      487    14369    7                     END;

      488    14370    6                  END;

      489    14371    5               END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:121  

  14371  4 001607   004447 710000 4                  TRA     LOOP_END

      490    14372        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:122  
      491    14373    4            SELECT ( 135 /* FORCE_SETUP */ );

      492    14374    4            ERR_CODE.CODE = 0;

  14374  4 001610   000004 236000 5                  LDQ     4
         4 001611   000000 356000 xsym               ANSQ    ERR_CODE

      493    14375    4            PTR$ = SUBND$ -> P$NODE.SUBLK$(0);

  14375  4 001612   100003 236100                    LDQ     3,,PR1
         4 001613   200017 756100                    STQ     PTR$,,AUTO

      494    14376    4            SUBS = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBNODES - 1 ;

  14376  4 001614   100003 473500                    LDP3    3,,PR1
         4 001615   300001 236100                    LDQ     1,,PR3
         4 001616   000022 772000                    QRL     18
         4 001617   000001 136007                    SBLQ    1,DL
         4 001620   200023 756100                    STQ     SUBS,,AUTO

      495    14377    5            DO J = 0 TO SUBS ;

  14377  4 001621   200011 450100                    STZ     J,,AUTO
         4 001622   001666 710000 4                  TRA     s:14390+1

      496    14378    5               P$ = PTR$ -> P$NODE.SUBLK$(J) ;

  14378  4 001623   200017 470500                    LDP0    PTR$,,AUTO
         4 001624   200011 720100                    LXL0    J,,AUTO
         4 001625   000003 236110                    LDQ     3,X0,PR0
         4 001626   200016 756100                    STQ     P$,,AUTO

      497    14379    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14379  4 001627   200016 471500                    LDP1    P$,,AUTO
         4 001630   100003 473500                    LDP3    3,,PR1
         4 001631   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:123  
         4 001632   777777 376007                    ANQ     -1,DL
         4 001633   200014 756100                    STQ     MODE,,AUTO

      498    14380    5               IF P$ -> P$NODE.SUBNODES = 1

  14380  4 001634   100001 221100                    LDX1    1,,PR1
         4 001635   000001 101003                    CMPX1   1,DU
         4 001636   001642 601000 4                  TNZ     s:14384

      499    14381    5               THEN
      500    14382    5                  OP_CODE = 1   /*  YES_VAL  */ ;

  14382  4 001637   000001 235007                    LDA     1,DL
         4 001640   200015 755100                    STA     OP_CODE,,AUTO
         4 001641   001646 710000 4                  TRA     s:14385

      501    14383    5               ELSE
      502    14384    5                  OP_CODE = P$ -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;

  14384  4 001642   100004 473500                    LDP3    4,,PR1
         4 001643   300000 236100                    LDQ     0,,PR3
         4 001644   777777 376007                    ANQ     -1,DL
         4 001645   200015 756100                    STQ     OP_CODE,,AUTO

      503    14385    5               IF OP_CODE = 1   /*  YES_VAL  */ THEN

  14385  4 001646   200015 235100                    LDA     OP_CODE,,AUTO
         4 001647   000001 115007                    CMPA    1,DL
         4 001650   001656 601000 4                  TNZ     s:14388

      504    14386    5                  AS_USERS.SETUP_FORCE (MODE) = %YES#;

  14386  4 001651   200014 236100                    LDQ     MODE,,AUTO
         4 001652   003006 060400                    CSL     bolr='003'O
         4 001653   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 001654   000351 650001 xsym               BDSC    AS_USERS+233,Q           by=3,bit=5,n=1
         4 001655   001662 710000 4                  TRA     s:14389
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:124  

      505    14387    5               ELSE
      506    14388    5                  AS_USERS.SETUP_FORCE (MODE) = %NO#;

  14388  4 001656   200014 236100                    LDQ     MODE,,AUTO
         4 001657   003006 060400                    CSL     bolr='003'O
         4 001660   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 001661   000351 650001 xsym               BDSC    AS_USERS+233,Q           by=3,bit=5,n=1

      507    14389    5               AS_MOD_USER.FORCE_A (MODE) = %YES#;

  14389  4 001662   003006 060400                    CSL     bolr='003'O
         4 001663   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 001664   000000 240001 xsym               BDSC    AS_MOD_USER,Q            by=1,bit=4,n=1

      508    14390    5               END; /*  Do j  */

  14390  4 001665   200011 054100                    AOS     J,,AUTO
         4 001666   200023 236100                    LDQ     SUBS,,AUTO
         4 001667   001623 604000 4                  TMI     s:14378
         4 001670   200011 116100                    CMPQ    J,,AUTO
         4 001671   001623 605000 4                  TPL     s:14378
         4 001672   004447 710000 4                  TRA     LOOP_END

      509    14391        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:125  
      510    14392    4            SELECT(127 /* BANNERTEXT_OPT_VAL */) ;

      511    14393    4            BTEXT$ = ADDR (NIL);

  14393  4 001673   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001674   200007 756100                    STQ     BTEXT$,,AUTO

      512    14394    4            ERR_CODE.CODE = 0 ;

  14394  4 001675   000004 236000 5                  LDQ     4
         4 001676   000000 356000 xsym               ANSQ    ERR_CODE

      513    14395    5            DO J = 0 TO SUBND$->P$NODE.SUBNODES-1;

  14395  4 001677   200011 450100                    STZ     J,,AUTO
         4 001700   001762 710000 4                  TRA     s:14415+1

      514    14396    5               TEMP$ = SUBND$->P$NODE.SUBLK$(J);

  14396  4 001701   200022 470500                    LDP0    SUBND$,,AUTO
         4 001702   200011 720100                    LXL0    J,,AUTO
         4 001703   000003 236110                    LDQ     3,X0,PR0
         4 001704   200025 756100                    STQ     TEMP$,,AUTO

      515    14397    6               DO SELECT (TEMP$->OUT$SYM.CODE);

  14397  4 001705   200025 471500                    LDP1    TEMP$,,AUTO
         4 001706   100000 236100                    LDQ     0,,PR1
         4 001707   777777 376007                    ANQ     -1,DL
         4 001710   000200 116007                    CMPQ    128,DL
         4 001711   001717 602000 4                  TNC     s:14397+10
         4 001712   001725 600000 4                  TZE     s:14402
         4 001713   100000 721100                    LXL1    0,,PR1
         4 001714   000201 101003                    CMPX1   129,DU
         4 001715   001761 601000 4                  TNZ     s:14415
         4 001716   001740 710000 4                  TRA     s:14405
         4 001717   100000 721100                    LXL1    0,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:126  
         4 001720   001722 600000 4                  TZE     s:14399
         4 001721   001761 710000 4                  TRA     s:14415

      516    14398    6                  SELECT (0);/* No code for a node containing text*/

      517    14399    6                  BTEXT$ = TEMP$->OUT$SYM.TEXTC$;

  14399  4 001722   100003 236100                    LDQ     3,,PR1
         4 001723   200007 756100                    STQ     BTEXT$,,AUTO
         4 001724   001761 710000 4                  TRA     s:14415

      518    14400    6                  SELECT (128 /* FIELD_NUM_VAL */);

      519    14401                                  /* Mode is the banner field to be changed */
      520    14402    6                  MODE = ASCBIN( SUBSTR( TEMP$->OUT$SYM.TEXT,0,1)) - ASCBIN ('0');

  14402  4 001725   100004 236100                    LDQ     4,,PR1
         4 001726   000033 772000                    QRL     27
         4 001727   100004 236100                    LDQ     4,,PR1
         4 001730   000022 772000                    QRL     18
         4 001731   000777 376007                    ANQ     511,DL
         4 001732   000060 136007                    SBLQ    48,DL
         4 001733   200014 756100                    STQ     MODE,,AUTO

      521    14403    6                  ALTER = AS_USERS.BANNER_PERM (MODE);

  14403  4 001734   003100 060406                    CSL     bolr='003'O
         4 001735   000351 440001 xsym               BDSC    AS_USERS+233,Q           by=2,bit=4,n=1
         4 001736   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1
         4 001737   001761 710000 4                  TRA     s:14415

      522    14404    6                  SELECT (129 /* ALTER_TYPE_VAL */);

      523    14405    6                  IF ((SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'A') OR

  14405  4 001740   100004 236100                    LDQ     4,,PR1
         4 001741   000033 772000                    QRL     27
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:127  
         4 001742   100004 236100                    LDQ     4,,PR1
         4 001743   000777 376003                    ANQ     511,DU
         4 001744   000101 116003                    CMPQ    65,DU
         4 001745   001754 600000 4                  TZE     s:14408
         4 001746   100004 236100                    LDQ     4,,PR1
         4 001747   000033 772000                    QRL     27
         4 001750   100004 236100                    LDQ     4,,PR1
         4 001751   000777 376003                    ANQ     511,DU
         4 001752   000141 116003                    CMPQ    97,DU
         4 001753   001756 601000 4                  TNZ     s:14411

      524    14406    6                       (SUBSTR (TEMP$->OUT$SYM.TEXT,0,1) = 'a'))
      525    14407    7                  THEN DO;

      526    14408    7                     ALTER = '0'B ;

  14408  4 001754   200004 450100                    STZ     ALTER,,AUTO

      527    14409    7                     END;

  14409  4 001755   001761 710000 4                  TRA     s:14415

      528    14410    7                  ELSE DO;

      529    14411    7                     ALTER = '1'B ;

  14411  4 001756   400000 236003                    LDQ     -131072,DU
         4 001757   200004 756100                    STQ     ALTER,,AUTO

      530    14412    7                     END;

  14412  4 001760   001761 710000 4                  TRA     s:14415

      531    14413    6                  SELECT (ELSE);

      532    14414    6                  END; /* Of this case */

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:128  
      533    14415    5               END; /* The do j = 0 to ... */

  14415  4 001761   200011 054100                    AOS     J,,AUTO
         4 001762   200022 470500                    LDP0    SUBND$,,AUTO
         4 001763   000001 236100                    LDQ     1,,PR0
         4 001764   000022 772000                    QRL     18
         4 001765   200011 116100                    CMPQ    J,,AUTO
         4 001766   001701 605400 4                  TPNZ    s:14396

      534    14416    4            IF (BTEXT$ = ADDR (NIL))

  14416  4 001767   200007 236100                    LDQ     BTEXT$,,AUTO
         4 001770   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001771   001777 601000 4                  TNZ     s:14421

      535    14417    5            THEN DO;

      536    14418    5               AS_USERS.BANNER_PERM (MODE) = ALTER;

  14418  4 001772   200014 235100                    LDA     MODE,,AUTO
         4 001773   003005 060500                    CSL     bolr='003'O
         4 001774   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1
         4 001775   000351 440001 xsym               BDSC    AS_USERS+233,A           by=2,bit=4,n=1

      537    14419    5               END;

  14419  4 001776   002042 710000 4                  TRA     s:14471

      538    14420    5            ELSE DO;

      539    14421    5               IF (BTEXT$->VARY$STR.CNT <= 80)

  14421  4 001777   200007 471500                    LDP1    BTEXT$,,AUTO
         4 002000   100000 236100                    LDQ     0,,PR1
         4 002001   777000 376003                    ANQ     -512,DU
         4 002002   121000 116003                    CMPQ    41472,DU
         4 002003   002036 603000 4                  TRC     s:14466
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:129  

      540    14422    6               THEN DO;

      541    14423    6                  AS_USERS.BANNER_PERM (MODE) = ALTER;

  14423  4 002004   200014 235100                    LDA     MODE,,AUTO
         4 002005   003005 060500                    CSL     bolr='003'O
         4 002006   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1
         4 002007   000351 440001 xsym               BDSC    AS_USERS+233,A           by=2,bit=4,n=1

      542    14424    6                  CALL ASC$BANNER(ADDR(AS_USERS),MODE,BTEXT$->VARY$STR)

  14424  4 002010   000035 236000 5                  LDQ     29
         4 002011   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 002012   200007 236100                    LDQ     BTEXT$,,AUTO
         4 002013   200057 756100                    STQ     OP_CODE+7,,AUTO
         4 002014   200014 633500                    EPPR3   MODE,,AUTO
         4 002015   200056 453500                    STP3    OP_CODE+6,,AUTO
         4 002016   200054 634500                    EPPR4   OP_CODE+4,,AUTO
         4 002017   200055 454500                    STP4    OP_CODE+5,,AUTO
         4 002020   200055 630500                    EPPR0   OP_CODE+5,,AUTO
         4 002021   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002022   000000 701000 xent               TSX1    ASC$BANNER
         4 002023   002025 702000 4                  TSX2    s:14443
         4 002024   002031 710000 4                  TRA     s:14447

      543    14425    7                  WHENALTRETURN DO;

      544    14426        /*E*   ERROR:  ASC-E$ALL_BANNNER_SPACE_USED-C
      545    14427               MESSAGE: TEXT field will not fit.  Change not successful.
      546    14428          MESSAGE1: All banner fields combined with setup must fit within a 1024 byte area.
      547    14429        */
      548    14430
      549    14431        %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');

  14443  4 002025   000036 630400 5                  EPPR0   30
         4 002026   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:130  
         4 002027   000000 701000 xent               TSX1    ASH$ERROR
         4 002030   000000 011000                    NOP     0

      550    14446    7                     END;

      551    14447    6                  AS_MOD_USER.BANNER_A(MODE) = AS_TRUE ;

  14447  4 002031   200014 235100                    LDA     MODE,,AUTO
         4 002032   003005 060400                    CSL     bolr='003'O
         4 002033   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002034   000000 300001 xsym               BDSC    AS_MOD_USER,A            by=1,bit=8,n=1

      552    14448    6                  END;

  14448  4 002035   002042 710000 4                  TRA     s:14471

      553    14449    6               ELSE DO;

      554    14450        /*E*  ERROR:   ASC-E$BANNER_TOO_LONG-C
      555    14451              MESSAGE: BANNERTEXT field too long.
      556    14452              MESSAGE1: A BANNERTEXT field can be at most 80 characters.
      557    14453        */
      558    14454                       %SCREAM(ERR#=E$BANNER_TOO_LONG,LEVEL=ERROR,MID='C');

  14466  4 002036   000037 630400 5                  EPPR0   31
         4 002037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002040   000000 701000 xent               TSX1    ASH$ERROR
         4 002041   000000 011000                    NOP     0

      559    14469    6                  END;

      560    14470    5               END;

      561    14471    4            AS_MOD_USER.BANNER_PERM_A (MODE) = AS_TRUE;

  14471  4 002042   200014 235100                    LDA     MODE,,AUTO
         4 002043   003005 060400                    CSL     bolr='003'O
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:131  
         4 002044   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002045   000000 600001 xsym               BDSC    AS_MOD_USER,A            by=3,bit=0,n=1
         4 002046   004447 710000 4                  TRA     LOOP_END

      562    14472        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:132  
      563    14473    4            SELECT (130 /* ACCOUNT_OWNER_VAL */);

      564    14474                                   /* The account owner field is actually
      565    14475                                      stored in the bannertext pool as
      566    14476                                      bannertext 0.                    */
      567    14477    4            ERR_CODE.CODE = 0;

  14477  4 002047   000004 236000 5                  LDQ     4
         4 002050   000000 356000 xsym               ANSQ    ERR_CODE

      568    14478    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  14478  4 002051   100003 236100                    LDQ     3,,PR1
         4 002052   200016 756100                    STQ     P$,,AUTO

      569    14479    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */

  14479  4 002053   200016 473500                    LDP3    P$,,AUTO
         4 002054   300000 721100                    LXL1    0,,PR3
         4 002055   000007 101003                    CMPX1   7,DU
         4 002056   002062 601000 4                  TNZ     s:14484

      570    14480    5            THEN DO;

      571    14481    5               BTEXT$ = ADDR  (AS_BLANK);

  14481  4 002057   000040 236000 5                  LDQ     32
         4 002060   200007 756100                    STQ     BTEXT$,,AUTO

      572    14482    5               END;

  14482  4 002061   002065 710000 4                  TRA     s:14486

      573    14483    5            ELSE DO;

      574    14484    5               BTEXT$ = SUBND$ -> P$NODE.SUBLK$(0) -> OUT$SYM.TEXTC$;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:133  
  14484  4 002062   100003 474500                    LDP4    3,,PR1
         4 002063   400003 236100                    LDQ     3,,PR4
         4 002064   200007 756100                    STQ     BTEXT$,,AUTO

      575    14485    5               END;

      576    14486    4            MODE = 0;

  14486  4 002065   200014 450100                    STZ     MODE,,AUTO

      577    14487    4            ALTER = '1'B ;

  14487  4 002066   400000 236003                    LDQ     -131072,DU
         4 002067   200004 756100                    STQ     ALTER,,AUTO

      578    14488    4            IF (BTEXT$->VARY$STR.CNT <= 80)

  14488  4 002070   200007 474500                    LDP4    BTEXT$,,AUTO
         4 002071   400000 236100                    LDQ     0,,PR4
         4 002072   777000 376003                    ANQ     -512,DU
         4 002073   121000 116003                    CMPQ    41472,DU
         4 002074   002123 603000 4                  TRC     s:14532

      579    14489    5            THEN DO;

      580    14490    5               AS_USERS.BANNER_PERM (MODE) = ALTER;

  14490  4 002075   200014 235100                    LDA     MODE,,AUTO
         4 002076   003005 060500                    CSL     bolr='003'O
         4 002077   200004 000001                    BDSC    ALTER,,AUTO              by=0,bit=0,n=1
         4 002100   000351 440001 xsym               BDSC    AS_USERS+233,A           by=2,bit=4,n=1

      581    14491    5               CALL ASC$BANNER(ADDR(AS_USERS),MODE,BTEXT$->VARY$STR)

  14491  4 002101   000035 236000 5                  LDQ     29
         4 002102   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 002103   200007 236100                    LDQ     BTEXT$,,AUTO
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:134  
         4 002104   200057 756100                    STQ     OP_CODE+7,,AUTO
         4 002105   200014 635500                    EPPR5   MODE,,AUTO
         4 002106   200056 455500                    STP5    OP_CODE+6,,AUTO
         4 002107   200054 636500                    EPPR6   OP_CODE+4,,AUTO
         4 002110   200055 456500                    STP6    OP_CODE+5,,AUTO
         4 002111   200055 630500                    EPPR0   OP_CODE+5,,AUTO
         4 002112   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002113   000000 701000 xent               TSX1    ASC$BANNER
         4 002114   002116 702000 4                  TSX2    s:14508
         4 002115   002122 710000 4                  TRA     s:14514

      582    14492    6               WHENALTRETURN DO;

      583    14493        /* ERROR:  ASC-E$ALL_BANNNER_SPACE_USED-C
      584    14494           MESSAGE: Text field will not fit.  Change not successful.
      585    14495          MESSAGE1: All banner fields combined with setup must fit within a 1024 byte area.
      586    14496        */
      587    14497
      588    14498        %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=WARN,MID='C');

  14508  4 002116   000036 630400 5                  EPPR0   30
         4 002117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002120   000000 701000 xent               TSX1    ASH$WARN
         4 002121   000000 011000                    NOP     0

      589    14513    6                  END;

      590    14514    5               END;

  14514  4 002122   002127 710000 4                  TRA     s:14536

      591    14515    5            ELSE DO;

      592    14516        /*ERROR:   ASC-E$BANNER_TOO_LONG-C
      593    14517          MESSAGE: Bannertext field too long.
      594    14518          MESSAGE1: A bannertext field can be at most 80 characters.
      595    14519        */
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:135  
      596    14520                    %SCREAM(ERR#=E$BANNER_TOO_LONG,LEVEL=ERROR,MID='C');

  14532  4 002123   000037 630400 5                  EPPR0   31
         4 002124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002125   000000 701000 xent               TSX1    ASH$ERROR
         4 002126   000000 011000                    NOP     0

      597    14535    5               END;

      598    14536    4            AS_MOD_USER.BANNER_A (0) = %YES#;

  14536  4 002127   000001 236003                    LDQ     1,DU
         4 002130   000000 256000 xsym               ORSQ    AS_MOD_USER
         4 002131   004447 710000 4                  TRA     LOOP_END

      599    14537        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:136  
      600    14538    4            SELECT (139 /* PROJECT_ADMIN_VAL */);

      601    14539    4            ERR_CODE.CODE = 0;

  14539  4 002132   000004 236000 5                  LDQ     4
         4 002133   000000 356000 xsym               ANSQ    ERR_CODE

      602    14540    4            P$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  14540  4 002134   100003 236100                    LDQ     3,,PR1
         4 002135   200016 756100                    STQ     P$,,AUTO

      603    14541    4            IF P$ -> P$NODE.CODE = 7   /*  NONE_VAL  */

  14541  4 002136   200016 473500                    LDP3    P$,,AUTO
         4 002137   300000 721100                    LXL1    0,,PR3
         4 002140   000007 101003                    CMPX1   7,DU
         4 002141   002146 601000 4                  TNZ     s:14546

      604    14542    5            THEN DO;

      605    14543    5               AS_USERS.BUDGET.MACCT = AS_NONE ;

  14543  4 002142   000000 100400                    MLR     fill='000'O
         4 002143   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 002144   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21

      606    14544    5               END;

  14544  4 002145   002234 710000 4                  TRA     s:14601

      607    14545    5            ELSE DO;

      608    14546    5               BLK$ = P$ -> P$NODE.SUBLK$(0);

  14546  4 002146   300003 236100                    LDQ     3,,PR3
         4 002147   200006 756100                    STQ     BLK$,,AUTO
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:137  

      609    14547    5               AS_USERS.BUDGET.MACCT.ACCT = ' ';

  14547  4 002150   040000 100400                    MLR     fill='040'O
         4 002151   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002152   000012 200010 xsym               ADSC9   AS_USERS+10              cn=1,n=8

      610    14548    5               AS_USERS.BUDGET.MACCT.NAME = ' ';

  14548  4 002153   040000 100400                    MLR     fill='040'O
         4 002154   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002155   000014 200014 xsym               ADSC9   AS_USERS+12              cn=1,n=12

      611    14549    5               IF OUT$SYM.TEXTC$ -> VARY$STR.CNT > 8

  14549  4 002156   200006 474500                    LDP4    BLK$,,AUTO
         4 002157   400003 475500                    LDP5    3,,PR4
         4 002160   500000 236100                    LDQ     0,,PR5
         4 002161   777000 376003                    ANQ     -512,DU
         4 002162   011000 116003                    CMPQ    4608,DU
         4 002163   002171 602000 4                  TNC     s:14571

      612    14550    6               THEN DO ;

      613    14551        /*E* ERROR:   ASC-E$ACCTTOOBIG-C
      614    14552             MESSAGE: ACCOUNT can be at most 8 characters long.
      615    14553        */
      616    14554                       %SCREAM( ERR#=E$ACCTTOOBIG, LEVEL=ERROR, MID='C' );

  14566  4 002164   000041 630400 5                  EPPR0   33
         4 002165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002166   000000 701000 xent               TSX1    ASH$ERROR
         4 002167   000000 011000                    NOP     0

      617    14569    6                  END ;

  14569  4 002170   002202 710000 4                  TRA     s:14574
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:138  

      618    14570    6               ELSE DO;

      619    14571    6                  AS_USERS.BUDGET.MACCT.ACCT = OUT$SYM.TEXTC$ -> VARY$STR.TEXT;

  14571  4 002171   500000 236100                    LDQ     0,,PR5
         4 002172   000033 772000                    QRL     27
         4 002173   000000 621006                    EAX1    0,QL
         4 002174   040000 100540                    MLR     fill='040'O
         4 002175   500000 200011                    ADSC9   0,,PR5                   cn=1,n=*X1
         4 002176   000012 200010 xsym               ADSC9   AS_USERS+10              cn=1,n=8

      620    14572    6                  AS_USERS.BUDGET.MACCT.COUNT = OUT$SYM.TEXTC$ -> VARY$STR.CNT;

  14572  4 002177   400003 475500                    LDP5    3,,PR4
         4 002200   500000 236100                    LDQ     0,,PR5
         4 002201   000012 552040 xsym               STBQ    AS_USERS+10,'40'O

      621    14573    6                  END;

      622    14574    5               BLK$ = P$ -> P$NODE.SUBLK$(1) ;

  14574  4 002202   200016 470500                    LDP0    P$,,AUTO
         4 002203   000004 236100                    LDQ     4,,PR0
         4 002204   200006 756100                    STQ     BLK$,,AUTO

      623    14575    5               IF OUT$SYM.TEXTC$->VARY$STR.CNT > 12

  14575  4 002205   200006 471500                    LDP1    BLK$,,AUTO
         4 002206   100003 473500                    LDP3    3,,PR1
         4 002207   300000 236100                    LDQ     0,,PR3
         4 002210   777000 376003                    ANQ     -512,DU
         4 002211   015000 116003                    CMPQ    6656,DU
         4 002212   002220 602000 4                  TNC     s:14597

      624    14576    6               THEN DO ;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:139  
      625    14577        /*E* ERROR:   ASC-E$UNAME_TOO_LONG-C
      626    14578             MESSAGE: NAME can be at most 12 characters long.
      627    14579        */
      628    14580                       %SCREAM( ERR#=E$UNAME_TOO_LONG, LEVEL=ERROR, MID='C' );

  14592  4 002213   000042 630400 5                  EPPR0   34
         4 002214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002215   000000 701000 xent               TSX1    ASH$ERROR
         4 002216   000000 011000                    NOP     0

      629    14595    6                  END ; /* Then do */

  14595  4 002217   002234 710000 4                  TRA     s:14601

      630    14596    6               ELSE DO;

      631    14597    6                  AS_USERS.BUDGET.MACCT.NAME = OUT$SYM.TEXTC$ -> VARY$STR.TEXT ;

  14597  4 002220   300000 236100                    LDQ     0,,PR3
         4 002221   000033 772000                    QRL     27
         4 002222   000000 620006                    EAX0    0,QL
         4 002223   040000 100540                    MLR     fill='040'O
         4 002224   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         4 002225   000014 200014 xsym               ADSC9   AS_USERS+12              cn=1,n=12

      632    14598    6                  AS_USERS.BUDGET.MACCT.COUNT = OUT$SYM.TEXTC$ -> VARY$STR.CNT + 8;

  14598  4 002226   100003 473500                    LDP3    3,,PR1
         4 002227   300000 236100                    LDQ     0,,PR3
         4 002230   000033 772000                    QRL     27
         4 002231   000010 036007                    ADLQ    8,DL
         4 002232   000033 736000                    QLS     27
         4 002233   000012 552040 xsym               STBQ    AS_USERS+10,'40'O

      633    14599    6                  END;

      634    14600    5               END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:140  

      635    14601    4            AS_MOD_USER.BUDGET.MACCT = %YES#;

  14601  4 002234   020000 236003                    LDQ     8192,DU
         4 002235   000022 256000 xsym               ORSQ    AS_MOD_USER+18
         4 002236   004447 710000 4                  TRA     LOOP_END

      636    14602        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:141  
      637    14603                                                              /**/
      638    14604    4            SELECT (131 /* LAST_LOGON_TIME_VAL */);

      639    14605    4            ERR_CODE.CODE = 0;

  14605  4 002237   000004 236000 5                  LDQ     4
         4 002240   000000 356000 xsym               ANSQ    ERR_CODE

      640    14606    5            DO I = 0 TO SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBNODES - 1;

  14606  4 002241   200010 450100                    STZ     I,,AUTO
         4 002242   002321 710000 4                  TRA     s:14616+1

      641    14607    6               DO SELECT (SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->OUT$SYM.CODE);

  14607  4 002243   200022 470500                    LDP0    SUBND$,,AUTO
         4 002244   000003 471500                    LDP1    3,,PR0
         4 002245   200010 720100                    LXL0    I,,AUTO
         4 002246   100003 473510                    LDP3    3,X0,PR1
         4 002247   300000 236100                    LDQ     0,,PR3
         4 002250   777777 376007                    ANQ     -1,DL
         4 002251   000204 116007                    CMPQ    132,DL
         4 002252   002320 602000 4                  TNC     s:14616
         4 002253   002260 600000 4                  TZE     s:14609
         4 002254   300000 721100                    LXL1    0,,PR3
         4 002255   000205 101003                    CMPX1   133,DU
         4 002256   002320 601000 4                  TNZ     s:14616
         4 002257   002300 710000 4                  TRA     s:14612

      642    14608    6                  SELECT (132 /* LOGON_DATE_VAL */);

      643    14609    6                  DATE_BUF = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->OUT$SYM.TEXT;

  14609  4 002260   300004 236100                    LDQ     4,,PR3
         4 002261   000033 772000                    QRL     27
         4 002262   000000 621006                    EAX1    0,QL
         4 002263   040000 100540                    MLR     fill='040'O
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:142  
         4 002264   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 002265   000016 000010 2                  ADSC9   DATE_BUF                 cn=0,n=8

      644    14610    6                  MAKE_UTS.DATE_.BOUND = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->
             14610                           OUT$SYM.COUNT - 1;

  14610  4 002266   000003 471500                    LDP1    3,,PR0
         4 002267   100003 473510                    LDP3    3,X0,PR1
         4 002270   300004 236100                    LDQ     4,,PR3
         4 002271   000033 772000                    QRL     27
         4 002272   000001 136007                    SBLQ    1,DL
         4 002273   000020 736000                    QLS     16
         4 002274   000002 676000 2                  ERQ     MAKE_UTS+2
         4 002275   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 002276   000002 656000 2                  ERSQ    MAKE_UTS+2
         4 002277   002320 710000 4                  TRA     s:14616

      645    14611    6                  SELECT (133 /* LOGON_TIME_VAL */);

      646    14612    6                  TIME_BUF = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->OUT$SYM.TEXT;

  14612  4 002300   300004 236100                    LDQ     4,,PR3
         4 002301   000033 772000                    QRL     27
         4 002302   000000 622006                    EAX2    0,QL
         4 002303   040000 100540                    MLR     fill='040'O
         4 002304   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 002305   000020 000013 2                  ADSC9   TIME_BUF                 cn=0,n=11

      647    14613    6                  MAKE_UTS.TIME_.BOUND = SUBND$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(I)->
             14613                           OUT$SYM.COUNT - 1;

  14613  4 002306   000003 471500                    LDP1    3,,PR0
         4 002307   100003 473510                    LDP3    3,X0,PR1
         4 002310   300004 236100                    LDQ     4,,PR3
         4 002311   000033 772000                    QRL     27
         4 002312   000001 136007                    SBLQ    1,DL
         4 002313   000020 736000                    QLS     16
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:143  
         4 002314   000004 676000 2                  ERQ     MAKE_UTS+4
         4 002315   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 002316   000004 656000 2                  ERSQ    MAKE_UTS+4
         4 002317   002320 710000 4                  TRA     s:14616

      648    14614    6                  SELECT (ELSE);

      649    14615    6                  END; /* Do case */

      650    14616    5               END; /* Do for the # subnodes */

  14616  4 002320   200010 054100                    AOS     I,,AUTO
         4 002321   200022 470500                    LDP0    SUBND$,,AUTO
         4 002322   000003 471500                    LDP1    3,,PR0
         4 002323   100001 236100                    LDQ     1,,PR1
         4 002324   000022 772000                    QRL     18
         4 002325   200010 116100                    CMPQ    I,,AUTO
         4 002326   002243 605400 4                  TPNZ    s:14607

      651    14617    4            CALL M$TIME (MAKE_UTS)

  14617  4 002327   000000 630400 2                  EPPR0   MAKE_UTS
         4 002330   420004 713400                    CLIMB   alt,+8196
         4 002331   402000 401760                    pmme    nvectors=5
         4 002332   002343 702000 4                  TSX2    s:14640

      652    14618    5            WHENRETURN DO;

      653    14619    5               AS_USERS.LAST_LOGON_TIME = UTS_BUF_BIT;

  14619  4 002333   000023 236000 2                  LDQ     UTS_BUF
         4 002334   000762 756000 xsym               STQ     AS_USERS+498

      654    14620    5               AS_MOD_USER.LAST_LOGON_TIME = AS_TRUE;

  14620  4 002335   000000 236000 xsym               LDQ     AS_TRUE
         4 002336   000006 772000                    QRL     6
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:144  
         4 002337   000051 676000 xsym               ERQ     AS_MOD_USER+41
         4 002340   004000 376003                    ANQ     2048,DU
         4 002341   000051 656000 xsym               ERSQ    AS_MOD_USER+41

      655    14621    5               END;

  14621  4 002342   002347 710000 4                  TRA     s:14643

      656    14622    5            WHENALTRETURN DO;

      657    14623        /*E* ERROR: ASC-E$BAD_TIME_SPEC-C
      658    14624             MESSAGE: The conversion of the date and time to a UTS failed.
      659    14625             MESSAGE1: The time must be values less than 23:59:59.99 and
      660    14626                       the date must be values less than 12/31/99 only.
      661    14627        */
      662    14628                    %SCREAM (ERR#=E$BAD_TIME_SPEC, LEVEL=ERROR, MID='C');

  14640  4 002343   000043 630400 5                  EPPR0   35
         4 002344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002345   000000 701000 xent               TSX1    ASH$ERROR
         4 002346   000000 011000                    NOP     0

      663    14643    5               END;

  14643  4 002347   004447 710000 4                  TRA     LOOP_END

      664    14644        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:145  
      665    14645    4            SELECT(49 /* CPROC_OPT_VAL */) ;

      666    14646    4            ERR_CODE.CODE = 0 ;

  14646  4 002350   000004 236000 5                  LDQ     4
         4 002351   000000 356000 xsym               ANSQ    ERR_CODE

      667    14647    4            K = SUBND$ -> P$NODE.SUBNODES - 1;

  14647  4 002352   200022 470500                    LDP0    SUBND$,,AUTO
         4 002353   000001 236100                    LDQ     1,,PR0
         4 002354   000022 772000                    QRL     18
         4 002355   000001 136007                    SBLQ    1,DL
         4 002356   200012 756100                    STQ     K,,AUTO

      668    14648    5            DO J = 0 TO K;

  14648  4 002357   200011 450100                    STZ     J,,AUTO
         4 002360   002460 710000 4                  TRA     s:14686+1

      669    14649    5               PTR$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14649  4 002361   200022 470500                    LDP0    SUBND$,,AUTO
         4 002362   200011 720100                    LXL0    J,,AUTO
         4 002363   000003 236110                    LDQ     3,X0,PR0
         4 002364   200017 756100                    STQ     PTR$,,AUTO

      670    14650    5               MODE = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14650  4 002365   200017 471500                    LDP1    PTR$,,AUTO
         4 002366   100003 473500                    LDP3    3,,PR1
         4 002367   300000 236100                    LDQ     0,,PR3
         4 002370   777777 376007                    ANQ     -1,DL
         4 002371   200014 756100                    STQ     MODE,,AUTO

      671    14651    6               IF PTR$ -> P$NODE.SUBNODES = 1 THEN DO;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:146  
  14651  4 002372   100001 221100                    LDX1    1,,PR1
         4 002373   000001 101003                    CMPX1   1,DU
         4 002374   002413 601000 4                  TNZ     s:14657

      672    14652    6                  AS_USERS.CPROC.NAME.CNT(MODE) = 0;

  14652  4 002375   200014 235100                    LDA     MODE,,AUTO
         4 002376   000003 735000                    ALS     3
         4 002377   000032 236000 xsym               LDQ     B_VECTNIL+26
         4 002400   000125 356005 xsym               ANSQ    AS_USERS+85,AL

      673    14653    6                  AS_USERS.CPROC.NAME.TEXT(MODE) = AS_BLANK;

  14653  4 002401   200014 235100                    LDA     MODE,,AUTO
         4 002402   000005 735000                    ALS     5
         4 002403   040005 100400                    MLR     fill='040'O
         4 002404   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 002405   000125 200037 xsym               ADSC9   AS_USERS+85,A            cn=1,n=31

      674    14654    6                  AS_MOD_USER.CPROC_A( MODE ) = AS_TRUE ;

  14654  4 002406   200014 235100                    LDA     MODE,,AUTO
         4 002407   003005 060400                    CSL     bolr='003'O
         4 002410   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002411   000001 010001 xsym               BDSC    AS_MOD_USER+1,A          by=0,bit=1,n=1

      675    14655    6                  END;

  14655  4 002412   002457 710000 4                  TRA     s:14686

      676    14656    6               ELSE DO;

      677    14657    6                  STR$ = PTR$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0) ;

  14657  4 002413   100004 473500                    LDP3    4,,PR1
         4 002414   300003 236100                    LDQ     3,,PR3
         4 002415   200020 756100                    STQ     STR$,,AUTO
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:147  

      678    14658    7                  IF VARY$STR.CNT <= 31 THEN DO;

  14658  4 002416   200020 474500                    LDP4    STR$,,AUTO
         4 002417   400000 236100                    LDQ     0,,PR4
         4 002420   777000 376003                    ANQ     -512,DU
         4 002421   040000 116003                    CMPQ    16384,DU
         4 002422   002446 603000 4                  TRC     s:14668

      679    14659    7                     AS_USERS.CPROC.NAME.CNT(MODE) = VARY$STR.CNT ;

  14659  4 002423   200014 235100                    LDA     MODE,,AUTO
         4 002424   000003 735000                    ALS     3
         4 002425   400000 236100                    LDQ     0,,PR4
         4 002426   000125 676005 xsym               ERQ     AS_USERS+85,AL
         4 002427   777000 376003                    ANQ     -512,DU
         4 002430   000125 656005 xsym               ERSQ    AS_USERS+85,AL

      680    14660    7                     AS_USERS.CPROC.NAME.TEXT(MODE) = VARY$STR.TEXT ;

  14660  4 002431   400000 236100                    LDQ     0,,PR4
         4 002432   000033 772000                    QRL     27
         4 002433   200014 235100                    LDA     MODE,,AUTO
         4 002434   000005 735000                    ALS     5
         4 002435   000000 621006                    EAX1    0,QL
         4 002436   040005 100540                    MLR     fill='040'O
         4 002437   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         4 002440   000125 200037 xsym               ADSC9   AS_USERS+85,A            cn=1,n=31

      681    14661    7                     AS_MOD_USER.CPROC_A( MODE ) = AS_TRUE ;

  14661  4 002441   200014 236100                    LDQ     MODE,,AUTO
         4 002442   003006 060400                    CSL     bolr='003'O
         4 002443   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002444   000001 010001 xsym               BDSC    AS_MOD_USER+1,Q          by=0,bit=1,n=1

      682    14662    7                     END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:148  

  14662  4 002445   002457 710000 4                  TRA     s:14686

      683    14663    7                  ELSE DO;

      684    14664        /*E*  ERROR:  ASC-E$CPROC_TOO_LONG-C
      685    14665              MESSAGE: %U1 CPROC too long.
      686    14666              MESSAGE1: CPROC can be at most 31 characters.
      687    14667        */
      688    14668    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);

  14668  4 002446   200014 236100                    LDQ     MODE,,AUTO
         4 002447   000007 402007                    MPY     7,DL
         4 002450   000000 100406                    MLR     fill='000'O
         4 002451   000000 000007 xsym               ADSC9   AS_MODE,Q                cn=0,n=7
         4 002452   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      689    14669                          %SCREAM(ERR#=E$CPROC_TOO_LONG,LEVEL=ERROR,MID='C');

  14681  4 002453   000044 630400 5                  EPPR0   36
         4 002454   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002455   000000 701000 xent               TSX1    ASH$ERROR
         4 002456   000000 011000                    NOP     0

      690    14684    7                     END;

      691    14685    6                  END;

      692    14686    5               END ;   /* Do j */

  14686  4 002457   200011 054100                    AOS     J,,AUTO
         4 002460   200012 236100                    LDQ     K,,AUTO
         4 002461   002361 604000 4                  TMI     s:14649
         4 002462   200011 116100                    CMPQ    J,,AUTO
         4 002463   002361 605000 4                  TPL     s:14649
         4 002464   004447 710000 4                  TRA     LOOP_END

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:149  
      693    14687        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:150  
      694    14688    4            SELECT(124 /* LAST_CPROC_VAL */) ;

      695    14689    4            K = SUBND$ -> P$NODE.SUBNODES - 1;

  14689  4 002465   100001 236100                    LDQ     1,,PR1
         4 002466   000022 772000                    QRL     18
         4 002467   000001 136007                    SBLQ    1,DL
         4 002470   200012 756100                    STQ     K,,AUTO

      696    14690    5            DO J = 0 TO K;

  14690  4 002471   200011 450100                    STZ     J,,AUTO
         4 002472   002572 710000 4                  TRA     s:14728+1

      697    14691    5               PTR$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14691  4 002473   200022 470500                    LDP0    SUBND$,,AUTO
         4 002474   200011 720100                    LXL0    J,,AUTO
         4 002475   000003 236110                    LDQ     3,X0,PR0
         4 002476   200017 756100                    STQ     PTR$,,AUTO

      698    14692    5               MODE = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14692  4 002477   200017 471500                    LDP1    PTR$,,AUTO
         4 002500   100003 473500                    LDP3    3,,PR1
         4 002501   300000 236100                    LDQ     0,,PR3
         4 002502   777777 376007                    ANQ     -1,DL
         4 002503   200014 756100                    STQ     MODE,,AUTO

      699    14693    6               IF PTR$ -> P$NODE.SUBNODES = 1 THEN DO;

  14693  4 002504   100001 221100                    LDX1    1,,PR1
         4 002505   000001 101003                    CMPX1   1,DU
         4 002506   002525 601000 4                  TNZ     s:14699

      700    14694    6                  AS_USERS.LASTCPROC.NAME.CNT(MODE) = 0;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:151  
  14694  4 002507   200014 235100                    LDA     MODE,,AUTO
         4 002510   000003 735000                    ALS     3
         4 002511   000032 236000 xsym               LDQ     B_VECTNIL+26
         4 002512   000165 356005 xsym               ANSQ    AS_USERS+117,AL

      701    14695    6                  AS_USERS.LASTCPROC.NAME.TEXT(MODE) = AS_BLANK;

  14695  4 002513   200014 235100                    LDA     MODE,,AUTO
         4 002514   000005 735000                    ALS     5
         4 002515   040005 100400                    MLR     fill='040'O
         4 002516   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 002517   000165 200037 xsym               ADSC9   AS_USERS+117,A           cn=1,n=31

      702    14696    6                  AS_MOD_USER.LASTCPROC_A( MODE ) = AS_TRUE ;

  14696  4 002520   200014 235100                    LDA     MODE,,AUTO
         4 002521   003005 060400                    CSL     bolr='003'O
         4 002522   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002523   000001 050001 xsym               BDSC    AS_MOD_USER+1,A          by=0,bit=5,n=1

      703    14697    6                  END;

  14697  4 002524   002571 710000 4                  TRA     s:14728

      704    14698    6               ELSE DO;

      705    14699    6                  STR$ = PTR$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0) ;

  14699  4 002525   100004 473500                    LDP3    4,,PR1
         4 002526   300003 236100                    LDQ     3,,PR3
         4 002527   200020 756100                    STQ     STR$,,AUTO

      706    14700    7                  IF VARY$STR.CNT <= 31 THEN DO;

  14700  4 002530   200020 474500                    LDP4    STR$,,AUTO
         4 002531   400000 236100                    LDQ     0,,PR4
         4 002532   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:152  
         4 002533   040000 116003                    CMPQ    16384,DU
         4 002534   002560 603000 4                  TRC     s:14710

      707    14701    7                     AS_USERS.LASTCPROC.NAME.CNT(MODE) = VARY$STR.CNT ;

  14701  4 002535   200014 235100                    LDA     MODE,,AUTO
         4 002536   000003 735000                    ALS     3
         4 002537   400000 236100                    LDQ     0,,PR4
         4 002540   000165 676005 xsym               ERQ     AS_USERS+117,AL
         4 002541   777000 376003                    ANQ     -512,DU
         4 002542   000165 656005 xsym               ERSQ    AS_USERS+117,AL

      708    14702    7                     AS_USERS.LASTCPROC.NAME.TEXT(MODE) =VARY$STR.TEXT;

  14702  4 002543   400000 236100                    LDQ     0,,PR4
         4 002544   000033 772000                    QRL     27
         4 002545   200014 235100                    LDA     MODE,,AUTO
         4 002546   000005 735000                    ALS     5
         4 002547   000000 621006                    EAX1    0,QL
         4 002550   040005 100540                    MLR     fill='040'O
         4 002551   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         4 002552   000165 200037 xsym               ADSC9   AS_USERS+117,A           cn=1,n=31

      709    14703    7                     AS_MOD_USER.LASTCPROC_A( MODE ) = AS_TRUE ;

  14703  4 002553   200014 236100                    LDQ     MODE,,AUTO
         4 002554   003006 060400                    CSL     bolr='003'O
         4 002555   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002556   000001 050001 xsym               BDSC    AS_MOD_USER+1,Q          by=0,bit=5,n=1

      710    14704    7                     END;

  14704  4 002557   002571 710000 4                  TRA     s:14728

      711    14705    7                  ELSE DO;

      712    14706        /*E*  ERROR:  ASC-E$LAST_CPROC_TOO_LONG-C
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:153  
      713    14707              MESSAGE: %U1 LAST CPROC too long.
      714    14708              MESSAGE1: LAST CPROC can be at most 31 characters.
      715    14709        */
      716    14710    7                     AS_FIELD1 = AS_MODE_ARRY(MODE);

  14710  4 002560   200014 236100                    LDQ     MODE,,AUTO
         4 002561   000007 402007                    MPY     7,DL
         4 002562   000000 100406                    MLR     fill='000'O
         4 002563   000000 000007 xsym               ADSC9   AS_MODE,Q                cn=0,n=7
         4 002564   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      717    14711                          %SCREAM(ERR#=E$LAST_CPROC_TOO_LONG,LEVEL=ERROR,MID='C');

  14723  4 002565   000045 630400 5                  EPPR0   37
         4 002566   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002567   000000 701000 xent               TSX1    ASH$ERROR
         4 002570   000000 011000                    NOP     0

      718    14726    7                     END;

      719    14727    6                  END;

      720    14728    5               END ;   /* Do j */

  14728  4 002571   200011 054100                    AOS     J,,AUTO
         4 002572   200012 236100                    LDQ     K,,AUTO
         4 002573   002473 604000 4                  TMI     s:14691
         4 002574   200011 116100                    CMPQ    J,,AUTO
         4 002575   002473 605000 4                  TPL     s:14691
         4 002576   004447 710000 4                  TRA     LOOP_END

      721    14729        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:154  
      722    14730    4            SELECT(125 /* STARS_ACCT_VAL */) ;

      723    14731    4            MODE = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14731  4 002577   100003 473500                    LDP3    3,,PR1
         4 002600   300000 236100                    LDQ     0,,PR3
         4 002601   777777 376007                    ANQ     -1,DL
         4 002602   200014 756100                    STQ     MODE,,AUTO

      724    14732    4            AS_USERS.FLAGS.STARSACC = ( MODE = 1   /*  YES_VAL  */ );

  14732  4 002603   400000 221003                    LDX1    -131072,DU
         4 002604   000001 116007                    CMPQ    1,DL
         4 002605   002607 600000 4                  TZE     s:14732+4
         4 002606   000000 221003                    LDX1    0,DU
         4 002607   000000 636011                    EAQ     0,X1
         4 002610   000005 772000                    QRL     5
         4 002611   000244 676000 xsym               ERQ     AS_USERS+164
         4 002612   010000 376003                    ANQ     4096,DU
         4 002613   000244 656000 xsym               ERSQ    AS_USERS+164

      725    14733    4            AS_MOD_USER.STARSACC = AS_TRUE ;

  14733  4 002614   000000 236000 xsym               LDQ     AS_TRUE
         4 002615   000004 772000                    QRL     4
         4 002616   000000 676000 xsym               ERQ     AS_MOD_USER
         4 002617   020000 376003                    ANQ     8192,DU
         4 002620   000000 656000 xsym               ERSQ    AS_MOD_USER
         4 002621   004447 710000 4                  TRA     LOOP_END

      726    14734
      727    14735    4            SELECT(50 /* EXPIRE_OPT */) ;

      728    14736    4            ERR_CODE.CODE = 0 ;

  14736  4 002622   000004 236000 5                  LDQ     4
         4 002623   000000 356000 xsym               ANSQ    ERR_CODE
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:155  

      729    14737    4            CALL ASC$EXPIRE( SUBND$ );      /*  Expiration  */

  14737  4 002624   200022 630500                    EPPR0   SUBND$,,AUTO
         4 002625   200054 450500                    STP0    OP_CODE+4,,AUTO
         4 002626   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 002627   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002630   000000 701000 xent               TSX1    ASC$EXPIRE
         4 002631   000000 011000                    NOP     0
         4 002632   004447 710000 4                  TRA     LOOP_END

      730    14738        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:156  
      731    14739    4            SELECT( 54   /*  BILLING_LIST_VAL */, 100  /*  FEBILLING_LIST_VAL */ ) ;

      732    14740    4            IF CODE = 100  /*  FEBILLING_LIST_VAL */

  14740  4 002633   000000 235000 xsym               LDA     CODE
         4 002634   000144 115007                    CMPA    100,DL
         4 002635   002641 601000 4                  TNZ     s:14742

      733    14741    4            THEN FE_MODE = '1'B ;

  14741  4 002636   400000 236003                    LDQ     -131072,DU
         4 002637   000015 756000 2                  STQ     FE_MODE
         4 002640   002642 710000 4                  TRA     s:14743

      734    14742    4            ELSE FE_MODE = '0'B ;

  14742  4 002641   000015 450000 2                  STZ     FE_MODE

      735    14743    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  14743  4 002642   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 002643   002651 604400 4                  TMOZ    s:14764

      736    14744        /*E* ERROR:      ASC-E$BILLING_CHG-C
      737    14745             MESSAGE:    Project Administrator cannot change user's BILLING.
      738    14746        */
      739    14747                    %SCREAM (ERR#=E$BILLING_CHG, LEVEL=ERROR,MID='C');

  14759  4 002644   000046 630400 5                  EPPR0   38
         4 002645   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002646   000000 701000 xent               TSX1    ASH$ERROR
         4 002647   000000 011000                    NOP     0

      740    14762    5               END;  /* Of then do  */

  14762  4 002650   004447 710000 4                  TRA     LOOP_END

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:157  
      741    14763    5            ELSE DO;

      742    14764    5               ERR_CODE.CODE = 0 ;

  14764  4 002651   000004 236000 5                  LDQ     4
         4 002652   000000 356000 xsym               ANSQ    ERR_CODE

      743    14765    5               SUBS = SUBND$ -> P$NODE.SUBNODES - 1;

  14765  4 002653   200022 470500                    LDP0    SUBND$,,AUTO
         4 002654   000001 236100                    LDQ     1,,PR0
         4 002655   000022 772000                    QRL     18
         4 002656   000001 136007                    SBLQ    1,DL
         4 002657   200023 756100                    STQ     SUBS,,AUTO

      744    14766    6               DO J = 0 TO SUBS;

  14766  4 002660   200011 450100                    STZ     J,,AUTO
         4 002661   002761 710000 4                  TRA     s:14806+1

      745    14767    6                  P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14767  4 002662   200022 470500                    LDP0    SUBND$,,AUTO
         4 002663   200011 720100                    LXL0    J,,AUTO
         4 002664   000003 236110                    LDQ     3,X0,PR0
         4 002665   200016 756100                    STQ     P$,,AUTO

      746    14768    6                  MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  14768  4 002666   200016 471500                    LDP1    P$,,AUTO
         4 002667   100003 473500                    LDP3    3,,PR1
         4 002670   300000 236100                    LDQ     0,,PR3
         4 002671   777777 376007                    ANQ     -1,DL
         4 002672   200014 756100                    STQ     MODE,,AUTO

      747    14769    6                  STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0);

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:158  
  14769  4 002673   100004 473500                    LDP3    4,,PR1
         4 002674   300003 236100                    LDQ     3,,PR3
         4 002675   200020 756100                    STQ     STR$,,AUTO

      748    14770    6                  IF VARY$STR.CNT <= 6

  14770  4 002676   200020 474500                    LDP4    STR$,,AUTO
         4 002677   400000 236100                    LDQ     0,,PR4
         4 002700   777000 376003                    ANQ     -512,DU
         4 002701   007000 116003                    CMPQ    3584,DU
         4 002702   002737 603000 4                  TRC     s:14787

      749    14771    7                  THEN DO;

      750    14772    7                     IF FE_MODE

  14772  4 002703   000015 234000 2                  SZN     FE_MODE
         4 002704   002722 605000 4                  TPL     s:14778

      751    14773    8                     THEN DO ;

      752    14774    8                        KL_DREC.KL_DREC_FEBLK.BILL(MODE) = VARY$STR.TEXT;

  14774  4 002705   400000 236100                    LDQ     0,,PR4
         4 002706   000033 772000                    QRL     27
         4 002707   000000 621006                    EAX1    0,QL
         4 002710   200014 236100                    LDQ     MODE,,AUTO
         4 002711   000006 402007                    MPY     6,DL
         4 002712   040006 100540                    MLR     fill='040'O
         4 002713   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         4 002714   000020 000006 xsym               ADSC9   KL_DREC+16,Q             cn=0,n=6

      753    14775    8                        AS_MOD_USER.FEBILL_A(MODE) = AS_TRUE;

  14775  4 002715   200014 235100                    LDA     MODE,,AUTO
         4 002716   003005 060400                    CSL     bolr='003'O
         4 002717   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:159  
         4 002720   000030 230001 xsym               BDSC    AS_MOD_USER+24,A         by=1,bit=3,n=1

      754    14776    8                        END ;

  14776  4 002721   002760 710000 4                  TRA     s:14806

      755    14777    8                     ELSE DO ;

      756    14778    8                        AS_USERS.BILL(MODE) = VARY$STR.TEXT;

  14778  4 002722   400000 236100                    LDQ     0,,PR4
         4 002723   000033 772000                    QRL     27
         4 002724   000000 621006                    EAX1    0,QL
         4 002725   200014 236100                    LDQ     MODE,,AUTO
         4 002726   000006 402007                    MPY     6,DL
         4 002727   040006 100540                    MLR     fill='040'O
         4 002730   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         4 002731   000020 000006 xsym               ADSC9   AS_USERS+16,Q            cn=0,n=6

      757    14779    8                        AS_MOD_USER.BILL_A(MODE) = AS_TRUE;

  14779  4 002732   200014 235100                    LDA     MODE,,AUTO
         4 002733   003005 060400                    CSL     bolr='003'O
         4 002734   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 002735   000001 200001 xsym               BDSC    AS_MOD_USER+1,A          by=1,bit=0,n=1

      758    14780    8                        END ;

      759    14781    7                     END;

  14781  4 002736   002760 710000 4                  TRA     s:14806

      760    14782    7                  ELSE DO;

      761    14783        /*E*  ERROR:  ASC-E$RATE_SCHEDULE_TOO_LONG-C
      762    14784              MESSAGE: %U1 BILLING schedule too long.
      763    14785              MESSAGE1: BILLING schedule can be at most 6 characters long.
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:160  
      764    14786        */
      765    14787    7                     IF FE_MODE

  14787  4 002737   000015 234000 2                  SZN     FE_MODE
         4 002740   002747 605000 4                  TPL     s:14789

      766    14788    7                     THEN AS_FIELD1 = AS_FE_MODE_ARRY(MODE) ;

  14788  4 002741   200014 236100                    LDQ     MODE,,AUTO
         4 002742   000007 402007                    MPY     7,DL
         4 002743   000000 100406                    MLR     fill='000'O
         4 002744   000000 000007 xsym               ADSC9   AS_FE_MODE,Q             cn=0,n=7
         4 002745   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41
         4 002746   002754 710000 4                  TRA     s:14802

      767    14789    7                     ELSE AS_FIELD1 = AS_MODE_ARRY(MODE);

  14789  4 002747   200014 236100                    LDQ     MODE,,AUTO
         4 002750   000007 402007                    MPY     7,DL
         4 002751   000000 100406                    MLR     fill='000'O
         4 002752   000000 000007 xsym               ADSC9   AS_MODE,Q                cn=0,n=7
         4 002753   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      768    14790                          %SCREAM( ERR#=E$RATE_SCHEDULE_TOO_LONG, LEVEL=ERROR, MID='C' );

  14802  4 002754   000047 630400 5                  EPPR0   39
         4 002755   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002756   000000 701000 xent               TSX1    ASH$ERROR
         4 002757   000000 011000                    NOP     0

      769    14805    7                     END;

      770    14806    6                  END;

  14806  4 002760   200011 054100                    AOS     J,,AUTO
         4 002761   200023 236100                    LDQ     SUBS,,AUTO
         4 002762   002662 604000 4                  TMI     s:14767
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:161  
         4 002763   200011 116100                    CMPQ    J,,AUTO
         4 002764   002662 605000 4                  TPL     s:14767

      771    14807    5               END; /* Of else do  */

  14807  4 002765   004447 710000 4                  TRA     LOOP_END

      772    14808        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:162  
      773    14809    4            SELECT( 105 /* FEACCTMEM_OPT_VAL */ ) ;

      774    14810    5            IF AS_CR_MOD_PROJ > 0 THEN DO ;

  14810  4 002766   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 002767   002774 604400 4                  TMOZ    s:14830

      775    14811        /*E*  ERROR:  ASC-E$FEACCTMEM_TOO_BIG-C
      776    14812              MESSAGE: Project Administrator cannot change MAX ACCT MEMORY .
      777    14813        */
      778    14814                    %SCREAM( ERR#=E$FEACCTMEM_TOO_BIG, LEVEL=ERROR, MID='C' );

  14826  4 002770   000050 630400 5                  EPPR0   40
         4 002771   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002772   000000 701000 xent               TSX1    ASH$ERROR
         4 002773   000000 011000                    NOP     0

      779    14829    5               END ;

      780    14830    4            ERR_CODE = '0'B ;

  14830  4 002774   000000 450000 xsym               STZ     ERR_CODE

      781    14831    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  14831  4 002775   200022 470500                    LDP0    SUBND$,,AUTO
         4 002776   000003 471500                    LDP1    3,,PR0
         4 002777   100003 236100                    LDQ     3,,PR1
         4 003000   200020 756100                    STQ     STR$,,AUTO

      782    14832    4            CALL CHARBIN( MODE, VARY$STR.TEXT ) ;

  14832  4 003001   200020 473500                    LDP3    STR$,,AUTO
         4 003002   300000 236100                    LDQ     0,,PR3
         4 003003   000033 772000                    QRL     27
         4 003004   000000 620006                    EAX0    0,QL
         4 003005   000100 305540                    DTB
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:163  
         4 003006   300000 230010                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         4 003007   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 003010   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 003011   200014 755100                    STA     MODE,,AUTO

      783    14833    5            IF MODE > 9999 THEN DO ;

  14833  4 003012   023420 115007                    CMPA    10000,DL
         4 003013   003020 602000 4                  TNC     s:14853

      784    14834        /*E*  ERROR:  ASC-E$FEMACCTMEM_TOO_LRG-C
      785    14835              MESSAGE: Maximum FEMACCTMEM value is 9999.
      786    14836        */
      787    14837                    %SCREAM( ERR#=E$FEMACCTMEM_TOO_LRG, LEVEL=ERROR, MID='C') ;

  14849  4 003014   000051 630400 5                  EPPR0   41
         4 003015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003016   000000 701000 xent               TSX1    ASH$ERROR
         4 003017   000000 011000                    NOP     0

      788    14852    5               END ;

      789    14853    4            KL_DREC.KL_DREC_FEBLK.MACCTMEM = MODE ;

  14853  4 003020   200014 236100                    LDQ     MODE,,AUTO
         4 003021   000011 736000                    QLS     9
         4 003022   000031 552030 xsym               STBQ    KL_DREC+25,'30'O

      790    14854    4            AS_MOD_USER.FEMACCTMEM = AS_TRUE ;

  14854  4 003023   000000 236000 xsym               LDQ     AS_TRUE
         4 003024   000035 772000                    QRL     29
         4 003025   000050 676000 xsym               ERQ     AS_MOD_USER+40
         4 003026   000100 376007                    ANQ     64,DL
         4 003027   000050 656000 xsym               ERSQ    AS_MOD_USER+40
         4 003030   004447 710000 4                  TRA     LOOP_END

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:164  
      791    14855        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:165  
      792    14856    4            SELECT( 121 /* FACCOUNT_OPT_VAL */ );

      793    14857    4            IF AS_CR_MOD_PROJ = %CR_PROJ_DEFAULT

  14857  4 003031   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003032   000003 115007                    CMPA    3,DL
         4 003033   003036 600000 4                  TZE     s:14877
         4 003034   000052 115000 5                  CMPA    42
         4 003035   003043 601000 4                  TNZ     s:14882

      794    14858    4                 OR  AS_CR_MOD_PROJ = - %CR_PROJ_DEFAULT
      795    14859    5            THEN DO;

      796    14860        /*E*  ERROR:      ASC-E$FACCOUNT_NOT_ALLOWED-C
      797    14861              MESSAGE: FACCOUNT option not allowed.
      798    14862              MESSAGE1: The FACCOUNT option is not allowed when defining the
      799    14863                        DEFAULT record for users in a project.
      800    14864        */
      801    14865                    %SCREAM( ERR#=E$FACCOUNT_NOT_ALLOWED,MID='C',LEVEL=ERROR);

  14877  4 003036   000053 630400 5                  EPPR0   43
         4 003037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003040   000000 701000 xent               TSX1    ASH$ERROR
         4 003041   000000 011000                    NOP     0

      802    14880    5               GOTO LOOP_END;

  14880  4 003042   004447 710000 4                  TRA     LOOP_END

      803    14881    5               END;
      804    14882    4            SUPER_TO_PIG.TYPE = %VALIDATE_ATTR;

  14882  4 003043   000000 473400 xsym               LDP3    AS_SUPER_TO_PIG$
         4 003044   003000 236003                    LDQ     1536,DU
         4 003045   300000 552140                    STBQ    0,'40'O,PR3

      805    14883    4            SUPER_TO_PIG.PROJ = AS_FALSE;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:166  

  14883  4 003046   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 003047   000000 236000 xsym               LDQ     AS_FALSE
         4 003050   000011 772000                    QRL     9
         4 003051   000000 676100                    ERQ     0,,PR0
         4 003052   000400 376003                    ANQ     256,DU
         4 003053   000000 656100                    ERSQ    0,,PR0

      806    14884    4            SUPER_TO_PIG.PACKSET = AS_USERS.HPSN;

  14884  4 003054   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 003055   040100 100400                    MLR     fill='040'O
         4 003056   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6
         4 003057   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6

      807    14885    4            CALL ASB$PIG_ACCT_ATTR( SUPER_TO_PIG ) ALTRET(CM_LOOP);

  14885  4 003060   000000 630400 xsym               EPPR0   AS_SUPER_TO_PIG$
         4 003061   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003062   000000 701000 xent               TSX1    ASB$PIG_ACCT_ATTR
         4 003063   000010 702000 4                  TSX2    CM_LOOP

      808    14886    4            IF CR_MOD_FLG THEN

  14886  4 003064   000000 234000 xsym               SZN     CR_MOD_FLG
         4 003065   003072 605000 4                  TPL     s:14889

      809    14887    4               SUPER_TO_PIG.TYPE = %MODIFY_ACCT;

  14887  4 003066   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 003067   001000 236003                    LDQ     512,DU
         4 003070   000000 552140                    STBQ    0,'40'O,PR0
         4 003071   003075 710000 4                  TRA     s:14890

      810    14888    4            ELSE
      811    14889    4               SUPER_TO_PIG.TYPE = %CREATE_ACCT;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:167  
  14889  4 003072   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 003073   000000 236003                    LDQ     0,DU
         4 003074   000000 552140                    STBQ    0,'40'O,PR0

      812    14890    4            SUPER_TO_PIG.PROJ = (AS_CR_MOD_PROJ > 0);

  14890  4 003075   400000 220003                    LDX0    -131072,DU
         4 003076   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003077   003101 605400 4                  TPNZ    s:14890+4
         4 003100   000000 220003                    LDX0    0,DU
         4 003101   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 003102   000000 636010                    EAQ     0,X0
         4 003103   000011 772000                    QRL     9
         4 003104   000000 676100                    ERQ     0,,PR0
         4 003105   000400 376003                    ANQ     256,DU
         4 003106   000000 656100                    ERSQ    0,,PR0

      813    14891    4            CALL ASB$PIG( SUPER_TO_PIG ) ALTRET(CM_LOOP);

  14891  4 003107   000000 630400 xsym               EPPR0   AS_SUPER_TO_PIG$
         4 003110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003111   000000 701000 xent               TSX1    ASB$PIG
         4 003112   000010 702000 4                  TSX2    CM_LOOP

      814    14892    4            AS_MOD_USER.FACCOUNT = AS_TRUE;

  14892  4 003113   000000 236000 xsym               LDQ     AS_TRUE
         4 003114   000013 772000                    QRL     11
         4 003115   000030 676000 xsym               ERQ     AS_MOD_USER+24
         4 003116   000100 376003                    ANQ     64,DU
         4 003117   000030 656000 xsym               ERSQ    AS_MOD_USER+24

      815    14893    4            GOTO CM_LOOP;

  14893  4 003120   000010 710000 4                  TRA     CM_LOOP

      816    14894        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:168  
      817    14895    4            SELECT(59   /*  PRIV_VAL_VAL */) ;

      818    14896    4            ERR_CODE.CODE = 0 ;

  14896  4 003121   000004 236000 5                  LDQ     4
         4 003122   000000 356000 xsym               ANSQ    ERR_CODE

      819    14897    4            CALL ASC$PRIV ;

  14897  4 003123   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003124   000000 701000 xent               TSX1    ASC$PRIV
         4 003125   000000 011000                    NOP     0
         4 003126   004447 710000 4                  TRA     LOOP_END

      820    14898                                                              /**/
      821    14899    4            SELECT(80 /* PPRIV_OPT */) ;

      822    14900    4            ERR_CODE = '0'B ;

  14900  4 003127   000000 450000 xsym               STZ     ERR_CODE

      823    14901    4            CALL ASC$PPRIV ;

  14901  4 003130   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003131   000000 701000 xent               TSX1    ASC$PPRIV
         4 003132   000000 011000                    NOP     0
         4 003133   004447 710000 4                  TRA     LOOP_END

      824    14902                                                              /**/
      825    14903    4            SELECT(101 /* FEPRIV_OPT_VAL */) ;

      826    14904    4            ERR_CODE.CODE = 0 ;

  14904  4 003134   000004 236000 5                  LDQ     4
         4 003135   000000 356000 xsym               ANSQ    ERR_CODE

      827    14905    4            CALL ASC$FEPRIV ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:169  

  14905  4 003136   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003137   000000 701000 xent               TSX1    ASC$FEPRIV
         4 003140   000000 011000                    NOP     0
         4 003141   004447 710000 4                  TRA     LOOP_END

      828    14906                                                              /**/
      829    14907    4            SELECT(102 /* FEPPRIV_OPT_VAL */) ;

      830    14908    4            ERR_CODE = '0'B ;

  14908  4 003142   000000 450000 xsym               STZ     ERR_CODE

      831    14909    4            CALL ASC$FEPPRIV ;

  14909  4 003143   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003144   000000 701000 xent               TSX1    ASC$FEPPRIV
         4 003145   000000 011000                    NOP     0
         4 003146   004447 710000 4                  TRA     LOOP_END

      832    14910    4            SELECT(60   /*  BUDGET_OPT_VAL */) ;

      833    14911    4            ERR_CODE.CODE = 0 ;

  14911  4 003147   000004 236000 5                  LDQ     4
         4 003150   000000 356000 xsym               ANSQ    ERR_CODE

      834    14912    4            CALL ASC$BUDGET(CR_MOD_KEY) ;

  14912  4 003151   200003 630500                    EPPR0   @CR_MOD_KEY,,AUTO
         4 003152   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003153   000000 701000 xent               TSX1    ASC$BUDGET
         4 003154   000000 011000                    NOP     0
         4 003155   004447 710000 4                  TRA     LOOP_END

      835    14913        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:170  
      836    14914    4            SELECT( 90   /*  QUAN_OPT_VAL */ ) ;

      837    14915    4            ERR_CODE = '0'B ;

  14915  4 003156   000000 450000 xsym               STZ     ERR_CODE

      838    14916    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;

  14916  4 003157   200022 470500                    LDP0    SUBND$,,AUTO
         4 003160   000001 236100                    LDQ     1,,PR0
         4 003161   000022 772000                    QRL     18
         4 003162   000001 136007                    SBLQ    1,DL
         4 003163   200023 756100                    STQ     SUBS,,AUTO

      839    14917    5            DO J = 0 TO SUBS ;

  14917  4 003164   200011 450100                    STZ     J,,AUTO
         4 003165   003315 710000 4                  TRA     s:14974+1

      840    14918    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14918  4 003166   200022 470500                    LDP0    SUBND$,,AUTO
         4 003167   200011 720100                    LXL0    J,,AUTO
         4 003170   000003 236110                    LDQ     3,X0,PR0
         4 003171   200016 756100                    STQ     P$,,AUTO

      841    14919    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14919  4 003172   200016 471500                    LDP1    P$,,AUTO
         4 003173   100003 473500                    LDP3    3,,PR1
         4 003174   300000 236100                    LDQ     0,,PR3
         4 003175   777777 376007                    ANQ     -1,DL
         4 003176   200014 756100                    STQ     MODE,,AUTO

      842    14920    5               IF P$->P$NODE.SUBLK$(1)->P$NODE.CODE = 105  /* SIGN_VAL */ THEN

  14920  4 003177   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:171  
         4 003200   300000 721100                    LXL1    0,,PR3
         4 003201   000151 101003                    CMPX1   105,DU
         4 003202   003207 601000 4                  TNZ     s:14923

      843    14921    5                  STR$ = P$ -> P$NODE.SUBLK$(2) -> P$NODE.SUBLK$ (0) ;

  14921  4 003203   100005 474500                    LDP4    5,,PR1
         4 003204   400003 236100                    LDQ     3,,PR4
         4 003205   200020 756100                    STQ     STR$,,AUTO
         4 003206   003211 710000 4                  TRA     s:14924

      844    14922    5               ELSE
      845    14923    5                  STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;

  14923  4 003207   300003 236100                    LDQ     3,,PR3
         4 003210   200020 756100                    STQ     STR$,,AUTO

      846    14924    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;

  14924  4 003211   200020 474500                    LDP4    STR$,,AUTO
         4 003212   400000 236100                    LDQ     0,,PR4
         4 003213   000033 772000                    QRL     27
         4 003214   000000 622006                    EAX2    0,QL
         4 003215   000100 305540                    DTB
         4 003216   400000 230012                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 003217   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 003220   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 003221   200012 755100                    STA     K,,AUTO

      847    14925    6               IF K > BITBIN('377777'O) THEN DO ;

  14925  4 003222   400000 115007                    CMPA    -131072,DL
         4 003223   003231 602000 4                  TNC     s:14947

      848    14926        /*E*  ERROR:    ASC-E$QUAN_TOO_BIG-C
      849    14927              MESSAGE:  QUAN value is too big.
      850    14928              MESSAGE1: QUAN value must be between -2**17-1 and 2**17-1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:172  
      851    14929        */
      852    14930                       %SCREAM( ERR#=E$QUAN_TOO_BIG, LEVEL=ERROR, MID='C') ;

  14942  4 003224   000054 630400 5                  EPPR0   44
         4 003225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003226   000000 701000 xent               TSX1    ASH$ERROR
         4 003227   000000 011000                    NOP     0

      853    14945    6                  GOTO LOOP_END ;

  14945  4 003230   004447 710000 4                  TRA     LOOP_END

      854    14946    6                  END ;
      855    14947    5              IF P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE=1 /* MINUS_VAL */
             14947                        THEN

  14947  4 003231   100004 473500                    LDP3    4,,PR1
         4 003232   300003 475500                    LDP5    3,,PR3
         4 003233   500000 721100                    LXL1    0,,PR5
         4 003234   000001 101003                    CMPX1   1,DU
         4 003235   003247 601000 4                  TNZ     s:14950

      856    14948    5                  AS_USERS.QUAN(MODE) = (-1 * K);

  14948  4 003236   000000 236003                    LDQ     0,DU
         4 003237   200012 136100                    SBLQ    K,,AUTO
         4 003240   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 003241   200014 235100                    LDA     MODE,,AUTO
         4 003242   000001 735000                    ALS     1
         4 003243   000005 101500                    MRL     fill='000'O
         4 003244   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 003245   000235 000002 xsym               ADSC9   AS_USERS+157,A           cn=0,n=2
         4 003246   003254 710000 4                  TRA     s:14951

      857    14949    5               ELSE
      858    14950    5                  AS_USERS.QUAN(MODE) = K;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:173  
  14950  4 003247   200014 236100                    LDQ     MODE,,AUTO
         4 003250   000001 736000                    QLS     1
         4 003251   000006 101500                    MRL     fill='000'O
         4 003252   200012 000004                    ADSC9   K,,AUTO                  cn=0,n=4
         4 003253   000235 000002 xsym               ADSC9   AS_USERS+157,Q           cn=0,n=2

      859    14951    5               IF AS_CR_MOD_PROJ > 0 THEN

  14951  4 003254   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003255   003310 604400 4                  TMOZ    s:14973

      860    14952    6                  IF AS_USERS.QUAN(MODE) > AS_DFLT.QUAN(MODE) THEN DO ;

  14952  4 003256   200014 236100                    LDQ     MODE,,AUTO
         4 003257   000001 736000                    QLS     1
         4 003260   000100 100406                    MLR     fill='000'O
         4 003261   000235 000002 xsym               ADSC9   AS_DFLT+157,Q            cn=0,n=2
         4 003262   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 003263   200054 236100                    LDQ     OP_CODE+4,,AUTO
         4 003264   000022 732000                    QRS     18
         4 003265   200055 756100                    STQ     OP_CODE+5,,AUTO
         4 003266   200014 235100                    LDA     MODE,,AUTO
         4 003267   000001 735000                    ALS     1
         4 003270   000100 100405                    MLR     fill='000'O
         4 003271   000235 000002 xsym               ADSC9   AS_USERS+157,A           cn=0,n=2
         4 003272   200056 000004                    ADSC9   OP_CODE+6,,AUTO          cn=0,n=4
         4 003273   200056 236100                    LDQ     OP_CODE+6,,AUTO
         4 003274   000022 732000                    QRS     18
         4 003275   200055 116100                    CMPQ    OP_CODE+5,,AUTO
         4 003276   003310 604400 4                  TMOZ    s:14973

      861    14953        /*E*  ERROR:  ASC-E$QUAN_LIMIT-C
      862    14954              MESSAGE: %U1 QUAN value is too large.  Set to maximum of %U2.
      863    14955        */
      864    14956                          %SCREAM( ERR#=E$QUAN_LIMIT, LEVEL=ERROR, MID='C');

  14968  4 003277   000055 630400 5                  EPPR0   45
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:174  
         4 003300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003301   000000 701000 xent               TSX1    ASH$ERROR
         4 003302   000000 011000                    NOP     0

      865    14971    6                     AS_USERS.QUAN(MODE) = AS_DFLT.QUAN(MODE) ;

  14971  4 003303   200014 235100                    LDA     MODE,,AUTO
         4 003304   000001 735000                    ALS     1
         4 003305   000005 100405                    MLR     fill='000'O
         4 003306   000235 000002 xsym               ADSC9   AS_DFLT+157,A            cn=0,n=2
         4 003307   000235 000002 xsym               ADSC9   AS_USERS+157,A           cn=0,n=2

      866    14972    6                     END ;

      867    14973    5               AS_MOD_USER.QUAN_A(MODE) = AS_TRUE ;

  14973  4 003310   200014 235100                    LDA     MODE,,AUTO
         4 003311   003005 060400                    CSL     bolr='003'O
         4 003312   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 003313   000021 430001 xsym               BDSC    AS_MOD_USER+17,A         by=2,bit=3,n=1

      868    14974    5               END ;

  14974  4 003314   200011 054100                    AOS     J,,AUTO
         4 003315   200023 236100                    LDQ     SUBS,,AUTO
         4 003316   003166 604000 4                  TMI     s:14918
         4 003317   200011 116100                    CMPQ    J,,AUTO
         4 003320   003166 605000 4                  TPL     s:14918
         4 003321   004447 710000 4                  TRA     LOOP_END

      869    14975        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:175  
      870    14976    4            SELECT( 108 /* MAXENQ_OPT_VAL */ ) ;

      871    14977    4            ERR_CODE = '0'B ;

  14977  4 003322   000000 450000 xsym               STZ     ERR_CODE

      872    14978    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;

  14978  4 003323   200022 470500                    LDP0    SUBND$,,AUTO
         4 003324   000001 236100                    LDQ     1,,PR0
         4 003325   000022 772000                    QRL     18
         4 003326   000001 136007                    SBLQ    1,DL
         4 003327   200023 756100                    STQ     SUBS,,AUTO

      873    14979    5            DO J = 0 TO SUBS ;

  14979  4 003330   200011 450100                    STZ     J,,AUTO
         4 003331   003421 710000 4                  TRA     s:15030+1

      874    14980    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  14980  4 003332   200022 470500                    LDP0    SUBND$,,AUTO
         4 003333   200011 720100                    LXL0    J,,AUTO
         4 003334   000003 236110                    LDQ     3,X0,PR0
         4 003335   200016 756100                    STQ     P$,,AUTO

      875    14981    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14981  4 003336   200016 471500                    LDP1    P$,,AUTO
         4 003337   100003 473500                    LDP3    3,,PR1
         4 003340   300000 236100                    LDQ     0,,PR3
         4 003341   777777 376007                    ANQ     -1,DL
         4 003342   200014 756100                    STQ     MODE,,AUTO

      876    14982    5               STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;

  14982  4 003343   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:176  
         4 003344   300003 236100                    LDQ     3,,PR3
         4 003345   200020 756100                    STQ     STR$,,AUTO

      877    14983    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;

  14983  4 003346   200020 474500                    LDP4    STR$,,AUTO
         4 003347   400000 236100                    LDQ     0,,PR4
         4 003350   000033 772000                    QRL     27
         4 003351   000000 621006                    EAX1    0,QL
         4 003352   000100 305540                    DTB
         4 003353   400000 230011                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 003354   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 003355   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 003356   200012 755100                    STA     K,,AUTO

      878    14984    6               IF K > 262143 THEN DO ;

  14984  4 003357   000001 115003                    CMPA    1,DU
         4 003360   003366 602000 4                  TNC     s:15006

      879    14985        /*E*  ERROR:    ASC-E$MAXENQ_TOO_BIG-C
      880    14986              MESSAGE:  MAXENQ value is too big.
      881    14987              MESSAGE1: MAXENQ value can be at most 262143.
      882    14988        */
      883    14989                       %SCREAM( ERR#=E$MAXENQ_TOO_BIG, LEVEL=ERROR, MID='C') ;

  15001  4 003361   000056 630400 5                  EPPR0   46
         4 003362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003363   000000 701000 xent               TSX1    ASH$ERROR
         4 003364   000000 011000                    NOP     0

      884    15004    6                  GOTO LOOP_END ;

  15004  4 003365   004447 710000 4                  TRA     LOOP_END

      885    15005    6                  END ;
      886    15006    5               AS_USERS.MAXENQ(MODE) = K ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:177  

  15006  4 003366   200014 236100                    LDQ     MODE,,AUTO
         4 003367   000001 736000                    QLS     1
         4 003370   000006 101500                    MRL     fill='000'O
         4 003371   200012 000004                    ADSC9   K,,AUTO                  cn=0,n=4
         4 003372   000775 000002 xsym               ADSC9   AS_USERS+509,Q           cn=0,n=2

      887    15007    5               IF AS_CR_MOD_PROJ > 0 THEN

  15007  4 003373   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003374   003414 604400 4                  TMOZ    s:15029

      888    15008    6                  IF K > AS_DFLT.MAXENQ(MODE) THEN DO ;

  15008  4 003375   000100 101406                    MRL     fill='000'O
         4 003376   000775 000002 xsym               ADSC9   AS_DFLT+509,Q            cn=0,n=2
         4 003377   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 003400   200054 236100                    LDQ     OP_CODE+4,,AUTO
         4 003401   200012 116100                    CMPQ    K,,AUTO
         4 003402   003414 603000 4                  TRC     s:15029

      889    15009        /*E*  ERROR:  ASC-E$MAXENQ_LIMIT-C
      890    15010              MESSAGE: %U1 MAXENQ value is too large.  Set to maximum of %U2.
      891    15011        */
      892    15012                          %SCREAM( ERR#=E$MAXENQ_LIMIT, LEVEL=ERROR, MID='C');

  15024  4 003403   000057 630400 5                  EPPR0   47
         4 003404   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003405   000000 701000 xent               TSX1    ASH$ERROR
         4 003406   000000 011000                    NOP     0

      893    15027    6                     AS_USERS.MAXENQ(MODE) = AS_DFLT.MAXENQ(MODE) ;

  15027  4 003407   200014 235100                    LDA     MODE,,AUTO
         4 003410   000001 735000                    ALS     1
         4 003411   000005 100405                    MLR     fill='000'O
         4 003412   000775 000002 xsym               ADSC9   AS_DFLT+509,A            cn=0,n=2
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:178  
         4 003413   000775 000002 xsym               ADSC9   AS_USERS+509,A           cn=0,n=2

      894    15028    6                     END ;

      895    15029    5               AS_MOD_USER.MAXENQ_A(MODE) = AS_TRUE ;

  15029  4 003414   200014 235100                    LDA     MODE,,AUTO
         4 003415   003005 060400                    CSL     bolr='003'O
         4 003416   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 003417   000021 470001 xsym               BDSC    AS_MOD_USER+17,A         by=2,bit=7,n=1

      896    15030    5               END ;

  15030  4 003420   200011 054100                    AOS     J,,AUTO
         4 003421   200023 236100                    LDQ     SUBS,,AUTO
         4 003422   003332 604000 4                  TMI     s:14980
         4 003423   200011 116100                    CMPQ    J,,AUTO
         4 003424   003332 605000 4                  TPL     s:14980
         4 003425   004447 710000 4                  TRA     LOOP_END

      897    15031        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:179  
      898    15032    4            SELECT( 91  /*  PRIOB_OPT_VAL */ ) ;

      899    15033    4            ERR_CODE = '0'B ;

  15033  4 003426   000000 450000 xsym               STZ     ERR_CODE

      900    15034    4            SUBS = SUBND$ -> P$NODE.SUBNODES - 1 ;

  15034  4 003427   200022 470500                    LDP0    SUBND$,,AUTO
         4 003430   000001 236100                    LDQ     1,,PR0
         4 003431   000022 772000                    QRL     18
         4 003432   000001 136007                    SBLQ    1,DL
         4 003433   200023 756100                    STQ     SUBS,,AUTO

      901    15035    5            DO J = 0 TO SUBS ;

  15035  4 003434   200011 450100                    STZ     J,,AUTO
         4 003435   003566 710000 4                  TRA     s:15096+1

      902    15036    5               P$ = SUBND$ -> P$NODE.SUBLK$(J) ;

  15036  4 003436   200022 470500                    LDP0    SUBND$,,AUTO
         4 003437   200011 720100                    LXL0    J,,AUTO
         4 003440   000003 236110                    LDQ     3,X0,PR0
         4 003441   200016 756100                    STQ     P$,,AUTO

      903    15037    5               MODE = P$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  15037  4 003442   200016 471500                    LDP1    P$,,AUTO
         4 003443   100003 473500                    LDP3    3,,PR1
         4 003444   300000 236100                    LDQ     0,,PR3
         4 003445   777777 376007                    ANQ     -1,DL
         4 003446   200014 756100                    STQ     MODE,,AUTO

      904    15038    5               IF P$->P$NODE.SUBLK$(1)->P$NODE.CODE = 105  /* SIGN_VAL */

  15038  4 003447   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:180  
         4 003450   300000 721100                    LXL1    0,,PR3
         4 003451   000151 101003                    CMPX1   105,DU
         4 003452   003465 601000 4                  TNZ     s:15045

      905    15039    6               THEN DO;

      906    15040    6                  IF P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE = 1
             15040                           /* MINUS_VAL */ OR

  15040  4 003453   300003 474500                    LDP4    3,,PR3
         4 003454   400000 722100                    LXL2    0,,PR4
         4 003455   000001 102003                    CMPX2   1,DU
         4 003456   003461 600000 4                  TZE     s:15042
         4 003457   000000 102003                    CMPX2   0,DU
         4 003460   003467 601000 4                  TNZ     s:15046

      907    15041    6                       P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE = 0
             15041                                /* PLUS_VAL */ THEN
      908    15042    6                     STR$ = P$ -> P$NODE.SUBLK$(2) -> P$NODE.SUBLK$ (0) ;

  15042  4 003461   100005 475500                    LDP5    5,,PR1
         4 003462   500003 236100                    LDQ     3,,PR5
         4 003463   200020 756100                    STQ     STR$,,AUTO

      909    15043    6                  END;

  15043  4 003464   003467 710000 4                  TRA     s:15046

      910    15044    5               ELSE
      911    15045    5                  STR$ = P$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$ (0) ;

  15045  4 003465   300003 236100                    LDQ     3,,PR3
         4 003466   200020 756100                    STQ     STR$,,AUTO

      912    15046    5               CALL CHARBIN( K, VARY$STR.TEXT ) ;

  15046  4 003467   200020 474500                    LDP4    STR$,,AUTO
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:181  
         4 003470   400000 236100                    LDQ     0,,PR4
         4 003471   000033 772000                    QRL     27
         4 003472   000000 622006                    EAX2    0,QL
         4 003473   000100 305540                    DTB
         4 003474   400000 230012                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 003475   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 003476   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 003477   200012 755100                    STA     K,,AUTO

      913    15047    6               IF K > 255 THEN DO ;

  15047  4 003500   000400 115007                    CMPA    256,DL
         4 003501   003507 602000 4                  TNC     s:15069

      914    15048        /*E*  ERROR:    ASC-E$PRIOB_TOO_BIG-C
      915    15049              MESSAGE:  PRIOB value is too big.
      916    15050              MESSAGE1: PRIOB value must be between -255 and 255.
      917    15051        */
      918    15052                       %SCREAM( ERR#=E$PRIOB_TOO_BIG, LEVEL=ERROR, MID='C') ;

  15064  4 003502   000060 630400 5                  EPPR0   48
         4 003503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003504   000000 701000 xent               TSX1    ASH$ERROR
         4 003505   000000 011000                    NOP     0

      919    15067    6                  GOTO LOOP_END ;

  15067  4 003506   004447 710000 4                  TRA     LOOP_END

      920    15068    6                  END ;
      921    15069    5              IF P$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->P$NODE.CODE=1 /* MINUS_VAL */
             15069                        THEN

  15069  4 003507   100004 473500                    LDP3    4,,PR1
         4 003510   300003 475500                    LDP5    3,,PR3
         4 003511   500000 721100                    LXL1    0,,PR5
         4 003512   000001 101003                    CMPX1   1,DU
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:182  
         4 003513   003524 601000 4                  TNZ     s:15072

      922    15070    5                  AS_USERS.PRIOB(MODE) = (-1 * K);

  15070  4 003514   000000 236003                    LDQ     0,DU
         4 003515   200012 136100                    SBLQ    K,,AUTO
         4 003516   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 003517   200014 235100                    LDA     MODE,,AUTO
         4 003520   000005 101500                    MRL     fill='000'O
         4 003521   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 003522   000241 000001 xsym               ADSC9   AS_USERS+161,A           cn=0,n=1
         4 003523   003530 710000 4                  TRA     s:15073

      923    15071    5               ELSE
      924    15072    5                  AS_USERS.PRIOB(MODE) = K ;

  15072  4 003524   200014 236100                    LDQ     MODE,,AUTO
         4 003525   000006 101500                    MRL     fill='000'O
         4 003526   200012 000004                    ADSC9   K,,AUTO                  cn=0,n=4
         4 003527   000241 000001 xsym               ADSC9   AS_USERS+161,Q           cn=0,n=1

      925    15073    5               IF AS_CR_MOD_PROJ > 0 THEN

  15073  4 003530   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003531   003561 604400 4                  TMOZ    s:15095

      926    15074    6                  IF AS_USERS.PRIOB(MODE) > AS_DFLT.PRIOB(MODE) THEN DO ;

  15074  4 003532   200014 236100                    LDQ     MODE,,AUTO
         4 003533   000100 100406                    MLR     fill='000'O
         4 003534   000241 000001 xsym               ADSC9   AS_DFLT+161,Q            cn=0,n=1
         4 003535   200054 000004                    ADSC9   OP_CODE+4,,AUTO          cn=0,n=4
         4 003536   200054 236100                    LDQ     OP_CODE+4,,AUTO
         4 003537   000033 732000                    QRS     27
         4 003540   200055 756100                    STQ     OP_CODE+5,,AUTO
         4 003541   200014 235100                    LDA     MODE,,AUTO
         4 003542   000100 100405                    MLR     fill='000'O
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:183  
         4 003543   000241 000001 xsym               ADSC9   AS_USERS+161,A           cn=0,n=1
         4 003544   200056 000004                    ADSC9   OP_CODE+6,,AUTO          cn=0,n=4
         4 003545   200056 236100                    LDQ     OP_CODE+6,,AUTO
         4 003546   000033 732000                    QRS     27
         4 003547   200055 116100                    CMPQ    OP_CODE+5,,AUTO
         4 003550   003561 604400 4                  TMOZ    s:15095

      927    15075        /*E*  ERROR:  ASC-E$PRIOB_LIMIT-C
      928    15076              MESSAGE: %U1 PRIOB value is too large.  Set to maximum of %U2.
      929    15077        */
      930    15078                          %SCREAM( ERR#=E$PRIOB_LIMIT, LEVEL=ERROR, MID='C');

  15090  4 003551   000061 630400 5                  EPPR0   49
         4 003552   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003553   000000 701000 xent               TSX1    ASH$ERROR
         4 003554   000000 011000                    NOP     0

      931    15093    6                     AS_USERS.PRIOB(MODE) = AS_DFLT.PRIOB(MODE) ;

  15093  4 003555   200014 235100                    LDA     MODE,,AUTO
         4 003556   000005 100405                    MLR     fill='000'O
         4 003557   000241 000001 xsym               ADSC9   AS_DFLT+161,A            cn=0,n=1
         4 003560   000241 000001 xsym               ADSC9   AS_USERS+161,A           cn=0,n=1

      932    15094    6                     END ;

      933    15095    5               AS_MOD_USER.PRIOB_A(MODE) = AS_TRUE ;

  15095  4 003561   200014 235100                    LDA     MODE,,AUTO
         4 003562   003005 060400                    CSL     bolr='003'O
         4 003563   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 003564   000021 620001 xsym               BDSC    AS_MOD_USER+17,A         by=3,bit=2,n=1

      934    15096    5               END ;

  15096  4 003565   200011 054100                    AOS     J,,AUTO
         4 003566   200023 236100                    LDQ     SUBS,,AUTO
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:184  
         4 003567   003436 604000 4                  TMI     s:15036
         4 003570   200011 116100                    CMPQ    J,,AUTO
         4 003571   003436 605000 4                  TPL     s:15036
         4 003572   004447 710000 4                  TRA     LOOP_END

      935    15097        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:185  
      936    15098    4            SELECT(31  /* CM WSN */) ;

      937    15099    4            ERR_CODE.CODE = 0 ;

  15099  4 003573   000004 236000 5                  LDQ     4
         4 003574   000000 356000 xsym               ANSQ    ERR_CODE

      938    15100    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  15100  4 003575   200022 470500                    LDP0    SUBND$,,AUTO
         4 003576   000003 471500                    LDP1    3,,PR0
         4 003577   100003 236100                    LDQ     3,,PR1
         4 003600   200020 756100                    STQ     STR$,,AUTO

      939    15101    4            IF VARY$STR.CNT <= 8

  15101  4 003601   200020 473500                    LDP3    STR$,,AUTO
         4 003602   300000 236100                    LDQ     0,,PR3
         4 003603   777000 376003                    ANQ     -512,DU
         4 003604   011000 116003                    CMPQ    4608,DU
         4 003605   003651 603000 4                  TRC     s:15147

      940    15102    5            THEN DO;

      941    15103    5               KL_DREC.WOO = VARY$STR.TEXT;

  15103  4 003606   300000 236100                    LDQ     0,,PR3
         4 003607   000033 772000                    QRL     27
         4 003610   000000 620006                    EAX0    0,QL
         4 003611   040000 100540                    MLR     fill='040'O
         4 003612   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         4 003613   000007 000010 xsym               ADSC9   KL_DREC+7                cn=0,n=8

      942    15104    5               AS_MOD_USER.WSN = AS_TRUE;

  15104  4 003614   000000 236000 xsym               LDQ     AS_TRUE
         4 003615   000015 772000                    QRL     13
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:186  
         4 003616   000001 676000 xsym               ERQ     AS_MOD_USER+1
         4 003617   000020 376003                    ANQ     16,DU
         4 003620   000001 656000 xsym               ERSQ    AS_MOD_USER+1

      943    15105    5               USERS_KEY.COUNT = 9;

  15105  4 003621   011000 236003                    LDQ     4608,DU
         4 003622   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      944    15106    5               CALL CONCAT( USERS_KEY.TXTC, KL_DREC.WOO, '*' );

  15106  4 003623   040000 100400                    MLR     fill='040'O
         4 003624   000007 000010 xsym               ADSC9   KL_DREC+7                cn=0,n=8
         4 003625   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 003626   040000 100400                    MLR     fill='040'O
         4 003627   000062 000001 5                  ADSC9   50                       cn=0,n=1
         4 003630   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      945    15107    5               CALL ASW$PREC_WSN ALTRET( NO_WSN );

  15107  4 003631   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003632   000000 701000 xent               TSX1    ASW$PREC_WSN
         4 003633   003635 702000 4                  TSX2    NO_WSN

      946    15108    6               DO WHILE( '0'B );

  15108  4 003634   004447 710000 4                  TRA     LOOP_END

      947    15109        /*E*  ERROR:  ASC-E$WSN_DOESNT_EXIST-C
      948    15110              MESSAGE: Warning: the WSN %U1 does not exist.
      949    15111        */
      950    15112    6   NO_WSN:        AS_FIELD1 = VARY$STR;

  15112  4 003635   200020 470500       NO_WSN       LDP0    STR$,,AUTO
         4 003636   000000 236100                    LDQ     0,,PR0
         4 003637   000033 772000                    QRL     27
         4 003640   000001 620006                    EAX0    1,QL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:187  
         4 003641   000000 100540                    MLR     fill='000'O
         4 003642   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 003643   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      951    15113                       %SCREAM(ERR#=E$WSN_DOESNT_EXIST, LEVEL=WARN, MID='C');

  15123  4 003644   000063 630400 5                  EPPR0   51
         4 003645   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003646   000000 701000 xent               TSX1    ASH$WARN
         4 003647   000000 011000                    NOP     0

      952    15128    6                  END;

      953    15129    5               END;

  15129  4 003650   004447 710000 4                  TRA     LOOP_END

      954    15130    5            ELSE DO;

      955    15131        /*E*  ERROR:    ASC-E$WSN_TOO_LONG-C
      956    15132              MESSAGE:  WSN name too long.
      957    15133              MESSAGE1: WSN name can be at most 8 characters long.
      958    15134        */
      959    15135                    %SCREAM( ERR#=E$WSN_TOO_LONG, LEVEL=ERROR, MID='C' );

  15147  4 003651   000064 630400 5                  EPPR0   52
         4 003652   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003653   000000 701000 xent               TSX1    ASH$ERROR
         4 003654   000000 011000                    NOP     0

      960    15150    5               END;

  15150  4 003655   004447 710000 4                  TRA     LOOP_END

      961    15151        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:188  
      962    15152    4            SELECT(32  /* CM HSET */) ;

      963    15153    4            ERR_CODE.CODE = 0 ;

  15153  4 003656   000004 236000 5                  LDQ     4
         4 003657   000000 356000 xsym               ANSQ    ERR_CODE

      964    15154    4            STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  15154  4 003660   200022 470500                    LDP0    SUBND$,,AUTO
         4 003661   000003 471500                    LDP1    3,,PR0
         4 003662   100003 236100                    LDQ     3,,PR1
         4 003663   200020 756100                    STQ     STR$,,AUTO

      965    15155    4            IF VARY$STR.CNT > 6

  15155  4 003664   200020 473500                    LDP3    STR$,,AUTO
         4 003665   300000 236100                    LDQ     0,,PR3
         4 003666   777000 376003                    ANQ     -512,DU
         4 003667   007000 116003                    CMPQ    3584,DU
         4 003670   003676 602000 4                  TNC     s:15178

      966    15156    5            THEN DO;

      967    15157        /*E*  ERROR:    ASC-E$HSET_TOO_LONG-C
      968    15158              MESSAGE:  HSET name too long.
      969    15159              MESSAGE1: HSET name can be at most 6 characters long.
      970    15160        */
      971    15161                    %SCREAM( ERR#=E$HSET_TOO_LONG, LEVEL=ERROR, MID='C' );

  15173  4 003671   000065 630400 5                  EPPR0   53
         4 003672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003673   000000 701000 xent               TSX1    ASH$ERROR
         4 003674   000000 011000                    NOP     0

      972    15176    5               GOTO LOOP_END;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:189  
  15176  4 003675   004447 710000 4                  TRA     LOOP_END

      973    15177    5               END;
      974    15178    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  15178  4 003676   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003677   003767 604400 4                  TMOZ    s:15214

      975    15179    5               PROJ_KEY.TXT.PROJECT = AS_PROJECT_ADMIN.TEXT;

  15179  4 003700   040000 100400                    MLR     fill='040'O
         4 003701   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 003702   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      976    15180    5               PROJ_KEY.TXT.PACKSET = VARY$STR.TEXT;

  15180  4 003703   300000 236100                    LDQ     0,,PR3
         4 003704   000033 772000                    QRL     27
         4 003705   000000 620006                    EAX0    0,QL
         4 003706   040000 100540                    MLR     fill='040'O
         4 003707   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         4 003710   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      977    15181    5               PROJ_KEY.COUNT = 20 + VARY$STR.CNT;

  15181  4 003711   300000 236100                    LDQ     0,,PR3
         4 003712   000033 772000                    QRL     27
         4 003713   000024 036007                    ADLQ    20,DL
         4 003714   000033 736000                    QLS     27
         4 003715   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      978    15182    5               ARS = SIZEC(PROJ_HEADER);

  15182  4 003716   000060 236007                    LDQ     48,DL
         4 003717   200005 756100                    STQ     ARS,,AUTO

      979    15183    5               CALL ASB$READ_PROJ( ADDR(PROJ_HEADER), ARS ) ALTRET(NO_PROJ_REC);
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:190  

  15183  4 003720   200026 631500                    EPPR1   PROJ_HEADER,,AUTO
         4 003721   200054 451500                    STP1    OP_CODE+4,,AUTO
         4 003722   200005 634500                    EPPR4   ARS,,AUTO
         4 003723   200057 454500                    STP4    OP_CODE+7,,AUTO
         4 003724   200054 635500                    EPPR5   OP_CODE+4,,AUTO
         4 003725   200056 455500                    STP5    OP_CODE+6,,AUTO
         4 003726   200056 630500                    EPPR0   OP_CODE+6,,AUTO
         4 003727   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003730   000000 701000 xent               TSX1    ASB$READ_PROJ
         4 003731   003733 702000 4                  TSX2    NO_PROJ_REC

      980    15184    6               IF '0'B THEN DO;

  15184  4 003732   003754 710000 4                  TRA     s:15210

      981    15185        /*E* ERROR:   ASC-E$BAD_HSET-C
      982    15186             MESSAGE: HSET = DP#%U1 is not allowed for a %U2 you create.
      983    15187             MESSAGE1: The packset DP#%U1 was not defined for your project, so you are
      984    15188                       not allowed to specify HSET = DP#%U1 for a %U2 you create.
      985    15189        */
      986    15190    6   NO_PROJ_REC:
      987    15191    6                  AS_FIELD1 = VARY$STR;

  15191  4 003733   200020 470500       NO_PROJ_REC  LDP0    STR$,,AUTO
         4 003734   000000 236100                    LDQ     0,,PR0
         4 003735   000033 772000                    QRL     27
         4 003736   000001 620006                    EAX0    1,QL
         4 003737   000000 100540                    MLR     fill='000'O
         4 003740   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 003741   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      988    15192    6                  AS_FIELD2 = TEXTC(AS_CR_MOD_PROJ-1);

  15192  4 003742   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 003743   000022 402007                    MPY     18,DL
         4 003744   000000 100406                    MLR     fill='000'O
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:191  
         4 003745   777773 400022 3                  ADSC9   ALL_KEYS-19,Q            cn=2,n=18
         4 003746   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      989    15193                       %SCREAM( ERR#=E$BAD_HSET, MID='C', LEVEL=ERROR );

  15205  4 003747   000066 630400 5                  EPPR0   54
         4 003750   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003751   000000 701000 xent               TSX1    ASH$ERROR
         4 003752   000000 011000                    NOP     0

      990    15208    6                  GOTO LOOP_END;

  15208  4 003753   004447 710000 4                  TRA     LOOP_END

      991    15209    6                  END;
      992    15210    5               CALL ASB$ACCT_OK( SUBSTR(CR_MOD_KEY.TEXT,0,8),

  15210  4 003754   000070 237000 5                  LDAQ    56
         4 003755   200056 757100                    STAQ    OP_CODE+6,,AUTO
         4 003756   000072 236000 5                  LDQ     58
         4 003757   200055 756100                    STQ     OP_CODE+5,,AUTO
         4 003760   200003 236100                    LDQ     @CR_MOD_KEY,,AUTO
         4 003761   200000 036007                    ADLQ    65536,DL
         4 003762   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 003763   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 003764   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003765   000000 701000 xent               TSX1    ASB$ACCT_OK
         4 003766   004447 702000 4                  TSX2    LOOP_END

      993    15211    5                    PROJ_KEY.TXT.PACKSET, AS_PROJECT_ADMIN,
      994    15212    5                    AS_TRUE ) ALTRET(LOOP_END);
      995    15213    5               END;

      996    15214    4            KL_DREC.HPS.N = VARY$STR.TEXT;

  15214  4 003767   200020 470500                    LDP0    STR$,,AUTO
         4 003770   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:192  
         4 003771   000033 772000                    QRL     27
         4 003772   000000 620006                    EAX0    0,QL
         4 003773   040000 100540                    MLR     fill='040'O
         4 003774   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         4 003775   000011 000006 xsym               ADSC9   KL_DREC+9                cn=0,n=6

      997    15215    4            AS_USERS.HPSN = VARY$STR.TEXT;

  15215  4 003776   000000 236100                    LDQ     0,,PR0
         4 003777   000033 772000                    QRL     27
         4 004000   000000 620006                    EAX0    0,QL
         4 004001   040000 100540                    MLR     fill='040'O
         4 004002   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         4 004003   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6

      998    15216    4            AS_MOD_USER.HSET = AS_TRUE;

  15216  4 004004   000000 236000 xsym               LDQ     AS_TRUE
         4 004005   000016 772000                    QRL     14
         4 004006   000001 676000 xsym               ERQ     AS_MOD_USER+1
         4 004007   000010 376003                    ANQ     8,DU
         4 004010   000001 656000 xsym               ERSQ    AS_MOD_USER+1
         4 004011   004447 710000 4                  TRA     LOOP_END

      999    15217        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:193  
     1000    15218    4            SELECT(33  /* CM PROFILE */) ;

     1001    15219    4            ERR_CODE.CODE = 0 ;

  15219  4 004012   000004 236000 5                  LDQ     4
         4 004013   000000 356000 xsym               ANSQ    ERR_CODE

     1002    15220    4            IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 7   /*  NONE_VAL  */

  15220  4 004014   200022 470500                    LDP0    SUBND$,,AUTO
         4 004015   000003 471500                    LDP1    3,,PR0
         4 004016   100000 720100                    LXL0    0,,PR1
         4 004017   000007 100003                    CMPX0   7,DU
         4 004020   004034 601000 4                  TNZ     s:15227

     1003    15221    5            THEN DO;

     1004    15222    5               KL_DREC.PNAME.CNT = 0;

  15222  4 004021   000000 236003                    LDQ     0,DU
         4 004022   000004 552040 xsym               STBQ    KL_DREC+4,'40'O

     1005    15223    5               KL_DREC.PNAME.TXT = AS_BLANK;

  15223  4 004023   040000 100400                    MLR     fill='040'O
         4 004024   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 004025   000004 200013 xsym               ADSC9   KL_DREC+4                cn=1,n=11

     1006    15224    5               AS_MOD_USER.PROFILE = AS_TRUE;

  15224  4 004026   000000 236000 xsym               LDQ     AS_TRUE
         4 004027   000017 772000                    QRL     15
         4 004030   000001 676000 xsym               ERQ     AS_MOD_USER+1
         4 004031   000004 376003                    ANQ     4,DU
         4 004032   000001 656000 xsym               ERSQ    AS_MOD_USER+1

     1007    15225    5               END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:194  

  15225  4 004033   004447 710000 4                  TRA     LOOP_END

     1008    15226    5            ELSE DO;

     1009    15227    5               STR$ = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  15227  4 004034   100003 236100                    LDQ     3,,PR1
         4 004035   200020 756100                    STQ     STR$,,AUTO

     1010    15228    5               IF VARY$STR.CNT <= 11

  15228  4 004036   200020 473500                    LDP3    STR$,,AUTO
         4 004037   300000 236100                    LDQ     0,,PR3
         4 004040   777000 376003                    ANQ     -512,DU
         4 004041   014000 116003                    CMPQ    6144,DU
         4 004042   004107 603000 4                  TRC     s:15275

     1011    15229    6               THEN DO;

     1012    15230    6                  KL_DREC.PNAME.TXT = ' ';

  15230  4 004043   040000 100400                    MLR     fill='040'O
         4 004044   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 004045   000004 200013 xsym               ADSC9   KL_DREC+4                cn=1,n=11

     1013    15231    6                  KL_DREC.PNAME.CNT = VARY$STR.CNT;

  15231  4 004046   300000 236100                    LDQ     0,,PR3
         4 004047   000004 552040 xsym               STBQ    KL_DREC+4,'40'O

     1014    15232    6                  KL_DREC.PNAME.TXT = SUBSTR ( VARY$STR.TEXT,0,VARY$STR.CNT);

  15232  4 004050   300000 236100                    LDQ     0,,PR3
         4 004051   000033 772000                    QRL     27
         4 004052   000000 620006                    EAX0    0,QL
         4 004053   040000 100540                    MLR     fill='040'O
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:195  
         4 004054   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         4 004055   000004 200013 xsym               ADSC9   KL_DREC+4                cn=1,n=11

     1015    15233    6                  AS_MOD_USER.PROFILE = %YES#;

  15233  4 004056   000004 236003                    LDQ     4,DU
         4 004057   000001 256000 xsym               ORSQ    AS_MOD_USER+1

     1016    15234    6                  USERS_KEY = VARY$STR ;

  15234  4 004060   300000 236100                    LDQ     0,,PR3
         4 004061   000033 772000                    QRL     27
         4 004062   000001 620006                    EAX0    1,QL
         4 004063   000000 100540                    MLR     fill='000'O
         4 004064   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         4 004065   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1017    15235    6                  CALL ASD$PREC_PRO( USERS_KEY ) ALTRET( NO_PRO );

  15235  4 004066   000073 630400 5                  EPPR0   59
         4 004067   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004070   000000 701000 xent               TSX1    ASD$PREC_PRO
         4 004071   004073 702000 4                  TSX2    NO_PRO

     1018    15236    7                  DO WHILE( '0'B );

  15236  4 004072   004447 710000 4                  TRA     LOOP_END

     1019    15237        /*E*  ERROR:  ASC-E$PRO_DOESNT_EXIST-C
     1020    15238              MESSAGE: Warning: the profile %U1 does not exist.
     1021    15239        */
     1022    15240    7   NO_PRO:           AS_FIELD1 = VARY$STR;

  15240  4 004073   200020 470500       NO_PRO       LDP0    STR$,,AUTO
         4 004074   000000 236100                    LDQ     0,,PR0
         4 004075   000033 772000                    QRL     27
         4 004076   000001 620006                    EAX0    1,QL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:196  
         4 004077   000000 100540                    MLR     fill='000'O
         4 004100   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 004101   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1023    15241                          %SCREAM(ERR#=E$PRO_DOESNT_EXIST, LEVEL=WARN, MID='C');

  15251  4 004102   000074 630400 5                  EPPR0   60
         4 004103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004104   000000 701000 xent               TSX1    ASH$WARN
         4 004105   000000 011000                    NOP     0

     1024    15256    7                     END;

     1025    15257    6                  END;

  15257  4 004106   004447 710000 4                  TRA     LOOP_END

     1026    15258    6               ELSE DO;

     1027    15259        /*E*  ERROR:    ASC-E$PROFILE_TOO_LONG-C
     1028    15260              MESSAGE:  PROFILE name too long.
     1029    15261              MESSAGE1: PROFILE name can be at most 11 characters long.
     1030    15262        */
     1031    15263                       %SCREAM( ERR#=E$PROFILE_TOO_LONG, LEVEL=ERROR, MID='C' );

  15275  4 004107   000075 630400 5                  EPPR0   61
         4 004110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004111   000000 701000 xent               TSX1    ASH$ERROR
         4 004112   000000 011000                    NOP     0

     1032    15278    6                  END;

     1033    15279    5               END;

  15279  4 004113   004447 710000 4                  TRA     LOOP_END

     1034    15280        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:197  
     1035    15281    4            SELECT( 122 /* KEY_OPT_VAL */ ) ;

     1036    15282    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  15282  4 004114   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004115   004123 604400 4                  TMOZ    s:15303

     1037    15283        /*E* ERROR:      ASC-E$CANNOT_CHG_KEY-C
     1038    15284             MESSAGE:    Project Administrator cannot change user's KEY.
     1039    15285        */
     1040    15286                    %SCREAM (ERR#=E$CANNOT_CHG_KEY, LEVEL=ERROR,MID='C');

  15298  4 004116   000076 630400 5                  EPPR0   62
         4 004117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004120   000000 701000 xent               TSX1    ASH$ERROR
         4 004121   000000 011000                    NOP     0

     1041    15301    5               GOTO LOOP_END ;

  15301  4 004122   004447 710000 4                  TRA     LOOP_END

     1042    15302    5               END;
     1043    15303    4            PTR$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  15303  4 004123   100003 236100                    LDQ     3,,PR1
         4 004124   200017 756100                    STQ     PTR$,,AUTO

     1044    15304    4            CODE = PTR$ -> P$NODE.CODE ;

  15304  4 004125   200017 473500                    LDP3    PTR$,,AUTO
         4 004126   300000 236100                    LDQ     0,,PR3
         4 004127   777777 376007                    ANQ     -1,DL
         4 004130   000000 756000 xsym               STQ     CODE

     1045    15305    5            DO SELECT( CODE );

  15305  4 004131   000007 116007                    CMPQ    7,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:198  
         4 004132   004135 602000 4                  TNC     s:15305+4
         4 004133   004140 600000 4                  TZE     s:15307
         4 004134   004221 710000 4                  TRA     s:15346
         4 004135   000006 116007                    CMPQ    6,DL
         4 004136   004221 601000 4                  TNZ     s:15346
         4 004137   004160 710000 4                  TRA     s:15314

     1046    15306    5               SELECT( 7   /*  NONE_VAL  */ );

     1047    15307    5               ADDR(AS_USERS.KEY) -> BIT$72 = '0'B;

  15307  4 004140   000026 450000 xsym               STZ     AS_USERS+22
         4 004141   000027 450000 xsym               STZ     AS_USERS+23

     1048    15308    6               IF AS_WILD_USER THEN DO;

  15308  4 004142   000000 234000 xsym               SZN     AS_WILD_USER
         4 004143   004447 605000 4                  TPL     LOOP_END

     1049    15309    7                  DO K = 0 TO 71;

  15309  4 004144   200012 450100                    STZ     K,,AUTO

     1050    15310    7                     AS_MOD_USER.KEY_A(K) = 2   /*  NO_VAL  */;

  15310  4 004145   200012 235100                    LDA     K,,AUTO
         4 004146   000001 735000                    ALS     1
         4 004147   003005 061400                    CSR     bolr='003'O
         4 004150   000004 000044 xsym               BDSC    B_VECTNIL+4              by=0,bit=0,n=36
         4 004151   000024 220002 xsym               BDSC    AS_MOD_USER+20,A         by=1,bit=2,n=2

     1051    15311    7                     END;

  15311  4 004152   200012 236100                    LDQ     K,,AUTO
         4 004153   000001 036007                    ADLQ    1,DL
         4 004154   200012 756100                    STQ     K,,AUTO
         4 004155   000110 116007                    CMPQ    72,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:199  
         4 004156   004145 602000 4                  TNC     s:15310

     1052    15312    6                  END;

  15312  4 004157   004447 710000 4                  TRA     LOOP_END

     1053    15313    5               SELECT( 6   /*  ALL_VAL  */ );

     1054    15314    5               IF AS_CR_MOD_PROJ > 0  AND AS_DFLT.KEY ~= ALL_KEYS

  15314  4 004160   000000 115003                    CMPA    0,DU
         4 004161   004200 604400 4                  TMOZ    s:15339
         4 004162   000000 106400                    CMPC    fill='000'O
         4 004163   000026 000010 xsym               ADSC9   AS_DFLT+22               cn=0,n=8
         4 004164   000016 000010 3                  ADSC9   ALL_KEYS                 cn=0,n=8
         4 004165   004200 600000 4                  TZE     s:15339

     1055    15315    6               THEN DO;

     1056    15316        /*E* ERROR:   ASA-E$ALL_KEY_ILLEGAL-C
     1057    15317             MESSAGE: You are not allowed to specify KEY = ALL for a %U1 you create.
     1058    15318             MESSAGE1: KEY = ALL was not specified for your project so you are not
     1059    15319                       allowed to specify KEY = ALL for a %U1 you create.
     1060    15320        */
     1061    15321    6                  AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  15321  4 004166   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 004167   000022 402007                    MPY     18,DL
         4 004170   000000 100406                    MLR     fill='000'O
         4 004171   777773 400022 3                  ADSC9   ALL_KEYS-19,Q            cn=2,n=18
         4 004172   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1062    15322                       %SCREAM( ERR#=E$ALL_KEY_ILLEGAL, LEVEL=ERROR,MID='C');

  15334  4 004173   000077 630400 5                  EPPR0   63
         4 004174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004175   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:200  
         4 004176   000000 011000                    NOP     0

     1063    15337    6                  GOTO LOOP_END;

  15337  4 004177   004447 710000 4                  TRA     LOOP_END

     1064    15338    6                  END;
     1065    15339    5               ADDR(AS_USERS.KEY) -> BIT$72 = ALL_KEYS;

  15339  4 004200   000016 237000 3                  LDAQ    ALL_KEYS
         4 004201   000026 755000 xsym               STA     AS_USERS+22
         4 004202   000027 756000 xsym               STQ     AS_USERS+23

     1066    15340    6               IF AS_WILD_USER THEN DO;

  15340  4 004203   000000 234000 xsym               SZN     AS_WILD_USER
         4 004204   004447 605000 4                  TPL     LOOP_END

     1067    15341    7                  DO K = 0 TO 71;

  15341  4 004205   200012 450100                    STZ     K,,AUTO

     1068    15342    7                     AS_MOD_USER.KEY_A(K) = 1   /*  YES_VAL  */;

  15342  4 004206   200012 235100                    LDA     K,,AUTO
         4 004207   000001 735000                    ALS     1
         4 004210   003005 061400                    CSR     bolr='003'O
         4 004211   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         4 004212   000024 220002 xsym               BDSC    AS_MOD_USER+20,A         by=1,bit=2,n=2

     1069    15343    7                     END;

  15343  4 004213   200012 236100                    LDQ     K,,AUTO
         4 004214   000001 036007                    ADLQ    1,DL
         4 004215   200012 756100                    STQ     K,,AUTO
         4 004216   000110 116007                    CMPQ    72,DL
         4 004217   004206 602000 4                  TNC     s:15342
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:201  

     1070    15344    6                  END;

  15344  4 004220   004447 710000 4                  TRA     LOOP_END

     1071    15345    5               SELECT( ELSE );

     1072    15346    5            SUBS = PTR$ -> P$NODE.SUBNODES - 1;

  15346  4 004221   300001 236100                    LDQ     1,,PR3
         4 004222   000022 772000                    QRL     18
         4 004223   000001 136007                    SBLQ    1,DL
         4 004224   200023 756100                    STQ     SUBS,,AUTO

     1073    15347    6            DO J = 0 TO SUBS;

  15347  4 004225   200011 450100                    STZ     J,,AUTO
         4 004226   004353 710000 4                  TRA     s:15437+1

     1074    15348    6               STR$ = PTR$->P$NODE.SUBLK$(J)->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0);

  15348  4 004227   200017 470500                    LDP0    PTR$,,AUTO
         4 004230   200011 720100                    LXL0    J,,AUTO
         4 004231   000003 471510                    LDP1    3,X0,PR0
         4 004232   100003 473500                    LDP3    3,,PR1
         4 004233   300003 236100                    LDQ     3,,PR3
         4 004234   200020 756100                    STQ     STR$,,AUTO

     1075    15349    6               CALL CHARBIN( MODE, VARY$STR.TEXT );

  15349  4 004235   200020 474500                    LDP4    STR$,,AUTO
         4 004236   400000 236100                    LDQ     0,,PR4
         4 004237   000033 772000                    QRL     27
         4 004240   000000 621006                    EAX1    0,QL
         4 004241   000100 305540                    DTB
         4 004242   400000 230011                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X1
         4 004243   200054 000010                    NDSC9   OP_CODE+4,,AUTO          cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:202  
         4 004244   200055 235100                    LDA     OP_CODE+5,,AUTO
         4 004245   200014 755100                    STA     MODE,,AUTO

     1076    15350    7               IF MODE < 1 OR MODE > 72 THEN DO;

  15350  4 004246   004251 600000 4                  TZE     s:15355
         4 004247   000111 115007                    CMPA    73,DL
         4 004250   004264 602000 4                  TNC     s:15373

     1077    15351        /*E* ERROR:   ASC-E$ILLEGAL_KEY_VAL-C
     1078    15352             MESSAGE: %U1 is an illegal KEY value.
     1079    15353             MESSAGE1: A KEY must be a number between 1 and 72.
     1080    15354        */
     1081    15355    7                  AS_FIELD1 = VARY$STR ;

  15355  4 004251   400000 236100                    LDQ     0,,PR4
         4 004252   000033 772000                    QRL     27
         4 004253   000001 621006                    EAX1    1,QL
         4 004254   000000 100540                    MLR     fill='000'O
         4 004255   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         4 004256   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1082    15356                       %SCREAM( ERR#=E$ILLEGAL_KEY_VAL, LEVEL=ERROR, MID='C' );

  15368  4 004257   000100 630400 5                  EPPR0   64
         4 004260   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004261   000000 701000 xent               TSX1    ASH$ERROR
         4 004262   000000 011000                    NOP     0

     1083    15371    7                  GOTO LOOP_END;

  15371  4 004263   004447 710000 4                  TRA     LOOP_END

     1084    15372    7                  END;
     1085    15373    6               IF PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBNODES = 1

  15373  4 004264   000003 471510                    LDP1    3,X0,PR0
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:203  
         4 004265   100001 221100                    LDX1    1,,PR1
         4 004266   000001 101003                    CMPX1   1,DU
         4 004267   004273 601000 4                  TNZ     s:15377

     1086    15374    6               THEN
     1087    15375    6                  K = 1   /*  YES_VAL  */;

  15375  4 004270   000001 236007                    LDQ     1,DL
         4 004271   200012 756100                    STQ     K,,AUTO
         4 004272   004277 710000 4                  TRA     s:15379

     1088    15376    6               ELSE
     1089    15377    6                  K = PTR$ -> P$NODE.SUBLK$(J)

  15377  4 004273   100004 473500                    LDP3    4,,PR1
         4 004274   300000 236100                    LDQ     0,,PR3
         4 004275   777777 376007                    ANQ     -1,DL
         4 004276   200012 756100                    STQ     K,,AUTO

     1090    15378    6                       -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;
     1091    15379    6               IF AS_CR_MOD_PROJ > 0  AND  K = 1   /*  YES_VAL  */

  15379  4 004277   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004300   004334 604400 4                  TMOZ    s:15435
         4 004301   000001 116007                    CMPQ    1,DL
         4 004302   004334 601000 4                  TNZ     s:15435
         4 004303   200014 235100                    LDA     MODE,,AUTO
         4 004304   000000 066405                    CMPB    filb='0'B
         4 004305   000025 700001 xsym               BDSC    AS_DFLT+21,A             by=3,bit=8,n=1
         4 004306   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 004307   004334 601000 4                  TNZ     s:15435

     1092    15380    6                    AND  NOT (AS_DFLT.KEY(MODE-1))
     1093    15381    7               THEN DO;

     1094    15382        /*E* ERROR:   ASA-E$KEY_NOT_ALLOWED-C
     1095    15383             MESSAGE: You are not allowed to specify KEY = %U1.
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:204  
     1096    15384             MESSAGE1: KEY = %U1 was not specified for your project, so you are not
     1097    15385                       allowed to specify KEY = %U1 for a %U2 you create.
     1098    15386        */
     1099    15387                       %NUMBER( NUM1=K );
             15395    7         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, K );

  15395  4 004310   200012 631500                    EPPR1   K,,AUTO
         4 004311   200057 451500                    STP1    OP_CODE+7,,AUTO
         4 004312   000013 236000 5                  LDQ     11
         4 004313   200056 756100                    STQ     OP_CODE+6,,AUTO
         4 004314   000026 237000 5                  LDAQ    22
         4 004315   200054 757100                    STAQ    OP_CODE+4,,AUTO
         4 004316   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 004317   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004320   000000 701000 xent               TSX1    ASB$BINCHAR
         4 004321   000000 011000                    NOP     0

     1100    15417    7                  AS_FIELD2 = TEXTC(AS_CR_MOD_PROJ-1);

  15417  4 004322   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 004323   000022 402007                    MPY     18,DL
         4 004324   000000 100406                    MLR     fill='000'O
         4 004325   777773 400022 3                  ADSC9   ALL_KEYS-19,Q            cn=2,n=18
         4 004326   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

     1101    15418                       %SCREAM( ERR#=E$KEY_NOT_ALLOWED, MID='C',LEVEL=ERROR);

  15430  4 004327   000101 630400 5                  EPPR0   65
         4 004330   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004331   000000 701000 xent               TSX1    ASH$ERROR
         4 004332   000000 011000                    NOP     0

     1102    15433    7                  GOTO LOOP_END;

  15433  4 004333   004447 710000 4                  TRA     LOOP_END

     1103    15434    7                  END;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:205  
     1104    15435    6               AS_USERS.KEY(MODE-1) = ( K = 1   /*  YES_VAL  */ ) ;

  15435  4 004334   400000 221003                    LDX1    -131072,DU
         4 004335   000001 116007                    CMPQ    1,DL
         4 004336   004340 600000 4                  TZE     s:15435+4
         4 004337   000000 221003                    LDX1    0,DU
         4 004340   000000 636011                    EAQ     0,X1
         4 004341   200054 756100                    STQ     OP_CODE+4,,AUTO
         4 004342   200014 235100                    LDA     MODE,,AUTO
         4 004343   003005 060500                    CSL     bolr='003'O
         4 004344   200054 000044                    BDSC    OP_CODE+4,,AUTO          by=0,bit=0,n=36
         4 004345   000025 700001 xsym               BDSC    AS_USERS+21,A            by=3,bit=8,n=1

     1105    15436    6               AS_MOD_USER.KEY_A(MODE-1) = K;

  15436  4 004346   000001 735000                    ALS     1
         4 004347   003005 061500                    CSR     bolr='003'O
         4 004350   200012 000044                    BDSC    K,,AUTO                  by=0,bit=0,n=36
         4 004351   000024 200002 xsym               BDSC    AS_MOD_USER+20,A         by=1,bit=0,n=2

     1106    15437    6               END;

  15437  4 004352   200011 054100                    AOS     J,,AUTO
         4 004353   200023 236100                    LDQ     SUBS,,AUTO
         4 004354   004227 604000 4                  TMI     s:15348
         4 004355   200011 116100                    CMPQ    J,,AUTO
         4 004356   004227 605000 4                  TPL     s:15348

     1107    15438    5               END;

  15438  4 004357   004447 710000 4                  TRA     LOOP_END

     1108    15439        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:206  
     1109    15440                                                              /**/
     1110    15441    4         SELECT( 34 /* OUTPUTPRIO OPTION */ ) ;

     1111    15442    4         CALL ASC$OUTPUTPRIO( SUBND$ );

  15442  4 004360   200022 630500                    EPPR0   SUBND$,,AUTO
         4 004361   200054 450500                    STP0    OP_CODE+4,,AUTO
         4 004362   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 004363   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004364   000000 701000 xent               TSX1    ASC$OUTPUTPRIO
         4 004365   000000 011000                    NOP     0
         4 004366   004447 710000 4                  TRA     LOOP_END

     1112    15443
     1113    15444                                                              /**/
     1114    15445    4         SELECT( 114 /* ACCESS_OPT */ ) ;

     1115    15446    4         ERR_CODE = '0'B ;

  15446  4 004367   000000 450000 xsym               STZ     ERR_CODE

     1116    15447    4         CALL ACCESS_OPT ;

  15447  4 004370   004462 701000 4                  TSX1    ACCESS_OPT
         4 004371   000000 011000                    NOP     0
         4 004372   004447 710000 4                  TRA     LOOP_END

     1117    15448                                                              /**/
     1118    15449    4         SELECT( 115  /* PSEUDO_OPT */ ) ;

     1119    15450    4         ERR_CODE.CODE = 0 ;

  15450  4 004373   000004 236000 5                  LDQ     4
         4 004374   000000 356000 xsym               ANSQ    ERR_CODE

     1120    15451    4         CALL ASC$PSEUDO( AS_FALSE );

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:207  
  15451  4 004375   000102 630400 5                  EPPR0   66
         4 004376   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004377   000000 701000 xent               TSX1    ASC$PSEUDO
         4 004400   000000 011000                    NOP     0
         4 004401   004447 710000 4                  TRA     LOOP_END

     1121    15452                                                              /**/
     1122    15453    4         SELECT( 92  /*  FEPSEUDO_OPT_VAL */ ) ;

     1123    15454    4         ERR_CODE.CODE = 0 ;

  15454  4 004402   000004 236000 5                  LDQ     4
         4 004403   000000 356000 xsym               ANSQ    ERR_CODE

     1124    15455    4         CALL ASC$FEPSEUDO( AS_FALSE );

  15455  4 004404   000102 630400 5                  EPPR0   66
         4 004405   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004406   000000 701000 xent               TSX1    ASC$FEPSEUDO
         4 004407   000000 011000                    NOP     0
         4 004410   004447 710000 4                  TRA     LOOP_END

     1125    15456    4         SELECT( 57 /* SERVICE_OPT */ ) ;

     1126    15457    4         ERR_CODE = '0'B ;

  15457  4 004411   000000 450000 xsym               STZ     ERR_CODE

     1127    15458    4         CALL ASC$SERVICE ;

  15458  4 004412   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 004413   000000 701000 xent               TSX1    ASC$SERVICE
         4 004414   000000 011000                    NOP     0
         4 004415   004447 710000 4                  TRA     LOOP_END

     1128    15459                                                              /**/
     1129    15460    4         SELECT( 116 /* RESOURCE_OPT */ ) ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:208  

     1130    15461    4         ERR_CODE = '0'B ;

  15461  4 004416   000000 450000 xsym               STZ     ERR_CODE

     1131    15462    4         CALL ASC$RESOURCE( AS_FALSE );

  15462  4 004417   000102 630400 5                  EPPR0   66
         4 004420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004421   000000 701000 xent               TSX1    ASC$RESOURCE
         4 004422   000000 011000                    NOP     0
         4 004423   004447 710000 4                  TRA     LOOP_END

     1132    15463                                                              /**/
     1133    15464    4         SELECT( 117 /* TIME_OPT */ );

     1134    15465    4         CALL ASC$TIME( SUBND$ );

  15465  4 004424   200022 630500                    EPPR0   SUBND$,,AUTO
         4 004425   200054 450500                    STP0    OP_CODE+4,,AUTO
         4 004426   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 004427   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004430   000000 701000 xent               TSX1    ASC$TIME
         4 004431   000000 011000                    NOP     0
         4 004432   004447 710000 4                  TRA     LOOP_END

     1135    15466
     1136    15467    4         SELECT( 118 /* MEMORY_OPT */ );

     1137    15468    4         CALL ASC$MEMORY( SUBND$ );

  15468  4 004433   200022 630500                    EPPR0   SUBND$,,AUTO
         4 004434   200054 450500                    STP0    OP_CODE+4,,AUTO
         4 004435   200054 630500                    EPPR0   OP_CODE+4,,AUTO
         4 004436   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004437   000000 701000 xent               TSX1    ASC$MEMORY
         4 004440   000000 011000                    NOP     0
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:209  
         4 004441   004447 710000 4                  TRA     LOOP_END

     1138    15469
     1139    15470    4         SELECT( 126 /* FERESOURCE_OPT */ ) ;

     1140    15471    4         ERR_CODE = '0'B ;

  15471  4 004442   000000 450000 xsym               STZ     ERR_CODE

     1141    15472    4         CALL ASC$FERESOURCE( AS_FALSE );

  15472  4 004443   000102 630400 5                  EPPR0   66
         4 004444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004445   000000 701000 xent               TSX1    ASC$FERESOURCE
         4 004446   000000 011000                    NOP     0

     1142    15473                                                              /**/
     1143    15474                                                              /**/
     1144    15475    4            END ;   /* Do case(code) */

  15461  4 004447                       LOOP_END     null
     1145    15476    3   LOOP_END: ;
     1146    15477    3         END ; /* Do i */

  15477  4 004447   200010 054100                    AOS     I,,AUTO
         4 004450   200010 236100                    LDQ     I,,AUTO
         4 004451   200021 116100                    CMPQ    SUBNODES,,AUTO
         4 004452   000054 604000 4                  TMI     s:13785

     1147    15478    2      END ; /* Do while(more) */

  15478  4 004453   000014 234000 2                  SZN     MORE
         4 004454   000014 604000 4                  TMI     s:13770

  15465  4 004455                       OPTION_ERR   null
     1148    15479        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:210  
     1149    15480    1   OPTION_ERR: ;
     1150    15481    1   CALL ASH$ERROR( P_PCB.ERROR );

  15481  4 004455   000103 630400 5                  EPPR0   67
         4 004456   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004457   000000 701000 xent               TSX1    ASH$ERROR
         4 004460   000000 011000                    NOP     0

     1151    15482    1   GOTO CM_LOOP ;

  15482  4 004461   000010 710000 4                  TRA     CM_LOOP

     1152    15483                                                              /**/
     1153    15484        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:211  
     1154    15485    1   ACCESS_OPT: PROC ;

  15485  4 004462   200042 741300       ACCESS_OPT   STX1  ! PROJ_HEADER+12,,AUTO

     1155    15486                                                              /**/
     1156    15487                                                              /**/
     1157    15488        /********************************************************************/
     1158    15489        /*   Auto data       auto data       auto data       auto data       */
     1159    15490        /*********************************************************************/
     1160    15491                                                              /**/
     1161    15492    2   DCL SUBS UBIN WORD ;
     1162    15493    2   DCL PTR$ PTR ;
     1163    15494    2   DCL I UBIN WORD ;
     1164    15495    2   DCL MODE UBIN WORD ;
     1165    15496    2   DCL PTR2$ PTR ;
     1166    15497    2   DCL OP_CODE UBIN WORD ;
     1167    15498        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:212  
     1168    15499        /********************************************************************/
     1169    15500        /*   Procedure       procedure       procedure       procedure       */
     1170    15501        /*********************************************************************/
     1171    15502                                                              /**/
     1172    15503        /*
     1173    15504            ***            Begin procedure                    ***
     1174    15505        */
     1175    15506    2   SUBS = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBNODES ;

  15506  4 004463   200022 470500                    LDP0    SUBND$,,AUTO
         4 004464   000003 471500                    LDP1    3,,PR0
         4 004465   100001 236100                    LDQ     1,,PR1
         4 004466   000022 772000                    QRL     18
         4 004467   200043 756100                    STQ     SUBS,,AUTO

     1176    15507    2   PTR$ = SUBND$ -> P$NODE.SUBLK$(0) ;

  15507  4 004470   000003 236100                    LDQ     3,,PR0
         4 004471   200044 756100                    STQ     PTR$,,AUTO

     1177    15508                                                                   /**/
     1178    15509    3   DO I = 0 TO SUBS-1 ;

  15509  4 004472   200045 450100                    STZ     I,,AUTO
         4 004473   005006 710000 4                  TRA     s:15602+3

     1179    15510    3      PTR2$ = PTR$ -> P$NODE.SUBLK$(I) ;

  15510  4 004474   200044 470500                    LDP0    PTR$,,AUTO
         4 004475   200045 720100                    LXL0    I,,AUTO
         4 004476   000003 236110                    LDQ     3,X0,PR0
         4 004477   200047 756100                    STQ     PTR2$,,AUTO

     1180    15511    3      MODE = PTR2$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  15511  4 004500   200047 471500                    LDP1    PTR2$,,AUTO
         4 004501   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:213  
         4 004502   300000 236100                    LDQ     0,,PR3
         4 004503   777777 376007                    ANQ     -1,DL
         4 004504   200046 756100                    STQ     MODE,,AUTO

     1181    15512    3      IF PTR2$ -> P$NODE.SUBNODES = 1

  15512  4 004505   100001 221100                    LDX1    1,,PR1
         4 004506   000001 101003                    CMPX1   1,DU
         4 004507   004513 601000 4                  TNZ     s:15516

     1182    15513    3      THEN
     1183    15514    3         OP_CODE = 1   /*  YES_VAL  */ ;

  15514  4 004510   000001 235007                    LDA     1,DL
         4 004511   200050 755100                    STA     OP_CODE,,AUTO
         4 004512   004517 710000 4                  TRA     s:15517

     1184    15515    3      ELSE
     1185    15516    3         OP_CODE = PTR2$ -> P$NODE.SUBLK$(1) -> P$NODE.CODE ;

  15516  4 004513   100004 474500                    LDP4    4,,PR1
         4 004514   400000 236100                    LDQ     0,,PR4
         4 004515   777777 376007                    ANQ     -1,DL
         4 004516   200050 756100                    STQ     OP_CODE,,AUTO

     1186    15517    4      DO SELECT( MODE ) ;

  15517  4 004517   200046 236100                    LDQ     MODE,,AUTO
         4 004520   000001 116007                    CMPQ    1,DL
         4 004521   004534 602000 4                  TNC     s:15517+13
         4 004522   004647 600000 4                  TZE     s:15555
         4 004523   000003 116007                    CMPQ    3,DL
         4 004524   004531 602000 4                  TNC     s:15517+10
         4 004525   004706 600000 4                  TZE     s:15571
         4 004526   000004 116007                    CMPQ    4,DL
         4 004527   005003 601000 4                  TNZ     s:15602
         4 004530   004745 710000 4                  TRA     s:15587
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:214  
         4 004531   000002 116007                    CMPQ    2,DL
         4 004532   005003 601000 4                  TNZ     s:15602
         4 004533   004610 710000 4                  TRA     s:15539
         4 004534   000000 116003                    CMPQ    0,DU
         4 004535   004537 600000 4                  TZE     s:15520
         4 004536   005003 710000 4                  TRA     s:15602

     1187    15518                                                              /**/
     1188    15519    4         SELECT( 0   /*  AS_M_BATCH#   */ ) ;

     1189    15520    4         IF OP_CODE = 1   /*  YES_VAL  */

  15520  4 004537   200050 235100                    LDA     OP_CODE,,AUTO
         4 004540   000001 115007                    CMPA    1,DL
         4 004541   004571 601000 4                  TNZ     s:15532

     1190    15521    5         THEN DO;

     1191    15522    5            IF AS_CR_MOD_PROJ > 0  AND  NOT AS_DFLT.BATOK

  15522  4 004542   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004543   004552 604400 4                  TMOZ    s:15526
         4 004544   000005 236000 xsym               LDQ     AS_DFLT+5
         4 004545   000200 316003                    CANQ    128,DU
         4 004546   004552 601000 4                  TNZ     s:15526

     1192    15523    5            THEN
     1193    15524    5               CALL ACCESS_ERROR;

  15524  4 004547   005013 701000 4                  TSX1    ACCESS_ERROR
         4 004550   000000 011000                    NOP     0
         4 004551   005003 710000 4                  TRA     s:15602

     1194    15525    6            ELSE DO;

     1195    15526    6               KL_DREC.FLAGS.BATOK = AS_TRUE ;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:215  
  15526  4 004552   000000 236000 xsym               LDQ     AS_TRUE
         4 004553   000014 772000                    QRL     12
         4 004554   000000 676000 xsym               ERQ     KL_DREC
         4 004555   000040 376003                    ANQ     32,DU
         4 004556   000000 656000 xsym               ERSQ    KL_DREC

     1196    15527    6               AS_USERS.BATOK = AS_TRUE ;

  15527  4 004557   000000 236000 xsym               LDQ     AS_TRUE
         4 004560   000012 772000                    QRL     10
         4 004561   000005 676000 xsym               ERQ     AS_USERS+5
         4 004562   000200 376003                    ANQ     128,DU
         4 004563   000005 656000 xsym               ERSQ    AS_USERS+5

     1197    15528    6               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;

  15528  4 004564   200046 236100                    LDQ     MODE,,AUTO
         4 004565   003006 060400                    CSL     bolr='003'O
         4 004566   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004567   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1198    15529    6               END;

     1199    15530    5            END ; /* Then do */

  15530  4 004570   005003 710000 4                  TRA     s:15602

     1200    15531    5         ELSE DO;

     1201    15532    5            KL_DREC.FLAGS.BATOK = AS_FALSE ;

  15532  4 004571   000000 236000 xsym               LDQ     AS_FALSE
         4 004572   000014 772000                    QRL     12
         4 004573   000000 676000 xsym               ERQ     KL_DREC
         4 004574   000040 376003                    ANQ     32,DU
         4 004575   000000 656000 xsym               ERSQ    KL_DREC

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:216  
     1202    15533    5            AS_USERS.BATOK = AS_FALSE ;

  15533  4 004576   000000 236000 xsym               LDQ     AS_FALSE
         4 004577   000012 772000                    QRL     10
         4 004600   000005 676000 xsym               ERQ     AS_USERS+5
         4 004601   000200 376003                    ANQ     128,DU
         4 004602   000005 656000 xsym               ERSQ    AS_USERS+5

     1203    15534    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;

  15534  4 004603   200046 236100                    LDQ     MODE,,AUTO
         4 004604   003006 060400                    CSL     bolr='003'O
         4 004605   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004606   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1204    15535    5            END ; /* Else do */

  15535  4 004607   005003 710000 4                  TRA     s:15602

     1205    15536                                                              /**/
     1206    15537    4         SELECT( 2     /*  AS_M_INT#     */ ) ;

     1207    15538                                                              /**/
     1208    15539    4         IF OP_CODE = 1   /*  YES_VAL  */

  15539  4 004610   200050 235100                    LDA     OP_CODE,,AUTO
         4 004611   000001 115007                    CMPA    1,DL
         4 004612   004635 601000 4                  TNZ     s:15549

     1209    15540    4         THEN
     1210    15541    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.OLOK

  15541  4 004613   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004614   004623 604400 4                  TMOZ    s:15545
         4 004615   000000 236000 xsym               LDQ     KL_DFLT
         4 004616   000100 316003                    CANQ    64,DU
         4 004617   004623 601000 4                  TNZ     s:15545
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:217  

     1211    15542    4            THEN
     1212    15543    4               CALL ACCESS_ERROR;

  15543  4 004620   005013 701000 4                  TSX1    ACCESS_ERROR
         4 004621   000000 011000                    NOP     0
         4 004622   005003 710000 4                  TRA     s:15602

     1213    15544    5            ELSE DO;

     1214    15545    5               KL_DREC.FLAGS.OLOK = AS_TRUE ;

  15545  4 004623   000000 236000 xsym               LDQ     AS_TRUE
         4 004624   000013 772000                    QRL     11
         4 004625   000000 676000 xsym               ERQ     KL_DREC
         4 004626   000100 376003                    ANQ     64,DU
         4 004627   000000 656000 xsym               ERSQ    KL_DREC

     1215    15546    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;

  15546  4 004630   200046 236100                    LDQ     MODE,,AUTO
         4 004631   003006 060400                    CSL     bolr='003'O
         4 004632   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004633   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1216    15547    5               END;

  15547  4 004634   005003 710000 4                  TRA     s:15602

     1217    15548    5         ELSE DO;

     1218    15549    5            KL_DREC.FLAGS.OLOK = AS_FALSE ;

  15549  4 004635   000000 236000 xsym               LDQ     AS_FALSE
         4 004636   000013 772000                    QRL     11
         4 004637   000000 676000 xsym               ERQ     KL_DREC
         4 004640   000100 376003                    ANQ     64,DU
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:218  
         4 004641   000000 656000 xsym               ERSQ    KL_DREC

     1219    15550    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;

  15550  4 004642   200046 236100                    LDQ     MODE,,AUTO
         4 004643   003006 060400                    CSL     bolr='003'O
         4 004644   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004645   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1220    15551    5            END;

  15551  4 004646   005003 710000 4                  TRA     s:15602

     1221    15552                                                              /**/
     1222    15553    4         SELECT( 1   /*  AS_M_GHOST#   */ ) ;

     1223    15554                                                              /**/
     1224    15555    4         IF OP_CODE = 1   /*  YES_VAL  */

  15555  4 004647   200050 235100                    LDA     OP_CODE,,AUTO
         4 004650   000001 115007                    CMPA    1,DL
         4 004651   004674 601000 4                  TNZ     s:15565

     1225    15556    4         THEN
     1226    15557    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.GHOSTOK

  15557  4 004652   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004653   004662 604400 4                  TMOZ    s:15561
         4 004654   000000 236000 xsym               LDQ     KL_DFLT
         4 004655   000200 316003                    CANQ    128,DU
         4 004656   004662 601000 4                  TNZ     s:15561

     1227    15558    4            THEN
     1228    15559    4               CALL ACCESS_ERROR;

  15559  4 004657   005013 701000 4                  TSX1    ACCESS_ERROR
         4 004660   000000 011000                    NOP     0
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:219  
         4 004661   005003 710000 4                  TRA     s:15602

     1229    15560    5            ELSE DO;

     1230    15561    5               KL_DREC.FLAGS.GHOSTOK = AS_TRUE ;

  15561  4 004662   000000 236000 xsym               LDQ     AS_TRUE
         4 004663   000012 772000                    QRL     10
         4 004664   000000 676000 xsym               ERQ     KL_DREC
         4 004665   000200 376003                    ANQ     128,DU
         4 004666   000000 656000 xsym               ERSQ    KL_DREC

     1231    15562    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;

  15562  4 004667   200046 236100                    LDQ     MODE,,AUTO
         4 004670   003006 060400                    CSL     bolr='003'O
         4 004671   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004672   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1232    15563    5               END;

  15563  4 004673   005003 710000 4                  TRA     s:15602

     1233    15564    5         ELSE DO;

     1234    15565    5            KL_DREC.FLAGS.GHOSTOK = AS_FALSE ;

  15565  4 004674   000000 236000 xsym               LDQ     AS_FALSE
         4 004675   000012 772000                    QRL     10
         4 004676   000000 676000 xsym               ERQ     KL_DREC
         4 004677   000200 376003                    ANQ     128,DU
         4 004700   000000 656000 xsym               ERSQ    KL_DREC

     1235    15566    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;

  15566  4 004701   200046 236100                    LDQ     MODE,,AUTO
         4 004702   003006 060400                    CSL     bolr='003'O
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:220  
         4 004703   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004704   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1236    15567    5            END ;

  15567  4 004705   005003 710000 4                  TRA     s:15602

     1237    15568                                                              /**/
     1238    15569    4         SELECT( 3 /* AS_M_TP# */ ) ;

     1239    15570                                                              /**/
     1240    15571    4         IF OP_CODE = 1   /*  YES_VAL  */

  15571  4 004706   200050 235100                    LDA     OP_CODE,,AUTO
         4 004707   000001 115007                    CMPA    1,DL
         4 004710   004733 601000 4                  TNZ     s:15581

     1241    15572    4         THEN
     1242    15573    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.TPOK

  15573  4 004711   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004712   004721 604400 4                  TMOZ    s:15577
         4 004713   000000 236000 xsym               LDQ     KL_DFLT
         4 004714   000001 316003                    CANQ    1,DU
         4 004715   004721 601000 4                  TNZ     s:15577

     1243    15574    4            THEN
     1244    15575    4               CALL ACCESS_ERROR;

  15575  4 004716   005013 701000 4                  TSX1    ACCESS_ERROR
         4 004717   000000 011000                    NOP     0
         4 004720   005003 710000 4                  TRA     s:15602

     1245    15576    5            ELSE DO;

     1246    15577    5               KL_DREC.FLAGS.TPOK = AS_TRUE ;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:221  
  15577  4 004721   000000 236000 xsym               LDQ     AS_TRUE
         4 004722   000021 772000                    QRL     17
         4 004723   000000 676000 xsym               ERQ     KL_DREC
         4 004724   000001 376003                    ANQ     1,DU
         4 004725   000000 656000 xsym               ERSQ    KL_DREC

     1247    15578    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;

  15578  4 004726   200046 236100                    LDQ     MODE,,AUTO
         4 004727   003006 060400                    CSL     bolr='003'O
         4 004730   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004731   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1248    15579    5               END;

  15579  4 004732   005003 710000 4                  TRA     s:15602

     1249    15580    5         ELSE DO;

     1250    15581    5            KL_DREC.FLAGS.TPOK = AS_FALSE ;

  15581  4 004733   000000 236000 xsym               LDQ     AS_FALSE
         4 004734   000021 772000                    QRL     17
         4 004735   000000 676000 xsym               ERQ     KL_DREC
         4 004736   000001 376003                    ANQ     1,DU
         4 004737   000000 656000 xsym               ERSQ    KL_DREC

     1251    15582    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;

  15582  4 004740   200046 236100                    LDQ     MODE,,AUTO
         4 004741   003006 060400                    CSL     bolr='003'O
         4 004742   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004743   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1252    15583    5            END ;

  15583  4 004744   005003 710000 4                  TRA     s:15602
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:222  

     1253    15584                                                              /**/
     1254    15585    4         SELECT( 4 /* AS_M_FE# */ ) ;

     1255    15586                                                              /**/
     1256    15587    4         IF OP_CODE = 1   /*  YES_VAL  */

  15587  4 004745   200050 235100                    LDA     OP_CODE,,AUTO
         4 004746   000001 115007                    CMPA    1,DL
         4 004747   004772 601000 4                  TNZ     s:15597

     1257    15588    4         THEN
     1258    15589    4            IF AS_CR_MOD_PROJ > 0  AND  NOT KL_DFLT.FLAGS.FEOK

  15589  4 004750   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004751   004760 604400 4                  TMOZ    s:15593
         4 004752   000000 236000 xsym               LDQ     KL_DFLT
         4 004753   400000 316007                    CANQ    -131072,DL
         4 004754   004760 601000 4                  TNZ     s:15593

     1259    15590    4            THEN
     1260    15591    4               CALL ACCESS_ERROR;

  15591  4 004755   005013 701000 4                  TSX1    ACCESS_ERROR
         4 004756   000000 011000                    NOP     0
         4 004757   005003 710000 4                  TRA     s:15602

     1261    15592    5            ELSE DO;

     1262    15593    5               KL_DREC.FLAGS.FEOK = AS_TRUE ;

  15593  4 004760   000000 236000 xsym               LDQ     AS_TRUE
         4 004761   000022 772000                    QRL     18
         4 004762   000000 676000 xsym               ERQ     KL_DREC
         4 004763   400000 376007                    ANQ     -131072,DL
         4 004764   000000 656000 xsym               ERSQ    KL_DREC

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:223  
     1263    15594    5               AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE;

  15594  4 004765   200046 236100                    LDQ     MODE,,AUTO
         4 004766   003006 060400                    CSL     bolr='003'O
         4 004767   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 004770   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1264    15595    5               END;

  15595  4 004771   005003 710000 4                  TRA     s:15602

     1265    15596    5         ELSE DO;

     1266    15597    5            KL_DREC.FLAGS.FEOK = AS_FALSE ;

  15597  4 004772   000000 236000 xsym               LDQ     AS_FALSE
         4 004773   000022 772000                    QRL     18
         4 004774   000000 676000 xsym               ERQ     KL_DREC
         4 004775   400000 376007                    ANQ     -131072,DL
         4 004776   000000 656000 xsym               ERSQ    KL_DREC

     1267    15598    5            AS_MOD_USER.ACCESS_A(MODE) = AS_TRUE ;

  15598  4 004777   200046 236100                    LDQ     MODE,,AUTO
         4 005000   003006 060400                    CSL     bolr='003'O
         4 005001   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         4 005002   000001 270001 xsym               BDSC    AS_MOD_USER+1,Q          by=1,bit=7,n=1

     1268    15599    5            END ;

     1269    15600                                                              /**/
     1270    15601    4         END ; /* Do case */

     1271    15602    3      END ; /* Do i */

  15602  4 005003   200045 235100                    LDA     I,,AUTO
         4 005004   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:224  
         4 005005   200045 755100                    STA     I,,AUTO
         4 005006   200045 236100                    LDQ     I,,AUTO
         4 005007   200043 116100                    CMPQ    SUBS,,AUTO
         4 005010   004474 602000 4                  TNC     s:15510

     1272    15603                                                              /**/
     1273    15604    2   RETURN ;

  15604  4 005011   200042 221300                    LDX1  ! PROJ_HEADER+12,,AUTO
         4 005012   000001 702211                    TSX2  ! 1,X1

     1274    15605                                                              /**/
     1275    15606        %EJECT;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:225  
     1276    15607    2   ACCESS_ERROR: PROC;

  15607  4 005013   200052 741300       ACCESS_ERROR STX1  ! OP_CODE+2,,AUTO

     1277    15608
     1278    15609
     1279    15610    3   AS_FIELD1 = AS_MODE_ARRY(MODE);

  15610  4 005014   200046 236100                    LDQ     MODE,,AUTO
         4 005015   000007 402007                    MPY     7,DL
         4 005016   000000 100406                    MLR     fill='000'O
         4 005017   000000 000007 xsym               ADSC9   AS_MODE,Q                cn=0,n=7
         4 005020   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1280    15611    4   DO SELECT( AS_CR_MOD_PROJ );

  15611  4 005021   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 005022   000002 116007                    CMPQ    2,DL
         4 005023   005030 604000 4                  TMI     s:15611+7
         4 005024   005040 600000 4                  TZE     s:15657
         4 005025   000003 116007                    CMPQ    3,DL
         4 005026   005051 601000 4                  TNZ     s:15687
         4 005027   005045 710000 4                  TRA     s:15681
         4 005030   000001 116007                    CMPQ    1,DL
         4 005031   005051 601000 4                  TNZ     s:15687
         4 005032   005033 710000 4                  TRA     s:15633

     1281    15612
     1282    15613    4      SELECT( %CR_PROJ_USER );

     1283    15614
     1284    15615        /*E* ERROR:   ASC-E$CANT_GIVE_ACCTO_USER-C
     1285    15616             MESSAGE: %U1 access mode not allowed.
     1286    15617             MESSAGE1: Users in your project are not allowed %U1 access mode.
     1287    15618             MESSAGE2: No user in your project may have an access mode not specified
     1288    15619                       in the default record for the project.
     1289    15620        */
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:226  
     1290    15621           %SCREAM( ERR#=E$CANT_GIVE_ACCTO_USER, LEVEL=ERROR, MID='C' );

  15633  4 005033   000104 630400 5                  EPPR0   68
         4 005034   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005035   000000 701000 xent               TSX1    ASH$ERROR
         4 005036   000000 011000                    NOP     0
         4 005037   005051 710000 4                  TRA     s:15687

     1291    15636
     1292    15637    4      SELECT( %CR_PROJECT );

     1293    15638
     1294    15639        /*E* ERROR:   ASC-E$CANT_GIVE_ACCTO_PROJ-C
     1295    15640             MESSAGE: %U1 access mode not allowed.
     1296    15641             MESSAGE1: Projects you create are not allowed %U1 access mode.
     1297    15642             MESSAGE2: Your project does not have %U1 access, so you are not allowed
     1298    15643                       to give %U1 access to a project you create.
     1299    15644        */
     1300    15645           %SCREAM( ERR#=E$CANT_GIVE_ACCTO_PROJ, LEVEL=ERROR, MID='C' );

  15657  4 005040   000105 630400 5                  EPPR0   69
         4 005041   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005042   000000 701000 xent               TSX1    ASH$ERROR
         4 005043   000000 011000                    NOP     0
         4 005044   005051 710000 4                  TRA     s:15687

     1301    15660
     1302    15661    4      SELECT( %CR_PROJ_DEFAULT );

     1303    15662
     1304    15663        /*E* ERROR:   ASC-E$CANT_GIVE_ACCTO_DFLT-C
     1305    15664             MESSAGE: %U1 access mode not allowed.
     1306    15665             MESSAGE1: Users in a project you create are not allowed %U1 access mode.
     1307    15666             MESSAGE2: Your project does not have %U1 access, so you are not allowed
     1308    15667                       to give %U1 access to users in a project you create.
     1309    15668        */
     1310    15669           %SCREAM( ERR#=E$CANT_GIVE_ACCTO_DFLT, LEVEL=ERROR, MID='C' );
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:227  

  15681  4 005045   000106 630400 5                  EPPR0   70
         4 005046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005047   000000 701000 xent               TSX1    ASH$ERROR
         4 005050   000000 011000                    NOP     0

     1311    15684
     1312    15685    4      END;

     1313    15686
     1314    15687    3   END ACCESS_ERROR;

  15687  4 005051   200052 221300                    LDX1  ! OP_CODE+2,,AUTO
         4 005052   000001 702211                    TSX2  ! 1,X1
     1315    15688    2   END   ACCESS_OPT ;
     1316    15689        %EJECT ;
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:228  
     1317    15690    1   END   ASC$CM_OPTS    ;
     1318    15691        %EOD ;

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:229  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$CM_OPTS.
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:230  

 **** Variables and constants ****

  ****  Section 002  Data  ASC$CM_OPTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/c CHAR(8)     r     1 DATE_BUF                  15-0-0/b BIT         r     1 FE_MODE
     0-0-0/d STRC(432)   r     1 MAKE_UTS                  14-0-0/b BIT         r     1 MORE
    20-0-0/c CHAR(11)    r     1 TIME_BUF                  23-0-0/w UBIN        r     1 UTS_BUF
    23-0-0/w BIT         r     1 UTS_BUF_BIT

  ****  Section 003 RoData ASC$CM_OPTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    16-0-0/w STRC(72)    r     1 ALL_KEYS                   0-0-0/c STRC(162)   r     1 TEXTC(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CR_MOD_KEY                4-0-0/b BIT         r     1 ALTER
     5-0-0/w SBIN        r     1 ARS                        6-0-0/w PTR         r     1 BLK$
     7-0-0/w PTR         r     1 BTEXT$                    *0-0-0/w STRC(189)   r     1 CR_MOD_KEY
    10-0-0/w SBIN        r     1 I                         45-0-0/w UBIN        r     1 I
    11-0-0/w SBIN        r     1 J                         12-0-0/w UBIN        r     1 K
    13-0-0/w UBIN        r     1 LEN                       14-0-0/w UBIN        r     1 MODE
    46-0-0/w UBIN        r     1 MODE                      15-0-0/w UBIN        r     1 OP_CODE
    50-0-0/w UBIN        r     1 OP_CODE                   16-0-0/w PTR         r     1 P$
    26-0-0/w STRC(432)   r     1 PROJ_HEADER               17-0-0/w PTR         r     1 PTR$
    44-0-0/w PTR         r     1 PTR$                      47-0-0/w PTR         r     1 PTR2$
    20-0-0/w PTR         r     1 STR$                      22-0-0/w PTR         r     1 SUBND$
    21-0-0/w SBIN        r     1 SUBNODES                  23-0-0/w UBIN        r     1 SUBS
    43-0-0/w UBIN        r     1 SUBS                      24-0-0/w UBIN        r     1 TEMP
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:231  
    25-0-0/w PTR         r     1 TEMP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ
     0-0-0/w STRC(18576) r     1 AS_DFLT                    0-0-0/b BIT         r     1 AS_FALSE
     0-0-0/c STRC(252)   r     1 AS_FE_MODE
     0-0-0/c STRC(63)    r     1 AS_FE_MODE_ARRY(0:3)
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/c STRC(315)   r     1 AS_MODE
     0-0-0/c STRC(63)    r     1 AS_MODE_ARRY(0:4)
     0-0-0/w STRC(1483)  r     1 AS_MOD_USER                0-0-0/c STRC(189)   r     1 AS_NONE
     0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN           0-0-0/w PTR         r     1 AS_SUPER_TO_PIG$
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/b BIT         r     1 AS_WILD_USER               0-0-0/c CHAR(8)     r     1 BLANK_PASS
     0-0-0/w UBIN        r     1 CODE                       0-0-0/b BIT         r     1 CR_MOD_FLG
     0-0-0/w UBIN        r     1 CR_MOD_TREE                0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/c CHAR(255)   r     1 IN_BUF                     0-0-0/w STRC(6084)  r     1 KL_DFLT
     0-0-0/w STRC(6084)  r     1 KL_DREC                    0-0-0/w PTR         r     1 NODE$
     0-0-0/c STRC(243)   r     1 PROJ_KEY                   0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/d REMB        r     1 REMEM_VAR                  0-0-0/d REMB        r     1 REM_FCMD
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 ACHAR                      0-0-0/w BIT (72)    r     1 BIT$72
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(144)   r     1 P$NODE
     0-0-0/w ASTR(522)   r     1 SUPER_TO_PIG               0-0-0/w ASTR(9)     r     1 VARY$STR

PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:232  

   Procedure ASC$CM_OPTS requires 2603 words for executable code.
   Procedure ASC$CM_OPTS requires 50 words of local(AUTO) storage.
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:233  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:234  
          MINI XREF LISTING

ACCESS_ERROR IN PROCEDURE ACCESS_OPT
     15607**PROC    15524--CALL    15543--CALL    15559--CALL    15575--CALL    15591--CALL
ACCESS_OPT
     15485**PROC    15447--CALL
ACHAR
     13595**DCL     13875>>CALLBLT 13877>>CALLBLT 13879>>CALLBLT 13882<<ASSIGN
ALL_KEYS
     13464**DCL     15314>>IF      15339>>ASSIGN
ALTER
     13703**DCL     14298<<ASSIGN  14309<<ASSIGN  14312<<ASSIGN  14320>>ASSIGN  14348>>ASSIGN  14403<<ASSIGN
     14408<<ASSIGN  14411<<ASSIGN  14418>>ASSIGN  14423>>ASSIGN  14487<<ASSIGN  14490>>ASSIGN
ARS
     13704**DCL     13773<>CALL    13774>>ASSIGN  15182<<ASSIGN  15183<>CALL
ASA_BRKS_LOC
     10577**DCL     10577--REDEF
ASB$ACCT_OK
     13676**DCL-ENT 15210--CALL
ASB$BINCHAR
      6522**DCL-ENT 14061--CALL    14116--CALL    14191--CALL    14258--CALL    15395--CALL
ASB$BINXCHAR
      6523**DCL-ENT 13936--CALL
ASB$LEGL_CHAR
     13637**DCL-ENT 13838--CALL
ASB$PIG
     13682**DCL-ENT 14891--CALL
ASB$PIG_ACCT_ATTR
     13679**DCL-ENT 14885--CALL
ASB$READ_PROJ
     13673**DCL-ENT 15183--CALL
ASB$READ_SI
     13604**DCL-ENT 13773--CALL
ASB$SET_PROMPT
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:235  
     13607**DCL-ENT 13772--CALL
ASC$BANNER
     13691**DCL-ENT 14424--CALL    14491--CALL
ASC$BUDGET
     13622**DCL-ENT 14912--CALL
ASC$EXPIRE
     13634**DCL-ENT 14737--CALL
ASC$FEPPRIV
     13619**DCL-ENT 14909--CALL
ASC$FEPRIV
     13616**DCL-ENT 14905--CALL
ASC$FEPSEUDO
     13655**DCL-ENT 15455--CALL
ASC$FERESOURCE
     13649**DCL-ENT 15472--CALL
ASC$MEMORY
     13628**DCL-ENT 15468--CALL
ASC$OUTPUTPRIO
     13643**DCL-ENT 15442--CALL
ASC$PPRIV
     13613**DCL-ENT 14901--CALL
ASC$PRIV
     13610**DCL-ENT 14897--CALL
ASC$PSEUDO
     13652**DCL-ENT 15451--CALL
ASC$RESOURCE
     13646**DCL-ENT 15462--CALL
ASC$SERVICE
     13631**DCL-ENT 15458--CALL
ASC$SETUP
     13694**DCL-ENT 14351--CALL
ASC$TIME
     13625**DCL-ENT 15465--CALL
ASD$PREC_PRO
     13688**DCL-ENT 15235--CALL
ASH$DQUEST
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:236  
     13661**DCL-ENT 13799--CALL
ASH$ERROR
     13667**DCL-ENT 13833--CALL    13866--CALL    13971--CALL    14007--CALL    14090--CALL    14153--CALL
     14220--CALL    14287--CALL    14343--CALL    14365--CALL    14443--CALL    14466--CALL    14532--CALL
     14566--CALL    14592--CALL    14640--CALL    14681--CALL    14723--CALL    14759--CALL    14802--CALL
     14826--CALL    14849--CALL    14877--CALL    14942--CALL    14968--CALL    15001--CALL    15024--CALL
     15064--CALL    15090--CALL    15147--CALL    15173--CALL    15205--CALL    15275--CALL    15298--CALL
     15334--CALL    15368--CALL    15430--CALL    15481--CALL    15633--CALL    15657--CALL    15681--CALL
ASH$HELP
     13658**DCL-ENT 13796--CALL
ASH$QUEST
     13664**DCL-ENT 13802--CALL
ASH$WARN
     13670**DCL-ENT 14508--CALL    15123--CALL    15251--CALL
ASW$PREC_WSN
     13685**DCL-ENT 15107--CALL
ASZ$SCRAMBLE
     13640**DCL-ENT 13840--CALL
AS_BLANK
     10437**DCL     13895>>ASSIGN  14481--ASSIGN  14653>>ASSIGN  14695>>ASSIGN  15223>>ASSIGN
AS_CR_MOD_PROJ
     10585**DCL     13922>>IF      14040>>IF      14103>>IF      14170>>IF      14237>>IF      14743>>IF
     14810>>IF      14857>>IF      14857>>IF      14890>>ASSIGN  14951>>IF      15007>>IF      15073>>IF
     15178>>IF      15192>>ASSIGN  15282>>IF      15314>>IF      15321>>ASSIGN  15379>>IF      15417>>ASSIGN
     15522>>IF      15541>>IF      15557>>IF      15573>>IF      15589>>IF      15611>>DOSELCT
AS_DEFAULT.BANNER_PERM
     11270**DCL     11271--REDEF
AS_DEFAULT.BUDGET.MACCT
     11175**DCL     11179--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11188**DCL     11191--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11171**DCL     11173--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11166**DCL     11168--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:237  
     11286**DCL     11287--REDEF   11288--REDEF
AS_DEFAULT_DREC.PASSWORD
     12540**DCL     12544--REDEF
AS_DEFAULT_DREC.RENAME
     12563**DCL     12564--REDEF
AS_DFLT.BANNER_PERM
     11092**DCL     11093--REDEF
AS_DFLT.BATNUM
     10984**DCL     13922>>IF      13924>>IF      13936<>CALL    13974>>ASSIGN
AS_DFLT.BATOK
     10982**DCL     15522>>IF
AS_DFLT.BUDGET.MACCT
     10997**DCL     11001--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11010**DCL     11013--REDEF
AS_DFLT.BUDGET.PACCUM
     10993**DCL     10995--REDEF
AS_DFLT.BUDGET.PMAXC
     10988**DCL     10990--REDEF
AS_DFLT.KEY
     11017**DCL     15314>>IF      15379>>IF
AS_DFLT.MAXENQ
     11132**DCL     15008>>IF      15027>>ASSIGN
AS_DFLT.PRIOB
     11064**DCL     15074>>IF      15093>>ASSIGN
AS_DFLT.QUAN
     11062**DCL     14952>>IF      14971>>ASSIGN
AS_DFLT.SETUP_CHRA.TXT
     11108**DCL     11109--REDEF   11110--REDEF
AS_FALSE
     10437**DCL     13910>>ASSIGN  14028>>ASSIGN  14368>>ASSIGN  14883>>ASSIGN  15451<>CALL    15455<>CALL
     15462<>CALL    15472<>CALL    15532>>ASSIGN  15533>>ASSIGN  15549>>ASSIGN  15565>>ASSIGN  15581>>ASSIGN
     15597>>ASSIGN
AS_FE_MODE
     10443**DCL     10444--REDEF
AS_FE_MODE_ARRY
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:238  
     10444**DCL     14044>>ASSIGN  14174>>ASSIGN  14241>>ASSIGN  14788>>ASSIGN
AS_FIELD1
     10573**DCL     14044<<ASSIGN  14174<<ASSIGN  14241<<ASSIGN  14668<<ASSIGN  14710<<ASSIGN  14788<<ASSIGN
     14789<<ASSIGN  15112<<ASSIGN  15191<<ASSIGN  15240<<ASSIGN  15321<<ASSIGN  15355<<ASSIGN  15610<<ASSIGN
AS_FIELD1.TEXT
     10574**DCL     13936<>CALL    14116<>CALL    15395<>CALL
AS_FIELD2
     10574**DCL     15192<<ASSIGN  15417<<ASSIGN
AS_FIELD2.TEXT
     10574**DCL     14061<>CALL    14191<>CALL    14258<>CALL
AS_MODE
     10440**DCL     10442--REDEF
AS_MODE_ARRY
     10442**DCL     14668>>ASSIGN  14710>>ASSIGN  14789>>ASSIGN  15610>>ASSIGN
AS_MOD_USER.ACCESS
     13305**DCL     13306--REDEF
AS_MOD_USER.ACCESS_A
     13306**DCL     15528<<ASSIGN  15534<<ASSIGN  15546<<ASSIGN  15550<<ASSIGN  15562<<ASSIGN  15566<<ASSIGN
     15578<<ASSIGN  15582<<ASSIGN  15594<<ASSIGN  15598<<ASSIGN
AS_MOD_USER.BANNER
     13292**DCL     13293--REDEF
AS_MOD_USER.BANNER_A
     13293**DCL     14447<<ASSIGN  14536<<ASSIGN
AS_MOD_USER.BANNER_PERM
     13294**DCL     13295--REDEF
AS_MOD_USER.BANNER_PERM_A
     13295**DCL     14471<<ASSIGN
AS_MOD_USER.BATNUM
     13284**DCL     13976<<ASSIGN
AS_MOD_USER.BILL
     13300**DCL     13301--REDEF
AS_MOD_USER.BILL_A
     13301**DCL     14779<<ASSIGN
AS_MOD_USER.BUDGET.MACCT
     13327**DCL     14601<<ASSIGN
AS_MOD_USER.CPROC
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:239  
     13296**DCL     13297--REDEF
AS_MOD_USER.CPROC_A
     13297**DCL     14654<<ASSIGN  14661<<ASSIGN
AS_MOD_USER.FACCOUNT
     13375**DCL     14892<<ASSIGN
AS_MOD_USER.FEBILL
     13376**DCL     13377--REDEF
AS_MOD_USER.FEBILL_A
     13377**DCL     14775<<ASSIGN
AS_MOD_USER.FECXTMEM
     13393**DCL     13394--REDEF
AS_MOD_USER.FEDBACCN
     13392**DCL     13984<<ASSIGN  14013<<ASSIGN
AS_MOD_USER.FEMACCTMEM
     13391**DCL     14854<<ASSIGN
AS_MOD_USER.FEMFPRG
     13380**DCL     14158<<ASSIGN
AS_MOD_USER.FEMINTS
     13378**DCL     13379--REDEF
AS_MOD_USER.FEMINTS_A
     13379**DCL     14095<<ASSIGN
AS_MOD_USER.FEMMEM
     13389**DCL     13390--REDEF
AS_MOD_USER.FEMMEM_A
     13390**DCL     14292<<ASSIGN
AS_MOD_USER.FEMTIME
     13387**DCL     13388--REDEF
AS_MOD_USER.FEMTIME_A
     13388**DCL     14225<<ASSIGN
AS_MOD_USER.FEPPRIV
     13384**DCL     13386--REDEF
AS_MOD_USER.FEPRIV
     13381**DCL     13383--REDEF
AS_MOD_USER.FESTEPACCNT
     13397**DCL     14029<<ASSIGN
AS_MOD_USER.FORCE_A
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:240  
     13291**DCL     14389<<ASSIGN
AS_MOD_USER.FORCE_BIT
     13290**DCL     13291--REDEF
AS_MOD_USER.HSET
     13303**DCL     15216<<ASSIGN
AS_MOD_USER.KEY
     13372**DCL     13374--REDEF
AS_MOD_USER.KEY_A
     13374**DCL     15310<<ASSIGN  15342<<ASSIGN  15436<<ASSIGN
AS_MOD_USER.LASTCPROC
     13298**DCL     13299--REDEF
AS_MOD_USER.LASTCPROC_A
     13299**DCL     14696<<ASSIGN  14703<<ASSIGN
AS_MOD_USER.LAST_LOGON_TIME
     13398**DCL     14620<<ASSIGN
AS_MOD_USER.LIMITS.DO_
     13346**DCL     13347--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13362**DCL     13363--REDEF
AS_MOD_USER.LIMITS.LO
     13342**DCL     13343--REDEF
AS_MOD_USER.LIMITS.MEM
     13338**DCL     13339--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13366**DCL     13367--REDEF
AS_MOD_USER.LIMITS.PDIS
     13354**DCL     13355--REDEF
AS_MOD_USER.LIMITS.PO
     13350**DCL     13351--REDEF
AS_MOD_USER.LIMITS.TDIS
     13358**DCL     13359--REDEF
AS_MOD_USER.LIMITS.TIME
     13334**DCL     13335--REDEF
AS_MOD_USER.MAXENQ
     13315**DCL     13316--REDEF
AS_MOD_USER.MAXENQ_A
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:241  
     13316**DCL     15029<<ASSIGN
AS_MOD_USER.NAT_LANG
     13282**DCL     13898<<ASSIGN
AS_MOD_USER.PASSWORD
     13281**DCL     13810<<ASSIGN  13841<<ASSIGN  13885<<ASSIGN
AS_MOD_USER.PERM_A
     13289**DCL     14321<<ASSIGN  14349<<ASSIGN
AS_MOD_USER.PERM_BIT
     13288**DCL     13289--REDEF
AS_MOD_USER.PPRIV
     13310**DCL     13312--REDEF
AS_MOD_USER.PRIOB
     13317**DCL     13318--REDEF
AS_MOD_USER.PRIOB_A
     13318**DCL     15095<<ASSIGN
AS_MOD_USER.PRIV
     13307**DCL     13309--REDEF
AS_MOD_USER.PROFILE
     13304**DCL     15224<<ASSIGN  15233<<ASSIGN
AS_MOD_USER.QUAN
     13313**DCL     13314--REDEF
AS_MOD_USER.QUAN_A
     13314**DCL     14973<<ASSIGN
AS_MOD_USER.SETUP
     13286**DCL     13287--REDEF
AS_MOD_USER.SETUP_A
     13287**DCL     14350<<ASSIGN  14368<<ASSIGN
AS_MOD_USER.STARSACC
     13285**DCL     14733<<ASSIGN
AS_MOD_USER.STEPACCNT
     13283**DCL     13911<<ASSIGN
AS_MOD_USER.WSN
     13302**DCL     15104<<ASSIGN
AS_NONE
     10438**DCL     14543>>ASSIGN
AS_PROJECT.BANNER_PERM
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:242  
     11626**DCL     11627--REDEF
AS_PROJECT.BUDGET.MACCT
     11531**DCL     11535--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11544**DCL     11547--REDEF
AS_PROJECT.BUDGET.PACCUM
     11527**DCL     11529--REDEF
AS_PROJECT.BUDGET.PMAXC
     11522**DCL     11524--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11642**DCL     11643--REDEF   11644--REDEF
AS_PROJECT_ADMIN
     10581**DCL     15210<>CALL
AS_PROJECT_ADMIN.TEXT
     10581**DCL     15179>>ASSIGN
AS_PROJECT_DFLT.BANNER_PERM
     11804**DCL     11805--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11709**DCL     11713--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11722**DCL     11725--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11705**DCL     11707--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11700**DCL     11702--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11820**DCL     11821--REDEF   11822--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13026**DCL     13030--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13049**DCL     13050--REDEF
AS_PROJECT_DREC.PASSWORD
     12864**DCL     12868--REDEF
AS_PROJECT_DREC.RENAME
     12887**DCL     12888--REDEF
AS_PROJ_ADMIN.BANNER_PERM
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:243  
     11448**DCL     11449--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11353**DCL     11357--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11366**DCL     11369--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11349**DCL     11351--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11344**DCL     11346--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11464**DCL     11465--REDEF   11466--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12702**DCL     12706--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12725**DCL     12726--REDEF
AS_SUPER_TO_PIG$
     10584**DCL     13563--IMP-PTR 14882>>ASSIGN  14883>>ASSIGN  14884>>ASSIGN  14885>>CALL    14885>>CALL
     14887>>ASSIGN  14889>>ASSIGN  14890>>ASSIGN  14891>>CALL    14891>>CALL
AS_TRUE
     10437**DCL     13763>>ASSIGN  13898>>ASSIGN  13904>>ASSIGN  13908>>ASSIGN  13911>>ASSIGN  13984>>ASSIGN
     14013>>ASSIGN  14022>>ASSIGN  14026>>ASSIGN  14029>>ASSIGN  14095>>ASSIGN  14158>>ASSIGN  14225>>ASSIGN
     14292>>ASSIGN  14321>>ASSIGN  14349>>ASSIGN  14350>>ASSIGN  14447>>ASSIGN  14471>>ASSIGN  14620>>ASSIGN
     14654>>ASSIGN  14661>>ASSIGN  14696>>ASSIGN  14703>>ASSIGN  14733>>ASSIGN  14775>>ASSIGN  14779>>ASSIGN
     14854>>ASSIGN  14892>>ASSIGN  14973>>ASSIGN  15029>>ASSIGN  15095>>ASSIGN  15104>>ASSIGN  15210<>CALL
     15216>>ASSIGN  15224>>ASSIGN  15526>>ASSIGN  15527>>ASSIGN  15528>>ASSIGN  15534>>ASSIGN  15545>>ASSIGN
     15546>>ASSIGN  15550>>ASSIGN  15561>>ASSIGN  15562>>ASSIGN  15566>>ASSIGN  15577>>ASSIGN  15578>>ASSIGN
     15582>>ASSIGN  15593>>ASSIGN  15594>>ASSIGN  15598>>ASSIGN
AS_USERS
     10799**DCL     14351--CALL    14424--CALL    14491--CALL
AS_USERS.BANNER_PERM
     10914**DCL     10915--REDEF   14403>>ASSIGN  14418<<ASSIGN  14423<<ASSIGN  14490<<ASSIGN
AS_USERS.BATNUM
     10806**DCL     13921<<ASSIGN  13974<<ASSIGN
AS_USERS.BATOK
     10804**DCL     15527<<ASSIGN  15533<<ASSIGN
AS_USERS.BILL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:244  
     10838**DCL     14778<<ASSIGN
AS_USERS.BUDGET.MACCT
     10819**DCL     10823--REDEF   14543<<ASSIGN
AS_USERS.BUDGET.MACCT.ACCT
     10821**DCL     14547<<ASSIGN  14571<<ASSIGN
AS_USERS.BUDGET.MACCT.COUNT
     10820**DCL     14572<<ASSIGN  14598<<ASSIGN
AS_USERS.BUDGET.MACCT.NAME
     10822**DCL     14548<<ASSIGN  14597<<ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
     10832**DCL     10835--REDEF
AS_USERS.BUDGET.PACCUM
     10815**DCL     10817--REDEF
AS_USERS.BUDGET.PMAXC
     10810**DCL     10812--REDEF
AS_USERS.CPROC.NAME.CNT
     10869**DCL     14652<<ASSIGN  14659<<ASSIGN
AS_USERS.CPROC.NAME.TEXT
     10870**DCL     14653<<ASSIGN  14660<<ASSIGN
AS_USERS.FLAGS.STARSACC
     10891**DCL     14732<<ASSIGN
AS_USERS.HPSN
     10864**DCL     14884>>ASSIGN  15215<<ASSIGN
AS_USERS.KEY
     10839**DCL     15307--ASSIGN  15339--ASSIGN  15435<<ASSIGN
AS_USERS.LASTCPROC.NAME.CNT
     10874**DCL     14694<<ASSIGN  14701<<ASSIGN
AS_USERS.LASTCPROC.NAME.TEXT
     10875**DCL     14695<<ASSIGN  14702<<ASSIGN
AS_USERS.LAST_LOGON_TIME
     10939**DCL     14619<<ASSIGN
AS_USERS.MAXENQ
     10954**DCL     15006<<ASSIGN  15027<<ASSIGN
AS_USERS.NAT_LANG
     10802**DCL     13895<<ASSIGN  13897<<ASSIGN
AS_USERS.PRIOB
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:245  
     10886**DCL     15070<<ASSIGN  15072<<ASSIGN  15074>>IF      15093<<ASSIGN
AS_USERS.QUAN
     10884**DCL     14948<<ASSIGN  14950<<ASSIGN  14952>>IF      14971<<ASSIGN
AS_USERS.SETUP_CHRA.TXT
     10930**DCL     10931--REDEF   10932--REDEF
AS_USERS.SETUP_FORCE
     10916**DCL     14386<<ASSIGN  14388<<ASSIGN
AS_USERS.SETUP_PERM
     10913**DCL     14298>>ASSIGN  14320<<ASSIGN  14348<<ASSIGN
AS_USERS.STEPACCNT
     10803**DCL     13904<<ASSIGN  13908<<ASSIGN  13910<<ASSIGN
AS_USERS_CONSTANT.BANNER_PERM
     11982**DCL     11983--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11887**DCL     11891--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11900**DCL     11903--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11883**DCL     11885--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11878**DCL     11880--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11998**DCL     11999--REDEF   12000--REDEF
AS_WILD_USER
     10582**DCL     15308>>IF      15340>>IF
BAD_CHAR
     13841**LABEL   13838--CALLALT
BIT$72
     13561**DCL     15307<<ASSIGN  15339<<ASSIGN
BLANK_PASS
     10568**DCL     13809>>ASSIGN  13983>>ASSIGN
BLK$
     13705**DCL     13527--IMP-PTR 14546<<ASSIGN  14549>>IF      14571>>ASSIGN  14571>>ASSIGN  14572>>ASSIGN
     14574<<ASSIGN  14575>>IF      14597>>ASSIGN  14597>>ASSIGN  14598>>ASSIGN
BTEXT$
     13706**DCL     14393<<ASSIGN  14399<<ASSIGN  14416>>IF      14421>>IF      14424>>CALL    14424>>CALL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:246  
     14481<<ASSIGN  14484<<ASSIGN  14488>>IF      14491>>CALL    14491>>CALL
CM_LOOP
     13763**LABEL   13770--REMEMBR 14885--CALLALT 14891--CALLALT 14893--GOTO    15482--GOTO
CM_LOOP_FCMD
     13777**LABEL   13764--REMEMBR
CODE
     10570**DCL     13781<<ASSIGN  13786<<ASSIGN  13788>>DOSELCT 14740>>IF      15304<<ASSIGN  15305>>DOSELCT
CR_MOD_FLG
     10586**DCL     14886>>IF
CR_MOD_KEY
        32**DCL        24--PROC    13791>>ASSIGN  14912<>CALL
CR_MOD_KEY.TEXT
        34**DCL     15210<>CALL
CR_MOD_TREE
     10429**DCL     13767--ASSIGN
DATE_BUF
     13707**DCL     13446--DCLINIT 13447--DCLINIT 14609<<ASSIGN
ERR_CODE
     10572**DCL     10573--REDEF   13891<<ASSIGN  13901<<ASSIGN  13914<<ASSIGN  14019<<ASSIGN  14032<<ASSIGN
     14099<<ASSIGN  14161<<ASSIGN  14229<<ASSIGN  14830<<ASSIGN  14900<<ASSIGN  14908<<ASSIGN  14915<<ASSIGN
     14977<<ASSIGN  15033<<ASSIGN  15446<<ASSIGN  15457<<ASSIGN  15461<<ASSIGN  15471<<ASSIGN
ERR_CODE.CODE
     10572**DCL     13792<<ASSIGN  13805<<ASSIGN  13979<<ASSIGN  14296<<ASSIGN  14374<<ASSIGN  14394<<ASSIGN
     14477<<ASSIGN  14539<<ASSIGN  14605<<ASSIGN  14646<<ASSIGN  14736<<ASSIGN  14764<<ASSIGN  14896<<ASSIGN
     14904<<ASSIGN  14911<<ASSIGN  15099<<ASSIGN  15153<<ASSIGN  15219<<ASSIGN  15450<<ASSIGN  15454<<ASSIGN
FE_MODE
     13460**DCL     14741<<ASSIGN  14742<<ASSIGN  14772>>IF      14787>>IF
I
     13708**DCL     13784<<DOINDEX 13785>>ASSIGN  13875<<CALLBLT 13880>>ASSIGN  14606<<DOINDEX 14607>>DOSELCT
     14609>>ASSIGN  14609>>ASSIGN  14610>>ASSIGN  14612>>ASSIGN  14612>>ASSIGN  14613>>ASSIGN
I IN PROCEDURE ACCESS_OPT
     15494**DCL     15509<<DOINDEX 15510>>ASSIGN
IN_BUF
     10568**DCL     13773<>CALL
J
     13709**DCL     13877<<CALLBLT 13880>>ASSIGN  13916<<ASSIGN  13919<<CALLBLT 13921>>ASSIGN  13924>>IF
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:247  
     13924>>IF      14034<<DOINDEX 14035>>ASSIGN  14107<<ASSIGN  14116<>CALL    14163<<DOINDEX 14164>>ASSIGN
     14231<<DOINDEX 14232>>ASSIGN  14300<<DOINDEX 14301>>ASSIGN  14377<<DOINDEX 14378>>ASSIGN  14395<<DOINDEX
     14396>>ASSIGN  14648<<DOINDEX 14649>>ASSIGN  14690<<DOINDEX 14691>>ASSIGN  14766<<DOINDEX 14767>>ASSIGN
     14917<<DOINDEX 14918>>ASSIGN  14979<<DOINDEX 14980>>ASSIGN  15035<<DOINDEX 15036>>ASSIGN  15347<<DOINDEX
     15348>>ASSIGN  15373>>IF      15377>>ASSIGN
K
     13710**DCL     13879<<CALLBLT 13880>>ASSIGN  14038<<CALLBLT 14039>>ASSIGN  14042>>IF      14167<<CALLBLT
     14168<<ASSIGN  14168>>ASSIGN  14169>>ASSIGN  14172>>IF      14235<<CALLBLT 14236>>ASSIGN  14239>>IF
     14647<<ASSIGN  14648>>DOINDEX 14689<<ASSIGN  14690>>DOINDEX 14924<<CALLBLT 14925>>IF      14948>>ASSIGN
     14950>>ASSIGN  14983<<CALLBLT 14984>>IF      15006>>ASSIGN  15008>>IF      15046<<CALLBLT 15047>>IF
     15070>>ASSIGN  15072>>ASSIGN  15309<<DOINDEX 15310>>ASSIGN  15341<<DOINDEX 15342>>ASSIGN  15375<<ASSIGN
     15377<<ASSIGN  15379>>IF      15395<>CALL    15435>>ASSIGN  15436>>ASSIGN
KL_DEFAULT.PASSWORD
     13188**DCL     13192--REDEF
KL_DEFAULT.RENAME
     13211**DCL     13212--REDEF
KL_DFLT.FLAGS.FEOK
     12366**DCL     15589>>IF
KL_DFLT.FLAGS.GHOSTOK
     12335**DCL     15557>>IF
KL_DFLT.FLAGS.OLOK
     12338**DCL     15541>>IF
KL_DFLT.FLAGS.TPOK
     12362**DCL     15573>>IF
KL_DFLT.KL_DFLT_FEBLK.MFPRG
     12441**DCL     14105>>IF      14107>>ASSIGN  14156>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MINTS
     12440**DCL     14042>>IF      14061<>CALL    14093>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MMEM
     12449**DCL     14239>>IF      14258<>CALL    14290>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MTIME
     12448**DCL     14172>>IF      14191>>CALL    14223>>ASSIGN
KL_DFLT.PASSWORD
     12378**DCL     12382--REDEF
KL_DFLT.RENAME
     12401**DCL     12402--REDEF
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:248  
KL_DREC.FLAGS.BATOK
     12180**DCL     15526<<ASSIGN  15532<<ASSIGN
KL_DREC.FLAGS.FEOK
     12204**DCL     15593<<ASSIGN  15597<<ASSIGN
KL_DREC.FLAGS.GHOSTOK
     12173**DCL     15561<<ASSIGN  15565<<ASSIGN
KL_DREC.FLAGS.OLOK
     12176**DCL     15545<<ASSIGN  15549<<ASSIGN
KL_DREC.FLAGS.TPOK
     12200**DCL     15577<<ASSIGN  15581<<ASSIGN
KL_DREC.HPS.N
     12244**DCL     15214<<ASSIGN
KL_DREC.KL_DREC_FEBLK.BILL
     12276**DCL     14774<<ASSIGN
KL_DREC.KL_DREC_FEBLK.DBACCN
     12277**DCL     13983<<ASSIGN  14012<<ASSIGN
KL_DREC.KL_DREC_FEBLK.FLAGS.STEPACCT
     12282**DCL     14022<<ASSIGN  14026<<ASSIGN  14028<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MACCTMEM
     12280**DCL     14853<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MFPRG
     12279**DCL     14102<<ASSIGN  14156<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MINTS
     12278**DCL     14039<<ASSIGN  14093<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MMEM
     12287**DCL     14236<<ASSIGN  14290<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MTIME
     12286**DCL     14169<<ASSIGN  14223<<ASSIGN
KL_DREC.PASSWORD
     12216**DCL     12220--REDEF   13809<<ASSIGN  13839<<ASSIGN  13840<>CALL    13873--ASSIGN
KL_DREC.PNAME.CNT
     12230**DCL     15222<<ASSIGN  15231<<ASSIGN
KL_DREC.PNAME.TXT
     12233**DCL     15223<<ASSIGN  15230<<ASSIGN  15232<<ASSIGN
KL_DREC.RENAME
     12239**DCL     12240--REDEF
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:249  
KL_DREC.WOO
     12236**DCL     15103<<ASSIGN  15106>>CALLBLT
KL_DREC_CNT.PASSWORD
     12103**DCL     12107--REDEF
KL_DREC_CNT.RENAME
     12126**DCL     12127--REDEF
LEN
     13711**DCL     13814<<ASSIGN  13815>>IF      13838<>CALL    13847<<ASSIGN  13848>>IF      13988<<ASSIGN
     13989>>IF
LOOP_END
     15461**LABEL   14880--GOTO    14945--GOTO    15004--GOTO    15067--GOTO    15176--GOTO    15208--GOTO
     15210--CALLALT 15301--GOTO    15337--GOTO    15371--GOTO    15433--GOTO
M$TIME
      9868**DCL-ENT 14617--CALL
MAKE_UTS
     13446**DCL     14617<>CALL
MAKE_UTS.DATE_.BOUND
     13446**DCL     14610<<ASSIGN
MAKE_UTS.TIME_.BOUND
     13448**DCL     14613<<ASSIGN
MAKE_UTS.V
     13450**DCL     13446--DCLINIT
MODE
     13712**DCL     14036<<ASSIGN  14039>>ASSIGN  14042>>IF      14044>>ASSIGN  14061>>CALL    14093>>ASSIGN
     14093>>ASSIGN  14095>>ASSIGN  14101<<CALLBLT 14102>>ASSIGN  14105>>IF      14165<<ASSIGN  14169>>ASSIGN
     14172>>IF      14174>>ASSIGN  14191>>CALL    14223>>ASSIGN  14223>>ASSIGN  14225>>ASSIGN  14233<<ASSIGN
     14236>>ASSIGN  14239>>IF      14241>>ASSIGN  14258>>CALL    14290>>ASSIGN  14290>>ASSIGN  14292>>ASSIGN
     14297<<ASSIGN  14298>>ASSIGN  14320>>ASSIGN  14321>>ASSIGN  14348>>ASSIGN  14349>>ASSIGN  14350>>ASSIGN
     14351<>CALL    14368>>ASSIGN  14379<<ASSIGN  14386>>ASSIGN  14388>>ASSIGN  14389>>ASSIGN  14402<<ASSIGN
     14403>>ASSIGN  14418>>ASSIGN  14423>>ASSIGN  14424<>CALL    14447>>ASSIGN  14471>>ASSIGN  14486<<ASSIGN
     14490>>ASSIGN  14491<>CALL    14650<<ASSIGN  14652>>ASSIGN  14653>>ASSIGN  14654>>ASSIGN  14659>>ASSIGN
     14660>>ASSIGN  14661>>ASSIGN  14668>>ASSIGN  14692<<ASSIGN  14694>>ASSIGN  14695>>ASSIGN  14696>>ASSIGN
     14701>>ASSIGN  14702>>ASSIGN  14703>>ASSIGN  14710>>ASSIGN  14731<<ASSIGN  14732>>ASSIGN  14768<<ASSIGN
     14774>>ASSIGN  14775>>ASSIGN  14778>>ASSIGN  14779>>ASSIGN  14788>>ASSIGN  14789>>ASSIGN  14832<<CALLBLT
     14833>>IF      14853>>ASSIGN  14919<<ASSIGN  14948>>ASSIGN  14950>>ASSIGN  14952>>IF      14952>>IF
     14971>>ASSIGN  14971>>ASSIGN  14973>>ASSIGN  14981<<ASSIGN  15006>>ASSIGN  15008>>IF      15027>>ASSIGN
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:250  
     15027>>ASSIGN  15029>>ASSIGN  15037<<ASSIGN  15070>>ASSIGN  15072>>ASSIGN  15074>>IF      15074>>IF
     15093>>ASSIGN  15093>>ASSIGN  15095>>ASSIGN  15349<<CALLBLT 15350>>IF      15350>>IF      15379>>IF
     15435>>ASSIGN  15436>>ASSIGN
MODE IN PROCEDURE ACCESS_OPT
     15495**DCL     15511<<ASSIGN  15517>>DOSELCT 15528>>ASSIGN  15534>>ASSIGN  15546>>ASSIGN  15550>>ASSIGN
     15562>>ASSIGN  15566>>ASSIGN  15578>>ASSIGN  15582>>ASSIGN  15594>>ASSIGN  15598>>ASSIGN  15610>>ASSIGN
MORE
     13459**DCL     13763<<ASSIGN  13769>>DOWHILE
NODE$
     10570**DCL     13480--IMP-PTR 13777<<ASSIGN  13781>>ASSIGN  13782>>ASSIGN  13785>>ASSIGN
NO_PRO
     15240**LABEL   15235--CALLALT
NO_PROJ_REC
     15191**LABEL   15183--CALLALT
NO_WSN
     15112**LABEL   15107--CALLALT
OPTION_ERR
     15465**LABEL   13775--CALLALT
OP_CODE
     13713**DCL     14382<<ASSIGN  14384<<ASSIGN  14385>>IF
OP_CODE IN PROCEDURE ACCESS_OPT
     15497**DCL     15514<<ASSIGN  15516<<ASSIGN  15520>>IF      15539>>IF      15555>>IF      15571>>IF
     15587>>IF
OUT$SYM.CODE
     13533**DCL     14302>>DOSELCT 14397>>DOSELCT 14607>>DOSELCT
OUT$SYM.COUNT
     13550**DCL     13553--IMP-SIZ 14306>>IF      14306>>IF      14402>>ASSIGN  14405>>IF      14405>>IF
     14609>>ASSIGN  14610>>ASSIGN  14612>>ASSIGN  14613>>ASSIGN
OUT$SYM.TEXT
     13553**DCL     14306>>IF      14306>>IF      14402>>ASSIGN  14405>>IF      14405>>IF      14609>>ASSIGN
     14612>>ASSIGN
OUT$SYM.TEXTC$
     13545**DCL     13846>>ASSIGN  14304>>ASSIGN  14399>>ASSIGN  14484>>ASSIGN  14549>>IF      14571>>ASSIGN
     14571>>ASSIGN  14572>>ASSIGN  14575>>IF      14597>>ASSIGN  14597>>ASSIGN  14598>>ASSIGN
P$
     13714**DCL     13806<<ASSIGN  13807>>IF      13812>>IF      13813>>ASSIGN  13846>>ASSIGN  13871<<ASSIGN
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:251  
     13872>>ASSIGN  13874>>DOWHILE 13875>>CALLBLT 13876<<ASSIGN  13876>>ASSIGN  13877>>CALLBLT 13878<<ASSIGN
     13878>>ASSIGN  13879>>CALLBLT 13881<<ASSIGN  13881>>ASSIGN  13892<<ASSIGN  13893>>IF      13897>>ASSIGN
     13897>>ASSIGN  13980<<ASSIGN  13981>>IF      13987>>ASSIGN  14035<<ASSIGN  14036>>ASSIGN  14037>>ASSIGN
     14164<<ASSIGN  14165>>ASSIGN  14166>>ASSIGN  14232<<ASSIGN  14233>>ASSIGN  14234>>ASSIGN  14378<<ASSIGN
     14379>>ASSIGN  14380>>IF      14384>>ASSIGN  14478<<ASSIGN  14479>>IF      14540<<ASSIGN  14541>>IF
     14546>>ASSIGN  14574>>ASSIGN  14767<<ASSIGN  14768>>ASSIGN  14769>>ASSIGN  14918<<ASSIGN  14919>>ASSIGN
     14920>>IF      14921>>ASSIGN  14923>>ASSIGN  14947>>IF      14980<<ASSIGN  14981>>ASSIGN  14982>>ASSIGN
     15036<<ASSIGN  15037>>ASSIGN  15038>>IF      15040>>IF      15040>>IF      15042>>ASSIGN  15045>>ASSIGN
     15069>>IF
P$NODE.CODE
     13488**DCL     13781>>ASSIGN  13786>>ASSIGN  13807>>IF      13812>>IF      13893>>IF      13906>>IF
     13915>>IF      13981>>IF      14024>>IF      14036>>ASSIGN  14165>>ASSIGN  14233>>ASSIGN  14297>>ASSIGN
     14379>>ASSIGN  14384>>ASSIGN  14479>>IF      14541>>IF      14650>>ASSIGN  14692>>ASSIGN  14731>>ASSIGN
     14768>>ASSIGN  14919>>ASSIGN  14920>>IF      14947>>IF      14981>>ASSIGN  15037>>ASSIGN  15038>>IF
     15040>>IF      15040>>IF      15069>>IF      15220>>IF      15304>>ASSIGN  15377>>ASSIGN  15511>>ASSIGN
     15516>>ASSIGN
P$NODE.SUBLK$
     13513**DCL     13785>>ASSIGN  13806>>ASSIGN  13813>>ASSIGN  13846>>ASSIGN  13892>>ASSIGN  13897>>ASSIGN
     13897>>ASSIGN  13906>>IF      13915>>IF      13918>>ASSIGN  13918>>ASSIGN  13980>>ASSIGN  13987>>ASSIGN
     14024>>IF      14035>>ASSIGN  14036>>ASSIGN  14037>>ASSIGN  14037>>ASSIGN  14100>>ASSIGN  14100>>ASSIGN
     14164>>ASSIGN  14165>>ASSIGN  14166>>ASSIGN  14166>>ASSIGN  14232>>ASSIGN  14233>>ASSIGN  14234>>ASSIGN
     14234>>ASSIGN  14297>>ASSIGN  14301>>ASSIGN  14375>>ASSIGN  14376>>ASSIGN  14378>>ASSIGN  14379>>ASSIGN
     14384>>ASSIGN  14396>>ASSIGN  14478>>ASSIGN  14484>>ASSIGN  14540>>ASSIGN  14546>>ASSIGN  14574>>ASSIGN
     14606>>DOINDEX 14607>>DOSELCT 14607>>DOSELCT 14609>>ASSIGN  14609>>ASSIGN  14609>>ASSIGN  14609>>ASSIGN
     14610>>ASSIGN  14610>>ASSIGN  14612>>ASSIGN  14612>>ASSIGN  14612>>ASSIGN  14612>>ASSIGN  14613>>ASSIGN
     14613>>ASSIGN  14649>>ASSIGN  14650>>ASSIGN  14657>>ASSIGN  14657>>ASSIGN  14691>>ASSIGN  14692>>ASSIGN
     14699>>ASSIGN  14699>>ASSIGN  14731>>ASSIGN  14767>>ASSIGN  14768>>ASSIGN  14769>>ASSIGN  14769>>ASSIGN
     14831>>ASSIGN  14831>>ASSIGN  14918>>ASSIGN  14919>>ASSIGN  14920>>IF      14921>>ASSIGN  14921>>ASSIGN
     14923>>ASSIGN  14923>>ASSIGN  14947>>IF      14947>>IF      14980>>ASSIGN  14981>>ASSIGN  14982>>ASSIGN
     14982>>ASSIGN  15036>>ASSIGN  15037>>ASSIGN  15038>>IF      15040>>IF      15040>>IF      15040>>IF
     15040>>IF      15042>>ASSIGN  15042>>ASSIGN  15045>>ASSIGN  15045>>ASSIGN  15069>>IF      15069>>IF
     15100>>ASSIGN  15100>>ASSIGN  15154>>ASSIGN  15154>>ASSIGN  15220>>IF      15227>>ASSIGN  15227>>ASSIGN
     15303>>ASSIGN  15348>>ASSIGN  15348>>ASSIGN  15348>>ASSIGN  15373>>IF      15377>>ASSIGN  15377>>ASSIGN
     15506>>ASSIGN  15507>>ASSIGN  15510>>ASSIGN  15511>>ASSIGN  15516>>ASSIGN
P$NODE.SUBNODES
     13492**DCL     13782>>ASSIGN  13902>>IF      14020>>IF      14033>>ASSIGN  14162>>ASSIGN  14230>>ASSIGN
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:252  
     14300>>DOINDEX 14376>>ASSIGN  14380>>IF      14395>>DOINDEX 14606>>DOINDEX 14647>>ASSIGN  14651>>IF
     14689>>ASSIGN  14693>>IF      14765>>ASSIGN  14916>>ASSIGN  14978>>ASSIGN  15034>>ASSIGN  15346>>ASSIGN
     15373>>IF      15506>>ASSIGN  15512>>IF
PROJ_HEADER
     13735**DCL     15182--ASSIGN  15183--CALL
PROJ_KEY.COUNT
     10450**DCL     15181<<ASSIGN
PROJ_KEY.TEXT
     10450**DCL     10450--REDEF
PROJ_KEY.TXT.PACKSET
     10451**DCL     15180<<ASSIGN  15210<>CALL
PROJ_KEY.TXT.PROJECT
     10450**DCL     10450--REDEF   15179<<ASSIGN
PTR$
     13715**DCL     13872<<ASSIGN  13874>>DOWHILE 14375<<ASSIGN  14378>>ASSIGN  14649<<ASSIGN  14650>>ASSIGN
     14651>>IF      14657>>ASSIGN  14691<<ASSIGN  14692>>ASSIGN  14693>>IF      14699>>ASSIGN  15303<<ASSIGN
     15304>>ASSIGN  15346>>ASSIGN  15348>>ASSIGN  15373>>IF      15377>>ASSIGN
PTR$ IN PROCEDURE ACCESS_OPT
     15493**DCL     15507<<ASSIGN  15510>>ASSIGN
PTR2$ IN PROCEDURE ACCESS_OPT
     15496**DCL     15510<<ASSIGN  15511>>ASSIGN  15512>>IF      15516>>ASSIGN
P_PCB
     10605**DCL     13775<>CALL
P_PCB.ERROR
     10709**DCL     15481<>CALL
P_PCB.NCHARS
     10752**DCL     13774<<ASSIGN
P_PCB.OUT$
     10618**DCL     13777>>ASSIGN
P_PCB.ROOT$
     10610**DCL     13767<<ASSIGN
REMEM_VAR
     10576**DCL     10576--REDEF   13770<<REMEMBR
REM_FCMD
     10576**DCL     10577--REDEF   13764<<REMEMBR
STR$
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:253  
     13716**DCL     13558--IMP-PTR 13813<<ASSIGN  13814>>ASSIGN  13838>>CALL    13838>>CALL    13839>>ASSIGN
     13839>>ASSIGN  13846<<ASSIGN  13847>>ASSIGN  13871>>ASSIGN  13918<<ASSIGN  13919>>CALLBLT 13919>>CALLBLT
     13987<<ASSIGN  13988>>ASSIGN  14012>>ASSIGN  14012>>ASSIGN  14037<<ASSIGN  14038>>CALLBLT 14038>>CALLBLT
     14100<<ASSIGN  14101>>CALLBLT 14101>>CALLBLT 14166<<ASSIGN  14167>>CALLBLT 14167>>CALLBLT 14234<<ASSIGN
     14235>>CALLBLT 14235>>CALLBLT 14299<<ASSIGN  14304<<ASSIGN  14318>>IF      14324>>IF      14351>>CALL
     14351>>CALL    14657<<ASSIGN  14658>>IF      14659>>ASSIGN  14660>>ASSIGN  14660>>ASSIGN  14699<<ASSIGN
     14700>>IF      14701>>ASSIGN  14702>>ASSIGN  14702>>ASSIGN  14769<<ASSIGN  14770>>IF      14774>>ASSIGN
     14774>>ASSIGN  14778>>ASSIGN  14778>>ASSIGN  14831<<ASSIGN  14832>>CALLBLT 14832>>CALLBLT 14921<<ASSIGN
     14923<<ASSIGN  14924>>CALLBLT 14924>>CALLBLT 14982<<ASSIGN  14983>>CALLBLT 14983>>CALLBLT 15042<<ASSIGN
     15045<<ASSIGN  15046>>CALLBLT 15046>>CALLBLT 15100<<ASSIGN  15101>>IF      15103>>ASSIGN  15103>>ASSIGN
     15112>>ASSIGN  15112>>ASSIGN  15154<<ASSIGN  15155>>IF      15180>>ASSIGN  15180>>ASSIGN  15181>>ASSIGN
     15191>>ASSIGN  15191>>ASSIGN  15214>>ASSIGN  15214>>ASSIGN  15215>>ASSIGN  15215>>ASSIGN  15227<<ASSIGN
     15228>>IF      15231>>ASSIGN  15232>>ASSIGN  15232>>ASSIGN  15232>>ASSIGN  15234>>ASSIGN  15234>>ASSIGN
     15240>>ASSIGN  15240>>ASSIGN  15348<<ASSIGN  15349>>CALLBLT 15349>>CALLBLT 15355>>ASSIGN  15355>>ASSIGN
SUBND$
     13718**DCL     13785<<ASSIGN  13786>>ASSIGN  13806>>ASSIGN  13892>>ASSIGN  13902>>IF      13906>>IF
     13915>>IF      13918>>ASSIGN  13980>>ASSIGN  14020>>IF      14024>>IF      14033>>ASSIGN  14035>>ASSIGN
     14100>>ASSIGN  14162>>ASSIGN  14164>>ASSIGN  14230>>ASSIGN  14232>>ASSIGN  14297>>ASSIGN  14300>>DOINDEX
     14301>>ASSIGN  14375>>ASSIGN  14376>>ASSIGN  14395>>DOINDEX 14396>>ASSIGN  14478>>ASSIGN  14484>>ASSIGN
     14540>>ASSIGN  14606>>DOINDEX 14607>>DOSELCT 14609>>ASSIGN  14609>>ASSIGN  14610>>ASSIGN  14612>>ASSIGN
     14612>>ASSIGN  14613>>ASSIGN  14647>>ASSIGN  14649>>ASSIGN  14689>>ASSIGN  14691>>ASSIGN  14731>>ASSIGN
     14737<>CALL    14765>>ASSIGN  14767>>ASSIGN  14831>>ASSIGN  14916>>ASSIGN  14918>>ASSIGN  14978>>ASSIGN
     14980>>ASSIGN  15034>>ASSIGN  15036>>ASSIGN  15100>>ASSIGN  15154>>ASSIGN  15220>>IF      15227>>ASSIGN
     15303>>ASSIGN  15442<>CALL    15465<>CALL    15468<>CALL    15506>>ASSIGN  15507>>ASSIGN
SUBNODES
     13717**DCL     13782<<ASSIGN  13784>>DOINDEX
SUBS
     13719**DCL     14033<<ASSIGN  14034>>DOINDEX 14162<<ASSIGN  14163>>DOINDEX 14230<<ASSIGN  14231>>DOINDEX
     14376<<ASSIGN  14377>>DOINDEX 14765<<ASSIGN  14766>>DOINDEX 14916<<ASSIGN  14917>>DOINDEX 14978<<ASSIGN
     14979>>DOINDEX 15034<<ASSIGN  15035>>DOINDEX 15346<<ASSIGN  15347>>DOINDEX
SUBS IN PROCEDURE ACCESS_OPT
     15492**DCL     15506<<ASSIGN  15509>>DOINDEX
SUPER_TO_PIG
     13563**DCL     14885<>CALL    14891<>CALL
SUPER_TO_PIG.ATTR.COUNT
     13586**DCL     13589--IMP-SIZ 14885>>CALL    14891>>CALL
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:254  
SUPER_TO_PIG.PACKSET
     13583**DCL     14884<<ASSIGN
SUPER_TO_PIG.PROJ
     13572**DCL     14883<<ASSIGN  14890<<ASSIGN
SUPER_TO_PIG.PROJECT
     13579**DCL     13582--REDEF
SUPER_TO_PIG.SUPER
     13575**DCL     13578--REDEF
SUPER_TO_PIG.TYPE
     13564**DCL     14882<<ASSIGN  14887<<ASSIGN  14889<<ASSIGN
TEMP
     13720**DCL     13880<<ASSIGN  13882>>ASSIGN
TEMP$
     13721**DCL     13873<<ASSIGN  13882>>ASSIGN  13883<<ASSIGN  13883>>ASSIGN  14301<<ASSIGN  14302>>DOSELCT
     14304>>ASSIGN  14306>>IF      14306>>IF      14306>>IF      14306>>IF      14396<<ASSIGN  14397>>DOSELCT
     14399>>ASSIGN  14402>>ASSIGN  14402>>ASSIGN  14405>>IF      14405>>IF      14405>>IF      14405>>IF
TEXTC
     13461**DCL     15192>>ASSIGN  15321>>ASSIGN  15417>>ASSIGN
TIME_BUF
     13722**DCL     13448--DCLINIT 13449--DCLINIT 14612<<ASSIGN
USERS_KEY
     10447**DCL     13791<<ASSIGN  15234<<ASSIGN  15235<>CALL
USERS_KEY.COUNT
     10447**DCL     15105<<ASSIGN
USERS_KEY.TEXT
     10447**DCL     10448--REDEF   10448--REDEF   10448--REDEF   10449--REDEF
USERS_KEY.TXTC
     10448**DCL     15106<<CALLBLT
UTS_BUF
     13723**DCL     13450--DCLINIT 13724--REDEF
UTS_BUF_BIT
     13724**DCL     14619>>ASSIGN
VARY$STR
     13558**DCL     14351<>CALL    14424<>CALL    14491<>CALL    15112>>ASSIGN  15191>>ASSIGN  15234>>ASSIGN
     15240>>ASSIGN  15355>>ASSIGN
VARY$STR.CNT
PL6.E3A0      #001=ASC$CM_OPTS File=ASC$OPTS.:E05TSI                             TUE 07/29/97 09:37 Page:255  
     13559**DCL     13560--IMP-SIZ 13814>>ASSIGN  13838>>CALL    13839>>ASSIGN  13847>>ASSIGN  13897>>ASSIGN
     13919>>CALLBLT 13988>>ASSIGN  14012>>ASSIGN  14038>>CALLBLT 14101>>CALLBLT 14167>>CALLBLT 14235>>CALLBLT
     14324>>IF      14351>>CALL    14421>>IF      14424>>CALL    14488>>IF      14491>>CALL    14549>>IF
     14571>>ASSIGN  14572>>ASSIGN  14575>>IF      14597>>ASSIGN  14598>>ASSIGN  14658>>IF      14659>>ASSIGN
     14660>>ASSIGN  14700>>IF      14701>>ASSIGN  14702>>ASSIGN  14770>>IF      14774>>ASSIGN  14778>>ASSIGN
     14832>>CALLBLT 14924>>CALLBLT 14983>>CALLBLT 15046>>CALLBLT 15101>>IF      15103>>ASSIGN  15112>>ASSIGN
     15155>>IF      15180>>ASSIGN  15181>>ASSIGN  15191>>ASSIGN  15214>>ASSIGN  15215>>ASSIGN  15228>>IF
     15231>>ASSIGN  15232>>ASSIGN  15232>>ASSIGN  15234>>ASSIGN  15240>>ASSIGN  15349>>CALLBLT 15355>>ASSIGN
VARY$STR.TEXT
     13560**DCL     13838<>CALL    13839>>ASSIGN  13897>>ASSIGN  13919>>CALLBLT 14012>>ASSIGN  14038>>CALLBLT
     14101>>CALLBLT 14167>>CALLBLT 14235>>CALLBLT 14571>>ASSIGN  14597>>ASSIGN  14660>>ASSIGN  14702>>ASSIGN
     14774>>ASSIGN  14778>>ASSIGN  14832>>CALLBLT 14924>>CALLBLT 14983>>CALLBLT 15046>>CALLBLT 15103>>ASSIGN
     15180>>ASSIGN  15214>>ASSIGN  15215>>ASSIGN  15232>>ASSIGN  15349>>CALLBLT
X$PARSE
     13602**DCL-ENT 13775--CALL

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:256  
     1319        1        /*T***********************************************************/
     1320        2        /*T*                                                         */
     1321        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1322        4        /*T*                                                         */
     1323        5        /*T***********************************************************/
     1324        6        ASC$MOD_USER: PROC;
     1325        7
     1326        8
     1327        9        /********************************************************************/
     1328       10        /*    Include files       include files       include files         */
     1329       11        /********************************************************************/
     1330       12
     1331       13        %INCLUDE      AS_ENTRIES_M ;
     1332     1063        %INCLUDE      AS_SUPER_C ;
     1333     1498        %INCLUDE      AS_SUBS_C ;
     1334     2912        %INCLUDE      AS_PERR_C ;
     1335     3514        %INCLUDE      KL_SUPER_C ;
     1336     6416        %INCLUDE      AS_MAC_C ;
     1337     6496        %INCLUDE      XU_MACRO_C ;
     1338     9602        %INCLUDE      XU_FORMAT_C ;
     1339     9764        %INCLUDE      CP_6 ;
     1340     9845        %INCLUDE      AS_SUPER_R ;
     1341    12861
     1342    12862        /********************************************************************/
     1343    12863        /*    Auto data       auto data       auto data       auto data     */
     1344    12864        /********************************************************************/
     1345    12865
     1346    12866    1   DCL I SBIN;
     1347    12867    1   DCL J SBIN;
     1348    12868    1   DCL K SBIN;
     1349    12869    1   DCL VAL SBIN;
     1350    12870    1   DCL SAVE_MAXC   SBIN ;
     1351    12871    1   DCL SET$ PTR;
     1352    12872    1   DCL VALUE(0:1) SBIN ;
     1353    12873    1   DCL 1 TEXTC(0:2) CONSTANT,
     1354    12874    1          2 CNT UBIN BYTE UNAL INIT( 4, 6, 17 ),
     1355    12875    1          2 TEXT CHAR(17) INIT( 'user', 'project', 'user in a project' );
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:257  
     1356    12876    1   DCL 1 VARY$STR BASED(SET$) ALIGNED ,
     1357    12877    1          2 CNT UBIN(9) UNAL ,
     1358    12878    1          2 TEXT CHAR(VARY$STR.CNT) ;
     1359    12879    1   DCL 1 ZERO_LENGTH CONSTANT,
     1360    12880    1          2 CNT  UBIN(9) CALIGNED INIT (0),
     1361    12881    1          2 TEXT CHAR(1) CALIGNED INIT (' ');
     1362    12882
     1363    12883        /********************************************************************/
     1364    12884        /*    Entry dcls      entry dcls      entry dcls      entry dcls    */
     1365    12885        /********************************************************************/
     1366    12886
     1367    12887        %ASC$MOD_USER_LIMITS ;
     1368    12890        %ASC$RESOURCE ;
     1369    12893        %ASC$FERESOURCE ;
     1370    12896        %ASC$PSEUDO ;
     1371    12899        %ASC$FEPSEUDO ;
     1372    12902        %ASB$PIG ;
     1373    12905        %ASH$ERROR ;
     1374    12908        %ASC$BANNER ;
     1375    12911        %ASH$WARN ;
     1376    12914        %ASC$SETUP ;
     1377    12917
     1378    12918        /********************************************************************/
     1379    12919        /*    Local based     local based     local based     local based   */
     1380    12920        /********************************************************************/
     1381    12921
     1382    12922        %SUPER_TO_PIG( STCLASS="BASED(AS_SUPER_TO_PIG$)" );
     1383    12954        /********************************************************************/
     1384    12955        /*    Procedure       procedure       procedure       procedure     */
     1385    12956        /********************************************************************/
     1386    12957
     1387    12958
     1388    12959
     1389    12960    1   IF AS_MOD_USER.PASSWORD THEN KL_DREC.PASSWORD = KL_DFLT.PASSWORD;
     1390    12961    1   IF AS_MOD_USER.NAT_LANG THEN AS_USERS.NAT_LANG = AS_DFLT.NAT_LANG;
     1391    12962    1   IF AS_MOD_USER.STEPACCNT THEN AS_USERS.STEPACCNT = AS_DFLT.STEPACCNT;
     1392    12963    1   IF AS_MOD_USER.BATNUM THEN AS_USERS.BATNUM = AS_DFLT.BATNUM;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:258  
     1393    12964    1   IF AS_MOD_USER.FEMFPRG THEN KL_DREC.KL_DREC_FEBLK.MFPRG = KL_DFLT.KL_DFLT_FEBLK.
             12964            MFPRG;
     1394    12965    1   IF AS_MOD_USER.FEMACCTMEM THEN KL_DREC.KL_DREC_FEBLK.MACCTMEM = KL_DFLT.
             12965            KL_DFLT_FEBLK.MACCTMEM;
     1395    12966    1   IF AS_MOD_USER.FEDBACCN THEN KL_DREC.KL_DREC_FEBLK.DBACCN = KL_DFLT.KL_DFLT_FEBLK.
             12966            DBACCN;
     1396    12967    1   IF AS_MOD_USER.STARSACC THEN
     1397    12968    1      AS_USERS.FLAGS.STARSACC = AS_DFLT.FLAGS.STARSACC;
     1398    12969    1   IF AS_MOD_USER.SETUP ~= '0'B THEN ;
     1399    12970    2   DO I = 0 TO 3;
     1400    12971    3      IF AS_MOD_USER.SETUP_A(I) THEN DO ;
     1401    12972    3         J = AS_DFLT.SETUP(I) ;
     1402    12973    3         IF J = - 1 THEN
     1403    12974    3            SET$ = ADDR (ZERO_LENGTH);
     1404    12975    3         ELSE
     1405    12976    3            SET$ = ADDR( AS_DFLT.SETUP_CHRA.TXT_UBIN(J)) ;
     1406    12977    3         CALL ASC$SETUP( ADDR(AS_USERS), I, SET$->VARY$STR)
     1407    12978    4         WHENALTRETURN DO;
     1408    12979                 %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');
     1409    12994    4            END;
     1410    12995    3         END ;
     1411    12996    2      END ;
     1412    12997    2   IF AS_MOD_USER.PERM_BIT ~= '0'B THEN DO;
     1413    12998    3      DO I = 0 TO 3 ;
     1414    12999    3         IF AS_MOD_USER.PERM_A(I) THEN
     1415    13000    3            AS_USERS.SETUP_PERM(I) = AS_DFLT.SETUP_PERM(I) ;
     1416    13001    3         END ;
     1417    13002    2      END ;
     1418    13003    1   IF AS_MOD_USER.BANNER~= '0'B THEN ;
     1419    13004    2   DO I = 0 TO 9;
     1420    13005    3      IF AS_MOD_USER.BANNER_A(I) THEN DO ;
     1421    13006    3         J = AS_DFLT.BANNER(I) ;
     1422    13007    3         IF J = - 1 THEN
     1423    13008    3            SET$ = ADDR (ZERO_LENGTH);
     1424    13009    3         ELSE
     1425    13010    3            SET$ = ADDR( AS_DFLT.SETUP_CHRA.TXT_UBIN(J)) ;
     1426    13011    3         CALL ASC$BANNER(ADDR(AS_USERS),I,VARY$STR)
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:259  
     1427    13012    4         WHENALTRETURN DO;
     1428    13013                 %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');
     1429    13028    4            END;
     1430    13029    3         END ;
     1431    13030    2      END ;
     1432    13031    1   IF AS_MOD_USER.BANNER_PERM ~= '0'B THEN
     1433    13032    2   DO I = 0 TO 9 ;
     1434    13033    2      IF AS_MOD_USER.BANNER_PERM_A(I) THEN
     1435    13034    2         AS_USERS.BANNER_PERM(I) = AS_DFLT.BANNER_PERM(I) ;
     1436    13035    2      END ;
     1437    13036    2   IF AS_MOD_USER.CPROC ~= '0'B THEN DO;
     1438    13037    3      DO I = 0 TO 3;
     1439    13038    3         IF AS_MOD_USER.CPROC_A(I) THEN
     1440    13039    3            AS_USERS.CPROC.NAME(I) = AS_DFLT.CPROC.NAME(I);
     1441    13040    3         END;
     1442    13041    2      END;
     1443    13042    1   IF (AS_MOD_USER.LAST_LOGON_TIME ~= '0'B)
     1444    13043    2   THEN DO;
     1445    13044    2      AS_USERS.LAST_LOGON_TIME = AS_DFLT.LAST_LOGON_TIME;
     1446    13045    2      END;
     1447    13046
     1448    13047    1   IF (AS_MOD_USER.FORCE_BIT ~= '0'B)
     1449    13048    2   THEN DO;
     1450    13049    3      DO I = 0 TO 3;
     1451    13050    3         IF (AS_MOD_USER.FORCE_A (I) = AS_TRUE)
     1452    13051    4         THEN DO;
     1453    13052    4            AS_USERS.SETUP_FORCE (I) = AS_DFLT.SETUP_FORCE (I);
     1454    13053    4            END;
     1455    13054    3         END;
     1456    13055    2      END;
     1457    13056    2   IF AS_MOD_USER.LASTCPROC ~= '0'B THEN DO;
     1458    13057    3      DO I = 0 TO 3;
     1459    13058    3         IF AS_MOD_USER.LASTCPROC_A(I) THEN
     1460    13059    3            AS_USERS.LASTCPROC.NAME(I) = AS_DFLT.LASTCPROC.NAME(I);
     1461    13060    3         END;
     1462    13061    2      END;
     1463    13062    2   IF AS_MOD_USER.BILL ~= '0'B THEN DO;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:260  
     1464    13063    3      DO I = 0 TO 3;
     1465    13064    3         IF AS_MOD_USER.BILL_A(I) THEN
     1466    13065    3            AS_USERS.BILL(I) = AS_DFLT.BILL(I);
     1467    13066    3         END;
     1468    13067    2      END;
     1469    13068    2   IF AS_MOD_USER.FEBILL ~= '0'B THEN DO;
     1470    13069    3      DO I = 0 TO 3;
     1471    13070    3         IF AS_MOD_USER.FEBILL_A(I) THEN
     1472    13071    3            KL_DREC.KL_DREC_FEBLK.BILL(I) = KL_DFLT.KL_DFLT_FEBLK.BILL(I);
     1473    13072    3         END;
     1474    13073    2      END;
     1475    13074    2   IF AS_MOD_USER.FEMINTS ~= '0'B THEN DO;
     1476    13075    3      DO I = 0 TO 3;
     1477    13076    3         IF AS_MOD_USER.FEMINTS_A(I) THEN
     1478    13077    3            KL_DREC.KL_DREC_FEBLK.MINTS(I) = KL_DFLT.KL_DFLT_FEBLK.MINTS(I);
     1479    13078    3         END;
     1480    13079    2      END;
     1481    13080    2   IF AS_MOD_USER.FEMTIME ~= '0'B THEN DO;
     1482    13081    3      DO I = 0 TO 3;
     1483    13082    3         IF AS_MOD_USER.FEMTIME_A(I) THEN
     1484    13083    3            KL_DREC.KL_DREC_FEBLK.MTIME(I) = KL_DFLT.KL_DFLT_FEBLK.MTIME(I);
     1485    13084    3         END;
     1486    13085    2      END;
     1487    13086    2   IF AS_MOD_USER.FEMMEM ~= '0'B THEN DO;
     1488    13087    3      DO I = 0 TO 3;
     1489    13088    3         IF AS_MOD_USER.FEMMEM_A(I) THEN
     1490    13089    3            KL_DREC.KL_DREC_FEBLK.MMEM(I) = KL_DFLT.KL_DFLT_FEBLK.MMEM(I);
     1491    13090    3         END;
     1492    13091    2      END;
     1493    13092    1   IF AS_MOD_USER.WSN THEN KL_DREC.WOO = KL_DFLT.WOO;
     1494    13093    2   IF AS_MOD_USER.HSET THEN DO;
     1495    13094    2      KL_DREC.HPS.N = KL_DFLT.HPS.N;
     1496    13095    2      AS_USERS.HPSN = AS_DFLT.HPSN;
     1497    13096    2      END;
     1498    13097    1   IF AS_MOD_USER.PROFILE THEN KL_DREC.PNAME = KL_DFLT.PNAME;
     1499    13098    2   IF AS_MOD_USER.ACCESS THEN DO;
     1500    13099    3      DO I = 0 TO 4;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:261  
     1501    13100    3         IF AS_MOD_USER.ACCESS_A(I) THEN
     1502    13101    4         DO SELECT( I );
     1503    13102    4            SELECT( AS_M_BATCH# );
     1504    13103    4            KL_DREC.FLAGS.BATOK = KL_DFLT.FLAGS.BATOK;
     1505    13104    4            AS_USERS.BATOK = AS_DFLT.BATOK;
     1506    13105    4            SELECT( AS_M_INT# );
     1507    13106    4            KL_DREC.FLAGS.OLOK = KL_DFLT.FLAGS.OLOK;
     1508    13107    4            SELECT( AS_M_GHOST# );
     1509    13108    4            KL_DREC.FLAGS.GHOSTOK = KL_DFLT.FLAGS.GHOSTOK;
     1510    13109    4            SELECT( AS_M_FE# );
     1511    13110    4            KL_DREC.FLAGS.FEOK = KL_DFLT.FLAGS.FEOK;
     1512    13111    4            SELECT( AS_M_TP# );
     1513    13112    4            KL_DREC.FLAGS.TPOK = KL_DFLT.FLAGS.TPOK;
     1514    13113    4            END;
     1515    13114    3         END;
     1516    13115    2      END;
     1517    13116    2   IF AS_MOD_USER.PRIV ~= '0'B THEN DO;
     1518    13117    3      DO I = 0 TO SIZEW(AS_PRIV_NAMES)*4-1;
     1519    13118    4         IF AS_MOD_USER.PRIV_A(I) ~= 0 THEN DO;
     1520    13119    4            J = I / 4;
     1521    13120    4            K = MOD( I, 4 );
     1522    13121    4            IF AS_MOD_USER.PRIV_A(I) = YES_VAL THEN
     1523    13122    4               AS_USERS.PRIV(K) = AS_USERS.PRIV(K) | AS_PRIVILEGE(J);
     1524    13123    4            ELSE
     1525    13124    4               AS_USERS.PRIV(K) = AS_USERS.PRIV(K) & ~AS_PRIVILEGE(J) ;
     1526    13125    4            END;
     1527    13126    3         END;
     1528    13127    2      END;
     1529    13128    2   IF AS_MOD_USER.PPRIV ~= '0'B THEN DO;
     1530    13129    3      DO I = 0 TO SIZEW(AS_PPRIV_NAMES)*4-1;
     1531    13130    4         IF AS_MOD_USER.PPRIV_A(I) ~= 0 THEN DO;
     1532    13131    4            J = I / 4;
     1533    13132    4            K = MOD( I, 4 );
     1534    13133    4            IF AS_MOD_USER.PPRIV_A(I) = YES_VAL THEN
     1535    13134    4               AS_USERS.PPRIV(K) = AS_USERS.PPRIV(K) | AS_PPRIVILEGE(J);
     1536    13135    4            ELSE
     1537    13136    4               AS_USERS.PPRIV(K) = AS_USERS.PPRIV(K) & ~AS_PPRIVILEGE(J);
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:262  
     1538    13137    4            END;
     1539    13138    3         END;
     1540    13139    2      END;
     1541    13140    2   IF AS_MOD_USER.FEPRIV ~= '0'B THEN DO;
     1542    13141    3      DO I = 0 TO SIZEW(AS_PRIV_NAMES)*4-1;
     1543    13142    4         IF AS_MOD_USER.FEPRIV_A(I) ~= 0 THEN DO;
     1544    13143    4            J = I / 4;
     1545    13144    4            K = MOD( I, 4 );
     1546    13145    4            IF AS_MOD_USER.FEPRIV_A(I) = YES_VAL THEN
     1547    13146    4               KL_DREC.KL_DREC_FEBLK.PRIV(K) = KL_DREC.KL_DREC_FEBLK.PRIV(K) |
             13146                        AS_PRIVILEGE(J);
     1548    13147    4            ELSE
     1549    13148    4               KL_DREC.KL_DREC_FEBLK.PRIV(K) = KL_DREC.KL_DREC_FEBLK.PRIV(K) & ~
             13148                        AS_PRIVILEGE(J) ;
     1550    13149    4            END;
     1551    13150    3         END;
     1552    13151    2      END;
     1553    13152    2   IF AS_MOD_USER.FEPPRIV ~= '0'B THEN DO;
     1554    13153    3      DO I = 0 TO SIZEW(AS_PPRIV_NAMES)*4-1;
     1555    13154    4         IF AS_MOD_USER.FEPPRIV_A(I) ~= 0 THEN DO;
     1556    13155    4            J = I / 4;
     1557    13156    4            K = MOD( I, 4 );
     1558    13157    4            IF AS_MOD_USER.FEPPRIV_A(I) = YES_VAL THEN
     1559    13158    4               KL_DREC.KL_DREC_FEBLK.PPRIV(K) = KL_DREC.KL_DREC_FEBLK.PPRIV(K) |
             13158                        AS_PPRIVILEGE(J);
     1560    13159    4            ELSE
     1561    13160    4               KL_DREC.KL_DREC_FEBLK.PPRIV(K) = KL_DREC.KL_DREC_FEBLK.PPRIV(K) & ~
             13160                        AS_PPRIVILEGE(J);
     1562    13161    4            END;
     1563    13162    3         END;
     1564    13163    2      END;
     1565    13164    2   IF AS_MOD_USER.QUAN ~= '0'B THEN DO ;
     1566    13165    3      DO I = 0 TO 3;
     1567    13166    3         IF AS_MOD_USER.QUAN_A(I) THEN
     1568    13167    3            AS_USERS.QUAN(I) = AS_DFLT.QUAN(I) ;
     1569    13168    3         END ;
     1570    13169    2      END ;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:263  
     1571    13170    2   IF AS_MOD_USER.MAXENQ ~= '0'B THEN DO ;
     1572    13171    3      DO I = 0 TO 3;
     1573    13172    3         IF AS_MOD_USER.MAXENQ_A(I) THEN
     1574    13173    3            AS_USERS.MAXENQ(I) = AS_DFLT.MAXENQ(I) ;
     1575    13174    3         END ;
     1576    13175    2      END ;
     1577    13176    2   IF AS_MOD_USER.PRIOB ~= '0'B THEN DO ;
     1578    13177    3      DO I = 0 TO 3;
     1579    13178    3         IF AS_MOD_USER.PRIOB_A(I) THEN
     1580    13179    3            AS_USERS.PRIOB(I) = AS_DFLT.PRIOB(I) ;
     1581    13180    3         END ;
     1582    13181    2      END ;
     1583    13182    2   IF AS_MOD_USER.BUDGET ~= '0'B THEN DO;
     1584    13183    2      IF AS_MOD_USER.BUDGET.PCHARGES THEN
     1585    13184    2         AS_USERS.BUDGET.PCHARGES = AS_DFLT.BUDGET.PCHARGES;
     1586    13185    2      IF AS_MOD_USER.BUDGET.MACCT THEN
     1587    13186    2         AS_USERS.BUDGET.MACCT = AS_DFLT.BUDGET.MACCT;
     1588    13187    2      IF AS_MOD_USER.BUDGET.ICHARGES THEN
     1589    13188    2         AS_USERS.BUDGET.ICHARGES = AS_DFLT.BUDGET.ICHARGES;
     1590    13189    2      IF AS_MOD_USER.BUDGET.BKACC THEN
     1591    13190    2         AS_USERS.BUDGET.BKACC = AS_DFLT.BUDGET.BKACC;
     1592    13191    2      IF AS_MOD_USER.BUDGET.BUDLIM THEN
     1593    13192    2         AS_USERS.BUDGET.BUDLIM = AS_DFLT.BUDGET.BUDLIM;
     1594    13193    2      IF AS_MOD_USER.BUDGET.BLINDACCTNG THEN
     1595    13194    2         AS_USERS.BUDGET.BLINDACCTNG = AS_DFLT.BUDGET.BLINDACCTNG;
     1596    13195    2      IF AS_MOD_USER.BUDGET.MAXC THEN
     1597    13196    2         IF ((AS_WILD_MVAL = -1) AND (NOT AS_MOD_USER.BUDGET.SIGN))
     1598    13197    2              OR ((AS_USERS.BUDGET.MAXC = -1) AND AS_MOD_USER.BUDGET.SIGN)
     1599    13198    2         THEN
     1600    13199    2            AS_USERS.BUDGET.MAXC = -1 ;
     1601    13200    3         ELSE DO;
     1602    13201    3            SAVE_MAXC = AS_USERS.BUDGET.MAXC;
     1603    13202    3            IF NOT AS_MOD_USER.BUDGET.SIGN THEN
     1604    13203    3               AS_USERS.BUDGET.MAXC = AS_WILD_MVAL ;
     1605    13204    3            ELSE
     1606    13205    3               AS_USERS.BUDGET.MAXC = AS_WILD_MVAL + AS_USERS.BUDGET.MAXC ;
     1607    13206    4            IF AS_USERS.BUDGET.MAXC < 0 THEN DO;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:264  
     1608    13207                    %SCREAM(ERR#=E$MCHARGES_NEG_VAL,LEVEL=ERROR,MID='C') ;
     1609    13222    4               AS_USERS.BUDGET.MAXC = SAVE_MAXC;
     1610    13223    4               END;
     1611    13224    3            IF AS_CR_MOD_PROJ > 0 AND AS_WILD_MCH > 0
     1612    13225    3            THEN
     1613    13226    3               IF AS_USERS.BUDGET.MAXC > AS_WILD_MCH
     1614    13227    4               THEN DO;
     1615    13228    4                  AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
     1616    13229    4                  VALUE(0) = AS_WILD_MCH / 10000;
     1617    13230    4                  VALUE(1) = MOD( AS_WILD_MCH, 10000 ) / 100;
     1618    13231                       %NUMBER( NUM2="VALUE(0)", NUM3="VALUE(1)" );
             13247    4         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VALUE(0) );
             13255    4         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, VALUE(1) );
     1619    13261    4                  IF AS_FIELD3.COUNT = 1
     1620    13262    5                  THEN DO;
     1621    13263    5                     AS_FIELD3.COUNT = 2;
     1622    13264    5                     CALL INSERT( AS_FIELD3.TEXT, 1, 1, '0' );
     1623    13265    5                     END;
     1624    13266                       %SCREAM( ERR#=E$MCHARGES_TOO_LARGE, LEVEL=ERROR, MID='C' );
     1625    13281    4                  AS_USERS.BUDGET.MAXC = AS_WILD_MCH;
     1626    13282    4                  END;
     1627    13283    3            END;
     1628    13284    2      IF AS_MOD_USER.BUDGET.ACCUM THEN
     1629    13285    2         AS_USERS.BUDGET.ACCUM = AS_DFLT.BUDGET.ACCUM;
     1630    13286    2      END;
     1631    13287    2   IF AS_MOD_USER.KEY ~= '0'B THEN DO;
     1632    13288    3      DO I = 0 TO 71;
     1633    13289    3         IF AS_MOD_USER.KEY_A(I) > 0 THEN
     1634    13290    3            AS_USERS.KEY(I) = AS_DFLT.KEY(I);
     1635    13291    3         END;
     1636    13292    2      END;
     1637    13293    1   IF AS_MOD_USER.LIMITS ~= '0'B THEN CALL ASC$MOD_USER_LIMITS;
     1638    13294    1   IF AS_MOD_USER.RESOURCE THEN CALL ASC$RESOURCE( AS_TRUE );
     1639    13295    1   IF AS_MOD_USER.FERESOURCE THEN CALL ASC$FERESOURCE( AS_TRUE );
     1640    13296    1   IF AS_MOD_USER.PSEUDO THEN CALL ASC$PSEUDO( AS_TRUE );
     1641    13297    1   IF AS_MOD_USER.FEPSEUDO THEN CALL ASC$FEPSEUDO( AS_TRUE );
     1642    13298    2   IF AS_MOD_USER.FACCOUNT THEN DO;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:265  
     1643    13299    2      SUPER_TO_PIG.TYPE = %MODIFY_ACCT;
     1644    13300    2      SUPER_TO_PIG.ACCT = AS_USERS.ACCT;
     1645    13301    2      SUPER_TO_PIG.PACKSET = AS_USERS.HPSN;
     1646    13302    2      CALL ASB$PIG( SUPER_TO_PIG );
     1647    13303    2      END;
     1648    13304
     1649    13305    1   END ASC$MOD_USER ;

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:266  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$MOD_USER.

   Procedure ASC$MOD_USER requires 897 words for executable code.
   Procedure ASC$MOD_USER requires 16 words of local(AUTO) storage.

    No errors detected in file ASC$OPTS.:E05TSI    .

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:267  

 Object Unit name= ASC$MOD_USER                               File name= ASC$OPTS.:E05TOU
 UTS= JUL 29 '97 09:41:36.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS     18     22  ASC$MOD_USER
    3   Proc  even  none   897   1601  ASC$MOD_USER
    4  RoData even  none    18     22  ASC$MOD_USER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASC$MOD_USER
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:268  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       4 ASB$BINCHAR
         yes           Std       1 ASC$FERESOURCE
 yes     yes           Std       1 ASB$PIG
 yes     yes           Std       3 ASC$SETUP
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASC$MOD_USER_LIMITS
         yes           Std       1 ASC$RESOURCE
         yes           Std       1 ASC$FEPSEUDO
         yes           Std       1 ASC$PSEUDO
 yes     yes           Std       3 ASC$BANNER
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_TRUE                          r    AS_PRIV_NAMES
r    AS_PPRIV_NAMES                   r    AS_PRIVILEGE                     r    AS_PPRIVILEGE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     AS_FIELD3                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          AS_SUPER_TO_PIG$                      AS_CR_MOD_PROJ
     AS_WILD_MCH                           AS_WILD_MVAL                          AS_USERS
     AS_DFLT                               KL_DREC                               KL_DFLT
     AS_MOD_USER                           B_VECTNIL
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:269  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:270  


     1319        1        /*T***********************************************************/
     1320        2        /*T*                                                         */
     1321        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1322        4        /*T*                                                         */
     1323        5        /*T***********************************************************/
     1324        6        ASC$MOD_USER: PROC;

      6  3 000000   000000 700200 xent  ASC$MOD_USER TSX0  ! X66_AUTO_0
         3 000001   000020 000000                    ZERO    16,0

     1325        7
     1326        8
     1327        9        /********************************************************************/
     1328       10        /*    Include files       include files       include files         */
     1329       11        /********************************************************************/
     1330       12
     1331       13        %INCLUDE      AS_ENTRIES_M ;
     1332     1063        %INCLUDE      AS_SUPER_C ;
     1333     1498        %INCLUDE      AS_SUBS_C ;
     1334     2912        %INCLUDE      AS_PERR_C ;
     1335     3514        %INCLUDE      KL_SUPER_C ;
     1336     6416        %INCLUDE      AS_MAC_C ;
     1337     6496        %INCLUDE      XU_MACRO_C ;
     1338     9602        %INCLUDE      XU_FORMAT_C ;
     1339     9764        %INCLUDE      CP_6 ;
     1340     9845        %INCLUDE      AS_SUPER_R ;
     1341    12861
     1342    12862        /********************************************************************/
     1343    12863        /*    Auto data       auto data       auto data       auto data     */
     1344    12864        /********************************************************************/
     1345    12865
     1346    12866    1   DCL I SBIN;
     1347    12867    1   DCL J SBIN;
     1348    12868    1   DCL K SBIN;
     1349    12869    1   DCL VAL SBIN;
     1350    12870    1   DCL SAVE_MAXC   SBIN ;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:271  
     1351    12871    1   DCL SET$ PTR;
     1352    12872    1   DCL VALUE(0:1) SBIN ;
     1353    12873    1   DCL 1 TEXTC(0:2) CONSTANT,
     1354    12874    1          2 CNT UBIN BYTE UNAL INIT( 4, 6, 17 ),
     1355    12875    1          2 TEXT CHAR(17) INIT( 'user', 'project', 'user in a project' );
     1356    12876    1   DCL 1 VARY$STR BASED(SET$) ALIGNED ,
     1357    12877    1          2 CNT UBIN(9) UNAL ,
     1358    12878    1          2 TEXT CHAR(VARY$STR.CNT) ;
     1359    12879    1   DCL 1 ZERO_LENGTH CONSTANT,
     1360    12880    1          2 CNT  UBIN(9) CALIGNED INIT (0),
     1361    12881    1          2 TEXT CHAR(1) CALIGNED INIT (' ');
     1362    12882
     1363    12883        /********************************************************************/
     1364    12884        /*    Entry dcls      entry dcls      entry dcls      entry dcls    */
     1365    12885        /********************************************************************/
     1366    12886
     1367    12887        %ASC$MOD_USER_LIMITS ;
     1368    12890        %ASC$RESOURCE ;
     1369    12893        %ASC$FERESOURCE ;
     1370    12896        %ASC$PSEUDO ;
     1371    12899        %ASC$FEPSEUDO ;
     1372    12902        %ASB$PIG ;
     1373    12905        %ASH$ERROR ;
     1374    12908        %ASC$BANNER ;
     1375    12911        %ASH$WARN ;
     1376    12914        %ASC$SETUP ;
     1377    12917
     1378    12918        /********************************************************************/
     1379    12919        /*    Local based     local based     local based     local based   */
     1380    12920        /********************************************************************/
     1381    12921
     1382    12922        %SUPER_TO_PIG( STCLASS="BASED(AS_SUPER_TO_PIG$)" );
     1383    12954        /********************************************************************/
     1384    12955        /*    Procedure       procedure       procedure       procedure     */
     1385    12956        /********************************************************************/
     1386    12957
     1387    12958
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:272  
     1388    12959
     1389    12960    1   IF AS_MOD_USER.PASSWORD THEN KL_DREC.PASSWORD = KL_DFLT.PASSWORD;

  12960  3 000002   000000 234000 xsym               SZN     AS_MOD_USER
         3 000003   000007 605000 3                  TPL     s:12961

  12960  3 000004   040000 100400                    MLR     fill='040'O
         3 000005   000002 000010 xsym               ADSC9   KL_DFLT+2                cn=0,n=8
         3 000006   000002 000010 xsym               ADSC9   KL_DREC+2                cn=0,n=8

     1390    12961    1   IF AS_MOD_USER.NAT_LANG THEN AS_USERS.NAT_LANG = AS_DFLT.NAT_LANG;

  12961  3 000007   000000 236000 xsym               LDQ     AS_MOD_USER
         3 000010   200000 316003                    CANQ    65536,DU
         3 000011   000014 600000 3                  TZE     s:12962

  12961  3 000012   000005 236000 xsym               LDQ     AS_DFLT+5
         3 000013   000005 552040 xsym               STBQ    AS_USERS+5,'40'O

     1391    12962    1   IF AS_MOD_USER.STEPACCNT THEN AS_USERS.STEPACCNT = AS_DFLT.STEPACCNT;

  12962  3 000014   000000 236000 xsym               LDQ     AS_MOD_USER
         3 000015   100000 316003                    CANQ    32768,DU
         3 000016   000023 600000 3                  TZE     s:12963

  12962  3 000017   000005 236000 xsym               LDQ     AS_DFLT+5
         3 000020   000005 676000 xsym               ERQ     AS_USERS+5
         3 000021   000400 376003                    ANQ     256,DU
         3 000022   000005 656000 xsym               ERSQ    AS_USERS+5

     1392    12963    1   IF AS_MOD_USER.BATNUM THEN AS_USERS.BATNUM = AS_DFLT.BATNUM;

  12963  3 000023   000000 236000 xsym               LDQ     AS_MOD_USER
         3 000024   040000 316003                    CANQ    16384,DU
         3 000025   000030 600000 3                  TZE     s:12964

  12963  3 000026   000005 720000 xsym               LXL0    AS_DFLT+5
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:273  
         3 000027   000005 440000 xsym               SXL0    AS_USERS+5

     1393    12964    1   IF AS_MOD_USER.FEMFPRG THEN KL_DREC.KL_DREC_FEBLK.MFPRG = KL_DFLT.KL_DFLT_FEBLK.
             12964            MFPRG;

  12964  3 000030   000030 236000 xsym               LDQ     AS_MOD_USER+24
         3 000031   100000 316007                    CANQ    32768,DL
         3 000032   000035 600000 3                  TZE     s:12965

  12964  3 000033   000031 236000 xsym               LDQ     KL_DFLT+25
         3 000034   000031 552040 xsym               STBQ    KL_DREC+25,'40'O

     1394    12965    1   IF AS_MOD_USER.FEMACCTMEM THEN KL_DREC.KL_DREC_FEBLK.MACCTMEM = KL_DFLT.
             12965            KL_DFLT_FEBLK.MACCTMEM;

  12965  3 000035   000050 236000 xsym               LDQ     AS_MOD_USER+40
         3 000036   000100 316007                    CANQ    64,DL
         3 000037   000042 600000 3                  TZE     s:12966

  12965  3 000040   000031 236000 xsym               LDQ     KL_DFLT+25
         3 000041   000031 552030 xsym               STBQ    KL_DREC+25,'30'O

     1395    12966    1   IF AS_MOD_USER.FEDBACCN THEN KL_DREC.KL_DREC_FEBLK.DBACCN = KL_DFLT.KL_DFLT_FEBLK.
             12966            DBACCN;

  12966  3 000042   000050 236000 xsym               LDQ     AS_MOD_USER+40
         3 000043   000040 316007                    CANQ    32,DL
         3 000044   000050 600000 3                  TZE     s:12967

  12966  3 000045   040000 100400                    MLR     fill='040'O
         3 000046   000026 000010 xsym               ADSC9   KL_DFLT+22               cn=0,n=8
         3 000047   000026 000010 xsym               ADSC9   KL_DREC+22               cn=0,n=8

     1396    12967    1   IF AS_MOD_USER.STARSACC THEN

  12967  3 000050   000000 236000 xsym               LDQ     AS_MOD_USER
         3 000051   020000 316003                    CANQ    8192,DU
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:274  
         3 000052   000057 600000 3                  TZE     s:12970

     1397    12968    1      AS_USERS.FLAGS.STARSACC = AS_DFLT.FLAGS.STARSACC;

  12968  3 000053   000244 236000 xsym               LDQ     AS_DFLT+164
         3 000054   000244 676000 xsym               ERQ     AS_USERS+164
         3 000055   010000 376003                    ANQ     4096,DU
         3 000056   000244 656000 xsym               ERSQ    AS_USERS+164

     1398    12969    1   IF AS_MOD_USER.SETUP ~= '0'B THEN ;

     1399    12970    2   DO I = 0 TO 3;

  12970  3 000057   200003 450100                    STZ     I,,AUTO

     1400    12971    3      IF AS_MOD_USER.SETUP_A(I) THEN DO ;

  12971  3 000060   200003 235100                    LDA     I,,AUTO
         3 000061   000063 605000 3                  TPL     s:12971+3
         3 000062   000044 035003                    ADLA    36,DU
         3 000063   000000 066405                    CMPB    filb='0'B
         3 000064   000000 050001 xsym               BDSC    AS_MOD_USER,A            by=0,bit=5,n=1
         3 000065   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000066   000130 600000 3                  TZE     s:12996

     1401    12972    3         J = AS_DFLT.SETUP(I) ;

  12972  3 000067   200003 235100                    LDA     I,,AUTO
         3 000070   000001 735000                    ALS     1
         3 000071   000100 100405                    MLR     fill='000'O
         3 000072   000352 000002 xsym               ADSC9   AS_DFLT+234,A            cn=0,n=2
         3 000073   200014 000004                    ADSC9   VALUE+3,,AUTO            cn=0,n=4
         3 000074   200014 236100                    LDQ     VALUE+3,,AUTO
         3 000075   000022 732000                    QRS     18
         3 000076   200004 756100                    STQ     J,,AUTO

     1402    12973    3         IF J = - 1 THEN
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:275  

  12973  3 000077   000027 116000 xsym               CMPQ    B_VECTNIL+23
         3 000100   000104 601000 3                  TNZ     s:12976

     1403    12974    3            SET$ = ADDR (ZERO_LENGTH);

  12974  3 000101   000000 236000 4                  LDQ     0
         3 000102   200010 756100                    STQ     SET$,,AUTO
         3 000103   000107 710000 3                  TRA     s:12977

     1404    12975    3         ELSE
     1405    12976    3            SET$ = ADDR( AS_DFLT.SETUP_CHRA.TXT_UBIN(J)) ;

  12976  3 000104   000020 736000                    QLS     16
         3 000105   000001 036000 4                  ADLQ    1
         3 000106   200010 756100                    STQ     SET$,,AUTO

     1406    12977    3         CALL ASC$SETUP( ADDR(AS_USERS), I, SET$->VARY$STR)

  12977  3 000107   000002 236000 4                  LDQ     2
         3 000110   200014 756100                    STQ     VALUE+3,,AUTO
         3 000111   200010 236100                    LDQ     SET$,,AUTO
         3 000112   200017 756100                    STQ     VALUE+6,,AUTO
         3 000113   200003 630500                    EPPR0   I,,AUTO
         3 000114   200016 450500                    STP0    VALUE+5,,AUTO
         3 000115   200014 631500                    EPPR1   VALUE+3,,AUTO
         3 000116   200015 451500                    STP1    VALUE+4,,AUTO
         3 000117   200015 630500                    EPPR0   VALUE+4,,AUTO
         3 000120   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000121   000000 701000 xent               TSX1    ASC$SETUP
         3 000122   000124 702000 3                  TSX2    s:12991
         3 000123   000130 710000 3                  TRA     s:12996

     1407    12978    4         WHENALTRETURN DO;

     1408    12979                 %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:276  
  12991  3 000124   000003 630400 4                  EPPR0   3
         3 000125   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000126   000000 701000 xent               TSX1    ASH$ERROR
         3 000127   000000 011000                    NOP     0

     1409    12994    4            END;

     1410    12995    3         END ;

     1411    12996    2      END ;

  12996  3 000130   200003 054100                    AOS     I,,AUTO
         3 000131   200003 235100                    LDA     I,,AUTO
         3 000132   000003 115007                    CMPA    3,DL
         3 000133   000060 604400 3                  TMOZ    s:12971

     1412    12997    2   IF AS_MOD_USER.PERM_BIT ~= '0'B THEN DO;

  12997  3 000134   000000 236000 xsym               LDQ     AS_MOD_USER
         3 000135   000740 316003                    CANQ    480,DU
         3 000136   000164 600000 3                  TZE     s:13004

     1413    12998    3      DO I = 0 TO 3 ;

  12998  3 000137   200003 450100                    STZ     I,,AUTO

     1414    12999    3         IF AS_MOD_USER.PERM_A(I) THEN

  12999  3 000140   200003 235100                    LDA     I,,AUTO
         3 000141   000143 605000 3                  TPL     s:12999+3
         3 000142   000044 035003                    ADLA    36,DU
         3 000143   000000 066405                    CMPB    filb='0'B
         3 000144   000000 200001 xsym               BDSC    AS_MOD_USER,A            by=1,bit=0,n=1
         3 000145   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000146   000160 600000 3                  TZE     s:13001

     1415    13000    3            AS_USERS.SETUP_PERM(I) = AS_DFLT.SETUP_PERM(I) ;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:277  

  13000  3 000147   200003 235100                    LDA     I,,AUTO
         3 000150   000152 605000 3                  TPL     s:13000+3
         3 000151   000044 035003                    ADLA    36,DU
         3 000152   200003 236100                    LDQ     I,,AUTO
         3 000153   000155 605000 3                  TPL     s:13000+6
         3 000154   000044 036003                    ADLQ    36,DU
         3 000155   003006 060405                    CSL     bolr='003'O
         3 000156   000351 400001 xsym               BDSC    AS_DFLT+233,A            by=2,bit=0,n=1
         3 000157   000351 400001 xsym               BDSC    AS_USERS+233,Q           by=2,bit=0,n=1

     1416    13001    3         END ;

  13001  3 000160   200003 054100                    AOS     I,,AUTO
         3 000161   200003 235100                    LDA     I,,AUTO
         3 000162   000003 115007                    CMPA    3,DL
         3 000163   000140 604400 3                  TMOZ    s:12999

     1417    13002    2      END ;

     1418    13003    1   IF AS_MOD_USER.BANNER~= '0'B THEN ;

     1419    13004    2   DO I = 0 TO 9;

  13004  3 000164   200003 450100                    STZ     I,,AUTO

     1420    13005    3      IF AS_MOD_USER.BANNER_A(I) THEN DO ;

  13005  3 000165   200003 235100                    LDA     I,,AUTO
         3 000166   000170 605000 3                  TPL     s:13005+3
         3 000167   000044 035003                    ADLA    36,DU
         3 000170   000000 066405                    CMPB    filb='0'B
         3 000171   000000 300001 xsym               BDSC    AS_MOD_USER,A            by=1,bit=8,n=1
         3 000172   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000173   000235 600000 3                  TZE     s:13030

     1421    13006    3         J = AS_DFLT.BANNER(I) ;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:278  

  13006  3 000174   200003 235100                    LDA     I,,AUTO
         3 000175   000001 735000                    ALS     1
         3 000176   000100 100405                    MLR     fill='000'O
         3 000177   000354 000002 xsym               ADSC9   AS_DFLT+236,A            cn=0,n=2
         3 000200   200014 000004                    ADSC9   VALUE+3,,AUTO            cn=0,n=4
         3 000201   200014 236100                    LDQ     VALUE+3,,AUTO
         3 000202   000022 732000                    QRS     18
         3 000203   200004 756100                    STQ     J,,AUTO

     1422    13007    3         IF J = - 1 THEN

  13007  3 000204   000027 116000 xsym               CMPQ    B_VECTNIL+23
         3 000205   000211 601000 3                  TNZ     s:13010

     1423    13008    3            SET$ = ADDR (ZERO_LENGTH);

  13008  3 000206   000000 236000 4                  LDQ     0
         3 000207   200010 756100                    STQ     SET$,,AUTO
         3 000210   000214 710000 3                  TRA     s:13011

     1424    13009    3         ELSE
     1425    13010    3            SET$ = ADDR( AS_DFLT.SETUP_CHRA.TXT_UBIN(J)) ;

  13010  3 000211   000020 736000                    QLS     16
         3 000212   000001 036000 4                  ADLQ    1
         3 000213   200010 756100                    STQ     SET$,,AUTO

     1426    13011    3         CALL ASC$BANNER(ADDR(AS_USERS),I,VARY$STR)

  13011  3 000214   000002 236000 4                  LDQ     2
         3 000215   200014 756100                    STQ     VALUE+3,,AUTO
         3 000216   200010 236100                    LDQ     SET$,,AUTO
         3 000217   200017 756100                    STQ     VALUE+6,,AUTO
         3 000220   200003 630500                    EPPR0   I,,AUTO
         3 000221   200016 450500                    STP0    VALUE+5,,AUTO
         3 000222   200014 631500                    EPPR1   VALUE+3,,AUTO
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:279  
         3 000223   200015 451500                    STP1    VALUE+4,,AUTO
         3 000224   200015 630500                    EPPR0   VALUE+4,,AUTO
         3 000225   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000226   000000 701000 xent               TSX1    ASC$BANNER
         3 000227   000231 702000 3                  TSX2    s:13025
         3 000230   000235 710000 3                  TRA     s:13030

     1427    13012    4         WHENALTRETURN DO;

     1428    13013                 %SCREAM(ERR#=E$ALL_BANNER_SPACE_USED,LEVEL=ERROR,MID='C');

  13025  3 000231   000003 630400 4                  EPPR0   3
         3 000232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000233   000000 701000 xent               TSX1    ASH$ERROR
         3 000234   000000 011000                    NOP     0

     1429    13028    4            END;

     1430    13029    3         END ;

     1431    13030    2      END ;

  13030  3 000235   200003 054100                    AOS     I,,AUTO
         3 000236   200003 235100                    LDA     I,,AUTO
         3 000237   000011 115007                    CMPA    9,DL
         3 000240   000165 604400 3                  TMOZ    s:13005

     1432    13031    1   IF AS_MOD_USER.BANNER_PERM ~= '0'B THEN

  13031  3 000241   000000 066400                    CMPB    filb='0'B
         3 000242   000000 600012 xsym               BDSC    AS_MOD_USER              by=3,bit=0,n=10
         3 000243   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000244   000272 600000 3                  TZE     s:13036

     1433    13032    2   DO I = 0 TO 9 ;

  13032  3 000245   200003 450100                    STZ     I,,AUTO
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:280  

     1434    13033    2      IF AS_MOD_USER.BANNER_PERM_A(I) THEN

  13033  3 000246   200003 235100                    LDA     I,,AUTO
         3 000247   000251 605000 3                  TPL     s:13033+3
         3 000250   000044 035003                    ADLA    36,DU
         3 000251   000000 066405                    CMPB    filb='0'B
         3 000252   000000 600001 xsym               BDSC    AS_MOD_USER,A            by=3,bit=0,n=1
         3 000253   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000254   000266 600000 3                  TZE     s:13035

     1435    13034    2         AS_USERS.BANNER_PERM(I) = AS_DFLT.BANNER_PERM(I) ;

  13034  3 000255   200003 235100                    LDA     I,,AUTO
         3 000256   000260 605000 3                  TPL     s:13034+3
         3 000257   000044 035003                    ADLA    36,DU
         3 000260   200003 236100                    LDQ     I,,AUTO
         3 000261   000263 605000 3                  TPL     s:13034+6
         3 000262   000044 036003                    ADLQ    36,DU
         3 000263   003006 060405                    CSL     bolr='003'O
         3 000264   000351 440001 xsym               BDSC    AS_DFLT+233,A            by=2,bit=4,n=1
         3 000265   000351 440001 xsym               BDSC    AS_USERS+233,Q           by=2,bit=4,n=1

     1436    13035    2      END ;

  13035  3 000266   200003 054100                    AOS     I,,AUTO
         3 000267   200003 235100                    LDA     I,,AUTO
         3 000270   000011 115007                    CMPA    9,DL
         3 000271   000246 604400 3                  TMOZ    s:13033

     1437    13036    2   IF AS_MOD_USER.CPROC ~= '0'B THEN DO;

  13036  3 000272   000001 236000 xsym               LDQ     AS_MOD_USER+1
         3 000273   360000 316003                    CANQ    122880,DU
         3 000274   000316 600000 3                  TZE     s:13042

     1438    13037    3      DO I = 0 TO 3;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:281  

  13037  3 000275   200003 450100                    STZ     I,,AUTO

     1439    13038    3         IF AS_MOD_USER.CPROC_A(I) THEN

  13038  3 000276   200003 235100                    LDA     I,,AUTO
         3 000277   000301 605000 3                  TPL     s:13038+3
         3 000300   000044 035003                    ADLA    36,DU
         3 000301   000000 066405                    CMPB    filb='0'B
         3 000302   000001 010001 xsym               BDSC    AS_MOD_USER+1,A          by=0,bit=1,n=1
         3 000303   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000304   000312 600000 3                  TZE     s:13040

     1440    13039    3            AS_USERS.CPROC.NAME(I) = AS_DFLT.CPROC.NAME(I);

  13039  3 000305   200003 235100                    LDA     I,,AUTO
         3 000306   000005 735000                    ALS     5
         3 000307   000005 100405                    MLR     fill='000'O
         3 000310   000125 000040 xsym               ADSC9   AS_DFLT+85,A             cn=0,n=32
         3 000311   000125 000040 xsym               ADSC9   AS_USERS+85,A            cn=0,n=32

     1441    13040    3         END;

  13040  3 000312   200003 054100                    AOS     I,,AUTO
         3 000313   200003 235100                    LDA     I,,AUTO
         3 000314   000003 115007                    CMPA    3,DL
         3 000315   000276 604400 3                  TMOZ    s:13038

     1442    13041    2      END;

     1443    13042    1   IF (AS_MOD_USER.LAST_LOGON_TIME ~= '0'B)

  13042  3 000316   000051 236000 xsym               LDQ     AS_MOD_USER+41
         3 000317   004000 316003                    CANQ    2048,DU
         3 000320   000323 600000 3                  TZE     s:13047

     1444    13043    2   THEN DO;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:282  

     1445    13044    2      AS_USERS.LAST_LOGON_TIME = AS_DFLT.LAST_LOGON_TIME;

  13044  3 000321   000762 236000 xsym               LDQ     AS_DFLT+498
         3 000322   000762 756000 xsym               STQ     AS_USERS+498

     1446    13045    2      END;

     1447    13046
     1448    13047    1   IF (AS_MOD_USER.FORCE_BIT ~= '0'B)

  13047  3 000323   000000 236000 xsym               LDQ     AS_MOD_USER
         3 000324   000036 316003                    CANQ    30,DU
         3 000325   000353 600000 3                  TZE     s:13056

     1449    13048    2   THEN DO;

     1450    13049    3      DO I = 0 TO 3;

  13049  3 000326   200003 450100                    STZ     I,,AUTO

     1451    13050    3         IF (AS_MOD_USER.FORCE_A (I) = AS_TRUE)

  13050  3 000327   200003 235100                    LDA     I,,AUTO
         3 000330   000332 605000 3                  TPL     s:13050+3
         3 000331   000044 035003                    ADLA    36,DU
         3 000332   000000 066405                    CMPB    filb='0'B
         3 000333   000000 240001 xsym               BDSC    AS_MOD_USER,A            by=1,bit=4,n=1
         3 000334   000000 000001 xsym               BDSC    AS_TRUE                  by=0,bit=0,n=1
         3 000335   000347 601000 3                  TNZ     s:13054

     1452    13051    4         THEN DO;

     1453    13052    4            AS_USERS.SETUP_FORCE (I) = AS_DFLT.SETUP_FORCE (I);

  13052  3 000336   200003 235100                    LDA     I,,AUTO
         3 000337   000341 605000 3                  TPL     s:13052+3
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:283  
         3 000340   000044 035003                    ADLA    36,DU
         3 000341   200003 236100                    LDQ     I,,AUTO
         3 000342   000344 605000 3                  TPL     s:13052+6
         3 000343   000044 036003                    ADLQ    36,DU
         3 000344   003006 060405                    CSL     bolr='003'O
         3 000345   000351 650001 xsym               BDSC    AS_DFLT+233,A            by=3,bit=5,n=1
         3 000346   000351 650001 xsym               BDSC    AS_USERS+233,Q           by=3,bit=5,n=1

     1454    13053    4            END;

     1455    13054    3         END;

  13054  3 000347   200003 054100                    AOS     I,,AUTO
         3 000350   200003 235100                    LDA     I,,AUTO
         3 000351   000003 115007                    CMPA    3,DL
         3 000352   000327 604400 3                  TMOZ    s:13050

     1456    13055    2      END;

     1457    13056    2   IF AS_MOD_USER.LASTCPROC ~= '0'B THEN DO;

  13056  3 000353   000001 236000 xsym               LDQ     AS_MOD_USER+1
         3 000354   017000 316003                    CANQ    7680,DU
         3 000355   000377 600000 3                  TZE     s:13062

     1458    13057    3      DO I = 0 TO 3;

  13057  3 000356   200003 450100                    STZ     I,,AUTO

     1459    13058    3         IF AS_MOD_USER.LASTCPROC_A(I) THEN

  13058  3 000357   200003 235100                    LDA     I,,AUTO
         3 000360   000362 605000 3                  TPL     s:13058+3
         3 000361   000044 035003                    ADLA    36,DU
         3 000362   000000 066405                    CMPB    filb='0'B
         3 000363   000001 050001 xsym               BDSC    AS_MOD_USER+1,A          by=0,bit=5,n=1
         3 000364   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:284  
         3 000365   000373 600000 3                  TZE     s:13060

     1460    13059    3            AS_USERS.LASTCPROC.NAME(I) = AS_DFLT.LASTCPROC.NAME(I);

  13059  3 000366   200003 235100                    LDA     I,,AUTO
         3 000367   000005 735000                    ALS     5
         3 000370   000005 100405                    MLR     fill='000'O
         3 000371   000165 000040 xsym               ADSC9   AS_DFLT+117,A            cn=0,n=32
         3 000372   000165 000040 xsym               ADSC9   AS_USERS+117,A           cn=0,n=32

     1461    13060    3         END;

  13060  3 000373   200003 054100                    AOS     I,,AUTO
         3 000374   200003 235100                    LDA     I,,AUTO
         3 000375   000003 115007                    CMPA    3,DL
         3 000376   000357 604400 3                  TMOZ    s:13058

     1462    13061    2      END;

     1463    13062    2   IF AS_MOD_USER.BILL ~= '0'B THEN DO;

  13062  3 000377   000001 236000 xsym               LDQ     AS_MOD_USER+1
         3 000400   000740 316003                    CANQ    480,DU
         3 000401   000423 600000 3                  TZE     s:13068

     1464    13063    3      DO I = 0 TO 3;

  13063  3 000402   200003 450100                    STZ     I,,AUTO

     1465    13064    3         IF AS_MOD_USER.BILL_A(I) THEN

  13064  3 000403   200003 235100                    LDA     I,,AUTO
         3 000404   000406 605000 3                  TPL     s:13064+3
         3 000405   000044 035003                    ADLA    36,DU
         3 000406   000000 066405                    CMPB    filb='0'B
         3 000407   000001 200001 xsym               BDSC    AS_MOD_USER+1,A          by=1,bit=0,n=1
         3 000410   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:285  
         3 000411   000417 600000 3                  TZE     s:13066

     1466    13065    3            AS_USERS.BILL(I) = AS_DFLT.BILL(I);

  13065  3 000412   200003 236100                    LDQ     I,,AUTO
         3 000413   000006 402007                    MPY     6,DL
         3 000414   040006 100406                    MLR     fill='040'O
         3 000415   000020 000006 xsym               ADSC9   AS_DFLT+16,Q             cn=0,n=6
         3 000416   000020 000006 xsym               ADSC9   AS_USERS+16,Q            cn=0,n=6

     1467    13066    3         END;

  13066  3 000417   200003 054100                    AOS     I,,AUTO
         3 000420   200003 235100                    LDA     I,,AUTO
         3 000421   000003 115007                    CMPA    3,DL
         3 000422   000403 604400 3                  TMOZ    s:13064

     1468    13067    2      END;

     1469    13068    2   IF AS_MOD_USER.FEBILL ~= '0'B THEN DO;

  13068  3 000423   000030 236000 xsym               LDQ     AS_MOD_USER+24
         3 000424   000074 316003                    CANQ    60,DU
         3 000425   000447 600000 3                  TZE     s:13074

     1470    13069    3      DO I = 0 TO 3;

  13069  3 000426   200003 450100                    STZ     I,,AUTO

     1471    13070    3         IF AS_MOD_USER.FEBILL_A(I) THEN

  13070  3 000427   200003 235100                    LDA     I,,AUTO
         3 000430   000432 605000 3                  TPL     s:13070+3
         3 000431   000044 035003                    ADLA    36,DU
         3 000432   000000 066405                    CMPB    filb='0'B
         3 000433   000030 230001 xsym               BDSC    AS_MOD_USER+24,A         by=1,bit=3,n=1
         3 000434   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:286  
         3 000435   000443 600000 3                  TZE     s:13072

     1472    13071    3            KL_DREC.KL_DREC_FEBLK.BILL(I) = KL_DFLT.KL_DFLT_FEBLK.BILL(I);

  13071  3 000436   200003 236100                    LDQ     I,,AUTO
         3 000437   000006 402007                    MPY     6,DL
         3 000440   040006 100406                    MLR     fill='040'O
         3 000441   000020 000006 xsym               ADSC9   KL_DFLT+16,Q             cn=0,n=6
         3 000442   000020 000006 xsym               ADSC9   KL_DREC+16,Q             cn=0,n=6

     1473    13072    3         END;

  13072  3 000443   200003 054100                    AOS     I,,AUTO
         3 000444   200003 235100                    LDA     I,,AUTO
         3 000445   000003 115007                    CMPA    3,DL
         3 000446   000427 604400 3                  TMOZ    s:13070

     1474    13073    2      END;

     1475    13074    2   IF AS_MOD_USER.FEMINTS ~= '0'B THEN DO;

  13074  3 000447   000030 236000 xsym               LDQ     AS_MOD_USER+24
         3 000450   000004 316000 4                  CANQ    4
         3 000451   000472 600000 3                  TZE     s:13080

     1476    13075    3      DO I = 0 TO 3;

  13075  3 000452   200003 450100                    STZ     I,,AUTO

     1477    13076    3         IF AS_MOD_USER.FEMINTS_A(I) THEN

  13076  3 000453   200003 235100                    LDA     I,,AUTO
         3 000454   000456 605000 3                  TPL     s:13076+3
         3 000455   000044 035003                    ADLA    36,DU
         3 000456   000000 066405                    CMPB    filb='0'B
         3 000457   000030 270001 xsym               BDSC    AS_MOD_USER+24,A         by=1,bit=7,n=1
         3 000460   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:287  
         3 000461   000466 600000 3                  TZE     s:13078

     1478    13077    3            KL_DREC.KL_DREC_FEBLK.MINTS(I) = KL_DFLT.KL_DFLT_FEBLK.MINTS(I);

  13077  3 000462   200003 235100                    LDA     I,,AUTO
         3 000463   000005 100405                    MLR     fill='000'O
         3 000464   000030 000001 xsym               ADSC9   KL_DFLT+24,A             cn=0,n=1
         3 000465   000030 000001 xsym               ADSC9   KL_DREC+24,A             cn=0,n=1

     1479    13078    3         END;

  13078  3 000466   200003 054100                    AOS     I,,AUTO
         3 000467   200003 235100                    LDA     I,,AUTO
         3 000470   000003 115007                    CMPA    3,DL
         3 000471   000453 604400 3                  TMOZ    s:13076

     1480    13079    2      END;

     1481    13080    2   IF AS_MOD_USER.FEMTIME ~= '0'B THEN DO;

  13080  3 000472   000050 236000 xsym               LDQ     AS_MOD_USER+40
         3 000473   074000 316007                    CANQ    30720,DL
         3 000474   000514 600000 3                  TZE     s:13086

     1482    13081    3      DO I = 0 TO 3;

  13081  3 000475   200003 450100                    STZ     I,,AUTO

     1483    13082    3         IF AS_MOD_USER.FEMTIME_A(I) THEN

  13082  3 000476   200003 235100                    LDA     I,,AUTO
         3 000477   000501 605000 3                  TPL     s:13082+3
         3 000500   000044 035003                    ADLA    36,DU
         3 000501   000000 066405                    CMPB    filb='0'B
         3 000502   000050 430001 xsym               BDSC    AS_MOD_USER+40,A         by=2,bit=3,n=1
         3 000503   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000504   000510 600000 3                  TZE     s:13084
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:288  

     1484    13083    3            KL_DREC.KL_DREC_FEBLK.MTIME(I) = KL_DFLT.KL_DFLT_FEBLK.MTIME(I);

  13083  3 000505   200003 720100                    LXL0    I,,AUTO
         3 000506   000042 235010 xsym               LDA     KL_DFLT+34,X0
         3 000507   000042 755010 xsym               STA     KL_DREC+34,X0

     1485    13084    3         END;

  13084  3 000510   200003 054100                    AOS     I,,AUTO
         3 000511   200003 235100                    LDA     I,,AUTO
         3 000512   000003 115007                    CMPA    3,DL
         3 000513   000476 604400 3                  TMOZ    s:13082

     1486    13085    2      END;

     1487    13086    2   IF AS_MOD_USER.FEMMEM ~= '0'B THEN DO;

  13086  3 000514   000050 236000 xsym               LDQ     AS_MOD_USER+40
         3 000515   003600 316007                    CANQ    1920,DL
         3 000516   000540 600000 3                  TZE     s:13092

     1488    13087    3      DO I = 0 TO 3;

  13087  3 000517   200003 450100                    STZ     I,,AUTO

     1489    13088    3         IF AS_MOD_USER.FEMMEM_A(I) THEN

  13088  3 000520   200003 235100                    LDA     I,,AUTO
         3 000521   000523 605000 3                  TPL     s:13088+3
         3 000522   000044 035003                    ADLA    36,DU
         3 000523   000000 066405                    CMPB    filb='0'B
         3 000524   000050 470001 xsym               BDSC    AS_MOD_USER+40,A         by=2,bit=7,n=1
         3 000525   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000526   000534 600000 3                  TZE     s:13090

     1490    13089    3            KL_DREC.KL_DREC_FEBLK.MMEM(I) = KL_DFLT.KL_DFLT_FEBLK.MMEM(I);
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:289  

  13089  3 000527   200003 235100                    LDA     I,,AUTO
         3 000530   000001 735000                    ALS     1
         3 000531   000005 100405                    MLR     fill='000'O
         3 000532   000046 000002 xsym               ADSC9   KL_DFLT+38,A             cn=0,n=2
         3 000533   000046 000002 xsym               ADSC9   KL_DREC+38,A             cn=0,n=2

     1491    13090    3         END;

  13090  3 000534   200003 054100                    AOS     I,,AUTO
         3 000535   200003 235100                    LDA     I,,AUTO
         3 000536   000003 115007                    CMPA    3,DL
         3 000537   000520 604400 3                  TMOZ    s:13088

     1492    13091    2      END;

     1493    13092    1   IF AS_MOD_USER.WSN THEN KL_DREC.WOO = KL_DFLT.WOO;

  13092  3 000540   000001 236000 xsym               LDQ     AS_MOD_USER+1
         3 000541   000020 316003                    CANQ    16,DU
         3 000542   000546 600000 3                  TZE     s:13093

  13092  3 000543   040000 100400                    MLR     fill='040'O
         3 000544   000007 000010 xsym               ADSC9   KL_DFLT+7                cn=0,n=8
         3 000545   000007 000010 xsym               ADSC9   KL_DREC+7                cn=0,n=8

     1494    13093    2   IF AS_MOD_USER.HSET THEN DO;

  13093  3 000546   000010 316003                    CANQ    8,DU
         3 000547   000556 600000 3                  TZE     s:13097

     1495    13094    2      KL_DREC.HPS.N = KL_DFLT.HPS.N;

  13094  3 000550   040000 100400                    MLR     fill='040'O
         3 000551   000011 000006 xsym               ADSC9   KL_DFLT+9                cn=0,n=6
         3 000552   000011 000006 xsym               ADSC9   KL_DREC+9                cn=0,n=6

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:290  
     1496    13095    2      AS_USERS.HPSN = AS_DFLT.HPSN;

  13095  3 000553   040000 100400                    MLR     fill='040'O
         3 000554   000123 000006 xsym               ADSC9   AS_DFLT+83               cn=0,n=6
         3 000555   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6

     1497    13096    2      END;

     1498    13097    1   IF AS_MOD_USER.PROFILE THEN KL_DREC.PNAME = KL_DFLT.PNAME;

  13097  3 000556   000004 316003                    CANQ    4,DU
         3 000557   000563 600000 3                  TZE     s:13098

  13097  3 000560   000000 100400                    MLR     fill='000'O
         3 000561   000004 000014 xsym               ADSC9   KL_DFLT+4                cn=0,n=12
         3 000562   000004 000014 xsym               ADSC9   KL_DREC+4                cn=0,n=12

     1499    13098    2   IF AS_MOD_USER.ACCESS THEN DO;

  13098  3 000563   000005 316000 4                  CANQ    5
         3 000564   000655 600000 3                  TZE     s:13116

     1500    13099    3      DO I = 0 TO 4;

  13099  3 000565   200003 450100                    STZ     I,,AUTO

     1501    13100    3         IF AS_MOD_USER.ACCESS_A(I) THEN

  13100  3 000566   200003 235100                    LDA     I,,AUTO
         3 000567   000571 605000 3                  TPL     s:13100+3
         3 000570   000044 035003                    ADLA    36,DU
         3 000571   000000 066405                    CMPB    filb='0'B
         3 000572   000001 270001 xsym               BDSC    AS_MOD_USER+1,A          by=1,bit=7,n=1
         3 000573   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000574   000651 600000 3                  TZE     s:13114

     1502    13101    4         DO SELECT( I );
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:291  

  13101  3 000575   200003 236100                    LDQ     I,,AUTO
         3 000576   000001 116007                    CMPQ    1,DL
         3 000577   000612 604000 3                  TMI     s:13101+13
         3 000600   000633 600000 3                  TZE     s:13108
         3 000601   000003 116007                    CMPQ    3,DL
         3 000602   000607 604000 3                  TMI     s:13101+10
         3 000603   000645 600000 3                  TZE     s:13112
         3 000604   000004 116007                    CMPQ    4,DL
         3 000605   000651 601000 3                  TNZ     s:13114
         3 000606   000640 710000 3                  TRA     s:13110
         3 000607   000002 116007                    CMPQ    2,DL
         3 000610   000651 601000 3                  TNZ     s:13114
         3 000611   000626 710000 3                  TRA     s:13106
         3 000612   000000 116003                    CMPQ    0,DU
         3 000613   000651 601000 3                  TNZ     s:13114
         3 000614   000615 710000 3                  TRA     s:13103

     1503    13102    4            SELECT( AS_M_BATCH# );

     1504    13103    4            KL_DREC.FLAGS.BATOK = KL_DFLT.FLAGS.BATOK;

  13103  3 000615   000000 236000 xsym               LDQ     KL_DFLT
         3 000616   000000 676000 xsym               ERQ     KL_DREC
         3 000617   000040 376003                    ANQ     32,DU
         3 000620   000000 656000 xsym               ERSQ    KL_DREC

     1505    13104    4            AS_USERS.BATOK = AS_DFLT.BATOK;

  13104  3 000621   000005 236000 xsym               LDQ     AS_DFLT+5
         3 000622   000005 676000 xsym               ERQ     AS_USERS+5
         3 000623   000200 376003                    ANQ     128,DU
         3 000624   000005 656000 xsym               ERSQ    AS_USERS+5
         3 000625   000651 710000 3                  TRA     s:13114

     1506    13105    4            SELECT( AS_M_INT# );

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:292  
     1507    13106    4            KL_DREC.FLAGS.OLOK = KL_DFLT.FLAGS.OLOK;

  13106  3 000626   000000 236000 xsym               LDQ     KL_DFLT
         3 000627   000000 676000 xsym               ERQ     KL_DREC
         3 000630   000100 376003                    ANQ     64,DU
         3 000631   000000 656000 xsym               ERSQ    KL_DREC
         3 000632   000651 710000 3                  TRA     s:13114

     1508    13107    4            SELECT( AS_M_GHOST# );

     1509    13108    4            KL_DREC.FLAGS.GHOSTOK = KL_DFLT.FLAGS.GHOSTOK;

  13108  3 000633   000000 236000 xsym               LDQ     KL_DFLT
         3 000634   000000 676000 xsym               ERQ     KL_DREC
         3 000635   000200 376003                    ANQ     128,DU
         3 000636   000000 656000 xsym               ERSQ    KL_DREC
         3 000637   000651 710000 3                  TRA     s:13114

     1510    13109    4            SELECT( AS_M_FE# );

     1511    13110    4            KL_DREC.FLAGS.FEOK = KL_DFLT.FLAGS.FEOK;

  13110  3 000640   000000 236000 xsym               LDQ     KL_DFLT
         3 000641   000000 676000 xsym               ERQ     KL_DREC
         3 000642   400000 376007                    ANQ     -131072,DL
         3 000643   000000 656000 xsym               ERSQ    KL_DREC
         3 000644   000651 710000 3                  TRA     s:13114

     1512    13111    4            SELECT( AS_M_TP# );

     1513    13112    4            KL_DREC.FLAGS.TPOK = KL_DFLT.FLAGS.TPOK;

  13112  3 000645   000000 236000 xsym               LDQ     KL_DFLT
         3 000646   000000 676000 xsym               ERQ     KL_DREC
         3 000647   000001 376003                    ANQ     1,DU
         3 000650   000000 656000 xsym               ERSQ    KL_DREC

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:293  
     1514    13113    4            END;

     1515    13114    3         END;

  13114  3 000651   200003 054100                    AOS     I,,AUTO
         3 000652   200003 235100                    LDA     I,,AUTO
         3 000653   000004 115007                    CMPA    4,DL
         3 000654   000566 604400 3                  TMOZ    s:13100

     1516    13115    2      END;

     1517    13116    2   IF AS_MOD_USER.PRIV ~= '0'B THEN DO;

  13116  3 000655   000000 066400                    CMPB    filb='0'B
         3 000656   000001 430440 xsym               BDSC    AS_MOD_USER+1            by=2,bit=3,n=288
         3 000657   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000660   000735 600000 3                  TZE     s:13128

     1518    13117    3      DO I = 0 TO SIZEW(AS_PRIV_NAMES)*4-1;

  13117  3 000661   200003 450100                    STZ     I,,AUTO
         3 000662   000732 710000 3                  TRA     s:13126+1

     1519    13118    4         IF AS_MOD_USER.PRIV_A(I) ~= 0 THEN DO;

  13118  3 000663   200003 235100                    LDA     I,,AUTO
         3 000664   000001 735000                    ALS     1
         3 000665   000667 605000 3                  TPL     s:13118+4
         3 000666   000044 035003                    ADLA    36,DU
         3 000667   003100 061405                    CSR     bolr='003'O
         3 000670   000001 430002 xsym               BDSC    AS_MOD_USER+1,A          by=2,bit=3,n=2
         3 000671   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 000672   200014 236100                    LDQ     VALUE+3,,AUTO
         3 000673   000000 116003                    CMPQ    0,DU
         3 000674   000731 600000 3                  TZE     s:13126

     1520    13119    4            J = I / 4;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:294  

  13119  3 000675   200003 236100                    LDQ     I,,AUTO
         3 000676   000004 506007                    DIV     4,DL
         3 000677   200004 756100                    STQ     J,,AUTO

     1521    13120    4            K = MOD( I, 4 );

  13120  3 000700   200003 236100                    LDQ     I,,AUTO
         3 000701   000004 506007                    DIV     4,DL
         3 000702   200005 755100                    STA     K,,AUTO

     1522    13121    4            IF AS_MOD_USER.PRIV_A(I) = YES_VAL THEN

  13121  3 000703   200003 236100                    LDQ     I,,AUTO
         3 000704   000001 736000                    QLS     1
         3 000705   000707 605000 3                  TPL     s:13121+4
         3 000706   000044 036003                    ADLQ    36,DU
         3 000707   003100 061406                    CSR     bolr='003'O
         3 000710   000001 430002 xsym               BDSC    AS_MOD_USER+1,Q          by=2,bit=3,n=2
         3 000711   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 000712   200014 236100                    LDQ     VALUE+3,,AUTO
         3 000713   000001 116007                    CMPQ    1,DL
         3 000714   000723 601000 3                  TNZ     s:13124

     1523    13122    4               AS_USERS.PRIV(K) = AS_USERS.PRIV(K) | AS_PRIVILEGE(J);

  13122  3 000715   200004 720100                    LXL0    J,,AUTO
         3 000716   000225 236005 xsym               LDQ     AS_USERS+149,AL
         3 000717   000000 276010 xsym               ORQ     AS_PRIVILEGE,X0
         3 000720   200005 721100                    LXL1    K,,AUTO
         3 000721   000225 756011 xsym               STQ     AS_USERS+149,X1
         3 000722   000731 710000 3                  TRA     s:13126

     1524    13123    4            ELSE
     1525    13124    4               AS_USERS.PRIV(K) = AS_USERS.PRIV(K) & ~AS_PRIVILEGE(J) ;

  13124  3 000723   200004 720100                    LXL0    J,,AUTO
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:295  
         3 000724   000000 236010 xsym               LDQ     AS_PRIVILEGE,X0
         3 000725   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000726   000225 376005 xsym               ANQ     AS_USERS+149,AL
         3 000727   200005 721100                    LXL1    K,,AUTO
         3 000730   000225 756011 xsym               STQ     AS_USERS+149,X1

     1526    13125    4            END;

     1527    13126    3         END;

  13126  3 000731   200003 054100                    AOS     I,,AUTO
         3 000732   200003 235100                    LDA     I,,AUTO
         3 000733   000137 115007                    CMPA    95,DL
         3 000734   000663 604400 3                  TMOZ    s:13118

     1528    13127    2      END;

     1529    13128    2   IF AS_MOD_USER.PPRIV ~= '0'B THEN DO;

  13128  3 000735   000000 066400                    CMPB    filb='0'B
         3 000736   000011 430440 xsym               BDSC    AS_MOD_USER+9            by=2,bit=3,n=288
         3 000737   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000740   001015 600000 3                  TZE     s:13140

     1530    13129    3      DO I = 0 TO SIZEW(AS_PPRIV_NAMES)*4-1;

  13129  3 000741   200003 450100                    STZ     I,,AUTO
         3 000742   001012 710000 3                  TRA     s:13138+1

     1531    13130    4         IF AS_MOD_USER.PPRIV_A(I) ~= 0 THEN DO;

  13130  3 000743   200003 235100                    LDA     I,,AUTO
         3 000744   000001 735000                    ALS     1
         3 000745   000747 605000 3                  TPL     s:13130+4
         3 000746   000044 035003                    ADLA    36,DU
         3 000747   003100 061405                    CSR     bolr='003'O
         3 000750   000011 430002 xsym               BDSC    AS_MOD_USER+9,A          by=2,bit=3,n=2
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:296  
         3 000751   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 000752   200014 236100                    LDQ     VALUE+3,,AUTO
         3 000753   000000 116003                    CMPQ    0,DU
         3 000754   001011 600000 3                  TZE     s:13138

     1532    13131    4            J = I / 4;

  13131  3 000755   200003 236100                    LDQ     I,,AUTO
         3 000756   000004 506007                    DIV     4,DL
         3 000757   200004 756100                    STQ     J,,AUTO

     1533    13132    4            K = MOD( I, 4 );

  13132  3 000760   200003 236100                    LDQ     I,,AUTO
         3 000761   000004 506007                    DIV     4,DL
         3 000762   200005 755100                    STA     K,,AUTO

     1534    13133    4            IF AS_MOD_USER.PPRIV_A(I) = YES_VAL THEN

  13133  3 000763   200003 236100                    LDQ     I,,AUTO
         3 000764   000001 736000                    QLS     1
         3 000765   000767 605000 3                  TPL     s:13133+4
         3 000766   000044 036003                    ADLQ    36,DU
         3 000767   003100 061406                    CSR     bolr='003'O
         3 000770   000011 430002 xsym               BDSC    AS_MOD_USER+9,Q          by=2,bit=3,n=2
         3 000771   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 000772   200014 236100                    LDQ     VALUE+3,,AUTO
         3 000773   000001 116007                    CMPQ    1,DL
         3 000774   001003 601000 3                  TNZ     s:13136

     1535    13134    4               AS_USERS.PPRIV(K) = AS_USERS.PPRIV(K) | AS_PPRIVILEGE(J);

  13134  3 000775   200004 720100                    LXL0    J,,AUTO
         3 000776   000231 236005 xsym               LDQ     AS_USERS+153,AL
         3 000777   000000 276010 xsym               ORQ     AS_PPRIVILEGE,X0
         3 001000   200005 721100                    LXL1    K,,AUTO
         3 001001   000231 756011 xsym               STQ     AS_USERS+153,X1
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:297  
         3 001002   001011 710000 3                  TRA     s:13138

     1536    13135    4            ELSE
     1537    13136    4               AS_USERS.PPRIV(K) = AS_USERS.PPRIV(K) & ~AS_PPRIVILEGE(J);

  13136  3 001003   200004 720100                    LXL0    J,,AUTO
         3 001004   000000 236010 xsym               LDQ     AS_PPRIVILEGE,X0
         3 001005   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001006   000231 376005 xsym               ANQ     AS_USERS+153,AL
         3 001007   200005 721100                    LXL1    K,,AUTO
         3 001010   000231 756011 xsym               STQ     AS_USERS+153,X1

     1538    13137    4            END;

     1539    13138    3         END;

  13138  3 001011   200003 054100                    AOS     I,,AUTO
         3 001012   200003 235100                    LDA     I,,AUTO
         3 001013   000123 115007                    CMPA    83,DL
         3 001014   000743 604400 3                  TMOZ    s:13130

     1540    13139    2      END;

     1541    13140    2   IF AS_MOD_USER.FEPRIV ~= '0'B THEN DO;

  13140  3 001015   000000 066400                    CMPB    filb='0'B
         3 001016   000030 430440 xsym               BDSC    AS_MOD_USER+24           by=2,bit=3,n=288
         3 001017   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001020   001075 600000 3                  TZE     s:13152

     1542    13141    3      DO I = 0 TO SIZEW(AS_PRIV_NAMES)*4-1;

  13141  3 001021   200003 450100                    STZ     I,,AUTO
         3 001022   001072 710000 3                  TRA     s:13150+1

     1543    13142    4         IF AS_MOD_USER.FEPRIV_A(I) ~= 0 THEN DO;

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:298  
  13142  3 001023   200003 235100                    LDA     I,,AUTO
         3 001024   000001 735000                    ALS     1
         3 001025   001027 605000 3                  TPL     s:13142+4
         3 001026   000044 035003                    ADLA    36,DU
         3 001027   003100 061405                    CSR     bolr='003'O
         3 001030   000030 430002 xsym               BDSC    AS_MOD_USER+24,A         by=2,bit=3,n=2
         3 001031   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 001032   200014 236100                    LDQ     VALUE+3,,AUTO
         3 001033   000000 116003                    CMPQ    0,DU
         3 001034   001071 600000 3                  TZE     s:13150

     1544    13143    4            J = I / 4;

  13143  3 001035   200003 236100                    LDQ     I,,AUTO
         3 001036   000004 506007                    DIV     4,DL
         3 001037   200004 756100                    STQ     J,,AUTO

     1545    13144    4            K = MOD( I, 4 );

  13144  3 001040   200003 236100                    LDQ     I,,AUTO
         3 001041   000004 506007                    DIV     4,DL
         3 001042   200005 755100                    STA     K,,AUTO

     1546    13145    4            IF AS_MOD_USER.FEPRIV_A(I) = YES_VAL THEN

  13145  3 001043   200003 236100                    LDQ     I,,AUTO
         3 001044   000001 736000                    QLS     1
         3 001045   001047 605000 3                  TPL     s:13145+4
         3 001046   000044 036003                    ADLQ    36,DU
         3 001047   003100 061406                    CSR     bolr='003'O
         3 001050   000030 430002 xsym               BDSC    AS_MOD_USER+24,Q         by=2,bit=3,n=2
         3 001051   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 001052   200014 236100                    LDQ     VALUE+3,,AUTO
         3 001053   000001 116007                    CMPQ    1,DL
         3 001054   001063 601000 3                  TNZ     s:13148

     1547    13146    4               KL_DREC.KL_DREC_FEBLK.PRIV(K) = KL_DREC.KL_DREC_FEBLK.PRIV(K) |
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:299  
             13146                        AS_PRIVILEGE(J);

  13146  3 001055   200004 720100                    LXL0    J,,AUTO
         3 001056   000032 236005 xsym               LDQ     KL_DREC+26,AL
         3 001057   000000 276010 xsym               ORQ     AS_PRIVILEGE,X0
         3 001060   200005 721100                    LXL1    K,,AUTO
         3 001061   000032 756011 xsym               STQ     KL_DREC+26,X1
         3 001062   001071 710000 3                  TRA     s:13150

     1548    13147    4            ELSE
     1549    13148    4               KL_DREC.KL_DREC_FEBLK.PRIV(K) = KL_DREC.KL_DREC_FEBLK.PRIV(K) & ~
             13148                        AS_PRIVILEGE(J) ;

  13148  3 001063   200004 720100                    LXL0    J,,AUTO
         3 001064   000000 236010 xsym               LDQ     AS_PRIVILEGE,X0
         3 001065   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001066   000032 376005 xsym               ANQ     KL_DREC+26,AL
         3 001067   200005 721100                    LXL1    K,,AUTO
         3 001070   000032 756011 xsym               STQ     KL_DREC+26,X1

     1550    13149    4            END;

     1551    13150    3         END;

  13150  3 001071   200003 054100                    AOS     I,,AUTO
         3 001072   200003 235100                    LDA     I,,AUTO
         3 001073   000137 115007                    CMPA    95,DL
         3 001074   001023 604400 3                  TMOZ    s:13142

     1552    13151    2      END;

     1553    13152    2   IF AS_MOD_USER.FEPPRIV ~= '0'B THEN DO;

  13152  3 001075   000000 066400                    CMPB    filb='0'B
         3 001076   000040 430440 xsym               BDSC    AS_MOD_USER+32           by=2,bit=3,n=288
         3 001077   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001100   001155 600000 3                  TZE     s:13164
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:300  

     1554    13153    3      DO I = 0 TO SIZEW(AS_PPRIV_NAMES)*4-1;

  13153  3 001101   200003 450100                    STZ     I,,AUTO
         3 001102   001152 710000 3                  TRA     s:13162+1

     1555    13154    4         IF AS_MOD_USER.FEPPRIV_A(I) ~= 0 THEN DO;

  13154  3 001103   200003 235100                    LDA     I,,AUTO
         3 001104   000001 735000                    ALS     1
         3 001105   001107 605000 3                  TPL     s:13154+4
         3 001106   000044 035003                    ADLA    36,DU
         3 001107   003100 061405                    CSR     bolr='003'O
         3 001110   000040 430002 xsym               BDSC    AS_MOD_USER+32,A         by=2,bit=3,n=2
         3 001111   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 001112   200014 236100                    LDQ     VALUE+3,,AUTO
         3 001113   000000 116003                    CMPQ    0,DU
         3 001114   001151 600000 3                  TZE     s:13162

     1556    13155    4            J = I / 4;

  13155  3 001115   200003 236100                    LDQ     I,,AUTO
         3 001116   000004 506007                    DIV     4,DL
         3 001117   200004 756100                    STQ     J,,AUTO

     1557    13156    4            K = MOD( I, 4 );

  13156  3 001120   200003 236100                    LDQ     I,,AUTO
         3 001121   000004 506007                    DIV     4,DL
         3 001122   200005 755100                    STA     K,,AUTO

     1558    13157    4            IF AS_MOD_USER.FEPPRIV_A(I) = YES_VAL THEN

  13157  3 001123   200003 236100                    LDQ     I,,AUTO
         3 001124   000001 736000                    QLS     1
         3 001125   001127 605000 3                  TPL     s:13157+4
         3 001126   000044 036003                    ADLQ    36,DU
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:301  
         3 001127   003100 061406                    CSR     bolr='003'O
         3 001130   000040 430002 xsym               BDSC    AS_MOD_USER+32,Q         by=2,bit=3,n=2
         3 001131   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 001132   200014 236100                    LDQ     VALUE+3,,AUTO
         3 001133   000001 116007                    CMPQ    1,DL
         3 001134   001143 601000 3                  TNZ     s:13160

     1559    13158    4               KL_DREC.KL_DREC_FEBLK.PPRIV(K) = KL_DREC.KL_DREC_FEBLK.PPRIV(K) |
             13158                        AS_PPRIVILEGE(J);

  13158  3 001135   200004 720100                    LXL0    J,,AUTO
         3 001136   000036 236005 xsym               LDQ     KL_DREC+30,AL
         3 001137   000000 276010 xsym               ORQ     AS_PPRIVILEGE,X0
         3 001140   200005 721100                    LXL1    K,,AUTO
         3 001141   000036 756011 xsym               STQ     KL_DREC+30,X1
         3 001142   001151 710000 3                  TRA     s:13162

     1560    13159    4            ELSE
     1561    13160    4               KL_DREC.KL_DREC_FEBLK.PPRIV(K) = KL_DREC.KL_DREC_FEBLK.PPRIV(K) & ~
             13160                        AS_PPRIVILEGE(J);

  13160  3 001143   200004 720100                    LXL0    J,,AUTO
         3 001144   000000 236010 xsym               LDQ     AS_PPRIVILEGE,X0
         3 001145   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001146   000036 376005 xsym               ANQ     KL_DREC+30,AL
         3 001147   200005 721100                    LXL1    K,,AUTO
         3 001150   000036 756011 xsym               STQ     KL_DREC+30,X1

     1562    13161    4            END;

     1563    13162    3         END;

  13162  3 001151   200003 054100                    AOS     I,,AUTO
         3 001152   200003 235100                    LDA     I,,AUTO
         3 001153   000123 115007                    CMPA    83,DL
         3 001154   001103 604400 3                  TMOZ    s:13154

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:302  
     1564    13163    2      END;

     1565    13164    2   IF AS_MOD_USER.QUAN ~= '0'B THEN DO ;

  13164  3 001155   000021 236000 xsym               LDQ     AS_MOD_USER+17
         3 001156   074000 316007                    CANQ    30720,DL
         3 001157   001201 600000 3                  TZE     s:13170

     1566    13165    3      DO I = 0 TO 3;

  13165  3 001160   200003 450100                    STZ     I,,AUTO

     1567    13166    3         IF AS_MOD_USER.QUAN_A(I) THEN

  13166  3 001161   200003 235100                    LDA     I,,AUTO
         3 001162   001164 605000 3                  TPL     s:13166+3
         3 001163   000044 035003                    ADLA    36,DU
         3 001164   000000 066405                    CMPB    filb='0'B
         3 001165   000021 430001 xsym               BDSC    AS_MOD_USER+17,A         by=2,bit=3,n=1
         3 001166   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001167   001175 600000 3                  TZE     s:13168

     1568    13167    3            AS_USERS.QUAN(I) = AS_DFLT.QUAN(I) ;

  13167  3 001170   200003 235100                    LDA     I,,AUTO
         3 001171   000001 735000                    ALS     1
         3 001172   000005 100405                    MLR     fill='000'O
         3 001173   000235 000002 xsym               ADSC9   AS_DFLT+157,A            cn=0,n=2
         3 001174   000235 000002 xsym               ADSC9   AS_USERS+157,A           cn=0,n=2

     1569    13168    3         END ;

  13168  3 001175   200003 054100                    AOS     I,,AUTO
         3 001176   200003 235100                    LDA     I,,AUTO
         3 001177   000003 115007                    CMPA    3,DL
         3 001200   001161 604400 3                  TMOZ    s:13166

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:303  
     1570    13169    2      END ;

     1571    13170    2   IF AS_MOD_USER.MAXENQ ~= '0'B THEN DO ;

  13170  3 001201   000021 236000 xsym               LDQ     AS_MOD_USER+17
         3 001202   003600 316007                    CANQ    1920,DL
         3 001203   001225 600000 3                  TZE     s:13176

     1572    13171    3      DO I = 0 TO 3;

  13171  3 001204   200003 450100                    STZ     I,,AUTO

     1573    13172    3         IF AS_MOD_USER.MAXENQ_A(I) THEN

  13172  3 001205   200003 235100                    LDA     I,,AUTO
         3 001206   001210 605000 3                  TPL     s:13172+3
         3 001207   000044 035003                    ADLA    36,DU
         3 001210   000000 066405                    CMPB    filb='0'B
         3 001211   000021 470001 xsym               BDSC    AS_MOD_USER+17,A         by=2,bit=7,n=1
         3 001212   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001213   001221 600000 3                  TZE     s:13174

     1574    13173    3            AS_USERS.MAXENQ(I) = AS_DFLT.MAXENQ(I) ;

  13173  3 001214   200003 235100                    LDA     I,,AUTO
         3 001215   000001 735000                    ALS     1
         3 001216   000005 100405                    MLR     fill='000'O
         3 001217   000775 000002 xsym               ADSC9   AS_DFLT+509,A            cn=0,n=2
         3 001220   000775 000002 xsym               ADSC9   AS_USERS+509,A           cn=0,n=2

     1575    13174    3         END ;

  13174  3 001221   200003 054100                    AOS     I,,AUTO
         3 001222   200003 235100                    LDA     I,,AUTO
         3 001223   000003 115007                    CMPA    3,DL
         3 001224   001205 604400 3                  TMOZ    s:13172

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:304  
     1576    13175    2      END ;

     1577    13176    2   IF AS_MOD_USER.PRIOB ~= '0'B THEN DO ;

  13176  3 001225   000021 236000 xsym               LDQ     AS_MOD_USER+17
         3 001226   000170 316007                    CANQ    120,DL
         3 001227   001250 600000 3                  TZE     s:13182

     1578    13177    3      DO I = 0 TO 3;

  13177  3 001230   200003 450100                    STZ     I,,AUTO

     1579    13178    3         IF AS_MOD_USER.PRIOB_A(I) THEN

  13178  3 001231   200003 235100                    LDA     I,,AUTO
         3 001232   001234 605000 3                  TPL     s:13178+3
         3 001233   000044 035003                    ADLA    36,DU
         3 001234   000000 066405                    CMPB    filb='0'B
         3 001235   000021 620001 xsym               BDSC    AS_MOD_USER+17,A         by=3,bit=2,n=1
         3 001236   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001237   001244 600000 3                  TZE     s:13180

     1580    13179    3            AS_USERS.PRIOB(I) = AS_DFLT.PRIOB(I) ;

  13179  3 001240   200003 235100                    LDA     I,,AUTO
         3 001241   000005 100405                    MLR     fill='000'O
         3 001242   000241 000001 xsym               ADSC9   AS_DFLT+161,A            cn=0,n=1
         3 001243   000241 000001 xsym               ADSC9   AS_USERS+161,A           cn=0,n=1

     1581    13180    3         END ;

  13180  3 001244   200003 054100                    AOS     I,,AUTO
         3 001245   200003 235100                    LDA     I,,AUTO
         3 001246   000003 115007                    CMPA    3,DL
         3 001247   001231 604400 3                  TMOZ    s:13178

     1582    13181    2      END ;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:305  

     1583    13182    2   IF AS_MOD_USER.BUDGET ~= '0'B THEN DO;

  13182  3 001250   000000 066400                    CMPB    filb='0'B
         3 001251   000021 660011 xsym               BDSC    AS_MOD_USER+17           by=3,bit=6,n=9
         3 001252   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001253   001460 600000 3                  TZE     s:13287

     1584    13183    2      IF AS_MOD_USER.BUDGET.PCHARGES THEN

  13183  3 001254   000021 236000 xsym               LDQ     AS_MOD_USER+17
         3 001255   000004 316007                    CANQ    4,DL
         3 001256   001263 600000 3                  TZE     s:13185

     1585    13184    2         AS_USERS.BUDGET.PCHARGES = AS_DFLT.BUDGET.PCHARGES;

  13184  3 001257   000017 236000 xsym               LDQ     AS_DFLT+15
         3 001260   000017 676000 xsym               ERQ     AS_USERS+15
         3 001261   000100 376003                    ANQ     64,DU
         3 001262   000017 656000 xsym               ERSQ    AS_USERS+15

     1586    13185    2      IF AS_MOD_USER.BUDGET.MACCT THEN

  13185  3 001263   000022 236000 xsym               LDQ     AS_MOD_USER+18
         3 001264   020000 316003                    CANQ    8192,DU
         3 001265   001271 600000 3                  TZE     s:13187

     1587    13186    2         AS_USERS.BUDGET.MACCT = AS_DFLT.BUDGET.MACCT;

  13186  3 001266   000000 100400                    MLR     fill='000'O
         3 001267   000012 000025 xsym               ADSC9   AS_DFLT+10               cn=0,n=21
         3 001270   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21

     1588    13187    2      IF AS_MOD_USER.BUDGET.ICHARGES THEN

  13187  3 001271   000021 236000 xsym               LDQ     AS_MOD_USER+17
         3 001272   000002 316007                    CANQ    2,DL
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:306  
         3 001273   001300 600000 3                  TZE     s:13189

     1589    13188    2         AS_USERS.BUDGET.ICHARGES = AS_DFLT.BUDGET.ICHARGES;

  13188  3 001274   000017 236000 xsym               LDQ     AS_DFLT+15
         3 001275   000017 676000 xsym               ERQ     AS_USERS+15
         3 001276   000040 376003                    ANQ     32,DU
         3 001277   000017 656000 xsym               ERSQ    AS_USERS+15

     1590    13189    2      IF AS_MOD_USER.BUDGET.BKACC THEN

  13189  3 001300   000021 236000 xsym               LDQ     AS_MOD_USER+17
         3 001301   000001 316007                    CANQ    1,DL
         3 001302   001307 600000 3                  TZE     s:13191

     1591    13190    2         AS_USERS.BUDGET.BKACC = AS_DFLT.BUDGET.BKACC;

  13190  3 001303   000017 236000 xsym               LDQ     AS_DFLT+15
         3 001304   000017 676000 xsym               ERQ     AS_USERS+15
         3 001305   000400 376003                    ANQ     256,DU
         3 001306   000017 656000 xsym               ERSQ    AS_USERS+15

     1592    13191    2      IF AS_MOD_USER.BUDGET.BUDLIM THEN

  13191  3 001307   000022 234000 xsym               SZN     AS_MOD_USER+18
         3 001310   001315 605000 3                  TPL     s:13193

     1593    13192    2         AS_USERS.BUDGET.BUDLIM = AS_DFLT.BUDGET.BUDLIM;

  13192  3 001311   000017 236000 xsym               LDQ     AS_DFLT+15
         3 001312   000017 676000 xsym               ERQ     AS_USERS+15
         3 001313   000200 376003                    ANQ     128,DU
         3 001314   000017 656000 xsym               ERSQ    AS_USERS+15

     1594    13193    2      IF AS_MOD_USER.BUDGET.BLINDACCTNG THEN

  13193  3 001315   000022 236000 xsym               LDQ     AS_MOD_USER+18
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:307  
         3 001316   200000 316003                    CANQ    65536,DU
         3 001317   001324 600000 3                  TZE     s:13195

     1595    13194    2         AS_USERS.BUDGET.BLINDACCTNG = AS_DFLT.BUDGET.BLINDACCTNG;

  13194  3 001320   000017 236000 xsym               LDQ     AS_DFLT+15
         3 001321   000017 676000 xsym               ERQ     AS_USERS+15
         3 001322   000020 376003                    ANQ     16,DU
         3 001323   000017 656000 xsym               ERSQ    AS_USERS+15

     1596    13195    2      IF AS_MOD_USER.BUDGET.MAXC THEN

  13195  3 001324   000022 236000 xsym               LDQ     AS_MOD_USER+18
         3 001325   100000 316003                    CANQ    32768,DU
         3 001326   001453 600000 3                  TZE     s:13284

     1597    13196    2         IF ((AS_WILD_MVAL = -1) AND (NOT AS_MOD_USER.BUDGET.SIGN))

  13196  3 001327   000000 235000 xsym               LDA     AS_WILD_MVAL
         3 001330   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 001331   001334 601000 3                  TNZ     s:13196+5
         3 001332   040000 316003                    CANQ    16384,DU
         3 001333   001341 600000 3                  TZE     s:13199
         3 001334   000006 235000 xsym               LDA     AS_USERS+6
         3 001335   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 001336   001344 601000 3                  TNZ     s:13201
         3 001337   040000 316003                    CANQ    16384,DU
         3 001340   001344 600000 3                  TZE     s:13201

     1598    13197    2              OR ((AS_USERS.BUDGET.MAXC = -1) AND AS_MOD_USER.BUDGET.SIGN)
     1599    13198    2         THEN
     1600    13199    2            AS_USERS.BUDGET.MAXC = -1 ;

  13199  3 001341   000001 335007                    LCA     1,DL
         3 001342   000006 755000 xsym               STA     AS_USERS+6
         3 001343   001453 710000 3                  TRA     s:13284

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:308  
     1601    13200    3         ELSE DO;

     1602    13201    3            SAVE_MAXC = AS_USERS.BUDGET.MAXC;

  13201  3 001344   200007 755100                    STA     SAVE_MAXC,,AUTO

     1603    13202    3            IF NOT AS_MOD_USER.BUDGET.SIGN THEN

  13202  3 001345   040000 316003                    CANQ    16384,DU
         3 001346   001352 601000 3                  TNZ     s:13205

     1604    13203    3               AS_USERS.BUDGET.MAXC = AS_WILD_MVAL ;

  13203  3 001347   000000 235000 xsym               LDA     AS_WILD_MVAL
         3 001350   000006 755000 xsym               STA     AS_USERS+6
         3 001351   001355 710000 3                  TRA     s:13206

     1605    13204    3            ELSE
     1606    13205    3               AS_USERS.BUDGET.MAXC = AS_WILD_MVAL + AS_USERS.BUDGET.MAXC ;

  13205  3 001352   000000 236000 xsym               LDQ     AS_WILD_MVAL
         3 001353   000006 036000 xsym               ADLQ    AS_USERS+6
         3 001354   000006 756000 xsym               STQ     AS_USERS+6

     1607    13206    4            IF AS_USERS.BUDGET.MAXC < 0 THEN DO;

  13206  3 001355   000006 235000 xsym               LDA     AS_USERS+6
         3 001356   001365 605000 3                  TPL     s:13224

     1608    13207                    %SCREAM(ERR#=E$MCHARGES_NEG_VAL,LEVEL=ERROR,MID='C') ;

  13219  3 001357   000006 630400 4                  EPPR0   6
         3 001360   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001361   000000 701000 xent               TSX1    ASH$ERROR
         3 001362   000000 011000                    NOP     0

     1609    13222    4               AS_USERS.BUDGET.MAXC = SAVE_MAXC;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:309  

  13222  3 001363   200007 235100                    LDA     SAVE_MAXC,,AUTO
         3 001364   000006 755000 xsym               STA     AS_USERS+6

     1610    13223    4               END;

     1611    13224    3            IF AS_CR_MOD_PROJ > 0 AND AS_WILD_MCH > 0

  13224  3 001365   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 001366   001453 604400 3                  TMOZ    s:13284
         3 001367   000000 235000 xsym               LDA     AS_WILD_MCH
         3 001370   001453 604400 3                  TMOZ    s:13284

     1612    13225    3            THEN
     1613    13226    3               IF AS_USERS.BUDGET.MAXC > AS_WILD_MCH

  13226  3 001371   000006 236000 xsym               LDQ     AS_USERS+6
         3 001372   000000 116000 xsym               CMPQ    AS_WILD_MCH
         3 001373   001453 604400 3                  TMOZ    s:13284

     1614    13227    4               THEN DO;

     1615    13228    4                  AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  13228  3 001374   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 001375   000022 402007                    MPY     18,DL
         3 001376   000000 100406                    MLR     fill='000'O
         3 001377   777773 400022 2                  ADSC9   ZERO_LENGTH-19,Q         cn=2,n=18
         3 001400   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1616    13229    4                  VALUE(0) = AS_WILD_MCH / 10000;

  13229  3 001401   000000 236000 xsym               LDQ     AS_WILD_MCH
         3 001402   023420 506007                    DIV     10000,DL
         3 001403   200011 756100                    STQ     VALUE,,AUTO

     1617    13230    4                  VALUE(1) = MOD( AS_WILD_MCH, 10000 ) / 100;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:310  

  13230  3 001404   000000 236000 xsym               LDQ     AS_WILD_MCH
         3 001405   023420 506007                    DIV     10000,DL
         3 001406   000044 733000                    LRS     36
         3 001407   000144 506007                    DIV     100,DL
         3 001410   200012 756100                    STQ     VALUE+1,,AUTO

     1618    13231                       %NUMBER( NUM2="VALUE(0)", NUM3="VALUE(1)" );
             13247    4         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VALUE(0) );

  13247  3 001411   200011 630500                    EPPR0   VALUE,,AUTO
         3 001412   200017 450500                    STP0    VALUE+6,,AUTO
         3 001413   000010 236000 4                  LDQ     8
         3 001414   200016 756100                    STQ     VALUE+5,,AUTO
         3 001415   000012 237000 4                  LDAQ    10
         3 001416   200014 757100                    STAQ    VALUE+3,,AUTO
         3 001417   200014 630500                    EPPR0   VALUE+3,,AUTO
         3 001420   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001421   000000 701000 xent               TSX1    ASB$BINCHAR
         3 001422   000000 011000                    NOP     0

             13255    4         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, VALUE(1) );

  13255  3 001423   200012 630500                    EPPR0   VALUE+1,,AUTO
         3 001424   200017 450500                    STP0    VALUE+6,,AUTO
         3 001425   000015 236000 4                  LDQ     13
         3 001426   200016 756100                    STQ     VALUE+5,,AUTO
         3 001427   000016 237000 4                  LDAQ    14
         3 001430   200014 757100                    STAQ    VALUE+3,,AUTO
         3 001431   200014 630500                    EPPR0   VALUE+3,,AUTO
         3 001432   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001433   000000 701000 xent               TSX1    ASB$BINCHAR
         3 001434   000000 011000                    NOP     0

     1619    13261    4                  IF AS_FIELD3.COUNT = 1

  13261  3 001435   000000 236000 xsym               LDQ     AS_FIELD3
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:311  
         3 001436   777000 376003                    ANQ     -512,DU
         3 001437   001000 116003                    CMPQ    512,DU
         3 001440   001445 601000 3                  TNZ     s:13278

     1620    13262    5                  THEN DO;

     1621    13263    5                     AS_FIELD3.COUNT = 2;

  13263  3 001441   002000 236003                    LDQ     1024,DU
         3 001442   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

     1622    13264    5                     CALL INSERT( AS_FIELD3.TEXT, 1, 1, '0' );

  13264  3 001443   060000 236007                    LDQ     24576,DL
         3 001444   000000 552010 xsym               STBQ    AS_FIELD3,'10'O

     1623    13265    5                     END;

     1624    13266                       %SCREAM( ERR#=E$MCHARGES_TOO_LARGE, LEVEL=ERROR, MID='C' );

  13278  3 001445   000020 630400 4                  EPPR0   16
         3 001446   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001447   000000 701000 xent               TSX1    ASH$ERROR
         3 001450   000000 011000                    NOP     0

     1625    13281    4                  AS_USERS.BUDGET.MAXC = AS_WILD_MCH;

  13281  3 001451   000000 235000 xsym               LDA     AS_WILD_MCH
         3 001452   000006 755000 xsym               STA     AS_USERS+6

     1626    13282    4                  END;

     1627    13283    3            END;

     1628    13284    2      IF AS_MOD_USER.BUDGET.ACCUM THEN

  13284  3 001453   000022 236000 xsym               LDQ     AS_MOD_USER+18
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:312  
         3 001454   010000 316003                    CANQ    4096,DU
         3 001455   001460 600000 3                  TZE     s:13287

     1629    13285    2         AS_USERS.BUDGET.ACCUM = AS_DFLT.BUDGET.ACCUM;

  13285  3 001456   000007 235000 xsym               LDA     AS_DFLT+7
         3 001457   000007 755000 xsym               STA     AS_USERS+7

     1630    13286    2      END;

     1631    13287    2   IF AS_MOD_USER.KEY ~= '0'B THEN DO;

  13287  3 001460   000000 066400                    CMPB    filb='0'B
         3 001461   000024 220220 xsym               BDSC    AS_MOD_USER+20           by=1,bit=2,n=144
         3 001462   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001463   001514 600000 3                  TZE     s:13293

     1632    13288    3      DO I = 0 TO 71;

  13288  3 001464   200003 450100                    STZ     I,,AUTO

     1633    13289    3         IF AS_MOD_USER.KEY_A(I) > 0 THEN

  13289  3 001465   200003 235100                    LDA     I,,AUTO
         3 001466   000001 735000                    ALS     1
         3 001467   001471 605000 3                  TPL     s:13289+4
         3 001470   000044 035003                    ADLA    36,DU
         3 001471   003100 061405                    CSR     bolr='003'O
         3 001472   000024 220002 xsym               BDSC    AS_MOD_USER+20,A         by=1,bit=2,n=2
         3 001473   200014 000044                    BDSC    VALUE+3,,AUTO            by=0,bit=0,n=36
         3 001474   200014 236100                    LDQ     VALUE+3,,AUTO
         3 001475   000000 116003                    CMPQ    0,DU
         3 001476   001510 600000 3                  TZE     s:13291

     1634    13290    3            AS_USERS.KEY(I) = AS_DFLT.KEY(I);

  13290  3 001477   200003 235100                    LDA     I,,AUTO
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:313  
         3 001500   001502 605000 3                  TPL     s:13290+3
         3 001501   000044 035003                    ADLA    36,DU
         3 001502   200003 236100                    LDQ     I,,AUTO
         3 001503   001505 605000 3                  TPL     s:13290+6
         3 001504   000044 036003                    ADLQ    36,DU
         3 001505   003006 060405                    CSL     bolr='003'O
         3 001506   000026 000001 xsym               BDSC    AS_DFLT+22,A             by=0,bit=0,n=1
         3 001507   000026 000001 xsym               BDSC    AS_USERS+22,Q            by=0,bit=0,n=1

     1635    13291    3         END;

  13291  3 001510   200003 054100                    AOS     I,,AUTO
         3 001511   200003 235100                    LDA     I,,AUTO
         3 001512   000107 115007                    CMPA    71,DL
         3 001513   001465 604400 3                  TMOZ    s:13289

     1636    13292    2      END;

     1637    13293    1   IF AS_MOD_USER.LIMITS ~= '0'B THEN CALL ASC$MOD_USER_LIMITS;

  13293  3 001514   000000 066400                    CMPB    filb='0'B
         3 001515   000022 060113 xsym               BDSC    AS_MOD_USER+18           by=0,bit=6,n=75
         3 001516   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001517   001523 600000 3                  TZE     s:13294

  13293  3 001520   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001521   000000 701000 xent               TSX1    ASC$MOD_USER_LIMITS
         3 001522   000000 011000                    NOP     0

     1638    13294    1   IF AS_MOD_USER.RESOURCE THEN CALL ASC$RESOURCE( AS_TRUE );

  13294  3 001523   000024 236000 xsym               LDQ     AS_MOD_USER+20
         3 001524   000200 316003                    CANQ    128,DU
         3 001525   001532 600000 3                  TZE     s:13295

  13294  3 001526   000021 630400 4                  EPPR0   17
         3 001527   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:314  
         3 001530   000000 701000 xent               TSX1    ASC$RESOURCE
         3 001531   000000 011000                    NOP     0

     1639    13295    1   IF AS_MOD_USER.FERESOURCE THEN CALL ASC$FERESOURCE( AS_TRUE );

  13295  3 001532   000051 236000 xsym               LDQ     AS_MOD_USER+41
         3 001533   020000 316003                    CANQ    8192,DU
         3 001534   001541 600000 3                  TZE     s:13296

  13295  3 001535   000021 630400 4                  EPPR0   17
         3 001536   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001537   000000 701000 xent               TSX1    ASC$FERESOURCE
         3 001540   000000 011000                    NOP     0

     1640    13296    1   IF AS_MOD_USER.PSEUDO THEN CALL ASC$PSEUDO( AS_TRUE );

  13296  3 001541   000024 236000 xsym               LDQ     AS_MOD_USER+20
         3 001542   000400 316003                    CANQ    256,DU
         3 001543   001550 600000 3                  TZE     s:13297

  13296  3 001544   000021 630400 4                  EPPR0   17
         3 001545   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001546   000000 701000 xent               TSX1    ASC$PSEUDO
         3 001547   000000 011000                    NOP     0

     1641    13297    1   IF AS_MOD_USER.FEPSEUDO THEN CALL ASC$FEPSEUDO( AS_TRUE );

  13297  3 001550   000051 236000 xsym               LDQ     AS_MOD_USER+41
         3 001551   040000 316003                    CANQ    16384,DU
         3 001552   001557 600000 3                  TZE     s:13298

  13297  3 001553   000021 630400 4                  EPPR0   17
         3 001554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001555   000000 701000 xent               TSX1    ASC$FEPSEUDO
         3 001556   000000 011000                    NOP     0

     1642    13298    2   IF AS_MOD_USER.FACCOUNT THEN DO;
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:315  

  13298  3 001557   000030 236000 xsym               LDQ     AS_MOD_USER+24
         3 001560   000100 316003                    CANQ    64,DU
         3 001561   001600 600000 3                  TZE     s:13305

     1643    13299    2      SUPER_TO_PIG.TYPE = %MODIFY_ACCT;

  13299  3 001562   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         3 001563   001000 236003                    LDQ     512,DU
         3 001564   000000 552140                    STBQ    0,'40'O,PR0

     1644    13300    2      SUPER_TO_PIG.ACCT = AS_USERS.ACCT;

  13300  3 001565   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         3 001566   040100 100400                    MLR     fill='040'O
         3 001567   000000 000010 xsym               ADSC9   AS_USERS                 cn=0,n=8
         3 001570   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8

     1645    13301    2      SUPER_TO_PIG.PACKSET = AS_USERS.HPSN;

  13301  3 001571   040100 100400                    MLR     fill='040'O
         3 001572   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6
         3 001573   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6

     1646    13302    2      CALL ASB$PIG( SUPER_TO_PIG );

  13302  3 001574   000000 630400 xsym               EPPR0   AS_SUPER_TO_PIG$
         3 001575   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001576   000000 701000 xent               TSX1    ASB$PIG
         3 001577   000000 011000                    NOP     0

     1647    13303    2      END;

     1648    13304
     1649    13305    1   END ASC$MOD_USER ;

  13305  3 001600   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:316  

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:317  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASC$MOD_USER.
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:318  

 **** Variables and constants ****

  ****  Section 002 RoData ASC$MOD_USER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(162)   r     1 TEXTC(0:2)                16-0-0/c STRC(18)    r     1 ZERO_LENGTH

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 I                          4-0-0/w SBIN        r     1 J
     5-0-0/w SBIN        r     1 K                          7-0-0/w SBIN        r     1 SAVE_MAXC
    10-0-0/w PTR         r     1 SET$                      11-0-0/w SBIN        r     1 VALUE(0:1)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ             0-0-0/w STRC(18576) r     1 AS_DFLT
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3                  0-0-0/w STRC(1483)  r     1 AS_MOD_USER
     0-0-0/w BIT         r     1 AS_PPRIVILEGE(0:20)
     0-0-0/w PTR         r     1 AS_PPRIV_NAMES(0:20)
     0-0-0/w BIT         r     1 AS_PRIVILEGE(0:23)
     0-0-0/w PTR         r     1 AS_PRIV_NAMES(0:23)
     0-0-0/w PTR         r     1 AS_SUPER_TO_PIG$           0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/w SBIN        r     1 AS_WILD_MCH
     0-0-0/w SBIN        r     1 AS_WILD_MVAL               0-0-0/w STRC(6084)  r     1 KL_DFLT
     0-0-0/w STRC(6084)  r     1 KL_DREC

  ****  BASED and DCB variables  ****

PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:319  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(522)   r     1 SUPER_TO_PIG               0-0-0/w ASTR(9)     r     1 VARY$STR


   Procedure ASC$MOD_USER requires 897 words for executable code.
   Procedure ASC$MOD_USER requires 16 words of local(AUTO) storage.

    No errors detected in file ASC$OPTS.:E05TSI    .
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:320  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:321  
          MINI XREF LISTING

ASA_BRKS_LOC
     10009**DCL     10009--REDEF
ASB$BINCHAR
      6494**DCL-ENT 13247--CALL    13255--CALL
ASB$PIG
     12903**DCL-ENT 13302--CALL
ASC$BANNER
     12909**DCL-ENT 13011--CALL
ASC$FEPSEUDO
     12900**DCL-ENT 13297--CALL
ASC$FERESOURCE
     12894**DCL-ENT 13295--CALL
ASC$MOD_USER_LIMITS
     12888**DCL-ENT 13293--CALL
ASC$PSEUDO
     12897**DCL-ENT 13296--CALL
ASC$RESOURCE
     12891**DCL-ENT 13294--CALL
ASC$SETUP
     12915**DCL-ENT 12977--CALL
ASH$ERROR
     12906**DCL-ENT 12991--CALL    13025--CALL    13219--CALL    13278--CALL
AS_CR_MOD_PROJ
     10017**DCL     13224>>IF      13228>>ASSIGN
AS_DEFAULT.BANNER_PERM
     10702**DCL     10703--REDEF
AS_DEFAULT.BUDGET.MACCT
     10607**DCL     10611--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10620**DCL     10623--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10603**DCL     10605--REDEF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:322  
AS_DEFAULT.BUDGET.PMAXC
     10598**DCL     10600--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10718**DCL     10719--REDEF   10720--REDEF
AS_DEFAULT_DREC.PASSWORD
     11972**DCL     11976--REDEF
AS_DEFAULT_DREC.RENAME
     11995**DCL     11996--REDEF
AS_DFLT.BANNER
     10537**DCL     13006>>ASSIGN
AS_DFLT.BANNER_PERM
     10524**DCL     10525--REDEF   13034>>ASSIGN
AS_DFLT.BATNUM
     10416**DCL     12963>>ASSIGN
AS_DFLT.BATOK
     10414**DCL     13104>>ASSIGN
AS_DFLT.BILL
     10448**DCL     13065>>ASSIGN
AS_DFLT.BUDGET.ACCUM
     10419**DCL     13285>>ASSIGN
AS_DFLT.BUDGET.BKACC
     10436**DCL     13190>>ASSIGN
AS_DFLT.BUDGET.BLINDACCTNG
     10440**DCL     13194>>ASSIGN
AS_DFLT.BUDGET.BUDLIM
     10437**DCL     13192>>ASSIGN
AS_DFLT.BUDGET.ICHARGES
     10439**DCL     13188>>ASSIGN
AS_DFLT.BUDGET.MACCT
     10429**DCL     10433--REDEF   13186>>ASSIGN
AS_DFLT.BUDGET.MAX_PROJECTS
     10442**DCL     10445--REDEF
AS_DFLT.BUDGET.PACCUM
     10425**DCL     10427--REDEF
AS_DFLT.BUDGET.PCHARGES
     10438**DCL     13184>>ASSIGN
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:323  
AS_DFLT.BUDGET.PMAXC
     10420**DCL     10422--REDEF
AS_DFLT.CPROC.NAME
     10478**DCL     13039>>ASSIGN
AS_DFLT.FLAGS.STARSACC
     10501**DCL     12968>>ASSIGN
AS_DFLT.HPSN
     10474**DCL     13095>>ASSIGN
AS_DFLT.KEY
     10449**DCL     13290>>ASSIGN
AS_DFLT.LASTCPROC.NAME
     10483**DCL     13059>>ASSIGN
AS_DFLT.LAST_LOGON_TIME
     10549**DCL     13044>>ASSIGN
AS_DFLT.MAXENQ
     10564**DCL     13173>>ASSIGN
AS_DFLT.NAT_LANG
     10412**DCL     12961>>ASSIGN
AS_DFLT.PRIOB
     10496**DCL     13179>>ASSIGN
AS_DFLT.QUAN
     10494**DCL     13167>>ASSIGN
AS_DFLT.SETUP
     10536**DCL     12972>>ASSIGN
AS_DFLT.SETUP_CHRA.TXT
     10540**DCL     10541--REDEF   10542--REDEF
AS_DFLT.SETUP_CHRA.TXT_UBIN
     10542**DCL     12976--ASSIGN  13010--ASSIGN
AS_DFLT.SETUP_FORCE
     10526**DCL     13052>>ASSIGN
AS_DFLT.SETUP_PERM
     10523**DCL     13000>>ASSIGN
AS_DFLT.STEPACCNT
     10413**DCL     12962>>ASSIGN
AS_FE_MODE
      9875**DCL      9876--REDEF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:324  
AS_FIELD1
     10005**DCL     13228<<ASSIGN
AS_FIELD2.TEXT
     10006**DCL     13247<>CALL
AS_FIELD3.COUNT
     10007**DCL     13261>>IF      13263<<ASSIGN
AS_FIELD3.TEXT
     10007**DCL     13255<>CALL    13264<<CALLBLT
AS_MODE
      9872**DCL      9874--REDEF
AS_MOD_USER.ACCESS
     12737**DCL     12738--REDEF   13098>>IF
AS_MOD_USER.ACCESS_A
     12738**DCL     13100>>IF
AS_MOD_USER.BANNER
     12724**DCL     12725--REDEF   13003>>IF
AS_MOD_USER.BANNER_A
     12725**DCL     13005>>IF
AS_MOD_USER.BANNER_PERM
     12726**DCL     12727--REDEF   13031>>IF
AS_MOD_USER.BANNER_PERM_A
     12727**DCL     13033>>IF
AS_MOD_USER.BATNUM
     12716**DCL     12963>>IF
AS_MOD_USER.BILL
     12732**DCL     12733--REDEF   13062>>IF
AS_MOD_USER.BILL_A
     12733**DCL     13064>>IF
AS_MOD_USER.BUDGET
     12751**DCL     13182>>IF
AS_MOD_USER.BUDGET.ACCUM
     12760**DCL     13284>>IF
AS_MOD_USER.BUDGET.BKACC
     12754**DCL     13189>>IF
AS_MOD_USER.BUDGET.BLINDACCTNG
     12756**DCL     13193>>IF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:325  
AS_MOD_USER.BUDGET.BUDLIM
     12755**DCL     13191>>IF
AS_MOD_USER.BUDGET.ICHARGES
     12753**DCL     13187>>IF
AS_MOD_USER.BUDGET.MACCT
     12759**DCL     13185>>IF
AS_MOD_USER.BUDGET.MAXC
     12757**DCL     13195>>IF
AS_MOD_USER.BUDGET.PCHARGES
     12752**DCL     13183>>IF
AS_MOD_USER.BUDGET.SIGN
     12758**DCL     13196>>IF      13196>>IF      13202>>IF
AS_MOD_USER.CPROC
     12728**DCL     12729--REDEF   13036>>IF
AS_MOD_USER.CPROC_A
     12729**DCL     13038>>IF
AS_MOD_USER.FACCOUNT
     12807**DCL     13298>>IF
AS_MOD_USER.FEBILL
     12808**DCL     12809--REDEF   13068>>IF
AS_MOD_USER.FEBILL_A
     12809**DCL     13070>>IF
AS_MOD_USER.FECXTMEM
     12825**DCL     12826--REDEF
AS_MOD_USER.FEDBACCN
     12824**DCL     12966>>IF
AS_MOD_USER.FEMACCTMEM
     12823**DCL     12965>>IF
AS_MOD_USER.FEMFPRG
     12812**DCL     12964>>IF
AS_MOD_USER.FEMINTS
     12810**DCL     12811--REDEF   13074>>IF
AS_MOD_USER.FEMINTS_A
     12811**DCL     13076>>IF
AS_MOD_USER.FEMMEM
     12821**DCL     12822--REDEF   13086>>IF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:326  
AS_MOD_USER.FEMMEM_A
     12822**DCL     13088>>IF
AS_MOD_USER.FEMTIME
     12819**DCL     12820--REDEF   13080>>IF
AS_MOD_USER.FEMTIME_A
     12820**DCL     13082>>IF
AS_MOD_USER.FEPPRIV
     12816**DCL     12818--REDEF   13152>>IF
AS_MOD_USER.FEPPRIV_A
     12818**DCL     13154>>IF      13157>>IF
AS_MOD_USER.FEPRIV
     12813**DCL     12815--REDEF   13140>>IF
AS_MOD_USER.FEPRIV_A
     12815**DCL     13142>>IF      13145>>IF
AS_MOD_USER.FEPSEUDO
     12827**DCL     13297>>IF
AS_MOD_USER.FERESOURCE
     12828**DCL     13295>>IF
AS_MOD_USER.FORCE_A
     12723**DCL     13050>>IF
AS_MOD_USER.FORCE_BIT
     12722**DCL     12723--REDEF   13047>>IF
AS_MOD_USER.HSET
     12735**DCL     13093>>IF
AS_MOD_USER.KEY
     12804**DCL     12806--REDEF   13287>>IF
AS_MOD_USER.KEY_A
     12806**DCL     13289>>IF
AS_MOD_USER.LASTCPROC
     12730**DCL     12731--REDEF   13056>>IF
AS_MOD_USER.LASTCPROC_A
     12731**DCL     13058>>IF
AS_MOD_USER.LAST_LOGON_TIME
     12830**DCL     13042>>IF
AS_MOD_USER.LIMITS
     12761**DCL     13293>>IF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:327  
AS_MOD_USER.LIMITS.DO_
     12778**DCL     12779--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12794**DCL     12795--REDEF
AS_MOD_USER.LIMITS.LO
     12774**DCL     12775--REDEF
AS_MOD_USER.LIMITS.MEM
     12770**DCL     12771--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12798**DCL     12799--REDEF
AS_MOD_USER.LIMITS.PDIS
     12786**DCL     12787--REDEF
AS_MOD_USER.LIMITS.PO
     12782**DCL     12783--REDEF
AS_MOD_USER.LIMITS.TDIS
     12790**DCL     12791--REDEF
AS_MOD_USER.LIMITS.TIME
     12766**DCL     12767--REDEF
AS_MOD_USER.MAXENQ
     12747**DCL     12748--REDEF   13170>>IF
AS_MOD_USER.MAXENQ_A
     12748**DCL     13172>>IF
AS_MOD_USER.NAT_LANG
     12714**DCL     12961>>IF
AS_MOD_USER.PASSWORD
     12713**DCL     12960>>IF
AS_MOD_USER.PERM_A
     12721**DCL     12999>>IF
AS_MOD_USER.PERM_BIT
     12720**DCL     12721--REDEF   12997>>IF
AS_MOD_USER.PPRIV
     12742**DCL     12744--REDEF   13128>>IF
AS_MOD_USER.PPRIV_A
     12744**DCL     13130>>IF      13133>>IF
AS_MOD_USER.PRIOB
     12749**DCL     12750--REDEF   13176>>IF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:328  
AS_MOD_USER.PRIOB_A
     12750**DCL     13178>>IF
AS_MOD_USER.PRIV
     12739**DCL     12741--REDEF   13116>>IF
AS_MOD_USER.PRIV_A
     12741**DCL     13118>>IF      13121>>IF
AS_MOD_USER.PROFILE
     12736**DCL     13097>>IF
AS_MOD_USER.PSEUDO
     12802**DCL     13296>>IF
AS_MOD_USER.QUAN
     12745**DCL     12746--REDEF   13164>>IF
AS_MOD_USER.QUAN_A
     12746**DCL     13166>>IF
AS_MOD_USER.RESOURCE
     12803**DCL     13294>>IF
AS_MOD_USER.SETUP
     12718**DCL     12719--REDEF   12969>>IF
AS_MOD_USER.SETUP_A
     12719**DCL     12971>>IF
AS_MOD_USER.STARSACC
     12717**DCL     12967>>IF
AS_MOD_USER.STEPACCNT
     12715**DCL     12962>>IF
AS_MOD_USER.WSN
     12734**DCL     13092>>IF
AS_PPRIVILEGE
      9872**DCL     13134>>ASSIGN  13136>>ASSIGN  13158>>ASSIGN  13160>>ASSIGN
AS_PPRIV_NAMES
      9871**DCL     13129--DOINDEX 13153--DOINDEX
AS_PRIVILEGE
      9872**DCL     13122>>ASSIGN  13124>>ASSIGN  13146>>ASSIGN  13148>>ASSIGN
AS_PRIV_NAMES
      9871**DCL     13117--DOINDEX 13141--DOINDEX
AS_PROJECT.BANNER_PERM
     11058**DCL     11059--REDEF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:329  
AS_PROJECT.BUDGET.MACCT
     10963**DCL     10967--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10976**DCL     10979--REDEF
AS_PROJECT.BUDGET.PACCUM
     10959**DCL     10961--REDEF
AS_PROJECT.BUDGET.PMAXC
     10954**DCL     10956--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11074**DCL     11075--REDEF   11076--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11236**DCL     11237--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11141**DCL     11145--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11154**DCL     11157--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11137**DCL     11139--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11132**DCL     11134--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11252**DCL     11253--REDEF   11254--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12458**DCL     12462--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12481**DCL     12482--REDEF
AS_PROJECT_DREC.PASSWORD
     12296**DCL     12300--REDEF
AS_PROJECT_DREC.RENAME
     12319**DCL     12320--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10880**DCL     10881--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10785**DCL     10789--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10798**DCL     10801--REDEF
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:330  
AS_PROJ_ADMIN.BUDGET.PACCUM
     10781**DCL     10783--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10776**DCL     10778--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10896**DCL     10897--REDEF   10898--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12134**DCL     12138--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12157**DCL     12158--REDEF
AS_SUPER_TO_PIG$
     10016**DCL     12923--IMP-PTR 13299>>ASSIGN  13300>>ASSIGN  13301>>ASSIGN  13302>>CALL    13302>>CALL
AS_TRUE
      9869**DCL     13050>>IF      13294<>CALL    13295<>CALL    13296<>CALL    13297<>CALL
AS_USERS
     10231**DCL     12977--CALL    13011--CALL
AS_USERS.ACCT
     10232**DCL     13300>>ASSIGN
AS_USERS.BANNER_PERM
     10346**DCL     10347--REDEF   13034<<ASSIGN
AS_USERS.BATNUM
     10238**DCL     12963<<ASSIGN
AS_USERS.BATOK
     10236**DCL     13104<<ASSIGN
AS_USERS.BILL
     10270**DCL     13065<<ASSIGN
AS_USERS.BUDGET.ACCUM
     10241**DCL     13285<<ASSIGN
AS_USERS.BUDGET.BKACC
     10258**DCL     13190<<ASSIGN
AS_USERS.BUDGET.BLINDACCTNG
     10262**DCL     13194<<ASSIGN
AS_USERS.BUDGET.BUDLIM
     10259**DCL     13192<<ASSIGN
AS_USERS.BUDGET.ICHARGES
     10261**DCL     13188<<ASSIGN
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:331  
AS_USERS.BUDGET.MACCT
     10251**DCL     10255--REDEF   13186<<ASSIGN
AS_USERS.BUDGET.MAXC
     10240**DCL     13196>>IF      13199<<ASSIGN  13201>>ASSIGN  13203<<ASSIGN  13205<<ASSIGN  13205>>ASSIGN
     13206>>IF      13222<<ASSIGN  13226>>IF      13281<<ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
     10264**DCL     10267--REDEF
AS_USERS.BUDGET.PACCUM
     10247**DCL     10249--REDEF
AS_USERS.BUDGET.PCHARGES
     10260**DCL     13184<<ASSIGN
AS_USERS.BUDGET.PMAXC
     10242**DCL     10244--REDEF
AS_USERS.CPROC.NAME
     10300**DCL     13039<<ASSIGN
AS_USERS.FLAGS.STARSACC
     10323**DCL     12968<<ASSIGN
AS_USERS.HPSN
     10296**DCL     13095<<ASSIGN  13301>>ASSIGN
AS_USERS.KEY
     10271**DCL     13290<<ASSIGN
AS_USERS.LASTCPROC.NAME
     10305**DCL     13059<<ASSIGN
AS_USERS.LAST_LOGON_TIME
     10371**DCL     13044<<ASSIGN
AS_USERS.MAXENQ
     10386**DCL     13173<<ASSIGN
AS_USERS.NAT_LANG
     10234**DCL     12961<<ASSIGN
AS_USERS.PPRIV
     10310**DCL     13134<<ASSIGN  13134>>ASSIGN  13136<<ASSIGN  13136>>ASSIGN
AS_USERS.PRIOB
     10318**DCL     13179<<ASSIGN
AS_USERS.PRIV
     10309**DCL     13122<<ASSIGN  13122>>ASSIGN  13124<<ASSIGN  13124>>ASSIGN
AS_USERS.QUAN
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:332  
     10316**DCL     13167<<ASSIGN
AS_USERS.SETUP_CHRA.TXT
     10362**DCL     10363--REDEF   10364--REDEF
AS_USERS.SETUP_FORCE
     10348**DCL     13052<<ASSIGN
AS_USERS.SETUP_PERM
     10345**DCL     13000<<ASSIGN
AS_USERS.STEPACCNT
     10235**DCL     12962<<ASSIGN
AS_USERS_CONSTANT.BANNER_PERM
     11414**DCL     11415--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11319**DCL     11323--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11332**DCL     11335--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11315**DCL     11317--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11310**DCL     11312--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11430**DCL     11431--REDEF   11432--REDEF
AS_WILD_MCH
     10018**DCL     13224>>IF      13226>>IF      13229>>ASSIGN  13230>>ASSIGN  13281>>ASSIGN
AS_WILD_MVAL
     10018**DCL     13196>>IF      13203>>ASSIGN  13205>>ASSIGN
ERR_CODE
     10004**DCL     10005--REDEF
I
     12866**DCL     12970<<DOINDEX 12971>>IF      12972>>ASSIGN  12977<>CALL    12998<<DOINDEX 12999>>IF
     13000>>ASSIGN  13000>>ASSIGN  13004<<DOINDEX 13005>>IF      13006>>ASSIGN  13011<>CALL    13032<<DOINDEX
     13033>>IF      13034>>ASSIGN  13034>>ASSIGN  13037<<DOINDEX 13038>>IF      13039>>ASSIGN  13039>>ASSIGN
     13049<<DOINDEX 13050>>IF      13052>>ASSIGN  13052>>ASSIGN  13057<<DOINDEX 13058>>IF      13059>>ASSIGN
     13059>>ASSIGN  13063<<DOINDEX 13064>>IF      13065>>ASSIGN  13065>>ASSIGN  13069<<DOINDEX 13070>>IF
     13071>>ASSIGN  13071>>ASSIGN  13075<<DOINDEX 13076>>IF      13077>>ASSIGN  13077>>ASSIGN  13081<<DOINDEX
     13082>>IF      13083>>ASSIGN  13083>>ASSIGN  13087<<DOINDEX 13088>>IF      13089>>ASSIGN  13089>>ASSIGN
     13099<<DOINDEX 13100>>IF      13101>>DOSELCT 13117<<DOINDEX 13118>>IF      13119>>ASSIGN  13120>>ASSIGN
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:333  
     13121>>IF      13129<<DOINDEX 13130>>IF      13131>>ASSIGN  13132>>ASSIGN  13133>>IF      13141<<DOINDEX
     13142>>IF      13143>>ASSIGN  13144>>ASSIGN  13145>>IF      13153<<DOINDEX 13154>>IF      13155>>ASSIGN
     13156>>ASSIGN  13157>>IF      13165<<DOINDEX 13166>>IF      13167>>ASSIGN  13167>>ASSIGN  13171<<DOINDEX
     13172>>IF      13173>>ASSIGN  13173>>ASSIGN  13177<<DOINDEX 13178>>IF      13179>>ASSIGN  13179>>ASSIGN
     13288<<DOINDEX 13289>>IF      13290>>ASSIGN  13290>>ASSIGN
J
     12867**DCL     12972<<ASSIGN  12973>>IF      12976>>ASSIGN  13006<<ASSIGN  13007>>IF      13010>>ASSIGN
     13119<<ASSIGN  13122>>ASSIGN  13124>>ASSIGN  13131<<ASSIGN  13134>>ASSIGN  13136>>ASSIGN  13143<<ASSIGN
     13146>>ASSIGN  13148>>ASSIGN  13155<<ASSIGN  13158>>ASSIGN  13160>>ASSIGN
K
     12868**DCL     13120<<ASSIGN  13122>>ASSIGN  13122>>ASSIGN  13124>>ASSIGN  13124>>ASSIGN  13132<<ASSIGN
     13134>>ASSIGN  13134>>ASSIGN  13136>>ASSIGN  13136>>ASSIGN  13144<<ASSIGN  13146>>ASSIGN  13146>>ASSIGN
     13148>>ASSIGN  13148>>ASSIGN  13156<<ASSIGN  13158>>ASSIGN  13158>>ASSIGN  13160>>ASSIGN  13160>>ASSIGN
KL_DEFAULT.PASSWORD
     12620**DCL     12624--REDEF
KL_DEFAULT.RENAME
     12643**DCL     12644--REDEF
KL_DFLT.FLAGS.BATOK
     11774**DCL     13103>>ASSIGN
KL_DFLT.FLAGS.FEOK
     11798**DCL     13110>>ASSIGN
KL_DFLT.FLAGS.GHOSTOK
     11767**DCL     13108>>ASSIGN
KL_DFLT.FLAGS.OLOK
     11770**DCL     13106>>ASSIGN
KL_DFLT.FLAGS.TPOK
     11794**DCL     13112>>ASSIGN
KL_DFLT.HPS.N
     11838**DCL     13094>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.BILL
     11870**DCL     13071>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.DBACCN
     11871**DCL     12966>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MACCTMEM
     11874**DCL     12965>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MFPRG
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:334  
     11873**DCL     12964>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MINTS
     11872**DCL     13077>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MMEM
     11881**DCL     13089>>ASSIGN
KL_DFLT.KL_DFLT_FEBLK.MTIME
     11880**DCL     13083>>ASSIGN
KL_DFLT.PASSWORD
     11810**DCL     11814--REDEF   12960>>ASSIGN
KL_DFLT.PNAME
     11816**DCL     13097>>ASSIGN
KL_DFLT.RENAME
     11833**DCL     11834--REDEF
KL_DFLT.WOO
     11830**DCL     13092>>ASSIGN
KL_DREC.FLAGS.BATOK
     11612**DCL     13103<<ASSIGN
KL_DREC.FLAGS.FEOK
     11636**DCL     13110<<ASSIGN
KL_DREC.FLAGS.GHOSTOK
     11605**DCL     13108<<ASSIGN
KL_DREC.FLAGS.OLOK
     11608**DCL     13106<<ASSIGN
KL_DREC.FLAGS.TPOK
     11632**DCL     13112<<ASSIGN
KL_DREC.HPS.N
     11676**DCL     13094<<ASSIGN
KL_DREC.KL_DREC_FEBLK.BILL
     11708**DCL     13071<<ASSIGN
KL_DREC.KL_DREC_FEBLK.DBACCN
     11709**DCL     12966<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MACCTMEM
     11712**DCL     12965<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MFPRG
     11711**DCL     12964<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MINTS
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:335  
     11710**DCL     13077<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MMEM
     11719**DCL     13089<<ASSIGN
KL_DREC.KL_DREC_FEBLK.MTIME
     11718**DCL     13083<<ASSIGN
KL_DREC.KL_DREC_FEBLK.PPRIV
     11717**DCL     13158<<ASSIGN  13158>>ASSIGN  13160<<ASSIGN  13160>>ASSIGN
KL_DREC.KL_DREC_FEBLK.PRIV
     11716**DCL     13146<<ASSIGN  13146>>ASSIGN  13148<<ASSIGN  13148>>ASSIGN
KL_DREC.PASSWORD
     11648**DCL     11652--REDEF   12960<<ASSIGN
KL_DREC.PNAME
     11654**DCL     13097<<ASSIGN
KL_DREC.RENAME
     11671**DCL     11672--REDEF
KL_DREC.WOO
     11668**DCL     13092<<ASSIGN
KL_DREC_CNT.PASSWORD
     11535**DCL     11539--REDEF
KL_DREC_CNT.RENAME
     11558**DCL     11559--REDEF
PROJ_KEY.TEXT
      9882**DCL      9882--REDEF
PROJ_KEY.TXT.PROJECT
      9882**DCL      9882--REDEF
REMEM_VAR
     10008**DCL     10008--REDEF
REM_FCMD
     10008**DCL     10009--REDEF
SAVE_MAXC
     12870**DCL     13201<<ASSIGN  13222>>ASSIGN
SET$
     12871**DCL     12876--IMP-PTR 12974<<ASSIGN  12976<<ASSIGN  12977>>CALL    12977>>CALL    13008<<ASSIGN
     13010<<ASSIGN  13011>>CALL    13011>>CALL
SUPER_TO_PIG
     12923**DCL     13302<>CALL
PL6.E3A0      #002=ASC$MOD_USER File=ASC$OPTS.:E05TSI                            TUE 07/29/97 09:41 Page:336  
SUPER_TO_PIG.ACCT
     12944**DCL     13300<<ASSIGN
SUPER_TO_PIG.ATTR.COUNT
     12946**DCL     12949--IMP-SIZ 13302>>CALL
SUPER_TO_PIG.PACKSET
     12943**DCL     13301<<ASSIGN
SUPER_TO_PIG.PROJECT
     12939**DCL     12942--REDEF
SUPER_TO_PIG.SUPER
     12935**DCL     12938--REDEF
SUPER_TO_PIG.TYPE
     12924**DCL     13299<<ASSIGN
TEXTC
     12873**DCL     13228>>ASSIGN
USERS_KEY.TEXT
      9879**DCL      9880--REDEF    9880--REDEF    9880--REDEF    9881--REDEF
VALUE
     12872**DCL     13229<<ASSIGN  13230<<ASSIGN  13247<>CALL    13255<>CALL
VARY$STR
     12876**DCL     12977<>CALL    13011<>CALL
VARY$STR.CNT
     12877**DCL     12878--IMP-SIZ 12977>>CALL    13011>>CALL
ZERO_LENGTH
     12879**DCL     12974--ASSIGN  13008--ASSIGN
