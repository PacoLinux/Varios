VERSION E05

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:1    
        1        1        /*M* JCS$SLUG Main routine for SLUG ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*DMC,PLM=6,IND=2,ENU=2,DCI=4,CSU=2,ECU=2,THI=2,DTI=0*/
        8        8        /**/
        9        9        /**/
       10       10        JCS$SLUG: PROC MAIN;
       11       11        /**/
       12       12        /**/
       13       13        %INCLUDE B$ROSEG;
       14       76 S      %INCLUDE B$JIT_C;
       15       77        %B$JIT0;
       16      166        %U$JIT1;
       17      240        %M$JIT2;
       18      250        %F$JIT3;
       19      255        %S$JIT4;
       20      261        %J$JIT5;
       21      349        %A$JIT6;
       22      359        %INCLUDE CP_6;
       23      440        %INCLUDE CP_6_SUBS;
       24      980        %INCLUDE EL_SUBS_C;
       25     1064        %INCLUDE F$DCB;
       26     1113        %INCLUDE F_ERRORS_C;
       27     1353        %INCLUDE I_SUBS_C;
       28     1377        %INCLUDE JC_MACRO_C;
       29     1491        %INCLUDE JC_DATA_R;
       30     1529        %INCLUDE JC_SCODE_C;
       31     1545        %INCLUDE JC_SUBS_C;
       32     1558        %INCLUDE JG_EVID_C;
       33     1783        %INCLUDE JG_GHOSTS_C;
       34     1873        %INCLUDE JMC_DATA_R;
       35     1888        %INCLUDE KC_ERRORS_C;
       36     1935        %INCLUDE OC_MESSHD_C;
       37     1988        %INCLUDE OC_SUBS_C;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:2    
       38     2719        /**/
       39     2720        %B$TCB;
       40     2723        %B$ALT;
       41     2731        /**/
       42     2732        /**/
       43     2733    1   DCL RO$ PTR;
       44     2734    1   DCL I UBIN WORD;
       45     2735    1   DCL 1 TPTR STATIC ALIGNED,
       46     2736    1         2 OFFSET SBIN(18) UNAL INIT(0),
       47     2737    1         2 * UBIN(6) UNAL INIT(0),
       48     2738    1         2 SEGID BIT(12) UNAL INIT('6003'O);
       49     2739    1   DCL TPTR$ REDEF TPTR PTR;
       50     2740    1   DCL TLFT UBIN WORD STATIC DALIGNED INIT(60);
       51     2741    1   DCL 1 BTOFF CONSTANT ALIGNED,
       52     2742    1         2 OCAX UBIN BYTE UNAL INIT(MKV_OCA$KMISC#),
       53     2743    1         2 KEY# UBIN BYTE UNAL INIT(KEY_BATCH#),
       54     2744    1         2 CADDR BIT(18) UNAL INIT(M_SYS),
       55     2745    1         2 FLAG UBIN WORD INIT(3);
       56     2746    1   DCL JC_CSMBF CHAR(300) STATIC SYMDEF;
       57     2747    1   DCL JC_FERD UBIN WORD STATIC SYMDEF INIT(0);  /* Read pending on CG/HLPCG if 0 */
       58     2748    1   DCL JC_CSRD UBIN WORD STATIC SYMDEF INIT(0);
              2748            /* Read pending on CG/CSCG(SLUG) if 0 */
       59     2749    1   DCL JC_MBSRD UBIN WORD STATIC SYMDEF INIT(0);
              2749            /* Read pending on CG/CSCG(MBS) if 0 */
       60     2750    1   DCL JC_TBOOT UBIN WORD STATIC SYMDEF INIT(0);
       61     2751    1   DCL 1 JC_SUPER STATIC SYMDEF ALIGNED,
       62     2752    1         2 PRO UBIN HALF UNAL INIT(0),
       63     2753    1         2 UHWF UBIN HALF UNAL INIT(0);
       64     2754    1   DCL 1 JG_SGHST ALIGNED STATIC SYMDEF,
       65     2755    1         2 G (0:JG_MING#) BIT(1) INIT('0'B*0);
       66     2756    1   DCL JC_ZIP SBIN WORD SYMREF;
       67     2757    1   DCL ERCOD BIT(36) STATIC DALIGNED;
       68     2758    1   DCL B$TCB$ PTR SYMREF;
       69     2759    1   DCL B$JIT$ PTR SYMREF READONLY;
       70     2760    1   DCL JC_JIT UBIN SYMREF; /* Really an entire JIT */
       71     2761    1   DCL JC_ROSEG (0:1023) UBIN WORD DALIGNED SYMREF;
       72     2762    1   DCL JC_RODCB$(0:0) PTR SYMREF;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:3    
       73     2763    1   DCL JC_UCTABS UBIN WORD SYMREF;    /*** DUMMY ***/
       74     2764    1   DCL JC_UCSTA UBIN WORD SYMREF;    /*** DUMMY ***/
       75     2765    1   DCL JC_UCSST UBIN WORD SYMREF;    /*** DUMMY ***/
       76     2766    1   DCL KL_NODES UBIN SYMREF;
       77     2767    1   DCL KL_MXFE UBIN SYMREF;
       78     2768    1   DCL 1 JC_ROAVL DALIGNED SYMREF,
       79     2769    1         2 PTR$ PTR,
       80     2770    1         2 SIZ SBIN;
       81     2771    1   DCL M_UC UBIN WORD DALIGNED SYMREF;     /* DUMMY */
       82     2772    1   DCL FOI$CRASHGO ENTRY(3) ALTRET;
       83     2773    1   DCL JGI$SGHST ENTRY;
       84     2774    1   DCL JMM$INIT0 ENTRY;
       85     2775    1   DCL JMM$PROCESS ENTRY;
       86     2776    1   DCL JMR$TIME ENTRY;
       87     2777    1   DCL JCE$EVENT ENTRY(1);
       88     2778    1   DCL JCE$EVNT ENTRY ASYNC;
       89     2779    1   DCL JCE$XCON ENTRY ASYNC;
       90     2780    1   DCL JCS$ACLGM ENTRY;
       91     2781    1   DCL JCS$CRACLG ENTRY;
       92     2782    1   DCL JCS$OPACLG ENTRY;
       93     2783    1   DCL JCP$PROCESS ENTRY;
       94     2784    1   DCL JCP$ZIPCK ENTRY;
       95     2785    1   DCL M$CSCGAU DCB;
       96     2786    1   DCL M$CSCG DCB;
       97     2787    1   DCL M$GHOST DCB;
       98     2788        /**/
       99     2789        %SUB F_JC='1203'O;
      100     2790        %SUB M_S='23'O;
      101     2791        /**/
      102     2792        %FPT_WRSYSLOG (FPTN=FPT_SLUGUP,STCLASS=CONSTANT,
      103     2793              ENTRY=DUMMYENT,SIZE=1,MMINHIB=NO,FILENUM=2,TYPE=EL_SLUGUP);
      104     2808    1   DCL DUMMYENT UBIN CONSTANT INIT(0);
      105     2809        %OC_MESSHD_W (NAME=BFLM,STCLASS=STATIC,NPARMS=1,ATR=M_SYS);
      106     2822    1         2 FCNT UBIN BYTE UNAL INIT(1),
      107     2823    1         2 FILE UBIN BYTE UNAL INIT(0);
      108     2824        %FPT_EVENT (UENTRY=JCE$EVNT,STCLASS=CONSTANT);
      109     2838        %FPT_XCON (UENTRY=JCE$XCON,STCLASS=CONSTANT);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:4    
      110     2852        %FPT_OPEN (FPTN=OPCSAU,STCLASS=CONSTANT,DCB=M$CSCGAU,NAME=CSCG,CTG=YES,
      111     2853                   ASN=COMGROUP,FUN=CREATE,EXIST=NEWFILE,ORG=CONSEC,AU=YES,
      112     2854                  ACSVEH=CSCG_ACSVEH,ACCESS=CSCG_ACCESS,SHARE=ALL,IXTNSIZE=200);
      113     2963        %VLP_ATTR(FPTN=CSCG_ACSVEH,STCLASS=CONSTANT);
      114     2977        %VLP_ACSVEH(VEHICLE='TPA',WNEW=YES,READ=YES,LAST=",");
      115     2994        %VLP_ACSVEH(VEHICLE='JAYS',WNEW=YES,READ=YES,LAST=",");
      116     3011        %VLP_ACSVEH(VEHICLE='REPLAY',WNEW=YES,READ=YES,LAST=",");
      117     3028        %VLP_ACSVEH(VEHICLE='SUPER?',READ=YES,WNEW=YES,UPD=YES,DELR=YES);
      118     3045        %VLP_ACSVEH(VEHICLE='GOOSE',WNEW=YES,READ=YES,LAST=";");
      119     3062        %VLP_ATTR(FPTN=CSCG_ACCESS,STCLASS=CONSTANT);
      120     3076        %VLP_ACCESS(ACCT='?',EXEC=YES,LAST=";");
      121     3093        %FPT_CGCTL (FPTN=CSCTL,STCLASS=CONSTANT,DCB=M$CSCGAU,CGCP=CSPRM);
      122     3116        %VLP_CGCP (FPTN=CSPRM,STCLASS=CONSTANT,CONMSG=YES,
      123     3117                   MAXPG=100,DATAPGS=10,
      124     3118                  MEMWARN=25,DISKWARN=25,
      125     3119                   TERMCONAU=NO,DCBCONAU=YES,TERMCONNAU=NO,DCBCONNAU=YES,
      126     3120                   AUCONTERM=DISCONNECT,AUCONDCB=NC,AUDCONTERM=DISCONNECT,
      127     3121                   AUDCONDCB=NC,XSTALGL=YES,WAS=YES,RAS=YES,SMD=YES,XTYPLGL=YES,
      128     3122                   MAXMC=CSCG_MAXMC_REAL#,DCBCONLGL=YES,TERMCONLGL=NO,INPUT=YES,
      129     3123                   OUTPUT=YES,SECURE=NO);
      130     3166        %FPT_CLOSE (FPTN=CLCSAU,STCLASS=CONSTANT,DCB=M$CSCGAU);
      131     3208        %FPT_WAIT (FPTN=WAITMIN,STCLASS=STATIC,UNITS=60,UETIME=TLFT);
      132     3222        %VLP_ACCT (FPTN=SYS,STCLASS=CONSTANT,ACCT=':SYS');
      133     3235        %FPT_OPEN (FPTN=OPCSCG,DCB=M$CSCG,STCLASS=CONSTANT,NAME=CSCG,
      134     3236                   ASN=COMGROUP,FUN=UPDATE,SETSTA=CSST);
      135     3345        %VLP_NAME (FPTN=CSCG,NAME='CSCG',STCLASS=CONSTANT,LEN=7);
      136     3372        %VLP_SETSTA (FPTN=CSST,STCLASS=CONSTANT,MYSTATION='SLUG',OSTATION='KEYIN',WAS=YES);
      137     3400        %FPT_READ (FPTN=RDCSCG,STCLASS=CONSTANT,DCB=M$CSCG,
      138     3401                   BUF=JC_CSMBF,WAIT=NO,EVENT=JC_CSRD#);
      139     3440        %FPT_READ (FPTN=JM_RDMBS,STCLASS=SYMREF);
      140     3479        %FPT_READ  (FPTN=KL_RDHLP,STCLASS=SYMREF);
      141     3518        %FPT_MONINFO (FPTN=GBOOT,STCLASS=CONSTANT,MONINFO=BOOT);
      142     3533        %VLR_MONINFO (FPTN=BOOT,STCLASS=STATIC);
      143     3551        %FPT_OPEN (FPTN=JMM_OPEN_CSCG,STCLASS=SYMREF);
      144     3660        %FPT_WRITE (FPTN=WBFL,STCLASS=STATIC,DCB=M$CSCG,BUF=BFLM,STATION=WSTA);
      145     3691        %VLP_STATION (FPTN=WSTA,STCLASS=STATIC,STATION='KEYIN');
      146     3718        %FPT_OPEN (FPTN=TSTF,STCLASS=STATIC,DCB=M$GHOST,NAME=JOBSTATS,ACCT=SYS,
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:5    
      147     3719                   ASN=FILE,FUN=UPDATE,FPARAM=ERCOD,ACS=DIRECT);
      148     3828        %VLP_NAME (FPTN=COMAC,STCLASS=CONSTANT,NAME=':COMAC',LEN=7);
      149     3855        %FPT_CLOSE (FPTN=CLTF,STCLASS=STATIC,DCB=M$GHOST);
      150     3897        %VLP_ATTR (FPTN=ACCESS_EXECALL,STCLASS=CONSTANT);
      151     3911        %VLP_ACCESS (EXEC=YES,ACCT='?',LAST=";");
      152     3928        %VLP_ATTR (FPTN=ACSVEH_HLP,STCLASS=CONSTANT);
      153     3942        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='IBEX');
      154     3959        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='TPCP');
      155     3976        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='TPA');
      156     3993        %VLP_ACSVEH (READ=YES,VEHICLE='LOGON');
      157     4010        %VLP_ACSVEH (READ=YES,VEHICLE='NETCON');
      158     4027        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,DELR=YES,VEHICLE='SUPER?');
      159     4044        %VLP_ACSVEH (READ=YES,VEHICLE='PIGETTE');
      160     4061        %VLP_ACSVEH (READ=YES,VEHICLE='PRESCAN',LAST=";");
      161     4078        %VLP_ATTR (FPTN=ACSVEH_USERS,STCLASS=CONSTANT);
      162     4092        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='IBEX');
      163     4109        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='TPCP');
      164     4126        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='LOGON');
      165     4143        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='PRESCAN');
      166     4160        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='SUPER?');
      167     4177        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='SLUG',LAST=";");
      168     4194        %VLP_NAME (FPTN=JOBSTATS,STCLASS=CONSTANT,NAME=':JOBSTATS',LEN=11);
      169     4221        %VLP_NAME (FPTN=PRO,STCLASS=CONSTANT,NAME=':PRO',LEN=7);
      170     4248        %VLP_NAME (FPTN=WSN,STCLASS=CONSTANT,NAME=':WSN',LEN=7);
      171     4275        %VLP_NAME (FPTN=HLP,STCLASS=CONSTANT,NAME=':HLP',LEN=7);
      172     4302        %VLP_NAME (FPTN=FORM,STCLASS=CONSTANT,NAME=':FORM',LEN=7);
      173     4329        %VLP_NAME (FPTN=USERS,STCLASS=CONSTANT,NAME=':USERS',LEN=7);
      174     4356        %FPT_READ (FPTN=RLCL,STCLASS=STATIC,DCB=M$GHOST,BUF=ERCOD,KEY=LCL,KEYS=YES);
      175     4395        %VLP_NAME (FPTN=LCL,STCLASS=CONSTANT,NAME='LOCAL   *',LEN=11);
      176     4422        %VLP_NAME (FPTN=LCLSTA,STCLASS=CONSTANT,NAME='LOCAL   STATION',LEN=15);
      177     4449        %FPT_OPEN (FPTN=DLTF,STCLASS=STATIC,ASN=FILE,DCB=M$GHOST,DELETE=YES);
      178     4558        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:6    
      179     4559    1         CALL M$MONINFO (GBOOT)
      180     4560    2           WHENALTRETURN DO;
      181     4561    2         END;
      182     4562    1         IF B$JIT$->B$JIT.SYSID ~= JG_SLUG# THEN CALL M$EXIT;
      183     4563    1         CALL JITINIT;
      184     4564        /**/
      185     4565        /* Initialize default ROSEG that SLUG gives to all new users                 */
      186     4566        /**/
      187     4567    1         RO$=ADDR(JC_ROSEG);
      188     4568    1         TPTR.OFFSET=POFFW(ADDR(JC_RODCB$),RO$);
      189     4569    1         RO$->B$ROSEG.DCBPTR$=TPTR$;
      190     4570    1         TPTR.OFFSET=POFFW(ADDR(JC_ROAVL),RO$);
      191     4571    1         RO$->B$ROSEG.AVAIL$=TPTR$;
      192     4572    2         DO I=0 TO RO$->B$ROSEG.NUMDCBS;
      193     4573    3           IF JC_RODCB$(I)~=ADDR(NIL) THEN DO;
      194     4574    3             TPTR.OFFSET=POFFW(JC_RODCB$(I),RO$);
      195     4575    3             JC_RODCB$(I)=TPTR$;
      196     4576    3           END;
      197     4577    2         END;
      198     4578    1         JC_ROAVL.SIZ=1024-POFFW(ADDR(JC_ROAVL),RO$);
      199     4579    1         TPTR.OFFSET=POFFW(ADDR(JC_UCTABS),RO$);
      200     4580    1         ADDR(M_UC)->F$DCB.TAB$=TPTR$;
      201     4581    1         TPTR.OFFSET=POFFW(ADDR(JC_UCSTA),RO$);
      202     4582    1         ADDR(M_UC)->F$DCB.LASTSTA$=TPTR$;
      203     4583    1         TPTR.OFFSET=POFFW(ADDR(JC_UCSST),RO$);
      204     4584    1         ADDR(M_UC)->F$DCB.SETSTA$=TPTR$;
      205     4585        /**/
      206     4586        /* Tell ELF that SLUG is up so that ELF may finish his housekeeping */
      207     4587        /**/
      208     4588    1         CALL M$WRSYSLOG (FPT_SLUGUP);
      209     4589    1         CALL M$EVENT (FPT_EVENT);
      210     4590    1         CALL M$XCON (FPT_XCON);
      211     4591        /**/
      212     4592        /* Create and become non-AU user of CG/CSCG */
      213     4593        /**/
      214     4594    1         CALL M$OPEN (OPCSAU) ALTRET (SC2);
      215     4595    1         CALL M$CGCTL (CSCTL) ALTRET (SC2);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:7    
      216     4596    1         CALL M$OPEN (OPCSCG) ALTRET (SC2);
      217     4597    1         CALL M$CLOSE (CLCSAU) ALTRET (MONINFO);
      218     4598        /**/
      219     4599        /* Set JC_TBOOT:
      220     4600                      0 -----> Disk boot or crash recovery
      221     4601                      1 -----> Tape boot - under files (N to NEW FILES)
      222     4602                      2 -----> Tape boot - S files only
      223     4603                      3 -----> Tape boot over files    (S to NEW FILES)
      224     4604        */
      225     4605        /**/
      226     4606    1   MONINFO: CALL M$MONINFO (GBOOT) ALTRET (EVNTON);
      227     4607    1         KL_NODES = BOOT.NUM_NODES;
      228     4608    1         KL_MXFE = BOOT.NUM_NODES;
      229     4609    2         DO CASE (BOOT.BOOTFLAG#);
      230     4610    2           CASE(I_NEWFILES);
      231     4611    2             JC_TBOOT=3;
      232     4612    2           CASE(I_SYSFILES,I_SYSFILES_RECON);
      233     4613    2             JC_TBOOT=2;
      234     4614    2           CASE(I_NOFILES,I_NOFILES_RECON);
      235     4615    2             JC_TBOOT=1;
      236     4616    2           END;
      237     4617        /**/
      238     4618        /* Check on the condition of any old files that we need */
      239     4619        /**/
      240     4620    2   EVNTON: IF JC_TBOOT~=3 THEN DO;
      241     4621        /**/
      242     4622        /* Open :ACCTLG */
      243     4623        /**/
      244     4624    2           CALL JCS$OPACLG;
      245     4625        /**/
      246     4626        /* :JOBSTATS */
      247     4627        /**/
      248     4628    2           CALL M$OPEN (TSTF) ALTRET (NOJBS);
      249     4629    2           CALL M$CLOSE (CLTF) ALTRET (NOJBS);
      250     4630    2           GOTO GOTJBS;
      251     4631    2   NOJBS:  ;
      252     4632    2           CALL ERDL;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:8    
      253     4633    2           BFLM.MSG#=BDJBS_MSG#;
      254     4634    2           CALL M$WRITE (WBFL) ALTRET (GOTJBS);
      255     4635        /**/
      256     4636        /* :COMAC */
      257     4637        /**/
      258     4638    2   GOTJBS: ;
      259     4639    2           TSTF.NAME_=VECTOR(COMAC);
      260     4640    2           CALL M$OPEN (TSTF) ALTRET (NOCMAC);
      261     4641    2           CALL M$CLOSE (CLTF) ALTRET (NOCMAC);
      262     4642    2           GOTO GOTCMAC;
      263     4643    2   NOCMAC: ;
      264     4644    2           CALL ERDL;
      265     4645    2           BFLM.MSG#=BCMAC_MSG#;
      266     4646    2           CALL M$WRITE (WBFL) ALTRET (GOTCMAC);
      267     4647        /**/
      268     4648        /* :PRO */
      269     4649        /**/
      270     4650    2   GOTCMAC: ;
      271     4651    2           TSTF.NAME_=VECTOR(PRO);
      272     4652    2           CALL M$OPEN (TSTF) ALTRET (NOPRO);
      273     4653    2           CALL M$CLOSE (CLTF) ALTRET (NOPRO);
      274     4654    2           GOTO GOTPRO;
      275     4655    2   NOPRO:  ;
      276     4656    2           JC_SUPER.PRO=1;
      277     4657    2           CALL ERDL;
      278     4658    2           BFLM.MSG#=BDPRO_MSG#;
      279     4659    2           CALL M$WRITE (WBFL) ALTRET (GOTPRO);
      280     4660        /**/
      281     4661        /* :FORM */
      282     4662        /**/
      283     4663    2   GOTPRO: ;
      284     4664    2           TSTF.NAME_=VECTOR(FORM);
      285     4665    2           CALL M$OPEN (TSTF) ALTRET (NOFORM);
      286     4666    2           CALL M$CLOSE (CLTF) ALTRET (NOFORM);
      287     4667    2           GOTO GOTFORM;
      288     4668    2   NOFORM: ;
      289     4669    2           JC_SUPER.UHWF=4;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:9    
      290     4670    2           CALL ERDL;
      291     4671        /**/
      292     4672        /* :WSN */
      293     4673        /**/
      294     4674    2   GOTFORM:;
      295     4675    2           TSTF.NAME_=VECTOR(WSN);
      296     4676    3           IF JC_SUPER.UHWF=0 THEN DO;
      297     4677    3             CALL M$OPEN (TSTF) ALTRET (NOWSN);
      298     4678    3             CALL M$READ (RLCL) ALTRET (NRWSN); /* Look for 'LOCAL   STATION'        */
      299     4679    3             CALL M$CLOSE (CLTF) ALTRET (NOWSN);
      300     4680    3             GOTO GOTWSN;
      301     4681    3   NRWSN:    ;
      302     4682    3             CALL RDCK ALTRET (GOTWSN);
      303     4683    3   NOWSN:    ;
      304     4684    3             JC_SUPER.UHWF=3;
      305     4685    3           END;
      306     4686    2           CALL ERDL;
      307     4687        /**/
      308     4688        /* :HLP */
      309     4689        /**/
      310     4690    2   GOTWSN: ;
      311     4691    2           TSTF.NAME_=VECTOR(HLP);
      312     4692    2           CLTF.V.OPER.CHGATT# = '1'B;
      313     4693    2           CLTF.ACCESS_ = VECTOR(ACCESS_EXECALL);
      314     4694    2           CLTF.ACSVEH_ = VECTOR(ACSVEH_HLP);
      315     4695    3           IF JC_SUPER.UHWF=0 THEN DO;
      316     4696    3             CALL M$OPEN (TSTF) ALTRET (NOHLP);
      317     4697    3             RLCL.KEY_ = VECTOR(LCLSTA);
      318     4698    3             CALL M$READ (RLCL) ALTRET (NRHLP); /* Look for 'LOCAL   STATION'        */
      319     4699    3             CALL M$CLOSE (CLTF) ALTRET (NOHLP);
      320     4700    3             GOTO GOTHLP;
      321     4701    3   NRHLP:    ;
      322     4702    3             CALL RDCK ALTRET (GOTHLP);
      323     4703    3   NOHLP:    ;
      324     4704    3             JC_SUPER.UHWF=2;
      325     4705    3           END;
      326     4706    2           CALL ERDL;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:10   
      327     4707        /**/
      328     4708        /* :USERS */
      329     4709        /**/
      330     4710    2   GOTHLP: ;
      331     4711    2           TSTF.NAME_=VECTOR(USERS);
      332     4712    2           CLTF.ACSVEH_ = VECTOR(ACSVEH_USERS);
      333     4713    3           IF JC_SUPER.UHWF=0 THEN DO;
      334     4714    3             CALL M$OPEN (TSTF) ALTRET (NOUSR);
      335     4715    3             CALL M$CLOSE (CLTF) ALTRET (NOUSR);
      336     4716    3             GOTO GOTUSR;
      337     4717    3   NOUSR:    ;
      338     4718    3             JC_SUPER.UHWF=1;
      339     4719    3             CALL ERDL;
      340     4720    3             TSTF.NAME_=VECTOR(HLP);
      341     4721    3           END;
      342     4722    2           CALL ERDL;   /* Delete :HLP if any of :HLP,:FORM,:WSN,:USERS is bad  */
      343     4723    2         END;
      344     4724    1           ELSE CALL JCS$CRACLG;
      345     4725    1   GOTUSR: ;
      346     4726    1         CLTF.V.OPER.CHGATT# = '0'B;
      347     4727    1         CLTF.ACCESS_ = VECTOR(NIL);
      348     4728    1         CLTF.ACSVEH_ = VECTOR(NIL);
      349     4729        /**/
      350     4730        /* If a bad :USERS, :HLP, :WSN or :FORM file is found, write a msg to MONKEY */
      351     4731        /* telling him to turn off users                                             */
      352     4732        /**/
      353     4733    2         IF JC_SUPER.UHWF~=0 THEN DO;
      354     4734    2           BFLM.FILE=JC_SUPER.UHWF;
      355     4735    2           BFLM.MSG#=BUHWF_MSG#;
      356     4736    2           CALL M$WRITE (WBFL) ALTRET (FON3);
      357     4737    2   FON3:   WBFL.BUF_=VECTOR(BTOFF);
      358     4738    2           WSTA.STATION#='MONKEY';
      359     4739    2           CALL M$WRITE (WBFL) ALTRET (FON4);
      360     4740    2   FON4: END;
      361     4741        /**/
      362     4742        /* Create :JOBSTATS file if it doesn't exist (initial MBS initialization) */
      363     4743        /**/
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:11   
      364     4744    1         CALL JMM$INIT0;
      365     4745    1   GHGO:
      366     4746        /**/
      367     4747        /* Initialize SLUG's event queue and free chain of event blocks */
      368     4748        /**/
      369     4749    1         JC_EVQCNT = 0;
      370     4750    1         JC_FQHD$ = ADDR(JC_QEV(0));
      371     4751    2         DO I=0 TO 8;
      372     4752    2           JC_QEV.LNK$(I) = ADDR(JC_QEV(I+1));
      373     4753    2         END;
      374     4754        /**/
      375     4755        /* Post first read to CG/CSCG from station SLUG */
      376     4756        /**/
      377     4757    1         CALL M$READ (RDCSCG) ALTRET (KRDY);
      378     4758        /**/
      379     4759        /* Open CG/CSCG for station MBS */
      380     4760        /**/
      381     4761    1   KRDY: CALL M$OPEN (JMM_OPEN_CSCG) ALTRET (SC2);
      382     4762        /**/
      383     4763        /**/
      384     4764        /* OK, now start the phased system startup by setting JC_PHASE to 0          */
      385     4765        /* and posting a phase-complete event to SLUG.                               */
      386     4766        /**/
      387     4767    1         JC_WAITING = '0'B;               /* Not waiting on any ghosts          */
      388     4768    1         JC_SUSROK = '0'B;                /* SUSR type of JC_CITE is not yet OK */
      389     4769    1         JC_SUSR = '0'B;                  /* Don't start users yet              */
      390     4770    1         JC_PHASE = 0;
      391     4771    1         CALL JCE$EVENT(JCQEV_PCMP#);
      392     4772        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:12   
      393     4773        /**/
      394     4774        /* This is the main loop of SLUG. Whenever a read needs to be posted or an   */
      395     4775        /* event needs to be processed, this loop detects that and acts accordingly. */
      396     4776        /* If nothing needs to be done, SLUG goes to sleep until the rest of the     */
      397     4777        /* current minute elapses or until an event occurs. Once a minute,           */
      398     4778        /* JMR$TIME is called to do RUNAFTER and NORUN scheduling for MBS.           */
      399     4779        /**/
      400     4780    2         DO INHIBIT;
      401     4781    3           DO WHILE ('1'B);
      402     4782    4             DO WHILE (JC_FERD+JC_MBSRD+JC_CSRD+JMC_EVQCNT+JC_EVQCNT~=0);
      403     4783    4               IF JC_EVQCNT~=0 THEN CALL JCP$PROCESS;  /* SLUG event processing */
      404     4784    4               IF JMC_EVQCNT~=0 THEN CALL JMM$PROCESS; /* MBS event processing  */
      405     4785    5               IF JC_FERD~=0 THEN DO;
      406     4786    5                 JC_FERD=0;
      407     4787    5                 CALL M$READ (KL_RDHLP) ALTRET (SC4);
      408     4788    5               END;
      409     4789    5   HLPON:      IF JC_CSRD~=0 THEN DO;
      410     4790    5                 JC_CSRD=0;
      411     4791    5                 CALL M$READ (RDCSCG) ALTRET (KYDN);
      412     4792    5               END;
      413     4793    5               IF JC_MBSRD~=0 THEN DO;
      414     4794    5                 JC_MBSRD=0;
      415     4795    5                 CALL M$READ (JM_RDMBS) ALTRET (KYDN);
      416     4796    5               END;
      417     4797    4   KYDN:     END;
      418     4798    4             IF TLFT=0 THEN DO;
      419     4799    4               TLFT=60;
      420     4800    4               CALL JMR$TIME;
      421     4801    4             END;
      422     4802    3             IF JC_ZIP>0 THEN CALL JCP$ZIPCK;
      423     4803    3             WAITMIN.V.UNITS#=TLFT;
      424     4804    3             IF (JC_EVQCNT + JMC_EVQCNT = 0)
      425     4805    3               THEN
      426     4806    3               CALL M$WAIT (WAITMIN);
      427     4807    3           END;
      428     4808    2         END;
      429     4809        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:13   
      430     4810    1   SC2:  ;
      431     4811    1         CALL FOI$CRASHGO (%S$NOPCS,F_JC,M_S);
      432     4812        /*S*  SCREECH_CODE: JCS-S$NOPCS
      433     4813              TYPE:    Screech
      434     4814              MESSAGE: SLUG unable to open CSCG
      435     4815              REMARKS: SLUG must open the central system comgroup (CSCG) in order
      436     4816                       to communicate with KEYIN and other parts of the
      437     4817                       system.  This screech results when this cannot be done.       */
      438     4818    1         GOTO GHGO;
      439     4819    1   SC4:  ;
      440     4820    1         CALL FOI$CRASHGO (%S$NRDHLP,F_JC,M_S);
      441     4821        /*S*  SCREECH_CODE: JCS-S$NRDHLP
      442     4822              TYPE:    Screech
      443     4823              MESSAGE: SLUG got ALTRET reading HLPCG
      444     4824              REMARKS: Due to the nature of comgroups, SLUG should never get an
      445     4825                       ALTRET on his anonomous M$READ to HLPCG.  This screech
      446     4826                       occurs on the exception to that rule.                         */
      447     4827    1         GOTO HLPON;
      448     4828        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:14   
      449     4829    1   RDCK: PROC ALTRET;
      450     4830        /**/
      451     4831    2         I=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      452     4832    2         CALL M$CLOSE (CLTF) ALTRET (RTN);
      453     4833    2         IF I=%E$LD THEN ALTRETURN;
      454     4834    2   RTN:  ;
      455     4835    2         RETURN;
      456     4836        /**/
      457     4837    2   ERDL: ENTRY ALTRET;
      458     4838        /**/
      459     4839    2         DLTF.NAME_=TSTF.NAME_;
      460     4840    2         CALL M$OPEN (DLTF) ALTRET (ERDLRT);
      461     4841    2   ERDLRT:;
      462     4842    2         RETURN;
      463     4843    2   END RDCK;
      464     4844        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:15   
      465     4845    1   JITINIT: PROC;
      466     4846        /**/
      467     4847        /* Initialize the default JIT that SLUG gives to all new users. All users    */
      468     4848        /* except for sleazy ghosts will go through LOGON having most of these       */
      469     4849        /* values changed.                                                           */
      470     4850        /**/
      471     4851    2         ADDR(JC_JIT)->B$JIT='0'B;
      472     4852    2         ADDR(JC_JIT)->B$JIT.PRIV.AUTH=~%PR_FMEFT#;
      473     4853    2         ADDR(JC_JIT)->B$JIT.PRIV.JOB=~%PR_FMEFT#;
      474     4854    2         ADDR(JC_JIT)->B$JIT.PPRIV=~%PPR_PADMIN#;
      475     4855    2         ADDR(JC_JIT)->B$JIT.PRFLAGS.EXPOUND = '1'B;
      476     4856    2         ADDR(JC_JIT)->B$JIT.PRFLAGS.POSITION = '1'B;
      477     4857    2         ADDR(JC_JIT)->B$JIT.ACCEPT_FLAGS.SEND = '1'B;
      478     4858    2         ADDR(JC_JIT)->B$JIT.ACCEPT_FLAGS.BROADCAST = '1'B;
      479     4859    2         ADDR(JC_JIT)->B$JIT.LOCK = '777777777777777777777777'O;
      480     4860    2         ADDR(JC_JIT)->B$JIT.FBUL=31;
      481     4861    2         ADDR(JC_JIT)->B$JIT.REMCPO=BITBIN('377777777777'O);
      482     4862    2         ADDR(JC_JIT)->B$JIT.REMLO=BITBIN('377777777777'O);
      483     4863    2         ADDR(JC_JIT)->B$JIT.REMDO=BITBIN('377777777777'O);
      484     4864    2         ADDR(JC_JIT)->B$JIT.MAXCORE=1024;
      485     4865    2         ADDR(JC_JIT)->B$JIT.RESCORE=1024;
      486     4866    2         ADDR(JC_JIT)->B$JIT.MAXPRI=15;
      487     4867    2         ADDR(JC_JIT)->B$JIT.DEFPRI=7;
      488     4868    2         ADDR(JC_JIT)->B$JIT.MRT=BITBIN('377777777777'O);
      489     4869    2         ADDR(JC_JIT)->B$JIT.OLTA='6'O;
      490     4870    2         ADDR(JC_JIT)->B$JIT.PRDPRM=BITBIN('177777777777'O);
      491     4871    2         ADDR(JC_JIT)->B$JIT.MAXTMPDP=10000;
      492     4872    2         ADDR(JC_JIT)->B$JIT.DO$=ADDR(NIL);
      493     4873    2         ADDR(JC_JIT)->B$JIT.HPSN='SYS  ';
      494     4874    2         ADDR(JC_JIT)->B$JIT.FPSN=' ';
      495     4875    2         ADDR(JC_JIT)->B$JIT.WOO='LOCAL';
      496     4876    2         ADDR(JC_JIT)->B$JIT.JOBNAME=' ';
      497     4877    2         ADDR(JC_JIT)->B$JIT.OUTPRIO=7;
      498     4878    2         RETURN;
      499     4879    2   END JITINIT;
      500     4880    1   END JCS$SLUG;
      501     4881        %EOD;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:16   

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:17   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   JMC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   JC_SUBS_C.:E05TOU  is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   JC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   I_SUBS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCS$SLUG.

   Procedure JCS$SLUG requires 523 words for executable code.
   Procedure JCS$SLUG requires 10 words of local(AUTO) storage.

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:18   

 Object Unit name= JCS$SLUG                                   File name= JCS$SLUG.:E05TOU
 UTS= JUL 29 '97 23:18:26.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   296    450  JCS$SLUG
    2  RoData even  UTS    364    554  JCS$SLUG
    3   DCB   even  none     0      0  M$CSCGAU
    4   DCB   even  none     0      0  M$CSCG
    5   DCB   even  none     0      0  M$GHOST
    6   Proc  even  none   523   1013  JCS$SLUG
    7  RoData even  none    44     54  JCS$SLUG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Main       0  JCS$SLUG

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      4  JC_CSMBF                           1    117  JC_FERD
    1    120  JC_CSRD                            1    121  JC_MBSRD
    1    122  JC_TBOOT                           1    123  JC_SUPER
    1    124  JG_SGHST
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 JCE$EVNT
         yes          Async      0 JCE$XCON
 yes     yes           Std       3 FOI$CRASHGO
         yes           Std       1 JCE$EVENT
         yes           Std       0 JCS$OPACLG
         yes           Std       0 JCP$PROCESS
         yes           Std       0 JCS$CRACLG
         yes           Std       0 JMM$INIT0
         yes           Std       0 JMM$PROCESS
         yes           Std       0 JMR$TIME
         yes           Std       0 JCP$ZIPCK
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MAUTO

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  JC_PHASE                              JC_WAITING
     JC_SUSROK                             JC_SUSR                               JC_EVQCNT
     JC_QEV                                JC_FQHD$                              JMC_CH
     JMC_EVQCNT                            JC_ZIP                                B$TCB$
r    B$JIT$                                JC_JIT                                JC_ROSEG
     JC_RODCB$                             JC_UCTABS                             JC_UCSTA
     JC_UCSST                              KL_NODES                              KL_MXFE
     JC_ROAVL                              M_UC                                  M$CSCGAU
     M$CSCG                                M$GHOST                               JM_RDMBS
     KL_RDHLP                              JMM_OPEN_CSCG                         B_VECTNIL
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:20   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:21   


        1        1        /*M* JCS$SLUG Main routine for SLUG ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*DMC,PLM=6,IND=2,ENU=2,DCI=4,CSU=2,ECU=2,THI=2,DTI=0*/
        8        8        /**/
        9        9        /**/
       10       10        JCS$SLUG: PROC MAIN;

     10  6 000000   000000 700200 xent  JCS$SLUG     TSX0  ! X66_MAUTO
         6 000001   000012 000000                    ZERO    10,0

       11       11        /**/
       12       12        /**/
       13       13        %INCLUDE B$ROSEG;
       14       76 S      %INCLUDE B$JIT_C;
       15       77        %B$JIT0;
       16      166        %U$JIT1;
       17      240        %M$JIT2;
       18      250        %F$JIT3;
       19      255        %S$JIT4;
       20      261        %J$JIT5;
       21      349        %A$JIT6;
       22      359        %INCLUDE CP_6;
       23      440        %INCLUDE CP_6_SUBS;
       24      980        %INCLUDE EL_SUBS_C;
       25     1064        %INCLUDE F$DCB;
       26     1113        %INCLUDE F_ERRORS_C;
       27     1353        %INCLUDE I_SUBS_C;
       28     1377        %INCLUDE JC_MACRO_C;
       29     1491        %INCLUDE JC_DATA_R;
       30     1529        %INCLUDE JC_SCODE_C;
       31     1545        %INCLUDE JC_SUBS_C;
       32     1558        %INCLUDE JG_EVID_C;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:22   
       33     1783        %INCLUDE JG_GHOSTS_C;
       34     1873        %INCLUDE JMC_DATA_R;
       35     1888        %INCLUDE KC_ERRORS_C;
       36     1935        %INCLUDE OC_MESSHD_C;
       37     1988        %INCLUDE OC_SUBS_C;
       38     2719        /**/
       39     2720        %B$TCB;
       40     2723        %B$ALT;
       41     2731        /**/
       42     2732        /**/
       43     2733    1   DCL RO$ PTR;
       44     2734    1   DCL I UBIN WORD;
       45     2735    1   DCL 1 TPTR STATIC ALIGNED,
       46     2736    1         2 OFFSET SBIN(18) UNAL INIT(0),
       47     2737    1         2 * UBIN(6) UNAL INIT(0),
       48     2738    1         2 SEGID BIT(12) UNAL INIT('6003'O);
       49     2739    1   DCL TPTR$ REDEF TPTR PTR;
       50     2740    1   DCL TLFT UBIN WORD STATIC DALIGNED INIT(60);
       51     2741    1   DCL 1 BTOFF CONSTANT ALIGNED,
       52     2742    1         2 OCAX UBIN BYTE UNAL INIT(MKV_OCA$KMISC#),
       53     2743    1         2 KEY# UBIN BYTE UNAL INIT(KEY_BATCH#),
       54     2744    1         2 CADDR BIT(18) UNAL INIT(M_SYS),
       55     2745    1         2 FLAG UBIN WORD INIT(3);
       56     2746    1   DCL JC_CSMBF CHAR(300) STATIC SYMDEF;
       57     2747    1   DCL JC_FERD UBIN WORD STATIC SYMDEF INIT(0);  /* Read pending on CG/HLPCG if 0 */
       58     2748    1   DCL JC_CSRD UBIN WORD STATIC SYMDEF INIT(0);
              2748            /* Read pending on CG/CSCG(SLUG) if 0 */
       59     2749    1   DCL JC_MBSRD UBIN WORD STATIC SYMDEF INIT(0);
              2749            /* Read pending on CG/CSCG(MBS) if 0 */
       60     2750    1   DCL JC_TBOOT UBIN WORD STATIC SYMDEF INIT(0);
       61     2751    1   DCL 1 JC_SUPER STATIC SYMDEF ALIGNED,
       62     2752    1         2 PRO UBIN HALF UNAL INIT(0),
       63     2753    1         2 UHWF UBIN HALF UNAL INIT(0);
       64     2754    1   DCL 1 JG_SGHST ALIGNED STATIC SYMDEF,
       65     2755    1         2 G (0:JG_MING#) BIT(1) INIT('0'B*0);
       66     2756    1   DCL JC_ZIP SBIN WORD SYMREF;
       67     2757    1   DCL ERCOD BIT(36) STATIC DALIGNED;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:23   
       68     2758    1   DCL B$TCB$ PTR SYMREF;
       69     2759    1   DCL B$JIT$ PTR SYMREF READONLY;
       70     2760    1   DCL JC_JIT UBIN SYMREF; /* Really an entire JIT */
       71     2761    1   DCL JC_ROSEG (0:1023) UBIN WORD DALIGNED SYMREF;
       72     2762    1   DCL JC_RODCB$(0:0) PTR SYMREF;
       73     2763    1   DCL JC_UCTABS UBIN WORD SYMREF;    /*** DUMMY ***/
       74     2764    1   DCL JC_UCSTA UBIN WORD SYMREF;    /*** DUMMY ***/
       75     2765    1   DCL JC_UCSST UBIN WORD SYMREF;    /*** DUMMY ***/
       76     2766    1   DCL KL_NODES UBIN SYMREF;
       77     2767    1   DCL KL_MXFE UBIN SYMREF;
       78     2768    1   DCL 1 JC_ROAVL DALIGNED SYMREF,
       79     2769    1         2 PTR$ PTR,
       80     2770    1         2 SIZ SBIN;
       81     2771    1   DCL M_UC UBIN WORD DALIGNED SYMREF;     /* DUMMY */
       82     2772    1   DCL FOI$CRASHGO ENTRY(3) ALTRET;
       83     2773    1   DCL JGI$SGHST ENTRY;
       84     2774    1   DCL JMM$INIT0 ENTRY;
       85     2775    1   DCL JMM$PROCESS ENTRY;
       86     2776    1   DCL JMR$TIME ENTRY;
       87     2777    1   DCL JCE$EVENT ENTRY(1);
       88     2778    1   DCL JCE$EVNT ENTRY ASYNC;
       89     2779    1   DCL JCE$XCON ENTRY ASYNC;
       90     2780    1   DCL JCS$ACLGM ENTRY;
       91     2781    1   DCL JCS$CRACLG ENTRY;
       92     2782    1   DCL JCS$OPACLG ENTRY;
       93     2783    1   DCL JCP$PROCESS ENTRY;
       94     2784    1   DCL JCP$ZIPCK ENTRY;
       95     2785    1   DCL M$CSCGAU DCB;
       96     2786    1   DCL M$CSCG DCB;
       97     2787    1   DCL M$GHOST DCB;
       98     2788        /**/
       99     2789        %SUB F_JC='1203'O;
      100     2790        %SUB M_S='23'O;
      101     2791        /**/
      102     2792        %FPT_WRSYSLOG (FPTN=FPT_SLUGUP,STCLASS=CONSTANT,
      103     2793              ENTRY=DUMMYENT,SIZE=1,MMINHIB=NO,FILENUM=2,TYPE=EL_SLUGUP);
      104     2808    1   DCL DUMMYENT UBIN CONSTANT INIT(0);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:24   
      105     2809        %OC_MESSHD_W (NAME=BFLM,STCLASS=STATIC,NPARMS=1,ATR=M_SYS);
      106     2822    1         2 FCNT UBIN BYTE UNAL INIT(1),
      107     2823    1         2 FILE UBIN BYTE UNAL INIT(0);
      108     2824        %FPT_EVENT (UENTRY=JCE$EVNT,STCLASS=CONSTANT);
      109     2838        %FPT_XCON (UENTRY=JCE$XCON,STCLASS=CONSTANT);
      110     2852        %FPT_OPEN (FPTN=OPCSAU,STCLASS=CONSTANT,DCB=M$CSCGAU,NAME=CSCG,CTG=YES,
      111     2853                   ASN=COMGROUP,FUN=CREATE,EXIST=NEWFILE,ORG=CONSEC,AU=YES,
      112     2854                  ACSVEH=CSCG_ACSVEH,ACCESS=CSCG_ACCESS,SHARE=ALL,IXTNSIZE=200);
      113     2963        %VLP_ATTR(FPTN=CSCG_ACSVEH,STCLASS=CONSTANT);
      114     2977        %VLP_ACSVEH(VEHICLE='TPA',WNEW=YES,READ=YES,LAST=",");
      115     2994        %VLP_ACSVEH(VEHICLE='JAYS',WNEW=YES,READ=YES,LAST=",");
      116     3011        %VLP_ACSVEH(VEHICLE='REPLAY',WNEW=YES,READ=YES,LAST=",");
      117     3028        %VLP_ACSVEH(VEHICLE='SUPER?',READ=YES,WNEW=YES,UPD=YES,DELR=YES);
      118     3045        %VLP_ACSVEH(VEHICLE='GOOSE',WNEW=YES,READ=YES,LAST=";");
      119     3062        %VLP_ATTR(FPTN=CSCG_ACCESS,STCLASS=CONSTANT);
      120     3076        %VLP_ACCESS(ACCT='?',EXEC=YES,LAST=";");
      121     3093        %FPT_CGCTL (FPTN=CSCTL,STCLASS=CONSTANT,DCB=M$CSCGAU,CGCP=CSPRM);
      122     3116        %VLP_CGCP (FPTN=CSPRM,STCLASS=CONSTANT,CONMSG=YES,
      123     3117                   MAXPG=100,DATAPGS=10,
      124     3118                  MEMWARN=25,DISKWARN=25,
      125     3119                   TERMCONAU=NO,DCBCONAU=YES,TERMCONNAU=NO,DCBCONNAU=YES,
      126     3120                   AUCONTERM=DISCONNECT,AUCONDCB=NC,AUDCONTERM=DISCONNECT,
      127     3121                   AUDCONDCB=NC,XSTALGL=YES,WAS=YES,RAS=YES,SMD=YES,XTYPLGL=YES,
      128     3122                   MAXMC=CSCG_MAXMC_REAL#,DCBCONLGL=YES,TERMCONLGL=NO,INPUT=YES,
      129     3123                   OUTPUT=YES,SECURE=NO);
      130     3166        %FPT_CLOSE (FPTN=CLCSAU,STCLASS=CONSTANT,DCB=M$CSCGAU);
      131     3208        %FPT_WAIT (FPTN=WAITMIN,STCLASS=STATIC,UNITS=60,UETIME=TLFT);
      132     3222        %VLP_ACCT (FPTN=SYS,STCLASS=CONSTANT,ACCT=':SYS');
      133     3235        %FPT_OPEN (FPTN=OPCSCG,DCB=M$CSCG,STCLASS=CONSTANT,NAME=CSCG,
      134     3236                   ASN=COMGROUP,FUN=UPDATE,SETSTA=CSST);
      135     3345        %VLP_NAME (FPTN=CSCG,NAME='CSCG',STCLASS=CONSTANT,LEN=7);
      136     3372        %VLP_SETSTA (FPTN=CSST,STCLASS=CONSTANT,MYSTATION='SLUG',OSTATION='KEYIN',WAS=YES);
      137     3400        %FPT_READ (FPTN=RDCSCG,STCLASS=CONSTANT,DCB=M$CSCG,
      138     3401                   BUF=JC_CSMBF,WAIT=NO,EVENT=JC_CSRD#);
      139     3440        %FPT_READ (FPTN=JM_RDMBS,STCLASS=SYMREF);
      140     3479        %FPT_READ  (FPTN=KL_RDHLP,STCLASS=SYMREF);
      141     3518        %FPT_MONINFO (FPTN=GBOOT,STCLASS=CONSTANT,MONINFO=BOOT);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:25   
      142     3533        %VLR_MONINFO (FPTN=BOOT,STCLASS=STATIC);
      143     3551        %FPT_OPEN (FPTN=JMM_OPEN_CSCG,STCLASS=SYMREF);
      144     3660        %FPT_WRITE (FPTN=WBFL,STCLASS=STATIC,DCB=M$CSCG,BUF=BFLM,STATION=WSTA);
      145     3691        %VLP_STATION (FPTN=WSTA,STCLASS=STATIC,STATION='KEYIN');
      146     3718        %FPT_OPEN (FPTN=TSTF,STCLASS=STATIC,DCB=M$GHOST,NAME=JOBSTATS,ACCT=SYS,
      147     3719                   ASN=FILE,FUN=UPDATE,FPARAM=ERCOD,ACS=DIRECT);
      148     3828        %VLP_NAME (FPTN=COMAC,STCLASS=CONSTANT,NAME=':COMAC',LEN=7);
      149     3855        %FPT_CLOSE (FPTN=CLTF,STCLASS=STATIC,DCB=M$GHOST);
      150     3897        %VLP_ATTR (FPTN=ACCESS_EXECALL,STCLASS=CONSTANT);
      151     3911        %VLP_ACCESS (EXEC=YES,ACCT='?',LAST=";");
      152     3928        %VLP_ATTR (FPTN=ACSVEH_HLP,STCLASS=CONSTANT);
      153     3942        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='IBEX');
      154     3959        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='TPCP');
      155     3976        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='TPA');
      156     3993        %VLP_ACSVEH (READ=YES,VEHICLE='LOGON');
      157     4010        %VLP_ACSVEH (READ=YES,VEHICLE='NETCON');
      158     4027        %VLP_ACSVEH (READ=YES,WNEW=YES,UPD=YES,DELR=YES,VEHICLE='SUPER?');
      159     4044        %VLP_ACSVEH (READ=YES,VEHICLE='PIGETTE');
      160     4061        %VLP_ACSVEH (READ=YES,VEHICLE='PRESCAN',LAST=";");
      161     4078        %VLP_ATTR (FPTN=ACSVEH_USERS,STCLASS=CONSTANT);
      162     4092        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='IBEX');
      163     4109        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='TPCP');
      164     4126        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='LOGON');
      165     4143        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='PRESCAN');
      166     4160        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='SUPER?');
      167     4177        %VLP_ACSVEH (READ=YES,UPD=YES,VEHICLE='SLUG',LAST=";");
      168     4194        %VLP_NAME (FPTN=JOBSTATS,STCLASS=CONSTANT,NAME=':JOBSTATS',LEN=11);
      169     4221        %VLP_NAME (FPTN=PRO,STCLASS=CONSTANT,NAME=':PRO',LEN=7);
      170     4248        %VLP_NAME (FPTN=WSN,STCLASS=CONSTANT,NAME=':WSN',LEN=7);
      171     4275        %VLP_NAME (FPTN=HLP,STCLASS=CONSTANT,NAME=':HLP',LEN=7);
      172     4302        %VLP_NAME (FPTN=FORM,STCLASS=CONSTANT,NAME=':FORM',LEN=7);
      173     4329        %VLP_NAME (FPTN=USERS,STCLASS=CONSTANT,NAME=':USERS',LEN=7);
      174     4356        %FPT_READ (FPTN=RLCL,STCLASS=STATIC,DCB=M$GHOST,BUF=ERCOD,KEY=LCL,KEYS=YES);
      175     4395        %VLP_NAME (FPTN=LCL,STCLASS=CONSTANT,NAME='LOCAL   *',LEN=11);
      176     4422        %VLP_NAME (FPTN=LCLSTA,STCLASS=CONSTANT,NAME='LOCAL   STATION',LEN=15);
      177     4449        %FPT_OPEN (FPTN=DLTF,STCLASS=STATIC,ASN=FILE,DCB=M$GHOST,DELETE=YES);
      178     4558        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:26   
      179     4559    1         CALL M$MONINFO (GBOOT)

   4559  6 000002   000436 630400 2                  EPPR0   GBOOT
         6 000003   420023 713400                    CLIMB   alt,+8211
         6 000004   402400 401760                    pmme    nvectors=6
         6 000005   000007 702000 6                  TSX2    s:4562
         6 000006   000007 710000 6                  TRA     s:4562

      180     4560    2           WHENALTRETURN DO;

      181     4561    2         END;

      182     4562    1         IF B$JIT$->B$JIT.SYSID ~= JG_SLUG# THEN CALL M$EXIT;

   4562  6 000007   000000 470400 xsym               LDP0    B$JIT$
         6 000010   000000 720100                    LXL0    0,,PR0
         6 000011   000001 100003                    CMPX0   1,DU
         6 000012   000015 600000 6                  TZE     s:4563

   4562  6 000013   000001 713400                    CLIMB   exit
         6 000014   000000 401760                    pmme    nvectors=0

      183     4563    1         CALL JITINIT;

   4563  6 000015   000714 701000 6                  TSX1    JITINIT
         6 000016   000000 011000                    NOP     0

      184     4564        /**/
      185     4565        /* Initialize default ROSEG that SLUG gives to all new users                 */
      186     4566        /**/
      187     4567    1         RO$=ADDR(JC_ROSEG);

   4567  6 000017   000000 236000 7                  LDQ     0
         6 000020   200003 756100                    STQ     RO$,,AUTO

      188     4568    1         TPTR.OFFSET=POFFW(ADDR(JC_RODCB$),RO$);

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:27   
   4568  6 000021   000001 236000 7                  LDQ     1
         6 000022   000022 772000                    QRL     18
         6 000023   200003 235100                    LDA     RO$,,AUTO
         6 000024   000022 771000                    ARL     18
         6 000025   200010 755100                    STA     I+4,,AUTO
         6 000026   200010 136100                    SBLQ    I+4,,AUTO
         6 000027   000000 620006                    EAX0    0,QL
         6 000030   000000 740000 1                  STX0    TPTR

      189     4569    1         RO$->B$ROSEG.DCBPTR$=TPTR$;

   4569  6 000031   000000 236000 1                  LDQ     TPTR
         6 000032   200003 470500                    LDP0    RO$,,AUTO
         6 000033   000000 756100                    STQ     0,,PR0

      190     4570    1         TPTR.OFFSET=POFFW(ADDR(JC_ROAVL),RO$);

   4570  6 000034   000002 236000 7                  LDQ     2
         6 000035   000022 772000                    QRL     18
         6 000036   200010 755100                    STA     I+4,,AUTO
         6 000037   200010 136100                    SBLQ    I+4,,AUTO
         6 000040   000000 621006                    EAX1    0,QL
         6 000041   000000 741000 1                  STX1    TPTR

      191     4571    1         RO$->B$ROSEG.AVAIL$=TPTR$;

   4571  6 000042   000000 236000 1                  LDQ     TPTR
         6 000043   000003 756100                    STQ     3,,PR0

      192     4572    2         DO I=0 TO RO$->B$ROSEG.NUMDCBS;

   4572  6 000044   200004 450100                    STZ     I,,AUTO
         6 000045   000067 710000 6                  TRA     s:4577+3

      193     4573    3           IF JC_RODCB$(I)~=ADDR(NIL) THEN DO;

   4573  6 000046   200004 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:28   
         6 000047   000000 236010 xsym               LDQ     JC_RODCB$,X0
         6 000050   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000051   000064 600000 6                  TZE     s:4577

      194     4574    3             TPTR.OFFSET=POFFW(JC_RODCB$(I),RO$);

   4574  6 000052   200003 235100                    LDA     RO$,,AUTO
         6 000053   000022 771000                    ARL     18
         6 000054   200010 755100                    STA     I+4,,AUTO
         6 000055   000000 236010 xsym               LDQ     JC_RODCB$,X0
         6 000056   000022 772000                    QRL     18
         6 000057   200010 136100                    SBLQ    I+4,,AUTO
         6 000060   000000 621006                    EAX1    0,QL
         6 000061   000000 741000 1                  STX1    TPTR

      195     4575    3             JC_RODCB$(I)=TPTR$;

   4575  6 000062   000000 236000 1                  LDQ     TPTR
         6 000063   000000 756010 xsym               STQ     JC_RODCB$,X0

      196     4576    3           END;

      197     4577    2         END;

   4577  6 000064   200004 235100                    LDA     I,,AUTO
         6 000065   000001 035007                    ADLA    1,DL
         6 000066   200004 755100                    STA     I,,AUTO
         6 000067   200003 470500                    LDP0    RO$,,AUTO
         6 000070   000002 236100                    LDQ     2,,PR0
         6 000071   000022 772000                    QRL     18
         6 000072   200004 116100                    CMPQ    I,,AUTO
         6 000073   000046 603000 6                  TRC     s:4573

      198     4578    1         JC_ROAVL.SIZ=1024-POFFW(ADDR(JC_ROAVL),RO$);

   4578  6 000074   000002 236000 7                  LDQ     2
         6 000075   000022 772000                    QRL     18
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:29   
         6 000076   200003 235100                    LDA     RO$,,AUTO
         6 000077   000022 771000                    ARL     18
         6 000100   200010 755100                    STA     I+4,,AUTO
         6 000101   200010 136100                    SBLQ    I+4,,AUTO
         6 000102   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 000103   002001 036007                    ADLQ    1025,DL
         6 000104   000001 756000 xsym               STQ     JC_ROAVL+1

      199     4579    1         TPTR.OFFSET=POFFW(ADDR(JC_UCTABS),RO$);

   4579  6 000105   000003 236000 7                  LDQ     3
         6 000106   000022 772000                    QRL     18
         6 000107   200010 755100                    STA     I+4,,AUTO
         6 000110   200010 136100                    SBLQ    I+4,,AUTO
         6 000111   000000 620006                    EAX0    0,QL
         6 000112   000000 740000 1                  STX0    TPTR

      200     4580    1         ADDR(M_UC)->F$DCB.TAB$=TPTR$;

   4580  6 000113   000000 236000 1                  LDQ     TPTR
         6 000114   000047 756000 xsym               STQ     M_UC+39

      201     4581    1         TPTR.OFFSET=POFFW(ADDR(JC_UCSTA),RO$);

   4581  6 000115   000004 236000 7                  LDQ     4
         6 000116   000022 772000                    QRL     18
         6 000117   200010 755100                    STA     I+4,,AUTO
         6 000120   200010 136100                    SBLQ    I+4,,AUTO
         6 000121   000000 621006                    EAX1    0,QL
         6 000122   000000 741000 1                  STX1    TPTR

      202     4582    1         ADDR(M_UC)->F$DCB.LASTSTA$=TPTR$;

   4582  6 000123   000000 236000 1                  LDQ     TPTR
         6 000124   000007 756000 xsym               STQ     M_UC+7

      203     4583    1         TPTR.OFFSET=POFFW(ADDR(JC_UCSST),RO$);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:30   

   4583  6 000125   000005 236000 7                  LDQ     5
         6 000126   000022 772000                    QRL     18
         6 000127   200010 755100                    STA     I+4,,AUTO
         6 000130   200010 136100                    SBLQ    I+4,,AUTO
         6 000131   000000 620006                    EAX0    0,QL
         6 000132   000000 740000 1                  STX0    TPTR

      204     4584    1         ADDR(M_UC)->F$DCB.SETSTA$=TPTR$;

   4584  6 000133   000000 236000 1                  LDQ     TPTR
         6 000134   000006 756000 xsym               STQ     M_UC+6

      205     4585        /**/
      206     4586        /* Tell ELF that SLUG is up so that ELF may finish his housekeeping */
      207     4587        /**/
      208     4588    1         CALL M$WRSYSLOG (FPT_SLUGUP);

   4588  6 000135   000002 630400 2                  EPPR0   FPT_SLUGUP
         6 000136   070001 713400                    CLIMB   28673
         6 000137   400400 401760                    pmme    nvectors=2

      209     4589    1         CALL M$EVENT (FPT_EVENT);

   4589  6 000140   000014 630400 2                  EPPR0   FPT_EVENT
         6 000141   010001 713400                    CLIMB   4097
         6 000142   400000 401760                    pmme    nvectors=1

      210     4590    1         CALL M$XCON (FPT_XCON);

   4590  6 000143   000020 630400 2                  EPPR0   FPT_XCON
         6 000144   010003 713400                    CLIMB   4099
         6 000145   400400 401760                    pmme    nvectors=2

      211     4591        /**/
      212     4592        /* Create and become non-AU user of CG/CSCG */
      213     4593        /**/
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:31   
      214     4594    1         CALL M$OPEN (OPCSAU) ALTRET (SC2);

   4594  6 000146   000026 630400 2                  EPPR0   OPCSAU
         6 000147   450000 713400                    CLIMB   alt,open
         6 000150   410400 401760                    pmme    nvectors=18
         6 000151   000647 702000 6                  TSX2    SC2

      215     4595    1         CALL M$CGCTL (CSCTL) ALTRET (SC2);

   4595  6 000152   000140 630400 2                  EPPR0   CSCTL
         6 000153   500003 713400                    CLIMB   alt,+32771
         6 000154   411400 401760                    pmme    nvectors=20
         6 000155   000647 702000 6                  TSX2    SC2

      216     4596    1         CALL M$OPEN (OPCSCG) ALTRET (SC2);

   4596  6 000156   000310 630400 2                  EPPR0   OPCSCG
         6 000157   450000 713400                    CLIMB   alt,open
         6 000160   410400 401760                    pmme    nvectors=18
         6 000161   000647 702000 6                  TSX2    SC2

      217     4597    1         CALL M$CLOSE (CLCSAU) ALTRET (MONINFO);

   4597  6 000162   000250 630400 2                  EPPR0   CLCSAU
         6 000163   450001 713400                    CLIMB   alt,close
         6 000164   406000 401760                    pmme    nvectors=13
         6 000165   000166 702000 6                  TSX2    MONINFO

      218     4598        /**/
      219     4599        /* Set JC_TBOOT:
      220     4600                      0 -----> Disk boot or crash recovery
      221     4601                      1 -----> Tape boot - under files (N to NEW FILES)
      222     4602                      2 -----> Tape boot - S files only
      223     4603                      3 -----> Tape boot over files    (S to NEW FILES)
      224     4604        */
      225     4605        /**/
      226     4606    1   MONINFO: CALL M$MONINFO (GBOOT) ALTRET (EVNTON);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:32   

   4606  6 000166   000436 630400 2     MONINFO      EPPR0   GBOOT
         6 000167   420023 713400                    CLIMB   alt,+8211
         6 000170   402400 401760                    pmme    nvectors=6
         6 000171   000220 702000 6                  TSX2    EVNTON

      227     4607    1         KL_NODES = BOOT.NUM_NODES;

   4607  6 000172   000160 235000 1                  LDA     BOOT+12
         6 000173   000000 755000 xsym               STA     KL_NODES

      228     4608    1         KL_MXFE = BOOT.NUM_NODES;

   4608  6 000174   000000 755000 xsym               STA     KL_MXFE

      229     4609    2         DO CASE (BOOT.BOOTFLAG#);

   4609  6 000175   000152 236000 1                  LDQ     BOOT+6
         6 000176   000007 116007                    CMPQ    7,DL
         6 000177   000201 602006 6                  TNC     s:4609+4,QL
         6 000200   000220 710000 6                  TRA     EVNTON
         6 000201   000220 710000 6                  TRA     EVNTON
         6 000202   000220 710000 6                  TRA     EVNTON
         6 000203   000210 710000 6                  TRA     s:4611
         6 000204   000213 710000 6                  TRA     s:4613
         6 000205   000216 710000 6                  TRA     s:4615
         6 000206   000213 710000 6                  TRA     s:4613
         6 000207   000216 710000 6                  TRA     s:4615

      230     4610    2           CASE(I_NEWFILES);

      231     4611    2             JC_TBOOT=3;

   4611  6 000210   000003 235007                    LDA     3,DL
         6 000211   000122 755000 1                  STA     JC_TBOOT
         6 000212   000220 710000 6                  TRA     EVNTON

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:33   
      232     4612    2           CASE(I_SYSFILES,I_SYSFILES_RECON);

      233     4613    2             JC_TBOOT=2;

   4613  6 000213   000002 235007                    LDA     2,DL
         6 000214   000122 755000 1                  STA     JC_TBOOT
         6 000215   000220 710000 6                  TRA     EVNTON

      234     4614    2           CASE(I_NOFILES,I_NOFILES_RECON);

      235     4615    2             JC_TBOOT=1;

   4615  6 000216   000001 235007                    LDA     1,DL
         6 000217   000122 755000 1                  STA     JC_TBOOT

      236     4616    2           END;

      237     4617        /**/
      238     4618        /* Check on the condition of any old files that we need */
      239     4619        /**/
      240     4620    2   EVNTON: IF JC_TBOOT~=3 THEN DO;

   4620  6 000220   000122 235000 1     EVNTON       LDA     JC_TBOOT
         6 000221   000003 115007                    CMPA    3,DL
         6 000222   000454 600000 6                  TZE     s:4724

      241     4621        /**/
      242     4622        /* Open :ACCTLG */
      243     4623        /**/
      244     4624    2           CALL JCS$OPACLG;

   4624  6 000223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000224   000000 701000 xent               TSX1    JCS$OPACLG
         6 000225   000000 011000                    NOP     0

      245     4625        /**/
      246     4626        /* :JOBSTATS */
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:34   
      247     4627        /**/
      248     4628    2           CALL M$OPEN (TSTF) ALTRET (NOJBS);

   4628  6 000226   000210 630400 1                  EPPR0   TSTF
         6 000227   450000 713400                    CLIMB   alt,open
         6 000230   410400 401760                    pmme    nvectors=18
         6 000231   000237 702000 6                  TSX2    NOJBS

      249     4629    2           CALL M$CLOSE (CLTF) ALTRET (NOJBS);

   4629  6 000232   000302 630400 1                  EPPR0   CLTF
         6 000233   450001 713400                    CLIMB   alt,close
         6 000234   406000 401760                    pmme    nvectors=13
         6 000235   000237 702000 6                  TSX2    NOJBS

      250     4630    2           GOTO GOTJBS;

   4630  6 000236   000247 710000 6                  TRA     GOTJBS

   4624  6 000237                       NOJBS        null
      251     4631    2   NOJBS:  ;
      252     4632    2           CALL ERDL;

   4632  6 000237   000703 701000 6                  TSX1    ERDL
         6 000240   000000 011000                    NOP     0

      253     4633    2           BFLM.MSG#=BDJBS_MSG#;

   4633  6 000241   000135 220003                    LDX0    93,DU
         6 000242   000130 440000 1                  SXL0    BFLM

      254     4634    2           CALL M$WRITE (WBFL) ALTRET (GOTJBS);

   4634  6 000243   000164 630400 1                  EPPR0   WBFL
         6 000244   440001 713400                    CLIMB   alt,write
         6 000245   401400 401760                    pmme    nvectors=4
         6 000246   000247 702000 6                  TSX2    GOTJBS
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:35   

   4633  6 000247                       GOTJBS       null
      255     4635        /**/
      256     4636        /* :COMAC */
      257     4637        /**/
      258     4638    2   GOTJBS: ;
      259     4639    2           TSTF.NAME_=VECTOR(COMAC);

   4639  6 000247   000006 237000 7                  LDAQ    6
         6 000250   000216 757000 1                  STAQ    TSTF+6

      260     4640    2           CALL M$OPEN (TSTF) ALTRET (NOCMAC);

   4640  6 000251   000210 630400 1                  EPPR0   TSTF
         6 000252   450000 713400                    CLIMB   alt,open
         6 000253   410400 401760                    pmme    nvectors=18
         6 000254   000262 702000 6                  TSX2    NOCMAC

      261     4641    2           CALL M$CLOSE (CLTF) ALTRET (NOCMAC);

   4641  6 000255   000302 630400 1                  EPPR0   CLTF
         6 000256   450001 713400                    CLIMB   alt,close
         6 000257   406000 401760                    pmme    nvectors=13
         6 000260   000262 702000 6                  TSX2    NOCMAC

      262     4642    2           GOTO GOTCMAC;

   4642  6 000261   000272 710000 6                  TRA     GOTCMAC

   4639  6 000262                       NOCMAC       null
      263     4643    2   NOCMAC: ;
      264     4644    2           CALL ERDL;

   4644  6 000262   000703 701000 6                  TSX1    ERDL
         6 000263   000000 011000                    NOP     0

      265     4645    2           BFLM.MSG#=BCMAC_MSG#;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:36   

   4645  6 000264   000140 220003                    LDX0    96,DU
         6 000265   000130 440000 1                  SXL0    BFLM

      266     4646    2           CALL M$WRITE (WBFL) ALTRET (GOTCMAC);

   4646  6 000266   000164 630400 1                  EPPR0   WBFL
         6 000267   440001 713400                    CLIMB   alt,write
         6 000270   401400 401760                    pmme    nvectors=4
         6 000271   000272 702000 6                  TSX2    GOTCMAC

   4645  6 000272                       GOTCMAC      null
      267     4647        /**/
      268     4648        /* :PRO */
      269     4649        /**/
      270     4650    2   GOTCMAC: ;
      271     4651    2           TSTF.NAME_=VECTOR(PRO);

   4651  6 000272   000010 237000 7                  LDAQ    8
         6 000273   000216 757000 1                  STAQ    TSTF+6

      272     4652    2           CALL M$OPEN (TSTF) ALTRET (NOPRO);

   4652  6 000274   000210 630400 1                  EPPR0   TSTF
         6 000275   450000 713400                    CLIMB   alt,open
         6 000276   410400 401760                    pmme    nvectors=18
         6 000277   000305 702000 6                  TSX2    NOPRO

      273     4653    2           CALL M$CLOSE (CLTF) ALTRET (NOPRO);

   4653  6 000300   000302 630400 1                  EPPR0   CLTF
         6 000301   450001 713400                    CLIMB   alt,close
         6 000302   406000 401760                    pmme    nvectors=13
         6 000303   000305 702000 6                  TSX2    NOPRO

      274     4654    2           GOTO GOTPRO;

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:37   
   4654  6 000304   000317 710000 6                  TRA     GOTPRO

   4651  6 000305                       NOPRO        null
      275     4655    2   NOPRO:  ;
      276     4656    2           JC_SUPER.PRO=1;

   4656  6 000305   000001 220003                    LDX0    1,DU
         6 000306   000123 740000 1                  STX0    JC_SUPER

      277     4657    2           CALL ERDL;

   4657  6 000307   000703 701000 6                  TSX1    ERDL
         6 000310   000000 011000                    NOP     0

      278     4658    2           BFLM.MSG#=BDPRO_MSG#;

   4658  6 000311   000136 220003                    LDX0    94,DU
         6 000312   000130 440000 1                  SXL0    BFLM

      279     4659    2           CALL M$WRITE (WBFL) ALTRET (GOTPRO);

   4659  6 000313   000164 630400 1                  EPPR0   WBFL
         6 000314   440001 713400                    CLIMB   alt,write
         6 000315   401400 401760                    pmme    nvectors=4
         6 000316   000317 702000 6                  TSX2    GOTPRO

   4658  6 000317                       GOTPRO       null
      280     4660        /**/
      281     4661        /* :FORM */
      282     4662        /**/
      283     4663    2   GOTPRO: ;
      284     4664    2           TSTF.NAME_=VECTOR(FORM);

   4664  6 000317   000012 237000 7                  LDAQ    10
         6 000320   000216 757000 1                  STAQ    TSTF+6

      285     4665    2           CALL M$OPEN (TSTF) ALTRET (NOFORM);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:38   

   4665  6 000321   000210 630400 1                  EPPR0   TSTF
         6 000322   450000 713400                    CLIMB   alt,open
         6 000323   410400 401760                    pmme    nvectors=18
         6 000324   000332 702000 6                  TSX2    NOFORM

      286     4666    2           CALL M$CLOSE (CLTF) ALTRET (NOFORM);

   4666  6 000325   000302 630400 1                  EPPR0   CLTF
         6 000326   450001 713400                    CLIMB   alt,close
         6 000327   406000 401760                    pmme    nvectors=13
         6 000330   000332 702000 6                  TSX2    NOFORM

      287     4667    2           GOTO GOTFORM;

   4667  6 000331   000336 710000 6                  TRA     GOTFORM

   4664  6 000332                       NOFORM       null
      288     4668    2   NOFORM: ;
      289     4669    2           JC_SUPER.UHWF=4;

   4669  6 000332   000004 220003                    LDX0    4,DU
         6 000333   000123 440000 1                  SXL0    JC_SUPER

      290     4670    2           CALL ERDL;

   4670  6 000334   000703 701000 6                  TSX1    ERDL
         6 000335   000000 011000                    NOP     0

   4669  6 000336                       GOTFORM      null
      291     4671        /**/
      292     4672        /* :WSN */
      293     4673        /**/
      294     4674    2   GOTFORM:;
      295     4675    2           TSTF.NAME_=VECTOR(WSN);

   4675  6 000336   000014 237000 7                  LDAQ    12
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:39   
         6 000337   000216 757000 1                  STAQ    TSTF+6

      296     4676    3           IF JC_SUPER.UHWF=0 THEN DO;

   4676  6 000340   000123 720000 1                  LXL0    JC_SUPER
         6 000341   000363 601000 6                  TNZ     s:4686

      297     4677    3             CALL M$OPEN (TSTF) ALTRET (NOWSN);

   4677  6 000342   000210 630400 1                  EPPR0   TSTF
         6 000343   450000 713400                    CLIMB   alt,open
         6 000344   410400 401760                    pmme    nvectors=18
         6 000345   000361 702000 6                  TSX2    NOWSN

      298     4678    3             CALL M$READ (RLCL) ALTRET (NRWSN); /* Look for 'LOCAL   STATION'       */

   4678  6 000346   000340 630400 1                  EPPR0   RLCL
         6 000347   440000 713400                    CLIMB   alt,read
         6 000350   401400 401760                    pmme    nvectors=4
         6 000351   000357 702000 6                  TSX2    NRWSN

      299     4679    3             CALL M$CLOSE (CLTF) ALTRET (NOWSN);

   4679  6 000352   000302 630400 1                  EPPR0   CLTF
         6 000353   450001 713400                    CLIMB   alt,close
         6 000354   406000 401760                    pmme    nvectors=13
         6 000355   000361 702000 6                  TSX2    NOWSN

      300     4680    3             GOTO GOTWSN;

   4680  6 000356   000365 710000 6                  TRA     GOTWSN

   4677  6 000357                       NRWSN        null
      301     4681    3   NRWSN:    ;
      302     4682    3             CALL RDCK ALTRET (GOTWSN);

   4682  6 000357   000661 701000 6                  TSX1    RDCK
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:40   
         6 000360   000365 702000 6                  TSX2    GOTWSN

   4677  6 000361                       NOWSN        null
      303     4683    3   NOWSN:    ;
      304     4684    3             JC_SUPER.UHWF=3;

   4684  6 000361   000003 220003                    LDX0    3,DU
         6 000362   000123 440000 1                  SXL0    JC_SUPER

      305     4685    3           END;

      306     4686    2           CALL ERDL;

   4686  6 000363   000703 701000 6                  TSX1    ERDL
         6 000364   000000 011000                    NOP     0

   4683  6 000365                       GOTWSN       null
      307     4687        /**/
      308     4688        /* :HLP */
      309     4689        /**/
      310     4690    2   GOTWSN: ;
      311     4691    2           TSTF.NAME_=VECTOR(HLP);

   4691  6 000365   000016 237000 7                  LDAQ    14
         6 000366   000216 757000 1                  STAQ    TSTF+6

      312     4692    2           CLTF.V.OPER.CHGATT# = '1'B;

   4692  6 000367   400000 236007                    LDQ     -131072,DL
         6 000370   000334 256000 1                  ORSQ    CLTF+26

      313     4693    2           CLTF.ACCESS_ = VECTOR(ACCESS_EXECALL);

   4693  6 000371   000020 237000 7                  LDAQ    16
         6 000372   000314 757000 1                  STAQ    CLTF+10

      314     4694    2           CLTF.ACSVEH_ = VECTOR(ACSVEH_HLP);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:41   

   4694  6 000373   000022 237000 7                  LDAQ    18
         6 000374   000316 757000 1                  STAQ    CLTF+12

      315     4695    3           IF JC_SUPER.UHWF=0 THEN DO;

   4695  6 000375   000123 720000 1                  LXL0    JC_SUPER
         6 000376   000422 601000 6                  TNZ     s:4706

      316     4696    3             CALL M$OPEN (TSTF) ALTRET (NOHLP);

   4696  6 000377   000210 630400 1                  EPPR0   TSTF
         6 000400   450000 713400                    CLIMB   alt,open
         6 000401   410400 401760                    pmme    nvectors=18
         6 000402   000420 702000 6                  TSX2    NOHLP

      317     4697    3             RLCL.KEY_ = VECTOR(LCLSTA);

   4697  6 000403   000024 237000 7                  LDAQ    20
         6 000404   000342 757000 1                  STAQ    RLCL+2

      318     4698    3             CALL M$READ (RLCL) ALTRET (NRHLP); /* Look for 'LOCAL   STATION'       */

   4698  6 000405   000340 630400 1                  EPPR0   RLCL
         6 000406   440000 713400                    CLIMB   alt,read
         6 000407   401400 401760                    pmme    nvectors=4
         6 000410   000416 702000 6                  TSX2    NRHLP

      319     4699    3             CALL M$CLOSE (CLTF) ALTRET (NOHLP);

   4699  6 000411   000302 630400 1                  EPPR0   CLTF
         6 000412   450001 713400                    CLIMB   alt,close
         6 000413   406000 401760                    pmme    nvectors=13
         6 000414   000420 702000 6                  TSX2    NOHLP

      320     4700    3             GOTO GOTHLP;

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:42   
   4700  6 000415   000424 710000 6                  TRA     GOTHLP

   4697  6 000416                       NRHLP        null
      321     4701    3   NRHLP:    ;
      322     4702    3             CALL RDCK ALTRET (GOTHLP);

   4702  6 000416   000661 701000 6                  TSX1    RDCK
         6 000417   000424 702000 6                  TSX2    GOTHLP

   4697  6 000420                       NOHLP        null
      323     4703    3   NOHLP:    ;
      324     4704    3             JC_SUPER.UHWF=2;

   4704  6 000420   000002 220003                    LDX0    2,DU
         6 000421   000123 440000 1                  SXL0    JC_SUPER

      325     4705    3           END;

      326     4706    2           CALL ERDL;

   4706  6 000422   000703 701000 6                  TSX1    ERDL
         6 000423   000000 011000                    NOP     0

   4701  6 000424                       GOTHLP       null
      327     4707        /**/
      328     4708        /* :USERS */
      329     4709        /**/
      330     4710    2   GOTHLP: ;
      331     4711    2           TSTF.NAME_=VECTOR(USERS);

   4711  6 000424   000026 237000 7                  LDAQ    22
         6 000425   000216 757000 1                  STAQ    TSTF+6

      332     4712    2           CLTF.ACSVEH_ = VECTOR(ACSVEH_USERS);

   4712  6 000426   000030 237000 7                  LDAQ    24
         6 000427   000316 757000 1                  STAQ    CLTF+12
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:43   

      333     4713    3           IF JC_SUPER.UHWF=0 THEN DO;

   4713  6 000430   000123 720000 1                  LXL0    JC_SUPER
         6 000431   000451 601000 6                  TNZ     s:4722

      334     4714    3             CALL M$OPEN (TSTF) ALTRET (NOUSR);

   4714  6 000432   000210 630400 1                  EPPR0   TSTF
         6 000433   450000 713400                    CLIMB   alt,open
         6 000434   410400 401760                    pmme    nvectors=18
         6 000435   000443 702000 6                  TSX2    NOUSR

      335     4715    3             CALL M$CLOSE (CLTF) ALTRET (NOUSR);

   4715  6 000436   000302 630400 1                  EPPR0   CLTF
         6 000437   450001 713400                    CLIMB   alt,close
         6 000440   406000 401760                    pmme    nvectors=13
         6 000441   000443 702000 6                  TSX2    NOUSR

      336     4716    3             GOTO GOTUSR;

   4716  6 000442   000457 710000 6                  TRA     GOTUSR

   4714  6 000443                       NOUSR        null
      337     4717    3   NOUSR:    ;
      338     4718    3             JC_SUPER.UHWF=1;

   4718  6 000443   000001 220003                    LDX0    1,DU
         6 000444   000123 440000 1                  SXL0    JC_SUPER

      339     4719    3             CALL ERDL;

   4719  6 000445   000703 701000 6                  TSX1    ERDL
         6 000446   000000 011000                    NOP     0

      340     4720    3             TSTF.NAME_=VECTOR(HLP);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:44   

   4720  6 000447   000016 237000 7                  LDAQ    14
         6 000450   000216 757000 1                  STAQ    TSTF+6

      341     4721    3           END;

      342     4722    2           CALL ERDL;   /* Delete :HLP if any of :HLP,:FORM,:WSN,:USERS is bad  */

   4722  6 000451   000703 701000 6                  TSX1    ERDL
         6 000452   000000 011000                    NOP     0

      343     4723    2         END;

   4723  6 000453   000457 710000 6                  TRA     GOTUSR

      344     4724    1           ELSE CALL JCS$CRACLG;

   4724  6 000454   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000455   000000 701000 xent               TSX1    JCS$CRACLG
         6 000456   000000 011000                    NOP     0

   4715  6 000457                       GOTUSR       null
      345     4725    1   GOTUSR: ;
      346     4726    1         CLTF.V.OPER.CHGATT# = '0'B;

   4726  6 000457   000032 236000 7                  LDQ     26
         6 000460   000334 356000 1                  ANSQ    CLTF+26

      347     4727    1         CLTF.ACCESS_ = VECTOR(NIL);

   4727  6 000461   000034 237000 7                  LDAQ    28
         6 000462   000314 757000 1                  STAQ    CLTF+10

      348     4728    1         CLTF.ACSVEH_ = VECTOR(NIL);

   4728  6 000463   000034 237000 7                  LDAQ    28
         6 000464   000316 757000 1                  STAQ    CLTF+12
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:45   

      349     4729        /**/
      350     4730        /* If a bad :USERS, :HLP, :WSN or :FORM file is found, write a msg to MONKEY */
      351     4731        /* telling him to turn off users                                             */
      352     4732        /**/
      353     4733    2         IF JC_SUPER.UHWF~=0 THEN DO;

   4733  6 000465   000123 720000 1                  LXL0    JC_SUPER
         6 000466   000511 600000 6                  TZE     FON4

      354     4734    2           BFLM.FILE=JC_SUPER.UHWF;

   4734  6 000467   000123 236000 1                  LDQ     JC_SUPER
         6 000470   000022 736000                    QLS     18
         6 000471   000135 552020 1                  STBQ    BFLM+5,'20'O

      355     4735    2           BFLM.MSG#=BUHWF_MSG#;

   4735  6 000472   000137 221003                    LDX1    95,DU
         6 000473   000130 441000 1                  SXL1    BFLM

      356     4736    2           CALL M$WRITE (WBFL) ALTRET (FON3);

   4736  6 000474   000164 630400 1                  EPPR0   WBFL
         6 000475   440001 713400                    CLIMB   alt,write
         6 000476   401400 401760                    pmme    nvectors=4
         6 000477   000500 702000 6                  TSX2    FON3

      357     4737    2   FON3:   WBFL.BUF_=VECTOR(BTOFF);

   4737  6 000500   000036 237000 7     FON3         LDAQ    30
         6 000501   000170 757000 1                  STAQ    WBFL+4

      358     4738    2           WSTA.STATION#='MONKEY';

   4738  6 000502   040000 100400                    MLR     fill='040'O
         6 000503   000543 000006 2                  ADSC9   LCLSTA+4                 cn=0,n=6
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:46   
         6 000504   000200 000010 1                  ADSC9   WSTA                     cn=0,n=8

      359     4739    2           CALL M$WRITE (WBFL) ALTRET (FON4);

   4739  6 000505   000164 630400 1                  EPPR0   WBFL
         6 000506   440001 713400                    CLIMB   alt,write
         6 000507   401400 401760                    pmme    nvectors=4
         6 000510   000511 702000 6                  TSX2    FON4

      360     4740    2   FON4: END;

   4740  6 000511                       FON4         null
      361     4741        /**/
      362     4742        /* Create :JOBSTATS file if it doesn't exist (initial MBS initialization) */
      363     4743        /**/
      364     4744    1         CALL JMM$INIT0;

   4744  6 000511   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000512   000000 701000 xent               TSX1    JMM$INIT0
         6 000513   000000 011000                    NOP     0

      365     4745    1   GHGO:
      366     4746        /**/
      367     4747        /* Initialize SLUG's event queue and free chain of event blocks */
      368     4748        /**/
      369     4749    1         JC_EVQCNT = 0;

   4749  6 000514   000000 450000 xsym  GHGO         STZ     JC_EVQCNT

      370     4750    1         JC_FQHD$ = ADDR(JC_QEV(0));

   4750  6 000515   000033 236000 7                  LDQ     27
         6 000516   000000 756000 xsym               STQ     JC_FQHD$

      371     4751    2         DO I=0 TO 8;

   4751  6 000517   200004 450100                    STZ     I,,AUTO
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:47   

      372     4752    2           JC_QEV.LNK$(I) = ADDR(JC_QEV(I+1));

   4752  6 000520   200004 236100                    LDQ     I,,AUTO
         6 000521   000012 402007                    MPY     10,DL
         6 000522   000000 620006                    EAX0    0,QL
         6 000523   200004 236100                    LDQ     I,,AUTO
         6 000524   000012 402003                    MPY     10,DU
         6 000525   000040 036000 7                  ADLQ    32
         6 000526   000001 756010 xsym               STQ     JC_QEV+1,X0

      373     4753    2         END;

   4753  6 000527   200004 235100                    LDA     I,,AUTO
         6 000530   000001 035007                    ADLA    1,DL
         6 000531   200004 755100                    STA     I,,AUTO
         6 000532   000011 115007                    CMPA    9,DL
         6 000533   000520 602000 6                  TNC     s:4752

      374     4754        /**/
      375     4755        /* Post first read to CG/CSCG from station SLUG */
      376     4756        /**/
      377     4757    1         CALL M$READ (RDCSCG) ALTRET (KRDY);

   4757  6 000534   000420 630400 2                  EPPR0   RDCSCG
         6 000535   440000 713400                    CLIMB   alt,read
         6 000536   401400 401760                    pmme    nvectors=4
         6 000537   000540 702000 6                  TSX2    KRDY

      378     4758        /**/
      379     4759        /* Open CG/CSCG for station MBS */
      380     4760        /**/
      381     4761    1   KRDY: CALL M$OPEN (JMM_OPEN_CSCG) ALTRET (SC2);

   4761  6 000540   000000 630400 xsym  KRDY         EPPR0   JMM_OPEN_CSCG
         6 000541   450000 713400                    CLIMB   alt,open
         6 000542   410400 401760                    pmme    nvectors=18
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:48   
         6 000543   000647 702000 6                  TSX2    SC2

      382     4762        /**/
      383     4763        /**/
      384     4764        /* OK, now start the phased system startup by setting JC_PHASE to 0          */
      385     4765        /* and posting a phase-complete event to SLUG.                               */
      386     4766        /**/
      387     4767    1         JC_WAITING = '0'B;               /* Not waiting on any ghosts          */

   4767  6 000544   000000 450000 xsym               STZ     JC_WAITING

      388     4768    1         JC_SUSROK = '0'B;                /* SUSR type of JC_CITE is not yet OK */

   4768  6 000545   000000 450000 xsym               STZ     JC_SUSROK

      389     4769    1         JC_SUSR = '0'B;                  /* Don't start users yet              */

   4769  6 000546   000000 450000 xsym               STZ     JC_SUSR

      390     4770    1         JC_PHASE = 0;

   4770  6 000547   000000 450000 xsym               STZ     JC_PHASE

      391     4771    1         CALL JCE$EVENT(JCQEV_PCMP#);

   4771  6 000550   000041 630400 7                  EPPR0   33
         6 000551   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000552   000000 701000 xent               TSX1    JCE$EVENT
         6 000553   000000 011000                    NOP     0

      392     4772        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:49   
      393     4773        /**/
      394     4774        /* This is the main loop of SLUG. Whenever a read needs to be posted or an   */
      395     4775        /* event needs to be processed, this loop detects that and acts accordingly. */
      396     4776        /* If nothing needs to be done, SLUG goes to sleep until the rest of the     */
      397     4777        /* current minute elapses or until an event occurs. Once a minute,           */
      398     4778        /* JMR$TIME is called to do RUNAFTER and NORUN scheduling for MBS.           */
      399     4779        /**/
      400     4780    2         DO INHIBIT;

      401     4781    3           DO WHILE ('1'B);

      402     4782    4             DO WHILE (JC_FERD+JC_MBSRD+JC_CSRD+JMC_EVQCNT+JC_EVQCNT~=0);

   4782  6 000554   000614 710200 6                  TRA   ! KYDN

      403     4783    4               IF JC_EVQCNT~=0 THEN CALL JCP$PROCESS;  /* SLUG event processing */

   4783  6 000555   000000 235200 xsym               LDA   ! JC_EVQCNT
         6 000556   000562 600200 6                  TZE   ! s:4784

   4783  6 000557   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         6 000560   000000 701200 xent               TSX1  ! JCP$PROCESS
         6 000561   000000 011200                    NOP   ! 0

      404     4784    4               IF JMC_EVQCNT~=0 THEN CALL JMM$PROCESS; /* MBS event processing  */

   4784  6 000562   000000 235200 xsym               LDA   ! JMC_EVQCNT
         6 000563   000567 600200 6                  TZE   ! s:4785

   4784  6 000564   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         6 000565   000000 701200 xent               TSX1  ! JMM$PROCESS
         6 000566   000000 011200                    NOP   ! 0

      405     4785    5               IF JC_FERD~=0 THEN DO;

   4785  6 000567   000117 235200 1                  LDA   ! JC_FERD
         6 000570   000576 600200 6                  TZE   ! HLPON
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:50   

      406     4786    5                 JC_FERD=0;

   4786  6 000571   000117 450200 1                  STZ   ! JC_FERD

      407     4787    5                 CALL M$READ (KL_RDHLP) ALTRET (SC4);

   4787  6 000572   000000 630600 xsym               EPPR0 ! KL_RDHLP
         6 000573   440000 713600                    CLIMB ! alt,read
         6 000574   401400 401760                    pmme    nvectors=4
         6 000575   000654 702200 6                  TSX2  ! SC4

      408     4788    5               END;

      409     4789    5   HLPON:      IF JC_CSRD~=0 THEN DO;

   4789  6 000576   000120 235200 1     HLPON        LDA   ! JC_CSRD
         6 000577   000605 600200 6                  TZE   ! s:4793

      410     4790    5                 JC_CSRD=0;

   4790  6 000600   000120 450200 1                  STZ   ! JC_CSRD

      411     4791    5                 CALL M$READ (RDCSCG) ALTRET (KYDN);

   4791  6 000601   000420 630600 2                  EPPR0 ! RDCSCG
         6 000602   440000 713600                    CLIMB ! alt,read
         6 000603   401400 401760                    pmme    nvectors=4
         6 000604   000614 702200 6                  TSX2  ! KYDN

      412     4792    5               END;

      413     4793    5               IF JC_MBSRD~=0 THEN DO;

   4793  6 000605   000121 235200 1                  LDA   ! JC_MBSRD
         6 000606   000614 600200 6                  TZE   ! KYDN

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:51   
      414     4794    5                 JC_MBSRD=0;

   4794  6 000607   000121 450200 1                  STZ   ! JC_MBSRD

      415     4795    5                 CALL M$READ (JM_RDMBS) ALTRET (KYDN);

   4795  6 000610   000000 630600 xsym               EPPR0 ! JM_RDMBS
         6 000611   440000 713600                    CLIMB ! alt,read
         6 000612   401400 401760                    pmme    nvectors=4
         6 000613   000614 702200 6                  TSX2  ! KYDN

      416     4796    5               END;

      417     4797    4   KYDN:     END;

   4797  6 000614   000117 236200 1     KYDN         LDQ   ! JC_FERD
         6 000615   000121 036200 1                  ADLQ  ! JC_MBSRD
         6 000616   000120 036200 1                  ADLQ  ! JC_CSRD
         6 000617   000000 036200 xsym               ADLQ  ! JMC_EVQCNT
         6 000620   000000 036200 xsym               ADLQ  ! JC_EVQCNT
         6 000621   000555 601200 6                  TNZ   ! s:4783

      418     4798    4             IF TLFT=0 THEN DO;

   4798  6 000622   000002 235200 1                  LDA   ! TLFT
         6 000623   000631 601200 6                  TNZ   ! s:4802

      419     4799    4               TLFT=60;

   4799  6 000624   000074 236207                    LDQ   ! 60,DL
         6 000625   000002 756200 1                  STQ   ! TLFT

      420     4800    4               CALL JMR$TIME;

   4800  6 000626   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         6 000627   000000 701200 xent               TSX1  ! JMR$TIME
         6 000630   000000 011200                    NOP   ! 0
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:52   

      421     4801    4             END;

      422     4802    3             IF JC_ZIP>0 THEN CALL JCP$ZIPCK;

   4802  6 000631   000000 235200 xsym               LDA   ! JC_ZIP
         6 000632   000636 604600 6                  TMOZ  ! s:4803

   4802  6 000633   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         6 000634   000000 701200 xent               TSX1  ! JCP$ZIPCK
         6 000635   000000 011200                    NOP   ! 0

      423     4803    3             WAITMIN.V.UNITS#=TLFT;

   4803  6 000636   000002 235200 1                  LDA   ! TLFT
         6 000637   000142 755200 1                  STA   ! WAITMIN+4

      424     4804    3             IF (JC_EVQCNT + JMC_EVQCNT = 0)

   4804  6 000640   000000 236200 xsym               LDQ   ! JC_EVQCNT
         6 000641   000000 036200 xsym               ADLQ  ! JMC_EVQCNT
         6 000642   000554 601200 6                  TNZ   ! s:4782

      425     4805    3               THEN
      426     4806    3               CALL M$WAIT (WAITMIN);

   4806  6 000643   000136 630600 1                  EPPR0 ! WAITMIN
         6 000644   020006 713600                    CLIMB ! 8198
         6 000645   400400 401760                    pmme    nvectors=2

      427     4807    3           END;

   4807  6 000646   000554 710200 6                  TRA   ! s:4782

      428     4808    2         END;

   4805  6 000647                       SC2          null
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:53   
      429     4809        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:54   
      430     4810    1   SC2:  ;
      431     4811    1         CALL FOI$CRASHGO (%S$NOPCS,F_JC,M_S);

   4811  6 000647   000045 630400 7                  EPPR0   37
         6 000650   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000651   000000 701000 xent               TSX1    FOI$CRASHGO
         6 000652   000000 011000                    NOP     0

      432     4812        /*S*  SCREECH_CODE: JCS-S$NOPCS
      433     4813              TYPE:    Screech
      434     4814              MESSAGE: SLUG unable to open CSCG
      435     4815              REMARKS: SLUG must open the central system comgroup (CSCG) in order
      436     4816                       to communicate with KEYIN and other parts of the
      437     4817                       system.  This screech results when this cannot be done.       */
      438     4818    1         GOTO GHGO;

   4818  6 000653   000514 710000 6                  TRA     GHGO

   4805  6 000654                       SC4          null
      439     4819    1   SC4:  ;
      440     4820    1         CALL FOI$CRASHGO (%S$NRDHLP,F_JC,M_S);

   4820  6 000654   000051 630400 7                  EPPR0   41
         6 000655   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000656   000000 701000 xent               TSX1    FOI$CRASHGO
         6 000657   000000 011000                    NOP     0

      441     4821        /*S*  SCREECH_CODE: JCS-S$NRDHLP
      442     4822              TYPE:    Screech
      443     4823              MESSAGE: SLUG got ALTRET reading HLPCG
      444     4824              REMARKS: Due to the nature of comgroups, SLUG should never get an
      445     4825                       ALTRET on his anonomous M$READ to HLPCG.  This screech
      446     4826                       occurs on the exception to that rule.                         */
      447     4827    1         GOTO HLPON;

   4827  6 000660   000576 710000 6                  TRA     HLPON

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:55   
      448     4828        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:56   
      449     4829    1   RDCK: PROC ALTRET;

   4829  6 000661   200006 741300       RDCK         STX1  ! I+2,,AUTO

      450     4830        /**/
      451     4831    2         I=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;

   4831  6 000662   000000 470400 xsym               LDP0    B$TCB$
         6 000663   000000 471500                    LDP1    0,,PR0
         6 000664   100102 236100                    LDQ     66,,PR1
         6 000665   000003 772000                    QRL     3
         6 000666   037777 376007                    ANQ     16383,DL
         6 000667   200004 756100                    STQ     I,,AUTO

      452     4832    2         CALL M$CLOSE (CLTF) ALTRET (RTN);

   4832  6 000670   000302 630400 1                  EPPR0   CLTF
         6 000671   450001 713400                    CLIMB   alt,close
         6 000672   406000 401760                    pmme    nvectors=13
         6 000673   000701 702000 6                  TSX2    RTN

      453     4833    2         IF I=%E$LD THEN ALTRETURN;

   4833  6 000674   200004 235100                    LDA     I,,AUTO
         6 000675   000007 115007                    CMPA    7,DL
         6 000676   000701 601000 6                  TNZ     RTN

   4833  6 000677   200006 221300                    LDX1  ! I+2,,AUTO
         6 000700   000000 702211                    TSX2  ! 0,X1

   4833  6 000701                       RTN          null
      454     4834    2   RTN:  ;
      455     4835    2         RETURN;

   4835  6 000701   200006 221300                    LDX1  ! I+2,,AUTO
         6 000702   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:57   
      456     4836        /**/
      457     4837    2   ERDL: ENTRY ALTRET;

   4837  6 000703   200006 741300       ERDL         STX1  ! I+2,,AUTO

      458     4838        /**/
      459     4839    2         DLTF.NAME_=TSTF.NAME_;

   4839  6 000704   000216 237000 1                  LDAQ    TSTF+6
         6 000705   000364 757000 1                  STAQ    DLTF+6

      460     4840    2         CALL M$OPEN (DLTF) ALTRET (ERDLRT);

   4840  6 000706   000356 630400 1                  EPPR0   DLTF
         6 000707   450000 713400                    CLIMB   alt,open
         6 000710   410400 401760                    pmme    nvectors=18
         6 000711   000712 702000 6                  TSX2    ERDLRT

   4839  6 000712                       ERDLRT       null
      461     4841    2   ERDLRT:;
      462     4842    2         RETURN;

   4842  6 000712   200006 221300                    LDX1  ! I+2,,AUTO
         6 000713   000001 702211                    TSX2  ! 1,X1

      463     4843    2   END RDCK;
      464     4844        %EJECT;
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:58   
      465     4845    1   JITINIT: PROC;

   4845  6 000714   200006 741300       JITINIT      STX1  ! I+2,,AUTO

      466     4846        /**/
      467     4847        /* Initialize the default JIT that SLUG gives to all new users. All users    */
      468     4848        /* except for sleazy ghosts will go through LOGON having most of these       */
      469     4849        /* values changed.                                                           */
      470     4850        /**/
      471     4851    2         ADDR(JC_JIT)->B$JIT='0'B;

   4851  6 000715   000000 100400                    MLR     fill='000'O
         6 000716   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 000717   000000 001730 xsym               ADSC9   JC_JIT                   cn=0,n=984

      472     4852    2         ADDR(JC_JIT)->B$JIT.PRIV.AUTH=~%PR_FMEFT#;

   4852  6 000720   000030 236000 xsym               LDQ     B_VECTNIL+24
         6 000721   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 000722   000014 756000 xsym               STQ     JC_JIT+12

      473     4853    2         ADDR(JC_JIT)->B$JIT.PRIV.JOB=~%PR_FMEFT#;

   4853  6 000723   000030 236000 xsym               LDQ     B_VECTNIL+24
         6 000724   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 000725   000015 756000 xsym               STQ     JC_JIT+13

      474     4854    2         ADDR(JC_JIT)->B$JIT.PPRIV=~%PPR_PADMIN#;

   4854  6 000726   000026 236000 xsym               LDQ     B_VECTNIL+22
         6 000727   000027 676000 xsym               ERQ     B_VECTNIL+23
         6 000730   000020 756000 xsym               STQ     JC_JIT+16

      475     4855    2         ADDR(JC_JIT)->B$JIT.PRFLAGS.EXPOUND = '1'B;

   4855  6 000731   000100 236003                    LDQ     64,DU
         6 000732   000030 256000 xsym               ORSQ    JC_JIT+24
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:59   

      476     4856    2         ADDR(JC_JIT)->B$JIT.PRFLAGS.POSITION = '1'B;

   4856  6 000733   000040 236003                    LDQ     32,DU
         6 000734   000030 256000 xsym               ORSQ    JC_JIT+24

      477     4857    2         ADDR(JC_JIT)->B$JIT.ACCEPT_FLAGS.SEND = '1'B;

   4857  6 000735   200000 236007                    LDQ     65536,DL
         6 000736   000153 256000 xsym               ORSQ    JC_JIT+107

      478     4858    2         ADDR(JC_JIT)->B$JIT.ACCEPT_FLAGS.BROADCAST = '1'B;

   4858  6 000737   040000 236007                    LDQ     16384,DL
         6 000740   000153 256000 xsym               ORSQ    JC_JIT+107

      479     4859    2         ADDR(JC_JIT)->B$JIT.LOCK = '777777777777777777777777'O;

   4859  6 000741   000000 100400                    MLR     fill='000'O
         6 000742   000545 000010 2                  ADSC9   LCLSTA+6                 cn=0,n=8
         6 000743   000154 000010 xsym               ADSC9   JC_JIT+108               cn=0,n=8

      480     4860    2         ADDR(JC_JIT)->B$JIT.FBUL=31;

   4860  6 000744   000037 220003                    LDX0    31,DU
         6 000745   000205 440000 xsym               SXL0    JC_JIT+133

      481     4861    2         ADDR(JC_JIT)->B$JIT.REMCPO=BITBIN('377777777777'O);

   4861  6 000746   000031 235000 xsym               LDA     B_VECTNIL+25
         6 000747   000360 755000 xsym               STA     JC_JIT+240

      482     4862    2         ADDR(JC_JIT)->B$JIT.REMLO=BITBIN('377777777777'O);

   4862  6 000750   000361 755000 xsym               STA     JC_JIT+241

      483     4863    2         ADDR(JC_JIT)->B$JIT.REMDO=BITBIN('377777777777'O);
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:60   

   4863  6 000751   000362 755000 xsym               STA     JC_JIT+242

      484     4864    2         ADDR(JC_JIT)->B$JIT.MAXCORE=1024;

   4864  6 000752   002000 222003                    LDX2    1024,DU
         6 000753   000210 742000 xsym               STX2    JC_JIT+136

      485     4865    2         ADDR(JC_JIT)->B$JIT.RESCORE=1024;

   4865  6 000754   002000 235007                    LDA     1024,DL
         6 000755   000336 755000 xsym               STA     JC_JIT+222

      486     4866    2         ADDR(JC_JIT)->B$JIT.MAXPRI=15;

   4866  6 000756   000017 236003                    LDQ     15,DU
         6 000757   000153 552020 xsym               STBQ    JC_JIT+107,'20'O

      487     4867    2         ADDR(JC_JIT)->B$JIT.DEFPRI=7;

   4867  6 000760   007000 236003                    LDQ     3584,DU
         6 000761   000153 552040 xsym               STBQ    JC_JIT+107,'40'O

      488     4868    2         ADDR(JC_JIT)->B$JIT.MRT=BITBIN('377777777777'O);

   4868  6 000762   000031 235000 xsym               LDA     B_VECTNIL+25
         6 000763   000276 755000 xsym               STA     JC_JIT+190

      489     4869    2         ADDR(JC_JIT)->B$JIT.OLTA='6'O;

   4869  6 000764   600000 236007                    LDQ     -65536,DL
         6 000765   000333 256000 xsym               ORSQ    JC_JIT+219

      490     4870    2         ADDR(JC_JIT)->B$JIT.PRDPRM=BITBIN('177777777777'O);

   4870  6 000766   000547 235000 2                  LDA     LCLSTA+8
         6 000767   000242 755000 xsym               STA     JC_JIT+162
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:61   

      491     4871    2         ADDR(JC_JIT)->B$JIT.MAXTMPDP=10000;

   4871  6 000770   023420 235007                    LDA     10000,DL
         6 000771   000241 755000 xsym               STA     JC_JIT+161

      492     4872    2         ADDR(JC_JIT)->B$JIT.DO$=ADDR(NIL);

   4872  6 000772   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000773   000233 756000 xsym               STQ     JC_JIT+155

      493     4873    2         ADDR(JC_JIT)->B$JIT.HPSN='SYS  ';

   4873  6 000774   040000 100400                    MLR     fill='040'O
         6 000775   000550 000005 2                  ADSC9   LCLSTA+9                 cn=0,n=5
         6 000776   000234 000006 xsym               ADSC9   JC_JIT+156               cn=0,n=6

      494     4874    2         ADDR(JC_JIT)->B$JIT.FPSN=' ';

   4874  6 000777   040000 100400                    MLR     fill='040'O
         6 001000   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001001   000021 000006 xsym               ADSC9   JC_JIT+17                cn=0,n=6

      495     4875    2         ADDR(JC_JIT)->B$JIT.WOO='LOCAL';

   4875  6 001002   040000 100400                    MLR     fill='040'O
         6 001003   000552 000005 2                  ADSC9   LCLSTA+11                cn=0,n=5
         6 001004   000010 000010 xsym               ADSC9   JC_JIT+8                 cn=0,n=8

      496     4876    2         ADDR(JC_JIT)->B$JIT.JOBNAME=' ';

   4876  6 001005   040000 100400                    MLR     fill='040'O
         6 001006   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001007   000156 200037 xsym               ADSC9   JC_JIT+110               cn=1,n=31

      497     4877    2         ADDR(JC_JIT)->B$JIT.OUTPRIO=7;

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:62   
   4877  6 001010   007000 236007                    LDQ     3584,DL
         6 001011   000022 552010 xsym               STBQ    JC_JIT+18,'10'O

      498     4878    2         RETURN;

   4878  6 001012   000001 702211                    TSX2  ! 1,X1
      499     4879    2   END JITINIT;
      500     4880    1   END JCS$SLUG;
      501     4881        %EOD;

PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:63   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   JMC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   JC_SUBS_C.:E05TOU  is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   JC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   I_SUBS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCS$SLUG.
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:64   

 **** Variables and constants ****

  ****  Section 001  Data  JCS$SLUG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   130-0-0/c STRC(198)   r     1 BFLM                     144-0-0/d STRC(540)   r     1 BOOT
   302-0-0/d STRC(1080)  r     1 CLTF                     356-0-0/d STRC(2088)  r     1 DLTF
   126-0-0/d BIT         r     1 ERCOD                      4-0-0/c CHAR(300)   r     1 JC_CSMBF
   120-0-0/w UBIN        r     1 JC_CSRD                  117-0-0/w UBIN        r     1 JC_FERD
   121-0-0/w UBIN        r     1 JC_MBSRD                 123-0-0/w STRC        r     1 JC_SUPER
   122-0-0/w UBIN        r     1 JC_TBOOT                 340-0-0/d STRC(504)   r     1 RLCL
     2-0-0/d UBIN        r     1 TLFT                       0-0-0/w STRC        r     1 TPTR
     0-0-0/w PTR         r     1 TPTR$                    210-0-0/d STRC(2088)  r     1 TSTF
   136-0-0/d STRC(216)   r     1 WAITMIN                  164-0-0/d STRC(432)   r     1 WBFL
   200-0-0/w STRC(288)   r     1 WSTA

  ****  Section 002 RoData JCS$SLUG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   454-0-0/w STRC(126)   r     1 ACCESS_EXECALL           460-0-0/w STRC(630)   r     1 ACSVEH_HLP
   502-0-0/w STRC(468)   r     1 ACSVEH_USERS               0-0-0/w STRC(72)    r     1 BTOFF
   250-0-0/d STRC(1080)  r     1 CLCSAU                   452-0-0/c STRC(72)    r     1 COMAC
   402-0-0/c STRC(72)    r     1 CSCG                     133-0-0/w STRC(126)   r     1 CSCG_ACCESS
   120-0-0/w STRC(387)   r     1 CSCG_ACSVEH              140-0-0/d STRC(1872)  r     1 CSCTL
   224-0-0/d STRC(720)   r     1 CSPRM                    404-0-0/w STRC(432)   r     1 CSST
    12-0-0/w UBIN        r     1 DUMMYENT                 530-0-0/c STRC(72)    r     1 FORM
    14-0-0/d STRC(144)   r     1 FPT_EVENT                  2-0-0/d STRC(288)   r     1 FPT_SLUGUP
    20-0-0/d STRC(216)   r     1 FPT_XCON                 436-0-0/d STRC(432)   r     1 GBOOT
   526-0-0/c STRC(72)    r     1 HLP                      517-0-0/c STRC(108)   r     1 JOBSTATS
   534-0-0/c STRC(108)   r     1 LCL                      537-0-0/c STRC(144)   r     1 LCLSTA
    26-0-0/d STRC(2088)  r     1 OPCSAU                   310-0-0/d STRC(2088)  r     1 OPCSCG
   522-0-0/c STRC(72)    r     1 PRO                      420-0-0/d STRC(504)   r     1 RDCSCG
   306-0-0/c STRC(72)    r     1 SYS                      532-0-0/c STRC(72)    r     1 USERS
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:65   
   524-0-0/c STRC(72)    r     1 WSN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w UBIN        r     1 I                          3-0-0/w PTR         r     1 RO$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w UBIN        r     1 JC_EVQCNT                  0-0-0/w PTR         r     1 JC_FQHD$
     0-0-0/w UBIN        r     1 JC_JIT                     0-0-0/w UBIN        r     1 JC_PHASE
     0-0-0/w STRC(360)   r     1 JC_QEV(0:9)                0-0-0/d STRC(72)    r     1 JC_ROAVL
     0-0-0/w PTR         r     1 JC_RODCB$(0:0)
     0-0-0/d UBIN        r     1 JC_ROSEG(0:1023)           0-0-0/w BIT         r     1 JC_SUSR
     0-0-0/w BIT         r     1 JC_SUSROK                  0-0-0/w UBIN        r     1 JC_UCSST
     0-0-0/w UBIN        r     1 JC_UCSTA                   0-0-0/w UBIN        r     1 JC_UCTABS
     0-0-0/b BIT         r     1 JC_WAITING(0:35)
     0-0-0/w SBIN        r     1 JC_ZIP                     0-0-0/w SBIN        r     1 JMC_EVQCNT
     0-0-0/d STRC(2088)  r     1 JMM_OPEN_CSCG              0-0-0/d STRC(504)   r     1 JM_RDMBS
     0-0-0/w UBIN        r     1 KL_MXFE                    0-0-0/w UBIN        r     1 KL_NODES
     0-0-0/d STRC(504)   r     1 KL_RDHLP                   0-0-0/d UBIN        r     1 M_UC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$CSCGAU                   0-0-0N  NULL        r     1 M$GHOST
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:66   


   Procedure JCS$SLUG requires 523 words for executable code.
   Procedure JCS$SLUG requires 10 words of local(AUTO) storage.
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:67   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:68   
          MINI XREF LISTING

ACCESS_EXECALL
      3908**DCL      4693--ASSIGN
ACCESS_EXECALL.Q
      3909**DCL      3908--DCLINIT
ACSVEH_HLP
      3939**DCL      4694--ASSIGN
ACSVEH_HLP.Q
      3940**DCL      3939--DCLINIT
ACSVEH_USERS
      4089**DCL      4712--ASSIGN
ACSVEH_USERS.Q
      4090**DCL      4089--DCLINIT
B$ALT.CODE
      2725**DCL      2725--REDEF    2726--REDEF    2726--REDEF
B$ALT.ERR.CODE
      2727**DCL      4831>>ASSIGN
B$ALT.ERR.ERR#
      2727**DCL      2727--REDEF
B$ALT.EVID
      2726**DCL      2726--REDEF    2726--REDEF
B$JIT
        78**DCL      4851<<ASSIGN
B$JIT.ACCEPT_FLAGS.BROADCAST
       231**DCL      4858<<ASSIGN
B$JIT.ACCEPT_FLAGS.SEND
       231**DCL      4857<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       177**DCL       177--REDEF
B$JIT.DEFPRI
       231**DCL      4867<<ASSIGN
B$JIT.DO$
       251**DCL      4872<<ASSIGN
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:69   
B$JIT.ERR.MID
        84**DCL        84--REDEF
B$JIT.FBUL
       243**DCL      4860<<ASSIGN
B$JIT.FPSN
       164**DCL      4874<<ASSIGN
B$JIT.HPSN
       251**DCL      4873<<ASSIGN
B$JIT.JOBNAME
       232**DCL      4876<<ASSIGN
B$JIT.JRESPEAK
       245**DCL       246--REDEF
B$JIT.LOCK
       232**DCL      4859<<ASSIGN
B$JIT.MAXCORE
       244**DCL      4864<<ASSIGN
B$JIT.MAXPRI
       231**DCL      4866<<ASSIGN
B$JIT.MAXTMPDP
       252**DCL      4871<<ASSIGN
B$JIT.MRT
       257**DCL      4868<<ASSIGN
B$JIT.OLTA
       351**DCL      4869<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       354**DCL       354--REDEF     355--REDEF
B$JIT.OUTPRIO
       164**DCL      4877<<ASSIGN
B$JIT.PNR
       258**DCL       258--REDEF
B$JIT.PPRIV
       139**DCL      4854<<ASSIGN
B$JIT.PRDPRM
       252**DCL      4870<<ASSIGN
B$JIT.PRFLAGS.EXPOUND
       168**DCL      4855<<ASSIGN
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:70   
B$JIT.PRFLAGS.POSITION
       168**DCL      4856<<ASSIGN
B$JIT.PRIV.AUTH
       124**DCL      4852<<ASSIGN
B$JIT.PRIV.JOB
       127**DCL      4853<<ASSIGN
B$JIT.REMCPO
       356**DCL      4861<<ASSIGN
B$JIT.REMDO
       356**DCL      4863<<ASSIGN
B$JIT.REMLO
       356**DCL      4862<<ASSIGN
B$JIT.RESCORE
       352**DCL      4865<<ASSIGN
B$JIT.SYSID
        83**DCL      4562>>IF
B$JIT.TSLINE
       352**DCL       353--REDEF
B$JIT.WOO
        83**DCL      4875<<ASSIGN
B$JIT$
      2759**DCL        78--IMP-PTR  4562>>IF
B$ROSEG.AVAIL$
        28**DCL      4571<<ASSIGN
B$ROSEG.DCBPTR$
        24**DCL      4569<<ASSIGN
B$ROSEG.NUMDCBS
        26**DCL      4572>>DOINDEX
B$TCB.ALT$
      2721**DCL      4831>>ASSIGN
B$TCB$
      2758**DCL      4831>>ASSIGN
BFLM
      2810**DCL      3678--DCLINIT  3679--DCLINIT
BFLM.FILE
      2823**DCL      4734<<ASSIGN
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:71   
BFLM.FLAGS
      2817**DCL      2818--REDEF
BFLM.MSG#
      2812**DCL      4633<<ASSIGN   4645<<ASSIGN   4658<<ASSIGN   4735<<ASSIGN
BFLM.MSGID
      2813**DCL      2814--REDEF
BOOT
      3544**DCL      3529--DCLINIT
BOOT.BOOTFLAG#
      3546**DCL      4609>>DOCASE
BOOT.NUM_NODES
      3548**DCL      4607>>ASSIGN   4608>>ASSIGN
BTOFF
      2741**DCL      4737--ASSIGN
CLCSAU
      3189**DCL      4597<>CALL
CLCSAU.SN_
      3189**DCL      3189--REDEF
CLCSAU.UTL_
      3190**DCL      3190--REDEF
CLCSAU.V
      3194**DCL      3189--DCLINIT
CLCSAU.V.EXPIRE#
      3204**DCL      3204--REDEF
CLCSAU.V.TYPE#
      3202**DCL      3202--REDEF
CLCSAU.V.XTNSIZE#
      3199**DCL      3199--REDEF    3201--REDEF
CLTF
      3878**DCL      4629<>CALL     4641<>CALL     4653<>CALL     4666<>CALL     4679<>CALL     4699<>CALL
      4715<>CALL     4832<>CALL
CLTF.ACCESS_
      3880**DCL      4693<<ASSIGN   4727<<ASSIGN
CLTF.ACSVEH_
      3881**DCL      4694<<ASSIGN   4712<<ASSIGN   4728<<ASSIGN
CLTF.SN_
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:72   
      3878**DCL      3878--REDEF
CLTF.UTL_
      3879**DCL      3879--REDEF
CLTF.V
      3883**DCL      3878--DCLINIT
CLTF.V.EXPIRE#
      3893**DCL      3893--REDEF
CLTF.V.OPER.CHGATT#
      3884**DCL      4692<<ASSIGN   4726<<ASSIGN
CLTF.V.TYPE#
      3891**DCL      3891--REDEF
CLTF.V.XTNSIZE#
      3888**DCL      3888--REDEF    3890--REDEF
COMAC
      3853**DCL      4639--ASSIGN
CSCG
      3370**DCL      2920--DCLINIT  3302--DCLINIT
CSCG_ACCESS
      3073**DCL      2921--DCLINIT
CSCG_ACCESS.Q
      3074**DCL      3073--DCLINIT
CSCG_ACSVEH
      2974**DCL      2922--DCLINIT
CSCG_ACSVEH.Q
      2975**DCL      2974--DCLINIT
CSCTL
      3104**DCL      4595<>CALL
CSCTL.V
      3109**DCL      3104--DCLINIT
CSPRM
      3135**DCL      3105--DCLINIT
CSPRM.DVBYTE.REREAD#
      3149**DCL      3150--REDEF
CSST
      3384**DCL      3302--DCLINIT
DLTF
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:73   
      4514**DCL      4840<>CALL
DLTF.ACSVEH_
      4516**DCL      4517--REDEF
DLTF.ALTKEYS_
      4522**DCL      4523--REDEF    4523--REDEF
DLTF.HDR_
      4521**DCL      4522--REDEF
DLTF.NAME_
      4515**DCL      4839<<ASSIGN
DLTF.TAB_
      4520**DCL      4521--REDEF
DLTF.UHL_
      4514**DCL      4515--REDEF    4515--REDEF
DLTF.V
      4523**DCL      4514--DCLINIT
DLTF.V.FSN#
      4554**DCL      4554--REDEF    4554--REDEF
DLTF.WSN_
      4520**DCL      4520--REDEF
DUMMYENT
      2808**DCL      2804--DCLINIT
ERCOD
      2757**DCL      3789--DCLINIT  4375--DCLINIT  4376--DCLINIT
ERDL IN PROCEDURE RDCK
      4837**ENTRY    4632--CALL     4644--CALL     4657--CALL     4670--CALL     4686--CALL     4706--CALL
      4719--CALL     4722--CALL
ERDLRT IN PROCEDURE RDCK
      4839**LABEL    4840--CALLALT
EVNTON
      4620**LABEL    4606--CALLALT
F$DCB.ACTPOS
      1090**DCL      1090--REDEF
F$DCB.ARS
      1065**DCL      1065--REDEF
F$DCB.ATTR
      1083**DCL      1084--REDEF
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:74   
F$DCB.BORROW
      1098**DCL      1098--REDEF    1098--REDEF    1098--REDEF
F$DCB.DCBNAME.L
      1112**DCL      1112--IMP-SIZ
F$DCB.EOMCHAR
      1069**DCL      1069--REDEF
F$DCB.FLDID
      1093**DCL      1093--REDEF
F$DCB.FORM$
      1087**DCL      1087--REDEF
F$DCB.FSECT
      1103**DCL      1103--REDEF
F$DCB.FSN
      1080**DCL      1080--REDEF    1080--REDEF    1081--REDEF
F$DCB.HEADER$
      1086**DCL      1086--REDEF
F$DCB.IXTNSIZE
      1084**DCL      1084--REDEF
F$DCB.LASTSTA$
      1074**DCL      1074--REDEF    4582<<ASSIGN
F$DCB.LVL
      1099**DCL      1099--REDEF
F$DCB.NAME.C
      1074**DCL      1074--REDEF
F$DCB.NOEOF
      1095**DCL      1095--REDEF
F$DCB.NRECS
      1085**DCL      1085--REDEF
F$DCB.NRECX
      1104**DCL      1104--REDEF
F$DCB.OHDR
      1096**DCL      1096--REDEF
F$DCB.ORG
      1079**DCL      1079--REDEF
F$DCB.PRECNO
      1102**DCL      1102--REDEF
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:75   
F$DCB.RCSZ
      1107**DCL      1107--REDEF
F$DCB.RES
      1075**DCL      1075--REDEF
F$DCB.SETSTA$
      1074**DCL      4584<<ASSIGN
F$DCB.SETX
      1087**DCL      1087--REDEF
F$DCB.TAB$
      1086**DCL      1087--REDEF    4580<<ASSIGN
F$DCB.TDA
      1101**DCL      1101--REDEF
F$DCB.WSN
      1076**DCL      1076--REDEF
FOI$CRASHGO
      2772**DCL-ENT  4811--CALL     4820--CALL
FON3
      4737**LABEL    4736--CALLALT
FON4
      4740**LABEL    4739--CALLALT
FORM
      4327**DCL      4664--ASSIGN
FPT_EVENT
      2835**DCL      4589<>CALL
FPT_EVENT.V
      2835**DCL      2835--DCLINIT
FPT_SLUGUP
      2804**DCL      4588<>CALL
FPT_SLUGUP.V
      2804**DCL      2804--DCLINIT
FPT_XCON
      2849**DCL      4590<>CALL
FPT_XCON.V
      2850**DCL      2849--DCLINIT
GBOOT
      3529**DCL      4559<>CALL     4606<>CALL
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:76   
GHGO
      4749**LABEL    4818--GOTO
GOTCMAC
      4645**LABEL    4642--GOTO     4646--CALLALT
GOTFORM
      4669**LABEL    4667--GOTO
GOTHLP
      4701**LABEL    4700--GOTO     4702--CALLALT
GOTJBS
      4633**LABEL    4630--GOTO     4634--CALLALT
GOTPRO
      4658**LABEL    4654--GOTO     4659--CALLALT
GOTUSR
      4715**LABEL    4716--GOTO
GOTWSN
      4683**LABEL    4680--GOTO     4682--CALLALT
HLP
      4300**DCL      4691--ASSIGN   4720--ASSIGN
HLPON
      4789**LABEL    4827--GOTO
I
      2734**DCL      4572<<DOINDEX  4573>>IF       4574>>ASSIGN   4575>>ASSIGN   4751<<DOINDEX  4752>>ASSIGN
      4752>>ASSIGN   4831<<ASSIGN   4833>>IF
JCE$EVENT
      2777**DCL-ENT  4771--CALL
JCE$EVNT
      2778**DCL-ENT  2835--DCLINIT
JCE$XCON
      2779**DCL-ENT  2850--DCLINIT
JCP$PROCESS
      2783**DCL-ENT  4783--CALL
JCP$ZIPCK
      2784**DCL-ENT  4802--CALL
JCS$CRACLG
      2781**DCL-ENT  4724--CALL
JCS$OPACLG
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:77   
      2782**DCL-ENT  4624--CALL
JC_CSMBF
      2746**DCL      3420--DCLINIT  3421--DCLINIT
JC_CSRD
      2748**DCL      4782>>DOWHILE  4789>>IF       4790<<ASSIGN
JC_EVQCNT
      1499**DCL      4749<<ASSIGN   4782>>DOWHILE  4783>>IF       4804>>IF
JC_FERD
      2747**DCL      4782>>DOWHILE  4785>>IF       4786<<ASSIGN
JC_FQHD$
      1528**DCL      4750<<ASSIGN
JC_JIT
      2760**DCL      4851--ASSIGN   4852--ASSIGN   4853--ASSIGN   4854--ASSIGN   4855--ASSIGN   4856--ASSIGN
      4857--ASSIGN   4858--ASSIGN   4859--ASSIGN   4860--ASSIGN   4861--ASSIGN   4862--ASSIGN   4863--ASSIGN
      4864--ASSIGN   4865--ASSIGN   4866--ASSIGN   4867--ASSIGN   4868--ASSIGN   4869--ASSIGN   4870--ASSIGN
      4871--ASSIGN   4872--ASSIGN   4873--ASSIGN   4874--ASSIGN   4875--ASSIGN   4876--ASSIGN   4877--ASSIGN
JC_MBSRD
      2749**DCL      4782>>DOWHILE  4793>>IF       4794<<ASSIGN
JC_PHASE
      1499**DCL      4770<<ASSIGN
JC_QEV
      1517**DCL      4750--ASSIGN   4752--ASSIGN
JC_QEV.LNK$
      1522**DCL      4752<<ASSIGN
JC_ROAVL
      2768**DCL      4570--ASSIGN   4578--ASSIGN
JC_ROAVL.SIZ
      2770**DCL      4578<<ASSIGN
JC_RODCB$
      2762**DCL      4568--ASSIGN   4573>>IF       4574>>ASSIGN   4575<<ASSIGN
JC_ROSEG
      2761**DCL      4567--ASSIGN
JC_SUPER.PRO
      2752**DCL      4656<<ASSIGN
JC_SUPER.UHWF
      2753**DCL      4669<<ASSIGN   4676>>IF       4684<<ASSIGN   4695>>IF       4704<<ASSIGN   4713>>IF
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:78   
      4718<<ASSIGN   4733>>IF       4734>>ASSIGN
JC_SUSR
      1499**DCL      4769<<ASSIGN
JC_SUSROK
      1499**DCL      4768<<ASSIGN
JC_TBOOT
      2750**DCL      4611<<ASSIGN   4613<<ASSIGN   4615<<ASSIGN   4620>>IF
JC_UCSST
      2765**DCL      4583--ASSIGN
JC_UCSTA
      2764**DCL      4581--ASSIGN
JC_UCTABS
      2763**DCL      4579--ASSIGN
JC_WAITING
      1499**DCL      4767<<ASSIGN
JC_ZIP
      2756**DCL      4802>>IF
JITINIT
      4845**PROC     4563--CALL
JMC_CH
      1881**DCL      1882--REDEF
JMC_EVQCNT
      1883**DCL      4782>>DOWHILE  4784>>IF       4804>>IF
JMM$INIT0
      2774**DCL-ENT  4744--CALL
JMM$PROCESS
      2775**DCL-ENT  4784--CALL
JMM_OPEN_CSCG
      3616**DCL      4761<>CALL
JMM_OPEN_CSCG.ACSVEH_
      3618**DCL      3619--REDEF
JMM_OPEN_CSCG.ALTKEYS_
      3624**DCL      3625--REDEF    3625--REDEF
JMM_OPEN_CSCG.HDR_
      3623**DCL      3624--REDEF
JMM_OPEN_CSCG.TAB_
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:79   
      3622**DCL      3623--REDEF
JMM_OPEN_CSCG.UHL_
      3616**DCL      3617--REDEF    3617--REDEF
JMM_OPEN_CSCG.V.FSN#
      3656**DCL      3656--REDEF    3656--REDEF
JMM_OPEN_CSCG.WSN_
      3622**DCL      3622--REDEF
JMR$TIME
      2776**DCL-ENT  4800--CALL
JM_RDMBS
      3457**DCL      4795<>CALL
JM_RDMBS.STATION_
      3460**DCL      3461--REDEF
JM_RDMBS.V.DVBYTE.REREAD#
      3472**DCL      3472--REDEF
JM_RDMBS.V.INDX#
      3470**DCL      3470--REDEF
JOBSTATS
      4219**DCL      3785--DCLINIT
KL_MXFE
      2767**DCL      4608<<ASSIGN
KL_NODES
      2766**DCL      4607<<ASSIGN
KL_RDHLP
      3496**DCL      4787<>CALL
KL_RDHLP.STATION_
      3499**DCL      3500--REDEF
KL_RDHLP.V.DVBYTE.REREAD#
      3511**DCL      3511--REDEF
KL_RDHLP.V.INDX#
      3509**DCL      3509--REDEF
KRDY
      4761**LABEL    4757--CALLALT
KYDN
      4797**LABEL    4791--CALLALT  4795--CALLALT
LCL
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:80   
      4420**DCL      4373--DCLINIT  4374--DCLINIT
LCLSTA
      4447**DCL      4697--ASSIGN
M$CGCTL
       389**DCL-ENT  4595--CALL
M$CLOSE
       368**DCL-ENT  4597--CALL     4629--CALL     4641--CALL     4653--CALL     4666--CALL     4679--CALL
      4699--CALL     4715--CALL     4832--CALL
M$EVENT
       423**DCL-ENT  4589--CALL
M$EXIT
       380**DCL-ENT  4562--CALL
M$MONINFO
       436**DCL-ENT  4559--CALL     4606--CALL
M$OPEN
       368**DCL-ENT  4594--CALL     4596--CALL     4628--CALL     4640--CALL     4652--CALL     4665--CALL
      4677--CALL     4696--CALL     4714--CALL     4761--CALL     4840--CALL
M$READ
       369**DCL-ENT  4678--CALL     4698--CALL     4757--CALL     4787--CALL     4791--CALL     4795--CALL
M$WAIT
       426**DCL-ENT  4806--CALL
M$WRITE
       369**DCL-ENT  4634--CALL     4646--CALL     4659--CALL     4736--CALL     4739--CALL
M$WRSYSLOG
       417**DCL-ENT  4588--CALL
M$XCON
       423**DCL-ENT  4590--CALL
MONINFO
      4606**LABEL    4597--CALLALT
M_UC
      2771**DCL      4580--ASSIGN   4582--ASSIGN   4584--ASSIGN
NOCMAC
      4639**LABEL    4640--CALLALT  4641--CALLALT
NOFORM
      4664**LABEL    4665--CALLALT  4666--CALLALT
NOHLP
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:81   
      4697**LABEL    4696--CALLALT  4699--CALLALT
NOJBS
      4624**LABEL    4628--CALLALT  4629--CALLALT
NOPRO
      4651**LABEL    4652--CALLALT  4653--CALLALT
NOUSR
      4714**LABEL    4714--CALLALT  4715--CALLALT
NOWSN
      4677**LABEL    4677--CALLALT  4679--CALLALT
NRHLP
      4697**LABEL    4698--CALLALT
NRWSN
      4677**LABEL    4678--CALLALT
OPCSAU
      2919**DCL      4594<>CALL
OPCSAU.ACSVEH_
      2921**DCL      2922--REDEF
OPCSAU.ALTKEYS_
      2927**DCL      2928--REDEF    2928--REDEF
OPCSAU.HDR_
      2926**DCL      2927--REDEF
OPCSAU.TAB_
      2925**DCL      2926--REDEF
OPCSAU.UHL_
      2919**DCL      2920--REDEF    2920--REDEF
OPCSAU.V
      2928**DCL      2919--DCLINIT
OPCSAU.V.FSN#
      2959**DCL      2959--REDEF    2959--REDEF
OPCSAU.WSN_
      2925**DCL      2925--REDEF
OPCSCG
      3301**DCL      4596<>CALL
OPCSCG.ACSVEH_
      3303**DCL      3304--REDEF
OPCSCG.ALTKEYS_
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:82   
      3309**DCL      3310--REDEF    3310--REDEF
OPCSCG.HDR_
      3308**DCL      3309--REDEF
OPCSCG.TAB_
      3307**DCL      3308--REDEF
OPCSCG.UHL_
      3301**DCL      3302--REDEF    3302--REDEF
OPCSCG.V
      3310**DCL      3301--DCLINIT
OPCSCG.V.FSN#
      3341**DCL      3341--REDEF    3341--REDEF
OPCSCG.WSN_
      3307**DCL      3307--REDEF
PRO
      4246**DCL      4651--ASSIGN
RDCK
      4829**PROC     4682--CALL     4702--CALL
RDCSCG
      3418**DCL      4757<>CALL     4791<>CALL
RDCSCG.STATION_
      3421**DCL      3422--REDEF
RDCSCG.V
      3422**DCL      3418--DCLINIT
RDCSCG.V.DVBYTE.REREAD#
      3433**DCL      3433--REDEF
RDCSCG.V.INDX#
      3431**DCL      3431--REDEF
RLCL
      4373**DCL      4678<>CALL     4698<>CALL
RLCL.KEY_
      4373**DCL      4697<<ASSIGN
RLCL.STATION_
      4376**DCL      4377--REDEF
RLCL.V
      4377**DCL      4373--DCLINIT
RLCL.V.DVBYTE.REREAD#
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:83   
      4388**DCL      4388--REDEF
RLCL.V.INDX#
      4386**DCL      4386--REDEF
RO$
      2733**DCL      4567<<ASSIGN   4568>>ASSIGN   4569>>ASSIGN   4570>>ASSIGN   4571>>ASSIGN   4572>>DOINDEX
      4574>>ASSIGN   4578>>ASSIGN   4579>>ASSIGN   4581>>ASSIGN   4583>>ASSIGN
RTN IN PROCEDURE RDCK
      4833**LABEL    4832--CALLALT
SC2
      4805**LABEL    4594--CALLALT  4595--CALLALT  4596--CALLALT  4761--CALLALT
SC4
      4805**LABEL    4787--CALLALT
SYS
      3233**DCL      3789--DCLINIT
TLFT
      2740**DCL      3219--DCLINIT  4798>>IF       4799<<ASSIGN   4803>>ASSIGN
TPTR
      2735**DCL      2739--REDEF
TPTR.OFFSET
      2736**DCL      4568<<ASSIGN   4570<<ASSIGN   4574<<ASSIGN   4579<<ASSIGN   4581<<ASSIGN   4583<<ASSIGN
TPTR$
      2739**DCL      4569>>ASSIGN   4571>>ASSIGN   4575>>ASSIGN   4580>>ASSIGN   4582>>ASSIGN   4584>>ASSIGN
TSTF
      3784**DCL      4628<>CALL     4640<>CALL     4652<>CALL     4665<>CALL     4677<>CALL     4696<>CALL
      4714<>CALL
TSTF.ACSVEH_
      3786**DCL      3787--REDEF
TSTF.ALTKEYS_
      3792**DCL      3793--REDEF    3793--REDEF
TSTF.HDR_
      3791**DCL      3792--REDEF
TSTF.NAME_
      3785**DCL      4639<<ASSIGN   4651<<ASSIGN   4664<<ASSIGN   4675<<ASSIGN   4691<<ASSIGN   4711<<ASSIGN
      4720<<ASSIGN   4839>>ASSIGN
TSTF.TAB_
      3790**DCL      3791--REDEF
PL6.E3A0      #001=JCS$SLUG File=JCS$SLUG.:E05TSI                                TUE 07/29/97 23:18 Page:84   
TSTF.UHL_
      3784**DCL      3785--REDEF    3785--REDEF
TSTF.V
      3793**DCL      3784--DCLINIT
TSTF.V.FSN#
      3824**DCL      3824--REDEF    3824--REDEF
TSTF.WSN_
      3790**DCL      3790--REDEF
USERS
      4354**DCL      4711--ASSIGN
WAITMIN
      3219**DCL      4806<>CALL
WAITMIN.V
      3220**DCL      3219--DCLINIT
WAITMIN.V.UNITS#
      3220**DCL      4803<<ASSIGN
WBFL
      3677**DCL      4634<>CALL     4646<>CALL     4659<>CALL     4736<>CALL     4739<>CALL
WBFL.BUF_
      3677**DCL      4737<<ASSIGN
WBFL.STATION_
      3679**DCL      3679--REDEF
WBFL.V
      3680**DCL      3677--DCLINIT
WBFL.V.DVBYTE.VFC#
      3686**DCL      3686--REDEF
WSN
      4273**DCL      4675--ASSIGN
WSTA
      3703**DCL      3679--DCLINIT
WSTA.MSGIDXT
      3713**DCL      3716--REDEF
WSTA.STATION#
      3707**DCL      4738<<ASSIGN

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:85   
      502        1        /*T***********************************************************/
      503        2        /*T*                                                         */
      504        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      505        4        /*T*                                                         */
      506        5        /*T***********************************************************/
      507        6        JCS$ACLGM: PROC;
      508        7        %INCLUDE CP_6;
      509       88        %INCLUDE CP_6_SUBS;
      510      628        %INCLUDE F$DCB;
      511      677        %INCLUDE JC_SCODE_C;
      512      693        %INCLUDE OC_MESSHD_C;
      513      746        %INCLUDE OC_SUBS_C;
      514     1477        %INCLUDE FM$MACROS;
      515     1852        /**/
      516     1853        %SUB F_JC='1203'O;
      517     1854        %SUB M_S='23'O;
      518     1855        /**/
      519     1856    1   DCL M$CSCG DCB;
      520     1857    1   DCL M$ACCTLG DCB;
      521     1858    1   DCL JC_ACLGF UBIN WORD STATIC SYMDEF INIT(0);
      522     1859    1   DCL JC_PHASE UBIN SYMREF;
      523     1860    1   DCL JC_CSMBF CHAR(300) SYMREF;
      524     1861    1   DCL 1 AKM REDEF JC_CSMBF,
      525     1862    1         2 KIN# UBIN(18) UNAL,
      526     1863    1         2 CADDR BIT(18) UNAL,
      527     1864    1         2 NAM,
      528     1865    1           3 CNT UBIN BYTE UNAL,
      529     1866    1           3 TXT CHAR(31) UNAL,
      530     1867    1         2 * CHAR(264) UNAL;
      531     1868        /**/
      532     1869        /**/
      533     1870        %OC_MESSHD_W (NAME=ALGM,STCLASS=STATIC,MSG=OWALG_MSG#,NPARMS=1,ATR=M_SYS);
      534     1883    1         2 NCNT UBIN BYTE UNAL INIT(1),
      535     1884    1         2 NAME CHAR(31),
      536     1885    1         2 FLG REDEF NAME,
      537     1886    1           3 ACLGF UBIN BYTE UNAL,
      538     1887    1           3 * CHAR(30);
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:86   
      539     1888    1   DCL FIT_BUF(0:1023) UBIN STATIC INIT(0*0);
      540     1889    1   DCL FIT$ PTR;
      541     1890    1   DCL CODE UBIN;
      542     1891              %FPT_WRITE (FPTN=WALGM,STCLASS=CONSTANT,DCB=M$CSCG,BUF=ALGM);
      543     1922        %FPT_OPEN (FPTN=OPACCT,STCLASS=STATIC,DCB=M$ACCTLG,NAME=ACCTLG,
      544     1923                   ACCT=SYS,ASN=FILE,ACS=JRNL,CTG=YES,EXIST=OLDFILE,
      545     1924                   FUN=CREATE,ORG=CONSEC,ACCESS=AXES,ACSVEH=AXVH,
      546     1925                   IXTNSIZE=10,XTNSIZE=10,FPARAM=FIT_BUF);
      547     2034        %FPT_OPEN (FPTN=UPAC,STCLASS=CONSTANT,DCB=M$ACCTLG,NAME=ACCTLG,ACCT=SYS,
      548     2035                   FUN=UPDATE,ASN=FILE,ACS=SEQUEN);
      549     2144        %FPT_CLOSE (FPTN=RNAC,STCLASS=CONSTANT,DCB=M$ACCTLG,CHGATT=YES,NAME=RCVRAC);
      550     2186        %FPT_CLOSE (FPTN=RNALG,STCLASS=CONSTANT,DCB=M$ACCTLG,CHGATT=YES,NAME="AKM.NAM");
      551     2228        %FPT_CLOSE (FPTN=CLACG,STCLASS=CONSTANT,DCB=M$ACCTLG,DISP=SAVE);
      552     2270        %VLP_ATTR (FPTN=AXES,STCLASS=CONSTANT);
      553     2284        %VLP_ACCESS (ACCT='?',EXEC=YES,LAST=";");
      554     2301        %VLP_ATTR (FPTN=AXVH,STCLASS=CONSTANT);
      555     2315        %VLP_ACSVEH (VEHICLE='TPCP',WNEW=YES,LAST=",");
      556     2332        %VLP_ACSVEH (VEHICLE='IBEX',WNEW=YES,LAST=";");
      557     2349        %VLP_NAME (FPTN=ACCTLG,STCLASS=CONSTANT,NAME=':ACCTLG',LEN=7);
      558     2376        %VLP_ACCT (FPTN=SYS,STCLASS=CONSTANT,ACCT=':SYS');
      559     2389        %VLP_NAME (FPTN=RCVRAC,STCLASS=CONSTANT,NAME='RCVRACCTLG',LEN=11);
      560     2416        /**/
      561     2417        %FM$FIT;
      562     2420        /**/
      563     2421    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
      564     2422    1   DCL FOI$CRASHGO ENTRY(3) ALTRET;
      565     2423        %EJECT;
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:87   
      566     2424    1         ALGM.FLG.ACLGF=JC_ACLGF;
      567     2425    1   WRTIT:;
      568     2426    1         CALL M$WRITE (WALGM) ALTRET (RET);
      569     2427    1   RET:  ;
      570     2428    1         RETURN;
      571     2429        %EJECT;
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:88   
      572     2430    1   JCS$OPACLG: ENTRY;
      573     2431        /*D* NAME:        JCS$OPACLG
      574     2432             PURPOSE:     To initially M$OPEN :ACCTLG journal file
      575     2433        */
      576     2434        /**/
      577     2435    1         CALL M$OPEN (OPACCT) ALTRET (TRYRNM);
      578     2436    1         FIT$ = ADDR(FIT_BUF);
      579     2437    1         CODE = 10;  /* yes, but is there an equ */
      580     2438    2         CALL XSF$LOCCODE(FIT$,CODE) WHENRETURN DO;
      581     2439    2           IF ADDR(FIT_BUF)->FM$FIT.CODES.NDW(CODE) = 0 THEN
              2439                    /* no access controls on :acctlg*/
      582     2440    2             CODE = 99;                       /* close it and try to reopen right*/
      583     2441    2         END;
      584     2442    2           WHENALTRETURN DO;
      585     2443    2           CODE = 99;  /* altrets when specified doesn't exist */
      586     2444    2         END;
      587     2445    1         IF DCBADDR(DCBNUM(M$ACCTLG))->F$DCB.DESC.BAD
      588     2446    1           OR CODE = 99
      589     2447    2           THEN DO;
      590     2448    2           CALL M$CLOSE (CLACG) ALTRET(SC1);
      591     2449    2           GOTO TRYRNM;
      592     2450    2         END;
      593     2451    1         IF JC_PHASE = 0
      594     2452    1           THEN
      595     2453    1           CALL M$CLOSE (CLACG) ALTRET(SC1);
      596     2454    1         RETURN;
      597     2455    1   TRYRNM: JC_ACLGF=1;
      598     2456    1         CALL M$OPEN (UPAC) ALTRET (TRYNEWF);
      599     2457    1         CALL M$CLOSE (RNAC) ALTRET (TRYNEWF);
      600     2458    1         JC_ACLGF=3;
      601     2459        /**/
      602     2460        /*D* NAME:        JCS$CRACLG
      603     2461             PURPOSE:     To CREATE a new copy of :ACCTLG destroying the old one.
      604     2462        */
      605     2463    1   JCS$CRACLG: ENTRY;
      606     2464        /**/
      607     2465    1   TRYNEWF: OPACCT.V.EXIST#=%NEWFILE#;
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:89   
      608     2466    1         CALL M$OPEN (OPACCT) ALTRET (SC1);
      609     2467    1         IF JC_PHASE = 0
      610     2468    1           THEN
      611     2469    1           CALL M$CLOSE (CLACG) ALTRET (SC1);
      612     2470    1         IF JC_ACLGF=0 THEN RETURN; /* Called as JCS$CRACLG */
      613     2471    1         JC_ACLGF=JC_ACLGF+1;
      614     2472    1         CALL JCS$ACLGM;
      615     2473    1         RETURN;
      616     2474    1   JCS$CLACLG: ENTRY;
      617     2475        /**/
      618     2476    1         ALGM.NCNT=AKM.NAM.CNT;
      619     2477    1         ALGM.NAME=AKM.NAM.TXT;
      620     2478    1         CALL M$CLOSE (RNALG) ALTRET (NOCLS);
      621     2479    1         ALGM.MSG#=CLALG_MSG#;
      622     2480    1         ALGM.CADDR=M_SYS;
      623     2481    1         GOTO WRTIT;
      624     2482    1   NOCLS:;
      625     2483    1         IF DCBADDR(DCBNUM(M$ACCTLG))->F$DCB.FCD='0'B
      626     2484    2           THEN DO; /* :ACCTLG is irrecoverably damaged...overwrite it */
      627     2485    2           ALGM.MSG# = OWALG_MSG#;
      628     2486    2           ALGM.NCNT = 1;
      629     2487    2           ALGM.FLG.ACLGF = 0;
      630     2488    2           ALGM.CADDR = M_SYS;
      631     2489    2           CALL JCS$CRACLG;
      632     2490    2         END;
      633     2491    2           ELSE DO;
      634     2492    2           ALGM.MSG# = NCALG_MSG#;
      635     2493    2           ALGM.CADDR = AKM.CADDR;
      636     2494    2           GOTO WRTIT;
      637     2495    2         END;
      638     2496    1         RETURN;
      639     2497    1   SC1:  CALL FOI$CRASHGO (%S$NOPACCT,F_JC,M_S);
      640     2498        /*S*  SCREECH_CODE:  JCS-S$NOPACCT
      641     2499              TYPE:          Screech
      642     2500              MESSAGE:       SLUG could not open :ACCTLG.:SYS
      643     2501              REMARKS:       Before any other users can be run, SLUG must open
      644     2502                             the accounting journal :ACCTLG.:SYS.  This screech
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:90   
      645     2503                             occurs when this open fails, with the ALTRET code
      646     2504                             printed as JIT.ERR.                                     */
      647     2505    1         RETURN;
      648     2506    1   END JCS$ACLGM;

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:91   
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCS$ACLGM.

   Procedure JCS$ACLGM requires 141 words for executable code.
   Procedure JCS$ACLGM requires 8 words of local(AUTO) storage.

    No errors detected in file JCS$SLUG.:E05TSI    .

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:92   

 Object Unit name= JCS$ACLGM                                  File name= JCS$SLUG.:E05TOU
 UTS= JUL 29 '97 23:21:24.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CSCG
    2   DCB   even  none     0      0  M$ACCTLG
    3   Data  even  none  1096   2110  JCS$ACLGM
    4  RoData even  UTS    176    260  JCS$ACLGM
    5   Proc  even  none   141    215  JCS$ACLGM
    6  RoData even  none     9     11  JCS$ACLGM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        0  JCS$ACLGM
     5     12                  yes      Std        0  JCS$OPACLG
     5    110                  yes      Std        0  JCS$CRACLG
     5    137                  yes      Std        0  JCS$CLACLG

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    3      0  JC_ACLGF
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:93   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 FOI$CRASHGO
 yes     yes           Std       2 XSF$LOCCODE
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$CSCG                                M$ACCTLG
     JC_PHASE                              JC_CSMBF                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:94   


      502        1        /*T***********************************************************/
      503        2        /*T*                                                         */
      504        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      505        4        /*T*                                                         */
      506        5        /*T***********************************************************/
      507        6        JCS$ACLGM: PROC;

      6  5 000000   000000 700200 xent  JCS$ACLGM    TSX0  ! X66_AUTO_0
         5 000001   000010 000000                    ZERO    8,0

      508        7        %INCLUDE CP_6;
      509       88        %INCLUDE CP_6_SUBS;
      510      628        %INCLUDE F$DCB;
      511      677        %INCLUDE JC_SCODE_C;
      512      693        %INCLUDE OC_MESSHD_C;
      513      746        %INCLUDE OC_SUBS_C;
      514     1477        %INCLUDE FM$MACROS;
      515     1852        /**/
      516     1853        %SUB F_JC='1203'O;
      517     1854        %SUB M_S='23'O;
      518     1855        /**/
      519     1856    1   DCL M$CSCG DCB;
      520     1857    1   DCL M$ACCTLG DCB;
      521     1858    1   DCL JC_ACLGF UBIN WORD STATIC SYMDEF INIT(0);
      522     1859    1   DCL JC_PHASE UBIN SYMREF;
      523     1860    1   DCL JC_CSMBF CHAR(300) SYMREF;
      524     1861    1   DCL 1 AKM REDEF JC_CSMBF,
      525     1862    1         2 KIN# UBIN(18) UNAL,
      526     1863    1         2 CADDR BIT(18) UNAL,
      527     1864    1         2 NAM,
      528     1865    1           3 CNT UBIN BYTE UNAL,
      529     1866    1           3 TXT CHAR(31) UNAL,
      530     1867    1         2 * CHAR(264) UNAL;
      531     1868        /**/
      532     1869        /**/
      533     1870        %OC_MESSHD_W (NAME=ALGM,STCLASS=STATIC,MSG=OWALG_MSG#,NPARMS=1,ATR=M_SYS);
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:95   
      534     1883    1         2 NCNT UBIN BYTE UNAL INIT(1),
      535     1884    1         2 NAME CHAR(31),
      536     1885    1         2 FLG REDEF NAME,
      537     1886    1           3 ACLGF UBIN BYTE UNAL,
      538     1887    1           3 * CHAR(30);
      539     1888    1   DCL FIT_BUF(0:1023) UBIN STATIC INIT(0*0);
      540     1889    1   DCL FIT$ PTR;
      541     1890    1   DCL CODE UBIN;
      542     1891              %FPT_WRITE (FPTN=WALGM,STCLASS=CONSTANT,DCB=M$CSCG,BUF=ALGM);
      543     1922        %FPT_OPEN (FPTN=OPACCT,STCLASS=STATIC,DCB=M$ACCTLG,NAME=ACCTLG,
      544     1923                   ACCT=SYS,ASN=FILE,ACS=JRNL,CTG=YES,EXIST=OLDFILE,
      545     1924                   FUN=CREATE,ORG=CONSEC,ACCESS=AXES,ACSVEH=AXVH,
      546     1925                   IXTNSIZE=10,XTNSIZE=10,FPARAM=FIT_BUF);
      547     2034        %FPT_OPEN (FPTN=UPAC,STCLASS=CONSTANT,DCB=M$ACCTLG,NAME=ACCTLG,ACCT=SYS,
      548     2035                   FUN=UPDATE,ASN=FILE,ACS=SEQUEN);
      549     2144        %FPT_CLOSE (FPTN=RNAC,STCLASS=CONSTANT,DCB=M$ACCTLG,CHGATT=YES,NAME=RCVRAC);
      550     2186        %FPT_CLOSE (FPTN=RNALG,STCLASS=CONSTANT,DCB=M$ACCTLG,CHGATT=YES,NAME="AKM.NAM");
      551     2228        %FPT_CLOSE (FPTN=CLACG,STCLASS=CONSTANT,DCB=M$ACCTLG,DISP=SAVE);
      552     2270        %VLP_ATTR (FPTN=AXES,STCLASS=CONSTANT);
      553     2284        %VLP_ACCESS (ACCT='?',EXEC=YES,LAST=";");
      554     2301        %VLP_ATTR (FPTN=AXVH,STCLASS=CONSTANT);
      555     2315        %VLP_ACSVEH (VEHICLE='TPCP',WNEW=YES,LAST=",");
      556     2332        %VLP_ACSVEH (VEHICLE='IBEX',WNEW=YES,LAST=";");
      557     2349        %VLP_NAME (FPTN=ACCTLG,STCLASS=CONSTANT,NAME=':ACCTLG',LEN=7);
      558     2376        %VLP_ACCT (FPTN=SYS,STCLASS=CONSTANT,ACCT=':SYS');
      559     2389        %VLP_NAME (FPTN=RCVRAC,STCLASS=CONSTANT,NAME='RCVRACCTLG',LEN=11);
      560     2416        /**/
      561     2417        %FM$FIT;
      562     2420        /**/
      563     2421    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
      564     2422    1   DCL FOI$CRASHGO ENTRY(3) ALTRET;
      565     2423        %EJECT;
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:96   
      566     2424    1         ALGM.FLG.ACLGF=JC_ACLGF;

   2424  5 000002   000000 236000 3                  LDQ     JC_ACLGF
         5 000003   000022 736000                    QLS     18
         5 000004   000006 552020 3                  STBQ    ALGM+5,'20'O

   2424  5 000005                       WRTIT        null
      567     2425    1   WRTIT:;
      568     2426    1         CALL M$WRITE (WALGM) ALTRET (RET);

   2426  5 000005   000000 630400 4                  EPPR0   WALGM
         5 000006   440001 713400                    CLIMB   alt,write
         5 000007   401400 401760                    pmme    nvectors=4
         5 000010   000011 702000 5                  TSX2    RET

   2424  5 000011                       RET          null
      569     2427    1   RET:  ;
      570     2428    1         RETURN;

   2428  5 000011   000000 702200 xent               TSX2  ! X66_ARET

      571     2429        %EJECT;
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:97   
      572     2430    1   JCS$OPACLG: ENTRY;

   2430  5 000012   000000 700200 xent  JCS$OPACLG   TSX0  ! X66_AUTO_0
         5 000013   000010 000000                    ZERO    8,0

      573     2431        /*D* NAME:        JCS$OPACLG
      574     2432             PURPOSE:     To initially M$OPEN :ACCTLG journal file
      575     2433        */
      576     2434        /**/
      577     2435    1         CALL M$OPEN (OPACCT) ALTRET (TRYRNM);

   2435  5 000014   002016 630400 3                  EPPR0   OPACCT
         5 000015   450000 713400                    CLIMB   alt,open
         5 000016   410400 401760                    pmme    nvectors=18
         5 000017   000073 702000 5                  TSX2    TRYRNM

      578     2436    1         FIT$ = ADDR(FIT_BUF);

   2436  5 000020   000000 236000 6                  LDQ     0
         5 000021   200003 756100                    STQ     FIT$,,AUTO

      579     2437    1         CODE = 10;  /* yes, but is there an equ */

   2437  5 000022   000012 235007                    LDA     10,DL
         5 000023   200004 755100                    STA     CODE,,AUTO

      580     2438    2         CALL XSF$LOCCODE(FIT$,CODE) WHENRETURN DO;

   2438  5 000024   200004 630500                    EPPR0   CODE,,AUTO
         5 000025   200007 450500                    STP0    CODE+3,,AUTO
         5 000026   200003 631500                    EPPR1   FIT$,,AUTO
         5 000027   200006 451500                    STP1    CODE+2,,AUTO
         5 000030   200006 630500                    EPPR0   CODE+2,,AUTO
         5 000031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000032   000000 701000 xent               TSX1    XSF$LOCCODE
         5 000033   000043 702000 5                  TSX2    s:2443

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:98   
      581     2439    2           IF ADDR(FIT_BUF)->FM$FIT.CODES.NDW(CODE) = 0 THEN
              2439                    /* no access controls on :acctlg*/

   2439  5 000034   200004 720100                    LXL0    CODE,,AUTO
         5 000035   000016 236010 3                  LDQ     FIT_BUF,X0
         5 000036   000001 316000 6                  CANQ    1
         5 000037   000042 601000 5                  TNZ     s:2441

      582     2440    2             CODE = 99;                       /* close it and try to reopen right*/

   2440  5 000040   000143 235007                    LDA     99,DL
         5 000041   200004 755100                    STA     CODE,,AUTO

      583     2441    2         END;

   2441  5 000042   000045 710000 5                  TRA     s:2445

      584     2442    2           WHENALTRETURN DO;

      585     2443    2           CODE = 99;  /* altrets when specified doesn't exist */

   2443  5 000043   000143 235007                    LDA     99,DL
         5 000044   200004 755100                    STA     CODE,,AUTO

      586     2444    2         END;

      587     2445    1         IF DCBADDR(DCBNUM(M$ACCTLG))->F$DCB.DESC.BAD

   2445  5 000045   000000 236007 xsym               LDQ     M$ACCTLG,DL
         5 000046   000002 470400 6                  LDP0    2
         5 000047   000000 471500                    LDP1    0,,PR0
         5 000050   100000 473506                    LDP3    0,QL,PR1
         5 000051   300005 236100                    LDQ     5,,PR3
         5 000052   020000 316007                    CANQ    8192,DL
         5 000053   000057 601000 5                  TNZ     s:2448
         5 000054   200004 235100                    LDA     CODE,,AUTO
         5 000055   000143 115007                    CMPA    99,DL
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:99   
         5 000056   000064 601000 5                  TNZ     s:2451

      588     2446    1           OR CODE = 99
      589     2447    2           THEN DO;

      590     2448    2           CALL M$CLOSE (CLACG) ALTRET(SC1);

   2448  5 000057   000202 630400 4                  EPPR0   CLACG
         5 000060   450001 713400                    CLIMB   alt,close
         5 000061   406000 401760                    pmme    nvectors=13
         5 000062   000210 702000 5                  TSX2    SC1

      591     2449    2           GOTO TRYRNM;

   2449  5 000063   000073 710000 5                  TRA     TRYRNM

      592     2450    2         END;
      593     2451    1         IF JC_PHASE = 0

   2451  5 000064   000000 236000 xsym               LDQ     JC_PHASE
         5 000065   000072 601000 5                  TNZ     s:2454

      594     2452    1           THEN
      595     2453    1           CALL M$CLOSE (CLACG) ALTRET(SC1);

   2453  5 000066   000202 630400 4                  EPPR0   CLACG
         5 000067   450001 713400                    CLIMB   alt,close
         5 000070   406000 401760                    pmme    nvectors=13
         5 000071   000210 702000 5                  TSX2    SC1

      596     2454    1         RETURN;

   2454  5 000072   000000 702200 xent               TSX2  ! X66_ARET

      597     2455    1   TRYRNM: JC_ACLGF=1;

   2455  5 000073   000001 235007       TRYRNM       LDA     1,DL
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:100  
         5 000074   000000 755000 3                  STA     JC_ACLGF

      598     2456    1         CALL M$OPEN (UPAC) ALTRET (TRYNEWF);

   2456  5 000075   000014 630400 4                  EPPR0   UPAC
         5 000076   450000 713400                    CLIMB   alt,open
         5 000077   410400 401760                    pmme    nvectors=18
         5 000100   000112 702000 5                  TSX2    TRYNEWF

      599     2457    1         CALL M$CLOSE (RNAC) ALTRET (TRYNEWF);

   2457  5 000101   000106 630400 4                  EPPR0   RNAC
         5 000102   450001 713400                    CLIMB   alt,close
         5 000103   406000 401760                    pmme    nvectors=13
         5 000104   000112 702000 5                  TSX2    TRYNEWF

      600     2458    1         JC_ACLGF=3;

   2458  5 000105   000003 235007                    LDA     3,DL
         5 000106   000000 755000 3                  STA     JC_ACLGF
         5 000107   000112 710000 5                  TRA     TRYNEWF

      601     2459        /**/
      602     2460        /*D* NAME:        JCS$CRACLG
      603     2461             PURPOSE:     To CREATE a new copy of :ACCTLG destroying the old one.
      604     2462        */
      605     2463    1   JCS$CRACLG: ENTRY;

   2463  5 000110   000000 700200 xent  JCS$CRACLG   TSX0  ! X66_AUTO_0
         5 000111   000010 000000                    ZERO    8,0

      606     2464        /**/
      607     2465    1   TRYNEWF: OPACCT.V.EXIST#=%NEWFILE#;

   2465  5 000112   000600 236007       TRYNEWF      LDQ     384,DL
         5 000113   002062 256000 3                  ORSQ    OPACCT+36

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:101  
      608     2466    1         CALL M$OPEN (OPACCT) ALTRET (SC1);

   2466  5 000114   002016 630400 3                  EPPR0   OPACCT
         5 000115   450000 713400                    CLIMB   alt,open
         5 000116   410400 401760                    pmme    nvectors=18
         5 000117   000210 702000 5                  TSX2    SC1

      609     2467    1         IF JC_PHASE = 0

   2467  5 000120   000000 235000 xsym               LDA     JC_PHASE
         5 000121   000126 601000 5                  TNZ     s:2470

      610     2468    1           THEN
      611     2469    1           CALL M$CLOSE (CLACG) ALTRET (SC1);

   2469  5 000122   000202 630400 4                  EPPR0   CLACG
         5 000123   450001 713400                    CLIMB   alt,close
         5 000124   406000 401760                    pmme    nvectors=13
         5 000125   000210 702000 5                  TSX2    SC1

      612     2470    1         IF JC_ACLGF=0 THEN RETURN; /* Called as JCS$CRACLG */

   2470  5 000126   000000 235000 3                  LDA     JC_ACLGF
         5 000127   000131 601000 5                  TNZ     s:2471

   2470  5 000130   000000 702200 xent               TSX2  ! X66_ARET

      613     2471    1         JC_ACLGF=JC_ACLGF+1;

   2471  5 000131   000001 035007                    ADLA    1,DL
         5 000132   000000 755000 3                  STA     JC_ACLGF

      614     2472    1         CALL JCS$ACLGM;

   2472  5 000133   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000134   000000 701000 5                  TSX1    s:6
         5 000135   000000 011000                    NOP     0
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:102  

      615     2473    1         RETURN;

   2473  5 000136   000000 702200 xent               TSX2  ! X66_ARET

      616     2474    1   JCS$CLACLG: ENTRY;

   2474  5 000137   000000 700200 xent  JCS$CLACLG   TSX0  ! X66_AUTO_0
         5 000140   000010 000000                    ZERO    8,0

      617     2475        /**/
      618     2476    1         ALGM.NCNT=AKM.NAM.CNT;

   2476  5 000141   000001 236000 xsym               LDQ     JC_CSMBF+1
         5 000142   000006 552040 3                  STBQ    ALGM+5,'40'O

      619     2477    1         ALGM.NAME=AKM.NAM.TXT;

   2477  5 000143   040000 100400                    MLR     fill='040'O
         5 000144   000001 200037 xsym               ADSC9   JC_CSMBF+1               cn=1,n=31
         5 000145   000006 200037 3                  ADSC9   ALGM+5                   cn=1,n=31

      620     2478    1         CALL M$CLOSE (RNALG) ALTRET (NOCLS);

   2478  5 000146   000144 630400 4                  EPPR0   RNALG
         5 000147   450001 713400                    CLIMB   alt,close
         5 000150   406000 401760                    pmme    nvectors=13
         5 000151   000157 702000 5                  TSX2    NOCLS

      621     2479    1         ALGM.MSG#=CLALG_MSG#;

   2479  5 000152   000133 220003                    LDX0    91,DU
         5 000153   000001 440000 3                  SXL0    ALGM

      622     2480    1         ALGM.CADDR=M_SYS;

   2480  5 000154   200000 221003                    LDX1    65536,DU
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:103  
         5 000155   000001 741000 3                  STX1    ALGM

      623     2481    1         GOTO WRTIT;

   2481  5 000156   000005 710000 5                  TRA     WRTIT

   2480  5 000157                       NOCLS        null
      624     2482    1   NOCLS:;
      625     2483    1         IF DCBADDR(DCBNUM(M$ACCTLG))->F$DCB.FCD='0'B

   2483  5 000157   000000 236007 xsym               LDQ     M$ACCTLG,DL
         5 000160   000002 470400 6                  LDP0    2
         5 000161   000000 471500                    LDP1    0,,PR0
         5 000162   100000 473506                    LDP3    0,QL,PR1
         5 000163   300031 236100                    LDQ     25,,PR3
         5 000164   020000 316007                    CANQ    8192,DL
         5 000165   000202 601000 5                  TNZ     s:2492

      626     2484    2           THEN DO; /* :ACCTLG is irrecoverably damaged...overwrite it */

      627     2485    2           ALGM.MSG# = OWALG_MSG#;

   2485  5 000166   000132 220003                    LDX0    90,DU
         5 000167   000001 440000 3                  SXL0    ALGM

      628     2486    2           ALGM.NCNT = 1;

   2486  5 000170   001000 236003                    LDQ     512,DU
         5 000171   000006 552040 3                  STBQ    ALGM+5,'40'O

      629     2487    2           ALGM.FLG.ACLGF = 0;

   2487  5 000172   000000 236003                    LDQ     0,DU
         5 000173   000006 552020 3                  STBQ    ALGM+5,'20'O

      630     2488    2           ALGM.CADDR = M_SYS;

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:104  
   2488  5 000174   200000 221003                    LDX1    65536,DU
         5 000175   000001 741000 3                  STX1    ALGM

      631     2489    2           CALL JCS$CRACLG;

   2489  5 000176   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000177   000110 701000 5                  TSX1    s:2463
         5 000200   000000 011000                    NOP     0

      632     2490    2         END;

   2490  5 000201   000207 710000 5                  TRA     s:2496

      633     2491    2           ELSE DO;

      634     2492    2           ALGM.MSG# = NCALG_MSG#;

   2492  5 000202   000134 220003                    LDX0    92,DU
         5 000203   000001 440000 3                  SXL0    ALGM

      635     2493    2           ALGM.CADDR = AKM.CADDR;

   2493  5 000204   000000 721000 xsym               LXL1    JC_CSMBF
         5 000205   000001 741000 3                  STX1    ALGM

      636     2494    2           GOTO WRTIT;

   2494  5 000206   000005 710000 5                  TRA     WRTIT

      637     2495    2         END;
      638     2496    1         RETURN;

   2496  5 000207   000000 702200 xent               TSX2  ! X66_ARET

      639     2497    1   SC1:  CALL FOI$CRASHGO (%S$NOPACCT,F_JC,M_S);

   2497  5 000210   000006 630400 6     SC1          EPPR0   6
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:105  
         5 000211   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000212   000000 701000 xent               TSX1    FOI$CRASHGO
         5 000213   000000 011000                    NOP     0

      640     2498        /*S*  SCREECH_CODE:  JCS-S$NOPACCT
      641     2499              TYPE:          Screech
      642     2500              MESSAGE:       SLUG could not open :ACCTLG.:SYS
      643     2501              REMARKS:       Before any other users can be run, SLUG must open
      644     2502                             the accounting journal :ACCTLG.:SYS.  This screech
      645     2503                             occurs when this open fails, with the ALTRET code
      646     2504                             printed as JIT.ERR.                                     */
      647     2505    1         RETURN;

   2505  5 000214   000000 702200 xent               TSX2  ! X66_ARET
      648     2506    1   END JCS$ACLGM;

PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:106  
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JCS$ACLGM.
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:107  

 **** Variables and constants ****

  ****  Section 003  Data  JCS$ACLGM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c STRC(468)   r     1 ALGM                      16-0-0/w UBIN        r     1 FIT_BUF(0:1023)
     0-0-0/w UBIN        r     1 JC_ACLGF                2016-0-0/d STRC(2088)  r     1 OPACCT

  ****  Section 004 RoData JCS$ACLGM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   251-0-0/c STRC(72)    r     1 ACCTLG                   240-0-0/w STRC(126)   r     1 AXES
   244-0-0/w STRC(162)   r     1 AXVH                     202-0-0/d STRC(1080)  r     1 CLACG
   255-0-0/c STRC(108)   r     1 RCVRAC                   106-0-0/d STRC(1080)  r     1 RNAC
   144-0-0/d STRC(1080)  r     1 RNALG                    253-0-0/c STRC(72)    r     1 SYS
    14-0-0/d STRC(2088)  r     1 UPAC                       0-0-0/d STRC(432)   r     1 WALGM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w UBIN        r     1 CODE                       3-0-0/w PTR         r     1 FIT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(2700)  r     1 AKM                        0-0-0/c CHAR(300)   r     1 JC_CSMBF
     0-0-0/w UBIN        r     1 JC_PHASE

  ****  BASED and DCB variables  ****
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:108  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(1116)  r     1 FM$FIT
     0-0-0N  NULL        r     1 M$ACCTLG                   0-0-0N  NULL        r     1 M$CSCG


   Procedure JCS$ACLGM requires 141 words for executable code.
   Procedure JCS$ACLGM requires 8 words of local(AUTO) storage.

    No errors detected in file JCS$SLUG.:E05TSI    .
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:109  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:110  
          MINI XREF LISTING

ACCTLG
      2374**DCL      1991--DCLINIT  2101--DCLINIT
AKM.CADDR
      1863**DCL      2493>>ASSIGN
AKM.NAM
      1864**DCL      2211--DCLINIT
AKM.NAM.CNT
      1865**DCL      2476>>ASSIGN
AKM.NAM.TXT
      1866**DCL      2477>>ASSIGN
ALGM
      1871**DCL      1909--DCLINIT  1910--DCLINIT
ALGM.CADDR
      1872**DCL      2480<<ASSIGN   2488<<ASSIGN   2493<<ASSIGN
ALGM.FLAGS
      1878**DCL      1879--REDEF
ALGM.FLG.ACLGF
      1886**DCL      2424<<ASSIGN   2487<<ASSIGN
ALGM.MSG#
      1873**DCL      2479<<ASSIGN   2485<<ASSIGN   2492<<ASSIGN
ALGM.MSGID
      1874**DCL      1875--REDEF
ALGM.NAME
      1884**DCL      1885--REDEF    2477<<ASSIGN
ALGM.NCNT
      1883**DCL      2476<<ASSIGN   2486<<ASSIGN
AXES
      2281**DCL      1992--DCLINIT
AXES.Q
      2282**DCL      2281--DCLINIT
AXVH
      2312**DCL      1993--DCLINIT
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:111  
AXVH.Q
      2313**DCL      2312--DCLINIT
CLACG
      2251**DCL      2448<>CALL     2453<>CALL     2469<>CALL
CLACG.SN_
      2251**DCL      2251--REDEF
CLACG.UTL_
      2252**DCL      2252--REDEF
CLACG.V
      2256**DCL      2251--DCLINIT
CLACG.V.EXPIRE#
      2266**DCL      2266--REDEF
CLACG.V.TYPE#
      2264**DCL      2264--REDEF
CLACG.V.XTNSIZE#
      2261**DCL      2261--REDEF    2263--REDEF
CODE
      1890**DCL      2437<<ASSIGN   2438<>CALL     2439>>IF       2440<<ASSIGN   2443<<ASSIGN   2445>>IF
F$DCB.ACTPOS
       654**DCL       654--REDEF
F$DCB.ARS
       629**DCL       629--REDEF
F$DCB.ATTR
       647**DCL       648--REDEF
F$DCB.BORROW
       662**DCL       662--REDEF     662--REDEF     662--REDEF
F$DCB.DCBNAME.L
       676**DCL       676--IMP-SIZ
F$DCB.DESC.BAD
       637**DCL      2445>>IF
F$DCB.EOMCHAR
       633**DCL       633--REDEF
F$DCB.FCD
       642**DCL      2483>>IF
F$DCB.FLDID
       657**DCL       657--REDEF
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:112  
F$DCB.FORM$
       651**DCL       651--REDEF
F$DCB.FSECT
       667**DCL       667--REDEF
F$DCB.FSN
       644**DCL       644--REDEF     644--REDEF     645--REDEF
F$DCB.HEADER$
       650**DCL       650--REDEF
F$DCB.IXTNSIZE
       648**DCL       648--REDEF
F$DCB.LASTSTA$
       638**DCL       638--REDEF
F$DCB.LVL
       663**DCL       663--REDEF
F$DCB.NAME.C
       638**DCL       638--REDEF
F$DCB.NOEOF
       659**DCL       659--REDEF
F$DCB.NRECS
       649**DCL       649--REDEF
F$DCB.NRECX
       668**DCL       668--REDEF
F$DCB.OHDR
       660**DCL       660--REDEF
F$DCB.ORG
       643**DCL       643--REDEF
F$DCB.PRECNO
       666**DCL       666--REDEF
F$DCB.RCSZ
       671**DCL       671--REDEF
F$DCB.RES
       639**DCL       639--REDEF
F$DCB.SETX
       651**DCL       651--REDEF
F$DCB.TAB$
       650**DCL       651--REDEF
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:113  
F$DCB.TDA
       665**DCL       665--REDEF
F$DCB.WSN
       640**DCL       640--REDEF
FIT$
      1889**DCL      2436<<ASSIGN   2438<>CALL
FIT_BUF
      1888**DCL      1995--DCLINIT  2436--ASSIGN   2439--IF
FM$FIT.CODES.NDW
      2418**DCL      2439>>IF
FOI$CRASHGO
      2422**DCL-ENT  2497--CALL
JCS$ACLGM
         6**PROC     2472--CALL
JCS$CRACLG
      2463**ENTRY    2489--CALL
JC_ACLGF
      1858**DCL      2424>>ASSIGN   2455<<ASSIGN   2458<<ASSIGN   2470>>IF       2471<<ASSIGN   2471>>ASSIGN
JC_CSMBF
      1860**DCL      1861--REDEF
JC_PHASE
      1859**DCL      2451>>IF       2467>>IF
M$ACCTLG
      1857**DCL      2445--IF       2483--IF
M$CLOSE
        16**DCL-ENT  2448--CALL     2453--CALL     2457--CALL     2469--CALL     2478--CALL
M$OPEN
        16**DCL-ENT  2435--CALL     2456--CALL     2466--CALL
M$WRITE
        17**DCL-ENT  2426--CALL
NOCLS
      2480**LABEL    2478--CALLALT
OPACCT
      1990**DCL      2435<>CALL     2466<>CALL
OPACCT.ACSVEH_
      1992**DCL      1993--REDEF
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:114  
OPACCT.ALTKEYS_
      1998**DCL      1999--REDEF    1999--REDEF
OPACCT.HDR_
      1997**DCL      1998--REDEF
OPACCT.TAB_
      1996**DCL      1997--REDEF
OPACCT.UHL_
      1990**DCL      1991--REDEF    1991--REDEF
OPACCT.V
      1999**DCL      1990--DCLINIT
OPACCT.V.EXIST#
      2003**DCL      2465<<ASSIGN
OPACCT.V.FSN#
      2030**DCL      2030--REDEF    2030--REDEF
OPACCT.WSN_
      1996**DCL      1996--REDEF
RCVRAC
      2414**DCL      2169--DCLINIT
RET
      2424**LABEL    2426--CALLALT
RNAC
      2167**DCL      2457<>CALL
RNAC.SN_
      2167**DCL      2167--REDEF
RNAC.UTL_
      2168**DCL      2168--REDEF
RNAC.V
      2172**DCL      2167--DCLINIT
RNAC.V.EXPIRE#
      2182**DCL      2182--REDEF
RNAC.V.TYPE#
      2180**DCL      2180--REDEF
RNAC.V.XTNSIZE#
      2177**DCL      2177--REDEF    2179--REDEF
RNALG
      2209**DCL      2478<>CALL
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:115  
RNALG.SN_
      2209**DCL      2209--REDEF
RNALG.UTL_
      2210**DCL      2210--REDEF
RNALG.V
      2214**DCL      2209--DCLINIT
RNALG.V.EXPIRE#
      2224**DCL      2224--REDEF
RNALG.V.TYPE#
      2222**DCL      2222--REDEF
RNALG.V.XTNSIZE#
      2219**DCL      2219--REDEF    2221--REDEF
SC1
      2497**LABEL    2448--CALLALT  2453--CALLALT  2466--CALLALT  2469--CALLALT
SYS
      2387**DCL      1995--DCLINIT  2105--DCLINIT
TRYNEWF
      2465**LABEL    2456--CALLALT  2457--CALLALT
TRYRNM
      2455**LABEL    2435--CALLALT  2449--GOTO
UPAC
      2100**DCL      2456<>CALL
UPAC.ACSVEH_
      2102**DCL      2103--REDEF
UPAC.ALTKEYS_
      2108**DCL      2109--REDEF    2109--REDEF
UPAC.HDR_
      2107**DCL      2108--REDEF
UPAC.TAB_
      2106**DCL      2107--REDEF
UPAC.UHL_
      2100**DCL      2101--REDEF    2101--REDEF
UPAC.V
      2109**DCL      2100--DCLINIT
UPAC.V.FSN#
      2140**DCL      2140--REDEF    2140--REDEF
PL6.E3A0      #002=JCS$ACLGM File=JCS$SLUG.:E05TSI                               TUE 07/29/97 23:21 Page:116  
UPAC.WSN_
      2106**DCL      2106--REDEF
WALGM
      1908**DCL      2426<>CALL
WALGM.STATION_
      1910**DCL      1910--REDEF
WALGM.V
      1911**DCL      1908--DCLINIT
WALGM.V.DVBYTE.VFC#
      1917**DCL      1917--REDEF
WRTIT
      2424**LABEL    2481--GOTO     2494--GOTO
XSF$LOCCODE
      2421**DCL-ENT  2438--CALL
