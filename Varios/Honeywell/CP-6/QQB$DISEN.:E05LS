VERSION E05

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:1    
        1        1        /*M* QQB$DISEN - Perform  DISABLE  &  ENABLE  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$DISEN:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE XU_MACRO_C;
       16     3256        %INCLUDE QQ_SUBS_C;
       17     3448        %INCLUDE QQ_MACROS_C;
       18     3873        %INCLUDE QQ_DATA_R;
       19     4119        %INCLUDE Q_ERRCODE_C;
       20     4142        %INCLUDE QQ_PERR_C;
       21     4303        %PAGE(ARG="Externally defined routines");

              4320    1   /***************************************************************************
              4321    1    *                                                                         *
              4322    1    *                        Externally defined routines                      *
              4323    1    *                                                                         *
              4324    1    ***************************************************************************/

       22     4328    1   DCL QQB$SAVCMD  ENTRY;
       23     4329    1   DCL QQC$RLS_BLK ENTRY(2);
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:2    
       24     4330    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       25     4331    1   DCL QQC$CONVERT_NUM ENTRY(3);
       26     4332    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       27     4333    1   DCL QQC$BLDMSG ENTRY(1);
       28     4334    1   DCL QQC$SCREECH ENTRY;
       29     4335    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       30     4336        %PAGE(ARG="Based");

              4353    1   /***************************************************************************
              4354    1    *                                                                         *
              4355    1    *                                   Based                                 *
              4356    1    *                                                                         *
              4357    1    ***************************************************************************/

       31     4361        %TP$STATION;
       32     4434        %DISAB$INFO;
       33     4450        %PARSE$OUT(STCLASS=BASED);
       34     4495        %PARSE$SYM(STCLASS=BASED);
       35     4533        %PAGE(ARG="Static");

              4550    1   /***************************************************************************
              4551    1    *                                                                         *
              4552    1    *                                   Static                                *
              4553    1    *                                                                         *
              4554    1    ***************************************************************************/

       36     4558    1   DCL UTS UBIN WORD STATIC;
       37     4559
       38     4560        %VLP_NAME(FPTN=TEXTC_NUM, STCLASS=STATIC, NAME='123');
       39     4587        %PAGE(ARG="Auto");

              4604    1   /***************************************************************************
              4605    1    *                                                                         *
              4606    1    *                                    Auto                                 *
              4607    1    *                                                                         *
              4608    1    ***************************************************************************/

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:3    
       40     4612    1   DCL NEXT$ PTR;
       41     4613    1   DCL TAIL$ PTR;
       42     4614
       43     4615    1   DCL TYPE UBIN WORD;
       44     4616    1   DCL I SBIN WORD;
       45     4617    1   DCL FP_CNT UBIN WORD;
       46     4618    1   DCL STATION_CNT UBIN WORD;
       47     4619    1   DCL NUM UBIN WORD;
       48     4620    1   DCL SIZE UBIN WORD;
       49     4621
       50     4622    1   DCL ITEM CHAR(8);
       51     4623        %MSGBLK;
       52     4713        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:4    
              4730    1   /***************************************************************************
              4731    1    *                                                                         *
              4732    1    *                                Error codes                              *
              4733    1    *                                                                         *
              4734    1    ***************************************************************************/

       53     4738        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
       54     4745        %ERRCODE(NAME=CODE_CE, CODE#=%E$CE, FCG#=%FCG_QQ, MID#=%MID_B);
       55     4752        %ERRCODE(NAME=CODE_CDT, CODE#=%E$CDT, FCG#=%FCG_QQ, MID#=%MID_B);
       56     4759        %ERRCODE(NAME=CODE_SO, CODE#=%E$SO, FCG#=%FCG_QQ, MID#=%MID_B);
       57     4766        %ERRCODE(NAME=CODE_FPIU, CODE#=%E$FPIU, FCG#=%FCG_QQ, MID#=%MID_B);
       58     4773        /*E*       ERROR: QQB-E$CE-C
       59     4774
       60     4775                 MESSAGE: Can't ENABLE something that is not disabled
       61     4776             DESCRIPTION: An  ENABLE  command can only be used to enable
       62     4777                          an item that has been specifically disabled.
       63     4778        */
       64     4779        /*E*       ERROR: QQB-E$CDT-C
       65     4780
       66     4781                 MESSAGE: Item is already  disabled.
       67     4782             DESCRIPTION: You are not permitted to  DISABLE  the same item
       68     4783                          twice.
       69     4784        */
       70     4785        /*E*       ERROR: QQB-E$SO-C
       71     4786
       72     4787                 MESSAGE: %U1 station(s) on.
       73     4788             DESCRIPTION: For your information there are this many stations
       74     4789                          currently on of the type that you disabled.
       75     4790        */
       76     4791        /*E*       ERROR: QQB-E$FPIU-C
       77     4792
       78     4793                 MESSAGE: %U1 Forms Program(s) in use.
       79     4794             DESCRIPTION: For your infomation there are this many forms
       80     4795                          programs in use of the type that you just disabled.
       81     4796        */
       82     4797        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:5    
              4814    1   /***************************************************************************
              4815    1    *                                                                         *
              4816    1    *                                    FPTs                                 *
              4817    1    *                                                                         *
              4818    1    ***************************************************************************/

       83     4822        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
       84     4841        %PAGE(ARG="QQB$DISEN", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:6    
              4858    1   /***************************************************************************
              4859    1    *                                                                         *
              4860    1    *                                 QQB$DISEN                               *
              4861    1    *                                                                         *
              4862    1    ***************************************************************************/

       85     4866    1           TYPE = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE;
       86     4867    1           ITEM = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT;
       87     4868
       88     4869    1           D$ = ADDR(NIL);
       89     4870    1           NEXT$ = QQ_GLOBAL.DISAB$;
       90     4871
       91     4872    2           DO WHILE('1'B);
       92     4873    2             NEXT$ = NEXT$ -> DISAB$INFO.FLINK$;
       93     4874    2             IF NEXT$ -> DISAB$INFO.FLINK$ = ADDR(NIL) THEN
       94     4875    3               DO;
       95     4876    3                 GOTO DOIT;
       96     4877    3               END;
       97     4878
       98     4879    2             IF NEXT$ -> DISAB$INFO.TYPE = TYPE AND
       99     4880    2                 NEXT$ -> DISAB$INFO.ITEM = ITEM THEN
      100     4881    3               DO;
      101     4882    3                 D$ = NEXT$;
      102     4883    3                 GOTO DOIT;
      103     4884    3               END;
      104     4885    2           END;
      105     4886
      106     4887    1   DOIT:
      107     4888    1           IF QQ_CMDBLK.CODE = 10 /* DISABLE */ THEN
      108     4889    2             DO;
      109     4890    2               CALL DISABLE ALTRET(PRINT_ERR);
      110     4891    2             END;
      111     4892    1           ELSE
      112     4893    2             DO;
      113     4894    2               CALL ENABLE ALTRET(PRINT_ERR);
      114     4895    2             END;
      115     4896
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:7    
      116     4897    1           CALL QQB$SAVCMD;                /* Good commands should be saved      */
      117     4898    1           GOTO RET;
      118     4899
      119     4900    1   PRINT_ERR:
      120     4901    1           CALL QQC$BLDMSG_BLK(MSGBLK);
      121     4902    1           CALL QQC$BLDMSG(MSGBLK);
      122     4903
      123     4904    1   RET:
      124     4905    1           RETURN;
      125     4906                %PAGE(ARG="ENABLE", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:8    
              4923    1   /***************************************************************************
              4924    1    *                                                                         *
              4925    1    *                                   ENABLE                                *
              4926    1    *                                                                         *
              4927    1    ***************************************************************************/

      126     4931    1   ENABLE:
      127     4932    1           PROC ALTRET;
      128     4933
      129     4934    2           IF D$ = ADDR(NIL) THEN
      130     4935    3             DO;
      131     4936    3               QQ_CMDBLK.MINOR_ERR = CODE_CE;
      132     4937    3               GOTO ALT;
      133     4938    3             END;
      134     4939
      135     4940    2           NEXT$ -> DISAB$INFO.FLINK$ -> DISAB$INFO.BLINK$ =
      136     4941    2               NEXT$ -> DISAB$INFO.BLINK$;
      137     4942    2           NEXT$ -> DISAB$INFO.BLINK$ -> DISAB$INFO.FLINK$ =
      138     4943    2               NEXT$ -> DISAB$INFO.FLINK$;
      139     4944    2           CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, NEXT$);
      140     4945    2           QQ_GLOBAL.DISAB_CNT = QQ_GLOBAL.DISAB_CNT - 1;
      141     4946    2           GOTO RET;
      142     4947
      143     4948    2   ALT:
      144     4949    2           ALTRETURN;
      145     4950
      146     4951    2   RET:
      147     4952    2           RETURN;
      148     4953
      149     4954    2   END ENABLE;
      150     4955                %PAGE(ARG="DISABLE", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:9    
              4972    2   /***************************************************************************
              4973    2    *                                                                         *
              4974    2    *                                  DISABLE                                *
              4975    2    *                                                                         *
              4976    2    ***************************************************************************/

      151     4980    1   DISABLE:
      152     4981    1           PROC ALTRET;
      153     4982
      154     4983    2           IF D$ ~= ADDR(NIL) THEN
      155     4984    3             DO;
      156     4985    3               QQ_CMDBLK.MINOR_ERR = CODE_CDT;
      157     4986    3               GOTO ALT;
      158     4987    3             END;
      159     4988
      160     4989    2           FP_CNT = 0;
      161     4990    2           STATION_CNT = 0;
      162     4991
      163     4992    3           DO I = 1 TO QQ_GLOBAL.STATION_CNT;
      164     4993    3             S$ = PINCRW(QQ_GLOBAL.STATION$, (I - 1) * SIZEW(TP$STATION));
      165     4994    3             CALL QQC$WILD_COMP(ITEM, TP$STATION.ID) ALTRET(NO_MATCH);
      166     4995    3             STATION_CNT = STATION_CNT + 1;
      167     4996
      168     4997    3   NO_MATCH:
      169     4998    3             CALL QQC$WILD_COMP(ITEM, TP$STATION.FP) ALTRET(LOOP);
      170     4999    3             FP_CNT = FP_CNT + 1;
      171     5000
      172     5001    3   LOOP:
      173     5002    3           END;
      174     5003
      175     5004    2           IF TYPE = 1 /* OPT_STATION */ THEN
      176     5005    3             DO;
      177     5006    3               QQ_CMDBLK.MINOR_ERR = CODE_SO;
      178     5007    3               NUM = STATION_CNT;
      179     5008    3             END;
      180     5009    2           ELSE
      181     5010    3             DO;
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:10   
      182     5011    3               QQ_CMDBLK.MINOR_ERR = CODE_FPIU;
      183     5012    3               NUM = FP_CNT;
      184     5013    3             END;
      185     5014
      186     5015    2           IF NUM > 0 THEN
      187     5016    3             DO;
      188     5017    3               CALL QQC$BLDMSG_BLK(MSGBLK);
      189     5018    3               CALL QQC$CONVERT_NUM(NUM, SIZE, ADDR(TEXTC_NUM.NAME#));
      190     5019    3               TEXTC_NUM.L# = SIZE;
      191     5020    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);
      192     5021    3               CALL QQC$BLDMSG(MSGBLK);
      193     5022    3             END;
      194     5023
      195     5024    2           CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(DISAB$INFO), D$) ALTRET(NO_MEM);
      196     5025    2           TAIL$ = QQ_GLOBAL.DISAB$ -> DISAB$INFO.BLINK$;
      197     5026    2           DISAB$INFO.FLINK$ = TAIL$;
      198     5027    2           DISAB$INFO.BLINK$ = TAIL$ -> DISAB$INFO.BLINK$;
      199     5028    2           TAIL$ -> DISAB$INFO.BLINK$ -> DISAB$INFO.FLINK$ = D$;
      200     5029    2           TAIL$ -> DISAB$INFO.BLINK$ = D$;
      201     5030    2           QQ_GLOBAL.DISAB_CNT = QQ_GLOBAL.DISAB_CNT + 1;
      202     5031
      203     5032    2           DISAB$INFO.TYPE = TYPE;
      204     5033    2           CALL M$TIME(FPT_TIME);
      205     5034    2           DISAB$INFO.UTS = UTS;
      206     5035    2           DISAB$INFO.ID = QQ_CMDBLK.S$ -> TP$STATION.ID;
      207     5036    2           DISAB$INFO.ITEM = ITEM;
      208     5037
      209     5038    2           GOTO RET;
      210     5039
      211     5040    2   ALT:
      212     5041    2           ALTRETURN;
      213     5042
      214     5043    2   RET:
      215     5044    2           RETURN;
      216     5045
      217     5046    2   NO_MEM:
      218     5047    2           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:11   
      219     5048    2           CALL QQC$SCREECH;
      220     5049
      221     5050    2   END DISABLE;
      222     5051    1   END QQB$DISEN;

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:12   
--  Include file information  --

   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$DISEN.

   Procedure QQB$DISEN requires 232 words for executable code.
   Procedure QQB$DISEN requires 42 words of local(AUTO) storage.

    No errors detected in file QQB$DISEN.:E05TSI    .

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:13   

 Object Unit name= QQB$DISEN                                  File name= QQB$DISEN.:E05TOU
 UTS= JUL 30 '97 05:29:51.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    14     16  QQB$DISEN
    2  RoData even  UTS      5      5  QQB$DISEN
    3   Proc  even  none   232    350  QQB$DISEN
    4  RoData even  none     6      6  QQB$DISEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  QQB$DISEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 QQB$SAVCMD
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       1 QQC$BLDMSG
         yes           Std       2 QQC$RLS_BLK
 yes     yes           Std       2 QQC$WILD_COMP
         yes           Std       0 QQC$SCREECH
         yes           Std       3 QQC$CONVERT_NUM
 yes     yes           Std       3 QQC$GET_BLK
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:15   


        1        1        /*M* QQB$DISEN - Perform  DISABLE  &  ENABLE  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$DISEN:
        9        9                PROC;

      9  3 000000   000000 700200 xent  QQB$DISEN    TSX0  ! X66_AUTO_0
         3 000001   000052 000000                    ZERO    42,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE XU_MACRO_C;
       16     3256        %INCLUDE QQ_SUBS_C;
       17     3448        %INCLUDE QQ_MACROS_C;
       18     3873        %INCLUDE QQ_DATA_R;
       19     4119        %INCLUDE Q_ERRCODE_C;
       20     4142        %INCLUDE QQ_PERR_C;
       21     4303        %PAGE(ARG="Externally defined routines");

              4320    1   /***************************************************************************
              4321    1    *                                                                         *
              4322    1    *                        Externally defined routines                      *
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:16   
              4323    1    *                                                                         *
              4324    1    ***************************************************************************/

       22     4328    1   DCL QQB$SAVCMD  ENTRY;
       23     4329    1   DCL QQC$RLS_BLK ENTRY(2);
       24     4330    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       25     4331    1   DCL QQC$CONVERT_NUM ENTRY(3);
       26     4332    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       27     4333    1   DCL QQC$BLDMSG ENTRY(1);
       28     4334    1   DCL QQC$SCREECH ENTRY;
       29     4335    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       30     4336        %PAGE(ARG="Based");

              4353    1   /***************************************************************************
              4354    1    *                                                                         *
              4355    1    *                                   Based                                 *
              4356    1    *                                                                         *
              4357    1    ***************************************************************************/

       31     4361        %TP$STATION;
       32     4434        %DISAB$INFO;
       33     4450        %PARSE$OUT(STCLASS=BASED);
       34     4495        %PARSE$SYM(STCLASS=BASED);
       35     4533        %PAGE(ARG="Static");

              4550    1   /***************************************************************************
              4551    1    *                                                                         *
              4552    1    *                                   Static                                *
              4553    1    *                                                                         *
              4554    1    ***************************************************************************/

       36     4558    1   DCL UTS UBIN WORD STATIC;
       37     4559
       38     4560        %VLP_NAME(FPTN=TEXTC_NUM, STCLASS=STATIC, NAME='123');
       39     4587        %PAGE(ARG="Auto");

              4604    1   /***************************************************************************
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:17   
              4605    1    *                                                                         *
              4606    1    *                                    Auto                                 *
              4607    1    *                                                                         *
              4608    1    ***************************************************************************/

       40     4612    1   DCL NEXT$ PTR;
       41     4613    1   DCL TAIL$ PTR;
       42     4614
       43     4615    1   DCL TYPE UBIN WORD;
       44     4616    1   DCL I SBIN WORD;
       45     4617    1   DCL FP_CNT UBIN WORD;
       46     4618    1   DCL STATION_CNT UBIN WORD;
       47     4619    1   DCL NUM UBIN WORD;
       48     4620    1   DCL SIZE UBIN WORD;
       49     4621
       50     4622    1   DCL ITEM CHAR(8);
       51     4623        %MSGBLK;
       52     4713        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:18   
              4730    1   /***************************************************************************
              4731    1    *                                                                         *
              4732    1    *                                Error codes                              *
              4733    1    *                                                                         *
              4734    1    ***************************************************************************/

       53     4738        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
       54     4745        %ERRCODE(NAME=CODE_CE, CODE#=%E$CE, FCG#=%FCG_QQ, MID#=%MID_B);
       55     4752        %ERRCODE(NAME=CODE_CDT, CODE#=%E$CDT, FCG#=%FCG_QQ, MID#=%MID_B);
       56     4759        %ERRCODE(NAME=CODE_SO, CODE#=%E$SO, FCG#=%FCG_QQ, MID#=%MID_B);
       57     4766        %ERRCODE(NAME=CODE_FPIU, CODE#=%E$FPIU, FCG#=%FCG_QQ, MID#=%MID_B);
       58     4773        /*E*       ERROR: QQB-E$CE-C
       59     4774
       60     4775                 MESSAGE: Can't ENABLE something that is not disabled
       61     4776             DESCRIPTION: An  ENABLE  command can only be used to enable
       62     4777                          an item that has been specifically disabled.
       63     4778        */
       64     4779        /*E*       ERROR: QQB-E$CDT-C
       65     4780
       66     4781                 MESSAGE: Item is already  disabled.
       67     4782             DESCRIPTION: You are not permitted to  DISABLE  the same item
       68     4783                          twice.
       69     4784        */
       70     4785        /*E*       ERROR: QQB-E$SO-C
       71     4786
       72     4787                 MESSAGE: %U1 station(s) on.
       73     4788             DESCRIPTION: For your information there are this many stations
       74     4789                          currently on of the type that you disabled.
       75     4790        */
       76     4791        /*E*       ERROR: QQB-E$FPIU-C
       77     4792
       78     4793                 MESSAGE: %U1 Forms Program(s) in use.
       79     4794             DESCRIPTION: For your infomation there are this many forms
       80     4795                          programs in use of the type that you just disabled.
       81     4796        */
       82     4797        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:19   
              4814    1   /***************************************************************************
              4815    1    *                                                                         *
              4816    1    *                                    FPTs                                 *
              4817    1    *                                                                         *
              4818    1    ***************************************************************************/

       83     4822        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
       84     4841        %PAGE(ARG="QQB$DISEN", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:20   
              4858    1   /***************************************************************************
              4859    1    *                                                                         *
              4860    1    *                                 QQB$DISEN                               *
              4861    1    *                                                                         *
              4862    1    ***************************************************************************/

       85     4866    1           TYPE = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE;

   4866  3 000002   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         3 000003   000003 471500                    LDP1    3,,PR0
         3 000004   100000 236100                    LDQ     0,,PR1
         3 000005   777777 376007                    ANQ     -1,DL
         3 000006   200007 756100                    STQ     TYPE,,AUTO

       86     4867    1           ITEM = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT;

   4867  3 000007   000004 473500                    LDP3    4,,PR0
         3 000010   300004 236100                    LDQ     4,,PR3
         3 000011   000033 772000                    QRL     27
         3 000012   000000 620006                    EAX0    0,QL
         3 000013   040100 100540                    MLR     fill='040'O
         3 000014   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000015   200015 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8

       87     4868
       88     4869    1           D$ = ADDR(NIL);

   4869  3 000016   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000017   200004 756100                    STQ     D$,,AUTO

       89     4870    1           NEXT$ = QQ_GLOBAL.DISAB$;

   4870  3 000020   000055 236000 xsym               LDQ     QQ_GLOBAL+45
         3 000021   200005 756100                    STQ     NEXT$,,AUTO

       90     4871
       91     4872    2           DO WHILE('1'B);
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:21   

       92     4873    2             NEXT$ = NEXT$ -> DISAB$INFO.FLINK$;

   4873  3 000022   200005 470500                    LDP0    NEXT$,,AUTO
         3 000023   000001 236100                    LDQ     1,,PR0
         3 000024   200005 756100                    STQ     NEXT$,,AUTO

       93     4874    2             IF NEXT$ -> DISAB$INFO.FLINK$ = ADDR(NIL) THEN

   4874  3 000025   200005 470500                    LDP0    NEXT$,,AUTO
         3 000026   000001 236100                    LDQ     1,,PR0
         3 000027   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000030   000032 601000 3                  TNZ     s:4879

       94     4875    3               DO;

       95     4876    3                 GOTO DOIT;

   4876  3 000031   000044 710000 3                  TRA     DOIT

       96     4877    3               END;
       97     4878
       98     4879    2             IF NEXT$ -> DISAB$INFO.TYPE = TYPE AND

   4879  3 000032   000002 236100                    LDQ     2,,PR0
         3 000033   200007 116100                    CMPQ    TYPE,,AUTO
         3 000034   000022 601000 3                  TNZ     s:4873
         3 000035   040100 106500                    CMPC    fill='040'O
         3 000036   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         3 000037   200015 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8
         3 000040   000022 601000 3                  TNZ     s:4873

       99     4880    2                 NEXT$ -> DISAB$INFO.ITEM = ITEM THEN
      100     4881    3               DO;

      101     4882    3                 D$ = NEXT$;

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:22   
   4882  3 000041   200005 236100                    LDQ     NEXT$,,AUTO
         3 000042   200004 756100                    STQ     D$,,AUTO

      102     4883    3                 GOTO DOIT;

   4883  3 000043   000044 710000 3                  TRA     DOIT

      103     4884    3               END;
      104     4885    2           END;

      105     4886
      106     4887    1   DOIT:
      107     4888    1           IF QQ_CMDBLK.CODE = 10 /* DISABLE */ THEN

   4888  3 000044   000006 235000 xsym  DOIT         LDA     QQ_CMDBLK+6
         3 000045   000012 115007                    CMPA    10,DL
         3 000046   000052 601000 3                  TNZ     s:4894

      108     4889    2             DO;

      109     4890    2               CALL DISABLE ALTRET(PRINT_ERR);

   4890  3 000047   000133 701000 3                  TSX1    DISABLE
         3 000050   000060 702000 3                  TSX2    PRINT_ERR

      110     4891    2             END;

   4891  3 000051   000054 710000 3                  TRA     s:4897

      111     4892    1           ELSE
      112     4893    2             DO;

      113     4894    2               CALL ENABLE ALTRET(PRINT_ERR);

   4894  3 000052   000075 701000 3                  TSX1    ENABLE
         3 000053   000060 702000 3                  TSX2    PRINT_ERR

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:23   
      114     4895    2             END;

      115     4896
      116     4897    1           CALL QQB$SAVCMD;                /* Good commands should be saved      */

   4897  3 000054   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000055   000000 701000 xent               TSX1    QQB$SAVCMD
         3 000056   000000 011000                    NOP     0

      117     4898    1           GOTO RET;

   4898  3 000057   000074 710000 3                  TRA     RET

      118     4899
      119     4900    1   PRINT_ERR:
      120     4901    1           CALL QQC$BLDMSG_BLK(MSGBLK);

   4901  3 000060   200017 630500       PRINT_ERR    EPPR0   MSGBLK,,AUTO
         3 000061   200046 450500                    STP0    MSGBLK+23,,AUTO
         3 000062   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000063   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000064   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         3 000065   000000 011000                    NOP     0

      121     4902    1           CALL QQC$BLDMSG(MSGBLK);

   4902  3 000066   200017 630500                    EPPR0   MSGBLK,,AUTO
         3 000067   200046 450500                    STP0    MSGBLK+23,,AUTO
         3 000070   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000072   000000 701000 xent               TSX1    QQC$BLDMSG
         3 000073   000000 011000                    NOP     0

      122     4903
      123     4904    1   RET:
      124     4905    1           RETURN;

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:24   
   4905  3 000074   000000 702200 xent  RET          TSX2  ! X66_ARET

      125     4906                %PAGE(ARG="ENABLE", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:25   
              4923    1   /***************************************************************************
              4924    1    *                                                                         *
              4925    1    *                                   ENABLE                                *
              4926    1    *                                                                         *
              4927    1    ***************************************************************************/

      126     4931    1   ENABLE:

   4931  3 000075   200044 741300       ENABLE       STX1  ! MSGBLK+21,,AUTO

      127     4932    1           PROC ALTRET;
      128     4933
      129     4934    2           IF D$ = ADDR(NIL) THEN

   4934  3 000076   200004 236100                    LDQ     D$,,AUTO
         3 000077   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000100   000104 601000 3                  TNZ     s:4940

      130     4935    3             DO;

      131     4936    3               QQ_CMDBLK.MINOR_ERR = CODE_CE;

   4936  3 000101   000001 236000 2                  LDQ     CODE_CE
         3 000102   000001 756000 xsym               STQ     QQ_CMDBLK+1

      132     4937    3               GOTO ALT;

   4937  3 000103   000130 710000 3                  TRA     ALT

      133     4938    3             END;
      134     4939
      135     4940    2           NEXT$ -> DISAB$INFO.FLINK$ -> DISAB$INFO.BLINK$ =

   4940  3 000104   200005 470500                    LDP0    NEXT$,,AUTO
         3 000105   000001 471500                    LDP1    1,,PR0
         3 000106   000000 236100                    LDQ     0,,PR0
         3 000107   100000 756100                    STQ     0,,PR1
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:26   

      136     4941    2               NEXT$ -> DISAB$INFO.BLINK$;
      137     4942    2           NEXT$ -> DISAB$INFO.BLINK$ -> DISAB$INFO.FLINK$ =

   4942  3 000110   200005 470500                    LDP0    NEXT$,,AUTO
         3 000111   000000 471500                    LDP1    0,,PR0
         3 000112   000001 236100                    LDQ     1,,PR0
         3 000113   100001 756100                    STQ     1,,PR1

      138     4943    2               NEXT$ -> DISAB$INFO.FLINK$;
      139     4944    2           CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, NEXT$);

   4944  3 000114   200005 630500                    EPPR0   NEXT$,,AUTO
         3 000115   200047 450500                    STP0    MSGBLK+24,,AUTO
         3 000116   000000 236000 4                  LDQ     0
         3 000117   200046 756100                    STQ     MSGBLK+23,,AUTO
         3 000120   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000122   000000 701000 xent               TSX1    QQC$RLS_BLK
         3 000123   000000 011000                    NOP     0

      140     4945    2           QQ_GLOBAL.DISAB_CNT = QQ_GLOBAL.DISAB_CNT - 1;

   4945  3 000124   000033 235000 xsym               LDA     QQ_GLOBAL+27
         3 000125   000001 135007                    SBLA    1,DL
         3 000126   000033 755000 xsym               STA     QQ_GLOBAL+27

      141     4946    2           GOTO RET;

   4946  3 000127   000131 710000 3                  TRA     RET

      142     4947
      143     4948    2   ALT:
      144     4949    2           ALTRETURN;

   4949  3 000130   000000 702211       ALT          TSX2  ! 0,X1

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:27   
      145     4950
      146     4951    2   RET:
      147     4952    2           RETURN;

   4952  3 000131   200044 221300       RET          LDX1  ! MSGBLK+21,,AUTO
         3 000132   000001 702211                    TSX2  ! 1,X1

      148     4953
      149     4954    2   END ENABLE;
      150     4955                %PAGE(ARG="DISABLE", PAGE=YES);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:28   
              4972    2   /***************************************************************************
              4973    2    *                                                                         *
              4974    2    *                                  DISABLE                                *
              4975    2    *                                                                         *
              4976    2    ***************************************************************************/

      151     4980    1   DISABLE:

   4980  3 000133   200044 741300       DISABLE      STX1  ! MSGBLK+21,,AUTO

      152     4981    1           PROC ALTRET;
      153     4982
      154     4983    2           IF D$ ~= ADDR(NIL) THEN

   4983  3 000134   200004 236100                    LDQ     D$,,AUTO
         3 000135   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000136   000142 600000 3                  TZE     s:4989

      155     4984    3             DO;

      156     4985    3               QQ_CMDBLK.MINOR_ERR = CODE_CDT;

   4985  3 000137   000002 236000 2                  LDQ     CODE_CDT
         3 000140   000001 756000 xsym               STQ     QQ_CMDBLK+1

      157     4986    3               GOTO ALT;

   4986  3 000141   000336 710000 3                  TRA     ALT

      158     4987    3             END;
      159     4988
      160     4989    2           FP_CNT = 0;

   4989  3 000142   200011 450100                    STZ     FP_CNT,,AUTO

      161     4990    2           STATION_CNT = 0;

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:29   
   4990  3 000143   200012 450100                    STZ     STATION_CNT,,AUTO

      162     4991
      163     4992    3           DO I = 1 TO QQ_GLOBAL.STATION_CNT;

   4992  3 000144   000001 235007                    LDA     1,DL
         3 000145   200010 755100                    STA     I,,AUTO
         3 000146   000203 710000 3                  TRA     LOOP+1

      164     4993    3             S$ = PINCRW(QQ_GLOBAL.STATION$, (I - 1) * SIZEW(TP$STATION));

   4993  3 000147   200010 236100                    LDQ     I,,AUTO
         3 000150   000032 402003                    MPY     26,DU
         3 000151   000032 136003                    SBLQ    26,DU
         3 000152   000151 036000 xsym               ADLQ    QQ_GLOBAL+105
         3 000153   200003 756100                    STQ     S$,,AUTO

      165     4994    3             CALL QQC$WILD_COMP(ITEM, TP$STATION.ID) ALTRET(NO_MATCH);

   4994  3 000154   200047 756100                    STQ     MSGBLK+24,,AUTO
         3 000155   200015 630500                    EPPR0   ITEM,,AUTO
         3 000156   200046 450500                    STP0    MSGBLK+23,,AUTO
         3 000157   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000160   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000161   000000 701000 xent               TSX1    QQC$WILD_COMP
         3 000162   000166 702000 3                  TSX2    NO_MATCH

      166     4995    3             STATION_CNT = STATION_CNT + 1;

   4995  3 000163   200012 235100                    LDA     STATION_CNT,,AUTO
         3 000164   000001 035007                    ADLA    1,DL
         3 000165   200012 755100                    STA     STATION_CNT,,AUTO

      167     4996
      168     4997    3   NO_MATCH:
      169     4998    3             CALL QQC$WILD_COMP(ITEM, TP$STATION.FP) ALTRET(LOOP);

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:30   
   4998  3 000166   200003 236100       NO_MATCH     LDQ     S$,,AUTO
         3 000167   000002 036003                    ADLQ    2,DU
         3 000170   200047 756100                    STQ     MSGBLK+24,,AUTO
         3 000171   200015 630500                    EPPR0   ITEM,,AUTO
         3 000172   200046 450500                    STP0    MSGBLK+23,,AUTO
         3 000173   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000174   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000175   000000 701000 xent               TSX1    QQC$WILD_COMP
         3 000176   000202 702000 3                  TSX2    LOOP

      170     4999    3             FP_CNT = FP_CNT + 1;

   4999  3 000177   200011 235100                    LDA     FP_CNT,,AUTO
         3 000200   000001 035007                    ADLA    1,DL
         3 000201   200011 755100                    STA     FP_CNT,,AUTO

      171     5000
      172     5001    3   LOOP:
      173     5002    3           END;

   5002  3 000202   200010 054100       LOOP         AOS     I,,AUTO
         3 000203   000032 236000 xsym               LDQ     QQ_GLOBAL+26
         3 000204   000147 604000 3                  TMI     s:4993
         3 000205   200010 116100                    CMPQ    I,,AUTO
         3 000206   000147 605000 3                  TPL     s:4993

      174     5003
      175     5004    2           IF TYPE = 1 /* OPT_STATION */ THEN

   5004  3 000207   200007 235100                    LDA     TYPE,,AUTO
         3 000210   000001 115007                    CMPA    1,DL
         3 000211   000217 601000 3                  TNZ     s:5011

      176     5005    3             DO;

      177     5006    3               QQ_CMDBLK.MINOR_ERR = CODE_SO;

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:31   
   5006  3 000212   000003 236000 2                  LDQ     CODE_SO
         3 000213   000001 756000 xsym               STQ     QQ_CMDBLK+1

      178     5007    3               NUM = STATION_CNT;

   5007  3 000214   200012 235100                    LDA     STATION_CNT,,AUTO
         3 000215   200013 755100                    STA     NUM,,AUTO

      179     5008    3             END;

   5008  3 000216   000223 710000 3                  TRA     s:5015

      180     5009    2           ELSE
      181     5010    3             DO;

      182     5011    3               QQ_CMDBLK.MINOR_ERR = CODE_FPIU;

   5011  3 000217   000004 236000 2                  LDQ     CODE_FPIU
         3 000220   000001 756000 xsym               STQ     QQ_CMDBLK+1

      183     5012    3               NUM = FP_CNT;

   5012  3 000221   200011 235100                    LDA     FP_CNT,,AUTO
         3 000222   200013 755100                    STA     NUM,,AUTO

      184     5013    3             END;

      185     5014
      186     5015    2           IF NUM > 0 THEN

   5015  3 000223   000262 600000 3                  TZE     s:5024

      187     5016    3             DO;

      188     5017    3               CALL QQC$BLDMSG_BLK(MSGBLK);

   5017  3 000224   200017 630500                    EPPR0   MSGBLK,,AUTO
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:32   
         3 000225   200046 450500                    STP0    MSGBLK+23,,AUTO
         3 000226   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000230   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         3 000231   000000 011000                    NOP     0

      189     5018    3               CALL QQC$CONVERT_NUM(NUM, SIZE, ADDR(TEXTC_NUM.NAME#));

   5018  3 000232   000001 236000 4                  LDQ     1
         3 000233   200046 756100                    STQ     MSGBLK+23,,AUTO
         3 000234   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000235   200051 450500                    STP0    MSGBLK+26,,AUTO
         3 000236   200014 631500                    EPPR1   SIZE,,AUTO
         3 000237   200050 451500                    STP1    MSGBLK+25,,AUTO
         3 000240   200013 633500                    EPPR3   NUM,,AUTO
         3 000241   200047 453500                    STP3    MSGBLK+24,,AUTO
         3 000242   200047 630500                    EPPR0   MSGBLK+24,,AUTO
         3 000243   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000244   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         3 000245   000000 011000                    NOP     0

      190     5019    3               TEXTC_NUM.L# = SIZE;

   5019  3 000246   200014 236100                    LDQ     SIZE,,AUTO
         3 000247   000033 736000                    QLS     27
         3 000250   000001 552040 1                  STBQ    TEXTC_NUM,'40'O

      191     5020    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);

   5020  3 000251   000100 100400                    MLR     fill='000'O
         3 000252   000002 000010 4                  ADSC9   2                        cn=0,n=8
         3 000253   200026 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      192     5021    3               CALL QQC$BLDMSG(MSGBLK);

   5021  3 000254   200017 630500                    EPPR0   MSGBLK,,AUTO
         3 000255   200046 450500                    STP0    MSGBLK+23,,AUTO
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:33   
         3 000256   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000260   000000 701000 xent               TSX1    QQC$BLDMSG
         3 000261   000000 011000                    NOP     0

      193     5022    3             END;

      194     5023
      195     5024    2           CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(DISAB$INFO), D$) ALTRET(NO_MEM);

   5024  3 000262   200004 630500                    EPPR0   D$,,AUTO
         3 000263   200050 450500                    STP0    MSGBLK+25,,AUTO
         3 000264   000004 237000 4                  LDAQ    4
         3 000265   200046 757100                    STAQ    MSGBLK+23,,AUTO
         3 000266   200046 630500                    EPPR0   MSGBLK+23,,AUTO
         3 000267   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000270   000000 701000 xent               TSX1    QQC$GET_BLK
         3 000271   000341 702000 3                  TSX2    NO_MEM

      196     5025    2           TAIL$ = QQ_GLOBAL.DISAB$ -> DISAB$INFO.BLINK$;

   5025  3 000272   000055 470400 xsym               LDP0    QQ_GLOBAL+45
         3 000273   000000 236100                    LDQ     0,,PR0
         3 000274   200006 756100                    STQ     TAIL$,,AUTO

      197     5026    2           DISAB$INFO.FLINK$ = TAIL$;

   5026  3 000275   200004 471500                    LDP1    D$,,AUTO
         3 000276   100001 756100                    STQ     1,,PR1

      198     5027    2           DISAB$INFO.BLINK$ = TAIL$ -> DISAB$INFO.BLINK$;

   5027  3 000277   200006 470500                    LDP0    TAIL$,,AUTO
         3 000300   000000 236100                    LDQ     0,,PR0
         3 000301   200004 471500                    LDP1    D$,,AUTO
         3 000302   100000 756100                    STQ     0,,PR1

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:34   
      199     5028    2           TAIL$ -> DISAB$INFO.BLINK$ -> DISAB$INFO.FLINK$ = D$;

   5028  3 000303   000000 471500                    LDP1    0,,PR0
         3 000304   200004 236100                    LDQ     D$,,AUTO
         3 000305   100001 756100                    STQ     1,,PR1

      200     5029    2           TAIL$ -> DISAB$INFO.BLINK$ = D$;

   5029  3 000306   200004 236100                    LDQ     D$,,AUTO
         3 000307   000000 756100                    STQ     0,,PR0

      201     5030    2           QQ_GLOBAL.DISAB_CNT = QQ_GLOBAL.DISAB_CNT + 1;

   5030  3 000310   000033 235000 xsym               LDA     QQ_GLOBAL+27
         3 000311   000001 035007                    ADLA    1,DL
         3 000312   000033 755000 xsym               STA     QQ_GLOBAL+27

      202     5031
      203     5032    2           DISAB$INFO.TYPE = TYPE;

   5032  3 000313   200004 471500                    LDP1    D$,,AUTO
         3 000314   200007 236100                    LDQ     TYPE,,AUTO
         3 000315   100002 756100                    STQ     2,,PR1

      204     5033    2           CALL M$TIME(FPT_TIME);

   5033  3 000316   000002 630400 1                  EPPR0   FPT_TIME
         3 000317   020004 713400                    CLIMB   8196
         3 000320   402000 401760                    pmme    nvectors=5

      205     5034    2           DISAB$INFO.UTS = UTS;

   5034  3 000321   200004 470500                    LDP0    D$,,AUTO
         3 000322   000000 235000 1                  LDA     UTS
         3 000323   000003 755100                    STA     3,,PR0

      206     5035    2           DISAB$INFO.ID = QQ_CMDBLK.S$ -> TP$STATION.ID;
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:35   

   5035  3 000324   000004 470400 xsym               LDP0    QQ_CMDBLK+4
         3 000325   200004 471500                    LDP1    D$,,AUTO
         3 000326   040100 100500                    MLR     fill='040'O
         3 000327   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         3 000330   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8

      207     5036    2           DISAB$INFO.ITEM = ITEM;

   5036  3 000331   200004 470500                    LDP0    D$,,AUTO
         3 000332   040100 100500                    MLR     fill='040'O
         3 000333   200015 000010                    ADSC9   ITEM,,AUTO               cn=0,n=8
         3 000334   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

      208     5037
      209     5038    2           GOTO RET;

   5038  3 000335   000337 710000 3                  TRA     RET

      210     5039
      211     5040    2   ALT:
      212     5041    2           ALTRETURN;

   5041  3 000336   000000 702211       ALT          TSX2  ! 0,X1

      213     5042
      214     5043    2   RET:
      215     5044    2           RETURN;

   5044  3 000337   200044 221300       RET          LDX1  ! MSGBLK+21,,AUTO
         3 000340   000001 702211                    TSX2  ! 1,X1

      216     5045
      217     5046    2   NO_MEM:
      218     5047    2           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;

   5047  3 000341   000000 236000 2     NO_MEM       LDQ     CODE_NO_POOLMEM
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:36   
         3 000342   000000 756000 xsym               STQ     QQ_GLOBAL

      219     5048    2           CALL QQC$SCREECH;

   5048  3 000343   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000344   000000 701000 xent               TSX1    QQC$SCREECH
         3 000345   000000 011000                    NOP     0

      220     5049
      221     5050    2   END DISABLE;

   5050  3 000346   200044 221300                    LDX1  ! MSGBLK+21,,AUTO
         3 000347   000001 702211                    TSX2  ! 1,X1
      222     5051    1   END QQB$DISEN;

PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:37   
--  Include file information  --

   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$DISEN.
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:38   

 **** Variables and constants ****

  ****  Section 001  Data  QQB$DISEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(432)   r     1 FPT_TIME                   1-0-0/c STRC        r     1 TEXTC_NUM
     0-0-0/w UBIN        r     1 UTS

  ****  Section 002 RoData QQB$DISEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/b STRC        r     1 CODE_CDT                   1-0-0/b STRC        r     1 CODE_CE
     4-0-0/b STRC        r     1 CODE_FPIU                  0-0-0/b STRC        r     1 CODE_NO_POOLMEM
     3-0-0/b STRC        r     1 CODE_SO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 D$                        11-0-0/w UBIN        r     1 FP_CNT
    10-0-0/w SBIN        r     1 I                         15-0-0/c CHAR(8)     r     1 ITEM
    17-0-0/w STRC(738)   r     1 MSGBLK                     5-0-0/w PTR         r     1 NEXT$
    13-0-0/w UBIN        r     1 NUM                        3-0-0/w PTR         r     1 S$
    14-0-0/w UBIN        r     1 SIZE                      12-0-0/w UBIN        r     1 STATION_CNT
     6-0-0/w PTR         r     1 TAIL$                      7-0-0/w UBIN        r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(315)   r     1 QQ_CMDBLK                  0-0-0/d STRC(9090)  r     1 QQ_GLOBAL
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:39   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 DISAB$INFO                 0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQB$DISEN requires 232 words for executable code.
   Procedure QQB$DISEN requires 42 words of local(AUTO) storage.

    No errors detected in file QQB$DISEN.:E05TSI    .
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:41   
          MINI XREF LISTING

ALT IN PROCEDURE DISABLE
      5041**LABEL    4986--GOTO
ALT IN PROCEDURE ENABLE
      4949**LABEL    4937--GOTO
CODE_CDT
      4753**DCL      4985>>ASSIGN
CODE_CE
      4746**DCL      4936>>ASSIGN
CODE_FPIU
      4767**DCL      5011>>ASSIGN
CODE_NO_POOLMEM
      4739**DCL      5047>>ASSIGN
CODE_SO
      4760**DCL      5006>>ASSIGN
D$
      4435**DCL      4436--IMP-PTR  4869<<ASSIGN   4882<<ASSIGN   4934>>IF       4983>>IF       5024<>CALL
      5026>>ASSIGN   5027>>ASSIGN   5028>>ASSIGN   5029>>ASSIGN   5032>>ASSIGN   5034>>ASSIGN   5035>>ASSIGN
      5036>>ASSIGN
DISAB$INFO
      4436**DCL      5024--CALL
DISAB$INFO.BLINK$
      4437**DCL      4940<<ASSIGN   4940>>ASSIGN   4942>>ASSIGN   5025>>ASSIGN   5027<<ASSIGN   5027>>ASSIGN
      5028>>ASSIGN   5029<<ASSIGN
DISAB$INFO.FLINK$
      4439**DCL      4873>>ASSIGN   4874>>IF       4940>>ASSIGN   4942<<ASSIGN   4942>>ASSIGN   5026<<ASSIGN
      5028<<ASSIGN
DISAB$INFO.ID
      4445**DCL      5035<<ASSIGN
DISAB$INFO.ITEM
      4447**DCL      4879>>IF       5036<<ASSIGN
DISAB$INFO.TYPE
      4441**DCL      4879>>IF       5032<<ASSIGN
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:42   
DISAB$INFO.UTS
      4443**DCL      5034<<ASSIGN
DISABLE
      4981**PROC     4890--CALL
DOIT
      4888**LABEL    4876--GOTO     4883--GOTO
ENABLE
      4932**PROC     4894--CALL
FPT_TIME
      4833**DCL      5033<>CALL
FPT_TIME.V
      4837**DCL      4833--DCLINIT
FP_CNT
      4617**DCL      4989<<ASSIGN   4999<<ASSIGN   4999>>ASSIGN   5012>>ASSIGN
I
      4616**DCL      4992<<DOINDEX  4993>>ASSIGN
ITEM
      4622**DCL      4867<<ASSIGN   4879>>IF       4994<>CALL     4998<>CALL     5036>>ASSIGN
LOOP IN PROCEDURE DISABLE
      5002**LABEL    4998--CALLALT
M$TIME
       145**DCL-ENT  5033--CALL
MSGBLK
      4624**DCL      4901<>CALL     4902<>CALL     5017<>CALL     5021<>CALL
MSGBLK.ERRINFO.FIELD1
      4706**DCL      5020<<ASSIGN
NEXT$
      4612**DCL      4870<<ASSIGN   4873<<ASSIGN   4873>>ASSIGN   4874>>IF       4879>>IF       4879>>IF
      4882>>ASSIGN   4940>>ASSIGN   4940>>ASSIGN   4942>>ASSIGN   4942>>ASSIGN   4944<>CALL
NO_MATCH IN PROCEDURE DISABLE
      4998**LABEL    4994--CALLALT
NO_MEM IN PROCEDURE DISABLE
      5047**LABEL    5024--CALLALT
NUM
      4619**DCL      5007<<ASSIGN   5012<<ASSIGN   5015>>IF       5018<>CALL
OUT$BLK.SUBLK$
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:43   
      4489**DCL      4866>>ASSIGN   4867>>ASSIGN   4867>>ASSIGN
OUT$SYM.CODE
      4508**DCL      4866>>ASSIGN
OUT$SYM.COUNT
      4525**DCL      4528--IMP-SIZ  4867>>ASSIGN
OUT$SYM.TEXT
      4528**DCL      4867>>ASSIGN
PRINT_ERR
      4901**LABEL    4890--CALLALT  4894--CALLALT
QQB$SAVCMD
      4328**DCL-ENT  4897--CALL
QQC$BLDMSG
      4333**DCL-ENT  4902--CALL     5021--CALL
QQC$BLDMSG_BLK
      4332**DCL-ENT  4901--CALL     5017--CALL
QQC$CONVERT_NUM
      4331**DCL-ENT  5018--CALL
QQC$GET_BLK
      4330**DCL-ENT  5024--CALL
QQC$RLS_BLK
      4329**DCL-ENT  4944--CALL
QQC$SCREECH
      4334**DCL-ENT  5048--CALL
QQC$WILD_COMP
      4335**DCL-ENT  4994--CALL     4998--CALL
QQ_CMDBLK.CODE
      3882**DCL      4888>>IF
QQ_CMDBLK.MINOR_ERR
      3882**DCL      4936<<ASSIGN   4985<<ASSIGN   5006<<ASSIGN   5011<<ASSIGN
QQ_CMDBLK.OUT$
      3882**DCL      4866>>ASSIGN   4867>>ASSIGN   4867>>ASSIGN
QQ_CMDBLK.S$
      3882**DCL      5035>>ASSIGN
QQ_GLOBAL.DISAB$
      3891**DCL      4870>>ASSIGN   5025>>ASSIGN
QQ_GLOBAL.DISAB_CNT
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:44   
      3888**DCL      4945<<ASSIGN   4945>>ASSIGN   5030<<ASSIGN   5030>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      3893**DCL      3893--REDEF
QQ_GLOBAL.DS2$_BITS
      3893**DCL      3894--REDEF
QQ_GLOBAL.DS3$_BITS
      3894**DCL      3894--REDEF
QQ_GLOBAL.DS4$_BITS
      3894**DCL      3895--REDEF
QQ_GLOBAL.ERR
      3883**DCL      5047<<ASSIGN
QQ_GLOBAL.POOL$
      3894**DCL      4944<>CALL     5024<>CALL
QQ_GLOBAL.STATION$
      3894**DCL      4993>>ASSIGN
QQ_GLOBAL.STATION_CNT
      3888**DCL      4992>>DOINDEX
RET
      4905**LABEL    4898--GOTO
RET IN PROCEDURE DISABLE
      5044**LABEL    5038--GOTO
RET IN PROCEDURE ENABLE
      4952**LABEL    4946--GOTO
S$
      4373**DCL      4375--IMP-PTR  4993<<ASSIGN   4994>>CALL     4998>>CALL
SIZE
      4620**DCL      5018<>CALL     5019>>ASSIGN
STATION_CNT
      4618**DCL      4990<<ASSIGN   4995<<ASSIGN   4995>>ASSIGN   5007>>ASSIGN
TAIL$
      4613**DCL      5025<<ASSIGN   5026>>ASSIGN   5027>>ASSIGN   5028>>ASSIGN   5029>>ASSIGN
TEXTC_NUM
      4585**DCL      5020--ASSIGN
TEXTC_NUM.L#
      4585**DCL      5019<<ASSIGN
TEXTC_NUM.NAME#
PL6.E3A0      #001=QQB$DISEN File=QQB$DISEN.:E05TSI                              WED 07/30/97 05:29 Page:45   
      4585**DCL      5018--CALL
TP$STATION
      4375**DCL      4993--ASSIGN
TP$STATION.FP
      4378**DCL      4998<>CALL
TP$STATION.ID
      4376**DCL      4994<>CALL     5035>>ASSIGN
TYPE
      4615**DCL      4866<<ASSIGN   4879>>IF       5004>>IF       5032>>ASSIGN
UTS
      4558**DCL      4837--DCLINIT  5034>>ASSIGN
