
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*
        7        7              ZIU$CMPT_INIT - OVERLAY # 1 FOR  COMPACT PACKAGE
        8        8                  THIS ROUTINE EXTRACTS INFORMATION FROM
        9        9                  THE SCHEMA FILE AND INITILIZES ALL TABLES USED BY
       10       10                  2ND ENTRY PT - ZIU$CMPT_SMRY
       11       11                      PRINT PROCESSING SUMMARY MESSAGE.
       12       12        */
       13       13        ZIU$CMPT_INIT: PROC ALTRET NOAUTO;
       14       14
       15       15    1   DCL ERROR_MSG ENTRY(4);
       16       16    1   DCL SHIFT_ARRAY ENTRY(3);
       17       17    1   DCL FREE_DYN_MEM ENTRY ALTRET;
       18       18    1   DCL BIN_CHAR ENTRY(2);
       19       19    1   DCL CHKSUM ENTRY;
       20       20    1   DCL OPEN_AREA ENTRY ALTRET;
       21       21    1   DCL READ_DB ENTRY(3) ALTRET;
       22       22    1   DCL GET_DCB ENTRY(1) ALTRET;
       23       23
       24       24    1   DCL ZIU$Q2SC ENTRY(2) ALTRET; /* OPEN SCHEMA AND GET DMCL AD_REC */
       25       25    1   DCL ZIU$SYSCTL ENTRY ALTRET;
       26       26    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
       27       27    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       28       28    1   DCL SYS_FUNC_CHECK ENTRY ALTRET;
       29       29    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       30       30    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
       31       31    1   DCL SYS_FUNC_RELEASE ENTRY ALTRET;
       32       32    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
       33       33
       34       34    1   DCL RBUF CHAR(256) SYMREF CALIGNED;
       35       35    1   DCL READ_SW SBIN SYMREF;
       36       36    1   DCL COMMAND_TEXT CHAR(16) SYMREF ALIGNED;
       37       37    1   DCL MAX_KEY_SIZE SBIN SYMREF ALIGNED;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:2    
       38       38    1   DCL PRFR SBIN SYMREF ALIGNED;
       39       39    1   DCL PRFR2 SBIN SYMREF ALIGNED;
       40       40    1   DCL REC2$ PTR SYMREF ALIGNED;
       41       41    1   DCL REC_CNT SBIN SYMREF ALIGNED;
       42       42    1   DCL PTR_LEN SBIN SYMREF ALIGNED;
       43       43    1   DCL DBKEY_SORT_DCB UBIN HALF SYMREF ALIGNED;
       44       44    1   DCL 1 STK SYMREF ALIGNED,
       45       45    1         2 NEXT SBIN ALIGNED,
       46       46    1         2 PRIOR SBIN ALIGNED;
       47       47    1   DCL 1 KEY STATIC ALIGNED,
       48       48    1         2 CNT UBIN BYTE UNAL,
       49       49    1         2 CURR SBIN WORD UNAL,
       50       50    1         2 RC_PTR UBIN BYTE UNAL;
       51       51
       52       52
       53       53        /*  CONVERTION TABLE - FROM DATA_TYPE TO COMPARE_CODE */
       54       54    1   DCL FTYPE_TO_CC(0:19) UBIN(3) CONSTANT UNAL
       55       55    1    INIT(0,2,2,1,1, 0,3,2,0,0, 4,5,5,3,3, 0,0,0,0,0);
       56       56    1   DCL Y SBIN STATIC ALIGNED;
       57       57    1   DCL PSN CHAR(12) STATIC ALIGNED;
       58       58    1   DCL PSN_V CHAR(Y) BASED CALIGNED;
       59       59    1   DCL BUF_PTR SBIN STATIC ALIGNED;
       60       60    1   DCL DIR_REF REDEF BUF_PTR SBIN ALIGNED;
       61       61    1   DCL CURR_PAGE SBIN STATIC ALIGNED;
       62       62    1   DCL LAST_BAD_PAGE SBIN STATIC ALIGNED;
       63       63    1   DCL NEW_CURR_PAGE SBIN STATIC ALIGNED;
       64       64    1   DCL CHAR_V CHAR(X) BASED(REC2$) CALIGNED;
       65       65    1   DCL DMCL_TSTAMP CHAR(16) STATIC ALIGNED;
       66       66
       67       67    1   DCL CURR_SCHNM CHAR(30) SYMREF CALIGNED;
       68       68        %INCLUDE ZI_UWA_C;
       69      758         %ZI$UWAB;
       70     1098        %INCLUDE ZI_RVA_C;
       71     1779         %CAN_RVA_REF;
       72     2098        %INCLUDE ZI_GLOBAL_DBUTIL;
       73     2276         %SYS_FUNC;
       74     2368         %MISC_DCLS;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:3    
       75     2421        %INCLUDE ZI$DIR;
       76     2578         %DIR;
       77     2722        %INCLUDE ZI_DBU_XREF;
       78     2889         %XREF_TBLS;
       79     2964         %PA_XREF_TBLS;
       80     3030        %INCLUDE CP_6;
       81     3111         %B$EXCFR;
       82     3129         %B$TCB;
       83     3132         %F$DCB;
       84     3189         %FPT_READ(FPTN=READ_TEMP,BUF=STK,WAIT=YES,KEYR=YES,KEY=KEY);
       85     3228        %INCLUDE ZI$PG_STRUCTS;
       86     3331         %ATBLK_PG;
       87     3387         %DATA_PG;
       88     3406        %INCLUDE ZI_PRSE_SUBS;
       89     3562        %INCLUDE ZI_ERRORS_SUBS;
       90     4082        %INCLUDE CP_6_SUBS;
       91     4622
       92     4623    1   DCL DB_FUNC_FDR ENTRY(2) ALTRET;
       93     4624    1   DCL DB_FUNC_FOR ENTRY(1) ALTRET;
       94     4625    1   DCL DB_FUNC_GET ENTRY(1) ALTRET;
       95     4626    1   DCL DB_FUNC_FRS ENTRY(2) ALTRET;
       96     4627    1   DCL DB_FUNC_FRA ENTRY(1) ALTRET;
       97     4628    1   DCL DB_FUNC_FIN ENTRY ALTRET;
       98     4629
       99     4630        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:4    
      100     4631        %SUB DBALT = "ALTRET(DB_ALT)";
      101     4632        %SUB DB_FOR = DB_FUNC_FOR;
      102     4633        %SUB DB_GET = DB_FUNC_GET;
      103     4634        %SUB DB_FRS = DB_FUNC_FRS;
      104     4635        %SUB DB_FRA = DB_FUNC_FRA;
      105     4636        %SUB DB_FDR = DB_FUNC_FDR;
      106     4637        %SUB RVA = CAN_RVA;
      107     4638        %SUB UNTIL_END_OF_SET = "WHILE(UWA.DB_STATUS ~= '02100')";
      108     4639        /*
      109     4640              SUBR  SETUP_RA_RANGES
      110     4641                    LOOP THRU RCRA SET TO GET ALL AC RECORD
      111     4642                    SAVE THE HIGH AND LOW RANGES FOR EACH RA IN AC_TBL
      112     4643                    THEN MARK THE AREA IS TO BE OPENED
      113     4644        */
      114     4645    1   SETUP_RA_RANGES: PROC(PA_REC_RANGES) ALTRET;
      115     4646
      116     4647    2   DCL PA_REC_RANGES SBIN ALIGNED;
      117     4648
      118     4649    2       CALL DB_FRS(RVA.RAREC,RVA.RCRA) DBALT;
      119     4650    3       DO UNTIL_END_OF_SET;
      120     4651    3           CALL DB_GET(RVA.RAREC) DBALT;
      121     4652    3           CALL DB_FOR(RVA.ACRA) DBALT;
      122     4653    3           CALL DB_FOR(RVA.SNSE) DBALT;
      123     4654    3           CALL DB_GET(RVA.SNREC) DBALT;
      124     4655    3           X = 0;
      125     4656    4           DO WHILE(AC_TBL.NAME(X)~=UWA.SN_REC.SENAME);
      126     4657    4               X=X+1;
      127     4658    4               END;
      128     4659         /* SETUP RANGE IN PAGES FOR THAT AREA */
      129     4660    3           RB=(UWA.RA_REC.LDBK-AC_TBL.BASE_DBK(X)+AC_TBL.LPP(X)-1)/AC_TBL.LPP(X);
      130     4661    3           RE=(UWA.RA_REC.HDBK-AC_TBL.BASE_DBK(X)+AC_TBL.LPP(X)-1)/AC_TBL.LPP(X);
      131     4662    3           IF ADDR(PA_REC_RANGES)~=ADDR(NIL) THEN
      132     4663    4           DO; /* THE RANGES ARE SETUP FOR *PA_REC */
      133     4664    4               RB = 1; /* USE THE WHOLE AREA WHERE OWNERS ARE */
      134     4665    4               RE = 262143; /*  O777777 AS HIGH AS WE CAN GO */
      135     4666    4               END;
      136     4667    3           IF RB < AC_TBL.RANGE_LOW(X) THEN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:5    
      137     4668    3               AC_TBL.RANGE_LOW(X)=RB;
      138     4669    3           IF RE > AC_TBL.RANGE_HIGH(X) THEN
      139     4670    3               AC_TBL.RANGE_HIGH(X)=RE;
      140     4671    3           CALL DB_FRS(RVA.RAREC,RVA.RCRA) DBALT;
      141     4672    3           END;
      142     4673    2       RETURN;
      143     4674    2   DB_ALT: ALTRETURN;
      144     4675    2   END SETUP_RA_RANGES;
      145     4676        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:6    
      146     4677        /*
      147     4678              SUBR    OPEN_SCHEMA - OPEN SOURCE_SCHEMA OR TARGET_SCHEMA DCB
      148     4679                                    AND READ ATBLK PAGE TO GET INTERNAL NAME
      149     4680                                    THEN SETUP THAT DCB FOR IDS TO USE
      150     4681        */
      151     4682    1   OPEN_SCHEMA: PROC(TYPE_MSG) ALTRET;
      152     4683
      153     4684    2   DCL TYPE_MSG SBIN ALIGNED;
      154     4685
      155     4686    2       CALL GET_DCB(ZI$DIR.SCHEMA_NM) ALTRET(ALT);
      156     4687    2       FUNSF=%IN#;
      157     4688    2       SHARESF=%ALL#;
      158     4689    2       REASGNSF=%YES#;
      159     4690    2       CALL SYS_FUNC_OPEN ALTRET(ALT); /* OPEN SOURCE/TARGET DCB */
      160     4691    2       CALL READ_DB(0,0,1) ALTRET(ALT); /* READ ATBLK PAGE */
      161     4692    2       ATBLK$ = ADDR(I_O_BUF(0));
      162     4693    2       CALL SYS_FUNC_CLOS; /* CLOSE SOURCE DCB */
      163     4694    2       ZI$DIR.SCHEMA_NM.NAME.TEXT=ATBLK_PG.AREA_NM;
      164     4695    2       REC2$ = ADDR(DCBADDR(DCBSF)->F$DCB.NAME#.C); /* FILE NAME */
      165     4696    2       CALL INDEX1(X,' ',DCBADDR(DCBSF)->F$DCB.NAME#.C);
      166     4697    2       PSN=DCBADDR(DCBSF)->F$DCB.PSN#; /* GET PACK SET SN */
      167     4698    2       CALL INDEX1(Y,' ',PSN); /* CHK FOR BLANKS */
      168     4699    2       IF Y>0 THEN /* PACK SET IS NON-BLANK */
      169     4700    3       DO;
      170     4701    3           CALL CONCAT(PSN,'DP#',ADDR(DCBADDR(DCBSF)->F$DCB.PSN#)->PSN_V,'/');
      171     4702    3           Y=Y+4;
      172     4703    3           END;
      173     4704    2       CALL CONCAT(RBUF,'SET ',ZI$DIR.SCHEMA_NM.NAME.TEXT,ADDR(PSN)->PSN_V,
      174     4705    2          CHAR_V,'.',DCBADDR(DCBSF)->F$DCB.ACCT#);
      175     4706    2       CALL SYS_FUNC_RELDCB;
      176     4707    2       CALL ZIU$SYSCTL ALTRET(ALT);
      177     4708    2       IF READ_SW=1 THEN GOTO ALT; /* M$YC FAILED */
      178     4709    2       CALL CONCAT(RBUF,'R ',ZI$DIR.SCHEMA_NM.NAME.TEXT);
      179     4710    2       IF CURR_SCHNM~=ZI$DIR.SCHEMA_NM.NAME.TEXT AND
      180     4711    2          ADDR(TYPE_MSG)=ADDR(NIL) THEN
      181     4712    2           CALL ERROR_MSG(DBU#PASCH1,ZI$DIR.SCHEMA_NM.NAME.TEXT);
      182     4713    2       CURR_SCHNM = ZI$DIR.SCHEMA_NM.NAME.TEXT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:7    
      183     4714    2       CALL ZIU$Q2SC(,ZI$DIR.SCHEMA_NM.NAME.TEXT) ALTRET(ALT_RDY);
      184     4715    2       CALL ZIU$SYSCTL;
      185     4716    2       RETURN;
      186     4717    2   ALT_RDY: CALL ZIU$SYSCTL; /* RESET SCHEMA DCB */
      187     4718    2   ALT: ALTRETURN;
      188     4719    2   END OPEN_SCHEMA;
      189     4720        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:8    
      190     4721        /*
      191     4722              SUBR     GET_ALL_SC - EXTRACT ALL SET NAMES FROM SCHEMA
      192     4723        */
      193     4724    1   GET_ALL_SC: PROC ALTRET; /* ALTRETURN ON DB_ALT */
      194     4725
      195     4726    2       CALL DB_FRS(RVA.SCREC,RVA.OASC) DBALT;
      196     4727    3       DO UNTIL_END_OF_SET; /* LOOP THRU SC */
      197     4728    3           CALL DB_GET(RVA.SCREC) DBALT;
      198     4729    3           IF UWA.SC_REC.SETMODE=2 THEN /* PA SETS */
      199     4730    4           DO;
      200     4731    4               CALL DB_FOR(RVA.SNSE) DBALT;
      201     4732    4               CALL DB_GET(RVA.SNREC) DBALT; /* GET ITS NAME */
      202     4733    4               RCNT = RCNT+1;
      203     4734    4               RECORD_LIST.NAME(RCNT)=UWA.SN_REC.SENAME;
      204     4735    4               END;
      205     4736    3           CALL DB_FRS(RVA.SCREC,RVA.OASC) DBALT;
      206     4737    3           END;
      207     4738    2       RETURN;
      208     4739    2   DB_ALT: ALTRETURN;
      209     4740    2   END GET_ALL_SC;
      210     4741        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:9    
      211     4742        /*
      212     4743              SUBR    CHK_DMCL  -  FOR SECURITY REASON, WE WANT TO
      213     4744                      MAKE SURE THAT WHEN DOING RESTRUCTURE THE SOURCE AND
      214     4745                      TARGET SCHEMAS ARE GENERATED BY THE SAME DDL, IN
      215     4746                      ORDER TO ACHIEVE THIS, THE EASIEST WAY IS TO BE ABLE
      216     4747                      TO FIND THE DMCL TIME FOR THE SOURCE SCHEMA IN THE
      217     4748                      TARGET SCHEMA. IN OTHER WORD, THE TARGET IS THE SAME
      218     4749                      COPY OF THE SOURCE PLUS SOME ADDITIONAL DMCL OPERATIO.
      219     4750                      THIS WILL IMPOSE CERTAIN RESTICTIONS AND MAYBE INCONVIENCE
      220     4751                      SO WE HAVE ANOTHER FLAG ZI$DIR.SKIP_DMCL TO SKIP IT.
      221     4752        */
      222     4753    1   CHK_DMCL: PROC ALTRET;
      223     4754
      224     4755    2       CALL DB_FRS(RVA.ADREC,RVA.SFAD) DBALT;
      225     4756    3       DO UNTIL_END_OF_SET;
      226     4757    3           CALL DB_GET(RVA.ADREC) DBALT;
      227     4758    3           IF UWA.AD_REC.ADFUNC=2 AND
      228     4759    3              UWA.AD_REC.ADDATE_RD=DMCL_TSTAMP THEN
      229     4760    3               RETURN; /* SOURCE DMCL FOUND IN TARGET DMCL */
      230     4761    3           CALL DB_FRS(RVA.ADREC,RVA.SFAD) DBALT;
      231     4762    3           END;
      232     4763    2       CALL ERROR_MSG(DBU#PADMCLER,DMCL_TSTAMP);
      233     4764    2       ALTRETURN;
      234     4765    2   DB_ALT: UWA.SN_REC.SENAME=UWA.DB_STATUS;
      235     4766    2       CALL ERROR_MSG(DBU#DBERR,UWA.SN_REC.SENAME,COMMAND_TEXT);
      236     4767    2       ALTRETURN;
      237     4768    2   END CHK_DMCL;
      238     4769        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:10   
      239     4770        /*
      240     4771                      PROCESSING STARTS HERE
      241     4772        */
      242     4773    1       NO_AREAS=-1;
      243     4774    1       IF ZI$DIR.CODE=#COMPACT THEN
      244     4775    1           COMMAND_TEXT='COMPACT';
      245     4776    1       ELSE
      246     4777    1           IF ZI$DIR.CODE=#REBUILDPA THEN
      247     4778    1               COMMAND_TEXT='REBUILD';
      248     4779    1           ELSE
      249     4780    1               IF ZI$DIR.CODE=#CONVERT THEN
      250     4781    1                   COMMAND_TEXT='CONV_TO_PA';
      251     4782    1               ELSE
      252     4783    1                   IF ZI$DIR.CODE=#REVERT THEN
      253     4784    1                       COMMAND_TEXT='CONV_TO_CHAIN';
      254     4785    1                   ELSE
      255     4786    1                       COMMAND_TEXT='RESORT';
      256     4787
      257     4788    1       IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN
      258     4789    2       DO;
      259     4790    2           IF SCHEMA_ACTIVE THEN /* IF THERE IS A SCHEMA ACTIVE */
      260     4791    3           DO;
      261     4792    3               CALL DB_FUNC_FIN; /* CLOSE THIS SCHEMA */
      262     4793    3               SCHEMA_ACTIVE = '0'B; /* DIS-ACTIVE THAT SCHEMA */
      263     4794    3               IF XREF_BUILT THEN
      264     4795    4               DO;
      265     4796    4                   CALL FREE_DYN_MEM;
      266     4797    4                   XREF_BUILT='0'B;
      267     4798    4                   END;
      268     4799    3               END;
      269     4800    2           CURR_SCHNM=' ';
      270     4801    2           RBUF = 'DI SOURCE_SCHEMA,TARGET_SCHEMA';
      271     4802    2           CALL ZIU$SYSCTL ALTRET(ALT_ZIU$CMPT_INIT);
      272     4803    2           ZI$DIR.SCHEMA_NM.NAME.TEXT='SOURCE_SCHEMA';
      273     4804    2           CALL OPEN_SCHEMA ALTRET(ALT_ZIU$CMPT_INIT);
      274     4805    2           DMCL_TSTAMP=UWA.AD_REC.ADDATE_RD;
      275     4806    2           END;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:11   
      276     4807
      277     4808    1       IF ZI$DIR.CODE=#CONVERT THEN /* RESTRUCTURE SET MODE */
      278     4809    2       DO;
      279     4810    2           CALL GET_ALL_SC DBALT; /* GET ALL THE SET SORTED BY DEFINED KEYS */
      280     4811    2           CALL DB_FUNC_FIN ALTRET(ALT_ZIU$CMPT_INIT); /* RELEASE SOURCE SCHEMA */
      281     4812    2           ZI$DIR.SCHEMA_NM.NAME.TEXT='TARGET_SCHEMA';
      282     4813    2           CALL OPEN_SCHEMA ALTRET(ALT_ZIU$CMPT_INIT);
      283     4814    2           IF ZI$DIR.SKIP_DMCL_CHK='0'B THEN
      284     4815    2               CALL CHK_DMCL ALTRET(CLOSE_SCHEMA);
      285     4816    2           END;
      286     4817    1       ELSE
      287     4818    1           IF ZI$DIR.CODE=#REVERT THEN /* FROM PA TO NON-PA */
      288     4819    2           DO;
      289     4820    2               CALL DB_FUNC_FIN ALTRET(ALT_ZIU$CMPT_INIT);
      290     4821    2               ZI$DIR.SCHEMA_NM.NAME.TEXT='TARGET_SCHEMA';
      291     4822    2               CALL OPEN_SCHEMA ALTRET(ALT_ZIU$CMPT_INIT);
      292     4823    2               CALL GET_ALL_SC DBALT; /* GET ALL THE SET SORTED BY DEFINED KEYS */
      293     4824    2               IF ZI$DIR.SKIP_DMCL_CHK='0'B THEN
      294     4825    2                   CALL CHK_DMCL ALTRET(CLOSE_SCHEMA);
      295     4826    2               CALL DB_FUNC_FIN ALTRET(ALT_ZIU$CMPT_INIT); /* RELEASE TARGET SCHEMA */
      296     4827    2               ZI$DIR.SCHEMA_NM.NAME.TEXT='SOURCE_SCHEMA';
      297     4828    2               CALL OPEN_SCHEMA(X) ALTRET(ALT_ZIU$CMPT_INIT);
      298     4829    2               END;
      299     4830        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:12   
      300     4831        /*
      301     4832              BUILD AREA TABLE FIRST, AND THEN GO THRU OASC TO FIND SET WE WANTED
      302     4833        */
      303     4834    1       CALL DB_FDR(RVA.OAREC,UWA.SF_REC.DBKOA) DBALT;
      304     4835    1       CALL DB_FRS(RVA.ACREC,RVA.OAAC) DBALT;
      305     4836    2       DO UNTIL_END_OF_SET;
      306     4837    2           CALL DB_GET(RVA.ACREC) DBALT;
      307     4838    2           IF UWA.AC_REC.PG_TYPE>0 THEN GOTO NOT_IDS;
      308     4839    2           CALL DB_FOR(RVA.SNSE) DBALT;
      309     4840    2           CALL DB_GET(RVA.SNREC) DBALT;
      310     4841    2           IF NO_AREAS>=%MAX_AREAS THEN
      311     4842    2               GOTO AC_OVERFLOW; /* ABORT THE JOB, NO RECOVERY POSSIBLE */
      312     4843    2           NO_AREAS=NO_AREAS+1; /* BUMP COUNTER */
      313     4844    2           AC_TBL.NAME(NO_AREAS)=UWA.SN_REC.SENAME;
      314     4845    2           AC_TBL.DCB#(NO_AREAS)=0;
      315     4846    2           AC_TBL.LPP(NO_AREAS)=UWA.AC_REC.LPP; /* SAVE LINE PER PAGE */
      316     4847    2           AC_TBL.BASE_DBK(NO_AREAS)=UWA.AC_REC.BASE_DBK;
      317     4848    2           AC_TBL.RANGE_LOW(NO_AREAS)=%BITBIN('777777777'O); /* TO MAX */
      318     4849    2           AC_TBL.RANGE_HIGH(NO_AREAS)=0; /* INIT TO MIN */
      319     4850    2           AC_TBL.LNLP(NO_AREAS)=
      320     4851    2              MOD(UWA.AC_REC.MAX_DBK-UWA.AC_REC.MIN_DBK+1,UWA.AC_REC.LPP);
      321     4852    2           IF AC_TBL.LNLP(NO_AREAS)=0 THEN
      322     4853    2               AC_TBL.LNLP(NO_AREAS)=UWA.AC_REC.LPP;
      323     4854    2           AC_TBL.PAGE_WRITTEN(NO_AREAS)='0'B;
      324     4855    2           AC_TBL.CHECKSUM(NO_AREAS)=UWA.AC_REC.SWS.CHECKSUM;
      325     4856    2   NOT_IDS: CALL DB_FRS(RVA.ACREC,RVA.OAAC) DBALT;
      326     4857    2           END; /* AC_TBL BUILT */
      327     4858
      328     4859        /*
      329     4860              NOW, CREATE ALL TABLES BY GOING FROM ALL THE SC
      330     4861              IF A SC FOR A PA_SET IS FOUND AND IS TO BE PROCESSED,
      331     4862              WE WILL GET ALL ITS SM AND THEN ALL THE CF AS WELL AS THE
      332     4863              RA SO WE ONLY OPEN THE AREAS THAT HAVE PA MEMBERS IN IT
      333     4864        */
      334     4865    1       TYPE='0'B; /* INIT THIS TABLE */
      335     4866    1       MAX_KEY_SIZE=0; /* INIT TO MIN */
      336     4867    1       SC_PTR=-1;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:13   
      337     4868    1       RC_PTR=0; /* THIS TABLE STARTS FROM INDX=1 */
      338     4869    1       KEY_PTR=-1;
      339     4870    1       IF ZI$DIR.INIT_TMPLT_KEY=0 THEN /* NO PERCENT TO PACK SPECIFIED */
      340     4871    1           ZI$DIR.INIT_TMPLT_KEY=85; /* USE DEFAULT */
      341     4872    1       ELSE
      342     4873    1           IF ZI$DIR.INIT_TMPLT_KEY>100 THEN
      343     4874    2           DO;
      344     4875    2               ZI$DIR.INIT_TMPLT_KEY=85; /* DEFAULT FULL PERCENT=85 */
      345     4876    2               CALL ERROR_MSG(DBU#PAPER85);
      346     4877    2               END;
      347     4878    1       CALL DB_FDR(RVA.SFREC,2) DBALT; /* SETUP CURR OF AREA */
      348     4879    1       CALL DB_FRA(RVA.SNREC) DBALT;
      349     4880    1       DIR_REF = UWA.DIR_REF; /* SAVE CURR OF AREA */
      350     4881    2       DO UNTIL_END_OF_SET;
      351     4882    2           CALL DB_GET(RVA.SNREC) DBALT;
      352     4883    2           IF UWA.SN_REC.SETYPE~=30 THEN GOTO NEXT_SC; /* NOT SN FOR SC */
      353     4884    2           CALL DB_FRS(RVA.SCREC,RVA.SNSE) DBALT;
      354     4885    2           CALL DB_GET(RVA.SCREC) DBALT;
      355     4886        /*       CHECK WETHER THIS SC IS SELECTED OR NOT */
      356     4887    2           X = RCNT + 1; /* ASSUME THIS SC NOT INCLUDED */
      357     4888    2           IF UWA.SC_REC.SETORD>3 THEN /* SET IS SORTED */
      358     4889    2               IF (ZI$DIR.CODE~=#RESORT AND UWA.SC_REC.SETMODE=2) OR
      359     4890         /* COMMAND IS PA RELATED AND SET IS INDEED PA SET */
      360     4891    2                  (ZI$DIR.CODE=#RESORT AND UWA.SC_REC.SETMODE~=2) THEN
      361     4892         /* COMMAND IS NON-PA AND SET FOUND IS NON-PA */
      362     4893    3               DO;
      363     4894    3                   IF RCNT = -1 THEN
      364     4895    3                       X = -1; /* NO SET-NAME-LIST, SO ALL INCLUDED */
      365     4896    3                   ELSE
      366     4897    4                   DO Y=0 TO RCNT; /* SEARCH THRU SET-NAME-LIST */
      367     4898    4                       IF RECORD_LIST.NAME(Y)=UWA.SN_REC.SENAME THEN
      368     4899    5                       DO;
      369     4900    5                           X=Y;
      370     4901    5                           Y=RCNT+1;
      371     4902    5                           RECORD_LIST.NAME(X)=' ';
      372     4903    5                           IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN
      373     4904    5                               GOTO NEXT_SC; /* CANCEL OUT THIS PA (NO CHANGED) */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:14   
      374     4905    5                           END;
      375     4906    4                       END;
      376     4907    3                   IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN
      377     4908    3                       X = -1;
      378     4909    3                   END;
      379     4910    2           IF X <= RCNT THEN
      380     4911    3           DO; /* THIS  SET IS TO BE PROCESSED */
      381     4912    3               SC_PTR=SC_PTR+1;
      382     4913    3               IF SC_PTR>%MAX_PA_SET THEN
      383     4914    3                   GOTO SC_OVERFLOW; /* SC TBL OVERFLOW */
      384     4915    3               SC_TBL.NAME(SC_PTR)=SUBSTR(UWA.SN_REC.SENAME,0,15);
      385     4916    3               SC_TBL.GLOBAL(SC_PTR)=UWA.SC_REC.SETGLO;
      386     4917    3               IF UWA.SC_REC.SETMODE=2 THEN
      387     4918    3                   SC_TBL.SETYPE(SC_PTR)=0; /* SET TYPE IS PA */
      388     4919    3               ELSE
      389     4920    3                   IF UWA.SC_REC.SETORD=4 THEN /* SORT BY DEFINED KEYS */
      390     4921    3                       SC_TBL.SETYPE(SC_PTR)=1;
      391     4922    3                   ELSE /* SORT BY DEFINED KEYS WITHIN RECORDS */
      392     4923    3                       SC_TBL.SETYPE(SC_PTR)=2;
      393     4924    3               CALL DB_FRS(RVA.SOREC,RVA.SCSOSM) DBALT;
      394     4925    3               CALL DB_GET(RVA.SOREC) DBALT; /* GET SC_OWNER */
      395     4926    3               CALL DB_FOR(RVA.RCSOSM) DBALT;
      396     4927    3               CALL DB_GET(RVA.RCREC) DBALT; /* GET RC OF OWNER */
      397     4928    3               RC_PTR = RC_PTR + 1; /* STORE OWNER INFO IN RC_TBL */
      398     4929    3               IF RC_PTR>%MAX_PA_MEM THEN
      399     4930    3                   GOTO RC_OVERFLOW;
      400     4931    3               SC_TBL.RC_PTR(SC_PTR)=RC_PTR; /* SC_TBL LINKED TO OWNER */
      401     4932    3               SC_TBL.NO_OF_SM(SC_PTR)=0;
      402     4933    3               RC_TBL.NXPNT_EIS(RC_PTR)=UWA.SO_REC.NXTPNT;
      403     4934    3               RC_TBL.SC_PTR(RC_PTR)=SC_PTR; /* BACKWARD LINK */
      404     4935    3               RC_TBL.TYPE(RC_PTR)=UWA.RC_REC.RTYPE; /* TYPE OF OWNER */
      405     4936    3               RC_TBL.RC_NEXT(RC_PTR)=0;
      406     4937        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:15   
      407     4938        /*
      408     4939              FOR RO RECORD, PROCESS ALL DIFFERENT DEPENDING DIRECTIVE
      409     4940              1) COMPACT - LINK RO TO TYPE TABLE, IMPLIES WE ARE SEARCHING
      410     4941                           ALL RO RECORDS. THEN SETUP THE RA RANGES FOR THE
      411     4942                           AREAS TO OPEN.
      412     4943              2) RESORT  - LINK RO TO SC_TBL SO THAT WE KNOW THE RECORD TYPE
      413     4944                           OF EACH SET.  THEREFORE OWNER RECORD WILL NOT BE
      414     4945                           SEARCHED FOR IN THE FIRST PASS.
      415     4946              3) REBUILD - LINK RO TO SC_TBL AS RESORT DOES, BUT ALSO FIND
      416     4947                           ALL THE RA FOR THE RO AND SETUP THE FULL PAGE RANGE
      417     4948                           FOR THE AREAS TO OPEN BECAUSE WE WANT TO SEARCH
      418     4949                           ALL THE *PA_REC IN THE FIRST PASS TO ERASE THEM.
      419     4950                           (NOTE: ALL *PA_REC STORED VIA OWNERS ).
      420     4951              4) CONVERT - LINK RO TO SC_TBL AS RESORT DOES. HOWEVER, WE
      421     4952                           DONOT WANT TO WASTE TIME TO SEARCH FOR *PA_REC
      422     4953                           IN THE FIRST PASS. (*PA_REC IS ILLEGAL AND IS NOT
      423     4954                           SUPPOSE IN THE DATABASE).
      424     4955              5) REVERT  - LINK RO TO TYPE TABLE LIKE COMPACT FOR WE EXTRACT
      425     4956                           OWNER INSTEAD OF MEMBER. THIS IS REVERT PA SET TO
      426     4957                           NON-PA, NOTICE THE CHANGE OF SIZE OF ALL MEMBERS.
      427     4958        */
      428     4959        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:16   
      429     4960    3               IF ZI$DIR.CODE=#COMPACT OR ZI$DIR.CODE=#REVERT THEN
      430     4961    4               DO; /* LINK OWNER RC TO TYPE TABLE */
      431     4962    4                   X=TYPE.MSTRINDX(UWA.RC_REC.RTYPE);
      432     4963    4                   IF X=0 THEN /* 1ST RO FOR THAT RECORD */
      433     4964    5                   DO; /* GET RA AND SETUP RANGE */
      434     4965    5                       TYPE.MSTRINDX(UWA.RC_REC.RTYPE)=RC_PTR;
      435     4966    5                       CALL SETUP_RA_RANGES DBALT;
      436     4967    5                       END;
      437     4968    4                   ELSE
      438     4969    5                   DO WHILE(X>0); /* WALK TO THE TAIL */
      439     4970    5                       IF RC_TBL.RC_NEXT(X)>0 THEN
      440     4971    5                           X=RC_TBL.RC_NEXT(X);
      441     4972    5                       ELSE
      442     4973    6                       DO;
      443     4974    6                           RC_TBL.RC_NEXT(X)=RC_PTR;
      444     4975    6                           X=0;
      445     4976    6                           END;
      446     4977    5                       END;
      447     4978    4                   END;
      448     4979    3               CALL DB_FRS(RVA.SMREC,RVA.SCSOSM) DBALT;
      449     4980         /* NOW, LOOP THRU ALL SM */
      450     4981    4               DO UNTIL_END_OF_SET;
      451     4982    4                   CALL DB_GET(RVA.SMREC) DBALT;
      452     4983    4                   CALL DB_FOR(RVA.RCSOSM) DBALT;
      453     4984    4                   CALL DB_GET(RVA.RCREC) DBALT;
      454     4985    4                   RC_PTR=RC_PTR+1; /* GET ANOTHER RS */
      455     4986    4                   IF RC_PTR>%MAX_PA_MEM THEN
      456     4987    4                       GOTO RC_OVERFLOW;
      457     4988    4                   RC_TBL.RC_NEXT(RC_PTR)=0; /* TAIL OF THE CHAIN */
      458     4989    4                   RC_TBL.TYPE(RC_PTR)=UWA.RC_REC.RTYPE;
      459     4990    4                   RC_TBL.NXPNT_EIS(RC_PTR)=UWA.SM_REC.NXTPNT;
      460     4991    4                   IF UWA.SM_REC.INSTYPE=0 AND UWA.SM_REC.RETTYPE=0 THEN
      461     4992    4                       RC_TBL.MANUAL(RC_PTR)=0; /* UNCONNECTED MEM NOT POSSIBLE */
      462     4993    4                   ELSE
      463     4994    4                       RC_TBL.MANUAL(RC_PTR)=1; /* POSSIBLY UNCONNECTED MEM */
      464     4995    4                   IF UWA.SM_REC.SEQDUP=2 THEN
      465     4996    4                       RC_TBL.DUPIND(RC_PTR)=1; /* DUPIND SAYS YES */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:17   
      466     4997    4                   ELSE
      467     4998    4                       RC_TBL.DUPIND(RC_PTR)=0;
      468     4999    4                   RC_TBL.SC_PTR(RC_PTR)=SC_PTR; /* POINT TO SC OWNER */
      469     5000    4                   SC_TBL.NO_OF_SM(SC_PTR)=SC_TBL.NO_OF_SM(SC_PTR)+1;
      470     5001    4                   IF ZI$DIR.CODE=#COMPACT THEN
      471     5002    4                       GOTO NEXT_SM;
      472     5003    4                   IF ZI$DIR.CODE=#REVERT THEN
      473     5004    5                   DO;
      474     5005    5                       IF UWA.SM_REC.INSTYPE=1 OR UWA.SM_REC.RETTYPE=1 THEN
      475     5006    6                       DO; /* UNCONNECTED MEMBERS MAY EXIST IN DATABASE */
      476     5007    6                           CALL SETUP_RA_RANGES DBALT;
      477     5008    6                           KEY_PTR=KEY_PTR+1; /* SEQ SEARCH FOR IT */
      478     5009    6                           KEY_TBL.EIS(KEY_PTR)=RC_PTR;
      479     5010    6                           END;
      480     5011    5                       GOTO NEXT_SM;
      481     5012    5                       END;
      482     5013    4                   RC_TBL.KEY_PTR(RC_PTR)=KEY_PTR+1;
      483     5014    4                   X=TYPE.MSTRINDX(UWA.RC_REC.RTYPE);
      484     5015    4                   Y=0;
      485     5016    4                   IF X=0 THEN /* FIRST RS FOR THAT RC */
      486     5017    5                   DO; /* SO GET THE RA AND SETUP RANGE */
      487     5018    5                       TYPE.MSTRINDX(UWA.RC_REC.RTYPE)=RC_PTR;
      488     5019    5                       CALL SETUP_RA_RANGES DBALT;
      489     5020    5                       END;
      490     5021    4                   ELSE
      491     5022    5                   DO WHILE(X>0); /* WALK TO THE TAIL */
      492     5023    5                       Y = X; /* SAVE X */
      493     5024    5                       X = RC_TBL.RC_NEXT(X);
      494     5025    5                       IF X=0 THEN /* END OF CHAIN */
      495     5026    5                           RC_TBL.RC_NEXT(Y)=RC_PTR;
      496     5027    5                       END;
      497     5028    4                   CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;
      498     5029    4                   X=0;
      499     5030    4                   Y=0; /* BYTE OFFSET FOR KEY IN SORT_REC */
      500     5031    5                   DO UNTIL_END_OF_SET;
      501     5032    5                       CALL DB_GET(RVA.CFREC) DBALT;
      502     5033    5                       CALL DB_FOR(RVA.FRCFS) DBALT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:18   
      503     5034    5                       CALL DB_GET(RVA.FRREC) DBALT; /* GOT A KEY FIELD */
      504     5035         /* EACH FR IS A SORT KEY FOR THE PA SET */
      505     5036    5                       X=X+1;
      506     5037    5                       KEY_PTR=KEY_PTR+1;
      507     5038    5                       KEY_TBL.EIS(KEY_PTR)=UWA.FR_REC.BUFLOC; /* KEY EIS */
      508     5039    5                       IF ZI$DIR.CODE=#RESORT THEN /* NON-PA */
      509     5040    6                       DO;
      510     5041    6                           KEY_PTR=KEY_PTR+1; /* SAVE EIS OF KEY IN SORT_REC */
      511     5042    6                           KEY_TBL.EIS(KEY_PTR)=UWA.FR_REC.BUFLOC;
      512     5043    6                           KEY_TBL.EIS_REDEF.OFST(KEY_PTR)=Y;
      513     5044         /* LETS FIGURE OUT BYTE SIZE OF THIS KEY */
      514     5045    7                           DO CASE(UWA.FR_REC.FTYP);
      515     5046    7                           CASE(0,1,11); /* DBKEY,BIN WD,FLOAT SNGL */
      516     5047    7                               Y=Y+4; /* 4 BYTES DATA */
      517     5048    7                           CASE(2); /* BIN HALF */
      518     5049    7                               Y=Y+2; /* TWO BYTES */
      519     5050    7                           CASE(7,12); /* BIN DOUB,FLOAT DUBL */
      520     5051    7                               Y=Y+8; /* 8 BYTES DATA */
      521     5052    7                           CASE(5,9,19); /* CHAR,9 BITS UNIT,CHAR VAR */
      522     5053    7                               Y=KEY_TBL.EIS_REDEF.SIZE(KEY_PTR)+Y;
      523     5054    7                           CASE(10); /* BIT STRING */
      524     5055    7                               Y=Y+(KEY_TBL.EIS_REDEF.SIZE(KEY_PTR)+8)/9;
      525     5056    7                           CASE(3,4,14,15,16); /* PACKED STUFF */
      526     5057    7                               Y=Y+KEY_TBL.EIS_REDEF.SIZE(KEY_PTR)/2+1;
      527     5058    7                           CASE(ELSE);
      528     5059    7                               X=UWA.FR_REC.FTYP;
      529     5060    7                               CALL DB_FOR(RVA.SNSE) DBALT;
      530     5061    7                               CALL DB_GET(RVA.SNREC) DBALT;
      531     5062    7                               CALL BIN_CHAR(1,X);
      532     5063    7                               CALL ERROR_MSG(DBU#PAERROR1,UWA.SN_REC.SENAME,
      533     5064    7                                  COMMAND_TEXT);
      534     5065    7                               ALTRETURN; /* ERROR THIS STEP FOR BAD FTYP */
      535     5066    7                               END;
      536     5067    6                           KEY_TBL.EIS_REDEF.CC(KEY_PTR)=FTYPE_TO_CC(UWA.FR_REC.FTYP);
      537     5068    6                           KEY_TBL.EIS_REDEF.DESCEND(KEY_PTR)=UWA.CF_REC.CTLSEQ;
      538     5069    6                           END;
      539     5070    5                       IF KEY_PTR>%MAX_PA_KEY THEN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:19   
      540     5071    5                           GOTO KEY_OVERFLOW;
      541     5072    5                       CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;
      542     5073    5                       END;
      543     5074    4                   IF UWA.SC_REC.SETMODE~=2 AND MAX_KEY_SIZE<Y THEN
      544     5075    4                       MAX_KEY_SIZE=Y; /* Y IS # OF WORDS FOR ALL KEYS */
      545     5076    4                   SC_TBL.PA_KEYSIZE(SC_PTR)=Y; /* SAVE TOTAL KEY_SIZE */
      546     5077    4                   RC_TBL.NO_OF_KEYS(RC_PTR)=X; /* FOR SORT WITHIN RECORD */
      547     5078    4   NEXT_SM: /* NEXT RC WOULD BE RC FOR *PA IF PA SET */
      548     5079    4                   IF UWA.SC_REC.SETMODE=2 THEN /* SET IS PA,SKIP SM *PA_REC */
      549     5080    4                       CALL DB_FRS(RVA.SMREC,RVA.SCSOSM) DBALT;
      550     5081    4                   CALL DB_FRS(RVA.SMREC,RVA.SCSOSM) DBALT;
      551     5082    4                   END; /* PROCESS ALL SM FOR A SC */
      552     5083
      553     5084         /* IF SET IS A PA_SET THEN WE WILL
      554     5085            CREATE EIS FOR EACH KEY IN THE SORT_REC */
      555     5086    3               IF UWA.SC_REC.SETMODE=2 THEN
      556     5087    4               DO; /* AT THIS POINT, CURRENT SCSOSM IS A SM FOR *PA_REC */
      557     5088    4                   CALL DB_FOR(RVA.RCSOSM) DBALT;
      558     5089    4                   CALL DB_GET(RVA.RCREC) DBALT;
      559     5090    4                   SC_TBL.PA_TYPE(SC_PTR)=UWA.RC_REC.RTYPE;
      560     5091    4                   SC_TBL.PA_RECSIZE(SC_PTR)=UWA.RC_REC.LSIZE;
      561     5092    4                   SC_TBL.PA_PTRSIZE(SC_PTR)=(UWA.RC_REC.PA_OFFSET-8)/3;
      562     5093    4                   SC_TBL.PA_KEYSIZE(SC_PTR)=UWA.RC_REC.PA_ENTRY-SC_TBL.PA_PTRSIZE(
      563     5094    4                      SC_PTR)-2;
      564     5095    4                   IF UWA.RC_REC.PA_ENTRY>MAX_KEY_SIZE THEN
      565     5096    4                       MAX_KEY_SIZE=UWA.RC_REC.PA_ENTRY;
      566     5097         /* CALCULATE HOW FULL TO PACK A PA_REC */
      567     5098    4                   Y=UWA.RC_REC.LSIZE-UWA.RC_REC.PA_OFFSET; /* PA SIZE */
      568     5099    4                   X=(Y*ZI$DIR.INIT_TMPLT_KEY)/100; /* BYTES TO USED */
      569     5100    4                   IF X < 3*UWA.RC_REC.PA_ENTRY THEN /* LESS THEN 3 ENTRIES */
      570     5101    4                       X = 3*UWA.RC_REC.PA_ENTRY; /* AT LEAST 3 ENTRIES */
      571     5102    4                   SC_TBL.FULL_PERCENT(SC_PTR)=Y-X;
      572     5103    4                   SC_TBL.KEY_PTR(SC_PTR)=KEY_PTR+1;
      573     5104    4                   IF ZI$DIR.CODE~=#COMPACT AND ZI$DIR.CODE~=#REVERT THEN
      574     5105    5                   DO;
      575     5106         /* MARK A ERASE INDICATOR IN TYPE TABLE FOR ALL *PA */
      576     5107    5                       TYPE.MSTRINDX(UWA.RC_REC.RTYPE)=-1*SC_PTR-1; /* NEG IT */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:20   
      577     5108    5                       IF ZI$DIR.CODE=#REBUILDPA THEN
      578     5109    5                           CALL SETUP_RA_RANGES(X) DBALT;
      579     5110         /* FOR WE WANT TO ERASE THEM */
      580     5111    5                       SC_TBL.NO_OF_KEYS(SC_PTR)=0;
      581     5112    5                       CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;
      582     5113    6                       DO UNTIL_END_OF_SET;
      583     5114    6                           CALL DB_GET(RVA.CFREC) DBALT;
      584     5115    6                           CALL DB_FOR(RVA.FRCFS) DBALT;
      585     5116    6                           CALL DB_GET(RVA.FRREC) DBALT; /* SYN FR */
      586     5117    6                           SC_TBL.NO_OF_KEYS(SC_PTR)=SC_TBL.NO_OF_KEYS(SC_PTR)+1;
      587     5118    6                           KEY_PTR=KEY_PTR+1;
      588     5119    6                           IF KEY_PTR>%MAX_PA_KEY THEN
      589     5120    6                               GOTO KEY_OVERFLOW;
      590     5121    6                           KEY_TBL.EIS(KEY_PTR)=UWA.FR_REC.BUFLOC;
      591     5122    6                           KEY_TBL.EIS_REDEF.CC(KEY_PTR)=FTYPE_TO_CC(UWA.FR_REC.FTYP);
      592     5123    6                           X=KEY_TBL.EIS_REDEF.OFST(KEY_PTR);
      593     5124    6                           X=X-2-SC_TBL.PA_PTRSIZE(SC_PTR); /* MAKE OFFSET REL 0 */
      594     5125    6                           KEY_TBL.EIS_REDEF.OFST(KEY_PTR)=X;
      595     5126    6                           KEY_TBL.EIS_REDEF.DESCEND(KEY_PTR)=UWA.CF_REC.CTLSEQ;
      596     5127    6                           CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;
      597     5128    6                           END;
      598     5129    5                       END;
      599     5130    4                   END;
      600     5131    3               END; /* DONE WITH THIS SC WHICH IS WANTED */
      601     5132    2   NEXT_SC: CALL DB_FDR(RVA.NULL,DIR_REF) DBALT; /* RESTORE CUR_AREA */
      602     5133    2           CALL DB_FRA(RVA.SNREC) DBALT;
      603     5134    2           DIR_REF = UWA.DIR_REF;
      604     5135    2           END; /* FINISHED EXTRACTING ALL SC IN SCHEMA */
      605     5136        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:21   
      606     5137        /*
      607     5138              CHECK IF ANY USER SPECIFIED SET AND NOT PROCESSED
      608     5139        */
      609     5140    1       ERRCODESF.ERR#=0; /* SET TO 'NO' */
      610     5141    2       DO X=0 TO RCNT;
      611     5142    2           IF RECORD_LIST.NAME(X)~=' ' THEN
      612     5143    3           DO;
      613     5144    3               IF ZI$DIR.CODE=#RESORT THEN
      614     5145    3                   CALL ERROR_MSG(DBU#NOTPASET,RECORD_LIST.NAME(X),
      615     5146    3                      CURR_SCHNM,'SORTED ');
      616     5147    3               ELSE
      617     5148    3                   IF ZI$DIR.CODE=#CONVERT THEN
      618     5149    3                       CALL ERROR_MSG(DBU#PADCBCON,RECORD_LIST.NAME(X),
      619     5150    3                          'PA ','CHAIN ');
      620     5151    3                   ELSE
      621     5152    3                       IF ZI$DIR.CODE=#REVERT THEN
      622     5153    3                           CALL ERROR_MSG(DBU#PADCBCON,RECORD_LIST.NAME(X),
      623     5154    3                              'CHAIN ','PA ');
      624     5155    3                       ELSE
      625     5156    3                           CALL ERROR_MSG(DBU#NOTPASET,RECORD_LIST.NAME(X),
      626     5157    3                              CURR_SCHNM,'PA ');
      627     5158    3               END;
      628     5159    2           END;
      629     5160    1       IF ERRCODESF.ERR# > 0 THEN
      630     5161    1           GOTO CLOSE_SCHEMA;
      631     5162    1       IF SC_PTR=-1 THEN /* NOTHING TO DO */
      632     5163    2       DO;
      633     5164    2           IF ZI$DIR.CODE=#RESORT THEN
      634     5165    2               UWA.SN_REC.SENAME='SORTED';
      635     5166    2           ELSE
      636     5167    2               IF ZI$DIR.CODE=#CONVERT THEN
      637     5168    2                   UWA.SN_REC.SENAME='new_DMCLed_PA';
      638     5169    2               ELSE
      639     5170    2                   IF ZI$DIR.CODE=#REVERT THEN
      640     5171    2                       UWA.SN_REC.SENAME='new_DMCLed_SORTED';
      641     5172    2                   ELSE
      642     5173    2                       UWA.SN_REC.SENAME='PA';
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:22   
      643     5174    2           CALL ERROR_MSG(DBU#NONPA,CURR_SCHNM,UWA.SN_REC.SENAME);
      644     5175    2           GOTO CLOSE_SCHEMA;
      645     5176    2           END;
      646     5177    1       IF BREAK_FLAG>0 THEN /* IF USER HIT BREAK KEY */
      647     5178    1           ALTRETURN; /* TERMINATE PROCESSING */
      648     5179    1       NO_SETS = SC_PTR; /* SAVE TOTAL NUMBER OF SET TO PROCESS */
      649     5180        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:23   
      650     5181         /* IF COMMAND IS CONVERT THEN ALL EIS FOR POINTERS AND
      651     5182            FOR KEYS MUST BE REARRANGED. CAUSE THIS IS A PARTIAL
      652     5183            RESTRUCTURE. AND SCHEMA IS NEWLY DMCL'ED, IT DOESNOT
      653     5184            REFLECT THE FORMAT OF RECORD IN DATABASE RIGHT */
      654     5185    1       IF ZI$DIR.CODE=#CONVERT THEN
      655     5186    2       DO Y=0 TO 4000; /* GO THRU ALL TYPES */
      656     5187    2           X = TYPE.MSTRINDX(Y);
      657     5188    2           IF X>0 THEN /* FIND A SM */
      658     5189    3           DO;
      659     5190    3               RB = 0; /* A COUNT OF NO OF SC FOR THIS SM */
      660     5191    4               DO WHILE(X>0);
      661     5192    4                   RC_TBL.REDEF_NEXT.OFST(X)=RC_TBL.REDEF_NEXT.OFST(X)+RB;
      662     5193    4                   RC_TBL.BYTES_SHIFT(X)=RB; /* SAVE THIS INFO */
      663     5194    4                   RB = RB+SC_TBL.PA_PTRSIZE(RC_TBL.SC_PTR(X));
      664     5195    4                   X = RC_TBL.RC_NEXT(X); /* GO TO NEXT SC */
      665     5196    4                   END;
      666     5197         /* NOW, RB = # BYTES TO ADD KEY_EIS TO FRAME OLD KEYS */
      667     5198    3               X = TYPE.MSTRINDX(Y);
      668     5199    4               DO WHILE(X>0); /* GO THRU ALL SC AGAIN */
      669     5200    4                   RE = RC_TBL.KEY_PTR(X); /* POINTS TO FIRST KEY_EIS */
      670     5201    4                   REC_CNT=RC_TBL.NO_OF_KEYS(X); /* AND NO OF KEYS */
      671     5202    5                   DO WHILE(REC_CNT>0);
      672     5203    5                       KEY_TBL.EIS_REDEF.OFST(RE)=KEY_TBL.EIS_REDEF.OFST(RE)+RB;
      673     5204    5                       RE = RE+1; /* NEXT KEY */
      674     5205    5                       REC_CNT = REC_CNT - 1;
      675     5206    5                       END;
      676     5207    4                   X = RC_TBL.RC_NEXT(X); /* NEXT SM */
      677     5208    4                   END;
      678     5209    3               END;
      679     5210    2           END; /* DO LOOP OF TYPE TABLE */
      680     5211
      681     5212        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:24   
      682     5213    1       IF XREF_BUILT = %YES# THEN
      683     5214    1           CALL FREE_DYN_MEM; /* RELEASE ALL MEMORY WE CAN THINK OF */
      684     5215    1       XREF_BUILT = %NO#;
      685     5216    1       CALL DB_FUNC_FIN DBALT;
      686     5217    1       SCHEMA_ACTIVE='0'B; /* SET TO NO SCHEMA IN CONTROL */
      687     5218    1       IF BREAK_FLAG>0 THEN ALTRETURN; /* LAST CHANCE FOR CLEAN EXIT */
      688     5219    1       RB=0; /* KEEP A COUNT OF PAGES TO READ */
      689     5220    1       RE=0; /* KEEP A COUNT OF AREAS TO OPEN */
      690     5221    2       DO AC_PTR=0 TO NO_AREAS;
      691     5222    2           IF AC_TBL.RANGE_HIGH(AC_PTR)>0 THEN
      692     5223    2               CALL OPEN_AREA ALTRET(ALT_ZIU$CMPT_INIT);
      693     5224    2           IF AC_TBL.RANGE_HIGH(AC_PTR)>0 THEN
      694     5225         /* MAY NOT BE > 0 AFTER OPEN_AREA */
      695     5226    3           DO;
      696     5227    3               RE=RE+1; /* INCREMENT NO_OF_AREAS TO BE OPENED */
      697     5228    3               RB=RB+AC_TBL.RANGE_HIGH(AC_PTR)-AC_TBL.RANGE_LOW(AC_PTR)+1;;
      698     5229    3               END;
      699     5230    2           END; /* ALL AREAS TO BE PROCESSED OPENED */
      700     5231    1       CALL BIN_CHAR(0,NO_SETS+1);
      701     5232    1       CALL BIN_CHAR(1,RB);
      702     5233    1       CALL BIN_CHAR(2,RE); /* NO_AREAS */
      703     5234    1       IF ZI$DIR.CODE=#COMPACT THEN
      704     5235    1           X=DBU#TOTPA;
      705     5236    1       ELSE
      706     5237    1           IF ZI$DIR.CODE=#RESORT THEN /* GIVE EXECUTING MSG */
      707     5238    1               X=DBU#TOTSSET;
      708     5239    1           ELSE
      709     5240    1               IF ZI$DIR.CODE=#REBUILDPA THEN
      710     5241    1                   X=DBU#TOTRSET;
      711     5242    1               ELSE
      712     5243    1                   IF ZI$DIR.CODE=#REVERT THEN
      713     5244    1                       X=DBU#TOTRVSET;
      714     5245    1                   ELSE
      715     5246    1                       X=DBU#TOTCSET; /* CONVERTing */
      716     5247    1       CALL ERROR_MSG(X); /* %U1,U2,U3 SETUP ABOVE */
      717     5248    1   RET: RETURN; /* RETURN TO SUB DRIVER, THEN GOTO ZIU$COMPACT */
      718     5249        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:25   
      719     5250        /*E*  ERROR: ZIU-DBU#TOTPA-C
      720     5251            MESSAGE:COMPACTing - %U1 pointer array sets:
      721     5252                                 %U2 pages to read in %U3 areas. */
      722     5253        /*E*  ERROR: ZIU-DBU#TOTSSET-C
      723     5254            MESSAGE:RESORTing - %U1 sorted sets:
      724     5255                                %U2 pages to read in %U3 areas. */
      725     5256        /*E*  ERROR: ZIU-DBU#TOTRVSET-C
      726     5257            MESSAGE:
      727     5258                    CONVERTing - %U1 PA mode sorted sets to CHAIN,
      728     5259                                 %U2 pages to read in %U3 areas. */
      729     5260        /*E*  ERROR: ZIU-DBU#TOTCSET-C
      730     5261            MESSAGE:
      731     5262                    CONVERTing - %U1 sorted sets to PA mode,
      732     5263                                 %U2 pages to read in %U3 areas. */
      733     5264        /*E*  ERROR: ZIU-DBU#TOTRSET-C
      734     5265            MESSAGE:REBUILDing - %U1 pointer array sets:
      735     5266                                 %U2 pages to read in %U3 areas. */
      736     5267        /*E*  ERROR: ZIU-DBU#PADCBCON-C
      737     5268        MESSAGE:
      738     5269                 The set "%U1" is a %U2 set in source schema, but %U3 in target.
      739     5270                 If converting from CHAIN to PA, the mode of this set should
      740     5271                 be described the other way around.
      741     5272                 Check your DCB assignments for source and target schemas. */
      742     5273        /*E*  ERROR: ZIU-DBU#PADMCLER-C
      743     5274        MESSAGE:
      744     5275                 Schema inconsistency detected.  The possible errors are:
      745     5276                 1)  Source and target schema DCBs are set the other way around.
      746     5277                 2)  The target schema is generated from scratch. I.E.
      747     5278                     The target schema is not a copy of source with some
      748     5279                         additional DMCL operations.
      749     5280                     In this case, there can be no DMCL activity record for the
      750     5281                     source schema.  If you want to skip this security check, enter
      751     5282                     the command again with the BYPASS DMCL CHECK option. */
      752     5283
      753     5284        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:26   
      754     5285    1   DB_ALT:
      755     5286    1       UWA.SN_REC.SENAME = UWA.DB_STATUS;
      756     5287    1       CALL ERROR_MSG(DBU#DBERR,UWA.SN_REC.SENAME,COMMAND_TEXT);
      757     5288    1   CLOSE_SCHEMA: /* SOMETHIN WRONG WITH THIS SCHEMA SO CLOSE IT */
      758     5289    1       SCHEMA_ACTIVE='0'B; /* SET THIS SCHEMA IS NO LONGER ACTIVE */
      759     5290    1       CALL DB_FUNC_FIN;
      760     5291    1       ALTRETURN;
      761     5292
      762     5293    1   AC_OVERFLOW: /* AREA TABLE OVER FLOW */
      763     5294    1       CALL BIN_CHAR(1,AC_PTR);
      764     5295    1       CALL ERROR_MSG(DBU#PATBLER1,COMMAND_TEXT);
      765     5296    1       ALTRETURN;
      766     5297    1   SC_OVERFLOW: /* SET TABLE OVER FLOW */
      767     5298    1       X = SC_PTR;
      768     5299    1       UWA.SN_REC.SENAME='set';
      769     5300    1       GOTO OVER_FLOW;
      770     5301    1   RC_OVERFLOW:
      771     5302    1       X = RC_PTR;
      772     5303    1       UWA.SN_REC.SENAME='record';
      773     5304    1       GOTO OVER_FLOW;
      774     5305    1   KEY_OVERFLOW:
      775     5306    1       X = KEY_PTR;
      776     5307    1       UWA.SN_REC.SENAME='key';
      777     5308    1   OVER_FLOW:
      778     5309    1       CALL BIN_CHAR(2,X);
      779     5310    1       CALL ERROR_MSG(DBU#PATBLER2,UWA.SN_REC.SENAME,COMMAND_TEXT);
      780     5311    1       ALTRETURN;
      781     5312        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:27   
      782     5313        /*E*  ERROR: ZIU-DBU#NOTPASET-C
      783     5314        MESSAGE: Error: The set "%U1" is either undefined in schema %U2
      784     5315                        or a non-%U3 set.  */
      785     5316        /*E*  ERROR: ZIU-DBU#NONPA-C
      786     5317            MESSAGE:
      787     5318                     There is no "%U2" set found in schema %U1. */
      788     5319        /*E*  ERROR: ZIU-DBU#PAERROR1-C
      789     5320        MESSAGE: Error: Unacceptable data type %U3 for the field "%U1".
      790     5321                        %U2 aborted. */
      791     5322        /*E*  ERROR: ZIU-DBU#PATBLER1-C
      792     5323        MESSAGE: Area table overflow;
      793     5324                 current area index is %U2.
      794     5325                 This schema has too many areas defined for %U1 to handle,
      795     5326                      please report the problem.
      796     5327                      <<<< SOFTWARE ERROR >>>>  */
      797     5328        /*E*  ERROR: ZIU-DBU#PATBLER2-C
      798     5329        MESSAGE: %U1 table overflow;
      799     5330                 current index is %U3.
      800     5331                 Please report the problem.
      801     5332                 Temporary solution is to run %U2 with fewer sets each time.
      802     5333                 <<<< SOFTWARE ERROR >>>> */
      803     5334        /*E*  ERROR: ZIU-DBU#PASCH1-C
      804     5335        MESSAGE:  RESET %U1 (This DCB is used and reset during process.) */
      805     5336        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:28   
      806     5337        /*
      807     5338              2ND ENTRY POINT   ZIU$CMPT_SMRY
      808     5339                  1) PRINT PROCESSING SUMMARY
      809     5340                  2) APPLY ALL POINTER'S PATCHES IN PATCH FILE
      810     5341        */
      811     5342    1   ZIU$CMPT_SMRY: ENTRY ALTRET;
      812     5343
      813     5344    1       IF REC_CNT = 0 THEN /* NO MEMBER POINTERS CHANGED */
      814     5345    2       DO;
      815     5346    2           IF ZI$DIR.CODE=#RESORT THEN
      816     5347    2               CALL ERROR_MSG(DBU#PASUM0);
      817     5348    2           ELSE
      818     5349    2               IF ZI$DIR.CODE=#COMPACT THEN
      819     5350    2                   CALL ERROR_MSG(DBU#PASUM7);
      820     5351    2               ELSE
      821     5352    2                   IF ZI$DIR.CODE=#CONVERT OR ZI$DIR.CODE=#REVERT THEN
      822     5353    2                       CALL ERROR_MSG(DBU#PASUM8,COMMAND_TEXT);
      823     5354    2                   ELSE /* ZI$DIR.CODE=REBUILD */
      824     5355    3                   DO;
      825     5356    4                       DO X=0 TO NO_SETS;
      826     5357    4                           IF SC_TBL.COUNT(X)~=0 THEN
      827     5358    5                           DO;
      828     5359    5                               CALL ERROR_MSG(DBU#PAINFO2);
      829     5360    5                               GOTO SETS_SUMMARY;
      830     5361    5                               END;
      831     5362    4                           END;
      832     5363    3                       CALL ERROR_MSG(DBU#PASUM11);
      833     5364    3                       END;
      834     5365    2           END;
      835     5366        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:29   
      836     5367        /*E* ERROR: ZIU-DBU#PASUM0-C
      837     5368        MESSAGE:+
      838     5369                +  RESORT completed. - No record is out of sequence.
      839     5370                +   */
      840     5371        /*E* ERROR: ZIU-DBU#PASUM7-C
      841     5372        MESSAGE:+
      842     5373                +  COMPACT completed.  No index in PA_RECs is rearranged.
      843     5374                +   */
      844     5375        /*E* ERROR: ZIU-DBU#PASUM8-C
      845     5376        MESSAGE:+
      846     5377                +  %U1 completed.  No member record is found at all.
      847     5378                +   */
      848     5379        /*E* ERROR: ZIU-DBU#PASUM11-C
      849     5380        MESSAGE:+
      850     5381                +  REBUILD PA completed. - No member found at all.
      851     5382                +   */
      852     5383        /*E*  ERROR: ZIU-DBU#PAINFO2-C
      853     5384        MESSAGE:+
      854     5385                +  REBUILD PA completed with no pointer modification.
      855     5386                +   */
      856     5387        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:30   
      857     5388    1       ELSE /* THAT IS   WHEN REC_CNT>0 */
      858     5389    2       DO;
      859     5390    2           CALL BIN_CHAR(1,REC_CNT);
      860     5391    2           CALL ERROR_MSG(DBU#PAINFO1,COMMAND_TEXT);
      861     5392    2           READ_TEMP.V.DCB# = DBKEY_SORT_DCB;
      862     5393    2           CURR_PAGE = 0;
      863     5394    2           LAST_BAD_PAGE=0;
      864     5395    2           AC_PTR = 0; /* DBKEY IN SORT ORDER,SO START FROM 1ST AC */
      865     5396    2           BUF_PTR = 0; /* NOTE: TEMP FILE IS KEYED ON DBK ORDER */
      866     5397         /* SO EACH PAGE REQ IS IN ASCENDING */
      867     5398
      868     5399    2           DCBSF = DBKEY_SORT_DCB;
      869     5400    2           FIDSF = '*POINTER_PATCH_FILE';
      870     5401    2           ASNSF = %FILE#;
      871     5402    2           ACSSF = %SEQUEN#;
      872     5403    2           FUNSF = %IN#;
      873     5404    2           REASGNSF = %YES#;
      874     5405    2           CALL SYS_FUNC_OPEN ALTRET(OPEN_ERR);
      875     5406        /*
      876     5407                 UPDATE THE EIS FOR NEXT POINTER FOR ALL MEMBER TO BE
      877     5408                 REVERTED TO NON-PA FORMAT, CAUSE THE SCHEMA HAS
      878     5409                 NOT BEEN DMCL'ED YET, WE HAVE TO ANTICIPATE THE NEW LOCATION
      879     5410                 OF ALL THE POINTERS
      880     5411        */
      881     5412    2           IF ZI$DIR.CODE=#REVERT THEN
      882     5413    3           DO;
      883     5414    3               TYPE='0'B;
      884     5415    4               DO SC_PTR=0 TO NO_SETS; /* FROM SET TO EACH SM */
      885     5416    4                   RC_PTR=SC_TBL.RC_PTR(SC_PTR)+1;
      886     5417    4                   X=SC_TBL.NO_OF_SM(SC_PTR);
      887     5418    5                   DO WHILE(X>0); /* CHANGE EIS TO NEW EIS */
      888     5419    5                       Y=RC_TBL.TYPE(RC_PTR);
      889     5420    5                       RC_TBL.REDEF_NEXT.OFST(RC_PTR)=RC_TBL.REDEF_NEXT.OFST(RC_PTR)+
      890     5421    5                          TYPE.MSTRINDX(Y);
      891     5422    5                       TYPE.MSTRINDX(Y)=TYPE.MSTRINDX(Y)+SC_TBL.PA_PTRSIZE(SC_PTR);
      892     5423    5                       X=X-1;
      893     5424    5                       RC_PTR=RC_PTR+1;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:31   
      894     5425    5                       END;
      895     5426    4                   END;
      896     5427    3               END;
      897     5428        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:32   
      898     5429        /*
      899     5430              READ EACH RECORD IN PATCH FILE, THEN APPLY THE PATCH
      900     5431                THE KEY OF EACH RECORD = THE DBKEY OF THE RECORD TO PATCH
      901     5432                THE DATE OF RECORD = NEW NEXT POINTER AND NEW PRIOR POINTER
      902     5433        */
      903     5434    3           DO REC_CNT=REC_CNT DOWNTO 1;
      904     5435    3               CALL M$READ(READ_TEMP) ALTRET(READ_ERR);
      905     5436    4               DO WHILE(KEY.CURR>AC_TBL.BASE_DBK(AC_PTR+1) AND AC_PTR<NO_AREAS);
      906     5437    4                   AC_PTR=AC_PTR+1;
      907     5438    4                   END;
      908     5439    3               RC_PTR = KEY.RC_PTR;
      909     5440    3               SC_PTR = RC_TBL.SC_PTR(RC_PTR);
      910     5441    3               IF AC_TBL.DCB#(AC_PTR)=0 THEN /* AREA NOT OPENED YET */
      911     5442    3                   CALL OPEN_AREA ALTRET(ALT_ZIU$CMPT_INIT);
      912     5443    3               RB=(KEY.CURR-AC_TBL.BASE_DBK(AC_PTR)
      913     5444    3                  +AC_TBL.LPP(AC_PTR)-1)/AC_TBL.LPP(AC_PTR);
      914     5445         /* RB = PAGE # TO READ , RE = LINE # ON THE PAGE */
      915     5446    3               RE=KEY.CURR-AC_TBL.BASE_DBK(AC_PTR)-(RB-1)*AC_TBL.LPP(AC_PTR)-1;
      916     5447    3               IF RB>AC_TBL.NUM_DBPG(AC_PTR) THEN
      917     5448    3                   GOTO NO_RECORD_THERE; /* HAS TO BE AN OWNER */
      918     5449    3               IF CURR_PAGE ~= RB*256+AC_PTR THEN
      919     5450    3                   CALL GET_A_PAGE; /* DOUBLE BUFF THE WRITE OPERATION */
      920     5451    3               X = DATA_PG.ACT_DATA_18(2035-RE); /* LINE OFFSET */
      921     5452    3               IF RE>DATA_PG.OFF_LN.SEC OR X<12 THEN
      922     5453    3                   GOTO NO_RECORD_THERE; /* LN>HIGH_LN OR OFFSET<12 */
      923     5454        /*
      924     5455              NOW, REC$ IS POSITIONED TO THE DBK WE WANT
      925     5456        */
      926     5457    3               REC$=PINCRC(DATA$,12+X);
      927     5458    3               IF RC_PTR~=SC_TBL.RC_PTR(SC_PTR) THEN /* NOT OWNER OF SC */
      928     5459    3                   IF ZI$DIR.CODE=#REVERT THEN
      929     5460    3                       CALL INSERT_PRIOR ALTRET(SKIP_THIS_REC);
      930     5461    3                   ELSE
      931     5462    3                       IF ZI$DIR.CODE=#CONVERT THEN
      932     5463    3                           CALL REMOVE_PRIOR ALTRET(SKIP_THIS_REC);
      933     5464    3               CALL UPDATE_PTR(STK.NEXT,RC_TBL.NXPNT_EIS(RC_PTR));
      934     5465    3               IF ZI$DIR.CODE=#RESORT /* ALL RECORDS ARE REGULAR MEMBERS */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:33   
      935     5466    3                  OR RC_PTR=SC_TBL.RC_PTR(SC_PTR) THEN /* REC IS A SET OWNER */
      936     5467    3                   CALL UPDATE_PTR2(STK.PRIOR);
      937     5468    3   SKIP_THIS_REC:
      938     5469    3               END;
      939     5470         /* DCBSF REMAINED UNCHANGED SINCE LAST NO-WAIT WRITE */
      940     5471    2           CALL SYS_FUNC_CHECK ALTRET(ALT_ZIU$CMPT_INIT); /* WAIT LAST WRITE */
      941     5472    2           CALL FLUSH_PAGE ALTRET(ALT_ZIU$CMPT_INIT); /* DEFAULT TO WAIT */
      942     5473        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:34   
      943     5474        /*E*  ERROR: ZIU-DBU#PASUM1-C
      944     5475        MESSAGE:+
      945     5476                +      SUMMARY  SETS  RESORTED
      946     5477                +      -----------------------
      947     5478                +     */
      948     5479        /*E* ERROR: ZIU-DBU#PASUM4-C
      949     5480        MESSAGE:+
      950     5481                +      SUMMARY  SETS  %U1ED
      951     5482                +      -------  ----  ---------
      952     5483                +        */
      953     5484        /*E*  ERROR: ZIU-DBU#PASUM2-C
      954     5485        MESSAGE:+  Set "%U1" has %U2 tenants with pointers modified.
      955     5486                +     */
      956     5487        /*E*  ERROR: ZIU-DBU#PASUM12-C
      957     5488        MESSAGE:+  Set "%U1" has had %U2 *PA_RECs removed,
      958     5489                +      and %U3 members CONVERTed to non-PA format.
      959     5490                +     */
      960     5491        /*E*  ERROR: ZIU-DBU#PASUM3-C
      961     5492        MESSAGE:+  Set "%U1" has had all tenants in sorted order.
      962     5493                +     */
      963     5494        /*E*  ERROR: ZIU-DBU#PASUM5-C
      964     5495        MESSAGE:+  Set "%U1" has had %U3 PA_RECs removed.
      965     5496                +      Each PA_REC was packed down to %U2 available bytes.
      966     5497                +        */
      967     5498        /*E*  ERROR: ZIU-DBU#PASUM6-C
      968     5499        MESSAGE:+  Set "%U1" has had %U3 PA_RECs constructed.
      969     5500                +      Each PA_REC was packed down to %U2 available bytes.
      970     5501                +        */
      971     5502        /*E*  ERROR: ZIU-DBU#PASUM10-C
      972     5503        MESSAGE:+  No member records found for set "%U1".
      973     5504                +   */
      974     5505        /*E*  ERROR: ZIU-DBU#PAINFO1-C
      975     5506        MESSAGE:+
      976     5507                +  %U1 completed.  Next apply %U2 pointer-patches in patch file.
      977     5508                +   */
      978     5509        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:35   
      979     5510
      980     5511    2   SETS_SUMMARY: /* PRINT SUMMARY FOR EACH SET PROCESSED */
      981     5512
      982     5513    2           IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN
      983     5514    2               COMMAND_TEXT='CONVERT';
      984     5515    2           IF ZI$DIR.CODE=#RESORT THEN
      985     5516    2               CALL ERROR_MSG(DBU#PASUM1);
      986     5517    2           ELSE
      987     5518    2               CALL ERROR_MSG(DBU#PASUM4,COMMAND_TEXT);
      988     5519
      989     5520    2           IF ZI$DIR.CODE<=#CONVERT THEN /* PA RELATED COMMAND */
      990     5521    3           DO SC_PTR=0 TO NO_SETS;
      991     5522    3               IF BREAK_FLAG>0 THEN GOTO RET; /* DONT TYPE ANY MORE */
      992     5523    3               X=SC_TBL.FULL_PERCENT(SC_PTR);
      993     5524    3               CALL BIN_CHAR(1,X);
      994     5525    3               X=SC_TBL.COUNT(SC_PTR);
      995     5526    3               IF X>=0 THEN
      996     5527    3                   CALL BIN_CHAR(2,X);
      997     5528    3               ELSE
      998     5529    3                   CALL BIN_CHAR(2,-1*X);
      999     5530    3               IF X>0 OR (X=0 AND ZI$DIR.CODE=#COMPACT) THEN
     1000     5531    3                   CALL ERROR_MSG(DBU#PASUM5,SC_TBL.NAME(SC_PTR));
     1001     5532    3               ELSE
     1002     5533    3                   IF X<0 THEN
     1003     5534    3                       CALL ERROR_MSG(DBU#PASUM6,SC_TBL.NAME(SC_PTR));
     1004     5535    3                   ELSE /* MUST BE REBUID PA AND NO MEMBER FOUND */
     1005     5536    3                       CALL ERROR_MSG(DBU#PASUM10,SC_TBL.NAME(SC_PTR));
     1006     5537    3               END;
     1007     5538    2           ELSE
     1008     5539    3           DO SC_PTR=0 TO NO_SETS;
     1009     5540    3               X=SC_TBL.COUNT(SC_PTR);
     1010     5541    3               IF BREAK_FLAG>0 THEN GOTO RET;
     1011     5542    3               CALL BIN_CHAR(1,X);
     1012     5543    3               IF X>0 AND ZI$DIR.CODE=#RESORT THEN
     1013     5544    3                   CALL ERROR_MSG(DBU#PASUM2,SC_TBL.NAME(SC_PTR));
     1014     5545    3               ELSE
     1015     5546    3                   IF X>0 THEN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:36   
     1016     5547    4                   DO;
     1017     5548    4                       X=SC_TBL.COUNT2(SC_PTR);
     1018     5549    4                       CALL BIN_CHAR(2,X);
     1019     5550    4                       CALL ERROR_MSG(DBU#PASUM12,SC_TBL.NAME(SC_PTR));
     1020     5551    4                       END;
     1021     5552    3                   ELSE
     1022     5553    3                       IF ZI$DIR.CODE=#RESORT THEN
     1023     5554    3                           CALL ERROR_MSG(DBU#PASUM3,SC_TBL.NAME(SC_PTR));
     1024     5555    3                       ELSE
     1025     5556    3                           CALL ERROR_MSG(DBU#PASUM10,SC_TBL.NAME(SC_PTR));
     1026     5557    3               END;
     1027     5558    2           END;
     1028     5559    1       GOTO RET;
     1029     5560        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:37   
     1030     5561    1   OPEN_ERR: /* FAIL TO OPEN THE INTERMEDIATE FILE, ABORTING */
     1031     5562    1       CALL ERROR_MSG(DBU#PAERROR2,COMMAND_TEXT);
     1032     5563    1       CALL SYS_FUNC_RELDCB;
     1033     5564    1       DBKEY_SORT_DCB = 0;
     1034     5565    1       GOTO ALT_ZIU$CMPT_INIT;
     1035     5566    1   READ_ERR:
     1036     5567    1       MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$EXCFR.ERR;
     1037     5568    1       DCBSF = DBKEY_SORT_DCB;
     1038     5569    1       INCL_ERR=%YES#;
     1039     5570    1       CALL SYS_FUNC_ERRMSG;
     1040     5571    1       CALL ERROR_MSG(DBU#PAERROR2,COMMAND_TEXT); /* DIRECTIVE ABORTED MSG */
     1041     5572    1       GOTO ALT_ZIU$CMPT_INIT;
     1042     5573
     1043     5574    1   NO_RECORD_THERE:
     1044     5575    1       IF BREAK_FLAG>0 THEN GOTO ALT_ZIU$CMPT_INIT;
     1045     5576    1       CALL BIN_CHAR(1,KEY.CURR);
     1046     5577    1       IF RC_PTR=SC_TBL.RC_PTR(SC_PTR) THEN /* THE RC IS AN OWNER */
     1047     5578    2       DO;
     1048     5579    2           CALL BIN_CHAR(2,STK.PRIOR);
     1049     5580    2           CALL ERROR_MSG(DBU#PAWARN1,SC_TBL.NAME(SC_PTR));
     1050     5581    2           END; /* WE CAN TOLERATE THIS, DONT ABORT IT */
     1051     5582    1       ELSE
     1052     5583    2       DO;
     1053     5584    2           CALL BIN_CHAR(2,STK.NEXT);
     1054     5585    2           CALL ERROR_MSG(DBU#PAWARNM,SC_TBL.NAME(SC_PTR));
     1055     5586    2           END;
     1056     5587    1       GOTO SKIP_THIS_REC;
     1057     5588
     1058     5589    1   ALT_ZIU$CMPT_INIT: /* DUE TO IO-ERR OR BREAK WAS HIT */
     1059     5590    1       CURR_SCHNM = ' ';
     1060     5591    1       ALTRETURN; /* JUST DO A ALTRETURN, PA_ROOT WILL HANDLE REST */
     1061     5592        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:38   
     1062     5593        /*
     1063     5594              SUBR    REMOVE_PRIOR
     1064     5595                      SHIFT ALL DATAS AFTER THE PRIOR IN PAGE UP BY 1 PTR SIZE
     1065     5596                      AND UPDATE OFFSET ARRAY
     1066     5597        */
     1067     5598    1   REMOVE_PRIOR: PROC ALTRET;
     1068     5599
     1069     5600    2   DCL 1 NEW_EIS STATIC ALIGNED,
     1070     5601    2         2 * UBIN(3) UNAL,
     1071     5602    2         2 OFST UBIN(17) UNAL,
     1072     5603    2         2 * UBIN(4) UNAL,
     1073     5604    2         2 SIZ UBIN (12) UNAL;
     1074     5605    2   DCL 1 ZERO_V BASED(REC2$) CALIGNED,
     1075     5606    2         2 * CHAR(PTR_LEN) CALIGNED;
     1076     5607    2   DCL Z SBIN STATIC ALIGNED;
     1077     5608    2   DCL 1 REC_FORMAT BASED(REC$) CALIGNED,
     1078     5609    2         2 * UBIN HALF UNAL,
     1079     5610    2         2 SIZ UBIN HALF UNAL;
     1080     5611
     1081     5612    2       NEW_EIS = RC_TBL.REDEF_NEXT(RC_PTR);
     1082     5613    2       PTR_LEN=NEW_EIS.SIZ;
     1083     5614    2       NEW_EIS.OFST=NEW_EIS.OFST-RC_TBL.BYTES_SHIFT(RC_PTR);
     1084     5615    2       REC2$=PINCRC(REC$,NEW_EIS.OFST+PTR_LEN); /* POINTING PRIOR */
     1085     5616    3       DO Z=0 TO DATA_PG.OFF_LN.SEC; /* CHECK EACH OFFSET ARRAY */
     1086     5617    3           IF DATA_PG.ACT_DATA_18(2035-Z)>X THEN
     1087     5618    3               DATA_PG.ACT_DATA_18(2035-Z)=DATA_PG.ACT_DATA_18(2035-Z)-PTR_LEN;
     1088     5619    3           END;
     1089     5620    2       Z = DATA_PG.PG_SZ.SEC; /* SPACE AVAILABLE ON PAGE */
     1090     5621    2       DATA_PG.PG_SZ.SEC = Z+PTR_LEN; /* UPDATE IT */
     1091     5622    2       Z=4084-PTR_LEN-(Z+DATA_PG.OFF_LN.SEC*2+2);
     1092     5623    2       X = Z-(X+NEW_EIS.OFST+PTR_LEN); /* X=NUMBER OF BYTES TO MOVE */
     1093     5624    2       CHAR_V = PINCRC(REC2$,PTR_LEN)->CHAR_V;
     1094     5625    2       REC2$ = PINCRC(REC2$,X);
     1095     5626    2       ZERO_V = '0'B; /* ZERO GAP AFTER MOVE */
     1096     5627    2       REC_FORMAT.SIZ=REC_FORMAT.SIZ-PTR_LEN; /* UPDATE REC SIZE */
     1097     5628    2       CALL UPDATE_PTR(STK.NEXT,NEW_EIS);
     1098     5629    2       ALTRETURN; /* ALWAYS ALTRETUN */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:39   
     1099     5630        /*
     1100     5631              2ND ENTRY POINT - INSERT PRIOR WHEN REVERT PA TO NON-PA
     1101     5632        */
     1102     5633    2   INSERT_PRIOR: ENTRY ALTRET;
     1103     5634
     1104     5635    2       NEW_EIS = RC_TBL.REDEF_NEXT(RC_PTR); /* VERY MUCH ALIKE ABOVE */
     1105     5636    2       PTR_LEN = NEW_EIS.SIZ;
     1106     5637    2       Z = DATA_PG.PG_SZ.SEC; /* SPAVE AVAIL ON PAGE */
     1107     5638    2       IF Z < PTR_LEN THEN /* NO SUFFICIENT SPACE */
     1108     5639    3       DO;
     1109     5640    3           IF CURR_PAGE~=LAST_BAD_PAGE THEN
     1110     5641    4           DO;
     1111     5642    4               CURR_PAGE=LAST_BAD_PAGE; /* TYPE 1 MSG FOR EACH BAD PAGE */
     1112     5643    4               CALL BIN_CHAR(1,KEY.CURR);
     1113     5644    4               CALL BIN_CHAR(2,Z);
     1114     5645    4               CALL ERROR_MSG(DBU#PARVER1,SC_TBL.NAME(SC_PTR));
     1115     5646    4               END;
     1116     5647    3           ALTRETURN; /* THIS SET MEMBER IS NOT REVERTED TO NON-PA */
     1117     5648    3           END;
     1118     5649    2       DATA_PG.PG_SZ.SEC = Z - PTR_LEN; /* UPDATE SPACE AVAIL */
     1119     5650    2       REC_FORMAT.SIZ=REC_FORMAT.SIZ+PTR_LEN; /* AND RECORD SIZE */
     1120     5651    2       Z=4084-(Z+DATA_PG.OFF_LN.SEC*2+2); /* Z = END OF DATAS */
     1121     5652    3       DO Y=0 TO DATA_PG.OFF_LN.SEC; /* UPDATE OFFSET ARRAY */
     1122     5653    3           IF DATA_PG.ACT_DATA_18(2035-Y)>X THEN
     1123     5654    3               DATA_PG.ACT_DATA_18(2035-Y)=DATA_PG.ACT_DATA_18(2035-Y)+PTR_LEN;
     1124     5655    3           END;
     1125     5656
     1126     5657    2       X = Z-(X+NEW_EIS.OFST+PTR_LEN); /* X=# BYTES SHIFT DOWN */
     1127     5658    2       REC2$=PINCRC(REC$,NEW_EIS.OFST+PTR_LEN); /* NEW PRIR LOC */
     1128     5659    2       CALL SHIFT_ARRAY(CHAR_V,PINCRC(REC2$,PTR_LEN)->CHAR_V,X);
     1129     5660    2       CALL UPDATE_PTR(STK.NEXT,NEW_EIS);
     1130     5661    2       CALL UPDATE_PTR2(STK.PRIOR); /* INSERT A NEW PRIOR */
     1131     5662    2       ALTRETURN;
     1132     5663        /*E*  ERROR: ZIU-DBU#PARVER1-C
     1133     5664        MESSAGE: Warning: The page that has a member record of set "%U1" at
     1134     5665                          DBK %U2, has only %U3 available bytes left and it
     1135     5666                          is not enough to CONVERT to non-PA format.
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:40   
     1136     5667                          This problem is to be resolved in the future.
     1137     5668                          At this point, you have to reload the data base and try
     1138     5669                          to delete a record in this page to make room. */
     1139     5670
     1140     5671    2   END REMOVE_PRIOR;
     1141     5672        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:41   
     1142     5673        /*E* ERROR: ZIU-DBU#PAWARN1-C
     1143     5674        MESSAGE:  Warning: No record at DBK# %U2, but it is pointed to by a member
     1144     5675                           of DBK# %U3 through its owner pointer in set "%U1".
     1145     5676                           Run REPAIR package to have it fixed.  */
     1146     5677        /*E*  ERROR: ZIU-DBU#PAWARNM-C
     1147     5678        MESSAGE:  Warning: No record at DBK# %U2, but it is pointed to by a PA_REC
     1148     5679                           at DBK# %U3 through its PA pointer in set "%U1".
     1149     5680                           Run REBUILD PA to reconstruct this set. */
     1150     5681        /*E*  ERROR: ZIU-DBU#PAPER85-C
     1151     5682        MESSAGE:Note: Default 85% compaction is used instead.  */
     1152     5683        /*E*  ERROR: ZIU-DBU#DBERR-C
     1153     5684            MESSAGE: DBSTATUS = %U1.  %U2 aborted. */
     1154     5685        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:42   
     1155     5686        /*
     1156     5687              SUBR   UPDATE_PTR - BY GIVING NEW_PTR AND EIS OF PTR
     1157     5688        */
     1158     5689    1   UPDATE_PTR: PROC(NEW_PTR,EIS);
     1159     5690
     1160     5691    2   DCL NEW_PTR UBIN CALIGNED;
     1161     5692    2   DCL 1 EIS ALIGNED,
     1162     5693    2         2 * UBIN(3) UNAL,
     1163     5694    2         2 OFST UBIN(17) UNAL,
     1164     5695    2         2 * UBIN(4) UNAL,
     1165     5696    2         2 SIZE UBIN(12) UNAL;
     1166     5697
     1167     5698    2       REC2$ = PINCRC(REC$,EIS.OFST);
     1168     5699    2       X = EIS.SIZE;
     1169     5700
     1170     5701    2   UPDATE_PTR2: ENTRY(NEW_PTR);
     1171     5702
     1172     5703    2       IF SC_TBL.GLOBAL(SC_PTR)=0 THEN /* SET IS LOCAL */
     1173     5704    2           NEW_PTR = NEW_PTR - AC_TBL.BASE_DBK(AC_PTR);
     1174     5705    2       CHAR_V = PINCRC(ADDR(NEW_PTR),4-X)->CHAR_V;
     1175     5706    2       REC2$ = PINCRC(REC2$,X);
     1176     5707    2   END UPDATE_PTR;
     1177     5708        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:43   
     1178     5709        /*
     1179     5710              SUBR    GET_A_PAGE -  DO A READ OF A PAGE POINTED BY AC_PTR $ RB
     1180     5711                                    THEN DO A NO-WAIT WRITE POINTED BY CURR_PAGE
     1181     5712              ENTRY   FLUSH PAGE -  DO A WAITED WRITE OF CURR_PAGE
     1182     5713                      CURR_PAGE CONTAINS PAGE# AND AC_PTR
     1183     5714        */
     1184     5715    1   GET_A_PAGE: PROC ALTRET;
     1185     5716
     1186     5717    2       IF BREAK_FLAG > 0 THEN
     1187     5718    2           GOTO ALT;
     1188     5719    2       IF CURR_PAGE>0 THEN
     1189     5720    2           CALL SYS_FUNC_CHECK ALTRET(ALT);
     1190     5721    2       DCBSF = AC_TBL.DCB#(AC_PTR);
     1191     5722    2       CALL READ_DB(BUF_PTR,RB,1) ALTRET(ALT); /* READ PAGE REQUESTED */
     1192     5723    2       NEW_CURR_PAGE = RB*256+AC_PTR;
     1193     5724    2       WAITSF = %NO#; /* DONT WAIT FOR WRITE OPERATION */
     1194     5725
     1195     5726    2   FLUSH_PAGE: ENTRY ALTRET;
     1196     5727
     1197     5728    2       BUF_PTR = 1 - BUF_PTR; /* LAST PAGE LOC TO WRITE */
     1198     5729    2       RB = CURR_PAGE/256; /* RB IS THE LAST PAGE TO WRITE */
     1199     5730    2       AC_PTR = MOD(CURR_PAGE,256); /* PARSE AC_PTR FROM CURR_PAGE */
     1200     5731    2       IF CURR_PAGE>0 THEN /* IF NOT FIRST TIME IN */
     1201     5732    3       DO;
     1202     5733    3           IF AC_TBL.CHECKSUM(AC_PTR) THEN /* CHKSUM THIS PAGE */
     1203     5734    4           DO;
     1204     5735    4               DATA$=ADDR(I_O_BUF(BUF_PTR)); /* LAST BUFFER ADDRESS */
     1205     5736    4               CALL CHKSUM;
     1206     5737    4               DATA_PG.CHKSUM_WD=ICHKSUM;
     1207     5738    4               END;
     1208     5739    3           DCBSF = AC_TBL.DCB#(AC_PTR);
     1209     5740    3           FULLSF = %YES#;
     1210     5741    3           KEYSF = %YES#;
     1211     5742    3           BUFSF = VECTOR(I_O_BUF(BUF_PTR));
     1212     5743    3           BUFLNSF = 4096;
     1213     5744    3           KEYVSF.IDSKEY = RB;
     1214     5745    3           AC_TBL.PAGE_WRITTEN(AC_PTR)='1'B; /* MARK AREA UPDATED */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:44   
     1215     5746    3           CALL SYS_FUNC_WRIT ALTRET(ALT);
     1216     5747    3           END;
     1217     5748    2       DATA$ = ADDR(I_O_BUF(1-BUF_PTR)); /* THE BUF JUST READ A PAGE */
     1218     5749    2       CURR_PAGE = NEW_CURR_PAGE; /* UPDATE IT TO THE PAGE JUST READ */
     1219     5750    2       AC_PTR = MOD(CURR_PAGE,256); /* NEED THIS INFO */
     1220     5751    2       RETURN;
     1221     5752    2   ALT: ALTRETURN;
     1222     5753    2   END GET_A_PAGE;
     1223     5754
     1224     5755    1   END ZIU$CMPT_INIT;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:45   
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_RVA_C.:ZIC0TOU  is referenced.
   ZI_UWA_C.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$CMPT_INIT.

   Procedure ZIU$CMPT_INIT requires 2672 words for executable code.
   Procedure ZIU$CMPT_INIT is declared NOAUTO and requires 48 words of local(STATIC) storage.

    No errors detected in file ZIU$CMPT_INIT.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:46   

 Object Unit name= ZIU$CMPT_INIT                              File name= ZIU$CMPT_INIT.:ZIC0TOU
 UTS= SEP 05 '97 13:08:57.28 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    48     60  ZIU$CMPT_INIT
    1  RoData even  UTS     58     72  ZIU$CMPT_INIT
    2   DCB   even  none     0      0  M$LO
    3   DCB   even  none     0      0  M$UC
    4   Proc  even  none  2672   5160  ZIU$CMPT_INIT
    5  RoData even  none   176    260  ZIU$CMPT_INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  ZIU$CMPT_INIT
     4   3234          yes     yes      Std        0  ZIU$CMPT_SMRY
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:47   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 DB_FUNC_FIN
 yes     yes           Std       0 FREE_DYN_MEM
 yes     yes           Std       0 ZIU$SYSCTL
 yes     yes           Std       0 SYS_FUNC_OPEN
 yes     yes           Std       1 DB_FUNC_GET
 yes     yes           Std       1 DB_FUNC_FRA
         yes           Std       2 BIN_CHAR
 yes     yes           Std       0 OPEN_AREA
 yes     yes           Std       0 SYS_FUNC_RELDCB
 yes     yes           Std       0 SYS_FUNC_CHECK
 yes     yes           Std       2 DB_FUNC_FDR
         yes           Std       4 ERROR_MSG
 yes     yes           Std       2 DB_FUNC_FRS
 yes     yes           Std       1 DB_FUNC_FOR
 yes     yes           Std       0 SYS_FUNC_ERRMSG
 yes     yes           Std       1 GET_DCB
 yes     yes           Std       0 SYS_FUNC_CLOS
 yes     yes           Std       3 READ_DB
 yes     yes           Std       2 ZIU$Q2SC
         yes           Std       3 SHIFT_ARRAY
         yes           Std       0 CHKSUM
 yes     yes           Std       0 SYS_FUNC_WRIT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:48   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     RBUF                                  READ_SW                               COMMAND_TEXT
     MAX_KEY_SIZE                          PRFR                                  PRFR2
     REC2$                                 REC_CNT                               PTR_LEN
     DBKEY_SORT_DCB                        STK                                   CURR_SCHNM
     UWA                                   CAN_RVA                               BLKLSF
     KEYLSF                                KEYXSF                                DCBSF
     ORGSF                                 KEYSF                                 KEYVSF
     ACSSF                                 NOTIMESF                              FUNSF
     ASNSF                                 TESTSF                                XTENSIZESF
     DISPSF                                WAITSF                                VFCSF
     FULLSF                                BKUPSF                                BUFLNSF
     BUFSF                                 SOURCESF                              DESTSF
     DATESF                                TIMESF                                UTSSF
     DAYSF                                 TSTAMPSF                              ENCRP_SEEDSF
     ERRCODESF                             MSGCODE                               INCL_ERR
     ERR_INSERT                            FIDSF_RD                              ACNT
     EXISTSF                               SHARESF                               DCBNMSF
     KEYRSF                                NO_KEYSF                              REASGNSF
     CARRY_ATTRIBUTESF                     SUBMESSF                              SPKY_OPNSF
     POSSF                                 ERRFLGSF                              MERGESF
     FSA_FLAG                              RELGSF                                UNUSED
     HELPCODE                              COUNTSF                               INDEXSF
     GAP                                   PSNSF                                 ACNTSF
     KEY_SHADWSF                           REC$                                  RB
     RE                                    IE                                    IB
     CNT                                   ICNT                                  RCNT
     SCNT                                  FIRST_SET                             RETCNT
     DMPCNT                                KCNT                                  ACNT_IDX
     I                                     J                                     K
     X                                     STEPCC                                I_O_BUF$
     OUT_INDX                              I_O_SIZE                              REC_DATA_LN
     M$LO                                  B$TCB$                                B$ROS$
     B$JIT$                                KEYFID                                I_O_KEY
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:49   
     RESTART                               BREAK_FLAG                            ICHKSUM
     ITMCNT                                GAP1                                  ZI$DIR
     SCHEMA_ACTIVE                         RECORD_LIST                           SET_LIST
     RETAIN_LIST                           DUMP_FID                              ALTKY
     INIT_RG                               KEY_RNG                               ITEM_LIST
     TYPE                                  MSTR$                                 NXT_MSLOT
     MAX_MSLOT                             MSTR_INDX                             HASHTBL
     HASHINDX                              LOC_MODE                              AREA_KEY$
     NO_AREAS                              GLBL_PTR_SZ                           SET_XREF$
     NXT_SSLOT                             MAX_SSLOT                             REC_XREF$
     NXT_RSLOT                             MAX_RSLOT                             NO_RECS
     NO_SETS                               XREF_BUILT                            TYPESET
     TYPEREC                               SC_PTR                                SC_TBL
     RC_PTR                                RC_TBL                                KEY_PTR
     KEY_TBL                               AC_PTR                                FIRST_TIME_CALLED
     BASE_DBK                              AC_TBL                                M$UC
     ATBLK$                                DATA$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:50   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*
        7        7              ZIU$CMPT_INIT - OVERLAY # 1 FOR  COMPACT PACKAGE
        8        8                  THIS ROUTINE EXTRACTS INFORMATION FROM
        9        9                  THE SCHEMA FILE AND INITILIZES ALL TABLES USED BY
       10       10                  2ND ENTRY PT - ZIU$CMPT_SMRY
       11       11                      PRINT PROCESSING SUMMARY MESSAGE.
       12       12        */
       13       13        ZIU$CMPT_INIT: PROC ALTRET NOAUTO;

     13  4 000000   000000 741200 0     ZIU$CMPT_IN* STX1  ! 0
         4 000001   000533 710000 4                  TRA     s:4773

       14       14
       15       15    1   DCL ERROR_MSG ENTRY(4);
       16       16    1   DCL SHIFT_ARRAY ENTRY(3);
       17       17    1   DCL FREE_DYN_MEM ENTRY ALTRET;
       18       18    1   DCL BIN_CHAR ENTRY(2);
       19       19    1   DCL CHKSUM ENTRY;
       20       20    1   DCL OPEN_AREA ENTRY ALTRET;
       21       21    1   DCL READ_DB ENTRY(3) ALTRET;
       22       22    1   DCL GET_DCB ENTRY(1) ALTRET;
       23       23
       24       24    1   DCL ZIU$Q2SC ENTRY(2) ALTRET; /* OPEN SCHEMA AND GET DMCL AD_REC */
       25       25    1   DCL ZIU$SYSCTL ENTRY ALTRET;
       26       26    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
       27       27    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
       28       28    1   DCL SYS_FUNC_CHECK ENTRY ALTRET;
       29       29    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
       30       30    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
       31       31    1   DCL SYS_FUNC_RELEASE ENTRY ALTRET;
       32       32    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:51   
       33       33
       34       34    1   DCL RBUF CHAR(256) SYMREF CALIGNED;
       35       35    1   DCL READ_SW SBIN SYMREF;
       36       36    1   DCL COMMAND_TEXT CHAR(16) SYMREF ALIGNED;
       37       37    1   DCL MAX_KEY_SIZE SBIN SYMREF ALIGNED;
       38       38    1   DCL PRFR SBIN SYMREF ALIGNED;
       39       39    1   DCL PRFR2 SBIN SYMREF ALIGNED;
       40       40    1   DCL REC2$ PTR SYMREF ALIGNED;
       41       41    1   DCL REC_CNT SBIN SYMREF ALIGNED;
       42       42    1   DCL PTR_LEN SBIN SYMREF ALIGNED;
       43       43    1   DCL DBKEY_SORT_DCB UBIN HALF SYMREF ALIGNED;
       44       44    1   DCL 1 STK SYMREF ALIGNED,
       45       45    1         2 NEXT SBIN ALIGNED,
       46       46    1         2 PRIOR SBIN ALIGNED;
       47       47    1   DCL 1 KEY STATIC ALIGNED,
       48       48    1         2 CNT UBIN BYTE UNAL,
       49       49    1         2 CURR SBIN WORD UNAL,
       50       50    1         2 RC_PTR UBIN BYTE UNAL;
       51       51
       52       52
       53       53        /*  CONVERTION TABLE - FROM DATA_TYPE TO COMPARE_CODE */
       54       54    1   DCL FTYPE_TO_CC(0:19) UBIN(3) CONSTANT UNAL
       55       55    1    INIT(0,2,2,1,1, 0,3,2,0,0, 4,5,5,3,3, 0,0,0,0,0);
       56       56    1   DCL Y SBIN STATIC ALIGNED;
       57       57    1   DCL PSN CHAR(12) STATIC ALIGNED;
       58       58    1   DCL PSN_V CHAR(Y) BASED CALIGNED;
       59       59    1   DCL BUF_PTR SBIN STATIC ALIGNED;
       60       60    1   DCL DIR_REF REDEF BUF_PTR SBIN ALIGNED;
       61       61    1   DCL CURR_PAGE SBIN STATIC ALIGNED;
       62       62    1   DCL LAST_BAD_PAGE SBIN STATIC ALIGNED;
       63       63    1   DCL NEW_CURR_PAGE SBIN STATIC ALIGNED;
       64       64    1   DCL CHAR_V CHAR(X) BASED(REC2$) CALIGNED;
       65       65    1   DCL DMCL_TSTAMP CHAR(16) STATIC ALIGNED;
       66       66
       67       67    1   DCL CURR_SCHNM CHAR(30) SYMREF CALIGNED;
       68       68        %INCLUDE ZI_UWA_C;
       69      758         %ZI$UWAB;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:52   
       70     1098        %INCLUDE ZI_RVA_C;
       71     1779         %CAN_RVA_REF;
       72     2098        %INCLUDE ZI_GLOBAL_DBUTIL;
       73     2276         %SYS_FUNC;
       74     2368         %MISC_DCLS;
       75     2421        %INCLUDE ZI$DIR;
       76     2578         %DIR;
       77     2722        %INCLUDE ZI_DBU_XREF;
       78     2889         %XREF_TBLS;
       79     2964         %PA_XREF_TBLS;
       80     3030        %INCLUDE CP_6;
       81     3111         %B$EXCFR;
       82     3129         %B$TCB;
       83     3132         %F$DCB;
       84     3189         %FPT_READ(FPTN=READ_TEMP,BUF=STK,WAIT=YES,KEYR=YES,KEY=KEY);
       85     3228        %INCLUDE ZI$PG_STRUCTS;
       86     3331         %ATBLK_PG;
       87     3387         %DATA_PG;
       88     3406        %INCLUDE ZI_PRSE_SUBS;
       89     3562        %INCLUDE ZI_ERRORS_SUBS;
       90     4082        %INCLUDE CP_6_SUBS;
       91     4622
       92     4623    1   DCL DB_FUNC_FDR ENTRY(2) ALTRET;
       93     4624    1   DCL DB_FUNC_FOR ENTRY(1) ALTRET;
       94     4625    1   DCL DB_FUNC_GET ENTRY(1) ALTRET;
       95     4626    1   DCL DB_FUNC_FRS ENTRY(2) ALTRET;
       96     4627    1   DCL DB_FUNC_FRA ENTRY(1) ALTRET;
       97     4628    1   DCL DB_FUNC_FIN ENTRY ALTRET;
       98     4629
       99     4630        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:53   
      100     4631        %SUB DBALT = "ALTRET(DB_ALT)";
      101     4632        %SUB DB_FOR = DB_FUNC_FOR;
      102     4633        %SUB DB_GET = DB_FUNC_GET;
      103     4634        %SUB DB_FRS = DB_FUNC_FRS;
      104     4635        %SUB DB_FRA = DB_FUNC_FRA;
      105     4636        %SUB DB_FDR = DB_FUNC_FDR;
      106     4637        %SUB RVA = CAN_RVA;
      107     4638        %SUB UNTIL_END_OF_SET = "WHILE(UWA.DB_STATUS ~= '02100')";
      108     4639        /*
      109     4640              SUBR  SETUP_RA_RANGES
      110     4641                    LOOP THRU RCRA SET TO GET ALL AC RECORD
      111     4642                    SAVE THE HIGH AND LOW RANGES FOR EACH RA IN AC_TBL
      112     4643                    THEN MARK THE AREA IS TO BE OPENED
      113     4644        */
      114     4645    1   SETUP_RA_RANGES: PROC(PA_REC_RANGES) ALTRET;

   4645  4 000002   000036 741200 0     SETUP_RA_RA* STX1  ! READ_TEMP+14

      115     4646
      116     4647    2   DCL PA_REC_RANGES SBIN ALIGNED;
      117     4648
      118     4649    2       CALL DB_FRS(RVA.RAREC,RVA.RCRA) DBALT;

   4649  4 000003   000001 630400 5                  EPPR0   1
         4 000004   000000 631400 5                  EPPR1   0
         4 000005   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000006   000152 702000 4                  TSX2    DB_ALT

      119     4650    3       DO UNTIL_END_OF_SET;

   4650  4 000007   040000 106400                    CMPC    fill='040'O
         4 000010   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000011   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000012   000150 600000 4                  TZE     s:4673

      120     4651    3           CALL DB_GET(RVA.RAREC) DBALT;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:54   
   4651  4 000013   000001 630400 5                  EPPR0   1
         4 000014   000003 631400 5                  EPPR1   3
         4 000015   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000016   000152 702000 4                  TSX2    DB_ALT

      121     4652    3           CALL DB_FOR(RVA.ACRA) DBALT;

   4652  4 000017   000004 630400 5                  EPPR0   4
         4 000020   000003 631400 5                  EPPR1   3
         4 000021   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 000022   000152 702000 4                  TSX2    DB_ALT

      122     4653    3           CALL DB_FOR(RVA.SNSE) DBALT;

   4653  4 000023   000005 630400 5                  EPPR0   5
         4 000024   000003 631400 5                  EPPR1   3
         4 000025   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 000026   000152 702000 4                  TSX2    DB_ALT

      123     4654    3           CALL DB_GET(RVA.SNREC) DBALT;

   4654  4 000027   000006 630400 5                  EPPR0   6
         4 000030   000003 631400 5                  EPPR1   3
         4 000031   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000032   000152 702000 4                  TSX2    DB_ALT

      124     4655    3           X = 0;

   4655  4 000033   000000 450000 xsym               STZ     X

      125     4656    4           DO WHILE(AC_TBL.NAME(X)~=UWA.SN_REC.SENAME);

   4656  4 000034   000000 236000 xsym               LDQ     X
         4 000035   000060 402007                    MPY     48,DL
         4 000036   040000 106406                    CMPC    fill='040'O
         4 000037   000003 400036 xsym               ADSC9   AC_TBL+3,Q               cn=2,n=30
         4 000040   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:55   
         4 000041   000051 600000 4                  TZE     s:4660

      126     4657    4               X=X+1;

   4657  4 000042   000000 054000 xsym               AOS     X

      127     4658    4               END;

   4658  4 000043   000000 236000 xsym               LDQ     X
         4 000044   000060 402007                    MPY     48,DL
         4 000045   040000 106406                    CMPC    fill='040'O
         4 000046   000003 400036 xsym               ADSC9   AC_TBL+3,Q               cn=2,n=30
         4 000047   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 000050   000042 601000 4                  TNZ     s:4657

      128     4659         /* SETUP RANGE IN PAGES FOR THAT AREA */
      129     4660    3           RB=(UWA.RA_REC.LDBK-AC_TBL.BASE_DBK(X)+AC_TBL.LPP(X)-1)/AC_TBL.LPP(X);

   4660  4 000051   000000 236000 xsym               LDQ     X
         4 000052   000014 402007                    MPY     12,DL
         4 000053   000000 620006                    EAX0    0,QL
         4 000054   000326 236000 xsym               LDQ     UWA+214
         4 000055   000000 136010 xsym               SBLQ    AC_TBL,X0
         4 000056   000054 756000 0                  STQ     @EIS+3
         4 000057   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 000060   000032 772000                    QRL     26
         4 000061   000055 756000 0                  STQ     @EIS+4
         4 000062   000054 236000 0                  LDQ     @EIS+3
         4 000063   000055 036000 0                  ADLQ    @EIS+4
         4 000064   000056 756000 0                  STQ     @EIS+5
         4 000065   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 000066   000032 772000                    QRL     26
         4 000067   000057 756000 0                  STQ     @EIS+6
         4 000070   000056 236000 0                  LDQ     @EIS+5
         4 000071   000001 136007                    SBLQ    1,DL
         4 000072   000057 506000 0                  DIV     @EIS+6
         4 000073   000000 756000 xsym               STQ     RB
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:56   

      130     4661    3           RE=(UWA.RA_REC.HDBK-AC_TBL.BASE_DBK(X)+AC_TBL.LPP(X)-1)/AC_TBL.LPP(X);

   4661  4 000074   000327 236000 xsym               LDQ     UWA+215
         4 000075   000000 136010 xsym               SBLQ    AC_TBL,X0
         4 000076   000054 756000 0                  STQ     @EIS+3
         4 000077   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 000100   000032 772000                    QRL     26
         4 000101   000055 756000 0                  STQ     @EIS+4
         4 000102   000054 236000 0                  LDQ     @EIS+3
         4 000103   000055 036000 0                  ADLQ    @EIS+4
         4 000104   000056 756000 0                  STQ     @EIS+5
         4 000105   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 000106   000032 772000                    QRL     26
         4 000107   000057 756000 0                  STQ     @EIS+6
         4 000110   000056 236000 0                  LDQ     @EIS+5
         4 000111   000001 136007                    SBLQ    1,DL
         4 000112   000057 506000 0                  DIV     @EIS+6
         4 000113   000000 756000 xsym               STQ     RE

      131     4662    3           IF ADDR(PA_REC_RANGES)~=ADDR(NIL) THEN

   4662  4 000114   000037 236000 0                  LDQ     @PA_REC_RANGES
         4 000115   000007 116000 5                  CMPQ    7
         4 000116   000123 600000 4                  TZE     s:4667

      132     4663    4           DO; /* THE RANGES ARE SETUP FOR *PA_REC */

      133     4664    4               RB = 1; /* USE THE WHOLE AREA WHERE OWNERS ARE */

   4664  4 000117   000001 235007                    LDA     1,DL
         4 000120   000000 755000 xsym               STA     RB

      134     4665    4               RE = 262143; /*  O777777 AS HIGH AS WE CAN GO */

   4665  4 000121   777777 235007                    LDA     -1,DL
         4 000122   000000 755000 xsym               STA     RE
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:57   

      135     4666    4               END;

      136     4667    3           IF RB < AC_TBL.RANGE_LOW(X) THEN

   4667  4 000123   000001 236010 xsym               LDQ     AC_TBL+1,X0
         4 000124   000132 604000 4                  TMI     s:4669
         4 000125   000000 116000 xsym               CMPQ    RB
         4 000126   000132 602000 4                  TNC     s:4669
         4 000127   000132 600000 4                  TZE     s:4669

      137     4668    3               AC_TBL.RANGE_LOW(X)=RB;

   4668  4 000130   000000 235000 xsym               LDA     RB
         4 000131   000001 755010 xsym               STA     AC_TBL+1,X0

      138     4669    3           IF RE > AC_TBL.RANGE_HIGH(X) THEN

   4669  4 000132   000002 236010 xsym               LDQ     AC_TBL+2,X0
         4 000133   000136 604000 4                  TMI     s:4670
         4 000134   000000 116000 xsym               CMPQ    RE
         4 000135   000140 603000 4                  TRC     s:4671

      139     4670    3               AC_TBL.RANGE_HIGH(X)=RE;

   4670  4 000136   000000 235000 xsym               LDA     RE
         4 000137   000002 755010 xsym               STA     AC_TBL+2,X0

      140     4671    3           CALL DB_FRS(RVA.RAREC,RVA.RCRA) DBALT;

   4671  4 000140   000001 630400 5                  EPPR0   1
         4 000141   000000 631400 5                  EPPR1   0
         4 000142   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000143   000152 702000 4                  TSX2    DB_ALT

      141     4672    3           END;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:58   
   4672  4 000144   040000 106400                    CMPC    fill='040'O
         4 000145   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000146   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000147   000013 601000 4                  TNZ     s:4651

      142     4673    2       RETURN;

   4673  4 000150   000036 221200 0                  LDX1  ! READ_TEMP+14
         4 000151   000001 702211                    TSX2  ! 1,X1

      143     4674    2   DB_ALT: ALTRETURN;

   4674  4 000152   000036 221200 0     DB_ALT       LDX1  ! READ_TEMP+14
         4 000153   000000 702211                    TSX2  ! 0,X1

      144     4675    2   END SETUP_RA_RANGES;
      145     4676        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:59   
      146     4677        /*
      147     4678              SUBR    OPEN_SCHEMA - OPEN SOURCE_SCHEMA OR TARGET_SCHEMA DCB
      148     4679                                    AND READ ATBLK PAGE TO GET INTERNAL NAME
      149     4680                                    THEN SETUP THAT DCB FOR IDS TO USE
      150     4681        */
      151     4682    1   OPEN_SCHEMA: PROC(TYPE_MSG) ALTRET;

   4682  4 000154   000040 741200 0     OPEN_SCHEMA  STX1  ! @PA_REC_RANGES+1

      152     4683
      153     4684    2   DCL TYPE_MSG SBIN ALIGNED;
      154     4685
      155     4686    2       CALL GET_DCB(ZI$DIR.SCHEMA_NM) ALTRET(ALT);

   4686  4 000155   000010 630400 5                  EPPR0   8
         4 000156   000003 631400 5                  EPPR1   3
         4 000157   000000 701000 xent               TSX1    GET_DCB
         4 000160   000402 702000 4                  TSX2    ALT

      156     4687    2       FUNSF=%IN#;

   4687  4 000161   000002 235007                    LDA     2,DL
         4 000162   000000 755000 xsym               STA     FUNSF

      157     4688    2       SHARESF=%ALL#;

   4688  4 000163   200000 236003                    LDQ     65536,DU
         4 000164   000000 756000 xsym               STQ     SHARESF

      158     4689    2       REASGNSF=%YES#;

   4689  4 000165   400000 236003                    LDQ     -131072,DU
         4 000166   000000 756000 xsym               STQ     REASGNSF

      159     4690    2       CALL SYS_FUNC_OPEN ALTRET(ALT); /* OPEN SOURCE/TARGET DCB */

   4690  4 000167   000011 631400 5                  EPPR1   9
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:60   
         4 000170   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 000171   000402 702000 4                  TSX2    ALT

      160     4691    2       CALL READ_DB(0,0,1) ALTRET(ALT); /* READ ATBLK PAGE */

   4691  4 000172   000014 630400 5                  EPPR0   12
         4 000173   000012 631400 5                  EPPR1   10
         4 000174   000000 701000 xent               TSX1    READ_DB
         4 000175   000402 702000 4                  TSX2    ALT

      161     4692    2       ATBLK$ = ADDR(I_O_BUF(0));

   4692  4 000176   000000 236000 xsym               LDQ     I_O_BUF$
         4 000177   000000 756000 xsym               STQ     ATBLK$

      162     4693    2       CALL SYS_FUNC_CLOS; /* CLOSE SOURCE DCB */

   4693  4 000200   000011 631400 5                  EPPR1   9
         4 000201   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 000202   000000 011000                    NOP     0

      163     4694    2       ZI$DIR.SCHEMA_NM.NAME.TEXT=ATBLK_PG.AREA_NM;

   4694  4 000203   000000 470400 xsym               LDP0    ATBLK$
         4 000204   040000 100500                    MLR     fill='040'O
         4 000205   000017 000036                    ADSC9   15,,PR0                  cn=0,n=30
         4 000206   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30

      164     4695    2       REC2$ = ADDR(DCBADDR(DCBSF)->F$DCB.NAME#.C); /* FILE NAME */

   4695  4 000207   000017 471400 5                  LDP1    15
         4 000210   100000 473500                    LDP3    0,,PR1
         4 000211   000000 220000 xsym               LDX0    DCBSF
         4 000212   300000 474510                    LDP4    0,X0,PR3
         4 000213   000054 454400 0                  STP4    @EIS+3
         4 000214   000054 236000 0                  LDQ     @EIS+3
         4 000215   000020 036000 5                  ADLQ    16
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:61   
         4 000216   000000 756000 xsym               STQ     REC2$

      165     4696    2       CALL INDEX1(X,' ',DCBADDR(DCBSF)->F$DCB.NAME#.C);

   4696  4 000217   000000 124500                    SCM     mask='000'O
         4 000220   400010 200037                    ADSC9   8,,PR4                   cn=1,n=31
         4 000221   000021 000001 5                  ADSC9   17                       cn=0,n=1
         4 000222   000000 000000 xsym               ARG     X

      166     4697    2       PSN=DCBADDR(DCBSF)->F$DCB.PSN#; /* GET PACK SET SN */

   4697  4 000223   040000 100500                    MLR     fill='040'O
         4 000224   400024 000006                    ADSC9   20,,PR4                  cn=0,n=6
         4 000225   000004 000014 0                  ADSC9   PSN                      cn=0,n=12

      167     4698    2       CALL INDEX1(Y,' ',PSN); /* CHK FOR BLANKS */

   4698  4 000226   000000 124400                    SCM     mask='000'O
         4 000227   000004 000014 0                  ADSC9   PSN                      cn=0,n=12
         4 000230   000021 000001 5                  ADSC9   17                       cn=0,n=1
         4 000231   000003 000000 0                  ARG     Y

      168     4699    2       IF Y>0 THEN /* PACK SET IS NON-BLANK */

   4699  4 000232   000003 235000 0                  LDA     Y
         4 000233   000256 604400 4                  TMOZ    s:4704

      169     4700    3       DO;

      170     4701    3           CALL CONCAT(PSN,'DP#',ADDR(DCBADDR(DCBSF)->F$DCB.PSN#)->PSN_V,'/');

   4701  4 000234   000004 236000 1                  LDQ     FTYPE_TO_CC+4
         4 000235   000022 376000 5                  ANQ     18
         4 000236   000040 276007                    ORQ     32,DL
         4 000237   000004 756000 0                  STQ     PSN
         4 000240   000000 621005                    EAX1    0,AL
         4 000241   040000 100540                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:62   
         4 000242   400024 000011                    ADSC9   20,,PR4                  cn=0,n=*X1
         4 000243   000004 600011 0                  ADSC9   PSN                      cn=3,n=9
         4 000244   000003 236000 0                  LDQ     Y
         4 000245   000011 116007                    CMPQ    9,DL
         4 000246   000254 605000 4                  TPL     s:4702
         4 000247   777766 621006                    EAX1    -10,QL
         4 000250   777777 661003                    ERX1    -1,DU
         4 000251   040046 100400                    MLR     fill='040'O
         4 000252   000023 000001 5                  ADSC9   19                       cn=0,n=1
         4 000253   000004 600011 0                  ADSC9   PSN,Q                    cn=3,n=*X1

      171     4702    3           Y=Y+4;

   4702  4 000254   000004 236007                    LDQ     4,DL
         4 000255   000003 056000 0                  ASQ     Y

      172     4703    3           END;

      173     4704    2       CALL CONCAT(RBUF,'SET ',ZI$DIR.SCHEMA_NM.NAME.TEXT,ADDR(PSN)->PSN_V,

   4704  4 000256   000005 236000 1                  LDQ     FTYPE_TO_CC+5
         4 000257   000000 756000 xsym               STQ     RBUF
         4 000260   040000 100400                    MLR     fill='040'O
         4 000261   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30
         4 000262   000001 000036 xsym               ADSC9   RBUF+1                   cn=0,n=30
         4 000263   000003 721000 0                  LXL1    Y
         4 000264   040000 100440                    MLR     fill='040'O
         4 000265   000004 000011 0                  ADSC9   PSN                      cn=0,n=*X1
         4 000266   000010 400336 xsym               ADSC9   RBUF+8                   cn=2,n=222
         4 000267   000003 236000 0                  LDQ     Y
         4 000270   000336 116007                    CMPQ    222,DL
         4 000271   000327 605000 4                  TPL     s:4706
         4 000272   777441 622006                    EAX2    -223,QL
         4 000273   777777 662003                    ERX2    -1,DU
         4 000274   000000 475400 xsym               LDP5    REC2$
         4 000275   000000 723000 xsym               LXL3    X
         4 000276   040046 100540                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:63   
         4 000277   500000 000013                    ADSC9   0,,PR5                   cn=0,n=*X3
         4 000300   000010 400012 xsym               ADSC9   RBUF+8,Q                 cn=2,n=*X2
         4 000301   000000 036000 xsym               ADLQ    X
         4 000302   000336 116007                    CMPQ    222,DL
         4 000303   000327 605000 4                  TPL     s:4706
         4 000304   000054 756000 0                  STQ     @EIS+3
         4 000305   000003 236000 0                  LDQ     Y
         4 000306   000000 036000 xsym               ADLQ    X
         4 000307   000054 724000 0                  LXL4    @EIS+3
         4 000310   777441 624014                    EAX4    -223,X4
         4 000311   777777 664003                    ERX4    -1,DU
         4 000312   040046 100400                    MLR     fill='040'O
         4 000313   000024 000001 5                  ADSC9   20                       cn=0,n=1
         4 000314   000010 400014 xsym               ADSC9   RBUF+8,Q                 cn=2,n=*X4
         4 000315   000055 756000 0                  STQ     @EIS+4
         4 000316   000054 236000 0                  LDQ     @EIS+3
         4 000317   000335 116007                    CMPQ    221,DL
         4 000320   000327 605000 4                  TPL     s:4706
         4 000321   777442 625006                    EAX5    -222,QL
         4 000322   777777 665003                    ERX5    -1,DU
         4 000323   000055 235000 0                  LDA     @EIS+4
         4 000324   040045 100500                    MLR     fill='040'O
         4 000325   400020 000010                    ADSC9   16,,PR4                  cn=0,n=8
         4 000326   000010 600015 xsym               ADSC9   RBUF+8,A                 cn=3,n=*X5

      174     4705    2          CHAR_V,'.',DCBADDR(DCBSF)->F$DCB.ACCT#);
      175     4706    2       CALL SYS_FUNC_RELDCB;

   4706  4 000327   000011 631400 5                  EPPR1   9
         4 000330   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         4 000331   000000 011000                    NOP     0

      176     4707    2       CALL ZIU$SYSCTL ALTRET(ALT);

   4707  4 000332   000011 631400 5                  EPPR1   9
         4 000333   000000 701000 xent               TSX1    ZIU$SYSCTL
         4 000334   000402 702000 4                  TSX2    ALT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:64   

      177     4708    2       IF READ_SW=1 THEN GOTO ALT; /* M$YC FAILED */

   4708  4 000335   000000 235000 xsym               LDA     READ_SW
         4 000336   000001 115007                    CMPA    1,DL
         4 000337   000402 600000 4                  TZE     ALT

      178     4709    2       CALL CONCAT(RBUF,'R ',ZI$DIR.SCHEMA_NM.NAME.TEXT);

   4709  4 000340   000006 220000 1                  LDX0    FTYPE_TO_CC+6
         4 000341   000000 740000 xsym               STX0    RBUF
         4 000342   040000 100400                    MLR     fill='040'O
         4 000343   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30
         4 000344   000000 400376 xsym               ADSC9   RBUF                     cn=2,n=254

      179     4710    2       IF CURR_SCHNM~=ZI$DIR.SCHEMA_NM.NAME.TEXT AND

   4710  4 000345   040000 106400                    CMPC    fill='040'O
         4 000346   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30
         4 000347   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30
         4 000350   000360 600000 4                  TZE     s:4713
         4 000351   000041 236000 0                  LDQ     @TYPE_MSG
         4 000352   000007 116000 5                  CMPQ    7
         4 000353   000360 601000 4                  TNZ     s:4713

      180     4711    2          ADDR(TYPE_MSG)=ADDR(NIL) THEN
      181     4712    2           CALL ERROR_MSG(DBU#PASCH1,ZI$DIR.SCHEMA_NM.NAME.TEXT);

   4712  4 000354   000026 630400 5                  EPPR0   22
         4 000355   000000 631400 5                  EPPR1   0
         4 000356   000000 701000 xent               TSX1    ERROR_MSG
         4 000357   000000 011000                    NOP     0

      182     4713    2       CURR_SCHNM = ZI$DIR.SCHEMA_NM.NAME.TEXT;

   4713  4 000360   040000 100400                    MLR     fill='040'O
         4 000361   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:65   
         4 000362   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30

      183     4714    2       CALL ZIU$Q2SC(,ZI$DIR.SCHEMA_NM.NAME.TEXT) ALTRET(ALT_RDY);

   4714  4 000363   000027 236000 5                  LDQ     23
         4 000364   000007 235000 5                  LDA     7
         4 000365   000054 757000 0                  STAQ    @EIS+3
         4 000366   000054 630400 0                  EPPR0   @EIS+3
         4 000367   000000 631400 5                  EPPR1   0
         4 000370   000000 701000 xent               TSX1    ZIU$Q2SC
         4 000371   000377 702000 4                  TSX2    ALT_RDY

      184     4715    2       CALL ZIU$SYSCTL;

   4715  4 000372   000011 631400 5                  EPPR1   9
         4 000373   000000 701000 xent               TSX1    ZIU$SYSCTL
         4 000374   000000 011000                    NOP     0

      185     4716    2       RETURN;

   4716  4 000375   000040 221200 0                  LDX1  ! @PA_REC_RANGES+1
         4 000376   000001 702211                    TSX2  ! 1,X1

      186     4717    2   ALT_RDY: CALL ZIU$SYSCTL; /* RESET SCHEMA DCB */

   4717  4 000377   000011 631400 5     ALT_RDY      EPPR1   9
         4 000400   000000 701000 xent               TSX1    ZIU$SYSCTL
         4 000401   000000 011000                    NOP     0

      187     4718    2   ALT: ALTRETURN;

   4718  4 000402   000040 221200 0     ALT          LDX1  ! @PA_REC_RANGES+1
         4 000403   000000 702211                    TSX2  ! 0,X1

      188     4719    2   END OPEN_SCHEMA;
      189     4720        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:66   
      190     4721        /*
      191     4722              SUBR     GET_ALL_SC - EXTRACT ALL SET NAMES FROM SCHEMA
      192     4723        */
      193     4724    1   GET_ALL_SC: PROC ALTRET; /* ALTRETURN ON DB_ALT */

   4724  4 000404   000042 741200 0     GET_ALL_SC   STX1  ! @TYPE_MSG+1

      194     4725
      195     4726    2       CALL DB_FRS(RVA.SCREC,RVA.OASC) DBALT;

   4726  4 000405   000030 630400 5                  EPPR0   24
         4 000406   000000 631400 5                  EPPR1   0
         4 000407   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000410   000454 702000 4                  TSX2    DB_ALT

      196     4727    3       DO UNTIL_END_OF_SET; /* LOOP THRU SC */

   4727  4 000411   040000 106400                    CMPC    fill='040'O
         4 000412   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000413   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000414   000452 600000 4                  TZE     s:4738

      197     4728    3           CALL DB_GET(RVA.SCREC) DBALT;

   4728  4 000415   000030 630400 5                  EPPR0   24
         4 000416   000003 631400 5                  EPPR1   3
         4 000417   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000420   000454 702000 4                  TSX2    DB_ALT

      198     4729    3           IF UWA.SC_REC.SETMODE=2 THEN /* PA SETS */

   4729  4 000421   000311 235000 xsym               LDA     UWA+201
         4 000422   000002 115007                    CMPA    2,DL
         4 000423   000442 601000 4                  TNZ     s:4736

      199     4730    4           DO;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:67   
      200     4731    4               CALL DB_FOR(RVA.SNSE) DBALT;

   4731  4 000424   000005 630400 5                  EPPR0   5
         4 000425   000003 631400 5                  EPPR1   3
         4 000426   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 000427   000454 702000 4                  TSX2    DB_ALT

      201     4732    4               CALL DB_GET(RVA.SNREC) DBALT; /* GET ITS NAME */

   4732  4 000430   000006 630400 5                  EPPR0   6
         4 000431   000003 631400 5                  EPPR1   3
         4 000432   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000433   000454 702000 4                  TSX2    DB_ALT

      202     4733    4               RCNT = RCNT+1;

   4733  4 000434   000000 054000 xsym               AOS     RCNT

      203     4734    4               RECORD_LIST.NAME(RCNT)=UWA.SN_REC.SENAME;

   4734  4 000435   000000 235000 xsym               LDA     RCNT
         4 000436   000005 735000                    ALS     5
         4 000437   040005 100400                    MLR     fill='040'O
         4 000440   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 000441   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30

      204     4735    4               END;

      205     4736    3           CALL DB_FRS(RVA.SCREC,RVA.OASC) DBALT;

   4736  4 000442   000030 630400 5                  EPPR0   24
         4 000443   000000 631400 5                  EPPR1   0
         4 000444   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000445   000454 702000 4                  TSX2    DB_ALT

      206     4737    3           END;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:68   
   4737  4 000446   040000 106400                    CMPC    fill='040'O
         4 000447   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000450   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000451   000415 601000 4                  TNZ     s:4728

      207     4738    2       RETURN;

   4738  4 000452   000042 221200 0                  LDX1  ! @TYPE_MSG+1
         4 000453   000001 702211                    TSX2  ! 1,X1

      208     4739    2   DB_ALT: ALTRETURN;

   4739  4 000454   000042 221200 0     DB_ALT       LDX1  ! @TYPE_MSG+1
         4 000455   000000 702211                    TSX2  ! 0,X1

      209     4740    2   END GET_ALL_SC;
      210     4741        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:69   
      211     4742        /*
      212     4743              SUBR    CHK_DMCL  -  FOR SECURITY REASON, WE WANT TO
      213     4744                      MAKE SURE THAT WHEN DOING RESTRUCTURE THE SOURCE AND
      214     4745                      TARGET SCHEMAS ARE GENERATED BY THE SAME DDL, IN
      215     4746                      ORDER TO ACHIEVE THIS, THE EASIEST WAY IS TO BE ABLE
      216     4747                      TO FIND THE DMCL TIME FOR THE SOURCE SCHEMA IN THE
      217     4748                      TARGET SCHEMA. IN OTHER WORD, THE TARGET IS THE SAME
      218     4749                      COPY OF THE SOURCE PLUS SOME ADDITIONAL DMCL OPERATIO.
      219     4750                      THIS WILL IMPOSE CERTAIN RESTICTIONS AND MAYBE INCONVIENCE
      220     4751                      SO WE HAVE ANOTHER FLAG ZI$DIR.SKIP_DMCL TO SKIP IT.
      221     4752        */
      222     4753    1   CHK_DMCL: PROC ALTRET;

   4753  4 000456   000043 741200 0     CHK_DMCL     STX1  ! @TYPE_MSG+2

      223     4754
      224     4755    2       CALL DB_FRS(RVA.ADREC,RVA.SFAD) DBALT;

   4755  4 000457   000032 630400 5                  EPPR0   26
         4 000460   000000 631400 5                  EPPR1   0
         4 000461   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000462   000522 702000 4                  TSX2    DB_ALT

      225     4756    3       DO UNTIL_END_OF_SET;

   4756  4 000463   040000 106400                    CMPC    fill='040'O
         4 000464   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000465   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000466   000514 600000 4                  TZE     s:4763

      226     4757    3           CALL DB_GET(RVA.ADREC) DBALT;

   4757  4 000467   000032 630400 5                  EPPR0   26
         4 000470   000003 631400 5                  EPPR1   3
         4 000471   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000472   000522 702000 4                  TSX2    DB_ALT

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:70   
      227     4758    3           IF UWA.AD_REC.ADFUNC=2 AND

   4758  4 000473   000170 235000 xsym               LDA     UWA+120
         4 000474   000002 115007                    CMPA    2,DL
         4 000475   000504 601000 4                  TNZ     s:4761
         4 000476   040000 106400                    CMPC    fill='040'O
         4 000477   000171 000014 xsym               ADSC9   UWA+121                  cn=0,n=12
         4 000500   000013 000020 0                  ADSC9   DMCL_TSTAMP              cn=0,n=16
         4 000501   000504 601000 4                  TNZ     s:4761

      228     4759    3              UWA.AD_REC.ADDATE_RD=DMCL_TSTAMP THEN
      229     4760    3               RETURN; /* SOURCE DMCL FOUND IN TARGET DMCL */

   4760  4 000502   000043 221200 0                  LDX1  ! @TYPE_MSG+2
         4 000503   000001 702211                    TSX2  ! 1,X1

      230     4761    3           CALL DB_FRS(RVA.ADREC,RVA.SFAD) DBALT;

   4761  4 000504   000032 630400 5                  EPPR0   26
         4 000505   000000 631400 5                  EPPR1   0
         4 000506   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000507   000522 702000 4                  TSX2    DB_ALT

      231     4762    3           END;

   4762  4 000510   040000 106400                    CMPC    fill='040'O
         4 000511   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000512   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000513   000467 601000 4                  TNZ     s:4757

      232     4763    2       CALL ERROR_MSG(DBU#PADMCLER,DMCL_TSTAMP);

   4763  4 000514   000035 630400 5                  EPPR0   29
         4 000515   000000 631400 5                  EPPR1   0
         4 000516   000000 701000 xent               TSX1    ERROR_MSG
         4 000517   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:71   
      233     4764    2       ALTRETURN;

   4764  4 000520   000043 221200 0                  LDX1  ! @TYPE_MSG+2
         4 000521   000000 702211                    TSX2  ! 0,X1

      234     4765    2   DB_ALT: UWA.SN_REC.SENAME=UWA.DB_STATUS;

   4765  4 000522   040000 100400       DB_ALT       MLR     fill='040'O
         4 000523   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000524   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30

      235     4766    2       CALL ERROR_MSG(DBU#DBERR,UWA.SN_REC.SENAME,COMMAND_TEXT);

   4766  4 000525   000040 630400 5                  EPPR0   32
         4 000526   000012 631400 5                  EPPR1   10
         4 000527   000000 701000 xent               TSX1    ERROR_MSG
         4 000530   000000 011000                    NOP     0

      236     4767    2       ALTRETURN;

   4767  4 000531   000043 221200 0                  LDX1  ! @TYPE_MSG+2
         4 000532   000000 702211                    TSX2  ! 0,X1

      237     4768    2   END CHK_DMCL;
      238     4769        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:72   
      239     4770        /*
      240     4771                      PROCESSING STARTS HERE
      241     4772        */
      242     4773    1       NO_AREAS=-1;

   4773  4 000533   000001 335007                    LCA     1,DL
         4 000534   000000 755000 xsym               STA     NO_AREAS

      243     4774    1       IF ZI$DIR.CODE=#COMPACT THEN

   4774  4 000535   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000536   000043 376000 5                  ANQ     35
         4 000537   000044 116000 5                  CMPQ    36
         4 000540   000545 601000 4                  TNZ     s:4777

      244     4775    1           COMMAND_TEXT='COMPACT';

   4775  4 000541   040000 100400                    MLR     fill='040'O
         4 000542   000007 000007 1                  ADSC9   FTYPE_TO_CC+7            cn=0,n=7
         4 000543   000000 000020 xsym               ADSC9   COMMAND_TEXT             cn=0,n=16
         4 000544   000572 710000 4                  TRA     s:4788

      245     4776    1       ELSE
      246     4777    1           IF ZI$DIR.CODE=#REBUILDPA THEN

   4777  4 000545   000045 116000 5                  CMPQ    37
         4 000546   000553 601000 4                  TNZ     s:4780

      247     4778    1               COMMAND_TEXT='REBUILD';

   4778  4 000547   040000 100400                    MLR     fill='040'O
         4 000550   000011 000007 1                  ADSC9   FTYPE_TO_CC+9            cn=0,n=7
         4 000551   000000 000020 xsym               ADSC9   COMMAND_TEXT             cn=0,n=16
         4 000552   000572 710000 4                  TRA     s:4788

      248     4779    1           ELSE
      249     4780    1               IF ZI$DIR.CODE=#CONVERT THEN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:73   

   4780  4 000553   000005 116003                    CMPQ    5,DU
         4 000554   000561 601000 4                  TNZ     s:4783

      250     4781    1                   COMMAND_TEXT='CONV_TO_PA';

   4781  4 000555   040000 100400                    MLR     fill='040'O
         4 000556   000013 000012 1                  ADSC9   FTYPE_TO_CC+11           cn=0,n=10
         4 000557   000000 000020 xsym               ADSC9   COMMAND_TEXT             cn=0,n=16
         4 000560   000572 710000 4                  TRA     s:4788

      251     4782    1               ELSE
      252     4783    1                   IF ZI$DIR.CODE=#REVERT THEN

   4783  4 000561   000046 116000 5                  CMPQ    38
         4 000562   000567 601000 4                  TNZ     s:4786

      253     4784    1                       COMMAND_TEXT='CONV_TO_CHAIN';

   4784  4 000563   040000 100400                    MLR     fill='040'O
         4 000564   000016 000015 1                  ADSC9   FTYPE_TO_CC+14           cn=0,n=13
         4 000565   000000 000020 xsym               ADSC9   COMMAND_TEXT             cn=0,n=16
         4 000566   000572 710000 4                  TRA     s:4788

      254     4785    1                   ELSE
      255     4786    1                       COMMAND_TEXT='RESORT';

   4786  4 000567   040000 100400                    MLR     fill='040'O
         4 000570   000022 000006 1                  ADSC9   FTYPE_TO_CC+18           cn=0,n=6
         4 000571   000000 000020 xsym               ADSC9   COMMAND_TEXT             cn=0,n=16

      256     4787
      257     4788    1       IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN

   4788  4 000572   000000 236000 xsym               LDQ     COMMAND_TEXT
         4 000573   000013 116000 1                  CMPQ    FTYPE_TO_CC+11
         4 000574   000634 601000 4                  TNZ     s:4808
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:74   

      258     4789    2       DO;

      259     4790    2           IF SCHEMA_ACTIVE THEN /* IF THERE IS A SCHEMA ACTIVE */

   4790  4 000575   000000 234000 xsym               SZN     SCHEMA_ACTIVE
         4 000576   000611 605000 4                  TPL     s:4800

      260     4791    3           DO;

      261     4792    3               CALL DB_FUNC_FIN; /* CLOSE THIS SCHEMA */

   4792  4 000577   000011 631400 5                  EPPR1   9
         4 000600   000000 701000 xent               TSX1    DB_FUNC_FIN
         4 000601   000000 011000                    NOP     0

      262     4793    3               SCHEMA_ACTIVE = '0'B; /* DIS-ACTIVE THAT SCHEMA */

   4793  4 000602   000000 450000 xsym               STZ     SCHEMA_ACTIVE

      263     4794    3               IF XREF_BUILT THEN

   4794  4 000603   000000 234000 xsym               SZN     XREF_BUILT
         4 000604   000611 605000 4                  TPL     s:4800

      264     4795    4               DO;

      265     4796    4                   CALL FREE_DYN_MEM;

   4796  4 000605   000011 631400 5                  EPPR1   9
         4 000606   000000 701000 xent               TSX1    FREE_DYN_MEM
         4 000607   000000 011000                    NOP     0

      266     4797    4                   XREF_BUILT='0'B;

   4797  4 000610   000000 450000 xsym               STZ     XREF_BUILT

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:75   
      267     4798    4                   END;

      268     4799    3               END;

      269     4800    2           CURR_SCHNM=' ';

   4800  4 000611   040000 100400                    MLR     fill='040'O
         4 000612   000021 000001 5                  ADSC9   17                       cn=0,n=1
         4 000613   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30

      270     4801    2           RBUF = 'DI SOURCE_SCHEMA,TARGET_SCHEMA';

   4801  4 000614   040000 100400                    MLR     fill='040'O
         4 000615   000024 000036 1                  ADSC9   FTYPE_TO_CC+20           cn=0,n=30
         4 000616   000000 000400 xsym               ADSC9   RBUF                     cn=0,n=256

      271     4802    2           CALL ZIU$SYSCTL ALTRET(ALT_ZIU$CMPT_INIT);

   4802  4 000617   000011 631400 5                  EPPR1   9
         4 000620   000000 701000 xent               TSX1    ZIU$SYSCTL
         4 000621   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      272     4803    2           ZI$DIR.SCHEMA_NM.NAME.TEXT='SOURCE_SCHEMA';

   4803  4 000622   040000 100400                    MLR     fill='040'O
         4 000623   000034 000015 1                  ADSC9   FTYPE_TO_CC+28           cn=0,n=13
         4 000624   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30

      273     4804    2           CALL OPEN_SCHEMA ALTRET(ALT_ZIU$CMPT_INIT);

   4804  4 000625   000007 236000 5                  LDQ     7
         4 000626   000041 756000 0                  STQ     @PA_REC_RANGES+2
         4 000627   000154 701000 4                  TSX1    OPEN_SCHEMA
         4 000630   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      274     4805    2           DMCL_TSTAMP=UWA.AD_REC.ADDATE_RD;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:76   
   4805  4 000631   040000 100400                    MLR     fill='040'O
         4 000632   000171 000014 xsym               ADSC9   UWA+121                  cn=0,n=12
         4 000633   000013 000020 0                  ADSC9   DMCL_TSTAMP              cn=0,n=16

      275     4806    2           END;

      276     4807
      277     4808    1       IF ZI$DIR.CODE=#CONVERT THEN /* RESTRUCTURE SET MODE */

   4808  4 000634   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000635   000043 376000 5                  ANQ     35
         4 000636   000005 116003                    CMPQ    5,DU
         4 000637   000662 601000 4                  TNZ     s:4818

      278     4809    2       DO;

      279     4810    2           CALL GET_ALL_SC DBALT; /* GET ALL THE SET SORTED BY DEFINED KEYS */

   4810  4 000640   000404 701000 4                  TSX1    GET_ALL_SC
         4 000641   003155 702000 4                  TSX2    DB_ALT

      280     4811    2           CALL DB_FUNC_FIN ALTRET(ALT_ZIU$CMPT_INIT); /* RELEASE SOURCE SCHEMA */

   4811  4 000642   000011 631400 5                  EPPR1   9
         4 000643   000000 701000 xent               TSX1    DB_FUNC_FIN
         4 000644   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      281     4812    2           ZI$DIR.SCHEMA_NM.NAME.TEXT='TARGET_SCHEMA';

   4812  4 000645   040000 100400                    MLR     fill='040'O
         4 000646   000040 000015 1                  ADSC9   FTYPE_TO_CC+32           cn=0,n=13
         4 000647   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30

      282     4813    2           CALL OPEN_SCHEMA ALTRET(ALT_ZIU$CMPT_INIT);

   4813  4 000650   000007 236000 5                  LDQ     7
         4 000651   000041 756000 0                  STQ     @PA_REC_RANGES+2
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:77   
         4 000652   000154 701000 4                  TSX1    OPEN_SCHEMA
         4 000653   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      283     4814    2           IF ZI$DIR.SKIP_DMCL_CHK='0'B THEN

   4814  4 000654   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000655   000020 316007                    CANQ    16,DL
         4 000656   000717 601000 4                  TNZ     s:4834

      284     4815    2               CALL CHK_DMCL ALTRET(CLOSE_SCHEMA);

   4815  4 000657   000456 701000 4                  TSX1    CHK_DMCL
         4 000660   003164 702000 4                  TSX2    CLOSE_SCHEMA

      285     4816    2           END;

   4816  4 000661   000717 710000 4                  TRA     s:4834

      286     4817    1       ELSE
      287     4818    1           IF ZI$DIR.CODE=#REVERT THEN /* FROM PA TO NON-PA */

   4818  4 000662   000046 116000 5                  CMPQ    38
         4 000663   000717 601000 4                  TNZ     s:4834

      288     4819    2           DO;

      289     4820    2               CALL DB_FUNC_FIN ALTRET(ALT_ZIU$CMPT_INIT);

   4820  4 000664   000011 631400 5                  EPPR1   9
         4 000665   000000 701000 xent               TSX1    DB_FUNC_FIN
         4 000666   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      290     4821    2               ZI$DIR.SCHEMA_NM.NAME.TEXT='TARGET_SCHEMA';

   4821  4 000667   040000 100400                    MLR     fill='040'O
         4 000670   000040 000015 1                  ADSC9   FTYPE_TO_CC+32           cn=0,n=13
         4 000671   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:78   

      291     4822    2               CALL OPEN_SCHEMA ALTRET(ALT_ZIU$CMPT_INIT);

   4822  4 000672   000007 236000 5                  LDQ     7
         4 000673   000041 756000 0                  STQ     @PA_REC_RANGES+2
         4 000674   000154 701000 4                  TSX1    OPEN_SCHEMA
         4 000675   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      292     4823    2               CALL GET_ALL_SC DBALT; /* GET ALL THE SET SORTED BY DEFINED KEYS */

   4823  4 000676   000404 701000 4                  TSX1    GET_ALL_SC
         4 000677   003155 702000 4                  TSX2    DB_ALT

      293     4824    2               IF ZI$DIR.SKIP_DMCL_CHK='0'B THEN

   4824  4 000700   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000701   000020 316007                    CANQ    16,DL
         4 000702   000705 601000 4                  TNZ     s:4826

      294     4825    2                   CALL CHK_DMCL ALTRET(CLOSE_SCHEMA);

   4825  4 000703   000456 701000 4                  TSX1    CHK_DMCL
         4 000704   003164 702000 4                  TSX2    CLOSE_SCHEMA

      295     4826    2               CALL DB_FUNC_FIN ALTRET(ALT_ZIU$CMPT_INIT); /* RELEASE TARGET SCHEMA */

   4826  4 000705   000011 631400 5                  EPPR1   9
         4 000706   000000 701000 xent               TSX1    DB_FUNC_FIN
         4 000707   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      296     4827    2               ZI$DIR.SCHEMA_NM.NAME.TEXT='SOURCE_SCHEMA';

   4827  4 000710   040000 100400                    MLR     fill='040'O
         4 000711   000034 000015 1                  ADSC9   FTYPE_TO_CC+28           cn=0,n=13
         4 000712   000223 200036 xsym               ADSC9   ZI$DIR+147               cn=1,n=30

      297     4828    2               CALL OPEN_SCHEMA(X) ALTRET(ALT_ZIU$CMPT_INIT);
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:79   

   4828  4 000713   000047 236000 5                  LDQ     39
         4 000714   000041 756000 0                  STQ     @PA_REC_RANGES+2
         4 000715   000154 701000 4                  TSX1    OPEN_SCHEMA
         4 000716   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      298     4829    2               END;

      299     4830        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:80   
      300     4831        /*
      301     4832              BUILD AREA TABLE FIRST, AND THEN GO THRU OASC TO FIND SET WE WANTED
      302     4833        */
      303     4834    1       CALL DB_FDR(RVA.OAREC,UWA.SF_REC.DBKOA) DBALT;

   4834  4 000717   000050 630400 5                  EPPR0   40
         4 000720   000000 631400 5                  EPPR1   0
         4 000721   000000 701000 xent               TSX1    DB_FUNC_FDR
         4 000722   003155 702000 4                  TSX2    DB_ALT

      304     4835    1       CALL DB_FRS(RVA.ACREC,RVA.OAAC) DBALT;

   4835  4 000723   000052 630400 5                  EPPR0   42
         4 000724   000000 631400 5                  EPPR1   0
         4 000725   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 000726   003155 702000 4                  TSX2    DB_ALT

      305     4836    2       DO UNTIL_END_OF_SET;

   4836  4 000727   040000 106400                    CMPC    fill='040'O
         4 000730   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 000731   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 000732   001041 600000 4                  TZE     s:4865

      306     4837    2           CALL DB_GET(RVA.ACREC) DBALT;

   4837  4 000733   000052 630400 5                  EPPR0   42
         4 000734   000003 631400 5                  EPPR1   3
         4 000735   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000736   003155 702000 4                  TSX2    DB_ALT

      307     4838    2           IF UWA.AC_REC.PG_TYPE>0 THEN GOTO NOT_IDS;

   4838  4 000737   000237 235000 xsym               LDA     UWA+159
         4 000740   001031 605400 4                  TPNZ    NOT_IDS

      308     4839    2           CALL DB_FOR(RVA.SNSE) DBALT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:81   

   4839  4 000741   000005 630400 5                  EPPR0   5
         4 000742   000003 631400 5                  EPPR1   3
         4 000743   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 000744   003155 702000 4                  TSX2    DB_ALT

      309     4840    2           CALL DB_GET(RVA.SNREC) DBALT;

   4840  4 000745   000006 630400 5                  EPPR0   6
         4 000746   000003 631400 5                  EPPR1   3
         4 000747   000000 701000 xent               TSX1    DB_FUNC_GET
         4 000750   003155 702000 4                  TSX2    DB_ALT

      310     4841    2           IF NO_AREAS>=%MAX_AREAS THEN

   4841  4 000751   000000 235000 xsym               LDA     NO_AREAS
         4 000752   000057 115007                    CMPA    47,DL
         4 000753   003172 605000 4                  TPL     AC_OVERFLOW

      311     4842    2               GOTO AC_OVERFLOW; /* ABORT THE JOB, NO RECOVERY POSSIBLE */
      312     4843    2           NO_AREAS=NO_AREAS+1; /* BUMP COUNTER */

   4843  4 000754   000000 054000 xsym               AOS     NO_AREAS

      313     4844    2           AC_TBL.NAME(NO_AREAS)=UWA.SN_REC.SENAME;

   4844  4 000755   000000 236000 xsym               LDQ     NO_AREAS
         4 000756   000060 402007                    MPY     48,DL
         4 000757   040006 100400                    MLR     fill='040'O
         4 000760   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 000761   000003 400036 xsym               ADSC9   AC_TBL+3,Q               cn=2,n=30

      314     4845    2           AC_TBL.DCB#(NO_AREAS)=0;

   4845  4 000762   000000 236000 xsym               LDQ     NO_AREAS
         4 000763   000014 402007                    MPY     12,DL
         4 000764   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:82   
         4 000765   000054 236000 5                  LDQ     44
         4 000766   000013 356010 xsym               ANSQ    AC_TBL+11,X0

      315     4846    2           AC_TBL.LPP(NO_AREAS)=UWA.AC_REC.LPP; /* SAVE LINE PER PAGE */

   4846  4 000767   000253 236000 xsym               LDQ     UWA+171
         4 000770   000032 736000                    QLS     26
         4 000771   000013 676010 xsym               ERQ     AC_TBL+11,X0
         4 000772   777400 376003                    ANQ     -256,DU
         4 000773   000013 656010 xsym               ERSQ    AC_TBL+11,X0

      316     4847    2           AC_TBL.BASE_DBK(NO_AREAS)=UWA.AC_REC.BASE_DBK;

   4847  4 000774   000242 235000 xsym               LDA     UWA+162
         4 000775   000000 755010 xsym               STA     AC_TBL,X0

      317     4848    2           AC_TBL.RANGE_LOW(NO_AREAS)=%BITBIN('777777777'O); /* TO MAX */

   4848  4 000776   000055 236000 5                  LDQ     45
         4 000777   000001 756010 xsym               STQ     AC_TBL+1,X0

      318     4849    2           AC_TBL.RANGE_HIGH(NO_AREAS)=0; /* INIT TO MIN */

   4849  4 001000   000002 450010 xsym               STZ     AC_TBL+2,X0

      319     4850    2           AC_TBL.LNLP(NO_AREAS)=

   4850  4 001001   000246 236000 xsym               LDQ     UWA+166
         4 001002   000245 136000 xsym               SBLQ    UWA+165
         4 001003   000001 036007                    ADLQ    1,DL
         4 001004   000253 506000 xsym               DIV     UWA+171
         4 001005   000044 733000                    LRS     36
         4 001006   000011 736000                    QLS     9
         4 001007   000013 676010 xsym               ERQ     AC_TBL+11,X0
         4 001010   000056 376000 5                  ANQ     46
         4 001011   000013 656010 xsym               ERSQ    AC_TBL+11,X0

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:83   
      320     4851    2              MOD(UWA.AC_REC.MAX_DBK-UWA.AC_REC.MIN_DBK+1,UWA.AC_REC.LPP);
      321     4852    2           IF AC_TBL.LNLP(NO_AREAS)=0 THEN

   4852  4 001012   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 001013   000056 316000 5                  CANQ    46
         4 001014   001022 601000 4                  TNZ     s:4854

      322     4853    2               AC_TBL.LNLP(NO_AREAS)=UWA.AC_REC.LPP;

   4853  4 001015   000253 236000 xsym               LDQ     UWA+171
         4 001016   000011 736000                    QLS     9
         4 001017   000013 676010 xsym               ERQ     AC_TBL+11,X0
         4 001020   000056 376000 5                  ANQ     46
         4 001021   000013 656010 xsym               ERSQ    AC_TBL+11,X0

      323     4854    2           AC_TBL.PAGE_WRITTEN(NO_AREAS)='0'B;

   4854  4 001022   000057 236000 5                  LDQ     47
         4 001023   000013 356010 xsym               ANSQ    AC_TBL+11,X0

      324     4855    2           AC_TBL.CHECKSUM(NO_AREAS)=UWA.AC_REC.SWS.CHECKSUM;

   4855  4 001024   000233 236000 xsym               LDQ     UWA+155
         4 001025   000033 772000                    QRL     27
         4 001026   000013 676010 xsym               ERQ     AC_TBL+11,X0
         4 001027   000400 376007                    ANQ     256,DL
         4 001030   000013 656010 xsym               ERSQ    AC_TBL+11,X0

      325     4856    2   NOT_IDS: CALL DB_FRS(RVA.ACREC,RVA.OAAC) DBALT;

   4856  4 001031   000052 630400 5     NOT_IDS      EPPR0   42
         4 001032   000000 631400 5                  EPPR1   0
         4 001033   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 001034   003155 702000 4                  TSX2    DB_ALT

      326     4857    2           END; /* AC_TBL BUILT */

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:84   
   4857  4 001035   040000 106400                    CMPC    fill='040'O
         4 001036   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 001037   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 001040   000733 601000 4                  TNZ     s:4837

      327     4858
      328     4859        /*
      329     4860              NOW, CREATE ALL TABLES BY GOING FROM ALL THE SC
      330     4861              IF A SC FOR A PA_SET IS FOUND AND IS TO BE PROCESSED,
      331     4862              WE WILL GET ALL ITS SM AND THEN ALL THE CF AS WELL AS THE
      332     4863              RA SO WE ONLY OPEN THE AREAS THAT HAVE PA MEMBERS IN IT
      333     4864        */
      334     4865    1       TYPE='0'B; /* INIT THIS TABLE */

   4865  4 001041   017502 220003                    LDX0    8002,DU
         4 001042   000040 100400                    MLR     fill='000'O
         4 001043   000011 000001 5                  ADSC9   9                        cn=0,n=1
         4 001044   000000 000010 xsym               ADSC9   TYPE                     cn=0,n=*X0

      335     4866    1       MAX_KEY_SIZE=0; /* INIT TO MIN */

   4866  4 001045   000000 450000 xsym               STZ     MAX_KEY_SIZE

      336     4867    1       SC_PTR=-1;

   4867  4 001046   000001 335007                    LCA     1,DL
         4 001047   000000 755000 xsym               STA     SC_PTR

      337     4868    1       RC_PTR=0; /* THIS TABLE STARTS FROM INDX=1 */

   4868  4 001050   000000 450000 xsym               STZ     RC_PTR

      338     4869    1       KEY_PTR=-1;

   4869  4 001051   000000 755000 xsym               STA     KEY_PTR

      339     4870    1       IF ZI$DIR.INIT_TMPLT_KEY=0 THEN /* NO PERCENT TO PACK SPECIFIED */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:85   

   4870  4 001052   000221 236000 xsym               LDQ     ZI$DIR+145
         4 001053   001057 601000 4                  TNZ     s:4873

      340     4871    1           ZI$DIR.INIT_TMPLT_KEY=85; /* USE DEFAULT */

   4871  4 001054   000125 235007                    LDA     85,DL
         4 001055   000221 755000 xsym               STA     ZI$DIR+145
         4 001056   001067 710000 4                  TRA     s:4878

      341     4872    1       ELSE
      342     4873    1           IF ZI$DIR.INIT_TMPLT_KEY>100 THEN

   4873  4 001057   000145 116007                    CMPQ    101,DL
         4 001060   001067 602000 4                  TNC     s:4878

      343     4874    2           DO;

      344     4875    2               ZI$DIR.INIT_TMPLT_KEY=85; /* DEFAULT FULL PERCENT=85 */

   4875  4 001061   000125 235007                    LDA     85,DL
         4 001062   000221 755000 xsym               STA     ZI$DIR+145

      345     4876    2               CALL ERROR_MSG(DBU#PAPER85);

   4876  4 001063   000061 630400 5                  EPPR0   49
         4 001064   000003 631400 5                  EPPR1   3
         4 001065   000000 701000 xent               TSX1    ERROR_MSG
         4 001066   000000 011000                    NOP     0

      346     4877    2               END;

      347     4878    1       CALL DB_FDR(RVA.SFREC,2) DBALT; /* SETUP CURR OF AREA */

   4878  4 001067   000063 630400 5                  EPPR0   51
         4 001070   000000 631400 5                  EPPR1   0
         4 001071   000000 701000 xent               TSX1    DB_FUNC_FDR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:86   
         4 001072   003155 702000 4                  TSX2    DB_ALT

      348     4879    1       CALL DB_FRA(RVA.SNREC) DBALT;

   4879  4 001073   000006 630400 5                  EPPR0   6
         4 001074   000003 631400 5                  EPPR1   3
         4 001075   000000 701000 xent               TSX1    DB_FUNC_FRA
         4 001076   003155 702000 4                  TSX2    DB_ALT

      349     4880    1       DIR_REF = UWA.DIR_REF; /* SAVE CURR OF AREA */

   4880  4 001077   000036 235000 xsym               LDA     UWA+30
         4 001100   000007 755000 0                  STA     BUF_PTR

      350     4881    2       DO UNTIL_END_OF_SET;

   4881  4 001101   040000 106400                    CMPC    fill='040'O
         4 001102   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 001103   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 001104   002505 600000 4                  TZE     s:5140

      351     4882    2           CALL DB_GET(RVA.SNREC) DBALT;

   4882  4 001105   000006 630400 5                  EPPR0   6
         4 001106   000003 631400 5                  EPPR1   3
         4 001107   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001110   003155 702000 4                  TSX2    DB_ALT

      352     4883    2           IF UWA.SN_REC.SETYPE~=30 THEN GOTO NEXT_SC; /* NOT SN FOR SC */

   4883  4 001111   000424 235000 xsym               LDA     UWA+276
         4 001112   000036 115007                    CMPA    30,DL
         4 001113   002467 601000 4                  TNZ     NEXT_SC

      353     4884    2           CALL DB_FRS(RVA.SCREC,RVA.SNSE) DBALT;

   4884  4 001114   000065 630400 5                  EPPR0   53
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:87   
         4 001115   000000 631400 5                  EPPR1   0
         4 001116   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 001117   003155 702000 4                  TSX2    DB_ALT

      354     4885    2           CALL DB_GET(RVA.SCREC) DBALT;

   4885  4 001120   000030 630400 5                  EPPR0   24
         4 001121   000003 631400 5                  EPPR1   3
         4 001122   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001123   003155 702000 4                  TSX2    DB_ALT

      355     4886        /*       CHECK WETHER THIS SC IS SELECTED OR NOT */
      356     4887    2           X = RCNT + 1; /* ASSUME THIS SC NOT INCLUDED */

   4887  4 001124   000000 235000 xsym               LDA     RCNT
         4 001125   000001 035007                    ADLA    1,DL
         4 001126   000000 755000 xsym               STA     X

      357     4888    2           IF UWA.SC_REC.SETORD>3 THEN /* SET IS SORTED */

   4888  4 001127   000312 236000 xsym               LDQ     UWA+202
         4 001130   000003 116007                    CMPQ    3,DL
         4 001131   001212 604400 4                  TMOZ    s:4910

      358     4889    2               IF (ZI$DIR.CODE~=#RESORT AND UWA.SC_REC.SETMODE=2) OR

   4889  4 001132   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001133   000043 376000 5                  ANQ     35
         4 001134   000067 116000 5                  CMPQ    55
         4 001135   001141 600000 4                  TZE     s:4889+7
         4 001136   000311 235000 xsym               LDA     UWA+201
         4 001137   000002 115007                    CMPA    2,DL
         4 001140   001146 600000 4                  TZE     s:4894
         4 001141   000067 116000 5                  CMPQ    55
         4 001142   001212 601000 4                  TNZ     s:4910
         4 001143   000311 235000 xsym               LDA     UWA+201
         4 001144   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:88   
         4 001145   001212 600000 4                  TZE     s:4910

      359     4890         /* COMMAND IS PA RELATED AND SET IS INDEED PA SET */
      360     4891    2                  (ZI$DIR.CODE=#RESORT AND UWA.SC_REC.SETMODE~=2) THEN
      361     4892         /* COMMAND IS NON-PA AND SET FOUND IS NON-PA */
      362     4893    3               DO;

      363     4894    3                   IF RCNT = -1 THEN

   4894  4 001146   000000 235000 xsym               LDA     RCNT
         4 001147   000070 115000 5                  CMPA    56
         4 001150   001154 601000 4                  TNZ     s:4897

      364     4895    3                       X = -1; /* NO SET-NAME-LIST, SO ALL INCLUDED */

   4895  4 001151   000001 335007                    LCA     1,DL
         4 001152   000000 755000 xsym               STA     X
         4 001153   001205 710000 4                  TRA     s:4907

      365     4896    3                   ELSE
      366     4897    4                   DO Y=0 TO RCNT; /* SEARCH THRU SET-NAME-LIST */

   4897  4 001154   000003 450000 0                  STZ     Y
         4 001155   001202 710000 4                  TRA     s:4906+1

      367     4898    4                       IF RECORD_LIST.NAME(Y)=UWA.SN_REC.SENAME THEN

   4898  4 001156   000003 235000 0                  LDA     Y
         4 001157   000005 735000                    ALS     5
         4 001160   040000 106405                    CMPC    fill='040'O
         4 001161   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 001162   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 001163   001201 601000 4                  TNZ     s:4906

      368     4899    5                       DO;

      369     4900    5                           X=Y;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:89   

   4900  4 001164   000003 236000 0                  LDQ     Y
         4 001165   000000 756000 xsym               STQ     X

      370     4901    5                           Y=RCNT+1;

   4901  4 001166   000000 235000 xsym               LDA     RCNT
         4 001167   000001 035007                    ADLA    1,DL
         4 001170   000003 755000 0                  STA     Y

      371     4902    5                           RECORD_LIST.NAME(X)=' ';

   4902  4 001171   000000 235000 xsym               LDA     X
         4 001172   000005 735000                    ALS     5
         4 001173   040005 100400                    MLR     fill='040'O
         4 001174   000021 000001 5                  ADSC9   17                       cn=0,n=1
         4 001175   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30

      372     4903    5                           IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN

   4903  4 001176   000000 236000 xsym               LDQ     COMMAND_TEXT
         4 001177   000013 116000 1                  CMPQ    FTYPE_TO_CC+11
         4 001200   002467 600000 4                  TZE     NEXT_SC

      373     4904    5                               GOTO NEXT_SC; /* CANCEL OUT THIS PA (NO CHANGED) */
      374     4905    5                           END;

      375     4906    4                       END;

   4906  4 001201   000003 054000 0                  AOS     Y
         4 001202   000003 236000 0                  LDQ     Y
         4 001203   000000 116000 xsym               CMPQ    RCNT
         4 001204   001156 604400 4                  TMOZ    s:4898

      376     4907    3                   IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN

   4907  4 001205   000000 236000 xsym               LDQ     COMMAND_TEXT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:90   
         4 001206   000013 116000 1                  CMPQ    FTYPE_TO_CC+11
         4 001207   001212 601000 4                  TNZ     s:4910

      377     4908    3                       X = -1;

   4908  4 001210   000001 335007                    LCA     1,DL
         4 001211   000000 755000 xsym               STA     X

      378     4909    3                   END;

      379     4910    2           IF X <= RCNT THEN

   4910  4 001212   000000 236000 xsym               LDQ     X
         4 001213   000000 116000 xsym               CMPQ    RCNT
         4 001214   002467 605400 4                  TPNZ    NEXT_SC

      380     4911    3           DO; /* THIS  SET IS TO BE PROCESSED */

      381     4912    3               SC_PTR=SC_PTR+1;

   4912  4 001215   000000 054000 xsym               AOS     SC_PTR

      382     4913    3               IF SC_PTR>%MAX_PA_SET THEN

   4913  4 001216   000000 235000 xsym               LDA     SC_PTR
         4 001217   000077 115007                    CMPA    63,DL
         4 001220   003204 605400 4                  TPNZ    SC_OVERFLOW

      383     4914    3                   GOTO SC_OVERFLOW; /* SC TBL OVERFLOW */
      384     4915    3               SC_TBL.NAME(SC_PTR)=SUBSTR(UWA.SN_REC.SENAME,0,15);

   4915  4 001221   000000 236000 xsym               LDQ     SC_PTR
         4 001222   000035 402007                    MPY     29,DL
         4 001223   040006 100400                    MLR     fill='040'O
         4 001224   000427 000017 xsym               ADSC9   UWA+279                  cn=0,n=15
         4 001225   000000 000020 xsym               ADSC9   SC_TBL,Q                 cn=0,n=16

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:91   
      385     4916    3               SC_TBL.GLOBAL(SC_PTR)=UWA.SC_REC.SETGLO;

   4916  4 001226   000000 236000 xsym               LDQ     SC_PTR
         4 001227   000405 402007                    MPY     261,DL
         4 001230   000000 116003                    CMPQ    0,DU
         4 001231   001233 605000 4                  TPL     s:4916+5
         4 001232   000044 036003                    ADLQ    36,DU
         4 001233   003006 061400                    CSR     bolr='003'O
         4 001234   000313 000044 xsym               BDSC    UWA+203                  by=0,bit=0,n=36
         4 001235   000005 640001 xsym               BDSC    SC_TBL+5,Q               by=3,bit=4,n=1

      386     4917    3               IF UWA.SC_REC.SETMODE=2 THEN

   4917  4 001236   000311 235000 xsym               LDA     UWA+201
         4 001237   000002 115007                    CMPA    2,DL
         4 001240   001252 601000 4                  TNZ     s:4920

      387     4918    3                   SC_TBL.SETYPE(SC_PTR)=0; /* SET TYPE IS PA */

   4918  4 001241   000000 236000 xsym               LDQ     SC_PTR
         4 001242   000405 402007                    MPY     261,DL
         4 001243   000000 116003                    CMPQ    0,DU
         4 001244   001246 605000 4                  TPL     s:4918+5
         4 001245   000044 036003                    ADLQ    36,DU
         4 001246   003006 061400                    CSR     bolr='003'O
         4 001247   000011 000044 5                  BDSC    9                        by=0,bit=0,n=36
         4 001250   000004 000002 xsym               BDSC    SC_TBL+4,Q               by=0,bit=0,n=2
         4 001251   001276 710000 4                  TRA     s:4924

      388     4919    3               ELSE
      389     4920    3                   IF UWA.SC_REC.SETORD=4 THEN /* SORT BY DEFINED KEYS */

   4920  4 001252   000312 236000 xsym               LDQ     UWA+202
         4 001253   000004 116007                    CMPQ    4,DL
         4 001254   001266 601000 4                  TNZ     s:4923

      390     4921    3                       SC_TBL.SETYPE(SC_PTR)=1;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:92   

   4921  4 001255   000000 236000 xsym               LDQ     SC_PTR
         4 001256   000405 402007                    MPY     261,DL
         4 001257   000000 116003                    CMPQ    0,DU
         4 001260   001262 605000 4                  TPL     s:4921+5
         4 001261   000044 036003                    ADLQ    36,DU
         4 001262   003006 061400                    CSR     bolr='003'O
         4 001263   000013 000044 5                  BDSC    11                       by=0,bit=0,n=36
         4 001264   000004 000002 xsym               BDSC    SC_TBL+4,Q               by=0,bit=0,n=2
         4 001265   001276 710000 4                  TRA     s:4924

      391     4922    3                   ELSE /* SORT BY DEFINED KEYS WITHIN RECORDS */
      392     4923    3                       SC_TBL.SETYPE(SC_PTR)=2;

   4923  4 001266   000000 236000 xsym               LDQ     SC_PTR
         4 001267   000405 402007                    MPY     261,DL
         4 001270   000000 116003                    CMPQ    0,DU
         4 001271   001273 605000 4                  TPL     s:4923+5
         4 001272   000044 036003                    ADLQ    36,DU
         4 001273   003006 061400                    CSR     bolr='003'O
         4 001274   000062 000044 5                  BDSC    50                       by=0,bit=0,n=36
         4 001275   000004 000002 xsym               BDSC    SC_TBL+4,Q               by=0,bit=0,n=2

      393     4924    3               CALL DB_FRS(RVA.SOREC,RVA.SCSOSM) DBALT;

   4924  4 001276   000071 630400 5                  EPPR0   57
         4 001277   000000 631400 5                  EPPR1   0
         4 001300   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 001301   003155 702000 4                  TSX2    DB_ALT

      394     4925    3               CALL DB_GET(RVA.SOREC) DBALT; /* GET SC_OWNER */

   4925  4 001302   000071 630400 5                  EPPR0   57
         4 001303   000003 631400 5                  EPPR1   3
         4 001304   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001305   003155 702000 4                  TSX2    DB_ALT

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:93   
      395     4926    3               CALL DB_FOR(RVA.RCSOSM) DBALT;

   4926  4 001306   000073 630400 5                  EPPR0   59
         4 001307   000003 631400 5                  EPPR1   3
         4 001310   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 001311   003155 702000 4                  TSX2    DB_ALT

      396     4927    3               CALL DB_GET(RVA.RCREC) DBALT; /* GET RC OF OWNER */

   4927  4 001312   000074 630400 5                  EPPR0   60
         4 001313   000003 631400 5                  EPPR1   3
         4 001314   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001315   003155 702000 4                  TSX2    DB_ALT

      397     4928    3               RC_PTR = RC_PTR + 1; /* STORE OWNER INFO IN RC_TBL */

   4928  4 001316   000000 054000 xsym               AOS     RC_PTR

      398     4929    3               IF RC_PTR>%MAX_PA_MEM THEN

   4929  4 001317   000000 235000 xsym               LDA     RC_PTR
         4 001320   000377 115007                    CMPA    255,DL
         4 001321   003211 605400 4                  TPNZ    RC_OVERFLOW

      399     4930    3                   GOTO RC_OVERFLOW;
      400     4931    3               SC_TBL.RC_PTR(SC_PTR)=RC_PTR; /* SC_TBL LINKED TO OWNER */

   4931  4 001322   000000 236000 xsym               LDQ     SC_PTR
         4 001323   000405 402007                    MPY     261,DL
         4 001324   000000 116003                    CMPQ    0,DU
         4 001325   001327 605000 4                  TPL     s:4931+5
         4 001326   000044 036003                    ADLQ    36,DU
         4 001327   003006 061400                    CSR     bolr='003'O
         4 001330   000000 000044 xsym               BDSC    RC_PTR                   by=0,bit=0,n=36
         4 001331   000005 650011 xsym               BDSC    SC_TBL+5,Q               by=3,bit=5,n=9

      401     4932    3               SC_TBL.NO_OF_SM(SC_PTR)=0;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:94   

   4932  4 001332   000000 236000 xsym               LDQ     SC_PTR
         4 001333   000405 402007                    MPY     261,DL
         4 001334   000000 116003                    CMPQ    0,DU
         4 001335   001337 605000 4                  TPL     s:4932+5
         4 001336   000044 036003                    ADLQ    36,DU
         4 001337   003006 061400                    CSR     bolr='003'O
         4 001340   000011 000044 5                  BDSC    9                        by=0,bit=0,n=36
         4 001341   000005 420006 xsym               BDSC    SC_TBL+5,Q               by=2,bit=2,n=6

      402     4933    3               RC_TBL.NXPNT_EIS(RC_PTR)=UWA.SO_REC.NXTPNT;

   4933  4 001342   000000 236000 xsym               LDQ     RC_PTR
         4 001343   000003 402007                    MPY     3,DL
         4 001344   000355 235000 xsym               LDA     UWA+237
         4 001345   000000 755006 xsym               STA     RC_TBL,QL

      403     4934    3               RC_TBL.SC_PTR(RC_PTR)=SC_PTR; /* BACKWARD LINK */

   4934  4 001346   000000 620006                    EAX0    0,QL
         4 001347   000000 236000 xsym               LDQ     SC_PTR
         4 001350   000022 736000                    QLS     18
         4 001351   000002 676010 xsym               ERQ     RC_TBL+2,X0
         4 001352   000777 376003                    ANQ     511,DU
         4 001353   000002 656010 xsym               ERSQ    RC_TBL+2,X0

      404     4935    3               RC_TBL.TYPE(RC_PTR)=UWA.RC_REC.RTYPE; /* TYPE OF OWNER */

   4935  4 001354   000270 721000 xsym               LXL1    UWA+184
         4 001355   000001 741010 xsym               STX1    RC_TBL+1,X0

      405     4936    3               RC_TBL.RC_NEXT(RC_PTR)=0;

   4936  4 001356   000055 236000 5                  LDQ     45
         4 001357   000002 356010 xsym               ANSQ    RC_TBL+2,X0

      406     4937        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:95   
      407     4938        /*
      408     4939              FOR RO RECORD, PROCESS ALL DIFFERENT DEPENDING DIRECTIVE
      409     4940              1) COMPACT - LINK RO TO TYPE TABLE, IMPLIES WE ARE SEARCHING
      410     4941                           ALL RO RECORDS. THEN SETUP THE RA RANGES FOR THE
      411     4942                           AREAS TO OPEN.
      412     4943              2) RESORT  - LINK RO TO SC_TBL SO THAT WE KNOW THE RECORD TYPE
      413     4944                           OF EACH SET.  THEREFORE OWNER RECORD WILL NOT BE
      414     4945                           SEARCHED FOR IN THE FIRST PASS.
      415     4946              3) REBUILD - LINK RO TO SC_TBL AS RESORT DOES, BUT ALSO FIND
      416     4947                           ALL THE RA FOR THE RO AND SETUP THE FULL PAGE RANGE
      417     4948                           FOR THE AREAS TO OPEN BECAUSE WE WANT TO SEARCH
      418     4949                           ALL THE *PA_REC IN THE FIRST PASS TO ERASE THEM.
      419     4950                           (NOTE: ALL *PA_REC STORED VIA OWNERS ).
      420     4951              4) CONVERT - LINK RO TO SC_TBL AS RESORT DOES. HOWEVER, WE
      421     4952                           DONOT WANT TO WASTE TIME TO SEARCH FOR *PA_REC
      422     4953                           IN THE FIRST PASS. (*PA_REC IS ILLEGAL AND IS NOT
      423     4954                           SUPPOSE IN THE DATABASE).
      424     4955              5) REVERT  - LINK RO TO TYPE TABLE LIKE COMPACT FOR WE EXTRACT
      425     4956                           OWNER INSTEAD OF MEMBER. THIS IS REVERT PA SET TO
      426     4957                           NON-PA, NOTICE THE CHANGE OF SIZE OF ALL MEMBERS.
      427     4958        */
      428     4959        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:96   
      429     4960    3               IF ZI$DIR.CODE=#COMPACT OR ZI$DIR.CODE=#REVERT THEN

   4960  4 001360   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001361   000043 376000 5                  ANQ     35
         4 001362   000044 116000 5                  CMPQ    36
         4 001363   001366 600000 4                  TZE     s:4962
         4 001364   000046 116000 5                  CMPQ    38
         4 001365   001436 601000 4                  TNZ     s:4979

      430     4961    4               DO; /* LINK OWNER RC TO TYPE TABLE */

      431     4962    4                   X=TYPE.MSTRINDX(UWA.RC_REC.RTYPE);

   4962  4 001366   000270 235000 xsym               LDA     UWA+184
         4 001367   000001 735000                    ALS     1
         4 001370   000000 100405                    MLR     fill='000'O
         4 001371   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
         4 001372   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 001373   000054 236000 0                  LDQ     @EIS+3
         4 001374   000022 732000                    QRS     18
         4 001375   000000 756000 xsym               STQ     X

      432     4963    4                   IF X=0 THEN /* 1ST RO FOR THAT RECORD */

   4963  4 001376   001407 601000 4                  TNZ     s:4969

      433     4964    5                   DO; /* GET RA AND SETUP RANGE */

      434     4965    5                       TYPE.MSTRINDX(UWA.RC_REC.RTYPE)=RC_PTR;

   4965  4 001377   000005 101400                    MRL     fill='000'O
         4 001400   000000 000004 xsym               ADSC9   RC_PTR                   cn=0,n=4
         4 001401   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2

      435     4966    5                       CALL SETUP_RA_RANGES DBALT;

   4966  4 001402   000007 236000 5                  LDQ     7
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:97   
         4 001403   000037 756000 0                  STQ     READ_TEMP+15
         4 001404   000002 701000 4                  TSX1    SETUP_RA_RANGES
         4 001405   003155 702000 4                  TSX2    DB_ALT

      436     4967    5                       END;

   4967  4 001406   001436 710000 4                  TRA     s:4979

      437     4968    4                   ELSE
      438     4969    5                   DO WHILE(X>0); /* WALK TO THE TAIL */

   4969  4 001407   001436 604400 4                  TMOZ    s:4979

      439     4970    5                       IF RC_TBL.RC_NEXT(X)>0 THEN

   4970  4 001410   000000 236000 xsym               LDQ     X
         4 001411   000003 402007                    MPY     3,DL
         4 001412   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 001413   777000 316003                    CANQ    -512,DU
         4 001414   001423 600000 4                  TZE     s:4974

      440     4971    5                           X=RC_TBL.RC_NEXT(X);

   4971  4 001415   000000 236000 xsym               LDQ     X
         4 001416   000003 402007                    MPY     3,DL
         4 001417   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 001420   000033 772000                    QRL     27
         4 001421   000000 756000 xsym               STQ     X
         4 001422   001434 710000 4                  TRA     s:4977

      441     4972    5                       ELSE
      442     4973    6                       DO;

      443     4974    6                           RC_TBL.RC_NEXT(X)=RC_PTR;

   4974  4 001423   000000 236000 xsym               LDQ     X
         4 001424   000003 402007                    MPY     3,DL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:98   
         4 001425   000000 620006                    EAX0    0,QL
         4 001426   000000 236000 xsym               LDQ     RC_PTR
         4 001427   000033 736000                    QLS     27
         4 001430   000002 676010 xsym               ERQ     RC_TBL+2,X0
         4 001431   777000 376003                    ANQ     -512,DU
         4 001432   000002 656010 xsym               ERSQ    RC_TBL+2,X0

      444     4975    6                           X=0;

   4975  4 001433   000000 450000 xsym               STZ     X

      445     4976    6                           END;

      446     4977    5                       END;

   4977  4 001434   000000 235000 xsym               LDA     X
         4 001435   001410 605400 4                  TPNZ    s:4970

      447     4978    4                   END;

      448     4979    3               CALL DB_FRS(RVA.SMREC,RVA.SCSOSM) DBALT;

   4979  4 001436   000075 630400 5                  EPPR0   61
         4 001437   000000 631400 5                  EPPR1   0
         4 001440   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 001441   003155 702000 4                  TSX2    DB_ALT

      449     4980         /* NOW, LOOP THRU ALL SM */
      450     4981    4               DO UNTIL_END_OF_SET;

   4981  4 001442   040000 106400                    CMPC    fill='040'O
         4 001443   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 001444   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 001445   002133 600000 4                  TZE     s:5086

      451     4982    4                   CALL DB_GET(RVA.SMREC) DBALT;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:99   
   4982  4 001446   000075 630400 5                  EPPR0   61
         4 001447   000003 631400 5                  EPPR1   3
         4 001450   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001451   003155 702000 4                  TSX2    DB_ALT

      452     4983    4                   CALL DB_FOR(RVA.RCSOSM) DBALT;

   4983  4 001452   000073 630400 5                  EPPR0   59
         4 001453   000003 631400 5                  EPPR1   3
         4 001454   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 001455   003155 702000 4                  TSX2    DB_ALT

      453     4984    4                   CALL DB_GET(RVA.RCREC) DBALT;

   4984  4 001456   000074 630400 5                  EPPR0   60
         4 001457   000003 631400 5                  EPPR1   3
         4 001460   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001461   003155 702000 4                  TSX2    DB_ALT

      454     4985    4                   RC_PTR=RC_PTR+1; /* GET ANOTHER RS */

   4985  4 001462   000000 054000 xsym               AOS     RC_PTR

      455     4986    4                   IF RC_PTR>%MAX_PA_MEM THEN

   4986  4 001463   000000 235000 xsym               LDA     RC_PTR
         4 001464   000377 115007                    CMPA    255,DL
         4 001465   003211 605400 4                  TPNZ    RC_OVERFLOW

      456     4987    4                       GOTO RC_OVERFLOW;
      457     4988    4                   RC_TBL.RC_NEXT(RC_PTR)=0; /* TAIL OF THE CHAIN */

   4988  4 001466   000000 236000 xsym               LDQ     RC_PTR
         4 001467   000003 402007                    MPY     3,DL
         4 001470   000000 620006                    EAX0    0,QL
         4 001471   000055 236000 5                  LDQ     45
         4 001472   000002 356010 xsym               ANSQ    RC_TBL+2,X0
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:100  

      458     4989    4                   RC_TBL.TYPE(RC_PTR)=UWA.RC_REC.RTYPE;

   4989  4 001473   000270 721000 xsym               LXL1    UWA+184
         4 001474   000001 741010 xsym               STX1    RC_TBL+1,X0

      459     4990    4                   RC_TBL.NXPNT_EIS(RC_PTR)=UWA.SM_REC.NXTPNT;

   4990  4 001475   000370 235000 xsym               LDA     UWA+248
         4 001476   000000 755010 xsym               STA     RC_TBL,X0

      460     4991    4                   IF UWA.SM_REC.INSTYPE=0 AND UWA.SM_REC.RETTYPE=0 THEN

   4991  4 001477   000360 235000 xsym               LDA     UWA+240
         4 001500   001506 601000 4                  TNZ     s:4994
         4 001501   000361 235000 xsym               LDA     UWA+241
         4 001502   001506 601000 4                  TNZ     s:4994

      461     4992    4                       RC_TBL.MANUAL(RC_PTR)=0; /* UNCONNECTED MEM NOT POSSIBLE */

   4992  4 001503   000077 236000 5                  LDQ     63
         4 001504   000002 356010 xsym               ANSQ    RC_TBL+2,X0
         4 001505   001510 710000 4                  TRA     s:4995

      462     4993    4                   ELSE
      463     4994    4                       RC_TBL.MANUAL(RC_PTR)=1; /* POSSIBLY UNCONNECTED MEM */

   4994  4 001506   200000 236007                    LDQ     65536,DL
         4 001507   000002 256010 xsym               ORSQ    RC_TBL+2,X0

      464     4995    4                   IF UWA.SM_REC.SEQDUP=2 THEN

   4995  4 001510   000363 235000 xsym               LDA     UWA+243
         4 001511   000002 115007                    CMPA    2,DL
         4 001512   001516 601000 4                  TNZ     s:4998

      465     4996    4                       RC_TBL.DUPIND(RC_PTR)=1; /* DUPIND SAYS YES */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:101  

   4996  4 001513   400000 236007                    LDQ     -131072,DL
         4 001514   000002 256010 xsym               ORSQ    RC_TBL+2,X0
         4 001515   001520 710000 4                  TRA     s:4999

      466     4997    4                   ELSE
      467     4998    4                       RC_TBL.DUPIND(RC_PTR)=0;

   4998  4 001516   000100 236000 5                  LDQ     64
         4 001517   000002 356010 xsym               ANSQ    RC_TBL+2,X0

      468     4999    4                   RC_TBL.SC_PTR(RC_PTR)=SC_PTR; /* POINT TO SC OWNER */

   4999  4 001520   000000 236000 xsym               LDQ     SC_PTR
         4 001521   000022 736000                    QLS     18
         4 001522   000002 676010 xsym               ERQ     RC_TBL+2,X0
         4 001523   000777 376003                    ANQ     511,DU
         4 001524   000002 656010 xsym               ERSQ    RC_TBL+2,X0

      469     5000    4                   SC_TBL.NO_OF_SM(SC_PTR)=SC_TBL.NO_OF_SM(SC_PTR)+1;

   5000  4 001525   000000 236000 xsym               LDQ     SC_PTR
         4 001526   000405 402007                    MPY     261,DL
         4 001527   000000 116003                    CMPQ    0,DU
         4 001530   001532 605000 4                  TPL     s:5000+5
         4 001531   000044 036003                    ADLQ    36,DU
         4 001532   003000 061406                    CSR     bolr='003'O
         4 001533   000005 420006 xsym               BDSC    SC_TBL+5,Q               by=2,bit=2,n=6
         4 001534   000055 000044 0                  BDSC    @EIS+4                   by=0,bit=0,n=36
         4 001535   000055 236000 0                  LDQ     @EIS+4
         4 001536   000001 036007                    ADLQ    1,DL
         4 001537   000054 756000 0                  STQ     @EIS+3
         4 001540   000000 236000 xsym               LDQ     SC_PTR
         4 001541   000405 402007                    MPY     261,DL
         4 001542   000000 116003                    CMPQ    0,DU
         4 001543   001545 605000 4                  TPL     s:5000+16
         4 001544   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:102  
         4 001545   003006 061400                    CSR     bolr='003'O
         4 001546   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 001547   000005 420006 xsym               BDSC    SC_TBL+5,Q               by=2,bit=2,n=6

      470     5001    4                   IF ZI$DIR.CODE=#COMPACT THEN

   5001  4 001550   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001551   000043 376000 5                  ANQ     35
         4 001552   000044 116000 5                  CMPQ    36
         4 001553   002114 600000 4                  TZE     NEXT_SM

      471     5002    4                       GOTO NEXT_SM;
      472     5003    4                   IF ZI$DIR.CODE=#REVERT THEN

   5003  4 001554   000046 116000 5                  CMPQ    38
         4 001555   001575 601000 4                  TNZ     s:5013

      473     5004    5                   DO;

      474     5005    5                       IF UWA.SM_REC.INSTYPE=1 OR UWA.SM_REC.RETTYPE=1 THEN

   5005  4 001556   000360 235000 xsym               LDA     UWA+240
         4 001557   000001 115007                    CMPA    1,DL
         4 001560   001564 600000 4                  TZE     s:5007
         4 001561   000361 235000 xsym               LDA     UWA+241
         4 001562   000001 115007                    CMPA    1,DL
         4 001563   001574 601000 4                  TNZ     s:5011

      475     5006    6                       DO; /* UNCONNECTED MEMBERS MAY EXIST IN DATABASE */

      476     5007    6                           CALL SETUP_RA_RANGES DBALT;

   5007  4 001564   000007 236000 5                  LDQ     7
         4 001565   000037 756000 0                  STQ     READ_TEMP+15
         4 001566   000002 701000 4                  TSX1    SETUP_RA_RANGES
         4 001567   003155 702000 4                  TSX2    DB_ALT

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:103  
      477     5008    6                           KEY_PTR=KEY_PTR+1; /* SEQ SEARCH FOR IT */

   5008  4 001570   000000 054000 xsym               AOS     KEY_PTR

      478     5009    6                           KEY_TBL.EIS(KEY_PTR)=RC_PTR;

   5009  4 001571   000000 235000 xsym               LDA     RC_PTR
         4 001572   000000 720000 xsym               LXL0    KEY_PTR
         4 001573   000000 755010 xsym               STA     KEY_TBL,X0

      479     5010    6                           END;

      480     5011    5                       GOTO NEXT_SM;

   5011  4 001574   002114 710000 4                  TRA     NEXT_SM

      481     5012    5                       END;
      482     5013    4                   RC_TBL.KEY_PTR(RC_PTR)=KEY_PTR+1;

   5013  4 001575   000000 236000 xsym               LDQ     KEY_PTR
         4 001576   000001 036007                    ADLQ    1,DL
         4 001577   000002 676010 xsym               ERQ     RC_TBL+2,X0
         4 001600   001777 376007                    ANQ     1023,DL
         4 001601   000002 656010 xsym               ERSQ    RC_TBL+2,X0

      483     5014    4                   X=TYPE.MSTRINDX(UWA.RC_REC.RTYPE);

   5014  4 001602   000270 235000 xsym               LDA     UWA+184
         4 001603   000001 735000                    ALS     1
         4 001604   000000 100405                    MLR     fill='000'O
         4 001605   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
         4 001606   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 001607   000054 236000 0                  LDQ     @EIS+3
         4 001610   000022 732000                    QRS     18
         4 001611   000000 756000 xsym               STQ     X

      484     5015    4                   Y=0;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:104  

   5015  4 001612   000003 450000 0                  STZ     Y

      485     5016    4                   IF X=0 THEN /* FIRST RS FOR THAT RC */

   5016  4 001613   001624 601000 4                  TNZ     s:5022

      486     5017    5                   DO; /* SO GET THE RA AND SETUP RANGE */

      487     5018    5                       TYPE.MSTRINDX(UWA.RC_REC.RTYPE)=RC_PTR;

   5018  4 001614   000005 101400                    MRL     fill='000'O
         4 001615   000000 000004 xsym               ADSC9   RC_PTR                   cn=0,n=4
         4 001616   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2

      488     5019    5                       CALL SETUP_RA_RANGES DBALT;

   5019  4 001617   000007 236000 5                  LDQ     7
         4 001620   000037 756000 0                  STQ     READ_TEMP+15
         4 001621   000002 701000 4                  TSX1    SETUP_RA_RANGES
         4 001622   003155 702000 4                  TSX2    DB_ALT

      489     5020    5                       END;

   5020  4 001623   001647 710000 4                  TRA     s:5028

      490     5021    4                   ELSE
      491     5022    5                   DO WHILE(X>0); /* WALK TO THE TAIL */

   5022  4 001624   001647 604400 4                  TMOZ    s:5028

      492     5023    5                       Y = X; /* SAVE X */

   5023  4 001625   000000 235000 xsym               LDA     X
         4 001626   000003 755000 0                  STA     Y

      493     5024    5                       X = RC_TBL.RC_NEXT(X);
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:105  

   5024  4 001627   000000 236000 xsym               LDQ     X
         4 001630   000003 402007                    MPY     3,DL
         4 001631   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 001632   000033 772000                    QRL     27
         4 001633   000000 756000 xsym               STQ     X

      494     5025    5                       IF X=0 THEN /* END OF CHAIN */

   5025  4 001634   001645 601000 4                  TNZ     s:5027

      495     5026    5                           RC_TBL.RC_NEXT(Y)=RC_PTR;

   5026  4 001635   000003 236000 0                  LDQ     Y
         4 001636   000003 402007                    MPY     3,DL
         4 001637   000000 620006                    EAX0    0,QL
         4 001640   000000 236000 xsym               LDQ     RC_PTR
         4 001641   000033 736000                    QLS     27
         4 001642   000002 676010 xsym               ERQ     RC_TBL+2,X0
         4 001643   777000 376003                    ANQ     -512,DU
         4 001644   000002 656010 xsym               ERSQ    RC_TBL+2,X0

      496     5027    5                       END;

   5027  4 001645   000000 235000 xsym               LDA     X
         4 001646   001625 605400 4                  TPNZ    s:5023

      497     5028    4                   CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;

   5028  4 001647   000101 630400 5                  EPPR0   65
         4 001650   000000 631400 5                  EPPR1   0
         4 001651   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 001652   003155 702000 4                  TSX2    DB_ALT

      498     5029    4                   X=0;

   5029  4 001653   000000 450000 xsym               STZ     X
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:106  

      499     5030    4                   Y=0; /* BYTE OFFSET FOR KEY IN SORT_REC */

   5030  4 001654   000003 450000 0                  STZ     Y

      500     5031    5                   DO UNTIL_END_OF_SET;

   5031  4 001655   040000 106400                    CMPC    fill='040'O
         4 001656   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 001657   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 001660   002064 600000 4                  TZE     s:5074

      501     5032    5                       CALL DB_GET(RVA.CFREC) DBALT;

   5032  4 001661   000101 630400 5                  EPPR0   65
         4 001662   000003 631400 5                  EPPR1   3
         4 001663   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001664   003155 702000 4                  TSX2    DB_ALT

      502     5033    5                       CALL DB_FOR(RVA.FRCFS) DBALT;

   5033  4 001665   000103 630400 5                  EPPR0   67
         4 001666   000003 631400 5                  EPPR1   3
         4 001667   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 001670   003155 702000 4                  TSX2    DB_ALT

      503     5034    5                       CALL DB_GET(RVA.FRREC) DBALT; /* GOT A KEY FIELD */

   5034  4 001671   000104 630400 5                  EPPR0   68
         4 001672   000003 631400 5                  EPPR1   3
         4 001673   000000 701000 xent               TSX1    DB_FUNC_GET
         4 001674   003155 702000 4                  TSX2    DB_ALT

      504     5035         /* EACH FR IS A SORT KEY FOR THE PA SET */
      505     5036    5                       X=X+1;

   5036  4 001675   000000 054000 xsym               AOS     X
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:107  

      506     5037    5                       KEY_PTR=KEY_PTR+1;

   5037  4 001676   000000 054000 xsym               AOS     KEY_PTR

      507     5038    5                       KEY_TBL.EIS(KEY_PTR)=UWA.FR_REC.BUFLOC; /* KEY EIS */

   5038  4 001677   000351 235000 xsym               LDA     UWA+233
         4 001700   000000 720000 xsym               LXL0    KEY_PTR
         4 001701   000000 755010 xsym               STA     KEY_TBL,X0

      508     5039    5                       IF ZI$DIR.CODE=#RESORT THEN /* NON-PA */

   5039  4 001702   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001703   000043 376000 5                  ANQ     35
         4 001704   000067 116000 5                  CMPQ    55
         4 001705   002051 601000 4                  TNZ     s:5070

      509     5040    6                       DO;

      510     5041    6                           KEY_PTR=KEY_PTR+1; /* SAVE EIS OF KEY IN SORT_REC */

   5041  4 001706   000000 054000 xsym               AOS     KEY_PTR

      511     5042    6                           KEY_TBL.EIS(KEY_PTR)=UWA.FR_REC.BUFLOC;

   5042  4 001707   000000 720000 xsym               LXL0    KEY_PTR
         4 001710   000000 755010 xsym               STA     KEY_TBL,X0

      512     5043    6                           KEY_TBL.EIS_REDEF.OFST(KEY_PTR)=Y;

   5043  4 001711   000003 236000 0                  LDQ     Y
         4 001712   000020 736000                    QLS     16
         4 001713   000000 676010 xsym               ERQ     KEY_TBL,X0
         4 001714   000105 376000 5                  ANQ     69
         4 001715   000000 656010 xsym               ERSQ    KEY_TBL,X0

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:108  
      513     5044         /* LETS FIGURE OUT BYTE SIZE OF THIS KEY */
      514     5045    7                           DO CASE(UWA.FR_REC.FTYP);

   5045  4 001716   000334 236000 xsym               LDQ     UWA+220
         4 001717   000024 116007                    CMPQ    20,DL
         4 001720   001722 602006 4                  TNC     s:5045+4,QL
         4 001721   002002 710000 4                  TRA     s:5059
         4 001722   001746 710000 4                  TRA     s:5047
         4 001723   001746 710000 4                  TRA     s:5047
         4 001724   001751 710000 4                  TRA     s:5049
         4 001725   001773 710000 4                  TRA     s:5057
         4 001726   001773 710000 4                  TRA     s:5057
         4 001727   001757 710000 4                  TRA     s:5053
         4 001730   002002 710000 4                  TRA     s:5059
         4 001731   001754 710000 4                  TRA     s:5051
         4 001732   002002 710000 4                  TRA     s:5059
         4 001733   001757 710000 4                  TRA     s:5053
         4 001734   001764 710000 4                  TRA     s:5055
         4 001735   001746 710000 4                  TRA     s:5047
         4 001736   001754 710000 4                  TRA     s:5051
         4 001737   002002 710000 4                  TRA     s:5059
         4 001740   001773 710000 4                  TRA     s:5057
         4 001741   001773 710000 4                  TRA     s:5057
         4 001742   001773 710000 4                  TRA     s:5057
         4 001743   002002 710000 4                  TRA     s:5059
         4 001744   002002 710000 4                  TRA     s:5059
         4 001745   001757 710000 4                  TRA     s:5053

      515     5046    7                           CASE(0,1,11); /* DBKEY,BIN WD,FLOAT SNGL */

      516     5047    7                               Y=Y+4; /* 4 BYTES DATA */

   5047  4 001746   000004 236007                    LDQ     4,DL
         4 001747   000003 056000 0                  ASQ     Y
         4 001750   002025 710000 4                  TRA     s:5067

      517     5048    7                           CASE(2); /* BIN HALF */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:109  

      518     5049    7                               Y=Y+2; /* TWO BYTES */

   5049  4 001751   000002 236007                    LDQ     2,DL
         4 001752   000003 056000 0                  ASQ     Y
         4 001753   002025 710000 4                  TRA     s:5067

      519     5050    7                           CASE(7,12); /* BIN DOUB,FLOAT DUBL */

      520     5051    7                               Y=Y+8; /* 8 BYTES DATA */

   5051  4 001754   000010 236007                    LDQ     8,DL
         4 001755   000003 056000 0                  ASQ     Y
         4 001756   002025 710000 4                  TRA     s:5067

      521     5052    7                           CASE(5,9,19); /* CHAR,9 BITS UNIT,CHAR VAR */

      522     5053    7                               Y=KEY_TBL.EIS_REDEF.SIZE(KEY_PTR)+Y;

   5053  4 001757   000000 236010 xsym               LDQ     KEY_TBL,X0
         4 001760   007777 376007                    ANQ     4095,DL
         4 001761   000003 036000 0                  ADLQ    Y
         4 001762   000003 756000 0                  STQ     Y
         4 001763   002025 710000 4                  TRA     s:5067

      523     5054    7                           CASE(10); /* BIT STRING */

      524     5055    7                               Y=Y+(KEY_TBL.EIS_REDEF.SIZE(KEY_PTR)+8)/9;

   5055  4 001764   000000 236010 xsym               LDQ     KEY_TBL,X0
         4 001765   007777 376007                    ANQ     4095,DL
         4 001766   000010 036007                    ADLQ    8,DL
         4 001767   000011 506007                    DIV     9,DL
         4 001770   000003 036000 0                  ADLQ    Y
         4 001771   000003 756000 0                  STQ     Y
         4 001772   002025 710000 4                  TRA     s:5067

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:110  
      525     5056    7                           CASE(3,4,14,15,16); /* PACKED STUFF */

      526     5057    7                               Y=Y+KEY_TBL.EIS_REDEF.SIZE(KEY_PTR)/2+1;

   5057  4 001773   000000 236010 xsym               LDQ     KEY_TBL,X0
         4 001774   007777 376007                    ANQ     4095,DL
         4 001775   000001 772000                    QRL     1
         4 001776   000003 036000 0                  ADLQ    Y
         4 001777   000001 036007                    ADLQ    1,DL
         4 002000   000003 756000 0                  STQ     Y
         4 002001   002025 710000 4                  TRA     s:5067

      527     5058    7                           CASE(ELSE);

      528     5059    7                               X=UWA.FR_REC.FTYP;

   5059  4 002002   000000 756000 xsym               STQ     X

      529     5060    7                               CALL DB_FOR(RVA.SNSE) DBALT;

   5060  4 002003   000005 630400 5                  EPPR0   5
         4 002004   000003 631400 5                  EPPR1   3
         4 002005   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 002006   003155 702000 4                  TSX2    DB_ALT

      530     5061    7                               CALL DB_GET(RVA.SNREC) DBALT;

   5061  4 002007   000006 630400 5                  EPPR0   6
         4 002010   000003 631400 5                  EPPR1   3
         4 002011   000000 701000 xent               TSX1    DB_FUNC_GET
         4 002012   003155 702000 4                  TSX2    DB_ALT

      531     5062    7                               CALL BIN_CHAR(1,X);

   5062  4 002013   000106 630400 5                  EPPR0   70
         4 002014   000000 631400 5                  EPPR1   0
         4 002015   000000 701000 xent               TSX1    BIN_CHAR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:111  
         4 002016   000000 011000                    NOP     0

      532     5063    7                               CALL ERROR_MSG(DBU#PAERROR1,UWA.SN_REC.SENAME,

   5063  4 002017   000111 630400 5                  EPPR0   73
         4 002020   000012 631400 5                  EPPR1   10
         4 002021   000000 701000 xent               TSX1    ERROR_MSG
         4 002022   000000 011000                    NOP     0

      533     5064    7                                  COMMAND_TEXT);
      534     5065    7                               ALTRETURN; /* ERROR THIS STEP FOR BAD FTYP */

   5065  4 002023   000000 221200 0                  LDX1  ! 0
         4 002024   000000 702211                    TSX2  ! 0,X1

      535     5066    7                               END;

      536     5067    6                           KEY_TBL.EIS_REDEF.CC(KEY_PTR)=FTYPE_TO_CC(UWA.FR_REC.FTYP);

   5067  4 002025   000334 236000 xsym               LDQ     UWA+220
         4 002026   000003 402007                    MPY     3,DL
         4 002027   000000 116003                    CMPQ    0,DU
         4 002030   002032 605000 4                  TPL     s:5067+5
         4 002031   000044 036003                    ADLQ    36,DU
         4 002032   000054 756000 0                  STQ     @EIS+3
         4 002033   000000 236000 xsym               LDQ     KEY_PTR
         4 002034   000044 402007                    MPY     36,DL
         4 002035   000000 116003                    CMPQ    0,DU
         4 002036   002040 605000 4                  TPL     s:5067+11
         4 002037   000044 036003                    ADLQ    36,DU
         4 002040   000054 235000 0                  LDA     @EIS+3
         4 002041   003006 060405                    CSL     bolr='003'O
         4 002042   000000 000003 1                  BDSC    FTYPE_TO_CC,A            by=0,bit=0,n=3
         4 002043   000000 030003 xsym               BDSC    KEY_TBL,Q                by=0,bit=3,n=3

      537     5068    6                           KEY_TBL.EIS_REDEF.DESCEND(KEY_PTR)=UWA.CF_REC.CTLSEQ;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:112  
   5068  4 002044   000403 236000 xsym               LDQ     UWA+259
         4 002045   000035 736000                    QLS     29
         4 002046   000000 676010 xsym               ERQ     KEY_TBL,X0
         4 002047   004000 376003                    ANQ     2048,DU
         4 002050   000000 656010 xsym               ERSQ    KEY_TBL,X0

      538     5069    6                           END;

      539     5070    5                       IF KEY_PTR>%MAX_PA_KEY THEN

   5070  4 002051   000000 235000 xsym               LDA     KEY_PTR
         4 002052   000777 115007                    CMPA    511,DL
         4 002053   003216 605400 4                  TPNZ    KEY_OVERFLOW

      540     5071    5                           GOTO KEY_OVERFLOW;
      541     5072    5                       CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;

   5072  4 002054   000101 630400 5                  EPPR0   65
         4 002055   000000 631400 5                  EPPR1   0
         4 002056   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 002057   003155 702000 4                  TSX2    DB_ALT

      542     5073    5                       END;

   5073  4 002060   040000 106400                    CMPC    fill='040'O
         4 002061   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 002062   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 002063   001661 601000 4                  TNZ     s:5032

      543     5074    4                   IF UWA.SC_REC.SETMODE~=2 AND MAX_KEY_SIZE<Y THEN

   5074  4 002064   000311 235000 xsym               LDA     UWA+201
         4 002065   000002 115007                    CMPA    2,DL
         4 002066   002074 600000 4                  TZE     s:5076
         4 002067   000000 236000 xsym               LDQ     MAX_KEY_SIZE
         4 002070   000003 116000 0                  CMPQ    Y
         4 002071   002074 605000 4                  TPL     s:5076
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:113  

      544     5075    4                       MAX_KEY_SIZE=Y; /* Y IS # OF WORDS FOR ALL KEYS */

   5075  4 002072   000003 235000 0                  LDA     Y
         4 002073   000000 755000 xsym               STA     MAX_KEY_SIZE

      545     5076    4                   SC_TBL.PA_KEYSIZE(SC_PTR)=Y; /* SAVE TOTAL KEY_SIZE */

   5076  4 002074   000000 236000 xsym               LDQ     SC_PTR
         4 002075   000405 402007                    MPY     261,DL
         4 002076   000000 116003                    CMPQ    0,DU
         4 002077   002101 605000 4                  TPL     s:5076+5
         4 002100   000044 036003                    ADLQ    36,DU
         4 002101   003006 061400                    CSR     bolr='003'O
         4 002102   000003 000044 0                  BDSC    Y                        by=0,bit=0,n=36
         4 002103   000004 050011 xsym               BDSC    SC_TBL+4,Q               by=0,bit=5,n=9

      546     5077    4                   RC_TBL.NO_OF_KEYS(RC_PTR)=X; /* FOR SORT WITHIN RECORD */

   5077  4 002104   000000 236000 xsym               LDQ     RC_PTR
         4 002105   000003 402007                    MPY     3,DL
         4 002106   000000 620006                    EAX0    0,QL
         4 002107   000000 236000 xsym               LDQ     X
         4 002110   000012 736000                    QLS     10
         4 002111   000002 676010 xsym               ERQ     RC_TBL+2,X0
         4 002112   176000 376007                    ANQ     64512,DL
         4 002113   000002 656010 xsym               ERSQ    RC_TBL+2,X0

      547     5078    4   NEXT_SM: /* NEXT RC WOULD BE RC FOR *PA IF PA SET */
      548     5079    4                   IF UWA.SC_REC.SETMODE=2 THEN /* SET IS PA,SKIP SM *PA_REC */

   5079  4 002114   000311 235000 xsym  NEXT_SM      LDA     UWA+201
         4 002115   000002 115007                    CMPA    2,DL
         4 002116   002123 601000 4                  TNZ     s:5081

      549     5080    4                       CALL DB_FRS(RVA.SMREC,RVA.SCSOSM) DBALT;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:114  
   5080  4 002117   000075 630400 5                  EPPR0   61
         4 002120   000000 631400 5                  EPPR1   0
         4 002121   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 002122   003155 702000 4                  TSX2    DB_ALT

      550     5081    4                   CALL DB_FRS(RVA.SMREC,RVA.SCSOSM) DBALT;

   5081  4 002123   000075 630400 5                  EPPR0   61
         4 002124   000000 631400 5                  EPPR1   0
         4 002125   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 002126   003155 702000 4                  TSX2    DB_ALT

      551     5082    4                   END; /* PROCESS ALL SM FOR A SC */

   5082  4 002127   040000 106400                    CMPC    fill='040'O
         4 002130   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 002131   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 002132   001446 601000 4                  TNZ     s:4982

      552     5083
      553     5084         /* IF SET IS A PA_SET THEN WE WILL
      554     5085            CREATE EIS FOR EACH KEY IN THE SORT_REC */
      555     5086    3               IF UWA.SC_REC.SETMODE=2 THEN

   5086  4 002133   000311 235000 xsym               LDA     UWA+201
         4 002134   000002 115007                    CMPA    2,DL
         4 002135   002467 601000 4                  TNZ     NEXT_SC

      556     5087    4               DO; /* AT THIS POINT, CURRENT SCSOSM IS A SM FOR *PA_REC */

      557     5088    4                   CALL DB_FOR(RVA.RCSOSM) DBALT;

   5088  4 002136   000073 630400 5                  EPPR0   59
         4 002137   000003 631400 5                  EPPR1   3
         4 002140   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 002141   003155 702000 4                  TSX2    DB_ALT

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:115  
      558     5089    4                   CALL DB_GET(RVA.RCREC) DBALT;

   5089  4 002142   000074 630400 5                  EPPR0   60
         4 002143   000003 631400 5                  EPPR1   3
         4 002144   000000 701000 xent               TSX1    DB_FUNC_GET
         4 002145   003155 702000 4                  TSX2    DB_ALT

      559     5090    4                   SC_TBL.PA_TYPE(SC_PTR)=UWA.RC_REC.RTYPE;

   5090  4 002146   000000 236000 xsym               LDQ     SC_PTR
         4 002147   000405 402007                    MPY     261,DL
         4 002150   000000 116003                    CMPQ    0,DU
         4 002151   002153 605000 4                  TPL     s:5090+5
         4 002152   000044 036003                    ADLQ    36,DU
         4 002153   003006 061400                    CSR     bolr='003'O
         4 002154   000270 000044 xsym               BDSC    UWA+184                  by=0,bit=0,n=36
         4 002155   000004 250014 xsym               BDSC    SC_TBL+4,Q               by=1,bit=5,n=12

      560     5091    4                   SC_TBL.PA_RECSIZE(SC_PTR)=UWA.RC_REC.LSIZE;

   5091  4 002156   000000 236000 xsym               LDQ     SC_PTR
         4 002157   000405 402007                    MPY     261,DL
         4 002160   000000 116003                    CMPQ    0,DU
         4 002161   002163 605000 4                  TPL     s:5091+5
         4 002162   000044 036003                    ADLQ    36,DU
         4 002163   003006 061400                    CSR     bolr='003'O
         4 002164   000306 000044 xsym               BDSC    UWA+198                  by=0,bit=0,n=36
         4 002165   000004 500022 xsym               BDSC    SC_TBL+4,Q               by=2,bit=8,n=18

      561     5092    4                   SC_TBL.PA_PTRSIZE(SC_PTR)=(UWA.RC_REC.PA_OFFSET-8)/3;

   5092  4 002166   000303 236000 xsym               LDQ     UWA+195
         4 002167   000010 136007                    SBLQ    8,DL
         4 002170   000003 506007                    DIV     3,DL
         4 002171   000054 756000 0                  STQ     @EIS+3
         4 002172   000000 236000 xsym               LDQ     SC_PTR
         4 002173   000405 402007                    MPY     261,DL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:116  
         4 002174   000000 116003                    CMPQ    0,DU
         4 002175   002177 605000 4                  TPL     s:5092+9
         4 002176   000044 036003                    ADLQ    36,DU
         4 002177   003006 061400                    CSR     bolr='003'O
         4 002200   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002201   000004 020003 xsym               BDSC    SC_TBL+4,Q               by=0,bit=2,n=3

      562     5093    4                   SC_TBL.PA_KEYSIZE(SC_PTR)=UWA.RC_REC.PA_ENTRY-SC_TBL.PA_PTRSIZE(

   5093  4 002202   000000 236000 xsym               LDQ     SC_PTR
         4 002203   000405 402007                    MPY     261,DL
         4 002204   000000 116003                    CMPQ    0,DU
         4 002205   002207 605000 4                  TPL     s:5093+5
         4 002206   000044 036003                    ADLQ    36,DU
         4 002207   003000 061406                    CSR     bolr='003'O
         4 002210   000004 020003 xsym               BDSC    SC_TBL+4,Q               by=0,bit=2,n=3
         4 002211   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002212   000304 236000 xsym               LDQ     UWA+196
         4 002213   000054 136000 0                  SBLQ    @EIS+3
         4 002214   000002 136007                    SBLQ    2,DL
         4 002215   000055 756000 0                  STQ     @EIS+4
         4 002216   000000 236000 xsym               LDQ     SC_PTR
         4 002217   000405 402007                    MPY     261,DL
         4 002220   000000 116003                    CMPQ    0,DU
         4 002221   002223 605000 4                  TPL     s:5093+17
         4 002222   000044 036003                    ADLQ    36,DU
         4 002223   003006 061400                    CSR     bolr='003'O
         4 002224   000055 000044 0                  BDSC    @EIS+4                   by=0,bit=0,n=36
         4 002225   000004 050011 xsym               BDSC    SC_TBL+4,Q               by=0,bit=5,n=9

      563     5094    4                      SC_PTR)-2;
      564     5095    4                   IF UWA.RC_REC.PA_ENTRY>MAX_KEY_SIZE THEN

   5095  4 002226   000304 236000 xsym               LDQ     UWA+196
         4 002227   000000 116000 xsym               CMPQ    MAX_KEY_SIZE
         4 002230   002232 604400 4                  TMOZ    s:5098

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:117  
      565     5096    4                       MAX_KEY_SIZE=UWA.RC_REC.PA_ENTRY;

   5096  4 002231   000000 756000 xsym               STQ     MAX_KEY_SIZE

      566     5097         /* CALCULATE HOW FULL TO PACK A PA_REC */
      567     5098    4                   Y=UWA.RC_REC.LSIZE-UWA.RC_REC.PA_OFFSET; /* PA SIZE */

   5098  4 002232   000306 236000 xsym               LDQ     UWA+198
         4 002233   000303 136000 xsym               SBLQ    UWA+195
         4 002234   000003 756000 0                  STQ     Y

      568     5099    4                   X=(Y*ZI$DIR.INIT_TMPLT_KEY)/100; /* BYTES TO USED */

   5099  4 002235   000221 402000 xsym               MPY     ZI$DIR+145
         4 002236   000144 506007                    DIV     100,DL
         4 002237   000000 756000 xsym               STQ     X

      569     5100    4                   IF X < 3*UWA.RC_REC.PA_ENTRY THEN /* LESS THEN 3 ENTRIES */

   5100  4 002240   000304 236000 xsym               LDQ     UWA+196
         4 002241   000003 402007                    MPY     3,DL
         4 002242   000000 116000 xsym               CMPQ    X
         4 002243   002245 604400 4                  TMOZ    s:5102

      570     5101    4                       X = 3*UWA.RC_REC.PA_ENTRY; /* AT LEAST 3 ENTRIES */

   5101  4 002244   000000 756000 xsym               STQ     X

      571     5102    4                   SC_TBL.FULL_PERCENT(SC_PTR)=Y-X;

   5102  4 002245   000003 236000 0                  LDQ     Y
         4 002246   000000 136000 xsym               SBLQ    X
         4 002247   000054 756000 0                  STQ     @EIS+3
         4 002250   000000 236000 xsym               LDQ     SC_PTR
         4 002251   000405 402007                    MPY     261,DL
         4 002252   000000 116003                    CMPQ    0,DU
         4 002253   002255 605000 4                  TPL     s:5102+8
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:118  
         4 002254   000044 036003                    ADLQ    36,DU
         4 002255   003006 061400                    CSR     bolr='003'O
         4 002256   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002257   000005 100014 xsym               BDSC    SC_TBL+5,Q               by=0,bit=8,n=12

      572     5103    4                   SC_TBL.KEY_PTR(SC_PTR)=KEY_PTR+1;

   5103  4 002260   000000 236000 xsym               LDQ     KEY_PTR
         4 002261   000001 036007                    ADLQ    1,DL
         4 002262   000054 756000 0                  STQ     @EIS+3
         4 002263   000000 236000 xsym               LDQ     SC_PTR
         4 002264   000405 402007                    MPY     261,DL
         4 002265   000000 116003                    CMPQ    0,DU
         4 002266   002270 605000 4                  TPL     s:5103+8
         4 002267   000044 036003                    ADLQ    36,DU
         4 002270   003006 061400                    CSR     bolr='003'O
         4 002271   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002272   000006 050022 xsym               BDSC    SC_TBL+6,Q               by=0,bit=5,n=18

      573     5104    4                   IF ZI$DIR.CODE~=#COMPACT AND ZI$DIR.CODE~=#REVERT THEN

   5104  4 002273   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002274   000043 376000 5                  ANQ     35
         4 002275   000044 116000 5                  CMPQ    36
         4 002276   002467 600000 4                  TZE     NEXT_SC
         4 002277   000046 116000 5                  CMPQ    38
         4 002300   002467 600000 4                  TZE     NEXT_SC

      574     5105    5                   DO;

      575     5106         /* MARK A ERASE INDICATOR IN TYPE TABLE FOR ALL *PA */
      576     5107    5                       TYPE.MSTRINDX(UWA.RC_REC.RTYPE)=-1*SC_PTR-1; /* NEG IT */

   5107  4 002301   000001 336007                    LCQ     1,DL
         4 002302   000000 136000 xsym               SBLQ    SC_PTR
         4 002303   000054 756000 0                  STQ     @EIS+3
         4 002304   000270 235000 xsym               LDA     UWA+184
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:119  
         4 002305   000001 735000                    ALS     1
         4 002306   000005 101400                    MRL     fill='000'O
         4 002307   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 002310   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2

      577     5108    5                       IF ZI$DIR.CODE=#REBUILDPA THEN

   5108  4 002311   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002312   000043 376000 5                  ANQ     35
         4 002313   000045 116000 5                  CMPQ    37
         4 002314   002321 601000 4                  TNZ     s:5111

      578     5109    5                           CALL SETUP_RA_RANGES(X) DBALT;

   5109  4 002315   000047 236000 5                  LDQ     39
         4 002316   000037 756000 0                  STQ     READ_TEMP+15
         4 002317   000002 701000 4                  TSX1    SETUP_RA_RANGES
         4 002320   003155 702000 4                  TSX2    DB_ALT

      579     5110         /* FOR WE WANT TO ERASE THEM */
      580     5111    5                       SC_TBL.NO_OF_KEYS(SC_PTR)=0;

   5111  4 002321   000000 236000 xsym               LDQ     SC_PTR
         4 002322   000405 402007                    MPY     261,DL
         4 002323   000000 116003                    CMPQ    0,DU
         4 002324   002326 605000 4                  TPL     s:5111+5
         4 002325   000044 036003                    ADLQ    36,DU
         4 002326   003006 061400                    CSR     bolr='003'O
         4 002327   000011 000044 5                  BDSC    9                        by=0,bit=0,n=36
         4 002330   000005 500005 xsym               BDSC    SC_TBL+5,Q               by=2,bit=8,n=5

      581     5112    5                       CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;

   5112  4 002331   000101 630400 5                  EPPR0   65
         4 002332   000000 631400 5                  EPPR1   0
         4 002333   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 002334   003155 702000 4                  TSX2    DB_ALT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:120  

      582     5113    6                       DO UNTIL_END_OF_SET;

   5113  4 002335   040000 106400                    CMPC    fill='040'O
         4 002336   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 002337   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 002340   002467 600000 4                  TZE     NEXT_SC

      583     5114    6                           CALL DB_GET(RVA.CFREC) DBALT;

   5114  4 002341   000101 630400 5                  EPPR0   65
         4 002342   000003 631400 5                  EPPR1   3
         4 002343   000000 701000 xent               TSX1    DB_FUNC_GET
         4 002344   003155 702000 4                  TSX2    DB_ALT

      584     5115    6                           CALL DB_FOR(RVA.FRCFS) DBALT;

   5115  4 002345   000103 630400 5                  EPPR0   67
         4 002346   000003 631400 5                  EPPR1   3
         4 002347   000000 701000 xent               TSX1    DB_FUNC_FOR
         4 002350   003155 702000 4                  TSX2    DB_ALT

      585     5116    6                           CALL DB_GET(RVA.FRREC) DBALT; /* SYN FR */

   5116  4 002351   000104 630400 5                  EPPR0   68
         4 002352   000003 631400 5                  EPPR1   3
         4 002353   000000 701000 xent               TSX1    DB_FUNC_GET
         4 002354   003155 702000 4                  TSX2    DB_ALT

      586     5117    6                           SC_TBL.NO_OF_KEYS(SC_PTR)=SC_TBL.NO_OF_KEYS(SC_PTR)+1;

   5117  4 002355   000000 236000 xsym               LDQ     SC_PTR
         4 002356   000405 402007                    MPY     261,DL
         4 002357   000000 116003                    CMPQ    0,DU
         4 002360   002362 605000 4                  TPL     s:5117+5
         4 002361   000044 036003                    ADLQ    36,DU
         4 002362   003000 061406                    CSR     bolr='003'O
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:121  
         4 002363   000005 500005 xsym               BDSC    SC_TBL+5,Q               by=2,bit=8,n=5
         4 002364   000055 000044 0                  BDSC    @EIS+4                   by=0,bit=0,n=36
         4 002365   000055 236000 0                  LDQ     @EIS+4
         4 002366   000001 036007                    ADLQ    1,DL
         4 002367   000054 756000 0                  STQ     @EIS+3
         4 002370   000000 236000 xsym               LDQ     SC_PTR
         4 002371   000405 402007                    MPY     261,DL
         4 002372   000000 116003                    CMPQ    0,DU
         4 002373   002375 605000 4                  TPL     s:5117+16
         4 002374   000044 036003                    ADLQ    36,DU
         4 002375   003006 061400                    CSR     bolr='003'O
         4 002376   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002377   000005 500005 xsym               BDSC    SC_TBL+5,Q               by=2,bit=8,n=5

      587     5118    6                           KEY_PTR=KEY_PTR+1;

   5118  4 002400   000000 054000 xsym               AOS     KEY_PTR

      588     5119    6                           IF KEY_PTR>%MAX_PA_KEY THEN

   5119  4 002401   000000 235000 xsym               LDA     KEY_PTR
         4 002402   000777 115007                    CMPA    511,DL
         4 002403   003216 605400 4                  TPNZ    KEY_OVERFLOW

      589     5120    6                               GOTO KEY_OVERFLOW;
      590     5121    6                           KEY_TBL.EIS(KEY_PTR)=UWA.FR_REC.BUFLOC;

   5121  4 002404   000351 236000 xsym               LDQ     UWA+233
         4 002405   000000 756005 xsym               STQ     KEY_TBL,AL

      591     5122    6                           KEY_TBL.EIS_REDEF.CC(KEY_PTR)=FTYPE_TO_CC(UWA.FR_REC.FTYP);

   5122  4 002406   000334 236000 xsym               LDQ     UWA+220
         4 002407   000003 402007                    MPY     3,DL
         4 002410   000000 116003                    CMPQ    0,DU
         4 002411   002413 605000 4                  TPL     s:5122+5
         4 002412   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:122  
         4 002413   000054 756000 0                  STQ     @EIS+3
         4 002414   000000 236000 xsym               LDQ     KEY_PTR
         4 002415   000044 402007                    MPY     36,DL
         4 002416   000000 116003                    CMPQ    0,DU
         4 002417   002421 605000 4                  TPL     s:5122+11
         4 002420   000044 036003                    ADLQ    36,DU
         4 002421   000054 235000 0                  LDA     @EIS+3
         4 002422   003006 060405                    CSL     bolr='003'O
         4 002423   000000 000003 1                  BDSC    FTYPE_TO_CC,A            by=0,bit=0,n=3
         4 002424   000000 030003 xsym               BDSC    KEY_TBL,Q                by=0,bit=3,n=3

      592     5123    6                           X=KEY_TBL.EIS_REDEF.OFST(KEY_PTR);

   5123  4 002425   000000 720000 xsym               LXL0    KEY_PTR
         4 002426   000000 236010 xsym               LDQ     KEY_TBL,X0
         4 002427   000020 772000                    QRL     16
         4 002430   017777 376007                    ANQ     8191,DL
         4 002431   000000 756000 xsym               STQ     X

      593     5124    6                           X=X-2-SC_TBL.PA_PTRSIZE(SC_PTR); /* MAKE OFFSET REL 0 */

   5124  4 002432   000000 236000 xsym               LDQ     SC_PTR
         4 002433   000405 402007                    MPY     261,DL
         4 002434   000000 116003                    CMPQ    0,DU
         4 002435   002437 605000 4                  TPL     s:5124+5
         4 002436   000044 036003                    ADLQ    36,DU
         4 002437   003000 061406                    CSR     bolr='003'O
         4 002440   000004 020003 xsym               BDSC    SC_TBL+4,Q               by=0,bit=2,n=3
         4 002441   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002442   000000 236000 xsym               LDQ     X
         4 002443   000054 136000 0                  SBLQ    @EIS+3
         4 002444   000002 136007                    SBLQ    2,DL
         4 002445   000000 756000 xsym               STQ     X

      594     5125    6                           KEY_TBL.EIS_REDEF.OFST(KEY_PTR)=X;

   5125  4 002446   000020 736000                    QLS     16
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:123  
         4 002447   000000 676010 xsym               ERQ     KEY_TBL,X0
         4 002450   000105 376000 5                  ANQ     69
         4 002451   000000 656010 xsym               ERSQ    KEY_TBL,X0

      595     5126    6                           KEY_TBL.EIS_REDEF.DESCEND(KEY_PTR)=UWA.CF_REC.CTLSEQ;

   5126  4 002452   000403 236000 xsym               LDQ     UWA+259
         4 002453   000035 736000                    QLS     29
         4 002454   000000 676010 xsym               ERQ     KEY_TBL,X0
         4 002455   004000 376003                    ANQ     2048,DU
         4 002456   000000 656010 xsym               ERSQ    KEY_TBL,X0

      596     5127    6                           CALL DB_FRS(RVA.CFREC,RVA.SMSSCF) DBALT;

   5127  4 002457   000101 630400 5                  EPPR0   65
         4 002460   000000 631400 5                  EPPR1   0
         4 002461   000000 701000 xent               TSX1    DB_FUNC_FRS
         4 002462   003155 702000 4                  TSX2    DB_ALT

      597     5128    6                           END;

   5128  4 002463   040000 106400                    CMPC    fill='040'O
         4 002464   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 002465   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 002466   002341 601000 4                  TNZ     s:5114

      598     5129    5                       END;

      599     5130    4                   END;

      600     5131    3               END; /* DONE WITH THIS SC WHICH IS WANTED */

      601     5132    2   NEXT_SC: CALL DB_FDR(RVA.NULL,DIR_REF) DBALT; /* RESTORE CUR_AREA */

   5132  4 002467   000114 630400 5     NEXT_SC      EPPR0   76
         4 002470   000000 631400 5                  EPPR1   0
         4 002471   000000 701000 xent               TSX1    DB_FUNC_FDR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:124  
         4 002472   003155 702000 4                  TSX2    DB_ALT

      602     5133    2           CALL DB_FRA(RVA.SNREC) DBALT;

   5133  4 002473   000006 630400 5                  EPPR0   6
         4 002474   000003 631400 5                  EPPR1   3
         4 002475   000000 701000 xent               TSX1    DB_FUNC_FRA
         4 002476   003155 702000 4                  TSX2    DB_ALT

      603     5134    2           DIR_REF = UWA.DIR_REF;

   5134  4 002477   000036 235000 xsym               LDA     UWA+30
         4 002500   000007 755000 0                  STA     BUF_PTR

      604     5135    2           END; /* FINISHED EXTRACTING ALL SC IN SCHEMA */

   5135  4 002501   040000 106400                    CMPC    fill='040'O
         4 002502   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 002503   000002 000005 1                  ADSC9   FTYPE_TO_CC+2            cn=0,n=5
         4 002504   001105 601000 4                  TNZ     s:4882

      605     5136        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:125  
      606     5137        /*
      607     5138              CHECK IF ANY USER SPECIFIED SET AND NOT PROCESSED
      608     5139        */
      609     5140    1       ERRCODESF.ERR#=0; /* SET TO 'NO' */

   5140  4 002505   000116 236000 5                  LDQ     78
         4 002506   000000 356000 xsym               ANSQ    ERRCODESF

      610     5141    2       DO X=0 TO RCNT;

   5141  4 002507   000000 450000 xsym               STZ     X
         4 002510   002607 710000 4                  TRA     s:5159+1

      611     5142    2           IF RECORD_LIST.NAME(X)~=' ' THEN

   5142  4 002511   000000 235000 xsym               LDA     X
         4 002512   000005 735000                    ALS     5
         4 002513   040000 106405                    CMPC    fill='040'O
         4 002514   000000 000036 xsym               ADSC9   RECORD_LIST,A            cn=0,n=30
         4 002515   000021 000001 5                  ADSC9   17                       cn=0,n=1
         4 002516   002606 600000 4                  TZE     s:5159

      612     5143    3           DO;

      613     5144    3               IF ZI$DIR.CODE=#RESORT THEN

   5144  4 002517   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002520   000043 376000 5                  ANQ     35
         4 002521   000067 116000 5                  CMPQ    55
         4 002522   002537 601000 4                  TNZ     s:5148

      614     5145    3                   CALL ERROR_MSG(DBU#NOTPASET,RECORD_LIST.NAME(X),

   5145  4 002523   000122 237000 5                  LDAQ    82
         4 002524   000056 757000 0                  STAQ    @EIS+5
         4 002525   000000 236000 xsym               LDQ     X
         4 002526   000025 736000                    QLS     21
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:126  
         4 002527   000121 036000 5                  ADLQ    81
         4 002530   000124 235000 5                  LDA     84
         4 002531   000054 757000 0                  STAQ    @EIS+3
         4 002532   000054 630400 0                  EPPR0   @EIS+3
         4 002533   000117 631400 5                  EPPR1   79
         4 002534   000000 701000 xent               TSX1    ERROR_MSG
         4 002535   000000 011000                    NOP     0
         4 002536   002606 710000 4                  TRA     s:5159

      615     5146    3                      CURR_SCHNM,'SORTED ');
      616     5147    3               ELSE
      617     5148    3                   IF ZI$DIR.CODE=#CONVERT THEN

   5148  4 002537   000005 116003                    CMPQ    5,DU
         4 002540   002555 601000 4                  TNZ     s:5152

      618     5149    3                       CALL ERROR_MSG(DBU#PADCBCON,RECORD_LIST.NAME(X),

   5149  4 002541   000126 237000 5                  LDAQ    86
         4 002542   000056 757000 0                  STAQ    @EIS+5
         4 002543   000000 236000 xsym               LDQ     X
         4 002544   000025 736000                    QLS     21
         4 002545   000121 036000 5                  ADLQ    81
         4 002546   000130 235000 5                  LDA     88
         4 002547   000054 757000 0                  STAQ    @EIS+3
         4 002550   000054 630400 0                  EPPR0   @EIS+3
         4 002551   000117 631400 5                  EPPR1   79
         4 002552   000000 701000 xent               TSX1    ERROR_MSG
         4 002553   000000 011000                    NOP     0
         4 002554   002606 710000 4                  TRA     s:5159

      619     5150    3                          'PA ','CHAIN ');
      620     5151    3                   ELSE
      621     5152    3                       IF ZI$DIR.CODE=#REVERT THEN

   5152  4 002555   000046 116000 5                  CMPQ    38
         4 002556   002573 601000 4                  TNZ     s:5156
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:127  

      622     5153    3                           CALL ERROR_MSG(DBU#PADCBCON,RECORD_LIST.NAME(X),

   5153  4 002557   000132 237000 5                  LDAQ    90
         4 002560   000056 757000 0                  STAQ    @EIS+5
         4 002561   000000 236000 xsym               LDQ     X
         4 002562   000025 736000                    QLS     21
         4 002563   000121 036000 5                  ADLQ    81
         4 002564   000130 235000 5                  LDA     88
         4 002565   000054 757000 0                  STAQ    @EIS+3
         4 002566   000054 630400 0                  EPPR0   @EIS+3
         4 002567   000117 631400 5                  EPPR1   79
         4 002570   000000 701000 xent               TSX1    ERROR_MSG
         4 002571   000000 011000                    NOP     0
         4 002572   002606 710000 4                  TRA     s:5159

      623     5154    3                              'CHAIN ','PA ');
      624     5155    3                       ELSE
      625     5156    3                           CALL ERROR_MSG(DBU#NOTPASET,RECORD_LIST.NAME(X),

   5156  4 002573   000134 237000 5                  LDAQ    92
         4 002574   000056 757000 0                  STAQ    @EIS+5
         4 002575   000000 236000 xsym               LDQ     X
         4 002576   000025 736000                    QLS     21
         4 002577   000121 036000 5                  ADLQ    81
         4 002600   000124 235000 5                  LDA     84
         4 002601   000054 757000 0                  STAQ    @EIS+3
         4 002602   000054 630400 0                  EPPR0   @EIS+3
         4 002603   000117 631400 5                  EPPR1   79
         4 002604   000000 701000 xent               TSX1    ERROR_MSG
         4 002605   000000 011000                    NOP     0

      626     5157    3                              CURR_SCHNM,'PA ');
      627     5158    3               END;

      628     5159    2           END;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:128  
   5159  4 002606   000000 054000 xsym               AOS     X
         4 002607   000000 236000 xsym               LDQ     X
         4 002610   000000 116000 xsym               CMPQ    RCNT
         4 002611   002511 604400 4                  TMOZ    s:5142

      629     5160    1       IF ERRCODESF.ERR# > 0 THEN

   5160  4 002612   000000 236000 xsym               LDQ     ERRCODESF
         4 002613   377770 316007                    CANQ    131064,DL
         4 002614   003164 601000 4                  TNZ     CLOSE_SCHEMA

      630     5161    1           GOTO CLOSE_SCHEMA;
      631     5162    1       IF SC_PTR=-1 THEN /* NOTHING TO DO */

   5162  4 002615   000000 235000 xsym               LDA     SC_PTR
         4 002616   000070 115000 5                  CMPA    56
         4 002617   002654 601000 4                  TNZ     s:5177

      632     5163    2       DO;

      633     5164    2           IF ZI$DIR.CODE=#RESORT THEN

   5164  4 002620   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002621   000043 376000 5                  ANQ     35
         4 002622   000067 116000 5                  CMPQ    55
         4 002623   002630 601000 4                  TNZ     s:5167

      634     5165    2               UWA.SN_REC.SENAME='SORTED';

   5165  4 002624   040000 100400                    MLR     fill='040'O
         4 002625   000044 000006 1                  ADSC9   FTYPE_TO_CC+36           cn=0,n=6
         4 002626   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 002627   002647 710000 4                  TRA     s:5174

      635     5166    2           ELSE
      636     5167    2               IF ZI$DIR.CODE=#CONVERT THEN

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:129  
   5167  4 002630   000005 116003                    CMPQ    5,DU
         4 002631   002636 601000 4                  TNZ     s:5170

      637     5168    2                   UWA.SN_REC.SENAME='new_DMCLed_PA';

   5168  4 002632   040000 100400                    MLR     fill='040'O
         4 002633   000046 000015 1                  ADSC9   FTYPE_TO_CC+38           cn=0,n=13
         4 002634   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 002635   002647 710000 4                  TRA     s:5174

      638     5169    2               ELSE
      639     5170    2                   IF ZI$DIR.CODE=#REVERT THEN

   5170  4 002636   000046 116000 5                  CMPQ    38
         4 002637   002644 601000 4                  TNZ     s:5173

      640     5171    2                       UWA.SN_REC.SENAME='new_DMCLed_SORTED';

   5171  4 002640   040000 100400                    MLR     fill='040'O
         4 002641   000052 000021 1                  ADSC9   FTYPE_TO_CC+42           cn=0,n=17
         4 002642   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30
         4 002643   002647 710000 4                  TRA     s:5174

      641     5172    2                   ELSE
      642     5173    2                       UWA.SN_REC.SENAME='PA';

   5173  4 002644   040000 100400                    MLR     fill='040'O
         4 002645   000015 000002 1                  ADSC9   FTYPE_TO_CC+13           cn=0,n=2
         4 002646   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30

      643     5174    2           CALL ERROR_MSG(DBU#NONPA,CURR_SCHNM,UWA.SN_REC.SENAME);

   5174  4 002647   000137 630400 5                  EPPR0   95
         4 002650   000012 631400 5                  EPPR1   10
         4 002651   000000 701000 xent               TSX1    ERROR_MSG
         4 002652   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:130  
      644     5175    2           GOTO CLOSE_SCHEMA;

   5175  4 002653   003164 710000 4                  TRA     CLOSE_SCHEMA

      645     5176    2           END;
      646     5177    1       IF BREAK_FLAG>0 THEN /* IF USER HIT BREAK KEY */

   5177  4 002654   000000 235000 xsym               LDA     BREAK_FLAG
         4 002655   002660 604400 4                  TMOZ    s:5179

      647     5178    1           ALTRETURN; /* TERMINATE PROCESSING */

   5178  4 002656   000000 221200 0                  LDX1  ! 0
         4 002657   000000 702211                    TSX2  ! 0,X1

      648     5179    1       NO_SETS = SC_PTR; /* SAVE TOTAL NUMBER OF SET TO PROCESS */

   5179  4 002660   000000 235000 xsym               LDA     SC_PTR
         4 002661   000000 755000 xsym               STA     NO_SETS

      649     5180        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:131  
      650     5181         /* IF COMMAND IS CONVERT THEN ALL EIS FOR POINTERS AND
      651     5182            FOR KEYS MUST BE REARRANGED. CAUSE THIS IS A PARTIAL
      652     5183            RESTRUCTURE. AND SCHEMA IS NEWLY DMCL'ED, IT DOESNOT
      653     5184            REFLECT THE FORMAT OF RECORD IN DATABASE RIGHT */
      654     5185    1       IF ZI$DIR.CODE=#CONVERT THEN

   5185  4 002662   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002663   000043 376000 5                  ANQ     35
         4 002664   000005 116003                    CMPQ    5,DU
         4 002665   003016 601000 4                  TNZ     s:5213

      655     5186    2       DO Y=0 TO 4000; /* GO THRU ALL TYPES */

   5186  4 002666   000003 450000 0                  STZ     Y

      656     5187    2           X = TYPE.MSTRINDX(Y);

   5187  4 002667   000003 235000 0                  LDA     Y
         4 002670   000001 735000                    ALS     1
         4 002671   000000 100405                    MLR     fill='000'O
         4 002672   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
         4 002673   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 002674   000054 236000 0                  LDQ     @EIS+3
         4 002675   000022 732000                    QRS     18
         4 002676   000000 756000 xsym               STQ     X

      657     5188    2           IF X>0 THEN /* FIND A SM */

   5188  4 002677   003012 604400 4                  TMOZ    s:5210

      658     5189    3           DO;

      659     5190    3               RB = 0; /* A COUNT OF NO OF SC FOR THIS SM */

   5190  4 002700   000000 450000 xsym               STZ     RB

      660     5191    4               DO WHILE(X>0);
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:132  

   5191  4 002701   002740 604400 4                  TMOZ    s:5198

      661     5192    4                   RC_TBL.REDEF_NEXT.OFST(X)=RC_TBL.REDEF_NEXT.OFST(X)+RB;

   5192  4 002702   000000 236000 xsym               LDQ     X
         4 002703   000003 402007                    MPY     3,DL
         4 002704   000000 620006                    EAX0    0,QL
         4 002705   000000 236006 xsym               LDQ     RC_TBL,QL
         4 002706   000020 772000                    QRL     16
         4 002707   377777 376007                    ANQ     131071,DL
         4 002710   000000 036000 xsym               ADLQ    RB
         4 002711   000020 736000                    QLS     16
         4 002712   000000 676010 xsym               ERQ     RC_TBL,X0
         4 002713   000142 376000 5                  ANQ     98
         4 002714   000000 656010 xsym               ERSQ    RC_TBL,X0

      662     5193    4                   RC_TBL.BYTES_SHIFT(X)=RB; /* SAVE THIS INFO */

   5193  4 002715   000000 236000 xsym               LDQ     RB
         4 002716   000011 736000                    QLS     9
         4 002717   000001 676010 xsym               ERQ     RC_TBL+1,X0
         4 002720   777000 376007                    ANQ     -512,DL
         4 002721   000001 656010 xsym               ERSQ    RC_TBL+1,X0

      663     5194    4                   RB = RB+SC_TBL.PA_PTRSIZE(RC_TBL.SC_PTR(X));

   5194  4 002722   000002 236010 xsym               LDQ     RC_TBL+2,X0
         4 002723   000022 772000                    QRL     18
         4 002724   000777 376007                    ANQ     511,DL
         4 002725   000405 402007                    MPY     261,DL
         4 002726   003000 061406                    CSR     bolr='003'O
         4 002727   000004 020003 xsym               BDSC    SC_TBL+4,Q               by=0,bit=2,n=3
         4 002730   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 002731   000054 236000 0                  LDQ     @EIS+3
         4 002732   000000 036000 xsym               ADLQ    RB
         4 002733   000000 756000 xsym               STQ     RB
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:133  

      664     5195    4                   X = RC_TBL.RC_NEXT(X); /* GO TO NEXT SC */

   5195  4 002734   000002 236010 xsym               LDQ     RC_TBL+2,X0
         4 002735   000033 772000                    QRL     27
         4 002736   000000 756000 xsym               STQ     X

      665     5196    4                   END;

   5196  4 002737   002702 605400 4                  TPNZ    s:5192

      666     5197         /* NOW, RB = # BYTES TO ADD KEY_EIS TO FRAME OLD KEYS */
      667     5198    3               X = TYPE.MSTRINDX(Y);

   5198  4 002740   000003 235000 0                  LDA     Y
         4 002741   000001 735000                    ALS     1
         4 002742   000000 100405                    MLR     fill='000'O
         4 002743   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
         4 002744   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 002745   000054 236000 0                  LDQ     @EIS+3
         4 002746   000022 732000                    QRS     18
         4 002747   000000 756000 xsym               STQ     X

      668     5199    4               DO WHILE(X>0); /* GO THRU ALL SC AGAIN */

   5199  4 002750   003012 604400 4                  TMOZ    s:5210

      669     5200    4                   RE = RC_TBL.KEY_PTR(X); /* POINTS TO FIRST KEY_EIS */

   5200  4 002751   000000 236000 xsym               LDQ     X
         4 002752   000003 402007                    MPY     3,DL
         4 002753   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 002754   001777 376007                    ANQ     1023,DL
         4 002755   000000 756000 xsym               STQ     RE

      670     5201    4                   REC_CNT=RC_TBL.NO_OF_KEYS(X); /* AND NO OF KEYS */

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:134  
   5201  4 002756   000000 236000 xsym               LDQ     X
         4 002757   000003 402007                    MPY     3,DL
         4 002760   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 002761   000012 772000                    QRL     10
         4 002762   000077 376007                    ANQ     63,DL
         4 002763   000000 756000 xsym               STQ     REC_CNT

      671     5202    5                   DO WHILE(REC_CNT>0);

   5202  4 002764   003004 604400 4                  TMOZ    s:5207

      672     5203    5                       KEY_TBL.EIS_REDEF.OFST(RE)=KEY_TBL.EIS_REDEF.OFST(RE)+RB;

   5203  4 002765   000000 720000 xsym               LXL0    RE
         4 002766   000000 236010 xsym               LDQ     KEY_TBL,X0
         4 002767   000020 772000                    QRL     16
         4 002770   017777 376007                    ANQ     8191,DL
         4 002771   000000 036000 xsym               ADLQ    RB
         4 002772   000020 736000                    QLS     16
         4 002773   000000 676010 xsym               ERQ     KEY_TBL,X0
         4 002774   000105 376000 5                  ANQ     69
         4 002775   000000 656010 xsym               ERSQ    KEY_TBL,X0

      673     5204    5                       RE = RE+1; /* NEXT KEY */

   5204  4 002776   000000 235000 xsym               LDA     RE
         4 002777   000001 035007                    ADLA    1,DL
         4 003000   000000 755000 xsym               STA     RE

      674     5205    5                       REC_CNT = REC_CNT - 1;

   5205  4 003001   000001 336007                    LCQ     1,DL
         4 003002   000000 056000 xsym               ASQ     REC_CNT

      675     5206    5                       END;

   5206  4 003003   002765 605400 4                  TPNZ    s:5203
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:135  

      676     5207    4                   X = RC_TBL.RC_NEXT(X); /* NEXT SM */

   5207  4 003004   000000 236000 xsym               LDQ     X
         4 003005   000003 402007                    MPY     3,DL
         4 003006   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 003007   000033 772000                    QRL     27
         4 003010   000000 756000 xsym               STQ     X

      677     5208    4                   END;

   5208  4 003011   002751 605400 4                  TPNZ    s:5200

      678     5209    3               END;

      679     5210    2           END; /* DO LOOP OF TYPE TABLE */

   5210  4 003012   000003 054000 0                  AOS     Y
         4 003013   000003 235000 0                  LDA     Y
         4 003014   007640 115007                    CMPA    4000,DL
         4 003015   002667 604400 4                  TMOZ    s:5187

      680     5211
      681     5212        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:136  
      682     5213    1       IF XREF_BUILT = %YES# THEN

   5213  4 003016   000000 234000 xsym               SZN     XREF_BUILT
         4 003017   003023 605000 4                  TPL     s:5215

      683     5214    1           CALL FREE_DYN_MEM; /* RELEASE ALL MEMORY WE CAN THINK OF */

   5214  4 003020   000011 631400 5                  EPPR1   9
         4 003021   000000 701000 xent               TSX1    FREE_DYN_MEM
         4 003022   000000 011000                    NOP     0

      684     5215    1       XREF_BUILT = %NO#;

   5215  4 003023   000000 450000 xsym               STZ     XREF_BUILT

      685     5216    1       CALL DB_FUNC_FIN DBALT;

   5216  4 003024   000011 631400 5                  EPPR1   9
         4 003025   000000 701000 xent               TSX1    DB_FUNC_FIN
         4 003026   003155 702000 4                  TSX2    DB_ALT

      686     5217    1       SCHEMA_ACTIVE='0'B; /* SET TO NO SCHEMA IN CONTROL */

   5217  4 003027   000000 450000 xsym               STZ     SCHEMA_ACTIVE

      687     5218    1       IF BREAK_FLAG>0 THEN ALTRETURN; /* LAST CHANCE FOR CLEAN EXIT */

   5218  4 003030   000000 235000 xsym               LDA     BREAK_FLAG
         4 003031   003034 604400 4                  TMOZ    s:5219

   5218  4 003032   000000 221200 0                  LDX1  ! 0
         4 003033   000000 702211                    TSX2  ! 0,X1

      688     5219    1       RB=0; /* KEEP A COUNT OF PAGES TO READ */

   5219  4 003034   000000 450000 xsym               STZ     RB

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:137  
      689     5220    1       RE=0; /* KEEP A COUNT OF AREAS TO OPEN */

   5220  4 003035   000000 450000 xsym               STZ     RE

      690     5221    2       DO AC_PTR=0 TO NO_AREAS;

   5221  4 003036   000000 450000 xsym               STZ     AC_PTR
         4 003037   003071 710000 4                  TRA     s:5230+1

      691     5222    2           IF AC_TBL.RANGE_HIGH(AC_PTR)>0 THEN

   5222  4 003040   000000 236000 xsym               LDQ     AC_PTR
         4 003041   000014 402007                    MPY     12,DL
         4 003042   000002 235006 xsym               LDA     AC_TBL+2,QL
         4 003043   003047 604400 4                  TMOZ    s:5224

      692     5223    2               CALL OPEN_AREA ALTRET(ALT_ZIU$CMPT_INIT);

   5223  4 003044   000011 631400 5                  EPPR1   9
         4 003045   000000 701000 xent               TSX1    OPEN_AREA
         4 003046   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      693     5224    2           IF AC_TBL.RANGE_HIGH(AC_PTR)>0 THEN

   5224  4 003047   000000 236000 xsym               LDQ     AC_PTR
         4 003050   000014 402007                    MPY     12,DL
         4 003051   000002 235006 xsym               LDA     AC_TBL+2,QL
         4 003052   003070 604400 4                  TMOZ    s:5230

      694     5225         /* MAY NOT BE > 0 AFTER OPEN_AREA */
      695     5226    3           DO;

      696     5227    3               RE=RE+1; /* INCREMENT NO_OF_AREAS TO BE OPENED */

   5227  4 003053   000000 235000 xsym               LDA     RE
         4 003054   000001 035007                    ADLA    1,DL
         4 003055   000000 755000 xsym               STA     RE
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:138  

      697     5228    3               RB=RB+AC_TBL.RANGE_HIGH(AC_PTR)-AC_TBL.RANGE_LOW(AC_PTR)+1;;

   5228  4 003056   000002 236006 xsym               LDQ     AC_TBL+2,QL
         4 003057   000000 036000 xsym               ADLQ    RB
         4 003060   000054 756000 0                  STQ     @EIS+3
         4 003061   000000 236000 xsym               LDQ     AC_PTR
         4 003062   000014 402007                    MPY     12,DL
         4 003063   000000 620006                    EAX0    0,QL
         4 003064   000054 236000 0                  LDQ     @EIS+3
         4 003065   000001 136010 xsym               SBLQ    AC_TBL+1,X0
         4 003066   000001 036007                    ADLQ    1,DL
         4 003067   000000 756000 xsym               STQ     RB

      698     5229    3               END;

      699     5230    2           END; /* ALL AREAS TO BE PROCESSED OPENED */

   5230  4 003070   000000 054000 xsym               AOS     AC_PTR
         4 003071   000000 236000 xsym               LDQ     AC_PTR
         4 003072   000000 116000 xsym               CMPQ    NO_AREAS
         4 003073   003040 604400 4                  TMOZ    s:5222

      700     5231    1       CALL BIN_CHAR(0,NO_SETS+1);

   5231  4 003074   000000 235000 xsym               LDA     NO_SETS
         4 003075   000001 035007                    ADLA    1,DL
         4 003076   000054 755000 0                  STA     @EIS+3
         4 003077   000054 630400 0                  EPPR0   @EIS+3
         4 003100   000057 450400 0                  STP0    @EIS+6
         4 003101   000014 236000 5                  LDQ     12
         4 003102   000056 756000 0                  STQ     @EIS+5
         4 003103   000056 630400 0                  EPPR0   @EIS+5
         4 003104   000000 631400 5                  EPPR1   0
         4 003105   000000 701000 xent               TSX1    BIN_CHAR
         4 003106   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:139  
      701     5232    1       CALL BIN_CHAR(1,RB);

   5232  4 003107   000143 630400 5                  EPPR0   99
         4 003110   000000 631400 5                  EPPR1   0
         4 003111   000000 701000 xent               TSX1    BIN_CHAR
         4 003112   000000 011000                    NOP     0

      702     5233    1       CALL BIN_CHAR(2,RE); /* NO_AREAS */

   5233  4 003113   000145 630400 5                  EPPR0   101
         4 003114   000000 631400 5                  EPPR1   0
         4 003115   000000 701000 xent               TSX1    BIN_CHAR
         4 003116   000000 011000                    NOP     0

      703     5234    1       IF ZI$DIR.CODE=#COMPACT THEN

   5234  4 003117   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003120   000043 376000 5                  ANQ     35
         4 003121   000044 116000 5                  CMPQ    36
         4 003122   003126 601000 4                  TNZ     s:5237

      704     5235    1           X=DBU#TOTPA;

   5235  4 003123   021706 235007                    LDA     9158,DL
         4 003124   000000 755000 xsym               STA     X
         4 003125   003147 710000 4                  TRA     s:5247

      705     5236    1       ELSE
      706     5237    1           IF ZI$DIR.CODE=#RESORT THEN /* GIVE EXECUTING MSG */

   5237  4 003126   000067 116000 5                  CMPQ    55
         4 003127   003133 601000 4                  TNZ     s:5240

      707     5238    1               X=DBU#TOTSSET;

   5238  4 003130   021714 235007                    LDA     9164,DL
         4 003131   000000 755000 xsym               STA     X
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:140  
         4 003132   003147 710000 4                  TRA     s:5247

      708     5239    1           ELSE
      709     5240    1               IF ZI$DIR.CODE=#REBUILDPA THEN

   5240  4 003133   000045 116000 5                  CMPQ    37
         4 003134   003140 601000 4                  TNZ     s:5243

      710     5241    1                   X=DBU#TOTRSET;

   5241  4 003135   021756 235007                    LDA     9198,DL
         4 003136   000000 755000 xsym               STA     X
         4 003137   003147 710000 4                  TRA     s:5247

      711     5242    1               ELSE
      712     5243    1                   IF ZI$DIR.CODE=#REVERT THEN

   5243  4 003140   000046 116000 5                  CMPQ    38
         4 003141   003145 601000 4                  TNZ     s:5246

      713     5244    1                       X=DBU#TOTRVSET;

   5244  4 003142   021715 235007                    LDA     9165,DL
         4 003143   000000 755000 xsym               STA     X
         4 003144   003147 710000 4                  TRA     s:5247

      714     5245    1                   ELSE
      715     5246    1                       X=DBU#TOTCSET; /* CONVERTing */

   5246  4 003145   021716 235007                    LDA     9166,DL
         4 003146   000000 755000 xsym               STA     X

      716     5247    1       CALL ERROR_MSG(X); /* %U1,U2,U3 SETUP ABOVE */

   5247  4 003147   000047 630400 5                  EPPR0   39
         4 003150   000003 631400 5                  EPPR1   3
         4 003151   000000 701000 xent               TSX1    ERROR_MSG
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:141  
         4 003152   000000 011000                    NOP     0

      717     5248    1   RET: RETURN; /* RETURN TO SUB DRIVER, THEN GOTO ZIU$COMPACT */

   5248  4 003153   000000 221200 0     RET          LDX1  ! 0
         4 003154   000001 702211                    TSX2  ! 1,X1

      718     5249        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:142  
      719     5250        /*E*  ERROR: ZIU-DBU#TOTPA-C
      720     5251            MESSAGE:COMPACTing - %U1 pointer array sets:
      721     5252                                 %U2 pages to read in %U3 areas. */
      722     5253        /*E*  ERROR: ZIU-DBU#TOTSSET-C
      723     5254            MESSAGE:RESORTing - %U1 sorted sets:
      724     5255                                %U2 pages to read in %U3 areas. */
      725     5256        /*E*  ERROR: ZIU-DBU#TOTRVSET-C
      726     5257            MESSAGE:
      727     5258                    CONVERTing - %U1 PA mode sorted sets to CHAIN,
      728     5259                                 %U2 pages to read in %U3 areas. */
      729     5260        /*E*  ERROR: ZIU-DBU#TOTCSET-C
      730     5261            MESSAGE:
      731     5262                    CONVERTing - %U1 sorted sets to PA mode,
      732     5263                                 %U2 pages to read in %U3 areas. */
      733     5264        /*E*  ERROR: ZIU-DBU#TOTRSET-C
      734     5265            MESSAGE:REBUILDing - %U1 pointer array sets:
      735     5266                                 %U2 pages to read in %U3 areas. */
      736     5267        /*E*  ERROR: ZIU-DBU#PADCBCON-C
      737     5268        MESSAGE:
      738     5269                 The set "%U1" is a %U2 set in source schema, but %U3 in target.
      739     5270                 If converting from CHAIN to PA, the mode of this set should
      740     5271                 be described the other way around.
      741     5272                 Check your DCB assignments for source and target schemas. */
      742     5273        /*E*  ERROR: ZIU-DBU#PADMCLER-C
      743     5274        MESSAGE:
      744     5275                 Schema inconsistency detected.  The possible errors are:
      745     5276                 1)  Source and target schema DCBs are set the other way around.
      746     5277                 2)  The target schema is generated from scratch. I.E.
      747     5278                     The target schema is not a copy of source with some
      748     5279                         additional DMCL operations.
      749     5280                     In this case, there can be no DMCL activity record for the
      750     5281                     source schema.  If you want to skip this security check, enter
      751     5282                     the command again with the BYPASS DMCL CHECK option. */
      752     5283
      753     5284        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:143  
      754     5285    1   DB_ALT:
      755     5286    1       UWA.SN_REC.SENAME = UWA.DB_STATUS;

   5286  4 003155   040000 100400       DB_ALT       MLR     fill='040'O
         4 003156   000001 400005 xsym               ADSC9   UWA+1                    cn=2,n=5
         4 003157   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30

      756     5287    1       CALL ERROR_MSG(DBU#DBERR,UWA.SN_REC.SENAME,COMMAND_TEXT);

   5287  4 003160   000040 630400 5                  EPPR0   32
         4 003161   000012 631400 5                  EPPR1   10
         4 003162   000000 701000 xent               TSX1    ERROR_MSG
         4 003163   000000 011000                    NOP     0

      757     5288    1   CLOSE_SCHEMA: /* SOMETHIN WRONG WITH THIS SCHEMA SO CLOSE IT */
      758     5289    1       SCHEMA_ACTIVE='0'B; /* SET THIS SCHEMA IS NO LONGER ACTIVE */

   5289  4 003164   000000 450000 xsym  CLOSE_SCHEMA STZ     SCHEMA_ACTIVE

      759     5290    1       CALL DB_FUNC_FIN;

   5290  4 003165   000011 631400 5                  EPPR1   9
         4 003166   000000 701000 xent               TSX1    DB_FUNC_FIN
         4 003167   000000 011000                    NOP     0

      760     5291    1       ALTRETURN;

   5291  4 003170   000000 221200 0                  LDX1  ! 0
         4 003171   000000 702211                    TSX2  ! 0,X1

      761     5292
      762     5293    1   AC_OVERFLOW: /* AREA TABLE OVER FLOW */
      763     5294    1       CALL BIN_CHAR(1,AC_PTR);

   5294  4 003172   000147 630400 5     AC_OVERFLOW  EPPR0   103
         4 003173   000000 631400 5                  EPPR1   0
         4 003174   000000 701000 xent               TSX1    BIN_CHAR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:144  
         4 003175   000000 011000                    NOP     0

      764     5295    1       CALL ERROR_MSG(DBU#PATBLER1,COMMAND_TEXT);

   5295  4 003176   000152 630400 5                  EPPR0   106
         4 003177   000000 631400 5                  EPPR1   0
         4 003200   000000 701000 xent               TSX1    ERROR_MSG
         4 003201   000000 011000                    NOP     0

      765     5296    1       ALTRETURN;

   5296  4 003202   000000 221200 0                  LDX1  ! 0
         4 003203   000000 702211                    TSX2  ! 0,X1

      766     5297    1   SC_OVERFLOW: /* SET TABLE OVER FLOW */
      767     5298    1       X = SC_PTR;

   5298  4 003204   000000 755000 xsym  SC_OVERFLOW  STA     X

      768     5299    1       UWA.SN_REC.SENAME='set';

   5299  4 003205   040000 100400                    MLR     fill='040'O
         4 003206   000057 000003 1                  ADSC9   FTYPE_TO_CC+47           cn=0,n=3
         4 003207   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30

      769     5300    1       GOTO OVER_FLOW;

   5300  4 003210   003222 710000 4                  TRA     OVER_FLOW

      770     5301    1   RC_OVERFLOW:
      771     5302    1       X = RC_PTR;

   5302  4 003211   000000 755000 xsym  RC_OVERFLOW  STA     X

      772     5303    1       UWA.SN_REC.SENAME='record';

   5303  4 003212   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:145  
         4 003213   000060 000006 1                  ADSC9   FTYPE_TO_CC+48           cn=0,n=6
         4 003214   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30

      773     5304    1       GOTO OVER_FLOW;

   5304  4 003215   003222 710000 4                  TRA     OVER_FLOW

      774     5305    1   KEY_OVERFLOW:
      775     5306    1       X = KEY_PTR;

   5306  4 003216   000000 755000 xsym  KEY_OVERFLOW STA     X

      776     5307    1       UWA.SN_REC.SENAME='key';

   5307  4 003217   040000 100400                    MLR     fill='040'O
         4 003220   000062 000003 1                  ADSC9   FTYPE_TO_CC+50           cn=0,n=3
         4 003221   000427 000036 xsym               ADSC9   UWA+279                  cn=0,n=30

      777     5308    1   OVER_FLOW:
      778     5309    1       CALL BIN_CHAR(2,X);

   5309  4 003222   000154 630400 5     OVER_FLOW    EPPR0   108
         4 003223   000000 631400 5                  EPPR1   0
         4 003224   000000 701000 xent               TSX1    BIN_CHAR
         4 003225   000000 011000                    NOP     0

      779     5310    1       CALL ERROR_MSG(DBU#PATBLER2,UWA.SN_REC.SENAME,COMMAND_TEXT);

   5310  4 003226   000157 630400 5                  EPPR0   111
         4 003227   000012 631400 5                  EPPR1   10
         4 003230   000000 701000 xent               TSX1    ERROR_MSG
         4 003231   000000 011000                    NOP     0

      780     5311    1       ALTRETURN;

   5311  4 003232   000000 221200 0                  LDX1  ! 0
         4 003233   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:146  

      781     5312        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:147  
      782     5313        /*E*  ERROR: ZIU-DBU#NOTPASET-C
      783     5314        MESSAGE: Error: The set "%U1" is either undefined in schema %U2
      784     5315                        or a non-%U3 set.  */
      785     5316        /*E*  ERROR: ZIU-DBU#NONPA-C
      786     5317            MESSAGE:
      787     5318                     There is no "%U2" set found in schema %U1. */
      788     5319        /*E*  ERROR: ZIU-DBU#PAERROR1-C
      789     5320        MESSAGE: Error: Unacceptable data type %U3 for the field "%U1".
      790     5321                        %U2 aborted. */
      791     5322        /*E*  ERROR: ZIU-DBU#PATBLER1-C
      792     5323        MESSAGE: Area table overflow;
      793     5324                 current area index is %U2.
      794     5325                 This schema has too many areas defined for %U1 to handle,
      795     5326                      please report the problem.
      796     5327                      <<<< SOFTWARE ERROR >>>>  */
      797     5328        /*E*  ERROR: ZIU-DBU#PATBLER2-C
      798     5329        MESSAGE: %U1 table overflow;
      799     5330                 current index is %U3.
      800     5331                 Please report the problem.
      801     5332                 Temporary solution is to run %U2 with fewer sets each time.
      802     5333                 <<<< SOFTWARE ERROR >>>> */
      803     5334        /*E*  ERROR: ZIU-DBU#PASCH1-C
      804     5335        MESSAGE:  RESET %U1 (This DCB is used and reset during process.) */
      805     5336        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:148  
      806     5337        /*
      807     5338              2ND ENTRY POINT   ZIU$CMPT_SMRY
      808     5339                  1) PRINT PROCESSING SUMMARY
      809     5340                  2) APPLY ALL POINTER'S PATCHES IN PATCH FILE
      810     5341        */
      811     5342    1   ZIU$CMPT_SMRY: ENTRY ALTRET;

   5342  4 003234   000000 741200 0     ZIU$CMPT_SM* STX1  ! 0

      812     5343
      813     5344    1       IF REC_CNT = 0 THEN /* NO MEMBER POINTERS CHANGED */

   5344  4 003235   000000 235000 xsym               LDA     REC_CNT
         4 003236   003324 601000 4                  TNZ     s:5390

      814     5345    2       DO;

      815     5346    2           IF ZI$DIR.CODE=#RESORT THEN

   5346  4 003237   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003240   000043 376000 5                  ANQ     35
         4 003241   000067 116000 5                  CMPQ    55
         4 003242   003250 601000 4                  TNZ     s:5349

      816     5347    2               CALL ERROR_MSG(DBU#PASUM0);

   5347  4 003243   000163 630400 5                  EPPR0   115
         4 003244   000003 631400 5                  EPPR1   3
         4 003245   000000 701000 xent               TSX1    ERROR_MSG
         4 003246   000000 011000                    NOP     0
         4 003247   004252 710000 4                  TRA     s:5559

      817     5348    2           ELSE
      818     5349    2               IF ZI$DIR.CODE=#COMPACT THEN

   5349  4 003250   000044 116000 5                  CMPQ    36
         4 003251   003257 601000 4                  TNZ     s:5352
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:149  

      819     5350    2                   CALL ERROR_MSG(DBU#PASUM7);

   5350  4 003252   000165 630400 5                  EPPR0   117
         4 003253   000003 631400 5                  EPPR1   3
         4 003254   000000 701000 xent               TSX1    ERROR_MSG
         4 003255   000000 011000                    NOP     0
         4 003256   004252 710000 4                  TRA     s:5559

      820     5351    2               ELSE
      821     5352    2                   IF ZI$DIR.CODE=#CONVERT OR ZI$DIR.CODE=#REVERT THEN

   5352  4 003257   000005 116003                    CMPQ    5,DU
         4 003260   003263 600000 4                  TZE     s:5353
         4 003261   000046 116000 5                  CMPQ    38
         4 003262   003270 601000 4                  TNZ     s:5356

      822     5353    2                       CALL ERROR_MSG(DBU#PASUM8,COMMAND_TEXT);

   5353  4 003263   000167 630400 5                  EPPR0   119
         4 003264   000000 631400 5                  EPPR1   0
         4 003265   000000 701000 xent               TSX1    ERROR_MSG
         4 003266   000000 011000                    NOP     0
         4 003267   004252 710000 4                  TRA     s:5559

      823     5354    2                   ELSE /* ZI$DIR.CODE=REBUILD */
      824     5355    3                   DO;

      825     5356    4                       DO X=0 TO NO_SETS;

   5356  4 003270   000000 450000 xsym               STZ     X
         4 003271   003314 710000 4                  TRA     s:5362+1

      826     5357    4                           IF SC_TBL.COUNT(X)~=0 THEN

   5357  4 003272   000000 236000 xsym               LDQ     X
         4 003273   000405 402007                    MPY     261,DL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:150  
         4 003274   000000 116003                    CMPQ    0,DU
         4 003275   003277 605000 4                  TPL     s:5357+5
         4 003276   000044 036003                    ADLQ    36,DU
         4 003277   003000 060406                    CSL     bolr='003'O
         4 003300   000006 450022 xsym               BDSC    SC_TBL+6,Q               by=2,bit=5,n=18
         4 003301   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 003302   000054 236000 0                  LDQ     @EIS+3
         4 003303   000022 732000                    QRS     18
         4 003304   000000 116003                    CMPQ    0,DU
         4 003305   003313 600000 4                  TZE     s:5362

      827     5358    5                           DO;

      828     5359    5                               CALL ERROR_MSG(DBU#PAINFO2);

   5359  4 003306   000172 630400 5                  EPPR0   122
         4 003307   000003 631400 5                  EPPR1   3
         4 003310   000000 701000 xent               TSX1    ERROR_MSG
         4 003311   000000 011000                    NOP     0

      829     5360    5                               GOTO SETS_SUMMARY;

   5360  4 003312   003747 710000 4                  TRA     SETS_SUMMARY

      830     5361    5                               END;
      831     5362    4                           END;

   5362  4 003313   000000 054000 xsym               AOS     X
         4 003314   000000 236000 xsym               LDQ     X
         4 003315   000000 116000 xsym               CMPQ    NO_SETS
         4 003316   003272 604400 4                  TMOZ    s:5357

      832     5363    3                       CALL ERROR_MSG(DBU#PASUM11);

   5363  4 003317   000174 630400 5                  EPPR0   124
         4 003320   000003 631400 5                  EPPR1   3
         4 003321   000000 701000 xent               TSX1    ERROR_MSG
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:151  
         4 003322   000000 011000                    NOP     0

      833     5364    3                       END;

      834     5365    2           END;

   5365  4 003323   004252 710000 4                  TRA     s:5559

      835     5366        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:152  
      836     5367        /*E* ERROR: ZIU-DBU#PASUM0-C
      837     5368        MESSAGE:+
      838     5369                +  RESORT completed. - No record is out of sequence.
      839     5370                +   */
      840     5371        /*E* ERROR: ZIU-DBU#PASUM7-C
      841     5372        MESSAGE:+
      842     5373                +  COMPACT completed.  No index in PA_RECs is rearranged.
      843     5374                +   */
      844     5375        /*E* ERROR: ZIU-DBU#PASUM8-C
      845     5376        MESSAGE:+
      846     5377                +  %U1 completed.  No member record is found at all.
      847     5378                +   */
      848     5379        /*E* ERROR: ZIU-DBU#PASUM11-C
      849     5380        MESSAGE:+
      850     5381                +  REBUILD PA completed. - No member found at all.
      851     5382                +   */
      852     5383        /*E*  ERROR: ZIU-DBU#PAINFO2-C
      853     5384        MESSAGE:+
      854     5385                +  REBUILD PA completed with no pointer modification.
      855     5386                +   */
      856     5387        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:153  
      857     5388    1       ELSE /* THAT IS   WHEN REC_CNT>0 */
      858     5389    2       DO;

      859     5390    2           CALL BIN_CHAR(1,REC_CNT);

   5390  4 003324   000175 630400 5                  EPPR0   125
         4 003325   000000 631400 5                  EPPR1   0
         4 003326   000000 701000 xent               TSX1    BIN_CHAR
         4 003327   000000 011000                    NOP     0

      860     5391    2           CALL ERROR_MSG(DBU#PAINFO1,COMMAND_TEXT);

   5391  4 003330   000200 630400 5                  EPPR0   128
         4 003331   000000 631400 5                  EPPR1   0
         4 003332   000000 701000 xent               TSX1    ERROR_MSG
         4 003333   000000 011000                    NOP     0

      861     5392    2           READ_TEMP.V.DCB# = DBKEY_SORT_DCB;

   5392  4 003334   000000 220000 xsym               LDX0    DBKEY_SORT_DCB
         4 003335   000030 740000 0                  STX0    READ_TEMP+8

      862     5393    2           CURR_PAGE = 0;

   5393  4 003336   000010 450000 0                  STZ     CURR_PAGE

      863     5394    2           LAST_BAD_PAGE=0;

   5394  4 003337   000011 450000 0                  STZ     LAST_BAD_PAGE

      864     5395    2           AC_PTR = 0; /* DBKEY IN SORT ORDER,SO START FROM 1ST AC */

   5395  4 003340   000000 450000 xsym               STZ     AC_PTR

      865     5396    2           BUF_PTR = 0; /* NOTE: TEMP FILE IS KEYED ON DBK ORDER */

   5396  4 003341   000007 450000 0                  STZ     BUF_PTR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:154  

      866     5397         /* SO EACH PAGE REQ IS IN ASCENDING */
      867     5398
      868     5399    2           DCBSF = DBKEY_SORT_DCB;

   5399  4 003342   000000 740000 xsym               STX0    DCBSF

      869     5400    2           FIDSF = '*POINTER_PATCH_FILE';

   5400  4 003343   040000 100400                    MLR     fill='040'O
         4 003344   000063 000023 1                  ADSC9   FTYPE_TO_CC+51           cn=0,n=19
         4 003345   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

      870     5401    2           ASNSF = %FILE#;

   5401  4 003346   000001 235007                    LDA     1,DL
         4 003347   000000 755000 xsym               STA     ASNSF

      871     5402    2           ACSSF = %SEQUEN#;

   5402  4 003350   000000 755000 xsym               STA     ACSSF

      872     5403    2           FUNSF = %IN#;

   5403  4 003351   000002 236007                    LDQ     2,DL
         4 003352   000000 756000 xsym               STQ     FUNSF

      873     5404    2           REASGNSF = %YES#;

   5404  4 003353   400000 236003                    LDQ     -131072,DU
         4 003354   000000 756000 xsym               STQ     REASGNSF

      874     5405    2           CALL SYS_FUNC_OPEN ALTRET(OPEN_ERR);

   5405  4 003355   000011 631400 5                  EPPR1   9
         4 003356   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 003357   004253 702000 4                  TSX2    OPEN_ERR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:155  

      875     5406        /*
      876     5407                 UPDATE THE EIS FOR NEXT POINTER FOR ALL MEMBER TO BE
      877     5408                 REVERTED TO NON-PA FORMAT, CAUSE THE SCHEMA HAS
      878     5409                 NOT BEEN DMCL'ED YET, WE HAVE TO ANTICIPATE THE NEW LOCATION
      879     5410                 OF ALL THE POINTERS
      880     5411        */
      881     5412    2           IF ZI$DIR.CODE=#REVERT THEN

   5412  4 003360   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003361   000043 376000 5                  ANQ     35
         4 003362   000046 116000 5                  CMPQ    38
         4 003363   003504 601000 4                  TNZ     s:5434

      882     5413    3           DO;

      883     5414    3               TYPE='0'B;

   5414  4 003364   017502 220003                    LDX0    8002,DU
         4 003365   000040 100400                    MLR     fill='000'O
         4 003366   000011 000001 5                  ADSC9   9                        cn=0,n=1
         4 003367   000000 000010 xsym               ADSC9   TYPE                     cn=0,n=*X0

      884     5415    4               DO SC_PTR=0 TO NO_SETS; /* FROM SET TO EACH SM */

   5415  4 003370   000000 450000 xsym               STZ     SC_PTR
         4 003371   003501 710000 4                  TRA     s:5426+1

      885     5416    4                   RC_PTR=SC_TBL.RC_PTR(SC_PTR)+1;

   5416  4 003372   000000 236000 xsym               LDQ     SC_PTR
         4 003373   000405 402007                    MPY     261,DL
         4 003374   000000 116003                    CMPQ    0,DU
         4 003375   003377 605000 4                  TPL     s:5416+5
         4 003376   000044 036003                    ADLQ    36,DU
         4 003377   003000 061406                    CSR     bolr='003'O
         4 003400   000005 650011 xsym               BDSC    SC_TBL+5,Q               by=3,bit=5,n=9
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:156  
         4 003401   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 003402   000054 236000 0                  LDQ     @EIS+3
         4 003403   000001 036007                    ADLQ    1,DL
         4 003404   000000 756000 xsym               STQ     RC_PTR

      886     5417    4                   X=SC_TBL.NO_OF_SM(SC_PTR);

   5417  4 003405   000000 236000 xsym               LDQ     SC_PTR
         4 003406   000405 402007                    MPY     261,DL
         4 003407   000000 116003                    CMPQ    0,DU
         4 003410   003412 605000 4                  TPL     s:5417+5
         4 003411   000044 036003                    ADLQ    36,DU
         4 003412   003000 061406                    CSR     bolr='003'O
         4 003413   000005 420006 xsym               BDSC    SC_TBL+5,Q               by=2,bit=2,n=6
         4 003414   000000 000044 xsym               BDSC    X                        by=0,bit=0,n=36

      887     5418    5                   DO WHILE(X>0); /* CHANGE EIS TO NEW EIS */

   5418  4 003415   000000 235000 xsym               LDA     X
         4 003416   003500 604400 4                  TMOZ    s:5426

      888     5419    5                       Y=RC_TBL.TYPE(RC_PTR);

   5419  4 003417   000000 236000 xsym               LDQ     RC_PTR
         4 003420   000003 402007                    MPY     3,DL
         4 003421   000001 236006 xsym               LDQ     RC_TBL+1,QL
         4 003422   000022 772000                    QRL     18
         4 003423   000003 756000 0                  STQ     Y

      889     5420    5                       RC_TBL.REDEF_NEXT.OFST(RC_PTR)=RC_TBL.REDEF_NEXT.OFST(RC_PTR)+

   5420  4 003424   000000 236000 xsym               LDQ     RC_PTR
         4 003425   000003 402007                    MPY     3,DL
         4 003426   000003 235000 0                  LDA     Y
         4 003427   000001 735000                    ALS     1
         4 003430   000000 100405                    MLR     fill='000'O
         4 003431   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:157  
         4 003432   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 003433   000000 620006                    EAX0    0,QL
         4 003434   000054 236000 0                  LDQ     @EIS+3
         4 003435   000022 732000                    QRS     18
         4 003436   000055 756000 0                  STQ     @EIS+4
         4 003437   000000 236010 xsym               LDQ     RC_TBL,X0
         4 003440   000020 772000                    QRL     16
         4 003441   377777 376007                    ANQ     131071,DL
         4 003442   000055 036000 0                  ADLQ    @EIS+4
         4 003443   000020 736000                    QLS     16
         4 003444   000000 676010 xsym               ERQ     RC_TBL,X0
         4 003445   000142 376000 5                  ANQ     98
         4 003446   000000 656010 xsym               ERSQ    RC_TBL,X0

      890     5421    5                          TYPE.MSTRINDX(Y);
      891     5422    5                       TYPE.MSTRINDX(Y)=TYPE.MSTRINDX(Y)+SC_TBL.PA_PTRSIZE(SC_PTR);

   5422  4 003447   000000 236000 xsym               LDQ     SC_PTR
         4 003450   000405 402007                    MPY     261,DL
         4 003451   000000 116003                    CMPQ    0,DU
         4 003452   003454 605000 4                  TPL     s:5422+5
         4 003453   000044 036003                    ADLQ    36,DU
         4 003454   003000 061406                    CSR     bolr='003'O
         4 003455   000004 020003 xsym               BDSC    SC_TBL+4,Q               by=0,bit=2,n=3
         4 003456   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 003457   000003 235000 0                  LDA     Y
         4 003460   000001 735000                    ALS     1
         4 003461   000000 100405                    MLR     fill='000'O
         4 003462   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
         4 003463   000055 000004 0                  ADSC9   @EIS+4                   cn=0,n=4
         4 003464   000055 236000 0                  LDQ     @EIS+4
         4 003465   000022 732000                    QRS     18
         4 003466   000054 036000 0                  ADLQ    @EIS+3
         4 003467   000056 756000 0                  STQ     @EIS+5
         4 003470   000005 101400                    MRL     fill='000'O
         4 003471   000056 000004 0                  ADSC9   @EIS+5                   cn=0,n=4
         4 003472   000000 000002 xsym               ADSC9   TYPE,A                   cn=0,n=2
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:158  

      892     5423    5                       X=X-1;

   5423  4 003473   000001 336007                    LCQ     1,DL
         4 003474   000000 056000 xsym               ASQ     X

      893     5424    5                       RC_PTR=RC_PTR+1;

   5424  4 003475   000000 054000 xsym               AOS     RC_PTR

      894     5425    5                       END;

   5425  4 003476   000000 235000 xsym               LDA     X
         4 003477   003417 605400 4                  TPNZ    s:5419

      895     5426    4                   END;

   5426  4 003500   000000 054000 xsym               AOS     SC_PTR
         4 003501   000000 236000 xsym               LDQ     SC_PTR
         4 003502   000000 116000 xsym               CMPQ    NO_SETS
         4 003503   003372 604400 4                  TMOZ    s:5416

      896     5427    3               END;

      897     5428        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:159  
      898     5429        /*
      899     5430              READ EACH RECORD IN PATCH FILE, THEN APPLY THE PATCH
      900     5431                THE KEY OF EACH RECORD = THE DBKEY OF THE RECORD TO PATCH
      901     5432                THE DATE OF RECORD = NEW NEXT POINTER AND NEW PRIOR POINTER
      902     5433        */
      903     5434    3           DO REC_CNT=REC_CNT DOWNTO 1;

   5434  4 003504   003740 710000 4                  TRA     SKIP_THIS_REC+2

      904     5435    3               CALL M$READ(READ_TEMP) ALTRET(READ_ERR);

   5435  4 003505   000020 630400 0                  EPPR0   READ_TEMP
         4 003506   440000 713400                    CLIMB   alt,read
         4 003507   401400 401760                    pmme    nvectors=4
         4 003510   004265 702000 4                  TSX2    READ_ERR

      905     5436    4               DO WHILE(KEY.CURR>AC_TBL.BASE_DBK(AC_PTR+1) AND AC_PTR<NO_AREAS);

   5436  4 003511   003513 710000 4                  TRA     s:5438

      906     5437    4                   AC_PTR=AC_PTR+1;

   5437  4 003512   000000 054000 xsym               AOS     AC_PTR

      907     5438    4                   END;

   5438  4 003513   000000 236000 xsym               LDQ     AC_PTR
         4 003514   000014 402007                    MPY     12,DL
         4 003515   000000 620006                    EAX0    0,QL
         4 003516   000001 235000 0                  LDA     KEY
         4 003517   000002 236000 0                  LDQ     KEY+1
         4 003520   000033 773000                    LRL     27
         4 003521   000000 116003                    CMPQ    0,DU
         4 003522   003531 604000 4                  TMI     s:5439
         4 003523   000014 116010 xsym               CMPQ    AC_TBL+12,X0
         4 003524   003531 602000 4                  TNC     s:5439
         4 003525   003531 600000 4                  TZE     s:5439
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:160  
         4 003526   000000 236000 xsym               LDQ     AC_PTR
         4 003527   000000 116000 xsym               CMPQ    NO_AREAS
         4 003530   003512 604000 4                  TMI     s:5437

      908     5439    3               RC_PTR = KEY.RC_PTR;

   5439  4 003531   000002 236000 0                  LDQ     KEY+1
         4 003532   000022 772000                    QRL     18
         4 003533   000777 376007                    ANQ     511,DL
         4 003534   000000 756000 xsym               STQ     RC_PTR

      909     5440    3               SC_PTR = RC_TBL.SC_PTR(RC_PTR);

   5440  4 003535   000003 402007                    MPY     3,DL
         4 003536   000002 236006 xsym               LDQ     RC_TBL+2,QL
         4 003537   000022 772000                    QRL     18
         4 003540   000777 376007                    ANQ     511,DL
         4 003541   000000 756000 xsym               STQ     SC_PTR

      910     5441    3               IF AC_TBL.DCB#(AC_PTR)=0 THEN /* AREA NOT OPENED YET */

   5441  4 003542   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 003543   000377 316007                    CANQ    255,DL
         4 003544   003550 601000 4                  TNZ     s:5443

      911     5442    3                   CALL OPEN_AREA ALTRET(ALT_ZIU$CMPT_INIT);

   5442  4 003545   000011 631400 5                  EPPR1   9
         4 003546   000000 701000 xent               TSX1    OPEN_AREA
         4 003547   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      912     5443    3               RB=(KEY.CURR-AC_TBL.BASE_DBK(AC_PTR)

   5443  4 003550   000000 236000 xsym               LDQ     AC_PTR
         4 003551   000014 402007                    MPY     12,DL
         4 003552   000000 620006                    EAX0    0,QL
         4 003553   000001 235000 0                  LDA     KEY
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:161  
         4 003554   000002 236000 0                  LDQ     KEY+1
         4 003555   000033 773000                    LRL     27
         4 003556   000000 136010 xsym               SBLQ    AC_TBL,X0
         4 003557   000054 756000 0                  STQ     @EIS+3
         4 003560   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 003561   000032 772000                    QRL     26
         4 003562   000055 756000 0                  STQ     @EIS+4
         4 003563   000054 236000 0                  LDQ     @EIS+3
         4 003564   000055 036000 0                  ADLQ    @EIS+4
         4 003565   000056 756000 0                  STQ     @EIS+5
         4 003566   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 003567   000032 772000                    QRL     26
         4 003570   000057 756000 0                  STQ     @EIS+6
         4 003571   000056 236000 0                  LDQ     @EIS+5
         4 003572   000001 136007                    SBLQ    1,DL
         4 003573   000057 506000 0                  DIV     @EIS+6
         4 003574   000000 756000 xsym               STQ     RB

      913     5444    3                  +AC_TBL.LPP(AC_PTR)-1)/AC_TBL.LPP(AC_PTR);
      914     5445         /* RB = PAGE # TO READ , RE = LINE # ON THE PAGE */
      915     5446    3               RE=KEY.CURR-AC_TBL.BASE_DBK(AC_PTR)-(RB-1)*AC_TBL.LPP(AC_PTR)-1;

   5446  4 003575   000001 235000 0                  LDA     KEY
         4 003576   000002 236000 0                  LDQ     KEY+1
         4 003577   000033 773000                    LRL     27
         4 003600   000000 136010 xsym               SBLQ    AC_TBL,X0
         4 003601   000054 756000 0                  STQ     @EIS+3
         4 003602   000013 236010 xsym               LDQ     AC_TBL+11,X0
         4 003603   000032 772000                    QRL     26
         4 003604   000055 756000 0                  STQ     @EIS+4
         4 003605   000000 236000 xsym               LDQ     RB
         4 003606   000001 136007                    SBLQ    1,DL
         4 003607   000055 402000 0                  MPY     @EIS+4
         4 003610   000056 756000 0                  STQ     @EIS+5
         4 003611   000054 236000 0                  LDQ     @EIS+3
         4 003612   000056 136000 0                  SBLQ    @EIS+5
         4 003613   000001 136007                    SBLQ    1,DL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:162  
         4 003614   000000 756000 xsym               STQ     RE

      916     5447    3               IF RB>AC_TBL.NUM_DBPG(AC_PTR) THEN

   5447  4 003615   000003 236010 xsym               LDQ     AC_TBL+3,X0
         4 003616   000022 772000                    QRL     18
         4 003617   000000 116000 xsym               CMPQ    RB
         4 003620   004305 602000 4                  TNC     NO_RECORD_THERE

      917     5448    3                   GOTO NO_RECORD_THERE; /* HAS TO BE AN OWNER */
      918     5449    3               IF CURR_PAGE ~= RB*256+AC_PTR THEN

   5449  4 003621   000000 236000 xsym               LDQ     RB
         4 003622   000010 736000                    QLS     8
         4 003623   000000 036000 xsym               ADLQ    AC_PTR
         4 003624   000010 116000 0                  CMPQ    CURR_PAGE
         4 003625   003630 600000 4                  TZE     s:5451

      919     5450    3                   CALL GET_A_PAGE; /* DOUBLE BUFF THE WRITE OPERATION */

   5450  4 003626   005025 701000 4                  TSX1    GET_A_PAGE
         4 003627   000000 011000                    NOP     0

      920     5451    3               X = DATA_PG.ACT_DATA_18(2035-RE); /* LINE OFFSET */

   5451  4 003630   000000 235003                    LDA     0,DU
         4 003631   000000 135000 xsym               SBLA    RE
         4 003632   000001 735000                    ALS     1
         4 003633   000000 470400 xsym               LDP0    DATA$
         4 003634   000000 100505                    MLR     fill='000'O
         4 003635   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 003636   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 003637   000054 236000 0                  LDQ     @EIS+3
         4 003640   000022 732000                    QRS     18
         4 003641   000000 756000 xsym               STQ     X

      921     5452    3               IF RE>DATA_PG.OFF_LN.SEC OR X<12 THEN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:163  

   5452  4 003642   000005 236100                    LDQ     5,,PR0
         4 003643   777777 376007                    ANQ     -1,DL
         4 003644   000000 116000 xsym               CMPQ    RE
         4 003645   004305 602000 4                  TNC     NO_RECORD_THERE
         4 003646   000000 235000 xsym               LDA     X
         4 003647   000014 115007                    CMPA    12,DL
         4 003650   004305 604000 4                  TMI     NO_RECORD_THERE

      922     5453    3                   GOTO NO_RECORD_THERE; /* LN>HIGH_LN OR OFFSET<12 */
      923     5454        /*
      924     5455              NOW, REC$ IS POSITIONED TO THE DBK WE WANT
      925     5456        */
      926     5457    3               REC$=PINCRC(DATA$,12+X);

   5457  4 003651   000000 236000 xsym               LDQ     X
         4 003652   000020 736000                    QLS     16
         4 003653   000003 036003                    ADLQ    3,DU
         4 003654   000000 036000 xsym               ADLQ    DATA$
         4 003655   000000 756000 xsym               STQ     REC$

      927     5458    3               IF RC_PTR~=SC_TBL.RC_PTR(SC_PTR) THEN /* NOT OWNER OF SC */

   5458  4 003656   000000 236000 xsym               LDQ     SC_PTR
         4 003657   000405 402007                    MPY     261,DL
         4 003660   000000 116003                    CMPQ    0,DU
         4 003661   003663 605000 4                  TPL     s:5458+5
         4 003662   000044 036003                    ADLQ    36,DU
         4 003663   003000 061406                    CSR     bolr='003'O
         4 003664   000005 650011 xsym               BDSC    SC_TBL+5,Q               by=3,bit=5,n=9
         4 003665   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 003666   000054 236000 0                  LDQ     @EIS+3
         4 003667   000000 116000 xsym               CMPQ    RC_PTR
         4 003670   003704 600000 4                  TZE     s:5464

      928     5459    3                   IF ZI$DIR.CODE=#REVERT THEN

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:164  
   5459  4 003671   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003672   000043 376000 5                  ANQ     35
         4 003673   000046 116000 5                  CMPQ    38
         4 003674   003700 601000 4                  TNZ     s:5462

      929     5460    3                       CALL INSERT_PRIOR ALTRET(SKIP_THIS_REC);

   5460  4 003675   004547 701000 4                  TSX1    INSERT_PRIOR
         4 003676   003736 702000 4                  TSX2    SKIP_THIS_REC
         4 003677   003704 710000 4                  TRA     s:5464

      930     5461    3                   ELSE
      931     5462    3                       IF ZI$DIR.CODE=#CONVERT THEN

   5462  4 003700   000005 116003                    CMPQ    5,DU
         4 003701   003704 601000 4                  TNZ     s:5464

      932     5463    3                           CALL REMOVE_PRIOR ALTRET(SKIP_THIS_REC);

   5463  4 003702   004367 701000 4                  TSX1    REMOVE_PRIOR
         4 003703   003736 702000 4                  TSX2    SKIP_THIS_REC

      933     5464    3               CALL UPDATE_PTR(STK.NEXT,RC_TBL.NXPNT_EIS(RC_PTR));

   5464  4 003704   000000 236000 xsym               LDQ     RC_PTR
         4 003705   000003 402003                    MPY     3,DU
         4 003706   000202 036000 5                  ADLQ    130
         4 003707   000203 235000 5                  LDA     131
         4 003710   000050 757000 0                  STAQ    Z+2
         4 003711   004743 701000 4                  TSX1    UPDATE_PTR
         4 003712   000000 011000                    NOP     0

      934     5465    3               IF ZI$DIR.CODE=#RESORT /* ALL RECORDS ARE REGULAR MEMBERS */

   5465  4 003713   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003714   000043 376000 5                  ANQ     35
         4 003715   000067 116000 5                  CMPQ    55
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:165  
         4 003716   003732 600000 4                  TZE     s:5467
         4 003717   000000 236000 xsym               LDQ     SC_PTR
         4 003720   000405 402007                    MPY     261,DL
         4 003721   000000 116003                    CMPQ    0,DU
         4 003722   003724 605000 4                  TPL     s:5465+9
         4 003723   000044 036003                    ADLQ    36,DU
         4 003724   003000 061406                    CSR     bolr='003'O
         4 003725   000005 650011 xsym               BDSC    SC_TBL+5,Q               by=3,bit=5,n=9
         4 003726   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 003727   000054 236000 0                  LDQ     @EIS+3
         4 003730   000000 116000 xsym               CMPQ    RC_PTR
         4 003731   003736 601000 4                  TNZ     SKIP_THIS_REC

      935     5466    3                  OR RC_PTR=SC_TBL.RC_PTR(SC_PTR) THEN /* REC IS A SET OWNER */
      936     5467    3                   CALL UPDATE_PTR2(STK.PRIOR);

   5467  4 003732   000204 236000 5                  LDQ     132
         4 003733   000050 756000 0                  STQ     Z+2
         4 003734   004757 701000 4                  TSX1    UPDATE_PTR2
         4 003735   000000 011000                    NOP     0

      937     5468    3   SKIP_THIS_REC:
      938     5469    3               END;

   5469  4 003736   000001 336007       SKIP_THIS_R* LCQ     1,DL
         4 003737   000000 056000 xsym               ASQ     REC_CNT
         4 003740   000000 235000 xsym               LDA     REC_CNT
         4 003741   003505 605400 4                  TPNZ    s:5435

      939     5470         /* DCBSF REMAINED UNCHANGED SINCE LAST NO-WAIT WRITE */
      940     5471    2           CALL SYS_FUNC_CHECK ALTRET(ALT_ZIU$CMPT_INIT); /* WAIT LAST WRITE */

   5471  4 003742   000011 631400 5                  EPPR1   9
         4 003743   000000 701000 xent               TSX1    SYS_FUNC_CHECK
         4 003744   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      941     5472    2           CALL FLUSH_PAGE ALTRET(ALT_ZIU$CMPT_INIT); /* DEFAULT TO WAIT */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:166  

   5472  4 003745   005054 701000 4                  TSX1    FLUSH_PAGE
         4 003746   004362 702000 4                  TSX2    ALT_ZIU$CMPT_INIT

      942     5473        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:167  
      943     5474        /*E*  ERROR: ZIU-DBU#PASUM1-C
      944     5475        MESSAGE:+
      945     5476                +      SUMMARY  SETS  RESORTED
      946     5477                +      -----------------------
      947     5478                +     */
      948     5479        /*E* ERROR: ZIU-DBU#PASUM4-C
      949     5480        MESSAGE:+
      950     5481                +      SUMMARY  SETS  %U1ED
      951     5482                +      -------  ----  ---------
      952     5483                +        */
      953     5484        /*E*  ERROR: ZIU-DBU#PASUM2-C
      954     5485        MESSAGE:+  Set "%U1" has %U2 tenants with pointers modified.
      955     5486                +     */
      956     5487        /*E*  ERROR: ZIU-DBU#PASUM12-C
      957     5488        MESSAGE:+  Set "%U1" has had %U2 *PA_RECs removed,
      958     5489                +      and %U3 members CONVERTed to non-PA format.
      959     5490                +     */
      960     5491        /*E*  ERROR: ZIU-DBU#PASUM3-C
      961     5492        MESSAGE:+  Set "%U1" has had all tenants in sorted order.
      962     5493                +     */
      963     5494        /*E*  ERROR: ZIU-DBU#PASUM5-C
      964     5495        MESSAGE:+  Set "%U1" has had %U3 PA_RECs removed.
      965     5496                +      Each PA_REC was packed down to %U2 available bytes.
      966     5497                +        */
      967     5498        /*E*  ERROR: ZIU-DBU#PASUM6-C
      968     5499        MESSAGE:+  Set "%U1" has had %U3 PA_RECs constructed.
      969     5500                +      Each PA_REC was packed down to %U2 available bytes.
      970     5501                +        */
      971     5502        /*E*  ERROR: ZIU-DBU#PASUM10-C
      972     5503        MESSAGE:+  No member records found for set "%U1".
      973     5504                +   */
      974     5505        /*E*  ERROR: ZIU-DBU#PAINFO1-C
      975     5506        MESSAGE:+
      976     5507                +  %U1 completed.  Next apply %U2 pointer-patches in patch file.
      977     5508                +   */
      978     5509        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:168  
      979     5510
      980     5511    2   SETS_SUMMARY: /* PRINT SUMMARY FOR EACH SET PROCESSED */
      981     5512
      982     5513    2           IF SUBSTR(COMMAND_TEXT,0,4)='CONV' THEN

   5513  4 003747   000000 236000 xsym  SETS_SUMMARY LDQ     COMMAND_TEXT
         4 003750   000013 116000 1                  CMPQ    FTYPE_TO_CC+11
         4 003751   003755 601000 4                  TNZ     s:5515

      983     5514    2               COMMAND_TEXT='CONVERT';

   5514  4 003752   040000 100400                    MLR     fill='040'O
         4 003753   000070 000007 1                  ADSC9   FTYPE_TO_CC+56           cn=0,n=7
         4 003754   000000 000020 xsym               ADSC9   COMMAND_TEXT             cn=0,n=16

      984     5515    2           IF ZI$DIR.CODE=#RESORT THEN

   5515  4 003755   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003756   000043 376000 5                  ANQ     35
         4 003757   000067 116000 5                  CMPQ    55
         4 003760   003766 601000 4                  TNZ     s:5518

      985     5516    2               CALL ERROR_MSG(DBU#PASUM1);

   5516  4 003761   000206 630400 5                  EPPR0   134
         4 003762   000003 631400 5                  EPPR1   3
         4 003763   000000 701000 xent               TSX1    ERROR_MSG
         4 003764   000000 011000                    NOP     0
         4 003765   003772 710000 4                  TRA     s:5520

      986     5517    2           ELSE
      987     5518    2               CALL ERROR_MSG(DBU#PASUM4,COMMAND_TEXT);

   5518  4 003766   000210 630400 5                  EPPR0   136
         4 003767   000000 631400 5                  EPPR1   0
         4 003770   000000 701000 xent               TSX1    ERROR_MSG
         4 003771   000000 011000                    NOP     0
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:169  

      988     5519
      989     5520    2           IF ZI$DIR.CODE<=#CONVERT THEN /* PA RELATED COMMAND */

   5520  4 003772   000125 236000 xsym               LDQ     ZI$DIR+85
         4 003773   000043 376000 5                  ANQ     35
         4 003774   000067 116000 5                  CMPQ    55
         4 003775   004124 603000 4                  TRC     s:5539

      990     5521    3           DO SC_PTR=0 TO NO_SETS;

   5521  4 003776   000000 450000 xsym               STZ     SC_PTR
         4 003777   004120 710000 4                  TRA     s:5537+1

      991     5522    3               IF BREAK_FLAG>0 THEN GOTO RET; /* DONT TYPE ANY MORE */

   5522  4 004000   000000 235000 xsym               LDA     BREAK_FLAG
         4 004001   003153 605400 4                  TPNZ    RET

      992     5523    3               X=SC_TBL.FULL_PERCENT(SC_PTR);

   5523  4 004002   000000 236000 xsym               LDQ     SC_PTR
         4 004003   000405 402007                    MPY     261,DL
         4 004004   000000 116003                    CMPQ    0,DU
         4 004005   004007 605000 4                  TPL     s:5523+5
         4 004006   000044 036003                    ADLQ    36,DU
         4 004007   003000 061406                    CSR     bolr='003'O
         4 004010   000005 100014 xsym               BDSC    SC_TBL+5,Q               by=0,bit=8,n=12
         4 004011   000000 000044 xsym               BDSC    X                        by=0,bit=0,n=36

      993     5524    3               CALL BIN_CHAR(1,X);

   5524  4 004012   000106 630400 5                  EPPR0   70
         4 004013   000000 631400 5                  EPPR1   0
         4 004014   000000 701000 xent               TSX1    BIN_CHAR
         4 004015   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:170  
      994     5525    3               X=SC_TBL.COUNT(SC_PTR);

   5525  4 004016   000000 236000 xsym               LDQ     SC_PTR
         4 004017   000405 402007                    MPY     261,DL
         4 004020   000000 116003                    CMPQ    0,DU
         4 004021   004023 605000 4                  TPL     s:5525+5
         4 004022   000044 036003                    ADLQ    36,DU
         4 004023   003000 060406                    CSL     bolr='003'O
         4 004024   000006 450022 xsym               BDSC    SC_TBL+6,Q               by=2,bit=5,n=18
         4 004025   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 004026   000054 236000 0                  LDQ     @EIS+3
         4 004027   000022 732000                    QRS     18
         4 004030   000000 756000 xsym               STQ     X

      995     5526    3               IF X>=0 THEN

   5526  4 004031   004037 604000 4                  TMI     s:5529

      996     5527    3                   CALL BIN_CHAR(2,X);

   5527  4 004032   000154 630400 5                  EPPR0   108
         4 004033   000000 631400 5                  EPPR1   0
         4 004034   000000 701000 xent               TSX1    BIN_CHAR
         4 004035   000000 011000                    NOP     0
         4 004036   004051 710000 4                  TRA     s:5530

      997     5528    3               ELSE
      998     5529    3                   CALL BIN_CHAR(2,-1*X);

   5529  4 004037   000000 335000 xsym               LCA     X
         4 004040   000054 755000 0                  STA     @EIS+3
         4 004041   000054 630400 0                  EPPR0   @EIS+3
         4 004042   000057 450400 0                  STP0    @EIS+6
         4 004043   000064 236000 5                  LDQ     52
         4 004044   000056 756000 0                  STQ     @EIS+5
         4 004045   000056 630400 0                  EPPR0   @EIS+5
         4 004046   000000 631400 5                  EPPR1   0
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:171  
         4 004047   000000 701000 xent               TSX1    BIN_CHAR
         4 004050   000000 011000                    NOP     0

      999     5530    3               IF X>0 OR (X=0 AND ZI$DIR.CODE=#COMPACT) THEN

   5530  4 004051   000000 235000 xsym               LDA     X
         4 004052   004060 605400 4                  TPNZ    s:5531
         4 004053   004072 601000 4                  TNZ     s:5533
         4 004054   000125 236000 xsym               LDQ     ZI$DIR+85
         4 004055   000043 376000 5                  ANQ     35
         4 004056   000044 116000 5                  CMPQ    36
         4 004057   004072 601000 4                  TNZ     s:5533

     1000     5531    3                   CALL ERROR_MSG(DBU#PASUM5,SC_TBL.NAME(SC_PTR));

   5531  4 004060   000000 236000 xsym               LDQ     SC_PTR
         4 004061   000214 402000 5                  MPY     140
         4 004062   000213 036000 5                  ADLQ    139
         4 004063   000215 235000 5                  LDA     141
         4 004064   000054 757000 0                  STAQ    @EIS+3
         4 004065   000054 630400 0                  EPPR0   @EIS+3
         4 004066   000000 631400 5                  EPPR1   0
         4 004067   000000 701000 xent               TSX1    ERROR_MSG
         4 004070   000000 011000                    NOP     0
         4 004071   004117 710000 4                  TRA     s:5537

     1001     5532    3               ELSE
     1002     5533    3                   IF X<0 THEN

   5533  4 004072   000000 115003                    CMPA    0,DU
         4 004073   004106 605000 4                  TPL     s:5536

     1003     5534    3                       CALL ERROR_MSG(DBU#PASUM6,SC_TBL.NAME(SC_PTR));

   5534  4 004074   000000 236000 xsym               LDQ     SC_PTR
         4 004075   000214 402000 5                  MPY     140
         4 004076   000213 036000 5                  ADLQ    139
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:172  
         4 004077   000217 235000 5                  LDA     143
         4 004100   000054 757000 0                  STAQ    @EIS+3
         4 004101   000054 630400 0                  EPPR0   @EIS+3
         4 004102   000000 631400 5                  EPPR1   0
         4 004103   000000 701000 xent               TSX1    ERROR_MSG
         4 004104   000000 011000                    NOP     0
         4 004105   004117 710000 4                  TRA     s:5537

     1004     5535    3                   ELSE /* MUST BE REBUID PA AND NO MEMBER FOUND */
     1005     5536    3                       CALL ERROR_MSG(DBU#PASUM10,SC_TBL.NAME(SC_PTR));

   5536  4 004106   000000 236000 xsym               LDQ     SC_PTR
         4 004107   000214 402000 5                  MPY     140
         4 004110   000213 036000 5                  ADLQ    139
         4 004111   000221 235000 5                  LDA     145
         4 004112   000054 757000 0                  STAQ    @EIS+3
         4 004113   000054 630400 0                  EPPR0   @EIS+3
         4 004114   000000 631400 5                  EPPR1   0
         4 004115   000000 701000 xent               TSX1    ERROR_MSG
         4 004116   000000 011000                    NOP     0

     1006     5537    3               END;

   5537  4 004117   000000 054000 xsym               AOS     SC_PTR
         4 004120   000000 236000 xsym               LDQ     SC_PTR
         4 004121   000000 116000 xsym               CMPQ    NO_SETS
         4 004122   004000 604400 4                  TMOZ    s:5522
         4 004123   004252 710000 4                  TRA     s:5559

     1007     5538    2           ELSE
     1008     5539    3           DO SC_PTR=0 TO NO_SETS;

   5539  4 004124   000000 450000 xsym               STZ     SC_PTR
         4 004125   004247 710000 4                  TRA     s:5557+1

     1009     5540    3               X=SC_TBL.COUNT(SC_PTR);

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:173  
   5540  4 004126   000000 236000 xsym               LDQ     SC_PTR
         4 004127   000405 402007                    MPY     261,DL
         4 004130   000000 116003                    CMPQ    0,DU
         4 004131   004133 605000 4                  TPL     s:5540+5
         4 004132   000044 036003                    ADLQ    36,DU
         4 004133   003000 060406                    CSL     bolr='003'O
         4 004134   000006 450022 xsym               BDSC    SC_TBL+6,Q               by=2,bit=5,n=18
         4 004135   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 004136   000054 236000 0                  LDQ     @EIS+3
         4 004137   000022 732000                    QRS     18
         4 004140   000000 756000 xsym               STQ     X

     1010     5541    3               IF BREAK_FLAG>0 THEN GOTO RET;

   5541  4 004141   000000 235000 xsym               LDA     BREAK_FLAG
         4 004142   003153 605400 4                  TPNZ    RET

     1011     5542    3               CALL BIN_CHAR(1,X);

   5542  4 004143   000106 630400 5                  EPPR0   70
         4 004144   000000 631400 5                  EPPR1   0
         4 004145   000000 701000 xent               TSX1    BIN_CHAR
         4 004146   000000 011000                    NOP     0

     1012     5543    3               IF X>0 AND ZI$DIR.CODE=#RESORT THEN

   5543  4 004147   000000 235000 xsym               LDA     X
         4 004150   004167 604400 4                  TMOZ    s:5546
         4 004151   000125 236000 xsym               LDQ     ZI$DIR+85
         4 004152   000043 376000 5                  ANQ     35
         4 004153   000067 116000 5                  CMPQ    55
         4 004154   004167 601000 4                  TNZ     s:5546

     1013     5544    3                   CALL ERROR_MSG(DBU#PASUM2,SC_TBL.NAME(SC_PTR));

   5544  4 004155   000000 236000 xsym               LDQ     SC_PTR
         4 004156   000214 402000 5                  MPY     140
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:174  
         4 004157   000213 036000 5                  ADLQ    139
         4 004160   000223 235000 5                  LDA     147
         4 004161   000054 757000 0                  STAQ    @EIS+3
         4 004162   000054 630400 0                  EPPR0   @EIS+3
         4 004163   000000 631400 5                  EPPR1   0
         4 004164   000000 701000 xent               TSX1    ERROR_MSG
         4 004165   000000 011000                    NOP     0
         4 004166   004246 710000 4                  TRA     s:5557

     1014     5545    3               ELSE
     1015     5546    3                   IF X>0 THEN

   5546  4 004167   000000 115003                    CMPA    0,DU
         4 004170   004217 604400 4                  TMOZ    s:5553

     1016     5547    4                   DO;

     1017     5548    4                       X=SC_TBL.COUNT2(SC_PTR);

   5548  4 004171   000000 236000 xsym               LDQ     SC_PTR
         4 004172   000405 402007                    MPY     261,DL
         4 004173   000000 116003                    CMPQ    0,DU
         4 004174   004176 605000 4                  TPL     s:5548+5
         4 004175   000044 036003                    ADLQ    36,DU
         4 004176   003000 061406                    CSR     bolr='003'O
         4 004177   000006 050022 xsym               BDSC    SC_TBL+6,Q               by=0,bit=5,n=18
         4 004200   000000 000044 xsym               BDSC    X                        by=0,bit=0,n=36

     1018     5549    4                       CALL BIN_CHAR(2,X);

   5549  4 004201   000154 630400 5                  EPPR0   108
         4 004202   000000 631400 5                  EPPR1   0
         4 004203   000000 701000 xent               TSX1    BIN_CHAR
         4 004204   000000 011000                    NOP     0

     1019     5550    4                       CALL ERROR_MSG(DBU#PASUM12,SC_TBL.NAME(SC_PTR));

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:175  
   5550  4 004205   000000 236000 xsym               LDQ     SC_PTR
         4 004206   000214 402000 5                  MPY     140
         4 004207   000213 036000 5                  ADLQ    139
         4 004210   000225 235000 5                  LDA     149
         4 004211   000054 757000 0                  STAQ    @EIS+3
         4 004212   000054 630400 0                  EPPR0   @EIS+3
         4 004213   000000 631400 5                  EPPR1   0
         4 004214   000000 701000 xent               TSX1    ERROR_MSG
         4 004215   000000 011000                    NOP     0

     1020     5551    4                       END;

   5551  4 004216   004246 710000 4                  TRA     s:5557

     1021     5552    3                   ELSE
     1022     5553    3                       IF ZI$DIR.CODE=#RESORT THEN

   5553  4 004217   000125 236000 xsym               LDQ     ZI$DIR+85
         4 004220   000043 376000 5                  ANQ     35
         4 004221   000067 116000 5                  CMPQ    55
         4 004222   004235 601000 4                  TNZ     s:5556

     1023     5554    3                           CALL ERROR_MSG(DBU#PASUM3,SC_TBL.NAME(SC_PTR));

   5554  4 004223   000000 236000 xsym               LDQ     SC_PTR
         4 004224   000214 402000 5                  MPY     140
         4 004225   000213 036000 5                  ADLQ    139
         4 004226   000227 235000 5                  LDA     151
         4 004227   000054 757000 0                  STAQ    @EIS+3
         4 004230   000054 630400 0                  EPPR0   @EIS+3
         4 004231   000000 631400 5                  EPPR1   0
         4 004232   000000 701000 xent               TSX1    ERROR_MSG
         4 004233   000000 011000                    NOP     0
         4 004234   004246 710000 4                  TRA     s:5557

     1024     5555    3                       ELSE
     1025     5556    3                           CALL ERROR_MSG(DBU#PASUM10,SC_TBL.NAME(SC_PTR));
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:176  

   5556  4 004235   000000 236000 xsym               LDQ     SC_PTR
         4 004236   000214 402000 5                  MPY     140
         4 004237   000213 036000 5                  ADLQ    139
         4 004240   000221 235000 5                  LDA     145
         4 004241   000054 757000 0                  STAQ    @EIS+3
         4 004242   000054 630400 0                  EPPR0   @EIS+3
         4 004243   000000 631400 5                  EPPR1   0
         4 004244   000000 701000 xent               TSX1    ERROR_MSG
         4 004245   000000 011000                    NOP     0

     1026     5557    3               END;

   5557  4 004246   000000 054000 xsym               AOS     SC_PTR
         4 004247   000000 236000 xsym               LDQ     SC_PTR
         4 004250   000000 116000 xsym               CMPQ    NO_SETS
         4 004251   004126 604400 4                  TMOZ    s:5540

     1027     5558    2           END;

     1028     5559    1       GOTO RET;

   5559  4 004252   003153 710000 4                  TRA     RET

     1029     5560        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:177  
     1030     5561    1   OPEN_ERR: /* FAIL TO OPEN THE INTERMEDIATE FILE, ABORTING */
     1031     5562    1       CALL ERROR_MSG(DBU#PAERROR2,COMMAND_TEXT);

   5562  4 004253   000231 630400 5     OPEN_ERR     EPPR0   153
         4 004254   000000 631400 5                  EPPR1   0
         4 004255   000000 701000 xent               TSX1    ERROR_MSG
         4 004256   000000 011000                    NOP     0

     1032     5563    1       CALL SYS_FUNC_RELDCB;

   5563  4 004257   000011 631400 5                  EPPR1   9
         4 004260   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         4 004261   000000 011000                    NOP     0

     1033     5564    1       DBKEY_SORT_DCB = 0;

   5564  4 004262   000000 220003                    LDX0    0,DU
         4 004263   000000 740000 xsym               STX0    DBKEY_SORT_DCB

     1034     5565    1       GOTO ALT_ZIU$CMPT_INIT;

   5565  4 004264   004362 710000 4                  TRA     ALT_ZIU$CMPT_INIT

     1035     5566    1   READ_ERR:
     1036     5567    1       MONITOR_ERR=B$TCB$->B$TCB.ALT$->B$EXCFR.ERR;

   5567  4 004265   000000 470400 xsym  READ_ERR     LDP0    B$TCB$
         4 004266   000000 471500                    LDP1    0,,PR0
         4 004267   100102 236100                    LDQ     66,,PR1
         4 004270   000000 756000 xsym               STQ     MSGCODE

     1037     5568    1       DCBSF = DBKEY_SORT_DCB;

   5568  4 004271   000000 220000 xsym               LDX0    DBKEY_SORT_DCB
         4 004272   000000 740000 xsym               STX0    DCBSF

     1038     5569    1       INCL_ERR=%YES#;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:178  

   5569  4 004273   400000 236003                    LDQ     -131072,DU
         4 004274   000000 756000 xsym               STQ     INCL_ERR

     1039     5570    1       CALL SYS_FUNC_ERRMSG;

   5570  4 004275   000011 631400 5                  EPPR1   9
         4 004276   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 004277   000000 011000                    NOP     0

     1040     5571    1       CALL ERROR_MSG(DBU#PAERROR2,COMMAND_TEXT); /* DIRECTIVE ABORTED MSG */

   5571  4 004300   000231 630400 5                  EPPR0   153
         4 004301   000000 631400 5                  EPPR1   0
         4 004302   000000 701000 xent               TSX1    ERROR_MSG
         4 004303   000000 011000                    NOP     0

     1041     5572    1       GOTO ALT_ZIU$CMPT_INIT;

   5572  4 004304   004362 710000 4                  TRA     ALT_ZIU$CMPT_INIT

     1042     5573
     1043     5574    1   NO_RECORD_THERE:
     1044     5575    1       IF BREAK_FLAG>0 THEN GOTO ALT_ZIU$CMPT_INIT;

   5575  4 004305   000000 235000 xsym  NO_RECORD_T* LDA     BREAK_FLAG
         4 004306   004362 605400 4                  TPNZ    ALT_ZIU$CMPT_INIT

     1045     5576    1       CALL BIN_CHAR(1,KEY.CURR);

   5576  4 004307   000233 630400 5                  EPPR0   155
         4 004310   000000 631400 5                  EPPR1   0
         4 004311   000000 701000 xent               TSX1    BIN_CHAR
         4 004312   000000 011000                    NOP     0

     1046     5577    1       IF RC_PTR=SC_TBL.RC_PTR(SC_PTR) THEN /* THE RC IS AN OWNER */

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:179  
   5577  4 004313   000000 236000 xsym               LDQ     SC_PTR
         4 004314   000405 402007                    MPY     261,DL
         4 004315   000000 116003                    CMPQ    0,DU
         4 004316   004320 605000 4                  TPL     s:5577+5
         4 004317   000044 036003                    ADLQ    36,DU
         4 004320   003000 061406                    CSR     bolr='003'O
         4 004321   000005 650011 xsym               BDSC    SC_TBL+5,Q               by=3,bit=5,n=9
         4 004322   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 004323   000054 236000 0                  LDQ     @EIS+3
         4 004324   000000 116000 xsym               CMPQ    RC_PTR
         4 004325   004344 601000 4                  TNZ     s:5584

     1047     5578    2       DO;

     1048     5579    2           CALL BIN_CHAR(2,STK.PRIOR);

   5579  4 004326   000235 630400 5                  EPPR0   157
         4 004327   000000 631400 5                  EPPR1   0
         4 004330   000000 701000 xent               TSX1    BIN_CHAR
         4 004331   000000 011000                    NOP     0

     1049     5580    2           CALL ERROR_MSG(DBU#PAWARN1,SC_TBL.NAME(SC_PTR));

   5580  4 004332   000000 236000 xsym               LDQ     SC_PTR
         4 004333   000214 402000 5                  MPY     140
         4 004334   000213 036000 5                  ADLQ    139
         4 004335   000240 235000 5                  LDA     160
         4 004336   000054 757000 0                  STAQ    @EIS+3
         4 004337   000054 630400 0                  EPPR0   @EIS+3
         4 004340   000000 631400 5                  EPPR1   0
         4 004341   000000 701000 xent               TSX1    ERROR_MSG
         4 004342   000000 011000                    NOP     0

     1050     5581    2           END; /* WE CAN TOLERATE THIS, DONT ABORT IT */

   5581  4 004343   004361 710000 4                  TRA     s:5587

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:180  
     1051     5582    1       ELSE
     1052     5583    2       DO;

     1053     5584    2           CALL BIN_CHAR(2,STK.NEXT);

   5584  4 004344   000241 630400 5                  EPPR0   161
         4 004345   000000 631400 5                  EPPR1   0
         4 004346   000000 701000 xent               TSX1    BIN_CHAR
         4 004347   000000 011000                    NOP     0

     1054     5585    2           CALL ERROR_MSG(DBU#PAWARNM,SC_TBL.NAME(SC_PTR));

   5585  4 004350   000000 236000 xsym               LDQ     SC_PTR
         4 004351   000214 402000 5                  MPY     140
         4 004352   000213 036000 5                  ADLQ    139
         4 004353   000244 235000 5                  LDA     164
         4 004354   000054 757000 0                  STAQ    @EIS+3
         4 004355   000054 630400 0                  EPPR0   @EIS+3
         4 004356   000000 631400 5                  EPPR1   0
         4 004357   000000 701000 xent               TSX1    ERROR_MSG
         4 004360   000000 011000                    NOP     0

     1055     5586    2           END;

     1056     5587    1       GOTO SKIP_THIS_REC;

   5587  4 004361   003736 710000 4                  TRA     SKIP_THIS_REC

     1057     5588
     1058     5589    1   ALT_ZIU$CMPT_INIT: /* DUE TO IO-ERR OR BREAK WAS HIT */
     1059     5590    1       CURR_SCHNM = ' ';

   5590  4 004362   040000 100400       ALT_ZIU$CMP* MLR     fill='040'O
         4 004363   000021 000001 5                  ADSC9   17                       cn=0,n=1
         4 004364   000000 000036 xsym               ADSC9   CURR_SCHNM               cn=0,n=30

     1060     5591    1       ALTRETURN; /* JUST DO A ALTRETURN, PA_ROOT WILL HANDLE REST */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:181  

   5591  4 004365   000000 221200 0                  LDX1  ! 0
         4 004366   000000 702211                    TSX2  ! 0,X1

     1061     5592        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:182  
     1062     5593        /*
     1063     5594              SUBR    REMOVE_PRIOR
     1064     5595                      SHIFT ALL DATAS AFTER THE PRIOR IN PAGE UP BY 1 PTR SIZE
     1065     5596                      AND UPDATE OFFSET ARRAY
     1066     5597        */
     1067     5598    1   REMOVE_PRIOR: PROC ALTRET;

   5598  4 004367   000044 741200 0     REMOVE_PRIOR STX1  ! @TYPE_MSG+3

     1068     5599
     1069     5600    2   DCL 1 NEW_EIS STATIC ALIGNED,
     1070     5601    2         2 * UBIN(3) UNAL,
     1071     5602    2         2 OFST UBIN(17) UNAL,
     1072     5603    2         2 * UBIN(4) UNAL,
     1073     5604    2         2 SIZ UBIN (12) UNAL;
     1074     5605    2   DCL 1 ZERO_V BASED(REC2$) CALIGNED,
     1075     5606    2         2 * CHAR(PTR_LEN) CALIGNED;
     1076     5607    2   DCL Z SBIN STATIC ALIGNED;
     1077     5608    2   DCL 1 REC_FORMAT BASED(REC$) CALIGNED,
     1078     5609    2         2 * UBIN HALF UNAL,
     1079     5610    2         2 SIZ UBIN HALF UNAL;
     1080     5611
     1081     5612    2       NEW_EIS = RC_TBL.REDEF_NEXT(RC_PTR);

   5612  4 004370   000000 236000 xsym               LDQ     RC_PTR
         4 004371   000003 402007                    MPY     3,DL
         4 004372   000000 236006 xsym               LDQ     RC_TBL,QL
         4 004373   000045 756000 0                  STQ     NEW_EIS

     1082     5613    2       PTR_LEN=NEW_EIS.SIZ;

   5613  4 004374   000045 236000 0                  LDQ     NEW_EIS
         4 004375   007777 376007                    ANQ     4095,DL
         4 004376   000000 756000 xsym               STQ     PTR_LEN

     1083     5614    2       NEW_EIS.OFST=NEW_EIS.OFST-RC_TBL.BYTES_SHIFT(RC_PTR);

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:183  
   5614  4 004377   000000 236000 xsym               LDQ     RC_PTR
         4 004400   000003 402007                    MPY     3,DL
         4 004401   000001 236006 xsym               LDQ     RC_TBL+1,QL
         4 004402   000011 772000                    QRL     9
         4 004403   000777 376007                    ANQ     511,DL
         4 004404   000054 756000 0                  STQ     @EIS+3
         4 004405   000045 236000 0                  LDQ     NEW_EIS
         4 004406   000020 772000                    QRL     16
         4 004407   377777 376007                    ANQ     131071,DL
         4 004410   000054 136000 0                  SBLQ    @EIS+3
         4 004411   000020 736000                    QLS     16
         4 004412   000045 676000 0                  ERQ     NEW_EIS
         4 004413   000142 376000 5                  ANQ     98
         4 004414   000045 656000 0                  ERSQ    NEW_EIS

     1084     5615    2       REC2$=PINCRC(REC$,NEW_EIS.OFST+PTR_LEN); /* POINTING PRIOR */

   5615  4 004415   000045 236000 0                  LDQ     NEW_EIS
         4 004416   000020 772000                    QRL     16
         4 004417   377777 376007                    ANQ     131071,DL
         4 004420   000000 036000 xsym               ADLQ    PTR_LEN
         4 004421   000020 736000                    QLS     16
         4 004422   000000 036000 xsym               ADLQ    REC$
         4 004423   000000 756000 xsym               STQ     REC2$

     1085     5616    3       DO Z=0 TO DATA_PG.OFF_LN.SEC; /* CHECK EACH OFFSET ARRAY */

   5616  4 004424   000046 450000 0                  STZ     Z
         4 004425   004453 710000 4                  TRA     s:5619+1

     1086     5617    3           IF DATA_PG.ACT_DATA_18(2035-Z)>X THEN

   5617  4 004426   000046 335000 0                  LCA     Z
         4 004427   000001 735000                    ALS     1
         4 004430   000000 470400 xsym               LDP0    DATA$
         4 004431   000000 100505                    MLR     fill='000'O
         4 004432   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:184  
         4 004433   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 004434   000054 236000 0                  LDQ     @EIS+3
         4 004435   000022 732000                    QRS     18
         4 004436   000000 116000 xsym               CMPQ    X
         4 004437   004452 604400 4                  TMOZ    s:5619

     1087     5618    3               DATA_PG.ACT_DATA_18(2035-Z)=DATA_PG.ACT_DATA_18(2035-Z)-PTR_LEN;

   5618  4 004440   000000 100505                    MLR     fill='000'O
         4 004441   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 004442   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 004443   000054 236000 0                  LDQ     @EIS+3
         4 004444   000022 732000                    QRS     18
         4 004445   000000 136000 xsym               SBLQ    PTR_LEN
         4 004446   000055 756000 0                  STQ     @EIS+4
         4 004447   000105 101400                    MRL     fill='000'O
         4 004450   000055 000004 0                  ADSC9   @EIS+4                   cn=0,n=4
         4 004451   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2

     1088     5619    3           END;

   5619  4 004452   000046 054000 0                  AOS     Z
         4 004453   000000 470400 xsym               LDP0    DATA$
         4 004454   000005 236100                    LDQ     5,,PR0
         4 004455   777777 376007                    ANQ     -1,DL
         4 004456   000046 116000 0                  CMPQ    Z
         4 004457   004426 605000 4                  TPL     s:5617

     1089     5620    2       Z = DATA_PG.PG_SZ.SEC; /* SPACE AVAILABLE ON PAGE */

   5620  4 004460   000003 236100                    LDQ     3,,PR0
         4 004461   777777 376007                    ANQ     -1,DL
         4 004462   000046 756000 0                  STQ     Z

     1090     5621    2       DATA_PG.PG_SZ.SEC = Z+PTR_LEN; /* UPDATE IT */

   5621  4 004463   000000 036000 xsym               ADLQ    PTR_LEN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:185  
         4 004464   000000 620006                    EAX0    0,QL
         4 004465   000003 440100                    SXL0    3,,PR0

     1091     5622    2       Z=4084-PTR_LEN-(Z+DATA_PG.OFF_LN.SEC*2+2);

   5622  4 004466   000005 236100                    LDQ     5,,PR0
         4 004467   000001 736000                    QLS     1
         4 004470   000245 376000 5                  ANQ     165
         4 004471   000046 036000 0                  ADLQ    Z
         4 004472   000000 036000 xsym               ADLQ    PTR_LEN
         4 004473   000070 676000 5                  ERQ     56
         4 004474   007763 036007                    ADLQ    4083,DL
         4 004475   000046 756000 0                  STQ     Z

     1092     5623    2       X = Z-(X+NEW_EIS.OFST+PTR_LEN); /* X=NUMBER OF BYTES TO MOVE */

   5623  4 004476   000045 236000 0                  LDQ     NEW_EIS
         4 004477   000020 772000                    QRL     16
         4 004500   377777 376007                    ANQ     131071,DL
         4 004501   000000 036000 xsym               ADLQ    X
         4 004502   000000 036000 xsym               ADLQ    PTR_LEN
         4 004503   000054 756000 0                  STQ     @EIS+3
         4 004504   000046 236000 0                  LDQ     Z
         4 004505   000054 136000 0                  SBLQ    @EIS+3
         4 004506   000000 756000 xsym               STQ     X

     1093     5624    2       CHAR_V = PINCRC(REC2$,PTR_LEN)->CHAR_V;

   5624  4 004507   000000 471400 xsym               LDP1    REC2$
         4 004510   000000 620006                    EAX0    0,QL
         4 004511   000000 235000 xsym               LDA     PTR_LEN
         4 004512   000000 721000 xsym               LXL1    X
         4 004513   040140 100545                    MLR     fill='040'O
         4 004514   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         4 004515   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1094     5625    2       REC2$ = PINCRC(REC2$,X);
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:186  

   5625  4 004516   000000 236000 xsym               LDQ     X
         4 004517   000020 736000                    QLS     16
         4 004520   000000 036000 xsym               ADLQ    REC2$
         4 004521   000000 756000 xsym               STQ     REC2$

     1095     5626    2       ZERO_V = '0'B; /* ZERO GAP AFTER MOVE */

   5626  4 004522   000000 470400 xsym               LDP0    REC2$
         4 004523   000000 720000 xsym               LXL0    PTR_LEN
         4 004524   000140 100400                    MLR     fill='000'O
         4 004525   000011 000001 5                  ADSC9   9                        cn=0,n=1
         4 004526   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1096     5627    2       REC_FORMAT.SIZ=REC_FORMAT.SIZ-PTR_LEN; /* UPDATE REC SIZE */

   5627  4 004527   000000 470400 xsym               LDP0    REC$
         4 004530   000000 101500                    MRL     fill='000'O
         4 004531   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         4 004532   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 004533   000054 236000 0                  LDQ     @EIS+3
         4 004534   000000 136000 xsym               SBLQ    PTR_LEN
         4 004535   000055 756000 0                  STQ     @EIS+4
         4 004536   000100 101400                    MRL     fill='000'O
         4 004537   000055 000004 0                  ADSC9   @EIS+4                   cn=0,n=4
         4 004540   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2

     1097     5628    2       CALL UPDATE_PTR(STK.NEXT,NEW_EIS);

   5628  4 004541   000246 237000 5                  LDAQ    166
         4 004542   000050 757000 0                  STAQ    Z+2
         4 004543   004743 701000 4                  TSX1    UPDATE_PTR
         4 004544   000000 011000                    NOP     0

     1098     5629    2       ALTRETURN; /* ALWAYS ALTRETUN */

   5629  4 004545   000044 221200 0                  LDX1  ! @TYPE_MSG+3
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:187  
         4 004546   000000 702211                    TSX2  ! 0,X1

     1099     5630        /*
     1100     5631              2ND ENTRY POINT - INSERT PRIOR WHEN REVERT PA TO NON-PA
     1101     5632        */
     1102     5633    2   INSERT_PRIOR: ENTRY ALTRET;

   5633  4 004547   000044 741200 0     INSERT_PRIOR STX1  ! @TYPE_MSG+3

     1103     5634
     1104     5635    2       NEW_EIS = RC_TBL.REDEF_NEXT(RC_PTR); /* VERY MUCH ALIKE ABOVE */

   5635  4 004550   000000 236000 xsym               LDQ     RC_PTR
         4 004551   000003 402007                    MPY     3,DL
         4 004552   000000 236006 xsym               LDQ     RC_TBL,QL
         4 004553   000045 756000 0                  STQ     NEW_EIS

     1105     5636    2       PTR_LEN = NEW_EIS.SIZ;

   5636  4 004554   000045 236000 0                  LDQ     NEW_EIS
         4 004555   007777 376007                    ANQ     4095,DL
         4 004556   000000 756000 xsym               STQ     PTR_LEN

     1106     5637    2       Z = DATA_PG.PG_SZ.SEC; /* SPAVE AVAIL ON PAGE */

   5637  4 004557   000000 470400 xsym               LDP0    DATA$
         4 004560   000003 236100                    LDQ     3,,PR0
         4 004561   777777 376007                    ANQ     -1,DL
         4 004562   000046 756000 0                  STQ     Z

     1107     5638    2       IF Z < PTR_LEN THEN /* NO SUFFICIENT SPACE */

   5638  4 004563   000000 116000 xsym               CMPQ    PTR_LEN
         4 004564   004615 605000 4                  TPL     s:5649

     1108     5639    3       DO;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:188  
     1109     5640    3           IF CURR_PAGE~=LAST_BAD_PAGE THEN

   5640  4 004565   000010 236000 0                  LDQ     CURR_PAGE
         4 004566   000011 116000 0                  CMPQ    LAST_BAD_PAGE
         4 004567   004613 600000 4                  TZE     s:5647

     1110     5641    4           DO;

     1111     5642    4               CURR_PAGE=LAST_BAD_PAGE; /* TYPE 1 MSG FOR EACH BAD PAGE */

   5642  4 004570   000011 235000 0                  LDA     LAST_BAD_PAGE
         4 004571   000010 755000 0                  STA     CURR_PAGE

     1112     5643    4               CALL BIN_CHAR(1,KEY.CURR);

   5643  4 004572   000233 630400 5                  EPPR0   155
         4 004573   000000 631400 5                  EPPR1   0
         4 004574   000000 701000 xent               TSX1    BIN_CHAR
         4 004575   000000 011000                    NOP     0

     1113     5644    4               CALL BIN_CHAR(2,Z);

   5644  4 004576   000250 630400 5                  EPPR0   168
         4 004577   000000 631400 5                  EPPR1   0
         4 004600   000000 701000 xent               TSX1    BIN_CHAR
         4 004601   000000 011000                    NOP     0

     1114     5645    4               CALL ERROR_MSG(DBU#PARVER1,SC_TBL.NAME(SC_PTR));

   5645  4 004602   000000 236000 xsym               LDQ     SC_PTR
         4 004603   000214 402000 5                  MPY     140
         4 004604   000213 036000 5                  ADLQ    139
         4 004605   000253 235000 5                  LDA     171
         4 004606   000054 757000 0                  STAQ    @EIS+3
         4 004607   000054 630400 0                  EPPR0   @EIS+3
         4 004610   000000 631400 5                  EPPR1   0
         4 004611   000000 701000 xent               TSX1    ERROR_MSG
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:189  
         4 004612   000000 011000                    NOP     0

     1115     5646    4               END;

     1116     5647    3           ALTRETURN; /* THIS SET MEMBER IS NOT REVERTED TO NON-PA */

   5647  4 004613   000044 221200 0                  LDX1  ! @TYPE_MSG+3
         4 004614   000000 702211                    TSX2  ! 0,X1

     1117     5648    3           END;
     1118     5649    2       DATA_PG.PG_SZ.SEC = Z - PTR_LEN; /* UPDATE SPACE AVAIL */

   5649  4 004615   000000 136000 xsym               SBLQ    PTR_LEN
         4 004616   000000 620006                    EAX0    0,QL
         4 004617   000003 440100                    SXL0    3,,PR0

     1119     5650    2       REC_FORMAT.SIZ=REC_FORMAT.SIZ+PTR_LEN; /* AND RECORD SIZE */

   5650  4 004620   000000 471400 xsym               LDP1    REC$
         4 004621   000000 101500                    MRL     fill='000'O
         4 004622   100000 400002                    ADSC9   0,,PR1                   cn=2,n=2
         4 004623   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 004624   000054 236000 0                  LDQ     @EIS+3
         4 004625   000000 036000 xsym               ADLQ    PTR_LEN
         4 004626   000055 756000 0                  STQ     @EIS+4
         4 004627   000100 101400                    MRL     fill='000'O
         4 004630   000055 000004 0                  ADSC9   @EIS+4                   cn=0,n=4
         4 004631   100000 400002                    ADSC9   0,,PR1                   cn=2,n=2

     1120     5651    2       Z=4084-(Z+DATA_PG.OFF_LN.SEC*2+2); /* Z = END OF DATAS */

   5651  4 004632   000000 470400 xsym               LDP0    DATA$
         4 004633   000005 236100                    LDQ     5,,PR0
         4 004634   000001 736000                    QLS     1
         4 004635   000245 376000 5                  ANQ     165
         4 004636   000046 036000 0                  ADLQ    Z
         4 004637   000070 676000 5                  ERQ     56
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:190  
         4 004640   007763 036007                    ADLQ    4083,DL
         4 004641   000046 756000 0                  STQ     Z

     1121     5652    3       DO Y=0 TO DATA_PG.OFF_LN.SEC; /* UPDATE OFFSET ARRAY */

   5652  4 004642   000003 450000 0                  STZ     Y
         4 004643   004671 710000 4                  TRA     s:5655+1

     1122     5653    3           IF DATA_PG.ACT_DATA_18(2035-Y)>X THEN

   5653  4 004644   000003 335000 0                  LCA     Y
         4 004645   000001 735000                    ALS     1
         4 004646   000000 470400 xsym               LDP0    DATA$
         4 004647   000000 100505                    MLR     fill='000'O
         4 004650   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 004651   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 004652   000054 236000 0                  LDQ     @EIS+3
         4 004653   000022 732000                    QRS     18
         4 004654   000000 116000 xsym               CMPQ    X
         4 004655   004670 604400 4                  TMOZ    s:5655

     1123     5654    3               DATA_PG.ACT_DATA_18(2035-Y)=DATA_PG.ACT_DATA_18(2035-Y)+PTR_LEN;

   5654  4 004656   000000 100505                    MLR     fill='000'O
         4 004657   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2
         4 004660   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 004661   000054 236000 0                  LDQ     @EIS+3
         4 004662   000022 732000                    QRS     18
         4 004663   000000 036000 xsym               ADLQ    PTR_LEN
         4 004664   000055 756000 0                  STQ     @EIS+4
         4 004665   000105 101400                    MRL     fill='000'O
         4 004666   000055 000004 0                  ADSC9   @EIS+4                   cn=0,n=4
         4 004667   001777 400002                    ADSC9   1023,A,PR0               cn=2,n=2

     1124     5655    3           END;

   5655  4 004670   000003 054000 0                  AOS     Y
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:191  
         4 004671   000000 470400 xsym               LDP0    DATA$
         4 004672   000005 236100                    LDQ     5,,PR0
         4 004673   777777 376007                    ANQ     -1,DL
         4 004674   000003 116000 0                  CMPQ    Y
         4 004675   004644 605000 4                  TPL     s:5653

     1125     5656
     1126     5657    2       X = Z-(X+NEW_EIS.OFST+PTR_LEN); /* X=# BYTES SHIFT DOWN */

   5657  4 004676   000045 236000 0                  LDQ     NEW_EIS
         4 004677   000020 772000                    QRL     16
         4 004700   377777 376007                    ANQ     131071,DL
         4 004701   000000 036000 xsym               ADLQ    X
         4 004702   000000 036000 xsym               ADLQ    PTR_LEN
         4 004703   000054 756000 0                  STQ     @EIS+3
         4 004704   000046 236000 0                  LDQ     Z
         4 004705   000054 136000 0                  SBLQ    @EIS+3
         4 004706   000000 756000 xsym               STQ     X

     1127     5658    2       REC2$=PINCRC(REC$,NEW_EIS.OFST+PTR_LEN); /* NEW PRIR LOC */

   5658  4 004707   000045 236000 0                  LDQ     NEW_EIS
         4 004710   000020 772000                    QRL     16
         4 004711   377777 376007                    ANQ     131071,DL
         4 004712   000000 036000 xsym               ADLQ    PTR_LEN
         4 004713   000020 736000                    QLS     16
         4 004714   000000 036000 xsym               ADLQ    REC$
         4 004715   000000 756000 xsym               STQ     REC2$

     1128     5659    2       CALL SHIFT_ARRAY(CHAR_V,PINCRC(REC2$,PTR_LEN)->CHAR_V,X);

   5659  4 004716   000047 236000 5                  LDQ     39
         4 004717   000056 756000 0                  STQ     @EIS+5
         4 004720   000000 236000 xsym               LDQ     PTR_LEN
         4 004721   000020 736000                    QLS     16
         4 004722   000000 036000 xsym               ADLQ    REC2$
         4 004723   000000 235000 xsym               LDA     REC2$
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:192  
         4 004724   000054 757000 0                  STAQ    @EIS+3
         4 004725   000054 630400 0                  EPPR0   @EIS+3
         4 004726   000012 631400 5                  EPPR1   10
         4 004727   000000 701000 xent               TSX1    SHIFT_ARRAY
         4 004730   000000 011000                    NOP     0

     1129     5660    2       CALL UPDATE_PTR(STK.NEXT,NEW_EIS);

   5660  4 004731   000246 237000 5                  LDAQ    166
         4 004732   000050 757000 0                  STAQ    Z+2
         4 004733   004743 701000 4                  TSX1    UPDATE_PTR
         4 004734   000000 011000                    NOP     0

     1130     5661    2       CALL UPDATE_PTR2(STK.PRIOR); /* INSERT A NEW PRIOR */

   5661  4 004735   000204 236000 5                  LDQ     132
         4 004736   000050 756000 0                  STQ     Z+2
         4 004737   004757 701000 4                  TSX1    UPDATE_PTR2
         4 004740   000000 011000                    NOP     0

     1131     5662    2       ALTRETURN;

   5662  4 004741   000044 221200 0                  LDX1  ! @TYPE_MSG+3
         4 004742   000000 702211                    TSX2  ! 0,X1

     1132     5663        /*E*  ERROR: ZIU-DBU#PARVER1-C
     1133     5664        MESSAGE: Warning: The page that has a member record of set "%U1" at
     1134     5665                          DBK %U2, has only %U3 available bytes left and it
     1135     5666                          is not enough to CONVERT to non-PA format.
     1136     5667                          This problem is to be resolved in the future.
     1137     5668                          At this point, you have to reload the data base and try
     1138     5669                          to delete a record in this page to make room. */
     1139     5670
     1140     5671    2   END REMOVE_PRIOR;
     1141     5672        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:193  
     1142     5673        /*E* ERROR: ZIU-DBU#PAWARN1-C
     1143     5674        MESSAGE:  Warning: No record at DBK# %U2, but it is pointed to by a member
     1144     5675                           of DBK# %U3 through its owner pointer in set "%U1".
     1145     5676                           Run REPAIR package to have it fixed.  */
     1146     5677        /*E*  ERROR: ZIU-DBU#PAWARNM-C
     1147     5678        MESSAGE:  Warning: No record at DBK# %U2, but it is pointed to by a PA_REC
     1148     5679                           at DBK# %U3 through its PA pointer in set "%U1".
     1149     5680                           Run REBUILD PA to reconstruct this set. */
     1150     5681        /*E*  ERROR: ZIU-DBU#PAPER85-C
     1151     5682        MESSAGE:Note: Default 85% compaction is used instead.  */
     1152     5683        /*E*  ERROR: ZIU-DBU#DBERR-C
     1153     5684            MESSAGE: DBSTATUS = %U1.  %U2 aborted. */
     1154     5685        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:194  
     1155     5686        /*
     1156     5687              SUBR   UPDATE_PTR - BY GIVING NEW_PTR AND EIS OF PTR
     1157     5688        */
     1158     5689    1   UPDATE_PTR: PROC(NEW_PTR,EIS);

   5689  4 004743   000047 741200 0     UPDATE_PTR   STX1  ! Z+1

     1159     5690
     1160     5691    2   DCL NEW_PTR UBIN CALIGNED;
     1161     5692    2   DCL 1 EIS ALIGNED,
     1162     5693    2         2 * UBIN(3) UNAL,
     1163     5694    2         2 OFST UBIN(17) UNAL,
     1164     5695    2         2 * UBIN(4) UNAL,
     1165     5696    2         2 SIZE UBIN(12) UNAL;
     1166     5697
     1167     5698    2       REC2$ = PINCRC(REC$,EIS.OFST);

   5698  4 004744   000051 470400 0                  LDP0    @EIS
         4 004745   000000 236100                    LDQ     0,,PR0
         4 004746   000020 772000                    QRL     16
         4 004747   377777 376007                    ANQ     131071,DL
         4 004750   000020 736000                    QLS     16
         4 004751   000000 036000 xsym               ADLQ    REC$
         4 004752   000000 756000 xsym               STQ     REC2$

     1168     5699    2       X = EIS.SIZE;

   5699  4 004753   000000 236100                    LDQ     0,,PR0
         4 004754   007777 376007                    ANQ     4095,DL
         4 004755   000000 756000 xsym               STQ     X
         4 004756   004760 710000 4                  TRA     s:5703

     1169     5700
     1170     5701    2   UPDATE_PTR2: ENTRY(NEW_PTR);

   5701  4 004757   000047 741200 0     UPDATE_PTR2  STX1  ! Z+1

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:195  
     1171     5702
     1172     5703    2       IF SC_TBL.GLOBAL(SC_PTR)=0 THEN /* SET IS LOCAL */

   5703  4 004760   000000 236000 xsym               LDQ     SC_PTR
         4 004761   000405 402007                    MPY     261,DL
         4 004762   000000 116003                    CMPQ    0,DU
         4 004763   004765 605000 4                  TPL     s:5703+5
         4 004764   000044 036003                    ADLQ    36,DU
         4 004765   003000 061406                    CSR     bolr='003'O
         4 004766   000005 640001 xsym               BDSC    SC_TBL+5,Q               by=3,bit=4,n=1
         4 004767   000054 000044 0                  BDSC    @EIS+3                   by=0,bit=0,n=36
         4 004770   000054 236000 0                  LDQ     @EIS+3
         4 004771   000000 116003                    CMPQ    0,DU
         4 004772   005010 601000 4                  TNZ     s:5705

     1173     5704    2           NEW_PTR = NEW_PTR - AC_TBL.BASE_DBK(AC_PTR);

   5704  4 004773   000000 236000 xsym               LDQ     AC_PTR
         4 004774   000014 402007                    MPY     12,DL
         4 004775   000000 620006                    EAX0    0,QL
         4 004776   000050 470400 0                  LDP0    @NEW_PTR
         4 004777   000000 100500                    MLR     fill='000'O
         4 005000   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 005001   000054 000004 0                  ADSC9   @EIS+3                   cn=0,n=4
         4 005002   000054 236000 0                  LDQ     @EIS+3
         4 005003   000000 136010 xsym               SBLQ    AC_TBL,X0
         4 005004   000055 756000 0                  STQ     @EIS+4
         4 005005   000100 100400                    MLR     fill='000'O
         4 005006   000055 000004 0                  ADSC9   @EIS+4                   cn=0,n=4
         4 005007   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1174     5705    2       CHAR_V = PINCRC(ADDR(NEW_PTR),4-X)->CHAR_V;

   5705  4 005010   000000 335000 xsym               LCA     X
         4 005011   000050 470400 0                  LDP0    @NEW_PTR
         4 005012   000000 720000 xsym               LXL0    X
         4 005013   000000 471400 xsym               LDP1    REC2$
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:196  
         4 005014   040140 100545                    MLR     fill='040'O
         4 005015   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0
         4 005016   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1175     5706    2       REC2$ = PINCRC(REC2$,X);

   5706  4 005017   000000 236000 xsym               LDQ     X
         4 005020   000020 736000                    QLS     16
         4 005021   000000 036000 xsym               ADLQ    REC2$
         4 005022   000000 756000 xsym               STQ     REC2$

     1176     5707    2   END UPDATE_PTR;

   5707  4 005023   000047 221200 0                  LDX1  ! Z+1
         4 005024   000001 702211                    TSX2  ! 1,X1

     1177     5708        %EJECT;
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:197  
     1178     5709        /*
     1179     5710              SUBR    GET_A_PAGE -  DO A READ OF A PAGE POINTED BY AC_PTR $ RB
     1180     5711                                    THEN DO A NO-WAIT WRITE POINTED BY CURR_PAGE
     1181     5712              ENTRY   FLUSH PAGE -  DO A WAITED WRITE OF CURR_PAGE
     1182     5713                      CURR_PAGE CONTAINS PAGE# AND AC_PTR
     1183     5714        */
     1184     5715    1   GET_A_PAGE: PROC ALTRET;

   5715  4 005025   000052 741200 0     GET_A_PAGE   STX1  ! @EIS+1

     1185     5716
     1186     5717    2       IF BREAK_FLAG > 0 THEN

   5717  4 005026   000000 235000 xsym               LDA     BREAK_FLAG
         4 005027   005156 605400 4                  TPNZ    ALT

     1187     5718    2           GOTO ALT;
     1188     5719    2       IF CURR_PAGE>0 THEN

   5719  4 005030   000010 236000 0                  LDQ     CURR_PAGE
         4 005031   005035 604400 4                  TMOZ    s:5721

     1189     5720    2           CALL SYS_FUNC_CHECK ALTRET(ALT);

   5720  4 005032   000011 631400 5                  EPPR1   9
         4 005033   000000 701000 xent               TSX1    SYS_FUNC_CHECK
         4 005034   005156 702000 4                  TSX2    ALT

     1190     5721    2       DCBSF = AC_TBL.DCB#(AC_PTR);

   5721  4 005035   000000 236000 xsym               LDQ     AC_PTR
         4 005036   000014 402007                    MPY     12,DL
         4 005037   000013 720006 xsym               LXL0    AC_TBL+11,QL
         4 005040   000377 360003                    ANX0    255,DU
         4 005041   000000 740000 xsym               STX0    DCBSF

     1191     5722    2       CALL READ_DB(BUF_PTR,RB,1) ALTRET(ALT); /* READ PAGE REQUESTED */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:198  

   5722  4 005042   000254 630400 5                  EPPR0   172
         4 005043   000012 631400 5                  EPPR1   10
         4 005044   000000 701000 xent               TSX1    READ_DB
         4 005045   005156 702000 4                  TSX2    ALT

     1192     5723    2       NEW_CURR_PAGE = RB*256+AC_PTR;

   5723  4 005046   000000 236000 xsym               LDQ     RB
         4 005047   000010 736000                    QLS     8
         4 005050   000000 036000 xsym               ADLQ    AC_PTR
         4 005051   000012 756000 0                  STQ     NEW_CURR_PAGE

     1193     5724    2       WAITSF = %NO#; /* DONT WAIT FOR WRITE OPERATION */

   5724  4 005052   000000 450000 xsym               STZ     WAITSF
         4 005053   005055 710000 4                  TRA     s:5728

     1194     5725
     1195     5726    2   FLUSH_PAGE: ENTRY ALTRET;

   5726  4 005054   000052 741200 0     FLUSH_PAGE   STX1  ! @EIS+1

     1196     5727
     1197     5728    2       BUF_PTR = 1 - BUF_PTR; /* LAST PAGE LOC TO WRITE */

   5728  4 005055   000001 235007                    LDA     1,DL
         4 005056   000007 135000 0                  SBLA    BUF_PTR
         4 005057   000007 755000 0                  STA     BUF_PTR

     1198     5729    2       RB = CURR_PAGE/256; /* RB IS THE LAST PAGE TO WRITE */

   5729  4 005060   000010 236000 0                  LDQ     CURR_PAGE
         4 005061   000400 506007                    DIV     256,DL
         4 005062   000000 756000 xsym               STQ     RB

     1199     5730    2       AC_PTR = MOD(CURR_PAGE,256); /* PARSE AC_PTR FROM CURR_PAGE */
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:199  

   5730  4 005063   000010 236000 0                  LDQ     CURR_PAGE
         4 005064   000400 506007                    DIV     256,DL
         4 005065   000000 755000 xsym               STA     AC_PTR

     1200     5731    2       IF CURR_PAGE>0 THEN /* IF NOT FIRST TIME IN */

   5731  4 005066   000010 236000 0                  LDQ     CURR_PAGE
         4 005067   005142 604400 4                  TMOZ    s:5748

     1201     5732    3       DO;

     1202     5733    3           IF AC_TBL.CHECKSUM(AC_PTR) THEN /* CHKSUM THIS PAGE */

   5733  4 005070   000000 236000 xsym               LDQ     AC_PTR
         4 005071   000014 402007                    MPY     12,DL
         4 005072   000013 236006 xsym               LDQ     AC_TBL+11,QL
         4 005073   000400 316007                    CANQ    256,DL
         4 005074   005107 600000 4                  TZE     s:5739

     1203     5734    4           DO;

     1204     5735    4               DATA$=ADDR(I_O_BUF(BUF_PTR)); /* LAST BUFFER ADDRESS */

   5735  4 005075   000007 236000 0                  LDQ     BUF_PTR
         4 005076   000034 736000                    QLS     28
         4 005077   000000 036000 xsym               ADLQ    I_O_BUF$
         4 005100   000000 756000 xsym               STQ     DATA$

     1205     5736    4               CALL CHKSUM;

   5736  4 005101   000011 631400 5                  EPPR1   9
         4 005102   000000 701000 xent               TSX1    CHKSUM
         4 005103   000000 011000                    NOP     0

     1206     5737    4               DATA_PG.CHKSUM_WD=ICHKSUM;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:200  
   5737  4 005104   000000 470400 xsym               LDP0    DATA$
         4 005105   000000 235000 xsym               LDA     ICHKSUM
         4 005106   000002 755100                    STA     2,,PR0

     1207     5738    4               END;

     1208     5739    3           DCBSF = AC_TBL.DCB#(AC_PTR);

   5739  4 005107   000000 236000 xsym               LDQ     AC_PTR
         4 005110   000014 402007                    MPY     12,DL
         4 005111   000013 720006 xsym               LXL0    AC_TBL+11,QL
         4 005112   000377 360003                    ANX0    255,DU
         4 005113   000000 740000 xsym               STX0    DCBSF

     1209     5740    3           FULLSF = %YES#;

   5740  4 005114   400000 236003                    LDQ     -131072,DU
         4 005115   000000 756000 xsym               STQ     FULLSF

     1210     5741    3           KEYSF = %YES#;

   5741  4 005116   000000 756000 xsym               STQ     KEYSF

     1211     5742    3           BUFSF = VECTOR(I_O_BUF(BUF_PTR));

   5742  4 005117   000257 235000 5                  LDA     175
         4 005120   000007 236000 0                  LDQ     BUF_PTR
         4 005121   000034 736000                    QLS     28
         4 005122   000000 036000 xsym               ADLQ    I_O_BUF$
         4 005123   000000 755000 xsym               STA     BUFSF
         4 005124   000001 756000 xsym               STQ     BUFSF+1

     1212     5743    3           BUFLNSF = 4096;

   5743  4 005125   010000 235007                    LDA     4096,DL
         4 005126   000000 755000 xsym               STA     BUFLNSF

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:201  
     1213     5744    3           KEYVSF.IDSKEY = RB;

   5744  4 005127   000000 100400                    MLR     fill='000'O
         4 005130   000000 000004 xsym               ADSC9   RB                       cn=0,n=4
         4 005131   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

     1214     5745    3           AC_TBL.PAGE_WRITTEN(AC_PTR)='1'B; /* MARK AREA UPDATED */

   5745  4 005132   000000 236000 xsym               LDQ     AC_PTR
         4 005133   000014 402007                    MPY     12,DL
         4 005134   000000 621006                    EAX1    0,QL
         4 005135   000200 236003                    LDQ     128,DU
         4 005136   000013 256011 xsym               ORSQ    AC_TBL+11,X1

     1215     5746    3           CALL SYS_FUNC_WRIT ALTRET(ALT);

   5746  4 005137   000011 631400 5                  EPPR1   9
         4 005140   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 005141   005156 702000 4                  TSX2    ALT

     1216     5747    3           END;

     1217     5748    2       DATA$ = ADDR(I_O_BUF(1-BUF_PTR)); /* THE BUF JUST READ A PAGE */

   5748  4 005142   000001 236007                    LDQ     1,DL
         4 005143   000007 136000 0                  SBLQ    BUF_PTR
         4 005144   000034 736000                    QLS     28
         4 005145   000000 036000 xsym               ADLQ    I_O_BUF$
         4 005146   000000 756000 xsym               STQ     DATA$

     1218     5749    2       CURR_PAGE = NEW_CURR_PAGE; /* UPDATE IT TO THE PAGE JUST READ */

   5749  4 005147   000012 235000 0                  LDA     NEW_CURR_PAGE
         4 005150   000010 755000 0                  STA     CURR_PAGE

     1219     5750    2       AC_PTR = MOD(CURR_PAGE,256); /* NEED THIS INFO */

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:202  
   5750  4 005151   000010 236000 0                  LDQ     CURR_PAGE
         4 005152   000400 506007                    DIV     256,DL
         4 005153   000000 755000 xsym               STA     AC_PTR

     1220     5751    2       RETURN;

   5751  4 005154   000052 221200 0                  LDX1  ! @EIS+1
         4 005155   000001 702211                    TSX2  ! 1,X1

     1221     5752    2   ALT: ALTRETURN;

   5752  4 005156   000052 221200 0     ALT          LDX1  ! @EIS+1
         4 005157   000000 702211                    TSX2  ! 0,X1

READ_TEMP
 Sect OctLoc
   0     020   000005 777640   000030 006000   000001 777640   000001 006000    ................
   0     024   000001 777640   000000 006000   000000 177640   000000 006014    ................
   0     030   000000 500000   000000 000000   000000 000000   000000 000000    ................
   0     034   000000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   0     052   ****** ******   ****** ******   ****** ******   ****** ******    ................

FTYPE_TO_CC
 Sect OctLoc
   1     000   022110 320045   533000 00****                                    .H.%....

(unnamed)
 Sect OctLoc
   1     002   060062 061060   060040 040040   104120 043040   123105 124040    02100   DP# SET
   1     006   122040 040040   103117 115120   101103 124040   122105 102125    R   COMPACT REBU
   1     012   111114 104040   103117 116126   137124 117137   120101 040040    ILD CONV_TO_PA
   1     016   103117 116126   137124 117137   103110 101111   116040 040040    CONV_TO_CHAIN
   1     022   122105 123117   122124 040040   104111 040123   117125 122103    RESORT  DI SOURC
   1     026   105137 123103   110105 115101   054124 101122   107105 124137    E_SCHEMA,TARGET_
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:203  
   1     032   123103 110105   115101 040040   123117 125122   103105 137123    SCHEMA  SOURCE_S
   1     036   103110 105115   101040 040040   124101 122107   105124 137123    CHEMA   TARGET_S
   1     042   103110 105115   101040 040040   123117 122124   105104 040040    CHEMA   SORTED
   1     046   156145 167137   104115 103114   145144 137120   101040 040040    new_DMCLed_PA
   1     052   156145 167137   104115 103114   145144 137123   117122 124105    new_DMCLed_SORTE
   1     056   104040 040040   163145 164040   162145 143157   162144 040040    D   set record
   1     062   153145 171040   052120 117111   116124 105122   137120 101124    key *POINTER_PAT
   1     066   103110 137106   111114 105040   103117 116126   105122 124040    CH_FILE CONVERT

(unnamed)
 Sect OctLoc
   5     000   000002 000000   000066 006000   000030 006000   000001 000000    .....6..........
   5     004   000001 006000   000047 006000   000075 006000   000000 006014    .....'...=......
   5     010   000223 006000   000000 000000   000003 000000   000000 000001    ................
   5     014   000011 006000   000011 006000   000013 006000   000000 006003    ................
   5     020   000010 200000   040040 040040   777777 777000   057040 040040    ....    ..../
   5     024   056040 040040   000000 022005   000025 006000   000223 206000    .   ............
   5     030   000065 006000   000023 006000   000061 006000   000035 006000    .5.......1......
   5     034   000000 022003   000034 006000   000013 006000   000000 021710    ................
   5     040   000037 006000   000427 006000   000000 006000   000007 600000    ................
   5     044   000004 400000   000004 600000   000005 400000   000000 006000    ................
   5     050   000062 006000   000063 006000   000063 006000   000021 006000    .2...3...3......
   5     054   777777 777400   000777 777777   000001 777000   777577 777777    ................
   5     060   000000 021731   000060 006000   000000 000002   000052 006000    .....0.......*..
   5     064   000062 006000   000065 006000   000047 006000   000005 200000    .2...5...'......
   5     070   777777 777777   000070 006000   000034 006000   000031 006000    .....8..........
   5     074   000064 006000   000071 006000   000034 006000   777777 577777    .4...9..........
   5     100   777777 377777   000073 006000   000041 006000   000014 006000    .....;...!......
   5     104   000067 006000   003777 600000   000013 006000   000000 006000    .7..............
   5     110   000000 021730   000110 006000   000427 006000   000000 006000    .....H..........
   5     114   000150 006000   000007 006000   777777 400007   000004 000000    .h..............
   5     120   000000 021704   000000 006000   000000 006000   000044 006000    .............$..
   5     124   000120 006000   000000 022004   000015 006000   000020 006000    .P..............
   5     130   000125 006000   000000 000000   000020 006000   000015 006000    .U..............
   5     134   000000 006000   000015 006000   000000 021702   000136 006000    .............^..
   5     140   000000 006000   000427 006000   077777 600000   000013 006000    ........?.......
   5     144   000000 006000   000062 006000   000000 006000   000013 006000    .....2..........
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:204  
   5     150   000000 006000   000000 021773   000151 006000   000000 006000    .........i......
   5     154   000062 006000   000000 006000   000000 021774   000156 006000    .2...........n..
   5     160   000427 006000   000000 006000   000000 021720   000162 006000    .............r..
   5     164   000000 021751   000164 006000   000000 021752   000166 006000    .....t.......v..
   5     170   000000 006000   000000 021772   000171 006000   000000 021757    .........y......
   5     174   000173 006000   000013 006000   000000 006000   000000 021771    .{..............
   5     200   000177 006000   000000 006000   000000 006000   000000 006000    ................
   5     204   000001 006000   000000 021722   000205 006000   000000 021744    ................
   5     210   000207 006000   000000 006000   000000 021745   000000 006000    ................
   5     214   000007 200000   000212 006000   000000 021746   000216 006000    ................
   5     220   000000 021755   000220 006000   000000 021724   000222 006000    ................
   5     224   000000 021760   000224 006000   000000 021725   000226 006000    ................
   5     230   000000 021732   000230 006000   000000 006000   000013 006000    ................
   5     234   000001 206000   000062 006000   000001 006000   000000 021726    .....2..........
   5     240   000237 006000   000062 006000   000000 006000   000000 021770    .....2..........
   5     244   000243 006000   000001 777776   000000 006000   000045 006000    .............%..
   5     250   000062 006000   000046 006000   000000 021777   000252 006000    .2...&..........
   5     254   000007 006000   000000 006000   000013 006000   001777 777640    ................
     1222     5753    2   END GET_A_PAGE;
     1223     5754
     1224     5755    1   END ZIU$CMPT_INIT;

PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:205  
--  Include file information  --

   CP_6_SUBS.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZI_PRSE_SUBS.:ZIC0TOU  is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI_RVA_C.:ZIC0TOU  is referenced.
   ZI_UWA_C.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$CMPT_INIT.

   Procedure ZIU$CMPT_INIT requires 2672 words for executable code.
   Procedure ZIU$CMPT_INIT is declared NOAUTO and requires 48 words of local(STATIC) storage.

    No errors detected in file ZIU$CMPT_INIT.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:206  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:207  
          MINI XREF LISTING

ACSSF
      2295**DCL      5402<<ASSIGN
AC_OVERFLOW
      5294**LABEL    4842--GOTO
AC_PTR
      3013**DCL      5221<<DOINDEX  5222>>IF       5224>>IF       5228>>ASSIGN   5228>>ASSIGN   5294<>CALL
      5395<<ASSIGN   5436>>DOWHILE  5436>>DOWHILE  5437<<ASSIGN   5437>>ASSIGN   5441>>IF       5443>>ASSIGN
      5443>>ASSIGN   5443>>ASSIGN   5446>>ASSIGN   5446>>ASSIGN   5447>>IF       5449>>IF       5704>>ASSIGN
      5721>>ASSIGN   5723>>ASSIGN   5730<<ASSIGN   5733>>IF       5739>>ASSIGN   5745>>ASSIGN   5750<<ASSIGN
AC_TBL.BASE_DBK
      3018**DCL      4660>>ASSIGN   4661>>ASSIGN   4847<<ASSIGN   5436>>DOWHILE  5443>>ASSIGN   5446>>ASSIGN
      5704>>ASSIGN
AC_TBL.CHECKSUM
      3027**DCL      4855<<ASSIGN   5733>>IF
AC_TBL.DCB#
      3028**DCL      4845<<ASSIGN   5441>>IF       5721>>ASSIGN   5739>>ASSIGN
AC_TBL.LNLP
      3026**DCL      4850<<ASSIGN   4852>>IF       4853<<ASSIGN
AC_TBL.LPP
      3023**DCL      4660>>ASSIGN   4660>>ASSIGN   4661>>ASSIGN   4661>>ASSIGN   4846<<ASSIGN   5443>>ASSIGN
      5443>>ASSIGN   5446>>ASSIGN
AC_TBL.NAME
      3022**DCL      4656>>DOWHILE  4844<<ASSIGN
AC_TBL.NUM_DBPG
      3021**DCL      5447>>IF
AC_TBL.PAGE_WRITTEN
      3024**DCL      4854<<ASSIGN   5745<<ASSIGN
AC_TBL.RANGE_HIGH
      3020**DCL      4669>>IF       4670<<ASSIGN   4849<<ASSIGN   5222>>IF       5224>>IF       5228>>ASSIGN
AC_TBL.RANGE_LOW
      3019**DCL      4667>>IF       4668<<ASSIGN   4848<<ASSIGN   5228>>ASSIGN
ALT IN PROCEDURE GET_A_PAGE
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:208  
      5752**LABEL    5718--GOTO     5720--CALLALT  5722--CALLALT  5746--CALLALT
ALT IN PROCEDURE OPEN_SCHEMA
      4718**LABEL    4686--CALLALT  4690--CALLALT  4691--CALLALT  4707--CALLALT  4708--GOTO
ALT_RDY IN PROCEDURE OPEN_SCHEMA
      4717**LABEL    4714--CALLALT
ALT_ZIU$CMPT_INIT
      5590**LABEL    4802--CALLALT  4804--CALLALT  4811--CALLALT  4813--CALLALT  4820--CALLALT  4822--CALLALT
      4826--CALLALT  4828--CALLALT  5223--CALLALT  5442--CALLALT  5471--CALLALT  5472--CALLALT  5565--GOTO
      5572--GOTO     5575--GOTO
AREA_KEY$
      2927**DCL      2930--IMP-PTR
ASNSF
      2298**DCL      5401<<ASSIGN
ATBLK$
      3332**DCL      3333--IMP-PTR  4692<<ASSIGN   4694>>ASSIGN
ATBLK_PG.AREA_NM
      3358**DCL      3359--REDEF    4694>>ASSIGN
ATBLK_PG.STATUS
      3367**DCL      3375--REDEF
B$EXCFR.ASL
      3112**DCL      3112--REDEF
B$EXCFR.ERR
      3126**DCL      5567>>ASSIGN
B$EXCFR.ERR.ERR#
      3126**DCL      3126--REDEF
B$EXCFR.EVID
      3125**DCL      3125--REDEF    3126--REDEF
B$EXCFR.IR
      3113**DCL      3113--REDEF
B$EXCFR.PREVSZ
      3112**DCL      3112--REDEF
B$EXCFR.SUBC
      3124**DCL      3124--REDEF    3125--REDEF    3125--REDEF
B$TCB.ALT$
      3130**DCL      5567>>ASSIGN
B$TCB$
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:209  
      2405**DCL      5567>>ASSIGN
BIN_CHAR
        18**DCL-ENT  5062--CALL     5231--CALL     5232--CALL     5233--CALL     5294--CALL     5309--CALL
      5390--CALL     5524--CALL     5527--CALL     5529--CALL     5542--CALL     5549--CALL     5576--CALL
      5579--CALL     5584--CALL     5643--CALL     5644--CALL
BREAK_FLAG
      2415**DCL      5177>>IF       5218>>IF       5522>>IF       5541>>IF       5575>>IF       5717>>IF
BUFLNSF
      2306**DCL      5743<<ASSIGN
BUFSF
      2307**DCL      5742<<ASSIGN
BUF_PTR
        59**DCL        60--REDEF    5396<<ASSIGN   5722<>CALL     5728<<ASSIGN   5728>>ASSIGN   5735>>ASSIGN
      5742>>ASSIGN   5748>>ASSIGN
CAN_RVA.ACRA
      1783**DCL      4652<>CALL
CAN_RVA.ACREC
      1933**DCL      4835<>CALL     4837<>CALL     4856<>CALL
CAN_RVA.ADREC
      1927**DCL      4755<>CALL     4757<>CALL     4761<>CALL
CAN_RVA.CFREC
      1957**DCL      5028<>CALL     5032<>CALL     5072<>CALL     5112<>CALL     5114<>CALL     5127<>CALL
CAN_RVA.FRCFS
      1816**DCL      5033<>CALL     5115<>CALL
CAN_RVA.FRREC
      1945**DCL      5034<>CALL     5116<>CALL
CAN_RVA.NULL
      2092**DCL      5132<>CALL
CAN_RVA.OAAC
      1831**DCL      4835<>CALL     4856<>CALL
CAN_RVA.OAREC
      1930**DCL      4834<>CALL
CAN_RVA.OASC
      1837**DCL      4726<>CALL     4736<>CALL
CAN_RVA.RAREC
      1942**DCL      4649<>CALL     4651<>CALL     4671<>CALL
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:210  
CAN_RVA.RCRA
      1852**DCL      4649<>CALL     4671<>CALL
CAN_RVA.RCREC
      1936**DCL      4927<>CALL     4984<>CALL     5089<>CALL
CAN_RVA.RCSOSM
      1855**DCL      4926<>CALL     4983<>CALL     5088<>CALL
CAN_RVA.SCREC
      1939**DCL      4726<>CALL     4728<>CALL     4736<>CALL     4884<>CALL     4885<>CALL
CAN_RVA.SCSOSM
      1864**DCL      4924<>CALL     4979<>CALL     5080<>CALL     5081<>CALL
CAN_RVA.SFAD
      1867**DCL      4755<>CALL     4761<>CALL
CAN_RVA.SFREC
      1906**DCL      4878<>CALL
CAN_RVA.SMREC
      1951**DCL      4979<>CALL     4982<>CALL     5080<>CALL     5081<>CALL
CAN_RVA.SMSSCF
      1879**DCL      5028<>CALL     5072<>CALL     5112<>CALL     5127<>CALL
CAN_RVA.SNREC
      1963**DCL      4654<>CALL     4732<>CALL     4840<>CALL     4879<>CALL     4882<>CALL     5061<>CALL
      5133<>CALL
CAN_RVA.SNSE
      1897**DCL      4653<>CALL     4731<>CALL     4839<>CALL     4884<>CALL     5060<>CALL
CAN_RVA.SOREC
      1948**DCL      4924<>CALL     4925<>CALL
CHAR_V
        64**DCL      4704>>CALLBLT  5624<<ASSIGN   5624>>ASSIGN   5659<>CALL     5659<>CALL     5705<<ASSIGN
      5705>>ASSIGN
CHKSUM
        19**DCL-ENT  5736--CALL
CHK_DMCL
      4753**PROC     4815--CALL     4825--CALL
CLOSE_SCHEMA
      5289**LABEL    4815--CALLALT  4825--CALLALT  5161--GOTO     5175--GOTO
COMMAND_TEXT
        36**DCL      4766<>CALL     4775<<ASSIGN   4778<<ASSIGN   4781<<ASSIGN   4784<<ASSIGN   4786<<ASSIGN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:211  
      4788>>IF       4903>>IF       4907>>IF       5063<>CALL     5287<>CALL     5295<>CALL     5310<>CALL
      5353<>CALL     5391<>CALL     5513>>IF       5514<<ASSIGN   5518<>CALL     5562<>CALL     5571<>CALL
COUNTSF
      2357**DCL      2358--REDEF
CURR_PAGE
        61**DCL      5393<<ASSIGN   5449>>IF       5640>>IF       5642<<ASSIGN   5719>>IF       5729>>ASSIGN
      5730>>ASSIGN   5731>>IF       5749<<ASSIGN   5750>>ASSIGN
CURR_SCHNM
        67**DCL      4710>>IF       4713<<ASSIGN   4800<<ASSIGN   5145<>CALL     5156<>CALL     5174<>CALL
      5590<<ASSIGN
DATA$
      3388**DCL      3389--IMP-PTR  5451>>ASSIGN   5452>>IF       5457>>ASSIGN   5616>>DOINDEX  5617>>IF
      5618>>ASSIGN   5618>>ASSIGN   5620>>ASSIGN   5621>>ASSIGN   5622>>ASSIGN   5637>>ASSIGN   5649>>ASSIGN
      5651>>ASSIGN   5652>>DOINDEX  5653>>IF       5654>>ASSIGN   5654>>ASSIGN   5735<<ASSIGN   5737>>ASSIGN
      5748<<ASSIGN
DATA_PG.ACT_DATA
      3401**DCL      3402--REDEF    3403--REDEF    3404--REDEF
DATA_PG.ACT_DATA_18
      3402**DCL      5451>>ASSIGN   5617>>IF       5618<<ASSIGN   5618>>ASSIGN   5653>>IF       5654<<ASSIGN
      5654>>ASSIGN
DATA_PG.CHKSUM_WD
      3393**DCL      5737<<ASSIGN
DATA_PG.OFF_LN.SEC
      3400**DCL      5452>>IF       5616>>DOINDEX  5622>>ASSIGN   5651>>ASSIGN   5652>>DOINDEX
DATA_PG.PG_SZ.SEC
      3396**DCL      5620>>ASSIGN   5621<<ASSIGN   5637>>ASSIGN   5649<<ASSIGN
DBKEY_SORT_DCB
        43**DCL      5392>>ASSIGN   5399>>ASSIGN   5564<<ASSIGN   5568>>ASSIGN
DB_ALT
      5286**LABEL    4810--CALLALT  4823--CALLALT  4834--CALLALT  4835--CALLALT  4837--CALLALT  4839--CALLALT
      4840--CALLALT  4856--CALLALT  4878--CALLALT  4879--CALLALT  4882--CALLALT  4884--CALLALT  4885--CALLALT
      4924--CALLALT  4925--CALLALT  4926--CALLALT  4927--CALLALT  4966--CALLALT  4979--CALLALT  4982--CALLALT
      4983--CALLALT  4984--CALLALT  5007--CALLALT  5019--CALLALT  5028--CALLALT  5032--CALLALT  5033--CALLALT
      5034--CALLALT  5060--CALLALT  5061--CALLALT  5072--CALLALT  5080--CALLALT  5081--CALLALT  5088--CALLALT
      5089--CALLALT  5109--CALLALT  5112--CALLALT  5114--CALLALT  5115--CALLALT  5116--CALLALT  5127--CALLALT
      5132--CALLALT  5133--CALLALT  5216--CALLALT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:212  
DB_ALT IN PROCEDURE CHK_DMCL
      4765**LABEL    4755--CALLALT  4757--CALLALT  4761--CALLALT
DB_ALT IN PROCEDURE GET_ALL_SC
      4739**LABEL    4726--CALLALT  4728--CALLALT  4731--CALLALT  4732--CALLALT  4736--CALLALT
DB_ALT IN PROCEDURE SETUP_RA_RANGES
      4674**LABEL    4649--CALLALT  4651--CALLALT  4652--CALLALT  4653--CALLALT  4654--CALLALT  4671--CALLALT
DB_FUNC_FDR
      4623**DCL-ENT  4834--CALL     4878--CALL     5132--CALL
DB_FUNC_FIN
      4628**DCL-ENT  4792--CALL     4811--CALL     4820--CALL     4826--CALL     5216--CALL     5290--CALL
DB_FUNC_FOR
      4624**DCL-ENT  4652--CALL     4653--CALL     4731--CALL     4839--CALL     4926--CALL     4983--CALL
      5033--CALL     5060--CALL     5088--CALL     5115--CALL
DB_FUNC_FRA
      4627**DCL-ENT  4879--CALL     5133--CALL
DB_FUNC_FRS
      4626**DCL-ENT  4649--CALL     4671--CALL     4726--CALL     4736--CALL     4755--CALL     4761--CALL
      4835--CALL     4856--CALL     4884--CALL     4924--CALL     4979--CALL     5028--CALL     5072--CALL
      5080--CALL     5081--CALL     5112--CALL     5127--CALL
DB_FUNC_GET
      4625**DCL-ENT  4651--CALL     4654--CALL     4728--CALL     4732--CALL     4757--CALL     4837--CALL
      4840--CALL     4882--CALL     4885--CALL     4925--CALL     4927--CALL     4982--CALL     4984--CALL
      5032--CALL     5034--CALL     5061--CALL     5089--CALL     5114--CALL     5116--CALL
DCBSF
      2286**DCL      4695--ASSIGN   4696--CALLBLT  4697--ASSIGN   4701--CALLBLT  4704--CALLBLT  5399<<ASSIGN
      5568<<ASSIGN   5721<<ASSIGN   5739<<ASSIGN
DIR_REF
        60**DCL      4880<<ASSIGN   5132<>CALL     5134<<ASSIGN
DMCL_TSTAMP
        65**DCL      4758>>IF       4763<>CALL     4805<<ASSIGN
EIS IN PROCEDURE UPDATE_PTR
      5692**DCL      5689--PROC
EIS.OFST IN PROCEDURE UPDATE_PTR
      5694**DCL      5698>>ASSIGN
EIS.SIZE IN PROCEDURE UPDATE_PTR
      5696**DCL      5699>>ASSIGN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:213  
ENCRP_SEEDSF
      2315**DCL      2316--REDEF
ERRCODESF
      2317**DCL      2322--REDEF
ERRCODESF.ERR#
      2320**DCL      5140<<ASSIGN   5160>>IF
ERROR_MSG
        15**DCL-ENT  4712--CALL     4763--CALL     4766--CALL     4876--CALL     5063--CALL     5145--CALL
      5149--CALL     5153--CALL     5156--CALL     5174--CALL     5247--CALL     5287--CALL     5295--CALL
      5310--CALL     5347--CALL     5350--CALL     5353--CALL     5359--CALL     5363--CALL     5391--CALL
      5516--CALL     5518--CALL     5531--CALL     5534--CALL     5536--CALL     5544--CALL     5550--CALL
      5554--CALL     5556--CALL     5562--CALL     5571--CALL     5580--CALL     5585--CALL     5645--CALL
F$DCB.ACCT#
      3149**DCL      4704>>CALLBLT
F$DCB.ACTPOS
      3165**DCL      3165--REDEF
F$DCB.ARS#
      3139**DCL      3139--REDEF
F$DCB.ATTR
      3158**DCL      3159--REDEF
F$DCB.BORROW
      3173**DCL      3173--REDEF    3173--REDEF    3173--REDEF
F$DCB.DCBNAME.L
      3187**DCL      3187--IMP-SIZ
F$DCB.EOMCHAR#
      3143**DCL      3143--REDEF
F$DCB.FLDID
      3168**DCL      3168--REDEF
F$DCB.FORM$
      3162**DCL      3162--REDEF
F$DCB.FSECT
      3178**DCL      3178--REDEF
F$DCB.FSN#
      3155**DCL      3155--REDEF    3155--REDEF    3156--REDEF
F$DCB.HEADER$
      3161**DCL      3161--REDEF
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:214  
F$DCB.IXTNSIZE#
      3159**DCL      3159--REDEF
F$DCB.LASTSTA$
      3148**DCL      3148--REDEF
F$DCB.LVL
      3174**DCL      3174--REDEF
F$DCB.NAME#.C
      3149**DCL      3149--REDEF    4695--ASSIGN   4696>>CALLBLT
F$DCB.NOEOF
      3171**DCL      3171--REDEF
F$DCB.NRECS#
      3160**DCL      3160--REDEF
F$DCB.NRECX
      3179**DCL      3179--REDEF
F$DCB.OHDR
      3171**DCL      3171--REDEF
F$DCB.ORG#
      3154**DCL      3154--REDEF
F$DCB.PRECNO
      3177**DCL      3177--REDEF
F$DCB.PSN#
      3149**DCL      4697>>ASSIGN   4701--CALLBLT
F$DCB.RCSZ
      3183**DCL      3183--REDEF
F$DCB.RES#
      3150**DCL      3150--REDEF
F$DCB.SETX
      3162**DCL      3162--REDEF
F$DCB.TAB$
      3162**DCL      3162--REDEF
F$DCB.TDA
      3176**DCL      3177--REDEF
F$DCB.WSN#
      3150**DCL      3150--REDEF
FIDSF
      2334**DCL      5400<<ASSIGN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:215  
FIDSF_RD
      2333**DCL      2334--REDEF
FLUSH_PAGE IN PROCEDURE GET_A_PAGE
      5726**ENTRY    5472--CALL
FREE_DYN_MEM
        17**DCL-ENT  4796--CALL     5214--CALL
FTYPE_TO_CC
        54**DCL      5067>>ASSIGN   5122>>ASSIGN
FULLSF
      2304**DCL      5740<<ASSIGN
FUNSF
      2297**DCL      4687<<ASSIGN   5403<<ASSIGN
GET_ALL_SC
      4724**PROC     4810--CALL     4823--CALL
GET_A_PAGE
      5715**PROC     5450--CALL
GET_DCB
        22**DCL-ENT  4686--CALL
HELPCODE
      2351**DCL      2356--REDEF
ICHKSUM
      2416**DCL      2417--REDEF    5737>>ASSIGN
INCL_ERR
      2329**DCL      5569<<ASSIGN
INSERT_PRIOR IN PROCEDURE REMOVE_PRIOR
      5633**ENTRY    5460--CALL
I_O_BUF
      2395**DCL      4692--ASSIGN   5735--ASSIGN   5742--ASSIGN   5748--ASSIGN
I_O_BUF$
      2394**DCL      2395--IMP-PTR  4692>>ASSIGN   5735>>ASSIGN   5742>>ASSIGN   5748>>ASSIGN
KEY
        47**DCL      3206--DCLINIT  3207--DCLINIT
KEY.CURR
        49**DCL      5436>>DOWHILE  5443>>ASSIGN   5446>>ASSIGN   5576<>CALL     5643<>CALL
KEY.RC_PTR
        50**DCL      5439>>ASSIGN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:216  
KEYSF
      2288**DCL      5741<<ASSIGN
KEYVSF
      2289**DCL      2294--REDEF
KEYVSF.IDSKEY
      2292**DCL      5744<<ASSIGN
KEYVSF.WD_ONE
      2291**DCL      2292--REDEF
KEY_OVERFLOW
      5306**LABEL    5071--GOTO     5120--GOTO
KEY_PTR
      3003**DCL      4869<<ASSIGN   5008<<ASSIGN   5008>>ASSIGN   5009>>ASSIGN   5013>>ASSIGN   5037<<ASSIGN
      5037>>ASSIGN   5038>>ASSIGN   5041<<ASSIGN   5041>>ASSIGN   5042>>ASSIGN   5043>>ASSIGN   5053>>ASSIGN
      5055>>ASSIGN   5057>>ASSIGN   5067>>ASSIGN   5068>>ASSIGN   5070>>IF       5103>>ASSIGN   5118<<ASSIGN
      5118>>ASSIGN   5119>>IF       5121>>ASSIGN   5122>>ASSIGN   5123>>ASSIGN   5125>>ASSIGN   5126>>ASSIGN
      5306>>ASSIGN
KEY_TBL.EIS
      3005**DCL      3006--REDEF    5009<<ASSIGN   5038<<ASSIGN   5042<<ASSIGN   5121<<ASSIGN
KEY_TBL.EIS_REDEF.CC
      3008**DCL      5067<<ASSIGN   5122<<ASSIGN
KEY_TBL.EIS_REDEF.DESCEND
      3009**DCL      5068<<ASSIGN   5126<<ASSIGN
KEY_TBL.EIS_REDEF.OFST
      3010**DCL      5043<<ASSIGN   5123>>ASSIGN   5125<<ASSIGN   5203<<ASSIGN   5203>>ASSIGN
KEY_TBL.EIS_REDEF.SIZE
      3012**DCL      5053>>ASSIGN   5055>>ASSIGN   5057>>ASSIGN
LAST_BAD_PAGE
        62**DCL      5394<<ASSIGN   5640>>IF       5642>>ASSIGN
M$READ
      3040**DCL-ENT  5435--CALL
MAX_KEY_SIZE
        37**DCL      4866<<ASSIGN   5074>>IF       5075<<ASSIGN   5095>>IF       5096<<ASSIGN
MONITOR_ERR
      2324**DCL      5567<<ASSIGN
MSGCODE
      2323**DCL      2324--REDEF
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:217  
MSTR$
      2896**DCL      2899--IMP-PTR
MSTR_REF.NXTHSH
      2902**DCL      2903--REDEF
MSTR_REF.PAENT
      2908**DCL      2909--REDEF
MSTR_REF.PAOFF
      2905**DCL      2906--REDEF
NEW_CURR_PAGE
        63**DCL      5723<<ASSIGN   5749>>ASSIGN
NEW_EIS IN PROCEDURE REMOVE_PRIOR
      5600**DCL      5612<<ASSIGN   5628<>CALL     5635<<ASSIGN   5660<>CALL
NEW_EIS.OFST IN PROCEDURE REMOVE_PRIOR
      5602**DCL      5614<<ASSIGN   5614>>ASSIGN   5615>>ASSIGN   5623>>ASSIGN   5657>>ASSIGN   5658>>ASSIGN
NEW_EIS.SIZ IN PROCEDURE REMOVE_PRIOR
      5604**DCL      5613>>ASSIGN   5636>>ASSIGN
NEW_PTR IN PROCEDURE UPDATE_PTR
      5691**DCL      5689--PROC     5701--ENTRY    5704<<ASSIGN   5704>>ASSIGN   5705--ASSIGN
NEXT_SC
      5132**LABEL    4883--GOTO     4904--GOTO
NEXT_SM
      5079**LABEL    5002--GOTO     5011--GOTO
NOT_IDS
      4856**LABEL    4838--GOTO
NO_AREAS
      2938**DCL      4773<<ASSIGN   4841>>IF       4843<<ASSIGN   4843>>ASSIGN   4844>>ASSIGN   4845>>ASSIGN
      4846>>ASSIGN   4847>>ASSIGN   4848>>ASSIGN   4849>>ASSIGN   4850>>ASSIGN   4852>>IF       4853>>ASSIGN
      4854>>ASSIGN   4855>>ASSIGN   5221>>DOINDEX  5436>>DOWHILE
NO_RECORD_THERE
      5575**LABEL    5448--GOTO     5453--GOTO
NO_SETS
      2959**DCL      5179<<ASSIGN   5231>>CALL     5356>>DOINDEX  5415>>DOINDEX  5521>>DOINDEX  5539>>DOINDEX
OPEN_AREA
        20**DCL-ENT  5223--CALL     5442--CALL
OPEN_ERR
      5562**LABEL    5405--CALLALT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:218  
OPEN_SCHEMA
      4682**PROC     4804--CALL     4813--CALL     4822--CALL     4828--CALL
OVER_FLOW
      5309**LABEL    5300--GOTO     5304--GOTO
PA_REC_RANGES IN PROCEDURE SETUP_RA_RANGES
      4647**DCL      4645--PROC     4662--IF
PSN
        57**DCL      4697<<ASSIGN   4698>>CALLBLT  4701<<CALLBLT  4704--CALLBLT
PSN_V
        58**DCL      4701>>CALLBLT  4704>>CALLBLT
PTR_LEN
        42**DCL      5606--IMP-SIZ  5613<<ASSIGN   5615>>ASSIGN   5618>>ASSIGN   5621>>ASSIGN   5622>>ASSIGN
      5623>>ASSIGN   5624>>ASSIGN   5626>>ASSIGN   5627>>ASSIGN   5636<<ASSIGN   5638>>IF       5649>>ASSIGN
      5650>>ASSIGN   5654>>ASSIGN   5657>>ASSIGN   5658>>ASSIGN   5659>>CALL
RB
      2376**DCL      4660<<ASSIGN   4664<<ASSIGN   4667>>IF       4668>>ASSIGN   5190<<ASSIGN   5192>>ASSIGN
      5193>>ASSIGN   5194<<ASSIGN   5194>>ASSIGN   5203>>ASSIGN   5219<<ASSIGN   5228<<ASSIGN   5228>>ASSIGN
      5232<>CALL     5443<<ASSIGN   5446>>ASSIGN   5447>>IF       5449>>IF       5722<>CALL     5723>>ASSIGN
      5729<<ASSIGN   5744>>ASSIGN
RBUF
        34**DCL      4704<<CALLBLT  4709<<CALLBLT  4801<<ASSIGN
RCNT
      2382**DCL      4733<<ASSIGN   4733>>ASSIGN   4734>>ASSIGN   4887>>ASSIGN   4894>>IF       4897>>DOINDEX
      4901>>ASSIGN   4910>>IF       5141>>DOINDEX
RC_OVERFLOW
      5302**LABEL    4930--GOTO     4987--GOTO
RC_PTR
      2986**DCL      4868<<ASSIGN   4928<<ASSIGN   4928>>ASSIGN   4929>>IF       4931>>ASSIGN   4933>>ASSIGN
      4934>>ASSIGN   4935>>ASSIGN   4936>>ASSIGN   4965>>ASSIGN   4974>>ASSIGN   4985<<ASSIGN   4985>>ASSIGN
      4986>>IF       4988>>ASSIGN   4989>>ASSIGN   4990>>ASSIGN   4992>>ASSIGN   4994>>ASSIGN   4996>>ASSIGN
      4998>>ASSIGN   4999>>ASSIGN   5009>>ASSIGN   5013>>ASSIGN   5018>>ASSIGN   5026>>ASSIGN   5077>>ASSIGN
      5302>>ASSIGN   5416<<ASSIGN   5419>>ASSIGN   5420>>ASSIGN   5420>>ASSIGN   5424<<ASSIGN   5424>>ASSIGN
      5439<<ASSIGN   5440>>ASSIGN   5458>>IF       5464>>CALL     5465>>IF       5577>>IF       5612>>ASSIGN
      5614>>ASSIGN   5635>>ASSIGN
RC_TBL.BYTES_SHIFT
      2994**DCL      5193<<ASSIGN   5614>>ASSIGN
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:219  
RC_TBL.DUPIND
      2998**DCL      4996<<ASSIGN   4998<<ASSIGN
RC_TBL.KEY_PTR
      3001**DCL      5013<<ASSIGN   5200>>ASSIGN
RC_TBL.MANUAL
      2999**DCL      4992<<ASSIGN   4994<<ASSIGN
RC_TBL.NO_OF_KEYS
      3000**DCL      5077<<ASSIGN   5201>>ASSIGN
RC_TBL.NXPNT_EIS
      2988**DCL      2989--REDEF    4933<<ASSIGN   4990<<ASSIGN   5464<>CALL
RC_TBL.RC_NEXT
      2996**DCL      4936<<ASSIGN   4970>>IF       4971>>ASSIGN   4974<<ASSIGN   4988<<ASSIGN   5024>>ASSIGN
      5026<<ASSIGN   5195>>ASSIGN   5207>>ASSIGN
RC_TBL.REDEF_NEXT
      2989**DCL      5612>>ASSIGN   5635>>ASSIGN
RC_TBL.REDEF_NEXT.OFST
      2991**DCL      5192<<ASSIGN   5192>>ASSIGN   5420<<ASSIGN   5420>>ASSIGN
RC_TBL.SC_PTR
      2997**DCL      4934<<ASSIGN   4999<<ASSIGN   5194>>ASSIGN   5440>>ASSIGN
RC_TBL.TYPE
      2993**DCL      4935<<ASSIGN   4989<<ASSIGN   5419>>ASSIGN
RE
      2377**DCL      4661<<ASSIGN   4665<<ASSIGN   4669>>IF       4670>>ASSIGN   5200<<ASSIGN   5203>>ASSIGN
      5203>>ASSIGN   5204<<ASSIGN   5204>>ASSIGN   5220<<ASSIGN   5227<<ASSIGN   5227>>ASSIGN   5233<>CALL
      5446<<ASSIGN   5451>>ASSIGN   5452>>IF
READ_DB
        21**DCL-ENT  4691--CALL     5722--CALL
READ_ERR
      5567**LABEL    5435--CALLALT
READ_SW
        35**DCL      4708>>IF
READ_TEMP
      3206**DCL      5435<>CALL
READ_TEMP.STATION_
      3209**DCL      3210--REDEF
READ_TEMP.V
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:220  
      3210**DCL      3206--DCLINIT
READ_TEMP.V.DCB#
      3210**DCL      5392<<ASSIGN
READ_TEMP.V.DVBYTE.REREAD#
      3221**DCL      3221--REDEF
READ_TEMP.V.INDX#
      3219**DCL      3219--REDEF
REASGNSF
      2341**DCL      4689<<ASSIGN   5404<<ASSIGN
REC$
      2375**DCL      2398--IMP-PTR  5457<<ASSIGN   5608--IMP-PTR  5615>>ASSIGN   5627>>ASSIGN   5627>>ASSIGN
      5650>>ASSIGN   5650>>ASSIGN   5658>>ASSIGN   5698>>ASSIGN
REC2$
        40**DCL        64--IMP-PTR  4695<<ASSIGN   4704>>CALLBLT  5605--IMP-PTR  5615<<ASSIGN   5624>>ASSIGN
      5624>>ASSIGN   5625<<ASSIGN   5625>>ASSIGN   5626>>ASSIGN   5658<<ASSIGN   5659>>CALL     5659>>CALL
      5698<<ASSIGN   5705>>ASSIGN   5706<<ASSIGN   5706>>ASSIGN
RECORD_LIST.NAME
      2697**DCL      4734<<ASSIGN   4898>>IF       4902<<ASSIGN   5142>>IF       5145<>CALL     5149<>CALL
      5153<>CALL     5156<>CALL
REC_CNT
        41**DCL      5201<<ASSIGN   5202>>DOWHILE  5205<<ASSIGN   5205>>ASSIGN   5344>>IF       5390<>CALL
      5434<<DOINDEX  5434>>DOINDEX
REC_DATA_LN
      2403**DCL      2402--IMP-SIZ
REC_FORMAT.SIZ IN PROCEDURE REMOVE_PRIOR
      5610**DCL      5627<<ASSIGN   5627>>ASSIGN   5650<<ASSIGN   5650>>ASSIGN
REC_XREF$
      2951**DCL      2952--IMP-PTR
REMOVE_PRIOR
      5598**PROC     5463--CALL
RET
      5248**LABEL    5522--GOTO     5541--GOTO     5559--GOTO
SCHEMA_ACTIVE
      2695**DCL      4790>>IF       4793<<ASSIGN   5217<<ASSIGN   5289<<ASSIGN
SC_OVERFLOW
      5298**LABEL    4914--GOTO
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:221  
SC_PTR
      2969**DCL      4867<<ASSIGN   4912<<ASSIGN   4912>>ASSIGN   4913>>IF       4915>>ASSIGN   4916>>ASSIGN
      4918>>ASSIGN   4921>>ASSIGN   4923>>ASSIGN   4931>>ASSIGN   4932>>ASSIGN   4934>>ASSIGN   4999>>ASSIGN
      5000>>ASSIGN   5000>>ASSIGN   5076>>ASSIGN   5090>>ASSIGN   5091>>ASSIGN   5092>>ASSIGN   5093>>ASSIGN
      5093>>ASSIGN   5102>>ASSIGN   5103>>ASSIGN   5107>>ASSIGN   5111>>ASSIGN   5117>>ASSIGN   5117>>ASSIGN
      5124>>ASSIGN   5162>>IF       5179>>ASSIGN   5298>>ASSIGN   5415<<DOINDEX  5416>>ASSIGN   5417>>ASSIGN
      5422>>ASSIGN   5440<<ASSIGN   5458>>IF       5465>>IF       5521<<DOINDEX  5523>>ASSIGN   5525>>ASSIGN
      5531>>CALL     5534>>CALL     5536>>CALL     5539<<DOINDEX  5540>>ASSIGN   5544>>CALL     5548>>ASSIGN
      5550>>CALL     5554>>CALL     5556>>CALL     5577>>IF       5580>>CALL     5585>>CALL     5645>>CALL
      5703>>IF
SC_TBL.COUNT
      2984**DCL      5357>>IF       5525>>ASSIGN   5540>>ASSIGN
SC_TBL.COUNT2
      2983**DCL      5548>>ASSIGN
SC_TBL.FULL_PERCENT
      2977**DCL      5102<<ASSIGN   5523>>ASSIGN
SC_TBL.GLOBAL
      2980**DCL      4916<<ASSIGN   5703>>IF
SC_TBL.KEY_PTR
      2982**DCL      2983--REDEF    5103<<ASSIGN
SC_TBL.NAME
      2971**DCL      4915<<ASSIGN   5531<>CALL     5534<>CALL     5536<>CALL     5544<>CALL     5550<>CALL
      5554<>CALL     5556<>CALL     5580<>CALL     5585<>CALL     5645<>CALL
SC_TBL.NO_OF_KEYS
      2979**DCL      5111<<ASSIGN   5117<<ASSIGN   5117>>ASSIGN
SC_TBL.NO_OF_SM
      2978**DCL      4932<<ASSIGN   5000<<ASSIGN   5000>>ASSIGN   5417>>ASSIGN
SC_TBL.PA_KEYSIZE
      2974**DCL      5076<<ASSIGN   5093<<ASSIGN
SC_TBL.PA_PTRSIZE
      2973**DCL      5092<<ASSIGN   5093>>ASSIGN   5124>>ASSIGN   5194>>ASSIGN   5422>>ASSIGN
SC_TBL.PA_RECSIZE
      2976**DCL      5091<<ASSIGN
SC_TBL.PA_TYPE
      2975**DCL      5090<<ASSIGN
SC_TBL.RC_PTR
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:222  
      2981**DCL      4931<<ASSIGN   5416>>ASSIGN   5458>>IF       5465>>IF       5577>>IF
SC_TBL.SETYPE
      2972**DCL      4918<<ASSIGN   4921<<ASSIGN   4923<<ASSIGN
SETS_SUMMARY
      5513**LABEL    5360--GOTO
SETUP_RA_RANGES
      4645**PROC     4966--CALL     5007--CALL     5019--CALL     5109--CALL
SET_XREF$
      2940**DCL      2941--IMP-PTR
SHARESF
      2337**DCL      4688<<ASSIGN
SHIFT_ARRAY
        16**DCL-ENT  5659--CALL
SKIP_THIS_REC
      5469**LABEL    5460--CALLALT  5463--CALLALT  5587--GOTO
STK
        44**DCL      3208--DCLINIT  3209--DCLINIT
STK.NEXT
        45**DCL      5464<>CALL     5584<>CALL     5628<>CALL     5660<>CALL
STK.PRIOR
        46**DCL      5467<>CALL     5579<>CALL     5661<>CALL
SYS_FUNC_CHECK
        28**DCL-ENT  5471--CALL     5720--CALL
SYS_FUNC_CLOS
        32**DCL-ENT  4693--CALL
SYS_FUNC_ERRMSG
        29**DCL-ENT  5570--CALL
SYS_FUNC_OPEN
        26**DCL-ENT  4690--CALL     5405--CALL
SYS_FUNC_RELDCB
        30**DCL-ENT  4706--CALL     5563--CALL
SYS_FUNC_WRIT
        27**DCL-ENT  5746--CALL
TYPE
      2887**DCL      4865<<ASSIGN   5414<<ASSIGN
TYPE.MSTRINDX
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:223  
      2888**DCL      4962>>ASSIGN   4965<<ASSIGN   5014>>ASSIGN   5018<<ASSIGN   5107<<ASSIGN   5187>>ASSIGN
      5198>>ASSIGN   5420>>ASSIGN   5422<<ASSIGN   5422>>ASSIGN
TYPE_MSG IN PROCEDURE OPEN_SCHEMA
      4684**DCL      4682--PROC     4710--IF
UPDATE_PTR
      5689**PROC     5464--CALL     5628--CALL     5660--CALL
UPDATE_PTR2 IN PROCEDURE UPDATE_PTR
      5701**ENTRY    5467--CALL     5661--CALL
UWA.AC_REC.BASE_DBK
       855**DCL      4847>>ASSIGN
UWA.AC_REC.CALC_NEXT
       874**DCL       875--REDEF
UWA.AC_REC.CALC_PRIOR
       883**DCL       884--REDEF
UWA.AC_REC.DEFAULTS
       832**DCL       833--REDEF
UWA.AC_REC.FILE_CODE
       837**DCL       838--REDEF
UWA.AC_REC.FLAG1.ERROR_TYPE
       834**DCL       835--REDEF
UWA.AC_REC.LPP
       864**DCL      4846>>ASSIGN   4850>>ASSIGN   4853>>ASSIGN
UWA.AC_REC.MAX_DBK
       859**DCL      4850>>ASSIGN
UWA.AC_REC.MIN_DBK
       858**DCL      4850>>ASSIGN
UWA.AC_REC.PG_TYPE
       849**DCL       850--REDEF    4838>>IF
UWA.AC_REC.SWS.CHECKSUM
       839**DCL      4855>>ASSIGN
UWA.AD_REC.ADDATE
       814**DCL       815--REDEF
UWA.AD_REC.ADDATE_RD
       815**DCL      4758>>IF       4805>>ASSIGN
UWA.AD_REC.ADFUNC
       813**DCL      4758>>IF
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:224  
UWA.CF_REC.CTLSEQ
       972**DCL      5068>>ASSIGN   5126>>ASSIGN
UWA.DB_STATUS
       762**DCL      4650>>DOWHILE  4727>>DOWHILE  4756>>DOWHILE  4765>>ASSIGN   4836>>DOWHILE  4881>>DOWHILE
      4981>>DOWHILE  5031>>DOWHILE  5113>>DOWHILE  5286>>ASSIGN
UWA.DIR_REF
       771**DCL      4880>>ASSIGN   5134>>ASSIGN
UWA.FR_REC.BUFLOC
       944**DCL      5038>>ASSIGN   5042>>ASSIGN   5121>>ASSIGN
UWA.FR_REC.FTYP
       931**DCL      5045>>DOCASE   5059>>ASSIGN   5067>>ASSIGN   5122>>ASSIGN
UWA.RA_REC.HDBK
       925**DCL      4661>>ASSIGN
UWA.RA_REC.LDBK
       924**DCL      4660>>ASSIGN
UWA.RC_REC.LSIZE
       907**DCL      5091>>ASSIGN   5098>>ASSIGN
UWA.RC_REC.PA_ENTRY
       905**DCL      5093>>ASSIGN   5095>>IF       5096>>ASSIGN   5100>>IF       5101>>ASSIGN
UWA.RC_REC.PA_OFFSET
       904**DCL      5092>>ASSIGN   5098>>ASSIGN
UWA.RC_REC.RTYPE
       893**DCL      4935>>ASSIGN   4962>>ASSIGN   4965>>ASSIGN   4989>>ASSIGN   5014>>ASSIGN   5018>>ASSIGN
      5090>>ASSIGN   5107>>ASSIGN
UWA.SC_REC.SETGLO
       913**DCL      4916>>ASSIGN
UWA.SC_REC.SETMODE
       911**DCL      4729>>IF       4889>>IF       4889>>IF       4917>>IF       5074>>IF       5079>>IF
      5086>>IF
UWA.SC_REC.SETORD
       912**DCL      4888>>IF       4920>>IF
UWA.SF_REC.DBKOA
       780**DCL      4834<>CALL
UWA.SM_REC.INSTYPE
       951**DCL      4991>>IF       5005>>IF
UWA.SM_REC.NXTPNT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:225  
       959**DCL      4990>>ASSIGN
UWA.SM_REC.RETTYPE
       952**DCL      4991>>IF       5005>>IF
UWA.SM_REC.SEQDUP
       954**DCL      4995>>IF
UWA.SN_REC.SENAME
       993**DCL      4656>>DOWHILE  4734>>ASSIGN   4765<<ASSIGN   4766<>CALL     4844>>ASSIGN   4898>>IF
      4915>>ASSIGN   5063<>CALL     5165<<ASSIGN   5168<<ASSIGN   5171<<ASSIGN   5173<<ASSIGN   5174<>CALL
      5286<<ASSIGN   5287<>CALL     5299<<ASSIGN   5303<<ASSIGN   5307<<ASSIGN   5310<>CALL
UWA.SN_REC.SETYPE
       990**DCL      4883>>IF
UWA.SO_REC.NXTPNT
       948**DCL      4933>>ASSIGN
WAITSF
      2302**DCL      5724<<ASSIGN
X
      2392**DCL        64--IMP-SIZ  4655<<ASSIGN   4656>>DOWHILE  4657<<ASSIGN   4657>>ASSIGN   4660>>ASSIGN
      4660>>ASSIGN   4660>>ASSIGN   4661>>ASSIGN   4661>>ASSIGN   4661>>ASSIGN   4667>>IF       4668>>ASSIGN
      4669>>IF       4670>>ASSIGN   4696<<CALLBLT  4704>>CALLBLT  4828<>CALL     4887<<ASSIGN   4895<<ASSIGN
      4900<<ASSIGN   4902>>ASSIGN   4908<<ASSIGN   4910>>IF       4962<<ASSIGN   4963>>IF       4969>>DOWHILE
      4970>>IF       4971<<ASSIGN   4971>>ASSIGN   4974>>ASSIGN   4975<<ASSIGN   5014<<ASSIGN   5016>>IF
      5022>>DOWHILE  5023>>ASSIGN   5024<<ASSIGN   5024>>ASSIGN   5025>>IF       5029<<ASSIGN   5036<<ASSIGN
      5036>>ASSIGN   5059<<ASSIGN   5062<>CALL     5077>>ASSIGN   5099<<ASSIGN   5100>>IF       5101<<ASSIGN
      5102>>ASSIGN   5109<>CALL     5123<<ASSIGN   5124<<ASSIGN   5124>>ASSIGN   5125>>ASSIGN   5141<<DOINDEX
      5142>>IF       5145>>CALL     5149>>CALL     5153>>CALL     5156>>CALL     5187<<ASSIGN   5188>>IF
      5191>>DOWHILE  5192>>ASSIGN   5192>>ASSIGN   5193>>ASSIGN   5194>>ASSIGN   5195<<ASSIGN   5195>>ASSIGN
      5198<<ASSIGN   5199>>DOWHILE  5200>>ASSIGN   5201>>ASSIGN   5207<<ASSIGN   5207>>ASSIGN   5235<<ASSIGN
      5238<<ASSIGN   5241<<ASSIGN   5244<<ASSIGN   5246<<ASSIGN   5247<>CALL     5298<<ASSIGN   5302<<ASSIGN
      5306<<ASSIGN   5309<>CALL     5356<<DOINDEX  5357>>IF       5417<<ASSIGN   5418>>DOWHILE  5423<<ASSIGN
      5423>>ASSIGN   5451<<ASSIGN   5452>>IF       5457>>ASSIGN   5523<<ASSIGN   5524<>CALL     5525<<ASSIGN
      5526>>IF       5527<>CALL     5529>>CALL     5530>>IF       5530>>IF       5533>>IF       5540<<ASSIGN
      5542<>CALL     5543>>IF       5546>>IF       5548<<ASSIGN   5549<>CALL     5617>>IF       5623<<ASSIGN
      5623>>ASSIGN   5624>>ASSIGN   5624>>ASSIGN   5625>>ASSIGN   5653>>IF       5657<<ASSIGN   5657>>ASSIGN
      5659>>CALL     5659>>CALL     5659<>CALL     5699<<ASSIGN   5705>>ASSIGN   5705>>ASSIGN   5705>>ASSIGN
      5706>>ASSIGN
XREF_BUILT
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:226  
      2960**DCL      4794>>IF       4797<<ASSIGN   5213>>IF       5215<<ASSIGN
Y
        56**DCL        58--IMP-SIZ  4698<<CALLBLT  4699>>IF       4701>>CALLBLT  4702<<ASSIGN   4702>>ASSIGN
      4704>>CALLBLT  4897<<DOINDEX  4898>>IF       4900>>ASSIGN   4901<<ASSIGN   5015<<ASSIGN   5023<<ASSIGN
      5026>>ASSIGN   5030<<ASSIGN   5043>>ASSIGN   5047<<ASSIGN   5047>>ASSIGN   5049<<ASSIGN   5049>>ASSIGN
      5051<<ASSIGN   5051>>ASSIGN   5053<<ASSIGN   5053>>ASSIGN   5055<<ASSIGN   5055>>ASSIGN   5057<<ASSIGN
      5057>>ASSIGN   5074>>IF       5075>>ASSIGN   5076>>ASSIGN   5098<<ASSIGN   5099>>ASSIGN   5102>>ASSIGN
      5186<<DOINDEX  5187>>ASSIGN   5198>>ASSIGN   5419<<ASSIGN   5420>>ASSIGN   5422>>ASSIGN   5422>>ASSIGN
      5652<<DOINDEX  5653>>IF       5654>>ASSIGN   5654>>ASSIGN
Z IN PROCEDURE REMOVE_PRIOR
      5607**DCL      5616<<DOINDEX  5617>>IF       5618>>ASSIGN   5618>>ASSIGN   5620<<ASSIGN   5621>>ASSIGN
      5622<<ASSIGN   5622>>ASSIGN   5623>>ASSIGN   5637<<ASSIGN   5638>>IF       5644<>CALL     5649>>ASSIGN
      5651<<ASSIGN   5651>>ASSIGN   5657>>ASSIGN
ZERO_V IN PROCEDURE REMOVE_PRIOR
      5605**DCL      5626<<ASSIGN
ZI$DIR.ALTKEY
      2650**DCL      2651--REDEF    2652--REDEF
ZI$DIR.AREAFID
      2616**DCL      2617--REDEF
ZI$DIR.CODE
      2632**DCL      4774>>IF       4777>>IF       4780>>IF       4783>>IF       4808>>IF       4818>>IF
      4889>>IF       4889>>IF       4960>>IF       4960>>IF       5001>>IF       5003>>IF       5039>>IF
      5104>>IF       5104>>IF       5108>>IF       5144>>IF       5148>>IF       5152>>IF       5164>>IF
      5167>>IF       5170>>IF       5185>>IF       5234>>IF       5237>>IF       5240>>IF       5243>>IF
      5346>>IF       5349>>IF       5352>>IF       5352>>IF       5412>>IF       5459>>IF       5462>>IF
      5465>>IF       5515>>IF       5520>>IF       5530>>IF       5543>>IF       5553>>IF
ZI$DIR.DATE
      2655**DCL      2659--REDEF
ZI$DIR.DEST_SEED
      2611**DCL      2612--REDEF    2613--REDEF
ZI$DIR.ENCP_SEED
      2608**DCL      2609--REDEF    2610--REDEF
ZI$DIR.INIT_TMPLT_KEY
      2672**DCL      4870>>IF       4871<<ASSIGN   4873>>IF       4875<<ASSIGN   5099>>ASSIGN
ZI$DIR.REPRT_ZERO
      2642**DCL      2643--REDEF
PL6.E3A0      #001=ZIU$CMPT_INIT File=ZIU$CMPT_INIT.:ZIC0TSI                     FRI 09/05/97 13:08 Page:227  
ZI$DIR.SCHEMA_NM
      2674**DCL      4686<>CALL
ZI$DIR.SCHEMA_NM.NAME.TEXT
      2677**DCL      4694<<ASSIGN   4704>>CALLBLT  4709>>CALLBLT  4710>>IF       4712<>CALL     4713>>ASSIGN
      4714<>CALL     4803<<ASSIGN   4812<<ASSIGN   4821<<ASSIGN   4827<<ASSIGN
ZI$DIR.SCHFID
      2614**DCL      2615--REDEF
ZI$DIR.SKIP_DMCL_CHK
      2643**DCL      4814>>IF       4824>>IF
ZI$DIR.TIME
      2660**DCL      2665--REDEF
ZIU$Q2SC
        24**DCL-ENT  4714--CALL
ZIU$SYSCTL
        25**DCL-ENT  4707--CALL     4715--CALL     4717--CALL     4802--CALL
