
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:1    
        1        1        /*M* ZIU$LOAD - Database restore from Dump routine for DBUTIL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P* NAME: ZIU$LOAD
        8        8        PURPOSE: To restore a data base dump from a dump file created by
        9        9                 'DBUTIL'. Also to restore an associated key file if one
       10       10                 exists with the area.
       11       11        DESCRIPTION:
       12       12
       13       13                                 DATA BASE LOAD UTILITY
       14       14                                        ZIU$LOAD
       15       15
       16       16
       17       17
       18       18               The  purpose  of the  LOAD  program is  to  decompress and
       19       19               restore  a data  base  dump file  back into  the data base
       20       20               area. In  addition, it is  used to  restore and associated
       21       21               keyed  files  with  the  dump.   For  a  dump  file  to be
       22       22               restored, the area name in  the attribute page of the dump
       23       23               file  must  be  the  same as  the  area  destination  name
       24       24               specified in  the  directive.  This  restriction  helps to
       25       25               avoid accidental over writing of a data base area with the
       26       26               wrong data base dump file. In general, the LOAD program is
       27       27               designed to be  used to reload  certain data base pages or
       28       28               page ranges,  which means the data  base area would not be
       29       29               deleted and  completely over  written. However, a complete
       30       30               restore is permitted if your dump file has a complete data
       31       31               base in it.
       32       32
       33       33               The LOAD  utility may only  be used to  restore dump files
       34       34               created by the data base DUMP utility, and this is checked
       35       35               by the attribute page in  the dump file. It is also in the
       36       36               attribute page where the  existance of an associated keyed
       37       37               file is checked.  If an associated  keyed file is supposed
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:2    
       38       38               to exist, it  is searched  for in the  same account as the
       39       39               area dump  file. If it is  not found, a  warning is issued
       40       40               with the name of the file being searched for, otherwise it
       41       41               is reloaded by  being written out  through the same DCB as
       42       42               the Aarea  file.  Doing  this will serve  to keep the area
       43       43               and  associated keyed file  in the same  account. Also, at
       44       44               the end of the load  operation, if there was an attempt to
       45       45               reload any  pages that did  not exist in  the dump file, a
       46       46               warning is issued  followed by a  page list of the missing
       47       47               page numbers.
       48       48
       49       49                    EX:
       50       50                    In this directive:  DUMP AREA(5-10) OVER DUMP_FILE
       51       51
       52       52                    Only pages 5 thru 10 plus the attribute page are
       53       53                    dumped. If you then do the following:
       54       54                    LOAD DUMP_FILE(5-10) INTO AREA
       55       55
       56       56                    A normal load will occurr, however if you say:
       57       57                    LOAD DUMP_FILE INTO AREA
       58       58
       59       59                    You will recieve a warning that pages 1 thru 4 and
       60       60                    pages 6 thru EOF were not in the dump file.
       61       61
       62       62
       63       63
       64       64                                   PROGRAM OPERATION
       65       65
       66       66
       67       67               This program  essentially workes  like the DUMP utility in
       68       68               reverse. The  source DCB  is opened  using the DCB name as
       69       69               the file name.  Then the actual file  name opened (in case
       70       70               changed by a set command) is taken from the DCB.
       71       71
       72       72               The attribute page of the dump is then checked to see that
       73       73               the area  in the  dump file is  the same  as the area name
       74       74               specified in the  directive. The  associated key file flag
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:3    
       75       75               is checked for  the presence of a  keyed file and the dump
       76       76               ID is checked to  ensure that this  file was a file dumped
       77       77               by the DUMP utility. IN adddition, another flag is checked
       78       78               to see if  this file  consists of a full  or partial dump.
       79       79               If  it's a  partial  dump  then  the  LOAD  directive must
       80       80               specify a load INTO area name (IE. the EXIST parameter for
       81       81               the  monitor  open call  must be  'OLDFILE')  otherwise an
       82       82               error is  reported  and the  load aborted.  If the dump is
       83       83               complete and the 'INTO'  option is not used, then the user
       84       84               must not  specify a page  range or again  an error will be
       85       85               issued and the load  aborted. The idea of course is to not
       86       86               let the user  accidently  create him or  herself a partial
       87       87               data base area. Once these  checks are made, the inventory
       88       88               page  numbers  are  calculated and  the  attribute page is
       89       89               restored and written out to the area file.
       90       90
       91       91               Now the actual load begins.  A page range is recieved from
       92       92               module ZIU$PGRG. One at a  time an attempt is made to read
       93       93               each page in the range from  the dump file. If the page is
       94       94               not there  then the  page  number is given  to the missing
       95       95               page list, otherwise the  page is decompreseed (if it is a
       96       96               data page) and written to the area file. When completed, a
       97       97               report procedure  is called to  report file names and page
       98       98               counts.
       99       99
      100      100
      101      101                                                                          */
      102      102        ZIU$LOAD: PROC ALTRET;
      103      103    1   DCL PGE_INDX SBIN WORD STATIC INIT(0);
      104      104    1   DCL PGS_LOAD SBIN WORD STATIC INIT(0);
      105      105    1   DCL LOW_RNG (0:99) UBIN WORD STATIC INIT(0*100);
      106      106    1   DCL HIGH_RNG (0:99) UBIN WORD STATIC INIT(0*100);
      107      107    1   DCL HIGH_PAGE SBIN WORD SYMREF ALIGNED;
      108      108    1   DCL HIGH_DATA_PG SBIN WORD SYMREF ALIGNED;
      109      109    1   DCL NUM_INV_PGS SBIN WORD SYMREF ALIGNED;
      110      110    1   DCL LPP SBIN WORD SYMREF ALIGNED;
      111      111    1   DCL LOW_DBK SBIN WORD SYMREF ALIGNED;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:4    
      112      112    1   DCL BUF_PTR SBIN WORD SYMREF ALIGNED;
      113      113    1   DCL DUMP_CREATION CHAR(14);
      114      114    1   DCL FILE_INFO(0:1023) BIT(36) SYMREF ALIGNED;
      115      115    1   DCL FIT$ PTR;
      116      116    1   DCL TSTAMP UBIN;
      117      117    1   DCL RBTEMP UBIN;
      118      118    1   DCL SRCEDCB UBIN HALF;
      119      119    1   DCL DESTDCB UBIN HALF;
      120      120    1   DCL I_O_INDX SBIN WORD;
      121      121    1   DCL 1 SRCE_FILE,
      122      122    1         2 CNT UBIN(9) CALIGNED,
      123      123    1         2 TEXT CHAR(31);
      124      124    1   DCL 1 DEST_FILE,
      125      125    1         2 CNT UBIN(9) CALIGNED,
      126      126    1         2 TEXT CHAR(31);
      127      127    1   DCL FILE_SIZE UBIN;
      128      128    1   DCL REPRT CHAR(80);
      129      129    1   DCL DB_PGNO UBIN WORD BASED(I_O_BUF$);
      130      130
      131      131    1   DCL RIGHT_JUSTIFY BIT(1) CONSTANT INIT('0'B);
      132      132    1   DCL LEFT_JUSTIFY BIT(1) CONSTANT INIT('1'B) UNAL;
      133      133    1   DCL KEY_FILE_ASSOC BIT(1);
      134      134    1   DCL LAST_PAGE BIT(1);
      135      135    1   DCL EXCEEDED_ARRAY BIT(1) STATIC INIT('0'B) UNAL;
      136      136    1   DCL MSG_FLG BIT(1) STATIC INIT('0'B) UNAL;
      137      137    1   DCL CHECKSUM BIT(1) STATIC INIT('0'B) UNAL;
      138      138    1   DCL PRINT_CHKS BIT(1) STATIC INIT('0'B) UNAL;
      139      139    1   DCL BAD_CHK_LOW SBIN;
      140      140    1   DCL BAD_CHK_HIGH SBIN;
      141      141    1   DCL FULL_LOAD BIT(1);
      142      142
      143      143        /*
      144      144           includes and macros
      145      145        */
      146      146         %INCLUDE CP_6;
      147      227         %F$DCB;
      148      284         %B$TCB;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:5    
      149      287         %B$EXCFR;
      150      305         %INCLUDE CP_6_SUBS;
      151      845         %INCLUDE B_ERRORS_C;
      152     1972         %INCLUDE ZI_ERRORS_SUBS;
      153     2492         %INCLUDE ZI_DBU_XREF;
      154     2659         %XREF_TBLS;
      155     2734         %INCLUDE ZI$DIR;
      156     2891         %DIR;
      157     3035         %INCLUDE ZI$PG_STRUCTS;
      158     3138         %DATA_PG;
      159     3157         %INVTY_PG;
      160     3173         %ATBLK_PG;
      161     3229         %INCLUDE ZI_GLOBAL_DBUTIL;
      162     3407         %SYS_FUNC;
      163     3499         %MISC_DCLS;
      164     3552         %INCLUDE FM$FIT;
      165     3773         %CODE04(BASED="BASED(FIT$)");
      166     3781        /*
      167     3782           Declarations of external subroutines.
      168     3783        */
      169     3784    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      170     3785    1   DCL SYS_FUNC_GETDCB ENTRY ALTRET;
      171     3786    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
      172     3787    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      173     3788    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
      174     3789    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
      175     3790    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
      176     3791    1   DCL SYS_FUNC_CHECK ENTRY ALTRET;
      177     3792    1   DCL SYS_FUNC_TSTAMP ENTRY ALTRET;
      178     3793    1   DCL GET_FILESIZE ENTRY ALTRET;
      179     3794    1   DCL SYS_FUNC_RELEASE ENTRY ALTRET;
      180     3795    1   DCL NBUFS SBIN SYMREF ALIGNED;
      181     3796    1   DCL PAGE_RANGE ENTRY(6);
      182     3797    1   DCL ZERO_SUP ENTRY(3);
      183     3798    1   DCL CHKSUM ENTRY;
      184     3799    1   DCL BUILD_MSTR_TBL ENTRY ALTRET;
      185     3800    1   DCL BUILD_SETXREF ENTRY ALTRET;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:6    
      186     3801    1   DCL BUILD_RECXREF ENTRY ALTRET;
      187     3802    1   DCL CHECK_PAGES ENTRY ALTRET;
      188     3803    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      189     3804        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:7    
      190     3805    1   LOADING_MSG: PROC;
      191     3806    2       REPRT = '..Loading';
      192     3807    2   /**/ DCBSF = DCBNUM(M$LO);
      193     3808    2   /**/ BUFSF = VECTOR(REPRT);
      194     3809    2   /**/ BUFLNSF = 10;
      195     3810    2   /**/ VFCSF = %NO#;
      196     3811    2       CALL SYS_FUNC_WRIT;
      197     3812    2   END LOADING_MSG;
      198     3813
      199     3814        /*-----------------------------------------------------------------
      200     3815           B E G I N    L O A D   -   CHECK FILES FOR ERRORS
      201     3816        --------------------------------------------------------------------*/
      202     3817        /*
      203     3818           Open source for 'IDS' load - then call routine to check attributes.
      204     3819        */
      205     3820    1       SRCEDCB = ZI$DIR.SRCE_NM.DCB#;
      206     3821    1   /**/ DCBSF = SRCEDCB;
      207     3822    1   /**/ TESTSF = %NO#;
      208     3823    1   /**/ ORGSF = %KEYED#;
      209     3824    1   /**/ ACSSF = %DIRECT#;
      210     3825    1   /**/ FUNSF = %IN#;
      211     3826    1   /**/ SHARESF = %NONE#;
      212     3827    1   /**/ ASNSF = %FILE#;
      213     3828    1   /**/ FIDSF = ZI$DIR.SRCE_NM.NAME.TEXT;
      214     3829    1       CALL SYS_FUNC_OPEN ALTRET(ALT_SRCE_FILE);
      215     3830    1       SRCE_FILE=DCBADDR(SRCEDCB)->F$DCB.NAME#; /* GET FILE NAME */
      216     3831
      217     3832    1       FIT$ = ADDR(FILE_INFO);
      218     3833    1       CALL XSF$LOCCODP (FIT$,4) ALTRET(ALTRTN);
      219     3834    1       TSTAMP = CODE04.CREATION.TIME;
      220     3835    1       DUMP_CREATION = ' ';
      221     3836    1   /**/ SOURCESF = %UTS#;
      222     3837    1   /**/ DESTSF = %LOCAL#;
      223     3838    1   /**/ TIMESF = VECTOR(SUBSTR(DUMP_CREATION,0,5));
      224     3839    1   /**/ DATESF = VECTOR(SUBSTR(DUMP_CREATION,6,8));
      225     3840    1   /**/ TSTAMPSF = VECTOR(TSTAMP);
      226     3841    1       CALL SYS_FUNC_TSTAMP ALTRET(ALT_TSTAMP);
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:8    
      227     3842
      228     3843    1       IF DCBADDR(SRCEDCB)->F$DCB.ORG#=%INDEXED# OR
      229     3844    1          DCBADDR(SRCEDCB)->F$DCB.ORG#=%RESTRICT# THEN
      230     3845    2       DO;
      231     3846    2           IF ZI$DIR.OPEN_MODE=%OLDFILE# THEN
      232     3847        /*E* ERROR: ZIU-10001-C
      233     3848             MESSAGE: The 'INTO' option is not allowed to load indexed files. */
      234     3849    3           DO;
      235     3850    3               ERRCODESF.ERR#=10001;
      236     3851    3               MSGCODE=ERRCODE_RDEF;
      237     3852    3               CALL SYS_FUNC_ERRMSG;
      238     3853    3               CALL CLOSE_FILES;
      239     3854    3               ALTRETURN;
      240     3855    3               END;
      241     3856    2           IF DCBADDR(SRCEDCB)->F$DCB.ORG#=%INDEXED# THEN
      242     3857    3           DO; /* DUMP FID IS A DISK FILE */
      243     3858    3               DCBSF = SRCEDCB; /* REOPEN WITH BLOCK MODE */
      244     3859    3               CALL SYS_FUNC_CLOS ALTRET(ALT_SRCE_FILE);
      245     3860    3               CALL LOAD_DISK_INDEX('IND') ALTRET(ALT_WRIT_DEST);
      246     3861    3               END;
      247     3862    2           ELSE /* DUMP FID IS A TAPE FILE */
      248     3863    2               CALL LOAD_TAPE_INDEX('IND') ALTRET(ALT_WRIT_DEST);
      249     3864    2           GOTO END_OF_LOAD;
      250     3865    2           END;
      251     3866    1       CALL GET_ATBLK(NUM_INV_PGS,HIGH_DATA_PG,HIGH_PAGE)
      252     3867    1          ALTRET(ALT_RD_ATBLK);
      253     3868    1       DESTDCB = ZI$DIR.DEST_NM.DCB#;
      254     3869    1   /**/ EXISTSF = ZI$DIR.OPEN_MODE;
      255     3870    1   /**/ XTENSIZESF = FILE_SIZE;
      256     3871    1   /**/ BKUPSF = %YES#;
      257     3872    1   /**/ ACNT = ZI$DIR.ACNT;
      258     3873    1   /**/ DCBSF = DESTDCB;
      259     3874    1   /**/ ORGSF = %IDS#;
      260     3875    1   /**/ TESTSF= %NO#;
      261     3876    1   /**/ ACSSF = %DIRECT#;
      262     3877    1   /**/ FUNSF = %CREATE#;
      263     3878    1   /**/ ASNSF = %FILE#;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:9    
      264     3879    1   /**/ FIDSF = ZI$DIR.DEST_NM.NAME.TEXT;
      265     3880    1   /**/ SHARESF = %NONE#;
      266     3881    1       CALL SYS_FUNC_OPEN ALTRET(ALT_DEST_FILE);
      267     3882    1       DEST_FILE = DCBADDR(DESTDCB) -> F$DCB.NAME#;
      268     3883         /**/
      269     3884    1       IF DCBADDR(DESTDCB) -> F$DCB.ORG# ~= %IDS# THEN
      270     3885    2       DO;
      271     3886         /*E* ERROR: ZIU-08015-C
      272     3887                  MESSAGE: %FN is not an IDS/INDEXED file - LOAD aborted.
      273     3888                  */
      274     3889    2           ERRCODESF.ERR# = 8015;
      275     3890    2           MSGCODE = ERRCODE_RDEF;
      276     3891    2           ERRFLGSF = 4;
      277     3892    2           CALL SYS_FUNC_ERRMSG;
      278     3893    2           ALTRETURN;
      279     3894    2           END;
      280     3895         /*
      281     3896            Write out attribute block after restoring dump info.
      282     3897         */
      283     3898    1       CALL WRITE_BUF(1) ALTRET(ALT_WRIT_DEST); /* WRITE 1 PAGE */
      284     3899    1       PGS_LOAD = 1; /* INCLUDING FIT */
      285     3900    1       LAST_PAGE = %NO#;
      286     3901    1       IF ZI$DIR.CHECK = %YES# THEN
      287     3902    2       DO;
      288     3903    2           BUF_PTR = 0; /* BUF ADDR STARTING FRO I_O_BUF(0) ALWAYS */
      289     3904    2           IF XREF_BUILT = %NO# THEN
      290     3905    3           DO;
      291     3906    3               CALL BUILD_MSTR_TBL ALTRET(ALTRTN);
      292     3907    3               CALL BUILD_SETXREF ALTRET(ALTRTN);
      293     3908    3               CALL BUILD_RECXREF ALTRET(ALTRTN);
      294     3909    3               END;
      295     3910    2           X = 0;
      296     3911    3           DO WHILE(ZI$DIR.AREA_NM.NAME.TEXT ~= AREA_KEY_XREF.NAME(X));
      297     3912    3               X = X +1;
      298     3913    3               END;
      299     3914    2           AREA_KEY_XREF.CHECKED(X) = 1;
      300     3915    2           END;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:10   
      301     3916    1       CALL PAGE_RANGE(RB,RE,32,I_O_SIZE,HIGH_PAGE,LAST_PAGE);
      302     3917    1       I_O_INDX = -1;
      303     3918        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:11   
      304     3919        /*-----------------------------------------------------------------
      305     3920                   B E G I N     L O A D    P R O C E D U R E
      306     3921        -------------------------------------------------------------------*/
      307     3922    1       CALL LOADING_MSG; /* OUTPUT ..LOADING MESSAGE */
      308     3923    1       BAD_CHK_LOW=0;
      309     3924    2       DO WHILE(~LAST_PAGE);
      310     3925    2           RBTEMP = RB;
      311     3926    3           DO RB = RB TO RE BY 1;
      312     3927    3               IF BREAK_FLAG > 0 THEN
      313     3928    4               DO;
      314     3929    4                   CALL CLOSE_FILES;
      315     3930    4                   RETURN;
      316     3931    4                   END;
      317     3932    3               I_O_INDX = I_O_INDX +1;
      318     3933    3    /**/       DCBSF = SRCEDCB;
      319     3934    3    /**/       BUFSF = VECTOR(I_O_BUF(I_O_INDX));
      320     3935    3    /**/       BUFLNSF = 4096 ;
      321     3936    3    /**/       FULLSF = %YES#;
      322     3937    3    /**/       ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;
      323     3938    3    /**/       KEYSF = %YES#;
      324     3939    3    /**/       KEYVSF.LEN = 4; /* Key size */
      325     3940    3    /**/       KEYVSF.IDSKEY = RB;
      326     3941    3               CALL SYS_FUNC_READ ALTRET(ALT_DUMP_READ);
      327     3942         /*
      328     3943            Check that the required key was there.
      329     3944         */
      330     3945    3               IF NO_KEYSF THEN /* Key does not exist */
      331     3946    4               DO;
      332     3947    4                   IF ZI$DIR.CHECK = %YES# THEN
      333     3948    5                   DO;
      334     3949         /*E* ERROR: ZIU-DBU#LDCHK-C
      335     3950                       MESSAGE: Unable to check an incomplete dump file - CHECK canceled. */
      336     3951    5                       ERRCODESF.ERR# = DBU#LDCHK;
      337     3952    5                       MSGCODE = ERRCODE_RDEF;
      338     3953    5                       CALL SYS_FUNC_ERRMSG;
      339     3954    5                       ZI$DIR.CHECK = %NO#;
      340     3955    5                       END;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:12   
      341     3956    4                   IF ZI$DIR.NOPRNT='0'B THEN /* Report missing pages optional */
      342     3957    4                       CALL ADD_MISSING_PGE;
      343     3958    4                   IF I_O_INDX > 0 THEN
      344     3959    4                       CALL WRITE_BUF(I_O_INDX) ALTRET(ALT_WRIT_DEST);
      345     3960    4                   I_O_INDX = -1;
      346     3961    4                   END;
      347     3962    4               ELSE DO;
      348     3963    4                   DATA$ = ADDR(I_O_BUF(I_O_INDX));
      349     3964    4                   IF RB <= HIGH_DATA_PG THEN
      350     3965    4                       CALL EXPAND_PAGE;
      351     3966    4                   IF CHECKSUM AND RB <= HIGH_DATA_PG THEN
      352     3967    4                       CALL CHECK_SUM;
      353     3968    4                   PGS_LOAD = PGS_LOAD + 1;
      354     3969    4                   END;
      355     3970    3               END;
      356     3971         /*
      357     3972            Call write routine after insuring there are pages in the buffer
      358     3973            to be written (ie. the pages in the current page range may
      359     3974            not have been in the dump file.)
      360     3975         */
      361     3976    2           IF I_O_INDX >= 0 THEN
      362     3977    3           DO;
      363     3978    3               RB = RBTEMP;
      364     3979    3               IF ZI$DIR.CHECK = %YES# THEN
      365     3980    3                   CALL CHECK_PAGES;
      366     3981    3               CALL WRITE_BUF(I_O_INDX +1) ALTRET(ALT_WRIT_DEST);
      367     3982    3               END;
      368     3983    2           I_O_INDX = -1;
      369     3984    2           CALL PAGE_RANGE(RB,RE,32,I_O_SIZE,HIGH_PAGE,LAST_PAGE);
      370     3985    2           END;
      371     3986        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:13   
      372     3987        /*
      373     3988                   Print any bad checksum pages not yet printed.
      374     3989        */
      375     3990    2       IF CHECKSUM AND MSG_FLG THEN DO;
      376     3991    2           STEPCC=2; /* SET A WARNING STEPCC CODE */
      377     3992    2           PRINT_CHKS = %YES#;
      378     3993    2           CALL CHECK_SUM;
      379     3994    2           CHECKSUM = %NO#;
      380     3995    2           MSG_FLG = %NO#; /* Reset checksum flags for nxt load */
      381     3996    2           PRINT_CHKS=%NO#;
      382     3997    2           END;
      383     3998    1       CALL LOAD_REPRT('IDS');
      384     3999        /*
      385     4000           Check for and reload associated key file.
      386     4001        */
      387     4002    1       IF KEY_FILE_ASSOC AND ZI$DIR.NOKEYS = %NO# THEN
      388     4003    2       DO;
      389     4004    2           POSSF = 0; /* IF TAPE, DONT REWIND OR REMOVE */
      390     4005    2    /**/   DCBSF = SRCEDCB;
      391     4006    2           CALL SYS_FUNC_CLOS; /* Close but don't release dcbs */
      392     4007    2    /**/   DCBSF = DESTDCB;
      393     4008    2           CALL SYS_FUNC_CLOS;
      394     4009    2           CALL LOAD_ASCFID('KEY') ALTRET(ALT_LOAD_ASC);
      395     4010    2           END;
      396     4011    1   END_OF_LOAD:
      397     4012    1       CALL CLOSE_FILES;
      398     4013    1       REPRT = '...Load terminated';
      399     4014    1   /**/ DCBSF = DCBNUM(M$LO);
      400     4015    1   /**/ BUFSF = VECTOR(REPRT);
      401     4016    1   /**/ BUFLNSF = 80;
      402     4017    1   /**/ VFCSF = %NO#;
      403     4018    1       CALL SYS_FUNC_WRIT;
      404     4019    1       IF STEPCC > 9 THEN
      405     4020    1           ALTRETURN; /* DO ALTRET, SO M$XXX TO BE ISSUED BY Q2UT */
      406     4021    1       RETURN;
      407     4022        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:14   
      408     4023         /*
      409     4024            WRITE  I_O_BUFFER OUT TO AREA FILE
      410     4025         */
      411     4026    1   WRITE_BUF: PROC(NUM_RECS) ALTRET;
      412     4027    2   DCL NUM_RECS UBIN WORD; /* NUM OF RECS BEING WRITTEN */
      413     4028    2   /**/ DCBSF = DESTDCB;
      414     4029    2   /**/ BUFSF = VECTOR(I_O_BUF);
      415     4030    2   /**/ BUFLNSF = NUM_RECS * 4096;
      416     4031    2   /**/ WAITSF = %YES#;
      417     4032    2   /**/ NOTIMESF = %YES#;
      418     4033    2   /**/ FULLSF = %YES#;
      419     4034    2   /**/ VFCSF = %NO#;
      420     4035    2   /**/ ENCRP_SEEDSF = ZI$DIR.DEST_SEED;
      421     4036    2   /**/ KEYVSF.IDSKEY = DB_PGNO;
      422     4037    2       CALL SYS_FUNC_WRIT ALTRET(ALT_WRIT);
      423     4038    2       RETURN;
      424     4039    2   ALT_WRIT:
      425     4040    2       ALTRETURN;
      426     4041    2   END WRITE_BUF;
      427     4042        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:15   
      428     4043
      429     4044
      430     4045        /*------------------------------------------------------------------
      431     4046                        GET INVENTORY AND FILE SIZE ATTRIBUTES
      432     4047        -------------------------------------------------------------------*/
      433     4048    1   GET_ATBLK: PROC(INV,DATAPGS,HI_PGE) ALTRET;
      434     4049    2   DCL INV SBIN;
      435     4050    2   DCL DATAPGS SBIN;
      436     4051    2   DCL HI_PGE SBIN;
      437     4052
      438     4053    2   DCL 1 DUMP_INFO BASED(ATBLK$) ALIGNED,
      439     4054    2         2 * (0:2) UBIN WORD UNAL,
      440     4055    2         2 ID CHAR(4) UNAL,
      441     4056    2         2 FULL_DUMP BIT(1) UNAL;
      442     4057    2   /**/ DCBSF = SRCEDCB;
      443     4058    2   /**/ BUFSF = VECTOR(I_O_BUF(0));
      444     4059    2   /**/ BUFLNSF = 4096;
      445     4060    2   /**/ FULLSF = %YES#;
      446     4061    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;
      447     4062    2   /**/ KEYSF = %YES#;
      448     4063    2   /**/ KEYVSF.LEN= 4;
      449     4064    2   /**/ KEYVSF.IDSKEY = 0;
      450     4065    2       CALL SYS_FUNC_READ ALTRET(ALT_ATBLK);
      451     4066    2       ATBLK$ = ADDR(I_O_BUF(0));
      452     4067    2       IF ZI$DIR.DEST_NM.NAME.TEXT ~= ATBLK_PG.AREA_NM THEN
      453     4068    3       DO;
      454     4069         /*E* ERROR: ZIU-08090-C
      455     4070                  MESSAGE: Area name "%U1" is not the area in dump file %FN.
      456     4071                  */
      457     4072    3           ERR_INSERT(0) = ZI$DIR.DEST_NM.NAME;
      458     4073    3           ERRCODESF.ERR# = 8090;
      459     4074    3           MSGCODE = ERRCODE_RDEF;
      460     4075    3           CALL SYS_FUNC_ERRMSG;
      461     4076    3           ALTRETURN;
      462     4077    3           END;
      463     4078    2       IF ATBLK_PG.MISC_INFO.KEY_FILE_BLT THEN
      464     4079    2           KEY_FILE_ASSOC = %YES#;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:16   
      465     4080    2       ELSE
      466     4081    2           KEY_FILE_ASSOC = %NO#;
      467     4082    2       IF ATBLK_PG.MISC_INFO.CHKSM = %YES# THEN
      468     4083    2           CHECKSUM = %YES#;
      469     4084    2       ELSE
      470     4085    2           CHECKSUM = %NO#;
      471     4086    2       FILE_SIZE = ATBLK_PG.NUM_DBPG + 1;
      472     4087        /*
      473     4088           Check to see that this is an 'IDS' dump.
      474     4089        */
      475     4090    2       IF DUMP_INFO.ID ~= 'DUMP' THEN
      476     4091    3       DO;
      477     4092         /*E* ERROR: ZIU-08025-C
      478     4093                  MESSAGE: File %FN is not an IDS dump file or
      479     4094                           was not dumped by DBUTIL - LOAD aborted.
      480     4095                  */
      481     4096    3           ERRFLGSF = 4;
      482     4097    3           ERRCODESF.ERR# = 8025;
      483     4098    3           MSGCODE = ERRCODE_RDEF;
      484     4099    3           CALL SYS_FUNC_ERRMSG;
      485     4100    3           ALTRETURN;
      486     4101    3           END;
      487     4102    2       IF DUMP_INFO.FULL_DUMP = %YES# THEN
      488     4103    3       DO; /* This code needed to stay compat with A00 */
      489     4104    3           ATBLK_PG.STATUS.FULL_DUMP = %YES#;
      490     4105    3           DUMP_INFO.FULL_DUMP = '0'B;
      491     4106    3           END;
      492     4107    2       IF ATBLK_PG.STATUS.FULL_DUMP = %NO# AND ZI$DIR.OPEN_MODE ~= %OLDFILE#
      493     4108    3       THEN DO;
      494     4109         /*E* ERROR: ZIU-08060-C
      495     4110                   MESSAGE: ON and OVER options are not permitted while
      496     4111                            loading from a partial dump file. (i.e. Date or
      497     4112                            page range options specified at dump time.)
      498     4113                   */
      499     4114    3           ERRCODESF.ERR# = 8060;
      500     4115    3           MSGCODE = ERRCODE_RDEF;
      501     4116    3           CALL SYS_FUNC_ERRMSG;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:17   
      502     4117    3           ALTRETURN;
      503     4118    3           END;
      504     4119    2       IF ZI$DIR.RNG_LIST AND ZI$DIR.OPEN_MODE ~= %OLDFILE# THEN
      505     4120    3       DO;
      506     4121         /*E* ERROR: ZIU-08080-C
      507     4122                  MESSAGE: ON and OVER options not permitted with partial load.
      508     4123                  */
      509     4124    3           ERRCODESF.ERR# = 8080;
      510     4125    3           MSGCODE = ERRCODE_RDEF;
      511     4126    3           CALL SYS_FUNC_ERRMSG;
      512     4127    3           ALTRETURN;
      513     4128    3           END;
      514     4129        /*
      515     4130           Calculate inventory pages and number of data pages.
      516     4131        */
      517     4132    2       IF ATBLK_PG.FIR_INV_PGNO = 0 THEN
      518     4133    3       DO;
      519     4134    3           HI_PGE = ATBLK_PG.NUM_DBPG;
      520     4135    3           DATAPGS = HI_PGE;
      521     4136    3           INV = 0;
      522     4137    3           END;
      523     4138    3       ELSE DO;
      524     4139    3           INV= ATBLK_PG.NUM_DBPG - ATBLK_PG.FIR_INV_PGNO + 1;
      525     4140    3           DATAPGS = ATBLK_PG.NUM_DBPG - INV;
      526     4141    3           HI_PGE = ATBLK_PG.NUM_DBPG;
      527     4142    3           END;
      528     4143    2       IF ATBLK_PG.STATUS.FULL_DUMP = %NO# THEN
      529     4144    2           ZI$DIR.NOKEYS = %YES#; /* Don't restore keys on partial load */
      530     4145    2       FULL_LOAD=ATBLK_PG.STATUS.FULL_DUMP; /* REMEMBER TYPE OF LOAD */
      531     4146    2       ATBLK_PG.STATUS.FULL_DUMP = '0'B; /* Reset dump bit */
      532     4147    2       DUMP_INFO.ID = 'IDS2';
      533     4148    2       IF CHECKSUM = %YES# THEN
      534     4149    3       DO;
      535     4150    3           DATA$ = ATBLK$;
      536     4151    3           ICHKSUM = 0;
      537     4152    3           CALL CHKSUM;
      538     4153    3           ATBLK_PG.CHKSUM_WD = ICHKSUM_BIT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:18   
      539     4154    3           END;
      540     4155
      541     4156    2       LOW_DBK = ATBLK_PG.LOW_DBK;
      542     4157    2       LPP = ATBLK_PG.LINE_INFO.LPP;
      543     4158    2       RETURN;
      544     4159
      545     4160    2   ALT_ATBLK:
      546     4161    2       ALTRETURN;
      547     4162    2   END GET_ATBLK;
      548     4163        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:19   
      549     4164        /*-----------------------------------------------------------------
      550     4165                   E X P A N D    P A G E    P R O C
      551     4166        --------------------------------------------------------------------*/
      552     4167    1   EXPAND_PAGE: PROC;
      553     4168    2   DCL HIGH_LINE UBIN;
      554     4169    2   DCL ARRAY_SIZE UBIN;
      555     4170    2   DCL ARRAY_INDX UBIN;
      556     4171    2   DCL ACT_REC_LEN UBIN;
      557     4172    2   DCL FROM$ PTR;
      558     4173    2   DCL FROMSTR BASED(FROM$) CHAR(ARRAY_SIZE);
      559     4174    2   DCL TO$ PTR;
      560     4175    2   DCL TOSTR BASED(TO$) CHAR(ARRAY_SIZE);
      561     4176    2   DCL FIL BIT(FIL_SIZE) BASED UNAL;
      562     4177    2   DCL FIL_SIZE UBIN;
      563     4178    2   DCL SHIFT_ARRAY ENTRY(3);
      564     4179    2   DCL I_O_BUFF (0:1023) UBIN WORD BASED(DATA$);
      565     4180        /*
      566     4181           This routine takes the offset array in the compressed record
      567     4182           and moves it out to the end of the record. It then fills in
      568     4183           the created space with zeros.
      569     4184        */
      570     4185    2       HIGH_LINE = DATA_PG.OFF_LN.SEC;
      571     4186    2       ARRAY_SIZE = (HIGH_LINE/2)+1;
      572     4187    2       ACT_REC_LEN = (DCBADDR(SRCEDCB)->F$DCB.ARS#)/4;
      573     4188        /*
      574     4189           We now have the number of elements in the offset array (high_line)
      575     4190           - it's size in words and the actual record(compressed) size.
      576     4191        */
      577     4192    2       IF ACT_REC_LEN = 1024 THEN
      578     4193    2           RETURN; /* Page was never compressed - no need to decompress*/
      579     4194        /*
      580     4195               Find position in record where array should start and move it
      581     4196        */
      582     4197    2       ARRAY_INDX = 1024 - ARRAY_SIZE;
      583     4198    2       TO$ = ADDR(I_O_BUFF(ARRAY_INDX));
      584     4199    2       FROM$ = ADDR(I_O_BUFF(ACT_REC_LEN - ARRAY_SIZE));
      585     4200    2       ARRAY_SIZE = ARRAY_SIZE *4; /* Convert to character length */
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:20   
      586     4201    2       CALL SHIFT_ARRAY(FROMSTR,TOSTR,ARRAY_SIZE);/* BMAP routine using MRL */
      587     4202         /*
      588     4203            Fill in gap with zeros.
      589     4204         */
      590     4205    2       FIL_SIZE = 36 * (1024 - ACT_REC_LEN);
      591     4206    2       TO$ = FROM$;
      592     4207    2       TO$->FIL = '0'B; /* FILL GAP WITH ZEROS */
      593     4208    2       RETURN;
      594     4209    2   END EXPAND_PAGE;
      595     4210        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:21   
      596     4211        /*
      597     4212           This routine calculates the checksum and compares it to
      598     4213           against the granual stamp. Then replaces the bad
      599     4214           checksum if not correct and prints a message.
      600     4215        */
      601     4216    1   CHECK_SUM: PROC;
      602     4217    2   DCL PAGE CHAR(6);
      603     4218    2   DCL DASH CHAR(1);
      604     4219    2   DCL HIGH_PGE CHAR(10);
      605     4220    2   DCL LOW_PGE CHAR(10);
      606     4221    2   DCL I SBIN WORD;
      607     4222    2   DCL UBIN36 UBIN BASED (DATA$);
      608     4223
      609     4224    2       IF PRINT_CHKS = %YES# THEN
      610     4225    3       DO;
      611     4226    3           CALL BAD_CHK;
      612     4227    3           RETURN;
      613     4228    3           END;
      614     4229    2       ICHKSUM = 0;
      615     4230
      616     4231    2       CALL CHKSUM; /* BMAP - takes checksum stores in ICHKSUM */
      617     4232
      618     4233
      619     4234    2       IF ICHKSUM ~= UBIN36 THEN
      620     4235    3       DO;
      621     4236    3           IF MSG_FLG = %NO# THEN
      622     4237    4           DO;
      623     4238    4               MSG_FLG = %YES#;
      624     4239         /*E* ERROR: ZIU-08101-C
      625     4240                   MESSAGE: Checksum at load is not equal to checksum at dump.
      626     4241                            New checksum substituted for original:
      627     4242                            Condition occurred on the following page(s):    */
      628     4243    4               ERRCODESF.ERR#= 8101;
      629     4244    4               MSGCODE = ERRCODE_RDEF;
      630     4245    4               CALL SYS_FUNC_ERRMSG;
      631     4246    4               CALL BAD_CHK;
      632     4247    4               END;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:22   
      633     4248    3           ELSE
      634     4249    3               CALL BAD_CHK;
      635     4250    3           DATA_PG.CHKSUM_WD = ICHKSUM;
      636     4251    3           END;
      637     4252    2       UBIN36 = RB; /* REPLACE GRANULE STAMP WITH PAGE NUMBER */
      638     4253    2       RETURN;
      639     4254        /*
      640     4255           Print and keep track of bad checksum pages
      641     4256        */
      642     4257    2   BAD_CHK: PROC;
      643     4258
      644     4259    3       IF BAD_CHK_LOW = 0 THEN
      645     4260    4       DO;
      646     4261    4           BAD_CHK_LOW = RB;
      647     4262    4           BAD_CHK_HIGH= RB;
      648     4263    4           RETURN;
      649     4264    4           END;
      650     4265    3       IF RB - BAD_CHK_HIGH > 1 OR PRINT_CHKS THEN
      651     4266    4       DO;
      652     4267    4           PAGE = 'PAGE';
      653     4268    4           DASH = ' ';
      654     4269    4           HIGH_PGE = ' ';
      655     4270    4           CALL BINCHAR(LOW_PGE,BAD_CHK_LOW);
      656     4271    4           CALL ZERO_SUP(LOW_PGE,10,RIGHT_JUSTIFY);
      657     4272    4           IF BAD_CHK_LOW ~= BAD_CHK_HIGH THEN
      658     4273    5           DO;
      659     4274    5               DASH = '-';
      660     4275    5               PAGE = 'PAGES';
      661     4276    5               CALL BINCHAR(HIGH_PGE,BAD_CHK_HIGH);
      662     4277    5               CALL ZERO_SUP(HIGH_PGE,10,LEFT_JUSTIFY);
      663     4278    5               END;
      664     4279    4    /**/   DCBSF = DCBNUM(M$LO);
      665     4280    4    /**/   BUFSF = VECTOR(REPRT);
      666     4281    4    /**/   BUFLNSF = 80;
      667     4282    4    /**/   VFCSF = %NO#;
      668     4283    4           CALL CONCAT(REPRT, '      ',PAGE,LOW_PGE,DASH,HIGH_PGE);
      669     4284    4           CALL SYS_FUNC_WRIT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:23   
      670     4285    4           BAD_CHK_LOW = RB;
      671     4286    4           BAD_CHK_HIGH = RB;
      672     4287    4           END;
      673     4288    3       ELSE
      674     4289    3           BAD_CHK_HIGH = RB;
      675     4290    3       RETURN;
      676     4291    3   END BAD_CHK;
      677     4292    2   END CHECK_SUM;
      678     4293        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:24   
      679     4294        /*------------------------------------------------------------------
      680     4295               S T O R E   M I S S I N G   P A G E S   P R O C
      681     4296        -------------------------------------------------------------------*/
      682     4297    1   ADD_MISSING_PGE: PROC;
      683     4298    2       IF FULL_LOAD THEN
      684     4299    2           STEPCC=11; /* JOB WILL BE M$XXX AFTER LOAD COMPLETES */
      685     4300    2       IF PGE_INDX < 98 THEN
      686     4301    3       DO;
      687     4302    3           IF LOW_RNG(PGE_INDX) = 0 THEN
      688     4303    4           DO;
      689     4304    4               LOW_RNG(PGE_INDX) = RB;
      690     4305    4               HIGH_RNG(PGE_INDX) = RB;
      691     4306    4               END;
      692     4307    4           ELSE DO;
      693     4308    4               IF RB - HIGH_RNG(PGE_INDX) > 1 THEN
      694     4309    5               DO;
      695     4310    5                   PGE_INDX = PGE_INDX + 1;
      696     4311    5                   LOW_RNG(PGE_INDX) = RB;
      697     4312    5                   HIGH_RNG(PGE_INDX) = RB;
      698     4313    5                   END;
      699     4314    4               ELSE
      700     4315    4                   HIGH_RNG(PGE_INDX) = RB;
      701     4316    4               END;
      702     4317    3           END;
      703     4318    3       ELSE DO;
      704     4319    3           CALL PAGE_REPORT;
      705     4320    4           DO PGE_INDX = 0 TO 99;
      706     4321    4               LOW_RNG(PGE_INDX) = 0;
      707     4322    4               HIGH_RNG(PGE_INDX) = 0;
      708     4323    4               END;
      709     4324    3           PGE_INDX = 0;
      710     4325    3           LOW_RNG(0) = RB;
      711     4326    3           HIGH_RNG(0) = RB;
      712     4327    3           END;
      713     4328    2       RETURN;
      714     4329    2   END ADD_MISSING_PGE;
      715     4330        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:25   
      716     4331        /*-----------------------------------------------------------------
      717     4332                      P R I N T    L O A D   R E P O R T
      718     4333        --------------------------------------------------------------------*/
      719     4334    1   LOAD_REPRT: PROC(IDS_FILE);
      720     4335    2   DCL PAGE CHAR(6);
      721     4336    2   DCL DASH CHAR(1);
      722     4337    2   DCL LOW_PGE CHAR(10);
      723     4338    2   DCL HIGH_PGE CHAR(10);
      724     4339    2   DCL IDS_FILE CHAR(3) CALIGNED;
      725     4340
      726     4341    2   /**/ DCBSF = DCBNUM(M$LO);
      727     4342    2   /**/ BUFSF = VECTOR(REPRT);
      728     4343    2   /**/ BUFLNSF = 80;
      729     4344    2       CALL CONCAT(REPRT,'* * * Dump file ',SUBSTR(SRCE_FILE.TEXT,0,SRCE_FILE.CNT),
      730     4345    2          ' loaded to ', IDS_FILE,' file ',DEST_FILE.TEXT);
      731     4346    2   /**/ VFCSF = %NO#;
      732     4347    2       CALL SYS_FUNC_WRIT;
      733     4348    2       CALL CONCAT(REPRT, '      Dump created: ',DUMP_CREATION);
      734     4349    2   /**/ VFCSF = %NO#;
      735     4350    2       CALL SYS_FUNC_WRIT;
      736     4351    2       CALL BINCHAR(HIGH_PGE,PGS_LOAD);
      737     4352    2       CALL ZERO_SUP(HIGH_PGE,10,'1'B);
      738     4353    2       IF IDS_FILE = 'IDS' THEN
      739     4354    2           CALL CONCAT(REPRT,'      Number of pages loaded: ',HIGH_PGE);
      740     4355    2       ELSE
      741     4356    2           CALL CONCAT(REPRT,'      Number of granules loaded: ',HIGH_PGE);
      742     4357    2   /**/ VFCSF = %NO#;
      743     4358    2       CALL SYS_FUNC_WRIT;
      744     4359    2   PAGE_REPORT: ENTRY;
      745     4360        /*
      746     4361           If any of the requested pages were not found in the dump -
      747     4362           check and report any elements in the missing page array.
      748     4363        */
      749     4364    2       IF LOW_RNG(0) ~= 0 THEN
      750     4365    3       DO;
      751     4366         /*E* ERROR: ZIU-08010-C
      752     4367                 MESSAGE: Warning: Following pages were not found in dump file.
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:26   
      753     4368                 */
      754     4369    3           ERRCODESF.ERR# = 8010;
      755     4370    3           MSGCODE = ERRCODE_RDEF;
      756     4371    3           CALL SYS_FUNC_ERRMSG;
      757     4372    4           DO I = 0 TO PGE_INDX;
      758     4373    4               DASH = ' ';
      759     4374    4               HIGH_PGE = ' ';
      760     4375    4               PAGE = 'PAGE';
      761     4376    4               CALL BINCHAR(LOW_PGE,LOW_RNG(I));
      762     4377    4               CALL ZERO_SUP(LOW_PGE,10,RIGHT_JUSTIFY);
      763     4378    4               IF LOW_RNG(I) ~= HIGH_RNG(I) THEN
      764     4379    5               DO;
      765     4380    5                   DASH = '-';
      766     4381    5                   PAGE = 'PAGES';
      767     4382    5                   CALL BINCHAR(HIGH_PGE,HIGH_RNG(I));
      768     4383    5                   CALL ZERO_SUP(HIGH_PGE,10,LEFT_JUSTIFY);
      769     4384    5                   END;
      770     4385    4               CALL CONCAT(REPRT,'            ',PAGE,LOW_PGE,DASH,HIGH_PGE);
      771     4386    4    /**/       DCBSF = DCBNUM(M$LO);
      772     4387    4    /**/       BUFSF = VECTOR(REPRT);
      773     4388    4    /**/       BUFLNSF = 80;
      774     4389    4    /**/       VFCSF = %NO#;
      775     4390    4               CALL SYS_FUNC_WRIT;
      776     4391    4               END;
      777     4392    3           END;
      778     4393    2       PGE_INDX = 0;
      779     4394    2       LOW_RNG(0) = 0;
      780     4395    2       RETURN;
      781     4396    2   END LOAD_REPRT;
      782     4397        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:27   
      783     4398        /*-------------------------------------------------------------------
      784     4399              A S S O C I A T E D   K E Y E D   F I L E    C H E C K
      785     4400        -------------------------------------------------------------------*/
      786     4401    1   LOAD_ASCFID: PROC(FILE_TYPE) ALTRET;
      787     4402
      788     4403    2   DCL FILE_TYPE CHAR(3) CALIGNED;
      789     4404
      790     4405        /*
      791     4406           This procedure is called once it has been established in the
      792     4407           attribute block that an associated keyed file belongs to this
      793     4408           file just dumped. This routine figures out what the name of
      794     4409           the source and destination key file names are (or should be).
      795     4410           Also, this routine makes sure that the source key file can be
      796     4411           opened before calling the key file dump routine.
      797     4412        */
      798     4413    2       I=SRCE_FILE.CNT;
      799     4414    2       I=I+1;
      800     4415    2       IF I > 30 THEN I = 30; /* Only max of 30 char names allowed */
      801     4416    2       CALL INSERT(SRCE_FILE.TEXT,(I-1),1,':');
      802     4417    2       SRCE_FILE.CNT = I;
      803     4418        /*
      804     4419           The source fid should be the area name + ':'.
      805     4420        */
      806     4421    2       I=DEST_FILE.CNT;
      807     4422    2       I=I+1;
      808     4423    2       IF I > 30 THEN I = 30;
      809     4424    2       CALL INSERT(DEST_FILE.TEXT,(I-1),1,':');
      810     4425    2       DEST_FILE.CNT = I;
      811     4426        /*
      812     4427           Now use same dcbs for these two files.
      813     4428        */
      814     4429        /*
      815     4430           Attempt to open the keyed file - if an altreturn condition
      816     4431           occurrs, inform the user you cannot backup the keyed file.
      817     4432        */
      818     4433    2   LOAD_DISK_INDEX: ENTRY(FILE_TYPE) ALTRET;
      819     4434    2   /**/ DCBSF = ZI$DIR.SRCE_NM.DCB#;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:28   
      820     4435    2   /**/ ORGSF = %KEYED#;
      821     4436    2   /**/ TESTSF = %NO#;
      822     4437    2   /**/ ACSSF = %BLOCK#;
      823     4438         /*      DELETE THE FOLLOWING LINES AT C00 RELEASE */
      824     4439         /*        THOSE ARE USED FOR LOADING A00 DUMP OF KEY FILE IN TAPE */
      825     4440    2       IF DCBADDR(SRCEDCB)->F$DCB.ASN#=%TAPE# THEN
      826     4441    2    /**/   ACSSF=%SEQUEN#; /* FOR A00 TAPE DUMP FILES */
      827     4442         /*            TILL     HERE     HERE */
      828     4443    2   /**/ FUNSF = %IN#;
      829     4444    2   /**/ REASGNSF = %NO#;
      830     4445    2   /**/ FIDSF = SRCE_FILE.TEXT;
      831     4446    2   /**/ SHARESF = %IN#;
      832     4447    2       CALL SYS_FUNC_OPEN ALTRET(ALT_OPEN); /* OPEN SOURCE FILE */
      833     4448
      834     4449    2   LOAD_TAPE_INDEX: ENTRY(FILE_TYPE) ALTRET;
      835     4450
      836     4451    2       DESTDCB = ZI$DIR.DEST_NM.DCB#;
      837     4452    2       DCBSF = DESTDCB;
      838     4453    2       ACNT(0)= ' ';
      839     4454    2       FUNSF = %CREATE#; /* WE WILL CREATE A DUMMY DEST FILE */
      840     4455    2       EXISTSF = %NEWFILE#;
      841     4456    2       XTENSIZESF = 1;
      842     4457    2       ORGSF = %CONSEC#;
      843     4458    2       ACSSF = %SEQUEN#;
      844     4459    2       CARRY_ATTRIBUTESF = %NO#;
      845     4460    2       TESTSF = %NO#;
      846     4461    2       REASGNSF = %NO#;
      847     4462    2       FIDSF = DEST_FILE.TEXT;
      848     4463    2       IF FILE_TYPE = 'IND' THEN
      849     4464    3       DO;
      850     4465    3           REASGNSF = %YES#; /* FOR INDEX FILE, LET !SET MERGED */
      851     4466    3           EXISTSF=ZI$DIR.OPEN_MODE; /* TAKE USER'S OPEN_MODE */
      852     4467    3           FIDSF = ZI$DIR.DEST_NM.NAME.TEXT; /* DEFAULT FID */
      853     4468    3           ACNT = ZI$DIR.ACNT;
      854     4469    3           END;
      855     4470    2       CALL SYS_FUNC_OPEN ALTRET(ALT_OPEN);
      856     4471    2       DEST_FILE = DCBADDR(DESTDCB)->F$DCB.NAME#; /* GET ACTUAL FID */
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:29   
      857     4472    2       IF SUBSTR(DEST_FILE.TEXT,0,1)='*' THEN
      858     4473    3       DO;
      859     4474    3           ERRCODESF.ERR# = 10002;
      860     4475    3           MSGCODE = ERRCODE_RDEF;
      861     4476    3           ERRFLGSF = 4; /* CANNOT LOAD TO A STAR FILE */
      862     4477    3           CALL SYS_FUNC_ERRMSG;
      863     4478    3           ALTRETURN;
      864     4479    3           END;
      865     4480    2       CALL SYS_FUNC_RELEASE ALTRET(ALT_OPEN); /* THEN DELETE THE FILE */
      866     4481    2       PGS_LOAD = 1; /* INIT COUNT INCLUDE FIT */
      867     4482    2       ORGSF = %KEYED#;
      868     4483    2       ACSSF = %BLOCK#; /* IN BLOCK MODE */
      869     4484         /*      DELETE FOLLOWING LINES AT C00 RELEASE */
      870     4485    2       IF DCBADDR(SRCEDCB)->F$DCB.ASN#=%TAPE# AND
      871     4486    2          DCBADDR(SRCEDCB)->F$DCB.ORG#=%KEYED# THEN
      872     4487    2    /**/   ACSSF=%SEQUEN#;
      873     4488         /*      TILL  H E R E     R_HERE */
      874     4489    2       FIDSF = DEST_FILE.TEXT;
      875     4490    2       REASGNSF = %NO#; /* NO MORE !SET DCB */
      876     4491    2       TESTSF = %NO#;
      877     4492    2       FUNSF = %CREATE#;
      878     4493    2       EXISTSF = %NEWFILE#;
      879     4494    2       CALL GET_FILESIZE; /* GO GET XTENSIZESF WE NEED */
      880     4495    2       CALL SYS_FUNC_OPEN ALTRET(ALT_OPEN);
      881     4496    2       IF FILE_TYPE='IND' THEN
      882     4497    2           CALL LOADING_MSG; /* NEW START LOADING INDEX AREAS */
      883     4498         /*     DELETE   FOLLOWING LINES AT C00 RELEASE */
      884     4499    2       IF ACSSF~=%BLOCK# THEN /* MUST BE A00 DUMP ON TAPE */
      885     4500    2           CALL PROCESS_A00_LOAD ALTRET(ALTEND);
      886     4501    2       ELSE
      887     4502         /*      TILL     HERE      HERE */
      888     4503    2           CALL PROCESS_KEY_LOAD ALTRET(ALTEND);
      889     4504    2       CALL LOAD_REPRT(FILE_TYPE);
      890     4505    2       RETURN;
      891     4506
      892     4507    2   ALT_OPEN:
      893     4508         /*E* ERROR: ZIU-08006-C
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:30   
      894     4509                  MESSAGE: Unable to open the dump file %FN.  */
      895     4510    2       ERRCODESF.ERR# = 8006;
      896     4511    2       MSGCODE = ERRCODE_RDEF;
      897     4512    2       CALL SYS_FUNC_ERRMSG;
      898     4513    2   ALTEND:
      899     4514    2       ALTRETURN;
      900     4515    2   END LOAD_ASCFID;
      901     4516        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:31   
      902     4517        /*------------------------------------------------------------------
      903     4518             D U M P    K E Y E D    F I L E    F O R   A R E A
      904     4519        ------------------------------------------------------------------*/
      905     4520    1   PROCESS_KEY_LOAD: PROC ALTRET;
      906     4521
      907     4522    2       I_O_INDX = NBUFS;
      908     4523    2       DCBSF = ZI$DIR.SRCE_NM.DCB#;
      909     4524    2       BUFSF = VECTOR(I_O_BUF);
      910     4525    2       BUFLNSF = 4096 * NBUFS;
      911     4526    2       WAITSF = %NO#;
      912     4527    2       CALL SYS_FUNC_READ ALTRET(ALT_LOAD);
      913     4528    3       DO WHILE('1'B);
      914     4529    3           IF BREAK_FLAG > 0 THEN ALTRETURN;
      915     4530    3           DCBSF = SRCEDCB; /* CHECK I-O TYC OF SOURCE DCB */
      916     4531    3           BUFSF = VECTOR(I_O_BUF(I_O_INDX)); /* NEXT BUF TO READ */
      917     4532    3           CALL SYS_FUNC_CHECK ALTRET(ALT_LOAD);
      918     4533    3           X = DCBADDR(SRCEDCB)->F$DCB.ARS#; /* NUMBER BYTES READ */
      919     4534    3           IF X=0 THEN RETURN; /* ONLY WHEN TAPE LOAD */
      920     4535    3           BUFLNSF = NBUFS * 4096;
      921     4536    3           WAITSF = %NO#;
      922     4537    3           CALL SYS_FUNC_READ ALTRET(CHK_ERROR); /* START NXT READ */
      923     4538    3   DONT_CARE:
      924     4539    3           DCBSF = DESTDCB;
      925     4540    3           I_O_INDX = NBUFS - I_O_INDX; /* BUF PTR SWAPPING */
      926     4541    3           BUFLNSF = X; /* BYTES WRITE = BYTES READ */
      927     4542    3           VFCSF = %NO#;
      928     4543    3           BUFSF = VECTOR(I_O_BUF(I_O_INDX));
      929     4544    3           CALL SYS_FUNC_WRIT ALTRET(ALT_LOAD);
      930     4545    3           PGS_LOAD = PGS_LOAD + X/4096;
      931     4546    3           END;
      932     4547
      933     4548    2   CHK_ERROR:
      934     4549    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR#=%E$EOF THEN
      935     4550    2           GOTO DONT_CARE; /* GOT SOMETHING IN THE BUFFER TO PROCESS */
      936     4551    2       ALTRETURN; /* MUST BE IRECOVABLE ERRORS */
      937     4552    2   ALT_LOAD:
      938     4553    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR# = %E$EOF THEN
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:32   
      939     4554    2           RETURN;
      940     4555    2       ELSE
      941     4556    2           ALTRETURN;
      942     4557        /*      DELETE   ALL  PROCESS_A00_LOAD   AT C00 RELEASE */
      943     4558    2   PROCESS_A00_LOAD: ENTRY ALTRET;
      944     4559    2       PGS_LOAD=XTENSIZESF;
      945     4560    2       BUFLNSF=0;
      946     4561    3       DO WHILE ('1'B);
      947     4562    3           DCBSF=SRCEDCB;
      948     4563    3           KEYRSF=%YES#;
      949     4564    3           CALL SYS_FUNC_READ ALTRET(ALT_LOAD);
      950     4565    3           DCBSF=DESTDCB;
      951     4566    3           KEYSF=%YES#;
      952     4567    3           VFCSF=%NO#;
      953     4568    3           CALL SYS_FUNC_WRIT ALTRET(ALT_LOAD);
      954     4569    3           END;
      955     4570    2   END PROCESS_KEY_LOAD;
      956     4571        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:33   
      957     4572        /*------------------------------------------------------------------
      958     4573                  C L O S E    T H E    D C B 'S    P R O C
      959     4574        -------------------------------------------------------------------*/
      960     4575    1   CLOSE_FILES: PROC;
      961     4576    2       DCBSF = ZI$DIR.SRCE_NM.DCB#;
      962     4577    2       IF DCBADDR(DCBSF) -> F$DCB.FCD# = %YES# THEN
      963     4578    3       DO;
      964     4579    3           POSSF = ZI$DIR.POS;
      965     4580    3           CALL SYS_FUNC_CLOS;
      966     4581    3           END;
      967     4582    2       CALL SYS_FUNC_RELDCB;
      968     4583    2       IF ZI$DIR.SRCE_NM.DCB# = ZI$DIR.DEST_NM.DCB# THEN
      969     4584    2           RETURN;
      970     4585    2       DCBSF = ZI$DIR.DEST_NM.DCB#;
      971     4586    2       IF DCBADDR(DCBSF) -> F$DCB.FCD# = %YES# THEN /* DCB is open */
      972     4587    2           CALL SYS_FUNC_CLOS;
      973     4588    2       CALL SYS_FUNC_RELDCB;
      974     4589    2       RETURN;
      975     4590    2   END CLOSE_FILES;
      976     4591        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:34   
      977     4592        /*-----------------------------------------------------------------
      978     4593               POSSIBLE  ALTRETURN  CONDITIONS  FROM  EXTERNAL PROCS
      979     4594        ------------------------------------------------------------------*/
      980     4595    1   ALT_DEST_FILE:
      981     4596         /*E* ERROR: ZIU-08005-C
      982     4597               MESSAGE: Unable to access file %FN - LOAD aborted. */
      983     4598    1       ERRCODESF.ERR# = 8005;
      984     4599    1       MSGCODE = ERRCODE_RDEF;
      985     4600    1       CALL SYS_FUNC_ERRMSG;
      986     4601    1       CALL CLOSE_FILES;
      987     4602    1       ALTRETURN;
      988     4603    1   ALT_SRCE_FILE:
      989     4604         /*E* ERROR: ZIU-08020-C
      990     4605               MESSAGE: Unable to access dump file %FN - LOAD aborted. */
      991     4606    1       ERRCODESF.ERR# = 8020;
      992     4607    1       MSGCODE = ERRCODE_RDEF;
      993     4608    1       CALL SYS_FUNC_ERRMSG;
      994     4609    1       ALTRETURN;
      995     4610    1   ALT_RD_ATBLK:
      996     4611    1       ERRCODESF.ERR# = 1060;
      997     4612    1       MSGCODE = ERRCODE_RDEF;
      998     4613    1       DCBSF = SRCEDCB;
      999     4614    1       CALL SYS_FUNC_ERRMSG;
     1000     4615    1       CALL CLOSE_FILES;
     1001     4616    1       ALTRETURN;
     1002     4617    1   ALT_DUMP_READ:
     1003     4618         /*E* ERROR: ZIU-08030-C
     1004     4619               MESSAGE: Read error at page %U1.
     1005     4620               */
     1006     4621    1       CALL BINCHAR(ERR_INSERT.TEXT(0),RB);
     1007     4622    1       CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,LEFT_JUSTIFY);
     1008     4623    1       ERRCODESF.ERR# = 8030;
     1009     4624    1       MSGCODE = ERRCODE_RDEF;
     1010     4625    1       CALL SYS_FUNC_ERRMSG;
     1011     4626    1       CALL CLOSE_FILES;
     1012     4627    1       ALTRETURN;
     1013     4628    1   ALT_WRIT_DEST:
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:35   
     1014     4629         /*E* ERROR: ZIU-08035-C
     1015     4630               MESSAGE: Monitor write error at page %U1.
     1016     4631               */
     1017     4632    1       CALL BINCHAR(ERR_INSERT.TEXT(0),RB);
     1018     4633    1       CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,LEFT_JUSTIFY);
     1019     4634    1       ERRCODESF.ERR# = 8035;
     1020     4635    1       MSGCODE = ERRCODE_RDEF;
     1021     4636    1       CALL SYS_FUNC_ERRMSG;
     1022     4637    1       CALL CLOSE_FILES;
     1023     4638    1       ALTRETURN;
     1024     4639    1   ALT_TSTAMP:
     1025     4640    1       CALL CLOSE_FILES;
     1026     4641    1       ALTRETURN;
     1027     4642    1   ALT_LOAD_ASC:
     1028     4643         /*E* ERROR: ZIU-08055-C
     1029     4644               MESSAGE: Recommend reloading associated keyed file %U1 by
     1030     4645                        using REBUILD KEYS utility.                   */
     1031     4646    1       ERR_INSERT(0) = DEST_FILE;
     1032     4647    1       ERRCODESF.ERR# = 8055;
     1033     4648    1       MSGCODE = ERRCODE_RDEF;
     1034     4649    1       CALL SYS_FUNC_ERRMSG;
     1035     4650    1       CALL CLOSE_FILES;
     1036     4651    1   ALTRTN: ALTRETURN;
     1037     4652    1   END ZIU$LOAD;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:36   
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$LOAD.

   Procedure ZIU$LOAD requires 1506 words for executable code.
   Procedure ZIU$LOAD requires 78 words of local(AUTO) storage.

    No errors detected in file ZIU$LOAD.:ZIC0TSI    .

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:37   

 Object Unit name= ZIU$LOAD                                   File name= ZIU$LOAD.:ZIC0TOU
 UTS= SEP 05 '97 13:17:39.24 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   206    316  ZIU$LOAD
    1  RoData even  UTS     54     66  ZIU$LOAD
    2   DCB   even  none     0      0  M$UC
    3   DCB   even  none     0      0  M$LO
    4   Proc  even  none  1506   2742  ZIU$LOAD
    5  RoData even  none    44     54  ZIU$LOAD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  ZIU$LOAD
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:38   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 SYS_FUNC_OPEN
 yes     yes           Std       0 SYS_FUNC_READ
 yes     yes           Std       0 CHECK_PAGES
 yes     yes           Std       2 XSF$LOCCODP
 yes     yes           Std       0 BUILD_MSTR_TBL
 yes     yes           Std       0 SYS_FUNC_TSTAMP
 yes     yes           Std       0 SYS_FUNC_CLOS
 yes     yes           Std       0 BUILD_SETXREF
         yes           Std       6 PAGE_RANGE
 yes     yes           Std       0 SYS_FUNC_ERRMSG
 yes     yes           Std       0 BUILD_RECXREF
 yes     yes           Std       0 SYS_FUNC_WRIT
         yes           Std       3 ZERO_SUP
         yes           Std       0 CHKSUM
         yes           Std       3 SHIFT_ARRAY
 yes     yes           Std       0 SYS_FUNC_RELEASE
 yes     yes           Std       0 GET_FILESIZE
 yes     yes           Std       0 SYS_FUNC_CHECK
 yes     yes           Std       0 SYS_FUNC_RELDCB
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:39   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     HIGH_PAGE                             HIGH_DATA_PG                          NUM_INV_PGS
     LPP                                   LOW_DBK                               BUF_PTR
     FILE_INFO                             M$UC                                  TYPE
     MSTR$                                 NXT_MSLOT                             MAX_MSLOT
     MSTR_INDX                             HASHTBL                               HASHINDX
     LOC_MODE                              AREA_KEY$                             NO_AREAS
     GLBL_PTR_SZ                           SET_XREF$                             NXT_SSLOT
     MAX_SSLOT                             REC_XREF$                             NXT_RSLOT
     MAX_RSLOT                             NO_RECS                               NO_SETS
     XREF_BUILT                            TYPESET                               TYPEREC
     ZI$DIR                                SCHEMA_ACTIVE                         RECORD_LIST
     SET_LIST                              RETAIN_LIST                           DUMP_FID
     ALTKY                                 INIT_RG                               KEY_RNG
     ITEM_LIST                             DATA$                                 INVPG$
     ATBLK$                                BLKLSF                                KEYLSF
     KEYXSF                                DCBSF                                 ORGSF
     KEYSF                                 KEYVSF                                ACSSF
     NOTIMESF                              FUNSF                                 ASNSF
     TESTSF                                XTENSIZESF                            DISPSF
     WAITSF                                VFCSF                                 FULLSF
     BKUPSF                                BUFLNSF                               BUFSF
     SOURCESF                              DESTSF                                DATESF
     TIMESF                                UTSSF                                 DAYSF
     TSTAMPSF                              ENCRP_SEEDSF                          ERRCODESF
     MSGCODE                               INCL_ERR                              ERR_INSERT
     FIDSF_RD                              ACNT                                  EXISTSF
     SHARESF                               DCBNMSF                               KEYRSF
     NO_KEYSF                              REASGNSF                              CARRY_ATTRIBUTESF
     SUBMESSF                              SPKY_OPNSF                            POSSF
     ERRFLGSF                              MERGESF                               FSA_FLAG
     RELGSF                                UNUSED                                HELPCODE
     COUNTSF                               INDEXSF                               GAP
     PSNSF                                 ACNTSF                                KEY_SHADWSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:40   
     REC$                                  RB                                    RE
     IE                                    IB                                    CNT
     ICNT                                  RCNT                                  SCNT
     FIRST_SET                             RETCNT                                DMPCNT
     KCNT                                  ACNT_IDX                              I
     J                                     K                                     X
     STEPCC                                I_O_BUF$                              OUT_INDX
     I_O_SIZE                              REC_DATA_LN                           M$LO
     B$TCB$                                B$ROS$                                B$JIT$
     KEYFID                                I_O_KEY                               RESTART
     BREAK_FLAG                            ICHKSUM                               ITMCNT
     GAP1                                  NBUFS

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:41   


        1        1        /*M* ZIU$LOAD - Database restore from Dump routine for DBUTIL */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P* NAME: ZIU$LOAD
        8        8        PURPOSE: To restore a data base dump from a dump file created by
        9        9                 'DBUTIL'. Also to restore an associated key file if one
       10       10                 exists with the area.
       11       11        DESCRIPTION:
       12       12
       13       13                                 DATA BASE LOAD UTILITY
       14       14                                        ZIU$LOAD
       15       15
       16       16
       17       17
       18       18               The  purpose  of the  LOAD  program is  to  decompress and
       19       19               restore  a data  base  dump file  back into  the data base
       20       20               area. In  addition, it is  used to  restore and associated
       21       21               keyed  files  with  the  dump.   For  a  dump  file  to be
       22       22               restored, the area name in  the attribute page of the dump
       23       23               file  must  be  the  same as  the  area  destination  name
       24       24               specified in  the  directive.  This  restriction  helps to
       25       25               avoid accidental over writing of a data base area with the
       26       26               wrong data base dump file. In general, the LOAD program is
       27       27               designed to be  used to reload  certain data base pages or
       28       28               page ranges,  which means the data  base area would not be
       29       29               deleted and  completely over  written. However, a complete
       30       30               restore is permitted if your dump file has a complete data
       31       31               base in it.
       32       32
       33       33               The LOAD  utility may only  be used to  restore dump files
       34       34               created by the data base DUMP utility, and this is checked
       35       35               by the attribute page in  the dump file. It is also in the
       36       36               attribute page where the  existance of an associated keyed
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:42   
       37       37               file is checked.  If an associated  keyed file is supposed
       38       38               to exist, it  is searched  for in the  same account as the
       39       39               area dump  file. If it is  not found, a  warning is issued
       40       40               with the name of the file being searched for, otherwise it
       41       41               is reloaded by  being written out  through the same DCB as
       42       42               the Aarea  file.  Doing  this will serve  to keep the area
       43       43               and  associated keyed file  in the same  account. Also, at
       44       44               the end of the load  operation, if there was an attempt to
       45       45               reload any  pages that did  not exist in  the dump file, a
       46       46               warning is issued  followed by a  page list of the missing
       47       47               page numbers.
       48       48
       49       49                    EX:
       50       50                    In this directive:  DUMP AREA(5-10) OVER DUMP_FILE
       51       51
       52       52                    Only pages 5 thru 10 plus the attribute page are
       53       53                    dumped. If you then do the following:
       54       54                    LOAD DUMP_FILE(5-10) INTO AREA
       55       55
       56       56                    A normal load will occurr, however if you say:
       57       57                    LOAD DUMP_FILE INTO AREA
       58       58
       59       59                    You will recieve a warning that pages 1 thru 4 and
       60       60                    pages 6 thru EOF were not in the dump file.
       61       61
       62       62
       63       63
       64       64                                   PROGRAM OPERATION
       65       65
       66       66
       67       67               This program  essentially workes  like the DUMP utility in
       68       68               reverse. The  source DCB  is opened  using the DCB name as
       69       69               the file name.  Then the actual file  name opened (in case
       70       70               changed by a set command) is taken from the DCB.
       71       71
       72       72               The attribute page of the dump is then checked to see that
       73       73               the area  in the  dump file is  the same  as the area name
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:43   
       74       74               specified in the  directive. The  associated key file flag
       75       75               is checked for  the presence of a  keyed file and the dump
       76       76               ID is checked to  ensure that this  file was a file dumped
       77       77               by the DUMP utility. IN adddition, another flag is checked
       78       78               to see if  this file  consists of a full  or partial dump.
       79       79               If  it's a  partial  dump  then  the  LOAD  directive must
       80       80               specify a load INTO area name (IE. the EXIST parameter for
       81       81               the  monitor  open call  must be  'OLDFILE')  otherwise an
       82       82               error is  reported  and the  load aborted.  If the dump is
       83       83               complete and the 'INTO'  option is not used, then the user
       84       84               must not  specify a page  range or again  an error will be
       85       85               issued and the load  aborted. The idea of course is to not
       86       86               let the user  accidently  create him or  herself a partial
       87       87               data base area. Once these  checks are made, the inventory
       88       88               page  numbers  are  calculated and  the  attribute page is
       89       89               restored and written out to the area file.
       90       90
       91       91               Now the actual load begins.  A page range is recieved from
       92       92               module ZIU$PGRG. One at a  time an attempt is made to read
       93       93               each page in the range from  the dump file. If the page is
       94       94               not there  then the  page  number is given  to the missing
       95       95               page list, otherwise the  page is decompreseed (if it is a
       96       96               data page) and written to the area file. When completed, a
       97       97               report procedure  is called to  report file names and page
       98       98               counts.
       99       99
      100      100
      101      101                                                                          */
      102      102        ZIU$LOAD: PROC ALTRET;

    102  4 000000   000000 700200 xent  ZIU$LOAD     TSX0  ! X66_AUTO_0
         4 000001   000116 000000                    ZERO    78,0
         4 000002   000030 710000 4                  TRA     s:3820

      103      103    1   DCL PGE_INDX SBIN WORD STATIC INIT(0);
      104      104    1   DCL PGS_LOAD SBIN WORD STATIC INIT(0);
      105      105    1   DCL LOW_RNG (0:99) UBIN WORD STATIC INIT(0*100);
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:44   
      106      106    1   DCL HIGH_RNG (0:99) UBIN WORD STATIC INIT(0*100);
      107      107    1   DCL HIGH_PAGE SBIN WORD SYMREF ALIGNED;
      108      108    1   DCL HIGH_DATA_PG SBIN WORD SYMREF ALIGNED;
      109      109    1   DCL NUM_INV_PGS SBIN WORD SYMREF ALIGNED;
      110      110    1   DCL LPP SBIN WORD SYMREF ALIGNED;
      111      111    1   DCL LOW_DBK SBIN WORD SYMREF ALIGNED;
      112      112    1   DCL BUF_PTR SBIN WORD SYMREF ALIGNED;
      113      113    1   DCL DUMP_CREATION CHAR(14);
      114      114    1   DCL FILE_INFO(0:1023) BIT(36) SYMREF ALIGNED;
      115      115    1   DCL FIT$ PTR;
      116      116    1   DCL TSTAMP UBIN;
      117      117    1   DCL RBTEMP UBIN;
      118      118    1   DCL SRCEDCB UBIN HALF;
      119      119    1   DCL DESTDCB UBIN HALF;
      120      120    1   DCL I_O_INDX SBIN WORD;
      121      121    1   DCL 1 SRCE_FILE,
      122      122    1         2 CNT UBIN(9) CALIGNED,
      123      123    1         2 TEXT CHAR(31);
      124      124    1   DCL 1 DEST_FILE,
      125      125    1         2 CNT UBIN(9) CALIGNED,
      126      126    1         2 TEXT CHAR(31);
      127      127    1   DCL FILE_SIZE UBIN;
      128      128    1   DCL REPRT CHAR(80);
      129      129    1   DCL DB_PGNO UBIN WORD BASED(I_O_BUF$);
      130      130
      131      131    1   DCL RIGHT_JUSTIFY BIT(1) CONSTANT INIT('0'B);
      132      132    1   DCL LEFT_JUSTIFY BIT(1) CONSTANT INIT('1'B) UNAL;
      133      133    1   DCL KEY_FILE_ASSOC BIT(1);
      134      134    1   DCL LAST_PAGE BIT(1);
      135      135    1   DCL EXCEEDED_ARRAY BIT(1) STATIC INIT('0'B) UNAL;
      136      136    1   DCL MSG_FLG BIT(1) STATIC INIT('0'B) UNAL;
      137      137    1   DCL CHECKSUM BIT(1) STATIC INIT('0'B) UNAL;
      138      138    1   DCL PRINT_CHKS BIT(1) STATIC INIT('0'B) UNAL;
      139      139    1   DCL BAD_CHK_LOW SBIN;
      140      140    1   DCL BAD_CHK_HIGH SBIN;
      141      141    1   DCL FULL_LOAD BIT(1);
      142      142
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:45   
      143      143        /*
      144      144           includes and macros
      145      145        */
      146      146         %INCLUDE CP_6;
      147      227         %F$DCB;
      148      284         %B$TCB;
      149      287         %B$EXCFR;
      150      305         %INCLUDE CP_6_SUBS;
      151      845         %INCLUDE B_ERRORS_C;
      152     1972         %INCLUDE ZI_ERRORS_SUBS;
      153     2492         %INCLUDE ZI_DBU_XREF;
      154     2659         %XREF_TBLS;
      155     2734         %INCLUDE ZI$DIR;
      156     2891         %DIR;
      157     3035         %INCLUDE ZI$PG_STRUCTS;
      158     3138         %DATA_PG;
      159     3157         %INVTY_PG;
      160     3173         %ATBLK_PG;
      161     3229         %INCLUDE ZI_GLOBAL_DBUTIL;
      162     3407         %SYS_FUNC;
      163     3499         %MISC_DCLS;
      164     3552         %INCLUDE FM$FIT;
      165     3773         %CODE04(BASED="BASED(FIT$)");
      166     3781        /*
      167     3782           Declarations of external subroutines.
      168     3783        */
      169     3784    1   DCL SYS_FUNC_ERRMSG ENTRY ALTRET;
      170     3785    1   DCL SYS_FUNC_GETDCB ENTRY ALTRET;
      171     3786    1   DCL SYS_FUNC_OPEN ENTRY ALTRET;
      172     3787    1   DCL SYS_FUNC_READ ENTRY ALTRET;
      173     3788    1   DCL SYS_FUNC_WRIT ENTRY ALTRET;
      174     3789    1   DCL SYS_FUNC_RELDCB ENTRY ALTRET;
      175     3790    1   DCL SYS_FUNC_CLOS ENTRY ALTRET;
      176     3791    1   DCL SYS_FUNC_CHECK ENTRY ALTRET;
      177     3792    1   DCL SYS_FUNC_TSTAMP ENTRY ALTRET;
      178     3793    1   DCL GET_FILESIZE ENTRY ALTRET;
      179     3794    1   DCL SYS_FUNC_RELEASE ENTRY ALTRET;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:46   
      180     3795    1   DCL NBUFS SBIN SYMREF ALIGNED;
      181     3796    1   DCL PAGE_RANGE ENTRY(6);
      182     3797    1   DCL ZERO_SUP ENTRY(3);
      183     3798    1   DCL CHKSUM ENTRY;
      184     3799    1   DCL BUILD_MSTR_TBL ENTRY ALTRET;
      185     3800    1   DCL BUILD_SETXREF ENTRY ALTRET;
      186     3801    1   DCL BUILD_RECXREF ENTRY ALTRET;
      187     3802    1   DCL CHECK_PAGES ENTRY ALTRET;
      188     3803    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      189     3804        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:47   
      190     3805    1   LOADING_MSG: PROC;

   3805  4 000003   200072 741300       LOADING_MSG  STX1  ! @FILE_TYPE+1,,AUTO

      191     3806    2       REPRT = '..Loading';

   3806  4 000004   040100 100400                    MLR     fill='040'O
         4 000005   000002 000011 1                  ADSC9   LEFT_JUSTIFY+1           cn=0,n=9
         4 000006   200036 000120                    ADSC9   REPRT,,AUTO              cn=0,n=80

      192     3807    2   /**/ DCBSF = DCBNUM(M$LO);

   3807  4 000007   000000 236007 xsym               LDQ     M$LO,DL
         4 000010   000000 620006                    EAX0    0,QL
         4 000011   000000 740000 xsym               STX0    DCBSF

      193     3808    2   /**/ BUFSF = VECTOR(REPRT);

   3808  4 000012   000000 235000 5                  LDA     0
         4 000013   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 000014   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 000015   000036 036003                    ADLQ    30,DU
         4 000016   000000 755000 xsym               STA     BUFSF
         4 000017   000001 756000 xsym               STQ     BUFSF+1

      194     3809    2   /**/ BUFLNSF = 10;

   3809  4 000020   000012 235007                    LDA     10,DL
         4 000021   000000 755000 xsym               STA     BUFLNSF

      195     3810    2   /**/ VFCSF = %NO#;

   3810  4 000022   000000 450000 xsym               STZ     VFCSF

      196     3811    2       CALL SYS_FUNC_WRIT;

   3811  4 000023   000001 631400 5                  EPPR1   1
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:48   
         4 000024   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000025   000000 011000                    NOP     0

      197     3812    2   END LOADING_MSG;

   3812  4 000026   200072 221300                    LDX1  ! @FILE_TYPE+1,,AUTO
         4 000027   000001 702211                    TSX2  ! 1,X1

      198     3813
      199     3814        /*-----------------------------------------------------------------
      200     3815           B E G I N    L O A D   -   CHECK FILES FOR ERRORS
      201     3816        --------------------------------------------------------------------*/
      202     3817        /*
      203     3818           Open source for 'IDS' load - then call routine to check attributes.
      204     3819        */
      205     3820    1       SRCEDCB = ZI$DIR.SRCE_NM.DCB#;

   3820  4 000030   000255 220000 xsym               LDX0    ZI$DIR+173
         4 000031   200012 740100                    STX0    SRCEDCB,,AUTO

      206     3821    1   /**/ DCBSF = SRCEDCB;

   3821  4 000032   000000 740000 xsym               STX0    DCBSF

      207     3822    1   /**/ TESTSF = %NO#;

   3822  4 000033   000000 450000 xsym               STZ     TESTSF

      208     3823    1   /**/ ORGSF = %KEYED#;

   3823  4 000034   000002 235007                    LDA     2,DL
         4 000035   000000 755000 xsym               STA     ORGSF

      209     3824    1   /**/ ACSSF = %DIRECT#;

   3824  4 000036   000000 755000 xsym               STA     ACSSF

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:49   
      210     3825    1   /**/ FUNSF = %IN#;

   3825  4 000037   000000 755000 xsym               STA     FUNSF

      211     3826    1   /**/ SHARESF = %NONE#;

   3826  4 000040   600000 236003                    LDQ     -65536,DU
         4 000041   000000 756000 xsym               STQ     SHARESF

      212     3827    1   /**/ ASNSF = %FILE#;

   3827  4 000042   000001 235007                    LDA     1,DL
         4 000043   000000 755000 xsym               STA     ASNSF

      213     3828    1   /**/ FIDSF = ZI$DIR.SRCE_NM.NAME.TEXT;

   3828  4 000044   040000 100400                    MLR     fill='040'O
         4 000045   000245 200036 xsym               ADSC9   ZI$DIR+165               cn=1,n=30
         4 000046   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

      214     3829    1       CALL SYS_FUNC_OPEN ALTRET(ALT_SRCE_FILE);

   3829  4 000047   000001 631400 5                  EPPR1   1
         4 000050   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 000051   002621 702000 4                  TSX2    ALT_SRCE_FILE

      215     3830    1       SRCE_FILE=DCBADDR(SRCEDCB)->F$DCB.NAME#; /* GET FILE NAME */

   3830  4 000052   000002 470400 5                  LDP0    2
         4 000053   000000 471500                    LDP1    0,,PR0
         4 000054   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 000055   100000 473510                    LDP3    0,X0,PR1
         4 000056   000100 100500                    MLR     fill='000'O
         4 000057   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         4 000060   200015 000040                    ADSC9   SRCE_FILE,,AUTO          cn=0,n=32

      216     3831
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:50   
      217     3832    1       FIT$ = ADDR(FILE_INFO);

   3832  4 000061   000003 236000 5                  LDQ     3
         4 000062   200007 756100                    STQ     FIT$,,AUTO

      218     3833    1       CALL XSF$LOCCODP (FIT$,4) ALTRET(ALTRTN);

   3833  4 000063   000006 236000 5                  LDQ     6
         4 000064   200107 756100                    STQ     HIGH_PGE+5,,AUTO
         4 000065   200007 634500                    EPPR4   FIT$,,AUTO
         4 000066   200106 454500                    STP4    HIGH_PGE+4,,AUTO
         4 000067   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 000070   000004 631400 5                  EPPR1   4
         4 000071   000000 701000 xent               TSX1    XSF$LOCCODP
         4 000072   002741 702000 4                  TSX2    ALTRTN

      219     3834    1       TSTAMP = CODE04.CREATION.TIME;

   3834  4 000073   200007 470500                    LDP0    FIT$,,AUTO
         4 000074   000002 235100                    LDA     2,,PR0
         4 000075   200010 755100                    STA     TSTAMP,,AUTO

      220     3835    1       DUMP_CREATION = ' ';

   3835  4 000076   040100 100400                    MLR     fill='040'O
         4 000077   000007 000001 5                  ADSC9   7                        cn=0,n=1
         4 000100   200003 000016                    ADSC9   DUMP_CREATION,,AUTO      cn=0,n=14

      221     3836    1   /**/ SOURCESF = %UTS#;

   3836  4 000101   000004 236007                    LDQ     4,DL
         4 000102   000000 756000 xsym               STQ     SOURCESF

      222     3837    1   /**/ DESTSF = %LOCAL#;

   3837  4 000103   000003 235007                    LDA     3,DL
         4 000104   000000 755000 xsym               STA     DESTSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:51   

      223     3838    1   /**/ TIMESF = VECTOR(SUBSTR(DUMP_CREATION,0,5));

   3838  4 000105   000010 235000 5                  LDA     8
         4 000106   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 000107   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 000110   000003 036003                    ADLQ    3,DU
         4 000111   000000 755000 xsym               STA     TIMESF
         4 000112   000001 756000 xsym               STQ     TIMESF+1

      224     3839    1   /**/ DATESF = VECTOR(SUBSTR(DUMP_CREATION,6,8));

   3839  4 000113   000011 235000 5                  LDA     9
         4 000114   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 000115   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 000116   000012 036000 5                  ADLQ    10
         4 000117   000000 755000 xsym               STA     DATESF
         4 000120   000001 756000 xsym               STQ     DATESF+1

      225     3840    1   /**/ TSTAMPSF = VECTOR(TSTAMP);

   3840  4 000121   777640 235007                    LDA     -96,DL
         4 000122   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 000123   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 000124   000010 036003                    ADLQ    8,DU
         4 000125   000000 755000 xsym               STA     TSTAMPSF
         4 000126   000001 756000 xsym               STQ     TSTAMPSF+1

      226     3841    1       CALL SYS_FUNC_TSTAMP ALTRET(ALT_TSTAMP);

   3841  4 000127   000001 631400 5                  EPPR1   1
         4 000130   000000 701000 xent               TSX1    SYS_FUNC_TSTAMP
         4 000131   002721 702000 4                  TSX2    ALT_TSTAMP

      227     3842
      228     3843    1       IF DCBADDR(SRCEDCB)->F$DCB.ORG#=%INDEXED# OR

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:52   
   3843  4 000132   000002 470400 5                  LDP0    2
         4 000133   000000 471500                    LDP1    0,,PR0
         4 000134   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 000135   100000 473510                    LDP3    0,X0,PR1
         4 000136   300032 236100                    LDQ     26,,PR3
         4 000137   777000 376003                    ANQ     -512,DU
         4 000140   006000 116003                    CMPQ    3072,DU
         4 000141   000144 600000 4                  TZE     s:3846
         4 000142   022000 116003                    CMPQ    9216,DU
         4 000143   000205 601000 4                  TNZ     s:3866

      229     3844    1          DCBADDR(SRCEDCB)->F$DCB.ORG#=%RESTRICT# THEN
      230     3845    2       DO;

      231     3846    2           IF ZI$DIR.OPEN_MODE=%OLDFILE# THEN

   3846  4 000144   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000145   140000 376003                    ANQ     49152,DU
         4 000146   100000 116003                    CMPQ    32768,DU
         4 000147   000163 601000 4                  TNZ     s:3856

      232     3847        /*E* ERROR: ZIU-10001-C
      233     3848             MESSAGE: The 'INTO' option is not allowed to load indexed files. */
      234     3849    3           DO;

      235     3850    3               ERRCODESF.ERR#=10001;

   3850  4 000150   000000 236000 xsym               LDQ     ERRCODESF
         4 000151   000013 376000 5                  ANQ     11
         4 000152   234210 276007                    ORQ     80008,DL
         4 000153   000000 756000 xsym               STQ     ERRCODESF

      236     3851    3               MSGCODE=ERRCODE_RDEF;

   3851  4 000154   000000 756000 xsym               STQ     MSGCODE

      237     3852    3               CALL SYS_FUNC_ERRMSG;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:53   

   3852  4 000155   000001 631400 5                  EPPR1   1
         4 000156   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 000157   000000 011000                    NOP     0

      238     3853    3               CALL CLOSE_FILES;

   3853  4 000160   002535 701000 4                  TSX1    CLOSE_FILES
         4 000161   000000 011000                    NOP     0

      239     3854    3               ALTRETURN;

   3854  4 000162   000000 702200 xent               TSX2  ! X66_AALT

      240     3855    3               END;
      241     3856    2           IF DCBADDR(SRCEDCB)->F$DCB.ORG#=%INDEXED# THEN

   3856  4 000163   300032 236100                    LDQ     26,,PR3
         4 000164   777000 376003                    ANQ     -512,DU
         4 000165   006000 116003                    CMPQ    3072,DU
         4 000166   000200 601000 4                  TNZ     s:3863

      242     3857    3           DO; /* DUMP FID IS A DISK FILE */

      243     3858    3               DCBSF = SRCEDCB; /* REOPEN WITH BLOCK MODE */

   3858  4 000167   000000 740000 xsym               STX0    DCBSF

      244     3859    3               CALL SYS_FUNC_CLOS ALTRET(ALT_SRCE_FILE);

   3859  4 000170   000001 631400 5                  EPPR1   1
         4 000171   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 000172   002621 702000 4                  TSX2    ALT_SRCE_FILE

      245     3860    3               CALL LOAD_DISK_INDEX('IND') ALTRET(ALT_WRIT_DEST);

   3860  4 000173   000014 236000 5                  LDQ     12
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:54   
         4 000174   200071 756100                    STQ     FULL_LOAD+3,,AUTO
         4 000175   002116 701000 4                  TSX1    LOAD_DISK_INDEX
         4 000176   002674 702000 4                  TSX2    ALT_WRIT_DEST

      246     3861    3               END;

   3861  4 000177   000204 710000 4                  TRA     s:3864

      247     3862    2           ELSE /* DUMP FID IS A TAPE FILE */
      248     3863    2               CALL LOAD_TAPE_INDEX('IND') ALTRET(ALT_WRIT_DEST);

   3863  4 000200   000014 236000 5                  LDQ     12
         4 000201   200071 756100                    STQ     FULL_LOAD+3,,AUTO
         4 000202   002154 701000 4                  TSX1    LOAD_TAPE_INDEX
         4 000203   002674 702000 4                  TSX2    ALT_WRIT_DEST

      249     3864    2           GOTO END_OF_LOAD;

   3864  4 000204   000634 710000 4                  TRA     END_OF_LOAD

      250     3865    2           END;
      251     3866    1       CALL GET_ATBLK(NUM_INV_PGS,HIGH_DATA_PG,HIGH_PAGE)

   3866  4 000205   000016 237000 5                  LDAQ    14
         4 000206   200072 757100                    STAQ    @FILE_TYPE+1,,AUTO
         4 000207   000020 236000 5                  LDQ     16
         4 000210   200071 756100                    STQ     FULL_LOAD+3,,AUTO
         4 000211   000722 701000 4                  TSX1    GET_ATBLK
         4 000212   002632 702000 4                  TSX2    ALT_RD_ATBLK

      252     3867    1          ALTRET(ALT_RD_ATBLK);
      253     3868    1       DESTDCB = ZI$DIR.DEST_NM.DCB#;

   3868  4 000213   000266 220000 xsym               LDX0    ZI$DIR+182
         4 000214   200013 740100                    STX0    DESTDCB,,AUTO

      254     3869    1   /**/ EXISTSF = ZI$DIR.OPEN_MODE;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:55   

   3869  4 000215   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000216   000040 772000                    QRL     32
         4 000217   000003 376007                    ANQ     3,DL
         4 000220   000042 736000                    QLS     34
         4 000221   000000 756000 xsym               STQ     EXISTSF

      255     3870    1   /**/ XTENSIZESF = FILE_SIZE;

   3870  4 000222   200035 235100                    LDA     FILE_SIZE,,AUTO
         4 000223   000000 755000 xsym               STA     XTENSIZESF

      256     3871    1   /**/ BKUPSF = %YES#;

   3871  4 000224   400000 236003                    LDQ     -131072,DU
         4 000225   000000 756000 xsym               STQ     BKUPSF

      257     3872    1   /**/ ACNT = ZI$DIR.ACNT;

   3872  4 000226   000000 100400                    MLR     fill='000'O
         4 000227   000002 400120 xsym               ADSC9   ZI$DIR+2                 cn=2,n=80
         4 000230   000000 000120 xsym               ADSC9   ACNT                     cn=0,n=80

      258     3873    1   /**/ DCBSF = DESTDCB;

   3873  4 000231   000000 740000 xsym               STX0    DCBSF

      259     3874    1   /**/ ORGSF = %IDS#;

   3874  4 000232   000007 235007                    LDA     7,DL
         4 000233   000000 755000 xsym               STA     ORGSF

      260     3875    1   /**/ TESTSF= %NO#;

   3875  4 000234   000000 450000 xsym               STZ     TESTSF

      261     3876    1   /**/ ACSSF = %DIRECT#;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:56   

   3876  4 000235   000002 235007                    LDA     2,DL
         4 000236   000000 755000 xsym               STA     ACSSF

      262     3877    1   /**/ FUNSF = %CREATE#;

   3877  4 000237   000003 235007                    LDA     3,DL
         4 000240   000000 755000 xsym               STA     FUNSF

      263     3878    1   /**/ ASNSF = %FILE#;

   3878  4 000241   000001 235007                    LDA     1,DL
         4 000242   000000 755000 xsym               STA     ASNSF

      264     3879    1   /**/ FIDSF = ZI$DIR.DEST_NM.NAME.TEXT;

   3879  4 000243   040000 100400                    MLR     fill='040'O
         4 000244   000256 200036 xsym               ADSC9   ZI$DIR+174               cn=1,n=30
         4 000245   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

      265     3880    1   /**/ SHARESF = %NONE#;

   3880  4 000246   600000 236003                    LDQ     -65536,DU
         4 000247   000000 756000 xsym               STQ     SHARESF

      266     3881    1       CALL SYS_FUNC_OPEN ALTRET(ALT_DEST_FILE);

   3881  4 000250   000001 631400 5                  EPPR1   1
         4 000251   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 000252   002606 702000 4                  TSX2    ALT_DEST_FILE

      267     3882    1       DEST_FILE = DCBADDR(DESTDCB) -> F$DCB.NAME#;

   3882  4 000253   000002 470400 5                  LDP0    2
         4 000254   000000 471500                    LDP1    0,,PR0
         4 000255   200013 220100                    LDX0    DESTDCB,,AUTO
         4 000256   100000 473510                    LDP3    0,X0,PR1
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:57   
         4 000257   000100 100500                    MLR     fill='000'O
         4 000260   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         4 000261   200025 000040                    ADSC9   DEST_FILE,,AUTO          cn=0,n=32

      268     3883         /**/
      269     3884    1       IF DCBADDR(DESTDCB) -> F$DCB.ORG# ~= %IDS# THEN

   3884  4 000262   300032 236100                    LDQ     26,,PR3
         4 000263   777000 376003                    ANQ     -512,DU
         4 000264   007000 116003                    CMPQ    3584,DU
         4 000265   000301 600000 4                  TZE     s:3898

      270     3885    2       DO;

      271     3886         /*E* ERROR: ZIU-08015-C
      272     3887                  MESSAGE: %FN is not an IDS/INDEXED file - LOAD aborted.
      273     3888                  */
      274     3889    2           ERRCODESF.ERR# = 8015;

   3889  4 000266   000000 236000 xsym               LDQ     ERRCODESF
         4 000267   000013 376000 5                  ANQ     11
         4 000270   175170 276007                    ORQ     64120,DL
         4 000271   000000 756000 xsym               STQ     ERRCODESF

      275     3890    2           MSGCODE = ERRCODE_RDEF;

   3890  4 000272   000000 756000 xsym               STQ     MSGCODE

      276     3891    2           ERRFLGSF = 4;

   3891  4 000273   004000 236003                    LDQ     2048,DU
         4 000274   000000 756000 xsym               STQ     ERRFLGSF

      277     3892    2           CALL SYS_FUNC_ERRMSG;

   3892  4 000275   000001 631400 5                  EPPR1   1
         4 000276   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:58   
         4 000277   000000 011000                    NOP     0

      278     3893    2           ALTRETURN;

   3893  4 000300   000000 702200 xent               TSX2  ! X66_AALT

      279     3894    2           END;
      280     3895         /*
      281     3896            Write out attribute block after restoring dump info.
      282     3897         */
      283     3898    1       CALL WRITE_BUF(1) ALTRET(ALT_WRIT_DEST); /* WRITE 1 PAGE */

   3898  4 000301   000022 236000 5                  LDQ     18
         4 000302   200071 756100                    STQ     FULL_LOAD+3,,AUTO
         4 000303   000665 701000 4                  TSX1    WRITE_BUF
         4 000304   002674 702000 4                  TSX2    ALT_WRIT_DEST

      284     3899    1       PGS_LOAD = 1; /* INCLUDING FIT */

   3899  4 000305   000001 235007                    LDA     1,DL
         4 000306   000001 755000 0                  STA     PGS_LOAD

      285     3900    1       LAST_PAGE = %NO#;

   3900  4 000307   200063 450100                    STZ     LAST_PAGE,,AUTO

      286     3901    1       IF ZI$DIR.CHECK = %YES# THEN

   3901  4 000310   000125 430000 xsym               FSZN    ZI$DIR+85
         4 000311   000355 605000 4                  TPL     s:3916

      287     3902    2       DO;

      288     3903    2           BUF_PTR = 0; /* BUF ADDR STARTING FRO I_O_BUF(0) ALWAYS */

   3903  4 000312   000000 450000 xsym               STZ     BUF_PTR

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:59   
      289     3904    2           IF XREF_BUILT = %NO# THEN

   3904  4 000313   000000 234000 xsym               SZN     XREF_BUILT
         4 000314   000326 604000 4                  TMI     s:3910

      290     3905    3           DO;

      291     3906    3               CALL BUILD_MSTR_TBL ALTRET(ALTRTN);

   3906  4 000315   000001 631400 5                  EPPR1   1
         4 000316   000000 701000 xent               TSX1    BUILD_MSTR_TBL
         4 000317   002741 702000 4                  TSX2    ALTRTN

      292     3907    3               CALL BUILD_SETXREF ALTRET(ALTRTN);

   3907  4 000320   000001 631400 5                  EPPR1   1
         4 000321   000000 701000 xent               TSX1    BUILD_SETXREF
         4 000322   002741 702000 4                  TSX2    ALTRTN

      293     3908    3               CALL BUILD_RECXREF ALTRET(ALTRTN);

   3908  4 000323   000001 631400 5                  EPPR1   1
         4 000324   000000 701000 xent               TSX1    BUILD_RECXREF
         4 000325   002741 702000 4                  TSX2    ALTRTN

      294     3909    3               END;

      295     3910    2           X = 0;

   3910  4 000326   000000 450000 xsym               STZ     X

      296     3911    3           DO WHILE(ZI$DIR.AREA_NM.NAME.TEXT ~= AREA_KEY_XREF.NAME(X));

   3911  4 000327   000000 236000 xsym               LDQ     X
         4 000330   000050 402007                    MPY     40,DL
         4 000331   000000 470400 xsym               LDP0    AREA_KEY$
         4 000332   040106 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:60   
         4 000333   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         4 000334   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         4 000335   000346 600000 4                  TZE     s:3914

      297     3912    3               X = X +1;

   3912  4 000336   000000 054000 xsym               AOS     X

      298     3913    3               END;

   3913  4 000337   000000 236000 xsym               LDQ     X
         4 000340   000050 402007                    MPY     40,DL
         4 000341   000000 470400 xsym               LDP0    AREA_KEY$
         4 000342   040106 106400                    CMPC    fill='040'O
         4 000343   000234 200036 xsym               ADSC9   ZI$DIR+156               cn=1,n=30
         4 000344   000001 400036                    ADSC9   1,Q,PR0                  cn=2,n=30
         4 000345   000336 601000 4                  TNZ     s:3912

      299     3914    2           AREA_KEY_XREF.CHECKED(X) = 1;

   3914  4 000346   000000 236000 xsym               LDQ     X
         4 000347   000012 402007                    MPY     10,DL
         4 000350   000000 620006                    EAX0    0,QL
         4 000351   000011 236106                    LDQ     9,QL,PR0
         4 000352   000023 376000 5                  ANQ     19
         4 000353   000001 276003                    ORQ     1,DU
         4 000354   000011 756110                    STQ     9,X0,PR0

      300     3915    2           END;

      301     3916    1       CALL PAGE_RANGE(RB,RE,32,I_O_SIZE,HIGH_PAGE,LAST_PAGE);

   3916  4 000355   200063 630500                    EPPR0   LAST_PAGE,,AUTO
         4 000356   200113 450500                    STP0    HIGH_PGE+9,,AUTO
         4 000357   000017 236000 5                  LDQ     15
         4 000360   200112 756100                    STQ     HIGH_PGE+8,,AUTO
         4 000361   000026 237000 5                  LDAQ    22
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:61   
         4 000362   200110 757100                    STAQ    HIGH_PGE+6,,AUTO
         4 000363   000030 237000 5                  LDAQ    24
         4 000364   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 000365   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 000366   000024 631400 5                  EPPR1   20
         4 000367   000000 701000 xent               TSX1    PAGE_RANGE
         4 000370   000000 011000                    NOP     0

      302     3917    1       I_O_INDX = -1;

   3917  4 000371   000001 335007                    LCA     1,DL
         4 000372   200014 755100                    STA     I_O_INDX,,AUTO

      303     3918        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:62   
      304     3919        /*-----------------------------------------------------------------
      305     3920                   B E G I N     L O A D    P R O C E D U R E
      306     3921        -------------------------------------------------------------------*/
      307     3922    1       CALL LOADING_MSG; /* OUTPUT ..LOADING MESSAGE */

   3922  4 000373   000003 701000 4                  TSX1    LOADING_MSG
         4 000374   000000 011000                    NOP     0

      308     3923    1       BAD_CHK_LOW=0;

   3923  4 000375   200064 450100                    STZ     BAD_CHK_LOW,,AUTO

      309     3924    2       DO WHILE(~LAST_PAGE);

   3924  4 000376   000563 710000 4                  TRA     s:3985

      310     3925    2           RBTEMP = RB;

   3925  4 000377   000000 235000 xsym               LDA     RB
         4 000400   200011 755100                    STA     RBTEMP,,AUTO

      311     3926    3           DO RB = RB TO RE BY 1;

   3926  4 000401   000522 710000 4                  TRA     s:3970+3

      312     3927    3               IF BREAK_FLAG > 0 THEN

   3927  4 000402   000000 235000 xsym               LDA     BREAK_FLAG
         4 000403   000407 604400 4                  TMOZ    s:3932

      313     3928    4               DO;

      314     3929    4                   CALL CLOSE_FILES;

   3929  4 000404   002535 701000 4                  TSX1    CLOSE_FILES
         4 000405   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:63   
      315     3930    4                   RETURN;

   3930  4 000406   000000 702200 xent               TSX2  ! X66_ARET

      316     3931    4                   END;
      317     3932    3               I_O_INDX = I_O_INDX +1;

   3932  4 000407   200014 054100                    AOS     I_O_INDX,,AUTO

      318     3933    3    /**/       DCBSF = SRCEDCB;

   3933  4 000410   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 000411   000000 740000 xsym               STX0    DCBSF

      319     3934    3    /**/       BUFSF = VECTOR(I_O_BUF(I_O_INDX));

   3934  4 000412   000032 235000 5                  LDA     26
         4 000413   200014 236100                    LDQ     I_O_INDX,,AUTO
         4 000414   000034 736000                    QLS     28
         4 000415   000000 036000 xsym               ADLQ    I_O_BUF$
         4 000416   000000 755000 xsym               STA     BUFSF
         4 000417   000001 756000 xsym               STQ     BUFSF+1

      320     3935    3    /**/       BUFLNSF = 4096 ;

   3935  4 000420   010000 235007                    LDA     4096,DL
         4 000421   000000 755000 xsym               STA     BUFLNSF

      321     3936    3    /**/       FULLSF = %YES#;

   3936  4 000422   400000 236003                    LDQ     -131072,DU
         4 000423   000000 756000 xsym               STQ     FULLSF

      322     3937    3    /**/       ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;

   3937  4 000424   000027 236000 xsym               LDQ     ZI$DIR+23
         4 000425   000000 756000 xsym               STQ     ENCRP_SEEDSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:64   

      323     3938    3    /**/       KEYSF = %YES#;

   3938  4 000426   400000 236003                    LDQ     -131072,DU
         4 000427   000000 756000 xsym               STQ     KEYSF

      324     3939    3    /**/       KEYVSF.LEN = 4; /* Key size */

   3939  4 000430   004000 236003                    LDQ     2048,DU
         4 000431   000000 552040 xsym               STBQ    KEYVSF,'40'O

      325     3940    3    /**/       KEYVSF.IDSKEY = RB;

   3940  4 000432   000000 100400                    MLR     fill='000'O
         4 000433   000000 000004 xsym               ADSC9   RB                       cn=0,n=4
         4 000434   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

      326     3941    3               CALL SYS_FUNC_READ ALTRET(ALT_DUMP_READ);

   3941  4 000435   000001 631400 5                  EPPR1   1
         4 000436   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 000437   002647 702000 4                  TSX2    ALT_DUMP_READ

      327     3942         /*
      328     3943            Check that the required key was there.
      329     3944         */
      330     3945    3               IF NO_KEYSF THEN /* Key does not exist */

   3945  4 000440   000000 234000 xsym               SZN     NO_KEYSF
         4 000441   000474 605000 4                  TPL     s:3963

      331     3946    4               DO;

      332     3947    4                   IF ZI$DIR.CHECK = %YES# THEN

   3947  4 000442   000125 430000 xsym               FSZN    ZI$DIR+85
         4 000443   000456 605000 4                  TPL     s:3956
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:65   

      333     3948    5                   DO;

      334     3949         /*E* ERROR: ZIU-DBU#LDCHK-C
      335     3950                      MESSAGE: Unable to check an incomplete dump file - CHECK canceled. */
      336     3951    5                       ERRCODESF.ERR# = DBU#LDCHK;

   3951  4 000444   000000 236000 xsym               LDQ     ERRCODESF
         4 000445   000013 376000 5                  ANQ     11
         4 000446   215440 276007                    ORQ     72480,DL
         4 000447   000000 756000 xsym               STQ     ERRCODESF

      337     3952    5                       MSGCODE = ERRCODE_RDEF;

   3952  4 000450   000000 756000 xsym               STQ     MSGCODE

      338     3953    5                       CALL SYS_FUNC_ERRMSG;

   3953  4 000451   000001 631400 5                  EPPR1   1
         4 000452   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 000453   000000 011000                    NOP     0

      339     3954    5                       ZI$DIR.CHECK = %NO#;

   3954  4 000454   000033 236000 5                  LDQ     27
         4 000455   000125 356000 xsym               ANSQ    ZI$DIR+85

      340     3955    5                       END;

      341     3956    4                   IF ZI$DIR.NOPRNT='0'B THEN /* Report missing pages optional */

   3956  4 000456   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000457   000400 316003                    CANQ    256,DU
         4 000460   000463 601000 4                  TNZ     s:3958

      342     3957    4                       CALL ADD_MISSING_PGE;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:66   
   3957  4 000461   001467 701000 4                  TSX1    ADD_MISSING_PGE
         4 000462   000000 011000                    NOP     0

      343     3958    4                   IF I_O_INDX > 0 THEN

   3958  4 000463   200014 235100                    LDA     I_O_INDX,,AUTO
         4 000464   000471 604400 4                  TMOZ    s:3960

      344     3959    4                       CALL WRITE_BUF(I_O_INDX) ALTRET(ALT_WRIT_DEST);

   3959  4 000465   200014 630500                    EPPR0   I_O_INDX,,AUTO
         4 000466   200071 450500                    STP0    FULL_LOAD+3,,AUTO
         4 000467   000665 701000 4                  TSX1    WRITE_BUF
         4 000470   002674 702000 4                  TSX2    ALT_WRIT_DEST

      345     3960    4                   I_O_INDX = -1;

   3960  4 000471   000001 335007                    LCA     1,DL
         4 000472   200014 755100                    STA     I_O_INDX,,AUTO

      346     3961    4                   END;

   3961  4 000473   000517 710000 4                  TRA     s:3970

      347     3962    4               ELSE DO;

      348     3963    4                   DATA$ = ADDR(I_O_BUF(I_O_INDX));

   3963  4 000474   200014 236100                    LDQ     I_O_INDX,,AUTO
         4 000475   000034 736000                    QLS     28
         4 000476   000000 036000 xsym               ADLQ    I_O_BUF$
         4 000477   000000 756000 xsym               STQ     DATA$

      349     3964    4                   IF RB <= HIGH_DATA_PG THEN

   3964  4 000500   000000 236000 xsym               LDQ     RB
         4 000501   000506 604000 4                  TMI     s:3966
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:67   
         4 000502   000000 116000 xsym               CMPQ    HIGH_DATA_PG
         4 000503   000506 605400 4                  TPNZ    s:3966

      350     3965    4                       CALL EXPAND_PAGE;

   3965  4 000504   001174 701000 4                  TSX1    EXPAND_PAGE
         4 000505   000000 011000                    NOP     0

      351     3966    4                   IF CHECKSUM AND RB <= HIGH_DATA_PG THEN

   3966  4 000506   000314 234000 0                  SZN     CHECKSUM
         4 000507   000516 605000 4                  TPL     s:3968
         4 000510   000000 236000 xsym               LDQ     RB
         4 000511   000516 604000 4                  TMI     s:3968
         4 000512   000000 116000 xsym               CMPQ    HIGH_DATA_PG
         4 000513   000516 605400 4                  TPNZ    s:3968

      352     3967    4                       CALL CHECK_SUM;

   3967  4 000514   001263 701000 4                  TSX1    CHECK_SUM
         4 000515   000000 011000                    NOP     0

      353     3968    4                   PGS_LOAD = PGS_LOAD + 1;

   3968  4 000516   000001 054000 0                  AOS     PGS_LOAD

      354     3969    4                   END;

      355     3970    3               END;

   3970  4 000517   000000 235000 xsym               LDA     RB
         4 000520   000001 035007                    ADLA    1,DL
         4 000521   000000 755000 xsym               STA     RB
         4 000522   000000 236000 xsym               LDQ     RE
         4 000523   000000 116000 xsym               CMPQ    RB
         4 000524   000402 603000 4                  TRC     s:3927

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:68   
      356     3971         /*
      357     3972            Call write routine after insuring there are pages in the buffer
      358     3973            to be written (ie. the pages in the current page range may
      359     3974            not have been in the dump file.)
      360     3975         */
      361     3976    2           IF I_O_INDX >= 0 THEN

   3976  4 000525   200014 235100                    LDA     I_O_INDX,,AUTO
         4 000526   000545 604000 4                  TMI     s:3983

      362     3977    3           DO;

      363     3978    3               RB = RBTEMP;

   3978  4 000527   200011 235100                    LDA     RBTEMP,,AUTO
         4 000530   000000 755000 xsym               STA     RB

      364     3979    3               IF ZI$DIR.CHECK = %YES# THEN

   3979  4 000531   000125 430000 xsym               FSZN    ZI$DIR+85
         4 000532   000536 605000 4                  TPL     s:3981

      365     3980    3                   CALL CHECK_PAGES;

   3980  4 000533   000001 631400 5                  EPPR1   1
         4 000534   000000 701000 xent               TSX1    CHECK_PAGES
         4 000535   000000 011000                    NOP     0

      366     3981    3               CALL WRITE_BUF(I_O_INDX +1) ALTRET(ALT_WRIT_DEST);

   3981  4 000536   200014 235100                    LDA     I_O_INDX,,AUTO
         4 000537   000001 035007                    ADLA    1,DL
         4 000540   200114 755100                    STA     HIGH_PGE+10,,AUTO
         4 000541   200114 630500                    EPPR0   HIGH_PGE+10,,AUTO
         4 000542   200071 450500                    STP0    FULL_LOAD+3,,AUTO
         4 000543   000665 701000 4                  TSX1    WRITE_BUF
         4 000544   002674 702000 4                  TSX2    ALT_WRIT_DEST
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:69   

      367     3982    3               END;

      368     3983    2           I_O_INDX = -1;

   3983  4 000545   000001 335007                    LCA     1,DL
         4 000546   200014 755100                    STA     I_O_INDX,,AUTO

      369     3984    2           CALL PAGE_RANGE(RB,RE,32,I_O_SIZE,HIGH_PAGE,LAST_PAGE);

   3984  4 000547   200063 630500                    EPPR0   LAST_PAGE,,AUTO
         4 000550   200113 450500                    STP0    HIGH_PGE+9,,AUTO
         4 000551   000017 236000 5                  LDQ     15
         4 000552   200112 756100                    STQ     HIGH_PGE+8,,AUTO
         4 000553   000026 237000 5                  LDAQ    22
         4 000554   200110 757100                    STAQ    HIGH_PGE+6,,AUTO
         4 000555   000030 237000 5                  LDAQ    24
         4 000556   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 000557   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 000560   000024 631400 5                  EPPR1   20
         4 000561   000000 701000 xent               TSX1    PAGE_RANGE
         4 000562   000000 011000                    NOP     0

      370     3985    2           END;

   3985  4 000563   200063 236100                    LDQ     LAST_PAGE,,AUTO
         4 000564   400000 376003                    ANQ     -131072,DU
         4 000565   400000 676003                    ERQ     -131072,DU
         4 000566   000377 601000 4                  TNZ     s:3925

      371     3986        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:70   
      372     3987        /*
      373     3988                   Print any bad checksum pages not yet printed.
      374     3989        */
      375     3990    2       IF CHECKSUM AND MSG_FLG THEN DO;

   3990  4 000567   000314 234000 0                  SZN     CHECKSUM
         4 000570   000604 605000 4                  TPL     s:3998
         4 000571   000313 234000 0                  SZN     MSG_FLG
         4 000572   000604 605000 4                  TPL     s:3998

      376     3991    2           STEPCC=2; /* SET A WARNING STEPCC CODE */

   3991  4 000573   000002 235007                    LDA     2,DL
         4 000574   000000 755000 xsym               STA     STEPCC

      377     3992    2           PRINT_CHKS = %YES#;

   3992  4 000575   400000 236003                    LDQ     -131072,DU
         4 000576   000315 756000 0                  STQ     PRINT_CHKS

      378     3993    2           CALL CHECK_SUM;

   3993  4 000577   001263 701000 4                  TSX1    CHECK_SUM
         4 000600   000000 011000                    NOP     0

      379     3994    2           CHECKSUM = %NO#;

   3994  4 000601   000314 450000 0                  STZ     CHECKSUM

      380     3995    2           MSG_FLG = %NO#; /* Reset checksum flags for nxt load */

   3995  4 000602   000313 450000 0                  STZ     MSG_FLG

      381     3996    2           PRINT_CHKS=%NO#;

   3996  4 000603   000315 450000 0                  STZ     PRINT_CHKS

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:71   
      382     3997    2           END;

      383     3998    1       CALL LOAD_REPRT('IDS');

   3998  4 000604   000034 236000 5                  LDQ     28
         4 000605   200073 756100                    STQ     ARRAY_SIZE+1,,AUTO
         4 000606   001544 701000 4                  TSX1    LOAD_REPRT
         4 000607   000000 011000                    NOP     0

      384     3999        /*
      385     4000           Check for and reload associated key file.
      386     4001        */
      387     4002    1       IF KEY_FILE_ASSOC AND ZI$DIR.NOKEYS = %NO# THEN

   4002  4 000610   200062 234100                    SZN     KEY_FILE_ASSOC,,AUTO
         4 000611   000634 605000 4                  TPL     END_OF_LOAD
         4 000612   000125 236000 xsym               LDQ     ZI$DIR+85
         4 000613   020000 316003                    CANQ    8192,DU
         4 000614   000634 601000 4                  TNZ     END_OF_LOAD

      388     4003    2       DO;

      389     4004    2           POSSF = 0; /* IF TAPE, DONT REWIND OR REMOVE */

   4004  4 000615   000000 450000 xsym               STZ     POSSF

      390     4005    2    /**/   DCBSF = SRCEDCB;

   4005  4 000616   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 000617   000000 740000 xsym               STX0    DCBSF

      391     4006    2           CALL SYS_FUNC_CLOS; /* Close but don't release dcbs */

   4006  4 000620   000001 631400 5                  EPPR1   1
         4 000621   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 000622   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:72   
      392     4007    2    /**/   DCBSF = DESTDCB;

   4007  4 000623   200013 220100                    LDX0    DESTDCB,,AUTO
         4 000624   000000 740000 xsym               STX0    DCBSF

      393     4008    2           CALL SYS_FUNC_CLOS;

   4008  4 000625   000001 631400 5                  EPPR1   1
         4 000626   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 000627   000000 011000                    NOP     0

      394     4009    2           CALL LOAD_ASCFID('KEY') ALTRET(ALT_LOAD_ASC);

   4009  4 000630   000035 236000 5                  LDQ     29
         4 000631   200071 756100                    STQ     FULL_LOAD+3,,AUTO
         4 000632   002056 701000 4                  TSX1    LOAD_ASCFID
         4 000633   002724 702000 4                  TSX2    ALT_LOAD_ASC

      395     4010    2           END;

      396     4011    1   END_OF_LOAD:
      397     4012    1       CALL CLOSE_FILES;

   4012  4 000634   002535 701000 4     END_OF_LOAD  TSX1    CLOSE_FILES
         4 000635   000000 011000                    NOP     0

      398     4013    1       REPRT = '...Load terminated';

   4013  4 000636   040100 100400                    MLR     fill='040'O
         4 000637   000010 000022 1                  ADSC9   LEFT_JUSTIFY+7           cn=0,n=18
         4 000640   200036 000120                    ADSC9   REPRT,,AUTO              cn=0,n=80

      399     4014    1   /**/ DCBSF = DCBNUM(M$LO);

   4014  4 000641   000000 236007 xsym               LDQ     M$LO,DL
         4 000642   000000 620006                    EAX0    0,QL
         4 000643   000000 740000 xsym               STX0    DCBSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:73   

      400     4015    1   /**/ BUFSF = VECTOR(REPRT);

   4015  4 000644   000000 235000 5                  LDA     0
         4 000645   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 000646   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 000647   000036 036003                    ADLQ    30,DU
         4 000650   000000 755000 xsym               STA     BUFSF
         4 000651   000001 756000 xsym               STQ     BUFSF+1

      401     4016    1   /**/ BUFLNSF = 80;

   4016  4 000652   000120 235007                    LDA     80,DL
         4 000653   000000 755000 xsym               STA     BUFLNSF

      402     4017    1   /**/ VFCSF = %NO#;

   4017  4 000654   000000 450000 xsym               STZ     VFCSF

      403     4018    1       CALL SYS_FUNC_WRIT;

   4018  4 000655   000001 631400 5                  EPPR1   1
         4 000656   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000657   000000 011000                    NOP     0

      404     4019    1       IF STEPCC > 9 THEN

   4019  4 000660   000000 235000 xsym               LDA     STEPCC
         4 000661   000011 115007                    CMPA    9,DL
         4 000662   000664 604400 4                  TMOZ    s:4021

      405     4020    1           ALTRETURN; /* DO ALTRET, SO M$XXX TO BE ISSUED BY Q2UT */

   4020  4 000663   000000 702200 xent               TSX2  ! X66_AALT

      406     4021    1       RETURN;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:74   
   4021  4 000664   000000 702200 xent               TSX2  ! X66_ARET

      407     4022        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:75   
      408     4023         /*
      409     4024            WRITE  I_O_BUFFER OUT TO AREA FILE
      410     4025         */
      411     4026    1   WRITE_BUF: PROC(NUM_RECS) ALTRET;

   4026  4 000665   200070 741300       WRITE_BUF    STX1  ! FULL_LOAD+2,,AUTO

      412     4027    2   DCL NUM_RECS UBIN WORD; /* NUM OF RECS BEING WRITTEN */
      413     4028    2   /**/ DCBSF = DESTDCB;

   4028  4 000666   200013 220100                    LDX0    DESTDCB,,AUTO
         4 000667   000000 740000 xsym               STX0    DCBSF

      414     4029    2   /**/ BUFSF = VECTOR(I_O_BUF);

   4029  4 000670   000032 235000 5                  LDA     26
         4 000671   000000 236000 xsym               LDQ     I_O_BUF$
         4 000672   000000 755000 xsym               STA     BUFSF
         4 000673   000001 756000 xsym               STQ     BUFSF+1

      415     4030    2   /**/ BUFLNSF = NUM_RECS * 4096;

   4030  4 000674   200071 470500                    LDP0    @NUM_RECS,,AUTO
         4 000675   000000 235100                    LDA     0,,PR0
         4 000676   000014 735000                    ALS     12
         4 000677   000000 755000 xsym               STA     BUFLNSF

      416     4031    2   /**/ WAITSF = %YES#;

   4031  4 000700   400000 236003                    LDQ     -131072,DU
         4 000701   000000 756000 xsym               STQ     WAITSF

      417     4032    2   /**/ NOTIMESF = %YES#;

   4032  4 000702   000000 756000 xsym               STQ     NOTIMESF

      418     4033    2   /**/ FULLSF = %YES#;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:76   

   4033  4 000703   000000 756000 xsym               STQ     FULLSF

      419     4034    2   /**/ VFCSF = %NO#;

   4034  4 000704   000000 450000 xsym               STZ     VFCSF

      420     4035    2   /**/ ENCRP_SEEDSF = ZI$DIR.DEST_SEED;

   4035  4 000705   000030 236000 xsym               LDQ     ZI$DIR+24
         4 000706   000000 756000 xsym               STQ     ENCRP_SEEDSF

      421     4036    2   /**/ KEYVSF.IDSKEY = DB_PGNO;

   4036  4 000707   000000 471400 xsym               LDP1    I_O_BUF$
         4 000710   000000 100500                    MLR     fill='000'O
         4 000711   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         4 000712   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

      422     4037    2       CALL SYS_FUNC_WRIT ALTRET(ALT_WRIT);

   4037  4 000713   000001 631400 5                  EPPR1   1
         4 000714   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 000715   000720 702000 4                  TSX2    ALT_WRIT

      423     4038    2       RETURN;

   4038  4 000716   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 000717   000001 702211                    TSX2  ! 1,X1

      424     4039    2   ALT_WRIT:
      425     4040    2       ALTRETURN;

   4040  4 000720   200070 221300       ALT_WRIT     LDX1  ! FULL_LOAD+2,,AUTO
         4 000721   000000 702211                    TSX2  ! 0,X1

      426     4041    2   END WRITE_BUF;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:77   
      427     4042        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:78   
      428     4043
      429     4044
      430     4045        /*------------------------------------------------------------------
      431     4046                        GET INVENTORY AND FILE SIZE ATTRIBUTES
      432     4047        -------------------------------------------------------------------*/
      433     4048    1   GET_ATBLK: PROC(INV,DATAPGS,HI_PGE) ALTRET;

   4048  4 000722   200070 741300       GET_ATBLK    STX1  ! FULL_LOAD+2,,AUTO

      434     4049    2   DCL INV SBIN;
      435     4050    2   DCL DATAPGS SBIN;
      436     4051    2   DCL HI_PGE SBIN;
      437     4052
      438     4053    2   DCL 1 DUMP_INFO BASED(ATBLK$) ALIGNED,
      439     4054    2         2 * (0:2) UBIN WORD UNAL,
      440     4055    2         2 ID CHAR(4) UNAL,
      441     4056    2         2 FULL_DUMP BIT(1) UNAL;
      442     4057    2   /**/ DCBSF = SRCEDCB;

   4057  4 000723   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 000724   000000 740000 xsym               STX0    DCBSF

      443     4058    2   /**/ BUFSF = VECTOR(I_O_BUF(0));

   4058  4 000725   000032 235000 5                  LDA     26
         4 000726   000000 236000 xsym               LDQ     I_O_BUF$
         4 000727   000000 755000 xsym               STA     BUFSF
         4 000730   000001 756000 xsym               STQ     BUFSF+1

      444     4059    2   /**/ BUFLNSF = 4096;

   4059  4 000731   010000 235007                    LDA     4096,DL
         4 000732   000000 755000 xsym               STA     BUFLNSF

      445     4060    2   /**/ FULLSF = %YES#;

   4060  4 000733   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:79   
         4 000734   000000 756000 xsym               STQ     FULLSF

      446     4061    2   /**/ ENCRP_SEEDSF = ZI$DIR.ENCP_SEED;

   4061  4 000735   000027 236000 xsym               LDQ     ZI$DIR+23
         4 000736   000000 756000 xsym               STQ     ENCRP_SEEDSF

      447     4062    2   /**/ KEYSF = %YES#;

   4062  4 000737   400000 236003                    LDQ     -131072,DU
         4 000740   000000 756000 xsym               STQ     KEYSF

      448     4063    2   /**/ KEYVSF.LEN= 4;

   4063  4 000741   004000 236003                    LDQ     2048,DU
         4 000742   000000 552040 xsym               STBQ    KEYVSF,'40'O

      449     4064    2   /**/ KEYVSF.IDSKEY = 0;

   4064  4 000743   000000 100400                    MLR     fill='000'O
         4 000744   000001 000004 5                  ADSC9   1                        cn=0,n=4
         4 000745   000000 200004 xsym               ADSC9   KEYVSF                   cn=1,n=4

      450     4065    2       CALL SYS_FUNC_READ ALTRET(ALT_ATBLK);

   4065  4 000746   000001 631400 5                  EPPR1   1
         4 000747   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 000750   001172 702000 4                  TSX2    ALT_ATBLK

      451     4066    2       ATBLK$ = ADDR(I_O_BUF(0));

   4066  4 000751   000000 236000 xsym               LDQ     I_O_BUF$
         4 000752   000000 756000 xsym               STQ     ATBLK$

      452     4067    2       IF ZI$DIR.DEST_NM.NAME.TEXT ~= ATBLK_PG.AREA_NM THEN

   4067  4 000753   000000 470400 xsym               LDP0    ATBLK$
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:80   
         4 000754   040100 106400                    CMPC    fill='040'O
         4 000755   000256 200036 xsym               ADSC9   ZI$DIR+174               cn=1,n=30
         4 000756   000017 000040                    ADSC9   15,,PR0                  cn=0,n=32
         4 000757   000775 600000 4                  TZE     s:4078

      453     4068    3       DO;

      454     4069         /*E* ERROR: ZIU-08090-C
      455     4070                  MESSAGE: Area name "%U1" is not the area in dump file %FN.
      456     4071                  */
      457     4072    3           ERR_INSERT(0) = ZI$DIR.DEST_NM.NAME;

   4072  4 000760   000000 100400                    MLR     fill='000'O
         4 000761   000256 000037 xsym               ADSC9   ZI$DIR+174               cn=0,n=31
         4 000762   000000 000037 xsym               ADSC9   ERR_INSERT               cn=0,n=31

      458     4073    3           ERRCODESF.ERR# = 8090;

   4073  4 000763   000000 236000 xsym               LDQ     ERRCODESF
         4 000764   000013 376000 5                  ANQ     11
         4 000765   176320 276007                    ORQ     64720,DL
         4 000766   000000 756000 xsym               STQ     ERRCODESF

      459     4074    3           MSGCODE = ERRCODE_RDEF;

   4074  4 000767   000000 756000 xsym               STQ     MSGCODE

      460     4075    3           CALL SYS_FUNC_ERRMSG;

   4075  4 000770   000001 631400 5                  EPPR1   1
         4 000771   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 000772   000000 011000                    NOP     0

      461     4076    3           ALTRETURN;

   4076  4 000773   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 000774   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:81   

      462     4077    3           END;
      463     4078    2       IF ATBLK_PG.MISC_INFO.KEY_FILE_BLT THEN

   4078  4 000775   000030 234100                    SZN     24,,PR0
         4 000776   001002 605000 4                  TPL     s:4081

      464     4079    2           KEY_FILE_ASSOC = %YES#;

   4079  4 000777   400000 236003                    LDQ     -131072,DU
         4 001000   200062 756100                    STQ     KEY_FILE_ASSOC,,AUTO
         4 001001   001003 710000 4                  TRA     s:4082

      465     4080    2       ELSE
      466     4081    2           KEY_FILE_ASSOC = %NO#;

   4081  4 001002   200062 450100                    STZ     KEY_FILE_ASSOC,,AUTO

      467     4082    2       IF ATBLK_PG.MISC_INFO.CHKSM = %YES# THEN

   4082  4 001003   000030 236100                    LDQ     24,,PR0
         4 001004   200000 316003                    CANQ    65536,DU
         4 001005   001011 600000 4                  TZE     s:4085

      468     4083    2           CHECKSUM = %YES#;

   4083  4 001006   400000 236003                    LDQ     -131072,DU
         4 001007   000314 756000 0                  STQ     CHECKSUM
         4 001010   001012 710000 4                  TRA     s:4086

      469     4084    2       ELSE
      470     4085    2           CHECKSUM = %NO#;

   4085  4 001011   000314 450000 0                  STZ     CHECKSUM

      471     4086    2       FILE_SIZE = ATBLK_PG.NUM_DBPG + 1;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:82   
   4086  4 001012   000005 235100                    LDA     5,,PR0
         4 001013   000001 035007                    ADLA    1,DL
         4 001014   200035 755100                    STA     FILE_SIZE,,AUTO

      472     4087        /*
      473     4088           Check to see that this is an 'IDS' dump.
      474     4089        */
      475     4090    2       IF DUMP_INFO.ID ~= 'DUMP' THEN

   4090  4 001015   000003 236100                    LDQ     3,,PR0
         4 001016   000015 116000 1                  CMPQ    LEFT_JUSTIFY+12
         4 001017   001034 600000 4                  TZE     s:4102

      476     4091    3       DO;

      477     4092         /*E* ERROR: ZIU-08025-C
      478     4093                  MESSAGE: File %FN is not an IDS dump file or
      479     4094                           was not dumped by DBUTIL - LOAD aborted.
      480     4095                  */
      481     4096    3           ERRFLGSF = 4;

   4096  4 001020   004000 236003                    LDQ     2048,DU
         4 001021   000000 756000 xsym               STQ     ERRFLGSF

      482     4097    3           ERRCODESF.ERR# = 8025;

   4097  4 001022   000000 236000 xsym               LDQ     ERRCODESF
         4 001023   000013 376000 5                  ANQ     11
         4 001024   175310 276007                    ORQ     64200,DL
         4 001025   000000 756000 xsym               STQ     ERRCODESF

      483     4098    3           MSGCODE = ERRCODE_RDEF;

   4098  4 001026   000000 756000 xsym               STQ     MSGCODE

      484     4099    3           CALL SYS_FUNC_ERRMSG;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:83   
   4099  4 001027   000001 631400 5                  EPPR1   1
         4 001030   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001031   000000 011000                    NOP     0

      485     4100    3           ALTRETURN;

   4100  4 001032   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001033   000000 702211                    TSX2  ! 0,X1

      486     4101    3           END;
      487     4102    2       IF DUMP_INFO.FULL_DUMP = %YES# THEN

   4102  4 001034   000004 234100                    SZN     4,,PR0
         4 001035   001041 605000 4                  TPL     s:4107

      488     4103    3       DO; /* This code needed to stay compat with A00 */

      489     4104    3           ATBLK_PG.STATUS.FULL_DUMP = %YES#;

   4104  4 001036   010000 236003                    LDQ     4096,DU
         4 001037   000041 256100                    ORSQ    33,,PR0

      490     4105    3           DUMP_INFO.FULL_DUMP = '0'B;

   4105  4 001040   000004 450100                    STZ     4,,PR0

      491     4106    3           END;

      492     4107    2       IF ATBLK_PG.STATUS.FULL_DUMP = %NO# AND ZI$DIR.OPEN_MODE ~= %OLDFILE#

   4107  4 001041   000041 236100                    LDQ     33,,PR0
         4 001042   010000 316003                    CANQ    4096,DU
         4 001043   001062 601000 4                  TNZ     s:4119
         4 001044   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001045   140000 376003                    ANQ     49152,DU
         4 001046   100000 116003                    CMPQ    32768,DU
         4 001047   001062 600000 4                  TZE     s:4119
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:84   

      493     4108    3       THEN DO;

      494     4109         /*E* ERROR: ZIU-08060-C
      495     4110                   MESSAGE: ON and OVER options are not permitted while
      496     4111                            loading from a partial dump file. (i.e. Date or
      497     4112                            page range options specified at dump time.)
      498     4113                   */
      499     4114    3           ERRCODESF.ERR# = 8060;

   4114  4 001050   000000 236000 xsym               LDQ     ERRCODESF
         4 001051   000013 376000 5                  ANQ     11
         4 001052   175740 276007                    ORQ     64480,DL
         4 001053   000000 756000 xsym               STQ     ERRCODESF

      500     4115    3           MSGCODE = ERRCODE_RDEF;

   4115  4 001054   000000 756000 xsym               STQ     MSGCODE

      501     4116    3           CALL SYS_FUNC_ERRMSG;

   4116  4 001055   000001 631400 5                  EPPR1   1
         4 001056   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001057   000000 011000                    NOP     0

      502     4117    3           ALTRETURN;

   4117  4 001060   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001061   000000 702211                    TSX2  ! 0,X1

      503     4118    3           END;
      504     4119    2       IF ZI$DIR.RNG_LIST AND ZI$DIR.OPEN_MODE ~= %OLDFILE# THEN

   4119  4 001062   000000 234000 xsym               SZN     ZI$DIR
         4 001063   001102 605000 4                  TPL     s:4132
         4 001064   000125 236000 xsym               LDQ     ZI$DIR+85
         4 001065   140000 376003                    ANQ     49152,DU
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:85   
         4 001066   100000 116003                    CMPQ    32768,DU
         4 001067   001102 600000 4                  TZE     s:4132

      505     4120    3       DO;

      506     4121         /*E* ERROR: ZIU-08080-C
      507     4122                  MESSAGE: ON and OVER options not permitted with partial load.
      508     4123                  */
      509     4124    3           ERRCODESF.ERR# = 8080;

   4124  4 001070   000000 236000 xsym               LDQ     ERRCODESF
         4 001071   000013 376000 5                  ANQ     11
         4 001072   176200 276007                    ORQ     64640,DL
         4 001073   000000 756000 xsym               STQ     ERRCODESF

      510     4125    3           MSGCODE = ERRCODE_RDEF;

   4125  4 001074   000000 756000 xsym               STQ     MSGCODE

      511     4126    3           CALL SYS_FUNC_ERRMSG;

   4126  4 001075   000001 631400 5                  EPPR1   1
         4 001076   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001077   000000 011000                    NOP     0

      512     4127    3           ALTRETURN;

   4127  4 001100   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001101   000000 702211                    TSX2  ! 0,X1

      513     4128    3           END;
      514     4129        /*
      515     4130           Calculate inventory pages and number of data pages.
      516     4131        */
      517     4132    2       IF ATBLK_PG.FIR_INV_PGNO = 0 THEN

   4132  4 001102   000014 235100                    LDA     12,,PR0
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:86   
         4 001103   001114 601000 4                  TNZ     s:4139

      518     4133    3       DO;

      519     4134    3           HI_PGE = ATBLK_PG.NUM_DBPG;

   4134  4 001104   000005 235100                    LDA     5,,PR0
         4 001105   200073 471500                    LDP1    @HI_PGE,,AUTO
         4 001106   100000 755100                    STA     0,,PR1

      520     4135    3           DATAPGS = HI_PGE;

   4135  4 001107   200072 470500                    LDP0    @DATAPGS,,AUTO
         4 001110   000000 755100                    STA     0,,PR0

      521     4136    3           INV = 0;

   4136  4 001111   200071 473500                    LDP3    @INV,,AUTO
         4 001112   300000 450100                    STZ     0,,PR3

      522     4137    3           END;

   4137  4 001113   001132 710000 4                  TRA     s:4143

      523     4138    3       ELSE DO;

      524     4139    3           INV= ATBLK_PG.NUM_DBPG - ATBLK_PG.FIR_INV_PGNO + 1;

   4139  4 001114   000005 236100                    LDQ     5,,PR0
         4 001115   000014 136100                    SBLQ    12,,PR0
         4 001116   000001 036007                    ADLQ    1,DL
         4 001117   200071 471500                    LDP1    @INV,,AUTO
         4 001120   100000 756100                    STQ     0,,PR1

      525     4140    3           DATAPGS = ATBLK_PG.NUM_DBPG - INV;

   4140  4 001121   000000 470400 xsym               LDP0    ATBLK$
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:87   
         4 001122   000005 236100                    LDQ     5,,PR0
         4 001123   100000 136100                    SBLQ    0,,PR1
         4 001124   200072 473500                    LDP3    @DATAPGS,,AUTO
         4 001125   300000 756100                    STQ     0,,PR3

      526     4141    3           HI_PGE = ATBLK_PG.NUM_DBPG;

   4141  4 001126   000000 470400 xsym               LDP0    ATBLK$
         4 001127   000005 235100                    LDA     5,,PR0
         4 001130   200073 474500                    LDP4    @HI_PGE,,AUTO
         4 001131   400000 755100                    STA     0,,PR4

      527     4142    3           END;

      528     4143    2       IF ATBLK_PG.STATUS.FULL_DUMP = %NO# THEN

   4143  4 001132   000000 470400 xsym               LDP0    ATBLK$
         4 001133   000041 236100                    LDQ     33,,PR0
         4 001134   010000 316003                    CANQ    4096,DU
         4 001135   001140 601000 4                  TNZ     s:4145

      529     4144    2           ZI$DIR.NOKEYS = %YES#; /* Don't restore keys on partial load */

   4144  4 001136   020000 236003                    LDQ     8192,DU
         4 001137   000125 256000 xsym               ORSQ    ZI$DIR+85

      530     4145    2       FULL_LOAD=ATBLK_PG.STATUS.FULL_DUMP; /* REMEMBER TYPE OF LOAD */

   4145  4 001140   000041 236100                    LDQ     33,,PR0
         4 001141   000005 736000                    QLS     5
         4 001142   400000 376003                    ANQ     -131072,DU
         4 001143   200066 756100                    STQ     FULL_LOAD,,AUTO

      531     4146    2       ATBLK_PG.STATUS.FULL_DUMP = '0'B; /* Reset dump bit */

   4146  4 001144   000036 236000 5                  LDQ     30
         4 001145   000041 356100                    ANSQ    33,,PR0
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:88   

      532     4147    2       DUMP_INFO.ID = 'IDS2';

   4147  4 001146   000016 236000 1                  LDQ     LEFT_JUSTIFY+13
         4 001147   000003 756100                    STQ     3,,PR0

      533     4148    2       IF CHECKSUM = %YES# THEN

   4148  4 001150   000314 234000 0                  SZN     CHECKSUM
         4 001151   001163 605000 4                  TPL     s:4156

      534     4149    3       DO;

      535     4150    3           DATA$ = ATBLK$;

   4150  4 001152   000000 236000 xsym               LDQ     ATBLK$
         4 001153   000000 756000 xsym               STQ     DATA$

      536     4151    3           ICHKSUM = 0;

   4151  4 001154   000000 450000 xsym               STZ     ICHKSUM

      537     4152    3           CALL CHKSUM;

   4152  4 001155   000001 631400 5                  EPPR1   1
         4 001156   000000 701000 xent               TSX1    CHKSUM
         4 001157   000000 011000                    NOP     0

      538     4153    3           ATBLK_PG.CHKSUM_WD = ICHKSUM_BIT;

   4153  4 001160   000000 236000 xsym               LDQ     ICHKSUM
         4 001161   000000 470400 xsym               LDP0    ATBLK$
         4 001162   000002 756100                    STQ     2,,PR0

      539     4154    3           END;

      540     4155
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:89   
      541     4156    2       LOW_DBK = ATBLK_PG.LOW_DBK;

   4156  4 001163   000015 235100                    LDA     13,,PR0
         4 001164   000000 755000 xsym               STA     LOW_DBK

      542     4157    2       LPP = ATBLK_PG.LINE_INFO.LPP;

   4157  4 001165   000012 236100                    LDQ     10,,PR0
         4 001166   777777 376007                    ANQ     -1,DL
         4 001167   000000 756000 xsym               STQ     LPP

      543     4158    2       RETURN;

   4158  4 001170   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001171   000001 702211                    TSX2  ! 1,X1

      544     4159
      545     4160    2   ALT_ATBLK:
      546     4161    2       ALTRETURN;

   4161  4 001172   200070 221300       ALT_ATBLK    LDX1  ! FULL_LOAD+2,,AUTO
         4 001173   000000 702211                    TSX2  ! 0,X1

      547     4162    2   END GET_ATBLK;
      548     4163        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:90   
      549     4164        /*-----------------------------------------------------------------
      550     4165                   E X P A N D    P A G E    P R O C
      551     4166        --------------------------------------------------------------------*/
      552     4167    1   EXPAND_PAGE: PROC;

   4167  4 001174   200070 741300       EXPAND_PAGE  STX1  ! FULL_LOAD+2,,AUTO

      553     4168    2   DCL HIGH_LINE UBIN;
      554     4169    2   DCL ARRAY_SIZE UBIN;
      555     4170    2   DCL ARRAY_INDX UBIN;
      556     4171    2   DCL ACT_REC_LEN UBIN;
      557     4172    2   DCL FROM$ PTR;
      558     4173    2   DCL FROMSTR BASED(FROM$) CHAR(ARRAY_SIZE);
      559     4174    2   DCL TO$ PTR;
      560     4175    2   DCL TOSTR BASED(TO$) CHAR(ARRAY_SIZE);
      561     4176    2   DCL FIL BIT(FIL_SIZE) BASED UNAL;
      562     4177    2   DCL FIL_SIZE UBIN;
      563     4178    2   DCL SHIFT_ARRAY ENTRY(3);
      564     4179    2   DCL I_O_BUFF (0:1023) UBIN WORD BASED(DATA$);
      565     4180        /*
      566     4181           This routine takes the offset array in the compressed record
      567     4182           and moves it out to the end of the record. It then fills in
      568     4183           the created space with zeros.
      569     4184        */
      570     4185    2       HIGH_LINE = DATA_PG.OFF_LN.SEC;

   4185  4 001175   000000 470400 xsym               LDP0    DATA$
         4 001176   000005 236100                    LDQ     5,,PR0
         4 001177   777777 376007                    ANQ     -1,DL
         4 001200   200071 756100                    STQ     HIGH_LINE,,AUTO

      571     4186    2       ARRAY_SIZE = (HIGH_LINE/2)+1;

   4186  4 001201   000001 772000                    QRL     1
         4 001202   000001 036007                    ADLQ    1,DL
         4 001203   200072 756100                    STQ     ARRAY_SIZE,,AUTO

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:91   
      572     4187    2       ACT_REC_LEN = (DCBADDR(SRCEDCB)->F$DCB.ARS#)/4;

   4187  4 001204   000002 471400 5                  LDP1    2
         4 001205   100000 473500                    LDP3    0,,PR1
         4 001206   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 001207   300000 474510                    LDP4    0,X0,PR3
         4 001210   400000 236100                    LDQ     0,,PR4
         4 001211   000004 506007                    DIV     4,DL
         4 001212   200074 756100                    STQ     ACT_REC_LEN,,AUTO

      573     4188        /*
      574     4189           We now have the number of elements in the offset array (high_line)
      575     4190           - it's size in words and the actual record(compressed) size.
      576     4191        */
      577     4192    2       IF ACT_REC_LEN = 1024 THEN

   4192  4 001213   002000 116007                    CMPQ    1024,DL
         4 001214   001216 601000 4                  TNZ     s:4197

      578     4193    2           RETURN; /* Page was never compressed - no need to decompress*/

   4193  4 001215   000001 702211                    TSX2  ! 1,X1

      579     4194        /*
      580     4195               Find position in record where array should start and move it
      581     4196        */
      582     4197    2       ARRAY_INDX = 1024 - ARRAY_SIZE;

   4197  4 001216   002000 235007                    LDA     1024,DL
         4 001217   200072 135100                    SBLA    ARRAY_SIZE,,AUTO
         4 001220   200073 755100                    STA     ARRAY_INDX,,AUTO

      583     4198    2       TO$ = ADDR(I_O_BUFF(ARRAY_INDX));

   4198  4 001221   200073 236100                    LDQ     ARRAY_INDX,,AUTO
         4 001222   000022 736000                    QLS     18
         4 001223   000000 036000 xsym               ADLQ    DATA$
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:92   
         4 001224   200076 756100                    STQ     TO$,,AUTO

      584     4199    2       FROM$ = ADDR(I_O_BUFF(ACT_REC_LEN - ARRAY_SIZE));

   4199  4 001225   200074 236100                    LDQ     ACT_REC_LEN,,AUTO
         4 001226   200072 136100                    SBLQ    ARRAY_SIZE,,AUTO
         4 001227   000022 736000                    QLS     18
         4 001230   000000 036000 xsym               ADLQ    DATA$
         4 001231   200075 756100                    STQ     FROM$,,AUTO

      585     4200    2       ARRAY_SIZE = ARRAY_SIZE *4; /* Convert to character length */

   4200  4 001232   200072 235100                    LDA     ARRAY_SIZE,,AUTO
         4 001233   000002 735000                    ALS     2
         4 001234   200072 755100                    STA     ARRAY_SIZE,,AUTO

      586     4201    2       CALL SHIFT_ARRAY(FROMSTR,TOSTR,ARRAY_SIZE);/* BMAP routine using MRL */

   4201  4 001235   200072 635500                    EPPR5   ARRAY_SIZE,,AUTO
         4 001236   200110 455500                    STP5    HIGH_PGE+6,,AUTO
         4 001237   200076 236100                    LDQ     TO$,,AUTO
         4 001240   200075 235100                    LDA     FROM$,,AUTO
         4 001241   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 001242   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 001243   000037 631400 5                  EPPR1   31
         4 001244   000000 701000 xent               TSX1    SHIFT_ARRAY
         4 001245   000000 011000                    NOP     0

      587     4202         /*
      588     4203            Fill in gap with zeros.
      589     4204         */
      590     4205    2       FIL_SIZE = 36 * (1024 - ACT_REC_LEN);

   4205  4 001246   002000 236007                    LDQ     1024,DL
         4 001247   200074 136100                    SBLQ    ACT_REC_LEN,,AUTO
         4 001250   000044 402007                    MPY     36,DL
         4 001251   200077 756100                    STQ     FIL_SIZE,,AUTO
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:93   

      591     4206    2       TO$ = FROM$;

   4206  4 001252   200075 236100                    LDQ     FROM$,,AUTO
         4 001253   200076 756100                    STQ     TO$,,AUTO

      592     4207    2       TO$->FIL = '0'B; /* FILL GAP WITH ZEROS */

   4207  4 001254   200076 470500                    LDP0    TO$,,AUTO
         4 001255   200077 720100                    LXL0    FIL_SIZE,,AUTO
         4 001256   003140 060400                    CSL     bolr='003'O
         4 001257   000001 000001 5                  BDSC    1                        by=0,bit=0,n=1
         4 001260   000000 000010                    BDSC    0,,PR0                   by=0,bit=0,n=*X0

      593     4208    2       RETURN;

   4208  4 001261   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001262   000001 702211                    TSX2  ! 1,X1

      594     4209    2   END EXPAND_PAGE;
      595     4210        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:94   
      596     4211        /*
      597     4212           This routine calculates the checksum and compares it to
      598     4213           against the granual stamp. Then replaces the bad
      599     4214           checksum if not correct and prints a message.
      600     4215        */
      601     4216    1   CHECK_SUM: PROC;

   4216  4 001263   200070 741300       CHECK_SUM    STX1  ! FULL_LOAD+2,,AUTO

      602     4217    2   DCL PAGE CHAR(6);
      603     4218    2   DCL DASH CHAR(1);
      604     4219    2   DCL HIGH_PGE CHAR(10);
      605     4220    2   DCL LOW_PGE CHAR(10);
      606     4221    2   DCL I SBIN WORD;
      607     4222    2   DCL UBIN36 UBIN BASED (DATA$);
      608     4223
      609     4224    2       IF PRINT_CHKS = %YES# THEN

   4224  4 001264   000315 234000 0                  SZN     PRINT_CHKS
         4 001265   001272 605000 4                  TPL     s:4229

      610     4225    3       DO;

      611     4226    3           CALL BAD_CHK;

   4226  4 001266   001332 701000 4                  TSX1    BAD_CHK
         4 001267   000000 011000                    NOP     0

      612     4227    3           RETURN;

   4227  4 001270   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001271   000001 702211                    TSX2  ! 1,X1

      613     4228    3           END;
      614     4229    2       ICHKSUM = 0;

   4229  4 001272   000000 450000 xsym               STZ     ICHKSUM
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:95   

      615     4230
      616     4231    2       CALL CHKSUM; /* BMAP - takes checksum stores in ICHKSUM */

   4231  4 001273   000001 631400 5                  EPPR1   1
         4 001274   000000 701000 xent               TSX1    CHKSUM
         4 001275   000000 011000                    NOP     0

      617     4232
      618     4233
      619     4234    2       IF ICHKSUM ~= UBIN36 THEN

   4234  4 001276   000000 470400 xsym               LDP0    DATA$
         4 001277   000000 236000 xsym               LDQ     ICHKSUM
         4 001300   000000 116100                    CMPQ    0,,PR0
         4 001301   001326 600000 4                  TZE     s:4252

      620     4235    3       DO;

      621     4236    3           IF MSG_FLG = %NO# THEN

   4236  4 001302   000313 234000 0                  SZN     MSG_FLG
         4 001303   001321 604000 4                  TMI     s:4249

      622     4237    4           DO;

      623     4238    4               MSG_FLG = %YES#;

   4238  4 001304   400000 236003                    LDQ     -131072,DU
         4 001305   000313 756000 0                  STQ     MSG_FLG

      624     4239         /*E* ERROR: ZIU-08101-C
      625     4240                   MESSAGE: Checksum at load is not equal to checksum at dump.
      626     4241                            New checksum substituted for original:
      627     4242                            Condition occurred on the following page(s):    */
      628     4243    4               ERRCODESF.ERR#= 8101;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:96   
   4243  4 001306   000000 236000 xsym               LDQ     ERRCODESF
         4 001307   000013 376000 5                  ANQ     11
         4 001310   176450 276007                    ORQ     64808,DL
         4 001311   000000 756000 xsym               STQ     ERRCODESF

      629     4244    4               MSGCODE = ERRCODE_RDEF;

   4244  4 001312   000000 756000 xsym               STQ     MSGCODE

      630     4245    4               CALL SYS_FUNC_ERRMSG;

   4245  4 001313   000001 631400 5                  EPPR1   1
         4 001314   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001315   000000 011000                    NOP     0

      631     4246    4               CALL BAD_CHK;

   4246  4 001316   001332 701000 4                  TSX1    BAD_CHK
         4 001317   000000 011000                    NOP     0

      632     4247    4               END;

   4247  4 001320   001323 710000 4                  TRA     s:4250

      633     4248    3           ELSE
      634     4249    3               CALL BAD_CHK;

   4249  4 001321   001332 701000 4                  TSX1    BAD_CHK
         4 001322   000000 011000                    NOP     0

      635     4250    3           DATA_PG.CHKSUM_WD = ICHKSUM;

   4250  4 001323   000000 470400 xsym               LDP0    DATA$
         4 001324   000000 235000 xsym               LDA     ICHKSUM
         4 001325   000002 755100                    STA     2,,PR0

      636     4251    3           END;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:97   

      637     4252    2       UBIN36 = RB; /* REPLACE GRANULE STAMP WITH PAGE NUMBER */

   4252  4 001326   000000 235000 xsym               LDA     RB
         4 001327   000000 755100                    STA     0,,PR0

      638     4253    2       RETURN;

   4253  4 001330   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001331   000001 702211                    TSX2  ! 1,X1

      639     4254        /*
      640     4255           Print and keep track of bad checksum pages
      641     4256        */
      642     4257    2   BAD_CHK: PROC;

   4257  4 001332   200104 741300       BAD_CHK      STX1  ! HIGH_PGE+2,,AUTO

      643     4258
      644     4259    3       IF BAD_CHK_LOW = 0 THEN

   4259  4 001333   200064 235100                    LDA     BAD_CHK_LOW,,AUTO
         4 001334   001341 601000 4                  TNZ     s:4265

      645     4260    4       DO;

      646     4261    4           BAD_CHK_LOW = RB;

   4261  4 001335   000000 236000 xsym               LDQ     RB
         4 001336   200064 756100                    STQ     BAD_CHK_LOW,,AUTO

      647     4262    4           BAD_CHK_HIGH= RB;

   4262  4 001337   200065 756100                    STQ     BAD_CHK_HIGH,,AUTO

      648     4263    4           RETURN;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:98   
   4263  4 001340   000001 702211                    TSX2  ! 1,X1

      649     4264    4           END;
      650     4265    3       IF RB - BAD_CHK_HIGH > 1 OR PRINT_CHKS THEN

   4265  4 001341   000000 236000 xsym               LDQ     RB
         4 001342   200065 136100                    SBLQ    BAD_CHK_HIGH,,AUTO
         4 001343   000001 116007                    CMPQ    1,DL
         4 001344   001347 605400 4                  TPNZ    s:4267
         4 001345   000315 234000 0                  SZN     PRINT_CHKS
         4 001346   001463 605000 4                  TPL     s:4289

      651     4266    4       DO;

      652     4267    4           PAGE = 'PAGE';

   4267  4 001347   040100 100400                    MLR     fill='040'O
         4 001350   000017 000004 1                  ADSC9   LEFT_JUSTIFY+14          cn=0,n=4
         4 001351   200071 000006                    ADSC9   PAGE,,AUTO               cn=0,n=6

      653     4268    4           DASH = ' ';

   4268  4 001352   040000 236003                    LDQ     16384,DU
         4 001353   200073 756100                    STQ     DASH,,AUTO

      654     4269    4           HIGH_PGE = ' ';

   4269  4 001354   040100 100400                    MLR     fill='040'O
         4 001355   000007 000001 5                  ADSC9   7                        cn=0,n=1
         4 001356   200074 000012                    ADSC9   HIGH_PGE,,AUTO           cn=0,n=10

      655     4270    4           CALL BINCHAR(LOW_PGE,BAD_CHK_LOW);

   4270  4 001357   000100 301500                    BTD
         4 001360   200064 000004                    NDSC9   BAD_CHK_LOW,,AUTO        cn=0,s=lsgnf,sf=0,n=4
         4 001361   200077 030012                    NDSC9   LOW_PGE,,AUTO            cn=0,s=nosgn,sf=0,n=10

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:99   
      656     4271    4           CALL ZERO_SUP(LOW_PGE,10,RIGHT_JUSTIFY);

   4271  4 001362   000041 236000 5                  LDQ     33
         4 001363   200110 756100                    STQ     HIGH_PGE+6,,AUTO
         4 001364   000042 236000 5                  LDQ     34
         4 001365   200107 756100                    STQ     HIGH_PGE+5,,AUTO
         4 001366   200077 630500                    EPPR0   LOW_PGE,,AUTO
         4 001367   200106 450500                    STP0    HIGH_PGE+4,,AUTO
         4 001370   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 001371   000037 631400 5                  EPPR1   31
         4 001372   000000 701000 xent               TSX1    ZERO_SUP
         4 001373   000000 011000                    NOP     0

      657     4272    4           IF BAD_CHK_LOW ~= BAD_CHK_HIGH THEN

   4272  4 001374   200064 236100                    LDQ     BAD_CHK_LOW,,AUTO
         4 001375   200065 116100                    CMPQ    BAD_CHK_HIGH,,AUTO
         4 001376   001421 600000 4                  TZE     s:4279

      658     4273    5           DO;

      659     4274    5               DASH = '-';

   4274  4 001377   055000 236003                    LDQ     23040,DU
         4 001400   200073 756100                    STQ     DASH,,AUTO

      660     4275    5               PAGE = 'PAGES';

   4275  4 001401   040100 100400                    MLR     fill='040'O
         4 001402   000020 000005 1                  ADSC9   LEFT_JUSTIFY+15          cn=0,n=5
         4 001403   200071 000006                    ADSC9   PAGE,,AUTO               cn=0,n=6

      661     4276    5               CALL BINCHAR(HIGH_PGE,BAD_CHK_HIGH);

   4276  4 001404   000100 301500                    BTD
         4 001405   200065 000004                    NDSC9   BAD_CHK_HIGH,,AUTO       cn=0,s=lsgnf,sf=0,n=4
         4 001406   200074 030012                    NDSC9   HIGH_PGE,,AUTO           cn=0,s=nosgn,sf=0,n=10
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:100  

      662     4277    5               CALL ZERO_SUP(HIGH_PGE,10,LEFT_JUSTIFY);

   4277  4 001407   000043 236000 5                  LDQ     35
         4 001410   200110 756100                    STQ     HIGH_PGE+6,,AUTO
         4 001411   000042 236000 5                  LDQ     34
         4 001412   200107 756100                    STQ     HIGH_PGE+5,,AUTO
         4 001413   200074 630500                    EPPR0   HIGH_PGE,,AUTO
         4 001414   200106 450500                    STP0    HIGH_PGE+4,,AUTO
         4 001415   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 001416   000037 631400 5                  EPPR1   31
         4 001417   000000 701000 xent               TSX1    ZERO_SUP
         4 001420   000000 011000                    NOP     0

      663     4278    5               END;

      664     4279    4    /**/   DCBSF = DCBNUM(M$LO);

   4279  4 001421   000000 236007 xsym               LDQ     M$LO,DL
         4 001422   000000 620006                    EAX0    0,QL
         4 001423   000000 740000 xsym               STX0    DCBSF

      665     4280    4    /**/   BUFSF = VECTOR(REPRT);

   4280  4 001424   000000 235000 5                  LDA     0
         4 001425   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 001426   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 001427   000036 036003                    ADLQ    30,DU
         4 001430   000000 755000 xsym               STA     BUFSF
         4 001431   000001 756000 xsym               STQ     BUFSF+1

      666     4281    4    /**/   BUFLNSF = 80;

   4281  4 001432   000120 235007                    LDA     80,DL
         4 001433   000000 755000 xsym               STA     BUFLNSF

      667     4282    4    /**/   VFCSF = %NO#;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:101  

   4282  4 001434   000000 450000 xsym               STZ     VFCSF

      668     4283    4           CALL CONCAT(REPRT, '      ',PAGE,LOW_PGE,DASH,HIGH_PGE);

   4283  4 001435   040100 100400                    MLR     fill='040'O
         4 001436   000022 000006 1                  ADSC9   LEFT_JUSTIFY+17          cn=0,n=6
         4 001437   200036 000006                    ADSC9   REPRT,,AUTO              cn=0,n=6
         4 001440   040100 100500                    MLR     fill='040'O
         4 001441   200071 000006                    ADSC9   PAGE,,AUTO               cn=0,n=6
         4 001442   200037 400006                    ADSC9   REPRT+1,,AUTO            cn=2,n=6
         4 001443   040100 100500                    MLR     fill='040'O
         4 001444   200077 000012                    ADSC9   LOW_PGE,,AUTO            cn=0,n=10
         4 001445   200041 000012                    ADSC9   REPRT+3,,AUTO            cn=0,n=10
         4 001446   200073 236100                    LDQ     DASH,,AUTO
         4 001447   000022 772000                    QRL     18
         4 001450   200043 552110                    STBQ    REPRT+5,'10'O,AUTO
         4 001451   040100 100500                    MLR     fill='040'O
         4 001452   200074 000012                    ADSC9   HIGH_PGE,,AUTO           cn=0,n=10
         4 001453   200043 600071                    ADSC9   REPRT+5,,AUTO            cn=3,n=57

      669     4284    4           CALL SYS_FUNC_WRIT;

   4284  4 001454   000001 631400 5                  EPPR1   1
         4 001455   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 001456   000000 011000                    NOP     0

      670     4285    4           BAD_CHK_LOW = RB;

   4285  4 001457   000000 235000 xsym               LDA     RB
         4 001460   200064 755100                    STA     BAD_CHK_LOW,,AUTO

      671     4286    4           BAD_CHK_HIGH = RB;

   4286  4 001461   200065 755100                    STA     BAD_CHK_HIGH,,AUTO

      672     4287    4           END;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:102  

   4287  4 001462   001465 710000 4                  TRA     s:4290

      673     4288    3       ELSE
      674     4289    3           BAD_CHK_HIGH = RB;

   4289  4 001463   000000 236000 xsym               LDQ     RB
         4 001464   200065 756100                    STQ     BAD_CHK_HIGH,,AUTO

      675     4290    3       RETURN;

   4290  4 001465   200104 221300                    LDX1  ! HIGH_PGE+2,,AUTO
         4 001466   000001 702211                    TSX2  ! 1,X1

      676     4291    3   END BAD_CHK;
      677     4292    2   END CHECK_SUM;
      678     4293        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:103  
      679     4294        /*------------------------------------------------------------------
      680     4295               S T O R E   M I S S I N G   P A G E S   P R O C
      681     4296        -------------------------------------------------------------------*/
      682     4297    1   ADD_MISSING_PGE: PROC;

   4297  4 001467   200070 741300       ADD_MISSING* STX1  ! FULL_LOAD+2,,AUTO

      683     4298    2       IF FULL_LOAD THEN

   4298  4 001470   200066 234100                    SZN     FULL_LOAD,,AUTO
         4 001471   001474 605000 4                  TPL     s:4300

      684     4299    2           STEPCC=11; /* JOB WILL BE M$XXX AFTER LOAD COMPLETES */

   4299  4 001472   000013 235007                    LDA     11,DL
         4 001473   000000 755000 xsym               STA     STEPCC

      685     4300    2       IF PGE_INDX < 98 THEN

   4300  4 001474   000000 235000 0                  LDA     PGE_INDX
         4 001475   000142 115007                    CMPA    98,DL
         4 001476   001524 605000 4                  TPL     s:4319

      686     4301    3       DO;

      687     4302    3           IF LOW_RNG(PGE_INDX) = 0 THEN

   4302  4 001477   000002 235005 0                  LDA     LOW_RNG,AL
         4 001500   001506 601000 4                  TNZ     s:4308

      688     4303    4           DO;

      689     4304    4               LOW_RNG(PGE_INDX) = RB;

   4304  4 001501   000000 720000 0                  LXL0    PGE_INDX
         4 001502   000000 235000 xsym               LDA     RB
         4 001503   000002 755010 0                  STA     LOW_RNG,X0
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:104  

      690     4305    4               HIGH_RNG(PGE_INDX) = RB;

   4305  4 001504   000146 755010 0                  STA     HIGH_RNG,X0

      691     4306    4               END;

   4306  4 001505   001542 710000 4                  TRA     s:4328

      692     4307    4           ELSE DO;

      693     4308    4               IF RB - HIGH_RNG(PGE_INDX) > 1 THEN

   4308  4 001506   000000 720000 0                  LXL0    PGE_INDX
         4 001507   000000 236000 xsym               LDQ     RB
         4 001510   000146 136010 0                  SBLQ    HIGH_RNG,X0
         4 001511   000001 116007                    CMPQ    1,DL
         4 001512   001521 604400 4                  TMOZ    s:4315

      694     4309    5               DO;

      695     4310    5                   PGE_INDX = PGE_INDX + 1;

   4310  4 001513   000000 054000 0                  AOS     PGE_INDX

      696     4311    5                   LOW_RNG(PGE_INDX) = RB;

   4311  4 001514   000000 720000 0                  LXL0    PGE_INDX
         4 001515   000000 235000 xsym               LDA     RB
         4 001516   000002 755010 0                  STA     LOW_RNG,X0

      697     4312    5                   HIGH_RNG(PGE_INDX) = RB;

   4312  4 001517   000146 755010 0                  STA     HIGH_RNG,X0

      698     4313    5                   END;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:105  
   4313  4 001520   001542 710000 4                  TRA     s:4328

      699     4314    4               ELSE
      700     4315    4                   HIGH_RNG(PGE_INDX) = RB;

   4315  4 001521   000000 235000 xsym               LDA     RB
         4 001522   000146 755010 0                  STA     HIGH_RNG,X0

      701     4316    4               END;

      702     4317    3           END;

   4317  4 001523   001542 710000 4                  TRA     s:4328

      703     4318    3       ELSE DO;

      704     4319    3           CALL PAGE_REPORT;

   4319  4 001524   001710 701000 4                  TSX1    PAGE_REPORT
         4 001525   000000 011000                    NOP     0

      705     4320    4           DO PGE_INDX = 0 TO 99;

   4320  4 001526   000000 450000 0                  STZ     PGE_INDX

      706     4321    4               LOW_RNG(PGE_INDX) = 0;

   4321  4 001527   000000 720000 0                  LXL0    PGE_INDX
         4 001530   000002 450010 0                  STZ     LOW_RNG,X0

      707     4322    4               HIGH_RNG(PGE_INDX) = 0;

   4322  4 001531   000146 450010 0                  STZ     HIGH_RNG,X0

      708     4323    4               END;

   4323  4 001532   000000 054000 0                  AOS     PGE_INDX
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:106  
         4 001533   000000 235000 0                  LDA     PGE_INDX
         4 001534   000143 115007                    CMPA    99,DL
         4 001535   001527 604400 4                  TMOZ    s:4321

      709     4324    3           PGE_INDX = 0;

   4324  4 001536   000000 450000 0                  STZ     PGE_INDX

      710     4325    3           LOW_RNG(0) = RB;

   4325  4 001537   000000 235000 xsym               LDA     RB
         4 001540   000002 755000 0                  STA     LOW_RNG

      711     4326    3           HIGH_RNG(0) = RB;

   4326  4 001541   000146 755000 0                  STA     HIGH_RNG

      712     4327    3           END;

      713     4328    2       RETURN;

   4328  4 001542   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 001543   000001 702211                    TSX2  ! 1,X1

      714     4329    2   END ADD_MISSING_PGE;
      715     4330        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:107  
      716     4331        /*-----------------------------------------------------------------
      717     4332                      P R I N T    L O A D   R E P O R T
      718     4333        --------------------------------------------------------------------*/
      719     4334    1   LOAD_REPRT: PROC(IDS_FILE);

   4334  4 001544   200072 741300       LOAD_REPRT   STX1  ! ARRAY_SIZE,,AUTO

      720     4335    2   DCL PAGE CHAR(6);
      721     4336    2   DCL DASH CHAR(1);
      722     4337    2   DCL LOW_PGE CHAR(10);
      723     4338    2   DCL HIGH_PGE CHAR(10);
      724     4339    2   DCL IDS_FILE CHAR(3) CALIGNED;
      725     4340
      726     4341    2   /**/ DCBSF = DCBNUM(M$LO);

   4341  4 001545   000000 236007 xsym               LDQ     M$LO,DL
         4 001546   000000 620006                    EAX0    0,QL
         4 001547   000000 740000 xsym               STX0    DCBSF

      727     4342    2   /**/ BUFSF = VECTOR(REPRT);

   4342  4 001550   000000 235000 5                  LDA     0
         4 001551   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 001552   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 001553   000036 036003                    ADLQ    30,DU
         4 001554   000000 755000 xsym               STA     BUFSF
         4 001555   000001 756000 xsym               STQ     BUFSF+1

      728     4343    2   /**/ BUFLNSF = 80;

   4343  4 001556   000120 235007                    LDA     80,DL
         4 001557   000000 755000 xsym               STA     BUFLNSF

      729     4344    2       CALL CONCAT(REPRT,'* * * Dump file ',SUBSTR(SRCE_FILE.TEXT,0,SRCE_FILE.CNT),

   4344  4 001560   200015 236100                    LDQ     SRCE_FILE,,AUTO
         4 001561   000033 772000                    QRL     27
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:108  
         4 001562   040100 100400                    MLR     fill='040'O
         4 001563   000024 000020 1                  ADSC9   LEFT_JUSTIFY+19          cn=0,n=16
         4 001564   200036 000020                    ADSC9   REPRT,,AUTO              cn=0,n=16
         4 001565   000000 622006                    EAX2    0,QL
         4 001566   040100 100540                    MLR     fill='040'O
         4 001567   200015 200012                    ADSC9   SRCE_FILE,,AUTO          cn=1,n=*X2
         4 001570   200042 000100                    ADSC9   REPRT+4,,AUTO            cn=0,n=64
         4 001571   000100 116007                    CMPQ    64,DL
         4 001572   001626 603000 4                  TRC     s:4346
         4 001573   777677 622006                    EAX2    -65,QL
         4 001574   777777 662003                    ERX2    -1,DU
         4 001575   040146 100400                    MLR     fill='040'O
         4 001576   000030 000013 1                  ADSC9   LEFT_JUSTIFY+23          cn=0,n=11
         4 001577   200042 000012                    ADSC9   REPRT+4,Q,AUTO           cn=0,n=*X2
         4 001600   000065 116007                    CMPQ    53,DL
         4 001601   001626 603000 4                  TRC     s:4346
         4 001602   777712 621006                    EAX1    -54,QL
         4 001603   777777 661003                    ERX1    -1,DU
         4 001604   200073 470500                    LDP0    @IDS_FILE,,AUTO
         4 001605   040146 100500                    MLR     fill='040'O
         4 001606   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3
         4 001607   200044 600011                    ADSC9   REPRT+6,Q,AUTO           cn=3,n=*X1
         4 001610   000062 116007                    CMPQ    50,DL
         4 001611   001626 603000 4                  TRC     s:4346
         4 001612   777715 621006                    EAX1    -51,QL
         4 001613   777777 661003                    ERX1    -1,DU
         4 001614   040146 100400                    MLR     fill='040'O
         4 001615   000033 000006 1                  ADSC9   LEFT_JUSTIFY+26          cn=0,n=6
         4 001616   200045 400011                    ADSC9   REPRT+7,Q,AUTO           cn=2,n=*X1
         4 001617   000054 116007                    CMPQ    44,DL
         4 001620   001626 603000 4                  TRC     s:4346
         4 001621   777723 621006                    EAX1    -45,QL
         4 001622   777777 661003                    ERX1    -1,DU
         4 001623   040146 100500                    MLR     fill='040'O
         4 001624   200025 200037                    ADSC9   DEST_FILE,,AUTO          cn=1,n=31
         4 001625   200047 000011                    ADSC9   REPRT+9,Q,AUTO           cn=0,n=*X1

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:109  
      730     4345    2          ' loaded to ', IDS_FILE,' file ',DEST_FILE.TEXT);
      731     4346    2   /**/ VFCSF = %NO#;

   4346  4 001626   000000 450000 xsym               STZ     VFCSF

      732     4347    2       CALL SYS_FUNC_WRIT;

   4347  4 001627   000001 631400 5                  EPPR1   1
         4 001630   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 001631   000000 011000                    NOP     0

      733     4348    2       CALL CONCAT(REPRT, '      Dump created: ',DUMP_CREATION);

   4348  4 001632   040100 100400                    MLR     fill='040'O
         4 001633   000035 000024 1                  ADSC9   LEFT_JUSTIFY+28          cn=0,n=20
         4 001634   200036 000024                    ADSC9   REPRT,,AUTO              cn=0,n=20
         4 001635   040100 100500                    MLR     fill='040'O
         4 001636   200003 000016                    ADSC9   DUMP_CREATION,,AUTO      cn=0,n=14
         4 001637   200043 000074                    ADSC9   REPRT+5,,AUTO            cn=0,n=60

      734     4349    2   /**/ VFCSF = %NO#;

   4349  4 001640   000000 450000 xsym               STZ     VFCSF

      735     4350    2       CALL SYS_FUNC_WRIT;

   4350  4 001641   000001 631400 5                  EPPR1   1
         4 001642   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 001643   000000 011000                    NOP     0

      736     4351    2       CALL BINCHAR(HIGH_PGE,PGS_LOAD);

   4351  4 001644   000100 301400                    BTD
         4 001645   000001 000004 0                  NDSC9   PGS_LOAD                 cn=0,s=lsgnf,sf=0,n=4
         4 001646   200102 030012                    NDSC9   HIGH_PGE,,AUTO           cn=0,s=nosgn,sf=0,n=10

      737     4352    2       CALL ZERO_SUP(HIGH_PGE,10,'1'B);
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:110  

   4352  4 001647   000045 236000 5                  LDQ     37
         4 001650   200110 756100                    STQ     HIGH_PGE+6,,AUTO
         4 001651   000042 236000 5                  LDQ     34
         4 001652   200107 756100                    STQ     HIGH_PGE+5,,AUTO
         4 001653   200102 630500                    EPPR0   HIGH_PGE,,AUTO
         4 001654   200106 450500                    STP0    HIGH_PGE+4,,AUTO
         4 001655   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 001656   000037 631400 5                  EPPR1   31
         4 001657   000000 701000 xent               TSX1    ZERO_SUP
         4 001660   000000 011000                    NOP     0

      738     4353    2       IF IDS_FILE = 'IDS' THEN

   4353  4 001661   200073 470500                    LDP0    @IDS_FILE,,AUTO
         4 001662   040000 106500                    CMPC    fill='040'O
         4 001663   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3
         4 001664   000006 000003 1                  ADSC9   LEFT_JUSTIFY+5           cn=0,n=3
         4 001665   001675 601000 4                  TNZ     s:4356

      739     4354    2           CALL CONCAT(REPRT,'      Number of pages loaded: ',HIGH_PGE);

   4354  4 001666   040100 100400                    MLR     fill='040'O
         4 001667   000042 000036 1                  ADSC9   LEFT_JUSTIFY+33          cn=0,n=30
         4 001670   200036 000036                    ADSC9   REPRT,,AUTO              cn=0,n=30
         4 001671   040100 100500                    MLR     fill='040'O
         4 001672   200102 000012                    ADSC9   HIGH_PGE,,AUTO           cn=0,n=10
         4 001673   200045 400062                    ADSC9   REPRT+7,,AUTO            cn=2,n=50
         4 001674   001703 710000 4                  TRA     s:4357

      740     4355    2       ELSE
      741     4356    2           CALL CONCAT(REPRT,'      Number of granules loaded: ',HIGH_PGE);

   4356  4 001675   040100 100400                    MLR     fill='040'O
         4 001676   000052 000041 1                  ADSC9   LEFT_JUSTIFY+41          cn=0,n=33
         4 001677   200036 000041                    ADSC9   REPRT,,AUTO              cn=0,n=33
         4 001700   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:111  
         4 001701   200102 000012                    ADSC9   HIGH_PGE,,AUTO           cn=0,n=10
         4 001702   200046 200057                    ADSC9   REPRT+8,,AUTO            cn=1,n=47

      742     4357    2   /**/ VFCSF = %NO#;

   4357  4 001703   000000 450000 xsym               STZ     VFCSF

      743     4358    2       CALL SYS_FUNC_WRIT;

   4358  4 001704   000001 631400 5                  EPPR1   1
         4 001705   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 001706   000000 011000                    NOP     0
         4 001707   001711 710000 4                  TRA     s:4364

      744     4359    2   PAGE_REPORT: ENTRY;

   4359  4 001710   200072 741300       PAGE_REPORT  STX1  ! ARRAY_SIZE,,AUTO

      745     4360        /*
      746     4361           If any of the requested pages were not found in the dump -
      747     4362           check and report any elements in the missing page array.
      748     4363        */
      749     4364    2       IF LOW_RNG(0) ~= 0 THEN

   4364  4 001711   000002 235000 0                  LDA     LOW_RNG
         4 001712   002052 600000 4                  TZE     s:4393

      750     4365    3       DO;

      751     4366         /*E* ERROR: ZIU-08010-C
      752     4367                 MESSAGE: Warning: Following pages were not found in dump file.
      753     4368                 */
      754     4369    3           ERRCODESF.ERR# = 8010;

   4369  4 001713   000000 236000 xsym               LDQ     ERRCODESF
         4 001714   000013 376000 5                  ANQ     11
         4 001715   175120 276007                    ORQ     64080,DL
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:112  
         4 001716   000000 756000 xsym               STQ     ERRCODESF

      755     4370    3           MSGCODE = ERRCODE_RDEF;

   4370  4 001717   000000 756000 xsym               STQ     MSGCODE

      756     4371    3           CALL SYS_FUNC_ERRMSG;

   4371  4 001720   000001 631400 5                  EPPR1   1
         4 001721   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 001722   000000 011000                    NOP     0

      757     4372    4           DO I = 0 TO PGE_INDX;

   4372  4 001723   000000 450000 xsym               STZ     I
         4 001724   002047 710000 4                  TRA     s:4391+1

      758     4373    4               DASH = ' ';

   4373  4 001725   040000 236003                    LDQ     16384,DU
         4 001726   200076 756100                    STQ     DASH,,AUTO

      759     4374    4               HIGH_PGE = ' ';

   4374  4 001727   040100 100400                    MLR     fill='040'O
         4 001730   000007 000001 5                  ADSC9   7                        cn=0,n=1
         4 001731   200102 000012                    ADSC9   HIGH_PGE,,AUTO           cn=0,n=10

      760     4375    4               PAGE = 'PAGE';

   4375  4 001732   040100 100400                    MLR     fill='040'O
         4 001733   000017 000004 1                  ADSC9   LEFT_JUSTIFY+14          cn=0,n=4
         4 001734   200074 000006                    ADSC9   PAGE,,AUTO               cn=0,n=6

      761     4376    4               CALL BINCHAR(LOW_PGE,LOW_RNG(I));

   4376  4 001735   000000 720000 xsym               LXL0    I
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:113  
         4 001736   000002 235010 0                  LDA     LOW_RNG,X0
         4 001737   000044 773000                    LRL     36
         4 001740   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 001741   000100 301500                    BTD
         4 001742   200106 000010                    NDSC9   HIGH_PGE+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 001743   200077 030012                    NDSC9   LOW_PGE,,AUTO            cn=0,s=nosgn,sf=0,n=10

      762     4377    4               CALL ZERO_SUP(LOW_PGE,10,RIGHT_JUSTIFY);

   4377  4 001744   000041 236000 5                  LDQ     33
         4 001745   200110 756100                    STQ     HIGH_PGE+6,,AUTO
         4 001746   000042 236000 5                  LDQ     34
         4 001747   200107 756100                    STQ     HIGH_PGE+5,,AUTO
         4 001750   200077 630500                    EPPR0   LOW_PGE,,AUTO
         4 001751   200106 450500                    STP0    HIGH_PGE+4,,AUTO
         4 001752   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 001753   000037 631400 5                  EPPR1   31
         4 001754   000000 701000 xent               TSX1    ZERO_SUP
         4 001755   000000 011000                    NOP     0

      763     4378    4               IF LOW_RNG(I) ~= HIGH_RNG(I) THEN

   4378  4 001756   000000 720000 xsym               LXL0    I
         4 001757   000002 236010 0                  LDQ     LOW_RNG,X0
         4 001760   000146 116010 0                  CMPQ    HIGH_RNG,X0
         4 001761   002007 600000 4                  TZE     s:4385

      764     4379    5               DO;

      765     4380    5                   DASH = '-';

   4380  4 001762   055000 236003                    LDQ     23040,DU
         4 001763   200076 756100                    STQ     DASH,,AUTO

      766     4381    5                   PAGE = 'PAGES';

   4381  4 001764   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:114  
         4 001765   000020 000005 1                  ADSC9   LEFT_JUSTIFY+15          cn=0,n=5
         4 001766   200074 000006                    ADSC9   PAGE,,AUTO               cn=0,n=6

      767     4382    5                   CALL BINCHAR(HIGH_PGE,HIGH_RNG(I));

   4382  4 001767   000146 235010 0                  LDA     HIGH_RNG,X0
         4 001770   000044 773000                    LRL     36
         4 001771   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 001772   000100 301500                    BTD
         4 001773   200106 000010                    NDSC9   HIGH_PGE+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 001774   200102 030012                    NDSC9   HIGH_PGE,,AUTO           cn=0,s=nosgn,sf=0,n=10

      768     4383    5                   CALL ZERO_SUP(HIGH_PGE,10,LEFT_JUSTIFY);

   4383  4 001775   000043 236000 5                  LDQ     35
         4 001776   200110 756100                    STQ     HIGH_PGE+6,,AUTO
         4 001777   000042 236000 5                  LDQ     34
         4 002000   200107 756100                    STQ     HIGH_PGE+5,,AUTO
         4 002001   200102 630500                    EPPR0   HIGH_PGE,,AUTO
         4 002002   200106 450500                    STP0    HIGH_PGE+4,,AUTO
         4 002003   200106 630500                    EPPR0   HIGH_PGE+4,,AUTO
         4 002004   000037 631400 5                  EPPR1   31
         4 002005   000000 701000 xent               TSX1    ZERO_SUP
         4 002006   000000 011000                    NOP     0

      769     4384    5                   END;

      770     4385    4               CALL CONCAT(REPRT,'            ',PAGE,LOW_PGE,DASH,HIGH_PGE);

   4385  4 002007   040100 100400                    MLR     fill='040'O
         4 002010   000063 000014 1                  ADSC9   LEFT_JUSTIFY+50          cn=0,n=12
         4 002011   200036 000014                    ADSC9   REPRT,,AUTO              cn=0,n=12
         4 002012   040100 100500                    MLR     fill='040'O
         4 002013   200074 000006                    ADSC9   PAGE,,AUTO               cn=0,n=6
         4 002014   200041 000006                    ADSC9   REPRT+3,,AUTO            cn=0,n=6
         4 002015   040100 100500                    MLR     fill='040'O
         4 002016   200077 000012                    ADSC9   LOW_PGE,,AUTO            cn=0,n=10
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:115  
         4 002017   200042 400012                    ADSC9   REPRT+4,,AUTO            cn=2,n=10
         4 002020   200076 236100                    LDQ     DASH,,AUTO
         4 002021   777000 376003                    ANQ     -512,DU
         4 002022   000046 276000 5                  ORQ     38
         4 002023   200045 756100                    STQ     REPRT+7,,AUTO
         4 002024   040100 100500                    MLR     fill='040'O
         4 002025   200102 000012                    ADSC9   HIGH_PGE,,AUTO           cn=0,n=10
         4 002026   200045 200063                    ADSC9   REPRT+7,,AUTO            cn=1,n=51

      771     4386    4    /**/       DCBSF = DCBNUM(M$LO);

   4386  4 002027   000000 236007 xsym               LDQ     M$LO,DL
         4 002030   000000 620006                    EAX0    0,QL
         4 002031   000000 740000 xsym               STX0    DCBSF

      772     4387    4    /**/       BUFSF = VECTOR(REPRT);

   4387  4 002032   000000 235000 5                  LDA     0
         4 002033   200106 452500                    STP2    HIGH_PGE+4,,AUTO
         4 002034   200106 236100                    LDQ     HIGH_PGE+4,,AUTO
         4 002035   000036 036003                    ADLQ    30,DU
         4 002036   000000 755000 xsym               STA     BUFSF
         4 002037   000001 756000 xsym               STQ     BUFSF+1

      773     4388    4    /**/       BUFLNSF = 80;

   4388  4 002040   000120 235007                    LDA     80,DL
         4 002041   000000 755000 xsym               STA     BUFLNSF

      774     4389    4    /**/       VFCSF = %NO#;

   4389  4 002042   000000 450000 xsym               STZ     VFCSF

      775     4390    4               CALL SYS_FUNC_WRIT;

   4390  4 002043   000001 631400 5                  EPPR1   1
         4 002044   000000 701000 xent               TSX1    SYS_FUNC_WRIT
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:116  
         4 002045   000000 011000                    NOP     0

      776     4391    4               END;

   4391  4 002046   000000 054000 xsym               AOS     I
         4 002047   000000 236000 xsym               LDQ     I
         4 002050   000000 116000 0                  CMPQ    PGE_INDX
         4 002051   001725 604400 4                  TMOZ    s:4373

      777     4392    3           END;

      778     4393    2       PGE_INDX = 0;

   4393  4 002052   000000 450000 0                  STZ     PGE_INDX

      779     4394    2       LOW_RNG(0) = 0;

   4394  4 002053   000002 450000 0                  STZ     LOW_RNG

      780     4395    2       RETURN;

   4395  4 002054   200072 221300                    LDX1  ! ARRAY_SIZE,,AUTO
         4 002055   000001 702211                    TSX2  ! 1,X1

      781     4396    2   END LOAD_REPRT;
      782     4397        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:117  
      783     4398        /*-------------------------------------------------------------------
      784     4399              A S S O C I A T E D   K E Y E D   F I L E    C H E C K
      785     4400        -------------------------------------------------------------------*/
      786     4401    1   LOAD_ASCFID: PROC(FILE_TYPE) ALTRET;

   4401  4 002056   200070 741300       LOAD_ASCFID  STX1  ! FULL_LOAD+2,,AUTO

      787     4402
      788     4403    2   DCL FILE_TYPE CHAR(3) CALIGNED;
      789     4404
      790     4405        /*
      791     4406           This procedure is called once it has been established in the
      792     4407           attribute block that an associated keyed file belongs to this
      793     4408           file just dumped. This routine figures out what the name of
      794     4409           the source and destination key file names are (or should be).
      795     4410           Also, this routine makes sure that the source key file can be
      796     4411           opened before calling the key file dump routine.
      797     4412        */
      798     4413    2       I=SRCE_FILE.CNT;

   4413  4 002057   200015 236100                    LDQ     SRCE_FILE,,AUTO
         4 002060   000033 772000                    QRL     27
         4 002061   000000 756000 xsym               STQ     I

      799     4414    2       I=I+1;

   4414  4 002062   000000 054000 xsym               AOS     I

      800     4415    2       IF I > 30 THEN I = 30; /* Only max of 30 char names allowed */

   4415  4 002063   000000 235000 xsym               LDA     I
         4 002064   000036 115007                    CMPA    30,DL
         4 002065   002070 604400 4                  TMOZ    s:4416

   4415  4 002066   000036 235007                    LDA     30,DL
         4 002067   000000 755000 xsym               STA     I

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:118  
      801     4416    2       CALL INSERT(SRCE_FILE.TEXT,(I-1),1,':');

   4416  4 002070   040105 100400                    MLR     fill='040'O
         4 002071   000047 000001 5                  ADSC9   39                       cn=0,n=1
         4 002072   200015 000001                    ADSC9   SRCE_FILE,A,AUTO         cn=0,n=1

      802     4417    2       SRCE_FILE.CNT = I;

   4417  4 002073   000000 236000 xsym               LDQ     I
         4 002074   000033 736000                    QLS     27
         4 002075   200015 552140                    STBQ    SRCE_FILE,'40'O,AUTO

      803     4418        /*
      804     4419           The source fid should be the area name + ':'.
      805     4420        */
      806     4421    2       I=DEST_FILE.CNT;

   4421  4 002076   200025 236100                    LDQ     DEST_FILE,,AUTO
         4 002077   000033 772000                    QRL     27
         4 002100   000000 756000 xsym               STQ     I

      807     4422    2       I=I+1;

   4422  4 002101   000000 054000 xsym               AOS     I

      808     4423    2       IF I > 30 THEN I = 30;

   4423  4 002102   000000 235000 xsym               LDA     I
         4 002103   000036 115007                    CMPA    30,DL
         4 002104   002107 604400 4                  TMOZ    s:4424

   4423  4 002105   000036 235007                    LDA     30,DL
         4 002106   000000 755000 xsym               STA     I

      809     4424    2       CALL INSERT(DEST_FILE.TEXT,(I-1),1,':');

   4424  4 002107   040105 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:119  
         4 002110   000047 000001 5                  ADSC9   39                       cn=0,n=1
         4 002111   200025 000001                    ADSC9   DEST_FILE,A,AUTO         cn=0,n=1

      810     4425    2       DEST_FILE.CNT = I;

   4425  4 002112   000000 236000 xsym               LDQ     I
         4 002113   000033 736000                    QLS     27
         4 002114   200025 552140                    STBQ    DEST_FILE,'40'O,AUTO
         4 002115   002117 710000 4                  TRA     s:4434

      811     4426        /*
      812     4427           Now use same dcbs for these two files.
      813     4428        */
      814     4429        /*
      815     4430           Attempt to open the keyed file - if an altreturn condition
      816     4431           occurrs, inform the user you cannot backup the keyed file.
      817     4432        */
      818     4433    2   LOAD_DISK_INDEX: ENTRY(FILE_TYPE) ALTRET;

   4433  4 002116   200070 741300       LOAD_DISK_I* STX1  ! FULL_LOAD+2,,AUTO

      819     4434    2   /**/ DCBSF = ZI$DIR.SRCE_NM.DCB#;

   4434  4 002117   000255 220000 xsym               LDX0    ZI$DIR+173
         4 002120   000000 740000 xsym               STX0    DCBSF

      820     4435    2   /**/ ORGSF = %KEYED#;

   4435  4 002121   000002 235007                    LDA     2,DL
         4 002122   000000 755000 xsym               STA     ORGSF

      821     4436    2   /**/ TESTSF = %NO#;

   4436  4 002123   000000 450000 xsym               STZ     TESTSF

      822     4437    2   /**/ ACSSF = %BLOCK#;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:120  
   4437  4 002124   000003 236007                    LDQ     3,DL
         4 002125   000000 756000 xsym               STQ     ACSSF

      823     4438         /*      DELETE THE FOLLOWING LINES AT C00 RELEASE */
      824     4439         /*        THOSE ARE USED FOR LOADING A00 DUMP OF KEY FILE IN TAPE */
      825     4440    2       IF DCBADDR(SRCEDCB)->F$DCB.ASN#=%TAPE# THEN

   4440  4 002126   000002 470400 5                  LDP0    2
         4 002127   000000 471500                    LDP1    0,,PR0
         4 002130   200012 222100                    LDX2    SRCEDCB,,AUTO
         4 002131   100000 473512                    LDP3    0,X2,PR1
         4 002132   300032 236100                    LDQ     26,,PR3
         4 002133   777000 376007                    ANQ     -512,DL
         4 002134   002000 116007                    CMPQ    1024,DL
         4 002135   002140 601000 4                  TNZ     s:4443

      826     4441    2    /**/   ACSSF=%SEQUEN#; /* FOR A00 TAPE DUMP FILES */

   4441  4 002136   000001 235007                    LDA     1,DL
         4 002137   000000 755000 xsym               STA     ACSSF

      827     4442         /*            TILL     HERE     HERE */
      828     4443    2   /**/ FUNSF = %IN#;

   4443  4 002140   000002 235007                    LDA     2,DL
         4 002141   000000 755000 xsym               STA     FUNSF

      829     4444    2   /**/ REASGNSF = %NO#;

   4444  4 002142   000000 450000 xsym               STZ     REASGNSF

      830     4445    2   /**/ FIDSF = SRCE_FILE.TEXT;

   4445  4 002143   040000 100500                    MLR     fill='040'O
         4 002144   200015 200036                    ADSC9   SRCE_FILE,,AUTO          cn=1,n=30
         4 002145   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:121  
      831     4446    2   /**/ SHARESF = %IN#;

   4446  4 002146   400000 236003                    LDQ     -131072,DU
         4 002147   000000 756000 xsym               STQ     SHARESF

      832     4447    2       CALL SYS_FUNC_OPEN ALTRET(ALT_OPEN); /* OPEN SOURCE FILE */

   4447  4 002150   000001 631400 5                  EPPR1   1
         4 002151   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 002152   002351 702000 4                  TSX2    ALT_OPEN
         4 002153   002155 710000 4                  TRA     s:4451

      833     4448
      834     4449    2   LOAD_TAPE_INDEX: ENTRY(FILE_TYPE) ALTRET;

   4449  4 002154   200070 741300       LOAD_TAPE_I* STX1  ! FULL_LOAD+2,,AUTO

      835     4450
      836     4451    2       DESTDCB = ZI$DIR.DEST_NM.DCB#;

   4451  4 002155   000266 220000 xsym               LDX0    ZI$DIR+182
         4 002156   200013 740100                    STX0    DESTDCB,,AUTO

      837     4452    2       DCBSF = DESTDCB;

   4452  4 002157   000000 740000 xsym               STX0    DCBSF

      838     4453    2       ACNT(0)= ' ';

   4453  4 002160   000007 235000 5                  LDA     7
         4 002161   000007 236000 5                  LDQ     7
         4 002162   000000 755000 xsym               STA     ACNT
         4 002163   000001 756000 xsym               STQ     ACNT+1

      839     4454    2       FUNSF = %CREATE#; /* WE WILL CREATE A DUMMY DEST FILE */

   4454  4 002164   000003 235007                    LDA     3,DL
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:122  
         4 002165   000000 755000 xsym               STA     FUNSF

      840     4455    2       EXISTSF = %NEWFILE#;

   4455  4 002166   600000 236003                    LDQ     -65536,DU
         4 002167   000000 756000 xsym               STQ     EXISTSF

      841     4456    2       XTENSIZESF = 1;

   4456  4 002170   000001 235007                    LDA     1,DL
         4 002171   000000 755000 xsym               STA     XTENSIZESF

      842     4457    2       ORGSF = %CONSEC#;

   4457  4 002172   000000 755000 xsym               STA     ORGSF

      843     4458    2       ACSSF = %SEQUEN#;

   4458  4 002173   000000 755000 xsym               STA     ACSSF

      844     4459    2       CARRY_ATTRIBUTESF = %NO#;

   4459  4 002174   000000 450000 xsym               STZ     CARRY_ATTRIBUTESF

      845     4460    2       TESTSF = %NO#;

   4460  4 002175   000000 450000 xsym               STZ     TESTSF

      846     4461    2       REASGNSF = %NO#;

   4461  4 002176   000000 450000 xsym               STZ     REASGNSF

      847     4462    2       FIDSF = DEST_FILE.TEXT;

   4462  4 002177   040000 100500                    MLR     fill='040'O
         4 002200   200025 200036                    ADSC9   DEST_FILE,,AUTO          cn=1,n=30
         4 002201   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:123  

      848     4463    2       IF FILE_TYPE = 'IND' THEN

   4463  4 002202   200071 470500                    LDP0    @FILE_TYPE,,AUTO
         4 002203   040000 106500                    CMPC    fill='040'O
         4 002204   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3
         4 002205   000005 000003 1                  ADSC9   LEFT_JUSTIFY+4           cn=0,n=3
         4 002206   002224 601000 4                  TNZ     s:4470

      849     4464    3       DO;

      850     4465    3           REASGNSF = %YES#; /* FOR INDEX FILE, LET !SET MERGED */

   4465  4 002207   400000 236003                    LDQ     -131072,DU
         4 002210   000000 756000 xsym               STQ     REASGNSF

      851     4466    3           EXISTSF=ZI$DIR.OPEN_MODE; /* TAKE USER'S OPEN_MODE */

   4466  4 002211   000125 236000 xsym               LDQ     ZI$DIR+85
         4 002212   000040 772000                    QRL     32
         4 002213   000003 376007                    ANQ     3,DL
         4 002214   000042 736000                    QLS     34
         4 002215   000000 756000 xsym               STQ     EXISTSF

      852     4467    3           FIDSF = ZI$DIR.DEST_NM.NAME.TEXT; /* DEFAULT FID */

   4467  4 002216   040000 100400                    MLR     fill='040'O
         4 002217   000256 200036 xsym               ADSC9   ZI$DIR+174               cn=1,n=30
         4 002220   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

      853     4468    3           ACNT = ZI$DIR.ACNT;

   4468  4 002221   000000 100400                    MLR     fill='000'O
         4 002222   000002 400120 xsym               ADSC9   ZI$DIR+2                 cn=2,n=80
         4 002223   000000 000120 xsym               ADSC9   ACNT                     cn=0,n=80

      854     4469    3           END;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:124  

      855     4470    2       CALL SYS_FUNC_OPEN ALTRET(ALT_OPEN);

   4470  4 002224   000001 631400 5                  EPPR1   1
         4 002225   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 002226   002351 702000 4                  TSX2    ALT_OPEN

      856     4471    2       DEST_FILE = DCBADDR(DESTDCB)->F$DCB.NAME#; /* GET ACTUAL FID */

   4471  4 002227   000002 470400 5                  LDP0    2
         4 002230   000000 471500                    LDP1    0,,PR0
         4 002231   200013 220100                    LDX0    DESTDCB,,AUTO
         4 002232   100000 473510                    LDP3    0,X0,PR1
         4 002233   000100 100500                    MLR     fill='000'O
         4 002234   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         4 002235   200025 000040                    ADSC9   DEST_FILE,,AUTO          cn=0,n=32

      857     4472    2       IF SUBSTR(DEST_FILE.TEXT,0,1)='*' THEN

   4472  4 002236   200025 236100                    LDQ     DEST_FILE,,AUTO
         4 002237   000777 376003                    ANQ     511,DU
         4 002240   000052 116003                    CMPQ    42,DU
         4 002241   002256 601000 4                  TNZ     s:4480

      858     4473    3       DO;

      859     4474    3           ERRCODESF.ERR# = 10002;

   4474  4 002242   000000 236000 xsym               LDQ     ERRCODESF
         4 002243   000013 376000 5                  ANQ     11
         4 002244   234220 276007                    ORQ     80016,DL
         4 002245   000000 756000 xsym               STQ     ERRCODESF

      860     4475    3           MSGCODE = ERRCODE_RDEF;

   4475  4 002246   000000 756000 xsym               STQ     MSGCODE

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:125  
      861     4476    3           ERRFLGSF = 4; /* CANNOT LOAD TO A STAR FILE */

   4476  4 002247   004000 236003                    LDQ     2048,DU
         4 002250   000000 756000 xsym               STQ     ERRFLGSF

      862     4477    3           CALL SYS_FUNC_ERRMSG;

   4477  4 002251   000001 631400 5                  EPPR1   1
         4 002252   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002253   000000 011000                    NOP     0

      863     4478    3           ALTRETURN;

   4478  4 002254   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 002255   000000 702211                    TSX2  ! 0,X1

      864     4479    3           END;
      865     4480    2       CALL SYS_FUNC_RELEASE ALTRET(ALT_OPEN); /* THEN DELETE THE FILE */

   4480  4 002256   000001 631400 5                  EPPR1   1
         4 002257   000000 701000 xent               TSX1    SYS_FUNC_RELEASE
         4 002260   002351 702000 4                  TSX2    ALT_OPEN

      866     4481    2       PGS_LOAD = 1; /* INIT COUNT INCLUDE FIT */

   4481  4 002261   000001 235007                    LDA     1,DL
         4 002262   000001 755000 0                  STA     PGS_LOAD

      867     4482    2       ORGSF = %KEYED#;

   4482  4 002263   000002 236007                    LDQ     2,DL
         4 002264   000000 756000 xsym               STQ     ORGSF

      868     4483    2       ACSSF = %BLOCK#; /* IN BLOCK MODE */

   4483  4 002265   000003 235007                    LDA     3,DL
         4 002266   000000 755000 xsym               STA     ACSSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:126  

      869     4484         /*      DELETE FOLLOWING LINES AT C00 RELEASE */
      870     4485    2       IF DCBADDR(SRCEDCB)->F$DCB.ASN#=%TAPE# AND

   4485  4 002267   000002 470400 5                  LDP0    2
         4 002270   000000 471500                    LDP1    0,,PR0
         4 002271   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 002272   100000 473510                    LDP3    0,X0,PR1
         4 002273   300032 236100                    LDQ     26,,PR3
         4 002274   777000 376007                    ANQ     -512,DL
         4 002275   002000 116007                    CMPQ    1024,DL
         4 002276   002305 601000 4                  TNZ     s:4489
         4 002277   300032 236100                    LDQ     26,,PR3
         4 002300   777000 376003                    ANQ     -512,DU
         4 002301   002000 116003                    CMPQ    1024,DU
         4 002302   002305 601000 4                  TNZ     s:4489

      871     4486    2          DCBADDR(SRCEDCB)->F$DCB.ORG#=%KEYED# THEN
      872     4487    2    /**/   ACSSF=%SEQUEN#;

   4487  4 002303   000001 235007                    LDA     1,DL
         4 002304   000000 755000 xsym               STA     ACSSF

      873     4488         /*      TILL  H E R E     R_HERE */
      874     4489    2       FIDSF = DEST_FILE.TEXT;

   4489  4 002305   040000 100500                    MLR     fill='040'O
         4 002306   200025 200036                    ADSC9   DEST_FILE,,AUTO          cn=1,n=30
         4 002307   000000 000036 xsym               ADSC9   FIDSF_RD                 cn=0,n=30

      875     4490    2       REASGNSF = %NO#; /* NO MORE !SET DCB */

   4490  4 002310   000000 450000 xsym               STZ     REASGNSF

      876     4491    2       TESTSF = %NO#;

   4491  4 002311   000000 450000 xsym               STZ     TESTSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:127  

      877     4492    2       FUNSF = %CREATE#;

   4492  4 002312   000003 236007                    LDQ     3,DL
         4 002313   000000 756000 xsym               STQ     FUNSF

      878     4493    2       EXISTSF = %NEWFILE#;

   4493  4 002314   600000 236003                    LDQ     -65536,DU
         4 002315   000000 756000 xsym               STQ     EXISTSF

      879     4494    2       CALL GET_FILESIZE; /* GO GET XTENSIZESF WE NEED */

   4494  4 002316   000001 631400 5                  EPPR1   1
         4 002317   000000 701000 xent               TSX1    GET_FILESIZE
         4 002320   000000 011000                    NOP     0

      880     4495    2       CALL SYS_FUNC_OPEN ALTRET(ALT_OPEN);

   4495  4 002321   000001 631400 5                  EPPR1   1
         4 002322   000000 701000 xent               TSX1    SYS_FUNC_OPEN
         4 002323   002351 702000 4                  TSX2    ALT_OPEN

      881     4496    2       IF FILE_TYPE='IND' THEN

   4496  4 002324   200071 470500                    LDP0    @FILE_TYPE,,AUTO
         4 002325   040000 106500                    CMPC    fill='040'O
         4 002326   000000 000003                    ADSC9   0,,PR0                   cn=0,n=3
         4 002327   000005 000003 1                  ADSC9   LEFT_JUSTIFY+4           cn=0,n=3
         4 002330   002333 601000 4                  TNZ     s:4499

      882     4497    2           CALL LOADING_MSG; /* NEW START LOADING INDEX AREAS */

   4497  4 002331   000003 701000 4                  TSX1    LOADING_MSG
         4 002332   000000 011000                    NOP     0

      883     4498         /*     DELETE   FOLLOWING LINES AT C00 RELEASE */
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:128  
      884     4499    2       IF ACSSF~=%BLOCK# THEN /* MUST BE A00 DUMP ON TAPE */

   4499  4 002333   000000 235000 xsym               LDA     ACSSF
         4 002334   000003 115007                    CMPA    3,DL
         4 002335   002341 600000 4                  TZE     s:4503

      885     4500    2           CALL PROCESS_A00_LOAD ALTRET(ALTEND);

   4500  4 002336   002511 701000 4                  TSX1    PROCESS_A00_LOAD
         4 002337   002361 702000 4                  TSX2    ALTEND
         4 002340   002343 710000 4                  TRA     s:4504

      886     4501    2       ELSE
      887     4502         /*      TILL     HERE      HERE */
      888     4503    2           CALL PROCESS_KEY_LOAD ALTRET(ALTEND);

   4503  4 002341   002363 701000 4                  TSX1    PROCESS_KEY_LOAD
         4 002342   002361 702000 4                  TSX2    ALTEND

      889     4504    2       CALL LOAD_REPRT(FILE_TYPE);

   4504  4 002343   200071 236100                    LDQ     @FILE_TYPE,,AUTO
         4 002344   200073 756100                    STQ     @IDS_FILE,,AUTO
         4 002345   001544 701000 4                  TSX1    LOAD_REPRT
         4 002346   000000 011000                    NOP     0

      890     4505    2       RETURN;

   4505  4 002347   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 002350   000001 702211                    TSX2  ! 1,X1

      891     4506
      892     4507    2   ALT_OPEN:
      893     4508         /*E* ERROR: ZIU-08006-C
      894     4509                  MESSAGE: Unable to open the dump file %FN.  */
      895     4510    2       ERRCODESF.ERR# = 8006;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:129  
   4510  4 002351   000000 236000 xsym  ALT_OPEN     LDQ     ERRCODESF
         4 002352   000013 376000 5                  ANQ     11
         4 002353   175060 276007                    ORQ     64048,DL
         4 002354   000000 756000 xsym               STQ     ERRCODESF

      896     4511    2       MSGCODE = ERRCODE_RDEF;

   4511  4 002355   000000 756000 xsym               STQ     MSGCODE

      897     4512    2       CALL SYS_FUNC_ERRMSG;

   4512  4 002356   000001 631400 5                  EPPR1   1
         4 002357   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002360   000000 011000                    NOP     0

      898     4513    2   ALTEND:
      899     4514    2       ALTRETURN;

   4514  4 002361   200070 221300       ALTEND       LDX1  ! FULL_LOAD+2,,AUTO
         4 002362   000000 702211                    TSX2  ! 0,X1

      900     4515    2   END LOAD_ASCFID;
      901     4516        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:130  
      902     4517        /*------------------------------------------------------------------
      903     4518             D U M P    K E Y E D    F I L E    F O R   A R E A
      904     4519        ------------------------------------------------------------------*/
      905     4520    1   PROCESS_KEY_LOAD: PROC ALTRET;

   4520  4 002363   200072 741300       PROCESS_KEY* STX1  ! ARRAY_SIZE,,AUTO

      906     4521
      907     4522    2       I_O_INDX = NBUFS;

   4522  4 002364   000000 235000 xsym               LDA     NBUFS
         4 002365   200014 755100                    STA     I_O_INDX,,AUTO

      908     4523    2       DCBSF = ZI$DIR.SRCE_NM.DCB#;

   4523  4 002366   000255 220000 xsym               LDX0    ZI$DIR+173
         4 002367   000000 740000 xsym               STX0    DCBSF

      909     4524    2       BUFSF = VECTOR(I_O_BUF);

   4524  4 002370   000032 235000 5                  LDA     26
         4 002371   000000 236000 xsym               LDQ     I_O_BUF$
         4 002372   000000 755000 xsym               STA     BUFSF
         4 002373   000001 756000 xsym               STQ     BUFSF+1

      910     4525    2       BUFLNSF = 4096 * NBUFS;

   4525  4 002374   000000 235000 xsym               LDA     NBUFS
         4 002375   000014 735000                    ALS     12
         4 002376   000000 755000 xsym               STA     BUFLNSF

      911     4526    2       WAITSF = %NO#;

   4526  4 002377   000000 450000 xsym               STZ     WAITSF

      912     4527    2       CALL SYS_FUNC_READ ALTRET(ALT_LOAD);

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:131  
   4527  4 002400   000001 631400 5                  EPPR1   1
         4 002401   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 002402   002477 702000 4                  TSX2    ALT_LOAD

      913     4528    3       DO WHILE('1'B);

      914     4529    3           IF BREAK_FLAG > 0 THEN ALTRETURN;

   4529  4 002403   000000 235000 xsym               LDA     BREAK_FLAG
         4 002404   002407 604400 4                  TMOZ    s:4530

   4529  4 002405   200072 221300                    LDX1  ! ARRAY_SIZE,,AUTO
         4 002406   000000 702211                    TSX2  ! 0,X1

      915     4530    3           DCBSF = SRCEDCB; /* CHECK I-O TYC OF SOURCE DCB */

   4530  4 002407   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 002410   000000 740000 xsym               STX0    DCBSF

      916     4531    3           BUFSF = VECTOR(I_O_BUF(I_O_INDX)); /* NEXT BUF TO READ */

   4531  4 002411   000032 235000 5                  LDA     26
         4 002412   200014 236100                    LDQ     I_O_INDX,,AUTO
         4 002413   000034 736000                    QLS     28
         4 002414   000000 036000 xsym               ADLQ    I_O_BUF$
         4 002415   000000 755000 xsym               STA     BUFSF
         4 002416   000001 756000 xsym               STQ     BUFSF+1

      917     4532    3           CALL SYS_FUNC_CHECK ALTRET(ALT_LOAD);

   4532  4 002417   000001 631400 5                  EPPR1   1
         4 002420   000000 701000 xent               TSX1    SYS_FUNC_CHECK
         4 002421   002477 702000 4                  TSX2    ALT_LOAD

      918     4533    3           X = DCBADDR(SRCEDCB)->F$DCB.ARS#; /* NUMBER BYTES READ */

   4533  4 002422   000002 470400 5                  LDP0    2
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:132  
         4 002423   000000 471500                    LDP1    0,,PR0
         4 002424   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 002425   100000 473510                    LDP3    0,X0,PR1
         4 002426   300000 235100                    LDA     0,,PR3
         4 002427   000000 755000 xsym               STA     X

      919     4534    3           IF X=0 THEN RETURN; /* ONLY WHEN TAPE LOAD */

   4534  4 002430   002433 601000 4                  TNZ     s:4535

   4534  4 002431   200072 221300                    LDX1  ! ARRAY_SIZE,,AUTO
         4 002432   000001 702211                    TSX2  ! 1,X1

      920     4535    3           BUFLNSF = NBUFS * 4096;

   4535  4 002433   000000 236000 xsym               LDQ     NBUFS
         4 002434   000014 736000                    QLS     12
         4 002435   000000 756000 xsym               STQ     BUFLNSF

      921     4536    3           WAITSF = %NO#;

   4536  4 002436   000000 450000 xsym               STZ     WAITSF

      922     4537    3           CALL SYS_FUNC_READ ALTRET(CHK_ERROR); /* START NXT READ */

   4537  4 002437   000001 631400 5                  EPPR1   1
         4 002440   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 002441   002467 702000 4                  TSX2    CHK_ERROR

      923     4538    3   DONT_CARE:
      924     4539    3           DCBSF = DESTDCB;

   4539  4 002442   200013 220100       DONT_CARE    LDX0    DESTDCB,,AUTO
         4 002443   000000 740000 xsym               STX0    DCBSF

      925     4540    3           I_O_INDX = NBUFS - I_O_INDX; /* BUF PTR SWAPPING */

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:133  
   4540  4 002444   000000 236000 xsym               LDQ     NBUFS
         4 002445   200014 136100                    SBLQ    I_O_INDX,,AUTO
         4 002446   200014 756100                    STQ     I_O_INDX,,AUTO

      926     4541    3           BUFLNSF = X; /* BYTES WRITE = BYTES READ */

   4541  4 002447   000000 235000 xsym               LDA     X
         4 002450   000000 755000 xsym               STA     BUFLNSF

      927     4542    3           VFCSF = %NO#;

   4542  4 002451   000000 450000 xsym               STZ     VFCSF

      928     4543    3           BUFSF = VECTOR(I_O_BUF(I_O_INDX));

   4543  4 002452   000032 235000 5                  LDA     26
         4 002453   000034 736000                    QLS     28
         4 002454   000000 036000 xsym               ADLQ    I_O_BUF$
         4 002455   000000 755000 xsym               STA     BUFSF
         4 002456   000001 756000 xsym               STQ     BUFSF+1

      929     4544    3           CALL SYS_FUNC_WRIT ALTRET(ALT_LOAD);

   4544  4 002457   000001 631400 5                  EPPR1   1
         4 002460   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 002461   002477 702000 4                  TSX2    ALT_LOAD

      930     4545    3           PGS_LOAD = PGS_LOAD + X/4096;

   4545  4 002462   000000 236000 xsym               LDQ     X
         4 002463   010000 506007                    DIV     4096,DL
         4 002464   000001 036000 0                  ADLQ    PGS_LOAD
         4 002465   000001 756000 0                  STQ     PGS_LOAD

      931     4546    3           END;

   4546  4 002466   002403 710000 4                  TRA     s:4529
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:134  

      932     4547
      933     4548    2   CHK_ERROR:
      934     4549    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR#=%E$EOF THEN

   4549  4 002467   000000 470400 xsym  CHK_ERROR    LDP0    B$TCB$
         4 002470   000000 471500                    LDP1    0,,PR0
         4 002471   100102 236100                    LDQ     66,,PR1
         4 002472   377770 376007                    ANQ     131064,DL
         4 002473   000060 116007                    CMPQ    48,DL
         4 002474   002442 600000 4                  TZE     DONT_CARE

      935     4550    2           GOTO DONT_CARE; /* GOT SOMETHING IN THE BUFFER TO PROCESS */
      936     4551    2       ALTRETURN; /* MUST BE IRECOVABLE ERRORS */

   4551  4 002475   200072 221300                    LDX1  ! ARRAY_SIZE,,AUTO
         4 002476   000000 702211                    TSX2  ! 0,X1

      937     4552    2   ALT_LOAD:
      938     4553    2       IF B$TCB$->B$TCB.ALT$->B$EXCFR.ERR.ERR# = %E$EOF THEN

   4553  4 002477   000000 470400 xsym  ALT_LOAD     LDP0    B$TCB$
         4 002500   000000 471500                    LDP1    0,,PR0
         4 002501   100102 236100                    LDQ     66,,PR1
         4 002502   377770 376007                    ANQ     131064,DL
         4 002503   000060 116007                    CMPQ    48,DL
         4 002504   002507 601000 4                  TNZ     s:4556

      939     4554    2           RETURN;

   4554  4 002505   200072 221300                    LDX1  ! ARRAY_SIZE,,AUTO
         4 002506   000001 702211                    TSX2  ! 1,X1

      940     4555    2       ELSE
      941     4556    2           ALTRETURN;

   4556  4 002507   200072 221300                    LDX1  ! ARRAY_SIZE,,AUTO
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:135  
         4 002510   000000 702211                    TSX2  ! 0,X1

      942     4557        /*      DELETE   ALL  PROCESS_A00_LOAD   AT C00 RELEASE */
      943     4558    2   PROCESS_A00_LOAD: ENTRY ALTRET;

   4558  4 002511   200072 741300       PROCESS_A00* STX1  ! ARRAY_SIZE,,AUTO

      944     4559    2       PGS_LOAD=XTENSIZESF;

   4559  4 002512   000000 235000 xsym               LDA     XTENSIZESF
         4 002513   000001 755000 0                  STA     PGS_LOAD

      945     4560    2       BUFLNSF=0;

   4560  4 002514   000000 450000 xsym               STZ     BUFLNSF

      946     4561    3       DO WHILE ('1'B);

      947     4562    3           DCBSF=SRCEDCB;

   4562  4 002515   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 002516   000000 740000 xsym               STX0    DCBSF

      948     4563    3           KEYRSF=%YES#;

   4563  4 002517   400000 236003                    LDQ     -131072,DU
         4 002520   000000 756000 xsym               STQ     KEYRSF

      949     4564    3           CALL SYS_FUNC_READ ALTRET(ALT_LOAD);

   4564  4 002521   000001 631400 5                  EPPR1   1
         4 002522   000000 701000 xent               TSX1    SYS_FUNC_READ
         4 002523   002477 702000 4                  TSX2    ALT_LOAD

      950     4565    3           DCBSF=DESTDCB;

   4565  4 002524   200013 220100                    LDX0    DESTDCB,,AUTO
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:136  
         4 002525   000000 740000 xsym               STX0    DCBSF

      951     4566    3           KEYSF=%YES#;

   4566  4 002526   400000 236003                    LDQ     -131072,DU
         4 002527   000000 756000 xsym               STQ     KEYSF

      952     4567    3           VFCSF=%NO#;

   4567  4 002530   000000 450000 xsym               STZ     VFCSF

      953     4568    3           CALL SYS_FUNC_WRIT ALTRET(ALT_LOAD);

   4568  4 002531   000001 631400 5                  EPPR1   1
         4 002532   000000 701000 xent               TSX1    SYS_FUNC_WRIT
         4 002533   002477 702000 4                  TSX2    ALT_LOAD

      954     4569    3           END;

   4569  4 002534   002515 710000 4                  TRA     s:4562

      955     4570    2   END PROCESS_KEY_LOAD;
      956     4571        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:137  
      957     4572        /*------------------------------------------------------------------
      958     4573                  C L O S E    T H E    D C B 'S    P R O C
      959     4574        -------------------------------------------------------------------*/
      960     4575    1   CLOSE_FILES: PROC;

   4575  4 002535   200070 741300       CLOSE_FILES  STX1  ! FULL_LOAD+2,,AUTO

      961     4576    2       DCBSF = ZI$DIR.SRCE_NM.DCB#;

   4576  4 002536   000255 220000 xsym               LDX0    ZI$DIR+173
         4 002537   000000 740000 xsym               STX0    DCBSF

      962     4577    2       IF DCBADDR(DCBSF) -> F$DCB.FCD# = %YES# THEN

   4577  4 002540   000002 470400 5                  LDP0    2
         4 002541   000000 471500                    LDP1    0,,PR0
         4 002542   100000 473510                    LDP3    0,X0,PR1
         4 002543   300031 236100                    LDQ     25,,PR3
         4 002544   020000 316007                    CANQ    8192,DL
         4 002545   002556 600000 4                  TZE     s:4582

      963     4578    3       DO;

      964     4579    3           POSSF = ZI$DIR.POS;

   4579  4 002546   000141 236000 xsym               LDQ     ZI$DIR+97
         4 002547   000022 772000                    QRL     18
         4 002550   000777 376007                    ANQ     511,DL
         4 002551   000033 736000                    QLS     27
         4 002552   000000 756000 xsym               STQ     POSSF

      965     4580    3           CALL SYS_FUNC_CLOS;

   4580  4 002553   000001 631400 5                  EPPR1   1
         4 002554   000000 701000 xent               TSX1    SYS_FUNC_CLOS
         4 002555   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:138  
      966     4581    3           END;

      967     4582    2       CALL SYS_FUNC_RELDCB;

   4582  4 002556   000001 631400 5                  EPPR1   1
         4 002557   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         4 002560   000000 011000                    NOP     0

      968     4583    2       IF ZI$DIR.SRCE_NM.DCB# = ZI$DIR.DEST_NM.DCB# THEN

   4583  4 002561   000255 220000 xsym               LDX0    ZI$DIR+173
         4 002562   000266 100000 xsym               CMPX0   ZI$DIR+182
         4 002563   002566 601000 4                  TNZ     s:4585

      969     4584    2           RETURN;

   4584  4 002564   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 002565   000001 702211                    TSX2  ! 1,X1

      970     4585    2       DCBSF = ZI$DIR.DEST_NM.DCB#;

   4585  4 002566   000266 221000 xsym               LDX1    ZI$DIR+182
         4 002567   000000 741000 xsym               STX1    DCBSF

      971     4586    2       IF DCBADDR(DCBSF) -> F$DCB.FCD# = %YES# THEN /* DCB is open */

   4586  4 002570   000002 470400 5                  LDP0    2
         4 002571   000000 471500                    LDP1    0,,PR0
         4 002572   100000 473511                    LDP3    0,X1,PR1
         4 002573   300031 236100                    LDQ     25,,PR3
         4 002574   020000 316007                    CANQ    8192,DL
         4 002575   002601 600000 4                  TZE     s:4588

      972     4587    2           CALL SYS_FUNC_CLOS;

   4587  4 002576   000001 631400 5                  EPPR1   1
         4 002577   000000 701000 xent               TSX1    SYS_FUNC_CLOS
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:139  
         4 002600   000000 011000                    NOP     0

      973     4588    2       CALL SYS_FUNC_RELDCB;

   4588  4 002601   000001 631400 5                  EPPR1   1
         4 002602   000000 701000 xent               TSX1    SYS_FUNC_RELDCB
         4 002603   000000 011000                    NOP     0

      974     4589    2       RETURN;

   4589  4 002604   200070 221300                    LDX1  ! FULL_LOAD+2,,AUTO
         4 002605   000001 702211                    TSX2  ! 1,X1

      975     4590    2   END CLOSE_FILES;
      976     4591        %EJECT;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:140  
      977     4592        /*-----------------------------------------------------------------
      978     4593               POSSIBLE  ALTRETURN  CONDITIONS  FROM  EXTERNAL PROCS
      979     4594        ------------------------------------------------------------------*/
      980     4595    1   ALT_DEST_FILE:
      981     4596         /*E* ERROR: ZIU-08005-C
      982     4597               MESSAGE: Unable to access file %FN - LOAD aborted. */
      983     4598    1       ERRCODESF.ERR# = 8005;

   4598  4 002606   000000 236000 xsym  ALT_DEST_FI* LDQ     ERRCODESF
         4 002607   000013 376000 5                  ANQ     11
         4 002610   175050 276007                    ORQ     64040,DL
         4 002611   000000 756000 xsym               STQ     ERRCODESF

      984     4599    1       MSGCODE = ERRCODE_RDEF;

   4599  4 002612   000000 756000 xsym               STQ     MSGCODE

      985     4600    1       CALL SYS_FUNC_ERRMSG;

   4600  4 002613   000001 631400 5                  EPPR1   1
         4 002614   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002615   000000 011000                    NOP     0

      986     4601    1       CALL CLOSE_FILES;

   4601  4 002616   002535 701000 4                  TSX1    CLOSE_FILES
         4 002617   000000 011000                    NOP     0

      987     4602    1       ALTRETURN;

   4602  4 002620   000000 702200 xent               TSX2  ! X66_AALT

      988     4603    1   ALT_SRCE_FILE:
      989     4604         /*E* ERROR: ZIU-08020-C
      990     4605               MESSAGE: Unable to access dump file %FN - LOAD aborted. */
      991     4606    1       ERRCODESF.ERR# = 8020;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:141  
   4606  4 002621   000000 236000 xsym  ALT_SRCE_FI* LDQ     ERRCODESF
         4 002622   000013 376000 5                  ANQ     11
         4 002623   175240 276007                    ORQ     64160,DL
         4 002624   000000 756000 xsym               STQ     ERRCODESF

      992     4607    1       MSGCODE = ERRCODE_RDEF;

   4607  4 002625   000000 756000 xsym               STQ     MSGCODE

      993     4608    1       CALL SYS_FUNC_ERRMSG;

   4608  4 002626   000001 631400 5                  EPPR1   1
         4 002627   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002630   000000 011000                    NOP     0

      994     4609    1       ALTRETURN;

   4609  4 002631   000000 702200 xent               TSX2  ! X66_AALT

      995     4610    1   ALT_RD_ATBLK:
      996     4611    1       ERRCODESF.ERR# = 1060;

   4611  4 002632   000000 236000 xsym  ALT_RD_ATBLK LDQ     ERRCODESF
         4 002633   000013 376000 5                  ANQ     11
         4 002634   020440 276007                    ORQ     8480,DL
         4 002635   000000 756000 xsym               STQ     ERRCODESF

      997     4612    1       MSGCODE = ERRCODE_RDEF;

   4612  4 002636   000000 756000 xsym               STQ     MSGCODE

      998     4613    1       DCBSF = SRCEDCB;

   4613  4 002637   200012 220100                    LDX0    SRCEDCB,,AUTO
         4 002640   000000 740000 xsym               STX0    DCBSF

      999     4614    1       CALL SYS_FUNC_ERRMSG;
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:142  

   4614  4 002641   000001 631400 5                  EPPR1   1
         4 002642   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002643   000000 011000                    NOP     0

     1000     4615    1       CALL CLOSE_FILES;

   4615  4 002644   002535 701000 4                  TSX1    CLOSE_FILES
         4 002645   000000 011000                    NOP     0

     1001     4616    1       ALTRETURN;

   4616  4 002646   000000 702200 xent               TSX2  ! X66_AALT

     1002     4617    1   ALT_DUMP_READ:
     1003     4618         /*E* ERROR: ZIU-08030-C
     1004     4619               MESSAGE: Read error at page %U1.
     1005     4620               */
     1006     4621    1       CALL BINCHAR(ERR_INSERT.TEXT(0),RB);

   4621  4 002647   000000 235000 xsym  ALT_DUMP_RE* LDA     RB
         4 002650   000044 773000                    LRL     36
         4 002651   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 002652   000000 301500                    BTD
         4 002653   200106 000010                    NDSC9   HIGH_PGE+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 002654   000000 230036 xsym               NDSC9   ERR_INSERT               cn=1,s=nosgn,sf=0,n=30

     1007     4622    1       CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,LEFT_JUSTIFY);

   4622  4 002655   000051 630400 5                  EPPR0   41
         4 002656   000037 631400 5                  EPPR1   31
         4 002657   000000 701000 xent               TSX1    ZERO_SUP
         4 002660   000000 011000                    NOP     0

     1008     4623    1       ERRCODESF.ERR# = 8030;

   4623  4 002661   000000 236000 xsym               LDQ     ERRCODESF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:143  
         4 002662   000013 376000 5                  ANQ     11
         4 002663   175360 276007                    ORQ     64240,DL
         4 002664   000000 756000 xsym               STQ     ERRCODESF

     1009     4624    1       MSGCODE = ERRCODE_RDEF;

   4624  4 002665   000000 756000 xsym               STQ     MSGCODE

     1010     4625    1       CALL SYS_FUNC_ERRMSG;

   4625  4 002666   000001 631400 5                  EPPR1   1
         4 002667   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002670   000000 011000                    NOP     0

     1011     4626    1       CALL CLOSE_FILES;

   4626  4 002671   002535 701000 4                  TSX1    CLOSE_FILES
         4 002672   000000 011000                    NOP     0

     1012     4627    1       ALTRETURN;

   4627  4 002673   000000 702200 xent               TSX2  ! X66_AALT

     1013     4628    1   ALT_WRIT_DEST:
     1014     4629         /*E* ERROR: ZIU-08035-C
     1015     4630               MESSAGE: Monitor write error at page %U1.
     1016     4631               */
     1017     4632    1       CALL BINCHAR(ERR_INSERT.TEXT(0),RB);

   4632  4 002674   000000 235000 xsym  ALT_WRIT_DE* LDA     RB
         4 002675   000044 773000                    LRL     36
         4 002676   200106 757100                    STAQ    HIGH_PGE+4,,AUTO
         4 002677   000000 301500                    BTD
         4 002700   200106 000010                    NDSC9   HIGH_PGE+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 002701   000000 230036 xsym               NDSC9   ERR_INSERT               cn=1,s=nosgn,sf=0,n=30

     1018     4633    1       CALL ZERO_SUP(ERR_INSERT.TEXT(0),30,LEFT_JUSTIFY);
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:144  

   4633  4 002702   000051 630400 5                  EPPR0   41
         4 002703   000037 631400 5                  EPPR1   31
         4 002704   000000 701000 xent               TSX1    ZERO_SUP
         4 002705   000000 011000                    NOP     0

     1019     4634    1       ERRCODESF.ERR# = 8035;

   4634  4 002706   000000 236000 xsym               LDQ     ERRCODESF
         4 002707   000013 376000 5                  ANQ     11
         4 002710   175430 276007                    ORQ     64280,DL
         4 002711   000000 756000 xsym               STQ     ERRCODESF

     1020     4635    1       MSGCODE = ERRCODE_RDEF;

   4635  4 002712   000000 756000 xsym               STQ     MSGCODE

     1021     4636    1       CALL SYS_FUNC_ERRMSG;

   4636  4 002713   000001 631400 5                  EPPR1   1
         4 002714   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002715   000000 011000                    NOP     0

     1022     4637    1       CALL CLOSE_FILES;

   4637  4 002716   002535 701000 4                  TSX1    CLOSE_FILES
         4 002717   000000 011000                    NOP     0

     1023     4638    1       ALTRETURN;

   4638  4 002720   000000 702200 xent               TSX2  ! X66_AALT

     1024     4639    1   ALT_TSTAMP:
     1025     4640    1       CALL CLOSE_FILES;

   4640  4 002721   002535 701000 4     ALT_TSTAMP   TSX1    CLOSE_FILES
         4 002722   000000 011000                    NOP     0
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:145  

     1026     4641    1       ALTRETURN;

   4641  4 002723   000000 702200 xent               TSX2  ! X66_AALT

     1027     4642    1   ALT_LOAD_ASC:
     1028     4643         /*E* ERROR: ZIU-08055-C
     1029     4644               MESSAGE: Recommend reloading associated keyed file %U1 by
     1030     4645                        using REBUILD KEYS utility.                   */
     1031     4646    1       ERR_INSERT(0) = DEST_FILE;

   4646  4 002724   000000 100500       ALT_LOAD_ASC MLR     fill='000'O
         4 002725   200025 000037                    ADSC9   DEST_FILE,,AUTO          cn=0,n=31
         4 002726   000000 000037 xsym               ADSC9   ERR_INSERT               cn=0,n=31

     1032     4647    1       ERRCODESF.ERR# = 8055;

   4647  4 002727   000000 236000 xsym               LDQ     ERRCODESF
         4 002730   000013 376000 5                  ANQ     11
         4 002731   175670 276007                    ORQ     64440,DL
         4 002732   000000 756000 xsym               STQ     ERRCODESF

     1033     4648    1       MSGCODE = ERRCODE_RDEF;

   4648  4 002733   000000 756000 xsym               STQ     MSGCODE

     1034     4649    1       CALL SYS_FUNC_ERRMSG;

   4649  4 002734   000001 631400 5                  EPPR1   1
         4 002735   000000 701000 xent               TSX1    SYS_FUNC_ERRMSG
         4 002736   000000 011000                    NOP     0

     1035     4650    1       CALL CLOSE_FILES;

   4650  4 002737   002535 701000 4                  TSX1    CLOSE_FILES
         4 002740   000000 011000                    NOP     0

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:146  
     1036     4651    1   ALTRTN: ALTRETURN;

   4651  4 002741   000000 702200 xent  ALTRTN       TSX2  ! X66_AALT

PGE_INDX
 Sect OctLoc
   0     000   000000 000000                                                    ....

PGS_LOAD
 Sect OctLoc
   0     001   000000 000000                                                    ....

LOW_RNG
 Sect OctLoc
   0     002   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     142*  000000 000000   000000 000000   000000 000000   000000 000000    ................

HIGH_RNG
 Sect OctLoc
   0     146   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0     306*  000000 000000   000000 000000   000000 000000   000000 000000    ................

EXCEEDED_ARRAY
 Sect OctLoc
   0     312   0***** ******                                                    ....

MSG_FLG
 Sect OctLoc
   0     313   0***** ******                                                    ....

CHECKSUM
 Sect OctLoc
   0     314   0***** ******                                                    ....

PRINT_CHKS
 Sect OctLoc
   0     315   0***** ******                                                    ....
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:147  

RIGHT_JUSTIFY
 Sect OctLoc
   1     000   0***** ******                                                    ....

LEFT_JUSTIFY
 Sect OctLoc
   1     001   4***** ******                                                    ....

(unnamed)
 Sect OctLoc
   1     002   056056 114157   141144 151156   147040 040040   111116 104040    ..Loading   IND
   1     006   111104 123040   113105 131040   056056 056114   157141 144040    IDS KEY ...Load
   1     012   164145 162155   151156 141164   145144 040040   104125 115120    terminated  DUMP
   1     016   111104 123062   120101 107105   120101 107105   123040 040040    IDS2PAGEPAGES
   1     022   040040 040040   040040 040040   052040 052040   052040 104165            * * * Du
   1     026   155160 040146   151154 145040   040154 157141   144145 144040    mp file  loaded
   1     032   164157 040040   040146 151154   145040 040040   040040 040040    to   file
   1     036   040040 104165   155160 040143   162145 141164   145144 072040      Dump created:
   1     042   040040 040040   040040 116165   155142 145162   040157 146040          Number of
   1     046   160141 147145   163040 154157   141144 145144   072040 040040    pages loaded:
   1     052   040040 040040   040040 116165   155142 145162   040157 146040          Number of
   1     056   147162 141156   165154 145163   040154 157141   144145 144072    granules loaded:
   1     062   040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   5     000   000023 777640   000000 000000   000000 006003   000000 006000    ................
   5     004   000002 000000   000000 000004   000005 006000   040040 040040    ............
   5     010   000001 177640   000001 777640   000004 400000   777777 400007    ................
   5     014   000005 006000   000000 000000   000000 006000   000000 006000    ................
   5     020   000000 006000   000000 000001   000021 006000   777000 777777    ................
   5     024   000006 000000   000000 000040   000025 006000   000000 006000    ....... ........
   5     030   000000 006000   000000 006000   001777 777640   776777 777777    ................
   5     034   000006 006000   000007 006000   767777 777777   000003 000000    ................
   5     040   000000 000012   000000 006000   000040 006000   000001 006000    ......... ......
   5     044   400000 000000   000044 006000   000040 040040   072040 040040    .....$...   :
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:148  
   5     050   000000 000036   000000 206000   000050 006000   000001 006000    .........(......
     1037     4652    1   END ZIU$LOAD;

PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:149  
--  Include file information  --

   FM$FIT.:LIB_E05  is referenced.
   ZI_GLOBAL_DBUTIL.:ZIC0TOU  is referenced.
   ZI$PG_STRUCTS.:ZIC0TOU  is referenced.
   ZI$DIR.:ZIC0TOU  is referenced.
   ZI_DBU_XREF.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIU$LOAD.

   Procedure ZIU$LOAD requires 1506 words for executable code.
   Procedure ZIU$LOAD requires 78 words of local(AUTO) storage.

    No errors detected in file ZIU$LOAD.:ZIC0TSI    .
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:150  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:151  
          MINI XREF LISTING

ACNT
      3466**DCL      3872<<ASSIGN   4453<<ASSIGN   4468<<ASSIGN
ACSSF
      3426**DCL      3824<<ASSIGN   3876<<ASSIGN   4437<<ASSIGN   4441<<ASSIGN   4458<<ASSIGN   4483<<ASSIGN
      4487<<ASSIGN   4499>>IF
ACT_REC_LEN IN PROCEDURE EXPAND_PAGE
      4171**DCL      4187<<ASSIGN   4192>>IF       4199>>ASSIGN   4205>>ASSIGN
ADD_MISSING_PGE
      4297**PROC     3957--CALL
ALTEND IN PROCEDURE LOAD_ASCFID
      4514**LABEL    4500--CALLALT  4503--CALLALT
ALTRTN
      4651**LABEL    3833--CALLALT  3906--CALLALT  3907--CALLALT  3908--CALLALT
ALT_ATBLK IN PROCEDURE GET_ATBLK
      4161**LABEL    4065--CALLALT
ALT_DEST_FILE
      4598**LABEL    3881--CALLALT
ALT_DUMP_READ
      4621**LABEL    3941--CALLALT
ALT_LOAD IN PROCEDURE PROCESS_KEY_LOAD
      4553**LABEL    4527--CALLALT  4532--CALLALT  4544--CALLALT  4564--CALLALT  4568--CALLALT
ALT_LOAD_ASC
      4646**LABEL    4009--CALLALT
ALT_OPEN IN PROCEDURE LOAD_ASCFID
      4510**LABEL    4447--CALLALT  4470--CALLALT  4480--CALLALT  4495--CALLALT
ALT_RD_ATBLK
      4611**LABEL    3866--CALLALT
ALT_SRCE_FILE
      4606**LABEL    3829--CALLALT  3859--CALLALT
ALT_TSTAMP
      4640**LABEL    3841--CALLALT
ALT_WRIT IN PROCEDURE WRITE_BUF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:152  
      4040**LABEL    4037--CALLALT
ALT_WRIT_DEST
      4632**LABEL    3860--CALLALT  3863--CALLALT  3898--CALLALT  3959--CALLALT  3981--CALLALT
AREA_KEY$
      2697**DCL      2700--IMP-PTR  3911>>DOWHILE  3914>>ASSIGN
AREA_KEY_XREF.CHECKED
      2705**DCL      3914<<ASSIGN
AREA_KEY_XREF.NAME
      2703**DCL      3911>>DOWHILE
ARRAY_INDX IN PROCEDURE EXPAND_PAGE
      4170**DCL      4197<<ASSIGN   4198>>ASSIGN
ARRAY_SIZE IN PROCEDURE EXPAND_PAGE
      4169**DCL      4173--IMP-SIZ  4175--IMP-SIZ  4186<<ASSIGN   4197>>ASSIGN   4199>>ASSIGN   4200<<ASSIGN
      4200>>ASSIGN   4201>>CALL     4201>>CALL     4201<>CALL
ASNSF
      3429**DCL      3827<<ASSIGN   3878<<ASSIGN
ATBLK$
      3174**DCL      3175--IMP-PTR  4053--IMP-PTR  4066<<ASSIGN   4067>>IF       4078>>IF       4082>>IF
      4086>>ASSIGN   4090>>IF       4102>>IF       4104>>ASSIGN   4105>>ASSIGN   4107>>IF       4132>>IF
      4134>>ASSIGN   4139>>ASSIGN   4139>>ASSIGN   4140>>ASSIGN   4141>>ASSIGN   4143>>IF       4145>>ASSIGN
      4146>>ASSIGN   4147>>ASSIGN   4150>>ASSIGN   4153>>ASSIGN   4156>>ASSIGN   4157>>ASSIGN
ATBLK_PG.AREA_NM
      3200**DCL      3201--REDEF    4067>>IF
ATBLK_PG.CHKSUM_WD
      3179**DCL      4153<<ASSIGN
ATBLK_PG.FIR_INV_PGNO
      3197**DCL      4132>>IF       4139>>ASSIGN
ATBLK_PG.LINE_INFO.LPP
      3195**DCL      4157>>ASSIGN
ATBLK_PG.LOW_DBK
      3198**DCL      4156>>ASSIGN
ATBLK_PG.MISC_INFO.CHKSM
      3205**DCL      4082>>IF
ATBLK_PG.MISC_INFO.KEY_FILE_BLT
      3204**DCL      4078>>IF
ATBLK_PG.NUM_DBPG
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:153  
      3182**DCL      4086>>ASSIGN   4134>>ASSIGN   4139>>ASSIGN   4140>>ASSIGN   4141>>ASSIGN
ATBLK_PG.STATUS
      3209**DCL      3217--REDEF
ATBLK_PG.STATUS.FULL_DUMP
      3215**DCL      4104<<ASSIGN   4107>>IF       4143>>IF       4145>>ASSIGN   4146<<ASSIGN
B$EXCFR.ASL
       288**DCL       288--REDEF
B$EXCFR.ERR.ERR#
       302**DCL       302--REDEF    4549>>IF       4553>>IF
B$EXCFR.EVID
       301**DCL       301--REDEF     302--REDEF
B$EXCFR.IR
       289**DCL       289--REDEF
B$EXCFR.PREVSZ
       288**DCL       288--REDEF
B$EXCFR.SUBC
       300**DCL       300--REDEF     301--REDEF     301--REDEF
B$TCB.ALT$
       285**DCL      4549>>IF       4553>>IF
B$TCB$
      3536**DCL      4549>>IF       4553>>IF
BAD_CHK IN PROCEDURE CHECK_SUM
      4257**PROC     4226--CALL     4246--CALL     4249--CALL
BAD_CHK_HIGH
       140**DCL      4262<<ASSIGN   4265>>IF       4272>>IF       4276>>CALLBLT  4286<<ASSIGN   4289<<ASSIGN
BAD_CHK_LOW
       139**DCL      3923<<ASSIGN   4259>>IF       4261<<ASSIGN   4270>>CALLBLT  4272>>IF       4285<<ASSIGN
BKUPSF
      3436**DCL      3871<<ASSIGN
BREAK_FLAG
      3546**DCL      3927>>IF       4529>>IF
BUFLNSF
      3437**DCL      3809<<ASSIGN   3935<<ASSIGN   4016<<ASSIGN   4030<<ASSIGN   4059<<ASSIGN   4281<<ASSIGN
      4343<<ASSIGN   4388<<ASSIGN   4525<<ASSIGN   4535<<ASSIGN   4541<<ASSIGN   4560<<ASSIGN
BUFSF
      3438**DCL      3808<<ASSIGN   3934<<ASSIGN   4015<<ASSIGN   4029<<ASSIGN   4058<<ASSIGN   4280<<ASSIGN
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:154  
      4342<<ASSIGN   4387<<ASSIGN   4524<<ASSIGN   4531<<ASSIGN   4543<<ASSIGN
BUF_PTR
       112**DCL      3903<<ASSIGN
BUILD_MSTR_TBL
      3799**DCL-ENT  3906--CALL
BUILD_RECXREF
      3801**DCL-ENT  3908--CALL
BUILD_SETXREF
      3800**DCL-ENT  3907--CALL
CARRY_ATTRIBUTESF
      3473**DCL      4459<<ASSIGN
CHECKSUM
       137**DCL      3966>>IF       3990>>IF       3994<<ASSIGN   4083<<ASSIGN   4085<<ASSIGN   4148>>IF
CHECK_PAGES
      3802**DCL-ENT  3980--CALL
CHECK_SUM
      4216**PROC     3967--CALL     3993--CALL
CHKSUM
      3798**DCL-ENT  4152--CALL     4231--CALL
CHK_ERROR IN PROCEDURE PROCESS_KEY_LOAD
      4549**LABEL    4537--CALLALT
CLOSE_FILES
      4575**PROC     3853--CALL     3929--CALL     4012--CALL     4601--CALL     4615--CALL     4626--CALL
      4637--CALL     4640--CALL     4650--CALL
CODE04.CREATION.TIME
      3778**DCL      3834>>ASSIGN
COUNTSF
      3488**DCL      3489--REDEF
DASH IN PROCEDURE CHECK_SUM
      4218**DCL      4268<<ASSIGN   4274<<ASSIGN   4283>>CALLBLT
DASH IN PROCEDURE LOAD_REPRT
      4336**DCL      4373<<ASSIGN   4380<<ASSIGN   4385>>CALLBLT
DATA$
      3139**DCL      3140--IMP-PTR  3963<<ASSIGN   4150<<ASSIGN   4179--IMP-PTR  4185>>ASSIGN   4198>>ASSIGN
      4199>>ASSIGN   4222--IMP-PTR  4234>>IF       4250>>ASSIGN   4252>>ASSIGN
DATAPGS IN PROCEDURE GET_ATBLK
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:155  
      4050**DCL      4048--PROC     4135<<ASSIGN   4140<<ASSIGN
DATA_PG.ACT_DATA
      3152**DCL      3153--REDEF    3154--REDEF    3155--REDEF
DATA_PG.CHKSUM_WD
      3144**DCL      4250<<ASSIGN
DATA_PG.OFF_LN.SEC
      3151**DCL      4185>>ASSIGN
DATESF
      3441**DCL      3839<<ASSIGN
DB_PGNO
       129**DCL      4036>>ASSIGN
DCBSF
      3417**DCL      3807<<ASSIGN   3821<<ASSIGN   3858<<ASSIGN   3873<<ASSIGN   3933<<ASSIGN   4005<<ASSIGN
      4007<<ASSIGN   4014<<ASSIGN   4028<<ASSIGN   4057<<ASSIGN   4279<<ASSIGN   4341<<ASSIGN   4386<<ASSIGN
      4434<<ASSIGN   4452<<ASSIGN   4523<<ASSIGN   4530<<ASSIGN   4539<<ASSIGN   4562<<ASSIGN   4565<<ASSIGN
      4576<<ASSIGN   4577--IF       4585<<ASSIGN   4586--IF       4613<<ASSIGN
DESTDCB
       119**DCL      3868<<ASSIGN   3873>>ASSIGN   3882--ASSIGN   3884--IF       4007>>ASSIGN   4028>>ASSIGN
      4451<<ASSIGN   4452>>ASSIGN   4471--ASSIGN   4539>>ASSIGN   4565>>ASSIGN
DESTSF
      3440**DCL      3837<<ASSIGN
DEST_FILE
       124**DCL      3882<<ASSIGN   4471<<ASSIGN   4646>>ASSIGN
DEST_FILE.CNT
       125**DCL      4421>>ASSIGN   4425<<ASSIGN
DEST_FILE.TEXT
       126**DCL      4344>>CALLBLT  4424<<CALLBLT  4462>>ASSIGN   4472>>IF       4489>>ASSIGN
DONT_CARE IN PROCEDURE PROCESS_KEY_LOAD
      4539**LABEL    4550--GOTO
DUMP_CREATION
       113**DCL      3835<<ASSIGN   3838--ASSIGN   3839--ASSIGN   4348>>CALLBLT
DUMP_INFO.FULL_DUMP IN PROCEDURE GET_ATBLK
      4056**DCL      4102>>IF       4105<<ASSIGN
DUMP_INFO.ID IN PROCEDURE GET_ATBLK
      4055**DCL      4090>>IF       4147<<ASSIGN
ENCRP_SEEDSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:156  
      3446**DCL      3447--REDEF    3937<<ASSIGN   4035<<ASSIGN   4061<<ASSIGN
END_OF_LOAD
      4012**LABEL    3864--GOTO
ERRCODESF
      3448**DCL      3453--REDEF
ERRCODESF.ERR#
      3451**DCL      3850<<ASSIGN   3889<<ASSIGN   3951<<ASSIGN   4073<<ASSIGN   4097<<ASSIGN   4114<<ASSIGN
      4124<<ASSIGN   4243<<ASSIGN   4369<<ASSIGN   4474<<ASSIGN   4510<<ASSIGN   4598<<ASSIGN   4606<<ASSIGN
      4611<<ASSIGN   4623<<ASSIGN   4634<<ASSIGN   4647<<ASSIGN
ERRCODE_RDEF
      3453**DCL      3851>>ASSIGN   3890>>ASSIGN   3952>>ASSIGN   4074>>ASSIGN   4098>>ASSIGN   4115>>ASSIGN
      4125>>ASSIGN   4244>>ASSIGN   4370>>ASSIGN   4475>>ASSIGN   4511>>ASSIGN   4599>>ASSIGN   4607>>ASSIGN
      4612>>ASSIGN   4624>>ASSIGN   4635>>ASSIGN   4648>>ASSIGN
ERRFLGSF
      3477**DCL      3891<<ASSIGN   4096<<ASSIGN   4476<<ASSIGN
ERR_INSERT
      3461**DCL      4072<<ASSIGN   4646<<ASSIGN
ERR_INSERT.TEXT
      3463**DCL      4621<<CALLBLT  4622<>CALL     4632<<CALLBLT  4633<>CALL
EXISTSF
      3467**DCL      3869<<ASSIGN   4455<<ASSIGN   4466<<ASSIGN   4493<<ASSIGN
EXPAND_PAGE
      4167**PROC     3965--CALL
F$DCB.ACTPOS
       260**DCL       260--REDEF
F$DCB.ARS#
       234**DCL       234--REDEF    4187>>ASSIGN   4533>>ASSIGN
F$DCB.ASN#
       249**DCL      4440>>IF       4485>>IF
F$DCB.ATTR
       253**DCL       254--REDEF
F$DCB.BORROW
       268**DCL       268--REDEF     268--REDEF     268--REDEF
F$DCB.DCBNAME.L
       282**DCL       282--IMP-SIZ
F$DCB.EOMCHAR#
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:157  
       238**DCL       238--REDEF
F$DCB.FCD#
       247**DCL      4577>>IF       4586>>IF
F$DCB.FLDID
       263**DCL       263--REDEF
F$DCB.FORM$
       257**DCL       257--REDEF
F$DCB.FSECT
       273**DCL       273--REDEF
F$DCB.FSN#
       250**DCL       250--REDEF     250--REDEF     251--REDEF
F$DCB.HEADER$
       256**DCL       256--REDEF
F$DCB.IXTNSIZE#
       254**DCL       254--REDEF
F$DCB.LASTSTA$
       243**DCL       243--REDEF
F$DCB.LVL
       269**DCL       269--REDEF
F$DCB.NAME#
       244**DCL      3830>>ASSIGN   3882>>ASSIGN   4471>>ASSIGN
F$DCB.NAME#.C
       244**DCL       244--REDEF
F$DCB.NOEOF
       266**DCL       266--REDEF
F$DCB.NRECS#
       255**DCL       255--REDEF
F$DCB.NRECX
       274**DCL       274--REDEF
F$DCB.OHDR
       266**DCL       266--REDEF
F$DCB.ORG#
       249**DCL       249--REDEF    3843>>IF       3843>>IF       3856>>IF       3884>>IF       4485>>IF
F$DCB.PRECNO
       272**DCL       272--REDEF
F$DCB.RCSZ
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:158  
       278**DCL       278--REDEF
F$DCB.RES#
       245**DCL       245--REDEF
F$DCB.SETX
       257**DCL       257--REDEF
F$DCB.TAB$
       257**DCL       257--REDEF
F$DCB.TDA
       271**DCL       272--REDEF
F$DCB.WSN#
       245**DCL       245--REDEF
FIDSF
      3465**DCL      3828<<ASSIGN   3879<<ASSIGN   4445<<ASSIGN   4462<<ASSIGN   4467<<ASSIGN   4489<<ASSIGN
FIDSF_RD
      3464**DCL      3465--REDEF
FIL IN PROCEDURE EXPAND_PAGE
      4176**DCL      4207<<ASSIGN
FILE_INFO
       114**DCL      3832--ASSIGN
FILE_SIZE
       127**DCL      3870>>ASSIGN   4086<<ASSIGN
FILE_TYPE IN PROCEDURE LOAD_ASCFID
      4403**DCL      4401--PROC     4433--ENTRY    4449--ENTRY    4463>>IF       4496>>IF       4504<>CALL
FIL_SIZE IN PROCEDURE EXPAND_PAGE
      4177**DCL      4176--IMP-SIZ  4205<<ASSIGN   4207>>ASSIGN
FIT$
       115**DCL      3776--IMP-PTR  3832<<ASSIGN   3833<>CALL     3834>>ASSIGN
FROM$ IN PROCEDURE EXPAND_PAGE
      4172**DCL      4173--IMP-PTR  4199<<ASSIGN   4201>>CALL     4206>>ASSIGN
FROMSTR IN PROCEDURE EXPAND_PAGE
      4173**DCL      4201<>CALL
FULLSF
      3435**DCL      3936<<ASSIGN   4033<<ASSIGN   4060<<ASSIGN
FULL_LOAD
       141**DCL      4145<<ASSIGN   4298>>IF
FUNSF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:159  
      3428**DCL      3825<<ASSIGN   3877<<ASSIGN   4443<<ASSIGN   4454<<ASSIGN   4492<<ASSIGN
GET_ATBLK
      4048**PROC     3866--CALL
GET_FILESIZE
      3793**DCL-ENT  4494--CALL
HELPCODE
      3482**DCL      3487--REDEF
HIGH_DATA_PG
       108**DCL      3866<>CALL     3964>>IF       3966>>IF
HIGH_LINE IN PROCEDURE EXPAND_PAGE
      4168**DCL      4185<<ASSIGN   4186>>ASSIGN
HIGH_PAGE
       107**DCL      3866<>CALL     3916<>CALL     3984<>CALL
HIGH_PGE IN PROCEDURE CHECK_SUM
      4219**DCL      4269<<ASSIGN   4276<<CALLBLT  4277<>CALL     4283>>CALLBLT
HIGH_PGE IN PROCEDURE LOAD_REPRT
      4338**DCL      4351<<CALLBLT  4352<>CALL     4354>>CALLBLT  4356>>CALLBLT  4374<<ASSIGN   4382<<CALLBLT
      4383<>CALL     4385>>CALLBLT
HIGH_RNG
       106**DCL      4305<<ASSIGN   4308>>IF       4312<<ASSIGN   4315<<ASSIGN   4322<<ASSIGN   4326<<ASSIGN
      4378>>IF       4382>>CALLBLT
HI_PGE IN PROCEDURE GET_ATBLK
      4051**DCL      4048--PROC     4134<<ASSIGN   4135>>ASSIGN   4141<<ASSIGN
I
      3520**DCL      4372<<DOINDEX  4376>>CALLBLT  4378>>IF       4378>>IF       4382>>CALLBLT  4413<<ASSIGN
      4414<<ASSIGN   4414>>ASSIGN   4415>>IF       4415<<ASSIGN   4416>>CALLBLT  4417>>ASSIGN   4421<<ASSIGN
      4422<<ASSIGN   4422>>ASSIGN   4423>>IF       4423<<ASSIGN   4424>>CALLBLT  4425>>ASSIGN
ICHKSUM
      3547**DCL      3548--REDEF    4151<<ASSIGN   4229<<ASSIGN   4234>>IF       4250>>ASSIGN
ICHKSUM_BIT
      3548**DCL      4153>>ASSIGN
IDS_FILE IN PROCEDURE LOAD_REPRT
      4339**DCL      4334--PROC     4344>>CALLBLT  4353>>IF
INV IN PROCEDURE GET_ATBLK
      4049**DCL      4048--PROC     4136<<ASSIGN   4139<<ASSIGN   4140>>ASSIGN
INVPG$
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:160  
      3158**DCL      3159--IMP-PTR
I_O_BUF
      3526**DCL      3934--ASSIGN   3963--ASSIGN   4029--ASSIGN   4058--ASSIGN   4066--ASSIGN   4524--ASSIGN
      4531--ASSIGN   4543--ASSIGN
I_O_BUF$
      3525**DCL       129--IMP-PTR  3526--IMP-PTR  3934>>ASSIGN   3963>>ASSIGN   4029>>ASSIGN   4036>>ASSIGN
      4058>>ASSIGN   4066>>ASSIGN   4524>>ASSIGN   4531>>ASSIGN   4543>>ASSIGN
I_O_BUFF IN PROCEDURE EXPAND_PAGE
      4179**DCL      4198--ASSIGN   4199--ASSIGN
I_O_INDX
       120**DCL      3917<<ASSIGN   3932<<ASSIGN   3932>>ASSIGN   3934>>ASSIGN   3958>>IF       3959<>CALL
      3960<<ASSIGN   3963>>ASSIGN   3976>>IF       3981>>CALL     3983<<ASSIGN   4522<<ASSIGN   4531>>ASSIGN
      4540<<ASSIGN   4540>>ASSIGN   4543>>ASSIGN
I_O_SIZE
      3528**DCL      3916<>CALL     3984<>CALL
KEYRSF
      3470**DCL      4563<<ASSIGN
KEYSF
      3419**DCL      3938<<ASSIGN   4062<<ASSIGN   4566<<ASSIGN
KEYVSF
      3420**DCL      3425--REDEF
KEYVSF.IDSKEY
      3423**DCL      3940<<ASSIGN   4036<<ASSIGN   4064<<ASSIGN
KEYVSF.LEN
      3421**DCL      3939<<ASSIGN   4063<<ASSIGN
KEYVSF.WD_ONE
      3422**DCL      3423--REDEF
KEY_FILE_ASSOC
       133**DCL      4002>>IF       4079<<ASSIGN   4081<<ASSIGN
LAST_PAGE
       134**DCL      3900<<ASSIGN   3916<>CALL     3924>>DOWHILE  3984<>CALL
LEFT_JUSTIFY
       132**DCL      4277<>CALL     4383<>CALL     4622<>CALL     4633<>CALL
LOADING_MSG
      3805**PROC     3922--CALL     4497--CALL
LOAD_ASCFID
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:161  
      4401**PROC     4009--CALL
LOAD_DISK_INDEX IN PROCEDURE LOAD_ASCFID
      4433**ENTRY    3860--CALL
LOAD_REPRT
      4334**PROC     3998--CALL     4504--CALL
LOAD_TAPE_INDEX IN PROCEDURE LOAD_ASCFID
      4449**ENTRY    3863--CALL
LOW_DBK
       111**DCL      4156<<ASSIGN
LOW_PGE IN PROCEDURE CHECK_SUM
      4220**DCL      4270<<CALLBLT  4271<>CALL     4283>>CALLBLT
LOW_PGE IN PROCEDURE LOAD_REPRT
      4337**DCL      4376<<CALLBLT  4377<>CALL     4385>>CALLBLT
LOW_RNG
       105**DCL      4302>>IF       4304<<ASSIGN   4311<<ASSIGN   4321<<ASSIGN   4325<<ASSIGN   4364>>IF
      4376>>CALLBLT  4378>>IF       4394<<ASSIGN
LPP
       110**DCL      4157<<ASSIGN
M$LO
      3535**DCL      3807>>ASSIGN   4014>>ASSIGN   4279>>ASSIGN   4341>>ASSIGN   4386>>ASSIGN
MSGCODE
      3454**DCL      3455--REDEF    3851<<ASSIGN   3890<<ASSIGN   3952<<ASSIGN   4074<<ASSIGN   4098<<ASSIGN
      4115<<ASSIGN   4125<<ASSIGN   4244<<ASSIGN   4370<<ASSIGN   4475<<ASSIGN   4511<<ASSIGN   4599<<ASSIGN
      4607<<ASSIGN   4612<<ASSIGN   4624<<ASSIGN   4635<<ASSIGN   4648<<ASSIGN
MSG_FLG
       136**DCL      3990>>IF       3995<<ASSIGN   4236>>IF       4238<<ASSIGN
MSTR$
      2666**DCL      2669--IMP-PTR
MSTR_REF.NXTHSH
      2672**DCL      2673--REDEF
MSTR_REF.PAENT
      2678**DCL      2679--REDEF
MSTR_REF.PAOFF
      2675**DCL      2676--REDEF
NBUFS
      3795**DCL      4522>>ASSIGN   4525>>ASSIGN   4535>>ASSIGN   4540>>ASSIGN
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:162  
NOTIMESF
      3427**DCL      4032<<ASSIGN
NO_KEYSF
      3471**DCL      3945>>IF
NUM_INV_PGS
       109**DCL      3866<>CALL
NUM_RECS IN PROCEDURE WRITE_BUF
      4027**DCL      4026--PROC     4030>>ASSIGN
ORGSF
      3418**DCL      3823<<ASSIGN   3874<<ASSIGN   4435<<ASSIGN   4457<<ASSIGN   4482<<ASSIGN
PAGE IN PROCEDURE CHECK_SUM
      4217**DCL      4267<<ASSIGN   4275<<ASSIGN   4283>>CALLBLT
PAGE IN PROCEDURE LOAD_REPRT
      4335**DCL      4375<<ASSIGN   4381<<ASSIGN   4385>>CALLBLT
PAGE_RANGE
      3796**DCL-ENT  3916--CALL     3984--CALL
PAGE_REPORT IN PROCEDURE LOAD_REPRT
      4359**ENTRY    4319--CALL
PGE_INDX
       103**DCL      4300>>IF       4302>>IF       4304>>ASSIGN   4305>>ASSIGN   4308>>IF       4310<<ASSIGN
      4310>>ASSIGN   4311>>ASSIGN   4312>>ASSIGN   4315>>ASSIGN   4320<<DOINDEX  4321>>ASSIGN   4322>>ASSIGN
      4324<<ASSIGN   4372>>DOINDEX  4393<<ASSIGN
PGS_LOAD
       104**DCL      3899<<ASSIGN   3968<<ASSIGN   3968>>ASSIGN   4351>>CALLBLT  4481<<ASSIGN   4545<<ASSIGN
      4545>>ASSIGN   4559<<ASSIGN
POSSF
      3476**DCL      4004<<ASSIGN   4579<<ASSIGN
PRINT_CHKS
       138**DCL      3992<<ASSIGN   3996<<ASSIGN   4224>>IF       4265>>IF
PROCESS_A00_LOAD IN PROCEDURE PROCESS_KEY_LOAD
      4558**ENTRY    4500--CALL
PROCESS_KEY_LOAD
      4520**PROC     4503--CALL
RB
      3507**DCL      3916<>CALL     3925>>ASSIGN   3926<<DOINDEX  3926>>DOINDEX  3940>>ASSIGN   3964>>IF
      3966>>IF       3978<<ASSIGN   3984<>CALL     4252>>ASSIGN   4261>>ASSIGN   4262>>ASSIGN   4265>>IF
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:163  
      4285>>ASSIGN   4286>>ASSIGN   4289>>ASSIGN   4304>>ASSIGN   4305>>ASSIGN   4308>>IF       4311>>ASSIGN
      4312>>ASSIGN   4315>>ASSIGN   4325>>ASSIGN   4326>>ASSIGN   4621>>CALLBLT  4632>>CALLBLT
RBTEMP
       117**DCL      3925<<ASSIGN   3978>>ASSIGN
RE
      3508**DCL      3916<>CALL     3926>>DOINDEX  3984<>CALL
REASGNSF
      3472**DCL      4444<<ASSIGN   4461<<ASSIGN   4465<<ASSIGN   4490<<ASSIGN
REC$
      3506**DCL      3529--IMP-PTR
REC_DATA_LN
      3534**DCL      3533--IMP-SIZ
REC_XREF$
      2721**DCL      2722--IMP-PTR
REPRT
       128**DCL      3806<<ASSIGN   3808--ASSIGN   4013<<ASSIGN   4015--ASSIGN   4280--ASSIGN   4283<<CALLBLT
      4342--ASSIGN   4344<<CALLBLT  4348<<CALLBLT  4354<<CALLBLT  4356<<CALLBLT  4385<<CALLBLT  4387--ASSIGN
RIGHT_JUSTIFY
       131**DCL      4271<>CALL     4377<>CALL
SET_XREF$
      2710**DCL      2711--IMP-PTR
SHARESF
      3468**DCL      3826<<ASSIGN   3880<<ASSIGN   4446<<ASSIGN
SHIFT_ARRAY IN PROCEDURE EXPAND_PAGE
      4178**DCL-ENT  4201--CALL
SOURCESF
      3439**DCL      3836<<ASSIGN
SRCEDCB
       118**DCL      3820<<ASSIGN   3821>>ASSIGN   3830--ASSIGN   3843--IF       3843--IF       3856--IF
      3858>>ASSIGN   3933>>ASSIGN   4005>>ASSIGN   4057>>ASSIGN   4187--ASSIGN   4440--IF       4485--IF
      4485--IF       4530>>ASSIGN   4533--ASSIGN   4562>>ASSIGN   4613>>ASSIGN
SRCE_FILE
       121**DCL      3830<<ASSIGN
SRCE_FILE.CNT
       122**DCL      4344>>CALLBLT  4413>>ASSIGN   4417<<ASSIGN
SRCE_FILE.TEXT
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:164  
       123**DCL      4344>>CALLBLT  4416<<CALLBLT  4445>>ASSIGN
STEPCC
      3524**DCL      3991<<ASSIGN   4019>>IF       4299<<ASSIGN
SYS_FUNC_CHECK
      3791**DCL-ENT  4532--CALL
SYS_FUNC_CLOS
      3790**DCL-ENT  3859--CALL     4006--CALL     4008--CALL     4580--CALL     4587--CALL
SYS_FUNC_ERRMSG
      3784**DCL-ENT  3852--CALL     3892--CALL     3953--CALL     4075--CALL     4099--CALL     4116--CALL
      4126--CALL     4245--CALL     4371--CALL     4477--CALL     4512--CALL     4600--CALL     4608--CALL
      4614--CALL     4625--CALL     4636--CALL     4649--CALL
SYS_FUNC_OPEN
      3786**DCL-ENT  3829--CALL     3881--CALL     4447--CALL     4470--CALL     4495--CALL
SYS_FUNC_READ
      3787**DCL-ENT  3941--CALL     4065--CALL     4527--CALL     4537--CALL     4564--CALL
SYS_FUNC_RELDCB
      3789**DCL-ENT  4582--CALL     4588--CALL
SYS_FUNC_RELEASE
      3794**DCL-ENT  4480--CALL
SYS_FUNC_TSTAMP
      3792**DCL-ENT  3841--CALL
SYS_FUNC_WRIT
      3788**DCL-ENT  3811--CALL     4018--CALL     4037--CALL     4284--CALL     4347--CALL     4350--CALL
      4358--CALL     4390--CALL     4544--CALL     4568--CALL
TESTSF
      3430**DCL      3822<<ASSIGN   3875<<ASSIGN   4436<<ASSIGN   4460<<ASSIGN   4491<<ASSIGN
TIMESF
      3442**DCL      3838<<ASSIGN
TO$ IN PROCEDURE EXPAND_PAGE
      4174**DCL      4175--IMP-PTR  4198<<ASSIGN   4201>>CALL     4206<<ASSIGN   4207>>ASSIGN
TOSTR IN PROCEDURE EXPAND_PAGE
      4175**DCL      4201<>CALL
TSTAMP
       116**DCL      3834<<ASSIGN   3840--ASSIGN
TSTAMPSF
      3445**DCL      3840<<ASSIGN
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:165  
UBIN36 IN PROCEDURE CHECK_SUM
      4222**DCL      4234>>IF       4252<<ASSIGN
VFCSF
      3434**DCL      3810<<ASSIGN   4017<<ASSIGN   4034<<ASSIGN   4282<<ASSIGN   4346<<ASSIGN   4349<<ASSIGN
      4357<<ASSIGN   4389<<ASSIGN   4542<<ASSIGN   4567<<ASSIGN
WAITSF
      3433**DCL      4031<<ASSIGN   4526<<ASSIGN   4536<<ASSIGN
WRITE_BUF
      4026**PROC     3898--CALL     3959--CALL     3981--CALL
X
      3523**DCL      3910<<ASSIGN   3911>>DOWHILE  3912<<ASSIGN   3912>>ASSIGN   3914>>ASSIGN   4533<<ASSIGN
      4534>>IF       4541>>ASSIGN   4545>>ASSIGN
XREF_BUILT
      2730**DCL      3904>>IF
XSF$LOCCODP
      3803**DCL-ENT  3833--CALL
XTENSIZESF
      3431**DCL      3870<<ASSIGN   4456<<ASSIGN   4559>>ASSIGN
ZERO_SUP
      3797**DCL-ENT  4271--CALL     4277--CALL     4352--CALL     4377--CALL     4383--CALL     4622--CALL
      4633--CALL
ZI$DIR.ACNT
      2915**DCL      3872>>ASSIGN   4468>>ASSIGN
ZI$DIR.ALTKEY
      2963**DCL      2964--REDEF    2965--REDEF
ZI$DIR.AREAFID
      2929**DCL      2930--REDEF
ZI$DIR.AREA_NM.NAME.TEXT
      2995**DCL      3911>>DOWHILE
ZI$DIR.CHECK
      2938**DCL      3901>>IF       3947>>IF       3954<<ASSIGN   3979>>IF
ZI$DIR.DATE
      2968**DCL      2972--REDEF
ZI$DIR.DEST_NM.DCB#
      3006**DCL      3868>>ASSIGN   4451>>ASSIGN   4583>>IF       4585>>ASSIGN
ZI$DIR.DEST_NM.NAME
PL6.E3A0      #001=ZIU$LOAD File=ZIU$LOAD.:ZIC0TSI                               FRI 09/05/97 13:17 Page:166  
      3003**DCL      4072>>ASSIGN
ZI$DIR.DEST_NM.NAME.TEXT
      3005**DCL      3879>>ASSIGN   4067>>IF       4467>>ASSIGN
ZI$DIR.DEST_SEED
      2924**DCL      2925--REDEF    2926--REDEF    4035>>ASSIGN
ZI$DIR.ENCP_SEED
      2921**DCL      2922--REDEF    2923--REDEF    3937>>ASSIGN   4061>>ASSIGN
ZI$DIR.NOKEYS
      2934**DCL      4002>>IF       4144<<ASSIGN
ZI$DIR.NOPRNT
      2939**DCL      3956>>IF
ZI$DIR.OPEN_MODE
      2933**DCL      3846>>IF       3869>>ASSIGN   4107>>IF       4119>>IF       4466>>ASSIGN
ZI$DIR.POS
      2980**DCL      4579>>ASSIGN
ZI$DIR.REPRT_ZERO
      2955**DCL      2956--REDEF
ZI$DIR.RNG_LIST
      2898**DCL      4119>>IF
ZI$DIR.SCHFID
      2927**DCL      2928--REDEF
ZI$DIR.SRCE_NM.DCB#
      3001**DCL      3820>>ASSIGN   4434>>ASSIGN   4523>>ASSIGN   4576>>ASSIGN   4583>>IF
ZI$DIR.SRCE_NM.NAME.TEXT
      3000**DCL      3828>>ASSIGN
ZI$DIR.TIME
      2973**DCL      2978--REDEF
