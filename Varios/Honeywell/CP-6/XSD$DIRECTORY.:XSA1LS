VERSION A01

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:1    
        1        1        /*M* XSD$DIRECTORY - user interface to the directory service library.*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
        8        8
        9        9        /*D* XSD$DIRECTORY(XSD_SERVICE) ALTRET
       10       10                provides user interface to the services of the directory. */
       11       11
       12       12
       13       13        XSD$DIRECTORY: PROC(XSD$SERVICE) ALTRET;
       14       14
       15       15
       16       16        %INCLUDE CP_6;
       17     5575        %INCLUDE XSD_MACRO_M;
       18     6684        %INCLUDE XSD_PERR_C;
       19     6706        %INCLUDE FM$FIT;
       20     6927        %INCLUDE FM_FIELD_C;
       21     6968        %INCLUDE XSD_SUBS_C;
       22     7303        %INCLUDE XSC_COMMON_M;
       23     7956        %INCLUDE XSC_ACSE_M;
       24     8265        %INCLUDE XSC_ACSE_E;
       25     8343        %INCLUDE K_ADDRESS_M;
       26     8846        %INCLUDE XSP_ASN1_M;
       27     9192
       28     9193        %XSD_SERVICE(NAME=XSD$SERVICE,STCLASS="");
       29     9358
       30     9359        /* entry definitions */
       31     9360    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       32     9361    1   DCL XSD$READ ENTRY(1) ALTRET;
       33     9362    1   DCL XSD$SEARCH ENTRY(1) ALTRET;
       34     9363    1   DCL XSD$MODIFY ENTRY(1) ALTRET;
       35     9364    1   DCL XSD$BIND ENTRY(6) ALTRET;
       36     9365    1   DCL XSD$UNBIND ENTRY(6) ALTRET;
       37     9366    1   DCL XSD$LOCFIELD ENTRY(4) ALTRET;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:2    
       38     9367    1   DCL XSS$GETMEM ENTRY(3) ALTRET;
       39     9368    1   DCL XSS$BUFPTR ENTRY(2) ALTRET;
       40     9369    1   DCL XSS$RELMEM ENTRY(1) ALTRET;
       41     9370    1   DCL XSC$ROSE_RECV ENTRY(1) ALTRET;
       42     9371    1   DCL XSD$RECV ENTRY(1) ALTRET;
       43     9372    1   DCL XSC$COMMINIT ENTRY(1) ALTRET;
       44     9373    1   DCL XSC$COMMTERM ENTRY(1) ALTRET;
       45     9374    1   DCL XSC$ACSE ENTRY(1) ALTRET;
       46     9375    1   DCL XSD$DSDATA ENTRY CONV(5);           /* so LEMUR lib works */
       47     9376    1   DCL XSD$TABLE ENTRY CONV(5);            /* so LEMUR lib works */
       48     9377
       49     9378
       50     9379        /* system symrefs */
       51     9380    1   DCL B$JIT$ PTR SYMREF;
       52     9381    1   DCL B$TCB$ PTR SYMREF;
       53     9382    1   DCL B$ROSEG$ PTR SYMREF;
       54     9383
       55     9384        /* system based */
       56     9385        %B$ALT;
       57     9393        %B$TCB(STCLASS="BASED(B$TCB$)");
       58     9396        %F$DCB(STCLASS="BASED");
       59     9453        %FM$FIELD_START(STCLASS="BASED");
       60     9475
       61     9476        /* static system fpts */
       62     9477        %FPT_OPEN(FPTN=OPENDIB_UPDATE,ACCT=DIBACCT,NAME=IRELNAME,DISP=NAMED,SHARE=ALL,
       63     9478                  FUN=UPDATE,ORG=IREL,DCB=M$DIB,ASN=FILE,FPARAM=FPARAM);
       64     9587
       65     9588        %FPT_READ(FPTN=IRELREAD,DCB=M$DIB,KEYS=YES,KEYR=YES,
       66     9589                  ID=YES,IDBUF=VLP_ID,KEY=XSD_DIBKEY);
       67     9628
       68     9629        %FPT_PRECORD(FPTN=IRELPRECORD,DCB=M$DIB,IDALL=YES,IDBUF=VLR_ID,
       69     9630                     KEYS=YES,KEY=XSD_DIBKEY);
       70     9651
       71     9652        %FPT_WRITE(FPTN=IRELWRITE,DCB=M$DIB,NEWKEY=NO);
       72     9683
       73     9684        %FPT_CLOSE(FPTN=IRELCLOSE,DISP=SAVE,DCB=M$DIB);
       74     9726
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:3    
       75     9727        %VLP_ACCT(FPTN=DIBACCT,ACCT='        ',STCLASS="STATIC SYMDEF");
       76     9740        %VLP_NAME(FPTN=IRELNAME,NAME=':DIB',STCLASS="STATIC SYMDEF");
       77     9767        %VLP_ID;
       78     9780        %VLR_ID(N=200,STCLASS="STATIC SYMDEF"); /* what should we do about this */
       79     9793        %VLP_ATTR (FPTN=DIB_ACSVEH);
       80     9807        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='ROUTECON?');
       81     9824        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='DSA?',LAST=";");
       82     9841        %CODE18(BASED="BASED(CODE18$)");
       83     9845        %CODE19(BASED="BASED(CODE19$)");
       84     9848        %CODE20(BASED="BASED(CODE21$)");
       85     9853        %FPT_MONINFO(MONINFO=VLR_MONINFO);
       86     9868        %VLR_MONINFO;
       87     9886
       88     9887        /* constant */
       89     9888        %VLP_ERRCODE(FPTN=ERR_C,FCG=XS,MID=D,MON='0'B,STCLASS=CONSTANT);
       90     9933        %VLP_ERRCODE(FPTN=E_RELMEM,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       91     9934                     ERR#=%E$RELMEM);
       92     9979        %VLP_ERRCODE(FPTN=E_NOMEM,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       93     9980                      ERR#=%E$NOMEM);
       94    10025        %VLP_ERRCODE(FPTN=E_BADFUNCTION,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       95    10026                      ERR#=%E$BADFUNCTION);
       96    10071        %VLP_ERRCODE(FPTN=E_DUANOTDEFINED,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       97    10072                      ERR#=%E$DUANOTDEFINED);
       98    10117        %VLP_ERRCODE(FPTN=E_BADSUBCODE,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       99    10118                      ERR#=%E$BADSUBCODE);
      100    10163        %VLP_ERRCODE(FPTN=E_DSANOTDEFINED,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      101    10164                      ERR#=%E$DSANOTDEFINED);
      102    10209        %VLP_ERRCODE(FPTN=E_NODSASDEFINED,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      103    10210                      ERR#=%E$NODSASDEFINED);
      104    10255        %VLP_ERRCODE(FPTN=E_BADATTRIBUTE,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      105    10256                      ERR#=%E$BADATTRIBUTE);
      106    10301        %VLP_ERRCODE(FPTN=E_COMMINIT,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      107    10302                      ERR#=%E$COMMINIT);
      108    10347    1   DCL DUA CHAR(0) CONSTANT INIT('DUA');
      109    10348        %XSD_CONTEXT(NAME=CONTEXT_C,STCLASS=CONSTANT);
      110    10403        %XSP_ASN1_FPT(FPTN=ASN1_FPT_C,STCLASS=CONSTANT);
      111    10423
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:4    
      112    10424        /* system dcbs */
      113    10425    1   DCL M$DIB DCB;
      114    10426    1   DCL M$DSA DCB;                          /* communication dcb to the dsa */
      115    10427
      116    10428        /* symrefs */
      117    10429    1   DCL XSD_DS_OPENDIB SBIN SYMREF;
      118    10430    1   DCL XSD_CONTEXTXS SBIN HALF HALIGNED SYMREF;
      119    10431    1   DCL XSD_CONTEXTX REDEF XSD_CONTEXTXS UBIN HALF HALIGNED;
      120    10432        %XSD_TEXTH(NAME=XSD_DIRECTORYACCESSAC,STCLASS=SYMREF); /* a DUA by any other name */
      121    10472    1   DCL XSD_PCDL_DUA UBIN SYMREF;      /* presentation context definition list */
      122    10473        %XSD_DIBKEY(NAME=XSD_DIBKEY,STCLASS=SYMREF);
      123    10509
      124    10510        /* based */
      125    10511    1   DCL 1 TEXTC BASED,
      126    10512    1            2 L UBIN(9) UNAL,
      127    10513    1            2 T CHAR(TEXTC.L) UNAL;
      128    10514
      129    10515        %XSD_BIND(NAME=BINDFROM,ALGN=ALIGNED,STCLASS="BASED(BINDFROM$)");
      130    10737        %XSD_BIND(NAME=BINDTO,ALGN=ALIGNED,STCLASS="BASED(BINDTO$)");
      131    10959
      132    10960        %XSD_SERVICE(NAME=SERVICE,STCLASS="BASED(SERVICE$)");
      133    11125        %XSD_CONTEXT(NAME=CONTEXT,STCLASS="BASED(CONTEXT$)");
      134    11180    1   DCL BUFFER CHAR(SIZE) BASED(BUF$);
      135    11181        %XSD_DIBBUF(NAME=XSD_DIBBUF,STCLASS="BASED(BUF$)");
      136    11246
      137    11247        /* user static */
      138    11248    1   DCL FPARAM(0:1023) UBIN STATIC INIT(0*0);
      139    11249    1   DCL CODE18$ PTR STATIC SYMDEF;
      140    11250    1   DCL CODE19$ PTR STATIC SYMDEF;
      141    11251    1   DCL CODE21$ PTR STATIC SYMDEF;
      142    11252        %XSC$CCB(NAME=CCB,STCLASS=STATIC,ADDRESS=XSC$ADDRESS,SASE1="XSC$ROSE_RECV",
      143    11253                 DCB#="DCBNUM(M$DSA)",MODE=CLIENT,ACSE=XSD$RECV,PRES=XSC$ROSE_RECV);
      144    11550        %XSC$ASSOCIATE(FPTN=AASCREQ,FNC=REQ,STCLASS=STATIC,ACN=XSD_DIRECTORYACCESSAC,
      145    11551                       CTXT=XSD_PCDL_DUA);
      146    11626        %XSC$ADDRESS(STCLASS=STATIC);
      147    11909
      148    11910        /* user auto */
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:5    
      149    11911    1   DCL STARTX UBIN;
      150    11912    1   DCL DIBERR UBIN;
      151    11913    1   DCL I SBIN;
      152    11914    1   DCL SIZE REDEF I UBIN;
      153    11915    1   DCL BINDFROM$ PTR;
      154    11916    1   DCL BINDFROMX UBIN HALF HALIGNED;
      155    11917    1   DCL BINDFROMXS REDEF BINDFROMX SBIN HALF HALIGNED;
      156    11918    1   DCL BINDTO$ PTR;
      157    11919    1   DCL BINDTOX UBIN HALF HALIGNED;
      158    11920    1   DCL BINDTOXS REDEF BINDTOX SBIN HALF HALIGNED;
      159    11921    1   DCL SERVICE$ PTR;
      160    11922    1   DCL SERVICEX UBIN HALF HALIGNED;
      161    11923    1   DCL SERVICEXS REDEF SERVICEX SBIN HALF HALIGNED;
      162    11924    1   DCL BUFX UBIN HALF HALIGNED;
      163    11925    1   DCL BUFXS REDEF BUFX SBIN HALF HALIGNED;
      164    11926    1   DCL BUF$ PTR;
      165    11927    1   DCL CONTEXTX UBIN HALF HALIGNED;
      166    11928    1   DCL CONTEXTXS REDEF CONTEXTX SBIN HALF HALIGNED;
      167    11929    1   DCL CONTEXT$ PTR;
      168    11930    1   DCL CCBX UBIN HALF HALIGNED;
      169    11931    1   DCL CCBXS REDEF CCBX SBIN HALF HALIGNED;
      170    11932    1   DCL CCB$ PTR;
      171    11933    1   DCL DUAKEYID UBIN;
      172    11934        %XSP_ASN1_FPT(FPTN=XSP@ASN1_FPT,STCLASS=AUTO);
      173    11954
      174    11955
      175    11956        /* sop */
      176    11957
      177    11958    2        IF XSD$SERVICE.FNC > %XSD_FNC_MAX THEN DO;
      178    11959    2             XSD$SERVICE.ERRCODE = E_BADFUNCTION;
      179    11960    2             ALTRETURN;
      180    11961    2          END;
      181    11962
      182    11963    2        IF XSD$SERVICE.SUBC > %XSD_SUBC_MAX THEN DO;
      183    11964    2             XSD$SERVICE.ERRCODE = E_BADSUBCODE;
      184    11965    2             ALTRETURN;
      185    11966    2          END;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:6    
      186    11967
      187    11968    1        DIBERR = 0;
      188    11969    2        IF XSD_DS_OPENDIB < 0 THEN DO;
      189    11970    3             CALL M$OPEN(OPENDIB_UPDATE) WHENALTRETURN DO;
      190    11971    3                  XSD$SERVICE.ERRCODE = B$TCB.ALT$->B$ALT.ERR;
      191    11972    3                  ALTRETURN;
      192    11973    3               END;
      193    11974    2             CODE18$ = ADDR(FPARAM);
      194    11975    3             CALL XSF$LOCCODP(CODE18$,18) WHENALTRETURN DO;
      195    11976    3                  DIBERR = %E$NOCODE18BLK;
      196    11977    3               END;
      197    11978    2             CODE19$ = ADDR(FPARAM);
      198    11979    3             CALL XSF$LOCCODP(CODE19$,19) WHENALTRETURN DO;
      199    11980    3                  DIBERR = %E$NOCODE19BLK;
      200    11981    3               END;
      201    11982    2             CODE21$ = ADDR(FPARAM);
      202    11983    3             CALL XSF$LOCCODP(CODE21$,21) WHENALTRETURN DO;
      203    11984    3                  DIBERR = %E$NOCODE21BLK;
      204    11985    3               END;
      205    11986
      206    11987    3             IF DIBERR ~= 0 THEN DO;
      207    11988    3                  XSD$SERVICE.ERRCODE = ERR_C;
      208    11989    3                  XSD$SERVICE.ERRCODE.ERR# = DIBERR;
      209    11990    3                  ALTRETURN;
      210    11991    3               END;
      211    11992
      212    11993    2             XSD_DS_OPENDIB = DCBADDR(DCBNUM(M$DIB))->F$DCB.ARS#;
             11993                      /* set opendib to largest current record*/
      213    11994    2          END;                             /* if dib not open */
      214    11995        /*
      215    11996             if a local address will suffice, then
      216    11997        */
      217    11998    2        IF XSD$SERVICE.FLAGS.LOCALOKAY THEN DO;
      218    11999    3             DO CASE(XSD$SERVICE.FNC);
      219    12000    3              CASE(%XSD_FNC_READ);
      220    12001    4                CALL XSD$READ(XSD$SERVICE) WHENRETURN DO;
      221    12002    4                     IF XSD$SERVICE.UENTADDR$ = ENTADDR(NIL) THEN RETURN;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:7    
      222    12003    4                     CALL XSD$SERVICE.UENTADDR$(XSD$SERVICE);
             12003                              /* ignore altreturns from the user */
      223    12004    4                     RETURN;
      224    12005    4                  END;
      225    12006    3              CASE(%XSD_FNC_SEARCH);
      226    12007    4                CALL XSD$SEARCH(XSD$SERVICE) WHENRETURN DO;
      227    12008    4                  END;
      228    12009    3              CASE(%XSD_FNC_MODIFY);
      229    12010    4                CALL XSD$MODIFY(XSD$SERVICE) WHENRETURN DO;
      230    12011    4                  END;
      231    12012    3             END;                          /* case on function */
      232    12013    2          END;                             /* if localokay */
      233    12014        /*
      234    12015             either localokay was not specified or the local search failed.
      235    12016             begin bind.
      236    12017        */
      237    12018    1        BINDFROMXS = -1;
      238    12019    1        BINDTOXS = -1;
      239    12020    1        SERVICEXS = -1;
      240    12021    1        BUFXS = -1;
      241    12022
      242    12023        /* get a buffer to read dib records into */
      243    12024
      244    12025    2        CALL XSS$GETMEM(BUFX,BUF$,XSD_DS_OPENDIB) WHENALTRETURN DO;
      245    12026    2             XSD$SERVICE.ERRCODE = E_NOMEM;
      246    12027    2             XSD$SERVICE.ERRCODE.SEV = 3;
      247    12028    2             GOTO ERR;
      248    12029    2          END;
      249    12030
      250    12031    2        IF XSD_CONTEXTXS = -1 THEN DO;     /* this is the first time thru */
      251    12032    3             CALL XSS$GETMEM(XSD_CONTEXTXS,CONTEXT$,LENGTHC(CONTEXT)) WHENALTRETURN DO;
      252    12033    3                  XSD$SERVICE.ERRCODE = E_NOMEM;
      253    12034    3                  XSD$SERVICE.ERRCODE.SEV = 4;
      254    12035    3                  GOTO ERR;
      255    12036    3               END;
      256    12037    2             CONTEXT = CONTEXT_C;
      257    12038    3             IF XSD$SERVICE.BINDFROM$ = ADDR(NIL) THEN DO;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:8    
      258    12039    3                  CALL M$MONINFO(FPT_MONINFO)
      259    12040    4                  WHENRETURN DO;
      260    12041    4                       XSD_DIBKEY.DIBUNIQUE = VLR_MONINFO.NODE_NAME;
      261    12042    4                       CALL INDEX(I,' ',VLR_MONINFO.NODE_NAME);
      262    12043    4                       CALL CONCAT(XSD_DIBKEY.DIBUNIQUE,SUBSTR(VLR_MONINFO.NODE_NAME,0,
             12043                                I),DUA);
      263    12044    4                    END;                   /* whenreturn on moninfo */
      264    12045    4                  WHENALTRETURN DO;
      265    12046    4                       XSD$SERVICE.ERRCODE = B$TCB.ALT$->B$ALT.ERR;
      266    12047    4                    END;
      267    12048    3               END;                        /* bindfrom = nil */
      268    12049    3             ELSE DO;
      269    12050             /*  use dua address specified by the user */
      270    12051    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,0,XSD$SERVICE.BINDFROM$->TEXTC.L) =
             12051                           XSD$SERVICE.BINDFROM$->TEXTC.T;
      271    12052             /* and blank fill it */
      272    12053    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,XSD$SERVICE.BINDFROM$->TEXTC.L,%
             12053                           XSD_DIBKEY_LEN) = ' ';
      273    12054    3               END;
      274    12055
      275    12056
      276    12057    2             IRELREAD.BUF_ = VECTOR(XSD_DIBBUF);
      277    12058    2             IRELREAD.BUF_.BOUND = XSD_DS_OPENDIB-1;
      278    12059    2             IRELREAD.V.INDX# = %XSD_KEYX_UNIQUE;
      279    12060    2             IRELREAD.KEY_ = VECTOR(XSD_DIBKEY.DIBUNIQUE);
      280    12061    3             CALL M$READ(IRELREAD) WHENALTRETURN DO;
      281    12062    3                  XSD$SERVICE.ERRCODE = E_DUANOTDEFINED;
      282    12063    3                  GOTO ERR;
      283    12064    3               END;
      284    12065
      285    12066    2             DUAKEYID = VLP_ID.ID#;
      286    12067
      287    12068    3             CALL XSS$GETMEM(BINDFROMX,BINDFROM$,LENGTHC(BINDFROM)) WHENALTRETURN DO;
      288    12069    3                  XSD$SERVICE.ERRCODE = E_NOMEM;
      289    12070    3                  XSD$SERVICE.ERRCODE.SEV = 0; /* on call to bind from */
      290    12071    3                  ALTRETURN;
      291    12072    3               END;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:9    
      292    12073
      293    12074
      294    12075    2             STARTX = DCBADDR(DCBNUM(M$DIB))->F$DCB.STARTX;
      295    12076    2             BINDFROM.COMMONNAME = ADDR(XSD_DIBBUF.KEY.COMMONNAME)->TEXTC;
      296    12077    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_PSELECTOR,SIZEC(XSD_DIBBUF));
      297    12078    2             BINDFROM.PRES = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      298    12079    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_SSELECTOR,SIZEC(XSD_DIBBUF));
      299    12080    2             BINDFROM.SESS = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      300    12081    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_TSELECTOR,SIZEC(XSD_DIBBUF));
      301    12082    2             BINDFROM.TRAN = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      302    12083    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_NSAP,SIZEC(XSD_DIBBUF));
      303    12084    2             BINDFROM.NSAP = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      304    12085
      305    12086    3             IF XSD$SERVICE.BINDTO$ = ADDR(NIL) THEN DO;
      306    12087          /*
      307    12088            search for a dsa to talk to
      308    12089          */
      309    12090    3                  XSD_DIBKEY.OBJECTCLASS = %XSD_OC_DSA;
      310    12091    3                  IRELPRECORD.KEY_ = VECTOR(XSD_DIBKEY.OBJECTCLASS);
      311    12092    3                  IRELPRECORD.V.INDX# = %XSD_KEYX_OBJECTCLASS;
      312    12093    4                  CALL M$PRECORD(IRELPRECORD) WHENALTRETURN DO;
      313    12094    4                       XSD$SERVICE.ERRCODE = E_DSANOTDEFINED;
      314    12095    4                       GOTO ERR;
      315    12096    4                    END;
      316    12097    4                  IF VLR_ID.COUNT# < 2 THEN DO;
             12097                           /* no remote dsa defined only the local */
      317    12098    4                       XSD$SERVICE.ERRCODE = E_NODSASDEFINED;
      318    12099    4                       GOTO ERR;
      319    12100    4                    END;
      320    12101          /*
      321    12102             Connect to the first dsa in the dib.  need to find a way to return
      322    12103             other dsas to user so that subsequent calls can try those dsas. or better
      323    12104             yet the knowledge information field could be use to weed down the list
      324    12105             of dsa, by indicating what kind of entries a specific dsa has knowledge
      325    12106          */
      326    12107    3                  IRELREAD.V.IDS# = '1'B;
      327    12108    3                  IRELREAD.V.KEYS# = '0'B;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:10   
      328    12109    3                  IRELREAD.V.KEYR# = '0'B;
      329    12110    4                  DO I = 0 TO VLR_ID.COUNT# - 1;
      330    12111    5                     IF DUAKEYID ~= VLR_ID.ID#(I) THEN DO;
      331    12112    5                          VLP_ID.ID# = VLR_ID.ID#(I);
      332    12113    6                          CALL M$READ(IRELREAD) WHENRETURN DO;
      333    12114    6                               GOTO FOUNDONE;
      334    12115    6                            END;
      335    12116    6                          WHENALTRETURN DO;
      336    12117    6                               IRELREAD.V.IDS# = '0'B;
      337    12118    6                               IRELREAD.V.KEYS# = '1'B;
      338    12119    6                               IRELREAD.V.KEYR# = '1'B;
      339    12120    6                               XSD$SERVICE.ERRCODE = B$TCB.ALT$->B$ALT.ERR;
      340    12121    6                               GOTO ERR;
      341    12122    6                            END;
      342    12123    5                       END;                /* if id ~= id */
      343    12124    4                  END;                     /*  do i */
      344    12125    3                  IRELREAD.V.IDS# = '0'B;
      345    12126    3                  IRELREAD.V.KEYS# = '1'B;
      346    12127    3                  IRELREAD.V.KEYR# = '1'B;
      347    12128    3                  XSD$SERVICE.ERRCODE = E_NODSASDEFINED;
      348    12129    3                  GOTO ERR;
      349    12130    3               END;                        /* bindto = nil */
      350    12131    3             ELSE DO;
      351    12132            /*
      352    12133                use dsa specified by the user
      353    12134             */
      354    12135    3                  IRELREAD.V.INDX# = %XSD_KEYX_UNIQUE;
      355    12136    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,0,XSD$SERVICE.BINDTO$->TEXTC.L) =
             12136                           XSD$SERVICE.BINDTO$->TEXTC.T;
      356    12137    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,XSD$SERVICE.BINDTO$->TEXTC.L,%
             12137                           XSD_DIBKEY_LEN) = ' ';
      357    12138    4                  CALL M$READ(IRELREAD) WHENALTRETURN DO;
      358    12139    4                       XSD$SERVICE.ERRCODE = E_DSANOTDEFINED;
      359    12140    4                       ALTRETURN;
      360    12141    4                    END;
      361    12142    3               END;                        /* else */
      362    12143
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:11   
      363    12144    2   FOUNDONE: ;
      364    12145
      365    12146    3             CALL XSS$GETMEM(BINDTOX,BINDTO$,LENGTHC(BINDTO)) WHENALTRETURN DO;
      366    12147    3                  XSD$SERVICE.ERRCODE = ERR_C;
      367    12148    3                  XSD$SERVICE.ERRCODE = E_NOMEM;
      368    12149    3                  XSD$SERVICE.ERRCODE.SEV = 1; /* on call to bind to */
      369    12150    3                  ALTRETURN;
      370    12151    3               END;
      371    12152
      372    12153    2             BINDTO.COMMONNAME = ADDR(XSD_DIBBUF.KEY.COMMONNAME)->TEXTC;
      373    12154    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_PSELECTOR,SIZEC(XSD_DIBBUF));
      374    12155    2             BINDTO.PRES = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      375    12156    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_SSELECTOR,SIZEC(XSD_DIBBUF));
      376    12157    2             BINDTO.SESS = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      377    12158    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_TSELECTOR,SIZEC(XSD_DIBBUF));
      378    12159    2             BINDTO.TRAN = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      379    12160    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_NSAP,SIZEC(XSD_DIBBUF));
      380    12161    2             BINDTO.NSAP = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;
      381    12162
      382    12163        /* build a bind pdu */
      383    12164    3             CALL XSS$RELMEM(BUFX) WHENALTRETURN DO;
      384    12165    3                  XSD$SERVICE.ERRCODE = E_RELMEM;
      385    12166    3                  GOTO ERR;
      386    12167    3               END;
      387    12168
      388    12169    2             SIZE = 1024;
      389    12170    3             CALL XSS$GETMEM(BUFX,BUF$,SIZE) WHENALTRETURN DO;
      390    12171    3                  XSD$SERVICE.ERRCODE = E_NOMEM;
      391    12172    3                  GOTO ERR;
      392    12173    3               END;
      393    12174
      394    12175    3             CALL XSD$BIND(XSD$SERVICE,BINDTO,BINDFROM,BUFFER,SIZE,'1'B) WHENALTRETURN
             12175                      DO;
      395    12176    3                  GOTO ERR;                /* service.errcode set by bind */
      396    12177    3               END;
      397    12178
      398    12179    2             XSC$ADDRESS.PSAP = BINDFROM.PRES;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:12   
      399    12180    2             XSC$ADDRESS.TSAP.LEN = BINDFROM.TRAN.L;
      400    12181    2             XSC$ADDRESS.TSAP.TSAP = BINDFROM.TRAN.T;
      401    12182    2             XSC$ADDRESS.SSAP = BINDFROM.SESS;
      402    12183    2             XSC$ADDRESS.NSAP = BINDFROM.NSAP;
      403    12184
      404    12185    3             CALL XSC$COMMINIT(CCB) WHENALTRETURN DO;
      405    12186    3                  XSD$SERVICE.ERRCODE = E_COMMINIT;
      406    12187    3                  GOTO ERR;
      407    12188    3               END;
      408    12189
      409    12190
      410    12191    2             XSP@ASN1_FPT = ASN1_FPT_C;
      411    12192    2             CONTEXT.BINDTOXS = BINDTOXS;
      412    12193    2             CONTEXT.BINDFROMXS = BINDFROMXS;
      413    12194    2             AASCREQ.FNC = %XSC_FNC_AASCREQ#;
      414    12195    2             AASCREQ.DATA$ = ADDR(XSP@ASN1_FPT);
      415    12196    2             XSP@ASN1_FPT.BUF$ = BUF$;
      416    12197    2             XSP@ASN1_FPT.NXTX = SIZE;
      417    12198    2             XSP@ASN1_FPT.CTXTID = 1;
             12198                      /* indicates which entry in the table pointed to by aascreq.ctxt$ */
      418    12199    2             AASCREQ.CCID = CCB.LCID;
      419    12200    2             AASCREQ.IAPT$ = ADDR(BINDFROM.COMMONNAME);
      420    12201    2             AASCREQ.RAPT$ = ADDR(BINDTO.COMMONNAME);
      421    12202        /*    Quality of Service and the session parameters? */
      422    12203    3             CALL XSC$ACSE(AASCREQ) WHENALTRETURN DO;
      423    12204    3                  XSD$SERVICE.ERRCODE = AASCREQ.ERROR;
      424    12205    3                  GOTO ERR;
      425    12206    3               END;
      426    12207
      427    12208          /* reload the pointer incase it changed going down the layers */
      428    12209    3             CALL XSS$BUFPTR(XSD_CONTEXTX,CONTEXT$) WHENALTRETURN DO;
      429    12210    3                  GOTO ERR;
      430    12211    3               END;
      431    12212    2             CONTEXT.STATE = %XSD_ST_WAITBINDRESP;
      432    12213    2             CONTEXT.UENTADDR$ = XSD$SERVICE.UENTADDR$;
      433    12214    2          END;                             /* if xsd_contextxs = -1 */
      434    12215    2        ELSE DO;                           /* else xsd_contextxs = -1*/
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:13   
      435    12216    3             CALL XSS$BUFPTR(XSD_CONTEXTX,CONTEXT$) WHENALTRETURN DO;
      436    12217    3                  GOTO ERR;
      437    12218    3               END;
      438    12219    2          END;                             /* else xsd_contextxs = -1 */
      439    12220
      440    12221
      441    12222    2        CALL XSS$GETMEM(SERVICEX,SERVICE$,LENGTHC(XSD$SERVICE)) WHENALTRETURN DO;
      442    12223    2             XSD$SERVICE.ERRCODE = E_NOMEM;
      443    12224    2             XSD$SERVICE.ERRCODE.SEV = 2;
      444    12225    2             GOTO ERR;
      445    12226    2          END;
      446    12227
      447    12228    2        DO CASE (XSD$SERVICE.MODE);
      448    12229    2         CASE(%XSD_MODE_ATTR);        /* single name with a list of attributes */
      449    12230    3           DO I = 0 TO XSD$SERVICE.ATTR#-1;
      450    12231    4              IF XSD$SERVICE.ATTRIBUTE.TYPE(I) > %XSD_AT_MAXATTR THEN DO;
      451    12232    4                   XSD$SERVICE.ERRCODE = E_BADATTRIBUTE;
      452    12233    4                   GOTO ERR;
      453    12234    4                END;
      454    12235    3           END;                            /* do i */
      455    12236
      456    12237    2         CASE(%XSD_MODE_NAME);
      457    12238
      458    12239    2         CASE(%XSD_MODE_LIST);
      459    12240
      460    12241    2        END;                               /* do case */
      461    12242
      462    12243    2        DO INHIBIT;
      463    12244    2           SERVICE = XSD$SERVICE;
      464    12245    2           SERVICE.SERVICEXS.NXTXS = -1;
      465    12246    2           SERVICE.SERVICEXS.PRVXS = -1;
      466    12247
      467    12248        /* add service block to current context block service list */
      468    12249
      469    12250    2           BINDTOX = CONTEXT.SERVICEX;
      470    12251    2           IF BINDTOXS = -1 THEN
      471    12252    2              CONTEXT.SERVICEX = SERVICEX;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:14   
      472    12253    3           ELSE DO;
      473    12254    4                DO WHILE BINDTOXS ~= -1;
      474    12255             /* use bufptr to run inhibited*/
      475    12256    5                   CALL XSS$BUFPTR(BINDTOXS,BINDTO$) WHENALTRETURN DO;
      476    12257                                                /* oops */
      477    12258    5                        GOTO ERR;
      478    12259    5                     END;
      479    12260    4                   BINDTOXS = BINDTO$->SERVICE.SERVICEXS.NXTXS;
      480    12261    4                END;
      481    12262    3                BINDTO$->SERVICE.SERVICEX.NXTX = SERVICEX;
             12262                         /* set current to new service block*/
      482    12263    3                SERVICE.SERVICEX.PRVX = BINDTOX;
             12263                         /* set new to point back to previous */
      483    12264    3             END;
      484    12265    2        END;/* do inhibit */
      485    12266
      486    12267        /* if nothing is going on send the next service request */
      487    12268
      488    12269    2        IF CONTEXT.STATE = %XSD_ST_READY THEN DO;
      489    12270    3             DO INHIBIT;
      490    12271    3                BINDTOX = CONTEXT.SERVICEX;
      491    12272    4                DO WHILE BINDTOXS ~= -1;
      492    12273    5                   CALL XSS$BUFPTR(BINDTOX,BINDTO$) WHENALTRETURN DO;
      493    12274    5                        GOTO ERR;
      494    12275    5                     END;
      495    12276    5                   IF NOT BINDTO$->SERVICE.FLAGS.PROCESSED THEN DO;
      496    12277
      497    12278    5                     END;
      498    12279    4                   ELSE
      499    12280    4                      BINDTOX = BINDTO$->SERVICE.SERVICEX.NXTX;
      500    12281    4                END;
      501    12282
      502    12283    3             END;                          /* do inhibit */
      503    12284    2          END;
      504    12285
      505    12286    1        RETURN;
      506    12287
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:15   
      507    12288    1   ERR: ;
      508    12289    1        IF BINDTOXS ~= -1 THEN
      509    12290    2           CALL XSS$RELMEM(BINDTOX) WHENALTRETURN DO;
      510    12291             /* as if we didn't have enough problems */
      511    12292    2             END;
      512    12293    1        IF BINDFROMXS ~= -1 THEN
      513    12294    2           CALL XSS$RELMEM(BINDFROMX) WHENALTRETURN DO;
      514    12295    2             END;
      515    12296    1        IF SERVICEXS ~= -1 THEN
      516    12297    2           CALL XSS$RELMEM(SERVICEX) WHENALTRETURN DO;
      517    12298    2             END;
      518    12299    1        IF BUFXS ~= -1 THEN
      519    12300    2           CALL XSS$RELMEM(BUFX) WHENALTRETURN DO;
      520    12301    2             END;
      521    12302    1        ALTRETURN;
      522    12303    1   END XSD$DIRECTORY;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:16   
--  Include file information  --

   XSP_ASN1_M.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   XSC_ACSE_E.:XSA1TOU  is referenced.
   XSC_ACSE_M.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSD_SUBS_C.:XSA1TOU  is referenced.
   FM_FIELD_C.:LIB_E05  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   XSD_PERR_C.:XSA1TOU  is referenced.
   XSD_MACRO_M.:XSA1TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XSD$DIRECTORY.

   Procedure XSD$DIRECTORY requires 859 words for executable code.
   Procedure XSD$DIRECTORY requires 40 words of local(AUTO) storage.

    No errors detected in file XSD$DIRECTORY.:XSA1TSI    .

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:17   

 Object Unit name= XSD$DIRECTORY                              File name= XSD$DIRECTORY.:XSA1TOU
 UTS= OCT 01 '97 11:55:04.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  1497   2731  XSD$DIRECTORY
    2  RoData even  UTS     32     40  XSD$DIRECTORY
    3   DCB   even  none     0      0  M$DIB
    4   DCB   even  none     0      0  M$DSA
    5   Proc  even  none   859   1533  XSD$DIRECTORY
    6  RoData even  none    54     66  XSD$DIRECTORY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        1  XSD$DIRECTORY
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:18   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    174  DIBACCT                            1    176  IRELNAME
    1    202  VLR_ID                             2      1  E_RELMEM
    2      2  E_NOMEM                            2      3  E_BADFUNCTION
    2      4  E_DUANOTDEFINED                    2      5  E_BADSUBCODE
    2      6  E_DSANOTDEFINED                    2      7  E_NODSASDEFINED
    2     10  E_BADATTRIBUTE                     2     11  E_COMMINIT
    1   2556  CODE18$                            1   2557  CODE19$
    1   2560  CODE21$

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XSD$DSDATA
 yes     yes           Std       1 XSC$ROSE_RECV
 yes     yes           Std       3 XSS$GETMEM
 yes     yes           Std       1 XSD$SEARCH
 yes     yes           Std       2 XSS$BUFPTR
         yes          ~proc      0 XSD$TABLE
 yes     yes           Std       1 XSD$RECV
 yes     yes           Std       2 XSF$LOCCODP
 yes     yes           Std       4 XSD$LOCFIELD
 yes     yes           Std       1 XSC$ACSE
 yes     yes           Std       1 XSD$READ
 yes     yes           Std       1 XSD$MODIFY
 yes     yes           Std       1 XSS$RELMEM
 yes     yes           Std       6 XSD$BIND
 yes     yes           Std       1 XSC$COMMINIT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                M$DIB
     M$DSA                                 XSD_DS_OPENDIB                        XSD_CONTEXTXS
     XSD_DIRECTORYACCESSAC                 XSD_PCDL_DUA                          XSD_DIBKEY

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:20   


        1        1        /*M* XSD$DIRECTORY - user interface to the directory service library.*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
        8        8
        9        9        /*D* XSD$DIRECTORY(XSD_SERVICE) ALTRET
       10       10                provides user interface to the services of the directory. */
       11       11
       12       12
       13       13        XSD$DIRECTORY: PROC(XSD$SERVICE) ALTRET;

     13  5 000000   000000 700200 xent  XSD$DIRECTO* TSX0  ! X66_AUTO_1
         5 000001   000050 000001                    ZERO    40,1

       14       14
       15       15
       16       16        %INCLUDE CP_6;
       17     5575        %INCLUDE XSD_MACRO_M;
       18     6684        %INCLUDE XSD_PERR_C;
       19     6706        %INCLUDE FM$FIT;
       20     6927        %INCLUDE FM_FIELD_C;
       21     6968        %INCLUDE XSD_SUBS_C;
       22     7303        %INCLUDE XSC_COMMON_M;
       23     7956        %INCLUDE XSC_ACSE_M;
       24     8265        %INCLUDE XSC_ACSE_E;
       25     8343        %INCLUDE K_ADDRESS_M;
       26     8846        %INCLUDE XSP_ASN1_M;
       27     9192
       28     9193        %XSD_SERVICE(NAME=XSD$SERVICE,STCLASS="");
       29     9358
       30     9359        /* entry definitions */
       31     9360    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       32     9361    1   DCL XSD$READ ENTRY(1) ALTRET;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:21   
       33     9362    1   DCL XSD$SEARCH ENTRY(1) ALTRET;
       34     9363    1   DCL XSD$MODIFY ENTRY(1) ALTRET;
       35     9364    1   DCL XSD$BIND ENTRY(6) ALTRET;
       36     9365    1   DCL XSD$UNBIND ENTRY(6) ALTRET;
       37     9366    1   DCL XSD$LOCFIELD ENTRY(4) ALTRET;
       38     9367    1   DCL XSS$GETMEM ENTRY(3) ALTRET;
       39     9368    1   DCL XSS$BUFPTR ENTRY(2) ALTRET;
       40     9369    1   DCL XSS$RELMEM ENTRY(1) ALTRET;
       41     9370    1   DCL XSC$ROSE_RECV ENTRY(1) ALTRET;
       42     9371    1   DCL XSD$RECV ENTRY(1) ALTRET;
       43     9372    1   DCL XSC$COMMINIT ENTRY(1) ALTRET;
       44     9373    1   DCL XSC$COMMTERM ENTRY(1) ALTRET;
       45     9374    1   DCL XSC$ACSE ENTRY(1) ALTRET;
       46     9375    1   DCL XSD$DSDATA ENTRY CONV(5);           /* so LEMUR lib works */
       47     9376    1   DCL XSD$TABLE ENTRY CONV(5);            /* so LEMUR lib works */
       48     9377
       49     9378
       50     9379        /* system symrefs */
       51     9380    1   DCL B$JIT$ PTR SYMREF;
       52     9381    1   DCL B$TCB$ PTR SYMREF;
       53     9382    1   DCL B$ROSEG$ PTR SYMREF;
       54     9383
       55     9384        /* system based */
       56     9385        %B$ALT;
       57     9393        %B$TCB(STCLASS="BASED(B$TCB$)");
       58     9396        %F$DCB(STCLASS="BASED");
       59     9453        %FM$FIELD_START(STCLASS="BASED");
       60     9475
       61     9476        /* static system fpts */
       62     9477        %FPT_OPEN(FPTN=OPENDIB_UPDATE,ACCT=DIBACCT,NAME=IRELNAME,DISP=NAMED,SHARE=ALL,
       63     9478                  FUN=UPDATE,ORG=IREL,DCB=M$DIB,ASN=FILE,FPARAM=FPARAM);
       64     9587
       65     9588        %FPT_READ(FPTN=IRELREAD,DCB=M$DIB,KEYS=YES,KEYR=YES,
       66     9589                  ID=YES,IDBUF=VLP_ID,KEY=XSD_DIBKEY);
       67     9628
       68     9629        %FPT_PRECORD(FPTN=IRELPRECORD,DCB=M$DIB,IDALL=YES,IDBUF=VLR_ID,
       69     9630                     KEYS=YES,KEY=XSD_DIBKEY);
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:22   
       70     9651
       71     9652        %FPT_WRITE(FPTN=IRELWRITE,DCB=M$DIB,NEWKEY=NO);
       72     9683
       73     9684        %FPT_CLOSE(FPTN=IRELCLOSE,DISP=SAVE,DCB=M$DIB);
       74     9726
       75     9727        %VLP_ACCT(FPTN=DIBACCT,ACCT='        ',STCLASS="STATIC SYMDEF");
       76     9740        %VLP_NAME(FPTN=IRELNAME,NAME=':DIB',STCLASS="STATIC SYMDEF");
       77     9767        %VLP_ID;
       78     9780        %VLR_ID(N=200,STCLASS="STATIC SYMDEF"); /* what should we do about this */
       79     9793        %VLP_ATTR (FPTN=DIB_ACSVEH);
       80     9807        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='ROUTECON?');
       81     9824        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='DSA?',LAST=";");
       82     9841        %CODE18(BASED="BASED(CODE18$)");
       83     9845        %CODE19(BASED="BASED(CODE19$)");
       84     9848        %CODE20(BASED="BASED(CODE21$)");
       85     9853        %FPT_MONINFO(MONINFO=VLR_MONINFO);
       86     9868        %VLR_MONINFO;
       87     9886
       88     9887        /* constant */
       89     9888        %VLP_ERRCODE(FPTN=ERR_C,FCG=XS,MID=D,MON='0'B,STCLASS=CONSTANT);
       90     9933        %VLP_ERRCODE(FPTN=E_RELMEM,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       91     9934                     ERR#=%E$RELMEM);
       92     9979        %VLP_ERRCODE(FPTN=E_NOMEM,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       93     9980                      ERR#=%E$NOMEM);
       94    10025        %VLP_ERRCODE(FPTN=E_BADFUNCTION,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       95    10026                      ERR#=%E$BADFUNCTION);
       96    10071        %VLP_ERRCODE(FPTN=E_DUANOTDEFINED,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       97    10072                      ERR#=%E$DUANOTDEFINED);
       98    10117        %VLP_ERRCODE(FPTN=E_BADSUBCODE,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
       99    10118                      ERR#=%E$BADSUBCODE);
      100    10163        %VLP_ERRCODE(FPTN=E_DSANOTDEFINED,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      101    10164                      ERR#=%E$DSANOTDEFINED);
      102    10209        %VLP_ERRCODE(FPTN=E_NODSASDEFINED,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      103    10210                      ERR#=%E$NODSASDEFINED);
      104    10255        %VLP_ERRCODE(FPTN=E_BADATTRIBUTE,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
      105    10256                      ERR#=%E$BADATTRIBUTE);
      106    10301        %VLP_ERRCODE(FPTN=E_COMMINIT,FCG=XS,MID=D,MON='0'B,STCLASS="CONSTANT SYMDEF",
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:23   
      107    10302                      ERR#=%E$COMMINIT);
      108    10347    1   DCL DUA CHAR(0) CONSTANT INIT('DUA');
      109    10348        %XSD_CONTEXT(NAME=CONTEXT_C,STCLASS=CONSTANT);
      110    10403        %XSP_ASN1_FPT(FPTN=ASN1_FPT_C,STCLASS=CONSTANT);
      111    10423
      112    10424        /* system dcbs */
      113    10425    1   DCL M$DIB DCB;
      114    10426    1   DCL M$DSA DCB;                          /* communication dcb to the dsa */
      115    10427
      116    10428        /* symrefs */
      117    10429    1   DCL XSD_DS_OPENDIB SBIN SYMREF;
      118    10430    1   DCL XSD_CONTEXTXS SBIN HALF HALIGNED SYMREF;
      119    10431    1   DCL XSD_CONTEXTX REDEF XSD_CONTEXTXS UBIN HALF HALIGNED;
      120    10432       %XSD_TEXTH(NAME=XSD_DIRECTORYACCESSAC,STCLASS=SYMREF); /* a DUA by any other name */
      121    10472    1   DCL XSD_PCDL_DUA UBIN SYMREF;      /* presentation context definition list */
      122    10473        %XSD_DIBKEY(NAME=XSD_DIBKEY,STCLASS=SYMREF);
      123    10509
      124    10510        /* based */
      125    10511    1   DCL 1 TEXTC BASED,
      126    10512    1            2 L UBIN(9) UNAL,
      127    10513    1            2 T CHAR(TEXTC.L) UNAL;
      128    10514
      129    10515        %XSD_BIND(NAME=BINDFROM,ALGN=ALIGNED,STCLASS="BASED(BINDFROM$)");
      130    10737        %XSD_BIND(NAME=BINDTO,ALGN=ALIGNED,STCLASS="BASED(BINDTO$)");
      131    10959
      132    10960        %XSD_SERVICE(NAME=SERVICE,STCLASS="BASED(SERVICE$)");
      133    11125        %XSD_CONTEXT(NAME=CONTEXT,STCLASS="BASED(CONTEXT$)");
      134    11180    1   DCL BUFFER CHAR(SIZE) BASED(BUF$);
      135    11181        %XSD_DIBBUF(NAME=XSD_DIBBUF,STCLASS="BASED(BUF$)");
      136    11246
      137    11247        /* user static */
      138    11248    1   DCL FPARAM(0:1023) UBIN STATIC INIT(0*0);
      139    11249    1   DCL CODE18$ PTR STATIC SYMDEF;
      140    11250    1   DCL CODE19$ PTR STATIC SYMDEF;
      141    11251    1   DCL CODE21$ PTR STATIC SYMDEF;
      142    11252        %XSC$CCB(NAME=CCB,STCLASS=STATIC,ADDRESS=XSC$ADDRESS,SASE1="XSC$ROSE_RECV",
      143    11253                 DCB#="DCBNUM(M$DSA)",MODE=CLIENT,ACSE=XSD$RECV,PRES=XSC$ROSE_RECV);
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:24   
      144    11550        %XSC$ASSOCIATE(FPTN=AASCREQ,FNC=REQ,STCLASS=STATIC,ACN=XSD_DIRECTORYACCESSAC,
      145    11551                       CTXT=XSD_PCDL_DUA);
      146    11626        %XSC$ADDRESS(STCLASS=STATIC);
      147    11909
      148    11910        /* user auto */
      149    11911    1   DCL STARTX UBIN;
      150    11912    1   DCL DIBERR UBIN;
      151    11913    1   DCL I SBIN;
      152    11914    1   DCL SIZE REDEF I UBIN;
      153    11915    1   DCL BINDFROM$ PTR;
      154    11916    1   DCL BINDFROMX UBIN HALF HALIGNED;
      155    11917    1   DCL BINDFROMXS REDEF BINDFROMX SBIN HALF HALIGNED;
      156    11918    1   DCL BINDTO$ PTR;
      157    11919    1   DCL BINDTOX UBIN HALF HALIGNED;
      158    11920    1   DCL BINDTOXS REDEF BINDTOX SBIN HALF HALIGNED;
      159    11921    1   DCL SERVICE$ PTR;
      160    11922    1   DCL SERVICEX UBIN HALF HALIGNED;
      161    11923    1   DCL SERVICEXS REDEF SERVICEX SBIN HALF HALIGNED;
      162    11924    1   DCL BUFX UBIN HALF HALIGNED;
      163    11925    1   DCL BUFXS REDEF BUFX SBIN HALF HALIGNED;
      164    11926    1   DCL BUF$ PTR;
      165    11927    1   DCL CONTEXTX UBIN HALF HALIGNED;
      166    11928    1   DCL CONTEXTXS REDEF CONTEXTX SBIN HALF HALIGNED;
      167    11929    1   DCL CONTEXT$ PTR;
      168    11930    1   DCL CCBX UBIN HALF HALIGNED;
      169    11931    1   DCL CCBXS REDEF CCBX SBIN HALF HALIGNED;
      170    11932    1   DCL CCB$ PTR;
      171    11933    1   DCL DUAKEYID UBIN;
      172    11934        %XSP_ASN1_FPT(FPTN=XSP@ASN1_FPT,STCLASS=AUTO);
      173    11954
      174    11955
      175    11956        /* sop */
      176    11957
      177    11958    2        IF XSD$SERVICE.FNC > %XSD_FNC_MAX THEN DO;

  11958  5 000002   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000003   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:25   
         5 000004   777000 376003                    ANQ     -512,DU
         5 000005   004000 116003                    CMPQ    2048,DU
         5 000006   000012 602000 5                  TNC     s:11963

      178    11959    2             XSD$SERVICE.ERRCODE = E_BADFUNCTION;

  11959  5 000007   000003 236000 2                  LDQ     E_BADFUNCTION
         5 000010   000003 756100                    STQ     3,,PR0

      179    11960    2             ALTRETURN;

  11960  5 000011   000000 702200 xent               TSX2  ! X66_AALT

      180    11961    2          END;
      181    11962
      182    11963    2        IF XSD$SERVICE.SUBC > %XSD_SUBC_MAX THEN DO;

  11963  5 000012   000000 236100                    LDQ     0,,PR0
         5 000013   000777 376003                    ANQ     511,DU
         5 000014   000011 116003                    CMPQ    9,DU
         5 000015   000021 602000 5                  TNC     s:11968

      183    11964    2             XSD$SERVICE.ERRCODE = E_BADSUBCODE;

  11964  5 000016   000005 236000 2                  LDQ     E_BADSUBCODE
         5 000017   000003 756100                    STQ     3,,PR0

      184    11965    2             ALTRETURN;

  11965  5 000020   000000 702200 xent               TSX2  ! X66_AALT

      185    11966    2          END;
      186    11967
      187    11968    1        DIBERR = 0;

  11968  5 000021   200005 450100                    STZ     DIBERR,,AUTO

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:26   
      188    11969    2        IF XSD_DS_OPENDIB < 0 THEN DO;

  11969  5 000022   000000 235000 xsym               LDA     XSD_DS_OPENDIB
         5 000023   000113 605000 5                  TPL     s:11998

      189    11970    3             CALL M$OPEN(OPENDIB_UPDATE) WHENALTRETURN DO;

  11970  5 000024   000000 630400 1                  EPPR0   OPENDIB_UPDATE
         5 000025   450000 713400                    CLIMB   alt,open
         5 000026   410400 401760                    pmme    nvectors=18
         5 000027   000031 702000 5                  TSX2    s:11971
         5 000030   000037 710000 5                  TRA     s:11974

      190    11971    3                  XSD$SERVICE.ERRCODE = B$TCB.ALT$->B$ALT.ERR;

  11971  5 000031   000000 470400 xsym               LDP0    B$TCB$
         5 000032   000000 471500                    LDP1    0,,PR0
         5 000033   100102 236100                    LDQ     66,,PR1
         5 000034   200003 473500                    LDP3    @XSD$SERVICE,,AUTO
         5 000035   300003 756100                    STQ     3,,PR3

      191    11972    3                  ALTRETURN;

  11972  5 000036   000000 702200 xent               TSX2  ! X66_AALT

      192    11973    3               END;
      193    11974    2             CODE18$ = ADDR(FPARAM);

  11974  5 000037   000000 236000 6                  LDQ     0
         5 000040   002556 756000 1                  STQ     CODE18$

      194    11975    3             CALL XSF$LOCCODP(CODE18$,18) WHENALTRETURN DO;

  11975  5 000041   000003 630400 6                  EPPR0   3
         5 000042   000001 631400 6                  EPPR1   1
         5 000043   000000 701000 xent               TSX1    XSF$LOCCODP
         5 000044   000046 702000 5                  TSX2    s:11976
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:27   
         5 000045   000050 710000 5                  TRA     s:11978

      195    11976    3                  DIBERR = %E$NOCODE18BLK;

  11976  5 000046   000003 235007                    LDA     3,DL
         5 000047   200005 755100                    STA     DIBERR,,AUTO

      196    11977    3               END;

      197    11978    2             CODE19$ = ADDR(FPARAM);

  11978  5 000050   000000 236000 6                  LDQ     0
         5 000051   002557 756000 1                  STQ     CODE19$

      198    11979    3             CALL XSF$LOCCODP(CODE19$,19) WHENALTRETURN DO;

  11979  5 000052   000006 630400 6                  EPPR0   6
         5 000053   000001 631400 6                  EPPR1   1
         5 000054   000000 701000 xent               TSX1    XSF$LOCCODP
         5 000055   000057 702000 5                  TSX2    s:11980
         5 000056   000061 710000 5                  TRA     s:11982

      199    11980    3                  DIBERR = %E$NOCODE19BLK;

  11980  5 000057   000004 235007                    LDA     4,DL
         5 000060   200005 755100                    STA     DIBERR,,AUTO

      200    11981    3               END;

      201    11982    2             CODE21$ = ADDR(FPARAM);

  11982  5 000061   000000 236000 6                  LDQ     0
         5 000062   002560 756000 1                  STQ     CODE21$

      202    11983    3             CALL XSF$LOCCODP(CODE21$,21) WHENALTRETURN DO;

  11983  5 000063   000011 630400 6                  EPPR0   9
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:28   
         5 000064   000001 631400 6                  EPPR1   1
         5 000065   000000 701000 xent               TSX1    XSF$LOCCODP
         5 000066   000070 702000 5                  TSX2    s:11984
         5 000067   000072 710000 5                  TRA     s:11987

      203    11984    3                  DIBERR = %E$NOCODE21BLK;

  11984  5 000070   000005 235007                    LDA     5,DL
         5 000071   200005 755100                    STA     DIBERR,,AUTO

      204    11985    3               END;

      205    11986
      206    11987    3             IF DIBERR ~= 0 THEN DO;

  11987  5 000072   200005 235100                    LDA     DIBERR,,AUTO
         5 000073   000105 600000 5                  TZE     s:11993

      207    11988    3                  XSD$SERVICE.ERRCODE = ERR_C;

  11988  5 000074   000000 236000 2                  LDQ     ERR_C
         5 000075   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000076   000003 756100                    STQ     3,,PR0

      208    11989    3                  XSD$SERVICE.ERRCODE.ERR# = DIBERR;

  11989  5 000077   200005 236100                    LDQ     DIBERR,,AUTO
         5 000100   000003 736000                    QLS     3
         5 000101   000003 676100                    ERQ     3,,PR0
         5 000102   377770 376007                    ANQ     131064,DL
         5 000103   000003 656100                    ERSQ    3,,PR0

      209    11990    3                  ALTRETURN;

  11990  5 000104   000000 702200 xent               TSX2  ! X66_AALT

      210    11991    3               END;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:29   
      211    11992
      212    11993    2             XSD_DS_OPENDIB = DCBADDR(DCBNUM(M$DIB))->F$DCB.ARS#;
             11993                      /* set opendib to largest current record*/

  11993  5 000105   000000 236007 xsym               LDQ     M$DIB,DL
         5 000106   000013 470400 6                  LDP0    11
         5 000107   000000 471500                    LDP1    0,,PR0
         5 000110   100000 473506                    LDP3    0,QL,PR1
         5 000111   300000 235100                    LDA     0,,PR3
         5 000112   000000 755000 xsym               STA     XSD_DS_OPENDIB

      213    11994    2          END;                             /* if dib not open */

      214    11995        /*
      215    11996             if a local address will suffice, then
      216    11997        */
      217    11998    2        IF XSD$SERVICE.FLAGS.LOCALOKAY THEN DO;

  11998  5 000113   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000114   000002 234100                    SZN     2,,PR0
         5 000115   000161 605000 5                  TPL     s:12018

      218    11999    3             DO CASE(XSD$SERVICE.FNC);

  11999  5 000116   000000 236100                    LDQ     0,,PR0
         5 000117   000033 772000                    QRL     27
         5 000120   000004 116007                    CMPQ    4,DL
         5 000121   000123 602006 5                  TNC     s:11999+5,QL
         5 000122   000161 710000 5                  TRA     s:12018
         5 000123   000161 710000 5                  TRA     s:12018
         5 000124   000127 710000 5                  TRA     s:12001
         5 000125   000150 710000 5                  TRA     s:12007
         5 000126   000155 710000 5                  TRA     s:12010

      219    12000    3              CASE(%XSD_FNC_READ);

      220    12001    4                CALL XSD$READ(XSD$SERVICE) WHENRETURN DO;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:30   

  12001  5 000127   200003 630500                    EPPR0   @XSD$SERVICE,,AUTO
         5 000130   000014 631400 6                  EPPR1   12
         5 000131   000000 701000 xent               TSX1    XSD$READ
         5 000132   000147 702000 5                  TSX2    s:12004+1

      221    12002    4                     IF XSD$SERVICE.UENTADDR$ = ENTADDR(NIL) THEN RETURN;

  12002  5 000133   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000134   000010 236100                    LDQ     8,,PR0
         5 000135   000015 116000 6                  CMPQ    13
         5 000136   000140 601000 5                  TNZ     s:12003

  12002  5 000137   000000 702200 xent               TSX2  ! X66_ARET

      222    12003    4                     CALL XSD$SERVICE.UENTADDR$(XSD$SERVICE);
             12003                              /* ignore altreturns from the user */

  12003  5 000140   200003 630500                    EPPR0   @XSD$SERVICE,,AUTO
         5 000141   200003 471500                    LDP1    @XSD$SERVICE,,AUTO
         5 000142   100010 220100                    LDX0    8,,PR1
         5 000143   000014 631400 6                  EPPR1   12
         5 000144   000000 701010                    TSX1    0,X0
         5 000145   000000 011000                    NOP     0

      223    12004    4                     RETURN;

  12004  5 000146   000000 702200 xent               TSX2  ! X66_ARET
         5 000147   000161 710000 5                  TRA     s:12018

      224    12005    4                  END;
      225    12006    3              CASE(%XSD_FNC_SEARCH);

      226    12007    4                CALL XSD$SEARCH(XSD$SERVICE) WHENRETURN DO;

  12007  5 000150   200003 630500                    EPPR0   @XSD$SERVICE,,AUTO
         5 000151   000014 631400 6                  EPPR1   12
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:31   
         5 000152   000000 701000 xent               TSX1    XSD$SEARCH
         5 000153   000154 702000 5                  TSX2    s:12008

      227    12008    4                  END;

  12008  5 000154   000161 710000 5                  TRA     s:12018

      228    12009    3              CASE(%XSD_FNC_MODIFY);

      229    12010    4                CALL XSD$MODIFY(XSD$SERVICE) WHENRETURN DO;

  12010  5 000155   200003 630500                    EPPR0   @XSD$SERVICE,,AUTO
         5 000156   000014 631400 6                  EPPR1   12
         5 000157   000000 701000 xent               TSX1    XSD$MODIFY
         5 000160   000161 702000 5                  TSX2    s:12018

      230    12011    4                  END;

      231    12012    3             END;                          /* case on function */

      232    12013    2          END;                             /* if localokay */

      233    12014        /*
      234    12015             either localokay was not specified or the local search failed.
      235    12016             begin bind.
      236    12017        */
      237    12018    1        BINDFROMXS = -1;

  12018  5 000161   777777 220003                    LDX0    -1,DU
         5 000162   200010 740100                    STX0    BINDFROMX,,AUTO

      238    12019    1        BINDTOXS = -1;

  12019  5 000163   200012 740100                    STX0    BINDTOX,,AUTO

      239    12020    1        SERVICEXS = -1;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:32   
  12020  5 000164   200014 740100                    STX0    SERVICEX,,AUTO

      240    12021    1        BUFXS = -1;

  12021  5 000165   200015 740100                    STX0    BUFX,,AUTO

      241    12022
      242    12023        /* get a buffer to read dib records into */
      243    12024
      244    12025    2        CALL XSS$GETMEM(BUFX,BUF$,XSD_DS_OPENDIB) WHENALTRETURN DO;

  12025  5 000166   000017 236000 6                  LDQ     15
         5 000167   200044 756100                    STQ     XSP@ASN1_FPT+16,,AUTO
         5 000170   200016 630500                    EPPR0   BUF$,,AUTO
         5 000171   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 000172   200015 631500                    EPPR1   BUFX,,AUTO
         5 000173   200042 451500                    STP1    XSP@ASN1_FPT+14,,AUTO
         5 000174   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000175   000016 631400 6                  EPPR1   14
         5 000176   000000 701000 xent               TSX1    XSS$GETMEM
         5 000177   000201 702000 5                  TSX2    s:12026
         5 000200   000210 710000 5                  TRA     s:12031

      245    12026    2             XSD$SERVICE.ERRCODE = E_NOMEM;

  12026  5 000201   000002 236000 2                  LDQ     E_NOMEM
         5 000202   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000203   000003 756100                    STQ     3,,PR0

      246    12027    2             XSD$SERVICE.ERRCODE.SEV = 3;

  12027  5 000204   000020 376000 6                  ANQ     16
         5 000205   000003 276007                    ORQ     3,DL
         5 000206   000003 756100                    STQ     3,,PR0

      247    12028    2             GOTO ERR;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:33   
  12028  5 000207   001462 710000 5                  TRA     ERR

      248    12029    2          END;
      249    12030
      250    12031    2        IF XSD_CONTEXTXS = -1 THEN DO;     /* this is the first time thru */

  12031  5 000210   000000 220000 xsym               LDX0    XSD_CONTEXTXS
         5 000211   777777 100003                    CMPX0   -1,DU
         5 000212   001266 601000 5                  TNZ     s:12216

      251    12032    3            CALL XSS$GETMEM(XSD_CONTEXTXS,CONTEXT$,LENGTHC(CONTEXT)) WHENALTRETURN DO;

  12032  5 000213   000023 236000 6                  LDQ     19
         5 000214   200044 756100                    STQ     XSP@ASN1_FPT+16,,AUTO
         5 000215   200020 630500                    EPPR0   CONTEXT$,,AUTO
         5 000216   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 000217   000024 236000 6                  LDQ     20
         5 000220   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 000221   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000222   000016 631400 6                  EPPR1   14
         5 000223   000000 701000 xent               TSX1    XSS$GETMEM
         5 000224   000226 702000 5                  TSX2    s:12033
         5 000225   000235 710000 5                  TRA     s:12037

      252    12033    3                  XSD$SERVICE.ERRCODE = E_NOMEM;

  12033  5 000226   000002 236000 2                  LDQ     E_NOMEM
         5 000227   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000230   000003 756100                    STQ     3,,PR0

      253    12034    3                  XSD$SERVICE.ERRCODE.SEV = 4;

  12034  5 000231   000020 376000 6                  ANQ     16
         5 000232   000004 276007                    ORQ     4,DL
         5 000233   000003 756100                    STQ     3,,PR0

      254    12035    3                  GOTO ERR;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:34   

  12035  5 000234   001462 710000 5                  TRA     ERR

      255    12036    3               END;
      256    12037    2             CONTEXT = CONTEXT_C;

  12037  5 000235   200020 470500                    LDP0    CONTEXT$,,AUTO
         5 000236   000100 100400                    MLR     fill='000'O
         5 000237   000013 000034 2                  ADSC9   CONTEXT_C                cn=0,n=28
         5 000240   000000 000034                    ADSC9   0,,PR0                   cn=0,n=28

      257    12038    3             IF XSD$SERVICE.BINDFROM$ = ADDR(NIL) THEN DO;

  12038  5 000241   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000242   000011 236100                    LDQ     9,,PR0
         5 000243   000021 116000 6                  CMPQ    17
         5 000244   000303 601000 5                  TNZ     s:12051

      258    12039    3                  CALL M$MONINFO(FPT_MONINFO)

  12039  5 000245   000522 630400 1                  EPPR0   FPT_MONINFO
         5 000246   420023 713400                    CLIMB   alt,+8211
         5 000247   402400 401760                    pmme    nvectors=6
         5 000250   000275 702000 5                  TSX2    s:12046

      259    12040    4                  WHENRETURN DO;

      260    12041    4                       XSD_DIBKEY.DIBUNIQUE = VLR_MONINFO.NODE_NAME;

  12041  5 000251   040000 100400                    MLR     fill='040'O
         5 000252   000550 000010 1                  ADSC9   VLR_MONINFO+10           cn=0,n=8
         5 000253   000341 200037 xsym               ADSC9   XSD_DIBKEY+225           cn=1,n=31

      261    12042    4                       CALL INDEX(I,' ',VLR_MONINFO.NODE_NAME);

  12042  5 000254   000000 124400                    SCM     mask='000'O
         5 000255   000550 000010 1                  ADSC9   VLR_MONINFO+10           cn=0,n=8
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:35   
         5 000256   000025 000001 6                  ADSC9   21                       cn=0,n=1
         5 000257   200006 000100                    ARG     I,,AUTO

      262    12043    4                      CALL CONCAT(XSD_DIBKEY.DIBUNIQUE,SUBSTR(VLR_MONINFO.NODE_NAME,0,
             12043                                I),DUA);

  12043  5 000260   200006 720100                    LXL0    I,,AUTO
         5 000261   040000 100440                    MLR     fill='040'O
         5 000262   000550 000010 1                  ADSC9   VLR_MONINFO+10           cn=0,n=*X0
         5 000263   000341 200037 xsym               ADSC9   XSD_DIBKEY+225           cn=1,n=31
         5 000264   200006 236100                    LDQ     I,,AUTO
         5 000265   000037 116007                    CMPQ    31,DL
         5 000266   000274 605000 5                  TPL     s:12044
         5 000267   777740 621006                    EAX1    -32,QL
         5 000270   777777 661003                    ERX1    -1,DU
         5 000271   040046 100400                    MLR     fill='040'O
         5 000272   000012 000003 2                  ADSC9   DUA                      cn=0,n=3
         5 000273   000341 200011 xsym               ADSC9   XSD_DIBKEY+225,Q         cn=1,n=*X1

      263    12044    4                    END;                   /* whenreturn on moninfo */

  12044  5 000274   000302 710000 5                  TRA     s:12048

      264    12045    4                  WHENALTRETURN DO;

      265    12046    4                       XSD$SERVICE.ERRCODE = B$TCB.ALT$->B$ALT.ERR;

  12046  5 000275   000000 470400 xsym               LDP0    B$TCB$
         5 000276   000000 471500                    LDP1    0,,PR0
         5 000277   100102 236100                    LDQ     66,,PR1
         5 000300   200003 473500                    LDP3    @XSD$SERVICE,,AUTO
         5 000301   300003 756100                    STQ     3,,PR3

      266    12047    4                    END;

      267    12048    3               END;                        /* bindfrom = nil */

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:36   
  12048  5 000302   000330 710000 5                  TRA     s:12057

      268    12049    3             ELSE DO;

      269    12050             /*  use dua address specified by the user */
      270    12051    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,0,XSD$SERVICE.BINDFROM$->TEXTC.L) =
             12051                           XSD$SERVICE.BINDFROM$->TEXTC.T;

  12051  5 000303   000011 471500                    LDP1    9,,PR0
         5 000304   000100 101500                    MRL     fill='000'O
         5 000305   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 000306   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000307   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000310   000011 471500                    LDP1    9,,PR0
         5 000311   000100 101500                    MRL     fill='000'O
         5 000312   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 000313   200043 000002                    ADSC9   XSP@ASN1_FPT+15,,AUTO    cn=0,n=2
         5 000314   200043 221100                    LDX1    XSP@ASN1_FPT+15,,AUTO
         5 000315   040040 100540                    MLR     fill='040'O
         5 000316   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         5 000317   000341 200010 xsym               ADSC9   XSD_DIBKEY+225           cn=1,n=*X0

      271    12052             /* and blank fill it */
      272    12053    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,XSD$SERVICE.BINDFROM$->TEXTC.L,%
             12053                           XSD_DIBKEY_LEN) = ' ';

  12053  5 000320   000011 471500                    LDP1    9,,PR0
         5 000321   000100 101500                    MRL     fill='000'O
         5 000322   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 000323   200042 000004                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=4
         5 000324   200042 236100                    LDQ     XSP@ASN1_FPT+14,,AUTO
         5 000325   040006 100400                    MLR     fill='040'O
         5 000326   000025 000001 6                  ADSC9   21                       cn=0,n=1
         5 000327   000341 200037 xsym               ADSC9   XSD_DIBKEY+225,Q         cn=1,n=31

      273    12054    3               END;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:37   
      274    12055
      275    12056
      276    12057    2             IRELREAD.BUF_ = VECTOR(XSD_DIBBUF);

  12057  5 000330   000026 235000 6                  LDA     22
         5 000331   200016 236100                    LDQ     BUF$,,AUTO
         5 000332   000076 757000 1                  STAQ    IRELREAD+4

      277    12058    2             IRELREAD.BUF_.BOUND = XSD_DS_OPENDIB-1;

  12058  5 000333   000000 236000 xsym               LDQ     XSD_DS_OPENDIB
         5 000334   000001 136007                    SBLQ    1,DL
         5 000335   000020 736000                    QLS     16
         5 000336   000076 676000 1                  ERQ     IRELREAD+4
         5 000337   000027 376000 6                  ANQ     23
         5 000340   000076 656000 1                  ERSQ    IRELREAD+4

      278    12059    2             IRELREAD.V.INDX# = %XSD_KEYX_UNIQUE;

  12059  5 000341   000001 236007                    LDQ     1,DL
         5 000342   000102 552004 1                  STBQ    IRELREAD+8,'04'O

      279    12060    2             IRELREAD.KEY_ = VECTOR(XSD_DIBKEY.DIBUNIQUE);

  12060  5 000343   000030 237000 6                  LDAQ    24
         5 000344   000074 757000 1                  STAQ    IRELREAD+2

      280    12061    3             CALL M$READ(IRELREAD) WHENALTRETURN DO;

  12061  5 000345   000072 630400 1                  EPPR0   IRELREAD
         5 000346   440000 713400                    CLIMB   alt,read
         5 000347   401400 401760                    pmme    nvectors=4
         5 000350   000352 702000 5                  TSX2    s:12062
         5 000351   000356 710000 5                  TRA     s:12066

      281    12062    3                  XSD$SERVICE.ERRCODE = E_DUANOTDEFINED;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:38   
  12062  5 000352   000004 236000 2                  LDQ     E_DUANOTDEFINED
         5 000353   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000354   000003 756100                    STQ     3,,PR0

      282    12063    3                  GOTO ERR;

  12063  5 000355   001462 710000 5                  TRA     ERR

      283    12064    3               END;
      284    12065
      285    12066    2             DUAKEYID = VLP_ID.ID#;

  12066  5 000356   000201 235000 1                  LDA     VLP_ID+1
         5 000357   200023 755100                    STA     DUAKEYID,,AUTO

      286    12067
      287    12068    3             CALL XSS$GETMEM(BINDFROMX,BINDFROM$,LENGTHC(BINDFROM)) WHENALTRETURN DO;

  12068  5 000360   000033 236000 6                  LDQ     27
         5 000361   200044 756100                    STQ     XSP@ASN1_FPT+16,,AUTO
         5 000362   200007 630500                    EPPR0   BINDFROM$,,AUTO
         5 000363   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 000364   200010 631500                    EPPR1   BINDFROMX,,AUTO
         5 000365   200042 451500                    STP1    XSP@ASN1_FPT+14,,AUTO
         5 000366   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000367   000016 631400 6                  EPPR1   14
         5 000370   000000 701000 xent               TSX1    XSS$GETMEM
         5 000371   000373 702000 5                  TSX2    s:12069
         5 000372   000401 710000 5                  TRA     s:12075

      288    12069    3                  XSD$SERVICE.ERRCODE = E_NOMEM;

  12069  5 000373   000002 236000 2                  LDQ     E_NOMEM
         5 000374   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000375   000003 756100                    STQ     3,,PR0

      289    12070    3                  XSD$SERVICE.ERRCODE.SEV = 0; /* on call to bind from */
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:39   

  12070  5 000376   000020 236000 6                  LDQ     16
         5 000377   000003 356100                    ANSQ    3,,PR0

      290    12071    3                  ALTRETURN;

  12071  5 000400   000000 702200 xent               TSX2  ! X66_AALT

      291    12072    3               END;
      292    12073
      293    12074
      294    12075    2             STARTX = DCBADDR(DCBNUM(M$DIB))->F$DCB.STARTX;

  12075  5 000401   000000 236007 xsym               LDQ     M$DIB,DL
         5 000402   000013 470400 6                  LDP0    11
         5 000403   000000 471500                    LDP1    0,,PR0
         5 000404   100000 473506                    LDP3    0,QL,PR1
         5 000405   300057 236100                    LDQ     47,,PR3
         5 000406   000022 772000                    QRL     18
         5 000407   200004 756100                    STQ     STARTX,,AUTO

      295    12076    2             BINDFROM.COMMONNAME = ADDR(XSD_DIBBUF.KEY.COMMONNAME)->TEXTC;

  12076  5 000410   200016 473500                    LDP3    BUF$,,AUTO
         5 000411   300000 720100                    LXL0    0,,PR3
         5 000412   000777 360003                    ANX0    511,DU
         5 000413   000001 621010                    EAX1    1,X0
         5 000414   200007 474500                    LDP4    BINDFROM$,,AUTO
         5 000415   000100 100540                    MLR     fill='000'O
         5 000416   300000 600011                    ADSC9   0,,PR3                   cn=3,n=*X1
         5 000417   400000 000101                    ADSC9   0,,PR4                   cn=0,n=65

      296    12077    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_PSELECTOR,SIZEC(XSD_DIBBUF));

  12077  5 000420   000040 237000 6                  LDAQ    32
         5 000421   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 000422   200006 633500                    EPPR3   I,,AUTO
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:40   
         5 000423   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
         5 000424   200016 236100                    LDQ     BUF$,,AUTO
         5 000425   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 000426   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000427   000034 631400 6                  EPPR1   28
         5 000430   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 000431   000000 011000                    NOP     0

      297    12078    2             BINDFROM.PRES = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12078  5 000432   200016 470500                    LDP0    BUF$,,AUTO
         5 000433   200006 235100                    LDA     I,,AUTO
         5 000434   000100 101505                    MRL     fill='000'O
         5 000435   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 000436   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000437   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000440   000001 621010                    EAX1    1,X0
         5 000441   200007 471500                    LDP1    BINDFROM$,,AUTO
         5 000442   000100 100545                    MLR     fill='000'O
         5 000443   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 000444   100020 201000                    ADSC9   16,,PR1                  cn=1,n=512

      298    12079    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_SSELECTOR,SIZEC(XSD_DIBBUF));

  12079  5 000445   000042 237000 6                  LDAQ    34
         5 000446   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 000447   200006 633500                    EPPR3   I,,AUTO
         5 000450   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
         5 000451   200016 236100                    LDQ     BUF$,,AUTO
         5 000452   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 000453   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000454   000034 631400 6                  EPPR1   28
         5 000455   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 000456   000000 011000                    NOP     0

      299    12080    2             BINDFROM.SESS = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:41   
  12080  5 000457   200016 470500                    LDP0    BUF$,,AUTO
         5 000460   200006 235100                    LDA     I,,AUTO
         5 000461   000100 101505                    MRL     fill='000'O
         5 000462   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 000463   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000464   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000465   000001 621010                    EAX1    1,X0
         5 000466   200007 471500                    LDP1    BINDFROM$,,AUTO
         5 000467   000100 100545                    MLR     fill='000'O
         5 000470   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 000471   100220 201000                    ADSC9   144,,PR1                 cn=1,n=512

      300    12081    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_TSELECTOR,SIZEC(XSD_DIBBUF));

  12081  5 000472   000046 237000 6                  LDAQ    38
         5 000473   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 000474   200006 633500                    EPPR3   I,,AUTO
         5 000475   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
         5 000476   200016 236100                    LDQ     BUF$,,AUTO
         5 000477   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 000500   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000501   000034 631400 6                  EPPR1   28
         5 000502   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 000503   000000 011000                    NOP     0

      301    12082    2             BINDFROM.TRAN = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12082  5 000504   200016 470500                    LDP0    BUF$,,AUTO
         5 000505   200006 235100                    LDA     I,,AUTO
         5 000506   000100 101505                    MRL     fill='000'O
         5 000507   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 000510   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000511   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000512   000001 621010                    EAX1    1,X0
         5 000513   200007 471500                    LDP1    BINDFROM$,,AUTO
         5 000514   000100 100545                    MLR     fill='000'O
         5 000515   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:42   
         5 000516   100420 201000                    ADSC9   272,,PR1                 cn=1,n=512

      302    12083    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_NSAP,SIZEC(XSD_DIBBUF));

  12083  5 000517   000050 237000 6                  LDAQ    40
         5 000520   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 000521   200006 633500                    EPPR3   I,,AUTO
         5 000522   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
         5 000523   200016 236100                    LDQ     BUF$,,AUTO
         5 000524   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 000525   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000526   000034 631400 6                  EPPR1   28
         5 000527   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 000530   000000 011000                    NOP     0

      303    12084    2             BINDFROM.NSAP = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12084  5 000531   200016 470500                    LDP0    BUF$,,AUTO
         5 000532   200006 235100                    LDA     I,,AUTO
         5 000533   000100 101505                    MRL     fill='000'O
         5 000534   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 000535   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000536   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000537   000001 621010                    EAX1    1,X0
         5 000540   200007 471500                    LDP1    BINDFROM$,,AUTO
         5 000541   000100 100545                    MLR     fill='000'O
         5 000542   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 000543   100620 201000                    ADSC9   400,,PR1                 cn=1,n=512

      304    12085
      305    12086    3             IF XSD$SERVICE.BINDTO$ = ADDR(NIL) THEN DO;

  12086  5 000544   200003 473500                    LDP3    @XSD$SERVICE,,AUTO
         5 000545   300012 236100                    LDQ     10,,PR3
         5 000546   000021 116000 6                  CMPQ    17
         5 000547   000654 601000 5                  TNZ     s:12135

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:43   
      306    12087          /*
      307    12088            search for a dsa to talk to
      308    12089          */
      309    12090    3                  XSD_DIBKEY.OBJECTCLASS = %XSD_OC_DSA;

  12090  5 000550   015000 236003                    LDQ     6656,DU
         5 000551   000000 552040 xsym               STBQ    XSD_DIBKEY,'40'O

      310    12091    3                  IRELPRECORD.KEY_ = VECTOR(XSD_DIBKEY.OBJECTCLASS);

  12091  5 000552   000052 237000 6                  LDAQ    42
         5 000553   000112 757000 1                  STAQ    IRELPRECORD+2

      311    12092    3                  IRELPRECORD.V.INDX# = %XSD_KEYX_OBJECTCLASS;

  12092  5 000554   000017 236007                    LDQ     15,DL
         5 000555   000116 552004 1                  STBQ    IRELPRECORD+6,'04'O

      312    12093    4                  CALL M$PRECORD(IRELPRECORD) WHENALTRETURN DO;

  12093  5 000556   000110 630400 1                  EPPR0   IRELPRECORD
         5 000557   440003 713400                    CLIMB   alt,+16387
         5 000560   401000 401760                    pmme    nvectors=3
         5 000561   000563 702000 5                  TSX2    s:12094
         5 000562   000567 710000 5                  TRA     s:12097

      313    12094    4                       XSD$SERVICE.ERRCODE = E_DSANOTDEFINED;

  12094  5 000563   000006 236000 2                  LDQ     E_DSANOTDEFINED
         5 000564   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000565   000003 756100                    STQ     3,,PR0

      314    12095    4                       GOTO ERR;

  12095  5 000566   001462 710000 5                  TRA     ERR

      315    12096    4                    END;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:44   
      316    12097    4                  IF VLR_ID.COUNT# < 2 THEN DO;
             12097                           /* no remote dsa defined only the local */

  12097  5 000567   000202 235000 1                  LDA     VLR_ID
         5 000570   000002 115007                    CMPA    2,DL
         5 000571   000576 603000 5                  TRC     s:12107

      317    12098    4                       XSD$SERVICE.ERRCODE = E_NODSASDEFINED;

  12098  5 000572   000007 236000 2                  LDQ     E_NODSASDEFINED
         5 000573   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000574   000003 756100                    STQ     3,,PR0

      318    12099    4                       GOTO ERR;

  12099  5 000575   001462 710000 5                  TRA     ERR

      319    12100    4                    END;
      320    12101          /*
      321    12102             Connect to the first dsa in the dib.  need to find a way to return
      322    12103             other dsas to user so that subsequent calls can try those dsas. or better
      323    12104             yet the knowledge information field could be use to weed down the list
      324    12105             of dsa, by indicating what kind of entries a specific dsa has knowledge
      325    12106          */
      326    12107    3                  IRELREAD.V.IDS# = '1'B;

  12107  5 000576   004000 236007                    LDQ     2048,DL
         5 000577   000102 256000 1                  ORSQ    IRELREAD+8

      327    12108    3                  IRELREAD.V.KEYS# = '0'B;

  12108  5 000600   000054 236000 6                  LDQ     44
         5 000601   000102 356000 1                  ANSQ    IRELREAD+8

      328    12109    3                  IRELREAD.V.KEYR# = '0'B;

  12109  5 000602   000055 236000 6                  LDQ     45
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:45   
         5 000603   000102 356000 1                  ANSQ    IRELREAD+8

      329    12110    4                  DO I = 0 TO VLR_ID.COUNT# - 1;

  12110  5 000604   200006 450100                    STZ     I,,AUTO
         5 000605   000636 710000 5                  TRA     s:12124+1

      330    12111    5                     IF DUAKEYID ~= VLR_ID.ID#(I) THEN DO;

  12111  5 000606   200006 720100                    LXL0    I,,AUTO
         5 000607   200023 236100                    LDQ     DUAKEYID,,AUTO
         5 000610   000203 116010 1                  CMPQ    VLR_ID+1,X0
         5 000611   000635 600000 5                  TZE     s:12124

      331    12112    5                          VLP_ID.ID# = VLR_ID.ID#(I);

  12112  5 000612   000203 235010 1                  LDA     VLR_ID+1,X0
         5 000613   000201 755000 1                  STA     VLP_ID+1

      332    12113    6                          CALL M$READ(IRELREAD) WHENRETURN DO;

  12113  5 000614   000072 630400 1                  EPPR0   IRELREAD
         5 000615   440000 713400                    CLIMB   alt,read
         5 000616   401400 401760                    pmme    nvectors=4
         5 000617   000621 702000 5                  TSX2    s:12117

      333    12114    6                               GOTO FOUNDONE;

  12114  5 000620   000714 710000 5                  TRA     FOUNDONE

      334    12115    6                            END;
      335    12116    6                          WHENALTRETURN DO;

      336    12117    6                               IRELREAD.V.IDS# = '0'B;

  12117  5 000621   000056 236000 6                  LDQ     46
         5 000622   000102 356000 1                  ANSQ    IRELREAD+8
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:46   

      337    12118    6                               IRELREAD.V.KEYS# = '1'B;

  12118  5 000623   200000 236007                    LDQ     65536,DL
         5 000624   000102 256000 1                  ORSQ    IRELREAD+8

      338    12119    6                               IRELREAD.V.KEYR# = '1'B;

  12119  5 000625   100000 236007                    LDQ     32768,DL
         5 000626   000102 256000 1                  ORSQ    IRELREAD+8

      339    12120    6                               XSD$SERVICE.ERRCODE = B$TCB.ALT$->B$ALT.ERR;

  12120  5 000627   000000 470400 xsym               LDP0    B$TCB$
         5 000630   000000 471500                    LDP1    0,,PR0
         5 000631   100102 236100                    LDQ     66,,PR1
         5 000632   200003 473500                    LDP3    @XSD$SERVICE,,AUTO
         5 000633   300003 756100                    STQ     3,,PR3

      340    12121    6                               GOTO ERR;

  12121  5 000634   001462 710000 5                  TRA     ERR

      341    12122    6                            END;
      342    12123    5                       END;                /* if id ~= id */
      343    12124    4                  END;                     /*  do i */

  12124  5 000635   200006 054100                    AOS     I,,AUTO
         5 000636   200006 236100                    LDQ     I,,AUTO
         5 000637   000606 604000 5                  TMI     s:12111
         5 000640   000202 116000 1                  CMPQ    VLR_ID
         5 000641   000606 602000 5                  TNC     s:12111

      344    12125    3                  IRELREAD.V.IDS# = '0'B;

  12125  5 000642   000056 236000 6                  LDQ     46
         5 000643   000102 356000 1                  ANSQ    IRELREAD+8
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:47   

      345    12126    3                  IRELREAD.V.KEYS# = '1'B;

  12126  5 000644   200000 236007                    LDQ     65536,DL
         5 000645   000102 256000 1                  ORSQ    IRELREAD+8

      346    12127    3                  IRELREAD.V.KEYR# = '1'B;

  12127  5 000646   100000 236007                    LDQ     32768,DL
         5 000647   000102 256000 1                  ORSQ    IRELREAD+8

      347    12128    3                  XSD$SERVICE.ERRCODE = E_NODSASDEFINED;

  12128  5 000650   000007 236000 2                  LDQ     E_NODSASDEFINED
         5 000651   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000652   000003 756100                    STQ     3,,PR0

      348    12129    3                  GOTO ERR;

  12129  5 000653   001462 710000 5                  TRA     ERR

      349    12130    3               END;                        /* bindto = nil */
      350    12131    3             ELSE DO;

      351    12132            /*
      352    12133                use dsa specified by the user
      353    12134             */
      354    12135    3                  IRELREAD.V.INDX# = %XSD_KEYX_UNIQUE;

  12135  5 000654   000001 236007                    LDQ     1,DL
         5 000655   000102 552004 1                  STBQ    IRELREAD+8,'04'O

      355    12136    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,0,XSD$SERVICE.BINDTO$->TEXTC.L) =
             12136                           XSD$SERVICE.BINDTO$->TEXTC.T;

  12136  5 000656   300012 474500                    LDP4    10,,PR3
         5 000657   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:48   
         5 000660   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         5 000661   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000662   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000663   300012 474500                    LDP4    10,,PR3
         5 000664   000100 101500                    MRL     fill='000'O
         5 000665   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         5 000666   200043 000002                    ADSC9   XSP@ASN1_FPT+15,,AUTO    cn=0,n=2
         5 000667   200043 221100                    LDX1    XSP@ASN1_FPT+15,,AUTO
         5 000670   040040 100540                    MLR     fill='040'O
         5 000671   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         5 000672   000341 200010 xsym               ADSC9   XSD_DIBKEY+225           cn=1,n=*X0

      356    12137    3                  SUBSTR(XSD_DIBKEY.DIBUNIQUE,XSD$SERVICE.BINDTO$->TEXTC.L,%
             12137                           XSD_DIBKEY_LEN) = ' ';

  12137  5 000673   300012 474500                    LDP4    10,,PR3
         5 000674   000100 101500                    MRL     fill='000'O
         5 000675   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         5 000676   200042 000004                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=4
         5 000677   200042 236100                    LDQ     XSP@ASN1_FPT+14,,AUTO
         5 000700   040006 100400                    MLR     fill='040'O
         5 000701   000025 000001 6                  ADSC9   21                       cn=0,n=1
         5 000702   000341 200037 xsym               ADSC9   XSD_DIBKEY+225,Q         cn=1,n=31

      357    12138    4                  CALL M$READ(IRELREAD) WHENALTRETURN DO;

  12138  5 000703   000072 630400 1                  EPPR0   IRELREAD
         5 000704   440000 713400                    CLIMB   alt,read
         5 000705   401400 401760                    pmme    nvectors=4
         5 000706   000710 702000 5                  TSX2    s:12139
         5 000707   000714 710000 5                  TRA     FOUNDONE

      358    12139    4                       XSD$SERVICE.ERRCODE = E_DSANOTDEFINED;

  12139  5 000710   000006 236000 2                  LDQ     E_DSANOTDEFINED
         5 000711   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000712   000003 756100                    STQ     3,,PR0
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:49   

      359    12140    4                       ALTRETURN;

  12140  5 000713   000000 702200 xent               TSX2  ! X66_AALT

      360    12141    4                    END;
      361    12142    3               END;                        /* else */

      362    12143
      363    12144    2   FOUNDONE: ;

  12144  5 000714                       FOUNDONE     null
      364    12145
      365    12146    3             CALL XSS$GETMEM(BINDTOX,BINDTO$,LENGTHC(BINDTO)) WHENALTRETURN DO;

  12146  5 000714   000033 236000 6                  LDQ     27
         5 000715   200044 756100                    STQ     XSP@ASN1_FPT+16,,AUTO
         5 000716   200011 630500                    EPPR0   BINDTO$,,AUTO
         5 000717   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 000720   200012 631500                    EPPR1   BINDTOX,,AUTO
         5 000721   200042 451500                    STP1    XSP@ASN1_FPT+14,,AUTO
         5 000722   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000723   000016 631400 6                  EPPR1   14
         5 000724   000000 701000 xent               TSX1    XSS$GETMEM
         5 000725   000727 702000 5                  TSX2    s:12147
         5 000726   000740 710000 5                  TRA     s:12153

      366    12147    3                  XSD$SERVICE.ERRCODE = ERR_C;

  12147  5 000727   000000 236000 2                  LDQ     ERR_C
         5 000730   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 000731   000003 756100                    STQ     3,,PR0

      367    12148    3                  XSD$SERVICE.ERRCODE = E_NOMEM;

  12148  5 000732   000002 236000 2                  LDQ     E_NOMEM
         5 000733   000003 756100                    STQ     3,,PR0
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:50   

      368    12149    3                  XSD$SERVICE.ERRCODE.SEV = 1; /* on call to bind to */

  12149  5 000734   000020 376000 6                  ANQ     16
         5 000735   000001 276007                    ORQ     1,DL
         5 000736   000003 756100                    STQ     3,,PR0

      369    12150    3                  ALTRETURN;

  12150  5 000737   000000 702200 xent               TSX2  ! X66_AALT

      370    12151    3               END;
      371    12152
      372    12153    2             BINDTO.COMMONNAME = ADDR(XSD_DIBBUF.KEY.COMMONNAME)->TEXTC;

  12153  5 000740   200016 470500                    LDP0    BUF$,,AUTO
         5 000741   000000 720100                    LXL0    0,,PR0
         5 000742   000777 360003                    ANX0    511,DU
         5 000743   000001 621010                    EAX1    1,X0
         5 000744   200011 471500                    LDP1    BINDTO$,,AUTO
         5 000745   000100 100540                    MLR     fill='000'O
         5 000746   000000 600011                    ADSC9   0,,PR0                   cn=3,n=*X1
         5 000747   100000 000101                    ADSC9   0,,PR1                   cn=0,n=65

      373    12154    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_PSELECTOR,SIZEC(XSD_DIBBUF));

  12154  5 000750   000040 237000 6                  LDAQ    32
         5 000751   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 000752   200006 630500                    EPPR0   I,,AUTO
         5 000753   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 000754   200016 236100                    LDQ     BUF$,,AUTO
         5 000755   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 000756   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 000757   000034 631400 6                  EPPR1   28
         5 000760   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 000761   000000 011000                    NOP     0

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:51   
      374    12155    2             BINDTO.PRES = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12155  5 000762   200016 470500                    LDP0    BUF$,,AUTO
         5 000763   200006 235100                    LDA     I,,AUTO
         5 000764   000100 101505                    MRL     fill='000'O
         5 000765   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 000766   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 000767   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 000770   000001 621010                    EAX1    1,X0
         5 000771   200011 471500                    LDP1    BINDTO$,,AUTO
         5 000772   000100 100545                    MLR     fill='000'O
         5 000773   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 000774   100020 201000                    ADSC9   16,,PR1                  cn=1,n=512

      375    12156    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_SSELECTOR,SIZEC(XSD_DIBBUF));

  12156  5 000775   000042 237000 6                  LDAQ    34
         5 000776   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 000777   200006 633500                    EPPR3   I,,AUTO
         5 001000   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
         5 001001   200016 236100                    LDQ     BUF$,,AUTO
         5 001002   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 001003   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001004   000034 631400 6                  EPPR1   28
         5 001005   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 001006   000000 011000                    NOP     0

      376    12157    2             BINDTO.SESS = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12157  5 001007   200016 470500                    LDP0    BUF$,,AUTO
         5 001010   200006 235100                    LDA     I,,AUTO
         5 001011   000100 101505                    MRL     fill='000'O
         5 001012   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 001013   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 001014   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 001015   000001 621010                    EAX1    1,X0
         5 001016   200011 471500                    LDP1    BINDTO$,,AUTO
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:52   
         5 001017   000100 100545                    MLR     fill='000'O
         5 001020   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 001021   100220 201000                    ADSC9   144,,PR1                 cn=1,n=512

      377    12158    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_TSELECTOR,SIZEC(XSD_DIBBUF));

  12158  5 001022   000046 237000 6                  LDAQ    38
         5 001023   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 001024   200006 633500                    EPPR3   I,,AUTO
         5 001025   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
         5 001026   200016 236100                    LDQ     BUF$,,AUTO
         5 001027   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 001030   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001031   000034 631400 6                  EPPR1   28
         5 001032   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 001033   000000 011000                    NOP     0

      378    12159    2             BINDTO.TRAN = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12159  5 001034   200016 470500                    LDP0    BUF$,,AUTO
         5 001035   200006 235100                    LDA     I,,AUTO
         5 001036   000100 101505                    MRL     fill='000'O
         5 001037   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 001040   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 001041   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 001042   000001 621010                    EAX1    1,X0
         5 001043   200011 471500                    LDP1    BINDTO$,,AUTO
         5 001044   000100 100545                    MLR     fill='000'O
         5 001045   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 001046   100420 201000                    ADSC9   272,,PR1                 cn=1,n=512

      379    12160    2             CALL XSD$LOCFIELD(XSD_DIBBUF,I,%XSD_RECX_NSAP,SIZEC(XSD_DIBBUF));

  12160  5 001047   000050 237000 6                  LDAQ    40
         5 001050   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 001051   200006 633500                    EPPR3   I,,AUTO
         5 001052   200043 453500                    STP3    XSP@ASN1_FPT+15,,AUTO
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:53   
         5 001053   200016 236100                    LDQ     BUF$,,AUTO
         5 001054   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 001055   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001056   000034 631400 6                  EPPR1   28
         5 001057   000000 701000 xent               TSX1    XSD$LOCFIELD
         5 001060   000000 011000                    NOP     0

      380    12161    2             BINDTO.NSAP = PINCRC(ADDR(XSD_DIBBUF),I)->TEXTC;

  12161  5 001061   200016 470500                    LDP0    BUF$,,AUTO
         5 001062   200006 235100                    LDA     I,,AUTO
         5 001063   000100 101505                    MRL     fill='000'O
         5 001064   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 001065   200042 000002                    ADSC9   XSP@ASN1_FPT+14,,AUTO    cn=0,n=2
         5 001066   200042 220100                    LDX0    XSP@ASN1_FPT+14,,AUTO
         5 001067   000001 621010                    EAX1    1,X0
         5 001070   200011 471500                    LDP1    BINDTO$,,AUTO
         5 001071   000100 100545                    MLR     fill='000'O
         5 001072   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 001073   100620 201000                    ADSC9   400,,PR1                 cn=1,n=512

      381    12162
      382    12163        /* build a bind pdu */
      383    12164    3             CALL XSS$RELMEM(BUFX) WHENALTRETURN DO;

  12164  5 001074   200015 633500                    EPPR3   BUFX,,AUTO
         5 001075   200042 453500                    STP3    XSP@ASN1_FPT+14,,AUTO
         5 001076   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001077   000014 631400 6                  EPPR1   12
         5 001100   000000 701000 xent               TSX1    XSS$RELMEM
         5 001101   001103 702000 5                  TSX2    s:12165
         5 001102   001107 710000 5                  TRA     s:12169

      384    12165    3                  XSD$SERVICE.ERRCODE = E_RELMEM;

  12165  5 001103   000001 236000 2                  LDQ     E_RELMEM
         5 001104   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:54   
         5 001105   000003 756100                    STQ     3,,PR0

      385    12166    3                  GOTO ERR;

  12166  5 001106   001462 710000 5                  TRA     ERR

      386    12167    3               END;
      387    12168
      388    12169    2             SIZE = 1024;

  12169  5 001107   002000 235007                    LDA     1024,DL
         5 001110   200006 755100                    STA     I,,AUTO

      389    12170    3             CALL XSS$GETMEM(BUFX,BUF$,SIZE) WHENALTRETURN DO;

  12170  5 001111   200006 630500                    EPPR0   I,,AUTO
         5 001112   200044 450500                    STP0    XSP@ASN1_FPT+16,,AUTO
         5 001113   200016 631500                    EPPR1   BUF$,,AUTO
         5 001114   200043 451500                    STP1    XSP@ASN1_FPT+15,,AUTO
         5 001115   200015 633500                    EPPR3   BUFX,,AUTO
         5 001116   200042 453500                    STP3    XSP@ASN1_FPT+14,,AUTO
         5 001117   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001120   000016 631400 6                  EPPR1   14
         5 001121   000000 701000 xent               TSX1    XSS$GETMEM
         5 001122   001124 702000 5                  TSX2    s:12171
         5 001123   001130 710000 5                  TRA     s:12175

      390    12171    3                  XSD$SERVICE.ERRCODE = E_NOMEM;

  12171  5 001124   000002 236000 2                  LDQ     E_NOMEM
         5 001125   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001126   000003 756100                    STQ     3,,PR0

      391    12172    3                  GOTO ERR;

  12172  5 001127   001462 710000 5                  TRA     ERR

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:55   
      392    12173    3               END;
      393    12174
      394    12175    3             CALL XSD$BIND(XSD$SERVICE,BINDTO,BINDFROM,BUFFER,SIZE,'1'B) WHENALTRETURN
             12175                      DO;

  12175  5 001130   000061 236000 6                  LDQ     49
         5 001131   200047 756100                    STQ     XSP@ASN1_FPT+19,,AUTO
         5 001132   200006 630500                    EPPR0   I,,AUTO
         5 001133   200046 450500                    STP0    XSP@ASN1_FPT+18,,AUTO
         5 001134   200016 236100                    LDQ     BUF$,,AUTO
         5 001135   200007 235100                    LDA     BINDFROM$,,AUTO
         5 001136   200044 757100                    STAQ    XSP@ASN1_FPT+16,,AUTO
         5 001137   200011 236100                    LDQ     BINDTO$,,AUTO
         5 001140   200003 235100                    LDA     @XSD$SERVICE,,AUTO
         5 001141   200042 757100                    STAQ    XSP@ASN1_FPT+14,,AUTO
         5 001142   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001143   000057 631400 6                  EPPR1   47
         5 001144   000000 701000 xent               TSX1    XSD$BIND
         5 001145   001147 702000 5                  TSX2    s:12176
         5 001146   001150 710000 5                  TRA     s:12179

      395    12176    3                  GOTO ERR;                /* service.errcode set by bind */

  12176  5 001147   001462 710000 5                  TRA     ERR

      396    12177    3               END;
      397    12178
      398    12179    2             XSC$ADDRESS.PSAP = BINDFROM.PRES;

  12179  5 001150   200007 470500                    LDP0    BINDFROM$,,AUTO
         5 001151   000000 100500                    MLR     fill='000'O
         5 001152   000020 200341                    ADSC9   16,,PR0                  cn=1,n=225
         5 001153   002615 000341 1                  ADSC9   XSC$ADDRESS              cn=0,n=225

      399    12180    2             XSC$ADDRESS.TSAP.LEN = BINDFROM.TRAN.L;

  12180  5 001154   000420 220100                    LDX0    272,,PR0
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:56   
         5 001155   000777 360003                    ANX0    511,DU
         5 001156   002712 740000 1                  STX0    XSC$ADDRESS+61

      400    12181    2             XSC$ADDRESS.TSAP.TSAP = BINDFROM.TRAN.T;

  12181  5 001157   040000 100500                    MLR     fill='040'O
         5 001160   000420 400040                    ADSC9   272,,PR0                 cn=2,n=32
         5 001161   002712 400040 1                  ADSC9   XSC$ADDRESS+61           cn=2,n=32

      401    12182    2             XSC$ADDRESS.SSAP = BINDFROM.SESS;

  12182  5 001162   000000 100500                    MLR     fill='000'O
         5 001163   000220 200021                    ADSC9   144,,PR0                 cn=1,n=17
         5 001164   002705 200021 1                  ADSC9   XSC$ADDRESS+56           cn=1,n=17

      402    12183    2             XSC$ADDRESS.NSAP = BINDFROM.NSAP;

  12183  5 001165   000000 100500                    MLR     fill='000'O
         5 001166   000620 200026                    ADSC9   400,,PR0                 cn=1,n=22
         5 001167   002723 000026 1                  ADSC9   XSC$ADDRESS+70           cn=0,n=22

      403    12184
      404    12185    3             CALL XSC$COMMINIT(CCB) WHENALTRETURN DO;

  12185  5 001170   000062 630400 6                  EPPR0   50
         5 001171   000014 631400 6                  EPPR1   12
         5 001172   000000 701000 xent               TSX1    XSC$COMMINIT
         5 001173   001175 702000 5                  TSX2    s:12186
         5 001174   001201 710000 5                  TRA     s:12191

      405    12186    3                  XSD$SERVICE.ERRCODE = E_COMMINIT;

  12186  5 001175   000011 236000 2                  LDQ     E_COMMINIT
         5 001176   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001177   000003 756100                    STQ     3,,PR0

      406    12187    3                  GOTO ERR;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:57   

  12187  5 001200   001462 710000 5                  TRA     ERR

      407    12188    3               END;
      408    12189
      409    12190
      410    12191    2             XSP@ASN1_FPT = ASN1_FPT_C;

  12191  5 001201   000100 100400                    MLR     fill='000'O
         5 001202   000022 000070 2                  ADSC9   ASN1_FPT_C               cn=0,n=56
         5 001203   200024 000070                    ADSC9   XSP@ASN1_FPT,,AUTO       cn=0,n=56

      411    12192    2             CONTEXT.BINDTOXS = BINDTOXS;

  12192  5 001204   200012 220100                    LDX0    BINDTOX,,AUTO
         5 001205   200020 470500                    LDP0    CONTEXT$,,AUTO
         5 001206   000001 440100                    SXL0    1,,PR0

      412    12193    2             CONTEXT.BINDFROMXS = BINDFROMXS;

  12193  5 001207   200010 220100                    LDX0    BINDFROMX,,AUTO
         5 001210   200020 470500                    LDP0    CONTEXT$,,AUTO
         5 001211   000002 740100                    STX0    2,,PR0

      413    12194    2             AASCREQ.FNC = %XSC_FNC_AASCREQ#;

  12194  5 001212   001000 236003                    LDQ     512,DU
         5 001213   002577 552040 1                  STBQ    AASCREQ,'40'O

      414    12195    2             AASCREQ.DATA$ = ADDR(XSP@ASN1_FPT);

  12195  5 001214   200024 630500                    EPPR0   XSP@ASN1_FPT,,AUTO
         5 001215   002601 450400 1                  STP0    AASCREQ+2

      415    12196    2             XSP@ASN1_FPT.BUF$ = BUF$;

  12196  5 001216   200016 236100                    LDQ     BUF$,,AUTO
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:58   
         5 001217   200025 756100                    STQ     XSP@ASN1_FPT+1,,AUTO

      416    12197    2             XSP@ASN1_FPT.NXTX = SIZE;

  12197  5 001220   200006 235100                    LDA     I,,AUTO
         5 001221   200040 755100                    STA     XSP@ASN1_FPT+12,,AUTO

      417    12198    2             XSP@ASN1_FPT.CTXTID = 1;
             12198                      /* indicates which entry in the table pointed to by aascreq.ctxt$ */

  12198  5 001222   000001 235007                    LDA     1,DL
         5 001223   200031 755100                    STA     XSP@ASN1_FPT+5,,AUTO

      418    12199    2             AASCREQ.CCID = CCB.LCID;

  12199  5 001224   002561 236000 1                  LDQ     CCB
         5 001225   000022 736000                    QLS     18
         5 001226   002577 552020 1                  STBQ    AASCREQ,'20'O

      419    12200    2             AASCREQ.IAPT$ = ADDR(BINDFROM.COMMONNAME);

  12200  5 001227   200007 236100                    LDQ     BINDFROM$,,AUTO
         5 001230   002603 756000 1                  STQ     AASCREQ+4

      420    12201    2             AASCREQ.RAPT$ = ADDR(BINDTO.COMMONNAME);

  12201  5 001231   200011 236100                    LDQ     BINDTO$,,AUTO
         5 001232   002607 756000 1                  STQ     AASCREQ+8

      421    12202        /*    Quality of Service and the session parameters? */
      422    12203    3             CALL XSC$ACSE(AASCREQ) WHENALTRETURN DO;

  12203  5 001233   000063 630400 6                  EPPR0   51
         5 001234   000014 631400 6                  EPPR1   12
         5 001235   000000 701000 xent               TSX1    XSC$ACSE
         5 001236   001240 702000 5                  TSX2    s:12204
         5 001237   001244 710000 5                  TRA     s:12209
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:59   

      423    12204    3                  XSD$SERVICE.ERRCODE = AASCREQ.ERROR;

  12204  5 001240   002600 236000 1                  LDQ     AASCREQ+1
         5 001241   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001242   000003 756100                    STQ     3,,PR0

      424    12205    3                  GOTO ERR;

  12205  5 001243   001462 710000 5                  TRA     ERR

      425    12206    3               END;
      426    12207
      427    12208          /* reload the pointer incase it changed going down the layers */
      428    12209    3             CALL XSS$BUFPTR(XSD_CONTEXTX,CONTEXT$) WHENALTRETURN DO;

  12209  5 001244   200020 630500                    EPPR0   CONTEXT$,,AUTO
         5 001245   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 001246   000024 236000 6                  LDQ     20
         5 001247   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 001250   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001251   000001 631400 6                  EPPR1   1
         5 001252   000000 701000 xent               TSX1    XSS$BUFPTR
         5 001253   001255 702000 5                  TSX2    s:12210
         5 001254   001256 710000 5                  TRA     s:12212

      429    12210    3                  GOTO ERR;

  12210  5 001255   001462 710000 5                  TRA     ERR

      430    12211    3               END;
      431    12212    2             CONTEXT.STATE = %XSD_ST_WAITBINDRESP;

  12212  5 001256   000001 235007                    LDA     1,DL
         5 001257   200020 470500                    LDP0    CONTEXT$,,AUTO
         5 001260   000003 755100                    STA     3,,PR0

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:60   
      432    12213    2             CONTEXT.UENTADDR$ = XSD$SERVICE.UENTADDR$;

  12213  5 001261   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001262   000010 236100                    LDQ     8,,PR0
         5 001263   200020 471500                    LDP1    CONTEXT$,,AUTO
         5 001264   100004 756100                    STQ     4,,PR1

      433    12214    2          END;                             /* if xsd_contextxs = -1 */

  12214  5 001265   001300 710000 5                  TRA     s:12222

      434    12215    2        ELSE DO;                           /* else xsd_contextxs = -1*/

      435    12216    3             CALL XSS$BUFPTR(XSD_CONTEXTX,CONTEXT$) WHENALTRETURN DO;

  12216  5 001266   200020 630500                    EPPR0   CONTEXT$,,AUTO
         5 001267   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 001270   000024 236000 6                  LDQ     20
         5 001271   200042 756100                    STQ     XSP@ASN1_FPT+14,,AUTO
         5 001272   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001273   000001 631400 6                  EPPR1   1
         5 001274   000000 701000 xent               TSX1    XSS$BUFPTR
         5 001275   001277 702000 5                  TSX2    s:12217
         5 001276   001300 710000 5                  TRA     s:12222

      436    12217    3                  GOTO ERR;

  12217  5 001277   001462 710000 5                  TRA     ERR

      437    12218    3               END;
      438    12219    2          END;                             /* else xsd_contextxs = -1 */

      439    12220
      440    12221
      441    12222    2        CALL XSS$GETMEM(SERVICEX,SERVICE$,LENGTHC(XSD$SERVICE)) WHENALTRETURN DO;

  12222  5 001300   000065 236000 6                  LDQ     53
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:61   
         5 001301   200044 756100                    STQ     XSP@ASN1_FPT+16,,AUTO
         5 001302   200013 630500                    EPPR0   SERVICE$,,AUTO
         5 001303   200043 450500                    STP0    XSP@ASN1_FPT+15,,AUTO
         5 001304   200014 631500                    EPPR1   SERVICEX,,AUTO
         5 001305   200042 451500                    STP1    XSP@ASN1_FPT+14,,AUTO
         5 001306   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001307   000016 631400 6                  EPPR1   14
         5 001310   000000 701000 xent               TSX1    XSS$GETMEM
         5 001311   001313 702000 5                  TSX2    s:12223
         5 001312   001322 710000 5                  TRA     s:12228

      442    12223    2             XSD$SERVICE.ERRCODE = E_NOMEM;

  12223  5 001313   000002 236000 2                  LDQ     E_NOMEM
         5 001314   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001315   000003 756100                    STQ     3,,PR0

      443    12224    2             XSD$SERVICE.ERRCODE.SEV = 2;

  12224  5 001316   000020 376000 6                  ANQ     16
         5 001317   000002 276007                    ORQ     2,DL
         5 001320   000003 756100                    STQ     3,,PR0

      444    12225    2             GOTO ERR;

  12225  5 001321   001462 710000 5                  TRA     ERR

      445    12226    2          END;
      446    12227
      447    12228    2        DO CASE (XSD$SERVICE.MODE);

  12228  5 001322   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001323   000000 236100                    LDQ     0,,PR0
         5 001324   000011 772000                    QRL     9
         5 001325   000777 376007                    ANQ     511,DL
         5 001326   000003 116007                    CMPQ    3,DL
         5 001327   001331 602006 5                  TNC     s:12228+7,QL
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:62   
         5 001330   001355 710000 5                  TRA     s:12244
         5 001331   001355 710000 5                  TRA     s:12244
         5 001332   001355 710000 5                  TRA     s:12244
         5 001333   001334 710000 5                  TRA     s:12230

      448    12229    2         CASE(%XSD_MODE_ATTR);        /* single name with a list of attributes */

      449    12230    3           DO I = 0 TO XSD$SERVICE.ATTR#-1;

  12230  5 001334   200006 450100                    STZ     I,,AUTO
         5 001335   001350 710000 5                  TRA     s:12235+1

      450    12231    4              IF XSD$SERVICE.ATTRIBUTE.TYPE(I) > %XSD_AT_MAXATTR THEN DO;

  12231  5 001336   200006 235100                    LDA     I,,AUTO
         5 001337   000001 735000                    ALS     1
         5 001340   200003 470500                    LDP0    @XSD$SERVICE,,AUTO
         5 001341   000013 235105                    LDA     11,AL,PR0
         5 001342   000052 115007                    CMPA    42,DL
         5 001343   001347 602000 5                  TNC     s:12235

      451    12232    4                   XSD$SERVICE.ERRCODE = E_BADATTRIBUTE;

  12232  5 001344   000010 236000 2                  LDQ     E_BADATTRIBUTE
         5 001345   000003 756100                    STQ     3,,PR0

      452    12233    4                   GOTO ERR;

  12233  5 001346   001462 710000 5                  TRA     ERR

      453    12234    4                END;
      454    12235    3           END;                            /* do i */

  12235  5 001347   200006 054100                    AOS     I,,AUTO
         5 001350   200006 236100                    LDQ     I,,AUTO
         5 001351   001336 604000 5                  TMI     s:12231
         5 001352   000005 116100                    CMPQ    5,,PR0
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:63   
         5 001353   001336 602000 5                  TNC     s:12231
         5 001354   001355 710000 5                  TRA     s:12244

      455    12236
      456    12237    2         CASE(%XSD_MODE_NAME);

      457    12238
      458    12239    2         CASE(%XSD_MODE_LIST);

      459    12240
      460    12241    2        END;                               /* do case */

      461    12242
      462    12243    2        DO INHIBIT;

      463    12244    2           SERVICE = XSD$SERVICE;

  12244  5 001355   200013 471700                    LDP1  ! SERVICE$,,AUTO
         5 001356   000100 100700                    MLR   ! fill='000'O
         5 001357   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52
         5 001360   100000 000064                    ADSC9   0,,PR1                   cn=0,n=52

      464    12245    2           SERVICE.SERVICEXS.NXTXS = -1;

  12245  5 001361   777777 220203                    LDX0  ! -1,DU
         5 001362   200013 471700                    LDP1  ! SERVICE$,,AUTO
         5 001363   100010 740300                    STX0  ! 8,,PR1

      465    12246    2           SERVICE.SERVICEXS.PRVXS = -1;

  12246  5 001364   200013 471700                    LDP1  ! SERVICE$,,AUTO
         5 001365   100010 440300                    SXL0  ! 8,,PR1

      466    12247
      467    12248        /* add service block to current context block service list */
      468    12249
      469    12250    2           BINDTOX = CONTEXT.SERVICEX;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:64   

  12250  5 001366   200020 471700                    LDP1  ! CONTEXT$,,AUTO
         5 001367   100001 221300                    LDX1  ! 1,,PR1
         5 001370   200012 741300                    STX1  ! BINDTOX,,AUTO

      470    12251    2           IF BINDTOXS = -1 THEN

  12251  5 001371   200012 222300                    LDX2  ! BINDTOX,,AUTO
         5 001372   777777 102203                    CMPX2 ! -1,DU
         5 001373   001377 601200 5                  TNZ   ! s:12254

      471    12252    2              CONTEXT.SERVICEX = SERVICEX;

  12252  5 001374   200014 223300                    LDX3  ! SERVICEX,,AUTO
         5 001375   100001 743300                    STX3  ! 1,,PR1
         5 001376   001426 710200 5                  TRA   ! s:12269

      472    12253    3           ELSE DO;

      473    12254    4                DO WHILE BINDTOXS ~= -1;

  12254  5 001377   001415 710200 5                  TRA   ! s:12261

      474    12255             /* use bufptr to run inhibited*/
      475    12256    5                   CALL XSS$BUFPTR(BINDTOXS,BINDTO$) WHENALTRETURN DO;

  12256  5 001400   200011 630700                    EPPR0 ! BINDTO$,,AUTO
         5 001401   200043 450700                    STP0  ! XSP@ASN1_FPT+15,,AUTO
         5 001402   200012 631700                    EPPR1 ! BINDTOX,,AUTO
         5 001403   200042 451700                    STP1  ! XSP@ASN1_FPT+14,,AUTO
         5 001404   200042 630700                    EPPR0 ! XSP@ASN1_FPT+14,,AUTO
         5 001405   000001 631600 6                  EPPR1 ! 1
         5 001406   000000 701200 xent               TSX1  ! XSS$BUFPTR
         5 001407   001411 702200 5                  TSX2  ! s:12258
         5 001410   001412 710200 5                  TRA   ! s:12260

      476    12257                                                /* oops */
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:65   
      477    12258    5                        GOTO ERR;

  12258  5 001411   001462 710200 5                  TRA   ! ERR

      478    12259    5                     END;
      479    12260    4                   BINDTOXS = BINDTO$->SERVICE.SERVICEXS.NXTXS;

  12260  5 001412   200011 470700                    LDP0  ! BINDTO$,,AUTO
         5 001413   000010 220300                    LDX0  ! 8,,PR0
         5 001414   200012 740300                    STX0  ! BINDTOX,,AUTO

      480    12261    4                END;

  12261  5 001415   200012 220300                    LDX0  ! BINDTOX,,AUTO
         5 001416   777777 100203                    CMPX0 ! -1,DU
         5 001417   001400 601200 5                  TNZ   ! s:12256

      481    12262    3                BINDTO$->SERVICE.SERVICEX.NXTX = SERVICEX;
             12262                         /* set current to new service block*/

  12262  5 001420   200014 221300                    LDX1  ! SERVICEX,,AUTO
         5 001421   200011 470700                    LDP0  ! BINDTO$,,AUTO
         5 001422   000010 741300                    STX1  ! 8,,PR0

      482    12263    3                SERVICE.SERVICEX.PRVX = BINDTOX;
             12263                         /* set new to point back to previous */

  12263  5 001423   200012 220300                    LDX0  ! BINDTOX,,AUTO
         5 001424   200013 470700                    LDP0  ! SERVICE$,,AUTO
         5 001425   000010 440300                    SXL0  ! 8,,PR0

      483    12264    3             END;

      484    12265    2        END;/* do inhibit */

      485    12266
      486    12267        /* if nothing is going on send the next service request */
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:66   
      487    12268
      488    12269    2        IF CONTEXT.STATE = %XSD_ST_READY THEN DO;

  12269  5 001426   200020 470500                    LDP0    CONTEXT$,,AUTO
         5 001427   000003 235100                    LDA     3,,PR0
         5 001430   000004 115007                    CMPA    4,DL
         5 001431   001461 601000 5                  TNZ     s:12286

      489    12270    3             DO INHIBIT;

      490    12271    3                BINDTOX = CONTEXT.SERVICEX;

  12271  5 001432   000001 220300                    LDX0  ! 1,,PR0
         5 001433   200012 740300                    STX0  ! BINDTOX,,AUTO

      491    12272    4                DO WHILE BINDTOXS ~= -1;

  12272  5 001434   001456 710200 5                  TRA   ! s:12281

      492    12273    5                   CALL XSS$BUFPTR(BINDTOX,BINDTO$) WHENALTRETURN DO;

  12273  5 001435   200011 630700                    EPPR0 ! BINDTO$,,AUTO
         5 001436   200043 450700                    STP0  ! XSP@ASN1_FPT+15,,AUTO
         5 001437   200012 631700                    EPPR1 ! BINDTOX,,AUTO
         5 001440   200042 451700                    STP1  ! XSP@ASN1_FPT+14,,AUTO
         5 001441   200042 630700                    EPPR0 ! XSP@ASN1_FPT+14,,AUTO
         5 001442   000001 631600 6                  EPPR1 ! 1
         5 001443   000000 701200 xent               TSX1  ! XSS$BUFPTR
         5 001444   001446 702200 5                  TSX2  ! s:12274
         5 001445   001447 710200 5                  TRA   ! s:12276

      493    12274    5                        GOTO ERR;

  12274  5 001446   001462 710200 5                  TRA   ! ERR

      494    12275    5                     END;
      495    12276    5                   IF NOT BINDTO$->SERVICE.FLAGS.PROCESSED THEN DO;
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:67   

  12276  5 001447   200011 470700                    LDP0  ! BINDTO$,,AUTO
         5 001450   000002 236300                    LDQ   ! 2,,PR0
         5 001451   010000 316203                    CANQ  ! 4096,DU
         5 001452   001454 601200 5                  TNZ   ! s:12280

      496    12277
      497    12278    5                     END;

  12278  5 001453   001456 710200 5                  TRA   ! s:12281

      498    12279    4                   ELSE
      499    12280    4                      BINDTOX = BINDTO$->SERVICE.SERVICEX.NXTX;

  12280  5 001454   000010 220300                    LDX0  ! 8,,PR0
         5 001455   200012 740300                    STX0  ! BINDTOX,,AUTO

      500    12281    4                END;

  12281  5 001456   200012 220300                    LDX0  ! BINDTOX,,AUTO
         5 001457   777777 100203                    CMPX0 ! -1,DU
         5 001460   001435 601200 5                  TNZ   ! s:12273

      501    12282
      502    12283    3             END;                          /* do inhibit */

      503    12284    2          END;

      504    12285
      505    12286    1        RETURN;

  12286  5 001461   000000 702200 xent               TSX2  ! X66_ARET

  12278  5 001462                       ERR          null
      506    12287
      507    12288    1   ERR: ;
      508    12289    1        IF BINDTOXS ~= -1 THEN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:68   

  12289  5 001462   200012 220100                    LDX0    BINDTOX,,AUTO
         5 001463   777777 100003                    CMPX0   -1,DU
         5 001464   001474 600000 5                  TZE     s:12293

      509    12290    2           CALL XSS$RELMEM(BINDTOX) WHENALTRETURN DO;

  12290  5 001465   200012 630500                    EPPR0   BINDTOX,,AUTO
         5 001466   200042 450500                    STP0    XSP@ASN1_FPT+14,,AUTO
         5 001467   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001470   000014 631400 6                  EPPR1   12
         5 001471   000000 701000 xent               TSX1    XSS$RELMEM
         5 001472   001474 702000 5                  TSX2    s:12293
         5 001473   001474 710000 5                  TRA     s:12293

      510    12291             /* as if we didn't have enough problems */
      511    12292    2             END;

      512    12293    1        IF BINDFROMXS ~= -1 THEN

  12293  5 001474   200010 220100                    LDX0    BINDFROMX,,AUTO
         5 001475   777777 100003                    CMPX0   -1,DU
         5 001476   001506 600000 5                  TZE     s:12296

      513    12294    2           CALL XSS$RELMEM(BINDFROMX) WHENALTRETURN DO;

  12294  5 001477   200010 630500                    EPPR0   BINDFROMX,,AUTO
         5 001500   200042 450500                    STP0    XSP@ASN1_FPT+14,,AUTO
         5 001501   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001502   000014 631400 6                  EPPR1   12
         5 001503   000000 701000 xent               TSX1    XSS$RELMEM
         5 001504   001506 702000 5                  TSX2    s:12296
         5 001505   001506 710000 5                  TRA     s:12296

      514    12295    2             END;

      515    12296    1        IF SERVICEXS ~= -1 THEN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:69   

  12296  5 001506   200014 220100                    LDX0    SERVICEX,,AUTO
         5 001507   777777 100003                    CMPX0   -1,DU
         5 001510   001520 600000 5                  TZE     s:12299

      516    12297    2           CALL XSS$RELMEM(SERVICEX) WHENALTRETURN DO;

  12297  5 001511   200014 630500                    EPPR0   SERVICEX,,AUTO
         5 001512   200042 450500                    STP0    XSP@ASN1_FPT+14,,AUTO
         5 001513   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001514   000014 631400 6                  EPPR1   12
         5 001515   000000 701000 xent               TSX1    XSS$RELMEM
         5 001516   001520 702000 5                  TSX2    s:12299
         5 001517   001520 710000 5                  TRA     s:12299

      517    12298    2             END;

      518    12299    1        IF BUFXS ~= -1 THEN

  12299  5 001520   200015 220100                    LDX0    BUFX,,AUTO
         5 001521   777777 100003                    CMPX0   -1,DU
         5 001522   001532 600000 5                  TZE     s:12302

      519    12300    2           CALL XSS$RELMEM(BUFX) WHENALTRETURN DO;

  12300  5 001523   200015 630500                    EPPR0   BUFX,,AUTO
         5 001524   200042 450500                    STP0    XSP@ASN1_FPT+14,,AUTO
         5 001525   200042 630500                    EPPR0   XSP@ASN1_FPT+14,,AUTO
         5 001526   000014 631400 6                  EPPR1   12
         5 001527   000000 701000 xent               TSX1    XSS$RELMEM
         5 001530   001532 702000 5                  TSX2    s:12302
         5 001531   001532 710000 5                  TRA     s:12302

      520    12301    2             END;

      521    12302    1        ALTRETURN;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:70   
  12302  5 001532   000000 702200 xent               TSX2  ! X66_AALT

OPENDIB_UPDATE
 Sect OctLoc
   1     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
   1     004   000000 177640   000000 006014   000001 177640   000176 006000    .............~..
   1     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     024*  000001 777640   000174 006000   000000 177640   000000 006014    .....|..........
   1     030   001777 777640   000556 006000   000000 177640   000000 006014    ................
   1     034   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     044*  000000 000052   000000 001001   252525 015000   000040 252520    ...*......... ..
   1     050   000040 040040   000000 000002   000000 777777   000000 000000    .   ............
   1     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     070   000000 000000   ****** ******                                    ........

IRELREAD
 Sect OctLoc
   1     072   000005 777640   000102 006000   000350 777640   000000 006000    .....B..........
   1     076   000000 177640   000000 006014   000001 777640   000200 006000    ................
   1     102   000000 740000   000000 000000   000000 000000   000000 000000    ................
   1     106   000000 000000   000000 000000                                    ........

IRELPRECORD
 Sect OctLoc
   1     110   000003 777640   000116 006000   000350 777640   000000 006000    .....N..........
   1     114   000311 777640   000202 006000   000000 401000   000000 000000    ................
   1     120   000000 000000   0***** ******                                    ........

IRELWRITE
 Sect OctLoc
   1     122   000003 777640   000132 006000   000000 177640   000000 006014    .....Z..........
   1     126   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     132   000000 400400   000000 000000   000000 000000   000000 000000    ................

IRELCLOSE
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:71   
 Sect OctLoc
   1     136   000003 777640   000170 006000   000000 177640   000000 006014    .....x..........
   1     142   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     166*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     172   000220 000000   000000 000000                                    ........

DIBACCT
 Sect OctLoc
   1     174   040040 040040   040040 040040

IRELNAME
 Sect OctLoc
   1     176   004072 104111   102*** ******                                    .:DIB...

VLP_ID
 Sect OctLoc
   1     200   000000 000001   000000 000000                                    ........

VLR_ID
 Sect OctLoc
   1     202   000000 000310   000000 000000   000000 000000   000000 000000    ................
   1     206   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     512*  000000 000000                                                    ....

DIB_ACSVEH
 Sect OctLoc
   1     514   000000 000005   740000 011122   117125 124105   103117 116077    .......ROUTECON?
   1     520   740000 004104   123101 077***                                    ...DSA?.

FPT_MONINFO
 Sect OctLoc
   1     522   000000 177640   000000 006014   000017 777640   000536 006000    ................
   1     526   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     532   000000 177640   000000 006014   000000 177640   000000 006014    ................

VLR_MONINFO
 Sect OctLoc
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:72   
   1     536   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     546*  000000 000000   000000 000000   040040 040040   040040 040040    ........
   1     552   000000 000000   000000 000000   000000 000000                    ............

FPARAM
 Sect OctLoc
   1     556   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    2552*  000000 000000   000000 000000   000000 000000   000000 000000    ................

CCB
 Sect OctLoc
   1    2561   000000 060000   302303 000170   004000 000017   000000 000000    ..0....x........
   1    2565   000004 000062   000000 777777   002615 006000   000000 000000    ...2............
   1    2571   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    2575   000000 000000   000000 000000                                    ........

AASCREQ
 Sect OctLoc
   1    2577   001000 000000   302303 000200   000000 006014   000000 006000    ................
   1    2603   000000 006014   000000 006014   000000 000000   000000 000000    ................
   1    2613*  000000 006014   000000 006000                                    ........

XSC$ADDRESS
 Sect OctLoc
   1    2615   000040 040040   040040 040040   040040 040040   040040 040040    .
   1    2621   040040 040040   040040 040040   040040 040040   040040 040040
   1    2705*  040000 040040   040040 040040   040040 040040   040040 040040     .
   1    2711   040040 ******   000000 040040   040040 040040   040040 040040      ....
   1    2715   040040 040040   040040 040040   040040 040040   040040 040040
   1    2721   040040 040040   040040 ******   000067 000000   000000 000000          ...7......
   1    2725   000000 000000   000000 000000   000000 000000   000000 ******    ................

ERR_C
 Sect OctLoc
   2     000   302304 000000                                                    ....

E_RELMEM
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:73   
 Sect OctLoc
   2     001   302304 000150                                                    ...h

E_NOMEM
 Sect OctLoc
   2     002   302304 000100                                                    ...@

E_BADFUNCTION
 Sect OctLoc
   2     003   302304 000010                                                    ....

E_DUANOTDEFINED
 Sect OctLoc
   2     004   302304 000070                                                    ...8

E_BADSUBCODE
 Sect OctLoc
   2     005   302304 000020                                                    ....

E_DSANOTDEFINED
 Sect OctLoc
   2     006   302304 000110                                                    ...H

E_NODSASDEFINED
 Sect OctLoc
   2     007   302304 000120                                                    ...P

E_BADATTRIBUTE
 Sect OctLoc
   2     010   302304 000060                                                    ...0

E_COMMINIT
 Sect OctLoc
   2     011   302304 000140                                                    ...`

DUA
 Sect OctLoc
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:74   
   2     012   104125 101***                                                    DUA.

CONTEXT_C
 Sect OctLoc
   2     013   777777 777777   777777 777777   777777 777777   000000 000000    ................
   2     017   000000 000000   000000 000000   000000 000000                    ............

ASN1_FPT_C
 Sect OctLoc
   2     022   000000 006014   000000 006014   000000 000000   000000 000000    ................
   2     026   000000 006014   000000 000000   000000 000000   000000 000000    ................
   2     032   400000 000000   000000 000000   000000 000000   000000 000000    ................
   2     036   000000 000000   000000 006014                                    ........

(unnamed)
 Sect OctLoc
   6     000   000556 006000   000002 000000   000000 000022   002556 006000    ................
   6     004   000002 006000   000000 000023   002557 006000   000005 006000    ................
   6     010   000000 000025   002560 006000   000010 006000   000000 006003    ................
   6     014   000001 000000   000000 000000   000003 000000   000000 006000    ................
   6     020   777777 777770   000000 006014   000000 000034   000022 006000    ................
   6     024   000000 006000   040040 040040   000352 777640   777777 600000    ....    ........
   6     030   000007 577640   000341 206000   000000 004101   000032 006000    ...........A....
   6     034   000004 000000   000000 000050   000000 001654   000000 000051    .......(.......)
   6     040   000035 006000   000036 006000   000037 006000   000036 006000    ................
   6     044   000000 000052   000000 000053   000044 006000   000036 006000    ...*...+.$......
   6     050   000045 006000   000036 006000   000000 177640   000000 006000    .%..............
   6     054   777777 577777   777777 677777   777777 773777   000006 000000    ................
   6     060   400000 000000   000060 006000   002561 006000   002577 006000    .....0..........
   6     064   000000 000064   000064 006000                                    ...4.4..
      522    12303    1   END XSD$DIRECTORY;

PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:75   
--  Include file information  --

   XSP_ASN1_M.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   XSC_ACSE_E.:XSA1TOU  is referenced.
   XSC_ACSE_M.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSD_SUBS_C.:XSA1TOU  is referenced.
   FM_FIELD_C.:LIB_E05  is referenced.
   FM$FIT.:LIB_E05  is referenced.
   XSD_PERR_C.:XSA1TOU  is referenced.
   XSD_MACRO_M.:XSA1TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XSD$DIRECTORY.
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:76   

 **** Variables and constants ****

  ****  Section 001  Data  XSD$DIRECTORY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  2577-0-0/w STRC(504)   r     1 AASCREQ                 2561-0-0/w STRC(504)   r     1 CCB
  2556-0-0/w PTR         r     1 CODE18$                 2557-0-0/w PTR         r     1 CODE19$
  2560-0-0/w PTR         r     1 CODE21$                  174-0-0/c STRC(72)    r     1 DIBACCT
   514-0-0/w STRC(207)   r     1 DIB_ACSVEH               556-0-0/w UBIN        r     1 FPARAM(0:1023)
   522-0-0/d STRC(432)   r     1 FPT_MONINFO              136-0-0/d STRC(1080)  r     1 IRELCLOSE
   176-0-0/c STRC(45)    r     1 IRELNAME                 110-0-0/d STRC(360)   r     1 IRELPRECORD
    72-0-0/d STRC(504)   r     1 IRELREAD                 122-0-0/d STRC(432)   r     1 IRELWRITE
     0-0-0/d STRC(2088)  r     1 OPENDIB_UPDATE           200-0-0/d STRC(72)    r     1 VLP_ID
   202-0-0/d STRC(7236)  r     1 VLR_ID                   536-0-0/d STRC(540)   r     1 VLR_MONINFO
  2615-0-0/w STRC(2718)  r     1 XSC$ADDRESS

  ****  Section 002 RoData XSD$DIRECTORY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/w STRC(504)   r     1 ASN1_FPT_C                13-0-0/w STRC(252)   r     1 CONTEXT_C
    12-0-0/c CHAR(3)     r     1 DUA                        0-0-0/w STRC        r     1 ERR_C
    10-0-0/w STRC        r     1 E_BADATTRIBUTE             3-0-0/w STRC        r     1 E_BADFUNCTION
     5-0-0/w STRC        r     1 E_BADSUBCODE              11-0-0/w STRC        r     1 E_COMMINIT
     6-0-0/w STRC        r     1 E_DSANOTDEFINED            4-0-0/w STRC        r     1 E_DUANOTDEFINED
     7-0-0/w STRC        r     1 E_NODSASDEFINED            2-0-0/w STRC        r     1 E_NOMEM
     1-0-0/w STRC        r     1 E_RELMEM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @XSD$SERVICE               7-0-0/w PTR         r     1 BINDFROM$
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:77   
    10-0-0/h UBIN(18)    r     1 BINDFROMX                 10-0-0/h SBIN(18)    r     1 BINDFROMXS
    11-0-0/w PTR         r     1 BINDTO$                   12-0-0/h UBIN(18)    r     1 BINDTOX
    12-0-0/h SBIN(18)    r     1 BINDTOXS                  16-0-0/w PTR         r     1 BUF$
    15-0-0/h UBIN(18)    r     1 BUFX                      15-0-0/h SBIN(18)    r     1 BUFXS
    20-0-0/w PTR         r     1 CONTEXT$                   5-0-0/w UBIN        r     1 DIBERR
    23-0-0/w UBIN        r     1 DUAKEYID                   6-0-0/w SBIN        r     1 I
    13-0-0/w PTR         r     1 SERVICE$                  14-0-0/h UBIN(18)    r     1 SERVICEX
    14-0-0/h SBIN(18)    r     1 SERVICEXS                  6-0-0/w UBIN        r     1 SIZE
     4-0-0/w UBIN        r     1 STARTX                    *0-0-0/d STRC(468)   r     1 XSD$SERVICE
    24-0-0/w STRC(504)   r     1 XSP@ASN1_FPT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/h UBIN(18)    r     1 XSD_CONTEXTX
     0-0-0/h SBIN(18)    r     1 XSD_CONTEXTXS              0-0-0/w STRC(8388)  r     1 XSD_DIBKEY
     0-0-0/c STRC(27)    r     1 XSD_DIRECTORYACCESSAC
     0-0-0/w SBIN        r     1 XSD_DS_OPENDIB             0-0-0/w UBIN        r     1 XSD_PCDL_DUA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(19017) r     1 BINDFROM                   0-0-0/w STRC(19017) r     1 BINDTO
     0-0-0/c ACHR        r     1 BUFFER                     0-0-0/w STRC(252)   r     1 CONTEXT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DIB
     0-0-0N  NULL        r     1 M$DSA                      0-0-0/d STRC(468)   r     1 SERVICE
     0-0-0/c ASTR(9)     r     1 TEXTC                      0-0-0/w STRC(8460)  r     1 XSD_DIBBUF


   Procedure XSD$DIRECTORY requires 859 words for executable code.
   Procedure XSD$DIRECTORY requires 40 words of local(AUTO) storage.
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:78   

    No errors detected in file XSD$DIRECTORY.:XSA1TSI    .
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:79   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:80   
          MINI XREF LISTING

AASCREQ
     11568**DCL     12203<>CALL
AASCREQ.CCID
     11580**DCL     12199<<ASSIGN
AASCREQ.DATA$
     11613**DCL     12195<<ASSIGN
AASCREQ.ERRDEF
     11583**DCL     11603--REDEF
AASCREQ.ERROR
     11603**DCL     12204>>ASSIGN
AASCREQ.FNC
     11579**DCL     12194<<ASSIGN
AASCREQ.IAPT$
     11615**DCL     12200<<ASSIGN
AASCREQ.RAPT$
     11619**DCL     12201<<ASSIGN
ASN1_FPT_C
     10413**DCL     12191>>ASSIGN
ASN1_FPT_C.C0
     10419**DCL     10419--REDEF
ASN1_FPT_C.DAT$
     10421**DCL     10421--REDEF
ASN1_FPT_C.N0
     10420**DCL     10420--REDEF
ASN1_FPT_C.R0
     10418**DCL     10419--REDEF
B$ALT.CODE
      9387**DCL      9387--REDEF    9388--REDEF    9388--REDEF
B$ALT.ERR
      9388**DCL     11971>>ASSIGN  12046>>ASSIGN  12120>>ASSIGN
B$ALT.ERR.ERR#
      9389**DCL      9389--REDEF
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:81   
B$ALT.EVID
      9388**DCL      9388--REDEF    9388--REDEF
B$TCB.ALT$
      9394**DCL     11971>>ASSIGN  12046>>ASSIGN  12120>>ASSIGN
B$TCB$
      9381**DCL      9394--IMP-PTR 11971>>ASSIGN  12046>>ASSIGN  12120>>ASSIGN
BINDFROM
     10531**DCL     12068--CALL    12175<>CALL
BINDFROM.COMMONNAME
     10554**DCL     12076<<ASSIGN  12200--ASSIGN
BINDFROM.NSAP
     10714**DCL     12084<<ASSIGN  12183>>ASSIGN
BINDFROM.PRES
     10594**DCL     12078<<ASSIGN  12179>>ASSIGN
BINDFROM.SESS
     10634**DCL     12080<<ASSIGN  12182>>ASSIGN
BINDFROM.TRAN
     10674**DCL     12082<<ASSIGN
BINDFROM.TRAN.L
     10693**DCL     12180>>ASSIGN
BINDFROM.TRAN.T
     10694**DCL     12181>>ASSIGN
BINDFROM$
     11915**DCL     10531--IMP-PTR 12068<>CALL    12076>>ASSIGN  12078>>ASSIGN  12080>>ASSIGN  12082>>ASSIGN
     12084>>ASSIGN  12175>>CALL    12179>>ASSIGN  12180>>ASSIGN  12181>>ASSIGN  12182>>ASSIGN  12183>>ASSIGN
     12200>>ASSIGN
BINDFROMX
     11916**DCL     11917--REDEF   12068<>CALL    12294<>CALL
BINDFROMXS
     11917**DCL     12018<<ASSIGN  12193>>ASSIGN  12293>>IF
BINDTO
     10753**DCL     12146--CALL    12175<>CALL
BINDTO.COMMONNAME
     10776**DCL     12153<<ASSIGN  12201--ASSIGN
BINDTO.NSAP
     10936**DCL     12161<<ASSIGN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:82   
BINDTO.PRES
     10816**DCL     12155<<ASSIGN
BINDTO.SESS
     10856**DCL     12157<<ASSIGN
BINDTO.TRAN
     10896**DCL     12159<<ASSIGN
BINDTO$
     11918**DCL     10753--IMP-PTR 12146<>CALL    12153>>ASSIGN  12155>>ASSIGN  12157>>ASSIGN  12159>>ASSIGN
     12161>>ASSIGN  12175>>CALL    12201>>ASSIGN  12256<>CALL    12260>>ASSIGN  12262>>ASSIGN  12273<>CALL
     12276>>IF      12280>>ASSIGN
BINDTOX
     11919**DCL     11920--REDEF   12146<>CALL    12250<<ASSIGN  12263>>ASSIGN  12271<<ASSIGN  12273<>CALL
     12280<<ASSIGN  12290<>CALL
BINDTOXS
     11920**DCL     12019<<ASSIGN  12192>>ASSIGN  12251>>IF      12254>>DOWHILE 12256<>CALL    12260<<ASSIGN
     12272>>DOWHILE 12289>>IF
BUF$
     11926**DCL     11180--IMP-PTR 11197--IMP-PTR 12025<>CALL    12057>>ASSIGN  12076>>ASSIGN  12076>>ASSIGN
     12077>>CALL    12078>>ASSIGN  12078>>ASSIGN  12079>>CALL    12080>>ASSIGN  12080>>ASSIGN  12081>>CALL
     12082>>ASSIGN  12082>>ASSIGN  12083>>CALL    12084>>ASSIGN  12084>>ASSIGN  12153>>ASSIGN  12153>>ASSIGN
     12154>>CALL    12155>>ASSIGN  12155>>ASSIGN  12156>>CALL    12157>>ASSIGN  12157>>ASSIGN  12158>>CALL
     12159>>ASSIGN  12159>>ASSIGN  12160>>CALL    12161>>ASSIGN  12161>>ASSIGN  12170<>CALL    12175>>CALL
     12196>>ASSIGN
BUFFER
     11180**DCL     12175<>CALL
BUFX
     11924**DCL     11925--REDEF   12025<>CALL    12164<>CALL    12170<>CALL    12300<>CALL
BUFXS
     11925**DCL     12021<<ASSIGN  12299>>IF
CCB
     11270**DCL     12185<>CALL
CCB.ERRDEF
     11377**DCL     11397--REDEF
CCB.LCID
     11369**DCL     12199>>ASSIGN
CCBX
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:83   
     11930**DCL     11931--REDEF
CODE18.DECFIELD
      9842**DCL      9843--REDEF
CODE18$
     11249**DCL      9842--IMP-PTR 11974<<ASSIGN  11975<>CALL
CODE19$
     11250**DCL      9846--IMP-PTR 11978<<ASSIGN  11979<>CALL
CODE21$
     11251**DCL      9849--IMP-PTR 11982<<ASSIGN  11983<>CALL
CONTEXT
     11141**DCL     12032--CALL    12037<<ASSIGN
CONTEXT.BINDFROMXS
     11162**DCL     11163--REDEF   12193<<ASSIGN
CONTEXT.BINDTOXS
     11158**DCL     11159--REDEF   12192<<ASSIGN
CONTEXT.BUFXS
     11166**DCL     11167--REDEF
CONTEXT.NEXTXS
     11146**DCL     11147--REDEF
CONTEXT.PRIORXS
     11149**DCL     11150--REDEF
CONTEXT.SERVICEX
     11153**DCL     12250>>ASSIGN  12252<<ASSIGN  12271>>ASSIGN
CONTEXT.SERVICEXS
     11152**DCL     11153--REDEF
CONTEXT.STATE
     11169**DCL     12212<<ASSIGN  12269>>IF
CONTEXT.UENTADDR$
     11171**DCL     12213<<ASSIGN
CONTEXT$
     11929**DCL     11141--IMP-PTR 12032<>CALL    12037>>ASSIGN  12192>>ASSIGN  12193>>ASSIGN  12209<>CALL
     12212>>ASSIGN  12213>>ASSIGN  12216<>CALL    12250>>ASSIGN  12252>>ASSIGN  12269>>IF      12271>>ASSIGN
CONTEXTX
     11927**DCL     11928--REDEF
CONTEXT_C
     10364**DCL     12037>>ASSIGN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:84   
CONTEXT_C.BINDFROMXS
     10385**DCL     10386--REDEF
CONTEXT_C.BINDTOXS
     10381**DCL     10382--REDEF
CONTEXT_C.BUFXS
     10389**DCL     10390--REDEF
CONTEXT_C.NEXTXS
     10369**DCL     10370--REDEF
CONTEXT_C.PRIORXS
     10372**DCL     10373--REDEF
CONTEXT_C.SERVICEXS
     10375**DCL     10376--REDEF
DIBACCT
      9738**DCL      9548--DCLINIT
DIBERR
     11912**DCL     11968<<ASSIGN  11976<<ASSIGN  11980<<ASSIGN  11984<<ASSIGN  11987>>IF      11989>>ASSIGN
DIB_ACSVEH.Q
      9805**DCL      9804--DCLINIT
DUA
     10347**DCL     12043>>CALLBLT
DUAKEYID
     11933**DCL     12066<<ASSIGN  12111>>IF
ERR
     12278**LABEL   12028--GOTO    12035--GOTO    12063--GOTO    12095--GOTO    12099--GOTO    12121--GOTO
     12129--GOTO    12166--GOTO    12172--GOTO    12176--GOTO    12187--GOTO    12205--GOTO    12210--GOTO
     12217--GOTO    12225--GOTO    12233--GOTO    12258--GOTO    12274--GOTO
ERR_C
      9900**DCL     11988>>ASSIGN  12147>>ASSIGN
E_BADATTRIBUTE
     10268**DCL     12232>>ASSIGN
E_BADFUNCTION
     10038**DCL     11959>>ASSIGN
E_BADSUBCODE
     10130**DCL     11964>>ASSIGN
E_COMMINIT
     10314**DCL     12186>>ASSIGN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:85   
E_DSANOTDEFINED
     10176**DCL     12094>>ASSIGN  12139>>ASSIGN
E_DUANOTDEFINED
     10084**DCL     12062>>ASSIGN
E_NODSASDEFINED
     10222**DCL     12098>>ASSIGN  12128>>ASSIGN
E_NOMEM
      9992**DCL     12026>>ASSIGN  12033>>ASSIGN  12069>>ASSIGN  12148>>ASSIGN  12171>>ASSIGN  12223>>ASSIGN
E_RELMEM
      9946**DCL     12165>>ASSIGN
F$DCB.ACTPOS
      9429**DCL      9429--REDEF
F$DCB.ARS#
      9403**DCL      9403--REDEF   11993>>ASSIGN
F$DCB.ATTR
      9422**DCL      9423--REDEF
F$DCB.BORROW
      9437**DCL      9437--REDEF    9437--REDEF    9437--REDEF
F$DCB.DCBNAME.L
      9451**DCL      9451--IMP-SIZ
F$DCB.EOMCHAR#
      9407**DCL      9407--REDEF
F$DCB.FLDID
      9432**DCL      9432--REDEF
F$DCB.FORM$
      9426**DCL      9426--REDEF
F$DCB.FSECT
      9442**DCL      9442--REDEF
F$DCB.FSN#
      9419**DCL      9419--REDEF    9419--REDEF    9420--REDEF
F$DCB.HEADER$
      9425**DCL      9425--REDEF
F$DCB.IXTNSIZE#
      9423**DCL      9423--REDEF
F$DCB.LASTSTA$
      9412**DCL      9412--REDEF
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:86   
F$DCB.LVL
      9438**DCL      9438--REDEF
F$DCB.NAME#.C
      9413**DCL      9413--REDEF
F$DCB.NOEOF
      9435**DCL      9435--REDEF
F$DCB.NRECS#
      9424**DCL      9424--REDEF
F$DCB.NRECX
      9443**DCL      9443--REDEF
F$DCB.OHDR
      9435**DCL      9435--REDEF
F$DCB.ORG#
      9418**DCL      9418--REDEF
F$DCB.PRECNO
      9441**DCL      9441--REDEF
F$DCB.RCSZ
      9447**DCL      9447--REDEF
F$DCB.RES#
      9414**DCL      9414--REDEF
F$DCB.SETX
      9426**DCL      9426--REDEF
F$DCB.STARTX
      9429**DCL     12075>>ASSIGN
F$DCB.TAB$
      9426**DCL      9426--REDEF
F$DCB.TDA
      9440**DCL      9441--REDEF
F$DCB.WSN#
      9414**DCL      9414--REDEF
FOUNDONE
     12144**LABEL   12114--GOTO
FPARAM
     11248**DCL      9548--DCLINIT 11974--ASSIGN  11978--ASSIGN  11982--ASSIGN
FPT_MONINFO
      9864**DCL     12039<>CALL
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:87   
I
     11913**DCL     11914--REDEF   12042<<CALLBLT 12043>>CALLBLT 12077<>CALL    12078>>ASSIGN  12078>>ASSIGN
     12079<>CALL    12080>>ASSIGN  12080>>ASSIGN  12081<>CALL    12082>>ASSIGN  12082>>ASSIGN  12083<>CALL
     12084>>ASSIGN  12084>>ASSIGN  12110<<DOINDEX 12111>>IF      12112>>ASSIGN  12154<>CALL    12155>>ASSIGN
     12155>>ASSIGN  12156<>CALL    12157>>ASSIGN  12157>>ASSIGN  12158<>CALL    12159>>ASSIGN  12159>>ASSIGN
     12160<>CALL    12161>>ASSIGN  12161>>ASSIGN  12230<<DOINDEX 12231>>IF
IRELCLOSE.SN_
      9707**DCL      9707--REDEF
IRELCLOSE.UTL_
      9708**DCL      9708--REDEF
IRELCLOSE.V
      9712**DCL      9707--DCLINIT
IRELCLOSE.V.EXPIRE#
      9722**DCL      9722--REDEF
IRELCLOSE.V.TYPE#
      9720**DCL      9720--REDEF
IRELCLOSE.V.XTNSIZE#
      9717**DCL      9717--REDEF    9719--REDEF
IRELNAME
      9765**DCL      9544--DCLINIT
IRELPRECORD
      9641**DCL     12093<>CALL
IRELPRECORD.KEY_
      9641**DCL     12091<<ASSIGN
IRELPRECORD.V
      9643**DCL      9641--DCLINIT
IRELPRECORD.V.INDX#
      9646**DCL     12092<<ASSIGN
IRELREAD
      9606**DCL     12061<>CALL    12113<>CALL    12138<>CALL
IRELREAD.BUF_
      9608**DCL     12057<<ASSIGN
IRELREAD.BUF_.BOUND
      9608**DCL     12058<<ASSIGN
IRELREAD.KEY_
      9606**DCL     12060<<ASSIGN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:88   
IRELREAD.STATION_
      9609**DCL      9610--REDEF
IRELREAD.V
      9610**DCL      9606--DCLINIT
IRELREAD.V.DVBYTE.REREAD#
      9621**DCL      9621--REDEF
IRELREAD.V.IDS#
      9612**DCL     12107<<ASSIGN  12117<<ASSIGN  12125<<ASSIGN
IRELREAD.V.INDX#
      9619**DCL      9619--REDEF   12059<<ASSIGN  12135<<ASSIGN
IRELREAD.V.KEYR#
      9611**DCL     12109<<ASSIGN  12119<<ASSIGN  12127<<ASSIGN
IRELREAD.V.KEYS#
      9611**DCL     12108<<ASSIGN  12118<<ASSIGN  12126<<ASSIGN
IRELWRITE.STATION_
      9671**DCL      9671--REDEF
IRELWRITE.V
      9672**DCL      9669--DCLINIT
IRELWRITE.V.DVBYTE.VFC#
      9678**DCL      9678--REDEF
M$DIB
     10425**DCL     11993--ASSIGN  12075--ASSIGN
M$MONINFO
      5571**DCL-ENT 12039--CALL
M$OPEN
      5503**DCL-ENT 11970--CALL
M$PRECORD
      5507**DCL-ENT 12093--CALL
M$READ
      5504**DCL-ENT 12061--CALL    12113--CALL    12138--CALL
OPENDIB_UPDATE
      9543**DCL     11970<>CALL
OPENDIB_UPDATE.ACSVEH_
      9545**DCL      9546--REDEF
OPENDIB_UPDATE.ALTKEYS_
      9551**DCL      9552--REDEF    9552--REDEF
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:89   
OPENDIB_UPDATE.HDR_
      9550**DCL      9551--REDEF
OPENDIB_UPDATE.TAB_
      9549**DCL      9550--REDEF
OPENDIB_UPDATE.UHL_
      9543**DCL      9544--REDEF    9544--REDEF
OPENDIB_UPDATE.V
      9552**DCL      9543--DCLINIT
OPENDIB_UPDATE.V.FSN#
      9583**DCL      9583--REDEF    9583--REDEF
OPENDIB_UPDATE.WSN_
      9549**DCL      9549--REDEF
SERVICE
     10981**DCL     12244<<ASSIGN
SERVICE.ERRCODE
     11050**DCL     11081--REDEF   11082--REDEF
SERVICE.FLAGS.PROCESSED
     11032**DCL     12276>>IF
SERVICE.SERVICEX.NXTX
     11102**DCL     12262<<ASSIGN  12280>>ASSIGN
SERVICE.SERVICEX.PRVX
     11103**DCL     12263<<ASSIGN
SERVICE.SERVICEXS.NXTXS
     11105**DCL     12245<<ASSIGN  12260>>ASSIGN
SERVICE.SERVICEXS.PRVXS
     11106**DCL     12246<<ASSIGN
SERVICE.UENTADDR$
     11097**DCL     11101--REDEF   11104--REDEF
SERVICE$
     11921**DCL     10981--IMP-PTR 12222<>CALL    12244>>ASSIGN  12245>>ASSIGN  12246>>ASSIGN  12263>>ASSIGN
SERVICEX
     11922**DCL     11923--REDEF   12222<>CALL    12252>>ASSIGN  12262>>ASSIGN  12297<>CALL
SERVICEXS
     11923**DCL     12020<<ASSIGN  12296>>IF
SIZE
     11914**DCL     11180--IMP-SIZ 12169<<ASSIGN  12170<>CALL    12175>>CALL    12175<>CALL    12197>>ASSIGN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:90   
STARTX
     11911**DCL     12075<<ASSIGN
TEXTC
     10511**DCL     12076>>ASSIGN  12078>>ASSIGN  12080>>ASSIGN  12082>>ASSIGN  12084>>ASSIGN  12153>>ASSIGN
     12155>>ASSIGN  12157>>ASSIGN  12159>>ASSIGN  12161>>ASSIGN
TEXTC.L
     10512**DCL     10513--IMP-SIZ 12051>>ASSIGN  12051>>ASSIGN  12053>>ASSIGN  12076>>ASSIGN  12078>>ASSIGN
     12080>>ASSIGN  12082>>ASSIGN  12084>>ASSIGN  12136>>ASSIGN  12136>>ASSIGN  12137>>ASSIGN  12153>>ASSIGN
     12155>>ASSIGN  12157>>ASSIGN  12159>>ASSIGN  12161>>ASSIGN
TEXTC.T
     10513**DCL     12051>>ASSIGN  12136>>ASSIGN
VLP_ID
      9778**DCL      9609--DCLINIT
VLP_ID.ID#
      9778**DCL     12066>>ASSIGN  12112<<ASSIGN
VLR_ID
      9791**DCL      9643--DCLINIT
VLR_ID.COUNT#
      9791**DCL     12097>>IF      12110>>DOINDEX
VLR_ID.ID#
      9791**DCL     12111>>IF      12112>>ASSIGN
VLR_MONINFO
      9879**DCL      9864--DCLINIT
VLR_MONINFO.NODE_NAME
      9882**DCL     12041>>ASSIGN  12042>>CALLBLT 12043>>CALLBLT
XSC$ACSE
      9374**DCL-ENT 12203--CALL
XSC$ADDRESS
     11643**DCL     11474--DCLINIT
XSC$ADDRESS.NSAP
     11874**DCL     12183<<ASSIGN
XSC$ADDRESS.NSAP.ADDRESS_N
     11904**DCL     11905--REDEF
XSC$ADDRESS.PSAP
     11680**DCL     12179<<ASSIGN
XSC$ADDRESS.SSAP
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:91   
     11743**DCL     12182<<ASSIGN
XSC$ADDRESS.TSAP.LEN
     11802**DCL     12180<<ASSIGN
XSC$ADDRESS.TSAP.TSAP
     11810**DCL     12181<<ASSIGN
XSC$COMMINIT
      9372**DCL-ENT 12185--CALL
XSC$ROSE_RECV
      9370**DCL-ENT 11520--DCLINIT 11548--DCLINIT
XSD$BIND
      9364**DCL-ENT 12175--CALL
XSD$LOCFIELD
      9366**DCL-ENT 12077--CALL    12079--CALL    12081--CALL    12083--CALL    12154--CALL    12156--CALL
     12158--CALL    12160--CALL
XSD$MODIFY
      9363**DCL-ENT 12010--CALL
XSD$READ
      9361**DCL-ENT 12001--CALL
XSD$RECV
      9371**DCL-ENT 11532--DCLINIT
XSD$SEARCH
      9362**DCL-ENT 12007--CALL
XSD$SERVICE
      9214**DCL        13--PROC    12001<>CALL    12003<>CALL    12007<>CALL    12010<>CALL    12175<>CALL
     12222--CALL    12244>>ASSIGN
XSD$SERVICE.ATTR#
      9323**DCL     12230>>DOINDEX
XSD$SERVICE.ATTRIBUTE.TYPE
      9351**DCL     12231>>IF
XSD$SERVICE.BINDFROM$
      9340**DCL     12038>>IF      12051>>ASSIGN  12051>>ASSIGN  12051>>ASSIGN  12053>>ASSIGN
XSD$SERVICE.BINDTO$
      9345**DCL     12086>>IF      12136>>ASSIGN  12136>>ASSIGN  12136>>ASSIGN  12137>>ASSIGN
XSD$SERVICE.ERRCODE
      9283**DCL      9314--REDEF    9315--REDEF   11959<<ASSIGN  11964<<ASSIGN  11971<<ASSIGN  11988<<ASSIGN
     12026<<ASSIGN  12033<<ASSIGN  12046<<ASSIGN  12062<<ASSIGN  12069<<ASSIGN  12094<<ASSIGN  12098<<ASSIGN
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:92   
     12120<<ASSIGN  12128<<ASSIGN  12139<<ASSIGN  12147<<ASSIGN  12148<<ASSIGN  12165<<ASSIGN  12171<<ASSIGN
     12186<<ASSIGN  12204<<ASSIGN  12223<<ASSIGN  12232<<ASSIGN
XSD$SERVICE.ERRCODE.ERR#
      9311**DCL     11989<<ASSIGN
XSD$SERVICE.ERRCODE.SEV
      9311**DCL     12027<<ASSIGN  12034<<ASSIGN  12070<<ASSIGN  12149<<ASSIGN  12224<<ASSIGN
XSD$SERVICE.FLAGS.LOCALOKAY
      9239**DCL     11998>>IF
XSD$SERVICE.FNC
      9218**DCL     11958>>IF      11999>>DOCASE
XSD$SERVICE.MODE
      9226**DCL     12228>>DOCASE
XSD$SERVICE.SUBC
      9222**DCL     11963>>IF
XSD$SERVICE.UENTADDR$
      9330**DCL      9334--REDEF    9337--REDEF   12002>>IF      12003>>CALL    12213>>ASSIGN
XSD_CONTEXTX
     10431**DCL     12209<>CALL    12216<>CALL
XSD_CONTEXTXS
     10430**DCL     10431--REDEF   12031>>IF      12032<>CALL
XSD_DIBBUF
     11197**DCL     12057--ASSIGN  12077<>CALL    12077--CALL    12078--ASSIGN  12078--ASSIGN  12079<>CALL
     12079--CALL    12080--ASSIGN  12080--ASSIGN  12081<>CALL    12081--CALL    12082--ASSIGN  12082--ASSIGN
     12083<>CALL    12083--CALL    12084--ASSIGN  12084--ASSIGN  12154<>CALL    12154--CALL    12155--ASSIGN
     12155--ASSIGN  12156<>CALL    12156--CALL    12157--ASSIGN  12157--ASSIGN  12158<>CALL    12158--CALL
     12159--ASSIGN  12159--ASSIGN  12160<>CALL    12160--CALL    12161--ASSIGN  12161--ASSIGN
XSD_DIBBUF.KEY.COMMONNAME
     11224**DCL     12076--ASSIGN  12076--ASSIGN  12153--ASSIGN  12153--ASSIGN
XSD_DIBKEY
     10489**DCL      9606--DCLINIT  9607--DCLINIT  9641--DCLINIT  9642--DCLINIT
XSD_DIBKEY.DIBUNIQUE
     10507**DCL     12041<<ASSIGN  12043<<CALLBLT 12051<<ASSIGN  12053<<ASSIGN  12060--ASSIGN  12136<<ASSIGN
     12137<<ASSIGN
XSD_DIBKEY.OBJECTCLASS
     10493**DCL     12090<<ASSIGN  12091--ASSIGN
XSD_DIRECTORYACCESSAC
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:93   
     10448**DCL     11614--DCLINIT
XSD_DS_OPENDIB
     10429**DCL     11969>>IF      11993<<ASSIGN  12025<>CALL    12058>>ASSIGN
XSD_PCDL_DUA
     10472**DCL     11624--DCLINIT
XSF$LOCCODP
      9360**DCL-ENT 11975--CALL    11979--CALL    11983--CALL
XSP@ASN1_FPT
     11944**DCL     12191<<ASSIGN  12195--ASSIGN
XSP@ASN1_FPT.BUF$
     11948**DCL     12196<<ASSIGN
XSP@ASN1_FPT.C0
     11950**DCL     11950--REDEF
XSP@ASN1_FPT.CTXTID
     11949**DCL     12198<<ASSIGN
XSP@ASN1_FPT.DAT$
     11952**DCL     11952--REDEF
XSP@ASN1_FPT.N0
     11951**DCL     11951--REDEF
XSP@ASN1_FPT.NXTX
     11951**DCL     12197<<ASSIGN
XSP@ASN1_FPT.R0
     11949**DCL     11950--REDEF
XSS$BUFPTR
      9368**DCL-ENT 12209--CALL    12216--CALL    12256--CALL    12273--CALL
XSS$GETMEM
      9367**DCL-ENT 12025--CALL    12032--CALL    12068--CALL    12146--CALL    12170--CALL    12222--CALL
XSS$RELMEM
      9369**DCL-ENT 12164--CALL    12290--CALL    12294--CALL    12297--CALL    12300--CALL
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:94   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:95   
              MINI UREF LISTING

B$JIT$    9380**DCL
B$ROSEG$    9382**DCL
CCB$   11932**DCL
CCBXS   11931**DCL
CODE19    9846**DCL
CODE20    9849**DCL
CONTEXTXS   11928**DCL
FM$FIELD_START    9466**DCL
M$ACCT    5520**DCL-ENT
M$ACTIVATE    5523**DCL-ENT
M$ALIB    5516**DCL-ENT
M$ASUSER    5518**DCL-ENT
M$ATTACH    5525**DCL-ENT
M$BADPP    5543**DCL-ENT
M$CGCTL    5524**DCL-ENT
M$CGINFO    5524**DCL-ENT
M$CHECK    5505**DCL-ENT
M$CHGUNIT    5563**DCL-ENT
M$CLOSE    5503**DCL-ENT
M$CLRSTK    5561**DCL-ENT
M$CMDVAR    5572**DCL-ENT
M$CONFIG    5533**DCL-ENT
M$CORRES    5508**DCL-ENT
M$CPEXIT    5517**DCL-ENT
M$CVM    5541**DCL-ENT
M$CVOL    5506**DCL-ENT
M$DCLFLD    5533**DCL-ENT
M$DEACTIVATE    5523**DCL-ENT
M$DELREC    5505**DCL-ENT
M$DEQ    5570**DCL-ENT
M$DETACH    5525**DCL-ENT
M$DEVICE    5507**DCL-ENT
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:96   
M$DISPLAY    5570**DCL-ENT
M$DISPRES    5510**DCL-ENT
M$DLIB    5516**DCL-ENT
M$DRIBBLE    5533**DCL-ENT
M$DRTN    5561**DCL-ENT
M$DSA   10426**DCL
M$DSUSER    5518**DCL-ENT
M$ENQ    5569**DCL-ENT
M$EOM    5528**DCL-ENT
M$ERASE    5534**DCL-ENT
M$ERR    5515**DCL-ENT
M$ERRMSG    5566**DCL-ENT
M$EVENT    5558**DCL-ENT
M$EXHUME    5567**DCL-ENT
M$EXIT    5515**DCL-ENT
M$EXTEND    5507**DCL-ENT
M$FDP    5539**DCL-ENT
M$FDS    5538**DCL-ENT
M$FEBOOT    5531**DCL-ENT
M$FECTL    5532**DCL-ENT
M$FEDUMP    5531**DCL-ENT
M$FID    5566**DCL-ENT
M$FINDPROC    5520**DCL-ENT
M$FSUSER    5518**DCL-ENT
M$FVP    5540**DCL-ENT
M$FWCG    5524**DCL-ENT
M$GBPL    5544**DCL-ENT
M$GDDL    5540**DCL-ENT
M$GDP    5539**DCL-ENT
M$GDS    5538**DCL-ENT
M$GETDCB    5509**DCL-ENT
M$GETMOUSE    5549**DCL-ENT
M$GETPM    5550**DCL-ENT
M$GJOB    5568**DCL-ENT
M$GLINEATTR    5528**DCL-ENT
M$GOODPP    5543**DCL-ENT
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:97   
M$GPLATEN    5536**DCL-ENT
M$GPROMPT    5535**DCL-ENT
M$GTRMATTR    5529**DCL-ENT
M$GTRMCTL    5527**DCL-ENT
M$GTRMTAB    5530**DCL-ENT
M$GVP    5539**DCL-ENT
M$HELP    5566**DCL-ENT
M$INT    5558**DCL-ENT
M$INTRTN    5519**DCL-ENT
M$IOQ    5554**DCL-ENT
M$JOBSTATS    5568**DCL-ENT
M$KEYIN    5508**DCL-ENT
M$LDEV    5503**DCL-ENT
M$LDTRC    5516**DCL-ENT
M$LIMIT    5509**DCL-ENT
M$LINES    5508**DCL-ENT
M$LINK    5515**DCL-ENT
M$MADMUCK    5511**DCL-ENT
M$MAKUSER    5542**DCL-ENT
M$MBS    5510**DCL-ENT
M$MDFFLD    5534**DCL-ENT
M$MERC    5559**DCL-ENT
M$MERCS    5560**DCL-ENT
M$MIRROR    5554**DCL-ENT
M$MPL    5544**DCL-ENT
M$NODEINFO    5535**DCL-ENT
M$NXTUSR    5569**DCL-ENT
M$OCMSG    5567**DCL-ENT
M$OLAY    5515**DCL-ENT
M$PAS    5544**DCL-ENT
M$PATHCON    5567**DCL-ENT
M$PDS    5538**DCL-ENT
M$PFIL    5505**DCL-ENT
M$PLATEN    5529**DCL-ENT
M$PROCNAME    5520**DCL-ENT
M$PROFILE    5531**DCL-ENT
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:98   
M$PROMPT    5527**DCL-ENT
M$RACST    5511**DCL-ENT
M$RDSYSLOG    5552**DCL-ENT
M$RELDCB    5509**DCL-ENT
M$RELRES    5510**DCL-ENT
M$RELSTARF    5512**DCL-ENT
M$REM    5512**DCL-ENT
M$RENV    5559**DCL-ENT
M$REQUIRE    5511**DCL-ENT
M$RETRY    5560**DCL-ENT
M$RETRYS    5560**DCL-ENT
M$REW    5506**DCL-ENT
M$RLSFLD    5534**DCL-ENT
M$RPRIV    5562**DCL-ENT
M$RSPP    5541**DCL-ENT
M$RSWITCH    5563**DCL-ENT
M$RUE    5569**DCL-ENT
M$SAD    5542**DCL-ENT
M$SAVE    5518**DCL-ENT
M$SCON    5519**DCL-ENT
M$SCREECH    5517**DCL-ENT
M$SENV    5559**DCL-ENT
M$SETFMA    5503**DCL-ENT
M$SETFP    5532**DCL-ENT
M$SINPUT    5530**DCL-ENT
M$SLCFLD    5535**DCL-ENT
M$SMOUSE    5549**DCL-ENT
M$SMPRT    5541**DCL-ENT
M$SPRIV    5562**DCL-ENT
M$SSC    5542**DCL-ENT
M$SSWITCH    5562**DCL-ENT
M$STATE    5571**DCL-ENT
M$STD    5543**DCL-ENT
M$STIMER    5557**DCL-ENT
M$STLPP    5540**DCL-ENT
M$STRAP    5557**DCL-ENT
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:99   
M$STRMATTR    5529**DCL-ENT
M$STRMCTL    5527**DCL-ENT
M$STRMTAB    5530**DCL-ENT
M$SYMBIO    5568**DCL-ENT
M$SYSCON    5554**DCL-ENT
M$SYSID    5572**DCL-ENT
M$TDCLOSE    5553**DCL-ENT
M$TDIO    5553**DCL-ENT
M$TDOPEN    5552**DCL-ENT
M$TDREQCPU    5553**DCL-ENT
M$TEMPWROC    5547**DCL-ENT
M$TIME    5570**DCL-ENT
M$TRAP    5557**DCL-ENT
M$TRMISC    5532**DCL-ENT
M$TRMPRG    5528**DCL-ENT
M$TRTN    5561**DCL-ENT
M$TRUNC    5504**DCL-ENT
M$TTIMER    5557**DCL-ENT
M$UC    5527**DCL
M$UMPL    5544**DCL-ENT
M$UNFID    5566**DCL-ENT
M$UNLATCH    5523**DCL-ENT
M$UNSHARE    5520**DCL-ENT
M$USRFIELD    5563**DCL-ENT
M$VIRTUAL    5538**DCL-ENT
M$WAIT    5561**DCL-ENT
M$WEOF    5506**DCL-ENT
M$WRITE    5504**DCL-ENT
M$WRSYSLOG    5552**DCL-ENT
M$XCON    5558**DCL-ENT
M$XCONRTN    5519**DCL-ENT
M$XEQTIME    5571**DCL-ENT
M$XFLUSH    5512**DCL-ENT
M$XMOUSE    5549**DCL-ENT
M$XXX    5515**DCL-ENT
M$YC    5517**DCL-ENT
PL6.E3A0      #001=XSD$DIRECTORY File=XSD$DIRECTORY.:XSA1TSI                     WED 10/01/97 11:55 Page:100  
XSC$COMMTERM    9373**DCL-ENT
XSD$DIRECTORY      13**PROC
XSD$DSDATA    9375**DCL-ENT
XSD$TABLE    9376**DCL-ENT
XSD$UNBIND    9365**DCL-ENT
