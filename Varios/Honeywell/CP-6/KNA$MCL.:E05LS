VERSION E05

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:1    
        1        1        /*M* KNA$MCL Handler for the KI Monitor Services                      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0,ENU=0,ECU=0 */
        8        8        /*P*       NAME:     KNA$MCL
        9        9                   PURPOSE:  This routine acts as the main handler for all
       10       10                             the KI MCLs.
       11       11                   DESCRIPTION:  This module contains the routines to convert
       12       12                                 the data contained in the following MCLs
       13       13                                 into Virtual Device Operator format and also
       14       14                                 to call VDH to process the created VDOs.
       15       15
       16       16                                            M$STRMCTL
       17       17                                            M$GTRMCTL
       18       18                                            M$PROMPT
       19       19                                            M$EOM
       20       20                                            M$TRMPRG
       21       21                                            M$GLINEATTR
       22       22                                            M$STRMATTR
       23       23                                            M$GTRMATTR
       24       24                                            M$PLATEN
       25       25                                            M$STRMTAB
       26       26                                            M$GTRMTAB
       27       27                                            M$SINPUT
       28       28                                            M$PROFILE
       29       29                                            M$TRMISC
       30       30                                            M$DCLFLD
       31       31                                            M$MDFFLD
       32       32                                            M$SLCFLD
       33       33                                            M$RLSFLD
       34       34                                            M$ERASE
       35       35                                                                                      */
       36       36              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:2    
       37       37        /*F*         NAME:    KNA$MCL
       38       38                     PURPOSE: To field all MCLs in the KI code group.
       39       39                     DESCRIPTION:  This routine does error checking, then
       40       40                                   reports an errors.  If there are no
       41       41                                   errors, it builds the necessary VDOs,
       42       42                                   sends them and returns.
       43       43                     CALL:    CALL KNA$MCL(GUD_HAND_PARAMS)
       44       44                     INPUTS:  GUD_HAND_PARAMS
       45       45                                                                                      */
       46       46
       47       47        KNA$MCL: PROC(KID_PARAMS);
       48       48
       49       49        %INCLUDE G_ROS_M;
       50      131        %INCLUDE KI$CP6V_C;
       51      570        %INCLUDE LCP_6;
       52     4849        %INCLUDE GU_MACROS_M;
       53     5008        %INCLUDE B_ERRORS_C;
       54     6135        %INCLUDE KI_MACROS_C;
       55     6743        %INCLUDE NK_VFC_C;
       56     6817        %INCLUDE KV$VDO;
       57     7832        %INCLUDE KV$GLB;
       58     8251        %INCLUDE KV_PRMID_E;
       59     8425        %INCLUDE KV$PRM;
       60     8638        %INCLUDE KL_MACRO_C;
       61    11990        %INCLUDE KL_AFCN_C;
       62    12091        %INCLUDE GH_GATE_M;
       63    12132        %INCLUDE G_JIT_M;
       64    12397        %INCLUDE GH_SCHD_E;
       65    12493        %INCLUDE K$RWPARM;
       66    12879        %INCLUDE KN_DATA_M;
       67    14665        %INCLUDE KNA_MACRO_M;
       68    14741                                                /* EQUATES                            */
       69    14742        %KV_VDO_ALL_E;
       70    14821        %KV_PRMID_E;
       71    14977
       72    14978                                                /* Params                             */
       73    14979        %GUD_HAND_PARAMS(FPTN=KID_PARAMS);
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:3    
       74    15055
       75    15056                                                /* SYMREFS                            */
       76    15057    1   DCL G$JIT$ PTR SYMREF;
       77    15058    1   DCL G$ROS$ PTR SYMREF;
       78    15059        %K$RWPARM (NAME=KNA_RWPARM_CON,STCLASS=SYMREF);
       79    15375        %GATE (FPTN=KNA_LNKSSN,STCLASS=SYMREF);
       80    15394                                                /* ENTRYS                             */
       81    15395    1   DCL GFS$GSP ENTRY(3) ALTRET;
       82    15396    1   DCL KNA$CHECK_VDO ENTRY(2) ALTRET;
       83    15397    1   DCL KNA$CONV_STR ENTRY(2) ALTRET;
       84    15398    1   DCL KNA$FCNOU ENTRY(4) ALTRET;
       85    15399    1   DCL KNA$GETIOP ENTRY(1) ALTRET;
       86    15400    1   DCL KNA$RLSIOP ENTRY(1) ALTRET;
       87    15401    1   DCL KNA$REG_USER ENTRY(2) ALTRET;
       88    15402    1   DCL KNB$GETRESP ENTRY(4) ALTRET;
       89    15403    1   DCL KNA$SAVEMAP ENTRY(2);
       90    15404    1   DCL GHS$REG ENTRY(2) ALTRET;
       91    15405                                                /* BASED                              */
       92    15406        %NK$VFC (STCLASS=BASED);
       93    15424        %KNA$SSN  (STCLASS="BASED(SSN$)");
       94    15507        %G$JIT(STCLASS="BASED(G$JIT$)");
       95    15921        %G$DCBTABLE;
       96    15932        %G$ROS(STCLASS="BASED(G$ROS$)");
       97    15976        %M$DCB(DCBN=MYDCB,STCLASS="BASED(DCB$)");
       98    16027        %FPT$TRMCTL_V(BASED="BASED(V$)");
       99    16038        %VLP$TRMCTL_V(BASED="BASED(VLP$)");
      100    16059        %FPT$PROMPT_V(BASED="BASED(V$)");
      101    16071        %FPT$EOM_V(BASED="BASED(V$)");
      102    16084        %VLP$EOMTABLE_V(BASED="BASED(VLP$)");
      103    16098        %FPT$TRMPRG_V(BASED="BASED(V$)");
      104    16110        %FPT$GLINEATTR_V(BASED="BASED(V$)");
      105    16121        %VLP$LINEATTR_V(BASED="BASED(VLP$)");
      106    16134        %FPT$TRMATTR_V(BASED="BASED(V$)");
      107    16145        %VLP$TRMATTR_V(BASED="BASED(VLP$)");
      108    16167        %FPT$PLATEN_V(BASED="BASED(V$)");
      109    16178        %VLP$PLATEN_V(BASED="BASED(VLP$)");
      110    16194        %VLP_TAB (FPTN=VLP$TAB,STCLASS=BASED);
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:4    
      111    16208        %VLP_HDR (FPTN=VLP$HDR,STCLASS=BASED,LEN=160);
      112    16224        %VLP$WINDOW_V;
      113    16246        %FPT$TRMTAB_V(BASED="BASED(V$)");
      114    16257        %FPT$SINPUT_V(BASED="BASED(V$)");
      115    16273        %FPT$DCLFLD_V(BASED="BASED(V$)");
      116    16293        %FPT$MDFFLD_V(BASED="BASED(V$)");
      117    16309        %FPT$SLCFLD_V(BASED="BASED(V$)");
      118    16325        %FPT$RLSFLD_V(BASED="BASED(V$)");
      119    16341        %FPT$ERASE_V(BASED="BASED(V$)");
      120    16357        %FPT$GCHAN_V(BASED="BASED(V$)");
      121    16368        %FPT$RCHAN_V(BASED="BASED(V$)");
      122    16378        %FPT_DEVICE (FPTN=FPT$DEVICE,VECTORS=NO,STCLASS="BASED(V$)");
      123    16405
      124    16406        %KN$IOP (STCLASS="BASED(IOP$)");
      125    16579    1   DCL NULLHDR(0:1) UBIN BYTE UNAL CONSTANT INIT(%KV_PRMID_SSNHDR,0);
      126    16580        %VLR_GCHAN(FPTN=VLR$GCHAN,STCLASS="BASED(GCHAN$)");
      127    16599                                                /* LOCAL                              */
      128    16600    1   DCL DCB$ PTR;
      129    16601    1   DCL V$ PTR;
      130    16602    1   DCL VLP$ CPTR;
      131    16603    1   DCL SSN$ PTR;
      132    16604    1   DCL IOP$ PTR;
      133    16605    1   DCL GCHAN$ PTR;
      134    16606        %VLP_WINDOW (FPTN=WINDOW,STCLASS=AUTO);
      135    16650        %K$RWPARM (NAME=K$RWPARM,STCLASS=AUTO);
      136    16966    1   DCL 1 PRM,
      137    16967    1            2 TL UNAL,
      138    16968    1                 3 TYPE UBIN BYTE UNAL,
      139    16969    1                 3 LEN UBIN BYTE UNAL;
      140    16970        %KV$PRM_EOM(NAME=EOM, STCLASS="BASED(K$RWPARM.V$),2 * UBIN");
      141    16987        %KV$PRM_SINPUT(NAME=SINPUT, STCLASS="BASED(K$RWPARM.V$),2 BIGTL UBIN");
      142    17008    1   DCL 1 PROMPT,
      143    17009    1            2 TL,
      144    17010    1                 3 TYPE UBIN BYTE UNAL,
      145    17011    1                 3 LEN UBIN BYTE UNAL,
      146    17012    1            2 PFB UBIN BYTE UNAL,
      147    17013    1            2 DVBYTE BIT(8) UNAL,
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:5    
      148    17014    1            2 VFC CHAR(1) UNAL;
      149    17015    1   DCL B$MSG CHAR(K$RWPARM.MSGSZ) BASED;
      150    17016        %KI_VCHRPMT (NAME=B$PROMPT,STCLASS=BASED);
      151    17024    1   DCL B$CHAR CHAR(1) BASED;
      152    17025    1   DCL DCBNUMBER UBIN;
      153    17026    1   DCL VDOTYP UBIN;
      154    17027                                                /* START ACQUIRE MESSAGE              */
      155    17028    1   DCL 1 KNA_GCHAN AUTO,
      156    17029        %KL_ACQUIRE(LVL=2,STCLASS=AUTO);
      157    17111                                                /* END ACQUIRE MESSAGE                */
      158    17112                                                /* START RELEASE MESSAGE              */
      159    17113    1   DCL 1 KNA_RCHAN AUTO,
      160    17114        %KL_RELEASE(LVL=2,STCLASS=AUTO);
      161    17169                                                /* END RELEASE MESSAGE                */
      162    17170                                                /* ERRCODES                           */
      163    17171        %VLP_ERRCODE(FPTN=E$BAD_FPT_CODE,ERR#=%E$BADCODE,SEV=%G_SEV_ABORT#,
      164    17172                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      165    17218        %VLP_ERRCODE(FPTN=E$INVALID_DCB,ERR#=%E$BADDCB#,SEV=%G_SEV_ABORT#,
      166    17219                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      167    17265        %VLP_ERRCODE(FPTN=E$NOT_OPEN,ERR#=%E$NOTOPEN,SEV=%G_SEV_ABORT#,
      168    17266                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      169    17312        %VLP_ERRCODE(FPTN=ENO_IOP,ERR#=%E$NO_IOP,SEV=%G_SEV_ERROR#,
      170    17313                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      171    17359        %VLP_ERRCODE(FPTN=ERROR_TND,ERR#=%E$NO_TD_PRIV,SEV=%G_SEV_ERROR#,
      172    17360                       STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      173    17406        %VLP_ERRCODE(FPTN=E$NOT_FORM,ERR#=%E$ILGLNOTFORM,SEV=%G_SEV_ERROR#,
      174    17407                       STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      175    17453        %VLP_ERRCODE(FPTN=E$NOT_TS,ERR#=%E$NOTTS,SEV=%G_SEV_CONT#,
      176    17454                       STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      177    17500                                                /* VDOs                               */
      178    17501              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:6    
      179    17502        /*
      180    17503          Setup a few pointers used everywhere and verify that the DCB# is
      181    17504          valid and its open.
      182    17505                                                                                      */
      183    17506    1        V$ = KID_PARAMS.PTRS.PAR1$;
      184    17507    1        IF KID_PARAMS.MCL.CODE ~= %G_MCL_GCHAN#
      185    17508    1             AND KID_PARAMS.MCL.CODE ~= %G_MCL_RCHAN#
      186    17509    2        THEN DO;
      187    17510    2             DCBNUMBER = FPT$TRMCTL_V.DCB#;
      188    17511    2             IF DCBNUMBER = 0 OR DCBNUMBER > G$ROS$ -> G$ROS.NUMDCBS THEN
      189    17512    3             DO;
      190    17513
      191    17514        /*E*  ERROR:KNA-%E$BADDCB#
      192    17515              DESCRIPTION: A system known DCB must be passed.
      193    17516        */
      194    17517
      195    17518    3                  KID_PARAMS.ERR=E$INVALID_DCB;
      196    17519    3                  RETURN;
      197    17520    3                  END;
      198    17521
      199    17522    2             DCB$ = G$ROS.DCBPTR$ -> G$DCBTABLE(DCBNUMBER);
      200    17523
      201    17524    2             IF NOT(MYDCB.FCD) THEN
      202    17525    3             DO;
      203    17526
      204    17527        /*E*   ERROR:KNA-%E$NOTOPEN
      205    17528               MESSAGE:  The DCB you have chosen must already be open
      206    17529                                                                                      */
      207    17530    3                  KID_PARAMS.ERR=E$NOT_OPEN;
      208    17531    3                  RETURN;
      209    17532    3                  END;
      210    17533
      211    17534    2             IF KID_PARAMS.MCL.CODE ~= %G_MCL_WRTMLT# AND
      212    17535    2                  MYDCB.DDEV.RES ~= %G_DDEV_RES_UC#
      213    17536    2             THEN
      214    17537    3             DO ;
      215    17538
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:7    
      216    17539        /*E*  ERROR:         KNA-E$NOTTS-C
      217    17540               MESSAGE: That's not a terminal DCB!
      218    17541              MESSAGE1: The terminal control service requests are only legal
      219    17542                        if the DCB is open to a terminal (RES=UCnn). */
      220    17543
      221    17544    3                  KID_PARAMS.ERR=E$NOT_TS ;
      222    17545    3                  RETURN ;
      223    17546    3                  END ;                    /* Then Do */
      224    17547    2             SSN$ = MYDCB.SSN$;
      225    17548    2             K$RWPARM = KNA_RWPARM_CON;
      226    17549    2             K$RWPARM.KEYTYPE = MYDCB.KEYTYPE;
      227    17550    2             K$RWPARM.V$ = V$;
      228    17551    2             K$RWPARM.STR = MYDCB.STRM;
      229    17552    2             IF KID_PARAMS.MCL.CODE = %G_MCL_TRMPRG# THEN EXIT;
      230    17553    2             K$RWPARM.MSGC$ = KID_PARAMS.CPTRS.PAR2$;
      231    17554    2             IF K$RWPARM.MSG$ ~= ADDR(NIL)
      232    17555    2             THEN
      233    17556    2                  K$RWPARM.MSGSZ = KID_PARAMS.BND.PAR2+1;
      234    17557    2             END;
      235    17558        /* Lock gate.  This gate is not unlocked to end of routine except for
      236    17559        GCHAN and RCHAN. */
      237    17560             %LOCK (G=KNA_LNKSSN);
      238    17567        /*
      239    17568             Now call routines to handle the different MCLs
      240    17569        */
      241    17570    2        DO CASE (KID_PARAMS.MCL.CODE);
      242    17571
      243    17572        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:8    
      244    17573        /*
      245    17574                              M$DCLFLD
      246    17575                                                                                      */
      247    17576    2        CASE(%G_MCL_DCLFLD#);
      248    17577
      249    17578    2           K$RWPARM.IP$ = KID_PARAMS.PTRS.PAR3$;
      250    17579    2           K$RWPARM.DVE.DVBYTE = FPT$DCLFLD_V.DVBYTE;
      251    17580    2           VDOTYP = %KV_VDO_FNC_DCLFLD;
      252    17581    2   FORM_VDO:;
      253    17582    2           IF MYDCB.ORG~=%G_ORG_FORM#
      254    17583    3           THEN DO;
      255    17584    3                KID_PARAMS.ERR = E$NOT_FORM;
      256    17585    3                GOTO DONE;
      257    17586    3                END;
      258    17587    2           IF K$RWPARM.DVE.DVBYTE.RRR
      259    17588    2           THEN
      260    17589    2                K$RWPARM.MRKTYP = %KV_VDOMRKTYP_ENDACK;
      261    17590    2           CALL CALL_FCNOU ALTRET (DONE);
      262    17591    2   WAIT_RRR: ;
      263    17592    2           IF K$RWPARM.DVE.DVBYTE.RRR
      264    17593    3           THEN DO;
      265    17594    3                CALL KNA$GETIOP(IOP$)
      266    17595    4                WHENALTRETURN DO;
      267    17596    4                     KID_PARAMS.ERR = ENO_IOP;
      268    17597    4                     GOTO DONE;
      269    17598    4                     END;
      270    17599    3                KNA$SSN.IOPQ$ = IOP$;
      271    17600    3                KNA$SSN.FLAGS.RRRPND = '1'B;
      272    17601    3                CALL KNA$REG_USER(%GH_EVCW,SSN$);
      273    17602    3                KID_PARAMS.ERR = KN$IOP.ERRCODE;
      274    17603    3                MYDCB.FLDID = KN$IOP.FLDID;
      275    17604    3                KNA$SSN.IOPQ$ = ADDR(NIL);
      276    17605    3                CALL KNA$RLSIOP (IOP$);
      277    17606    3                END;
      278    17607              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:9    
      279    17608    2        CASE (%G_MCL_MDFFLD#);
      280    17609        /*
      281    17610                           M$MDFFLD
      282    17611                                                                                      */
      283    17612    2           IF FPT$MDFFLD_V.KEYTYPE ~= 0
      284    17613    2           THEN
      285    17614    2                K$RWPARM.KEYTYPE = FPT$MDFFLD_V.KEYTYPE;
      286    17615    2           K$RWPARM.DVE.DVBYTE = FPT$MDFFLD_V.DVBYTE;
      287    17616    2           VDOTYP = %KV_VDO_FNC_SLCGRPRND;
      288    17617    2           K$RWPARM.KEY$ = KID_PARAMS.PTRS.PAR3$;
      289    17618    2           K$RWPARM.KEYSZ = KID_PARAMS.BND.PAR3+1;
      290    17619    2           K$RWPARM.IP$ = KID_PARAMS.PTRS.PAR4$;
      291    17620
      292    17621    2           IF FPT$MDFFLD_V.SETGRPRND
      293    17622    2                AND FPT$MDFFLD_V.SETQLF AND MYDCB.ORG=%G_ORG_FORM#
      294    17623    3           THEN DO;
      295    17624    3                CALL CALL_FCNOU ALTRET(DONE);
      296    17625    3                VDOTYP = %KV_VDO_FNC_SLCQLF;
      297    17626    3                K$RWPARM.MSGSZ = 0;        /* Only send the data once */
      298    17627    3                END;
      299    17628    2           ELSE IF FPT$MDFFLD_V.SETQLF
      300    17629    2                THEN VDOTYP = %KV_VDO_FNC_SLCQLF;
      301    17630    2                ELSE IF K$RWPARM.MSGSZ~=0
      302    17631    2                     THEN VDOTYP = %KV_VDO_FNC_DAT;
      303    17632    2                     ELSE GOTO DONE;       /* Nothing to do */
      304    17633    2           GOTO FORM_VDO;
      305    17634
      306    17635              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:10   
      307    17636        /*
      308    17637                                M$SLCFLD
      309    17638                                                                                      */
      310    17639    2        CASE(%G_MCL_SLCFLD#);
      311    17640    2           VDOTYP = %KV_VDO_FNC_SLCFLD;
      312    17641    2           GOTO FORM_COMMON;
      313    17642              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:11   
      314    17643        /*
      315    17644                                M$RLSFLD
      316    17645                                                                                      */
      317    17646    2        CASE(%G_MCL_RLSFLD#);
      318    17647    2           VDOTYP = %KV_VDO_FNC_RLSFLD;
      319    17648    2           GOTO FORM_COMMON;
      320    17649              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:12   
      321    17650        /*
      322    17651                                M$ERASE
      323    17652                                                                                      */
      324    17653    2        CASE(%G_MCL_ERASE#);
      325    17654    2           VDOTYP = %KV_VDO_FNC_ERS;
      326    17655    2   FORM_COMMON:;
      327    17656    2           IF FPT$ERASE_V.KEYTYPE ~= 0
      328    17657    2           THEN
      329    17658    2                K$RWPARM.KEYTYPE = FPT$ERASE_V.KEYTYPE;
      330    17659    2           K$RWPARM.DVE.DVBYTE = FPT$ERASE_V.DVBYTE;
      331    17660    2           K$RWPARM.KEY$ = K$RWPARM.MSG$;
      332    17661    2           K$RWPARM.KEYSZ = K$RWPARM.MSGSZ;
      333    17662    2           K$RWPARM.MSG$ = ADDR(NIL);
      334    17663    2           K$RWPARM.MSGSZ = 0;
      335    17664    2           GOTO FORM_VDO;
      336    17665              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:13   
      337    17666        /*
      338    17667                               M$STRMCTL
      339    17668                                                                                      */
      340    17669    2        CASE(%G_MCL_STRMCTL#);
      341    17670
      342    17671    2           IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_TRMCTL#
      343    17672    3           THEN DO;
      344    17673    3                PRM.TL.TYPE=%KV_PRMID_TRMCTL;
      345    17674    3                END;
      346    17675    2           ELSE IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_WINDOW#
      347    17676    3                THEN DO;
      348    17677    3                     PRM.TL.TYPE=%KV_PRMID_WINDOW;
      349    17678    3                     ADDR(WINDOW)->B$MSG = K$RWPARM.MSG$->B$MSG;
      350    17679    3                     CALL KNA$CONV_STR(WINDOW,KID_PARAMS.ERR) ALTRET(DONE);
      351    17680    3                     K$RWPARM.MSG$ = ADDR(WINDOW);
      352    17681    3                     END;
      353    17682    2           CALL SET_PARAM;
      354    17683              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:14   
      355    17684        /*
      356    17685                              M$PROMPT
      357    17686                                                                                      */
      358    17687    2        CASE(%G_MCL_PROMPT#);
      359    17688
      360    17689    2           PROMPT.TL.TYPE=%KV_PRMID_PROMPT;
      361    17690    2           PROMPT.VFC = %VFC_EXT;
      362    17691    2           PROMPT.PFB = K$RWPARM.STR;
      363    17692    2           PROMPT.DVBYTE = FPT$PROMPT_V.DVBYTE;
      364    17693    2           K$RWPARM.V$ = ADDR(PROMPT);
      365    17694    2           K$RWPARM.VSZ = LENGTHC(PROMPT);
      366    17695    2           IF K$RWPARM.MSG$ = ADDR(NIL)
      367    17696    2                OR FPT$PROMPT_V.DVBYTE.VFC AND K$RWPARM.MSG$ ~= ADDR(NIL)
      368    17697    2           THEN
      369    17698    2                K$RWPARM.VSZ = K$RWPARM.VSZ - 1;
      370    17699    2           PROMPT.TL.LEN=K$RWPARM.MSGSZ + K$RWPARM.VSZ - 2;
      371    17700    2           CALL SET_PARAM1;
      372    17701              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:15   
      373    17702        /*
      374    17703                              M$EOM
      375    17704                                                                                      */
      376    17705    2        CASE(%G_MCL_EOM#);
      377    17706
      378    17707    2           PRM.TL.TYPE=%KV_PRMID_EOM;
      379    17708    2           K$RWPARM.V$=ADDR(PRM);
      380    17709    2           K$RWPARM.VSZ = LENGTHC(EOM) - LENGTHC(EOM.TABLE);
      381    17710    2           EOM.DMN = K$RWPARM.STR;
      382    17711    2           EOM.SUPPHALT=FPT$EOM_V.SUPPHALT;
      383    17712    2           EOM.UTYPE=FPT$EOM_V.UTYPE;
      384    17713    2           EOM.TIMEOUT=FPT$EOM_V.TIMEOUT;
      385    17714    2           PRM.TL.LEN = K$RWPARM.MSGSZ+K$RWPARM.VSZ-2;
      386    17715    2           CALL SET_PARAM1;
      387    17716              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:16   
      388    17717        /*
      389    17718                            M$TRMPRG
      390    17719                                                                                      */
      391    17720    2        CASE(%G_MCL_TRMPRG#);
      392    17721
      393    17722    2           VDOTYP = %KV_VDO_FNC_DLT;
      394    17723    2           CALL CALL_FCNOU;
      395    17724        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:17   
      396    17725        /*
      397    17726                               M$STRMATTR
      398    17727                                                                                      */
      399    17728    2        CASE(%G_MCL_STRMATTR#);
      400    17729
      401    17730    2           PRM.TL.TYPE=%KV_PRMID_TRMATTR;
      402    17731    2           CALL SET_PARAM;
      403    17732              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:18   
      404    17733        /*
      405    17734                               M$PLATEN
      406    17735                                                                                      */
      407    17736    2        CASE(%G_MCL_PLATEN#);
      408    17737
      409    17738    2           PRM.TL.TYPE=%KV_PRMID_PLATEN;
      410    17739    2           CALL SET_PARAM;
      411    17740              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:19   
      412    17741        /*
      413    17742                               M$STRMTAB
      414    17743                                                                                      */
      415    17744    2        CASE(%G_MCL_STRMTAB#);
      416    17745
      417    17746    2           PRM.TL.TYPE=%KV_PRMID_TRMTAB;
      418    17747    2           CALL SET_PARAM;
      419    17748              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:20   
      420    17749        /*
      421    17750                               M$SINPUT
      422    17751                                                                                      */
      423    17752    2        CASE(%G_MCL_SINPUT#);
      424    17753
      425    17754    2           PROMPT.TL.TYPE=%KV_PRMID_SINPUT;
      426    17755    2           K$RWPARM.V$ = ADDR(PROMPT);
      427    17756    2           K$RWPARM.VSZ = LENGTHC(SINPUT)-LENGTHC(SINPUT.TXT);
      428    17757    2           SINPUT.DMN = K$RWPARM.STR;
      429    17758    2           IF FPT$SINPUT_V.POSITION THEN
      430    17759    3           DO;
      431    17760    3                K$RWPARM.VSZ = K$RWPARM.VSZ-1;
      432    17761    3                END;
      433    17762    3           ELSE DO;
      434    17763    3                SINPUT.POSITION = FPT$SINPUT_V.REREADPOS;
      435    17764    3                END;
      436    17765    2           PROMPT.TL.LEN = K$RWPARM.MSGSZ+K$RWPARM.VSZ-2;
      437    17766    2           IF K$RWPARM.MSGSZ+K$RWPARM.VSZ-2>255
      438    17767    3           THEN DO;
      439    17768    3                SINPUT.BIGTL = K$RWPARM.MSGSZ+K$RWPARM.VSZ-2;
      440    17769    3                PRM.TL.TYPE = %KV_PRMID_BIGTL;
      441    17770    3                PRM.TL.LEN = %KV_PRMID_SINPUT;
      442    17771    3                K$RWPARM.V$ = ADDR(PRM);
      443    17772    3                K$RWPARM.VSZ = K$RWPARM.VSZ+2;
      444    17773    3                END;
      445    17774    2           CALL SET_PARAM1;
      446    17775              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:21   
      447    17776        /*
      448    17777                           M$GTRMCTL
      449    17778                                                                                      */
      450    17779    2        CASE(%G_MCL_GTRMCTL#);
      451    17780
      452    17781    2           IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_TRMCTL#
      453    17782    2           THEN
      454    17783    2                K$RWPARM.PRMID = %KV_PRMID_TRMCTL;
      455    17784    2           ELSE IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_WINDOW#
      456    17785    2                THEN
      457    17786    2                     K$RWPARM.PRMID = %KV_PRMID_WINDOW;
      458    17787    2                ELSE
      459    17788    2                     K$RWPARM.PRMID = %KV_PRMID_EDTCTL;
      460    17789    2           GOTO GET_COMMON;
      461    17790              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:22   
      462    17791        /*
      463    17792                           M$GLINEATTR
      464    17793                                                                                      */
      465    17794    2        CASE(%G_MCL_GLINEATTR#);
      466    17795
      467    17796    2           K$RWPARM.PRMID=%KV_PRMID_LINEATTR;
      468    17797    2           GOTO GET_COMMON;
      469    17798              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:23   
      470    17799        /*
      471    17800                           M$GTRMATTR
      472    17801                                                                                      */
      473    17802    2        CASE(%G_MCL_GTRMATTR#);
      474    17803
      475    17804    2           K$RWPARM.PRMID=%KV_PRMID_TRMATTR;
      476    17805    2           GOTO GET_COMMON;
      477    17806              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:24   
      478    17807        /*
      479    17808                           M$GTRMTAB
      480    17809                                                                                      */
      481    17810    2        CASE(%G_MCL_GTRMTAB#);
      482    17811
      483    17812    2           K$RWPARM.PRMID=%KV_PRMID_TRMTAB;
      484    17813    2           GOTO GET_COMMON;
      485    17814
      486    17815              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:25   
      487    17816        /*
      488    17817                         M$GPLATEN
      489    17818         */
      490    17819    2        CASE (%G_MCL_GPLATEN#);
      491    17820
      492    17821    2           K$RWPARM.PRMID = %KV_PRMID_PLATEN;
      493    17822    2           GOTO GET_COMMON;
      494    17823
      495    17824        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:26   
      496    17825        /*
      497    17826                           M$GPROMPT
      498    17827                                                                                      */
      499    17828    2        CASE(%G_MCL_GPROMPT#);
      500    17829
      501    17830    2           K$RWPARM.PRMID = %KV_PRMID_PROMPT;
      502    17831    2   GET_COMMON: ;
      503    17832    2           K$RWPARM.MSG$ = ADDR(NIL);
      504    17833    2           K$RWPARM.MSGSZ = 0;
      505    17834    2           K$RWPARM.MAXNMBBYT = KID_PARAMS.BND.PAR2+1;
      506    17835    2           CALL KNA$GETIOP(IOP$)
      507    17836    3           WHENALTRETURN DO;
      508    17837    3                KID_PARAMS.ERR = ENO_IOP;
      509    17838    3                GOTO DONE;
      510    17839    3                END;
      511    17840    2           KNA$SSN.IOPQ$ = IOP$;
      512    17841    2           KN$IOP.FLAGS.WAIT = '1'B;
      513    17842    2           KN$IOP.DCB$ = DCB$;
      514    17843    2           CALL KNA$SAVEMAP(DCB$,KN$IOP.DCBSEGDES);
      515    17844    2           VBASE(KN$IOP.BUF_) = KID_PARAMS.PTRS.PAR2$;
      516    17845    2           VBOUND(KN$IOP.BUF_) = KID_PARAMS.BND.PAR2;
      517    17846    2           CALL KNA$SAVEMAP(KID_PARAMS.PTRS.PAR2$,KN$IOP.BUFSEGDES);
      518    17847    2           VDOTYP = %KV_VDO_FNC_RQSPRM;
      519    17848    2           CALL CALL_FCNOU ALTRET(GET_DONE);
      520    17849    2           CALL KNA$REG_USER(%GH_EVCRD,SSN$);
      521    17850    2           KID_PARAMS.ERR = KN$IOP.ERRCODE;
      522    17851    2           IF KID_PARAMS.ERR='0'B AND KID_PARAMS.MCL.CODE=%G_MCL_GPROMPT#
      523    17852    2                AND MYDCB.ARS>2
      524    17853    3           THEN DO;
      525    17854    3                K$RWPARM.MSGSZ = MYDCB.ARS-2;
      526    17855    3                FPT$PROMPT_V.DVBYTE = KID_PARAMS.PTRS.PAR2$->B$PROMPT.DVBYTE;
      527    17856    3                IF NOT FPT$PROMPT_V.DVBYTE.VFC
      528    17857    3                THEN K$RWPARM.MSGSZ = K$RWPARM.MSGSZ-1;
      529    17858    3                KID_PARAMS.PTRS.PAR2$->B$MSG = PINCRC(KID_PARAMS.PTRS.PAR2$,
      530    17859    3                     MYDCB.ARS-K$RWPARM.MSGSZ)->B$MSG;
      531    17860    3                MYDCB.ARS = K$RWPARM.MSGSZ;
      532    17861    3                END;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:27   
      533    17862    2   GET_DONE:;
      534    17863    2           KNA$SSN.IOPQ$ = ADDR(NIL);
      535    17864    2           CALL KNA$RLSIOP(IOP$);
      536    17865              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:28   
      537    17866        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:29   
      538    17867        /*
      539    17868                           M$GCHAN
      540    17869                                                                                      */
      541    17870    2        CASE(%G_MCL_GCHAN#);
      542    17871                %UNLOCK (G=KNA_LNKSSN);
      543    17878    2           IF (NOT G$JIT.PRIV.ACTIVE.TND)
      544    17879    3           THEN DO;
      545    17880    3                KID_PARAMS.ERR = ERROR_TND;
      546    17881                       /*E* ERROR: KNA-E$NO_TD_PRIV-3
      547    17882                            MESSAGE: M$GCHAN requires the TND privilege.
      548    17883                             */
      549    17884    3                RETURN;
      550    17885    3                END;
      551    17886
      552    17887    2           KNA_GCHAN.KL_ACQUIRE.CODE = IGA_LINE_ACQUIRE;
      553    17888    2           GCHAN$=KID_PARAMS.PTRS.PAR2$;
      554    17889    2           KNA_GCHAN.KL_ACQUIRE.CHAN=FPT$GCHAN_V.CHANNEL;
      555    17890    2           KNA_GCHAN.KL_ACQUIRE.RES=FPT$GCHAN_V.RES;
      556    17891    2           KNA_GCHAN.KL_ACQUIRE.ATTR=FPT$GCHAN_V.ATTR;
      557    17892    2           KNA_GCHAN.KL_ACQUIRE.DIAG=FPT$GCHAN_V.FLAGS.DIAG;
      558    17893    2           KNA_GCHAN.KL_ACQUIRE.CONTROLLER=FPT$GCHAN_V.FLAGS.CONTROLLER;
      559    17894    2           KNA_GCHAN.KL_ACQUIRE.HIGHLOW=FPT$GCHAN_V.FLAGS.HIGHLOW;
      560    17895    2           KNA_GCHAN.KL_ACQUIRE.USER#=G$JIT.USR#;
      561    17896    2           CALL KNB$GETRESP (ADDR(KNA_GCHAN),SIZEC(KNA_GCHAN.KL_ACQUIRE),
      562    17897    2                ADDR(KNA_GCHAN),SIZEC(KNA_GCHAN.KL_ACQUIRE));
      563    17898    2           VLR$GCHAN.CHANNEL=KNA_GCHAN.KL_ACQUIRE.CHAN;
      564    17899    2           IF FPT$GCHAN_V.FLAGS.HIGHLOW THEN
      565    17900    3           DO;
      566    17901    3                VLR$GCHAN.HIGHCHAN=KNA_GCHAN.KL_ACQUIRE.HIGHCHAN;
      567    17902    3                VLR$GCHAN.LOWCHAN=KNA_GCHAN.KL_ACQUIRE.LOWCHAN;
      568    17903    3                END;
      569    17904    2           VLR$GCHAN.DVCID=BITBIN(KNA_GCHAN.KL_ACQUIRE.DVCID);
      570    17905    2           VLR$GCHAN.EXTDVCID=BITBIN(KNA_GCHAN.KL_ACQUIRE.EXTDVCID);
      571    17906    2           KID_PARAMS.ERR=KNA_GCHAN.KL_ACQUIRE.ERRCODE;
      572    17907    2           RETURN;
      573    17908              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:30   
      574    17909        /*
      575    17910                           M$RCHAN
      576    17911                                                                                      */
      577    17912    2        CASE(%G_MCL_RCHAN#);
      578    17913
      579    17914                %UNLOCK (G=KNA_LNKSSN);
      580    17921    2           KNA_RCHAN.KL_RELEASE.CODE = IGA_LINE_RELEASE;
      581    17922    2           KNA_RCHAN.KL_RELEASE.CHAN=FPT$RCHAN_V.CHANNEL;
      582    17923    2           KNA_RCHAN.KL_RELEASE.CONTROLLER=FPT$RCHAN_V.CONTROLLER;
      583    17924    2           KNA_RCHAN.KL_RELEASE.USER#=G$JIT.USR#;
      584    17925    2           CALL KNB$GETRESP (ADDR(KNA_RCHAN),SIZEC(KNA_RCHAN.KL_RELEASE),
      585    17926    2                ADDR(KNA_RCHAN),SIZEC(KNA_RCHAN.KL_RELEASE));
      586    17927    2           KID_PARAMS.ERR=KNA_RCHAN.KL_RELEASE.ERRCODE;
      587    17928    2           RETURN;
      588    17929
      589    17930        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:31   
      590    17931    2        CASE(%G_MCL_DEVICE#);
      591    17932    2           K$RWPARM.DVE.DVBYTE = %G_DVBYTE_VFC#|%G_DVBYTE_TRANS#|%G_DVBYTE_BP#;
      592    17933    2           IF K$RWPARM.MSG$~=ADDR(NIL)
      593    17934    3           THEN DO;
      594    17935    3                IF MYDCB.TAB$=ADDR(NIL)
      595    17936    3                THEN CALL GFS$GSP(SIZEW(VLP$TAB),MYDCB.TAB$,KID_PARAMS.ERR)
      596    17937    4                     WHENALTRETURN DO;
      597    17938                               %UNLOCK (G=KNA_LNKSSN);
      598    17945    4                          RETURN;
      599    17946    4                          END;
      600    17947    3                MYDCB.TAB$->VLP$TAB='0'B;
      601    17948    3                IF K$RWPARM.MSGSZ>32 THEN K$RWPARM.MSGSZ =32;
      602    17949    3                MYDCB.TAB$->B$MSG =K$RWPARM.MSG$->B$MSG;
      603    17950    3                END;
      604    17951    2           ELSE
      605    17952    2                IF KID_PARAMS.BND.PAR2 = 1 /* Erase                              */
      606    17953    3                THEN DO;
      607    17954    3                     IF MYDCB.TAB$~=ADDR(NIL) THEN
      608    17955    3                          MYDCB.TAB$->VLP$TAB='0'B;
      609    17956    3                     END;
      610    17957    2           IF MYDCB.TAB$ ~= ADDR(NIL)
      611    17958    3           THEN DO;
      612    17959    3                K$RWPARM.MSG$ = MYDCB.TAB$;
      613    17960    3                K$RWPARM.MSGSZ = SIZEC(VLP$TAB);
      614    17961    3                PRM.TL.TYPE = %KV_PRMID_INPTAB;
      615    17962    3                CALL SET_PARAM;
      616    17963    3                END;
      617    17964
      618    17965        /* Do header */
      619    17966
      620    17967    2           IF KID_PARAMS.PTRS.PAR3$ ~= ADDR(NIL)
      621    17968    3           THEN DO;
      622    17969    3                K$RWPARM.MSGSZ = KID_PARAMS.BND.PAR3+1;
      623    17970    3                IF K$RWPARM.MSGSZ>165 THEN K$RWPARM.MSGSZ =165;
      624    17971    3                PRM.TL.TYPE = %KV_PRMID_SSNHDR;
      625    17972    3                CALL SET_PARAM;
      626    17973    3                END;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:32   
      627    17974    2           ELSE
      628    17975    2                IF KID_PARAMS.BND.PAR3 = 1
      629    17976    3                THEN DO;
      630    17977    3                     K$RWPARM.MSG$=ADDR(NULLHDR);
      631    17978    3                     K$RWPARM.MSGSZ=SIZEC(NULLHDR);
      632    17979    3                     PRM.TL.TYPE = %KV_PRMID_SSNHDR;
      633    17980    3                     CALL SET_PARAM;
      634    17981    3                     END;
      635    17982        /**/
      636    17983    2           IF FPT$DEVICE.V.LINES~=0 THEN
      637    17984    2                MYDCB.LINES= FPT$DEVICE.V.LINES;
      638    17985    3           DO CASE(ADDR(FPT$DEVICE.V.DVFC)->NK$VFC.FCN);
      639    17986    3           CASE(%VFCF_SPB,%VFCF_SPA,%VFCF_SKB,%VFCF_SKA,%VFCF_HDR);
      640    17987    3              MYDCB.DVFC=FPT$DEVICE.V.DVFC;
      641    17988    3           CASE(%VFCF_SPC);
      642    17989    4              DO CASE(ADDR(FPT$DEVICE.V.DVFC)->NK$VFC.COUNT);
      643    17990    4              CASE(%VFCS_TRS0,%VFCS_TRS1);
      644    17991    4                 MYDCB.DVFC=FPT$DEVICE.V.DVFC;
      645    17992    4              CASE(ELSE);                  /* ALL OTHERS NO GOOD; IGNORE         */
      646    17993    4                 END;
      647    17994    3           CASE(ELSE);
      648    17995                                                /* All others illegal; ignore.        */
      649    17996    3              END;
      650    17997
      651    17998        /* Send new page if needed */
      652    17999    2           K$RWPARM.MSG$ = ADDR(NIL);
      653    18000    2           K$RWPARM.MSGSZ = 0;
      654    18001    2           K$RWPARM.DVE.DVBYTE.TRANS = '0'B;
      655    18002    3           IF FPT$DEVICE.V.PAGE THEN DO;
      656    18003    3                K$RWPARM.DVE.DVBYTE.VFC = '1'B;
      657    18004    3                K$RWPARM.DVE.VFC = %VFC_PGND;
      658    18005    3                VDOTYP = %KV_VDO_FNC_DAT;
      659    18006    3                CALL CALL_FCNOU;
      660    18007    3                END;
      661    18008    2           ELSE IF MYDCB.ORG = %G_ORG_FORM#
      662    18009    3                THEN DO;
      663    18010    3                     VDOTYP = %KV_VDO_FNC_UPDRELDVC;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:33   
      664    18011    3                     CALL CALL_FCNOU;
      665    18012    3                     END;
      666    18013    2        CASE(%G_MCL_WRTMLT#);
      667    18014    2           K$RWPARM.UHDR$ = K$RWPARM.MSG$;
      668    18015    2           K$RWPARM.UHDRSZ = K$RWPARM.MSGSZ;
      669    18016    2           K$RWPARM.MSG$ = ADDR(NIL);
      670    18017    2           K$RWPARM.MSGSZ = 0;
      671    18018    2           CALL KNA$CHECK_VDO (K$RWPARM,KID_PARAMS.ERR) ALTRET (DONE);
      672    18019    2           VDOTYP = 0;
      673    18020    2           CALL CALL_FCNOU ALTRET (DONE);
      674    18021    2           K$RWPARM.DVE.DVBYTE.RRR = '1'B;
      675    18022    2           GOTO WAIT_RRR;
      676    18023    2           END;
      677    18024
      678    18025    1   DONE:;
      679    18026             %UNLOCK (G=KNA_LNKSSN);
      680    18033    1        RETURN;
      681    18034        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:34   
      682    18035    1   SET_PARAM: PROC ALTRET;
      683    18036    2        PRM.TL.LEN=K$RWPARM.MSGSZ;
      684    18037    2        K$RWPARM.V$ = ADDR(PRM);
      685    18038    2        K$RWPARM.VSZ = LENGTHC(PRM.TL);
      686    18039    2   SET_PARAM1: ENTRY ALTRET;
      687    18040    2        VDOTYP = %KV_VDO_FNC_PRM_SET;
      688    18041    2   CALL_FCNOU: ENTRY ALTRET;
      689    18042    2        CALL KNA$FCNOU (VDOTYP,KNA$SSN,K$RWPARM,KID_PARAMS.ERR)
      690    18043    3        WHENALTRETURN DO;
      691    18044    3             ALTRETURN;
      692    18045    3             END;
      693    18046    2   END SET_PARAM;
      694    18047    1   END KNA$MCL;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:35   
--  Include file information  --

   KNA_MACRO_M.:E05TOU  is referenced.
   KN_DATA_M.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   GH_SCHD_E.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   GH_GATE_M.:E05TOU  cannot be made into a system file and is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
      No diagnostics issued in procedure KNA$MCL.

   Procedure KNA$MCL requires 1647 words for executable code.
   Procedure KNA$MCL requires 114 words of local(AUTO) storage.

    No errors detected in file KNA$MCL.:E05TSI    .
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:36   

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:37   

 Object Unit name= KNA$MCL                                    File name= KNA$MCL.:E05TOU
 UTS= JUL 30 '97 00:55:56.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS     15      F  KNA$MCL
    1   Proc  even  none  1647    66F  KNA$MCL
    2  RoData even  none     3      3  KNA$MCL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KNA$MCL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 GHH$LOCK
 yes     yes           Std       1 GHH$UNLOCK
 yes     yes           Std       4 KNB$GETRESP
 yes     yes           Std       3 GFS$GSP
 yes     yes           Std       2 KNA$CHECK_VDO
 yes     yes           Std       1 KNA$GETIOP
         yes           Std       2 KNA$SAVEMAP
 yes     yes           Std       2 KNA$REG_USER
 yes     yes           Std       1 KNA$RLSIOP
 yes     yes           Std       2 KNA$CONV_STR
 yes     yes           Std       4 KNA$FCNOU
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:38   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     G$JIT$                                G$ROS$                                KNA_RWPARM_CON
     KNA_LNKSSN                       r    G$ROS$
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:39   


        1        1        /*M* KNA$MCL Handler for the KI Monitor Services                      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0,ENU=0,ECU=0 */
        8        8        /*P*       NAME:     KNA$MCL
        9        9                   PURPOSE:  This routine acts as the main handler for all
       10       10                             the KI MCLs.
       11       11                   DESCRIPTION:  This module contains the routines to convert
       12       12                                 the data contained in the following MCLs
       13       13                                 into Virtual Device Operator format and also
       14       14                                 to call VDH to process the created VDOs.
       15       15
       16       16                                            M$STRMCTL
       17       17                                            M$GTRMCTL
       18       18                                            M$PROMPT
       19       19                                            M$EOM
       20       20                                            M$TRMPRG
       21       21                                            M$GLINEATTR
       22       22                                            M$STRMATTR
       23       23                                            M$GTRMATTR
       24       24                                            M$PLATEN
       25       25                                            M$STRMTAB
       26       26                                            M$GTRMTAB
       27       27                                            M$SINPUT
       28       28                                            M$PROFILE
       29       29                                            M$TRMISC
       30       30                                            M$DCLFLD
       31       31                                            M$MDFFLD
       32       32                                            M$SLCFLD
       33       33                                            M$RLSFLD
       34       34                                            M$ERASE
       35       35                                                                                      */
       36       36              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:40   
       37       37        /*F*         NAME:    KNA$MCL
       38       38                     PURPOSE: To field all MCLs in the KI code group.
       39       39                     DESCRIPTION:  This routine does error checking, then
       40       40                                   reports an errors.  If there are no
       41       41                                   errors, it builds the necessary VDOs,
       42       42                                   sends them and returns.
       43       43                     CALL:    CALL KNA$MCL(GUD_HAND_PARAMS)
       44       44                     INPUTS:  GUD_HAND_PARAMS
       45       45                                                                                      */
       46       46
       47       47        KNA$MCL: PROC(KID_PARAMS);

     47   1 000000  D380 0000 0000  xent KNA$MCL         LNJ,B5   X6A_AUTO_1
          1 000003       0072 0001                       DC       114,1

       48       48
       49       49        %INCLUDE G_ROS_M;
       50      131        %INCLUDE KI$CP6V_C;
       51      570        %INCLUDE LCP_6;
       52     4849        %INCLUDE GU_MACROS_M;
       53     5008        %INCLUDE B_ERRORS_C;
       54     6135        %INCLUDE KI_MACROS_C;
       55     6743        %INCLUDE NK_VFC_C;
       56     6817        %INCLUDE KV$VDO;
       57     7832        %INCLUDE KV$GLB;
       58     8251        %INCLUDE KV_PRMID_E;
       59     8425        %INCLUDE KV$PRM;
       60     8638        %INCLUDE KL_MACRO_C;
       61    11990        %INCLUDE KL_AFCN_C;
       62    12091        %INCLUDE GH_GATE_M;
       63    12132        %INCLUDE G_JIT_M;
       64    12397        %INCLUDE GH_SCHD_E;
       65    12493        %INCLUDE K$RWPARM;
       66    12879        %INCLUDE KN_DATA_M;
       67    14665        %INCLUDE KNA_MACRO_M;
       68    14741                                                /* EQUATES                            */
       69    14742        %KV_VDO_ALL_E;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:41   
       70    14821        %KV_PRMID_E;
       71    14977
       72    14978                                                /* Params                             */
       73    14979        %GUD_HAND_PARAMS(FPTN=KID_PARAMS);
       74    15055
       75    15056                                                /* SYMREFS                            */
       76    15057    1   DCL G$JIT$ PTR SYMREF;
       77    15058    1   DCL G$ROS$ PTR SYMREF;
       78    15059        %K$RWPARM (NAME=KNA_RWPARM_CON,STCLASS=SYMREF);
       79    15375        %GATE (FPTN=KNA_LNKSSN,STCLASS=SYMREF);
       80    15394                                                /* ENTRYS                             */
       81    15395    1   DCL GFS$GSP ENTRY(3) ALTRET;
       82    15396    1   DCL KNA$CHECK_VDO ENTRY(2) ALTRET;
       83    15397    1   DCL KNA$CONV_STR ENTRY(2) ALTRET;
       84    15398    1   DCL KNA$FCNOU ENTRY(4) ALTRET;
       85    15399    1   DCL KNA$GETIOP ENTRY(1) ALTRET;
       86    15400    1   DCL KNA$RLSIOP ENTRY(1) ALTRET;
       87    15401    1   DCL KNA$REG_USER ENTRY(2) ALTRET;
       88    15402    1   DCL KNB$GETRESP ENTRY(4) ALTRET;
       89    15403    1   DCL KNA$SAVEMAP ENTRY(2);
       90    15404    1   DCL GHS$REG ENTRY(2) ALTRET;
       91    15405                                                /* BASED                              */
       92    15406        %NK$VFC (STCLASS=BASED);
       93    15424        %KNA$SSN  (STCLASS="BASED(SSN$)");
       94    15507        %G$JIT(STCLASS="BASED(G$JIT$)");
       95    15921        %G$DCBTABLE;
       96    15932        %G$ROS(STCLASS="BASED(G$ROS$)");
       97    15976        %M$DCB(DCBN=MYDCB,STCLASS="BASED(DCB$)");
       98    16027        %FPT$TRMCTL_V(BASED="BASED(V$)");
       99    16038        %VLP$TRMCTL_V(BASED="BASED(VLP$)");
      100    16059        %FPT$PROMPT_V(BASED="BASED(V$)");
      101    16071        %FPT$EOM_V(BASED="BASED(V$)");
      102    16084        %VLP$EOMTABLE_V(BASED="BASED(VLP$)");
      103    16098        %FPT$TRMPRG_V(BASED="BASED(V$)");
      104    16110        %FPT$GLINEATTR_V(BASED="BASED(V$)");
      105    16121        %VLP$LINEATTR_V(BASED="BASED(VLP$)");
      106    16134        %FPT$TRMATTR_V(BASED="BASED(V$)");
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:42   
      107    16145        %VLP$TRMATTR_V(BASED="BASED(VLP$)");
      108    16167        %FPT$PLATEN_V(BASED="BASED(V$)");
      109    16178        %VLP$PLATEN_V(BASED="BASED(VLP$)");
      110    16194        %VLP_TAB (FPTN=VLP$TAB,STCLASS=BASED);
      111    16208        %VLP_HDR (FPTN=VLP$HDR,STCLASS=BASED,LEN=160);
      112    16224        %VLP$WINDOW_V;
      113    16246        %FPT$TRMTAB_V(BASED="BASED(V$)");
      114    16257        %FPT$SINPUT_V(BASED="BASED(V$)");
      115    16273        %FPT$DCLFLD_V(BASED="BASED(V$)");
      116    16293        %FPT$MDFFLD_V(BASED="BASED(V$)");
      117    16309        %FPT$SLCFLD_V(BASED="BASED(V$)");
      118    16325        %FPT$RLSFLD_V(BASED="BASED(V$)");
      119    16341        %FPT$ERASE_V(BASED="BASED(V$)");
      120    16357        %FPT$GCHAN_V(BASED="BASED(V$)");
      121    16368        %FPT$RCHAN_V(BASED="BASED(V$)");
      122    16378        %FPT_DEVICE (FPTN=FPT$DEVICE,VECTORS=NO,STCLASS="BASED(V$)");
      123    16405
      124    16406        %KN$IOP (STCLASS="BASED(IOP$)");
      125    16579    1   DCL NULLHDR(0:1) UBIN BYTE UNAL CONSTANT INIT(%KV_PRMID_SSNHDR,0);
      126    16580        %VLR_GCHAN(FPTN=VLR$GCHAN,STCLASS="BASED(GCHAN$)");
      127    16599                                                /* LOCAL                              */
      128    16600    1   DCL DCB$ PTR;
      129    16601    1   DCL V$ PTR;
      130    16602    1   DCL VLP$ CPTR;
      131    16603    1   DCL SSN$ PTR;
      132    16604    1   DCL IOP$ PTR;
      133    16605    1   DCL GCHAN$ PTR;
      134    16606        %VLP_WINDOW (FPTN=WINDOW,STCLASS=AUTO);
      135    16650        %K$RWPARM (NAME=K$RWPARM,STCLASS=AUTO);
      136    16966    1   DCL 1 PRM,
      137    16967    1            2 TL UNAL,
      138    16968    1                 3 TYPE UBIN BYTE UNAL,
      139    16969    1                 3 LEN UBIN BYTE UNAL;
      140    16970        %KV$PRM_EOM(NAME=EOM, STCLASS="BASED(K$RWPARM.V$),2 * UBIN");
      141    16987        %KV$PRM_SINPUT(NAME=SINPUT, STCLASS="BASED(K$RWPARM.V$),2 BIGTL UBIN");
      142    17008    1   DCL 1 PROMPT,
      143    17009    1            2 TL,
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:43   
      144    17010    1                 3 TYPE UBIN BYTE UNAL,
      145    17011    1                 3 LEN UBIN BYTE UNAL,
      146    17012    1            2 PFB UBIN BYTE UNAL,
      147    17013    1            2 DVBYTE BIT(8) UNAL,
      148    17014    1            2 VFC CHAR(1) UNAL;
      149    17015    1   DCL B$MSG CHAR(K$RWPARM.MSGSZ) BASED;
      150    17016        %KI_VCHRPMT (NAME=B$PROMPT,STCLASS=BASED);
      151    17024    1   DCL B$CHAR CHAR(1) BASED;
      152    17025    1   DCL DCBNUMBER UBIN;
      153    17026    1   DCL VDOTYP UBIN;
      154    17027                                                /* START ACQUIRE MESSAGE              */
      155    17028    1   DCL 1 KNA_GCHAN AUTO,
      156    17029        %KL_ACQUIRE(LVL=2,STCLASS=AUTO);
      157    17111                                                /* END ACQUIRE MESSAGE                */
      158    17112                                                /* START RELEASE MESSAGE              */
      159    17113    1   DCL 1 KNA_RCHAN AUTO,
      160    17114        %KL_RELEASE(LVL=2,STCLASS=AUTO);
      161    17169                                                /* END RELEASE MESSAGE                */
      162    17170                                                /* ERRCODES                           */
      163    17171        %VLP_ERRCODE(FPTN=E$BAD_FPT_CODE,ERR#=%E$BADCODE,SEV=%G_SEV_ABORT#,
      164    17172                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      165    17218        %VLP_ERRCODE(FPTN=E$INVALID_DCB,ERR#=%E$BADDCB#,SEV=%G_SEV_ABORT#,
      166    17219                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      167    17265        %VLP_ERRCODE(FPTN=E$NOT_OPEN,ERR#=%E$NOTOPEN,SEV=%G_SEV_ABORT#,
      168    17266                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      169    17312        %VLP_ERRCODE(FPTN=ENO_IOP,ERR#=%E$NO_IOP,SEV=%G_SEV_ERROR#,
      170    17313                     STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      171    17359        %VLP_ERRCODE(FPTN=ERROR_TND,ERR#=%E$NO_TD_PRIV,SEV=%G_SEV_ERROR#,
      172    17360                       STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      173    17406        %VLP_ERRCODE(FPTN=E$NOT_FORM,ERR#=%E$ILGLNOTFORM,SEV=%G_SEV_ERROR#,
      174    17407                       STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      175    17453        %VLP_ERRCODE(FPTN=E$NOT_TS,ERR#=%E$NOTTS,SEV=%G_SEV_CONT#,
      176    17454                       STCLASS=CONSTANT,FCG=KN,MID=A,MON='1'B);
      177    17500                                                /* VDOs                               */
      178    17501              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:44   
      179    17502        /*
      180    17503          Setup a few pointers used everywhere and verify that the DCB# is
      181    17504          valid and its open.
      182    17505                                                                                      */
      183    17506    1        V$ = KID_PARAMS.PTRS.PAR1$;

  17506   1 000005  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 000007  DCC6 0006                            LDB,B5   6,B6
          1 000009  DFC7 0008                            STB,B5   V$,AUTO

      184    17507    1        IF KID_PARAMS.MCL.CODE ~= %G_MCL_GCHAN#

  17507   1 00000B  E806                                 LDR,R6   ,B6
          1 00000C  E570 03FF                            AND,R6   1023,IMO
          1 00000E  E970 0193                            CMR,R6   403,IMO
          1 000010  0901 0070                            BE       s:17565,PREL
          1 000012  E970 0194                            CMR,R6   404,IMO
          1 000014  0901 006C                            BE       s:17565,PREL

      185    17508    1             AND KID_PARAMS.MCL.CODE ~= %G_MCL_RCHAN#
      186    17509    2        THEN DO;

      187    17510    2             DCBNUMBER = FPT$TRMCTL_V.DCB#;

  17510   1 000016  D285                                 LLH,R5   ,B5
          1 000017  DF47 004F                            STR,R5   DCBNUMBER,AUTO

      188    17511    2             IF DCBNUMBER = 0 OR DCBNUMBER > G$ROS$ -> G$ROS.NUMDCBS THEN

  17511   1 000019  5901 0008                            BEZ,R5   s:17518,PREL
          1 00001B  CC80 0000 0000  xsym                 LDB,B4   G$ROS$
          1 00001E  D944 0014                            CMR,R5   20,B4
          1 000020  0381 0009                            BLE      s:17522,PREL

      189    17512    3             DO;

      190    17513
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:45   
      191    17514        /*E*  ERROR:KNA-%E$BADDCB#
      192    17515              DESCRIPTION: A system known DCB must be passed.
      193    17516        */
      194    17517
      195    17518    3                  KID_PARAMS.ERR=E$INVALID_DCB;

  17518   1 000022  8C80 0000 0003  00                   LDI      E$INVALID_DCB
          1 000025  8D46 0003                            SDI      3,B6

      196    17519    3                  RETURN;

  17519   1 000027  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      197    17520    3                  END;
      198    17521
      199    17522    2             DCB$ = G$ROS.DCBPTR$ -> G$DCBTABLE(DCBNUMBER);

  17522   1 00002A  BC84                                 LDB,B3   ,B4
          1 00002B  B855                                 LDR,R3   R5
          1 00002C  ACB3                                 LDB,B2   ,B3,R3
          1 00002D  AFC7 0006                            STB,B2   DCB$,AUTO

      200    17523
      201    17524    2             IF NOT(MYDCB.FCD) THEN

  17524   1 00002F  82C2 001F                            LB,'4000'X        31,B2
  17524   1 000031       4000
          1 000032  0501 0009                            BBT      s:17534,PREL

      202    17525    3             DO;

      203    17526
      204    17527        /*E*   ERROR:KNA-%E$NOTOPEN
      205    17528               MESSAGE:  The DCB you have chosen must already be open
      206    17529                                                                                      */
      207    17530    3                  KID_PARAMS.ERR=E$NOT_OPEN;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:46   
  17530   1 000034  8C80 0000 0005  00                   LDI      E$NOT_OPEN
          1 000037  8D46 0003                            SDI      3,B6

      208    17531    3                  RETURN;

  17531   1 000039  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      209    17532    3                  END;
      210    17533
      211    17534    2             IF KID_PARAMS.MCL.CODE ~= %G_MCL_WRTMLT# AND

  17534   1 00003C  E806                                 LDR,R6   ,B6
          1 00003D  E570 03FF                            AND,R6   1023,IMO
          1 00003F  E970 0144                            CMR,R6   324,IMO
          1 000041  0901 0010                            BE       s:17547,PREL
          1 000043  C842 0003                            LDR,R4   3,B2
          1 000045  C570 0007                            AND,R4   7,IMO
          1 000047  4D02                                 CMV,R4   2
          1 000048  0901 0009                            BE       s:17547,PREL

      212    17535    2                  MYDCB.DDEV.RES ~= %G_DDEV_RES_UC#
      213    17536    2             THEN
      214    17537    3             DO ;

      215    17538
      216    17539        /*E*  ERROR:         KNA-E$NOTTS-C
      217    17540               MESSAGE: That's not a terminal DCB!
      218    17541              MESSAGE1: The terminal control service requests are only legal
      219    17542                        if the DCB is open to a terminal (RES=UCnn). */
      220    17543
      221    17544    3                  KID_PARAMS.ERR=E$NOT_TS ;

  17544   1 00004A  8C80 0000 000D  00                   LDI      E$NOT_TS
          1 00004D  8D46 0003                            SDI      3,B6

      222    17545    3                  RETURN ;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:47   
  17545   1 00004F  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      223    17546    3                  END ;                    /* Then Do */
      224    17547    2             SSN$ = MYDCB.SSN$;

  17547   1 000052  BCC2 0030                            LDB,B3   48,B2
          1 000054  BFC7 000C                            STB,B3   SSN$,AUTO

      225    17548    2             K$RWPARM = KNA_RWPARM_CON;

  17548   1 000056  AB80 0000 0000  xsym                 LAB,B2   KNA_RWPARM_CON
          1 000059  2C00                                 LDV,R2   0
          1 00005A  6C52                                 LDV,R6   82
          1 00005B  BB87                                 LAB,B3   ,AUTO
          1 00005C  3C44                                 LDV,R3   68
          1 00005D  0008                                 MMM

      226    17549    2             K$RWPARM.KEYTYPE = MYDCB.KEYTYPE;

  17549   1 00005E  DCC7 0006                            LDB,B5   DCB$,AUTO
          1 000060  E2C5 0024                            LLH,R6   36,B5
          1 000062  E7C7 004A                            STH,R6   K$RWPARM+40,AUTO

      227    17550    2             K$RWPARM.V$ = V$;

  17550   1 000064  CCC7 0008                            LDB,B4   V$,AUTO
          1 000066  CFC7 0043                            STB,B4   K$RWPARM+33,AUTO

      228    17551    2             K$RWPARM.STR = MYDCB.STRM;

  17551   1 000068  E845 0002                            LDR,R6   2,B5
          1 00006A  EAC7 003F                            SRM,R6,'00FF'X    K$RWPARM+29,AUTO
          1 00006C       00FF

      229    17552    2             IF KID_PARAMS.MCL.CODE = %G_MCL_TRMPRG# THEN EXIT;

  17552   1 00006D  E806                                 LDR,R6   ,B6
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:48   
          1 00006E  E570 03FF                            AND,R6   1023,IMO
          1 000070  E970 0184                            CMR,R6   388,IMO
          1 000072  0901 000E                            BE       s:17565,PREL

      230    17553    2             K$RWPARM.MSGC$ = KID_PARAMS.CPTRS.PAR2$;

  17553   1 000074  8CC6 0008                            LDI      8,B6
          1 000076  8D47 0022                            SDI      K$RWPARM,AUTO

      231    17554    2             IF K$RWPARM.MSG$ ~= ADDR(NIL)

  17554   1 000078  8DC7 0022                            CMN      K$RWPARM,AUTO
          1 00007A  0901 0006                            BE       s:17565,PREL

      232    17555    2             THEN
      233    17556    2                  K$RWPARM.MSGSZ = KID_PARAMS.BND.PAR2+1;

  17556   1 00007C  C846 0027                            LDR,R4   39,B6
          1 00007E  4E01                                 ADV,R4   1
          1 00007F  CF47 0024                            STR,R4   K$RWPARM+2,AUTO

      234    17557    2             END;

      235    17558        /* Lock gate.  This gate is not unlocked to end of routine except for
      236    17559        GCHAN and RCHAN. */
      237    17560             %LOCK (G=KNA_LNKSSN);

  17565   1 000081  BB80 0000 0000  02                   LAB,B3   0
          1 000084  CBF0 0100                            LAB,B4   256,IMO
          1 000086  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 000089       0001                            DC       s:17570,PREL

      238    17567        /*
      239    17568             Now call routines to handle the different MCLs
      240    17569        */
      241    17570    2        DO CASE (KID_PARAMS.MCL.CODE);

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:49   
  17570   1 00008A  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 00008C  B806                                 LDR,R3   ,B6
          1 00008D  B570 03FF                            AND,R3   1023,IMO
          1 00008F  BA70 FEBC                            ADD,R3   -324,IMO
          1 000091  3D53                                 CMV,R3   83
          1 000092  0281 0593                            BGE      s:18023,PREL
          1 000094  A830 0000 009A  01                   LDR,R2   s:17570+16,R3
          1 000097  83A0 0000 00ED  01                   JMP      s:17578,R2
          1 00009A       0510                            DC       s:18014,PREL
          1 00009B       0539                            DC       s:18023,PREL
          1 00009C       0539                            DC       s:18023,PREL
          1 00009D       03F6                            DC       s:17932,PREL
          1 00009E       0539                            DC       s:18023,PREL
          1 00009F       0539                            DC       s:18023,PREL
          1 0000A0       0539                            DC       s:18023,PREL
          1 0000A1       0539                            DC       s:18023,PREL
          1 0000A2       0539                            DC       s:18023,PREL
          1 0000A3       0539                            DC       s:18023,PREL
          1 0000A4       0539                            DC       s:18023,PREL
          1 0000A5       0539                            DC       s:18023,PREL
          1 0000A6       0539                            DC       s:18023,PREL
          1 0000A7       0539                            DC       s:18023,PREL
          1 0000A8       0539                            DC       s:18023,PREL
          1 0000A9       0539                            DC       s:18023,PREL
          1 0000AA       0539                            DC       s:18023,PREL
          1 0000AB       0539                            DC       s:18023,PREL
          1 0000AC       0539                            DC       s:18023,PREL
          1 0000AD       0539                            DC       s:18023,PREL
          1 0000AE       0539                            DC       s:18023,PREL
          1 0000AF       0539                            DC       s:18023,PREL
          1 0000B0       0539                            DC       s:18023,PREL
          1 0000B1       0539                            DC       s:18023,PREL
          1 0000B2       0539                            DC       s:18023,PREL
          1 0000B3       0539                            DC       s:18023,PREL
          1 0000B4       0539                            DC       s:18023,PREL
          1 0000B5       0539                            DC       s:18023,PREL
          1 0000B6       0539                            DC       s:18023,PREL
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:50   
          1 0000B7       0539                            DC       s:18023,PREL
          1 0000B8       0539                            DC       s:18023,PREL
          1 0000B9       0539                            DC       s:18023,PREL
          1 0000BA       0539                            DC       s:18023,PREL
          1 0000BB       0539                            DC       s:18023,PREL
          1 0000BC       0539                            DC       s:18023,PREL
          1 0000BD       0539                            DC       s:18023,PREL
          1 0000BE       0539                            DC       s:18023,PREL
          1 0000BF       0539                            DC       s:18023,PREL
          1 0000C0       0539                            DC       s:18023,PREL
          1 0000C1       0539                            DC       s:18023,PREL
          1 0000C2       0539                            DC       s:18023,PREL
          1 0000C3       0539                            DC       s:18023,PREL
          1 0000C4       0539                            DC       s:18023,PREL
          1 0000C5       0539                            DC       s:18023,PREL
          1 0000C6       0539                            DC       s:18023,PREL
          1 0000C7       0539                            DC       s:18023,PREL
          1 0000C8       0539                            DC       s:18023,PREL
          1 0000C9       0539                            DC       s:18023,PREL
          1 0000CA       0539                            DC       s:18023,PREL
          1 0000CB       0539                            DC       s:18023,PREL
          1 0000CC       0539                            DC       s:18023,PREL
          1 0000CD       0539                            DC       s:18023,PREL
          1 0000CE       0539                            DC       s:18023,PREL
          1 0000CF       0539                            DC       s:18023,PREL
          1 0000D0       0539                            DC       s:18023,PREL
          1 0000D1       0539                            DC       s:18023,PREL
          1 0000D2       0539                            DC       s:18023,PREL
          1 0000D3       0539                            DC       s:18023,PREL
          1 0000D4       0539                            DC       s:18023,PREL
          1 0000D5       0539                            DC       s:18023,PREL
          1 0000D6       0106                            DC       s:17671,PREL
          1 0000D7       0213                            DC       s:17781,PREL
          1 0000D8       013B                            DC       s:17689,PREL
          1 0000D9       0172                            DC       s:17707,PREL
          1 0000DA       01A5                            DC       s:17722,PREL
          1 0000DB       022E                            DC       s:17796,PREL
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:51   
          1 0000DC       01AD                            DC       s:17730,PREL
          1 0000DD       0233                            DC       s:17804,PREL
          1 0000DE       01B5                            DC       s:17738,PREL
          1 0000DF       01BD                            DC       s:17746,PREL
          1 0000E0       0238                            DC       s:17812,PREL
          1 0000E1       01C5                            DC       s:17754,PREL
          1 0000E2       0539                            DC       s:18023,PREL
          1 0000E3       0539                            DC       s:18023,PREL
          1 0000E4       0085                            DC       s:17612,PREL
          1 0000E5       0000                            DC       s:17578,PREL
          1 0000E6       00DF                            DC       s:17647,PREL
          1 0000E7       00DA                            DC       s:17640,PREL
          1 0000E8       00E4                            DC       s:17654,PREL
          1 0000E9       031B                            DC       s:17876,PREL
          1 0000EA       03AE                            DC       s:17919,PREL
          1 0000EB       0242                            DC       s:17830,PREL
          1 0000EC       023D                            DC       s:17821,PREL

      242    17571
      243    17572        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:52   
      244    17573        /*
      245    17574                              M$DCLFLD
      246    17575                                                                                      */
      247    17576    2        CASE(%G_MCL_DCLFLD#);

      248    17577
      249    17578    2           K$RWPARM.IP$ = KID_PARAMS.PTRS.PAR3$;

  17578   1 0000ED  DCC6 000A                            LDB,B5   10,B6
          1 0000EF  DFC7 0035                            STB,B5   K$RWPARM+19,AUTO

      250    17579    2           K$RWPARM.DVE.DVBYTE = FPT$DCLFLD_V.DVBYTE;

  17579   1 0000F1  CCC7 0008                            LDB,B4   V$,AUTO
          1 0000F3  E804                                 LDR,R6   ,B4
          1 0000F4  6008                                 SOL,R6   8
          1 0000F5  6048                                 SOR,R6   8
          1 0000F6  E7C7 0031                            STH,R6   K$RWPARM+15,AUTO

      251    17580    2           VDOTYP = %KV_VDO_FNC_DCLFLD;

  17580   1 0000F8  6C07                                 LDV,R6   7
          1 0000F9  EF47 0050                            STR,R6   VDOTYP,AUTO

  17580   1                              FORM_VDO        null
      252    17581    2   FORM_VDO:;
      253    17582    2           IF MYDCB.ORG~=%G_ORG_FORM#

  17582   1 0000FB  ECC7 0006            FORM_VDO        LDB,B6   DCB$,AUTO
          1 0000FD  E846 001F                            LDR,R6   31,B6
          1 0000FF  E570 00FF                            AND,R6   255,IMO
          1 000101  6D02                                 CMV,R6   2
          1 000102  0901 000A                            BE       s:17587,PREL

      254    17583    3           THEN DO;

      255    17584    3                KID_PARAMS.ERR = E$NOT_FORM;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:53   

  17584   1 000104  8C80 0000 000B  00                   LDI      E$NOT_FORM
          1 000107  DCC7 0004                            LDB,B5   @KID_PARAMS,AUTO
          1 000109  8D45 0003                            SDI      3,B5

      256    17585    3                GOTO DONE;

  17585   1 00010B  0F81 051A                            B        s:18023,PREL

      257    17586    3                END;
      258    17587    2           IF K$RWPARM.DVE.DVBYTE.RRR

  17587   1 00010D  82C7 0031                            LB,'0800'X        K$RWPARM+15,AUTO
  17587   1 00010F       0800
          1 000110  0581 0004                            BBF      s:17590,PREL

      259    17588    2           THEN
      260    17589    2                K$RWPARM.MRKTYP = %KV_VDOMRKTYP_ENDACK;

  17589   1 000112  5C01                                 LDV,R5   1
          1 000113  D7C7 003F                            STH,R5   K$RWPARM+29,AUTO

      261    17590    2           CALL CALL_FCNOU ALTRET (DONE);

  17590   1 000115  E3C0 0533                            LNJ,B6   s:0,PREL
          1 000117       050F                            DC       s:18023,PREL

  17587   1                              WAIT_RRR        null
      262    17591    2   WAIT_RRR: ;
      263    17592    2           IF K$RWPARM.DVE.DVBYTE.RRR

  17592   1 000118  82C7 0031            WAIT_RRR        LB,'0800'X        K$RWPARM+15,AUTO
  17592   1 00011A       0800
          1 00011B  0581 050A                            BBF      s:18023,PREL

      264    17593    3           THEN DO;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:54   
      265    17594    3                CALL KNA$GETIOP(IOP$)

  17594   1 00011D  EBC7 000E                            LAB,B6   IOP$,AUTO
          1 00011F  EFC7 0066                            STB,B6   KNA_RCHAN+9,AUTO
          1 000121  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000123  CBF0 0100                            LAB,B4   256,IMO
          1 000125  E380 0000 0000  xent                 LNJ,B6   KNA$GETIOP
          1 000128       0003                            DC       s:17596,PREL
          1 000129  0F81 000A                            B        s:17599,PREL

      266    17595    4                WHENALTRETURN DO;

      267    17596    4                     KID_PARAMS.ERR = ENO_IOP;

  17596   1 00012B  8C80 0000 0007  00                   LDI      ENO_IOP
          1 00012E  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 000130  8D46 0003                            SDI      3,B6

      268    17597    4                     GOTO DONE;

  17597   1 000132  0F81 04F3                            B        s:18023,PREL

      269    17598    4                     END;
      270    17599    3                KNA$SSN.IOPQ$ = IOP$;

  17599   1 000134  ECC7 000E                            LDB,B6   IOP$,AUTO
          1 000136  DCC7 000C                            LDB,B5   SSN$,AUTO
          1 000138  EFC5 000B                            STB,B6   11,B5

      271    17600    3                KNA$SSN.FLAGS.RRRPND = '1'B;

  17600   1 00013A  ECC7 000C                            LDB,B6   SSN$,AUTO
          1 00013C  8906                                 LBT,'0200'X       ,B6
          1 00013D       0200

      272    17601    3                CALL KNA$REG_USER(%GH_EVCW,SSN$);

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:55   
  17601   1 00013E  EBF0 0015                            LAB,B6   21,IMO
          1 000140  DBC7 000C                            LAB,B5   SSN$,AUTO
          1 000142  DFC7 0068                            STB,B5   KNA_RCHAN+11,AUTO
          1 000144  EFC7 0066                            STB,B6   KNA_RCHAN+9,AUTO
          1 000146  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000148  CBF0 0200                            LAB,B4   512,IMO
          1 00014A  E380 0000 0000  xent                 LNJ,B6   KNA$REG_USER
          1 00014D       0001                            DC       s:17602,PREL

      273    17602    3                KID_PARAMS.ERR = KN$IOP.ERRCODE;

  17602   1 00014E  ECC7 000E                            LDB,B6   IOP$,AUTO
          1 000150  8C86                                 LDI      ,B6
          1 000151  DCC7 0004                            LDB,B5   @KID_PARAMS,AUTO
          1 000153  8D45 0003                            SDI      3,B5

      274    17603    3                MYDCB.FLDID = KN$IOP.FLDID;

  17603   1 000155  ECC7 0006                            LDB,B6   DCB$,AUTO
          1 000157  CCC7 000E                            LDB,B4   IOP$,AUTO
          1 000159  D844 0002                            LDR,R5   2,B4
          1 00015B  DF46 0021                            STR,R5   33,B6

      275    17604    3                KNA$SSN.IOPQ$ = ADDR(NIL);

  17604   1 00015D  BB80 0000 0000                       LAB,B3   0
          1 000160  ACC7 000C                            LDB,B2   SSN$,AUTO
          1 000162  BFC2 000B                            STB,B3   11,B2

      276    17605    3                CALL KNA$RLSIOP (IOP$);

  17605   1 000164  CBC7 000E                            LAB,B4   IOP$,AUTO
          1 000166  CFC7 0066                            STB,B4   KNA_RCHAN+9,AUTO
          1 000168  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 00016A  CBF0 0100                            LAB,B4   256,IMO
          1 00016C  E380 0000 0000  xent                 LNJ,B6   KNA$RLSIOP
          1 00016F       0001                            DC       s:17606,PREL
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:56   

      277    17606    3                END;

  17606   1 000170  0F81 04B5                            B        s:18023,PREL

      278    17607              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:57   
      279    17608    2        CASE (%G_MCL_MDFFLD#);

      280    17609        /*
      281    17610                           M$MDFFLD
      282    17611                                                                                      */
      283    17612    2           IF FPT$MDFFLD_V.KEYTYPE ~= 0

  17612   1 000172  DCC7 0008                            LDB,B5   V$,AUTO
          1 000174  82C5 0001                            LB,'00FF'X        1,B5
          1 000176       00FF
          1 000177  0581 0007                            BBF      s:17615,PREL

      284    17613    2           THEN
      285    17614    2                K$RWPARM.KEYTYPE = FPT$MDFFLD_V.KEYTYPE;

  17614   1 000179  E845 0001                            LDR,R6   1,B5
          1 00017B  E570 00FF                            AND,R6   255,IMO
          1 00017D  E7C7 004A                            STH,R6   K$RWPARM+40,AUTO

      286    17615    2           K$RWPARM.DVE.DVBYTE = FPT$MDFFLD_V.DVBYTE;

  17615   1 00017F  E2C5 0001                            LLH,R6   1,B5
          1 000181  6008                                 SOL,R6   8
          1 000182  6048                                 SOR,R6   8
          1 000183  E7C7 0031                            STH,R6   K$RWPARM+15,AUTO

      287    17616    2           VDOTYP = %KV_VDO_FNC_SLCGRPRND;

  17616   1 000185  6C1A                                 LDV,R6   26
          1 000186  EF47 0050                            STR,R6   VDOTYP,AUTO

      288    17617    2           K$RWPARM.KEY$ = KID_PARAMS.PTRS.PAR3$;

  17617   1 000188  CCC6 000A                            LDB,B4   10,B6
          1 00018A  CFC7 0045                            STB,B4   K$RWPARM+35,AUTO

      289    17618    2           K$RWPARM.KEYSZ = KID_PARAMS.BND.PAR3+1;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:58   

  17618   1 00018C  D846 0028                            LDR,R5   40,B6
          1 00018E  5E01                                 ADV,R5   1
          1 00018F  DAC7 004A                            SRM,R5,'00FF'X    K$RWPARM+40,AUTO
          1 000191       00FF

      290    17619    2           K$RWPARM.IP$ = KID_PARAMS.PTRS.PAR4$;

  17619   1 000192  BCC6 000C                            LDB,B3   12,B6
          1 000194  BFC7 0035                            STB,B3   K$RWPARM+19,AUTO

      291    17620
      292    17621    2           IF FPT$MDFFLD_V.SETGRPRND

  17621   1 000196  89C5 0002                            CMZ      2,B5
          1 000198  0881 0019                            BAGE     s:17628,PREL
          1 00019A  82C5 0002                            LB,'4000'X        2,B5
          1 00019C       4000
          1 00019D  0581 0014                            BBF      s:17628,PREL
          1 00019F  ACC7 0006                            LDB,B2   DCB$,AUTO
          1 0001A1  D842 001F                            LDR,R5   31,B2
          1 0001A3  D570 00FF                            AND,R5   255,IMO
          1 0001A5  5D02                                 CMV,R5   2
          1 0001A6  0981 000B                            BNE      s:17628,PREL

      293    17622    2                AND FPT$MDFFLD_V.SETQLF AND MYDCB.ORG=%G_ORG_FORM#
      294    17623    3           THEN DO;

      295    17624    3                CALL CALL_FCNOU ALTRET(DONE);

  17624   1 0001A8  E3C0 04A0                            LNJ,B6   s:0,PREL
          1 0001AA       047C                            DC       s:18023,PREL

      296    17625    3                VDOTYP = %KV_VDO_FNC_SLCQLF;

  17625   1 0001AB  6C1B                                 LDV,R6   27
          1 0001AC  EF47 0050                            STR,R6   VDOTYP,AUTO
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:59   

      297    17626    3                K$RWPARM.MSGSZ = 0;        /* Only send the data once */

  17626   1 0001AE  8747 0024                            CL       K$RWPARM+2,AUTO

      298    17627    3                END;

  17627   1 0001B0  0F81 0014                            B        s:17633,PREL

      299    17628    2           ELSE IF FPT$MDFFLD_V.SETQLF

  17628   1 0001B2  82C5 0002                            LB,'4000'X        2,B5
  17628   1 0001B4       4000
          1 0001B5  0581 0006                            BBF      s:17630,PREL

      300    17629    2                THEN VDOTYP = %KV_VDO_FNC_SLCQLF;

  17629   1 0001B7  6C1B                                 LDV,R6   27
          1 0001B8  EF47 0050                            STR,R6   VDOTYP,AUTO
          1 0001BA  0F81 000A                            B        s:17633,PREL

      301    17630    2                ELSE IF K$RWPARM.MSGSZ~=0

  17630   1 0001BC  D847 0024                            LDR,R5   K$RWPARM+2,AUTO
          1 0001BE  5901 0467                            BEZ,R5   s:18023,PREL

      302    17631    2                     THEN VDOTYP = %KV_VDO_FNC_DAT;

  17631   1 0001C0  6C05                                 LDV,R6   5
          1 0001C1  EF47 0050                            STR,R6   VDOTYP,AUTO
          1 0001C3  0F81 0001                            B        s:17633,PREL

      303    17632    2                     ELSE GOTO DONE;       /* Nothing to do */
      304    17633    2           GOTO FORM_VDO;

  17633   1 0001C5  0F81 FF35                            B        s:17580,PREL

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:60   
      305    17634
      306    17635              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:61   
      307    17636        /*
      308    17637                                M$SLCFLD
      309    17638                                                                                      */
      310    17639    2        CASE(%G_MCL_SLCFLD#);

      311    17640    2           VDOTYP = %KV_VDO_FNC_SLCFLD;

  17640   1 0001C7  6C19                                 LDV,R6   25
          1 0001C8  EF47 0050                            STR,R6   VDOTYP,AUTO

      312    17641    2           GOTO FORM_COMMON;

  17641   1 0001CA  0F81 0009                            B        s:17654,PREL

      313    17642              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:62   
      314    17643        /*
      315    17644                                M$RLSFLD
      316    17645                                                                                      */
      317    17646    2        CASE(%G_MCL_RLSFLD#);

      318    17647    2           VDOTYP = %KV_VDO_FNC_RLSFLD;

  17647   1 0001CC  6C14                                 LDV,R6   20
          1 0001CD  EF47 0050                            STR,R6   VDOTYP,AUTO

      319    17648    2           GOTO FORM_COMMON;

  17648   1 0001CF  0F81 0004                            B        s:17654,PREL

      320    17649              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:63   
      321    17650        /*
      322    17651                                M$ERASE
      323    17652                                                                                      */
      324    17653    2        CASE(%G_MCL_ERASE#);

      325    17654    2           VDOTYP = %KV_VDO_FNC_ERS;

  17654   1 0001D1  6C0C                                 LDV,R6   12
          1 0001D2  EF47 0050                            STR,R6   VDOTYP,AUTO

  17654   1                              FORM_COMMON     null
      326    17655    2   FORM_COMMON:;
      327    17656    2           IF FPT$ERASE_V.KEYTYPE ~= 0

  17656   1 0001D4  DCC7 0008            FORM_COMMON     LDB,B5   V$,AUTO
          1 0001D6  D2C5 0001                            LLH,R5   1,B5
          1 0001D8  5901 0003                            BEZ,R5   s:17659,PREL

      328    17657    2           THEN
      329    17658    2                K$RWPARM.KEYTYPE = FPT$ERASE_V.KEYTYPE;

  17658   1 0001DA  D7C7 004A                            STH,R5   K$RWPARM+40,AUTO

      330    17659    2           K$RWPARM.DVE.DVBYTE = FPT$ERASE_V.DVBYTE;

  17659   1 0001DC  D805                                 LDR,R5   ,B5
          1 0001DD  5008                                 SOL,R5   8
          1 0001DE  5048                                 SOR,R5   8
          1 0001DF  D7C7 0031                            STH,R5   K$RWPARM+15,AUTO

      331    17660    2           K$RWPARM.KEY$ = K$RWPARM.MSG$;

  17660   1 0001E1  CCC7 0022                            LDB,B4   K$RWPARM,AUTO
          1 0001E3  CFC7 0045                            STB,B4   K$RWPARM+35,AUTO

      332    17661    2           K$RWPARM.KEYSZ = K$RWPARM.MSGSZ;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:64   
  17661   1 0001E5  D847 0024                            LDR,R5   K$RWPARM+2,AUTO
          1 0001E7  DAC7 004A                            SRM,R5,'00FF'X    K$RWPARM+40,AUTO
          1 0001E9       00FF

      333    17662    2           K$RWPARM.MSG$ = ADDR(NIL);

  17662   1 0001EA  BB80 0000 0000                       LAB,B3   0
          1 0001ED  BFC7 0022                            STB,B3   K$RWPARM,AUTO

      334    17663    2           K$RWPARM.MSGSZ = 0;

  17663   1 0001EF  8747 0024                            CL       K$RWPARM+2,AUTO

      335    17664    2           GOTO FORM_VDO;

  17664   1 0001F1  0F81 FF09                            B        s:17580,PREL

      336    17665              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:65   
      337    17666        /*
      338    17667                               M$STRMCTL
      339    17668                                                                                      */
      340    17669    2        CASE(%G_MCL_STRMCTL#);

      341    17670
      342    17671    2           IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_TRMCTL#

  17671   1 0001F3  DCC7 0008                            LDB,B5   V$,AUTO
          1 0001F5  8285                                 LB,'00FF'X        ,B5
          1 0001F6       00FF
          1 0001F7  0501 0006                            BBT      s:17675,PREL

      343    17672    3           THEN DO;

      344    17673    3                PRM.TL.TYPE=%KV_PRMID_TRMCTL;

  17673   1 0001F9  6C04                                 LDV,R6   4
          1 0001FA  E7C7 004B                            STH,R6   PRM,AUTO

      345    17674    3                END;

  17674   1 0001FC  0F81 0026                            B        s:17682,PREL

      346    17675    2           ELSE IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_WINDOW#

  17675   1 0001FE  E805                                 LDR,R6   ,B5
          1 0001FF  E570 00FF                            AND,R6   255,IMO
          1 000201  6D01                                 CMV,R6   1
          1 000202  0981 0020                            BNE      s:17682,PREL

      347    17676    3                THEN DO;

      348    17677    3                     PRM.TL.TYPE=%KV_PRMID_WINDOW;

  17677   1 000204  5C10                                 LDV,R5   16
          1 000205  D7C7 004B                            STH,R5   PRM,AUTO
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:66   

      349    17678    3                     ADDR(WINDOW)->B$MSG = K$RWPARM.MSG$->B$MSG;

  17678   1 000207  ACC7 0022                            LDB,B2   K$RWPARM,AUTO
          1 000209  2C00                                 LDV,R2   0
          1 00020A  E847 0024                            LDR,R6   K$RWPARM+2,AUTO
          1 00020C  BB87                                 LAB,B3   ,AUTO
          1 00020D  3C24                                 LDV,R3   36
          1 00020E  0008                                 MMM

      350    17679    3                     CALL KNA$CONV_STR(WINDOW,KID_PARAMS.ERR) ALTRET(DONE);

  17679   1 00020F  DBC6 0003                            LAB,B5   3,B6
          1 000211  DFC7 0068                            STB,B5   KNA_RCHAN+11,AUTO
          1 000213  CBC7 0012                            LAB,B4   WINDOW,AUTO
          1 000215  CFC7 0066                            STB,B4   KNA_RCHAN+9,AUTO
          1 000217  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000219  CBF0 0200                            LAB,B4   512,IMO
          1 00021B  E380 0000 0000  xent                 LNJ,B6   KNA$CONV_STR
          1 00021E       0408                            DC       s:18023,PREL

      351    17680    3                     K$RWPARM.MSG$ = ADDR(WINDOW);

  17680   1 00021F  EBC7 0012                            LAB,B6   WINDOW,AUTO
          1 000221  EFC7 0022                            STB,B6   K$RWPARM,AUTO

      352    17681    3                     END;

      353    17682    2           CALL SET_PARAM;

  17682   1 000223  E3C0 040E                            LNJ,B6   s:0,PREL
          1 000225       0001                            DC       s:17682+3,PREL
          1 000226  0F81 03FF                            B        s:18023,PREL

      354    17683              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:67   
      355    17684        /*
      356    17685                              M$PROMPT
      357    17686                                                                                      */
      358    17687    2        CASE(%G_MCL_PROMPT#);

      359    17688
      360    17689    2           PROMPT.TL.TYPE=%KV_PRMID_PROMPT;

  17689   1 000228  6C05                                 LDV,R6   5
          1 000229  E7C7 004C                            STH,R6   PROMPT,AUTO

      361    17690    2           PROMPT.VFC = %VFC_EXT;

  17690   1 00022B  5C40                                 LDV,R5   64
          1 00022C  D7C7 004E                            STH,R5   PROMPT+2,AUTO

      362    17691    2           PROMPT.PFB = K$RWPARM.STR;

  17691   1 00022E  C847 003F                            LDR,R4   K$RWPARM+29,AUTO
          1 000230  C570 00FF                            AND,R4   255,IMO
          1 000232  C7C7 004D                            STH,R4   PROMPT+1,AUTO

      363    17692    2           PROMPT.DVBYTE = FPT$PROMPT_V.DVBYTE;

  17692   1 000234  DCC7 0008                            LDB,B5   V$,AUTO
          1 000236  B2C5 0001                            LLH,R3   1,B5
          1 000238  3008                                 SOL,R3   8
          1 000239  3048                                 SOR,R3   8
          1 00023A  BAC7 004D                            SRM,R3,'00FF'X    PROMPT+1,AUTO
          1 00023C       00FF

      364    17693    2           K$RWPARM.V$ = ADDR(PROMPT);

  17693   1 00023D  CBC7 004C                            LAB,B4   PROMPT,AUTO
          1 00023F  CFC7 0043                            STB,B4   K$RWPARM+33,AUTO

      365    17694    2           K$RWPARM.VSZ = LENGTHC(PROMPT);
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:68   

  17694   1 000241  EF47 0047                            STR,R6   K$RWPARM+37,AUTO

      366    17695    2           IF K$RWPARM.MSG$ = ADDR(NIL)

  17695   1 000243  8DC7 0022                            CMN      K$RWPARM,AUTO
          1 000245  0901 000A                            BE       s:17698,PREL
          1 000247  82C5 0001                            LB,'4000'X        1,B5
          1 000249       4000
          1 00024A  0581 0007                            BBF      s:17699,PREL
          1 00024C  8DC7 0022                            CMN      K$RWPARM,AUTO
          1 00024E  0901 0003                            BE       s:17699,PREL

      367    17696    2                OR FPT$PROMPT_V.DVBYTE.VFC AND K$RWPARM.MSG$ ~= ADDR(NIL)
      368    17697    2           THEN
      369    17698    2                K$RWPARM.VSZ = K$RWPARM.VSZ - 1;

  17698   1 000250  88C7 0047                            DEC      K$RWPARM+37,AUTO

      370    17699    2           PROMPT.TL.LEN=K$RWPARM.MSGSZ + K$RWPARM.VSZ - 2;

  17699   1 000252  B847 0024                            LDR,R3   K$RWPARM+2,AUTO
          1 000254  BA47 0047                            ADD,R3   K$RWPARM+37,AUTO
          1 000256  3EFE                                 ADV,R3   -2
          1 000257  BAC7 004C                            SRM,R3,'00FF'X    PROMPT,AUTO
          1 000259       00FF

      371    17700    2           CALL SET_PARAM1;

  17700   1 00025A  E3C0 03E7                            LNJ,B6   s:0,PREL
          1 00025C       0001                            DC       s:17700+3,PREL
          1 00025D  0F81 03C8                            B        s:18023,PREL

      372    17701              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:69   
      373    17702        /*
      374    17703                              M$EOM
      375    17704                                                                                      */
      376    17705    2        CASE(%G_MCL_EOM#);

      377    17706
      378    17707    2           PRM.TL.TYPE=%KV_PRMID_EOM;

  17707   1 00025F  6C06                                 LDV,R6   6
          1 000260  E7C7 004B                            STH,R6   PRM,AUTO

      379    17708    2           K$RWPARM.V$=ADDR(PRM);

  17708   1 000262  DBC7 004B                            LAB,B5   PRM,AUTO
          1 000264  DFC7 0043                            STB,B5   K$RWPARM+33,AUTO

      380    17709    2           K$RWPARM.VSZ = LENGTHC(EOM) - LENGTHC(EOM.TABLE);

  17709   1 000266  EF47 0047                            STR,R6   K$RWPARM+37,AUTO

      381    17710    2           EOM.DMN = K$RWPARM.STR;

  17710   1 000268  D847 003F                            LDR,R5   K$RWPARM+29,AUTO
          1 00026A  D570 00FF                            AND,R5   255,IMO
          1 00026C  D7C5 0001                            STH,R5   1,B5

      382    17711    2           EOM.SUPPHALT=FPT$EOM_V.SUPPHALT;

  17711   1 00026E  DCC7 0008                            LDB,B5   V$,AUTO
          1 000270  D845 0001                            LDR,R5   1,B5
          1 000272  CCC7 0043                            LDB,B4   K$RWPARM+33,AUTO
          1 000274  DAC4 0002                            SRM,R5,'8000'X    2,B4
          1 000276       8000

      383    17712    2           EOM.UTYPE=FPT$EOM_V.UTYPE;

  17712   1 000277  CCC7 0043                            LDB,B4   K$RWPARM+33,AUTO
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:70   
          1 000279  D845 0001                            LDR,R5   1,B5
          1 00027B  DAC4 0002                            SRM,R5,'0300'X    2,B4
          1 00027D       0300

      384    17713    2           EOM.TIMEOUT=FPT$EOM_V.TIMEOUT;

  17713   1 00027E  CCC7 0043                            LDB,B4   K$RWPARM+33,AUTO
          1 000280  D845 0001                            LDR,R5   1,B5
          1 000282  DAC4 0002                            SRM,R5,'00FF'X    2,B4
          1 000284       00FF

      385    17714    2           PRM.TL.LEN = K$RWPARM.MSGSZ+K$RWPARM.VSZ-2;

  17714   1 000285  D847 0024                            LDR,R5   K$RWPARM+2,AUTO
          1 000287  DA47 0047                            ADD,R5   K$RWPARM+37,AUTO
          1 000289  5EFE                                 ADV,R5   -2
          1 00028A  DAC7 004B                            SRM,R5,'00FF'X    PRM,AUTO
          1 00028C       00FF

      386    17715    2           CALL SET_PARAM1;

  17715   1 00028D  E3C0 03B4                            LNJ,B6   s:0,PREL
          1 00028F       0001                            DC       s:17715+3,PREL
          1 000290  0F81 0395                            B        s:18023,PREL

      387    17716              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:71   
      388    17717        /*
      389    17718                            M$TRMPRG
      390    17719                                                                                      */
      391    17720    2        CASE(%G_MCL_TRMPRG#);

      392    17721
      393    17722    2           VDOTYP = %KV_VDO_FNC_DLT;

  17722   1 000292  6C09                                 LDV,R6   9
          1 000293  EF47 0050                            STR,R6   VDOTYP,AUTO

      394    17723    2           CALL CALL_FCNOU;

  17723   1 000295  E3C0 03B3                            LNJ,B6   s:0,PREL
          1 000297       0001                            DC       s:17723+3,PREL
          1 000298  0F81 038D                            B        s:18023,PREL

      395    17724        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:72   
      396    17725        /*
      397    17726                               M$STRMATTR
      398    17727                                                                                      */
      399    17728    2        CASE(%G_MCL_STRMATTR#);

      400    17729
      401    17730    2           PRM.TL.TYPE=%KV_PRMID_TRMATTR;

  17730   1 00029A  6C07                                 LDV,R6   7
          1 00029B  E7C7 004B                            STH,R6   PRM,AUTO

      402    17731    2           CALL SET_PARAM;

  17731   1 00029D  E3C0 0394                            LNJ,B6   s:0,PREL
          1 00029F       0001                            DC       s:17731+3,PREL
          1 0002A0  0F81 0385                            B        s:18023,PREL

      403    17732              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:73   
      404    17733        /*
      405    17734                               M$PLATEN
      406    17735                                                                                      */
      407    17736    2        CASE(%G_MCL_PLATEN#);

      408    17737
      409    17738    2           PRM.TL.TYPE=%KV_PRMID_PLATEN;

  17738   1 0002A2  6C08                                 LDV,R6   8
          1 0002A3  E7C7 004B                            STH,R6   PRM,AUTO

      410    17739    2           CALL SET_PARAM;

  17739   1 0002A5  E3C0 038C                            LNJ,B6   s:0,PREL
          1 0002A7       0001                            DC       s:17739+3,PREL
          1 0002A8  0F81 037D                            B        s:18023,PREL

      411    17740              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:74   
      412    17741        /*
      413    17742                               M$STRMTAB
      414    17743                                                                                      */
      415    17744    2        CASE(%G_MCL_STRMTAB#);

      416    17745
      417    17746    2           PRM.TL.TYPE=%KV_PRMID_TRMTAB;

  17746   1 0002AA  6C09                                 LDV,R6   9
          1 0002AB  E7C7 004B                            STH,R6   PRM,AUTO

      418    17747    2           CALL SET_PARAM;

  17747   1 0002AD  E3C0 0384                            LNJ,B6   s:0,PREL
          1 0002AF       0001                            DC       s:17747+3,PREL
          1 0002B0  0F81 0375                            B        s:18023,PREL

      419    17748              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:75   
      420    17749        /*
      421    17750                               M$SINPUT
      422    17751                                                                                      */
      423    17752    2        CASE(%G_MCL_SINPUT#);

      424    17753
      425    17754    2           PROMPT.TL.TYPE=%KV_PRMID_SINPUT;

  17754   1 0002B2  6C0B                                 LDV,R6   11
          1 0002B3  E7C7 004C                            STH,R6   PROMPT,AUTO

      426    17755    2           K$RWPARM.V$ = ADDR(PROMPT);

  17755   1 0002B5  DBC7 004C                            LAB,B5   PROMPT,AUTO
          1 0002B7  DFC7 0043                            STB,B5   K$RWPARM+33,AUTO

      427    17756    2           K$RWPARM.VSZ = LENGTHC(SINPUT)-LENGTHC(SINPUT.TXT);

  17756   1 0002B9  5C06                                 LDV,R5   6
          1 0002BA  DF47 0047                            STR,R5   K$RWPARM+37,AUTO

      428    17757    2           SINPUT.DMN = K$RWPARM.STR;

  17757   1 0002BC  C847 003F                            LDR,R4   K$RWPARM+29,AUTO
          1 0002BE  C570 00FF                            AND,R4   255,IMO
          1 0002C0  C7C5 0001                            STH,R4   1,B5

      429    17758    2           IF FPT$SINPUT_V.POSITION THEN

  17758   1 0002C2  DCC7 0008                            LDB,B5   V$,AUTO
          1 0002C4  8285                                 LB,'0040'X        ,B5
          1 0002C5       0040
          1 0002C6  0581 0005                            BBF      s:17763,PREL

      430    17759    3           DO;

      431    17760    3                K$RWPARM.VSZ = K$RWPARM.VSZ-1;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:76   

  17760   1 0002C8  88C7 0047                            DEC      K$RWPARM+37,AUTO

      432    17761    3                END;

  17761   1 0002CA  0F81 0007                            B        s:17765,PREL

      433    17762    3           ELSE DO;

      434    17763    3                SINPUT.POSITION = FPT$SINPUT_V.REREADPOS;

  17763   1 0002CC  CCC7 0043                            LDB,B4   K$RWPARM+33,AUTO
          1 0002CE  C845 0001                            LDR,R4   1,B5
          1 0002D0  CF44 0002                            STR,R4   2,B4

      435    17764    3                END;

      436    17765    2           PROMPT.TL.LEN = K$RWPARM.MSGSZ+K$RWPARM.VSZ-2;

  17765   1 0002D2  C847 0024                            LDR,R4   K$RWPARM+2,AUTO
          1 0002D4  CA47 0047                            ADD,R4   K$RWPARM+37,AUTO
          1 0002D6  4EFE                                 ADV,R4   -2
          1 0002D7  CAC7 004C                            SRM,R4,'00FF'X    PROMPT,AUTO
          1 0002D9       00FF

      437    17766    2           IF K$RWPARM.MSGSZ+K$RWPARM.VSZ-2>255

  17766   1 0002DA  C847 0024                            LDR,R4   K$RWPARM+2,AUTO
          1 0002DC  CA47 0047                            ADD,R4   K$RWPARM+37,AUTO
          1 0002DE  4EFE                                 ADV,R4   -2
          1 0002DF  C970 00FF                            CMR,R4   255,IMO
          1 0002E1  0A81 0019                            BALE     s:17774,PREL

      438    17767    3           THEN DO;

      439    17768    3                SINPUT.BIGTL = K$RWPARM.MSGSZ+K$RWPARM.VSZ-2;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:77   
  17768   1 0002E3  C847 0024                            LDR,R4   K$RWPARM+2,AUTO
          1 0002E5  CA47 0047                            ADD,R4   K$RWPARM+37,AUTO
          1 0002E7  CCC7 0043                            LDB,B4   K$RWPARM+33,AUTO
          1 0002E9  4EFE                                 ADV,R4   -2
          1 0002EA  CF04                                 STR,R4   ,B4

      440    17769    3                PRM.TL.TYPE = %KV_PRMID_BIGTL;

  17769   1 0002EB  8947 004B                            LBT,'FF00'X       PRM,AUTO
  17769   1 0002ED       FF00

      441    17770    3                PRM.TL.LEN = %KV_PRMID_SINPUT;

  17770   1 0002EE  4C0B                                 LDV,R4   11
          1 0002EF  CAC7 004B                            SRM,R4,'00FF'X    PRM,AUTO
          1 0002F1       00FF

      442    17771    3                K$RWPARM.V$ = ADDR(PRM);

  17771   1 0002F2  CBC7 004B                            LAB,B4   PRM,AUTO
          1 0002F4  CFC7 0043                            STB,B4   K$RWPARM+33,AUTO

      443    17772    3                K$RWPARM.VSZ = K$RWPARM.VSZ+2;

  17772   1 0002F6  B847 0047                            LDR,R3   K$RWPARM+37,AUTO
          1 0002F8  3E02                                 ADV,R3   2
          1 0002F9  BF47 0047                            STR,R3   K$RWPARM+37,AUTO

      444    17773    3                END;

      445    17774    2           CALL SET_PARAM1;

  17774   1 0002FB  E3C0 0346                            LNJ,B6   s:0,PREL
          1 0002FD       0001                            DC       s:17774+3,PREL
          1 0002FE  0F81 0327                            B        s:18023,PREL

      446    17775              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:78   
      447    17776        /*
      448    17777                           M$GTRMCTL
      449    17778                                                                                      */
      450    17779    2        CASE(%G_MCL_GTRMCTL#);

      451    17780
      452    17781    2           IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_TRMCTL#

  17781   1 000300  DCC7 0008                            LDB,B5   V$,AUTO
          1 000302  8285                                 LB,'00FF'X        ,B5
          1 000303       00FF
          1 000304  0501 0006                            BBT      s:17784,PREL

      453    17782    2           THEN
      454    17783    2                K$RWPARM.PRMID = %KV_PRMID_TRMCTL;

  17783   1 000306  6C04                                 LDV,R6   4
          1 000307  EF47 0048                            STR,R6   K$RWPARM+38,AUTO
          1 000309  0F81 000F                            B        s:17789,PREL

      455    17784    2           ELSE IF FPT$TRMCTL_V.VLPTYPE = %G_TRMCTL_WINDOW#

  17784   1 00030B  E805                                 LDR,R6   ,B5
          1 00030C  E570 00FF                            AND,R6   255,IMO
          1 00030E  6D01                                 CMV,R6   1
          1 00030F  0981 0006                            BNE      s:17788,PREL

      456    17785    2                THEN
      457    17786    2                     K$RWPARM.PRMID = %KV_PRMID_WINDOW;

  17786   1 000311  5C10                                 LDV,R5   16
          1 000312  DF47 0048                            STR,R5   K$RWPARM+38,AUTO
          1 000314  0F81 0004                            B        s:17789,PREL

      458    17787    2                ELSE
      459    17788    2                     K$RWPARM.PRMID = %KV_PRMID_EDTCTL;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:79   
  17788   1 000316  5C0C                                 LDV,R5   12
          1 000317  DF47 0048                            STR,R5   K$RWPARM+38,AUTO

      460    17789    2           GOTO GET_COMMON;

  17789   1 000319  0F81 0018                            B        s:17830,PREL

      461    17790              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:80   
      462    17791        /*
      463    17792                           M$GLINEATTR
      464    17793                                                                                      */
      465    17794    2        CASE(%G_MCL_GLINEATTR#);

      466    17795
      467    17796    2           K$RWPARM.PRMID=%KV_PRMID_LINEATTR;

  17796   1 00031B  6C0A                                 LDV,R6   10
          1 00031C  EF47 0048                            STR,R6   K$RWPARM+38,AUTO

      468    17797    2           GOTO GET_COMMON;

  17797   1 00031E  0F81 0013                            B        s:17830,PREL

      469    17798              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:81   
      470    17799        /*
      471    17800                           M$GTRMATTR
      472    17801                                                                                      */
      473    17802    2        CASE(%G_MCL_GTRMATTR#);

      474    17803
      475    17804    2           K$RWPARM.PRMID=%KV_PRMID_TRMATTR;

  17804   1 000320  6C07                                 LDV,R6   7
          1 000321  EF47 0048                            STR,R6   K$RWPARM+38,AUTO

      476    17805    2           GOTO GET_COMMON;

  17805   1 000323  0F81 000E                            B        s:17830,PREL

      477    17806              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:82   
      478    17807        /*
      479    17808                           M$GTRMTAB
      480    17809                                                                                      */
      481    17810    2        CASE(%G_MCL_GTRMTAB#);

      482    17811
      483    17812    2           K$RWPARM.PRMID=%KV_PRMID_TRMTAB;

  17812   1 000325  6C09                                 LDV,R6   9
          1 000326  EF47 0048                            STR,R6   K$RWPARM+38,AUTO

      484    17813    2           GOTO GET_COMMON;

  17813   1 000328  0F81 0009                            B        s:17830,PREL

      485    17814
      486    17815              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:83   
      487    17816        /*
      488    17817                         M$GPLATEN
      489    17818         */
      490    17819    2        CASE (%G_MCL_GPLATEN#);

      491    17820
      492    17821    2           K$RWPARM.PRMID = %KV_PRMID_PLATEN;

  17821   1 00032A  6C08                                 LDV,R6   8
          1 00032B  EF47 0048                            STR,R6   K$RWPARM+38,AUTO

      493    17822    2           GOTO GET_COMMON;

  17822   1 00032D  0F81 0004                            B        s:17830,PREL

      494    17823
      495    17824        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:84   
      496    17825        /*
      497    17826                           M$GPROMPT
      498    17827                                                                                      */
      499    17828    2        CASE(%G_MCL_GPROMPT#);

      500    17829
      501    17830    2           K$RWPARM.PRMID = %KV_PRMID_PROMPT;

  17830   1 00032F  6C05                                 LDV,R6   5
          1 000330  EF47 0048                            STR,R6   K$RWPARM+38,AUTO

  17830   1                              GET_COMMON      null
      502    17831    2   GET_COMMON: ;
      503    17832    2           K$RWPARM.MSG$ = ADDR(NIL);

  17832   1 000332  DB80 0000 0000       GET_COMMON      LAB,B5   0
          1 000335  DFC7 0022                            STB,B5   K$RWPARM,AUTO

      504    17833    2           K$RWPARM.MSGSZ = 0;

  17833   1 000337  8747 0024                            CL       K$RWPARM+2,AUTO

      505    17834    2           K$RWPARM.MAXNMBBYT = KID_PARAMS.BND.PAR2+1;

  17834   1 000339  E846 0027                            LDR,R6   39,B6
          1 00033B  6E01                                 ADV,R6   1
          1 00033C  EF47 0041                            STR,R6   K$RWPARM+31,AUTO

      506    17835    2           CALL KNA$GETIOP(IOP$)

  17835   1 00033E  CBC7 000E                            LAB,B4   IOP$,AUTO
          1 000340  CFC7 0066                            STB,B4   KNA_RCHAN+9,AUTO
          1 000342  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000344  CBF0 0100                            LAB,B4   256,IMO
          1 000346  E380 0000 0000  xent                 LNJ,B6   KNA$GETIOP
          1 000349       0003                            DC       s:17837,PREL
          1 00034A  0F81 000A                            B        s:17840,PREL
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:85   

      507    17836    3           WHENALTRETURN DO;

      508    17837    3                KID_PARAMS.ERR = ENO_IOP;

  17837   1 00034C  8C80 0000 0007  00                   LDI      ENO_IOP
          1 00034F  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 000351  8D46 0003                            SDI      3,B6

      509    17838    3                GOTO DONE;

  17838   1 000353  0F81 02D2                            B        s:18023,PREL

      510    17839    3                END;
      511    17840    2           KNA$SSN.IOPQ$ = IOP$;

  17840   1 000355  ECC7 000E                            LDB,B6   IOP$,AUTO
          1 000357  DCC7 000C                            LDB,B5   SSN$,AUTO
          1 000359  EFC5 000B                            STB,B6   11,B5

      512    17841    2           KN$IOP.FLAGS.WAIT = '1'B;

  17841   1 00035B  ECC7 000E                            LDB,B6   IOP$,AUTO
          1 00035D  8946 0003                            LBT,'4000'X       3,B6
          1 00035F       4000

      513    17842    2           KN$IOP.DCB$ = DCB$;

  17842   1 000360  ECC7 0006                            LDB,B6   DCB$,AUTO
          1 000362  DCC7 000E                            LDB,B5   IOP$,AUTO
          1 000364  EFC5 000A                            STB,B6   10,B5

      514    17843    2           CALL KNA$SAVEMAP(DCB$,KN$IOP.DCBSEGDES);

  17843   1 000366  DCC7 000E                            LDB,B5   IOP$,AUTO
          1 000368  CBC5 0014                            LAB,B4   20,B5
          1 00036A  CFC7 0068                            STB,B4   KNA_RCHAN+11,AUTO
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:86   
          1 00036C  BBC7 0006                            LAB,B3   DCB$,AUTO
          1 00036E  BFC7 0066                            STB,B3   KNA_RCHAN+9,AUTO
          1 000370  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000372  CBF0 0200                            LAB,B4   512,IMO
          1 000374  E380 0000 0000  xent                 LNJ,B6   KNA$SAVEMAP
          1 000377       0001                            DC       s:17844,PREL

      515    17844    2           VBASE(KN$IOP.BUF_) = KID_PARAMS.PTRS.PAR2$;

  17844   1 000378  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 00037A  DCC6 0008                            LDB,B5   8,B6
          1 00037C  CCC7 000E                            LDB,B4   IOP$,AUTO
          1 00037E  DFC4 0005                            STB,B5   5,B4

      516    17845    2           VBOUND(KN$IOP.BUF_) = KID_PARAMS.BND.PAR2;

  17845   1 000380  DCC7 000E                            LDB,B5   IOP$,AUTO
          1 000382  E846 0027                            LDR,R6   39,B6
          1 000384  EF45 0004                            STR,R6   4,B5

      517    17846    2           CALL KNA$SAVEMAP(KID_PARAMS.PTRS.PAR2$,KN$IOP.BUFSEGDES);

  17846   1 000386  DCC7 000E                            LDB,B5   IOP$,AUTO
          1 000388  CBC5 0010                            LAB,B4   16,B5
          1 00038A  CFC7 0068                            STB,B4   KNA_RCHAN+11,AUTO
          1 00038C  BBC6 0008                            LAB,B3   8,B6
          1 00038E  BFC7 0066                            STB,B3   KNA_RCHAN+9,AUTO
          1 000390  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000392  CBF0 0200                            LAB,B4   512,IMO
          1 000394  E380 0000 0000  xent                 LNJ,B6   KNA$SAVEMAP
          1 000397       0001                            DC       s:17847,PREL

      518    17847    2           VDOTYP = %KV_VDO_FNC_RQSPRM;

  17847   1 000398  6C17                                 LDV,R6   23
          1 000399  EF47 0050                            STR,R6   VDOTYP,AUTO

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:87   
      519    17848    2           CALL CALL_FCNOU ALTRET(GET_DONE);

  17848   1 00039B  E3C0 02AD                            LNJ,B6   s:0,PREL
          1 00039D       0056                            DC       s:17861,PREL

      520    17849    2           CALL KNA$REG_USER(%GH_EVCRD,SSN$);

  17849   1 00039E  EBF0 0016                            LAB,B6   22,IMO
          1 0003A0  DBC7 000C                            LAB,B5   SSN$,AUTO
          1 0003A2  DFC7 0068                            STB,B5   KNA_RCHAN+11,AUTO
          1 0003A4  EFC7 0066                            STB,B6   KNA_RCHAN+9,AUTO
          1 0003A6  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 0003A8  CBF0 0200                            LAB,B4   512,IMO
          1 0003AA  E380 0000 0000  xent                 LNJ,B6   KNA$REG_USER
          1 0003AD       0001                            DC       s:17850,PREL

      521    17850    2           KID_PARAMS.ERR = KN$IOP.ERRCODE;

  17850   1 0003AE  ECC7 000E                            LDB,B6   IOP$,AUTO
          1 0003B0  8C86                                 LDI      ,B6
          1 0003B1  DCC7 0004                            LDB,B5   @KID_PARAMS,AUTO
          1 0003B3  8D45 0003                            SDI      3,B5

      522    17851    2           IF KID_PARAMS.ERR='0'B AND KID_PARAMS.MCL.CODE=%G_MCL_GPROMPT#

  17851   1 0003B5  EB80 0000 0000  02                   LAB,B6   0
          1 0003B8  5C01                                 LDV,R5   1
          1 0003B9  0022                                 ACM      ;
          1 0003BA       4405 0003                                ALPHANUM(3,B5,,4,FILL),;
          1 0003BC       4006 0002                                ALPHANUM(2,B6,,R5,FILL)
          1 0003BE  5301 0034                            CBNE     s:17861,PREL
          1 0003C0  C805                                 LDR,R4   ,B5
          1 0003C1  C570 03FF                            AND,R4   1023,IMO
          1 0003C3  C970 0195                            CMR,R4   405,IMO
          1 0003C5  0981 002D                            BNE      s:17861,PREL
          1 0003C7  ECC7 0006                            LDB,B6   DCB$,AUTO
          1 0003C9  B806                                 LDR,R3   ,B6
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:88   
          1 0003CA  3D02                                 CMV,R3   2
          1 0003CB  0381 0027                            BLE      s:17861,PREL

      523    17852    2                AND MYDCB.ARS>2
      524    17853    3           THEN DO;

      525    17854    3                K$RWPARM.MSGSZ = MYDCB.ARS-2;

  17854   1 0003CD  3EFE                                 ADV,R3   -2
          1 0003CE  BF47 0024                            STR,R3   K$RWPARM+2,AUTO

      526    17855    3                FPT$PROMPT_V.DVBYTE = KID_PARAMS.PTRS.PAR2$->B$PROMPT.DVBYTE;

  17855   1 0003D0  CCC5 0008                            LDB,B4   8,B5
          1 0003D2  E804                                 LDR,R6   ,B4
          1 0003D3  6008                                 SOL,R6   8
          1 0003D4  6048                                 SOR,R6   8
          1 0003D5  BCC7 0008                            LDB,B3   V$,AUTO
          1 0003D7  E7C3 0001                            STH,R6   1,B3

      527    17856    3                IF NOT FPT$PROMPT_V.DVBYTE.VFC

  17856   1 0003D9  82C3 0001                            LB,'4000'X        1,B3
  17856   1 0003DB       4000
          1 0003DC  0501 0003                            BBT      s:17858,PREL

      528    17857    3                THEN K$RWPARM.MSGSZ = K$RWPARM.MSGSZ-1;

  17857   1 0003DE  88C7 0024                            DEC      K$RWPARM+2,AUTO

      529    17858    3                KID_PARAMS.PTRS.PAR2$->B$MSG = PINCRC(KID_PARAMS.PTRS.PAR2$,

  17858   1 0003E0  ECC5 0008                            LDB,B6   8,B5
          1 0003E2  CCC7 0006                            LDB,B4   DCB$,AUTO
          1 0003E4  E804                                 LDR,R6   ,B4
          1 0003E5  E247 0024                            SUB,R6   K$RWPARM+2,AUTO
          1 0003E7  AB86                                 LAB,B2   ,B6
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:89   
          1 0003E8  A856                                 LDR,R2   R6
          1 0003E9  E847 0024                            LDR,R6   K$RWPARM+2,AUTO
          1 0003EB  BB86                                 LAB,B3   ,B6
          1 0003EC  3C00                                 LDV,R3   0
          1 0003ED  0008                                 MMM

      530    17859    3                     MYDCB.ARS-K$RWPARM.MSGSZ)->B$MSG;
      531    17860    3                MYDCB.ARS = K$RWPARM.MSGSZ;

  17860   1 0003EE  CCC7 0006                            LDB,B4   DCB$,AUTO
          1 0003F0  E847 0024                            LDR,R6   K$RWPARM+2,AUTO
          1 0003F2  EF04                                 STR,R6   ,B4

      532    17861    3                END;

      533    17862    2   GET_DONE:;

  17862   1                              GET_DONE        null
      534    17863    2           KNA$SSN.IOPQ$ = ADDR(NIL);

  17863   1 0003F3  EB80 0000 0000       GET_DONE        LAB,B6   0
          1 0003F6  DCC7 000C                            LDB,B5   SSN$,AUTO
          1 0003F8  EFC5 000B                            STB,B6   11,B5

      535    17864    2           CALL KNA$RLSIOP(IOP$);

  17864   1 0003FA  EBC7 000E                            LAB,B6   IOP$,AUTO
          1 0003FC  EFC7 0066                            STB,B6   KNA_RCHAN+9,AUTO
          1 0003FE  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000400  CBF0 0100                            LAB,B4   256,IMO
          1 000402  E380 0000 0000  xent                 LNJ,B6   KNA$RLSIOP
          1 000405       0001                            DC       s:17864+12,PREL
          1 000406  0F81 021F                            B        s:18023,PREL

      536    17865              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:90   
      537    17866        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:91   
      538    17867        /*
      539    17868                           M$GCHAN
      540    17869                                                                                      */
      541    17870    2        CASE(%G_MCL_GCHAN#);

      542    17871                %UNLOCK (G=KNA_LNKSSN);

  17876   1 000408  BB80 0000 0000  02                   LAB,B3   0
          1 00040B  CBF0 0100                            LAB,B4   256,IMO
          1 00040D  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 000410       0001                            DC       s:17878,PREL

      543    17878    2           IF (NOT G$JIT.PRIV.ACTIVE.TND)

  17878   1 000411  EC80 0000 0000  xsym                 LDB,B6   G$JIT$
          1 000414  82C6 008F                            LB,'0040'X        143,B6
          1 000416       0040
          1 000417  0501 000B                            BBT      s:17887,PREL

      544    17879    3           THEN DO;

      545    17880    3                KID_PARAMS.ERR = ERROR_TND;

  17880   1 000419  8C80 0000 0009  00                   LDI      ERROR_TND
          1 00041C  DCC7 0004                            LDB,B5   @KID_PARAMS,AUTO
          1 00041E  8D45 0003                            SDI      3,B5

      546    17881                       /*E* ERROR: KNA-E$NO_TD_PRIV-3
      547    17882                            MESSAGE: M$GCHAN requires the TND privilege.
      548    17883                             */
      549    17884    3                RETURN;

  17884   1 000420  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      550    17885    3                END;
      551    17886
      552    17887    2           KNA_GCHAN.KL_ACQUIRE.CODE = IGA_LINE_ACQUIRE;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:92   

  17887   1 000423  6C2C                                 LDV,R6   44
          1 000424  E7C7 0051                            STH,R6   KNA_GCHAN,AUTO

      553    17888    2           GCHAN$=KID_PARAMS.PTRS.PAR2$;

  17888   1 000426  DCC7 0004                            LDB,B5   @KID_PARAMS,AUTO
          1 000428  CCC5 0008                            LDB,B4   8,B5
          1 00042A  CFC7 0010                            STB,B4   GCHAN$,AUTO

      554    17889    2           KNA_GCHAN.KL_ACQUIRE.CHAN=FPT$GCHAN_V.CHANNEL;

  17889   1 00042C  BCC7 0008                            LDB,B3   V$,AUTO
          1 00042E  D803                                 LDR,R5   ,B3
          1 00042F  DF47 0052                            STR,R5   KNA_GCHAN+1,AUTO

      555    17890    2           KNA_GCHAN.KL_ACQUIRE.RES=FPT$GCHAN_V.RES;

  17890   1 000431  AB83                                 LAB,B2   ,B3
          1 000432  2C02                                 LDV,R2   2
          1 000433  6C02                                 LDV,R6   2
          1 000434  BBC7 0057                            LAB,B3   KNA_GCHAN+6,AUTO
          1 000436  3C00                                 LDV,R3   0
          1 000437  0008                                 MMM

      556    17891    2           KNA_GCHAN.KL_ACQUIRE.ATTR=FPT$GCHAN_V.ATTR;

  17891   1 000438  ECC7 0008                            LDB,B6   V$,AUTO
          1 00043A  E846 0002                            LDR,R6   2,B6
          1 00043C  EF47 0058                            STR,R6   KNA_GCHAN+7,AUTO

      557    17892    2           KNA_GCHAN.KL_ACQUIRE.DIAG=FPT$GCHAN_V.FLAGS.DIAG;

  17892   1 00043E  D846 0003                            LDR,R5   3,B6
          1 000440  DAC7 0059                            SRM,R5,'8000'X    KNA_GCHAN+8,AUTO
          1 000442       8000

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:93   
      558    17893    2           KNA_GCHAN.KL_ACQUIRE.CONTROLLER=FPT$GCHAN_V.FLAGS.CONTROLLER;

  17893   1 000443  D846 0003                            LDR,R5   3,B6
          1 000445  DAC7 0059                            SRM,R5,'4000'X    KNA_GCHAN+8,AUTO
          1 000447       4000

      559    17894    2           KNA_GCHAN.KL_ACQUIRE.HIGHLOW=FPT$GCHAN_V.FLAGS.HIGHLOW;

  17894   1 000448  D846 0003                            LDR,R5   3,B6
          1 00044A  DAC7 0059                            SRM,R5,'2000'X    KNA_GCHAN+8,AUTO
          1 00044C       2000

      560    17895    2           KNA_GCHAN.KL_ACQUIRE.USER#=G$JIT.USR#;

  17895   1 00044D  CC80 0000 0000  xsym                 LDB,B4   G$JIT$
          1 000450  D844 0004                            LDR,R5   4,B4
          1 000452  D570 00FF                            AND,R5   255,IMO
          1 000454  DF47 005C                            STR,R5   KNA_GCHAN+11,AUTO

      561    17896    2           CALL KNB$GETRESP (ADDR(KNA_GCHAN),SIZEC(KNA_GCHAN.KL_ACQUIRE),

  17896   1 000456  BBC7 0051                            LAB,B3   KNA_GCHAN,AUTO
          1 000458  BFC7 0066                            STB,B3   KNA_RCHAN+9,AUTO
          1 00045A  ABF0 0018                            LAB,B2   24,IMO
          1 00045C  9BC7 0051                            LAB,B1   KNA_GCHAN,AUTO
          1 00045E  9FC7 0068                            STB,B1   KNA_RCHAN+11,AUTO
          1 000460  EBF0 0018                            LAB,B6   24,IMO
          1 000462  EFC7 0070                            STB,B6   KNA_RCHAN+19,AUTO
          1 000464  EBC7 0068                            LAB,B6   KNA_RCHAN+11,AUTO
          1 000466  EFC7 006E                            STB,B6   KNA_RCHAN+17,AUTO
          1 000468  AFC7 006C                            STB,B2   KNA_RCHAN+15,AUTO
          1 00046A  EBC7 0066                            LAB,B6   KNA_RCHAN+9,AUTO
          1 00046C  EFC7 006A                            STB,B6   KNA_RCHAN+13,AUTO
          1 00046E  BBC7 006A                            LAB,B3   KNA_RCHAN+13,AUTO
          1 000470  CBF0 0400                            LAB,B4   1024,IMO
          1 000472  E380 0000 0000  xent                 LNJ,B6   KNB$GETRESP
          1 000475       0001                            DC       s:17898,PREL
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:94   

      562    17897    2                ADDR(KNA_GCHAN),SIZEC(KNA_GCHAN.KL_ACQUIRE));
      563    17898    2           VLR$GCHAN.CHANNEL=KNA_GCHAN.KL_ACQUIRE.CHAN;

  17898   1 000476  ECC7 0010                            LDB,B6   GCHAN$,AUTO
          1 000478  E847 0052                            LDR,R6   KNA_GCHAN+1,AUTO
          1 00047A  EF06                                 STR,R6   ,B6

      564    17899    2           IF FPT$GCHAN_V.FLAGS.HIGHLOW THEN

  17899   1 00047B  DCC7 0008                            LDB,B5   V$,AUTO
          1 00047D  82C5 0003                            LB,'2000'X        3,B5
          1 00047F       2000
          1 000480  0581 0009                            BBF      s:17904,PREL

      565    17900    3           DO;

      566    17901    3                VLR$GCHAN.HIGHCHAN=KNA_GCHAN.KL_ACQUIRE.HIGHCHAN;

  17901   1 000482  D847 0053                            LDR,R5   KNA_GCHAN+2,AUTO
          1 000484  DF46 0001                            STR,R5   1,B6

      567    17902    3                VLR$GCHAN.LOWCHAN=KNA_GCHAN.KL_ACQUIRE.LOWCHAN;

  17902   1 000486  C847 0054                            LDR,R4   KNA_GCHAN+3,AUTO
          1 000488  CF46 0002                            STR,R4   2,B6

      568    17903    3                END;

      569    17904    2           VLR$GCHAN.DVCID=BITBIN(KNA_GCHAN.KL_ACQUIRE.DVCID);

  17904   1 00048A  D847 0055                            LDR,R5   KNA_GCHAN+4,AUTO
          1 00048C  DF46 0003                            STR,R5   3,B6

      570    17905    2           VLR$GCHAN.EXTDVCID=BITBIN(KNA_GCHAN.KL_ACQUIRE.EXTDVCID);

  17905   1 00048E  C847 0056                            LDR,R4   KNA_GCHAN+5,AUTO
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:95   
          1 000490  CF46 0004                            STR,R4   4,B6

      571    17906    2           KID_PARAMS.ERR=KNA_GCHAN.KL_ACQUIRE.ERRCODE;

  17906   1 000492  8CC7 005A                            LDI      KNA_GCHAN+9,AUTO
          1 000494  CCC7 0004                            LDB,B4   @KID_PARAMS,AUTO
          1 000496  8D44 0003                            SDI      3,B4

      572    17907    2           RETURN;

  17907   1 000498  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      573    17908              %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:96   
      574    17909        /*
      575    17910                           M$RCHAN
      576    17911                                                                                      */
      577    17912    2        CASE(%G_MCL_RCHAN#);

      578    17913
      579    17914                %UNLOCK (G=KNA_LNKSSN);

  17919   1 00049B  BB80 0000 0000  02                   LAB,B3   0
          1 00049E  CBF0 0100                            LAB,B4   256,IMO
          1 0004A0  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 0004A3       0001                            DC       s:17921,PREL

      580    17921    2           KNA_RCHAN.KL_RELEASE.CODE = IGA_LINE_RELEASE;

  17921   1 0004A4  6C2B                                 LDV,R6   43
          1 0004A5  E7C7 005D                            STH,R6   KNA_RCHAN,AUTO

      581    17922    2           KNA_RCHAN.KL_RELEASE.CHAN=FPT$RCHAN_V.CHANNEL;

  17922   1 0004A7  ECC7 0008                            LDB,B6   V$,AUTO
          1 0004A9  D806                                 LDR,R5   ,B6
          1 0004AA  DF47 005E                            STR,R5   KNA_RCHAN+1,AUTO

      582    17923    2           KNA_RCHAN.KL_RELEASE.CONTROLLER=FPT$RCHAN_V.CONTROLLER;

  17923   1 0004AC  C846 0001                            LDR,R4   1,B6
          1 0004AE  CAC7 005F                            SRM,R4,'8000'X    KNA_RCHAN+2,AUTO
          1 0004B0       8000

      583    17924    2           KNA_RCHAN.KL_RELEASE.USER#=G$JIT.USR#;

  17924   1 0004B1  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0004B4  C845 0004                            LDR,R4   4,B5
          1 0004B6  C570 00FF                            AND,R4   255,IMO
          1 0004B8  CF47 0060                            STR,R4   KNA_RCHAN+3,AUTO

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:97   
      584    17925    2           CALL KNB$GETRESP (ADDR(KNA_RCHAN),SIZEC(KNA_RCHAN.KL_RELEASE),

  17925   1 0004BA  CBC7 005D                            LAB,B4   KNA_RCHAN,AUTO
          1 0004BC  CFC7 0066                            STB,B4   KNA_RCHAN+9,AUTO
          1 0004BE  BBF0 000C                            LAB,B3   12,IMO
          1 0004C0  ABC7 005D                            LAB,B2   KNA_RCHAN,AUTO
          1 0004C2  AFC7 0068                            STB,B2   KNA_RCHAN+11,AUTO
          1 0004C4  9BF0 000C                            LAB,B1   12,IMO
          1 0004C6  9FC7 0070                            STB,B1   KNA_RCHAN+19,AUTO
          1 0004C8  EBC7 0068                            LAB,B6   KNA_RCHAN+11,AUTO
          1 0004CA  EFC7 006E                            STB,B6   KNA_RCHAN+17,AUTO
          1 0004CC  BFC7 006C                            STB,B3   KNA_RCHAN+15,AUTO
          1 0004CE  EBC7 0066                            LAB,B6   KNA_RCHAN+9,AUTO
          1 0004D0  EFC7 006A                            STB,B6   KNA_RCHAN+13,AUTO
          1 0004D2  BBC7 006A                            LAB,B3   KNA_RCHAN+13,AUTO
          1 0004D4  CBF0 0400                            LAB,B4   1024,IMO
          1 0004D6  E380 0000 0000  xent                 LNJ,B6   KNB$GETRESP
          1 0004D9       0001                            DC       s:17927,PREL

      585    17926    2                ADDR(KNA_RCHAN),SIZEC(KNA_RCHAN.KL_RELEASE));
      586    17927    2           KID_PARAMS.ERR=KNA_RCHAN.KL_RELEASE.ERRCODE;

  17927   1 0004DA  8CC7 0061                            LDI      KNA_RCHAN+4,AUTO
          1 0004DC  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 0004DE  8D46 0003                            SDI      3,B6

      587    17928    2           RETURN;

  17928   1 0004E0  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      588    17929
      589    17930        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:98   
      590    17931    2        CASE(%G_MCL_DEVICE#);

      591    17932    2           K$RWPARM.DVE.DVBYTE = %G_DVBYTE_VFC#|%G_DVBYTE_TRANS#|%G_DVBYTE_BP#;

  17932   1 0004E3  E870 D000                            LDR,R6   -12288,IMO
          1 0004E5  6048                                 SOR,R6   8
          1 0004E6  E7C7 0031                            STH,R6   K$RWPARM+15,AUTO

      592    17933    2           IF K$RWPARM.MSG$~=ADDR(NIL)

  17933   1 0004E8  8DC7 0022                            CMN      K$RWPARM,AUTO
          1 0004EA  0901 0048                            BE       s:17952,PREL

      593    17934    3           THEN DO;

      594    17935    3                IF MYDCB.TAB$=ADDR(NIL)

  17935   1 0004EC  DCC7 0006                            LDB,B5   DCB$,AUTO
          1 0004EE  8DC5 0028                            CMN      40,B5
          1 0004F0  0981 0023                            BNE      s:17947,PREL

      595    17936    3                THEN CALL GFS$GSP(SIZEW(VLP$TAB),MYDCB.TAB$,KID_PARAMS.ERR)

  17936   1 0004F2  CBF0 0010                            LAB,B4   16,IMO
          1 0004F4  BBC6 0003                            LAB,B3   3,B6
          1 0004F6  BFC7 006A                            STB,B3   KNA_RCHAN+13,AUTO
          1 0004F8  ABC5 0028                            LAB,B2   40,B5
          1 0004FA  AFC7 0068                            STB,B2   KNA_RCHAN+11,AUTO
          1 0004FC  CFC7 0066                            STB,B4   KNA_RCHAN+9,AUTO
          1 0004FE  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000500  CBF0 0300                            LAB,B4   768,IMO
          1 000502  E380 0000 0000  xent                 LNJ,B6   GFS$GSP
          1 000505       0003                            DC       s:17943,PREL
          1 000506  0F81 000D                            B        s:17947,PREL

      596    17937    4                     WHENALTRETURN DO;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:99   
      597    17938                               %UNLOCK (G=KNA_LNKSSN);

  17943   1 000508  BB80 0000 0000  02                   LAB,B3   0
          1 00050B  CBF0 0100                            LAB,B4   256,IMO
          1 00050D  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 000510       0001                            DC       s:17945,PREL

      598    17945    4                          RETURN;

  17945   1 000511  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      599    17946    4                          END;
      600    17947    3                MYDCB.TAB$->VLP$TAB='0'B;

  17947   1 000514  ECC7 0006                            LDB,B6   DCB$,AUTO
          1 000516  DCC6 0028                            LDB,B5   40,B6
          1 000518  5C20                                 LDV,R5   32
          1 000519  0021                                 ALR      ;
          1 00051A       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 00051C       4005 0000                                ALPHANUM(0,B5,,R5,FILL)

      601    17948    3                IF K$RWPARM.MSGSZ>32 THEN K$RWPARM.MSGSZ =32;

  17948   1 00051E  437F                                 CSYNC    s:17947+9,SPREL
          1 00051F  E847 0024                            LDR,R6   K$RWPARM+2,AUTO
          1 000521  6D20                                 CMV,R6   32
          1 000522  0A81 0004                            BALE     s:17949,PREL

  17948   1 000524  6C20                                 LDV,R6   32
          1 000525  EF47 0024                            STR,R6   K$RWPARM+2,AUTO

      602    17949    3                MYDCB.TAB$->B$MSG =K$RWPARM.MSG$->B$MSG;

  17949   1 000527  ECC7 0006                            LDB,B6   DCB$,AUTO
          1 000529  DCC6 0028                            LDB,B5   40,B6
          1 00052B  ACC7 0022                            LDB,B2   K$RWPARM,AUTO
          1 00052D  2C00                                 LDV,R2   0
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:100  
          1 00052E  BB85                                 LAB,B3   ,B5
          1 00052F  3C00                                 LDV,R3   0
          1 000530  0008                                 MMM

      603    17950    3                END;

  17950   1 000531  0F81 0014                            B        s:17957,PREL

      604    17951    2           ELSE
      605    17952    2                IF KID_PARAMS.BND.PAR2 = 1 /* Erase                              */

  17952   1 000533  E846 0027                            LDR,R6   39,B6
          1 000535  6D01                                 CMV,R6   1
          1 000536  0981 000F                            BNE      s:17957,PREL

      606    17953    3                THEN DO;

      607    17954    3                     IF MYDCB.TAB$~=ADDR(NIL) THEN

  17954   1 000538  DCC7 0006                            LDB,B5   DCB$,AUTO
          1 00053A  8DC5 0028                            CMN      40,B5
          1 00053C  0901 0009                            BE       s:17957,PREL

      608    17955    3                          MYDCB.TAB$->VLP$TAB='0'B;

  17955   1 00053E  CCC5 0028                            LDB,B4   40,B5
          1 000540  5C20                                 LDV,R5   32
          1 000541  0021                                 ALR      ;
          1 000542       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 000544       4004 0000                                ALPHANUM(0,B4,,R5,FILL)

      609    17956    3                     END;

      610    17957    2           IF MYDCB.TAB$ ~= ADDR(NIL)

  17957   1 000546  437F                                 CSYNC    s:17955+7,SPREL
          1 000547  ECC7 0006                            LDB,B6   DCB$,AUTO
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:101  
          1 000549  8DC6 0028                            CMN      40,B6
          1 00054B  0901 000E                            BE       s:17967,PREL

      611    17958    3           THEN DO;

      612    17959    3                K$RWPARM.MSG$ = MYDCB.TAB$;

  17959   1 00054D  DCC6 0028                            LDB,B5   40,B6
          1 00054F  DFC7 0022                            STB,B5   K$RWPARM,AUTO

      613    17960    3                K$RWPARM.MSGSZ = SIZEC(VLP$TAB);

  17960   1 000551  6C20                                 LDV,R6   32
          1 000552  EF47 0024                            STR,R6   K$RWPARM+2,AUTO

      614    17961    3                PRM.TL.TYPE = %KV_PRMID_INPTAB;

  17961   1 000554  5C15                                 LDV,R5   21
          1 000555  D7C7 004B                            STH,R5   PRM,AUTO

      615    17962    3                CALL SET_PARAM;

  17962   1 000557  E3C0 00DA                            LNJ,B6   s:0,PREL
          1 000559       0001                            DC       s:17967,PREL

      616    17963    3                END;

      617    17964
      618    17965        /* Do header */
      619    17966
      620    17967    2           IF KID_PARAMS.PTRS.PAR3$ ~= ADDR(NIL)

  17967   1 00055A  ECC7 0004                            LDB,B6   @KID_PARAMS,AUTO
          1 00055C  8DC6 000A                            CMN      10,B6
          1 00055E  0901 0016                            BE       s:17975,PREL

      621    17968    3           THEN DO;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:102  

      622    17969    3                K$RWPARM.MSGSZ = KID_PARAMS.BND.PAR3+1;

  17969   1 000560  E846 0028                            LDR,R6   40,B6
          1 000562  6E01                                 ADV,R6   1
          1 000563  EF47 0024                            STR,R6   K$RWPARM+2,AUTO

      623    17970    3                IF K$RWPARM.MSGSZ>165 THEN K$RWPARM.MSGSZ =165;

  17970   1 000565  E970 00A5                            CMR,R6   165,IMO
          1 000567  0A81 0005                            BALE     s:17971,PREL

  17970   1 000569  E870 00A5                            LDR,R6   165,IMO
          1 00056B  EF47 0024                            STR,R6   K$RWPARM+2,AUTO

      624    17971    3                PRM.TL.TYPE = %KV_PRMID_SSNHDR;

  17971   1 00056D  5C11                                 LDV,R5   17
          1 00056E  D7C7 004B                            STH,R5   PRM,AUTO

      625    17972    3                CALL SET_PARAM;

  17972   1 000570  E3C0 00C1                            LNJ,B6   s:0,PREL
          1 000572       0001                            DC       s:17973,PREL

      626    17973    3                END;

  17973   1 000573  0F81 0014                            B        s:17983,PREL

      627    17974    2           ELSE
      628    17975    2                IF KID_PARAMS.BND.PAR3 = 1

  17975   1 000575  E846 0028                            LDR,R6   40,B6
          1 000577  6D01                                 CMV,R6   1
          1 000578  0981 000F                            BNE      s:17983,PREL

      629    17976    3                THEN DO;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:103  

      630    17977    3                     K$RWPARM.MSG$=ADDR(NULLHDR);

  17977   1 00057A  DB80 0000 0000  00                   LAB,B5   NULLHDR
          1 00057D  DFC7 0022                            STB,B5   K$RWPARM,AUTO

      631    17978    3                     K$RWPARM.MSGSZ=SIZEC(NULLHDR);

  17978   1 00057F  5C02                                 LDV,R5   2
          1 000580  DF47 0024                            STR,R5   K$RWPARM+2,AUTO

      632    17979    3                     PRM.TL.TYPE = %KV_PRMID_SSNHDR;

  17979   1 000582  4C11                                 LDV,R4   17
          1 000583  C7C7 004B                            STH,R4   PRM,AUTO

      633    17980    3                     CALL SET_PARAM;

  17980   1 000585  E3C0 00AC                            LNJ,B6   s:0,PREL
          1 000587       0001                            DC       s:17983,PREL

      634    17981    3                     END;

      635    17982        /**/
      636    17983    2           IF FPT$DEVICE.V.LINES~=0 THEN

  17983   1 000588  ECC7 0008                            LDB,B6   V$,AUTO
          1 00058A  82C6 0004                            LB,'00FF'X        4,B6
          1 00058C       00FF
          1 00058D  0581 0009                            BBF      s:17985,PREL

      637    17984    2                MYDCB.LINES= FPT$DEVICE.V.LINES;

  17984   1 00058F  DCC7 0006                            LDB,B5   DCB$,AUTO
          1 000591  E846 0004                            LDR,R6   4,B6
          1 000593  E570 00FF                            AND,R6   255,IMO
          1 000595  EF45 0023                            STR,R6   35,B5
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:104  

      638    17985    3           DO CASE(ADDR(FPT$DEVICE.V.DVFC)->NK$VFC.FCN);

  17985   1 000597  B846 0003                            LDR,R3   3,B6
          1 000599  3044                                 SOR,R3   4
          1 00059A  B570 0007                            AND,R3   7,IMO
          1 00059C  3D08                                 CMV,R3   8
          1 00059D  0281 0031                            BGE      s:17999,PREL
          1 00059F  A830 0000 05A5  01                   LDR,R2   s:17985+14,R3
          1 0005A2  83A0 0000 05AD  01                   JMP      s:17987,R2
          1 0005A5       0022                            DC       s:17999,PREL
          1 0005A6       0009                            DC       s:17989,PREL
          1 0005A7       0022                            DC       s:17999,PREL
          1 0005A8       0000                            DC       s:17987,PREL
          1 0005A9       0000                            DC       s:17987,PREL
          1 0005AA       0000                            DC       s:17987,PREL
          1 0005AB       0000                            DC       s:17987,PREL
          1 0005AC       0000                            DC       s:17987,PREL

      639    17986    3           CASE(%VFCF_SPB,%VFCF_SPA,%VFCF_SKB,%VFCF_SKA,%VFCF_HDR);

      640    17987    3              MYDCB.DVFC=FPT$DEVICE.V.DVFC;

  17987   1 0005AD  E846 0003                            LDR,R6   3,B6
          1 0005AF  DCC7 0006                            LDB,B5   DCB$,AUTO
          1 0005B1  EAC5 0024                            SRM,R6,'00FF'X    36,B5
          1 0005B3       00FF
          1 0005B4  0F81 001A                            B        s:17999,PREL

      641    17988    3           CASE(%VFCF_SPC);

      642    17989    4              DO CASE(ADDR(FPT$DEVICE.V.DVFC)->NK$VFC.COUNT);

  17989   1 0005B6  9846 0003                            LDR,R1   3,B6
          1 0005B8  9570 000F                            AND,R1   15,IMO
          1 0005BA  1EF2                                 ADV,R1   -14
          1 0005BB  1D02                                 CMV,R1   2
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:105  
          1 0005BC  0281 0012                            BGE      s:17999,PREL
          1 0005BE  B810 0000 05C4  01                   LDR,R3   s:17989+14,R1
          1 0005C1  83B0 0000 05C6  01                   JMP      s:17991,R3
          1 0005C4       0000                            DC       s:17991,PREL
          1 0005C5       0000                            DC       s:17991,PREL

      643    17990    4              CASE(%VFCS_TRS0,%VFCS_TRS1);

      644    17991    4                 MYDCB.DVFC=FPT$DEVICE.V.DVFC;

  17991   1 0005C6  E846 0003                            LDR,R6   3,B6
          1 0005C8  DCC7 0006                            LDB,B5   DCB$,AUTO
          1 0005CA  EAC5 0024                            SRM,R6,'00FF'X    36,B5
          1 0005CC       00FF
          1 0005CD  0F81 0001                            B        s:17999,PREL

      645    17992    4              CASE(ELSE);                  /* ALL OTHERS NO GOOD; IGNORE         */

      646    17993    4                 END;

      647    17994    3           CASE(ELSE);

      648    17995                                                /* All others illegal; ignore.        */
      649    17996    3              END;

      650    17997
      651    17998        /* Send new page if needed */
      652    17999    2           K$RWPARM.MSG$ = ADDR(NIL);

  17999   1 0005CF  DB80 0000 0000                       LAB,B5   0
          1 0005D2  DFC7 0022                            STB,B5   K$RWPARM,AUTO

      653    18000    2           K$RWPARM.MSGSZ = 0;

  18000   1 0005D4  8747 0024                            CL       K$RWPARM+2,AUTO

      654    18001    2           K$RWPARM.DVE.DVBYTE.TRANS = '0'B;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:106  

  18001   1 0005D6  8847 0031                            LBF,'1000'X       K$RWPARM+15,AUTO
  18001   1 0005D8       1000

      655    18002    3           IF FPT$DEVICE.V.PAGE THEN DO;

  18002   1 0005D9  8286                                 LB,'0020'X        ,B6
  18002   1 0005DA       0020
          1 0005DB  0581 0010                            BBF      s:18008,PREL

      656    18003    3                K$RWPARM.DVE.DVBYTE.VFC = '1'B;

  18003   1 0005DD  8947 0031                            LBT,'4000'X       K$RWPARM+15,AUTO
  18003   1 0005DF       4000

      657    18004    3                K$RWPARM.DVE.VFC = %VFC_PGND;

  18004   1 0005E0  6C1A                                 LDV,R6   26
          1 0005E1  EAC7 0031                            SRM,R6,'00FF'X    K$RWPARM+15,AUTO
          1 0005E3       00FF

      658    18005    3                VDOTYP = %KV_VDO_FNC_DAT;

  18005   1 0005E4  5C05                                 LDV,R5   5
          1 0005E5  DF47 0050                            STR,R5   VDOTYP,AUTO

      659    18006    3                CALL CALL_FCNOU;

  18006   1 0005E7  E3C0 0061                            LNJ,B6   s:0,PREL
          1 0005E9       0001                            DC       s:18007,PREL

      660    18007    3                END;

  18007   1 0005EA  0F81 003B                            B        s:18023,PREL

      661    18008    2           ELSE IF MYDCB.ORG = %G_ORG_FORM#

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:107  
  18008   1 0005EC  CCC7 0006                            LDB,B4   DCB$,AUTO
          1 0005EE  E844 001F                            LDR,R6   31,B4
          1 0005F0  E570 00FF                            AND,R6   255,IMO
          1 0005F2  6D02                                 CMV,R6   2
          1 0005F3  0981 0032                            BNE      s:18023,PREL

      662    18009    3                THEN DO;

      663    18010    3                     VDOTYP = %KV_VDO_FNC_UPDRELDVC;

  18010   1 0005F5  5C1E                                 LDV,R5   30
          1 0005F6  DF47 0050                            STR,R5   VDOTYP,AUTO

      664    18011    3                     CALL CALL_FCNOU;

  18011   1 0005F8  E3C0 0050                            LNJ,B6   s:0,PREL
          1 0005FA       0001                            DC       s:18012,PREL

      665    18012    3                     END;

  18012   1 0005FB  0F81 002A                            B        s:18023,PREL

      666    18013    2        CASE(%G_MCL_WRTMLT#);

      667    18014    2           K$RWPARM.UHDR$ = K$RWPARM.MSG$;

  18014   1 0005FD  DCC7 0022                            LDB,B5   K$RWPARM,AUTO
          1 0005FF  DFC7 0039                            STB,B5   K$RWPARM+23,AUTO

      668    18015    2           K$RWPARM.UHDRSZ = K$RWPARM.MSGSZ;

  18015   1 000601  E847 0024                            LDR,R6   K$RWPARM+2,AUTO
          1 000603  EF47 003B                            STR,R6   K$RWPARM+25,AUTO

      669    18016    2           K$RWPARM.MSG$ = ADDR(NIL);

  18016   1 000605  CB80 0000 0000                       LAB,B4   0
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:108  
          1 000608  CFC7 0022                            STB,B4   K$RWPARM,AUTO

      670    18017    2           K$RWPARM.MSGSZ = 0;

  18017   1 00060A  8747 0024                            CL       K$RWPARM+2,AUTO

      671    18018    2           CALL KNA$CHECK_VDO (K$RWPARM,KID_PARAMS.ERR) ALTRET (DONE);

  18018   1 00060C  BBC6 0003                            LAB,B3   3,B6
          1 00060E  BFC7 0068                            STB,B3   KNA_RCHAN+11,AUTO
          1 000610  ABC7 0022                            LAB,B2   K$RWPARM,AUTO
          1 000612  AFC7 0066                            STB,B2   KNA_RCHAN+9,AUTO
          1 000614  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 000616  CBF0 0200                            LAB,B4   512,IMO
          1 000618  E380 0000 0000  xent                 LNJ,B6   KNA$CHECK_VDO
          1 00061B       000B                            DC       s:18023,PREL

      672    18019    2           VDOTYP = 0;

  18019   1 00061C  8747 0050                            CL       VDOTYP,AUTO

      673    18020    2           CALL CALL_FCNOU ALTRET (DONE);

  18020   1 00061E  E3C0 002A                            LNJ,B6   s:0,PREL
          1 000620       0006                            DC       s:18023,PREL

      674    18021    2           K$RWPARM.DVE.DVBYTE.RRR = '1'B;

  18021   1 000621  8947 0031                            LBT,'0800'X       K$RWPARM+15,AUTO
  18021   1 000623       0800

      675    18022    2           GOTO WAIT_RRR;

  18022   1 000624  0F81 FAF3                            B        s:17587,PREL

      676    18023    2           END;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:109  
  18017   1                              DONE            null
      677    18024
      678    18025    1   DONE:;
      679    18026             %UNLOCK (G=KNA_LNKSSN);

  18031   1 000626  BB80 0000 0000  02   DONE            LAB,B3   0
          1 000629  CBF0 0100                            LAB,B4   256,IMO
          1 00062B  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 00062E       0001                            DC       s:18033,PREL

      680    18033    1        RETURN;

  18033   1 00062F  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      681    18034        %EJECT;
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:110  
      682    18035    1   SET_PARAM: PROC ALTRET;

  18035   1 000632  EFC7 0064            SET_PARAM       STB,B6   KNA_RCHAN+7,AUTO

      683    18036    2        PRM.TL.LEN=K$RWPARM.MSGSZ;

  18036   1 000634  E847 0024                            LDR,R6   K$RWPARM+2,AUTO
          1 000636  EAC7 004B                            SRM,R6,'00FF'X    PRM,AUTO
          1 000638       00FF

      684    18037    2        K$RWPARM.V$ = ADDR(PRM);

  18037   1 000639  DBC7 004B                            LAB,B5   PRM,AUTO
          1 00063B  DFC7 0043                            STB,B5   K$RWPARM+33,AUTO

      685    18038    2        K$RWPARM.VSZ = LENGTHC(PRM.TL);

  18038   1 00063D  5C02                                 LDV,R5   2
          1 00063E  DF47 0047                            STR,R5   K$RWPARM+37,AUTO
          1 000640  0F81 0003                            B        s:18040,PREL

      686    18039    2   SET_PARAM1: ENTRY ALTRET;

  18039   1 000642  EFC7 0064            SET_PARAM1      STB,B6   KNA_RCHAN+7,AUTO

      687    18040    2        VDOTYP = %KV_VDO_FNC_PRM_SET;

  18040   1 000644  6C13                                 LDV,R6   19
          1 000645  EF47 0050                            STR,R6   VDOTYP,AUTO
          1 000647  0F81 0003                            B        s:18042,PREL

      688    18041    2   CALL_FCNOU: ENTRY ALTRET;

  18041   1 000649  EFC7 0064            CALL_FCNOU      STB,B6   KNA_RCHAN+7,AUTO

      689    18042    2        CALL KNA$FCNOU (VDOTYP,KNA$SSN,K$RWPARM,KID_PARAMS.ERR)

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:111  
  18042   1 00064B  DCC7 0004                            LDB,B5   @KID_PARAMS,AUTO
          1 00064D  CBC5 0003                            LAB,B4   3,B5
          1 00064F  CFC7 006C                            STB,B4   KNA_RCHAN+15,AUTO
          1 000651  BBC7 0022                            LAB,B3   K$RWPARM,AUTO
          1 000653  BFC7 006A                            STB,B3   KNA_RCHAN+13,AUTO
          1 000655  ACC7 000C                            LDB,B2   SSN$,AUTO
          1 000657  AFC7 0068                            STB,B2   KNA_RCHAN+11,AUTO
          1 000659  9BC7 0050                            LAB,B1   VDOTYP,AUTO
          1 00065B  9FC7 0066                            STB,B1   KNA_RCHAN+9,AUTO
          1 00065D  BBC7 0066                            LAB,B3   KNA_RCHAN+9,AUTO
          1 00065F  CBF0 0400                            LAB,B4   1024,IMO
          1 000661  E380 0000 0000  xent                 LNJ,B6   KNA$FCNOU
          1 000664       0003                            DC       s:18044,PREL
          1 000665  0F81 0005                            B        s:18046,PREL

      690    18043    3        WHENALTRETURN DO;

      691    18044    3             ALTRETURN;

  18044   1 000667  ECC7 0064                            LDB,B6   KNA_RCHAN+7,AUTO
          1 000669  B806                                 LDR,R3   ,B6
          1 00066A  C3B6                                 LNJ,B4   ,B6,R3

      692    18045    3             END;
      693    18046    2   END SET_PARAM;

  18046   1 00066B  ECC7 0064                            LDB,B6   KNA_RCHAN+7,AUTO
          1 00066D  C3C6 0001                            LNJ,B4   1,B6
      694    18047    1   END KNA$MCL;

PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:112  
--  Include file information  --

   KNA_MACRO_M.:E05TOU  is referenced.
   KN_DATA_M.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   GH_SCHD_E.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   GH_GATE_M.:E05TOU  cannot be made into a system file and is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
      No diagnostics issued in procedure KNA$MCL.
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:113  

 **** Variables and constants ****

  ****  Section 000 RoData KNA$MCL

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w STRC(32)    r     1 E$INVALID_DCB              B-0-0/w STRC(32)    r     1 E$NOT_FORM
     5-0-0/w STRC(32)    r     1 E$NOT_OPEN                 D-0-0/w STRC(32)    r     1 E$NOT_TS
     7-0-0/w STRC(32)    r     1 ENO_IOP                    9-0-0/w STRC(32)    r     1 ERROR_TND
     0-0-0/b UBIN(8)     r     1 NULLHDR(0:1)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KID_PARAMS                6-0-0/w PTR         r     1 DCB$
    4F-0-0/w UBIN(16)    r     1 DCBNUMBER                 10-0-0/w PTR         r     1 GCHAN$
     E-0-0/w PTR         r     1 IOP$                      22-0-0/w STRC(656)   r     1 K$RWPARM
    *0-0-0/w STRC(1280)  r     1 KID_PARAMS                51-0-0/w STRC(192)   r     1 KNA_GCHAN
    5D-0-0/w STRC(96)    r     1 KNA_RCHAN                 4B-0-0/b STRC(16)    r     1 PRM
    4C-0-0/c STRC(40)    r     1 PROMPT                     C-0-0/w PTR         r     1 SSN$
     8-0-0/w PTR         r     1 V$                        50-0-0/w UBIN(16)    r     1 VDOTYP
     A-0-0/w PTR         r     1 VLP$                      12-0-0/w STRC(256)   r     1 WINDOW

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$JIT$                     0-0-0/w PTR         r     1 G$ROS$
     0-0-0/w STRC(48)    r     1 KNA_LNKSSN                 0-0-0/w STRC(656)   r     1 KNA_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:114  
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 B$MSG                      0-0-0/c STRC(272)   r     1 B$PROMPT
     0-0-0/w STRC(304)   r     1 EOM                        0-0-0/w STRC(80)    r     1 FPT$DCLFLD_V
     0-0-0/w STRC(96)    r     1 FPT$DEVICE                 0-0-0/w STRC(48)    r     1 FPT$EOM_V
     0-0-0/w STRC(48)    r     1 FPT$ERASE_V                0-0-0/w STRC(72)    r     1 FPT$GCHAN_V
     0-0-0/w STRC(48)    r     1 FPT$MDFFLD_V               0-0-0/w STRC(32)    r     1 FPT$PROMPT_V
     0-0-0/w STRC(48)    r     1 FPT$RCHAN_V                0-0-0/w STRC(32)    r     1 FPT$SINPUT_V
     0-0-0/w STRC(32)    r     1 FPT$TRMCTL_V
     0-0-0/w PTR         r     1 G$DCBTABLE(0:0)
     0-0-0/w STRC(5616)  r     1 G$JIT                      0-0-0/w STRC(928)   r     1 G$ROS
     0-0-0/w STRC(432)   r     1 KN$IOP                     0-0-0/w STRC(400)   r     1 KNA$SSN
     0-0-0/w ASTR(808)   r     1 MYDCB                      0-0-0/c STRC(8)     r     1 NK$VFC
     0-0-0/w STRC(56)    r     1 SINPUT                     0-0-0/w STRC(256)   r     1 VLP$TAB
     0-0-0/w STRC(128)   r     1 VLR$GCHAN


   Procedure KNA$MCL requires 1647 words for executable code.
   Procedure KNA$MCL requires 114 words of local(AUTO) storage.

    No errors detected in file KNA$MCL.:E05TSI    .
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:115  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:116  
          MINI XREF LISTING

B$MSG
     17015**DCL     17678<<ASSIGN  17678>>ASSIGN  17858<<ASSIGN  17858>>ASSIGN  17949<<ASSIGN  17949>>ASSIGN
B$PROMPT.DVBYTE
     17019**DCL     17855>>ASSIGN
CALL_FCNOU IN PROCEDURE SET_PARAM
     18041**ENTRY   17590--CALL    17624--CALL    17723--CALL    17848--CALL    18006--CALL    18011--CALL
     18020--CALL
DCB$
     16600**DCL     15996--IMP-PTR 17522<<ASSIGN  17524>>IF      17534>>IF      17547>>ASSIGN  17549>>ASSIGN
     17551>>ASSIGN  17582>>IF      17603>>ASSIGN  17621>>IF      17842>>ASSIGN  17843<>CALL    17851>>IF
     17854>>ASSIGN  17858>>ASSIGN  17860>>ASSIGN  17935>>IF      17936>>CALL    17947>>ASSIGN  17949>>ASSIGN
     17954>>IF      17955>>ASSIGN  17957>>IF      17959>>ASSIGN  17984>>ASSIGN  17987>>ASSIGN  17991>>ASSIGN
     18008>>IF
DCBNUMBER
     17025**DCL     17510<<ASSIGN  17511>>IF      17511>>IF      17522>>ASSIGN
DONE
     18017**LABEL   17585--GOTO    17590--CALLALT 17597--GOTO    17624--CALLALT 17632--GOTO    17679--CALLALT
     17838--GOTO    18018--CALLALT 18020--CALLALT
E$INVALID_DCB
     17233**DCL     17518>>ASSIGN
E$NOT_FORM
     17421**DCL     17584>>ASSIGN
E$NOT_OPEN
     17280**DCL     17530>>ASSIGN
E$NOT_TS
     17468**DCL     17544>>ASSIGN
ENO_IOP
     17327**DCL     17596>>ASSIGN  17837>>ASSIGN
EOM
     16983**DCL     17709--ASSIGN
EOM.DMN
     16983**DCL     17710<<ASSIGN
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:117  
EOM.SUPPHALT
     16983**DCL     17711<<ASSIGN
EOM.TABLE
     16984**DCL     17709--ASSIGN
EOM.TIMEOUT
     16984**DCL     17713<<ASSIGN
EOM.UTYPE
     16984**DCL     17712<<ASSIGN
ERROR_TND
     17374**DCL     17880>>ASSIGN
FORM_COMMON
     17654**LABEL   17641--GOTO    17648--GOTO
FORM_VDO
     17580**LABEL   17633--GOTO    17664--GOTO
FPT$DCLFLD_V.DVBYTE
     16286**DCL     17579>>ASSIGN
FPT$DEVICE.V.DVFC
     16401**DCL     17985--DOCASE  17987>>ASSIGN  17989--DOCASE  17991>>ASSIGN
FPT$DEVICE.V.LINES
     16402**DCL     17983>>IF      17984>>ASSIGN
FPT$DEVICE.V.PAGE
     16399**DCL     18002>>IF
FPT$EOM_V.SUPPHALT
     16081**DCL     17711>>ASSIGN
FPT$EOM_V.TIMEOUT
     16082**DCL     17713>>ASSIGN
FPT$EOM_V.UTYPE
     16081**DCL     17712>>ASSIGN
FPT$ERASE_V.DVBYTE
     16350**DCL     17659>>ASSIGN
FPT$ERASE_V.KEYTYPE
     16354**DCL     17656>>IF      17658>>ASSIGN
FPT$GCHAN_V.ATTR
     16365**DCL     17891>>ASSIGN
FPT$GCHAN_V.CHANNEL
     16365**DCL     17889>>ASSIGN
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:118  
FPT$GCHAN_V.FLAGS.CONTROLLER
     16365**DCL     17893>>ASSIGN
FPT$GCHAN_V.FLAGS.DIAG
     16365**DCL     17892>>ASSIGN
FPT$GCHAN_V.FLAGS.HIGHLOW
     16365**DCL     17894>>ASSIGN  17899>>IF
FPT$GCHAN_V.RES
     16365**DCL     17890>>ASSIGN
FPT$MDFFLD_V.DVBYTE
     16302**DCL     17615>>ASSIGN
FPT$MDFFLD_V.KEYTYPE
     16306**DCL     17612>>IF      17614>>ASSIGN
FPT$MDFFLD_V.SETGRPRND
     16307**DCL     17621>>IF
FPT$MDFFLD_V.SETQLF
     16307**DCL     17621>>IF      17628>>IF
FPT$PROMPT_V.DVBYTE
     16068**DCL     17692>>ASSIGN  17855<<ASSIGN
FPT$PROMPT_V.DVBYTE.VFC
     16068**DCL     17695>>IF      17856>>IF
FPT$RCHAN_V.CHANNEL
     16376**DCL     17922>>ASSIGN
FPT$RCHAN_V.CONTROLLER
     16376**DCL     17923>>ASSIGN
FPT$SINPUT_V.POSITION
     16266**DCL     17758>>IF
FPT$SINPUT_V.REREADPOS
     16271**DCL     17763>>ASSIGN
FPT$TRMCTL_V.DCB#
     16036**DCL     17510>>ASSIGN
FPT$TRMCTL_V.VLPTYPE
     16036**DCL     17671>>IF      17675>>IF      17781>>IF      17784>>IF
FPT$TRMPRG_V.CTLFLG.RSTBRK
     16108**DCL     16108--REDEF
G$DCBTABLE
     15927**DCL     17522>>ASSIGN
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:119  
G$JIT.ERRLOG
     15851**DCL     15854--REDEF
G$JIT.JSUNIT
     15590**DCL     15591--REDEF
G$JIT.MCLS
     15589**DCL     15589--REDEF
G$JIT.PRIV.ACTIVE.TND
     15729**DCL     17878>>IF
G$JIT.TMRZ
     15858**DCL     15859--REDEF
G$JIT.USER_EXTIME
     15582**DCL     15583--REDEF
G$JIT.USER_MEMTIME
     15585**DCL     15585--REDEF
G$JIT.USER_SVTIME
     15584**DCL     15584--REDEF
G$JIT.USR#
     15579**DCL     17895>>ASSIGN  17924>>ASSIGN
G$JIT$
     15057**DCL     15521--IMP-PTR 17878>>IF      17895>>ASSIGN  17924>>ASSIGN
G$ROS.AUTO_DS$
     15955**DCL     15956--REDEF
G$ROS.AUTO_T$
     15956**DCL     15956--REDEF
G$ROS.DCBPTR$
     15951**DCL     17522>>ASSIGN
G$ROS.NUMDCBS
     15955**DCL     17511>>IF
G$ROS$
     15058**DCL     15946--IMP-PTR 17511>>IF      17522>>ASSIGN
GCHAN$
     16605**DCL     16594--IMP-PTR 17888<<ASSIGN  17898>>ASSIGN  17901>>ASSIGN  17902>>ASSIGN  17904>>ASSIGN
     17905>>ASSIGN
GET_COMMON
     17830**LABEL   17789--GOTO    17797--GOTO    17805--GOTO    17813--GOTO    17822--GOTO
GET_DONE
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:120  
     17862**LABEL   17848--CALLALT
GFS$GSP
     15395**DCL-ENT 17936--CALL
GHH$LOCK
     12131**DCL-ENT 17565--CALL
GHH$UNLOCK
     12131**DCL-ENT 17876--CALL    17919--CALL    17943--CALL    18031--CALL
IOP$
     16604**DCL     16407--IMP-PTR 17594<>CALL    17599>>ASSIGN  17602>>ASSIGN  17603>>ASSIGN  17605<>CALL
     17835<>CALL    17840>>ASSIGN  17841>>ASSIGN  17842>>ASSIGN  17843>>CALL    17844>>ASSIGN  17845>>ASSIGN
     17846>>CALL    17850>>ASSIGN  17864<>CALL
K$RWPARM
     16667**DCL     17548<<ASSIGN  18018<>CALL    18042<>CALL
K$RWPARM.BLKREC
     16697**DCL     16722--REDEF
K$RWPARM.DVE.DVBYTE
     16729**DCL     17579<<ASSIGN  17615<<ASSIGN  17659<<ASSIGN  17932<<ASSIGN
K$RWPARM.DVE.DVBYTE.RRR
     16741**DCL     17587>>IF      17592>>IF      18021<<ASSIGN
K$RWPARM.DVE.DVBYTE.TRANS
     16740**DCL     18001<<ASSIGN
K$RWPARM.DVE.DVBYTE.VFC
     16737**DCL     16738--REDEF   18003<<ASSIGN
K$RWPARM.DVE.EOMCHAR
     16745**DCL     16749--REDEF
K$RWPARM.DVE.VFC
     16749**DCL     18004<<ASSIGN
K$RWPARM.ERR
     16809**DCL     16814--REDEF
K$RWPARM.FC
     16773**DCL     16774--REDEF
K$RWPARM.FLDID
     16955**DCL     16956--REDEF
K$RWPARM.IP$
     16801**DCL     17578<<ASSIGN  17619<<ASSIGN
K$RWPARM.KEY$
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:121  
     16953**DCL     17617<<ASSIGN  17660<<ASSIGN
K$RWPARM.KEYSZ
     16964**DCL     17618<<ASSIGN  17661<<ASSIGN
K$RWPARM.KEYTYPE
     16962**DCL     16963--REDEF   17549<<ASSIGN  17614<<ASSIGN  17658<<ASSIGN
K$RWPARM.MAXNMBBYT
     16950**DCL     17834<<ASSIGN
K$RWPARM.MRKTYP
     16947**DCL     17589<<ASSIGN
K$RWPARM.MSG$
     16668**DCL     16669--REDEF   16678--REDEF   17554>>IF      17660>>ASSIGN  17662<<ASSIGN  17678>>ASSIGN
     17680<<ASSIGN  17695>>IF      17695>>IF      17832<<ASSIGN  17933>>IF      17949>>ASSIGN  17959<<ASSIGN
     17977<<ASSIGN  17999<<ASSIGN  18014>>ASSIGN  18016<<ASSIGN
K$RWPARM.MSGC$
     16669**DCL     17553<<ASSIGN
K$RWPARM.MSGID
     16784**DCL     16789--REDEF
K$RWPARM.MSGIDXT
     16797**DCL     16801--REDEF
K$RWPARM.MSGSZ
     16679**DCL     17015--IMP-SIZ 17556<<ASSIGN  17626<<ASSIGN  17630>>IF      17661>>ASSIGN  17663<<ASSIGN
     17678>>ASSIGN  17678>>ASSIGN  17699>>ASSIGN  17714>>ASSIGN  17765>>ASSIGN  17766>>IF      17768>>ASSIGN
     17833<<ASSIGN  17854<<ASSIGN  17857<<ASSIGN  17857>>ASSIGN  17858>>ASSIGN  17858>>ASSIGN  17858>>ASSIGN
     17860>>ASSIGN  17948>>IF      17948<<ASSIGN  17949>>ASSIGN  17949>>ASSIGN  17960<<ASSIGN  17969<<ASSIGN
     17970>>IF      17970<<ASSIGN  17978<<ASSIGN  18000<<ASSIGN  18015>>ASSIGN  18017<<ASSIGN  18036>>ASSIGN
K$RWPARM.ORG
     16933**DCL     16934--REDEF
K$RWPARM.PRMID
     16956**DCL     17783<<ASSIGN  17786<<ASSIGN  17788<<ASSIGN  17796<<ASSIGN  17804<<ASSIGN  17812<<ASSIGN
     17821<<ASSIGN  17830<<ASSIGN
K$RWPARM.STR
     16948**DCL     17551<<ASSIGN  17691>>ASSIGN  17710>>ASSIGN  17757>>ASSIGN
K$RWPARM.UHDR$
     16822**DCL     18014<<ASSIGN
K$RWPARM.UHDRSZ
     16827**DCL     18015<<ASSIGN
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:122  
K$RWPARM.V$
     16952**DCL     16983--IMP-PTR 17001--IMP-PTR 17550<<ASSIGN  17693<<ASSIGN  17708<<ASSIGN  17710>>ASSIGN
     17711>>ASSIGN  17712>>ASSIGN  17713>>ASSIGN  17755<<ASSIGN  17757>>ASSIGN  17763>>ASSIGN  17768>>ASSIGN
     17771<<ASSIGN  18037<<ASSIGN
K$RWPARM.VDOFLGS
     16935**DCL     16946--REDEF
K$RWPARM.VSZ
     16954**DCL     17694<<ASSIGN  17698<<ASSIGN  17698>>ASSIGN  17699>>ASSIGN  17709<<ASSIGN  17714>>ASSIGN
     17756<<ASSIGN  17760<<ASSIGN  17760>>ASSIGN  17765>>ASSIGN  17766>>IF      17768>>ASSIGN  17772<<ASSIGN
     17772>>ASSIGN  18038<<ASSIGN
KID_PARAMS
     14980**DCL        47--PROC
KID_PARAMS.BND
     15040**DCL     15041--REDEF
KID_PARAMS.BND.PAR2
     15040**DCL     17556>>ASSIGN  17834>>ASSIGN  17845>>ASSIGN  17952>>IF
KID_PARAMS.BND.PAR3
     15040**DCL     17618>>ASSIGN  17969>>ASSIGN  17975>>IF
KID_PARAMS.CPTRS.PAR2$
     15037**DCL     17553>>ASSIGN
KID_PARAMS.DESC
     15042**DCL     15043--REDEF
KID_PARAMS.ERR
     15006**DCL     17518<<ASSIGN  17530<<ASSIGN  17544<<ASSIGN  17584<<ASSIGN  17596<<ASSIGN  17602<<ASSIGN
     17679<>CALL    17837<<ASSIGN  17850<<ASSIGN  17851>>IF      17880<<ASSIGN  17906<<ASSIGN  17927<<ASSIGN
     17936<>CALL    18018<>CALL    18042<>CALL
KID_PARAMS.MCL.CODE
     14987**DCL     14987--REDEF   17507>>IF      17507>>IF      17534>>IF      17552>>IF      17570>>DOCASE
     17851>>IF
KID_PARAMS.PTRS
     15036**DCL     15037--REDEF   15039--REDEF   15039--REDEF   15039--REDEF
KID_PARAMS.PTRS.PAR1$
     15036**DCL     17506>>ASSIGN
KID_PARAMS.PTRS.PAR2$
     15036**DCL     17844>>ASSIGN  17846<>CALL    17855>>ASSIGN  17858>>ASSIGN  17858>>ASSIGN  17888>>ASSIGN
KID_PARAMS.PTRS.PAR3$
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:123  
     15036**DCL     17578>>ASSIGN  17617>>ASSIGN  17967>>IF
KID_PARAMS.PTRS.PAR4$
     15036**DCL     17619>>ASSIGN
KN$IOP.ARS
     16463**DCL     16464--REDEF   16465--REDEF
KN$IOP.BUFSEGDES
     16515**DCL     17846<>CALL
KN$IOP.BUF_
     16478**DCL     17844<<ASSIGN  17845<<ASSIGN
KN$IOP.DCB$
     16491**DCL     17842<<ASSIGN
KN$IOP.DCBSEGDES
     16559**DCL     17843<>CALL
KN$IOP.ERRCODE
     16425**DCL     17602>>ASSIGN  17850>>ASSIGN
KN$IOP.FLAGS.WAIT
     16471**DCL     17841<<ASSIGN
KN$IOP.FLDID
     16465**DCL     17603>>ASSIGN
KN$IOP.LNK$
     16493**DCL     16494--REDEF
KNA$CHECK_VDO
     15396**DCL-ENT 18018--CALL
KNA$CONV_STR
     15397**DCL-ENT 17679--CALL
KNA$FCNOU
     15398**DCL-ENT 18042--CALL
KNA$GETIOP
     15399**DCL-ENT 17594--CALL    17835--CALL
KNA$REG_USER
     15401**DCL-ENT 17601--CALL    17849--CALL
KNA$RLSIOP
     15400**DCL-ENT 17605--CALL    17864--CALL
KNA$SAVEMAP
     15403**DCL-ENT 17843--CALL    17846--CALL
KNA$SSN
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:124  
     15437**DCL     18042<>CALL
KNA$SSN.FLAGS.RRRPND
     15441**DCL     17600<<ASSIGN
KNA$SSN.IOPQ$
     15499**DCL     17599<<ASSIGN  17604<<ASSIGN  17840<<ASSIGN  17863<<ASSIGN
KNA$SSN.IOPRD$
     15499**DCL     15499--REDEF
KNA$SSN.RLCID.NODE#
     15503**DCL     15503--REDEF
KNA_GCHAN
     17028**DCL     17896--CALL    17896--CALL
KNA_GCHAN.KL_ACQUIRE
     17062**DCL     17896--CALL    17896--CALL
KNA_GCHAN.KL_ACQUIRE.ATTR
     17086**DCL     17891<<ASSIGN
KNA_GCHAN.KL_ACQUIRE.CHAN
     17067**DCL     17889<<ASSIGN  17898>>ASSIGN
KNA_GCHAN.KL_ACQUIRE.CODE
     17064**DCL     17887<<ASSIGN
KNA_GCHAN.KL_ACQUIRE.CONTROLLER
     17092**DCL     17893<<ASSIGN
KNA_GCHAN.KL_ACQUIRE.DIAG
     17089**DCL     17892<<ASSIGN
KNA_GCHAN.KL_ACQUIRE.DVCID
     17077**DCL     17904>>ASSIGN
KNA_GCHAN.KL_ACQUIRE.ERRCODE
     17101**DCL     17906>>ASSIGN
KNA_GCHAN.KL_ACQUIRE.EXTDVCID
     17079**DCL     17905>>ASSIGN
KNA_GCHAN.KL_ACQUIRE.HIGHCHAN
     17071**DCL     17901>>ASSIGN
KNA_GCHAN.KL_ACQUIRE.HIGHLOW
     17096**DCL     17894<<ASSIGN
KNA_GCHAN.KL_ACQUIRE.LOWCHAN
     17074**DCL     17902>>ASSIGN
KNA_GCHAN.KL_ACQUIRE.RES
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:125  
     17084**DCL     17890<<ASSIGN
KNA_GCHAN.KL_ACQUIRE.USER#
     17105**DCL     17895<<ASSIGN
KNA_LNKSSN
     15387**DCL     17565<>CALL    17876<>CALL    17919<>CALL    17943<>CALL    18031<>CALL
KNA_RCHAN
     17113**DCL     17925--CALL    17925--CALL
KNA_RCHAN.KL_RELEASE
     17147**DCL     17925--CALL    17925--CALL
KNA_RCHAN.KL_RELEASE.CHAN
     17152**DCL     17922<<ASSIGN
KNA_RCHAN.KL_RELEASE.CODE
     17149**DCL     17921<<ASSIGN
KNA_RCHAN.KL_RELEASE.CONTROLLER
     17155**DCL     17923<<ASSIGN
KNA_RCHAN.KL_RELEASE.ERRCODE
     17165**DCL     17927>>ASSIGN
KNA_RCHAN.KL_RELEASE.USER#
     17160**DCL     17924<<ASSIGN
KNA_RWPARM_CON
     15076**DCL     17548>>ASSIGN
KNA_RWPARM_CON.BLKREC
     15106**DCL     15131--REDEF
KNA_RWPARM_CON.DVE.DVBYTE.VFC
     15146**DCL     15147--REDEF
KNA_RWPARM_CON.DVE.EOMCHAR
     15154**DCL     15158--REDEF
KNA_RWPARM_CON.ERR
     15218**DCL     15223--REDEF
KNA_RWPARM_CON.FC
     15182**DCL     15183--REDEF
KNA_RWPARM_CON.FLDID
     15364**DCL     15365--REDEF
KNA_RWPARM_CON.KEYTYPE
     15371**DCL     15372--REDEF
KNA_RWPARM_CON.MSG$
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:126  
     15077**DCL     15078--REDEF   15087--REDEF
KNA_RWPARM_CON.MSGID
     15193**DCL     15198--REDEF
KNA_RWPARM_CON.MSGIDXT
     15206**DCL     15210--REDEF
KNA_RWPARM_CON.ORG
     15342**DCL     15343--REDEF
KNA_RWPARM_CON.VDOFLGS
     15344**DCL     15355--REDEF
KNB$GETRESP
     15402**DCL-ENT 17896--CALL    17925--CALL
MYDCB.ARS
     16000**DCL     17851>>IF      17854>>ASSIGN  17858>>ASSIGN  17860<<ASSIGN
MYDCB.DCBNAME.L
     16023**DCL     16023--IMP-SIZ
MYDCB.DDEV.RES
     16006**DCL     17534>>IF
MYDCB.DVFC
     16016**DCL     17987<<ASSIGN  17991<<ASSIGN
MYDCB.EOMCHAR
     16014**DCL     16014--REDEF   16015--REDEF
MYDCB.FCD
     16010**DCL     17524>>IF
MYDCB.FLDID
     16013**DCL     16013--REDEF   17603<<ASSIGN
MYDCB.KEYTYPE
     16016**DCL     17549>>ASSIGN
MYDCB.LINES
     16015**DCL     17984<<ASSIGN
MYDCB.ORG
     16011**DCL     17582>>IF      17621>>IF      18008>>IF
MYDCB.RES
     16008**DCL     16009--REDEF
MYDCB.SSN$
     16023**DCL     17547>>ASSIGN
MYDCB.STRM
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:127  
     16003**DCL     17551>>ASSIGN
MYDCB.TAB$
     16017**DCL     17935>>IF      17936<>CALL    17947>>ASSIGN  17949>>ASSIGN  17954>>IF      17955>>ASSIGN
     17957>>IF      17959>>ASSIGN
NK$VFC.COUNT
     15421**DCL     17989>>DOCASE
NK$VFC.FCN
     15421**DCL     17985>>DOCASE
NULLHDR
     16579**DCL     17977--ASSIGN  17978--ASSIGN
PRM
     16966**DCL     17708--ASSIGN  17771--ASSIGN  18037--ASSIGN
PRM.TL
     16967**DCL     18038--ASSIGN
PRM.TL.LEN
     16969**DCL     17714<<ASSIGN  17770<<ASSIGN  18036<<ASSIGN
PRM.TL.TYPE
     16968**DCL     17673<<ASSIGN  17677<<ASSIGN  17707<<ASSIGN  17730<<ASSIGN  17738<<ASSIGN  17746<<ASSIGN
     17769<<ASSIGN  17961<<ASSIGN  17971<<ASSIGN  17979<<ASSIGN
PROMPT
     17008**DCL     17693--ASSIGN  17694--ASSIGN  17755--ASSIGN
PROMPT.DVBYTE
     17013**DCL     17692<<ASSIGN
PROMPT.PFB
     17012**DCL     17691<<ASSIGN
PROMPT.TL.LEN
     17011**DCL     17699<<ASSIGN  17765<<ASSIGN
PROMPT.TL.TYPE
     17010**DCL     17689<<ASSIGN  17754<<ASSIGN
PROMPT.VFC
     17014**DCL     17690<<ASSIGN
SET_PARAM
     18035**PROC    17682--CALL    17731--CALL    17739--CALL    17747--CALL    17962--CALL    17972--CALL
     17980--CALL
SET_PARAM1 IN PROCEDURE SET_PARAM
     18039**ENTRY   17700--CALL    17715--CALL    17774--CALL
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:128  
SINPUT
     17001**DCL     17756--ASSIGN
SINPUT.BIGTL
     17001**DCL     17768<<ASSIGN
SINPUT.DMN
     17005**DCL     17757<<ASSIGN
SINPUT.POSITION
     17005**DCL     17763<<ASSIGN
SINPUT.TXT
     17005**DCL     17756--ASSIGN
SSN$
     16603**DCL     15437--IMP-PTR 17547<<ASSIGN  17599>>ASSIGN  17600>>ASSIGN  17601<>CALL    17604>>ASSIGN
     17840>>ASSIGN  17849<>CALL    17863>>ASSIGN  18042>>CALL
V$
     16601**DCL     16036--IMP-PTR 16068--IMP-PTR 16081--IMP-PTR 16107--IMP-PTR 16119--IMP-PTR 16143--IMP-PTR
     16176--IMP-PTR 16255--IMP-PTR 16266--IMP-PTR 16282--IMP-PTR 16302--IMP-PTR 16318--IMP-PTR 16334--IMP-PTR
     16350--IMP-PTR 16365--IMP-PTR 16376--IMP-PTR 16395--IMP-PTR 17506<<ASSIGN  17510>>ASSIGN  17550>>ASSIGN
     17579>>ASSIGN  17612>>IF      17614>>ASSIGN  17615>>ASSIGN  17621>>IF      17621>>IF      17628>>IF
     17656>>IF      17658>>ASSIGN  17659>>ASSIGN  17671>>IF      17675>>IF      17692>>ASSIGN  17695>>IF
     17711>>ASSIGN  17712>>ASSIGN  17713>>ASSIGN  17758>>IF      17763>>ASSIGN  17781>>IF      17784>>IF
     17855>>ASSIGN  17856>>IF      17889>>ASSIGN  17890>>ASSIGN  17891>>ASSIGN  17892>>ASSIGN  17893>>ASSIGN
     17894>>ASSIGN  17899>>IF      17922>>ASSIGN  17923>>ASSIGN  17983>>IF      17984>>ASSIGN  17985>>DOCASE
     17987>>ASSIGN  17989>>DOCASE  17991>>ASSIGN  18002>>IF
VDOTYP
     17026**DCL     17580<<ASSIGN  17616<<ASSIGN  17625<<ASSIGN  17629<<ASSIGN  17631<<ASSIGN  17640<<ASSIGN
     17647<<ASSIGN  17654<<ASSIGN  17722<<ASSIGN  17847<<ASSIGN  18005<<ASSIGN  18010<<ASSIGN  18019<<ASSIGN
     18040<<ASSIGN  18042<>CALL
VLP$
     16602**DCL     16050--IMP-PTR 16096--IMP-PTR 16130--IMP-PTR 16158--IMP-PTR 16191--IMP-PTR
VLP$LINEATTR_V.PROFILE
     16131**DCL     16131--REDEF
VLP$TAB
     16205**DCL     17936--CALL    17947<<ASSIGN  17955<<ASSIGN  17960--ASSIGN
VLP$TRMCTL_V.BREAKCOUNT
     16054**DCL     16054--REDEF
VLP$WINDOW_V.FWINDOW
PL6.E3A0      #001=KNA$MCL File=KNA$MCL.:E05TSI                                  WED 07/30/97 00:55 Page:129  
     16237**DCL     16237--REDEF   16237--REDEF
VLR$GCHAN.CHANNEL
     16594**DCL     17898<<ASSIGN
VLR$GCHAN.DVCID
     16595**DCL     17904<<ASSIGN
VLR$GCHAN.EXTDVCID
     16595**DCL     17905<<ASSIGN
VLR$GCHAN.HIGHCHAN
     16594**DCL     17901<<ASSIGN
VLR$GCHAN.LOWCHAN
     16594**DCL     17902<<ASSIGN
WAIT_RRR
     17587**LABEL   18022--GOTO
WINDOW
     16624**DCL     17678--ASSIGN  17679<>CALL    17680--ASSIGN
WINDOW.FWINDOW
     16624**DCL     16624--REDEF   16625--REDEF
