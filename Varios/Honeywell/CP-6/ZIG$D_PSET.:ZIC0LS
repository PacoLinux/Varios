
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:1    
        1        1        /*M*     ZIG$D_PSET    DDL TRANSLATE INTERFACE I-D-S/II  DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$D_PSET
        9        9        PURPOSE: This subroutine is called from X$PARSE to do three things:
       10       10                 First:
       11       11                      Get more input for X$PARSE, if the line continues, by
       12       12                      calling ZIG$D_READ.
       13       13                 Second:
       14       14                      To set things in the schema for things given in the DDL
       15       15                 Third:
       16       16                      Find all syntax errors and print the messages through
       17       17                      M$LO and M$DO using M$ERRMSG.
       18       18                      It will also try to recover from all syntax errors and
       19       19                      parse as much as possible so that all errors will be
       20       20                      printed in one pass. (This may cause compounding.)
       21       21        */
       22       22        ZIG$D_PSET:
       23       23            PROC (PARAN);
       24       24    1   DCL ZIG$HASH_IT ENTRY(8);
       25       25    1   DCL ZIG$D_FAIL ENTRY(2);
       26       26    1   DCL ZIG$D_READ ENTRY;
       27       27    1   DCL ADD_SN ENTRY(8);
       28       28    1   DCL ZIG$D_DIAG ENTRY(3);
       29       29    1   DCL JUST_FIND_SN ENTRY (8);
       30       30    1   DCL MOVE_TO_FIRST_POS ENTRY (4);
       31       31        /************************************
       32       32        * since we have to mess with RCs of *
       33       33        * *calc.rc and *system, keep info   *
       34       34        * on current record being defineed  *
       35       35        * Then, after record entry and all  *
       36       36        * it's fields have been defined, put*
       37       37        * RC. into UWA.RC. and modify it.   *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:2    
       38       38        ************************************/
       39       39    1   DCL 1 RC STATIC,
       40       40    1         2 RTYPE SBIN (36) ,
       41       41    1         2 PSMODE SBIN (36) ,
       42       42    1         2 FIXVAR SBIN (36) ,
       43       43    1         2 WITHINA SBIN (36) ,
       44       44    1         2 SO SBIN (36) ,
       45       45    1         2 SM SBIN (36) ,
       46       46    1         2 CYCLE SBIN (36) ,
       47       47    1         2 CALCDUP SBIN (36) ,
       48       48    1         2 ANY_IND SBIN (36) ,
       49       49    1         2 KEY_PRESENT SBIN (36) ,
       50       50    1         2 CV_OFFSET SBIN (36) ,
       51       51    1         2 PA_OFFSET SBIN (36) ,
       52       52    1         2 PA_ENTRY SBIN (36) ,
       53       53    1         2 NUM_SOSM SBIN (36) ,
       54       54    1         2 LSIZE SBIN (36) ,
       55       55    1         2 SLACK SBIN (36) ;
       56       56        /**********************
       57       57        * needed for get_num  *
       58       58        * All numeric tokens  *
       59       59        * are put here        *
       60       60        **********************/
       61       61    1   DCL NUM SBIN WORD EXT;
       62       62        /**********************
       63       63        * needed for get_word *
       64       64        * All alphabetic      *
       65       65        * tokens are put here.*
       66       66        **********************/
       67       67    1   DCL WORD1 CHAR(30) STATIC;
       68       68        /************************
       69       69        * required clause types *
       70       70        * These bits are init   *
       71       71        * to '0'b and set to '1'*
       72       72        * when the clause is    *
       73       73        * successfully parsed.  *
       74       74        * Then, if the clause is*
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:3    
       75       75        * encountered again, it *
       76       76        * must be an error.     *
       77       77        ************************/
       78       78    1   DCL CLAUSE_TYPE CHAR(12);
       79       79    1   DCL LOCATION BIT(1) STATIC;
       80       80    1   DCL WITHIN BIT(1) STATIC;
       81       81    1   DCL TYPE BIT(1) STATIC;
       82       82    1   DCL OWNER BIT(1) STATIC;
       83       83    1   DCL PRIOR BIT(1) STATIC;
       84       84    1   DCL ORDER BIT(1) STATIC;
       85       85    1   DCL SORTKEY BIT(1) STATIC;
       86       86    1   DCL LINKED BIT(1) STATIC;
       87       87    1   DCL PERM BIT(1) STATIC;
       88       88    1   DCL SELECTION BIT(1) STATIC;
       89       89        /************************
       90       90        *   lock types          *
       91       91        ************************/
       92       92    1   DCL 1 OA_LKS STATIC UNAL,
       93       93    1         2 XLOCKS BIT(1) INIT('0'B),
       94       94    1         2 DISPLAY BIT(1) INIT('0'B),
       95       95    1         2 COPY BIT(1) INIT('0'B),
       96       96    1         2 ALTER BIT(1) INIT('0'B);
       97       97    1   DCL 1 RC_LKS STATIC UNAL,
       98       98    1         2 SC_LKS,
       99       99    1           3 XINSERT BIT(1) INIT('0'B),
      100      100    1           3 REMOVE BIT(1) INIT('0'B),
      101      101    1           3 FIND BIT(1) INIT('0'B),
      102      102    1         2 FR_LKS,
      103      103    1           3 MODIFY BIT(1) INIT('0'B),
      104      104    1           3 GET BIT(1) INIT('0'B),
      105      105    1         2 MISC,
      106      106    1           3 STORE BIT(1) INIT('0'B),
      107      107    1           3 DELETE BIT(1) INIT('0'B);
      108      108    1   DCL LK$ PTR EXT;
      109      109    1   DCL 1 LK BASED(LK$) ALIGNED,
      110      110    1         2 ALIAS_TYPE UBIN (3) UNAL,
      111      111    1         2 TYPE UBIN (3) UNAL,
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:4    
      112      112    1         2 DUPS UBIN (12) UNAL,
      113      113    1         2 C_NAME CHAR (30) UNAL,
      114      114    1         2 PTR$ PTR ALIGNED,
      115      115    1         2 NEXT_LT$ PTR ALIGNED;
      116      116    1   DCL LT$ PTR EXT;
      117      117    1   DCL 1 LT BASED(LT$) ALIGNED,
      118      118    1         2 NEXT_LT$ PTR ALIGNED,
      119      119    1         2 TYPE UBIN (36) ALIGNED,
      120      120    1         2 DBK_SN UBIN (36) ALIGNED,
      121      121    1         2 LOCKS UBIN (36) ALIGNED,
      122      122    1         2 LOCKS_BITS(0:35) REDEF LOCKS BIT (1) UNAL,
      123      123    1         2 LNO UBIN (36) ALIGNED;
      124      124        %EQU SCHEMA_LOCK = 10;
      125      125        %EQU RECORD_LOCK = 40;
      126      126        %EQU ITEM_LOCK = 50;
      127      127        %EQU SET_LOCK = 30;
      128      128        %EQU COPY_BIT = 0;
      129      129        %EQU DISPLAY_BIT = 1;
      130      130        %EQU LOCKS_BIT = 2;
      131      131        %EQU ALTER_BIT = 3;
      132      132        %EQU GET_BIT = 9;
      133      133        %EQU MODIFY_BIT = 10;
      134      134        %EQU STORE_BIT = 11;
      135      135        %EQU DELETE_BIT = 12;
      136      136        %EQU INSERT_BIT = 13;
      137      137        %EQU REMOVE_BIT = 14;
      138      138        %EQU FIND_BIT = 15;
      139      139    1   DCL LAST_LOCKABLE_DBK UBIN (36) STATIC;
      140      140    1   DCL PTR$ PTR STATIC;
      141      141        /*******************
      142      142        * Temporary holder *
      143      143        * for a dbk        *
      144      144        *******************/
      145      145    1   DCL HOLD_DBK UBIN WORD;
      146      146        /******************************
      147      147        * Flag to be set when an      *
      148      148        * error occurs and processing *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:5    
      149      149        * will be stopped             *
      150      150        ******************************/
      151      151    1   DCL FLAG_ERROR BIT(1) STATIC;
      152      152        /********************************
      153      153        * used to keep track of record  *
      154      154        * in which field is defined     *
      155      155        * Also to keep track of RC of   *
      156      156        * last SM in a set              *
      157      157        ********************************/
      158      158    1   DCL LAST_RC_DBK UBIN WORD EXT;
      159      159    1   DCL LAST_RC_SN UBIN WORD STATIC;
      160      160    1   DCL LAST_RC_NAME CHAR(30) STATIC;
      161      161        /********************************
      162      162        * used for qualified            *
      163      163        * data-base identifiers         *
      164      164        ********************************/
      165      165    1   DCL QUAL BIT(1) STATIC;
      166      166    1   DCL QFR_NAME CHAR(30) STATIC;
      167      167    1   DCL QRC_DBK UBIN WORD STATIC;
      168      168        /*******************************
      169      169        * keep track for filling in SS *
      170      170        *******************************/
      171      171    1   DCL LAST_SC_DBK UBIN WORD STATIC;
      172      172    1   DCL LAST_SC_SN UBIN WORD STATIC;
      173      173    1   DCL LAST_SO_DBK UBIN WORD STATIC;
      174      174        /*******************************
      175      175        * Keep track for adding second *
      176      176        * SM to RC_SOSM for altkeys    *
      177      177        *******************************/
      178      178    1   DCL DBK_SM_ALTKEY UBIN WORD;
      179      179        /********************************
      180      180        * want SFRs to be first in RC-FR*
      181      181        * so keep track of first SFR so *
      182      182        * can add all real FRs after it *
      183      183        ********************************/
      184      184    1   DCL FIRST_SFR_DBK UBIN WORD STATIC INIT(0);
      185      185        /********************************
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:6    
      186      186        * keep track of DBK of *system  *
      187      187        * and *dbparam RCs              *
      188      188        ********************************/
      189      189    1   DCL DBK_STAR_SYSTEM_RC UBIN WORD EXT;
      190      190    1   DCL DBK_STAR_CALC_RC UBIN WORD EXT;
      191      191        /**********************************************
      192      192        * for calc key purposes, save for each record *
      193      193        **********************************************/
      194      194    1   DCL DBK_SM_CALC UBIN WORD STATIC; /* SM connected to RC containing calckey */
      195      195    1   DCL DBK_SS_CALC UBIN WORD STATIC; /* SS of that SM */
      196      196        /*********************************
      197      197        * DDL text line number          *
      198      198        ********************************/
      199      199    1   DCL LINE_COUNT UBIN WORD EXT;
      200      200        /*********************************
      201      201        * needed for comparing sort keys *
      202      202        *********************************/
      203      203    1   DCL END_OF_KEYS BIT(1);
      204      204    1   DCL CURR_CF_DBK UBIN WORD;
      205      205    1   DCL PREV_CF_DBK UBIN WORD;
      206      206    1   DCL 1 TCF DALIGNED,
      207      207    1         2 * CHAR(20);
      208      208    1   DCL 1 TFR DALIGNED,
      209      209    1         2 * CHAR(8) ALIGNED,
      210      210    1         2 FTYPE SBIN (36) ALIGNED,
      211      211    1         2 PREC SBIN (36) ALIGNED,
      212      212    1         2 SCALE SBIN (36) ALIGNED,
      213      213    1         2 F_SIGN SBIN (36) ALIGNED,
      214      214    1         2 * CHAR(44) ALIGNED;
      215      215        /******************************************
      216      216        * signifies that record entry, including  *
      217      217        * all field definitions, is completed     *
      218      218        ******************************************/
      219      219    1   DCL REC_ENTRY_DONE BIT(1) STATIC INIT('0'B);
      220      220        /**********************************
      221      221        * needed for handling sort keys   *
      222      222        **********************************/
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:7    
      223      223    1   DCL FIRST_MEMBER BIT(1) STATIC;
      224      224    1   DCL LAST_SM_DBK UBIN WORD STATIC;
      225      225    1   DCL DESC SBIN (36) STATIC;
      226      226    1   DCL CURR_SETNAME CHAR(30) STATIC;
      227      227    1   DCL DBK_CALC_CF UBIN WORD;
      228      228    1   DCL NUM_AREAS_WITHIN UBIN WORD STATIC;
      229      229        /******************************************
      230      230        * needed to ensure that key mentioned in  *
      231      231        * LOC MODE INDEXED clause is defined in a *
      232      232        * KEY NAME IS clause in same record.      *
      233      233        * If defined, this field set back to      *
      234      234        * blanks.  At end of record def, if it    *
      235      235        * is blank, then all is well.             *
      236      236        ******************************************/
      237      237    1   DCL INDX_KEY_NM CHAR(30) STATIC INIT(' ');
      238      238        /***********************************************
      239      239        * needed for ensuring consistent level numbers *
      240      240        ***********************************************/
      241      241    1   DCL LEV_NUM UBIN WORD STATIC;
      242      242        /**************************
      243      243        * Don't want to modify FR *
      244      244        * if no new FR was stored *
      245      245        **************************/
      246      246    1   DCL MOD_FR_OK BIT(1) STATIC;
      247      247        /********************************
      248      248        * Don't want to process MEMBERs *
      249      249        * of a set if there is no       *
      250      250        * correct OWNER clause.         *
      251      251        ********************************/
      252      252    1   DCL OWNER_CLAUSE_FOUND BIT(1) STATIC;
      253      253        /********************************
      254      254        * save field dbkeys             *
      255      255        ********************************/
      256      256    1   DCL DBK_RFR UBIN WORD;
      257      257    1   DCL DBK_SFR UBIN WORD;
      258      258        /*******************************
      259      259        * needed for LOC MODE VIA      *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:8    
      260      260        *******************************/
      261      261    1   DCL LAST_RC$ PTR EXT;
      262      262        /***********************************
      263      263        * Returned by ZIG$HASH_IT          *
      264      264        ***********************************/
      265      265    1   DCL ERROR_STATUS UBIN WORD EXT;
      266      266        /*****************************************
      267      267        * Signifies that all DDL has been read in*
      268      268        *****************************************/
      269      269    1   DCL END_DDL BIT (1) EXT;
      270      270        /********************************
      271      271        * DDL is compacted into this    *
      272      272        ********************************/
      273      273    1   DCL LINE CHAR (4000) EXT;
      274      274        /******************************************
      275      275        * Keeps track of which entry we're in     *
      276      276        ******************************************/
      277      277    1   DCL LAST_STATUS UBIN(6) EXT INIT(0);
      278      278        /*************************************
      279      279        * Conveys node type when calling FAIL*
      280      280        *************************************/
      281      281    1   DCL J UBIN (36);
      282      282    1   DCL SYNTAX_ERR BIT(72) SYMREF;
      283      283        /******************************
      284      284        * Global variable to show if  *
      285      285        * a hyphen has been found     *
      286      286        ******************************/
      287      287    1   DCL FIRST_HYPHEN BIT(1) EXT;
      288      288        /*************************************
      289      289        * Indicates whether an error or a    *
      290      290        * warning is to be stored in the     *
      291      291        * diagnostics table                  *
      292      292        *************************************/
      293      293        %EQU WARN_SEV = 1;
      294      294        %EQU ERR_SEV = 2;
      295      295        /**********************************
      296      296        * Contain the length of the       *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:9    
      297      297        * fields %U1, %U2, and %U3        *
      298      298        * to be printed in error messages *
      299      299        **********************************/
      300      300    1   DCL CT1 UBIN (36);
      301      301    1   DCL CT2 UBIN (36);
      302      302    1   DCL CT3 UBIN (36);
      303      303        /**********************************
      304      304        * Needed to float size of schema. *
      305      305        **********************************/
      306      306    1   DCL SF_CLOSE ENTRY (2);
      307      307    1   DCL SF_OPEN ENTRY (2);
      308      308    1   DCL NEED_LARGER_SCHEMA BIT (1) EXT;
      309      309    1   DCL STATUS UBIN (36);
      310      310        /***********************
      311      311        *  Index counter       *
      312      312        ***********************/
      313      313    1   DCL X UBIN (36);
      314      314        /***************************
      315      315        * Flags to stop processing *
      316      316        * of a set with an         *
      317      317        * undefined owner record   *
      318      318        ***************************/
      319      319    1   DCL SET_ERROR BIT (1) EXT;
      320      320    1   DCL OTHER_DDL_FLAG BIT (1) EXT;
      321      321    1   DCL DO_PROCESS BIT (1);
      322      322    1   DCL FIRST_SET_ERROR BIT (1) EXT;
      323      323        /********************
      324      324        * Flag for negative *
      325      325        * SCALE factor      *
      326      326        ********************/
      327      327    1   DCL NEG_SCALE BIT (1) STATIC;
      328      328        /*****************************
      329      329        *     includes               *
      330      330        *****************************/
      331      331        %INCLUDE CP_6;
      332      412        %INCLUDE CP_6_SUBS;
      333      952        %INCLUDE ZIG_DIR_STRUCS;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:10   
      334     1082        %INCLUDE ZIG_GENERAL;
      335     1190        %INCLUDE ZIG_DDL_INCL;
      336     1452         %PARSE_SCH_DDL;
      337     1611         %DDL_XLATE;
      338     1706        %INCLUDE ZIG_TYPE_SUBS;
      339     1721        %INCLUDE ZI_SUB4_CAN;
      340     2378        %UWA;
      341     2713        %INCLUDE ZIG_DBA_INT;
      342     2761        %INCLUDE ZI_ERRORS_SUBS;
      343     3281        %INCLUDE XU_MACRO_C;
      344     6387        %INCLUDE XU_SUBS_C;
      345     6479        %P$PCB(NAME=DDL_P,STCLASS=SYMREF);
      346     6680        %PARSE$PARAM(NAME=PARAN);
      347     6761        %PARSE$OUT(NAME=BLK,STCLASS=BASED);
      348     6806        %PARSE$SYM(NAME=SYM,STCLASS=BASED);
      349     6844        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:11   
      350     6845        /******************************************************
      351     6846        *******************************************************
      352     6847        ***************** start here **************************
      353     6848        *******************************************************
      354     6849        ******************************************************/
      355     6850    1       LNO = LINE_COUNT - 1;
      356     6851    1       IF SET_ERROR AND PARAN.TYPE ~= %INPUT#
      357     6852    2       THEN DO;
      358     6853    2           IF NOT OTHER_DDL_FLAG THEN
      359     6854    2               DO_PROCESS = '0'B;
      360     6855    3           ELSE DO;
      361     6856    3               OTHER_DDL_FLAG = '0'B;
      362     6857    3               IF (PARAN.CODE = %MEM_REC_NM) OR (PARAN.CODE = %LEVEL_NUM) THEN
      363     6858    3                   DO_PROCESS = '0'B;
      364     6859    4               ELSE DO;
      365     6860    4                   DO_PROCESS = '1'B;
      366     6861    4                   SET_ERROR = '0'B;
      367     6862    4                   END;
      368     6863    3               END;
      369     6864    2           IF PARAN.CODE = %OTHER_DDL THEN
      370     6865    2               OTHER_DDL_FLAG = '1'B;
      371     6866    2           END;
      372     6867    1       ELSE
      373     6868    1           DO_PROCESS = '1'B;
      374     6869    1       IF DO_PROCESS
      375     6870    2       THEN DO;
      376     6871    3           DO CASE (PARAN.TYPE);
      377     6872    3           CASE(%INPUT#);
      378     6873    3               IF END_DDL THEN UNWIND TO SYNTAX_ERR;
      379     6874    3               CALL ZIG$D_READ;
      380     6875    3               IF END_DDL THEN UNWIND TO SYNTAX_ERR;
      381     6876    3           CASE(%SUCC#,%PRE#);
      382     6877    4               DO CASE (PARAN.CODE);
      383     6878        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:12   
      384     6879    4               CASE(%SCHEMA_DDL);
      385     6880    4               CASE(%SCH_NM); /* SCHEMA NAME IS schemaname */
      386     6881        /*-save pointer to beginning of dynamic mem used for pass2
      387     6882          -make sure this is the only schema def
      388     6883          -ensure schema name same as in DBACS command
      389     6884          -store SN and OA
      390     6885          -store *dbparam and *system records      */
      391     6886         /* want to save ptr to beginning of dyn mem so get a word here */
      392     6887    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM_START$);
      393     6888    4                   IF LAST_STATUS > %SCH_DEF THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%
              6888                            ERR_SEV,%ORDER_SCHEMA_DDL);
      394     6889         /*E* ERROR: ZIG-%ORDER_SCHEMA_DDL-C
      395     6890                    MESSAGE: The SCHEMA DDL is either not in the correct
      396     6891                             order or a section is missing.
      397     6892               */
      398     6893    4                   LAST_STATUS = %SCH_DEF;
      399     6894    4                   CALL GET_WORD;
      400     6895    4                   CALL CHECK_RESW_DUPS;
      401     6896    4                   IF STRAN.SNAME ~= WORD1 THEN
      402     6897    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4009);
              6897                                /* given schname ~= that in directive */
      403     6898         /*E* ERROR: ZIG-4009-C
      404     6899                      MESSAGE: The schema name in the directive and in the
      405     6900                               schema DDL are not the same.
      406     6901                   */
      407     6902    4                   UWA.SN = '0'B;
      408     6903    4                   UWA.SN.DCLR = 1;
      409     6904    4                   UWA.SN.SETYPE = %ZIG_RTYPE_OA;
      410     6905    4                   UWA.SN.LNO = LNO;
      411     6906    4                   UWA.SN.SENAME = WORD1;
      412     6907    4                   CALL STRE_6('SN      ');
      413     6908    4                   LAST_LOCKABLE_DBK = UWA.DIRECT_REF;
      414     6909    4                   UWA.DA.NUMB_SN = 1; /* hereafter, ADD_SN will be used to add SNs */
      415     6910    4                   UWA.OA = '0'B;
      416     6911    4                   UWA.OA.FILE_CODE = '1*';
      417     6912    4                   CALL STRE_6('OA      ');
      418     6913    4                   UWA.SF.DBKEY_OA = UWA.DIRECT_REF;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:13   
      419     6914    4                   WORD1 = '*DBPARAM';
      420     6915    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);
      421     6916    4                   UWA.DA.FRST_RC = UWA.DIRECT_REF;
      422     6917    4                   UWA.RC = '0'B;
      423     6918    4                   UWA.RC.RTYPE = 4001;
      424     6919    4                   CALL STRE_6('RC      ');
      425     6920    4                   DBK_STAR_DBPARAM_RC = UWA.DIRECT_REF;
      426     6921    4                   WORD1 = '*SYSTEM';
      427     6922    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);
      428     6923    4                   UWA.RC.RTYPE = 4002;
      429     6924    4                   CALL STRE_6('RC      ');
      430     6925    4                   DBK_STAR_SYSTEM_RC = UWA.DIRECT_REF;
      431     6926    4                   UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 2;
      432     6927        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:14   
      433     6928        /********************************************************************
      434     6929                 schema privacy locks
      435     6930        ********************************************************************/
      436     6931    4               CASE(%LKS);
      437     6932    5                   IF OA_LKS.XLOCKS THEN DO;
      438     6933    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      439     6934         /*E* ERROR: ZIG-4015-C
      440     6935                 MESSAGE: A lock has already been invoked for that function
      441     6936                          in this clause.
      442     6937              */
      443     6938    5                       END;
      444     6939    4                   ELSE OA_LKS.XLOCKS = '1'B;
      445     6940    4               CASE(%DISPLAY);
      446     6941    5                   IF OA_LKS.DISPLAY THEN DO;
      447     6942    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      448     6943    5                       END;
      449     6944    4                   ELSE OA_LKS.DISPLAY = '1'B;
      450     6945    4               CASE(%COPY);
      451     6946    5                   IF OA_LKS.COPY THEN DO;
      452     6947    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      453     6948    5                       END;
      454     6949    4                   ELSE OA_LKS.COPY = '1'B;
      455     6950    4               CASE(%ALTER);
      456     6951    5                   IF OA_LKS.ALTER THEN DO;
      457     6952    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      458     6953    5                       END;
      459     6954    4                   ELSE OA_LKS.ALTER = '1'B;
      460     6955    4               CASE(%MPRIV);
      461     6956    4                   OA_LKS = '0'B;
      462     6957    4               CASE(%SCH_LCK_NM);
      463     6958    4                   IF LAST_STATUS ~= %SCH_DEF THEN
      464     6959    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);
      465     6960    5                   ELSE DO;
      466     6961    5                       CALL GET_WORD;
      467     6962    5                       CALL CHECK_RESW_DUPS;
      468     6963    5                       IF OA_LKS = '0'B THEN
      469     6964    5                           OA_LKS = '1111'B;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:15   
      470     6965    5                       CALL ADD_LOCK(WORD1,%SCHEMA_LOCK);
      471     6966    5                       END;
      472     6967        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:16   
      473     6968        /********************************************************************
      474     6969                 area entry
      475     6970        ********************************************************************/
      476     6971    4               CASE(%OTHER_DDL);
      477     6972    4               CASE(%AC_ENT);
      478     6973    4               CASE(%AC_NM); /* AREA NAME IS areaname */
      479     6974        /* -clean up a previous record entry
      480     6975           -store SN of area (AC will be stored after entire area entry parsed
      481     6976            and period hit) */
      482     6977    4                   IF REC_ENTRY_DONE THEN
      483     6978    4                       CALL CLEAN_UP_REC;
      484     6979    4                   LAST_STATUS = %AC_DEF;
      485     6980    4                   CALL GET_WORD;
      486     6981    4                   CALL CHECK_RESW_DUPS;
      487     6982    4                   CALL ADD_SN(%ZIG_RTYPE_AC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);
      488     6983    4                   IF FOUND = %FOUNDDEF THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              6983                            4021);
      489     6984         /*E* ERROR: ZIG-4021-C
      490     6985                      MESSAGE: The name "%U1" has already been assigned to
      491     6986                               an area.
      492     6987                   */
      493     6988    4                   UWA.AC = '0'B;
      494     6989    4               CASE(%TEMP_CL); /* AREA IS TEMPORARY */
      495     6990    4                   UWA.AC.PERMTYPE = 1;
      496     6991        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:17   
      497     6992        /********************************************************************
      498     6993                 record entry
      499     6994        ********************************************************************/
      500     6995    4               CASE(%REC_ENT);
      501     6996    4               CASE(%REC_NM); /* RECORD NAME IS recordname */
      502     6997        /* -clean up a previous record entry
      503     6998           -increase schema size if necessary
      504     6999           -initialize record flags and relevant DBKs and clause flags
      505     7000           -store SN and RC of record  */
      506     7001    4                   IF REC_ENTRY_DONE THEN
      507     7002    4                       CALL CLEAN_UP_REC;
      508     7003    4                   IF NEED_LARGER_SCHEMA
      509     7004    5                   THEN DO;
      510     7005    5                       CALL SF_CLOSE(1,STATUS);
      511     7006    5                       CALL SF_OPEN(1,STATUS);
      512     7007    5                       NEED_LARGER_SCHEMA = '0'B;
      513     7008    5                       CALL RESTORE_CURRENTS;
      514     7009    5                       END;
      515     7010    4                   REC_ENTRY_DONE = '1'B;
      516     7011    4                   NUM_AREAS_WITHIN = 0;
      517     7012    4                   FIRST_SFR_DBK = 0;
      518     7013    4                   DBK_SM_CALC = 0;
      519     7014    4                   DBK_SS_CALC = 0;
      520     7015    4                   INDX_KEY_NM = ' ';
      521     7016    4                   LEV_NUM = 0;
      522     7017    4                   LOCATION = '0'B;
      523     7018    4                   WITHIN = '0'B;
      524     7019    4                   LAST_STATUS = %RC_DEF;
      525     7020    4                   CALL GET_WORD;
      526     7021    4                   CALL CHECK_RESW_DUPS;
      527     7022    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);
      528     7023    4                   LAST_LOCKABLE_DBK = UWA.DIRECT_REF;
      529     7024    4                   LAST_RC_SN = UWA.DIRECT_REF;
      530     7025    4                   LAST_RC_NAME = WORD1;
      531     7026    4                   IF FOUND = %FOUNDDEF THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              7026                            4025);
      532     7027         /*E*  ERROR: ZIG-4025-C
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:18   
      533     7028                 MESSAGE: The name "%U1" has already been assigned to a record.
      534     7029             */
      535     7030    4                   RC = '0'B;
      536     7031    4                   RC.PSMODE = 9;
      537     7032    4                   RC.WITHINA = 9;
      538     7033    4                   RC.ANY_IND = 0;
      539     7034    4                   CALL STRE_6('RC      ');
      540     7035    4                   UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 1;
      541     7036    4                   LAST_RC_DBK = UWA.DIRECT_REF; /* keep track in order to determine
      542     7037         if duplicate fields exist within
      543     7038         a record */
      544     7039    4               CASE(%RPRIV);
      545     7040    4                   RC_LKS = '0'B;
      546     7041    4               CASE(%LOC_CL);
      547     7042    5                   IF LOCATION THEN DO;
      548     7043    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
      549     7044         /*E* ERROR: ZIG-4026-C
      550     7045                 MESSAGE: The %U1 clause has already been specified for this
      551     7046                          subentry.
      552     7047              */
      553     7048    5                       END;
      554     7049    4                   ELSE LOCATION = '1'B;
      555     7050    4               CASE(%DIR_FR); /* LOCATION MODE IS DIRECT dbparam/dbid */
      556     7051        /* -handled in pas2 */
      557     7052    4               CASE(%DIR_QRC);
      558     7053    4                   CALL GET_WORD;
      559     7054    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);
      560     7055    4                   DYNMEM$->WRD1 = %QUAL;
      561     7056    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      562     7057    4                   DYNMEM$->CHAR30 = WORD1;
      563     7058    4               CASE(%DIR_QFR);
      564     7059    4                   RC.PSMODE = 0; /* direct */
      565     7060    4                   CALL GET_WORD;
      566     7061    4                   CALL ZIG$G_DYN_MEM_6(11,DYNMEM$);
      567     7062    4                   DYNMEM$->WRD1 = %DIRECT;
      568     7063    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      569     7064    4                   DYNMEM$->WRD1 = LAST_RC_DBK;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:19   
      570     7065    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      571     7066    4                   DYNMEM$->WRD1 = LNO;
      572     7067    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      573     7068    4                   DYNMEM$->CHAR30 = WORD1;
      574     7069    4               CASE(%CLC_FR); /* LOCATION MODE IS CALC USING dbid1[,dbidN] */
      575     7070        /* -if this is first calckey mentioned ever, create *CALC SC & SN
      576     7071            and *CALC.RC SN, RC and SO
      577     7072           -if this is the first calckey mentioned in this record, add this
      578     7073            record to the *CALC set (store SM and SS)
      579     7074           -store RFR and SN for this field
      580     7075           -store a CF off the SS of this record's SM in the *calc set
      581     7076           -store a CF off this record's SM in the *calc set */
      582     7077    4   CLC:
      583     7078    5                   IF UWA.OA.OA_CALC = 0 THEN DO; /* this is first calc key in DDL */
      584     7079    5                       WORD1 = '*CALC';
      585     7080    5                       CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);
      586     7081    5                       UWA.SC = '0'B;
      587     7082    5                       UWA.SC.SETTYPE = 1;
      588     7083    5                       UWA.SC.PTRNO = 3;
      589     7084    5                       UWA.SC.SEQDUP = 2;
      590     7085    5                       CALL STRE_6('SC      ');
      591     7086    5                       UWA.OA.OA_CALC = UWA.DIRECT_REF;
      592     7087    5                       UWA.OA.NUMB_SC = UWA.OA.NUMB_SC + 1;
      593     7088    5                       WORD1 = '*CALC.RC';
      594     7089    5                       CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);
      595     7090    5                       UWA.DA.FRST_RC = UWA.DIRECT_REF;
      596     7091    5                       UWA.RC = '0'B;
      597     7092    5                       UWA.RC.RTYPE = 4000;
      598     7093    5                       UWA.RC.SO = 1;
      599     7094    5                       UWA.RC.NUM_SOSM = 1;
      600     7095    5                       CALL STRE_6('RC      ');
      601     7096    5                       DBK_STAR_CALC_RC = UWA.DIRECT_REF;
      602     7097    5                       UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 1;
      603     7098    5                       UWA.SO = '0'B;
      604     7099    5                       CALL STRE_6('SO      ');
      605     7100    5                       UWA.OA.NUMB_SO = UWA.OA.NUMB_SO + 1;
      606     7101    5                       DBK_SO_CALC = UWA.DIRECT_REF;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:20   
      607     7102    5                       CALL CONNECT_6('RC-SOSM ');
      608     7103    5                       END;
      609     7104    5                   IF DBK_SM_CALC = 0 THEN DO; /* first calckey in this record */
      610     7105    5                       CALL FINDD_6('SC      ',UWA.OA.OA_CALC);
      611     7106    5                       CALL FINDPS_6('SC-SOSM '); /* want to add SMs after SO */
      612     7107    5                       CALL FINDD_6('RC      ',LAST_RC_DBK);
      613     7108    5                       UWA.SM = '0'B;
      614     7109    5                       UWA.SM.PSMODE = 1;
      615     7110    5                       UWA.SM.PSEQ = 1;
      616     7111    5                       UWA.SM.SEQDUP = 2;
      617     7112    5                       CALL STRE_6('SM      ');
      618     7113    5                       UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;
      619     7114    5                       RC.NUM_SOSM = RC.NUM_SOSM + 1;
      620     7115    5                       DBK_SM_CALC = UWA.DIRECT_REF;
      621     7116    5                       CALL FINDNS_6('RC-SOSM ');
      622     7117    5                       CALL FINDD_6('SM      ',DBK_SM_CALC);
      623     7118    5                       CALL CONNECT_6('RC-SOSM ');
      624     7119    5                       UWA.S_S = '0'B;
      625     7120    5                       UWA.S_S.SC_SSH = UWA.OA.OA_CALC;
      626     7121    5                       UWA.S_S.SOSM_SSH = DBK_SO_CALC;
      627     7122    5                       CALL STRE_6('S-S      ');
      628     7123    5                       UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;
      629     7124    5                       DBK_SS_CALC = UWA.DIRECT_REF;
      630     7125    5                       END;
      631     7126    4                   WORD1 = QFR_NAME;
      632     7127    4                   IF WORD1 = 'DUPS' OR WORD1 = 'DUPLICATES' THEN
      633     7128    5                   DO;
      634     7129    5                       PARAN.REJECT = '1'B;
      635     7130    5                       RETURN;
      636     7131    5                       END;
      637     7132    4                   RC.PSMODE = 1;
      638     7133    4                   RC.SLACK = RC.SLACK + 1; /* misuse this field to count calckeys */
      639     7134    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.LOC,
      640     7135    4                      EXPLCT,LAST_RC_DBK);
      641     7136    4                   IF FIRST_SFR_DBK ~= 0 THEN /* add all RFRs after SFRs */
      642     7137    5                   DO;
      643     7138    5                       CALL FINDD_6('FR      ',FIRST_SFR_DBK);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:21   
      644     7139    5                       CALL FCURR_R_6('SN      ');
      645     7140    5                       END;
      646     7141    4                   UWA.FR = '0'B;
      647     7142    4                   UWA.FR.DERIVED = RC.SLACK; /* misuse this field to count calckeys */
      648     7143    4                   UWA.FR.F_OCCURS = 1; /* misuse this field to signal calckey */
      649     7144    4                   UWA.FR.REF = 1;
      650     7145    4                   CALL STRE_6('FR      ');
      651     7146    4                   HOLD_DBK = UWA.DIRECT_REF;
      652     7147    4                   CALL CONNECT_6('SN-SE   ');
      653     7148    4                   UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
      654     7149    4                   CALL FINDD_6('S-S     ',DBK_SS_CALC);
      655     7150    4                   UWA.C_F = '0'B;
      656     7151    4                   UWA.C_F.CTRLTYPE = 4;
      657     7152    4                   CALL STRE_6('C-F     ');
      658     7153    4                   CALL CONNECT_6('SSSM-CF ');
      659     7154    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
      660     7155    4                      'FR      ', 'C-F     ' );
      661     7156    4                   CALL FINDOS_6('FR-CFS  ');
      662     7157    4                   HOLD_DBK = UWA.DIRECT_REF;
      663     7158    4                   CALL FINDD_6('SM      ',DBK_SM_CALC);
      664     7159    4                   CALL STRE_6('C-F     ');
      665     7160    4                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 2;
      666     7161    4                   CALL CONNECT_6('SMSS-CF ');
      667     7162    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
      668     7163    4                      'FR      ', 'C-F     ' );
      669     7164    4               CASE(%CLC_QRC);
      670     7165    4                   CALL GET_WORD;
      671     7166    4                   IF WORD1 ~= LAST_RC_NAME THEN
      672     7167    5                   DO;
      673     7168    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4808);
      674     7169         /*E* ERROR: ZIG-4808-C
      675     7170                    MESSAGE: This calc key is invalid because it is not a
      676     7171                             field of the record.
      677     7172                 */
      678     7173    5                       END;
      679     7174    4                   ELSE
      680     7175    5                   DO;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:22   
      681     7176    5                       GOTO CLC;
      682     7177    5                       END;
      683     7178    4               CASE(%CLC_QFR);
      684     7179    4                   CALL GET_WORD;
      685     7180    4                   QFR_NAME = WORD1;
      686     7181    4               CASE(%NOT1); /* LOC MODE CALC...DUPS NOT ALLOWED */
      687     7182    4                   RC.CALCDUP = 1;
      688     7183    4                   CALL FETCHD_6('SM      ',DBK_SM_CALC);
      689     7184    4                   UWA.SM.CALCDUP = 1;
      690     7185    4                   CALL MODIFY_6('SM      ');
      691     7186    4               CASE(%VIA_SC_NM); /* LOCATION MODE IS VIA setname SET */
      692     7187        /* -if necessary, add SN for this set
      693     7188           -save this set's SN DBK in this record's table entry (it will
      694     7189            be checked later in SET OWNER and SET MEMBER clauses */
      695     7190    4                   CALL GET_WORD;
      696     7191    4                   CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,0);
      697     7192         /* save VIA setname SN in this record's table entry */
      698     7193    4                   LAST_RC$->TABLES.DBK_RC(0) = UWA.DIRECT_REF;
      699     7194    4                   RC.PSMODE = 2;
      700     7195    4               CASE(%INDX_KEY_NM); /* LOCATION MODE IS INDEXED USING keyname */
      701     7196        /* -if necessary, add SN for this key
      702     7197           - save the keyname so that later, we can ensure that
      703     7198            it is named in the KEY NAME IS clause */
      704     7199    4                   CALL GET_WORD;
      705     7200    4                   INDX_KEY_NM = WORD1;
      706     7201    4                   CALL ADD_SN(%ZIG_RTYPE_KC,WORD1,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,0);
      707     7202    4                   RC.PSMODE = 4;
      708     7203    4               CASE(%W_CL); /* WITHIN clause */
      709     7204    5                   IF WITHIN THEN DO;
      710     7205    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
      711     7206    5                       END;
      712     7207    4                   ELSE WITHIN = '1'B;
      713     7208    4                   IF NUM_AREAS_WITHIN = 1 THEN RC.WITHINA = 0;
      714     7209    4                   ELSE IF NUM_AREAS_WITHIN > 1 THEN RC.WITHINA = 1;
      715     7210    4               CASE(%W_AC_NM); /* WITHIN areaname */
      716     7211        /* -keep track of how many areas this record is in
      717     7212           -store RA for this area */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:23   
      718     7213    4                   CALL GET_WORD;
      719     7214    4                   IF WORD1 = 'AREA_ID' OR WORD1 = 'LOCATION' OR
      720     7215    4                      WORD1 = 'PRIVACY' OR WORD1 = 'KEY' THEN
      721     7216    5                   DO;
      722     7217    5                       PARAN.REJECT = '1'B;
      723     7218    5                       RETURN;
      724     7219    5                       END;
      725     7220    4                   NUM_AREAS_WITHIN = NUM_AREAS_WITHIN + 1;
      726     7221    4                   UWA.RA = '0'B;
      727     7222    4                   CALL ADD_SN(%ZIG_RTYPE_AC,WORD1,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,0);
      728     7223    5                   IF FOUND = %NOTFOUND THEN DO;
      729     7224    5                       CALL INDEX(CT1,' ',WORD1);
      730     7225    5                       CALL SET_FIELDS(1,CT1,WORD1);
      731     7226    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4156);
      732     7227         /*E* ERROR: ZIG-4156-C
      733     7228                 MESSAGE: The area name "%U1" has not been defined in an area
      734     7229                          entry.
      735     7230              */
      736     7231    5                       UWA.AC = '0'B;
      737     7232    5                       CALL ADD_SN(%ZIG_RTYPE_AC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);
      738     7233    5                       CALL STRE_6('AC      '); /* Pretend AC to allow
      739     7234         processing to continue */
      740     7235    5                       CALL CONNECT_6('OA-AC   ');
      741     7236    5                       UWA.OA.NUMB_AC = UWA.OA.NUMB_AC + 1;
      742     7237    5                       END;
      743     7238    4                   CALL FINDNS_6('SN-SE   '); /* AC */
      744     7239    4                   CALL FINDD_6('RC      ',LAST_RC_DBK); /* RC */
      745     7240    4                   CALL STRE_6('RA      ');
      746     7241    4                   UWA.OA.NUMB_RA = UWA.OA.NUMB_RA + 1;
      747     7242    4               CASE(%AC_LIST);
      748     7243    4               CASE(%ANY); /* WITHIN ANY AREA... */
      749     7244        /* -save this record's RC DBK to handle in pass2 */
      750     7245    4                   RC.ANY_IND = 1;
      751     7246    4                   RC.WITHINA = 1;
      752     7247    4                   CALL ZIG$G_DYN_MEM_6(3,DYNMEM$);
      753     7248    4                   DYNMEM$->WRD1 = %WITHIN_ANY;
      754     7249    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:24   
      755     7250    4                   DYNMEM$->WRD1 = LAST_RC_DBK;
      756     7251    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      757     7252    4                   DYNMEM$->WRD1 = LNO;
      758     7253    4               CASE(%EX_AC_NM); /* WITHIN ANY AREA EXCEPT areaname1[,areaname2] */
      759     7254        /* -save 30 char areanames to deal with in pass2 */
      760     7255    4                   CALL GET_WORD;
      761     7256    4                   IF WORD1 = 'AREA_ID' OR WORD1 = 'LOCATION' OR
      762     7257    4                      WORD1 = 'PRIVACY' OR WORD1 = 'KEY' THEN
      763     7258    5                   DO;
      764     7259    5                       PARAN.REJECT = '1'B;
      765     7260    5                       RETURN;
      766     7261    5                       END;
      767     7262    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
      768     7263    4                   DYNMEM$->WRD1 = %EXC_AREA;
      769     7264    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      770     7265    4                   DYNMEM$->WRD1 = LNO;
      771     7266    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
      772     7267    4                   DYNMEM$->CHAR30 = WORD1;
      773     7268    4               CASE(%AC_ID);
      774     7269    4               CASE(%AC_ID_NM); /* AREA-ID IS dbparam */
      775     7270        /* -this clause only allowed if not in only one area
      776     7271           -store SN and RFR of dbparam
      777     7272           -RFR gets connected to *DBPARAM RC
      778     7273           -store SFR and connect to this record's RC */
      779     7274    5                   IF (NUM_AREAS_WITHIN < 2) AND (RC.ANY_IND = 0) THEN DO;
      780     7275    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4111);
      781     7276         /*E* ERROR: ZIG-4111-C
      782     7277                 MESSAGE: The AREA_ID clause is allowed only when the record
      783     7278                          is in more than one area.
      784     7279              */
      785     7280    5                       END;
      786     7281    4                   CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);
      787     7282    4                   CALL GET_WORD;
      788     7283    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.INAREA,
      789     7284    4                      EXPLCT,DBK_STAR_DBPARAM_RC);
      790     7285    5                   IF FOUND = %FOUNDDEF THEN DO;
      791     7286    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4100);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:25   
      792     7287         /*E* ERROR: ZIG-4100-C
      793     7288
      794     7289                 MESSAGE: The AREA_ID clause must reference a data base
      795     7290                          parameter, not a data base identifier.
      796     7291              */
      797     7292    5                       END;
      798     7293    4                   IF FOUND = %NOTFOUND THEN
      799     7294    5                   DO;
      800     7295    5                       UWA.FR = '0'B;
      801     7296    5                       UWA.FR.REF = 1;
      802     7297    5                       UWA.FR.F_USE = 1;
      803     7298    5                       UWA.FR.PREC = 30;
      804     7299    5                       UWA.FR.F_SIGN = 1;
      805     7300    5                       UWA.FR.FTYPE = 5;
      806     7301    5                       UWA.FR.BEIST = 1; /* Misuse to signify AREA_ID dbparam */
      807     7302    5                       CALL STRE_6('FR      ');
      808     7303    5                       CALL CONNECT_6('SN-SE   ');
      809     7304    5                       UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
      810     7305    5                       UWA.FR.BEIST = 0;
      811     7306    5                       END;
      812     7307    4                   ELSE
      813     7308    5                   DO;
      814     7309    5                       CALL FETCHNS_6('SN-SE   '); /*RFR*/
      815     7310    5                       IF UWA.FR.FTYPE ~= 5 OR UWA.FR.PREC ~= 30 THEN
      816     7311    6                       DO;
      817     7312    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4101);
      818     7313         /*   ERROR: ZIG-4100-C
      819     7314            MESSAGE: An AREA_ID data base parameter must have
      820     7315            CHARACTER data type with PRECISION 30.
      821     7316         */
      822     7317    6                           END;
      823     7318    5                       END;
      824     7319    4                   UWA.FR.FR_FRH = UWA.DIRECT_REF;
      825     7320    4                   CALL FINDD_6('RC      ',LAST_RC_DBK);
      826     7321    4                   UWA.FR.SYN = 1;
      827     7322    4                   UWA.FR.F_USE = 2;
      828     7323    4                   UWA.FR.REF = 0;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:26   
      829     7324    4                   CALL STRE_6('FR      ');
      830     7325    4                   IF FIRST_SFR_DBK = 0 THEN
      831     7326    4                       FIRST_SFR_DBK = UWA.DIRECT_REF;
      832     7327        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:27   
      833     7328        /*******************************************************************
      834     7329                   record privacy locks
      835     7330        *******************************************************************/
      836     7331    4               CASE(%INSERT);
      837     7332    5                   IF RC_LKS.SC_LKS.XINSERT THEN DO;
      838     7333    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      839     7334    5                       END;
      840     7335    4                   ELSE RC_LKS.SC_LKS.XINSERT = '1'B;
      841     7336    4               CASE(%REMOVE);
      842     7337    5                   IF RC_LKS.SC_LKS.REMOVE THEN DO;
      843     7338    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      844     7339    5                       END;
      845     7340    4                   ELSE RC_LKS.SC_LKS.REMOVE = '1'B;
      846     7341    4               CASE(%STORE);
      847     7342    5                   IF RC_LKS.MISC.STORE THEN DO;
      848     7343    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      849     7344    5                       END;
      850     7345    4                   ELSE RC_LKS.MISC.STORE = '1'B;
      851     7346    4               CASE(%DELETE);
      852     7347    5                   IF RC_LKS.MISC.DELETE THEN DO;
      853     7348    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      854     7349    5                       END;
      855     7350    4                   ELSE RC_LKS.MISC.DELETE = '1'B;
      856     7351    4               CASE(%GET);
      857     7352    5                   IF RC_LKS.FR_LKS.GET THEN DO;
      858     7353    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      859     7354    5                       END;
      860     7355    4                   ELSE RC_LKS.FR_LKS.GET = '1'B;
      861     7356    4               CASE(%MODIFY);
      862     7357    5                   IF RC_LKS.FR_LKS.MODIFY THEN DO;
      863     7358    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      864     7359    5                       END;
      865     7360    4                   ELSE RC_LKS.FR_LKS.MODIFY = '1'B;
      866     7361    4               CASE(%FIND);
      867     7362    5                   IF RC_LKS.SC_LKS.FIND THEN DO;
      868     7363    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
      869     7364    5                       END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:28   
      870     7365    4                   ELSE RC_LKS.SC_LKS.FIND = '1'B;
      871     7366    4               CASE(%REC_LCK_NM);
      872     7367    4                   IF (LAST_STATUS ~= %RC_DEF AND LAST_STATUS ~= %KEY_DEF) THEN
      873     7368    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCH_DDL);
      874     7369    5                   ELSE DO;
      875     7370    5                       CALL GET_WORD;
      876     7371    5                       CALL CHECK_RESW_DUPS;
      877     7372    5                       IF RC_LKS = '0'B THEN
      878     7373    5                           RC_LKS = '1111111'B;
      879     7374    5                       CALL ADD_LOCK(WORD1, %RECORD_LOCK);
      880     7375    5                       END;
      881     7376        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:29   
      882     7377        /******************************************************************
      883     7378                   alternate key clause
      884     7379        *******************************************************************/
      885     7380    4               CASE(%ALT_KEY_NM); /* KEY NAME IS keyname */
      886     7381        /* -make sure this clause is within a record entry
      887     7382           -check if this key name matches one given in LOC MODE INDEXED
      888     7383           -if this key hasn't been mentioned already, store an SC and SO
      889     7384           for it
      890     7385           -store an SM for this key */
      891     7386    4                   UWA.SM = '0'B;
      892     7387    4                   IF (LAST_STATUS ~= %RC_DEF) AND (LAST_STATUS ~= %KEY_DEF) THEN
      893     7388    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);
      894     7389    5                   ELSE DO;
      895     7390    5                       LAST_STATUS = %KEY_DEF;
      896     7391    5                       DBK_SM_ALTKEY = 0;
      897     7392    5                       CALL GET_WORD;
      898     7393    5                       CALL ADD_SN(%ZIG_RTYPE_KC,WORD1,1,LNO,FOUND,RELTYPE.KEY_IN_REC,
              7393                                EXPLCT,0);
      899     7394    5                       IF FOUND = %FOUNDDEF THEN
      900     7395    6                       DO;
      901     7396    6                           CALL FETCHNS_6('SN-SE   ');
              7396                                    /* make current SC of this altkey */
      902     7397    6                           CALL FETCHNS_6('SC-SOSM '); /* SO or SM */
      903     7398    7                           DO WHILE (UWA.DB_STATUS ~= '0502100');
      904     7399         /* verify that each key is only primary or only secondary */
      905     7400    7                               IF (((WORD1=INDX_KEY_NM AND UWA.SM.PSMODE = 0) OR
      906     7401         /*this key is primary and a previous one wasn't */
      907     7402    7                                  (WORD1~=INDX_KEY_NM AND UWA.SM.PSMODE = 1)) AND
      908     7403         /*this key wasn't primary and a previous one was */
      909     7404    7                                  UWA.RECORD_NAME = 'SM')
      910     7405    8                               THEN DO;
      911     7406    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4154);
      912     7407        /*E* ERROR: ZIG-4154-C
      913     7408             MESSAGE: The key "%U1" has been defined as both
      914     7409                      a primary and secondary key.
      915     7410        */
      916     7411    8                                   END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:30   
      917     7412    7                               CALL FETCHNS_6('SC-SOSM '); /* SO or SM */
      918     7413    7                               DBK_SM_ALTKEY = UWA.DIRECT_REF;
      919     7414    7                               END;
      920     7415    6                           CALL FCURR_R_6('SC      ');
      921     7416    6                           UWA.SM = '0'B;
      922     7417    6                           END;
      923     7418    6                       ELSE DO;
      924     7419    6                           CALL CHECK_RESW_DUPS; /* add keyname to hash table */
      925     7420    6                           UWA.SC = '0'B;
      926     7421    6                           IF WORD1 = INDX_KEY_NM
      927     7422    6                           THEN UWA.SC.SETTYPE = 2;
      928     7423    6                           ELSE UWA.SC.SETTYPE = 3;
      929     7424    6                           UWA.SC.SEQDUP = 1;
      930     7425    6                           UWA.SC.PTRNO = 3;
      931     7426    6                           CALL STRE_6('SC      ');
      932     7427    6                           UWA.OA.NUMB_SC = UWA.OA.NUMB_SC + 1;
      933     7428    6                           CALL FETCHD_6('RC      ',DBK_STAR_SYSTEM_RC); /* RC */
      934     7429    6                           UWA.RC.SO = 1;
      935     7430    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;
      936     7431    6                           CALL MODIFY_6('RC      ');
      937     7432    6                           UWA.SO = '0'B;
      938     7433    6                           CALL STRE_6('SO      ');
      939     7434    6                           HOLD_DBK = UWA.DIRECT_REF;
      940     7435    6                           UWA.OA.NUMB_SO = UWA.OA.NUMB_SO + 1;
      941     7436    6                           CALL FINDNS_6('RC-SOSM ');
      942     7437    6                           CALL FINDD_6('SO      ',HOLD_DBK);
      943     7438    6                           CALL CONNECT_6('RC-SOSM ');
      944     7439    6                           END;
      945     7440    5                       UWA.SM.SEQDUP = 1;
              7440                                /* DUPS ALLOW; will reset if DUPS NOT ALLOW */
      946     7441    5                       IF DBK_SM_ALTKEY ~= 0 THEN
      947     7442    5                           CALL FINDD_6('SM      ',DBK_SM_ALTKEY);
      948     7443    5                       CALL FINDD_6('RC      ',LAST_RC_DBK);
      949     7444    6                       IF WORD1 = INDX_KEY_NM THEN DO; /* primary key */
      950     7445    6                           INDX_KEY_NM = 'FOUND';
      951     7446    6                           UWA.SM.PSMODE = 1;
      952     7447    6                           END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:31   
      953     7448    5                       ELSE RC.KEY_PRESENT = 1; /* secondary key */
      954     7449    5                       CALL STRE_6('SM      ');
      955     7450    5                       HOLD_DBK = UWA.DIRECT_REF;
      956     7451    5                       RC.NUM_SOSM = RC.NUM_SOSM + 1;
      957     7452    5                       UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;
      958     7453    5                       CALL FINDNS_6('RC-SOSM ');
      959     7454    5                       CALL FINDD_6('SM      ',HOLD_DBK);
      960     7455    5                       CALL CONNECT_6('RC-SOSM ');
      961     7456    5                       END;
      962     7457    4               CASE(%AKC_FR); /* KEY..ASCENDING dbid */
      963     7458        /* -check for multiple reference of keyname
      964     7459           -if necessary, add SN for this field
      965     7460           -store a SFR for this record and a SCF */
      966     7461    4   AKC:
      967     7462    4                   UWA.FR = '0'B;
      968     7463    4                   IF FOUND = %FOUNDDEF THEN /* from adding KC SN */
      969     7464    4                       UWA.FR.RPT = 1; /* signal multiple reference of key name */
      970     7465    4                   UWA.FR.SYN = 1;
      971     7466    4                   UWA.FR.REF = 1;
      972     7467    4                   UWA.FR.F_USE = 7;
      973     7468    4                   WORD1 = QFR_NAME;
      974     7469    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.FLD_IN_KEY,
      975     7470    4                      EXPLCT,LAST_RC_DBK);
      976     7471    4                   UWA.FR.FR_FRH = UWA.DIRECT_REF; /* point him to his SN */
      977     7472         /* LAST_RC_DBK is already current of set...
      978     7473            add all SFRs to front of RC-FR */
      979     7474    4                   CALL STRE_6('FR      ');
              7474                            /* rest of FR will be filled in in CLEAN_UP_REC */
      980     7475    4                   HOLD_DBK = UWA.DIRECT_REF;
      981     7476    4                   IF FIRST_SFR_DBK = 0 THEN
      982     7477    4                       FIRST_SFR_DBK = UWA.DIRECT_REF;
      983     7478    4                   UWA.C_F = '0'B;
      984     7479    4                   UWA.C_F.SYN = 1;
      985     7480    4                   UWA.C_F.CTRLTYPE = 3;
      986     7481    4                   CALL STRE_6('C-F      ');
      987     7482    4                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
      988     7483    4                   CALL CONNECT_6('SMSS-CF ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:32   
      989     7484    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
      990     7485    4                      'FR      ', 'C-F     ' );
      991     7486    4               CASE(%AKC_QRC);
      992     7487    4                   CALL GET_WORD;
      993     7488    4                   IF WORD1 ~= LAST_RC_NAME THEN
      994     7489    5                   DO;
      995     7490    5                       CALL INDEX(CT1,' ',QFR_NAME);
      996     7491    5                       CALL SET_FIELDS(1,CT1,QFR_NAME);
      997     7492    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4809);
      998     7493         /*E* ERROR: ZIG-4809-C
      999     7494                    MESSAGE: The record name qualifier used is not the correct
     1000     7495                             one for field "%U1".  Qualifier ignored.
     1001     7496                 */
     1002     7497    5                       END;
     1003     7498    4                   ELSE
     1004     7499    5                   DO;
     1005     7500    5                       GOTO AKC;
     1006     7501    5                       END;
     1007     7502    4               CASE(%AKC_QFR);
     1008     7503    4                   CALL GET_WORD;
     1009     7504    4                   QFR_NAME = WORD1;
     1010     7505    4               CASE(%NOT2); /* KEY...ASCENDING...DUPS ARE NOT ALLOWED */
     1011     7506        /* -update the relevant SC and SM  for this key */
     1012     7507    4                   IF INDX_KEY_NM = 'FOUND' THEN /* primary key */
     1013     7508    4                       INDX_KEY_NM = 'NOT';
     1014     7509    4                   IF UWA.SC.SEQDUP ~= 2 THEN /* a previous altkey was DUP allowed */
     1015     7510    4                       IF UWA.FR.RPT = 1 THEN /* a previous altkey mention was made */
     1016     7511    4                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4148);
     1017     7512         /*E* ERROR: ZIG-4148-C
     1018     7513                      MESSAGE: DUPLICATES have been specified for this key
     1019     7514                               so DUPLICATES NOT cannot now be specified.
     1020     7515                   */
     1021     7516    5                       ELSE DO; /* this is first mention of this altkey */
     1022     7517    5                           CALL FCURR_R_6('SC      ');
     1023     7518    5                           CALL FETCHD_6('SC      ',UWA.DIRECT_REF);
     1024     7519    5                           UWA.SC.SEQDUP = 2;
     1025     7520    5                           CALL MODIFY_6('SC      ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:33   
     1026     7521    5                           CALL FCURR_R_6('SM      ');
     1027     7522    5                           CALL FETCHD_6('SM      ',UWA.DIRECT_REF);
     1028     7523    5                           UWA.SM.SEQDUP = 2;
     1029     7524    5                           CALL MODIFY_6('SM      ');
     1030     7525    5                           END;
     1031     7526    5                   ELSE DO; /* prev altkey was DUPS NOT and so is this one */
     1032     7527    5                       CALL FCURR_R_6('SM      ');
     1033     7528    5                       CALL FETCHD_6('SM      ',UWA.DIRECT_REF);
     1034     7529    5                       UWA.SM.SEQDUP = 2;
     1035     7530    5                       CALL MODIFY_6('SM      ');
     1036     7531    5                       END;
     1037     7532        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:34   
     1038     7533        /********************************************************************
     1039     7534                   data entry
     1040     7535        ********************************************************************/
     1041     7536    4               CASE(%FR_ENT);
     1042     7537    4                   IF NEED_LARGER_SCHEMA
     1043     7538    5                   THEN DO;
     1044     7539    5                       CALL SF_CLOSE(1,STATUS);
     1045     7540    5                       CALL SF_OPEN(1,STATUS);
     1046     7541    5                       NEED_LARGER_SCHEMA = '0'B;
     1047     7542    5                       CALL RESTORE_CURRENTS;
     1048     7543    5                       CALL FETCHD_6('RC      ',LAST_RC_DBK);
     1049     7544    5                       END;
     1050     7545    4               CASE(%LEVEL_NUM); /* level_number... */
     1051     7546    4                   IF (LAST_STATUS = %RC_DEF) OR (LAST_STATUS = %FR_DEF)
     1052     7547    4                      OR (LAST_STATUS = %KEY_DEF)
     1053     7548    5                   THEN DO;
     1054     7549    5                       CALL GET_NUM;
     1055     7550    5                       IF LEV_NUM = 0 THEN /* first field in record */
     1056     7551    5                           LEV_NUM = NUM;
     1057     7552    5                       ELSE
     1058     7553    5                           IF LEV_NUM ~= NUM /* compare with prev lev num */
     1059     7554    6                           THEN DO;
     1060     7555    6                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4057);
     1061     7556        /*E* ERROR: ZIG-4057-C
     1062     7557             MESSAGE: The level entry %U1 is inconsistent with
     1063     7558                      others of this subentry.
     1064     7559        */
     1065     7560    6                               END;
     1066     7561    5                       IF (NUM < 1) OR (NUM > 99) THEN
     1067     7562    5                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4059);
     1068     7563        /*E* ERROR: ZIG-4059-C
     1069     7564             MESSAGE: The level numbers must be in the range of 1-99.
     1070     7565        */
     1071     7566    5                       UWA.FR.LEVEL = NUM;
     1072     7567    5                       END;
     1073     7568    4               CASE(%FR_NM); /* level_number fieldname */
     1074     7569        /* -ensure that this field entry is within a record entry */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:35   
     1075     7570    4                   UWA.FR = '0'B;
     1076     7571    4                   TYPE = '0'B;
     1077     7572    4                   NEG_SCALE = '0'B;
     1078     7573    4                   IF (LAST_STATUS ~= %RC_DEF) AND (LAST_STATUS ~= %FR_DEF) AND
     1079     7574    4                      (LAST_STATUS ~= %KEY_DEF)
     1080     7575    5                   THEN DO;
     1081     7576    5                       MOD_FR_OK = '0'B;
     1082     7577    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);
     1083     7578    5                       END;
     1084     7579    5                   ELSE DO;
     1085     7580    5                       MOD_FR_OK = '1'B;
     1086     7581    5                       LAST_STATUS = %FR_DEF;
     1087     7582    5                       CALL GET_WORD;
     1088     7583    5                       CALL CHECK_RESW_DUPS;
     1089     7584    5                       CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,
              7584                                LAST_RC_DBK);
     1090     7585    5                       LAST_LOCKABLE_DBK = UWA.DIRECT_REF;
     1091     7586         /* If found,then a forward reference was made to this item
     1092     7587            in loc mode calc or key is keyname
     1093     7588            ascending clause.
     1094     7589            For loc mode
     1095     7590            calc references, an RFR has already been made and must be
     1096     7591            fetched in order to be filled in.  For alternate keys, an
     1097     7592            SFR has been made, but not connected to the SN, and a RFR
     1098     7593            must be made.  The SFR will get filled in later in CLEAN_UP_REC.
     1099     7594            Of course, if no forward reference has been made, a RFR
     1100     7595            must be generated. */
     1101     7596    6                       IF (FOUND = %FOUNDDEF) THEN DO;
     1102     7597    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4048);
     1103     7598        /*E* ERROR: ZIG-4048-C
     1104     7599             MESSAGE: The field "%U1" has already been declared in this
     1105     7600                      record.
     1106     7601        */
     1107     7602    6                           END;
     1108     7603    5                       CALL FETCHNS_6('SN-SE   '); /* get the RFR for calc */
     1109     7604         /* for altkeys, no FR will be found */
     1110     7605    5                       IF (UWA.DB_STATUS = '0502100') OR /* or alternate key */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:36   
     1111     7606    6                          FOUND = %NOTFOUND THEN DO;
              7606                                   /* no forward reference was made */
     1112     7607         /* restore owner for connect */
     1113     7608    6                           CALL FINDD_6('SN      ',LAST_LOCKABLE_DBK);
     1114     7609         /* add all RFRs after all SFRs */
     1115     7610    6                           IF FIRST_SFR_DBK ~= 0
     1116     7611    7                           THEN DO;
     1117     7612    7                               CALL FINDD_6('FR      ',FIRST_SFR_DBK);
     1118     7613    7                               CALL FCURR_R_6('SN      ');
     1119     7614    7                               END;
     1120     7615    6                           UWA.FR = '0'B;
     1121     7616    6                           UWA.FR.FTYPE = 99;
     1122     7617    6                           CALL STRE_6('FR      '); /* real FR */
     1123     7618    6                           UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;
     1124     7619    6                           CALL CONNECT_6('SN-SE   ');
     1125     7620    6                           END;
     1126     7621    6                       ELSE DO;
     1127     7622    6                           HOLD_DBK = UWA.DIRECT_REF;
     1128     7623    6                           CALL FINDOS_6('RC-FR   ');
     1129     7624    6                           CALL FINDD_6('FR      ',HOLD_DBK);
     1130     7625    6                           CALL MODIFYMEM_6('FR      ');
     1131     7626    6                           END;
     1132     7627    5                       UWA.FR.F_OCCURS = 0;
     1133     7628    5                       UWA.FR.LEVEL = NUM;
     1134     7629    5                       END;
     1135     7630    4               CASE(%IPRIV);
     1136     7631    4                   RC_LKS.FR_LKS = '0'B;
     1137     7632    4               CASE(%FIXED); /* TYPE IS FIXED BINARY */
     1138     7633    4                   UWA.FR.FTYPE = 1; /* DEFAULT */
     1139     7634    4               CASE(%FLOAT); /* TYPE IS FLOAT HEX */
     1140     7635    4                   UWA.FR.FTYPE = 11; /* DEFAULT */
     1141     7636    4               CASE(%BINARY);
     1142     7637    4                   UWA.FR.PREC = 35; /* DEFAULT */
     1143     7638    4                   IF UWA.FR.FTYPE ~= 11 THEN UWA.FR.FTYPE = 1;
     1144     7639    5                   IF TYPE THEN DO;
     1145     7640    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1146     7641    5                       END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:37   
     1147     7642    4                   ELSE TYPE = '1'B;
     1148     7643    4               CASE(%BIN_INT); /* TYPE IS ...BINARY integer */
     1149     7644    4                   CALL GET_NUM;
     1150     7645    4                   UWA.FR.PREC = NUM;
     1151     7646    4                   IF UWA.FR.FTYPE = 1 THEN /* FIXED */
     1152     7647    4                       IF NUM <= 17 THEN /* HALF WORD */
     1153     7648    4                           UWA.FR.FTYPE = 2;
     1154     7649    4                       ELSE /* WHOLE WORD */
     1155     7650    4                           IF NUM >= 36 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              7650                                    4053);
     1156     7651        /*E* ERROR: ZIG-4053-C
     1157     7652             MESSAGE: The number of binary digits  must be 1-35.
     1158     7653        */
     1159     7654    4                           ELSE ; /* DEFAULTS HAVE ALREADY BEEN SET */
     1160     7655    4                   ELSE /* FLOAT */
     1161     7656    4                       IF NUM = 71 THEN /* DOUBLE PRECISION */
     1162     7657    4                           UWA.FR.FTYPE = 12;
     1163     7658    4                       ELSE /* SINGLE PRECISION */
     1164     7659    5                           IF NUM ~= 35 THEN DO;
     1165     7660    5                               UWA.FR.PREC = 35;
     1166     7661    5                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4161);
     1167     7662        /*E* ERROR: ZIG-4161-C
     1168     7663             MESSAGE: The number of binary digits must be 35 or 71.
     1169     7664                      The default value of 35 has been assigned.
     1170     7665        */
     1171     7666    5                               END;
     1172     7667    4               CASE(%DEC_INT); /* TYPE IS DECIMAL integer...*/
     1173     7668    5                   IF TYPE THEN DO;
     1174     7669    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1175     7670    5                       END;
     1176     7671    4                   ELSE TYPE = '1'B;
     1177     7672    4                   CALL GET_NUM;
     1178     7673    5                   IF NUM > 63 THEN DO;
     1179     7674    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4052);
     1180     7675        /*E* ERROR: ZIG-4052-C
     1181     7676             MESSAGE: The number of decimal digits allowed is 1-63.
     1182     7677        */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:38   
     1183     7678    5                       END;
     1184     7679    4                   UWA.FR.FTYPE = 3;
     1185     7680    4                   UWA.FR.PREC = NUM;
     1186     7681    4               CASE(%PLUS);
     1187     7682    4                   IF NUM > 62 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4058);
     1188     7683        /*E* ERROR: ZIG-4058-C
     1189     7684             MESSAGE: The number of digits in a signed decimal item cannot
     1190     7685                      exceed 62.
     1191     7686        */
     1192     7687    4               CASE(%MINUS);
     1193     7688    4                   NEG_SCALE = '1'B;
     1194     7689    4                   IF NUM > 62 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4058);
     1195     7690    4               CASE(%SCALE_INT); /* TYPE IS DECIMAL n,integer... */
     1196     7691    4                   CALL GET_NUM;
     1197     7692    5                   IF (NUM < -31) OR (NUM > 32) THEN DO;
     1198     7693    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4054);
     1199     7694        /*E* ERROR: ZIG-4054-C
     1200     7695             MESSAGE: The scale factor for a decimal data item must be in
     1201     7696                      the range of -32 to +33.
     1202     7697        */
     1203     7698    5                       END;
     1204     7699    4                   IF NEG_SCALE THEN
     1205     7700    4                       NUM = -1 * NUM;
     1206     7701    4                   UWA.FR.SCALE = NUM;
     1207     7702    4               CASE(%SIGNED); /* TYPE IS DECIMAL n,m SIGNED */
     1208     7703    4                   UWA.FR.FTYPE = 4;
     1209     7704    4                   UWA.FR.F_SIGN = 1;
     1210     7705    4               CASE(%CHAR_INT); /* TYPE IS CHARACTER integer */
     1211     7706    5                   IF TYPE THEN DO;
     1212     7707    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1213     7708    5                       END;
     1214     7709    4                   ELSE TYPE = '1'B;
     1215     7710    4                   CALL GET_NUM;
     1216     7711    5                   IF (NUM > 4095) OR (NUM < 1) THEN DO;
     1217     7712    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4056);
     1218     7713    5                       END;
     1219     7714        /*E* ERROR: ZIG-4056-C
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:39   
     1220     7715             MESSAGE: The length of a character or unspecified data item
     1221     7716                      must be in the range of 1 to 4095.
     1222     7717        */
     1223     7718    4                   UWA.FR.FTYPE = 5;
     1224     7719    4                   UWA.FR.PREC = NUM;
     1225     7720    4               CASE(%VARYING); /* TYPE IS CHARACTER n VARYING */
     1226     7721    5                   IF FOUND = %FOUNDREF THEN DO;
              7721                            /* a forward ref was made to this so it */
     1227     7722    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4832);
              7722                                /* must be some kind of control field */
     1228     7723        /*E* ERROR: ZIG-4832-C
     1229     7724             MESSAGE: The reference to the field "%U1" is invalid because
     1230     7725                      a field which has a data type of CHARACTER VARYING
     1231     7726                      cannot be a control field.
     1232     7727        */
     1233     7728    5                       END;
     1234     7729    4                   UWA.FR.FTYPE = 19;
     1235     7730    4                   RC.FIXVAR = RC.FIXVAR + 1;
     1236     7731    4               CASE(%DBKEY); /* TYPE IS DBKEY */
     1237     7732    5                   IF TYPE THEN DO;
     1238     7733    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1239     7734    5                       END;
     1240     7735    4                   ELSE TYPE = '1'B;
     1241     7736    4                   UWA.FR.FTYPE = 0;
     1242     7737    4                   UWA.FR.PREC = 35;
     1243     7738    4               CASE(%UNSPEC_INT); /* TYPE IS UNSPECIFIED integer */
     1244     7739    5                   IF TYPE THEN DO;
     1245     7740    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1246     7741    5                       END;
     1247     7742    4                   ELSE TYPE = '1'B;
     1248     7743    4                   CALL GET_NUM;
     1249     7744    5                   IF NUM > 4095 THEN DO;
     1250     7745    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4056);
     1251     7746    5                       END;
     1252     7747    4                   UWA.FR.FTYPE = 9;
     1253     7748    4                   UWA.FR.PREC = NUM;
     1254     7749        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:40   
     1255     7750        /********************************************************************
     1256     7751                  field privacy locks
     1257     7752        ********************************************************************/
     1258     7753    4               CASE(%DGET);
     1259     7754    5                   IF RC_LKS.FR_LKS.GET THEN DO;
     1260     7755    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
     1261     7756    5                       END;
     1262     7757    4                   ELSE RC_LKS.FR_LKS.GET = '1'B;
     1263     7758    4               CASE(%DMODIFY);
     1264     7759    5                   IF RC_LKS.FR_LKS.MODIFY THEN DO;
     1265     7760    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
     1266     7761    5                       END;
     1267     7762    4                   ELSE RC_LKS.FR_LKS.MODIFY = '1'B;
     1268     7763    4               CASE(%FR_LCK_NM);
     1269     7764    4                   IF LAST_STATUS ~= %FR_DEF THEN
     1270     7765    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCH_DDL);
     1271     7766    5                   ELSE DO;
     1272     7767    5                       CALL GET_WORD;
     1273     7768    5                       CALL CHECK_RESW_DUPS;
     1274     7769    5                       IF RC_LKS.FR_LKS = '0'B THEN
     1275     7770    5                           RC_LKS.FR_LKS = '11'B;
     1276     7771    5                       CALL ADD_LOCK(WORD1, %ITEM_LOCK);
     1277     7772    5                       END;
     1278     7773        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:41   
     1279     7774        /*******************************************************************
     1280     7775            set entry
     1281     7776        *******************************************************************/
     1282     7777    4               CASE(%SC_ENT);
     1283     7778    4               CASE(%SC_NM); /* SET NAME IS setname */
     1284     7779        /* -init clause flags
     1285     7780           -clean up a previous record entry
     1286     7781           -increase schema size if necessary
     1287     7782           -if necessary, store SN for this set
     1288     7783           -store SC for this set */
     1289     7784    4                   FIRST_MEMBER = '1'B;
     1290     7785    4                   PERM = '0'B;
     1291     7786    4                   OWNER = '0'B;
     1292     7787    4                   PRIOR = '0'B;
     1293     7788    4                   ORDER = '0'B;
     1294     7789    4                   OWNER_CLAUSE_FOUND = '0'B;
     1295     7790    4                   IF REC_ENTRY_DONE THEN
     1296     7791    4                       CALL CLEAN_UP_REC;
     1297     7792    4                   IF NEED_LARGER_SCHEMA
     1298     7793    5                   THEN DO;
     1299     7794    5                       CALL SF_CLOSE(1,STATUS);
     1300     7795    5                       CALL SF_OPEN(1,STATUS);
     1301     7796    5                       NEED_LARGER_SCHEMA = '0'B;
     1302     7797    5                       CALL RESTORE_CURRENTS;
     1303     7798    5                       END;
     1304     7799    4                   LAST_STATUS = %SC_DEF;
     1305     7800    4                   CALL GET_WORD;
     1306     7801    4                   CURR_SETNAME = WORD1;
     1307     7802    4                   CALL CHECK_RESW_DUPS;
     1308     7803    4                   CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);
     1309     7804    4                   LAST_LOCKABLE_DBK = UWA.DIRECT_REF;
     1310     7805    5                   IF FOUND = %FOUNDDEF THEN DO;
     1311     7806    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4071);
     1312     7807        /*E* ERROR: ZIG-4071-C
     1313     7808             MESSAGE: The name "%U1" has already been assigned to a set.
     1314     7809        */
     1315     7810    5                       END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:42   
     1316     7811    4                   LAST_SC_SN = UWA.DIRECT_REF;
     1317     7812    4                   UWA.SC = '0'B;
     1318     7813    4                   UWA.SC.PTRNO = 3;
     1319     7814    4                   UWA.SC.SEQDUP = 2;
     1320     7815    4                   CALL STRE_6('SC      ');
     1321     7816    4                   LAST_SC_DBK = UWA.DIRECT_REF;
     1322     7817    4                   UWA.OA.NUMB_SC = UWA.OA.NUMB_SC + 1;
     1323     7818    4               CASE(%SPRIV);
     1324     7819    4                   RC_LKS.SC_LKS = '0'B;
     1325     7820    4               CASE(%OWN_REC_NM); /* OWNER IS recordname */
     1326     7821        /* -make sure this is only OWNER clause for this set
     1327     7822           -make sure this set wasn't named in this record's LOC MODE clause
     1328     7823           -make sure this record has already been defined
     1329     7824           -store an SO for this record */
     1330     7825    4                   OWNER_CLAUSE_FOUND = '1'B;
     1331     7826    5                   IF OWNER THEN DO;
     1332     7827    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1333     7828    5                       END;
     1334     7829    4                   ELSE OWNER = '1'B;
     1335     7830    4                   CALL GET_WORD;
     1336     7831    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,LNO,FOUND,RELTYPE.SO,EXPLCT,0);
     1337     7832    5                   IF LAST_RC$->TABLES.DBK_RC(0) = LAST_SC_SN THEN DO;
              7832                            /* VIA this SC */
     1338     7833    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4807);
     1339     7834        /*E* ERROR: ZIG-4807-C
     1340     7835             MESSAGE: The LOCATION MODE clause is invalid because the
     1341     7836                      the record is the OWNER of the set.
     1342     7837        */
     1343     7838    5                       END;
     1344     7839    5                   IF FOUND ~= %FOUNDDEF THEN DO;
     1345     7840    5                       SET_ERROR = '1'B;
     1346     7841    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4211);
     1347     7842        /*E* ERROR: ZIG-4211-C
     1348     7843             MESSAGE: The record name "%U1" cannot be matched with a record
     1349     7844                      name in the schema dictionary.
     1350     7845        */
     1351     7846    6                       IF FIRST_SET_ERROR THEN DO;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:43   
     1352     7847    6                           FIRST_SET_ERROR = '0'B;
     1353     7848    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4079);
     1354     7849        /*E* ERROR: ZIG-4079-C
     1355     7850             MESSAGE: Records must be declared before they are referenced
     1356     7851                      by a set subentry.
     1357     7852        */
     1358     7853    6                           END;
     1359     7854    5                       END;
     1360     7855    5                   ELSE DO;
     1361     7856    5                       CALL FETCHNS_6('SN-SE   '); /* RC */
     1362     7857    5                       IF UWA.RC.PSMODE = 4 THEN /* INDEXED */
     1363     7858    6                       DO;
     1364     7859    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4855);
     1365     7860        /*E* ERROR: ZIG-4855-C
     1366     7861             MESSAGE: Records that are LOCATION MODE INDEXED cannot
     1367     7862                      participate as the owner or member of a set.
     1368     7863        */
     1369     7864    6                           END;
     1370     7865    6                       IF FOUND = %FOUNDDEF THEN DO;
     1371     7866    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;
     1372     7867    6                           UWA.RC.SO = 1;
     1373     7868    6                           CALL MODIFY_6('RC      ');
     1374     7869    6                           UWA.SO = '0'B;
     1375     7870    6                           CALL STRE_6('SO      ');
     1376     7871    6                           LAST_SO_DBK = UWA.DIRECT_REF;
     1377     7872    6                           CALL FINDNS_6('RC-SOSM '); /* SO or SM */
     1378     7873    6                           CALL FINDD_6('SO      ',LAST_SO_DBK);
     1379     7874    6                           CALL CONNECT_6('RC-SOSM ');
     1380     7875    6                           UWA.OA.NUMB_SO = UWA.OA.NUMB_SO + 1;
     1381     7876    6                           END;
     1382     7877    5                       END; /* ELSE */
     1383     7878    4               CASE(%PRIOR_CL); /* SET IS PRIOR PROCESSABLE */
     1384     7879    5                   IF PRIOR THEN DO;
     1385     7880    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1386     7881    5                       END;
     1387     7882    4                   ELSE PRIOR = '1'B;
     1388     7883    4               CASE(%ORDER_CL); /* ORDER IS PERMANENT */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:44   
     1389     7884    5                   IF ORDER THEN DO;
     1390     7885    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1391     7886    5                       END;
     1392     7887    4                   ELSE ORDER = '1'B;
     1393     7888    4               CASE(%PERM);
     1394     7889    4                   PERM = '1'B;
     1395     7890    4               CASE(%FIRST); /* INSERTION IS FIRST */
     1396     7891    4                   UWA.SC.SETORD = 0;
     1397     7892    4               CASE(%LAST); /* INSERTION IS LAST */
     1398     7893    4                   UWA.SC.SETORD = 1;
     1399     7894    4               CASE(%NEXT); /* INSERTION IS NEXT */
     1400     7895    4                   UWA.SC.SETORD = 2;
     1401     7896    4               CASE(%PRIOR); /* INSERTION IS PRIOR */
     1402     7897    4                   UWA.SC.SETORD = 3;
     1403     7898    4               CASE(%IN_REC); /* INSERTION IS SORTED WITHIN RECORD_NAME */
     1404     7899    4                   UWA.SC.SETORD = 6;
     1405     7900    4               CASE(%BY_KEY); /* INSERTION IS SORTED BY DEFINED KEYS... */
     1406     7901    4                   UWA.SC.SETORD = 4;
     1407     7902    4               CASE(%SFIRST); /* INSERTION SORTED...DUPS ARE FIRST ALLOWED */
     1408     7903    4                   UWA.SC.SEQDUP = 0;
     1409     7904    4               CASE(%SLAST); /* INSERTION SORTED...DUPS ARE LAST ALLOWED */
     1410     7905    4                   UWA.SC.SEQDUP = 1;
     1411     7906    4               CASE(%S_NOT); /* INSERTION SORTED...DUPS ARE NOT ALLOWED */
     1412     7907    4                   UWA.SC.SEQDUP = 2;
     1413     7908        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:45   
     1414     7909        /*******************************************************************
     1415     7910                 set privacy locks
     1416     7911        *******************************************************************/
     1417     7912    4               CASE(%SINSERT);
     1418     7913    5                   IF RC_LKS.SC_LKS.XINSERT THEN DO;
     1419     7914    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
     1420     7915    5                       END;
     1421     7916    4                   ELSE RC_LKS.SC_LKS.XINSERT = '1'B;
     1422     7917    4               CASE(%SREMOVE);
     1423     7918    5                   IF RC_LKS.SC_LKS.REMOVE THEN DO;
     1424     7919    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
     1425     7920    5                       END;
     1426     7921    4                   ELSE RC_LKS.SC_LKS.REMOVE = '1'B;
     1427     7922    4               CASE(%SFIND);
     1428     7923    5                   IF RC_LKS.SC_LKS.FIND THEN DO;
     1429     7924    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
     1430     7925    5                       END;
     1431     7926    4                   ELSE RC_LKS.SC_LKS.FIND = '1'B;
     1432     7927    4               CASE(%SC_LCK_NM);
     1433     7928    4                   IF LAST_STATUS ~= %SC_DEF THEN
     1434     7929    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);
     1435     7930    5                   ELSE DO;
     1436     7931    5                       CALL GET_WORD;
     1437     7932    5                       CALL CHECK_RESW_DUPS;
     1438     7933    5                       IF RC_LKS.SC_LKS = '0'B THEN
     1439     7934    5                           RC_LKS.SC_LKS = '111'B;
     1440     7935    5                       CALL ADD_LOCK(WORD1, %SET_LOCK);
     1441     7936    5                       END;
     1442     7937        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:46   
     1443     7938        /******************************************************************
     1444     7939                 member subentry
     1445     7940        ******************************************************************/
     1446     7941    4               CASE(%MEM_ENT);
     1447     7942    4               CASE(%MEM_REC_NM); /* MEMBER IS recordname */
     1448     7943        /* -init clause flags
     1449     7944           -make sure this member entry is within a set entry
     1450     7945           -check if this set named in this record's LOC MODE clause
     1451     7946           -make sure this record has already been defined
     1452     7947           -make sure this record wasn't previously defined in this set
     1453     7948           -store an SM for this record and a SS */
     1454     7949    4                   IF ~ OWNER_CLAUSE_FOUND THEN
     1455     7950    4                       UNWIND TO SYNTAX_ERR;
     1456     7951    4                   LINKED = '0'B;
     1457     7952    4                   SELECTION = '0'B;
     1458     7953    4                   FLAG_ERROR = '0'B;
     1459     7954    4                   IF (LAST_STATUS ~= %SC_DEF) AND (LAST_STATUS ~= %MEM_DEF)
     1460     7955    5                   THEN DO;
     1461     7956    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);
     1462     7957    5                       UNWIND TO SYNTAX_ERR;
     1463     7958    5                       END;
     1464     7959    5                   ELSE DO;
     1465     7960    5                       LAST_STATUS = %MEM_DEF;
     1466     7961    5                       CALL GET_WORD;
     1467     7962    5                       CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,LNO,FOUND,RELTYPE.SM,EXPLCT,0)
              7962                                ;
     1468     7963    6                       IF FOUND ~= %FOUNDDEF THEN DO;
     1469     7964    6                           FLAG_ERROR = '1'B;
     1470     7965    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4211);
     1471     7966    7                           IF FIRST_SET_ERROR THEN DO;
     1472     7967    7                               FIRST_SET_ERROR = '0'B;
     1473     7968    7                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4079);
     1474     7969    7                               END;
     1475     7970    6                           END;
     1476     7971    6                       ELSE DO;
     1477     7972    6                           CALL FETCHNS_6('SN-SE   '); /* RC */
     1478     7973    6                           LAST_RC_DBK = UWA.DIRECT_REF;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:47   
     1479     7974    6                           LAST_RC_NAME = WORD1;
     1480     7975    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;
     1481     7976    6                           UWA.RC.SM = 1;
     1482     7977    6                           CALL MODIFY_6('RC      ');
     1483     7978         /* make sure this record wasn't declared previously in this set */
     1484     7979    6                           CALL FETCHPS_6('RC-SOSM '); /* SO or SM */
     1485     7980    7                           IF UWA.DB_STATUS = '0000000' THEN DO;
     1486     7981    7                               CALL FINDOS_6('SC-SOSM ');
              7981                                        /* SC that last referenced this RC */
     1487     7982    7                               IF LAST_SC_DBK = UWA.DIRECT_REF
              7982                                        /* already mentioned in this set */
     1488     7983    8                               THEN IF UWA.RECORD_NAME = 'SO' THEN DO;
     1489     7984    8                                       FLAG_ERROR = '1'B;
     1490     7985    8                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4084);
     1491     7986        /*E* ERROR: ZIG-4084-C
     1492     7987             MESSAGE: A record cannot be both the owner and a member of
     1493     7988                      the same set.
     1494     7989        */
     1495     7990    8                                       END;
     1496     7991    8                                   ELSE DO;
     1497     7992    8                                       FLAG_ERROR = '1'B;
     1498     7993    8                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4085);
     1499     7994        /*E* ERROR: ZIG-4085-C
     1500     7995             MESSAGE: This record is already declared as a member of this
     1501     7996                      set.
     1502     7997        */
     1503     7998    8                                       END;
     1504     7999    7                               END; /* IF */
     1505     8000    7                           IF NOT FLAG_ERROR THEN DO;
     1506     8001    7                               CALL FINDD_6('SO      ',LAST_SO_DBK);
              8001                                        /* add SMs after SOs */
     1507     8002    7                               CALL FINDOS_6('SC-SOSM ');
     1508     8003    7                               CALL FINDPS_6('SC-SOSM ');
     1509     8004    7                               CALL FETCHD_6('RC      ',LAST_RC_DBK);
              8004                                        /* restore RC currency */
     1510     8005    7                               UWA.SM = '0'B;
     1511     8006    7                               UWA.SM.INSTYPE = 9;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:48   
     1512     8007    7                               UWA.SM.RETTYPE = 9;
     1513     8008    7                               IF (UWA.RC.PSMODE = 2) /* via */
     1514     8009    7                                  AND (LAST_RC$->TABLES.DBK_RC(0) = LAST_SC_SN)
              8009                                           /* via this set */
     1515     8010    8                               THEN DO;
     1516     8011    8                                   UWA.SM.PSMODE = 1;
     1517     8012    8                                   END;
     1518     8013    7                               IF (LAST_RC$->TABLES.DBK_RC(0) = LAST_SC_SN)
              8013                                        /* VIA this SC */
     1519     8014    7                               THEN LAST_RC$->TABLES.DBK_RC(0) = 0;
              8014                                        /* if any ~0 in pas2,err */
     1520     8015    7                               IF UWA.RC.PSMODE = 4 THEN /* INDEXED */
     1521     8016    8                               DO;
     1522     8017    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4855);
     1523     8018    8                                   END;
     1524     8019    7                               UWA.SM.SEQDUP = UWA.SC.SEQDUP;
     1525     8020    7                               CALL STRE_6('SM      ');
     1526     8021    7                               LAST_SM_DBK = UWA.DIRECT_REF;
     1527     8022    7                               CALL FINDNS_6('RC-SOSM ');
     1528     8023    7                               CALL FINDD_6('SM      ',LAST_SM_DBK);
     1529     8024    7                               CALL CONNECT_6('RC-SOSM ');
     1530     8025    7                               UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;
     1531     8026    7                               UWA.S_S = '0'B;
     1532     8027    7                               UWA.S_S.STYP = 2;
     1533     8028    7                               UWA.S_S.SC_SSH = LAST_SC_DBK;
     1534     8029    7                               UWA.S_S.SOSM_SSH = LAST_SO_DBK;
     1535     8030    7                               CALL STRE_6('S-S      ');
     1536     8031    7                               UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;
     1537     8032    7                               END; /* IF */
     1538     8033    6                           END; /* ELSE */
     1539     8034    5                       END;
     1540     8035    4               CASE(%AUTO); /* INSERTION IS AUTOMATIC */
     1541     8036    4                   UWA.SM.INSTYPE = 0;
     1542     8037    4               CASE(%MANUAL); /* INSERTION IS MANUAL */
     1543     8038    4                   UWA.SM.INSTYPE = 1;
     1544     8039    4               CASE(%MANDATORY); /* RETENTION IS MANDATORY */
     1545     8040    4                   UWA.SM.RETTYPE = 0;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:49   
     1546     8041    4               CASE(%OPTIONAL); /* RETENTION IS OPTIONAL */
     1547     8042    4                   UWA.SM.RETTYPE = 1;
     1548     8043    4               CASE(%LINKED); /* LINKED TO OWNER */
     1549     8044    4                   LINKED = '1'B;
     1550     8045        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:50   
     1551     8046        /******************************************
     1552     8047        *  DUPS NOT ALLOWED clause                *
     1553     8048        ******************************************/
     1554     8049    4               CASE(%NOT3); /* DUPS NOT ALLOWED FOR... */
     1555     8050    4                   CALL FINDD_6('SM      ',LAST_SM_DBK);
     1556     8051    4                   UWA.SM.MEMDUP = 1;
     1557     8052    4                   CALL MODIFY_6('SM      ');
     1558     8053    4               CASE(%DUP_FR); /* DUPS NOT ALLOWED FOR dbid[,dbidn] */
     1559     8054        /* -make sure this field has been defined
     1560     8055           -update FR to show that it owns a CF
     1561     8056           -make sure this field was defined in this member record
     1562     8057           -store a CF off this record's SM */
     1563     8058    4   DUP:
     1564     8059    4                   WORD1 = QFR_NAME;
     1565     8060    4                   IF WORD1 = 'KEY' OR WORD1 = 'IS' OR
     1566     8061    4                      WORD1 = 'ASC' OR WORD1 = 'ASCENDING' OR
     1567     8062    4                      WORD1 = 'DESC' OR WORD1 = 'DESCENDING' OR
     1568     8063    4                      WORD1 = 'SET' OR WORD1 = 'SELECTION' THEN
     1569     8064    5                   DO;
     1570     8065    5                       PARAN.REJECT = '1'B;
     1571     8066    5                       RETURN;
     1572     8067    5                       END;
     1573     8068    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.DUP,
     1574     8069    4                      EXPLCT,LAST_RC_DBK);
     1575     8070    5                   IF (FOUND ~= %FOUNDDEF) THEN DO;
     1576     8071    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4820);
     1577     8072        /*E* ERROR: ZIG-4820-C
     1578     8073             MESSAGE: The DUPLICATES NOT ALLOWED FOR field %U1 is invalid
     1579     8074                      because it is not a field of the record.
     1580     8075        */
     1581     8076    5                       END;
     1582     8077    5                   ELSE DO;
     1583     8078    5                       CALL FETCHNS_6('SN-SE   '); /* FR */
     1584     8079    5                       HOLD_DBK = UWA.DIRECT_REF;
     1585     8080    5                       UWA.FR.REF = 1;
     1586     8081    5                       CALL MODIFY_6('FR      ');
     1587     8082    5                       CALL FINDOS_6('RC-FR   '); /* RC */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:51   
     1588     8083    6                       IF UWA.DIRECT_REF ~= LAST_RC_DBK THEN DO;
     1589     8084    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4820);
     1590     8085    6                           END;
     1591     8086    6                       ELSE DO;
     1592     8087    6                           CALL FINDD_6('SM      ',LAST_SM_DBK);
     1593     8088    6                           UWA.C_F = '0'B;
     1594     8089    6                           UWA.C_F.CTRLTYPE = 1; /* duplicate control */
     1595     8090    6                           CALL STRE_6('C-F     ');
     1596     8091    6                           UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
     1597     8092    6                           CALL CONNECT_6('SMSS-CF ');
     1598     8093    6                           CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
     1599     8094    6                              'FR      ', 'C-F     ' );
     1600     8095    6                           END;
     1601     8096    5                       END;
     1602     8097    4               CASE(%DUP_QRC);
     1603     8098    4                   CALL GET_WORD;
     1604     8099    4                   IF WORD1 ~= LAST_RC_NAME THEN
     1605     8100    5                   DO;
     1606     8101    5                       CALL INDEX(CT1,' ',QFR_NAME);
     1607     8102    5                       CALL SET_FIELDS(1,CT1,QFR_NAME);
     1608     8103    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4809);
     1609     8104    5                       END;
     1610     8105    4                   ELSE
     1611     8106    5                   DO;
     1612     8107    5                       GOTO DUP;
     1613     8108    5                       END;
     1614     8109    4               CASE(%DUP_QFR);
     1615     8110    4                   CALL GET_WORD;
     1616     8111    4                   QFR_NAME = WORD1;
     1617     8112        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:52   
     1618     8113        /*****************************************
     1619     8114        *  SORT KEY clause                       *
     1620     8115        *****************************************/
     1621     8116    4               CASE(%SORTKEY_CL); /* KEY IS ASC/DESC... */
     1622     8117        /* -make sure this set is SORTED insertion
     1623     8118           -compare this SM's sort key fields with prior SM's */
     1624     8119    4                   SORTKEY = '1'B;
     1625     8120    4                   CALL FINDD_6('SM      ',LAST_SM_DBK);
              8120                            /* ensure SM fields filled in */
     1626     8121    4                   CALL MODIFY_6('SM      ');
     1627     8122    5                   IF (UWA.SC.SETORD ~= 4) AND (UWA.SC.SETORD ~= 6) THEN DO;
     1628     8123    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4806);
     1629     8124        /*E* ERROR: ZIG-4806-C
     1630     8125             MESSAGE: The key clause is invalid because the set did not
     1631     8126                      specify SORTED insertion.
     1632     8127        */
     1633     8128    5                       END;
     1634     8129    5                   IF UWA.SC.SETORD = 4 THEN DO;
     1635     8130         /* compare this SM's sort key fields with last SM's */
     1636     8131         /* if SORTED BY DEFINED KEYS */
     1637     8132    6                       IF ~FIRST_MEMBER THEN DO;
     1638     8133    6                           END_OF_KEYS = '0'B;
     1639     8134    6                           CALL FETCHNS_6('SMSS-CF '); /* curr CF */
     1640     8135    6                           TCF = UWA.C_F;
     1641     8136    6                           CURR_CF_DBK = UWA.DIRECT_REF;
     1642     8137    6                           CALL FETCHOS_6('FR-CFS  '); /* curr FR */
     1643     8138    6                           TFR = UWA.FR;
     1644     8139        /* -make sure all required clauses have been specified
     1645     8140           -save SC DBK, SM DBK, THRU setname SN for pass2 */
     1646     8141    6                           CALL FINDPS_6('SC-SOSM '); /* prev SM */
     1647     8142    6                           CALL FETCHNS_6('SMSS-CF '); /* prev CF */
     1648     8143    6                           IF UWA.DB_STATUS = '0502100' /* end of set */
     1649     8144    6                           THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1650     8145        /*E* ERROR: ZIG-4860-C
     1651     8146             MESSAGE: The attributes of the DEFINED KEYS to be used
     1652     8147                      for sort must be identical for each member of
     1653     8148                      the set.
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:53   
     1654     8149        */
     1655     8150    7                           DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (~END_OF_KEYS));
     1656     8151    7                               PREV_CF_DBK = UWA.DIRECT_REF;
     1657     8152    8                               IF TCF ~= UWA.C_F THEN DO;
     1658     8153    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1659     8154    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4861);
     1660     8155        /*E* ERROR: ZIG-4861-C
     1661     8156             MESSAGE: The keys do not match in terms of ASCENDING/
     1662     8157                      DESCENDING specifications.
     1663     8158        */
     1664     8159    8                                   END;
     1665     8160    7                               CALL FETCHOS_6('FR-CFS  '); /* prev FR */
     1666     8161    8                               IF TFR.FTYPE ~= UWA.FR.FTYPE THEN DO;
     1667     8162    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1668     8163    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4862);
     1669     8164        /*E* ERROR: ZIG-4862-C
     1670     8165             MESSAGE: The keys do not match in terms of data type
     1671     8166                      declarations.
     1672     8167        */
     1673     8168    8                                   END;
     1674     8169    8                               ELSE DO;
     1675     8170    9                                   IF TFR.PREC ~= UWA.FR.PREC THEN DO;
     1676     8171    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1677     8172    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4863);
     1678     8173        /*E* ERROR: ZIG-4863-C
     1679     8174             MESSAGE: The keys do not match in terms of precision
     1680     8175                      declarations.
     1681     8176        */
     1682     8177    9                                       END;
     1683     8178    9                                   IF TFR.SCALE ~= UWA.FR.SCALE THEN DO;
     1684     8179    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1685     8180    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4864);
     1686     8181        /*E* ERROR: ZIG-4864-C
     1687     8182             MESSAGE: The keys do not match in terms of scale
     1688     8183                      declarations.
     1689     8184        */
     1690     8185    9                                       END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:54   
     1691     8186    9                                   IF TFR.F_SIGN ~= UWA.FR.F_SIGN THEN DO;
     1692     8187    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1693     8188    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4865);
     1694     8189        /*E* ERROR: ZIG-4865-C
     1695     8190             MESSAGE: The keys do not match in terms of sign
     1696     8191                      declarations.
     1697     8192        */
     1698     8193    9                                       END;
     1699     8194    8                                   END;
     1700     8195    7                               CALL FINDD_6('C-F      ',CURR_CF_DBK);
     1701     8196    7                               CALL FETCHNS_6('SMSS-CF '); /* curr CF */
     1702     8197    7                               IF UWA.DB_STATUS = '0502100'
     1703     8198    7                               THEN END_OF_KEYS = '1'B;
     1704     8199    8                               ELSE DO;
     1705     8200    8                                   TCF = UWA.C_F;
     1706     8201    8                                   CURR_CF_DBK = UWA.DIRECT_REF;
     1707     8202    8                                   CALL FETCHOS_6('FR-CFS  ');/* curr FR */
     1708     8203    8                                   TFR = UWA.FR;
     1709     8204    8                                   END;
     1710     8205    7                               CALL FINDD_6('C-F      ',PREV_CF_DBK);
     1711     8206    7                               CALL FETCHNS_6('SMSS-CF '); /* prev CF */
     1712     8207    7                               END;
     1713     8208    6                           IF (UWA.DB_STATUS = '0502100') AND (END_OF_KEYS = '1'B) THEN
              8208                                    ;
     1714     8209    7                           ELSE DO;
     1715     8210    7                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);
     1716     8211    7                               END;
     1717     8212    6                           END;
     1718     8213    5                       END;
     1719     8214    4               CASE(%ASCENDING); /* KEY IS ASCENDING... */
     1720     8215    4                   DESC = 0;
     1721     8216    4               CASE(%DESCENDING); /* KEY IS DESCENDING... */
     1722     8217    4                   DESC = 1;
     1723     8218    4               CASE(%SKC_FR); /* KEY IS ASC/DESC dbid */
     1724     8219        /* -make sure this field is defined previously
     1725     8220           - make sure this field is not TYPE CHAR VARYING
     1726     8221           -modify this field's FR to show that it owns a CF
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:55   
     1727     8222           -store a CF off this member record's SM */
     1728     8223    4   SKC:
     1729     8224    4                   WORD1 = QFR_NAME;
     1730     8225    4                   IF WORD1 = 'DUPS' OR WORD1 = 'DUPLICATES' OR
     1731     8226    4                      WORD1 = 'SET' OR WORD1 = 'SELECTION' THEN
     1732     8227    5                   DO;
     1733     8228    5                       PARAN.REJECT = '1'B;
     1734     8229    5                       RETURN;
     1735     8230    5                       END;
     1736     8231    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.SEQ,
     1737     8232    4                      EXPLCT,LAST_RC_DBK);
     1738     8233    5                   IF (FOUND ~= %FOUNDDEF) THEN DO;
     1739     8234    5                       CALL INDEX(CT1,' ',WORD1);
     1740     8235    5                       CALL SET_FIELDS(1,CT1,WORD1);
     1741     8236    5                       CALL FETCHD_6('SN      ',LAST_SC_SN);
     1742     8237    5                       CALL INDEX(CT2,' ',UWA.SN.SENAME);
     1743     8238    5                       CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);
     1744     8239    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4810);
     1745     8240        /*E* ERROR: ZIG-4810-C
     1746     8241             MESSAGE: The sort key "%U1" is not a field of the "%U2" set
     1747     8242                      member record.
     1748     8243        */
     1749     8244    5                       END;
     1750     8245    5                   ELSE DO;
     1751     8246    5                       CALL FETCHNS_6('SN-SE   '); /* FR of sort key */
     1752     8247    5                       HOLD_DBK = UWA.DIRECT_REF;
     1753     8248    6                       IF UWA.FR.FTYPE = 19 THEN DO; /* char varying */
     1754     8249    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4832);
     1755     8250    6                           END;
     1756     8251    5                       UWA.FR.REF = 1;
     1757     8252    5                       CALL MODIFY_6('FR      ');
     1758     8253    5                       CALL FINDOS_6('RC-FR   '); /* RC of sort key */
     1759     8254    5                       CALL FINDD_6('SM      ',LAST_SM_DBK);
     1760     8255    5                       UWA.C_F = '0'B;
     1761     8256    5                       UWA.C_F.CTRLSEQ = DESC;
     1762     8257    5                       CALL STRE_6('C-F     ');
     1763     8258    5                       CALL CONNECT_6('SMSS-CF ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:56   
     1764     8259    5                       CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',
     1765     8260    5                          'FR      ', 'C-F     ' );
     1766     8261    5                       UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
     1767     8262    5                       END;
     1768     8263    4               CASE(%SKC_QRC);
     1769     8264    4                   CALL GET_WORD;
     1770     8265    4                   IF WORD1 ~= LAST_RC_NAME THEN
     1771     8266    5                   DO;
     1772     8267    5                       CALL INDEX(CT1,' ',QFR_NAME);
     1773     8268    5                       CALL SET_FIELDS(1,CT1,QFR_NAME);
     1774     8269    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4809);
     1775     8270    5                       END;
     1776     8271    4                   ELSE
     1777     8272    5                   DO;
     1778     8273    5                       GOTO SKC;
     1779     8274    5                       END;
     1780     8275    4               CASE(%SKC_QFR);
     1781     8276    4                   CALL GET_WORD;
     1782     8277    4                   QFR_NAME = WORD1;
     1783     8278    4               CASE(%MFIRST); /* KEY IS...DUPS ARE FIRST ALLOWED */
     1784     8279    4                   UWA.SM.SEQDUP = 0;
     1785     8280    5                   IF UWA.SC.SETORD ~= 6 THEN DO;
     1786     8281    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4123);
     1787     8282        /*E* ERROR: ZIG-4123-C
     1788     8283             MESSAGE: The %U1 phrase can only be used when INSERTION IS
     1789     8284                      SORTED WITHIN record name is specified.
     1790     8285        */
     1791     8286    5                       END;
     1792     8287    4               CASE(%MLAST); /* KEY IS ...DUPS ARE LAST ALLOWED */
     1793     8288    4                   UWA.SM.SEQDUP = 1;
     1794     8289    5                   IF UWA.SC.SETORD ~= 6 THEN DO;
     1795     8290    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4123);
     1796     8291    5                       END;
     1797     8292    4               CASE(%MNOT); /* KEY IS...DUPS ARE NOT ALLOWED */
     1798     8293    4                   UWA.SM.SEQDUP = 2;
     1799     8294    5                   IF UWA.SC.SETORD ~= 6 THEN DO;
     1800     8295    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4123);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:57   
     1801     8296    5                       END;
     1802     8297    4               CASE(%SEL_PHR); /* SET SELECTION... */
     1803     8298    5                   IF SELECTION THEN DO;
     1804     8299    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
     1805     8300    5                       END;
     1806     8301    4                   ELSE SELECTION = '1'B;
     1807     8302        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:58   
     1808     8303        /*****************************************
     1809     8304        *  SET SELECTION clause                  *
     1810     8305        *****************************************/
     1811     8306    4               CASE(%FOR_SC_NM); /* SET SELECTION FOR setname */
     1812     8307        /* -nake sure set named is same as current set */
     1813     8308    4                   CALL GET_WORD;
     1814     8309    5                   IF WORD1 ~= CURR_SETNAME THEN DO;
     1815     8310    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4088);
     1816     8311        /*E* ERROR: ZIG-4088-C
     1817     8312             MESSAGE: The set named by this phrase must be the same as
     1818     8313                      that of the current set entry.
     1819     8314        */
     1820     8315    5                       END;
     1821     8316    4               CASE(%SEL_SC_NM); /* SET SELECTION IS THRU setname */
     1822     8317    5                   IF ~LINKED THEN DO;
     1823     8318    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4055);
     1824     8319        /*E* ERROR: ZIG-4055-C
     1825     8320             MESSAGE: The LINKED TO OWNER phrase is required but seems to
     1826     8321                      be missing.
     1827     8322        */
     1828     8323    5                       END;
     1829     8324    5                   IF UWA.SM.INSTYPE = 9 THEN DO;
     1830     8325    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4142);
     1831     8326        /*E* ERROR: ZIG-4142-C
     1832     8327             MESSAGE: Either AUTOMATIC or MANUAL insertion must be
     1833     8328                      specified.
     1834     8329        */
     1835     8330    5                       END;
     1836     8331    5                   IF UWA.SM.RETTYPE = 9 THEN DO;
     1837     8332    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4141);
     1838     8333        /*E* ERROR: ZIG-4141-C
     1839     8334             MESSAGE: Either MANDATORY or OPTIONAL retention must be
     1840     8335                      specified.
     1841     8336        */
     1842     8337    5                       END;
     1843     8338    4                   CALL FINDD_6('SM      ',LAST_SM_DBK);
              8338                            /* ensure SM fields filled in */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:59   
     1844     8339    4                   CALL MODIFY_6('SM      ');
     1845     8340    4                   CALL GET_WORD;
     1846     8341    4                   CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,0,LNO,FOUND,RELTYPE.SS,EXPLCT,0);
     1847     8342    4                   CALL ZIG$G_DYN_MEM_6(5,DYNMEM$);
     1848     8343    4                   DYNMEM$->WRD1 = %SET_SEL; /* beginning of set selection */
     1849     8344    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1850     8345    4                   DYNMEM$->WRD1 = LAST_SC_DBK;
     1851     8346    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1852     8347    4                   DYNMEM$->WRD1 = LAST_SM_DBK;
     1853     8348    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1854     8349    4                   DYNMEM$->WRD1 = UWA.DIRECT_REF; /* THRU setname SN */
     1855     8350    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1856     8351    4                   DYNMEM$->WRD1 = LNO;
     1857     8352    4               CASE(%OWN_ID_PHR);
     1858     8353    4               CASE(%APPLICATION); /* OWNER IDENTIFIED BY APPLICATION */
     1859     8354    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM$);
     1860     8355    4                   DYNMEM$->WRD1 = %APPLIC;
     1861     8356    4               CASE(%DEQ_QFR); /* OWNER IDENTIFIED BY DBKEY EQUAL TO dbid/dbparam */
     1862     8357    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
     1863     8358    5                   DO;
     1864     8359    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);
     1865     8360        /*E* ERROR: ZIG-4828-C
     1866     8361             MESSAGE: Set selection must be BY APPLICATION for MANUAL
     1867     8362                      insertion and/or OPTIONAL retention.
     1868     8363        */
     1869     8364    5                       END;
     1870     8365    4                   CALL GET_WORD;
     1871     8366    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
     1872     8367    4                   DYNMEM$->WRD1 = %DBK_EQ;
     1873     8368    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1874     8369    4                   DYNMEM$->WRD1 = LNO;
     1875     8370    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1876     8371    4                   DYNMEM$->CHAR30 = WORD1;
     1877     8372    4               CASE(%DEQ_QRC);
     1878     8373    4                   CALL GET_WORD;
     1879     8374    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);
     1880     8375    4                   DYNMEM$->WRD1 = %QUAL;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:60   
     1881     8376    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1882     8377    4                   DYNMEM$->CHAR30 = WORD1;
     1883     8378    4               CASE(%DEQ_FR);
     1884     8379    4               CASE(%DBK_ONLY); /* OWNER IDENTIFIED BY DBKEY. */
     1885     8380    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
     1886     8381    5                   DO;
     1887     8382    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);
     1888     8383    5                       END;
     1889     8384    4                   CALL ZIG$G_DYN_MEM_6(2,DYNMEM$);
     1890     8385    4                   DYNMEM$->WRD1 = %DBK_ONL;
     1891     8386    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1892     8387    4                   DYNMEM$->WRD1 = LNO;
     1893     8388    4               CASE(%CEQ_QFR); /* OWNER IDENTIFIED BY CALCKEY EQUAL TO dbid/dbparam */
     1894     8389    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
     1895     8390    5                   DO;
     1896     8391    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);
     1897     8392    5                       END;
     1898     8393    4                   CALL GET_WORD;
     1899     8394    4                   IF WORD1 = 'THEN' OR WORD1 = 'THRU' THEN
     1900     8395    5                   DO;
     1901     8396    5                       PARAN.REJECT = '1'B;
     1902     8397    5                       RETURN;
     1903     8398    5                       END;
     1904     8399    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
     1905     8400    4                   DYNMEM$->WRD1 = %CALC_EQ;
     1906     8401    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1907     8402    4                   DYNMEM$->WRD1 = LNO;
     1908     8403    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1909     8404    4                   DYNMEM$->CHAR30 = WORD1;
     1910     8405    4               CASE(%CEQ_QRC);
     1911     8406    4                   CALL GET_WORD;
     1912     8407    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);
     1913     8408    4                   DYNMEM$->WRD1 = %QUAL;
     1914     8409    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1915     8410    4                   DYNMEM$->CHAR30 = WORD1;
     1916     8411    4               CASE(%CEQ_FR);
     1917     8412    4                   CALL GET_WORD;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:61   
     1918     8413    4                   IF WORD1 = 'THEN' OR WORD1 = 'THRU'
     1919     8414    5                   THEN DO;
     1920     8415    5                       PARAN.REJECT = '1'B;
     1921     8416    5                       RETURN;
     1922     8417    5                       END;
     1923     8418    4               CASE(%CALC_ONLY); /* OWNER IDENTIFIED BY CALCKEY. */
     1924     8419    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
     1925     8420    5                   DO;
     1926     8421    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);
     1927     8422    5                       END;
     1928     8423    4                   CALL ZIG$G_DYN_MEM_6(2,DYNMEM$);
     1929     8424    4                   DYNMEM$->WRD1 = %CALC_ONL;
     1930     8425    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1931     8426    4                   DYNMEM$->WRD1 = LNO;
     1932     8427    4               CASE(%MEM_SEL_REC_NM);
              8427                        /* OWNER IDENTIFIED BY MEMBER recname SELECTION */
     1933     8428    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
     1934     8429    5                   DO;
     1935     8430    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);
     1936     8431    5                       END;
     1937     8432    4                   CALL GET_WORD;
     1938     8433    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
     1939     8434    4                   DYNMEM$->WRD1 = %MEMB;
     1940     8435    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1941     8436    4                   DYNMEM$->WRD1 = LNO;
     1942     8437    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1943     8438    4                   DYNMEM$->CHAR30 = WORD1;
     1944     8439    4               CASE(%SELEC_SC_NM); /* THEN THRU setname */
     1945     8440    4                   CALL FCURR_R_6('NR      ');
     1946     8441    4                   UWA.NR.LNO = UWA.NR.LNO + 1;
     1947     8442    4                   CALL MODIFY_6('NR      ');
     1948     8443    4                   CALL GET_WORD;
     1949     8444    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
     1950     8445    4                   DYNMEM$->WRD1 = %THEN_THRU;
     1951     8446    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1952     8447    4                   DYNMEM$->WRD1 = LNO;
     1953     8448    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:62   
     1954     8449    4                   DYNMEM$->CHAR30 = WORD1;
     1955     8450    4               CASE(%WHR_QFR); /* WHERE OWNER IDENTIFIED BY dbid */
     1956     8451    4                   CALL GET_WORD;
     1957     8452    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
     1958     8453    4                   DYNMEM$->WRD1 = %THEN_OWNER;
     1959     8454    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1960     8455    4                   DYNMEM$->WRD1 = LNO;
     1961     8456    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1962     8457    4                   DYNMEM$->CHAR30 = WORD1;
     1963     8458    4               CASE(%WHR_QRC);
     1964     8459    4                   CALL GET_WORD;
     1965     8460    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);
     1966     8461    4                   DYNMEM$->WRD1 = %QUAL;
     1967     8462    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1968     8463    4                   DYNMEM$->CHAR30 = WORD1;
     1969     8464    4               CASE(%WHR_FR);
     1970     8465    4               CASE(%WEQ_QFR); /* WHERE... EQUAL TO dbid/dbparam */
     1971     8466    4                   CALL GET_WORD;
     1972     8467    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);
     1973     8468    4                   DYNMEM$->WRD1 = %EQUAL_TO;
     1974     8469    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1975     8470    4                   DYNMEM$->WRD1 = LNO;
     1976     8471    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1977     8472    4                   DYNMEM$->CHAR30 = WORD1;
     1978     8473    4               CASE(%WEQ_QRC);
     1979     8474    4                   CALL GET_WORD;
     1980     8475    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);
     1981     8476    4                   DYNMEM$->WRD1 = %QUAL;
     1982     8477    4                   DYNMEM$ = PINCRW(DYNMEM$,1);
     1983     8478    4                   DYNMEM$->CHAR30 = WORD1;
     1984     8479    4               CASE(%WEQ_FR);
     1985     8480        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:63   
     1986     8481        /********************************************************************
     1987     8482                 ends of entries
     1988     8483         *******************************************************************/
     1989     8484    4               CASE(%END_SCH);
     1990     8485    4                   IF REC_ENTRY_DONE THEN
     1991     8486    4                       CALL CLEAN_UP_REC;
     1992     8487    4                   IF UWA.OA.NUMB_AC = 0 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              8487                            4402);
     1993     8488        /*   ERROR: ZIG-4402-C
     1994     8489             MESSAGE: The schema must contain at least one AREA subentry.
     1995     8490         */
     1996     8491    4                   IF UWA.OA.NUMB_RC = 0 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              8491                            4403);
     1997     8492        /*   ERROR: ZIG-4403-C
     1998     8493             MESSAGE: The schema must contain at least one RECORD subentry.
     1999     8494         */
     2000     8495    4                   END_DDL = '1'B;
     2001     8496    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM$);
     2002     8497    4                   DYNMEM$->WRD1 = %ALL_DONE; /* signal end of set selection dyn mem */
     2003     8498    4                   CALL FCURR_R_6('SF  ');
     2004     8499    4                   CALL MODIFY_6('SF      ');
     2005     8500         /* if no sets or no keys defined, fill in SN of schemaname
     2006     8501            in DA record */
     2007     8502    5                   IF UWA.DA.FRST_SC = 0 OR UWA.DA.FRST_KC = 0 OR UWA.DA.FRST_FR = 0
              8502                            THEN DO;
     2008     8503    5                       CALL FCURR_R_6('OA      ');
     2009     8504    5                       CALL FINDOS_6('SN-SE   '); /* SN of schemaname */
     2010     8505    5                       IF UWA.DA.FRST_SC = 0 THEN UWA.DA.FRST_SC = UWA.DIRECT_REF;
     2011     8506    5                       IF UWA.DA.FRST_KC = 0 THEN UWA.DA.FRST_KC = UWA.DIRECT_REF;
     2012     8507    5                       IF UWA.DA.FRST_FR = 0 THEN UWA.DA.FRST_FR = UWA.DIRECT_REF;
     2013     8508    5                       END;
     2014     8509    4                   CALL FCURR_R_6('DA  ');
     2015     8510    4                   CALL MODIFY_6('DA      ');
     2016     8511    4                   CALL FCURR_R_6('OA  ');
     2017     8512    4                   CALL MODIFY_6('OA      ');
     2018     8513    4                   CALL FCURR_R_6('SA  ');
     2019     8514    4                   CALL MODIFY_6('SA      ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:64   
     2020     8515    4               CASE(%SCH_PERIOD);
     2021     8516    4               CASE(%AC_PERIOD);
     2022     8517    4                   CALL STRE_6('AC      ');
     2023     8518    4                   CALL CONNECT_6('OA-AC   ');
     2024     8519    4                   UWA.OA.NUMB_AC = UWA.OA.NUMB_AC + 1;
     2025     8520    4               CASE(%RC_PERIOD);
     2026     8521    4                   IF INDX_KEY_NM ~= ' '
     2027     8522    5                   THEN DO;
     2028     8523    6                       IF INDX_KEY_NM = 'FOUND' THEN DO; /* DUP NOT not specified */
     2029     8524    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4152);
     2030     8525        /*E* ERROR: ZIG-4152-C
     2031     8526             MESSAGE: The primary key "%U1" must have DUPLICATES NOT
     2032     8527                      ALLOWED specified.
     2033     8528        */
     2034     8529    6                           END;
     2035     8530    5                       ELSE IF INDX_KEY_NM ~= 'NOT'
     2036     8531    6                           THEN DO;
     2037     8532    6                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4151);
     2038     8533        /*E* ERROR: ZIG-4151-C
     2039     8534             MESSAGE: The primary key has not been defined in a KEY
     2040     8535                      clause in this record.
     2041     8536        */
     2042     8537    6                               END;
     2043     8538    5                       END;
     2044     8539    5                   IF ~LOCATION THEN DO;
     2045     8540    5                       CLAUSE_TYPE = 'LOCATION';
     2046     8541    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2047     8542        /*E* ERROR: ZIG-4006-C
     2048     8543             MESSAGE: A required clause is missing from this subentry.
     2049     8544        */
     2050     8545    5                       END;
     2051     8546    5                   IF ~WITHIN THEN DO;
     2052     8547    5                       CLAUSE_TYPE = 'WITHIN';
     2053     8548    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2054     8549    5                       END;
     2055     8550    4                   CALL FINDD_6('RC      ',LAST_RC_DBK);
     2056     8551    4                   UWA.RC = RC;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:65   
     2057     8552    4                   CALL MODIFY_6('RC      ');
     2058     8553    4               CASE(%FR_PERIOD);
     2059     8554    5                   IF ~TYPE THEN DO;
     2060     8555    5                       CLAUSE_TYPE = 'TYPE';
     2061     8556    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4316);
     2062     8557        /*E* ERROR: ZIG-4316-C
     2063     8558             MESSAGE: The required TYPE clause is missing from this
     2064     8559                      DATA subentry.
     2065     8560        */
     2066     8561    5                       END;
     2067     8562    4                   IF MOD_FR_OK THEN
     2068     8563    4                       CALL MODIFY_6('FR      ');
     2069     8564    4               CASE(%SC_PERIOD);
     2070     8565    5                   IF ~PERM THEN DO;
     2071     8566    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4078);
     2072     8567        /*E* ERROR: ZIG-4078-C
     2073     8568             MESSAGE: The keyword PERMANENT is required but missing.
     2074     8569        */
     2075     8570    5                       END;
     2076     8571    5                   IF ~OWNER THEN DO;
     2077     8572    5                       CLAUSE_TYPE = 'OWNER';
     2078     8573    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2079     8574    5                       END;
     2080     8575    5                   IF ~PRIOR THEN DO;
     2081     8576    5                       CLAUSE_TYPE = 'PRIOR';
     2082     8577    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2083     8578    5                       END;
     2084     8579    5                   IF ~ORDER THEN DO;
     2085     8580    5                       CLAUSE_TYPE = 'ORDER';
     2086     8581    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2087     8582    5                       END;
     2088     8583    4                   CALL FINDD_6('SC      ',LAST_SC_DBK);
     2089     8584    4                   CALL MODIFY_6('SC      ');
     2090     8585    4               CASE(%MEM_PERIOD);
     2091     8586    4                   IF ((UWA.SC.SETORD = 4) OR
     2092     8587    4                      (UWA.SC.SETORD = 6)) AND /* INSERTION SORTED */
     2093     8588    5                      (SORTKEY = '0'B) THEN DO; /* no sort KEY clauses */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:66   
     2094     8589    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2095     8590    5                       END;
     2096     8591    4                   FIRST_MEMBER = '0'B;
     2097     8592    5                   IF ~SELECTION THEN DO;
     2098     8593    5                       CLAUSE_TYPE = 'SELECTION';
     2099     8594    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
     2100     8595    5                       END;
     2101     8596    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM$);
     2102     8597    4                   DYNMEM$->WRD1 = %END_MEM_ENTRY;
     2103     8598    4                   END;
     2104     8599        /********************************************************************/
     2105     8600    3           CASE(%FAIL#);
     2106     8601    3               IF END_DDL THEN UNWIND TO SYNTAX_ERR;
     2107     8602    3               J = PARAN.CODE;
     2108     8603    3               CALL ZIG$D_FAIL(J,PARAN);
     2109     8604    3               UNWIND TO SYNTAX_ERR;
     2110     8605    3               END; /* case */
     2111     8606    2           END; /* If DO_PROCESS */
     2112     8607    1       RETURN;
     2113     8608        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:67   
     2114     8609        /*******************************************************************/
     2115     8610        /*
     2116     8611             This subroutine gets a text value from x$parse and puts
     2117     8612             it in WORD1 and FIELD1.TEXT1.  The length goes
     2118     8613             into FIELD1.COUNT1.  The value goes into NUM.
     2119     8614        */
     2120     8615    1   GET_NUM:
     2121     8616    1       PROC;
     2122     8617    2       WORD1=PARAN.OUT$ -> SYM.TEXT;
     2123     8618    2       FIELD1.COUNT1=PARAN.OUT$ -> SYM.COUNT;
     2124     8619    2       FIELD1.TEXT1=WORD1;
     2125     8620    2       CALL CHARBIN(NUM,SUBSTR(WORD1,0,FIELD1.COUNT1));
     2126     8621    2   END GET_NUM;
     2127     8622        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:68   
     2128     8623        /********************************************************************/
     2129     8624        /*
     2130     8625              This subroutine gets a text word from the X$PARSE
     2131     8626            and puts it into WORD1 and FIELD1.TEXT1 and the length
     2132     8627            in FIELD1.COUNT1.
     2133     8628        */
     2134     8629    1   GET_WORD:
     2135     8630    1       PROC;
     2136     8631    2       WORD1=PARAN.OUT$ -> SYM.TEXT;
     2137     8632    2       CALL HYPH_TO_UNDR; /* Check names for hyphens; if found, change to underscore */
     2138     8633    2       FIELD1.COUNT1=PARAN.OUT$ -> SYM.COUNT;
     2139     8634    2       FIELD1.TEXT1=WORD1;
     2140     8635    2       RETURN;
     2141     8636    2   END GET_WORD;
     2142     8637    1   GET_WORD_SUB:
     2143     8638    1       PROC;
     2144     8639    2       WORD1 = PARAN.OUT$->BLK.SUBLK$(0)->SYM.TEXT;
     2145     8640    2       FIELD1.COUNT1=PARAN.OUT$ -> BLK.SUBLK$(0)-> SYM.COUNT;
     2146     8641    2       FIELD1.TEXT1=WORD1;
     2147     8642    2       RETURN;
     2148     8643    2   END GET_WORD_SUB;
     2149     8644        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:69   
     2150     8645        /********************************************************************/
     2151     8646        /*
     2152     8647              This subroutine checks to see if the current word in the
     2153     8648            schema ddl is a reserved word
     2154     8649            or the user goofed and
     2155     8650            has two different words that are the same so that a error
     2156     8651            must be generated.
     2157     8652
     2158     8653
     2159     8654        */
     2160     8655    1   CHECK_RESW_DUPS:
     2161     8656    1       PROC;
     2162     8657    2       CALL ZIG$HASH_IT(WORD1,%NO_ADD,ERROR_STATUS,0,0,9,PTR$,LAST_STATUS);
     2163     8658    3       DO CASE (ERROR_STATUS);
     2164     8659    3       CASE(1);
     2165     8660         /*
     2166     8661            There is a alias in the table so put out a descriptor
     2167     8662            for what ever type of alias and word it is.
     2168     8663         */
     2169     8664    3           WORD1 = ' ';
     2170     8665    3       CASE (2);
     2171     8666         /*
     2172     8667            There is a dup in the hash table all ready for this
     2173     8668            word so error this line.
     2174     8669         */
     2175     8670    3           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%DUP_DDL_DATA_NAME);
     2176     8671        /*E* ERROR: ZIG-%DUP_DDL_DATA_NAME-C
     2177     8672             MESSAGE: There is a duplicate name in the schema DDL text for the
     2178     8673                      word %U1. One of these must be changed in the schema
     2179     8674                      text.
     2180     8675        */
     2181     8676    3       CASE (3);
     2182     8677         /*
     2183     8678            There is a user defined word that is the same as
     2184     8679            reserved word for this language.
     2185     8680         */
     2186     8681    3           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%DDL_RES_WORD);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:70   
     2187     8682        /*E* ERROR: ZIG-%DDL_RES_WORD-C
     2188     8683             MESSAGE: The word %U1 is the same as a reserved word for the
     2189     8684                      DDL and, therefore, cannot be a user-defined word.
     2190     8685        */
     2191     8686    3           END;
     2192     8687    2       RETURN;
     2193     8688    2   END CHECK_RESW_DUPS;
     2194     8689        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:71   
     2195     8690        /******************************************************************/
     2196     8691        /*
     2197     8692          This subroutine is called after the end of a record entry, when
     2198     8693          all fields within the record have been defined.  Its purpose is to:
     2199     8694          1) finish processing of alternate keys,
     2200     8695          2) check to ensure that all calckeys mentioned in LOC MODE CALC
     2201     8696             USING clause have been defined in this record,
     2202     8697        */
     2203     8698    1   CLEAN_UP_REC:
     2204     8699    1       PROC;
     2205     8700    2   DCL 01 FR UNAL,
     2206     8701    2         02 FTYPE SBIN(36),
     2207     8702    2         02 PREC SBIN(36),
     2208     8703    2         02 SCALE SBIN(36),
     2209     8704    2         02 F_SIGN SBIN(36),
     2210     8705    2         02 FR_FRH UBIN(36);
     2211     8706    2   DCL DBK_SFR UBIN(36);
     2212     8707    2   DCL KEY_MULT_REF BIT(1);
     2213     8708    2       REC_ENTRY_DONE = '0'B;
     2214     8709    2       CALL FINDD_6('RC      ',LAST_RC_DBK);
     2215     8710         /* update RC so things like rc.fixvar get in */
     2216     8711    2       UWA.RC = RC;
     2217     8712    2       CALL MODIFY_6('RC      ');
     2218     8713         /* set AC bit if altkeys present in record...do ANY [EXCEPT...]
     2219     8714            in pass2 */
     2220     8715    2       IF UWA.RC.KEY_PRESENT = 1 AND UWA.RC.ANY_IND = 0 THEN
     2221     8716    3       DO;
     2222     8717    3           CALL FINDNS_6('RC-RA   '); /* RA */
     2223     8718    4           DO WHILE (UWA.DB_STATUS ~= '0502100');
     2224     8719    4               CALL FETCHOS_6('AC-RA   '); /* AC */
     2225     8720    4               UWA.AC.SEC_KEY = 1;
     2226     8721    4               IF UWA.RC.PSMODE = 4 THEN UWA.AC.PRIME_KEY = 1;
     2227     8722    4               CALL MODIFY_6('AC      ');
     2228     8723    4               CALL FINDNS_6('RC-RA   '); /* RA */
     2229     8724    4               END;
     2230     8725    3           END;
     2231     8726    2       IF UWA.RC.PSMODE = 4 AND UWA.RC.ANY_IND = 0 THEN /* INDEXED */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:72   
     2232     8727    3       DO;
     2233     8728    3           CALL FINDNS_6('RC-RA   '); /* RA */
     2234     8729    3           CALL FETCHOS_6('AC-RA   '); /* AC */
     2235     8730    3           UWA.AC.PRIME_KEY = 1;
     2236     8731    3           UWA.AC.PAGE_TYP = 3;
     2237     8732    3           CALL MODIFY_6('AC      ');
     2238     8733    3           CALL FINDNS_6('AC-RA   '); /* RA */
     2239     8734    3           CALL FINDNS_6('AC-RA   '); /* should not be another RA */
     2240     8735    3           IF UWA.DB_STATUS ~= '0502100' THEN
     2241     8736    4           DO;
     2242     8737    4               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4977);
     2243     8738        /*E* ERROR: ZIG-4977-C
     2244     8739             MESSAGE: The area contains more than one record and indexed
     2245     8740                      areas can contain only one record per indexed area.
     2246     8741        */
     2247     8742    4               END;
     2248     8743    3           END;
     2249     8744    2       CALL FETCHNS_6('RC-FR   '); /* looking for SFRs */
     2250     8745    3       DO WHILE (UWA.DB_STATUS = '0000000');
     2251     8746         /* if calckey in loc mode calc using clause never got
     2252     8747            defined, then this misused field will still be = 1 */
     2253     8748    4           IF UWA.FR.F_OCCURS = 1 THEN DO;
     2254     8749    4               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4808);
     2255     8750    4               END;
     2256     8751    4           DO CASE(UWA.FR.F_USE);
     2257     8752    4           CASE(7); /* altkey */
     2258     8753    4               DBK_SFR = UWA.DIRECT_REF;
     2259     8754    4               IF UWA.FR.RPT = 1
     2260     8755    4               THEN KEY_MULT_REF = '1'B;
     2261     8756    4               ELSE KEY_MULT_REF = '0'B;
     2262     8757         /* make SM for this altkey current so can connect CF later */
     2263     8758    4               CALL FINDNS_6('FR-CFS  ');
     2264     8759    4               CALL FINDOS_6('SMSS-CF ');
     2265     8760         /* fetch realFR of field corresponding to this altkey */
     2266     8761    4               CALL FETCHD_6('SN      ',UWA.FR.FR_FRH);
     2267     8762         /* if altkey never matched a defined field, then error */
     2268     8763    4               CALL JUST_FIND_SN(%ZIG_RTYPE_FR,UWA.SN.SENAME,0,LNO,FOUND,0,0,
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:73   
              8763                        LAST_RC_DBK);
     2269     8764    4               IF (FOUND = %NOTFOUND) OR (UWA.SN.DCLR = 0)
     2270     8765    5               THEN DO;
     2271     8766    5                   CALL INDEX(CT1,' ',UWA.SN.SENAME);
     2272     8767    5                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);
     2273     8768    5                   CALL ZIG$D_DIAG(UWA.SN.LNO,%ERR_SEV,4153);
     2274     8769        /*E* ERROR: ZIG-4153-C
     2275     8770             MESSAGE: The data base identifier "%U1" has not been defined
     2276     8771                      in this record.
     2277     8772        */
     2278     8773    5                   END; /* THEN DO */
     2279     8774    5               ELSE DO;
     2280     8775    5                   CALL FETCHNS_6('SN-SE   '); /* FR */
     2281     8776         /* save realFR info to put into SFR later */
     2282     8777    5                   FR.FTYPE = UWA.FR.FTYPE;
     2283     8778    5                   FR.PREC = UWA.FR.PREC;
     2284     8779    5                   FR.SCALE = UWA.FR.SCALE;
     2285     8780    5                   FR.F_SIGN = UWA.FR.F_SIGN;
     2286     8781    5                   FR.FR_FRH = UWA.DIRECT_REF;
     2287     8782         /* update realFR to reflect that an SFR references it */
     2288     8783    5                   UWA.FR.REF = 1;
     2289     8784    5                   CALL MODIFY_6('FR      ');
     2290     8785    6                   IF KEY_MULT_REF THEN DO;
     2291     8786    6                       CALL FINDOS_6('SN-SE   '); /* SN of real FR of altkey field */
     2292     8787    6                       CALL FETCHNS_6('SN-NRCO '); /* NR connecting key to field */
     2293     8788    7                       DO WHILE (UWA.NR.RELTYPE ~= 18); /* key in rec */
     2294     8789    7                           CALL FETCHNS_6('SN-NRCO ');
     2295     8790    7                           END;
     2296     8791    6                       CALL FINDOS_6('SN-NRWU ');
              8791                                /* SN of first field ref'ed by altkey */
     2297     8792    6                       CALL FINDNS_6('SN-NRWU '); /* NR */
     2298     8793    6                       CALL FINDOS_6('SN-NRCO ');
              8793                                /* SN of other field used by altkey */
     2299     8794    6                       CALL FETCHNS_6('SN-SE   ');
              8794                                /* FR of other field used by altkey */
     2300     8795    6                       IF (UWA.FR.FTYPE ~= FR.FTYPE) OR
     2301     8796    6                          (UWA.FR.PREC ~= FR.PREC) OR
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:74   
     2302     8797    6                          (UWA.FR.SCALE ~= FR.SCALE)
     2303     8798    6                       THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4155);
     2304     8799        /*E* ERROR: ZIG-4155-C
     2305     8800             MESSAGE: All of the data base identifiers defined for key
     2306     8801                      "%U1" do not have the same type, precision, and
     2307     8802                      scale.
     2308     8803        */
     2309     8804    6                       CALL FINDD_6('FR      ',FR.FR_FRH); /* restore currency of FR */
     2310     8805    6                       END;
     2311     8806         /* build real CF and connect it to SM */
     2312     8807    5                   UWA.C_F = '0'B;
     2313     8808    5                   UWA.C_F.SYN = 0;
     2314     8809    5                   UWA.C_F.CTRLTYPE = 3;
     2315     8810    5                   CALL STRE_6('C-F      ');
     2316     8811    5                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;
     2317     8812    5                   CALL CONNECT_6('SMSS-CF ');
     2318     8813    5                   CALL MOVE_TO_FIRST_POS( FR.FR_FRH, 'FR-CFS  ',
     2319     8814    5                      'FR      ', 'C-F     ' );
     2320     8815         /* Move old CF to end of SMSS-CF chain */
     2321     8816    5                   CALL FETCHOS_6('SMSS-CF ');
     2322     8817    5                   CALL FETCHNS_6('SMSS-CF ');
     2323     8818    5                   CALL DISCONNECT_6('SMSS-CF ');
     2324     8819    5                   CALL CONNECT_6('SMSS-CF ');
     2325     8820         /* now update the SFR */
     2326     8821    5                   CALL FETCHD_6('FR      ',DBK_SFR);
     2327     8822    5                   UWA.FR.FTYPE = FR.FTYPE;
     2328     8823    5                   UWA.FR.PREC = FR.PREC;
     2329     8824    5                   UWA.FR.SCALE = FR.SCALE;
     2330     8825    5                   UWA.FR.F_SIGN = FR.F_SIGN;
     2331     8826    5                   UWA.FR.FR_FRH = FR.FR_FRH;
     2332     8827    5                   CALL MODIFY_6('FR      ');
     2333     8828    5                   END; /* ELSE DO */
     2334     8829    4               END; /* case */
     2335     8830         /* on to the next  possibly synonymous FR */
     2336     8831    3           CALL FETCHNS_6('RC-FR   ') ALTRET(EOS_RCFR);
     2337     8832    3           END;
     2338     8833    2   EOS_RCFR:
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:75   
     2339     8834    2   END CLEAN_UP_REC;
     2340     8835        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:76   
     2341     8836    1   RESTORE_CURRENTS:
     2342     8837    1       PROC;
     2343     8838    2       CALL FINDD_6('SF      ',2);
     2344     8839    2       IF UWA.DB_STATUS ~= '0000000'
     2345     8840    2       THEN CALL ABORT;
     2346     8841    2       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);
     2347     8842    2       CALL FINDD_6('DA      ',UWA.SF.DBKEY_DA);
     2348     8843    2       CALL FINDD_6('SA      ',UWA.SF.DBKEY_SA);
     2349     8844    2       RETURN;
     2350     8845    2   END RESTORE_CURRENTS;
     2351     8846        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:77   
     2352     8847    1   ADD_LOCK:
     2353     8848    1       PROC(LKNAME, TYPE);
     2354     8849    2   DCL LKNAME CHAR (30);
     2355     8850    2   DCL TYPE UBIN (36);
     2356     8851    2   DCL LOCK_TYPE UBIN (6) UNAL;
     2357     8852    2       ALLOCATE_END = 1;
     2358     8853    2       LOCK_TYPE = 1;
     2359     8854    2       CALL ZIG$HASH_IT(LKNAME,%ADD_ALT_HASH,ERROR_STATUS,0,0,
     2360     8855    2          SIZEW(LK),LK$,LOCK_TYPE);
     2361     8856    2       IF ERROR_STATUS = 0
     2362     8857    3       THEN DO;
     2363     8858    3           LK.NEXT_LT$ = ADDR(NIL);
     2364     8859    3           UWA.DA.NUMB_LK = UWA.DA.NUMB_LK + 1;
     2365     8860    3           END;
     2366     8861    2       CALL ZIG$G_DYN_MEM_6(SIZEW(LT), LT$);
     2367     8862    2       UWA.DA.NUMB_LT = UWA.DA.NUMB_LT + 1;
     2368     8863    2       LT.NEXT_LT$ = LK.NEXT_LT$;
     2369     8864    2       LK.NEXT_LT$ = LT$;
     2370     8865    2       LT.TYPE = TYPE;
     2371     8866    2       LT.DBK_SN = LAST_LOCKABLE_DBK;
     2372     8867    2       LT.LNO = LNO;
     2373     8868    2       LT.LOCKS=0;
     2374     8869    2       LT.LOCKS_BITS(%COPY_BIT) = OA_LKS.COPY;
     2375     8870    2       LT.LOCKS_BITS(%DISPLAY_BIT) = OA_LKS.DISPLAY;
     2376     8871    2       LT.LOCKS_BITS(%LOCKS_BIT) = OA_LKS.XLOCKS;
     2377     8872    2       LT.LOCKS_BITS(%ALTER_BIT) = OA_LKS.ALTER;
     2378     8873    2       LT.LOCKS_BITS(%GET_BIT) = RC_LKS.FR_LKS.GET;
     2379     8874    2       LT.LOCKS_BITS(%MODIFY_BIT) = RC_LKS.FR_LKS.MODIFY;
     2380     8875    2       LT.LOCKS_BITS(%STORE_BIT) = RC_LKS.MISC.STORE;
     2381     8876    2       LT.LOCKS_BITS(%DELETE_BIT) = RC_LKS.MISC.DELETE;
     2382     8877    2       LT.LOCKS_BITS(%INSERT_BIT) = RC_LKS.SC_LKS.XINSERT;
     2383     8878    2       LT.LOCKS_BITS(%REMOVE_BIT) = RC_LKS.SC_LKS.REMOVE;
     2384     8879    2       LT.LOCKS_BITS(%FIND_BIT) = RC_LKS.SC_LKS.FIND;
     2385     8880    2       ALLOCATE_END = 0;
     2386     8881    2   END ADD_LOCK;
     2387     8882        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:78   
     2388     8883    1   HYPH_TO_UNDR:
     2389     8884    1       PROC;
     2390     8885    2       CALL INDEX(X,'-',WORD1);
     2391     8886    3       DO WHILE (X ~= LENGTHC(WORD1));
     2392     8887    4           IF FIRST_HYPHEN THEN DO;
     2393     8888    4               FIRST_HYPHEN = '0'B;
     2394     8889    4               CALL ZIG$D_DIAG(LNO,%WARN_SEV,9480);
     2395     8890        /*E* ERROR: ZIG-9480-C
     2396     8891             MESSAGE: It appears that the character '-' is being used in the
     2397     8892                      formation of a name.  The schema syntax requires the ASCII
     2398     8893                      underscore (BCD left arrow) for this purpose.  The character
     2399     8894                      '-' is used only as a minus sign specifier.  All hyphens
     2400     8895                      will be replaced by underscores.
     2401     8896        */
     2402     8897    4               END;
     2403     8898    3           CALL INSERT(WORD1,X,1,'_');
     2404     8899    3           CALL INDEX1(X,'-',WORD1);
     2405     8900    3           END;
     2406     8901    2   END HYPH_TO_UNDR;
     2407     8902        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:79   
     2408     8903    1   END ZIG$D_PSET;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:80   
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_DDL_INCL.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIG$D_PSET.

   Procedure ZIG$D_PSET requires 6007 words for executable code.
   Procedure ZIG$D_PSET requires 66 words of local(AUTO) storage.

    No errors detected in file ZIG$D_PSET.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:81   

 Object Unit name= ZIG$D_PSET                                 File name= ZIG$D_PSET.:ZIC0TOU
 UTS= SEP 05 '97 12:01:19.92 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none   102    146  ZIG$D_PSET
    1  LblCom even  none     1      1  NUM
    2  LblCom even  none     1      1  LK$
    3  LblCom even  none     1      1  LT$
    4  LblCom even  none     1      1  LAST_RC_DBK
    5  LblCom even  none     1      1  DBK_STAR_SYSTEM_RC
    6  LblCom even  none     1      1  DBK_STAR_CALC_RC
    7  LblCom even  none     1      1  LINE_COUNT
    8  LblCom even  none     1      1  LAST_RC$
    9  LblCom even  none     1      1  ERROR_STATUS
   10  LblCom even  none     1      1  END_DDL
   11  LblCom even  none  1000   1750  LINE
   12  LblCom even  none     1      1  LAST_STATUS
   13  LblCom even  none     1      1  FIRST_HYPHEN
   14  LblCom even  none     1      1  NEED_LARGER_SCHEMA
   15  LblCom even  none     1      1  SET_ERROR
   16  LblCom even  none     1      1  OTHER_DDL_FLAG
   17  LblCom even  none     1      1  FIRST_SET_ERROR
   18   DCB   even  none     0      0  M$UC
   19  LblCom even  none    12     14  ANALS
   20  LblCom even  none    13     15  PURGE
   21  LblCom even  none    19     23  DICTS
   22  LblCom even  none    23     27  DISPS
   23  LblCom even  none    22     26  VALIDS
   24  LblCom even  none    12     14  LOCKS
   25  LblCom even  none    10     12  STRAN
   26  LblCom even  none    12     14  DTRAN
   27  LblCom even  none    16     20  SSTRANS
   28  LblCom even  none    20     24  SSGEN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:82   
   29  LblCom even  none     1      1  NUM_ERROR_MSG
   30  LblCom even  none     1      1  NUM_WARN_MSG
   31  LblCom even  none     1      1  ALLOCATE_END
   32  LblCom even  none     2      2  SUBSCHEMA_KEY
   33  LblCom even  none     1      1  BUFFER$
   34  LblCom even  none     1      1  ERROR_IO
   35  LblCom even  none     1      1  BUFFER_LEN
   36  LblCom even  none     2      2  UWA_KEY
   37  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   38  LblCom even  none     2      2  RVA_KEY
   39  LblCom even  none     2      2  IA__KEY
   40  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   41  LblCom even  none    32     40  SEARCHR_NB
   42  LblCom even  none    32     40  SEM_COM
   43  LblCom even  none    32     40  DMCL_XLATE
   44  LblCom even  none    32     40  Q2_PERCENT
   45  LblCom even  none     1      1  NUMB_RECORD_SN
   46  LblCom even  none     1      1  NUMB_FIELD_SN
   47  LblCom even  none     1      1  NUMB_SET_SN
   48  LblCom even  none     1      1  RECORD$
   49  LblCom even  none     1      1  FIELD$
   50  LblCom even  none     1      1  SET$
   51  LblCom even  none     1      1  DYNMEM_START$
   52  LblCom even  none     1      1  DBK_STAR_DBPARAM_RC
   53  LblCom even  none     1      1  DBK_SO_CALC
   54  LblCom even  none     1      1  LAST_DEF_SET_DBK
   55  LblCom even  none     1      1  LAST_DEF_REC_DBK
   56  LblCom even  none     8     10  FIELD1
   57  LblCom even  none   656   1220  UWA
   58  RoData even  UTS    112    160  ZIG$D_PSET
   59   Proc  even  none  6007  13567  ZIG$D_PSET
   60  RoData even  none   348    534  ZIG$D_PSET
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:83   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    59      0   yes            yes      Std        1  ZIG$D_PSET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 ZIG$D_READ
 yes     yes           Std       1 FETCHOS_6
         yes           Std       2 SF_OPEN
 yes     yes           Std       2 FETCHD_6
         yes           Std       2 ZIG$G_DYN_MEM_6
         yes           Std       3 ZIG$D_DIAG
 yes     yes           Std       1 STRE_6
         yes           Std       8 ADD_SN
 yes     yes           Std       2 FINDD_6
 yes     yes           Std       1 FINDPS_6
         yes           Std       3 SET_FIELDS
 yes     yes           Std       1 FETCHPS_6
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       1 CONNECT_6
 yes     yes           Std       1 FINDNS_6
 yes     yes           Std       1 FETCHNS_6
         yes           Std       2 SF_CLOSE
 yes     yes           Std       1 FINDOS_6
         yes           Std       2 ZIG$D_FAIL
 yes     yes           Std       1 MODIFYMEM_6
         yes           Std       4 MOVE_TO_FIRST_POS
 yes     yes           Std       1 MODIFY_6
         yes           Std       8 ZIG$HASH_IT
 yes     yes           Std       1 DISCONNECT_6
         yes           Std       8 JUST_FIND_SN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:84   
         yes           Std       0 ABORT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SYNTAX_ERR                            M$UC                                  DDL_P

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:85   


        1        1        /*M*     ZIG$D_PSET    DDL TRANSLATE INTERFACE I-D-S/II  DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:    ZIG$D_PSET
        9        9        PURPOSE: This subroutine is called from X$PARSE to do three things:
       10       10                 First:
       11       11                      Get more input for X$PARSE, if the line continues, by
       12       12                      calling ZIG$D_READ.
       13       13                 Second:
       14       14                      To set things in the schema for things given in the DDL
       15       15                 Third:
       16       16                      Find all syntax errors and print the messages through
       17       17                      M$LO and M$DO using M$ERRMSG.
       18       18                      It will also try to recover from all syntax errors and
       19       19                      parse as much as possible so that all errors will be
       20       20                      printed in one pass. (This may cause compounding.)
       21       21        */
       22       22        ZIG$D_PSET:
       23       23            PROC (PARAN);

     23 59 000000   000000 700200 xent  ZIG$D_PSET   TSX0  ! X66_AUTO_1
        59 000001   000102 000001                    ZERO    66,1

       24       24    1   DCL ZIG$HASH_IT ENTRY(8);
       25       25    1   DCL ZIG$D_FAIL ENTRY(2);
       26       26    1   DCL ZIG$D_READ ENTRY;
       27       27    1   DCL ADD_SN ENTRY(8);
       28       28    1   DCL ZIG$D_DIAG ENTRY(3);
       29       29    1   DCL JUST_FIND_SN ENTRY (8);
       30       30    1   DCL MOVE_TO_FIRST_POS ENTRY (4);
       31       31        /************************************
       32       32        * since we have to mess with RCs of *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:86   
       33       33        * *calc.rc and *system, keep info   *
       34       34        * on current record being defineed  *
       35       35        * Then, after record entry and all  *
       36       36        * it's fields have been defined, put*
       37       37        * RC. into UWA.RC. and modify it.   *
       38       38        ************************************/
       39       39    1   DCL 1 RC STATIC,
       40       40    1         2 RTYPE SBIN (36) ,
       41       41    1         2 PSMODE SBIN (36) ,
       42       42    1         2 FIXVAR SBIN (36) ,
       43       43    1         2 WITHINA SBIN (36) ,
       44       44    1         2 SO SBIN (36) ,
       45       45    1         2 SM SBIN (36) ,
       46       46    1         2 CYCLE SBIN (36) ,
       47       47    1         2 CALCDUP SBIN (36) ,
       48       48    1         2 ANY_IND SBIN (36) ,
       49       49    1         2 KEY_PRESENT SBIN (36) ,
       50       50    1         2 CV_OFFSET SBIN (36) ,
       51       51    1         2 PA_OFFSET SBIN (36) ,
       52       52    1         2 PA_ENTRY SBIN (36) ,
       53       53    1         2 NUM_SOSM SBIN (36) ,
       54       54    1         2 LSIZE SBIN (36) ,
       55       55    1         2 SLACK SBIN (36) ;
       56       56        /**********************
       57       57        * needed for get_num  *
       58       58        * All numeric tokens  *
       59       59        * are put here        *
       60       60        **********************/
       61       61    1   DCL NUM SBIN WORD EXT;
       62       62        /**********************
       63       63        * needed for get_word *
       64       64        * All alphabetic      *
       65       65        * tokens are put here.*
       66       66        **********************/
       67       67    1   DCL WORD1 CHAR(30) STATIC;
       68       68        /************************
       69       69        * required clause types *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:87   
       70       70        * These bits are init   *
       71       71        * to '0'b and set to '1'*
       72       72        * when the clause is    *
       73       73        * successfully parsed.  *
       74       74        * Then, if the clause is*
       75       75        * encountered again, it *
       76       76        * must be an error.     *
       77       77        ************************/
       78       78    1   DCL CLAUSE_TYPE CHAR(12);
       79       79    1   DCL LOCATION BIT(1) STATIC;
       80       80    1   DCL WITHIN BIT(1) STATIC;
       81       81    1   DCL TYPE BIT(1) STATIC;
       82       82    1   DCL OWNER BIT(1) STATIC;
       83       83    1   DCL PRIOR BIT(1) STATIC;
       84       84    1   DCL ORDER BIT(1) STATIC;
       85       85    1   DCL SORTKEY BIT(1) STATIC;
       86       86    1   DCL LINKED BIT(1) STATIC;
       87       87    1   DCL PERM BIT(1) STATIC;
       88       88    1   DCL SELECTION BIT(1) STATIC;
       89       89        /************************
       90       90        *   lock types          *
       91       91        ************************/
       92       92    1   DCL 1 OA_LKS STATIC UNAL,
       93       93    1         2 XLOCKS BIT(1) INIT('0'B),
       94       94    1         2 DISPLAY BIT(1) INIT('0'B),
       95       95    1         2 COPY BIT(1) INIT('0'B),
       96       96    1         2 ALTER BIT(1) INIT('0'B);
       97       97    1   DCL 1 RC_LKS STATIC UNAL,
       98       98    1         2 SC_LKS,
       99       99    1           3 XINSERT BIT(1) INIT('0'B),
      100      100    1           3 REMOVE BIT(1) INIT('0'B),
      101      101    1           3 FIND BIT(1) INIT('0'B),
      102      102    1         2 FR_LKS,
      103      103    1           3 MODIFY BIT(1) INIT('0'B),
      104      104    1           3 GET BIT(1) INIT('0'B),
      105      105    1         2 MISC,
      106      106    1           3 STORE BIT(1) INIT('0'B),
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:88   
      107      107    1           3 DELETE BIT(1) INIT('0'B);
      108      108    1   DCL LK$ PTR EXT;
      109      109    1   DCL 1 LK BASED(LK$) ALIGNED,
      110      110    1         2 ALIAS_TYPE UBIN (3) UNAL,
      111      111    1         2 TYPE UBIN (3) UNAL,
      112      112    1         2 DUPS UBIN (12) UNAL,
      113      113    1         2 C_NAME CHAR (30) UNAL,
      114      114    1         2 PTR$ PTR ALIGNED,
      115      115    1         2 NEXT_LT$ PTR ALIGNED;
      116      116    1   DCL LT$ PTR EXT;
      117      117    1   DCL 1 LT BASED(LT$) ALIGNED,
      118      118    1         2 NEXT_LT$ PTR ALIGNED,
      119      119    1         2 TYPE UBIN (36) ALIGNED,
      120      120    1         2 DBK_SN UBIN (36) ALIGNED,
      121      121    1         2 LOCKS UBIN (36) ALIGNED,
      122      122    1         2 LOCKS_BITS(0:35) REDEF LOCKS BIT (1) UNAL,
      123      123    1         2 LNO UBIN (36) ALIGNED;
      124      124        %EQU SCHEMA_LOCK = 10;
      125      125        %EQU RECORD_LOCK = 40;
      126      126        %EQU ITEM_LOCK = 50;
      127      127        %EQU SET_LOCK = 30;
      128      128        %EQU COPY_BIT = 0;
      129      129        %EQU DISPLAY_BIT = 1;
      130      130        %EQU LOCKS_BIT = 2;
      131      131        %EQU ALTER_BIT = 3;
      132      132        %EQU GET_BIT = 9;
      133      133        %EQU MODIFY_BIT = 10;
      134      134        %EQU STORE_BIT = 11;
      135      135        %EQU DELETE_BIT = 12;
      136      136        %EQU INSERT_BIT = 13;
      137      137        %EQU REMOVE_BIT = 14;
      138      138        %EQU FIND_BIT = 15;
      139      139    1   DCL LAST_LOCKABLE_DBK UBIN (36) STATIC;
      140      140    1   DCL PTR$ PTR STATIC;
      141      141        /*******************
      142      142        * Temporary holder *
      143      143        * for a dbk        *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:89   
      144      144        *******************/
      145      145    1   DCL HOLD_DBK UBIN WORD;
      146      146        /******************************
      147      147        * Flag to be set when an      *
      148      148        * error occurs and processing *
      149      149        * will be stopped             *
      150      150        ******************************/
      151      151    1   DCL FLAG_ERROR BIT(1) STATIC;
      152      152        /********************************
      153      153        * used to keep track of record  *
      154      154        * in which field is defined     *
      155      155        * Also to keep track of RC of   *
      156      156        * last SM in a set              *
      157      157        ********************************/
      158      158    1   DCL LAST_RC_DBK UBIN WORD EXT;
      159      159    1   DCL LAST_RC_SN UBIN WORD STATIC;
      160      160    1   DCL LAST_RC_NAME CHAR(30) STATIC;
      161      161        /********************************
      162      162        * used for qualified            *
      163      163        * data-base identifiers         *
      164      164        ********************************/
      165      165    1   DCL QUAL BIT(1) STATIC;
      166      166    1   DCL QFR_NAME CHAR(30) STATIC;
      167      167    1   DCL QRC_DBK UBIN WORD STATIC;
      168      168        /*******************************
      169      169        * keep track for filling in SS *
      170      170        *******************************/
      171      171    1   DCL LAST_SC_DBK UBIN WORD STATIC;
      172      172    1   DCL LAST_SC_SN UBIN WORD STATIC;
      173      173    1   DCL LAST_SO_DBK UBIN WORD STATIC;
      174      174        /*******************************
      175      175        * Keep track for adding second *
      176      176        * SM to RC_SOSM for altkeys    *
      177      177        *******************************/
      178      178    1   DCL DBK_SM_ALTKEY UBIN WORD;
      179      179        /********************************
      180      180        * want SFRs to be first in RC-FR*
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:90   
      181      181        * so keep track of first SFR so *
      182      182        * can add all real FRs after it *
      183      183        ********************************/
      184      184    1   DCL FIRST_SFR_DBK UBIN WORD STATIC INIT(0);
      185      185        /********************************
      186      186        * keep track of DBK of *system  *
      187      187        * and *dbparam RCs              *
      188      188        ********************************/
      189      189    1   DCL DBK_STAR_SYSTEM_RC UBIN WORD EXT;
      190      190    1   DCL DBK_STAR_CALC_RC UBIN WORD EXT;
      191      191        /**********************************************
      192      192        * for calc key purposes, save for each record *
      193      193        **********************************************/
      194      194    1   DCL DBK_SM_CALC UBIN WORD STATIC; /* SM connected to RC containing calckey */
      195      195    1   DCL DBK_SS_CALC UBIN WORD STATIC; /* SS of that SM */
      196      196        /*********************************
      197      197        * DDL text line number          *
      198      198        ********************************/
      199      199    1   DCL LINE_COUNT UBIN WORD EXT;
      200      200        /*********************************
      201      201        * needed for comparing sort keys *
      202      202        *********************************/
      203      203    1   DCL END_OF_KEYS BIT(1);
      204      204    1   DCL CURR_CF_DBK UBIN WORD;
      205      205    1   DCL PREV_CF_DBK UBIN WORD;
      206      206    1   DCL 1 TCF DALIGNED,
      207      207    1         2 * CHAR(20);
      208      208    1   DCL 1 TFR DALIGNED,
      209      209    1         2 * CHAR(8) ALIGNED,
      210      210    1         2 FTYPE SBIN (36) ALIGNED,
      211      211    1         2 PREC SBIN (36) ALIGNED,
      212      212    1         2 SCALE SBIN (36) ALIGNED,
      213      213    1         2 F_SIGN SBIN (36) ALIGNED,
      214      214    1         2 * CHAR(44) ALIGNED;
      215      215        /******************************************
      216      216        * signifies that record entry, including  *
      217      217        * all field definitions, is completed     *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:91   
      218      218        ******************************************/
      219      219    1   DCL REC_ENTRY_DONE BIT(1) STATIC INIT('0'B);
      220      220        /**********************************
      221      221        * needed for handling sort keys   *
      222      222        **********************************/
      223      223    1   DCL FIRST_MEMBER BIT(1) STATIC;
      224      224    1   DCL LAST_SM_DBK UBIN WORD STATIC;
      225      225    1   DCL DESC SBIN (36) STATIC;
      226      226    1   DCL CURR_SETNAME CHAR(30) STATIC;
      227      227    1   DCL DBK_CALC_CF UBIN WORD;
      228      228    1   DCL NUM_AREAS_WITHIN UBIN WORD STATIC;
      229      229        /******************************************
      230      230        * needed to ensure that key mentioned in  *
      231      231        * LOC MODE INDEXED clause is defined in a *
      232      232        * KEY NAME IS clause in same record.      *
      233      233        * If defined, this field set back to      *
      234      234        * blanks.  At end of record def, if it    *
      235      235        * is blank, then all is well.             *
      236      236        ******************************************/
      237      237    1   DCL INDX_KEY_NM CHAR(30) STATIC INIT(' ');
      238      238        /***********************************************
      239      239        * needed for ensuring consistent level numbers *
      240      240        ***********************************************/
      241      241    1   DCL LEV_NUM UBIN WORD STATIC;
      242      242        /**************************
      243      243        * Don't want to modify FR *
      244      244        * if no new FR was stored *
      245      245        **************************/
      246      246    1   DCL MOD_FR_OK BIT(1) STATIC;
      247      247        /********************************
      248      248        * Don't want to process MEMBERs *
      249      249        * of a set if there is no       *
      250      250        * correct OWNER clause.         *
      251      251        ********************************/
      252      252    1   DCL OWNER_CLAUSE_FOUND BIT(1) STATIC;
      253      253        /********************************
      254      254        * save field dbkeys             *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:92   
      255      255        ********************************/
      256      256    1   DCL DBK_RFR UBIN WORD;
      257      257    1   DCL DBK_SFR UBIN WORD;
      258      258        /*******************************
      259      259        * needed for LOC MODE VIA      *
      260      260        *******************************/
      261      261    1   DCL LAST_RC$ PTR EXT;
      262      262        /***********************************
      263      263        * Returned by ZIG$HASH_IT          *
      264      264        ***********************************/
      265      265    1   DCL ERROR_STATUS UBIN WORD EXT;
      266      266        /*****************************************
      267      267        * Signifies that all DDL has been read in*
      268      268        *****************************************/
      269      269    1   DCL END_DDL BIT (1) EXT;
      270      270        /********************************
      271      271        * DDL is compacted into this    *
      272      272        ********************************/
      273      273    1   DCL LINE CHAR (4000) EXT;
      274      274        /******************************************
      275      275        * Keeps track of which entry we're in     *
      276      276        ******************************************/
      277      277    1   DCL LAST_STATUS UBIN(6) EXT INIT(0);
      278      278        /*************************************
      279      279        * Conveys node type when calling FAIL*
      280      280        *************************************/
      281      281    1   DCL J UBIN (36);
      282      282    1   DCL SYNTAX_ERR BIT(72) SYMREF;
      283      283        /******************************
      284      284        * Global variable to show if  *
      285      285        * a hyphen has been found     *
      286      286        ******************************/
      287      287    1   DCL FIRST_HYPHEN BIT(1) EXT;
      288      288        /*************************************
      289      289        * Indicates whether an error or a    *
      290      290        * warning is to be stored in the     *
      291      291        * diagnostics table                  *
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:93   
      292      292        *************************************/
      293      293        %EQU WARN_SEV = 1;
      294      294        %EQU ERR_SEV = 2;
      295      295        /**********************************
      296      296        * Contain the length of the       *
      297      297        * fields %U1, %U2, and %U3        *
      298      298        * to be printed in error messages *
      299      299        **********************************/
      300      300    1   DCL CT1 UBIN (36);
      301      301    1   DCL CT2 UBIN (36);
      302      302    1   DCL CT3 UBIN (36);
      303      303        /**********************************
      304      304        * Needed to float size of schema. *
      305      305        **********************************/
      306      306    1   DCL SF_CLOSE ENTRY (2);
      307      307    1   DCL SF_OPEN ENTRY (2);
      308      308    1   DCL NEED_LARGER_SCHEMA BIT (1) EXT;
      309      309    1   DCL STATUS UBIN (36);
      310      310        /***********************
      311      311        *  Index counter       *
      312      312        ***********************/
      313      313    1   DCL X UBIN (36);
      314      314        /***************************
      315      315        * Flags to stop processing *
      316      316        * of a set with an         *
      317      317        * undefined owner record   *
      318      318        ***************************/
      319      319    1   DCL SET_ERROR BIT (1) EXT;
      320      320    1   DCL OTHER_DDL_FLAG BIT (1) EXT;
      321      321    1   DCL DO_PROCESS BIT (1);
      322      322    1   DCL FIRST_SET_ERROR BIT (1) EXT;
      323      323        /********************
      324      324        * Flag for negative *
      325      325        * SCALE factor      *
      326      326        ********************/
      327      327    1   DCL NEG_SCALE BIT (1) STATIC;
      328      328        /*****************************
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:94   
      329      329        *     includes               *
      330      330        *****************************/
      331      331        %INCLUDE CP_6;
      332      412        %INCLUDE CP_6_SUBS;
      333      952        %INCLUDE ZIG_DIR_STRUCS;
      334     1082        %INCLUDE ZIG_GENERAL;
      335     1190        %INCLUDE ZIG_DDL_INCL;
      336     1452         %PARSE_SCH_DDL;
      337     1611         %DDL_XLATE;
      338     1706        %INCLUDE ZIG_TYPE_SUBS;
      339     1721        %INCLUDE ZI_SUB4_CAN;
      340     2378        %UWA;
      341     2713        %INCLUDE ZIG_DBA_INT;
      342     2761        %INCLUDE ZI_ERRORS_SUBS;
      343     3281        %INCLUDE XU_MACRO_C;
      344     6387        %INCLUDE XU_SUBS_C;
      345     6479        %P$PCB(NAME=DDL_P,STCLASS=SYMREF);
      346     6680        %PARSE$PARAM(NAME=PARAN);
      347     6761        %PARSE$OUT(NAME=BLK,STCLASS=BASED);
      348     6806        %PARSE$SYM(NAME=SYM,STCLASS=BASED);
      349     6844        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:95   
      350     6845        /******************************************************
      351     6846        *******************************************************
      352     6847        ***************** start here **************************
      353     6848        *******************************************************
      354     6849        ******************************************************/
      355     6850    1       LNO = LINE_COUNT - 1;

   6850 59 000002   000000 235000 7                  LDA     LINE_COUNT
        59 000003   000001 135007                    SBLA    1,DL
        59 000004   200060 755100                    STA     LNO,,AUTO

      356     6851    1       IF SET_ERROR AND PARAN.TYPE ~= %INPUT#

   6851 59 000005   000000 234000 15                 SZN     SET_ERROR
        59 000006   000041 605000 59                 TPL     s:6868
        59 000007   200003 470500                    LDP0    @PARAN,,AUTO
        59 000010   000000 236100                    LDQ     0,,PR0
        59 000011   777000 376003                    ANQ     -512,DU
        59 000012   004000 116003                    CMPQ    2048,DU
        59 000013   000041 600000 59                 TZE     s:6868

      357     6852    2       THEN DO;

      358     6853    2           IF NOT OTHER_DDL_FLAG THEN

   6853 59 000014   000000 234000 16                 SZN     OTHER_DDL_FLAG
        59 000015   000020 604000 59                 TMI     s:6856

      359     6854    2               DO_PROCESS = '0'B;

   6854 59 000016   200055 450100                    STZ     DO_PROCESS,,AUTO
        59 000017   000033 710000 59                 TRA     s:6864

      360     6855    3           ELSE DO;

      361     6856    3               OTHER_DDL_FLAG = '0'B;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:96   
   6856 59 000020   000000 450000 16                 STZ     OTHER_DDL_FLAG

      362     6857    3               IF (PARAN.CODE = %MEM_REC_NM) OR (PARAN.CODE = %LEVEL_NUM) THEN

   6857 59 000021   000000 720100                    LXL0    0,,PR0
        59 000022   000116 100003                    CMPX0   78,DU
        59 000023   000026 600000 59                 TZE     s:6858
        59 000024   000054 100003                    CMPX0   44,DU
        59 000025   000030 601000 59                 TNZ     s:6860

      363     6858    3                   DO_PROCESS = '0'B;

   6858 59 000026   200055 450100                    STZ     DO_PROCESS,,AUTO
        59 000027   000033 710000 59                 TRA     s:6864

      364     6859    4               ELSE DO;

      365     6860    4                   DO_PROCESS = '1'B;

   6860 59 000030   400000 236003                    LDQ     -131072,DU
        59 000031   200055 756100                    STQ     DO_PROCESS,,AUTO

      366     6861    4                   SET_ERROR = '0'B;

   6861 59 000032   000000 450000 15                 STZ     SET_ERROR

      367     6862    4                   END;

      368     6863    3               END;

      369     6864    2           IF PARAN.CODE = %OTHER_DDL THEN

   6864 59 000033   000000 720100                    LXL0    0,,PR0
        59 000034   000007 100003                    CMPX0   7,DU
        59 000035   000043 601000 59                 TNZ     s:6869

      370     6865    2               OTHER_DDL_FLAG = '1'B;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:97   

   6865 59 000036   400000 236003                    LDQ     -131072,DU
        59 000037   000000 756000 16                 STQ     OTHER_DDL_FLAG

      371     6866    2           END;

   6866 59 000040   000043 710000 59                 TRA     s:6869

      372     6867    1       ELSE
      373     6868    1           DO_PROCESS = '1'B;

   6868 59 000041   400000 236003                    LDQ     -131072,DU
        59 000042   200055 756100                    STQ     DO_PROCESS,,AUTO

      374     6869    1       IF DO_PROCESS

   6869 59 000043   200055 234100                    SZN     DO_PROCESS,,AUTO
        59 000044   012440 605000 59                 TPL     s:8607

      375     6870    2       THEN DO;

      376     6871    3           DO CASE (PARAN.TYPE);

   6871 59 000045   200003 470500                    LDP0    @PARAN,,AUTO
        59 000046   000000 236100                    LDQ     0,,PR0
        59 000047   000033 772000                    QRL     27
        59 000050   000005 116007                    CMPQ    5,DL
        59 000051   000053 602006 59                 TNC     s:6871+6,QL
        59 000052   012440 710000 59                 TRA     s:8607
        59 000053   012440 710000 59                 TRA     s:8607
        59 000054   000103 710000 59                 TRA     s:6877
        59 000055   000103 710000 59                 TRA     s:6877
        59 000056   012407 710000 59                 TRA     s:8601
        59 000057   000060 710000 59                 TRA     s:6873

      377     6872    3           CASE(%INPUT#);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:98   
      378     6873    3               IF END_DDL THEN UNWIND TO SYNTAX_ERR;

   6873 59 000060   000000 234000 10                 SZN     END_DDL
        59 000061   000070 605000 59                 TPL     s:6874

   6873 59 000062   000100 100600                    MLR   ! fill='000'O
        59 000063   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
        59 000064   200072 000010                    ADSC9   KEY_MULT_REF+1,,AUTO     cn=0,n=8
        59 000065   200072 237300                    LDAQ  ! KEY_MULT_REF+1,,AUTO
        59 000066   000000 700200 xent               TSX0  ! X66_AUNWIND
        59 000067   000000 000200                    ZERO    0,128

      379     6874    3               CALL ZIG$D_READ;

   6874 59 000070   000000 631400 60                 EPPR1   0
        59 000071   000000 701000 xent               TSX1    ZIG$D_READ
        59 000072   000000 011000                    NOP     0

      380     6875    3               IF END_DDL THEN UNWIND TO SYNTAX_ERR;

   6875 59 000073   000000 234000 10                 SZN     END_DDL
        59 000074   012440 605000 59                 TPL     s:8607

   6875 59 000075   000100 100600                    MLR   ! fill='000'O
        59 000076   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
        59 000077   200072 000010                    ADSC9   KEY_MULT_REF+1,,AUTO     cn=0,n=8
        59 000100   200072 237300                    LDAQ  ! KEY_MULT_REF+1,,AUTO
        59 000101   000000 700200 xent               TSX0  ! X66_AUNWIND
        59 000102   000000 000200                    ZERO    0,128

      381     6876    3           CASE(%SUCC#,%PRE#);

      382     6877    4               DO CASE (PARAN.CODE);

   6877 59 000103   000000 720100                    LXL0    0,,PR0
        59 000104   001636 100003                    CMPX0   926,DU
        59 000105   000107 602010 59                 TNC     s:6877+4,X0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:99   
        59 000106   012440 710000 59                 TRA     s:8607
        59 000107   012406 710000 59                 TRA     s:8598
        59 000110   001745 710000 59                 TRA     s:6887
        59 000111   002120 710000 59                 TRA     s:6932
        59 000112   002141 710000 59                 TRA     s:6941
        59 000113   002163 710000 59                 TRA     s:6946
        59 000114   002205 710000 59                 TRA     s:6951
        59 000115   002231 710000 59                 TRA     s:6958
        59 000116   012406 710000 59                 TRA     s:8598
        59 000117   012406 710000 59                 TRA     s:8598
        59 000120   002270 710000 59                 TRA     s:6977
        59 000121   002342 710000 59                 TRA     s:6990
        59 000122   012406 710000 59                 TRA     s:8598
        59 000123   002345 710000 59                 TRA     s:7001
        59 000124   012406 710000 59                 TRA     s:8598
        59 000125   012406 710000 59                 TRA     s:8598
        59 000126   012406 710000 59                 TRA     s:8598
        59 000127   012406 710000 59                 TRA     s:8598
        59 000130   012406 710000 59                 TRA     s:8598
        59 000131   003222 710000 59                 TRA     s:7182
        59 000132   003237 710000 59                 TRA     s:7190
        59 000133   003265 710000 59                 TRA     s:7199
        59 000134   003313 710000 59                 TRA     s:7204
        59 000135   012406 710000 59                 TRA     s:8598
        59 000136   012406 710000 59                 TRA     s:8598
        59 000137   012406 710000 59                 TRA     s:8598
        59 000140   012406 710000 59                 TRA     s:8598
        59 000141   003345 710000 59                 TRA     s:7213
        59 000142   003555 710000 59                 TRA     s:7255
        59 000143   012406 710000 59                 TRA     s:8598
        59 000144   003634 710000 59                 TRA     s:7274
        59 000145   012406 710000 59                 TRA     s:8598
        59 000146   004020 710000 59                 TRA     s:7332
        59 000147   004041 710000 59                 TRA     s:7337
        59 000150   004063 710000 59                 TRA     s:7342
        59 000151   004105 710000 59                 TRA     s:7347
        59 000152   004127 710000 59                 TRA     s:7352
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:100  
        59 000153   004151 710000 59                 TRA     s:7357
        59 000154   004173 710000 59                 TRA     s:7362
        59 000155   004215 710000 59                 TRA     s:7367
        59 000156   004257 710000 59                 TRA     s:7386
        59 000157   012406 710000 59                 TRA     s:8598
        59 000160   012406 710000 59                 TRA     s:8598
        59 000161   004760 710000 59                 TRA     s:7507
        59 000162   005065 710000 59                 TRA     s:7537
        59 000163   005117 710000 59                 TRA     s:7546
        59 000164   005177 710000 59                 TRA     s:7570
        59 000165   005377 710000 59                 TRA     s:7633
        59 000166   005402 710000 59                 TRA     s:7635
        59 000167   005405 710000 59                 TRA     s:7637
        59 000170   005435 710000 59                 TRA     s:7644
        59 000171   005514 710000 59                 TRA     s:7668
        59 000172   005561 710000 59                 TRA     s:7682
        59 000173   005600 710000 59                 TRA     s:7688
        59 000174   005621 710000 59                 TRA     s:7691
        59 000175   005652 710000 59                 TRA     s:7703
        59 000176   005657 710000 59                 TRA     s:7706
        59 000177   005726 710000 59                 TRA     s:7721
        59 000200   005750 710000 59                 TRA     s:7732
        59 000201   005774 710000 59                 TRA     s:7739
        59 000202   012406 710000 59                 TRA     s:8598
        59 000203   006041 710000 59                 TRA     s:7754
        59 000204   006063 710000 59                 TRA     s:7759
        59 000205   006105 710000 59                 TRA     s:7764
        59 000206   012406 710000 59                 TRA     s:8598
        59 000207   006145 710000 59                 TRA     s:7784
        59 000210   006300 710000 59                 TRA     s:7825
        59 000211   006550 710000 59                 TRA     s:7891
        59 000212   006552 710000 59                 TRA     s:7893
        59 000213   006555 710000 59                 TRA     s:7895
        59 000214   006560 710000 59                 TRA     s:7897
        59 000215   006571 710000 59                 TRA     s:7903
        59 000216   006573 710000 59                 TRA     s:7905
        59 000217   006576 710000 59                 TRA     s:7907
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:101  
        59 000220   006601 710000 59                 TRA     s:7913
        59 000221   006622 710000 59                 TRA     s:7918
        59 000222   006644 710000 59                 TRA     s:7923
        59 000223   006666 710000 59                 TRA     s:7928
        59 000224   012406 710000 59                 TRA     s:8598
        59 000225   006726 710000 59                 TRA     s:7949
        59 000226   007304 710000 59                 TRA     s:8036
        59 000227   007306 710000 59                 TRA     s:8038
        59 000230   007311 710000 59                 TRA     s:8040
        59 000231   007313 710000 59                 TRA     s:8042
        59 000232   007321 710000 59                 TRA     s:8050
        59 000233   012406 710000 59                 TRA     s:8598
        59 000234   012406 710000 59                 TRA     s:8598
        59 000235   010227 710000 59                 TRA     s:8215
        59 000236   010231 710000 59                 TRA     s:8217
        59 000237   012406 710000 59                 TRA     s:8598
        59 000240   012406 710000 59                 TRA     s:8598
        59 000241   010604 710000 59                 TRA     s:8298
        59 000242   010625 710000 59                 TRA     s:8308
        59 000243   010647 710000 59                 TRA     s:8317
        59 000244   012406 710000 59                 TRA     s:8598
        59 000245   011016 710000 59                 TRA     s:8354
        59 000246   012406 710000 59                 TRA     s:8598
        59 000247   012406 710000 59                 TRA     s:8598
        59 000250   012406 710000 59                 TRA     s:8598
        59 000251   012406 710000 59                 TRA     s:8598
        59 000252   012406 710000 59                 TRA     s:8598
        59 000253   012406 710000 59                 TRA     s:8598
        59 000254   011374 710000 59                 TRA     s:8428
        59 000255   011450 710000 59                 TRA     s:8440
        59 000256   012406 710000 59                 TRA     s:8598
        59 000257   012406 710000 59                 TRA     s:8598
        59 000260   012406 710000 59                 TRA     s:8598
        59 000261   012406 710000 59                 TRA     s:8598
        59 000262   012406 710000 59                 TRA     s:8598
        59 000263   011654 710000 59                 TRA     s:8485
        59 000264   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:102  
        59 000265   012406 710000 59                 TRA     s:8598
        59 000266   012022 710000 59                 TRA     s:8517
        59 000267   012034 710000 59                 TRA     s:8521
        59 000270   012157 710000 59                 TRA     s:8554
        59 000271   012210 710000 59                 TRA     s:8565
        59 000272   012326 710000 59                 TRA     s:8586
        59 000273   003522 710000 59                 TRA     s:7245
        59 000274   011133 710000 59                 TRA     s:8380
        59 000275   011331 710000 59                 TRA     s:8419
        59 000276   007603 710000 59                 TRA     s:8119
        59 000277   002503 710000 59                 TRA     s:7042
        59 000300   002227 710000 59                 TRA     s:6956
        59 000301   002501 710000 59                 TRA     s:7040
        59 000302   005374 710000 59                 TRA     s:7631
        59 000303   006275 710000 59                 TRA     s:7819
        59 000304   012406 710000 59                 TRA     s:8598
        59 000305   012406 710000 59                 TRA     s:8598
        59 000306   012406 710000 59                 TRA     s:8598
        59 000307   012406 710000 59                 TRA     s:8598
        59 000310   012406 710000 59                 TRA     s:8598
        59 000311   012406 710000 59                 TRA     s:8598
        59 000312   012406 710000 59                 TRA     s:8598
        59 000313   012406 710000 59                 TRA     s:8598
        59 000314   012406 710000 59                 TRA     s:8598
        59 000315   012406 710000 59                 TRA     s:8598
        59 000316   012406 710000 59                 TRA     s:8598
        59 000317   012406 710000 59                 TRA     s:8598
        59 000320   012406 710000 59                 TRA     s:8598
        59 000321   012406 710000 59                 TRA     s:8598
        59 000322   012406 710000 59                 TRA     s:8598
        59 000323   012406 710000 59                 TRA     s:8598
        59 000324   012406 710000 59                 TRA     s:8598
        59 000325   012406 710000 59                 TRA     s:8598
        59 000326   012406 710000 59                 TRA     s:8598
        59 000327   012406 710000 59                 TRA     s:8598
        59 000330   012406 710000 59                 TRA     s:8598
        59 000331   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:103  
        59 000332   012406 710000 59                 TRA     s:8598
        59 000333   012406 710000 59                 TRA     s:8598
        59 000334   012406 710000 59                 TRA     s:8598
        59 000335   012406 710000 59                 TRA     s:8598
        59 000336   012406 710000 59                 TRA     s:8598
        59 000337   012406 710000 59                 TRA     s:8598
        59 000340   012406 710000 59                 TRA     s:8598
        59 000341   012406 710000 59                 TRA     s:8598
        59 000342   012406 710000 59                 TRA     s:8598
        59 000343   012406 710000 59                 TRA     s:8598
        59 000344   012406 710000 59                 TRA     s:8598
        59 000345   012406 710000 59                 TRA     s:8598
        59 000346   012406 710000 59                 TRA     s:8598
        59 000347   012406 710000 59                 TRA     s:8598
        59 000350   012406 710000 59                 TRA     s:8598
        59 000351   012406 710000 59                 TRA     s:8598
        59 000352   012406 710000 59                 TRA     s:8598
        59 000353   012406 710000 59                 TRA     s:8598
        59 000354   012406 710000 59                 TRA     s:8598
        59 000355   012406 710000 59                 TRA     s:8598
        59 000356   012406 710000 59                 TRA     s:8598
        59 000357   012406 710000 59                 TRA     s:8598
        59 000360   012406 710000 59                 TRA     s:8598
        59 000361   012406 710000 59                 TRA     s:8598
        59 000362   012406 710000 59                 TRA     s:8598
        59 000363   012406 710000 59                 TRA     s:8598
        59 000364   012406 710000 59                 TRA     s:8598
        59 000365   012406 710000 59                 TRA     s:8598
        59 000366   012406 710000 59                 TRA     s:8598
        59 000367   012406 710000 59                 TRA     s:8598
        59 000370   012406 710000 59                 TRA     s:8598
        59 000371   012406 710000 59                 TRA     s:8598
        59 000372   012406 710000 59                 TRA     s:8598
        59 000373   012406 710000 59                 TRA     s:8598
        59 000374   012406 710000 59                 TRA     s:8598
        59 000375   012406 710000 59                 TRA     s:8598
        59 000376   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:104  
        59 000377   012406 710000 59                 TRA     s:8598
        59 000400   012406 710000 59                 TRA     s:8598
        59 000401   012406 710000 59                 TRA     s:8598
        59 000402   012406 710000 59                 TRA     s:8598
        59 000403   012406 710000 59                 TRA     s:8598
        59 000404   012406 710000 59                 TRA     s:8598
        59 000405   012406 710000 59                 TRA     s:8598
        59 000406   012406 710000 59                 TRA     s:8598
        59 000407   012406 710000 59                 TRA     s:8598
        59 000410   012406 710000 59                 TRA     s:8598
        59 000411   012406 710000 59                 TRA     s:8598
        59 000412   012406 710000 59                 TRA     s:8598
        59 000413   012406 710000 59                 TRA     s:8598
        59 000414   012406 710000 59                 TRA     s:8598
        59 000415   012406 710000 59                 TRA     s:8598
        59 000416   012406 710000 59                 TRA     s:8598
        59 000417   006524 710000 59                 TRA     s:7884
        59 000420   006503 710000 59                 TRA     s:7879
        59 000421   006545 710000 59                 TRA     s:7889
        59 000422   007316 710000 59                 TRA     s:8044
        59 000423   012406 710000 59                 TRA     s:8598
        59 000424   012406 710000 59                 TRA     s:8598
        59 000425   012406 710000 59                 TRA     s:8598
        59 000426   012406 710000 59                 TRA     s:8598
        59 000427   012406 710000 59                 TRA     s:8598
        59 000430   012406 710000 59                 TRA     s:8598
        59 000431   012406 710000 59                 TRA     s:8598
        59 000432   012406 710000 59                 TRA     s:8598
        59 000433   012406 710000 59                 TRA     s:8598
        59 000434   012406 710000 59                 TRA     s:8598
        59 000435   012406 710000 59                 TRA     s:8598
        59 000436   012406 710000 59                 TRA     s:8598
        59 000437   012406 710000 59                 TRA     s:8598
        59 000440   012406 710000 59                 TRA     s:8598
        59 000441   012406 710000 59                 TRA     s:8598
        59 000442   012406 710000 59                 TRA     s:8598
        59 000443   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:105  
        59 000444   012406 710000 59                 TRA     s:8598
        59 000445   012406 710000 59                 TRA     s:8598
        59 000446   012406 710000 59                 TRA     s:8598
        59 000447   012406 710000 59                 TRA     s:8598
        59 000450   012406 710000 59                 TRA     s:8598
        59 000451   012406 710000 59                 TRA     s:8598
        59 000452   012406 710000 59                 TRA     s:8598
        59 000453   012406 710000 59                 TRA     s:8598
        59 000454   012406 710000 59                 TRA     s:8598
        59 000455   012406 710000 59                 TRA     s:8598
        59 000456   012406 710000 59                 TRA     s:8598
        59 000457   012406 710000 59                 TRA     s:8598
        59 000460   012406 710000 59                 TRA     s:8598
        59 000461   012406 710000 59                 TRA     s:8598
        59 000462   012406 710000 59                 TRA     s:8598
        59 000463   012406 710000 59                 TRA     s:8598
        59 000464   012406 710000 59                 TRA     s:8598
        59 000465   012406 710000 59                 TRA     s:8598
        59 000466   012406 710000 59                 TRA     s:8598
        59 000467   012406 710000 59                 TRA     s:8598
        59 000470   012406 710000 59                 TRA     s:8598
        59 000471   012406 710000 59                 TRA     s:8598
        59 000472   012406 710000 59                 TRA     s:8598
        59 000473   012406 710000 59                 TRA     s:8598
        59 000474   012406 710000 59                 TRA     s:8598
        59 000475   012406 710000 59                 TRA     s:8598
        59 000476   012406 710000 59                 TRA     s:8598
        59 000477   012406 710000 59                 TRA     s:8598
        59 000500   012406 710000 59                 TRA     s:8598
        59 000501   012406 710000 59                 TRA     s:8598
        59 000502   012406 710000 59                 TRA     s:8598
        59 000503   012406 710000 59                 TRA     s:8598
        59 000504   012406 710000 59                 TRA     s:8598
        59 000505   012406 710000 59                 TRA     s:8598
        59 000506   012406 710000 59                 TRA     s:8598
        59 000507   012406 710000 59                 TRA     s:8598
        59 000510   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:106  
        59 000511   012406 710000 59                 TRA     s:8598
        59 000512   012406 710000 59                 TRA     s:8598
        59 000513   012406 710000 59                 TRA     s:8598
        59 000514   012406 710000 59                 TRA     s:8598
        59 000515   012406 710000 59                 TRA     s:8598
        59 000516   012406 710000 59                 TRA     s:8598
        59 000517   012406 710000 59                 TRA     s:8598
        59 000520   012406 710000 59                 TRA     s:8598
        59 000521   012406 710000 59                 TRA     s:8598
        59 000522   012406 710000 59                 TRA     s:8598
        59 000523   012406 710000 59                 TRA     s:8598
        59 000524   012406 710000 59                 TRA     s:8598
        59 000525   012406 710000 59                 TRA     s:8598
        59 000526   012406 710000 59                 TRA     s:8598
        59 000527   012406 710000 59                 TRA     s:8598
        59 000530   012406 710000 59                 TRA     s:8598
        59 000531   012406 710000 59                 TRA     s:8598
        59 000532   012406 710000 59                 TRA     s:8598
        59 000533   012406 710000 59                 TRA     s:8598
        59 000534   012406 710000 59                 TRA     s:8598
        59 000535   012406 710000 59                 TRA     s:8598
        59 000536   012406 710000 59                 TRA     s:8598
        59 000537   012406 710000 59                 TRA     s:8598
        59 000540   012406 710000 59                 TRA     s:8598
        59 000541   012406 710000 59                 TRA     s:8598
        59 000542   012406 710000 59                 TRA     s:8598
        59 000543   012406 710000 59                 TRA     s:8598
        59 000544   012406 710000 59                 TRA     s:8598
        59 000545   012406 710000 59                 TRA     s:8598
        59 000546   012406 710000 59                 TRA     s:8598
        59 000547   012406 710000 59                 TRA     s:8598
        59 000550   012406 710000 59                 TRA     s:8598
        59 000551   012406 710000 59                 TRA     s:8598
        59 000552   012406 710000 59                 TRA     s:8598
        59 000553   012406 710000 59                 TRA     s:8598
        59 000554   012406 710000 59                 TRA     s:8598
        59 000555   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:107  
        59 000556   012406 710000 59                 TRA     s:8598
        59 000557   012406 710000 59                 TRA     s:8598
        59 000560   012406 710000 59                 TRA     s:8598
        59 000561   012406 710000 59                 TRA     s:8598
        59 000562   012406 710000 59                 TRA     s:8598
        59 000563   006563 710000 59                 TRA     s:7899
        59 000564   006566 710000 59                 TRA     s:7901
        59 000565   010522 710000 59                 TRA     s:8279
        59 000566   010542 710000 59                 TRA     s:8288
        59 000567   010563 710000 59                 TRA     s:8293
        59 000570   012406 710000 59                 TRA     s:8598
        59 000571   012406 710000 59                 TRA     s:8598
        59 000572   012406 710000 59                 TRA     s:8598
        59 000573   012406 710000 59                 TRA     s:8598
        59 000574   012406 710000 59                 TRA     s:8598
        59 000575   012406 710000 59                 TRA     s:8598
        59 000576   012406 710000 59                 TRA     s:8598
        59 000577   012406 710000 59                 TRA     s:8598
        59 000600   012406 710000 59                 TRA     s:8598
        59 000601   012406 710000 59                 TRA     s:8598
        59 000602   012406 710000 59                 TRA     s:8598
        59 000603   012406 710000 59                 TRA     s:8598
        59 000604   012406 710000 59                 TRA     s:8598
        59 000605   012406 710000 59                 TRA     s:8598
        59 000606   012406 710000 59                 TRA     s:8598
        59 000607   012406 710000 59                 TRA     s:8598
        59 000610   012406 710000 59                 TRA     s:8598
        59 000611   012406 710000 59                 TRA     s:8598
        59 000612   012406 710000 59                 TRA     s:8598
        59 000613   012406 710000 59                 TRA     s:8598
        59 000614   012406 710000 59                 TRA     s:8598
        59 000615   012406 710000 59                 TRA     s:8598
        59 000616   012406 710000 59                 TRA     s:8598
        59 000617   012406 710000 59                 TRA     s:8598
        59 000620   012406 710000 59                 TRA     s:8598
        59 000621   012406 710000 59                 TRA     s:8598
        59 000622   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:108  
        59 000623   012406 710000 59                 TRA     s:8598
        59 000624   012406 710000 59                 TRA     s:8598
        59 000625   012406 710000 59                 TRA     s:8598
        59 000626   012406 710000 59                 TRA     s:8598
        59 000627   012406 710000 59                 TRA     s:8598
        59 000630   012406 710000 59                 TRA     s:8598
        59 000631   012406 710000 59                 TRA     s:8598
        59 000632   012406 710000 59                 TRA     s:8598
        59 000633   012406 710000 59                 TRA     s:8598
        59 000634   012406 710000 59                 TRA     s:8598
        59 000635   012406 710000 59                 TRA     s:8598
        59 000636   012406 710000 59                 TRA     s:8598
        59 000637   012406 710000 59                 TRA     s:8598
        59 000640   012406 710000 59                 TRA     s:8598
        59 000641   012406 710000 59                 TRA     s:8598
        59 000642   012406 710000 59                 TRA     s:8598
        59 000643   012406 710000 59                 TRA     s:8598
        59 000644   012406 710000 59                 TRA     s:8598
        59 000645   012406 710000 59                 TRA     s:8598
        59 000646   012406 710000 59                 TRA     s:8598
        59 000647   012406 710000 59                 TRA     s:8598
        59 000650   012406 710000 59                 TRA     s:8598
        59 000651   012406 710000 59                 TRA     s:8598
        59 000652   012406 710000 59                 TRA     s:8598
        59 000653   012406 710000 59                 TRA     s:8598
        59 000654   012406 710000 59                 TRA     s:8598
        59 000655   012406 710000 59                 TRA     s:8598
        59 000656   012406 710000 59                 TRA     s:8598
        59 000657   012406 710000 59                 TRA     s:8598
        59 000660   012406 710000 59                 TRA     s:8598
        59 000661   012406 710000 59                 TRA     s:8598
        59 000662   012406 710000 59                 TRA     s:8598
        59 000663   012406 710000 59                 TRA     s:8598
        59 000664   012406 710000 59                 TRA     s:8598
        59 000665   012406 710000 59                 TRA     s:8598
        59 000666   012406 710000 59                 TRA     s:8598
        59 000667   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:109  
        59 000670   012406 710000 59                 TRA     s:8598
        59 000671   012406 710000 59                 TRA     s:8598
        59 000672   012406 710000 59                 TRA     s:8598
        59 000673   012406 710000 59                 TRA     s:8598
        59 000674   012406 710000 59                 TRA     s:8598
        59 000675   012406 710000 59                 TRA     s:8598
        59 000676   012406 710000 59                 TRA     s:8598
        59 000677   012406 710000 59                 TRA     s:8598
        59 000700   012406 710000 59                 TRA     s:8598
        59 000701   012406 710000 59                 TRA     s:8598
        59 000702   012406 710000 59                 TRA     s:8598
        59 000703   012406 710000 59                 TRA     s:8598
        59 000704   012406 710000 59                 TRA     s:8598
        59 000705   012406 710000 59                 TRA     s:8598
        59 000706   012406 710000 59                 TRA     s:8598
        59 000707   012406 710000 59                 TRA     s:8598
        59 000710   012406 710000 59                 TRA     s:8598
        59 000711   012406 710000 59                 TRA     s:8598
        59 000712   012406 710000 59                 TRA     s:8598
        59 000713   012406 710000 59                 TRA     s:8598
        59 000714   012406 710000 59                 TRA     s:8598
        59 000715   012406 710000 59                 TRA     s:8598
        59 000716   012406 710000 59                 TRA     s:8598
        59 000717   012406 710000 59                 TRA     s:8598
        59 000720   012406 710000 59                 TRA     s:8598
        59 000721   012406 710000 59                 TRA     s:8598
        59 000722   012406 710000 59                 TRA     s:8598
        59 000723   012406 710000 59                 TRA     s:8598
        59 000724   012406 710000 59                 TRA     s:8598
        59 000725   012406 710000 59                 TRA     s:8598
        59 000726   012406 710000 59                 TRA     s:8598
        59 000727   012406 710000 59                 TRA     s:8598
        59 000730   012406 710000 59                 TRA     s:8598
        59 000731   012406 710000 59                 TRA     s:8598
        59 000732   012406 710000 59                 TRA     s:8598
        59 000733   012406 710000 59                 TRA     s:8598
        59 000734   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:110  
        59 000735   012406 710000 59                 TRA     s:8598
        59 000736   012406 710000 59                 TRA     s:8598
        59 000737   012406 710000 59                 TRA     s:8598
        59 000740   012406 710000 59                 TRA     s:8598
        59 000741   012406 710000 59                 TRA     s:8598
        59 000742   012406 710000 59                 TRA     s:8598
        59 000743   012406 710000 59                 TRA     s:8598
        59 000744   012406 710000 59                 TRA     s:8598
        59 000745   012406 710000 59                 TRA     s:8598
        59 000746   012406 710000 59                 TRA     s:8598
        59 000747   012406 710000 59                 TRA     s:8598
        59 000750   012406 710000 59                 TRA     s:8598
        59 000751   012406 710000 59                 TRA     s:8598
        59 000752   012406 710000 59                 TRA     s:8598
        59 000753   012406 710000 59                 TRA     s:8598
        59 000754   012406 710000 59                 TRA     s:8598
        59 000755   012406 710000 59                 TRA     s:8598
        59 000756   012406 710000 59                 TRA     s:8598
        59 000757   012406 710000 59                 TRA     s:8598
        59 000760   012406 710000 59                 TRA     s:8598
        59 000761   012406 710000 59                 TRA     s:8598
        59 000762   012406 710000 59                 TRA     s:8598
        59 000763   012406 710000 59                 TRA     s:8598
        59 000764   012406 710000 59                 TRA     s:8598
        59 000765   012406 710000 59                 TRA     s:8598
        59 000766   012406 710000 59                 TRA     s:8598
        59 000767   012406 710000 59                 TRA     s:8598
        59 000770   012406 710000 59                 TRA     s:8598
        59 000771   012406 710000 59                 TRA     s:8598
        59 000772   012406 710000 59                 TRA     s:8598
        59 000773   012406 710000 59                 TRA     s:8598
        59 000774   012406 710000 59                 TRA     s:8598
        59 000775   012406 710000 59                 TRA     s:8598
        59 000776   012406 710000 59                 TRA     s:8598
        59 000777   012406 710000 59                 TRA     s:8598
        59 001000   012406 710000 59                 TRA     s:8598
        59 001001   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:111  
        59 001002   012406 710000 59                 TRA     s:8598
        59 001003   012406 710000 59                 TRA     s:8598
        59 001004   012406 710000 59                 TRA     s:8598
        59 001005   012406 710000 59                 TRA     s:8598
        59 001006   012406 710000 59                 TRA     s:8598
        59 001007   012406 710000 59                 TRA     s:8598
        59 001010   012406 710000 59                 TRA     s:8598
        59 001011   012406 710000 59                 TRA     s:8598
        59 001012   012406 710000 59                 TRA     s:8598
        59 001013   012406 710000 59                 TRA     s:8598
        59 001014   012406 710000 59                 TRA     s:8598
        59 001015   012406 710000 59                 TRA     s:8598
        59 001016   012406 710000 59                 TRA     s:8598
        59 001017   012406 710000 59                 TRA     s:8598
        59 001020   012406 710000 59                 TRA     s:8598
        59 001021   012406 710000 59                 TRA     s:8598
        59 001022   012406 710000 59                 TRA     s:8598
        59 001023   012406 710000 59                 TRA     s:8598
        59 001024   012406 710000 59                 TRA     s:8598
        59 001025   012406 710000 59                 TRA     s:8598
        59 001026   012406 710000 59                 TRA     s:8598
        59 001027   012406 710000 59                 TRA     s:8598
        59 001030   012406 710000 59                 TRA     s:8598
        59 001031   012406 710000 59                 TRA     s:8598
        59 001032   012406 710000 59                 TRA     s:8598
        59 001033   012406 710000 59                 TRA     s:8598
        59 001034   012406 710000 59                 TRA     s:8598
        59 001035   012406 710000 59                 TRA     s:8598
        59 001036   012406 710000 59                 TRA     s:8598
        59 001037   012406 710000 59                 TRA     s:8598
        59 001040   012406 710000 59                 TRA     s:8598
        59 001041   012406 710000 59                 TRA     s:8598
        59 001042   012406 710000 59                 TRA     s:8598
        59 001043   012406 710000 59                 TRA     s:8598
        59 001044   012406 710000 59                 TRA     s:8598
        59 001045   012406 710000 59                 TRA     s:8598
        59 001046   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:112  
        59 001047   012406 710000 59                 TRA     s:8598
        59 001050   012406 710000 59                 TRA     s:8598
        59 001051   012406 710000 59                 TRA     s:8598
        59 001052   012406 710000 59                 TRA     s:8598
        59 001053   012406 710000 59                 TRA     s:8598
        59 001054   012406 710000 59                 TRA     s:8598
        59 001055   012406 710000 59                 TRA     s:8598
        59 001056   012406 710000 59                 TRA     s:8598
        59 001057   012406 710000 59                 TRA     s:8598
        59 001060   012406 710000 59                 TRA     s:8598
        59 001061   012406 710000 59                 TRA     s:8598
        59 001062   012406 710000 59                 TRA     s:8598
        59 001063   012406 710000 59                 TRA     s:8598
        59 001064   012406 710000 59                 TRA     s:8598
        59 001065   012406 710000 59                 TRA     s:8598
        59 001066   012406 710000 59                 TRA     s:8598
        59 001067   012406 710000 59                 TRA     s:8598
        59 001070   012406 710000 59                 TRA     s:8598
        59 001071   012406 710000 59                 TRA     s:8598
        59 001072   012406 710000 59                 TRA     s:8598
        59 001073   012406 710000 59                 TRA     s:8598
        59 001074   012406 710000 59                 TRA     s:8598
        59 001075   012406 710000 59                 TRA     s:8598
        59 001076   012406 710000 59                 TRA     s:8598
        59 001077   012406 710000 59                 TRA     s:8598
        59 001100   012406 710000 59                 TRA     s:8598
        59 001101   012406 710000 59                 TRA     s:8598
        59 001102   012406 710000 59                 TRA     s:8598
        59 001103   012406 710000 59                 TRA     s:8598
        59 001104   012406 710000 59                 TRA     s:8598
        59 001105   012406 710000 59                 TRA     s:8598
        59 001106   012406 710000 59                 TRA     s:8598
        59 001107   012406 710000 59                 TRA     s:8598
        59 001110   012406 710000 59                 TRA     s:8598
        59 001111   012406 710000 59                 TRA     s:8598
        59 001112   012406 710000 59                 TRA     s:8598
        59 001113   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:113  
        59 001114   012406 710000 59                 TRA     s:8598
        59 001115   012406 710000 59                 TRA     s:8598
        59 001116   012406 710000 59                 TRA     s:8598
        59 001117   012406 710000 59                 TRA     s:8598
        59 001120   012406 710000 59                 TRA     s:8598
        59 001121   012406 710000 59                 TRA     s:8598
        59 001122   012406 710000 59                 TRA     s:8598
        59 001123   012406 710000 59                 TRA     s:8598
        59 001124   012406 710000 59                 TRA     s:8598
        59 001125   012406 710000 59                 TRA     s:8598
        59 001126   012406 710000 59                 TRA     s:8598
        59 001127   012406 710000 59                 TRA     s:8598
        59 001130   012406 710000 59                 TRA     s:8598
        59 001131   012406 710000 59                 TRA     s:8598
        59 001132   012406 710000 59                 TRA     s:8598
        59 001133   012406 710000 59                 TRA     s:8598
        59 001134   012406 710000 59                 TRA     s:8598
        59 001135   012406 710000 59                 TRA     s:8598
        59 001136   012406 710000 59                 TRA     s:8598
        59 001137   012406 710000 59                 TRA     s:8598
        59 001140   012406 710000 59                 TRA     s:8598
        59 001141   012406 710000 59                 TRA     s:8598
        59 001142   012406 710000 59                 TRA     s:8598
        59 001143   012406 710000 59                 TRA     s:8598
        59 001144   012406 710000 59                 TRA     s:8598
        59 001145   012406 710000 59                 TRA     s:8598
        59 001146   012406 710000 59                 TRA     s:8598
        59 001147   012406 710000 59                 TRA     s:8598
        59 001150   012406 710000 59                 TRA     s:8598
        59 001151   012406 710000 59                 TRA     s:8598
        59 001152   012406 710000 59                 TRA     s:8598
        59 001153   012406 710000 59                 TRA     s:8598
        59 001154   012406 710000 59                 TRA     s:8598
        59 001155   012406 710000 59                 TRA     s:8598
        59 001156   012406 710000 59                 TRA     s:8598
        59 001157   012406 710000 59                 TRA     s:8598
        59 001160   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:114  
        59 001161   012406 710000 59                 TRA     s:8598
        59 001162   012406 710000 59                 TRA     s:8598
        59 001163   012406 710000 59                 TRA     s:8598
        59 001164   012406 710000 59                 TRA     s:8598
        59 001165   012406 710000 59                 TRA     s:8598
        59 001166   012406 710000 59                 TRA     s:8598
        59 001167   012406 710000 59                 TRA     s:8598
        59 001170   012406 710000 59                 TRA     s:8598
        59 001171   012406 710000 59                 TRA     s:8598
        59 001172   012406 710000 59                 TRA     s:8598
        59 001173   012406 710000 59                 TRA     s:8598
        59 001174   012406 710000 59                 TRA     s:8598
        59 001175   012406 710000 59                 TRA     s:8598
        59 001176   012406 710000 59                 TRA     s:8598
        59 001177   012406 710000 59                 TRA     s:8598
        59 001200   012406 710000 59                 TRA     s:8598
        59 001201   012406 710000 59                 TRA     s:8598
        59 001202   012406 710000 59                 TRA     s:8598
        59 001203   012406 710000 59                 TRA     s:8598
        59 001204   012406 710000 59                 TRA     s:8598
        59 001205   012406 710000 59                 TRA     s:8598
        59 001206   012406 710000 59                 TRA     s:8598
        59 001207   012406 710000 59                 TRA     s:8598
        59 001210   012406 710000 59                 TRA     s:8598
        59 001211   012406 710000 59                 TRA     s:8598
        59 001212   012406 710000 59                 TRA     s:8598
        59 001213   012406 710000 59                 TRA     s:8598
        59 001214   012406 710000 59                 TRA     s:8598
        59 001215   012406 710000 59                 TRA     s:8598
        59 001216   012406 710000 59                 TRA     s:8598
        59 001217   012406 710000 59                 TRA     s:8598
        59 001220   012406 710000 59                 TRA     s:8598
        59 001221   012406 710000 59                 TRA     s:8598
        59 001222   012406 710000 59                 TRA     s:8598
        59 001223   012406 710000 59                 TRA     s:8598
        59 001224   012406 710000 59                 TRA     s:8598
        59 001225   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:115  
        59 001226   012406 710000 59                 TRA     s:8598
        59 001227   012406 710000 59                 TRA     s:8598
        59 001230   012406 710000 59                 TRA     s:8598
        59 001231   012406 710000 59                 TRA     s:8598
        59 001232   012406 710000 59                 TRA     s:8598
        59 001233   012406 710000 59                 TRA     s:8598
        59 001234   012406 710000 59                 TRA     s:8598
        59 001235   012406 710000 59                 TRA     s:8598
        59 001236   012406 710000 59                 TRA     s:8598
        59 001237   012406 710000 59                 TRA     s:8598
        59 001240   012406 710000 59                 TRA     s:8598
        59 001241   012406 710000 59                 TRA     s:8598
        59 001242   012406 710000 59                 TRA     s:8598
        59 001243   012406 710000 59                 TRA     s:8598
        59 001244   012406 710000 59                 TRA     s:8598
        59 001245   012406 710000 59                 TRA     s:8598
        59 001246   012406 710000 59                 TRA     s:8598
        59 001247   012406 710000 59                 TRA     s:8598
        59 001250   012406 710000 59                 TRA     s:8598
        59 001251   012406 710000 59                 TRA     s:8598
        59 001252   012406 710000 59                 TRA     s:8598
        59 001253   012406 710000 59                 TRA     s:8598
        59 001254   012406 710000 59                 TRA     s:8598
        59 001255   012406 710000 59                 TRA     s:8598
        59 001256   012406 710000 59                 TRA     s:8598
        59 001257   012406 710000 59                 TRA     s:8598
        59 001260   012406 710000 59                 TRA     s:8598
        59 001261   012406 710000 59                 TRA     s:8598
        59 001262   012406 710000 59                 TRA     s:8598
        59 001263   012406 710000 59                 TRA     s:8598
        59 001264   012406 710000 59                 TRA     s:8598
        59 001265   012406 710000 59                 TRA     s:8598
        59 001266   012406 710000 59                 TRA     s:8598
        59 001267   012406 710000 59                 TRA     s:8598
        59 001270   012406 710000 59                 TRA     s:8598
        59 001271   012406 710000 59                 TRA     s:8598
        59 001272   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:116  
        59 001273   012406 710000 59                 TRA     s:8598
        59 001274   012406 710000 59                 TRA     s:8598
        59 001275   012406 710000 59                 TRA     s:8598
        59 001276   012406 710000 59                 TRA     s:8598
        59 001277   012406 710000 59                 TRA     s:8598
        59 001300   012406 710000 59                 TRA     s:8598
        59 001301   012406 710000 59                 TRA     s:8598
        59 001302   012406 710000 59                 TRA     s:8598
        59 001303   012406 710000 59                 TRA     s:8598
        59 001304   012406 710000 59                 TRA     s:8598
        59 001305   012406 710000 59                 TRA     s:8598
        59 001306   012406 710000 59                 TRA     s:8598
        59 001307   012406 710000 59                 TRA     s:8598
        59 001310   012406 710000 59                 TRA     s:8598
        59 001311   012406 710000 59                 TRA     s:8598
        59 001312   012406 710000 59                 TRA     s:8598
        59 001313   012406 710000 59                 TRA     s:8598
        59 001314   012406 710000 59                 TRA     s:8598
        59 001315   012406 710000 59                 TRA     s:8598
        59 001316   012406 710000 59                 TRA     s:8598
        59 001317   012406 710000 59                 TRA     s:8598
        59 001320   012406 710000 59                 TRA     s:8598
        59 001321   012406 710000 59                 TRA     s:8598
        59 001322   012406 710000 59                 TRA     s:8598
        59 001323   012406 710000 59                 TRA     s:8598
        59 001324   012406 710000 59                 TRA     s:8598
        59 001325   012406 710000 59                 TRA     s:8598
        59 001326   012406 710000 59                 TRA     s:8598
        59 001327   012406 710000 59                 TRA     s:8598
        59 001330   012406 710000 59                 TRA     s:8598
        59 001331   012406 710000 59                 TRA     s:8598
        59 001332   012406 710000 59                 TRA     s:8598
        59 001333   012406 710000 59                 TRA     s:8598
        59 001334   012406 710000 59                 TRA     s:8598
        59 001335   012406 710000 59                 TRA     s:8598
        59 001336   012406 710000 59                 TRA     s:8598
        59 001337   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:117  
        59 001340   012406 710000 59                 TRA     s:8598
        59 001341   012406 710000 59                 TRA     s:8598
        59 001342   012406 710000 59                 TRA     s:8598
        59 001343   012406 710000 59                 TRA     s:8598
        59 001344   012406 710000 59                 TRA     s:8598
        59 001345   012406 710000 59                 TRA     s:8598
        59 001346   012406 710000 59                 TRA     s:8598
        59 001347   012406 710000 59                 TRA     s:8598
        59 001350   012406 710000 59                 TRA     s:8598
        59 001351   012406 710000 59                 TRA     s:8598
        59 001352   012406 710000 59                 TRA     s:8598
        59 001353   012406 710000 59                 TRA     s:8598
        59 001354   012406 710000 59                 TRA     s:8598
        59 001355   012406 710000 59                 TRA     s:8598
        59 001356   012406 710000 59                 TRA     s:8598
        59 001357   012406 710000 59                 TRA     s:8598
        59 001360   012406 710000 59                 TRA     s:8598
        59 001361   012406 710000 59                 TRA     s:8598
        59 001362   012406 710000 59                 TRA     s:8598
        59 001363   012406 710000 59                 TRA     s:8598
        59 001364   012406 710000 59                 TRA     s:8598
        59 001365   012406 710000 59                 TRA     s:8598
        59 001366   012406 710000 59                 TRA     s:8598
        59 001367   012406 710000 59                 TRA     s:8598
        59 001370   012406 710000 59                 TRA     s:8598
        59 001371   012406 710000 59                 TRA     s:8598
        59 001372   012406 710000 59                 TRA     s:8598
        59 001373   012406 710000 59                 TRA     s:8598
        59 001374   012406 710000 59                 TRA     s:8598
        59 001375   012406 710000 59                 TRA     s:8598
        59 001376   012406 710000 59                 TRA     s:8598
        59 001377   012406 710000 59                 TRA     s:8598
        59 001400   012406 710000 59                 TRA     s:8598
        59 001401   012406 710000 59                 TRA     s:8598
        59 001402   012406 710000 59                 TRA     s:8598
        59 001403   012406 710000 59                 TRA     s:8598
        59 001404   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:118  
        59 001405   012406 710000 59                 TRA     s:8598
        59 001406   012406 710000 59                 TRA     s:8598
        59 001407   012406 710000 59                 TRA     s:8598
        59 001410   012406 710000 59                 TRA     s:8598
        59 001411   012406 710000 59                 TRA     s:8598
        59 001412   012406 710000 59                 TRA     s:8598
        59 001413   012406 710000 59                 TRA     s:8598
        59 001414   012406 710000 59                 TRA     s:8598
        59 001415   012406 710000 59                 TRA     s:8598
        59 001416   012406 710000 59                 TRA     s:8598
        59 001417   012406 710000 59                 TRA     s:8598
        59 001420   012406 710000 59                 TRA     s:8598
        59 001421   012406 710000 59                 TRA     s:8598
        59 001422   012406 710000 59                 TRA     s:8598
        59 001423   012406 710000 59                 TRA     s:8598
        59 001424   012406 710000 59                 TRA     s:8598
        59 001425   012406 710000 59                 TRA     s:8598
        59 001426   012406 710000 59                 TRA     s:8598
        59 001427   012406 710000 59                 TRA     s:8598
        59 001430   012406 710000 59                 TRA     s:8598
        59 001431   012406 710000 59                 TRA     s:8598
        59 001432   012406 710000 59                 TRA     s:8598
        59 001433   012406 710000 59                 TRA     s:8598
        59 001434   012406 710000 59                 TRA     s:8598
        59 001435   012406 710000 59                 TRA     s:8598
        59 001436   012406 710000 59                 TRA     s:8598
        59 001437   012406 710000 59                 TRA     s:8598
        59 001440   012406 710000 59                 TRA     s:8598
        59 001441   012406 710000 59                 TRA     s:8598
        59 001442   012406 710000 59                 TRA     s:8598
        59 001443   012406 710000 59                 TRA     s:8598
        59 001444   012406 710000 59                 TRA     s:8598
        59 001445   012406 710000 59                 TRA     s:8598
        59 001446   012406 710000 59                 TRA     s:8598
        59 001447   012406 710000 59                 TRA     s:8598
        59 001450   012406 710000 59                 TRA     s:8598
        59 001451   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:119  
        59 001452   012406 710000 59                 TRA     s:8598
        59 001453   012406 710000 59                 TRA     s:8598
        59 001454   012406 710000 59                 TRA     s:8598
        59 001455   012406 710000 59                 TRA     s:8598
        59 001456   012406 710000 59                 TRA     s:8598
        59 001457   012406 710000 59                 TRA     s:8598
        59 001460   012406 710000 59                 TRA     s:8598
        59 001461   012406 710000 59                 TRA     s:8598
        59 001462   012406 710000 59                 TRA     s:8598
        59 001463   012406 710000 59                 TRA     s:8598
        59 001464   012406 710000 59                 TRA     s:8598
        59 001465   012406 710000 59                 TRA     s:8598
        59 001466   012406 710000 59                 TRA     s:8598
        59 001467   012406 710000 59                 TRA     s:8598
        59 001470   012406 710000 59                 TRA     s:8598
        59 001471   012406 710000 59                 TRA     s:8598
        59 001472   012406 710000 59                 TRA     s:8598
        59 001473   012406 710000 59                 TRA     s:8598
        59 001474   012406 710000 59                 TRA     s:8598
        59 001475   012406 710000 59                 TRA     s:8598
        59 001476   012406 710000 59                 TRA     s:8598
        59 001477   012406 710000 59                 TRA     s:8598
        59 001500   012406 710000 59                 TRA     s:8598
        59 001501   012406 710000 59                 TRA     s:8598
        59 001502   012406 710000 59                 TRA     s:8598
        59 001503   012406 710000 59                 TRA     s:8598
        59 001504   012406 710000 59                 TRA     s:8598
        59 001505   012406 710000 59                 TRA     s:8598
        59 001506   012406 710000 59                 TRA     s:8598
        59 001507   012406 710000 59                 TRA     s:8598
        59 001510   012406 710000 59                 TRA     s:8598
        59 001511   012406 710000 59                 TRA     s:8598
        59 001512   012406 710000 59                 TRA     s:8598
        59 001513   012406 710000 59                 TRA     s:8598
        59 001514   012406 710000 59                 TRA     s:8598
        59 001515   012406 710000 59                 TRA     s:8598
        59 001516   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:120  
        59 001517   012406 710000 59                 TRA     s:8598
        59 001520   012406 710000 59                 TRA     s:8598
        59 001521   012406 710000 59                 TRA     s:8598
        59 001522   012406 710000 59                 TRA     s:8598
        59 001523   012406 710000 59                 TRA     s:8598
        59 001524   012406 710000 59                 TRA     s:8598
        59 001525   012406 710000 59                 TRA     s:8598
        59 001526   012406 710000 59                 TRA     s:8598
        59 001527   012406 710000 59                 TRA     s:8598
        59 001530   012406 710000 59                 TRA     s:8598
        59 001531   012406 710000 59                 TRA     s:8598
        59 001532   012406 710000 59                 TRA     s:8598
        59 001533   012406 710000 59                 TRA     s:8598
        59 001534   012406 710000 59                 TRA     s:8598
        59 001535   012406 710000 59                 TRA     s:8598
        59 001536   012406 710000 59                 TRA     s:8598
        59 001537   012406 710000 59                 TRA     s:8598
        59 001540   012406 710000 59                 TRA     s:8598
        59 001541   012406 710000 59                 TRA     s:8598
        59 001542   012406 710000 59                 TRA     s:8598
        59 001543   012406 710000 59                 TRA     s:8598
        59 001544   012406 710000 59                 TRA     s:8598
        59 001545   012406 710000 59                 TRA     s:8598
        59 001546   012406 710000 59                 TRA     s:8598
        59 001547   012406 710000 59                 TRA     s:8598
        59 001550   012406 710000 59                 TRA     s:8598
        59 001551   012406 710000 59                 TRA     s:8598
        59 001552   012406 710000 59                 TRA     s:8598
        59 001553   012406 710000 59                 TRA     s:8598
        59 001554   012406 710000 59                 TRA     s:8598
        59 001555   012406 710000 59                 TRA     s:8598
        59 001556   012406 710000 59                 TRA     s:8598
        59 001557   012406 710000 59                 TRA     s:8598
        59 001560   012406 710000 59                 TRA     s:8598
        59 001561   012406 710000 59                 TRA     s:8598
        59 001562   012406 710000 59                 TRA     s:8598
        59 001563   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:121  
        59 001564   012406 710000 59                 TRA     s:8598
        59 001565   012406 710000 59                 TRA     s:8598
        59 001566   012406 710000 59                 TRA     s:8598
        59 001567   012406 710000 59                 TRA     s:8598
        59 001570   012406 710000 59                 TRA     s:8598
        59 001571   012406 710000 59                 TRA     s:8598
        59 001572   012406 710000 59                 TRA     s:8598
        59 001573   012406 710000 59                 TRA     s:8598
        59 001574   012406 710000 59                 TRA     s:8598
        59 001575   012406 710000 59                 TRA     s:8598
        59 001576   012406 710000 59                 TRA     s:8598
        59 001577   012406 710000 59                 TRA     s:8598
        59 001600   012406 710000 59                 TRA     s:8598
        59 001601   012406 710000 59                 TRA     s:8598
        59 001602   012406 710000 59                 TRA     s:8598
        59 001603   012406 710000 59                 TRA     s:8598
        59 001604   012406 710000 59                 TRA     s:8598
        59 001605   012406 710000 59                 TRA     s:8598
        59 001606   012406 710000 59                 TRA     s:8598
        59 001607   012406 710000 59                 TRA     s:8598
        59 001610   012406 710000 59                 TRA     s:8598
        59 001611   012406 710000 59                 TRA     s:8598
        59 001612   012406 710000 59                 TRA     s:8598
        59 001613   012406 710000 59                 TRA     s:8598
        59 001614   012406 710000 59                 TRA     s:8598
        59 001615   012406 710000 59                 TRA     s:8598
        59 001616   012406 710000 59                 TRA     s:8598
        59 001617   012406 710000 59                 TRA     s:8598
        59 001620   012406 710000 59                 TRA     s:8598
        59 001621   012406 710000 59                 TRA     s:8598
        59 001622   012406 710000 59                 TRA     s:8598
        59 001623   012406 710000 59                 TRA     s:8598
        59 001624   012406 710000 59                 TRA     s:8598
        59 001625   012406 710000 59                 TRA     s:8598
        59 001626   012406 710000 59                 TRA     s:8598
        59 001627   012406 710000 59                 TRA     s:8598
        59 001630   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:122  
        59 001631   012406 710000 59                 TRA     s:8598
        59 001632   012406 710000 59                 TRA     s:8598
        59 001633   012406 710000 59                 TRA     s:8598
        59 001634   012406 710000 59                 TRA     s:8598
        59 001635   012406 710000 59                 TRA     s:8598
        59 001636   012406 710000 59                 TRA     s:8598
        59 001637   012406 710000 59                 TRA     s:8598
        59 001640   012406 710000 59                 TRA     s:8598
        59 001641   012406 710000 59                 TRA     s:8598
        59 001642   012406 710000 59                 TRA     s:8598
        59 001643   012406 710000 59                 TRA     s:8598
        59 001644   012406 710000 59                 TRA     s:8598
        59 001645   012406 710000 59                 TRA     s:8598
        59 001646   012406 710000 59                 TRA     s:8598
        59 001647   012406 710000 59                 TRA     s:8598
        59 001650   012406 710000 59                 TRA     s:8598
        59 001651   012406 710000 59                 TRA     s:8598
        59 001652   012406 710000 59                 TRA     s:8598
        59 001653   012406 710000 59                 TRA     s:8598
        59 001654   012406 710000 59                 TRA     s:8598
        59 001655   012406 710000 59                 TRA     s:8598
        59 001656   012406 710000 59                 TRA     s:8598
        59 001657   012406 710000 59                 TRA     s:8598
        59 001660   012406 710000 59                 TRA     s:8598
        59 001661   012406 710000 59                 TRA     s:8598
        59 001662   012406 710000 59                 TRA     s:8598
        59 001663   012406 710000 59                 TRA     s:8598
        59 001664   012406 710000 59                 TRA     s:8598
        59 001665   012406 710000 59                 TRA     s:8598
        59 001666   012406 710000 59                 TRA     s:8598
        59 001667   012406 710000 59                 TRA     s:8598
        59 001670   012406 710000 59                 TRA     s:8598
        59 001671   012406 710000 59                 TRA     s:8598
        59 001672   012406 710000 59                 TRA     s:8598
        59 001673   012406 710000 59                 TRA     s:8598
        59 001674   012406 710000 59                 TRA     s:8598
        59 001675   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:123  
        59 001676   012406 710000 59                 TRA     s:8598
        59 001677   012406 710000 59                 TRA     s:8598
        59 001700   012406 710000 59                 TRA     s:8598
        59 001701   012406 710000 59                 TRA     s:8598
        59 001702   012406 710000 59                 TRA     s:8598
        59 001703   012406 710000 59                 TRA     s:8598
        59 001704   012406 710000 59                 TRA     s:8598
        59 001705   012406 710000 59                 TRA     s:8598
        59 001706   012406 710000 59                 TRA     s:8598
        59 001707   012406 710000 59                 TRA     s:8598
        59 001710   012406 710000 59                 TRA     s:8598
        59 001711   012406 710000 59                 TRA     s:8598
        59 001712   012406 710000 59                 TRA     s:8598
        59 001713   002524 710000 59                 TRA     s:7053
        59 001714   002551 710000 59                 TRA     s:7059
        59 001715   012406 710000 59                 TRA     s:8598
        59 001716   003171 710000 59                 TRA     s:7165
        59 001717   003214 710000 59                 TRA     s:7179
        59 001720   002613 710000 59                 TRA     CLC
        59 001721   004752 710000 59                 TRA     s:7503
        59 001722   004711 710000 59                 TRA     s:7487
        59 001723   004605 710000 59                 TRA     AKC
        59 001724   007534 710000 59                 TRA     s:8098
        59 001725   007575 710000 59                 TRA     s:8110
        59 001726   007334 710000 59                 TRA     DUP
        59 001727   010453 710000 59                 TRA     s:8264
        59 001730   010514 710000 59                 TRA     s:8276
        59 001731   010234 710000 59                 TRA     SKC
        59 001732   011106 710000 59                 TRA     s:8373
        59 001733   011032 710000 59                 TRA     s:8357
        59 001734   012406 710000 59                 TRA     s:8598
        59 001735   011266 710000 59                 TRA     s:8406
        59 001736   011176 710000 59                 TRA     s:8389
        59 001737   011313 710000 59                 TRA     s:8412
        59 001740   011547 710000 59                 TRA     s:8459
        59 001741   011514 710000 59                 TRA     s:8451
        59 001742   012406 710000 59                 TRA     s:8598
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:124  
        59 001743   011627 710000 59                 TRA     s:8474
        59 001744   011574 710000 59                 TRA     s:8466

      383     6878        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:125  
      384     6879    4               CASE(%SCHEMA_DDL);

      385     6880    4               CASE(%SCH_NM); /* SCHEMA NAME IS schemaname */

      386     6881        /*-save pointer to beginning of dynamic mem used for pass2
      387     6882          -make sure this is the only schema def
      388     6883          -ensure schema name same as in DBACS command
      389     6884          -store SN and OA
      390     6885          -store *dbparam and *system records      */
      391     6886         /* want to save ptr to beginning of dyn mem so get a word here */
      392     6887    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM_START$);

   6887 59 001745   000003 630400 60                 EPPR0   3
        59 001746   000001 631400 60                 EPPR1   1
        59 001747   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 001750   000000 011000                    NOP     0

      393     6888    4                   IF LAST_STATUS > %SCH_DEF THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%
              6888                            ERR_SEV,%ORDER_SCHEMA_DDL);

   6888 59 001751   000000 236000 12                 LDQ     LAST_STATUS
        59 001752   770000 316003                    CANQ    -4096,DU
        59 001753   001767 600000 59                 TZE     s:6893

   6888 59 001754   000000 235000 7                  LDA     LINE_COUNT
        59 001755   000002 135007                    SBLA    2,DL
        59 001756   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 001757   000010 237000 60                 LDAQ    8
        59 001760   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 001761   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 001762   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 001763   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 001764   000005 631400 60                 EPPR1   5
        59 001765   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 001766   000000 011000                    NOP     0

      394     6889         /*E* ERROR: ZIG-%ORDER_SCHEMA_DDL-C
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:126  
      395     6890                    MESSAGE: The SCHEMA DDL is either not in the correct
      396     6891                             order or a section is missing.
      397     6892               */
      398     6893    4                   LAST_STATUS = %SCH_DEF;

   6893 59 001767   000000 450000 12                 STZ     LAST_STATUS

      399     6894    4                   CALL GET_WORD;

   6894 59 001770   012467 701000 59                 TSX1    GET_WORD
        59 001771   000000 011000                    NOP     0

      400     6895    4                   CALL CHECK_RESW_DUPS;

   6895 59 001772   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 001773   000000 011000                    NOP     0

      401     6896    4                   IF STRAN.SNAME ~= WORD1 THEN

   6896 59 001774   040000 106400                    CMPC    fill='040'O
        59 001775   000001 000036 25                 ADSC9   STRAN+1                  cn=0,n=30
        59 001776   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 001777   002013 600000 59                 TZE     s:6902

      402     6897    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4009);
              6897                                /* given schname ~= that in directive */

   6897 59 002000   000000 235000 7                  LDA     LINE_COUNT
        59 002001   000002 135007                    SBLA    2,DL
        59 002002   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002003   000014 237000 60                 LDAQ    12
        59 002004   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002005   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002006   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002007   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002010   000005 631400 60                 EPPR1   5
        59 002011   000000 701000 xent               TSX1    ZIG$D_DIAG
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:127  
        59 002012   000000 011000                    NOP     0

      403     6898         /*E* ERROR: ZIG-4009-C
      404     6899                      MESSAGE: The schema name in the directive and in the
      405     6900                               schema DDL are not the same.
      406     6901                   */
      407     6902    4                   UWA.SN = '0'B;

   6902 59 002013   000000 100400                    MLR     fill='000'O
        59 002014   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002015   000422 000062 57                 ADSC9   UWA+274                  cn=0,n=50

      408     6903    4                   UWA.SN.DCLR = 1;

   6903 59 002016   000001 235007                    LDA     1,DL
        59 002017   000422 755000 57                 STA     UWA+274

      409     6904    4                   UWA.SN.SETYPE = %ZIG_RTYPE_OA;

   6904 59 002020   000012 236007                    LDQ     10,DL
        59 002021   000424 756000 57                 STQ     UWA+276

      410     6905    4                   UWA.SN.LNO = LNO;

   6905 59 002022   200060 235100                    LDA     LNO,,AUTO
        59 002023   000425 755000 57                 STA     UWA+277

      411     6906    4                   UWA.SN.SENAME = WORD1;

   6906 59 002024   040000 100400                    MLR     fill='040'O
        59 002025   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 002026   000427 000036 57                 ADSC9   UWA+279                  cn=0,n=30

      412     6907    4                   CALL STRE_6('SN      ');

   6907 59 002027   000016 630400 60                 EPPR0   14
        59 002030   000013 631400 60                 EPPR1   11
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:128  
        59 002031   000000 701000 xent               TSX1    STRE_6
        59 002032   000000 011000                    NOP     0

      413     6908    4                   LAST_LOCKABLE_DBK = UWA.DIRECT_REF;

   6908 59 002033   000036 235000 57                 LDA     UWA+30
        59 002034   000044 755000 0                  STA     LAST_LOCKABLE_DBK

      414     6909    4                   UWA.DA.NUMB_SN = 1; /* hereafter, ADD_SN will be used to add SNs */

   6909 59 002035   000001 236007                    LDQ     1,DL
        59 002036   000406 756000 57                 STQ     UWA+262

      415     6910    4                   UWA.OA = '0'B;

   6910 59 002037   000000 100400                    MLR     fill='000'O
        59 002040   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002041   000214 000064 57                 ADSC9   UWA+140                  cn=0,n=52

      416     6911    4                   UWA.OA.FILE_CODE = '1*';

   6911 59 002042   000002 220000 58                 LDX0    2
        59 002043   000227 740000 57                 STX0    UWA+151

      417     6912    4                   CALL STRE_6('OA      ');

   6912 59 002044   000017 630400 60                 EPPR0   15
        59 002045   000013 631400 60                 EPPR1   11
        59 002046   000000 701000 xent               TSX1    STRE_6
        59 002047   000000 011000                    NOP     0

      418     6913    4                   UWA.SF.DBKEY_OA = UWA.DIRECT_REF;

   6913 59 002050   000036 235000 57                 LDA     UWA+30
        59 002051   000063 755000 57                 STA     UWA+51

      419     6914    4                   WORD1 = '*DBPARAM';
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:129  

   6914 59 002052   040000 100400                    MLR     fill='040'O
        59 002053   000005 000010 58                 ADSC9   5                        cn=0,n=8
        59 002054   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

      420     6915    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);

   6915 59 002055   000022 630400 60                 EPPR0   18
        59 002056   000020 631400 60                 EPPR1   16
        59 002057   000000 701000 xent               TSX1    ADD_SN
        59 002060   000000 011000                    NOP     0

      421     6916    4                   UWA.DA.FRST_RC = UWA.DIRECT_REF;

   6916 59 002061   000036 235000 57                 LDA     UWA+30
        59 002062   000416 755000 57                 STA     UWA+270

      422     6917    4                   UWA.RC = '0'B;

   6917 59 002063   000000 100400                    MLR     fill='000'O
        59 002064   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002065   000270 000100 57                 ADSC9   UWA+184                  cn=0,n=64

      423     6918    4                   UWA.RC.RTYPE = 4001;

   6918 59 002066   007641 236007                    LDQ     4001,DL
        59 002067   000270 756000 57                 STQ     UWA+184

      424     6919    4                   CALL STRE_6('RC      ');

   6919 59 002070   000032 630400 60                 EPPR0   26
        59 002071   000013 631400 60                 EPPR1   11
        59 002072   000000 701000 xent               TSX1    STRE_6
        59 002073   000000 011000                    NOP     0

      425     6920    4                   DBK_STAR_DBPARAM_RC = UWA.DIRECT_REF;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:130  
   6920 59 002074   000036 235000 57                 LDA     UWA+30
        59 002075   000000 755000 52                 STA     DBK_STAR_DBPARAM_RC

      426     6921    4                   WORD1 = '*SYSTEM';

   6921 59 002076   040000 100400                    MLR     fill='040'O
        59 002077   000011 000007 58                 ADSC9   9                        cn=0,n=7
        59 002100   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

      427     6922    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);

   6922 59 002101   000022 630400 60                 EPPR0   18
        59 002102   000020 631400 60                 EPPR1   16
        59 002103   000000 701000 xent               TSX1    ADD_SN
        59 002104   000000 011000                    NOP     0

      428     6923    4                   UWA.RC.RTYPE = 4002;

   6923 59 002105   007642 235007                    LDA     4002,DL
        59 002106   000270 755000 57                 STA     UWA+184

      429     6924    4                   CALL STRE_6('RC      ');

   6924 59 002107   000032 630400 60                 EPPR0   26
        59 002110   000013 631400 60                 EPPR1   11
        59 002111   000000 701000 xent               TSX1    STRE_6
        59 002112   000000 011000                    NOP     0

      430     6925    4                   DBK_STAR_SYSTEM_RC = UWA.DIRECT_REF;

   6925 59 002113   000036 235000 57                 LDA     UWA+30
        59 002114   000000 755000 5                  STA     DBK_STAR_SYSTEM_RC

      431     6926    4                   UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 2;

   6926 59 002115   000002 236007                    LDQ     2,DL
        59 002116   000215 056000 57                 ASQ     UWA+141
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:131  
        59 002117   012440 710000 59                 TRA     s:8607

      432     6927        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:132  
      433     6928        /********************************************************************
      434     6929                 schema privacy locks
      435     6930        ********************************************************************/
      436     6931    4               CASE(%LKS);

      437     6932    5                   IF OA_LKS.XLOCKS THEN DO;

   6932 59 002120   000042 234000 0                  SZN     OA_LKS
        59 002121   002136 605000 59                 TPL     s:6939

      438     6933    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   6933 59 002122   000000 235000 7                  LDA     LINE_COUNT
        59 002123   000002 135007                    SBLA    2,DL
        59 002124   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002125   000034 237000 60                 LDAQ    28
        59 002126   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002127   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 002130   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 002131   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002132   000005 631400 60                 EPPR1   5
        59 002133   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002134   000000 011000                    NOP     0

      439     6934         /*E* ERROR: ZIG-4015-C
      440     6935                 MESSAGE: A lock has already been invoked for that function
      441     6936                          in this clause.
      442     6937              */
      443     6938    5                       END;

   6938 59 002135   012440 710000 59                 TRA     s:8607

      444     6939    4                   ELSE OA_LKS.XLOCKS = '1'B;

   6939 59 002136   400000 236003                    LDQ     -131072,DU
        59 002137   000042 256000 0                  ORSQ    OA_LKS
        59 002140   012440 710000 59                 TRA     s:8607
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:133  

      445     6940    4               CASE(%DISPLAY);

      446     6941    5                   IF OA_LKS.DISPLAY THEN DO;

   6941 59 002141   000042 236000 0                  LDQ     OA_LKS
        59 002142   200000 316003                    CANQ    65536,DU
        59 002143   002160 600000 59                 TZE     s:6944

      447     6942    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   6942 59 002144   000000 235000 7                  LDA     LINE_COUNT
        59 002145   000002 135007                    SBLA    2,DL
        59 002146   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002147   000034 237000 60                 LDAQ    28
        59 002150   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002151   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 002152   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 002153   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002154   000005 631400 60                 EPPR1   5
        59 002155   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002156   000000 011000                    NOP     0

      448     6943    5                       END;

   6943 59 002157   012440 710000 59                 TRA     s:8607

      449     6944    4                   ELSE OA_LKS.DISPLAY = '1'B;

   6944 59 002160   200000 236003                    LDQ     65536,DU
        59 002161   000042 256000 0                  ORSQ    OA_LKS
        59 002162   012440 710000 59                 TRA     s:8607

      450     6945    4               CASE(%COPY);

      451     6946    5                   IF OA_LKS.COPY THEN DO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:134  
   6946 59 002163   000042 236000 0                  LDQ     OA_LKS
        59 002164   100000 316003                    CANQ    32768,DU
        59 002165   002202 600000 59                 TZE     s:6949

      452     6947    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   6947 59 002166   000000 235000 7                  LDA     LINE_COUNT
        59 002167   000002 135007                    SBLA    2,DL
        59 002170   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002171   000034 237000 60                 LDAQ    28
        59 002172   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002173   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 002174   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 002175   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002176   000005 631400 60                 EPPR1   5
        59 002177   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002200   000000 011000                    NOP     0

      453     6948    5                       END;

   6948 59 002201   012440 710000 59                 TRA     s:8607

      454     6949    4                   ELSE OA_LKS.COPY = '1'B;

   6949 59 002202   100000 236003                    LDQ     32768,DU
        59 002203   000042 256000 0                  ORSQ    OA_LKS
        59 002204   012440 710000 59                 TRA     s:8607

      455     6950    4               CASE(%ALTER);

      456     6951    5                   IF OA_LKS.ALTER THEN DO;

   6951 59 002205   000042 236000 0                  LDQ     OA_LKS
        59 002206   040000 316003                    CANQ    16384,DU
        59 002207   002224 600000 59                 TZE     s:6954

      457     6952    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:135  

   6952 59 002210   000000 235000 7                  LDA     LINE_COUNT
        59 002211   000002 135007                    SBLA    2,DL
        59 002212   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002213   000034 237000 60                 LDAQ    28
        59 002214   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002215   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 002216   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 002217   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002220   000005 631400 60                 EPPR1   5
        59 002221   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002222   000000 011000                    NOP     0

      458     6953    5                       END;

   6953 59 002223   012440 710000 59                 TRA     s:8607

      459     6954    4                   ELSE OA_LKS.ALTER = '1'B;

   6954 59 002224   040000 236003                    LDQ     16384,DU
        59 002225   000042 256000 0                  ORSQ    OA_LKS
        59 002226   012440 710000 59                 TRA     s:8607

      460     6955    4               CASE(%MPRIV);

      461     6956    4                   OA_LKS = '0'B;

   6956 59 002227   000042 450000 0                  STZ     OA_LKS
        59 002230   012440 710000 59                 TRA     s:8607

      462     6957    4               CASE(%SCH_LCK_NM);

      463     6958    4                   IF LAST_STATUS ~= %SCH_DEF THEN

   6958 59 002231   000000 236000 12                 LDQ     LAST_STATUS
        59 002232   770000 316003                    CANQ    -4096,DU
        59 002233   002250 600000 59                 TZE     s:6961
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:136  

      464     6959    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);

   6959 59 002234   000000 235000 7                  LDA     LINE_COUNT
        59 002235   000002 135007                    SBLA    2,DL
        59 002236   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002237   000010 237000 60                 LDAQ    8
        59 002240   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002241   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 002242   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 002243   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002244   000005 631400 60                 EPPR1   5
        59 002245   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002246   000000 011000                    NOP     0
        59 002247   012440 710000 59                 TRA     s:8607

      465     6960    5                   ELSE DO;

      466     6961    5                       CALL GET_WORD;

   6961 59 002250   012467 701000 59                 TSX1    GET_WORD
        59 002251   000000 011000                    NOP     0

      467     6962    5                       CALL CHECK_RESW_DUPS;

   6962 59 002252   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 002253   000000 011000                    NOP     0

      468     6963    5                       IF OA_LKS = '0'B THEN

   6963 59 002254   000042 236000 0                  LDQ     OA_LKS
        59 002255   740000 316003                    CANQ    -16384,DU
        59 002256   002261 601000 59                 TNZ     s:6965

      469     6964    5                           OA_LKS = '1111'B;

   6964 59 002257   740000 236003                    LDQ     -16384,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:137  
        59 002260   000042 756000 0                  STQ     OA_LKS

      470     6965    5                       CALL ADD_LOCK(WORD1,%SCHEMA_LOCK);

   6965 59 002261   000037 236000 60                 LDQ     31
        59 002262   200064 756100                    STQ     @LKNAME+1,,AUTO
        59 002263   000023 236000 60                 LDQ     19
        59 002264   200063 756100                    STQ     LNO+3,,AUTO
        59 002265   013360 701000 59                 TSX1    ADD_LOCK
        59 002266   000000 011000                    NOP     0

      471     6966    5                       END;

   6966 59 002267   012440 710000 59                 TRA     s:8607

      472     6967        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:138  
      473     6968        /********************************************************************
      474     6969                 area entry
      475     6970        ********************************************************************/
      476     6971    4               CASE(%OTHER_DDL);

      477     6972    4               CASE(%AC_ENT);

      478     6973    4               CASE(%AC_NM); /* AREA NAME IS areaname */

      479     6974        /* -clean up a previous record entry
      480     6975           -store SN of area (AC will be stored after entire area entry parsed
      481     6976            and period hit) */
      482     6977    4                   IF REC_ENTRY_DONE THEN

   6977 59 002270   000100 234000 0                  SZN     REC_ENTRY_DONE
        59 002271   002274 605000 59                 TPL     s:6979

      483     6978    4                       CALL CLEAN_UP_REC;

   6978 59 002272   012607 701000 59                 TSX1    CLEAN_UP_REC
        59 002273   000000 011000                    NOP     0

      484     6979    4                   LAST_STATUS = %AC_DEF;

   6979 59 002274   010000 236003                    LDQ     4096,DU
        59 002275   000000 756000 12                 STQ     LAST_STATUS

      485     6980    4                   CALL GET_WORD;

   6980 59 002276   012467 701000 59                 TSX1    GET_WORD
        59 002277   000000 011000                    NOP     0

      486     6981    4                   CALL CHECK_RESW_DUPS;

   6981 59 002300   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 002301   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:139  
      487     6982    4                   CALL ADD_SN(%ZIG_RTYPE_AC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);

   6982 59 002302   000024 237000 60                 LDAQ    20
        59 002303   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 002304   000026 237000 60                 LDAQ    22
        59 002305   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 002306   200060 630500                    EPPR0   LNO,,AUTO
        59 002307   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 002310   000003 236000 60                 LDQ     3
        59 002311   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 002312   000042 237000 60                 LDAQ    34
        59 002313   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 002314   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002315   000020 631400 60                 EPPR1   16
        59 002316   000000 701000 xent               TSX1    ADD_SN
        59 002317   000000 011000                    NOP     0

      488     6983    4                   IF FOUND = %FOUNDDEF THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              6983                            4021);

   6983 59 002320   000133 235000 0                  LDA     FOUND
        59 002321   000002 115007                    CMPA    2,DL
        59 002322   002336 601000 59                 TNZ     s:6988

   6983 59 002323   000000 236000 7                  LDQ     LINE_COUNT
        59 002324   000002 136007                    SBLQ    2,DL
        59 002325   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 002326   000044 237000 60                 LDAQ    36
        59 002327   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002330   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002331   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002332   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002333   000005 631400 60                 EPPR1   5
        59 002334   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002335   000000 011000                    NOP     0

      489     6984         /*E* ERROR: ZIG-4021-C
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:140  
      490     6985                      MESSAGE: The name "%U1" has already been assigned to
      491     6986                               an area.
      492     6987                   */
      493     6988    4                   UWA.AC = '0'B;

   6988 59 002336   000000 100400                    MLR     fill='000'O
        59 002337   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002340   000232 000164 57                 ADSC9   UWA+154                  cn=0,n=116
        59 002341   012440 710000 59                 TRA     s:8607

      494     6989    4               CASE(%TEMP_CL); /* AREA IS TEMPORARY */

      495     6990    4                   UWA.AC.PERMTYPE = 1;

   6990 59 002342   000001 235007                    LDA     1,DL
        59 002343   000236 755000 57                 STA     UWA+158
        59 002344   012440 710000 59                 TRA     s:8607

      496     6991        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:141  
      497     6992        /********************************************************************
      498     6993                 record entry
      499     6994        ********************************************************************/
      500     6995    4               CASE(%REC_ENT);

      501     6996    4               CASE(%REC_NM); /* RECORD NAME IS recordname */

      502     6997        /* -clean up a previous record entry
      503     6998           -increase schema size if necessary
      504     6999           -initialize record flags and relevant DBKs and clause flags
      505     7000           -store SN and RC of record  */
      506     7001    4                   IF REC_ENTRY_DONE THEN

   7001 59 002345   000100 234000 0                  SZN     REC_ENTRY_DONE
        59 002346   002351 605000 59                 TPL     s:7003

      507     7002    4                       CALL CLEAN_UP_REC;

   7002 59 002347   012607 701000 59                 TSX1    CLEAN_UP_REC
        59 002350   000000 011000                    NOP     0

      508     7003    4                   IF NEED_LARGER_SCHEMA

   7003 59 002351   000000 234000 14                 SZN     NEED_LARGER_SCHEMA
        59 002352   002376 605000 59                 TPL     s:7010

      509     7004    5                   THEN DO;

      510     7005    5                       CALL SF_CLOSE(1,STATUS);

   7005 59 002353   200053 630500                    EPPR0   STATUS,,AUTO
        59 002354   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002355   000003 236000 60                 LDQ     3
        59 002356   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 002357   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002360   000001 631400 60                 EPPR1   1
        59 002361   000000 701000 xent               TSX1    SF_CLOSE
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:142  
        59 002362   000000 011000                    NOP     0

      511     7006    5                       CALL SF_OPEN(1,STATUS);

   7006 59 002363   200053 630500                    EPPR0   STATUS,,AUTO
        59 002364   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002365   000003 236000 60                 LDQ     3
        59 002366   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 002367   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002370   000001 631400 60                 EPPR1   1
        59 002371   000000 701000 xent               TSX1    SF_OPEN
        59 002372   000000 011000                    NOP     0

      512     7007    5                       NEED_LARGER_SCHEMA = '0'B;

   7007 59 002373   000000 450000 14                 STZ     NEED_LARGER_SCHEMA

      513     7008    5                       CALL RESTORE_CURRENTS;

   7008 59 002374   013326 701000 59                 TSX1    RESTORE_CURRENTS
        59 002375   000000 011000                    NOP     0

      514     7009    5                       END;

      515     7010    4                   REC_ENTRY_DONE = '1'B;

   7010 59 002376   400000 236003                    LDQ     -131072,DU
        59 002377   000100 756000 0                  STQ     REC_ENTRY_DONE

      516     7011    4                   NUM_AREAS_WITHIN = 0;

   7011 59 002400   000114 450000 0                  STZ     NUM_AREAS_WITHIN

      517     7012    4                   FIRST_SFR_DBK = 0;

   7012 59 002401   000075 450000 0                  STZ     FIRST_SFR_DBK

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:143  
      518     7013    4                   DBK_SM_CALC = 0;

   7013 59 002402   000076 450000 0                  STZ     DBK_SM_CALC

      519     7014    4                   DBK_SS_CALC = 0;

   7014 59 002403   000077 450000 0                  STZ     DBK_SS_CALC

      520     7015    4                   INDX_KEY_NM = ' ';

   7015 59 002404   040000 100400                    MLR     fill='040'O
        59 002405   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 002406   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30

      521     7016    4                   LEV_NUM = 0;

   7016 59 002407   000125 450000 0                  STZ     LEV_NUM

      522     7017    4                   LOCATION = '0'B;

   7017 59 002410   000030 450000 0                  STZ     LOCATION

      523     7018    4                   WITHIN = '0'B;

   7018 59 002411   000031 450000 0                  STZ     WITHIN

      524     7019    4                   LAST_STATUS = %RC_DEF;

   7019 59 002412   040000 236003                    LDQ     16384,DU
        59 002413   000000 756000 12                 STQ     LAST_STATUS

      525     7020    4                   CALL GET_WORD;

   7020 59 002414   012467 701000 59                 TSX1    GET_WORD
        59 002415   000000 011000                    NOP     0

      526     7021    4                   CALL CHECK_RESW_DUPS;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:144  

   7021 59 002416   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 002417   000000 011000                    NOP     0

      527     7022    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);

   7022 59 002420   000024 237000 60                 LDAQ    20
        59 002421   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 002422   000026 237000 60                 LDAQ    22
        59 002423   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 002424   200060 630500                    EPPR0   LNO,,AUTO
        59 002425   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 002426   000003 236000 60                 LDQ     3
        59 002427   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 002430   000022 237000 60                 LDAQ    18
        59 002431   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 002432   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002433   000020 631400 60                 EPPR1   16
        59 002434   000000 701000 xent               TSX1    ADD_SN
        59 002435   000000 011000                    NOP     0

      528     7023    4                   LAST_LOCKABLE_DBK = UWA.DIRECT_REF;

   7023 59 002436   000036 235000 57                 LDA     UWA+30
        59 002437   000044 755000 0                  STA     LAST_LOCKABLE_DBK

      529     7024    4                   LAST_RC_SN = UWA.DIRECT_REF;

   7024 59 002440   000047 755000 0                  STA     LAST_RC_SN

      530     7025    4                   LAST_RC_NAME = WORD1;

   7025 59 002441   040000 100400                    MLR     fill='040'O
        59 002442   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 002443   000050 000036 0                  ADSC9   LAST_RC_NAME             cn=0,n=30

      531     7026    4                   IF FOUND = %FOUNDDEF THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:145  
              7026                            4025);

   7026 59 002444   000133 236000 0                  LDQ     FOUND
        59 002445   000002 116007                    CMPQ    2,DL
        59 002446   002462 601000 59                 TNZ     s:7030

   7026 59 002447   000000 235000 7                  LDA     LINE_COUNT
        59 002450   000002 135007                    SBLA    2,DL
        59 002451   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002452   000050 237000 60                 LDAQ    40
        59 002453   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002454   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002455   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002456   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002457   000005 631400 60                 EPPR1   5
        59 002460   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002461   000000 011000                    NOP     0

      532     7027         /*E*  ERROR: ZIG-4025-C
      533     7028                 MESSAGE: The name "%U1" has already been assigned to a record.
      534     7029             */
      535     7030    4                   RC = '0'B;

   7030 59 002462   000000 100400                    MLR     fill='000'O
        59 002463   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002464   000000 000100 0                  ADSC9   RC                       cn=0,n=64

      536     7031    4                   RC.PSMODE = 9;

   7031 59 002465   000011 235007                    LDA     9,DL
        59 002466   000001 755000 0                  STA     RC+1

      537     7032    4                   RC.WITHINA = 9;

   7032 59 002467   000003 755000 0                  STA     RC+3

      538     7033    4                   RC.ANY_IND = 0;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:146  

   7033 59 002470   000010 450000 0                  STZ     RC+8

      539     7034    4                   CALL STRE_6('RC      ');

   7034 59 002471   000032 630400 60                 EPPR0   26
        59 002472   000013 631400 60                 EPPR1   11
        59 002473   000000 701000 xent               TSX1    STRE_6
        59 002474   000000 011000                    NOP     0

      540     7035    4                   UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 1;

   7035 59 002475   000215 054000 57                 AOS     UWA+141

      541     7036    4                   LAST_RC_DBK = UWA.DIRECT_REF; /* keep track in order to determine

   7036 59 002476   000036 235000 57                 LDA     UWA+30
        59 002477   000000 755000 4                  STA     LAST_RC_DBK
        59 002500   012440 710000 59                 TRA     s:8607

      542     7037         if duplicate fields exist within
      543     7038         a record */
      544     7039    4               CASE(%RPRIV);

      545     7040    4                   RC_LKS = '0'B;

   7040 59 002501   000043 450000 0                  STZ     RC_LKS
        59 002502   012440 710000 59                 TRA     s:8607

      546     7041    4               CASE(%LOC_CL);

      547     7042    5                   IF LOCATION THEN DO;

   7042 59 002503   000030 234000 0                  SZN     LOCATION
        59 002504   002521 605000 59                 TPL     s:7049

      548     7043    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:147  

   7043 59 002505   000000 235000 7                  LDA     LINE_COUNT
        59 002506   000002 135007                    SBLA    2,DL
        59 002507   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 002510   000054 237000 60                 LDAQ    44
        59 002511   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 002512   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 002513   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 002514   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 002515   000005 631400 60                 EPPR1   5
        59 002516   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 002517   000000 011000                    NOP     0

      549     7044         /*E* ERROR: ZIG-4026-C
      550     7045                 MESSAGE: The %U1 clause has already been specified for this
      551     7046                          subentry.
      552     7047              */
      553     7048    5                       END;

   7048 59 002520   012440 710000 59                 TRA     s:8607

      554     7049    4                   ELSE LOCATION = '1'B;

   7049 59 002521   400000 236003                    LDQ     -131072,DU
        59 002522   000030 756000 0                  STQ     LOCATION
        59 002523   012440 710000 59                 TRA     s:8607

      555     7050    4               CASE(%DIR_FR); /* LOCATION MODE IS DIRECT dbparam/dbid */

      556     7051        /* -handled in pas2 */
      557     7052    4               CASE(%DIR_QRC);

      558     7053    4                   CALL GET_WORD;

   7053 59 002524   012467 701000 59                 TSX1    GET_WORD
        59 002525   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:148  
      559     7054    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);

   7054 59 002526   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 002527   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002530   000056 236000 60                 LDQ     46
        59 002531   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 002532   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002533   000001 631400 60                 EPPR1   1
        59 002534   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 002535   000000 011000                    NOP     0

      560     7055    4                   DYNMEM$->WRD1 = %QUAL;

   7055 59 002536   000113 235007                    LDA     75,DL
        59 002537   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 002540   000000 755100                    STA     0,,PR0

      561     7056    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7056 59 002541   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 002542   000001 036003                    ADLQ    1,DU
        59 002543   200056 756100                    STQ     DYNMEM$,,AUTO

      562     7057    4                   DYNMEM$->CHAR30 = WORD1;

   7057 59 002544   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 002545   040100 100400                    MLR     fill='040'O
        59 002546   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 002547   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 002550   012440 710000 59                 TRA     s:8607

      563     7058    4               CASE(%DIR_QFR);

      564     7059    4                   RC.PSMODE = 0; /* direct */

   7059 59 002551   000001 450000 0                  STZ     RC+1

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:149  
      565     7060    4                   CALL GET_WORD;

   7060 59 002552   012467 701000 59                 TSX1    GET_WORD
        59 002553   000000 011000                    NOP     0

      566     7061    4                   CALL ZIG$G_DYN_MEM_6(11,DYNMEM$);

   7061 59 002554   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 002555   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 002556   000060 236000 60                 LDQ     48
        59 002557   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 002560   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 002561   000001 631400 60                 EPPR1   1
        59 002562   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 002563   000000 011000                    NOP     0

      567     7062    4                   DYNMEM$->WRD1 = %DIRECT;

   7062 59 002564   000106 235007                    LDA     70,DL
        59 002565   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 002566   000000 755100                    STA     0,,PR0

      568     7063    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7063 59 002567   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 002570   000001 036003                    ADLQ    1,DU
        59 002571   200056 756100                    STQ     DYNMEM$,,AUTO

      569     7064    4                   DYNMEM$->WRD1 = LAST_RC_DBK;

   7064 59 002572   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 002573   000000 235000 4                  LDA     LAST_RC_DBK
        59 002574   000000 755100                    STA     0,,PR0

      570     7065    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7065 59 002575   200056 236100                    LDQ     DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:150  
        59 002576   000001 036003                    ADLQ    1,DU
        59 002577   200056 756100                    STQ     DYNMEM$,,AUTO

      571     7066    4                   DYNMEM$->WRD1 = LNO;

   7066 59 002600   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 002601   200060 235100                    LDA     LNO,,AUTO
        59 002602   000000 755100                    STA     0,,PR0

      572     7067    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7067 59 002603   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 002604   000001 036003                    ADLQ    1,DU
        59 002605   200056 756100                    STQ     DYNMEM$,,AUTO

      573     7068    4                   DYNMEM$->CHAR30 = WORD1;

   7068 59 002606   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 002607   040100 100400                    MLR     fill='040'O
        59 002610   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 002611   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 002612   012440 710000 59                 TRA     s:8607

      574     7069    4               CASE(%CLC_FR); /* LOCATION MODE IS CALC USING dbid1[,dbidN] */

      575     7070        /* -if this is first calckey mentioned ever, create *CALC SC & SN
      576     7071            and *CALC.RC SN, RC and SO
      577     7072           -if this is the first calckey mentioned in this record, add this
      578     7073            record to the *CALC set (store SM and SS)
      579     7074           -store RFR and SN for this field
      580     7075           -store a CF off the SS of this record's SM in the *calc set
      581     7076           -store a CF off this record's SM in the *calc set */
      582     7077    4   CLC:
      583     7078    5                   IF UWA.OA.OA_CALC = 0 THEN DO; /* this is first calc key in DDL */

   7078 59 002613   000230 235000 57    CLC          LDA     UWA+152
        59 002614   002712 601000 59                 TNZ     s:7104
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:151  

      584     7079    5                       WORD1 = '*CALC';

   7079 59 002615   040000 100400                    MLR     fill='040'O
        59 002616   000013 000005 58                 ADSC9   11                       cn=0,n=5
        59 002617   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

      585     7080    5                       CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);

   7080 59 002620   000062 630400 60                 EPPR0   50
        59 002621   000020 631400 60                 EPPR1   16
        59 002622   000000 701000 xent               TSX1    ADD_SN
        59 002623   000000 011000                    NOP     0

      586     7081    5                       UWA.SC = '0'B;

   7081 59 002624   000000 100400                    MLR     fill='000'O
        59 002625   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002626   000310 000064 57                 ADSC9   UWA+200                  cn=0,n=52

      587     7082    5                       UWA.SC.SETTYPE = 1;

   7082 59 002627   000001 235007                    LDA     1,DL
        59 002630   000310 755000 57                 STA     UWA+200

      588     7083    5                       UWA.SC.PTRNO = 3;

   7083 59 002631   000003 236007                    LDQ     3,DL
        59 002632   000315 756000 57                 STQ     UWA+205

      589     7084    5                       UWA.SC.SEQDUP = 2;

   7084 59 002633   000002 235007                    LDA     2,DL
        59 002634   000320 755000 57                 STA     UWA+208

      590     7085    5                       CALL STRE_6('SC      ');

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:152  
   7085 59 002635   000072 630400 60                 EPPR0   58
        59 002636   000013 631400 60                 EPPR1   11
        59 002637   000000 701000 xent               TSX1    STRE_6
        59 002640   000000 011000                    NOP     0

      591     7086    5                       UWA.OA.OA_CALC = UWA.DIRECT_REF;

   7086 59 002641   000036 235000 57                 LDA     UWA+30
        59 002642   000230 755000 57                 STA     UWA+152

      592     7087    5                       UWA.OA.NUMB_SC = UWA.OA.NUMB_SC + 1;

   7087 59 002643   000216 054000 57                 AOS     UWA+142

      593     7088    5                       WORD1 = '*CALC.RC';

   7088 59 002644   040000 100400                    MLR     fill='040'O
        59 002645   000017 000010 58                 ADSC9   15                       cn=0,n=8
        59 002646   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

      594     7089    5                       CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,0,FOUND,RELTYPE.NO_NR,0,0);

   7089 59 002647   000022 630400 60                 EPPR0   18
        59 002650   000020 631400 60                 EPPR1   16
        59 002651   000000 701000 xent               TSX1    ADD_SN
        59 002652   000000 011000                    NOP     0

      595     7090    5                       UWA.DA.FRST_RC = UWA.DIRECT_REF;

   7090 59 002653   000036 235000 57                 LDA     UWA+30
        59 002654   000416 755000 57                 STA     UWA+270

      596     7091    5                       UWA.RC = '0'B;

   7091 59 002655   000000 100400                    MLR     fill='000'O
        59 002656   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002657   000270 000100 57                 ADSC9   UWA+184                  cn=0,n=64
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:153  

      597     7092    5                       UWA.RC.RTYPE = 4000;

   7092 59 002660   007640 236007                    LDQ     4000,DL
        59 002661   000270 756000 57                 STQ     UWA+184

      598     7093    5                       UWA.RC.SO = 1;

   7093 59 002662   000001 235007                    LDA     1,DL
        59 002663   000274 755000 57                 STA     UWA+188

      599     7094    5                       UWA.RC.NUM_SOSM = 1;

   7094 59 002664   000305 755000 57                 STA     UWA+197

      600     7095    5                       CALL STRE_6('RC      ');

   7095 59 002665   000032 630400 60                 EPPR0   26
        59 002666   000013 631400 60                 EPPR1   11
        59 002667   000000 701000 xent               TSX1    STRE_6
        59 002670   000000 011000                    NOP     0

      601     7096    5                       DBK_STAR_CALC_RC = UWA.DIRECT_REF;

   7096 59 002671   000036 235000 57                 LDA     UWA+30
        59 002672   000000 755000 6                  STA     DBK_STAR_CALC_RC

      602     7097    5                       UWA.OA.NUMB_RC = UWA.OA.NUMB_RC + 1;

   7097 59 002673   000215 054000 57                 AOS     UWA+141

      603     7098    5                       UWA.SO = '0'B;

   7098 59 002674   000000 100400                    MLR     fill='000'O
        59 002675   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002676   000354 000014 57                 ADSC9   UWA+236                  cn=0,n=12

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:154  
      604     7099    5                       CALL STRE_6('SO      ');

   7099 59 002677   000073 630400 60                 EPPR0   59
        59 002700   000013 631400 60                 EPPR1   11
        59 002701   000000 701000 xent               TSX1    STRE_6
        59 002702   000000 011000                    NOP     0

      605     7100    5                       UWA.OA.NUMB_SO = UWA.OA.NUMB_SO + 1;

   7100 59 002703   000221 054000 57                 AOS     UWA+145

      606     7101    5                       DBK_SO_CALC = UWA.DIRECT_REF;

   7101 59 002704   000036 235000 57                 LDA     UWA+30
        59 002705   000000 755000 53                 STA     DBK_SO_CALC

      607     7102    5                       CALL CONNECT_6('RC-SOSM ');

   7102 59 002706   000074 630400 60                 EPPR0   60
        59 002707   000013 631400 60                 EPPR1   11
        59 002710   000000 701000 xent               TSX1    CONNECT_6
        59 002711   000000 011000                    NOP     0

      608     7103    5                       END;

      609     7104    5                   IF DBK_SM_CALC = 0 THEN DO; /* first calckey in this record */

   7104 59 002712   000076 235000 0                  LDA     DBK_SM_CALC
        59 002713   003002 601000 59                 TNZ     s:7126

      610     7105    5                       CALL FINDD_6('SC      ',UWA.OA.OA_CALC);

   7105 59 002714   000075 630400 60                 EPPR0   61
        59 002715   000001 631400 60                 EPPR1   1
        59 002716   000000 701000 xent               TSX1    FINDD_6
        59 002717   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:155  
      611     7106    5                       CALL FINDPS_6('SC-SOSM '); /* want to add SMs after SO */

   7106 59 002720   000077 630400 60                 EPPR0   63
        59 002721   000013 631400 60                 EPPR1   11
        59 002722   000000 701000 xent               TSX1    FINDPS_6
        59 002723   000000 011000                    NOP     0

      612     7107    5                       CALL FINDD_6('RC      ',LAST_RC_DBK);

   7107 59 002724   000100 630400 60                 EPPR0   64
        59 002725   000001 631400 60                 EPPR1   1
        59 002726   000000 701000 xent               TSX1    FINDD_6
        59 002727   000000 011000                    NOP     0

      613     7108    5                       UWA.SM = '0'B;

   7108 59 002730   000000 100400                    MLR     fill='000'O
        59 002731   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002732   000360 000060 57                 ADSC9   UWA+240                  cn=0,n=48

      614     7109    5                       UWA.SM.PSMODE = 1;

   7109 59 002733   000001 235007                    LDA     1,DL
        59 002734   000366 755000 57                 STA     UWA+246

      615     7110    5                       UWA.SM.PSEQ = 1;

   7110 59 002735   000367 755000 57                 STA     UWA+247

      616     7111    5                       UWA.SM.SEQDUP = 2;

   7111 59 002736   000002 236007                    LDQ     2,DL
        59 002737   000363 756000 57                 STQ     UWA+243

      617     7112    5                       CALL STRE_6('SM      ');

   7112 59 002740   000102 630400 60                 EPPR0   66
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:156  
        59 002741   000013 631400 60                 EPPR1   11
        59 002742   000000 701000 xent               TSX1    STRE_6
        59 002743   000000 011000                    NOP     0

      618     7113    5                       UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;

   7113 59 002744   000222 054000 57                 AOS     UWA+146

      619     7114    5                       RC.NUM_SOSM = RC.NUM_SOSM + 1;

   7114 59 002745   000015 054000 0                  AOS     RC+13

      620     7115    5                       DBK_SM_CALC = UWA.DIRECT_REF;

   7115 59 002746   000036 235000 57                 LDA     UWA+30
        59 002747   000076 755000 0                  STA     DBK_SM_CALC

      621     7116    5                       CALL FINDNS_6('RC-SOSM ');

   7116 59 002750   000074 630400 60                 EPPR0   60
        59 002751   000013 631400 60                 EPPR1   11
        59 002752   000000 701000 xent               TSX1    FINDNS_6
        59 002753   000000 011000                    NOP     0

      622     7117    5                       CALL FINDD_6('SM      ',DBK_SM_CALC);

   7117 59 002754   000103 630400 60                 EPPR0   67
        59 002755   000001 631400 60                 EPPR1   1
        59 002756   000000 701000 xent               TSX1    FINDD_6
        59 002757   000000 011000                    NOP     0

      623     7118    5                       CALL CONNECT_6('RC-SOSM ');

   7118 59 002760   000074 630400 60                 EPPR0   60
        59 002761   000013 631400 60                 EPPR1   11
        59 002762   000000 701000 xent               TSX1    CONNECT_6
        59 002763   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:157  

      624     7119    5                       UWA.S_S = '0'B;

   7119 59 002764   000000 100400                    MLR     fill='000'O
        59 002765   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 002766   000374 000020 57                 ADSC9   UWA+252                  cn=0,n=16

      625     7120    5                       UWA.S_S.SC_SSH = UWA.OA.OA_CALC;

   7120 59 002767   000230 235000 57                 LDA     UWA+152
        59 002770   000375 755000 57                 STA     UWA+253

      626     7121    5                       UWA.S_S.SOSM_SSH = DBK_SO_CALC;

   7121 59 002771   000000 236000 53                 LDQ     DBK_SO_CALC
        59 002772   000376 756000 57                 STQ     UWA+254

      627     7122    5                       CALL STRE_6('S-S      ');

   7122 59 002773   000105 630400 60                 EPPR0   69
        59 002774   000013 631400 60                 EPPR1   11
        59 002775   000000 701000 xent               TSX1    STRE_6
        59 002776   000000 011000                    NOP     0

      628     7123    5                       UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;

   7123 59 002777   000223 054000 57                 AOS     UWA+147

      629     7124    5                       DBK_SS_CALC = UWA.DIRECT_REF;

   7124 59 003000   000036 235000 57                 LDA     UWA+30
        59 003001   000077 755000 0                  STA     DBK_SS_CALC

      630     7125    5                       END;

      631     7126    4                   WORD1 = QFR_NAME;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:158  
   7126 59 003002   040000 100400                    MLR     fill='040'O
        59 003003   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 003004   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

      632     7127    4                   IF WORD1 = 'DUPS' OR WORD1 = 'DUPLICATES' THEN

   7127 59 003005   040000 106400                    CMPC    fill='040'O
        59 003006   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003007   000034 000004 58                 ADSC9   28                       cn=0,n=4
        59 003010   003015 600000 59                 TZE     s:7129
        59 003011   040000 106400                    CMPC    fill='040'O
        59 003012   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003013   000035 000012 58                 ADSC9   29                       cn=0,n=10
        59 003014   003021 601000 59                 TNZ     s:7132

      633     7128    5                   DO;

      634     7129    5                       PARAN.REJECT = '1'B;

   7129 59 003015   200003 470500                    LDP0    @PARAN,,AUTO
        59 003016   000200 236003                    LDQ     128,DU
        59 003017   000000 256100                    ORSQ    0,,PR0

      635     7130    5                       RETURN;

   7130 59 003020   000000 702200 xent               TSX2  ! X66_ARET

      636     7131    5                       END;
      637     7132    4                   RC.PSMODE = 1;

   7132 59 003021   000001 235007                    LDA     1,DL
        59 003022   000001 755000 0                  STA     RC+1

      638     7133    4                   RC.SLACK = RC.SLACK + 1; /* misuse this field to count calckeys */

   7133 59 003023   000017 054000 0                  AOS     RC+15

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:159  
      639     7134    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.LOC,

   7134 59 003024   000110 237000 60                 LDAQ    72
        59 003025   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 003026   000112 237000 60                 LDAQ    74
        59 003027   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 003030   200060 630500                    EPPR0   LNO,,AUTO
        59 003031   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 003032   000024 236000 60                 LDQ     20
        59 003033   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003034   000114 237000 60                 LDAQ    76
        59 003035   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 003036   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003037   000020 631400 60                 EPPR1   16
        59 003040   000000 701000 xent               TSX1    ADD_SN
        59 003041   000000 011000                    NOP     0

      640     7135    4                      EXPLCT,LAST_RC_DBK);
      641     7136    4                   IF FIRST_SFR_DBK ~= 0 THEN /* add all RFRs after SFRs */

   7136 59 003042   000075 235000 0                  LDA     FIRST_SFR_DBK
        59 003043   003054 600000 59                 TZE     s:7141

      642     7137    5                   DO;

      643     7138    5                       CALL FINDD_6('FR      ',FIRST_SFR_DBK);

   7138 59 003044   000116 630400 60                 EPPR0   78
        59 003045   000001 631400 60                 EPPR1   1
        59 003046   000000 701000 xent               TSX1    FINDD_6
        59 003047   000000 011000                    NOP     0

      644     7139    5                       CALL FCURR_R_6('SN      ');

   7139 59 003050   000016 630400 60                 EPPR0   14
        59 003051   000013 631400 60                 EPPR1   11
        59 003052   000000 701000 xent               TSX1    FCURR_R_6
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:160  
        59 003053   000000 011000                    NOP     0

      645     7140    5                       END;

      646     7141    4                   UWA.FR = '0'B;

   7141 59 003054   000000 100400                    MLR     fill='000'O
        59 003055   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 003056   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68

      647     7142    4                  UWA.FR.DERIVED = RC.SLACK; /* misuse this field to count calckeys */

   7142 59 003057   000017 235000 0                  LDA     RC+15
        59 003060   000347 755000 57                 STA     UWA+231

      648     7143    4                   UWA.FR.F_OCCURS = 1; /* misuse this field to signal calckey */

   7143 59 003061   000001 236007                    LDQ     1,DL
        59 003062   000345 756000 57                 STQ     UWA+229

      649     7144    4                   UWA.FR.REF = 1;

   7144 59 003063   000333 756000 57                 STQ     UWA+219

      650     7145    4                   CALL STRE_6('FR      ');

   7145 59 003064   000116 630400 60                 EPPR0   78
        59 003065   000013 631400 60                 EPPR1   11
        59 003066   000000 701000 xent               TSX1    STRE_6
        59 003067   000000 011000                    NOP     0

      651     7146    4                   HOLD_DBK = UWA.DIRECT_REF;

   7146 59 003070   000036 235000 57                 LDA     UWA+30
        59 003071   200007 755100                    STA     HOLD_DBK,,AUTO

      652     7147    4                   CALL CONNECT_6('SN-SE   ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:161  

   7147 59 003072   000107 630400 60                 EPPR0   71
        59 003073   000013 631400 60                 EPPR1   11
        59 003074   000000 701000 xent               TSX1    CONNECT_6
        59 003075   000000 011000                    NOP     0

      653     7148    4                   UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   7148 59 003076   000220 054000 57                 AOS     UWA+144

      654     7149    4                   CALL FINDD_6('S-S     ',DBK_SS_CALC);

   7149 59 003077   000120 630400 60                 EPPR0   80
        59 003100   000001 631400 60                 EPPR1   1
        59 003101   000000 701000 xent               TSX1    FINDD_6
        59 003102   000000 011000                    NOP     0

      655     7150    4                   UWA.C_F = '0'B;

   7150 59 003103   000000 100400                    MLR     fill='000'O
        59 003104   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 003105   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20

      656     7151    4                   UWA.C_F.CTRLTYPE = 4;

   7151 59 003106   000004 235007                    LDA     4,DL
        59 003107   000401 755000 57                 STA     UWA+257

      657     7152    4                   CALL STRE_6('C-F     ');

   7152 59 003110   000122 630400 60                 EPPR0   82
        59 003111   000013 631400 60                 EPPR1   11
        59 003112   000000 701000 xent               TSX1    STRE_6
        59 003113   000000 011000                    NOP     0

      658     7153    4                   CALL CONNECT_6('SSSM-CF ');

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:162  
   7153 59 003114   000123 630400 60                 EPPR0   83
        59 003115   000013 631400 60                 EPPR1   11
        59 003116   000000 701000 xent               TSX1    CONNECT_6
        59 003117   000000 011000                    NOP     0

      659     7154    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   7154 59 003120   000126 237000 60                 LDAQ    86
        59 003121   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003122   000125 236000 60                 LDQ     85
        59 003123   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 003124   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 003125   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 003126   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003127   000124 631400 60                 EPPR1   84
        59 003130   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        59 003131   000000 011000                    NOP     0

      660     7155    4                      'FR      ', 'C-F     ' );
      661     7156    4                   CALL FINDOS_6('FR-CFS  ');

   7156 59 003132   000125 630400 60                 EPPR0   85
        59 003133   000013 631400 60                 EPPR1   11
        59 003134   000000 701000 xent               TSX1    FINDOS_6
        59 003135   000000 011000                    NOP     0

      662     7157    4                   HOLD_DBK = UWA.DIRECT_REF;

   7157 59 003136   000036 235000 57                 LDA     UWA+30
        59 003137   200007 755100                    STA     HOLD_DBK,,AUTO

      663     7158    4                   CALL FINDD_6('SM      ',DBK_SM_CALC);

   7158 59 003140   000103 630400 60                 EPPR0   67
        59 003141   000001 631400 60                 EPPR1   1
        59 003142   000000 701000 xent               TSX1    FINDD_6
        59 003143   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:163  

      664     7159    4                   CALL STRE_6('C-F     ');

   7159 59 003144   000122 630400 60                 EPPR0   82
        59 003145   000013 631400 60                 EPPR1   11
        59 003146   000000 701000 xent               TSX1    STRE_6
        59 003147   000000 011000                    NOP     0

      665     7160    4                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 2;

   7160 59 003150   000002 236007                    LDQ     2,DL
        59 003151   000224 056000 57                 ASQ     UWA+148

      666     7161    4                   CALL CONNECT_6('SMSS-CF ');

   7161 59 003152   000130 630400 60                 EPPR0   88
        59 003153   000013 631400 60                 EPPR1   11
        59 003154   000000 701000 xent               TSX1    CONNECT_6
        59 003155   000000 011000                    NOP     0

      667     7162    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   7162 59 003156   000126 237000 60                 LDAQ    86
        59 003157   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003160   000125 236000 60                 LDQ     85
        59 003161   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 003162   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 003163   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 003164   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003165   000124 631400 60                 EPPR1   84
        59 003166   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        59 003167   000000 011000                    NOP     0
        59 003170   012440 710000 59                 TRA     s:8607

      668     7163    4                      'FR      ', 'C-F     ' );
      669     7164    4               CASE(%CLC_QRC);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:164  
      670     7165    4                   CALL GET_WORD;

   7165 59 003171   012467 701000 59                 TSX1    GET_WORD
        59 003172   000000 011000                    NOP     0

      671     7166    4                   IF WORD1 ~= LAST_RC_NAME THEN

   7166 59 003173   040000 106400                    CMPC    fill='040'O
        59 003174   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003175   000050 000036 0                  ADSC9   LAST_RC_NAME             cn=0,n=30
        59 003176   003213 600000 59                 TZE     s:7176

      672     7167    5                   DO;

      673     7168    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4808);

   7168 59 003177   000000 235000 7                  LDA     LINE_COUNT
        59 003200   000002 135007                    SBLA    2,DL
        59 003201   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 003202   000132 237000 60                 LDAQ    90
        59 003203   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003204   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003205   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 003206   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 003207   000005 631400 60                 EPPR1   5
        59 003210   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 003211   000000 011000                    NOP     0

      674     7169         /*E* ERROR: ZIG-4808-C
      675     7170                    MESSAGE: This calc key is invalid because it is not a
      676     7171                             field of the record.
      677     7172                 */
      678     7173    5                       END;

   7173 59 003212   012440 710000 59                 TRA     s:8607

      679     7174    4                   ELSE
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:165  
      680     7175    5                   DO;

      681     7176    5                       GOTO CLC;

   7176 59 003213   002613 710000 59                 TRA     CLC

      682     7177    5                       END;
      683     7178    4               CASE(%CLC_QFR);

      684     7179    4                   CALL GET_WORD;

   7179 59 003214   012467 701000 59                 TSX1    GET_WORD
        59 003215   000000 011000                    NOP     0

      685     7180    4                   QFR_NAME = WORD1;

   7180 59 003216   040000 100400                    MLR     fill='040'O
        59 003217   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003220   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 003221   012440 710000 59                 TRA     s:8607

      686     7181    4               CASE(%NOT1); /* LOC MODE CALC...DUPS NOT ALLOWED */

      687     7182    4                   RC.CALCDUP = 1;

   7182 59 003222   000001 235007                    LDA     1,DL
        59 003223   000007 755000 0                  STA     RC+7

      688     7183    4                   CALL FETCHD_6('SM      ',DBK_SM_CALC);

   7183 59 003224   000103 630400 60                 EPPR0   67
        59 003225   000001 631400 60                 EPPR1   1
        59 003226   000000 701000 xent               TSX1    FETCHD_6
        59 003227   000000 011000                    NOP     0

      689     7184    4                   UWA.SM.CALCDUP = 1;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:166  
   7184 59 003230   000001 235007                    LDA     1,DL
        59 003231   000364 755000 57                 STA     UWA+244

      690     7185    4                   CALL MODIFY_6('SM      ');

   7185 59 003232   000102 630400 60                 EPPR0   66
        59 003233   000013 631400 60                 EPPR1   11
        59 003234   000000 701000 xent               TSX1    MODIFY_6
        59 003235   000000 011000                    NOP     0
        59 003236   012440 710000 59                 TRA     s:8607

      691     7186    4               CASE(%VIA_SC_NM); /* LOCATION MODE IS VIA setname SET */

      692     7187        /* -if necessary, add SN for this set
      693     7188           -save this set's SN DBK in this record's table entry (it will
      694     7189            be checked later in SET OWNER and SET MEMBER clauses */
      695     7190    4                   CALL GET_WORD;

   7190 59 003237   012467 701000 59                 TSX1    GET_WORD
        59 003240   000000 011000                    NOP     0

      696     7191    4                   CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,0);

   7191 59 003241   000134 237000 60                 LDAQ    92
        59 003242   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 003243   000112 237000 60                 LDAQ    74
        59 003244   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 003245   200060 630500                    EPPR0   LNO,,AUTO
        59 003246   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 003247   000024 236000 60                 LDQ     20
        59 003250   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003251   000062 237000 60                 LDAQ    50
        59 003252   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 003253   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003254   000020 631400 60                 EPPR1   16
        59 003255   000000 701000 xent               TSX1    ADD_SN
        59 003256   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:167  

      697     7192         /* save VIA setname SN in this record's table entry */
      698     7193    4                   LAST_RC$->TABLES.DBK_RC(0) = UWA.DIRECT_REF;

   7193 59 003257   000036 720000 57                 LXL0    UWA+30
        59 003260   000000 470400 8                  LDP0    LAST_RC$
        59 003261   000010 440100                    SXL0    8,,PR0

      699     7194    4                   RC.PSMODE = 2;

   7194 59 003262   000002 235007                    LDA     2,DL
        59 003263   000001 755000 0                  STA     RC+1
        59 003264   012440 710000 59                 TRA     s:8607

      700     7195    4               CASE(%INDX_KEY_NM); /* LOCATION MODE IS INDEXED USING keyname */

      701     7196        /* -if necessary, add SN for this key
      702     7197           - save the keyname so that later, we can ensure that
      703     7198            it is named in the KEY NAME IS clause */
      704     7199    4                   CALL GET_WORD;

   7199 59 003265   012467 701000 59                 TSX1    GET_WORD
        59 003266   000000 011000                    NOP     0

      705     7200    4                   INDX_KEY_NM = WORD1;

   7200 59 003267   040000 100400                    MLR     fill='040'O
        59 003270   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003271   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30

      706     7201    4                   CALL ADD_SN(%ZIG_RTYPE_KC,WORD1,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,0);

   7201 59 003272   000134 237000 60                 LDAQ    92
        59 003273   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 003274   000112 237000 60                 LDAQ    74
        59 003275   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 003276   200060 630500                    EPPR0   LNO,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:168  
        59 003277   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 003300   000024 236000 60                 LDQ     20
        59 003301   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003302   000140 237000 60                 LDAQ    96
        59 003303   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 003304   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003305   000020 631400 60                 EPPR1   16
        59 003306   000000 701000 xent               TSX1    ADD_SN
        59 003307   000000 011000                    NOP     0

      707     7202    4                   RC.PSMODE = 4;

   7202 59 003310   000004 235007                    LDA     4,DL
        59 003311   000001 755000 0                  STA     RC+1
        59 003312   012440 710000 59                 TRA     s:8607

      708     7203    4               CASE(%W_CL); /* WITHIN clause */

      709     7204    5                   IF WITHIN THEN DO;

   7204 59 003313   000031 234000 0                  SZN     WITHIN
        59 003314   003331 605000 59                 TPL     s:7207

      710     7205    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7205 59 003315   000000 235000 7                  LDA     LINE_COUNT
        59 003316   000002 135007                    SBLA    2,DL
        59 003317   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 003320   000054 237000 60                 LDAQ    44
        59 003321   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003322   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 003323   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 003324   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 003325   000005 631400 60                 EPPR1   5
        59 003326   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 003327   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:169  
      711     7206    5                       END;

   7206 59 003330   003333 710000 59                 TRA     s:7208

      712     7207    4                   ELSE WITHIN = '1'B;

   7207 59 003331   400000 236003                    LDQ     -131072,DU
        59 003332   000031 756000 0                  STQ     WITHIN

      713     7208    4                   IF NUM_AREAS_WITHIN = 1 THEN RC.WITHINA = 0;

   7208 59 003333   000114 235000 0                  LDA     NUM_AREAS_WITHIN
        59 003334   000001 115007                    CMPA    1,DL
        59 003335   003340 601000 59                 TNZ     s:7209

   7208 59 003336   000003 450000 0                  STZ     RC+3
        59 003337   012440 710000 59                 TRA     s:8607

      714     7209    4                   ELSE IF NUM_AREAS_WITHIN > 1 THEN RC.WITHINA = 1;

   7209 59 003340   000002 115007                    CMPA    2,DL
        59 003341   012440 602000 59                 TNC     s:8607

   7209 59 003342   000001 236007                    LDQ     1,DL
        59 003343   000003 756000 0                  STQ     RC+3
        59 003344   012440 710000 59                 TRA     s:8607

      715     7210    4               CASE(%W_AC_NM); /* WITHIN areaname */

      716     7211        /* -keep track of how many areas this record is in
      717     7212           -store RA for this area */
      718     7213    4                   CALL GET_WORD;

   7213 59 003345   012467 701000 59                 TSX1    GET_WORD
        59 003346   000000 011000                    NOP     0

      719     7214    4                   IF WORD1 = 'AREA_ID' OR WORD1 = 'LOCATION' OR
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:170  

   7214 59 003347   040000 106400                    CMPC    fill='040'O
        59 003350   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003351   000054 000007 58                 ADSC9   44                       cn=0,n=7
        59 003352   003367 600000 59                 TZE     s:7217
        59 003353   040000 106400                    CMPC    fill='040'O
        59 003354   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003355   000056 000010 58                 ADSC9   46                       cn=0,n=8
        59 003356   003367 600000 59                 TZE     s:7217
        59 003357   040000 106400                    CMPC    fill='040'O
        59 003360   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003361   000060 000007 58                 ADSC9   48                       cn=0,n=7
        59 003362   003367 600000 59                 TZE     s:7217
        59 003363   040000 106400                    CMPC    fill='040'O
        59 003364   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003365   000062 000003 58                 ADSC9   50                       cn=0,n=3
        59 003366   003373 601000 59                 TNZ     s:7220

      720     7215    4                      WORD1 = 'PRIVACY' OR WORD1 = 'KEY' THEN
      721     7216    5                   DO;

      722     7217    5                       PARAN.REJECT = '1'B;

   7217 59 003367   200003 470500                    LDP0    @PARAN,,AUTO
        59 003370   000200 236003                    LDQ     128,DU
        59 003371   000000 256100                    ORSQ    0,,PR0

      723     7218    5                       RETURN;

   7218 59 003372   000000 702200 xent               TSX2  ! X66_ARET

      724     7219    5                       END;
      725     7220    4                   NUM_AREAS_WITHIN = NUM_AREAS_WITHIN + 1;

   7220 59 003373   000114 235000 0                  LDA     NUM_AREAS_WITHIN
        59 003374   000001 035007                    ADLA    1,DL
        59 003375   000114 755000 0                  STA     NUM_AREAS_WITHIN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:171  

      726     7221    4                   UWA.RA = '0'B;

   7221 59 003376   000000 100400                    MLR     fill='000'O
        59 003377   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 003400   000326 000020 57                 ADSC9   UWA+214                  cn=0,n=16

      727     7222    4                   CALL ADD_SN(%ZIG_RTYPE_AC,WORD1,0,LNO,FOUND,RELTYPE.LOC,EXPLCT,0);

   7222 59 003401   000134 237000 60                 LDAQ    92
        59 003402   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 003403   000112 237000 60                 LDAQ    74
        59 003404   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 003405   200060 630500                    EPPR0   LNO,,AUTO
        59 003406   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 003407   000024 236000 60                 LDQ     20
        59 003410   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003411   000042 237000 60                 LDAQ    34
        59 003412   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 003413   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003414   000020 631400 60                 EPPR1   16
        59 003415   000000 701000 xent               TSX1    ADD_SN
        59 003416   000000 011000                    NOP     0

      728     7223    5                   IF FOUND = %NOTFOUND THEN DO;

   7223 59 003417   000133 235000 0                  LDA     FOUND
        59 003420   003504 601000 59                 TNZ     s:7238

      729     7224    5                       CALL INDEX(CT1,' ',WORD1);

   7224 59 003421   000000 124400                    SCM     mask='000'O
        59 003422   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003423   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 003424   200050 000100                    ARG     CT1,,AUTO

      730     7225    5                       CALL SET_FIELDS(1,CT1,WORD1);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:172  

   7225 59 003425   000023 236000 60                 LDQ     19
        59 003426   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003427   200050 630500                    EPPR0   CT1,,AUTO
        59 003430   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 003431   000003 236000 60                 LDQ     3
        59 003432   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 003433   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003434   000005 631400 60                 EPPR1   5
        59 003435   000000 701000 xent               TSX1    SET_FIELDS
        59 003436   000000 011000                    NOP     0

      731     7226    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4156);

   7226 59 003437   000000 235000 7                  LDA     LINE_COUNT
        59 003440   000002 135007                    SBLA    2,DL
        59 003441   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 003442   000142 237000 60                 LDAQ    98
        59 003443   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003444   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003445   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 003446   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 003447   000005 631400 60                 EPPR1   5
        59 003450   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 003451   000000 011000                    NOP     0

      732     7227         /*E* ERROR: ZIG-4156-C
      733     7228                 MESSAGE: The area name "%U1" has not been defined in an area
      734     7229                          entry.
      735     7230              */
      736     7231    5                       UWA.AC = '0'B;

   7231 59 003452   000000 100400                    MLR     fill='000'O
        59 003453   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 003454   000232 000164 57                 ADSC9   UWA+154                  cn=0,n=116

      737     7232    5                       CALL ADD_SN(%ZIG_RTYPE_AC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:173  

   7232 59 003455   000024 237000 60                 LDAQ    20
        59 003456   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 003457   000026 237000 60                 LDAQ    22
        59 003460   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 003461   200060 630500                    EPPR0   LNO,,AUTO
        59 003462   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 003463   000003 236000 60                 LDQ     3
        59 003464   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003465   000042 237000 60                 LDAQ    34
        59 003466   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 003467   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003470   000020 631400 60                 EPPR1   16
        59 003471   000000 701000 xent               TSX1    ADD_SN
        59 003472   000000 011000                    NOP     0

      738     7233    5                       CALL STRE_6('AC      '); /* Pretend AC to allow

   7233 59 003473   000144 630400 60                 EPPR0   100
        59 003474   000013 631400 60                 EPPR1   11
        59 003475   000000 701000 xent               TSX1    STRE_6
        59 003476   000000 011000                    NOP     0

      739     7234         processing to continue */
      740     7235    5                       CALL CONNECT_6('OA-AC   ');

   7235 59 003477   000145 630400 60                 EPPR0   101
        59 003500   000013 631400 60                 EPPR1   11
        59 003501   000000 701000 xent               TSX1    CONNECT_6
        59 003502   000000 011000                    NOP     0

      741     7236    5                       UWA.OA.NUMB_AC = UWA.OA.NUMB_AC + 1;

   7236 59 003503   000214 054000 57                 AOS     UWA+140

      742     7237    5                       END;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:174  
      743     7238    4                   CALL FINDNS_6('SN-SE   '); /* AC */

   7238 59 003504   000107 630400 60                 EPPR0   71
        59 003505   000013 631400 60                 EPPR1   11
        59 003506   000000 701000 xent               TSX1    FINDNS_6
        59 003507   000000 011000                    NOP     0

      744     7239    4                   CALL FINDD_6('RC      ',LAST_RC_DBK); /* RC */

   7239 59 003510   000100 630400 60                 EPPR0   64
        59 003511   000001 631400 60                 EPPR1   1
        59 003512   000000 701000 xent               TSX1    FINDD_6
        59 003513   000000 011000                    NOP     0

      745     7240    4                   CALL STRE_6('RA      ');

   7240 59 003514   000146 630400 60                 EPPR0   102
        59 003515   000013 631400 60                 EPPR1   11
        59 003516   000000 701000 xent               TSX1    STRE_6
        59 003517   000000 011000                    NOP     0

      746     7241    4                   UWA.OA.NUMB_RA = UWA.OA.NUMB_RA + 1;

   7241 59 003520   000217 054000 57                 AOS     UWA+143
        59 003521   012440 710000 59                 TRA     s:8607

      747     7242    4               CASE(%AC_LIST);

      748     7243    4               CASE(%ANY); /* WITHIN ANY AREA... */

      749     7244        /* -save this record's RC DBK to handle in pass2 */
      750     7245    4                   RC.ANY_IND = 1;

   7245 59 003522   000001 235007                    LDA     1,DL
        59 003523   000010 755000 0                  STA     RC+8

      751     7246    4                   RC.WITHINA = 1;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:175  

   7246 59 003524   000003 755000 0                  STA     RC+3

      752     7247    4                   CALL ZIG$G_DYN_MEM_6(3,DYNMEM$);

   7247 59 003525   200056 631500                    EPPR1   DYNMEM$,,AUTO
        59 003526   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 003527   000150 236000 60                 LDQ     104
        59 003530   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 003531   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003532   000001 631400 60                 EPPR1   1
        59 003533   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 003534   000000 011000                    NOP     0

      753     7248    4                   DYNMEM$->WRD1 = %WITHIN_ANY;

   7248 59 003535   000062 235007                    LDA     50,DL
        59 003536   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 003537   000000 755100                    STA     0,,PR0

      754     7249    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7249 59 003540   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 003541   000001 036003                    ADLQ    1,DU
        59 003542   200056 756100                    STQ     DYNMEM$,,AUTO

      755     7250    4                   DYNMEM$->WRD1 = LAST_RC_DBK;

   7250 59 003543   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 003544   000000 235000 4                  LDA     LAST_RC_DBK
        59 003545   000000 755100                    STA     0,,PR0

      756     7251    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7251 59 003546   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 003547   000001 036003                    ADLQ    1,DU
        59 003550   200056 756100                    STQ     DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:176  

      757     7252    4                   DYNMEM$->WRD1 = LNO;

   7252 59 003551   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 003552   200060 235100                    LDA     LNO,,AUTO
        59 003553   000000 755100                    STA     0,,PR0
        59 003554   012440 710000 59                 TRA     s:8607

      758     7253    4               CASE(%EX_AC_NM); /* WITHIN ANY AREA EXCEPT areaname1[,areaname2] */

      759     7254        /* -save 30 char areanames to deal with in pass2 */
      760     7255    4                   CALL GET_WORD;

   7255 59 003555   012467 701000 59                 TSX1    GET_WORD
        59 003556   000000 011000                    NOP     0

      761     7256    4                   IF WORD1 = 'AREA_ID' OR WORD1 = 'LOCATION' OR

   7256 59 003557   040000 106400                    CMPC    fill='040'O
        59 003560   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003561   000054 000007 58                 ADSC9   44                       cn=0,n=7
        59 003562   003577 600000 59                 TZE     s:7259
        59 003563   040000 106400                    CMPC    fill='040'O
        59 003564   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003565   000056 000010 58                 ADSC9   46                       cn=0,n=8
        59 003566   003577 600000 59                 TZE     s:7259
        59 003567   040000 106400                    CMPC    fill='040'O
        59 003570   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003571   000060 000007 58                 ADSC9   48                       cn=0,n=7
        59 003572   003577 600000 59                 TZE     s:7259
        59 003573   040000 106400                    CMPC    fill='040'O
        59 003574   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003575   000062 000003 58                 ADSC9   50                       cn=0,n=3
        59 003576   003603 601000 59                 TNZ     s:7262

      762     7257    4                      WORD1 = 'PRIVACY' OR WORD1 = 'KEY' THEN
      763     7258    5                   DO;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:177  

      764     7259    5                       PARAN.REJECT = '1'B;

   7259 59 003577   200003 470500                    LDP0    @PARAN,,AUTO
        59 003600   000200 236003                    LDQ     128,DU
        59 003601   000000 256100                    ORSQ    0,,PR0

      765     7260    5                       RETURN;

   7260 59 003602   000000 702200 xent               TSX2  ! X66_ARET

      766     7261    5                       END;
      767     7262    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   7262 59 003603   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 003604   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 003605   000037 236000 60                 LDQ     31
        59 003606   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 003607   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003610   000001 631400 60                 EPPR1   1
        59 003611   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 003612   000000 011000                    NOP     0

      768     7263    4                   DYNMEM$->WRD1 = %EXC_AREA;

   7263 59 003613   000074 235007                    LDA     60,DL
        59 003614   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 003615   000000 755100                    STA     0,,PR0

      769     7264    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7264 59 003616   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 003617   000001 036003                    ADLQ    1,DU
        59 003620   200056 756100                    STQ     DYNMEM$,,AUTO

      770     7265    4                   DYNMEM$->WRD1 = LNO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:178  
   7265 59 003621   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 003622   200060 235100                    LDA     LNO,,AUTO
        59 003623   000000 755100                    STA     0,,PR0

      771     7266    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   7266 59 003624   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 003625   000001 036003                    ADLQ    1,DU
        59 003626   200056 756100                    STQ     DYNMEM$,,AUTO

      772     7267    4                   DYNMEM$->CHAR30 = WORD1;

   7267 59 003627   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 003630   040100 100400                    MLR     fill='040'O
        59 003631   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 003632   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 003633   012440 710000 59                 TRA     s:8607

      773     7268    4               CASE(%AC_ID);

      774     7269    4               CASE(%AC_ID_NM); /* AREA-ID IS dbparam */

      775     7270        /* -this clause only allowed if not in only one area
      776     7271           -store SN and RFR of dbparam
      777     7272           -RFR gets connected to *DBPARAM RC
      778     7273           -store SFR and connect to this record's RC */
      779     7274    5                   IF (NUM_AREAS_WITHIN < 2) AND (RC.ANY_IND = 0) THEN DO;

   7274 59 003634   000114 235000 0                  LDA     NUM_AREAS_WITHIN
        59 003635   000002 115007                    CMPA    2,DL
        59 003636   003654 603000 59                 TRC     s:7281
        59 003637   000010 235000 0                  LDA     RC+8
        59 003640   003654 601000 59                 TNZ     s:7281

      780     7275    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4111);

   7275 59 003641   000000 235000 7                  LDA     LINE_COUNT
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:179  
        59 003642   000002 135007                    SBLA    2,DL
        59 003643   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 003644   000152 237000 60                 LDAQ    106
        59 003645   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003646   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 003647   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 003650   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 003651   000005 631400 60                 EPPR1   5
        59 003652   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 003653   000000 011000                    NOP     0

      781     7276         /*E* ERROR: ZIG-4111-C
      782     7277                 MESSAGE: The AREA_ID clause is allowed only when the record
      783     7278                          is in more than one area.
      784     7279              */
      785     7280    5                       END;

      786     7281    4                   CALL FINDD_6('RC      ',DBK_STAR_DBPARAM_RC);

   7281 59 003654   000154 630400 60                 EPPR0   108
        59 003655   000001 631400 60                 EPPR1   1
        59 003656   000000 701000 xent               TSX1    FINDD_6
        59 003657   000000 011000                    NOP     0

      787     7282    4                   CALL GET_WORD;

   7282 59 003660   012467 701000 59                 TSX1    GET_WORD
        59 003661   000000 011000                    NOP     0

      788     7283    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.INAREA,

   7283 59 003662   000156 237000 60                 LDAQ    110
        59 003663   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 003664   000160 237000 60                 LDAQ    112
        59 003665   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 003666   200060 630500                    EPPR0   LNO,,AUTO
        59 003667   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:180  
        59 003670   000024 236000 60                 LDQ     20
        59 003671   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 003672   000114 237000 60                 LDAQ    76
        59 003673   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 003674   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003675   000020 631400 60                 EPPR1   16
        59 003676   000000 701000 xent               TSX1    ADD_SN
        59 003677   000000 011000                    NOP     0

      789     7284    4                      EXPLCT,DBK_STAR_DBPARAM_RC);
      790     7285    5                   IF FOUND = %FOUNDDEF THEN DO;

   7285 59 003700   000133 235000 0                  LDA     FOUND
        59 003701   000002 115007                    CMPA    2,DL
        59 003702   003716 601000 59                 TNZ     s:7293

      791     7286    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4100);

   7286 59 003703   000000 236000 7                  LDQ     LINE_COUNT
        59 003704   000002 136007                    SBLQ    2,DL
        59 003705   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 003706   000164 237000 60                 LDAQ    116
        59 003707   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003710   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003711   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 003712   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 003713   000005 631400 60                 EPPR1   5
        59 003714   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 003715   000000 011000                    NOP     0

      792     7287         /*E* ERROR: ZIG-4100-C
      793     7288
      794     7289                 MESSAGE: The AREA_ID clause must reference a data base
      795     7290                          parameter, not a data base identifier.
      796     7291              */
      797     7292    5                       END;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:181  
      798     7293    4                   IF FOUND = %NOTFOUND THEN

   7293 59 003716   000133 235000 0                  LDA     FOUND
        59 003717   003747 601000 59                 TNZ     s:7309

      799     7294    5                   DO;

      800     7295    5                       UWA.FR = '0'B;

   7295 59 003720   000000 100400                    MLR     fill='000'O
        59 003721   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 003722   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68

      801     7296    5                       UWA.FR.REF = 1;

   7296 59 003723   000001 236007                    LDQ     1,DL
        59 003724   000333 756000 57                 STQ     UWA+219

      802     7297    5                       UWA.FR.F_USE = 1;

   7297 59 003725   000343 756000 57                 STQ     UWA+227

      803     7298    5                       UWA.FR.PREC = 30;

   7298 59 003726   000036 235007                    LDA     30,DL
        59 003727   000335 755000 57                 STA     UWA+221

      804     7299    5                       UWA.FR.F_SIGN = 1;

   7299 59 003730   000337 756000 57                 STQ     UWA+223

      805     7300    5                       UWA.FR.FTYPE = 5;

   7300 59 003731   000005 235007                    LDA     5,DL
        59 003732   000334 755000 57                 STA     UWA+220

      806     7301    5                       UWA.FR.BEIST = 1; /* Misuse to signify AREA_ID dbparam */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:182  

   7301 59 003733   000350 756000 57                 STQ     UWA+232

      807     7302    5                       CALL STRE_6('FR      ');

   7302 59 003734   000116 630400 60                 EPPR0   78
        59 003735   000013 631400 60                 EPPR1   11
        59 003736   000000 701000 xent               TSX1    STRE_6
        59 003737   000000 011000                    NOP     0

      808     7303    5                       CALL CONNECT_6('SN-SE   ');

   7303 59 003740   000107 630400 60                 EPPR0   71
        59 003741   000013 631400 60                 EPPR1   11
        59 003742   000000 701000 xent               TSX1    CONNECT_6
        59 003743   000000 011000                    NOP     0

      809     7304    5                       UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   7304 59 003744   000220 054000 57                 AOS     UWA+144

      810     7305    5                       UWA.FR.BEIST = 0;

   7305 59 003745   000350 450000 57                 STZ     UWA+232

      811     7306    5                       END;

   7306 59 003746   003774 710000 59                 TRA     s:7319

      812     7307    4                   ELSE
      813     7308    5                   DO;

      814     7309    5                       CALL FETCHNS_6('SN-SE   '); /*RFR*/

   7309 59 003747   000107 630400 60                 EPPR0   71
        59 003750   000013 631400 60                 EPPR1   11
        59 003751   000000 701000 xent               TSX1    FETCHNS_6
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:183  
        59 003752   000000 011000                    NOP     0

      815     7310    5                       IF UWA.FR.FTYPE ~= 5 OR UWA.FR.PREC ~= 30 THEN

   7310 59 003753   000334 235000 57                 LDA     UWA+220
        59 003754   000005 115007                    CMPA    5,DL
        59 003755   003761 601000 59                 TNZ     s:7312
        59 003756   000335 236000 57                 LDQ     UWA+221
        59 003757   000036 116007                    CMPQ    30,DL
        59 003760   003774 600000 59                 TZE     s:7319

      816     7311    6                       DO;

      817     7312    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4101);

   7312 59 003761   000000 236000 7                  LDQ     LINE_COUNT
        59 003762   000002 136007                    SBLQ    2,DL
        59 003763   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 003764   000166 237000 60                 LDAQ    118
        59 003765   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 003766   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 003767   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 003770   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 003771   000005 631400 60                 EPPR1   5
        59 003772   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 003773   000000 011000                    NOP     0

      818     7313         /*   ERROR: ZIG-4100-C
      819     7314            MESSAGE: An AREA_ID data base parameter must have
      820     7315            CHARACTER data type with PRECISION 30.
      821     7316         */
      822     7317    6                           END;

      823     7318    5                       END;

      824     7319    4                   UWA.FR.FR_FRH = UWA.DIRECT_REF;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:184  
   7319 59 003774   000036 235000 57                 LDA     UWA+30
        59 003775   000352 755000 57                 STA     UWA+234

      825     7320    4                   CALL FINDD_6('RC      ',LAST_RC_DBK);

   7320 59 003776   000100 630400 60                 EPPR0   64
        59 003777   000001 631400 60                 EPPR1   1
        59 004000   000000 701000 xent               TSX1    FINDD_6
        59 004001   000000 011000                    NOP     0

      826     7321    4                   UWA.FR.SYN = 1;

   7321 59 004002   000001 235007                    LDA     1,DL
        59 004003   000332 755000 57                 STA     UWA+218

      827     7322    4                   UWA.FR.F_USE = 2;

   7322 59 004004   000002 236007                    LDQ     2,DL
        59 004005   000343 756000 57                 STQ     UWA+227

      828     7323    4                   UWA.FR.REF = 0;

   7323 59 004006   000333 450000 57                 STZ     UWA+219

      829     7324    4                   CALL STRE_6('FR      ');

   7324 59 004007   000116 630400 60                 EPPR0   78
        59 004010   000013 631400 60                 EPPR1   11
        59 004011   000000 701000 xent               TSX1    STRE_6
        59 004012   000000 011000                    NOP     0

      830     7325    4                   IF FIRST_SFR_DBK = 0 THEN

   7325 59 004013   000075 235000 0                  LDA     FIRST_SFR_DBK
        59 004014   012440 601000 59                 TNZ     s:8607

      831     7326    4                       FIRST_SFR_DBK = UWA.DIRECT_REF;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:185  

   7326 59 004015   000036 236000 57                 LDQ     UWA+30
        59 004016   000075 756000 0                  STQ     FIRST_SFR_DBK
        59 004017   012440 710000 59                 TRA     s:8607

      832     7327        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:186  
      833     7328        /*******************************************************************
      834     7329                   record privacy locks
      835     7330        *******************************************************************/
      836     7331    4               CASE(%INSERT);

      837     7332    5                   IF RC_LKS.SC_LKS.XINSERT THEN DO;

   7332 59 004020   000043 234000 0                  SZN     RC_LKS
        59 004021   004036 605000 59                 TPL     s:7335

      838     7333    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7333 59 004022   000000 235000 7                  LDA     LINE_COUNT
        59 004023   000002 135007                    SBLA    2,DL
        59 004024   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004025   000034 237000 60                 LDAQ    28
        59 004026   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004027   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004030   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004031   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004032   000005 631400 60                 EPPR1   5
        59 004033   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004034   000000 011000                    NOP     0

      839     7334    5                       END;

   7334 59 004035   012440 710000 59                 TRA     s:8607

      840     7335    4                   ELSE RC_LKS.SC_LKS.XINSERT = '1'B;

   7335 59 004036   400000 236003                    LDQ     -131072,DU
        59 004037   000043 256000 0                  ORSQ    RC_LKS
        59 004040   012440 710000 59                 TRA     s:8607

      841     7336    4               CASE(%REMOVE);

      842     7337    5                   IF RC_LKS.SC_LKS.REMOVE THEN DO;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:187  

   7337 59 004041   000043 236000 0                  LDQ     RC_LKS
        59 004042   200000 316003                    CANQ    65536,DU
        59 004043   004060 600000 59                 TZE     s:7340

      843     7338    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7338 59 004044   000000 235000 7                  LDA     LINE_COUNT
        59 004045   000002 135007                    SBLA    2,DL
        59 004046   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004047   000034 237000 60                 LDAQ    28
        59 004050   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004051   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004052   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004053   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004054   000005 631400 60                 EPPR1   5
        59 004055   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004056   000000 011000                    NOP     0

      844     7339    5                       END;

   7339 59 004057   012440 710000 59                 TRA     s:8607

      845     7340    4                   ELSE RC_LKS.SC_LKS.REMOVE = '1'B;

   7340 59 004060   200000 236003                    LDQ     65536,DU
        59 004061   000043 256000 0                  ORSQ    RC_LKS
        59 004062   012440 710000 59                 TRA     s:8607

      846     7341    4               CASE(%STORE);

      847     7342    5                   IF RC_LKS.MISC.STORE THEN DO;

   7342 59 004063   000043 236000 0                  LDQ     RC_LKS
        59 004064   010000 316003                    CANQ    4096,DU
        59 004065   004102 600000 59                 TZE     s:7345

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:188  
      848     7343    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7343 59 004066   000000 235000 7                  LDA     LINE_COUNT
        59 004067   000002 135007                    SBLA    2,DL
        59 004070   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004071   000034 237000 60                 LDAQ    28
        59 004072   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004073   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004074   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004075   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004076   000005 631400 60                 EPPR1   5
        59 004077   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004100   000000 011000                    NOP     0

      849     7344    5                       END;

   7344 59 004101   012440 710000 59                 TRA     s:8607

      850     7345    4                   ELSE RC_LKS.MISC.STORE = '1'B;

   7345 59 004102   010000 236003                    LDQ     4096,DU
        59 004103   000043 256000 0                  ORSQ    RC_LKS
        59 004104   012440 710000 59                 TRA     s:8607

      851     7346    4               CASE(%DELETE);

      852     7347    5                   IF RC_LKS.MISC.DELETE THEN DO;

   7347 59 004105   000043 236000 0                  LDQ     RC_LKS
        59 004106   004000 316003                    CANQ    2048,DU
        59 004107   004124 600000 59                 TZE     s:7350

      853     7348    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7348 59 004110   000000 235000 7                  LDA     LINE_COUNT
        59 004111   000002 135007                    SBLA    2,DL
        59 004112   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:189  
        59 004113   000034 237000 60                 LDAQ    28
        59 004114   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004115   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004116   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004117   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004120   000005 631400 60                 EPPR1   5
        59 004121   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004122   000000 011000                    NOP     0

      854     7349    5                       END;

   7349 59 004123   012440 710000 59                 TRA     s:8607

      855     7350    4                   ELSE RC_LKS.MISC.DELETE = '1'B;

   7350 59 004124   004000 236003                    LDQ     2048,DU
        59 004125   000043 256000 0                  ORSQ    RC_LKS
        59 004126   012440 710000 59                 TRA     s:8607

      856     7351    4               CASE(%GET);

      857     7352    5                   IF RC_LKS.FR_LKS.GET THEN DO;

   7352 59 004127   000043 236000 0                  LDQ     RC_LKS
        59 004130   020000 316003                    CANQ    8192,DU
        59 004131   004146 600000 59                 TZE     s:7355

      858     7353    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7353 59 004132   000000 235000 7                  LDA     LINE_COUNT
        59 004133   000002 135007                    SBLA    2,DL
        59 004134   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004135   000034 237000 60                 LDAQ    28
        59 004136   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004137   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004140   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004141   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:190  
        59 004142   000005 631400 60                 EPPR1   5
        59 004143   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004144   000000 011000                    NOP     0

      859     7354    5                       END;

   7354 59 004145   012440 710000 59                 TRA     s:8607

      860     7355    4                   ELSE RC_LKS.FR_LKS.GET = '1'B;

   7355 59 004146   020000 236003                    LDQ     8192,DU
        59 004147   000043 256000 0                  ORSQ    RC_LKS
        59 004150   012440 710000 59                 TRA     s:8607

      861     7356    4               CASE(%MODIFY);

      862     7357    5                   IF RC_LKS.FR_LKS.MODIFY THEN DO;

   7357 59 004151   000043 236000 0                  LDQ     RC_LKS
        59 004152   040000 316003                    CANQ    16384,DU
        59 004153   004170 600000 59                 TZE     s:7360

      863     7358    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7358 59 004154   000000 235000 7                  LDA     LINE_COUNT
        59 004155   000002 135007                    SBLA    2,DL
        59 004156   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004157   000034 237000 60                 LDAQ    28
        59 004160   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004161   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004162   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004163   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004164   000005 631400 60                 EPPR1   5
        59 004165   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004166   000000 011000                    NOP     0

      864     7359    5                       END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:191  

   7359 59 004167   012440 710000 59                 TRA     s:8607

      865     7360    4                   ELSE RC_LKS.FR_LKS.MODIFY = '1'B;

   7360 59 004170   040000 236003                    LDQ     16384,DU
        59 004171   000043 256000 0                  ORSQ    RC_LKS
        59 004172   012440 710000 59                 TRA     s:8607

      866     7361    4               CASE(%FIND);

      867     7362    5                   IF RC_LKS.SC_LKS.FIND THEN DO;

   7362 59 004173   000043 236000 0                  LDQ     RC_LKS
        59 004174   100000 316003                    CANQ    32768,DU
        59 004175   004212 600000 59                 TZE     s:7365

      868     7363    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7363 59 004176   000000 235000 7                  LDA     LINE_COUNT
        59 004177   000002 135007                    SBLA    2,DL
        59 004200   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004201   000034 237000 60                 LDAQ    28
        59 004202   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004203   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004204   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004205   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004206   000005 631400 60                 EPPR1   5
        59 004207   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004210   000000 011000                    NOP     0

      869     7364    5                       END;

   7364 59 004211   012440 710000 59                 TRA     s:8607

      870     7365    4                   ELSE RC_LKS.SC_LKS.FIND = '1'B;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:192  
   7365 59 004212   100000 236003                    LDQ     32768,DU
        59 004213   000043 256000 0                  ORSQ    RC_LKS
        59 004214   012440 710000 59                 TRA     s:8607

      871     7366    4               CASE(%REC_LCK_NM);

      872     7367    4                   IF (LAST_STATUS ~= %RC_DEF AND LAST_STATUS ~= %KEY_DEF) THEN

   7367 59 004215   000000 236000 12                 LDQ     LAST_STATUS
        59 004216   770000 376003                    ANQ     -4096,DU
        59 004217   040000 116003                    CMPQ    16384,DU
        59 004220   004237 600000 59                 TZE     s:7370
        59 004221   030000 116003                    CMPQ    12288,DU
        59 004222   004237 600000 59                 TZE     s:7370

      873     7368    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCH_DDL);

   7368 59 004223   000000 235000 7                  LDA     LINE_COUNT
        59 004224   000002 135007                    SBLA    2,DL
        59 004225   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004226   000170 237000 60                 LDAQ    120
        59 004227   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004230   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004231   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004232   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004233   000005 631400 60                 EPPR1   5
        59 004234   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004235   000000 011000                    NOP     0
        59 004236   012440 710000 59                 TRA     s:8607

      874     7369    5                   ELSE DO;

      875     7370    5                       CALL GET_WORD;

   7370 59 004237   012467 701000 59                 TSX1    GET_WORD
        59 004240   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:193  
      876     7371    5                       CALL CHECK_RESW_DUPS;

   7371 59 004241   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 004242   000000 011000                    NOP     0

      877     7372    5                       IF RC_LKS = '0'B THEN

   7372 59 004243   000043 236000 0                  LDQ     RC_LKS
        59 004244   774000 316003                    CANQ    -2048,DU
        59 004245   004250 601000 59                 TNZ     s:7374

      878     7373    5                           RC_LKS = '1111111'B;

   7373 59 004246   774000 236003                    LDQ     -2048,DU
        59 004247   000043 756000 0                  STQ     RC_LKS

      879     7374    5                       CALL ADD_LOCK(WORD1, %RECORD_LOCK);

   7374 59 004250   000022 236000 60                 LDQ     18
        59 004251   200064 756100                    STQ     @LKNAME+1,,AUTO
        59 004252   000023 236000 60                 LDQ     19
        59 004253   200063 756100                    STQ     LNO+3,,AUTO
        59 004254   013360 701000 59                 TSX1    ADD_LOCK
        59 004255   000000 011000                    NOP     0

      880     7375    5                       END;

   7375 59 004256   012440 710000 59                 TRA     s:8607

      881     7376        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:194  
      882     7377        /******************************************************************
      883     7378                   alternate key clause
      884     7379        *******************************************************************/
      885     7380    4               CASE(%ALT_KEY_NM); /* KEY NAME IS keyname */

      886     7381        /* -make sure this clause is within a record entry
      887     7382           -check if this key name matches one given in LOC MODE INDEXED
      888     7383           -if this key hasn't been mentioned already, store an SC and SO
      889     7384           for it
      890     7385           -store an SM for this key */
      891     7386    4                   UWA.SM = '0'B;

   7386 59 004257   000000 100400                    MLR     fill='000'O
        59 004260   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 004261   000360 000060 57                 ADSC9   UWA+240                  cn=0,n=48

      892     7387    4                   IF (LAST_STATUS ~= %RC_DEF) AND (LAST_STATUS ~= %KEY_DEF) THEN

   7387 59 004262   000000 236000 12                 LDQ     LAST_STATUS
        59 004263   770000 376003                    ANQ     -4096,DU
        59 004264   040000 116003                    CMPQ    16384,DU
        59 004265   004304 600000 59                 TZE     s:7390
        59 004266   030000 116003                    CMPQ    12288,DU
        59 004267   004304 600000 59                 TZE     s:7390

      893     7388    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);

   7388 59 004270   000000 235000 7                  LDA     LINE_COUNT
        59 004271   000002 135007                    SBLA    2,DL
        59 004272   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004273   000010 237000 60                 LDAQ    8
        59 004274   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004275   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 004276   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 004277   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004300   000005 631400 60                 EPPR1   5
        59 004301   000000 701000 xent               TSX1    ZIG$D_DIAG
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:195  
        59 004302   000000 011000                    NOP     0
        59 004303   012440 710000 59                 TRA     s:8607

      894     7389    5                   ELSE DO;

      895     7390    5                       LAST_STATUS = %KEY_DEF;

   7390 59 004304   030000 236003                    LDQ     12288,DU
        59 004305   000000 756000 12                 STQ     LAST_STATUS

      896     7391    5                       DBK_SM_ALTKEY = 0;

   7391 59 004306   200010 450100                    STZ     DBK_SM_ALTKEY,,AUTO

      897     7392    5                       CALL GET_WORD;

   7392 59 004307   012467 701000 59                 TSX1    GET_WORD
        59 004310   000000 011000                    NOP     0

      898     7393    5                       CALL ADD_SN(%ZIG_RTYPE_KC,WORD1,1,LNO,FOUND,RELTYPE.KEY_IN_REC,
              7393                                EXPLCT,0);

   7393 59 004311   000134 237000 60                 LDAQ    92
        59 004312   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 004313   000172 237000 60                 LDAQ    122
        59 004314   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 004315   200060 630500                    EPPR0   LNO,,AUTO
        59 004316   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 004317   000003 236000 60                 LDQ     3
        59 004320   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 004321   000140 237000 60                 LDAQ    96
        59 004322   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 004323   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004324   000020 631400 60                 EPPR1   16
        59 004325   000000 701000 xent               TSX1    ADD_SN
        59 004326   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:196  
      899     7394    5                       IF FOUND = %FOUNDDEF THEN

   7394 59 004327   000133 235000 0                  LDA     FOUND
        59 004330   000002 115007                    CMPA    2,DL
        59 004331   004424 601000 59                 TNZ     s:7419

      900     7395    6                       DO;

      901     7396    6                           CALL FETCHNS_6('SN-SE   ');
              7396                                    /* make current SC of this altkey */

   7396 59 004332   000107 630400 60                 EPPR0   71
        59 004333   000013 631400 60                 EPPR1   11
        59 004334   000000 701000 xent               TSX1    FETCHNS_6
        59 004335   000000 011000                    NOP     0

      902     7397    6                           CALL FETCHNS_6('SC-SOSM '); /* SO or SM */

   7397 59 004336   000077 630400 60                 EPPR0   63
        59 004337   000013 631400 60                 EPPR1   11
        59 004340   000000 701000 xent               TSX1    FETCHNS_6
        59 004341   000000 011000                    NOP     0

      903     7398    7                           DO WHILE (UWA.DB_STATUS ~= '0502100');

   7398 59 004342   040000 106400                    CMPC    fill='040'O
        59 004343   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 004344   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 004345   004414 600000 59                 TZE     s:7415

      904     7399         /* verify that each key is only primary or only secondary */
      905     7400    7                               IF (((WORD1=INDX_KEY_NM AND UWA.SM.PSMODE = 0) OR

   7400 59 004346   040000 106400                    CMPC    fill='040'O
        59 004347   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 004350   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 004351   004354 601000 59                 TNZ     s:7400+6
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:197  
        59 004352   000366 235000 57                 LDA     UWA+246
        59 004353   004363 600000 59                 TZE     s:7400+13
        59 004354   040000 106400                    CMPC    fill='040'O
        59 004355   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 004356   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 004357   004402 600000 59                 TZE     s:7412
        59 004360   000366 235000 57                 LDA     UWA+246
        59 004361   000001 115007                    CMPA    1,DL
        59 004362   004402 601000 59                 TNZ     s:7412
        59 004363   040000 106400                    CMPC    fill='040'O
        59 004364   000023 000036 57                 ADSC9   UWA+19                   cn=0,n=30
        59 004365   000027 000002 58                 ADSC9   23                       cn=0,n=2
        59 004366   004402 601000 59                 TNZ     s:7412

      906     7401         /*this key is primary and a previous one wasn't */
      907     7402    7                                  (WORD1~=INDX_KEY_NM AND UWA.SM.PSMODE = 1)) AND
      908     7403         /*this key wasn't primary and a previous one was */
      909     7404    7                                  UWA.RECORD_NAME = 'SM')
      910     7405    8                               THEN DO;

      911     7406    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4154);

   7406 59 004367   000000 236000 7                  LDQ     LINE_COUNT
        59 004370   000002 136007                    SBLQ    2,DL
        59 004371   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 004372   000176 237000 60                 LDAQ    126
        59 004373   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004374   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004375   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 004376   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004377   000005 631400 60                 EPPR1   5
        59 004400   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004401   000000 011000                    NOP     0

      912     7407        /*E* ERROR: ZIG-4154-C
      913     7408             MESSAGE: The key "%U1" has been defined as both
      914     7409                      a primary and secondary key.
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:198  
      915     7410        */
      916     7411    8                                   END;

      917     7412    7                               CALL FETCHNS_6('SC-SOSM '); /* SO or SM */

   7412 59 004402   000077 630400 60                 EPPR0   63
        59 004403   000013 631400 60                 EPPR1   11
        59 004404   000000 701000 xent               TSX1    FETCHNS_6
        59 004405   000000 011000                    NOP     0

      918     7413    7                               DBK_SM_ALTKEY = UWA.DIRECT_REF;

   7413 59 004406   000036 235000 57                 LDA     UWA+30
        59 004407   200010 755100                    STA     DBK_SM_ALTKEY,,AUTO

      919     7414    7                               END;

   7414 59 004410   040000 106400                    CMPC    fill='040'O
        59 004411   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 004412   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 004413   004346 601000 59                 TNZ     s:7400

      920     7415    6                           CALL FCURR_R_6('SC      ');

   7415 59 004414   000072 630400 60                 EPPR0   58
        59 004415   000013 631400 60                 EPPR1   11
        59 004416   000000 701000 xent               TSX1    FCURR_R_6
        59 004417   000000 011000                    NOP     0

      921     7416    6                           UWA.SM = '0'B;

   7416 59 004420   000000 100400                    MLR     fill='000'O
        59 004421   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 004422   000360 000060 57                 ADSC9   UWA+240                  cn=0,n=48

      922     7417    6                           END;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:199  
   7417 59 004423   004520 710000 59                 TRA     s:7440

      923     7418    6                       ELSE DO;

      924     7419    6                           CALL CHECK_RESW_DUPS; /* add keyname to hash table */

   7419 59 004424   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 004425   000000 011000                    NOP     0

      925     7420    6                           UWA.SC = '0'B;

   7420 59 004426   000000 100400                    MLR     fill='000'O
        59 004427   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 004430   000310 000064 57                 ADSC9   UWA+200                  cn=0,n=52

      926     7421    6                           IF WORD1 = INDX_KEY_NM

   7421 59 004431   040000 106400                    CMPC    fill='040'O
        59 004432   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 004433   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 004434   004440 601000 59                 TNZ     s:7423

      927     7422    6                           THEN UWA.SC.SETTYPE = 2;

   7422 59 004435   000002 235007                    LDA     2,DL
        59 004436   000310 755000 57                 STA     UWA+200
        59 004437   004442 710000 59                 TRA     s:7424

      928     7423    6                           ELSE UWA.SC.SETTYPE = 3;

   7423 59 004440   000003 235007                    LDA     3,DL
        59 004441   000310 755000 57                 STA     UWA+200

      929     7424    6                           UWA.SC.SEQDUP = 1;

   7424 59 004442   000001 236007                    LDQ     1,DL
        59 004443   000320 756000 57                 STQ     UWA+208
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:200  

      930     7425    6                           UWA.SC.PTRNO = 3;

   7425 59 004444   000003 235007                    LDA     3,DL
        59 004445   000315 755000 57                 STA     UWA+205

      931     7426    6                           CALL STRE_6('SC      ');

   7426 59 004446   000072 630400 60                 EPPR0   58
        59 004447   000013 631400 60                 EPPR1   11
        59 004450   000000 701000 xent               TSX1    STRE_6
        59 004451   000000 011000                    NOP     0

      932     7427    6                           UWA.OA.NUMB_SC = UWA.OA.NUMB_SC + 1;

   7427 59 004452   000216 054000 57                 AOS     UWA+142

      933     7428    6                           CALL FETCHD_6('RC      ',DBK_STAR_SYSTEM_RC); /* RC */

   7428 59 004453   000200 630400 60                 EPPR0   128
        59 004454   000001 631400 60                 EPPR1   1
        59 004455   000000 701000 xent               TSX1    FETCHD_6
        59 004456   000000 011000                    NOP     0

      934     7429    6                           UWA.RC.SO = 1;

   7429 59 004457   000001 235007                    LDA     1,DL
        59 004460   000274 755000 57                 STA     UWA+188

      935     7430    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;

   7430 59 004461   000305 054000 57                 AOS     UWA+197

      936     7431    6                           CALL MODIFY_6('RC      ');

   7431 59 004462   000032 630400 60                 EPPR0   26
        59 004463   000013 631400 60                 EPPR1   11
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:201  
        59 004464   000000 701000 xent               TSX1    MODIFY_6
        59 004465   000000 011000                    NOP     0

      937     7432    6                           UWA.SO = '0'B;

   7432 59 004466   000000 100400                    MLR     fill='000'O
        59 004467   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 004470   000354 000014 57                 ADSC9   UWA+236                  cn=0,n=12

      938     7433    6                           CALL STRE_6('SO      ');

   7433 59 004471   000073 630400 60                 EPPR0   59
        59 004472   000013 631400 60                 EPPR1   11
        59 004473   000000 701000 xent               TSX1    STRE_6
        59 004474   000000 011000                    NOP     0

      939     7434    6                           HOLD_DBK = UWA.DIRECT_REF;

   7434 59 004475   000036 235000 57                 LDA     UWA+30
        59 004476   200007 755100                    STA     HOLD_DBK,,AUTO

      940     7435    6                           UWA.OA.NUMB_SO = UWA.OA.NUMB_SO + 1;

   7435 59 004477   000221 054000 57                 AOS     UWA+145

      941     7436    6                           CALL FINDNS_6('RC-SOSM ');

   7436 59 004500   000074 630400 60                 EPPR0   60
        59 004501   000013 631400 60                 EPPR1   11
        59 004502   000000 701000 xent               TSX1    FINDNS_6
        59 004503   000000 011000                    NOP     0

      942     7437    6                           CALL FINDD_6('SO      ',HOLD_DBK);

   7437 59 004504   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 004505   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 004506   000073 236000 60                 LDQ     59
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:202  
        59 004507   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 004510   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004511   000001 631400 60                 EPPR1   1
        59 004512   000000 701000 xent               TSX1    FINDD_6
        59 004513   000000 011000                    NOP     0

      943     7438    6                           CALL CONNECT_6('RC-SOSM ');

   7438 59 004514   000074 630400 60                 EPPR0   60
        59 004515   000013 631400 60                 EPPR1   11
        59 004516   000000 701000 xent               TSX1    CONNECT_6
        59 004517   000000 011000                    NOP     0

      944     7439    6                           END;

      945     7440    5                       UWA.SM.SEQDUP = 1;
              7440                                /* DUPS ALLOW; will reset if DUPS NOT ALLOW */

   7440 59 004520   000001 235007                    LDA     1,DL
        59 004521   000363 755000 57                 STA     UWA+243

      946     7441    5                       IF DBK_SM_ALTKEY ~= 0 THEN

   7441 59 004522   200010 236100                    LDQ     DBK_SM_ALTKEY,,AUTO
        59 004523   004534 600000 59                 TZE     s:7443

      947     7442    5                           CALL FINDD_6('SM      ',DBK_SM_ALTKEY);

   7442 59 004524   200010 630500                    EPPR0   DBK_SM_ALTKEY,,AUTO
        59 004525   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 004526   000102 236000 60                 LDQ     66
        59 004527   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 004530   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004531   000001 631400 60                 EPPR1   1
        59 004532   000000 701000 xent               TSX1    FINDD_6
        59 004533   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:203  
      948     7443    5                       CALL FINDD_6('RC      ',LAST_RC_DBK);

   7443 59 004534   000100 630400 60                 EPPR0   64
        59 004535   000001 631400 60                 EPPR1   1
        59 004536   000000 701000 xent               TSX1    FINDD_6
        59 004537   000000 011000                    NOP     0

      949     7444    6                       IF WORD1 = INDX_KEY_NM THEN DO; /* primary key */

   7444 59 004540   040000 106400                    CMPC    fill='040'O
        59 004541   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 004542   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 004543   004552 601000 59                 TNZ     s:7448

      950     7445    6                           INDX_KEY_NM = 'FOUND';

   7445 59 004544   040000 100400                    MLR     fill='040'O
        59 004545   000073 000005 58                 ADSC9   59                       cn=0,n=5
        59 004546   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30

      951     7446    6                           UWA.SM.PSMODE = 1;

   7446 59 004547   000001 235007                    LDA     1,DL
        59 004550   000366 755000 57                 STA     UWA+246

      952     7447    6                           END;

   7447 59 004551   004554 710000 59                 TRA     s:7449

      953     7448    5                       ELSE RC.KEY_PRESENT = 1; /* secondary key */

   7448 59 004552   000001 235007                    LDA     1,DL
        59 004553   000011 755000 0                  STA     RC+9

      954     7449    5                       CALL STRE_6('SM      ');

   7449 59 004554   000102 630400 60                 EPPR0   66
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:204  
        59 004555   000013 631400 60                 EPPR1   11
        59 004556   000000 701000 xent               TSX1    STRE_6
        59 004557   000000 011000                    NOP     0

      955     7450    5                       HOLD_DBK = UWA.DIRECT_REF;

   7450 59 004560   000036 235000 57                 LDA     UWA+30
        59 004561   200007 755100                    STA     HOLD_DBK,,AUTO

      956     7451    5                       RC.NUM_SOSM = RC.NUM_SOSM + 1;

   7451 59 004562   000015 054000 0                  AOS     RC+13

      957     7452    5                       UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;

   7452 59 004563   000222 054000 57                 AOS     UWA+146

      958     7453    5                       CALL FINDNS_6('RC-SOSM ');

   7453 59 004564   000074 630400 60                 EPPR0   60
        59 004565   000013 631400 60                 EPPR1   11
        59 004566   000000 701000 xent               TSX1    FINDNS_6
        59 004567   000000 011000                    NOP     0

      959     7454    5                       CALL FINDD_6('SM      ',HOLD_DBK);

   7454 59 004570   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 004571   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 004572   000102 236000 60                 LDQ     66
        59 004573   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 004574   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004575   000001 631400 60                 EPPR1   1
        59 004576   000000 701000 xent               TSX1    FINDD_6
        59 004577   000000 011000                    NOP     0

      960     7455    5                       CALL CONNECT_6('RC-SOSM ');

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:205  
   7455 59 004600   000074 630400 60                 EPPR0   60
        59 004601   000013 631400 60                 EPPR1   11
        59 004602   000000 701000 xent               TSX1    CONNECT_6
        59 004603   000000 011000                    NOP     0

      961     7456    5                       END;

   7456 59 004604   012440 710000 59                 TRA     s:8607

      962     7457    4               CASE(%AKC_FR); /* KEY..ASCENDING dbid */

      963     7458        /* -check for multiple reference of keyname
      964     7459           -if necessary, add SN for this field
      965     7460           -store a SFR for this record and a SCF */
      966     7461    4   AKC:
      967     7462    4                   UWA.FR = '0'B;

   7462 59 004605   000000 100400       AKC          MLR     fill='000'O
        59 004606   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 004607   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68

      968     7463    4                   IF FOUND = %FOUNDDEF THEN /* from adding KC SN */

   7463 59 004610   000133 235000 0                  LDA     FOUND
        59 004611   000002 115007                    CMPA    2,DL
        59 004612   004615 601000 59                 TNZ     s:7465

      969     7464    4                       UWA.FR.RPT = 1; /* signal multiple reference of key name */

   7464 59 004613   000001 236007                    LDQ     1,DL
        59 004614   000344 756000 57                 STQ     UWA+228

      970     7465    4                   UWA.FR.SYN = 1;

   7465 59 004615   000001 236007                    LDQ     1,DL
        59 004616   000332 756000 57                 STQ     UWA+218

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:206  
      971     7466    4                   UWA.FR.REF = 1;

   7466 59 004617   000333 756000 57                 STQ     UWA+219

      972     7467    4                   UWA.FR.F_USE = 7;

   7467 59 004620   000007 235007                    LDA     7,DL
        59 004621   000343 755000 57                 STA     UWA+227

      973     7468    4                   WORD1 = QFR_NAME;

   7468 59 004622   040000 100400                    MLR     fill='040'O
        59 004623   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 004624   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

      974     7469    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.FLD_IN_KEY,

   7469 59 004625   000110 237000 60                 LDAQ    72
        59 004626   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 004627   000202 237000 60                 LDAQ    130
        59 004630   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 004631   200060 630500                    EPPR0   LNO,,AUTO
        59 004632   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 004633   000024 236000 60                 LDQ     20
        59 004634   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 004635   000114 237000 60                 LDAQ    76
        59 004636   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 004637   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004640   000020 631400 60                 EPPR1   16
        59 004641   000000 701000 xent               TSX1    ADD_SN
        59 004642   000000 011000                    NOP     0

      975     7470    4                      EXPLCT,LAST_RC_DBK);
      976     7471    4                   UWA.FR.FR_FRH = UWA.DIRECT_REF; /* point him to his SN */

   7471 59 004643   000036 235000 57                 LDA     UWA+30
        59 004644   000352 755000 57                 STA     UWA+234
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:207  

      977     7472         /* LAST_RC_DBK is already current of set...
      978     7473            add all SFRs to front of RC-FR */
      979     7474    4                   CALL STRE_6('FR      ');
              7474                            /* rest of FR will be filled in in CLEAN_UP_REC */

   7474 59 004645   000116 630400 60                 EPPR0   78
        59 004646   000013 631400 60                 EPPR1   11
        59 004647   000000 701000 xent               TSX1    STRE_6
        59 004650   000000 011000                    NOP     0

      980     7475    4                   HOLD_DBK = UWA.DIRECT_REF;

   7475 59 004651   000036 235000 57                 LDA     UWA+30
        59 004652   200007 755100                    STA     HOLD_DBK,,AUTO

      981     7476    4                   IF FIRST_SFR_DBK = 0 THEN

   7476 59 004653   000075 236000 0                  LDQ     FIRST_SFR_DBK
        59 004654   004656 601000 59                 TNZ     s:7478

      982     7477    4                       FIRST_SFR_DBK = UWA.DIRECT_REF;

   7477 59 004655   000075 755000 0                  STA     FIRST_SFR_DBK

      983     7478    4                   UWA.C_F = '0'B;

   7478 59 004656   000000 100400                    MLR     fill='000'O
        59 004657   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 004660   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20

      984     7479    4                   UWA.C_F.SYN = 1;

   7479 59 004661   000001 236007                    LDQ     1,DL
        59 004662   000400 756000 57                 STQ     UWA+256

      985     7480    4                   UWA.C_F.CTRLTYPE = 3;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:208  

   7480 59 004663   000003 235007                    LDA     3,DL
        59 004664   000401 755000 57                 STA     UWA+257

      986     7481    4                   CALL STRE_6('C-F      ');

   7481 59 004665   000175 630400 60                 EPPR0   125
        59 004666   000013 631400 60                 EPPR1   11
        59 004667   000000 701000 xent               TSX1    STRE_6
        59 004670   000000 011000                    NOP     0

      987     7482    4                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   7482 59 004671   000224 054000 57                 AOS     UWA+148

      988     7483    4                   CALL CONNECT_6('SMSS-CF ');

   7483 59 004672   000130 630400 60                 EPPR0   88
        59 004673   000013 631400 60                 EPPR1   11
        59 004674   000000 701000 xent               TSX1    CONNECT_6
        59 004675   000000 011000                    NOP     0

      989     7484    4                   CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   7484 59 004676   000126 237000 60                 LDAQ    86
        59 004677   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004700   000125 236000 60                 LDQ     85
        59 004701   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 004702   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 004703   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 004704   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004705   000124 631400 60                 EPPR1   84
        59 004706   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        59 004707   000000 011000                    NOP     0
        59 004710   012440 710000 59                 TRA     s:8607

      990     7485    4                      'FR      ', 'C-F     ' );
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:209  
      991     7486    4               CASE(%AKC_QRC);

      992     7487    4                   CALL GET_WORD;

   7487 59 004711   012467 701000 59                 TSX1    GET_WORD
        59 004712   000000 011000                    NOP     0

      993     7488    4                   IF WORD1 ~= LAST_RC_NAME THEN

   7488 59 004713   040000 106400                    CMPC    fill='040'O
        59 004714   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 004715   000050 000036 0                  ADSC9   LAST_RC_NAME             cn=0,n=30
        59 004716   004751 600000 59                 TZE     s:7500

      994     7489    5                   DO;

      995     7490    5                       CALL INDEX(CT1,' ',QFR_NAME);

   7490 59 004717   000000 124400                    SCM     mask='000'O
        59 004720   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 004721   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 004722   200050 000100                    ARG     CT1,,AUTO

      996     7491    5                       CALL SET_FIELDS(1,CT1,QFR_NAME);

   7491 59 004723   000204 236000 60                 LDQ     132
        59 004724   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 004725   200050 630500                    EPPR0   CT1,,AUTO
        59 004726   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 004727   000003 236000 60                 LDQ     3
        59 004730   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 004731   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004732   000005 631400 60                 EPPR1   5
        59 004733   000000 701000 xent               TSX1    SET_FIELDS
        59 004734   000000 011000                    NOP     0

      997     7492    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4809);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:210  

   7492 59 004735   000000 235000 7                  LDA     LINE_COUNT
        59 004736   000002 135007                    SBLA    2,DL
        59 004737   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 004740   000206 237000 60                 LDAQ    134
        59 004741   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 004742   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 004743   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 004744   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 004745   000005 631400 60                 EPPR1   5
        59 004746   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 004747   000000 011000                    NOP     0

      998     7493         /*E* ERROR: ZIG-4809-C
      999     7494                    MESSAGE: The record name qualifier used is not the correct
     1000     7495                             one for field "%U1".  Qualifier ignored.
     1001     7496                 */
     1002     7497    5                       END;

   7497 59 004750   012440 710000 59                 TRA     s:8607

     1003     7498    4                   ELSE
     1004     7499    5                   DO;

     1005     7500    5                       GOTO AKC;

   7500 59 004751   004605 710000 59                 TRA     AKC

     1006     7501    5                       END;
     1007     7502    4               CASE(%AKC_QFR);

     1008     7503    4                   CALL GET_WORD;

   7503 59 004752   012467 701000 59                 TSX1    GET_WORD
        59 004753   000000 011000                    NOP     0

     1009     7504    4                   QFR_NAME = WORD1;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:211  

   7504 59 004754   040000 100400                    MLR     fill='040'O
        59 004755   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 004756   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 004757   012440 710000 59                 TRA     s:8607

     1010     7505    4               CASE(%NOT2); /* KEY...ASCENDING...DUPS ARE NOT ALLOWED */

     1011     7506        /* -update the relevant SC and SM  for this key */
     1012     7507    4                   IF INDX_KEY_NM = 'FOUND' THEN /* primary key */

   7507 59 004760   040000 106400                    CMPC    fill='040'O
        59 004761   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 004762   000073 000005 58                 ADSC9   59                       cn=0,n=5
        59 004763   004767 601000 59                 TNZ     s:7509

     1013     7508    4                       INDX_KEY_NM = 'NOT';

   7508 59 004764   040000 100400                    MLR     fill='040'O
        59 004765   000100 000003 58                 ADSC9   64                       cn=0,n=3
        59 004766   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30

     1014     7509    4                   IF UWA.SC.SEQDUP ~= 2 THEN /* a previous altkey was DUP allowed */

   7509 59 004767   000320 235000 57                 LDA     UWA+208
        59 004770   000002 115007                    CMPA    2,DL
        59 004771   005046 600000 59                 TZE     s:7527

     1015     7510    4                       IF UWA.FR.RPT = 1 THEN /* a previous altkey mention was made */

   7510 59 004772   000344 235000 57                 LDA     UWA+228
        59 004773   000001 115007                    CMPA    1,DL
        59 004774   005011 601000 59                 TNZ     s:7517

     1016     7511    4                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4148);

   7511 59 004775   000000 235000 7                  LDA     LINE_COUNT
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:212  
        59 004776   000002 135007                    SBLA    2,DL
        59 004777   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005000   000212 237000 60                 LDAQ    138
        59 005001   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005002   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005003   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005004   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005005   000005 631400 60                 EPPR1   5
        59 005006   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005007   000000 011000                    NOP     0
        59 005010   012440 710000 59                 TRA     s:8607

     1017     7512         /*E* ERROR: ZIG-4148-C
     1018     7513                      MESSAGE: DUPLICATES have been specified for this key
     1019     7514                               so DUPLICATES NOT cannot now be specified.
     1020     7515                   */
     1021     7516    5                       ELSE DO; /* this is first mention of this altkey */

     1022     7517    5                           CALL FCURR_R_6('SC      ');

   7517 59 005011   000072 630400 60                 EPPR0   58
        59 005012   000013 631400 60                 EPPR1   11
        59 005013   000000 701000 xent               TSX1    FCURR_R_6
        59 005014   000000 011000                    NOP     0

     1023     7518    5                           CALL FETCHD_6('SC      ',UWA.DIRECT_REF);

   7518 59 005015   000214 630400 60                 EPPR0   140
        59 005016   000001 631400 60                 EPPR1   1
        59 005017   000000 701000 xent               TSX1    FETCHD_6
        59 005020   000000 011000                    NOP     0

     1024     7519    5                           UWA.SC.SEQDUP = 2;

   7519 59 005021   000002 235007                    LDA     2,DL
        59 005022   000320 755000 57                 STA     UWA+208

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:213  
     1025     7520    5                           CALL MODIFY_6('SC      ');

   7520 59 005023   000072 630400 60                 EPPR0   58
        59 005024   000013 631400 60                 EPPR1   11
        59 005025   000000 701000 xent               TSX1    MODIFY_6
        59 005026   000000 011000                    NOP     0

     1026     7521    5                           CALL FCURR_R_6('SM      ');

   7521 59 005027   000102 630400 60                 EPPR0   66
        59 005030   000013 631400 60                 EPPR1   11
        59 005031   000000 701000 xent               TSX1    FCURR_R_6
        59 005032   000000 011000                    NOP     0

     1027     7522    5                           CALL FETCHD_6('SM      ',UWA.DIRECT_REF);

   7522 59 005033   000216 630400 60                 EPPR0   142
        59 005034   000001 631400 60                 EPPR1   1
        59 005035   000000 701000 xent               TSX1    FETCHD_6
        59 005036   000000 011000                    NOP     0

     1028     7523    5                           UWA.SM.SEQDUP = 2;

   7523 59 005037   000002 235007                    LDA     2,DL
        59 005040   000363 755000 57                 STA     UWA+243

     1029     7524    5                           CALL MODIFY_6('SM      ');

   7524 59 005041   000102 630400 60                 EPPR0   66
        59 005042   000013 631400 60                 EPPR1   11
        59 005043   000000 701000 xent               TSX1    MODIFY_6
        59 005044   000000 011000                    NOP     0

     1030     7525    5                           END;

   7525 59 005045   012440 710000 59                 TRA     s:8607

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:214  
     1031     7526    5                   ELSE DO; /* prev altkey was DUPS NOT and so is this one */

     1032     7527    5                       CALL FCURR_R_6('SM      ');

   7527 59 005046   000102 630400 60                 EPPR0   66
        59 005047   000013 631400 60                 EPPR1   11
        59 005050   000000 701000 xent               TSX1    FCURR_R_6
        59 005051   000000 011000                    NOP     0

     1033     7528    5                       CALL FETCHD_6('SM      ',UWA.DIRECT_REF);

   7528 59 005052   000216 630400 60                 EPPR0   142
        59 005053   000001 631400 60                 EPPR1   1
        59 005054   000000 701000 xent               TSX1    FETCHD_6
        59 005055   000000 011000                    NOP     0

     1034     7529    5                       UWA.SM.SEQDUP = 2;

   7529 59 005056   000002 235007                    LDA     2,DL
        59 005057   000363 755000 57                 STA     UWA+243

     1035     7530    5                       CALL MODIFY_6('SM      ');

   7530 59 005060   000102 630400 60                 EPPR0   66
        59 005061   000013 631400 60                 EPPR1   11
        59 005062   000000 701000 xent               TSX1    MODIFY_6
        59 005063   000000 011000                    NOP     0

     1036     7531    5                       END;

   7531 59 005064   012440 710000 59                 TRA     s:8607

     1037     7532        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:215  
     1038     7533        /********************************************************************
     1039     7534                   data entry
     1040     7535        ********************************************************************/
     1041     7536    4               CASE(%FR_ENT);

     1042     7537    4                   IF NEED_LARGER_SCHEMA

   7537 59 005065   000000 234000 14                 SZN     NEED_LARGER_SCHEMA
        59 005066   012440 605000 59                 TPL     s:8607

     1043     7538    5                   THEN DO;

     1044     7539    5                       CALL SF_CLOSE(1,STATUS);

   7539 59 005067   200053 631500                    EPPR1   STATUS,,AUTO
        59 005070   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005071   000003 236000 60                 LDQ     3
        59 005072   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005073   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005074   000001 631400 60                 EPPR1   1
        59 005075   000000 701000 xent               TSX1    SF_CLOSE
        59 005076   000000 011000                    NOP     0

     1045     7540    5                       CALL SF_OPEN(1,STATUS);

   7540 59 005077   200053 630500                    EPPR0   STATUS,,AUTO
        59 005100   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005101   000003 236000 60                 LDQ     3
        59 005102   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005103   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005104   000001 631400 60                 EPPR1   1
        59 005105   000000 701000 xent               TSX1    SF_OPEN
        59 005106   000000 011000                    NOP     0

     1046     7541    5                       NEED_LARGER_SCHEMA = '0'B;

   7541 59 005107   000000 450000 14                 STZ     NEED_LARGER_SCHEMA
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:216  

     1047     7542    5                       CALL RESTORE_CURRENTS;

   7542 59 005110   013326 701000 59                 TSX1    RESTORE_CURRENTS
        59 005111   000000 011000                    NOP     0

     1048     7543    5                       CALL FETCHD_6('RC      ',LAST_RC_DBK);

   7543 59 005112   000100 630400 60                 EPPR0   64
        59 005113   000001 631400 60                 EPPR1   1
        59 005114   000000 701000 xent               TSX1    FETCHD_6
        59 005115   000000 011000                    NOP     0

     1049     7544    5                       END;

   7544 59 005116   012440 710000 59                 TRA     s:8607

     1050     7545    4               CASE(%LEVEL_NUM); /* level_number... */

     1051     7546    4                   IF (LAST_STATUS = %RC_DEF) OR (LAST_STATUS = %FR_DEF)

   7546 59 005117   000000 236000 12                 LDQ     LAST_STATUS
        59 005120   770000 376003                    ANQ     -4096,DU
        59 005121   040000 116003                    CMPQ    16384,DU
        59 005122   005127 600000 59                 TZE     s:7549
        59 005123   050000 116003                    CMPQ    20480,DU
        59 005124   005127 600000 59                 TZE     s:7549
        59 005125   030000 116003                    CMPQ    12288,DU
        59 005126   012440 601000 59                 TNZ     s:8607

     1052     7547    4                      OR (LAST_STATUS = %KEY_DEF)
     1053     7548    5                   THEN DO;

     1054     7549    5                       CALL GET_NUM;

   7549 59 005127   012441 701000 59                 TSX1    GET_NUM
        59 005130   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:217  

     1055     7550    5                       IF LEV_NUM = 0 THEN /* first field in record */

   7550 59 005131   000125 235000 0                  LDA     LEV_NUM
        59 005132   005136 601000 59                 TNZ     s:7553

     1056     7551    5                           LEV_NUM = NUM;

   7551 59 005133   000000 236000 1                  LDQ     NUM
        59 005134   000125 756000 0                  STQ     LEV_NUM
        59 005135   005155 710000 59                 TRA     s:7561

     1057     7552    5                       ELSE
     1058     7553    5                           IF LEV_NUM ~= NUM /* compare with prev lev num */

   7553 59 005136   000125 236000 0                  LDQ     LEV_NUM
        59 005137   005142 604000 59                 TMI     s:7555
        59 005140   000000 116000 1                  CMPQ    NUM
        59 005141   005155 600000 59                 TZE     s:7561

     1059     7554    6                           THEN DO;

     1060     7555    6                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4057);

   7555 59 005142   000000 235000 7                  LDA     LINE_COUNT
        59 005143   000002 135007                    SBLA    2,DL
        59 005144   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005145   000220 237000 60                 LDAQ    144
        59 005146   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005147   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005150   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005151   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005152   000005 631400 60                 EPPR1   5
        59 005153   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005154   000000 011000                    NOP     0

     1061     7556        /*E* ERROR: ZIG-4057-C
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:218  
     1062     7557             MESSAGE: The level entry %U1 is inconsistent with
     1063     7558                      others of this subentry.
     1064     7559        */
     1065     7560    6                               END;

     1066     7561    5                       IF (NUM < 1) OR (NUM > 99) THEN

   7561 59 005155   000000 235000 1                  LDA     NUM
        59 005156   005161 604400 59                 TMOZ    s:7562
        59 005157   000143 115007                    CMPA    99,DL
        59 005160   005174 604400 59                 TMOZ    s:7566

     1067     7562    5                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4059);

   7562 59 005161   000000 236000 7                  LDQ     LINE_COUNT
        59 005162   000002 136007                    SBLQ    2,DL
        59 005163   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005164   000224 237000 60                 LDAQ    148
        59 005165   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005166   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005167   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005170   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005171   000005 631400 60                 EPPR1   5
        59 005172   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005173   000000 011000                    NOP     0

     1068     7563        /*E* ERROR: ZIG-4059-C
     1069     7564             MESSAGE: The level numbers must be in the range of 1-99.
     1070     7565        */
     1071     7566    5                       UWA.FR.LEVEL = NUM;

   7566 59 005174   000000 235000 1                  LDA     NUM
        59 005175   000346 755000 57                 STA     UWA+230

     1072     7567    5                       END;

   7567 59 005176   012440 710000 59                 TRA     s:8607
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:219  

     1073     7568    4               CASE(%FR_NM); /* level_number fieldname */

     1074     7569        /* -ensure that this field entry is within a record entry */
     1075     7570    4                   UWA.FR = '0'B;

   7570 59 005177   000000 100400                    MLR     fill='000'O
        59 005200   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 005201   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68

     1076     7571    4                   TYPE = '0'B;

   7571 59 005202   000032 450000 0                  STZ     TYPE

     1077     7572    4                   NEG_SCALE = '0'B;

   7572 59 005203   000130 450000 0                  STZ     NEG_SCALE

     1078     7573    4                   IF (LAST_STATUS ~= %RC_DEF) AND (LAST_STATUS ~= %FR_DEF) AND

   7573 59 005204   000000 236000 12                 LDQ     LAST_STATUS
        59 005205   770000 376003                    ANQ     -4096,DU
        59 005206   040000 116003                    CMPQ    16384,DU
        59 005207   005231 600000 59                 TZE     s:7580
        59 005210   050000 116003                    CMPQ    20480,DU
        59 005211   005231 600000 59                 TZE     s:7580
        59 005212   030000 116003                    CMPQ    12288,DU
        59 005213   005231 600000 59                 TZE     s:7580

     1079     7574    4                      (LAST_STATUS ~= %KEY_DEF)
     1080     7575    5                   THEN DO;

     1081     7576    5                       MOD_FR_OK = '0'B;

   7576 59 005214   000126 450000 0                  STZ     MOD_FR_OK

     1082     7577    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:220  

   7577 59 005215   000000 235000 7                  LDA     LINE_COUNT
        59 005216   000002 135007                    SBLA    2,DL
        59 005217   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005220   000010 237000 60                 LDAQ    8
        59 005221   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005222   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005223   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005224   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005225   000005 631400 60                 EPPR1   5
        59 005226   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005227   000000 011000                    NOP     0

     1083     7578    5                       END;

   7578 59 005230   012440 710000 59                 TRA     s:8607

     1084     7579    5                   ELSE DO;

     1085     7580    5                       MOD_FR_OK = '1'B;

   7580 59 005231   400000 236003                    LDQ     -131072,DU
        59 005232   000126 756000 0                  STQ     MOD_FR_OK

     1086     7581    5                       LAST_STATUS = %FR_DEF;

   7581 59 005233   050000 236003                    LDQ     20480,DU
        59 005234   000000 756000 12                 STQ     LAST_STATUS

     1087     7582    5                       CALL GET_WORD;

   7582 59 005235   012467 701000 59                 TSX1    GET_WORD
        59 005236   000000 011000                    NOP     0

     1088     7583    5                       CALL CHECK_RESW_DUPS;

   7583 59 005237   012535 701000 59                 TSX1    CHECK_RESW_DUPS
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:221  
        59 005240   000000 011000                    NOP     0

     1089     7584    5                       CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,
              7584                                LAST_RC_DBK);

   7584 59 005241   000226 237000 60                 LDAQ    150
        59 005242   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 005243   000026 237000 60                 LDAQ    22
        59 005244   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 005245   200060 630500                    EPPR0   LNO,,AUTO
        59 005246   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 005247   000003 236000 60                 LDQ     3
        59 005250   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 005251   000114 237000 60                 LDAQ    76
        59 005252   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 005253   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005254   000020 631400 60                 EPPR1   16
        59 005255   000000 701000 xent               TSX1    ADD_SN
        59 005256   000000 011000                    NOP     0

     1090     7585    5                       LAST_LOCKABLE_DBK = UWA.DIRECT_REF;

   7585 59 005257   000036 235000 57                 LDA     UWA+30
        59 005260   000044 755000 0                  STA     LAST_LOCKABLE_DBK

     1091     7586         /* If found,then a forward reference was made to this item
     1092     7587            in loc mode calc or key is keyname
     1093     7588            ascending clause.
     1094     7589            For loc mode
     1095     7590            calc references, an RFR has already been made and must be
     1096     7591            fetched in order to be filled in.  For alternate keys, an
     1097     7592            SFR has been made, but not connected to the SN, and a RFR
     1098     7593            must be made.  The SFR will get filled in later in CLEAN_UP_REC.
     1099     7594            Of course, if no forward reference has been made, a RFR
     1100     7595            must be generated. */
     1101     7596    6                       IF (FOUND = %FOUNDDEF) THEN DO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:222  
   7596 59 005261   000133 236000 0                  LDQ     FOUND
        59 005262   000002 116007                    CMPQ    2,DL
        59 005263   005277 601000 59                 TNZ     s:7603

     1102     7597    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4048);

   7597 59 005264   000000 235000 7                  LDA     LINE_COUNT
        59 005265   000002 135007                    SBLA    2,DL
        59 005266   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005267   000230 237000 60                 LDAQ    152
        59 005270   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005271   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005272   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005273   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005274   000005 631400 60                 EPPR1   5
        59 005275   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005276   000000 011000                    NOP     0

     1103     7598        /*E* ERROR: ZIG-4048-C
     1104     7599             MESSAGE: The field "%U1" has already been declared in this
     1105     7600                      record.
     1106     7601        */
     1107     7602    6                           END;

     1108     7603    5                       CALL FETCHNS_6('SN-SE   '); /* get the RFR for calc */

   7603 59 005277   000107 630400 60                 EPPR0   71
        59 005300   000013 631400 60                 EPPR1   11
        59 005301   000000 701000 xent               TSX1    FETCHNS_6
        59 005302   000000 011000                    NOP     0

     1109     7604         /* for altkeys, no FR will be found */
     1110     7605    5                       IF (UWA.DB_STATUS = '0502100') OR /* or alternate key */

   7605 59 005303   040000 106400                    CMPC    fill='040'O
        59 005304   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 005305   000071 000007 58                 ADSC9   57                       cn=0,n=7
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:223  
        59 005306   005311 600000 59                 TZE     s:7608
        59 005307   000133 235000 0                  LDA     FOUND
        59 005310   005346 601000 59                 TNZ     s:7622

     1111     7606    6                          FOUND = %NOTFOUND THEN DO;
              7606                                   /* no forward reference was made */

     1112     7607         /* restore owner for connect */
     1113     7608    6                           CALL FINDD_6('SN      ',LAST_LOCKABLE_DBK);

   7608 59 005311   000232 630400 60                 EPPR0   154
        59 005312   000001 631400 60                 EPPR1   1
        59 005313   000000 701000 xent               TSX1    FINDD_6
        59 005314   000000 011000                    NOP     0

     1114     7609         /* add all RFRs after all SFRs */
     1115     7610    6                           IF FIRST_SFR_DBK ~= 0

   7610 59 005315   000075 235000 0                  LDA     FIRST_SFR_DBK
        59 005316   005327 600000 59                 TZE     s:7615

     1116     7611    7                           THEN DO;

     1117     7612    7                               CALL FINDD_6('FR      ',FIRST_SFR_DBK);

   7612 59 005317   000116 630400 60                 EPPR0   78
        59 005320   000001 631400 60                 EPPR1   1
        59 005321   000000 701000 xent               TSX1    FINDD_6
        59 005322   000000 011000                    NOP     0

     1118     7613    7                               CALL FCURR_R_6('SN      ');

   7613 59 005323   000016 630400 60                 EPPR0   14
        59 005324   000013 631400 60                 EPPR1   11
        59 005325   000000 701000 xent               TSX1    FCURR_R_6
        59 005326   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:224  
     1119     7614    7                               END;

     1120     7615    6                           UWA.FR = '0'B;

   7615 59 005327   000000 100400                    MLR     fill='000'O
        59 005330   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 005331   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68

     1121     7616    6                           UWA.FR.FTYPE = 99;

   7616 59 005332   000143 235007                    LDA     99,DL
        59 005333   000334 755000 57                 STA     UWA+220

     1122     7617    6                           CALL STRE_6('FR      '); /* real FR */

   7617 59 005334   000116 630400 60                 EPPR0   78
        59 005335   000013 631400 60                 EPPR1   11
        59 005336   000000 701000 xent               TSX1    STRE_6
        59 005337   000000 011000                    NOP     0

     1123     7618    6                           UWA.OA.NUMB_FR = UWA.OA.NUMB_FR + 1;

   7618 59 005340   000220 054000 57                 AOS     UWA+144

     1124     7619    6                           CALL CONNECT_6('SN-SE   ');

   7619 59 005341   000107 630400 60                 EPPR0   71
        59 005342   000013 631400 60                 EPPR1   11
        59 005343   000000 701000 xent               TSX1    CONNECT_6
        59 005344   000000 011000                    NOP     0

     1125     7620    6                           END;

   7620 59 005345   005370 710000 59                 TRA     s:7627

     1126     7621    6                       ELSE DO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:225  
     1127     7622    6                           HOLD_DBK = UWA.DIRECT_REF;

   7622 59 005346   000036 236000 57                 LDQ     UWA+30
        59 005347   200007 756100                    STQ     HOLD_DBK,,AUTO

     1128     7623    6                           CALL FINDOS_6('RC-FR   ');

   7623 59 005350   000234 630400 60                 EPPR0   156
        59 005351   000013 631400 60                 EPPR1   11
        59 005352   000000 701000 xent               TSX1    FINDOS_6
        59 005353   000000 011000                    NOP     0

     1129     7624    6                           CALL FINDD_6('FR      ',HOLD_DBK);

   7624 59 005354   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 005355   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005356   000116 236000 60                 LDQ     78
        59 005357   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005360   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005361   000001 631400 60                 EPPR1   1
        59 005362   000000 701000 xent               TSX1    FINDD_6
        59 005363   000000 011000                    NOP     0

     1130     7625    6                           CALL MODIFYMEM_6('FR      ');

   7625 59 005364   000116 630400 60                 EPPR0   78
        59 005365   000013 631400 60                 EPPR1   11
        59 005366   000000 701000 xent               TSX1    MODIFYMEM_6
        59 005367   000000 011000                    NOP     0

     1131     7626    6                           END;

     1132     7627    5                       UWA.FR.F_OCCURS = 0;

   7627 59 005370   000345 450000 57                 STZ     UWA+229

     1133     7628    5                       UWA.FR.LEVEL = NUM;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:226  

   7628 59 005371   000000 235000 1                  LDA     NUM
        59 005372   000346 755000 57                 STA     UWA+230

     1134     7629    5                       END;

   7629 59 005373   012440 710000 59                 TRA     s:8607

     1135     7630    4               CASE(%IPRIV);

     1136     7631    4                   RC_LKS.FR_LKS = '0'B;

   7631 59 005374   000235 236000 60                 LDQ     157
        59 005375   000043 356000 0                  ANSQ    RC_LKS
        59 005376   012440 710000 59                 TRA     s:8607

     1137     7632    4               CASE(%FIXED); /* TYPE IS FIXED BINARY */

     1138     7633    4                   UWA.FR.FTYPE = 1; /* DEFAULT */

   7633 59 005377   000001 235007                    LDA     1,DL
        59 005400   000334 755000 57                 STA     UWA+220
        59 005401   012440 710000 59                 TRA     s:8607

     1139     7634    4               CASE(%FLOAT); /* TYPE IS FLOAT HEX */

     1140     7635    4                   UWA.FR.FTYPE = 11; /* DEFAULT */

   7635 59 005402   000013 235007                    LDA     11,DL
        59 005403   000334 755000 57                 STA     UWA+220
        59 005404   012440 710000 59                 TRA     s:8607

     1141     7636    4               CASE(%BINARY);

     1142     7637    4                   UWA.FR.PREC = 35; /* DEFAULT */

   7637 59 005405   000043 235007                    LDA     35,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:227  
        59 005406   000335 755000 57                 STA     UWA+221

     1143     7638    4                   IF UWA.FR.FTYPE ~= 11 THEN UWA.FR.FTYPE = 1;

   7638 59 005407   000334 236000 57                 LDQ     UWA+220
        59 005410   000013 116007                    CMPQ    11,DL
        59 005411   005414 600000 59                 TZE     s:7639

   7638 59 005412   000001 235007                    LDA     1,DL
        59 005413   000334 755000 57                 STA     UWA+220

     1144     7639    5                   IF TYPE THEN DO;

   7639 59 005414   000032 234000 0                  SZN     TYPE
        59 005415   005432 605000 59                 TPL     s:7642

     1145     7640    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7640 59 005416   000000 235000 7                  LDA     LINE_COUNT
        59 005417   000002 135007                    SBLA    2,DL
        59 005420   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005421   000054 237000 60                 LDAQ    44
        59 005422   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005423   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005424   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005425   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005426   000005 631400 60                 EPPR1   5
        59 005427   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005430   000000 011000                    NOP     0

     1146     7641    5                       END;

   7641 59 005431   012440 710000 59                 TRA     s:8607

     1147     7642    4                   ELSE TYPE = '1'B;

   7642 59 005432   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:228  
        59 005433   000032 756000 0                  STQ     TYPE
        59 005434   012440 710000 59                 TRA     s:8607

     1148     7643    4               CASE(%BIN_INT); /* TYPE IS ...BINARY integer */

     1149     7644    4                   CALL GET_NUM;

   7644 59 005435   012441 701000 59                 TSX1    GET_NUM
        59 005436   000000 011000                    NOP     0

     1150     7645    4                   UWA.FR.PREC = NUM;

   7645 59 005437   000000 235000 1                  LDA     NUM
        59 005440   000335 755000 57                 STA     UWA+221

     1151     7646    4                   IF UWA.FR.FTYPE = 1 THEN /* FIXED */

   7646 59 005441   000334 236000 57                 LDQ     UWA+220
        59 005442   000001 116007                    CMPQ    1,DL
        59 005443   005467 601000 59                 TNZ     s:7656

     1152     7647    4                       IF NUM <= 17 THEN /* HALF WORD */

   7647 59 005444   000021 115007                    CMPA    17,DL
        59 005445   005451 605400 59                 TPNZ    s:7650

     1153     7648    4                           UWA.FR.FTYPE = 2;

   7648 59 005446   000002 235007                    LDA     2,DL
        59 005447   000334 755000 57                 STA     UWA+220
        59 005450   012440 710000 59                 TRA     s:8607

     1154     7649    4                       ELSE /* WHOLE WORD */
     1155     7650    4                           IF NUM >= 36 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              7650                                    4053);

   7650 59 005451   000044 115007                    CMPA    36,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:229  
        59 005452   012440 604000 59                 TMI     s:8607

   7650 59 005453   000000 235000 7                  LDA     LINE_COUNT
        59 005454   000002 135007                    SBLA    2,DL
        59 005455   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005456   000240 237000 60                 LDAQ    160
        59 005457   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005460   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005461   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005462   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005463   000005 631400 60                 EPPR1   5
        59 005464   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005465   000000 011000                    NOP     0
        59 005466   012440 710000 59                 TRA     s:8607

     1156     7651        /*E* ERROR: ZIG-4053-C
     1157     7652             MESSAGE: The number of binary digits  must be 1-35.
     1158     7653        */
     1159     7654    4                           ELSE ; /* DEFAULTS HAVE ALREADY BEEN SET */
     1160     7655    4                   ELSE /* FLOAT */
     1161     7656    4                       IF NUM = 71 THEN /* DOUBLE PRECISION */

   7656 59 005467   000107 115007                    CMPA    71,DL
        59 005470   005474 601000 59                 TNZ     s:7659

     1162     7657    4                           UWA.FR.FTYPE = 12;

   7657 59 005471   000014 235007                    LDA     12,DL
        59 005472   000334 755000 57                 STA     UWA+220
        59 005473   012440 710000 59                 TRA     s:8607

     1163     7658    4                       ELSE /* SINGLE PRECISION */
     1164     7659    5                           IF NUM ~= 35 THEN DO;

   7659 59 005474   000043 115007                    CMPA    35,DL
        59 005475   012440 600000 59                 TZE     s:8607

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:230  
     1165     7660    5                               UWA.FR.PREC = 35;

   7660 59 005476   000043 235007                    LDA     35,DL
        59 005477   000335 755000 57                 STA     UWA+221

     1166     7661    5                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4161);

   7661 59 005500   000000 235000 7                  LDA     LINE_COUNT
        59 005501   000002 135007                    SBLA    2,DL
        59 005502   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005503   000242 237000 60                 LDAQ    162
        59 005504   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005505   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005506   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005507   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005510   000005 631400 60                 EPPR1   5
        59 005511   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005512   000000 011000                    NOP     0

     1167     7662        /*E* ERROR: ZIG-4161-C
     1168     7663             MESSAGE: The number of binary digits must be 35 or 71.
     1169     7664                      The default value of 35 has been assigned.
     1170     7665        */
     1171     7666    5                               END;

   7666 59 005513   012440 710000 59                 TRA     s:8607

     1172     7667    4               CASE(%DEC_INT); /* TYPE IS DECIMAL integer...*/

     1173     7668    5                   IF TYPE THEN DO;

   7668 59 005514   000032 234000 0                  SZN     TYPE
        59 005515   005532 605000 59                 TPL     s:7671

     1174     7669    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7669 59 005516   000000 235000 7                  LDA     LINE_COUNT
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:231  
        59 005517   000002 135007                    SBLA    2,DL
        59 005520   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005521   000054 237000 60                 LDAQ    44
        59 005522   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005523   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005524   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005525   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005526   000005 631400 60                 EPPR1   5
        59 005527   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005530   000000 011000                    NOP     0

     1175     7670    5                       END;

   7670 59 005531   005534 710000 59                 TRA     s:7672

     1176     7671    4                   ELSE TYPE = '1'B;

   7671 59 005532   400000 236003                    LDQ     -131072,DU
        59 005533   000032 756000 0                  STQ     TYPE

     1177     7672    4                   CALL GET_NUM;

   7672 59 005534   012441 701000 59                 TSX1    GET_NUM
        59 005535   000000 011000                    NOP     0

     1178     7673    5                   IF NUM > 63 THEN DO;

   7673 59 005536   000000 235000 1                  LDA     NUM
        59 005537   000077 115007                    CMPA    63,DL
        59 005540   005554 604400 59                 TMOZ    s:7679

     1179     7674    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4052);

   7674 59 005541   000000 236000 7                  LDQ     LINE_COUNT
        59 005542   000002 136007                    SBLQ    2,DL
        59 005543   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005544   000246 237000 60                 LDAQ    166
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:232  
        59 005545   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005546   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005547   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005550   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005551   000005 631400 60                 EPPR1   5
        59 005552   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005553   000000 011000                    NOP     0

     1180     7675        /*E* ERROR: ZIG-4052-C
     1181     7676             MESSAGE: The number of decimal digits allowed is 1-63.
     1182     7677        */
     1183     7678    5                       END;

     1184     7679    4                   UWA.FR.FTYPE = 3;

   7679 59 005554   000003 235007                    LDA     3,DL
        59 005555   000334 755000 57                 STA     UWA+220

     1185     7680    4                   UWA.FR.PREC = NUM;

   7680 59 005556   000000 236000 1                  LDQ     NUM
        59 005557   000335 756000 57                 STQ     UWA+221
        59 005560   012440 710000 59                 TRA     s:8607

     1186     7681    4               CASE(%PLUS);

     1187     7682    4                   IF NUM > 62 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4058);

   7682 59 005561   000000 235000 1                  LDA     NUM
        59 005562   000076 115007                    CMPA    62,DL
        59 005563   012440 604400 59                 TMOZ    s:8607

   7682 59 005564   000000 235000 7                  LDA     LINE_COUNT
        59 005565   000002 135007                    SBLA    2,DL
        59 005566   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005567   000250 237000 60                 LDAQ    168
        59 005570   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:233  
        59 005571   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005572   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005573   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005574   000005 631400 60                 EPPR1   5
        59 005575   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005576   000000 011000                    NOP     0
        59 005577   012440 710000 59                 TRA     s:8607

     1188     7683        /*E* ERROR: ZIG-4058-C
     1189     7684             MESSAGE: The number of digits in a signed decimal item cannot
     1190     7685                      exceed 62.
     1191     7686        */
     1192     7687    4               CASE(%MINUS);

     1193     7688    4                   NEG_SCALE = '1'B;

   7688 59 005600   400000 236003                    LDQ     -131072,DU
        59 005601   000130 756000 0                  STQ     NEG_SCALE

     1194     7689    4                   IF NUM > 62 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4058);

   7689 59 005602   000000 235000 1                  LDA     NUM
        59 005603   000076 115007                    CMPA    62,DL
        59 005604   012440 604400 59                 TMOZ    s:8607

   7689 59 005605   000000 235000 7                  LDA     LINE_COUNT
        59 005606   000002 135007                    SBLA    2,DL
        59 005607   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005610   000250 237000 60                 LDAQ    168
        59 005611   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005612   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005613   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005614   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005615   000005 631400 60                 EPPR1   5
        59 005616   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005617   000000 011000                    NOP     0
        59 005620   012440 710000 59                 TRA     s:8607
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:234  

     1195     7690    4               CASE(%SCALE_INT); /* TYPE IS DECIMAL n,integer... */

     1196     7691    4                   CALL GET_NUM;

   7691 59 005621   012441 701000 59                 TSX1    GET_NUM
        59 005622   000000 011000                    NOP     0

     1197     7692    5                   IF (NUM < -31) OR (NUM > 32) THEN DO;

   7692 59 005623   000000 235000 1                  LDA     NUM
        59 005624   000252 115000 60                 CMPA    170
        59 005625   005630 604000 59                 TMI     s:7693
        59 005626   000040 115007                    CMPA    32,DL
        59 005627   005643 604400 59                 TMOZ    s:7699

     1198     7693    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4054);

   7693 59 005630   000000 236000 7                  LDQ     LINE_COUNT
        59 005631   000002 136007                    SBLQ    2,DL
        59 005632   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005633   000254 237000 60                 LDAQ    172
        59 005634   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005635   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005636   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005637   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005640   000005 631400 60                 EPPR1   5
        59 005641   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005642   000000 011000                    NOP     0

     1199     7694        /*E* ERROR: ZIG-4054-C
     1200     7695             MESSAGE: The scale factor for a decimal data item must be in
     1201     7696                      the range of -32 to +33.
     1202     7697        */
     1203     7698    5                       END;

     1204     7699    4                   IF NEG_SCALE THEN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:235  

   7699 59 005643   000130 234000 0                  SZN     NEG_SCALE
        59 005644   005647 605000 59                 TPL     s:7701

     1205     7700    4                       NUM = -1 * NUM;

   7700 59 005645   000000 335000 1                  LCA     NUM
        59 005646   000000 755000 1                  STA     NUM

     1206     7701    4                   UWA.FR.SCALE = NUM;

   7701 59 005647   000000 235000 1                  LDA     NUM
        59 005650   000336 755000 57                 STA     UWA+222
        59 005651   012440 710000 59                 TRA     s:8607

     1207     7702    4               CASE(%SIGNED); /* TYPE IS DECIMAL n,m SIGNED */

     1208     7703    4                   UWA.FR.FTYPE = 4;

   7703 59 005652   000004 235007                    LDA     4,DL
        59 005653   000334 755000 57                 STA     UWA+220

     1209     7704    4                   UWA.FR.F_SIGN = 1;

   7704 59 005654   000001 236007                    LDQ     1,DL
        59 005655   000337 756000 57                 STQ     UWA+223
        59 005656   012440 710000 59                 TRA     s:8607

     1210     7705    4               CASE(%CHAR_INT); /* TYPE IS CHARACTER integer */

     1211     7706    5                   IF TYPE THEN DO;

   7706 59 005657   000032 234000 0                  SZN     TYPE
        59 005660   005675 605000 59                 TPL     s:7709

     1212     7707    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:236  
   7707 59 005661   000000 235000 7                  LDA     LINE_COUNT
        59 005662   000002 135007                    SBLA    2,DL
        59 005663   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005664   000054 237000 60                 LDAQ    44
        59 005665   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005666   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005667   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005670   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005671   000005 631400 60                 EPPR1   5
        59 005672   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005673   000000 011000                    NOP     0

     1213     7708    5                       END;

   7708 59 005674   005677 710000 59                 TRA     s:7710

     1214     7709    4                   ELSE TYPE = '1'B;

   7709 59 005675   400000 236003                    LDQ     -131072,DU
        59 005676   000032 756000 0                  STQ     TYPE

     1215     7710    4                   CALL GET_NUM;

   7710 59 005677   012441 701000 59                 TSX1    GET_NUM
        59 005700   000000 011000                    NOP     0

     1216     7711    5                   IF (NUM > 4095) OR (NUM < 1) THEN DO;

   7711 59 005701   000000 235000 1                  LDA     NUM
        59 005702   007777 115007                    CMPA    4095,DL
        59 005703   005706 605400 59                 TPNZ    s:7712
        59 005704   000000 115003                    CMPA    0,DU
        59 005705   005721 605400 59                 TPNZ    s:7718

     1217     7712    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4056);

   7712 59 005706   000000 236000 7                  LDQ     LINE_COUNT
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:237  
        59 005707   000002 136007                    SBLQ    2,DL
        59 005710   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 005711   000260 237000 60                 LDAQ    176
        59 005712   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005713   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 005714   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 005715   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005716   000005 631400 60                 EPPR1   5
        59 005717   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005720   000000 011000                    NOP     0

     1218     7713    5                       END;

     1219     7714        /*E* ERROR: ZIG-4056-C
     1220     7715             MESSAGE: The length of a character or unspecified data item
     1221     7716                      must be in the range of 1 to 4095.
     1222     7717        */
     1223     7718    4                   UWA.FR.FTYPE = 5;

   7718 59 005721   000005 235007                    LDA     5,DL
        59 005722   000334 755000 57                 STA     UWA+220

     1224     7719    4                   UWA.FR.PREC = NUM;

   7719 59 005723   000000 236000 1                  LDQ     NUM
        59 005724   000335 756000 57                 STQ     UWA+221
        59 005725   012440 710000 59                 TRA     s:8607

     1225     7720    4               CASE(%VARYING); /* TYPE IS CHARACTER n VARYING */

     1226     7721    5                   IF FOUND = %FOUNDREF THEN DO;
              7721                            /* a forward ref was made to this so it */

   7721 59 005726   000133 235000 0                  LDA     FOUND
        59 005727   000001 115007                    CMPA    1,DL
        59 005730   005744 601000 59                 TNZ     s:7729

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:238  
     1227     7722    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4832);
              7722                                /* must be some kind of control field */

   7722 59 005731   000000 235000 7                  LDA     LINE_COUNT
        59 005732   000002 135007                    SBLA    2,DL
        59 005733   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005734   000262 237000 60                 LDAQ    178
        59 005735   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005736   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005737   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005740   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005741   000005 631400 60                 EPPR1   5
        59 005742   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005743   000000 011000                    NOP     0

     1228     7723        /*E* ERROR: ZIG-4832-C
     1229     7724             MESSAGE: The reference to the field "%U1" is invalid because
     1230     7725                      a field which has a data type of CHARACTER VARYING
     1231     7726                      cannot be a control field.
     1232     7727        */
     1233     7728    5                       END;

     1234     7729    4                   UWA.FR.FTYPE = 19;

   7729 59 005744   000023 235007                    LDA     19,DL
        59 005745   000334 755000 57                 STA     UWA+220

     1235     7730    4                   RC.FIXVAR = RC.FIXVAR + 1;

   7730 59 005746   000002 054000 0                  AOS     RC+2
        59 005747   012440 710000 59                 TRA     s:8607

     1236     7731    4               CASE(%DBKEY); /* TYPE IS DBKEY */

     1237     7732    5                   IF TYPE THEN DO;

   7732 59 005750   000032 234000 0                  SZN     TYPE
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:239  
        59 005751   005766 605000 59                 TPL     s:7735

     1238     7733    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7733 59 005752   000000 235000 7                  LDA     LINE_COUNT
        59 005753   000002 135007                    SBLA    2,DL
        59 005754   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 005755   000054 237000 60                 LDAQ    44
        59 005756   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 005757   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 005760   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 005761   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 005762   000005 631400 60                 EPPR1   5
        59 005763   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 005764   000000 011000                    NOP     0

     1239     7734    5                       END;

   7734 59 005765   005770 710000 59                 TRA     s:7736

     1240     7735    4                   ELSE TYPE = '1'B;

   7735 59 005766   400000 236003                    LDQ     -131072,DU
        59 005767   000032 756000 0                  STQ     TYPE

     1241     7736    4                   UWA.FR.FTYPE = 0;

   7736 59 005770   000334 450000 57                 STZ     UWA+220

     1242     7737    4                   UWA.FR.PREC = 35;

   7737 59 005771   000043 235007                    LDA     35,DL
        59 005772   000335 755000 57                 STA     UWA+221
        59 005773   012440 710000 59                 TRA     s:8607

     1243     7738    4               CASE(%UNSPEC_INT); /* TYPE IS UNSPECIFIED integer */

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:240  
     1244     7739    5                   IF TYPE THEN DO;

   7739 59 005774   000032 234000 0                  SZN     TYPE
        59 005775   006012 605000 59                 TPL     s:7742

     1245     7740    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7740 59 005776   000000 235000 7                  LDA     LINE_COUNT
        59 005777   000002 135007                    SBLA    2,DL
        59 006000   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006001   000054 237000 60                 LDAQ    44
        59 006002   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006003   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006004   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006005   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006006   000005 631400 60                 EPPR1   5
        59 006007   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006010   000000 011000                    NOP     0

     1246     7741    5                       END;

   7741 59 006011   006014 710000 59                 TRA     s:7743

     1247     7742    4                   ELSE TYPE = '1'B;

   7742 59 006012   400000 236003                    LDQ     -131072,DU
        59 006013   000032 756000 0                  STQ     TYPE

     1248     7743    4                   CALL GET_NUM;

   7743 59 006014   012441 701000 59                 TSX1    GET_NUM
        59 006015   000000 011000                    NOP     0

     1249     7744    5                   IF NUM > 4095 THEN DO;

   7744 59 006016   000000 235000 1                  LDA     NUM
        59 006017   007777 115007                    CMPA    4095,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:241  
        59 006020   006034 604400 59                 TMOZ    s:7747

     1250     7745    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4056);

   7745 59 006021   000000 236000 7                  LDQ     LINE_COUNT
        59 006022   000002 136007                    SBLQ    2,DL
        59 006023   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 006024   000260 237000 60                 LDAQ    176
        59 006025   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006026   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006027   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006030   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006031   000005 631400 60                 EPPR1   5
        59 006032   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006033   000000 011000                    NOP     0

     1251     7746    5                       END;

     1252     7747    4                   UWA.FR.FTYPE = 9;

   7747 59 006034   000011 235007                    LDA     9,DL
        59 006035   000334 755000 57                 STA     UWA+220

     1253     7748    4                   UWA.FR.PREC = NUM;

   7748 59 006036   000000 236000 1                  LDQ     NUM
        59 006037   000335 756000 57                 STQ     UWA+221
        59 006040   012440 710000 59                 TRA     s:8607

     1254     7749        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:242  
     1255     7750        /********************************************************************
     1256     7751                  field privacy locks
     1257     7752        ********************************************************************/
     1258     7753    4               CASE(%DGET);

     1259     7754    5                   IF RC_LKS.FR_LKS.GET THEN DO;

   7754 59 006041   000043 236000 0                  LDQ     RC_LKS
        59 006042   020000 316003                    CANQ    8192,DU
        59 006043   006060 600000 59                 TZE     s:7757

     1260     7755    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7755 59 006044   000000 235000 7                  LDA     LINE_COUNT
        59 006045   000002 135007                    SBLA    2,DL
        59 006046   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006047   000034 237000 60                 LDAQ    28
        59 006050   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006051   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006052   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006053   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006054   000005 631400 60                 EPPR1   5
        59 006055   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006056   000000 011000                    NOP     0

     1261     7756    5                       END;

   7756 59 006057   012440 710000 59                 TRA     s:8607

     1262     7757    4                   ELSE RC_LKS.FR_LKS.GET = '1'B;

   7757 59 006060   020000 236003                    LDQ     8192,DU
        59 006061   000043 256000 0                  ORSQ    RC_LKS
        59 006062   012440 710000 59                 TRA     s:8607

     1263     7758    4               CASE(%DMODIFY);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:243  
     1264     7759    5                   IF RC_LKS.FR_LKS.MODIFY THEN DO;

   7759 59 006063   000043 236000 0                  LDQ     RC_LKS
        59 006064   040000 316003                    CANQ    16384,DU
        59 006065   006102 600000 59                 TZE     s:7762

     1265     7760    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7760 59 006066   000000 235000 7                  LDA     LINE_COUNT
        59 006067   000002 135007                    SBLA    2,DL
        59 006070   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006071   000034 237000 60                 LDAQ    28
        59 006072   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006073   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006074   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006075   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006076   000005 631400 60                 EPPR1   5
        59 006077   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006100   000000 011000                    NOP     0

     1266     7761    5                       END;

   7761 59 006101   012440 710000 59                 TRA     s:8607

     1267     7762    4                   ELSE RC_LKS.FR_LKS.MODIFY = '1'B;

   7762 59 006102   040000 236003                    LDQ     16384,DU
        59 006103   000043 256000 0                  ORSQ    RC_LKS
        59 006104   012440 710000 59                 TRA     s:8607

     1268     7763    4               CASE(%FR_LCK_NM);

     1269     7764    4                   IF LAST_STATUS ~= %FR_DEF THEN

   7764 59 006105   000000 236000 12                 LDQ     LAST_STATUS
        59 006106   770000 376003                    ANQ     -4096,DU
        59 006107   050000 116003                    CMPQ    20480,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:244  
        59 006110   006125 600000 59                 TZE     s:7767

     1270     7765    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCH_DDL);

   7765 59 006111   000000 235000 7                  LDA     LINE_COUNT
        59 006112   000002 135007                    SBLA    2,DL
        59 006113   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006114   000170 237000 60                 LDAQ    120
        59 006115   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006116   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006117   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006120   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006121   000005 631400 60                 EPPR1   5
        59 006122   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006123   000000 011000                    NOP     0
        59 006124   012440 710000 59                 TRA     s:8607

     1271     7766    5                   ELSE DO;

     1272     7767    5                       CALL GET_WORD;

   7767 59 006125   012467 701000 59                 TSX1    GET_WORD
        59 006126   000000 011000                    NOP     0

     1273     7768    5                       CALL CHECK_RESW_DUPS;

   7768 59 006127   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 006130   000000 011000                    NOP     0

     1274     7769    5                       IF RC_LKS.FR_LKS = '0'B THEN

   7769 59 006131   000043 236000 0                  LDQ     RC_LKS
        59 006132   060000 316003                    CANQ    24576,DU
        59 006133   006136 601000 59                 TNZ     s:7771

     1275     7770    5                           RC_LKS.FR_LKS = '11'B;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:245  
   7770 59 006134   060000 236003                    LDQ     24576,DU
        59 006135   000043 256000 0                  ORSQ    RC_LKS

     1276     7771    5                       CALL ADD_LOCK(WORD1, %ITEM_LOCK);

   7771 59 006136   000114 236000 60                 LDQ     76
        59 006137   200064 756100                    STQ     @LKNAME+1,,AUTO
        59 006140   000023 236000 60                 LDQ     19
        59 006141   200063 756100                    STQ     LNO+3,,AUTO
        59 006142   013360 701000 59                 TSX1    ADD_LOCK
        59 006143   000000 011000                    NOP     0

     1277     7772    5                       END;

   7772 59 006144   012440 710000 59                 TRA     s:8607

     1278     7773        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:246  
     1279     7774        /*******************************************************************
     1280     7775            set entry
     1281     7776        *******************************************************************/
     1282     7777    4               CASE(%SC_ENT);

     1283     7778    4               CASE(%SC_NM); /* SET NAME IS setname */

     1284     7779        /* -init clause flags
     1285     7780           -clean up a previous record entry
     1286     7781           -increase schema size if necessary
     1287     7782           -if necessary, store SN for this set
     1288     7783           -store SC for this set */
     1289     7784    4                   FIRST_MEMBER = '1'B;

   7784 59 006145   400000 236003                    LDQ     -131072,DU
        59 006146   000101 756000 0                  STQ     FIRST_MEMBER

     1290     7785    4                   PERM = '0'B;

   7785 59 006147   000040 450000 0                  STZ     PERM

     1291     7786    4                   OWNER = '0'B;

   7786 59 006150   000033 450000 0                  STZ     OWNER

     1292     7787    4                   PRIOR = '0'B;

   7787 59 006151   000034 450000 0                  STZ     PRIOR

     1293     7788    4                   ORDER = '0'B;

   7788 59 006152   000035 450000 0                  STZ     ORDER

     1294     7789    4                   OWNER_CLAUSE_FOUND = '0'B;

   7789 59 006153   000127 450000 0                  STZ     OWNER_CLAUSE_FOUND

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:247  
     1295     7790    4                   IF REC_ENTRY_DONE THEN

   7790 59 006154   000100 234000 0                  SZN     REC_ENTRY_DONE
        59 006155   006160 605000 59                 TPL     s:7792

     1296     7791    4                       CALL CLEAN_UP_REC;

   7791 59 006156   012607 701000 59                 TSX1    CLEAN_UP_REC
        59 006157   000000 011000                    NOP     0

     1297     7792    4                   IF NEED_LARGER_SCHEMA

   7792 59 006160   000000 234000 14                 SZN     NEED_LARGER_SCHEMA
        59 006161   006205 605000 59                 TPL     s:7799

     1298     7793    5                   THEN DO;

     1299     7794    5                       CALL SF_CLOSE(1,STATUS);

   7794 59 006162   200053 630500                    EPPR0   STATUS,,AUTO
        59 006163   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006164   000003 236000 60                 LDQ     3
        59 006165   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 006166   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006167   000001 631400 60                 EPPR1   1
        59 006170   000000 701000 xent               TSX1    SF_CLOSE
        59 006171   000000 011000                    NOP     0

     1300     7795    5                       CALL SF_OPEN(1,STATUS);

   7795 59 006172   200053 630500                    EPPR0   STATUS,,AUTO
        59 006173   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006174   000003 236000 60                 LDQ     3
        59 006175   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 006176   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006177   000001 631400 60                 EPPR1   1
        59 006200   000000 701000 xent               TSX1    SF_OPEN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:248  
        59 006201   000000 011000                    NOP     0

     1301     7796    5                       NEED_LARGER_SCHEMA = '0'B;

   7796 59 006202   000000 450000 14                 STZ     NEED_LARGER_SCHEMA

     1302     7797    5                       CALL RESTORE_CURRENTS;

   7797 59 006203   013326 701000 59                 TSX1    RESTORE_CURRENTS
        59 006204   000000 011000                    NOP     0

     1303     7798    5                       END;

     1304     7799    4                   LAST_STATUS = %SC_DEF;

   7799 59 006205   020000 236003                    LDQ     8192,DU
        59 006206   000000 756000 12                 STQ     LAST_STATUS

     1305     7800    4                   CALL GET_WORD;

   7800 59 006207   012467 701000 59                 TSX1    GET_WORD
        59 006210   000000 011000                    NOP     0

     1306     7801    4                   CURR_SETNAME = WORD1;

   7801 59 006211   040000 100400                    MLR     fill='040'O
        59 006212   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 006213   000104 000036 0                  ADSC9   CURR_SETNAME             cn=0,n=30

     1307     7802    4                   CALL CHECK_RESW_DUPS;

   7802 59 006214   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 006215   000000 011000                    NOP     0

     1308     7803    4                   CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,1,LNO,FOUND,RELTYPE.NO_NR,0,0);

   7803 59 006216   000024 237000 60                 LDAQ    20
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:249  
        59 006217   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 006220   000026 237000 60                 LDAQ    22
        59 006221   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 006222   200060 630500                    EPPR0   LNO,,AUTO
        59 006223   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 006224   000003 236000 60                 LDQ     3
        59 006225   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 006226   000062 237000 60                 LDAQ    50
        59 006227   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 006230   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006231   000020 631400 60                 EPPR1   16
        59 006232   000000 701000 xent               TSX1    ADD_SN
        59 006233   000000 011000                    NOP     0

     1309     7804    4                   LAST_LOCKABLE_DBK = UWA.DIRECT_REF;

   7804 59 006234   000036 235000 57                 LDA     UWA+30
        59 006235   000044 755000 0                  STA     LAST_LOCKABLE_DBK

     1310     7805    5                   IF FOUND = %FOUNDDEF THEN DO;

   7805 59 006236   000133 236000 0                  LDQ     FOUND
        59 006237   000002 116007                    CMPQ    2,DL
        59 006240   006254 601000 59                 TNZ     s:7811

     1311     7806    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4071);

   7806 59 006241   000000 235000 7                  LDA     LINE_COUNT
        59 006242   000002 135007                    SBLA    2,DL
        59 006243   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006244   000266 237000 60                 LDAQ    182
        59 006245   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006246   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006247   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006250   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006251   000005 631400 60                 EPPR1   5
        59 006252   000000 701000 xent               TSX1    ZIG$D_DIAG
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:250  
        59 006253   000000 011000                    NOP     0

     1312     7807        /*E* ERROR: ZIG-4071-C
     1313     7808             MESSAGE: The name "%U1" has already been assigned to a set.
     1314     7809        */
     1315     7810    5                       END;

     1316     7811    4                   LAST_SC_SN = UWA.DIRECT_REF;

   7811 59 006254   000036 235000 57                 LDA     UWA+30
        59 006255   000073 755000 0                  STA     LAST_SC_SN

     1317     7812    4                   UWA.SC = '0'B;

   7812 59 006256   000000 100400                    MLR     fill='000'O
        59 006257   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 006260   000310 000064 57                 ADSC9   UWA+200                  cn=0,n=52

     1318     7813    4                   UWA.SC.PTRNO = 3;

   7813 59 006261   000003 236007                    LDQ     3,DL
        59 006262   000315 756000 57                 STQ     UWA+205

     1319     7814    4                   UWA.SC.SEQDUP = 2;

   7814 59 006263   000002 235007                    LDA     2,DL
        59 006264   000320 755000 57                 STA     UWA+208

     1320     7815    4                   CALL STRE_6('SC      ');

   7815 59 006265   000072 630400 60                 EPPR0   58
        59 006266   000013 631400 60                 EPPR1   11
        59 006267   000000 701000 xent               TSX1    STRE_6
        59 006270   000000 011000                    NOP     0

     1321     7816    4                   LAST_SC_DBK = UWA.DIRECT_REF;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:251  
   7816 59 006271   000036 235000 57                 LDA     UWA+30
        59 006272   000072 755000 0                  STA     LAST_SC_DBK

     1322     7817    4                   UWA.OA.NUMB_SC = UWA.OA.NUMB_SC + 1;

   7817 59 006273   000216 054000 57                 AOS     UWA+142
        59 006274   012440 710000 59                 TRA     s:8607

     1323     7818    4               CASE(%SPRIV);

     1324     7819    4                   RC_LKS.SC_LKS = '0'B;

   7819 59 006275   000265 236000 60                 LDQ     181
        59 006276   000043 356000 0                  ANSQ    RC_LKS
        59 006277   012440 710000 59                 TRA     s:8607

     1325     7820    4               CASE(%OWN_REC_NM); /* OWNER IS recordname */

     1326     7821        /* -make sure this is only OWNER clause for this set
     1327     7822           -make sure this set wasn't named in this record's LOC MODE clause
     1328     7823           -make sure this record has already been defined
     1329     7824           -store an SO for this record */
     1330     7825    4                   OWNER_CLAUSE_FOUND = '1'B;

   7825 59 006300   400000 236003                    LDQ     -131072,DU
        59 006301   000127 756000 0                  STQ     OWNER_CLAUSE_FOUND

     1331     7826    5                   IF OWNER THEN DO;

   7826 59 006302   000033 234000 0                  SZN     OWNER
        59 006303   006320 605000 59                 TPL     s:7829

     1332     7827    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7827 59 006304   000000 235000 7                  LDA     LINE_COUNT
        59 006305   000002 135007                    SBLA    2,DL
        59 006306   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:252  
        59 006307   000054 237000 60                 LDAQ    44
        59 006310   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006311   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006312   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006313   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006314   000005 631400 60                 EPPR1   5
        59 006315   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006316   000000 011000                    NOP     0

     1333     7828    5                       END;

   7828 59 006317   006321 710000 59                 TRA     s:7830

     1334     7829    4                   ELSE OWNER = '1'B;

   7829 59 006320   000033 756000 0                  STQ     OWNER

     1335     7830    4                   CALL GET_WORD;

   7830 59 006321   012467 701000 59                 TSX1    GET_WORD
        59 006322   000000 011000                    NOP     0

     1336     7831    4                   CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,LNO,FOUND,RELTYPE.SO,EXPLCT,0);

   7831 59 006323   000134 237000 60                 LDAQ    92
        59 006324   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 006325   000270 237000 60                 LDAQ    184
        59 006326   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 006327   200060 630500                    EPPR0   LNO,,AUTO
        59 006330   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 006331   000024 236000 60                 LDQ     20
        59 006332   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 006333   000022 237000 60                 LDAQ    18
        59 006334   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 006335   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006336   000020 631400 60                 EPPR1   16
        59 006337   000000 701000 xent               TSX1    ADD_SN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:253  
        59 006340   000000 011000                    NOP     0

     1337     7832    5                   IF LAST_RC$->TABLES.DBK_RC(0) = LAST_SC_SN THEN DO;
              7832                            /* VIA this SC */

   7832 59 006341   000000 470400 8                  LDP0    LAST_RC$
        59 006342   000010 236100                    LDQ     8,,PR0
        59 006343   777777 376007                    ANQ     -1,DL
        59 006344   000073 116000 0                  CMPQ    LAST_SC_SN
        59 006345   006361 601000 59                 TNZ     s:7839

     1338     7833    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4807);

   7833 59 006346   000000 235000 7                  LDA     LINE_COUNT
        59 006347   000002 135007                    SBLA    2,DL
        59 006350   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006351   000274 237000 60                 LDAQ    188
        59 006352   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006353   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006354   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006355   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006356   000005 631400 60                 EPPR1   5
        59 006357   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006360   000000 011000                    NOP     0

     1339     7834        /*E* ERROR: ZIG-4807-C
     1340     7835             MESSAGE: The LOCATION MODE clause is invalid because the
     1341     7836                      the record is the OWNER of the set.
     1342     7837        */
     1343     7838    5                       END;

     1344     7839    5                   IF FOUND ~= %FOUNDDEF THEN DO;

   7839 59 006361   000133 235000 0                  LDA     FOUND
        59 006362   000002 115007                    CMPA    2,DL
        59 006363   006420 600000 59                 TZE     s:7856

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:254  
     1345     7840    5                       SET_ERROR = '1'B;

   7840 59 006364   400000 236003                    LDQ     -131072,DU
        59 006365   000000 756000 15                 STQ     SET_ERROR

     1346     7841    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4211);

   7841 59 006366   000000 235000 7                  LDA     LINE_COUNT
        59 006367   000002 135007                    SBLA    2,DL
        59 006370   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006371   000276 237000 60                 LDAQ    190
        59 006372   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006373   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006374   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006375   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006376   000005 631400 60                 EPPR1   5
        59 006377   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006400   000000 011000                    NOP     0

     1347     7842        /*E* ERROR: ZIG-4211-C
     1348     7843             MESSAGE: The record name "%U1" cannot be matched with a record
     1349     7844                      name in the schema dictionary.
     1350     7845        */
     1351     7846    6                       IF FIRST_SET_ERROR THEN DO;

   7846 59 006401   000000 234000 17                 SZN     FIRST_SET_ERROR
        59 006402   012440 605000 59                 TPL     s:8607

     1352     7847    6                           FIRST_SET_ERROR = '0'B;

   7847 59 006403   000000 450000 17                 STZ     FIRST_SET_ERROR

     1353     7848    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4079);

   7848 59 006404   000000 235000 7                  LDA     LINE_COUNT
        59 006405   000002 135007                    SBLA    2,DL
        59 006406   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:255  
        59 006407   000302 237000 60                 LDAQ    194
        59 006410   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006411   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006412   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006413   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006414   000005 631400 60                 EPPR1   5
        59 006415   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006416   000000 011000                    NOP     0

     1354     7849        /*E* ERROR: ZIG-4079-C
     1355     7850             MESSAGE: Records must be declared before they are referenced
     1356     7851                      by a set subentry.
     1357     7852        */
     1358     7853    6                           END;

     1359     7854    5                       END;

   7854 59 006417   012440 710000 59                 TRA     s:8607

     1360     7855    5                   ELSE DO;

     1361     7856    5                       CALL FETCHNS_6('SN-SE   '); /* RC */

   7856 59 006420   000107 630400 60                 EPPR0   71
        59 006421   000013 631400 60                 EPPR1   11
        59 006422   000000 701000 xent               TSX1    FETCHNS_6
        59 006423   000000 011000                    NOP     0

     1362     7857    5                       IF UWA.RC.PSMODE = 4 THEN /* INDEXED */

   7857 59 006424   000271 235000 57                 LDA     UWA+185
        59 006425   000004 115007                    CMPA    4,DL
        59 006426   006442 601000 59                 TNZ     s:7865

     1363     7858    6                       DO;

     1364     7859    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4855);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:256  

   7859 59 006427   000000 236000 7                  LDQ     LINE_COUNT
        59 006430   000002 136007                    SBLQ    2,DL
        59 006431   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 006432   000304 237000 60                 LDAQ    196
        59 006433   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006434   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 006435   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 006436   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006437   000005 631400 60                 EPPR1   5
        59 006440   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006441   000000 011000                    NOP     0

     1365     7860        /*E* ERROR: ZIG-4855-C
     1366     7861             MESSAGE: Records that are LOCATION MODE INDEXED cannot
     1367     7862                      participate as the owner or member of a set.
     1368     7863        */
     1369     7864    6                           END;

     1370     7865    6                       IF FOUND = %FOUNDDEF THEN DO;

   7865 59 006442   000133 235000 0                  LDA     FOUND
        59 006443   000002 115007                    CMPA    2,DL
        59 006444   012440 601000 59                 TNZ     s:8607

     1371     7866    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;

   7866 59 006445   000305 054000 57                 AOS     UWA+197

     1372     7867    6                           UWA.RC.SO = 1;

   7867 59 006446   000001 236007                    LDQ     1,DL
        59 006447   000274 756000 57                 STQ     UWA+188

     1373     7868    6                           CALL MODIFY_6('RC      ');

   7868 59 006450   000032 630400 60                 EPPR0   26
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:257  
        59 006451   000013 631400 60                 EPPR1   11
        59 006452   000000 701000 xent               TSX1    MODIFY_6
        59 006453   000000 011000                    NOP     0

     1374     7869    6                           UWA.SO = '0'B;

   7869 59 006454   000000 100400                    MLR     fill='000'O
        59 006455   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 006456   000354 000014 57                 ADSC9   UWA+236                  cn=0,n=12

     1375     7870    6                           CALL STRE_6('SO      ');

   7870 59 006457   000073 630400 60                 EPPR0   59
        59 006460   000013 631400 60                 EPPR1   11
        59 006461   000000 701000 xent               TSX1    STRE_6
        59 006462   000000 011000                    NOP     0

     1376     7871    6                           LAST_SO_DBK = UWA.DIRECT_REF;

   7871 59 006463   000036 235000 57                 LDA     UWA+30
        59 006464   000074 755000 0                  STA     LAST_SO_DBK

     1377     7872    6                           CALL FINDNS_6('RC-SOSM '); /* SO or SM */

   7872 59 006465   000074 630400 60                 EPPR0   60
        59 006466   000013 631400 60                 EPPR1   11
        59 006467   000000 701000 xent               TSX1    FINDNS_6
        59 006470   000000 011000                    NOP     0

     1378     7873    6                           CALL FINDD_6('SO      ',LAST_SO_DBK);

   7873 59 006471   000306 630400 60                 EPPR0   198
        59 006472   000001 631400 60                 EPPR1   1
        59 006473   000000 701000 xent               TSX1    FINDD_6
        59 006474   000000 011000                    NOP     0

     1379     7874    6                           CALL CONNECT_6('RC-SOSM ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:258  

   7874 59 006475   000074 630400 60                 EPPR0   60
        59 006476   000013 631400 60                 EPPR1   11
        59 006477   000000 701000 xent               TSX1    CONNECT_6
        59 006500   000000 011000                    NOP     0

     1380     7875    6                           UWA.OA.NUMB_SO = UWA.OA.NUMB_SO + 1;

   7875 59 006501   000221 054000 57                 AOS     UWA+145

     1381     7876    6                           END;

     1382     7877    5                       END; /* ELSE */

   7877 59 006502   012440 710000 59                 TRA     s:8607

     1383     7878    4               CASE(%PRIOR_CL); /* SET IS PRIOR PROCESSABLE */

     1384     7879    5                   IF PRIOR THEN DO;

   7879 59 006503   000034 234000 0                  SZN     PRIOR
        59 006504   006521 605000 59                 TPL     s:7882

     1385     7880    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7880 59 006505   000000 235000 7                  LDA     LINE_COUNT
        59 006506   000002 135007                    SBLA    2,DL
        59 006507   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006510   000054 237000 60                 LDAQ    44
        59 006511   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006512   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006513   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006514   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006515   000005 631400 60                 EPPR1   5
        59 006516   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006517   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:259  
     1386     7881    5                       END;

   7881 59 006520   012440 710000 59                 TRA     s:8607

     1387     7882    4                   ELSE PRIOR = '1'B;

   7882 59 006521   400000 236003                    LDQ     -131072,DU
        59 006522   000034 756000 0                  STQ     PRIOR
        59 006523   012440 710000 59                 TRA     s:8607

     1388     7883    4               CASE(%ORDER_CL); /* ORDER IS PERMANENT */

     1389     7884    5                   IF ORDER THEN DO;

   7884 59 006524   000035 234000 0                  SZN     ORDER
        59 006525   006542 605000 59                 TPL     s:7887

     1390     7885    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   7885 59 006526   000000 235000 7                  LDA     LINE_COUNT
        59 006527   000002 135007                    SBLA    2,DL
        59 006530   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006531   000054 237000 60                 LDAQ    44
        59 006532   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006533   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006534   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006535   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006536   000005 631400 60                 EPPR1   5
        59 006537   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006540   000000 011000                    NOP     0

     1391     7886    5                       END;

   7886 59 006541   012440 710000 59                 TRA     s:8607

     1392     7887    4                   ELSE ORDER = '1'B;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:260  
   7887 59 006542   400000 236003                    LDQ     -131072,DU
        59 006543   000035 756000 0                  STQ     ORDER
        59 006544   012440 710000 59                 TRA     s:8607

     1393     7888    4               CASE(%PERM);

     1394     7889    4                   PERM = '1'B;

   7889 59 006545   400000 236003                    LDQ     -131072,DU
        59 006546   000040 756000 0                  STQ     PERM
        59 006547   012440 710000 59                 TRA     s:8607

     1395     7890    4               CASE(%FIRST); /* INSERTION IS FIRST */

     1396     7891    4                   UWA.SC.SETORD = 0;

   7891 59 006550   000312 450000 57                 STZ     UWA+202
        59 006551   012440 710000 59                 TRA     s:8607

     1397     7892    4               CASE(%LAST); /* INSERTION IS LAST */

     1398     7893    4                   UWA.SC.SETORD = 1;

   7893 59 006552   000001 235007                    LDA     1,DL
        59 006553   000312 755000 57                 STA     UWA+202
        59 006554   012440 710000 59                 TRA     s:8607

     1399     7894    4               CASE(%NEXT); /* INSERTION IS NEXT */

     1400     7895    4                   UWA.SC.SETORD = 2;

   7895 59 006555   000002 235007                    LDA     2,DL
        59 006556   000312 755000 57                 STA     UWA+202
        59 006557   012440 710000 59                 TRA     s:8607

     1401     7896    4               CASE(%PRIOR); /* INSERTION IS PRIOR */

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:261  
     1402     7897    4                   UWA.SC.SETORD = 3;

   7897 59 006560   000003 235007                    LDA     3,DL
        59 006561   000312 755000 57                 STA     UWA+202
        59 006562   012440 710000 59                 TRA     s:8607

     1403     7898    4               CASE(%IN_REC); /* INSERTION IS SORTED WITHIN RECORD_NAME */

     1404     7899    4                   UWA.SC.SETORD = 6;

   7899 59 006563   000006 235007                    LDA     6,DL
        59 006564   000312 755000 57                 STA     UWA+202
        59 006565   012440 710000 59                 TRA     s:8607

     1405     7900    4               CASE(%BY_KEY); /* INSERTION IS SORTED BY DEFINED KEYS... */

     1406     7901    4                   UWA.SC.SETORD = 4;

   7901 59 006566   000004 235007                    LDA     4,DL
        59 006567   000312 755000 57                 STA     UWA+202
        59 006570   012440 710000 59                 TRA     s:8607

     1407     7902    4               CASE(%SFIRST); /* INSERTION SORTED...DUPS ARE FIRST ALLOWED */

     1408     7903    4                   UWA.SC.SEQDUP = 0;

   7903 59 006571   000320 450000 57                 STZ     UWA+208
        59 006572   012440 710000 59                 TRA     s:8607

     1409     7904    4               CASE(%SLAST); /* INSERTION SORTED...DUPS ARE LAST ALLOWED */

     1410     7905    4                   UWA.SC.SEQDUP = 1;

   7905 59 006573   000001 235007                    LDA     1,DL
        59 006574   000320 755000 57                 STA     UWA+208
        59 006575   012440 710000 59                 TRA     s:8607

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:262  
     1411     7906    4               CASE(%S_NOT); /* INSERTION SORTED...DUPS ARE NOT ALLOWED */

     1412     7907    4                   UWA.SC.SEQDUP = 2;

   7907 59 006576   000002 235007                    LDA     2,DL
        59 006577   000320 755000 57                 STA     UWA+208
        59 006600   012440 710000 59                 TRA     s:8607

     1413     7908        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:263  
     1414     7909        /*******************************************************************
     1415     7910                 set privacy locks
     1416     7911        *******************************************************************/
     1417     7912    4               CASE(%SINSERT);

     1418     7913    5                   IF RC_LKS.SC_LKS.XINSERT THEN DO;

   7913 59 006601   000043 234000 0                  SZN     RC_LKS
        59 006602   006617 605000 59                 TPL     s:7916

     1419     7914    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7914 59 006603   000000 235000 7                  LDA     LINE_COUNT
        59 006604   000002 135007                    SBLA    2,DL
        59 006605   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006606   000034 237000 60                 LDAQ    28
        59 006607   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006610   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006611   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006612   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006613   000005 631400 60                 EPPR1   5
        59 006614   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006615   000000 011000                    NOP     0

     1420     7915    5                       END;

   7915 59 006616   012440 710000 59                 TRA     s:8607

     1421     7916    4                   ELSE RC_LKS.SC_LKS.XINSERT = '1'B;

   7916 59 006617   400000 236003                    LDQ     -131072,DU
        59 006620   000043 256000 0                  ORSQ    RC_LKS
        59 006621   012440 710000 59                 TRA     s:8607

     1422     7917    4               CASE(%SREMOVE);

     1423     7918    5                   IF RC_LKS.SC_LKS.REMOVE THEN DO;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:264  

   7918 59 006622   000043 236000 0                  LDQ     RC_LKS
        59 006623   200000 316003                    CANQ    65536,DU
        59 006624   006641 600000 59                 TZE     s:7921

     1424     7919    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7919 59 006625   000000 235000 7                  LDA     LINE_COUNT
        59 006626   000002 135007                    SBLA    2,DL
        59 006627   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006630   000034 237000 60                 LDAQ    28
        59 006631   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006632   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006633   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006634   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006635   000005 631400 60                 EPPR1   5
        59 006636   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006637   000000 011000                    NOP     0

     1425     7920    5                       END;

   7920 59 006640   012440 710000 59                 TRA     s:8607

     1426     7921    4                   ELSE RC_LKS.SC_LKS.REMOVE = '1'B;

   7921 59 006641   200000 236003                    LDQ     65536,DU
        59 006642   000043 256000 0                  ORSQ    RC_LKS
        59 006643   012440 710000 59                 TRA     s:8607

     1427     7922    4               CASE(%SFIND);

     1428     7923    5                   IF RC_LKS.SC_LKS.FIND THEN DO;

   7923 59 006644   000043 236000 0                  LDQ     RC_LKS
        59 006645   100000 316003                    CANQ    32768,DU
        59 006646   006663 600000 59                 TZE     s:7926

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:265  
     1429     7924    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4015);

   7924 59 006647   000000 235000 7                  LDA     LINE_COUNT
        59 006650   000002 135007                    SBLA    2,DL
        59 006651   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006652   000034 237000 60                 LDAQ    28
        59 006653   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006654   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006655   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006656   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006657   000005 631400 60                 EPPR1   5
        59 006660   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006661   000000 011000                    NOP     0

     1430     7925    5                       END;

   7925 59 006662   012440 710000 59                 TRA     s:8607

     1431     7926    4                   ELSE RC_LKS.SC_LKS.FIND = '1'B;

   7926 59 006663   100000 236003                    LDQ     32768,DU
        59 006664   000043 256000 0                  ORSQ    RC_LKS
        59 006665   012440 710000 59                 TRA     s:8607

     1432     7927    4               CASE(%SC_LCK_NM);

     1433     7928    4                   IF LAST_STATUS ~= %SC_DEF THEN

   7928 59 006666   000000 236000 12                 LDQ     LAST_STATUS
        59 006667   770000 376003                    ANQ     -4096,DU
        59 006670   020000 116003                    CMPQ    8192,DU
        59 006671   006706 600000 59                 TZE     s:7931

     1434     7929    4                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);

   7929 59 006672   000000 235000 7                  LDA     LINE_COUNT
        59 006673   000002 135007                    SBLA    2,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:266  
        59 006674   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006675   000010 237000 60                 LDAQ    8
        59 006676   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006677   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006700   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006701   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006702   000005 631400 60                 EPPR1   5
        59 006703   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006704   000000 011000                    NOP     0
        59 006705   012440 710000 59                 TRA     s:8607

     1435     7930    5                   ELSE DO;

     1436     7931    5                       CALL GET_WORD;

   7931 59 006706   012467 701000 59                 TSX1    GET_WORD
        59 006707   000000 011000                    NOP     0

     1437     7932    5                       CALL CHECK_RESW_DUPS;

   7932 59 006710   012535 701000 59                 TSX1    CHECK_RESW_DUPS
        59 006711   000000 011000                    NOP     0

     1438     7933    5                       IF RC_LKS.SC_LKS = '0'B THEN

   7933 59 006712   000043 236000 0                  LDQ     RC_LKS
        59 006713   700000 316003                    CANQ    -32768,DU
        59 006714   006717 601000 59                 TNZ     s:7935

     1439     7934    5                           RC_LKS.SC_LKS = '111'B;

   7934 59 006715   700000 236003                    LDQ     -32768,DU
        59 006716   000043 256000 0                  ORSQ    RC_LKS

     1440     7935    5                       CALL ADD_LOCK(WORD1, %SET_LOCK);

   7935 59 006717   000062 236000 60                 LDQ     50
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:267  
        59 006720   200064 756100                    STQ     @LKNAME+1,,AUTO
        59 006721   000023 236000 60                 LDQ     19
        59 006722   200063 756100                    STQ     LNO+3,,AUTO
        59 006723   013360 701000 59                 TSX1    ADD_LOCK
        59 006724   000000 011000                    NOP     0

     1441     7936    5                       END;

   7936 59 006725   012440 710000 59                 TRA     s:8607

     1442     7937        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:268  
     1443     7938        /******************************************************************
     1444     7939                 member subentry
     1445     7940        ******************************************************************/
     1446     7941    4               CASE(%MEM_ENT);

     1447     7942    4               CASE(%MEM_REC_NM); /* MEMBER IS recordname */

     1448     7943        /* -init clause flags
     1449     7944           -make sure this member entry is within a set entry
     1450     7945           -check if this set named in this record's LOC MODE clause
     1451     7946           -make sure this record has already been defined
     1452     7947           -make sure this record wasn't previously defined in this set
     1453     7948           -store an SM for this record and a SS */
     1454     7949    4                   IF ~ OWNER_CLAUSE_FOUND THEN

   7949 59 006726   000127 236000 0                  LDQ     OWNER_CLAUSE_FOUND
        59 006727   400000 376003                    ANQ     -131072,DU
        59 006730   400000 676003                    ERQ     -131072,DU
        59 006731   006740 600000 59                 TZE     s:7951

     1455     7950    4                       UNWIND TO SYNTAX_ERR;

   7950 59 006732   000100 100600                    MLR   ! fill='000'O
        59 006733   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
        59 006734   200072 000010                    ADSC9   KEY_MULT_REF+1,,AUTO     cn=0,n=8
        59 006735   200072 237300                    LDAQ  ! KEY_MULT_REF+1,,AUTO
        59 006736   000000 700200 xent               TSX0  ! X66_AUNWIND
        59 006737   000000 000200                    ZERO    0,128

     1456     7951    4                   LINKED = '0'B;

   7951 59 006740   000037 450000 0                  STZ     LINKED

     1457     7952    4                   SELECTION = '0'B;

   7952 59 006741   000041 450000 0                  STZ     SELECTION

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:269  
     1458     7953    4                   FLAG_ERROR = '0'B;

   7953 59 006742   000046 450000 0                  STZ     FLAG_ERROR

     1459     7954    4                   IF (LAST_STATUS ~= %SC_DEF) AND (LAST_STATUS ~= %MEM_DEF)

   7954 59 006743   000000 236000 12                 LDQ     LAST_STATUS
        59 006744   770000 376003                    ANQ     -4096,DU
        59 006745   020000 116003                    CMPQ    8192,DU
        59 006746   006772 600000 59                 TZE     s:7960
        59 006747   060000 116003                    CMPQ    24576,DU
        59 006750   006772 600000 59                 TZE     s:7960

     1460     7955    5                   THEN DO;

     1461     7956    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%ORDER_SCHEMA_DDL);

   7956 59 006751   000000 235000 7                  LDA     LINE_COUNT
        59 006752   000002 135007                    SBLA    2,DL
        59 006753   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 006754   000010 237000 60                 LDAQ    8
        59 006755   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 006756   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 006757   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 006760   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 006761   000005 631400 60                 EPPR1   5
        59 006762   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 006763   000000 011000                    NOP     0

     1462     7957    5                       UNWIND TO SYNTAX_ERR;

   7957 59 006764   000100 100600                    MLR   ! fill='000'O
        59 006765   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
        59 006766   200072 000010                    ADSC9   KEY_MULT_REF+1,,AUTO     cn=0,n=8
        59 006767   200072 237300                    LDAQ  ! KEY_MULT_REF+1,,AUTO
        59 006770   000000 700200 xent               TSX0  ! X66_AUNWIND
        59 006771   000000 000200                    ZERO    0,128
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:270  

     1463     7958    5                       END;
     1464     7959    5                   ELSE DO;

     1465     7960    5                       LAST_STATUS = %MEM_DEF;

   7960 59 006772   060000 236003                    LDQ     24576,DU
        59 006773   000000 756000 12                 STQ     LAST_STATUS

     1466     7961    5                       CALL GET_WORD;

   7961 59 006774   012467 701000 59                 TSX1    GET_WORD
        59 006775   000000 011000                    NOP     0

     1467     7962    5                      CALL ADD_SN(%ZIG_RTYPE_RC,WORD1,0,LNO,FOUND,RELTYPE.SM,EXPLCT,0)
              7962                                ;

   7962 59 006776   000134 237000 60                 LDAQ    92
        59 006777   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 007000   000310 237000 60                 LDAQ    200
        59 007001   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 007002   200060 630500                    EPPR0   LNO,,AUTO
        59 007003   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 007004   000024 236000 60                 LDQ     20
        59 007005   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 007006   000022 237000 60                 LDAQ    18
        59 007007   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 007010   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007011   000020 631400 60                 EPPR1   16
        59 007012   000000 701000 xent               TSX1    ADD_SN
        59 007013   000000 011000                    NOP     0

     1468     7963    6                       IF FOUND ~= %FOUNDDEF THEN DO;

   7963 59 007014   000133 235000 0                  LDA     FOUND
        59 007015   000002 115007                    CMPA    2,DL
        59 007016   007053 600000 59                 TZE     s:7972
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:271  

     1469     7964    6                           FLAG_ERROR = '1'B;

   7964 59 007017   400000 236003                    LDQ     -131072,DU
        59 007020   000046 756000 0                  STQ     FLAG_ERROR

     1470     7965    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4211);

   7965 59 007021   000000 235000 7                  LDA     LINE_COUNT
        59 007022   000002 135007                    SBLA    2,DL
        59 007023   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007024   000276 237000 60                 LDAQ    190
        59 007025   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007026   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007027   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007030   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007031   000005 631400 60                 EPPR1   5
        59 007032   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007033   000000 011000                    NOP     0

     1471     7966    7                           IF FIRST_SET_ERROR THEN DO;

   7966 59 007034   000000 234000 17                 SZN     FIRST_SET_ERROR
        59 007035   012440 605000 59                 TPL     s:8607

     1472     7967    7                               FIRST_SET_ERROR = '0'B;

   7967 59 007036   000000 450000 17                 STZ     FIRST_SET_ERROR

     1473     7968    7                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4079);

   7968 59 007037   000000 235000 7                  LDA     LINE_COUNT
        59 007040   000002 135007                    SBLA    2,DL
        59 007041   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007042   000302 237000 60                 LDAQ    194
        59 007043   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007044   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:272  
        59 007045   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007046   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007047   000005 631400 60                 EPPR1   5
        59 007050   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007051   000000 011000                    NOP     0

     1474     7969    7                               END;

     1475     7970    6                           END;

   7970 59 007052   012440 710000 59                 TRA     s:8607

     1476     7971    6                       ELSE DO;

     1477     7972    6                           CALL FETCHNS_6('SN-SE   '); /* RC */

   7972 59 007053   000107 630400 60                 EPPR0   71
        59 007054   000013 631400 60                 EPPR1   11
        59 007055   000000 701000 xent               TSX1    FETCHNS_6
        59 007056   000000 011000                    NOP     0

     1478     7973    6                           LAST_RC_DBK = UWA.DIRECT_REF;

   7973 59 007057   000036 235000 57                 LDA     UWA+30
        59 007060   000000 755000 4                  STA     LAST_RC_DBK

     1479     7974    6                           LAST_RC_NAME = WORD1;

   7974 59 007061   040000 100400                    MLR     fill='040'O
        59 007062   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007063   000050 000036 0                  ADSC9   LAST_RC_NAME             cn=0,n=30

     1480     7975    6                           UWA.RC.NUM_SOSM = UWA.RC.NUM_SOSM + 1;

   7975 59 007064   000305 054000 57                 AOS     UWA+197

     1481     7976    6                           UWA.RC.SM = 1;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:273  

   7976 59 007065   000001 236007                    LDQ     1,DL
        59 007066   000275 756000 57                 STQ     UWA+189

     1482     7977    6                           CALL MODIFY_6('RC      ');

   7977 59 007067   000032 630400 60                 EPPR0   26
        59 007070   000013 631400 60                 EPPR1   11
        59 007071   000000 701000 xent               TSX1    MODIFY_6
        59 007072   000000 011000                    NOP     0

     1483     7978         /* make sure this record wasn't declared previously in this set */
     1484     7979    6                           CALL FETCHPS_6('RC-SOSM '); /* SO or SM */

   7979 59 007073   000074 630400 60                 EPPR0   60
        59 007074   000013 631400 60                 EPPR1   11
        59 007075   000000 701000 xent               TSX1    FETCHPS_6
        59 007076   000000 011000                    NOP     0

     1485     7980    7                           IF UWA.DB_STATUS = '0000000' THEN DO;

   7980 59 007077   040000 106400                    CMPC    fill='040'O
        59 007100   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 007101   000103 000007 58                 ADSC9   67                       cn=0,n=7
        59 007102   007151 601000 59                 TNZ     s:8000

     1486     7981    7                               CALL FINDOS_6('SC-SOSM ');
              7981                                        /* SC that last referenced this RC */

   7981 59 007103   000077 630400 60                 EPPR0   63
        59 007104   000013 631400 60                 EPPR1   11
        59 007105   000000 701000 xent               TSX1    FINDOS_6
        59 007106   000000 011000                    NOP     0

     1487     7982    7                               IF LAST_SC_DBK = UWA.DIRECT_REF
              7982                                        /* already mentioned in this set */

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:274  
   7982 59 007107   000072 236000 0                  LDQ     LAST_SC_DBK
        59 007110   000036 116000 57                 CMPQ    UWA+30
        59 007111   007151 601000 59                 TNZ     s:8000

     1488     7983    8                               THEN IF UWA.RECORD_NAME = 'SO' THEN DO;

   7983 59 007112   040000 106400                    CMPC    fill='040'O
        59 007113   000023 000036 57                 ADSC9   UWA+19                   cn=0,n=30
        59 007114   000021 000002 58                 ADSC9   17                       cn=0,n=2
        59 007115   007134 601000 59                 TNZ     s:7992

     1489     7984    8                                       FLAG_ERROR = '1'B;

   7984 59 007116   400000 236003                    LDQ     -131072,DU
        59 007117   000046 756000 0                  STQ     FLAG_ERROR

     1490     7985    8                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4084);

   7985 59 007120   000000 235000 7                  LDA     LINE_COUNT
        59 007121   000002 135007                    SBLA    2,DL
        59 007122   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007123   000314 237000 60                 LDAQ    204
        59 007124   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007125   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007126   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007127   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007130   000005 631400 60                 EPPR1   5
        59 007131   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007132   000000 011000                    NOP     0

     1491     7986        /*E* ERROR: ZIG-4084-C
     1492     7987             MESSAGE: A record cannot be both the owner and a member of
     1493     7988                      the same set.
     1494     7989        */
     1495     7990    8                                       END;

   7990 59 007133   007151 710000 59                 TRA     s:8000
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:275  

     1496     7991    8                                   ELSE DO;

     1497     7992    8                                       FLAG_ERROR = '1'B;

   7992 59 007134   400000 236003                    LDQ     -131072,DU
        59 007135   000046 756000 0                  STQ     FLAG_ERROR

     1498     7993    8                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4085);

   7993 59 007136   000000 235000 7                  LDA     LINE_COUNT
        59 007137   000002 135007                    SBLA    2,DL
        59 007140   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007141   000316 237000 60                 LDAQ    206
        59 007142   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007143   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007144   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007145   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007146   000005 631400 60                 EPPR1   5
        59 007147   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007150   000000 011000                    NOP     0

     1499     7994        /*E* ERROR: ZIG-4085-C
     1500     7995             MESSAGE: This record is already declared as a member of this
     1501     7996                      set.
     1502     7997        */
     1503     7998    8                                       END;

     1504     7999    7                               END; /* IF */

     1505     8000    7                           IF NOT FLAG_ERROR THEN DO;

   8000 59 007151   000046 234000 0                  SZN     FLAG_ERROR
        59 007152   012440 604000 59                 TMI     s:8607

     1506     8001    7                               CALL FINDD_6('SO      ',LAST_SO_DBK);
              8001                                        /* add SMs after SOs */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:276  

   8001 59 007153   000306 630400 60                 EPPR0   198
        59 007154   000001 631400 60                 EPPR1   1
        59 007155   000000 701000 xent               TSX1    FINDD_6
        59 007156   000000 011000                    NOP     0

     1507     8002    7                               CALL FINDOS_6('SC-SOSM ');

   8002 59 007157   000077 630400 60                 EPPR0   63
        59 007160   000013 631400 60                 EPPR1   11
        59 007161   000000 701000 xent               TSX1    FINDOS_6
        59 007162   000000 011000                    NOP     0

     1508     8003    7                               CALL FINDPS_6('SC-SOSM ');

   8003 59 007163   000077 630400 60                 EPPR0   63
        59 007164   000013 631400 60                 EPPR1   11
        59 007165   000000 701000 xent               TSX1    FINDPS_6
        59 007166   000000 011000                    NOP     0

     1509     8004    7                               CALL FETCHD_6('RC      ',LAST_RC_DBK);
              8004                                        /* restore RC currency */

   8004 59 007167   000100 630400 60                 EPPR0   64
        59 007170   000001 631400 60                 EPPR1   1
        59 007171   000000 701000 xent               TSX1    FETCHD_6
        59 007172   000000 011000                    NOP     0

     1510     8005    7                               UWA.SM = '0'B;

   8005 59 007173   000000 100400                    MLR     fill='000'O
        59 007174   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 007175   000360 000060 57                 ADSC9   UWA+240                  cn=0,n=48

     1511     8006    7                               UWA.SM.INSTYPE = 9;

   8006 59 007176   000011 235007                    LDA     9,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:277  
        59 007177   000360 755000 57                 STA     UWA+240

     1512     8007    7                               UWA.SM.RETTYPE = 9;

   8007 59 007200   000361 755000 57                 STA     UWA+241

     1513     8008    7                               IF (UWA.RC.PSMODE = 2) /* via */

   8008 59 007201   000271 236000 57                 LDQ     UWA+185
        59 007202   000002 116007                    CMPQ    2,DL
        59 007203   007213 601000 59                 TNZ     s:8013
        59 007204   000000 470400 8                  LDP0    LAST_RC$
        59 007205   000010 236100                    LDQ     8,,PR0
        59 007206   777777 376007                    ANQ     -1,DL
        59 007207   000073 116000 0                  CMPQ    LAST_SC_SN
        59 007210   007213 601000 59                 TNZ     s:8013

     1514     8009    7                                  AND (LAST_RC$->TABLES.DBK_RC(0) = LAST_SC_SN)
              8009                                           /* via this set */
     1515     8010    8                               THEN DO;

     1516     8011    8                                   UWA.SM.PSMODE = 1;

   8011 59 007211   000001 235007                    LDA     1,DL
        59 007212   000366 755000 57                 STA     UWA+246

     1517     8012    8                                   END;

     1518     8013    7                               IF (LAST_RC$->TABLES.DBK_RC(0) = LAST_SC_SN)
              8013                                        /* VIA this SC */

   8013 59 007213   000000 470400 8                  LDP0    LAST_RC$
        59 007214   000010 236100                    LDQ     8,,PR0
        59 007215   777777 376007                    ANQ     -1,DL
        59 007216   000073 116000 0                  CMPQ    LAST_SC_SN
        59 007217   007222 601000 59                 TNZ     s:8015

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:278  
     1519     8014    7                               THEN LAST_RC$->TABLES.DBK_RC(0) = 0;
              8014                                        /* if any ~0 in pas2,err */

   8014 59 007220   000000 220003                    LDX0    0,DU
        59 007221   000010 440100                    SXL0    8,,PR0

     1520     8015    7                               IF UWA.RC.PSMODE = 4 THEN /* INDEXED */

   8015 59 007222   000271 235000 57                 LDA     UWA+185
        59 007223   000004 115007                    CMPA    4,DL
        59 007224   007240 601000 59                 TNZ     s:8019

     1521     8016    8                               DO;

     1522     8017    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4855);

   8017 59 007225   000000 236000 7                  LDQ     LINE_COUNT
        59 007226   000002 136007                    SBLQ    2,DL
        59 007227   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 007230   000304 237000 60                 LDAQ    196
        59 007231   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007232   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 007233   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 007234   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007235   000005 631400 60                 EPPR1   5
        59 007236   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007237   000000 011000                    NOP     0

     1523     8018    8                                   END;

     1524     8019    7                               UWA.SM.SEQDUP = UWA.SC.SEQDUP;

   8019 59 007240   000320 235000 57                 LDA     UWA+208
        59 007241   000363 755000 57                 STA     UWA+243

     1525     8020    7                               CALL STRE_6('SM      ');

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:279  
   8020 59 007242   000102 630400 60                 EPPR0   66
        59 007243   000013 631400 60                 EPPR1   11
        59 007244   000000 701000 xent               TSX1    STRE_6
        59 007245   000000 011000                    NOP     0

     1526     8021    7                               LAST_SM_DBK = UWA.DIRECT_REF;

   8021 59 007246   000036 235000 57                 LDA     UWA+30
        59 007247   000102 755000 0                  STA     LAST_SM_DBK

     1527     8022    7                               CALL FINDNS_6('RC-SOSM ');

   8022 59 007250   000074 630400 60                 EPPR0   60
        59 007251   000013 631400 60                 EPPR1   11
        59 007252   000000 701000 xent               TSX1    FINDNS_6
        59 007253   000000 011000                    NOP     0

     1528     8023    7                               CALL FINDD_6('SM      ',LAST_SM_DBK);

   8023 59 007254   000320 630400 60                 EPPR0   208
        59 007255   000001 631400 60                 EPPR1   1
        59 007256   000000 701000 xent               TSX1    FINDD_6
        59 007257   000000 011000                    NOP     0

     1529     8024    7                               CALL CONNECT_6('RC-SOSM ');

   8024 59 007260   000074 630400 60                 EPPR0   60
        59 007261   000013 631400 60                 EPPR1   11
        59 007262   000000 701000 xent               TSX1    CONNECT_6
        59 007263   000000 011000                    NOP     0

     1530     8025    7                               UWA.OA.NUMB_SM = UWA.OA.NUMB_SM + 1;

   8025 59 007264   000222 054000 57                 AOS     UWA+146

     1531     8026    7                               UWA.S_S = '0'B;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:280  
   8026 59 007265   000000 100400                    MLR     fill='000'O
        59 007266   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 007267   000374 000020 57                 ADSC9   UWA+252                  cn=0,n=16

     1532     8027    7                               UWA.S_S.STYP = 2;

   8027 59 007270   000002 235007                    LDA     2,DL
        59 007271   000374 755000 57                 STA     UWA+252

     1533     8028    7                               UWA.S_S.SC_SSH = LAST_SC_DBK;

   8028 59 007272   000072 236000 0                  LDQ     LAST_SC_DBK
        59 007273   000375 756000 57                 STQ     UWA+253

     1534     8029    7                               UWA.S_S.SOSM_SSH = LAST_SO_DBK;

   8029 59 007274   000074 235000 0                  LDA     LAST_SO_DBK
        59 007275   000376 755000 57                 STA     UWA+254

     1535     8030    7                               CALL STRE_6('S-S      ');

   8030 59 007276   000105 630400 60                 EPPR0   69
        59 007277   000013 631400 60                 EPPR1   11
        59 007300   000000 701000 xent               TSX1    STRE_6
        59 007301   000000 011000                    NOP     0

     1536     8031    7                               UWA.OA.NUMB_SS = UWA.OA.NUMB_SS + 1;

   8031 59 007302   000223 054000 57                 AOS     UWA+147

     1537     8032    7                               END; /* IF */

     1538     8033    6                           END; /* ELSE */

     1539     8034    5                       END;

   8034 59 007303   012440 710000 59                 TRA     s:8607
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:281  

     1540     8035    4               CASE(%AUTO); /* INSERTION IS AUTOMATIC */

     1541     8036    4                   UWA.SM.INSTYPE = 0;

   8036 59 007304   000360 450000 57                 STZ     UWA+240
        59 007305   012440 710000 59                 TRA     s:8607

     1542     8037    4               CASE(%MANUAL); /* INSERTION IS MANUAL */

     1543     8038    4                   UWA.SM.INSTYPE = 1;

   8038 59 007306   000001 235007                    LDA     1,DL
        59 007307   000360 755000 57                 STA     UWA+240
        59 007310   012440 710000 59                 TRA     s:8607

     1544     8039    4               CASE(%MANDATORY); /* RETENTION IS MANDATORY */

     1545     8040    4                   UWA.SM.RETTYPE = 0;

   8040 59 007311   000361 450000 57                 STZ     UWA+241
        59 007312   012440 710000 59                 TRA     s:8607

     1546     8041    4               CASE(%OPTIONAL); /* RETENTION IS OPTIONAL */

     1547     8042    4                   UWA.SM.RETTYPE = 1;

   8042 59 007313   000001 235007                    LDA     1,DL
        59 007314   000361 755000 57                 STA     UWA+241
        59 007315   012440 710000 59                 TRA     s:8607

     1548     8043    4               CASE(%LINKED); /* LINKED TO OWNER */

     1549     8044    4                   LINKED = '1'B;

   8044 59 007316   400000 236003                    LDQ     -131072,DU
        59 007317   000037 756000 0                  STQ     LINKED
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:282  
        59 007320   012440 710000 59                 TRA     s:8607

     1550     8045        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:283  
     1551     8046        /******************************************
     1552     8047        *  DUPS NOT ALLOWED clause                *
     1553     8048        ******************************************/
     1554     8049    4               CASE(%NOT3); /* DUPS NOT ALLOWED FOR... */

     1555     8050    4                   CALL FINDD_6('SM      ',LAST_SM_DBK);

   8050 59 007321   000320 630400 60                 EPPR0   208
        59 007322   000001 631400 60                 EPPR1   1
        59 007323   000000 701000 xent               TSX1    FINDD_6
        59 007324   000000 011000                    NOP     0

     1556     8051    4                   UWA.SM.MEMDUP = 1;

   8051 59 007325   000001 235007                    LDA     1,DL
        59 007326   000362 755000 57                 STA     UWA+242

     1557     8052    4                   CALL MODIFY_6('SM      ');

   8052 59 007327   000102 630400 60                 EPPR0   66
        59 007330   000013 631400 60                 EPPR1   11
        59 007331   000000 701000 xent               TSX1    MODIFY_6
        59 007332   000000 011000                    NOP     0
        59 007333   012440 710000 59                 TRA     s:8607

     1558     8053    4               CASE(%DUP_FR); /* DUPS NOT ALLOWED FOR dbid[,dbidn] */

     1559     8054        /* -make sure this field has been defined
     1560     8055           -update FR to show that it owns a CF
     1561     8056           -make sure this field was defined in this member record
     1562     8057           -store a CF off this record's SM */
     1563     8058    4   DUP:
     1564     8059    4                   WORD1 = QFR_NAME;

   8059 59 007334   040000 100400       DUP          MLR     fill='040'O
        59 007335   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 007336   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:284  

     1565     8060    4                   IF WORD1 = 'KEY' OR WORD1 = 'IS' OR

   8060 59 007337   040000 106400                    CMPC    fill='040'O
        59 007340   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007341   000062 000003 58                 ADSC9   50                       cn=0,n=3
        59 007342   007377 600000 59                 TZE     s:8065
        59 007343   040000 106400                    CMPC    fill='040'O
        59 007344   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007345   000105 000002 58                 ADSC9   69                       cn=0,n=2
        59 007346   007377 600000 59                 TZE     s:8065
        59 007347   040000 106400                    CMPC    fill='040'O
        59 007350   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007351   000106 000003 58                 ADSC9   70                       cn=0,n=3
        59 007352   007377 600000 59                 TZE     s:8065
        59 007353   040000 106400                    CMPC    fill='040'O
        59 007354   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007355   000107 000011 58                 ADSC9   71                       cn=0,n=9
        59 007356   007377 600000 59                 TZE     s:8065
        59 007357   040000 106400                    CMPC    fill='040'O
        59 007360   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007361   000112 000004 58                 ADSC9   74                       cn=0,n=4
        59 007362   007377 600000 59                 TZE     s:8065
        59 007363   040000 106400                    CMPC    fill='040'O
        59 007364   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007365   000113 000012 58                 ADSC9   75                       cn=0,n=10
        59 007366   007377 600000 59                 TZE     s:8065
        59 007367   040000 106400                    CMPC    fill='040'O
        59 007370   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007371   000116 000003 58                 ADSC9   78                       cn=0,n=3
        59 007372   007377 600000 59                 TZE     s:8065
        59 007373   040000 106400                    CMPC    fill='040'O
        59 007374   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007375   000117 000011 58                 ADSC9   79                       cn=0,n=9
        59 007376   007403 601000 59                 TNZ     s:8068

     1566     8061    4                      WORD1 = 'ASC' OR WORD1 = 'ASCENDING' OR
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:285  
     1567     8062    4                      WORD1 = 'DESC' OR WORD1 = 'DESCENDING' OR
     1568     8063    4                      WORD1 = 'SET' OR WORD1 = 'SELECTION' THEN
     1569     8064    5                   DO;

     1570     8065    5                       PARAN.REJECT = '1'B;

   8065 59 007377   200003 470500                    LDP0    @PARAN,,AUTO
        59 007400   000200 236003                    LDQ     128,DU
        59 007401   000000 256100                    ORSQ    0,,PR0

     1571     8066    5                       RETURN;

   8066 59 007402   000000 702200 xent               TSX2  ! X66_ARET

     1572     8067    5                       END;
     1573     8068    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.DUP,

   8068 59 007403   000110 237000 60                 LDAQ    72
        59 007404   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 007405   000322 237000 60                 LDAQ    210
        59 007406   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 007407   200060 630500                    EPPR0   LNO,,AUTO
        59 007410   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 007411   000024 236000 60                 LDQ     20
        59 007412   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 007413   000114 237000 60                 LDAQ    76
        59 007414   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 007415   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007416   000020 631400 60                 EPPR1   16
        59 007417   000000 701000 xent               TSX1    ADD_SN
        59 007420   000000 011000                    NOP     0

     1574     8069    4                      EXPLCT,LAST_RC_DBK);
     1575     8070    5                   IF (FOUND ~= %FOUNDDEF) THEN DO;

   8070 59 007421   000133 235000 0                  LDA     FOUND
        59 007422   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:286  
        59 007423   007440 600000 59                 TZE     s:8078

     1576     8071    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4820);

   8071 59 007424   000000 236000 7                  LDQ     LINE_COUNT
        59 007425   000002 136007                    SBLQ    2,DL
        59 007426   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 007427   000326 237000 60                 LDAQ    214
        59 007430   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007431   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007432   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007433   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007434   000005 631400 60                 EPPR1   5
        59 007435   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007436   000000 011000                    NOP     0

     1577     8072        /*E* ERROR: ZIG-4820-C
     1578     8073             MESSAGE: The DUPLICATES NOT ALLOWED FOR field %U1 is invalid
     1579     8074                      because it is not a field of the record.
     1580     8075        */
     1581     8076    5                       END;

   8076 59 007437   012440 710000 59                 TRA     s:8607

     1582     8077    5                   ELSE DO;

     1583     8078    5                       CALL FETCHNS_6('SN-SE   '); /* FR */

   8078 59 007440   000107 630400 60                 EPPR0   71
        59 007441   000013 631400 60                 EPPR1   11
        59 007442   000000 701000 xent               TSX1    FETCHNS_6
        59 007443   000000 011000                    NOP     0

     1584     8079    5                       HOLD_DBK = UWA.DIRECT_REF;

   8079 59 007444   000036 235000 57                 LDA     UWA+30
        59 007445   200007 755100                    STA     HOLD_DBK,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:287  

     1585     8080    5                       UWA.FR.REF = 1;

   8080 59 007446   000001 236007                    LDQ     1,DL
        59 007447   000333 756000 57                 STQ     UWA+219

     1586     8081    5                       CALL MODIFY_6('FR      ');

   8081 59 007450   000116 630400 60                 EPPR0   78
        59 007451   000013 631400 60                 EPPR1   11
        59 007452   000000 701000 xent               TSX1    MODIFY_6
        59 007453   000000 011000                    NOP     0

     1587     8082    5                       CALL FINDOS_6('RC-FR   '); /* RC */

   8082 59 007454   000234 630400 60                 EPPR0   156
        59 007455   000013 631400 60                 EPPR1   11
        59 007456   000000 701000 xent               TSX1    FINDOS_6
        59 007457   000000 011000                    NOP     0

     1588     8083    6                       IF UWA.DIRECT_REF ~= LAST_RC_DBK THEN DO;

   8083 59 007460   000036 236000 57                 LDQ     UWA+30
        59 007461   000000 116000 4                  CMPQ    LAST_RC_DBK
        59 007462   007477 600000 59                 TZE     s:8087

     1589     8084    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4820);

   8084 59 007463   000000 235000 7                  LDA     LINE_COUNT
        59 007464   000002 135007                    SBLA    2,DL
        59 007465   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007466   000326 237000 60                 LDAQ    214
        59 007467   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007470   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007471   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007472   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007473   000005 631400 60                 EPPR1   5
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:288  
        59 007474   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007475   000000 011000                    NOP     0

     1590     8085    6                           END;

   8085 59 007476   012440 710000 59                 TRA     s:8607

     1591     8086    6                       ELSE DO;

     1592     8087    6                           CALL FINDD_6('SM      ',LAST_SM_DBK);

   8087 59 007477   000320 630400 60                 EPPR0   208
        59 007500   000001 631400 60                 EPPR1   1
        59 007501   000000 701000 xent               TSX1    FINDD_6
        59 007502   000000 011000                    NOP     0

     1593     8088    6                           UWA.C_F = '0'B;

   8088 59 007503   000000 100400                    MLR     fill='000'O
        59 007504   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 007505   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20

     1594     8089    6                           UWA.C_F.CTRLTYPE = 1; /* duplicate control */

   8089 59 007506   000001 235007                    LDA     1,DL
        59 007507   000401 755000 57                 STA     UWA+257

     1595     8090    6                           CALL STRE_6('C-F     ');

   8090 59 007510   000122 630400 60                 EPPR0   82
        59 007511   000013 631400 60                 EPPR1   11
        59 007512   000000 701000 xent               TSX1    STRE_6
        59 007513   000000 011000                    NOP     0

     1596     8091    6                           UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   8091 59 007514   000224 054000 57                 AOS     UWA+148
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:289  

     1597     8092    6                           CALL CONNECT_6('SMSS-CF ');

   8092 59 007515   000130 630400 60                 EPPR0   88
        59 007516   000013 631400 60                 EPPR1   11
        59 007517   000000 701000 xent               TSX1    CONNECT_6
        59 007520   000000 011000                    NOP     0

     1598     8093    6                           CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   8093 59 007521   000126 237000 60                 LDAQ    86
        59 007522   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007523   000125 236000 60                 LDQ     85
        59 007524   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 007525   200007 630500                    EPPR0   HOLD_DBK,,AUTO
        59 007526   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 007527   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007530   000124 631400 60                 EPPR1   84
        59 007531   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        59 007532   000000 011000                    NOP     0

     1599     8094    6                              'FR      ', 'C-F     ' );
     1600     8095    6                           END;

     1601     8096    5                       END;

   8096 59 007533   012440 710000 59                 TRA     s:8607

     1602     8097    4               CASE(%DUP_QRC);

     1603     8098    4                   CALL GET_WORD;

   8098 59 007534   012467 701000 59                 TSX1    GET_WORD
        59 007535   000000 011000                    NOP     0

     1604     8099    4                   IF WORD1 ~= LAST_RC_NAME THEN

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:290  
   8099 59 007536   040000 106400                    CMPC    fill='040'O
        59 007537   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007540   000050 000036 0                  ADSC9   LAST_RC_NAME             cn=0,n=30
        59 007541   007574 600000 59                 TZE     s:8107

     1605     8100    5                   DO;

     1606     8101    5                       CALL INDEX(CT1,' ',QFR_NAME);

   8101 59 007542   000000 124400                    SCM     mask='000'O
        59 007543   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 007544   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 007545   200050 000100                    ARG     CT1,,AUTO

     1607     8102    5                       CALL SET_FIELDS(1,CT1,QFR_NAME);

   8102 59 007546   000204 236000 60                 LDQ     132
        59 007547   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 007550   200050 630500                    EPPR0   CT1,,AUTO
        59 007551   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007552   000003 236000 60                 LDQ     3
        59 007553   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 007554   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007555   000005 631400 60                 EPPR1   5
        59 007556   000000 701000 xent               TSX1    SET_FIELDS
        59 007557   000000 011000                    NOP     0

     1608     8103    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4809);

   8103 59 007560   000000 235000 7                  LDA     LINE_COUNT
        59 007561   000002 135007                    SBLA    2,DL
        59 007562   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007563   000206 237000 60                 LDAQ    134
        59 007564   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007565   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007566   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007567   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:291  
        59 007570   000005 631400 60                 EPPR1   5
        59 007571   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007572   000000 011000                    NOP     0

     1609     8104    5                       END;

   8104 59 007573   012440 710000 59                 TRA     s:8607

     1610     8105    4                   ELSE
     1611     8106    5                   DO;

     1612     8107    5                       GOTO DUP;

   8107 59 007574   007334 710000 59                 TRA     DUP

     1613     8108    5                       END;
     1614     8109    4               CASE(%DUP_QFR);

     1615     8110    4                   CALL GET_WORD;

   8110 59 007575   012467 701000 59                 TSX1    GET_WORD
        59 007576   000000 011000                    NOP     0

     1616     8111    4                   QFR_NAME = WORD1;

   8111 59 007577   040000 100400                    MLR     fill='040'O
        59 007600   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 007601   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 007602   012440 710000 59                 TRA     s:8607

     1617     8112        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:292  
     1618     8113        /*****************************************
     1619     8114        *  SORT KEY clause                       *
     1620     8115        *****************************************/
     1621     8116    4               CASE(%SORTKEY_CL); /* KEY IS ASC/DESC... */

     1622     8117        /* -make sure this set is SORTED insertion
     1623     8118           -compare this SM's sort key fields with prior SM's */
     1624     8119    4                   SORTKEY = '1'B;

   8119 59 007603   400000 236003                    LDQ     -131072,DU
        59 007604   000036 756000 0                  STQ     SORTKEY

     1625     8120    4                   CALL FINDD_6('SM      ',LAST_SM_DBK);
              8120                            /* ensure SM fields filled in */

   8120 59 007605   000320 630400 60                 EPPR0   208
        59 007606   000001 631400 60                 EPPR1   1
        59 007607   000000 701000 xent               TSX1    FINDD_6
        59 007610   000000 011000                    NOP     0

     1626     8121    4                   CALL MODIFY_6('SM      ');

   8121 59 007611   000102 630400 60                 EPPR0   66
        59 007612   000013 631400 60                 EPPR1   11
        59 007613   000000 701000 xent               TSX1    MODIFY_6
        59 007614   000000 011000                    NOP     0

     1627     8122    5                   IF (UWA.SC.SETORD ~= 4) AND (UWA.SC.SETORD ~= 6) THEN DO;

   8122 59 007615   000312 235000 57                 LDA     UWA+202
        59 007616   000004 115007                    CMPA    4,DL
        59 007617   007635 600000 59                 TZE     s:8129
        59 007620   000006 115007                    CMPA    6,DL
        59 007621   007635 600000 59                 TZE     s:8129

     1628     8123    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4806);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:293  
   8123 59 007622   000000 236000 7                  LDQ     LINE_COUNT
        59 007623   000002 136007                    SBLQ    2,DL
        59 007624   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 007625   000330 237000 60                 LDAQ    216
        59 007626   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007627   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007630   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007631   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007632   000005 631400 60                 EPPR1   5
        59 007633   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007634   000000 011000                    NOP     0

     1629     8124        /*E* ERROR: ZIG-4806-C
     1630     8125             MESSAGE: The key clause is invalid because the set did not
     1631     8126                      specify SORTED insertion.
     1632     8127        */
     1633     8128    5                       END;

     1634     8129    5                   IF UWA.SC.SETORD = 4 THEN DO;

   8129 59 007635   000312 235000 57                 LDA     UWA+202
        59 007636   000004 115007                    CMPA    4,DL
        59 007637   012440 601000 59                 TNZ     s:8607

     1635     8130         /* compare this SM's sort key fields with last SM's */
     1636     8131         /* if SORTED BY DEFINED KEYS */
     1637     8132    6                       IF ~FIRST_MEMBER THEN DO;

   8132 59 007640   000101 236000 0                  LDQ     FIRST_MEMBER
        59 007641   400000 376003                    ANQ     -131072,DU
        59 007642   400000 676003                    ERQ     -131072,DU
        59 007643   012440 600000 59                 TZE     s:8607

     1638     8133    6                           END_OF_KEYS = '0'B;

   8133 59 007644   200011 450100                    STZ     END_OF_KEYS,,AUTO

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:294  
     1639     8134    6                           CALL FETCHNS_6('SMSS-CF '); /* curr CF */

   8134 59 007645   000130 630400 60                 EPPR0   88
        59 007646   000013 631400 60                 EPPR1   11
        59 007647   000000 701000 xent               TSX1    FETCHNS_6
        59 007650   000000 011000                    NOP     0

     1640     8135    6                           TCF = UWA.C_F;

   8135 59 007651   000100 100400                    MLR     fill='000'O
        59 007652   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20
        59 007653   200014 000024                    ADSC9   TCF,,AUTO                cn=0,n=20

     1641     8136    6                           CURR_CF_DBK = UWA.DIRECT_REF;

   8136 59 007654   000036 235000 57                 LDA     UWA+30
        59 007655   200012 755100                    STA     CURR_CF_DBK,,AUTO

     1642     8137    6                           CALL FETCHOS_6('FR-CFS  '); /* curr FR */

   8137 59 007656   000125 630400 60                 EPPR0   85
        59 007657   000013 631400 60                 EPPR1   11
        59 007660   000000 701000 xent               TSX1    FETCHOS_6
        59 007661   000000 011000                    NOP     0

     1643     8138    6                           TFR = UWA.FR;

   8138 59 007662   000100 100400                    MLR     fill='000'O
        59 007663   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68
        59 007664   200022 000104                    ADSC9   TFR,,AUTO                cn=0,n=68

     1644     8139        /* -make sure all required clauses have been specified
     1645     8140           -save SC DBK, SM DBK, THRU setname SN for pass2 */
     1646     8141    6                           CALL FINDPS_6('SC-SOSM '); /* prev SM */

   8141 59 007665   000077 630400 60                 EPPR0   63
        59 007666   000013 631400 60                 EPPR1   11
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:295  
        59 007667   000000 701000 xent               TSX1    FINDPS_6
        59 007670   000000 011000                    NOP     0

     1647     8142    6                           CALL FETCHNS_6('SMSS-CF '); /* prev CF */

   8142 59 007671   000130 630400 60                 EPPR0   88
        59 007672   000013 631400 60                 EPPR1   11
        59 007673   000000 701000 xent               TSX1    FETCHNS_6
        59 007674   000000 011000                    NOP     0

     1648     8143    6                           IF UWA.DB_STATUS = '0502100' /* end of set */

   8143 59 007675   040000 106400                    CMPC    fill='040'O
        59 007676   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 007677   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 007700   007714 601000 59                 TNZ     s:8150

     1649     8144    6                           THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

   8144 59 007701   000000 235000 7                  LDA     LINE_COUNT
        59 007702   000002 135007                    SBLA    2,DL
        59 007703   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007704   000334 237000 60                 LDAQ    220
        59 007705   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007706   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007707   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007710   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007711   000005 631400 60                 EPPR1   5
        59 007712   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007713   000000 011000                    NOP     0

     1650     8145        /*E* ERROR: ZIG-4860-C
     1651     8146             MESSAGE: The attributes of the DEFINED KEYS to be used
     1652     8147                      for sort must be identical for each member of
     1653     8148                      the set.
     1654     8149        */
     1655     8150    7                           DO WHILE ((UWA.DB_STATUS ~= '0502100') AND (~END_OF_KEYS));
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:296  

   8150 59 007714   010175 710000 59                 TRA     s:8207

     1656     8151    7                               PREV_CF_DBK = UWA.DIRECT_REF;

   8151 59 007715   000036 235000 57                 LDA     UWA+30
        59 007716   200013 755100                    STA     PREV_CF_DBK,,AUTO

     1657     8152    8                               IF TCF ~= UWA.C_F THEN DO;

   8152 59 007717   000000 106500                    CMPC    fill='000'O
        59 007720   200014 000024                    ADSC9   TCF,,AUTO                cn=0,n=20
        59 007721   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20
        59 007722   007751 600000 59                 TZE     s:8160

     1658     8153    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

   8153 59 007723   000000 236000 7                  LDQ     LINE_COUNT
        59 007724   000002 136007                    SBLQ    2,DL
        59 007725   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 007726   000334 237000 60                 LDAQ    220
        59 007727   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007730   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007731   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007732   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007733   000005 631400 60                 EPPR1   5
        59 007734   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007735   000000 011000                    NOP     0

     1659     8154    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4861);

   8154 59 007736   000000 235000 7                  LDA     LINE_COUNT
        59 007737   000002 135007                    SBLA    2,DL
        59 007740   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007741   000336 237000 60                 LDAQ    222
        59 007742   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007743   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:297  
        59 007744   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007745   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007746   000005 631400 60                 EPPR1   5
        59 007747   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 007750   000000 011000                    NOP     0

     1660     8155        /*E* ERROR: ZIG-4861-C
     1661     8156             MESSAGE: The keys do not match in terms of ASCENDING/
     1662     8157                      DESCENDING specifications.
     1663     8158        */
     1664     8159    8                                   END;

     1665     8160    7                               CALL FETCHOS_6('FR-CFS  '); /* prev FR */

   8160 59 007751   000125 630400 60                 EPPR0   85
        59 007752   000013 631400 60                 EPPR1   11
        59 007753   000000 701000 xent               TSX1    FETCHOS_6
        59 007754   000000 011000                    NOP     0

     1666     8161    8                               IF TFR.FTYPE ~= UWA.FR.FTYPE THEN DO;

   8161 59 007755   200024 236100                    LDQ     TFR+2,,AUTO
        59 007756   000334 116000 57                 CMPQ    UWA+220
        59 007757   010007 600000 59                 TZE     s:8170

     1667     8162    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

   8162 59 007760   000000 235000 7                  LDA     LINE_COUNT
        59 007761   000002 135007                    SBLA    2,DL
        59 007762   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007763   000334 237000 60                 LDAQ    220
        59 007764   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 007765   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 007766   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 007767   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 007770   000005 631400 60                 EPPR1   5
        59 007771   000000 701000 xent               TSX1    ZIG$D_DIAG
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:298  
        59 007772   000000 011000                    NOP     0

     1668     8163    8                                   CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4862);

   8163 59 007773   000000 235000 7                  LDA     LINE_COUNT
        59 007774   000002 135007                    SBLA    2,DL
        59 007775   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 007776   000342 237000 60                 LDAQ    226
        59 007777   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010000   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010001   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010002   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010003   000005 631400 60                 EPPR1   5
        59 010004   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010005   000000 011000                    NOP     0

     1669     8164        /*E* ERROR: ZIG-4862-C
     1670     8165             MESSAGE: The keys do not match in terms of data type
     1671     8166                      declarations.
     1672     8167        */
     1673     8168    8                                   END;

   8168 59 010006   010122 710000 59                 TRA     s:8195

     1674     8169    8                               ELSE DO;

     1675     8170    9                                   IF TFR.PREC ~= UWA.FR.PREC THEN DO;

   8170 59 010007   200025 236100                    LDQ     TFR+3,,AUTO
        59 010010   000335 116000 57                 CMPQ    UWA+221
        59 010011   010040 600000 59                 TZE     s:8178

     1676     8171    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

   8171 59 010012   000000 235000 7                  LDA     LINE_COUNT
        59 010013   000002 135007                    SBLA    2,DL
        59 010014   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:299  
        59 010015   000334 237000 60                 LDAQ    220
        59 010016   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010017   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010020   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010021   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010022   000005 631400 60                 EPPR1   5
        59 010023   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010024   000000 011000                    NOP     0

     1677     8172    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4863);

   8172 59 010025   000000 235000 7                  LDA     LINE_COUNT
        59 010026   000002 135007                    SBLA    2,DL
        59 010027   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010030   000344 237000 60                 LDAQ    228
        59 010031   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010032   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010033   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010034   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010035   000005 631400 60                 EPPR1   5
        59 010036   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010037   000000 011000                    NOP     0

     1678     8173        /*E* ERROR: ZIG-4863-C
     1679     8174             MESSAGE: The keys do not match in terms of precision
     1680     8175                      declarations.
     1681     8176        */
     1682     8177    9                                       END;

     1683     8178    9                                   IF TFR.SCALE ~= UWA.FR.SCALE THEN DO;

   8178 59 010040   200026 236100                    LDQ     TFR+4,,AUTO
        59 010041   000336 116000 57                 CMPQ    UWA+222
        59 010042   010071 600000 59                 TZE     s:8186

     1684     8179    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:300  
   8179 59 010043   000000 235000 7                  LDA     LINE_COUNT
        59 010044   000002 135007                    SBLA    2,DL
        59 010045   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010046   000334 237000 60                 LDAQ    220
        59 010047   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010050   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010051   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010052   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010053   000005 631400 60                 EPPR1   5
        59 010054   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010055   000000 011000                    NOP     0

     1685     8180    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4864);

   8180 59 010056   000000 235000 7                  LDA     LINE_COUNT
        59 010057   000002 135007                    SBLA    2,DL
        59 010060   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010061   000350 237000 60                 LDAQ    232
        59 010062   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010063   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010064   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010065   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010066   000005 631400 60                 EPPR1   5
        59 010067   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010070   000000 011000                    NOP     0

     1686     8181        /*E* ERROR: ZIG-4864-C
     1687     8182             MESSAGE: The keys do not match in terms of scale
     1688     8183                      declarations.
     1689     8184        */
     1690     8185    9                                       END;

     1691     8186    9                                   IF TFR.F_SIGN ~= UWA.FR.F_SIGN THEN DO;

   8186 59 010071   200027 236100                    LDQ     TFR+5,,AUTO
        59 010072   000337 116000 57                 CMPQ    UWA+223
        59 010073   010122 600000 59                 TZE     s:8195
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:301  

     1692     8187    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

   8187 59 010074   000000 235000 7                  LDA     LINE_COUNT
        59 010075   000002 135007                    SBLA    2,DL
        59 010076   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010077   000334 237000 60                 LDAQ    220
        59 010100   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010101   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010102   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010103   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010104   000005 631400 60                 EPPR1   5
        59 010105   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010106   000000 011000                    NOP     0

     1693     8188    9                                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4865);

   8188 59 010107   000000 235000 7                  LDA     LINE_COUNT
        59 010110   000002 135007                    SBLA    2,DL
        59 010111   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010112   000352 237000 60                 LDAQ    234
        59 010113   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010114   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010115   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010116   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010117   000005 631400 60                 EPPR1   5
        59 010120   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010121   000000 011000                    NOP     0

     1694     8189        /*E* ERROR: ZIG-4865-C
     1695     8190             MESSAGE: The keys do not match in terms of sign
     1696     8191                      declarations.
     1697     8192        */
     1698     8193    9                                       END;

     1699     8194    8                                   END;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:302  
     1700     8195    7                               CALL FINDD_6('C-F      ',CURR_CF_DBK);

   8195 59 010122   200012 630500                    EPPR0   CURR_CF_DBK,,AUTO
        59 010123   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010124   000175 236000 60                 LDQ     125
        59 010125   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010126   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010127   000001 631400 60                 EPPR1   1
        59 010130   000000 701000 xent               TSX1    FINDD_6
        59 010131   000000 011000                    NOP     0

     1701     8196    7                               CALL FETCHNS_6('SMSS-CF '); /* curr CF */

   8196 59 010132   000130 630400 60                 EPPR0   88
        59 010133   000013 631400 60                 EPPR1   11
        59 010134   000000 701000 xent               TSX1    FETCHNS_6
        59 010135   000000 011000                    NOP     0

     1702     8197    7                               IF UWA.DB_STATUS = '0502100'

   8197 59 010136   040000 106400                    CMPC    fill='040'O
        59 010137   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 010140   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 010141   010145 601000 59                 TNZ     s:8200

     1703     8198    7                               THEN END_OF_KEYS = '1'B;

   8198 59 010142   400000 236003                    LDQ     -131072,DU
        59 010143   200011 756100                    STQ     END_OF_KEYS,,AUTO
        59 010144   010161 710000 59                 TRA     s:8205

     1704     8199    8                               ELSE DO;

     1705     8200    8                                   TCF = UWA.C_F;

   8200 59 010145   000100 100400                    MLR     fill='000'O
        59 010146   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:303  
        59 010147   200014 000024                    ADSC9   TCF,,AUTO                cn=0,n=20

     1706     8201    8                                   CURR_CF_DBK = UWA.DIRECT_REF;

   8201 59 010150   000036 235000 57                 LDA     UWA+30
        59 010151   200012 755100                    STA     CURR_CF_DBK,,AUTO

     1707     8202    8                                   CALL FETCHOS_6('FR-CFS  ');/* curr FR */

   8202 59 010152   000125 630400 60                 EPPR0   85
        59 010153   000013 631400 60                 EPPR1   11
        59 010154   000000 701000 xent               TSX1    FETCHOS_6
        59 010155   000000 011000                    NOP     0

     1708     8203    8                                   TFR = UWA.FR;

   8203 59 010156   000100 100400                    MLR     fill='000'O
        59 010157   000332 000104 57                 ADSC9   UWA+218                  cn=0,n=68
        59 010160   200022 000104                    ADSC9   TFR,,AUTO                cn=0,n=68

     1709     8204    8                                   END;

     1710     8205    7                               CALL FINDD_6('C-F      ',PREV_CF_DBK);

   8205 59 010161   200013 630500                    EPPR0   PREV_CF_DBK,,AUTO
        59 010162   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010163   000175 236000 60                 LDQ     125
        59 010164   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010165   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010166   000001 631400 60                 EPPR1   1
        59 010167   000000 701000 xent               TSX1    FINDD_6
        59 010170   000000 011000                    NOP     0

     1711     8206    7                               CALL FETCHNS_6('SMSS-CF '); /* prev CF */

   8206 59 010171   000130 630400 60                 EPPR0   88
        59 010172   000013 631400 60                 EPPR1   11
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:304  
        59 010173   000000 701000 xent               TSX1    FETCHNS_6
        59 010174   000000 011000                    NOP     0

     1712     8207    7                               END;

   8207 59 010175   040000 106400                    CMPC    fill='040'O
        59 010176   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 010177   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 010200   010205 600000 59                 TZE     s:8208
        59 010201   200011 236100                    LDQ     END_OF_KEYS,,AUTO
        59 010202   400000 376003                    ANQ     -131072,DU
        59 010203   400000 676003                    ERQ     -131072,DU
        59 010204   007715 601000 59                 TNZ     s:8151

     1713     8208    6                          IF (UWA.DB_STATUS = '0502100') AND (END_OF_KEYS = '1'B) THEN
              8208                                    ;

   8208 59 010205   040000 106400                    CMPC    fill='040'O
        59 010206   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 010207   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 010210   010213 601000 59                 TNZ     s:8210
        59 010211   200011 234100                    SZN     END_OF_KEYS,,AUTO
        59 010212   012440 604000 59                 TMI     s:8607

     1714     8209    7                           ELSE DO;

     1715     8210    7                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4860);

   8210 59 010213   000000 235000 7                  LDA     LINE_COUNT
        59 010214   000002 135007                    SBLA    2,DL
        59 010215   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010216   000334 237000 60                 LDAQ    220
        59 010217   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010220   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010221   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010222   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010223   000005 631400 60                 EPPR1   5
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:305  
        59 010224   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010225   000000 011000                    NOP     0

     1716     8211    7                               END;

     1717     8212    6                           END;

     1718     8213    5                       END;

   8213 59 010226   012440 710000 59                 TRA     s:8607

     1719     8214    4               CASE(%ASCENDING); /* KEY IS ASCENDING... */

     1720     8215    4                   DESC = 0;

   8215 59 010227   000103 450000 0                  STZ     DESC
        59 010230   012440 710000 59                 TRA     s:8607

     1721     8216    4               CASE(%DESCENDING); /* KEY IS DESCENDING... */

     1722     8217    4                   DESC = 1;

   8217 59 010231   000001 235007                    LDA     1,DL
        59 010232   000103 755000 0                  STA     DESC
        59 010233   012440 710000 59                 TRA     s:8607

     1723     8218    4               CASE(%SKC_FR); /* KEY IS ASC/DESC dbid */

     1724     8219        /* -make sure this field is defined previously
     1725     8220           - make sure this field is not TYPE CHAR VARYING
     1726     8221           -modify this field's FR to show that it owns a CF
     1727     8222           -store a CF off this member record's SM */
     1728     8223    4   SKC:
     1729     8224    4                   WORD1 = QFR_NAME;

   8224 59 010234   040000 100400       SKC          MLR     fill='040'O
        59 010235   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:306  
        59 010236   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

     1730     8225    4                   IF WORD1 = 'DUPS' OR WORD1 = 'DUPLICATES' OR

   8225 59 010237   040000 106400                    CMPC    fill='040'O
        59 010240   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010241   000034 000004 58                 ADSC9   28                       cn=0,n=4
        59 010242   010257 600000 59                 TZE     s:8228
        59 010243   040000 106400                    CMPC    fill='040'O
        59 010244   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010245   000035 000012 58                 ADSC9   29                       cn=0,n=10
        59 010246   010257 600000 59                 TZE     s:8228
        59 010247   040000 106400                    CMPC    fill='040'O
        59 010250   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010251   000116 000003 58                 ADSC9   78                       cn=0,n=3
        59 010252   010257 600000 59                 TZE     s:8228
        59 010253   040000 106400                    CMPC    fill='040'O
        59 010254   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010255   000117 000011 58                 ADSC9   79                       cn=0,n=9
        59 010256   010263 601000 59                 TNZ     s:8231

     1731     8226    4                      WORD1 = 'SET' OR WORD1 = 'SELECTION' THEN
     1732     8227    5                   DO;

     1733     8228    5                       PARAN.REJECT = '1'B;

   8228 59 010257   200003 470500                    LDP0    @PARAN,,AUTO
        59 010260   000200 236003                    LDQ     128,DU
        59 010261   000000 256100                    ORSQ    0,,PR0

     1734     8229    5                       RETURN;

   8229 59 010262   000000 702200 xent               TSX2  ! X66_ARET

     1735     8230    5                       END;
     1736     8231    4                   CALL ADD_SN(%ZIG_RTYPE_FR,WORD1,0,LNO,FOUND,RELTYPE.SEQ,

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:307  
   8231 59 010263   000110 237000 60                 LDAQ    72
        59 010264   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 010265   000354 237000 60                 LDAQ    236
        59 010266   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 010267   200060 630500                    EPPR0   LNO,,AUTO
        59 010270   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 010271   000024 236000 60                 LDQ     20
        59 010272   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 010273   000114 237000 60                 LDAQ    76
        59 010274   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 010275   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010276   000020 631400 60                 EPPR1   16
        59 010277   000000 701000 xent               TSX1    ADD_SN
        59 010300   000000 011000                    NOP     0

     1737     8232    4                      EXPLCT,LAST_RC_DBK);
     1738     8233    5                   IF (FOUND ~= %FOUNDDEF) THEN DO;

   8233 59 010301   000133 235000 0                  LDA     FOUND
        59 010302   000002 115007                    CMPA    2,DL
        59 010303   010360 600000 59                 TZE     s:8246

     1739     8234    5                       CALL INDEX(CT1,' ',WORD1);

   8234 59 010304   000000 124400                    SCM     mask='000'O
        59 010305   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010306   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 010307   200050 000100                    ARG     CT1,,AUTO

     1740     8235    5                       CALL SET_FIELDS(1,CT1,WORD1);

   8235 59 010310   000023 236000 60                 LDQ     19
        59 010311   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 010312   200050 630500                    EPPR0   CT1,,AUTO
        59 010313   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010314   000003 236000 60                 LDQ     3
        59 010315   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:308  
        59 010316   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010317   000005 631400 60                 EPPR1   5
        59 010320   000000 701000 xent               TSX1    SET_FIELDS
        59 010321   000000 011000                    NOP     0

     1741     8236    5                       CALL FETCHD_6('SN      ',LAST_SC_SN);

   8236 59 010322   000356 630400 60                 EPPR0   238
        59 010323   000001 631400 60                 EPPR1   1
        59 010324   000000 701000 xent               TSX1    FETCHD_6
        59 010325   000000 011000                    NOP     0

     1742     8237    5                       CALL INDEX(CT2,' ',UWA.SN.SENAME);

   8237 59 010326   000000 124400                    SCM     mask='000'O
        59 010327   000427 000036 57                 ADSC9   UWA+279                  cn=0,n=30
        59 010330   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 010331   200051 000100                    ARG     CT2,,AUTO

     1743     8238    5                       CALL SET_FIELDS(2,CT2,UWA.SN.SENAME);

   8238 59 010332   000360 236000 60                 LDQ     240
        59 010333   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 010334   200051 630500                    EPPR0   CT2,,AUTO
        59 010335   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010336   000010 236000 60                 LDQ     8
        59 010337   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010340   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010341   000005 631400 60                 EPPR1   5
        59 010342   000000 701000 xent               TSX1    SET_FIELDS
        59 010343   000000 011000                    NOP     0

     1744     8239    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4810);

   8239 59 010344   000000 235000 7                  LDA     LINE_COUNT
        59 010345   000002 135007                    SBLA    2,DL
        59 010346   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:309  
        59 010347   000362 237000 60                 LDAQ    242
        59 010350   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010351   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010352   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010353   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010354   000005 631400 60                 EPPR1   5
        59 010355   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010356   000000 011000                    NOP     0

     1745     8240        /*E* ERROR: ZIG-4810-C
     1746     8241             MESSAGE: The sort key "%U1" is not a field of the "%U2" set
     1747     8242                      member record.
     1748     8243        */
     1749     8244    5                       END;

   8244 59 010357   012440 710000 59                 TRA     s:8607

     1750     8245    5                   ELSE DO;

     1751     8246    5                       CALL FETCHNS_6('SN-SE   '); /* FR of sort key */

   8246 59 010360   000107 630400 60                 EPPR0   71
        59 010361   000013 631400 60                 EPPR1   11
        59 010362   000000 701000 xent               TSX1    FETCHNS_6
        59 010363   000000 011000                    NOP     0

     1752     8247    5                       HOLD_DBK = UWA.DIRECT_REF;

   8247 59 010364   000036 235000 57                 LDA     UWA+30
        59 010365   200007 755100                    STA     HOLD_DBK,,AUTO

     1753     8248    6                       IF UWA.FR.FTYPE = 19 THEN DO; /* char varying */

   8248 59 010366   000334 236000 57                 LDQ     UWA+220
        59 010367   000023 116007                    CMPQ    19,DL
        59 010370   010404 601000 59                 TNZ     s:8251

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:310  
     1754     8249    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4832);

   8249 59 010371   000000 235000 7                  LDA     LINE_COUNT
        59 010372   000002 135007                    SBLA    2,DL
        59 010373   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010374   000262 237000 60                 LDAQ    178
        59 010375   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010376   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010377   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010400   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010401   000005 631400 60                 EPPR1   5
        59 010402   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010403   000000 011000                    NOP     0

     1755     8250    6                           END;

     1756     8251    5                       UWA.FR.REF = 1;

   8251 59 010404   000001 235007                    LDA     1,DL
        59 010405   000333 755000 57                 STA     UWA+219

     1757     8252    5                       CALL MODIFY_6('FR      ');

   8252 59 010406   000116 630400 60                 EPPR0   78
        59 010407   000013 631400 60                 EPPR1   11
        59 010410   000000 701000 xent               TSX1    MODIFY_6
        59 010411   000000 011000                    NOP     0

     1758     8253    5                       CALL FINDOS_6('RC-FR   '); /* RC of sort key */

   8253 59 010412   000234 630400 60                 EPPR0   156
        59 010413   000013 631400 60                 EPPR1   11
        59 010414   000000 701000 xent               TSX1    FINDOS_6
        59 010415   000000 011000                    NOP     0

     1759     8254    5                       CALL FINDD_6('SM      ',LAST_SM_DBK);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:311  
   8254 59 010416   000320 630400 60                 EPPR0   208
        59 010417   000001 631400 60                 EPPR1   1
        59 010420   000000 701000 xent               TSX1    FINDD_6
        59 010421   000000 011000                    NOP     0

     1760     8255    5                       UWA.C_F = '0'B;

   8255 59 010422   000000 100400                    MLR     fill='000'O
        59 010423   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 010424   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20

     1761     8256    5                       UWA.C_F.CTRLSEQ = DESC;

   8256 59 010425   000103 235000 0                  LDA     DESC
        59 010426   000403 755000 57                 STA     UWA+259

     1762     8257    5                       CALL STRE_6('C-F     ');

   8257 59 010427   000122 630400 60                 EPPR0   82
        59 010430   000013 631400 60                 EPPR1   11
        59 010431   000000 701000 xent               TSX1    STRE_6
        59 010432   000000 011000                    NOP     0

     1763     8258    5                       CALL CONNECT_6('SMSS-CF ');

   8258 59 010433   000130 630400 60                 EPPR0   88
        59 010434   000013 631400 60                 EPPR1   11
        59 010435   000000 701000 xent               TSX1    CONNECT_6
        59 010436   000000 011000                    NOP     0

     1764     8259    5                       CALL MOVE_TO_FIRST_POS( HOLD_DBK, 'FR-CFS  ',

   8259 59 010437   000126 237000 60                 LDAQ    86
        59 010440   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010441   000125 236000 60                 LDQ     85
        59 010442   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 010443   200007 630500                    EPPR0   HOLD_DBK,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:312  
        59 010444   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 010445   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010446   000124 631400 60                 EPPR1   84
        59 010447   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        59 010450   000000 011000                    NOP     0

     1765     8260    5                          'FR      ', 'C-F     ' );
     1766     8261    5                       UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   8261 59 010451   000224 054000 57                 AOS     UWA+148

     1767     8262    5                       END;

   8262 59 010452   012440 710000 59                 TRA     s:8607

     1768     8263    4               CASE(%SKC_QRC);

     1769     8264    4                   CALL GET_WORD;

   8264 59 010453   012467 701000 59                 TSX1    GET_WORD
        59 010454   000000 011000                    NOP     0

     1770     8265    4                   IF WORD1 ~= LAST_RC_NAME THEN

   8265 59 010455   040000 106400                    CMPC    fill='040'O
        59 010456   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010457   000050 000036 0                  ADSC9   LAST_RC_NAME             cn=0,n=30
        59 010460   010513 600000 59                 TZE     s:8273

     1771     8266    5                   DO;

     1772     8267    5                       CALL INDEX(CT1,' ',QFR_NAME);

   8267 59 010461   000000 124400                    SCM     mask='000'O
        59 010462   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 010463   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 010464   200050 000100                    ARG     CT1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:313  

     1773     8268    5                       CALL SET_FIELDS(1,CT1,QFR_NAME);

   8268 59 010465   000204 236000 60                 LDQ     132
        59 010466   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 010467   200050 630500                    EPPR0   CT1,,AUTO
        59 010470   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010471   000003 236000 60                 LDQ     3
        59 010472   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010473   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010474   000005 631400 60                 EPPR1   5
        59 010475   000000 701000 xent               TSX1    SET_FIELDS
        59 010476   000000 011000                    NOP     0

     1774     8269    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%WARN_SEV,4809);

   8269 59 010477   000000 235000 7                  LDA     LINE_COUNT
        59 010500   000002 135007                    SBLA    2,DL
        59 010501   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010502   000206 237000 60                 LDAQ    134
        59 010503   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010504   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010505   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010506   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010507   000005 631400 60                 EPPR1   5
        59 010510   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010511   000000 011000                    NOP     0

     1775     8270    5                       END;

   8270 59 010512   012440 710000 59                 TRA     s:8607

     1776     8271    4                   ELSE
     1777     8272    5                   DO;

     1778     8273    5                       GOTO SKC;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:314  
   8273 59 010513   010234 710000 59                 TRA     SKC

     1779     8274    5                       END;
     1780     8275    4               CASE(%SKC_QFR);

     1781     8276    4                   CALL GET_WORD;

   8276 59 010514   012467 701000 59                 TSX1    GET_WORD
        59 010515   000000 011000                    NOP     0

     1782     8277    4                   QFR_NAME = WORD1;

   8277 59 010516   040000 100400                    MLR     fill='040'O
        59 010517   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010520   000061 000036 0                  ADSC9   QFR_NAME                 cn=0,n=30
        59 010521   012440 710000 59                 TRA     s:8607

     1783     8278    4               CASE(%MFIRST); /* KEY IS...DUPS ARE FIRST ALLOWED */

     1784     8279    4                   UWA.SM.SEQDUP = 0;

   8279 59 010522   000363 450000 57                 STZ     UWA+243

     1785     8280    5                   IF UWA.SC.SETORD ~= 6 THEN DO;

   8280 59 010523   000312 236000 57                 LDQ     UWA+202
        59 010524   000006 116007                    CMPQ    6,DL
        59 010525   012440 600000 59                 TZE     s:8607

     1786     8281    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4123);

   8281 59 010526   000000 235000 7                  LDA     LINE_COUNT
        59 010527   000002 135007                    SBLA    2,DL
        59 010530   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010531   000366 237000 60                 LDAQ    246
        59 010532   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010533   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:315  
        59 010534   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 010535   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010536   000005 631400 60                 EPPR1   5
        59 010537   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010540   000000 011000                    NOP     0

     1787     8282        /*E* ERROR: ZIG-4123-C
     1788     8283             MESSAGE: The %U1 phrase can only be used when INSERTION IS
     1789     8284                      SORTED WITHIN record name is specified.
     1790     8285        */
     1791     8286    5                       END;

   8286 59 010541   012440 710000 59                 TRA     s:8607

     1792     8287    4               CASE(%MLAST); /* KEY IS ...DUPS ARE LAST ALLOWED */

     1793     8288    4                   UWA.SM.SEQDUP = 1;

   8288 59 010542   000001 235007                    LDA     1,DL
        59 010543   000363 755000 57                 STA     UWA+243

     1794     8289    5                   IF UWA.SC.SETORD ~= 6 THEN DO;

   8289 59 010544   000312 236000 57                 LDQ     UWA+202
        59 010545   000006 116007                    CMPQ    6,DL
        59 010546   012440 600000 59                 TZE     s:8607

     1795     8290    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4123);

   8290 59 010547   000000 235000 7                  LDA     LINE_COUNT
        59 010550   000002 135007                    SBLA    2,DL
        59 010551   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010552   000366 237000 60                 LDAQ    246
        59 010553   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010554   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 010555   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 010556   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:316  
        59 010557   000005 631400 60                 EPPR1   5
        59 010560   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010561   000000 011000                    NOP     0

     1796     8291    5                       END;

   8291 59 010562   012440 710000 59                 TRA     s:8607

     1797     8292    4               CASE(%MNOT); /* KEY IS...DUPS ARE NOT ALLOWED */

     1798     8293    4                   UWA.SM.SEQDUP = 2;

   8293 59 010563   000002 235007                    LDA     2,DL
        59 010564   000363 755000 57                 STA     UWA+243

     1799     8294    5                   IF UWA.SC.SETORD ~= 6 THEN DO;

   8294 59 010565   000312 236000 57                 LDQ     UWA+202
        59 010566   000006 116007                    CMPQ    6,DL
        59 010567   012440 600000 59                 TZE     s:8607

     1800     8295    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4123);

   8295 59 010570   000000 235000 7                  LDA     LINE_COUNT
        59 010571   000002 135007                    SBLA    2,DL
        59 010572   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010573   000366 237000 60                 LDAQ    246
        59 010574   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010575   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 010576   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 010577   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010600   000005 631400 60                 EPPR1   5
        59 010601   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010602   000000 011000                    NOP     0

     1801     8296    5                       END;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:317  
   8296 59 010603   012440 710000 59                 TRA     s:8607

     1802     8297    4               CASE(%SEL_PHR); /* SET SELECTION... */

     1803     8298    5                   IF SELECTION THEN DO;

   8298 59 010604   000041 234000 0                  SZN     SELECTION
        59 010605   010622 605000 59                 TPL     s:8301

     1804     8299    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4026);

   8299 59 010606   000000 235000 7                  LDA     LINE_COUNT
        59 010607   000002 135007                    SBLA    2,DL
        59 010610   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010611   000054 237000 60                 LDAQ    44
        59 010612   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010613   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 010614   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 010615   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010616   000005 631400 60                 EPPR1   5
        59 010617   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010620   000000 011000                    NOP     0

     1805     8300    5                       END;

   8300 59 010621   012440 710000 59                 TRA     s:8607

     1806     8301    4                   ELSE SELECTION = '1'B;

   8301 59 010622   400000 236003                    LDQ     -131072,DU
        59 010623   000041 756000 0                  STQ     SELECTION
        59 010624   012440 710000 59                 TRA     s:8607

     1807     8302        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:318  
     1808     8303        /*****************************************
     1809     8304        *  SET SELECTION clause                  *
     1810     8305        *****************************************/
     1811     8306    4               CASE(%FOR_SC_NM); /* SET SELECTION FOR setname */

     1812     8307        /* -nake sure set named is same as current set */
     1813     8308    4                   CALL GET_WORD;

   8308 59 010625   012467 701000 59                 TSX1    GET_WORD
        59 010626   000000 011000                    NOP     0

     1814     8309    5                   IF WORD1 ~= CURR_SETNAME THEN DO;

   8309 59 010627   040000 106400                    CMPC    fill='040'O
        59 010630   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 010631   000104 000036 0                  ADSC9   CURR_SETNAME             cn=0,n=30
        59 010632   012440 600000 59                 TZE     s:8607

     1815     8310    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4088);

   8310 59 010633   000000 235000 7                  LDA     LINE_COUNT
        59 010634   000002 135007                    SBLA    2,DL
        59 010635   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 010636   000370 237000 60                 LDAQ    248
        59 010637   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010640   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010641   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010642   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010643   000005 631400 60                 EPPR1   5
        59 010644   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010645   000000 011000                    NOP     0

     1816     8311        /*E* ERROR: ZIG-4088-C
     1817     8312             MESSAGE: The set named by this phrase must be the same as
     1818     8313                      that of the current set entry.
     1819     8314        */
     1820     8315    5                       END;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:319  

   8315 59 010646   012440 710000 59                 TRA     s:8607

     1821     8316    4               CASE(%SEL_SC_NM); /* SET SELECTION IS THRU setname */

     1822     8317    5                   IF ~LINKED THEN DO;

   8317 59 010647   000037 236000 0                  LDQ     LINKED
        59 010650   400000 376003                    ANQ     -131072,DU
        59 010651   400000 676003                    ERQ     -131072,DU
        59 010652   010666 600000 59                 TZE     s:8324

     1823     8318    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4055);

   8318 59 010653   000000 236000 7                  LDQ     LINE_COUNT
        59 010654   000002 136007                    SBLQ    2,DL
        59 010655   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010656   000374 237000 60                 LDAQ    252
        59 010657   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010660   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 010661   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 010662   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010663   000005 631400 60                 EPPR1   5
        59 010664   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010665   000000 011000                    NOP     0

     1824     8319        /*E* ERROR: ZIG-4055-C
     1825     8320             MESSAGE: The LINKED TO OWNER phrase is required but seems to
     1826     8321                      be missing.
     1827     8322        */
     1828     8323    5                       END;

     1829     8324    5                   IF UWA.SM.INSTYPE = 9 THEN DO;

   8324 59 010666   000360 235000 57                 LDA     UWA+240
        59 010667   000011 115007                    CMPA    9,DL
        59 010670   010704 601000 59                 TNZ     s:8331
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:320  

     1830     8325    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4142);

   8325 59 010671   000000 236000 7                  LDQ     LINE_COUNT
        59 010672   000002 136007                    SBLQ    2,DL
        59 010673   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010674   000376 237000 60                 LDAQ    254
        59 010675   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010676   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010677   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010700   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 010701   000005 631400 60                 EPPR1   5
        59 010702   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010703   000000 011000                    NOP     0

     1831     8326        /*E* ERROR: ZIG-4142-C
     1832     8327             MESSAGE: Either AUTOMATIC or MANUAL insertion must be
     1833     8328                      specified.
     1834     8329        */
     1835     8330    5                       END;

     1836     8331    5                   IF UWA.SM.RETTYPE = 9 THEN DO;

   8331 59 010704   000361 235000 57                 LDA     UWA+241
        59 010705   000011 115007                    CMPA    9,DL
        59 010706   010722 601000 59                 TNZ     s:8338

     1837     8332    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4141);

   8332 59 010707   000000 236000 7                  LDQ     LINE_COUNT
        59 010710   000002 136007                    SBLQ    2,DL
        59 010711   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010712   000402 237000 60                 LDAQ    258
        59 010713   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 010714   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010715   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010716   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:321  
        59 010717   000005 631400 60                 EPPR1   5
        59 010720   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 010721   000000 011000                    NOP     0

     1838     8333        /*E* ERROR: ZIG-4141-C
     1839     8334             MESSAGE: Either MANDATORY or OPTIONAL retention must be
     1840     8335                      specified.
     1841     8336        */
     1842     8337    5                       END;

     1843     8338    4                   CALL FINDD_6('SM      ',LAST_SM_DBK);
              8338                            /* ensure SM fields filled in */

   8338 59 010722   000320 630400 60                 EPPR0   208
        59 010723   000001 631400 60                 EPPR1   1
        59 010724   000000 701000 xent               TSX1    FINDD_6
        59 010725   000000 011000                    NOP     0

     1844     8339    4                   CALL MODIFY_6('SM      ');

   8339 59 010726   000102 630400 60                 EPPR0   66
        59 010727   000013 631400 60                 EPPR1   11
        59 010730   000000 701000 xent               TSX1    MODIFY_6
        59 010731   000000 011000                    NOP     0

     1845     8340    4                   CALL GET_WORD;

   8340 59 010732   012467 701000 59                 TSX1    GET_WORD
        59 010733   000000 011000                    NOP     0

     1846     8341    4                   CALL ADD_SN(%ZIG_RTYPE_SC,WORD1,0,LNO,FOUND,RELTYPE.SS,EXPLCT,0);

   8341 59 010734   000134 237000 60                 LDAQ    92
        59 010735   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 010736   000404 237000 60                 LDAQ    260
        59 010737   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 010740   200060 630500                    EPPR0   LNO,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:322  
        59 010741   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 010742   000024 236000 60                 LDQ     20
        59 010743   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 010744   000062 237000 60                 LDAQ    50
        59 010745   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 010746   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010747   000020 631400 60                 EPPR1   16
        59 010750   000000 701000 xent               TSX1    ADD_SN
        59 010751   000000 011000                    NOP     0

     1847     8342    4                   CALL ZIG$G_DYN_MEM_6(5,DYNMEM$);

   8342 59 010752   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 010753   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 010754   000406 236000 60                 LDQ     262
        59 010755   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 010756   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 010757   000001 631400 60                 EPPR1   1
        59 010760   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 010761   000000 011000                    NOP     0

     1848     8343    4                   DYNMEM$->WRD1 = %SET_SEL; /* beginning of set selection */

   8343 59 010762   000012 235007                    LDA     10,DL
        59 010763   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 010764   000000 755100                    STA     0,,PR0

     1849     8344    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8344 59 010765   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 010766   000001 036003                    ADLQ    1,DU
        59 010767   200056 756100                    STQ     DYNMEM$,,AUTO

     1850     8345    4                   DYNMEM$->WRD1 = LAST_SC_DBK;

   8345 59 010770   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 010771   000072 235000 0                  LDA     LAST_SC_DBK
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:323  
        59 010772   000000 755100                    STA     0,,PR0

     1851     8346    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8346 59 010773   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 010774   000001 036003                    ADLQ    1,DU
        59 010775   200056 756100                    STQ     DYNMEM$,,AUTO

     1852     8347    4                   DYNMEM$->WRD1 = LAST_SM_DBK;

   8347 59 010776   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 010777   000102 235000 0                  LDA     LAST_SM_DBK
        59 011000   000000 755100                    STA     0,,PR0

     1853     8348    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8348 59 011001   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011002   000001 036003                    ADLQ    1,DU
        59 011003   200056 756100                    STQ     DYNMEM$,,AUTO

     1854     8349    4                   DYNMEM$->WRD1 = UWA.DIRECT_REF; /* THRU setname SN */

   8349 59 011004   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011005   000036 235000 57                 LDA     UWA+30
        59 011006   000000 755100                    STA     0,,PR0

     1855     8350    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8350 59 011007   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011010   000001 036003                    ADLQ    1,DU
        59 011011   200056 756100                    STQ     DYNMEM$,,AUTO

     1856     8351    4                   DYNMEM$->WRD1 = LNO;

   8351 59 011012   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011013   200060 235100                    LDA     LNO,,AUTO
        59 011014   000000 755100                    STA     0,,PR0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:324  
        59 011015   012440 710000 59                 TRA     s:8607

     1857     8352    4               CASE(%OWN_ID_PHR);

     1858     8353    4               CASE(%APPLICATION); /* OWNER IDENTIFIED BY APPLICATION */

     1859     8354    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM$);

   8354 59 011016   200056 631500                    EPPR1   DYNMEM$,,AUTO
        59 011017   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 011020   000003 236000 60                 LDQ     3
        59 011021   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011022   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011023   000001 631400 60                 EPPR1   1
        59 011024   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011025   000000 011000                    NOP     0

     1860     8355    4                   DYNMEM$->WRD1 = %APPLIC;

   8355 59 011026   000001 235007                    LDA     1,DL
        59 011027   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011030   000000 755100                    STA     0,,PR0
        59 011031   012440 710000 59                 TRA     s:8607

     1861     8356    4               CASE(%DEQ_QFR); /* OWNER IDENTIFIED BY DBKEY EQUAL TO dbid/dbparam */

     1862     8357    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN

   8357 59 011032   000360 235000 57                 LDA     UWA+240
        59 011033   000001 115007                    CMPA    1,DL
        59 011034   011040 600000 59                 TZE     s:8359
        59 011035   000361 235000 57                 LDA     UWA+241
        59 011036   000001 115007                    CMPA    1,DL
        59 011037   011053 601000 59                 TNZ     s:8365

     1863     8358    5                   DO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:325  
     1864     8359    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);

   8359 59 011040   000000 235000 7                  LDA     LINE_COUNT
        59 011041   000002 135007                    SBLA    2,DL
        59 011042   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 011043   000410 237000 60                 LDAQ    264
        59 011044   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011045   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 011046   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 011047   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011050   000005 631400 60                 EPPR1   5
        59 011051   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011052   000000 011000                    NOP     0

     1865     8360        /*E* ERROR: ZIG-4828-C
     1866     8361             MESSAGE: Set selection must be BY APPLICATION for MANUAL
     1867     8362                      insertion and/or OPTIONAL retention.
     1868     8363        */
     1869     8364    5                       END;

     1870     8365    4                   CALL GET_WORD;

   8365 59 011053   012467 701000 59                 TSX1    GET_WORD
        59 011054   000000 011000                    NOP     0

     1871     8366    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   8366 59 011055   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011056   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011057   000037 236000 60                 LDQ     31
        59 011060   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011061   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011062   000001 631400 60                 EPPR1   1
        59 011063   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011064   000000 011000                    NOP     0

     1872     8367    4                   DYNMEM$->WRD1 = %DBK_EQ;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:326  

   8367 59 011065   000004 235007                    LDA     4,DL
        59 011066   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011067   000000 755100                    STA     0,,PR0

     1873     8368    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8368 59 011070   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011071   000001 036003                    ADLQ    1,DU
        59 011072   200056 756100                    STQ     DYNMEM$,,AUTO

     1874     8369    4                   DYNMEM$->WRD1 = LNO;

   8369 59 011073   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011074   200060 235100                    LDA     LNO,,AUTO
        59 011075   000000 755100                    STA     0,,PR0

     1875     8370    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8370 59 011076   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011077   000001 036003                    ADLQ    1,DU
        59 011100   200056 756100                    STQ     DYNMEM$,,AUTO

     1876     8371    4                   DYNMEM$->CHAR30 = WORD1;

   8371 59 011101   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011102   040100 100400                    MLR     fill='040'O
        59 011103   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011104   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011105   012440 710000 59                 TRA     s:8607

     1877     8372    4               CASE(%DEQ_QRC);

     1878     8373    4                   CALL GET_WORD;

   8373 59 011106   012467 701000 59                 TSX1    GET_WORD
        59 011107   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:327  

     1879     8374    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);

   8374 59 011110   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011111   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011112   000056 236000 60                 LDQ     46
        59 011113   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011114   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011115   000001 631400 60                 EPPR1   1
        59 011116   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011117   000000 011000                    NOP     0

     1880     8375    4                   DYNMEM$->WRD1 = %QUAL;

   8375 59 011120   000113 235007                    LDA     75,DL
        59 011121   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011122   000000 755100                    STA     0,,PR0

     1881     8376    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8376 59 011123   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011124   000001 036003                    ADLQ    1,DU
        59 011125   200056 756100                    STQ     DYNMEM$,,AUTO

     1882     8377    4                   DYNMEM$->CHAR30 = WORD1;

   8377 59 011126   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011127   040100 100400                    MLR     fill='040'O
        59 011130   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011131   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011132   012440 710000 59                 TRA     s:8607

     1883     8378    4               CASE(%DEQ_FR);

     1884     8379    4               CASE(%DBK_ONLY); /* OWNER IDENTIFIED BY DBKEY. */

     1885     8380    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:328  

   8380 59 011133   000360 235000 57                 LDA     UWA+240
        59 011134   000001 115007                    CMPA    1,DL
        59 011135   011141 600000 59                 TZE     s:8382
        59 011136   000361 235000 57                 LDA     UWA+241
        59 011137   000001 115007                    CMPA    1,DL
        59 011140   011154 601000 59                 TNZ     s:8384

     1886     8381    5                   DO;

     1887     8382    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);

   8382 59 011141   000000 235000 7                  LDA     LINE_COUNT
        59 011142   000002 135007                    SBLA    2,DL
        59 011143   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 011144   000410 237000 60                 LDAQ    264
        59 011145   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011146   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 011147   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 011150   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011151   000005 631400 60                 EPPR1   5
        59 011152   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011153   000000 011000                    NOP     0

     1888     8383    5                       END;

     1889     8384    4                   CALL ZIG$G_DYN_MEM_6(2,DYNMEM$);

   8384 59 011154   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011155   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011156   000010 236000 60                 LDQ     8
        59 011157   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011160   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011161   000001 631400 60                 EPPR1   1
        59 011162   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011163   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:329  
     1890     8385    4                   DYNMEM$->WRD1 = %DBK_ONL;

   8385 59 011164   000005 235007                    LDA     5,DL
        59 011165   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011166   000000 755100                    STA     0,,PR0

     1891     8386    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8386 59 011167   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011170   000001 036003                    ADLQ    1,DU
        59 011171   200056 756100                    STQ     DYNMEM$,,AUTO

     1892     8387    4                   DYNMEM$->WRD1 = LNO;

   8387 59 011172   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011173   200060 235100                    LDA     LNO,,AUTO
        59 011174   000000 755100                    STA     0,,PR0
        59 011175   012440 710000 59                 TRA     s:8607

     1893     8388    4               CASE(%CEQ_QFR); /* OWNER IDENTIFIED BY CALCKEY EQUAL TO dbid/dbparam */

     1894     8389    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN

   8389 59 011176   000360 235000 57                 LDA     UWA+240
        59 011177   000001 115007                    CMPA    1,DL
        59 011200   011204 600000 59                 TZE     s:8391
        59 011201   000361 235000 57                 LDA     UWA+241
        59 011202   000001 115007                    CMPA    1,DL
        59 011203   011217 601000 59                 TNZ     s:8393

     1895     8390    5                   DO;

     1896     8391    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);

   8391 59 011204   000000 235000 7                  LDA     LINE_COUNT
        59 011205   000002 135007                    SBLA    2,DL
        59 011206   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:330  
        59 011207   000410 237000 60                 LDAQ    264
        59 011210   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011211   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 011212   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 011213   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011214   000005 631400 60                 EPPR1   5
        59 011215   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011216   000000 011000                    NOP     0

     1897     8392    5                       END;

     1898     8393    4                   CALL GET_WORD;

   8393 59 011217   012467 701000 59                 TSX1    GET_WORD
        59 011220   000000 011000                    NOP     0

     1899     8394    4                   IF WORD1 = 'THEN' OR WORD1 = 'THRU' THEN

   8394 59 011221   040000 106400                    CMPC    fill='040'O
        59 011222   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011223   000122 000004 58                 ADSC9   82                       cn=0,n=4
        59 011224   011231 600000 59                 TZE     s:8396
        59 011225   040000 106400                    CMPC    fill='040'O
        59 011226   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011227   000123 000004 58                 ADSC9   83                       cn=0,n=4
        59 011230   011235 601000 59                 TNZ     s:8399

     1900     8395    5                   DO;

     1901     8396    5                       PARAN.REJECT = '1'B;

   8396 59 011231   200003 470500                    LDP0    @PARAN,,AUTO
        59 011232   000200 236003                    LDQ     128,DU
        59 011233   000000 256100                    ORSQ    0,,PR0

     1902     8397    5                       RETURN;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:331  
   8397 59 011234   000000 702200 xent               TSX2  ! X66_ARET

     1903     8398    5                       END;
     1904     8399    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   8399 59 011235   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011236   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011237   000037 236000 60                 LDQ     31
        59 011240   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011241   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011242   000001 631400 60                 EPPR1   1
        59 011243   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011244   000000 011000                    NOP     0

     1905     8400    4                   DYNMEM$->WRD1 = %CALC_EQ;

   8400 59 011245   000002 235007                    LDA     2,DL
        59 011246   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011247   000000 755100                    STA     0,,PR0

     1906     8401    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8401 59 011250   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011251   000001 036003                    ADLQ    1,DU
        59 011252   200056 756100                    STQ     DYNMEM$,,AUTO

     1907     8402    4                   DYNMEM$->WRD1 = LNO;

   8402 59 011253   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011254   200060 235100                    LDA     LNO,,AUTO
        59 011255   000000 755100                    STA     0,,PR0

     1908     8403    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8403 59 011256   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011257   000001 036003                    ADLQ    1,DU
        59 011260   200056 756100                    STQ     DYNMEM$,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:332  

     1909     8404    4                   DYNMEM$->CHAR30 = WORD1;

   8404 59 011261   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011262   040100 100400                    MLR     fill='040'O
        59 011263   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011264   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011265   012440 710000 59                 TRA     s:8607

     1910     8405    4               CASE(%CEQ_QRC);

     1911     8406    4                   CALL GET_WORD;

   8406 59 011266   012467 701000 59                 TSX1    GET_WORD
        59 011267   000000 011000                    NOP     0

     1912     8407    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);

   8407 59 011270   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011271   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011272   000056 236000 60                 LDQ     46
        59 011273   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011274   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011275   000001 631400 60                 EPPR1   1
        59 011276   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011277   000000 011000                    NOP     0

     1913     8408    4                   DYNMEM$->WRD1 = %QUAL;

   8408 59 011300   000113 235007                    LDA     75,DL
        59 011301   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011302   000000 755100                    STA     0,,PR0

     1914     8409    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8409 59 011303   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011304   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:333  
        59 011305   200056 756100                    STQ     DYNMEM$,,AUTO

     1915     8410    4                   DYNMEM$->CHAR30 = WORD1;

   8410 59 011306   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011307   040100 100400                    MLR     fill='040'O
        59 011310   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011311   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011312   012440 710000 59                 TRA     s:8607

     1916     8411    4               CASE(%CEQ_FR);

     1917     8412    4                   CALL GET_WORD;

   8412 59 011313   012467 701000 59                 TSX1    GET_WORD
        59 011314   000000 011000                    NOP     0

     1918     8413    4                   IF WORD1 = 'THEN' OR WORD1 = 'THRU'

   8413 59 011315   040000 106400                    CMPC    fill='040'O
        59 011316   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011317   000122 000004 58                 ADSC9   82                       cn=0,n=4
        59 011320   011325 600000 59                 TZE     s:8415
        59 011321   040000 106400                    CMPC    fill='040'O
        59 011322   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011323   000123 000004 58                 ADSC9   83                       cn=0,n=4
        59 011324   012440 601000 59                 TNZ     s:8607

     1919     8414    5                   THEN DO;

     1920     8415    5                       PARAN.REJECT = '1'B;

   8415 59 011325   200003 470500                    LDP0    @PARAN,,AUTO
        59 011326   000200 236003                    LDQ     128,DU
        59 011327   000000 256100                    ORSQ    0,,PR0

     1921     8416    5                       RETURN;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:334  

   8416 59 011330   000000 702200 xent               TSX2  ! X66_ARET

     1922     8417    5                       END;
     1923     8418    4               CASE(%CALC_ONLY); /* OWNER IDENTIFIED BY CALCKEY. */

     1924     8419    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN

   8419 59 011331   000360 235000 57                 LDA     UWA+240
        59 011332   000001 115007                    CMPA    1,DL
        59 011333   011337 600000 59                 TZE     s:8421
        59 011334   000361 235000 57                 LDA     UWA+241
        59 011335   000001 115007                    CMPA    1,DL
        59 011336   011352 601000 59                 TNZ     s:8423

     1925     8420    5                   DO;

     1926     8421    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);

   8421 59 011337   000000 235000 7                  LDA     LINE_COUNT
        59 011340   000002 135007                    SBLA    2,DL
        59 011341   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 011342   000410 237000 60                 LDAQ    264
        59 011343   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011344   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 011345   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 011346   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011347   000005 631400 60                 EPPR1   5
        59 011350   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011351   000000 011000                    NOP     0

     1927     8422    5                       END;

     1928     8423    4                   CALL ZIG$G_DYN_MEM_6(2,DYNMEM$);

   8423 59 011352   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011353   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:335  
        59 011354   000010 236000 60                 LDQ     8
        59 011355   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011356   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011357   000001 631400 60                 EPPR1   1
        59 011360   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011361   000000 011000                    NOP     0

     1929     8424    4                   DYNMEM$->WRD1 = %CALC_ONL;

   8424 59 011362   000003 235007                    LDA     3,DL
        59 011363   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011364   000000 755100                    STA     0,,PR0

     1930     8425    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8425 59 011365   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011366   000001 036003                    ADLQ    1,DU
        59 011367   200056 756100                    STQ     DYNMEM$,,AUTO

     1931     8426    4                   DYNMEM$->WRD1 = LNO;

   8426 59 011370   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011371   200060 235100                    LDA     LNO,,AUTO
        59 011372   000000 755100                    STA     0,,PR0
        59 011373   012440 710000 59                 TRA     s:8607

     1932     8427    4               CASE(%MEM_SEL_REC_NM);
              8427                        /* OWNER IDENTIFIED BY MEMBER recname SELECTION */

     1933     8428    4                   IF UWA.SM.INSTYPE = 1 OR UWA.SM.RETTYPE = 1 THEN

   8428 59 011374   000360 235000 57                 LDA     UWA+240
        59 011375   000001 115007                    CMPA    1,DL
        59 011376   011402 600000 59                 TZE     s:8430
        59 011377   000361 235000 57                 LDA     UWA+241
        59 011400   000001 115007                    CMPA    1,DL
        59 011401   011415 601000 59                 TNZ     s:8432
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:336  

     1934     8429    5                   DO;

     1935     8430    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4828);

   8430 59 011402   000000 235000 7                  LDA     LINE_COUNT
        59 011403   000002 135007                    SBLA    2,DL
        59 011404   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 011405   000410 237000 60                 LDAQ    264
        59 011406   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011407   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 011410   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 011411   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011412   000005 631400 60                 EPPR1   5
        59 011413   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011414   000000 011000                    NOP     0

     1936     8431    5                       END;

     1937     8432    4                   CALL GET_WORD;

   8432 59 011415   012467 701000 59                 TSX1    GET_WORD
        59 011416   000000 011000                    NOP     0

     1938     8433    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   8433 59 011417   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011420   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011421   000037 236000 60                 LDQ     31
        59 011422   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011423   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011424   000001 631400 60                 EPPR1   1
        59 011425   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011426   000000 011000                    NOP     0

     1939     8434    4                   DYNMEM$->WRD1 = %MEMB;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:337  
   8434 59 011427   000006 235007                    LDA     6,DL
        59 011430   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011431   000000 755100                    STA     0,,PR0

     1940     8435    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8435 59 011432   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011433   000001 036003                    ADLQ    1,DU
        59 011434   200056 756100                    STQ     DYNMEM$,,AUTO

     1941     8436    4                   DYNMEM$->WRD1 = LNO;

   8436 59 011435   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011436   200060 235100                    LDA     LNO,,AUTO
        59 011437   000000 755100                    STA     0,,PR0

     1942     8437    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8437 59 011440   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011441   000001 036003                    ADLQ    1,DU
        59 011442   200056 756100                    STQ     DYNMEM$,,AUTO

     1943     8438    4                   DYNMEM$->CHAR30 = WORD1;

   8438 59 011443   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011444   040100 100400                    MLR     fill='040'O
        59 011445   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011446   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011447   012440 710000 59                 TRA     s:8607

     1944     8439    4               CASE(%SELEC_SC_NM); /* THEN THRU setname */

     1945     8440    4                   CALL FCURR_R_6('NR      ');

   8440 59 011450   000412 630400 60                 EPPR0   266
        59 011451   000013 631400 60                 EPPR1   11
        59 011452   000000 701000 xent               TSX1    FCURR_R_6
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:338  
        59 011453   000000 011000                    NOP     0

     1946     8441    4                   UWA.NR.LNO = UWA.NR.LNO + 1;

   8441 59 011454   000471 054000 57                 AOS     UWA+313

     1947     8442    4                   CALL MODIFY_6('NR      ');

   8442 59 011455   000412 630400 60                 EPPR0   266
        59 011456   000013 631400 60                 EPPR1   11
        59 011457   000000 701000 xent               TSX1    MODIFY_6
        59 011460   000000 011000                    NOP     0

     1948     8443    4                   CALL GET_WORD;

   8443 59 011461   012467 701000 59                 TSX1    GET_WORD
        59 011462   000000 011000                    NOP     0

     1949     8444    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   8444 59 011463   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011464   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011465   000037 236000 60                 LDQ     31
        59 011466   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011467   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011470   000001 631400 60                 EPPR1   1
        59 011471   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011472   000000 011000                    NOP     0

     1950     8445    4                   DYNMEM$->WRD1 = %THEN_THRU;

   8445 59 011473   000024 235007                    LDA     20,DL
        59 011474   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011475   000000 755100                    STA     0,,PR0

     1951     8446    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:339  
   8446 59 011476   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011477   000001 036003                    ADLQ    1,DU
        59 011500   200056 756100                    STQ     DYNMEM$,,AUTO

     1952     8447    4                   DYNMEM$->WRD1 = LNO;

   8447 59 011501   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011502   200060 235100                    LDA     LNO,,AUTO
        59 011503   000000 755100                    STA     0,,PR0

     1953     8448    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8448 59 011504   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011505   000001 036003                    ADLQ    1,DU
        59 011506   200056 756100                    STQ     DYNMEM$,,AUTO

     1954     8449    4                   DYNMEM$->CHAR30 = WORD1;

   8449 59 011507   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011510   040100 100400                    MLR     fill='040'O
        59 011511   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011512   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011513   012440 710000 59                 TRA     s:8607

     1955     8450    4               CASE(%WHR_QFR); /* WHERE OWNER IDENTIFIED BY dbid */

     1956     8451    4                   CALL GET_WORD;

   8451 59 011514   012467 701000 59                 TSX1    GET_WORD
        59 011515   000000 011000                    NOP     0

     1957     8452    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   8452 59 011516   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011517   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011520   000037 236000 60                 LDQ     31
        59 011521   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:340  
        59 011522   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011523   000001 631400 60                 EPPR1   1
        59 011524   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011525   000000 011000                    NOP     0

     1958     8453    4                   DYNMEM$->WRD1 = %THEN_OWNER;

   8453 59 011526   000036 235007                    LDA     30,DL
        59 011527   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011530   000000 755100                    STA     0,,PR0

     1959     8454    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8454 59 011531   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011532   000001 036003                    ADLQ    1,DU
        59 011533   200056 756100                    STQ     DYNMEM$,,AUTO

     1960     8455    4                   DYNMEM$->WRD1 = LNO;

   8455 59 011534   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011535   200060 235100                    LDA     LNO,,AUTO
        59 011536   000000 755100                    STA     0,,PR0

     1961     8456    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8456 59 011537   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011540   000001 036003                    ADLQ    1,DU
        59 011541   200056 756100                    STQ     DYNMEM$,,AUTO

     1962     8457    4                   DYNMEM$->CHAR30 = WORD1;

   8457 59 011542   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011543   040100 100400                    MLR     fill='040'O
        59 011544   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011545   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011546   012440 710000 59                 TRA     s:8607

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:341  
     1963     8458    4               CASE(%WHR_QRC);

     1964     8459    4                   CALL GET_WORD;

   8459 59 011547   012467 701000 59                 TSX1    GET_WORD
        59 011550   000000 011000                    NOP     0

     1965     8460    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);

   8460 59 011551   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011552   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011553   000056 236000 60                 LDQ     46
        59 011554   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011555   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011556   000001 631400 60                 EPPR1   1
        59 011557   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011560   000000 011000                    NOP     0

     1966     8461    4                   DYNMEM$->WRD1 = %QUAL;

   8461 59 011561   000113 235007                    LDA     75,DL
        59 011562   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011563   000000 755100                    STA     0,,PR0

     1967     8462    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8462 59 011564   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011565   000001 036003                    ADLQ    1,DU
        59 011566   200056 756100                    STQ     DYNMEM$,,AUTO

     1968     8463    4                   DYNMEM$->CHAR30 = WORD1;

   8463 59 011567   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011570   040100 100400                    MLR     fill='040'O
        59 011571   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011572   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011573   012440 710000 59                 TRA     s:8607
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:342  

     1969     8464    4               CASE(%WHR_FR);

     1970     8465    4               CASE(%WEQ_QFR); /* WHERE... EQUAL TO dbid/dbparam */

     1971     8466    4                   CALL GET_WORD;

   8466 59 011574   012467 701000 59                 TSX1    GET_WORD
        59 011575   000000 011000                    NOP     0

     1972     8467    4                   CALL ZIG$G_DYN_MEM_6(10,DYNMEM$);

   8467 59 011576   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011577   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011600   000037 236000 60                 LDQ     31
        59 011601   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011602   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011603   000001 631400 60                 EPPR1   1
        59 011604   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011605   000000 011000                    NOP     0

     1973     8468    4                   DYNMEM$->WRD1 = %EQUAL_TO;

   8468 59 011606   000050 235007                    LDA     40,DL
        59 011607   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011610   000000 755100                    STA     0,,PR0

     1974     8469    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8469 59 011611   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011612   000001 036003                    ADLQ    1,DU
        59 011613   200056 756100                    STQ     DYNMEM$,,AUTO

     1975     8470    4                   DYNMEM$->WRD1 = LNO;

   8470 59 011614   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011615   200060 235100                    LDA     LNO,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:343  
        59 011616   000000 755100                    STA     0,,PR0

     1976     8471    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8471 59 011617   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011620   000001 036003                    ADLQ    1,DU
        59 011621   200056 756100                    STQ     DYNMEM$,,AUTO

     1977     8472    4                   DYNMEM$->CHAR30 = WORD1;

   8472 59 011622   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011623   040100 100400                    MLR     fill='040'O
        59 011624   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011625   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011626   012440 710000 59                 TRA     s:8607

     1978     8473    4               CASE(%WEQ_QRC);

     1979     8474    4                   CALL GET_WORD;

   8474 59 011627   012467 701000 59                 TSX1    GET_WORD
        59 011630   000000 011000                    NOP     0

     1980     8475    4                   CALL ZIG$G_DYN_MEM_6(9,DYNMEM$);

   8475 59 011631   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011632   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011633   000056 236000 60                 LDQ     46
        59 011634   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011635   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011636   000001 631400 60                 EPPR1   1
        59 011637   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011640   000000 011000                    NOP     0

     1981     8476    4                   DYNMEM$->WRD1 = %QUAL;

   8476 59 011641   000113 235007                    LDA     75,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:344  
        59 011642   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011643   000000 755100                    STA     0,,PR0

     1982     8477    4                   DYNMEM$ = PINCRW(DYNMEM$,1);

   8477 59 011644   200056 236100                    LDQ     DYNMEM$,,AUTO
        59 011645   000001 036003                    ADLQ    1,DU
        59 011646   200056 756100                    STQ     DYNMEM$,,AUTO

     1983     8478    4                   DYNMEM$->CHAR30 = WORD1;

   8478 59 011647   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011650   040100 100400                    MLR     fill='040'O
        59 011651   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 011652   000000 000036                    ADSC9   0,,PR0                   cn=0,n=30
        59 011653   012440 710000 59                 TRA     s:8607

     1984     8479    4               CASE(%WEQ_FR);

     1985     8480        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:345  
     1986     8481        /********************************************************************
     1987     8482                 ends of entries
     1988     8483         *******************************************************************/
     1989     8484    4               CASE(%END_SCH);

     1990     8485    4                   IF REC_ENTRY_DONE THEN

   8485 59 011654   000100 234000 0                  SZN     REC_ENTRY_DONE
        59 011655   011660 605000 59                 TPL     s:8487

     1991     8486    4                       CALL CLEAN_UP_REC;

   8486 59 011656   012607 701000 59                 TSX1    CLEAN_UP_REC
        59 011657   000000 011000                    NOP     0

     1992     8487    4                   IF UWA.OA.NUMB_AC = 0 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
              8487                            4402);

   8487 59 011660   000214 235000 57                 LDA     UWA+140
        59 011661   011675 601000 59                 TNZ     s:8491

   8487 59 011662   000000 236000 7                  LDQ     LINE_COUNT
        59 011663   000002 136007                    SBLQ    2,DL
        59 011664   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011665   000414 237000 60                 LDAQ    268
        59 011666   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011667   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011670   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011671   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011672   000005 631400 60                 EPPR1   5
        59 011673   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011674   000000 011000                    NOP     0

     1993     8488        /*   ERROR: ZIG-4402-C
     1994     8489             MESSAGE: The schema must contain at least one AREA subentry.
     1995     8490         */
     1996     8491    4                   IF UWA.OA.NUMB_RC = 0 THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:346  
              8491                            4403);

   8491 59 011675   000215 235000 57                 LDA     UWA+141
        59 011676   011712 601000 59                 TNZ     s:8495

   8491 59 011677   000000 236000 7                  LDQ     LINE_COUNT
        59 011700   000002 136007                    SBLQ    2,DL
        59 011701   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011702   000420 237000 60                 LDAQ    272
        59 011703   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 011704   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011705   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011706   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 011707   000005 631400 60                 EPPR1   5
        59 011710   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 011711   000000 011000                    NOP     0

     1997     8492        /*   ERROR: ZIG-4403-C
     1998     8493             MESSAGE: The schema must contain at least one RECORD subentry.
     1999     8494         */
     2000     8495    4                   END_DDL = '1'B;

   8495 59 011712   400000 236003                    LDQ     -131072,DU
        59 011713   000000 756000 10                 STQ     END_DDL

     2001     8496    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM$);

   8496 59 011714   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 011715   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 011716   000003 236000 60                 LDQ     3
        59 011717   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 011720   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 011721   000001 631400 60                 EPPR1   1
        59 011722   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 011723   000000 011000                    NOP     0

     2002     8497    4                  DYNMEM$->WRD1 = %ALL_DONE; /* signal end of set selection dyn mem */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:347  

   8497 59 011724   000144 235007                    LDA     100,DL
        59 011725   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 011726   000000 755100                    STA     0,,PR0

     2003     8498    4                   CALL FCURR_R_6('SF  ');

   8498 59 011727   000417 630400 60                 EPPR0   271
        59 011730   000013 631400 60                 EPPR1   11
        59 011731   000000 701000 xent               TSX1    FCURR_R_6
        59 011732   000000 011000                    NOP     0

     2004     8499    4                   CALL MODIFY_6('SF      ');

   8499 59 011733   000422 630400 60                 EPPR0   274
        59 011734   000013 631400 60                 EPPR1   11
        59 011735   000000 701000 xent               TSX1    MODIFY_6
        59 011736   000000 011000                    NOP     0

     2005     8500         /* if no sets or no keys defined, fill in SN of schemaname
     2006     8501            in DA record */
     2007     8502    5                   IF UWA.DA.FRST_SC = 0 OR UWA.DA.FRST_KC = 0 OR UWA.DA.FRST_FR = 0
              8502                            THEN DO;

   8502 59 011737   000417 235000 57                 LDA     UWA+271
        59 011740   011745 600000 59                 TZE     s:8503
        59 011741   000420 236000 57                 LDQ     UWA+272
        59 011742   011745 600000 59                 TZE     s:8503
        59 011743   000421 235000 57                 LDA     UWA+273
        59 011744   011771 601000 59                 TNZ     s:8509

     2008     8503    5                       CALL FCURR_R_6('OA      ');

   8503 59 011745   000017 630400 60                 EPPR0   15
        59 011746   000013 631400 60                 EPPR1   11
        59 011747   000000 701000 xent               TSX1    FCURR_R_6
        59 011750   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:348  

     2009     8504    5                       CALL FINDOS_6('SN-SE   '); /* SN of schemaname */

   8504 59 011751   000107 630400 60                 EPPR0   71
        59 011752   000013 631400 60                 EPPR1   11
        59 011753   000000 701000 xent               TSX1    FINDOS_6
        59 011754   000000 011000                    NOP     0

     2010     8505    5                       IF UWA.DA.FRST_SC = 0 THEN UWA.DA.FRST_SC = UWA.DIRECT_REF;

   8505 59 011755   000417 235000 57                 LDA     UWA+271
        59 011756   011761 601000 59                 TNZ     s:8506

   8505 59 011757   000036 236000 57                 LDQ     UWA+30
        59 011760   000417 756000 57                 STQ     UWA+271

     2011     8506    5                       IF UWA.DA.FRST_KC = 0 THEN UWA.DA.FRST_KC = UWA.DIRECT_REF;

   8506 59 011761   000420 235000 57                 LDA     UWA+272
        59 011762   011765 601000 59                 TNZ     s:8507

   8506 59 011763   000036 236000 57                 LDQ     UWA+30
        59 011764   000420 756000 57                 STQ     UWA+272

     2012     8507    5                       IF UWA.DA.FRST_FR = 0 THEN UWA.DA.FRST_FR = UWA.DIRECT_REF;

   8507 59 011765   000421 235000 57                 LDA     UWA+273
        59 011766   011771 601000 59                 TNZ     s:8509

   8507 59 011767   000036 236000 57                 LDQ     UWA+30
        59 011770   000421 756000 57                 STQ     UWA+273

     2013     8508    5                       END;

     2014     8509    4                   CALL FCURR_R_6('DA  ');

   8509 59 011771   000423 630400 60                 EPPR0   275
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:349  
        59 011772   000013 631400 60                 EPPR1   11
        59 011773   000000 701000 xent               TSX1    FCURR_R_6
        59 011774   000000 011000                    NOP     0

     2015     8510    4                   CALL MODIFY_6('DA      ');

   8510 59 011775   000424 630400 60                 EPPR0   276
        59 011776   000013 631400 60                 EPPR1   11
        59 011777   000000 701000 xent               TSX1    MODIFY_6
        59 012000   000000 011000                    NOP     0

     2016     8511    4                   CALL FCURR_R_6('OA  ');

   8511 59 012001   000017 630400 60                 EPPR0   15
        59 012002   000013 631400 60                 EPPR1   11
        59 012003   000000 701000 xent               TSX1    FCURR_R_6
        59 012004   000000 011000                    NOP     0

     2017     8512    4                   CALL MODIFY_6('OA      ');

   8512 59 012005   000017 630400 60                 EPPR0   15
        59 012006   000013 631400 60                 EPPR1   11
        59 012007   000000 701000 xent               TSX1    MODIFY_6
        59 012010   000000 011000                    NOP     0

     2018     8513    4                   CALL FCURR_R_6('SA  ');

   8513 59 012011   000425 630400 60                 EPPR0   277
        59 012012   000013 631400 60                 EPPR1   11
        59 012013   000000 701000 xent               TSX1    FCURR_R_6
        59 012014   000000 011000                    NOP     0

     2019     8514    4                   CALL MODIFY_6('SA      ');

   8514 59 012015   000426 630400 60                 EPPR0   278
        59 012016   000013 631400 60                 EPPR1   11
        59 012017   000000 701000 xent               TSX1    MODIFY_6
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:350  
        59 012020   000000 011000                    NOP     0
        59 012021   012440 710000 59                 TRA     s:8607

     2020     8515    4               CASE(%SCH_PERIOD);

     2021     8516    4               CASE(%AC_PERIOD);

     2022     8517    4                   CALL STRE_6('AC      ');

   8517 59 012022   000144 630400 60                 EPPR0   100
        59 012023   000013 631400 60                 EPPR1   11
        59 012024   000000 701000 xent               TSX1    STRE_6
        59 012025   000000 011000                    NOP     0

     2023     8518    4                   CALL CONNECT_6('OA-AC   ');

   8518 59 012026   000145 630400 60                 EPPR0   101
        59 012027   000013 631400 60                 EPPR1   11
        59 012030   000000 701000 xent               TSX1    CONNECT_6
        59 012031   000000 011000                    NOP     0

     2024     8519    4                   UWA.OA.NUMB_AC = UWA.OA.NUMB_AC + 1;

   8519 59 012032   000214 054000 57                 AOS     UWA+140
        59 012033   012440 710000 59                 TRA     s:8607

     2025     8520    4               CASE(%RC_PERIOD);

     2026     8521    4                   IF INDX_KEY_NM ~= ' '

   8521 59 012034   040000 106400                    CMPC    fill='040'O
        59 012035   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 012036   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 012037   012077 600000 59                 TZE     s:8539

     2027     8522    5                   THEN DO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:351  
     2028     8523    6                       IF INDX_KEY_NM = 'FOUND' THEN DO; /* DUP NOT not specified */

   8523 59 012040   040000 106400                    CMPC    fill='040'O
        59 012041   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 012042   000073 000005 58                 ADSC9   59                       cn=0,n=5
        59 012043   012060 601000 59                 TNZ     s:8530

     2029     8524    6                           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4152);

   8524 59 012044   000000 235000 7                  LDA     LINE_COUNT
        59 012045   000002 135007                    SBLA    2,DL
        59 012046   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012047   000430 237000 60                 LDAQ    280
        59 012050   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012051   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 012052   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 012053   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012054   000005 631400 60                 EPPR1   5
        59 012055   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012056   000000 011000                    NOP     0

     2030     8525        /*E* ERROR: ZIG-4152-C
     2031     8526             MESSAGE: The primary key "%U1" must have DUPLICATES NOT
     2032     8527                      ALLOWED specified.
     2033     8528        */
     2034     8529    6                           END;

   8529 59 012057   012077 710000 59                 TRA     s:8539

     2035     8530    5                       ELSE IF INDX_KEY_NM ~= 'NOT'

   8530 59 012060   040000 106400                    CMPC    fill='040'O
        59 012061   000115 000036 0                  ADSC9   INDX_KEY_NM              cn=0,n=30
        59 012062   000100 000003 58                 ADSC9   64                       cn=0,n=3
        59 012063   012077 600000 59                 TZE     s:8539

     2036     8531    6                           THEN DO;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:352  

     2037     8532    6                               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4151);

   8532 59 012064   000000 235000 7                  LDA     LINE_COUNT
        59 012065   000002 135007                    SBLA    2,DL
        59 012066   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012067   000434 237000 60                 LDAQ    284
        59 012070   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012071   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 012072   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 012073   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012074   000005 631400 60                 EPPR1   5
        59 012075   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012076   000000 011000                    NOP     0

     2038     8533        /*E* ERROR: ZIG-4151-C
     2039     8534             MESSAGE: The primary key has not been defined in a KEY
     2040     8535                      clause in this record.
     2041     8536        */
     2042     8537    6                               END;

     2043     8538    5                       END;

     2044     8539    5                   IF ~LOCATION THEN DO;

   8539 59 012077   000030 236000 0                  LDQ     LOCATION
        59 012100   400000 376003                    ANQ     -131072,DU
        59 012101   400000 676003                    ERQ     -131072,DU
        59 012102   012121 600000 59                 TZE     s:8546

     2045     8540    5                       CLAUSE_TYPE = 'LOCATION';

   8540 59 012103   040100 100400                    MLR     fill='040'O
        59 012104   000056 000010 58                 ADSC9   46                       cn=0,n=8
        59 012105   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12

     2046     8541    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:353  

   8541 59 012106   000000 235000 7                  LDA     LINE_COUNT
        59 012107   000002 135007                    SBLA    2,DL
        59 012110   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012111   000436 237000 60                 LDAQ    286
        59 012112   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012113   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012114   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012115   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012116   000005 631400 60                 EPPR1   5
        59 012117   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012120   000000 011000                    NOP     0

     2047     8542        /*E* ERROR: ZIG-4006-C
     2048     8543             MESSAGE: A required clause is missing from this subentry.
     2049     8544        */
     2050     8545    5                       END;

     2051     8546    5                   IF ~WITHIN THEN DO;

   8546 59 012121   000031 236000 0                  LDQ     WITHIN
        59 012122   400000 376003                    ANQ     -131072,DU
        59 012123   400000 676003                    ERQ     -131072,DU
        59 012124   012143 600000 59                 TZE     s:8550

     2052     8547    5                       CLAUSE_TYPE = 'WITHIN';

   8547 59 012125   040100 100400                    MLR     fill='040'O
        59 012126   000137 000006 58                 ADSC9   95                       cn=0,n=6
        59 012127   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12

     2053     8548    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);

   8548 59 012130   000000 235000 7                  LDA     LINE_COUNT
        59 012131   000002 135007                    SBLA    2,DL
        59 012132   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012133   000436 237000 60                 LDAQ    286
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:354  
        59 012134   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012135   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012136   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012137   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012140   000005 631400 60                 EPPR1   5
        59 012141   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012142   000000 011000                    NOP     0

     2054     8549    5                       END;

     2055     8550    4                   CALL FINDD_6('RC      ',LAST_RC_DBK);

   8550 59 012143   000100 630400 60                 EPPR0   64
        59 012144   000001 631400 60                 EPPR1   1
        59 012145   000000 701000 xent               TSX1    FINDD_6
        59 012146   000000 011000                    NOP     0

     2056     8551    4                   UWA.RC = RC;

   8551 59 012147   000000 100400                    MLR     fill='000'O
        59 012150   000000 000100 0                  ADSC9   RC                       cn=0,n=64
        59 012151   000270 000100 57                 ADSC9   UWA+184                  cn=0,n=64

     2057     8552    4                   CALL MODIFY_6('RC      ');

   8552 59 012152   000032 630400 60                 EPPR0   26
        59 012153   000013 631400 60                 EPPR1   11
        59 012154   000000 701000 xent               TSX1    MODIFY_6
        59 012155   000000 011000                    NOP     0
        59 012156   012440 710000 59                 TRA     s:8607

     2058     8553    4               CASE(%FR_PERIOD);

     2059     8554    5                   IF ~TYPE THEN DO;

   8554 59 012157   000032 236000 0                  LDQ     TYPE
        59 012160   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:355  
        59 012161   400000 676003                    ERQ     -131072,DU
        59 012162   012201 600000 59                 TZE     s:8562

     2060     8555    5                       CLAUSE_TYPE = 'TYPE';

   8555 59 012163   040100 100400                    MLR     fill='040'O
        59 012164   000141 000004 58                 ADSC9   97                       cn=0,n=4
        59 012165   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12

     2061     8556    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4316);

   8556 59 012166   000000 236000 7                  LDQ     LINE_COUNT
        59 012167   000002 136007                    SBLQ    2,DL
        59 012170   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 012171   000442 237000 60                 LDAQ    290
        59 012172   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012173   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 012174   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 012175   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012176   000005 631400 60                 EPPR1   5
        59 012177   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012200   000000 011000                    NOP     0

     2062     8557        /*E* ERROR: ZIG-4316-C
     2063     8558             MESSAGE: The required TYPE clause is missing from this
     2064     8559                      DATA subentry.
     2065     8560        */
     2066     8561    5                       END;

     2067     8562    4                   IF MOD_FR_OK THEN

   8562 59 012201   000126 234000 0                  SZN     MOD_FR_OK
        59 012202   012440 605000 59                 TPL     s:8607

     2068     8563    4                       CALL MODIFY_6('FR      ');

   8563 59 012203   000116 630400 60                 EPPR0   78
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:356  
        59 012204   000013 631400 60                 EPPR1   11
        59 012205   000000 701000 xent               TSX1    MODIFY_6
        59 012206   000000 011000                    NOP     0
        59 012207   012440 710000 59                 TRA     s:8607

     2069     8564    4               CASE(%SC_PERIOD);

     2070     8565    5                   IF ~PERM THEN DO;

   8565 59 012210   000040 236000 0                  LDQ     PERM
        59 012211   400000 376003                    ANQ     -131072,DU
        59 012212   400000 676003                    ERQ     -131072,DU
        59 012213   012227 600000 59                 TZE     s:8571

     2071     8566    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4078);

   8566 59 012214   000000 236000 7                  LDQ     LINE_COUNT
        59 012215   000002 136007                    SBLQ    2,DL
        59 012216   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 012217   000444 237000 60                 LDAQ    292
        59 012220   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012221   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 012222   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 012223   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012224   000005 631400 60                 EPPR1   5
        59 012225   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012226   000000 011000                    NOP     0

     2072     8567        /*E* ERROR: ZIG-4078-C
     2073     8568             MESSAGE: The keyword PERMANENT is required but missing.
     2074     8569        */
     2075     8570    5                       END;

     2076     8571    5                   IF ~OWNER THEN DO;

   8571 59 012227   000033 236000 0                  LDQ     OWNER
        59 012230   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:357  
        59 012231   400000 676003                    ERQ     -131072,DU
        59 012232   012251 600000 59                 TZE     s:8575

     2077     8572    5                       CLAUSE_TYPE = 'OWNER';

   8572 59 012233   040100 100400                    MLR     fill='040'O
        59 012234   000142 000005 58                 ADSC9   98                       cn=0,n=5
        59 012235   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12

     2078     8573    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);

   8573 59 012236   000000 235000 7                  LDA     LINE_COUNT
        59 012237   000002 135007                    SBLA    2,DL
        59 012240   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012241   000436 237000 60                 LDAQ    286
        59 012242   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012243   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012244   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012245   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012246   000005 631400 60                 EPPR1   5
        59 012247   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012250   000000 011000                    NOP     0

     2079     8574    5                       END;

     2080     8575    5                   IF ~PRIOR THEN DO;

   8575 59 012251   000034 236000 0                  LDQ     PRIOR
        59 012252   400000 376003                    ANQ     -131072,DU
        59 012253   400000 676003                    ERQ     -131072,DU
        59 012254   012273 600000 59                 TZE     s:8579

     2081     8576    5                       CLAUSE_TYPE = 'PRIOR';

   8576 59 012255   040100 100400                    MLR     fill='040'O
        59 012256   000144 000005 58                 ADSC9   100                      cn=0,n=5
        59 012257   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:358  

     2082     8577    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);

   8577 59 012260   000000 235000 7                  LDA     LINE_COUNT
        59 012261   000002 135007                    SBLA    2,DL
        59 012262   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012263   000436 237000 60                 LDAQ    286
        59 012264   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012265   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012266   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012267   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012270   000005 631400 60                 EPPR1   5
        59 012271   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012272   000000 011000                    NOP     0

     2083     8578    5                       END;

     2084     8579    5                   IF ~ORDER THEN DO;

   8579 59 012273   000035 236000 0                  LDQ     ORDER
        59 012274   400000 376003                    ANQ     -131072,DU
        59 012275   400000 676003                    ERQ     -131072,DU
        59 012276   012315 600000 59                 TZE     s:8583

     2085     8580    5                       CLAUSE_TYPE = 'ORDER';

   8580 59 012277   040100 100400                    MLR     fill='040'O
        59 012300   000146 000005 58                 ADSC9   102                      cn=0,n=5
        59 012301   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12

     2086     8581    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);

   8581 59 012302   000000 235000 7                  LDA     LINE_COUNT
        59 012303   000002 135007                    SBLA    2,DL
        59 012304   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012305   000436 237000 60                 LDAQ    286
        59 012306   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:359  
        59 012307   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012310   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012311   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012312   000005 631400 60                 EPPR1   5
        59 012313   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012314   000000 011000                    NOP     0

     2087     8582    5                       END;

     2088     8583    4                   CALL FINDD_6('SC      ',LAST_SC_DBK);

   8583 59 012315   000446 630400 60                 EPPR0   294
        59 012316   000001 631400 60                 EPPR1   1
        59 012317   000000 701000 xent               TSX1    FINDD_6
        59 012320   000000 011000                    NOP     0

     2089     8584    4                   CALL MODIFY_6('SC      ');

   8584 59 012321   000072 630400 60                 EPPR0   58
        59 012322   000013 631400 60                 EPPR1   11
        59 012323   000000 701000 xent               TSX1    MODIFY_6
        59 012324   000000 011000                    NOP     0
        59 012325   012440 710000 59                 TRA     s:8607

     2090     8585    4               CASE(%MEM_PERIOD);

     2091     8586    4                   IF ((UWA.SC.SETORD = 4) OR

   8586 59 012326   000312 235000 57                 LDA     UWA+202
        59 012327   000004 115007                    CMPA    4,DL
        59 012330   012333 600000 59                 TZE     s:8586+5
        59 012331   000006 115007                    CMPA    6,DL
        59 012332   012350 601000 59                 TNZ     s:8591
        59 012333   000036 234000 0                  SZN     SORTKEY
        59 012334   012350 604000 59                 TMI     s:8591

     2092     8587    4                      (UWA.SC.SETORD = 6)) AND /* INSERTION SORTED */
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:360  
     2093     8588    5                      (SORTKEY = '0'B) THEN DO; /* no sort KEY clauses */

     2094     8589    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);

   8589 59 012335   000000 235000 7                  LDA     LINE_COUNT
        59 012336   000002 135007                    SBLA    2,DL
        59 012337   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012340   000436 237000 60                 LDAQ    286
        59 012341   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012342   200072 631500                    EPPR1   KEY_MULT_REF+1,,AUTO
        59 012343   200073 451500                    STP1    KEY_MULT_REF+2,,AUTO
        59 012344   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012345   000005 631400 60                 EPPR1   5
        59 012346   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012347   000000 011000                    NOP     0

     2095     8590    5                       END;

     2096     8591    4                   FIRST_MEMBER = '0'B;

   8591 59 012350   000101 450000 0                  STZ     FIRST_MEMBER

     2097     8592    5                   IF ~SELECTION THEN DO;

   8592 59 012351   000041 236000 0                  LDQ     SELECTION
        59 012352   400000 376003                    ANQ     -131072,DU
        59 012353   400000 676003                    ERQ     -131072,DU
        59 012354   012373 600000 59                 TZE     s:8596

     2098     8593    5                       CLAUSE_TYPE = 'SELECTION';

   8593 59 012355   040100 100400                    MLR     fill='040'O
        59 012356   000117 000011 58                 ADSC9   79                       cn=0,n=9
        59 012357   200004 000014                    ADSC9   CLAUSE_TYPE,,AUTO        cn=0,n=12

     2099     8594    5                       CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4006);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:361  
   8594 59 012360   000000 235000 7                  LDA     LINE_COUNT
        59 012361   000002 135007                    SBLA    2,DL
        59 012362   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012363   000436 237000 60                 LDAQ    286
        59 012364   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012365   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012366   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012367   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012370   000005 631400 60                 EPPR1   5
        59 012371   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012372   000000 011000                    NOP     0

     2100     8595    5                       END;

     2101     8596    4                   CALL ZIG$G_DYN_MEM_6(1,DYNMEM$);

   8596 59 012373   200056 630500                    EPPR0   DYNMEM$,,AUTO
        59 012374   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012375   000003 236000 60                 LDQ     3
        59 012376   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 012377   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012400   000001 631400 60                 EPPR1   1
        59 012401   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 012402   000000 011000                    NOP     0

     2102     8597    4                   DYNMEM$->WRD1 = %END_MEM_ENTRY;

   8597 59 012403   000055 235007                    LDA     45,DL
        59 012404   200056 470500                    LDP0    DYNMEM$,,AUTO
        59 012405   000000 755100                    STA     0,,PR0

     2103     8598    4                   END;

   8598 59 012406   012440 710000 59                 TRA     s:8607

     2104     8599        /********************************************************************/
     2105     8600    3           CASE(%FAIL#);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:362  

     2106     8601    3               IF END_DDL THEN UNWIND TO SYNTAX_ERR;

   8601 59 012407   000000 234000 10                 SZN     END_DDL
        59 012410   012417 605000 59                 TPL     s:8602

   8601 59 012411   000100 100600                    MLR   ! fill='000'O
        59 012412   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
        59 012413   200072 000010                    ADSC9   KEY_MULT_REF+1,,AUTO     cn=0,n=8
        59 012414   200072 237300                    LDAQ  ! KEY_MULT_REF+1,,AUTO
        59 012415   000000 700200 xent               TSX0  ! X66_AUNWIND
        59 012416   000000 000200                    ZERO    0,128

     2107     8602    3               J = PARAN.CODE;

   8602 59 012417   000000 236100                    LDQ     0,,PR0
        59 012420   777777 376007                    ANQ     -1,DL
        59 012421   200047 756100                    STQ     J,,AUTO

     2108     8603    3               CALL ZIG$D_FAIL(J,PARAN);

   8603 59 012422   200003 236100                    LDQ     @PARAN,,AUTO
        59 012423   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 012424   200047 631500                    EPPR1   J,,AUTO
        59 012425   200072 451500                    STP1    KEY_MULT_REF+1,,AUTO
        59 012426   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012427   000001 631400 60                 EPPR1   1
        59 012430   000000 701000 xent               TSX1    ZIG$D_FAIL
        59 012431   000000 011000                    NOP     0

     2109     8604    3               UNWIND TO SYNTAX_ERR;

   8604 59 012432   000100 100600                    MLR   ! fill='000'O
        59 012433   000000 000010 xsym               ADSC9   SYNTAX_ERR               cn=0,n=8
        59 012434   200072 000010                    ADSC9   KEY_MULT_REF+1,,AUTO     cn=0,n=8
        59 012435   200072 237300                    LDAQ  ! KEY_MULT_REF+1,,AUTO
        59 012436   000000 700200 xent               TSX0  ! X66_AUNWIND
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:363  
        59 012437   000000 000200                    ZERO    0,128

     2110     8605    3               END; /* case */

     2111     8606    2           END; /* If DO_PROCESS */

     2112     8607    1       RETURN;

   8607 59 012440   000000 702200 xent               TSX2  ! X66_ARET

     2113     8608        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:364  
     2114     8609        /*******************************************************************/
     2115     8610        /*
     2116     8611             This subroutine gets a text value from x$parse and puts
     2117     8612             it in WORD1 and FIELD1.TEXT1.  The length goes
     2118     8613             into FIELD1.COUNT1.  The value goes into NUM.
     2119     8614        */
     2120     8615    1   GET_NUM:

   8615 59 012441   200062 741300       GET_NUM      STX1  ! LNO+2,,AUTO

     2121     8616    1       PROC;
     2122     8617    2       WORD1=PARAN.OUT$ -> SYM.TEXT;

   8617 59 012442   200003 470500                    LDP0    @PARAN,,AUTO
        59 012443   000002 471500                    LDP1    2,,PR0
        59 012444   100004 236100                    LDQ     4,,PR1
        59 012445   000033 772000                    QRL     27
        59 012446   000000 620006                    EAX0    0,QL
        59 012447   040000 100540                    MLR     fill='040'O
        59 012450   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        59 012451   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

     2123     8618    2       FIELD1.COUNT1=PARAN.OUT$ -> SYM.COUNT;

   8618 59 012452   000002 471500                    LDP1    2,,PR0
        59 012453   100004 236100                    LDQ     4,,PR1
        59 012454   000000 552040 56                 STBQ    FIELD1,'40'O

     2124     8619    2       FIELD1.TEXT1=WORD1;

   8619 59 012455   040000 100400                    MLR     fill='040'O
        59 012456   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 012457   000000 200037 56                 ADSC9   FIELD1                   cn=1,n=31

     2125     8620    2       CALL CHARBIN(NUM,SUBSTR(WORD1,0,FIELD1.COUNT1));

   8620 59 012460   000000 236000 56                 LDQ     FIELD1
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:365  
        59 012461   000033 772000                    QRL     27
        59 012462   000000 620006                    EAX0    0,QL
        59 012463   000000 305440                    DTB
        59 012464   000020 030010 0                  NDSC9   WORD1                    cn=0,s=nosgn,sf=0,n=*X0
        59 012465   000000 000004 1                  NDSC9   NUM                      cn=0,s=lsgnf,sf=0,n=4

     2126     8621    2   END GET_NUM;

   8621 59 012466   000001 702211                    TSX2  ! 1,X1

     2127     8622        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:366  
     2128     8623        /********************************************************************/
     2129     8624        /*
     2130     8625              This subroutine gets a text word from the X$PARSE
     2131     8626            and puts it into WORD1 and FIELD1.TEXT1 and the length
     2132     8627            in FIELD1.COUNT1.
     2133     8628        */
     2134     8629    1   GET_WORD:

   8629 59 012467   200062 741300       GET_WORD     STX1  ! LNO+2,,AUTO

     2135     8630    1       PROC;
     2136     8631    2       WORD1=PARAN.OUT$ -> SYM.TEXT;

   8631 59 012470   200003 470500                    LDP0    @PARAN,,AUTO
        59 012471   000002 471500                    LDP1    2,,PR0
        59 012472   100004 236100                    LDQ     4,,PR1
        59 012473   000033 772000                    QRL     27
        59 012474   000000 620006                    EAX0    0,QL
        59 012475   040000 100540                    MLR     fill='040'O
        59 012476   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        59 012477   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

     2137     8632    2      CALL HYPH_TO_UNDR; /* Check names for hyphens; if found, change to underscore */

   8632 59 012500   013527 701000 59                 TSX1    HYPH_TO_UNDR
        59 012501   000000 011000                    NOP     0

     2138     8633    2       FIELD1.COUNT1=PARAN.OUT$ -> SYM.COUNT;

   8633 59 012502   200003 470500                    LDP0    @PARAN,,AUTO
        59 012503   000002 471500                    LDP1    2,,PR0
        59 012504   100004 236100                    LDQ     4,,PR1
        59 012505   000000 552040 56                 STBQ    FIELD1,'40'O

     2139     8634    2       FIELD1.TEXT1=WORD1;

   8634 59 012506   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:367  
        59 012507   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 012510   000000 200037 56                 ADSC9   FIELD1                   cn=1,n=31

     2140     8635    2       RETURN;

   8635 59 012511   200062 221300                    LDX1  ! LNO+2,,AUTO
        59 012512   000001 702211                    TSX2  ! 1,X1

     2141     8636    2   END GET_WORD;
     2142     8637    1   GET_WORD_SUB:

   8637 59 012513   200062 741300       GET_WORD_SUB STX1  ! LNO+2,,AUTO

     2143     8638    1       PROC;
     2144     8639    2       WORD1 = PARAN.OUT$->BLK.SUBLK$(0)->SYM.TEXT;

   8639 59 012514   200003 470500                    LDP0    @PARAN,,AUTO
        59 012515   000002 471500                    LDP1    2,,PR0
        59 012516   100003 473500                    LDP3    3,,PR1
        59 012517   300004 236100                    LDQ     4,,PR3
        59 012520   000033 772000                    QRL     27
        59 012521   000000 620006                    EAX0    0,QL
        59 012522   040000 100540                    MLR     fill='040'O
        59 012523   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
        59 012524   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30

     2145     8640    2       FIELD1.COUNT1=PARAN.OUT$ -> BLK.SUBLK$(0)-> SYM.COUNT;

   8640 59 012525   000002 471500                    LDP1    2,,PR0
        59 012526   100003 473500                    LDP3    3,,PR1
        59 012527   300004 236100                    LDQ     4,,PR3
        59 012530   000000 552040 56                 STBQ    FIELD1,'40'O

     2146     8641    2       FIELD1.TEXT1=WORD1;

   8641 59 012531   040000 100400                    MLR     fill='040'O
        59 012532   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:368  
        59 012533   000000 200037 56                 ADSC9   FIELD1                   cn=1,n=31

     2147     8642    2       RETURN;

   8642 59 012534   000001 702211                    TSX2  ! 1,X1

     2148     8643    2   END GET_WORD_SUB;
     2149     8644        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:369  
     2150     8645        /********************************************************************/
     2151     8646        /*
     2152     8647              This subroutine checks to see if the current word in the
     2153     8648            schema ddl is a reserved word
     2154     8649            or the user goofed and
     2155     8650            has two different words that are the same so that a error
     2156     8651            must be generated.
     2157     8652
     2158     8653
     2159     8654        */
     2160     8655    1   CHECK_RESW_DUPS:

   8655 59 012535   200062 741300       CHECK_RESW_* STX1  ! LNO+2,,AUTO

     2161     8656    1       PROC;
     2162     8657    2       CALL ZIG$HASH_IT(WORD1,%NO_ADD,ERROR_STATUS,0,0,9,PTR$,LAST_STATUS);

   8657 59 012536   000450 630400 60                 EPPR0   296
        59 012537   000020 631400 60                 EPPR1   16
        59 012540   000000 701000 xent               TSX1    ZIG$HASH_IT
        59 012541   000000 011000                    NOP     0

     2163     8658    3       DO CASE (ERROR_STATUS);

   8658 59 012542   000000 235000 9                  LDA     ERROR_STATUS
        59 012543   000004 115007                    CMPA    4,DL
        59 012544   012546 602005 59                 TNC     s:8658+4,AL
        59 012545   012605 710000 59                 TRA     s:8687
        59 012546   012605 710000 59                 TRA     s:8687
        59 012547   012552 710000 59                 TRA     s:8664
        59 012550   012556 710000 59                 TRA     s:8670
        59 012551   012572 710000 59                 TRA     s:8681

     2164     8659    3       CASE(1);

     2165     8660         /*
     2166     8661            There is a alias in the table so put out a descriptor
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:370  
     2167     8662            for what ever type of alias and word it is.
     2168     8663         */
     2169     8664    3           WORD1 = ' ';

   8664 59 012552   040000 100400                    MLR     fill='040'O
        59 012553   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 012554   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 012555   012605 710000 59                 TRA     s:8687

     2170     8665    3       CASE (2);

     2171     8666         /*
     2172     8667            There is a dup in the hash table all ready for this
     2173     8668            word so error this line.
     2174     8669         */
     2175     8670    3           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%DUP_DDL_DATA_NAME);

   8670 59 012556   000000 236000 7                  LDQ     LINE_COUNT
        59 012557   000002 136007                    SBLQ    2,DL
        59 012560   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 012561   000462 237000 60                 LDAQ    306
        59 012562   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012563   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012564   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012565   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012566   000005 631400 60                 EPPR1   5
        59 012567   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012570   000000 011000                    NOP     0
        59 012571   012605 710000 59                 TRA     s:8687

     2176     8671        /*E* ERROR: ZIG-%DUP_DDL_DATA_NAME-C
     2177     8672             MESSAGE: There is a duplicate name in the schema DDL text for the
     2178     8673                      word %U1. One of these must be changed in the schema
     2179     8674                      text.
     2180     8675        */
     2181     8676    3       CASE (3);

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:371  
     2182     8677         /*
     2183     8678            There is a user defined word that is the same as
     2184     8679            reserved word for this language.
     2185     8680         */
     2186     8681    3           CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,%DDL_RES_WORD);

   8681 59 012572   000000 236000 7                  LDQ     LINE_COUNT
        59 012573   000002 136007                    SBLQ    2,DL
        59 012574   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 012575   000464 237000 60                 LDAQ    308
        59 012576   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012577   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012600   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012601   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012602   000005 631400 60                 EPPR1   5
        59 012603   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012604   000000 011000                    NOP     0

     2187     8682        /*E* ERROR: ZIG-%DDL_RES_WORD-C
     2188     8683             MESSAGE: The word %U1 is the same as a reserved word for the
     2189     8684                      DDL and, therefore, cannot be a user-defined word.
     2190     8685        */
     2191     8686    3           END;

     2192     8687    2       RETURN;

   8687 59 012605   200062 221300                    LDX1  ! LNO+2,,AUTO
        59 012606   000001 702211                    TSX2  ! 1,X1

     2193     8688    2   END CHECK_RESW_DUPS;
     2194     8689        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:372  
     2195     8690        /******************************************************************/
     2196     8691        /*
     2197     8692          This subroutine is called after the end of a record entry, when
     2198     8693          all fields within the record have been defined.  Its purpose is to:
     2199     8694          1) finish processing of alternate keys,
     2200     8695          2) check to ensure that all calckeys mentioned in LOC MODE CALC
     2201     8696             USING clause have been defined in this record,
     2202     8697        */
     2203     8698    1   CLEAN_UP_REC:

   8698 59 012607   200062 741300       CLEAN_UP_REC STX1  ! LNO+2,,AUTO

     2204     8699    1       PROC;
     2205     8700    2   DCL 01 FR UNAL,
     2206     8701    2         02 FTYPE SBIN(36),
     2207     8702    2         02 PREC SBIN(36),
     2208     8703    2         02 SCALE SBIN(36),
     2209     8704    2         02 F_SIGN SBIN(36),
     2210     8705    2         02 FR_FRH UBIN(36);
     2211     8706    2   DCL DBK_SFR UBIN(36);
     2212     8707    2   DCL KEY_MULT_REF BIT(1);
     2213     8708    2       REC_ENTRY_DONE = '0'B;

   8708 59 012610   000100 450000 0                  STZ     REC_ENTRY_DONE

     2214     8709    2       CALL FINDD_6('RC      ',LAST_RC_DBK);

   8709 59 012611   000100 630400 60                 EPPR0   64
        59 012612   000001 631400 60                 EPPR1   1
        59 012613   000000 701000 xent               TSX1    FINDD_6
        59 012614   000000 011000                    NOP     0

     2215     8710         /* update RC so things like rc.fixvar get in */
     2216     8711    2       UWA.RC = RC;

   8711 59 012615   000000 100400                    MLR     fill='000'O
        59 012616   000000 000100 0                  ADSC9   RC                       cn=0,n=64
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:373  
        59 012617   000270 000100 57                 ADSC9   UWA+184                  cn=0,n=64

     2217     8712    2       CALL MODIFY_6('RC      ');

   8712 59 012620   000032 630400 60                 EPPR0   26
        59 012621   000013 631400 60                 EPPR1   11
        59 012622   000000 701000 xent               TSX1    MODIFY_6
        59 012623   000000 011000                    NOP     0

     2218     8713         /* set AC bit if altkeys present in record...do ANY [EXCEPT...]
     2219     8714            in pass2 */
     2220     8715    2       IF UWA.RC.KEY_PRESENT = 1 AND UWA.RC.ANY_IND = 0 THEN

   8715 59 012624   000301 235000 57                 LDA     UWA+193
        59 012625   000001 115007                    CMPA    1,DL
        59 012626   012667 601000 59                 TNZ     s:8726
        59 012627   000300 236000 57                 LDQ     UWA+192
        59 012630   012667 601000 59                 TNZ     s:8726

     2221     8716    3       DO;

     2222     8717    3           CALL FINDNS_6('RC-RA   '); /* RA */

   8717 59 012631   000466 630400 60                 EPPR0   310
        59 012632   000013 631400 60                 EPPR1   11
        59 012633   000000 701000 xent               TSX1    FINDNS_6
        59 012634   000000 011000                    NOP     0

     2223     8718    4           DO WHILE (UWA.DB_STATUS ~= '0502100');

   8718 59 012635   040000 106400                    CMPC    fill='040'O
        59 012636   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 012637   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 012640   012667 600000 59                 TZE     s:8726

     2224     8719    4               CALL FETCHOS_6('AC-RA   '); /* AC */

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:374  
   8719 59 012641   000467 630400 60                 EPPR0   311
        59 012642   000013 631400 60                 EPPR1   11
        59 012643   000000 701000 xent               TSX1    FETCHOS_6
        59 012644   000000 011000                    NOP     0

     2225     8720    4               UWA.AC.SEC_KEY = 1;

   8720 59 012645   000001 235007                    LDA     1,DL
        59 012646   000235 755000 57                 STA     UWA+157

     2226     8721    4               IF UWA.RC.PSMODE = 4 THEN UWA.AC.PRIME_KEY = 1;

   8721 59 012647   000271 236000 57                 LDQ     UWA+185
        59 012650   000004 116007                    CMPQ    4,DL
        59 012651   012653 601000 59                 TNZ     s:8722

   8721 59 012652   000234 755000 57                 STA     UWA+156

     2227     8722    4               CALL MODIFY_6('AC      ');

   8722 59 012653   000144 630400 60                 EPPR0   100
        59 012654   000013 631400 60                 EPPR1   11
        59 012655   000000 701000 xent               TSX1    MODIFY_6
        59 012656   000000 011000                    NOP     0

     2228     8723    4               CALL FINDNS_6('RC-RA   '); /* RA */

   8723 59 012657   000466 630400 60                 EPPR0   310
        59 012660   000013 631400 60                 EPPR1   11
        59 012661   000000 701000 xent               TSX1    FINDNS_6
        59 012662   000000 011000                    NOP     0

     2229     8724    4               END;

   8724 59 012663   040000 106400                    CMPC    fill='040'O
        59 012664   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 012665   000071 000007 58                 ADSC9   57                       cn=0,n=7
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:375  
        59 012666   012641 601000 59                 TNZ     s:8719

     2230     8725    3           END;

     2231     8726    2       IF UWA.RC.PSMODE = 4 AND UWA.RC.ANY_IND = 0 THEN /* INDEXED */

   8726 59 012667   000271 235000 57                 LDA     UWA+185
        59 012670   000004 115007                    CMPA    4,DL
        59 012671   012743 601000 59                 TNZ     s:8744
        59 012672   000300 236000 57                 LDQ     UWA+192
        59 012673   012743 601000 59                 TNZ     s:8744

     2232     8727    3       DO;

     2233     8728    3           CALL FINDNS_6('RC-RA   '); /* RA */

   8728 59 012674   000466 630400 60                 EPPR0   310
        59 012675   000013 631400 60                 EPPR1   11
        59 012676   000000 701000 xent               TSX1    FINDNS_6
        59 012677   000000 011000                    NOP     0

     2234     8729    3           CALL FETCHOS_6('AC-RA   '); /* AC */

   8729 59 012700   000467 630400 60                 EPPR0   311
        59 012701   000013 631400 60                 EPPR1   11
        59 012702   000000 701000 xent               TSX1    FETCHOS_6
        59 012703   000000 011000                    NOP     0

     2235     8730    3           UWA.AC.PRIME_KEY = 1;

   8730 59 012704   000001 235007                    LDA     1,DL
        59 012705   000234 755000 57                 STA     UWA+156

     2236     8731    3           UWA.AC.PAGE_TYP = 3;

   8731 59 012706   000003 236007                    LDQ     3,DL
        59 012707   000237 756000 57                 STQ     UWA+159
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:376  

     2237     8732    3           CALL MODIFY_6('AC      ');

   8732 59 012710   000144 630400 60                 EPPR0   100
        59 012711   000013 631400 60                 EPPR1   11
        59 012712   000000 701000 xent               TSX1    MODIFY_6
        59 012713   000000 011000                    NOP     0

     2238     8733    3           CALL FINDNS_6('AC-RA   '); /* RA */

   8733 59 012714   000467 630400 60                 EPPR0   311
        59 012715   000013 631400 60                 EPPR1   11
        59 012716   000000 701000 xent               TSX1    FINDNS_6
        59 012717   000000 011000                    NOP     0

     2239     8734    3           CALL FINDNS_6('AC-RA   '); /* should not be another RA */

   8734 59 012720   000467 630400 60                 EPPR0   311
        59 012721   000013 631400 60                 EPPR1   11
        59 012722   000000 701000 xent               TSX1    FINDNS_6
        59 012723   000000 011000                    NOP     0

     2240     8735    3           IF UWA.DB_STATUS ~= '0502100' THEN

   8735 59 012724   040000 106400                    CMPC    fill='040'O
        59 012725   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 012726   000071 000007 58                 ADSC9   57                       cn=0,n=7
        59 012727   012743 600000 59                 TZE     s:8744

     2241     8736    4           DO;

     2242     8737    4               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4977);

   8737 59 012730   000000 235000 7                  LDA     LINE_COUNT
        59 012731   000002 135007                    SBLA    2,DL
        59 012732   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 012733   000472 237000 60                 LDAQ    314
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:377  
        59 012734   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012735   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012736   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012737   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012740   000005 631400 60                 EPPR1   5
        59 012741   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012742   000000 011000                    NOP     0

     2243     8738        /*E* ERROR: ZIG-4977-C
     2244     8739             MESSAGE: The area contains more than one record and indexed
     2245     8740                      areas can contain only one record per indexed area.
     2246     8741        */
     2247     8742    4               END;

     2248     8743    3           END;

     2249     8744    2       CALL FETCHNS_6('RC-FR   '); /* looking for SFRs */

   8744 59 012743   000234 630400 60                 EPPR0   156
        59 012744   000013 631400 60                 EPPR1   11
        59 012745   000000 701000 xent               TSX1    FETCHNS_6
        59 012746   000000 011000                    NOP     0

     2250     8745    3       DO WHILE (UWA.DB_STATUS = '0000000');

   8745 59 012747   040000 106400                    CMPC    fill='040'O
        59 012750   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 012751   000103 000007 58                 ADSC9   67                       cn=0,n=7
        59 012752   013324 601000 59                 TNZ     EOS_RCFR

     2251     8746         /* if calckey in loc mode calc using clause never got
     2252     8747            defined, then this misused field will still be = 1 */
     2253     8748    4           IF UWA.FR.F_OCCURS = 1 THEN DO;

   8748 59 012753   000345 235000 57                 LDA     UWA+229
        59 012754   000001 115007                    CMPA    1,DL
        59 012755   012771 601000 59                 TNZ     s:8751
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:378  

     2254     8749    4               CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4808);

   8749 59 012756   000000 236000 7                  LDQ     LINE_COUNT
        59 012757   000002 136007                    SBLQ    2,DL
        59 012760   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 012761   000132 237000 60                 LDAQ    90
        59 012762   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 012763   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 012764   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 012765   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 012766   000005 631400 60                 EPPR1   5
        59 012767   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 012770   000000 011000                    NOP     0

     2255     8750    4               END;

     2256     8751    4           DO CASE(UWA.FR.F_USE);

   8751 59 012771   000343 235000 57                 LDA     UWA+227
        59 012772   000007 135007                    SBLA    7,DL
        59 012773   000001 115007                    CMPA    1,DL
        59 012774   012776 602005 59                 TNC     s:8751+5,AL
        59 012775   013314 710000 59                 TRA     s:8831
        59 012776   012777 710000 59                 TRA     s:8753

     2257     8752    4           CASE(7); /* altkey */

     2258     8753    4               DBK_SFR = UWA.DIRECT_REF;

   8753 59 012777   000036 236000 57                 LDQ     UWA+30
        59 013000   200070 756100                    STQ     DBK_SFR,,AUTO

     2259     8754    4               IF UWA.FR.RPT = 1

   8754 59 013001   000344 235000 57                 LDA     UWA+228
        59 013002   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:379  
        59 013003   013007 601000 59                 TNZ     s:8756

     2260     8755    4               THEN KEY_MULT_REF = '1'B;

   8755 59 013004   400000 236003                    LDQ     -131072,DU
        59 013005   200071 756100                    STQ     KEY_MULT_REF,,AUTO
        59 013006   013010 710000 59                 TRA     s:8758

     2261     8756    4               ELSE KEY_MULT_REF = '0'B;

   8756 59 013007   200071 450100                    STZ     KEY_MULT_REF,,AUTO

     2262     8757         /* make SM for this altkey current so can connect CF later */
     2263     8758    4               CALL FINDNS_6('FR-CFS  ');

   8758 59 013010   000125 630400 60                 EPPR0   85
        59 013011   000013 631400 60                 EPPR1   11
        59 013012   000000 701000 xent               TSX1    FINDNS_6
        59 013013   000000 011000                    NOP     0

     2264     8759    4               CALL FINDOS_6('SMSS-CF ');

   8759 59 013014   000130 630400 60                 EPPR0   88
        59 013015   000013 631400 60                 EPPR1   11
        59 013016   000000 701000 xent               TSX1    FINDOS_6
        59 013017   000000 011000                    NOP     0

     2265     8760         /* fetch realFR of field corresponding to this altkey */
     2266     8761    4               CALL FETCHD_6('SN      ',UWA.FR.FR_FRH);

   8761 59 013020   000474 630400 60                 EPPR0   316
        59 013021   000001 631400 60                 EPPR1   1
        59 013022   000000 701000 xent               TSX1    FETCHD_6
        59 013023   000000 011000                    NOP     0

     2267     8762         /* if altkey never matched a defined field, then error */
     2268     8763    4               CALL JUST_FIND_SN(%ZIG_RTYPE_FR,UWA.SN.SENAME,0,LNO,FOUND,0,0,
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:380  
              8763                        LAST_RC_DBK);

   8763 59 013024   000226 237000 60                 LDAQ    150
        59 013025   200100 757100                    STAQ    KEY_MULT_REF+7,,AUTO
        59 013026   000476 237000 60                 LDAQ    318
        59 013027   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 013030   200060 630500                    EPPR0   LNO,,AUTO
        59 013031   200075 450500                    STP0    KEY_MULT_REF+4,,AUTO
        59 013032   000024 236000 60                 LDQ     20
        59 013033   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 013034   000500 237000 60                 LDAQ    320
        59 013035   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 013036   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013037   000020 631400 60                 EPPR1   16
        59 013040   000000 701000 xent               TSX1    JUST_FIND_SN
        59 013041   000000 011000                    NOP     0

     2269     8764    4               IF (FOUND = %NOTFOUND) OR (UWA.SN.DCLR = 0)

   8764 59 013042   000133 235000 0                  LDA     FOUND
        59 013043   013046 600000 59                 TZE     s:8766
        59 013044   000422 236000 57                 LDQ     UWA+274
        59 013045   013071 601000 59                 TNZ     s:8775

     2270     8765    5               THEN DO;

     2271     8766    5                   CALL INDEX(CT1,' ',UWA.SN.SENAME);

   8766 59 013046   000000 124400                    SCM     mask='000'O
        59 013047   000427 000036 57                 ADSC9   UWA+279                  cn=0,n=30
        59 013050   000046 000001 60                 ADSC9   38                       cn=0,n=1
        59 013051   200050 000100                    ARG     CT1,,AUTO

     2272     8767    5                   CALL SET_FIELDS(1,CT1,UWA.SN.SENAME);

   8767 59 013052   000360 236000 60                 LDQ     240
        59 013053   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:381  
        59 013054   200050 630500                    EPPR0   CT1,,AUTO
        59 013055   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 013056   000003 236000 60                 LDQ     3
        59 013057   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 013060   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013061   000005 631400 60                 EPPR1   5
        59 013062   000000 701000 xent               TSX1    SET_FIELDS
        59 013063   000000 011000                    NOP     0

     2273     8768    5                   CALL ZIG$D_DIAG(UWA.SN.LNO,%ERR_SEV,4153);

   8768 59 013064   000502 630400 60                 EPPR0   322
        59 013065   000005 631400 60                 EPPR1   5
        59 013066   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 013067   000000 011000                    NOP     0

     2274     8769        /*E* ERROR: ZIG-4153-C
     2275     8770             MESSAGE: The data base identifier "%U1" has not been defined
     2276     8771                      in this record.
     2277     8772        */
     2278     8773    5                   END; /* THEN DO */

   8773 59 013070   013314 710000 59                 TRA     s:8831

     2279     8774    5               ELSE DO;

     2280     8775    5                   CALL FETCHNS_6('SN-SE   '); /* FR */

   8775 59 013071   000107 630400 60                 EPPR0   71
        59 013072   000013 631400 60                 EPPR1   11
        59 013073   000000 701000 xent               TSX1    FETCHNS_6
        59 013074   000000 011000                    NOP     0

     2281     8776         /* save realFR info to put into SFR later */
     2282     8777    5                   FR.FTYPE = UWA.FR.FTYPE;

   8777 59 013075   000334 235000 57                 LDA     UWA+220
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:382  
        59 013076   200063 755100                    STA     FR,,AUTO

     2283     8778    5                   FR.PREC = UWA.FR.PREC;

   8778 59 013077   000335 236000 57                 LDQ     UWA+221
        59 013100   200064 756100                    STQ     @LKNAME+1,,AUTO

     2284     8779    5                   FR.SCALE = UWA.FR.SCALE;

   8779 59 013101   000336 235000 57                 LDA     UWA+222
        59 013102   200065 755100                    STA     @TYPE+1,,AUTO

     2285     8780    5                   FR.F_SIGN = UWA.FR.F_SIGN;

   8780 59 013103   000337 235000 57                 LDA     UWA+223
        59 013104   200066 755100                    STA     LOCK_TYPE+1,,AUTO

     2286     8781    5                   FR.FR_FRH = UWA.DIRECT_REF;

   8781 59 013105   000036 235000 57                 LDA     UWA+30
        59 013106   200067 755100                    STA     LOCK_TYPE+2,,AUTO

     2287     8782         /* update realFR to reflect that an SFR references it */
     2288     8783    5                   UWA.FR.REF = 1;

   8783 59 013107   000001 235007                    LDA     1,DL
        59 013110   000333 755000 57                 STA     UWA+219

     2289     8784    5                   CALL MODIFY_6('FR      ');

   8784 59 013111   000116 630400 60                 EPPR0   78
        59 013112   000013 631400 60                 EPPR1   11
        59 013113   000000 701000 xent               TSX1    MODIFY_6
        59 013114   000000 011000                    NOP     0

     2290     8785    6                   IF KEY_MULT_REF THEN DO;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:383  
   8785 59 013115   200071 234100                    SZN     KEY_MULT_REF,,AUTO
        59 013116   013215 605000 59                 TPL     s:8807

     2291     8786    6                       CALL FINDOS_6('SN-SE   '); /* SN of real FR of altkey field */

   8786 59 013117   000107 630400 60                 EPPR0   71
        59 013120   000013 631400 60                 EPPR1   11
        59 013121   000000 701000 xent               TSX1    FINDOS_6
        59 013122   000000 011000                    NOP     0

     2292     8787    6                       CALL FETCHNS_6('SN-NRCO '); /* NR connecting key to field */

   8787 59 013123   000505 630400 60                 EPPR0   325
        59 013124   000013 631400 60                 EPPR1   11
        59 013125   000000 701000 xent               TSX1    FETCHNS_6
        59 013126   000000 011000                    NOP     0

     2293     8788    7                       DO WHILE (UWA.NR.RELTYPE ~= 18); /* key in rec */

   8788 59 013127   000470 235000 57                 LDA     UWA+312
        59 013130   000022 115007                    CMPA    18,DL
        59 013131   013141 600000 59                 TZE     s:8791

     2294     8789    7                           CALL FETCHNS_6('SN-NRCO ');

   8789 59 013132   000505 630400 60                 EPPR0   325
        59 013133   000013 631400 60                 EPPR1   11
        59 013134   000000 701000 xent               TSX1    FETCHNS_6
        59 013135   000000 011000                    NOP     0

     2295     8790    7                           END;

   8790 59 013136   000470 235000 57                 LDA     UWA+312
        59 013137   000022 115007                    CMPA    18,DL
        59 013140   013132 601000 59                 TNZ     s:8789

     2296     8791    6                       CALL FINDOS_6('SN-NRWU ');
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:384  
              8791                                /* SN of first field ref'ed by altkey */

   8791 59 013141   000506 630400 60                 EPPR0   326
        59 013142   000013 631400 60                 EPPR1   11
        59 013143   000000 701000 xent               TSX1    FINDOS_6
        59 013144   000000 011000                    NOP     0

     2297     8792    6                       CALL FINDNS_6('SN-NRWU '); /* NR */

   8792 59 013145   000506 630400 60                 EPPR0   326
        59 013146   000013 631400 60                 EPPR1   11
        59 013147   000000 701000 xent               TSX1    FINDNS_6
        59 013150   000000 011000                    NOP     0

     2298     8793    6                       CALL FINDOS_6('SN-NRCO ');
              8793                                /* SN of other field used by altkey */

   8793 59 013151   000505 630400 60                 EPPR0   325
        59 013152   000013 631400 60                 EPPR1   11
        59 013153   000000 701000 xent               TSX1    FINDOS_6
        59 013154   000000 011000                    NOP     0

     2299     8794    6                       CALL FETCHNS_6('SN-SE   ');
              8794                                /* FR of other field used by altkey */

   8794 59 013155   000107 630400 60                 EPPR0   71
        59 013156   000013 631400 60                 EPPR1   11
        59 013157   000000 701000 xent               TSX1    FETCHNS_6
        59 013160   000000 011000                    NOP     0

     2300     8795    6                       IF (UWA.FR.FTYPE ~= FR.FTYPE) OR

   8795 59 013161   000334 236000 57                 LDQ     UWA+220
        59 013162   200063 116100                    CMPQ    FR,,AUTO
        59 013163   013172 601000 59                 TNZ     s:8798
        59 013164   000335 236000 57                 LDQ     UWA+221
        59 013165   200064 116100                    CMPQ    @LKNAME+1,,AUTO
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:385  
        59 013166   013172 601000 59                 TNZ     s:8798
        59 013167   000336 236000 57                 LDQ     UWA+222
        59 013170   200065 116100                    CMPQ    @TYPE+1,,AUTO
        59 013171   013205 600000 59                 TZE     s:8804

     2301     8796    6                          (UWA.FR.PREC ~= FR.PREC) OR
     2302     8797    6                          (UWA.FR.SCALE ~= FR.SCALE)
     2303     8798    6                       THEN CALL ZIG$D_DIAG(LINE_COUNT - 2,%ERR_SEV,4155);

   8798 59 013172   000000 235000 7                  LDA     LINE_COUNT
        59 013173   000002 135007                    SBLA    2,DL
        59 013174   200072 755100                    STA     KEY_MULT_REF+1,,AUTO
        59 013175   000510 237000 60                 LDAQ    328
        59 013176   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 013177   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013200   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 013201   200073 630500                    EPPR0   KEY_MULT_REF+2,,AUTO
        59 013202   000005 631400 60                 EPPR1   5
        59 013203   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 013204   000000 011000                    NOP     0

     2304     8799        /*E* ERROR: ZIG-4155-C
     2305     8800             MESSAGE: All of the data base identifiers defined for key
     2306     8801                      "%U1" do not have the same type, precision, and
     2307     8802                      scale.
     2308     8803        */
     2309     8804    6                       CALL FINDD_6('FR     ',FR.FR_FRH); /* restore currency of FR */

   8804 59 013205   200067 630500                    EPPR0   LOCK_TYPE+2,,AUTO
        59 013206   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 013207   000116 236000 60                 LDQ     78
        59 013210   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 013211   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013212   000001 631400 60                 EPPR1   1
        59 013213   000000 701000 xent               TSX1    FINDD_6
        59 013214   000000 011000                    NOP     0

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:386  
     2310     8805    6                       END;

     2311     8806         /* build real CF and connect it to SM */
     2312     8807    5                   UWA.C_F = '0'B;

   8807 59 013215   000000 100400                    MLR     fill='000'O
        59 013216   000000 000001 60                 ADSC9   0                        cn=0,n=1
        59 013217   000400 000024 57                 ADSC9   UWA+256                  cn=0,n=20

     2313     8808    5                   UWA.C_F.SYN = 0;

   8808 59 013220   000400 450000 57                 STZ     UWA+256

     2314     8809    5                   UWA.C_F.CTRLTYPE = 3;

   8809 59 013221   000003 235007                    LDA     3,DL
        59 013222   000401 755000 57                 STA     UWA+257

     2315     8810    5                   CALL STRE_6('C-F      ');

   8810 59 013223   000175 630400 60                 EPPR0   125
        59 013224   000013 631400 60                 EPPR1   11
        59 013225   000000 701000 xent               TSX1    STRE_6
        59 013226   000000 011000                    NOP     0

     2316     8811    5                   UWA.OA.NUMB_CF = UWA.OA.NUMB_CF + 1;

   8811 59 013227   000224 054000 57                 AOS     UWA+148

     2317     8812    5                   CALL CONNECT_6('SMSS-CF ');

   8812 59 013230   000130 630400 60                 EPPR0   88
        59 013231   000013 631400 60                 EPPR1   11
        59 013232   000000 701000 xent               TSX1    CONNECT_6
        59 013233   000000 011000                    NOP     0

     2318     8813    5                   CALL MOVE_TO_FIRST_POS( FR.FR_FRH, 'FR-CFS  ',
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:387  

   8813 59 013234   000126 237000 60                 LDAQ    86
        59 013235   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 013236   000125 236000 60                 LDQ     85
        59 013237   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 013240   200067 630500                    EPPR0   LOCK_TYPE+2,,AUTO
        59 013241   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 013242   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013243   000124 631400 60                 EPPR1   84
        59 013244   000000 701000 xent               TSX1    MOVE_TO_FIRST_POS
        59 013245   000000 011000                    NOP     0

     2319     8814    5                      'FR      ', 'C-F     ' );
     2320     8815         /* Move old CF to end of SMSS-CF chain */
     2321     8816    5                   CALL FETCHOS_6('SMSS-CF ');

   8816 59 013246   000130 630400 60                 EPPR0   88
        59 013247   000013 631400 60                 EPPR1   11
        59 013250   000000 701000 xent               TSX1    FETCHOS_6
        59 013251   000000 011000                    NOP     0

     2322     8817    5                   CALL FETCHNS_6('SMSS-CF ');

   8817 59 013252   000130 630400 60                 EPPR0   88
        59 013253   000013 631400 60                 EPPR1   11
        59 013254   000000 701000 xent               TSX1    FETCHNS_6
        59 013255   000000 011000                    NOP     0

     2323     8818    5                   CALL DISCONNECT_6('SMSS-CF ');

   8818 59 013256   000130 630400 60                 EPPR0   88
        59 013257   000013 631400 60                 EPPR1   11
        59 013260   000000 701000 xent               TSX1    DISCONNECT_6
        59 013261   000000 011000                    NOP     0

     2324     8819    5                   CALL CONNECT_6('SMSS-CF ');

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:388  
   8819 59 013262   000130 630400 60                 EPPR0   88
        59 013263   000013 631400 60                 EPPR1   11
        59 013264   000000 701000 xent               TSX1    CONNECT_6
        59 013265   000000 011000                    NOP     0

     2325     8820         /* now update the SFR */
     2326     8821    5                   CALL FETCHD_6('FR      ',DBK_SFR);

   8821 59 013266   200070 630500                    EPPR0   DBK_SFR,,AUTO
        59 013267   200073 450500                    STP0    KEY_MULT_REF+2,,AUTO
        59 013270   000116 236000 60                 LDQ     78
        59 013271   200072 756100                    STQ     KEY_MULT_REF+1,,AUTO
        59 013272   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013273   000001 631400 60                 EPPR1   1
        59 013274   000000 701000 xent               TSX1    FETCHD_6
        59 013275   000000 011000                    NOP     0

     2327     8822    5                   UWA.FR.FTYPE = FR.FTYPE;

   8822 59 013276   200063 235100                    LDA     FR,,AUTO
        59 013277   000334 755000 57                 STA     UWA+220

     2328     8823    5                   UWA.FR.PREC = FR.PREC;

   8823 59 013300   200064 236100                    LDQ     @LKNAME+1,,AUTO
        59 013301   000335 756000 57                 STQ     UWA+221

     2329     8824    5                   UWA.FR.SCALE = FR.SCALE;

   8824 59 013302   200065 235100                    LDA     @TYPE+1,,AUTO
        59 013303   000336 755000 57                 STA     UWA+222

     2330     8825    5                   UWA.FR.F_SIGN = FR.F_SIGN;

   8825 59 013304   200066 235100                    LDA     LOCK_TYPE+1,,AUTO
        59 013305   000337 755000 57                 STA     UWA+223

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:389  
     2331     8826    5                   UWA.FR.FR_FRH = FR.FR_FRH;

   8826 59 013306   200067 235100                    LDA     LOCK_TYPE+2,,AUTO
        59 013307   000352 755000 57                 STA     UWA+234

     2332     8827    5                   CALL MODIFY_6('FR      ');

   8827 59 013310   000116 630400 60                 EPPR0   78
        59 013311   000013 631400 60                 EPPR1   11
        59 013312   000000 701000 xent               TSX1    MODIFY_6
        59 013313   000000 011000                    NOP     0

     2333     8828    5                   END; /* ELSE DO */

     2334     8829    4               END; /* case */

     2335     8830         /* on to the next  possibly synonymous FR */
     2336     8831    3           CALL FETCHNS_6('RC-FR   ') ALTRET(EOS_RCFR);

   8831 59 013314   000234 630400 60                 EPPR0   156
        59 013315   000013 631400 60                 EPPR1   11
        59 013316   000000 701000 xent               TSX1    FETCHNS_6
        59 013317   013324 702000 59                 TSX2    EOS_RCFR

     2337     8832    3           END;

   8832 59 013320   040000 106400                    CMPC    fill='040'O
        59 013321   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 013322   000103 000007 58                 ADSC9   67                       cn=0,n=7
        59 013323   012753 600000 59                 TZE     s:8748

     2338     8833    2   EOS_RCFR:
     2339     8834    2   END CLEAN_UP_REC;

   8834 59 013324                       EOS_RCFR     null
   8834 59 013324   200062 221300                    LDX1  ! LNO+2,,AUTO
        59 013325   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:390  

     2340     8835        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:391  
     2341     8836    1   RESTORE_CURRENTS:

   8836 59 013326   200062 741300       RESTORE_CUR* STX1  ! LNO+2,,AUTO

     2342     8837    1       PROC;
     2343     8838    2       CALL FINDD_6('SF      ',2);

   8838 59 013327   000512 630400 60                 EPPR0   330
        59 013330   000001 631400 60                 EPPR1   1
        59 013331   000000 701000 xent               TSX1    FINDD_6
        59 013332   000000 011000                    NOP     0

     2344     8839    2       IF UWA.DB_STATUS ~= '0000000'

   8839 59 013333   040000 106400                    CMPC    fill='040'O
        59 013334   000001 000007 57                 ADSC9   UWA+1                    cn=0,n=7
        59 013335   000103 000007 58                 ADSC9   67                       cn=0,n=7
        59 013336   013342 600000 59                 TZE     s:8841

     2345     8840    2       THEN CALL ABORT;

   8840 59 013337   000000 631400 60                 EPPR1   0
        59 013340   000000 701000 xent               TSX1    ABORT
        59 013341   000000 011000                    NOP     0

     2346     8841    2       CALL FINDD_6('OA      ',UWA.SF.DBKEY_OA);

   8841 59 013342   000514 630400 60                 EPPR0   332
        59 013343   000001 631400 60                 EPPR1   1
        59 013344   000000 701000 xent               TSX1    FINDD_6
        59 013345   000000 011000                    NOP     0

     2347     8842    2       CALL FINDD_6('DA      ',UWA.SF.DBKEY_DA);

   8842 59 013346   000516 630400 60                 EPPR0   334
        59 013347   000001 631400 60                 EPPR1   1
        59 013350   000000 701000 xent               TSX1    FINDD_6
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:392  
        59 013351   000000 011000                    NOP     0

     2348     8843    2       CALL FINDD_6('SA      ',UWA.SF.DBKEY_SA);

   8843 59 013352   000520 630400 60                 EPPR0   336
        59 013353   000001 631400 60                 EPPR1   1
        59 013354   000000 701000 xent               TSX1    FINDD_6
        59 013355   000000 011000                    NOP     0

     2349     8844    2       RETURN;

   8844 59 013356   200062 221300                    LDX1  ! LNO+2,,AUTO
        59 013357   000001 702211                    TSX2  ! 1,X1

     2350     8845    2   END RESTORE_CURRENTS;
     2351     8846        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:393  
     2352     8847    1   ADD_LOCK:

   8847 59 013360   200062 741300       ADD_LOCK     STX1  ! LNO+2,,AUTO

     2353     8848    1       PROC(LKNAME, TYPE);
     2354     8849    2   DCL LKNAME CHAR (30);
     2355     8850    2   DCL TYPE UBIN (36);
     2356     8851    2   DCL LOCK_TYPE UBIN (6) UNAL;
     2357     8852    2       ALLOCATE_END = 1;

   8852 59 013361   000001 235007                    LDA     1,DL
        59 013362   000000 755000 31                 STA     ALLOCATE_END

     2358     8853    2       LOCK_TYPE = 1;

   8853 59 013363   010000 236003                    LDQ     4096,DU
        59 013364   200065 756100                    STQ     LOCK_TYPE,,AUTO

     2359     8854    2       CALL ZIG$HASH_IT(LKNAME,%ADD_ALT_HASH,ERROR_STATUS,0,0,

   8854 59 013365   200065 630500                    EPPR0   LOCK_TYPE,,AUTO
        59 013366   200101 450500                    STP0    KEY_MULT_REF+8,,AUTO
        59 013367   000523 236000 60                 LDQ     339
        59 013370   200100 756100                    STQ     KEY_MULT_REF+7,,AUTO
        59 013371   000524 237000 60                 LDAQ    340
        59 013372   200076 757100                    STAQ    KEY_MULT_REF+5,,AUTO
        59 013373   000452 237000 60                 LDAQ    298
        59 013374   200074 757100                    STAQ    KEY_MULT_REF+3,,AUTO
        59 013375   000010 236000 60                 LDQ     8
        59 013376   200063 235100                    LDA     @LKNAME,,AUTO
        59 013377   200072 757100                    STAQ    KEY_MULT_REF+1,,AUTO
        59 013400   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013401   000020 631400 60                 EPPR1   16
        59 013402   000000 701000 xent               TSX1    ZIG$HASH_IT
        59 013403   000000 011000                    NOP     0

     2360     8855    2          SIZEW(LK),LK$,LOCK_TYPE);
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:394  
     2361     8856    2       IF ERROR_STATUS = 0

   8856 59 013404   000000 235000 9                  LDA     ERROR_STATUS
        59 013405   013412 601000 59                 TNZ     s:8861

     2362     8857    3       THEN DO;

     2363     8858    3           LK.NEXT_LT$ = ADDR(NIL);

   8858 59 013406   000522 236000 60                 LDQ     338
        59 013407   000000 470400 2                  LDP0    LK$
        59 013410   000011 756100                    STQ     9,,PR0

     2364     8859    3           UWA.DA.NUMB_LK = UWA.DA.NUMB_LK + 1;

   8859 59 013411   000410 054000 57                 AOS     UWA+264

     2365     8860    3           END;

     2366     8861    2       CALL ZIG$G_DYN_MEM_6(SIZEW(LT), LT$);

   8861 59 013412   000526 630400 60                 EPPR0   342
        59 013413   000001 631400 60                 EPPR1   1
        59 013414   000000 701000 xent               TSX1    ZIG$G_DYN_MEM_6
        59 013415   000000 011000                    NOP     0

     2367     8862    2       UWA.DA.NUMB_LT = UWA.DA.NUMB_LT + 1;

   8862 59 013416   000412 054000 57                 AOS     UWA+266

     2368     8863    2       LT.NEXT_LT$ = LK.NEXT_LT$;

   8863 59 013417   000000 470400 2                  LDP0    LK$
        59 013420   000011 236100                    LDQ     9,,PR0
        59 013421   000000 471400 3                  LDP1    LT$
        59 013422   100000 756100                    STQ     0,,PR1

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:395  
     2369     8864    2       LK.NEXT_LT$ = LT$;

   8864 59 013423   000000 236000 3                  LDQ     LT$
        59 013424   000000 470400 2                  LDP0    LK$
        59 013425   000011 756100                    STQ     9,,PR0

     2370     8865    2       LT.TYPE = TYPE;

   8865 59 013426   200064 471500                    LDP1    @TYPE,,AUTO
        59 013427   000000 473400 3                  LDP3    LT$
        59 013430   100000 235100                    LDA     0,,PR1
        59 013431   300001 755100                    STA     1,,PR3

     2371     8866    2       LT.DBK_SN = LAST_LOCKABLE_DBK;

   8866 59 013432   000044 235000 0                  LDA     LAST_LOCKABLE_DBK
        59 013433   300002 755100                    STA     2,,PR3

     2372     8867    2       LT.LNO = LNO;

   8867 59 013434   200060 235100                    LDA     LNO,,AUTO
        59 013435   300004 755100                    STA     4,,PR3

     2373     8868    2       LT.LOCKS=0;

   8868 59 013436   300003 450100                    STZ     3,,PR3

     2374     8869    2       LT.LOCKS_BITS(%COPY_BIT) = OA_LKS.COPY;

   8869 59 013437   000042 236000 0                  LDQ     OA_LKS
        59 013440   000002 736000                    QLS     2
        59 013441   300003 676100                    ERQ     3,,PR3
        59 013442   400000 376003                    ANQ     -131072,DU
        59 013443   300003 656100                    ERSQ    3,,PR3

     2375     8870    2       LT.LOCKS_BITS(%DISPLAY_BIT) = OA_LKS.DISPLAY;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:396  
   8870 59 013444   000042 236000 0                  LDQ     OA_LKS
        59 013445   300003 676100                    ERQ     3,,PR3
        59 013446   200000 376003                    ANQ     65536,DU
        59 013447   300003 656100                    ERSQ    3,,PR3

     2376     8871    2       LT.LOCKS_BITS(%LOCKS_BIT) = OA_LKS.XLOCKS;

   8871 59 013450   000042 236000 0                  LDQ     OA_LKS
        59 013451   000002 772000                    QRL     2
        59 013452   300003 676100                    ERQ     3,,PR3
        59 013453   100000 376003                    ANQ     32768,DU
        59 013454   300003 656100                    ERSQ    3,,PR3

     2377     8872    2       LT.LOCKS_BITS(%ALTER_BIT) = OA_LKS.ALTER;

   8872 59 013455   000042 236000 0                  LDQ     OA_LKS
        59 013456   300003 676100                    ERQ     3,,PR3
        59 013457   040000 376003                    ANQ     16384,DU
        59 013460   300003 656100                    ERSQ    3,,PR3

     2378     8873    2       LT.LOCKS_BITS(%GET_BIT) = RC_LKS.FR_LKS.GET;

   8873 59 013461   000043 236000 0                  LDQ     RC_LKS
        59 013462   000005 772000                    QRL     5
        59 013463   300003 676100                    ERQ     3,,PR3
        59 013464   000400 376003                    ANQ     256,DU
        59 013465   300003 656100                    ERSQ    3,,PR3

     2379     8874    2       LT.LOCKS_BITS(%MODIFY_BIT) = RC_LKS.FR_LKS.MODIFY;

   8874 59 013466   000043 236000 0                  LDQ     RC_LKS
        59 013467   000007 772000                    QRL     7
        59 013470   300003 676100                    ERQ     3,,PR3
        59 013471   000200 376003                    ANQ     128,DU
        59 013472   300003 656100                    ERSQ    3,,PR3

     2380     8875    2       LT.LOCKS_BITS(%STORE_BIT) = RC_LKS.MISC.STORE;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:397  

   8875 59 013473   000043 236000 0                  LDQ     RC_LKS
        59 013474   000006 772000                    QRL     6
        59 013475   300003 676100                    ERQ     3,,PR3
        59 013476   000100 376003                    ANQ     64,DU
        59 013477   300003 656100                    ERSQ    3,,PR3

     2381     8876    2       LT.LOCKS_BITS(%DELETE_BIT) = RC_LKS.MISC.DELETE;

   8876 59 013500   000043 236000 0                  LDQ     RC_LKS
        59 013501   000006 772000                    QRL     6
        59 013502   300003 676100                    ERQ     3,,PR3
        59 013503   000040 376003                    ANQ     32,DU
        59 013504   300003 656100                    ERSQ    3,,PR3

     2382     8877    2       LT.LOCKS_BITS(%INSERT_BIT) = RC_LKS.SC_LKS.XINSERT;

   8877 59 013505   000043 236000 0                  LDQ     RC_LKS
        59 013506   000015 772000                    QRL     13
        59 013507   300003 676100                    ERQ     3,,PR3
        59 013510   000020 376003                    ANQ     16,DU
        59 013511   300003 656100                    ERSQ    3,,PR3

     2383     8878    2       LT.LOCKS_BITS(%REMOVE_BIT) = RC_LKS.SC_LKS.REMOVE;

   8878 59 013512   000043 236000 0                  LDQ     RC_LKS
        59 013513   000015 772000                    QRL     13
        59 013514   300003 676100                    ERQ     3,,PR3
        59 013515   000010 376003                    ANQ     8,DU
        59 013516   300003 656100                    ERSQ    3,,PR3

     2384     8879    2       LT.LOCKS_BITS(%FIND_BIT) = RC_LKS.SC_LKS.FIND;

   8879 59 013517   000043 236000 0                  LDQ     RC_LKS
        59 013520   000015 772000                    QRL     13
        59 013521   300003 676100                    ERQ     3,,PR3
        59 013522   000004 376003                    ANQ     4,DU
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:398  
        59 013523   300003 656100                    ERSQ    3,,PR3

     2385     8880    2       ALLOCATE_END = 0;

   8880 59 013524   000000 450000 31                 STZ     ALLOCATE_END

     2386     8881    2   END ADD_LOCK;

   8881 59 013525   200062 221300                    LDX1  ! LNO+2,,AUTO
        59 013526   000001 702211                    TSX2  ! 1,X1

     2387     8882        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:399  
     2388     8883    1   HYPH_TO_UNDR:

   8883 59 013527   200064 741300       HYPH_TO_UNDR STX1  ! @TYPE,,AUTO

     2389     8884    1       PROC;
     2390     8885    2       CALL INDEX(X,'-',WORD1);

   8885 59 013530   000000 124400                    SCM     mask='000'O
        59 013531   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 013532   000530 000001 60                 ADSC9   344                      cn=0,n=1
        59 013533   200054 000100                    ARG     X,,AUTO

     2391     8886    3       DO WHILE (X ~= LENGTHC(WORD1));

   8886 59 013534   013562 710000 59                 TRA     s:8900

     2392     8887    4           IF FIRST_HYPHEN THEN DO;

   8887 59 013535   000000 234000 13                 SZN     FIRST_HYPHEN
        59 013536   013552 605000 59                 TPL     s:8898

     2393     8888    4               FIRST_HYPHEN = '0'B;

   8888 59 013537   000000 450000 13                 STZ     FIRST_HYPHEN

     2394     8889    4               CALL ZIG$D_DIAG(LNO,%WARN_SEV,9480);

   8889 59 013540   000532 236000 60                 LDQ     346
        59 013541   200074 756100                    STQ     KEY_MULT_REF+3,,AUTO
        59 013542   000003 236000 60                 LDQ     3
        59 013543   200073 756100                    STQ     KEY_MULT_REF+2,,AUTO
        59 013544   200060 630500                    EPPR0   LNO,,AUTO
        59 013545   200072 450500                    STP0    KEY_MULT_REF+1,,AUTO
        59 013546   200072 630500                    EPPR0   KEY_MULT_REF+1,,AUTO
        59 013547   000005 631400 60                 EPPR1   5
        59 013550   000000 701000 xent               TSX1    ZIG$D_DIAG
        59 013551   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:400  

     2395     8890        /*E* ERROR: ZIG-9480-C
     2396     8891             MESSAGE: It appears that the character '-' is being used in the
     2397     8892                      formation of a name.  The schema syntax requires the ASCII
     2398     8893                      underscore (BCD left arrow) for this purpose.  The character
     2399     8894                      '-' is used only as a minus sign specifier.  All hyphens
     2400     8895                      will be replaced by underscores.
     2401     8896        */
     2402     8897    4               END;

     2403     8898    3           CALL INSERT(WORD1,X,1,'_');

   8898 59 013552   200054 235100                    LDA     X,,AUTO
        59 013553   040005 100400                    MLR     fill='040'O
        59 013554   000533 000001 60                 ADSC9   347                      cn=0,n=1
        59 013555   000020 000001 0                  ADSC9   WORD1,A                  cn=0,n=1

     2404     8899    3           CALL INDEX1(X,'-',WORD1);

   8899 59 013556   000000 124400                    SCM     mask='000'O
        59 013557   000020 000036 0                  ADSC9   WORD1                    cn=0,n=30
        59 013560   000530 000001 60                 ADSC9   344                      cn=0,n=1
        59 013561   200054 000100                    ARG     X,,AUTO

     2405     8900    3           END;

   8900 59 013562   200054 235100                    LDA     X,,AUTO
        59 013563   000036 115007                    CMPA    30,DL
        59 013564   013535 601000 59                 TNZ     s:8887

     2406     8901    2   END HYPH_TO_UNDR;

   8901 59 013565   200064 221300                    LDX1  ! @TYPE,,AUTO
        59 013566   000001 702211                    TSX2  ! 1,X1

RC
 Sect OctLoc
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:401  
   0     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

WORD1
 Sect OctLoc
   0     020   ****** ******   ****** ******   ****** ******   ****** ******    ................

OA_LKS
 Sect OctLoc
   0     042   00**** ******                                                    ....

RC_LKS
 Sect OctLoc
   0     043   000*** ******                                                    ....

LAST_RC_NAME
 Sect OctLoc
   0     050   ****** ******   ****** ******   ****** ******   ****** ******    ................

QFR_NAME
 Sect OctLoc
   0     061   ****** ******   ****** ******   ****** ******   ****** ******    ................

FIRST_SFR_DBK
 Sect OctLoc
   0     075   000000 000000                                                    ....

REC_ENTRY_DONE
 Sect OctLoc
   0     100   0***** ******                                                    ....

CURR_SETNAME
 Sect OctLoc
   0     104   ****** ******   ****** ******   ****** ******   ****** ******    ................

INDX_KEY_NM
 Sect OctLoc
   0     115   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:402  
   0     121   040040 040040   040040 040040   040040 040040   040040 ******                  ..

IMPLCT
 Sect OctLoc
   0     131   000000 000001                                                    ....

EXPLCT
 Sect OctLoc
   0     132   000000 000000                                                    ....

RELTYPE
 Sect OctLoc
   0     134   000000 000003   000000 000004   000000 000006   000000 000007    ................
   0     140   000000 000010   000000 000011   000000 000013   000000 000021    ................
   0     144   000000 000022   000000 000143                                    .......c

LINE
 Sect OctLoc
  11     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LAST_STATUS
 Sect OctLoc
  12     000   00**** ******                                                    ....

ANALS
 Sect OctLoc
  19     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

PURGE
 Sect OctLoc
  20     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DICTS
 Sect OctLoc
  21     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DISPS
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:403  
 Sect OctLoc
  22     000   ***00* ******   ****** ******   ****** ******   ****** ******    ................
  22     024*  ****** ******   ****** ******   ****** ******                    ............

VALIDS
 Sect OctLoc
  23     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOCKS
 Sect OctLoc
  24     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

STRAN
 Sect OctLoc
  25     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

DTRAN
 Sect OctLoc
  26     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSTRANS
 Sect OctLoc
  27     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

SSGEN
 Sect OctLoc
  28     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  36     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  38     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:404  
 Sect OctLoc
  39     000   007111 101137   ****** ******                                    .IA_....

SEARCHR_NB
 Sect OctLoc
  41     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  41     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  41     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  41     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  42     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  42     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  42     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  42     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  42     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  42     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  42     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  42     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  43     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  43     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  43     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  43     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  43     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  43     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  43     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  43     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  44     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  44     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  44     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:405  
  44     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  44     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  44     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  44     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  44     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

FIELD1
 Sect OctLoc
  56     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA
 Sect OctLoc
  57     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  57     004   040040 040040   040040 040040   040040 040040   040040 040040
  57     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  57     014   040040 040040   040040 040040   040040 040040   040040 040040
  57     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  57     024   040040 040040   040040 040040   040040 040040   040040 040040
  57     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  57     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  57     040   040040 040040   040040 040040   040040 040040   040040 040040
  57     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  57     050   040040 040040   040040 040040   040040 040040   040040 040040
  57     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  57     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  57     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  57     070   040040 040040   040040 040040   040040 040040   040040 040040
  57     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  57     104   040040 040040   040040 040040   040040 040040   040040 040040
  57     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  57     130   040040 040040   040040 040040   040040 040040   040040 040040
  57     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  57     140   040040 040040   040040 040040   040040 040040   040040 040040
  57     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  57     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     154   040040 040040   040040 040040   040040 040040   040040 040040
  57     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:406  
  57     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  57     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  57     174   040040 040040   040040 040040   040040 040040   040040 040040
  57     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  57     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  57     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  57     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  57     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  57     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  57     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  57     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  57     430   040040 040040   040040 040040   040040 040040   040040 040040
  57     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  57     440   040040 040040   040040 040040   040040 040040   040040 040040
  57     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  57     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  57     460   040040 040040   040040 040040   040040 040040   040040 040040
  57     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  57     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  57     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  57     504   040040 040040   040040 040040   040040 040040   040040 040040
  57     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  57     524   040040 040040   040040 040040   040040 040040   040040 040040
  57     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  57     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  57     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  57     614   040040 040040   040040 040040   040040 040040   040040 040040
  57     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  57     624   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:407  
  57     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  57     664   040040 040040   040040 040040   040040 040040   040040 040040
  57     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57     700   040040 040040   040040 040040   040040 040040   040040 040040
  57     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57     714   040040 040040   040040 040040   040040 040040   040040 040040
  57     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  57     724   040040 040040   040040 040040   040040 040040   040040 040040
  57     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57     744   040040 040040   040040 040040   040040 040040   040040 040040
  57     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57    1000   040040 040040   040040 040040   040040 040040   040040 040040
  57    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57    1040   040040 040040   040040 040040   040040 040040   040040 040040
  57    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57    1064   040040 040040   040040 040040   040040 040040   040040 040040
  57    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  57    1120   040040 040040   040040 040040   040040 040040   040040 040040
  57    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  57    1140   040040 040040   040040 040040   040040 040040   040040 040040
  57    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  57    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  57    1154   040040 040040   040040 040040   040040 040040   040040 040040
  57    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  57    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  57    1170   040040 040040   040040 040040   040040 040040   040040 040040
  57    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  57    1204   040040 040040   040040 040040   040040 040040   040040 040040
  57    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
  58     000   123116 040040   040040 040040   061052 040040   117101 040040    SN      1*  OA
  58     004   040040 040040   052104 102120   101122 101115   122103 040040        *DBPARAMRC
  58     010   040040 040040   052123 131123   124105 115040   052103 101114        *SYSTEM *CAL
  58     014   103040 040040   123103 040040   040040 040040   052103 101114    C   SC      *CAL
  58     020   103056 122103   123117 040040   040040 040040   122103 055123    C.RCSO      RC-S
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:408  
  58     024   117123 115040   123103 055123   117123 115040   123115 040040    OSM SC-SOSM SM
  58     030   040040 040040   123055 123040   040040 040040   040040 040040        S-S
  58     034   104125 120123   104125 120114   111103 101124   105123 040040    DUPSDUPLICATES
  58     040   106122 040040   040040 040040   123116 055123   105040 040040    FR      SN-SE
  58     044   103055 106040   040040 040040   123123 123115   055103 106040    C-F     SSSM-CF
  58     050   106122 055103   106123 040040   123115 123123   055103 106040    FR-CFS  SMSS-CF
  58     054   101122 105101   137111 104040   114117 103101   124111 117116    AREA_ID LOCATION
  58     060   120122 111126   101103 131040   113105 131040   101103 040040    PRIVACY KEY AC
  58     064   040040 040040   117101 055101   103040 040040   122101 040040        OA-AC   RA
  58     070   040040 040040   060065 060062   061060 060040   106117 125116        0502100 FOUN
  58     074   104040 040040   103055 106040   040040 040040   040040 040040    D   C-F
  58     100   116117 124040   122103 055106   122040 040040   060060 060060    NOT RC-FR   0000
  58     104   060060 060040   111123 040040   101123 103040   101123 103105    000 IS  ASC ASCE
  58     110   116104 111116   107040 040040   104105 123103   104105 123103    NDING   DESCDESC
  58     114   105116 104111   116107 040040   123105 124040   123105 114105    ENDING  SET SELE
  58     120   103124 111117   116040 040040   124110 105116   124110 122125    CTION   THENTHRU
  58     124   116122 040040   040040 040040   123106 040040   123106 040040    NR      SF  SF
  58     130   040040 040040   104101 040040   104101 040040   040040 040040        DA  DA
  58     134   123101 040040   123101 040040   040040 040040   127111 124110    SA  SA      WITH
  58     140   111116 040040   124131 120105   117127 116105   122040 040040    IN  TYPEOWNER
  58     144   120122 111117   122040 040040   117122 104105   122040 040040    PRIOR   ORDER
  58     150   122103 055122   101040 040040   101103 055122   101040 040040    RC-RA   AC-RA
  58     154   123116 055116   122103 117040   123116 055116   122127 125040    SN-NRCO SN-NRWU

(unnamed)
 Sect OctLoc
  60     000   000000 000000   000002 000000   000000 000001   000002 006000    ................
  60     004   000000 006000   000003 000000   000000 000002   000000 022403    ................
  60     010   000006 006000   000007 006000   000000 007651   000001 000000    ................
  60     014   000006 006000   000012 006000   000000 006000   000003 006000    ................
  60     020   000010 000000   000000 000050   000021 006000   000020 006000    .......(........
  60     024   000000 006000   000000 006000   000133 006000   000145 006000    .........[...e..
  60     030   000000 006000   000000 006000   000007 006000   000000 007657    ................
  60     034   000006 006000   000033 006000   000000 000012   000036 006000    ................
  60     040   000000 000024   000000 007665   000040 006000   000020 006000    ......... ......
  60     044   000006 006000   000041 006000   040040 040040   000000 007671    .....!..    ....
  60     050   000006 006000   000047 006000   000000 007672   000000 000011    .....'..........
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:409  
  60     054   000006 006000   000052 006000   000053 006000   000000 000013    .....*...+......
  60     060   000057 006000   000000 000036   000061 006000   000020 006000    ./.......1......
  60     064   000000 006000   000000 006000   000133 006000   000145 006000    .........[...e..
  60     070   000000 006000   000000 006000   000015 006000   000021 006000    ................
  60     074   000023 006000   000015 006000   000230 006000   000025 006000    ................
  60     100   000007 006000   000000 006000   000027 006000   000027 006000    ................
  60     104   000076 006000   000031 006000   000000 000062   000042 006000    .>.........2."..
  60     110   000132 006000   000000 006000   000133 006000   000137 006000    .Z.......[..._..
  60     114   000106 006000   000020 006000   000040 006000   000075 006000    .F....... ...=..
  60     120   000031 006000   000077 006000   000044 006000   000046 006000    .....?...$...&..
  60     124   000004 000000   000050 006000   000040 006000   000044 006000    .....(... ...$..
  60     130   000052 006000   000000 011310   000006 006000   000131 006000    .*...........Y..
  60     134   000132 006000   000000 006000   000000 000037   000000 010074    .Z.............<
  60     140   000136 006000   000020 006000   000006 006000   000137 006000    .^..........._..
  60     144   000063 006000   000065 006000   000067 006000   000000 000003    .3...5...7......
  60     150   000147 006000   000000 010017   000006 006000   000151 006000    .g...........i..
  60     154   000007 006000   000000 006000   000132 006000   000000 006000    .........Z......
  60     160   000133 006000   000136 006000   000000 010004   000000 010005    .[...^..........
  60     164   000006 006000   000162 006000   000006 006000   000163 006000    .....r.......s..
  60     170   000006 006000   000036 006000   000133 006000   000143 006000    .........[...c..
  60     174   000000 010072   000075 006000   000006 006000   000174 006000    ...:.=.......|..
  60     200   000007 006000   000000 006000   000133 006000   000144 006000    .........[...d..
  60     204   000061 006000   000000 011311   000002 006000   000205 006000    .1..............
  60     210   000000 010064   000000 007731   000006 006000   000210 006000    ...4............
  60     214   000015 006000   000036 006000   000027 006000   000036 006000    ................
  60     220   000006 006000   000211 006000   000000 007733   000000 007720    ................
  60     224   000006 006000   000222 006000   000000 006000   000000 006000    ................
  60     230   000006 006000   000223 006000   000000 006000   000044 006000    .............$..
  60     234   000101 006000   717777 777777   000000 007725   000000 010101    .A.............A
  60     240   000006 006000   000236 006000   000002 006000   000237 006000    ................
  60     244   000000 007724   000000 007732   000006 006000   000244 006000    ................
  60     250   000006 006000   000245 006000   777777 777741   000000 007726    ................
  60     254   000006 006000   000253 006000   000000 007730   000000 011340    ................
  60     260   000006 006000   000256 006000   000006 006000   000257 006000    ................
  60     264   000000 007747   077777 777777   000006 006000   000264 006000    ....?...........
  60     270   000133 006000   000140 006000   000000 011307   000000 010163    .[...`.........s
  60     274   000006 006000   000272 006000   000006 006000   000273 006000    ................
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:410  
  60     300   000000 007757   000000 011367   000002 006000   000300 006000    ................
  60     304   000006 006000   000301 006000   000021 006000   000074 006000    .............<..
  60     310   000133 006000   000141 006000   000000 007764   000000 007765    .[...a..........
  60     314   000006 006000   000312 006000   000006 006000   000313 006000    ................
  60     320   000027 006000   000102 006000   000133 006000   000134 006000    .....B...[...\..
  60     324   000000 011324   000000 011306   000006 006000   000324 006000    ................
  60     330   000006 006000   000325 006000   000000 011374   000000 011375    ................
  60     334   000006 006000   000332 006000   000006 006000   000333 006000    ................
  60     340   000000 011376   000000 011377   000006 006000   000340 006000    ................
  60     344   000006 006000   000341 006000   000000 011400   000000 011401    ................
  60     350   000006 006000   000346 006000   000006 006000   000347 006000    ................
  60     354   000133 006000   000135 006000   000000 006000   000073 006000    .[...].......;..
  60     360   000427 006000   000000 011312   000006 006000   000361 006000    ................
  60     364   000000 010033   000000 007770   000006 006000   000364 006000    ................
  60     370   000006 006000   000365 006000   000000 007727   000000 010056    ................
  60     374   000006 006000   000372 006000   000006 006000   000373 006000    ................
  60     400   000000 010055   000000 000005   000006 006000   000400 006000    ...-............
  60     404   000133 006000   000142 006000   000401 006000   000000 011334    .[...b..........
  60     410   000006 006000   000407 006000   000124 006000   000000 010462    .........T......
  60     414   000006 006000   000413 006000   000000 010463   000126 006000    .............V..
  60     420   000006 006000   000416 006000   000127 006000   000131 006000    .........W...Y..
  60     424   000132 006000   000134 006000   000135 006000   000000 010070    .Z...\...].....8
  60     430   000006 006000   000427 006000   000000 010067   000000 007646    ...........7....
  60     434   000006 006000   000432 006000   000006 006000   000433 006000    ................
  60     440   000000 010334   000000 007756   000006 006000   000440 006000    ................
  60     444   000006 006000   000441 006000   000015 006000   000072 006000    .............:..
  60     450   000020 006000   000002 006000   000000 006000   000000 006000    ................
  60     454   000000 006000   000053 006000   000045 006000   000000 006000    .....+...%......
  60     460   000000 022407   000000 022406   000006 006000   000460 006000    ................
  60     464   000006 006000   000461 006000   000150 006000   000152 006000    .........h...j..
  60     470   000000 011561   000000 010071   000006 006000   000470 006000    .......9........
  60     474   000000 006000   000352 006000   000133 006000   000000 006000    .........[......
  60     500   000106 006000   000427 006000   000425 006000   000006 006000    .F..............
  60     504   000471 006000   000154 006000   000156 006000   000000 010073    .....l...n.....;
  60     510   000006 006000   000507 006000   000127 006000   000006 006000    .........W......
  60     514   000003 006000   000063 006000   000132 006000   000064 006000    .....3...Z...4..
  60     520   000135 006000   000062 006000   000000 006014   000000 006000    .]...2..........
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:411  
  60     524   000000 006000   000036 006000   000401 006000   000000 006000    ................
  60     530   055040 040040   000000 022410   000531 006000   137040 040040    -   ........_
     2407     8902        %EJECT;
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:412  
     2408     8903    1   END ZIG$D_PSET;

PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:413  
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   ZIG_DDL_INCL.:ZIC0TOU  is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_DIR_STRUCS.:ZIC0TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIG$D_PSET.

   Procedure ZIG$D_PSET requires 6007 words for executable code.
   Procedure ZIG$D_PSET requires 66 words of local(AUTO) storage.

    No errors detected in file ZIG$D_PSET.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:414  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:415  
          MINI XREF LISTING

ABORT
      1103**DCL-ENT  8840--CALL
ADD_LOCK
      8848**PROC     6965--CALL     7374--CALL     7771--CALL     7935--CALL
ADD_SN
        27**DCL-ENT  6915--CALL     6922--CALL     6982--CALL     7022--CALL     7080--CALL     7089--CALL
      7134--CALL     7191--CALL     7201--CALL     7222--CALL     7232--CALL     7283--CALL     7393--CALL
      7469--CALL     7584--CALL     7803--CALL     7831--CALL     7962--CALL     8068--CALL     8231--CALL
      8341--CALL
AKC
      7462**LABEL    7500--GOTO
ALLOCATE_END
      1106**DCL      8852<<ASSIGN   8880<<ASSIGN
BLK.SUBLK$
      6800**DCL      8639>>ASSIGN   8639>>ASSIGN   8640>>ASSIGN
CHAR30
      1661**DCL      7057<<ASSIGN   7068<<ASSIGN   7267<<ASSIGN   8371<<ASSIGN   8377<<ASSIGN   8404<<ASSIGN
      8410<<ASSIGN   8438<<ASSIGN   8449<<ASSIGN   8457<<ASSIGN   8463<<ASSIGN   8472<<ASSIGN   8478<<ASSIGN
CHECK_RESW_DUPS
      8656**PROC     6895--CALL     6962--CALL     6981--CALL     7021--CALL     7371--CALL     7419--CALL
      7583--CALL     7768--CALL     7802--CALL     7932--CALL
CLAUSE_TYPE
        78**DCL      8540<<ASSIGN   8547<<ASSIGN   8555<<ASSIGN   8572<<ASSIGN   8576<<ASSIGN   8580<<ASSIGN
      8593<<ASSIGN
CLC
      7078**LABEL    7176--GOTO
CLEAN_UP_REC
      8699**PROC     6978--CALL     7002--CALL     7791--CALL     8486--CALL
CONNECT_6
      2733**DCL-ENT  7102--CALL     7118--CALL     7147--CALL     7153--CALL     7161--CALL     7235--CALL
      7303--CALL     7438--CALL     7455--CALL     7483--CALL     7619--CALL     7874--CALL     8024--CALL
      8092--CALL     8258--CALL     8518--CALL     8812--CALL     8819--CALL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:416  
CT1
       300**DCL      7224<<CALLBLT  7225<>CALL     7490<<CALLBLT  7491<>CALL     8101<<CALLBLT  8102<>CALL
      8234<<CALLBLT  8235<>CALL     8267<<CALLBLT  8268<>CALL     8766<<CALLBLT  8767<>CALL
CT2
       301**DCL      8237<<CALLBLT  8238<>CALL
CURR_CF_DBK
       204**DCL      8136<<ASSIGN   8195<>CALL     8201<<ASSIGN
CURR_SETNAME
       226**DCL      7801<<ASSIGN   8309>>IF
DBK_SFR IN PROCEDURE CLEAN_UP_REC
      8706**DCL      8753<<ASSIGN   8821<>CALL
DBK_SM_ALTKEY
       178**DCL      7391<<ASSIGN   7413<<ASSIGN   7441>>IF       7442<>CALL
DBK_SM_CALC
       194**DCL      7013<<ASSIGN   7104>>IF       7115<<ASSIGN   7117<>CALL     7158<>CALL     7183<>CALL
DBK_SO_CALC
      1696**DCL      7101<<ASSIGN   7121>>ASSIGN
DBK_SS_CALC
       195**DCL      7014<<ASSIGN   7124<<ASSIGN   7149<>CALL
DBK_STAR_CALC_RC
       190**DCL      7096<<ASSIGN
DBK_STAR_DBPARAM_RC
      1695**DCL      6920<<ASSIGN   7281<>CALL     7283<>CALL
DBK_STAR_SYSTEM_RC
       189**DCL      6925<<ASSIGN   7428<>CALL
DESC
       225**DCL      8215<<ASSIGN   8217<<ASSIGN   8256>>ASSIGN
DISCONNECT_6
      2734**DCL-ENT  8818--CALL
DO_PROCESS
       321**DCL      6854<<ASSIGN   6858<<ASSIGN   6860<<ASSIGN   6868<<ASSIGN   6869>>IF
DUP
      8059**LABEL    8107--GOTO
DYNMEM$
      1657**DCL      1662--IMP-PTR  7054<>CALL     7055>>ASSIGN   7056<<ASSIGN   7056>>ASSIGN   7057>>ASSIGN
      7061<>CALL     7062>>ASSIGN   7063<<ASSIGN   7063>>ASSIGN   7064>>ASSIGN   7065<<ASSIGN   7065>>ASSIGN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:417  
      7066>>ASSIGN   7067<<ASSIGN   7067>>ASSIGN   7068>>ASSIGN   7247<>CALL     7248>>ASSIGN   7249<<ASSIGN
      7249>>ASSIGN   7250>>ASSIGN   7251<<ASSIGN   7251>>ASSIGN   7252>>ASSIGN   7262<>CALL     7263>>ASSIGN
      7264<<ASSIGN   7264>>ASSIGN   7265>>ASSIGN   7266<<ASSIGN   7266>>ASSIGN   7267>>ASSIGN   8342<>CALL
      8343>>ASSIGN   8344<<ASSIGN   8344>>ASSIGN   8345>>ASSIGN   8346<<ASSIGN   8346>>ASSIGN   8347>>ASSIGN
      8348<<ASSIGN   8348>>ASSIGN   8349>>ASSIGN   8350<<ASSIGN   8350>>ASSIGN   8351>>ASSIGN   8354<>CALL
      8355>>ASSIGN   8366<>CALL     8367>>ASSIGN   8368<<ASSIGN   8368>>ASSIGN   8369>>ASSIGN   8370<<ASSIGN
      8370>>ASSIGN   8371>>ASSIGN   8374<>CALL     8375>>ASSIGN   8376<<ASSIGN   8376>>ASSIGN   8377>>ASSIGN
      8384<>CALL     8385>>ASSIGN   8386<<ASSIGN   8386>>ASSIGN   8387>>ASSIGN   8399<>CALL     8400>>ASSIGN
      8401<<ASSIGN   8401>>ASSIGN   8402>>ASSIGN   8403<<ASSIGN   8403>>ASSIGN   8404>>ASSIGN   8407<>CALL
      8408>>ASSIGN   8409<<ASSIGN   8409>>ASSIGN   8410>>ASSIGN   8423<>CALL     8424>>ASSIGN   8425<<ASSIGN
      8425>>ASSIGN   8426>>ASSIGN   8433<>CALL     8434>>ASSIGN   8435<<ASSIGN   8435>>ASSIGN   8436>>ASSIGN
      8437<<ASSIGN   8437>>ASSIGN   8438>>ASSIGN   8444<>CALL     8445>>ASSIGN   8446<<ASSIGN   8446>>ASSIGN
      8447>>ASSIGN   8448<<ASSIGN   8448>>ASSIGN   8449>>ASSIGN   8452<>CALL     8453>>ASSIGN   8454<<ASSIGN
      8454>>ASSIGN   8455>>ASSIGN   8456<<ASSIGN   8456>>ASSIGN   8457>>ASSIGN   8460<>CALL     8461>>ASSIGN
      8462<<ASSIGN   8462>>ASSIGN   8463>>ASSIGN   8467<>CALL     8468>>ASSIGN   8469<<ASSIGN   8469>>ASSIGN
      8470>>ASSIGN   8471<<ASSIGN   8471>>ASSIGN   8472>>ASSIGN   8475<>CALL     8476>>ASSIGN   8477<<ASSIGN
      8477>>ASSIGN   8478>>ASSIGN   8496<>CALL     8497>>ASSIGN   8596<>CALL     8597>>ASSIGN
DYNMEM_START$
      1658**DCL      6887<>CALL
END_DDL
       269**DCL      6873>>IF       6875>>IF       8495<<ASSIGN   8601>>IF
END_OF_KEYS
       203**DCL      8133<<ASSIGN   8150>>DOWHILE  8198<<ASSIGN   8208>>IF
EOS_RCFR IN PROCEDURE CLEAN_UP_REC
      8834**LABEL    8831--CALLALT
ERROR_STATUS
       265**DCL      8657<>CALL     8658>>DOCASE   8854<>CALL     8856>>IF
EXPLCT
      1671**DCL      7134<>CALL     7191<>CALL     7201<>CALL     7222<>CALL     7283<>CALL     7393<>CALL
      7469<>CALL     7831<>CALL     7962<>CALL     8068<>CALL     8231<>CALL     8341<>CALL
FCURR_R_6
      2725**DCL-ENT  7139--CALL     7415--CALL     7517--CALL     7521--CALL     7527--CALL     7613--CALL
      8440--CALL     8498--CALL     8503--CALL     8509--CALL     8511--CALL     8513--CALL
FETCHD_6
      2723**DCL-ENT  7183--CALL     7428--CALL     7518--CALL     7522--CALL     7528--CALL     7543--CALL
      8004--CALL     8236--CALL     8761--CALL     8821--CALL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:418  
FETCHNS_6
      2728**DCL-ENT  7309--CALL     7396--CALL     7397--CALL     7412--CALL     7603--CALL     7856--CALL
      7972--CALL     8078--CALL     8134--CALL     8142--CALL     8196--CALL     8206--CALL     8246--CALL
      8744--CALL     8775--CALL     8787--CALL     8789--CALL     8794--CALL     8817--CALL     8831--CALL
FETCHOS_6
      2732**DCL-ENT  8137--CALL     8160--CALL     8202--CALL     8719--CALL     8729--CALL     8816--CALL
FETCHPS_6
      2730**DCL-ENT  7979--CALL
FIELD1.COUNT1
      1703**DCL      8618<<ASSIGN   8620>>CALLBLT  8633<<ASSIGN   8640<<ASSIGN
FIELD1.TEXT1
      1704**DCL      8619<<ASSIGN   8634<<ASSIGN   8641<<ASSIGN
FINDD_6
      2724**DCL-ENT  7105--CALL     7107--CALL     7117--CALL     7138--CALL     7149--CALL     7158--CALL
      7239--CALL     7281--CALL     7320--CALL     7437--CALL     7442--CALL     7443--CALL     7454--CALL
      7608--CALL     7612--CALL     7624--CALL     7873--CALL     8001--CALL     8023--CALL     8050--CALL
      8087--CALL     8120--CALL     8195--CALL     8205--CALL     8254--CALL     8338--CALL     8550--CALL
      8583--CALL     8709--CALL     8804--CALL     8838--CALL     8841--CALL     8842--CALL     8843--CALL
FINDNS_6
      2727**DCL-ENT  7116--CALL     7238--CALL     7436--CALL     7453--CALL     7872--CALL     8022--CALL
      8717--CALL     8723--CALL     8728--CALL     8733--CALL     8734--CALL     8758--CALL     8792--CALL
FINDOS_6
      2731**DCL-ENT  7156--CALL     7623--CALL     7981--CALL     8002--CALL     8082--CALL     8253--CALL
      8504--CALL     8759--CALL     8786--CALL     8791--CALL     8793--CALL
FINDPS_6
      2729**DCL-ENT  7106--CALL     8003--CALL     8141--CALL
FIRST_HYPHEN
       287**DCL      8887>>IF       8888<<ASSIGN
FIRST_MEMBER
       223**DCL      7784<<ASSIGN   8132>>IF       8591<<ASSIGN
FIRST_SET_ERROR
       322**DCL      7846>>IF       7847<<ASSIGN   7966>>IF       7967<<ASSIGN
FIRST_SFR_DBK
       184**DCL      7012<<ASSIGN   7136>>IF       7138<>CALL     7325>>IF       7326<<ASSIGN   7476>>IF
      7477<<ASSIGN   7610>>IF       7612<>CALL
FLAG_ERROR
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:419  
       151**DCL      7953<<ASSIGN   7964<<ASSIGN   7984<<ASSIGN   7992<<ASSIGN   8000>>IF
FOUND
      1672**DCL      6915<>CALL     6922<>CALL     6982<>CALL     6983>>IF       7022<>CALL     7026>>IF
      7080<>CALL     7089<>CALL     7134<>CALL     7191<>CALL     7201<>CALL     7222<>CALL     7223>>IF
      7232<>CALL     7283<>CALL     7285>>IF       7293>>IF       7393<>CALL     7394>>IF       7463>>IF
      7469<>CALL     7584<>CALL     7596>>IF       7605>>IF       7721>>IF       7803<>CALL     7805>>IF
      7831<>CALL     7839>>IF       7865>>IF       7962<>CALL     7963>>IF       8068<>CALL     8070>>IF
      8231<>CALL     8233>>IF       8341<>CALL     8763<>CALL     8764>>IF
FR.FR_FRH IN PROCEDURE CLEAN_UP_REC
      8705**DCL      8781<<ASSIGN   8804<>CALL     8813<>CALL     8826>>ASSIGN
FR.FTYPE IN PROCEDURE CLEAN_UP_REC
      8701**DCL      8777<<ASSIGN   8795>>IF       8822>>ASSIGN
FR.F_SIGN IN PROCEDURE CLEAN_UP_REC
      8704**DCL      8780<<ASSIGN   8825>>ASSIGN
FR.PREC IN PROCEDURE CLEAN_UP_REC
      8702**DCL      8778<<ASSIGN   8795>>IF       8823>>ASSIGN
FR.SCALE IN PROCEDURE CLEAN_UP_REC
      8703**DCL      8779<<ASSIGN   8795>>IF       8824>>ASSIGN
GET_NUM
      8616**PROC     7549--CALL     7644--CALL     7672--CALL     7691--CALL     7710--CALL     7743--CALL
GET_WORD
      8630**PROC     6894--CALL     6961--CALL     6980--CALL     7020--CALL     7053--CALL     7060--CALL
      7165--CALL     7179--CALL     7190--CALL     7199--CALL     7213--CALL     7255--CALL     7282--CALL
      7370--CALL     7392--CALL     7487--CALL     7503--CALL     7582--CALL     7767--CALL     7800--CALL
      7830--CALL     7931--CALL     7961--CALL     8098--CALL     8110--CALL     8264--CALL     8276--CALL
      8308--CALL     8340--CALL     8365--CALL     8373--CALL     8393--CALL     8406--CALL     8412--CALL
      8432--CALL     8443--CALL     8451--CALL     8459--CALL     8466--CALL     8474--CALL
HOLD_DBK
       145**DCL      7146<<ASSIGN   7154<>CALL     7157<<ASSIGN   7162<>CALL     7434<<ASSIGN   7437<>CALL
      7450<<ASSIGN   7454<>CALL     7475<<ASSIGN   7484<>CALL     7622<<ASSIGN   7624<>CALL     8079<<ASSIGN
      8093<>CALL     8247<<ASSIGN   8259<>CALL
HYPH_TO_UNDR
      8884**PROC     8632--CALL
INDX_KEY_NM
       237**DCL      7015<<ASSIGN   7200<<ASSIGN   7400>>IF       7400>>IF       7421>>IF       7444>>IF
      7445<<ASSIGN   7507>>IF       7508<<ASSIGN   8521>>IF       8523>>IF       8530>>IF
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:420  
J
       281**DCL      8602<<ASSIGN   8603<>CALL
JUST_FIND_SN
        29**DCL-ENT  8763--CALL
KEY_MULT_REF IN PROCEDURE CLEAN_UP_REC
      8707**DCL      8755<<ASSIGN   8756<<ASSIGN   8785>>IF
LAST_LOCKABLE_DBK
       139**DCL      6908<<ASSIGN   7023<<ASSIGN   7585<<ASSIGN   7608<>CALL     7804<<ASSIGN   8866>>ASSIGN
LAST_RC$
       261**DCL      7193>>ASSIGN   7832>>IF       8008>>IF       8013>>IF       8014>>ASSIGN
LAST_RC_DBK
       158**DCL      7036<<ASSIGN   7064>>ASSIGN   7107<>CALL     7134<>CALL     7239<>CALL     7250>>ASSIGN
      7320<>CALL     7443<>CALL     7469<>CALL     7543<>CALL     7584<>CALL     7973<<ASSIGN   8004<>CALL
      8068<>CALL     8083>>IF       8231<>CALL     8550<>CALL     8709<>CALL     8763<>CALL
LAST_RC_NAME
       160**DCL      7025<<ASSIGN   7166>>IF       7488>>IF       7974<<ASSIGN   8099>>IF       8265>>IF
LAST_RC_SN
       159**DCL      7024<<ASSIGN
LAST_SC_DBK
       171**DCL      7816<<ASSIGN   7982>>IF       8028>>ASSIGN   8345>>ASSIGN   8583<>CALL
LAST_SC_SN
       172**DCL      7811<<ASSIGN   7832>>IF       8008>>IF       8013>>IF       8236<>CALL
LAST_SM_DBK
       224**DCL      8021<<ASSIGN   8023<>CALL     8050<>CALL     8087<>CALL     8120<>CALL     8254<>CALL
      8338<>CALL     8347>>ASSIGN
LAST_SO_DBK
       173**DCL      7871<<ASSIGN   7873<>CALL     8001<>CALL     8029>>ASSIGN
LAST_STATUS
       277**DCL      6888>>IF       6893<<ASSIGN   6958>>IF       6979<<ASSIGN   7019<<ASSIGN   7367>>IF
      7367>>IF       7387>>IF       7387>>IF       7390<<ASSIGN   7546>>IF       7546>>IF       7546>>IF
      7573>>IF       7573>>IF       7573>>IF       7581<<ASSIGN   7764>>IF       7799<<ASSIGN   7928>>IF
      7954>>IF       7954>>IF       7960<<ASSIGN   8657<>CALL
LEV_NUM
       241**DCL      7016<<ASSIGN   7550>>IF       7551<<ASSIGN   7553>>IF
LINE_COUNT
       199**DCL      6850>>ASSIGN   6888>>CALL     6897>>CALL     6933>>CALL     6942>>CALL     6947>>CALL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:421  
      6952>>CALL     6959>>CALL     6983>>CALL     7026>>CALL     7043>>CALL     7168>>CALL     7205>>CALL
      7226>>CALL     7275>>CALL     7286>>CALL     7312>>CALL     7333>>CALL     7338>>CALL     7343>>CALL
      7348>>CALL     7353>>CALL     7358>>CALL     7363>>CALL     7368>>CALL     7388>>CALL     7406>>CALL
      7492>>CALL     7511>>CALL     7555>>CALL     7562>>CALL     7577>>CALL     7597>>CALL     7640>>CALL
      7650>>CALL     7661>>CALL     7669>>CALL     7674>>CALL     7682>>CALL     7689>>CALL     7693>>CALL
      7707>>CALL     7712>>CALL     7722>>CALL     7733>>CALL     7740>>CALL     7745>>CALL     7755>>CALL
      7760>>CALL     7765>>CALL     7806>>CALL     7827>>CALL     7833>>CALL     7841>>CALL     7848>>CALL
      7859>>CALL     7880>>CALL     7885>>CALL     7914>>CALL     7919>>CALL     7924>>CALL     7929>>CALL
      7956>>CALL     7965>>CALL     7968>>CALL     7985>>CALL     7993>>CALL     8017>>CALL     8071>>CALL
      8084>>CALL     8103>>CALL     8123>>CALL     8144>>CALL     8153>>CALL     8154>>CALL     8162>>CALL
      8163>>CALL     8171>>CALL     8172>>CALL     8179>>CALL     8180>>CALL     8187>>CALL     8188>>CALL
      8210>>CALL     8239>>CALL     8249>>CALL     8269>>CALL     8281>>CALL     8290>>CALL     8295>>CALL
      8299>>CALL     8310>>CALL     8318>>CALL     8325>>CALL     8332>>CALL     8359>>CALL     8382>>CALL
      8391>>CALL     8421>>CALL     8430>>CALL     8487>>CALL     8491>>CALL     8524>>CALL     8532>>CALL
      8541>>CALL     8548>>CALL     8556>>CALL     8566>>CALL     8573>>CALL     8577>>CALL     8581>>CALL
      8589>>CALL     8594>>CALL     8670>>CALL     8681>>CALL     8737>>CALL     8749>>CALL     8798>>CALL
LINKED
        86**DCL      7951<<ASSIGN   8044<<ASSIGN   8317>>IF
LK
       109**DCL      8854--CALL
LK.NEXT_LT$
       115**DCL      8858<<ASSIGN   8863>>ASSIGN   8864<<ASSIGN
LK$
       108**DCL       109--IMP-PTR  8854<>CALL     8858>>ASSIGN   8863>>ASSIGN   8864>>ASSIGN
LKNAME IN PROCEDURE ADD_LOCK
      8849**DCL      8848--PROC     8854<>CALL
LNO
      1669**DCL      6850<<ASSIGN   6905>>ASSIGN   6982<>CALL     7022<>CALL     7066>>ASSIGN   7134<>CALL
      7191<>CALL     7201<>CALL     7222<>CALL     7232<>CALL     7252>>ASSIGN   7265>>ASSIGN   7283<>CALL
      7393<>CALL     7469<>CALL     7584<>CALL     7803<>CALL     7831<>CALL     7962<>CALL     8068<>CALL
      8231<>CALL     8341<>CALL     8351>>ASSIGN   8369>>ASSIGN   8387>>ASSIGN   8402>>ASSIGN   8426>>ASSIGN
      8436>>ASSIGN   8447>>ASSIGN   8455>>ASSIGN   8470>>ASSIGN   8763<>CALL     8867>>ASSIGN   8889<>CALL
LOCATION
        79**DCL      7017<<ASSIGN   7042>>IF       7049<<ASSIGN   8539>>IF
LOCK_TYPE IN PROCEDURE ADD_LOCK
      8851**DCL      8853<<ASSIGN   8854<>CALL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:422  
LT
       117**DCL      8861--CALL
LT.DBK_SN
       120**DCL      8866<<ASSIGN
LT.LNO
       123**DCL      8867<<ASSIGN
LT.LOCKS
       121**DCL       122--REDEF    8868<<ASSIGN
LT.LOCKS_BITS
       122**DCL      8869<<ASSIGN   8870<<ASSIGN   8871<<ASSIGN   8872<<ASSIGN   8873<<ASSIGN   8874<<ASSIGN
      8875<<ASSIGN   8876<<ASSIGN   8877<<ASSIGN   8878<<ASSIGN   8879<<ASSIGN
LT.NEXT_LT$
       118**DCL      8863<<ASSIGN
LT.TYPE
       119**DCL      8865<<ASSIGN
LT$
       116**DCL       117--IMP-PTR  8861<>CALL     8863>>ASSIGN   8864>>ASSIGN   8865>>ASSIGN   8866>>ASSIGN
      8867>>ASSIGN   8868>>ASSIGN   8869>>ASSIGN   8870>>ASSIGN   8871>>ASSIGN   8872>>ASSIGN   8873>>ASSIGN
      8874>>ASSIGN   8875>>ASSIGN   8876>>ASSIGN   8877>>ASSIGN   8878>>ASSIGN   8879>>ASSIGN
MODIFYMEM_6
      2739**DCL-ENT  7625--CALL
MODIFY_6
      2726**DCL-ENT  7185--CALL     7431--CALL     7520--CALL     7524--CALL     7530--CALL     7868--CALL
      7977--CALL     8052--CALL     8081--CALL     8121--CALL     8252--CALL     8339--CALL     8442--CALL
      8499--CALL     8510--CALL     8512--CALL     8514--CALL     8552--CALL     8563--CALL     8584--CALL
      8712--CALL     8722--CALL     8732--CALL     8784--CALL     8827--CALL
MOD_FR_OK
       246**DCL      7576<<ASSIGN   7580<<ASSIGN   8562>>IF
MOVE_TO_FIRST_POS
        30**DCL-ENT  7154--CALL     7162--CALL     7484--CALL     8093--CALL     8259--CALL     8813--CALL
NEED_LARGER_SCHEMA
       308**DCL      7003>>IF       7007<<ASSIGN   7537>>IF       7541<<ASSIGN   7792>>IF       7796<<ASSIGN
NEG_SCALE
       327**DCL      7572<<ASSIGN   7688<<ASSIGN   7699>>IF
NUM
        61**DCL      7551>>ASSIGN   7553>>IF       7561>>IF       7561>>IF       7566>>ASSIGN   7628>>ASSIGN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:423  
      7645>>ASSIGN   7647>>IF       7650>>IF       7656>>IF       7659>>IF       7673>>IF       7680>>ASSIGN
      7682>>IF       7689>>IF       7692>>IF       7692>>IF       7700<<ASSIGN   7700>>ASSIGN   7701>>ASSIGN
      7711>>IF       7711>>IF       7719>>ASSIGN   7744>>IF       7748>>ASSIGN   8620<<CALLBLT
NUM_AREAS_WITHIN
       228**DCL      7011<<ASSIGN   7208>>IF       7209>>IF       7220<<ASSIGN   7220>>ASSIGN   7274>>IF
OA_LKS
        92**DCL      6956<<ASSIGN   6963>>IF       6964<<ASSIGN
OA_LKS.ALTER
        96**DCL      6951>>IF       6954<<ASSIGN   8872>>ASSIGN
OA_LKS.COPY
        95**DCL      6946>>IF       6949<<ASSIGN   8869>>ASSIGN
OA_LKS.DISPLAY
        94**DCL      6941>>IF       6944<<ASSIGN   8870>>ASSIGN
OA_LKS.XLOCKS
        93**DCL      6932>>IF       6939<<ASSIGN   8871>>ASSIGN
ORDER
        84**DCL      7788<<ASSIGN   7884>>IF       7887<<ASSIGN   8579>>IF
OTHER_DDL_FLAG
       320**DCL      6853>>IF       6856<<ASSIGN   6865<<ASSIGN
OWNER
        82**DCL      7786<<ASSIGN   7826>>IF       7829<<ASSIGN   8571>>IF
OWNER_CLAUSE_FOUND
       252**DCL      7789<<ASSIGN   7825<<ASSIGN   7949>>IF
PARAN
      6699**DCL        22--PROC     8603<>CALL
PARAN.CODE
      6720**DCL      6857>>IF       6857>>IF       6864>>IF       6877>>DOCASE   8602>>ASSIGN
PARAN.OUT$
      6729**DCL      8617>>ASSIGN   8617>>ASSIGN   8618>>ASSIGN   8631>>ASSIGN   8631>>ASSIGN   8633>>ASSIGN
      8639>>ASSIGN   8639>>ASSIGN   8640>>ASSIGN
PARAN.REJECT
      6711**DCL      7129<<ASSIGN   7217<<ASSIGN   7259<<ASSIGN   8065<<ASSIGN   8228<<ASSIGN   8396<<ASSIGN
      8415<<ASSIGN
PARAN.TYPE
      6700**DCL      6851>>IF       6871>>DOCASE
PERM
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:424  
        87**DCL      7785<<ASSIGN   7889<<ASSIGN   8565>>IF
PREV_CF_DBK
       205**DCL      8151<<ASSIGN   8205<>CALL
PRIOR
        83**DCL      7787<<ASSIGN   7879>>IF       7882<<ASSIGN   8575>>IF
PTR$
       140**DCL      8657<>CALL
QFR_NAME
       166**DCL      7126>>ASSIGN   7180<<ASSIGN   7468>>ASSIGN   7490>>CALLBLT  7491<>CALL     7504<<ASSIGN
      8059>>ASSIGN   8101>>CALLBLT  8102<>CALL     8111<<ASSIGN   8224>>ASSIGN   8267>>CALLBLT  8268<>CALL
      8277<<ASSIGN
RC
        39**DCL      7030<<ASSIGN   8551>>ASSIGN   8711>>ASSIGN
RC.ANY_IND
        48**DCL      7033<<ASSIGN   7245<<ASSIGN   7274>>IF
RC.CALCDUP
        47**DCL      7182<<ASSIGN
RC.FIXVAR
        42**DCL      7730<<ASSIGN   7730>>ASSIGN
RC.KEY_PRESENT
        49**DCL      7448<<ASSIGN
RC.NUM_SOSM
        53**DCL      7114<<ASSIGN   7114>>ASSIGN   7451<<ASSIGN   7451>>ASSIGN
RC.PSMODE
        41**DCL      7031<<ASSIGN   7059<<ASSIGN   7132<<ASSIGN   7194<<ASSIGN   7202<<ASSIGN
RC.SLACK
        55**DCL      7133<<ASSIGN   7133>>ASSIGN   7142>>ASSIGN
RC.WITHINA
        43**DCL      7032<<ASSIGN   7208<<ASSIGN   7209<<ASSIGN   7246<<ASSIGN
RC_LKS
        97**DCL      7040<<ASSIGN   7372>>IF       7373<<ASSIGN
RC_LKS.FR_LKS
       102**DCL      7631<<ASSIGN   7769>>IF       7770<<ASSIGN
RC_LKS.FR_LKS.GET
       104**DCL      7352>>IF       7355<<ASSIGN   7754>>IF       7757<<ASSIGN   8873>>ASSIGN
RC_LKS.FR_LKS.MODIFY
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:425  
       103**DCL      7357>>IF       7360<<ASSIGN   7759>>IF       7762<<ASSIGN   8874>>ASSIGN
RC_LKS.MISC.DELETE
       107**DCL      7347>>IF       7350<<ASSIGN   8876>>ASSIGN
RC_LKS.MISC.STORE
       106**DCL      7342>>IF       7345<<ASSIGN   8875>>ASSIGN
RC_LKS.SC_LKS
        98**DCL      7819<<ASSIGN   7933>>IF       7934<<ASSIGN
RC_LKS.SC_LKS.FIND
       101**DCL      7362>>IF       7365<<ASSIGN   7923>>IF       7926<<ASSIGN   8879>>ASSIGN
RC_LKS.SC_LKS.REMOVE
       100**DCL      7337>>IF       7340<<ASSIGN   7918>>IF       7921<<ASSIGN   8878>>ASSIGN
RC_LKS.SC_LKS.XINSERT
        99**DCL      7332>>IF       7335<<ASSIGN   7913>>IF       7916<<ASSIGN   8877>>ASSIGN
REC_ENTRY_DONE
       219**DCL      6977>>IF       7001>>IF       7010<<ASSIGN   7790>>IF       8485>>IF       8708<<ASSIGN
RELTYPE.DUP
      1678**DCL      8068<>CALL
RELTYPE.FLD_IN_KEY
      1686**DCL      7469<>CALL
RELTYPE.INAREA
      1680**DCL      7283<>CALL
RELTYPE.KEY_IN_REC
      1685**DCL      7393<>CALL
RELTYPE.LOC
      1681**DCL      7134<>CALL     7191<>CALL     7201<>CALL     7222<>CALL
RELTYPE.NO_NR
      1687**DCL      6915<>CALL     6922<>CALL     6982<>CALL     7022<>CALL     7080<>CALL     7089<>CALL
      7232<>CALL     7584<>CALL     7803<>CALL
RELTYPE.SEQ
      1679**DCL      8231<>CALL
RELTYPE.SM
      1683**DCL      7962<>CALL
RELTYPE.SO
      1682**DCL      7831<>CALL
RELTYPE.SS
      1684**DCL      8341<>CALL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:426  
RESTORE_CURRENTS
      8837**PROC     7008--CALL     7542--CALL     7797--CALL
SELECTION
        88**DCL      7952<<ASSIGN   8298>>IF       8301<<ASSIGN   8592>>IF
SET_ERROR
       319**DCL      6851>>IF       6861<<ASSIGN   7840<<ASSIGN
SET_FIELDS
      1098**DCL-ENT  7225--CALL     7491--CALL     8102--CALL     8235--CALL     8238--CALL     8268--CALL
      8767--CALL
SF_CLOSE
       306**DCL-ENT  7005--CALL     7539--CALL     7794--CALL
SF_OPEN
       307**DCL-ENT  7006--CALL     7540--CALL     7795--CALL
SKC
      8224**LABEL    8273--GOTO
SORTKEY
        85**DCL      8119<<ASSIGN   8586>>IF
STATUS
       309**DCL      7005<>CALL     7006<>CALL     7539<>CALL     7540<>CALL     7794<>CALL     7795<>CALL
STRAN.SNAME
      1058**DCL      6896>>IF
STRE_6
      2720**DCL-ENT  6907--CALL     6912--CALL     6919--CALL     6924--CALL     7034--CALL     7085--CALL
      7095--CALL     7099--CALL     7112--CALL     7122--CALL     7145--CALL     7152--CALL     7159--CALL
      7233--CALL     7240--CALL     7302--CALL     7324--CALL     7426--CALL     7433--CALL     7449--CALL
      7474--CALL     7481--CALL     7617--CALL     7815--CALL     7870--CALL     8020--CALL     8030--CALL
      8090--CALL     8257--CALL     8517--CALL     8810--CALL
SUBSCHEMA_KEY
      1130**DCL      1131--REDEF
SYM.COUNT
      6836**DCL      6839--IMP-SIZ  8617>>ASSIGN   8618>>ASSIGN   8631>>ASSIGN   8633>>ASSIGN   8639>>ASSIGN
      8640>>ASSIGN
SYM.TEXT
      6839**DCL      8617>>ASSIGN   8631>>ASSIGN   8639>>ASSIGN
SYNTAX_ERR
       282**DCL      6873>>UNWIND   6875>>UNWIND   7950>>UNWIND   7957>>UNWIND   8601>>UNWIND   8604>>UNWIND
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:427  
TABLES.DBK_RC
      1632**DCL      7193<<ASSIGN   7832>>IF       8008>>IF       8013>>IF       8014<<ASSIGN
TCF
       206**DCL      8135<<ASSIGN   8152>>IF       8200<<ASSIGN
TFR
       208**DCL      8138<<ASSIGN   8203<<ASSIGN
TFR.FTYPE
       210**DCL      8161>>IF
TFR.F_SIGN
       213**DCL      8186>>IF
TFR.PREC
       211**DCL      8170>>IF
TFR.SCALE
       212**DCL      8178>>IF
TYPE
        81**DCL      7571<<ASSIGN   7639>>IF       7642<<ASSIGN   7668>>IF       7671<<ASSIGN   7706>>IF
      7709<<ASSIGN   7732>>IF       7735<<ASSIGN   7739>>IF       7742<<ASSIGN   8554>>IF
TYPE IN PROCEDURE ADD_LOCK
      8850**DCL      8848--PROC     8865>>ASSIGN
UWA.AC
      2449**DCL      6988<<ASSIGN   7231<<ASSIGN
UWA.AC.CALC_NEXT
      2489**DCL      2490--REDEF
UWA.AC.CALC_PRIOR
      2498**DCL      2499--REDEF
UWA.AC.DEFAULTS
      2450**DCL      2451--REDEF
UWA.AC.FILE_CODE
      2455**DCL      2456--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      2452**DCL      2453--REDEF
UWA.AC.PAGE_TYP
      2467**DCL      8731<<ASSIGN
UWA.AC.PERMTYPE
      2466**DCL      6990<<ASSIGN
UWA.AC.PRIME_KEY
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:428  
      2464**DCL      8721<<ASSIGN   8730<<ASSIGN
UWA.AC.SEC_KEY
      2465**DCL      8720<<ASSIGN
UWA.C_F
      2583**DCL      7150<<ASSIGN   7478<<ASSIGN   8088<<ASSIGN   8135>>ASSIGN   8152>>IF       8200>>ASSIGN
      8255<<ASSIGN   8807<<ASSIGN
UWA.C_F.CTRLSEQ
      2587**DCL      8256<<ASSIGN
UWA.C_F.CTRLTYPE
      2585**DCL      7151<<ASSIGN   7480<<ASSIGN   8089<<ASSIGN   8809<<ASSIGN
UWA.C_F.SYN
      2584**DCL      7479<<ASSIGN   8808<<ASSIGN
UWA.DA.FRST_FR
      2601**DCL      8502>>IF       8507>>IF       8507<<ASSIGN
UWA.DA.FRST_KC
      2600**DCL      8502>>IF       8506>>IF       8506<<ASSIGN
UWA.DA.FRST_RC
      2598**DCL      6916<<ASSIGN   7090<<ASSIGN
UWA.DA.FRST_SC
      2599**DCL      8502>>IF       8505>>IF       8505<<ASSIGN
UWA.DA.NUMB_LK
      2592**DCL      8859<<ASSIGN   8859>>ASSIGN
UWA.DA.NUMB_LT
      2594**DCL      8862<<ASSIGN   8862>>ASSIGN
UWA.DA.NUMB_SN
      2590**DCL      6909<<ASSIGN
UWA.DB_STATUS
      2381**DCL      7398>>DOWHILE  7605>>IF       7980>>IF       8143>>IF       8150>>DOWHILE  8197>>IF
      8208>>IF       8718>>DOWHILE  8735>>IF       8745>>DOWHILE  8839>>IF
UWA.DIRECT_REF
      2390**DCL      6908>>ASSIGN   6913>>ASSIGN   6916>>ASSIGN   6920>>ASSIGN   6925>>ASSIGN   7023>>ASSIGN
      7024>>ASSIGN   7036>>ASSIGN   7086>>ASSIGN   7090>>ASSIGN   7096>>ASSIGN   7101>>ASSIGN   7115>>ASSIGN
      7124>>ASSIGN   7146>>ASSIGN   7157>>ASSIGN   7193>>ASSIGN   7319>>ASSIGN   7326>>ASSIGN   7413>>ASSIGN
      7434>>ASSIGN   7450>>ASSIGN   7471>>ASSIGN   7475>>ASSIGN   7477>>ASSIGN   7518<>CALL     7522<>CALL
      7528<>CALL     7585>>ASSIGN   7622>>ASSIGN   7804>>ASSIGN   7811>>ASSIGN   7816>>ASSIGN   7871>>ASSIGN
      7973>>ASSIGN   7982>>IF       8021>>ASSIGN   8079>>ASSIGN   8083>>IF       8136>>ASSIGN   8151>>ASSIGN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:429  
      8201>>ASSIGN   8247>>ASSIGN   8349>>ASSIGN   8505>>ASSIGN   8506>>ASSIGN   8507>>ASSIGN   8753>>ASSIGN
      8781>>ASSIGN
UWA.FR
      2543**DCL      7141<<ASSIGN   7295<<ASSIGN   7462<<ASSIGN   7570<<ASSIGN   7615<<ASSIGN   8138>>ASSIGN
      8203>>ASSIGN
UWA.FR.BEIST
      2558**DCL      7301<<ASSIGN   7305<<ASSIGN
UWA.FR.DERIVED
      2557**DCL      7142<<ASSIGN
UWA.FR.FR_FRH
      2560**DCL      7319<<ASSIGN   7471<<ASSIGN   8761<>CALL     8826<<ASSIGN
UWA.FR.FTYPE
      2546**DCL      7300<<ASSIGN   7310>>IF       7616<<ASSIGN   7633<<ASSIGN   7635<<ASSIGN   7638>>IF
      7638<<ASSIGN   7646>>IF       7648<<ASSIGN   7657<<ASSIGN   7679<<ASSIGN   7703<<ASSIGN   7718<<ASSIGN
      7729<<ASSIGN   7736<<ASSIGN   7747<<ASSIGN   8161>>IF       8248>>IF       8777>>ASSIGN   8795>>IF
      8822<<ASSIGN
UWA.FR.F_OCCURS
      2555**DCL      7143<<ASSIGN   7627<<ASSIGN   8748>>IF
UWA.FR.F_SIGN
      2549**DCL      7299<<ASSIGN   7704<<ASSIGN   8186>>IF       8780>>ASSIGN   8825<<ASSIGN
UWA.FR.F_USE
      2553**DCL      7297<<ASSIGN   7322<<ASSIGN   7467<<ASSIGN   8751>>DOCASE
UWA.FR.LEVEL
      2556**DCL      7566<<ASSIGN   7628<<ASSIGN
UWA.FR.PREC
      2547**DCL      7298<<ASSIGN   7310>>IF       7637<<ASSIGN   7645<<ASSIGN   7660<<ASSIGN   7680<<ASSIGN
      7719<<ASSIGN   7737<<ASSIGN   7748<<ASSIGN   8170>>IF       8778>>ASSIGN   8795>>IF       8823<<ASSIGN
UWA.FR.REF
      2545**DCL      7144<<ASSIGN   7296<<ASSIGN   7323<<ASSIGN   7466<<ASSIGN   8080<<ASSIGN   8251<<ASSIGN
      8783<<ASSIGN
UWA.FR.RPT
      2554**DCL      7464<<ASSIGN   7510>>IF       8754>>IF
UWA.FR.SCALE
      2548**DCL      7701<<ASSIGN   8178>>IF       8779>>ASSIGN   8795>>IF       8824<<ASSIGN
UWA.FR.SYN
      2544**DCL      7321<<ASSIGN   7465<<ASSIGN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:430  
UWA.NR.LNO
      2619**DCL      8441<<ASSIGN   8441>>ASSIGN
UWA.NR.RELTYPE
      2618**DCL      8788>>DOWHILE
UWA.OA
      2435**DCL      6910<<ASSIGN
UWA.OA.FILE_CODE
      2447**DCL      6911<<ASSIGN
UWA.OA.NUMB_AC
      2436**DCL      7236<<ASSIGN   7236>>ASSIGN   8487>>IF       8519<<ASSIGN   8519>>ASSIGN
UWA.OA.NUMB_CF
      2444**DCL      7160<<ASSIGN   7160>>ASSIGN   7482<<ASSIGN   7482>>ASSIGN   8091<<ASSIGN   8091>>ASSIGN
      8261<<ASSIGN   8261>>ASSIGN   8811<<ASSIGN   8811>>ASSIGN
UWA.OA.NUMB_FR
      2440**DCL      7148<<ASSIGN   7148>>ASSIGN   7304<<ASSIGN   7304>>ASSIGN   7618<<ASSIGN   7618>>ASSIGN
UWA.OA.NUMB_RA
      2439**DCL      7241<<ASSIGN   7241>>ASSIGN
UWA.OA.NUMB_RC
      2437**DCL      6926<<ASSIGN   6926>>ASSIGN   7035<<ASSIGN   7035>>ASSIGN   7097<<ASSIGN   7097>>ASSIGN
      8491>>IF
UWA.OA.NUMB_SC
      2438**DCL      7087<<ASSIGN   7087>>ASSIGN   7427<<ASSIGN   7427>>ASSIGN   7817<<ASSIGN   7817>>ASSIGN
UWA.OA.NUMB_SM
      2442**DCL      7113<<ASSIGN   7113>>ASSIGN   7452<<ASSIGN   7452>>ASSIGN   8025<<ASSIGN   8025>>ASSIGN
UWA.OA.NUMB_SO
      2441**DCL      7100<<ASSIGN   7100>>ASSIGN   7435<<ASSIGN   7435>>ASSIGN   7875<<ASSIGN   7875>>ASSIGN
UWA.OA.NUMB_SS
      2443**DCL      7123<<ASSIGN   7123>>ASSIGN   8031<<ASSIGN   8031>>ASSIGN
UWA.OA.OA_CALC
      2448**DCL      7078>>IF       7086<<ASSIGN   7105<>CALL     7120>>ASSIGN
UWA.RA
      2538**DCL      7221<<ASSIGN
UWA.RC
      2507**DCL      6917<<ASSIGN   7091<<ASSIGN   8551<<ASSIGN   8711<<ASSIGN
UWA.RC.ANY_IND
      2516**DCL      8715>>IF       8726>>IF
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:431  
UWA.RC.KEY_PRESENT
      2517**DCL      8715>>IF
UWA.RC.NUM_SOSM
      2521**DCL      7094<<ASSIGN   7430<<ASSIGN   7430>>ASSIGN   7866<<ASSIGN   7866>>ASSIGN   7975<<ASSIGN
      7975>>ASSIGN
UWA.RC.PSMODE
      2509**DCL      7857>>IF       8008>>IF       8015>>IF       8721>>IF       8726>>IF
UWA.RC.RTYPE
      2508**DCL      6918<<ASSIGN   6923<<ASSIGN   7092<<ASSIGN
UWA.RC.SM
      2513**DCL      7976<<ASSIGN
UWA.RC.SO
      2512**DCL      7093<<ASSIGN   7429<<ASSIGN   7867<<ASSIGN
UWA.RECORD_NAME
      2387**DCL      7400>>IF       7983>>IF
UWA.SC
      2524**DCL      7081<<ASSIGN   7420<<ASSIGN   7812<<ASSIGN
UWA.SC.PTRNO
      2530**DCL      7083<<ASSIGN   7425<<ASSIGN   7813<<ASSIGN
UWA.SC.SEQDUP
      2533**DCL      7084<<ASSIGN   7424<<ASSIGN   7509>>IF       7519<<ASSIGN   7814<<ASSIGN   7903<<ASSIGN
      7905<<ASSIGN   7907<<ASSIGN   8019>>ASSIGN
UWA.SC.SETORD
      2527**DCL      7891<<ASSIGN   7893<<ASSIGN   7895<<ASSIGN   7897<<ASSIGN   7899<<ASSIGN   7901<<ASSIGN
      8122>>IF       8122>>IF       8129>>IF       8280>>IF       8289>>IF       8294>>IF       8586>>IF
      8586>>IF
UWA.SC.SETTYPE
      2525**DCL      7082<<ASSIGN   7422<<ASSIGN   7423<<ASSIGN
UWA.SF.DBKEY_DA
      2400**DCL      8842<>CALL
UWA.SF.DBKEY_OA
      2399**DCL      6913<<ASSIGN   8841<>CALL
UWA.SF.DBKEY_SA
      2398**DCL      8843<>CALL
UWA.SM
      2565**DCL      7108<<ASSIGN   7386<<ASSIGN   7416<<ASSIGN   8005<<ASSIGN
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:432  
UWA.SM.CALCDUP
      2570**DCL      7184<<ASSIGN
UWA.SM.INSTYPE
      2566**DCL      8006<<ASSIGN   8036<<ASSIGN   8038<<ASSIGN   8324>>IF       8357>>IF       8380>>IF
      8389>>IF       8419>>IF       8428>>IF
UWA.SM.MEMDUP
      2568**DCL      8051<<ASSIGN
UWA.SM.PSEQ
      2573**DCL      7110<<ASSIGN
UWA.SM.PSMODE
      2572**DCL      7109<<ASSIGN   7400>>IF       7400>>IF       7446<<ASSIGN   8011<<ASSIGN
UWA.SM.RETTYPE
      2567**DCL      8007<<ASSIGN   8040<<ASSIGN   8042<<ASSIGN   8331>>IF       8357>>IF       8380>>IF
      8389>>IF       8419>>IF       8428>>IF
UWA.SM.SEQDUP
      2569**DCL      7111<<ASSIGN   7440<<ASSIGN   7523<<ASSIGN   7529<<ASSIGN   8019<<ASSIGN   8279<<ASSIGN
      8288<<ASSIGN   8293<<ASSIGN
UWA.SN
      2602**DCL      6902<<ASSIGN
UWA.SN.DCLR
      2603**DCL      6903<<ASSIGN   8764>>IF
UWA.SN.LNO
      2606**DCL      6905<<ASSIGN   8768<>CALL
UWA.SN.SENAME
      2608**DCL      6906<<ASSIGN   8237>>CALLBLT  8238<>CALL     8763<>CALL     8766>>CALLBLT  8767<>CALL
UWA.SN.SETYPE
      2605**DCL      6904<<ASSIGN
UWA.SO
      2561**DCL      7098<<ASSIGN   7432<<ASSIGN   7869<<ASSIGN
UWA.S_S
      2578**DCL      7119<<ASSIGN   8026<<ASSIGN
UWA.S_S.SC_SSH
      2580**DCL      7120<<ASSIGN   8028<<ASSIGN
UWA.S_S.SOSM_SSH
      2581**DCL      7121<<ASSIGN   8029<<ASSIGN
UWA.S_S.STYP
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:433  
      2579**DCL      8027<<ASSIGN
WITHIN
        80**DCL      7018<<ASSIGN   7204>>IF       7207<<ASSIGN   8546>>IF
WORD1
        67**DCL      6896>>IF       6906>>ASSIGN   6914<<ASSIGN   6915<>CALL     6921<<ASSIGN   6922<>CALL
      6965<>CALL     6982<>CALL     7022<>CALL     7025>>ASSIGN   7057>>ASSIGN   7068>>ASSIGN   7079<<ASSIGN
      7080<>CALL     7088<<ASSIGN   7089<>CALL     7126<<ASSIGN   7127>>IF       7127>>IF       7134<>CALL
      7166>>IF       7180>>ASSIGN   7191<>CALL     7200>>ASSIGN   7201<>CALL     7214>>IF       7214>>IF
      7214>>IF       7214>>IF       7222<>CALL     7224>>CALLBLT  7225<>CALL     7232<>CALL     7256>>IF
      7256>>IF       7256>>IF       7256>>IF       7267>>ASSIGN   7283<>CALL     7374<>CALL     7393<>CALL
      7400>>IF       7400>>IF       7421>>IF       7444>>IF       7468<<ASSIGN   7469<>CALL     7488>>IF
      7504>>ASSIGN   7584<>CALL     7771<>CALL     7801>>ASSIGN   7803<>CALL     7831<>CALL     7935<>CALL
      7962<>CALL     7974>>ASSIGN   8059<<ASSIGN   8060>>IF       8060>>IF       8060>>IF       8060>>IF
      8060>>IF       8060>>IF       8060>>IF       8060>>IF       8068<>CALL     8099>>IF       8111>>ASSIGN
      8224<<ASSIGN   8225>>IF       8225>>IF       8225>>IF       8225>>IF       8231<>CALL     8234>>CALLBLT
      8235<>CALL     8265>>IF       8277>>ASSIGN   8309>>IF       8341<>CALL     8371>>ASSIGN   8377>>ASSIGN
      8394>>IF       8394>>IF       8404>>ASSIGN   8410>>ASSIGN   8413>>IF       8413>>IF       8438>>ASSIGN
      8449>>ASSIGN   8457>>ASSIGN   8463>>ASSIGN   8472>>ASSIGN   8478>>ASSIGN   8617<<ASSIGN   8619>>ASSIGN
      8620>>CALLBLT  8631<<ASSIGN   8634>>ASSIGN   8639<<ASSIGN   8641>>ASSIGN   8657<>CALL     8664<<ASSIGN
      8885>>CALLBLT  8886--DOWHILE  8898<<CALLBLT  8899>>CALLBLT
WRD1
      1660**DCL      7055<<ASSIGN   7062<<ASSIGN   7064<<ASSIGN   7066<<ASSIGN   7248<<ASSIGN   7250<<ASSIGN
      7252<<ASSIGN   7263<<ASSIGN   7265<<ASSIGN   8343<<ASSIGN   8345<<ASSIGN   8347<<ASSIGN   8349<<ASSIGN
      8351<<ASSIGN   8355<<ASSIGN   8367<<ASSIGN   8369<<ASSIGN   8375<<ASSIGN   8385<<ASSIGN   8387<<ASSIGN
      8400<<ASSIGN   8402<<ASSIGN   8408<<ASSIGN   8424<<ASSIGN   8426<<ASSIGN   8434<<ASSIGN   8436<<ASSIGN
      8445<<ASSIGN   8447<<ASSIGN   8453<<ASSIGN   8455<<ASSIGN   8461<<ASSIGN   8468<<ASSIGN   8470<<ASSIGN
      8476<<ASSIGN   8497<<ASSIGN   8597<<ASSIGN
X
       313**DCL      8885<<CALLBLT  8886>>DOWHILE  8898>>CALLBLT  8899<<CALLBLT
ZIG$D_DIAG
        28**DCL-ENT  6888--CALL     6897--CALL     6933--CALL     6942--CALL     6947--CALL     6952--CALL
      6959--CALL     6983--CALL     7026--CALL     7043--CALL     7168--CALL     7205--CALL     7226--CALL
      7275--CALL     7286--CALL     7312--CALL     7333--CALL     7338--CALL     7343--CALL     7348--CALL
      7353--CALL     7358--CALL     7363--CALL     7368--CALL     7388--CALL     7406--CALL     7492--CALL
      7511--CALL     7555--CALL     7562--CALL     7577--CALL     7597--CALL     7640--CALL     7650--CALL
      7661--CALL     7669--CALL     7674--CALL     7682--CALL     7689--CALL     7693--CALL     7707--CALL
PL6.E3A0      #001=ZIG$D_PSET File=ZIG$D_PSET.:ZIC0TSI                           FRI 09/05/97 12:01 Page:434  
      7712--CALL     7722--CALL     7733--CALL     7740--CALL     7745--CALL     7755--CALL     7760--CALL
      7765--CALL     7806--CALL     7827--CALL     7833--CALL     7841--CALL     7848--CALL     7859--CALL
      7880--CALL     7885--CALL     7914--CALL     7919--CALL     7924--CALL     7929--CALL     7956--CALL
      7965--CALL     7968--CALL     7985--CALL     7993--CALL     8017--CALL     8071--CALL     8084--CALL
      8103--CALL     8123--CALL     8144--CALL     8153--CALL     8154--CALL     8162--CALL     8163--CALL
      8171--CALL     8172--CALL     8179--CALL     8180--CALL     8187--CALL     8188--CALL     8210--CALL
      8239--CALL     8249--CALL     8269--CALL     8281--CALL     8290--CALL     8295--CALL     8299--CALL
      8310--CALL     8318--CALL     8325--CALL     8332--CALL     8359--CALL     8382--CALL     8391--CALL
      8421--CALL     8430--CALL     8487--CALL     8491--CALL     8524--CALL     8532--CALL     8541--CALL
      8548--CALL     8556--CALL     8566--CALL     8573--CALL     8577--CALL     8581--CALL     8589--CALL
      8594--CALL     8670--CALL     8681--CALL     8737--CALL     8749--CALL     8768--CALL     8798--CALL
      8889--CALL
ZIG$D_FAIL
        25**DCL-ENT  8603--CALL
ZIG$D_READ
        26**DCL-ENT  6874--CALL
ZIG$G_DYN_MEM_6
      1105**DCL-ENT  6887--CALL     7054--CALL     7061--CALL     7247--CALL     7262--CALL     8342--CALL
      8354--CALL     8366--CALL     8374--CALL     8384--CALL     8399--CALL     8407--CALL     8423--CALL
      8433--CALL     8444--CALL     8452--CALL     8460--CALL     8467--CALL     8475--CALL     8496--CALL
      8596--CALL     8861--CALL
ZIG$HASH_IT
        24**DCL-ENT  8657--CALL     8854--CALL
