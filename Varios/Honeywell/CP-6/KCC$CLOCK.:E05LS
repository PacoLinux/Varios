VERSION E05

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:1    
        1        1        /*M* KCC$CLOCK - Routine to be called from clock routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KCC$CLOCK
       10       10             PURPOSE:      Process defered items
       11       11             DESCRIPTION:  KCC$CLOCK contains two processes.
       12       12                           The entry point KCC$CLOCK is called off
       13       13                           the clock to process delayed items that
       14       14                           want to wait for one second.  The
       15       15                           presence of such things is indicated by
       16       16                           various flags in the comgroup.
       17       17                           KCC$BASE is called to do things which
       18       18                           must be deferred only until we have
       19       19                           'unwound' out of the comgroup.
       20       20        */
       21       21
       22       22
       23       23
       24       24        /*D* NAME:         KCC$CLOCK
       25       25             CALL:         CALL KCC$CLOCK;
       26       26             DESCRIPTION:  Called via MONTIMR to process clock-
       27       27                           defer items for all comgroups.
       28       28        */
       29       29
       30       30
       31       31
       32       32        KCC$CLOCK: PROC (PARM);  /* Parm not passed */
       33       33
       34       34
       35       35        /**/
       36       36        /* INCLUDES */
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:2    
       37       37        %INCLUDE CP_6_SUBS;
       38      577        %INCLUDE HF_LOCK_C;
       39      591        %INCLUDE KC$CP6V_C;
       40      711        %INCLUDE KC_CP6;
       41     1271        %INCLUDE KQ_MAC_C;
       42     3821        %INCLUDE KQM_MAC_C;
       43     4194        %INCLUDE KQ_DATA_R;
       44     5026        %INCLUDE NK$LDCT;
       45     5128        %INCLUDE N$REQ;
       46     5202        %INCLUDE KQ_SUBS_C;
       47     5502
       48     5503
       49     5504
       50     5505        /**/
       51     5506        /* PARAMETERS */
       52     5507        /**/
       53     5508    1   DCL PARM UBIN;
       54     5509
       55     5510
       56     5511        /**/
       57     5512        /* BASED STRUCTURES */
       58     5513        /**/
       59     5514        %KQ_CG (FPTN=KQ$CG,STCLASS="BASED(CG$)");
       60     6253        %NK$LDCT;
       61     6299        %KQ_DFRBLK (FPTN=KQ$DFRBLK,STCLASS="BASED(DFR$)");
       62     6349        %KQ_RBLK (FPTN=KQ$RBLKT,STCLASS=BASED,TERM=1);
       63     6535        %KQ_RBLK (FPTN=KQ$RBLKD,STCLASS=BASED,TERM=0);
       64     6721        %KQ_MBLK (FPTN=KQ$MBLK,STCLASS=BASED,SUPR=1);
       65     6991        %KQ_STA  (FPTN=KQ$STA ,STCLASS=BASED);
       66     7330        %KQ_MMSD (FPTN=KQ$MMSD,STCLASS="BASED(KQ_MMSD$)");
       67     7367        %N$REQ;
       68     7425
       69     7426
       70     7427        /**/
       71     7428        /* AUTO */
       72     7429        /**/
       73     7430    1   DCL CG$ PTR;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:3    
       74     7431    1   DCL SQUEEZEFLG UBIN;
       75     7432    1   DCL PREV$ PTR;
       76     7433    1   DCL P$ PTR;
       77     7434    1   DCL STA$ PTR;
       78     7435    1   DCL MBLK$ PTR;
       79     7436    1   DCL DFR$ REDEF MBLK$ PTR;
       80     7437    1   DCL KEY CHAR(8);
       81     7438
       82     7439
       83     7440        /**/
       84     7441        /* EXTERNAL ROUTINES */
       85     7442        /**/
       86     7443    1   DCL KCA$CLOCK     ENTRY(1) ALTRET;
       87     7444    1   DCL KCA$TELLAU    ENTRY(3) ALTRET;
       88     7445    1   DCL KCD$STTM      ENTRY(1) ALTRET;
       89     7446    1   DCL KCO$DDISC     ENTRY(1);
       90     7447    1   DCL KQB$SRCH      ENTRY(3) ALTRET;
       91     7448    1   DCL KQC$ABTRD     ENTRY(2) ALTRET;
       92     7449    1   DCL KQD$COMP      ENTRY(1) ALTRET;
       93     7450    1   DCL KQD$GETINIT   ENTRY(1) ALTRET;
       94     7451    1   DCL KQD$NEEDPG    ENTRY(1) ALTRET;
       95     7452    1   DCL KQD$SQUEEZE   ENTRY(1) ALTRET;
       96     7453    1   DCL KQD$STARTIO   ENTRY(3) ALTRET;
       97     7454    1   DCL KQG$DFETCH    ENTRY(1) ALTRET;
       98     7455    1   DCL KQG$DVGET     ENTRY(1) ALTRET;
       99     7456    1   DCL KQL$SRQ       ENTRY(1) ALTRET;
      100     7457    1   DCL KQM$BASEREL   ENTRY(1) ALTRET;
      101     7458    1   DCL KQP$DSCGO     ENTRY(1) ALTRET;
      102     7459    1   DCL KQP$DVGET     ENTRY(1) ALTRET;
      103     7460    1   DCL KQR$DFETCH    ENTRY(1) ALTRET;
      104     7461    1   DCL KQS$CLOCK     ENTRY(1) ALTRET;
      105     7462    1   DCL KQS$DOFULL    ENTRY(1) ALTRET;
      106     7463    1   DCL KQS$GARB      ENTRY(1) ALTRET;
      107     7464    1   DCL KQX$LDASR     ENTRY(1);
      108     7465    1   DCL KQZ$STARTLOG  ENTRY ALTRET;
      109     7466    1   DCL KQZ$STOPLOG   ENTRY ALTRET;
      110     7467    1   DCL NIQ$GETNR     ENTRY(1) ALTRET;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:4    
      111     7468    1   DCL SSC$MONTIMR   ENTRY(3);
      112     7469
      113     7470
      114     7471
      115     7472        /**/
      116     7473        /* SYMREFS */
      117     7474        /**/
      118     7475    1   DCL S_PNO UBIN SYMREF;
      119     7476    1   DCL KQ_MMSD$ PTR SYMREF READONLY;
      120     7477
      121     7478
      122     7479
      123     7480        /**/
      124     7481        /* SUBS */
      125     7482        /**/
      126     7483        %EQU_CG;
      127     7531        %EJECT;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:5    
      128     7532
      129     7533    1         KQ_CLKCNT=KQ_CLKCNT+1;
      130     7534    1         IF KQ_CLKCNT>=KQ_SQUEEZE THEN
      131     7535    2           DO;
      132     7536    2           KQ_CLKCNT=0;
      133     7537    2           SQUEEZEFLG=1;
      134     7538    2           END;
      135     7539    1         ELSE
      136     7540    1          SQUEEZEFLG=0;
      137     7541    1         CG$=KQ$MMSD.CGHEAD$;
      138     7542        /**/
      139     7543    2           DO WHILE(CG$~=ADDR(NIL));
      140     7544    2           IF NOT KQ$CG.CLOCK THEN
      141     7545    2            GOTO NXTCG;
      142     7546    2           CALL KQX$LDASR(KQ$CG);
      143     7547        /**/
      144     7548    2           IF KQ$CG.GETFLG~=0 THEN
      145     7549    2            CALL KQD$GETINIT(KQ$CG);
      146     7550        /**/
      147     7551    3             DO WHILE(KQ$CG.IOQHD$~=ADDR(NIL));
      148     7552    3             CALL NIQ$GETNR(STA$) ALTRET(NOQENTS);
      149     7553                  %LOCK (G=KQ$CG.DTREE.GATE);
      150     7556    3             DFR$=KQ$CG.IOQHD$;
      151     7557    3             KQ$CG.IOQHD$=KQ$DFRBLK.LNK$;
      152     7558    3             IF KQ$CG.IOQTL$=DFR$ THEN
      153     7559    3              KQ$CG.IOQTL$=ADDR(NIL);
      154     7560    3             IF KQ$CG.IOTL$=ADDR(NIL)
      155     7561    3             THEN KQ$CG.IOHD$=DFR$;
      156     7562    3             ELSE KQ$CG.IOTL$->KQ$DFRBLK.LNK$=DFR$;
      157     7563    3             KQ$CG.IOTL$=DFR$;
      158     7564    3             PREV$=ADDR(NIL);
      159     7565    3             P$=KQ$CG.IOQHD$;
      160     7566    3             IF KQ$DFRBLK.CODE~=%KQDC_WRITE THEN
      161     7567    4               DO WHILE(P$~=ADDR(NIL));
      162     7568    4               IF P$->KQ$DFRBLK.DA=KQ$DFRBLK.DA
      163     7569    5               THEN DO;
      164     7570    5                 KQ$CG.IOTL$->KQ$DFRBLK.LNK$=P$;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:6    
      165     7571    5                 KQ$CG.IOTL$=P$;
      166     7572    5                 IF PREV$=ADDR(NIL)
      167     7573    5                 THEN KQ$CG.IOQHD$=P$->KQ$DFRBLK.LNK$;
      168     7574    5                 ELSE PREV$->KQ$DFRBLK.LNK$=P$->KQ$DFRBLK.LNK$;
      169     7575    5                 IF KQ$CG.IOQTL$=P$
      170     7576    5                 THEN KQ$CG.IOQTL$=PREV$;
      171     7577    5                 END;
      172     7578    4               ELSE PREV$=P$;
      173     7579    4               P$=P$->KQ$DFRBLK.LNK$;
      174     7580    4               END;
      175     7581    3             KQ$CG.IOTL$->KQ$DFRBLK.LNK$=ADDR(NIL);
      176     7582                  %UNLOCK (G=KQ$CG.DTREE.GATE);
      177     7585    3             CALL KQD$STARTIO(KQ$CG,DFR$,STA$);
      178     7586    3             END;
      179     7587    2   NOQENTS:;
      180     7588        /**/
      181     7589    2           IF KQ$CG.DELAY THEN
      182     7590    3             DO;
      183     7591    3             CALL WARN;
      184     7592    3             IF KQ$CG.DELAY.DDISC THEN CALL DDISC;
      185     7593    3             IF KQ$CG.DELAY.AU THEN
      186     7594    3              CALL KCA$CLOCK (KQ$CG);
      187     7595    3             END;
      188     7596    2           IF SQUEEZEFLG~=0 THEN
      189     7597    2            CALL KQD$SQUEEZE(KQ$CG);
      190     7598    2           IF KQ$CG.EOFTIMEHD$~=ADDR(NIL) THEN CALL CHKEOFTIME;
      191     7599    2           IF KQ$CG.DPVGHD$ ~= ADDR(NIL) THEN CALL PVGET;
      192     7600    2           IF KQ$CG.DGVGHD$ ~= ADDR(NIL) THEN CALL GVGET;
      193     7601    2           IF KQ$CG.DFHD$ ~= ADDR(NIL) THEN CALL DFETCH;
      194     7602    2           IF KQ$CG.SRQHD$ ~= ADDR(NIL) THEN CALL SRQ;
      195     7603    2           IF KQ$CG.GARB.DELAY > 0 THEN CALL KQS$CLOCK (KQ$CG);
      196     7604    2           ELSE IF KQ$CG.DELMSG$ ~= ADDR(NIL) THEN
      197     7605    2             IF KQ$CG.MMD.GIP = '0'B THEN
      198     7606    3               DO;
      199     7607                    %LOCK (G=KQ$CG.MMD.GATE);
      200     7610    3               CALL KQS$GARB (KQ$CG);
      201     7611    3               END;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:7    
      202     7612        /**/
      203     7613    2           IF KQ$CG.BASEDELAY ~= 0 THEN CALL KCC$BASE;
      204     7614    2   NXTCG:  ;
      205     7615    2           CG$=KQ$CG.LNK$;
      206     7616    2           END;
      207     7617        /**/
      208     7618    1         IF KQ_LOG THEN
      209     7619    1          IF KQ_HDLOG$=ADDR(NIL) THEN
      210     7620    1           CALL KQZ$STARTLOG;
      211     7621    1          ELSE;
      212     7622    1         ELSE
      213     7623    1          IF KQ_HDLOG$~=ADDR(NIL) THEN
      214     7624    1           CALL KQZ$STOPLOG;
      215     7625        /**/
      216     7626    1         CALL SSC$MONTIMR(KQ_MONTIMR,ENTADDR(KCC$CLOCK),0);
      217     7627        /**/
      218     7628    1         RETURN;
      219     7629        %EJECT;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:8    
      220     7630        /**/
      221     7631        /*F* NAME:         KCC$BASE
      222     7632             PURPOSE:      To process deferred items for all comgroups
      223     7633             DESCRIPTION:  Sometimes a comgroup wants to perform an
      224     7634                           action but cannot due to fear that this
      225     7635                           would cause a gate to be locked twice.
      226     7636                           Examples are completing data cache get
      227     7637                           requests driven off data cache unlocks,
      228     7638                           and unblocking memory-REGed processes
      229     7639                           off memory release.
      230     7640
      231     7641                           In order to make this happen, the idle and
      232     7642                           interrupt-exit paths from the monitor check
      233     7643                           the cell KQ_BASEDELAY and call here if
      234     7644                           it is nonzero.  People who put themselves
      235     7645                           in this delay state increment BASEDELAY.
      236     7646                           What we do here is zap BASEDELAY and run
      237     7647                           thru the list of things which could be
      238     7648                           waiting, activating them if they are.
      239     7649        */
      240     7650    1   KCC$BASE: ENTRY;
      241     7651        /**/
      242     7652    1         IF S_PNO ~= 0 THEN RETURN;
      243     7653    2           DO WHILE (KQ_BASEDELAY ~= 0);
      244     7654    2           KQ_BASEDELAY=0;
      245     7655    2           CG$=KQ$MMSD.CGHEAD$;
      246     7656    3             DO WHILE (CG$ ~= ADDR(NIL));
      247     7657    3             IF  KQ$CG.CLOCK
      248     7658    3             AND KQ$CG.BASEDELAY ~= 0 THEN
      249     7659    4               DO;
      250     7660    4               CALL KQX$LDASR (KQ$CG);
      251     7661    5                 DO WHILE (KQ$CG.BASEDELAY ~= 0);
      252     7662    5                 KQ$CG.BASEDELAY=0;
      253     7663        /**/
      254     7664    5                 IF KQ$CG.DFRDFR$ ~= ADDR(NIL) THEN
      255     7665    5                  CALL KQD$COMP (KQ$CG);
      256     7666        /**/
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:9    
      257     7667    5                 CALL WARN;
      258     7668        /**/
      259     7669    5                 IF KQ$CG.DELAY.CGFULL THEN
      260     7670    5                  CALL KQS$DOFULL (KQ$CG);
      261     7671        /**/
      262     7672    5                 IF KQ$CG.DELAY.NEEDPG THEN
      263     7673    5                  CALL KQD$NEEDPG (KQ$CG);
      264     7674        /**/
      265     7675    5                 IF KQ$CG.MMD.BASEREL$ ~= ADDR(NIL) THEN
      266     7676    5                  CALL KQM$BASEREL (KQ$CG);
      267     7677    5                 END;
      268     7678    4               END;
      269     7679    3             CG$=KQ$CG.LNK$;
      270     7680    3             END;
      271     7681    2           END;
      272     7682    1         RETURN;
      273     7683        /**/
      274     7684        /**/
      275     7685    1   GLOCK: PROC;
      276     7686        /**/
      277     7687        %LOCK (G=KQ$CG.GATE.CG);
      278     7690    2         RETURN;
      279     7691    2   GUNLOCK: ENTRY;
      280     7692        /**/
      281     7693              %UNLOCK (G=KQ$CG.GATE.CG);
      282     7696    2         RETURN;
      283     7697    2   END GLOCK;
      284     7698    1   WARN: PROC;
      285     7699    2         IF KQ$CG.DELAY.MEMWARN THEN
      286     7700    3           DO;
      287     7701    3           CALL KCA$TELLAU (KQ$CG.GORGOSTA$->KQ$STA,%CG_WARN#,%CG_WARN_MEM#) ALTRET(NMW
              7701                    );
      288     7702    3           CALL GLOCK;
      289     7703    3           KQ$CG.DELAY.MEMWARN='0'B;
      290     7704    3           CALL GUNLOCK;
      291     7705    3   NMW:    END;
      292     7706    2         IF KQ$CG.DELAY.DISKWARN THEN
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:10   
      293     7707    3           DO;
      294     7708    3           CALL KCA$TELLAU (KQ$CG.GORGOSTA$->KQ$STA,%CG_WARN#,%CG_WARN_DISK#) ALTRET(
              7708                    NDW);
      295     7709    3           CALL GLOCK;
      296     7710    3           KQ$CG.DELAY.DISKWARN='0'B;
      297     7711    3           CALL GUNLOCK;
      298     7712    3   NDW:    END;
      299     7713    2   END WARN;
      300     7714        /**/
      301     7715        /*F* NAME:         KCC$RECOVER
      302     7716             PURPOSE:      To clean up clock stuff when a crashed comgroup
      303     7717                           is being re-opened.
      304     7718             CALL:         KCC$RECOVER (KQ$CG)
      305     7719             DESCRIPTION:  Resets clock-related goodies.
      306     7720        */
      307     7721    1   KCC$RECOVER: ENTRY (PARM);
      308     7722        /**/
      309     7723    1         CG$=ADDR(PARM);
      310     7724    1         KQ$CG.DPVGHD$=ADDR(NIL);
      311     7725    1         KQ$CG.DGVGHD$=ADDR(NIL);
      312     7726    1         KQ$CG.DFHD$=ADDR(NIL);
      313     7727    1         KQ$CG.SRQHD$=ADDR(NIL);
      314     7728    1         KQ$CG.DELAY='0'B;
      315     7729    1         RETURN;
      316     7730        %EJECT;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:11   
      317     7731        /***********************************************************
      318     7732        ************************************************************/
      319     7733        /*D* NAME:         PVGET
      320     7734             PURPOSE:      To re-try delayed PUT VGETs
      321     7735             DESCRIPTION:  Runs the chain of terminal stations waiting
      322     7736                           to do VGETs in KQP$PUT or disconnect, giving
      323     7737                           them a shot at it again.
      324     7738        */
      325     7739    1   PVGET: PROC;
      326     7740        /**/
      327     7741    2         KQ_STATS.DVGET=KQ_STATS.DVGET+1;
      328     7742    2         CALL GLOCK;
      329     7743    2         STA$=KQ$CG.DPVGHD$;
      330     7744    2         KQ$CG.DPVGHD$=ADDR(NIL);
      331     7745    2         CALL GUNLOCK;
      332     7746    3           DO WHILE (STA$ ~= ADDR(NIL));
      333     7747    3           P$=STA$->KQ$STA.DPVGLNK$;
      334     7748    3           STA$->KQ$STA.DPVGLNK$=ADDR(NIL);
      335     7749    3           IF STA$->KQ$STA.PVGSENSE = '0'B THEN
      336     7750    3            CALL KQP$DVGET (STA$->KQ$STA.LDCT$->NK$LDCT);
      337     7751    3           ELSE CALL KQP$DSCGO (STA$->KQ$STA.LDCT$->NK$LDCT);
      338     7752    3           STA$=P$;
      339     7753    3           END;
      340     7754    2         RETURN;
      341     7755    2   END PVGET;
      342     7756        /***********************************************************
      343     7757        ************************************************************/
      344     7758        /*D* NAME:         GVGET
      345     7759             PURPOSE:      To re-try delayed GET VGETs
      346     7760             DESCRIPTION:  Runs the chain of terminal stations waiting
      347     7761                           to do VGETs in KQG$GET, giving them a shot
      348     7762                           at it again.
      349     7763        */
      350     7764    1   GVGET: PROC;
      351     7765        /**/
      352     7766    2         CALL GLOCK;
      353     7767    2         STA$=KQ$CG.DGVGHD$;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:12   
      354     7768    2         KQ$CG.DGVGHD$=ADDR(NIL);
      355     7769    2         CALL GUNLOCK;
      356     7770    3           DO WHILE (STA$ ~= ADDR(NIL));
      357     7771    3           P$=STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DGVGLNK$;
      358     7772    3           STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DGVGLNK$=ADDR(NIL);
      359     7773    3           CALL KQG$DVGET (STA$->KQ$STA.LDCT$->NK$LDCT);
      360     7774    3           STA$=P$;
      361     7775    3           END;
      362     7776    2         RETURN;
      363     7777    2   END GVGET;
      364     7778        /***********************************************************
      365     7779        ************************************************************/
      366     7780        /*D* NAME:         DFETCH
      367     7781             PURPOSE:      To re-try delayed FETCHs
      368     7782             DESCRIPTION:  Runs the chain of stations waiting
      369     7783                           to do FETCHs, giving them a shot
      370     7784                           at it again.
      371     7785        */
      372     7786    1   DFETCH: PROC;
      373     7787        /**/
      374     7788    2         KQ_STATS.DFETCH=KQ_STATS.DFETCH+1;
      375     7789    2         CALL GLOCK;
      376     7790    2         STA$=KQ$CG.DFHD$;
      377     7791    2         KQ$CG.DFHD$=ADDR(NIL);
      378     7792    2         CALL GUNLOCK;
      379     7793    3           DO WHILE (STA$ ~= ADDR(NIL));
      380     7794    3           P$=STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DFLNK$;
      381     7795    3           STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DFLNK$=ADDR(NIL);
      382     7796    3           IF STA$->KQ$STA.TERM THEN
      383     7797    3            CALL KQG$DFETCH (STA$->KQ$STA.LDCT$->NK$LDCT);
      384     7798    3           ELSE CALL KQR$DFETCH (STA$->KQ$STA.LDCT$->NK$LDCT.IOQ$->N$REQ);
      385     7799    3           STA$=P$;
      386     7800    3           END;
      387     7801    2         RETURN;
      388     7802    2   END DFETCH;
      389     7803        /***********************************************************
      390     7804        ************************************************************/
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:13   
      391     7805        /*D* NAME:         SRQ
      392     7806             PURPOSE:      To re-try super MBLK requests which failed for
      393     7807                           some reason.
      394     7808             DESCRIPTION:  The chain of super MBLKs waiting for this service
      395     7809                           is run, giving them all a shot at it.
      396     7810        */
      397     7811    1   SRQ:  PROC;
      398     7812        /**/
      399     7813    2         CALL GLOCK;
      400     7814    2         MBLK$=KQ$CG.SRQHD$;
      401     7815    2         KQ$CG.SRQHD$=ADDR(NIL);
      402     7816    2         CALL GUNLOCK;
      403     7817    3           DO WHILE (MBLK$ ~= ADDR(NIL));
      404     7818    3           P$=MBLK$->KQ$MBLK.XSP.SLNK$;
      405     7819    3           MBLK$->KQ$MBLK.XSP.SLNK$=ADDR(NIL);
      406     7820    3           CALL KQL$SRQ (MBLK$->KQ$MBLK);
      407     7821    3           MBLK$=P$;
      408     7822    3           END;
      409     7823    2         RETURN;
      410     7824    2   END SRQ;
      411     7825        /***********************************************************
      412     7826        ************************************************************/
      413     7827        /*D* NAME:           CHKEOFTIME
      414     7828             PURPOSE:        To time out any expired (via EOFTIME) DCB reads
      415     7829             DESCRIPTION:    The list of pending RBLKs which may be timed out
      416     7830                             is examined and any expired RBLKs are cancelled
      417     7831                             with EOF.
      418     7832        */
      419     7833    1   CHKEOFTIME: PROC;
      420     7834        /**/
      421     7835    2   DCL FIRST BIT(1) ALIGNED;
      422     7836    2   DCL FOUND BIT(1) ALIGNED;
      423     7837    2   DCL RBLK$ PTR;
      424     7838    2         FIRST='1'B;
      425     7839    2         FOUND='0'B;
      426     7840    2   TOP:  ;
      427     7841              %LOCK(G=KQ$CG.STREE.GATE);
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:14   
      428     7844    2         IF KQ$CG.EOFTIMEHD$=ADDR(NIL) THEN GOTO XIT;
      429     7845    2         IF FIRST THEN
      430     7846    3           DO;
      431     7847    3           FIRST='0'B;
      432     7848    3           KQ$CG.EOFTIME=KQ$CG.EOFTIME+1;
      433     7849    3           END;
      434     7850    2         IF KQ$CG.EOFTIMEHD$->KQ$RBLKD.EOFTIME<=KQ$CG.EOFTIME THEN
      435     7851    3           DO;
      436     7852    3           FOUND='1'B;
      437     7853    3           STA$=KQ$CG.EOFTIMEHD$->KQ$RBLKD.STA$;
      438     7854                %UNLOCK(G=KQ$CG.STREE.GATE);
      439     7857    3           CALL KQC$ABTRD(STA$->KQ$STA,%TYC_EOF);
      440     7858    3           GOTO TOP;
      441     7859    3           END;
      442     7860    2   XIT:  ;
      443     7861    2         IF FOUND THEN
      444     7862    3           DO;
      445     7863    3           RBLK$=KQ$CG.EOFTIMEHD$;
      446     7864    4             DO WHILE(RBLK$~=ADDR(NIL));
      447     7865    4             STA$=RBLK$->KQ$RBLKD.STA$;
      448     7866                  %LOCK(G=STA$->KQ$STA.GATE);
      449     7869    4             RBLK$->KQ$RBLKD.EOFTIME=RBLK$->KQ$RBLKD.EOFTIME-KQ$CG.EOFTIME;
      450     7870                  %UNLOCK(G=STA$->KQ$STA.GATE);
      451     7873    4             RBLK$=RBLK$->KQ$RBLKD.EOFTIMELNK$;
      452     7874    4             END;
      453     7875    3           KQ$CG.EOFTIME=0;
      454     7876    3           END;
      455     7877              %UNLOCK(G=KQ$CG.STREE.GATE);
      456     7880    2         RETURN;
      457     7881    2   END CHKEOFTIME;
      458     7882        /***********************************************************
      459     7883        ************************************************************/
      460     7884        /*D* NAME:         DDISC
      461     7885             PURPOSE:      To continue delayed terminal disconnects
      462     7886             DESCRIPTION:  When KCO$DSCTRM needs to try a failed
      463     7887                           operation again, he sets DELAY.DDISC
      464     7888                           in KQ$CG, and DDISC in KQ$STA.  This
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:15   
      465     7889                           routine finds all such stations and
      466     7890                           calls KCO$DDISC for them.
      467     7891                           This is also used to delay disconnects of
      468     7892                           KQ$STA.SAVLDCT$->NK$LDCT so that it also
      469     7893                           runs off the clock thereby avoiding some
      470     7894                           collision possibilities.
      471     7895        */
      472     7896    1   DDISC: PROC;
      473     7897        /**/
      474     7898    2         CALL GLOCK;
      475     7899    2         KQ$CG.DELAY.DDISC='0'B;
      476     7900    2         CALL GUNLOCK;
      477     7901              %LOCK (G=KQ$CG.STREE.GATE);
      478     7904    2         STA$=KQ$CG.STREE.HEAD$;
      479     7905    3   D0:     DO WHILE (STA$ ~= ADDR(NIL));
      480     7906    3           IF STA$->KQ$STA.DDISC ~= 0 THEN
      481     7907    4             DO;
      482     7908    4             KEY=STA$->KQ$STA.BTN.KEY;
      483     7909                  %UNLOCK (G=KQ$CG.STREE.GATE);
      484     7912    4             CALL KCO$DDISC (STA$->KQ$STA);
      485     7913                  %LOCK (G=KQ$CG.STREE.GATE);
      486     7916    4             CALL KQB$SRCH (KQ$CG.STREE,KEY,STA$) ALTRET(D1);
      487     7917    4             END;
      488     7918    3           STA$=STA$->KQ$STA.BTN.FLINK$;
      489     7919    3           END;
      490     7920              %UNLOCK (G=KQ$CG.STREE.GATE);
      491     7923    2         RETURN;
      492     7924    2   D1:   IF STA$->KQ$STA.BTN.KEY <= KEY THEN
      493     7925    2          STA$=STA$->KQ$STA.BTN.FLINK$;
      494     7926    2         GOTO D0;
      495     7927    2   END DDISC;
      496     7928        /**/
      497     7929    1   END KCC$CLOCK;

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:16   
--  Include file information  --

   KQ_SUBS_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_DATA_R.:E05TOU  is referenced.
   KQM_MAC_C.:E05TOU  is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure KCC$CLOCK.

   Procedure KCC$CLOCK requires 710 words for executable code.
   Procedure KCC$CLOCK requires 20 words of local(AUTO) storage.

    No errors detected in file KCC$CLOCK.:E05TSI    .

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:17   

 Object Unit name= KCC$CLOCK                                  File name= KCC$CLOCK.:E05TOU
 UTS= JUL 30 '97 00:10:41.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  KCC$CLOCK
    1   Proc  even  none   710   1306  KCC$CLOCK
    2  RoData even  none     9     11  KCC$CLOCK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KCC$CLOCK
     1    373                  yes      Std        0  KCC$BASE
     1    601                  yes      Std        1  KCC$RECOVER
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:18   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KQX$LDASR
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       0 KQZ$STOPLOG
 yes     yes           Std       1 KQD$NEEDPG
 yes     yes           Std       1 KQD$GETINIT
         yes           Std       1 HFC$LOCK
 yes     yes           Std       3 KQD$STARTIO
 yes     yes           Std       1 KCA$CLOCK
         yes           Std       3 SSC$MONTIMR
 yes     yes           Std       1 KQS$GARB
 yes     yes           Std       1 KQD$COMP
 yes     yes           Std       0 KQZ$STARTLOG
 yes     yes           Std       1 KQS$CLOCK
 yes     yes           Std       1 NIQ$GETNR
 yes     yes           Std       1 KQD$SQUEEZE
 yes     yes           Std       1 KQS$DOFULL
 yes     yes           Std       1 KQM$BASEREL
 yes     yes           Std       3 KCA$TELLAU
 yes     yes           Std       1 KQP$DVGET
 yes     yes           Std       1 KQP$DSCGO
 yes     yes           Std       1 KQG$DVGET
 yes     yes           Std       1 KQG$DFETCH
 yes     yes           Std       1 KQR$DFETCH
 yes     yes           Std       1 KQL$SRQ
 yes     yes           Std       2 KQC$ABTRD
 yes     yes           Std       3 KQB$SRCH
         yes           Std       1 KCO$DDISC
         yes           Std       1 KCC$CLOCK
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:19   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KQ_BASEDELAY                          KQ_MONTIMR                            KQ_SQUEEZE
     KQ_CLKCNT                             KQ_STATS                              KQ_LOG
     KQ_HDLOG$                             S_PNO                            r    KQ_MMSD$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:20   


        1        1        /*M* KCC$CLOCK - Routine to be called from clock routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KCC$CLOCK
       10       10             PURPOSE:      Process defered items
       11       11             DESCRIPTION:  KCC$CLOCK contains two processes.
       12       12                           The entry point KCC$CLOCK is called off
       13       13                           the clock to process delayed items that
       14       14                           want to wait for one second.  The
       15       15                           presence of such things is indicated by
       16       16                           various flags in the comgroup.
       17       17                           KCC$BASE is called to do things which
       18       18                           must be deferred only until we have
       19       19                           'unwound' out of the comgroup.
       20       20        */
       21       21
       22       22
       23       23
       24       24        /*D* NAME:         KCC$CLOCK
       25       25             CALL:         CALL KCC$CLOCK;
       26       26             DESCRIPTION:  Called via MONTIMR to process clock-
       27       27                           defer items for all comgroups.
       28       28        */
       29       29
       30       30
       31       31
       32       32        KCC$CLOCK: PROC (PARM);  /* Parm not passed */

     32  1 000000   000000 700200 xent  KCC$CLOCK    TSX0  ! X66_AUTO_1
         1 000001   000024 000001                    ZERO    20,1
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:21   

       33       33
       34       34
       35       35        /**/
       36       36        /* INCLUDES */
       37       37        %INCLUDE CP_6_SUBS;
       38      577        %INCLUDE HF_LOCK_C;
       39      591        %INCLUDE KC$CP6V_C;
       40      711        %INCLUDE KC_CP6;
       41     1271        %INCLUDE KQ_MAC_C;
       42     3821        %INCLUDE KQM_MAC_C;
       43     4194        %INCLUDE KQ_DATA_R;
       44     5026        %INCLUDE NK$LDCT;
       45     5128        %INCLUDE N$REQ;
       46     5202        %INCLUDE KQ_SUBS_C;
       47     5502
       48     5503
       49     5504
       50     5505        /**/
       51     5506        /* PARAMETERS */
       52     5507        /**/
       53     5508    1   DCL PARM UBIN;
       54     5509
       55     5510
       56     5511        /**/
       57     5512        /* BASED STRUCTURES */
       58     5513        /**/
       59     5514        %KQ_CG (FPTN=KQ$CG,STCLASS="BASED(CG$)");
       60     6253        %NK$LDCT;
       61     6299        %KQ_DFRBLK (FPTN=KQ$DFRBLK,STCLASS="BASED(DFR$)");
       62     6349        %KQ_RBLK (FPTN=KQ$RBLKT,STCLASS=BASED,TERM=1);
       63     6535        %KQ_RBLK (FPTN=KQ$RBLKD,STCLASS=BASED,TERM=0);
       64     6721        %KQ_MBLK (FPTN=KQ$MBLK,STCLASS=BASED,SUPR=1);
       65     6991        %KQ_STA  (FPTN=KQ$STA ,STCLASS=BASED);
       66     7330        %KQ_MMSD (FPTN=KQ$MMSD,STCLASS="BASED(KQ_MMSD$)");
       67     7367        %N$REQ;
       68     7425
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:22   
       69     7426
       70     7427        /**/
       71     7428        /* AUTO */
       72     7429        /**/
       73     7430    1   DCL CG$ PTR;
       74     7431    1   DCL SQUEEZEFLG UBIN;
       75     7432    1   DCL PREV$ PTR;
       76     7433    1   DCL P$ PTR;
       77     7434    1   DCL STA$ PTR;
       78     7435    1   DCL MBLK$ PTR;
       79     7436    1   DCL DFR$ REDEF MBLK$ PTR;
       80     7437    1   DCL KEY CHAR(8);
       81     7438
       82     7439
       83     7440        /**/
       84     7441        /* EXTERNAL ROUTINES */
       85     7442        /**/
       86     7443    1   DCL KCA$CLOCK     ENTRY(1) ALTRET;
       87     7444    1   DCL KCA$TELLAU    ENTRY(3) ALTRET;
       88     7445    1   DCL KCD$STTM      ENTRY(1) ALTRET;
       89     7446    1   DCL KCO$DDISC     ENTRY(1);
       90     7447    1   DCL KQB$SRCH      ENTRY(3) ALTRET;
       91     7448    1   DCL KQC$ABTRD     ENTRY(2) ALTRET;
       92     7449    1   DCL KQD$COMP      ENTRY(1) ALTRET;
       93     7450    1   DCL KQD$GETINIT   ENTRY(1) ALTRET;
       94     7451    1   DCL KQD$NEEDPG    ENTRY(1) ALTRET;
       95     7452    1   DCL KQD$SQUEEZE   ENTRY(1) ALTRET;
       96     7453    1   DCL KQD$STARTIO   ENTRY(3) ALTRET;
       97     7454    1   DCL KQG$DFETCH    ENTRY(1) ALTRET;
       98     7455    1   DCL KQG$DVGET     ENTRY(1) ALTRET;
       99     7456    1   DCL KQL$SRQ       ENTRY(1) ALTRET;
      100     7457    1   DCL KQM$BASEREL   ENTRY(1) ALTRET;
      101     7458    1   DCL KQP$DSCGO     ENTRY(1) ALTRET;
      102     7459    1   DCL KQP$DVGET     ENTRY(1) ALTRET;
      103     7460    1   DCL KQR$DFETCH    ENTRY(1) ALTRET;
      104     7461    1   DCL KQS$CLOCK     ENTRY(1) ALTRET;
      105     7462    1   DCL KQS$DOFULL    ENTRY(1) ALTRET;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:23   
      106     7463    1   DCL KQS$GARB      ENTRY(1) ALTRET;
      107     7464    1   DCL KQX$LDASR     ENTRY(1);
      108     7465    1   DCL KQZ$STARTLOG  ENTRY ALTRET;
      109     7466    1   DCL KQZ$STOPLOG   ENTRY ALTRET;
      110     7467    1   DCL NIQ$GETNR     ENTRY(1) ALTRET;
      111     7468    1   DCL SSC$MONTIMR   ENTRY(3);
      112     7469
      113     7470
      114     7471
      115     7472        /**/
      116     7473        /* SYMREFS */
      117     7474        /**/
      118     7475    1   DCL S_PNO UBIN SYMREF;
      119     7476    1   DCL KQ_MMSD$ PTR SYMREF READONLY;
      120     7477
      121     7478
      122     7479
      123     7480        /**/
      124     7481        /* SUBS */
      125     7482        /**/
      126     7483        %EQU_CG;
      127     7531        %EJECT;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:24   
      128     7532
      129     7533    1         KQ_CLKCNT=KQ_CLKCNT+1;

   7533  1 000002   000000 054000 xsym               AOS     KQ_CLKCNT

      130     7534    1         IF KQ_CLKCNT>=KQ_SQUEEZE THEN

   7534  1 000003   000000 236000 xsym               LDQ     KQ_CLKCNT
         1 000004   000000 116000 xsym               CMPQ    KQ_SQUEEZE
         1 000005   000012 604000 1                  TMI     s:7540

      131     7535    2           DO;

      132     7536    2           KQ_CLKCNT=0;

   7536  1 000006   000000 450000 xsym               STZ     KQ_CLKCNT

      133     7537    2           SQUEEZEFLG=1;

   7537  1 000007   000001 235007                    LDA     1,DL
         1 000010   200005 755100                    STA     SQUEEZEFLG,,AUTO

      134     7538    2           END;

   7538  1 000011   000013 710000 1                  TRA     s:7541

      135     7539    1         ELSE
      136     7540    1          SQUEEZEFLG=0;

   7540  1 000012   200005 450100                    STZ     SQUEEZEFLG,,AUTO

      137     7541    1         CG$=KQ$MMSD.CGHEAD$;

   7541  1 000013   000000 470400 xsym               LDP0    KQ_MMSD$
         1 000014   000001 236100                    LDQ     1,,PR0
         1 000015   200004 756100                    STQ     CG$,,AUTO

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:25   
      138     7542        /**/
      139     7543    2           DO WHILE(CG$~=ADDR(NIL));

   7543  1 000016   000335 710000 1                  TRA     s:7616

      140     7544    2           IF NOT KQ$CG.CLOCK THEN

   7544  1 000017   200004 470500                    LDP0    CG$,,AUTO
         1 000020   000105 236100                    LDQ     69,,PR0
         1 000021   000004 316007                    CANQ    4,DL
         1 000022   000332 600000 1                  TZE     NXTCG

      141     7545    2            GOTO NXTCG;
      142     7546    2           CALL KQX$LDASR(KQ$CG);

   7546  1 000023   200004 630500                    EPPR0   CG$,,AUTO
         1 000024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000025   000000 701000 xent               TSX1    KQX$LDASR
         1 000026   000000 011000                    NOP     0

      143     7547        /**/
      144     7548    2           IF KQ$CG.GETFLG~=0 THEN

   7548  1 000027   200004 470500                    LDP0    CG$,,AUTO
         1 000030   000226 236100                    LDQ     150,,PR0
         1 000031   777000 316003                    CANQ    -512,DU
         1 000032   000037 600000 1                  TZE     s:7551

      145     7549    2            CALL KQD$GETINIT(KQ$CG);

   7549  1 000033   200004 630500                    EPPR0   CG$,,AUTO
         1 000034   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000035   000000 701000 xent               TSX1    KQD$GETINIT
         1 000036   000000 011000                    NOP     0

      146     7550        /**/
      147     7551    3             DO WHILE(KQ$CG.IOQHD$~=ADDR(NIL));
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:26   

   7551  1 000037   000202 710000 1                  TRA     s:7586

      148     7552    3             CALL NIQ$GETNR(STA$) ALTRET(NOQENTS);

   7552  1 000040   200010 630500                    EPPR0   STA$,,AUTO
         1 000041   200020 450500                    STP0    RBLK$+1,,AUTO
         1 000042   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000043   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000044   000000 701000 xent               TSX1    NIQ$GETNR
         1 000045   000206 702000 1                  TSX2    NOQENTS

      149     7553                  %LOCK (G=KQ$CG.DTREE.GATE);

   7554  1 000046   200004 236100                    LDQ     CG$,,AUTO
         1 000047   000231 036003                    ADLQ    153,DU
         1 000050   200020 756100                    STQ     RBLK$+1,,AUTO
         1 000051   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000053   000000 701000 xent               TSX1    HFC$LOCK
         1 000054   000000 011000                    NOP     0

      150     7556    3             DFR$=KQ$CG.IOQHD$;

   7556  1 000055   200004 470500                    LDP0    CG$,,AUTO
         1 000056   000261 236100                    LDQ     177,,PR0
         1 000057   200011 756100                    STQ     MBLK$,,AUTO

      151     7557    3             KQ$CG.IOQHD$=KQ$DFRBLK.LNK$;

   7557  1 000060   200011 471500                    LDP1    MBLK$,,AUTO
         1 000061   100000 236100                    LDQ     0,,PR1
         1 000062   000261 756100                    STQ     177,,PR0

      152     7558    3             IF KQ$CG.IOQTL$=DFR$ THEN

   7558  1 000063   000262 236100                    LDQ     178,,PR0
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:27   
         1 000064   200011 116100                    CMPQ    MBLK$,,AUTO
         1 000065   000070 601000 1                  TNZ     s:7560

      153     7559    3              KQ$CG.IOQTL$=ADDR(NIL);

   7559  1 000066   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000067   000262 756100                    STQ     178,,PR0

      154     7560    3             IF KQ$CG.IOTL$=ADDR(NIL)

   7560  1 000070   000247 236100                    LDQ     167,,PR0
         1 000071   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000072   000076 601000 1                  TNZ     s:7562

      155     7561    3             THEN KQ$CG.IOHD$=DFR$;

   7561  1 000073   200011 236100                    LDQ     MBLK$,,AUTO
         1 000074   000246 756100                    STQ     166,,PR0
         1 000075   000101 710000 1                  TRA     s:7563

      156     7562    3             ELSE KQ$CG.IOTL$->KQ$DFRBLK.LNK$=DFR$;

   7562  1 000076   000247 473500                    LDP3    167,,PR0
         1 000077   200011 236100                    LDQ     MBLK$,,AUTO
         1 000100   300000 756100                    STQ     0,,PR3

      157     7563    3             KQ$CG.IOTL$=DFR$;

   7563  1 000101   200011 236100                    LDQ     MBLK$,,AUTO
         1 000102   000247 756100                    STQ     167,,PR0

      158     7564    3             PREV$=ADDR(NIL);

   7564  1 000103   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000104   200006 756100                    STQ     PREV$,,AUTO

      159     7565    3             P$=KQ$CG.IOQHD$;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:28   

   7565  1 000105   000261 236100                    LDQ     177,,PR0
         1 000106   200007 756100                    STQ     P$,,AUTO

      160     7566    3             IF KQ$DFRBLK.CODE~=%KQDC_WRITE THEN

   7566  1 000107   200011 471500                    LDP1    MBLK$,,AUTO
         1 000110   100001 236100                    LDQ     1,,PR1
         1 000111   777000 376003                    ANQ     -512,DU
         1 000112   006000 116003                    CMPQ    3072,DU
         1 000113   000155 600000 1                  TZE     s:7581

      161     7567    4               DO WHILE(P$~=ADDR(NIL));

   7567  1 000114   000152 710000 1                  TRA     s:7580

      162     7568    4               IF P$->KQ$DFRBLK.DA=KQ$DFRBLK.DA

   7568  1 000115   200007 470500                    LDP0    P$,,AUTO
         1 000116   200011 471500                    LDP1    MBLK$,,AUTO
         1 000117   000002 236100                    LDQ     2,,PR0
         1 000120   100002 116100                    CMPQ    2,,PR1
         1 000121   000146 601000 1                  TNZ     s:7578

      163     7569    5               THEN DO;

      164     7570    5                 KQ$CG.IOTL$->KQ$DFRBLK.LNK$=P$;

   7570  1 000122   200004 473500                    LDP3    CG$,,AUTO
         1 000123   300247 474500                    LDP4    167,,PR3
         1 000124   200007 236100                    LDQ     P$,,AUTO
         1 000125   400000 756100                    STQ     0,,PR4

      165     7571    5                 KQ$CG.IOTL$=P$;

   7571  1 000126   300247 756100                    STQ     167,,PR3

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:29   
      166     7572    5                 IF PREV$=ADDR(NIL)

   7572  1 000127   200006 236100                    LDQ     PREV$,,AUTO
         1 000130   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000131   000135 601000 1                  TNZ     s:7574

      167     7573    5                 THEN KQ$CG.IOQHD$=P$->KQ$DFRBLK.LNK$;

   7573  1 000132   000000 236100                    LDQ     0,,PR0
         1 000133   300261 756100                    STQ     177,,PR3
         1 000134   000140 710000 1                  TRA     s:7575

      168     7574    5                 ELSE PREV$->KQ$DFRBLK.LNK$=P$->KQ$DFRBLK.LNK$;

   7574  1 000135   000000 236100                    LDQ     0,,PR0
         1 000136   200006 471500                    LDP1    PREV$,,AUTO
         1 000137   100000 756100                    STQ     0,,PR1

      169     7575    5                 IF KQ$CG.IOQTL$=P$

   7575  1 000140   300262 236100                    LDQ     178,,PR3
         1 000141   200007 116100                    CMPQ    P$,,AUTO
         1 000142   000150 601000 1                  TNZ     s:7579

      170     7576    5                 THEN KQ$CG.IOQTL$=PREV$;

   7576  1 000143   200006 236100                    LDQ     PREV$,,AUTO
         1 000144   300262 756100                    STQ     178,,PR3

      171     7577    5                 END;

   7577  1 000145   000150 710000 1                  TRA     s:7579

      172     7578    4               ELSE PREV$=P$;

   7578  1 000146   200007 236100                    LDQ     P$,,AUTO
         1 000147   200006 756100                    STQ     PREV$,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:30   

      173     7579    4               P$=P$->KQ$DFRBLK.LNK$;

   7579  1 000150   000000 236100                    LDQ     0,,PR0
         1 000151   200007 756100                    STQ     P$,,AUTO

      174     7580    4               END;

   7580  1 000152   200007 236100                    LDQ     P$,,AUTO
         1 000153   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000154   000115 601000 1                  TNZ     s:7568

      175     7581    3             KQ$CG.IOTL$->KQ$DFRBLK.LNK$=ADDR(NIL);

   7581  1 000155   200004 470500                    LDP0    CG$,,AUTO
         1 000156   000247 471500                    LDP1    167,,PR0
         1 000157   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000160   100000 756100                    STQ     0,,PR1

      176     7582                  %UNLOCK (G=KQ$CG.DTREE.GATE);

   7583  1 000161   200004 236100                    LDQ     CG$,,AUTO
         1 000162   000231 036003                    ADLQ    153,DU
         1 000163   200020 756100                    STQ     RBLK$+1,,AUTO
         1 000164   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000166   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000167   000000 011000                    NOP     0

      177     7585    3             CALL KQD$STARTIO(KQ$CG,DFR$,STA$);

   7585  1 000170   200010 630500                    EPPR0   STA$,,AUTO
         1 000171   200022 450500                    STP0    RBLK$+3,,AUTO
         1 000172   200011 631500                    EPPR1   MBLK$,,AUTO
         1 000173   200021 451500                    STP1    RBLK$+2,,AUTO
         1 000174   200004 236100                    LDQ     CG$,,AUTO
         1 000175   200020 756100                    STQ     RBLK$+1,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:31   
         1 000176   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000177   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000200   000000 701000 xent               TSX1    KQD$STARTIO
         1 000201   000000 011000                    NOP     0

      178     7586    3             END;

   7586  1 000202   200004 470500                    LDP0    CG$,,AUTO
         1 000203   000261 236100                    LDQ     177,,PR0
         1 000204   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000205   000040 601000 1                  TNZ     s:7552

   7581  1 000206                       NOQENTS      null
      179     7587    2   NOQENTS:;
      180     7588        /**/
      181     7589    2           IF KQ$CG.DELAY THEN

   7589  1 000206   200004 470500                    LDP0    CG$,,AUTO
         1 000207   000020 235100                    LDA     16,,PR0
         1 000210   000230 600000 1                  TZE     s:7596

      182     7590    3             DO;

      183     7591    3             CALL WARN;

   7591  1 000211   000525 701000 1                  TSX1    WARN
         1 000212   000000 011000                    NOP     0

      184     7592    3             IF KQ$CG.DELAY.DDISC THEN CALL DDISC;

   7592  1 000213   200004 470500                    LDP0    CG$,,AUTO
         1 000214   000020 236100                    LDQ     16,,PR0
         1 000215   004000 316003                    CANQ    2048,DU
         1 000216   000221 600000 1                  TZE     s:7593

   7592  1 000217   001170 701000 1                  TSX1    DDISC
         1 000220   000000 011000                    NOP     0
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:32   

      185     7593    3             IF KQ$CG.DELAY.AU THEN

   7593  1 000221   200004 470500                    LDP0    CG$,,AUTO
         1 000222   000020 234100                    SZN     16,,PR0
         1 000223   000230 605000 1                  TPL     s:7596

      186     7594    3              CALL KCA$CLOCK (KQ$CG);

   7594  1 000224   200004 630500                    EPPR0   CG$,,AUTO
         1 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000226   000000 701000 xent               TSX1    KCA$CLOCK
         1 000227   000000 011000                    NOP     0

      187     7595    3             END;

      188     7596    2           IF SQUEEZEFLG~=0 THEN

   7596  1 000230   200005 235100                    LDA     SQUEEZEFLG,,AUTO
         1 000231   000236 600000 1                  TZE     s:7598

      189     7597    2            CALL KQD$SQUEEZE(KQ$CG);

   7597  1 000232   200004 630500                    EPPR0   CG$,,AUTO
         1 000233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000234   000000 701000 xent               TSX1    KQD$SQUEEZE
         1 000235   000000 011000                    NOP     0

      190     7598    2           IF KQ$CG.EOFTIMEHD$~=ADDR(NIL) THEN CALL CHKEOFTIME;

   7598  1 000236   200004 470500                    LDP0    CG$,,AUTO
         1 000237   000027 236100                    LDQ     23,,PR0
         1 000240   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000241   000244 600000 1                  TZE     s:7599

   7598  1 000242   001034 701000 1                  TSX1    CHKEOFTIME
         1 000243   000000 011000                    NOP     0
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:33   

      191     7599    2           IF KQ$CG.DPVGHD$ ~= ADDR(NIL) THEN CALL PVGET;

   7599  1 000244   200004 470500                    LDP0    CG$,,AUTO
         1 000245   000022 236100                    LDQ     18,,PR0
         1 000246   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000247   000252 600000 1                  TZE     s:7600

   7599  1 000250   000615 701000 1                  TSX1    PVGET
         1 000251   000000 011000                    NOP     0

      192     7600    2           IF KQ$CG.DGVGHD$ ~= ADDR(NIL) THEN CALL GVGET;

   7600  1 000252   200004 470500                    LDP0    CG$,,AUTO
         1 000253   000023 236100                    LDQ     19,,PR0
         1 000254   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000255   000260 600000 1                  TZE     s:7601

   7600  1 000256   000665 701000 1                  TSX1    GVGET
         1 000257   000000 011000                    NOP     0

      193     7601    2           IF KQ$CG.DFHD$ ~= ADDR(NIL) THEN CALL DFETCH;

   7601  1 000260   200004 470500                    LDP0    CG$,,AUTO
         1 000261   000024 236100                    LDQ     20,,PR0
         1 000262   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000263   000266 600000 1                  TZE     s:7602

   7601  1 000264   000725 701000 1                  TSX1    DFETCH
         1 000265   000000 011000                    NOP     0

      194     7602    2           IF KQ$CG.SRQHD$ ~= ADDR(NIL) THEN CALL SRQ;

   7602  1 000266   200004 470500                    LDP0    CG$,,AUTO
         1 000267   000021 236100                    LDQ     17,,PR0
         1 000270   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000271   000274 600000 1                  TZE     s:7603
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:34   

   7602  1 000272   001001 701000 1                  TSX1    SRQ
         1 000273   000000 011000                    NOP     0

      195     7603    2           IF KQ$CG.GARB.DELAY > 0 THEN CALL KQS$CLOCK (KQ$CG);

   7603  1 000274   200004 470500                    LDP0    CG$,,AUTO
         1 000275   000031 235100                    LDA     25,,PR0
         1 000276   000304 604400 1                  TMOZ    s:7604

   7603  1 000277   200004 630500                    EPPR0   CG$,,AUTO
         1 000300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000301   000000 701000 xent               TSX1    KQS$CLOCK
         1 000302   000000 011000                    NOP     0
         1 000303   000324 710000 1                  TRA     s:7613

      196     7604    2           ELSE IF KQ$CG.DELMSG$ ~= ADDR(NIL) THEN

   7604  1 000304   000114 236100                    LDQ     76,,PR0
         1 000305   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000306   000324 600000 1                  TZE     s:7613

      197     7605    2             IF KQ$CG.MMD.GIP = '0'B THEN

   7605  1 000307   000011 234100                    SZN     9,,PR0
         1 000310   000324 604000 1                  TMI     s:7613

      198     7606    3               DO;

      199     7607                    %LOCK (G=KQ$CG.MMD.GATE);

   7608  1 000311   200004 236100                    LDQ     CG$,,AUTO
         1 000312   000001 036003                    ADLQ    1,DU
         1 000313   200020 756100                    STQ     RBLK$+1,,AUTO
         1 000314   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000315   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000316   000000 701000 xent               TSX1    HFC$LOCK
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:35   
         1 000317   000000 011000                    NOP     0

      200     7610    3               CALL KQS$GARB (KQ$CG);

   7610  1 000320   200004 630500                    EPPR0   CG$,,AUTO
         1 000321   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000322   000000 701000 xent               TSX1    KQS$GARB
         1 000323   000000 011000                    NOP     0

      201     7611    3               END;

      202     7612        /**/
      203     7613    2           IF KQ$CG.BASEDELAY ~= 0 THEN CALL KCC$BASE;

   7613  1 000324   200004 470500                    LDP0    CG$,,AUTO
         1 000325   000025 235100                    LDA     21,,PR0
         1 000326   000332 600000 1                  TZE     NXTCG

   7613  1 000327   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000330   000373 701000 1                  TSX1    s:7650
         1 000331   000000 011000                    NOP     0

   7613  1 000332                       NXTCG        null
      204     7614    2   NXTCG:  ;
      205     7615    2           CG$=KQ$CG.LNK$;

   7615  1 000332   200004 470500                    LDP0    CG$,,AUTO
         1 000333   000104 236100                    LDQ     68,,PR0
         1 000334   200004 756100                    STQ     CG$,,AUTO

      206     7616    2           END;

   7616  1 000335   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000336   000017 601000 1                  TNZ     s:7544

      207     7617        /**/
      208     7618    1         IF KQ_LOG THEN
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:36   

   7618  1 000337   000000 235000 xsym               LDA     KQ_LOG
         1 000340   000350 600000 1                  TZE     s:7623

      209     7619    1          IF KQ_HDLOG$=ADDR(NIL) THEN

   7619  1 000341   000000 236000 xsym               LDQ     KQ_HDLOG$
         1 000342   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000343   000356 601000 1                  TNZ     s:7626

      210     7620    1           CALL KQZ$STARTLOG;

   7620  1 000344   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000345   000000 701000 xent               TSX1    KQZ$STARTLOG
         1 000346   000000 011000                    NOP     0
         1 000347   000356 710000 1                  TRA     s:7626

      211     7621    1          ELSE;
      212     7622    1         ELSE
      213     7623    1          IF KQ_HDLOG$~=ADDR(NIL) THEN

   7623  1 000350   000000 236000 xsym               LDQ     KQ_HDLOG$
         1 000351   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000352   000356 600000 1                  TZE     s:7626

      214     7624    1           CALL KQZ$STOPLOG;

   7624  1 000353   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000354   000000 701000 xent               TSX1    KQZ$STOPLOG
         1 000355   000000 011000                    NOP     0

      215     7625        /**/
      216     7626    1         CALL SSC$MONTIMR(KQ_MONTIMR,ENTADDR(KCC$CLOCK),0);

   7626  1 000356   000000 636000 1                  EAQ     s:32
         1 000357   200020 756100                    STQ     RBLK$+1,,AUTO
         1 000360   000000 236000 2                  LDQ     0
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:37   
         1 000361   200023 756100                    STQ     RBLK$+4,,AUTO
         1 000362   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000363   200022 450500                    STP0    RBLK$+3,,AUTO
         1 000364   000001 236000 2                  LDQ     1
         1 000365   200021 756100                    STQ     RBLK$+2,,AUTO
         1 000366   200021 630500                    EPPR0   RBLK$+2,,AUTO
         1 000367   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000370   000000 701000 xent               TSX1    SSC$MONTIMR
         1 000371   000000 011000                    NOP     0

      217     7627        /**/
      218     7628    1         RETURN;

   7628  1 000372   000000 702200 xent               TSX2  ! X66_ARET

      219     7629        %EJECT;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:38   
      220     7630        /**/
      221     7631        /*F* NAME:         KCC$BASE
      222     7632             PURPOSE:      To process deferred items for all comgroups
      223     7633             DESCRIPTION:  Sometimes a comgroup wants to perform an
      224     7634                           action but cannot due to fear that this
      225     7635                           would cause a gate to be locked twice.
      226     7636                           Examples are completing data cache get
      227     7637                           requests driven off data cache unlocks,
      228     7638                           and unblocking memory-REGed processes
      229     7639                           off memory release.
      230     7640
      231     7641                           In order to make this happen, the idle and
      232     7642                           interrupt-exit paths from the monitor check
      233     7643                           the cell KQ_BASEDELAY and call here if
      234     7644                           it is nonzero.  People who put themselves
      235     7645                           in this delay state increment BASEDELAY.
      236     7646                           What we do here is zap BASEDELAY and run
      237     7647                           thru the list of things which could be
      238     7648                           waiting, activating them if they are.
      239     7649        */
      240     7650    1   KCC$BASE: ENTRY;

   7650  1 000373   000000 700200 xent  KCC$BASE     TSX0  ! X66_AUTO_1
         1 000374   000024 000001                    ZERO    20,1

      241     7651        /**/
      242     7652    1         IF S_PNO ~= 0 THEN RETURN;

   7652  1 000375   000000 235000 xsym               LDA     S_PNO
         1 000376   000400 600000 1                  TZE     s:7653

   7652  1 000377   000000 702200 xent               TSX2  ! X66_ARET

      243     7653    2           DO WHILE (KQ_BASEDELAY ~= 0);

   7653  1 000400   000000 236000 xsym               LDQ     KQ_BASEDELAY
         1 000401   000500 600000 1                  TZE     s:7682
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:39   

      244     7654    2           KQ_BASEDELAY=0;

   7654  1 000402   000000 450000 xsym               STZ     KQ_BASEDELAY

      245     7655    2           CG$=KQ$MMSD.CGHEAD$;

   7655  1 000403   000000 470400 xsym               LDP0    KQ_MMSD$
         1 000404   000001 236100                    LDQ     1,,PR0
         1 000405   200004 756100                    STQ     CG$,,AUTO

      246     7656    3             DO WHILE (CG$ ~= ADDR(NIL));

   7656  1 000406   000474 710000 1                  TRA     s:7680

      247     7657    3             IF  KQ$CG.CLOCK

   7657  1 000407   200004 470500                    LDP0    CG$,,AUTO
         1 000410   000105 236100                    LDQ     69,,PR0
         1 000411   000004 316007                    CANQ    4,DL
         1 000412   000472 600000 1                  TZE     s:7679
         1 000413   000025 235100                    LDA     21,,PR0
         1 000414   000472 600000 1                  TZE     s:7679

      248     7658    3             AND KQ$CG.BASEDELAY ~= 0 THEN
      249     7659    4               DO;

      250     7660    4               CALL KQX$LDASR (KQ$CG);

   7660  1 000415   200004 630500                    EPPR0   CG$,,AUTO
         1 000416   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000417   000000 701000 xent               TSX1    KQX$LDASR
         1 000420   000000 011000                    NOP     0

      251     7661    5                 DO WHILE (KQ$CG.BASEDELAY ~= 0);

   7661  1 000421   200004 470500                    LDP0    CG$,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:40   
         1 000422   000025 235100                    LDA     21,,PR0
         1 000423   000472 600000 1                  TZE     s:7679

      252     7662    5                 KQ$CG.BASEDELAY=0;

   7662  1 000424   200004 470500                    LDP0    CG$,,AUTO
         1 000425   000025 450100                    STZ     21,,PR0

      253     7663        /**/
      254     7664    5                 IF KQ$CG.DFRDFR$ ~= ADDR(NIL) THEN

   7664  1 000426   000026 236100                    LDQ     22,,PR0
         1 000427   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000430   000435 600000 1                  TZE     s:7667

      255     7665    5                  CALL KQD$COMP (KQ$CG);

   7665  1 000431   200004 630500                    EPPR0   CG$,,AUTO
         1 000432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000433   000000 701000 xent               TSX1    KQD$COMP
         1 000434   000000 011000                    NOP     0

      256     7666        /**/
      257     7667    5                 CALL WARN;

   7667  1 000435   000525 701000 1                  TSX1    WARN
         1 000436   000000 011000                    NOP     0

      258     7668        /**/
      259     7669    5                 IF KQ$CG.DELAY.CGFULL THEN

   7669  1 000437   200004 470500                    LDP0    CG$,,AUTO
         1 000440   000020 236100                    LDQ     16,,PR0
         1 000441   020000 316003                    CANQ    8192,DU
         1 000442   000447 600000 1                  TZE     s:7672

      260     7670    5                  CALL KQS$DOFULL (KQ$CG);
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:41   

   7670  1 000443   200004 630500                    EPPR0   CG$,,AUTO
         1 000444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000445   000000 701000 xent               TSX1    KQS$DOFULL
         1 000446   000000 011000                    NOP     0

      261     7671        /**/
      262     7672    5                 IF KQ$CG.DELAY.NEEDPG THEN

   7672  1 000447   200004 470500                    LDP0    CG$,,AUTO
         1 000450   000020 236100                    LDQ     16,,PR0
         1 000451   040000 316003                    CANQ    16384,DU
         1 000452   000457 600000 1                  TZE     s:7675

      263     7673    5                  CALL KQD$NEEDPG (KQ$CG);

   7673  1 000453   200004 630500                    EPPR0   CG$,,AUTO
         1 000454   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000455   000000 701000 xent               TSX1    KQD$NEEDPG
         1 000456   000000 011000                    NOP     0

      264     7674        /**/
      265     7675    5                 IF KQ$CG.MMD.BASEREL$ ~= ADDR(NIL) THEN

   7675  1 000457   200004 470500                    LDP0    CG$,,AUTO
         1 000460   000012 236100                    LDQ     10,,PR0
         1 000461   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000462   000467 600000 1                  TZE     s:7677

      266     7676    5                  CALL KQM$BASEREL (KQ$CG);

   7676  1 000463   200004 630500                    EPPR0   CG$,,AUTO
         1 000464   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000465   000000 701000 xent               TSX1    KQM$BASEREL
         1 000466   000000 011000                    NOP     0

      267     7677    5                 END;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:42   

   7677  1 000467   200004 470500                    LDP0    CG$,,AUTO
         1 000470   000025 235100                    LDA     21,,PR0
         1 000471   000424 601000 1                  TNZ     s:7662

      268     7678    4               END;

      269     7679    3             CG$=KQ$CG.LNK$;

   7679  1 000472   000104 236100                    LDQ     68,,PR0
         1 000473   200004 756100                    STQ     CG$,,AUTO

      270     7680    3             END;

   7680  1 000474   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000475   000407 601000 1                  TNZ     s:7657

      271     7681    2           END;

   7681  1 000476   000000 235000 xsym               LDA     KQ_BASEDELAY
         1 000477   000402 601000 1                  TNZ     s:7654

      272     7682    1         RETURN;

   7682  1 000500   000000 702200 xent               TSX2  ! X66_ARET

      273     7683        /**/
      274     7684        /**/
      275     7685    1   GLOCK: PROC;

   7685  1 000501   200016 741300       GLOCK        STX1  ! FIRST+1,,AUTO

      276     7686        /**/
      277     7687        %LOCK (G=KQ$CG.GATE.CG);

   7688  1 000502   200004 236100                    LDQ     CG$,,AUTO
         1 000503   000107 036003                    ADLQ    71,DU
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:43   
         1 000504   200020 756100                    STQ     RBLK$+1,,AUTO
         1 000505   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000507   000000 701000 xent               TSX1    HFC$LOCK
         1 000510   000000 011000                    NOP     0

      278     7690    2         RETURN;

   7690  1 000511   200016 221300                    LDX1  ! FIRST+1,,AUTO
         1 000512   000001 702211                    TSX2  ! 1,X1

      279     7691    2   GUNLOCK: ENTRY;

   7691  1 000513   200016 741300       GUNLOCK      STX1  ! FIRST+1,,AUTO

      280     7692        /**/
      281     7693              %UNLOCK (G=KQ$CG.GATE.CG);

   7694  1 000514   200004 236100                    LDQ     CG$,,AUTO
         1 000515   000107 036003                    ADLQ    71,DU
         1 000516   200020 756100                    STQ     RBLK$+1,,AUTO
         1 000517   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000521   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000522   000000 011000                    NOP     0

      282     7696    2         RETURN;

   7696  1 000523   200016 221300                    LDX1  ! FIRST+1,,AUTO
         1 000524   000001 702211                    TSX2  ! 1,X1

      283     7697    2   END GLOCK;
      284     7698    1   WARN: PROC;

   7698  1 000525   200014 741300       WARN         STX1  ! KEY+2,,AUTO

      285     7699    2         IF KQ$CG.DELAY.MEMWARN THEN
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:44   

   7699  1 000526   200004 470500                    LDP0    CG$,,AUTO
         1 000527   000020 236100                    LDQ     16,,PR0
         1 000530   002000 316003                    CANQ    1024,DU
         1 000531   000553 600000 1                  TZE     NMW

      286     7700    3           DO;

      287     7701    3          CALL KCA$TELLAU (KQ$CG.GORGOSTA$->KQ$STA,%CG_WARN#,%CG_WARN_MEM#) ALTRET(NMW
              7701                    );

   7701  1 000532   000207 471500                    LDP1    135,,PR0
         1 000533   000002 236000 2                  LDQ     2
         1 000534   200022 756100                    STQ     RBLK$+3,,AUTO
         1 000535   000003 236000 2                  LDQ     3
         1 000536   200021 756100                    STQ     RBLK$+2,,AUTO
         1 000537   200020 451500                    STP1    RBLK$+1,,AUTO
         1 000540   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000541   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000542   000000 701000 xent               TSX1    KCA$TELLAU
         1 000543   000553 702000 1                  TSX2    NMW

      288     7702    3           CALL GLOCK;

   7702  1 000544   000501 701000 1                  TSX1    GLOCK
         1 000545   000000 011000                    NOP     0

      289     7703    3           KQ$CG.DELAY.MEMWARN='0'B;

   7703  1 000546   200004 470500                    LDP0    CG$,,AUTO
         1 000547   000004 236000 2                  LDQ     4
         1 000550   000020 356100                    ANSQ    16,,PR0

      290     7704    3           CALL GUNLOCK;

   7704  1 000551   000513 701000 1                  TSX1    GUNLOCK
         1 000552   000000 011000                    NOP     0
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:45   

      291     7705    3   NMW:    END;

   7705  1 000553                       NMW          null
      292     7706    2         IF KQ$CG.DELAY.DISKWARN THEN

   7706  1 000553   200004 470500                    LDP0    CG$,,AUTO
         1 000554   000020 430100                    FSZN    16,,PR0
         1 000555   000577 605000 1                  TPL     NDW

      293     7707    3           DO;

      294     7708    3           CALL KCA$TELLAU (KQ$CG.GORGOSTA$->KQ$STA,%CG_WARN#,%CG_WARN_DISK#) ALTRET(
              7708                    NDW);

   7708  1 000556   000207 471500                    LDP1    135,,PR0
         1 000557   000005 236000 2                  LDQ     5
         1 000560   200022 756100                    STQ     RBLK$+3,,AUTO
         1 000561   000003 236000 2                  LDQ     3
         1 000562   200021 756100                    STQ     RBLK$+2,,AUTO
         1 000563   200020 451500                    STP1    RBLK$+1,,AUTO
         1 000564   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000565   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000566   000000 701000 xent               TSX1    KCA$TELLAU
         1 000567   000577 702000 1                  TSX2    NDW

      295     7709    3           CALL GLOCK;

   7709  1 000570   000501 701000 1                  TSX1    GLOCK
         1 000571   000000 011000                    NOP     0

      296     7710    3           KQ$CG.DELAY.DISKWARN='0'B;

   7710  1 000572   200004 470500                    LDP0    CG$,,AUTO
         1 000573   000006 236000 2                  LDQ     6
         1 000574   000020 356100                    ANSQ    16,,PR0

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:46   
      297     7711    3           CALL GUNLOCK;

   7711  1 000575   000513 701000 1                  TSX1    GUNLOCK
         1 000576   000000 011000                    NOP     0

      298     7712    3   NDW:    END;

   7712  1 000577                       NDW          null
      299     7713    2   END WARN;

   7713  1 000577   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 000600   000001 702211                    TSX2  ! 1,X1

      300     7714        /**/
      301     7715        /*F* NAME:         KCC$RECOVER
      302     7716             PURPOSE:      To clean up clock stuff when a crashed comgroup
      303     7717                           is being re-opened.
      304     7718             CALL:         KCC$RECOVER (KQ$CG)
      305     7719             DESCRIPTION:  Resets clock-related goodies.
      306     7720        */
      307     7721    1   KCC$RECOVER: ENTRY (PARM);

   7721  1 000601   000000 700200 xent  KCC$RECOVER  TSX0  ! X66_AUTO_1
         1 000602   000024 000001                    ZERO    20,1

      308     7722        /**/
      309     7723    1         CG$=ADDR(PARM);

   7723  1 000603   200003 236100                    LDQ     @PARM,,AUTO
         1 000604   200004 756100                    STQ     CG$,,AUTO

      310     7724    1         KQ$CG.DPVGHD$=ADDR(NIL);

   7724  1 000605   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000606   200004 470500                    LDP0    CG$,,AUTO
         1 000607   000022 756100                    STQ     18,,PR0

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:47   
      311     7725    1         KQ$CG.DGVGHD$=ADDR(NIL);

   7725  1 000610   000023 756100                    STQ     19,,PR0

      312     7726    1         KQ$CG.DFHD$=ADDR(NIL);

   7726  1 000611   000024 756100                    STQ     20,,PR0

      313     7727    1         KQ$CG.SRQHD$=ADDR(NIL);

   7727  1 000612   000021 756100                    STQ     17,,PR0

      314     7728    1         KQ$CG.DELAY='0'B;

   7728  1 000613   000020 450100                    STZ     16,,PR0

      315     7729    1         RETURN;

   7729  1 000614   000000 702200 xent               TSX2  ! X66_ARET

      316     7730        %EJECT;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:48   
      317     7731        /***********************************************************
      318     7732        ************************************************************/
      319     7733        /*D* NAME:         PVGET
      320     7734             PURPOSE:      To re-try delayed PUT VGETs
      321     7735             DESCRIPTION:  Runs the chain of terminal stations waiting
      322     7736                           to do VGETs in KQP$PUT or disconnect, giving
      323     7737                           them a shot at it again.
      324     7738        */
      325     7739    1   PVGET: PROC;

   7739  1 000615   200014 741300       PVGET        STX1  ! KEY+2,,AUTO

      326     7740        /**/
      327     7741    2         KQ_STATS.DVGET=KQ_STATS.DVGET+1;

   7741  1 000616   000000 054000 xsym               AOS     KQ_STATS

      328     7742    2         CALL GLOCK;

   7742  1 000617   000501 701000 1                  TSX1    GLOCK
         1 000620   000000 011000                    NOP     0

      329     7743    2         STA$=KQ$CG.DPVGHD$;

   7743  1 000621   200004 470500                    LDP0    CG$,,AUTO
         1 000622   000022 236100                    LDQ     18,,PR0
         1 000623   200010 756100                    STQ     STA$,,AUTO

      330     7744    2         KQ$CG.DPVGHD$=ADDR(NIL);

   7744  1 000624   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000625   000022 756100                    STQ     18,,PR0

      331     7745    2         CALL GUNLOCK;

   7745  1 000626   000513 701000 1                  TSX1    GUNLOCK
         1 000627   000000 011000                    NOP     0
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:49   

      332     7746    3           DO WHILE (STA$ ~= ADDR(NIL));

   7746  1 000630   000660 710000 1                  TRA     s:7753

      333     7747    3           P$=STA$->KQ$STA.DPVGLNK$;

   7747  1 000631   200010 470500                    LDP0    STA$,,AUTO
         1 000632   000025 236100                    LDQ     21,,PR0
         1 000633   200007 756100                    STQ     P$,,AUTO

      334     7748    3           STA$->KQ$STA.DPVGLNK$=ADDR(NIL);

   7748  1 000634   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000635   000025 756100                    STQ     21,,PR0

      335     7749    3           IF STA$->KQ$STA.PVGSENSE = '0'B THEN

   7749  1 000636   000023 236100                    LDQ     19,,PR0
         1 000637   001000 316007                    CANQ    512,DL
         1 000640   000650 601000 1                  TNZ     s:7751

      336     7750    3            CALL KQP$DVGET (STA$->KQ$STA.LDCT$->NK$LDCT);

   7750  1 000641   000010 471500                    LDP1    8,,PR0
         1 000642   200020 451500                    STP1    RBLK$+1,,AUTO
         1 000643   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000644   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000645   000000 701000 xent               TSX1    KQP$DVGET
         1 000646   000000 011000                    NOP     0
         1 000647   000656 710000 1                  TRA     s:7752

      337     7751    3           ELSE CALL KQP$DSCGO (STA$->KQ$STA.LDCT$->NK$LDCT);

   7751  1 000650   000010 471500                    LDP1    8,,PR0
         1 000651   200020 451500                    STP1    RBLK$+1,,AUTO
         1 000652   200020 630500                    EPPR0   RBLK$+1,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:50   
         1 000653   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000654   000000 701000 xent               TSX1    KQP$DSCGO
         1 000655   000000 011000                    NOP     0

      338     7752    3           STA$=P$;

   7752  1 000656   200007 236100                    LDQ     P$,,AUTO
         1 000657   200010 756100                    STQ     STA$,,AUTO

      339     7753    3           END;

   7753  1 000660   200010 236100                    LDQ     STA$,,AUTO
         1 000661   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000662   000631 601000 1                  TNZ     s:7747

      340     7754    2         RETURN;

   7754  1 000663   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 000664   000001 702211                    TSX2  ! 1,X1

      341     7755    2   END PVGET;
      342     7756        /***********************************************************
      343     7757        ************************************************************/
      344     7758        /*D* NAME:         GVGET
      345     7759             PURPOSE:      To re-try delayed GET VGETs
      346     7760             DESCRIPTION:  Runs the chain of terminal stations waiting
      347     7761                           to do VGETs in KQG$GET, giving them a shot
      348     7762                           at it again.
      349     7763        */
      350     7764    1   GVGET: PROC;

   7764  1 000665   200014 741300       GVGET        STX1  ! KEY+2,,AUTO

      351     7765        /**/
      352     7766    2         CALL GLOCK;

   7766  1 000666   000501 701000 1                  TSX1    GLOCK
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:51   
         1 000667   000000 011000                    NOP     0

      353     7767    2         STA$=KQ$CG.DGVGHD$;

   7767  1 000670   200004 470500                    LDP0    CG$,,AUTO
         1 000671   000023 236100                    LDQ     19,,PR0
         1 000672   200010 756100                    STQ     STA$,,AUTO

      354     7768    2         KQ$CG.DGVGHD$=ADDR(NIL);

   7768  1 000673   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000674   000023 756100                    STQ     19,,PR0

      355     7769    2         CALL GUNLOCK;

   7769  1 000675   000513 701000 1                  TSX1    GUNLOCK
         1 000676   000000 011000                    NOP     0

      356     7770    3           DO WHILE (STA$ ~= ADDR(NIL));

   7770  1 000677   000720 710000 1                  TRA     s:7775

      357     7771    3           P$=STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DGVGLNK$;

   7771  1 000700   200010 470500                    LDP0    STA$,,AUTO
         1 000701   000011 471500                    LDP1    9,,PR0
         1 000702   100000 473500                    LDP3    0,,PR1
         1 000703   300000 236100                    LDQ     0,,PR3
         1 000704   200007 756100                    STQ     P$,,AUTO

      358     7772    3           STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DGVGLNK$=ADDR(NIL);

   7772  1 000705   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000706   300000 756100                    STQ     0,,PR3

      359     7773    3           CALL KQG$DVGET (STA$->KQ$STA.LDCT$->NK$LDCT);

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:52   
   7773  1 000707   200010 470500                    LDP0    STA$,,AUTO
         1 000710   000010 471500                    LDP1    8,,PR0
         1 000711   200020 451500                    STP1    RBLK$+1,,AUTO
         1 000712   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000713   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000714   000000 701000 xent               TSX1    KQG$DVGET
         1 000715   000000 011000                    NOP     0

      360     7774    3           STA$=P$;

   7774  1 000716   200007 236100                    LDQ     P$,,AUTO
         1 000717   200010 756100                    STQ     STA$,,AUTO

      361     7775    3           END;

   7775  1 000720   200010 236100                    LDQ     STA$,,AUTO
         1 000721   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000722   000700 601000 1                  TNZ     s:7771

      362     7776    2         RETURN;

   7776  1 000723   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 000724   000001 702211                    TSX2  ! 1,X1

      363     7777    2   END GVGET;
      364     7778        /***********************************************************
      365     7779        ************************************************************/
      366     7780        /*D* NAME:         DFETCH
      367     7781             PURPOSE:      To re-try delayed FETCHs
      368     7782             DESCRIPTION:  Runs the chain of stations waiting
      369     7783                           to do FETCHs, giving them a shot
      370     7784                           at it again.
      371     7785        */
      372     7786    1   DFETCH: PROC;

   7786  1 000725   200014 741300       DFETCH       STX1  ! KEY+2,,AUTO

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:53   
      373     7787        /**/
      374     7788    2         KQ_STATS.DFETCH=KQ_STATS.DFETCH+1;

   7788  1 000726   000001 054000 xsym               AOS     KQ_STATS+1

      375     7789    2         CALL GLOCK;

   7789  1 000727   000501 701000 1                  TSX1    GLOCK
         1 000730   000000 011000                    NOP     0

      376     7790    2         STA$=KQ$CG.DFHD$;

   7790  1 000731   200004 470500                    LDP0    CG$,,AUTO
         1 000732   000024 236100                    LDQ     20,,PR0
         1 000733   200010 756100                    STQ     STA$,,AUTO

      377     7791    2         KQ$CG.DFHD$=ADDR(NIL);

   7791  1 000734   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000735   000024 756100                    STQ     20,,PR0

      378     7792    2         CALL GUNLOCK;

   7792  1 000736   000513 701000 1                  TSX1    GUNLOCK
         1 000737   000000 011000                    NOP     0

      379     7793    3           DO WHILE (STA$ ~= ADDR(NIL));

   7793  1 000740   000774 710000 1                  TRA     s:7800

      380     7794    3           P$=STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DFLNK$;

   7794  1 000741   200010 470500                    LDP0    STA$,,AUTO
         1 000742   000011 471500                    LDP1    9,,PR0
         1 000743   100000 473500                    LDP3    0,,PR1
         1 000744   300000 236100                    LDQ     0,,PR3
         1 000745   200007 756100                    STQ     P$,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:54   

      381     7795    3           STA$->KQ$STA.RBLK$->KQ$RBLKT.MBLK$->KQ$MBLK.DFLNK$=ADDR(NIL);

   7795  1 000746   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000747   300000 756100                    STQ     0,,PR3

      382     7796    3           IF STA$->KQ$STA.TERM THEN

   7796  1 000750   200010 470500                    LDP0    STA$,,AUTO
         1 000751   000020 236100                    LDQ     16,,PR0
         1 000752   040000 316003                    CANQ    16384,DU
         1 000753   000763 600000 1                  TZE     s:7798

      383     7797    3            CALL KQG$DFETCH (STA$->KQ$STA.LDCT$->NK$LDCT);

   7797  1 000754   000010 471500                    LDP1    8,,PR0
         1 000755   200020 451500                    STP1    RBLK$+1,,AUTO
         1 000756   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000757   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000760   000000 701000 xent               TSX1    KQG$DFETCH
         1 000761   000000 011000                    NOP     0
         1 000762   000772 710000 1                  TRA     s:7799

      384     7798    3           ELSE CALL KQR$DFETCH (STA$->KQ$STA.LDCT$->NK$LDCT.IOQ$->N$REQ);

   7798  1 000763   000010 471500                    LDP1    8,,PR0
         1 000764   100001 473500                    LDP3    1,,PR1
         1 000765   200020 453500                    STP3    RBLK$+1,,AUTO
         1 000766   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 000767   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000770   000000 701000 xent               TSX1    KQR$DFETCH
         1 000771   000000 011000                    NOP     0

      385     7799    3           STA$=P$;

   7799  1 000772   200007 236100                    LDQ     P$,,AUTO
         1 000773   200010 756100                    STQ     STA$,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:55   

      386     7800    3           END;

   7800  1 000774   200010 236100                    LDQ     STA$,,AUTO
         1 000775   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000776   000741 601000 1                  TNZ     s:7794

      387     7801    2         RETURN;

   7801  1 000777   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 001000   000001 702211                    TSX2  ! 1,X1

      388     7802    2   END DFETCH;
      389     7803        /***********************************************************
      390     7804        ************************************************************/
      391     7805        /*D* NAME:         SRQ
      392     7806             PURPOSE:      To re-try super MBLK requests which failed for
      393     7807                           some reason.
      394     7808             DESCRIPTION:  The chain of super MBLKs waiting for this service
      395     7809                           is run, giving them all a shot at it.
      396     7810        */
      397     7811    1   SRQ:  PROC;

   7811  1 001001   200014 741300       SRQ          STX1  ! KEY+2,,AUTO

      398     7812        /**/
      399     7813    2         CALL GLOCK;

   7813  1 001002   000501 701000 1                  TSX1    GLOCK
         1 001003   000000 011000                    NOP     0

      400     7814    2         MBLK$=KQ$CG.SRQHD$;

   7814  1 001004   200004 470500                    LDP0    CG$,,AUTO
         1 001005   000021 236100                    LDQ     17,,PR0
         1 001006   200011 756100                    STQ     MBLK$,,AUTO

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:56   
      401     7815    2         KQ$CG.SRQHD$=ADDR(NIL);

   7815  1 001007   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001010   000021 756100                    STQ     17,,PR0

      402     7816    2         CALL GUNLOCK;

   7816  1 001011   000513 701000 1                  TSX1    GUNLOCK
         1 001012   000000 011000                    NOP     0

      403     7817    3           DO WHILE (MBLK$ ~= ADDR(NIL));

   7817  1 001013   001027 710000 1                  TRA     s:7822

      404     7818    3           P$=MBLK$->KQ$MBLK.XSP.SLNK$;

   7818  1 001014   200011 470500                    LDP0    MBLK$,,AUTO
         1 001015   000004 236100                    LDQ     4,,PR0
         1 001016   200007 756100                    STQ     P$,,AUTO

      405     7819    3           MBLK$->KQ$MBLK.XSP.SLNK$=ADDR(NIL);

   7819  1 001017   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001020   000004 756100                    STQ     4,,PR0

      406     7820    3           CALL KQL$SRQ (MBLK$->KQ$MBLK);

   7820  1 001021   200011 630500                    EPPR0   MBLK$,,AUTO
         1 001022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001023   000000 701000 xent               TSX1    KQL$SRQ
         1 001024   000000 011000                    NOP     0

      407     7821    3           MBLK$=P$;

   7821  1 001025   200007 236100                    LDQ     P$,,AUTO
         1 001026   200011 756100                    STQ     MBLK$,,AUTO

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:57   
      408     7822    3           END;

   7822  1 001027   200011 236100                    LDQ     MBLK$,,AUTO
         1 001030   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001031   001014 601000 1                  TNZ     s:7818

      409     7823    2         RETURN;

   7823  1 001032   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 001033   000001 702211                    TSX2  ! 1,X1

      410     7824    2   END SRQ;
      411     7825        /***********************************************************
      412     7826        ************************************************************/
      413     7827        /*D* NAME:           CHKEOFTIME
      414     7828             PURPOSE:        To time out any expired (via EOFTIME) DCB reads
      415     7829             DESCRIPTION:    The list of pending RBLKs which may be timed out
      416     7830                             is examined and any expired RBLKs are cancelled
      417     7831                             with EOF.
      418     7832        */
      419     7833    1   CHKEOFTIME: PROC;

   7833  1 001034   200014 741300       CHKEOFTIME   STX1  ! KEY+2,,AUTO

      420     7834        /**/
      421     7835    2   DCL FIRST BIT(1) ALIGNED;
      422     7836    2   DCL FOUND BIT(1) ALIGNED;
      423     7837    2   DCL RBLK$ PTR;
      424     7838    2         FIRST='1'B;

   7838  1 001035   400000 236003                    LDQ     -131072,DU
         1 001036   200015 756100                    STQ     FIRST,,AUTO

      425     7839    2         FOUND='0'B;

   7839  1 001037   200016 450100                    STZ     FOUND,,AUTO

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:58   
   7839  1 001040                       TOP          null
      426     7840    2   TOP:  ;
      427     7841              %LOCK(G=KQ$CG.STREE.GATE);

   7842  1 001040   200004 236100                    LDQ     CG$,,AUTO
         1 001041   000075 036003                    ADLQ    61,DU
         1 001042   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001043   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001045   000000 701000 xent               TSX1    HFC$LOCK
         1 001046   000000 011000                    NOP     0

      428     7844    2         IF KQ$CG.EOFTIMEHD$=ADDR(NIL) THEN GOTO XIT;

   7844  1 001047   200004 470500                    LDP0    CG$,,AUTO
         1 001050   000027 236100                    LDQ     23,,PR0
         1 001051   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001052   001111 600000 1                  TZE     XIT

      429     7845    2         IF FIRST THEN

   7845  1 001053   200015 234100                    SZN     FIRST,,AUTO
         1 001054   001061 605000 1                  TPL     s:7850

      430     7846    3           DO;

      431     7847    3           FIRST='0'B;

   7847  1 001055   200015 450100                    STZ     FIRST,,AUTO

      432     7848    3           KQ$CG.EOFTIME=KQ$CG.EOFTIME+1;

   7848  1 001056   000030 220100                    LDX0    24,,PR0
         1 001057   000001 621010                    EAX1    1,X0
         1 001060   000030 741100                    STX1    24,,PR0

      433     7849    3           END;
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:59   

      434     7850    2         IF KQ$CG.EOFTIMEHD$->KQ$RBLKD.EOFTIME<=KQ$CG.EOFTIME THEN

   7850  1 001061   000027 471500                    LDP1    23,,PR0
         1 001062   100017 720100                    LXL0    15,,PR1
         1 001063   000030 100100                    CMPX0   24,,PR0
         1 001064   001066 600000 1                  TZE     s:7852
         1 001065   001111 603000 1                  TRC     XIT

      435     7851    3           DO;

      436     7852    3           FOUND='1'B;

   7852  1 001066   400000 236003                    LDQ     -131072,DU
         1 001067   200016 756100                    STQ     FOUND,,AUTO

      437     7853    3           STA$=KQ$CG.EOFTIMEHD$->KQ$RBLKD.STA$;

   7853  1 001070   100012 236100                    LDQ     10,,PR1
         1 001071   200010 756100                    STQ     STA$,,AUTO

      438     7854                %UNLOCK(G=KQ$CG.STREE.GATE);

   7855  1 001072   200004 236100                    LDQ     CG$,,AUTO
         1 001073   000075 036003                    ADLQ    61,DU
         1 001074   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001075   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001077   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001100   000000 011000                    NOP     0

      439     7857    3           CALL KQC$ABTRD(STA$->KQ$STA,%TYC_EOF);

   7857  1 001101   000007 236000 2                  LDQ     7
         1 001102   200010 235100                    LDA     STA$,,AUTO
         1 001103   200020 757100                    STAQ    RBLK$+1,,AUTO
         1 001104   200020 630500                    EPPR0   RBLK$+1,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:60   
         1 001105   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001106   000000 701000 xent               TSX1    KQC$ABTRD
         1 001107   000000 011000                    NOP     0

      440     7858    3           GOTO TOP;

   7858  1 001110   001040 710000 1                  TRA     TOP

      441     7859    3           END;

   7859  1 001111                       XIT          null
      442     7860    2   XIT:  ;
      443     7861    2         IF FOUND THEN

   7861  1 001111   200016 234100                    SZN     FOUND,,AUTO
         1 001112   001157 605000 1                  TPL     s:7878

      444     7862    3           DO;

      445     7863    3           RBLK$=KQ$CG.EOFTIMEHD$;

   7863  1 001113   200017 756100                    STQ     RBLK$,,AUTO

      446     7864    4             DO WHILE(RBLK$~=ADDR(NIL));

   7864  1 001114   001152 710000 1                  TRA     s:7874

      447     7865    4             STA$=RBLK$->KQ$RBLKD.STA$;

   7865  1 001115   200017 470500                    LDP0    RBLK$,,AUTO
         1 001116   000012 236100                    LDQ     10,,PR0
         1 001117   200010 756100                    STQ     STA$,,AUTO

      448     7866                  %LOCK(G=STA$->KQ$STA.GATE);

   7867  1 001120   000016 036003                    ADLQ    14,DU
         1 001121   200020 756100                    STQ     RBLK$+1,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:61   
         1 001122   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001123   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001124   000000 701000 xent               TSX1    HFC$LOCK
         1 001125   000000 011000                    NOP     0

      449     7869    4             RBLK$->KQ$RBLKD.EOFTIME=RBLK$->KQ$RBLKD.EOFTIME-KQ$CG.EOFTIME;

   7869  1 001126   200004 470500                    LDP0    CG$,,AUTO
         1 001127   000030 236100                    LDQ     24,,PR0
         1 001130   000022 772000                    QRL     18
         1 001131   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001132   200017 471500                    LDP1    RBLK$,,AUTO
         1 001133   100017 236100                    LDQ     15,,PR1
         1 001134   777777 376007                    ANQ     -1,DL
         1 001135   200020 136100                    SBLQ    RBLK$+1,,AUTO
         1 001136   000000 620006                    EAX0    0,QL
         1 001137   100017 440100                    SXL0    15,,PR1

      450     7870                  %UNLOCK(G=STA$->KQ$STA.GATE);

   7871  1 001140   200010 236100                    LDQ     STA$,,AUTO
         1 001141   000016 036003                    ADLQ    14,DU
         1 001142   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001143   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001145   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001146   000000 011000                    NOP     0

      451     7873    4             RBLK$=RBLK$->KQ$RBLKD.EOFTIMELNK$;

   7873  1 001147   200017 470500                    LDP0    RBLK$,,AUTO
         1 001150   000010 236100                    LDQ     8,,PR0
         1 001151   200017 756100                    STQ     RBLK$,,AUTO

      452     7874    4             END;

   7874  1 001152   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:62   
         1 001153   001115 601000 1                  TNZ     s:7865

      453     7875    3           KQ$CG.EOFTIME=0;

   7875  1 001154   000000 220003                    LDX0    0,DU
         1 001155   200004 470500                    LDP0    CG$,,AUTO
         1 001156   000030 740100                    STX0    24,,PR0

      454     7876    3           END;

      455     7877              %UNLOCK(G=KQ$CG.STREE.GATE);

   7878  1 001157   200004 236100                    LDQ     CG$,,AUTO
         1 001160   000075 036003                    ADLQ    61,DU
         1 001161   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001162   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001163   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001164   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001165   000000 011000                    NOP     0

      456     7880    2         RETURN;

   7880  1 001166   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 001167   000001 702211                    TSX2  ! 1,X1

      457     7881    2   END CHKEOFTIME;
      458     7882        /***********************************************************
      459     7883        ************************************************************/
      460     7884        /*D* NAME:         DDISC
      461     7885             PURPOSE:      To continue delayed terminal disconnects
      462     7886             DESCRIPTION:  When KCO$DSCTRM needs to try a failed
      463     7887                           operation again, he sets DELAY.DDISC
      464     7888                           in KQ$CG, and DDISC in KQ$STA.  This
      465     7889                           routine finds all such stations and
      466     7890                           calls KCO$DDISC for them.
      467     7891                           This is also used to delay disconnects of
      468     7892                           KQ$STA.SAVLDCT$->NK$LDCT so that it also
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:63   
      469     7893                           runs off the clock thereby avoiding some
      470     7894                           collision possibilities.
      471     7895        */
      472     7896    1   DDISC: PROC;

   7896  1 001170   200014 741300       DDISC        STX1  ! KEY+2,,AUTO

      473     7897        /**/
      474     7898    2         CALL GLOCK;

   7898  1 001171   000501 701000 1                  TSX1    GLOCK
         1 001172   000000 011000                    NOP     0

      475     7899    2         KQ$CG.DELAY.DDISC='0'B;

   7899  1 001173   200004 470500                    LDP0    CG$,,AUTO
         1 001174   000010 236000 2                  LDQ     8
         1 001175   000020 356100                    ANSQ    16,,PR0

      476     7900    2         CALL GUNLOCK;

   7900  1 001176   000513 701000 1                  TSX1    GUNLOCK
         1 001177   000000 011000                    NOP     0

      477     7901              %LOCK (G=KQ$CG.STREE.GATE);

   7902  1 001200   200004 236100                    LDQ     CG$,,AUTO
         1 001201   000075 036003                    ADLQ    61,DU
         1 001202   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001203   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001204   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001205   000000 701000 xent               TSX1    HFC$LOCK
         1 001206   000000 011000                    NOP     0

      478     7904    2         STA$=KQ$CG.STREE.HEAD$;

   7904  1 001207   200004 470500                    LDP0    CG$,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:64   
         1 001210   000101 236100                    LDQ     65,,PR0
         1 001211   200010 756100                    STQ     STA$,,AUTO

      479     7905    3   D0:     DO WHILE (STA$ ~= ADDR(NIL));

   7905  1 001212   001262 710000 1     D0           TRA     s:7919

      480     7906    3           IF STA$->KQ$STA.DDISC ~= 0 THEN

   7906  1 001213   200010 470500                    LDP0    STA$,,AUTO
         1 001214   000023 236100                    LDQ     19,,PR0
         1 001215   140000 316007                    CANQ    49152,DL
         1 001216   001257 600000 1                  TZE     s:7918

      481     7907    4             DO;

      482     7908    4             KEY=STA$->KQ$STA.BTN.KEY;

   7908  1 001217   040100 100500                    MLR     fill='040'O
         1 001220   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 001221   200012 000010                    ADSC9   KEY,,AUTO                cn=0,n=8

      483     7909                  %UNLOCK (G=KQ$CG.STREE.GATE);

   7910  1 001222   200004 236100                    LDQ     CG$,,AUTO
         1 001223   000075 036003                    ADLQ    61,DU
         1 001224   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001225   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001227   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001230   000000 011000                    NOP     0

      484     7912    4             CALL KCO$DDISC (STA$->KQ$STA);

   7912  1 001231   200010 630500                    EPPR0   STA$,,AUTO
         1 001232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001233   000000 701000 xent               TSX1    KCO$DDISC
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:65   
         1 001234   000000 011000                    NOP     0

      485     7913                  %LOCK (G=KQ$CG.STREE.GATE);

   7914  1 001235   200004 236100                    LDQ     CG$,,AUTO
         1 001236   000075 036003                    ADLQ    61,DU
         1 001237   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001240   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001241   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001242   000000 701000 xent               TSX1    HFC$LOCK
         1 001243   000000 011000                    NOP     0

      486     7916    4             CALL KQB$SRCH (KQ$CG.STREE,KEY,STA$) ALTRET(D1);

   7916  1 001244   200010 630500                    EPPR0   STA$,,AUTO
         1 001245   200022 450500                    STP0    RBLK$+3,,AUTO
         1 001246   200012 631500                    EPPR1   KEY,,AUTO
         1 001247   200021 451500                    STP1    RBLK$+2,,AUTO
         1 001250   200004 236100                    LDQ     CG$,,AUTO
         1 001251   000075 036003                    ADLQ    61,DU
         1 001252   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001253   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001254   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001255   000000 701000 xent               TSX1    KQB$SRCH
         1 001256   001276 702000 1                  TSX2    D1

      487     7917    4             END;

      488     7918    3           STA$=STA$->KQ$STA.BTN.FLINK$;

   7918  1 001257   200010 470500                    LDP0    STA$,,AUTO
         1 001260   000004 236100                    LDQ     4,,PR0
         1 001261   200010 756100                    STQ     STA$,,AUTO

      489     7919    3           END;

   7919  1 001262   200010 236100                    LDQ     STA$,,AUTO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:66   
         1 001263   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001264   001213 601000 1                  TNZ     s:7906

      490     7920              %UNLOCK (G=KQ$CG.STREE.GATE);

   7921  1 001265   200004 236100                    LDQ     CG$,,AUTO
         1 001266   000075 036003                    ADLQ    61,DU
         1 001267   200020 756100                    STQ     RBLK$+1,,AUTO
         1 001270   200020 630500                    EPPR0   RBLK$+1,,AUTO
         1 001271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001272   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001273   000000 011000                    NOP     0

      491     7923    2         RETURN;

   7923  1 001274   200014 221300                    LDX1  ! KEY+2,,AUTO
         1 001275   000001 702211                    TSX2  ! 1,X1

      492     7924    2   D1:   IF STA$->KQ$STA.BTN.KEY <= KEY THEN

   7924  1 001276   200010 470500       D1           LDP0    STA$,,AUTO
         1 001277   040100 106500                    CMPC    fill='040'O
         1 001300   200012 000010                    ADSC9   KEY,,AUTO                cn=0,n=8
         1 001301   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 001302   001305 602000 1                  TNC     s:7926

      493     7925    2          STA$=STA$->KQ$STA.BTN.FLINK$;

   7925  1 001303   000004 236100                    LDQ     4,,PR0
         1 001304   200010 756100                    STQ     STA$,,AUTO

      494     7926    2         GOTO D0;

   7926  1 001305   001212 710000 1                  TRA     D0

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:67   
   0     000   004000 000000                                                    ....

(unnamed)
 Sect OctLoc
   2     000   000002 006000   000000 006000   000003 006000   000013 006000    ................
   2     004   775777 777777   000004 006000   776777 777777   000000 006000    ................
   2     010   773777 777777                                                    ....
      495     7927    2   END DDISC;
      496     7928        /**/
      497     7929    1   END KCC$CLOCK;

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:68   
--  Include file information  --

   KQ_SUBS_C.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_DATA_R.:E05TOU  is referenced.
   KQM_MAC_C.:E05TOU  is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure KCC$CLOCK.
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:69   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                      4-0-0/w PTR         r     1 CG$
    11-0-0/w PTR         r     1 DFR$                      15-0-0/w BIT         r     1 FIRST
    16-0-0/w BIT         r     1 FOUND                     12-0-0/c CHAR(8)     r     1 KEY
    11-0-0/w PTR         r     1 MBLK$                      7-0-0/w PTR         r     1 P$
    *0-0-0/w UBIN        r     1 PARM                       6-0-0/w PTR         r     1 PREV$
    17-0-0/w PTR         r     1 RBLK$                      5-0-0/w UBIN        r     1 SQUEEZEFLG
    10-0-0/w PTR         r     1 STA$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 KQ_BASEDELAY               0-0-0/w SBIN        r     1 KQ_CLKCNT
     0-0-0/w PTR         r     1 KQ_HDLOG$                  0-0-0/b STRC        r     1 KQ_LOG
     0-0-0/w PTR         r     1 KQ_MMSD$                   0-0-0/w UBIN        r     1 KQ_MONTIMR
     0-0-0/w SBIN        r     1 KQ_SQUEEZE                 0-0-0/w STRC(288)   r     1 KQ_STATS
     0-0-0/w UBIN        r     1 S_PNO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(6516)  r     1 KQ$CG                      0-0-0/d STRC(288)   r     1 KQ$DFRBLK
     0-0-0/d STRC(576)   r     1 KQ$MBLK                    0-0-0/d STRC(288)   r     1 KQ$MMSD
     0-0-0/d STRC(648)   r     1 KQ$RBLKD                   0-0-0/d STRC(504)   r     1 KQ$RBLKT
     0-0-0/d STRC(1296)  r     1 KQ$STA                     0-0-0/d STRC(1080)  r     1 N$REQ
     0-0-0/d STRC(864)   r     1 NK$LDCT

PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:70   

   Procedure KCC$CLOCK requires 710 words for executable code.
   Procedure KCC$CLOCK requires 20 words of local(AUTO) storage.

    No errors detected in file KCC$CLOCK.:E05TSI    .
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:71   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:72   
          MINI XREF LISTING

CG$
      7430**DCL      5529--IMP-PTR  7541<<ASSIGN   7543>>DOWHILE  7544>>IF       7546>>CALL     7548>>IF
      7549>>CALL     7551>>DOWHILE  7554>>CALL     7556>>ASSIGN   7557>>ASSIGN   7558>>IF       7559>>ASSIGN
      7560>>IF       7561>>ASSIGN   7562>>ASSIGN   7563>>ASSIGN   7565>>ASSIGN   7570>>ASSIGN   7571>>ASSIGN
      7573>>ASSIGN   7575>>IF       7576>>ASSIGN   7581>>ASSIGN   7583>>CALL     7585>>CALL     7589>>IF
      7592>>IF       7593>>IF       7594>>CALL     7597>>CALL     7598>>IF       7599>>IF       7600>>IF
      7601>>IF       7602>>IF       7603>>IF       7603>>CALL     7604>>IF       7605>>IF       7608>>CALL
      7610>>CALL     7613>>IF       7615<<ASSIGN   7615>>ASSIGN   7655<<ASSIGN   7656>>DOWHILE  7657>>IF
      7657>>IF       7660>>CALL     7661>>DOWHILE  7662>>ASSIGN   7664>>IF       7665>>CALL     7669>>IF
      7670>>CALL     7672>>IF       7673>>CALL     7675>>IF       7676>>CALL     7679<<ASSIGN   7679>>ASSIGN
      7688>>CALL     7694>>CALL     7699>>IF       7701>>CALL     7703>>ASSIGN   7706>>IF       7708>>CALL
      7710>>ASSIGN   7723<<ASSIGN   7724>>ASSIGN   7725>>ASSIGN   7726>>ASSIGN   7727>>ASSIGN   7728>>ASSIGN
      7743>>ASSIGN   7744>>ASSIGN   7767>>ASSIGN   7768>>ASSIGN   7790>>ASSIGN   7791>>ASSIGN   7814>>ASSIGN
      7815>>ASSIGN   7842>>CALL     7844>>IF       7848>>ASSIGN   7848>>ASSIGN   7850>>IF       7850>>IF
      7853>>ASSIGN   7855>>CALL     7863>>ASSIGN   7869>>ASSIGN   7875>>ASSIGN   7878>>CALL     7899>>ASSIGN
      7902>>CALL     7904>>ASSIGN   7910>>CALL     7914>>CALL     7916>>CALL     7921>>CALL
CHKEOFTIME
      7833**PROC     7598--CALL
D0 IN PROCEDURE DDISC
      7905**LABEL    7926--GOTO
D1 IN PROCEDURE DDISC
      7924**LABEL    7916--CALLALT
DDISC
      7896**PROC     7592--CALL
DFETCH
      7786**PROC     7601--CALL
DFR$
      7436**DCL      6312--IMP-PTR  7556<<ASSIGN   7557>>ASSIGN   7558>>IF       7561>>ASSIGN   7562>>ASSIGN
      7563>>ASSIGN   7566>>IF       7568>>IF       7585<>CALL
FIRST IN PROCEDURE CHKEOFTIME
      7835**DCL      7838<<ASSIGN   7845>>IF       7847<<ASSIGN
FOUND IN PROCEDURE CHKEOFTIME
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:73   
      7836**DCL      7839<<ASSIGN   7852<<ASSIGN   7861>>IF
GLOCK
      7685**PROC     7702--CALL     7709--CALL     7742--CALL     7766--CALL     7789--CALL     7813--CALL
      7898--CALL
GUNLOCK IN PROCEDURE GLOCK
      7691**ENTRY    7704--CALL     7711--CALL     7745--CALL     7769--CALL     7792--CALL     7816--CALL
      7900--CALL
GVGET
      7764**PROC     7600--CALL
HFC$LOCK
       590**DCL-ENT  7554--CALL     7608--CALL     7688--CALL     7842--CALL     7867--CALL     7902--CALL
      7914--CALL
HFC$UNLOCK
       590**DCL-ENT  7583--CALL     7694--CALL     7855--CALL     7871--CALL     7878--CALL     7910--CALL
      7921--CALL
KCA$CLOCK
      7443**DCL-ENT  7594--CALL
KCA$TELLAU
      7444**DCL-ENT  7701--CALL     7708--CALL
KCC$BASE
      7650**ENTRY    7613--CALL
KCC$CLOCK
        32**PROC     7626--CALL
KCO$DDISC
      7446**DCL-ENT  7912--CALL
KEY
      7437**DCL      7908<<ASSIGN   7916<>CALL     7924>>IF
KQ$CG
      5529**DCL      7546<>CALL     7549<>CALL     7585<>CALL     7594<>CALL     7597<>CALL     7603<>CALL
      7610<>CALL     7660<>CALL     7665<>CALL     7670<>CALL     7673<>CALL     7676<>CALL
KQ$CG.AUCTL.DVBYTE.REREAD
      5972**DCL      5973--REDEF
KQ$CG.BASEDELAY
      5639**DCL      7613>>IF       7657>>IF       7661>>DOWHILE  7662<<ASSIGN
KQ$CG.CLOCK
      5905**DCL      7544>>IF       7657>>IF
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:74   
KQ$CG.DELAY
      5592**DCL      7589>>IF       7728<<ASSIGN
KQ$CG.DELAY.AU
      5596**DCL      7593>>IF
KQ$CG.DELAY.CGFULL
      5606**DCL      7669>>IF
KQ$CG.DELAY.DDISC
      5610**DCL      7592>>IF       7899<<ASSIGN
KQ$CG.DELAY.DISKWARN
      5616**DCL      7706>>IF       7710<<ASSIGN
KQ$CG.DELAY.MEMWARN
      5613**DCL      7699>>IF       7703<<ASSIGN
KQ$CG.DELAY.NEEDPG
      5603**DCL      7672>>IF
KQ$CG.DELMSG$
      5925**DCL      7604>>IF
KQ$CG.DFHD$
      5634**DCL      7601>>IF       7726<<ASSIGN   7790>>ASSIGN   7791<<ASSIGN
KQ$CG.DFRDFR$
      5642**DCL      7664>>IF
KQ$CG.DGVGHD$
      5629**DCL      7600>>IF       7725<<ASSIGN   7767>>ASSIGN   7768<<ASSIGN
KQ$CG.DPVGHD$
      5623**DCL      7599>>IF       7724<<ASSIGN   7743>>ASSIGN   7744<<ASSIGN
KQ$CG.DTREE.GATE
      6114**DCL      7554<>CALL     7583<>CALL
KQ$CG.EOFTIME
      5650**DCL      7848<<ASSIGN   7848>>ASSIGN   7850>>IF       7869>>ASSIGN   7875<<ASSIGN
KQ$CG.EOFTIMEHD$
      5646**DCL      7598>>IF       7844>>IF       7850>>IF       7853>>ASSIGN   7863>>ASSIGN
KQ$CG.GARB.DELAY
      5664**DCL      7603>>IF
KQ$CG.GATE.CG
      5919**DCL      7688<>CALL     7694<>CALL
KQ$CG.GETFLG
      6084**DCL      7548>>IF
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:75   
KQ$CG.GORGOSTA$
      6028**DCL      7701>>CALL     7708>>CALL
KQ$CG.IOHD$
      6164**DCL      7561<<ASSIGN
KQ$CG.IOQHD$
      6244**DCL      7551>>DOWHILE  7556>>ASSIGN   7557<<ASSIGN   7565>>ASSIGN   7573<<ASSIGN
KQ$CG.IOQTL$
      6247**DCL      7558>>IF       7559<<ASSIGN   7575>>IF       7576<<ASSIGN
KQ$CG.IOTL$
      6167**DCL      7560>>IF       7562>>ASSIGN   7563<<ASSIGN   7570>>ASSIGN   7571<<ASSIGN   7581>>ASSIGN
KQ$CG.LNK$
      5893**DCL      7615>>ASSIGN   7679>>ASSIGN
KQ$CG.MMD.BASEREL$
      5573**DCL      7675>>IF
KQ$CG.MMD.GATE
      5540**DCL      7608<>CALL
KQ$CG.MMD.GIP
      5561**DCL      7605>>IF
KQ$CG.SRQHD$
      5620**DCL      7602>>IF       7727<<ASSIGN   7814>>ASSIGN   7815<<ASSIGN
KQ$CG.STREE
      5861**DCL      7916<>CALL
KQ$CG.STREE.GATE
      5863**DCL      7842<>CALL     7855<>CALL     7878<>CALL     7902<>CALL     7910<>CALL     7914<>CALL
      7921<>CALL
KQ$CG.STREE.HEAD$
      5871**DCL      7904>>ASSIGN
KQ$DFRBLK.CODE
      6315**DCL      7566>>IF
KQ$DFRBLK.DA
      6332**DCL      7568>>IF       7568>>IF
KQ$DFRBLK.DBLK$
      6334**DCL      6336--REDEF
KQ$DFRBLK.INFO
      6342**DCL      6344--REDEF
KQ$DFRBLK.LNK$
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:76   
      6313**DCL      7557>>ASSIGN   7562<<ASSIGN   7570<<ASSIGN   7573>>ASSIGN   7574<<ASSIGN   7574>>ASSIGN
      7579>>ASSIGN   7581<<ASSIGN
KQ$MBLK
      6734**DCL      7820<>CALL
KQ$MBLK.DFLNK$
      6744**DCL      7794>>ASSIGN   7795<<ASSIGN
KQ$MBLK.DGVGLNK$
      6748**DCL      7771>>ASSIGN   7772<<ASSIGN
KQ$MBLK.KEY1
      6762**DCL      6764--REDEF
KQ$MBLK.KEY2
      6771**DCL      6789--REDEF
KQ$MBLK.LNK$
      6736**DCL      6738--REDEF    6744--REDEF    6748--REDEF
KQ$MBLK.STA$
      6956**DCL      6959--REDEF    6963--REDEF
KQ$MBLK.USR
      6927**DCL      6932--REDEF
KQ$MBLK.XSP.MREQ$
      6791**DCL      6795--REDEF
KQ$MBLK.XSP.SLNK$
      6795**DCL      7818>>ASSIGN   7819<<ASSIGN
KQ$MMSD.CGHEAD$
      7348**DCL      7541>>ASSIGN   7655>>ASSIGN
KQ$RBLKD.BUF$
      6670**DCL      6672--REDEF
KQ$RBLKD.CNACTD
      6584**DCL      6593--REDEF
KQ$RBLKD.DBLKX
      6690**DCL      6694--REDEF
KQ$RBLKD.EOFNONE
      6562**DCL      6565--REDEF
KQ$RBLKD.EOFTIME
      6694**DCL      7850>>IF       7869<<ASSIGN   7869>>ASSIGN
KQ$RBLKD.EOFTIMELNK$
      6627**DCL      7873>>ASSIGN
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:77   
KQ$RBLKD.FROMQ
      6568**DCL      6571--REDEF
KQ$RBLKD.KEY1R
      6609**DCL      6610--REDEF
KQ$RBLKD.KEY2R
      6614**DCL      6615--REDEF
KQ$RBLKD.LATCH
      6557**DCL      6559--REDEF
KQ$RBLKD.LWRITES$
      6701**DCL      6705--REDEF
KQ$RBLKD.STA$
      6636**DCL      7853>>ASSIGN   7865>>ASSIGN
KQ$RBLKT.CNACTD
      6398**DCL      6407--REDEF
KQ$RBLKT.DBLK$
      6461**DCL      6465--REDEF    6468--REDEF
KQ$RBLKT.EOFNONE
      6376**DCL      6379--REDEF
KQ$RBLKT.FROMQ
      6382**DCL      6385--REDEF
KQ$RBLKT.KEY1R
      6423**DCL      6424--REDEF
KQ$RBLKT.KEY2R
      6428**DCL      6429--REDEF
KQ$RBLKT.LATCH
      6371**DCL      6373--REDEF
KQ$RBLKT.MBLK$
      6363**DCL      7771>>ASSIGN   7772>>ASSIGN   7794>>ASSIGN   7795>>ASSIGN
KQ$STA
      7005**DCL      7701<>CALL     7708<>CALL     7857<>CALL     7912<>CALL
KQ$STA.ACTTYC
      7057**DCL      7061--REDEF
KQ$STA.BTN.FLINK$
      7039**DCL      7918>>ASSIGN   7925>>ASSIGN
KQ$STA.BTN.KEY
      7041**DCL      7908>>ASSIGN   7924>>IF
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:78   
KQ$STA.DCBLNK$
      7064**DCL      7067--REDEF    7071--REDEF
KQ$STA.DDISC
      7169**DCL      7906>>IF
KQ$STA.DPVGLNK$
      7224**DCL      7747>>ASSIGN   7748<<ASSIGN
KQ$STA.EVCNT
      7150**DCL      7153--REDEF
KQ$STA.EVNT
      7116**DCL      7120--REDEF    7123--REDEF
KQ$STA.GATE
      7083**DCL      7867<>CALL     7871<>CALL
KQ$STA.LDCT$
      7046**DCL      7750>>CALL     7751>>CALL     7773>>CALL     7797>>CALL     7798>>CALL
KQ$STA.OPNBLKED
      7177**DCL      7180--REDEF
KQ$STA.OPNREJ
      7183**DCL      7185--REDEF
KQ$STA.PVGSENSE
      7200**DCL      7749>>IF
KQ$STA.RBLK$
      7048**DCL      7771>>ASSIGN   7772>>ASSIGN   7794>>ASSIGN   7795>>ASSIGN
KQ$STA.SUCCREAD
      7106**DCL      7110--REDEF
KQ$STA.TCOUNT
      7235**DCL      7241--REDEF
KQ$STA.TERM
      7101**DCL      7796>>IF
KQ$STA.VGOT$
      7220**DCL      7224--REDEF    7228--REDEF
KQB$SRCH
      7447**DCL-ENT  7916--CALL
KQC$ABTRD
      7448**DCL-ENT  7857--CALL
KQD$COMP
      7449**DCL-ENT  7665--CALL
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:79   
KQD$GETINIT
      7450**DCL-ENT  7549--CALL
KQD$NEEDPG
      7451**DCL-ENT  7673--CALL
KQD$SQUEEZE
      7452**DCL-ENT  7597--CALL
KQD$STARTIO
      7453**DCL-ENT  7585--CALL
KQG$DFETCH
      7454**DCL-ENT  7797--CALL
KQG$DVGET
      7455**DCL-ENT  7773--CALL
KQL$SRQ
      7456**DCL-ENT  7820--CALL
KQM$BASEREL
      7457**DCL-ENT  7676--CALL
KQP$DSCGO
      7458**DCL-ENT  7751--CALL
KQP$DVGET
      7459**DCL-ENT  7750--CALL
KQR$DFETCH
      7460**DCL-ENT  7798--CALL
KQS$CLOCK
      7461**DCL-ENT  7603--CALL
KQS$DOFULL
      7462**DCL-ENT  7670--CALL
KQS$GARB
      7463**DCL-ENT  7610--CALL
KQX$LDASR
      7464**DCL-ENT  7546--CALL     7660--CALL
KQZ$STARTLOG
      7465**DCL-ENT  7620--CALL
KQZ$STOPLOG
      7466**DCL-ENT  7624--CALL
KQ_BASEDELAY
      4204**DCL      7653>>DOWHILE  7654<<ASSIGN
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:80   
KQ_CLKCNT
      4209**DCL      7533<<ASSIGN   7533>>ASSIGN   7534>>IF       7536<<ASSIGN
KQ_HDLOG$
      4233**DCL      7619>>IF       7623>>IF
KQ_IMBLK.DVE.EOMCHAR
      4868**DCL      4870--REDEF
KQ_IMBLK.KEY1
      4794**DCL      4796--REDEF
KQ_IMBLK.KEY2
      4803**DCL      4821--REDEF
KQ_IMBLK.LNK$
      4768**DCL      4770--REDEF    4776--REDEF    4780--REDEF
KQ_IMBLK.TYC
      4917**DCL      4919--REDEF
KQ_IMBLK.XSP.MREQ$
      4823**DCL      4827--REDEF
KQ_IRBLK.BUF$
      4372**DCL      4374--REDEF
KQ_IRBLK.CNACTD
      4286**DCL      4295--REDEF
KQ_IRBLK.DBLKX
      4392**DCL      4396--REDEF
KQ_IRBLK.EOFNONE
      4264**DCL      4267--REDEF
KQ_IRBLK.FROMQ
      4270**DCL      4273--REDEF
KQ_IRBLK.KEY1R
      4311**DCL      4312--REDEF
KQ_IRBLK.KEY2R
      4316**DCL      4317--REDEF
KQ_IRBLK.LATCH
      4259**DCL      4261--REDEF
KQ_IRBLK.LWRITES$
      4403**DCL      4407--REDEF
KQ_IRBLKT.CNACTD
      4472**DCL      4481--REDEF
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:81   
KQ_IRBLKT.DBLK$
      4535**DCL      4539--REDEF    4542--REDEF
KQ_IRBLKT.EOFNONE
      4450**DCL      4453--REDEF
KQ_IRBLKT.FROMQ
      4456**DCL      4459--REDEF
KQ_IRBLKT.KEY1R
      4497**DCL      4498--REDEF
KQ_IRBLKT.KEY2R
      4502**DCL      4503--REDEF
KQ_IRBLKT.LATCH
      4445**DCL      4447--REDEF
KQ_LOG
      4219**DCL      7618>>IF
KQ_MMSD$
      7476**DCL      7343--IMP-PTR  7541>>ASSIGN   7655>>ASSIGN
KQ_MONTIMR
      4207**DCL      7626<>CALL
KQ_SQUEEZE
      4208**DCL      7534>>IF
KQ_STATS.DFETCH
      4213**DCL      7788<<ASSIGN   7788>>ASSIGN
KQ_STATS.DVGET
      4212**DCL      7741<<ASSIGN   7741>>ASSIGN
MBLK$
      7435**DCL      7436--REDEF    7814<<ASSIGN   7817>>DOWHILE  7818>>ASSIGN   7819>>ASSIGN   7820>>CALL
      7821<<ASSIGN
N$REQ
      7376**DCL      7798<>CALL
N$REQ.BUFADDR
      7385**DCL      7386--REDEF    7386--REDEF
N$REQ.DLA.DRELADDR
      7377**DCL      7377--REDEF
N$REQ.DVE.EOMCHAR
      7414**DCL      7415--REDEF
N$REQ.EAINFO
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:82   
      7408**DCL      7408--REDEF
N$REQ.EAINFOX
      7408**DCL      7409--REDEF
N$REQ.EVNTINFO
      7409**DCL      7409--REDEF
N$REQ.STATUS
      7390**DCL      7396--REDEF
NDW IN PROCEDURE WARN
      7712**LABEL    7708--CALLALT
NIQ$GETNR
      7467**DCL-ENT  7552--CALL
NK$LDCT
      6266**DCL      7750<>CALL     7751<>CALL     7773<>CALL     7797<>CALL
NK$LDCT.DDT$
      6268**DCL      6268--REDEF
NK$LDCT.IOQ$
      6267**DCL      6268--REDEF    7798>>CALL
NK$LDCT.LDCTX
      6269**DCL      6269--REDEF
NK$LDCT.LKFLG.ABORTED
      6281**DCL      6282--REDEF
NK$LDCT.RLCID.LDCTX
      6291**DCL      6291--REDEF
NK$LDCT.STA$
      6287**DCL      6288--REDEF
NK$LDCT.SYMB$
      6266**DCL      6266--REDEF    6266--REDEF    6267--REDEF
NMW IN PROCEDURE WARN
      7705**LABEL    7701--CALLALT
NOQENTS
      7581**LABEL    7552--CALLALT
NXTCG
      7613**LABEL    7545--GOTO
P$
      7433**DCL      7565<<ASSIGN   7567>>DOWHILE  7568>>IF       7570>>ASSIGN   7571>>ASSIGN   7573>>ASSIGN
      7574>>ASSIGN   7575>>IF       7578>>ASSIGN   7579<<ASSIGN   7579>>ASSIGN   7747<<ASSIGN   7752>>ASSIGN
PL6.E3A0      #001=KCC$CLOCK File=KCC$CLOCK.:E05TSI                              WED 07/30/97 00:10 Page:83   
      7771<<ASSIGN   7774>>ASSIGN   7794<<ASSIGN   7799>>ASSIGN   7818<<ASSIGN   7821>>ASSIGN
PARM
      5508**DCL        32--PROC     7721--ENTRY    7723--ASSIGN
PREV$
      7432**DCL      7564<<ASSIGN   7572>>IF       7574>>ASSIGN   7576>>ASSIGN   7578<<ASSIGN
PVGET
      7739**PROC     7599--CALL
RBLK$ IN PROCEDURE CHKEOFTIME
      7837**DCL      7863<<ASSIGN   7864>>DOWHILE  7865>>ASSIGN   7869>>ASSIGN   7869>>ASSIGN   7873<<ASSIGN
      7873>>ASSIGN
SQUEEZEFLG
      7431**DCL      7537<<ASSIGN   7540<<ASSIGN   7596>>IF
SRQ
      7811**PROC     7602--CALL
SSC$MONTIMR
      7468**DCL-ENT  7626--CALL
STA$
      7434**DCL      7552<>CALL     7585<>CALL     7743<<ASSIGN   7746>>DOWHILE  7747>>ASSIGN   7748>>ASSIGN
      7749>>IF       7750>>CALL     7751>>CALL     7752<<ASSIGN   7767<<ASSIGN   7770>>DOWHILE  7771>>ASSIGN
      7772>>ASSIGN   7773>>CALL     7774<<ASSIGN   7790<<ASSIGN   7793>>DOWHILE  7794>>ASSIGN   7795>>ASSIGN
      7796>>IF       7797>>CALL     7798>>CALL     7799<<ASSIGN   7853<<ASSIGN   7857>>CALL     7865<<ASSIGN
      7867>>CALL     7871>>CALL     7904<<ASSIGN   7905>>DOWHILE  7906>>IF       7908>>ASSIGN   7912>>CALL
      7916<>CALL     7918<<ASSIGN   7918>>ASSIGN   7924>>IF       7925<<ASSIGN   7925>>ASSIGN
S_PNO
      7475**DCL      7652>>IF
TOP IN PROCEDURE CHKEOFTIME
      7839**LABEL    7858--GOTO
WARN
      7698**PROC     7591--CALL     7667--CALL
XIT IN PROCEDURE CHKEOFTIME
      7859**LABEL    7844--GOTO
