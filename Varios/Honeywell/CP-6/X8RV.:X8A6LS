VERSION A06

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:1    
        1        1        /*M* X8RV$COMP_3_RECOVERY PIC S999: 0000 => 000+           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: X8RV$COMP_3_RECOVERY
        9        9
       10       10          PURPOSE: Recover from an Illegal EIS data abort.
       11       11
       12       12        */
       13       13        /*D*
       14       14             NAME: X8RV$COMP_3_RECOVERY
       15       15
       16       16          PURPOSE: Given the aborted instruction, the registers, and the pointer
       17       17                   registers at the time of the abort; determine if the instruction
       18       18                   is an EIS numeric instruction, and if one or more of the input
       19       19                   data items is signed packed decimal and the data is all low-value
       20       20                   then change the sign from '0000'B to '1011'B and retry the
       21       21                   instruction.  Also, if one or more of the input data items
       22       22                   is no-sign ASCII with an overpunched zero; change the "{"
       23       23                   (overpunched zero) to a zero.
       24       24                   This is done to be compatible to IBM hardware.
       25       25
       26       26             CALL: CALL X8RV$COMP_3_RECOVERY (Instruction, Registers,
       27       27                                              Ptr_registers) ;
       28       28                   WHENRETURN DO ; ... END ;
       29       29                   WHENALTRETURN DO ; ... END ;
       30       30
       31       31        PARAMETER: INSTRUCTION ..... The instruction that aborted.
       32       32                   REGISTERS ....... The A, Q, and XR's in SREG format.
       33       33                   PTR_REGISTERS ... Pointer Registers 0 thru 7.
       34       34
       35       35        INTERFACE: Calls internal routine CORRECTION.
       36       36
       37       37
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:2    
       38       38           OUTPUT: This routine ALTRETURNs if no correction is done.
       39       39
       40       40        */
       41       41
       42       42        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:3    
       43       43        /*=======================*/
       44       44        %INCLUDE Z9A_FLAGS;
       45       58        X8RV$COMP_3_RECOVERY: PROC (INSTRUCTION, REGISTERS, PTR_REGISTERS)
       46       59        %IF GCOS;
       48       61        %ENDIF;
       49       62                              ALTRET ;
       50       63        /*=======================*/
       51       64
       52       65    1   DCL 1   INSTRUCTION    ALIGNED,
       53       66    1        2  *              BIT (11) UNAL,
       54       67    1        2  MF2            BIT  (7) UNAL, /* Modifiers for operand#2 */
       55       68    1        2  OP_CODE        UBIN (9) UNAL,
       56       69    1        2  *              BIT  (2) UNAL,
       57       70    1        2  MF1            BIT  (7) UNAL, /* Modifiers for operand#1 */
       58       71    1        2  DESC1          UBIN WORD,     /* EIS descriptor for op#1 */
       59       72    1        2  DESC2          UBIN WORD;     /* EIS descriptor for op#2 */
       60       73
       61       74    1   DCL 1   REGISTERS      ALIGNED,
       62       75    1        2  XR (0: 7)      SBIN HALF UNAL, /* Index Registers 0 - 7 */
       63       76    1        2  A_REGISTER     SBIN WORD,
       64       77    1        2  Z              REDEF A_REGISTER,
       65       78    1         3 AU             SBIN HALF UNAL, /* A-Upper */
       66       79    1         3 AL             SBIN HALF UNAL, /* A-lower */
       67       80    1        2  Q_REGISTER     SBIN WORD,
       68       81    1        2  ZZ             REDEF Q_REGISTER,
       69       82    1         3 QU             SBIN HALF UNAL, /* Q-Upper */
       70       83    1         3 QL             SBIN HALF UNAL; /* Q-lower */
       71       84
       72       85    1   DCL 1   PTR_REGISTERS  ALIGNED,
       73       86    1        2  PR$ (0: 7)     PTR;
       74       87    1   DCL 1   MSG2 STATIC,
       75       88    1        2  *              CHAR (17) INIT (' '),
       76       89    1        2  DATA           CHAR (63) ;
       77       90
       78       91        %INCLUDE X8A_ERRCOM ;
       79      180        %INCLUDE Z8H_OPCODES ;
       80      683
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:4    
       81      684    1   DCL     TYPE           UBIN ;
       82      685
       83      686    1   DCL     CORRECTED      BIT (1) ALIGNED ;
       84      687    1   DCL     CORRECTED_1    BIT (1) ALIGNED ; /* Data field, not just sign */
       85      688
       86      689    1   DCL     X9MV$4TO9      ENTRY (3) ;
       87      690    1   DCL     X9MV$9TO4      ENTRY (3) ;
       88      691    1   DCL     X8ER$ERROR     ENTRY (3) ;
       89      692    1   DCL     X8CO$CONV_TO_OCTAL ENTRY (2) ;
       90      693
       91      694        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:5    
       92      695               /*======================*/
       93      696               /* X8RV$COMP_3_RECOVERY */
       94      697               /*======================*/
       95      698
       96      699    1          CORRECTED = '0'B ;
       97      700
       98      701    2          DO CASE (INSTRUCTION.OP_CODE) ;
       99      702
      100      703    2            CASE (%MVNE_OP, %MVN_OP, %DTB_OP) ;
      101      704
      102      705    2              TYPE = 0 ; /* One input operand, non-extended */
      103      706
      104      707    2            CASE (%MVNX_OP) ;
      105      708
      106      709    2              TYPE = 2 ; /* One input operand, extended numeric */
      107      710
      108      711    2            CASE (%AD2D_OP, %SB2D_OP, %MP2D_OP, %DV2D_OP, %CMPN_OP,
      109      712    2                  %AD3D_OP, %SB3D_OP, %MP3D_OP, %DV3D_OP) ;
      110      713
      111      714    2              TYPE = 1 ; /* Two input operands, non-extended */
      112      715
      113      716    2            CASE (%AD2DX_OP,%SB2DX_OP,%MP2DX_OP,%DV2DX_OP,%CMPNX_OP,
      114      717    2                  %AD3DX_OP,%SB3DX_OP,%MP3DX_OP,%DV3DX_OP) ;
      115      718
      116      719    2              TYPE = 3 ; /* Two input operands, extended numeric */
      117      720
      118      721    2          END ; /* Case of op-code */
      119      722
      120      723    2          DO CASE (TYPE) ;
      121      724
      122      725    2            CASE (0, 2) ; /* One input operand */
      123      726
      124      727    2              CALL CORRECTION (INSTRUCTION.DESC1, INSTRUCTION.MF1, TYPE)
      125      728    3              WHENRETURN DO ;
      126      729    3                CALL REPORT_CORRECTION ;
      127      730    3                RETURN ; /* Correction done -- retry instruction */
      128      731    3              END ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:6    
      129      732
      130      733    2            CASE (1, 3) ; /* Two input operands */
      131      734
      132      735    2              CALL CORRECTION (INSTRUCTION.DESC1, INSTRUCTION.MF1, TYPE)
      133      736    3              WHENRETURN DO ;
      134      737    3                CALL REPORT_CORRECTION ;
      135      738    3                CORRECTED = '1'B ; /* TRUE */
      136      739    3              END ;
      137      740
      138      741    2              CALL CORRECTION (INSTRUCTION.DESC2, INSTRUCTION.MF2, TYPE)
      139      742    3              WHENRETURN DO ;
      140      743    3                IF CORRECTED
      141      744    3                  THEN CALL REPORT_CORRECTION_1 ;
      142      745    3                  ELSE CALL REPORT_CORRECTION ;
      143      746    3                CORRECTED = '1'B ; /* TRUE */
      144      747    3              END ;
      145      748
      146      749    2          END ; /* Case of instruction type */
      147      750
      148      751    1          IF CORRECTED THEN
      149      752    1            RETURN ;
      150      753    1          ELSE
      151      754    1            ALTRETURN ;
      152      755
      153      756        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:7    
      154      757        /*=======*/
      155      758    1   CORRECTION: PROC (DESCR1, MF, TYPE) ALTRET ;
      156      759        /*=======*/
      157      760
      158      761    2   DCL DESCR1             BIT(36) ALIGNED;
      159      762
      160      763    2   DCL 1   DESCR          ALIGNED,        /* EIS Descriptor       */
      161      764    2        2  SA             UBIN HALF HALIGNED, /* Storage Address      */
      162      765    2        2  Z              REDEF SA,
      163      766    2         3 PR#            UBIN  (3) UNAL, /* Pointer Register No. */
      164      767    2         3 Y              SBIN (15) UNAL, /* Offset from PR value */
      165      768    2        2  CN             UBIN  (3) UNAL, /* Character Offset     */
      166      769    2        2  TN             BIT   (1) UNAL, /* 0 = 9-BIT, 1 = 4-BIT */
      167      770    2        2  S              UBIN  (2) UNAL, /* Sign Type            */
      168      771    2        2  SF             SBIN  (6) UNAL, /* Scale Factor         */
      169      772    2        2  N              UBIN  (6) UNAL; /* Length               */
      170      773
      171      774    2   DCL 1   IND_DESCR      REDEF DESCR,
      172      775    2        2  *              BIT (29),
      173      776    2        2  PR             BIT (1),
      174      777    2        2  REG            UBIN (6) UNAL;
      175      778
      176      779    2   DCL 1   MF             UNAL,           /* Operand Modifier     */
      177      780    2        2  PR             BIT   (1) UNAL, /* Pointer Register Md? */
      178      781    2        2  RL             BIT   (1) UNAL, /* Register Length Mod? */
      179      782    2        2  ID             BIT   (1) UNAL, /* Indirect Descriptor? */
      180      783    2        2  REG            UBIN  (4) UNAL; /* 5 = A, 6 = Q, 8 = X0 */
      181      784                                               /* 1 = AU,2 = QU,0 = N  */
      182      785    2   DCL     ASC_STR        CHAR (63) ;
      183      786    2   DCL     FIXED          BIT (1) ;
      184      787    2   DCL     BASED$PKD      BIT (1)   BASED (PTR$) ;
      185      788    2   DCL     ZEROES         CHAR (0) CONSTANT INIT
      186      789    2    ('000000000000000000000000000000000000000000000000000000000000000') ;
      187      790    2   DCL     BASED$ASC      CHAR (LENGTH) BASED (PTR$) ;
      188      791    2   DCL     OVP_PLUS       CHAR (10) CONSTANT INIT ('{ABCDEFGHI') ;
      189      792    2   DCL     OVP_MINUS      CHAR (10) CONSTANT INIT ('}JKLMNOPQR') ;
      190      793    2   DCL     X9OS$CLASS_NUMERIC (0:511) UBIN BYTE CALIGNED SYMREF READONLY ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:8    
      191      794
      192      795    2   DCL     TYPE           UBIN ;
      193      796
      194      797    2   DCL     PTR$           PTR ;
      195      798    2   DCL     LENGTH         SBIN ;
      196      799    2   DCL     L              SBIN ;
      197      800    2   DCL     S              SBIN ;
      198      801    2   DCL     N              SBIN ;
      199      802
      200      803        %EQU ASCII = '0'B ;      /* TN field */
      201      804
      202      805        %EQU LEADING_SIGN  = 1 ; /* S field */
      203      806        %EQU TRAILING_SIGN = 2 ;
      204      807        %EQU NO_SIGN       = 3 ;
      205      808
      206      809        %EQU N  =  0 ; /* MF.REG definitions */
      207      810        %EQU AU =  1 ;
      208      811        %EQU QU =  2 ;
      209      812        %EQU IC =  4 ;
      210      813        %EQU A  =  5 ;
      211      814        %EQU Q  =  6 ;
      212      815        %EQU X0 = BITBIN ('10'O) ;
      213      816        %EQU X1 = BITBIN ('11'O) ;
      214      817        %EQU X2 = BITBIN ('12'O) ;
      215      818        %EQU X3 = BITBIN ('13'O) ;
      216      819        %EQU X4 = BITBIN ('14'O) ;
      217      820        %EQU X5 = BITBIN ('15'O) ;
      218      821        %EQU X6 = BITBIN ('16'O) ;
      219      822        %EQU X7 = BITBIN ('17'O) ;
      220      823        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:9    
      221      824               /*============*/
      222      825               /* CORRECTION */
      223      826               /*============*/
      224      827
      225      828    2          DESCR = DESCR1;
      226      829    2          CORRECTED_1 = '0'B;
      227      830
      228      831    2          CALL SET_PTR (PTR$)
      229      832    3          WHENALTRETURN DO ; /* Can't set pointer */
      230      833    3            ALTRETURN ;
      231      834    3          END ;
      232      835
      233      836    3          IF MF.RL THEN DO CASE (DESCR.N);
      234      837
      235      838    3            CASE (%AU);
      236      839    3              LENGTH = REGISTERS.Z.AU;
      237      840
      238      841    3            CASE (%QU);
      239      842    3              LENGTH = REGISTERS.ZZ.QU;
      240      843
      241      844    3            CASE (%A);
      242      845    3              LENGTH = REGISTERS.Z.AL;
      243      846
      244      847    3            CASE (%Q);
      245      848    3              LENGTH = REGISTERS.ZZ.QL;
      246      849
      247      850    3            CASE (%X0);
      248      851    3              LENGTH = REGISTERS.XR (0);
      249      852
      250      853    3            CASE (%X1);
      251      854    3              LENGTH = REGISTERS.XR (1);
      252      855
      253      856    3            CASE (%X2);
      254      857    3              LENGTH = REGISTERS.XR (2);
      255      858
      256      859    3            CASE (%X3);
      257      860    3              LENGTH = REGISTERS.XR (3);
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:10   
      258      861
      259      862    3            CASE (%X4);
      260      863    3              LENGTH = REGISTERS.XR (4);
      261      864
      262      865    3            CASE (%X5);
      263      866    3              LENGTH = REGISTERS.XR (5);
      264      867
      265      868    3            CASE (%X6);
      266      869    3              LENGTH = REGISTERS.XR (6);
      267      870
      268      871    3            CASE (%X7);
      269      872    3              LENGTH = REGISTERS.XR (7);
      270      873
      271      874    3            CASE (ELSE);
      272      875    3              ALTRETURN;
      273      876
      274      877    3          END ; /* CASE of length register */
      275      878
      276      879    2          ELSE LENGTH = DESCR.N ;
      277      880
      278      881    3          IF DESCR.TN = %ASCII THEN DO ;
      279      882    3            CALL ASCII_CORRECTION
      280      883    4              WHENRETURN DO ;
      281      884    4                RETURN ;
      282      885    4              END ; /* When Return from Ascii_Correction */
      283      886    4              WHENALTRETURN DO ;
      284      887    4                ALTRETURN ;
      285      888    4              END ; /* When Alt Return from Ascii_Correction */
      286      889    3          END ; /* Ascii Descriptor */
      287      890
      288      891    2          FIXED = '0'B;
      289      892    2          CALL X9MV$4TO9 ( BASED$PKD, ASC_STR, LENGTH );
      290      893    2          MSG2.DATA = SUBSTR( ASC_STR, 0, LENGTH );
      291      894    3          DO CASE (DESCR.S); /* Sign type */
      292      895    3            CASE (%NO_SIGN);
      293      896    3              L = LENGTH;
      294      897    3              S = 0;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:11   
      295      898    3            CASE (%TRAILING_SIGN);
      296      899    3              L = LENGTH - 1;
      297      900    3              S = 0;
      298      901    3              IF SUBSTR (ASC_STR, L, 1) ~= '+' AND
      299      902    4                  SUBSTR (ASC_STR, L, 1) ~= '-' THEN DO;
      300      903    4                CALL INSERT (ASC_STR, L, 1, '+');
      301      904    4                FIXED = '1'B;
      302      905    4              END;
      303      906    3            CASE (%LEADING_SIGN);
      304      907    3              L = LENGTH - 1;
      305      908    3              S = 1;
      306      909    3              IF SUBSTR (ASC_STR, 0, 1) ~= '+' AND
      307      910    4                  SUBSTR (ASC_STR, 0, 1) ~= '-' THEN DO;
      308      911    4                CALL INSERT (ASC_STR,, 1, '+');
      309      912    4                FIXED = '1'B;
      310      913    4              END;
      311      914    3            CASE (ELSE); /* Float */
      312      915    3              ALTRETURN;
      313      916    3          END;
      314      917    3   FIX_DIGITS: DO;
      315      918    3            CALL INDEX (N, '+', SUBSTR (ASC_STR, S, L))
      316      919    4              WHENALTRETURN DO;
      317      920    4                CALL INDEX (N, '-', SUBSTR (ASC_STR, S, L))
      318      921    5                  WHENALTRETURN DO;
      319      922    5                    EXIT FIX_DIGITS;
      320      923    5                  END;
      321      924    4              END;
      322      925    3            CALL INSERT (ASC_STR, S, L, ZEROES);
      323      926    3            FIXED = '1'B;
      324      927    3            CORRECTED_1 = '1'B;
      325      928    3          END; /* FIX_DIGITS */
      326      929    2          IF NOT FIXED THEN ALTRETURN;
      327      930
      328      931    2          CALL X9MV$9TO4 (ASC_STR, BASED$PKD, LENGTH);
      329      932
      330      933    2          RETURN ;
      331      934
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:12   
      332      935        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:13   
      333      936        /*=====*/
      334      937    2   SET_PTR: PROC (PTR$) ALTRET ;
      335      938        /*=====*/
      336      939
      337      940        /* Inputs:  DESCR -- an EIS descriptor.
      338      941                    MF ----- the modifier (MF1, MF2, or MF3)
      339      942           Output:  PTR$ --- the pointer to the data
      340      943        */
      341      944
      342      945    3   DCL     PTR$           PTR ALIGNED ;
      343      946    3   DCL     OFFSET         UBIN;
      344      947    3   DCL     BASED$DESCR    BIT (36) ALIGNED BASED;
      345      948
      346      949    3   DCL     DIGITS         SBIN WORD ;
      347      950    3   DCL   1 DIGITS_ASCII   REDEF DIGITS,
      348      951    3         2 UNUSED         UBIN (16) UNAL,
      349      952    3         2 *              BIT (20);
      350      953    3   DCL 1 DIGITS_PACKED REDEF DIGITS,
      351      954    3         2 UNUSED         UBIN (15) UNAL,
      352      955    3         2 *              BIT (21);
      353      956
      354      957    3   DCL 1 OPERAND_DSCR     DALIGNED,
      355      958    3         2 *              BIT (21),
      356      959    3         2 WRITABLE       BIT (1),
      357      960    3         2 *              BIT (50);
      358      961        %IF CP6;
      359      962    3   DCL     ISR_PTR        BIT (36) CONSTANT INIT ('000000001762'O);
      360      963    3   DCL     ISR$           REDEF ISR_PTR PTR;
      361      964        %ENDIF;
      362      965        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:14   
      363      966               /*=========*/
      364      967               /* SET_PTR */
      365      968               /*=========*/
      366      969
      367      970    4          IF MF.ID THEN DO;
      368      971    4            IF NOT IND_DESCR.PR THEN
      369      972    4              ALTRETURN; /* Indirect descriptor in code segment, not expected in
      370      973                                 COBOL85. */
      371      974    4            PTR$ = PINCRW (PTR_REGISTERS.PR$ (DESCR.Z.PR#), DESCR.Z.Y);
      372      975
      373      976    5            DO CASE (IND_DESCR.REG);
      374      977
      375      978    5              CASE (%N);
      376      979    5                OFFSET = 0;
      377      980
      378      981    5              CASE (%AU);
      379      982    5                OFFSET = REGISTERS.Z.AU;
      380      983
      381      984    5              CASE (%QU);
      382      985    5                OFFSET = REGISTERS.ZZ.QU;
      383      986
      384      987    5              CASE (%A);
      385      988    5                OFFSET = REGISTERS.Z.AL;
      386      989
      387      990    5              CASE (%Q);
      388      991    5                OFFSET = REGISTERS.ZZ.QL;
      389      992
      390      993    5              CASE (%X0);
      391      994    5                OFFSET = REGISTERS.XR (0);
      392      995
      393      996    5              CASE (%X1);
      394      997    5                OFFSET = REGISTERS.XR (1);
      395      998
      396      999    5              CASE (%X2);
      397     1000    5                OFFSET = REGISTERS.XR (2);
      398     1001
      399     1002    5              CASE (%X3);
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:15   
      400     1003    5                OFFSET = REGISTERS.XR (3);
      401     1004
      402     1005    5              CASE (%X4);
      403     1006    5                OFFSET = REGISTERS.XR (4);
      404     1007
      405     1008    5              CASE (%X5);
      406     1009    5                OFFSET = REGISTERS.XR (5);
      407     1010
      408     1011    5              CASE (%X6);
      409     1012    5                OFFSET = REGISTERS.XR (6);
      410     1013
      411     1014    5              CASE (%X7);
      412     1015    5                OFFSET = REGISTERS.XR (7);
      413     1016
      414     1017    5              CASE (%IC, ELSE);
      415     1018    5                ALTRETURN; /* If IC then not patchable */
      416     1019
      417     1020    5            END; /* CASE */
      418     1021
      419     1022    4            DESCR = PINCRW (PTR$, OFFSET) -> BASED$DESCR;
      420     1023    4          END;
      421     1024
      422     1025    3          IF MF.REG = %IC THEN
      423     1026    3            ALTRETURN ; /*N* IC tag */
      424     1027
      425     1028               %IF GCOS;
      428     1031               %ELSE;
      429     1032    3          IF NOT MF.PR THEN /* No Pointer register modification */
      430     1033    3            PTR$ = PINCRW (ISR$, DESCR.SA) ;
      431     1034    3          ELSE
      432     1035
      433     1036               %ENDIF;
      434     1037    3          PTR$ = PTR_REGISTERS.PR$ (DESCR.Z.PR#) ;
      435     1038
      436     1039    3          OPERAND_DSCR = PTRDSCR (PTR$);
      437     1040    3          IF NOT OPERAND_DSCR.WRITABLE THEN
      438     1041    3            ALTRETURN; /* Operand in read-only storage */
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:16   
      439     1042
      440     1043               %IF CP6;
      441     1044    3          IF MF.PR THEN
      442     1045               %ENDIF;
      443     1046    3          PTR$ = PINCRW (PTR$, DESCR.Z.Y) ;
      444     1047
      445     1048    4          DO CASE (MF.REG) ;
      446     1049
      447     1050    4            CASE (%AU) ; DIGITS = REGISTERS.Z.AU ;
      448     1051    4            CASE (%QU) ; DIGITS = REGISTERS.ZZ.QU ;
      449     1052    4            CASE (%A)  ; DIGITS = REGISTERS.A_REGISTER ;
      450     1053    4                        IF DESCR.TN = %ASCII
      451     1054    4                          THEN DIGITS_ASCII.UNUSED = 0;
      452     1055    4                          ELSE DIGITS_PACKED.UNUSED = 0;
      453     1056    4            CASE (%Q)  ; DIGITS = REGISTERS.Q_REGISTER ;
      454     1057    4                        IF DESCR.TN = %ASCII
      455     1058    4                          THEN DIGITS_ASCII.UNUSED = 0;
      456     1059    4                          ELSE DIGITS_PACKED.UNUSED = 0;
      457     1060    4            CASE (%X0) ; DIGITS = REGISTERS.XR(0) ;
      458     1061    4            CASE (%X1) ; DIGITS = REGISTERS.XR(1) ;
      459     1062    4            CASE (%X2) ; DIGITS = REGISTERS.XR(2) ;
      460     1063    4            CASE (%X3) ; DIGITS = REGISTERS.XR(3) ;
      461     1064    4            CASE (%X4) ; DIGITS = REGISTERS.XR(4) ;
      462     1065    4            CASE (%X5) ; DIGITS = REGISTERS.XR(5) ;
      463     1066    4            CASE (%X6) ; DIGITS = REGISTERS.XR(6) ;
      464     1067    4            CASE (%X7) ; DIGITS = REGISTERS.XR(7) ;
      465     1068
      466     1069    4            CASE (%N)  ; /* No Register Modifier */
      467     1070    4              DIGITS = 0 ;
      468     1071
      469     1072    4            CASE (ELSE) ; /* Illegal MF.REG */
      470     1073    4              ALTRETURN ;
      471     1074
      472     1075    4          END ; /* Case of MF.REG */
      473     1076
      474     1077    3          IF DESCR.TN = %ASCII
      475     1078    3            THEN PTR$ = PINCRC (PTR$, (DIGITS + DESCR.CN));
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:17   
      476     1079
      477     1080    4          ELSE DO;
      478     1081
      479     1082    4            PTR$ = PINCRC (PTR$, (DIGITS + DESCR.CN) / 2) ;
      480     1083
      481     1084    4            IF MOD ((DIGITS + DESCR.CN), 2) = 1 THEN
      482     1085    4              PTR$ = PINCRB (PTR$, 5) ;
      483     1086    4          END;
      484     1087
      485     1088    3   END SET_PTR ;
      486     1089
      487     1090        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:18   
      488     1091        /*==================*/
      489     1092    2   OVERPUNCH_SIGN_CHECK: PROC (C, I, J) ;
      490     1093        /*==================*/
      491     1094
      492     1095    3   DCL     C CHAR (1) ;
      493     1096    3   DCL     I SBIN;
      494     1097    3   DCL     J SBIN;
      495     1098
      496     1099    3        CALL INDEX (I, C, OVP_PLUS)
      497     1100    4          WHENRETURN DO;
      498     1101    4            J = 1;
      499     1102    4          END;
      500     1103    4          WHENALTRETURN DO;
      501     1104    4            CALL INDEX (I, C, OVP_MINUS)
      502     1105    5              WHENRETURN DO;
      503     1106    5                J = -1;
      504     1107    5              END;
      505     1108    5              WHENALTRETURN DO;
      506     1109    5                J = 0;
      507     1110    5              END;
      508     1111    4          END;
      509     1112
      510     1113    3   END OVERPUNCH_SIGN_CHECK;
      511     1114
      512     1115        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:19   
      513     1116        /*================*/
      514     1117    2     ASCII_CORRECTION: PROC ALTRET ;
      515     1118        /*================*/
      516     1119
      517     1120    3   DCL     C              CHAR (1);
      518     1121
      519     1122    3          MSG2.DATA = BASED$ASC;
      520     1123    4          DO CASE (DESCR.S);
      521     1124    4            CASE (%NO_SIGN);
      522     1125    5              IF TYPE < 2 THEN DO; /* Genuine no sign */
      523     1126    5                CALL OVERPUNCH_SIGN_CHECK (SUBSTR (BASED$ASC, 0, 1), N, S);
      524     1127    6                IF S ~= 0 THEN DO;
      525     1128    6                  CALL BINCHAR (SUBSTR (BASED$ASC, 0, 1), N);
      526     1129    6                  FIXED = '1'B;
      527     1130    6                END;
      528     1131    5                CALL OVERPUNCH_SIGN_CHECK (SUBSTR (BASED$ASC, LENGTH - 1, 1), N, S);
      529     1132    6                IF S ~= 0 THEN DO;
      530     1133    6                  CALL BINCHAR (SUBSTR (BASED$ASC, LENGTH - 1, 1), N);
      531     1134    6                  FIXED = '1'B;
      532     1135    6                END;
      533     1136    5                CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, BASED$ASC)
      534     1137    6                  WHENRETURN DO;
      535     1138    6                    BASED$ASC = ZEROES;
      536     1139    6                    FIXED = '1'B;
      537     1140    6                    CORRECTED_1 = '1'B;
      538     1141    6                  END;
      539     1142    5              END;
      540     1143    5              ELSE DO; /* Overpunched trailing sign */
      541     1144    5                CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 0, LENGTH - 1
              1144                         ))
      542     1145    6                  WHENALTRETURN DO;
      543     1146    6                    C = SUBSTR (BASED$ASC, LENGTH - 1, 1);
      544     1147    7                    IF C >= '0' AND C <= '9' THEN DO;
      545     1148    7                      CALL CHARBIN (N, C);
      546     1149    7                      CALL INSERT (BASED$ASC, LENGTH - 1, 1, SUBSTR (OVP_PLUS, N, 1));
      547     1150    7                      RETURN; /* Data corrected */
      548     1151    7                    END;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:20   
      549     1152    6                    IF C >= 'A' AND C <= 'R' OR C = '{' OR C = '}'
      550     1153    6                      THEN ALTRETURN; /* There's nothing wrong with data */
      551     1154    6                  END;
      552     1155    5                BASED$ASC = ZEROES;
      553     1156    5                CALL INSERT (BASED$ASC, LENGTH - 1, 1, '{');
      554     1157    5                FIXED = '1'B;
      555     1158    5                    CORRECTED_1 = '1'B;
      556     1159    5              END;
      557     1160    4            CASE (%TRAILING_SIGN);
      558     1161    4              CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 0, LENGTH - 1))
      559     1162    5                WHENALTRETURN DO;
      560     1163    5                  IF SUBSTR (BASED$ASC, LENGTH - 1, 1) = '+' OR
      561     1164    5                      SUBSTR (BASED$ASC, LENGTH - 1, 1) = '-'
      562     1165    5                    THEN ALTRETURN; /* Data OK as is */
      563     1166    5                END;
      564     1167    4              BASED$ASC = ZEROES;
      565     1168    4              CALL INSERT (BASED$ASC, LENGTH - 1, 1, '+');
      566     1169    4              CORRECTED_1 = '1'B;
      567     1170    4              FIXED = '1'B;
      568     1171    4            CASE (%LEADING_SIGN);
      569     1172    4              CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 1, LENGTH - 1))
      570     1173    5                WHENALTRETURN DO;
      571     1174    6                  DO SELECT (SUBSTR (BASED$ASC, 0, 1));
      572     1175    6                    SELECT ('+', '-');
      573     1176    6                      ALTRETURN; /* Data OK */
      574     1177    6                    SELECT ('0', '{');
      575     1178    6                      CALL INSERT (BASED$ASC, 0, 1, '+');
      576     1179    6                      RETURN;
      577     1180    6                    SELECT ('}');
      578     1181    6                      CALL INSERT (BASED$ASC, 0, 1, '-');
      579     1182    6                      RETURN;
      580     1183    6                  END;
      581     1184    5                END;
      582     1185    4              CALL CONCAT (BASED$ASC, '+', ZEROES);
      583     1186    4              FIXED = '1'B;
      584     1187    4              CORRECTED_1 = '1'B;
      585     1188    4            CASE (ELSE);
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:21   
      586     1189    5              IF TYPE > 1 THEN DO; /* Overpunched leading sign */
      587     1190    5                CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 1, LENGTH - 1
              1190                         ))
      588     1191    6                  WHENALTRETURN DO;
      589     1192    6                    C = SUBSTR (BASED$ASC, 0, 1);
      590     1193    7                    IF C > '9' THEN DO;
      591     1194    7                      IF C >= 'A' AND C <= 'R' OR C = '{' OR C = '}'
      592     1195    7                        THEN ALTRETURN; /* Data OK */
      593     1196    7                    END;
      594     1197    7                    ELSE IF C >= '0' THEN DO;
      595     1198    7                      CALL CHARBIN (S, C);
      596     1199    7                      CALL INSERT (BASED$ASC, 0, 1, SUBSTR (OVP_PLUS, S, 1));
      597     1200    7                      RETURN; /* Data corrected */
      598     1201    7                    END;
      599     1202    7                    ELSE IF C = '+' THEN DO;
      600     1203    7                      CALL INSERT (BASED$ASC, 0, 1, '{');
      601     1204    7                      RETURN;
      602     1205    7                    END;
      603     1206    7                    ELSE IF C = '-' THEN DO;
      604     1207    7                      CALL INSERT (BASED$ASC, 0, 1, '}');
      605     1208    7                      RETURN;
      606     1209    7                    END;
      607     1210    6                  END;
      608     1211    5                CALL CONCAT (BASED$ASC, '{', ZEROES);
      609     1212    5                FIXED = '1'B;
      610     1213    5                CORRECTED_1 = '1'B;
      611     1214    5              END; /* LSF illegal */
      612     1215    4          END; /* CASE */
      613     1216    3          IF FIXED THEN RETURN;
      614     1217
      615     1218    3          ALTRETURN ; /* No Correction */
      616     1219
      617     1220    3   END ASCII_CORRECTION ;
      618     1221
      619     1222    2   END CORRECTION ;
      620     1223
      621     1224        %EJECT ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:22   
      622     1225        /*=================*/
      623     1226    1     REPORT_CORRECTION: PROC ;
      624     1227        /*=================*/
      625     1228
      626     1229    2   DCL 1   MSG1           STATIC,
      627     1230    2        2  ADDR1          CHAR (12),
      628     1231    2        2  *              CHAR (2) INIT (' '),
      629     1232    2        2  INST           CHAR (12),
      630     1233    2        2  *              CHAR (1) INIT (' '),
      631     1234    2        2  OPCODE         CHAR (5) ;
      632     1235    2   DCL     MSG1A          REDEF MSG1 CHAR (32) ;
      633     1236    2   DCL     IC$            PTR ;
      634     1237
      635     1238    2          IC$ = ADDR (INSTRUCTION) ;
      636     1239    2          CALL X8CO$CONV_TO_OCTAL( IC$, MSG1.ADDR1 ) ;
      637     1240    2          CALL X8CO$CONV_TO_OCTAL( INSTRUCTION, MSG1.INST ) ;
      638     1241    3          DO CASE (INSTRUCTION.OP_CODE) ;
      639     1242    3            CASE (%AD2D_OP) ;
      640     1243    3              MSG1.OPCODE = 'AD2D' ;
      641     1244    3            CASE (%AD2DX_OP) ;
      642     1245    3              MSG1.OPCODE = 'AD2DX' ;
      643     1246    3            CASE (%AD3D_OP) ;
      644     1247    3              MSG1.OPCODE = 'AD3D' ;
      645     1248    3            CASE (%AD3DX_OP) ;
      646     1249    3              MSG1.OPCODE = 'AD3DX' ;
      647     1250    3            CASE (%CMPN_OP) ;
      648     1251    3              MSG1.OPCODE = 'CMPN' ;
      649     1252    3            CASE (%CMPNX_OP) ;
      650     1253    3              MSG1.OPCODE = 'CMPNX' ;
      651     1254    3            CASE (%DTB_OP) ;
      652     1255    3              MSG1.OPCODE = 'DTB' ;
      653     1256    3            CASE (%DV2D_OP) ;
      654     1257    3              MSG1.OPCODE = 'DV2D' ;
      655     1258    3            CASE (%DV2DX_OP) ;
      656     1259    3              MSG1.OPCODE = 'DV2DX' ;
      657     1260    3            CASE (%DV3D_OP) ;
      658     1261    3              MSG1.OPCODE = 'DV3D' ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:23   
      659     1262    3            CASE (%DV3DX_OP) ;
      660     1263    3              MSG1.OPCODE = 'DV3DX' ;
      661     1264    3            CASE (%MP2D_OP) ;
      662     1265    3              MSG1.OPCODE = 'MP2D' ;
      663     1266    3            CASE (%MP2DX_OP) ;
      664     1267    3              MSG1.OPCODE = 'MP2DX' ;
      665     1268    3            CASE (%MP3D_OP) ;
      666     1269    3              MSG1.OPCODE = 'MP3D' ;
      667     1270    3            CASE (%MP3DX_OP) ;
      668     1271    3              MSG1.OPCODE = 'MP3DX' ;
      669     1272    3            CASE (%MVN_OP) ;
      670     1273    3              MSG1.OPCODE = 'MVN' ;
      671     1274    3            CASE (%MVNE_OP) ;
      672     1275    3              MSG1.OPCODE = 'MVNE' ;
      673     1276    3            CASE (%MVNX_OP) ;
      674     1277    3              MSG1.OPCODE = 'MVNX' ;
      675     1278    3            CASE (%SB2D_OP) ;
      676     1279    3              MSG1.OPCODE = 'SB2D' ;
      677     1280    3            CASE (%SB2DX_OP) ;
      678     1281    3              MSG1.OPCODE = 'SB2DX' ;
      679     1282    3            CASE (%SB3D_OP) ;
      680     1283    3              MSG1.OPCODE = 'SB3D' ;
      681     1284    3            CASE (%SB3DX_OP) ;
      682     1285    3              MSG1.OPCODE = 'SB3DX' ;
      683     1286    3          END ;
      684     1287    2          SPECIAL_ERR_MSG = MSG1A ;
      685     1288    2          CALL X8ER$ERROR( %ILLEGAL_EIS_DATA, SPECIAL_ERR_MSG ) ;
      686     1289
      687     1290        /*===================*/
      688     1291    2     REPORT_CORRECTION_1: ENTRY ; /* Report another bad operand */
      689     1292        /*===================*/
      690     1293
      691     1294    2          CALL X8ER$ERROR( %SPECIAL_MSG, MSG2, 80 ) ;
      692     1295    2          SPECIAL_ERR_MSG = 'Processing continued with' ;
      693     1296    2          IF CORRECTED_1
      694     1297    2            THEN CALL INSERT( SPECIAL_ERR_MSG, 26,, 'data field set to zero.' ) ;
      695     1298    2            ELSE CALL INSERT( SPECIAL_ERR_MSG, 26,, 'sign corrected.' ) ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:24   
      696     1299    2          CALL X8ER$ERROR( %SPECIAL_MSG, SPECIAL_ERR_MSG, 80 ) ;
      697     1300
      698     1301    2   END REPORT_CORRECTION ;
      699     1302
      700     1303    1   END X8RV$COMP_3_RECOVERY ;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:25   
--  Include file information  --

   Z8H_OPCODES.:Z8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure X8RV$COMP_3_RECOVERY.

   Procedure X8RV$COMP_3_RECOVERY requires 1543 words for executable code.
   Procedure X8RV$COMP_3_RECOVERY requires 68 words of local(AUTO) storage.

    No errors detected in file X8RV.:X8A6TSI    .

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:26   

 Object Unit name= X8RV$COMP_3_RECOVERY                       File name= X8RV.:X8A6TOU
 UTS= AUG 09 '97 10:52:06.32 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    28     34  X8RV$COMP_3_RECOVERY
    1  RoData even  UTS     71    107  X8RV$COMP_3_RECOVERY
    2   Proc  even  none  1543   3007  X8RV$COMP_3_RECOVERY
    3  RoData even  none    18     22  X8RV$COMP_3_RECOVERY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        3  X8RV$COMP_3_RECOVERY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 X9MV$9TO4
         yes           Std       3 X9MV$4TO9
         yes           Std       2 X8CO$CONV_TO_OCTAL
         yes           Std       3 X8ER$ERROR
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:27   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    X9OS$CLASS_NUMERIC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:28   


        1        1        /*M* X8RV$COMP_3_RECOVERY PIC S999: 0000 => 000+           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: X8RV$COMP_3_RECOVERY
        9        9
       10       10          PURPOSE: Recover from an Illegal EIS data abort.
       11       11
       12       12        */
       13       13        /*D*
       14       14             NAME: X8RV$COMP_3_RECOVERY
       15       15
       16       16          PURPOSE: Given the aborted instruction, the registers, and the pointer
       17       17                   registers at the time of the abort; determine if the instruction
       18       18                   is an EIS numeric instruction, and if one or more of the input
       19       19                   data items is signed packed decimal and the data is all low-value
       20       20                   then change the sign from '0000'B to '1011'B and retry the
       21       21                   instruction.  Also, if one or more of the input data items
       22       22                   is no-sign ASCII with an overpunched zero; change the "{"
       23       23                   (overpunched zero) to a zero.
       24       24                   This is done to be compatible to IBM hardware.
       25       25
       26       26             CALL: CALL X8RV$COMP_3_RECOVERY (Instruction, Registers,
       27       27                                              Ptr_registers) ;
       28       28                   WHENRETURN DO ; ... END ;
       29       29                   WHENALTRETURN DO ; ... END ;
       30       30
       31       31        PARAMETER: INSTRUCTION ..... The instruction that aborted.
       32       32                   REGISTERS ....... The A, Q, and XR's in SREG format.
       33       33                   PTR_REGISTERS ... Pointer Registers 0 thru 7.
       34       34
       35       35        INTERFACE: Calls internal routine CORRECTION.
       36       36
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:29   
       37       37
       38       38           OUTPUT: This routine ALTRETURNs if no correction is done.
       39       39
       40       40        */
       41       41
       42       42        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:30   
       43       43        /*=======================*/
       44       44        %INCLUDE Z9A_FLAGS;
       45       58        X8RV$COMP_3_RECOVERY: PROC (INSTRUCTION, REGISTERS, PTR_REGISTERS)

     58  2 000000   000000 700200 xent  X8RV$COMP_3* TSX0  ! X66_AUTO_3
         2 000001   000104 000003                    ZERO    68,3

       46       59        %IF GCOS;
       48       61        %ENDIF;
       49       62                              ALTRET ;
       50       63        /*=======================*/
       51       64
       52       65    1   DCL 1   INSTRUCTION    ALIGNED,
       53       66    1        2  *              BIT (11) UNAL,
       54       67    1        2  MF2            BIT  (7) UNAL, /* Modifiers for operand#2 */
       55       68    1        2  OP_CODE        UBIN (9) UNAL,
       56       69    1        2  *              BIT  (2) UNAL,
       57       70    1        2  MF1            BIT  (7) UNAL, /* Modifiers for operand#1 */
       58       71    1        2  DESC1          UBIN WORD,     /* EIS descriptor for op#1 */
       59       72    1        2  DESC2          UBIN WORD;     /* EIS descriptor for op#2 */
       60       73
       61       74    1   DCL 1   REGISTERS      ALIGNED,
       62       75    1        2  XR (0: 7)      SBIN HALF UNAL, /* Index Registers 0 - 7 */
       63       76    1        2  A_REGISTER     SBIN WORD,
       64       77    1        2  Z              REDEF A_REGISTER,
       65       78    1         3 AU             SBIN HALF UNAL, /* A-Upper */
       66       79    1         3 AL             SBIN HALF UNAL, /* A-lower */
       67       80    1        2  Q_REGISTER     SBIN WORD,
       68       81    1        2  ZZ             REDEF Q_REGISTER,
       69       82    1         3 QU             SBIN HALF UNAL, /* Q-Upper */
       70       83    1         3 QL             SBIN HALF UNAL; /* Q-lower */
       71       84
       72       85    1   DCL 1   PTR_REGISTERS  ALIGNED,
       73       86    1        2  PR$ (0: 7)     PTR;
       74       87    1   DCL 1   MSG2 STATIC,
       75       88    1        2  *              CHAR (17) INIT (' '),
       76       89    1        2  DATA           CHAR (63) ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:31   
       77       90
       78       91        %INCLUDE X8A_ERRCOM ;
       79      180        %INCLUDE Z8H_OPCODES ;
       80      683
       81      684    1   DCL     TYPE           UBIN ;
       82      685
       83      686    1   DCL     CORRECTED      BIT (1) ALIGNED ;
       84      687    1   DCL     CORRECTED_1    BIT (1) ALIGNED ; /* Data field, not just sign */
       85      688
       86      689    1   DCL     X9MV$4TO9      ENTRY (3) ;
       87      690    1   DCL     X9MV$9TO4      ENTRY (3) ;
       88      691    1   DCL     X8ER$ERROR     ENTRY (3) ;
       89      692    1   DCL     X8CO$CONV_TO_OCTAL ENTRY (2) ;
       90      693
       91      694        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:32   
       92      695               /*======================*/
       93      696               /* X8RV$COMP_3_RECOVERY */
       94      697               /*======================*/
       95      698
       96      699    1          CORRECTED = '0'B ;

    699  2 000002   200033 450100                    STZ     CORRECTED,,AUTO

       97      700
       98      701    2          DO CASE (INSTRUCTION.OP_CODE) ;

    701  2 000003   200003 470500                    LDP0    @INSTRUCTION,,AUTO
         2 000004   000000 236100                    LDQ     0,,PR0
         2 000005   000011 772000                    QRL     9
         2 000006   000777 376007                    ANQ     511,DL
         2 000007   000024 136007                    SBLQ    20,DL
         2 000010   000320 116007                    CMPQ    208,DL
         2 000011   000013 602006 2                  TNC     s:701+8,QL
         2 000012   000345 710000 2                  TRA     s:723
         2 000013   000333 710000 2                  TRA     s:705
         2 000014   000345 710000 2                  TRA     s:723
         2 000015   000345 710000 2                  TRA     s:723
         2 000016   000345 710000 2                  TRA     s:723
         2 000017   000345 710000 2                  TRA     s:723
         2 000020   000345 710000 2                  TRA     s:723
         2 000021   000345 710000 2                  TRA     s:723
         2 000022   000345 710000 2                  TRA     s:723
         2 000023   000345 710000 2                  TRA     s:723
         2 000024   000345 710000 2                  TRA     s:723
         2 000025   000345 710000 2                  TRA     s:723
         2 000026   000345 710000 2                  TRA     s:723
         2 000027   000345 710000 2                  TRA     s:723
         2 000030   000345 710000 2                  TRA     s:723
         2 000031   000345 710000 2                  TRA     s:723
         2 000032   000345 710000 2                  TRA     s:723
         2 000033   000345 710000 2                  TRA     s:723
         2 000034   000345 710000 2                  TRA     s:723
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:33   
         2 000035   000345 710000 2                  TRA     s:723
         2 000036   000345 710000 2                  TRA     s:723
         2 000037   000345 710000 2                  TRA     s:723
         2 000040   000345 710000 2                  TRA     s:723
         2 000041   000345 710000 2                  TRA     s:723
         2 000042   000345 710000 2                  TRA     s:723
         2 000043   000345 710000 2                  TRA     s:723
         2 000044   000345 710000 2                  TRA     s:723
         2 000045   000345 710000 2                  TRA     s:723
         2 000046   000345 710000 2                  TRA     s:723
         2 000047   000345 710000 2                  TRA     s:723
         2 000050   000345 710000 2                  TRA     s:723
         2 000051   000345 710000 2                  TRA     s:723
         2 000052   000345 710000 2                  TRA     s:723
         2 000053   000345 710000 2                  TRA     s:723
         2 000054   000345 710000 2                  TRA     s:723
         2 000055   000345 710000 2                  TRA     s:723
         2 000056   000345 710000 2                  TRA     s:723
         2 000057   000345 710000 2                  TRA     s:723
         2 000060   000345 710000 2                  TRA     s:723
         2 000061   000345 710000 2                  TRA     s:723
         2 000062   000345 710000 2                  TRA     s:723
         2 000063   000345 710000 2                  TRA     s:723
         2 000064   000345 710000 2                  TRA     s:723
         2 000065   000345 710000 2                  TRA     s:723
         2 000066   000345 710000 2                  TRA     s:723
         2 000067   000345 710000 2                  TRA     s:723
         2 000070   000345 710000 2                  TRA     s:723
         2 000071   000345 710000 2                  TRA     s:723
         2 000072   000345 710000 2                  TRA     s:723
         2 000073   000345 710000 2                  TRA     s:723
         2 000074   000345 710000 2                  TRA     s:723
         2 000075   000345 710000 2                  TRA     s:723
         2 000076   000345 710000 2                  TRA     s:723
         2 000077   000345 710000 2                  TRA     s:723
         2 000100   000345 710000 2                  TRA     s:723
         2 000101   000345 710000 2                  TRA     s:723
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:34   
         2 000102   000345 710000 2                  TRA     s:723
         2 000103   000345 710000 2                  TRA     s:723
         2 000104   000345 710000 2                  TRA     s:723
         2 000105   000345 710000 2                  TRA     s:723
         2 000106   000345 710000 2                  TRA     s:723
         2 000107   000345 710000 2                  TRA     s:723
         2 000110   000345 710000 2                  TRA     s:723
         2 000111   000345 710000 2                  TRA     s:723
         2 000112   000345 710000 2                  TRA     s:723
         2 000113   000345 710000 2                  TRA     s:723
         2 000114   000345 710000 2                  TRA     s:723
         2 000115   000345 710000 2                  TRA     s:723
         2 000116   000345 710000 2                  TRA     s:723
         2 000117   000345 710000 2                  TRA     s:723
         2 000120   000345 710000 2                  TRA     s:723
         2 000121   000345 710000 2                  TRA     s:723
         2 000122   000345 710000 2                  TRA     s:723
         2 000123   000345 710000 2                  TRA     s:723
         2 000124   000345 710000 2                  TRA     s:723
         2 000125   000345 710000 2                  TRA     s:723
         2 000126   000345 710000 2                  TRA     s:723
         2 000127   000345 710000 2                  TRA     s:723
         2 000130   000345 710000 2                  TRA     s:723
         2 000131   000345 710000 2                  TRA     s:723
         2 000132   000345 710000 2                  TRA     s:723
         2 000133   000345 710000 2                  TRA     s:723
         2 000134   000345 710000 2                  TRA     s:723
         2 000135   000345 710000 2                  TRA     s:723
         2 000136   000345 710000 2                  TRA     s:723
         2 000137   000345 710000 2                  TRA     s:723
         2 000140   000345 710000 2                  TRA     s:723
         2 000141   000345 710000 2                  TRA     s:723
         2 000142   000345 710000 2                  TRA     s:723
         2 000143   000345 710000 2                  TRA     s:723
         2 000144   000345 710000 2                  TRA     s:723
         2 000145   000345 710000 2                  TRA     s:723
         2 000146   000345 710000 2                  TRA     s:723
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:35   
         2 000147   000345 710000 2                  TRA     s:723
         2 000150   000345 710000 2                  TRA     s:723
         2 000151   000345 710000 2                  TRA     s:723
         2 000152   000345 710000 2                  TRA     s:723
         2 000153   000345 710000 2                  TRA     s:723
         2 000154   000345 710000 2                  TRA     s:723
         2 000155   000345 710000 2                  TRA     s:723
         2 000156   000345 710000 2                  TRA     s:723
         2 000157   000345 710000 2                  TRA     s:723
         2 000160   000345 710000 2                  TRA     s:723
         2 000161   000345 710000 2                  TRA     s:723
         2 000162   000345 710000 2                  TRA     s:723
         2 000163   000345 710000 2                  TRA     s:723
         2 000164   000345 710000 2                  TRA     s:723
         2 000165   000345 710000 2                  TRA     s:723
         2 000166   000345 710000 2                  TRA     s:723
         2 000167   000345 710000 2                  TRA     s:723
         2 000170   000345 710000 2                  TRA     s:723
         2 000171   000340 710000 2                  TRA     s:714
         2 000172   000340 710000 2                  TRA     s:714
         2 000173   000345 710000 2                  TRA     s:723
         2 000174   000345 710000 2                  TRA     s:723
         2 000175   000340 710000 2                  TRA     s:714
         2 000176   000340 710000 2                  TRA     s:714
         2 000177   000345 710000 2                  TRA     s:723
         2 000200   000345 710000 2                  TRA     s:723
         2 000201   000345 710000 2                  TRA     s:723
         2 000202   000345 710000 2                  TRA     s:723
         2 000203   000345 710000 2                  TRA     s:723
         2 000204   000345 710000 2                  TRA     s:723
         2 000205   000345 710000 2                  TRA     s:723
         2 000206   000345 710000 2                  TRA     s:723
         2 000207   000345 710000 2                  TRA     s:723
         2 000210   000345 710000 2                  TRA     s:723
         2 000211   000340 710000 2                  TRA     s:714
         2 000212   000340 710000 2                  TRA     s:714
         2 000213   000345 710000 2                  TRA     s:723
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:36   
         2 000214   000345 710000 2                  TRA     s:723
         2 000215   000340 710000 2                  TRA     s:714
         2 000216   000340 710000 2                  TRA     s:714
         2 000217   000345 710000 2                  TRA     s:723
         2 000220   000345 710000 2                  TRA     s:723
         2 000221   000345 710000 2                  TRA     s:723
         2 000222   000345 710000 2                  TRA     s:723
         2 000223   000345 710000 2                  TRA     s:723
         2 000224   000345 710000 2                  TRA     s:723
         2 000225   000345 710000 2                  TRA     s:723
         2 000226   000345 710000 2                  TRA     s:723
         2 000227   000345 710000 2                  TRA     s:723
         2 000230   000345 710000 2                  TRA     s:723
         2 000231   000343 710000 2                  TRA     s:719
         2 000232   000343 710000 2                  TRA     s:719
         2 000233   000345 710000 2                  TRA     s:723
         2 000234   000345 710000 2                  TRA     s:723
         2 000235   000343 710000 2                  TRA     s:719
         2 000236   000343 710000 2                  TRA     s:719
         2 000237   000345 710000 2                  TRA     s:723
         2 000240   000345 710000 2                  TRA     s:723
         2 000241   000345 710000 2                  TRA     s:723
         2 000242   000345 710000 2                  TRA     s:723
         2 000243   000345 710000 2                  TRA     s:723
         2 000244   000345 710000 2                  TRA     s:723
         2 000245   000345 710000 2                  TRA     s:723
         2 000246   000345 710000 2                  TRA     s:723
         2 000247   000345 710000 2                  TRA     s:723
         2 000250   000345 710000 2                  TRA     s:723
         2 000251   000343 710000 2                  TRA     s:719
         2 000252   000343 710000 2                  TRA     s:719
         2 000253   000345 710000 2                  TRA     s:723
         2 000254   000345 710000 2                  TRA     s:723
         2 000255   000343 710000 2                  TRA     s:719
         2 000256   000343 710000 2                  TRA     s:719
         2 000257   000345 710000 2                  TRA     s:723
         2 000260   000345 710000 2                  TRA     s:723
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:37   
         2 000261   000345 710000 2                  TRA     s:723
         2 000262   000345 710000 2                  TRA     s:723
         2 000263   000345 710000 2                  TRA     s:723
         2 000264   000345 710000 2                  TRA     s:723
         2 000265   000345 710000 2                  TRA     s:723
         2 000266   000345 710000 2                  TRA     s:723
         2 000267   000333 710000 2                  TRA     s:705
         2 000270   000345 710000 2                  TRA     s:723
         2 000271   000345 710000 2                  TRA     s:723
         2 000272   000340 710000 2                  TRA     s:714
         2 000273   000345 710000 2                  TRA     s:723
         2 000274   000333 710000 2                  TRA     s:705
         2 000275   000345 710000 2                  TRA     s:723
         2 000276   000345 710000 2                  TRA     s:723
         2 000277   000345 710000 2                  TRA     s:723
         2 000300   000345 710000 2                  TRA     s:723
         2 000301   000345 710000 2                  TRA     s:723
         2 000302   000345 710000 2                  TRA     s:723
         2 000303   000345 710000 2                  TRA     s:723
         2 000304   000345 710000 2                  TRA     s:723
         2 000305   000345 710000 2                  TRA     s:723
         2 000306   000345 710000 2                  TRA     s:723
         2 000307   000345 710000 2                  TRA     s:723
         2 000310   000345 710000 2                  TRA     s:723
         2 000311   000345 710000 2                  TRA     s:723
         2 000312   000345 710000 2                  TRA     s:723
         2 000313   000345 710000 2                  TRA     s:723
         2 000314   000345 710000 2                  TRA     s:723
         2 000315   000345 710000 2                  TRA     s:723
         2 000316   000345 710000 2                  TRA     s:723
         2 000317   000345 710000 2                  TRA     s:723
         2 000320   000345 710000 2                  TRA     s:723
         2 000321   000345 710000 2                  TRA     s:723
         2 000322   000345 710000 2                  TRA     s:723
         2 000323   000345 710000 2                  TRA     s:723
         2 000324   000345 710000 2                  TRA     s:723
         2 000325   000345 710000 2                  TRA     s:723
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:38   
         2 000326   000345 710000 2                  TRA     s:723
         2 000327   000335 710000 2                  TRA     s:709
         2 000330   000345 710000 2                  TRA     s:723
         2 000331   000345 710000 2                  TRA     s:723
         2 000332   000343 710000 2                  TRA     s:719

       99      702
      100      703    2            CASE (%MVNE_OP, %MVN_OP, %DTB_OP) ;

      101      704
      102      705    2              TYPE = 0 ; /* One input operand, non-extended */

    705  2 000333   200032 450100                    STZ     TYPE,,AUTO
         2 000334   000345 710000 2                  TRA     s:723

      103      706
      104      707    2            CASE (%MVNX_OP) ;

      105      708
      106      709    2              TYPE = 2 ; /* One input operand, extended numeric */

    709  2 000335   000002 235007                    LDA     2,DL
         2 000336   200032 755100                    STA     TYPE,,AUTO
         2 000337   000345 710000 2                  TRA     s:723

      107      710
      108      711    2            CASE (%AD2D_OP, %SB2D_OP, %MP2D_OP, %DV2D_OP, %CMPN_OP,

      109      712    2                  %AD3D_OP, %SB3D_OP, %MP3D_OP, %DV3D_OP) ;
      110      713
      111      714    2              TYPE = 1 ; /* Two input operands, non-extended */

    714  2 000340   000001 235007                    LDA     1,DL
         2 000341   200032 755100                    STA     TYPE,,AUTO
         2 000342   000345 710000 2                  TRA     s:723

      112      715
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:39   
      113      716    2            CASE (%AD2DX_OP,%SB2DX_OP,%MP2DX_OP,%DV2DX_OP,%CMPNX_OP,

      114      717    2                  %AD3DX_OP,%SB3DX_OP,%MP3DX_OP,%DV3DX_OP) ;
      115      718
      116      719    2              TYPE = 3 ; /* Two input operands, extended numeric */

    719  2 000343   000003 235007                    LDA     3,DL
         2 000344   200032 755100                    STA     TYPE,,AUTO

      117      720
      118      721    2          END ; /* Case of op-code */

      119      722
      120      723    2          DO CASE (TYPE) ;

    723  2 000345   200032 235100                    LDA     TYPE,,AUTO
         2 000346   000004 115007                    CMPA    4,DL
         2 000347   000351 602005 2                  TNC     s:723+4,AL
         2 000350   000434 710000 2                  TRA     s:751
         2 000351   000355 710000 2                  TRA     s:727
         2 000352   000373 710000 2                  TRA     s:735
         2 000353   000355 710000 2                  TRA     s:727
         2 000354   000373 710000 2                  TRA     s:735

      121      724
      122      725    2            CASE (0, 2) ; /* One input operand */

      123      726
      124      727    2              CALL CORRECTION (INSTRUCTION.DESC1, INSTRUCTION.MF1, TYPE)

    727  2 000355   200032 631500                    EPPR1   TYPE,,AUTO
         2 000356   200041 451500                    STP1    @MF+1,,AUTO
         2 000357   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 000360   620000 036007                    ADLQ    -57344,DL
         2 000361   200040 756100                    STQ     IC$+1,,AUTO
         2 000362   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 000363   000001 036003                    ADLQ    1,DU
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:40   
         2 000364   200037 756100                    STQ     CORRECTED_1+3,,AUTO
         2 000365   000440 701000 2                  TSX1    CORRECTION
         2 000366   000372 702000 2                  TSX2    s:730+1

      125      728    3              WHENRETURN DO ;

      126      729    3                CALL REPORT_CORRECTION ;

    729  2 000367   002235 701000 2                  TSX1    REPORT_CORRECTION
         2 000370   000000 011000                    NOP     0

      127      730    3                RETURN ; /* Correction done -- retry instruction */

    730  2 000371   000000 702200 xent               TSX2  ! X66_ARET
         2 000372   000434 710000 2                  TRA     s:751

      128      731    3              END ;
      129      732
      130      733    2            CASE (1, 3) ; /* Two input operands */

      131      734
      132      735    2              CALL CORRECTION (INSTRUCTION.DESC1, INSTRUCTION.MF1, TYPE)

    735  2 000373   200032 631500                    EPPR1   TYPE,,AUTO
         2 000374   200041 451500                    STP1    @MF+1,,AUTO
         2 000375   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 000376   620000 036007                    ADLQ    -57344,DL
         2 000377   200040 756100                    STQ     IC$+1,,AUTO
         2 000400   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 000401   000001 036003                    ADLQ    1,DU
         2 000402   200037 756100                    STQ     CORRECTED_1+3,,AUTO
         2 000403   000440 701000 2                  TSX1    CORRECTION
         2 000404   000411 702000 2                  TSX2    s:741

      133      736    3              WHENRETURN DO ;

      134      737    3                CALL REPORT_CORRECTION ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:41   

    737  2 000405   002235 701000 2                  TSX1    REPORT_CORRECTION
         2 000406   000000 011000                    NOP     0

      135      738    3                CORRECTED = '1'B ; /* TRUE */

    738  2 000407   400000 236003                    LDQ     -131072,DU
         2 000410   200033 756100                    STQ     CORRECTED,,AUTO

      136      739    3              END ;

      137      740
      138      741    2              CALL CORRECTION (INSTRUCTION.DESC2, INSTRUCTION.MF2, TYPE)

    741  2 000411   200032 630500                    EPPR0   TYPE,,AUTO
         2 000412   200041 450500                    STP0    @MF+1,,AUTO
         2 000413   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 000414   220000 036007                    ADLQ    73728,DL
         2 000415   200040 756100                    STQ     IC$+1,,AUTO
         2 000416   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 000417   000002 036003                    ADLQ    2,DU
         2 000420   200037 756100                    STQ     CORRECTED_1+3,,AUTO
         2 000421   000440 701000 2                  TSX1    CORRECTION
         2 000422   000434 702000 2                  TSX2    s:751

      139      742    3              WHENRETURN DO ;

      140      743    3                IF CORRECTED

    743  2 000423   200033 234100                    SZN     CORRECTED,,AUTO
         2 000424   000430 605000 2                  TPL     s:745

      141      744    3                  THEN CALL REPORT_CORRECTION_1 ;

    744  2 000425   002752 701000 2                  TSX1    REPORT_CORRECTION_1
         2 000426   000000 011000                    NOP     0
         2 000427   000432 710000 2                  TRA     s:746
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:42   

      142      745    3                  ELSE CALL REPORT_CORRECTION ;

    745  2 000430   002235 701000 2                  TSX1    REPORT_CORRECTION
         2 000431   000000 011000                    NOP     0

      143      746    3                CORRECTED = '1'B ; /* TRUE */

    746  2 000432   400000 236003                    LDQ     -131072,DU
         2 000433   200033 756100                    STQ     CORRECTED,,AUTO

      144      747    3              END ;

      145      748
      146      749    2          END ; /* Case of instruction type */

      147      750
      148      751    1          IF CORRECTED THEN

    751  2 000434   200033 234100                    SZN     CORRECTED,,AUTO
         2 000435   000437 605000 2                  TPL     s:754

      149      752    1            RETURN ;

    752  2 000436   000000 702200 xent               TSX2  ! X66_ARET

      150      753    1          ELSE
      151      754    1            ALTRETURN ;

    754  2 000437   000000 702200 xent               TSX2  ! X66_AALT

      152      755
      153      756        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:43   
      154      757        /*=======*/
      155      758    1   CORRECTION: PROC (DESCR1, MF, TYPE) ALTRET ;

    758  2 000440   200036 741300       CORRECTION   STX1  ! CORRECTED_1+2,,AUTO

      156      759        /*=======*/
      157      760
      158      761    2   DCL DESCR1             BIT(36) ALIGNED;
      159      762
      160      763    2   DCL 1   DESCR          ALIGNED,        /* EIS Descriptor       */
      161      764    2        2  SA             UBIN HALF HALIGNED, /* Storage Address      */
      162      765    2        2  Z              REDEF SA,
      163      766    2         3 PR#            UBIN  (3) UNAL, /* Pointer Register No. */
      164      767    2         3 Y              SBIN (15) UNAL, /* Offset from PR value */
      165      768    2        2  CN             UBIN  (3) UNAL, /* Character Offset     */
      166      769    2        2  TN             BIT   (1) UNAL, /* 0 = 9-BIT, 1 = 4-BIT */
      167      770    2        2  S              UBIN  (2) UNAL, /* Sign Type            */
      168      771    2        2  SF             SBIN  (6) UNAL, /* Scale Factor         */
      169      772    2        2  N              UBIN  (6) UNAL; /* Length               */
      170      773
      171      774    2   DCL 1   IND_DESCR      REDEF DESCR,
      172      775    2        2  *              BIT (29),
      173      776    2        2  PR             BIT (1),
      174      777    2        2  REG            UBIN (6) UNAL;
      175      778
      176      779    2   DCL 1   MF             UNAL,           /* Operand Modifier     */
      177      780    2        2  PR             BIT   (1) UNAL, /* Pointer Register Md? */
      178      781    2        2  RL             BIT   (1) UNAL, /* Register Length Mod? */
      179      782    2        2  ID             BIT   (1) UNAL, /* Indirect Descriptor? */
      180      783    2        2  REG            UBIN  (4) UNAL; /* 5 = A, 6 = Q, 8 = X0 */
      181      784                                               /* 1 = AU,2 = QU,0 = N  */
      182      785    2   DCL     ASC_STR        CHAR (63) ;
      183      786    2   DCL     FIXED          BIT (1) ;
      184      787    2   DCL     BASED$PKD      BIT (1)   BASED (PTR$) ;
      185      788    2   DCL     ZEROES         CHAR (0) CONSTANT INIT
      186      789    2    ('000000000000000000000000000000000000000000000000000000000000000') ;
      187      790    2   DCL     BASED$ASC      CHAR (LENGTH) BASED (PTR$) ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:44   
      188      791    2   DCL     OVP_PLUS       CHAR (10) CONSTANT INIT ('{ABCDEFGHI') ;
      189      792    2   DCL     OVP_MINUS      CHAR (10) CONSTANT INIT ('}JKLMNOPQR') ;
      190      793    2   DCL     X9OS$CLASS_NUMERIC (0:511) UBIN BYTE CALIGNED SYMREF READONLY ;
      191      794
      192      795    2   DCL     TYPE           UBIN ;
      193      796
      194      797    2   DCL     PTR$           PTR ;
      195      798    2   DCL     LENGTH         SBIN ;
      196      799    2   DCL     L              SBIN ;
      197      800    2   DCL     S              SBIN ;
      198      801    2   DCL     N              SBIN ;
      199      802
      200      803        %EQU ASCII = '0'B ;      /* TN field */
      201      804
      202      805        %EQU LEADING_SIGN  = 1 ; /* S field */
      203      806        %EQU TRAILING_SIGN = 2 ;
      204      807        %EQU NO_SIGN       = 3 ;
      205      808
      206      809        %EQU N  =  0 ; /* MF.REG definitions */
      207      810        %EQU AU =  1 ;
      208      811        %EQU QU =  2 ;
      209      812        %EQU IC =  4 ;
      210      813        %EQU A  =  5 ;
      211      814        %EQU Q  =  6 ;
      212      815        %EQU X0 = BITBIN ('10'O) ;
      213      816        %EQU X1 = BITBIN ('11'O) ;
      214      817        %EQU X2 = BITBIN ('12'O) ;
      215      818        %EQU X3 = BITBIN ('13'O) ;
      216      819        %EQU X4 = BITBIN ('14'O) ;
      217      820        %EQU X5 = BITBIN ('15'O) ;
      218      821        %EQU X6 = BITBIN ('16'O) ;
      219      822        %EQU X7 = BITBIN ('17'O) ;
      220      823        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:45   
      221      824               /*============*/
      222      825               /* CORRECTION */
      223      826               /*============*/
      224      827
      225      828    2          DESCR = DESCR1;

    828  2 000441   200037 470500                    LDP0    @DESCR1,,AUTO
         2 000442   000000 236100                    LDQ     0,,PR0
         2 000443   200042 756100                    STQ     DESCR,,AUTO

      226      829    2          CORRECTED_1 = '0'B;

    829  2 000444   200034 450100                    STZ     CORRECTED_1,,AUTO

      227      830
      228      831    2          CALL SET_PTR (PTR$)

    831  2 000445   200064 631500                    EPPR1   PTR$,,AUTO
         2 000446   200073 451500                    STP1    N+3,,AUTO
         2 000447   001000 701000 2                  TSX1    SET_PTR
         2 000450   000452 702000 2                  TSX2    s:833
         2 000451   000454 710000 2                  TRA     s:836

      229      832    3          WHENALTRETURN DO ; /* Can't set pointer */

      230      833    3            ALTRETURN ;

    833  2 000452   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000453   000000 702211                    TSX2  ! 0,X1

      231      834    3          END ;
      232      835
      233      836    3          IF MF.RL THEN DO CASE (DESCR.N);

    836  2 000454   200040 470500                    LDP0    @MF,,AUTO
         2 000455   000000 066500                    CMPB    filb='0'B
         2 000456   000000 010001                    BDSC    0,,PR0                   by=0,bit=1,n=1
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:46   
         2 000457   000000 000022 3                  BDSC    0                        by=0,bit=0,n=18
         2 000460   000612 600000 2                  TZE     s:879

    836  2 000461   200042 720100                    LXL0    DESCR,,AUTO
         2 000462   000077 360003                    ANX0    63,DU
         2 000463   000020 100003                    CMPX0   16,DU
         2 000464   000466 602010 2                  TNC     s:836+10,X0
         2 000465   000610 710000 2                  TRA     s:875
         2 000466   000610 710000 2                  TRA     s:875
         2 000467   000506 710000 2                  TRA     s:839
         2 000470   000513 710000 2                  TRA     s:842
         2 000471   000610 710000 2                  TRA     s:875
         2 000472   000610 710000 2                  TRA     s:875
         2 000473   000520 710000 2                  TRA     s:845
         2 000474   000526 710000 2                  TRA     s:848
         2 000475   000610 710000 2                  TRA     s:875
         2 000476   000534 710000 2                  TRA     s:851
         2 000477   000541 710000 2                  TRA     s:854
         2 000500   000547 710000 2                  TRA     s:857
         2 000501   000554 710000 2                  TRA     s:860
         2 000502   000562 710000 2                  TRA     s:863
         2 000503   000567 710000 2                  TRA     s:866
         2 000504   000575 710000 2                  TRA     s:869
         2 000505   000602 710000 2                  TRA     s:872

      234      837
      235      838    3            CASE (%AU);

      236      839    3              LENGTH = REGISTERS.Z.AU;

    839  2 000506   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000507   100004 236100                    LDQ     4,,PR1
         2 000510   000022 732000                    QRS     18
         2 000511   200065 756100                    STQ     LENGTH,,AUTO
         2 000512   000615 710000 2                  TRA     s:881

      237      840
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:47   
      238      841    3            CASE (%QU);

      239      842    3              LENGTH = REGISTERS.ZZ.QU;

    842  2 000513   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000514   100005 236100                    LDQ     5,,PR1
         2 000515   000022 732000                    QRS     18
         2 000516   200065 756100                    STQ     LENGTH,,AUTO
         2 000517   000615 710000 2                  TRA     s:881

      240      843
      241      844    3            CASE (%A);

      242      845    3              LENGTH = REGISTERS.Z.AL;

    845  2 000520   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000521   100004 236100                    LDQ     4,,PR1
         2 000522   000022 736000                    QLS     18
         2 000523   000022 732000                    QRS     18
         2 000524   200065 756100                    STQ     LENGTH,,AUTO
         2 000525   000615 710000 2                  TRA     s:881

      243      846
      244      847    3            CASE (%Q);

      245      848    3              LENGTH = REGISTERS.ZZ.QL;

    848  2 000526   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000527   100005 236100                    LDQ     5,,PR1
         2 000530   000022 736000                    QLS     18
         2 000531   000022 732000                    QRS     18
         2 000532   200065 756100                    STQ     LENGTH,,AUTO
         2 000533   000615 710000 2                  TRA     s:881

      246      849
      247      850    3            CASE (%X0);

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:48   
      248      851    3              LENGTH = REGISTERS.XR (0);

    851  2 000534   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000535   100000 236100                    LDQ     0,,PR1
         2 000536   000022 732000                    QRS     18
         2 000537   200065 756100                    STQ     LENGTH,,AUTO
         2 000540   000615 710000 2                  TRA     s:881

      249      852
      250      853    3            CASE (%X1);

      251      854    3              LENGTH = REGISTERS.XR (1);

    854  2 000541   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000542   100000 236100                    LDQ     0,,PR1
         2 000543   000022 736000                    QLS     18
         2 000544   000022 732000                    QRS     18
         2 000545   200065 756100                    STQ     LENGTH,,AUTO
         2 000546   000615 710000 2                  TRA     s:881

      252      855
      253      856    3            CASE (%X2);

      254      857    3              LENGTH = REGISTERS.XR (2);

    857  2 000547   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000550   100001 236100                    LDQ     1,,PR1
         2 000551   000022 732000                    QRS     18
         2 000552   200065 756100                    STQ     LENGTH,,AUTO
         2 000553   000615 710000 2                  TRA     s:881

      255      858
      256      859    3            CASE (%X3);

      257      860    3              LENGTH = REGISTERS.XR (3);

    860  2 000554   200004 471500                    LDP1    @REGISTERS,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:49   
         2 000555   100001 236100                    LDQ     1,,PR1
         2 000556   000022 736000                    QLS     18
         2 000557   000022 732000                    QRS     18
         2 000560   200065 756100                    STQ     LENGTH,,AUTO
         2 000561   000615 710000 2                  TRA     s:881

      258      861
      259      862    3            CASE (%X4);

      260      863    3              LENGTH = REGISTERS.XR (4);

    863  2 000562   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000563   100002 236100                    LDQ     2,,PR1
         2 000564   000022 732000                    QRS     18
         2 000565   200065 756100                    STQ     LENGTH,,AUTO
         2 000566   000615 710000 2                  TRA     s:881

      261      864
      262      865    3            CASE (%X5);

      263      866    3              LENGTH = REGISTERS.XR (5);

    866  2 000567   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000570   100002 236100                    LDQ     2,,PR1
         2 000571   000022 736000                    QLS     18
         2 000572   000022 732000                    QRS     18
         2 000573   200065 756100                    STQ     LENGTH,,AUTO
         2 000574   000615 710000 2                  TRA     s:881

      264      867
      265      868    3            CASE (%X6);

      266      869    3              LENGTH = REGISTERS.XR (6);

    869  2 000575   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000576   100003 236100                    LDQ     3,,PR1
         2 000577   000022 732000                    QRS     18
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:50   
         2 000600   200065 756100                    STQ     LENGTH,,AUTO
         2 000601   000615 710000 2                  TRA     s:881

      267      870
      268      871    3            CASE (%X7);

      269      872    3              LENGTH = REGISTERS.XR (7);

    872  2 000602   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 000603   100003 236100                    LDQ     3,,PR1
         2 000604   000022 736000                    QLS     18
         2 000605   000022 732000                    QRS     18
         2 000606   200065 756100                    STQ     LENGTH,,AUTO
         2 000607   000615 710000 2                  TRA     s:881

      270      873
      271      874    3            CASE (ELSE);

      272      875    3              ALTRETURN;

    875  2 000610   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000611   000000 702211                    TSX2  ! 0,X1

      273      876
      274      877    3          END ; /* CASE of length register */

      275      878
      276      879    2          ELSE LENGTH = DESCR.N ;

    879  2 000612   200042 236100                    LDQ     DESCR,,AUTO
         2 000613   000077 376007                    ANQ     63,DL
         2 000614   200065 756100                    STQ     LENGTH,,AUTO

      277      880
      278      881    3          IF DESCR.TN = %ASCII THEN DO ;

    881  2 000615   200042 236100                    LDQ     DESCR,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:51   
         2 000616   040000 316007                    CANQ    16384,DL
         2 000617   000626 601000 2                  TNZ     s:891

      279      882    3            CALL ASCII_CORRECTION

    882  2 000620   001515 701000 2                  TSX1    ASCII_CORRECTION
         2 000621   000624 702000 2                  TSX2    s:887

      280      883    4              WHENRETURN DO ;

      281      884    4                RETURN ;

    884  2 000622   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000623   000001 702211                    TSX2  ! 1,X1

      282      885    4              END ; /* When Return from Ascii_Correction */
      283      886    4              WHENALTRETURN DO ;

      284      887    4                ALTRETURN ;

    887  2 000624   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000625   000000 702211                    TSX2  ! 0,X1

      285      888    4              END ; /* When Alt Return from Ascii_Correction */
      286      889    3          END ; /* Ascii Descriptor */
      287      890
      288      891    2          FIXED = '0'B;

    891  2 000626   200063 450100                    STZ     FIXED,,AUTO

      289      892    2          CALL X9MV$4TO9 ( BASED$PKD, ASC_STR, LENGTH );

    892  2 000627   200065 631500                    EPPR1   LENGTH,,AUTO
         2 000630   200102 451500                    STP1    @J+3,,AUTO
         2 000631   200043 633500                    EPPR3   ASC_STR,,AUTO
         2 000632   200101 453500                    STP3    @J+2,,AUTO
         2 000633   200064 236100                    LDQ     PTR$,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:52   
         2 000634   200100 756100                    STQ     @J+1,,AUTO
         2 000635   200100 630500                    EPPR0   @J+1,,AUTO
         2 000636   000001 631400 3                  EPPR1   1
         2 000637   000000 701000 xent               TSX1    X9MV$4TO9
         2 000640   000000 011000                    NOP     0

      290      893    2          MSG2.DATA = SUBSTR( ASC_STR, 0, LENGTH );

    893  2 000641   200065 720100                    LXL0    LENGTH,,AUTO
         2 000642   040000 100540                    MLR     fill='040'O
         2 000643   200043 000010                    ADSC9   ASC_STR,,AUTO            cn=0,n=*X0
         2 000644   000004 200077 0                  ADSC9   MSG2+4                   cn=1,n=63

      291      894    3          DO CASE (DESCR.S); /* Sign type */

    894  2 000645   200042 236100                    LDQ     DESCR,,AUTO
         2 000646   000014 772000                    QRL     12
         2 000647   000003 376007                    ANQ     3,DL
         2 000650   000004 116007                    CMPQ    4,DL
         2 000651   000653 602006 2                  TNC     s:894+6,QL
         2 000652   000727 710000 2                  TRA     s:915
         2 000653   000727 710000 2                  TRA     s:915
         2 000654   000705 710000 2                  TRA     s:907
         2 000655   000663 710000 2                  TRA     s:899
         2 000656   000657 710000 2                  TRA     s:896

      292      895    3            CASE (%NO_SIGN);

      293      896    3              L = LENGTH;

    896  2 000657   200065 235100                    LDA     LENGTH,,AUTO
         2 000660   200066 755100                    STA     L,,AUTO

      294      897    3              S = 0;

    897  2 000661   200067 450100                    STZ     S,,AUTO
         2 000662   000731 710000 2                  TRA     FIX_DIGITS
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:53   

      295      898    3            CASE (%TRAILING_SIGN);

      296      899    3              L = LENGTH - 1;

    899  2 000663   200065 235100                    LDA     LENGTH,,AUTO
         2 000664   000001 135007                    SBLA    1,DL
         2 000665   200066 755100                    STA     L,,AUTO

      297      900    3              S = 0;

    900  2 000666   200067 450100                    STZ     S,,AUTO

      298      901    3              IF SUBSTR (ASC_STR, L, 1) ~= '+' AND

    901  2 000667   040000 106505                    CMPC    fill='040'O
         2 000670   200043 000001                    ADSC9   ASC_STR,A,AUTO           cn=0,n=1
         2 000671   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000672   000731 600000 2                  TZE     FIX_DIGITS
         2 000673   040000 106505                    CMPC    fill='040'O
         2 000674   200043 000001                    ADSC9   ASC_STR,A,AUTO           cn=0,n=1
         2 000675   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 000676   000731 600000 2                  TZE     FIX_DIGITS

      299      902    4                  SUBSTR (ASC_STR, L, 1) ~= '-' THEN DO;

      300      903    4                CALL INSERT (ASC_STR, L, 1, '+');

    903  2 000677   040105 100400                    MLR     fill='040'O
         2 000700   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000701   200043 000001                    ADSC9   ASC_STR,A,AUTO           cn=0,n=1

      301      904    4                FIXED = '1'B;

    904  2 000702   400000 236003                    LDQ     -131072,DU
         2 000703   200063 756100                    STQ     FIXED,,AUTO

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:54   
      302      905    4              END;

    905  2 000704   000731 710000 2                  TRA     FIX_DIGITS

      303      906    3            CASE (%LEADING_SIGN);

      304      907    3              L = LENGTH - 1;

    907  2 000705   200065 235100                    LDA     LENGTH,,AUTO
         2 000706   000001 135007                    SBLA    1,DL
         2 000707   200066 755100                    STA     L,,AUTO

      305      908    3              S = 1;

    908  2 000710   000001 235007                    LDA     1,DL
         2 000711   200067 755100                    STA     S,,AUTO

      306      909    3              IF SUBSTR (ASC_STR, 0, 1) ~= '+' AND

    909  2 000712   200043 236100                    LDQ     ASC_STR,,AUTO
         2 000713   777000 376003                    ANQ     -512,DU
         2 000714   053000 116003                    CMPQ    22016,DU
         2 000715   000731 600000 2                  TZE     FIX_DIGITS
         2 000716   200043 236100                    LDQ     ASC_STR,,AUTO
         2 000717   777000 376003                    ANQ     -512,DU
         2 000720   055000 116003                    CMPQ    23040,DU
         2 000721   000731 600000 2                  TZE     FIX_DIGITS

      307      910    4                  SUBSTR (ASC_STR, 0, 1) ~= '-' THEN DO;

      308      911    4                CALL INSERT (ASC_STR,, 1, '+');

    911  2 000722   053000 236003                    LDQ     22016,DU
         2 000723   200043 552140                    STBQ    ASC_STR,'40'O,AUTO

      309      912    4                FIXED = '1'B;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:55   
    912  2 000724   400000 236003                    LDQ     -131072,DU
         2 000725   200063 756100                    STQ     FIXED,,AUTO

      310      913    4              END;

    913  2 000726   000731 710000 2                  TRA     FIX_DIGITS

      311      914    3            CASE (ELSE); /* Float */

      312      915    3              ALTRETURN;

    915  2 000727   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000730   000000 702211                    TSX2  ! 0,X1

      313      916    3          END;

      314      917    3   FIX_DIGITS: DO;

    917  2 000731                       FIX_DIGITS   null
      315      918    3            CALL INDEX (N, '+', SUBSTR (ASC_STR, S, L))

    918  2 000731   200066 720100                    LXL0    L,,AUTO
         2 000732   200067 235100                    LDA     S,,AUTO
         2 000733   000000 124545                    SCM     mask='000'O
         2 000734   200043 000010                    ADSC9   ASC_STR,A,AUTO           cn=0,n=*X0
         2 000735   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000736   200070 000100                    ARG     N,,AUTO
         2 000737   000741 606400 2                  TTN     s:920
         2 000740   000752 710000 2                  TRA     s:925

      316      919    4              WHENALTRETURN DO;

      317      920    4                CALL INDEX (N, '-', SUBSTR (ASC_STR, S, L))

    920  2 000741   200066 720100                    LXL0    L,,AUTO
         2 000742   200067 235100                    LDA     S,,AUTO
         2 000743   000000 124545                    SCM     mask='000'O
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:56   
         2 000744   200043 000010                    ADSC9   ASC_STR,A,AUTO           cn=0,n=*X0
         2 000745   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 000746   200070 000100                    ARG     N,,AUTO
         2 000747   000751 606400 2                  TTN     s:922
         2 000750   000752 710000 2                  TRA     s:925

      318      921    5                  WHENALTRETURN DO;

      319      922    5                    EXIT FIX_DIGITS;

    922  2 000751   000760 710000 2                  TRA     s:929

      320      923    5                  END;
      321      924    4              END;

      322      925    3            CALL INSERT (ASC_STR, S, L, ZEROES);

    925  2 000752   040145 100400                    MLR     fill='040'O
         2 000753   000000 000077 1                  ADSC9   ZEROES                   cn=0,n=63
         2 000754   200043 000010                    ADSC9   ASC_STR,A,AUTO           cn=0,n=*X0

      323      926    3            FIXED = '1'B;

    926  2 000755   400000 236003                    LDQ     -131072,DU
         2 000756   200063 756100                    STQ     FIXED,,AUTO

      324      927    3            CORRECTED_1 = '1'B;

    927  2 000757   200034 756100                    STQ     CORRECTED_1,,AUTO

      325      928    3          END; /* FIX_DIGITS */

      326      929    2          IF NOT FIXED THEN ALTRETURN;

    929  2 000760   200063 234100                    SZN     FIXED,,AUTO
         2 000761   000764 604000 2                  TMI     s:931

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:57   
    929  2 000762   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000763   000000 702211                    TSX2  ! 0,X1

      327      930
      328      931    2          CALL X9MV$9TO4 (ASC_STR, BASED$PKD, LENGTH);

    931  2 000764   200065 630500                    EPPR0   LENGTH,,AUTO
         2 000765   200102 450500                    STP0    @J+3,,AUTO
         2 000766   200064 236100                    LDQ     PTR$,,AUTO
         2 000767   200101 756100                    STQ     @J+2,,AUTO
         2 000770   200043 631500                    EPPR1   ASC_STR,,AUTO
         2 000771   200100 451500                    STP1    @J+1,,AUTO
         2 000772   200100 630500                    EPPR0   @J+1,,AUTO
         2 000773   000001 631400 3                  EPPR1   1
         2 000774   000000 701000 xent               TSX1    X9MV$9TO4
         2 000775   000000 011000                    NOP     0

      329      932
      330      933    2          RETURN ;

    933  2 000776   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 000777   000001 702211                    TSX2  ! 1,X1

      331      934
      332      935        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:58   
      333      936        /*=====*/
      334      937    2   SET_PTR: PROC (PTR$) ALTRET ;

    937  2 001000   200072 741300       SET_PTR      STX1  ! N+2,,AUTO

      335      938        /*=====*/
      336      939
      337      940        /* Inputs:  DESCR -- an EIS descriptor.
      338      941                    MF ----- the modifier (MF1, MF2, or MF3)
      339      942           Output:  PTR$ --- the pointer to the data
      340      943        */
      341      944
      342      945    3   DCL     PTR$           PTR ALIGNED ;
      343      946    3   DCL     OFFSET         UBIN;
      344      947    3   DCL     BASED$DESCR    BIT (36) ALIGNED BASED;
      345      948
      346      949    3   DCL     DIGITS         SBIN WORD ;
      347      950    3   DCL   1 DIGITS_ASCII   REDEF DIGITS,
      348      951    3         2 UNUSED         UBIN (16) UNAL,
      349      952    3         2 *              BIT (20);
      350      953    3   DCL 1 DIGITS_PACKED REDEF DIGITS,
      351      954    3         2 UNUSED         UBIN (15) UNAL,
      352      955    3         2 *              BIT (21);
      353      956
      354      957    3   DCL 1 OPERAND_DSCR     DALIGNED,
      355      958    3         2 *              BIT (21),
      356      959    3         2 WRITABLE       BIT (1),
      357      960    3         2 *              BIT (50);
      358      961        %IF CP6;
      359      962    3   DCL     ISR_PTR        BIT (36) CONSTANT INIT ('000000001762'O);
      360      963    3   DCL     ISR$           REDEF ISR_PTR PTR;
      361      964        %ENDIF;
      362      965        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:59   
      363      966               /*=========*/
      364      967               /* SET_PTR */
      365      968               /*=========*/
      366      969
      367      970    4          IF MF.ID THEN DO;

    970  2 001001   200040 470500                    LDP0    @MF,,AUTO
         2 001002   000000 066500                    CMPB    filb='0'B
         2 001003   000000 020001                    BDSC    0,,PR0                   by=0,bit=2,n=1
         2 001004   000000 000022 3                  BDSC    0                        by=0,bit=0,n=18
         2 001005   001163 600000 2                  TZE     s:1025

      368      971    4            IF NOT IND_DESCR.PR THEN

    971  2 001006   200042 236100                    LDQ     DESCR,,AUTO
         2 001007   000100 316007                    CANQ    64,DL
         2 001010   001012 601000 2                  TNZ     s:974

      369      972    4              ALTRETURN; /* Indirect descriptor in code segment, not expected in

    972  2 001011   000000 702211                    TSX2  ! 0,X1

      370      973                                 COBOL85. */
      371      974    4            PTR$ = PINCRW (PTR_REGISTERS.PR$ (DESCR.Z.PR#), DESCR.Z.Y);

    974  2 001012   200042 236100                    LDQ     DESCR,,AUTO
         2 001013   000041 772000                    QRL     33
         2 001014   000000 620006                    EAX0    0,QL
         2 001015   200042 236100                    LDQ     DESCR,,AUTO
         2 001016   000003 736000                    QLS     3
         2 001017   000025 732000                    QRS     21
         2 001020   200005 471500                    LDP1    @PTR_REGISTERS,,AUTO
         2 001021   100000 473510                    LDP3    0,X0,PR1
         2 001022   300000 634506                    EPPR4   0,QL,PR3
         2 001023   200073 475500                    LDP5    @PTR$,,AUTO
         2 001024   500000 454500                    STP4    0,,PR5

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:60   
      372      975
      373      976    5            DO CASE (IND_DESCR.REG);

    976  2 001025   200042 721100                    LXL1    DESCR,,AUTO
         2 001026   000077 361003                    ANX1    63,DU
         2 001027   000020 101003                    CMPX1   16,DU
         2 001030   001032 602011 2                  TNC     s:976+5,X1
         2 001031   001156 710000 2                  TRA     s:1018
         2 001032   001052 710000 2                  TRA     s:979
         2 001033   001054 710000 2                  TRA     s:982
         2 001034   001061 710000 2                  TRA     s:985
         2 001035   001156 710000 2                  TRA     s:1018
         2 001036   001156 710000 2                  TRA     s:1018
         2 001037   001066 710000 2                  TRA     s:988
         2 001040   001074 710000 2                  TRA     s:991
         2 001041   001156 710000 2                  TRA     s:1018
         2 001042   001102 710000 2                  TRA     s:994
         2 001043   001107 710000 2                  TRA     s:997
         2 001044   001115 710000 2                  TRA     s:1000
         2 001045   001122 710000 2                  TRA     s:1003
         2 001046   001130 710000 2                  TRA     s:1006
         2 001047   001135 710000 2                  TRA     s:1009
         2 001050   001143 710000 2                  TRA     s:1012
         2 001051   001150 710000 2                  TRA     s:1015

      374      977
      375      978    5              CASE (%N);

      376      979    5                OFFSET = 0;

    979  2 001052   200074 450100                    STZ     OFFSET,,AUTO
         2 001053   001160 710000 2                  TRA     s:1022

      377      980
      378      981    5              CASE (%AU);

      379      982    5                OFFSET = REGISTERS.Z.AU;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:61   

    982  2 001054   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001055   300004 236100                    LDQ     4,,PR3
         2 001056   000022 732000                    QRS     18
         2 001057   200074 756100                    STQ     OFFSET,,AUTO
         2 001060   001160 710000 2                  TRA     s:1022

      380      983
      381      984    5              CASE (%QU);

      382      985    5                OFFSET = REGISTERS.ZZ.QU;

    985  2 001061   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001062   300005 236100                    LDQ     5,,PR3
         2 001063   000022 732000                    QRS     18
         2 001064   200074 756100                    STQ     OFFSET,,AUTO
         2 001065   001160 710000 2                  TRA     s:1022

      383      986
      384      987    5              CASE (%A);

      385      988    5                OFFSET = REGISTERS.Z.AL;

    988  2 001066   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001067   300004 236100                    LDQ     4,,PR3
         2 001070   000022 736000                    QLS     18
         2 001071   000022 732000                    QRS     18
         2 001072   200074 756100                    STQ     OFFSET,,AUTO
         2 001073   001160 710000 2                  TRA     s:1022

      386      989
      387      990    5              CASE (%Q);

      388      991    5                OFFSET = REGISTERS.ZZ.QL;

    991  2 001074   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001075   300005 236100                    LDQ     5,,PR3
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:62   
         2 001076   000022 736000                    QLS     18
         2 001077   000022 732000                    QRS     18
         2 001100   200074 756100                    STQ     OFFSET,,AUTO
         2 001101   001160 710000 2                  TRA     s:1022

      389      992
      390      993    5              CASE (%X0);

      391      994    5                OFFSET = REGISTERS.XR (0);

    994  2 001102   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001103   300000 236100                    LDQ     0,,PR3
         2 001104   000022 732000                    QRS     18
         2 001105   200074 756100                    STQ     OFFSET,,AUTO
         2 001106   001160 710000 2                  TRA     s:1022

      392      995
      393      996    5              CASE (%X1);

      394      997    5                OFFSET = REGISTERS.XR (1);

    997  2 001107   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001110   300000 236100                    LDQ     0,,PR3
         2 001111   000022 736000                    QLS     18
         2 001112   000022 732000                    QRS     18
         2 001113   200074 756100                    STQ     OFFSET,,AUTO
         2 001114   001160 710000 2                  TRA     s:1022

      395      998
      396      999    5              CASE (%X2);

      397     1000    5                OFFSET = REGISTERS.XR (2);

   1000  2 001115   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001116   300001 236100                    LDQ     1,,PR3
         2 001117   000022 732000                    QRS     18
         2 001120   200074 756100                    STQ     OFFSET,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:63   
         2 001121   001160 710000 2                  TRA     s:1022

      398     1001
      399     1002    5              CASE (%X3);

      400     1003    5                OFFSET = REGISTERS.XR (3);

   1003  2 001122   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001123   300001 236100                    LDQ     1,,PR3
         2 001124   000022 736000                    QLS     18
         2 001125   000022 732000                    QRS     18
         2 001126   200074 756100                    STQ     OFFSET,,AUTO
         2 001127   001160 710000 2                  TRA     s:1022

      401     1004
      402     1005    5              CASE (%X4);

      403     1006    5                OFFSET = REGISTERS.XR (4);

   1006  2 001130   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001131   300002 236100                    LDQ     2,,PR3
         2 001132   000022 732000                    QRS     18
         2 001133   200074 756100                    STQ     OFFSET,,AUTO
         2 001134   001160 710000 2                  TRA     s:1022

      404     1007
      405     1008    5              CASE (%X5);

      406     1009    5                OFFSET = REGISTERS.XR (5);

   1009  2 001135   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001136   300002 236100                    LDQ     2,,PR3
         2 001137   000022 736000                    QLS     18
         2 001140   000022 732000                    QRS     18
         2 001141   200074 756100                    STQ     OFFSET,,AUTO
         2 001142   001160 710000 2                  TRA     s:1022

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:64   
      407     1010
      408     1011    5              CASE (%X6);

      409     1012    5                OFFSET = REGISTERS.XR (6);

   1012  2 001143   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001144   300003 236100                    LDQ     3,,PR3
         2 001145   000022 732000                    QRS     18
         2 001146   200074 756100                    STQ     OFFSET,,AUTO
         2 001147   001160 710000 2                  TRA     s:1022

      410     1013
      411     1014    5              CASE (%X7);

      412     1015    5                OFFSET = REGISTERS.XR (7);

   1015  2 001150   200004 473500                    LDP3    @REGISTERS,,AUTO
         2 001151   300003 236100                    LDQ     3,,PR3
         2 001152   000022 736000                    QLS     18
         2 001153   000022 732000                    QRS     18
         2 001154   200074 756100                    STQ     OFFSET,,AUTO
         2 001155   001160 710000 2                  TRA     s:1022

      413     1016
      414     1017    5              CASE (%IC, ELSE);

      415     1018    5                ALTRETURN; /* If IC then not patchable */

   1018  2 001156   200072 221300                    LDX1  ! N+2,,AUTO
         2 001157   000000 702211                    TSX2  ! 0,X1

      416     1019
      417     1020    5            END; /* CASE */

      418     1021
      419     1022    4            DESCR = PINCRW (PTR$, OFFSET) -> BASED$DESCR;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:65   
   1022  2 001160   200074 722100                    LXL2    OFFSET,,AUTO
         2 001161   400000 236112                    LDQ     0,X2,PR4
         2 001162   200042 756100                    STQ     DESCR,,AUTO

      420     1023    4          END;

      421     1024
      422     1025    3          IF MF.REG = %IC THEN

   1025  2 001163   003100 061500                    CSR     bolr='003'O
         2 001164   000000 030004                    BDSC    0,,PR0                   by=0,bit=3,n=4
         2 001165   200100 000044                    BDSC    @J+1,,AUTO               by=0,bit=0,n=36
         2 001166   200100 236100                    LDQ     @J+1,,AUTO
         2 001167   000004 116007                    CMPQ    4,DL
         2 001170   001173 601000 2                  TNZ     s:1032

      423     1026    3            ALTRETURN ; /*N* IC tag */

   1026  2 001171   200072 221300                    LDX1  ! N+2,,AUTO
         2 001172   000000 702211                    TSX2  ! 0,X1

      424     1027
      425     1028               %IF GCOS;
      428     1031               %ELSE;
      429     1032    3          IF NOT MF.PR THEN /* No Pointer register modification */

   1032  2 001173   000000 066500                    CMPB    filb='0'B
         2 001174   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 001175   000000 000022 3                  BDSC    0                        by=0,bit=0,n=18
         2 001176   001205 601000 2                  TNZ     s:1037

      430     1033    3            PTR$ = PINCRW (ISR$, DESCR.SA) ;

   1033  2 001177   200042 236100                    LDQ     DESCR,,AUTO
         2 001200   777777 376003                    ANQ     -1,DU
         2 001201   000026 036000 1                  ADLQ    ISR_PTR
         2 001202   200073 471500                    LDP1    @PTR$,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:66   
         2 001203   100000 756100                    STQ     0,,PR1
         2 001204   001213 710000 2                  TRA     s:1039

      431     1034    3          ELSE
      432     1035
      433     1036               %ENDIF;
      434     1037    3          PTR$ = PTR_REGISTERS.PR$ (DESCR.Z.PR#) ;

   1037  2 001205   200042 236100                    LDQ     DESCR,,AUTO
         2 001206   000041 772000                    QRL     33
         2 001207   200005 471500                    LDP1    @PTR_REGISTERS,,AUTO
         2 001210   100000 236106                    LDQ     0,QL,PR1
         2 001211   200073 473500                    LDP3    @PTR$,,AUTO
         2 001212   300000 756100                    STQ     0,,PR3

      435     1038
      436     1039    3          OPERAND_DSCR = PTRDSCR (PTR$);

   1039  2 001213   200073 471500                    LDP1    @PTR$,,AUTO
         2 001214   100000 473500                    LDP3    0,,PR1
         2 001215   200076 053500                    STD3    OPERAND_DSCR,,AUTO

      437     1040    3          IF NOT OPERAND_DSCR.WRITABLE THEN

   1040  2 001216   200076 236100                    LDQ     OPERAND_DSCR,,AUTO
         2 001217   040000 316007                    CANQ    16384,DL
         2 001220   001223 601000 2                  TNZ     s:1044

      438     1041    3            ALTRETURN; /* Operand in read-only storage */

   1041  2 001221   200072 221300                    LDX1  ! N+2,,AUTO
         2 001222   000000 702211                    TSX2  ! 0,X1

      439     1042
      440     1043               %IF CP6;
      441     1044    3          IF MF.PR THEN

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:67   
   1044  2 001223   200040 470500                    LDP0    @MF,,AUTO
         2 001224   000000 066500                    CMPB    filb='0'B
         2 001225   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 001226   000000 000022 3                  BDSC    0                        by=0,bit=0,n=18
         2 001227   001237 600000 2                  TZE     s:1048

      442     1045               %ENDIF;
      443     1046    3          PTR$ = PINCRW (PTR$, DESCR.Z.Y) ;

   1046  2 001230   200042 236100                    LDQ     DESCR,,AUTO
         2 001231   000003 736000                    QLS     3
         2 001232   000025 732000                    QRS     21
         2 001233   200073 471500                    LDP1    @PTR$,,AUTO
         2 001234   100000 473500                    LDP3    0,,PR1
         2 001235   300000 634506                    EPPR4   0,QL,PR3
         2 001236   100000 454500                    STP4    0,,PR1

      444     1047
      445     1048    4          DO CASE (MF.REG) ;

   1048  2 001237   003100 061500                    CSR     bolr='003'O
         2 001240   000000 030004                    BDSC    0,,PR0                   by=0,bit=3,n=4
         2 001241   200100 000022                    BDSC    @J+1,,AUTO               by=0,bit=0,n=18
         2 001242   200100 220100                    LDX0    @J+1,,AUTO
         2 001243   000020 100003                    CMPX0   16,DU
         2 001244   001246 602010 2                  TNC     s:1048+7,X0
         2 001245   001406 710000 2                  TRA     s:1073
         2 001246   001404 710000 2                  TRA     s:1070
         2 001247   001266 710000 2                  TRA     s:1050
         2 001250   001273 710000 2                  TRA     s:1051
         2 001251   001406 710000 2                  TRA     s:1073
         2 001252   001406 710000 2                  TRA     s:1073
         2 001253   001300 710000 2                  TRA     s:1052
         2 001254   001314 710000 2                  TRA     s:1056
         2 001255   001406 710000 2                  TRA     s:1073
         2 001256   001330 710000 2                  TRA     s:1060
         2 001257   001335 710000 2                  TRA     s:1061
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:68   
         2 001260   001343 710000 2                  TRA     s:1062
         2 001261   001350 710000 2                  TRA     s:1063
         2 001262   001356 710000 2                  TRA     s:1064
         2 001263   001363 710000 2                  TRA     s:1065
         2 001264   001371 710000 2                  TRA     s:1066
         2 001265   001376 710000 2                  TRA     s:1067

      446     1049
      447     1050    4            CASE (%AU) ; DIGITS = REGISTERS.Z.AU ;

   1050  2 001266   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001267   100004 236100                    LDQ     4,,PR1
         2 001270   000022 732000                    QRS     18
         2 001271   200075 756100                    STQ     DIGITS,,AUTO
         2 001272   001410 710000 2                  TRA     s:1077

      448     1051    4            CASE (%QU) ; DIGITS = REGISTERS.ZZ.QU ;

   1051  2 001273   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001274   100005 236100                    LDQ     5,,PR1
         2 001275   000022 732000                    QRS     18
         2 001276   200075 756100                    STQ     DIGITS,,AUTO
         2 001277   001410 710000 2                  TRA     s:1077

      449     1052    4            CASE (%A)  ; DIGITS = REGISTERS.A_REGISTER ;

   1052  2 001300   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001301   100004 235100                    LDA     4,,PR1
         2 001302   200075 755100                    STA     DIGITS,,AUTO

      450     1053    4                        IF DESCR.TN = %ASCII

   1053  2 001303   200042 236100                    LDQ     DESCR,,AUTO
         2 001304   040000 316007                    CANQ    16384,DL
         2 001305   001311 601000 2                  TNZ     s:1055

      451     1054    4                          THEN DIGITS_ASCII.UNUSED = 0;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:69   

   1054  2 001306   000004 236000 3                  LDQ     4
         2 001307   200075 356100                    ANSQ    DIGITS,,AUTO
         2 001310   001410 710000 2                  TRA     s:1077

      452     1055    4                          ELSE DIGITS_PACKED.UNUSED = 0;

   1055  2 001311   000005 236000 3                  LDQ     5
         2 001312   200075 356100                    ANSQ    DIGITS,,AUTO
         2 001313   001410 710000 2                  TRA     s:1077

      453     1056    4            CASE (%Q)  ; DIGITS = REGISTERS.Q_REGISTER ;

   1056  2 001314   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001315   100005 235100                    LDA     5,,PR1
         2 001316   200075 755100                    STA     DIGITS,,AUTO

      454     1057    4                        IF DESCR.TN = %ASCII

   1057  2 001317   200042 236100                    LDQ     DESCR,,AUTO
         2 001320   040000 316007                    CANQ    16384,DL
         2 001321   001325 601000 2                  TNZ     s:1059

      455     1058    4                          THEN DIGITS_ASCII.UNUSED = 0;

   1058  2 001322   000004 236000 3                  LDQ     4
         2 001323   200075 356100                    ANSQ    DIGITS,,AUTO
         2 001324   001410 710000 2                  TRA     s:1077

      456     1059    4                          ELSE DIGITS_PACKED.UNUSED = 0;

   1059  2 001325   000005 236000 3                  LDQ     5
         2 001326   200075 356100                    ANSQ    DIGITS,,AUTO
         2 001327   001410 710000 2                  TRA     s:1077

      457     1060    4            CASE (%X0) ; DIGITS = REGISTERS.XR(0) ;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:70   
   1060  2 001330   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001331   100000 236100                    LDQ     0,,PR1
         2 001332   000022 732000                    QRS     18
         2 001333   200075 756100                    STQ     DIGITS,,AUTO
         2 001334   001410 710000 2                  TRA     s:1077

      458     1061    4            CASE (%X1) ; DIGITS = REGISTERS.XR(1) ;

   1061  2 001335   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001336   100000 236100                    LDQ     0,,PR1
         2 001337   000022 736000                    QLS     18
         2 001340   000022 732000                    QRS     18
         2 001341   200075 756100                    STQ     DIGITS,,AUTO
         2 001342   001410 710000 2                  TRA     s:1077

      459     1062    4            CASE (%X2) ; DIGITS = REGISTERS.XR(2) ;

   1062  2 001343   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001344   100001 236100                    LDQ     1,,PR1
         2 001345   000022 732000                    QRS     18
         2 001346   200075 756100                    STQ     DIGITS,,AUTO
         2 001347   001410 710000 2                  TRA     s:1077

      460     1063    4            CASE (%X3) ; DIGITS = REGISTERS.XR(3) ;

   1063  2 001350   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001351   100001 236100                    LDQ     1,,PR1
         2 001352   000022 736000                    QLS     18
         2 001353   000022 732000                    QRS     18
         2 001354   200075 756100                    STQ     DIGITS,,AUTO
         2 001355   001410 710000 2                  TRA     s:1077

      461     1064    4            CASE (%X4) ; DIGITS = REGISTERS.XR(4) ;

   1064  2 001356   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001357   100002 236100                    LDQ     2,,PR1
         2 001360   000022 732000                    QRS     18
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:71   
         2 001361   200075 756100                    STQ     DIGITS,,AUTO
         2 001362   001410 710000 2                  TRA     s:1077

      462     1065    4            CASE (%X5) ; DIGITS = REGISTERS.XR(5) ;

   1065  2 001363   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001364   100002 236100                    LDQ     2,,PR1
         2 001365   000022 736000                    QLS     18
         2 001366   000022 732000                    QRS     18
         2 001367   200075 756100                    STQ     DIGITS,,AUTO
         2 001370   001410 710000 2                  TRA     s:1077

      463     1066    4            CASE (%X6) ; DIGITS = REGISTERS.XR(6) ;

   1066  2 001371   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001372   100003 236100                    LDQ     3,,PR1
         2 001373   000022 732000                    QRS     18
         2 001374   200075 756100                    STQ     DIGITS,,AUTO
         2 001375   001410 710000 2                  TRA     s:1077

      464     1067    4            CASE (%X7) ; DIGITS = REGISTERS.XR(7) ;

   1067  2 001376   200004 471500                    LDP1    @REGISTERS,,AUTO
         2 001377   100003 236100                    LDQ     3,,PR1
         2 001400   000022 736000                    QLS     18
         2 001401   000022 732000                    QRS     18
         2 001402   200075 756100                    STQ     DIGITS,,AUTO
         2 001403   001410 710000 2                  TRA     s:1077

      465     1068
      466     1069    4            CASE (%N)  ; /* No Register Modifier */

      467     1070    4              DIGITS = 0 ;

   1070  2 001404   200075 450100                    STZ     DIGITS,,AUTO
         2 001405   001410 710000 2                  TRA     s:1077

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:72   
      468     1071
      469     1072    4            CASE (ELSE) ; /* Illegal MF.REG */

      470     1073    4              ALTRETURN ;

   1073  2 001406   200072 221300                    LDX1  ! N+2,,AUTO
         2 001407   000000 702211                    TSX2  ! 0,X1

      471     1074
      472     1075    4          END ; /* Case of MF.REG */

      473     1076
      474     1077    3          IF DESCR.TN = %ASCII

   1077  2 001410   200042 236100                    LDQ     DESCR,,AUTO
         2 001411   040000 316007                    CANQ    16384,DL
         2 001412   001430 601000 2                  TNZ     s:1082

      475     1078    3            THEN PTR$ = PINCRC (PTR$, (DIGITS + DESCR.CN));

   1078  2 001413   200042 236100                    LDQ     DESCR,,AUTO
         2 001414   000017 772000                    QRL     15
         2 001415   000007 376007                    ANQ     7,DL
         2 001416   200075 036100                    ADLQ    DIGITS,,AUTO
         2 001417   200073 471500                    LDP1    @PTR$,,AUTO
         2 001420   100000 473500                    LDP3    0,,PR1
         2 001421   000011 402007                    MPY     9,DL
         2 001422   000000 116003                    CMPQ    0,DU
         2 001423   001425 605000 2                  TPL     s:1078+10
         2 001424   000044 036003                    ADLQ    36,DU
         2 001425   300000 503506                    ABD     0,QL,PR3
         2 001426   100000 453500                    STP3    0,,PR1
         2 001427   001460 710000 2                  TRA     s:1088

      476     1079
      477     1080    4          ELSE DO;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:73   
      478     1081
      479     1082    4            PTR$ = PINCRC (PTR$, (DIGITS + DESCR.CN) / 2) ;

   1082  2 001430   200042 236100                    LDQ     DESCR,,AUTO
         2 001431   000017 772000                    QRL     15
         2 001432   000007 376007                    ANQ     7,DL
         2 001433   200075 036100                    ADLQ    DIGITS,,AUTO
         2 001434   000002 506007                    DIV     2,DL
         2 001435   200073 471500                    LDP1    @PTR$,,AUTO
         2 001436   100000 473500                    LDP3    0,,PR1
         2 001437   000011 402007                    MPY     9,DL
         2 001440   000000 116003                    CMPQ    0,DU
         2 001441   001443 605000 2                  TPL     s:1082+11
         2 001442   000044 036003                    ADLQ    36,DU
         2 001443   300000 503506                    ABD     0,QL,PR3
         2 001444   100000 453500                    STP3    0,,PR1

      480     1083
      481     1084    4            IF MOD ((DIGITS + DESCR.CN), 2) = 1 THEN

   1084  2 001445   200042 236100                    LDQ     DESCR,,AUTO
         2 001446   000017 772000                    QRL     15
         2 001447   000007 376007                    ANQ     7,DL
         2 001450   200075 036100                    ADLQ    DIGITS,,AUTO
         2 001451   000002 506007                    DIV     2,DL
         2 001452   000044 733000                    LRS     36
         2 001453   000001 116007                    CMPQ    1,DL
         2 001454   001460 601000 2                  TNZ     s:1088

      482     1085    4              PTR$ = PINCRB (PTR$, 5) ;

   1085  2 001455   000005 221003                    LDX1    5,DU
         2 001456   300000 503511                    ABD     0,X1,PR3
         2 001457   100000 453500                    STP3    0,,PR1

      483     1086    4          END;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:74   
      484     1087
      485     1088    3   END SET_PTR ;

   1088  2 001460   200072 221300                    LDX1  ! N+2,,AUTO
         2 001461   000001 702211                    TSX2  ! 1,X1

      486     1089
      487     1090        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:75   
      488     1091        /*==================*/
      489     1092    2   OVERPUNCH_SIGN_CHECK: PROC (C, I, J) ;

   1092  2 001462   200074 741300       OVERPUNCH_S* STX1  ! OFFSET,,AUTO

      490     1093        /*==================*/
      491     1094
      492     1095    3   DCL     C CHAR (1) ;
      493     1096    3   DCL     I SBIN;
      494     1097    3   DCL     J SBIN;
      495     1098
      496     1099    3        CALL INDEX (I, C, OVP_PLUS)

   1099  2 001463   200076 470500                    LDP0    @I,,AUTO
         2 001464   200075 471500                    LDP1    @C,,AUTO
         2 001465   000100 124400                    SCM     mask='000'O
         2 001466   000020 000012 1                  ADSC9   OVP_PLUS                 cn=0,n=10
         2 001467   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001470   000000 000100                    ARG     0,,PR0
         2 001471   001476 606400 2                  TTN     s:1104

      497     1100    4          WHENRETURN DO;

      498     1101    4            J = 1;

   1101  2 001472   000001 235007                    LDA     1,DL
         2 001473   200077 473500                    LDP3    @J,,AUTO
         2 001474   300000 755100                    STA     0,,PR3

      499     1102    4          END;

   1102  2 001475   001513 710000 2                  TRA     s:1113

      500     1103    4          WHENALTRETURN DO;

      501     1104    4            CALL INDEX (I, C, OVP_MINUS)

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:76   
   1104  2 001476   200076 470500                    LDP0    @I,,AUTO
         2 001477   200075 471500                    LDP1    @C,,AUTO
         2 001500   000100 124400                    SCM     mask='000'O
         2 001501   000023 000012 1                  ADSC9   OVP_MINUS                cn=0,n=10
         2 001502   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001503   000000 000100                    ARG     0,,PR0
         2 001504   001511 606400 2                  TTN     s:1109

      502     1105    5              WHENRETURN DO;

      503     1106    5                J = -1;

   1106  2 001505   000001 335007                    LCA     1,DL
         2 001506   200077 473500                    LDP3    @J,,AUTO
         2 001507   300000 755100                    STA     0,,PR3

      504     1107    5              END;

   1107  2 001510   001513 710000 2                  TRA     s:1113

      505     1108    5              WHENALTRETURN DO;

      506     1109    5                J = 0;

   1109  2 001511   200077 470500                    LDP0    @J,,AUTO
         2 001512   000000 450100                    STZ     0,,PR0

      507     1110    5              END;

      508     1111    4          END;

      509     1112
      510     1113    3   END OVERPUNCH_SIGN_CHECK;

   1113  2 001513   200074 221300                    LDX1  ! OFFSET,,AUTO
         2 001514   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:77   
      511     1114
      512     1115        %EJECT;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:78   
      513     1116        /*================*/
      514     1117    2     ASCII_CORRECTION: PROC ALTRET ;

   1117  2 001515   200072 741300       ASCII_CORRE* STX1  ! N+2,,AUTO

      515     1118        /*================*/
      516     1119
      517     1120    3   DCL     C              CHAR (1);
      518     1121
      519     1122    3          MSG2.DATA = BASED$ASC;

   1122  2 001516   200064 470500                    LDP0    PTR$,,AUTO
         2 001517   200065 720100                    LXL0    LENGTH,,AUTO
         2 001520   040000 100540                    MLR     fill='040'O
         2 001521   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 001522   000004 200077 0                  ADSC9   MSG2+4                   cn=1,n=63

      520     1123    4          DO CASE (DESCR.S);

   1123  2 001523   200042 236100                    LDQ     DESCR,,AUTO
         2 001524   000014 772000                    QRL     12
         2 001525   000003 376007                    ANQ     3,DL
         2 001526   000004 116007                    CMPQ    4,DL
         2 001527   001531 602006 2                  TNC     s:1123+6,QL
         2 001530   002076 710000 2                  TRA     s:1189
         2 001531   002076 710000 2                  TRA     s:1189
         2 001532   001775 710000 2                  TRA     s:1172
         2 001533   001731 710000 2                  TRA     s:1161
         2 001534   001535 710000 2                  TRA     s:1125

      521     1124    4            CASE (%NO_SIGN);

      522     1125    5              IF TYPE < 2 THEN DO; /* Genuine no sign */

   1125  2 001535   200041 471500                    LDP1    @TYPE,,AUTO
         2 001536   100000 235100                    LDA     0,,PR1
         2 001537   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:79   
         2 001540   001627 603000 2                  TRC     s:1144

      523     1126    5                CALL OVERPUNCH_SIGN_CHECK (SUBSTR (BASED$ASC, 0, 1), N, S);

   1126  2 001541   200067 633500                    EPPR3   S,,AUTO
         2 001542   200077 453500                    STP3    @J,,AUTO
         2 001543   200070 634500                    EPPR4   N,,AUTO
         2 001544   200076 454500                    STP4    @I,,AUTO
         2 001545   200064 236100                    LDQ     PTR$,,AUTO
         2 001546   200075 756100                    STQ     @C,,AUTO
         2 001547   001462 701000 2                  TSX1    OVERPUNCH_SIGN_CHECK
         2 001550   000000 011000                    NOP     0

      524     1127    6                IF S ~= 0 THEN DO;

   1127  2 001551   200067 235100                    LDA     S,,AUTO
         2 001552   001561 600000 2                  TZE     s:1131

      525     1128    6                  CALL BINCHAR (SUBSTR (BASED$ASC, 0, 1), N);

   1128  2 001553   200064 470500                    LDP0    PTR$,,AUTO
         2 001554   000100 301500                    BTD
         2 001555   200070 000004                    NDSC9   N,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 001556   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1

      526     1129    6                  FIXED = '1'B;

   1129  2 001557   400000 236003                    LDQ     -131072,DU
         2 001560   200063 756100                    STQ     FIXED,,AUTO

      527     1130    6                END;

      528     1131    5                CALL OVERPUNCH_SIGN_CHECK (SUBSTR (BASED$ASC, LENGTH - 1, 1), N, S);

   1131  2 001561   200067 630500                    EPPR0   S,,AUTO
         2 001562   200077 450500                    STP0    @J,,AUTO
         2 001563   200070 631500                    EPPR1   N,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:80   
         2 001564   200076 451500                    STP1    @I,,AUTO
         2 001565   200065 236100                    LDQ     LENGTH,,AUTO
         2 001566   000020 736000                    QLS     16
         2 001567   200000 136007                    SBLQ    65536,DL
         2 001570   200064 036100                    ADLQ    PTR$,,AUTO
         2 001571   200075 756100                    STQ     @C,,AUTO
         2 001572   001462 701000 2                  TSX1    OVERPUNCH_SIGN_CHECK
         2 001573   000000 011000                    NOP     0

      529     1132    6                IF S ~= 0 THEN DO;

   1132  2 001574   200067 235100                    LDA     S,,AUTO
         2 001575   001605 600000 2                  TZE     s:1136

      530     1133    6                  CALL BINCHAR (SUBSTR (BASED$ASC, LENGTH - 1, 1), N);

   1133  2 001576   200064 470500                    LDP0    PTR$,,AUTO
         2 001577   200065 236100                    LDQ     LENGTH,,AUTO
         2 001600   000106 301500                    BTD
         2 001601   200070 000004                    NDSC9   N,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         2 001602   077777 630001                    NDSC9   -1,Q,PR0                 cn=3,s=nosgn,sf=0,n=1

      531     1134    6                  FIXED = '1'B;

   1134  2 001603   400000 236003                    LDQ     -131072,DU
         2 001604   200063 756100                    STQ     FIXED,,AUTO

      532     1135    6                END;

      533     1136    5                CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, BASED$ASC)

   1136  2 001605   200064 470500                    LDP0    PTR$,,AUTO
         2 001606   200065 720100                    LXL0    LENGTH,,AUTO
         2 001607   000000 164540                    TCT
         2 001610   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 001611   000000 000000 xsym               ARG     X9OS$CLASS_NUMERIC
         2 001612   200070 000100                    ARG     N,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:81   
         2 001613   200070 235100                    LDA     N,,AUTO
         2 001614   000033 771000                    ARL     27
         2 001615   200067 755100                    STA     S,,AUTO
         2 001616   200070 551140                    STBA    N,'40'O,AUTO
         2 001617   001626 606400 2                  TTN     s:1142

      534     1137    6                  WHENRETURN DO;

      535     1138    6                    BASED$ASC = ZEROES;

   1138  2 001620   040140 100400                    MLR     fill='040'O
         2 001621   000000 000077 1                  ADSC9   ZEROES                   cn=0,n=63
         2 001622   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      536     1139    6                    FIXED = '1'B;

   1139  2 001623   400000 236003                    LDQ     -131072,DU
         2 001624   200063 756100                    STQ     FIXED,,AUTO

      537     1140    6                    CORRECTED_1 = '1'B;

   1140  2 001625   200034 756100                    STQ     CORRECTED_1,,AUTO

      538     1141    6                  END;

      539     1142    5              END;

   1142  2 001626   002227 710000 2                  TRA     s:1216

      540     1143    5              ELSE DO; /* Overpunched trailing sign */

      541     1144    5               CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 0, LENGTH - 1
              1144                         ))

   1144  2 001627   777777 622010                    EAX2    -1,X0
         2 001630   000000 164540                    TCT
         2 001631   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:82   
         2 001632   000000 000000 xsym               ARG     X9OS$CLASS_NUMERIC
         2 001633   200070 000100                    ARG     N,,AUTO
         2 001634   200070 235100                    LDA     N,,AUTO
         2 001635   000033 771000                    ARL     27
         2 001636   200067 755100                    STA     S,,AUTO
         2 001637   200070 551140                    STBA    N,'40'O,AUTO
         2 001640   001642 606400 2                  TTN     s:1146
         2 001641   001714 710000 2                  TRA     s:1155

      542     1145    6                  WHENALTRETURN DO;

      543     1146    6                    C = SUBSTR (BASED$ASC, LENGTH - 1, 1);

   1146  2 001642   200064 470500                    LDP0    PTR$,,AUTO
         2 001643   200065 235100                    LDA     LENGTH,,AUTO
         2 001644   040100 100505                    MLR     fill='040'O
         2 001645   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         2 001646   200073 000001                    ADSC9   C,,AUTO                  cn=0,n=1

      544     1147    7                    IF C >= '0' AND C <= '9' THEN DO;

   1147  2 001647   200073 236100                    LDQ     C,,AUTO
         2 001650   777000 376003                    ANQ     -512,DU
         2 001651   060000 116003                    CMPQ    24576,DU
         2 001652   001671 602000 2                  TNC     s:1152
         2 001653   200073 236100                    LDQ     C,,AUTO
         2 001654   777000 376003                    ANQ     -512,DU
         2 001655   071000 116003                    CMPQ    29184,DU
         2 001656   001660 600000 2                  TZE     s:1148
         2 001657   001671 603000 2                  TRC     s:1152

      545     1148    7                      CALL CHARBIN (N, C);

   1148  2 001660   000100 305500                    DTB
         2 001661   200073 030001                    NDSC9   C,,AUTO                  cn=0,s=nosgn,sf=0,n=1
         2 001662   200070 000004                    NDSC9   N,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:83   
      546     1149    7                      CALL INSERT (BASED$ASC, LENGTH - 1, 1, SUBSTR (OVP_PLUS, N, 1));

   1149  2 001663   200070 236100                    LDQ     N,,AUTO
         2 001664   040105 100406                    MLR     fill='040'O
         2 001665   000020 000001 1                  ADSC9   OVP_PLUS,Q               cn=0,n=1
         2 001666   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1

      547     1150    7                      RETURN; /* Data corrected */

   1150  2 001667   200072 221300                    LDX1  ! N+2,,AUTO
         2 001670   000001 702211                    TSX2  ! 1,X1

      548     1151    7                    END;
      549     1152    6                    IF C >= 'A' AND C <= 'R' OR C = '{' OR C = '}'

   1152  2 001671   200073 236100                    LDQ     C,,AUTO
         2 001672   777000 376003                    ANQ     -512,DU
         2 001673   101000 116003                    CMPQ    33280,DU
         2 001674   001702 602000 2                  TNC     s:1152+9
         2 001675   200073 236100                    LDQ     C,,AUTO
         2 001676   777000 376003                    ANQ     -512,DU
         2 001677   122000 116003                    CMPQ    41984,DU
         2 001700   001712 602000 2                  TNC     s:1153
         2 001701   001712 600000 2                  TZE     s:1153
         2 001702   200073 236100                    LDQ     C,,AUTO
         2 001703   777000 376003                    ANQ     -512,DU
         2 001704   173000 116003                    CMPQ    62976,DU
         2 001705   001712 600000 2                  TZE     s:1153
         2 001706   200073 236100                    LDQ     C,,AUTO
         2 001707   777000 376003                    ANQ     -512,DU
         2 001710   175000 116003                    CMPQ    64000,DU
         2 001711   001714 601000 2                  TNZ     s:1155

      550     1153    6                      THEN ALTRETURN; /* There's nothing wrong with data */

   1153  2 001712   200072 221300                    LDX1  ! N+2,,AUTO
         2 001713   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:84   

      551     1154    6                  END;
      552     1155    5                BASED$ASC = ZEROES;

   1155  2 001714   200065 720100                    LXL0    LENGTH,,AUTO
         2 001715   040140 100400                    MLR     fill='040'O
         2 001716   000000 000077 1                  ADSC9   ZEROES                   cn=0,n=63
         2 001717   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      553     1156    5                CALL INSERT (BASED$ASC, LENGTH - 1, 1, '{');

   1156  2 001720   200064 470500                    LDP0    PTR$,,AUTO
         2 001721   200065 235100                    LDA     LENGTH,,AUTO
         2 001722   040105 100400                    MLR     fill='040'O
         2 001723   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 001724   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1

      554     1157    5                FIXED = '1'B;

   1157  2 001725   400000 236003                    LDQ     -131072,DU
         2 001726   200063 756100                    STQ     FIXED,,AUTO

      555     1158    5                    CORRECTED_1 = '1'B;

   1158  2 001727   200034 756100                    STQ     CORRECTED_1,,AUTO

      556     1159    5              END;

   1159  2 001730   002227 710000 2                  TRA     s:1216

      557     1160    4            CASE (%TRAILING_SIGN);

      558     1161    4             CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 0, LENGTH - 1))

   1161  2 001731   777777 622010                    EAX2    -1,X0
         2 001732   000000 164540                    TCT
         2 001733   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:85   
         2 001734   000000 000000 xsym               ARG     X9OS$CLASS_NUMERIC
         2 001735   200070 000100                    ARG     N,,AUTO
         2 001736   200070 235100                    LDA     N,,AUTO
         2 001737   000033 771000                    ARL     27
         2 001740   200067 755100                    STA     S,,AUTO
         2 001741   200070 551140                    STBA    N,'40'O,AUTO
         2 001742   001744 606400 2                  TTN     s:1163
         2 001743   001760 710000 2                  TRA     s:1167

      559     1162    5                WHENALTRETURN DO;

      560     1163    5                  IF SUBSTR (BASED$ASC, LENGTH - 1, 1) = '+' OR

   1163  2 001744   200064 470500                    LDP0    PTR$,,AUTO
         2 001745   200065 235100                    LDA     LENGTH,,AUTO
         2 001746   040000 106505                    CMPC    fill='040'O
         2 001747   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         2 001750   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 001751   001756 600000 2                  TZE     s:1165
         2 001752   040000 106505                    CMPC    fill='040'O
         2 001753   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         2 001754   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 001755   001760 601000 2                  TNZ     s:1167

      561     1164    5                      SUBSTR (BASED$ASC, LENGTH - 1, 1) = '-'
      562     1165    5                    THEN ALTRETURN; /* Data OK as is */

   1165  2 001756   200072 221300                    LDX1  ! N+2,,AUTO
         2 001757   000000 702211                    TSX2  ! 0,X1

      563     1166    5                END;
      564     1167    4              BASED$ASC = ZEROES;

   1167  2 001760   200065 720100                    LXL0    LENGTH,,AUTO
         2 001761   040140 100400                    MLR     fill='040'O
         2 001762   000000 000077 1                  ADSC9   ZEROES                   cn=0,n=63
         2 001763   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:86   

      565     1168    4              CALL INSERT (BASED$ASC, LENGTH - 1, 1, '+');

   1168  2 001764   200064 470500                    LDP0    PTR$,,AUTO
         2 001765   200065 235100                    LDA     LENGTH,,AUTO
         2 001766   040105 100400                    MLR     fill='040'O
         2 001767   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 001770   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1

      566     1169    4              CORRECTED_1 = '1'B;

   1169  2 001771   400000 236003                    LDQ     -131072,DU
         2 001772   200034 756100                    STQ     CORRECTED_1,,AUTO

      567     1170    4              FIXED = '1'B;

   1170  2 001773   200063 756100                    STQ     FIXED,,AUTO
         2 001774   002227 710000 2                  TRA     s:1216

      568     1171    4            CASE (%LEADING_SIGN);

      569     1172    4             CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 1, LENGTH - 1))

   1172  2 001775   777777 622010                    EAX2    -1,X0
         2 001776   000000 164540                    TCT
         2 001777   000000 200012                    ADSC9   0,,PR0                   cn=1,n=*X2
         2 002000   000000 000000 xsym               ARG     X9OS$CLASS_NUMERIC
         2 002001   200070 000100                    ARG     N,,AUTO
         2 002002   200070 235100                    LDA     N,,AUTO
         2 002003   000033 771000                    ARL     27
         2 002004   200067 755100                    STA     S,,AUTO
         2 002005   200070 551140                    STBA    N,'40'O,AUTO
         2 002006   002010 606400 2                  TTN     s:1174
         2 002007   002056 710000 2                  TRA     s:1185

      570     1173    5                WHENALTRETURN DO;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:87   
      571     1174    6                  DO SELECT (SUBSTR (BASED$ASC, 0, 1));

   1174  2 002010   200064 470500                    LDP0    PTR$,,AUTO
         2 002011   040000 106500                    CMPC    fill='040'O
         2 002012   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002013   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 002014   002035 602000 2                  TNC     s:1174+21
         2 002015   002042 600000 2                  TZE     s:1176
         2 002016   040000 106500                    CMPC    fill='040'O
         2 002017   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002020   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 002021   002030 602000 2                  TNC     s:1174+16
         2 002022   002044 600000 2                  TZE     s:1178
         2 002023   040000 106500                    CMPC    fill='040'O
         2 002024   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002025   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 002026   002056 601000 2                  TNZ     s:1185
         2 002027   002051 710000 2                  TRA     s:1181
         2 002030   040000 106500                    CMPC    fill='040'O
         2 002031   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002032   000010 000001 3                  ADSC9   8                        cn=0,n=1
         2 002033   002056 601000 2                  TNZ     s:1185
         2 002034   002044 710000 2                  TRA     s:1178
         2 002035   040000 106500                    CMPC    fill='040'O
         2 002036   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002037   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 002040   002056 601000 2                  TNZ     s:1185
         2 002041   002042 710000 2                  TRA     s:1176

      572     1175    6                    SELECT ('+', '-');

      573     1176    6                      ALTRETURN; /* Data OK */

   1176  2 002042   200072 221300                    LDX1  ! N+2,,AUTO
         2 002043   000000 702211                    TSX2  ! 0,X1

      574     1177    6                    SELECT ('0', '{');
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:88   

      575     1178    6                      CALL INSERT (BASED$ASC, 0, 1, '+');

   1178  2 002044   040100 100400                    MLR     fill='040'O
         2 002045   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 002046   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      576     1179    6                      RETURN;

   1179  2 002047   200072 221300                    LDX1  ! N+2,,AUTO
         2 002050   000001 702211                    TSX2  ! 1,X1

      577     1180    6                    SELECT ('}');

      578     1181    6                      CALL INSERT (BASED$ASC, 0, 1, '-');

   1181  2 002051   040100 100400                    MLR     fill='040'O
         2 002052   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 002053   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      579     1182    6                      RETURN;

   1182  2 002054   200072 221300                    LDX1  ! N+2,,AUTO
         2 002055   000001 702211                    TSX2  ! 1,X1

      580     1183    6                  END;

      581     1184    5                END;
      582     1185    4              CALL CONCAT (BASED$ASC, '+', ZEROES);

   1185  2 002056   200065 720100                    LXL0    LENGTH,,AUTO
         2 002057   040140 100400                    MLR     fill='040'O
         2 002060   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 002061   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 002062   200065 236100                    LDQ     LENGTH,,AUTO
         2 002063   000001 116007                    CMPQ    1,DL
         2 002064   002072 604400 2                  TMOZ    s:1186
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:89   
         2 002065   777777 620006                    EAX0    -1,QL
         2 002066   200064 470500                    LDP0    PTR$,,AUTO
         2 002067   040140 100400                    MLR     fill='040'O
         2 002070   000000 000077 1                  ADSC9   ZEROES                   cn=0,n=63
         2 002071   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      583     1186    4              FIXED = '1'B;

   1186  2 002072   400000 236003                    LDQ     -131072,DU
         2 002073   200063 756100                    STQ     FIXED,,AUTO

      584     1187    4              CORRECTED_1 = '1'B;

   1187  2 002074   200034 756100                    STQ     CORRECTED_1,,AUTO
         2 002075   002227 710000 2                  TRA     s:1216

      585     1188    4            CASE (ELSE);

      586     1189    5              IF TYPE > 1 THEN DO; /* Overpunched leading sign */

   1189  2 002076   200041 471500                    LDP1    @TYPE,,AUTO
         2 002077   100000 235100                    LDA     0,,PR1
         2 002100   000002 115007                    CMPA    2,DL
         2 002101   002227 602000 2                  TNC     s:1216

      587     1190    5               CALL SEARCH (N, S, X9OS$CLASS_NUMERIC, SUBSTR (BASED$ASC, 1, LENGTH - 1
              1190                         ))

   1190  2 002102   777777 622010                    EAX2    -1,X0
         2 002103   000000 164540                    TCT
         2 002104   000000 200012                    ADSC9   0,,PR0                   cn=1,n=*X2
         2 002105   000000 000000 xsym               ARG     X9OS$CLASS_NUMERIC
         2 002106   200070 000100                    ARG     N,,AUTO
         2 002107   200070 235100                    LDA     N,,AUTO
         2 002110   000033 771000                    ARL     27
         2 002111   200067 755100                    STA     S,,AUTO
         2 002112   200070 551140                    STBA    N,'40'O,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:90   
         2 002113   002115 606400 2                  TTN     s:1192
         2 002114   002210 710000 2                  TRA     s:1211

      588     1191    6                  WHENALTRETURN DO;

      589     1192    6                    C = SUBSTR (BASED$ASC, 0, 1);

   1192  2 002115   200064 470500                    LDP0    PTR$,,AUTO
         2 002116   040100 100500                    MLR     fill='040'O
         2 002117   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002120   200073 000001                    ADSC9   C,,AUTO                  cn=0,n=1

      590     1193    7                    IF C > '9' THEN DO;

   1193  2 002121   200073 236100                    LDQ     C,,AUTO
         2 002122   777000 376003                    ANQ     -512,DU
         2 002123   071000 116003                    CMPQ    29184,DU
         2 002124   002151 602000 2                  TNC     s:1197
         2 002125   002151 600000 2                  TZE     s:1197

      591     1194    7                      IF C >= 'A' AND C <= 'R' OR C = '{' OR C = '}'

   1194  2 002126   200073 236100                    LDQ     C,,AUTO
         2 002127   777000 376003                    ANQ     -512,DU
         2 002130   101000 116003                    CMPQ    33280,DU
         2 002131   002137 602000 2                  TNC     s:1194+9
         2 002132   200073 236100                    LDQ     C,,AUTO
         2 002133   777000 376003                    ANQ     -512,DU
         2 002134   122000 116003                    CMPQ    41984,DU
         2 002135   002147 602000 2                  TNC     s:1195
         2 002136   002147 600000 2                  TZE     s:1195
         2 002137   200073 236100                    LDQ     C,,AUTO
         2 002140   777000 376003                    ANQ     -512,DU
         2 002141   173000 116003                    CMPQ    62976,DU
         2 002142   002147 600000 2                  TZE     s:1195
         2 002143   200073 236100                    LDQ     C,,AUTO
         2 002144   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:91   
         2 002145   175000 116003                    CMPQ    64000,DU
         2 002146   002210 601000 2                  TNZ     s:1211

      592     1195    7                        THEN ALTRETURN; /* Data OK */

   1195  2 002147   200072 221300                    LDX1  ! N+2,,AUTO
         2 002150   000000 702211                    TSX2  ! 0,X1

      593     1196    7                    END;
      594     1197    7                    ELSE IF C >= '0' THEN DO;

   1197  2 002151   200073 236100                    LDQ     C,,AUTO
         2 002152   777000 376003                    ANQ     -512,DU
         2 002153   060000 116003                    CMPQ    24576,DU
         2 002154   002166 602000 2                  TNC     s:1202

      595     1198    7                      CALL CHARBIN (S, C);

   1198  2 002155   000100 305500                    DTB
         2 002156   200073 030001                    NDSC9   C,,AUTO                  cn=0,s=nosgn,sf=0,n=1
         2 002157   200067 000004                    NDSC9   S,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      596     1199    7                      CALL INSERT (BASED$ASC, 0, 1, SUBSTR (OVP_PLUS, S, 1));

   1199  2 002160   200067 235100                    LDA     S,,AUTO
         2 002161   040100 100405                    MLR     fill='040'O
         2 002162   000020 000001 1                  ADSC9   OVP_PLUS,A               cn=0,n=1
         2 002163   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      597     1200    7                      RETURN; /* Data corrected */

   1200  2 002164   200072 221300                    LDX1  ! N+2,,AUTO
         2 002165   000001 702211                    TSX2  ! 1,X1

      598     1201    7                    END;
      599     1202    7                    ELSE IF C = '+' THEN DO;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:92   
   1202  2 002166   200073 236100                    LDQ     C,,AUTO
         2 002167   777000 376003                    ANQ     -512,DU
         2 002170   053000 116003                    CMPQ    22016,DU
         2 002171   002177 601000 2                  TNZ     s:1206

      600     1203    7                      CALL INSERT (BASED$ASC, 0, 1, '{');

   1203  2 002172   040100 100400                    MLR     fill='040'O
         2 002173   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 002174   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      601     1204    7                      RETURN;

   1204  2 002175   200072 221300                    LDX1  ! N+2,,AUTO
         2 002176   000001 702211                    TSX2  ! 1,X1

      602     1205    7                    END;
      603     1206    7                    ELSE IF C = '-' THEN DO;

   1206  2 002177   200073 236100                    LDQ     C,,AUTO
         2 002200   777000 376003                    ANQ     -512,DU
         2 002201   055000 116003                    CMPQ    23040,DU
         2 002202   002210 601000 2                  TNZ     s:1211

      604     1207    7                      CALL INSERT (BASED$ASC, 0, 1, '}');

   1207  2 002203   040100 100400                    MLR     fill='040'O
         2 002204   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 002205   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      605     1208    7                      RETURN;

   1208  2 002206   200072 221300                    LDX1  ! N+2,,AUTO
         2 002207   000001 702211                    TSX2  ! 1,X1

      606     1209    7                    END;
      607     1210    6                  END;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:93   
      608     1211    5                CALL CONCAT (BASED$ASC, '{', ZEROES);

   1211  2 002210   200065 720100                    LXL0    LENGTH,,AUTO
         2 002211   040140 100400                    MLR     fill='040'O
         2 002212   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 002213   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 002214   200065 236100                    LDQ     LENGTH,,AUTO
         2 002215   000001 116007                    CMPQ    1,DL
         2 002216   002224 604400 2                  TMOZ    s:1212
         2 002217   777777 620006                    EAX0    -1,QL
         2 002220   200064 470500                    LDP0    PTR$,,AUTO
         2 002221   040140 100400                    MLR     fill='040'O
         2 002222   000000 000077 1                  ADSC9   ZEROES                   cn=0,n=63
         2 002223   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      609     1212    5                FIXED = '1'B;

   1212  2 002224   400000 236003                    LDQ     -131072,DU
         2 002225   200063 756100                    STQ     FIXED,,AUTO

      610     1213    5                CORRECTED_1 = '1'B;

   1213  2 002226   200034 756100                    STQ     CORRECTED_1,,AUTO

      611     1214    5              END; /* LSF illegal */

      612     1215    4          END; /* CASE */

      613     1216    3          IF FIXED THEN RETURN;

   1216  2 002227   200063 234100                    SZN     FIXED,,AUTO
         2 002230   002233 605000 2                  TPL     s:1218

   1216  2 002231   200072 221300                    LDX1  ! N+2,,AUTO
         2 002232   000001 702211                    TSX2  ! 1,X1

      614     1217
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:94   
      615     1218    3          ALTRETURN ; /* No Correction */

   1218  2 002233   200072 221300                    LDX1  ! N+2,,AUTO
         2 002234   000000 702211                    TSX2  ! 0,X1

      616     1219
      617     1220    3   END ASCII_CORRECTION ;
      618     1221
      619     1222    2   END CORRECTION ;
      620     1223
      621     1224        %EJECT ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:95   
      622     1225        /*=================*/
      623     1226    1     REPORT_CORRECTION: PROC ;

   1226  2 002235   200036 741300       REPORT_CORR* STX1  ! CORRECTED_1+2,,AUTO

      624     1227        /*=================*/
      625     1228
      626     1229    2   DCL 1   MSG1           STATIC,
      627     1230    2        2  ADDR1          CHAR (12),
      628     1231    2        2  *              CHAR (2) INIT (' '),
      629     1232    2        2  INST           CHAR (12),
      630     1233    2        2  *              CHAR (1) INIT (' '),
      631     1234    2        2  OPCODE         CHAR (5) ;
      632     1235    2   DCL     MSG1A          REDEF MSG1 CHAR (32) ;
      633     1236    2   DCL     IC$            PTR ;
      634     1237
      635     1238    2          IC$ = ADDR (INSTRUCTION) ;

   1238  2 002236   200003 236100                    LDQ     @INSTRUCTION,,AUTO
         2 002237   200037 756100                    STQ     IC$,,AUTO

      636     1239    2          CALL X8CO$CONV_TO_OCTAL( IC$, MSG1.ADDR1 ) ;

   1239  2 002240   000012 236000 3                  LDQ     10
         2 002241   200101 756100                    STQ     @J+2,,AUTO
         2 002242   200037 630500                    EPPR0   IC$,,AUTO
         2 002243   200100 450500                    STP0    @J+1,,AUTO
         2 002244   200100 630500                    EPPR0   @J+1,,AUTO
         2 002245   000011 631400 3                  EPPR1   9
         2 002246   000000 701000 xent               TSX1    X8CO$CONV_TO_OCTAL
         2 002247   000000 011000                    NOP     0

      637     1240    2          CALL X8CO$CONV_TO_OCTAL( INSTRUCTION, MSG1.INST ) ;

   1240  2 002250   000013 236000 3                  LDQ     11
         2 002251   200003 235100                    LDA     @INSTRUCTION,,AUTO
         2 002252   200100 757100                    STAQ    @J+1,,AUTO
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:96   
         2 002253   200100 630500                    EPPR0   @J+1,,AUTO
         2 002254   000011 631400 3                  EPPR1   9
         2 002255   000000 701000 xent               TSX1    X8CO$CONV_TO_OCTAL
         2 002256   000000 011000                    NOP     0

      638     1241    3          DO CASE (INSTRUCTION.OP_CODE) ;

   1241  2 002257   200003 470500                    LDP0    @INSTRUCTION,,AUTO
         2 002260   000000 236100                    LDQ     0,,PR0
         2 002261   000011 772000                    QRL     9
         2 002262   000777 376007                    ANQ     511,DL
         2 002263   000024 136007                    SBLQ    20,DL
         2 002264   000320 116007                    CMPQ    208,DL
         2 002265   002267 602006 2                  TNC     s:1241+8,QL
         2 002266   002736 710000 2                  TRA     s:1287
         2 002267   002707 710000 2                  TRA     s:1275
         2 002270   002736 710000 2                  TRA     s:1287
         2 002271   002736 710000 2                  TRA     s:1287
         2 002272   002736 710000 2                  TRA     s:1287
         2 002273   002736 710000 2                  TRA     s:1287
         2 002274   002736 710000 2                  TRA     s:1287
         2 002275   002736 710000 2                  TRA     s:1287
         2 002276   002736 710000 2                  TRA     s:1287
         2 002277   002736 710000 2                  TRA     s:1287
         2 002300   002736 710000 2                  TRA     s:1287
         2 002301   002736 710000 2                  TRA     s:1287
         2 002302   002736 710000 2                  TRA     s:1287
         2 002303   002736 710000 2                  TRA     s:1287
         2 002304   002736 710000 2                  TRA     s:1287
         2 002305   002736 710000 2                  TRA     s:1287
         2 002306   002736 710000 2                  TRA     s:1287
         2 002307   002736 710000 2                  TRA     s:1287
         2 002310   002736 710000 2                  TRA     s:1287
         2 002311   002736 710000 2                  TRA     s:1287
         2 002312   002736 710000 2                  TRA     s:1287
         2 002313   002736 710000 2                  TRA     s:1287
         2 002314   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:97   
         2 002315   002736 710000 2                  TRA     s:1287
         2 002316   002736 710000 2                  TRA     s:1287
         2 002317   002736 710000 2                  TRA     s:1287
         2 002320   002736 710000 2                  TRA     s:1287
         2 002321   002736 710000 2                  TRA     s:1287
         2 002322   002736 710000 2                  TRA     s:1287
         2 002323   002736 710000 2                  TRA     s:1287
         2 002324   002736 710000 2                  TRA     s:1287
         2 002325   002736 710000 2                  TRA     s:1287
         2 002326   002736 710000 2                  TRA     s:1287
         2 002327   002736 710000 2                  TRA     s:1287
         2 002330   002736 710000 2                  TRA     s:1287
         2 002331   002736 710000 2                  TRA     s:1287
         2 002332   002736 710000 2                  TRA     s:1287
         2 002333   002736 710000 2                  TRA     s:1287
         2 002334   002736 710000 2                  TRA     s:1287
         2 002335   002736 710000 2                  TRA     s:1287
         2 002336   002736 710000 2                  TRA     s:1287
         2 002337   002736 710000 2                  TRA     s:1287
         2 002340   002736 710000 2                  TRA     s:1287
         2 002341   002736 710000 2                  TRA     s:1287
         2 002342   002736 710000 2                  TRA     s:1287
         2 002343   002736 710000 2                  TRA     s:1287
         2 002344   002736 710000 2                  TRA     s:1287
         2 002345   002736 710000 2                  TRA     s:1287
         2 002346   002736 710000 2                  TRA     s:1287
         2 002347   002736 710000 2                  TRA     s:1287
         2 002350   002736 710000 2                  TRA     s:1287
         2 002351   002736 710000 2                  TRA     s:1287
         2 002352   002736 710000 2                  TRA     s:1287
         2 002353   002736 710000 2                  TRA     s:1287
         2 002354   002736 710000 2                  TRA     s:1287
         2 002355   002736 710000 2                  TRA     s:1287
         2 002356   002736 710000 2                  TRA     s:1287
         2 002357   002736 710000 2                  TRA     s:1287
         2 002360   002736 710000 2                  TRA     s:1287
         2 002361   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:98   
         2 002362   002736 710000 2                  TRA     s:1287
         2 002363   002736 710000 2                  TRA     s:1287
         2 002364   002736 710000 2                  TRA     s:1287
         2 002365   002736 710000 2                  TRA     s:1287
         2 002366   002736 710000 2                  TRA     s:1287
         2 002367   002736 710000 2                  TRA     s:1287
         2 002370   002736 710000 2                  TRA     s:1287
         2 002371   002736 710000 2                  TRA     s:1287
         2 002372   002736 710000 2                  TRA     s:1287
         2 002373   002736 710000 2                  TRA     s:1287
         2 002374   002736 710000 2                  TRA     s:1287
         2 002375   002736 710000 2                  TRA     s:1287
         2 002376   002736 710000 2                  TRA     s:1287
         2 002377   002736 710000 2                  TRA     s:1287
         2 002400   002736 710000 2                  TRA     s:1287
         2 002401   002736 710000 2                  TRA     s:1287
         2 002402   002736 710000 2                  TRA     s:1287
         2 002403   002736 710000 2                  TRA     s:1287
         2 002404   002736 710000 2                  TRA     s:1287
         2 002405   002736 710000 2                  TRA     s:1287
         2 002406   002736 710000 2                  TRA     s:1287
         2 002407   002736 710000 2                  TRA     s:1287
         2 002410   002736 710000 2                  TRA     s:1287
         2 002411   002736 710000 2                  TRA     s:1287
         2 002412   002736 710000 2                  TRA     s:1287
         2 002413   002736 710000 2                  TRA     s:1287
         2 002414   002736 710000 2                  TRA     s:1287
         2 002415   002736 710000 2                  TRA     s:1287
         2 002416   002736 710000 2                  TRA     s:1287
         2 002417   002736 710000 2                  TRA     s:1287
         2 002420   002736 710000 2                  TRA     s:1287
         2 002421   002736 710000 2                  TRA     s:1287
         2 002422   002736 710000 2                  TRA     s:1287
         2 002423   002736 710000 2                  TRA     s:1287
         2 002424   002736 710000 2                  TRA     s:1287
         2 002425   002736 710000 2                  TRA     s:1287
         2 002426   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:99   
         2 002427   002736 710000 2                  TRA     s:1287
         2 002430   002736 710000 2                  TRA     s:1287
         2 002431   002736 710000 2                  TRA     s:1287
         2 002432   002736 710000 2                  TRA     s:1287
         2 002433   002736 710000 2                  TRA     s:1287
         2 002434   002736 710000 2                  TRA     s:1287
         2 002435   002736 710000 2                  TRA     s:1287
         2 002436   002736 710000 2                  TRA     s:1287
         2 002437   002736 710000 2                  TRA     s:1287
         2 002440   002736 710000 2                  TRA     s:1287
         2 002441   002736 710000 2                  TRA     s:1287
         2 002442   002736 710000 2                  TRA     s:1287
         2 002443   002736 710000 2                  TRA     s:1287
         2 002444   002736 710000 2                  TRA     s:1287
         2 002445   002607 710000 2                  TRA     s:1243
         2 002446   002717 710000 2                  TRA     s:1279
         2 002447   002736 710000 2                  TRA     s:1287
         2 002450   002736 710000 2                  TRA     s:1287
         2 002451   002663 710000 2                  TRA     s:1265
         2 002452   002643 710000 2                  TRA     s:1257
         2 002453   002736 710000 2                  TRA     s:1287
         2 002454   002736 710000 2                  TRA     s:1287
         2 002455   002736 710000 2                  TRA     s:1287
         2 002456   002736 710000 2                  TRA     s:1287
         2 002457   002736 710000 2                  TRA     s:1287
         2 002460   002736 710000 2                  TRA     s:1287
         2 002461   002736 710000 2                  TRA     s:1287
         2 002462   002736 710000 2                  TRA     s:1287
         2 002463   002736 710000 2                  TRA     s:1287
         2 002464   002736 710000 2                  TRA     s:1287
         2 002465   002617 710000 2                  TRA     s:1247
         2 002466   002727 710000 2                  TRA     s:1283
         2 002467   002736 710000 2                  TRA     s:1287
         2 002470   002736 710000 2                  TRA     s:1287
         2 002471   002673 710000 2                  TRA     s:1269
         2 002472   002653 710000 2                  TRA     s:1261
         2 002473   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:100  
         2 002474   002736 710000 2                  TRA     s:1287
         2 002475   002736 710000 2                  TRA     s:1287
         2 002476   002736 710000 2                  TRA     s:1287
         2 002477   002736 710000 2                  TRA     s:1287
         2 002500   002736 710000 2                  TRA     s:1287
         2 002501   002736 710000 2                  TRA     s:1287
         2 002502   002736 710000 2                  TRA     s:1287
         2 002503   002736 710000 2                  TRA     s:1287
         2 002504   002736 710000 2                  TRA     s:1287
         2 002505   002613 710000 2                  TRA     s:1245
         2 002506   002723 710000 2                  TRA     s:1281
         2 002507   002736 710000 2                  TRA     s:1287
         2 002510   002736 710000 2                  TRA     s:1287
         2 002511   002667 710000 2                  TRA     s:1267
         2 002512   002647 710000 2                  TRA     s:1259
         2 002513   002736 710000 2                  TRA     s:1287
         2 002514   002736 710000 2                  TRA     s:1287
         2 002515   002736 710000 2                  TRA     s:1287
         2 002516   002736 710000 2                  TRA     s:1287
         2 002517   002736 710000 2                  TRA     s:1287
         2 002520   002736 710000 2                  TRA     s:1287
         2 002521   002736 710000 2                  TRA     s:1287
         2 002522   002736 710000 2                  TRA     s:1287
         2 002523   002736 710000 2                  TRA     s:1287
         2 002524   002736 710000 2                  TRA     s:1287
         2 002525   002623 710000 2                  TRA     s:1249
         2 002526   002733 710000 2                  TRA     s:1285
         2 002527   002736 710000 2                  TRA     s:1287
         2 002530   002736 710000 2                  TRA     s:1287
         2 002531   002677 710000 2                  TRA     s:1271
         2 002532   002657 710000 2                  TRA     s:1263
         2 002533   002736 710000 2                  TRA     s:1287
         2 002534   002736 710000 2                  TRA     s:1287
         2 002535   002736 710000 2                  TRA     s:1287
         2 002536   002736 710000 2                  TRA     s:1287
         2 002537   002736 710000 2                  TRA     s:1287
         2 002540   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:101  
         2 002541   002736 710000 2                  TRA     s:1287
         2 002542   002736 710000 2                  TRA     s:1287
         2 002543   002703 710000 2                  TRA     s:1273
         2 002544   002736 710000 2                  TRA     s:1287
         2 002545   002736 710000 2                  TRA     s:1287
         2 002546   002627 710000 2                  TRA     s:1251
         2 002547   002736 710000 2                  TRA     s:1287
         2 002550   002637 710000 2                  TRA     s:1255
         2 002551   002736 710000 2                  TRA     s:1287
         2 002552   002736 710000 2                  TRA     s:1287
         2 002553   002736 710000 2                  TRA     s:1287
         2 002554   002736 710000 2                  TRA     s:1287
         2 002555   002736 710000 2                  TRA     s:1287
         2 002556   002736 710000 2                  TRA     s:1287
         2 002557   002736 710000 2                  TRA     s:1287
         2 002560   002736 710000 2                  TRA     s:1287
         2 002561   002736 710000 2                  TRA     s:1287
         2 002562   002736 710000 2                  TRA     s:1287
         2 002563   002736 710000 2                  TRA     s:1287
         2 002564   002736 710000 2                  TRA     s:1287
         2 002565   002736 710000 2                  TRA     s:1287
         2 002566   002736 710000 2                  TRA     s:1287
         2 002567   002736 710000 2                  TRA     s:1287
         2 002570   002736 710000 2                  TRA     s:1287
         2 002571   002736 710000 2                  TRA     s:1287
         2 002572   002736 710000 2                  TRA     s:1287
         2 002573   002736 710000 2                  TRA     s:1287
         2 002574   002736 710000 2                  TRA     s:1287
         2 002575   002736 710000 2                  TRA     s:1287
         2 002576   002736 710000 2                  TRA     s:1287
         2 002577   002736 710000 2                  TRA     s:1287
         2 002600   002736 710000 2                  TRA     s:1287
         2 002601   002736 710000 2                  TRA     s:1287
         2 002602   002736 710000 2                  TRA     s:1287
         2 002603   002713 710000 2                  TRA     s:1277
         2 002604   002736 710000 2                  TRA     s:1287
         2 002605   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:102  
         2 002606   002633 710000 2                  TRA     s:1253

      639     1242    3            CASE (%AD2D_OP) ;

      640     1243    3              MSG1.OPCODE = 'AD2D' ;

   1243  2 002607   040000 100400                    MLR     fill='040'O
         2 002610   000027 000004 1                  ADSC9   ISR_PTR+1                cn=0,n=4
         2 002611   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002612   002736 710000 2                  TRA     s:1287

      641     1244    3            CASE (%AD2DX_OP) ;

      642     1245    3              MSG1.OPCODE = 'AD2DX' ;

   1245  2 002613   040000 100400                    MLR     fill='040'O
         2 002614   000030 000005 1                  ADSC9   ISR_PTR+2                cn=0,n=5
         2 002615   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002616   002736 710000 2                  TRA     s:1287

      643     1246    3            CASE (%AD3D_OP) ;

      644     1247    3              MSG1.OPCODE = 'AD3D' ;

   1247  2 002617   040000 100400                    MLR     fill='040'O
         2 002620   000032 000004 1                  ADSC9   ISR_PTR+4                cn=0,n=4
         2 002621   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002622   002736 710000 2                  TRA     s:1287

      645     1248    3            CASE (%AD3DX_OP) ;

      646     1249    3              MSG1.OPCODE = 'AD3DX' ;

   1249  2 002623   040000 100400                    MLR     fill='040'O
         2 002624   000033 000005 1                  ADSC9   ISR_PTR+5                cn=0,n=5
         2 002625   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002626   002736 710000 2                  TRA     s:1287
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:103  

      647     1250    3            CASE (%CMPN_OP) ;

      648     1251    3              MSG1.OPCODE = 'CMPN' ;

   1251  2 002627   040000 100400                    MLR     fill='040'O
         2 002630   000035 000004 1                  ADSC9   ISR_PTR+7                cn=0,n=4
         2 002631   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002632   002736 710000 2                  TRA     s:1287

      649     1252    3            CASE (%CMPNX_OP) ;

      650     1253    3              MSG1.OPCODE = 'CMPNX' ;

   1253  2 002633   040000 100400                    MLR     fill='040'O
         2 002634   000036 000005 1                  ADSC9   ISR_PTR+8                cn=0,n=5
         2 002635   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002636   002736 710000 2                  TRA     s:1287

      651     1254    3            CASE (%DTB_OP) ;

      652     1255    3              MSG1.OPCODE = 'DTB' ;

   1255  2 002637   040000 100400                    MLR     fill='040'O
         2 002640   000040 000003 1                  ADSC9   ISR_PTR+10               cn=0,n=3
         2 002641   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002642   002736 710000 2                  TRA     s:1287

      653     1256    3            CASE (%DV2D_OP) ;

      654     1257    3              MSG1.OPCODE = 'DV2D' ;

   1257  2 002643   040000 100400                    MLR     fill='040'O
         2 002644   000041 000004 1                  ADSC9   ISR_PTR+11               cn=0,n=4
         2 002645   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002646   002736 710000 2                  TRA     s:1287

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:104  
      655     1258    3            CASE (%DV2DX_OP) ;

      656     1259    3              MSG1.OPCODE = 'DV2DX' ;

   1259  2 002647   040000 100400                    MLR     fill='040'O
         2 002650   000042 000005 1                  ADSC9   ISR_PTR+12               cn=0,n=5
         2 002651   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002652   002736 710000 2                  TRA     s:1287

      657     1260    3            CASE (%DV3D_OP) ;

      658     1261    3              MSG1.OPCODE = 'DV3D' ;

   1261  2 002653   040000 100400                    MLR     fill='040'O
         2 002654   000044 000004 1                  ADSC9   ISR_PTR+14               cn=0,n=4
         2 002655   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002656   002736 710000 2                  TRA     s:1287

      659     1262    3            CASE (%DV3DX_OP) ;

      660     1263    3              MSG1.OPCODE = 'DV3DX' ;

   1263  2 002657   040000 100400                    MLR     fill='040'O
         2 002660   000045 000005 1                  ADSC9   ISR_PTR+15               cn=0,n=5
         2 002661   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002662   002736 710000 2                  TRA     s:1287

      661     1264    3            CASE (%MP2D_OP) ;

      662     1265    3              MSG1.OPCODE = 'MP2D' ;

   1265  2 002663   040000 100400                    MLR     fill='040'O
         2 002664   000047 000004 1                  ADSC9   ISR_PTR+17               cn=0,n=4
         2 002665   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002666   002736 710000 2                  TRA     s:1287

      663     1266    3            CASE (%MP2DX_OP) ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:105  

      664     1267    3              MSG1.OPCODE = 'MP2DX' ;

   1267  2 002667   040000 100400                    MLR     fill='040'O
         2 002670   000050 000005 1                  ADSC9   ISR_PTR+18               cn=0,n=5
         2 002671   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002672   002736 710000 2                  TRA     s:1287

      665     1268    3            CASE (%MP3D_OP) ;

      666     1269    3              MSG1.OPCODE = 'MP3D' ;

   1269  2 002673   040000 100400                    MLR     fill='040'O
         2 002674   000052 000004 1                  ADSC9   ISR_PTR+20               cn=0,n=4
         2 002675   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002676   002736 710000 2                  TRA     s:1287

      667     1270    3            CASE (%MP3DX_OP) ;

      668     1271    3              MSG1.OPCODE = 'MP3DX' ;

   1271  2 002677   040000 100400                    MLR     fill='040'O
         2 002700   000053 000005 1                  ADSC9   ISR_PTR+21               cn=0,n=5
         2 002701   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002702   002736 710000 2                  TRA     s:1287

      669     1272    3            CASE (%MVN_OP) ;

      670     1273    3              MSG1.OPCODE = 'MVN' ;

   1273  2 002703   040000 100400                    MLR     fill='040'O
         2 002704   000055 000003 1                  ADSC9   ISR_PTR+23               cn=0,n=3
         2 002705   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002706   002736 710000 2                  TRA     s:1287

      671     1274    3            CASE (%MVNE_OP) ;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:106  
      672     1275    3              MSG1.OPCODE = 'MVNE' ;

   1275  2 002707   040000 100400                    MLR     fill='040'O
         2 002710   000056 000004 1                  ADSC9   ISR_PTR+24               cn=0,n=4
         2 002711   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002712   002736 710000 2                  TRA     s:1287

      673     1276    3            CASE (%MVNX_OP) ;

      674     1277    3              MSG1.OPCODE = 'MVNX' ;

   1277  2 002713   040000 100400                    MLR     fill='040'O
         2 002714   000057 000004 1                  ADSC9   ISR_PTR+25               cn=0,n=4
         2 002715   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002716   002736 710000 2                  TRA     s:1287

      675     1278    3            CASE (%SB2D_OP) ;

      676     1279    3              MSG1.OPCODE = 'SB2D' ;

   1279  2 002717   040000 100400                    MLR     fill='040'O
         2 002720   000060 000004 1                  ADSC9   ISR_PTR+26               cn=0,n=4
         2 002721   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002722   002736 710000 2                  TRA     s:1287

      677     1280    3            CASE (%SB2DX_OP) ;

      678     1281    3              MSG1.OPCODE = 'SB2DX' ;

   1281  2 002723   040000 100400                    MLR     fill='040'O
         2 002724   000061 000005 1                  ADSC9   ISR_PTR+27               cn=0,n=5
         2 002725   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002726   002736 710000 2                  TRA     s:1287

      679     1282    3            CASE (%SB3D_OP) ;

      680     1283    3              MSG1.OPCODE = 'SB3D' ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:107  

   1283  2 002727   040000 100400                    MLR     fill='040'O
         2 002730   000063 000004 1                  ADSC9   ISR_PTR+29               cn=0,n=4
         2 002731   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5
         2 002732   002736 710000 2                  TRA     s:1287

      681     1284    3            CASE (%SB3DX_OP) ;

      682     1285    3              MSG1.OPCODE = 'SB3DX' ;

   1285  2 002733   040000 100400                    MLR     fill='040'O
         2 002734   000064 000005 1                  ADSC9   ISR_PTR+30               cn=0,n=5
         2 002735   000032 600005 0                  ADSC9   MSG1+6                   cn=3,n=5

      683     1286    3          END ;

      684     1287    2          SPECIAL_ERR_MSG = MSG1A ;

   1287  2 002736   040100 100400                    MLR     fill='040'O
         2 002737   000024 000040 0                  ADSC9   MSG1                     cn=0,n=32
         2 002740   200006 000120                    ADSC9   SPECIAL_ERR_MSG,,AUTO    cn=0,n=80

      685     1288    2          CALL X8ER$ERROR( %ILLEGAL_EIS_DATA, SPECIAL_ERR_MSG ) ;

   1288  2 002741   200006 631500                    EPPR1   SPECIAL_ERR_MSG,,AUTO
         2 002742   200101 451500                    STP1    @J+2,,AUTO
         2 002743   000015 236000 3                  LDQ     13
         2 002744   200100 756100                    STQ     @J+1,,AUTO
         2 002745   200100 630500                    EPPR0   @J+1,,AUTO
         2 002746   000011 631400 3                  EPPR1   9
         2 002747   000000 701000 xent               TSX1    X8ER$ERROR
         2 002750   000000 011000                    NOP     0
         2 002751   002753 710000 2                  TRA     s:1294

      686     1289
      687     1290        /*===================*/
      688     1291    2     REPORT_CORRECTION_1: ENTRY ; /* Report another bad operand */
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:108  

   1291  2 002752   200036 741300       REPORT_CORR* STX1  ! CORRECTED_1+2,,AUTO

      689     1292        /*===================*/
      690     1293
      691     1294    2          CALL X8ER$ERROR( %SPECIAL_MSG, MSG2, 80 ) ;

   1294  2 002753   000017 630400 3                  EPPR0   15
         2 002754   000001 631400 3                  EPPR1   1
         2 002755   000000 701000 xent               TSX1    X8ER$ERROR
         2 002756   000000 011000                    NOP     0

      692     1295    2          SPECIAL_ERR_MSG = 'Processing continued with' ;

   1295  2 002757   040100 100400                    MLR     fill='040'O
         2 002760   000066 000031 1                  ADSC9   ISR_PTR+32               cn=0,n=25
         2 002761   200006 000120                    ADSC9   SPECIAL_ERR_MSG,,AUTO    cn=0,n=80

      693     1296    2          IF CORRECTED_1

   1296  2 002762   200034 234100                    SZN     CORRECTED_1,,AUTO
         2 002763   002770 605000 2                  TPL     s:1298

      694     1297    2            THEN CALL INSERT( SPECIAL_ERR_MSG, 26,, 'data field set to zero.' ) ;

   1297  2 002764   040100 100400                    MLR     fill='040'O
         2 002765   000075 000027 1                  ADSC9   ISR_PTR+39               cn=0,n=23
         2 002766   200014 400066                    ADSC9   SPECIAL_ERR_MSG+6,,AUTO  cn=2,n=54
         2 002767   002773 710000 2                  TRA     s:1299

      695     1298    2            ELSE CALL INSERT( SPECIAL_ERR_MSG, 26,, 'sign corrected.' ) ;

   1298  2 002770   040100 100400                    MLR     fill='040'O
         2 002771   000103 000017 1                  ADSC9   ISR_PTR+45               cn=0,n=15
         2 002772   200014 400066                    ADSC9   SPECIAL_ERR_MSG+6,,AUTO  cn=2,n=54

      696     1299    2          CALL X8ER$ERROR( %SPECIAL_MSG, SPECIAL_ERR_MSG, 80 ) ;
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:109  

   1299  2 002773   000021 236000 3                  LDQ     17
         2 002774   200102 756100                    STQ     @J+3,,AUTO
         2 002775   200006 630500                    EPPR0   SPECIAL_ERR_MSG,,AUTO
         2 002776   200101 450500                    STP0    @J+2,,AUTO
         2 002777   000017 236000 3                  LDQ     15
         2 003000   200100 756100                    STQ     @J+1,,AUTO
         2 003001   200100 630500                    EPPR0   @J+1,,AUTO
         2 003002   000001 631400 3                  EPPR1   1
         2 003003   000000 701000 xent               TSX1    X8ER$ERROR
         2 003004   000000 011000                    NOP     0

      697     1300
      698     1301    2   END REPORT_CORRECTION ;

   1301  2 003005   200036 221300                    LDX1  ! CORRECTED_1+2,,AUTO
         2 003006   000001 702211                    TSX2  ! 1,X1
      699     1302
      700     1303    1   END X8RV$COMP_3_RECOVERY ;

PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:110  
--  Include file information  --

   Z8H_OPCODES.:Z8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure X8RV$COMP_3_RECOVERY.
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:111  

 **** Variables and constants ****

  ****  Section 000  Data  X8RV$COMP_3_RECOVERY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/c STRC(288)   r     1 MSG1                      24-0-0/c CHAR(32)    r     1 MSG1A
     0-0-0/c STRC(720)   r     1 MSG2

  ****  Section 001 RoData X8RV$COMP_3_RECOVERY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    26-0-0/w PTR         r     1 ISR$                      26-0-0/b BIT         r     1 ISR_PTR
    23-0-0/c CHAR(10)    r     1 OVP_MINUS                 20-0-0/c CHAR(10)    r     1 OVP_PLUS
     0-0-0/c CHAR(63)    r     1 ZEROES

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    75-0-0/w PTR         r     1 @C                        37-0-0/w PTR         r     1 @DESCR1
    76-0-0/w PTR         r     1 @I                         3-0-0/w PTR         r     1 @INSTRUCTION
    77-0-0/w PTR         r     1 @J                        40-0-0/w PTR         r     1 @MF
    73-0-0/w PTR         r     1 @PTR$                      5-0-0/w PTR         r     1 @PTR_REGISTERS
     4-0-0/w PTR         r     1 @REGISTERS                41-0-0/w PTR         r     1 @TYPE
    43-0-0/c CHAR(63)    r     1 ASC_STR                   *0-0-0/c CHAR        r     1 C
    73-0-0/c CHAR        r     1 C                         33-0-0/w BIT         r     1 CORRECTED
    34-0-0/w BIT         r     1 CORRECTED_1               42-0-0/w STRC        r     1 DESCR
    *0-0-0/w BIT         r     1 DESCR1                    75-0-0/w SBIN        r     1 DIGITS
    75-0-0/w STRC        r     1 DIGITS_ASCII              75-0-0/w STRC        r     1 DIGITS_PACKED
    63-0-0/b BIT         r     1 FIXED                     *0-0-0/w SBIN        r     1 I
    37-0-0/w PTR         r     1 IC$                       42-0-0/w STRC        r     1 IND_DESCR
    *0-0-0/w STRC(108)   r     1 INSTRUCTION               *0-0-0/w SBIN        r     1 J
PL6.E3A0      #001=X8RV$COMP_3_RECOVERY File=X8RV.:X8A6TSI                       SAT 08/09/97 10:52 Page:112  
    66-0-0/w SBIN        r     1 L                         65-0-0/w SBIN        r     1 LENGTH
    *0-0-0/b STRC(7)     r     1 MF                        70-0-0/w SBIN        r     1 N
    74-0-0/w UBIN        r     1 OFFSET                    76-0-0/d STRC(72)    r     1 OPERAND_DSCR
    64-0-0/w PTR         r     1 PTR$                      *0-0-0/w PTR         r     1 PTR$
    *0-0-0/w STRC(288)   r     1 PTR_REGISTERS             *0-0-0/w STRC(216)   r     1 REGISTERS
    67-0-0/w SBIN        r     1 S                          6-0-0/c CHAR(80)    r     1 SPECIAL_ERR_MSG
    32-0-0/w UBIN        r     1 TYPE                      *0-0-0/w UBIN        r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c UBIN(9)     r     1 X9OS$CLASS_NUMERIC(0:511)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 BASED$ASC                  0-0-0/w BIT         r     1 BASED$DESCR
     0-0-0/b BIT         r     1 BASED$PKD


   Procedure X8RV$COMP_3_RECOVERY requires 1543 words for executable code.
   Procedure X8RV$COMP_3_RECOVERY requires 68 words of local(AUTO) storage.

    No errors detected in file X8RV.:X8A6TSI    .
